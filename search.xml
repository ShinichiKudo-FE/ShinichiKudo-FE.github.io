<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å®æˆ˜æŠ€å·§ï¼ŒVueåŸæ¥è¿˜å¯ä»¥è¿™æ ·å†™</title>
      <link href="/2020/06/24/Vue/%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7%EF%BC%8CVue%E5%8E%9F%E6%9D%A5%E8%BF%98%E5%8F%AF%E4%BB%A5%E8%BF%99%E6%A0%B7%E5%86%99/"/>
      <url>/2020/06/24/Vue/%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7%EF%BC%8CVue%E5%8E%9F%E6%9D%A5%E8%BF%98%E5%8F%AF%E4%BB%A5%E8%BF%99%E6%A0%B7%E5%86%99/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5eef7799f265da02cd3b82fe?utm_source=gold_browser_extension" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h2 id="hookEvent-åŸæ¥å¯ä»¥è¿™æ ·ç›‘å¬ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ"><a href="#hookEvent-åŸæ¥å¯ä»¥è¿™æ ·ç›‘å¬ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="hookEvent,åŸæ¥å¯ä»¥è¿™æ ·ç›‘å¬ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ"></a>hookEvent,åŸæ¥å¯ä»¥è¿™æ ·ç›‘å¬ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</h2><h3 id="1-å†…éƒ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸå‡½æ•°"><a href="#1-å†…éƒ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸå‡½æ•°" class="headerlink" title="1. å†…éƒ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸå‡½æ•°"></a>1. å†…éƒ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸå‡½æ•°</h3><p>ä»Šå¤©äº§å“ç»ç†åˆç»™æˆ‘ç”©è¿‡æ¥ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦å¼€å‘ä¸€ä¸ªå›¾è¡¨ï¼Œæ‹¿åˆ°éœ€æ±‚ï¼Œç„äº†ä¸€çœ¼ï¼Œç„¶åæˆ‘å°±å»echartså®˜ç½‘å¤åˆ¶ç¤ºä¾‹ä»£ç äº†ï¼Œå¤åˆ¶å®Œæ”¹äº†æ”¹å·®ä¸å¤šäº†ï¼Œæ”¹å®Œä»£ç é•¿è¿™æ ·</p><pre><code class="html">&lt;template&gt;  &lt;div class=&quot;echarts&quot;&gt;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default {  mounted() {    this.chart = echarts.init(this.$el)    // è¯·æ±‚æ•°æ®ï¼Œèµ‹å€¼æ•°æ® ç­‰ç­‰ä¸€ç³»åˆ—æ“ä½œ...    // ç›‘å¬çª—å£å‘ç”Ÿå˜åŒ–ï¼Œresizeç»„ä»¶    window.addEventListener(&#39;resize&#39;, this.$_handleResizeChart)  },  updated() {    // å¹²äº†ä¸€å †æ´»  },  created() {    // å¹²äº†ä¸€å †æ´»  },  beforeDestroy() {    // ç»„ä»¶é”€æ¯æ—¶ï¼Œé”€æ¯ç›‘å¬äº‹ä»¶    window.removeEventListener(&#39;resize&#39;, this.$_handleResizeChart)  },  methods: {    $_handleResizeChart() {      this.chart.resize()    },    // å…¶ä»–ä¸€å †æ–¹æ³•  }}&lt;/script&gt;</code></pre><p>åŠŸèƒ½å†™å®Œå¼€å¼€å¿ƒå¿ƒçš„ææµ‹äº†ï¼Œæµ‹è¯•æ²¡å•¥é—®é¢˜ï¼Œäº§å“ç»ç†è¡¨ç¤ºåšçš„å¾ˆæ£’ã€‚ç„¶è€Œ<code>code review</code>æ—¶å€™ï¼ŒæŠ€æœ¯å¤§ä½¬è¯´äº†ï¼Œè¿™æ ·æœ‰é—®é¢˜ã€‚</p><ul><li>å¤§ä½¬ï¼šè¿™æ ·å†™ä¸æ˜¯å¾ˆå¥½ï¼Œåº”è¯¥å°†ç›‘å¬<code>resize</code>äº‹ä»¶ä¸é”€æ¯<code>resize</code>äº‹ä»¶æ”¾åˆ°ä¸€èµ·ï¼Œç°åœ¨ä¸¤æ®µä»£ç åˆ†å¼€è€Œä¸”ç›¸éš”å‡ ç™¾è¡Œä»£ç ï¼Œå¯è¯»æ€§æ¯”è¾ƒå·®</li><li>æˆ‘ï¼šé‚£æˆ‘æŠŠä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ä½ç½®æ¢ä¸€ä¸‹ï¼Œæ”¾åˆ°ä¸€èµ·?</li><li>å¤§ä½¬ï¼š <code>hook</code>å¬è¿‡æ²¡ï¼Ÿ</li><li>æˆ‘ï¼š<code>Vue3.0</code>æ‰æœ‰å•Šï¼Œå’‹ï¼Œå’±è¦å‡çº§<code>Vue</code>?</li></ul><p>ç„¶åæŠ€æœ¯å¤§ä½¬å°±ä¸ç†æˆ‘äº†,å¹¶å‘æˆ‘æ‰”è¿‡æ¥ä¸€æ®µä»£ç </p><pre><code class="js">export default {  mounted() {    this.chart = echarts.init(this.$el)    // è¯·æ±‚æ•°æ®ï¼Œèµ‹å€¼æ•°æ® ç­‰ç­‰ä¸€ç³»åˆ—æ“ä½œ...    // ç›‘å¬çª—å£å‘ç”Ÿå˜åŒ–ï¼Œresizeç»„ä»¶    window.addEventListener(&#39;resize&#39;, this.$_handleResizeChart)    // é€šè¿‡hookç›‘å¬ç»„ä»¶é”€æ¯é’©å­å‡½æ•°ï¼Œå¹¶å–æ¶ˆç›‘å¬äº‹ä»¶    this.$once(&#39;hook:beforeDestroy&#39;, () =&gt; {      window.removeEventListener(&#39;resize&#39;, this.$_handleResizeChart)    })  },  updated() {},  created() {},  methods: {    $_handleResizeChart() {      // this.chart.resize()    }  }}</code></pre><p>çœ‹å®Œä»£ç ï¼Œæç„¶å¤§æ‚Ÿï¼Œå¤§ä½¬ä¸æ„§æ˜¯å¤§ä½¬ï¼ŒåŸæ¥<code>Vue</code>è¿˜å¯ä»¥è¿™æ ·ç›‘å¬ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚</p><blockquote><p>åœ¨Vueç»„ä»¶ä¸­ï¼Œå¯ä»¥ç”¨è¿‡<code>$on,$once</code>å»ç›‘å¬æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œå¦‚ç›‘å¬ç»„ä»¶çš„<code>updated</code>é’©å­å‡½æ•°å¯ä»¥å†™æˆ <code>this.$on(&#39;hook:updated&#39;, () =&gt; {})</code></p></blockquote><h3 id="2-å¤–éƒ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸå‡½æ•°"><a href="#2-å¤–éƒ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸå‡½æ•°" class="headerlink" title="2. å¤–éƒ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸå‡½æ•°"></a>2. å¤–éƒ¨ç›‘å¬ç”Ÿå‘½å‘¨æœŸå‡½æ•°</h3><p>ä»Šå¤©åŒäº‹åœ¨å…¬å¸ç¾¤é‡Œé—®ï¼Œæƒ³åœ¨å¤–éƒ¨ç›‘å¬ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œæœ‰æ²¡æœ‰åŠæ³•å•Šï¼Ÿ</p><p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„éœ€æ±‚å‘¢ï¼ŒåŸæ¥åŒäº‹ç”¨äº†ä¸€ä¸ªç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œéœ€è¦ç›‘å¬ç¬¬ä¸‰æ–¹ç»„ä»¶æ•°æ®çš„å˜åŒ–ï¼Œä½†æ˜¯ç»„ä»¶åˆæ²¡æœ‰æä¾›<code>change</code>äº‹ä»¶ï¼ŒåŒäº‹ä¹Ÿæ²¡åŠæ³•äº†ï¼Œæ‰æƒ³å‡ºæ¥è¦å»åœ¨å¤–éƒ¨ç›‘å¬ç»„ä»¶çš„<code>updated</code>é’©å­å‡½æ•°ã€‚æŸ¥çœ‹äº†ä¸€ç•ªèµ„æ–™ï¼Œå‘ç°<code>Vueæ”¯æŒåœ¨å¤–éƒ¨ç›‘å¬ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°</code>ã€‚</p><pre><code class="html">&lt;template&gt;  &lt;!--é€šè¿‡@hook:updatedç›‘å¬ç»„ä»¶çš„updatedç”Ÿå‘½é’©å­å‡½æ•°--&gt;  &lt;!--ç»„ä»¶çš„æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸé’©å­éƒ½å¯ä»¥é€šè¿‡@hook:é’©å­å‡½æ•°å æ¥ç›‘å¬è§¦å‘--&gt;  &lt;custom-select @hook:updated=&quot;$_handleSelectUpdated&quot; /&gt;&lt;/template&gt;&lt;script&gt;import CustomSelect from &#39;../components/custom-select&#39;export default {  components: {    CustomSelect  },  methods: {    $_handleSelectUpdated() {      console.log(&#39;custom-selectç»„ä»¶çš„updatedé’©å­å‡½æ•°è¢«è§¦å‘&#39;)    }  }}&lt;/script&gt;</code></pre><h2 id="å°é¡¹ç›®è¿˜ç”¨Vuex-ç”¨Vue-observableæ‰‹å†™ä¸€ä¸ªçŠ¶æ€ç®¡ç†å§"><a href="#å°é¡¹ç›®è¿˜ç”¨Vuex-ç”¨Vue-observableæ‰‹å†™ä¸€ä¸ªçŠ¶æ€ç®¡ç†å§" class="headerlink" title="å°é¡¹ç›®è¿˜ç”¨Vuex?ç”¨Vue.observableæ‰‹å†™ä¸€ä¸ªçŠ¶æ€ç®¡ç†å§"></a>å°é¡¹ç›®è¿˜ç”¨Vuex?ç”¨Vue.observableæ‰‹å†™ä¸€ä¸ªçŠ¶æ€ç®¡ç†å§</h2><p>åœ¨å‰ç«¯é¡¹ç›®ä¸­ï¼Œæœ‰è®¸å¤šæ•°æ®éœ€è¦åœ¨å„ä¸ªç»„ä»¶ä¹‹é—´è¿›è¡Œä¼ é€’å…±äº«ï¼Œè¿™æ—¶å€™å°±éœ€è¦æœ‰ä¸€ä¸ªçŠ¶æ€ç®¡ç†å·¥å…·ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šä½¿ç”¨<code>Vuex</code>ï¼Œä½†å¯¹äºå°å‹é¡¹ç›®æ¥è¯´ï¼Œå°±åƒ<code>Vuex</code>å®˜ç½‘æ‰€è¯´ï¼šâ€œå¦‚æœæ‚¨ä¸æ‰“ç®—å¼€å‘å¤§å‹å•é¡µåº”ç”¨ï¼Œä½¿ç”¨ <code>Vuex</code> å¯èƒ½æ˜¯ç¹çå†—ä½™çš„ã€‚ç¡®å®æ˜¯å¦‚æ­¤â€”â€”å¦‚æœæ‚¨çš„åº”ç”¨å¤Ÿç®€å•ï¼Œæ‚¨æœ€å¥½ä¸è¦ä½¿ç”¨ <code>Vuex</code>â€ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Vue2.6æä¾›çš„æ–°API <code>Vue.observable</code>æ‰‹åŠ¨æ‰“é€ ä¸€ä¸ª<code>Vuex</code></p><h3 id="åˆ›å»º-store"><a href="#åˆ›å»º-store" class="headerlink" title="åˆ›å»º store"></a>åˆ›å»º store</h3><pre><code class="js">import Vue from &#39;vue&#39;// é€šè¿‡Vue.observableåˆ›å»ºä¸€ä¸ªå¯å“åº”çš„å¯¹è±¡export const store = Vue.observable({  userInfo: {},  roleIds: []})// å®šä¹‰ mutations, ä¿®æ”¹å±æ€§export const mutations = {  setUserInfo(userInfo) {    store.userInfo = userInfo  },  setRoleIds(roleIds) {    store.roleIds = roleIds  }}</code></pre><h3 id="åœ¨ç»„ä»¶ä¸­å¼•ç”¨"><a href="#åœ¨ç»„ä»¶ä¸­å¼•ç”¨" class="headerlink" title="åœ¨ç»„ä»¶ä¸­å¼•ç”¨"></a>åœ¨ç»„ä»¶ä¸­å¼•ç”¨</h3><pre><code class="html">&lt;template&gt;  &lt;div&gt;    {{ userInfo.name }}  &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import { store, mutations } from &#39;../store&#39;export default {  computed: {    userInfo() {      return store.userInfo    }  },  created() {    mutations.setUserInfo({      name: &#39;ç™½å‘Š&#39;    })  }}&lt;/script&gt;</code></pre><h2 id="å¼€å‘å…¨å±€ç»„ä»¶ï¼Œä½ å¯èƒ½éœ€è¦äº†è§£ä¸€ä¸‹Vue-extend"><a href="#å¼€å‘å…¨å±€ç»„ä»¶ï¼Œä½ å¯èƒ½éœ€è¦äº†è§£ä¸€ä¸‹Vue-extend" class="headerlink" title="å¼€å‘å…¨å±€ç»„ä»¶ï¼Œä½ å¯èƒ½éœ€è¦äº†è§£ä¸€ä¸‹Vue.extend"></a>å¼€å‘å…¨å±€ç»„ä»¶ï¼Œä½ å¯èƒ½éœ€è¦äº†è§£ä¸€ä¸‹Vue.extend</h2><p><code>Vue.extend</code>æ˜¯ä¸€ä¸ªå…¨å±€Api,å¹³æ—¶æˆ‘ä»¬åœ¨å¼€å‘ä¸šåŠ¡çš„æ—¶å€™å¾ˆå°‘ä¼šç”¨åˆ°å®ƒï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å¯ä»¥å¼€å‘ä¸€äº›å…¨å±€ç»„ä»¶æ¯”å¦‚Loading,Notify,Messageç­‰ç»„ä»¶æ—¶ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨<code>Vue.extend</code>ã€‚</p><p>åŒå­¦ä»¬åœ¨ä½¿ç”¨<code>element-ui</code>çš„<code>loading</code>æ—¶ï¼Œåœ¨ä»£ç ä¸­å¯èƒ½ä¼šè¿™æ ·å†™</p><pre><code class="js">// æ˜¾ç¤ºloadingconst loading = this.$loading()// å…³é—­loadingloading.close()</code></pre><p>è¿™æ ·å†™å¯èƒ½æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œä½†æ˜¯å¦‚æœä½ è¿™æ ·å†™</p><pre><code class="js">const loading = this.$loading()const loading1 = this.$loading()setTimeout(() =&gt; {  loading.close()}, 1000 * 3)</code></pre><p>è¿™æ—¶å€™ä½ ä¼šå‘ç°ï¼Œæˆ‘è°ƒç”¨äº†ä¸¤æ¬¡loading,ä½†æ˜¯åªå‡ºç°äº†ä¸€ä¸ªï¼Œè€Œä¸”æˆ‘åªå…³é—­äº†loadingï¼Œä½†æ˜¯loading1ä¹Ÿè¢«å…³é—­äº†ã€‚è¿™æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿæˆ‘ä»¬ç°åœ¨å°±æ˜¯ç”¨Vue.extend + å•ä¾‹æ¨¡å¼å»å®ç°ä¸€ä¸ªloading</p><h3 id="å¼€å‘loadingç»„ä»¶"><a href="#å¼€å‘loadingç»„ä»¶" class="headerlink" title="å¼€å‘loadingç»„ä»¶"></a>å¼€å‘loadingç»„ä»¶</h3><pre><code class="html">&lt;template&gt;  &lt;transition name=&quot;custom-loading-fade&quot;&gt;    &lt;!--loadingè’™ç‰ˆ--&gt;    &lt;div v-show=&quot;visible&quot; class=&quot;custom-loading-mask&quot;&gt;      &lt;!--loadingä¸­é—´çš„å›¾æ ‡--&gt;      &lt;div class=&quot;custom-loading-spinner&quot;&gt;        &lt;i class=&quot;custom-spinner-icon&quot;&gt;&lt;/i&gt;        &lt;!--loadingä¸Šé¢æ˜¾ç¤ºçš„æ–‡å­—--&gt;        &lt;p class=&quot;custom-loading-text&quot;&gt;{{ text }}&lt;/p&gt;      &lt;/div&gt;    &lt;/div&gt;  &lt;/transition&gt;&lt;/template&gt;&lt;script&gt;export default {  props: {  // æ˜¯å¦æ˜¾ç¤ºloading    visible: {      type: Boolean,      default: false    },    // loadingä¸Šé¢çš„æ˜¾ç¤ºæ–‡å­—    text: {      type: String,      default: &#39;&#39;    }  }}&lt;/script&gt;</code></pre><h3 id="é€šè¿‡Vue-extendå°†ç»„ä»¶è½¬æ¢ä¸ºå…¨å±€ç»„ä»¶"><a href="#é€šè¿‡Vue-extendå°†ç»„ä»¶è½¬æ¢ä¸ºå…¨å±€ç»„ä»¶" class="headerlink" title="é€šè¿‡Vue.extendå°†ç»„ä»¶è½¬æ¢ä¸ºå…¨å±€ç»„ä»¶"></a>é€šè¿‡Vue.extendå°†ç»„ä»¶è½¬æ¢ä¸ºå…¨å±€ç»„ä»¶</h3><h4 id="æ”¹é€ loadingç»„ä»¶ï¼Œå°†ç»„ä»¶çš„propsæ”¹ä¸ºdata"><a href="#æ”¹é€ loadingç»„ä»¶ï¼Œå°†ç»„ä»¶çš„propsæ”¹ä¸ºdata" class="headerlink" title="æ”¹é€ loadingç»„ä»¶ï¼Œå°†ç»„ä»¶çš„propsæ”¹ä¸ºdata"></a>æ”¹é€ loadingç»„ä»¶ï¼Œå°†ç»„ä»¶çš„propsæ”¹ä¸ºdata</h4><pre><code class="js">export default {  data() {    return {      text: &#39;&#39;,      visible: false    }  }}</code></pre><h4 id="é€šè¿‡Vue-extendæ”¹é€ ç»„ä»¶"><a href="#é€šè¿‡Vue-extendæ”¹é€ ç»„ä»¶" class="headerlink" title="é€šè¿‡Vue.extendæ”¹é€ ç»„ä»¶"></a>é€šè¿‡Vue.extendæ”¹é€ ç»„ä»¶</h4><pre><code class="js">// loading/index.jsimport Vue from &#39;vue&#39;import LoadingComponent from &#39;./loading.vue&#39;// é€šè¿‡Vue.extendå°†ç»„ä»¶åŒ…è£…æˆä¸€ä¸ªå­ç±»const LoadingConstructor = Vue.extend(LoadingComponent)let loading = undefinedLoadingConstructor.prototype.close = function() {  // å¦‚æœloading æœ‰å¼•ç”¨ï¼Œåˆ™å»æ‰å¼•ç”¨  if (loading) {    loading = undefined  }  // å…ˆå°†ç»„ä»¶éšè—  this.visible = false  // å»¶è¿Ÿ300æ¯«ç§’ï¼Œç­‰å¾…loadingå…³é—­åŠ¨ç”»æ‰§è¡Œå®Œä¹‹åé”€æ¯ç»„ä»¶  setTimeout(() =&gt; {    // ç§»é™¤æŒ‚è½½çš„domå…ƒç´     if (this.$el &amp;&amp; this.$el.parentNode) {      this.$el.parentNode.removeChild(this.$el)    }    // è°ƒç”¨ç»„ä»¶çš„$destroyæ–¹æ³•è¿›è¡Œç»„ä»¶é”€æ¯    this.$destroy()  }, 300)}const Loading = (options = {}) =&gt; {  // å¦‚æœç»„ä»¶å·²æ¸²æŸ“ï¼Œåˆ™è¿”å›å³å¯  if (loading) {    return loading  }  // è¦æŒ‚è½½çš„å…ƒç´   const parent = document.body  // ç»„ä»¶å±æ€§  const opts = {    text: &#39;&#39;,    ...options  }  // é€šè¿‡æ„é€ å‡½æ•°åˆå§‹åŒ–ç»„ä»¶ ç›¸å½“äº new Vue()  const instance = new LoadingConstructor({    el: document.createElement(&#39;div&#39;),    data: opts  })  // å°†loadingå…ƒç´ æŒ‚åœ¨åˆ°parentä¸Šé¢  parent.appendChild(instance.$el)  // æ˜¾ç¤ºloading  Vue.nextTick(() =&gt; {    instance.visible = true  })  // å°†ç»„ä»¶å®ä¾‹èµ‹å€¼ç»™loading  loading = instance  return instance}export default Loading</code></pre><h4 id="åœ¨é¡µé¢ä½¿ç”¨loading"><a href="#åœ¨é¡µé¢ä½¿ç”¨loading" class="headerlink" title="åœ¨é¡µé¢ä½¿ç”¨loading"></a>åœ¨é¡µé¢ä½¿ç”¨loading</h4><pre><code class="js">import Loading from &#39;./loading/index.js&#39;export default {  created() {    const loading = Loading({ text: &#39;æ­£åœ¨åŠ è½½ã€‚ã€‚ã€‚&#39; })    // ä¸‰ç§’é’Ÿåå…³é—­    setTimeout(() =&gt; {      loading.close()    }, 3000)  }}</code></pre><p>é€šè¿‡ä¸Šé¢çš„æ”¹é€ ï¼Œ<code>loading</code>å·²ç»å¯ä»¥åœ¨å…¨å±€ä½¿ç”¨äº†ï¼Œå¦‚æœéœ€è¦åƒ<code>element-ui</code>ä¸€æ ·æŒ‚è½½åˆ°<code>Vue.prototype</code>ä¸Šé¢ï¼Œé€šè¿‡<code>this.$loading</code>è°ƒç”¨ï¼Œè¿˜éœ€è¦æ”¹é€ ä¸€ä¸‹</p><h3 id="å°†ç»„ä»¶æŒ‚è½½åˆ°Vue-prototypeä¸Šé¢"><a href="#å°†ç»„ä»¶æŒ‚è½½åˆ°Vue-prototypeä¸Šé¢" class="headerlink" title="å°†ç»„ä»¶æŒ‚è½½åˆ°Vue.prototypeä¸Šé¢"></a>å°†ç»„ä»¶æŒ‚è½½åˆ°Vue.prototypeä¸Šé¢</h3><pre><code class="js">Vue.prototype.$loading = Loading// åœ¨exportä¹‹å‰å°†Loadingæ–¹æ³•è¿›è¡Œç»‘å®šexport default Loading// åœ¨ç»„ä»¶å†…ä½¿ç”¨this.$loading()</code></pre><h2 id="è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œä»åº•å±‚è§£å†³é—®é¢˜"><a href="#è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œä»åº•å±‚è§£å†³é—®é¢˜" class="headerlink" title="è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œä»åº•å±‚è§£å†³é—®é¢˜"></a>è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œä»åº•å±‚è§£å†³é—®é¢˜</h2><p>é€šè¿‡ä¸Šä¸€èŠ‚æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ª<code>loading</code>ç»„ä»¶ï¼Œå¼€å‘å®Œä¹‹åï¼Œå…¶ä»–å¼€å‘åœ¨ä½¿ç”¨çš„æ—¶å€™åˆæå‡ºæ¥äº†ä¸¤ä¸ªéœ€æ±‚</p><p>1.å¯ä»¥å°†<code>loading</code>æŒ‚è½½åˆ°æŸä¸€ä¸ªå…ƒç´ ä¸Šé¢ï¼Œç°åœ¨åªèƒ½æ˜¯å…¨å±ä½¿ç”¨<br>2.å¯ä»¥ä½¿ç”¨æŒ‡ä»¤åœ¨æŒ‡å®šçš„å…ƒç´ ä¸Šé¢æŒ‚è½½<code>loading</code></p><h3 id="å¼€å‘v-loadingæŒ‡ä»¤"><a href="#å¼€å‘v-loadingæŒ‡ä»¤" class="headerlink" title="å¼€å‘v-loadingæŒ‡ä»¤"></a>å¼€å‘v-loadingæŒ‡ä»¤</h3><pre><code class="js">import Vue from &#39;vue&#39;import LoadingComponent from &#39;./loading&#39;// ä½¿ç”¨ Vue.extendæ„é€ ç»„ä»¶å­ç±»const LoadingContructor = Vue.extend(LoadingComponent)// å®šä¹‰ä¸€ä¸ªåä¸ºloadingçš„æŒ‡ä»¤Vue.directive(&#39;loading&#39;, {  /**   * åªè°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨æŒ‡ä»¤ç¬¬ä¸€æ¬¡ç»‘å®šåˆ°å…ƒç´ æ—¶è°ƒç”¨ï¼Œå¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›åˆå§‹åŒ–çš„è®¾ç½®   * @param {*} el æŒ‡ä»¤è¦ç»‘å®šçš„å…ƒç´    * @param {*} binding æŒ‡ä»¤ä¼ å…¥çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ {name:&#39;æŒ‡ä»¤åç§°&#39;, value: &#39;æŒ‡ä»¤ç»‘å®šçš„å€¼&#39;,arg: &#39;æŒ‡ä»¤å‚æ•° v-bind:text å¯¹åº” text&#39;}   */  bind(el, binding) {    const instance = new LoadingContructor({      el: document.createElement(&#39;div&#39;),      data: {}    })    el.appendChild(instance.$el)    el.instance = instance    Vue.nextTick(() =&gt; {      el.instance.visible = binding.value    })  },  /**   * æ‰€åœ¨ç»„ä»¶çš„ VNode æ›´æ–°æ—¶è°ƒç”¨   * @param {*} el   * @param {*} binding   */  update(el, binding) {    // é€šè¿‡å¯¹æ¯”å€¼çš„å˜åŒ–åˆ¤æ–­loadingæ˜¯å¦æ˜¾ç¤º    if (binding.oldValue !== binding.value) {      el.instance.visible = binding.value    }  },  /**   * åªè°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨ æŒ‡ä»¤ä¸å…ƒç´ è§£ç»‘æ—¶è°ƒç”¨   * @param {*} el   */  unbind(el) {    const mask = el.instance.$el    if (mask.parentNode) {      mask.parentNode.removeChild(mask)    }    el.instance.$destroy()    el.instance = undefined  }})</code></pre><h3 id="åœ¨å…ƒç´ ä¸Šé¢ä½¿ç”¨æŒ‡ä»¤"><a href="#åœ¨å…ƒç´ ä¸Šé¢ä½¿ç”¨æŒ‡ä»¤" class="headerlink" title="åœ¨å…ƒç´ ä¸Šé¢ä½¿ç”¨æŒ‡ä»¤"></a>åœ¨å…ƒç´ ä¸Šé¢ä½¿ç”¨æŒ‡ä»¤</h3><pre><code class="html">&lt;template&gt;  &lt;div v-loading=&quot;visible&quot;&gt;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default {  data() {    return {      visible: false    }  },  created() {    this.visible = true    fetch().then(() =&gt; {      this.visible = false    })  }}&lt;/script&gt;</code></pre><h3 id="é¡¹ç›®ä¸­å“ªäº›åœºæ™¯å¯ä»¥è‡ªå®šä¹‰æŒ‡ä»¤"><a href="#é¡¹ç›®ä¸­å“ªäº›åœºæ™¯å¯ä»¥è‡ªå®šä¹‰æŒ‡ä»¤" class="headerlink" title="é¡¹ç›®ä¸­å“ªäº›åœºæ™¯å¯ä»¥è‡ªå®šä¹‰æŒ‡ä»¤"></a>é¡¹ç›®ä¸­å“ªäº›åœºæ™¯å¯ä»¥è‡ªå®šä¹‰æŒ‡ä»¤</h3><p>1.ä¸ºç»„ä»¶æ·»åŠ <code>loading</code>æ•ˆæœ<br>2.æŒ‰é’®çº§åˆ«æƒé™æ§åˆ¶ <code>v-permission</code><br>3.ä»£ç åŸ‹ç‚¹,æ ¹æ®æ“ä½œç±»å‹å®šä¹‰æŒ‡ä»¤<br>4.inputè¾“å…¥æ¡†è‡ªåŠ¨è·å–ç„¦ç‚¹<br>5.å…¶ä»–ç­‰ç­‰ã€‚ã€‚ã€‚</p><h2 id="æ·±åº¦watchä¸watchç«‹å³è§¦å‘å›è°ƒ-æˆ‘å¯ä»¥ç›‘å¬åˆ°ä½ çš„ä¸€ä¸¾ä¸€åŠ¨"><a href="#æ·±åº¦watchä¸watchç«‹å³è§¦å‘å›è°ƒ-æˆ‘å¯ä»¥ç›‘å¬åˆ°ä½ çš„ä¸€ä¸¾ä¸€åŠ¨" class="headerlink" title="æ·±åº¦watchä¸watchç«‹å³è§¦å‘å›è°ƒ,æˆ‘å¯ä»¥ç›‘å¬åˆ°ä½ çš„ä¸€ä¸¾ä¸€åŠ¨"></a>æ·±åº¦watchä¸watchç«‹å³è§¦å‘å›è°ƒ,æˆ‘å¯ä»¥ç›‘å¬åˆ°ä½ çš„ä¸€ä¸¾ä¸€åŠ¨</h2><p>åœ¨å¼€å‘Vueé¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬ä¼šç»å¸¸æ€§çš„ä½¿ç”¨åˆ°watchå»ç›‘å¬æ•°æ®çš„å˜åŒ–ï¼Œç„¶ååœ¨å˜åŒ–ä¹‹ååšä¸€ç³»åˆ—æ“ä½œã€‚</p><h3 id="åŸºç¡€ç”¨æ³•"><a href="#åŸºç¡€ç”¨æ³•" class="headerlink" title="åŸºç¡€ç”¨æ³•"></a>åŸºç¡€ç”¨æ³•</h3><p>æ¯”å¦‚ä¸€ä¸ªåˆ—è¡¨é¡µï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥æœç´¢å…³é”®å­—çš„æ—¶å€™ï¼Œå¯ä»¥è‡ªåŠ¨è§¦å‘æœç´¢,æ­¤æ—¶é™¤äº†ç›‘å¬æœç´¢æ¡†çš„<code>change</code>äº‹ä»¶ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡<code>watch</code>ç›‘å¬æœç´¢å…³é”®å­—çš„å˜åŒ–</p><pre><code class="html">&lt;template&gt;  &lt;!--æ­¤å¤„ç¤ºä¾‹ä½¿ç”¨äº†element-ui--&gt;  &lt;div&gt;    &lt;div&gt;      &lt;span&gt;æœç´¢&lt;/span&gt;      &lt;input v-model=&quot;searchValue&quot; /&gt;    &lt;/div&gt;    &lt;!--åˆ—è¡¨ï¼Œä»£ç çœç•¥--&gt;  &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default {  data() {    return {      searchValue: &#39;&#39;    }  },  watch: {    // åœ¨å€¼å‘ç”Ÿå˜åŒ–ä¹‹åï¼Œé‡æ–°åŠ è½½æ•°æ®    searchValue(newValue, oldValue) {      // åˆ¤æ–­æœç´¢      if (newValue !== oldValue) {        this.$_loadData()      }    }  },  methods: {    $_loadData() {      // é‡æ–°åŠ è½½æ•°æ®ï¼Œæ­¤å¤„éœ€è¦é€šè¿‡å‡½æ•°é˜²æŠ–    }  }}&lt;/script&gt;</code></pre><h3 id="ç«‹å³è§¦å‘"><a href="#ç«‹å³è§¦å‘" class="headerlink" title="ç«‹å³è§¦å‘"></a>ç«‹å³è§¦å‘</h3><p>é€šè¿‡ä¸Šé¢çš„ä»£ç ï¼Œç°åœ¨å·²ç»å¯ä»¥åœ¨å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™è§¦å‘åŠ è½½æ•°æ®äº†ï¼Œä½†æ˜¯å¦‚æœè¦åœ¨é¡µé¢åˆå§‹åŒ–æ—¶å€™åŠ è½½æ•°æ®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨<code>created</code>æˆ–è€…<code>mounted</code>ç”Ÿå‘½å‘¨æœŸé’©å­é‡Œé¢å†æ¬¡è°ƒç”¨<code>$_loadData</code>æ–¹æ³•ã€‚ä¸è¿‡ï¼Œç°åœ¨å¯ä»¥ä¸ç”¨è¿™æ ·å†™äº†ï¼Œé€šè¿‡é…ç½®<code>watch</code>çš„ç«‹å³è§¦å‘å±æ€§ï¼Œå°±å¯ä»¥æ»¡è¶³éœ€æ±‚äº†</p><pre><code class="js">// æ”¹é€ watchexport default {  watch: {    // åœ¨å€¼å‘ç”Ÿå˜åŒ–ä¹‹åï¼Œé‡æ–°åŠ è½½æ•°æ®    searchValue: {    // é€šè¿‡handleræ¥ç›‘å¬å±æ€§å˜åŒ–, åˆæ¬¡è°ƒç”¨ newValueä¸º&quot;&quot;ç©ºå­—ç¬¦ä¸²ï¼Œ oldValueä¸º undefined      handler(newValue, oldValue) {        if (newValue !== oldValue) {          this.$_loadData()        }      },      // é…ç½®ç«‹å³æ‰§è¡Œå±æ€§      immediate: true    }  }}</code></pre><h3 id="æ·±åº¦ç›‘å¬ï¼ˆæˆ‘å¯ä»¥çœ‹åˆ°ä½ å†…å¿ƒçš„ä¸€ä¸¾ä¸€åŠ¨ï¼‰"><a href="#æ·±åº¦ç›‘å¬ï¼ˆæˆ‘å¯ä»¥çœ‹åˆ°ä½ å†…å¿ƒçš„ä¸€ä¸¾ä¸€åŠ¨ï¼‰" class="headerlink" title="æ·±åº¦ç›‘å¬ï¼ˆæˆ‘å¯ä»¥çœ‹åˆ°ä½ å†…å¿ƒçš„ä¸€ä¸¾ä¸€åŠ¨ï¼‰"></a>æ·±åº¦ç›‘å¬ï¼ˆæˆ‘å¯ä»¥çœ‹åˆ°ä½ å†…å¿ƒçš„ä¸€ä¸¾ä¸€åŠ¨ï¼‰</h3><p>ä¸€ä¸ªè¡¨å•é¡µé¢ï¼Œéœ€æ±‚å¸Œæœ›ç”¨æˆ·åœ¨ä¿®æ”¹è¡¨å•çš„ä»»æ„ä¸€é¡¹ä¹‹åï¼Œè¡¨å•é¡µé¢å°±éœ€è¦å˜æ›´ä¸ºè¢«ä¿®æ”¹çŠ¶æ€ã€‚å¦‚æœæŒ‰ç…§ä¸Šä¾‹ä¸­watchçš„å†™æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å»ç›‘å¬è¡¨å•æ¯ä¸€ä¸ªå±æ€§ï¼Œå¤ªéº»çƒ¦äº†ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°<code>watch</code>çš„æ·±åº¦ç›‘å¬<code>deep</code></p><pre><code class="js">export default {  data() {    return {      formData: {        name: &#39;&#39;,        sex: &#39;&#39;,        age: 0,        deptId: &#39;&#39;      }    }  },  watch: {    // åœ¨å€¼å‘ç”Ÿå˜åŒ–ä¹‹åï¼Œé‡æ–°åŠ è½½æ•°æ®    formData: {      // éœ€è¦æ³¨æ„ï¼Œå› ä¸ºå¯¹è±¡å¼•ç”¨çš„åŸå› ï¼Œ newValueå’ŒoldValueçš„å€¼ä¸€ç›´ç›¸ç­‰      handler(newValue, oldValue) {        // åœ¨è¿™é‡Œæ ‡è®°é¡µé¢ç¼–è¾‘çŠ¶æ€      },      // é€šè¿‡æŒ‡å®šdeepå±æ€§ä¸ºtrue, watchä¼šç›‘å¬å¯¹è±¡é‡Œé¢æ¯ä¸€ä¸ªå€¼çš„å˜åŒ–      deep: true    }  }}</code></pre><h2 id="å‡½æ•°å¼ç»„ä»¶ï¼Œå‡½æ•°æ˜¯ç»„ä»¶ï¼Ÿ"><a href="#å‡½æ•°å¼ç»„ä»¶ï¼Œå‡½æ•°æ˜¯ç»„ä»¶ï¼Ÿ" class="headerlink" title="å‡½æ•°å¼ç»„ä»¶ï¼Œå‡½æ•°æ˜¯ç»„ä»¶ï¼Ÿ"></a>å‡½æ•°å¼ç»„ä»¶ï¼Œå‡½æ•°æ˜¯ç»„ä»¶ï¼Ÿ</h2><p>ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç»„ä»¶ï¼Ÿå‡½æ•°å¼ç»„ä»¶å°±æ˜¯å‡½æ•°æ˜¯ç»„ä»¶ï¼Œæ„Ÿè§‰åœ¨ç©æ–‡å­—æ¸¸æˆã€‚ä½¿ç”¨è¿‡Reactçš„åŒå­¦ï¼Œåº”è¯¥ä¸ä¼šå¯¹å‡½æ•°å¼ç»„ä»¶æ„Ÿåˆ°é™Œç”Ÿã€‚å‡½æ•°å¼ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºæ²¡æœ‰å†…éƒ¨çŠ¶æ€ï¼Œæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œæ²¡æœ‰this(ä¸éœ€è¦å®ä¾‹åŒ–çš„ç»„ä»¶)ã€‚</p><p>åœ¨æ—¥å¸¸å†™bugçš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šå¼€å‘ä¸€äº›çº¯å±•ç¤ºæ€§çš„ä¸šåŠ¡ç»„ä»¶ï¼Œæ¯”å¦‚ä¸€äº›è¯¦æƒ…é¡µé¢ï¼Œåˆ—è¡¨ç•Œé¢ç­‰ï¼Œå®ƒä»¬æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹æ˜¯åªéœ€è¦å°†å¤–éƒ¨ä¼ å…¥çš„æ•°æ®è¿›è¡Œå±•ç°ï¼Œä¸éœ€è¦æœ‰å†…éƒ¨çŠ¶æ€ï¼Œä¸éœ€è¦åœ¨ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°é‡Œé¢åšå¤„ç†ï¼Œè¿™æ—¶å€™ä½ å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶ã€‚</p><h3 id="å…ˆæ¥ä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶çš„ä»£ç "><a href="#å…ˆæ¥ä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶çš„ä»£ç " class="headerlink" title="å…ˆæ¥ä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶çš„ä»£ç "></a>å…ˆæ¥ä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶çš„ä»£ç </h3><pre><code class="js">export default {  // é€šè¿‡é…ç½®functionalå±æ€§æŒ‡å®šç»„ä»¶ä¸ºå‡½æ•°å¼ç»„ä»¶  functional: true,  // ç»„ä»¶æ¥æ”¶çš„å¤–éƒ¨å±æ€§  props: {    avatar: {      type: String    }  },  /**   * æ¸²æŸ“å‡½æ•°   * @param {*} h   * @param {*} context å‡½æ•°å¼ç»„ä»¶æ²¡æœ‰this, props, slotsç­‰éƒ½åœ¨contextä¸Šé¢æŒ‚ç€   */  render(h, context) {    const { props } = context    if (props.avatar) {      return &lt;img src={props.avatar}&gt;&lt;/img&gt;    }    return &lt;img src=&quot;default-avatar.png&quot;&gt;&lt;/img&gt;  }}</code></pre><p>åœ¨ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¤´åƒç»„ä»¶ï¼Œå¦‚æœå¤–éƒ¨ä¼ å…¥å¤´åƒï¼Œåˆ™æ˜¾ç¤ºä¼ å…¥çš„å¤´åƒï¼Œå¦åˆ™æ˜¾ç¤ºé»˜è®¤å¤´åƒã€‚ä¸Šé¢çš„ä»£ç ä¸­å¤§å®¶çœ‹åˆ°æœ‰ä¸€ä¸ª<code>render</code>å‡½æ•°ï¼Œè¿™ä¸ªæ˜¯Vueä½¿ç”¨<code>JSX</code>çš„å†™æ³•ï¼Œå…³äº<code>JSX</code>,å°ç¼–å°†åœ¨åç»­æ–‡ç« ä¸­ä¼šå‡ºè¯¦ç»†çš„ä½¿ç”¨æ•™ç¨‹ã€‚</p><h3 id="ä¸ºä»€ä¹ˆä½¿ç”¨å‡½æ•°å¼ç»„ä»¶"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨å‡½æ•°å¼ç»„ä»¶" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨å‡½æ•°å¼ç»„ä»¶"></a>ä¸ºä»€ä¹ˆä½¿ç”¨å‡½æ•°å¼ç»„ä»¶</h3><p>1.æœ€ä¸»è¦æœ€å…³é”®çš„åŸå› æ˜¯å‡½æ•°å¼ç»„ä»¶ä¸éœ€è¦å®ä¾‹åŒ–ï¼Œæ— çŠ¶æ€ï¼Œæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€ä»¥æ¸²æŸ“æ€§èƒ½è¦å¥½äºæ™®é€šç»„ä»¶<br>2.å‡½æ•°å¼ç»„ä»¶ç»“æ„æ¯”è¾ƒç®€å•ï¼Œä»£ç ç»“æ„æ›´æ¸…æ™°</p><h3 id="å‡½æ•°å¼ç»„ä»¶ä¸æ™®é€šç»„ä»¶çš„åŒºåˆ«"><a href="#å‡½æ•°å¼ç»„ä»¶ä¸æ™®é€šç»„ä»¶çš„åŒºåˆ«" class="headerlink" title="å‡½æ•°å¼ç»„ä»¶ä¸æ™®é€šç»„ä»¶çš„åŒºåˆ«"></a>å‡½æ•°å¼ç»„ä»¶ä¸æ™®é€šç»„ä»¶çš„åŒºåˆ«</h3><p>1.å‡½æ•°å¼ç»„ä»¶éœ€è¦åœ¨å£°æ˜ç»„ä»¶æ˜¯æŒ‡å®šfunctional<br>2.å‡½æ•°å¼ç»„ä»¶ä¸éœ€è¦å®ä¾‹åŒ–ï¼Œæ‰€ä»¥æ²¡æœ‰this,thisé€šè¿‡renderå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æ¥ä»£æ›¿<br>3.å‡½æ•°å¼ç»„ä»¶æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨è®¡ç®—å±æ€§ï¼Œwatchç­‰ç­‰<br>4.å‡½æ•°å¼ç»„ä»¶ä¸èƒ½é€šè¿‡$emitå¯¹å¤–æš´éœ²äº‹ä»¶ï¼Œè°ƒç”¨äº‹ä»¶åªèƒ½é€šè¿‡context.listeners.clickçš„æ–¹å¼è°ƒç”¨å¤–éƒ¨ä¼ å…¥çš„äº‹ä»¶<br>5.å› ä¸ºå‡½æ•°å¼ç»„ä»¶æ˜¯æ²¡æœ‰å®ä¾‹åŒ–çš„ï¼Œæ‰€ä»¥åœ¨å¤–éƒ¨é€šè¿‡refå»å¼•ç”¨ç»„ä»¶æ—¶ï¼Œå®é™…å¼•ç”¨çš„æ˜¯HTMLElement<br>6.å‡½æ•°å¼ç»„ä»¶çš„propså¯ä»¥ä¸ç”¨æ˜¾ç¤ºå£°æ˜ï¼Œæ‰€ä»¥æ²¡æœ‰åœ¨propsé‡Œé¢å£°æ˜çš„å±æ€§éƒ½ä¼šè¢«è‡ªåŠ¨éšå¼è§£æä¸ºprop,è€Œæ™®é€šç»„ä»¶æ‰€æœ‰æœªå£°æ˜çš„å±æ€§éƒ½è¢«è§£æåˆ°$attrsé‡Œé¢ï¼Œå¹¶è‡ªåŠ¨æŒ‚è½½åˆ°ç»„ä»¶æ ¹å…ƒç´ ä¸Šé¢(å¯ä»¥é€šè¿‡inheritAttrså±æ€§ç¦æ­¢)</p><h3 id="æˆ‘ä¸æƒ³ç”¨JSXï¼Œèƒ½ç”¨å‡½æ•°å¼ç»„ä»¶å—ï¼Ÿ"><a href="#æˆ‘ä¸æƒ³ç”¨JSXï¼Œèƒ½ç”¨å‡½æ•°å¼ç»„ä»¶å—ï¼Ÿ" class="headerlink" title="æˆ‘ä¸æƒ³ç”¨JSXï¼Œèƒ½ç”¨å‡½æ•°å¼ç»„ä»¶å—ï¼Ÿ"></a>æˆ‘ä¸æƒ³ç”¨JSXï¼Œèƒ½ç”¨å‡½æ•°å¼ç»„ä»¶å—ï¼Ÿ</h3><p>åœ¨<code>Vue2.5</code>ä¹‹å‰ï¼Œä½¿ç”¨å‡½æ•°å¼ç»„ä»¶åªèƒ½é€šè¿‡<code>JSX</code>çš„æ–¹å¼ï¼Œåœ¨ä¹‹åï¼Œå¯ä»¥é€šè¿‡æ¨¡æ¿è¯­æ³•æ¥ç”Ÿå‘½å‡½æ•°å¼ç»„ä»¶</p><pre><code class="html">&lt;!--åœ¨template ä¸Šé¢æ·»åŠ  functionalå±æ€§--&gt;&lt;template functional&gt;  &lt;img :src=&quot;props.avatar ? props.avatar : &#39;default-avatar.png&#39;&quot; /&gt;&lt;/template&gt;&lt;!--æ ¹æ®ä¸Šä¸€èŠ‚ç¬¬å…­æ¡ï¼Œå¯ä»¥çœç•¥å£°æ˜props--&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES2020çš„æ–°åŠŸèƒ½</title>
      <link href="/2020/05/25/Js/ES2020%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/"/>
      <url>/2020/05/25/Js/ES2020%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5eca8607e51d457890602072?utm_source=gold_browser_extension#heading-15" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿‘å¹´æ¥ï¼ŒJavaScript çš„å‘å±•éå¸¸è¿…é€Ÿã€‚ å°¤å…¶æ˜¯åœ¨2015 å¹´ ES6 å‘å¸ƒä¹‹åï¼Œæƒ…å†µå˜å¾—æ›´å¥½ã€‚</p><p>ç°åœ¨ è®¸å¤šæ–°çš„ç‰¹æ€§è¢«æè®®åŒ…æ‹¬åœ¨ <code>ES2020</code>ç‰ˆæœ¬ä¸­ã€‚å¥½æ¶ˆæ¯æ˜¯è¿™äº›å·²ç»å·²ç»æ•²å®šã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬è·å¾—äº†æœ€ç»ˆå®šç¨¿çš„åŠŸèƒ½æ¸…å•ï¼Œå®ƒä»¬å°†åœ¨è¢«æ‰¹å‡†å‘å¸ƒä¹‹åå‡ºç°åœ¨å¤‡å—æœŸå¾…çš„ <code>ES2020</code> ä¸­ã€‚ å…¶ä¸­ä¸€äº›åŠŸèƒ½ä½¿æˆ‘éå¸¸å…´å¥‹ï¼Œå› ä¸ºåœ¨å®ƒä»¬å­˜åœ¨ä¹‹å‰ç¼–å†™ä»£ç æ—¶é‡åˆ°å°†ä¼šé‡åˆ°å¾ˆå¤šéº»çƒ¦ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬æ˜¯ä»€ä¹ˆå§ï¼</p><h2 id="å¯é€‰é“¾æ“ä½œç¬¦ï¼ˆOptional-Chaining-Operatorï¼‰"><a href="#å¯é€‰é“¾æ“ä½œç¬¦ï¼ˆOptional-Chaining-Operatorï¼‰" class="headerlink" title="å¯é€‰é“¾æ“ä½œç¬¦ï¼ˆOptional Chaining Operatorï¼‰"></a>å¯é€‰é“¾æ“ä½œç¬¦ï¼ˆOptional Chaining Operatorï¼‰</h2><p>å¯¹æˆ‘ä¸ªäººæ¥è¯´ï¼Œè¿™æ˜¯ ES2020æœ€ä»¤äººå…´å¥‹çš„ç‰¹ç‚¹ä¹‹ä¸€ã€‚ æˆ‘å·²ç»ç¼–å†™äº†å¾ˆå¤šç¨‹åºï¼Œè¿™äº›ç¨‹åºå°†ä¼šä»è¿™ä¸ªæ–°ç‰¹æ€§ä¸­è·ç›ŠåŒªæµ…ã€‚</p><p>å¯é€‰é“¾æ“ä½œç¬¦<strong>å…è®¸æ‚¨å®‰å…¨åœ°è®¿é—®å¯¹è±¡çš„æ·±åµŒå¥—å±æ€§ï¼Œè€Œä¸å¿…æ£€æŸ¥æ¯ä¸ªå±æ€§æ˜¯å¦å­˜åœ¨</strong>ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªç‰¹æ€§å¯¹æˆ‘ä»¬æœ‰ä»€ä¹ˆå¸®åŠ©ã€‚</p><h3 id="æ‹¥æœ‰å¯é€‰é“¾æ“ä½œç¬¦ä¹‹å‰"><a href="#æ‹¥æœ‰å¯é€‰é“¾æ“ä½œç¬¦ä¹‹å‰" class="headerlink" title="æ‹¥æœ‰å¯é€‰é“¾æ“ä½œç¬¦ä¹‹å‰"></a>æ‹¥æœ‰å¯é€‰é“¾æ“ä½œç¬¦ä¹‹å‰</h3><pre><code class="js">const user = {  firstName: &quot;Joseph&quot;,  lastName: &quot;Kuruvilla&quot;,  age: 38,  address: {    number: &quot;239&quot;,    street: &quot;Ludwig Lane&quot;,    city: &quot;Chennai&quot;,    zip: &quot;600028&quot;,    prop1: {      prop2: {        prop3: {          prop4: {            value: &quot;sample&quot;,          },        },      },    },  },};if (user &amp;&amp; user.address) {  console.log(user.address.zip);  //600028}if (  user &amp;&amp;  user.address &amp;&amp;  user.address.prop1 &amp;&amp;  user.address.prop1.prop2 &amp;&amp;  user.address.prop1.prop2.prop3 &amp;&amp;  user.address.prop1.prop2.prop3.prop4) {  console.log(user.address.prop1.prop2.prop3.prop4.value);  //sample}//Accessing unexisting propertyconsole.log(user.address.prop102.po);//Error</code></pre><p>æ­£å¦‚æ‚¨åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œæ‚¨<strong>å¿…é¡»æ£€æŸ¥æ¯ä¸ªçº§åˆ«ä¸­æ˜¯å¦å­˜åœ¨è¯¥å±æ€§ï¼Œä»¥é¿å…å‡ºç°æ— æ³•è¯»å–æœªå®šä¹‰å±æ€§â€œ poâ€çš„é”™è¯¯</strong>ã€‚ éšç€åµŒå¥—çº§åˆ«çš„å¢åŠ ï¼Œæ‰‹åŠ¨æ£€æŸ¥çš„å±æ€§æ•°é‡ä¹Ÿä¼šå¢åŠ ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»æ£€æŸ¥æ¯ä¸ªçº§åˆ«ï¼Œä»¥ç¡®ä¿å®ƒä¸ä¼šåœ¨é‡åˆ°æœªå®šä¹‰æˆ–ç©ºå¯¹è±¡æ—¶å´©æºƒã€‚</p><h3 id="æ‹¥æœ‰å¯é€‰é“¾å¼æ“ä½œç¬¦ä¹‹å"><a href="#æ‹¥æœ‰å¯é€‰é“¾å¼æ“ä½œç¬¦ä¹‹å" class="headerlink" title="æ‹¥æœ‰å¯é€‰é“¾å¼æ“ä½œç¬¦ä¹‹å"></a>æ‹¥æœ‰å¯é€‰é“¾å¼æ“ä½œç¬¦ä¹‹å</h3><p>éšç€<code>å¯é€‰é“¾å¼æ“ä½œç¬¦ (Optional Chaining)</code> çš„å¼•å…¥ï¼Œæˆ‘ä»¬å‰ç«¯çš„å·¥ä½œå˜å¾—å®¹æ˜“å¤šäº†ã€‚ é€šè¿‡ç®€å•åœ°ä½¿ç”¨å¯é€‰é“¾å¼æ“ä½œç¬¦  <code>?.</code>  æˆ‘ä»¬å¯ä»¥è®¿é—®æ·±åµŒå¥—çš„å¯¹è±¡ï¼Œè€Œä¸å¿…æ£€æŸ¥æœªå®šä¹‰æˆ–ç©ºå¯¹è±¡ã€‚</p><pre><code class="js">const user = {  firstName: &quot;Joseph&quot;,  lastName: &quot;Kuruvilla&quot;,  age: 38,  address: {    number: &quot;239&quot;,    street: &quot;Ludwig Lane&quot;,    city: &quot;Chennai&quot;,    zip: &quot;600028&quot;,    prop1: {      prop2: {        prop3: {          prop4: {            value: &quot;sample&quot;,          },        },      },    },  },};console.log(user?.address?.zip);// 600028console.log(user?.address?.prop1?.prop2?.prop3?.prop4?.value);// sample//Accessing unexisting propertyconsole.log(user?.address?.prop102?.po);//undefined</code></pre><h2 id="ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ï¼ˆNullish-coalescing-operatorï¼‰"><a href="#ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ï¼ˆNullish-coalescing-operatorï¼‰" class="headerlink" title="ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ï¼ˆNullish coalescing operatorï¼‰"></a>ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ï¼ˆNullish coalescing operatorï¼‰</h2><p>è¿™æ˜¯å¦ä¸€ä¸ªä»¤æˆ‘å…´å¥‹çš„åŠŸèƒ½ï¼Œå½“æˆ‘ç¬¬ä¸€æ¬¡åœ¨<strong>proposal stage</strong>ï¼Œ äº†è§£åˆ°çš„æ—¶å€™ï¼Œæˆ‘ç”±è¡·çš„å–œæ¬¢è¿™ä¸ªç‰¹æ€§ï¼Œå› ä¸ºæˆ‘å·²ç»å†äº†ç¼–å†™å•ç‹¬çš„å‡½æ•°æ¥æ‰‹åŠ¨æ£€æŸ¥è¿™ä¸ªç‰¹æ€§çš„éº»çƒ¦ã€‚</p><p><code>ç©ºå€¼åˆå¹¶æ“ä½œç¬¦</code>å…è®¸æ‚¨æ£€æŸ¥  <code>nullish</code>  å€¼è€Œä¸æ˜¯  <code>falsey</code>  å€¼ã€‚ <code>Nullish</code> å€¼æ˜¯æŒ‡  <code>null æˆ– undefined</code> çš„å€¼ã€‚ è€Œ falsey å€¼æ˜¯è¯¸å¦‚<code>ç©ºå­—ç¬¦ä¸²ã€æ•°å­—0ã€  undefined ã€  null ã€  false ã€  NaN</code>  ç­‰ç­‰çš„å€¼ã€‚ è¿™å¯¹ä½ æ¥è¯´å¯èƒ½å¬èµ·æ¥æ²¡ä»€ä¹ˆä¸åŒï¼Œä½†æ˜¯åœ¨ç°å®ä¸­ï¼Œè¿™æ„å‘³ç€å¾ˆå¤šã€‚</p><h3 id="åœ¨æœ‰ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ä¹‹å‰"><a href="#åœ¨æœ‰ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ä¹‹å‰" class="headerlink" title="åœ¨æœ‰ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ä¹‹å‰"></a>åœ¨æœ‰ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ä¹‹å‰</h3><p>æˆ‘æœ€è¿‘åšäº†ä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘éœ€è¦å…è®¸é»‘æš—æ¨¡å¼ï¼ˆDark Modeï¼‰åˆ‡æ¢åŠŸèƒ½ã€‚ æˆ‘å¿…é¡»æ£€æŸ¥è¾“å…¥æ˜¯  <code>true</code> è¿˜æ˜¯  <code>false</code> ã€‚ å¦‚æœç”¨æˆ·æ²¡æœ‰è®¾ç½®ä»»ä½•å€¼ï¼Œåˆ™é»˜è®¤ä¸º  <code>true</code> ã€‚ ä¸‹é¢å°±æ˜¯æˆ‘å¦‚ä½•åœ¨æœ‰<code>ç©ºå€¼åˆå¹¶æ“ä½œç¬¦</code>ä¹‹å‰å®ç°å®ƒçš„ï¼š</p><pre><code class="js">const darkModePreference1 = true;const darkModePreference2 = false;const darkModePreference3 = undefined;const darkModePreference4 = null;const getUserDarkModePreference = (darkModePreference) =&gt; {  if (darkModePreference || darkModePreference === false) {    return darkModePreference;  }  return true;};getUserDarkModePreference(darkModePreference1);// truegetUserDarkModePreference(darkModePreference2);// falsegetUserDarkModePreference(darkModePreference3);// truegetUserDarkModePreference(darkModePreference4);// true</code></pre><h3 id="åœ¨æœ‰ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ä¹‹å"><a href="#åœ¨æœ‰ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ä¹‹å" class="headerlink" title="åœ¨æœ‰ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ä¹‹å"></a>åœ¨æœ‰ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ä¹‹å</h3><p>åœ¨æœ‰ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ä¹‹åï¼Œæ‚¨æ‰€è¦åšçš„å°±æ˜¯ä½¿ç”¨  <code>??</code>  æ“ä½œç¬¦ã€‚ä¸éœ€è¦  <code>if</code>  è¯­å¥ï¼š\</p><pre><code class="js">const darkModePreference1 = true;const darkModePreference2 = false;const darkModePreference3 = undefined;const darkModePreference4 = null;const getUserDarkModePreference = (darkModePreference) =&gt; {  return darkModePreference ?? true;};getUserDarkModePreference(darkModePreference1);// truegetUserDarkModePreference(darkModePreference2);// falsegetUserDarkModePreference(darkModePreference3);// truegetUserDarkModePreference(darkModePreference4);// true</code></pre><p>è¿™é‡ŒåŸºæœ¬ä¸Šå‘ç”Ÿçš„æƒ…å†µæ˜¯ï¼Œå¦‚æœå˜é‡ darkModePreference åŒ…å«ä¸€ä¸ª  <code>nullish</code>  å€¼ï¼Œé‚£ä¹ˆå°†å€¼ <code>true</code> èµ‹ç»™å®ƒã€‚ ç®€å•ï¼Œç®€çŸ­ï¼Œæ˜“äºç†è§£ã€‚</p><h2 id="åŠ¨æ€-importï¼ˆDynamic-Importsï¼‰"><a href="#åŠ¨æ€-importï¼ˆDynamic-Importsï¼‰" class="headerlink" title="åŠ¨æ€ importï¼ˆDynamic Importsï¼‰"></a>åŠ¨æ€ importï¼ˆDynamic Importsï¼‰</h2><p>è¿™ä¸ªç‰¹æ€§å°†å¸®åŠ©æ‚¨çš„åº”ç”¨ç¨‹åºæ›´åŠ é«˜æ•ˆçš„æ‰§è¡Œï¼Œ <code>åŠ¨æ€ import</code> å…è®¸æ‚¨å°† JS æ–‡ä»¶ä½œä¸ºåŸç”Ÿåº”ç”¨ç”¨ç¨‹åºä¸­çš„æ¨¡å—åŠ¨æ€å¯¼å…¥ã€‚ åœ¨ <code>ES2020</code>ä¹‹å‰ï¼Œä¸ç®¡æ˜¯å¦ä½¿ç”¨æ¨¡å—ï¼Œéƒ½åº”è¯¥å¯¼å…¥æ¨¡å—ã€‚<br>ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªåŠŸèƒ½æ¥ä¸‹è½½ pdf æ ¼å¼çš„æ–‡ä»¶ã€‚<br>è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ <code>åŠ¨æ€ import</code> ä¹‹å‰å’Œä¹‹åå®ç°è¿™ä¸€ç‚¹ã€‚</p><h3 id="åœ¨-åŠ¨æ€-import-ä¹‹å‰"><a href="#åœ¨-åŠ¨æ€-import-ä¹‹å‰" class="headerlink" title="åœ¨ åŠ¨æ€ import  ä¹‹å‰"></a>åœ¨ åŠ¨æ€ import  ä¹‹å‰</h3><p>å®é™…ä¸Šï¼Œä¸ä¼šæ‰€æœ‰çš„é¡µé¢è®¿é—®è€…ä½¿ç”¨ä¸‹è½½ pdf çš„é€‰é¡¹ã€‚ ä½†æ˜¯ï¼Œæ— è®ºæˆ‘ä»¬çš„è®¿å®¢æ˜¯å¦ä½¿ç”¨å®ƒï¼Œå®ƒä»ç„¶éœ€è¦è¢«å¯¼å…¥ã€‚ è¿™æ„å‘³ç€è¿™ä¸ª pdf æ¨¡å—ä¹Ÿå¯ä»¥åœ¨é¡µé¢åŠ è½½æœŸé—´è¢«ä¸‹è½½ã€‚</p><pre><code class="js">import { exportAsPdf } from &quot;./export-as-pdf.js&quot;;const exportPdfButton = document.querySelector(&quot;.exportPdfBtn&quot;);exportPdfButton.addEventListener(&quot;click&quot;, exportAsPdf);</code></pre><p>è¿™ç§å¼€é”€å¯ä»¥é€šè¿‡ä½¿ç”¨<code>å»¶è¿ŸåŠ è½½æ¨¡å—ï¼ˆlazy loaded modules</code>ï¼‰æ¥å‡å°‘ã€‚ å¯ä»¥é€šè¿‡ç§°ä¸º<code>ä»£ç åˆ†å‰² ï¼ˆcode-splittingï¼‰</code>çš„æ–¹æ³•æ¥å®ç°ï¼Œè¿™åœ¨ Webpack æˆ–å…¶ä»–æ¨¡å—æ‰“åŒ…å·¥å…·å·²ç»å¯ä»¥ä½¿ç”¨äº†ã€‚<br>ä½†æ˜¯å¯¹äº ES2020ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒäº†ï¼Œè€Œä¸éœ€è¦æ¨¡å—æ‰“åŒ…å·¥å…·ï¼Œå¦‚ Webpackã€‚</p><h3 id="åœ¨åŠ¨æ€å¯¼å…¥ï¼ˆåŠ¨æ€-importï¼‰ä¹‹å"><a href="#åœ¨åŠ¨æ€å¯¼å…¥ï¼ˆåŠ¨æ€-importï¼‰ä¹‹å" class="headerlink" title="åœ¨åŠ¨æ€å¯¼å…¥ï¼ˆåŠ¨æ€ importï¼‰ä¹‹å"></a>åœ¨åŠ¨æ€å¯¼å…¥ï¼ˆåŠ¨æ€ importï¼‰ä¹‹å</h3><pre><code class="js">const exportPdfButton = document.querySelector(&#39;.exportPdfBtn&#39;);exportPdfButton.addEventListener(&#39;click&#39;, () =&gt; {  import(&#39;./export-as-pdf.js&#39;)    .then(module =&gt; {      module.exportAsPdf()    })    .catch(err =&gt; {      // handle the error if the module fails to load    })})</code></pre><p>æ­£å¦‚æ‚¨åœ¨ä¸Šé¢çš„ä»£ç ä¸­çœ‹åˆ°çš„ï¼Œç°åœ¨åªæœ‰åœ¨éœ€è¦æ¨¡å—æ—¶æ‰å»¶è¿ŸåŠ è½½æ¨¡å—ã€‚ ä»è€Œå‡å°‘å¼€é”€å’Œé¡µé¢åŠ è½½æ—¶é—´ã€‚</p><h3 id="Promise-allSettled"><a href="#Promise-allSettled" class="headerlink" title="Promise.allSettled"></a>Promise.allSettled</h3><p>å¦‚æœä½ æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œåœ¨æ‰€æœ‰ <code>Promise</code> éƒ½å®Œæˆä¹‹åå¿…é¡»æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä½¿ç”¨  <code>Promise.all()</code> æ–¹æ³•ã€‚ ä½†æ˜¯è¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªç¼ºç‚¹ã€‚ å½“ä½ çš„ä»»ä½•ä¸€ä¸ª <code>Promise</code> è¢« <code>Rejected</code> æ—¶ï¼Œ<code>Promise</code> æ–¹æ³•å°±ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ è¿™æ„å‘³ç€æ‚¨çš„ä»£ç ä¸ä¼šç­‰åˆ°æ‰€æœ‰çš„ <code>Promise</code> éƒ½å®Œæˆã€‚<br>è¿™å¯èƒ½ä¸æ˜¯ä½ æƒ³è¦çš„ã€‚ å¦‚æœä½ æƒ³è¦è¿™æ ·çš„ä¸œè¥¿: â€œæˆ‘ä¸åœ¨ä¹ä»–ä»¬çš„ç»“æœã€‚ åªéœ€å…¨éƒ¨è¿è¡Œâ€ ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨æ–°çš„  <code>Promise.allSettled()</code> æ–¹æ³•ã€‚ è¿™ç§æ–¹æ³•åªæœ‰åœ¨ä½ çš„æ‰€æœ‰ Promise éƒ½  <code>settled</code> ãƒ¼ãƒ¼ è¦ä¹ˆ  <code>Resolved</code> ï¼Œè¦ä¹ˆ  <code>Rejected</code> ãƒ¼ãƒ¼ æ—¶æ‰ä¼š  <code>Resolved</code> ã€‚</p><h3 id="åœ¨æ‹¥æœ‰-Promise-allSettled-ä¹‹å‰"><a href="#åœ¨æ‹¥æœ‰-Promise-allSettled-ä¹‹å‰" class="headerlink" title="åœ¨æ‹¥æœ‰ Promise.allSettled ä¹‹å‰"></a>åœ¨æ‹¥æœ‰ Promise.allSettled ä¹‹å‰</h3><pre><code class="js">const PromiseArray = [  Promise.resolve(100),  Promise.reject(null),  Promise.resolve(&quot;Data release&quot;),  Promise.reject(new Error(&quot;Something went wrong&quot;)),];Promise.all(PromiseArray)  .then((data) =&gt;    console.log(&quot;all resolved! here are the resolve values:&quot;, data)  )  .catch((err) =&gt; console.log(&quot;got rejected! reason:&quot;, err));//got rejected! reason: null</code></pre><p>å¦‚ä¸Šæ‰€è¿°ï¼Œå½“å…¶ä¸­ä¸€ä¸ª Promise è¢«  rejected æ—¶ï¼Œ Promise å°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><h3 id="åœ¨æ‹¥æœ‰-Promise-allSettled-ä¹‹å"><a href="#åœ¨æ‹¥æœ‰-Promise-allSettled-ä¹‹å" class="headerlink" title="åœ¨æ‹¥æœ‰ Promise.allSettled ä¹‹å"></a>åœ¨æ‹¥æœ‰ Promise.allSettled ä¹‹å</h3><pre><code class="js">const PromiseArray = [  Promise.resolve(100),  Promise.reject(null),  Promise.resolve(&quot;Data release&quot;),  Promise.reject(new Error(&quot;Something went wrong&quot;)),];Promise.allSettled(PromiseArray)  .then((res) =&gt; {    console.log(res);  })  .catch((err) =&gt; console.log(err));//[//  {status: &quot;fulfilled&quot;, value: 100},//  {status: &quot;rejected&quot;, reason: null},//  {status: &quot;fulfilled&quot;, value: &quot;Data release&quot;},//  {status: &quot;rejected&quot;, reason: Error: Something went wrong ...}//]</code></pre><p>å°½ç®¡æœ‰äº› Promise è¢« rejected äº†ï¼ŒPromise.allSettled è¿”å›äº†æ‰€æœ‰çš„ Promise çš„ç»“æœ</p><h2 id="globalThis"><a href="#globalThis" class="headerlink" title="globalThis"></a>globalThis</h2><p><code>globalThis</code>  åŒ…å«å¯¹å…¨å±€å¯¹è±¡çš„å¼•ç”¨ï¼Œä¸ç¯å¢ƒæ— å…³ã€‚ åœ¨æµè§ˆå™¨ä¸­ï¼Œå…¨å±€å¯¹è±¡æ˜¯  <code>window å¯¹è±¡</code>ã€‚ åœ¨ Node ç¯å¢ƒä¸­ï¼Œå…¨å±€å¯¹è±¡æ˜¯   <code>global</code> æˆ–è€… Web workers ä¸­çš„  <code>self</code>ã€‚</p><h3 id="åœ¨æ‹¥æœ‰-globalThis-ä¹‹å‰"><a href="#åœ¨æ‹¥æœ‰-globalThis-ä¹‹å‰" class="headerlink" title="åœ¨æ‹¥æœ‰ globalThis ä¹‹å‰"></a>åœ¨æ‹¥æœ‰ globalThis ä¹‹å‰</h3><p>æˆ‘ä»¬åœ¨å·¥ä½œä¸­ä¼šæœ‰éœ€è¦ç¼–å†™ä¸€ä»½åŒæ—¶è¿è¡Œåœ¨ Node å’Œæµè§ˆå™¨ä¸­çš„é€šç”¨ä»£ç ï¼Œå½“æˆ‘ä»¬è¦å–å¾—å…¨å±€å¯¹è±¡æ—¶ï¼Œé€šå¸¸éœ€è¦åšå¾ˆå¤šå·¥ä½œå’Œé€»è¾‘åˆ¤æ–­ï¼š</p><pre><code class="js">beforeGlobalThis = (typeof window !== &quot;undefined&quot;? window: (typeof process === &#39;object&#39; &amp;&amp;   typeof require === &#39;function&#39; &amp;&amp;   typeof global === &#39;object&#39;)    ? global    : this);beforeGlobalThis.tuture = &#39;å°è‹¥ç‡•é›€ï¼Œäº¦å¯ä¸€å±•å®å›¾&#39;;</code></pre><h2 id="åœ¨æ‹¥æœ‰-globalThis-ä¹‹å"><a href="#åœ¨æ‹¥æœ‰-globalThis-ä¹‹å" class="headerlink" title="åœ¨æ‹¥æœ‰ globalThis ä¹‹å"></a>åœ¨æ‹¥æœ‰ globalThis ä¹‹å</h2><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>globalThis</code> å»å¼•ç”¨å…¨å±€å¯¹è±¡ï¼Œè€Œä¸ç”¨å»æ‹…å¿ƒç¯å¢ƒçš„é—®é¢˜ï¼š</p><pre><code class="js">globalThis.tuture = &#39;å°è‹¥ç‡•é›€ï¼Œäº¦å¯ä¸€å±•å®å›¾&#39;;</code></pre><p>ä¸Šé¢çš„ä»£ç åœ¨æµè§ˆå™¨æˆ–è€… Node ç¯å¢ƒä¸­éƒ½æ˜¯é€šç”¨çš„ï¼Œä½ å¯ä»¥æ”¾å¿ƒä½¿ç”¨ï¼</p><h2 id="BigInt"><a href="#BigInt" class="headerlink" title="BigInt"></a>BigInt</h2><p>å…è®¸æ‚¨ä½¿ç”¨å¤§äº <code>Javascript</code> ä¸­å…è®¸çš„æœ€å¤§å€¼çš„æ•°å­—ã€‚ è¿™ä¸ªæ•°å­—æ˜¯ <code>pow(2,53)-1</code> ã€‚ å°½ç®¡è¿™ä¸èƒ½å‘åå…¼å®¹ï¼Œå› ä¸ºä¼ ç»Ÿçš„æ•°å­—ç³»ç»Ÿ<code>(IEEE 754)</code>ä¸èƒ½æ”¯æŒè¿™ç§å¤§å°çš„æ•°å­—ã€‚</p><h2 id="String-matchall"><a href="#String-matchall" class="headerlink" title="String.matchall"></a>String.matchall</h2><p><code>matchAll()</code> æ˜¯ä¸€ä¸ªä¸<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼</a>ç›¸å…³çš„æ–¹æ³•ã€‚ æ­¤æ–¹æ³•è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­—ç¬¦ä¸²çš„æ‰€æœ‰ç»“æœçš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Iterators_and_Generators" target="_blank" rel="noopener">è¿­ä»£å™¨</a>ï¼ŒåŒ…æ‹¬æ•è·ç»„ã€‚ è¿™ä¸ªæ–¹æ³•å·²ç»è¢«æ·»åŠ åˆ° String åŸå‹ä¸­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº†è§£ä¸‹denoï¼Œä¸nodeçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</title>
      <link href="/2020/05/17/Deno/%E4%BA%86%E8%A7%A3%E4%B8%8Bdeno%EF%BC%8C%E4%B8%8Enode%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/"/>
      <url>/2020/05/17/Deno/%E4%BA%86%E8%A7%A3%E4%B8%8Bdeno%EF%BC%8C%E4%B8%8Enode%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="Deno-VS-Node"><a href="#Deno-VS-Node" class="headerlink" title="Deno VS Node"></a>Deno VS Node</h1><table><thead><tr><th>ä¸åŒç‚¹</th><th style="text-align:right">Node</th><th style="text-align:center">Deno</th></tr></thead><tbody><tr><td>API å¼•ç”¨æ–¹å¼</td><td style="text-align:right">æ¨¡å—å¯¼å…¥</td><td style="text-align:center">å…¨å±€å¯¹è±¡</td></tr><tr><td>æ¨¡å—ç³»ç»Ÿ</td><td style="text-align:right">CommonJS &amp; æ–°ç‰ˆ node å®éªŒæ€§ ES Module</td><td style="text-align:center">ES Module æµè§ˆå™¨å®ç°</td></tr><tr><td>å®‰å…¨</td><td style="text-align:right">æ— å®‰å…¨é™åˆ¶</td><td style="text-align:center">é»˜è®¤å®‰å…¨</td></tr><tr><td>Typescript</td><td style="text-align:right">ç¬¬ä¸‰æ–¹ï¼Œå¦‚é€šè¿‡ ts-node æ”¯æŒ</td><td style="text-align:center">åŸç”Ÿæ”¯æŒ</td></tr><tr><td>åŒ…ç®¡ç†</td><td style="text-align:right">npm + node_modules</td><td style="text-align:center">åŸç”Ÿæ”¯æŒ</td></tr><tr><td>å¼‚æ­¥æ“ä½œ</td><td style="text-align:right">å›è°ƒ</td><td style="text-align:center">Promise</td></tr><tr><td>åŒ…åˆ†å‘</td><td style="text-align:right">ä¸­å¿ƒåŒ– npmjs.com</td><td style="text-align:center">å»ä¸­å¿ƒåŒ– import url</td></tr><tr><td>å…¥å£</td><td style="text-align:right">package.json é…ç½®</td><td style="text-align:center">import url ç›´æ¥å¼•å…¥</td></tr><tr><td>æ‰“åŒ…ã€æµ‹è¯•ã€æ ¼å¼åŒ–</td><td style="text-align:right">ç¬¬ä¸‰æ–¹å¦‚ eslintã€gulpã€webpackã€babel ç­‰</td><td style="text-align:center">åŸç”Ÿæ”¯æŒ</td></tr></tbody></table><h2 id="1-å†…ç½®-API-å¼•ç”¨æ–¹å¼ä¸åŒ"><a href="#1-å†…ç½®-API-å¼•ç”¨æ–¹å¼ä¸åŒ" class="headerlink" title="1.å†…ç½® API å¼•ç”¨æ–¹å¼ä¸åŒ"></a>1.å†…ç½® API å¼•ç”¨æ–¹å¼ä¸åŒ</h2><p><strong>node æ¨¡å—å¯¼å…¥</strong></p><p>node å†…ç½® API é€šè¿‡æ¨¡å—å¯¼å…¥çš„æ–¹å¼å¼•ç”¨ï¼Œä¾‹å¦‚ï¼š</p><pre><code class="js">const fs = require(&quot;fs&quot;);fs.readFileSync(&quot;./data.txt&quot;);</code></pre><p><strong>deno å…¨å±€å¯¹è±¡</strong></p><p>è€Œ deno åˆ™æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ Deno çš„å±æ€§å’Œæ–¹æ³•ï¼š</p><pre><code class="js">Deno.readFileSync(&quot;./data.txt&quot;);å…·ä½“ deno æœ‰å“ªäº›æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ repl çœ‹ä¸€ä¸‹ï¼š</code></pre><pre><code class="js">deno # æˆ– deno repl</code></pre><p>è¿›å…¥ <code>repl</code> åï¼Œè¾“å…¥ Deno å›è½¦ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><pre><code class="json">{ Buffer: [Function: Buffer], readAll: [AsyncFunction: readAll], readAllSync: [Function: readAllSync], writeAll: [AsyncFunction: writeAll], writeAllSync: [Function: writeAllSync], # .....}</code></pre><p>è¿™ç§å¤„ç†çš„æ–¹å¼å¥½å¤„æ˜¯<strong>ç®€å•ã€æ–¹ä¾¿</strong>ï¼Œåå¤„æ˜¯<strong>æ²¡æœ‰åˆ†ç±»</strong>ï¼Œæƒ³æŸ¥æ‰¾å¿˜è®°çš„ API æ¯”è¾ƒå›°éš¾ã€‚æ€»ä½“æ¥è¯´è§ä»è§æ™ºã€‚</p><h2 id="2-æ¨¡å—ç³»ç»Ÿ"><a href="#2-æ¨¡å—ç³»ç»Ÿ" class="headerlink" title="2.æ¨¡å—ç³»ç»Ÿ"></a>2.æ¨¡å—ç³»ç»Ÿ</h2><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹æ¨¡å—ç³»ç»Ÿï¼Œè¿™ä¹Ÿæ˜¯ deno å’Œ node <strong>å·®åˆ«æœ€å¤§çš„åœ°æ–¹</strong>ï¼ŒåŒæ ·ä¹Ÿæ˜¯ deno å’Œ node ä¸å…¼å®¹çš„åœ°æ–¹ã€‚</p><p><strong>node CommonJS è§„èŒƒ</strong><br>æˆ‘ä»¬éƒ½çŸ¥é“ node é‡‡ç”¨çš„æ˜¯ CommonJS è§„èŒƒï¼Œè€Œ deno åˆ™æ˜¯é‡‡ç”¨çš„ ES Module çš„æµè§ˆå™¨å®ç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆæ¥è®¤è¯†ä¸€ä¸‹ï¼š</p><p><strong>ES Module çš„æµè§ˆå™¨å®ç°</strong><br>å…·ä½“å…³äº ES Module æƒ³å¿…å¤§å®¶éƒ½æ—©å·²ç†ŸçŸ¥ï¼Œä½†å…¶æµè§ˆå™¨å®ç°å¯èƒ½å¤§å®¶è¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å…¶æµè§ˆå™¨å®ç°ï¼š</p><pre><code class="html">&lt;body&gt;  &lt;!-- æ³¨æ„è¿™é‡Œä¸€å®šè¦åŠ ä¸Š type=&quot;module&quot; --&gt;  &lt;script type=&quot;module&quot;&gt;    // ä» URL å¯¼å…¥    import Vue from &quot;https://unpkg.com/vue@2.6.11/dist/vue.esm.browser.js&quot;;    // ä»ç›¸å¯¹è·¯å¾„å¯¼å…¥    import * as utils from &quot;./utils.js&quot;;    // ä»ç»å¯¹è·¯å¾„å¯¼å…¥    import &quot;/index.js&quot;;    // ä¸æ”¯æŒ    import foo from &quot;foo.js&quot;;    import bar from &quot;bar/index.js&quot;;    import zoo from &quot;./index&quot;; // æ²¡æœ‰ .js åç¼€  &lt;/script&gt;&lt;/body&gt;</code></pre><p><strong>deno çš„æ¨¡å—è§„èŒƒ</strong><br>deno å®Œå…¨éµå¾ª es module æµè§ˆå™¨å®ç°ï¼Œæ‰€ä»¥ deno ä¹Ÿæ˜¯å¦‚æ­¤ï¼š</p><pre><code class="js">// æ”¯æŒimport * as fs from &quot;https://deno.land/std/fs/mod.ts&quot;;import { deepCopy } from &quot;./deepCopy.js&quot;;import foo from &quot;/foo.ts&quot;;// ä¸æ”¯æŒimport foo from &quot;foo.ts&quot;;import bar from &quot;./bar&quot;; // å¿…é¡»æŒ‡å®šæ‰©å±•å\</code></pre><p>æˆ‘ä»¬å‘ç°å…¶å’Œæˆ‘ä»¬å¹³å¸¸åœ¨ webpack æˆ–è€… ts ä½¿ç”¨ es module æœ€å¤§çš„ä¸åŒï¼š</p><ul><li><p>å¯ä»¥é€šè¿‡ import url ç›´æ¥å¼•ç”¨çº¿ä¸Šèµ„æºï¼›</p></li><li><p>èµ„æºä¸å¯çœç•¥æ‰©å±•åå’Œæ–‡ä»¶åã€‚</p></li></ul><p>å…³äºç¬¬ 1 ç‚¹ï¼Œäº‰è®®éå¸¸å¤§ï¼Œæœ‰äººå¾ˆçœ‹å¥½ï¼Œè§‰å¾—æå¤§çš„æ‰©å±•äº† deno åº“çš„èŒƒå›´ï¼›æœ‰äººåˆ™ä¸å¤ªçœ‹å¥½ï¼Œè§‰å¾—å›½å†…ç½‘é€Ÿçš„åŸå› ï¼Œå¹¶ä¸å®ç”¨ã€‚</p><h2 id="3-å®‰å…¨"><a href="#3-å®‰å…¨" class="headerlink" title="3.å®‰å…¨"></a>3.å®‰å…¨</h2><p>å¦‚æœæ¨¡å—è§„èŒƒæ˜¯ node å’Œ deno æœ€å¤§çš„ä¸åŒï¼Œé‚£ä¹ˆå¯¹å®‰å…¨çš„å¤„ç†ï¼Œåˆ™æ˜¯å¦å¤–ä¸€ä¸ªè®©äººæ‘¸ä¸ç€å¤´è„‘çš„åœ°æ–¹ã€‚</p><p><strong>æ¨¡æ‹Ÿç›—å·</strong></p><p>åœ¨ä»‹ç»ä¹‹å‰æˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸‹è¿™ä¸ªåœºæ™¯ä¼šä¸ä¼šå‡ºç°ï¼š</p><p>æˆ‘åšäº†ä¸€ä¸ªåŸºäºå‘½ä»¤è¡Œçš„ä¸€é”®ä¸Šç½‘å·¥å…· <code>breakwall</code>ï¼Œæ¯æœˆ 1 ä¸ª G å…è´¹æµé‡ï¼Œç„¶åå°†å‹ç¼©åçš„ JS ä»£ç å‘å¸ƒåˆ° npm ä¸Šï¼Œç„¶åååœ¨å„ç§æ¸ é“å®£ä¼ ä¸€æ³¢ã€‚</p><p>ç¾Šæ¯›å…šå…´é«˜å½©çƒˆçš„ <code>cnpm install -g breakwall</code>ï¼Œç„¶åæ¯æ¬¡ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘å·å·çš„å°†è¯¸ä½çš„ ssh å¯†é’¥å’Œå„ç§èƒ½å·çš„æ–‡æ¡£åŠå›¾ç‰‡å·å·ä¸Šä¼ åˆ°æˆ‘çš„æœåŠ¡å™¨ï¼Œåœ¨è®¾å®šæœŸé™åˆ°æœŸåï¼Œåˆ é™¤ç”µè„‘ä¸Šèµ„æ–™ï¼Œç•™ä¸‹ä¸€å¥æ‹¿é’±æ¢èµ„æ–™ï¼Œä»…æ”¯æŒæ¯”ç‰¹å¸ã€‚</p><p><strong>é»˜è®¤å®‰å…¨çš„ deno</strong></p><p>å¦‚æœä½ è§‰å¾—ä»¥ä¸Šæƒ…å†µæœ‰å¯èƒ½å‡ºç°ï¼Œåˆ™ä¼šè§‰å¾—ä¸‹é¢çš„åŠŸèƒ½å¾ˆå®ç”¨ã€‚æˆ‘ä»¬å…ˆç”¨ deno æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼š</p><pre><code class="js">// index.jslet rsa = Deno.readFileSync(Deno.dir(&quot;home&quot;) + &quot;/.ssh/id_rsa&quot;);rsa = new TextDecoder().decode(rsa);fetch(&quot;http://jsonplaceholder.typicode.com/posts/1&quot;, {  method: &quot;POST&quot;,  body: JSON.stringify(rsa)})  .then((res) =&gt; res.json())  .then((res) =&gt; console.log(&quot;å¯†é’¥å‘é€æˆåŠŸï¼Œå˜¿å˜¿å˜¿ğŸ˜œ&quot;));console.log(&quot;start breakwall...&quot;);</code></pre><blockquote><p>PS: â€“unstable æ˜¯ç”±äº Deno.dir API ä¸ç¨³å®š</p></blockquote><pre><code class="js"> deno run --unstable index.js</code></pre><p>æˆ‘ä»¬å°†ä¼šå¾—åˆ°å¦‚ä¸‹æŠ¥é”™ä¿¡æ¯ï¼š</p><pre><code class="js">&gt; deno run --unstable  index.jserror: Uncaught PermissionDenied: access to environment variables, run again with the --allow-env flag    ...</code></pre><p>æ„æ€å°±æ˜¯æƒé™å¼‚å¸¸ï¼Œéœ€è¦è®¿é—®ç¯å¢ƒå˜é‡ï¼Œéœ€è¦åŠ ä¸Š <code>--allow-env</code>ï¼Œæˆ‘ä»¬åŠ ä¸Šè¿™ä¸ªå‚æ•°å†è¯•ä¸€ä¸‹ã€‚</p><pre><code class="js"> deno run --unstable --allow-env index.jserror: Uncaught PermissionDenied: read access to &quot;/Users/zhangchaojie/.ssh/id_rsa&quot;, run again with the --allow-read flag    ...</code></pre><p>å¦‚æ­¤åå¤ï¼Œè¿˜éœ€åŠ ä¸Š <code>--allow-read</code>ã€<code>--allow-net</code> ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯ï¼š</p><pre><code class="js">&gt; deno run --unstable --allow-env --allow-read --allow-net  index.jsstart breakwall...å¯†é’¥å‘é€æˆåŠŸï¼Œå˜¿å˜¿å˜¿ğŸ˜œ</code></pre><p>ç»è¿‡ä¸€ç•ªæŠ˜è…¾ï¼Œæ€»ç®—æ˜¯å‘é€æˆåŠŸäº†ï¼Œè¦æƒ³ç›—å–å¯†é’¥å®å±ä¸æ˜“ã€‚</p><p><strong>ç™½åå•</strong></p><p>é‚£æœ‰äººå°±è¯´äº†ï¼Œå¦‚æœæˆ‘çš„åº”ç”¨ç¡®å®éœ€è¦è®¿é—®ç½‘ç»œå’Œæ–‡ä»¶ï¼Œä½†æ˜¯æœ‰ä¸æƒ³è®©å®ƒè®¿é—® .ssh æ–‡ä»¶æœ‰æ²¡æœ‰åŠæ³•ï¼Ÿ</p><p>å½“ç„¶æœ‰äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ <code>--allow-read</code> å’Œ <code>--allow-net</code> æŒ‡å®šç™½åå•ï¼Œåå•ä¹‹å¤–éƒ½ä¸å¯è®¿é—®ï¼Œä¾‹å¦‚ï¼š</p><pre><code class="js">&gt; deno run --unstable --allow-env --allow-read --allow-net=https://www.baidu.com  index.jsstart breakwall...error: Uncaught PermissionDenied: network access to &quot;http://jsonplaceholder.typicode.com/posts/1&quot;, run again with the --allow-net flag    at unwrapResponse ($deno$/ops/dispatch_json.ts:43:11)    at Object.sendAsync ($deno$/ops/dispatch_json.ts:98:10)    at async fetch ($deno$/web/fetch.ts:591:27)</code></pre><p><strong>ç®€åŒ–å‚æ•°</strong></p><p>å¦‚æœç¡®è®¤æ˜¯æ²¡é—®é¢˜ï¼Œæˆ–è€…æ˜¯è‡ªå·±å¼€å‘è½¯ä»¶æ—¶ï¼Œå›¾ä¸ªæ–¹ä¾¿ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ -A æˆ– â€“allow-all å‚æ•°å…è®¸æ‰€æœ‰æƒé™ï¼š</p><pre><code class="js">&gt; deno -A --unstable index.jsstart breakwall...å¯†é’¥å‘é€æˆåŠŸï¼Œå˜¿å˜¿å˜¿ğŸ˜œ</code></pre><p>å®‰å…¨è¿™æ–¹é¢è§ä»è§æ™ºï¼Œæœ‰äººè§‰å¾—æ˜¯å¤šä½™ï¼Œæœ‰äººè§‰å¾—å¾ˆå¥½ç”¨ï¼Œæå¤§çš„å¢å¼ºäº†å®‰å…¨æ€§ã€‚å¦‚æœä½ å±äºè§‰å¾—è¿™ä¸ªåŠŸèƒ½å¤šä½™çš„ï¼Œå¯ä»¥ deno run -A xxx å³å¯ã€‚</p><h2 id="4-å…¼å®¹æµè§ˆå™¨-API"><a href="#4-å…¼å®¹æµè§ˆå™¨-API" class="headerlink" title="4.å…¼å®¹æµè§ˆå™¨ API"></a>4.å…¼å®¹æµè§ˆå™¨ API</h2><p>å…³äºä¸ºä»€ä¹ˆï¼Œæˆ‘ä¸¾ä¸ªæ —å­å¤§å®¶å°±æ˜ç™½äº†ï¼šåœ¨è®¾è®¡ node ä¹‹å¤„ï¼Œå…³äºè¾“å‡ºå‡½æ•°æœ¬æ¥å« <code>print</code> ä¹‹ç±»çš„ï¼Œåæ¥æœ‰äººæè®®ä¸ºä»€ä¹ˆä¸å« <code>console.log</code>ï¼Œry è§‰å¾—æŒºä¸é”™ï¼Œäºæ˜¯å°±æ¥çº³äº†æ„è§ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ä¸ªè®¾è®¡å¹¶ä¸æ˜¯åˆ»æ„ä¸ºä¹‹ï¼Œè€Œ deno çš„è®¾è®¡åˆ™å¯ä»¥ä¸ºä¹‹ï¼Œé€šè¿‡ä¸æµè§ˆå™¨ API ä¿æŒä¸€è‡´ï¼Œæ¥å‡å°‘å¤§å®¶çš„è®¤çŸ¥ã€‚</p><p><strong>æ€ä¹ˆå…¼å®¹æµè§ˆå™¨ API</strong></p><blockquote><p>æ¦‚å¿µä¸Šå…¼å®¹</p><ul><li>æ¨¡å—ç³»ç»Ÿï¼Œä»ä¸Šé¢ä»‹ç»çœ‹å‡º deno æ˜¯å®Œå…¨éµå¾ªæµè§ˆå™¨å®ç°çš„ï¼›</li></ul></blockquote><ul><li><p>é»˜è®¤å®‰å…¨ï¼Œå½“ç„¶ä¹Ÿä¸æ˜¯è‡ªå·±åˆ›é€ çš„æ¦‚å¿µï¼Œw3c æ—©å·²åšå‡ºæµè§ˆå™¨æƒé™çš„è§„å®šï¼Œæˆ‘ä»¬åœ¨åšå°ç¨‹åºçš„æ—¶å€™å°¤ä¸ºæ˜æ˜¾ï¼Œéœ€è¦è·å–å„ç§æƒé™ï¼›</p></li><li><p>å¯¹äºå¼‚æ­¥æ“ä½œè¿”å› Promiseï¼›</p></li><li><p>ä½¿ç”¨ <code>ArrayBuffer</code> å¤„ç†äºŒè¿›åˆ¶ï¼›</p></li></ul><blockquote><p>å­˜åœ¨ window å…¨å±€å˜é‡</p></blockquote><p><code>console.log(window === this, window === self, window === globalThis);</code></p><blockquote><p>å®ç°äº† WindowOrWorkerGlobalScope çš„å…¨éƒ¨æ–¹æ³•</p></blockquote><p>å…·ä½“æ–¹æ³•åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒï¼š<code>lib.deno.shared_globals.d.ts</code> å’Œ <code>lib.deno.window.d.ts</code></p><pre><code class="js">// è¯·æ±‚æ–¹æ³•fetch(&quot;https://baidu.com&quot;);// base64 è½¬åŒ–let encodedData = btoa(&quot;Hello, world&quot;); // ç¼–ç let decodedData = atob(encodedData); // è§£ç // å¾®ä»»åŠ¡queueMicrotask(() =&gt; {  console.log(123);});</code></pre><blockquote><p>å¤§è¶‹åŠ¿</p></blockquote><p>æ€»ä½“è€Œè¨€ï¼Œå¦‚æœæœåŠ¡ç«¯å’Œæµè§ˆå™¨ç«¯å­˜åœ¨ç›¸åŒæ¦‚å¿µï¼Œdeno å°±ä¸ä¼šåˆ›é€ æ–°çš„æ¦‚å¿µã€‚è¿™ä¸€ç‚¹å…¶å® node ä¹Ÿåœ¨åšï¼Œæ–°çš„ node 14.0 CHANGELOG å°±ä¹ŸæåŠè¦å®ç° Universal JavaScript å’Œ Spec compliance and Web Compatibilityçš„æ€æƒ³ï¼Œæ‰€ä»¥è¿™ç‚¹å¤§å®¶åº”è¯¥éƒ½ä¼šæ¥å—å§ï¼Œæ¯•ç«Ÿå¤§åŠ¿æ‰€è¶‹è¶‹åŠ¿ã€‚</p><h2 id="5-æ”¯æŒ-Typescript"><a href="#5-æ”¯æŒ-Typescript" class="headerlink" title="5.æ”¯æŒ Typescript"></a>5.æ”¯æŒ Typescript</h2><p>ä¸ç®¡ä½ å–œæ¬¢ä¸å¦ï¼Œ2020 å¹´äº†ï¼Œå¿…é¡»å­¦ä¹  TS äº†ï¼ˆèµ·ç åœ¨é¢è¯•çš„æ—¶å€™æ˜¯äº®ç‚¹ï¼‰ã€‚å­¦å®Œä¹‹åä½ æ‰ä¼šæ˜ç™½ç‹å¢ƒæ³½å®šå¾‹çœŸçš„æ— å¤„ä¸åœ¨ã€‚</p><pre><code class="js">// index.tslet str: string = &quot;ç‹å¢ƒæ³½å®šå¾‹&quot;;str = 132;&gt; deno run index.tserror TS2322: Type &#39;123&#39; is not assignable to type &#39;string&#39;.â–º file:///Users/zhangchaojie/Desktop/index.ts:2:12 str = 123  ~~~</code></pre><h2 id="6-å»-node-modules"><a href="#6-å»-node-modules" class="headerlink" title="6.å» node_modules"></a>6.å» node_modules</h2><p>deno æ²¡æœ‰ <code>node_modules</code>ï¼Œé‚£ä¹ˆå®ƒæ˜¯æ€ä¹ˆè¿›è¡ŒåŒ…ç®¡ç†çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹ä¸‹é¢çš„ä¾‹å­</p><pre><code class="js">// index.jsimport { white, bgRed } from &quot;https://deno.land/std/fmt/colors.ts&quot;;console.log(bgRed(white(&quot;hello world!&quot;)));&gt; deno run index.jsDownload https://deno.land/std/fmt/colors.tsCompile https://deno.land/std/fmt/colors.tshello world!</code></pre><p>æˆ‘ä»¬çœ‹åˆ°å…¶æœ‰ Download å’Œ Compile ä¸¤ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬ä¼šäº§ç”Ÿå‡ ä¸ªç–‘é—®ï¼š</p><blockquote><p>1ã€æ¯æ¬¡æ‰§è¡Œéƒ½è¦ä¸‹è½½å—ï¼Ÿ</p></blockquote><p>è§£ï¼šæˆ‘ä»¬åªéœ€è¦å†æ‰§è¡Œä¸€æ¬¡å°±èƒ½æ˜ç™½ï¼Œä¸éœ€è¦æ¯æ¬¡ä¸‹è½½ã€‚</p><pre><code class="js">&gt; deno run index.jshello world!</code></pre><blockquote><p>2ã€Download å’Œ Compile çš„æ–‡ä»¶åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p></blockquote><p>è§£ï¼šæˆ‘ä»¬ä¼šå‘ç°ï¼Œå½“å‰æ‰§è¡Œçš„ç›®å½•ï¼Œå¹¶æ²¡æœ‰ Download å’Œ Compile æ–‡ä»¶ï¼Œé‚£æ–‡ä»¶æ”¾åœ¨å“ªé‡Œå‘¢ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ deno â€“help å‘½ä»¤ï¼š</p><pre><code class="js">&gt; deno --helpSUBCOMMANDS:# ...info           Show info about cache or info related to source file# ...ENVIRONMENT VARIABLES:    DENO_DIR   Set deno&#39;s base directory (defaults to $HOME/.deno)</code></pre><p>deno info å‘½ä»¤å±•ç¤ºäº†ä¾èµ–å…³ç³»ï¼Œç±»ä¼¼ package.jsonã€‚</p><pre><code class="js">&gt; deno info index.jslocal: /Users/zhangchaojie/Desktop/index.jstype: JavaScriptdeps:file:///Users/zhangchaojie/Desktop/index.js  â””â”€â”€ https://deno.land/std/fmt/colors.ts</code></pre><p>DENO_DIR åˆ™ä¸ºå®é™…çš„å®‰è£…å’Œç¼–è¯‘ç›®å½•ï¼Œç›¸å½“äº node_modulesï¼Œé»˜è®¤ä¸º $HOME/.denoï¼ˆå‘½ä»¤æç¤ºæ˜¯è¿™æ ·çš„ï¼Œä½†å®é™…éœ€è¦æŒ‡å®šä¸€ä¸‹ç¯å¢ƒå˜é‡ <code>export DENO_DIR=$HOME/.denoï¼‰</code>ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼š</p><pre><code class="js">&gt; tree $HOME/.deno/Users/zhangchaojie/.denoâ”œâ”€â”€ depsâ”‚   â””â”€â”€ httpsâ”‚       â””â”€â”€ deno.landâ”‚           â”œâ”€â”€ 3574883d8acbaf00e28990ec8e83d71084c4c668c1dc7794be25208c60cfc935â”‚           â””â”€â”€ 3574883d8acbaf00e28990ec8e83d71084c4c668c1dc7794be25208c60cfc935.metadata.jsonâ””â”€â”€ gen    â””â”€â”€ https        â””â”€â”€ deno.land            â””â”€â”€ std                â””â”€â”€ fmt                    â”œâ”€â”€ colors.ts.js                    â”œâ”€â”€ colors.ts.js.map                    â””â”€â”€ colors.ts.meta8 directories, 5 files</code></pre><blockquote><p>3ã€æ²¡ç½‘ç»œäº†æ€ä¹ˆåŠï¼Ÿ</p></blockquote><p>æˆ‘ä»¬æœ‰äº›åœºæ™¯æ˜¯å°†æœ¬åœ°å†™å¥½çš„ä»£ç éƒ¨ç½²åˆ°æ²¡æœ‰ç½‘ç»œçš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå½“æ‰§è¡Œ deno run xxx æ—¶ï¼Œå°±æ˜¯æç¤º error sending requestã€‚</p><p>è§£ï¼šå°†ä¸Šé¢çš„ç¼“å­˜ç›®å½•å†…å®¹ï¼Œç›´æ¥æ‹·è´åˆ°æœåŠ¡å™¨å¹¶æŒ‡å®šç¯å¢ƒå˜é‡åˆ°å…¶ç›®å½•å³å¯ã€‚</p><blockquote><p>4ã€ä¾èµ–ä»£ç æ›´æ–°äº†æ€ä¹ˆåŠï¼Ÿ</p></blockquote><p>è§£ï¼šå½“ä¾èµ–æ¨¡å—æ›´æ–°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ â€“reload è¿›è¡Œæ›´æ–°ç¼“å­˜ï¼Œä¾‹å¦‚ï¼š</p><p><code>&gt; deno run --reload index.js</code><br>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç™½åå•çš„æ–¹å¼ï¼Œåªæ›´æ–°éƒ¨åˆ†ä¾èµ–ã€‚ä¾‹å¦‚ï¼š</p><p><code>&gt; deno run --reload=https://deno.land index.js</code></p><blockquote><p>5ã€ä»…ç¼“å­˜ä¾èµ–ï¼Œä¸æ‰§è¡Œä»£ç æœ‰åŠæ³•å—ï¼Ÿ</p></blockquote><p>è§£ï¼šæœ‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ deno cache index.js è¿›è¡Œä¾èµ–ç¼“å­˜ã€‚</p><blockquote><p>6ã€å¤šç‰ˆæœ¬æ€ä¹ˆå¤„ç†ï¼Ÿ</p></blockquote><p>è§£ï¼šæš‚æ—¶æ²¡æœ‰å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œåªèƒ½é€šè¿‡ git tag çš„æ–¹å¼åŒºåˆ†ç‰ˆæœ¬ã€‚</p><h2 id="7-æ ‡å‡†æ¨¡å—-ä¸-node-API-å…¼å®¹"><a href="#7-æ ‡å‡†æ¨¡å—-ä¸-node-API-å…¼å®¹" class="headerlink" title="7.æ ‡å‡†æ¨¡å— ä¸ node API å…¼å®¹"></a>7.æ ‡å‡†æ¨¡å— ä¸ node API å…¼å®¹</h2><p>æˆ‘ä»¬é€šè¿‡ç¬¬ 1 ç‚¹å¯ä»¥çœ‹åˆ°ï¼Œå…¶å® deno çš„ API ç›¸å¯¹äº node å…¶å®æ˜¯å°‘ä¸€äº›çš„ï¼Œé€šè¿‡å…¶æ–‡ä»¶å¤§å°ä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼š</p><pre><code class="js">&gt; ll /usr/local/bin/node /Users/zhangchaojie/.local/bin/deno-rwxr-xr-x  1   42M   /Users/zhangchaojie/.local/bin/deno-rwxr-xr-x  1   70M   /usr/local/bin/node</code></pre><p>é‚£è¿™äº›å°‘çš„ API åªèƒ½è‡ªå·±å†™æˆ–è€…æ±‚åŠ©äºç¤¾åŒºå—ï¼Ÿ</p><p>deno å¯¹äºè‡ªèº«ç›¸å¯¹äº node å°‘çš„å’Œç¤¾åŒºä¸­å¸¸ç”¨çš„åŠŸèƒ½ï¼Œæä¾›äº†æ ‡å‡†æ¨¡å—ï¼Œå…¶ç‰¹ç‚¹æ˜¯ä¸ä¾èµ–éæ ‡å‡†æ¨¡å—çš„å†…å®¹ï¼Œè¾¾åˆ°ç¤¾åŒºå†…çš„æ¨¡å—å¼•ç”¨æœ€åéƒ½æ”¶æ•›äºæ ‡å‡†æ¨¡å—çš„æ•ˆæœã€‚ä¾‹å¦‚ï¼š</p><pre><code class="js">// ç±»ä¼¼ node ä¸­ chalk åŒ…import { bgRed, white } from &quot;https://deno.land/std/fmt/colors.ts&quot;;// ç±»ä¼¼ node ä¸­çš„ uuid åŒ…import { v4 } from &quot;https://deno.land/std/uuid/mod.ts&quot;;</code></pre><p>åŒæ—¶ä¸ºäº†å¯¹ node ç”¨æˆ·å‹å¥½ï¼Œæä¾›äº† node API çš„å…¼å®¹</p><pre><code class="js">import * as path from &quot;https://deno.land/std/node/path.ts&quot;;import * as fs from &quot;https://deno.land/std/node/fs.ts&quot;;console.log(path.resolve(&#39;./&#39;, &#39;./test&#39;))</code></pre><p>æ‰€ä»¥ï¼Œå¤§å®¶åœ¨ä¸º deno ç¤¾åŒºåšè´¡çŒ®çš„æ—¶å€™ï¼Œé¦–å…ˆè¦çœ‹ä¸€ä¸‹æ ‡å‡†æ¨¡å—æœ‰æ²¡æœ‰æä¾›ç±»ä¼¼çš„åŠŸèƒ½ï¼Œå¦‚æœå·²ç»æä¾›äº†å¯ä»¥è¿›è¡Œå¼•ç”¨ã€‚</p><h2 id="8-å¼‚æ­¥æ“ä½œ"><a href="#8-å¼‚æ­¥æ“ä½œ" class="headerlink" title="8.å¼‚æ­¥æ“ä½œ"></a>8.å¼‚æ­¥æ“ä½œ</h2><blockquote><p>æ ¹æ® ry è‡ªå·±æ˜¯è¯´æ³•ï¼Œåœ¨è®¾è®¡ node æ˜¯æœ‰äººæè®® Promise å¤„ç†å›è°ƒï¼Œä½†æ˜¯ä»–æ²¡å¬ï¼Œç”¨ä»–è‡ªå·±çš„è¯è¯´å°±æ˜¯æ„šè ¢çš„æ‹’ç»äº†ã€‚</p></blockquote><p><strong>node ç”¨å›è°ƒçš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œã€deno åˆ™é€‰æ‹©ç”¨ Promise</strong></p><pre><code class="js">// node æ–¹å¼const fs = require(&quot;fs&quot;);fs.readFile(&quot;./data.txt&quot;, (err, data) =&gt; {  if (err) throw err;  console.log(data);});</code></pre><p>å¦å¤– deno æ”¯æŒ top-level-awaitï¼Œæ‰€ä»¥ä»¥ä¸Šè¯»å–æ–‡ä»¶çš„ä»£ç å¯ä»¥ä¸ºï¼š</p><pre><code class="js">// deno æ–¹å¼const data = await Deno.readFile(&quot;./data.txt&quot;);console.log(data);</code></pre><p>node å…³äºè¿™æ–¹é¢ä¹Ÿåœ¨ä¸€ç›´æ”¹è¿›ï¼Œä¾‹å¦‚ç¤¾åŒºä¸Šå¾ˆå¤š <code>promisify</code> è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡åŒ…è£¹ä¸€å±‚å‡½æ•°ï¼Œå®ç°ç›®çš„ã€‚ä¾‹å¦‚ï¼š</p><pre><code class="js">// node API promisifyconst { promisify } = require(&quot;es6-promisify&quot;);const fs = require(&quot;fs&quot;);// æ²¡æœ‰ top-level-awaitï¼Œåªèƒ½åŒ…ä¸€å±‚async function main() {  const readFile = promisify(fs.readFile);  const data = await readFile(&quot;./data.txt&quot;);  console.log(data);}main();</code></pre><h2 id="9-å•æ–‡ä»¶åˆ†å‘"><a href="#9-å•æ–‡ä»¶åˆ†å‘" class="headerlink" title="9.å•æ–‡ä»¶åˆ†å‘"></a>9.å•æ–‡ä»¶åˆ†å‘</h2><p>æˆ‘ä»¬çŸ¥é“ npm åŒ…å¿…é¡»æœ‰ <code>package.json</code> æ–‡ä»¶ï¼Œé‡Œé¢ä¸ä»…éœ€è¦æŒ‡æ˜ main æˆ– module æˆ– browser ç­‰å­—æ®µæ¥æ ‡æ˜å…¥å£æ–‡ä»¶ï¼Œè¿˜éœ€è¦æŒ‡æ˜ <code>name ã€license ã€description</code> ç­‰å­—æ®µæ¥è¯´æ˜è¿™ä¸ªåŒ…ã€‚</p><p>ry è§‰å¾—è¿™äº›å­—æ®µæ‰°ä¹±äº†å¼€å‘è€…çš„è§†å¬ï¼Œæ‰€ä»¥åœ¨ deno ä¸­ï¼Œå…¶æ¨¡å—ä¸éœ€è¦ä»»ä½•é…ç½®æ–‡ä»¶ï¼Œç›´æ¥æ˜¯ import url çš„å½¢å¼ã€‚</p><h2 id="10-å»ä¸­å¿ƒåŒ–ä»“åº“"><a href="#10-å»ä¸­å¿ƒåŒ–ä»“åº“" class="headerlink" title="10.å»ä¸­å¿ƒåŒ–ä»“åº“"></a>10.å»ä¸­å¿ƒåŒ–ä»“åº“</h2><p>å¯¹äº <code>www.npmjs.com</code> æˆ‘ä»¬è‚¯å®šéƒ½ä¸é™Œç”Ÿï¼Œå®ƒæ˜¯æ¨åŠ¨ node è“¬å‹ƒå‘å±•çš„é‡è¦æ”¯ç‚¹ã€‚ä½†ä½œè€…è®¤ä¸ºå®ƒæ˜¯ä¸­å¿ƒåŒ–ä»“åº“ï¼Œè¿èƒŒäº†äº’è”ç½‘å»ä¸­å¿ƒåŒ–åŸåˆ™ã€‚</p><p>æ‰€ä»¥ deno å¹¶æ²¡æœ‰ä¸€ä¸ªåƒ npmjs.com çš„ä»“åº“ï¼Œé€šè¿‡ import url çš„æ–¹å¼å°†äº’è”ç½‘ä»»ä½•ä¸€å¤„çš„ä»£ç éƒ½å¯ä»¥å¼•ç”¨ã€‚</p><p>PSï¼šdeno å…¶å®æ˜¯æœ‰ä¸ªåŸºäº <code>GitHub</code> çš„ç¬¬ä¸‰æ–¹æ¨¡å—é›†åˆã€‚</p><h2 id="11-å»å¼€å‘ä¾èµ–"><a href="#11-å»å¼€å‘ä¾èµ–" class="headerlink" title="11.å»å¼€å‘ä¾èµ–"></a>11.å»å¼€å‘ä¾èµ–</h2><p>æˆ‘ä»¬åœ¨å†™ä¸€ä¸ª node åº“æˆ–è€…å·¥å…·æ—¶ï¼Œå¼€å‘ä¾èµ–æ˜¯å°‘ä¸äº†çš„ï¼Œä¾‹å¦‚ babel åšè½¬åŒ–å’Œæ‰“åŒ…ã€jest åšæµ‹è¯•ã€prettier åšä»£ç æ ¼å¼åŒ–ã€eslint åšä»£ç æ ¼å¼æ ¡æ£€ã€gulp æˆ–è€… webpack åšæ„å»ºç­‰ç­‰ï¼Œè®©æˆ‘ä»¬åœ¨å¼€å‘å‰å°±æå¾—ç­‹ç–²åŠ›å°½ã€‚</p><blockquote><p>deno é€šè¿‡å†…ç½®äº†ä¸€äº›å·¥å…·ï¼Œè§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p></blockquote><ul><li><p><code>deno bundle</code>ï¼šæ‰“åŒ…å‘½ä»¤ï¼Œç”¨æ¥æ›¿æ¢ babelã€gulp ä¸€ç±»å·¥å…·: ä¾‹å¦‚ï¼šdeno bundle ./mod.tsï¼›</p></li><li><p><code>deno fmt</code>ï¼šæ ¼å¼åŒ–å‘½ä»¤ï¼Œç”¨æ¥æ›¿æ¢ prettier ä¸€ç±»å·¥å…·ï¼Œä¾‹å¦‚ï¼šdeno fmt ./mod.tsï¼›</p></li><li><p><code>deno test</code>ï¼šè¿è¡Œæµ‹è¯•ä»£ç ï¼Œç”¨æ¥æ›¿æ¢ jest ä¸€ç±»å·¥å…·ï¼Œä¾‹å¦‚ deno test ./test.tsï¼›</p></li><li><p><code>deno lint</code>ï¼šä»£ç æ ¡æ£€ï¼ˆæš‚æœªå®ç°ï¼‰ï¼Œç”¨æ¥æ›¿æ¢ eslint ä¸€ç±»å·¥å…·ï¼Œä¾‹å¦‚ï¼šdeno lint ./mod.tsã€‚</p></li></ul><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å°±åƒå°æ—¶å€™ä¸€ç›´å¹»æƒ³çš„ç‚¸å¼¹å§‹ç»ˆæ²¡èƒ½ç‚¸äº†å­¦æ ¡ï¼ŒæŠ€ï¼ˆè½®ï¼‰æœ¯ï¼ˆå­ï¼‰çš„è¿›ï¼ˆåˆ¶ï¼‰æ­¥ï¼ˆé€ ï¼‰ä¸€ç›´ä¹Ÿæœªåœæ­¢è¿‡ã€‚ä¸è®ºæˆ‘ä»¬å­¦çš„åŠ¨æˆ–è€…å­¦ä¸åŠ¨ï¼ŒæŠ€æœ¯å°±åœ¨é‚£é‡Œï¼Œä¸ä»¥äººçš„æ„å¿—ä¸ºè½¬ç§»ã€‚</p><p>è‡³äº deno èƒ½ä¸èƒ½ç«ï¼Œæˆ‘ä¸ªäººè§‰å¾—èµ·ç ä¸€ä¸¤å¹´å†…ä¸ä¼šæœ‰å¤ªå¤§åå“ï¼Œä¹‹åå’Œ node çš„å…³ç³»æœ‰å¯èƒ½åƒ Vue å’Œ reactï¼Œæœ‰äººå–œæ¬¢ç”¨ denoï¼Œè§‰å¾—æ¯” node å¥½ä¸€ä¸‡å€ï¼Œæœ‰äººåˆ™å–œæ¬¢ node ï¼Œè§‰å¾— node è¿˜èƒ½å†æˆ˜ 500 å¹´ã€‚è‡³äºæœ€ç»ˆå­¦ä¸å­¦è¿˜çœ‹è‡ªå·±ã€‚</p><p><a href="https://juejin.im/post/5ebcabb2e51d454da74185a9" target="_blank" rel="noopener">20 åˆ†é’Ÿå…¥é—¨ deno</a></p>]]></content>
      
      
      <categories>
          
          <category> Deno </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Deno </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javascriptè®¾è®¡æ¨¡å¼Es6ä»£ç å®ç°</title>
      <link href="/2020/05/12/Js/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FEs6%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/"/>
      <url>/2020/05/12/Js/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FEs6%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5e021eb96fb9a01628014095" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="è®¾è®¡æ¨¡å¼ç®€ä»‹"><a href="#è®¾è®¡æ¨¡å¼ç®€ä»‹" class="headerlink" title="è®¾è®¡æ¨¡å¼ç®€ä»‹"></a>è®¾è®¡æ¨¡å¼ç®€ä»‹</h1><p><code>è®¾è®¡æ¨¡å¼</code>ä»£è¡¨äº†æœ€ä½³çš„å®è·µï¼Œé€šå¸¸è¢«æœ‰ç»éªŒçš„é¢å‘å¯¹è±¡çš„è½¯ä»¶å¼€å‘äººå‘˜æ‰€é‡‡ç”¨ã€‚<code>è®¾è®¡æ¨¡å¼</code>æ˜¯è½¯ä»¶å¼€å‘äººå‘˜åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­é¢ä¸´çš„ä¸€èˆ¬é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚è¿™äº›è§£å†³æ–¹æ¡ˆæ˜¯ä¼—å¤šè½¯ä»¶å¼€å‘äººå‘˜ç»è¿‡ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´çš„è¯•éªŒå’Œé”™è¯¯æ€»ç»“å‡ºæ¥çš„ã€‚</p><p><code>è®¾è®¡æ¨¡å¼</code>æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨çš„ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚ä½¿ç”¨<code>è®¾è®¡æ¨¡å¼</code>æ˜¯ä¸ºäº†é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§ã€‚ æ¯«æ— ç–‘é—®ï¼Œ<code>è®¾è®¡æ¨¡å¼</code>äºå·±äºä»–äººäºç³»ç»Ÿéƒ½æ˜¯å¤šèµ¢çš„ï¼Œ<code>è®¾è®¡æ¨¡å¼</code>ä½¿ä»£ç ç¼–åˆ¶çœŸæ­£å·¥ç¨‹åŒ–ï¼Œ<code>è®¾è®¡æ¨¡å¼</code>æ˜¯è½¯ä»¶å·¥ç¨‹çš„åŸºçŸ³ï¼Œå¦‚åŒå¤§å¦çš„ä¸€å—å—ç –çŸ³ä¸€æ ·ã€‚</p><h2 id="è®¾è®¡æ¨¡å¼è§„åˆ™ï¼ˆSOLIDï¼‰"><a href="#è®¾è®¡æ¨¡å¼è§„åˆ™ï¼ˆSOLIDï¼‰" class="headerlink" title="è®¾è®¡æ¨¡å¼è§„åˆ™ï¼ˆSOLIDï¼‰"></a>è®¾è®¡æ¨¡å¼è§„åˆ™ï¼ˆSOLIDï¼‰</h2><p><strong>S â€“ Single Responsibility Principle å•ä¸€èŒè´£åŸåˆ™</strong></p><ul><li>ä¸€ä¸ªç¨‹åºåªåšå¥½ä¸€ä»¶äº‹</li><li>å¦‚æœåŠŸèƒ½è¿‡äºå¤æ‚å°±æ‹†åˆ†å¼€ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¿æŒç‹¬ç«‹</li></ul><p><strong>O â€“ OpenClosed Principle å¼€æ”¾/å°é—­åŸåˆ™</strong></p><ul><li>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­</li><li>å¢åŠ éœ€æ±‚æ—¶ï¼Œæ‰©å±•æ–°ä»£ç ï¼Œè€Œéä¿®æ”¹å·²æœ‰ä»£ç </li></ul><p><strong>L â€“ Liskov Substitution Principle é‡Œæ°æ›¿æ¢åŸåˆ™</strong></p><ul><li>å­ç±»èƒ½è¦†ç›–çˆ¶ç±»</li><li>çˆ¶ç±»èƒ½å‡ºç°çš„åœ°æ–¹å­ç±»å°±èƒ½å‡ºç°</li></ul><p><strong>I â€“ Interface Segregation Principle æ¥å£éš”ç¦»åŸåˆ™</strong></p><ul><li>ä¿æŒæ¥å£çš„å•ä¸€ç‹¬ç«‹</li><li>ç±»ä¼¼å•ä¸€èŒè´£åŸåˆ™ï¼Œè¿™é‡Œæ›´å…³æ³¨æ¥å£</li></ul><p><strong>D â€“ Dependency Inversion Principle ä¾èµ–å€’è½¬åŸåˆ™</strong></p><ul><li>é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¾èµ–äºæŠ½è±¡è€Œä¸ä¾èµ–äºå…·ä½“</li><li>ä½¿ç”¨æ–¹åªå…³æ³¨æ¥å£è€Œä¸å…³æ³¨å…·ä½“ç±»çš„å®ç°</li></ul><p>å†ä¸¾ä¸ªæ —å­ï¼š<a href="https://juejin.im/post/5adc8e18518825672b0352a8#comment" target="_blank" rel="noopener">æ­¤ä¾‹æ¥æº-å®ˆå€™-æ”¹å–„ä»£ç çš„å„æ–¹é¢é—®é¢˜</a></p><pre><code class="js">//checkType(&#39;165226226326&#39;,&#39;mobile&#39;)//resultï¼šfalselet checkType=function(str, type) {    switch (type) {        case &#39;email&#39;:            return /^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(str)        case &#39;mobile&#39;:            return /^1[3|4|5|7|8][0-9]{9}$/.test(str);        case &#39;tel&#39;:            return /^(0\d{2,3}-\d{7,8})(-\d{1,4})?$/.test(str);        default:            return true;    }}</code></pre><p>æœ‰ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å¦‚æœæƒ³æ·»åŠ å…¶ä»–è§„åˆ™å°±å¾—åœ¨å‡½æ•°é‡Œé¢å¢åŠ  case ã€‚æ·»åŠ ä¸€ä¸ªè§„åˆ™å°±ä¿®æ”¹ä¸€æ¬¡ï¼è¿™æ ·è¿åäº†å¼€æ”¾-å°é—­åŸåˆ™ï¼ˆå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼‰ã€‚è€Œä¸”è¿™æ ·ä¹Ÿä¼šå¯¼è‡´æ•´ä¸ª API å˜å¾—è‡ƒè‚¿ï¼Œéš¾ç»´æŠ¤ã€‚</li><li>æ¯”å¦‚Aé¡µé¢éœ€è¦æ·»åŠ ä¸€ä¸ªé‡‘é¢çš„æ ¡éªŒï¼ŒBé¡µé¢éœ€è¦ä¸€ä¸ªæ—¥æœŸçš„æ ¡éªŒï¼Œä½†æ˜¯é‡‘é¢çš„æ ¡éªŒåªåœ¨Aé¡µé¢éœ€è¦ï¼Œæ—¥æœŸçš„æ ¡éªŒåªåœ¨Bé¡µé¢éœ€è¦ã€‚å¦‚æœä¸€ç›´æ·»åŠ  case ã€‚å°±æ˜¯å¯¼è‡´Aé¡µé¢æŠŠåªåœ¨Bé¡µé¢éœ€è¦çš„æ ¡éªŒè§„åˆ™ä¹Ÿæ·»åŠ è¿›å»ï¼Œé€ æˆä¸å¿…è¦çš„å¼€é”€ã€‚Bé¡µé¢ä¹ŸåŒç†ã€‚</li></ol><p>å»ºè®®çš„æ–¹å¼æ˜¯ç»™è¿™ä¸ª API å¢åŠ ä¸€ä¸ªæ‰©å±•çš„æ¥å£:</p><pre><code class="js">let checkType=(function(){    let rules={        email(str){            return /^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(str);        },        mobile(str){            return /^1[3|4|5|7|8][0-9]{9}$/.test(str);        }    };    //æš´éœ²æ¥å£    return {        //æ ¡éªŒ        check(type,str){            return rules[type]?rules[type](str):false;        },        //æ·»åŠ è§„åˆ™        addRule(type,fn){            rules[type]=fn;        }    }})();//è°ƒç”¨æ–¹å¼//ä½¿ç”¨mobileæ ¡éªŒè§„åˆ™console.log(checkType.check(&#39;mobile&#39;,&#39;188170239&#39;));//æ·»åŠ é‡‘é¢æ ¡éªŒè§„åˆ™checkType.addRule(&#39;money&#39;,function (str) {    return /^[0-9]+(.[0-9]{2})?$/.test(str)});//ä½¿ç”¨é‡‘é¢æ ¡éªŒè§„åˆ™console.log(checkType.check(&#39;18.36&#39;,&#39;money&#39;));</code></pre><p>æ­¤ä¾‹æ›´è¯¦ç»†å†…å®¹è¯·æŸ¥çœ‹-&gt; <a href="https://juejin.im/post/5adc8e18518825672b0352a8#comment" target="_blank" rel="noopener">å®ˆå€™i-é‡æ„-æ”¹å–„ä»£ç çš„å„æ–¹é¢é—®é¢˜</a></p><h1 id="è®¾è®¡æ¨¡å¼åˆ†ç±»ï¼ˆ23ç§ï¼‰"><a href="#è®¾è®¡æ¨¡å¼åˆ†ç±»ï¼ˆ23ç§ï¼‰" class="headerlink" title="è®¾è®¡æ¨¡å¼åˆ†ç±»ï¼ˆ23ç§ï¼‰"></a>è®¾è®¡æ¨¡å¼åˆ†ç±»ï¼ˆ23ç§ï¼‰</h1><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><blockquote><p>åˆ›å»ºå‹</p><ul><li>å•ä¾‹æ¨¡å¼</li><li>åŸå‹æ¨¡å¼</li><li>å·¥å‚æ¨¡å¼</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼</li><li>å»ºé€ è€…æ¨¡å¼</li></ul></blockquote><blockquote><p>ç»“æ„å‹</p><ul><li>é€‚é…å™¨æ¨¡å¼</li><li>è£…é¥°å™¨æ¨¡å¼</li><li>ä»£ç†æ¨¡å¼</li><li>å¤–è§‚æ¨¡å¼</li><li>æ¡¥æ¥æ¨¡å¼</li><li>ç»„åˆæ¨¡å¼</li><li>äº«å…ƒæ¨¡å¼</li></ul></blockquote><blockquote><p>è¡Œä¸ºå‹</p><ul><li>è§‚å¯Ÿè€…æ¨¡å¼</li><li>è¿­ä»£å™¨æ¨¡å¼</li><li>ç­–ç•¥æ¨¡å¼</li><li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</li><li>èŒè´£é“¾æ¥æ¨¡å¼</li><li>å‘½ä»¤æ¨¡å¼</li><li>å¤‡å¿˜å½•æ¨¡å¼</li><li>çŠ¶æ€æ¨¡å¼</li><li>è®¿é—®è€…æ¨¡å¼</li><li>ä¸­ä»‹è€…æ¨¡å¼</li><li>è§£é‡Šå™¨æ¨¡å¼</li></ul></blockquote><h2 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å·¥å‚æ¨¡å¼å®šä¹‰åˆ°ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£ç”±å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ç±»ã€‚è¯¥æ¨¡å¼ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°äº†å­ç±»,è€Œå­ç±»å¯ä»¥é‡å†™æ¥å£æ–¹æ³•ä»¥ä¾¿åˆ›å»ºçš„æ—¶å€™æŒ‡å®šè‡ªå·±çš„å¯¹è±¡ç±»å‹</p><h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><pre><code class="js">class Product{  constructor(name){    this.name = name  }  init(){    console.log(&#39;init&#39;,this.name)  }}class Factory {  create(name){    return new Product(name)  }}let factory = new Factory()let p = factory.create(&#39;hello world&#39;)p.init()</code></pre><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ol><li>å¦‚æœä½ ä¸æƒ³è®©æŸä¸ªå­ç³»ç»Ÿä¸è¾ƒå¤§çš„é‚£ä¸ªå¯¹è±¡ä¹‹é—´å½¢æˆå¼ºè€¦åˆï¼Œè€Œæ˜¯æƒ³è¿è¡Œæ—¶ä»è®¸å¤šå­ç³»ç»Ÿä¸­è¿›è¡ŒæŒ‘é€‰çš„è¯ï¼Œé‚£ä¹ˆå·¥å‚æ¨¡å¼æ˜¯ä¸€ä¸ªç†æƒ³çš„é€‰æ‹©</li><li>å°†newæ“ä½œç®€å•å°è£…ï¼Œé‡åˆ°newçš„æ—¶å€™å°±åº”è¯¥è€ƒè™‘æ˜¯å¦ç”¨å·¥å‚æ¨¡å¼ï¼›</li><li>éœ€è¦ä¾èµ–å…·ä½“ç¯å¢ƒåˆ›å»ºä¸åŒå®ä¾‹ï¼Œè¿™äº›å®ä¾‹éƒ½æœ‰ç›¸åŒçš„è¡Œä¸º,è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œç®€åŒ–å®ç°çš„è¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‡å°‘æ¯ç§å¯¹è±¡æ‰€éœ€çš„ä»£ç é‡ï¼Œæœ‰åˆ©äºæ¶ˆé™¤å¯¹è±¡é—´çš„è€¦åˆï¼Œæä¾›æ›´å¤§çš„çµæ´»æ€§</li></ol><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹å¯èƒ½å¾ˆå¤æ‚ï¼Œä½†æˆ‘ä»¬åªéœ€è¦å…³å¿ƒåˆ›å»ºç»“æœã€‚</li><li>æ„é€ å‡½æ•°å’Œåˆ›å»ºè€…åˆ†ç¦», ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€</li><li>ä¸€ä¸ªè°ƒç”¨è€…æƒ³åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œåªè¦çŸ¥é“å…¶åç§°å°±å¯ä»¥äº†ã€‚</li><li>æ‰©å±•æ€§é«˜ï¼Œå¦‚æœæƒ³å¢åŠ ä¸€ä¸ªäº§å“ï¼Œåªè¦æ‰©å±•ä¸€ä¸ªå·¥å‚ç±»å°±å¯ä»¥ã€‚</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>æ·»åŠ æ–°äº§å“æ—¶ï¼Œéœ€è¦ç¼–å†™æ–°çš„å…·ä½“äº§å“ç±»,ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦</li><li>è€ƒè™‘åˆ°ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼Œéœ€è¦å¼•å…¥æŠ½è±¡å±‚ï¼Œåœ¨å®¢æˆ·ç«¯ä»£ç ä¸­å‡ä½¿ç”¨æŠ½è±¡å±‚è¿›è¡Œå®šä¹‰ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦</li></ul><h3 id="ä»€ä¹ˆæ—¶å€™ä¸ç”¨"><a href="#ä»€ä¹ˆæ—¶å€™ä¸ç”¨" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä¸ç”¨"></a>ä»€ä¹ˆæ—¶å€™ä¸ç”¨</h3><p>å½“è¢«åº”ç”¨åˆ°é”™è¯¯çš„é—®é¢˜ç±»å‹ä¸Šæ—¶,è¿™ä¸€æ¨¡å¼ä¼šç»™åº”ç”¨ç¨‹åºå¼•å…¥å¤§é‡ä¸å¿…è¦çš„å¤æ‚æ€§.é™¤éä¸ºåˆ›å»ºå¯¹è±¡æä¾›ä¸€ä¸ªæ¥å£æ˜¯æˆ‘ä»¬ç¼–å†™çš„åº“æˆ–è€…æ¡†æ¶çš„ä¸€ä¸ªè®¾è®¡ä¸Šç›®æ ‡,å¦åˆ™æˆ‘ä¼šå»ºè®®ä½¿ç”¨æ˜ç¡®çš„æ„é€ å™¨,ä»¥é¿å…ä¸å¿…è¦çš„å¼€é”€ã€‚</p><p>ç”±äºå¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹è¢«é«˜æ•ˆçš„æŠ½è±¡åœ¨ä¸€ä¸ªæ¥å£åé¢çš„äº‹å®,è¿™ä¹Ÿä¼šç»™ä¾èµ–äºè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šæœ‰å¤šå¤æ‚çš„å•å…ƒæµ‹è¯•å¸¦æ¥é—®é¢˜ã€‚</p><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><ul><li>æ›¾ç»æˆ‘ä»¬ç†Ÿæ‚‰çš„JQueryçš„$()å°±æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œå®ƒæ ¹æ®ä¼ å…¥å‚æ•°çš„ä¸åŒåˆ›å»ºå…ƒç´ æˆ–è€…å»å¯»æ‰¾ä¸Šä¸‹æ–‡ä¸­çš„å…ƒç´ ï¼Œåˆ›å»ºæˆç›¸åº”çš„jQueryå¯¹è±¡</li></ul><pre><code class="js">class jQuery {    constructor(selector) {        super(selector)    }    add() {    }  // æ­¤å¤„çœç•¥è‹¥å¹²API}window.$ = function(selector) {    return new jQuery(selector)}</code></pre><ul><li>vue çš„å¼‚æ­¥ç»„ä»¶<br>åœ¨å¤§å‹åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å°†åº”ç”¨åˆ†å‰²æˆå°ä¸€äº›çš„ä»£ç å—ï¼Œå¹¶ä¸”åªåœ¨éœ€è¦çš„æ—¶å€™æ‰ä»æœåŠ¡å™¨åŠ è½½ä¸€ä¸ªæ¨¡å—ã€‚ä¸ºäº†ç®€åŒ–ï¼ŒVue å…è®¸ä½ ä»¥ä¸€ä¸ªå·¥å‚å‡½æ•°çš„æ–¹å¼å®šä¹‰ä½ çš„ç»„ä»¶ï¼Œè¿™ä¸ªå·¥å‚å‡½æ•°ä¼šå¼‚æ­¥è§£æä½ çš„ç»„ä»¶å®šä¹‰ã€‚Vue åªæœ‰åœ¨è¿™ä¸ªç»„ä»¶éœ€è¦è¢«æ¸²æŸ“çš„æ—¶å€™æ‰ä¼šè§¦å‘è¯¥å·¥å‚å‡½æ•°ï¼Œä¸”ä¼šæŠŠç»“æœç¼“å­˜èµ·æ¥ä¾›æœªæ¥é‡æ¸²æŸ“ã€‚ä¾‹å¦‚ï¼š</li></ul><pre><code class="js">Vue.component(&#39;async-component&#39;,function(resolve,reject){  setTimeout(funciton(){    resolve({      templete: &#39;&lt;div&gt;I am async&lt;/div&gt;&#39;    })  },1000)})</code></pre><h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><h3 id="å®šä¹‰-1"><a href="#å®šä¹‰-1" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œæ¯”æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹</p><h3 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h3><pre><code class="js"> class LoginForm {    constructor() {        this.state = &#39;hide&#39;    }    show() {        if (this.state === &#39;show&#39;) {            alert(&#39;å·²ç»æ˜¾ç¤º&#39;)            return        }        this.state = &#39;show&#39;        console.log(&#39;ç™»å½•æ¡†æ˜¾ç¤ºæˆåŠŸ&#39;)    }    hide() {        if (this.state === &#39;hide&#39;) {            alert(&#39;å·²ç»éšè—&#39;)            return        }        this.state = &#39;hide&#39;        console.log(&#39;ç™»å½•æ¡†éšè—æˆåŠŸ&#39;)    } } LoginForm.getInstance = (function () {     let instance     return function () {        if (!instance) {            instance = new LoginForm()        }        return instance     } })()let obj1 = LoginForm.getInstance()obj1.show()let obj2 = LoginForm.getInstance()obj2.hide()console.log(obj1 === obj2)</code></pre><h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>åˆ’åˆ†å‘½åç©ºé—´ï¼Œå‡å°‘å…¨å±€å˜é‡</li><li>å¢å¼ºæ¨¡å—æ€§ï¼ŒæŠŠè‡ªå·±çš„ä»£ç ç»„ç»‡åœ¨ä¸€ä¸ªå…¨å±€å˜é‡åä¸‹ï¼Œæ”¾åœ¨å•ä¸€ä½ç½®ï¼Œä¾¿äºç»´æŠ¤</li><li>ä¸”åªä¼šå®ä¾‹åŒ–ä¸€æ¬¡ã€‚ç®€åŒ–äº†ä»£ç çš„è°ƒè¯•å’Œç»´æŠ¤</li></ul><h3 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>ç”±äºå•ä¾‹æ¨¡å¼æä¾›çš„æ˜¯ä¸€ç§å•ç‚¹è®¿é—®ï¼Œæ‰€ä»¥å®ƒæœ‰å¯èƒ½å¯¼è‡´æ¨¡å—é—´çš„å¼ºè€¦åˆ ä»è€Œä¸åˆ©äºå•å…ƒæµ‹è¯•ã€‚</li><li>æ— æ³•å•ç‹¬æµ‹è¯•ä¸€ä¸ªè°ƒç”¨äº†æ¥è‡ªå•ä¾‹çš„æ–¹æ³•çš„ç±»ï¼Œè€Œåªèƒ½æŠŠå®ƒä¸é‚£ä¸ªå•ä¾‹ä½œä¸ºä¸€ä¸ªå•å…ƒä¸€èµ·æµ‹è¯•ã€‚</li></ul><h3 id="åœºæ™¯ä¾‹å­"><a href="#åœºæ™¯ä¾‹å­" class="headerlink" title="åœºæ™¯ä¾‹å­"></a>åœºæ™¯ä¾‹å­</h3><p>å®šä¹‰å‘½åç©ºé—´å’Œå®ç°åˆ†æ”¯å‹æ–¹æ³•<br>ç™»å½•æ¡†<br>vuex å’Œ reduxä¸­çš„store</p><h2 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h2><h3 id="å®šä¹‰-2"><a href="#å®šä¹‰-2" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å°†ä¸€ä¸ªç±»æ¥å£è½¬åŒ–ä¸ºå¦ä¸€ä¸ªæ¥å£ï¼Œä»¥æ»¡è¶³ç”¨æˆ·éœ€æ±‚ï¼Œä½¿ç±»ä¹‹é—´æ¥å£ä¸å…¼å®¹é—®é¢˜é€šè¿‡é€‚é…å™¨å¾—ä»¥è§£å†³</p><h3 id="code-2"><a href="#code-2" class="headerlink" title="code"></a>code</h3><pre><code class="js">class Plug {  getName() {    return &#39;iphoneå……ç”µå¤´&#39;;  }}class Target {  constructor() {    this.plug = new Plug();  }  getName() {    return this.plug.getName() + &#39; é€‚é…å™¨Type-cå……ç”µå¤´&#39;;  }}let target = new Target();target.getName(); // iphoneå……ç”µå¤´ é€‚é…å™¨è½¬Type-cå……ç”µå¤´</code></pre><h3 id="ä¼˜ç‚¹-2"><a href="#ä¼˜ç‚¹-2" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>å¯ä»¥è®©ä¸¤ä¸ªæ²¡æœ‰å…³ç³»çš„ç±»è¿æ¥èµ·æ¥ä¸€èµ·è¿è¡Œ</li><li>æé«˜äº†ç±»çš„å¤ç”¨</li><li>é€‚é…å¯¹è±¡ï¼Œé€‚é…åº“ï¼Œé€‚é…æ•°æ®</li></ul><h3 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>é¢å¤–å¯¹è±¡çš„åˆ›å»ºï¼Œéç›´æ¥è°ƒç”¨ï¼Œå­˜åœ¨ä¸€å®šçš„å¼€é”€ï¼ˆä¸”ä¸åƒä»£ç†æ¨¡å¼åœ¨æŸäº›åŠŸèƒ½ç‚¹ä¸Šå¯å®ç°æ€§èƒ½ä¼˜åŒ–)</li><li>å¦‚æœæ²¡å¿…è¦ä½¿ç”¨é€‚é…å™¨æ¨¡å¼çš„è¯ï¼Œå¯ä»¥è€ƒè™‘é‡æ„ï¼Œå¦‚æœä½¿ç”¨çš„è¯ï¼Œå°½é‡æŠŠæ–‡æ¡£å®Œå–„</li></ul><h3 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><ul><li>æ•´åˆç¬¬ä¸‰æ–¹SDK</li><li>å°è£…æ—§æ¥å£</li></ul><pre><code class="js">// è‡ªå·±å°è£…çš„ajaxï¼Œ ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ajax({    url: &#39;/getData&#39;,    type: &#39;Post&#39;,    dataType: &#39;json&#39;,    data: {        test: 111    }}).done(function() {})// å› ä¸ºå†å²åŸå› ï¼Œä»£ç ä¸­å…¨éƒ½æ˜¯ï¼š// $.ajax({....})// åšä¸€å±‚é€‚é…å™¨var $ = {    ajax: function (options) {        return ajax(options)    }}</code></pre><ul><li>vueçš„computed</li></ul><pre><code class="html">&lt;template&gt;    &lt;div id=&quot;example&quot;&gt;        &lt;p&gt;Original message: &quot;{{ message }}&quot;&lt;/p&gt;  &lt;!-- Hello --&gt;        &lt;p&gt;Computed reversed message: &quot;{{ reversedMessage }}&quot;&lt;/p&gt;  &lt;!-- olleH --&gt;    &lt;/div&gt;&lt;/template&gt;&lt;script type=&#39;text/javascript&#39;&gt;    export default {        name: &#39;demo&#39;,        data() {            return {                message: &#39;Hello&#39;            }        },        computed: {            reversedMessage: function() {                return this.message.split(&#39;&#39;).reverse().join(&#39;&#39;)            }        }    }&lt;/script&gt;</code></pre><p><strong>åŸæœ‰data ä¸­çš„æ•°æ®ä¸æ»¡è¶³å½“å‰çš„è¦æ±‚ï¼Œé€šè¿‡è®¡ç®—å±æ€§çš„è§„åˆ™æ¥é€‚é…æˆæˆ‘ä»¬éœ€è¦çš„æ ¼å¼ï¼Œå¯¹åŸæœ‰æ•°æ®å¹¶æ²¡æœ‰æ”¹å˜ï¼Œåªæ”¹å˜äº†åŸæœ‰æ•°æ®çš„è¡¨ç°å½¢å¼</strong></p><h3 id="ä¸åŒç‚¹"><a href="#ä¸åŒç‚¹" class="headerlink" title="ä¸åŒç‚¹"></a>ä¸åŒç‚¹</h3><p>é€‚é…å™¨æ¨¡å¼ä¸ä»£ç†æ¨¡å¼å¾ˆç›¸ä¼¼</p><ul><li>é€‚é…å™¨æ¨¡å¼ï¼šæä¾›ä¸€ä¸ªä¸åŒçš„æ¥å£ï¼ˆå¦‚ä¸åŒç‰ˆæœ¬çš„æ’å¤´ï¼‰</li><li>ä»£ç†æ¨¡å¼ï¼šæä¾›ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ¥å£</li></ul><h2 id="è£…é¥°è€…æ¨¡å¼"><a href="#è£…é¥°è€…æ¨¡å¼" class="headerlink" title="è£…é¥°è€…æ¨¡å¼"></a>è£…é¥°è€…æ¨¡å¼</h2><h3 id="å®šä¹‰-3"><a href="#å®šä¹‰-3" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>åŠ¨æ€åœ°ç»™æŸä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œï¼Œæ˜¯ä¸€ç§å®ç°ç»§æ‰¿çš„æ›¿ä»£æ–¹æ¡ˆ<br>åœ¨ä¸æ”¹å˜åŸå¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡å¯¹å…¶è¿›è¡ŒåŒ…è£…æ‰©å±•ï¼Œä½¿åŸæœ‰å¯¹è±¡å¯ä»¥æ»¡è¶³ç”¨æˆ·çš„æ›´å¤æ‚éœ€æ±‚ï¼Œè€Œä¸ä¼šå½±å“ä»è¿™ä¸ªç±»ä¸­æ´¾ç”Ÿçš„å…¶ä»–å¯¹è±¡</p><h3 id="code-3"><a href="#code-3" class="headerlink" title="code"></a>code</h3><pre><code class="js">class Cellphone {    create() {        console.log(&#39;ç”Ÿæˆä¸€ä¸ªæ‰‹æœº&#39;)    }}class Decorator {    constructor(cellphone) {        this.cellphone = cellphone    }    create() {        this.cellphone.create()        this.createShell(cellphone)    }    createShell() {        console.log(&#39;ç”Ÿæˆæ‰‹æœºå£³&#39;)    }}// æµ‹è¯•ä»£ç let cellphone = new Cellphone()cellphone.create()console.log(&#39;------------&#39;)let dec = new Decorator(cellphone)dec.create()</code></pre><h3 id="åœºæ™¯ä¾‹å­-1"><a href="#åœºæ™¯ä¾‹å­-1" class="headerlink" title="åœºæ™¯ä¾‹å­"></a>åœºæ™¯ä¾‹å­</h3><ul><li>æ¯”å¦‚ç°åœ¨æœ‰4 ç§å‹å·çš„è‡ªè¡Œè½¦ï¼Œæˆ‘ä»¬ä¸ºæ¯ç§è‡ªè¡Œè½¦éƒ½å®šä¹‰äº†ä¸€ä¸ªå•ç‹¬çš„ç±»ã€‚ç°åœ¨è¦ç»™æ¯ç§è‡ªè¡Œè½¦éƒ½è£…ä¸Šå‰ç¯ã€å°¾ç¯å’Œé“ƒé“›è¿™3 ç§é…ä»¶ã€‚å¦‚æœä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼æ¥ç»™æ¯ç§è‡ªè¡Œè½¦åˆ›å»ºå­ç±»ï¼Œåˆ™éœ€è¦ 4Ã—3 = 12 ä¸ªå­ç±»ã€‚ä½†æ˜¯å¦‚æœæŠŠå‰ç¯ã€å°¾ç¯ã€é“ƒé“›è¿™äº›å¯¹è±¡åŠ¨æ€ç»„åˆåˆ°è‡ªè¡Œè½¦ä¸Šé¢ï¼Œåˆ™åªéœ€è¦é¢å¤–å¢åŠ 3ä¸ªç±»</li><li>ES6 <a href="http://es6.ruanyifeng.com/#docs/decorator" target="_blank" rel="noopener">Decorator</a> é˜®ä¸€å³°</li><li>core-decorators</li></ul><h3 id="ä¼˜ç‚¹-3"><a href="#ä¼˜ç‚¹-3" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>è£…é¥°ç±»å’Œè¢«è£…é¥°ç±»éƒ½åªå…³å¿ƒè‡ªèº«çš„æ ¸å¿ƒä¸šåŠ¡ï¼Œå®ç°äº†è§£è€¦ã€‚</li><li>æ–¹ä¾¿åŠ¨æ€çš„æ‰©å±•åŠŸèƒ½ï¼Œä¸”æä¾›äº†æ¯”ç»§æ‰¿æ›´å¤šçš„çµæ´»æ€§ã€‚</li></ul><h3 id="ç¼ºç‚¹-3"><a href="#ç¼ºç‚¹-3" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>å¤šå±‚è£…é¥°æ¯”è¾ƒå¤æ‚ã€‚</li><li>å¸¸å¸¸ä¼šå¼•å…¥è®¸å¤šå°å¯¹è±¡ï¼Œçœ‹èµ·æ¥æ¯”è¾ƒç›¸ä¼¼ï¼Œå®é™…åŠŸèƒ½å¤§ç›¸å¾„åº­ï¼Œä»è€Œä½¿å¾—æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ¶æ„å˜å¾—å¤æ‚èµ·æ¥</li></ul><h2 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h2><h3 id="å®šä¹‰-4"><a href="#å®šä¹‰-4" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>æ˜¯ä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®</p><blockquote><p>å‡è®¾å½“A åœ¨å¿ƒæƒ…å¥½çš„æ—¶å€™æ”¶åˆ°èŠ±ï¼Œå°æ˜è¡¨ç™½æˆåŠŸçš„å‡ ç‡æœ‰60%ï¼Œè€Œå½“A åœ¨å¿ƒæƒ…å·®çš„æ—¶å€™æ”¶åˆ°èŠ±ï¼Œå°æ˜è¡¨ç™½çš„æˆåŠŸç‡æ— é™è¶‹è¿‘äº0ã€‚<br>å°æ˜è·ŸA åˆšåˆšè®¤è¯†ä¸¤å¤©ï¼Œè¿˜æ— æ³•è¾¨åˆ«A ä»€ä¹ˆæ—¶å€™å¿ƒæƒ…å¥½ã€‚å¦‚æœä¸åˆæ—¶å®œåœ°æŠŠèŠ±é€ç»™Aï¼ŒèŠ±è¢«ç›´æ¥æ‰”æ‰çš„å¯èƒ½æ€§å¾ˆå¤§ï¼Œè¿™æŸèŠ±å¯æ˜¯å°æ˜åƒäº†7 å¤©æ³¡é¢æ¢æ¥çš„ã€‚<br>ä½†æ˜¯A çš„æœ‹å‹B å´å¾ˆäº†è§£Aï¼Œæ‰€ä»¥å°æ˜åªç®¡æŠŠèŠ±äº¤ç»™Bï¼ŒB ä¼šç›‘å¬A çš„å¿ƒæƒ…å˜åŒ–ï¼Œç„¶åé€‰æ‹©A å¿ƒæƒ…å¥½çš„æ—¶å€™æŠŠèŠ±è½¬äº¤ç»™Aï¼Œä»£ç å¦‚ä¸‹ï¼š</p></blockquote><pre><code class="js">let Flower = function(){}let xiaoming = {  sendFlower: function(target){    let flower = new Flower()    target.receviceFlower()  }}let B = {  receviceFlower:function(flower){    A.listenGoodMood(function(){      A.receviceFlower(flower)    })  }}let A = {  receviceFlower:function(flower){    console.log(&#39;æ”¶åˆ°èŠ±&#39;+ flower)  }  listenGoodMood:function(fn){    setTimeout(function(){      fn()    },1000)  }}xiaoming.sendFlower(B)</code></pre><h3 id="åœºæ™¯ä¾‹å­-2"><a href="#åœºæ™¯ä¾‹å­-2" class="headerlink" title="åœºæ™¯ä¾‹å­"></a>åœºæ™¯ä¾‹å­</h3><ul><li>HTMLå…ƒ ç´ äº‹ä»¶ä»£ç†</li></ul><pre><code class="html">&lt;ul id=&quot;ul&quot;&gt;  &lt;li&gt;1&lt;/li&gt;  &lt;li&gt;2&lt;/li&gt;  &lt;li&gt;3&lt;/li&gt;&lt;/ul&gt;&lt;script&gt;  let ul = document.querySelector(&#39;#ul&#39;);  ul.addEventListener(&#39;click&#39;, event =&gt; {    console.log(event.target);  });&lt;/script&gt;</code></pre><ul><li>ES6 çš„ proxy é˜®ä¸€å³°Proxy</li><li>jQuery.proxy()æ–¹æ³•</li></ul><h3 id="ä¼˜ç‚¹-4"><a href="#ä¼˜ç‚¹-4" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>ä»£ç†æ¨¡å¼èƒ½å°†ä»£ç†å¯¹è±¡ä¸è¢«è°ƒç”¨å¯¹è±¡åˆ†ç¦»ï¼Œé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚ä»£ç†æ¨¡å¼åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸€ä¸ªä¸­ä»‹ä½œç”¨ï¼Œè¿™æ ·å¯ä»¥èµ·åˆ°ä¿æŠ¤ç›®æ ‡å¯¹è±¡çš„ä½œç”¨</li><li>ä»£ç†å¯¹è±¡å¯ä»¥æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ï¼›é€šè¿‡ä¿®æ”¹ä»£ç†å¯¹è±¡å°±å¯ä»¥äº†ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ï¼›</li></ul><h3 id="ç¼ºç‚¹-4"><a href="#ç¼ºç‚¹-4" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>å¤„ç†è¯·æ±‚é€Ÿåº¦å¯èƒ½æœ‰å·®åˆ«ï¼Œéç›´æ¥è®¿é—®å­˜åœ¨å¼€é”€</li></ul><h3 id="ä¸åŒç‚¹-1"><a href="#ä¸åŒç‚¹-1" class="headerlink" title="ä¸åŒç‚¹"></a>ä¸åŒç‚¹</h3><blockquote><p>è£…é¥°è€…æ¨¡å¼å®ç°ä¸Šå’Œä»£ç†æ¨¡å¼ç±»ä¼¼<br>è£…é¥°è€…æ¨¡å¼ï¼š æ‰©å±•åŠŸèƒ½ï¼ŒåŸæœ‰åŠŸèƒ½ä¸å˜ä¸”å¯ç›´æ¥ä½¿ç”¨<br>ä»£ç†æ¨¡å¼ï¼š æ˜¾ç¤ºåŸæœ‰åŠŸèƒ½ï¼Œä½†æ˜¯ç»è¿‡é™åˆ¶ä¹‹åçš„</p></blockquote><h2 id="å¤–è§‚æ¨¡å¼"><a href="#å¤–è§‚æ¨¡å¼" class="headerlink" title="å¤–è§‚æ¨¡å¼"></a>å¤–è§‚æ¨¡å¼</h2><h3 id="å®šä¹‰-5"><a href="#å®šä¹‰-5" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ä¸ºå­ç³»ç»Ÿçš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼Œå®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨</p><h3 id="code-4"><a href="#code-4" class="headerlink" title="code"></a>code</h3><ol><li>å…¼å®¹æµè§ˆå™¨äº‹ä»¶ç»‘å®š</li></ol><pre><code class="js">let addMyEvent = function (el, ev, fn) {    if (el.addEventListener) {        el.addEventListener(ev, fn, false)    } else if (el.attachEvent) {        el.attachEvent(&#39;on&#39; + ev, fn)    } else {        el[&#39;on&#39; + ev] = fn    }}; </code></pre><ol start="2"><li>å°è£…æ¥å£</li></ol><pre><code class="js">let myEvent = {    // ...    stop: e =&gt; {        e.stopPropagation();        e.preventDefault();    }};</code></pre><p>æ–œæŒå•è‚©åŒ…ï¼Œé€æ°”è·‘é‹ï¼Œè¿åŠ¨è¢œï¼ŒTæ¤ï¼Œè¿åŠ¨çŸ­è£¤</p><h3 id="åœºæ™¯-1"><a href="#åœºæ™¯-1" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><ul><li>è®¾è®¡åˆæœŸï¼Œåº”è¯¥è¦æœ‰æ„è¯†åœ°å°†ä¸åŒçš„ä¸¤ä¸ªå±‚åˆ†ç¦»ï¼Œæ¯”å¦‚ç»å…¸çš„ä¸‰å±‚ç»“æ„ï¼Œåœ¨æ•°æ®è®¿é—®å±‚å’Œä¸šåŠ¡é€»è¾‘å±‚ã€ä¸šåŠ¡é€»è¾‘å±‚å’Œè¡¨ç¤ºå±‚ä¹‹é—´å»ºç«‹å¤–è§‚Facade</li><li>åœ¨å¼€å‘é˜¶æ®µï¼Œå­ç³»ç»Ÿå¾€å¾€å› ä¸ºä¸æ–­çš„é‡æ„æ¼”åŒ–è€Œå˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œå¢åŠ å¤–è§‚Facadeå¯ä»¥æä¾›ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œå‡å°‘ä»–ä»¬ä¹‹é—´çš„ä¾èµ–ã€‚</li><li>åœ¨ç»´æŠ¤ä¸€ä¸ªé—ç•™çš„å¤§å‹ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½è¿™ä¸ªç³»ç»Ÿå·²ç»å¾ˆéš¾ç»´æŠ¤äº†ï¼Œè¿™æ—¶å€™ä½¿ç”¨å¤–è§‚Facadeä¹Ÿæ˜¯éå¸¸åˆé€‚çš„ï¼Œä¸ºç³»ç»Ÿå¼€å‘ä¸€ä¸ªå¤–è§‚Facadeç±»ï¼Œä¸ºè®¾è®¡ç²—ç³™å’Œé«˜åº¦å¤æ‚çš„é—ç•™ä»£ç æä¾›æ¯”è¾ƒæ¸…æ™°çš„æ¥å£ï¼Œè®©æ–°ç³»ç»Ÿå’ŒFacadeå¯¹è±¡äº¤äº’ï¼ŒFacadeä¸é—ç•™ä»£ç äº¤äº’æ‰€æœ‰çš„å¤æ‚å·¥ä½œã€‚</li></ul><h3 id="ä¼˜ç‚¹-5"><a href="#ä¼˜ç‚¹-5" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>å‡å°‘ç³»ç»Ÿçš„ç›¸äº’ä¾èµ–</li><li>æé«˜äº†çµæ´»æ€§</li><li>æé«˜äº†å®‰å…¨æ€§</li></ul><h3 id="ç¼ºç‚¹-5"><a href="#ç¼ºç‚¹-5" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œå¦‚æœè¦æ”¹ä¸œè¥¿å¾ˆéº»çƒ¦ï¼Œç»§æ‰¿é‡å†™éƒ½ä¸åˆé€‚ã€‚</p><h2 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h2><h3 id="å®šä¹‰-6"><a href="#å®šä¹‰-6" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ä¸€ç§ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ï¼Œè¿™ä¸ªä¸»é¢˜å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶å°±ä¼šé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜éœ€è¦åŒæ—¶æ”¹å˜å…¶å®ƒå¯¹è±¡ï¼Œå¹¶ä¸”å®ƒä¸çŸ¥é“å…·ä½“æœ‰å¤šå°‘å¯¹è±¡éœ€è¦æ”¹å˜çš„æ—¶å€™ï¼Œå°±åº”è¯¥è€ƒè™‘ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p><ul><li>å‘å¸ƒ &amp; è®¢é˜…</li><li>ä¸€å¯¹å¤š</li></ul><h3 id="code-5"><a href="#code-5" class="headerlink" title="code"></a>code</h3><pre><code class="js">// ä¸»é¢˜ ä¿å­˜çŠ¶æ€ï¼ŒçŠ¶æ€å˜åŒ–ä¹‹åè§¦å‘æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡class Subject {  constructor() {    this.state = 0    this.observers = []  }  getState() {    return this.state  }  setState(state) {    this.state = state    this.notifyAllObservers()  }  notifyAllObservers() {    this.observers.forEach(observer =&gt; {      observer.update()    })  }  attach(observer) {    this.observers.push(observer)  }}// è§‚å¯Ÿè€…class Observer {  constructor(name, subject) {    this.name = name    this.subject = subject    this.subject.attach(this)  }  update() {    console.log(`${this.name} update, state: ${this.subject.getState()}`)  }}// æµ‹è¯•let s = new Subject()let o1 = new Observer(&#39;o1&#39;, s)let o2 = new Observer(&#39;02&#39;, s)s.setState(12)</code></pre><h3 id="åœºæ™¯-2"><a href="#åœºæ™¯-2" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><ul><li>DOMäº‹ä»¶</li></ul><pre><code class="js">document.body.addEventListener(&#39;click&#39;, function() {    console.log(&#39;hello world!&#39;);});document.body.click()</code></pre><ul><li>Vueå“åº”å¼</li></ul><h3 id="ä¼˜ç‚¹-6"><a href="#ä¼˜ç‚¹-6" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>æ”¯æŒç®€å•çš„å¹¿æ’­é€šä¿¡ï¼Œè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰å·²ç»è®¢é˜…è¿‡çš„å¯¹è±¡</li><li>ç›®æ ‡å¯¹è±¡ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„æŠ½è±¡è€¦åˆå…³ç³»èƒ½å•ç‹¬æ‰©å±•ä»¥åŠé‡ç”¨</li><li>å¢åŠ äº†çµæ´»æ€§</li><li>è§‚å¯Ÿè€…æ¨¡å¼æ‰€åšçš„å·¥ä½œå°±æ˜¯åœ¨è§£è€¦ï¼Œè®©è€¦åˆçš„åŒæ–¹éƒ½ä¾èµ–äºæŠ½è±¡ï¼Œè€Œä¸æ˜¯ä¾èµ–äºå…·ä½“ã€‚ä»è€Œä½¿å¾—å„è‡ªçš„å˜åŒ–éƒ½ä¸ä¼šå½±å“åˆ°å¦ä¸€è¾¹çš„å˜åŒ–ã€‚</li></ul><h3 id="ç¼ºç‚¹-6"><a href="#ç¼ºç‚¹-6" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>è¿‡åº¦ä½¿ç”¨ä¼šå¯¼è‡´å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„è”ç³»å¼±åŒ–ï¼Œä¼šå¯¼è‡´ç¨‹åºéš¾ä»¥è·Ÿè¸ªç»´æŠ¤å’Œç†è§£</p><h2 id="çŠ¶æ€æ¨¡å¼"><a href="#çŠ¶æ€æ¨¡å¼" class="headerlink" title="çŠ¶æ€æ¨¡å¼"></a>çŠ¶æ€æ¨¡å¼</h2><h3 id="å®šä¹‰-7"><a href="#å®šä¹‰-7" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜çš„æ—¶å€™æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»</p><h3 id="code-6"><a href="#code-6" class="headerlink" title="code"></a>code</h3><pre><code class="js">class State {  constructor(state){    this.state = state  }  handle(context){    console.log(`this is ${context} light`)  }}class Context{  constructor(){    this.state = null  }  getState(){    return this.state  }  setState(state){    this.state = state  }}let context = new Context()let weak = new State(&#39;Weak&#39;)let strong = new State(&#39;Strong&#39;)let off = new State(&#39;off&#39;)// å¼±å…‰weak.handle(context)console.log(context.getState())// å¼ºå…‰strong.handle(context)console.log(context.getState())// å…³é—­off.handle(context)console.log(context.getState())</code></pre><h3 id="åœºæ™¯-3"><a href="#åœºæ™¯-3" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><ul><li>ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºå–å†³äºå®ƒçš„çŠ¶æ€ï¼Œå¹¶ä¸”å®ƒå¿…é¡»åœ¨è¿è¡Œæ—¶åˆ»æ ¹æ®çŠ¶æ€æ”¹å˜å®ƒçš„è¡Œä¸º</li><li>ä¸€ä¸ªæ“ä½œä¸­å«æœ‰å¤§é‡çš„åˆ†æ”¯è¯­å¥ï¼Œè€Œä¸”è¿™äº›åˆ†æ”¯è¯­å¥ä¾èµ–äºè¯¥å¯¹è±¡çš„çŠ¶æ€</li></ul><h3 id="ä¼˜ç‚¹-7"><a href="#ä¼˜ç‚¹-7" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>å®šä¹‰äº†çŠ¶æ€ä¸è¡Œä¸ºä¹‹é—´çš„å…³ç³»ï¼Œå°è£…åœ¨ä¸€ä¸ªç±»é‡Œï¼Œæ›´ç›´è§‚æ¸…æ™°ï¼Œå¢æ”¹æ–¹ä¾¿</li><li>çŠ¶æ€ä¸çŠ¶æ€é—´ï¼Œè¡Œä¸ºä¸è¡Œä¸ºé—´å½¼æ­¤ç‹¬ç«‹äº’ä¸å¹²æ‰°</li><li>ç”¨å¯¹è±¡ä»£æ›¿å­—ç¬¦ä¸²æ¥è®°å½•å½“å‰çŠ¶æ€ï¼Œä½¿å¾—çŠ¶æ€çš„åˆ‡æ¢æ›´åŠ ä¸€ç›®äº†ç„¶</li></ul><h3 id="ç¼ºç‚¹-7"><a href="#ç¼ºç‚¹-7" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>ä¼šåœ¨ç³»ç»Ÿä¸­å®šä¹‰è®¸å¤šçŠ¶æ€ç±»</li><li>é€»è¾‘åˆ†æ•£</li></ul>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vueå¼€å‘å®è·µ(ä¸‹)</title>
      <link href="/2020/05/10/Vue/%E5%90%83%E9%80%8FVue%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5-%E4%B8%8B/"/>
      <url>/2020/05/10/Vue/%E5%90%83%E9%80%8FVue%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5-%E4%B8%8B/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5e1eb1dff265da3e354ea2d0" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a>   </p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‰é¢ä¸¤ç¯‡æ–‡ç« æ€»ç»“äº† Vue å¼€å‘çš„å¤§éƒ¨åˆ†æŠ€å·§å’Œå†…å®¹ï¼Œæœ€åä¸€ç¯‡æ–‡ç« æ¥å¯¹å®ƒè¿›è¡Œä¸€ä¸ªæ”¶å°¾<br>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬æ¥è°ˆè°ˆä¸€äº› Vue ç†è§£å’Œå®è·µè¦æ±‚é«˜ä¸€ç‚¹çš„é—®é¢˜</p><p>é¦–å…ˆæ˜¯ç”Ÿå‘½å‘¨æœŸè¿™ä¸€å—å†…å®¹ï¼Œéšç€å®è·µè¶Šå¤šå®ƒçš„æ„ä¹‰è¶Šå¤§ï¼Œç†è§£ä¹Ÿè¶Šæ·±åˆ»</p><p>mixin åŠŸèƒ½å¼ºå¤§ï¼Œå¯¹ä»£ç å¤ç”¨ç»„ç»‡éƒ½æœ‰å¾ˆé«˜çš„è¦æ±‚ï¼Œç®—æ˜¯ Vue åæœŸå‘åŠ›çš„é«˜çº§æŠ€å·§</p><p>æœåŠ¡ç«¯æ¸²æŸ“å¯èƒ½æ˜¯å­¦ä¹  Vue æœ€åä¸€å—é˜µåœ°äº†ï¼Œå¯¹äº SPA æ¡†æ¶çš„ä¸€ä¸ªé‡Œç¨‹ç¢‘</p><p>æœ€åï¼Œæ€»ç»“ä¸€ä¸‹æˆ‘åœ¨ä½¿ç”¨ Vue ä¸­ä½¿ç”¨çš„æŠ€å·§å’Œç»éªŒ</p><h1 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h1><p><img src="https://user-gold-cdn.xitu.io/2020/3/11/170c9c19f1dd22b7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æ¦‚è§ˆ"></p><h1 id="Vue-ç”Ÿå‘½å‘¨æœŸ"><a href="#Vue-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Vue ç”Ÿå‘½å‘¨æœŸ"></a>Vue ç”Ÿå‘½å‘¨æœŸ</h1><h2 id="ä»€ä¹ˆæ˜¯-Vue-ç”Ÿå‘½å‘¨æœŸï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Vue-ç”Ÿå‘½å‘¨æœŸï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Vue ç”Ÿå‘½å‘¨æœŸï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Vue ç”Ÿå‘½å‘¨æœŸï¼Ÿ</h2><p>Vue ç”Ÿå‘½å‘¨æœŸå¤§æ¦‚å°±æ˜¯ï¼šä¸€ä¸ªä» Vue å®ä¾‹çš„åˆ›å»ºåˆ°ç»„ä»¶é”€æ¯çš„ä¸€ä¸ªçš„è¿‡ç¨‹ã€‚</p><p>å…·ä½“æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ†ä¸ºå‡ ä¸ªæ ¸å¿ƒçš„é˜¶æ®µï¼Œå¹¶ä¸”æ¯ä¸ªé˜¶æ®µéƒ½æœ‰ä¸€å¥—é’©å­å‡½æ•°æ¥æ‰§è¡Œæˆ‘ä»¬éœ€è¦çš„ä»£ç ã€‚</p><h3 id="ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸é’©å­"><a href="#ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸é’©å­" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸é’©å­"></a>ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸é’©å­</h3><p>æˆ‘ä»¬æ•´ç†åˆ†ç±»ä¸€ä¸‹è¿™äº›ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œä¸ºäº†è®°å¿†æ–¹ä¾¿åˆ†ä¸º 4 å¤§æ ¸å¿ƒé˜¶æ®µï¼š</p><p>æ–¹ä¾¿è¯»è€…è®°å¿†ï¼Œè¿™é‡Œå°½é‡ä½¿ç”¨å›¾ç¤ºï¼š<br><img src="https://user-gold-cdn.xitu.io/2020/3/11/170c9c27264b6562?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å›¾ç¤º"></p><p>å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªé˜¶æ®µä¸­çš„é’©å­å‘½åéƒ½å¾ˆå¥½è®°å¿†ï¼Œé˜¶æ®µå¼€å§‹å‰ä½¿ç”¨ <code>beforeXxx</code>ï¼Œé˜¶æ®µåç»“æŸåä½¿ç”¨<code>xxxed</code></p><p>é™¤è¿™ 8 ä¸ªæ ¸å¿ƒé’©å­ï¼Œå¦å¤–è¿˜æœ‰ 3 ä¸ªæ–°å¢åŠŸèƒ½å‹é’©å­ï¼Œç›®å‰æ€»å…±æ˜¯ 11 ä¸ªé’©å­ é¡ºå¸¦æä¸€ä¸‹è¿™ 3 ä¸ªé’©å­çš„åŠŸèƒ½</p><ol><li>ç»„ä»¶ç¼“å­˜ï¼Œ<code>activated</code> ä¸ <code>deactivated</code>ï¼Œè¿™ä¸¤ä¸ªé’©å­ä¹Ÿæ˜¯ä¸€å¯¹çš„ï¼Œåˆ†åˆ«è¡¨ç¤ºè¢« keep-alive ç¼“å­˜çš„ç»„ä»¶æ¿€æ´»å’Œåœç”¨æ—¶è°ƒç”¨ã€‚</li><li>ç»„ä»¶é”™è¯¯æ•è·ï¼Œ<code>errorCaptured</code>ï¼Œå¯¹ç»„ä»¶ä¸­å‡ºç°å¯¹å¼‚å¸¸é”™è¯¯è¿›è¡Œå¤„ç†ï¼Œä½¿ç”¨è¾ƒå°‘ã€‚</li></ol><h3 id="Vue-æºç åŸºæœ¬æµç¨‹"><a href="#Vue-æºç åŸºæœ¬æµç¨‹" class="headerlink" title="Vue æºç åŸºæœ¬æµç¨‹"></a>Vue æºç åŸºæœ¬æµç¨‹</h3><p>å¯¹äºä¸Šé¢é‚£å¼ å›¾çš„ç†è§£ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ Vue æºç è¿›è¡Œæ¢³ç†ï¼Œæ‰èƒ½çœŸæ­£çš„ç†è§£ã€‚å¤§æ¦‚æ ¹æ®ç°æœ‰çš„æºç ï¼Œæˆ‘æ¢³ç†äº†ä¸€ä¸‹å¤§è‡´çš„æµç¨‹ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2020/3/11/170c9c2cc22b99c2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æºç "></p><p>æˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œä» Vue å®ä¾‹åˆ›å»ºã€ç»„ä»¶æŒ‚è½½ã€æ¸²æŸ“çš„ä¸€äº›è¿‡ç¨‹ä¸­ï¼Œæœ‰ç€æ˜æ˜¾çš„å‘¨æœŸèŠ‚ç‚¹ã€‚</p><h3 id="ç®€åŒ–æ–‡å­—å›¾è§£"><a href="#ç®€åŒ–æ–‡å­—å›¾è§£" class="headerlink" title="ç®€åŒ–æ–‡å­—å›¾è§£"></a>ç®€åŒ–æ–‡å­—å›¾è§£</h3><p>å¯¹äºä¸Šé¢é‚£å¼ å›¾çš„ç†è§£ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ Vue æºç è¿›è¡Œæ¢³ç†ï¼Œæ‰èƒ½çœŸæ­£çš„ç†è§£ã€‚å¤§æ¦‚æ ¹æ®ç°æœ‰çš„æºç ï¼Œæˆ‘æ¢³ç†äº†ä¸€ä¸‹å¤§è‡´çš„æµç¨‹ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2020/3/11/170c9c2cc22b99c2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å›¾è§£"></p><h2 id="å®è·µéªŒè¯ä¸€ä¸‹ç”Ÿå‘½å‘¨æœŸ"><a href="#å®è·µéªŒè¯ä¸€ä¸‹ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="å®è·µéªŒè¯ä¸€ä¸‹ç”Ÿå‘½å‘¨æœŸ"></a>å®è·µéªŒè¯ä¸€ä¸‹ç”Ÿå‘½å‘¨æœŸ</h2><h3 id="æå‡ºé—®é¢˜"><a href="#æå‡ºé—®é¢˜" class="headerlink" title="æå‡ºé—®é¢˜"></a>æå‡ºé—®é¢˜</h3><p>ä¸‹é¢æˆ‘ä»¬æå‡ºä¸€äº›é—®é¢˜ï¼š</p><ol><li>ä»€ä¹ˆæ—¶æœŸåˆ›å»º el ï¼Ÿ</li><li>ä»€ä¹ˆæ—¶æœŸæŒ‚è½½ data ï¼Ÿ</li><li>ä»€ä¹ˆæ—¶æœŸå¯ä»¥è®¿é—® dom ï¼Ÿ</li><li>ä»€ä¹ˆæƒ…å†µä¸‹ç»„ä»¶ä¼šæ›´æ–°ï¼Ÿæ›´æ–°æ˜¯åŒæ­¥æ›´æ–°è¿˜æ˜¯å¼‚æ­¥æ›´æ–°ï¼Ÿ</li><li>ä»€ä¹ˆæƒ…å†µä¸‹ç»„ä»¶ä¼šè¢«é”€æ¯ï¼Ÿ</li><li>é”€æ¯ç»„ä»¶åï¼Œè¿˜å¯ä»¥è®¿é—®å“ªäº›å†…å®¹ï¼Ÿ</li></ol><h3 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h3><ol><li>é¦–å…ˆå†™ä¸€ä¸ªå° demoï¼Œæ‰“å°å…³é”®ç»„ä»¶ä¿¡æ¯</li></ol><pre><code class="html">&lt;template&gt;  &lt;div&gt;    &lt;div class=&quot;message&quot;&gt;      {{message}}    &lt;/div&gt;  &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default {      data() {            return {                  message: &#39;1&#39;            }    },      methods: {            printComponentInfo(lifeName) {                  console.log(lifeName)                  console.log(&#39;el&#39;, this.$el)                  console.log(&#39;data&#39;, this.$data)                  console.log(&#39;watch&#39;, this.$watch)            }      }}&lt;/script&gt;</code></pre><ol start="2"><li>å¢åŠ æ ¸å¿ƒçš„ 8 ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œåˆ†åˆ«è°ƒç”¨æ‰“å°æ–¹æ³•</li></ol><pre><code class="js">  // ...    beforeCreate() {    this.printComponentInfo(&#39;beforeCreate&#39;)  },    created() {    this.printComponentInfo(&#39;created&#39;)  },    beforeMount() {    this.printComponentInfo(&#39;beforeMount&#39;)  },    mounted() {    this.printComponentInfo(&#39;mounted&#39;)  },    beforeUpdate() {    this.printComponentInfo(&#39;beforeUpdate&#39;)  },    updated() {    this.printComponentInfo(&#39;updated&#39;)  },    beforeDestroy() {    this.printComponentInfo(&#39;beforeDestroy&#39;)  },    destroyed() {    this.printComponentInfo(&#39;destroyed&#39;)  },    // ...</code></pre><h3 id="åˆ›å»ºé˜¶æ®µ"><a href="#åˆ›å»ºé˜¶æ®µ" class="headerlink" title="åˆ›å»ºé˜¶æ®µ"></a>åˆ›å»ºé˜¶æ®µ</h3><p><img src="https://user-gold-cdn.xitu.io/2020/3/10/170c25e769e9f94e?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="åˆ›å»º"></p><p>beforeCreate ä¸­methodsä¸­æ–¹æ³•ç›´æ¥æŠ¥é”™æ— æ³•è®¿é—®ï¼Œç›´æ¥è®¿é—® el å’Œ data å</p><p><img src="https://user-gold-cdn.xitu.io/2020/3/10/170c26347c3622f5?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="åˆ›å»º"></p><p>å‘ç°åªèƒ½è®¿é—®åˆ° watchï¼Œ el å’Œ data å‡ä¸èƒ½è®¿é—®åˆ°</p><p>created æ—¶æœŸ el æ— æ³•è®¿é—®åˆ°ï¼Œä½†æ˜¯å¯ä»¥è®¿é—®åˆ° data äº†</p><h3 id="æŒ‚è½½é˜¶æ®µ"><a href="#æŒ‚è½½é˜¶æ®µ" class="headerlink" title="æŒ‚è½½é˜¶æ®µ"></a>æŒ‚è½½é˜¶æ®µ</h3><p><img src="https://user-gold-cdn.xitu.io/2020/3/10/170c2679f7e956d2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æŒ‚è½½"></p><p><code>beforeMount</code> ä¸­å¯ä»¥è®¿é—® data ä½†æ˜¯ä»ç„¶è®¿é—®ä¸åˆ° el</p><p><code>mounted</code> ä¸­å¯ä»¥è®¿é—®åˆ° el äº†</p><blockquote><p>é¦–æ¬¡åŠ è½½é¡µé¢ï¼Œæ›´æ–°é˜¶æ®µå’Œé”€æ¯é˜¶æ®µåˆ°é’©å­éƒ½æœªè§¦å‘</p></blockquote><h3 id="æ›´æ–°é˜¶æ®µ"><a href="#æ›´æ–°é˜¶æ®µ" class="headerlink" title="æ›´æ–°é˜¶æ®µ"></a>æ›´æ–°é˜¶æ®µ</h3><pre><code class="js">this.message = this.message + 1</code></pre><p>å¦‚æœå¢åŠ åœ¨ created é˜¶æ®µï¼Œå‘ç° updateé’©å­ä»ç„¶æœªè§¦å‘ï¼Œä½†æ˜¯ el å’Œ data çš„å€¼éƒ½å˜æˆäº† 2</p><p>å¦‚æœå¢åŠ åœ¨ mounted é˜¶æ®µï¼Œå‘ç° updateé’©å­æ­¤æ—¶è§¦å‘äº†</p><p><img src="https://user-gold-cdn.xitu.io/2020/3/10/170c2727250a6c8c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æ›´æ–°"></p><h3 id="é”€æ¯é˜¶æ®µ"><a href="#é”€æ¯é˜¶æ®µ" class="headerlink" title="é”€æ¯é˜¶æ®µ"></a>é”€æ¯é˜¶æ®µ</h3><p>æ€æ ·è§¦å‘é”€æ¯çš„é’©å­å‘¢ï¼Ÿ å¤§æ¦‚æœ‰è¿™å‡ ç§æ–¹æ³•</p><ul><li>æ‰‹åŠ¨è°ƒç”¨ $destory</li><li>v-if ä¸ v-for æŒ‡ä»¤ï¼Œï¼ˆv-show ä¸è¡Œï¼‰</li><li>è·¯ç”±åˆ‡æ¢å’Œå…³é—­æˆ–åˆ·æ–°æµè§ˆå™¨</li></ul><p><img src="https://user-gold-cdn.xitu.io/2020/3/10/170c2ef6a6785ddc?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="è·¯ç”±åˆ‡æ¢"></p><h2 id="ç”Ÿå‘½å‘¨æœŸé’©å­å¸¸è§ä½¿ç”¨çš„åœºæ™¯"><a href="#ç”Ÿå‘½å‘¨æœŸé’©å­å¸¸è§ä½¿ç”¨çš„åœºæ™¯" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸé’©å­å¸¸è§ä½¿ç”¨çš„åœºæ™¯"></a>ç”Ÿå‘½å‘¨æœŸé’©å­å¸¸è§ä½¿ç”¨çš„åœºæ™¯</h2><h3 id="beforeCreate-è°¨æ…æ“ä½œ-this"><a href="#beforeCreate-è°¨æ…æ“ä½œ-this" class="headerlink" title="beforeCreate è°¨æ…æ“ä½œ this"></a>beforeCreate è°¨æ…æ“ä½œ this</h3><p><code>beforeCreate</code> æ— æ³•è®¿é—®åˆ° this ä¸­çš„ <code>dataã€method</code></p><h3 id="è¯·æ±‚åº”æ”¾åœ¨-created-é’©å­ä¸­"><a href="#è¯·æ±‚åº”æ”¾åœ¨-created-é’©å­ä¸­" class="headerlink" title="è¯·æ±‚åº”æ”¾åœ¨ created é’©å­ä¸­"></a>è¯·æ±‚åº”æ”¾åœ¨ created é’©å­ä¸­</h3><p>created å¯ä»¥è®¿é—® thisï¼Œä½†æ— æ³•è®¿é—® domï¼Œdom æœªæŒ‚è½½</p><h3 id="æ“ä½œ-DOM-ä»£ç åº”æ”¾åœ¨-mounted-é’©å­ä¸­"><a href="#æ“ä½œ-DOM-ä»£ç åº”æ”¾åœ¨-mounted-é’©å­ä¸­" class="headerlink" title="æ“ä½œ DOM ä»£ç åº”æ”¾åœ¨ mounted é’©å­ä¸­"></a>æ“ä½œ DOM ä»£ç åº”æ”¾åœ¨ mounted é’©å­ä¸­</h3><p>mounted å·²ç»æŒ‚è½½ domï¼Œå¯ä»¥è®¿é—® this</p><blockquote><p>ç”Ÿå‘½å‘¨æœŸç›¸å…³demo ä»£ç è§<a href="ç”Ÿå‘½å‘¨æœŸç›¸å…³demo ä»£ç è§github-lifecycle-demo">github-lifecycle-demo</a></p></blockquote><h1 id="ç†è§£å¹¶åˆç†ä½¿ç”¨-mixin"><a href="#ç†è§£å¹¶åˆç†ä½¿ç”¨-mixin" class="headerlink" title="ç†è§£å¹¶åˆç†ä½¿ç”¨ mixin"></a>ç†è§£å¹¶åˆç†ä½¿ç”¨ mixin</h1><h2 id="ä»€ä¹ˆæ˜¯-mixinï¼ˆæ··å…¥ï¼‰"><a href="#ä»€ä¹ˆæ˜¯-mixinï¼ˆæ··å…¥ï¼‰" class="headerlink" title="ä»€ä¹ˆæ˜¯ mixinï¼ˆæ··å…¥ï¼‰"></a>ä»€ä¹ˆæ˜¯ mixinï¼ˆæ··å…¥ï¼‰</h2><blockquote><p>å½“ç»„ä»¶ä½¿ç”¨æ··å…¥å¯¹è±¡æ—¶ï¼Œæ‰€æœ‰æ··å…¥å¯¹è±¡çš„é€‰é¡¹å°†è¢«â€œæ··åˆâ€è¿›å…¥è¯¥ç»„ä»¶æœ¬èº«çš„é€‰é¡¹ å¤§è‡´åŸç†å°±æ˜¯å°†å¤–æ¥çš„ç»„ä»¶ã€æ–¹æ³•ä»¥æŸç§æ–¹å¼è¿›è¡Œåˆå¹¶ã€‚åˆå¹¶çš„è§„åˆ™æœ‰ç‚¹åƒç»§æ‰¿å’Œæ‰©å±•ã€‚</p></blockquote><p>å½“ç»„ä»¶å’Œæ··å…¥å¯¹è±¡å«æœ‰<strong>åŒåé€‰é¡¹</strong>æ—¶ï¼Œè¿™äº›é€‰é¡¹å°†ä»¥æ°å½“çš„æ–¹å¼è¿›è¡Œâ€œåˆå¹¶â€</p><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€ä¸ªç»„ä»¶é‡Œé¢æœ‰å“ªäº›ä¸œè¥¿æ˜¯å¯ä»¥åˆå¹¶çš„</p><p><code>dataã€methodsã€computedã€directivesã€components</code> ç”Ÿå‘½å‘¨æœŸé’©å­</p><p>æ²¡é”™è¿™äº›éƒ½å¯ä»¥æ··å…¥</p><pre><code class="js">import demoMixin form &#39;@/mixins/demo&#39;export default {        mixins: [demoMixin]}</code></pre><p>è¿™æ ·çœ‹æ¥ï¼Œå¾ˆå¤šé¡µé¢é‡å¤çš„ä»£ç æˆ‘ä»¬éƒ½å¯ä»¥ç›´æ¥æŠ½å–å‡ºæ¥<br>æˆ–è€…æ˜¯å°è£…æˆä¸€ä¸ªå…¬å…±çš„ <code>mixin</code><br>æ¯”å¦‚æˆ‘ä»¬åš H5 é¡µé¢ï¼Œé‡Œé¢å¾ˆå¤šçŸ­ä¿¡éªŒè¯çš„é€»è¾‘å›ºæœ‰é€»è¾‘ï¼Œä½†æ˜¯éœ€è¦è®¿é—®åˆ° thisã€‚ä½¿ç”¨å·¥å…·å‡½æ•°è‚¯å®šä¸è¡Œã€‚<br>è¿™æ—¶å€™å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>mixin</code>ï¼Œå°è£…æˆä¸€ä¸ªå…·æœ‰å“åº”å¼çš„æ¨¡å—ã€‚ä¾›éœ€è¦çš„åœ°æ–¹è¿›è¡Œå¼•å…¥ã€‚</p><h2 id="mixin-è§„åˆ™"><a href="#mixin-è§„åˆ™" class="headerlink" title="mixin è§„åˆ™"></a>mixin è§„åˆ™</h2><p>é¦–å…ˆæ˜¯<strong>ä¼˜å…ˆçº§</strong>çš„é—®é¢˜ï¼Œå½“é‡åé€‰é¡¹æ—¶é€‰æ‹©å“ªä¸€ä¸ªä¸ºæœ€åçš„ç»“æœ</p><p>é»˜è®¤è§„åˆ™æˆ‘è¿™é‡Œåˆ†ä¸º 3 ç±»</p><ul><li><ol><li>data æ··å…¥: ä»¥å½“å‰ç»„ä»¶å€¼ä¸ºæœ€åçš„å€¼</li></ol></li><li><ol start="2"><li>ç”Ÿå‘½å‘¨æœŸé’©å­: ä¿ç•™æ‰€æœ‰é’©å­ï¼Œå…ˆæ‰§è¡Œ mixins çš„ï¼Œåæ‰§è¡Œå½“å‰ç»„ä»¶çš„</li></ol></li><li><ol start="3"><li>methodsã€computedã€directivesã€components è¿™ç§å¥å€¼å¯¹å½¢å¼ï¼ŒåŒåkeyï¼Œç»Ÿç»Ÿä»¥å½“å‰ç»„ä»¶ä¸ºå‡†</li></ol></li></ul><p>å½“ç„¶å¦‚æœæƒ³æ”¹å˜è§„åˆ™ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ¥æ”¹å˜è§„åˆ™</p><pre><code class="js">Vue.config.optionMergeStrategies.myOption = function (toVal, fromVal) {    // è¿”å›åˆå¹¶åçš„å€¼}</code></pre><h2 id="mixin-çš„å¥½å¤„"><a href="#mixin-çš„å¥½å¤„" class="headerlink" title="mixin çš„å¥½å¤„"></a>mixin çš„å¥½å¤„</h2><p>æˆ‘ä»¬çŸ¥é“ <code>Vue</code> æœ€èƒ½å¤ç”¨ä»£ç çš„å°±æ˜¯ç»„ä»¶ã€‚ä¸€èˆ¬æƒ…å†µï¼Œæˆ‘ä»¬é€šè¿‡ <code>props</code> æ¥æ§åˆ¶ç»„ä»¶çš„ï¼Œå°†åŸæœ‰ç»„ä»¶å°è£…æˆ <code>HOC</code> é«˜é˜¶ç»„ä»¶ã€‚è€Œæ§åˆ¶ <code>props</code> çš„ç”Ÿæˆä¸ä¸€æ ·çš„åŠŸèƒ½çš„ä»£ç è¿˜æ˜¯å†™åœ¨åŸºç¡€ç»„ä»¶é‡Œã€‚</p><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;  div.dib    van-button.btn(          @click=&quot;$emit(&#39;click&#39;)&quot;          :class=&quot;getClass&quot; v-bind=&quot;$attrs&quot;          :style=&quot;{&#39;width&#39;: size === &#39;large&#39; ? &#39;345px&#39;: &#39;&#39;,     &#39;backgroundColor&#39;: getBgColor,     borderColor: getBgColor, color: getBgColor}&quot;)      slot&lt;/template&gt;&lt;script&gt;import { Button } from &#39;vant&#39;import Vue from &#39;vue&#39;import { getColor } from &#39;@/utils&#39;Vue.use(Button)export default {      name: &#39;app-button&#39;,      props: {            type: {                  type: String,                  default: &#39;primary&#39;            },            theme: {                  type: String,                  default: &#39;blue&#39;            },            size: {                  type: String,                  default: &#39;&#39;           }      }}</code></pre><p>ä»¥è¿™ä¸ªç»„ä»¶ä¸ºä¾‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯<strong>é€šè¿‡å…¬å…±ç»„ä»¶å†…éƒ¨çš„é€»è¾‘ï¼Œæ¥æ”¹å˜ç»„ä»¶çš„è¡Œä¸º</strong>ã€‚</p><p>ä½†æ˜¯ï¼Œä½¿ç”¨ mixin æä¾›äº†å¦ä¸€ä¸ªæ€è·¯ã€‚æˆ‘ä»¬å†™å¥½å…¬å…±çš„ mixinï¼Œæ¯ä¸€ä¸ªéœ€è¦ä½¿ç”¨ mixin çš„åœ°æ–¹ã€‚æˆ‘ä»¬è¿›è¡Œæ‰©å±•åˆå¹¶ï¼Œä¸åŒä¸å…¬å…± mixin çš„é€‰é¡¹æˆ‘ä»¬åœ¨å½“å‰ç»„ä»¶ä¸­è¿›è¡Œè‡ªå®šä¹‰ï¼Œä¹Ÿå°±æ˜¯æ‰©å±•ã€‚<strong>æˆ‘ä»¬æ–°çš„é€»è¾‘æ˜¯å†™åœ¨å½“å‰ç»„ä»¶é‡Œé¢çš„ï¼Œè€Œéå…¬å…± mixins é‡Œ</strong>ã€‚</p><p>ç”»ä¸ªå›¾ç†è§£ä¸€ä¸‹ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2020/3/10/170c3937144fd11f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="ç”»ä¸ªå›¾"></p><h2 id="æœ€åæ€»ç»“ä¸€ä¸‹-mixin-çš„ä¼˜ç‚¹åŠç¼ºç‚¹"><a href="#æœ€åæ€»ç»“ä¸€ä¸‹-mixin-çš„ä¼˜ç‚¹åŠç¼ºç‚¹" class="headerlink" title="æœ€åæ€»ç»“ä¸€ä¸‹ mixin çš„ä¼˜ç‚¹åŠç¼ºç‚¹"></a>æœ€åæ€»ç»“ä¸€ä¸‹ mixin çš„ä¼˜ç‚¹åŠç¼ºç‚¹</h2><p><strong>ä¼˜ç‚¹</strong></p><ul><li>å¤ç”¨ä»£ç ï¼Œå…¬å…±é€»è¾‘æŠ½ç¦»</li><li>å¯ä»¥è®¿é—® this, å¯ä»¥æ“ä½œå“åº”å¼ä»£ç </li><li>mixins ç›¸å¯¹ä¸ç»„ä»¶æ¥è¯´ï¼Œæ›´åƒæ‰©å±•</li></ul><p><strong>ç¼ºç‚¹</strong></p><ul><li>åƒä¸‡ä¸èƒ½æ»¥ç”¨å…¨å±€ mixins å› ä¸ºä¼šå½±å“æ‰€æœ‰å¤šå­ç»„ä»¶</li><li>ç”±äº mixins çš„åˆå¹¶ç­–ç•¥å›ºæœ‰å½±å“ï¼Œå¯èƒ½åœ¨ä¸€äº›æç«¯æƒ…å†µè¾¾ä¸åˆ°ä½ æƒ³è¦çš„æ•ˆæœã€‚</li></ul><p>æ¯”å¦‚ï¼šæˆ‘å·²ç»å­˜åœ¨ä¸€ä¸ª <code>mixins</code>ï¼Œæˆ‘çš„é¡µé¢é‡Œé¢ä¹Ÿæœ‰ä¸€äº›æ–¹æ³•ï¼Œæˆ‘è¦å¼•å…¥<code>mixins</code> å°±è¦åšå¾ˆå¤šæ”¹åŠ¨ï¼Œæ¥ä¿è¯æˆ‘çš„ä»£ç æŒ‰æˆ‘çš„éœ€è¦è¿è¡Œã€‚</p><p>é¡µé¢ data æœ‰ä¸€ä¸ª <code>message</code> å€¼ï¼Œ<code>mixins</code> é‡Œé¢åŒæ ·æœ‰ä¸€ä¸ªã€‚</p><p>æŒ‰ç…§é»˜è®¤è§„åˆ™ï¼Œ<code>mixins</code> é‡Œé¢çš„ <code>message</code> ä¼šè¢«é¡µé¢é‡Œé¢ <code>message</code> è¦†ç›–ã€‚ä½†æ˜¯è¿™ä¸¤ä¸ª <code>message</code> å¯èƒ½ä»£è¡¨çš„æ„ä¹‰ä¸ä¸€æ ·ï¼Œéƒ½éœ€è¦å­˜åœ¨ã€‚é‚£ä¹ˆæˆ‘å°±éœ€è¦æ”¹æ‰å…¶ä¸­çš„ä¸€ä¸ªï¼Œå¦‚æœä¸šåŠ¡å¤ªæ·±çš„è¯ï¼Œå¯èƒ½è¿™ä¸ª <code>message</code> æ²¡é‚£ä¹ˆå¥½æ”¹ã€‚</p><p>æœ‰æ—¶å€™éœ€è¦è€ƒè™‘è¿™äº›é—®é¢˜ï¼Œå¯¼è‡´ä½¿ç”¨ <code>mixins</code> éƒ½ä¼šå¢åŠ ä¸€äº›å¼€å‘è´Ÿæ‹…ã€‚å½“ç„¶ä¹Ÿæ˜¯è¿™äº›é—®é¢˜å¯ä»¥ä½¿ç”¨è§„èŒƒæ¥è§„é¿ã€‚</p><h1 id="ç†è§£å¹¶ä½¿ç”¨-SSR"><a href="#ç†è§£å¹¶ä½¿ç”¨-SSR" class="headerlink" title="ç†è§£å¹¶ä½¿ç”¨ SSR"></a>ç†è§£å¹¶ä½¿ç”¨ SSR</h1><blockquote><p>SSR æ˜¯ Serve Side Render çš„ç¼©å†™ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æœåŠ¡ç«¯æ¸²æŸ“</p></blockquote><h2 id="ç®€å•å½’çº³-SSR-å­˜åœ¨çš„åŸå› "><a href="#ç®€å•å½’çº³-SSR-å­˜åœ¨çš„åŸå› " class="headerlink" title="ç®€å•å½’çº³ SSR å­˜åœ¨çš„åŸå› "></a>ç®€å•å½’çº³ SSR å­˜åœ¨çš„åŸå› </h2><ol><li>SPA æ¡†æ¶ SEO çš„è§£å†³æ–¹æ¡ˆ</li><li>æå‡é¦–å±åŠ è½½é€Ÿåº¦</li></ol><p>ä½†æ˜¯å®ƒè¿˜å­˜åœ¨ä»¥ä¸‹é—®é¢˜</p><ul><li>æœ‰äº›ç”Ÿå‘½å‘¨æœŸé’©å­æ— æ³•ä½¿ç”¨ï¼ˆä¹‹å‰æåˆ°çš„ activated å’Œ deactivated ç­‰ç­‰ï¼‰</li><li>é¢å¤–å¾ˆå¤šçš„é…ç½®</li><li>æœåŠ¡å™¨èµ„æºçš„éœ€æ±‚</li></ul><p>æ€»å¾—æ¥è¯´ï¼ŒSSR æ˜¯å¿…è¦çš„ä½†ä¸æ˜¯å……åˆ†çš„ï¼ŒSPA çš„ SEO ç°åœ¨æ²¡æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œæœ‰è¿™æ–¹é¢å¼ºçƒˆéœ€æ±‚çš„ç½‘ç«™æ¥è¯´ï¼ŒSSR ç¡®å®å¾ˆæœ‰å¿…è¦</p><h2 id="SSR-åŸç†"><a href="#SSR-åŸç†" class="headerlink" title="SSR åŸç†"></a>SSR åŸç†</h2><p><img src="https://user-gold-cdn.xitu.io/2020/3/10/170c3ed6607a605c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="SSR åŸç†"></p><p>é€šè¿‡ä¸Šé¢å›¾æˆ‘ä»¬å¯ä»¥å¾—å¤§è‡´å‡ ç‚¹å†…å®¹</p><ul><li>é€šç”¨ä¸šåŠ¡ä»£ç åªå†™ä¸€å¥—ã€‚</li><li>é€šè¿‡æš´éœ²å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸¤ä¸ªå…¥å£ï¼Œå¯¹ Vue å®ä¾‹è¿›è¡Œè®¿é—®ã€‚</li><li>é€šè¿‡æ„å»ºå·¥å…·æ‰“æˆä¸¤ä¸ªåŒ…ï¼ŒæœåŠ¡ç«¯åŒ…é€šè¿‡ node æœåŠ¡å™¨æ¸²æŸ“ç»™æµè§ˆå™¨è®¿é—®ã€‚å®¢æˆ·ç«¯å’ŒåŸæ¥ä¸€æ ·é€šè¿‡è®¿é—®èµ„æºè·å–ã€‚</li></ul><h2 id="å®ç°SSR-æœ‰-3-ç§æ–¹å¼"><a href="#å®ç°SSR-æœ‰-3-ç§æ–¹å¼" class="headerlink" title="å®ç°SSR æœ‰ 3 ç§æ–¹å¼"></a>å®ç°SSR æœ‰ 3 ç§æ–¹å¼</h2><ol><li>æ ¹æ®å®˜ç½‘æ•™ç¨‹æ­å»ºï¼Œä¸€æ­¥ä¸€æ­¥æ­å»ºSSRï¼Œ è¿™é‡Œæœ‰å…·ä½“æ•™ç¨‹ï¼Œç•¥å¾®æœ‰ç‚¹éº»çƒ¦ï¼Œä½†æ˜¯èƒ½å¤Ÿä½“éªŒæ­å»ºçš„è¿‡ç¨‹ï¼Œæ›´åŠ æ·±å…¥ç»†èŠ‚ã€‚ä½¿ç”¨äºç»ƒä¹ ï¼Œå’Œç°æœ‰é¡¹ç›®çš„æ”¹é€ </li><li>ä½¿ç”¨demoæ”¹é€ ï¼Œå¼€æº demoï¼Œæ–¹ä¾¿çœæ—¶ï¼Œé€‚ç”¨ä»£ç å‚è€ƒå­¦ä¹  <a href="https://github.com/vuejs/vue-hackernews-2.0" target="_blank" rel="noopener">vue-ssr-demo</a></li><li>ä½¿ç”¨nuxtï¼Œé¢„è®¾äº† SSR å’Œé¢„æ¸²æŸ“ï¼Œé€‚ç”¨äºéœ€è¦ SSR çš„æ–°é¡¹ç›®ã€‚</li></ol><p><strong>åˆ†åˆ«å°è¯•ç”¨è¿™ 3 ç§æ–¹å¼æ­å»º SSR</strong></p><h2 id="äº”æ­¥ç®€å•ç†è§£SSRï¼ˆæ ¹æ®å®˜ç½‘æ•™ç¨‹ï¼Œå…·ä½“å®Œæ“ä½œæŸ¥çœ‹æ•´æ•™ç¨‹å’Œdemoï¼‰"><a href="#äº”æ­¥ç®€å•ç†è§£SSRï¼ˆæ ¹æ®å®˜ç½‘æ•™ç¨‹ï¼Œå…·ä½“å®Œæ“ä½œæŸ¥çœ‹æ•´æ•™ç¨‹å’Œdemoï¼‰" class="headerlink" title="äº”æ­¥ç®€å•ç†è§£SSRï¼ˆæ ¹æ®å®˜ç½‘æ•™ç¨‹ï¼Œå…·ä½“å®Œæ“ä½œæŸ¥çœ‹æ•´æ•™ç¨‹å’Œdemoï¼‰"></a>äº”æ­¥ç®€å•ç†è§£SSRï¼ˆæ ¹æ®å®˜ç½‘æ•™ç¨‹ï¼Œå…·ä½“å®Œæ“ä½œæŸ¥çœ‹æ•´æ•™ç¨‹å’Œdemoï¼‰</h2><p><em>è¿™é‡Œä¸»è¦åŠ æ·±ç†è§£ï¼Œvue-cli3+ å®ç°åŸºæœ¬ SSR</em></p><h3 id="ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–"><a href="#ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–"></a>ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–</h3><ul><li>vue-server-renderer ï¼ˆæ ¸å¿ƒä¾èµ–ï¼Œç‰ˆæœ¬å¿…é¡»ä¸ vue ç‰ˆæœ¬ä¸€è‡´ï¼‰</li><li>webpack-mergeï¼ˆç”¨äºwebpacké…ç½®åˆå¹¶ï¼‰</li><li>webpack-node-externals ï¼ˆç”¨äºwebpacké…ç½®æ›´æ”¹ï¼‰</li><li>express (ç”¨äºæœåŠ¡ç«¯æ¸²æŸ“)</li></ul><h3 id="ç¬¬äºŒæ­¥ï¼šå»ºç«‹å…¥å£ï¼Œå¹¶æ”¹é€ æ”¹é€ "><a href="#ç¬¬äºŒæ­¥ï¼šå»ºç«‹å…¥å£ï¼Œå¹¶æ”¹é€ æ”¹é€ " class="headerlink" title="ç¬¬äºŒæ­¥ï¼šå»ºç«‹å…¥å£ï¼Œå¹¶æ”¹é€ æ”¹é€ "></a>ç¬¬äºŒæ­¥ï¼šå»ºç«‹å…¥å£ï¼Œå¹¶æ”¹é€ æ”¹é€ </h3><p>åˆ†ä¸º 2 ä¸ªå…¥å£ï¼Œå°† <code>main.js</code> å®šä¸ºé€šç”¨å…¥å£ï¼Œ å¹¶é¢å¤–å¢åŠ <code>entry-client.js</code> å’Œ <code>entry-serve.js</code> ä¸¤ä¸ª</p><p>1.æ”¹é€ ä¸»è¦å…¥å£ï¼Œåˆ›å»ºå·¥å‚å‡½æ•°</p><pre><code class="js">// main.jsimport Vue from &#39;vue&#39;import App from &#39;./App.vue&#39;import { createRouter } from &quot;./router&quot;// appã€routerexport function createApp () {      const router = createRouter()      const app = new Vue({            router,            render: h =&gt; h(App)      })      return {         app, router     }}</code></pre><p>2.å®¢æˆ·ç«¯å…¥å£</p><pre><code class="js">// client.jsimport { createApp } from &#39;./main&#39;// å®¢æˆ·ç«¯ç‰¹å®šå¼•å¯¼é€»è¾‘const { app } = createApp()app.$mount(&#39;#app&#39;)</code></pre><p>3.æœåŠ¡ç«¯å…¥å£</p><pre><code class="js">// serve.jsimport { createApp } from &quot;./main&quot;;export default context =&gt; {      // å› ä¸ºæœ‰å¯èƒ½ä¼šæ˜¯å¼‚æ­¥è·¯ç”±é’©å­å‡½æ•°æˆ–ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¿”å›ä¸€ä¸ª Promise      return new Promise((resolve, reject) =&gt; {            const { app, router } = createApp();            // è®¾ç½®æœåŠ¡å™¨ç«¯ router çš„ä½ç½®            router.push(context.url);            // ç­‰åˆ° router å°†å¯èƒ½çš„å¼‚æ­¥ç»„ä»¶å’Œé’©å­å‡½æ•°è§£æå®Œ            router.onReady(() =&gt; {                  const matchedComponents = router.getMatchedComponents();                  // åŒ¹é…ä¸åˆ°çš„è·¯ç”±ï¼Œæ‰§è¡Œ reject å‡½æ•°                  if (!matchedComponents.length) {                        return reject({                              code: 404                        });                  }                  // Promise åº”è¯¥ resolve åº”ç”¨ç¨‹åºå®ä¾‹ï¼Œä»¥ä¾¿å®ƒå¯ä»¥æ¸²æŸ“                  resolve(app);           }, reject);      });};</code></pre><h3 id="ç¬¬ä¸‰æ­¥ï¼šæ”¹é€ -vue-config-é…ç½®"><a href="#ç¬¬ä¸‰æ­¥ï¼šæ”¹é€ -vue-config-é…ç½®" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæ”¹é€  vue.config é…ç½®"></a>ç¬¬ä¸‰æ­¥ï¼šæ”¹é€  vue.config é…ç½®</h3><pre><code class="js">const VueSSRServerPlugin = require(&quot;vue-server-renderer/server-plugin&quot;);const VueSSRClientPlugin = require(&quot;vue-server-renderer/client-plugin&quot;);const nodeExternals = require(&quot;webpack-node-externals&quot;);const merge = require(&quot;webpack-merge&quot;);const TARGET_NODE = process.env.WEBPACK_TARGET === &quot;node&quot;;const target = TARGET_NODE ? &quot;server&quot; : &quot;client&quot;;module.exports = {      configureWebpack: () =&gt; ({            entry: `./src/entry-${target}.js`,            devtool: &#39;source-map&#39;,            target: TARGET_NODE ? &quot;node&quot; : &quot;web&quot;,            node: TARGET_NODE ? undefined : false,            output: {                  libraryTarget: TARGET_NODE ? &quot;commonjs2&quot; : undefined            },            externals: TARGET_NODE              ? nodeExternals({                      whitelist: [/\.css$/]                }): undefined,            optimization: {                      splitChunks: undefined            },            plugins: [            TARGET_NODE ? new VueSSRServerPlugin() : new VueSSRClientPlugin()]          }),         //...};</code></pre><h3 id="ç¬¬å››æ­¥ï¼šå¯¹è·¯ç”±-router-æ”¹é€ "><a href="#ç¬¬å››æ­¥ï¼šå¯¹è·¯ç”±-router-æ”¹é€ " class="headerlink" title="ç¬¬å››æ­¥ï¼šå¯¹è·¯ç”± router æ”¹é€ "></a>ç¬¬å››æ­¥ï¼šå¯¹è·¯ç”± router æ”¹é€ </h3><pre><code class="js">export function createRouter(){      return new Router({            mode: &#39;history&#39;,            routes: [                //...            ]      })}</code></pre><h3 id="ç¬¬äº”æ­¥ï¼šä½¿ç”¨-express-è¿è¡ŒæœåŠ¡ç«¯ä»£ç "><a href="#ç¬¬äº”æ­¥ï¼šä½¿ç”¨-express-è¿è¡ŒæœåŠ¡ç«¯ä»£ç " class="headerlink" title="ç¬¬äº”æ­¥ï¼šä½¿ç”¨ express è¿è¡ŒæœåŠ¡ç«¯ä»£ç "></a>ç¬¬äº”æ­¥ï¼šä½¿ç”¨ express è¿è¡ŒæœåŠ¡ç«¯ä»£ç </h3><p>è¿™ä¸€æ­¥ä¸»è¦æ˜¯è®© node æœåŠ¡ç«¯å“åº” HTML ç»™æµè§ˆå™¨è®¿é—®</p><pre><code class="js">const Vue = require(&#39;vue&#39;)const server = require(&#39;express&#39;)()const renderer = require(&#39;vue-server-renderer&#39;).createRenderer()server.get(&#39;*&#39;, (req, res) =&gt; {      const app = new Vue({            data: {                  url: req.url            },            template: `&lt;div&gt;è®¿é—®çš„ URL æ˜¯ï¼š {{ url }}&lt;/div&gt;`      })      renderer.renderToString(app, (err, html) =&gt; {            if (err) {                  res.status(500).end(&#39;Internal Server Error&#39;)                  return            }            res.end(`                  &lt;!DOCTYPE html&gt;                  &lt;html lang=&quot;en&quot;&gt;                   &lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;                    &lt;body&gt;${html}&lt;/body&gt;                  &lt;/html&gt;`)      })})server.listen(8080)</code></pre><h2 id="nuxt-ä½“éªŒ"><a href="#nuxt-ä½“éªŒ" class="headerlink" title="nuxt ä½“éªŒ"></a>nuxt ä½“éªŒ</h2><p>ç®€å•å‡ æ­¥ä½“éªŒä¸‹ nuxt</p><p>å®‰è£…å</p><p><img src="https://user-gold-cdn.xitu.io/2020/3/11/170c7cbe963be44c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="nuxt"></p><p>ç®€å•çœ‹äº†ä¸€ä¸‹æºç ï¼Œnuxt æŠŠæˆ‘ä»¬ä¹‹å‰æåˆ°çš„é‡è¦çš„æ”¹é€ ï¼Œå…¨éƒ¨å°è£…åˆ° .nuxt æ–‡ä»¶å¤¹é‡Œé¢äº†\</p><p><img src="https://user-gold-cdn.xitu.io/2020/3/11/170c7cc50e09b590?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å¯åŠ¨"></p><p>è·‘ä¸€ä¸‹ dev å‘ç°æœ‰ä¸¤ä¸ªç«¯ï¼Œä¸€ä¸ª clinet ç«¯ï¼Œä¸€ä¸ª server ç«¯</p><p><img src="https://user-gold-cdn.xitu.io/2020/3/11/170c7cc93fe6230b?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="demo"></p><p>æœ€åæŸ¥çœ‹ä¸€ä¸‹æ•ˆæœï¼Œæ•´ä¸ªè¿‡ç¨‹æŒºä¸æ»‘çš„ã€‚ç›®å½•ç»“æ„ä¹Ÿæ¯”è¾ƒç¬¦åˆæˆ‘çš„é£æ ¼ï¼Œæ–°é¡¹ç›®éœ€è¦ SSR ä¼šè€ƒè™‘ä½¿ç”¨ nuxt</p><h2 id="ä½¿ç”¨-webpack-æ’ä»¶é¢„æ¸²æŸ“"><a href="#ä½¿ç”¨-webpack-æ’ä»¶é¢„æ¸²æŸ“" class="headerlink" title="ä½¿ç”¨ webpack æ’ä»¶é¢„æ¸²æŸ“"></a>ä½¿ç”¨ webpack æ’ä»¶é¢„æ¸²æŸ“</h2><p>è§£å†³ SEO é—®é¢˜æ˜¯ä¸æ˜¯åªæœ‰ SSR å‘¢ï¼Ÿå…¶å®é¢„æ¸²æŸ“ä¹Ÿèƒ½åšåˆ°ï¼Œé¦–å…ˆ</p><h3 id="åŒºåˆ«ä½¿ç”¨-SSR-å’Œé¢„æ¸²æŸ“"><a href="#åŒºåˆ«ä½¿ç”¨-SSR-å’Œé¢„æ¸²æŸ“" class="headerlink" title="åŒºåˆ«ä½¿ç”¨ SSR å’Œé¢„æ¸²æŸ“"></a>åŒºåˆ«ä½¿ç”¨ SSR å’Œé¢„æ¸²æŸ“</h3><ul><li>æœåŠ¡ç«¯æ¸²æŸ“è§£å†³çš„é—®é¢˜ï¼Œä¸ä»…åªæ˜¯æŠŠ HTML é¡µé¢ç»™æµè§ˆå™¨ï¼Œæ›´é‡è¦çš„æ˜¯å¤„ç†åŠ¨æ€é€»è¾‘å’Œ JS ä»£ç åï¼Œå°†æ¸²æŸ“åå®Œæ•´çš„ HTML ç»™æµè§ˆå™¨ï¼Œæ¸²æŸ“çš„è¿‡ç¨‹åœ¨æœåŠ¡ç«¯ã€‚</li><li>é¢„æ¸²æŸ“ï¼Œæ˜¯åˆ©ç”¨æ„å»ºå·¥å…·åœ¨ webpack ä¸­ç”Ÿæˆé™æ€çš„ HTMLï¼Œç›´æ¥ç»™æµè§ˆå™¨ï¼Œæ¸²æŸ“çš„è¿‡ç¨‹åœ¨æœ¬åœ°ã€‚</li><li>é¢„æ¸²æŸ“æ’ä»¶é‡Œé¢æåˆ°ä¸¤ç§ä¸èƒ½ä½¿ç”¨ï¼šå¤§é‡è·¯ç”±ã€åŠ¨æ€å†…å®¹</li></ul><h3 id="ä½¿ç”¨-prerender-spa-plugin-æ’ä»¶è¿›è¡Œç®€å•é¢„æ¸²æŸ“"><a href="#ä½¿ç”¨-prerender-spa-plugin-æ’ä»¶è¿›è¡Œç®€å•é¢„æ¸²æŸ“" class="headerlink" title="ä½¿ç”¨ prerender-spa-plugin æ’ä»¶è¿›è¡Œç®€å•é¢„æ¸²æŸ“"></a>ä½¿ç”¨ prerender-spa-plugin æ’ä»¶è¿›è¡Œç®€å•é¢„æ¸²æŸ“</h3><ol><li>å®‰è£… prerender-spa-plugin</li></ol><pre><code class="js">yarn prerender-spa-plugin</code></pre><ol start="2"><li>ä¿®æ”¹ webpack é…ç½®ï¼Œæ¯”è¾ƒç®€å•å°±èƒ½å®Œæˆé…ç½®</li></ol><pre><code class="js">const path = require(&#39;path&#39;)const PrerenderSPAPlugin = require(&#39;prerender-spa-plugin&#39;)const Renderer = PrerenderSPAPlugin.PuppeteerRenderermodule.exports = {      plugins: [            //...            new PrerenderSPAPlugin({                  staticDir: path.join(__dirname, &#39;dist&#39;),                  outputDir: path.join(__dirname, &#39;prerendered&#39;),                  indexPath: path.join(__dirname, &#39;dist&#39;, &#39;index.html&#39;),                  routes: [ &#39;/&#39;, &#39;/about&#39;, &#39;/some/deep/nested/route&#39; ],                  postProcess (renderedRoute) {                        renderedRoute.route = renderedRoute.originalPath                        renderedRoute.html = renderedRoute.html.split(/&gt;[\s]+&lt;/gmi).join(&#39;&gt;&lt;&#39;)                        if (renderedRoute.route.endsWith(&#39;.html&#39;)) {                              renderedRoute.outputPath = path.join(__dirname, &#39;dist&#39;, renderedRoute.route)                        }                        return renderedRoute                  },                  minify: {                        collapseBooleanAttributes: true,                        collapseWhitespace: true,                        decodeEntities: true,                        keepClosingSlash: true,                        sortAttributes: true                  },                  renderer: new Renderer({                        inject: {                              foo: &#39;bar&#39;                        },                    maxConcurrentRoutes: 4          ]}</code></pre><h1 id="Vue-å¼€å‘æŠ€å·§æ€»ç»“"><a href="#Vue-å¼€å‘æŠ€å·§æ€»ç»“" class="headerlink" title="Vue å¼€å‘æŠ€å·§æ€»ç»“"></a>Vue å¼€å‘æŠ€å·§æ€»ç»“</h1><blockquote><p>ä» 5 ä¸ªå¤§çš„è§’åº¦æ¥æå‡å¼€å‘æ•ˆç‡å’Œä½“éªŒï¼Œä»£ç ç¾è§‚å’Œä»£ç è´¨é‡ï¼Œç”¨æˆ·ä½“éªŒ</p></blockquote><p><img src="https://user-gold-cdn.xitu.io/2020/3/11/170c9c3a14c4cf39?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æŠ€å·§"></p><h2 id="5-å¤§è§’åº¦æå‡"><a href="#5-å¤§è§’åº¦æå‡" class="headerlink" title="5 å¤§è§’åº¦æå‡"></a>5 å¤§è§’åº¦æå‡</h2><h3 id="ä»£ç å¤ç”¨"><a href="#ä»£ç å¤ç”¨" class="headerlink" title="ä»£ç å¤ç”¨"></a>ä»£ç å¤ç”¨</h3><ul><li>ç»„ä»¶åŒ–å¼€å‘ï¼Œä»£ç æ•ˆç‡ * n</li><li>ä½¿ç”¨ mixins æŠ½ç¦»å…¬å…±é€»è¾‘ï¼Œä»£ç æ•ˆç‡ * n</li><li>å·¥å…·åŒ–å‡½æ•°ã€ä½¿ç”¨ filter ç¼–ç æ•ˆç‡+</li><li>sass å¤ç”¨ cssï¼Œç¼–ç ä½“éªŒã€æ•ˆç‡+</li></ul><h3 id="ä»£ç è´¨é‡"><a href="#ä»£ç è´¨é‡" class="headerlink" title="ä»£ç è´¨é‡"></a>ä»£ç è´¨é‡</h3><ul><li>ä»£ç é™æ€æ£€æŸ¥ eslint + prettierï¼Œä»£ç é£æ ¼+ã€åŸºç¡€è¯­æ³•é”™è¯¯-</li><li>æ•°æ®ç±»å‹æ§åˆ¶ typescriptï¼Œä»£ç è´¨é‡+</li><li>å‰ç«¯æµ‹è¯• testï¼Œä»£ç è´¨é‡+</li></ul><h3 id="ä»£ç ä¼˜åŒ–"><a href="#ä»£ç ä¼˜åŒ–" class="headerlink" title="ä»£ç ä¼˜åŒ–"></a>ä»£ç ä¼˜åŒ–</h3><ul><li>åˆç†ä½¿ç”¨ vueï¼Œæ¸²æŸ“æ€§èƒ½+</li><li>åˆç†ä½¿ç”¨ vuex å‡å°‘è¯·æ±‚ï¼Œä½¿ç”¨å›¾ç‰‡æ‡’åŠ è½½ï¼ŒåŠ è½½æ€§èƒ½+</li><li>åˆç†ä½¿ç”¨å‡½æ•°ç»„ä»¶ï¼Œç»„ä»¶æ€§èƒ½+</li><li>åˆç†éª¨æ¶å±ã€è·¯ç”±è¿‡æ¸¡ï¼Œç”¨æˆ·ä½“éªŒ+</li></ul><h3 id="å¼€å‘æ•ˆç‡"><a href="#å¼€å‘æ•ˆç‡" class="headerlink" title="å¼€å‘æ•ˆç‡"></a>å¼€å‘æ•ˆç‡</h3><ul><li>ä½¿ç”¨æ›´æ–°çš„è„šæ‰‹æ¶ vue-cli4ï¼Œwebpack é…ç½®æ•ˆç‡+</li><li>ä½¿ç”¨é…ç½®å¥½çš„è„šæ‰‹æ¶æ¨¡ç‰ˆ vue-h5-templateï¼Œvue é…ç½®æ•ˆç‡+</li><li>ä½¿ç”¨æ›´ç®€æ´çš„æ¨¡ç‰ˆ pugï¼ŒHTML ç¼–å†™æ•ˆç‡+</li><li>ä½¿ç”¨æ›´å¼ºå¤§çš„ css ç¼–å†™ sassï¼ŒCSS ç¼–å†™æ•ˆç‡+</li><li>ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ® mockï¼Œè„±ç¦»åç«¯å¼€å‘æ•ˆç‡+</li><li>å¼€æºç»„ä»¶å°è£… HOCï¼Œç»„ä»¶å¼€å‘ï¼Œé¡µé¢ç¼–å†™æ•ˆç‡+</li></ul><h3 id="ç“¶é¢ˆè§£å†³"><a href="#ç“¶é¢ˆè§£å†³" class="headerlink" title="ç“¶é¢ˆè§£å†³"></a>ç“¶é¢ˆè§£å†³</h3><ul><li>è·¯ç”±historyä½¿ç”¨ï¼ŒæœåŠ¡ç«¯é…ç½®ç›¸å…³ï¼ŒURLç¾è§‚+</li><li>è§£å†³SEOä¸é¦–å±åŠ è½½ã€æœåŠ¡ç«¯æ¸²æŸ“ SSR åŸºæœ¬è§£å†³</li></ul>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åƒé€Vueé¡¹ç›®å¼€å‘å®è·µ(ä¸­)</title>
      <link href="/2020/05/09/Vue/%E5%90%83%E9%80%8FVue%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5-%E4%B8%AD/"/>
      <url>/2020/05/09/Vue/%E5%90%83%E9%80%8FVue%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5-%E4%B8%AD/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5e15932ee51d4540f02fae27" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h1><p><img src="https://user-gold-cdn.xitu.io/2019/12/30/16f5676f7940d72a?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æ¦‚è§ˆ"></p><h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><blockquote><p>æœ¬èŠ‚å†…å®¹ä¸»è¦å›´ç»•ä¸‹åˆ—é—®é¢˜å±•å¼€ï¼š</p></blockquote><ul><li>å¦‚ä½•ç¼–å†™åŸç”Ÿç»„ä»¶ï¼Œä»¥åŠç»„ä»¶ç¼–å†™çš„æ€è€ƒä¸åŸåˆ™ï¼Ÿ</li><li>ç»„ä»¶æ€ä¹ˆé€šä¿¡ï¼Ÿæœ‰å“ªäº›æ–¹å¼ï¼Ÿ</li><li>å¦‚ä½•ä½¿ç”¨vuex ä»¥åŠå®ƒçš„åº”ç”¨åœºæ™¯å’ŒåŸç†</li><li>å¦‚ä½•ä½¿ç”¨è¿‡æ»¤å™¨ï¼Œç¼–å†™è‡ªå·±çš„è¿‡æ»¤å™¨</li><li>å¦‚ä½•ä½¿ç”¨ Jest æµ‹è¯•ä½ çš„ä»£ç ï¼ŸTDD ä¸ BDD çš„æ¯”è¾ƒ</li></ul><h2 id="å¦‚ä½•ç¼–å†™åŸç”Ÿç»„ä»¶"><a href="#å¦‚ä½•ç¼–å†™åŸç”Ÿç»„ä»¶" class="headerlink" title="å¦‚ä½•ç¼–å†™åŸç”Ÿç»„ä»¶"></a>å¦‚ä½•ç¼–å†™åŸç”Ÿç»„ä»¶</h2><h3 id="ç»„ä»¶ç¼–å†™åŸç†"><a href="#ç»„ä»¶ç¼–å†™åŸç†" class="headerlink" title="ç»„ä»¶ç¼–å†™åŸç†"></a>ç»„ä»¶ç¼–å†™åŸç†</h3><p>vue ç¼–å†™ç»„ä»¶æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯å•æ–‡ä»¶ç»„ä»¶ï¼Œå¦å¤–ä¸€ç§å‡½æ•°ç»„ä»¶ã€‚æ ¹æ®ç»„ä»¶å¼•å…¥å’Œåˆ›å»ºè¿˜å¯ä»¥åˆ†ä¸ºåŠ¨æ€ç»„ä»¶å’Œå¼‚æ­¥ç»„ä»¶ã€‚</p><p>åŠ¨æ€ç»„ä»¶<code>keep-alive</code>ä½¿ä¹‹ç¼“å­˜ã€‚å¼‚æ­¥ç»„ä»¶åŸç†å’Œå¼‚æ­¥è·¯ç”±ä¸€æ ·ï¼Œä½¿ç”¨<code>import()</code>å®ç°å¼‚æ­¥åŠ è½½ä¹Ÿå°±æ˜¯æŒ‰éœ€åŠ è½½ã€‚</p><p>æ‰€è°“ vue å•æ–‡ä»¶ç»„ä»¶ï¼Œå°±æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„è¿™ç§å½¢å¼ï¼š</p><pre><code class="js">&lt;template lang=&quot;pug&quot;&gt;    .demo      h1 hello&lt;/template&gt;&lt;script&gt;export default {  name: &#39;demo&#39;,  data() {    return {}  }}&lt;/script&gt;&lt;style lang=&quot;scss&quot; scoped&gt;.demo {  h1 {    color: #f00;  }}&lt;/style&gt;</code></pre><p>è¿™é‡Œçš„template ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>render</code> å‡½æ•°æ¥ç¼–å†™</p><pre><code class="js">Vue.component(&#39;demo&#39;, {    render: function (createElement) {      return createElement(        &#39;h1&#39;,      &#39;hello&#39;,         // ...          )      }})</code></pre><p>æˆ‘ä»¬å¯ä»¥å‘ç°<code>render</code>å‡½æ•°å†™æ¨¡ç‰ˆè®©æˆ‘ä»¬æ›´æœ‰ç¼–ç¨‹çš„æ„Ÿè§‰ã€‚<br>å¯¹æ¨¡ç‰ˆä¹Ÿå¯ä»¥ç¼–ç¨‹ï¼Œåœ¨vue é‡Œé¢æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“è”æƒ³åˆ°ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½æœ‰ä¸¤ç§å†™æ³•ï¼Œä¸€ç§æ˜¯ <code>template</code> ï¼Œ ä¸€ç§æ˜¯<code>js</code>ã€‚<br>æ¯”å¦‚ï¼šå¯¹äºè·¯ç”±ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥ä½¿ç”¨<code>:to=&quot;&quot;</code>ï¼Œåˆå¯ä»¥ä½¿ç”¨<code>$router.push</code>ï¼Œè¿™ä¹Ÿè®¸æ˜¯ vue ç”¨èµ·æ¥æ¯”è¾ƒçˆ½çš„åŸå› ã€‚</p><h4 id="å‡½æ•°å¼ç»„ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ"><a href="#å‡½æ•°å¼ç»„ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ" class="headerlink" title="å‡½æ•°å¼ç»„ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ"></a>å‡½æ•°å¼ç»„ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</h4><p><code>functional</code>ï¼Œè¿™æ„å‘³å®ƒ<strong>æ— çŠ¶æ€ (æ²¡æœ‰å“åº”å¼æ•°æ®)</strong>ï¼Œä¹Ÿæ²¡æœ‰<strong>å®ä¾‹</strong> (æ²¡æœ‰ this ä¸Šä¸‹æ–‡)</p><ul><li>å•æ–‡ä»¶å½¢å¼ 2.5.0+</li></ul><pre><code class="html">&lt;template functional&gt;&lt;/template&gt;</code></pre><ul><li>Render å‡½æ•°å½¢å¼</li></ul><pre><code class="js">Vue.component(&#39;my-component&#39;, {  functional: true,  render function (createElement, context) {    return createElement(&#39;div&#39;)      }}</code></pre><h4 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å‡½æ•°ç»„ä»¶å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å‡½æ•°ç»„ä»¶å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å‡½æ•°ç»„ä»¶å‘¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å‡½æ•°ç»„ä»¶å‘¢ï¼Ÿ</h4><p>æœ€é‡è¦çš„åŸå› å°±æ˜¯<strong>å‡½æ•°ç»„ä»¶å¼€é”€ä½</strong>ï¼Œä¹Ÿå°±æ˜¯å¯¹æ€§èƒ½æœ‰å¥½å¤„ï¼Œåœ¨ä¸éœ€è¦å“åº”å¼å’Œthisçš„æƒ…å†µä¸‹ï¼Œå†™æˆå‡½æ•°å¼ç»„ä»¶ç®—æ˜¯ä¸€ç§ä¼˜åŒ–æ–¹æ¡ˆã€‚</p><p>ç»„ä»¶å†™å¥½äº†ï¼Œéœ€è¦å°†ç»„ä»¶æ³¨å†Œæ‰èƒ½ä½¿ç”¨</p><h3 id="ç»„ä»¶æ³¨å†Œçš„ä¸¤ç§æ–¹å¼"><a href="#ç»„ä»¶æ³¨å†Œçš„ä¸¤ç§æ–¹å¼" class="headerlink" title="ç»„ä»¶æ³¨å†Œçš„ä¸¤ç§æ–¹å¼"></a>ç»„ä»¶æ³¨å†Œçš„ä¸¤ç§æ–¹å¼</h3><p>ç»„ä»¶æ³¨å†Œåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯å…¨å±€æ³¨å†Œï¼Œä¸€ç§æ˜¯å±€éƒ¨æ³¨å†Œ</p><p><code>å±€éƒ¨æ³¨å†Œ</code>å°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ <code>Vue.component(&#39;s-button&#39;, { /* ... */ })</code>ï¼Œæ¯”è¾ƒç®€å•ä¸è¯¦ç»†è®ºè¿°</p><p><code>å…¨å±€æ³¨å†Œ</code>ä¸ŠèŠ‚å·²ç»æåˆ°ï¼Œåœ¨<code>new Vue</code> ä¹‹å‰åœ¨ <code>mian.js</code>æ³¨å†Œï¼Œè¿™é‡Œè¿˜æåˆ°ä¸€ç§è‡ªåŠ¨å…¨å±€æ³¨å†Œçš„æ–¹æ³• <code>**require.text**</code></p><pre><code class="js">import Vue from &#39;vue&#39;import upperFirst from &#39;lodash/upperFirst&#39;import camelCase from &#39;lodash/camelCase&#39;const requireComponent = require.context(  &#39;./components&#39;,  // æ˜¯å¦æŸ¥è¯¢å…¶å­ç›®å½•  false,  /Base[A-Z]\w+\.(vue|js)$/)requireComponent.keys().forEach(fileName =&gt; {    // è·å–ç»„ä»¶é…ç½®     const componentConfig = requireComponent(fileName)    const componentName = upperFirst(          camelCase(                 // è·å–å’Œç›®å½•æ·±åº¦æ— å…³çš„æ–‡ä»¶å            fileName.split(&#39;/&#39;).pop().replace(/\.\w+$/, &#39;&#39;)          )    )      // å…¨å±€æ³¨å†Œç»„ä»¶    Vue.component(      componentName,      componentConfig.default || componentConfig      )})</code></pre><p>åŸºæœ¬åŸç†å’Œå…¨å±€æ³¨å†Œä¸€æ ·ï¼Œå°±æ˜¯å°† <code>components</code> ä¸­çš„ç»„ä»¶æ–‡ä»¶åï¼Œ<code>appButton</code>å˜æˆ <code>AppButton</code> ä½œä¸ºæ³¨å†Œçš„ç»„ä»¶åã€‚<br>æŠŠåŸæ¥éœ€è¦æ‰‹åŠ¨å¤åˆ¶çš„ï¼Œå˜æˆä¹‹é—´ä½¿ç”¨ <code>keys</code> æ–¹æ³•æ‰¹é‡æ³¨å†Œã€‚</p><h3 id="å®è·µå¼€å‘ä¸€ä¸ª-button-ç»„ä»¶"><a href="#å®è·µå¼€å‘ä¸€ä¸ª-button-ç»„ä»¶" class="headerlink" title="å®è·µå¼€å‘ä¸€ä¸ª button ç»„ä»¶"></a>å®è·µå¼€å‘ä¸€ä¸ª button ç»„ä»¶</h3><p>ç°åœ¨ï¼Œæˆ‘ä»¬ä»¥å†™ä¸€ä¸ªç®€å•çš„åŸç”Ÿ <code>button</code>ç»„ä»¶ä¸ºä¾‹ï¼Œæ¢è®¨ä¸€ä¸‹ç»„ä»¶å¼€å‘çš„ä¸€äº›å…³é”®ç‚¹ã€‚ å†™ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æŠ“ä½ 4 ä¸ªæ ¸å¿ƒçš„è¦ç‚¹ï¼š</p><ul><li><strong>ç”¨å“ªä¸ªæ ‡ç­¾ä½œä¸ºç»„ä»¶ä¸»ä½“ï¼Œ <code>button</code> è¿˜æ˜¯ <code>div</code> æ ‡ç­¾</strong></li><li><strong>å¦‚ä½•æ ¹æ®å±æ€§æ§åˆ¶ <code>button</code> ç»„ä»¶çš„é¢œè‰² <code>color</code> ã€å½¢çŠ¶ <code>type</code> ã€å¤§å° <code>size</code></strong></li><li><strong>å¦‚ä½•å¤„ç† <code>button</code> ç»„ä»¶çš„ç‚¹å‡»äº‹ä»¶</strong></li><li>*<em>å¦‚ä½•å»æ‰©å±• <code>button</code> ç»„ä»¶çš„å†…å®¹</em></li></ul><blockquote><p>è¿™äº›æ€è€ƒç‚¹åœ¨å…¶ä»–åŸç”Ÿç»„ä»¶å¼€å‘å’Œé«˜é˜¶ç»„ä»¶å°è£…é‡Œé¢ä¹Ÿéœ€è¦è€ƒè™‘åˆ°</p></blockquote><p>é¦–å…ˆçœ‹ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå¤§éƒ¨åˆ†åŸç”Ÿç»„ä»¶ç¬¬ä¸€è€ƒè™‘çš„åœ°æ–¹ï¼Œå°±æ˜¯ä¸»è¦æ ‡ç­¾ç”¨åŸç”Ÿ <code>&lt;button&gt;&lt;/button&gt;</code>æ ‡ç­¾è¿˜æ˜¯ç”¨ å»æ¨¡æ‹Ÿã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆä¸è€ƒè™‘ <code>&lt;input&gt;</code>å‘¢ï¼Œå› ä¸º <code>&lt;button&gt;&lt;/button&gt;</code> å…ƒç´ æ¯” <code>&lt;input&gt;</code> å…ƒç´ æ›´å®¹æ˜“æ·»åŠ å†…éƒ¨å…ƒç´ ã€‚ä½ å¯ä»¥åœ¨å…ƒç´ å†…æ·»åŠ HTMLå†…å®¹ï¼ˆåƒ ã€ ç”šè‡³ <code>&lt;img&gt;</code>ï¼‰ï¼Œä»¥åŠ <code>::after</code> å’Œ <code>::before</code> ä¼ªå…ƒç´ æ¥å®ç°å¤æ‚çš„æ•ˆæœï¼Œè€Œ <code>&lt;input&gt;</code> åªæ”¯æŒæ–‡æœ¬å†…å®¹ã€‚</p></blockquote><p>ä¸‹é¢åˆ†æè¿™ä¸¤ç§å†™æ³•çš„ä¼˜åŠ£</p><p><strong>ä½¿ç”¨åŸç”Ÿ <code>button</code> æ ‡ç­¾çš„ä¼˜åŠ¿ï¼š</strong></p><ol><li>æ›´å¥½çš„æ ‡ç­¾è¯­ä¹‰åŒ–</li><li>åŸç”Ÿæ ‡ç­¾è‡ªå¸¦çš„ <code>buff</code> ï¼Œä¸€äº›è‡ªå¸¦çš„é”®ç›˜äº‹ä»¶è¡Œä¸ºç­‰</li></ol><blockquote><p>ä¸ºä»€ä¹ˆè¯´æ›´å¥½çš„è¯­ä¹‰åŒ–å‘¢ï¼Ÿæœ‰äººå¯èƒ½ä¼šè¯´ï¼Œå¯ä»¥ä½¿ç”¨ <code>role</code> æ¥å¢å¼º <code>div</code> çš„è¯­ä¹‰åŒ–ã€‚ç¡®å®å¯ä»¥ï¼Œä½†æ˜¯å¯èƒ½å­˜åœ¨é—®é¢˜â€”â€”æœ‰äº›çˆ¬è™«å¹¶ä¸ä¼šæ ¹æ® <code>role</code> æ¥ç¡®å®šè¿™ä¸ªæ ‡ç­¾çš„å«ä¹‰ã€‚</p></blockquote><blockquote><p>å¦å¤–ä¸€ç‚¹ï¼Œå¯¹å¼€å‘è€…æ¥è¯´ï¼Œ <code>&lt;button&gt;&lt;/button&gt;</code> æ¯” é˜…è¯»èµ·æ¥æ›´å¥½ã€‚</p></blockquote><p><strong>ä½¿ç”¨ <code>div</code> æ¨¡æ‹Ÿçš„ä¼˜åŠ¿ï¼š</strong></p><ol><li>ä¸éœ€è¦å…³å¿ƒ <code>button</code> åŸç”Ÿæ ·å¼å¸¦æ¥çš„ä¸€äº›å¹²æ‰°ï¼Œå°‘å†™ä¸€äº›è¦†ç›–åŸç”Ÿ <code>css</code> çš„ä»£ç ï¼Œæ›´å¹²å‡€çº¯ç²¹ã€‚</li><li>å…¨éƒ¨ç”¨ <code>div</code> ï¼Œä¸éœ€è¦å†å»æ‰¾åŸç”Ÿæ ‡ç­¾ã€æ·±å…¥äº†è§£åŸç”Ÿæ ‡ç­¾çš„ä¸€äº›å…¼å®¹ç›¸å…³çš„è¯¡å¼‚é—®é¢˜ã€‚</li><li>å¯å¡‘æ€§æ›´å¼ºï¼Œä¹Ÿå°±æ˜¯æ‹“å±•æ€§å’Œå…¼å®¹æ€§æ›´å¥½ã€‚è¿™ä¹Ÿæ˜¯å¤§å¤šæ•°ç»„ä»¶éƒ½ä¼šé€‰æ‹©ä½¿ç”¨ <code>div</code> ä½œä¸ºç»„ä»¶ä¸»ä½“çš„åŸå› ã€‚</li></ol><blockquote><p>è²Œä¼¼ div é™¤äº†è¯­ä¹‰ä¸æ˜¯å¾ˆå¥½ä»¥å¤–ï¼Œå…¶ä»–æ–¹é¢éƒ½è¿˜è¡Œï¼Œä½†æ˜¯å…·ä½“ç”¨å“ªä¸€ç§å…¶å®éƒ½å¯ä»¥ï¼Œåªè¦ä»£ç å†™çš„å¥å£®é€‚é…æ€§å¼ºï¼ŒåŸºæœ¬éƒ½æ²¡å•¥å¤§é—®é¢˜ã€‚</p></blockquote><p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨åŸç”Ÿ <code>&lt;button&gt;&lt;/button&gt;</code>ä½œä¸ºä¸»è¦æ ‡ç­¾ï¼Œä½¿ç”¨ <code>s-xx</code>ä½œä¸º <code>class</code>å‰ç¼€</p><blockquote><p>ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å‰ç¼€ï¼Œå› ä¸ºåœ¨æœ‰äº›æ—¶å€™ï¼Œæ¯”å¦‚ä½¿ç”¨ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œå¤šä¸ªç»„ä»¶ä¹‹é—´çš„ class å¯èƒ½ä¼šäº§ç”Ÿå†²çªï¼Œå‰ç¼€ç”¨æ¥å……å½“ç»„ä»¶ css çš„ä¸€ä¸ªå‘½åç©ºé—´ï¼Œä¸åŒç»„ä»¶ä¹‹é—´ä¸ä¼šå¹²æ‰°ã€‚</p></blockquote><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;   button.s-button(:class=&quot;xxx&quot; :style=&quot;xxx&quot; )     slot&lt;/template&gt;</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬çœ‹ç¬¬äºŒä¸ªé—®é¢˜ï¼š</p><p><strong>å¦‚ä½•æ ¹æ®å±æ€§æ¥æ§åˆ¶ <code>button</code> çš„æ ·å¼</strong> å…¶å®è¿™ä¸ªå¾ˆç®€å•ï¼ŒåŸºæœ¬åŸç†å°±æ˜¯ï¼š</p><ol><li>ä½¿ç”¨ <code>props</code> è·å–çˆ¶ç»„ä»¶ä¼ è¿‡æ¥çš„å±æ€§ã€‚</li><li>æ ¹æ®ç›¸å…³å±æ€§ï¼Œç”Ÿæˆä¸åŒçš„ <code>class</code>ï¼Œä½¿ç”¨ <code>:class=&quot;{xxx: true, xxx: &#39;s-button--&#39; + size}&quot;</code> è¿™ç§å½¢å¼ï¼Œåœ¨ <code>style</code> é‡Œé¢å¯¹ä¸åŒçš„ <code>s-button--xxx</code> åšå‡ºä¸åŒçš„å¤„ç†ã€‚</li></ol><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;  button.s-button(:class=&quot;&quot; :style=&quot;&quot; )    slot&lt;/template&gt;&lt;script&gt;export default {    name: &#39;s-button&#39;    data: return {}    props: {        theme: {},        size: {},        type: {}    }}&lt;/script&gt;  </code></pre><p><strong>å¦‚ä½•ä½¿ç”¨äº‹ä»¶ä»¥åŠå¦‚ä½•æ‰©å±•ç»„ä»¶</strong></p><p>æ‰©å±•ç»„ä»¶çš„åŸç†ï¼Œä¸»è¦å°±æ˜¯ä½¿ç”¨ <code>props</code> æ§åˆ¶ç»„ä»¶å±æ€§ï¼Œæ¨¡ç‰ˆä¸­ä½¿ç”¨ <code>v-if/v-show</code> å¢åŠ ç»„ä»¶åŠŸï¼Œæ¯”å¦‚å¢åŠ å†…éƒ¨ ICONï¼Œä½¿ç”¨ <code>:style class</code>æ§åˆ¶ç»„ä»¶æ ·å¼ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9d9414f682625?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="type"> </p><p>è¿˜è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬è¿˜è¦æ§åˆ¶åŸç”Ÿ <code>type</code> ç±»å‹ï¼ŒåŸç”Ÿé»˜è®¤æ˜¯ <code>submit</code>ï¼Œè¿™é‡Œæˆ‘ä»¬é»˜è®¤è®¾ç½®ä¸º <code>button</code></p><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt; button.s-button(:class=&quot;&quot; :style=&quot;&quot; :type=&quot;nativeType&quot;)   slot   s-icon(v-if=&quot;icon &amp;&amp; $slots.icon&quot; name=&quot;loading&quot;)&lt;/template&gt;&lt;script&gt;export default {    name: &#39;s-button&#39;    data: return {}    props: {        nativeType: {            type: String,            default: &#39;button&#39;        },        theme: {},        size: {},        type: {}    }}&lt;/script&gt;</code></pre><p>æ§åˆ¶äº‹ä»¶ï¼Œç›´æ¥ä½¿ç”¨ <code>@click=&quot;&quot;</code> + <code>emit</code></p><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;  button.s-button(@click=&quot;handleClick&quot;)&lt;/template&gt;&lt;script&gt;export default {    methods: {        handleClick (evt) {            this.$emit(&#39;click&#39;, evt)          }      }}&lt;/script&gt;</code></pre><h4 id="æœ€åæ€»ç»“ä¸‹ï¼š"><a href="#æœ€åæ€»ç»“ä¸‹ï¼š" class="headerlink" title="æœ€åæ€»ç»“ä¸‹ï¼š"></a>æœ€åæ€»ç»“ä¸‹ï¼š</h4><blockquote><p>ä¸€èˆ¬å°±ç›´æ¥ä½¿ç”¨ <code>template</code>å•æ–‡ä»¶ç¼–å†™ç»„ä»¶ï¼Œéœ€è¦å¢å¼º jsç¼–å†™èƒ½åŠ›å¯ä»¥ä½¿ç”¨ <code>render()</code><br>å¸¸è§„ç¼–å†™ç»„ä»¶éœ€è¦è€ƒè™‘ï¼š1. ä½¿ç”¨ä»€ä¹ˆæ ‡ç­¾ 2. å¦‚ä½•æ§åˆ¶å„ç§å±æ€§çš„è¡¨ç° 3. å¦‚ä½•å¢å¼ºç»„ä»¶æ‰©å±•æ€§ 4. å¦‚ä½•å¤„ç†ç»„ä»¶äº‹ä»¶</p></blockquote><blockquote><p>å¯¹å“åº”å¼ <code>this</code>è¦æ±‚ä¸é«˜ï¼Œä½¿ç”¨å‡½æ•° <code>functional</code>ç»„ä»¶ä¼˜åŒ–æ€§èƒ½ã€‚</p></blockquote><blockquote><p>åŸºç¡€ç»„ä»¶é€šå¸¸å…¨å±€æ³¨å†Œï¼Œä¸šåŠ¡ç»„ä»¶é€šå¸¸å±€éƒ¨æ³¨å†Œ</p></blockquote><blockquote><p>ä½¿ç”¨ <code>keys()</code>éå†æ–‡ä»¶æ¥å®ç°è‡ªåŠ¨æ‰¹é‡å…¨å±€æ³¨å†Œ</p></blockquote><blockquote><p>ä½¿ç”¨ <code>import()</code> å¼‚æ­¥åŠ è½½ç»„ä»¶æå‡å‡å°‘é¦–æ¬¡åŠ è½½å¼€é”€ï¼Œä½¿ç”¨ <code>keep-alive + is</code>ç¼“å­˜ç»„ä»¶å‡å°‘äºŒæ¬¡åŠ è½½å¼€é”€</p></blockquote><h2 id="å¦‚ä½•ä½¿ç”¨-vuex-ä»¥åŠå®ƒçš„åº”ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨-vuex-ä»¥åŠå®ƒçš„åº”ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ vuex ä»¥åŠå®ƒçš„åº”ç”¨"></a>å¦‚ä½•ä½¿ç”¨ vuex ä»¥åŠå®ƒçš„åº”ç”¨</h2><h3 id="ç”±æ¥ä»¥åŠåŸç†"><a href="#ç”±æ¥ä»¥åŠåŸç†" class="headerlink" title="ç”±æ¥ä»¥åŠåŸç†"></a>ç”±æ¥ä»¥åŠåŸç†</h3><p>æˆ‘ä»¬çŸ¥é“ç»„ä»¶ä¸­é€šä¿¡æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p><h4 id="1-çˆ¶ç»„ä»¶é€šè¿‡-props-ä¼ é€’ç»™å­ç»„ä»¶ï¼Œä¸è¯¦ç»†è®ºè¿°"><a href="#1-çˆ¶ç»„ä»¶é€šè¿‡-props-ä¼ é€’ç»™å­ç»„ä»¶ï¼Œä¸è¯¦ç»†è®ºè¿°" class="headerlink" title="1. çˆ¶ç»„ä»¶é€šè¿‡ props ä¼ é€’ç»™å­ç»„ä»¶ï¼Œä¸è¯¦ç»†è®ºè¿°"></a>1. çˆ¶ç»„ä»¶é€šè¿‡ <code>props</code> ä¼ é€’ç»™å­ç»„ä»¶ï¼Œä¸è¯¦ç»†è®ºè¿°</h4><h4 id="2-å­ç»„ä»¶é€šè¿‡-emit-äº‹ä»¶ä¼ é€’æ•°æ®ç»™çˆ¶ç»„ä»¶-çˆ¶ç»„ä»¶é€šè¿‡-on-ç›‘å¬ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„-è®¢é˜…-å‘å¸ƒæ¨¡å‹"><a href="#2-å­ç»„ä»¶é€šè¿‡-emit-äº‹ä»¶ä¼ é€’æ•°æ®ç»™çˆ¶ç»„ä»¶-çˆ¶ç»„ä»¶é€šè¿‡-on-ç›‘å¬ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„-è®¢é˜…-å‘å¸ƒæ¨¡å‹" class="headerlink" title="2. å­ç»„ä»¶é€šè¿‡ emit äº‹ä»¶ä¼ é€’æ•°æ®ç»™çˆ¶ç»„ä»¶,çˆ¶ç»„ä»¶é€šè¿‡ on ç›‘å¬ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ è®¢é˜…-å‘å¸ƒæ¨¡å‹"></a>2. å­ç»„ä»¶é€šè¿‡ <code>emit</code> äº‹ä»¶ä¼ é€’æ•°æ®ç»™çˆ¶ç»„ä»¶,çˆ¶ç»„ä»¶é€šè¿‡ <code>on</code> ç›‘å¬ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ <strong>è®¢é˜…-å‘å¸ƒ</strong>æ¨¡å‹</h4><blockquote><p><code>@</code> ä¸º <code>v-on:</code> çš„ç®€å†™</p></blockquote><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;&lt;!--å­ç»„ä»¶--&gt;    div.component-1&lt;template&gt;&lt;script&gt;export default {    mounted() {        this.$emit(&#39;eventName&#39;, params)      }}&lt;/script&gt;</code></pre><pre><code class="html">&lt;!-- çˆ¶ç»„ä»¶--&gt;&lt;template lang=&quot;pug&quot;&gt;    Component-1(@eventName=&quot;handleEventName&quot;)&lt;template&gt;&lt;script&gt;export default {    methods: {        handleEventName (params) {            console.log(params)        }  }&lt;/script&gt;</code></pre><h4 id="3-é›†ä¸­å¼é€šä¿¡äº‹ä»¶ï¼Œä¸»è¦ç”¨äºç®€å•çš„éçˆ¶å­ç»„ä»¶é€šä¿¡"><a href="#3-é›†ä¸­å¼é€šä¿¡äº‹ä»¶ï¼Œä¸»è¦ç”¨äºç®€å•çš„éçˆ¶å­ç»„ä»¶é€šä¿¡" class="headerlink" title="3. é›†ä¸­å¼é€šä¿¡äº‹ä»¶ï¼Œä¸»è¦ç”¨äºç®€å•çš„éçˆ¶å­ç»„ä»¶é€šä¿¡"></a>3. é›†ä¸­å¼é€šä¿¡äº‹ä»¶ï¼Œä¸»è¦ç”¨äºç®€å•çš„éçˆ¶å­ç»„ä»¶é€šä¿¡</h4><p>åŸç†å¾ˆç®€å•å…¶å®å°±æ˜¯åœ¨ <code>emit</code> ä¸ <code>on</code> çš„åŸºç¡€ä¸ŠåŠ äº†ä¸€ä¸ªäº‹ä»¶ä¸­è½¬ç«™ â€œbusâ€ã€‚æˆ‘è§‰å¾—æ›´åƒæ˜¯ç°å®ç”Ÿæ´»ä¸­çš„é›†çº¿å™¨ã€‚</p><p>æ™®éçš„å®ç°åŸç†å¤§æ¦‚æ˜¯è¿™æ ·çš„ â€œbusâ€ ä¸º <code>vue</code> çš„ä¸€ä¸ªå®ä¾‹ï¼Œå®ä¾‹é‡Œé¢å¯ä»¥è°ƒç”¨ <code>emit</code>, <code>off</code>, <code>on</code> è¿™äº›æ–¹æ³•ã€‚</p><pre><code class="js">var eventHub = new Vue()// å‘å¸ƒeventHub.$emit(&#39;add&#39;, params)// è®¢é˜…/å“åº”eventHub.$on(&#39;add&#39;, params)// é”€æ¯eventHub.$off(&#39;add&#39;, params)</code></pre><p>ä½†æ˜¯ç¨å¾®å¤æ‚ç‚¹çš„æƒ…å†µï¼Œä½¿ç”¨è¿™ç§æ–¹å¼å°±å¤ªç¹é”äº†ã€‚è¿˜æ˜¯ä½¿ç”¨ vuex æ¯”è¾ƒå¥½ã€‚</p><p>ä»æŸç§æ„ä¹‰è€Œè¨€ï¼Œæˆ‘è§‰å¾— vuex ä¸ä»…ä»…æ˜¯å®ƒçš„ä¸€ç§è¿›åŒ–ç‰ˆã€‚</p><ol><li>ä½¿ç”¨ <code>store</code> ä½œä¸º <strong>çŠ¶æ€ç®¡ç†</strong> çš„ä»“åº“ï¼Œå¹¶ä¸”å¼•å…¥äº† <strong>çŠ¶æ€</strong> è¿™ä¸ªæ¦‚å¿µ</li><li>å®ƒçš„æ¨¡å‹å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œ <code>bus</code> æ¨¡å‹æ„Ÿè§‰åƒä¸€ä¸ªç”µè¯ä¸­è½¬ç«™<br><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9ddf76fc5b0fa?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="ä¸­è½¬ç«™"></li></ol><p>è€Œ vuex çš„æ¨¡å‹æ›´åƒæ˜¯é›†ä¸­å¼çš„ä»£ç ä»“åº“ã€‚</p><blockquote><p>ä¸ <code>git</code> ç±»ä¼¼ï¼Œå®ƒä¸èƒ½ç›´æ¥ä¿®æ”¹ä»£ç ï¼Œéœ€è¦å‚ä¸è€…æäº¤ <code>commit</code>ï¼Œæäº¤å®Œçš„ <code>commit</code>ä¿®æ”¹ä»“åº“ï¼Œä»“åº“æ›´æ–°ï¼Œå‚ä¸è€… <code>fetch</code> ä»£ç æ›´æ–°è‡ªå·±çš„ä»£ç ã€‚ä¸åŒçš„æ˜¯ä»£ç ä»“åº“éœ€è¦åˆå¹¶ï¼Œè€Œ <code>vuex</code> æ˜¯ç›´æ¥è¦†ç›–ä¹‹å‰çš„çŠ¶æ€ã€‚</p></blockquote><p><img src="https://user-gold-cdn.xitu.io/2020/1/10/16f8ede3d74ab245?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="state"></p><h3 id="ç®¡ç†-vuex"><a href="#ç®¡ç†-vuex" class="headerlink" title="ç®¡ç† vuex"></a>ç®¡ç† vuex</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><blockquote><p>â€œstoreâ€åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒåŒ…å«ç€ä½ çš„åº”ç”¨ä¸­å¤§éƒ¨åˆ†çš„çŠ¶æ€ (<code>state</code>)ã€‚Vuex å’Œå•çº¯çš„å…¨å±€å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ç‚¹ä¸åŒ</p></blockquote><ul><li><strong>å“åº”å¼</strong> ï¼ˆæ”¹å˜å±æ€§åï¼Œè§¦å‘ç»„ä»¶ä¸­çš„çŠ¶æ€æ”¹å˜ï¼Œè§¦å‘ <code>dom</code> ï¼‰</li><li><strong>ä¸èƒ½ç›´æ¥æ”¹å˜çŠ¶æ€</strong> ï¼ˆå”¯ä¸€é€”å¾„æ˜¯æäº¤ <code>mutation</code> )</li></ul><p><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9deb7be3845f5?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="store"></p><p><strong>åŸºæœ¬ç”¨æ³•</strong>ï¼šå°±æ˜¯åœ¨ <code>state</code> é‡Œé¢å®šä¹‰å„ç§å±æ€§ï¼Œé¡µé¢æˆ–ç»„ä»¶ç»„ä»¶ä¸­ï¼Œç›´æ¥ä½¿ç”¨ <code>$store.state</code>æˆ–è€… <code>$store.getters</code>æ¥ä½¿ç”¨ã€‚å¦‚æœæƒ³è¦æ”¹å˜çŠ¶æ€ <code>state</code>å‘¢ï¼Œå°± <code>commit</code> ä¸€ä¸ª <code>mutation</code></p><p>ä½†æ˜¯å‡å¦‚æˆ‘æƒ³æäº¤ä¸€è¿ä¸²åŠ¨ä½œå‘¢ï¼Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ª <code>action</code>ï¼Œç„¶åä½¿ç”¨ <code>$store.dispatch</code> æ‰§è¡Œè¿™ä¸ª <code>action</code></p><p>ä½¿ç”¨ <code>action</code> ä¸ä»…èƒ½çœç•¥ä¸å°‘ä»£ç ï¼Œè€Œä¸”å…³é”®æ˜¯ <code>action</code> ä¸­å¯ä»¥ä½¿ç”¨å¼‚æ­¥ç›¸å…³å‡½æ•°ï¼Œè¿˜å¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ª <code>promise</code></p><p>è€Œä¸ºä»€ä¹ˆä¸ç›´æ¥åˆ° <code>mutation</code>ä¸­å†™å¼‚æ­¥å‘¢ï¼Ÿ å› ä¸º <code>mutation</code> ä¸€å®šæ˜¯ä¸ªåŒæ­¥ï¼Œå®ƒæ˜¯å”¯ä¸€èƒ½æ”¹å˜ state çš„ï¼Œä¸€æ—¦æäº¤äº† <code>mutation</code>ï¼Œ <code>mutation</code> å¿…é¡»ç»™å®šä¸€ä¸ªæ˜ç¡®ç»“æœã€‚å¦åˆ™ä¼šé˜»å¡çŠ¶æ€çš„å˜åŒ–ã€‚</p><p>ä¸‹é¢ç»™å‡ºå¸¸ç”¨ vuex çš„ä½¿ç”¨æ–¹å¼</p><h4 id="æ–°å»º-Store"><a href="#æ–°å»º-Store" class="headerlink" title="æ–°å»º Store"></a>æ–°å»º Store</h4><p>æ–°å»ºä¸€ä¸ª <code>store</code>å¹¶å°†å…¶ä»–å„ä¸ªåŠŸèƒ½åŒ–åˆ†æ–‡ä»¶ç®¡ç†</p><pre><code class="js">import Vue from &#39;vue&#39;import Vuex from &#39;vuex&#39;import state from &#39;./states&#39;import getters from &#39;./getters&#39;import mutations from &#39;./mutations&#39;import actions from &#39;./actions&#39;import user from &#39;./modules/user&#39;Vue.use(Vuex)export default new Vuex.Store({      //åœ¨éç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œä½¿ç”¨ä¸¥æ ¼æ¨¡å¼      strict: process.env.NODE_ENV !== &#39;production&#39;,       state,      getters,      mutations,      actions,      modules: {            user      }})</code></pre><p><strong>æ“ä½œçŠ¶æ€ä¸¤ç§æ–¹å¼</strong></p><ol><li>è·å–çŠ¶æ€</li></ol><pre><code class="js">console.log(store.state.count)</code></pre><ol start="2"><li>æ”¹å˜çŠ¶æ€</li></ol><pre><code class="js">store.commit(&#39;xxx&#39;)</code></pre><h4 id="ç®¡ç†çŠ¶æ€-states"><a href="#ç®¡ç†çŠ¶æ€-states" class="headerlink" title="ç®¡ç†çŠ¶æ€ states"></a>ç®¡ç†çŠ¶æ€ states</h4><blockquote><p>å•ä¸€çŠ¶æ€æ ‘, è¿™ä¹Ÿæ„å‘³ç€ï¼Œæ¯ä¸ªåº”ç”¨å°†ä»…ä»…åŒ…å«ä¸€ä¸ª store å®ä¾‹ã€‚å•ä¸€çŠ¶æ€æ ‘è®©æˆ‘ä»¬èƒ½å¤Ÿç›´æ¥åœ°å®šä½ä»»ä¸€ç‰¹å®šçš„çŠ¶æ€ç‰‡æ®µï¼Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ä¹Ÿèƒ½è½»æ˜“åœ°å–å¾—æ•´ä¸ªå½“å‰åº”ç”¨çŠ¶æ€çš„å¿«ç…§ã€‚</p></blockquote><pre><code class="js">// states æ–‡ä»¶export default {      count: 0}</code></pre><p>è®¡ç®—å±æ€§ä¸­è¿”å›ï¼Œæ¯å½“ <code>state</code> ä¸­å±æ€§å˜åŒ–çš„æ—¶å€™, å…¶ä»–ç»„ä»¶éƒ½ä¼šé‡æ–°æ±‚å–è®¡ç®—å±æ€§ï¼Œå¹¶ä¸”è§¦å‘æ›´æ–°ç›¸å…³è”çš„ DOM</p><pre><code class="js">const Counter = {      template: &#39;&lt;div&gt;{{count}}&lt;div&gt;&#39;,      computed: {            count() {                  return store.state.count            }      }}</code></pre><h4 id="ç®¡ç†å–å€¼å™¨-getters"><a href="#ç®¡ç†å–å€¼å™¨-getters" class="headerlink" title="ç®¡ç†å–å€¼å™¨ getters"></a>ç®¡ç†å–å€¼å™¨ getters</h4><blockquote><p><code>getters</code> ç›¸å½“äº <code>store</code> çš„è®¡ç®—å±æ€§ã€‚ä¸éœ€è¦æ¯æ¬¡éƒ½è¦åœ¨è®¡ç®—å±æ€§ä¸­è¿‡æ»¤ä¸€ä¸‹ï¼Œä¹Ÿæ˜¯ä¸€ç§ä»£ç å¤ç”¨ã€‚ æˆ‘ä»¬åœ¨ <code>getters</code>æ–‡ä»¶ä¸­ç®¡ç†</p></blockquote><pre><code class="js">export default {      count: (state) =&gt; Math.floor(state.count)}</code></pre><h4 id="ç®¡ç†-mutations"><a href="#ç®¡ç†-mutations" class="headerlink" title="ç®¡ç† mutations"></a>ç®¡ç† mutations</h4><blockquote><p>æ›´æ”¹ Vuex çš„ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯æäº¤ mutationã€‚Vuex ä¸­çš„ mutation éå¸¸ç±»ä¼¼äºäº‹ä»¶ï¼šæ¯ä¸ª mutation éƒ½æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²çš„ äº‹ä»¶ç±»å‹ (type) å’Œ ä¸€ä¸ª å›è°ƒå‡½æ•° (handler)ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°å°±æ˜¯æˆ‘ä»¬å®é™…è¿›è¡ŒçŠ¶æ€æ›´æ”¹çš„åœ°æ–¹</p></blockquote><p>ä½¿ç”¨ types å¤§å†™ç”¨äºè°ƒè¯•ï¼Œåœ¨ <code>mutationTypes</code> æ–‡ä»¶ä¸­ <code>export const ROUTE_ADD = &#39;ROUTE_ADD&#39;</code></p><p>ç„¶ååœ¨ <code>mutations</code> æ–‡ä»¶ä¸­ç®¡ç†</p><pre><code class="js">import * as MutationTypes from &#39;./mutationTypes&#39;export default {      [MutationTypes.ADDONE]: function(state) {    state.count = state.count + 1      },      //...}</code></pre><pre><code class="js">this.$store.commit(MutationTypes.ADDONE)</code></pre><h4 id="ç®¡ç†-actions"><a href="#ç®¡ç†-actions" class="headerlink" title="ç®¡ç† actions"></a>ç®¡ç† actions</h4><p>å’Œ <code>mutations</code> ç±»ä¼¼ï¼Œ <code>actions</code> å¯¹åº”çš„æ˜¯ <code>dispatch</code>ï¼Œä¸åŒçš„æ˜¯ <code>action</code>å¯ä»¥ä½¿ç”¨å¼‚æ­¥å‡½æ•°ï¼Œæœ‰ç§æ›´é«˜ä¸€çº§çš„å°è£…ã€‚</p><pre><code class="js">// ç®€åŒ–actions: {    increment ({ commit }) {        setTimeout(() =&gt; {              commit(MutationTypes.ADDONE)    }    , 1000)    }}// è§¦å‘store.dispatch(&#39;increment&#39;)</code></pre><blockquote><p>ä¸Šè¿°ç”¨æ³•éƒ½å¯ä»¥ä½¿ç”¨ <strong>è½½è·</strong>çš„å½¢å¼ï¼Œå¼•å…¥ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>mapXxxx</code> è¿›è¡Œæ‰¹é‡å¼•å…¥ï¼Œè¿™é‡Œä¸è¯¦ç»†è®ºè¿°ï¼Œæœ‰å…´è¶£å¯ä»¥æŸ¥çœ‹å®˜ç½‘ã€‚</p></blockquote><h4 id="åˆ†æ¨¡å—ç®¡ç†çŠ¶æ€"><a href="#åˆ†æ¨¡å—ç®¡ç†çŠ¶æ€" class="headerlink" title="åˆ†æ¨¡å—ç®¡ç†çŠ¶æ€"></a>åˆ†æ¨¡å—ç®¡ç†çŠ¶æ€</h4><p>çŠ¶æ€å¤ªå¤šå¤ªæ‚ï¼Œåˆ†æ¨¡å—ç®¡ç†æ˜¯ä¸€ä¸ªè‰¯å¥½çš„ä»£ç ç»„ç»‡æ–¹å¼ã€‚</p><pre><code class="js">import count from &#39;./modules/count&#39;export default new Vuex.Store({      modules: {            count      }})</code></pre><p>æ¯ä¸€ä¸ªæ¨¡å—éƒ½å¯ä»¥æœ‰ç‹¬ç«‹çš„ç›¸å…³å±æ€§</p><pre><code class="js">import * as ActionTypes from &#39;./../actionTypes&#39;export default {      state: {            count: 0      },      mutations: {            ADD_ONE: function(state) {                   state.count = state.count + 1              }      },      actions: {            [ActionTypes.INIT_INTENT_ORDER]: function({ commit }) {                  commit(&#39;ADD_ONE&#39;)            }      },      getters: {            pageBackToLoan: (state) =&gt; Math.floor(state.count)      }}</code></pre><p><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9e11d627d9b4d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å¦‚å›¾æ‰€ç¤º"></p><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><p><code>vuex</code> ä¸»è¦æœ‰å‡ ä¸ªåº”ç”¨åœºæ™¯ï¼Œä¸€ä¸ªæ˜¯ç”¨äº <strong>ç»„ä»¶é€šä¿¡</strong>å’Œ <strong>çŠ¶æ€å…±äº«</strong>ï¼Œä¸€ä¸ªæ˜¯ç”¨äº <strong>æ•°æ®ç¼“å­˜</strong>ï¼Œè¿˜æœ‰å°±æ˜¯ç”¨äº <strong>å‡å°‘è¯·æ±‚</strong>ã€‚è¿™äº›åœºæ™¯å½’æ ¹èŠ‚ç‚¹éƒ½æ˜¯å¯¹äº <strong>ç¼“å­˜</strong>å’Œ <strong>å…±äº«</strong>æ¥è¯´çš„ã€‚</p><h4 id="ç»„ä»¶é€šä¿¡"><a href="#ç»„ä»¶é€šä¿¡" class="headerlink" title="ç»„ä»¶é€šä¿¡"></a>ç»„ä»¶é€šä¿¡</h4><p>é¦–å…ˆï¼ŒçŠ¶æ€ç»Ÿä¸€ç®¡ç†åœ¨ä»“åº“ï¼Œå°±å®ç°äº†ç»„ä»¶é€šä¿¡çš„å¯èƒ½æ€§ã€‚</p><p>å½“ä¸€ä¸ªç»„ä»¶é€šè¿‡ <code>commit</code> æäº¤ <code>mutation</code> å°±æ”¹äº† <code>state</code>ï¼Œå…¶ä»–ç»„ä»¶å°±å¯ä»¥é€šè¿‡ <code>store.state</code>è·å–æœ€æ–°çš„ <code>state</code>ï¼Œè¿™æ ·ä¸€æ¥å°±ç›¸å½“äº <strong>æ›´æ–°çš„å€¼é€šè¿‡ <code>store</code> ä¼ é€’ç»™äº†å…¶ä»–ç»„ä»¶</strong>ï¼Œä¸ä»…å®ç°äº†ä¸€å¯¹ä¸€çš„é€šä¿¡ï¼Œè¿˜å®ç°äº†ä¸€å¯¹å¤šçš„é€šä¿¡ã€‚</p><h4 id="çŠ¶æ€å…±äº«"><a href="#çŠ¶æ€å…±äº«" class="headerlink" title="çŠ¶æ€å…±äº«"></a>çŠ¶æ€å…±äº«</h4><p>æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„ä¸€ä¸ªåœºæ™¯å°±æ˜¯ <strong>æƒé™ç®¡ç†</strong>ã€‚</p><p>å†™æƒé™ç®¡ç†æ—¶å€™ï¼Œé¦–æ¬¡è¿›å…¥é¡µé¢å°±è¦å°†æƒé™å…¨éƒ¨æ‹¿åˆ°ï¼Œç„¶åéœ€è¦åˆ†å‘ç»™å„ä¸ªé¡µé¢ä½¿ç”¨ï¼Œæ¥æ§åˆ¶å„ä¸ªè·¯ç”±ã€æŒ‰é’®çš„æƒé™ã€‚</p><pre><code class="js">/** *  * åˆ¤æ–­ç”¨æˆ·æœ‰æ²¡æœ‰æƒé™è®¿é—®é¡µé¢  */function hasPermission(routeItem, menus) {    return menus.some(menuItem =&gt; {        return menuItem.name === routeItem.name    })}/** *  * é€’å½’è¿‡æ»¤å¼‚æ­¥è·¯ç”±è¡¨ï¼Œè¿”å›ç¬¦åˆç”¨æˆ·è§’è‰²æƒé™çš„è·¯ç”±è¡¨ *  * @param {*} routes è·¯ç”±è¡¨ *  * @param {*} menus èœå•ä¿¡æ¯  * */function filterRoutes(routes, menus) {    return routes.filter(routeItem =&gt; {        if (routeItem.hidden) {            return true        } else if (hasPermission(routeItem, menus)) {            const menuItem = menus.find(item =&gt; item.name === routeItem.name)            if (menuItem &amp;&amp; menuItem.children &amp;&amp; menuItem.children.length &gt; 0) {                routeItem.children = filterRoutes(routeItem.children, menuItem.children)                if (!routeItem.children.length) return false              }              return true            } else {                return false              }        })  }  const permission = {      state: {          routers: constantRouterMap,          addRouters: [],          roles: [],          user_name: &#39;&#39;,          avatar_url: &#39;&#39;,          onlyEditor: false,          menus: null,          personal: true,          teamList: []      },      mutations: {}  }  export default permission</code></pre><p>è€Œä¸”æƒé™è¿˜å¯ä»¥è¢«æ›´æ”¹ï¼Œæ›´æ”¹åçš„æƒé™ç›´æ¥åˆ†å‘åˆ°å…¶ä»–é¡µé¢ç»„ä»¶ä¸­ã€‚è¿™ä¸ªåœºæ™¯è¦æ˜¯ä¸ä½¿ç”¨ <code>vuex</code> ï¼Œä»£ç å°†ä¼šæ¯”è¾ƒå¤æ‚ã€‚</p><h4 id="æ•°æ®ç¼“å­˜"><a href="#æ•°æ®ç¼“å­˜" class="headerlink" title="æ•°æ®ç¼“å­˜"></a>æ•°æ®ç¼“å­˜</h4><p><code>store</code> æ˜¯ä¸€ä¸ªä»“åº“ï¼Œå®ƒä»åˆ›å»ºå¼€å§‹å°±ä¸€ç›´å­˜åœ¨ï¼Œåªæœ‰é¡µé¢ <code>Vuex.store</code> å®ä¾‹è¢«é”€æ¯ï¼Œstate æ‰ä¼šè¢«æ¸…ç©ºã€‚å…·ä½“è¡¨ç°å°±æ˜¯åˆ·æ–°é¡µé¢ã€‚</p><p>è¿™ä¸ªæ•°æ®ç¼“å­˜é€‚ç”¨äºï¼šé¡µé¢åŠ è½½åç¼“å­˜æ•°æ®ï¼Œåˆ·æ–°é¡µé¢è¯·æ±‚æ•°æ®çš„åœºæ™¯ã€‚åœ¨ä¸€èˆ¬ <code>Hybrid</code>ä¸­ï¼Œä¸€èˆ¬ä¸å­˜åœ¨åˆ·æ–°é¡µé¢è¿™ä¸ªæŒ‰é’®ï¼Œæ‰€ä»¥ä½¿ç”¨ vuex ç¼“å­˜æ•°æ®å¯ä»¥åº”å¯¹å¤§å¤šæ•°åœºæ™¯ã€‚</p><pre><code class="js">export default {      state: {            // ç¼“å­˜ä¿®æ”¹æ‰‹æœºå·éœ€è¦çš„ä¿¡æ¯            changePhoneInfo: {                  nameUser: &#39;&#39;,                  email: &#39;&#39;,                  phone: &#39;&#39;            },      }}</code></pre><p>å¦‚æœéœ€è¦æŒä¹…åŒ–ç¼“å­˜ï¼Œç»“åˆæµè§ˆå™¨æˆ– APP ç¼“å­˜æ›´ä½³ã€‚</p><pre><code class="js">export default {      // ç™»é™†æˆåŠŸåï¼Œvuex å†™å…¥tokenï¼Œå¹¶å†™å…¥appç¼“å­˜ï¼Œå­˜å‚¨æŒä¹…åŒ–      [ActionTypes.LOGIN_SUCCESS]: function(store, token) {            store.commit(MutationTypes.SET_TOKEN, token)            setStorage(&#39;token&#39;, token)            router.replace({ name: &#39;Home&#39;, params: { source: &#39;login&#39; } })      }}</code></pre><h4 id="å‡å°‘è¯·æ±‚-æ•°æ®ç¼“å­˜çš„å˜ç§"><a href="#å‡å°‘è¯·æ±‚-æ•°æ®ç¼“å­˜çš„å˜ç§" class="headerlink" title="å‡å°‘è¯·æ±‚(æ•°æ®ç¼“å­˜çš„å˜ç§)"></a>å‡å°‘è¯·æ±‚(æ•°æ®ç¼“å­˜çš„å˜ç§)</h4><p>åœ¨å†™åå°ç®¡ç†å¹³å°æ—¶å€™ï¼Œç»å¸¸ä¼šæœ‰ <code>list</code> é€‰å‹ç»„ä»¶ï¼Œé‡Œé¢æ•°æ®ä»æœåŠ¡ç«¯æ‹¿çš„æ•°æ®ã€‚å¦‚æœæˆ‘ä»¬æŠŠè¿™ä¸ª <code>list</code> æ•°æ®å­˜å‚¨èµ·æ¥ï¼Œä¸‹æ¬¡å†æ¬¡ä½¿ç”¨ï¼Œç›´æ¥ä» <code>store</code> é‡Œé¢æ‹¿ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨å†å»è¯·æ±‚æ•°æ®äº†ã€‚ç›¸å½“äºå‡å°‘äº†ä¸€æ¬¡è¯·æ±‚ã€‚</p><h2 id="å¦‚ä½•ä½¿ç”¨è¿‡æ»¤å™¨ï¼Œç¼–å†™è‡ªå·±çš„è¿‡æ»¤å™¨"><a href="#å¦‚ä½•ä½¿ç”¨è¿‡æ»¤å™¨ï¼Œç¼–å†™è‡ªå·±çš„è¿‡æ»¤å™¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨è¿‡æ»¤å™¨ï¼Œç¼–å†™è‡ªå·±çš„è¿‡æ»¤å™¨"></a>å¦‚ä½•ä½¿ç”¨è¿‡æ»¤å™¨ï¼Œç¼–å†™è‡ªå·±çš„è¿‡æ»¤å™¨</h2><h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>å‡è®¾æˆ‘ç°åœ¨æœ‰ä¸ªéœ€æ±‚ï¼Œéœ€è¦å°†æ€§åˆ«0ã€1ã€2ï¼Œåˆ†åˆ«è½¬æ¢æˆç”·ã€å¥³ã€ä¸ç¡®å®šè¿™ä¸‰ä¸ªæ±‰å­—å±•ç¤ºã€‚é¡µé¢ä¸­å¤šå¤„åœ°æ–¹éœ€è¦ä½¿ç”¨ã€‚</p><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;  .user-info    .gender        label(for=&quot;æ€§åˆ«&quot;) æ€§åˆ«        span {{gender}}&lt;/template&gt;</code></pre><p>å®Œæˆè¿™ä¸ªéœ€æ±‚ï¼Œæˆ‘ä»¬çŸ¥é“æœ‰ <strong>4</strong> ç§æ–¹å¼ï¼š</p><ol><li>ä½¿ç”¨ computed æ–¹æ³•</li><li>ä½¿ç”¨ methods æ–¹æ³•</li><li>ä½¿ç”¨ utils å·¥å…·ç±»</li><li>ä½¿ç”¨ filters</li></ol><p><strong>åº”è¯¥é€‰æ‹©å“ªç§æ–¹å¼å‘¢ï¼Ÿ</strong></p><p>æˆ‘ä»ä¸‹é¢ä¸‰ä¸ªæ–¹é¢æ¥è®ºè¿°è¿™ä¸ªé—®é¢˜</p><p><strong>1. å¯å®ç°æ€§</strong></p><ul><li>ä½¿ç”¨ <code>computed</code> å®ç°æˆåŠŸï¼Œæˆ‘ä»¬çŸ¥é“ <code>computed</code> ä¸æ˜¯ä¸€ä¸ªå‡½æ•°æ˜¯æ— æ³•ä¼ å‚çš„ï¼Œè¿™é‡Œæœ‰ä¸ªæŠ€å·§ï¼Œ <code>return</code> ä¸€ä¸ªå‡½æ•°æ¥å—ä¼ è¿‡æ¥çš„å‚æ•°</li></ul><pre><code class="js">    // ...      computed: {          convertIdToName() {              return function(value) {                  const item = list.find(function(item) {                        return item.id === value                    })                    return item.name                }            }      }</code></pre><p><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9eb7a20ecdcdf?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å¦‚å›¾æ‰€ç¤º"></p><ul><li>ä½¿ç”¨ <code>methods</code> å®ç°æˆåŠŸï¼Œè¿™é‡Œç›´æ¥å¯ä»¥ä¼ å‚æ•°ï¼Œä¸€ç§å¸¸è§„çš„å†™æ³•ã€‚</li></ul><blockquote><p>æ³¨æ„ <code>methods</code>ã€ <code>computed</code>å’Œ <code>data</code> ç›¸äº’ä¹‹å‰æ˜¯ä¸èƒ½åŒåçš„</p></blockquote><pre><code class="js">  // ...    methods: {        convertIdToName(value) {            const item = list.find(function(item) {                return item.id === value            })            return item.name        }    }</code></pre><ul><li>ä½¿ç”¨ <code>utils</code> å’Œ <code>methods</code> å·®ä¸å¤šåŸºæœ¬ä¸Šä¹Ÿå¯ä»¥å®ç°</li><li>ä½¿ç”¨ <code>filter</code> ä¹Ÿæ˜¯å®ç°çš„ï¼Œæœ‰ä¸ªå¯ä»¥å’Œ <code>methods</code> ã€ <code>computed</code> åŒåå“¦</li></ul><pre><code class="js">    filters: {          console.log(this.render)          convertIdToName(value) {              const item = list.find(function(item) {                  return item.id === value              })              return item.name          }      },</code></pre><p><strong>æ€»çš„æ¥è¯´ä»–ä»¬å…¨éƒ¨éƒ½å¯ä»¥å®ç°è¿™ä¸ªéœ€æ±‚</strong></p><p><strong>2. å±€é™æ€§</strong></p><ul><li><code>computed</code> ã€ <code>methods</code> å’Œ <code>data</code> ä¸‰è€…äº’ä¸åŒåï¼Œä»–ä»¬æ²¡åŠæ³•è¢«å…¶ä»–ç»„ä»¶ä½¿ç”¨ï¼Œé™¤éé€šè¿‡ <code>mixins</code></li><li><code>filters</code> ä¸ <code>utils</code> æ— æ³•è®¿é—® <code>this</code> ï¼Œä¹Ÿå°±æ˜¯äºå“åº”å¼ç»ç¼˜ã€‚ä½†æ˜¯é€šè¿‡å®šä¹‰å…¨å±€ <code>filters</code> ï¼Œå¯ä»¥å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼Œå¦å¤–è¿˜å¯ä»¥ç›´æ¥åŠ è½½ç¬¬ä¸‰æ–¹ <code>filter</code> å’Œ <code>utils</code></li></ul><p><strong>3. æ€»ç»“æ¯”è¾ƒ</strong></p><p><code>filters</code> ä¸ <code>utils</code> å½’å±ä¸€å¯¹ï¼Œä»–ä»¬æ—¢æ˜¯è„±ç¦»äº† <code>this</code>ï¼Œè·å¾—äº†è‡ªç”±ï¼Œåˆæ˜¯è¢« <code>this</code> å¼ƒä¹‹é—¨å¤–ã€‚ç›¸å <code>methods</code> ä¸ <code>computed</code> ä¸ <code>this</code> ç´§ç´§ç«™åœ¨ä¸€èµ·ï¼Œä½†åˆæ˜¯æ— æ³•è·å¾—è‡ªç”±ã€‚</p><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><h4 id="ç¼–å†™ä¸€ä¸ªç®€å•çš„åƒåˆ†ä½è¿‡æ»¤å™¨"><a href="#ç¼–å†™ä¸€ä¸ªç®€å•çš„åƒåˆ†ä½è¿‡æ»¤å™¨" class="headerlink" title="ç¼–å†™ä¸€ä¸ªç®€å•çš„åƒåˆ†ä½è¿‡æ»¤å™¨"></a>ç¼–å†™ä¸€ä¸ªç®€å•çš„åƒåˆ†ä½è¿‡æ»¤å™¨</h4><pre><code class="js">export const thousandBitSeparator = (value) =&gt; {    return   value &amp;&amp; (value.toString().indexOf(&#39;.&#39;) !== -1 ? value.toString().replace(/(\d)(?=(\d{3})+\.)/g, function($0, $1) {          return $1 + &#39;,&#39;;      }) :   value.toString().replace(/(\d)(?=(\d{3})+$)/g, function($0, $1) {          return $1 + &#39;,&#39;;      })  );}</code></pre><h4 id="ä½¿ç”¨-vue-filter-æ’ä»¶"><a href="#ä½¿ç”¨-vue-filter-æ’ä»¶" class="headerlink" title="ä½¿ç”¨ vue-filter æ’ä»¶"></a>ä½¿ç”¨ vue-filter æ’ä»¶</h4><p>ä¸¤æ¬¾æ’ä»¶</p><p><a href="https://www.npmjs.com/package/vue-filter" target="_blank" rel="noopener">vue-filter</a> ä½¿ç”¨ <code>use</code> å¼•å…¥</p><p><a href="https://www.npmjs.com/package/vue-filters" target="_blank" rel="noopener">vue2-filters</a> ä½¿ç”¨ <code>mixins</code> å¼•å…¥</p><blockquote><p>æœ‰éœ€è¦çš„è¯ï¼Œæˆ‘ä¸€èˆ¬å°±ç”¨ç¬¬äºŒä¸ªäº†ï¼Œå¤§å¤šæ•°éƒ½æ˜¯è‡ªå·±å†™ä¸€ä¸‹å°è¿‡æ»¤å™¨</p></blockquote><p>è‡ªå®šä¹‰è¿‡æ»¤å™¨ä¹‹åï¼Œç›´æ¥å…¨å±€è‡ªåŠ¨æ³¨å†Œï¼Œå…¶ä»–åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨</p><h4 id="æ³¨å†Œå…¨å±€è¿‡æ»¤å™¨"><a href="#æ³¨å†Œå…¨å±€è¿‡æ»¤å™¨" class="headerlink" title="æ³¨å†Œå…¨å±€è¿‡æ»¤å™¨"></a>æ³¨å†Œå…¨å±€è¿‡æ»¤å™¨</h4><p>éå†è¿‡æ»¤å±æ€§å€¼ï¼Œä¸€æ¬¡æ€§å…¨éƒ¨æ³¨å†Œ</p><pre><code class="js">for (const key in filters) {      Vue.filter(key, filters[key])}</code></pre><h2 id="å¦‚ä½•ä½¿ç”¨-Jest-æµ‹è¯•ä½ çš„ä»£ç "><a href="#å¦‚ä½•ä½¿ç”¨-Jest-æµ‹è¯•ä½ çš„ä»£ç " class="headerlink" title="å¦‚ä½•ä½¿ç”¨ Jest æµ‹è¯•ä½ çš„ä»£ç "></a>å¦‚ä½•ä½¿ç”¨ Jest æµ‹è¯•ä½ çš„ä»£ç </h2><h3 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>æˆ‘ä»¬æ€è€ƒä¸€ä¸‹æµ‹è¯• js ä»£ç éœ€è¦å“ªäº›ä¸œè¥¿</p><ol><li>æµè§ˆå™¨è¿è¡Œç¯å¢ƒ</li><li>æ–­è¨€åº“</li></ol><p>å¦‚æœæ˜¯æµ‹è¯• vue ä»£ç å‘¢ï¼Ÿ é‚£å¾—å†åŠ ä¸€ä¸ª vue æµ‹è¯•å®¹å™¨</p><h3 id="Jest-Vue"><a href="#Jest-Vue" class="headerlink" title="Jest + Vue"></a>Jest + Vue</h3><h4 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h4><pre><code class="json">{      &quot;@vue/cli-plugin-unit-jest&quot;: &quot;^4.0.5&quot;,      &quot;@vue/test-utils&quot;: &quot;1.0.0-beta.29&quot;,      &quot;jest&quot;: &quot;^24.9.0&quot;,      // ...}</code></pre><h3 id="é¡¹ç›®é…ç½®"><a href="#é¡¹ç›®é…ç½®" class="headerlink" title="é¡¹ç›®é…ç½®"></a>é¡¹ç›®é…ç½®</h3><pre><code class="js">// For a detailed explanation regarding each configuration property, visit:// https://jestjs.io/docs/en/configuration.htmlmodule.exports = {    preset: &#39;@vue/cli-plugin-unit-jest&#39;,    automock: false, &quot;/private/var/folders/10/bb2hb93j34999j9cqr587ts80000gn/T/jest_dx&quot;,    clearMocks: true,    // collectCoverageFrom: null,    coverageDirectory: &#39;tests/coverage&#39;    //...}</code></pre><h3 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h3><h4 id="æµ‹è¯•-utils-å·¥å…·ç±»"><a href="#æµ‹è¯•-utils-å·¥å…·ç±»" class="headerlink" title="æµ‹è¯• utils å·¥å…·ç±»"></a>æµ‹è¯• utils å·¥å…·ç±»</h4><blockquote><p>å¯¹æˆ‘ä»¬ä¹‹å‰å†™çš„ä¸€ä¸ªæ€§åˆ«åç§°è½¬æ¢å·¥å…·è¿›è¡Œæµ‹è¯•</p></blockquote><pre><code class="js">import { convertIdToName } from &#39;./convertIdToName&#39;describe(&#39;æµ‹è¯•convertIdToNameæ–¹æ³•&#39;, () =&gt; {    const list = [        { id: 0, name: &#39;ç”·&#39; },        { id: 1, name: &#39;å¥³&#39; },        { id: 2, name: &#39;æœªçŸ¥&#39; }    ]    it(&#39;æµ‹è¯•æ­£å¸¸è¾“å…¥&#39;, () =&gt; {        const usage = list        usage.forEach((item) =&gt; {            expect(convertIdToName(item.id, list)).toBe(item.name)        })  })    it(&#39;æµ‹è¯•éæ­£å¸¸è¾“å…¥&#39;, () =&gt; {        const usage = [&#39;a&#39;, null, undefined, NaN]        usage.forEach((item) =&gt; {            expect(convertIdToName(item, list)).toBe(&#39;&#39;)        })    })})</code></pre><p><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9eda87016bfe2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å¦‚å›¾æ‰€ç¤º"><br>è¿™æ ·ä¸€æµ‹è¯•ï¼Œå‘ç°åŸæ¥æˆ‘ä»¬ä¹‹å‰å†™çš„å·¥å…·æœ‰è¿™ä¹ˆå¤šæ¼æ´ æµ‹è¯•æ­£å¸¸è¾“å…¥å…¨éƒ¨é€šè¿‡äº†ï¼Œéæ­£å¸¸è¾“å…¥å¤±è´¥äº†ï¼Œæ ¹æ®æµ‹è¯•ç”¨ä¾‹æ”¹è¿›æˆ‘ä»¬çš„ä»£ç </p><pre><code class="js">export const convertIdToName = (value, list) =&gt; {    if (value !== 0 &amp;&amp; value !== 1 &amp;&amp; value !== 2) return &#39;&#39;    const item = list.find(function(item) {        return item.id === value    })   return item.name}</code></pre><p>ç°åœ¨æµ‹è¯•éƒ½é€šè¿‡äº†å‘¢</p><h4 id="æµ‹è¯•-components-å•æ–‡ä»¶ç»„ä»¶"><a href="#æµ‹è¯•-components-å•æ–‡ä»¶ç»„ä»¶" class="headerlink" title="æµ‹è¯• components å•æ–‡ä»¶ç»„ä»¶"></a>æµ‹è¯• components å•æ–‡ä»¶ç»„ä»¶</h4><blockquote><p>å¯¹æˆ‘ä»¬æœ€ç®€å•çš„ <code>hello world</code> è¿›è¡Œæµ‹è¯•</p></blockquote><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;  .hello    h1 {{ msg }}&lt;/template&gt;&lt;script&gt;export default {    props: {        msg: String    }}&lt;/script&gt;</code></pre><pre><code class="js">import { shallowMount } from &#39;@vue/test-utils&#39;import HelloWorld from &#39;@/components/HelloWorld.vue&#39;describe(&#39;HelloWorld.vue&#39;, () =&gt; {    it(&#39;renders props.msg when passed&#39;, () =&gt; {        const msg = &#39;new message&#39;        const wrapper = shallowMount(HelloWorld, {            propsData: { msg }        })        expect(wrapper.text()).toMatch(msg)    })})</code></pre><h4 id="æµ‹è¯•-api-è¯·æ±‚"><a href="#æµ‹è¯•-api-è¯·æ±‚" class="headerlink" title="æµ‹è¯• api è¯·æ±‚"></a>æµ‹è¯• api è¯·æ±‚</h4><p>å¼‚æ­¥æµ‹è¯•æœ‰å‡ ç§å¸¸è§å†™æ³•</p><ul><li><code>async</code> ä¸ <code>await</code></li><li><code>done()</code></li></ul><blockquote><p>ç®€å•çš„å¼‚æ­¥æµ‹è¯•ï¼Œæµ‹è¯•ä¸€ä¸ªç®€å•çš„ç™»é™†è¯·æ±‚</p></blockquote><pre><code class="js">export const login = (data) =&gt; post(&#39;/user/login&#39;, data)</code></pre><p>æµ‹è¯•ä»£ç </p><pre><code class="js">import { login } from &#39;@/api/index&#39;describe(&#39;login api&#39;, () =&gt; {    const response = {        code: &#39;1000&#39;,        data: {}    }    const errorResponse = {        code: &#39;5000&#39;,        data: {},       message: &#39;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#39;    }    it(&#39;æµ‹è¯•æ­£å¸¸ç™»é™†&#39;, async () =&gt; {        const params = {            user: &#39;admin&#39;,            password: &#39;123456&#39;        }        expect(await login(params)).toEqual(response)    })    it(&#39;æµ‹è¯•å¼‚å¸¸ç™»é™†&#39;, async () =&gt; {        const params = {            user: &#39;admin&#39;,           password: &#39;123123&#39;        }        expect(await login(params)).toEqual(errorResponse)    })})</code></pre><p><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9efc734a64747?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å¦‚å›¾æ‰€ç¤º"></p><h3 id="åŠŸèƒ½æ¨¡å—æµ‹è¯•"><a href="#åŠŸèƒ½æ¨¡å—æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æ¨¡å—æµ‹è¯•"></a>åŠŸèƒ½æ¨¡å—æµ‹è¯•</h3><p>ç»„ä»¶ï¼Œ <code>api</code>ï¼Œå·¥å…·è¿™äº›é›¶é›¶ç¢ç¢éƒ½æµ‹è¯•äº†ï¼Œè€Œä¸”è¿™äº›éƒ½æ˜¯æ¯”è¾ƒé€šç”¨ã€å’Œä¸šåŠ¡å…³ç³»ä¸å¤§çš„ä»£ç ï¼Œå®ƒä»¬æ”¹åŠ¨è¾ƒå°‘ï¼Œæµ‹è¯•åˆ°è¿™é‡Œå…¶å®å·²ç»è¶³å¤Ÿäº†ï¼Œå·²ç»è¾¾åˆ°äº† <code>20%</code> çš„æµ‹è¯•å·¥ä½œé‡äº†å¾ˆå¤§ä¸€éƒ¨åˆ†ä»£ç çš„ç›®çš„ã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆæˆ‘è¯´åªæœ‰ 20% çš„å·¥ä½œé‡å‘¢ï¼Ÿå› ä¸ºè¿™äº›éƒ½æ˜¯ä¸æ€ä¹ˆå˜åŒ–çš„é€»è¾‘ï¼Œæ˜¯ä¸€åŠ³æ°¸é€¸çš„äº‹æƒ…ã€‚é•¿è¿œæ¥è¯´å ç”¨çš„å·¥ä½œé‡ç¡®å®å¾ˆå°‘ã€‚</p></blockquote><p>ä½†æ˜¯æœ‰äº›æƒ…å†µä¸šåŠ¡è¿˜æ˜¯å¿…é¡»å¾—æµ‹ï¼Œä¹Ÿå°±æ˜¯å¿…é¡»è¦åŠŸèƒ½æ¨¡å—é›†æˆæµ‹è¯•ã€‚</p><p>ç»å¸¸å¾—å›å½’çš„ä¸šåŠ¡ï¼Œé‚£ç§è¿­ä»£å¯¹åŸæœ‰çš„ç³»ç»Ÿæ¯”è¾ƒå¤§ï¼Œé¿å…æ”¹åŠ¨ä¹‹åä½¿æ—§çš„ä»£ç å„ç§æ–°çš„é—®é¢˜ã€‚è¿™ç§ç»å¸¸å›å½’æµ‹è¯•ï¼Œé‡‡ç”¨ <code>BDD</code> + é›†æˆæµ‹è¯•ï¼Œæ¯”ä¸åœæ”¹ <code>bug</code> è¦è½»æ¾çš„å¤šã€‚</p><h3 id="å¿«ç…§æµ‹è¯•"><a href="#å¿«ç…§æµ‹è¯•" class="headerlink" title="å¿«ç…§æµ‹è¯•"></a>å¿«ç…§æµ‹è¯•</h3><p>åƒç‰ˆæœ¬ä¸€æ ·ï¼Œæ¯æ¬¡æµ‹è¯•ä¹‹åç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬ï¼Œæ¯”è¾ƒä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„åŒºåˆ«ã€‚ è¿™æ˜¯ä¸€ç§ç²’åº¦åŠå…¶å°çš„æµ‹è¯•ï¼Œå¯ä»¥æµ‹è¯•åˆ°æ¯ä¸€ä¸ªç¬¦å·ã€‚</p><h4 id="æ¯”å¦‚æˆ‘ç”¨å®ƒæ¥æµ‹è¯•ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„å˜åŠ¨"><a href="#æ¯”å¦‚æˆ‘ç”¨å®ƒæ¥æµ‹è¯•ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„å˜åŠ¨" class="headerlink" title="æ¯”å¦‚æˆ‘ç”¨å®ƒæ¥æµ‹è¯•ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„å˜åŠ¨"></a>æ¯”å¦‚æˆ‘ç”¨å®ƒæ¥æµ‹è¯•ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„å˜åŠ¨</h4><p>è¿™æ˜¯æˆ‘ä»¬ä¸€ä¸ªé…ç½®æ–‡ä»¶</p><pre><code class="js">export const api = {    develop: &#39;http://xxxx:8080&#39;,    mock: &#39;http://xxxx&#39;,    feature: &#39;http://xxxx&#39;,    test: &#39;http://xxxx&#39;,    production: &#39;http://xxxx&#39;}export default api[process.env.NODE_ENV || &#39;dev&#39;]</code></pre><p>ä½¿ç”¨å¿«ç…§æµ‹è¯•</p><pre><code class="js">import { api } from &#39;./config&#39;describe(&#39;é…ç½®æ–‡ä»¶æµ‹è¯•&#39;, () =&gt; {    it(&#39;æµ‹è¯•é…ç½®æ–‡ä»¶æ˜¯å¦å˜åŠ¨&#39;, () =&gt; {        expect(api).toMatchSnapshot({            develop: &#39;http://xxxx:8080&#39;,            mock: &#39;http://xxxx&#39;,             feature: &#39;http://xxxx&#39;,             test: &#39;http://xxxx&#39;,             production: &#39;http://xxxx&#39;          })    })})</code></pre><p>ä½¿ç”¨å¿«ç…§ç¬¬ä¸€æ¬¡æµ‹è¯•åï¼Œé€šè¿‡æµ‹è¯•ï¼Œä»£ç è¢«å†™å…¥å¿«ç…§<br><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9f1b5e3b2e64f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å¿«ç…§æµ‹è¯•1"><br><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9f1d9415200e8?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å¿«ç…§æµ‹è¯•2"><br>æ”¹åŠ¨é…ç½®å†æ¬¡æµ‹è¯•ï¼Œæœªé€šè¿‡æµ‹è¯• è¿™æ—¶å¦‚æœè¦æ”¹å˜é…ç½®æ€ä¹ˆåŠå‘¢ï¼Ÿ åªéœ€åŒæ—¶æ”¹ä¸€ä¸‹ç”¨ä¾‹å°±å¥½äº†ã€‚å¿«ç…§å°†å†æ¬¡å†™å…¥å¿«ç…§ç”Ÿæˆç‰ˆæœ¬2ï¼Œè¿™æ ·é…ç½®æ”¹åŠ¨ä¹Ÿæœ‰æ ¹æ®äº†<br><img src="https://user-gold-cdn.xitu.io/2020/1/13/16f9f1eeb7396fdc?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å¿«ç…§æµ‹è¯•3"></p><h3 id="TDD-ä¸-BDD"><a href="#TDD-ä¸-BDD" class="headerlink" title="TDD ä¸ BDD"></a>TDD ä¸ BDD</h3><p>æœ€è¿‘è®¨è®ºæ¯”è¾ƒå¤šçš„ç®—æ˜¯ <strong>æµ‹è¯•é©±åŠ¨å¼€å‘</strong>å’Œ <strong>è¡Œä¸ºé©±åŠ¨å¼€å‘</strong>ï¼Œå…¶å®æ€»å¾—æ¥è¯´æ˜¯ 4 ç§</p><ol><li>ä¸å†™æµ‹è¯•ã€‚å¥½å¤„æ˜¯çœæ—¶é—´ï¼Œåå¤„å½“ç„¶å°± <code>bug</code> å¤šï¼Œä»£ç è´¨é‡ä½ã€‚</li><li>å…ˆå†™æµ‹è¯•å’Œæµ‹è¯•ç”¨ä¾‹ï¼Œå†å†™ä»£ç ï¼Œä¹Ÿå°±æ˜¯æµ‹è¯•é©±åŠ¨å¼€å‘ã€‚è¿™æ ·å¥½å¤„æ˜¯ä»£ç æ¯”è¾ƒå¥å…¨ï¼Œè€ƒè™‘çš„å› ç´ æ¯”è¾ƒå¤šã€‚å›ºå®šæ¨¡å—å¥å£®æ€§é«˜ï¼Œbugå°‘ã€‚</li><li>å…ˆå†™ä»£ç ï¼Œå†é€šè¿‡æ¨¡æ‹Ÿç”¨æˆ·çš„è¡Œä¸ºå†™æµ‹è¯•ã€‚å¥½å¤„æ˜¯æ€è·¯æ¸…æ™°ï¼Œå¦‚æœæµ‹è¯•ç”¨ä¾‹å¤Ÿå…¨é¢ï¼ŒåŸºæœ¬ä¸Šçº¿åŸºæœ¬æ²¡å¤ªå¤§é—®é¢˜ï¼Œå›å½’æµ‹è¯•ä¹Ÿå¾ˆå¥½åšã€‚</li><li>å†™ä»£ç ä¹‹å‰å†™æµ‹è¯•å’Œç”¨ä¾‹ï¼Œå†™å®Œä»£ç ä¹‹åå†å†™ç”¨æˆ·è¡Œä¸ºæµ‹è¯•ã€‚è¿™ç§ä»£ç è´¨é‡å°±å¤ªé«˜äº†ï¼Œå½“ç„¶ç¼ºç‚¹å°±æ˜¯è´¹æ—¶é—´ã€‚</li></ol><blockquote><p>é‚£ä¹ˆä½ æ˜¯å“ªä¸€ç§ï¼Ÿ åæ­£æˆ‘æ¯”è¾ƒä½›ç³»å“ˆï¼Œæœ‰çš„ä¸å†™æµ‹è¯•ï¼Œä¹Ÿæœ‰çš„å†™æ»¡æµ‹è¯•ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åƒé€Vueé¡¹ç›®å¼€å‘å®è·µ(ä¸Š)</title>
      <link href="/2020/05/06/Vue/%E5%90%83%E9%80%8FVue%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5-%E4%B8%8A/"/>
      <url>/2020/05/06/Vue/%E5%90%83%E9%80%8FVue%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5-%E4%B8%8A/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5e0202fc6fb9a0165721e39a" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><p><img src="https://user-gold-cdn.xitu.io/2019/12/30/16f5676f7940d72a?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æ¦‚è§ˆ"></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><blockquote><p>æˆ‘å°†ä» 16 ä¸ªæ–¹é¢æ¥è®ºè¿° vue å¼€å‘è¿‡ç¨‹ä¸­çš„ä¸€äº›æŠ€å·§å’ŒåŸç†ã€‚å½“ç„¶ç”±äºç¯‡å¹…æœ‰é™ï¼Œå…ˆè®ºè¿°å‰ 8 ä¸ªé—®é¢˜ï¼Œä¸‹èŠ‚å°†å®Œæˆå…¨ç³»åˆ—å†…å®¹ã€‚</p></blockquote><p>æœ¬ç¯‡æ–‡ç« å°†å›´ç»•ä¸‹åˆ—é—®é¢˜è¿›è¡Œè®ºè¿°ï¼š</p><ul><li><strong>å¦‚ä½•è§„èŒƒä½ çš„ git æäº¤ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå¹¶æäº¤æ—¥å¿—ï¼Ÿ</strong></li><li><strong>å¦‚ä½•é…ç½®å’Œä½¿ç”¨ Sass å’Œ PUG æå‡ä½ çš„ç¼–ç æ•ˆç‡ï¼Ÿ</strong></li><li><strong>å¦‚ä½•å¤„ç†ä½ çš„ä»£ç é£æ ¼é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ perttier ä¸ eslint è§£å†³æ•ˆç‡é£æ ¼ä¸¤éš¾é—®é¢˜ï¼Ÿ</strong></li><li><strong>å¦‚ä½•ç®¡ç†é¡µé¢çš„è·¯ç”±ï¼Œå¦‚ä½•ç¼–å†™å¼‚æ­¥è·¯ç”±ï¼Ÿ</strong></li><li><strong>å¦‚ä½•ç¼–å†™ç»„ä»¶ï¼Œå¼•å…¥ç»„ä»¶åº“ï¼Ÿ</strong></li><li><strong>å¦‚ä½•ç®¡ç†ä½ çš„èµ„æºï¼Œå¦‚ä½•å¼•å…¥å›¾æ ‡ï¼Œæ ·å¼ï¼Ÿ</strong></li><li><strong>å¦‚ä½•å°è£…ä½ çš„ axiosï¼Œç®¡ç†ä½ çš„apiï¼Ÿ</strong></li><li><strong>å¦‚ä½•ä½¿ç”¨ mock æ¨¡æ‹Ÿä½ çš„æ•°æ®ï¼Œå®ç°çœŸæ­£æ„ä¹‰çš„å‰åç«¯åˆ†ç¦»ï¼Ÿ</strong></li></ul><h2 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h2><blockquote><p>å®è·µä¹‹å‰ï¼šæˆ‘å¸Œæœ›ä½ æœ‰å¦‚ä¸‹å‡†å¤‡ï¼Œæˆ–è€…çŸ¥è¯†å‚¨å¤‡ã€‚</p><ul><li>äº†è§£ <code>npm/yarn/git/sass/pug/vue/vuex/vue-router/axios/mock/ssr/jest</code><br>çš„ä½¿ç”¨å’ŒåŸç†ã€‚</li><li>å½“ç„¶ä¸Šé¢çŸ¥è¯†ä¸äº†è§£ä¹Ÿæ²¡å…³ç³»å“ˆå“ˆå“ˆï¼Œæ–‡ç« ä¸­ä¼šæåˆ°å¤§è‡´ç”¨æ³•å’Œä½œç”¨ã€‚</li></ul></blockquote><h3 id="å¦‚ä½•è§„èŒƒ-git-æäº¤"><a href="#å¦‚ä½•è§„èŒƒ-git-æäº¤" class="headerlink" title="å¦‚ä½•è§„èŒƒ git æäº¤"></a>å¦‚ä½•è§„èŒƒ git æäº¤</h3><blockquote><p>ä»£ç æäº¤è®°å½•æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä»£ç ä¿®æ”¹æ—¥å¿—ã€‚è§„èŒƒçš„ä»£ç æäº¤è®°å½•ï¼Œä¸ç®¡åœ¨å¹³æ—¶ä»£ç å¼€å‘ç»´æŠ¤è¿‡ç¨‹ä¸­ï¼Œè¿˜æ˜¯åœ¨å®šä½ bug æˆ–è€…å›é€€ç‰ˆæœ¬æ¥è¯´éƒ½æ˜¯æä¸ºé‡è¦ã€‚</p></blockquote><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>ä¸¤ç§åšæ³•ï¼š</p><ul><li>è‡ªå·±æ‰‹åŠ¨è§„èŒƒ git çš„æäº¤åŸåˆ™æˆ–è€…å›¢é˜Ÿç»Ÿä¸€åˆ¶å®šã€‚è¿™ä¸ªé è‡ªè§‰ï¼Œå¥½ä¹ æƒ¯å…»æˆä¹‹åå°±æ²¡é—®é¢˜æ¥</li><li>ä½¿ç”¨æ’ä»¶è§„èŒƒï¼Œæ¯”å¦‚ä¸‹é¢è¿™ç§</li></ul><p>ä¸ºäº†è§„èŒƒæäº¤ï¼Œæˆ‘ä½¿ç”¨äº†å¦‚ä¸‹æ’ä»¶ï¼š</p><ul><li>commitizen</li><li>conventional-changelog</li><li>cz-conventional-changelog</li><li>conventional-changelog-cli<h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><h5 id="å®‰è£…ç³»åˆ—æ’ä»¶ä¾èµ–"><a href="#å®‰è£…ç³»åˆ—æ’ä»¶ä¾èµ–" class="headerlink" title="å®‰è£…ç³»åˆ—æ’ä»¶ä¾èµ–"></a>å®‰è£…ç³»åˆ—æ’ä»¶ä¾èµ–</h5><pre><code class="sh">yarn add -D commitizen conventional-changelog cz-conventional-changelog</code></pre><blockquote><p>å®‰è£…ä¾èµ–æ—¶ï¼Œè¦æ³¨æ„æ˜¯å¦æ˜¯ç”Ÿäº§ç¯å¢ƒéœ€è¦çš„ã€‚æ˜¾ç„¶ <code>commitizen</code> åªåœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ã€‚<code>-D</code> åªåœ¨ <code>dev</code> ç¯å¢ƒä½¿ç”¨</p></blockquote><h5 id="é…ç½®ä¾èµ–è·¯å¾„"><a href="#é…ç½®ä¾èµ–è·¯å¾„" class="headerlink" title="é…ç½®ä¾èµ–è·¯å¾„"></a>é…ç½®ä¾èµ–è·¯å¾„</h5>åœ¨ <code>package.json</code> ä¸­æ·»åŠ é…ç½®<pre><code class="js">{  //...  &quot;config&quot;: {      &quot;commitizen&quot;: {        &quot;path&quot;: &quot;./node_modules/cz-conventional-changelog&quot;      }  }}</code></pre>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<pre><code class="sh">git add -Agit-cz</code></pre>å‡ºç°äº†äº¤äº’è¾“å…¥æ–¹å¼ï¼Œè§„èŒƒä½ çš„ <code>commit</code> è¾“å…¥æ ¼å¼<br><img src="https://user-gold-cdn.xitu.io/2019/12/30/16f554235055e8f3?w=2194&amp;h=620&amp;f=jpeg&amp;s=226477" alt="commit"></li></ul><h5 id="ç”Ÿæˆ-CHANGELOG"><a href="#ç”Ÿæˆ-CHANGELOG" class="headerlink" title="ç”Ÿæˆ CHANGELOG"></a>ç”Ÿæˆ CHANGELOG</h5><pre><code class="sh">npm i -g conventional-changelog-cli</code></pre><p>å¢åŠ ä¸€ä¸ªnpm å‘½ä»¤ï¼Œå¿«é€Ÿç”Ÿæˆæ—¥å¿—</p><pre><code class="js">&quot;genlog&quot;: &quot;conventional-changelog -p angular -i .github/CHANGELOG.md -s&quot;</code></pre><p>ä½¿ç”¨<code>yarn</code>å‘½ä»¤ç”Ÿæˆæ—¥å¿—</p><pre><code class="sh">yarn genlog</code></pre><p>è‡ªåŠ¨ç”Ÿæˆçš„log</p><h5 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h5><ul><li><strong>git:</strong> å¢åŠ commitizenå·¥å…·è§„èŒƒæäº¤ (<a href="https://github.com/suoyuesmile/suo-design-pro/commit/58e39370aa838fd99312f73b37d092ffadc85990" target="_blank" rel="noopener">58e3937</a>)</li></ul><h3 id="å¦‚ä½•ç®¡ç†ä»£ç é£æ ¼"><a href="#å¦‚ä½•ç®¡ç†ä»£ç é£æ ¼" class="headerlink" title="å¦‚ä½•ç®¡ç†ä»£ç é£æ ¼"></a>å¦‚ä½•ç®¡ç†ä»£ç é£æ ¼</h3><blockquote><p>è¾ƒç»Ÿä¸€çš„ä»£ç é£æ ¼åˆ©äºé˜…è¯»ï¼Œä¹Ÿåˆ©äºåä½œã€‚</p></blockquote><h4 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h4><p>ä½¿ç”¨ eslint çº¦æŸåŸºæœ¬é£æ ¼å’Œè¯­æ³•ï¼Œä½¿ç”¨ prettier è‡ªåŠ¨æ ¼å¼åŒ–ä½ çš„ä»£ç ã€‚</p><h4 id="å®è·µ-1"><a href="#å®è·µ-1" class="headerlink" title="å®è·µ"></a>å®è·µ</h4><h5 id="å®‰è£…-eslint-ä¾èµ–"><a href="#å®‰è£…-eslint-ä¾èµ–" class="headerlink" title="å®‰è£… eslint ä¾èµ–"></a>å®‰è£… eslint ä¾èµ–</h5><pre><code class="json">{    &quot;eslint&quot;: &quot;^5.16.0&quot;,    &quot;eslint-config-standard&quot;: &quot;^6.2.1&quot;,    &quot;eslint-friendly-formatter&quot;: &quot;^2.0.7&quot;,    &quot;eslint-loader&quot;: &quot;^2.1.2&quot;,    &quot;eslint-plugin-html&quot;: &quot;^2.0.1&quot;,    &quot;eslint-plugin-promise&quot;: &quot;^3.5.0&quot;,    &quot;eslint-plugin-standard&quot;: &quot;^2.3.1&quot;,    &quot;eslint-plugin-vue&quot;: &quot;^5.0.0&quot;}</code></pre><p>ä½¿ç”¨ä¸¤ä¸ªæ’ä»¶ï¼Œä¸€ä¸ª <code>plugin:vue/essential</code>ï¼Œä¸€ä¸ªæ˜¯ <code>standard</code>ã€‚<br><code>vue/essential</code> ä¸ºäº†åœ¨ vue é‡Œé¢ä¹Ÿå¯ä»¥ç”Ÿæ•ˆã€‚å¦ä¸€ä¸ªæ˜¯ <code>standard</code>ã€‚<br><a href="https://github.com/standard/standard/blob/master/docs/RULES-zhcn.md#javascript-standard-style" target="_blank" rel="noopener">standard æ ‡å‡†æ–‡æ¡£</a></p><blockquote><p>ä½¿ç”¨ recommend ä¹Ÿå¯ä»¥ï¼Œé‡‡ç”¨æ¨è lintï¼Œæ›´åŠ è½»é‡åŒ–</p></blockquote><pre><code class="js">module.exports = {  root: true,  env: {    node: true  },  extends: [&#39;plugin:vue/essential&#39;, &#39;standard&#39;],  rules: {    quotes: [&#39;error&#39;, &#39;single&#39;],    indent: [&#39;error&#39;, 2, { MemberExpression: &#39;off&#39; }],    &#39;arrow-parens&#39;: 0,    &#39;no-loop-func&#39;: 2,    &#39;space-before-function-paren&#39;: [&#39;error&#39;, &#39;never&#39;],    indent: [&#39;error&#39;, 2, { SwitchCase: 1 }]  },  parserOptions: {    parser: require.resolve(&#39;babel-eslint&#39;),    ecmaVersion: 2018,    sourceType: &#39;module&#39;  }}</code></pre><h5 id="å¯ä»¥è‡ªå®šä¹‰-rules-çš„è§„åˆ™"><a href="#å¯ä»¥è‡ªå®šä¹‰-rules-çš„è§„åˆ™" class="headerlink" title="å¯ä»¥è‡ªå®šä¹‰ rules çš„è§„åˆ™"></a>å¯ä»¥è‡ªå®šä¹‰ rules çš„è§„åˆ™</h5><blockquote><p>rules çš„è§„åˆ™ { è§„åˆ™åï¼š[æ˜¯å¦å…³é—­/è§„åˆ™ç­‰çº§ï¼Œé…ç½®çš„å€¼ï¼Œåªå¯¹éƒ¨åˆ†é…ç½®] }<br><code>indent: [&#39;error&#39;, 2, { SwitchCase: 1 }]</code> å…¼å®¹ prettierï¼Œprettier ä¼šå°†ä»£ç æ ¼å¼åŒ–æˆ eslint æŠ¥é”™çš„æƒ…å†µã€‚<br>è§„åˆ™ç­‰çº§ï¼š0 å…³é—­ 1 è­¦å‘Š 2 æŠ¥é”™</p></blockquote><h5 id="ä½¿ç”¨-prettier"><a href="#ä½¿ç”¨-prettier" class="headerlink" title="ä½¿ç”¨ prettier"></a>ä½¿ç”¨ prettier</h5><h6 id="é…ç½®-prettier-æ–‡ä»¶"><a href="#é…ç½®-prettier-æ–‡ä»¶" class="headerlink" title="é…ç½® prettier æ–‡ä»¶"></a>é…ç½® prettier æ–‡ä»¶</h6><pre><code class="js">{  &quot;printWidth&quot;: 150,  &quot;singleQuote&quot;: true,  &quot;trailingComma&quot;: &quot;none&quot;,  &quot;semi&quot;: false,  &quot;tabWidth&quot;: 2,  &quot;useTabs&quot;: false,  &quot;bracketSpacing&quot;: true,  &quot;jsxBracketSameLine&quot;: false,  &quot;arrowParens&quot;: &quot;always&quot;,  &quot;proseWrap&quot;: &quot;preserve&quot;,  &quot;overrides&quot;: [    {        &quot;files&quot;: [&quot;*.json&quot;, &quot;.eslintrc&quot;, &quot;.tslintrc&quot;, &quot;.prettierrc&quot;, &quot;.tern-project&quot;],        &quot;options&quot;: {            &quot;parser&quot;: &quot;json&quot;,            &quot;tabWidth&quot;: 2        }    },    {        &quot;files&quot;: &quot;*.{css,sass,scss,less}&quot;,        &quot;options&quot;: {            &quot;parser&quot;: &quot;css&quot;,            &quot;tabWidth&quot;: 2        }    },    {        &quot;files&quot;: &quot;*.ts&quot;,        &quot;options&quot;: {            &quot;parser&quot;: &quot;typescript&quot;        }    },    {        &quot;files&quot;: &quot;*.vue&quot;,        &quot;options&quot;: {            &quot;parser&quot;: &quot;vue&quot;        }    },    {        &quot;files&quot;: &quot;*.md&quot;,        &quot;options&quot;: {            &quot;parser&quot;: &quot;markdown&quot;        }    }  ]}</code></pre><h5 id="å¼€å¯-vscode-è‡ªåŠ¨æ ¼å¼åŒ–"><a href="#å¼€å¯-vscode-è‡ªåŠ¨æ ¼å¼åŒ–" class="headerlink" title="å¼€å¯ vscode è‡ªåŠ¨æ ¼å¼åŒ–"></a>å¼€å¯ vscode è‡ªåŠ¨æ ¼å¼åŒ–</h5><pre><code class="json">{  // prettier  &quot;prettier.singleQuote&quot;: true,  &quot;prettier.semi&quot;: false,  &quot;prettier.tabWidth&quot;: 2,  &quot;[javascript]&quot;: {    &quot;editor.formatOnSave&quot;: true,    &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;  }}</code></pre><h3 id="å¦‚ä½•æå‡ç¼–ç æ•ˆç‡"><a href="#å¦‚ä½•æå‡ç¼–ç æ•ˆç‡" class="headerlink" title="å¦‚ä½•æå‡ç¼–ç æ•ˆç‡"></a>å¦‚ä½•æå‡ç¼–ç æ•ˆç‡</h3><h4 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ-1"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h4><p>æˆ‘ä¸»è¦ä» 3 ä¸ªæ–¹é¢æ¥åšä¸€äº›ç¼–ç æ•ˆç‡ä¸Šçš„æ”¹è¿›</p><ul><li>å‡çº§ä½ çš„ vue-cli å‡å°‘ webpack é…ç½®çš„æˆæœ¬</li><li>ä½¿ç”¨ sassï¼Œåˆ©ç”¨é‡Œé¢å‡½æ•°ã€mixinsã€å˜é‡æå‡ css æ–‡ä»¶çš„å¤ç”¨</li><li>ä½¿ç”¨ pugï¼Œå‡å°‘ html çš„ä»£ç ç¼–å†™é‡</li></ul><h4 id="å®è·µ-2"><a href="#å®è·µ-2" class="headerlink" title="å®è·µ"></a>å®è·µ</h4><blockquote><p><code>vue-cli3+ã€vue-cli4+</code> ç›¸æ¯”äº <code>vue-cli2+</code> æœ€å¤§çš„æ”¹å˜å°±æ˜¯å°†çº¦å®šä¿—ç§°çš„é…ç½®ï¼Œå…¨éƒ¨å…¬å…±åŒ–äº†ï¼Œä¹Ÿå°±æ˜¯åšäº†ä¸€æ¬¡äºŒæ¬¡å°è£…ã€‚è¿™æ ·çš„å¥½å¤„åœ¨äºï¼Œæˆ‘ä»¬ä¸å¿…è¦åœ¨ç¹å¤šçš„é…ç½®ä»£ç ä¸­å¯»æ‰¾éœ€è¦çš„é…ç½®ã€‚</p></blockquote><p>ç®€å•æ–°å»ºä¸€ä¸ªé…ç½®å…¥å£å°±èƒ½æ“ä½œæˆ‘ä»¬å¤§å¤šæ•°æƒ³è¦çš„åŠŸèƒ½ã€‚åœ¨ <code>root</code> ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª <code>vue.config.js</code> æ–‡ä»¶ï¼Œä½œä¸ºæˆ‘ä»¬ <code>webpack</code> çš„é…ç½®æ–‡ä»¶ã€‚</p><p><strong>åˆå§‹åŒ– vue é…ç½®</strong></p><pre><code class="js">const autoprefixer = require(&#39;autoprefixer&#39;)module.exports = {  publicPath: process.env === &#39;production&#39; ? &#39;&#39; : &#39;/&#39;,  outputDir: &#39;dist&#39;,  assetsDir: &#39;static&#39;,  filenameHashing: true,  lintOnSave: true,  runtimeCompiler: false,  transpileDependencies: [/\/node_modules\/vue-echarts\//, /\/node_modules\/resize-detector\//],  productionSourceMap: false}</code></pre><p>ç®€å•çš„é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ª <code>sass</code> å·¥å…·ç”¨äºç¼–å†™ <code>sass</code>æ–‡ä»¶</p><blockquote><p>ç”¨æ³•è§ sass <a href="https://www.sass.hk/docs/" target="_blank" rel="noopener">å‚è€ƒèµ„æ–™</a>ï¼</p></blockquote><h5 id="ä½¿ç”¨-Sass"><a href="#ä½¿ç”¨-Sass" class="headerlink" title="ä½¿ç”¨ Sass"></a>ä½¿ç”¨ Sass</h5><h6 id="å®‰è£…ä¸ä½¿ç”¨"><a href="#å®‰è£…ä¸ä½¿ç”¨" class="headerlink" title="å®‰è£…ä¸ä½¿ç”¨"></a>å®‰è£…ä¸ä½¿ç”¨</h6><pre><code class="sh">yarn add -D sass sass-loader</code></pre><h6 id="å¦‚ä½•å¤„ç†æ ·å¼"><a href="#å¦‚ä½•å¤„ç†æ ·å¼" class="headerlink" title="å¦‚ä½•å¤„ç†æ ·å¼"></a>å¦‚ä½•å¤„ç†æ ·å¼</h6><p>åœ¨ <code>assets</code> ç›®å½•ä¸­å»ºç«‹ä¸€ä¸ª styles æ–‡ä»¶ä¸“é—¨æ¥å­˜æ”¾æ ·å¼æ–‡ä»¶ï¼Œæ–°å¢å…¥å£<code>index.scss</code>æ–‡ä»¶ï¼Œä¾¿äº JavaScript å¼•å…¥ï¼Œå¢åŠ  utils.scssã€reset.scssã€varibles æ–‡ä»¶ã€‚</p><blockquote><p>è¿™äº›æ ·å¼å·¥å…·éƒ½æ˜¯ä¸ºäº†æå‡æˆ‘ä»¬ <code>scss</code> å¼€å‘æ•ˆç‡ï¼Œå…·æœ‰ç•…å¿«çš„å¼€å‘ä½“éªŒï¼</p></blockquote><h6 id="ä½¿ç”¨-varibles-å˜é‡æ–‡ä»¶"><a href="#ä½¿ç”¨-varibles-å˜é‡æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨ varibles å˜é‡æ–‡ä»¶"></a>ä½¿ç”¨ varibles å˜é‡æ–‡ä»¶</h6><p>ä¸ºäº†æå‡æˆ‘ä»¬ä»£ç çš„å¯è¯»æ€§ï¼Œå¤ç”¨æ€§ã€‚ä½¿ç”¨ <code>sass</code> å˜é‡å¿…ä¸å¯å°‘ã€‚</p><p>è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯åˆ©äºå…¨å±€ä¿®æ”¹æ ·å¼ï¼Œå¦‚æœéœ€è¦æ›´æ¢çš®è‚¤è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬åªéœ€è¦æ›´æ”¹å…¨å±€çš„ä¸»é¢˜è‰²ï¼Œå³å¯æ›´æ¢ä¸»é¢˜ï¼Œé‚£æ ·æ›´åŠ æ–¹ä¾¿ã€‚</p><pre><code class="scss">// ä¸»é¢˜è‰²$color-red: #ff3333;$color-purple: #ff33a9;$color-orange: #ff8833;$color-blue: #3377ff;// æ–‡å­—è‰²$color-black: #000;$color-dark: #333;$color-deep: #555;$color-pl: #999999;$color-weak: #B3B3B3;$color-white: #fff;// èƒŒæ™¯è‰²$bg-bar: #F9F9F9;$bg-page: #F3F3F3;$bg-page-light: #F9F9F9;</code></pre><p>ä½¿ç”¨å˜é‡ä¹‹åï¼Œsass æ–‡ä»¶ä¸ä¼šç›´æ¥ç”Ÿæ•ˆï¼Œè‡³å°‘åœ¨ vue æ–‡ä»¶ é‡Œé¢æ˜¯è®¿é—®ä¸åˆ°çš„ã€‚<br>éœ€è¦åœ¨ <code>vue.config.js</code> é‡Œé¢å¢åŠ å¦‚ä¸‹é…ç½®ã€‚</p><pre><code class="js">module.exports = {    // ...    css: {        sourceMap: true,        loaderOptions: {            sass: {                prependData: `        @import &quot;@/assets/styles/variable.scss&quot;;        `            }        }    }}</code></pre><h6 id="è¦†ç›–é»˜è®¤æ ·å¼"><a href="#è¦†ç›–é»˜è®¤æ ·å¼" class="headerlink" title="è¦†ç›–é»˜è®¤æ ·å¼"></a>è¦†ç›–é»˜è®¤æ ·å¼</h6><p>å¸¸è§„æ“ä½œ, å¼•å…¥ reset.scss å°†é»˜è®¤æ ·å¼è¦†ç›–æ‰</p><pre><code class="scss">/* http://meyerweb.com/eric/tools/css/reset/   v2.0 | 20110126   License: none (public domain)*/html, body, div, span, applet, object, iframe,h1, h2, h3, h4, h5, h6, p, blockquote, pre,a, abbr, acronym, address, big, cite, code,del, dfn, em, img, ins, kbd, q, s, samp,small, strike, strong, sub, sup, tt, var,b, u, i, center,dl, dt, dd, ol, ul, li,fieldset, form, label, legend,table, caption, tbody, tfoot, thead, tr, th, td,article, aside, canvas, details, embed,figure, figcaption, footer, header, hgroup,menu, nav, output, ruby, section, summary,time, mark, audio, video {    margin: 0;    padding: 0;    border: 0;    font-size: 100%;    font: inherit;    vertical-align: baseline;}/* HTML5 display-role reset for older browsers */article, aside, details, figcaption, figure,footer, header, hgroup, menu, nav, section {    display: block;}body {    line-height: 1;}ol, ul {    list-style: none;}blockquote, q {    quotes: none;}blockquote:before, blockquote:after,q:before, q:after {    content: &#39;&#39;;    content: none;}table {    border-collapse: collapse;    border-spacing: 0;}html, body {  width: 100%;  height: 100%;  overflow: auto;  margin: 0;  scroll-behavior: smooth;  -webkit-overflow-scrolling: touch;}</code></pre><h6 id="ä½¿ç”¨æ ·å¼å·¥å…·é›†"><a href="#ä½¿ç”¨æ ·å¼å·¥å…·é›†" class="headerlink" title="ä½¿ç”¨æ ·å¼å·¥å…·é›†"></a>ä½¿ç”¨æ ·å¼å·¥å…·é›†</h6><p>æœ‰æ—¶å€™æˆ‘ä»¬å‘ç°ï¼Œå…‰æ˜¯å¼•å…¥å˜é‡è¿˜ä¸å¤Ÿï¼Œå˜é‡å·¥å…·åªèƒ½å…è®¸æˆ‘ä»¬åœ¨ css ç±»æ–‡ä»¶ä¸­ä½¿ç”¨ã€‚å‡å¦‚æˆ‘æƒ³ç€æ¨¡ç‰ˆä¸­ç›´æ¥ä½¿ç”¨æ ·å¼ï¼Œæœ‰æ²¡æœ‰æ›´å¿«çš„æ–¹æ¡ˆå‘¢ï¼Ÿ<br>å½“ç„¶æœ‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå¸¸ç”¨çš„æ ·å¼å·¥å…·é›†ã€‚è®¾ç½®ä¸€äº›èƒŒæ™¯é¢œè‰²ã€å­—ä½“é¢œè‰²ã€ç›’å­æ¨¡å‹ä¸­çš„å¸¸è§„æ“ä½œã€‚</p><blockquote><p>è¦æ˜¯æœ‰è®¾è®¡è§„èŒƒæ›´å¥½å“¦ï¼Œæˆ‘ä¹Ÿæ˜¯å¸¸å¸¸å‘è®¾è®¡å¸ˆæå‡ºè¦æ±‚ï¼Œä¸€å®šè¦åˆ¶å®šå‡ºä¸€å¥—äº§å“çš„è®¾è®¡è§„èŒƒã€‚</p></blockquote><pre><code class="scss">/* // utils å·¥å…·// é¢œè‰² */.bg-red {background-color: $color-red!important;}.bg-purple {background-color: $color-purple!important;}.bg-orange {background-color: $color-orange!important;}.bg-blue {background-color: $color-blue!important;}.color-red {color: $color-red!important;}.color-purple {color: $color-purple!important;}.color-orange {color: $color-orange!important;}.color-blue {color: $color-blue!important;}.text-black {color: #000;}.text-dark {color: #333;}.text-deep {color: #555;}.text-weak {color: #B3B3B3;}.text-white {color: #fff;}/* // å­—ä½“ */.f10 {font-size: 10px;}.f12 {font-size: 12px;}.f14 {font-size: 14px;}.f15 {font-size: 15px;}.f17 {font-size: 17px;}.f20 {font-size: 20px;}.f24 {font-size: 24px;}/* // æ–‡å­—å¯¹é½ */.tl {text-align: left;}.tc {text-align: center;}.tr {text-align: right;}/* // æµ®åŠ¨ä¸æ¸…é™¤æµ®åŠ¨ */.fl {float: left;}.fr {float: right;}.fix {*zoom: 1;}.fix:after{display:table; content:&#39;&#39;; clear:both;}/* // æ˜¾ç¤º */.dn{display:none;}.di{display:inline;}.db{display:block;}.dib{display:inline-block;}.dt{display:table;}div.dib{*display:inline; *zoom:1;}.vm {vertical-align: middle;}.vib {display:inline-block; vertical-align: middle;}/* // å®šä½ */.pr {position: relative;}.pa {position: absolute;}.pf {position: fixed;}/* // ç›’å­æ¨¡å‹ */.ml4 {margin-left: 4px;}.mr4 {margin-right: 4px;}.mt4 {margin-top: 4px;}.mb4 {margin-bottom: 4px;}.ml8 {margin-left: 8px;}.mr8 {margin-right: 8px;}.mt8 {margin-top: 8px;}.mb8 {margin-bottom: 8px;}.ml12 {margin-left: 12px;}.mr12 {margin-right: 12px;}.mt12 {margin-top: 12px;}.mb12 {margin-bottom: 12px;}.ml16 {margin-left: 16px;}.mr16 {margin-right: 16px;}.mt16 {margin-top: 16px;}.mb16 {margin-bottom: 16px;}.ml20 {margin-left: 20px;}.mr20 {margin-right: 20px;}.mt20 {margin-top: 20px;}.mb20 {margin-bottom: 20px;}.ml24 {margin-left: 24px;}.mr24 {margin-right: 24px;}.mt24 {margin-top: 24px;}.mb24 {margin-bottom: 24px;}.ml10 {margin-left: 10px;}.mr10 {margin-right: 10px;}.mt10 {margin-top: 10px;}.mb10 {margin-bottom: 10px;}.ml15 {margin-left: 15px;}.mr15 {margin-right: 15px;}.mt15 {margin-top: 15px;}.mb15 {margin-bottom: 15px;}/* // æŒ‰é’®ç¦ç”¨ */.disabled{outline:0 none; cursor:default!important; opacity:.4; filter:alpha(opacity=40); -ms-pointer-events:none; pointer-events:none;}</code></pre><h6 id="å¢åŠ æ ·å¼å…¥å£æ–‡ä»¶"><a href="#å¢åŠ æ ·å¼å…¥å£æ–‡ä»¶" class="headerlink" title="å¢åŠ æ ·å¼å…¥å£æ–‡ä»¶"></a>å¢åŠ æ ·å¼å…¥å£æ–‡ä»¶</h6><p>æœ€åä¸€æ­¥ï¼Œæ–°å»ºä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œå°†æ ·å¼å·¥å…·ç±»å…¨éƒ¨å¯¼å…¥è¿›æ¥ï¼Œä¾›ä¸»ç¨‹åºå¼•å…¥ã€‚</p><pre><code class="scss">// index.scss æ–‡ä»¶import &#39;./reset.scss&#39;;import &#39;./varibles.scss&#39;;improt &#39;./utils/scss&#39;;</code></pre><p>åœ¨ <code>main.js</code> ä¸­ç›´æ¥å¼•å…¥ <code>index.scss</code></p><pre><code class="js">import &#39;@/assets/styles/index.scss&#39;</code></pre><h3 id="vue-ä¸­å†™æ ·å¼è¦æ³¨æ„å“ªäº›æ–¹é¢ï¼Œæœ‰å“ªäº›æŠ€å·§å‘¢ï¼Ÿ"><a href="#vue-ä¸­å†™æ ·å¼è¦æ³¨æ„å“ªäº›æ–¹é¢ï¼Œæœ‰å“ªäº›æŠ€å·§å‘¢ï¼Ÿ" class="headerlink" title="vue ä¸­å†™æ ·å¼è¦æ³¨æ„å“ªäº›æ–¹é¢ï¼Œæœ‰å“ªäº›æŠ€å·§å‘¢ï¼Ÿ"></a>vue ä¸­å†™æ ·å¼è¦æ³¨æ„å“ªäº›æ–¹é¢ï¼Œæœ‰å“ªäº›æŠ€å·§å‘¢ï¼Ÿ</h3><h4 id="é¿å…å…¨å±€æ±¡æŸ“"><a href="#é¿å…å…¨å±€æ±¡æŸ“" class="headerlink" title="é¿å…å…¨å±€æ±¡æŸ“"></a>é¿å…å…¨å±€æ±¡æŸ“</h4><p>åœ¨é¡µé¢ä¸­å†™ <code>css/scss</code> åŠ ä¸Š <code>scoped</code>ï¼Œ<code>scoped</code> çš„åŠŸèƒ½å°±æ˜¯ä½¿é¡µé¢çš„æ ·å¼æ˜¯å±€éƒ¨çš„ï¼Œä¸è®©å½±å“å…¶ä»–é¡µé¢çš„æ ·å¼ã€‚</p><h4 id="bem-è§„èŒƒ"><a href="#bem-è§„èŒƒ" class="headerlink" title="bem è§„èŒƒ"></a>bem è§„èŒƒ</h4><p>æˆ‘ä»¬å¤§å¤šæ•°äººæ—¶å€™ä¼šé‡åˆ°é—®é¢˜ï¼Œ<strong>æ ·å¼åµŒå¥—å¤ªå¤šäº†æ€ä¹ˆå‘½å</strong></p><blockquote><p>BEMæ˜¯å—ï¼ˆblockï¼‰ã€å…ƒç´ ï¼ˆelementï¼‰ã€ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰çš„ç®€å†™ï¼Œç”± Yandex å›¢é˜Ÿæå‡ºçš„ä¸€ç§å‰ç«¯ CSS å‘½åæ–¹æ³•è®ºã€‚</p></blockquote><p>åå­—å¤ªé•¿æ˜“è¯»æ€§å¤ªå·®</p><pre><code class="scss">.cardbox {    .cardbox-card {        .cardbox-card-wrapper            .cardbox-card-wrapper-header {                .cardbox-card-wrapper-header-title {                    // ...                }            }            .cardbox-card-wrapper-body{                .cardbox-card-item {                    .cardbox-card-item-title {                        // ...                    }                }          }        }    }}</code></pre><h4 id="bem-ä½¿ç”¨æ–¹å¼"><a href="#bem-ä½¿ç”¨æ–¹å¼" class="headerlink" title="bem ä½¿ç”¨æ–¹å¼"></a>bem ä½¿ç”¨æ–¹å¼</h4><p><code>block-name__element-name--color</code></p><ul><li>åŒºåˆ†å—ï¼Œå­å…ƒç´ ï¼Œä¿®é¥°å…ƒç´ </li><li>å—ï¼Œé¡µé¢ä¸­ç‹¬ç«‹çš„å•å…ƒ</li><li>å­å…ƒç´ ï¼Œå—é‡Œé¢çš„å„¿å­ <code>card__item</code> ä½¿ç”¨ <code>__</code> è¿æ¥</li><li>å­å…ƒç´ é•¿å‘½åä½¿ç”¨ - è¿æ¥</li><li>ä¿®é¥°ï¼ˆæ˜“å˜çš„ï¼‰<code>card__item--warning</code> ä½¿ç”¨ <code>--</code></li></ul><p>æˆ‘ä»¬ä½¿ç”¨ bem æ”¹é€ æ ·å¼</p><pre><code class="scss">.cardbox {    &amp;__header {        &amp;__title {            //...        }    }    &amp;__body {        &amp;__item {            &amp;__title {                //...            }        }    }}</code></pre><blockquote><p>bem ä¸€èˆ¬æ¨èå­å…ƒç´ åµŒå¥—å°½é‡åœ¨2-3å±‚ä»¥å†…</p></blockquote><p>ä½†æ˜¯æˆ‘ä»¬å‘ç°æ ·å¼å­å…ƒç´ åµŒå¥—æœ‰ç‚¹å¤šï¼Œä½¿ç”¨äº†ä¸¤é‡å­å…ƒç´ åµŒå¥—ã€‚</p><p>å¤§è‡´åŸç†æ˜¯<strong>å°è¯•åˆ†ç¦»çˆ¶å­å…ƒç´ çš„å…³ç³»ï¼ŒæŠŠå¡ç‰‡æœ¬èº«å½“ä½œä¸€ä¸ªå—çœ‹å¾…ã€‚</strong></p><p>ä¸‹é¢æ¥è¯•ç€å»å‡å°‘åµŒå¥—ï¼š</p><pre><code class="scss">.cardbox {    &amp;__header {        &amp;__title {            //...        }    }    &amp;__body {        .card {            &amp;__title {                //...            }        }    }}</code></pre><p>ç°åœ¨ç¼–å†™æ ·å¼æ•ˆç‡æé«˜ä¹Ÿæ›´åŠ è§„èŒƒäº†ï¼Œé‚£ä¹ˆç¼–å†™ HTML ä¹Ÿæ˜¯æœ‰å¾ˆå¤šç´¯èµ˜çš„ä»£ç ã€‚</p><p>æ¯”å¦‚å¤§å¤šæ•°æ ‡ç­¾éƒ½æ˜¯å‰å¼€åé—­çš„ã€‚é€šè¿‡ pug æˆ‘ä»¬å¯ä»¥çœç•¥å¾ˆå¤šå­—ç¬¦çš„æ•²æ‰“ï¼Œä¸‹é¢æˆ‘ä»¬è°ˆè°ˆå¦‚ä½•ä½¿ç”¨ pug ç¼–å†™æ¨¡ç‰ˆã€‚</p><blockquote><p>å½“ç„¶å–œæ¬¢å“ªç§ HTML ç¼–å†™é£æ ¼è§äººè§æ™ºå•¦ï¼Œæˆ‘è‡ªå·±æ›´åŠ å€¾å‘ pugï¼Œé‚£ç§ç¼©è¿›å’Œç®€æ´çš„è¡¨è¾¾ï¼Œæœ‰ç§åœ¨å†™ scss çš„æ„Ÿè§‰ã€‚</p></blockquote><h3 id="å¦‚ä½•ä½¿ç”¨-pug"><a href="#å¦‚ä½•ä½¿ç”¨-pug" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ pug"></a>å¦‚ä½•ä½¿ç”¨ pug</h3><h4 id="å®è·µï¼šç±»ä¼¼-sassï¼Œé¦–å…ˆå®‰è£…-pug-å’Œ-pug-çš„-loader"><a href="#å®è·µï¼šç±»ä¼¼-sassï¼Œé¦–å…ˆå®‰è£…-pug-å’Œ-pug-çš„-loader" class="headerlink" title="å®è·µï¼šç±»ä¼¼ sassï¼Œé¦–å…ˆå®‰è£… pug å’Œ pug çš„ loader"></a>å®è·µï¼šç±»ä¼¼ sassï¼Œé¦–å…ˆå®‰è£… pug å’Œ pug çš„ loader</h4><pre><code>yarn add -D pug pug-html-loader pug-plain-loader</code></pre><h4 id="å®Œæˆé…ç½®"><a href="#å®Œæˆé…ç½®" class="headerlink" title="å®Œæˆé…ç½®"></a>å®Œæˆé…ç½®</h4><pre><code class="js">module.exports = {  // ...  chainWebpack: (config) =&gt; {    config.module      .rule(&#39;pug&#39;)      .test(/\.pug$/)      .use(&#39;pug-html-loader&#39;)      .loader(&#39;pug-html-loader&#39;)      .end()  }}</code></pre><h4 id="ç¼–å†™-pug-ä»£ç "><a href="#ç¼–å†™-pug-ä»£ç " class="headerlink" title="ç¼–å†™ pug ä»£ç "></a>ç¼–å†™ pug ä»£ç </h4><p>ä½¿ç”¨ scss å·¥å…·ä¸ pug å®Œç¾æ­é…ï¼Œå°‘å†™å¾ˆå¤šä»£ç </p><pre><code class="html">// ç™»é™†&lt;template lang=&quot;pug&quot;&gt;  .login    h1.login__title.ml15 æ³¨å†Œ/ç™»é™†    .login__form.mt15.ml15      van-field.login__form__input(placeholder=&quot;è¾“å…¥æ‰‹æœºå·&quot; v-model=&quot;phone&quot;)      .login__form__protocol.mt15        .login__form__protocol__tips.dib.text-weak æ³¨å†Œæˆ–ç™»å½•å³è¡¨ç¤ºåŒæ„        .login__form__protocol__name.dib.color-orange ã€Šç”¨æˆ·åè®®ã€‹      app-button.mt15(size=&quot;large&quot;        theme=&quot;orange&quot;        :disabled=&quot;phone.length !== 11&quot;        @click=&quot;handleSubmit&quot;      ) ä¸‹ä¸€æ­¥&lt;/template&gt;</code></pre><p>æˆ‘ä»¬å·²ç»å¼•å…¥äº†æ ·å¼ï¼Œæ¥ä¸‹æ¥æˆ‘å°†è°ˆè°ˆå…¶ä»–èµ„æºçš„å¼•å…¥</p><h3 id="å¦‚ä½•ç®¡ç†ä½ çš„èµ„æº"><a href="#å¦‚ä½•ç®¡ç†ä½ çš„èµ„æº" class="headerlink" title="å¦‚ä½•ç®¡ç†ä½ çš„èµ„æº"></a>å¦‚ä½•ç®¡ç†ä½ çš„èµ„æº</h3><h4 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ-2"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h4><p>æˆ‘æš‚æ—¶æŠŠèµ„æºåˆ†ä¸ºä¸‹é¢å‡ ç§</p><ul><li>å­—ä½“</li><li>ICON</li><li>å›¾ç‰‡</li><li>æ ·å¼<br><img src="https://user-gold-cdn.xitu.io/2019/12/30/16f55578916de772?imageslim" alt="èµ„æº"><br>æŠŠä»–ä»¬å„è‡ªæ–°å»ºä¸€ä¸ªç›®å½•ï¼Œéƒ½æ”¾åœ¨ assets ç›®å½•ä¸‹é¢åˆ†é—¨åˆ«ç±»ï¼Œä¾›å…¶ä»–åœ°æ–¹è°ƒç”¨ã€‚<br>ä½¿ç”¨ alias æ›´å¥½é‡å‘½åï¼Œä½¿ä¹‹æ›´ä¾¿æ·çš„è®¿é—®åˆ°ã€‚</li></ul><p>å¢åŠ  <code>vue.config.js</code> é…ç½® ,è®¾ç½®<code>assets</code>åˆ«å</p><pre><code class="js">const path = require(&#39;path&#39;)function resolve(dir) {  return path.join(__dirname, dir)}module.exports = {  //...  chainWebpack: (config) =&gt; {    config.resolve.alias.set(&#39;@&#39;, resolve(&#39;src&#39;)).set(&#39;@assets&#39;, resolve(&#39;src/assets&#39;))  }}</code></pre><h5 id="ICON"><a href="#ICON" class="headerlink" title="ICON"></a>ICON</h5><h6 id="å¼•å…¥-iconfont"><a href="#å¼•å…¥-iconfont" class="headerlink" title="å¼•å…¥ iconfont"></a>å¼•å…¥ iconfont</h6><ul><li>(1) <a href="https://www.iconfont.cn/manage/index" target="_blank" rel="noopener">iconfont</a> é˜¿é‡Œå›¾æ ‡é¡¹ç›®ä¸­ä¸‹è½½ï¼Œå°†æ•´ä¸ªé¡¹ç›®å›¾æ ‡åŒ…ä¸€èµ·ä¸‹è½½ä¸‹æ¥</li></ul><p><img src="https://user-gold-cdn.xitu.io/2019/12/27/16f462a5119bdcdf?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="ICON"></p><ul><li>(2) å¼•å…¥ iconfont æ ·å¼<br>éœ€è¦ä¸‹é¢å››ä¸ªæ–‡ä»¶</li></ul><ul><li><code>iconfont.eot</code></li><li><code>iconfont.ttf</code></li><li><code>iconfont.woff</code></li><li><code>iconfont.woff2</code></li></ul><ul><li>(3)  é¡¹ç›®ä¸­å¼•å…¥ iconfont</li></ul><p>è®© <code>icon</code> ç»„ä»¶åŒ–</p><pre><code class="html">&lt;template&gt;  &lt;i class=&quot;iconfont&quot; v-on=&quot;$listeners&quot; :class=&quot;name&quot;&gt;&lt;/i&gt;&lt;/template&gt;&lt;script&gt;export default {  props: {    name: String  }}&lt;/script&gt;&lt;style lang=&quot;scss&quot; scoped&gt;.iconfont {  font-size: 16px;  color: $color-icon;}&lt;/style&gt;</code></pre><h6 id="å¼•å…¥å›¾ç‰‡ä½œä¸º-ICON"><a href="#å¼•å…¥å›¾ç‰‡ä½œä¸º-ICON" class="headerlink" title="å¼•å…¥å›¾ç‰‡ä½œä¸º ICON"></a>å¼•å…¥å›¾ç‰‡ä½œä¸º ICON</h6><p>è®©å›¾ç‰‡ç»„ä»¶åŒ–ï¼Œæˆ‘ä»¬å†æ¥å†™ä¸€ä¸ª img ç»„ä»¶</p><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;  img(    :src=&quot;require(`@/assets/images/${name}.png`)&quot;    v-bind=&quot;$attrs&quot;    v-on=&quot;$listeners&quot;    :style=&quot;{&#39;width&#39;: width ? width + &#39;px&#39; : size + &#39;px&#39;, &#39;height&#39;: height ? height + &#39;px&#39; : size + &#39;px&#39; }&quot;)&lt;/template&gt;&lt;script&gt;export default {  name: &#39;app-img&#39;,  props: {    name: {      type: String,      default: &#39;&#39;    },    size: {      type: Number,      default: 16    },    width: {      type: Number,      default: 0    },    height: {      type: Number,      default: 0    }  }}&lt;/script&gt;</code></pre><h3 id="å¦‚ä½•ç®¡ç†ä½ çš„è·¯ç”±"><a href="#å¦‚ä½•ç®¡ç†ä½ çš„è·¯ç”±" class="headerlink" title="å¦‚ä½•ç®¡ç†ä½ çš„è·¯ç”±"></a>å¦‚ä½•ç®¡ç†ä½ çš„è·¯ç”±</h3><h4 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ-3"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ-3" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h4><p>ä½¿ç”¨ vue-routerï¼Œä½¿ç”¨<code>import()</code> ç”Ÿæˆå¼‚æ­¥è·¯ç”±ï¼Œåªæœ‰åœ¨è®¿é—®æ—¶å€™æ‰ä¼šåŠ è½½æ¨¡å—ã€‚</p><p>ä¸ºä»€ä¹ˆä½¿ç”¨ <code>import()</code> ä¼šå¼‚æ­¥åŠ è½½æ¨¡å—ï¼Ÿ</p><blockquote><p>MDNï¼šåœ¨æ‚¨å¸Œæœ›æŒ‰ç…§ä¸€å®šçš„æ¡ä»¶æˆ–è€…æŒ‰éœ€åŠ è½½æ¨¡å—çš„æ—¶å€™ï¼ŒåŠ¨æ€import() æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚è€Œé™æ€å‹çš„ import æ˜¯åˆå§‹åŒ–åŠ è½½ä¾èµ–é¡¹çš„æœ€ä¼˜é€‰æ‹©ï¼Œä½¿ç”¨é™æ€ import æ›´å®¹æ˜“ä»ä»£ç é™æ€åˆ†æå·¥å…·å’Œ tree shaking ä¸­å—ç›Šã€‚</p></blockquote><p>è¯´ç™½äº†å°±æ˜¯èµ·åˆ°ä¸€ä¸ª<strong>æŒ‰éœ€åŠ è½½</strong>çš„ç›®çš„ã€‚ç°åœ¨å¤§å¤šæ•°å®ç°çš„æŒ‰éœ€åŠ è½½ï¼ŒåŸºæœ¬éƒ½æ˜¯ä¾èµ– <code>import()</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><h5 id="å®‰è£…-vue-router"><a href="#å®‰è£…-vue-router" class="headerlink" title="å®‰è£… vue-router"></a>å®‰è£… vue-router</h5><pre><code class="sh">yarn add vue-router</code></pre><p>å®‰è£…å®Œ <code>router</code>ï¼Œåœ¨ç¼–å†™ <code>router</code> å…ˆåˆ›å»ºé¡µé¢</p><h5 id="æ–°å»ºä¸€ä¸ªç©ºé¡µé¢"><a href="#æ–°å»ºä¸€ä¸ªç©ºé¡µé¢" class="headerlink" title="æ–°å»ºä¸€ä¸ªç©ºé¡µé¢"></a>æ–°å»ºä¸€ä¸ªç©ºé¡µé¢</h5><p>src ç›®å½•ä¸‹æ–°å¢ views ç›®å½•å­˜æ”¾é¡µé¢æ–‡ä»¶ã€‚åˆ›å»º index ç›®å½•å’Œ home é¡µé¢</p><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;  .home é¦–é¡µ&lt;/template&gt;&lt;script&gt;export default {}&lt;/script&gt;&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</code></pre><h5 id="ç¼–å†™è·¯ç”±"><a href="#ç¼–å†™è·¯ç”±" class="headerlink" title="ç¼–å†™è·¯ç”±"></a>ç¼–å†™è·¯ç”±</h5><pre><code class="js">const routes = [    {        // é¦–é¡µ        path: &#39;/&#39;,        name: &#39;index&#39;,        redirect: &#39;/home&#39;,        component: App,        children: [            {                // é¦–é¡µ                path: &#39;home&#39;,                name: &#39;home&#39;,                // è·¯ç”±æ‡’åŠ è½½                component: () =&gt;                    import(                        /* webpackChunkName: &quot;index&quot; */ &#39;../views/index/home.vue&#39;                    )            }        ]    }]Vue.use(VueRouter)const router = new VueRouter({    mode: &#39;history&#39;,    routes: routes,    base: process.env.BASE_URL,    props: true})export default router</code></pre><h5 id="ä¸ºäº†æ¶ˆé™¤-æ˜¾å¾—è·¯å¾„æ›´åŠ å¥½çœ‹ç®€æ´ï¼Œæˆ‘ä»¬é‡‡ç”¨-history-æ¨¡å¼ï¼Œä½†æ˜¯-history-æ¨¡å¼æœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå¼‚æ­¥è·¯ç”±æ²¡æœ‰ç¼“å­˜åœ¨é¡µé¢ä¸­ï¼Œç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢ä¼šæ‰¾ä¸åˆ°"><a href="#ä¸ºäº†æ¶ˆé™¤-æ˜¾å¾—è·¯å¾„æ›´åŠ å¥½çœ‹ç®€æ´ï¼Œæˆ‘ä»¬é‡‡ç”¨-history-æ¨¡å¼ï¼Œä½†æ˜¯-history-æ¨¡å¼æœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå¼‚æ­¥è·¯ç”±æ²¡æœ‰ç¼“å­˜åœ¨é¡µé¢ä¸­ï¼Œç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢ä¼šæ‰¾ä¸åˆ°" class="headerlink" title="ä¸ºäº†æ¶ˆé™¤ # æ˜¾å¾—è·¯å¾„æ›´åŠ å¥½çœ‹ç®€æ´ï¼Œæˆ‘ä»¬é‡‡ç”¨ history æ¨¡å¼ï¼Œä½†æ˜¯ history æ¨¡å¼æœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå¼‚æ­¥è·¯ç”±æ²¡æœ‰ç¼“å­˜åœ¨é¡µé¢ä¸­ï¼Œç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢ä¼šæ‰¾ä¸åˆ°"></a>ä¸ºäº†æ¶ˆé™¤ # æ˜¾å¾—è·¯å¾„æ›´åŠ å¥½çœ‹ç®€æ´ï¼Œæˆ‘ä»¬é‡‡ç”¨ history æ¨¡å¼ï¼Œä½†æ˜¯ history æ¨¡å¼æœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå¼‚æ­¥è·¯ç”±æ²¡æœ‰ç¼“å­˜åœ¨é¡µé¢ä¸­ï¼Œç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢ä¼šæ‰¾ä¸åˆ°</h5><p>åœ¨ vue.config.js ä¸­å¢åŠ é…ç½®ï¼Œå¼€å‘ç¯å¢ƒå¯ä»¥è®¿é—®åˆ°ï¼Œæ¢å¤æ­£å¸¸</p><pre><code class="js">module.exports = {  // ...  devServer: {    historyApiFallback: true  }}</code></pre><blockquote><p>å…³äºè·¯ç”±è¿˜æœ‰å¾ˆå¤šå¯ä»¥ç ”ç©¶åˆ°åœ°æ–¹ï¼Œå¯ä»¥è‡ªè¡Œç ”ç©¶å“¦ï¼</p></blockquote><h3 id="ç»„ä»¶åŒ–å¼€å‘"><a href="#ç»„ä»¶åŒ–å¼€å‘" class="headerlink" title="ç»„ä»¶åŒ–å¼€å‘"></a>ç»„ä»¶åŒ–å¼€å‘</h3><h4 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ-4"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ-4" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h4><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬æ ¹æ®ç»„ä»¶çš„å¤ç”¨åº¦ï¼Œåˆ†ç»™åŸºç¡€ï¼ˆå…¬å…±ï¼‰ç»„ä»¶å’Œä¸šåŠ¡ç»„ä»¶ã€‚</p><p>ä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œå¿«é€Ÿå¼€å‘ï¼Œè¿™é‡ŒåŸºç¡€ç»„ä»¶å¤§éƒ¨åˆ†å¼•ç”¨å¼€æºç»„ä»¶ã€‚å½“ç„¶ä¸èƒ½ç›´æ¥å°±ç”¨å“¦ã€‚</p><p>ä¸€èˆ¬è¦è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œä¹Ÿå°±æ˜¯é«˜é˜¶ç»„ä»¶å¼€å‘ã€‚</p><ol><li>é€šè¿‡ä¿®æ”¹å’Œè¦†ç›–å½“å‰ç»„ä»¶çš„æ ·å¼æ¥è¾¾åˆ°ä¿®æ”¹æ ·å¼çš„ä½œç”¨ã€‚</li><li>é€šè¿‡æ‹¦æˆªäº‹ä»¶æ¥æ›´æ”¹jsçš„é€»è¾‘ã€‚</li></ol><p>ä¸‹é¢æˆ‘ä»¬å…ˆå¼•å…¥ <code>vant</code> ç»„ä»¶</p><h4 id="å®è·µ-3"><a href="#å®è·µ-3" class="headerlink" title="å®è·µ"></a>å®è·µ</h4><h5 id="å¼•å…¥-vant"><a href="#å¼•å…¥-vant" class="headerlink" title="å¼•å…¥ vant"></a>å¼•å…¥ vant</h5><pre><code class="sh">yarn add vant</code></pre><h4 id="å¯¹åŸºç¡€ç»„ä»¶è¿›è¡ŒäºŒæ¬¡å°è£…å’Œæ”¹é€ "><a href="#å¯¹åŸºç¡€ç»„ä»¶è¿›è¡ŒäºŒæ¬¡å°è£…å’Œæ”¹é€ " class="headerlink" title="å¯¹åŸºç¡€ç»„ä»¶è¿›è¡ŒäºŒæ¬¡å°è£…å’Œæ”¹é€ "></a>å¯¹åŸºç¡€ç»„ä»¶è¿›è¡ŒäºŒæ¬¡å°è£…å’Œæ”¹é€ </h4><p>ä¸‹é¢ 7 æ­¥æ¥å†™å¥½ä¸€ä¸ªå…¬å…±ç»„ä»¶</p><ul><li>(1) æ–°å»ºä¸€ä¸ª <code>components</code> ç›®å½•æ¥å­˜æ”¾åŸºç¡€ç»„ä»¶</li><li>(2) åŸºç¡€ç»„ä»¶å‘½åä¸º <code>app-xxx</code> æˆ– <code>appXxx</code>ï¼Œæ–°å»ºä¸€ä¸ª <code>app-button</code> ç›®å½•ï¼Œæ–°å»º <code>index.vue</code></li><li>(3) æ ¹æ®è®¾è®¡ç¨¿è®¾è®¡å’Œç¼–å†™ç»„ä»¶<blockquote><p>ç¼–å†™ç»„ä»¶ä¹‹å‰é¦–å…ˆè¦è®¾è®¡ç»„ä»¶ï¼Œæ ¹æ®ç»„ä»¶çš„ä¸å˜æ€§å’Œå¯å˜æ€§åŸåˆ™ç¼–å†™ã€‚ä¸å˜æ€§æ˜¯ç»„ä»¶çš„æ ¸å¿ƒï¼Œå¯å˜æ€§æ ¹æ®å‚æ•°å¯¹ç»„ä»¶å¯¹ç›¸å…³éƒ¨åˆ†è¿›è¡Œè°ƒèŠ‚ï¼Œå®ç°å¯é€‰æ‹©çš„åŠŸèƒ½ã€‚</p></blockquote></li><li>(4) å®ç°ç»„ä»¶</li></ul><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;  div.dib    van-button.btn(      @click=&quot;$emit(&#39;click&#39;)&quot;      :class=&quot;getClass&quot; v-bind=&quot;$attrs&quot;      :style=&quot;{&#39;width&#39;: size === &#39;large&#39; ? &#39;345px&#39;: &#39;&#39;, &#39;backgroundColor&#39;: getBgColor, borderColor: getBgColor, color: getBgColor}&quot;)      slot&lt;/template&gt;&lt;script&gt;import { Button } from &#39;vant&#39;import Vue from &#39;vue&#39;import { getColor } from &#39;@/utils&#39;Vue.use(Button)export default {  name: &#39;app-button&#39;,  props: {    type: {      type: String,      default: &#39;primary&#39;    },    theme: {      type: String,      default: &#39;blue&#39;    },    size: {      type: String,      default: &#39;&#39;    }  },  computed: {    getClass() {      if (!this.type) {        return &#39;&#39;      }      return `app-btn--${this.type}`    },    getBgColor() {      if (!this.theme) {        return &#39;&#39;      }      return getColor(this.theme)    }  }}&lt;/script&gt;&lt;style lang=&quot;scss&quot; scoped&gt;.app-btn  {  ::v-deep &amp;--primary {    padding: 8px 30px;    height: 40px;    border-radius: 4px;    font-size: 15px;    font-weight: 400;    line-height: 19px;    color: white!important;  }  ::v-deep &amp;--minor {    padding: 5px 10px;    height: 26px;    border-radius: 14px;    font-size: 12px;    font-weight: 400;    line-height: 16px;    background-color: #fff!important;  }  ::v-deep &amp;--rect {    padding: 5px px;    height: 49px;    font-size: 14px;    color: white!important;  }}&lt;/style&gt;</code></pre><blockquote><p>::v-deep  æ ·å¼æ·±è¦†ç›–ï¼Œscoped æƒ…å†µä¸‹è¦†ç›–ç»„ä»¶æ ·å¼ï¼Œä¸æ”¹å˜å…¶æ ·å¼</p></blockquote><ul><li>(5) å†™å¥½åŸºç¡€ç»„ä»¶ READMEï¼Œä¸ºä»€ä¹ˆè¦å†™æ–‡æ¡£å‘¢ï¼Ÿå¦‚æœå¤šäººå¼€å‘åŒä¸€ä¸ªé¡¹ç›®ï¼ŒåŸºç¡€ç»„ä»¶ä¼šè¢«å…¶ä»–äººå¼•ç”¨ã€‚æ–¹ä¾¿å…¶ä»–äººä½¿ç”¨ï¼Œæ‰€ä»¥è¦å†™æ–‡æ¡£ã€‚</li></ul><blockquote><p>ä¸€å¥è¯è¨€ï¼šåªè¦å¯èƒ½è¢«å…¶ä»–äººç”¨çš„å…¬å…±æ–¹æ³•å’Œç»„ä»¶ï¼Œæ³¨é‡Šæˆ–æ–‡æ¡£æ˜¯å¾ˆé‡è¦çš„ï¼Œå¯¹è‡ªå·±çš„ä»£ç è´Ÿè´£å“ˆã€‚</p></blockquote><p>å…¶ä»–ç”¨æ³•å‚ç…§ vant</p><ul><li>(6) å…¨å±€å¼•ç”¨ï¼ŒåŸºç¡€ç»„ä»¶è®¸å¤šé¡µé¢éƒ½ä¼šç”¨åˆ°ï¼Œå°†å…¶è®¾ç½®æˆå…¨å±€ç»„ä»¶ï¼Œå…¶ä»–åœ°æ–¹å°±ä¸å¿…å†å¼•ç”¨äº†å“¦ã€‚</li></ul><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶ <code>global</code> å­˜æ”¾å…¨å±€ç»„ä»¶æ³¨å†Œï¼Œåœ¨ <code>main.js</code> å¼•å…¥</p><pre><code class="javascript">import Vue from &#39;vue&#39;import appButton from &#39;@/components/app-button&#39;Vue.component(&#39;app-button&#39;, appButton)</code></pre><ul><li>(7) å†™å¥½ <code>demo</code>ï¼Œå³ä½¿æš‚æ—¶ä¸å†™å•å…ƒæµ‹è¯•ï¼Œä¹Ÿè¦å†™å¥½ä¸€ä¸ª <code>demo</code>ï¼Œä½¿ä¹‹èƒ½æ­£å¸¸çš„è¿è¡Œ</li></ul><p>æ·»åŠ  demo é¡µé¢å’Œè·¯ç”±</p><pre><code class="html">&lt;template lang=&quot;pug&quot;&gt;  div(class=&quot;base&quot;)    // æŒ‰é’®ç»„ä»¶    app-button.mt4(theme=&quot;blue&quot;) ç¡®è®¤æ”¯ä»˜    app-button(theme=&quot;orange&quot;) ç¡®è®¤æ”¯ä»˜    app-button(theme=&quot;purple&quot;) ç¡®è®¤æ”¯ä»˜    app-button.mt4(theme=&quot;red&quot;) ç¡®è®¤æ”¯ä»˜    app-button(theme=&quot;grey&quot;) ç¡®è®¤æ”¯ä»˜    app-button.mt4(theme=&quot;blue&quot; size=&quot;large&quot;) ä¿®æ”¹åœ°å€    app-button.mt4(theme=&quot;orange&quot; size=&quot;large&quot;) ä¿®æ”¹åœ°å€    app-button.mt4(theme=&quot;purple&quot; size=&quot;large&quot;) ä¿®æ”¹åœ°å€    app-button.mt4(theme=&quot;red&quot; size=&quot;large&quot;) ä¿®æ”¹åœ°å€    app-button.mt4(theme=&quot;grey&quot; size=&quot;large&quot;) ä¿®æ”¹åœ°å€    app-button.mt4(theme=&quot;blue&quot; type=&quot;minor&quot;) ç¡®è®¤æ”¶è´§    app-button(theme=&quot;orange&quot; type=&quot;minor&quot;) ç¡®è®¤æ”¶è´§    app-button(theme=&quot;purple&quot; type=&quot;minor&quot;) ç¡®è®¤æ”¶è´§    app-button(theme=&quot;red&quot; type=&quot;minor&quot;) ä¿®æ”¹åœ°å€    app-button(theme=&quot;grey&quot; type=&quot;minor&quot;) ä¿®æ”¹åœ°å€    app-button.mt4(theme=&quot;blue&quot; type=&quot;rect&quot;) ç¡®è®¤æ”¶è´§    app-button(theme=&quot;orange&quot; type=&quot;rect&quot;) ç¡®è®¤æ”¶è´§    app-button(theme=&quot;purple&quot; type=&quot;rect&quot;) ç¡®è®¤æ”¶è´§    app-button(theme=&quot;red&quot; type=&quot;rect&quot;) ä¿®æ”¹åœ°å€    app-button(theme=&quot;grey&quot; type=&quot;rect&quot;) ä¿®æ”¹åœ°å€&lt;/template&gt;&lt;script&gt;export default {}&lt;/script&gt;&lt;style lang=&quot;scss&quot;&gt;&lt;/style&gt;</code></pre><h4 id="å®ç°æ•ˆæœ"><a href="#å®ç°æ•ˆæœ" class="headerlink" title="å®ç°æ•ˆæœ"></a>å®ç°æ•ˆæœ</h4><p><img src="https://user-gold-cdn.xitu.io/2019/12/30/16f55700de463c65?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="demo"></p><h3 id="å¦‚ä½•å°è£…è¯·æ±‚"><a href="#å¦‚ä½•å°è£…è¯·æ±‚" class="headerlink" title="å¦‚ä½•å°è£…è¯·æ±‚"></a>å¦‚ä½•å°è£…è¯·æ±‚</h3><h4 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ-5"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ-5" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h4><p>åŸºæœ¬ä¸Šå°±æ˜¯å¯¹ axios çš„å°è£…ï¼Œå°è£…ä¸»è¦æœ‰ä¸¤ä¸ªç›®çš„ã€‚</p><ul><li>ä¿®æ”¹ä¸€äº›åŸºç¡€çš„é…ç½®ï¼šè¯·æ±‚åœ°å€ï¼Œè¶…æ—¶ï¼Œå…¶ä»–çš„æ‚ä¸ƒæ‚å…«çš„</li><li>ç»Ÿä¸€æ“ä½œï¼šç»Ÿä¸€å¤„ç†é”™è¯¯ï¼Œç»Ÿä¸€å¤„ç†è¯·æ±‚å‚æ•°å’Œæ ¼å¼ï¼Œå“åº”å‚æ•°å’Œæ ¼å¼ã€‚ç»Ÿä¸€å¤„ç† messageï¼Œç»Ÿä¸€æ‹¦æˆªæŒ‚è½½ç­‰ç­‰ã€‚</li></ul><p>ç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šç±»ä¼¼çš„æ–‡ç« äº†ï¼Œ æˆ‘è¿™é‡Œç»™å‡ºæˆ‘å¸¸ç”¨çš„å°è£…æ–¹æ¡ˆã€‚</p><h4 id="å®è·µ-4"><a href="#å®è·µ-4" class="headerlink" title="å®è·µ"></a>å®è·µ</h4><h5 id="æ ¹æ®ä¸åŒç¯å¢ƒè®¾ç½®è¯·æ±‚åœ°å€"><a href="#æ ¹æ®ä¸åŒç¯å¢ƒè®¾ç½®è¯·æ±‚åœ°å€" class="headerlink" title="æ ¹æ®ä¸åŒç¯å¢ƒè®¾ç½®è¯·æ±‚åœ°å€"></a>æ ¹æ®ä¸åŒç¯å¢ƒè®¾ç½®è¯·æ±‚åœ°å€</h5><pre><code class="js">// .env-default.js æ–‡ä»¶// ä¸åŒç¯å¢ƒè®¿é—®ä¸åŒçš„è·¯å¾„const api = {  develop: &#39;http://xxxx:8080&#39;,  mock: &#39;http://xxxx&#39;,  feature: &#39;http://xxxx&#39;,  test: &#39;http://xxxx&#39;,  production: &#39;http://xxxx&#39;}export const baseURL = api[process.env.NODE_ENV || &#39;dev&#39;]</code></pre><blockquote><p>å› ä¸ºæ¯ä¸ªäººå¼€å‘ç¯å¢ƒï¼Œmockç¯å¢ƒä¸ä¸€å®šç›¸åŒï¼Œè¿™ä¸ªæ–‡ä»¶å»ºè®® gitignoreå¿½ç•¥æ‰ã€‚æ¨¡ç‰ˆå¯ä»¥å†™åœ¨ readme æ–‡æ¡£ä¸­ï¼Œå¯åŠ¨é¡¹ç›®æ—¶åŠ å…¥æ–‡ä»¶ã€‚</p></blockquote><h5 id="æ–°å»ºä¸€ä¸ª-utils-å·¥å…·"><a href="#æ–°å»ºä¸€ä¸ª-utils-å·¥å…·" class="headerlink" title="æ–°å»ºä¸€ä¸ª utils å·¥å…·"></a>æ–°å»ºä¸€ä¸ª <code>utils</code> å·¥å…·</h5><p>æˆ‘ä»¬ç°åœ¨å°† axios å°è£…æˆæˆ‘ä»¬è‡ªå·±éœ€è¦çš„é…ç½®ï¼Œç„¶åå®šä¹‰å››ä¸ªå¸¸ç”¨çš„è¯·æ±‚æ–¹æ³•ä¾›è°ƒç”¨</p><pre><code class="js">// utils/http.js æ–‡ä»¶import axios from &#39;axios&#39;import { baseURL } from &#39;../../.env-defalut.js&#39;// axios é…ç½®const defaultBaseUrl = &#39;http://localhost:8080/&#39;// é»˜è®¤è¶…æ—¶æ—¶é—´axios.defaults.timeout = 15000// æ•°æ®æ¥å£åŸŸåç»Ÿä¸€é…ç½®.envaxios.defaults.baseURL = baseURL || defaultBaseUrl // http request æ‹¦æˆªå™¨axios.interceptors.request.use(  (config) =&gt; {    config.headers = {    }    return config  },  (err) =&gt; {    return Promise.reject(err)  })// http response æ‹¦æˆªå™¨axios.interceptors.response.use(  (response) =&gt; {    return response  },  (error) =&gt; {    const data = error.response.data    return Promise.reject(data || error)  })export default axios/** * fetch è¯·æ±‚æ–¹æ³• * @param {*} url * @param {*} params */export function fetch(url, params = {}) {  return new Promise((resolve, reject) =&gt; {    axios      .get(url, {        params: params      })      .then((response) =&gt; {        resolve(response.data)      })      .catch((err) =&gt; {        reject(err)      })  })}/** * post è¯·æ±‚æ–¹æ³•ï¼Œå‘é€æ•°æ®æ ¼å¼ json * @param {*} url * @param {*} data */export function post(  url,  data = {},  config = {    transformRequest: [      function(fData, headers) {        headers[&#39;Content-Type&#39;] = &#39;application/json&#39;        return JSON.stringify(fData)      }    ]  }) {  return new Promise((resolve, reject) =&gt; {    axios.post(url, data, config).then(      (response) =&gt; {        resolve(response.data)      },      (err) =&gt; {        reject(err)      }    )  })}/** * patch è¯·æ±‚æ–¹æ³•ï¼Œå‘é€æ•°æ®æ ¼å¼ json * @param {*} url * @param {*} data */export function patch(url, data = {}) {  return new Promise((resolve, reject) =&gt; {    axios      .patch(url, data, {        transformRequest: [          function(fData, headers) {            headers[&#39;Content-Type&#39;] = &#39;application/json&#39;            return JSON.stringify(fData)          }        ]      })      .then(        (response) =&gt; {          resolve(response.data)        },        (err) =&gt; {          reject(err)        }      )  })}export function del(url, data) {  return new Promise((resolve, reject) =&gt; {    axios.delete(url, { data }).then(      (response) =&gt; {        resolve(response.data)      },      (err) =&gt; {        reject(err)      }    )  })}</code></pre><h3 id="å¦‚ä½•ç®¡ç†-api"><a href="#å¦‚ä½•ç®¡ç†-api" class="headerlink" title="å¦‚ä½•ç®¡ç† api"></a>å¦‚ä½•ç®¡ç† api</h3><h4 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>é¦–å…ˆè¦åˆ¶å®šä¸€ä¸ª api çš„åŸåˆ™<br>æˆ‘çš„åŸåˆ™ä¸€èˆ¬æ˜¯è¿™äº›ï¼š</p><ul><li>å¹²å‡€çº¯ç²¹</li><li>å°½é‡ä¸è¦å¤„ç†æ•°æ®</li><li>ç‹¬ç«‹å•ä¸€ä¸è¦äº’ç›¸ä¾èµ–</li></ul><p>å¥½å¤„åœ¨äºï¼šä¸åœ¨ api é‡Œé¢å¤„ç†æ•°æ®ï¼Œapié‡Œé¢çš„æ¥å£å’Œæ¥å£æ–‡æ¡£ä¸Šä¸€æ ·ã€‚é¿å…åˆ«äººå¼•ç”¨æˆ‘çš„apiï¼Œè¿˜è¦å»çœ‹ä»£ç ï¼Œåªéœ€è¦çœ‹æ–‡æ¡£å°±å¥½äº†ã€‚</p><blockquote><p>ä¾‹å­ï¼šæƒ³è±¡è¿™æ ·ä¸€ç§æƒ…å†µï¼Œåˆ«äººå¼•ç”¨äº†æˆ‘çš„ apiï¼Œçªç„¶å‘ç°å“åº”æ•°æ®ä¸å¯¹ã€‚é¦–å…ˆå®ƒæ’æŸ¥åˆ°é¡µé¢æ•°æ®æ²¡æ›´æ”¹ã€‚çœ‹äº†apiæ–‡æ¡£ï¼Œæ•°æ®ä¹Ÿæ²¡é—®é¢˜ï¼Œæœ€åå‘ç°æˆ‘åœ¨å†™ api çš„æ—¶å€™è¿›è¡Œäº†å¤„ç†ï¼Œè¿™ä¸ª api å‘¢åˆä¸èƒ½æ”¹åŠ¨ï¼Œæ”¹äº†å½±å“æˆ‘è‡ªå·±çš„æ¨¡å—ã€‚åªèƒ½å®ƒåœ¨é‡æ–°å†™ä¸€ä¸ªapiï¼Œè¿™æ ·æ˜¾å¾—å¾ˆç¹æ‚äº†ï¼Œä¸å¤Ÿå¹²å‡€ä¼˜é›…ã€‚</p></blockquote><pre><code class="js">import { fetch, post } from &#39;@/utils/http&#39;// ç”¨æˆ·ç™»é™†export const login = data =&gt; post(&#39;/user/login&#39;, data)// è·å–ç”¨æˆ·ä¿¡æ¯export const getUserInfo = (data) =&gt; fetch(&#39;/api/user/info&#39;, data)</code></pre><p>å¦‚æœéœ€è¦å¤„ç†æ•°æ®ï¼Œè¦ä¹ˆä½¿ç”¨ä¸€ä¸ªä¸­é—´å·¥å…·å¤„ç†ï¼Œè¦ä¹ˆåœ¨é¡µé¢é‡Œé¢å¤„ç†ã€‚å½“ç„¶è¿˜æ˜¯å®é™…é—®é¢˜å®é™…åˆ†æã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨mockæ¨¡æ‹Ÿæ•°æ®"><a href="#å¦‚ä½•ä½¿ç”¨mockæ¨¡æ‹Ÿæ•°æ®" class="headerlink" title="å¦‚ä½•ä½¿ç”¨mockæ¨¡æ‹Ÿæ•°æ®"></a>å¦‚ä½•ä½¿ç”¨<code>mock</code>æ¨¡æ‹Ÿæ•°æ®</h3><h4 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ-6"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ-6" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h4><p>ä¸€èˆ¬å°±æ˜¯ä¸¤ç§æ–¹æ¡ˆï¼Œä¸€æ˜¯æ¨¡æ‹Ÿåç«¯ï¼Œä½¿ç”¨è¿œç¨‹åœ¨çº¿ JSON æœåŠ¡å™¨ã€‚å¦å¤–ä¸€ç§æ­å»ºæœ¬åœ° JSON æˆ–è€… ä½¿ç”¨ç°æˆçš„ Node æœåŠ¡å™¨æ‹¦æˆªè¯·æ±‚ã€‚</p><blockquote><p>è¿™ä¸¤ç§æ–¹å¼å„æœ‰åƒç§‹ï¼Œæ²¡æœ‰ä¼˜åŠ£ä¹‹åˆ†ï¼Œé€‚åˆå°±æ˜¯æœ€å¥½çš„ã€‚</p></blockquote><h4 id="è¿œç¨‹åœ¨çº¿mock"><a href="#è¿œç¨‹åœ¨çº¿mock" class="headerlink" title="è¿œç¨‹åœ¨çº¿mock"></a>è¿œç¨‹åœ¨çº¿<code>mock</code></h4><p>æˆ‘ç”¨è¿‡çš„è¿œç¨‹åœ¨çº¿<code>mock</code></p><ul><li>apizzaï¼šå¥½ç”¨ï¼ŒåŠŸèƒ½é½å…¨ï¼Œå–œæ¬¢ä»–çš„æ–‡ä»¶å±•å¼€ç›®å½•<code>api</code>ï¼Œå…è´¹ç‰ˆåªæ”¯æŒ 2 ä¸ªäººå…±åŒç¼–è¾‘</li><li>swaggerï¼šå¼€æºå…è´¹ï¼Œ<code>api</code>ç®¡ç†å¤ªå‡Œä¹±ï¼Œ</li><li>rap/rap2ï¼šå¼€æºå…è´¹ï¼Œå¯ä»¥æ­å»ºæœ¬åœ°<code>api</code>ï¼Œéœ€è¦è‡ªå·±æ­å»º</li></ul><p>ä½¿ç”¨è¿œç¨‹<code>mock</code>çš„ä¼˜ç‚¹ï¼š</p><ul><li>ä¸éœ€è¦åœ¨é¡¹ç›®å†…éƒ¨å¢åŠ <code>mock</code></li><li>åŠŸèƒ½æ›´åŠ å…¨é¢å®Œå–„</li><li>å¯ä»¥åœ¨æ¥å£æ–‡æ¡£åŸºç¡€ä¸Š<code>mock</code>ï¼Œä¸æ¥å£æ–‡æ¡£æ”¾åœ¨ä¸€èµ·æŸ¥çœ‹æ›´åŠ æ–¹ä¾¿ã€‚</li></ul><p>ç¼ºç‚¹ï¼šéœ€è¦è‡ªå·±å¦å¤–æ­å»ºæœåŠ¡å™¨ï¼Œåªæ”¯æŒé™æ€çš„<code>mock</code>ï¼Œä¸èƒ½ä¸å•å…ƒæµ‹è¯•ç»“åˆä½¿ç”¨</p><h4 id="æœ¬åœ°JSON-mock"><a href="#æœ¬åœ°JSON-mock" class="headerlink" title="æœ¬åœ°JSON mock"></a>æœ¬åœ°JSON mock</h4><ul><li>ä½¿ç”¨ <code>webpack</code> å†…éƒ¨ mock é…ç½®</li></ul><pre><code class="js">devServer: {    // æ¥å£æœªå®ç°æƒ…å†µä¸‹ï¼Œä½¿ç”¨mock    before: require(&#39;./mock&#39;)}</code></pre><p>åŸºæœ¬åŸç†ï¼šä¸»è¦æ˜¯ä½¿ç”¨ node è¯»å–æ–‡ä»¶ï¼Œè½¬æ¢æˆ JSON æ ¼å¼ï¼Œä½¿ç”¨<code>mock.js</code> æ¨¡æ‹Ÿæ•°æ®ï¼Œæœ€å webpack æ‹¦æˆªè¯·æ±‚ç”Ÿæˆ<code>json</code>å“åº”æ•°æ®</p><pre><code class="js">const Mock = require(&#39;mockjs&#39;)module.exports = (app) =&gt; {    function getJsonFile (filePath) {        var json = fs.readFileSync(path.resolve(__dirname, filePath), &#39;utf-8&#39;)        return JSON.parse(json)    },    const returnMock = (datafile, res, req) =&gt; {        setTimeout(() =&gt; {            var json            if (/\.json$/.test(datafile)) {                // jsonæ–‡ä»¶æš´éœ²çš„æ˜¯mockçš„æ¨¡æ¿                json = getJsonFile(datafile)            } else if (/\.js$/.test(datafile)) {                json = require(datafile)(req.query)            }            res.json(Mock.mock(json))        }, 500)    }}</code></pre><ul><li>ä½¿ç”¨ <code>json-server</code> æ­å»º<br>ä¸»è¦åˆ†ä¸ºä¸‹é¢å‡ æ­¥</li></ul><ol><li><code>npm</code> å®‰è£… <code>json-server</code></li><li>ç¼–å†™ <code>npm</code> è„šæœ¬å‘½ä»¤ï¼Œå¼•å…¥ <code>mock</code> é…ç½®æ–‡ä»¶</li><li>ç¼–å†™ <code>mock</code> è·¯ç”±åŒ¹é…è§„åˆ™<blockquote><p>æ¯”è¾ƒç®€å•è¿™é‡Œä¸è¯¦ç»†æè¿°äº†ï¼</p></blockquote></li></ol><p>æœ¬åœ°çš„ç¼ºç‚¹åœ¨äºéœ€è¦</p><ul><li>å‰ç«¯éœ€è¦æ ¹æ®<code>api</code>æ–‡æ¡£å†™<code>mock</code>æ•°æ®æ ¼å¼</li><li>åŠŸèƒ½æ²¡æœ‰è¿œç¨‹<code>mock</code>é‚£ä¹ˆå®Œå–„ï¼Œæ”¯æŒ<code>restful</code>éœ€è¦å»ç ”ç©¶ä¸‹</li><li>ä¹Ÿæ˜¯éœ€è¦é…ç½®ç›¸å…³<code>mock</code>å·¥å…·</li></ul><p>ä¼˜ç‚¹åœ¨äº</p><ul><li>ä¸ç”¨æŸ¥çœ‹ç¼–è¾‘<code>api</code>æ–‡æ¡£</li><li>åœ¨ä»£ç ä¸­å°±å¯ä»¥æ›´æ”¹å’ŒæŸ¥çœ‹<code>mock</code>æ•°æ®</li><li>æ”¯æŒä½¿ç”¨<code>JavaScipt</code>åŠ¨æ€å¤„<code>mock</code>ï¼Œå¯ä»¥ä¸å•å…ƒæµ‹è¯•ç»“åˆä½¿ç”¨</li></ul><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://github.com/commitizen/cz-cli" target="_blank" rel="noopener">commitizen</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/import" target="_blank" rel="noopener">MDN import()</a></li><li><a href="https://youzan.github.io/vant/#/zh-CN/intro" target="_blank" rel="noopener">vant æ–‡æ¡£</a></li><li><a href="https://eslint.org/" target="_blank" rel="noopener">eslint æ–‡æ¡£</a></li><li><a href="https://router.vuejs.org/zh/" target="_blank" rel="noopener">vue-router æ–‡æ¡£</a></li><li><a href="https://www.sasscss.com/getting-started/" target="_blank" rel="noopener">sass æ–‡æ¡£</a></li><li><a href="https://github.com/axios/axios" target="_blank" rel="noopener">axios æ–‡æ¡£</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>12ä¸ªå‰ç«¯å¿…ä¼š H5 é—®é¢˜åŠè§£å†³æ–¹æ³•</title>
      <link href="/2020/05/05/HTML5/12%E4%B8%AA%E5%89%8D%E7%AB%AF%E5%BF%85%E4%BC%9A-H5-%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
      <url>/2020/05/05/HTML5/12%E4%B8%AA%E5%89%8D%E7%AB%AF%E5%BF%85%E4%BC%9A-H5-%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/suoyuesmile/suo-blog/blob/master/articals/h5/0003.md" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="ç§»åŠ¨ç«¯-H5-ç›¸å…³é—®é¢˜æ±‡æ€»ï¼š"><a href="#ç§»åŠ¨ç«¯-H5-ç›¸å…³é—®é¢˜æ±‡æ€»ï¼š" class="headerlink" title="ç§»åŠ¨ç«¯ H5 ç›¸å…³é—®é¢˜æ±‡æ€»ï¼š"></a>ç§»åŠ¨ç«¯ H5 ç›¸å…³é—®é¢˜æ±‡æ€»ï¼š</h1><ul><li>1px é—®é¢˜</li><li>å“åº”å¼å¸ƒå±€</li><li>iOS æ»‘åŠ¨ä¸æµç•…</li><li>iOS ä¸Šæ‹‰è¾¹ç•Œä¸‹æ‹‰å‡ºç°ç™½è‰²ç©ºç™½</li><li>é¡µé¢ä»¶æ”¾å¤§æˆ–ç¼©å°ä¸ç¡®å®šæ€§è¡Œä¸º</li><li>click ç‚¹å‡»ç©¿é€ä¸å»¶è¿Ÿ</li><li>è½¯é”®ç›˜å¼¹å‡ºå°†é¡µé¢é¡¶èµ·æ¥ã€æ”¶èµ·æœªå›è½é—®é¢˜</li><li>iPhone X åº•éƒ¨æ é€‚é…é—®é¢˜</li><li>ä¿å­˜é¡µé¢ä¸ºå›¾ç‰‡å’ŒäºŒç»´ç é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</li><li>å¾®ä¿¡å…¬ä¼—å· H5 åˆ†äº«é—®é¢˜</li><li>H5 è°ƒç”¨ SDK ç›¸å…³é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</li><li>H5 è°ƒè¯•ç›¸å…³æ–¹æ¡ˆä¸ç­–ç•¥</li></ul><h1 id="ç§»åŠ¨ç«¯-H5-ç›¸å…³åŸºç¡€æŠ€æœ¯æ¦‚è§ˆ"><a href="#ç§»åŠ¨ç«¯-H5-ç›¸å…³åŸºç¡€æŠ€æœ¯æ¦‚è§ˆ" class="headerlink" title="ç§»åŠ¨ç«¯ H5 ç›¸å…³åŸºç¡€æŠ€æœ¯æ¦‚è§ˆ"></a>ç§»åŠ¨ç«¯ H5 ç›¸å…³åŸºç¡€æŠ€æœ¯æ¦‚è§ˆ</h1><p><img src="https://camo.githubusercontent.com/fd55251b2784c435753d675301fb4bfa7aef733b/68747470733a2f2f757365722d676f6c642d63646e2e786974752e696f2f323031392f31322f32342f313666333638373230643365623432313f773d3232303626683d3131343026663d6a70656726733d323437373332" alt="H5"></p><p><a href="https://juejin.im/post/5df3053ce51d45583d425ada" target="_blank" rel="noopener">1pxé—®é¢˜</a><br><a href="https://juejin.im/post/5df59139518825123e7af459" target="_blank" rel="noopener">å“åº”å¼å¸ƒå±€</a></p><h2 id="iOS-æ»‘åŠ¨ä¸æµç•…"><a href="#iOS-æ»‘åŠ¨ä¸æµç•…" class="headerlink" title="iOS æ»‘åŠ¨ä¸æµç•…"></a>iOS æ»‘åŠ¨ä¸æµç•…</h2><h3 id="è¡¨ç°"><a href="#è¡¨ç°" class="headerlink" title="è¡¨ç°"></a>è¡¨ç°</h3><p>ä¸Šä¸‹æ»‘åŠ¨é¡µé¢ä¼šäº§ç”Ÿå¡é¡¿ï¼Œæ‰‹æŒ‡ç¦»å¼€é¡µé¢ï¼Œé¡µé¢ç«‹å³åœæ­¢è¿åŠ¨ã€‚æ•´ä½“è¡¨ç°å°±æ˜¯æ»‘åŠ¨ä¸æµç•…ï¼Œæ²¡æœ‰æ»‘åŠ¨æƒ¯æ€§ã€‚</p><h3 id="äº§ç”ŸåŸå› "><a href="#äº§ç”ŸåŸå› " class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h3><p><strong>ä¸ºä»€ä¹ˆ iOS çš„ webview ä¸­ æ»‘åŠ¨ä¸æµç•…ï¼Œå®ƒæ˜¯å¦‚ä½•å®šä¹‰çš„</strong></p><p>æœ€ç»ˆæˆ‘åœ¨ <code>safari</code> æ–‡æ¡£é‡Œé¢å¯»æ‰¾åˆ°äº†ç­”æ¡ˆï¼ˆæ–‡æ¡£é“¾æ¥åœ¨å‚è€ƒèµ„æ–™é¡¹ï¼‰ã€‚</p><p><img src="https://camo.githubusercontent.com/dae1dc14e59ea49999123abbf133f60bd8f5fa2a/68747470733a2f2f757365722d676f6c642d63646e2e786974752e696f2f323031392f31322f31392f313666316461616237633431653034343f773d3134323026683d3131303426663d6a70656726733d313635343933" alt="safariæ–‡æ¡£"></p><p>åŸæ¥åœ¨ <code>iOS 5.0</code> ä»¥åŠä¹‹åçš„ç‰ˆæœ¬ï¼Œæ»‘åŠ¨æœ‰å®šä¹‰æœ‰ä¸¤ä¸ªå€¼ <code>auto</code> å’Œ <code>touch</code>ï¼Œé»˜è®¤å€¼ä¸º <code>auto</code>ã€‚</p><pre><code class="css">-webkit-overflow-scrolling: touch; /* å½“æ‰‹æŒ‡ä»è§¦æ‘¸å±ä¸Šç§»å¼€ï¼Œä¼šä¿æŒä¸€æ®µæ—¶é—´çš„æ»šåŠ¨ */-webkit-overflow-scrolling: auto; /* å½“æ‰‹æŒ‡ä»è§¦æ‘¸å±ä¸Šç§»å¼€ï¼Œæ»šåŠ¨ä¼šç«‹å³åœæ­¢ */</code></pre><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>1.åœ¨æ»šåŠ¨å®¹å™¨ä¸Šå¢åŠ æ»šåŠ¨ touch æ–¹æ³•</p><p>å°†<code>-webkit-overflow-scrolling</code> å€¼è®¾ç½®ä¸º <code>touch</code></p><pre><code class="css">.wrapper {    -webkit-overflow-scrolling: touch;}</code></pre><p>è®¾ç½®æ»šåŠ¨æ¡éšè—ï¼š </p><pre><code class="css">.container ::-webkit-scrollbar {display: none;}</code></pre><p>å¯èƒ½ä¼šå¯¼è‡´ä½¿ç”¨<code>position:fixed;</code> å›ºå®šå®šä½çš„å…ƒç´ ï¼Œéšç€é¡µé¢ä¸€èµ·æ»šåŠ¨</p><p>2.è®¾ç½® overflow</p><p>è®¾ç½®å¤–éƒ¨ <code>overflow</code> ä¸º <code>hidden</code>,è®¾ç½®å†…å®¹å…ƒç´  <code>overflow</code> ä¸º <code>auto</code>ã€‚å†…éƒ¨å…ƒç´ è¶…å‡º body å³äº§ç”Ÿæ»šåŠ¨ï¼Œè¶…å‡ºçš„éƒ¨åˆ† body éšè—ã€‚</p><pre><code class="css">body {    overflow-y: hidden;}.wrapper {    overflow-y: auto;}</code></pre><p><strong>ä¸¤è€…ç»“åˆä½¿ç”¨æ›´ä½³ï¼</strong></p><h2 id="iOS-ä¸Šæ‹‰è¾¹ç•Œä¸‹æ‹‰å‡ºç°ç™½è‰²ç©ºç™½"><a href="#iOS-ä¸Šæ‹‰è¾¹ç•Œä¸‹æ‹‰å‡ºç°ç™½è‰²ç©ºç™½" class="headerlink" title="iOS ä¸Šæ‹‰è¾¹ç•Œä¸‹æ‹‰å‡ºç°ç™½è‰²ç©ºç™½"></a>iOS ä¸Šæ‹‰è¾¹ç•Œä¸‹æ‹‰å‡ºç°ç™½è‰²ç©ºç™½</h2><h3 id="è¡¨ç°-1"><a href="#è¡¨ç°-1" class="headerlink" title="è¡¨ç°"></a>è¡¨ç°</h3><p>æ‰‹æŒ‡æŒ‰ä½å±å¹•ä¸‹æ‹‰ï¼Œå±å¹•é¡¶éƒ¨ä¼šå¤šå‡ºä¸€å—ç™½è‰²åŒºåŸŸã€‚æ‰‹æŒ‡æŒ‰ä½å±å¹•ä¸Šæ‹‰ï¼Œåº•éƒ¨å¤šå‡ºä¸€å—ç™½è‰²åŒºåŸŸã€‚</p><h3 id="äº§ç”ŸåŸå› -1"><a href="#äº§ç”ŸåŸå› -1" class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h3><p>åœ¨ iOS ä¸­ï¼Œæ‰‹æŒ‡æŒ‰ä½å±å¹•ä¸Šä¸‹æ‹–åŠ¨ï¼Œä¼šè§¦å‘ <code>touchmove</code> äº‹ä»¶ã€‚è¿™ä¸ªäº‹ä»¶è§¦å‘çš„å¯¹è±¡æ˜¯æ•´ä¸ª <code>webview</code> å®¹å™¨ï¼Œå®¹å™¨è‡ªç„¶ä¼šè¢«æ‹–åŠ¨ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†ä¼šæˆç©ºç™½ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><ol><li>ç›‘å¬äº‹ä»¶ç¦æ­¢æ»‘åŠ¨<br>ç§»åŠ¨ç«¯è§¦æ‘¸äº‹ä»¶æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«å®šä¹‰ä¸º</li></ol><ul><li><ol><li>touchstart ï¼šæ‰‹æŒ‡æ”¾åœ¨ä¸€ä¸ªDOMå…ƒç´ ä¸Šã€‚</li></ol></li><li><ol start="2"><li>touchmove ï¼šæ‰‹æŒ‡æ‹–æ›³ä¸€ä¸ªDOMå…ƒç´ ã€‚</li></ol></li><li><ol start="3"><li>touchend ï¼šæ‰‹æŒ‡ä»ä¸€ä¸ªDOMå…ƒç´ ä¸Šç§»å¼€ã€‚<br>æ˜¾ç„¶æˆ‘ä»¬éœ€è¦æ§åˆ¶çš„æ˜¯ <code>touchmove</code> äº‹ä»¶ï¼Œç”±æ­¤æˆ‘åœ¨ W3C æ–‡æ¡£ä¸­æ‰¾åˆ°äº†è¿™æ ·ä¸€æ®µè¯</li></ol></li></ul><p><code>Note that the rate at which the user agent sends touchmove events is implementation-defined, and may depend on hardware capabilities and other implementation details</code></p><p><code>If the preventDefault method is called on the first touchmove event of an active touch point, it should prevent any default action caused by any touchmove event associated with the same active touch point, such as scrolling.</code></p><p><code>touchmove</code> äº‹ä»¶çš„é€Ÿåº¦æ˜¯å¯ä»¥å®ç°å®šä¹‰çš„ï¼Œå–å†³äºç¡¬ä»¶æ€§èƒ½å’Œå…¶ä»–å®ç°ç»†èŠ‚</p><p><code>preventDefault</code> æ–¹æ³•ï¼Œé˜»æ­¢åŒä¸€è§¦ç‚¹ä¸Šæ‰€æœ‰é»˜è®¤è¡Œä¸ºï¼Œæ¯”å¦‚æ»šåŠ¨ã€‚</p><p>ç”±æ­¤æˆ‘ä»¬æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ç›‘å¬ touchmoveï¼Œè®©éœ€è¦æ»‘åŠ¨çš„åœ°æ–¹æ»‘åŠ¨ï¼Œä¸éœ€è¦æ»‘åŠ¨çš„åœ°æ–¹ç¦æ­¢æ»‘åŠ¨ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯æˆ‘ä»¬è¦è¿‡æ»¤æ‰å…·æœ‰æ»šåŠ¨å®¹å™¨çš„å…ƒç´ ã€‚</p><p>å®ç°å¦‚ä¸‹ï¼š</p><pre><code class="js">document.body.addEventListener(&#39;touchmove&#39;, function(e) {    if(e._isScroller) return;    // é˜»æ­¢é»˜è®¤äº‹ä»¶    e.preventDefault();}, {    passive: false});</code></pre><a id="more"></a><ol start="2"><li>æ»šåŠ¨å¦¥åå¡«å……ç©ºç™½ï¼Œè£…é¥°æˆå…¶ä»–åŠŸèƒ½<br>åœ¨å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¢ä¸€ç›´æ€è·¯ã€‚æ ¹æ®åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸‹æ‹‰ä½œä¸ºä¸€ä¸ªåŠŸèƒ½æ€§çš„æ“ä½œã€‚</li></ol><p>æ¯”å¦‚ï¼š ä¸‹æ‹‰ååˆ·æ–°é¡µé¢</p><p><img src="https://camo.githubusercontent.com/c3c6e29337d2f01a03f3fde0edde261edaa636aa/68747470733a2f2f757365722d676f6c642d63646e2e786974752e696f2f323031392f31322f32302f313666323139643137613666643434383f773d37353426683d3133323626663d6a70656726733d313833353730" alt="åˆ·æ–°é¡µé¢"></p><h2 id="é¡µé¢æ”¾å¤§æˆ–ç¼©å°ä¸ç¡®å®šæ€§è¡Œä¸º"><a href="#é¡µé¢æ”¾å¤§æˆ–ç¼©å°ä¸ç¡®å®šæ€§è¡Œä¸º" class="headerlink" title="é¡µé¢æ”¾å¤§æˆ–ç¼©å°ä¸ç¡®å®šæ€§è¡Œä¸º"></a>é¡µé¢æ”¾å¤§æˆ–ç¼©å°ä¸ç¡®å®šæ€§è¡Œä¸º</h2><h3 id="è¡¨ç°-2"><a href="#è¡¨ç°-2" class="headerlink" title="è¡¨ç°"></a>è¡¨ç°</h3><p>åŒå‡»æˆ–è€…åŒæŒ‡å¼ å¼€æ‰‹æŒ‡é¡µé¢å…ƒç´ ï¼Œé¡µé¢ä¼šæ”¾å¤§æˆ–ç¼©å°ã€‚</p><h3 id="äº§ç”ŸåŸå› -2"><a href="#äº§ç”ŸåŸå› -2" class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h3><p>HTML æœ¬èº«ä¼šäº§ç”Ÿæ”¾å¤§æˆ–ç¼©å°çš„è¡Œä¸ºï¼Œæ¯”å¦‚åœ¨ PC æµè§ˆå™¨ä¸Šï¼Œå¯ä»¥è‡ªç”±æ§åˆ¶é¡µé¢çš„æ”¾å¤§ç¼©å°ã€‚ä½†æ˜¯åœ¨ç§»åŠ¨ç«¯ï¼Œæˆ‘ä»¬æ˜¯ä¸éœ€è¦è¿™ä¸ªè¡Œä¸ºçš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ç¦æ­¢è¯¥ä¸ç¡®å®šæ€§è¡Œä¸ºï¼Œæ¥æå‡ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h3><p>HTML <code>meta</code> å…ƒæ ‡ç­¾æ ‡å‡†ä¸­æœ‰ä¸ª ä¸­ <code>viewport</code> å±æ€§ï¼Œç”¨æ¥æ§åˆ¶é¡µé¢çš„ç¼©æ”¾ï¼Œä¸€èˆ¬ç”¨äºç§»åŠ¨ç«¯ã€‚å¦‚ä¸‹å›¾ <code>MDN</code> ä¸­ä»‹ç»</p><p><img src="https://camo.githubusercontent.com/3c5a1f8607485339b7e2d3676d8a93c02fd3bff4/68747470733a2f2f757365722d676f6c642d63646e2e786974752e696f2f323031392f31322f31392f313666316366353238653738373439383f773d3132393426683d3132303226663d6a70656726733d333235303130" alt="viewport"></p><p>ç§»åŠ¨ç«¯å¸¸è§„å†™æ³•</p><p><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</code></p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥è®¾ç½® <code>maximum-scaleã€minimum-scale ä¸ user-scalable=no</code> ç”¨æ¥é¿å…è¿™ä¸ªé—®é¢˜</p><p><code>&lt;meta name=viewport content=&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0 maximum-scale=1.0, user-scalable=no&quot;&gt;</code></p><h2 id="click-ç‚¹å‡»äº‹ä»¶å»¶æ—¶ä¸ç©¿é€"><a href="#click-ç‚¹å‡»äº‹ä»¶å»¶æ—¶ä¸ç©¿é€" class="headerlink" title="click ç‚¹å‡»äº‹ä»¶å»¶æ—¶ä¸ç©¿é€"></a>click ç‚¹å‡»äº‹ä»¶å»¶æ—¶ä¸ç©¿é€</h2><h3 id="è¡¨ç°-3"><a href="#è¡¨ç°-3" class="headerlink" title="è¡¨ç°"></a>è¡¨ç°</h3><p>ç›‘å¬å…ƒç´  click äº‹ä»¶ï¼Œç‚¹å‡»å…ƒç´ è§¦å‘æ—¶é—´å»¶è¿Ÿçº¦ 300msã€‚</p><p>ç‚¹å‡»è’™å±‚ï¼Œè’™å±‚æ¶ˆå¤±åï¼Œä¸‹å±‚å…ƒç´ ç‚¹å‡»è§¦å‘ã€‚</p><h3 id="äº§ç”ŸåŸå› -3"><a href="#äº§ç”ŸåŸå› -3" class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h3><ul><li><p>ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿ <code>click</code> å»¶æ—¶ï¼Ÿ<br>iOS ä¸­çš„ safariï¼Œä¸ºäº†å®ç°åŒå‡»ç¼©æ”¾æ“ä½œï¼Œåœ¨å•å‡» 300ms ä¹‹åï¼Œå¦‚æœæœªè¿›è¡Œç¬¬äºŒæ¬¡ç‚¹å‡»ï¼Œåˆ™æ‰§è¡Œ <code>click</code> å•å‡»æ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´æ¥åˆ¤æ–­ç”¨æˆ·è¡Œä¸ºæ˜¯å¦ä¸ºåŒå‡»äº§ç”Ÿçš„ã€‚ä½†æ˜¯ï¼Œåœ¨ App ä¸­ï¼Œæ— è®ºæ˜¯å¦éœ€è¦åŒå‡»ç¼©æ”¾è¿™ç§è¡Œä¸ºï¼Œ<code>click</code> å•å‡»éƒ½ä¼šäº§ç”Ÿ 300ms å»¶è¿Ÿã€‚</p></li><li><p>ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿ <code>click</code> ç‚¹å‡»ç©¿é€ï¼Ÿ<br>åŒå±‚å…ƒç´ å åŠ æ—¶ï¼Œåœ¨ä¸Šå±‚å…ƒç´ ä¸Šç»‘å®š touch äº‹ä»¶ï¼Œä¸‹å±‚å…ƒç´ ç»‘å®š <code>click</code> äº‹ä»¶ã€‚ç”±äº <code>click</code> å‘ç”Ÿåœ¨ touch ä¹‹åï¼Œç‚¹å‡»ä¸Šå±‚å…ƒç´ ï¼Œå…ƒç´ æ¶ˆå¤±ï¼Œä¸‹å±‚å…ƒç´ ä¼šè§¦å‘ <code>click</code> äº‹ä»¶ï¼Œç”±æ­¤äº§ç”Ÿäº†ç‚¹å‡»ç©¿é€çš„æ•ˆæœã€‚</p></li></ul><h3 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ-1"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h3><p>è§£å†³æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ <code>touchstart</code> æ›¿æ¢ <code>click</code><br>å‰é¢å·²ç»ä»‹ç»äº†ï¼Œç§»åŠ¨è®¾å¤‡ä¸ä»…æ”¯æŒç‚¹å‡»ï¼Œè¿˜æ”¯æŒå‡ ä¸ªè§¦æ‘¸äº‹ä»¶ã€‚ é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨åŸºæœ¬æ€è·¯å°±æ˜¯ç”¨ touch äº‹ä»¶ä»£æ›¿<code>click</code> äº‹ä»¶ã€‚</p><p>å°† <code>click</code> æ›¿æ¢æˆ <code>touchstart</code> ä¸ä»…è§£å†³äº† <code>click</code> äº‹ä»¶éƒ½å»¶æ—¶é—®é¢˜ï¼Œè¿˜è§£å†³äº†ç©¿é€é—®é¢˜ã€‚å› ä¸ºç©¿é€é—®é¢˜æ˜¯åœ¨ touch å’Œ <code>click</code> æ··ç”¨æ—¶äº§ç”Ÿã€‚</p><p>åœ¨åŸç”Ÿä¸­ä½¿ç”¨</p><pre><code class="js">el.addEventListener(&quot;touchstart&quot;, () =&gt; { console.log(&quot;ok&quot;); }, false);</code></pre><p>åœ¨ vue ä¸­ä½¿ç”¨</p><pre><code class="html">&lt;button @touchstart=&quot;handleTouchstart()&quot;&gt;ç‚¹å‡»&lt;/button&gt;</code></pre><p>å¼€æºè§£å†³æ–¹æ¡ˆä¸­ï¼Œä¹Ÿæ˜¯æ—¢æä¾›äº† <code>click</code> äº‹ä»¶ï¼Œåˆæä¾›äº†<code>touchstart</code> äº‹ä»¶ã€‚å¦‚ <code>vant</code> ä¸­çš„ button ç»„ä»¶</p><p><img src="https://camo.githubusercontent.com/30a48da02fce60e7dccd243bbbce4bb7325b069c/68747470733a2f2f757365722d676f6c642d63646e2e786974752e696f2f323031392f31322f31392f313666316431333330303332313635353f773d3135313226683d33363826663d6a70656726733d3539373630" alt="vant button"></p><p><strong>é‚£ä¹ˆï¼Œæ˜¯å¦å¯ä»¥å°† click äº‹ä»¶å…¨éƒ¨æ›¿æ¢æˆ touchstart å‘¢ï¼Ÿä¸ºä»€ä¹ˆå¼€æºæ¡†æ¶è¿˜ä¼šç»™å‡º click äº‹ä»¶å‘¢ï¼Ÿ</strong></p><p>æˆ‘ä»¬æƒ³è±¡ä¸€ç§æƒ…æ™¯ï¼ŒåŒæ—¶éœ€è¦ç‚¹å‡»å’Œæ»‘åŠ¨çš„åœºæ™¯ä¸‹ã€‚å¦‚æœå°† <code>click</code> æ›¿æ¢æˆ <code>touchstart</code> ä¼šæ€æ ·ï¼Ÿ</p><ul><li>äº‹ä»¶è§¦å‘é¡ºåº: <code>touchstart, touchmove, touchend, click</code>ã€‚</li></ul><p>å¾ˆå®¹æ˜“æƒ³è±¡ï¼Œåœ¨æˆ‘éœ€è¦<code>touchmove</code>æ»‘åŠ¨æ—¶å€™ï¼Œä¼˜å…ˆè§¦å‘äº†<code>touchstart</code>çš„ç‚¹å‡»äº‹ä»¶ï¼Œæ˜¯ä¸æ˜¯å·²ç»äº§ç”Ÿäº†å†²çªå‘¢ï¼Ÿ</p><p>æ‰€ä»¥å‘¢ï¼Œåœ¨å…·æœ‰æ»šåŠ¨çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯å»ºè®®ä½¿ç”¨ click å¤„ç†ã€‚</p><p>åœ¨æ¥ä¸‹æ¥çš„<code>fastclick</code>å¼€æºåº“ä¸­ä¹Ÿåšäº†å¦‚ä¸‹å¤„ç†ã€‚ é’ˆå¯¹ <code>touchstart</code> å’Œ <code>touchend</code>ï¼Œæˆªå–äº†éƒ¨åˆ†æºç ã€‚</p><pre><code class="js">// If the target element is a child of a scrollable layer (using -webkit-overflow-scrolling: touch) and:// 1) the user does a fling scroll on the scrollable layer// 2) the user stops the fling scroll with another tap// then the event.target of the last &#39;touchend&#39; event will be the element that was under the user&#39;s finger// when the fling scroll was started, causing FastClick to send a click event to that layer - unless a check// is made to ensure that a parent layer was not scrolled before sending a synthetic click (issue #42).this.updateScrollParent(targetElement);// Don&#39;t send a synthetic click event if the target element is contained within a parent layer that was scrolled// and this tap is being used to stop the scrolling (usually initiated by a fling - issue #42).scrollParent = targetElement.fastClickScrollParent;if (scrollParent &amp;&amp; scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) {    return true;}</code></pre><p>ä¸»è¦ç›®çš„å°±æ˜¯ï¼Œåœ¨ä½¿ç”¨ <code>touchstart</code> åˆæˆ <code>click</code> äº‹ä»¶æ—¶ï¼Œä¿è¯å…¶ä¸åœ¨æ»šåŠ¨çš„çˆ¶å…ƒç´ ä¹‹ä¸‹ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆäºŒï¼š ä½¿ç”¨ <code>fastclick</code> åº“</strong></p><p>ä½¿ç”¨ <code>npm/yarn</code> å®‰è£…åä½¿ç”¨</p><pre><code class="js">import FastClick from &#39;fastclick&#39;;FastClick.attach(document.body, options);</code></pre><p>åŒæ ·ï¼Œä½¿ç”¨<code>fastclick</code>åº“åï¼Œclick å»¶æ—¶å’Œç©¿é€é—®é¢˜éƒ½æ²¡äº†</p><p>æŒ‰ç…§æˆ‘çš„æƒ¯ä¾‹ï¼Œåªè¦æ¶‰åŠå¼€æºåº“ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸€å®šè¦å»äº†è§£å®ƒå®ç°çš„åŸç†ã€‚ä¸»è¦æ˜¯å°†ç°æœ‰çš„åŸç”Ÿäº‹ä»¶é›†åˆå°è£…åˆæˆä¸€ä¸ªå…¼å®¹æ€§è¾ƒå¼ºçš„äº‹ä»¶é›†åˆã€‚</p><p><a href="https://github.com/ftlabs/fastclick/blob/master/lib/fastclick.js" target="_blank" rel="noopener">fastclickæºç </a> æ ¸å¿ƒä»£ç ä¸é•¿ï¼Œ 1000 è¡Œä¸åˆ°ã€‚æœ‰å…´è¶£å¯ä»¥äº†è§£ä¸€ä¸‹!</p><h2 id="è½¯é”®ç›˜å°†é¡µé¢é¡¶èµ·æ¥ã€æ”¶èµ·æœªå›è½é—®é¢˜"><a href="#è½¯é”®ç›˜å°†é¡µé¢é¡¶èµ·æ¥ã€æ”¶èµ·æœªå›è½é—®é¢˜" class="headerlink" title="è½¯é”®ç›˜å°†é¡µé¢é¡¶èµ·æ¥ã€æ”¶èµ·æœªå›è½é—®é¢˜"></a>è½¯é”®ç›˜å°†é¡µé¢é¡¶èµ·æ¥ã€æ”¶èµ·æœªå›è½é—®é¢˜</h2><h2 id="è¡¨ç°-4"><a href="#è¡¨ç°-4" class="headerlink" title="è¡¨ç°"></a>è¡¨ç°</h2><p>Android æ‰‹æœºä¸­ï¼Œç‚¹å‡» <code>input</code> æ¡†æ—¶ï¼Œé”®ç›˜å¼¹å‡ºï¼Œå°†é¡µé¢é¡¶èµ·æ¥ï¼Œå¯¼è‡´é¡µé¢æ ·å¼é”™ä¹±ã€‚</p><p>ç§»å¼€ç„¦ç‚¹æ—¶ï¼Œé”®ç›˜æ”¶èµ·ï¼Œé”®ç›˜åŒºåŸŸç©ºç™½ï¼Œæœªå›è½ã€‚</p><h2 id="äº§ç”ŸåŸå› -4"><a href="#äº§ç”ŸåŸå› -4" class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h2><p>æˆ‘ä»¬åœ¨app å¸ƒå±€ä¸­ä¼šæœ‰ä¸ªå›ºå®šçš„åº•éƒ¨ã€‚å®‰å“ä¸€äº›ç‰ˆæœ¬ä¸­ï¼Œè¾“å…¥å¼¹çª—å‡ºæ¥ï¼Œä¼šå°†è§£å‹ <code>absolute</code> å’Œ <code>fixed</code> å®šä½çš„å…ƒç´ ã€‚å¯¼è‡´å¯è§†åŒºåŸŸå˜å°ï¼Œå¸ƒå±€é”™ä¹±ã€‚</p><h2 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ-2"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h2><p>è½¯é”®ç›˜å°†é¡µé¢é¡¶èµ·æ¥çš„è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦æ˜¯<strong>é€šè¿‡ç›‘å¬é¡µé¢é«˜åº¦å˜åŒ–ï¼Œå¼ºåˆ¶æ¢å¤æˆå¼¹å‡ºå‰çš„é«˜åº¦</strong>ã€‚</p><pre><code class="js">// è®°å½•åŸæœ‰çš„è§†å£é«˜åº¦const originalHeight = document.body.clientHeight || document.documentElement.clientHeight;window.onresize = function(){  var resizeHeight = document.documentElement.clientHeight || document.body.clientHeight;  if(resizeHeight &lt; originalHeight ){    // æ¢å¤å†…å®¹åŒºåŸŸé«˜åº¦    // const container = document.getElementById(&quot;container&quot;)    // ä¾‹å¦‚ container.style.height = originalHeight;  }}</code></pre><p>é”®ç›˜ä¸èƒ½å›è½é—®é¢˜å‡ºç°åœ¨ <code>iOS 12+</code> å’Œ<code>wechat 6.7.4+</code> ä¸­ï¼Œè€Œåœ¨å¾®ä¿¡ H5 å¼€å‘ä¸­æ˜¯æ¯”è¾ƒå¸¸è§çš„ Bugã€‚</p><p>å…¼å®¹åŸç†ï¼Œ<strong>1.åˆ¤æ–­ç‰ˆæœ¬ç±»å‹ 2.æ›´æ”¹æ»šåŠ¨çš„å¯è§†åŒºåŸŸ</strong></p><pre><code class="js">const isWechat = window.navigator.userAgent.match(/MicroMessenger\/([\d\.]+)/i);if (!isWechat) return;const wechatVersion = wechatInfo[1];const version = (navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/); // å¦‚æœè®¾å¤‡ç±»å‹ä¸ºiOS 12+ å’Œwechat 6.7.4+ï¼Œæ¢å¤æˆåŸæ¥çš„è§†å£if (+wechatVersion.replace(/\./g, &#39;&#39;) &gt;= 674 &amp;&amp; +version[1] &gt;= 12) {  window.scrollTo(0, Math.max(document.body.clientHeight, document.documentElement.clientHeight));}</code></pre><h2 id="iPhone-Xç³»åˆ—å®‰å…¨åŒºåŸŸé€‚é…é—®é¢˜"><a href="#iPhone-Xç³»åˆ—å®‰å…¨åŒºåŸŸé€‚é…é—®é¢˜" class="headerlink" title="iPhone Xç³»åˆ—å®‰å…¨åŒºåŸŸé€‚é…é—®é¢˜"></a>iPhone Xç³»åˆ—å®‰å…¨åŒºåŸŸé€‚é…é—®é¢˜</h2><h3 id="è¡¨ç°-5"><a href="#è¡¨ç°-5" class="headerlink" title="è¡¨ç°"></a>è¡¨ç°</h3><p>å¤´éƒ¨åˆ˜æµ·ä¸¤ä¾§åŒºåŸŸæˆ–è€…åº•éƒ¨åŒºåŸŸï¼Œå‡ºç°åˆ˜æµ·é®æŒ¡æ–‡å­—ï¼Œæˆ–è€…å‘ˆç°é»‘åº•æˆ–ç™½åº•ç©ºç™½åŒºåŸŸã€‚</p><h3 id="äº§ç”ŸåŸå› -5"><a href="#äº§ç”ŸåŸå› -5" class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h3><p>iPhone X ä»¥åŠå®ƒä»¥ä¸Šçš„ç³»åˆ—ï¼Œéƒ½é‡‡ç”¨åˆ˜æµ·å±è®¾è®¡å’Œå…¨é¢å±æ‰‹åŠ¿ã€‚å¤´éƒ¨ã€åº•éƒ¨ã€ä¾§è¾¹éƒ½éœ€è¦åšç‰¹æ®Šå¤„ç†ã€‚æ‰èƒ½é€‚é… iPhone X çš„ç‰¹æ®Šæƒ…å†µã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>è®¾ç½®å®‰å…¨åŒºåŸŸï¼Œå¡«å……å±é™©åŒºåŸŸï¼Œå±é™©åŒºåŸŸä¸åšæ“ä½œå’Œå†…å®¹å±•ç¤ºã€‚</p><blockquote><p>å±é™©åŒºåŸŸæŒ‡å¤´éƒ¨ä¸è§„åˆ™åŒºåŸŸï¼Œåº•éƒ¨æ¨ªæ¡åŒºåŸŸï¼Œå·¦å³è§¦å‘åŒºåŸŸã€‚</p></blockquote><p><img src="https://camo.githubusercontent.com/e3113d3bf82f463084d4e51e4ee5dd804d7aa77f/68747470733a2f2f757365722d676f6c642d63646e2e786974752e696f2f323031392f31322f31392f313666316433313135306537396362393f773d3131313826683d35393426663d6a70656726733d3439313234" alt="å±é™©åŒºåŸŸ"></p><p>å…·ä½“æ“ä½œä¸ºï¼š<code>viewport-fit</code> meta æ ‡ç­¾è®¾ç½®ä¸º <code>cover</code>ï¼Œè·å–æ‰€æœ‰åŒºåŸŸå¡«å……ã€‚ åˆ¤æ–­è®¾å¤‡æ˜¯å¦å±äº <code>iPhone X</code>ï¼Œç»™å¤´éƒ¨åº•éƒ¨å¢åŠ é€‚é…å±‚</p><blockquote><p>viewport-fit æœ‰ 3 ä¸ªå€¼åˆ†åˆ«ä¸ºï¼š</p></blockquote><ul><li>autoï¼šæ­¤å€¼ä¸å½±å“åˆå§‹å¸ƒå±€è§†å›¾ç«¯å£ï¼Œå¹¶ä¸”æ•´ä¸ªwebé¡µé¢éƒ½æ˜¯å¯æŸ¥çœ‹çš„ã€‚</li><li>containï¼š è§†å›¾ç«¯å£æŒ‰æ¯”ä¾‹ç¼©æ”¾ï¼Œä»¥é€‚åˆæ˜¾ç¤ºå†…åµŒçš„æœ€å¤§çŸ©å½¢ã€‚</li><li>coverï¼šè§†å›¾ç«¯å£è¢«ç¼©æ”¾ä»¥å¡«å……è®¾å¤‡æ˜¾ç¤ºã€‚å¼ºçƒˆå»ºè®®ä½¿ç”¨ safe area inset å˜é‡ï¼Œä»¥ç¡®ä¿é‡è¦å†…å®¹ä¸ä¼šå‡ºç°åœ¨æ˜¾ç¤ºä¹‹å¤–ã€‚</li></ul><p><strong>è®¾ç½® viewport-fit ä¸º cover</strong></p><p><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, user-scalable=yes, viewport-fit=cover&quot;&gt;</code></p><p><strong>å¢åŠ é€‚é…å±‚</strong></p><p>ä½¿ç”¨ <code>safe area inset</code> å˜é‡</p><pre><code class="css">/* é€‚é… iPhone X é¡¶éƒ¨å¡«å……*/@supports (top: env(safe-area-inset-top)){  body,  .header{      padding-top: constant(safe-area-inset-top, 40px);      padding-top: env(safe-area-inset-top, 40px);      padding-top: var(safe-area-inset-top, 40px);  }}/* åˆ¤æ–­iPhoneX å°† footer çš„ padding-bottom å¡«å……åˆ°æœ€åº•éƒ¨ */@supports (bottom: env(safe-area-inset-bottom)){    body,    .footer{        padding-bottom: constant(safe-area-inset-bottom, 20px);        padding-bottom: env(safe-area-inset-bottom, 20px);        padding-top: var(safe-area-inset-bottom, 20px);    }}</code></pre><blockquote><p><code>safe-area-inset-top</code>, <code>safe-area-inset-right</code>, <code>safe-area-inset-bottom</code>, <code>safe-area-inset-left</code> <code>safe-area-inset-*</code>ç”±å››ä¸ªå®šä¹‰äº†è§†å£è¾¹ç¼˜å†…çŸ©å½¢çš„ top, right, bottom å’Œ left çš„ç¯å¢ƒå˜é‡ç»„æˆï¼Œè¿™æ ·å¯ä»¥å®‰å…¨åœ°æ”¾å…¥å†…å®¹ï¼Œè€Œä¸ä¼šæœ‰è¢«éçŸ©å½¢çš„æ˜¾ç¤ºåˆ‡æ–­çš„é£é™©ã€‚å¯¹äºçŸ©å½¢è§†å£ï¼Œä¾‹å¦‚æ™®é€šçš„ç¬”è®°æœ¬ç”µè„‘æ˜¾ç¤ºå™¨ï¼Œå…¶å€¼ç­‰äºé›¶ã€‚ å¯¹äºéçŸ©å½¢æ˜¾ç¤ºå™¨ï¼ˆå¦‚åœ†å½¢è¡¨ç›˜ï¼ŒiPhoneX å±å¹•ï¼‰ï¼Œåœ¨ç”¨æˆ·ä»£ç†è®¾ç½®çš„å››ä¸ªå€¼å½¢æˆçš„çŸ©å½¢å†…ï¼Œæ‰€æœ‰å†…å®¹å‡å¯è§ã€‚</p></blockquote><p>å…¶ä¸­ env() ç”¨æ³•ä¸º <code>env( &lt;custom-ident&gt; , &lt;declaration-value&gt;? )</code>ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè‡ªå®šä¹‰çš„åŒºåŸŸï¼Œç¬¬äºŒä¸ªä¸ºå¤‡ç”¨å€¼ã€‚</p><p>å…¶ä¸­ var() ç”¨æ³•ä¸º <code>var( &lt;custom-property-name&gt; , &lt;declaration-value&gt;? )</code>ï¼Œä½œç”¨æ˜¯åœ¨ env() ä¸ç”Ÿæ•ˆçš„æƒ…å†µä¸‹ï¼Œç»™å‡ºä¸€ä¸ªå¤‡ç”¨å€¼ã€‚</p><p><code>constantï¼ˆï¼‰</code> è¢« css 2017-2018 å¹´ä¸ºè‰ç¨¿é˜¶æ®µï¼Œæ˜¯å¦å·²è¢«æ ‡å‡†åŒ–æœªçŸ¥ã€‚è€Œå…¶ä»–iOS æµè§ˆå™¨ç‰ˆæœ¬ä¸­æ˜¯å¦æœ‰æ­¤å‡½æ•°æœªçŸ¥ï¼Œä½œä¸ºå…¼å®¹å¤„ç†è€Œæ·»åŠ è¿›å»ã€‚</p><p>è¯¦æƒ…è¯·æŸ¥çœ‹æ–‡ç« æœ«å°¾çš„å‚è€ƒèµ„æ–™ã€‚</p><p><strong>å…¼å®¹æ€§</strong></p><p><img src="https://camo.githubusercontent.com/c2eaef48e9887a3709118acbcd181adf338e1b97/68747470733a2f2f757365722d676f6c642d63646e2e786974752e696f2f323031392f31322f32302f313666323132666639393865316563313f773d3230323426683d35363826663d6a70656726733d313432363938" alt="å…¼å®¹æ€§"></p><h2 id="é¡µé¢ç”Ÿæˆä¸ºå›¾ç‰‡å’ŒäºŒç»´ç é—®é¢˜"><a href="#é¡µé¢ç”Ÿæˆä¸ºå›¾ç‰‡å’ŒäºŒç»´ç é—®é¢˜" class="headerlink" title="é¡µé¢ç”Ÿæˆä¸ºå›¾ç‰‡å’ŒäºŒç»´ç é—®é¢˜"></a>é¡µé¢ç”Ÿæˆä¸ºå›¾ç‰‡å’ŒäºŒç»´ç é—®é¢˜</h2><h3 id="è¡¨ç°-6"><a href="#è¡¨ç°-6" class="headerlink" title="è¡¨ç°"></a>è¡¨ç°</h3><p>åœ¨å·¥ä½œä¸­æœ‰éœ€è¦å°†é¡µé¢ç”Ÿæˆå›¾ç‰‡æˆ–è€…äºŒç»´ç çš„éœ€æ±‚ã€‚å¯èƒ½æˆ‘ä»¬ç¬¬ä¸€æƒ³åˆ°çš„ï¼Œäº¤ç»™åç«¯æ¥ç”Ÿæˆæ›´ç®€å•ã€‚ä½†æ˜¯è¿™æ ·æˆ‘ä»¬éœ€è¦æŠŠé¡µé¢ä»£ç å…¨éƒ¨ä¼ ç»™åç«¯ï¼Œç½‘ç»œæ€§èƒ½æ¶ˆè€—å¤ªå¤§ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-3"><a href="#è§£å†³æ–¹æ¡ˆ-3" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><h4 id="ç”ŸæˆäºŒç»´ç "><a href="#ç”ŸæˆäºŒç»´ç " class="headerlink" title="ç”ŸæˆäºŒç»´ç "></a>ç”ŸæˆäºŒç»´ç </h4><p>ä½¿ç”¨ <code>QRCode</code> ç”ŸæˆäºŒç»´ç </p><pre><code class="js">import QRCode from &#39;qrcode&#39;;// ä½¿ç”¨ async ç”Ÿæˆå›¾ç‰‡const options = {};const url = window.location.href;async url =&gt; {  try {    console.log(await QRCode.toDataURL(url, options))  } catch (err) {    console.error(err);  }}</code></pre><p>å°† <code>await QRCode.toDataURL(url, options)</code> èµ‹å€¼ç»™ å›¾ç‰‡ url å³å¯</p><h4 id="ç”Ÿæˆå›¾ç‰‡"><a href="#ç”Ÿæˆå›¾ç‰‡" class="headerlink" title="ç”Ÿæˆå›¾ç‰‡"></a>ç”Ÿæˆå›¾ç‰‡</h4><p>ä¸»è¦æ˜¯ä½¿ç”¨ <code>htmlToCanvas</code> ç”Ÿæˆ <code>canvas</code> ç”»å¸ƒ</p><pre><code class="js">import html2canvas from &#39;html2canvas&#39;;html2canvas(document.body).then(function(canvas) {    document.body.appendChild(canvas);});</code></pre><p>ä½†æ˜¯ä¸å•å•åœ¨æ­¤å¤„å°±å®Œäº†ï¼Œç”±äºæ˜¯ canvas çš„åŸå› ã€‚ç§»åŠ¨ç«¯ç”Ÿæˆå‡ºæ¥çš„å›¾ç‰‡æ¯”è¾ƒæ¨¡ç³Šã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ–°çš„ canvas æ–¹æ³•å¤šå€ç”Ÿæˆï¼Œæ”¾å…¥ä¸€å€å®¹å™¨é‡Œé¢ï¼Œè¾¾åˆ°æ›´åŠ æ¸…æ™°çš„æ•ˆæœï¼Œ<strong>é€šè¿‡è¶…é“¾æ¥ä¸‹è½½å›¾ç‰‡ ä¸‹è½½æ–‡ä»¶ç®€å•å®ç°ï¼Œæ›´å®Œæ•´çš„å®ç°æ–¹å¼ä¹‹åæ›´æ–°</strong></p><pre><code class="js">const scaleSize = 2;const newCanvas = document.createElement(&quot;canvas&quot;);const target = document.querySelector(&#39;div&#39;);const width = parseInt(window.getComputedStyle(target).width);const height = parseInt(window.getComputedStyle(target).height);newCanvas.width = width * scaleSize;newCanvas.height = widthh * scaleSize;newCanvas.style.width = width + &quot;px&quot;;newCanvas.style.height =width + &quot;px&quot;;const context = newCanvas.getContext(&quot;2d&quot;);context.scale(scaleSize, scaleSize);html2canvas(document.querySelector(&#39;.demo&#39;), { canvas: newCanvas }).then(function(canvas) {  // ç®€å•çš„é€šè¿‡è¶…é“¾æ¥è®¾ç½®ä¸‹è½½åŠŸèƒ½  document.querySelector(&quot;.btn&quot;).setAttribute(&#39;href&#39;, canvas.toDataURL());}</code></pre><p>æ ¹æ®éœ€è¦è®¾ç½® <code>scaleSize</code> å¤§å°</p><h2 id="å¾®ä¿¡å…¬ä¼—å·åˆ†äº«é—®é¢˜"><a href="#å¾®ä¿¡å…¬ä¼—å·åˆ†äº«é—®é¢˜" class="headerlink" title="å¾®ä¿¡å…¬ä¼—å·åˆ†äº«é—®é¢˜"></a>å¾®ä¿¡å…¬ä¼—å·åˆ†äº«é—®é¢˜</h2><h3 id="è¡¨ç°-7"><a href="#è¡¨ç°-7" class="headerlink" title="è¡¨ç°"></a>è¡¨ç°</h3><p>åœ¨å¾®ä¿¡å…¬ä¼—å· H5 å¼€å‘ä¸­ï¼Œé¡µé¢å†…éƒ¨ç‚¹å‡»åˆ†äº«æŒ‰é’®è°ƒç”¨ SDKï¼Œæ–¹æ³•ä¸ç”Ÿæ•ˆã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-4"><a href="#è§£å†³æ–¹æ¡ˆ-4" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>è§£å†³æ–¹æ³•ï¼š<strong>æ·»åŠ ä¸€å±‚è’™å±‚ï¼Œåšåˆ†äº«å¼•å¯¼</strong>ã€‚<br>å› ä¸ºé¡µé¢å†…éƒ¨ç‚¹å‡»åˆ†äº«æŒ‰é’®æ— æ³•ç›´æ¥è°ƒç”¨ï¼Œè€Œåˆ†äº«åŠŸèƒ½éœ€è¦ç‚¹å‡»å³ä¸Šè§’æ›´å¤šæ¥æ“ä½œã€‚</p><p>ç„¶åç”¨æˆ·å¯èƒ½ä¸çŸ¥é“é€šè¿‡å³ä¸Šè§’å°æ ‡é‡Œé¢çš„åŠŸèƒ½åˆ†äº«ã€‚åˆæƒ³å¼•å¯¼ç”¨æˆ·åˆ†äº«ï¼Œè¿™æ—¶åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>æŠ€æœ¯æ— æ³•å®ç°çš„ï¼Œä»äº§å“å‡ºå‘ã€‚</p><p><img src="https://camo.githubusercontent.com/f37734d29e8e4cb0df21bdd06be8aefc796b0094/68747470733a2f2f757365722d676f6c642d63646e2e786974752e696f2f323031392f31322f32302f313666316566613633323037313939623f773d33323826683d35373426663d6a70656726733d3535323135" alt="share"></p><p><strong>å¦‚æœæŠ€æœ¯ä¸Šå®ç°å¤æ‚ï¼Œæˆ–è€…ç›´æ¥ä¸èƒ½å®ç°ã€‚ä¸è¦å¼ºè¡Œé’»ç‰›è§’å°–å“¦ï¼Œå­¦ä¼šæ€¼äº§å“ï¼Œä¹Ÿæ˜¯ç¨‹åºå‘˜å¿…å¤‡çš„èƒ½åŠ›ä¹‹ä¸€ã€‚</strong></p><h2 id="H5-è°ƒç”¨-SDK-ç›¸å…³è§£å†³æ–¹æ¡ˆ"><a href="#H5-è°ƒç”¨-SDK-ç›¸å…³è§£å†³æ–¹æ¡ˆ" class="headerlink" title="H5 è°ƒç”¨ SDK ç›¸å…³è§£å†³æ–¹æ¡ˆ"></a>H5 è°ƒç”¨ SDK ç›¸å…³è§£å†³æ–¹æ¡ˆ</h2><h3 id="äº§ç”ŸåŸå› -6"><a href="#äº§ç”ŸåŸå› -6" class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h3><p>åœ¨ Hybrid App ä¸­ä½¿ç”¨ H5 æ˜¯æœ€å¸¸è§çš„ä¸è¿‡äº†ï¼Œåˆšæ¥è§¦çš„ï¼Œè‚¯å®šä¼šå¾ˆç”Ÿç–æ¨¡ç³Šã€‚ä¸çŸ¥é“ H5 å’Œ Hybrid æ˜¯æ€ä¹ˆäº¤äº’çš„ã€‚æ€æ ·åŒæ—¶æ”¯æŒ iOS å’Œ Android å‘¢ï¼Ÿç°åœ¨æ¥è°ˆè°ˆ Hybrid æŠ€æœ¯è¦ç‚¹ï¼ŒåŸç”Ÿä¸ H5 çš„é€šä¿¡ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-5"><a href="#è§£å†³æ–¹æ¡ˆ-5" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>ä½¿ç”¨ <code>DSBridge</code> åŒæ—¶æ”¯æŒ iOS ä¸ Android</p><p>SDKå°ç»„ æä¾›æ–¹æ³•<br>æ³¨å†Œæ–¹æ³• <code>bridge.register</code></p><pre><code class="js">bridge.register(&#39;enterApp&#39;, function() {  broadcast.emit(&#39;ENTER_APP&#39;)})</code></pre><p>å›è°ƒæ–¹æ³• <code>bridge.call</code></p><pre><code class="js">export const getSDKVersion = () =&gt; bridge.call(&#39;BLT.getSDKVersion&#39;)</code></pre><p>äº‹ä»¶ç›‘å¬ä¸è§¦å‘æ³•</p><pre><code class="js">const broadcast = {  on: function(name, fn, pluralable) {    this._on(name, fn, pluralable, false)  },  once: function(name, fn, pluralable) {    this._on(name, fn, pluralable, true)  },  _on: function(name, fn, pluralable, once) {    let eventData = broadcast.data    let fnObj = { fn: fn, once: once }    if (pluralable &amp;&amp; Object.prototype.hasOwnProperty.call(eventData, &#39;name&#39;)) {      eventData[name].push(fnObj)    } else {      eventData[name] = [fnObj]    }    return this  },  emit: function(name, data, thisArg) {    let fn, fnList, i, len    thisArg = thisArg || null    fnList = broadcast.data[name] || []    for (i = 0, len = fnList.length; i &lt; len; i++) {      fn = fnList[i].fn      fn.apply(thisArg, [data, name])      if (fnList[i].once) {        fnList.splice(i, 1)        i--        len--      }    }    return this  },  data: {}}export default broadcast</code></pre><p>è¸©å‘æ³¨æ„</p><p>æ–¹æ³•è°ƒç”¨å‰ï¼Œä¸€å®šè¦åˆ¤æ–­ SDK æ˜¯å¦æä¾›è¯¥æ–¹æ³• å¦‚æœ Android æä¾›è¯¥æ–¹æ³•ï¼ŒiOS ä¸Šè°ƒç”¨å°±ä¼šå‡ºç°ä¸€ä¸ªæ–¹æ³•è°ƒç”¨å¤±è´¥ç­‰å¼¹çª—ã€‚ æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p><p><strong>æä¾›ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦ Androidã€iOSã€‚æ ¹æ®è®¾å¤‡è¿›è¡Œåˆ¤æ–­</strong></p><pre><code class="js">export const hasNativeMethod = (name) =&gt;  return bridge.hasNativeMethod(&#39;BYJ.&#39; + name)}export const getSDKVersion = function() {  if (hasNativeMethod(&#39;getSDKVersion&#39;)) {    bridge.call(&#39;BYJ.getSDKVersion&#39;)  }}</code></pre><blockquote><p>åŒä¸€åŠŸèƒ½éœ€è¦iOSï¼ŒAndroidæ–¹æ³•åç›¸åŒï¼Œè¿™æ ·æ›´å¥½å¤„ç†å“¦</p></blockquote><h2 id="H5-è°ƒè¯•ç›¸å…³æ–¹æ¡ˆç­–ç•¥"><a href="#H5-è°ƒè¯•ç›¸å…³æ–¹æ¡ˆç­–ç•¥" class="headerlink" title="H5 è°ƒè¯•ç›¸å…³æ–¹æ¡ˆç­–ç•¥"></a>H5 è°ƒè¯•ç›¸å…³æ–¹æ¡ˆç­–ç•¥</h2><h3 id="è¡¨ç°-8"><a href="#è¡¨ç°-8" class="headerlink" title="è¡¨ç°"></a>è¡¨ç°</h3><p>è°ƒè¯•ä»£ç ä¸€èˆ¬å°±æ˜¯ä¸ºäº†<strong>æŸ¥çœ‹æ•°æ®å’Œå®šä½ bug</strong>ã€‚åˆ†ä¸ºä¸¤ç§åœºæ™¯ï¼Œä¸€ç§æ˜¯å¼€å‘å’Œæµ‹è¯•æ—¶è°ƒè¯•ï¼Œä¸€ç§æ˜¯ç”Ÿäº§ç¯å¢ƒä¸Šè°ƒè¯•ã€‚</p><p>ä¸ºä»€ä¹ˆæœ‰ç”Ÿäº§ç¯å¢ƒä¸Šè°ƒè¯•å‘¢ï¼Ÿæœ‰äº›æ—¶å€™æµ‹è¯•ç¯å¢ƒä¸Šæ²¡æ³•å¤ç°è¿™ä¸ª bugï¼Œæµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒä¸ä¸€è‡´ï¼Œæ­¤æ—¶å°±éœ€è¦ç´§æ€¥ç”Ÿäº§è°ƒè¯•ã€‚</p><p>åœ¨ PC ç«¯å¼€å‘æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰å‡ºæ§åˆ¶å°ï¼Œä½¿ç”¨æµè§ˆå™¨æä¾›çš„å·¥å…·æ“ä½œdevtoolsæˆ–è€…æŸ¥çœ‹æ—¥å¿—ã€‚ä½†æ˜¯åœ¨ App å†…éƒ¨æˆ‘ä»¬æ€ä¹ˆåšå‘¢ï¼Ÿ</p><h3 id="åŸç†ä¸è§£å†³æ–¹æ¡ˆ-3"><a href="#åŸç†ä¸è§£å†³æ–¹æ¡ˆ-3" class="headerlink" title="åŸç†ä¸è§£å†³æ–¹æ¡ˆ"></a>åŸç†ä¸è§£å†³æ–¹æ¡ˆ</h3><ol><li>vconsole æ§åˆ¶å°æ’ä»¶</li></ol><p>ä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•</p><pre><code class="js">import Vconsole from &#39;vconsole&#39;new Vconsole()</code></pre><p>æœ‰å…´è¶£çœ‹çœ‹å®ƒå®ç°çš„åŸºæœ¬åŸç†ï¼Œæˆ‘ä»¬å…³æ³¨çš„ç‚¹åº”è¯¥åœ¨ <code>vsconsole</code> å¦‚ä½•æ‰“å°å‡ºæˆ‘ä»¬æ‰€æœ‰ <code>log</code> çš„ è…¾è®¯å¼€æº<a href="https://github.com/Tencent/vConsole/blob/dev/src/core/core.js" target="_blank" rel="noopener">vconsole</a></p><p>ä¸Šè¿°æ–¹æ³•ä»…ç”¨äºå¼€å‘å’Œæµ‹è¯•ã€‚ç”Ÿäº§ç¯å¢ƒä¸­ä¸å…è®¸å‡ºç°ï¼Œæ‰€ä»¥ï¼Œ<strong>ä½¿ç”¨æ—¶éœ€è¦å¯¹ç¯å¢ƒè¿›è¡Œåˆ¤æ–­</strong>ã€‚</p><pre><code class="js">import Vconsole from &#39;vconsole&#39;if (process.env.NODE_ENV !== &#39;production&#39;) {    new Vconsole()}</code></pre><ol start="2"><li>ä»£ç† + spy-debugger</li></ol><p>æ“ä½œç¨å¾®æœ‰ç‚¹éº»çƒ¦ï¼Œä¸è¿‡æˆ‘ä¼šè¯¦ç»†å†™å‡ºï¼Œå¤§è‡´åˆ†ä¸º 4 ä¸ªæ­¥éª¤</p><ul><li>å®‰è£…æ’ä»¶(å…¨å±€å®‰è£…)<br>sudo npm install spy-debugger -g</li><li>æ‰‹æœºä¸ç”µè„‘ç½®äºåŒä¸€ wifi ä¸‹ï¼Œæ‰‹æœºè®¾ç½®ä»£ç†<br>è®¾ç½®æ‰‹æœºçš„ HTTP ä»£ç†ï¼Œä»£ç† IP åœ°å€è®¾ç½®ä¸º PC çš„ IP åœ°å€ï¼Œç«¯å£ä¸ºspy-debuggerçš„å¯åŠ¨ç«¯å£</li></ul><p><code>spy-debugger</code> é»˜è®¤ç«¯å£ï¼š<code>9888</code></p><p>Android ï¼šè®¾ç½® - WLAN - é•¿æŒ‰é€‰ä¸­ç½‘ç»œ - ä¿®æ”¹ç½‘ç»œ - é«˜çº§ - ä»£ç†è®¾ç½® - æ‰‹åŠ¨</p><p>IOS ï¼šè®¾ç½® - Wi-Fi - é€‰ä¸­ç½‘ç»œ, ç‚¹å‡»æ„Ÿå¹å·, HTTP ä»£ç†æ‰‹åŠ¨</p><ul><li>æ‰‹æœºæ‰“å¼€æµè§ˆå™¨æˆ–è€… app ä¸­ H5 é¡µé¢</li><li>æ‰“å¼€æ¡Œé¢æ—¥å¿—ç½‘ç«™è¿›è¡Œè°ƒè¯•ï¼Œç‚¹å‡» npm æ§åˆ¶å°ç›‘å¬åœ°å€ã€‚æŸ¥çœ‹æŠ“åŒ…å’Œ H5 é¡µé¢ç»“æ„</li></ul><p>è¿™ç§æ–¹å¼å¯ä»¥è°ƒè¯•ç”Ÿæˆç¯å¢ƒçš„é¡µé¢ï¼Œä¸éœ€è¦ä¿®æ”¹ä»£ç ï¼Œå¯ä»¥åº”ä»˜å¤§å¤šæ•°è°ƒè¯•éœ€æ±‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html#//apple_ref/css/property/-webkit-overflow-scrolling" target="_blank" rel="noopener">Safari CSS Reference</a><br><a href="https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html#//apple_ref/css/property/-webkit-overflow-scrolling" target="_blank" rel="noopener">MDN touch äº‹ä»¶</a><br><a href="https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html#//apple_ref/css/property/-webkit-overflow-scrolling" target="_blank" rel="noopener">MDN css var()</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/env" target="_blank" rel="noopener">MDN css env()</a><br><a href="https://drafts.csswg.org/css-env-1/" target="_blank" rel="noopener">csswg env() drafts</a><br><a href="https://github.com/ftlabs/fastclick/blob/master/lib/fastclick.js" target="_blank" rel="noopener">fastclick æºç </a><br><a href="https://github.com/wendux/DSBridge-Android" target="_blank" rel="noopener">DSBridge-Android</a> &amp; <a href="https://github.com/wendux/DSBridge-IOS" target="_blank" rel="noopener">DSBridge-iOS</a><br><a href="https://github.com/davidshimjs/qrcodejs" target="_blank" rel="noopener">qrcodejs æºç </a><br><a href="https://github.com/niklasvh/html2canvas" target="_blank" rel="noopener">html2canvas æºç </a><br><a href="https://www.cnblogs.com/lolDragon/p/7795174.html" target="_blank" rel="noopener">å…³äºH5é¡µé¢åœ¨iPhoneXé€‚é…</a><br><a href="https://youzan.github.io/vant/#/zh-CN/button" target="_blank" rel="noopener">vant ç›¸å…³æ–‡æ¡£</a></p>]]></content>
      
      
      <categories>
          
          <category> HTML5 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>websocketæ–­å¼€åŸå› åˆ†æ</title>
      <link href="/2020/04/28/HTTP/websocket%E6%96%AD%E5%BC%80%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90/"/>
      <url>/2020/04/28/HTTP/websocket%E6%96%AD%E5%BC%80%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p><a href="https://segmentfault.com/a/1190000014582485" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="æŠŠé”™è¯¯æ‰“å°å‡ºæ¥"><a href="#æŠŠé”™è¯¯æ‰“å°å‡ºæ¥" class="headerlink" title="æŠŠé”™è¯¯æ‰“å°å‡ºæ¥"></a>æŠŠé”™è¯¯æ‰“å°å‡ºæ¥</h1><p>WebSocketæ–­å¼€çš„åŸå› æœ‰å¾ˆå¤šï¼Œæœ€å¥½åœ¨WebSocketæ–­å¼€æ—¶ï¼Œå°†é”™è¯¯æ‰“å°å‡ºæ¥ã€‚</p><p><img src="https://segmentfault.com/img/remote/1460000014582490?w=812&amp;h=408" alt="demo"></p><pre><code class="js">ws.onclose = function (e) {  console.log(&#39;websocket æ–­å¼€: &#39; + e.code + &#39; &#39; + e.reason + &#39; &#39; + e.wasClean)  console.log(e)}</code></pre><p>å¦‚æœä½ æƒ³è‡ªå·±ç©ç©<code>WebSocket</code>, ä½†æ˜¯ä½ åˆä¸æƒ³è‡ªå·±éƒ¨ç½²ä¸€ä¸ª<code>WebSocket</code>æœåŠ¡å™¨ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>ws = new WebSocket(&#39;wss://echo.websocket.org/&#39;)</code>, ä½ å‘echo.websocket.orgå‘é€æ¶ˆæ¯ï¼Œå®ƒä¼šå›å¤ä½ åŒæ ·çš„æ¶ˆæ¯ã€‚</p><h1 id="é‡è¦ä¿¡æ¯é”™è¯¯çŠ¶æ€ç "><a href="#é‡è¦ä¿¡æ¯é”™è¯¯çŠ¶æ€ç " class="headerlink" title="é‡è¦ä¿¡æ¯é”™è¯¯çŠ¶æ€ç "></a>é‡è¦ä¿¡æ¯é”™è¯¯çŠ¶æ€ç </h1><p><code>WebSocket</code>æ–­å¼€æ—¶ï¼Œä¼šè§¦å‘<code>CloseEvent</code>, <code>CloseEvent</code>ä¼šåœ¨è¿æ¥å…³é—­æ—¶å‘é€ç»™ä½¿ç”¨ <code>WebSockets</code> çš„å®¢æˆ·ç«¯. å®ƒåœ¨ <code>WebSocket</code> å¯¹è±¡çš„ onclose äº‹ä»¶ç›‘å¬å™¨ä¸­ä½¿ç”¨ã€‚<code>CloseEvent</code>çš„codeå­—æ®µè¡¨ç¤ºäº†<code>WebSocket</code>æ–­å¼€çš„åŸå› ã€‚å¯ä»¥ä»è¯¥å­—æ®µä¸­åˆ†ææ–­å¼€çš„åŸå› ã€‚</p><p><code>CloseEvent</code>æœ‰ä¸‰ä¸ªå­—æ®µéœ€è¦æ³¨æ„, é€šè¿‡åˆ†æè¿™ä¸‰ä¸ªå­—æ®µï¼Œä¸€èˆ¬å°±å¯ä»¥æ‰¾åˆ°æ–­å¼€åŸå› </p><blockquote><ul><li><code>CloseEvent.code</code>: codeæ˜¯é”™è¯¯ç ï¼Œæ˜¯æ•´æ•°ç±»å‹</li><li><code>CloseEvent.reason</code>: reasonæ˜¯æ–­å¼€åŸå› ï¼Œæ˜¯å­—ç¬¦ä¸²</li><li><code>CloseEvent.wasClean</code>: wasCleanè¡¨ç¤ºæ˜¯å¦æ­£å¸¸æ–­å¼€ï¼Œæ˜¯å¸ƒå°”å€¼ã€‚ä¸€èˆ¬å¼‚å¸¸æ–­å¼€æ—¶ï¼Œè¯¥å€¼ä¸ºfalse</li></ul></blockquote><p><img src="https://segmentfault.com/img/remote/1460000014074898?w=1768&amp;h=732" alt="closed-code"></p><h1 id="å…³é—­çŠ¶æ€ç è¡¨"><a href="#å…³é—­çŠ¶æ€ç è¡¨" class="headerlink" title="å…³é—­çŠ¶æ€ç è¡¨"></a>å…³é—­çŠ¶æ€ç è¡¨</h1><p>ä¸€èˆ¬æ¥è¯´<code>1006</code>çš„é”™è¯¯ç å‡ºç°çš„æƒ…å†µæ¯”è¾ƒå¸¸è§ï¼Œè¯¥é”™è¯¯ç ä¸€èˆ¬å‡ºç°åœ¨æ–­ç½‘æ—¶ã€‚</p><table><thead><tr><th>çŠ¶æ€ç </th><th style="text-align:right">åç§°</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td>0â€“999</td><td style="text-align:right"></td><td style="text-align:center">ä¿ç•™æ®µ, æœªä½¿ç”¨</td></tr><tr><td>1000</td><td style="text-align:right">CLOSE_NORMAL</td><td style="text-align:center">æ­£å¸¸å…³é—­; æ— è®ºä¸ºä½•ç›®çš„è€Œåˆ›å»º, è¯¥é“¾æ¥éƒ½å·²æˆåŠŸå®Œæˆä»»åŠ¡.</td></tr><tr><td>1001</td><td style="text-align:right">CLOSE_GOING_AWAY</td><td style="text-align:center">ç»ˆç«¯ç¦»å¼€, å¯èƒ½å› ä¸ºæœåŠ¡ç«¯é”™è¯¯, ä¹Ÿå¯èƒ½å› ä¸ºæµè§ˆå™¨æ­£ä»æ‰“å¼€è¿æ¥çš„é¡µé¢è·³è½¬ç¦»å¼€.</td></tr><tr><td>1002</td><td style="text-align:right">CLOSE_PROTOCOL_ERROR</td><td style="text-align:center">ç”±äºåè®®é”™è¯¯è€Œä¸­æ–­è¿æ¥.</td></tr><tr><td>1003</td><td style="text-align:right">CLOSE_UNSUPPORTED</td><td style="text-align:center">ç”±äºæ¥æ”¶åˆ°ä¸å…è®¸çš„æ•°æ®ç±»å‹è€Œæ–­å¼€è¿æ¥ (å¦‚ä»…æ¥æ”¶æ–‡æœ¬æ•°æ®çš„ç»ˆç«¯æ¥æ”¶åˆ°äº†äºŒè¿›åˆ¶æ•°æ®).</td></tr><tr><td>1004</td><td style="text-align:right"></td><td style="text-align:center">ä¿ç•™. å…¶æ„ä¹‰å¯èƒ½ä¼šåœ¨æœªæ¥å®šä¹‰.</td></tr><tr><td>1005</td><td style="text-align:right"></td><td style="text-align:center">CLOSE_NO_STATUS</td></tr><tr><td>1006</td><td style="text-align:right">CLOSE_ABNORMAL</td><td style="text-align:center">ä¿ç•™. ç”¨äºæœŸæœ›æ”¶åˆ°çŠ¶æ€ç æ—¶è¿æ¥éæ­£å¸¸å…³é—­ (ä¹Ÿå°±æ˜¯è¯´, æ²¡æœ‰å‘é€å…³é—­å¸§).</td></tr><tr><td>1007</td><td style="text-align:right">Unsupported Data</td><td style="text-align:center">ç”±äºæ”¶åˆ°äº†æ ¼å¼ä¸ç¬¦çš„æ•°æ®è€Œæ–­å¼€è¿æ¥ (å¦‚æ–‡æœ¬æ¶ˆæ¯ä¸­åŒ…å«äº†é UTF-8 æ•°æ®).</td></tr><tr><td>1008</td><td style="text-align:right">Policy Violation</td><td style="text-align:center">ç”±äºæ”¶åˆ°ä¸ç¬¦åˆçº¦å®šçš„æ•°æ®è€Œæ–­å¼€è¿æ¥. è¿™æ˜¯ä¸€ä¸ªé€šç”¨çŠ¶æ€ç , ç”¨äºä¸é€‚åˆä½¿ç”¨ 1003 å’Œ 1009 çŠ¶æ€ç çš„åœºæ™¯.</td></tr><tr><td>1009</td><td style="text-align:right">CLOSE_TOO_LARGE</td><td style="text-align:center">ç”±äºæ”¶åˆ°è¿‡å¤§çš„æ•°æ®å¸§è€Œæ–­å¼€è¿æ¥.</td></tr><tr><td>1010</td><td style="text-align:right">Missing Extension</td><td style="text-align:center">å®¢æˆ·ç«¯æœŸæœ›æœåŠ¡å™¨å•†å®šä¸€ä¸ªæˆ–å¤šä¸ªæ‹“å±•, ä½†æœåŠ¡å™¨æ²¡æœ‰å¤„ç†, å› æ­¤å®¢æˆ·ç«¯æ–­å¼€è¿æ¥.</td></tr><tr><td>1011</td><td style="text-align:right">Internal Error</td><td style="text-align:center">å®¢æˆ·ç«¯ç”±äºé‡åˆ°æ²¡æœ‰é¢„æ–™çš„æƒ…å†µé˜»æ­¢å…¶å®Œæˆè¯·æ±‚, å› æ­¤æœåŠ¡ç«¯æ–­å¼€è¿æ¥.</td></tr><tr><td>1012</td><td style="text-align:right">Service Restart</td><td style="text-align:center">æœåŠ¡å™¨ç”±äºé‡å¯è€Œæ–­å¼€è¿æ¥.</td></tr><tr><td>1013</td><td style="text-align:right">Try Again Later</td><td style="text-align:center">æœåŠ¡å™¨ç”±äºä¸´æ—¶åŸå› æ–­å¼€è¿æ¥, å¦‚æœåŠ¡å™¨è¿‡è½½å› æ­¤æ–­å¼€ä¸€éƒ¨åˆ†å®¢æˆ·ç«¯è¿æ¥.</td></tr><tr><td>1014</td><td style="text-align:right"></td><td style="text-align:center">ç”± WebSocketæ ‡å‡†ä¿ç•™ä»¥ä¾¿æœªæ¥ä½¿ç”¨.</td></tr><tr><td>1015</td><td style="text-align:right"></td><td style="text-align:center">TLS Handshake    ä¿ç•™. è¡¨ç¤ºè¿æ¥ç”±äºæ— æ³•å®Œæˆ TLS æ¡æ‰‹è€Œå…³é—­ (ä¾‹å¦‚æ— æ³•éªŒè¯æœåŠ¡å™¨è¯ä¹¦).</td></tr><tr><td>1016â€“1999</td><td style="text-align:right"></td><td style="text-align:center">ç”± WebSocketæ ‡å‡†ä¿ç•™ä»¥ä¾¿æœªæ¥ä½¿ç”¨.</td></tr><tr><td>2000â€“2999</td><td style="text-align:right"></td><td style="text-align:center">ç”± WebSocketæ‹“å±•ä¿ç•™ä½¿ç”¨.</td></tr><tr><td>3000â€“3999</td><td style="text-align:right"></td><td style="text-align:center">å¯ä»¥ç”±åº“æˆ–æ¡†æ¶ä½¿ç”¨.? ä¸åº”ç”±åº”ç”¨ä½¿ç”¨. å¯ä»¥åœ¨ IANA æ³¨å†Œ, å…ˆåˆ°å…ˆå¾—.</td></tr><tr><td>4000â€“4999</td><td style="text-align:right"></td><td style="text-align:center">å¯ä»¥ç”±åº”ç”¨ä½¿ç”¨.</td></tr></tbody></table><h1 id="å…¶ä»–æ³¨æ„äº‹é¡¹"><a href="#å…¶ä»–æ³¨æ„äº‹é¡¹" class="headerlink" title="å…¶ä»–æ³¨æ„äº‹é¡¹"></a>å…¶ä»–æ³¨æ„äº‹é¡¹</h1><p>å¦‚æœä½ çš„æœåŠ¡æ‰€åœ¨çš„åŸŸæ˜¯HTTPSçš„ï¼Œé‚£ä¹ˆä½¿ç”¨çš„WebSocketåè®®ä¹Ÿå¿…é¡»æ˜¯wss, è€Œä¸èƒ½æ˜¯ws</p>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> websocket </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>&#39;åŸºäºreactæ­å»ºä¸€ä¸ªé€šç”¨çš„è¡¨å•ç®¡ç†é…ç½®å¹³å°ï¼ˆvueåŒï¼‰&#39;</title>
      <link href="/2020/04/25/React/%E5%9F%BA%E4%BA%8Ereact%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%80%9A%E7%94%A8%E7%9A%84%E8%A1%A8%E5%8D%95%E7%AE%A1%E7%90%86%E9%85%8D%E7%BD%AE%E5%B9%B3%E5%8F%B0%EF%BC%88vue%E5%90%8C%EF%BC%89/"/>
      <url>/2020/04/25/React/%E5%9F%BA%E4%BA%8Ereact%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%80%9A%E7%94%A8%E7%9A%84%E8%A1%A8%E5%8D%95%E7%AE%A1%E7%90%86%E9%85%8D%E7%BD%AE%E5%B9%B3%E5%8F%B0%EF%BC%88vue%E5%90%8C%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5ea1af9f518825737a316cc3?utm_source=gold_browser_extension" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘åœ¨åšBç«¯çš„äº§å“ï¼Œå€ŸåŠ©è¯¥åšä¸»çš„æ–‡ç« å­¦ä¹ ä¸‹é€šç”¨è¡¨å•ï¼Œä»¥ä¸‹ä¸ºåšæ–‡ä¿¡æ¯</p><p>è¿™ç¯‡æ–‡ç« æ˜¯ä¸€ç¯‡åº”ç”¨æ€§æå¼ºçš„æ–‡ç« ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…çš„åº”ç”¨åœºæ™¯ï¼Œå»è§£å†³æŸä¸€ç±»çš„é—®é¢˜ï¼Œæä¾›ä¸€ç§æˆ–è€…å‡ ç§è§£å†³æ–¹æ¡ˆï¼Œæ¥æ¢ç´¢æŠ€æœ¯çš„é­…åŠ›ã€‚æ¥ä¸‹æ¥ç¬”è€…ä¸»è¦åˆ†æè¡¨å•å®šåˆ¶å¹³å°çš„å®ç°æ€è·¯å’ŒæŠ€æœ¯æ–¹æ¡ˆï¼Œæ¥å®ç°ä¸€ä¸ªç±»ä¼¼äºé‡‘æ•°æ®æˆ–è€…é—®å·æ˜Ÿä¸€æ ·çš„è¡¨å•é…ç½®å¹³å°ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥åŸºäºæ­¤æ–¹æ¡ˆï¼Œæ‰©å±•å‡ºåŠŸèƒ½æ›´åŠ å¼ºå¤§çš„å¯è§†åŒ–å¹³å°ã€‚</p><h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><p>ä¸ºä»€ä¹ˆè¦åšä¸€ä¸ªè¿™æ ·çš„å¹³å°å‘¢ï¼Ÿä¸€æ–¹é¢æ˜¯å› ä¸ºç¬”è€…å¤šå¹´æ¥ä¸€ç›´æœåŠ¡äºBç«¯äº§å“ï¼Œå¯¹äºåŠ¨æ€è¡¨å•ä»¥åŠé…ç½®åŒ–è¡¨å•æœ‰ä¸€å®šçš„é¡¹ç›®ç§¯ç´¯ï¼Œå¹¶ä¸”æ·±çŸ¥é…ç½®åŒ–è¡¨å•çš„ä»·å€¼æ‰€åœ¨ã€‚ä¸¾ä¸€ä¸ªå¾ˆä¼ ç»Ÿçš„Bç«¯è¡¨å•é…ç½®åŒ–çš„ä¾‹å­ï¼šä¼ ç»Ÿ2Bä¼ä¸šåœ¨æä¾›saasæœåŠ¡æ—¶ï¼Œä¸ºäº†æ»¡è¶³ä¸åŒä¼ä¸šçš„å®šåˆ¶åŒ–éœ€æ±‚ï¼Œå¾€å¾€ä¼šç»™ä¼ä¸šå®¢æˆ·æä¾›å®šåˆ¶åŒ–æˆ–è€…è‡ªç”±é…ç½®çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171a9a5e9f7d001a?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å®šåˆ¶åŒ–"></p><p>å¯¹äºsaasç³»ç»Ÿè€Œè¨€ï¼Œè½¯ä»¶å³æœåŠ¡ï¼Œåœ¨æä¾›åŸºç¡€æœåŠ¡çš„åŒæ—¶ï¼ŒåŒæ ·è¦æ»¡è¶³ç”¨æˆ·ä¸ªæ€§åŒ–éœ€æ±‚ï¼Œæ‰€ä»¥ä¼ ç»Ÿçš„saasè½¯ä»¶æä¾›å•†å¾€å¾€ä¼šæä¾›ç»™å®¢æˆ·è‡ªç”±é…ç½®çš„ç©ºé—´ï¼Œè¿™ç§è‡ªç”±é…ç½®çš„æ¡¥æ¢å°±æ˜¯é€šè¿‡è¡¨å•ï¼Œä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171a9b767e4bb302?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="ç½‘ç«™è¡¨å•"></p><p>é€šè¿‡è¿™ç§æ–¹æ³•å°±å¯ä»¥å®šåˆ¶ä¸åŒé£æ ¼çš„ä¼ä¸šäº§å“ï¼Œè¿™é‡Œåªæ˜¯ä¸¾äº†ä¸ªæ¯”è¾ƒç®€å•çš„ä¾‹å­ï¼Œå¾€å¾€å®é™…é¡¹ç›®ä¸­ä¼šæ›´åŠ å¤æ‚ï¼Œå¯èƒ½ä¼šæœ‰å‡ åä¸ªé…ç½®é¡¹ï¼Œå½“ç„¶è¿™ç§æ¨¡å¼æ˜¯æ¯”è¾ƒä¼ ç»Ÿçš„é…ç½®åŒ–æ–¹æ¡ˆï¼Œä¹Ÿä»…ä»…æ˜¯saasè½¯ä»¶æä¾›çš„å¾ˆå°çš„ä¸€ä¸ªæœåŠ¡æ¨¡å—ã€‚ç›®å‰ä¸»æµçš„åšæ³•æ˜¯é‡‡ç”¨å¯è§†åŒ–æ–¹æ¡ˆï¼Œè€Œä¸”å›½å†…ä¹Ÿæœ‰éå¸¸æˆç†Ÿçš„æ–¹æ¡ˆï¼Œä½†åŸºæœ¬çš„æ€æƒ³æ˜¯ä¸€è‡´çš„ï¼Œåªä¸è¿‡åè€…çš„ä½“éªŒæ›´å¥½ï¼Œæ“ä½œéš¾åº¦æ›´ä½ã€‚</p><p>æœ¬æ–‡ä»‹ç»çš„è¡¨å•å®šåˆ¶å¹³å°,ä¹ŸåŒæ ·æ”¯æŒè¡¨å•ç®¡ç†,è¡¨å•æ•°æ®åˆ†æ, è¡¨å•æ•°æ®æ”¶é›†, è¡¨å•å®šåˆ¶ç­‰åŠŸèƒ½, ç¬”è€…å°†é‡‡ç”¨æ¯”è¾ƒç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆ<code>react</code>ä»¥åŠç¬¬ä¸‰æ–¹uiåº“<code>antd4.0</code>æ¥å¼€å‘, åç«¯é‡‡ç”¨<code>node + koa</code>æ¥è®¾è®¡è·¯ç”±æ¥å£.</p><h2 id="è®¾è®¡æ€è·¯"><a href="#è®¾è®¡æ€è·¯" class="headerlink" title="è®¾è®¡æ€è·¯"></a>è®¾è®¡æ€è·¯</h2><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171aa801e1e7556f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="è®¾è®¡æ€è·¯æ¦‚å†µ"></p><h2 id="å®ç°æ•ˆæœä¸åˆ†æ"><a href="#å®ç°æ•ˆæœä¸åˆ†æ" class="headerlink" title="å®ç°æ•ˆæœä¸åˆ†æ"></a>å®ç°æ•ˆæœä¸åˆ†æ</h2><h3 id="è¡¨å•å®šåˆ¶ç®¡ç†åˆ—è¡¨"><a href="#è¡¨å•å®šåˆ¶ç®¡ç†åˆ—è¡¨" class="headerlink" title="è¡¨å•å®šåˆ¶ç®¡ç†åˆ—è¡¨"></a>è¡¨å•å®šåˆ¶ç®¡ç†åˆ—è¡¨</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171aa823f2fedb04?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="è¡¨å•å®šåˆ¶ç®¡ç†åˆ—è¡¨"></p><p>ç®¡ç†åˆ—è¡¨ä¸»è¦ç”¨æ¥æŸ¥çœ‹æˆ‘ä»¬é…ç½®çš„è¡¨å•æ¨¡æ¿,åˆ†æä¸åŒè¡¨å•æ¨¡æ¿æ”¶é›†çš„æ•°æ®,å¯¹è¡¨å•æ¨¡æ¿è¿›è¡Œç¼–è¾‘åˆ é™¤ç­‰æ“ä½œ.</p><h3 id="è¡¨å•å®šåˆ¶é¡µé¢"><a href="#è¡¨å•å®šåˆ¶é¡µé¢" class="headerlink" title="è¡¨å•å®šåˆ¶é¡µé¢"></a>è¡¨å•å®šåˆ¶é¡µé¢</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171aa83ef454bcbf?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="è¡¨å•å®šåˆ¶é¡µé¢"></p><p>ç”±ä¸Šå›¾å¯çŸ¥è¡¨å•å®šåˆ¶é¡µé¢ä¸»è¦ç”¨æ¥ç¼–è¾‘è‡ªå®šä¹‰è¡¨å•æ¨¡æ¿,æˆ‘ä»¬å¯ä»¥æ·»åŠ è¡¨å•æ ‡é¢˜,è¡¨å•å­—æ®µç­‰,ç›®å‰æä¾›äº†å‡ ç§è‡ªå®šä¹‰è¡¨å•æ§ä»¶å¦‚ä¸‹:</p><ul><li>æ–‡æœ¬æ¡†</li><li>å¤šè¡Œæ–‡æœ¬æ¡†</li><li>ä¸‹æ‹‰æ¡†</li><li>å•é€‰æ¡†</li><li>å¤é€‰æ¡†</li><li>æ–‡ä»¶ä¸Šä¼ æ§ä»¶</li></ul><p>åŸºæœ¬æ¶µç›–äº†æˆ‘ä»¬æ‰€éœ€è¦çš„æ‰€æœ‰è¡¨å•ä¸šåŠ¡åœºæ™¯.ç”±ä¸Šå›¾å¯çŸ¥æˆ‘ä»¬å¯ä»¥åœ¨ä»»æ„ä½ç½®æ’å…¥è‡ªå®šä¹‰å­—æ®µ,åŒæ—¶å¯ä»¥ç¼–è¾‘ä¿®æ”¹åˆ é™¤è¡¨å•å­—æ®µ.å¦‚æœæƒ³è±¡åŠ›å†å¤§ä¸€ç‚¹,æˆ‘ä»¬å¯ä»¥åŸºäºå®ƒæ¥å®ç°ä¸ä»…ä»…æ˜¯è¡¨å•é—®å·å‹åº”ç”¨,è¿˜å¯ä»¥å®ç°ç­”é¢˜,å‘å¸ƒå†…å®¹ç­‰åœºæ™¯.(åæœŸå¯æ”¯æŒå¯Œæ–‡æœ¬æ§ä»¶)</p><h3 id="è‰ç¨¿ç®¡ç†"><a href="#è‰ç¨¿ç®¡ç†" class="headerlink" title="è‰ç¨¿ç®¡ç†"></a>è‰ç¨¿ç®¡ç†</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171aa85da2f9c847?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="è‰ç¨¿ç®¡ç†"></p><p>è‰ç¨¿ç®±è®¾è®¡çš„ç›®çš„æ˜¯æ–¹ä¾¿ä½¿ç”¨è€…åœ¨é…ç½®è¡¨å•çš„è¿‡ç¨‹ä¸­ä¸ç¡®å®šæ˜¯å¦ç¬¦åˆéœ€æ±‚æˆ–è€…ç”±äºæŸç§ä¸´æ—¶æ€§ä¸¾åŠ¨è€Œæ— æ³•ç»§ç»­é…ç½®,è¿™ä¸ªæ—¶å€™å¯ä»¥å°†ä»¥é…ç½®å¥½çš„å†…å®¹å­˜å…¥è‰ç¨¿ç®±,ä¸‹æ¬¡ç»§ç»­ç¼–è¾‘,æ‰€ä»¥ç¬”è€…ä¸“é—¨è®¾è®¡äº†è‰ç¨¿ç®±ç®¡ç†åˆ—è¡¨,ä¸€æ—¦ç”¨æˆ·å­˜åœ¨è‰ç¨¿,ä¼šåœ¨ç®¡ç†é¡µé¢é€šçŸ¥ç”¨æˆ·å¹¶æ˜¾ç¤ºè‰ç¨¿çš„æ•°é‡.ä½œä¸ºä¸€ä¸ªè¿½æ±‚ä½“éªŒçš„æŠ€æœ¯äºº,è¿™ä¸€å—çš„è®¾è®¡è¿˜æ˜¯ç›¸å½“æœ‰å¿…è¦çš„.</p><h3 id="ç”Ÿæˆå‰å°è¡¨å•è®¿é—®é“¾æ¥"><a href="#ç”Ÿæˆå‰å°è¡¨å•è®¿é—®é“¾æ¥" class="headerlink" title="ç”Ÿæˆå‰å°è¡¨å•è®¿é—®é“¾æ¥"></a>ç”Ÿæˆå‰å°è¡¨å•è®¿é—®é“¾æ¥</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171aa88fb0768a72?imageslim" alt="ç”Ÿæˆå‰å°è¡¨å•è®¿é—®é“¾æ¥"></p><p>å½“æˆ‘ä»¬é…ç½®å¥½è¡¨å•ä¹‹å,æˆ‘ä»¬ç‚¹å‡»ä¿å­˜, ä¼šç”Ÿæˆä¸€ä¸ªå‰å°è®¿é—®åœ°å€,å®æ—¶è®¿é—®è¡¨å•ä¿¡æ¯,å¦‚ä¸‹å›¾ä¸ºç‚¹å‡»é“¾æ¥ä¹‹åçš„é¡µé¢:</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171ab3d3341b02e4?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å±•ç¤º"></p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„é£æ ¼,è®¾è®¡è‡ªå·±çš„è¡¨å•å½•å…¥é¡µé¢, å…·ä½“å¦‚ä½•å®ç°è¿™æ ·çš„è¿‡ç¨‹, åé¢æˆ‘ä¼šè¯¦ç»†ä»‹ç».</p><h3 id="æŸ¥çœ‹ç”¨æˆ·å·²æœ‰æ•°æ®å½•å…¥"><a href="#æŸ¥çœ‹ç”¨æˆ·å·²æœ‰æ•°æ®å½•å…¥" class="headerlink" title="æŸ¥çœ‹ç”¨æˆ·å·²æœ‰æ•°æ®å½•å…¥"></a>æŸ¥çœ‹ç”¨æˆ·å·²æœ‰æ•°æ®å½•å…¥</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171aa8e7dcecc4b4?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æŸ¥çœ‹ç”¨æˆ·å·²æœ‰æ•°æ®å½•å…¥1"></p><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171aa8dce347d3c6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æŸ¥çœ‹ç”¨æˆ·å·²æœ‰æ•°æ®å½•å…¥2"></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç‚¹å‡»â€æŸ¥çœ‹æ•°æ®â€æ¥è®¿é—®æ”¶é›†åˆ°çš„è¡¨å•æ•°æ®,å¹¶é€šè¿‡å¯è§†åŒ–çš„å·¥å…·å¯¹æ•°æ®åšåˆ†ææ¯”è¾ƒ,åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ•°æ®åˆ—è¡¨ä¸­åˆ é™¤æ•°æ®,æ¥æ§åˆ¶æˆ‘ä»¬æ•°æ®å±•ç¤ºçš„çº¯å‡€.</p><h3 id="è¡¨å•æ•°æ®åˆ†æ"><a href="#è¡¨å•æ•°æ®åˆ†æ" class="headerlink" title="è¡¨å•æ•°æ®åˆ†æ"></a>è¡¨å•æ•°æ®åˆ†æ</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171aa91ab9128d19?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="è¡¨å•æ•°æ®åˆ†æ"></p><p>æ”¶é›†åˆ°æ•°æ®åªæœ‰,æˆ‘ä»¬ä¼šè‡ªåŠ¨é›†æˆå‡ ä¸ªå¯è§†åŒ–ç»„ä»¶æ¥åˆ†æè¡¨å•æ•°æ®,ä»¥ä¸Šæ˜¯ç¬”è€…åˆ—å‡ºçš„å‡ ä¸ªå¯è§†åŒ–ç»„ä»¶,åŸºäº<code>antv G2</code>æ¥å°è£….</p><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>ä»¥ä¸Šä¸»è¦ä»‹ç»äº†è‡ªå®šä¹‰è¡¨å•å®šåˆ¶å¹³å°çš„ä¸€äº›åŠŸèƒ½å’Œäº¤äº’æ•ˆæœ, æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¯¥å¹³å°åšå¾ˆå¤šæœ‰æ„æ€çš„äº‹æƒ….å› ä¸ºè¡¨å•çš„æŠ½è±¡æ˜¯æ•°æ®,æˆ‘ä»¬æ‹¿åˆ°å®šåˆ¶åŒ–çš„è¡¨å•jsonæ•°æ®ä¹‹å,æˆ‘ä»¬å¯ä»¥æœ‰ä¸åŒçš„å±•ç°å½¢å¼,æ¯”å¦‚ç”¨æˆ·çš„<strong>é—®å·è°ƒæŸ¥, ç½‘ç«™å¹³å°çš„æŠ•ç¥¨, ç­”é¢˜é¡µé¢, å‘å¸ƒåŠ¨æ€</strong>ç­‰åŠŸèƒ½,å¦‚ä¸‹å›¾é…ç½®:</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171ab881a1e07227?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="é…ç½®1"><br><img src="https://user-gold-cdn.xitu.io/2020/4/24/171ab88d11dc893b?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="é…ç½®2"></p><p>ä»¥ä¸Šé…ç½®å¯ä»¥å®ç°ç±»ä¼¼äºå¾®ä¿¡çš„å‘å¸ƒæœ‹å‹åœˆçš„åŠŸèƒ½, ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡å‰ç«¯çš„æ‰‹æ®µæ ¹æ®ç”¨æˆ·å‘è¡¨çš„æ•°æ®æ¸²æŸ“æˆä¸€ä¸ªæœ‹å‹åœˆåˆ—è¡¨.<br>å¦‚æœæˆ‘ä»¬å†æ‰“å¼€è‡ªå·±çš„è„‘æ´ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·é…ç½®ï¼Œé…ç½®ä¸€ä¸ªè¿™æ ·çš„è¡¨å•ï¼Œè¡¨å•åŒ…æ‹¬ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ§ä»¶å’Œnä¸ªæ–‡æœ¬è¾“å…¥æ§ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171ace33e78b037d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æ´»åŠ¨é¡µé¢é…ç½®"></p><p>å°†è¿™æ ·çš„è¡¨å•é…ç½®åˆ°H5ç®¡ç†æ¨¡å—ï¼Œæˆ‘ä»¬<strong>åªéœ€è¦ä¸Šä¼ ä¸‰å¼ å›¾ï¼Œç„¶åå¡«å†™å¥½å¯¹åº”çš„é…æ–‡ï¼Œç„¶ååˆ©ç”¨å¸‚é¢ä¸Šæˆç†Ÿçš„H5å…¨å±æ»šåŠ¨æ’ä»¶ï¼Œå°±èƒ½è½»æ¾çš„å®šåˆ¶å„ç§H5æ´»åŠ¨é¡µé¢äº†</strong>ã€‚è¯¥æ–¹æ¡ˆå·²è¢«ç¬”è€…çš„å¾ˆå¤šå­ç³»ç»Ÿä½¿ç”¨ï¼Œæ•ˆæœè¿˜æ˜¯éå¸¸å¥½çš„ã€‚<br>å½“ç„¶åŸºäºè¯¥å¹³å°ç”šè‡³èƒ½ç›´æ¥é…ç½®å°å‹çš„å®£ä¼ ç½‘ç«™ï¼Œè¿˜æœ‰æ›´å¤šæƒ³è±¡ç©ºé—´ï¼ŒæœŸå¾…å¤§å®¶å»æŒ–æ˜ã€‚</p><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>è¦æƒ³å¼€å‘è¿™æ ·ä¸€ä¸ªè¡¨å•å®šåˆ¶å¹³å°, æ ¸å¿ƒåœ¨äºå¦‚ä½•å®ç°è¡¨å•åŠ¨æ€é…ç½®çš„æœºåˆ¶.è¿™é‡Œç¬”è€…å°†å…¶åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†:<strong>åŸºç¡€è¡¨å•ç‰©æ–™å’Œè¡¨å•ç¼–è¾‘ç”Ÿæˆå™¨</strong>, å¦‚ä¸‹å›¾æ‰€ç¤ºæ‹†åˆ†å›¾:</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/24/171abbf0cdd52a43?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="è¡¨å•å®šåˆ¶æ¨¡å—"></p><h3 id="åŸºç¡€è¡¨å•ç‰©æ–™"><a href="#åŸºç¡€è¡¨å•ç‰©æ–™" class="headerlink" title="åŸºç¡€è¡¨å•ç‰©æ–™"></a>åŸºç¡€è¡¨å•ç‰©æ–™</h3><p>åŸºç¡€è¡¨å•ç‰©æ–™ä¸»è¦æ˜¯ä¸ºäº†ç”¨æˆ·é€‰æ‹©è‡ªå®šä¹‰è¡¨å•æ§ä»¶ä½¿ç”¨ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„è¡¨å•åŠ¨æ€æ¸²æŸ“æœ‰mapå¾ªç¯+æ¡ä»¶åˆ¤æ–­å’Œå•å±‚map+å¯¹è±¡æ³•ï¼Œå‰è€…å¦‚æœè¦æ¸²æŸ“ä¸€ä¸ªåŠ¨æ€è¡¨å•ï¼Œå¯èƒ½å®ç°å¦‚ä¸‹ï¼š</p><pre><code class="js">{    list.map((item, i) =&gt; {        return &lt;React.Fragment key={i}&gt;            {               item.type === &#39;input&#39; &amp;&amp; &lt;Input /&gt;            }            {               item.type === &#39;radio&#39; &amp;&amp; &lt;Radio /&gt;            }            // ...        &lt;/React.Fragment&gt;    })}</code></pre><p>ä½†æ˜¯è¿™æ ·åšæœ‰ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹å°±æ˜¯ä¼šäº§ç”Ÿå¾ˆå¤šæ²¡å¿…è¦çš„åˆ¤æ–­ï¼Œå¦‚æœå¯¹äºå¤æ‚è¡¨å•ï¼Œæ€§èƒ½å¾€å¾€å¾ˆä½ï¼Œæ‰€ä»¥ç¬”è€…é‡‡ç”¨åè€…æ¥å®ç°ï¼Œå¤æ‚åº¦å¯ä»¥é™åˆ°O(n).æˆ‘ä»¬å…ˆæ¥åšé…ç½®æ¨¡ç‰ˆï¼š</p><pre><code class="js">// åŸºç¡€æ¨¡ç‰ˆæ•°æ®const tpl = [  {    label: &#39;æ–‡æœ¬æ¡†&#39;,    placeholder: &#39;è¯·è¾“å…¥å†…å®¹&#39;,    type: &#39;text&#39;,    value: &#39;&#39;,    index: uuid(5)  },  {    label: &#39;å•é€‰æ¡†&#39;,    type: &#39;radio&#39;,    option: [{label: &#39;ç”·&#39;, value: 0}, {label: &#39;å¥³&#39;, value: 1}],    index: uuid(5)  },  {    label: &#39;å¤é€‰æ¡†&#39;,    type: &#39;checkbox&#39;,    option: [{label: &#39;ç”·&#39;, value: 0}, {label: &#39;å¥³&#39;, value: 1}],    index: uuid(5)  },  {    label: &#39;å¤šè¡Œæ–‡æœ¬&#39;,    placeholder: &#39;è¯·è¾“å…¥å†…å®¹&#39;,    type: &#39;textarea&#39;,    index: uuid(5)  },  {    label: &#39;é€‰æ‹©æ¡†&#39;,    placeholder: &#39;è¯·é€‰æ‹©&#39;,    type: &#39;select&#39;,    option: [{label: &#39;ä¸­å›½&#39;, value: 0}, {label: &#39;ä¿„ç½—æ–¯&#39;, value: 1}],    index: uuid(5)  },  {    label: &#39;æ–‡ä»¶ä¸Šä¼ &#39;,    type: &#39;upload&#39;,    index: uuid(5)  }]// æ¨¡ç‰ˆæ¸²æŸ“ç»„ä»¶const tplMap = {  text: {    component: (props) =&gt; {      const { placeholder, label } = props      return &lt;div className={styles.fieldOption}&gt;&lt;span className={styles.fieldLabel}&gt;{label}:&lt;/span&gt;&lt;Input placeholder={placeholder} /&gt;&lt;/div&gt;    }  },  textarea: {    component: (props) =&gt; {      const { placeholder, label } = props      return &lt;div className={styles.fieldOption}&gt;&lt;span className={styles.fieldLabel}&gt;{label}:&lt;/span&gt;&lt;TextArea placeholder={placeholder} /&gt;&lt;/div&gt;    }  },  radio: {    component: (props) =&gt; {      const { option, label } = props      return &lt;div className={styles.fieldOption}&gt;              &lt;span className={styles.fieldLabel}&gt;{label}:&lt;/span&gt;              &lt;Radio.Group&gt;                {                  option &amp;&amp; option.map((item, i) =&gt; {                    return &lt;Radio style={radioStyle} value={item.value} key={item.label}&gt;                      { item.label }                    &lt;/Radio&gt;                  })                }            &lt;/Radio.Group&gt;        &lt;/div&gt;    }  },  checkbox: {    component: (props) =&gt; {      const { option, label } = props      return &lt;div className={styles.fieldOption}&gt;              &lt;span className={styles.fieldLabel}&gt;{label}:&lt;/span&gt;              &lt;Checkbox.Group&gt;                &lt;Row&gt;                  {                    option &amp;&amp; option.map(item =&gt; {                      return &lt;Col span={16} key={item.label}&gt;                              &lt;Checkbox value={item.value} style={{ lineHeight: '32px' }}&gt;                                { item.label }                              &lt;/Checkbox&gt;                            &lt;/Col&gt;                    })                  }                &lt;/Row&gt;            &lt;/Checkbox.Group&gt;        &lt;/div&gt;    }  },  select: {    component: (props) =&gt; {      const { placeholder, option, label } = props      return &lt;div className={styles.fieldOption}&gt;              &lt;span className={styles.fieldLabel}&gt;{label}:&lt;/span&gt;              &lt;Select placeholder={placeholder} style={{width: '100%'}}&gt;                {                  option &amp;&amp; option.map(item =&gt; {                    return &lt;Option value={item.value} key={item.label}&gt;{item.label}&lt;/Option&gt;                  })                }            &lt;/Select&gt;        &lt;/div&gt;    }  },  upload: {    component: (props) =&gt; {      return &lt;div className={styles.fieldOption}&gt;              &lt;span className={styles.fieldLabel}&gt;{props.label}:&lt;/span&gt;              &lt;Upload              listType=&quot;picture-card&quot;              className=&quot;avatar-uploader&quot;              showUploadList={false}              action=&quot;https://www.mocky.io/v2/5cc8019d300000980a055e76&quot;            &gt;              &lt;div&gt;+&lt;/div&gt;            &lt;/Upload&gt;        &lt;/div&gt;    }  }}export {  tpl,  tplMap}</code></pre><p>åŸºç¡€ç‰©æ–™åœ¨ä¸‹å›¾æ‰€ç¤ºä¸­ä½¿ç”¨ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/25/171ad0ca3515ae67?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="åŸºç¡€ç‰©æ–™ä½¿ç”¨"></p><p>å½“æˆ‘ä»¬è¦æ·»åŠ ä¸€ä¸ªè¡¨å•é¡¹æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å·¦è¾¹é¢„è§ˆæ“ä½œåŒºçœ‹åˆ°æ·»åŠ çš„é¡¹ï¼Œå¹¶å¯ä»¥åŸºäºè¡¨å•ç¼–è¾‘ç”Ÿæˆå™¨æ¥ç¼–è¾‘è¡¨å•å­—æ®µã€‚</p><h3 id="è¡¨å•ç¼–è¾‘ç”Ÿæˆå™¨"><a href="#è¡¨å•ç¼–è¾‘ç”Ÿæˆå™¨" class="headerlink" title="è¡¨å•ç¼–è¾‘ç”Ÿæˆå™¨"></a>è¡¨å•ç¼–è¾‘ç”Ÿæˆå™¨</h3><p>è¡¨å•ç¼–è¾‘ç”Ÿæˆå™¨åˆ†ä¸º2éƒ¨åˆ†ï¼Œ ç¬¬ä¸€éƒ¨åˆ†æ˜¯ç”¨æ¥ç”Ÿæˆè¡¨å•é¡¹çš„å®¹å™¨ç»„ä»¶ï¼Œå°è£…äº†æ·»åŠ ï¼Œåˆ é™¤ï¼Œç¼–è¾‘æ“ä½œåŠŸèƒ½ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">// è¡¨å•å®¹å™¨ç»„ä»¶const BaseFormEl = (props) =&gt; {  const {isEdit, onEdit, onDel, onAdd} = props  const handleEdit = (v) =&gt; {    onEdit &amp;&amp; onEdit(v)  }  return &lt;div className={styles.formControl}&gt;    &lt;div className={styles.formItem}&gt;{ props.children }&lt;/div&gt;    &lt;div className={styles.actionBar}&gt;      &lt;span className={styles.actionItem} onClick={onDel}&gt;&lt;MinusCircleOutlined /&gt;&lt;/span&gt;      &lt;span className={styles.actionItem} onClick={onAdd}&gt;&lt;PlusCircleOutlined /&gt;&lt;/span&gt;      &lt;span className={styles.actionItem} onClick={handleEdit}&gt;&lt;EditOutlined /&gt;&lt;/span&gt;    &lt;/div&gt;  &lt;/div&gt;}</code></pre><p>ç¬¬äºŒéƒ¨åˆ†ä¸»è¦ç”¨æ¥æ¸²æŸ“æ“ä½œåŒºæ¨¡ç‰ˆï¼ŒåŸºäºBaseFormElåŒ…è£…ä¸åŒç±»å‹çš„è¡¨å•ç»„ä»¶, è¿™é‡Œä¸¾ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„selectæ¥è¯´æ˜ï¼Œå…¶ä»–è¡¨å•æ§ä»¶ç±»ä¼¼ï¼š</p><pre><code class="js">const formMap = {  title: {},  text: {},  textarea: {},  radio: {},  checkbox: {},  select: {    component: (props) =&gt; {      const { onDel, onAdd, onEdit, curIndex, index, type, label, placeholder, required, message, option } = props      return &lt;BaseFormEl         onDel={onDel.bind(this, index)}        onAdd={onAdd.bind(this, index)}        onEdit={onEdit.bind(this, {index, type, placeholder, label, option, required})}        isEdit={curIndex === index}      &gt;        &lt;Form.Item name={label} label={label} rules={[{ message, required }]}&gt;          &lt;Select placeholder={placeholder}&gt;            {              option &amp;&amp; option.map(item =&gt; {                return &lt;Option value={item.value} key={item.label}&gt;{item.label}&lt;/Option&gt;              })            }          &lt;/Select&gt;        &lt;/Form.Item&gt;      &lt;/BaseFormEl&gt;    },    editAttrs: [      {        title: &#39;å­—æ®µåç§°&#39;,        key: &#39;label&#39;      },      {        title: &#39;é€‰é¡¹&#39;,        key: &#39;option&#39;      },      {        title: &#39;æç¤ºæ–‡æœ¬&#39;,        key: &#39;placeholder&#39;      },      {        title: &#39;æ˜¯å¦å¿…å¡«&#39;,        key: &#39;required&#39;      },    ]  },  upload: {}}</code></pre><p>editAttrsä¸»è¦ç”¨æ¥æ¸²æŸ“ç¼–è¾‘åˆ—è¡¨ï¼Œè¯´æ˜å“ªäº›è¡¨å•é¡¹å¯ä»¥ç¼–è¾‘ï¼Œè¿™éƒ¨åˆ†ä»£ç æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œç›´æ¥ç”¨å›¾ä¸¾ä¾‹ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/25/171ad19928734c82?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="åœ¨çº¿è¡¨å•åˆ¶ä½œå¹³å°"></p><p>æœ€åæˆ‘ä»¬æ¥æ¸²æŸ“è¡¨å•ç”Ÿæˆå™¨ç»„ä»¶ï¼š</p><pre><code class="js">export default (props) =&gt; {  const {     formData,     handleDelete,     handleAdd,     handleEdit,     curEditRowIdx   } = props  return &lt;Form name=&quot;customForm&quot;&gt;            {              formData &amp;&amp; formData.map(item =&gt; {                let CP = formMap[item.type].component                return &lt;CP {...item} key={item.index}                  onDel={handleDelete}                   onAdd={handleAdd}                  onEdit={handleEdit}                  curIndex={curEditRowIdx}                /&gt;              })            }         &lt;/Form&gt;}</code></pre><p>è‡³æ­¤ï¼ŒåŸºæœ¬åŠŸèƒ½æ¨¡å—å·²ç»å¼€å‘å®Œæˆï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™äº›ç‰©æ–™å’Œç»„ä»¶å¯¼å…¥åˆ°ç¼–è¾‘é¡µé¢ï¼ŒåŸºäºä¸šåŠ¡æ¥æ“ä½œå’Œè¯·æ±‚å³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> React/Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React/Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼ºå¤§çš„CSS:æ–‡å­—ä¸‹æ³¢æµªçº¿åŠ¨ç”»æ•ˆæœ</title>
      <link href="/2020/04/23/CSS3/%E5%BC%BA%E5%A4%A7%E7%9A%84CSS-%E6%96%87%E5%AD%97%E4%B8%8B%E6%B3%A2%E6%B5%AA%E7%BA%BF%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C/"/>
      <url>/2020/04/23/CSS3/%E5%BC%BA%E5%A4%A7%E7%9A%84CSS-%E6%96%87%E5%AD%97%E4%B8%8B%E6%B3%A2%E6%B5%AA%E7%BA%BF%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.imooc.com/article/286988" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><p><img src="http://upload-images.jianshu.io/upload_images/13133049-963e2b89fb9da2ad.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="wave"></p><p>ç±»ä¼¼ä¸‹é¢è¿™ç§æ•ˆæœ<br><img src="http://upload-images.jianshu.io/upload_images/13133049-03fa0c4c990af8f1.gif?imageMogr2/auto-orient/strip" alt="text wave"></p><p>æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼å¯ä»¥å®ç°è¿™ç§æ•ˆæœ</p><h2 id="å¾„å‘æ¸å˜çº¯CSSçš„æ–¹å¼"><a href="#å¾„å‘æ¸å˜çº¯CSSçš„æ–¹å¼" class="headerlink" title="å¾„å‘æ¸å˜çº¯CSSçš„æ–¹å¼"></a>å¾„å‘æ¸å˜çº¯CSSçš„æ–¹å¼</h2><p>å°±æ˜¯ä½¿ç”¨å¾„å‘æ¸å˜ç»˜åˆ¶æˆ‘ä»¬çš„æ³¢æµªçº¿æ•ˆæœï¼Œä¸€ä¸ªæ³¢æµªçº¿å¾ªç¯æ®µæ˜¯æœ‰ä¸€ä¸ªæœä¸Šçš„åŠä¸ªåœ†å¼§å’Œä¸€ä¸ªæœä¸‹çš„åŠä¸ªåœ†å¼§ç»„åˆè€Œæˆçš„ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦ä½¿ç”¨å¾„å‘æ¸å˜ç»˜åˆ¶åœ†å¼§ï¼Œå†é€šè¿‡<code>background-position</code>æ§åˆ¶ä¸¤ä¸ªåœ†å¼§çš„ä½ç½®ï¼Œè®©å…¶å‰åæ‹¼æ¥åœ¨ä¸€èµ·å°±å¯ä»¥å®ç°æ³¢æµªçº¿æ•ˆæœã€‚</p><p>ç›¸å…³CSSä»£ç </p><pre><code class="css">.flow-wave {    background: radial-gradient(circle at 10px -7px, transparent 8px, currentColor 8px, currentColor 9px, transparent 9px) repeat-x,        radial-gradient(circle at 10px 27px, transparent 8px, currentColor 8px, currentColor 9px, transparent 9px) repeat-x;    background-size: 20px 20px;    background-position: -10px calc(100% + 16px), 0 calc(100% - 4px);}</code></pre><p>å®æ—¶æ•ˆæœå¦‚ä¸‹ï¼š<br>æœ‰äº†é™æ€çš„æ³¢æµªçº¿æ•ˆæœï¼Œå‰©ä¸‹çš„å°±åƒè¿™ä¸ªæ³¢æµªçº¿åŠ¨èµ·æ¥ï¼Œç”¨<code>CSS3 animation</code>åŠ¨ç”»æ§åˆ¶<code>background-position</code>ä½ç½®å³å¯ã€‚</p><pre><code class="css">.flow-wave {    animation: waveFlow 1s infinite linear;}@keyframes waveFlow {    from { background-position-x: -10px, 0; }    to { background-position-x: -30px, -20px; }}</code></pre><p>äºæ˜¯æ³¢æµªçº¿åŠ¨ç”»æ•ˆæœå°±å®ç°äº†ã€‚</p><p>è¿™ç§æ–¹æ³•å®ç°çš„ä¼˜ç‚¹æ˜¯é¢œè‰²æ§åˆ¶éå¸¸æ–¹ä¾¿ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¿®æ”¹æ–‡å­—é¢œè‰²ä¸ºåŸè°…ç»¿ï¼Œå¼¯å¼¯æ°´æ³¢çš„é¢œè‰²ä¹Ÿå˜æˆäº†åŸè°…ç»¿ï¼š</p><p>æ­¤æ–¹æ³•å®ç°çš„ä¸è¶³å°±æ˜¯ï¼šç†è§£æˆæœ¬æœ‰ç‚¹é«˜ï¼Œå¦‚ä½•ä½¿ç”¨CSS radial-gradientæ¨¡æ‹Ÿæ³¢æµªçº¿æ•ˆæœæ˜¯éœ€è¦ç›¸å½“çš„CSSåŠŸåŠ›ç§¯ç´¯çš„ï¼Œä¸Šæ‰‹ä¸å¤ªå®¹æ˜“ï¼Œä»¥åè¦ä¿®æ”¹ä¸ªå°ºå¯¸ä»€ä¹ˆçš„ä¹Ÿä¸å¤ªå¥½ç»´æŠ¤ã€‚åŒæ—¶ï¼Œåœ¨æ™®é€šå±å¹•å¯†åº¦å±å¹•ä¸‹çš„Chromeæµè§ˆå™¨ä¸Šï¼Œçº¿æ¡å¹¶ä¸å¹³æ»‘ï¼Œå¹æ¯›æ±‚ç–µçš„è®¾è®¡å¸ˆä¸ä¸€å®šä¼šæ¥å—ã€‚</p><p>æ­¤æ—¶ï¼Œå¯ä»¥è¯•è¯•ä¸‹é¢è¿™ç§æ›´åˆ©äºç†è§£çš„æ–¹æ³•ã€‚</p><h2 id="ä½¿ç”¨SVGæ³¢å½¢çŸ¢é‡å›¾ä½œä¸ºèƒŒæ™¯"><a href="#ä½¿ç”¨SVGæ³¢å½¢çŸ¢é‡å›¾ä½œä¸ºèƒŒæ™¯" class="headerlink" title="ä½¿ç”¨SVGæ³¢å½¢çŸ¢é‡å›¾ä½œä¸ºèƒŒæ™¯"></a>ä½¿ç”¨SVGæ³¢å½¢çŸ¢é‡å›¾ä½œä¸ºèƒŒæ™¯</h2><p>å°±æ˜¯æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä¸€ä¸ªä½¿ç”¨SVGæ³¢å½¢çŸ¢é‡å›¾ä½œä¸ºèƒŒæ™¯ï¼Œä¸ç”¨è‡ªå·±å»æ‰‹åŠ¨CSSç»˜åˆ¶ï¼Œä»£ç é‡å·®ä¸å¤šï¼Œè¿˜æ›´å®¹æ˜“ç†è§£ã€‚CSSä»£ç ç¤ºæ„ï¼š</p><pre><code class="css">svg-wave {    background: url(&quot;data:image/svg+xml,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; viewBox=&#39;0 0 20 4&#39;%3E%3Cpath fill=&#39;none&#39; stroke=&#39;%23333&#39; d=&#39;M0 3.5c5 0 5-3 10-3s5 3 10 3 5-3 10-3 5 3 10 3&#39;/%3E%3C/svg%3E&quot;) repeat-x 0 100%;     background-size: 20px auto;}</code></pre><p>å®æ—¶æ•ˆæœå¦‚ä¸‹ï¼š</p><p>æœ‰äº†é™æ€çš„æ³¢æµªçº¿æ•ˆæœï¼Œå‰©ä¸‹çš„å°±åƒè¿™ä¸ªæ³¢æµªçº¿åŠ¨èµ·æ¥ï¼Œç”¨<code>CSS3 animation</code>åŠ¨ç”»æ§åˆ¶<code>background-position</code>ä½ç½®å³å¯ã€‚</p><pre><code class="css">.svg-wave {    animation: waveMove 1s infinite linear;}@keyframes waveMove {    from { background-position: 0 100%; }    to   { background-position: -20px 100%; }}</code></pre><p>ä¼˜ç‚¹æ˜¯çº¿æ¡è¾¹ç¼˜å¹³æ»‘ï¼Œæ•ˆæœç»†è…»ï¼Œæ˜“ç†è§£ï¼Œæ˜“ä¸Šæ‰‹ï¼Œæ˜“ç»´æŠ¤ã€‚</p><p>ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯æ³¢æµªçº¿çš„é¢œè‰²æ— æ³•å®æ—¶è·Ÿç€æ–‡å­—çš„é¢œè‰²å‘ç”Ÿå˜åŒ–ï¼Œé€‚ç”¨äºæ–‡å­—é¢œè‰²ä¸ä¼šå¤šå˜çš„åœºæ™¯ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦æ”¹å˜æ³¢æµªçº¿çš„é¢œè‰²ä¹Ÿå¾ˆç®€å•ï¼Œä¿®æ”¹<code>background</code>ä»£ç ä¸­çš„<code>stroke=&#39;%23333&#39;</code>è¿™éƒ¨åˆ†ï¼Œâ€™%23â€™å°±æ˜¯å°±æ˜¯#ï¼Œå› æ­¤ï¼Œ<code>stroke=&#39;%23333&#39;</code>å…¶å®å°±æ˜¯<code>stroke=&#39;#333&#39;</code>çš„æ„æ€ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦æ”¹æˆçº¢è‰²ç•¥å¸¦æ©™è‰²ï¼Œå¯ä»¥<code>stroke=&#39;%23F30&#39;</code>ï¼Œä¹Ÿå¯ä»¥å†™å®Œæ•´<code>stroke=&#39;%23FF3300&#39;</code>ã€‚</p><h2 id="text-decoration"><a href="#text-decoration" class="headerlink" title="text-decoration"></a>text-decoration</h2><p><code>text-decoration</code>å±æ€§æ—©å·²æ”¯æŒæ³¢æµªçº¿ä¸‹åˆ’çº¿ï¼š</p><pre><code class="css">text-decoration-style: wavy;</code></pre><p>æ•ˆæœå¦‚ä¸‹æˆªå›¾ï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/13133049-0b1b797b8f9d40aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="text-decoration-style"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œçº¿å¥½ç²—å¥½ä¸åè°ƒï¼Œè€Œä¸”å­—ç¬¦å’Œè£…é¥°çº¿å‘ç”Ÿé‡å çš„æ—¶å€™ï¼Œè£…é¥°çº¿ç›´æ¥æ¶ˆå¤±äº†ï¼Œç»“æœæ³¢æµªçº¿å˜æˆäº†ä¸€æˆªä¸€æˆªçš„ï¼Œè¿˜éœ€è¦ä½¿ç”¨text-decoration-skipè¿›è¡Œé¢å¤–æ§åˆ¶ã€‚å› æ­¤ï¼Œå®é™…å¼€å‘ï¼Œä¸å»ºè®®åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</p><p>è€Œä¸”ä½ æ— æ³•é¢„çŸ¥æ¯ä¸ªæ³¢æµªçº¿é‡å¤ç‰‡æ®µçš„å®½åº¦ï¼Œæƒ³è¦æ— é™è¿åŠ¨ç†è®ºä¸Šå°±ä¸å¤ªå¯è¡Œã€‚</p><p>å› æ­¤ï¼Œæ–‡å­—æˆ–è€…å›¾å½¢çš„æ³¢æµªçº¿åŠ¨ç”»æ•ˆæœä¸èƒ½ä½¿ç”¨text-decorationçš„æ³¢æµªçº¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°¤é›¨æºªåœ¨Vue3.0 Betaç›´æ’­é‡ŒèŠåˆ°äº†è¿™äº›â€¦</title>
      <link href="/2020/04/22/Vue/%E5%B0%A4%E9%9B%A8%E6%BA%AA%E5%9C%A8Vue3-0-Beta%E7%9B%B4%E6%92%AD%E9%87%8C%E8%81%8A%E5%88%B0%E4%BA%86%E8%BF%99%E4%BA%9B%E2%80%A6/"/>
      <url>/2020/04/22/Vue/%E5%B0%A4%E9%9B%A8%E6%BA%AA%E5%9C%A8Vue3-0-Beta%E7%9B%B4%E6%92%AD%E9%87%8C%E8%81%8A%E5%88%B0%E4%BA%86%E8%BF%99%E4%BA%9B%E2%80%A6/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5e9f6b3251882573a855cd52?utm_source=gold_browser_extension#heading-15" target="_blank" rel="noopener">åŸæ–‡åœ°å€(https://juejin.im/post/5e9f6b3251882573a855cd52?utm_source=gold_browser_extension#heading-15)</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>4æœˆ21æ—¥æ™šï¼ŒVueä½œè€…å°¤é›¨æºªåœ¨å“”å“©å“”å“©ç›´æ’­åˆ†äº«äº†Vue.js 3.0 Betaæœ€æ–°è¿›å±•ã€‚ ä»¥ä¸‹æ˜¯ç›´æ’­å†…å®¹æ•´ç†</p><h2 id="å…¨æ–°æ–‡æ¡£RFCs"><a href="#å…¨æ–°æ–‡æ¡£RFCs" class="headerlink" title="å…¨æ–°æ–‡æ¡£RFCs"></a>å…¨æ–°æ–‡æ¡£RFCs</h2><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719da838e76e8c7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å…¨æ–°æ–‡æ¡£RFCs"></p><p><code>Vue.js 3.0 Beta</code>å‘å¸ƒåçš„å·¥ä½œé‡ç‚¹æ˜¯ä¿è¯ç¨³å®šæ€§å’Œæ¨è¿›å„ç±»åº“é›†æˆ</p><p>æ‰€æœ‰çš„è¿›åº¦å’Œæ–‡æ¡£éƒ½å°†åœ¨å…¨æ–°<code>RFCs</code>æ–‡æ¡£å¯ä»¥çœ‹åˆ°ã€‚</p><h2 id="å…­å¤§äº®ç‚¹"><a href="#å…­å¤§äº®ç‚¹" class="headerlink" title="å…­å¤§äº®ç‚¹"></a>å…­å¤§äº®ç‚¹</h2><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719daca80f3b7c2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å…­å¤§äº®ç‚¹"></p><blockquote><ul><li>Performanceï¼šæ€§èƒ½æ›´æ¯”Vue 2.0å¼ºã€‚</li><li>Tree shaking supportï¼šå¯ä»¥å°†æ— ç”¨æ¨¡å—â€œå‰ªè¾‘â€ï¼Œä»…æ‰“åŒ…éœ€è¦çš„ã€‚</li><li>Composition APIï¼šç»„åˆAPI</li><li>Fragment, Teleport, Suspenseï¼šâ€œç¢ç‰‡â€ï¼ŒTeleportå³Protalä¼ é€é—¨ï¼Œâ€œæ‚¬å¿µâ€</li><li>Better TypeScript supportï¼šæ›´ä¼˜ç§€çš„Tsæ”¯æŒ</li><li>Custom Renderer APIï¼šæš´éœ²äº†è‡ªå®šä¹‰æ¸²æŸ“API</li></ul></blockquote><h3 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/21/1719d6747e723d03?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Performance"></p><ul><li><ol><li>é‡å†™äº†è™šæ‹ŸDomçš„å®ç°ï¼ˆä¸”ä¿è¯äº†å…¼å®¹æ€§ï¼Œè„±ç¦»æ¨¡ç‰ˆçš„æ¸²æŸ“éœ€æ±‚æ—ºç››ï¼‰ã€‚</li></ol></li><li><ol start="2"><li>ç¼–è¯‘æ¨¡æ¿çš„ä¼˜åŒ–ã€‚</li></ol></li><li><ol start="3"><li>æ›´é«˜æ•ˆçš„ç»„ä»¶åˆå§‹åŒ–ã€‚</li></ol></li><li><ol start="4"><li>updateæ€§èƒ½æé«˜1.3~2å€ã€‚</li></ol></li><li><ol start="5"><li>SSRé€Ÿåº¦æé«˜äº†2~3å€ã€‚</li></ol></li></ul><p>ä¸‹é¢æ˜¯å„é¡¹æ€§èƒ½å¯¹æ¯”</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719db04999e3890?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æ€§èƒ½å¯¹æ¯”"></p><h4 id="è¦ç‚¹1ï¼šç¼–è¯‘æ¨¡æ¿çš„ä¼˜åŒ–"><a href="#è¦ç‚¹1ï¼šç¼–è¯‘æ¨¡æ¿çš„ä¼˜åŒ–" class="headerlink" title="è¦ç‚¹1ï¼šç¼–è¯‘æ¨¡æ¿çš„ä¼˜åŒ–"></a>è¦ç‚¹1ï¼šç¼–è¯‘æ¨¡æ¿çš„ä¼˜åŒ–</h4><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e59cd0f2b668?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="ç¼–è¯‘æ¨¡æ¿çš„ä¼˜åŒ–"></p><p>å‡è®¾è¦ç¼–è¯‘ä»¥ä¸‹ä»£ç </p><pre><code class="js">&lt;div&gt;  &lt;span/&gt;  &lt;span&gt;{{ msg }}&lt;/span&gt;&lt;/div&gt;</code></pre><pre><code class="js">import { createVNode as _createVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createBlock as _createBlock } from &quot;vue&quot;export function render(_ctx, _cache) {  return (_openBlock(), _createBlock(&quot;div&quot;, null, [    _createVNode(&quot;span&quot;, null, &quot;static&quot;),    _createVNode(&quot;span&quot;, null, _toDisplayString(_ctx.msg), 1 /* TEXT */)  ]))}// Check the console for the AST</code></pre><p>æ³¨æ„çœ‹ç¬¬äºŒä¸ª<code>_createVNode</code>ç»“å°¾çš„â€œ1â€ï¼š</p><p>Vueåœ¨è¿è¡Œæ—¶ä¼šç”Ÿæˆnumberï¼ˆå¤§äº0ï¼‰å€¼çš„<code>PatchFlag</code>ï¼Œç”¨ä½œæ ‡è®°ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e69419edbc4d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æ ‡è®°"></p><p>ä»…å¸¦æœ‰<code>PatchFlag</code>æ ‡è®°çš„èŠ‚ç‚¹ä¼šè¢«çœŸæ­£è¿½è¸ªï¼Œä¸”æ— è®ºå±‚çº§åµŒå¥—å¤šæ·±ï¼Œå®ƒçš„åŠ¨æ€èŠ‚ç‚¹éƒ½ç›´æ¥ä¸<code>Block</code>æ ¹èŠ‚ç‚¹ç»‘å®šï¼Œæ— éœ€å†å»éå†é™æ€èŠ‚ç‚¹</p><p>å†çœ‹ä»¥ä¸‹ä¾‹å­ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e6d7d3efe7f1?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="ä¾‹å­2"></p><pre><code class="js">&lt;div&gt;  &lt;span&gt;static&lt;/span&gt;  &lt;span :id=&quot;hello&quot; class=&quot;bar&quot;&gt;{{ msg }}   &lt;/span&gt;&lt;/div&gt;</code></pre><pre><code class="js">import { createVNode as _createVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createBlock as _createBlock } from &quot;vue&quot;export function render(_ctx, _cache) {  return (_openBlock(), _createBlock(&quot;div&quot;, null, [    _createVNode(&quot;span&quot;, null, &quot;static&quot;),    _createVNode(&quot;span&quot;, {      id: _ctx.hello,      class: &quot;bar&quot;    }, _toDisplayString(_ctx.msg), 9 /* TEXT, PROPS */, [&quot;id&quot;])  ]))}</code></pre><a id="more"></a><p><code>PatchFlag</code> å˜æˆäº†<code>9 /* TEXT, PROPS */, [&quot;id&quot;]</code><br>å®ƒä¼šå‘ŠçŸ¥æˆ‘ä»¬ä¸å…‰æœ‰TEXTå˜åŒ–ï¼Œè¿˜æœ‰PROPSå˜åŒ–ï¼ˆidï¼‰<br>è¿™æ ·æ—¢è·³å‡ºäº†<code>virtual dom</code>æ€§èƒ½çš„ç“¶é¢ˆï¼Œåˆä¿ç•™äº†å¯ä»¥æ‰‹å†™<code>render</code>çš„çµæ´»æ€§ã€‚<br>ç­‰äºæ˜¯ï¼šæ—¢æœ‰reactçš„çµæ´»æ€§ï¼Œåˆæœ‰åŸºäºæ¨¡æ¿çš„æ€§èƒ½ä¿è¯ã€‚</p><h4 id="è¦ç‚¹2-äº‹ä»¶ç›‘å¬ç¼“å­˜ï¼šcacheHandlers"><a href="#è¦ç‚¹2-äº‹ä»¶ç›‘å¬ç¼“å­˜ï¼šcacheHandlers" class="headerlink" title="è¦ç‚¹2: äº‹ä»¶ç›‘å¬ç¼“å­˜ï¼šcacheHandlers"></a>è¦ç‚¹2: äº‹ä»¶ç›‘å¬ç¼“å­˜ï¼šcacheHandlers</h4><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e775146d5a84?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="cacheHandlers"></p><p>å‡è®¾æˆ‘ä»¬è¦ç»‘å®šä¸€ä¸ªäº‹ä»¶ï¼š</p><pre><code class="html">&lt;div&gt;  &lt;span @click=&quot;onClick&quot;&gt;    {{msg}}  &lt;/span&gt;&lt;/div&gt;</code></pre><p>å…³é—­<code>cacheHandlers</code>åï¼š</p><pre><code class="js">import { toDisplayString as _toDisplayString, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from &quot;vue&quot;export function render(_ctx, _cache) {  return (_openBlock(), _createBlock(&quot;div&quot;, null, [    _createVNode(&quot;span&quot;, { onClick: _ctx.onClick }, _toDisplayString(_ctx.msg), 9 /* TEXT, PROPS */, [&quot;onClick&quot;])  ]))}</code></pre><p><code>onClick</code>ä¼šè¢«è§†ä¸º<code>PROPS</code>åŠ¨æ€ç»‘å®šï¼Œåç»­æ›¿æ¢ç‚¹å‡»äº‹ä»¶æ—¶éœ€è¦è¿›è¡Œæ›´æ–°ã€‚</p><p>å¼€å¯<code>cacheHandlers</code>åï¼š</p><pre><code class="js">import { toDisplayString as _toDisplayString, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from &quot;vue&quot;export function render(_ctx, _cache) {  return (_openBlock(), _createBlock(&quot;div&quot;, null, [    _createVNode(&quot;span&quot;, {      onClick: _cache[1] || (_cache[1] = $event =&gt; (_ctx.onClick($event)))    }, _toDisplayString(_ctx.msg), 1 /* TEXT */)  ]))}</code></pre><p><code>cache[1]</code>ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆå¹¶ç¼“å­˜ä¸€ä¸ªå†…è”å‡½æ•°ï¼Œâ€œç¥å¥‡â€çš„å˜ä¸ºä¸€ä¸ªé™æ€èŠ‚ç‚¹ã€‚ Psï¼šç›¸å½“äº<code>Reactä¸­useCallback</code>è‡ªåŠ¨åŒ–ã€‚</p><p>å¹¶ä¸”æ”¯æŒæ‰‹å†™å†…è”å‡½æ•°ï¼š</p><pre><code class="html">&lt;div&gt;  &lt;span @click=&quot;()=&gt;foo()&quot;&gt;    {{msg}}  &lt;/span&gt;&lt;/div&gt;</code></pre><p>è¡¥å……ï¼š<code>PatchFlags</code>æšä¸¾å®šä¹‰</p><p>è€Œé€šè¿‡æŸ¥è¯¢Tsæšä¸¾å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ†åˆ«å®šä¹‰äº†ä»¥ä¸‹çš„è¿½è¸ªæ ‡è®°ï¼š</p><pre><code class="js">export const enum PatchFlags {  TEXT = 1,// è¡¨ç¤ºå…·æœ‰åŠ¨æ€textContentçš„å…ƒç´   CLASS = 1 &lt;&lt; 1,  // è¡¨ç¤ºæœ‰åŠ¨æ€Classçš„å…ƒç´   STYLE = 1 &lt;&lt; 2,  // è¡¨ç¤ºåŠ¨æ€æ ·å¼ï¼ˆé™æ€å¦‚style=&quot;color: red&quot;ï¼Œä¹Ÿä¼šæå‡è‡³åŠ¨æ€ï¼‰  PROPS = 1 &lt;&lt; 3,  // è¡¨ç¤ºå…·æœ‰éç±»/æ ·å¼åŠ¨æ€é“å…·çš„å…ƒç´ ã€‚  FULL_PROPS = 1 &lt;&lt; 4,  // è¡¨ç¤ºå¸¦æœ‰åŠ¨æ€é”®çš„é“å…·çš„å…ƒç´ ï¼Œä¸ä¸Šé¢ä¸‰ç§ç›¸æ–¥  HYDRATE_EVENTS = 1 &lt;&lt; 5,  // è¡¨ç¤ºå¸¦æœ‰äº‹ä»¶ç›‘å¬å™¨çš„å…ƒç´   STABLE_FRAGMENT = 1 &lt;&lt; 6,   // è¡¨ç¤ºå…¶å­é¡ºåºä¸å˜çš„ç‰‡æ®µï¼ˆæ²¡æ‡‚ï¼‰ã€‚   KEYED_FRAGMENT = 1 &lt;&lt; 7, // è¡¨ç¤ºå¸¦æœ‰é”®æ§æˆ–éƒ¨åˆ†é”®æ§å­å…ƒç´ çš„ç‰‡æ®µã€‚  UNKEYED_FRAGMENT = 1 &lt;&lt; 8, // è¡¨ç¤ºå¸¦æœ‰æ— keyç»‘å®šçš„ç‰‡æ®µ  NEED_PATCH = 1 &lt;&lt; 9,   // è¡¨ç¤ºåªéœ€è¦éå±æ€§è¡¥ä¸çš„å…ƒç´ ï¼Œä¾‹å¦‚refæˆ–hooks  DYNAMIC_SLOTS = 1 &lt;&lt; 10,  // è¡¨ç¤ºå…·æœ‰åŠ¨æ€æ’æ§½çš„å…ƒç´   // ç‰¹æ®Š FLAGS -------------------------------------------------------------  HOISTED = -1,  // ç‰¹æ®Šæ ‡å¿—æ˜¯è´Ÿæ•´æ•°è¡¨ç¤ºæ°¸è¿œä¸ä¼šç”¨ä½œdiff,åªéœ€æ£€æŸ¥ patchFlag === FLAG.  BAIL = -2 // ä¸€ä¸ªç‰¹æ®Šçš„æ ‡å¿—ï¼ŒæŒ‡ä»£å·®å¼‚ç®—æ³•ï¼ˆæ²¡æ‡‚ï¼‰}</code></pre><p>æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹æºç ï¼š<code>packages/shared/src/patchFlags.ts</code></p><h3 id="Tree-shaking-support"><a href="#Tree-shaking-support" class="headerlink" title="Tree shaking support"></a>Tree shaking support</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719db10e9e06382?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Tree shaking support"></p><ul><li>å¯ä»¥å°†æ— ç”¨æ¨¡å—â€œå‰ªè¾‘â€ï¼Œä»…æ‰“åŒ…éœ€è¦çš„ï¼ˆæ¯”å¦‚<code>v-model</code>,<code>&lt;transition&gt;</code>ï¼Œç”¨ä¸åˆ°å°±ä¸ä¼šæ‰“åŒ…ï¼‰ã€‚</li><li>ä¸€ä¸ªç®€å•â€œHelloWorldâ€å¤§å°ä»…ä¸ºï¼š13.5kb11.75kbï¼Œä»…Composition APIã€‚</li><li>åŒ…å«è¿è¡Œæ—¶å®Œæ•´åŠŸèƒ½ï¼š22.5kb,æ‹¥æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œå´æ¯”Vue 2æ›´è¿·ä½ ã€‚</li></ul><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ vueæä¾›çš„æ‰€æœ‰åŠŸèƒ½ï¼Œåœ¨ vue 2 å¹¶æ²¡æœ‰æ–¹å¼æ’é™¤æ‰ï¼Œä½†æ˜¯ 3.0 éƒ½å¯èƒ½åšæˆäº†æŒ‰éœ€å¼•å…¥ã€‚</p><h3 id="Composition-API"><a href="#Composition-API" class="headerlink" title="Composition API"></a>Composition API</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719dc2469bd375c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Composition API"></p><p>ä¸React Hooks ç±»ä¼¼çš„ä¸œè¥¿ï¼Œå®ç°æ–¹å¼ä¸åŒã€‚</p><ul><li>å¯ä¸ç°æœ‰çš„ Options APIä¸€èµ·ä½¿ç”¨</li><li>çµæ´»çš„é€»è¾‘ç»„åˆä¸å¤ç”¨</li><li>vue 3çš„å“åº”å¼æ¨¡å—å¯ä»¥å’Œå…¶ä»–æ¡†æ¶æ­é…ä½¿ç”¨</li></ul><p>æ··å…¥<code>(mixin)</code> å°†ä¸å†ä½œä¸ºæ¨èä½¿ç”¨ï¼Œ <code>Composition API</code>å¯ä»¥å®ç°æ›´çµæ´»ä¸”æ— å‰¯ä½œç”¨çš„å¤ç”¨ä»£ç ã€‚</p><p>æ„Ÿå…´è¶£çš„å¯ä»¥æŸ¥çœ‹ï¼š<a href="https://composition-api.vuejs.org/#summary" target="_blank" rel="noopener">composition-api.vuejs.org/#summary</a></p><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719dc20717835c1?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="omposition-api.vuejs.org"></p><p>Composition APIåŒ…å«äº†å…­ä¸ªä¸»è¦API</p><p><a href="https://composition-api.vuejs.org/api.html#setup" target="_blank" rel="noopener">composition-api.vuejs.org/api.html#setup</a></p><p>Psï¼šå…¶å®ƒçš„å‡ä¸ºå¸¸è§çš„å·¥å…·å‡½æ•°ï¼Œå¯å…ˆå¿½ç•¥ä¸çœ‹ã€‚</p><h3 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719dcd5c5f2b631?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Fragment"></p><p>Fragmentç¿»è¯‘ä¸ºï¼šâ€œç¢ç‰‡â€</p><ul><li>ä¸å†é™äºæ¨¡æ¿ä¸­çš„å•ä¸ªæ ¹èŠ‚ç‚¹</li><li>render å‡½æ•°ä¹Ÿå¯ä»¥è¿”å›æ•°ç»„äº†ï¼Œç±»ä¼¼å®ç°äº† React.Fragments çš„åŠŸèƒ½ ã€‚</li><li>â€˜Just worksâ€™</li></ul><h4 id=""><a href="#" class="headerlink" title=""></a><Teleport></h4><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719dd2d18fe0d55?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Teleport"></p><ul><li>ä»¥å‰ç§°ä¸º<code>&lt;Portal&gt;</code>ï¼Œè¯‘ä½œä¼ é€é—¨ã€‚</li><li>æ›´å¤šç»†èŠ‚å°†ç”±@<code>Linusborg</code> åˆ†äº«</li></ul><p><code>&lt;Teleport&gt;</code>åŸå…ˆæ˜¯å¯¹æ ‡ <code>React Portal</code>ï¼ˆå¢åŠ å¤šä¸ªæ–°åŠŸèƒ½ï¼Œæ›´å¼ºï¼‰</p><p>ä½†å› ä¸ºChromeæœ‰ä¸ªææ¡ˆï¼Œä¼šå¢åŠ ä¸€ä¸ªåä¸º<code>Portal</code>çš„åŸç”Ÿ<code>element</code>ï¼Œä¸ºé¿å…å‘½åå†²çªï¼Œæ”¹ä¸º<code>Teleport</code></p><h4 id="-1"><a href="#-1" class="headerlink" title=""></a><Suspense></h4><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719ddbaf6d0f226?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Suspense"></p><p>Suspenseç¿»è¯‘ä¸ºï¼šâ€œæ‚¬å¿µâ€</p><ul><li>å¯åœ¨åµŒå¥—å±‚çº§ä¸­ç­‰å¾…åµŒå¥—çš„å¼‚æ­¥ä¾èµ–é¡¹</li><li>æ”¯æŒasync setup()</li><li>æ”¯æŒå¼‚æ­¥ç»„ä»¶</li></ul><p>è™½ç„¶React 16å¼•å…¥äº†<code>Suspense</code>ï¼Œä½†ç›´è‡³ç°åœ¨éƒ½ä¸å¤ªèƒ½ç”¨ã€‚å¦‚ä½•å°†å…¶ä¸å¼‚æ­¥æ•°æ®ç»“åˆï¼Œè¿˜æ²¡å®Œæ•´è®¾è®¡å‡ºæ¥ã€‚<br>Vue 3 çš„<code>&lt;Suspense&gt;</code>æ›´åŠ è½»é‡ï¼š<br><strong>ä»…5%åº”ç”¨èƒ½æ„ŸçŸ¥è¿è¡Œæ—¶çš„è°ƒåº¦å·®å¼‚ï¼Œç»¼åˆè€ƒè™‘ä¸‹ï¼ŒVue3 çš„<code>&lt;Suspense&gt;</code> æ²¡å’ŒReactä¸€æ ·åšè¿è¡Œè°ƒåº¦å¤„ç†</strong></p><h3 id="æ›´å¥½çš„TypeScriptæ”¯æŒ"><a href="#æ›´å¥½çš„TypeScriptæ”¯æŒ" class="headerlink" title="æ›´å¥½çš„TypeScriptæ”¯æŒ"></a>æ›´å¥½çš„TypeScriptæ”¯æŒ</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719de6ad581aa38?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="TypeScript"></p><ul><li>Vue 3æ˜¯ç”¨TypeScriptç¼–å†™çš„åº“ï¼Œå¯ä»¥äº«å—åˆ°è‡ªåŠ¨çš„ç±»å‹å®šä¹‰æç¤º</li><li>JavaScriptå’ŒTypeScriptä¸­çš„APIæ˜¯ç›¸åŒçš„ã€‚äº‹å®ä¸Šï¼Œä»£ç ä¹ŸåŸºæœ¬ç›¸åŒ</li><li>æ”¯æŒTSX,classç»„ä»¶è¿˜ä¼šç»§ç»­æ”¯æŒï¼Œä½†æ˜¯éœ€è¦å¼•å…¥<code>vue-class-component@next</code>ï¼Œè¯¥æ¨¡å—ç›®å‰è¿˜å¤„åœ¨ alpha é˜¶æ®µã€‚</li></ul><p>è¿˜æœ‰<code>Vue 3 + TypeScript</code> æ’ä»¶æ­£åœ¨å¼€å‘ï¼Œæœ‰ç±»å‹æ£€æŸ¥ï¼Œè‡ªåŠ¨è¡¥å…¨ç­‰åŠŸèƒ½ã€‚ç›®å‰è¿›å±•å¯å–œã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719deb6563506b7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Vue 3 + TypeScript"></p><h3 id="Custom-Renderer-APIï¼šè‡ªå®šä¹‰æ¸²æŸ“å™¨API"><a href="#Custom-Renderer-APIï¼šè‡ªå®šä¹‰æ¸²æŸ“å™¨API" class="headerlink" title="Custom Renderer APIï¼šè‡ªå®šä¹‰æ¸²æŸ“å™¨API"></a>Custom Renderer APIï¼šè‡ªå®šä¹‰æ¸²æŸ“å™¨API</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719df0e878dbeb3?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Custom Renderer API"></p><ul><li>æ­£åœ¨è¿›è¡ŒNativeScript Vueé›†æˆ</li><li>ç”¨æˆ·å¯ä»¥å°è¯•WebGLè‡ªå®šä¹‰æ¸²æŸ“å™¨ï¼Œä¸æ™®é€šVueåº”ç”¨ç¨‹åºä¸€èµ·ä½¿ç”¨ï¼ˆVugelï¼‰ã€‚</li></ul><p>æ„å‘³ç€ä»¥åå¯ä»¥é€šè¿‡ <code>vue</code>ï¼Œ <code>Dom</code> ç¼–ç¨‹çš„æ–¹å¼æ¥è¿›è¡Œ <code>webgl</code> ç¼–ç¨‹ ã€‚æ„Ÿå…´è¶£å¯ä»¥çœ‹è¿™é‡Œï¼š<a href="https://vugel.planning.nl/#application" target="_blank" rel="noopener">Getting started vugel</a></p><h2 id="å‰©ä½™å·¥ä½œ"><a href="#å‰©ä½™å·¥ä½œ" class="headerlink" title="å‰©ä½™å·¥ä½œ"></a>å‰©ä½™å·¥ä½œ</h2><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719df667b34919f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å‰©ä½™å·¥ä½œ"></p><h3 id="Docs-amp-Migration-Guides"><a href="#Docs-amp-Migration-Guides" class="headerlink" title="Docs &amp; Migration Guides"></a>Docs &amp; Migration Guides</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719df8c7c95f9b9?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Docs &amp; Migration Guides"></p><ul><li>æ–°çš„æ–‡æ¡£ç¼–å†™äº¤ç”±<code>@NataliaTepluhina, @sdras, @bencodezen &amp; @phanan</code> è´Ÿè´£</li><li><code>@sdras</code> æ­£åœ¨åšè‡ªåŠ¨å‡çº§è¿ç§»å·¥å…·</li><li><code>@sodatea</code> å·²ç»å¼€å§‹ç ”ç©¶<code>CodeMods</code></li></ul><h3 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719dfcab0e73db6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Router"></p><ul><li>ä¸‹ä¸€ä»£ Routerï¼š<code>vue-router@next</code>å·²åœ¨alphaé˜¶æ®µï¼Œæ„Ÿè°¢<code>@posva</code></li></ul><p>æœ‰éƒ¨åˆ†çš„<code>API</code>å˜åŠ¨ï¼Œå¯åˆ°<code>RFC</code>ä¸Šçœ‹ã€‚</p><h3 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719dfed3afd961b?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Vuex"></p><ul><li>ä¸‹ä¸€ä»£Vuexï¼šï¼Œ<code>vuex@next</code>ï¼ˆä¸Vue 3 compatç›¸åŒçš„APIï¼‰ï¼Œå·²åœ¨alphaé˜¶æ®µï¼Œæ„Ÿè°¢<code>@KiaKing</code>ã€‚</li><li>å›¢é˜Ÿæ­£åœ¨ä¸ºä¸‹ä¸€æ¬¡è¿­ä»£è¯•éªŒVuex APIçš„ç®€åŒ–</li></ul><p>ç›®å‰ä»¥å…¼å®¹Vue 3ä¸ºä¸»ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰APIå˜åŠ¨ï¼Œè«æ…Œã€‚</p><h3 id="CLI"><a href="#CLI" class="headerlink" title="CLI"></a>CLI</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e043616c018f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="CLI"></p><ul><li>CLIæ’ä»¶ï¼š<code>vue-cli-plugin-vue-next</code> by <code>@sodatea</code></li><li>ï¼ˆwipï¼‰CodeModsæ”¯æŒå‡çº§Vue 2åº”ç”¨</li></ul><h3 id="æ–°å·¥å…·ï¼šviteï¼ˆæ³•è¯­-â€œå¿«â€ï¼‰"><a href="#æ–°å·¥å…·ï¼šviteï¼ˆæ³•è¯­-â€œå¿«â€ï¼‰" class="headerlink" title="æ–°å·¥å…·ï¼šviteï¼ˆæ³•è¯­ â€œå¿«â€ï¼‰"></a>æ–°å·¥å…·ï¼šviteï¼ˆæ³•è¯­ â€œå¿«â€ï¼‰</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e0c133c3367f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="vite"></p><p>åœ°å€ï¼š<a href="https://github.com/vuejs/vite" target="_blank" rel="noopener">github.com/vuejs/vite</a></p><p>ä¸€ä¸ªç®€æ˜“çš„httpæœåŠ¡å™¨ï¼Œæ— éœ€<code>webpack</code>ç¼–è¯‘æ‰“åŒ…ï¼Œæ ¹æ®è¯·æ±‚çš„Vueæ–‡ä»¶ï¼Œç›´æ¥å‘å›æ¸²æŸ“ï¼Œä¸”æ”¯æŒçƒ­æ›´æ–°ï¼ˆéå¸¸å¿«ï¼‰</p><h3 id="vue-test-utils"><a href="#vue-test-utils" class="headerlink" title="vue-test-utils"></a>vue-test-utils</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e0d602d57dc6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="vue-test-utils"></p><h3 id="DevTools"><a href="#DevTools" class="headerlink" title="DevTools"></a>DevTools</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e0d0e479ec8b?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="devtools"></p><h3 id="IDE-Support-Vetur"><a href="#IDE-Support-Vetur" class="headerlink" title="IDE Support (Vetur)"></a>IDE Support (Vetur)</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e12c5bfa38e3?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="IDE"></p><h3 id="Nuxt"><a href="#Nuxt" class="headerlink" title="Nuxt"></a>Nuxt</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e15306126103?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Nuxt"></p><h3 id="Vue-2-xè¿˜æœ‰2-7ç‰ˆæœ¬"><a href="#Vue-2-xè¿˜æœ‰2-7ç‰ˆæœ¬" class="headerlink" title="Vue 2.xè¿˜æœ‰2.7ç‰ˆæœ¬"></a>Vue 2.xè¿˜æœ‰2.7ç‰ˆæœ¬</h3><p><img src="https://user-gold-cdn.xitu.io/2020/4/22/1719e16b0eaabdd2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Vue 2.xè¿˜æœ‰2.7ç‰ˆæœ¬"></p><ul><li>å°†æœ‰æœ€åä¸€ä¸ªå°ç‰ˆæœ¬ï¼ˆ2.7ï¼‰</li><li>ä»Vue 3å‘åç§»æ¤å…¼å®¹çš„æ”¹è¿›(ä¸æŸåå…¼å®¹æ€§å‰æä¸‹)</li><li>åŠ ä¸Šåœ¨Vue 3ä¸­åˆ é™¤çš„åŠŸèƒ½çš„å¼ƒç”¨è­¦å‘Š</li><li>LTS1 18ä¸ªæœˆã€‚</li></ul><p><strong>æœ€åå»ºè®®ï¼šVue 3è™½å¥½ï¼Œå¦‚æœä½ çš„é¡¹ç›®å¾ˆç¨³å®šï¼Œä¸”å¯¹æ–°åŠŸèƒ½æ— è¿‡å¤šçš„è¦æ±‚æˆ–è€…è¿ç§»æˆæœ¬è¿‡é«˜ï¼Œåˆ™ä¸å»ºè®®å‡çº§ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue3.x </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºSaaSäº§å“çš„ä¸€äº›æ€è€ƒå’Œæ€»ç»“</title>
      <link href="/2020/04/20/%E6%9D%82%E6%96%87/%E5%85%B3%E4%BA%8ESaaS%E4%BA%A7%E5%93%81%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83%E5%92%8C%E6%80%BB%E7%BB%93/"/>
      <url>/2020/04/20/%E6%9D%82%E6%96%87/%E5%85%B3%E4%BA%8ESaaS%E4%BA%A7%E5%93%81%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83%E5%92%8C%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="SaaSçš„æ”¶è´¹æ¨¡å¼"><a href="#SaaSçš„æ”¶è´¹æ¨¡å¼" class="headerlink" title="SaaSçš„æ”¶è´¹æ¨¡å¼"></a>SaaSçš„æ”¶è´¹æ¨¡å¼</h1><p>é¦–å¹´æ”¶å–çš„æ˜¯å¼€æˆ·è´¹(è½¯ä»¶ç³»ç»Ÿè´¹å’Œè´¦å·è´¹ç­‰)ï¼Œä»ç¬¬äºŒå¹´å¼€å§‹æ”¶å–å¹´è´¹ï¼ŒSassè¦æä¾›æŒç»­çš„è¿è¥æœåŠ¡æ‰èƒ½å¤ŸæŒç»­æ”¶è´¹</p><h1 id="SaaSçš„è¿è¥æ¡†æ¶"><a href="#SaaSçš„è¿è¥æ¡†æ¶" class="headerlink" title="SaaSçš„è¿è¥æ¡†æ¶"></a>SaaSçš„è¿è¥æ¡†æ¶</h1><h2 id="åŸºç¡€å·¥ä½œ"><a href="#åŸºç¡€å·¥ä½œ" class="headerlink" title="åŸºç¡€å·¥ä½œ"></a>åŸºç¡€å·¥ä½œ</h2><h3 id="å¼„æ‡‚äº§å“"><a href="#å¼„æ‡‚äº§å“" class="headerlink" title="å¼„æ‡‚äº§å“"></a>å¼„æ‡‚äº§å“</h3><p>äº†è§£äº§å“ï¼Œå¯ä¸æ˜¯æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œéšä¾¿ç©ç©ï¼Œç„¶åæå‡ ä¸ªä¼˜åŒ–å»ºè®®å°±å®Œäº‹äº†ï¼Œè¿™æ˜¯æ•·è¡ã€‚çœŸæ­£å¼„æ‡‚äº§å“ï¼Œå¯ä»¥ä»è¿™4æ–¹é¢å…¥æ‰‹ã€‚</p><p>ç¬¬ä¸€ã€äº†è§£äº§å“ç›¸å…³çš„è¡Œä¸šèƒŒæ™¯ï¼Œå¦‚è¡Œä¸šå†å²ã€ç°çŠ¶ã€æœ€æ–°åŠ¨æ€ã€‚äº†è§£äº§å“æ¶‰åŠçš„åŸºç¡€çŸ¥è¯†ï¼Œå¦‚æŠ€æœ¯åŸç†ï¼Œåœ¨è¡Œä¸šçš„ä¼˜åŠ¿ã€‚</p><p>ç¬¬äºŒã€é˜…è¯»äº§å“ç›¸å…³çš„ææ–™ï¼ŒåŒ…æ‹¬å†…éƒ¨çš„æ–‡æ¡£ã€ä»‹ç»ã€ç™½çš®ä¹¦ï¼Œå¤–éƒ¨çš„æŠ¥é“ã€æŠ€æœ¯åˆ†æç­‰ã€‚</p><p>ç¬¬ä¸‰ã€ç»å¸¸å’ŒæŠ€æœ¯ã€äº§å“ã€å®¢æœåŒå­¦äº¤æµï¼Œäº†è§£å†…éƒ¨äººå¯¹äº§å“çš„åˆ‡èº«æ„Ÿå—å’Œæƒ³æ³•ã€‚</p><p>ç¬¬å››ã€è‡ªå·±æ·±åº¦ä½“éªŒäº§å“ï¼Œå¤šé—®å‡ ä¸ªä¸ºä»€ä¹ˆã€‚ä¸ºä»€ä¹ˆè¿™ä¸ªåŠŸèƒ½æ˜¯è¿™æ ·è®¾è®¡çš„ï¼Œåœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä¸ºè°è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><h3 id="å¼„æ‡‚ä¸šåŠ¡"><a href="#å¼„æ‡‚ä¸šåŠ¡" class="headerlink" title="å¼„æ‡‚ä¸šåŠ¡"></a>å¼„æ‡‚ä¸šåŠ¡</h3><p>é¦–å…ˆï¼Œè¦å¼„æ‡‚è‡ªå·±å†…éƒ¨çš„ä¸šåŠ¡ã€‚è¦æŠŠåŒäº‹å˜æˆè‡ªå·±çš„åŠ©æ‰‹ï¼Œè€Œä¸æ˜¯é˜»åŠ›ã€‚ä¸€å®šè¦ç†Ÿæ‚‰å„éƒ¨é—¨çš„åŠäº‹æµç¨‹ã€å„éƒ¨é—¨èƒ½æ”¯æŒçš„èµ„æºã€è€æ¿èƒ½æ”¯æŒçš„èµ„æºï¼Œæ´æ‚‰å’ŒæŒæ¡è¿™äº›ä¿¡æ¯ï¼Œæœ‰åˆ©äºä½ å¼€å±•å·¥ä½œï¼Œå¿«é€Ÿæ¨è¿›ã€‚</p><p>å…¶æ¬¡ï¼Œè¦äº†è§£å®¢æˆ·çš„ä¸šåŠ¡ã€‚ä»–ä»¬çš„ä¸šåŠ¡æ˜¯æ€ä¹ˆè¿ä½œçš„ï¼Œæ¯ä¸ªäººæ˜¯å¦‚ä½•åˆ†å·¥é…åˆçš„ï¼Œé‡åˆ°çš„é—®é¢˜æ˜¯ä»€ä¹ˆã€‚å¼„æ‡‚å®¢æˆ·çš„ä¸šåŠ¡ï¼Œæ‰èƒ½æ›´å¥½çš„åŒ¹é…å®¢æˆ·éœ€æ±‚ï¼Œä¸ç„¶æ°¸è¿œæ˜¯é—¨å¤–æ±‰ã€‚</p><h3 id="å¼„æ‡‚ç”¨æˆ·è·¯å¾„"><a href="#å¼„æ‡‚ç”¨æˆ·è·¯å¾„" class="headerlink" title="å¼„æ‡‚ç”¨æˆ·è·¯å¾„"></a>å¼„æ‡‚ç”¨æˆ·è·¯å¾„</h3><p>ç”¨æˆ·æ˜¯æ€ä¹ˆè®¤è¯†ä½ ï¼Œä¸ºä»€ä¹ˆé€‰æ‹©äº†ä½ ï¼Œæœ€ååˆæ˜¯æ€ä¹ˆæµå¤±çš„ï¼Ÿå¦‚æœä½ èƒ½å¼„æ‡‚ç”¨æˆ·è·¯å¾„ï¼Œé‚£ä¹ˆå°±çŸ¥é“æ¯ä¸ªç¯èŠ‚åº”è¯¥åšä»€ä¹ˆï¼Œå¼ å¼›æœ‰åº¦ï¼Œæ•´ä½“çš„è¿è¥å·¥ä½œå¼€å±•å°±ä¼šå¾ˆé¡ºåˆ©ã€‚è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œå¾ˆå¤šäººå°±æ˜¯æ²¡ææ‡‚ç”¨æˆ·è·¯å¾„ï¼Œä¸çŸ¥é“å·¥ä½œä»å“ªç€æ‰‹ï¼Œæƒ³åˆ°ä¸€ç‚¹å°±åšä¸€ç‚¹ï¼Œå®Œå…¨æ²¡æœ‰ç« æ³•ï¼Œå·¥ä½œè‡ªç„¶éš¾å‡ºæˆç»©ã€‚</p><h1 id="SaaSçš„æ ¸å¿ƒç»„ä»¶"><a href="#SaaSçš„æ ¸å¿ƒç»„ä»¶" class="headerlink" title="SaaSçš„æ ¸å¿ƒç»„ä»¶"></a>SaaSçš„æ ¸å¿ƒç»„ä»¶</h1><h2 id="å®‰å…¨ç»„ä»¶ï¼ˆä¿æŠ¤ç”¨æˆ·æ•°æ®ï¼‰"><a href="#å®‰å…¨ç»„ä»¶ï¼ˆä¿æŠ¤ç”¨æˆ·æ•°æ®ï¼‰" class="headerlink" title="å®‰å…¨ç»„ä»¶ï¼ˆä¿æŠ¤ç”¨æˆ·æ•°æ®ï¼‰"></a>å®‰å…¨ç»„ä»¶ï¼ˆä¿æŠ¤ç”¨æˆ·æ•°æ®ï¼‰</h2><h2 id="æ•°æ®éš”ç¦»ç»„ä»¶"><a href="#æ•°æ®éš”ç¦»ç»„ä»¶" class="headerlink" title="æ•°æ®éš”ç¦»ç»„ä»¶"></a>æ•°æ®éš”ç¦»ç»„ä»¶</h2><h2 id="å¯é…ç½®ç»„ä»¶"><a href="#å¯é…ç½®ç»„ä»¶" class="headerlink" title="å¯é…ç½®ç»„ä»¶"></a>å¯é…ç½®ç»„ä»¶</h2><h2 id="å¯æ‰©å±•ç»„ä»¶"><a href="#å¯æ‰©å±•ç»„ä»¶" class="headerlink" title="å¯æ‰©å±•ç»„ä»¶"></a>å¯æ‰©å±•ç»„ä»¶</h2><h2 id="0åœæœºæ—¶é—´å‡çº§ç»´æŠ¤äº§å“"><a href="#0åœæœºæ—¶é—´å‡çº§ç»´æŠ¤äº§å“" class="headerlink" title="0åœæœºæ—¶é—´å‡çº§ç»´æŠ¤äº§å“"></a>0åœæœºæ—¶é—´å‡çº§ç»´æŠ¤äº§å“</h2><h2 id="å¤šç§Ÿæˆ·ç»„ä»¶"><a href="#å¤šç§Ÿæˆ·ç»„ä»¶" class="headerlink" title="å¤šç§Ÿæˆ·ç»„ä»¶"></a>å¤šç§Ÿæˆ·ç»„ä»¶</h2><h1 id="SaaSå¤šç§Ÿæˆ·ä¸‹çš„æ•°æ®æ¨¡å‹åˆ†æ"><a href="#SaaSå¤šç§Ÿæˆ·ä¸‹çš„æ•°æ®æ¨¡å‹åˆ†æ" class="headerlink" title="SaaSå¤šç§Ÿæˆ·ä¸‹çš„æ•°æ®æ¨¡å‹åˆ†æ"></a>SaaSå¤šç§Ÿæˆ·ä¸‹çš„æ•°æ®æ¨¡å‹åˆ†æ</h1><h2 id="æ•°æ®å­˜å‚¨æ¶æ„"><a href="#æ•°æ®å­˜å‚¨æ¶æ„" class="headerlink" title="æ•°æ®å­˜å‚¨æ¶æ„"></a>æ•°æ®å­˜å‚¨æ¶æ„</h2><p>ç°æœ‰çš„å¤šç§Ÿæˆ·ç”¨æˆ·æ•°æ®å­˜å‚¨ä¸»è¦åˆ†ä¸ºä¸‰ç§æ–¹å¼ï¼š</p><ul><li>ç‹¬ç«‹æ•°æ®åº“</li><li>å…±äº«æ•°æ®åº“ä½†éš”ç¦»æ•°æ®</li><li>å…±äº«æ•°æ®åº“ä¸”å…±äº«æ•°æ®</li></ul><h2 id="æ€»ä½“ä¸šåŠ¡æ¶æ„"><a href="#æ€»ä½“ä¸šåŠ¡æ¶æ„" class="headerlink" title="æ€»ä½“ä¸šåŠ¡æ¶æ„"></a>æ€»ä½“ä¸šåŠ¡æ¶æ„</h2><p>SaaSå¹³å°çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿä¸»è¦æ˜¯ç»Ÿä¸€ç®¡ç†ç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·é€šè¿‡SaaSå¹³å°ç»Ÿä¸€æ³¨å†Œã€ç™»å½•åï¼Œèƒ½å¤Ÿè¯•ç”¨ã€é‡‡è´­å„ä¼ä¸šåº”ç”¨ï¼Œå®ç°å„ä¸ªç¬¬ä¸‰æ–¹ä¼ä¸šåº”ç”¨çš„é›†æˆ</p><p>ä»åŠŸèƒ½ç»“æ„ä¸Šå¤§è‡´å¯ä»¥åˆ†æˆ4ä¸ªä¸šåŠ¡åŸŸï¼šç§Ÿæˆ·åŸŸã€ç§Ÿæˆ·ç®¡ç†åŸŸã€ç”¨æˆ·åŸŸã€ç”¨æˆ·æƒé™åŸŸç­‰ï¼›</p><ul><li>ç§Ÿæˆ·åŸŸï¼šä¸»è¦æè¿°ç§Ÿæˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œä»¥åŠç§Ÿæˆ·çš„ç»„ç»‡ç»“æ„ã€ç§Ÿæˆ·çš„ç”¨æˆ·æˆå‘˜ï¼ˆæˆå‘˜èŒä½ï¼‰ç­‰ä¿¡æ¯ï¼›</li><li>ç§Ÿæˆ·ç®¡ç†åŸŸï¼šä¸»è¦æè¿°ç§Ÿæˆ·å¤šçº§ç®¡ç†å‘˜è¯¦æƒ…ï¼Œä»¥åŠç®¡ç†å‘˜å¯¹åº”ç®¡ç†çš„ä¼ä¸šåº”ç”¨æƒé™ã€æ•°æ®èŒƒå›´æƒé™ï¼›</li><li>ç”¨æˆ·åŸŸï¼šä¸»è¦æè¿°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼Œç”¨æˆ·ç™»å½•è´¦å·ã€å®åè®¤è¯ã€ç™»å½•çš„ç¬¬ä¸‰æ–¹è´¦å·ç»‘å®šç­‰ä¿¡æ¯ï¼›</li><li>ç”¨æˆ·æƒé™åŸŸï¼šä¸»è¦æè¿°ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨çš„ä¼ä¸šåº”ç”¨ä»¥åŠæ•°æ®èŒƒå›´çš„æƒé™ä¿¡æ¯ï¼›</li></ul><p><img src="https://img-blog.csdn.net/20180622144116115?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvdF9zdW1tZXJ5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="å¤šç§Ÿæˆ·æ¨¡å‹å›¾"><br><img src="https://img-blog.csdnimg.cn/20200404205531179.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hvdGljZTg4OA==,size_16,color_FFFFFF,t_70" alt="åˆ†æä»‹ç»"></p><h1 id="æˆç†ŸSaaSäº§å“çš„4ä¸ªæ ‡å¿—"><a href="#æˆç†ŸSaaSäº§å“çš„4ä¸ªæ ‡å¿—" class="headerlink" title="æˆç†ŸSaaSäº§å“çš„4ä¸ªæ ‡å¿—"></a>æˆç†ŸSaaSäº§å“çš„4ä¸ªæ ‡å¿—</h1><p>æˆç†Ÿå¯ç”¨æ˜¯ä¼ä¸šé€‰æ‹©SaaSäº§å“çš„æœ€é‡è¦æ ‡å‡†ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¡Œä¸šä¸ºä»€ä¹ˆè¦åšæŒæ½œè¡Œç›¸å½“é•¿æ—¶é—´çš„åŸå› ã€‚ä¼ä¸šå¢ƒå†µè¯´æ˜¯é æ—¶é—´ç†¬å‡ºæ¥çš„ï¼Œæ›´å‡†ç¡®åœ°è¯´æ˜¯é äº§å“çš„æˆç†ŸåŒ–ç†¬å‡ºæ¥çš„ã€‚æˆç†Ÿçš„SaaSæœå®ä¸€å¦‚è¤šæ©™èˆ¬ç”œèœœã€‚</p><p>é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªäº§å“æ˜¯å·²ç»æˆç†Ÿçš„ï¼Ÿ</p><h2 id="ç¨³å®šçš„å•†ä¸šæ¨¡å¼ï¼Œç»„åˆ†å¸‚åœºå’Œé¡¾å®¢åˆ†å±‚"><a href="#ç¨³å®šçš„å•†ä¸šæ¨¡å¼ï¼Œç»„åˆ†å¸‚åœºå’Œé¡¾å®¢åˆ†å±‚" class="headerlink" title="ç¨³å®šçš„å•†ä¸šæ¨¡å¼ï¼Œç»„åˆ†å¸‚åœºå’Œé¡¾å®¢åˆ†å±‚"></a>ç¨³å®šçš„å•†ä¸šæ¨¡å¼ï¼Œç»„åˆ†å¸‚åœºå’Œé¡¾å®¢åˆ†å±‚</h2><p>å½“ä¸€ä¸ªå•†ä¸šæ¨¡å¼å’Œå¯¹åº”çš„ä»·æ ¼æ°´å¹³èƒ½å¤Ÿç¨³å®šä¸€åˆ°ä¸¤å¹´ï¼Œæ„Ÿè§‰å·²ç»æ²¡æœ‰å¤§å¹…ä¿®è®¢çš„å¿…è¦æ—¶ï¼ŒSaaSäº§å“åœ¨å•†ä¸šæ¨¡å¼ä¸Šæ‰ç®—ç¨³å®šä¸‹æ¥ï¼Œå®ƒæ˜¯å¯¹äº§å“æˆç†Ÿåº¦çš„ç¬¬ä¸€å¤§è´¡çŒ®ã€‚</p><h2 id="äº§å“æŠ•å°„äº†ä¸“ä¸šå’Œè¡Œä¸šçš„æœ€ä½³å®è·µ"><a href="#äº§å“æŠ•å°„äº†ä¸“ä¸šå’Œè¡Œä¸šçš„æœ€ä½³å®è·µ" class="headerlink" title="äº§å“æŠ•å°„äº†ä¸“ä¸šå’Œè¡Œä¸šçš„æœ€ä½³å®è·µ"></a>äº§å“æŠ•å°„äº†ä¸“ä¸šå’Œè¡Œä¸šçš„æœ€ä½³å®è·µ</h2><p>ä¸€ä¸ªæˆç†Ÿçš„CRMåº”ç”¨å¿…ç„¶éœ€è¦å°†é”€å”®ç®¡ç†æ–¹æ³•ã€æµç¨‹å’Œå·¥å…·å†…ç½®åœ¨äº§å“ä¸­ï¼Œå®ƒä¸ä»…éœ€è¦æä¾›ä¸€ä¸ªç¨‹åºï¼Œè¿˜éœ€è¦æä¾›ä¸€ä¸ªä½¿ç”¨ç¨‹åºçš„ç¨‹åºã€‚</p><h2 id="å¥å…¨çš„ç”¨æˆ·å…¥åœºååŠ©"><a href="#å¥å…¨çš„ç”¨æˆ·å…¥åœºååŠ©" class="headerlink" title="å¥å…¨çš„ç”¨æˆ·å…¥åœºååŠ©"></a>å¥å…¨çš„ç”¨æˆ·å…¥åœºååŠ©</h2><p>ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼ŒSaaSäº§å“éœ€è¦é¦–å…ˆæ‹¥æœ‰å®Œå–„çš„å›¢é˜Ÿè´¦æˆ·æ¶æ„ï¼Œèƒ½å¤Ÿæ”¯æŒæ¯ä¸ªä¸ªä½“ç”¨æˆ·ä½¿ç”¨å®åè´¦æˆ·ï¼Œè¢«åˆå§‹ç®¡ç†å‘˜æˆäºˆåˆé€‚çš„æƒé™ï¼Œå¦‚æœæœ‰å¤šä¸ªå›¢é˜Ÿï¼Œè¿˜å¯èƒ½éœ€è¦å›¢é˜Ÿç®¡ç†å‘˜è¿™ä¸ªè§’è‰²æ¥å‡è½»å¤§ç®¡å®¶çš„å‹åŠ›ã€‚ä¸ºäº†åŠ å…¥æ–°æˆå‘˜ï¼Œè°ƒæ•´æˆå‘˜å’Œåˆ†ç»„çš„è¿‡ç¨‹å¿…é¡»è¶³å¤Ÿæ¸…æ™°å’Œç®€å•ï¼Œè®©å®¢æˆ·æœ‰åŠ¨åŠ›æ¥ç»´æŒè¿™ä¸ªç”¨æˆ·ç³»ç»Ÿã€‚ç›¸åï¼Œå¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªé—®é¢˜ä¸Šå¿½è§†ï¼Œèƒ¡ä¹±åœ°åˆ†é…ä¸€äº›001ï¼Œ002å·¥å·å‡ºå»ï¼Œç”šè‡³å…è®¸ç”¨æˆ·åˆç”¨è´¦å·ï¼Œé‚£å®¢æˆ·æ€»æ˜¯ä¼šèµ°åˆ°æ··ä¹±å¤±åºçš„é‚£ä¸€å¤©ï¼Œè·ç¦»å®¢æˆ·æµå¤±ä¹Ÿå°±ä¸è¿œäº†ã€‚</p><p>ä»…ä»…æœ‰äº†ç§‘å­¦å®Œå–„çš„è´¦æˆ·ç»“æ„ä½“ç³»è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬è¿˜è¦å¸®åŠ©ä¼ä¸šç©¿é’ˆå¼•çº¿ï¼Œè®©å¤šæˆå‘˜è¿›å…¥è¿™ä¸ªç³»ç»Ÿéå¸¸ç®€å•å’Œè½»æ¾ã€‚æ¯”å¦‚ä¸€ä¸ªBIåº”ç”¨ï¼Œåœ¨é…ç½®å¤–éƒ¨æ•°æ®æºçš„æ—¶å€™ï¼Œéœ€è¦ç”¨æˆ·æ·»åŠ Google Analyticsçš„Profileï¼Œé—®é¢˜æ˜¯æŒæ¡è¿™ä¸ªä¿¡æ¯çš„äººå¯èƒ½ä¸æ˜¯ç®¡ç†å‘˜æœ¬äººï¼Œä»–å¯èƒ½éœ€è¦åŒäº‹çš„å¸®å¿™æ‰èƒ½å®Œæˆè¿™ä¸ªé…ç½®ï¼Œè¿™æ—¶å€™è½¯ä»¶å¯èƒ½éœ€è¦ç›´æ¥å°†é‚€è¯·æˆå‘˜å®Œæˆä¸€ä¸ªé…ç½®ä½œä¸ºä¸€ä¸ªç”¨ä¾‹æ¥å¯¹å¾…ï¼Œè®¾è®¡å‡ºä¸“é—¨çš„äº¤äº’ç•Œé¢ã€‚</p><p>æœ‰ä¸€æ¬¡åœ¨æœºåœºé¡¿æ‚Ÿï¼Œæ˜‚è´µçš„æœºåœºè®¾æ–½å’Œå‡ ä¹æ‰€æœ‰çš„æœºåœºåœ°å‹¤äººå‘˜å…¶å®åªä¸ºä¸€ä¸ªäº‹æƒ…ï¼Œè®©ä¹˜å®¢ç™»ä¸Šé£æœºã€‚è€Œæˆ‘ä»¬å»æœºåœºï¼Œå…¶å®æ˜¯ä¸ºäº†åé£æœºæ—…è¡Œï¼Œæˆ‘ä»¬ä¸ä¸€å®šæ„è¯†åˆ°onboardingçš„è¿‡ç¨‹è¿™ä¹ˆé‡è¦å’Œæ˜‚è´µã€‚</p><p>å½“ä¸€ä¸ªSaaSäº§å“æ„è¯†åˆ°è¿™ä¸€ç‚¹ï¼ŒæŠŠå¸®åŠ©ç”¨æˆ·ä¸Šèˆ¹ï¼Œä¸Šé£æœºä½œä¸ºä¸€ä¸ªå¤§å‹é¡¹ç›®æ¥çœ‹å¾…ï¼Œå®ƒè·ç¦»æˆç†Ÿå°±ä¸è¿œäº†ã€‚</p><h2 id="æ”¯æŒå¤–éƒ¨æ•°æ®æ•´åˆçš„å¼€æ”¾æ€§"><a href="#æ”¯æŒå¤–éƒ¨æ•°æ®æ•´åˆçš„å¼€æ”¾æ€§" class="headerlink" title="æ”¯æŒå¤–éƒ¨æ•°æ®æ•´åˆçš„å¼€æ”¾æ€§"></a>æ”¯æŒå¤–éƒ¨æ•°æ®æ•´åˆçš„å¼€æ”¾æ€§</h2><p>æœ€åä¸€ç‚¹ï¼Œæˆç†Ÿçš„SaaSäº§å“å¿…ç„¶è€ƒè™‘å¼€æ”¾æ€§ï¼Œå¦‚æœæ²¡æœ‰APIï¼Œå‡ ä¹å°±ä¸å¯èƒ½æˆä¸ºä¸€ä¸ªé•¿æœŸå­˜åœ¨çš„SaaSäº§å“</p><p>ä¸€ä¸ªæ ‡å‡†åŒ–çš„SaaSè½¯ä»¶å¯èƒ½å¢å¼ºåˆ°ç‰¹æ€§ä¸°å¯Œï¼Œç»„ç»‡æœ‰åºçš„è‰¯å¥½çŠ¶æ€ï¼Œä½†æ˜¯å®ƒç»æ— å¯èƒ½æä¾›ç”¨æˆ·æ‰€è¦çš„æ‰€æœ‰åŠŸèƒ½ï¼Œä¼ä¸šç”¨æˆ·ç»“åˆä½¿ç”¨å¤šä¸ªäº§å“å·¥å…·è§£å†³ä¸šåŠ¡é—®é¢˜æ˜¯ä¸€ä¸ªå¸¸æ€ã€‚æœ‰äº†ä¸°å¯Œçš„ç¼–ç¨‹æ¥å£ï¼Œè‡³å°‘è®©ç”¨æˆ·æœ‰æœºä¼šèƒ½å¤Ÿé€šè¿‡å˜é€šçš„åŠæ³•æ¥å®ç°ä»–ä¹‹æ‰€æƒ³ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ‚æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>&lt;æ·±å…¥ç†è§£TypeScriptè¯»ä¹¦ç¬”è®°&gt;ï¼ˆä¸€ï¼‰</title>
      <link href="/2020/04/19/Ts/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3TypeScript%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
      <url>/2020/04/19/Ts/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3TypeScript%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="TypeScriptç±»å‹ç³»ç»Ÿ"><a href="#TypeScriptç±»å‹ç³»ç»Ÿ" class="headerlink" title="TypeScriptç±»å‹ç³»ç»Ÿ"></a>TypeScriptç±»å‹ç³»ç»Ÿ</h1><h2 id="types"><a href="#types" class="headerlink" title="@types"></a>@types</h2><h3 id="å…¨å±€-types"><a href="#å…¨å±€-types" class="headerlink" title="å…¨å±€@types"></a>å…¨å±€@types</h3><p>@types æ”¯æŒå…¨å±€å’Œæ¨¡å—ç±»å‹å®šä¹‰</p><pre><code class="js">npm install @type/jquery --save-dev</code></pre><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒTypeScript ä¼šè‡ªåŠ¨åŒ…å«æ”¯æŒå…¨å±€ä½¿ç”¨çš„ä»»ä½•å£°æ˜å®šä¹‰</p><h3 id="å±€éƒ¨-types"><a href="#å±€éƒ¨-types" class="headerlink" title="å±€éƒ¨@types"></a>å±€éƒ¨@types</h3><p>å®‰è£…å®Œæˆåä¸éœ€è¦åšç‰¹åˆ«é…ç½®ï¼Œåªè¦æƒ³ä½¿ç”¨æ¨¡å—ä¸€æ ·ä½¿ç”¨å®ƒä¸€æ ·</p><pre><code class="js">import * as $ from &#39;jquery&#39;</code></pre><p>å¯ä»¥åœ¨<code>typeconfig.json</code>ä¸­å¯ä»¥é…ç½®æœ‰æ„ä¹‰çš„ç±»å‹</p><pre><code class="js">{    compilerOptions{        &quot;type&quot; :[            &quot;jquery&quot;        ]    }}</code></pre><h2 id="å£°æ˜æ–‡ä»¶"><a href="#å£°æ˜æ–‡ä»¶" class="headerlink" title="å£°æ˜æ–‡ä»¶"></a>å£°æ˜æ–‡ä»¶</h2><p>å¯ä»¥ä½¿ç”¨<code>declear</code>å…³é”®å­—æ¥å‘Šè¯‰typescriptï¼Œä½ è¯•å›¾è¡¨è¯‰ä¸€ä¸ªå…¶ä»–åœ°æ–¹å·²ç»å­˜åœ¨çš„ä»£ç </p><pre><code class="ts">foo = 123declear var foo:anyfoo = 123</code></pre><p>åœ¨å®é™…é¡¹ç›®å¯ä»¥æ–°å»ºä¸€ä¸ª<code>global.d.ts</code>æ–‡ä»¶æ¥æŠŠè¿™äº›å£°æ˜æ”¾åˆ°é‡Œé¢</p><h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><p>æ¥å£è¿è¡Œæ—¶çš„å½±å“ä¸º0.æœ‰å¤šç§æ–¹å¼å¯ä»¥å£°æ˜å˜é‡çš„ç»“æ„</p><pre><code class="js">//ç­‰æ•ˆå£°æ˜//å†…è”æ³¨è§£declear const myPoint = {x:number,y:number}//æ¥å£å®ç°  interface myPoint{    x: number,    y: number}</code></pre><h3 id="ç±»æ¥å®ç°æ¥å£"><a href="#ç±»æ¥å®ç°æ¥å£" class="headerlink" title="ç±»æ¥å®ç°æ¥å£"></a>ç±»æ¥å®ç°æ¥å£</h3><pre><code class="js">interface myPoint{    x: string,    y: string}class point implements myPoint{    x: string,    y: string}</code></pre><p><strong>æ³¨æ„ï¼šå¹¶éæ¯ä¸ªæ¥å£éƒ½å®¹æ˜“å®ç°</strong></p><pre><code class="js">interface Crazy{    new() {        value: number    }}class CrazyClass implements Crazy{    constructor(){        return {            value: 123        }    }}const crazy = new CrazyClass()</code></pre><h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><p>æšä¸¾æ˜¯æ”¶é›†æœ‰å…³è¿å˜é‡çš„ä¸€ç§æ–¹å¼, ä½œç”¨å°±æ˜¯ç®¡ç†å¸¸é‡ï¼Œè®©å¸¸é‡æ›´è§„èŒƒç»Ÿä¸€</p><h3 id="æ•°å­—æšä¸¾"><a href="#æ•°å­—æšä¸¾" class="headerlink" title="æ•°å­—æšä¸¾"></a>æ•°å­—æšä¸¾</h3><pre><code class="js">enum CradSuit{    Clubs,    Diamonds,    Hearts,    Spades}let clubs = CradSuot.Clubs</code></pre><h3 id="å­—ç¬¦ä¸²æšä¸¾"><a href="#å­—ç¬¦ä¸²æšä¸¾" class="headerlink" title="å­—ç¬¦ä¸²æšä¸¾"></a>å­—ç¬¦ä¸²æšä¸¾</h3><pre><code class="js">enum CradSuit{    Clubs,    Diamonds,    Hearts,    Spades}console.log(CardSuit.Clubs[0]) // &#39;Clubs&#39;console.log(CardSuit.[&#39;Diamonds&#39;]) // 0</code></pre><p>æ”¹å˜ä¸æšä¸¾å…³è”çš„æ•°å­—</p><pre><code class="js">enum CradSuit{    Clubs , // 0    Diamonds, // 1    Hearts, // 2    Spades // 3}enum CradSuit{    Clubs  = 3, // 3    Diamonds, // 4    Hearts, // 5    Spades // 6</code></pre><h3 id="å¸¸é‡æšä¸¾"><a href="#å¸¸é‡æšä¸¾" class="headerlink" title="å¸¸é‡æšä¸¾"></a>å¸¸é‡æšä¸¾</h3><pre><code class="js">enum Fruit {    Apple,    banner,    orange}console.log(Fruit.orange) // 2</code></pre><h4 id="é™æ€æ–¹æ³•çš„æšä¸¾"><a href="#é™æ€æ–¹æ³•çš„æšä¸¾" class="headerlink" title="é™æ€æ–¹æ³•çš„æšä¸¾"></a>é™æ€æ–¹æ³•çš„æšä¸¾</h4><pre><code class="js">enum Weekday{    Monday,    Tuesday,    Wednesday,    Thursday,    Friday,    Saturday    Sunday}namesapce Weekday{    export function isBusinessDay(weekday: Weekday){        switch(weekday){            case Weekday.Saturday:        case Weekday.Sunday:            return false;        default:            return true;        }    }}const mon = Weekday.Monday;const sun = Weekday.Sunday;console.log(Weekday.isBusinessDay(mon)); // trueconsole.log(Weekday.isBusinessDay(sun));</code></pre><h2 id="lib-d-ts"><a href="#lib-d-ts" class="headerlink" title="lib.d.ts"></a>lib.d.ts</h2><p>å®‰è£…typescriptçš„æ—¶å€™ä¼šæœ‰é™„å¸¦ä¸€ä¸ª<code>lib.d.ts</code>çš„æ–‡ä»¶ï¼Œé‡Œé¢çš„å†…å®¹å®šä¹‰äº†(window,document,mathï¼Œdata,string)çš„å˜é‡å£°æ˜</p><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>å¯ç»„åˆç³»ç»Ÿçš„æ ¸å¿ƒæ„å»ºå—</p><h3 id="è¿”å›å‡½æ•°ç±»å‹æ³¨è§£"><a href="#è¿”å›å‡½æ•°ç±»å‹æ³¨è§£" class="headerlink" title="è¿”å›å‡½æ•°ç±»å‹æ³¨è§£"></a>è¿”å›å‡½æ•°ç±»å‹æ³¨è§£</h3><pre><code class="js">interface Foo {    foo: string}function foo(sameple: foo) :foo{    console.log(foo)}</code></pre><h3 id="å¯é€‰å‚æ•°åŠé»˜è®¤å‚æ•°å€¼å±æ€§"><a href="#å¯é€‰å‚æ•°åŠé»˜è®¤å‚æ•°å€¼å±æ€§" class="headerlink" title="å¯é€‰å‚æ•°åŠé»˜è®¤å‚æ•°å€¼å±æ€§"></a>å¯é€‰å‚æ•°åŠé»˜è®¤å‚æ•°å€¼å±æ€§</h3><pre><code class="js">function person(speak:string =&quot;hello world&quot;,age?:number){    console.log(speak,age)}person(&#39;ä½ å¥½&#39;)person(...12)</code></pre><h3 id="å‡½æ•°é‡è½½"><a href="#å‡½æ•°é‡è½½" class="headerlink" title="å‡½æ•°é‡è½½"></a>å‡½æ•°é‡è½½</h3><pre><code class="js">function addOne(a:number,y?:number,z?:number,x?:number){    if(x === undefined &amp;&amp; y === undefined &amp;&amp; z === undefined){        x = y = z = a    }else if( y === undefined &amp;&amp; z === undefined ){        z = a         x = y    }    return {        top: a,        left: x,        right: y,        bottom: z    }}addOne(1)addOne(1,1,1,1)</code></pre><h3 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°å£°æ˜"></a>å‡½æ•°å£°æ˜</h3><pre><code class="js">type londHand = {    (a:number) : number}type ShortHand = (a:number) =&gt;{number}</code></pre><h2 id="å¯è°ƒç”¨çš„"><a href="#å¯è°ƒç”¨çš„" class="headerlink" title="å¯è°ƒç”¨çš„"></a>å¯è°ƒç”¨çš„</h2><pre><code class="js">interface Complex {    (foo:string,age?:number,...other,boolean[]):number}</code></pre><h2 id="ç±»å‹æ–­è¨€"><a href="#ç±»å‹æ–­è¨€" class="headerlink" title="ç±»å‹æ–­è¨€"></a>ç±»å‹æ–­è¨€</h2><p>TypeScript å…è®¸ä½ è¦†ç›–å®ƒçš„æ¨æ–­ï¼Œå¹¶ä¸”èƒ½ä»¥ä½ ä»»ä½•ä½ æƒ³è¦çš„æ–¹å¼åˆ†æå®ƒï¼Œè¿™ç§æœºåˆ¶è¢«ç§°ä¸ºã€Œç±»å‹æ–­è¨€ã€</p><p><code>as foo ä¸ &lt;foo&gt;</code></p><p><code>&lt;foo&gt;</code>å¯èƒ½ä¼šä¸jsxä¸­å†²çªï¼Œæ¨èä½¿ç”¨<code>as foo</code></p><h3 id="åŒé‡æ–­è¨€"><a href="#åŒé‡æ–­è¨€" class="headerlink" title="åŒé‡æ–­è¨€"></a>åŒé‡æ–­è¨€</h3><pre><code class="js">function handle(event:Event){    console.log(element = (event as any) as HTMLElement)}</code></pre><h2 id="Freshness"><a href="#Freshness" class="headerlink" title="Freshness"></a>Freshness</h2><p>ä¸ºäº†èƒ½è®©æ£€æŸ¥å¯¹è±¡å­—é¢é‡ç±»å‹æ›´å®¹æ˜“ï¼Œæä¾›Freshnessæ›´ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥</p><h2 id="ç±»å‹ä¿æŠ¤"><a href="#ç±»å‹ä¿æŠ¤" class="headerlink" title="ç±»å‹ä¿æŠ¤"></a>ç±»å‹ä¿æŠ¤</h2><p>ä½ å¯ä»¥ä½¿ç”¨æ›´å°èŒƒå›´çš„å¯¹è±¡ç±»å‹</p><p><code>typeof</code> <code>instanceof</code></p><h2 id="å­—é¢é‡ç±»å‹"><a href="#å­—é¢é‡ç±»å‹" class="headerlink" title="å­—é¢é‡ç±»å‹"></a>å­—é¢é‡ç±»å‹</h2><p>ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡†å¤‡çš„ç±»å‹æ¥å®šä¹‰ä¸€ä¸ªå¯¹è±¡</p><h2 id="readOnly"><a href="#readOnly" class="headerlink" title="readOnly"></a>readOnly</h2><p>å¦‚å­—é¢æ„æ€ä¸€æ ·ï¼Œæ˜¯åªè¯»çš„ï¼Œä¸èƒ½éšä¾¿æ›´æ”¹çš„ï¼Œæ˜¯ä¸€ç§æ›´å®‰å…¨çš„æ–¹å¼</p><pre><code class="js">type Foo = {  readonly bar: number;  readonly bas: number;};// åˆå§‹åŒ–const foo: Foo = { bar: 123, bas: 456 };// ä¸èƒ½è¢«æ”¹å˜foo.bar = 456; // Error: foo.bar ä¸ºä»…è¯»å±æ€§</code></pre><h3 id="ä¸constä¸åŒ"><a href="#ä¸constä¸åŒ" class="headerlink" title="ä¸constä¸åŒ"></a>ä¸constä¸åŒ</h3><ul><li>const ç”¨äºå˜é‡ï¼Œå˜é‡ä¸èƒ½é‡æ–°èµ‹ç»™å…¶ä»–ä»»ä½•äº‹ç‰©</li><li>readOnly ç”¨äºå±æ€§ï¼Œç”¨äºåˆ«åå¯ä»¥ä¿®æ”¹å±æ€§</li></ul><h2 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h2><p>ä»–çš„ç”¨é€”å°±æ˜¯åœ¨ä½ ä¸ç¡®å®šè¦ç©¿çš„å€¼çš„å±æ€§æ—¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨æ³›å‹å»ç¡®å®š<br>åœ¨æˆå‘˜ä¹‹é—´æä¾›æœ‰æ„ä¹‰çš„çº¦æŸï¼Œè¿™äº›æˆå‘˜å¯ä»¥æ˜¯ï¼š</p><ul><li>ç±»çš„å®ä¾‹æˆå‘˜</li><li>ç±»çš„æ–¹æ³•</li><li>å‡½æ•°å‚æ•°</li><li>å‡½æ•°è¿”å›å€¼</li></ul><pre><code class="js">class Queue&lt;T&gt;{    private data: T[] = []    push = (item:&lt;T&gt;) =&gt; {this.data.push(item)}    pop = ():T | undefiend =&gt; {this.data.shift()}}const queue = new Queue&lt;number&gt;()queue.push(1)queue.shift(&#39;1&#39;) //  error &#39;1&#39; is string</code></pre><p>ä½ å¯ä»¥éšæ„è°ƒç”¨æ³›å‹å‚æ•°ï¼Œå½“ä½ ä½¿ç”¨ç®€å•çš„æ³›å‹æ—¶ï¼Œæ³›å‹å¸¸ç”¨ Tã€Uã€V è¡¨ç¤º</p><h2 id="ç±»å‹æ¨æ–­"><a href="#ç±»å‹æ¨æ–­" class="headerlink" title="ç±»å‹æ¨æ–­"></a>ç±»å‹æ¨æ–­</h2><p>TypeScript èƒ½æ ¹æ®ä¸€äº›ç®€å•çš„è§„åˆ™æ¨æ–­ï¼ˆæ£€æŸ¥ï¼‰å˜é‡çš„ç±»å‹ï¼Œä½ å¯ä»¥é€šè¿‡å®è·µï¼Œå¾ˆå¿«çš„äº†è§£å®ƒä»¬ã€‚</p><p>å®šä¹‰å˜é‡ï¼Œå‡½æ•°è¿”å›ç±»å‹ï¼Œèµ‹å€¼ï¼Œè§£æ„ï¼Œç»“æ„åŒ–ç­‰éƒ½å¯ä»¥æ¨æ–­å‡ºç±»å‹</p><h2 id="ç±»å‹å…¼å®¹æ€§"><a href="#ç±»å‹å…¼å®¹æ€§" class="headerlink" title="ç±»å‹å…¼å®¹æ€§"></a>ç±»å‹å…¼å®¹æ€§</h2><p>ç”¨äºç¡®å®šä¸€ä¸ªç±»å‹æ˜¯å¦èƒ½èµ‹å€¼ç»™å…¶ä»–ç±»å‹</p><p>åå˜<br>é€†å˜ï¼Œ<br>åŒå‘åå˜ï¼Œ<br>ä¸å˜</p><h2 id="never"><a href="#never" class="headerlink" title="never"></a>never</h2><p><code>never</code> ç±»å‹æ˜¯ TypeScript ä¸­çš„åº•å±‚ç±»å‹ã€‚å®ƒè‡ªç„¶è¢«åˆ†é…çš„ä¸€äº›ä¾‹å­ï¼š</p><p>ä¸€ä¸ªä»æ¥ä¸ä¼šæœ‰è¿”å›å€¼çš„å‡½æ•°ï¼ˆå¦‚ï¼šå¦‚æœå‡½æ•°å†…å«æœ‰ <code>while(true) {}</code>ï¼‰ï¼›<br>ä¸€ä¸ªæ€»æ˜¯ä¼šæŠ›å‡ºé”™è¯¯çš„å‡½æ•°ï¼ˆå¦‚ï¼š<code>function foo() { throw new Error(&#39;Not Implemented&#39;)</code> }ï¼Œfoo çš„è¿”å›ç±»å‹æ˜¯ neverï¼‰ï¼›</p><p>ä½†æ˜¯ï¼Œnever ç±»å‹ä»…èƒ½è¢«èµ‹å€¼ç»™å¦å¤–ä¸€ä¸ª never</p><h3 id="ç”¨ä¾‹ï¼šè¯¦ç»†çš„æ£€æŸ¥"><a href="#ç”¨ä¾‹ï¼šè¯¦ç»†çš„æ£€æŸ¥" class="headerlink" title="ç”¨ä¾‹ï¼šè¯¦ç»†çš„æ£€æŸ¥"></a>ç”¨ä¾‹ï¼šè¯¦ç»†çš„æ£€æŸ¥</h3><pre><code class="js">function foo(x:string | number):boolean {    if (typeof x === &#39;string&#39;) {        return true;    } else if (typeof x === &#39;number&#39;) {        return false;    }    // å¦‚æœä¸æ˜¯ä¸€ä¸ª never ç±»å‹ï¼Œè¿™ä¼šæŠ¥é”™ï¼š    // - ä¸æ˜¯æ‰€æœ‰æ¡ä»¶éƒ½æœ‰è¿”å›å€¼ ï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰    // - æˆ–è€…æ£€æŸ¥åˆ°æ— æ³•è®¿é—®çš„ä»£ç     // ä½†æ˜¯ç”±äº TypeScript ç†è§£ `fail` å‡½æ•°è¿”å›ä¸º `never` ç±»å‹    // å®ƒå¯ä»¥è®©ä½ è°ƒç”¨å®ƒï¼Œå› ä¸ºä½ å¯èƒ½ä¼šåœ¨è¿è¡Œæ—¶ç”¨å®ƒæ¥åšå®‰å…¨æˆ–è€…è¯¦ç»†çš„æ£€æŸ¥ã€‚    return fail(&#39;Unexhaustive&#39;);} function fail(message: string): never {  throw new Error(message);}</code></pre><h3 id="neverä¸voidçš„åŒºåˆ«"><a href="#neverä¸voidçš„åŒºåˆ«" class="headerlink" title="neverä¸voidçš„åŒºåˆ«"></a>neverä¸voidçš„åŒºåˆ«</h3><p>void è¡¨ç¤ºæ²¡æœ‰ä»»ä½•ç±»å‹ï¼Œnever è¡¨ç¤ºæ°¸è¿œä¸å­˜åœ¨çš„å€¼çš„ç±»å‹ã€‚</p><h2 id="è¾¨æè”åˆç±»å‹"><a href="#è¾¨æè”åˆç±»å‹" class="headerlink" title="è¾¨æè”åˆç±»å‹"></a>è¾¨æè”åˆç±»å‹</h2><p>å½“ç±»ä¸­å«æœ‰å­—é¢é‡æˆå‘˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¯¥ç±»çš„å±æ€§æ¥è¾¨æè”åˆç±»å‹ã€‚</p><pre><code class="js">interface Square {  kind: &#39;square&#39;;  size: number;}interface Rectangle {  kind: &#39;rectangle&#39;;  width: number;  height: number;}type Shape = Square | Rectangle;</code></pre><h2 id="æµåŠ¨çš„ç±»å‹"><a href="#æµåŠ¨çš„ç±»å‹" class="headerlink" title="æµåŠ¨çš„ç±»å‹"></a>æµåŠ¨çš„ç±»å‹</h2><p>TypeScript ç±»å‹ç³»ç»Ÿéå¸¸å¼ºå¤§ï¼Œå®ƒæ”¯æŒå…¶ä»–ä»»ä½•å•ä¸€è¯­è¨€æ— æ³•å®ç°çš„ç±»å‹æµåŠ¨å’Œç±»å‹ç‰‡æ®µã€‚<br>å…³é”®çš„åŠ¨æœºï¼šå½“ä½ æ”¹å˜äº†å…¶ä¸­ä¸€ä¸ªæ—¶ï¼Œå…¶ä»–ç›¸å…³çš„ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œå¹¶ä¸”å½“æœ‰äº‹æƒ…å˜ç³Ÿç³•æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªå‹å¥½çš„æç¤ºï¼Œå°±å¥½åƒä¸€ä¸ªè¢«ç²¾å¿ƒè®¾è®¡è¿‡çš„çº¦æŸç³»ç»Ÿã€‚</p><h3 id="å¤åˆ¶ç±»å‹å’Œå€¼"><a href="#å¤åˆ¶ç±»å‹å’Œå€¼" class="headerlink" title="å¤åˆ¶ç±»å‹å’Œå€¼"></a>å¤åˆ¶ç±»å‹å’Œå€¼</h3><p>å¦‚æœä½ æƒ³ç§»åŠ¨ä¸€ä¸ªç±»ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦åšä»¥ä¸‹äº‹æƒ…ï¼š</p><pre><code class="js">class Foo {}const Bar = Foo;let bar: Bar; // Error: ä¸èƒ½æ‰¾åˆ°åç§° &#39;Bar&#39;//è¿™ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸º const ä»…ä»…æ˜¯å¤åˆ¶äº† Foo åˆ°ä¸€ä¸ªå˜é‡å£°æ˜ç©ºé—´ï¼Œå› æ­¤ä½ æ— æ³•æŠŠ Bar å½“ä½œä¸€ä¸ªç±»å‹å£°æ˜ä½¿ç”¨ã€‚æ­£ç¡®çš„æ–¹å¼æ˜¯ä½¿ç”¨ import å…³é”®å­—ï¼Œè¯·æ³¨æ„ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨ namespace æˆ–è€… modulesï¼Œä½¿ç”¨ import æ˜¯ä½ å”¯ä¸€èƒ½ç”¨çš„æ–¹å¼ï¼šnamespace importing {  export class Foo {}}import Bar = importing.Foo;let bar: Bar; // ok//è¿™ä¸ª import æŠ€å·§ï¼Œä»…é€‚åˆäºç±»å‹å’Œå˜é‡ã€‚</code></pre><h3 id="æ•è·å˜é‡çš„ç±»å‹"><a href="#æ•è·å˜é‡çš„ç±»å‹" class="headerlink" title="æ•è·å˜é‡çš„ç±»å‹"></a>æ•è·å˜é‡çš„ç±»å‹</h3><p>ä½ å¯ä»¥é€šè¿‡ typeof æ“ä½œç¬¦åœ¨ç±»å‹æ³¨è§£ä¸­ä½¿ç”¨å˜é‡    </p><h2 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h2><p>JavaScript æœ‰ä¸€ä¸ª Error ç±»ï¼Œç”¨äºå¤„ç†å¼‚å¸¸ã€‚ä½ å¯ä»¥é€šè¿‡ throw å…³é”®å­—æ¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ç„¶åé€šè¿‡ try/catch å—æ¥æ•è·æ­¤é”™è¯¯ï¼š</p><pre><code class="js">try{    throw new Error(&#39;Something bad happened&#39;);}catch(e){    console.log(e)}</code></pre><p>é™¤å†…ç½®çš„ Error ç±»å¤–ï¼Œè¿˜æœ‰ä¸€äº›é¢å¤–çš„å†…ç½®é”™è¯¯ï¼Œå®ƒä»¬ç»§æ‰¿è‡ª Error ç±»ï¼š<code>RangeError,ReferenceError,SyntaxError,TypeError,URIError</code></p><h2 id="æ··åˆ"><a href="#æ··åˆ" class="headerlink" title="æ··åˆ"></a>æ··åˆ</h2><p>TypeScript (å’Œ JavaScript) ç±»åªèƒ½ä¸¥æ ¼çš„å•ç»§æ‰¿ï¼Œå› æ­¤ä½ ä¸èƒ½åšï¼š</p><pre><code class="js">class User extends Tagged, Timestamped { // ERROR : ä¸èƒ½å¤šé‡ç»§æ‰¿  // ..}</code></pre><p>ä»å¯é‡ç”¨ç»„ä»¶æ„å»ºç±»çš„å¦ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡åŸºç±»æ¥æ„å»ºå®ƒä»¬ï¼Œè¿™ç§æ–¹å¼ç§°ä¸ºæ··åˆã€‚</p><h2 id="å¸¸è§çš„typescripté”™è¯¯"><a href="#å¸¸è§çš„typescripté”™è¯¯" class="headerlink" title="å¸¸è§çš„typescripté”™è¯¯"></a>å¸¸è§çš„typescripté”™è¯¯</h2><p><a href="https://jkchao.github.io/typescript-book-chinese/error/common.html#ts2304" target="_blank" rel="noopener">å¸¸è§çš„typescripté”™è¯¯</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»€ä¹ˆæ˜¯laaS,PaaS,SaaS?</title>
      <link href="/2020/04/16/%E6%9C%8D%E5%8A%A1/%E4%BB%80%E4%B9%88%E6%98%AFlaaS-PaaS-SaaS/"/>
      <url>/2020/04/16/%E6%9C%8D%E5%8A%A1/%E4%BB%80%E4%B9%88%E6%98%AFlaaS-PaaS-SaaS/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><blockquote><p>é¦–å…ˆäº‘æœåŠ¡å™¨å¯ä»¥åˆ†ä¸º</p><ul><li>IaaSï¼šåŸºç¡€è®¾æ–½å³æœåŠ¡ï¼Œ<code>Infrastructure-as-a-service</code></li><li>PaaSï¼šå¹³å°å³æœåŠ¡ï¼Œ<code>Platform-as-a-service</code></li><li>SaaSï¼šè½¯ä»¶å³æœåŠ¡ï¼Œ<code>Software-as-a-service</code></li><li>æ•°æ®å³æœåŠ¡ï¼šå¦‚é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ï¼Œä¸ƒç‰›äº‘å­˜å‚¨ç­‰</li><li>å…¶ä»–è½¯ä»¶æœåŠ¡ï¼šæœºå™¨å­¦ä¹ ã€äººå·¥æ™ºèƒ½ç­‰</li></ul></blockquote><p>å…¬å¸è¦å¼€å‘ä¸€ä¸ª<code>SaaSäº‘æœåŠ¡å™¨</code>çš„è½¯ä»¶ï¼Œå€Ÿæ­¤æ¥åŠ æ·±ä¸‹lasS,PaaS,SaaSçš„æ¦‚å¿µåŠåŒºåˆ«</p><h2 id="æ¯”å–»lasS-PaaS-SaaS"><a href="#æ¯”å–»lasS-PaaS-SaaS" class="headerlink" title="æ¯”å–»lasS,PaaS,SaaS"></a>æ¯”å–»lasS,PaaS,SaaS</h2><p><a href="http://www.ruanyifeng.com/blog/2017/07/iaas-paas-saas.html" target="_blank" rel="noopener">æ¯”å–»æ¥è‡ªé˜®ä¸€å³°çš„ç½‘ç«™</a></p><p>è¯·è®¾æƒ³ä½ æ˜¯ä¸€ä¸ªé¤é¥®ä¸šè€…ï¼Œæ‰“ç®—åšæŠ«è¨ç”Ÿæ„ã€‚</p><p>ä½ å¯ä»¥ä»å¤´åˆ°å°¾ï¼Œè‡ªå·±ç”Ÿäº§æŠ«è¨ï¼Œä½†æ˜¯è¿™æ ·æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦å‡†å¤‡çš„ä¸œè¥¿å¤šï¼Œå› æ­¤ä½ å†³å®šå¤–åŒ…ä¸€éƒ¨åˆ†å·¥ä½œï¼Œé‡‡ç”¨ä»–äººçš„æœåŠ¡ã€‚ä½ æœ‰ä¸‰ä¸ªæ–¹æ¡ˆã€‚</p><p>ï¼ˆ1ï¼‰æ–¹æ¡ˆä¸€ï¼šIaaS</p><p>ä»–äººæä¾›å¨æˆ¿ã€ç‚‰å­ã€ç…¤æ°”ï¼Œä½ ä½¿ç”¨è¿™äº›åŸºç¡€è®¾æ–½ï¼Œæ¥çƒ¤ä½ çš„æŠ«è¨ã€‚</p><p>ï¼ˆ2ï¼‰æ–¹æ¡ˆäºŒï¼šPaaS</p><p>é™¤äº†åŸºç¡€è®¾æ–½ï¼Œä»–äººè¿˜æä¾›æŠ«è¨é¥¼çš®ã€‚<br>ä½ åªè¦æŠŠè‡ªå·±çš„é…æ–™æ´’åœ¨é¥¼çš®ä¸Šï¼Œè®©ä»–å¸®ä½ çƒ¤å‡ºæ¥å°±è¡Œäº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ è¦åšçš„å°±æ˜¯è®¾è®¡æŠ«è¨çš„å‘³é“ï¼ˆæµ·é²œæŠ«è¨æˆ–è€…é¸¡è‚‰æŠ«è¨ï¼‰ï¼Œä»–äººæä¾›å¹³å°æœåŠ¡ï¼Œè®©ä½ æŠŠè‡ªå·±çš„è®¾è®¡å®ç°ã€‚</p><p>ï¼ˆ3ï¼‰æ–¹æ¡ˆä¸‰ï¼šSaaS</p><p>ä»–äººç›´æ¥åšå¥½äº†æŠ«è¨ï¼Œä¸ç”¨ä½ çš„ä»‹å…¥ï¼Œåˆ°æ‰‹çš„å°±æ˜¯ä¸€ä¸ªæˆå“ã€‚ä½ è¦åšçš„å°±æ˜¯æŠŠå®ƒå–å‡ºå»ï¼Œæœ€å¤šå†åŒ…è£…ä¸€ä¸‹ï¼Œå°ä¸Šä½ è‡ªå·±çš„ Logoã€‚</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017072306.png" alt="æŠ«è¨"></p><p>ä»å·¦åˆ°å³ï¼Œè‡ªå·±æ‰¿æ‹…çš„å·¥ä½œé‡ï¼ˆä¸Šå›¾è“è‰²éƒ¨åˆ†ï¼‰è¶Šæ¥è¶Šå°‘ï¼ŒIaaS &gt; PaaS &gt; SaaSã€‚</p><p>å¯¹åº”è½¯ä»¶å¼€å‘ï¼Œåˆ™æ˜¯ä¸‹é¢è¿™å¼ å›¾ã€‚</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017072307.jpg" alt="å¼€å‘æµç¨‹"></p><p>SaaS æ˜¯è½¯ä»¶çš„å¼€å‘ã€ç®¡ç†ã€éƒ¨ç½²éƒ½äº¤ç»™ç¬¬ä¸‰æ–¹ï¼Œä¸éœ€è¦å…³å¿ƒæŠ€æœ¯é—®é¢˜ï¼Œå¯ä»¥æ‹¿æ¥å³ç”¨ã€‚æ™®é€šç”¨æˆ·æ¥è§¦åˆ°çš„äº’è”ç½‘æœåŠ¡ï¼Œå‡ ä¹éƒ½æ˜¯ SaaSï¼Œä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ã€‚</p><blockquote><ul><li>å®¢æˆ·ç®¡ç†æœåŠ¡ Salesforce</li><li>å›¢é˜ŸååŒæœåŠ¡ Google Apps</li><li>å‚¨å­˜æœåŠ¡ Box</li><li>å‚¨å­˜æœåŠ¡ Dropbox</li><li>ç¤¾äº¤æœåŠ¡ Facebook / Twitter / Instagram</li></ul></blockquote><p>PaaS æä¾›è½¯ä»¶éƒ¨ç½²å¹³å°ï¼ˆruntimeï¼‰ï¼ŒæŠ½è±¡æ‰äº†ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿç»†èŠ‚ï¼Œå¯ä»¥æ— ç¼åœ°æ‰©å±•ï¼ˆscalingï¼‰ã€‚å¼€å‘è€…åªéœ€è¦å…³æ³¨è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¸éœ€è¦å…³æ³¨åº•å±‚ã€‚ä¸‹é¢è¿™äº›éƒ½å±äº PaaSã€‚</p><blockquote><ul><li>Heroku</li><li>Google App Engine</li><li>OpenShift</li></ul></blockquote><p>IaaS æ˜¯äº‘æœåŠ¡çš„æœ€åº•å±‚ï¼Œä¸»è¦æä¾›ä¸€äº›åŸºç¡€èµ„æºã€‚å®ƒä¸ PaaS çš„åŒºåˆ«æ˜¯ï¼Œç”¨æˆ·éœ€è¦è‡ªå·±æ§åˆ¶åº•å±‚ï¼Œå®ç°åŸºç¡€è®¾æ–½çš„ä½¿ç”¨é€»è¾‘ã€‚ä¸‹é¢è¿™äº›éƒ½å±äº IaaSã€‚</p><blockquote><ul><li>Amazon EC2</li><li>Digital Ocean</li><li>RackSpace Cloud</li></ul></blockquote><h2 id="SaaSè¯¦ç»†ä»‹ç»"><a href="#SaaSè¯¦ç»†ä»‹ç»" class="headerlink" title="SaaSè¯¦ç»†ä»‹ç»"></a>SaaSè¯¦ç»†ä»‹ç»</h2><p>æˆ‘ä»¬å°†ç€é‡ä»‹ç»SaaSæ¶æ„è®¾è®¡,å¹¶å›´ç»•WHATï¼ˆæ˜¯ä»€ä¹ˆï¼Ÿï¼‰ã€WHYï¼ˆä¸ºä»€ä¹ˆï¼Ÿï¼‰ã€WHEREï¼ˆåœ¨å“ªé‡Œï¼Ÿï¼‰å’ŒHOWï¼ˆæ€ä¹ˆæ ·ï¼Ÿï¼‰è¿™å››ä¸ªé—®é¢˜</p><h3 id="ä»€ä¹ˆæ˜¯SaaSï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯SaaSï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯SaaSï¼Ÿ"></a>ä»€ä¹ˆæ˜¯SaaSï¼Ÿ</h3><p><img src="https://user-gold-cdn.xitu.io/2019/6/3/16b1a96e7d4e0ce5?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="SaaS"></p><p>ä»å®è§‚çš„è§’åº¦æ¥çœ‹ï¼ŒSaaSæ˜¯ä¸€ç§è½¯ä»¶åº”ç”¨ç¨‹åºäº¤ä»˜æ–¹å¼ï¼Œè½¯ä»¶æä¾›å•†é›†ä¸­åŒ–æ‰˜ç®¡ä¸€ä¸ªæˆ–å¤šä¸ªè½¯ä»¶åº”ç”¨ç¨‹åºï¼Œå¹¶é€šè¿‡äº’è”ç½‘å‘ç§Ÿæˆ·ä½“ç”¨è¿™äº›è½¯ä»¶åº”ç”¨ç¨‹åº;ä»åˆ†ç±»ä¸Šè®²SaaSä¹Ÿæ˜¯äº‘è®¡ç®—çš„ä¸€éƒ¨åˆ†</p><p>SaaSåº”ç”¨ç¨‹åºçš„ä»»ä½•æ›´æ–°æˆ–è€…ä¿®å¤æ¼æ´æ“ä½œéƒ½æ˜¯ç”±è½¯ä»¶æä¾›å•†è´Ÿè´£å®æ–½å’Œå¤„ç†çš„ï¼Œç”±äºç§Ÿæˆ·æ˜¯é€šè¿‡äº’è”ç½‘è·å–è½¯ä»¶æœåŠ¡ï¼Œæ‰€ä»¥ç§Ÿæˆ·ç«¯æ— éœ€ä¸‹è½½ä»»ä½•çš„å‡çº§åŒ…æˆ–è€…ä¿®å¤è¡¥ä¸ï¼Œæ˜¯ä¸€ç§å¼€ç®±å³è·å–æœ€æ–°è½¯ä»¶äº§å“çš„æœåŠ¡æ–¹å¼ã€‚</p><h3 id="ä¸ºä»€ä¹ˆé€‰æ‹©SaaSï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©SaaSï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹©SaaSï¼Ÿ"></a>ä¸ºä»€ä¹ˆé€‰æ‹©SaaSï¼Ÿ</h3><h4 id="1-æ¶ˆè´¹è€…è§’åº¦"><a href="#1-æ¶ˆè´¹è€…è§’åº¦" class="headerlink" title="1.æ¶ˆè´¹è€…è§’åº¦"></a>1.æ¶ˆè´¹è€…è§’åº¦</h4><p>è·å–è½¯ä»¶æœåŠ¡çš„æ–¹å¼è¶³å¤Ÿç®€å•ï¼ŒSaaSä¹Ÿè®¸æ˜¯è¿„ä»Šä¸ºæ­¢ä½¿ç”¨è½¯ä»¶æœ€ç®€å•çš„æ–¹å¼ä¹‹ä¸€ï¼Œç§Ÿæˆ·åªéœ€è¦åŠ¨åŠ¨é¼ æ ‡å’Œé”®ç›˜ï¼Œå³å¯åœ¨å‡ å°æ—¶ç”šè‡³å‡ åˆ†é’Ÿå†…è·å¾—ä¸€ä¸ªå¤§å‹çš„è½¯ä»¶æœåŠ¡ã€‚ç›¸æ¯”äºä¼ ç»Ÿä½¿ç”¨è½¯ä»¶çš„æ–¹å¼ï¼Œç§Ÿæˆ·çœå»äº†ç ”å‘ã€éƒ¨ç½²ã€è¿ç»´ç­‰ä¸€ç³»åˆ—ç¹å¤çš„è¿‡ç¨‹ï¼Œä¸”è·å¾—è½¯ä»¶çš„æ—¶é—´å’Œè´¹ç”¨æˆæœ¬éƒ½å¤§å¹…åº¦é™ä½</p><h4 id="2-å•†ä¸šè§’åº¦"><a href="#2-å•†ä¸šè§’åº¦" class="headerlink" title="2.å•†ä¸šè§’åº¦"></a>2.å•†ä¸šè§’åº¦</h4><p>SaaSå¯ä»¥ä½“ç”¨è·¨åœ°åŸŸã€è·¨å¹³å°çš„è½¯ä»¶æœåŠ¡ã€‚ä¸æ­¤åŒæ—¶ï¼Œè½¯ä»¶æœåŠ¡å•†å¯ä»¥ç»Ÿä¸€å¯¹è½¯ä»¶è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œè¿™å°†å¸¦æ¥ä»¥ä¸‹å‡ ç‚¹å¥½å¤„ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºï¼‰ï¼š</p><p>1ã€ç¼©çŸ­äº§å“ä¸Šçº¿æ—¶é—´ï¼šå¤šç«¯é€‚é…ï¼Œç»Ÿä¸€ç‰ˆæœ¬ï¼Œç»Ÿä¸€æ›´æ–°<br>2ã€é™ä½ç»´æŠ¤æˆæœ¬ï¼šä¸éœ€è¦åŒæ—¶ç»´æŠ¤å¤šä¸ªç‰ˆæœ¬çš„è½¯ä»¶å®ä¾‹ï¼Œè¿ç»´å‹åŠ›å‡å°<br>3ã€å®¹æ˜“å‡çº§ï¼šç”±äºç‰ˆæœ¬å¾—åˆ°æœ‰æ•ˆæ§åˆ¶ï¼Œä¸€æ¬¡å‡çº§ï¼Œå³å¯è¦†ç›–æ‰€æœ‰ç§Ÿæˆ·ç«¯</p><h3 id="SaaSçš„ç‰¹æ€§åŠä¼˜åŠ¿æ˜¯ä»€ä¹ˆ"><a href="#SaaSçš„ç‰¹æ€§åŠä¼˜åŠ¿æ˜¯ä»€ä¹ˆ" class="headerlink" title="SaaSçš„ç‰¹æ€§åŠä¼˜åŠ¿æ˜¯ä»€ä¹ˆ?"></a>SaaSçš„ç‰¹æ€§åŠä¼˜åŠ¿æ˜¯ä»€ä¹ˆ?</h3><p>1.ç®€å•<br>2.ç»æµå®æƒ <br>3.å®‰å…¨<br>4.å…¼ä»»æ€§</p><h3 id="SaaSè½¯ä»¶çš„é€‚ç”¨èŒƒå›´"><a href="#SaaSè½¯ä»¶çš„é€‚ç”¨èŒƒå›´" class="headerlink" title="SaaSè½¯ä»¶çš„é€‚ç”¨èŒƒå›´"></a>SaaSè½¯ä»¶çš„é€‚ç”¨èŒƒå›´</h3><p>ä»ç†è®ºä¸Šè®²ï¼ŒSaaSå¯ä»¥å°†ä»»ä½•çš„è½¯ä»¶SaaSï¼Œä¸‹é¢åˆ—ä¸¾ä¸€äº›é€šç”¨çš„åˆ†ç±»ä¾›å¤§å®¶å‚è€ƒï¼š</p><p>1ã€Officeåœ¨çº¿åŠå…¬ç±»SaaSäº§å“<br>2ã€ç”µå­é‚®ä»¶å’Œå³æ—¶æ¶ˆæ¯ç±»SaaSäº§å“<br>3ã€ç¤¾äº¤åª’ä½“ç±»SaaSäº§å“<br>4ã€ç¬¬ä¸‰æ–¹APIç±»SaaSäº§å“<br>5ã€å®‰å…¨å’Œè®¿é—®æ§åˆ¶ç±»SaaSäº§å“<br>6ã€æœºå™¨å­¦ä¹ ç±»SaaSäº§å“<br>7ã€äººå·¥æ™ºèƒ½ç±»SaaSäº§å“<br>8ã€åœ°ç†ä½ç½®æœåŠ¡ç±»SaaSäº§å“<br>9ã€æ•°æ®æµå’Œæ•°æ®æ£€ç´¢ç±»SaaSäº§å“</p><h3 id="SaaSäº§å“çš„ç¼ºé™·"><a href="#SaaSäº§å“çš„ç¼ºé™·" class="headerlink" title="SaaSäº§å“çš„ç¼ºé™·"></a>SaaSäº§å“çš„ç¼ºé™·</h3><h4 id="1-è½¯ä»¶æ§åˆ¶æƒ"><a href="#1-è½¯ä»¶æ§åˆ¶æƒ" class="headerlink" title="1.è½¯ä»¶æ§åˆ¶æƒ"></a>1.è½¯ä»¶æ§åˆ¶æƒ</h4><p>ä¸ä¼ä¸šå†…éƒ¨éƒ¨ç½²çš„è½¯ä»¶ä¸åŒï¼Œç”±äºSaaSè½¯ä»¶è¢«å‡»ä¸­æ‰˜ç®¡åœ¨æœåŠ¡æä¾›å•†çš„WebæœåŠ¡å™¨ä¸­ï¼Œæ‰€ä»¥ç§Ÿæˆ·æ— æ³•æ§åˆ¶æ‰€æœ‰çš„è½¯ä»¶åº”ç”¨ç¨‹åºï¼ŒSaaSåŒ–çš„è½¯ä»¶æ¯”ä¼ä¸šè‡ªè¡Œéƒ¨ç½²çš„è½¯ä»¶è·å¾—çš„æ§åˆ¶æƒæ›´å°‘ï¼Œç§Ÿæˆ·å¯æ“ä½œçš„è‡ªå®šä¹‰æ§åˆ¶æƒæåº¦æœ‰é™ã€‚</p><h4 id="2-æ¶ˆè´¹è€…åŸºæ•°å°"><a href="#2-æ¶ˆè´¹è€…åŸºæ•°å°" class="headerlink" title="2.æ¶ˆè´¹è€…åŸºæ•°å°"></a>2.æ¶ˆè´¹è€…åŸºæ•°å°</h4><p>ç”±äºSaaSè½¯ä»¶æ˜¯å°†ä¸€å¥—åº”ç”¨ç¨‹åºå…±äº«ç»™ä¸€ä¸ªæˆ–è€…å¤šä¸ªç§Ÿæˆ·å…±åŒä½¿ç”¨ï¼Œè¿™ç§å…±äº«çš„æ¶ˆè´¹æ–¹å¼è¿˜æœªè¢«å¤§å¤šæ•°çš„æ¶ˆè´¹è€…æ‰€æ¥å—ã€‚åŒæ—¶ï¼Œå—åˆ¶äºå¸‚åœºç¯å¢ƒçš„å½±å“ï¼Œç›®å‰è¿˜æœ‰å¤§å¤šæ•°çš„è½¯ä»¶è¿˜æœªSaaSåŒ–</p><h4 id="3-æ€§èƒ½ç“¶é¢ˆ"><a href="#3-æ€§èƒ½ç“¶é¢ˆ" class="headerlink" title="3.æ€§èƒ½ç“¶é¢ˆ"></a>3.æ€§èƒ½ç“¶é¢ˆ</h4><p>å…±äº«åº”ç”¨ç¨‹åºå¿…ç„¶ä¼šå¸¦æ¥æœåŠ¡å™¨æ€§èƒ½çš„ä¸‹é™ã€å¦‚è®¡ç®—é€Ÿåº¦ã€ç½‘ç»œèµ„æºã€I/Oè¯»å†™ç­‰éƒ½å°†é¢ä¸´ä¸¥å³»çš„è€ƒéªŒã€‚åœ¨æ€§èƒ½æ–¹é¢ï¼Œä¼ä¸šå†…éƒ¨éƒ¨ç½²çš„â€œç‹¬äº«æ¨¡å¼â€çš„åº”ç”¨ç¨‹åºæ¯”SaaSè½¯ä»¶çš„â€œå…±äº«æ¨¡å¼â€ç•¥èƒœä¸€ç­¹ã€‚</p><h4 id="4-å®‰å…¨é—®é¢˜"><a href="#4-å®‰å…¨é—®é¢˜" class="headerlink" title="4.å®‰å…¨é—®é¢˜"></a>4.å®‰å…¨é—®é¢˜</h4><p>å½“ç§Ÿæˆ·åœ¨é€‰æ‹©ä¸€æ¬¾SaaSäº§å“æ—¶ï¼Œäº§å“çš„å®‰å…¨æ€§å°†ä¼šè¢«æ”¾ç½®åœ¨ç¬¬ä¸€ä½è¿›è¡Œè€ƒè™‘ã€‚å¦‚æ•°æ®çš„éš”ç¦»ã€æ•æ„Ÿæ•°æ®çš„åŠ å¯†ã€æ•°æ®è®¿é—®æƒé™æ§åˆ¶ã€ä¸ªäººéšç§ç­‰é—®é¢˜ã€‚</p><h3 id="SaaSäº§å“çš„æ ¸å¿ƒç»„ä»¶"><a href="#SaaSäº§å“çš„æ ¸å¿ƒç»„ä»¶" class="headerlink" title="SaaSäº§å“çš„æ ¸å¿ƒç»„ä»¶"></a>SaaSäº§å“çš„æ ¸å¿ƒç»„ä»¶</h3><p>ä¸åŒç±»å‹çš„SaaSäº§å“ï¼Œç”±äºè¦é¢å¯¹ä¸åŒçš„ç”¨æˆ·æ„¿æ™¯ï¼Œå¯èƒ½åœ¨åŠŸèƒ½å’Œä¸šåŠ¡ä¸Šä¼šæœ‰æ‰€ä¸åŒï¼Œä½†ä»»ä½•ä¸€ä¸ªSaaSäº§å“ï¼Œéƒ½å…·å¤‡ä»¥ä¸‹å‡ ä¸ªå…±åŒçš„æ ¸å¿ƒç»„ä»¶ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2019/6/3/16b1a96e7628ebeb?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="æ ¸å¿ƒç»„ä»¶"></p><h4 id="å®‰å…¨ç»„ä»¶"><a href="#å®‰å…¨ç»„ä»¶" class="headerlink" title="å®‰å…¨ç»„ä»¶"></a>å®‰å…¨ç»„ä»¶</h4><p>åœ¨SaaSäº§å“ä¸­ï¼Œç³»ç»Ÿå®‰å…¨æ°¸è¿œæ˜¯ç¬¬ä¸€ä½éœ€è¦è€ƒè™‘çš„äº‹æƒ…ï¼Œå¦‚ä½•ä¿éšœç§Ÿæˆ·æ•°æ®çš„å®‰å…¨ï¼Œæ˜¯ä½ é¦–è¦çš„äº‹æƒ…ã€‚è¿™å¦‚åŒé“¶è¡Œé¦–é€‰éœ€è¦ä¿éšœå‚¨æˆ·èµ„é‡‘å®‰å…¨ä¸€æ ·ã€‚å®‰å…¨ç»„ä»¶å°±æ˜¯ç»Ÿä¸€çš„å¯¹SaaSäº§å“è¿›è¡Œå®‰å…¨é˜²æŠ¤ï¼Œä¿éšœç³»ç»Ÿæ•°æ®å®‰å…¨ã€‚</p><h4 id="æ•°æ®éš”ç¦»ç»„ä»¶"><a href="#æ•°æ®éš”ç¦»ç»„ä»¶" class="headerlink" title="æ•°æ®éš”ç¦»ç»„ä»¶"></a>æ•°æ®éš”ç¦»ç»„ä»¶</h4><p>å®‰å…¨ç»„ä»¶è§£å†³äº†ç”¨æˆ·æ•°æ®å®‰å…¨å¯é çš„é—®é¢˜ï¼Œä½†æ•°æ®å¾€å¾€è¿˜éœ€è¦è§£å†³éšç§é—®é¢˜ï¼Œå„ä¼ä¸šä¹‹é—´çš„æ•°æ®å¿…é¡»ç›¸äº’ä¸å¯è§ï¼Œå³ç›¸äº’éš”ç¦»ã€‚åœ¨SaaSäº§å“ä¸­ï¼Œå¦‚ä½•è¯†åˆ«ã€åŒºåˆ†ã€éš”ç¦»ä¸ªç§Ÿæˆ·çš„æ•°æ®æ—¶ä½ åœ¨å®æ–½SaaSè½¯ä»¶æ¶æ„è®¾è®¡æ—¶éœ€è¦è€ƒè™‘çš„ç¬¬äºŒä¸ªé—®é¢˜ã€‚</p><h4 id="å¯é…ç½®ç»„ä»¶"><a href="#å¯é…ç½®ç»„ä»¶" class="headerlink" title="å¯é…ç½®ç»„ä»¶"></a>å¯é…ç½®ç»„ä»¶</h4><p>å°½ç®¡SaaSäº§å“åœ¨è®¾è®¡ä¹‹åˆå°±è€ƒè™‘äº†å¤§å¤šæ•°é€šç”¨çš„åŠŸèƒ½ï¼Œè®©ç§Ÿæˆ·å¼€ç®±å³ç”¨ï¼Œä½†ä»»ç„¶æœ‰ä¸ºæ•°ä¸å°‘çš„ç§Ÿæˆ·éœ€è¦å®šåˆ¶æœåŠ¡è‡ªèº«ä¸šåŠ¡éœ€æ±‚çš„é…ç½®é¡¹ï¼Œå¦‚UIå¸ƒå±€ã€ä¸»é¢˜ã€æ ‡è¯†ï¼ˆLogoï¼‰ç­‰ä¿¡æ¯ã€‚æ­£å› ä¸ºæ— æ³•æŠ½è±¡å‡ºä¸€ä¸ªå®Œå…¨é€šç”¨çš„åº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥åœ¨SaaSäº§å“ä¸­ï¼Œä½ éœ€è¦æä¾›ä¸€ä¸ªå¯ç”¨äºè‡ªå®šä¹‰é…ç½®çš„ç»„ä»¶ã€‚</p><h4 id="å¯æ‰©å±•ç»„ä»¶"><a href="#å¯æ‰©å±•ç»„ä»¶" class="headerlink" title="å¯æ‰©å±•ç»„ä»¶"></a>å¯æ‰©å±•ç»„ä»¶</h4><p>éšç€SaaSäº§å“ä¸šåŠ¡å’Œç§Ÿæˆ·æ•°é‡çš„å¢é•¿ï¼ŒåŸæœ‰çš„æœåŠ¡å™¨é…ç½®å°†æ— æ³•ç»§ç»­æ»¡è¶³æ–°çš„éœ€æ±‚ï¼Œç³»ç»Ÿæ€§èƒ½å°†ä¼šä¸ä¸šåŠ¡é‡å’Œç”¨æˆ·é‡æˆåæ¯”ã€‚æ­¤æ—¶ï¼ŒSaaSäº§å“åº”è¯¥å…·å¤‡æ°´å¹³æ‰©å±•çš„èƒ½åŠ›ã€‚å¦‚é€šè¿‡ç½‘ç»œè´Ÿè½½å‡è¡¡å…¶å’Œå®¹å™¨æŠ€æœ¯ï¼Œåœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šéƒ¨ç½²å¤šä¸ªè½¯ä»¶è¿è¡Œç¤ºä¾‹å¹¶æä¾›ç›¸åŒçš„è½¯ä»¶æœåŠ¡ï¼Œä»¥æ­¤å®ç°æ°´å¹³æ‰©å±•SaaSäº§å“çš„æ•´ä½“æœåŠ¡æ€§èƒ½ã€‚ä¸ºäº†å®ç°å¯æ‰©å±•èƒ½åŠ›ï¼Œå°±éœ€è¦SaaSå±•ç¤ºå±‚çš„ä»£ç ä¸ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†çš„ä»£ç è¿›è¡Œåˆ†ç¦»ï¼Œä¸¤è€…ç‹¬ç«‹éƒ¨ç½²ã€‚ä¾‹å¦‚<strong>ä½¿ç”¨VUE+å¾®æœåŠ¡æ„å»ºå‰åç«¯åˆ†ç¦»ä¸”å¯æ°´å¹³è¿›è¡Œæ‰©å±•çš„åˆ†å¸ƒå¼SaaSåº”ç”¨äº§å“</strong>ã€‚å¯¹äºå¯æ‰©å±•ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§æ–¹å¼ï¼Œå³<strong>å‚ç›´æ‰©å±•</strong>ï¼Œå…¶åšæ³•æ¯”è¾ƒç®€å•ï¼Œä¹Ÿæ¯”è¾ƒç²—æš´ï¼šé€šè¿‡å¢åŠ å•å°æœåŠ¡å™¨çš„é…ç½®ï¼Œå¦‚è´­ä¹°æ€§èƒ½æ›´å¥½çš„CUPã€å­˜å‚¨æ›´å¤§çš„å†…å­˜æ¡ã€å¢å¤§å¸¦å®½ç­‰æªæ–½ï¼Œè®©æœåŠ¡å™¨èƒ½å¤Ÿå¤„ç†æ›´å¤šçš„ç”¨æˆ·è¯·æ±‚ã€‚ä½†æ­¤åšæ³•å¯¹äºæå‡äº§å“æ€§èƒ½æ²¡æœ‰è´¨çš„æ”¹å˜ï¼Œä¸”æˆæœ¬å¾ˆé«˜ã€‚</p><h4 id="0åœæœºæ—¶é—´å‡çº§äº§å“"><a href="#0åœæœºæ—¶é—´å‡çº§äº§å“" class="headerlink" title="0åœæœºæ—¶é—´å‡çº§äº§å“"></a>0åœæœºæ—¶é—´å‡çº§äº§å“</h4><p>ä»¥å¾€çš„è½¯ä»¶åœ¨å‡çº§æˆ–è€…ä¿®å¤Bugæ—¶ï¼Œéƒ½éœ€è¦å°†è¿è¡Œçš„ç¨‹åºè„±æœºä¸€æ®µæ—¶é—´ï¼Œç­‰å¾…å‡çº§æˆ–ä¿®å¤å·¥ä½œå®Œæˆåï¼Œå†é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºã€‚è€ŒSaaSäº§å“åˆ™éœ€è¦å…¨å¤©å€™ä¿éšœæœåŠ¡çš„å¯ç”¨æ€§ã€‚è¿™å°±éœ€è¦ä½ è€ƒè™‘å¦‚ä½•å®ç°åœ¨ä¸é‡å¯åŸæœ‰åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹ï¼Œå®Œæˆåº”ç”¨ç¨‹åºçš„å‡çº§ä¿®å¤å·¥ä½œã€‚</p><h4 id="å¤šç§Ÿæˆ·ç»„ä»¶"><a href="#å¤šç§Ÿæˆ·ç»„ä»¶" class="headerlink" title="å¤šç§Ÿæˆ·ç»„ä»¶"></a>å¤šç§Ÿæˆ·ç»„ä»¶</h4><p>è¦å°†åŸæœ‰äº§å“SaaSåŒ–ï¼Œå°±å¿…é¡»æä¾›å¤šç§Ÿæˆ·ç»„ä»¶ï¼Œå¤šç§Ÿæˆ·ç»„ä»¶æ˜¯è¡¡é‡ä¸€ä¸ªåº”ç”¨ç¨‹åºæ˜¯å¦å…·å¤‡SaaSæœåŠ¡èƒ½åŠ›çš„é‡è¦æŒ‡æ ‡ä¹‹ä¸€ã€‚SaaSäº§å“éœ€è¦åŒæ—¶å®¹çº³å¤šä¸ªç§Ÿæˆ·çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜éœ€è¦ä¿è¯å„ç§Ÿæˆ·ä¹‹é—´çš„æ•°æ®ä¸ä¼šç›¸äº’å¹²æ‰°ï¼Œä¿è¯ç§Ÿæˆ·ä¸­çš„ç”¨æˆ·èƒ½å¤ŸæŒ‰æœŸæœ›ç´¢å¼•åˆ°æ­£ç¡®çš„æ•°æ®ï¼Œå¤šç§Ÿæˆ·ç»„ä»¶æ˜¯ä½ å¿…é¡»è¦è§£å†³çš„ä¸€ä¸ªé—®é¢˜ã€‚å…¶ä½™çš„ç»„ä»¶éƒ½å°†å›´ç»•æ­¤ç»„ä»¶å±•å¼€å„è‡ªçš„ä¸šåŠ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Serve </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœåŠ¡ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue.config.jsåŸºæœ¬é…ç½®</title>
      <link href="/2020/04/01/Vue/vue-config-js%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/"/>
      <url>/2020/04/01/Vue/vue-config-js%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<pre><code class="js">// vue.config.js åŸºæœ¬é…ç½®æ–¹æ³•module.exports = {  // é¡¹ç›®éƒ¨ç½²çš„åŸºç¡€è·¯å¾„  // æˆ‘ä»¬é»˜è®¤å‡è®¾ä½ çš„åº”ç”¨å°†ä¼šéƒ¨ç½²åœ¨åŸŸåçš„æ ¹éƒ¨ï¼Œ  // æ¯”å¦‚ https://www.my-app.com/  // å¦‚æœä½ çš„åº”ç”¨æ—¶éƒ¨ç½²åœ¨ä¸€ä¸ªå­è·¯å¾„ä¸‹ï¼Œé‚£ä¹ˆä½ éœ€è¦åœ¨è¿™é‡Œ  // æŒ‡å®šå­è·¯å¾„ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ çš„åº”ç”¨éƒ¨ç½²åœ¨  // https://www.foobar.com/my-app/  // é‚£ä¹ˆå°†è¿™ä¸ªå€¼æ”¹ä¸º `/my-app/`  // åŸºæœ¬è·¯å¾„ baseURLå·²ç»è¿‡æ—¶  publicPath: &#39;./&#39;,    // æ‰“åŒ…é¡¹ç›®æ—¶æ„å»ºçš„æ–‡ä»¶ç›®å½•ï¼Œç”¨æ³•ä¸webpackæœ¬èº«çš„output.pathä¸€è‡´  outputDir: &#39;dist&#39;,   // é™æ€èµ„æºç›®å½• (js, css, img, fonts)  assetsDir: &#39;assets&#39;,  // eslint-loader æ˜¯å¦åœ¨ä¿å­˜çš„æ—¶å€™æ£€æŸ¥ï¼Œç¼–è¯‘ä¸è§„èŒƒæ—¶ï¼Œè®¾ä¸ºtrueåœ¨å‘½ä»¤è¡Œä¸­è­¦å‘Šï¼Œè‹¥è®¾ä¸ºerroråˆ™ä¸ä»…è­¦å‘Šï¼Œå¹¶ä¸”ç¼–è¯‘å¤±è´¥  lintOnSave: true,  // è°ƒæ•´å†…éƒ¨çš„ webpack é…ç½®ã€‚æŸ¥é˜… https://github.com/vuejs/vue-docs-zh-cn/blob/master/vue-cli/webpack.md  chainWebpack: () =&gt; {},  configureWebpack: () =&gt; {},  // vue-loader é…ç½®é¡¹ https://vue-loader.vuejs.org/en/options.html   vueLoader: {},  // ç”Ÿäº§ç¯å¢ƒæ˜¯å¦ç”Ÿæˆ sourceMap æ–‡ä»¶ï¼Œé»˜è®¤trueï¼Œè‹¥ä¸éœ€è¦ç”Ÿäº§ç¯å¢ƒçš„sourceMapï¼Œå¯ä»¥è®¾ç½®ä¸ºfalseï¼ŒåŠ é€Ÿç”Ÿäº§ç¯å¢ƒçš„æ„å»º  productionSourceMap: true,  // cssç›¸å…³é…ç½®  css: {   // æ˜¯å¦ä½¿ç”¨cssåˆ†ç¦»æ’ä»¶ ExtractTextPluginï¼Œé‡‡ç”¨ç‹¬ç«‹æ ·å¼æ–‡ä»¶è½½å…¥ï¼Œä¸é‡‡ç”¨&lt;style&gt;æ–¹å¼å†…è”è‡³htmlæ–‡ä»¶ä¸­   extract: true,   // æ˜¯å¦åœ¨æ„å»ºæ ·å¼åœ°å›¾ï¼Œfalseå°†æé«˜æ„å»ºé€Ÿåº¦   sourceMap: false,   // cssé¢„è®¾å™¨é…ç½®é¡¹   loaderOptions: {},   // å¯ç”¨ CSS modules for all css / pre-processor files.   // è¿™ä¸ªé€‰é¡¹ä¸ä¼šå½±å“ `*.vue` æ–‡ä»¶   modules: false  },  // åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä¸º Babel å’Œ TypeScript ä½¿ç”¨ `thread-loader`  // åœ¨å¤šæ ¸æœºå™¨ä¸‹ä¼šé»˜è®¤å¼€å¯ã€‚  parallel: require(&#39;os&#39;).cpus().length &gt; 1,  // æ˜¯å¦å¯ç”¨dll See https://github.com/vuejs/vue-cli/blob/dev/docs/cli-service.md#dll-mode  dll: false,  // PWA æ’ä»¶ç›¸å…³é…ç½® see https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-pwa  pwa: {},  // webpack-dev-server ç›¸å…³é…ç½®  devServer: {   open: process.platform === &#39;darwin&#39;,   host: &#39;0.0.0.0&#39;,//å¦‚æœæ˜¯çœŸæœºæµ‹è¯•ï¼Œå°±ä½¿ç”¨è¿™ä¸ªIP   port: 1234,   https: false,   hotOnly: false,   proxy: null, // è®¾ç½®ä»£ç†   // proxy: {   //     &#39;/api&#39;: {   //         target: &#39;&lt;url&gt;&#39;,   //         ws: true,   //         changOrigin: true   //     }   // },   before: app =&gt; {}  },  // ç¬¬ä¸‰æ–¹æ’ä»¶é…ç½®  pluginOptions: {   // ...  } }</code></pre>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>&lt;æ·±å…¥ç†è§£TypeScriptè¯»ä¹¦ç¬”è®°&gt;ï¼ˆä¸€ï¼‰</title>
      <link href="/2020/03/25/Ts/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3TypeScript%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>/2020/03/25/Ts/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3TypeScript%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¹¦æœ¬åœ°å€"><a href="#ä¹¦æœ¬åœ°å€" class="headerlink" title="ä¹¦æœ¬åœ°å€"></a>ä¹¦æœ¬åœ°å€</h1><p><a href="https://jkchao.github.io/typescript-book-chinese/#why" target="_blank" rel="noopener">https://jkchao.github.io/typescript-book-chinese/#why</a></p><h2 id="ä»€ä¹ˆæ˜¯TypeScript-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨TypeScript"><a href="#ä»€ä¹ˆæ˜¯TypeScript-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨TypeScript" class="headerlink" title="ä»€ä¹ˆæ˜¯TypeScript,ä¸ºä»€ä¹ˆè¦ä½¿ç”¨TypeScript?"></a>ä»€ä¹ˆæ˜¯TypeScript,ä¸ºä»€ä¹ˆè¦ä½¿ç”¨TypeScript?</h2><p>æ ¹æ®TypeScriptå®˜ç½‘ä¸­çš„ä»‹ç»ï¼ŒTypeScript - JavaScript the scales (å±äºJsçš„è¶…é›†)ï¼ŒTså‘å±•è‡³ä»Šå·²ç»æ˜¯å¾ˆå¤šå¤§å‹é¡¹ç›®çš„æ ‡é…ï¼Œå®ƒæä¾›çš„é™æ€ç±»å‹æ£€æŸ¥ï¼Œå¤§å¤§çš„æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§åŠå¯è¯»æ€§ï¼›åŒæ—¶æä¾›æœ€æ–°å’Œä¸æ–­å‘å±•çš„Javascriptç‰¹æ€§ï¼Œè®©æˆ‘ä»¬èƒ½å»ºç«‹æ›´åŠ å¼ºå£®çš„ç»„ä»¶ã€‚</p><h2 id="ä»tsconfig-jsoné…ç½®çœ‹tsæ•´ä½“"><a href="#ä»tsconfig-jsoné…ç½®çœ‹tsæ•´ä½“" class="headerlink" title="ä»tsconfig.jsoné…ç½®çœ‹tsæ•´ä½“"></a>ä»tsconfig.jsoné…ç½®çœ‹tsæ•´ä½“</h2><h3 id="åˆ›å»ºtsconfig-jsonæ–‡ä»¶ï¼Œé…ç½®ä¿¡æ¯"><a href="#åˆ›å»ºtsconfig-jsonæ–‡ä»¶ï¼Œé…ç½®ä¿¡æ¯" class="headerlink" title="åˆ›å»ºtsconfig.jsonæ–‡ä»¶ï¼Œé…ç½®ä¿¡æ¯"></a>åˆ›å»ºtsconfig.jsonæ–‡ä»¶ï¼Œé…ç½®ä¿¡æ¯</h3><p>é€šè¿‡compilerOptionæ¥å®šåˆ¶ä½ çš„ç¼–è¯‘é€‰é¡¹</p><pre><code class="json">{  &quot;compilerOptions&quot;: {    /* åŸºæœ¬é€‰é¡¹ */    &quot;target&quot;: &quot;es5&quot;,                       // æŒ‡å®š ECMAScript ç›®æ ‡ç‰ˆæœ¬: &#39;ES3&#39; (default), &#39;ES5&#39;, &#39;ES2015&#39;, &#39;ES2016&#39;, &#39;ES2017&#39;, or &#39;ESNEXT&#39;    &quot;module&quot;: &quot;commonjs&quot;,                  // æŒ‡å®šä½¿ç”¨æ¨¡å—: &#39;commonjs&#39;, &#39;amd&#39;, &#39;system&#39;, &#39;umd&#39; or &#39;es2015&#39;    &quot;lib&quot;: [],                             // æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„åº“æ–‡ä»¶    &quot;allowJs&quot;: true,                       // å…è®¸ç¼–è¯‘ javascript æ–‡ä»¶    &quot;checkJs&quot;: true,                       // æŠ¥å‘Š javascript æ–‡ä»¶ä¸­çš„é”™è¯¯    &quot;jsx&quot;: &quot;preserve&quot;,                     // æŒ‡å®š jsx ä»£ç çš„ç”Ÿæˆ: &#39;preserve&#39;, &#39;react-native&#39;, or &#39;react&#39;    &quot;declaration&quot;: true,                   // ç”Ÿæˆç›¸åº”çš„ &#39;.d.ts&#39; æ–‡ä»¶    &quot;sourceMap&quot;: true,                     // ç”Ÿæˆç›¸åº”çš„ &#39;.map&#39; æ–‡ä»¶    &quot;outFile&quot;: &quot;./&quot;,                       // å°†è¾“å‡ºæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶    &quot;outDir&quot;: &quot;./&quot;,                        // æŒ‡å®šè¾“å‡ºç›®å½•    &quot;rootDir&quot;: &quot;./&quot;,                       // ç”¨æ¥æ§åˆ¶è¾“å‡ºç›®å½•ç»“æ„ --outDir.    &quot;removeComments&quot;: true,                // åˆ é™¤ç¼–è¯‘åçš„æ‰€æœ‰çš„æ³¨é‡Š    &quot;noEmit&quot;: true,                        // ä¸ç”Ÿæˆè¾“å‡ºæ–‡ä»¶    &quot;importHelpers&quot;: true,                 // ä» tslib å¯¼å…¥è¾…åŠ©å·¥å…·å‡½æ•°    &quot;isolatedModules&quot;: true,               // å°†æ¯ä¸ªæ–‡ä»¶åšä¸ºå•ç‹¬çš„æ¨¡å— ï¼ˆä¸ &#39;ts.transpileModule&#39; ç±»ä¼¼ï¼‰.    /* ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥é€‰é¡¹ */    &quot;strict&quot;: true,                        // å¯ç”¨æ‰€æœ‰ä¸¥æ ¼ç±»å‹æ£€æŸ¥é€‰é¡¹    &quot;noImplicitAny&quot;: true,                 // åœ¨è¡¨è¾¾å¼å’Œå£°æ˜ä¸Šæœ‰éšå«çš„ anyç±»å‹æ—¶æŠ¥é”™    &quot;strictNullChecks&quot;: true,              // å¯ç”¨ä¸¥æ ¼çš„ null æ£€æŸ¥    &quot;noImplicitThis&quot;: true,                // å½“ this è¡¨è¾¾å¼å€¼ä¸º any ç±»å‹çš„æ—¶å€™ï¼Œç”Ÿæˆä¸€ä¸ªé”™è¯¯    &quot;alwaysStrict&quot;: true,                  // ä»¥ä¸¥æ ¼æ¨¡å¼æ£€æŸ¥æ¯ä¸ªæ¨¡å—ï¼Œå¹¶åœ¨æ¯ä¸ªæ–‡ä»¶é‡ŒåŠ å…¥ &#39;use strict&#39;    /* é¢å¤–çš„æ£€æŸ¥ */    &quot;noUnusedLocals&quot;: true,                // æœ‰æœªä½¿ç”¨çš„å˜é‡æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯    &quot;noUnusedParameters&quot;: true,            // æœ‰æœªä½¿ç”¨çš„å‚æ•°æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯    &quot;noImplicitReturns&quot;: true,             // å¹¶ä¸æ˜¯æ‰€æœ‰å‡½æ•°é‡Œçš„ä»£ç éƒ½æœ‰è¿”å›å€¼æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯    &quot;noFallthroughCasesInSwitch&quot;: true,    // æŠ¥å‘Š switch è¯­å¥çš„ fallthrough é”™è¯¯ã€‚ï¼ˆå³ï¼Œä¸å…è®¸ switch çš„ case è¯­å¥è´¯ç©¿ï¼‰    /* æ¨¡å—è§£æé€‰é¡¹ */    &quot;moduleResolution&quot;: &quot;node&quot;,            // é€‰æ‹©æ¨¡å—è§£æç­–ç•¥ï¼š &#39;node&#39; (Node.js) or &#39;classic&#39; (TypeScript pre-1.6)    &quot;baseUrl&quot;: &quot;./&quot;,                       // ç”¨äºè§£æéç›¸å¯¹æ¨¡å—åç§°çš„åŸºç›®å½•    &quot;paths&quot;: {},                           // æ¨¡å—ååˆ°åŸºäº baseUrl çš„è·¯å¾„æ˜ å°„çš„åˆ—è¡¨    &quot;rootDirs&quot;: [],                        // æ ¹æ–‡ä»¶å¤¹åˆ—è¡¨ï¼Œå…¶ç»„åˆå†…å®¹è¡¨ç¤ºé¡¹ç›®è¿è¡Œæ—¶çš„ç»“æ„å†…å®¹    &quot;typeRoots&quot;: [],                       // åŒ…å«ç±»å‹å£°æ˜çš„æ–‡ä»¶åˆ—è¡¨    &quot;types&quot;: [],                           // éœ€è¦åŒ…å«çš„ç±»å‹å£°æ˜æ–‡ä»¶ååˆ—è¡¨    &quot;allowSyntheticDefaultImports&quot;: true,  // å…è®¸ä»æ²¡æœ‰è®¾ç½®é»˜è®¤å¯¼å‡ºçš„æ¨¡å—ä¸­é»˜è®¤å¯¼å…¥ã€‚    /* Source Map Options */    &quot;sourceRoot&quot;: &quot;./&quot;,                    // æŒ‡å®šè°ƒè¯•å™¨åº”è¯¥æ‰¾åˆ° TypeScript æ–‡ä»¶è€Œä¸æ˜¯æºæ–‡ä»¶çš„ä½ç½®    &quot;mapRoot&quot;: &quot;./&quot;,                       // æŒ‡å®šè°ƒè¯•å™¨åº”è¯¥æ‰¾åˆ°æ˜ å°„æ–‡ä»¶è€Œä¸æ˜¯ç”Ÿæˆæ–‡ä»¶çš„ä½ç½®    &quot;inlineSourceMap&quot;: true,               // ç”Ÿæˆå•ä¸ª soucemaps æ–‡ä»¶ï¼Œè€Œä¸æ˜¯å°† sourcemaps ç”Ÿæˆä¸åŒçš„æ–‡ä»¶    &quot;inlineSources&quot;: true,                 // å°†ä»£ç ä¸ sourcemaps ç”Ÿæˆåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¦æ±‚åŒæ—¶è®¾ç½®äº† --inlineSourceMap æˆ– --sourceMap å±æ€§    /* å…¶ä»–é€‰é¡¹ */    &quot;experimentalDecorators&quot;: true,        // å¯ç”¨è£…é¥°å™¨    &quot;emitDecoratorMetadata&quot;: true          // ä¸ºè£…é¥°å™¨æä¾›å…ƒæ•°æ®çš„æ”¯æŒ  }}</code></pre><h3 id="Tsç¼–è¯‘ç”ŸæˆJsæ–‡ä»¶"><a href="#Tsç¼–è¯‘ç”ŸæˆJsæ–‡ä»¶" class="headerlink" title="Tsç¼–è¯‘ç”ŸæˆJsæ–‡ä»¶"></a>Tsç¼–è¯‘ç”ŸæˆJsæ–‡ä»¶</h3><p>åœ¨ç›®å½•ä¸‹è¿è¡Œ <code>tsc</code>å‘½ä»¤ï¼Œä¼šåœ¨å½“å‰ç›®å½•æˆ–è€…çˆ¶çº§ç›®å½•ä¸‹æ‰¾<code>tsconfig.json</code>æ–‡ä»¶<br>è¿è¡Œ <code>tsc -p ./path-to-project-directory</code> ã€‚å½“ç„¶ï¼Œè¿™ä¸ªè·¯å¾„å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹äºå½“å‰ç›®å½•çš„ç›¸å¯¹è·¯å¾„ã€‚<br>ä½¿ç”¨ <code>tsc -w</code> æ¥å¯ç”¨ TypeScript ç¼–è¯‘å™¨çš„è§‚æµ‹æ¨¡å¼ï¼Œåœ¨æ£€æµ‹åˆ°æ–‡ä»¶æ”¹åŠ¨ä¹‹åï¼Œå®ƒå°†é‡æ–°ç¼–è¯‘ã€‚</p><h3 id="æ˜¾ç¤ºçš„æŒ‡å®šç¼–è¯‘æ–‡ä»¶"><a href="#æ˜¾ç¤ºçš„æŒ‡å®šç¼–è¯‘æ–‡ä»¶" class="headerlink" title="æ˜¾ç¤ºçš„æŒ‡å®šç¼–è¯‘æ–‡ä»¶"></a>æ˜¾ç¤ºçš„æŒ‡å®šç¼–è¯‘æ–‡ä»¶</h3><pre><code class="js">{  &quot;files&quot;: [    &quot;./some/file.ts&quot;  ]}</code></pre><h2 id="å£°æ˜ç©ºé—´"><a href="#å£°æ˜ç©ºé—´" class="headerlink" title="å£°æ˜ç©ºé—´"></a>å£°æ˜ç©ºé—´</h2><h3 id="ç±»å‹å£°æ˜ç©ºé—´ï¼ˆclass-interface-typeï¼‰"><a href="#ç±»å‹å£°æ˜ç©ºé—´ï¼ˆclass-interface-typeï¼‰" class="headerlink" title="ç±»å‹å£°æ˜ç©ºé—´ï¼ˆclass interface typeï¼‰"></a>ç±»å‹å£°æ˜ç©ºé—´ï¼ˆclass interface typeï¼‰</h3><pre><code class="js">class Foo{}interface Bar{}type Bas{}</code></pre><p><strong>æ³¨æ„ï¼š</strong>å°½ç®¡ä½ å®šä¹‰äº† interface Barï¼Œå´å¹¶ä¸èƒ½å¤ŸæŠŠå®ƒä½œä¸ºä¸€ä¸ªå˜é‡æ¥ä½¿ç”¨ï¼Œå› ä¸ºå®ƒæ²¡æœ‰å®šä¹‰åœ¨å˜é‡å£°æ˜ç©ºé—´ä¸­ã€‚</p><h3 id="å˜é‡å£°æ˜ç©ºé—´"><a href="#å˜é‡å£°æ˜ç©ºé—´" class="headerlink" title="å˜é‡å£°æ˜ç©ºé—´"></a>å˜é‡å£°æ˜ç©ºé—´</h3><pre><code class="js">class Foo {}const someOne = Fooconst someOneVar = 123</code></pre><p><strong>æ³¨æ„</strong> ä¸€äº›ç”¨ var å£°æ˜çš„å˜é‡ï¼Œä¹Ÿåªèƒ½åœ¨å˜é‡å£°æ˜ç©ºé—´ä½¿ç”¨ï¼Œä¸èƒ½ç”¨ä½œç±»å‹æ³¨è§£ã€‚</p><a id="more"></a><h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h2><h3 id="å…¨å±€æ¨¡å—"><a href="#å…¨å±€æ¨¡å—" class="headerlink" title="å…¨å±€æ¨¡å—"></a>å…¨å±€æ¨¡å—</h3><p>ç±»ä¼¼jsçš„ä¸­å…¨å±€å¯¹è±¡ï¼Œæ˜¯ä¸€ç§ä¸å®‰å…¨çš„æ–¹å¼ï¼Œå¯ä½¿ç”¨æ–‡ä»¶æ¨¡å—ä»£æ›¿</p><pre><code class="js">const Foo = 123const Bar = Foo</code></pre><h3 id="æ–‡ä»¶æ¨¡å—"><a href="#æ–‡ä»¶æ¨¡å—" class="headerlink" title="æ–‡ä»¶æ¨¡å—"></a>æ–‡ä»¶æ¨¡å—</h3><p>æ–‡ä»¶æ¨¡å—ä¹Ÿå¯ä»¥å«åšå¤–éƒ¨æ¨¡å—ï¼Œé€šè¿‡import,exportå¯¼å…¥å¯¼å‡ºï¼Œä»è€Œæ‰èƒ½ä½¿ç”¨</p><pre><code class="js">//foo.jsexport const foo = 123//bar.jsimport {foo} from &#39;./foo.js&#39;const bar = foo</code></pre><h4 id="æ–‡ä»¶æ¨¡å—è¯¦æƒ…"><a href="#æ–‡ä»¶æ¨¡å—è¯¦æƒ…" class="headerlink" title="æ–‡ä»¶æ¨¡å—è¯¦æƒ…"></a>æ–‡ä»¶æ¨¡å—è¯¦æƒ…</h4><h5 id="ESæ¨¡å—è¯­æ³•"><a href="#ESæ¨¡å—è¯­æ³•" class="headerlink" title="ESæ¨¡å—è¯­æ³•"></a>ESæ¨¡å—è¯­æ³•</h5><p>å¯¼å‡º</p><pre><code class="js">//ä½¿ç”¨ export å…³é”®å­—å¯¼å‡ºä¸€ä¸ªå˜é‡æˆ–ç±»å‹export const someVar = 123;export type someType = {  foo: string;};// export çš„å†™æ³•é™¤äº†ä¸Šé¢è¿™ç§ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§ï¼šconst someVar = 123;type someType = {  type: string;};export { someVar, someType };// å¯ä»¥ç”¨é‡å‘½åå˜é‡çš„æ–¹å¼å¯¼å‡ºï¼šconst someVar = 123;export { someVar as aDifferentName };</code></pre><p>å¯¼å…¥</p><pre><code class="js">//ä½¿ç”¨ import å…³é”®å­—å¯¼å…¥ä¸€ä¸ªå˜é‡æˆ–è€…æ˜¯ä¸€ä¸ªç±»å‹ï¼šimport { someVar, someType } from &#39;./foo&#39;;//é€šè¿‡é‡å‘½åçš„æ–¹å¼å¯¼å…¥å˜é‡æˆ–è€…ç±»å‹ï¼šimport { someVar as aDifferentName } from &#39;./foo&#39;//å¯ä»¥ä½¿ç”¨æ•´ä½“åŠ è½½ï¼Œå³ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰æŒ‡å®šä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰è¾“å‡ºå€¼éƒ½åŠ è½½åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢ï¼š// ä½ å¯ä»¥ä½¿ç”¨ `foo.someVar` å’Œ `foo.someType` ä»¥åŠå…¶ä»–ä»»ä½•ä» `foo` å¯¼å‡ºçš„å˜é‡æˆ–è€…ç±»å‹import * as foo from &#39;./foo&#39;;//åªå¯¼å…¥æ¨¡å—ï¼šimport &#39;core-js&#39;; // ä¸€ä¸ªæ™®é€šçš„ polyfill åº“//ä»å…¶ä»–æ¨¡å—å¯¼å…¥åæ•´ä½“å¯¼å‡ºï¼šexport * from &#39;./foo&#39;;//ä»å…¶ä»–æ¨¡å—å¯¼å…¥åï¼Œéƒ¨åˆ†å¯¼å‡ºï¼šexport { someVar } from &#39;./foo&#39;;//é€šè¿‡é‡å‘½åï¼Œéƒ¨åˆ†å¯¼å‡ºä»å¦ä¸€ä¸ªæ¨¡å—å¯¼å…¥çš„é¡¹ç›®ï¼šexport { someVar as aDifferentName } from &#39;./foo&#39;;//é»˜è®¤å¯¼å…¥ï¼å¯¼å‡º,ä½¿ç”¨ export default// some varexport default (someVar = 123);//å¯¼å…¥ä½¿ç”¨ import someName from &#39;someModule&#39; è¯­æ³•ï¼ˆä½ å¯ä»¥æ ¹æ®éœ€è¦ä¸ºå¯¼å…¥å‘½åï¼‰ï¼šimport someLocalNameForThisFile from &#39;./foo&#39;;</code></pre><h5 id="æ¨¡å—è·¯å¾„"><a href="#æ¨¡å—è·¯å¾„" class="headerlink" title="æ¨¡å—è·¯å¾„"></a>æ¨¡å—è·¯å¾„</h5><p>è¿™é‡Œå­˜åœ¨ä¸¤ç§æˆªç„¶ä¸åŒçš„æ¨¡å—ï¼š</p><blockquote><p>ç›¸å¯¹æ¨¡å—è·¯å¾„ï¼ˆè·¯å¾„ä»¥ . å¼€å¤´ï¼Œä¾‹å¦‚ï¼š./someFile æˆ–è€… ../../someFolder/someFile ç­‰ï¼‰ï¼›<br>å…¶ä»–åŠ¨æ€æŸ¥æ‰¾æ¨¡å—ï¼ˆå¦‚ï¼šcore-jsï¼Œtypestyleï¼Œreact æˆ–è€…ç”šè‡³æ˜¯ react/core ç­‰ï¼‰ã€‚</p></blockquote><h5 id="ä»€ä¹ˆæ˜¯-place"><a href="#ä»€ä¹ˆæ˜¯-place" class="headerlink" title="ä»€ä¹ˆæ˜¯ place"></a>ä»€ä¹ˆæ˜¯ place</h5><p>è¿™ä¸ªç‚¹æŒ‡çš„åº”è¯¥æ˜¯ä¸€ä¸ªæ¨¡å—æŸ¥æ‰¾çš„è¿‡ç¨‹</p><h5 id="é‡å†™ç±»å‹çš„åŠ¨æ€æŸ¥æ‰¾"><a href="#é‡å†™ç±»å‹çš„åŠ¨æ€æŸ¥æ‰¾" class="headerlink" title="é‡å†™ç±»å‹çš„åŠ¨æ€æŸ¥æ‰¾"></a>é‡å†™ç±»å‹çš„åŠ¨æ€æŸ¥æ‰¾</h5><p>åœ¨é¡¹ç›®é‡Œï¼Œå¯ä»¥é€šè¿‡<code>declare module &#39;somePath&#39;</code> å£°æ˜ä¸€ä¸ªå…¨å±€æ¨¡å—çš„æ–¹å¼ï¼Œæ¥è§£å†³æŸ¥æ‰¾æ¨¡å—è·¯å¾„çš„é—®é¢˜ã€‚</p><h5 id="import-require-ä»…ä»…æ˜¯å¯¼å…¥ç±»å‹"><a href="#import-require-ä»…ä»…æ˜¯å¯¼å…¥ç±»å‹" class="headerlink" title="import/require ä»…ä»…æ˜¯å¯¼å…¥ç±»å‹"></a>import/require ä»…ä»…æ˜¯å¯¼å…¥ç±»å‹</h5><p>å®ƒå®é™…ä¸Šåªåšäº†ä¸¤ä»¶äº‹ï¼š</p><ul><li>å¯¼å…¥ foo æ¨¡å—çš„æ‰€æœ‰ç±»å‹ä¿¡æ¯ï¼›</li><li>ç¡®å®š foo æ¨¡å—è¿è¡Œæ—¶çš„ä¾èµ–å…³ç³»ã€‚</li></ul><h2 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h2><p>åœ¨ JavaScript å¯ä»¥ä½¿ç”¨åŒ¿åå‡½æ•°åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´</p><pre><code class="js">(function(something) {  something.foo = 123;})(something || (something = {}));</code></pre><p>TypeScript æä¾›äº† namespace å…³é”®å­—æ¥æè¿°è¿™ç§åˆ†ç»„</p><pre><code class="js">namespace Utility {  export function log(msg) {    console.log(msg);  }  export function error(msg) {    console.log(msg);  }}// usageUtility.log(&#39;Call me&#39;);Utility.error(&#39;maybe&#39;);</code></pre><h2 id="åŠ¨æ€å¯¼å…¥è¡¨è¾¾å¼"><a href="#åŠ¨æ€å¯¼å…¥è¡¨è¾¾å¼" class="headerlink" title="åŠ¨æ€å¯¼å…¥è¡¨è¾¾å¼"></a>åŠ¨æ€å¯¼å…¥è¡¨è¾¾å¼</h2><p>åŠ¨æ€å¯¼å…¥è¡¨è¾¾å¼æ˜¯ ECMAScript çš„ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ åœ¨ç¨‹åºçš„ä»»æ„ä½ç½®å¼‚æ­¥åŠ è½½ä¸€ä¸ªæ¨¡å—  </p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½ ä¸çŸ¥é“çš„ç®­å¤´å‡½æ•°</title>
      <link href="/2020/03/15/Js/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0/"/>
      <url>/2020/03/15/Js/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€è¨€"><a href="#ç®€è¨€" class="headerlink" title="ç®€è¨€"></a>ç®€è¨€</h1><p>ES6çš„ç®­å¤´å‡½æ•°ï¼Œæˆ‘ä»¬ä¼šåœ¨å·¥ä½œä¸­ç»å¸¸çŸ¥é“ï¼Œä½†æ˜¯ä½ çŸ¥é“ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œä»€ä¹ˆæ—¶å€™ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°å—ï¼Ÿ</p><h2 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ</h2><blockquote><p>ä¸ºå•¥å¤§å¤šæ•°æƒ…å†µéƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ</p></blockquote><p>ä½œç”¨åŸŸå®‰å…¨æ€§:å½“ç®­å¤´å‡½æ•°è¢«ä¸€è‡´ä½¿ç”¨æ—¶ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½ä¿è¯ä½¿ç”¨ä¸æ ¹å¯¹è±¡ç›¸åŒçš„thisã€‚å¦‚æœä¸€ä¸ªæ ‡å‡†å‡½æ•°å›è°ƒä¸ä¸€å †ç®­å¤´å‡½æ•°æ··åˆåœ¨ä¸€èµ·ï¼Œé‚£ä¹ˆä½œç”¨åŸŸå°±æœ‰å¯èƒ½å˜å¾—æ··ä¹±ã€‚</p><p>ç´§å‡‘æ€§:ç®­å¤´å‡½æ•°æ›´å®¹æ˜“è¯»å†™ã€‚</p><p>æ¸…æ™°åº¦:ä½¿ç”¨ç®­å¤´å‡½æ•°å¯æ˜ç¡®çŸ¥é“å½“å‰ this æŒ‡å‘</p><p>å…¶å®ƒæƒ…å†µä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚</p><h2 id="ä»€ä¹ˆæ—¶å€™ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ</h2><h3 id="å®šä¹‰å¯¹è±¡æ–¹æ³•"><a href="#å®šä¹‰å¯¹è±¡æ–¹æ³•" class="headerlink" title="å®šä¹‰å¯¹è±¡æ–¹æ³•"></a>å®šä¹‰å¯¹è±¡æ–¹æ³•</h3><h4 id="å®šä¹‰å­—é¢é‡çš„æ–¹æ³•"><a href="#å®šä¹‰å­—é¢é‡çš„æ–¹æ³•" class="headerlink" title="å®šä¹‰å­—é¢é‡çš„æ–¹æ³•"></a>å®šä¹‰å­—é¢é‡çš„æ–¹æ³•</h4><pre><code class="js">const calculator = {    array: [1, 2, 3],    sum: () =&gt; {        console.log(this === window); // =&gt; true        return this.array.reduce((result, item) =&gt; result + item);    }};console.log(this === window); // =&gt; true// Throws &quot;TypeError: Cannot read property &#39;reduce&#39; of undefined&quot;calculator.sum();</code></pre><p>calculator.sum ä½¿ç”¨ç®­å¤´å‡½æ•°æ¥å®šä¹‰ï¼Œä½†æ˜¯è°ƒç”¨çš„æ—¶å€™ä¼šæŠ›å‡º TypeErrorï¼Œå› ä¸ºè¿è¡Œæ—¶ this.array æ˜¯æœªå®šä¹‰çš„ï¼Œè°ƒç”¨ calculator.sum çš„æ—¶å€™ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡é‡Œé¢çš„ this ä»ç„¶æŒ‡å‘çš„æ˜¯ windowï¼ŒåŸå› æ˜¯ç®­å¤´å‡½æ•°æŠŠå‡½æ•°ä¸Šä¸‹æ–‡ç»‘å®šåˆ°äº† window ä¸Šï¼Œthis.array ç­‰ä»·äº window.arrayï¼Œæ˜¾ç„¶åè€…æ˜¯æœªå®šä¹‰çš„ã€‚</p><p><strong>è§£å†³çš„åŠæ³•</strong>æ˜¯ï¼Œä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼æˆ–è€…æ–¹æ³•ç®€å†™ï¼ˆES6 ä¸­å·²ç»æ”¯æŒï¼‰æ¥å®šä¹‰æ–¹æ³•ï¼Œè¿™æ ·èƒ½ç¡®ä¿ this æ˜¯åœ¨è¿è¡Œæ—¶æ˜¯ç”±åŒ…å«å®ƒçš„ä¸Šä¸‹æ–‡å†³å®šçš„ï¼Œ</p><pre><code class="js">const calculator = {    array: [1, 2, 3],    sum() {        console.log(this === calculator); // =&gt; true        return this.array.reduce((result, item) =&gt; result + item);    }};calculator.sum(); // =&gt; 6</code></pre><h4 id="å®šä¹‰åŸå‹æ–¹æ³•"><a href="#å®šä¹‰åŸå‹æ–¹æ³•" class="headerlink" title="å®šä¹‰åŸå‹æ–¹æ³•"></a>å®šä¹‰åŸå‹æ–¹æ³•</h4><p>åŒæ ·çš„è§„åˆ™é€‚ç”¨äºåŸå‹æ–¹æ³•ï¼ˆprototype methodï¼‰çš„å®šä¹‰ï¼Œä½¿ç”¨ç®­å¤´å‡½æ•°ä¼šå¯¼è‡´è¿è¡Œæ—¶çš„æ‰§è¡Œä¸Šä¸‹æ–‡é”™è¯¯</p><pre><code class="js">function Cat(name) {    this.name = name;}Cat.prototype.sayCatName = () =&gt; {    console.log(this === window); // =&gt; true    return this.name;};const cat = new Cat(&#39;Mew&#39;);cat.sayCatName(); // =&gt; undefined</code></pre><p><strong>è§£å†³æ–¹æ³•</strong>:ä½¿ç”¨ä¼ ç»Ÿçš„å‡½æ•°è¡¨è¾¾å¼å°±èƒ½è§£å†³é—®é¢˜</p><h3 id="å®šä¹‰äº‹ä»¶å›è°ƒå‡½æ•°"><a href="#å®šä¹‰äº‹ä»¶å›è°ƒå‡½æ•°" class="headerlink" title="å®šä¹‰äº‹ä»¶å›è°ƒå‡½æ•°"></a>å®šä¹‰äº‹ä»¶å›è°ƒå‡½æ•°</h3><pre><code class="js">const button = document.getElementById(&#39;myButton&#39;);button.addEventListener(&#39;click&#39;, () =&gt; {    console.log(this === window); // =&gt; true    this.innerHTML = &#39;Clicked button&#39;;});</code></pre><p>åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸‹å®šä¹‰çš„ç®­å¤´å‡½æ•°æ‰§è¡Œæ—¶ this ä¼šæŒ‡å‘ windowï¼Œå½“å•å‡»äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæµè§ˆå™¨ä¼šå°è¯•ç”¨ button ä½œä¸ºä¸Šä¸‹æ–‡æ¥æ‰§è¡Œäº‹ä»¶å›è°ƒå‡½æ•°ï¼Œä½†æ˜¯ç®­å¤´å‡½æ•°é¢„å®šä¹‰çš„ä¸Šä¸‹æ–‡æ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„ï¼Œè¿™æ · this.innerHTML å°±ç­‰ä»·äº window.innerHTMLï¼Œè€Œåè€…æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ã€‚</p><p><strong>è§£å†³æ–¹æ³•</strong>:ä½¿ç”¨ä¼ ç»Ÿçš„å‡½æ•°è¡¨è¾¾å¼å°±èƒ½è§£å†³é—®é¢˜</p><h3 id="å®šä¹‰æ„é€ å‡½æ•°"><a href="#å®šä¹‰æ„é€ å‡½æ•°" class="headerlink" title="å®šä¹‰æ„é€ å‡½æ•°"></a>å®šä¹‰æ„é€ å‡½æ•°</h3><p>æ„é€ å‡½æ•°ä¸­çš„ this æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå½“æ‰§è¡Œ new Car() çš„æ—¶å€™ï¼Œæ„é€ å‡½æ•° Car çš„ä¸Šä¸‹æ–‡å°±æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ this instanceof Car === trueã€‚æ˜¾ç„¶ï¼Œç®­å¤´å‡½æ•°æ˜¯ä¸èƒ½ç”¨æ¥åšæ„é€ å‡½æ•°ï¼Œ å®é™…ä¸Š JS ä¼šç¦æ­¢ä½ è¿™ä¹ˆåšï¼Œå¦‚æœä½ è¿™ä¹ˆåšäº†ï¼Œå®ƒå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><pre><code class="js">const Message = (text) =&gt; {    this.text = text;};// Throws &quot;TypeError: Message is not a constructor&quot;const helloMessage = new Message(&#39;Hello World!&#39;);</code></pre><h3 id="è¿½æ±‚è¿‡çŸ­çš„ä»£ç "><a href="#è¿½æ±‚è¿‡çŸ­çš„ä»£ç " class="headerlink" title="è¿½æ±‚è¿‡çŸ­çš„ä»£ç "></a>è¿½æ±‚è¿‡çŸ­çš„ä»£ç </h3><p>åœ¨ä»£ç å¯è¯»æ€§æ–¹é¢ï¼Œæœ€çŸ­çš„ä»£ç å¯èƒ½å¹¶ä¸æ€»æ˜¯æœ€å¥½çš„ã€‚ä¸€å®šç¨‹åº¦ä¸Šï¼Œå‹ç¼©äº†å¤ªå¤šé€»è¾‘çš„ç®€çŸ­ä»£ç ï¼Œé˜…è¯»èµ·æ¥å°±æ²¡æœ‰é‚£ä¹ˆç›´è§‚ï¼Œ</p><pre><code class="js">const multiply = (a, b) =&gt; b === undefined ? b =&gt; a * b : a * b;const double = multiply(2);double(3);      // =&gt; 6multiply(2, 3); // =&gt; 6</code></pre><p>multiply å‡½æ•°ä¼šè¿”å›ä¸¤ä¸ªæ•°å­—çš„ä¹˜ç§¯æˆ–è€…è¿”å›ä¸€ä¸ªå¯ä»¥ç»§ç»­è°ƒç”¨çš„å›ºå®šäº†ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ã€‚ä»£ç çœ‹èµ·æ¥å¾ˆç®€çŸ­ï¼Œä½†å¤§å¤šæ•°äººç¬¬ä¸€çœ¼çœ‹ä¸Šå»å¯èƒ½æ— æ³•ç«‹å³ææ¸…æ¥šå®ƒå¹²äº†ä»€ä¹ˆï¼Œæ€ä¹ˆè®©è¿™æ®µä»£ç å¯è¯»æ€§æ›´é«˜å‘¢ï¼Ÿæœ‰å¾ˆå¤šåŠæ³•ï¼Œå¯ä»¥åœ¨ç®­å¤´å‡½æ•°ä¸­åŠ ä¸Šæ‹¬å·ã€æ¡ä»¶åˆ¤æ–­ã€è¿”å›è¯­å¥ï¼Œæˆ–è€…</p><pre><code class="js">function multiply(a, b) {    if (b === undefined) {        return function (b) {            return a * b;        }    }    return a * b;}const double = multiply(2);double(3); // =&gt; 6multiply(2, 3); // =&gt; 6</code></pre>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½ ä¸çŸ¥é“çš„ JSON.stringify() çš„å¨åŠ›</title>
      <link href="/2019/12/12/Js/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84-JSON-stringify-%E7%9A%84%E5%A8%81%E5%8A%9B/"/>
      <url>/2019/12/12/Js/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84-JSON-stringify-%E7%9A%84%E5%A8%81%E5%8A%9B/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5decf09de51d45584d238319#heading-4" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h2 id="é€šè¿‡éœ€æ±‚å­¦ä¹ JSON-stringify"><a href="#é€šè¿‡éœ€æ±‚å­¦ä¹ JSON-stringify" class="headerlink" title="é€šè¿‡éœ€æ±‚å­¦ä¹ JSON.stringify()"></a>é€šè¿‡éœ€æ±‚å­¦ä¹ JSON.stringify()</h2><p>é¦–å…ˆæˆ‘ä»¬åœ¨å¼€å‘çš„è¿‡ç¨‹å½“ä¸­é‡åˆ°è¿™æ ·ä¸€ä¸ªå¤„ç†æ•°æ®çš„éœ€æ±‚</p><pre><code class="js">const todayILearn = {  _id: 1,  content: &#39;ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼&#39;,  created_at: &#39;Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39;,  updated_at: &#39;Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39;}</code></pre><p>æˆ‘ä»¬éœ€è¦å°†ä¸Šé¢è¿™ä¸ªå¯¹è±¡å¤„ç†æˆä¸‹é¢è¿™ä¸ªå¯¹è±¡</p><pre><code class="js">const todayILearn = {  id: 1,  content: &#39;ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼&#39;,  createdAt: &#39;Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39;,  updatedAt: &#39;Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39;}</code></pre><p>ä¹Ÿå°±æ˜¯åœ¨ä¸æ”¹å˜å±æ€§çš„å€¼çš„å‰æä¸‹ï¼Œå°†å¯¹è±¡å±æ€§ä¿®æ”¹ä¸€ä¸‹ã€‚ æŠŠ_id  æ”¹æˆ idï¼ŒæŠŠ updated_at æ”¹æˆ updatedAtï¼ŒæŠŠ created_at æ”¹æˆ createdAtã€‚æˆ‘ä»¬ç°åœ¨é€šè¿‡è¿™ä¸ªå°å°çš„éœ€æ±‚æ¥è§è¯†ä¸€ä¸‹ JSON.stringify() çš„å¼ºå¤§å§ã€‚</p><p>é¦–å…ˆè¦è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘ä»¬æœ‰å¾ˆå¤šç§è§£å†³æ–¹å¼ï¼Œæˆ‘ä»¬å…ˆæä¾›ä¸¤ç§ä¸ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼š</p><p><strong>æ–¹æ¡ˆä¸€ï¼šä¸€æ¬¡éå†+å¤šå£°æ˜ä¸€ä¸ªå˜é‡</strong></p><pre><code class="js">// å¤šä¸€ä¸ªå˜é‡å­˜å‚¨const todayILearnTemp = {};for (const [key, value] of Object.entries(todayILearn)) {  if (key === &quot;_id&quot;) todayILearnTemp[&quot;id&quot;] = value;  else if (key === &quot;created_at&quot;) todayILearnTemp[&quot;createdAt&quot;] = value;  else if (key === &quot;updatedAt&quot;) todayILearnTemp[&quot;updatedAt&quot;] = value;  else todayILearnTemp[key] = value;}console.log(todayILearnTemp);// ç»“æœï¼š// { id: 1,//  content: &#39;ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼&#39;,//  createdAt: &#39;Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39;,//  updated_at: &#39;Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39; // }</code></pre><p>æ–¹æ¡ˆä¸€å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥å®ç°ã€‚ä½†æ˜¯å¤šå£°æ˜äº†ä¸€ä¸ªå˜é‡åˆåŠ ä¸Šä¸€å±‚å¾ªç¯å¹¶ä¸”è¿˜æœ‰å¾ˆå¤šçš„ if else è¯­å¥ï¼Œæ€ä¹ˆéƒ½æ˜¾å¾—ä¸å¤ªä¼˜é›…ã€‚</p><p><strong>æ–¹æ¡ˆäºŒï¼šæš´åŠ› delete å±æ€§å’Œå¢åŠ å±æ€§</strong></p><pre><code class="js">// æè‡´çš„æš´åŠ›ç¾å­¦todayILearn.id = todayILearn._id;todayILearn.createdAt = todayILearn.created_at;todayILearn.updatedAt = todayILearn.updated_at;delete todayILearn._id;delete todayILearn.created_at;delete todayILearn.updated_at;console.log(todayILearn);//     å¤ªæš´åŠ›ğŸ˜¢//{ //  content: &#39;ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼&#39;,//  id: 1,//  createdAt: &#39;Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39;,//  updatedAt: &#39;Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39; //}</code></pre><p>ç›´æ¥ delete æš´åŠ›è§£å†³å¤ªç²—é²äº†ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå±æ€§çš„é¡ºåºå˜äº†ã€‚</p><p><strong>æ–¹æ¡ˆä¸‰ï¼šåºåˆ—åŒ–+ replace ç¾å­¦å…¸èŒƒ</strong></p><pre><code class="js">const mapObj = {  _id: &quot;id&quot;,  created_at: &quot;createdAt&quot;,  updated_at: &quot;updatedAt&quot;};JSON.parse(  JSON.stringify(todayILearn).replace(    /_id|created_at|updated_at/gi,    matched =&gt; mapObj[matched])    )// { // id: 1,//  content: &#39;ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼&#39;,//  createdAt: &#39;Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39;,//  updatedAt: &#39;Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)&#39; // }</code></pre><p><img src="https://user-gold-cdn.xitu.io/2019/12/8/16ee5ace18ca5dbb?imageslim" alt="Json.Stringify"></p><a id="more"></a><h2 id="JSON-stringify-ä¹å¤§ç‰¹æ€§"><a href="#JSON-stringify-ä¹å¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify() ä¹å¤§ç‰¹æ€§"></a>JSON.stringify() ä¹å¤§ç‰¹æ€§</h2><h3 id="JSON-stringify-ç¬¬ä¸€å¤§ç‰¹æ€§"><a href="#JSON-stringify-ç¬¬ä¸€å¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify()ç¬¬ä¸€å¤§ç‰¹æ€§"></a>JSON.stringify()ç¬¬ä¸€å¤§ç‰¹æ€§</h3><p><strong>å¯¹äº undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä¸‰ä¸ªç‰¹æ®Šçš„å€¼åˆ†åˆ«ä½œä¸ºå¯¹è±¡å±æ€§çš„å€¼ã€æ•°ç»„å…ƒç´ ã€å•ç‹¬çš„å€¼æ—¶ JSON.stringify()å°†è¿”å›ä¸åŒçš„ç»“æœ</strong>ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹çŸ¥è¯†ç‚¹ï¼Œçœ‹ä¸€é“éå¸¸ç®€å•çš„é¢è¯•é¢˜ç›®ï¼šè¯·é—®ä¸‹é¢ä»£ç ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ</p><pre><code class="js">const data = {  a: &quot;aaa&quot;,  b: undefined,  c: Symbol(&quot;dd&quot;),  fn: function() {    return true;  }};JSON.stringify(data); // è¾“å‡ºï¼šï¼Ÿ// &quot;{&quot;a&quot;:&quot;aaa&quot;}&quot;</code></pre><p>å¾ˆç®€å•è¿™é“é¢˜ç›®é¢è¯•å®˜ä¸»è¦è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹æ˜¯ï¼š</p><ul><li>undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä½œä¸ºå¯¹è±¡å±æ€§å€¼æ—¶ JSON.stringify() å°†è·³è¿‡ï¼ˆå¿½ç•¥ï¼‰å¯¹å®ƒä»¬è¿›è¡Œåºåˆ—åŒ–</li></ul><p>é¢è¯•å®˜è¿½é—®ï¼šå‡è®¾ undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol å€¼ä½œä¸ºæ•°ç»„å…ƒç´ ä¼šæ˜¯æ€æ ·å‘¢ï¼Ÿ</p><pre><code class="js">JSON.stringify([&quot;aaa&quot;, undefined, function aa() {    return true  }, Symbol(&#39;dd&#39;)])  // è¾“å‡ºï¼šï¼Ÿ// &quot;[&quot;aaa&quot;,null,null,null]&quot;</code></pre><p>çŸ¥è¯†ç‚¹æ˜¯ï¼š</p><ul><li>undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä½œä¸ºæ•°ç»„å…ƒç´ å€¼æ—¶ï¼ŒJSON.stringify() ä¼šå°†å®ƒä»¬åºåˆ—åŒ–ä¸º null</li></ul><p>æˆ‘ä»¬ç¨å¾®å†åŠ¨ä¸‹è„‘ç­‹ï¼Œå¦‚æœå•ç‹¬åºåˆ—åŒ–è¿™äº›å€¼ä¼šæ˜¯ä»€ä¹ˆæ ·çš„ç»“æœå‘¢ï¼Ÿ</p><pre><code class="js">JSON.stringify(function a (){console.log(&#39;a&#39;)})// undefinedJSON.stringify(undefined)// undefinedJSON.stringify(Symbol(&#39;dd&#39;))// undefined</code></pre><p>å•ç‹¬è½¬æ¢çš„ç»“æœå°±æ˜¯ï¼š</p><p>undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol è¢« JSON.stringify() ä½œä¸ºå•ç‹¬çš„å€¼è¿›è¡Œåºåˆ—åŒ–æ—¶éƒ½ä¼šè¿”å› undefined</p><blockquote><p>JSON.stringify() ç¬¬ä¸€å¤§ç‰¹æ€§æ€»ç»“<br>undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä½œä¸ºå¯¹è±¡å±æ€§å€¼æ—¶ JSON.stringify() å¯¹è·³è¿‡ï¼ˆå¿½ç•¥ï¼‰å®ƒä»¬è¿›è¡Œåºåˆ—åŒ–<br>undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä½œä¸ºæ•°ç»„å…ƒç´ å€¼æ—¶ï¼ŒJSON.stringify() å°†ä¼šå°†å®ƒä»¬åºåˆ—åŒ–ä¸º null<br>undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol è¢« JSON.stringify() ä½œä¸ºå•ç‹¬çš„å€¼è¿›è¡Œåºåˆ—åŒ–æ—¶ï¼Œéƒ½ä¼šè¿”å› undefined</p></blockquote><h3 id="JSON-stringify-ç¬¬äºŒå¤§ç‰¹æ€§"><a href="#JSON-stringify-ç¬¬äºŒå¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify() ç¬¬äºŒå¤§ç‰¹æ€§"></a>JSON.stringify() ç¬¬äºŒå¤§ç‰¹æ€§</h3><p><strong>éæ•°ç»„å¯¹è±¡çš„å±æ€§ä¸èƒ½ä¿è¯ä»¥ç‰¹å®šçš„é¡ºåºå‡ºç°åœ¨åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­ã€‚</strong></p><pre><code class="js">const data = {  a: &quot;aaa&quot;,  b: undefined,  c: Symbol(&quot;dd&quot;),  fn: function() {    return true;  },  d: &quot;ddd&quot;};JSON.stringify(data); // è¾“å‡ºï¼šï¼Ÿ// &quot;{&quot;a&quot;:&quot;aaa&quot;,&quot;d&quot;:&quot;ddd&quot;}&quot;JSON.stringify([&quot;aaa&quot;, undefined, function aa() {    return true  }, Symbol(&#39;dd&#39;),&quot;eee&quot;])  // è¾“å‡ºï¼šï¼Ÿ// &quot;[&quot;aaa&quot;,null,null,null,&quot;eee&quot;]&quot;</code></pre><p>æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬ä¸€ç‰¹æ€§æ‰€è¯´ï¼ŒJSON.stringify() åºåˆ—åŒ–æ—¶<strong>ä¼šå¿½ç•¥ä¸€äº›ç‰¹æ®Šçš„å€¼</strong>ï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²è¿˜æ˜¯ä»¥ç‰¹å®šçš„é¡ºåºå‡ºç°ï¼ˆæ•°ç»„é™¤å¤–ï¼‰ã€‚</p><h3 id="JSON-stringify-ç¬¬ä¸‰å¤§ç‰¹æ€§"><a href="#JSON-stringify-ç¬¬ä¸‰å¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify() ç¬¬ä¸‰å¤§ç‰¹æ€§"></a>JSON.stringify() ç¬¬ä¸‰å¤§ç‰¹æ€§</h3><ul><li>è½¬æ¢å€¼å¦‚æœ<strong>æœ‰ toJSON() å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›ä»€ä¹ˆå€¼ï¼Œåºåˆ—åŒ–ç»“æœå°±æ˜¯ä»€ä¹ˆå€¼ï¼Œå¹¶ä¸”å¿½ç•¥å…¶ä»–å±æ€§çš„å€¼</strong>ã€‚</li></ul><pre><code class="js">JSON.stringify({    say: &quot;hello JSON.stringify&quot;,    toJSON: function() {      return &quot;today i learn&quot;;    }  })// &quot;today i learn&quot;</code></pre><h3 id="JSON-stringify-ç¬¬å››å¤§ç‰¹æ€§"><a href="#JSON-stringify-ç¬¬å››å¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify()ç¬¬å››å¤§ç‰¹æ€§"></a>JSON.stringify()ç¬¬å››å¤§ç‰¹æ€§</h3><p>JSON.stringify() å°†ä¼š<strong>æ­£å¸¸åºåˆ—åŒ– Date</strong> çš„å€¼ã€‚</p><pre><code class="js">JSON.stringify({ now: new Date() });// &quot;{&quot;now&quot;:&quot;2019-12-08T07:42:11.973Z&quot;}&quot;</code></pre><p>å®é™…ä¸Š Date å¯¹è±¡è‡ªå·±éƒ¨ç½²äº† toJSON() æ–¹æ³•ï¼ˆåŒDate.toISOString()ï¼‰ï¼Œå› æ­¤ Date å¯¹è±¡ä¼šè¢«å½“åšå­—ç¬¦ä¸²å¤„ç†ã€‚</p><h3 id="JSON-stringify-ç¬¬äº”å¤§ç‰¹æ€§"><a href="#JSON-stringify-ç¬¬äº”å¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify() ç¬¬äº”å¤§ç‰¹æ€§"></a>JSON.stringify() ç¬¬äº”å¤§ç‰¹æ€§</h3><p><strong>NaN å’Œ Infinity æ ¼å¼çš„æ•°å€¼åŠ null éƒ½ä¼šè¢«å½“åš nullã€‚</strong></p><pre><code class="js">JSON.stringify(NaN)// &quot;null&quot;JSON.stringify(null)// &quot;null&quot;JSON.stringify(Infinity)// &quot;null&quot;</code></pre><h3 id="JSON-stringify-ç¬¬å…­å¤§ç‰¹æ€§"><a href="#JSON-stringify-ç¬¬å…­å¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify() ç¬¬å…­å¤§ç‰¹æ€§"></a>JSON.stringify() ç¬¬å…­å¤§ç‰¹æ€§</h3><p><strong>å¸ƒå°”å€¼ã€æ•°å­—ã€å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„åŸå§‹å€¼ã€‚</strong></p><pre><code class="js">JSON.stringify([new Number(1), new String(&quot;false&quot;), new Boolean(false)]);// &quot;[1,&quot;false&quot;,false]&quot;</code></pre><h3 id="JSON-stringify-ç¬¬ä¸ƒå¤§ç‰¹æ€§"><a href="#JSON-stringify-ç¬¬ä¸ƒå¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify() ç¬¬ä¸ƒå¤§ç‰¹æ€§"></a>JSON.stringify() ç¬¬ä¸ƒå¤§ç‰¹æ€§</h3><p>å…³äºå¯¹è±¡å±æ€§çš„æ˜¯å¦å¯æšä¸¾ï¼š</p><p><strong>å…¶ä»–ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ Map/Set/WeakMap/WeakSetï¼Œä»…ä¼šåºåˆ—åŒ–å¯æšä¸¾çš„å±æ€§ã€‚</strong></p><pre><code class="js">// ä¸å¯æšä¸¾çš„å±æ€§é»˜è®¤ä¼šè¢«å¿½ç•¥ï¼šJSON.stringify(     Object.create(        null,         {             x: { value: &#39;json&#39;, enumerable: false },             y: { value: &#39;stringify&#39;, enumerable: true }         }    ));// &quot;{&quot;y&quot;:&quot;stringify&quot;}&quot;</code></pre><h3 id="JSON-stringify-ç¬¬å…«å¤§ç‰¹æ€§"><a href="#JSON-stringify-ç¬¬å…«å¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify() ç¬¬å…«å¤§ç‰¹æ€§"></a>JSON.stringify() ç¬¬å…«å¤§ç‰¹æ€§</h3><p>æˆ‘ä»¬éƒ½çŸ¥é“å®ç°æ·±æ‹·è´æœ€ç®€å•ç²—æš´çš„æ–¹å¼å°±æ˜¯åºåˆ—åŒ–ï¼š<code>JSON.parse(JSON.stringify())</code>ï¼Œè¿™ä¸ªæ–¹å¼å®ç°æ·±æ‹·è´ä¼šå› ä¸ºåºåˆ—åŒ–çš„è¯¸å¤šç‰¹æ€§ä»è€Œå¯¼è‡´è¯¸å¤šçš„å‘ç‚¹ï¼šæ¯”å¦‚ç°åœ¨æˆ‘ä»¬è¦è¯´çš„å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</p><pre><code class="js">// å¯¹åŒ…å«å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼ˆå¯¹è±¡ä¹‹é—´ç›¸äº’å¼•ç”¨ï¼Œå½¢æˆæ— é™å¾ªç¯ï¼‰æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚ const obj = {  name: &quot;loopObj&quot;};const loopObj = {  obj};// å¯¹è±¡ä¹‹é—´å½¢æˆå¾ªç¯å¼•ç”¨ï¼Œå½¢æˆé—­ç¯obj.loopObj = loopObj;// å°è£…ä¸€ä¸ªæ·±æ‹·è´çš„å‡½æ•°function deepClone(obj) {  return JSON.parse(JSON.stringify(obj));}// æ‰§è¡Œæ·±æ‹·è´ï¼ŒæŠ›å‡ºé”™è¯¯deepClone(obj)/** VM44:9 Uncaught TypeError: Converting circular structure to JSON    --&gt; starting at object with constructor &#39;Object&#39;    |     property &#39;loopObj&#39; -&gt; object with constructor &#39;Object&#39;    --- property &#39;obj&#39; closes the circle    at JSON.stringify (&lt;anonymous&gt;)    at deepClone (&lt;anonymous&gt;:9:26)    at &lt;anonymous&gt;:11:13 */</code></pre><ul><li>å¯¹åŒ…å«å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼ˆå¯¹è±¡ä¹‹é—´ç›¸äº’å¼•ç”¨ï¼Œå½¢æˆæ— é™å¾ªç¯ï¼‰æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚</li></ul><p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆç”¨åºåˆ—åŒ–å»å®ç°æ·±æ‹·è´æ—¶ï¼Œé‡åˆ°å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ä¼šæŠ›å‡ºé”™è¯¯çš„åŸå› </p><h3 id="JSON-stringify-ç¬¬ä¹å¤§ç‰¹æ€§"><a href="#JSON-stringify-ç¬¬ä¹å¤§ç‰¹æ€§" class="headerlink" title="JSON.stringify() ç¬¬ä¹å¤§ç‰¹æ€§"></a>JSON.stringify() ç¬¬ä¹å¤§ç‰¹æ€§</h3><p><strong>æ‰€æœ‰ä»¥ symbol ä¸ºå±æ€§é”®çš„å±æ€§éƒ½ä¼šè¢«å®Œå…¨å¿½ç•¥æ‰ï¼Œå³ä¾¿ replacer å‚æ•°ä¸­å¼ºåˆ¶æŒ‡å®šåŒ…å«äº†å®ƒä»¬ã€‚</strong></p><pre><code class="js">JSON.stringify({ [Symbol.for(&quot;json&quot;)]: &quot;stringify&quot; }, function(k, v) {    if (typeof k === &quot;symbol&quot;) {      return v;    }  })// undefined</code></pre><p><code>replacer</code> æ˜¯ <code>JSON.stringify()</code> çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ¯”è¾ƒå°‘ç”¨åˆ°ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šå¿˜è®° <code>JSON.stringify()</code> ç¬¬äºŒä¸ªã€ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œåœºæ™¯ä¸å¤šï¼Œä½†æ˜¯ç”¨çš„å¥½çš„è¯ä¼šéå¸¸æ–¹ä¾¿ï¼Œå…³äº <code>JSON.stringify()</code> ç¬¬ä¹å¤§ç‰¹æ€§çš„ä¾‹å­ä¸­å¯¹ replacer å‚æ•°ä¸æ˜ç™½çš„åŒå­¦å…ˆåˆ«æ€¥ï¼Œå…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±ä¼šåœ¨ä¸‹é¢çš„å­¦ä¹ ä¸­å¼„æ‡‚ã€‚</p><h2 id="ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°"><a href="#ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°" class="headerlink" title="ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°"></a>ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°</h2><p>JSON.stringify() ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°</p><h3 id="å¼ºå¤§çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š"><a href="#å¼ºå¤§çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š" class="headerlink" title="å¼ºå¤§çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š"></a>å¼ºå¤§çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š</h3><p>ä½œä¸ºå‡½æ•°æ—¶ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œé”®ï¼ˆkeyï¼‰å’Œå€¼ï¼ˆvalueï¼‰ï¼Œå‡½æ•°ç±»ä¼¼å°±æ˜¯æ•°ç»„æ–¹æ³• mapã€filter ç­‰æ–¹æ³•çš„å›è°ƒå‡½æ•°ï¼Œå¯¹æ¯ä¸€ä¸ªå±æ€§å€¼éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡è¯¥å‡½æ•°ï¼ˆæœŸé—´æˆ‘ä»¬è¿˜ç®€å•å®ç°è¿‡ä¸€ä¸ª map å‡½æ•°ï¼‰ã€‚<br>å¦‚æœ replacer æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å€¼ä»£è¡¨å°†è¢«åºåˆ—åŒ–æˆ JSON å­—ç¬¦ä¸²çš„å±æ€§åã€‚</p><h3 id="åä¸½çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š"><a href="#åä¸½çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š" class="headerlink" title="åä¸½çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š"></a>åä¸½çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š</h3><p>å¦‚æœæ˜¯ä¸€ä¸ªæ•°å­—, åˆ™åœ¨å­—ç¬¦ä¸²åŒ–æ—¶æ¯ä¸€çº§åˆ«ä¼šæ¯”ä¸Šä¸€çº§åˆ«ç¼©è¿›å¤šè¿™ä¸ªæ•°å­—å€¼çš„ç©ºæ ¼ï¼ˆæœ€å¤š10ä¸ªç©ºæ ¼ï¼‰ï¼›</p><p>å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™æ¯ä¸€çº§åˆ«ä¼šæ¯”ä¸Šä¸€çº§åˆ«å¤šç¼©è¿›è¯¥å­—ç¬¦ä¸²ï¼ˆæˆ–è¯¥å­—ç¬¦ä¸²çš„å‰10ä¸ªå­—ç¬¦ï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨vueé«˜é˜¶ç»„ä»¶</title>
      <link href="/2019/11/25/Vue/%E4%BD%BF%E7%94%A8vue%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/"/>
      <url>/2019/11/25/Vue/%E4%BD%BF%E7%94%A8vue%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰æ–‡"><a href="#å‰æ–‡" class="headerlink" title="å‰æ–‡"></a>å‰æ–‡</h1><p><code>é«˜é˜¶ç»„ä»¶(HOC)</code>æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼ï¼Œåœ¨ React ä¸­éå¸¸å¸¸è§ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨ Vue ä¸­ä½¿ç”¨ã€‚å®ƒå¯ä»¥è¢«æè¿°ä¸ºä¸€ç§<strong>åœ¨ç»„ä»¶ä¹‹é—´å…±äº«å…¬å…±åŠŸèƒ½è€Œä¸éœ€è¦é‡å¤ä»£ç </strong>çš„æ–¹æ³•ã€‚HOC çš„ç›®çš„æ˜¯å¢å¼ºç»„ä»¶çš„åŠŸèƒ½ã€‚å®ƒå…è®¸åœ¨é¡¹ç›®ä¸­å®ç°å¯é‡ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><ul><li>åªè¦ä½ å‘ä¸€ä¸ªæ–¹æ³•ä¼ å…¥ç»„ä»¶ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œè¿™å°±æ˜¯ä¸€ä¸ª HOCã€‚</li></ul><blockquote><p>é«˜é˜¶ç»„ä»¶åœ¨ä»¥ä¸‹æ–¹é¢éå¸¸æœ‰ç”¨: 1.æ“ä½œå±æ€§ã€‚ 2.æ“ä½œæ•°æ®å’Œæ•°æ®æŠ½è±¡ã€‚ 3.ä»£ç é‡ç”¨</p></blockquote><h2 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h2><p>åœ¨æˆ‘ä»¬å¼€å§‹æ•™ç¨‹ä¹‹å‰ï¼Œéœ€è¦äº†è§£ä»¥ä¸‹å‡ ç‚¹ï¼š</p><p>ä½¿ç”¨ Vue æ¡†æ¶çš„ç»éªŒã€‚<br>çŸ¥é“å¦‚ä½•ä½¿ç”¨ vue-cli è®¾ç½®åº”ç”¨ç¨‹åºã€‚<br>JavaScript å’Œ Vue çš„åŸºæœ¬çŸ¥è¯†<br>Node (8)<br>npm (5.2.0)</p><h2 id="Vue-ä¸­çš„é«˜é˜¶ç»„ä»¶æ¨¡å¼"><a href="#Vue-ä¸­çš„é«˜é˜¶ç»„ä»¶æ¨¡å¼" class="headerlink" title="Vue ä¸­çš„é«˜é˜¶ç»„ä»¶æ¨¡å¼"></a>Vue ä¸­çš„é«˜é˜¶ç»„ä»¶æ¨¡å¼</h2><p>è™½ç„¶é«˜é˜¶ç»„ä»¶é€šå¸¸ä¸ React ç›¸å…³è”ï¼Œä½†æ˜¯ä¸º Vue ç»„ä»¶åˆ›å»ºé«˜é˜¶ç»„ä»¶æ˜¯å¾ˆæœ‰å¯èƒ½çš„ã€‚åœ¨ Vue ä¸­åˆ›å»ºé«˜é˜¶ç»„ä»¶çš„æ¨¡å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code class="js">// hoccomponent.jsimport Vue from &quot;vue&quot;import ComponentExample from &#39;@/components/ComponentExample.vue&#39;const HoComponent = (component) =&gt; {    return Vue.component(&#39;withSubscription&#39;, {        render(createElement) {            return createElement(component)        }    }}const HoComponentEnhanced = HoComponent(ComponentExample);</code></pre><p>å¦‚ä¸Šé¢çš„ä»£ç å—æ‰€ç¤ºï¼Œ<code>HoComponent</code> å‡½æ•°æ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°ç»„ä»¶æ¥æ¸²æŸ“ä¼ è¿›æ¥çš„ç»„ä»¶ã€‚</p><h2 id="ä¸€ä¸ªç®€å•çš„-HOC-ç¤ºä¾‹"><a href="#ä¸€ä¸ªç®€å•çš„-HOC-ç¤ºä¾‹" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ HOC ç¤ºä¾‹"></a>ä¸€ä¸ªç®€å•çš„ HOC ç¤ºä¾‹</h2><p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸ªä½¿ç”¨é«˜é˜¶ç»„ä»¶çš„ç¤ºä¾‹ã€‚åœ¨ä»‹ç»é«˜é˜¶ç»„ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬å°†äº†è§£åœ¨æ²¡æœ‰é«˜é˜¶ç»„ä»¶çš„æƒ…å†µä¸‹ï¼Œå½“å‰çš„ä»£ç åº“æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œç„¶åäº†è§£å¦‚ä½•è¿›è¡ŒæŠ½è±¡ã€‚</p><p><a href="https://codesandbox.io/embed/llvq04nx4l" target="_blank" rel="noopener">https://codesandbox.io/embed/llvq04nx4l</a></p><p>æ­£å¦‚ä¸Šé¢çš„ CodeSandbox æ‰€ç¤ºï¼Œè¯¥åº”ç”¨ç¨‹åºä¼šæ˜¾ç¤ºä¸€ä¸ªçº¸ä¸šå…¬å¸åŠå…¶å‡€èµ„äº§çš„åˆ—è¡¨ï¼Œä»¥åŠã€ŠåŠå…¬å®¤ã€‹(ç¾å›½)ä¸­çš„äººç‰©åŠå…¶è·å¥–æƒ…å†µã€‚</p><p>æˆ‘ä»¬è·å¾—åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰æ•°æ®æ¥æºåªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯<code>mockData.js</code>æ–‡ä»¶ã€‚</p><a id="more"></a><pre><code class="js">// src/components/mockData.jsconst staff = [  {    name: &quot;Michael Scott&quot;,    id: 0,    awards: 2  },  {    name: &quot;Toby Flenderson&quot;,    id: 1,    awards: 0  },  {    name: &quot;Dwight K. Schrute&quot;,    id: 2,    awards: 10  },  {    name: &quot;Jim Halpert&quot;,    id: 3,    awards: 1  },  {    name: &quot;Andy Bernard&quot;,    id: 4,    awards: 0  },  {    name: &quot;Phyllis Vance&quot;,    id: 5,    awards: 0  },  {    name: &quot;Stanley Hudson&quot;,    id: 6,    awards: 0  }];const paperCompanies = [  {    id: 0,    name: &quot;Staples&quot;,    net: 10000000  },  {    id: 1,    name: &quot;Dundler Mufflin&quot;,    net: 5000000  },  {    id: 2,    name: &quot;Michael Scott Paper Company&quot;,    net: 300000  },  {    id: 3,    name: &quot;Prince Family Paper&quot;,    net: 30000  }];export default {  getStaff() {    return staff;  },  getCompanies() {    return paperCompanies;  },  increaseAward(id) {    staff[id].awards++;  },  decreaseAward(id) {    staff[id].awards--;  },  setNetWorth(id) {    paperCompanies[id].net = Math.random() * (5000000 - 50000) + 50000;  }};</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæœ‰å‡ ä¸ª const å˜é‡ä¿å­˜äº†å…¬å¸å’Œå‘˜å·¥åˆ—è¡¨çš„ä¿¡æ¯ã€‚æˆ‘ä»¬ä¹Ÿå¯¼å‡ºäº†ä¸€äº›å‡½æ•°ï¼Œ</p><blockquote><p>å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š<br>è¿”å›å‘˜å·¥åˆ—è¡¨<br>è¿”å›å…¬å¸åˆ—è¡¨<br>å¢åŠ å’Œå‡å°‘å¯¹ç‰¹å®šå‘˜å·¥çš„å¥–åŠ±ï¼Œæœ€å<br>æœ€åï¼Œè®¾å®šå…¬å¸çš„å‡€å€¼</p></blockquote><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ <code>Staff.vue</code> å’Œ <code>Companies.vue</code> ç»„ä»¶ã€‚</p><pre><code class="html">// src/components/Staff.vue&lt;template&gt;  &lt;main&gt;    &lt;h3&gt;Staff List&lt;/h3&gt;    &lt;div v-for=&quot;(staff, i) in staffList&quot; :key=&quot;i&quot;&gt;      {{ staff.name }}: {{ staff.awards }} Salesman of the year Award ğŸ‰      &lt;button @click=&quot;increaseAwards(staff.id);&quot;&gt;+&lt;/button&gt;      &lt;button @click=&quot;decreaseAwards(staff.id);&quot;&gt;-&lt;/button&gt;    &lt;/div&gt;  &lt;/main&gt;&lt;/template&gt;&lt;script&gt;  import mockData from &quot;./mockData.js&quot;;  export default {    data() {      return {        staffList: mockData.getStaff()      };    },    methods: {      increaseAwards(id) {        mockData.increaseAward(id);        this.staffList = mockData.getStaff();      },      decreaseAwards(id) {        mockData.decreaseAward(id);        this.staffList = mockData.getStaff();      }    }  };&lt;/script&gt;</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæ•°æ®å®ä¾‹å˜é‡staffListè¢«èµ‹å€¼ä¸ºå‡½æ•°mockData.getStaff()è¿”å›çš„å†…å®¹ã€‚æˆ‘ä»¬ä¹Ÿæœ‰increaseAwardså’ŒdecreaseAwardså‡½æ•°ï¼Œåˆ†åˆ«è°ƒç”¨mockData.increaseAward å’Œ mockData.decreaseAwardã€‚ä¼ é€’ç»™è¿™äº›å‡½æ•°çš„id æ˜¯ä»æ¸²æŸ“çš„æ¨¡æ¿ä¸­è·å¾—çš„ã€‚</p><pre><code class="html">    // src/components/Companies.vue    &lt;template&gt;      &lt;main&gt;        &lt;h3&gt;Paper Companies&lt;/h3&gt;        &lt;div v-for=&quot;(companies, i) in companies&quot; :key=&quot;i&quot;&gt;          {{ companies.name }} - ${{ companies.net          }}&lt;button @click=&quot;setWorth(companies.id);&quot;&gt;Set Company Value&lt;/button&gt;        &lt;/div&gt;      &lt;/main&gt;    &lt;/template&gt;    &lt;script&gt;      import mockData from &quot;./mockData.js&quot;;        export default {        data() {          return {            companies: mockData.getCompanies()          };        },        methods: {          setWorth(id) {            mockData.setNetWorth(id);            this.companies = mockData.getCompanies();          }        }      };    &lt;/script&gt;</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæ•°æ®å®ä¾‹å˜é‡companies è¢«èµ‹å€¼ä¸ºå‡½æ•°mockData.getCompanies()çš„è¿”å›å†…å®¹ã€‚æˆ‘ä»¬è¿˜æœ‰setWorthå‡½æ•°ï¼Œå®ƒé€šè¿‡å°†å…¬å¸çš„ id ä¼ é€’ç»™mockData.setNetWorthæ¥è®¾ç½®ä¸€ä¸ªéšæœºå€¼ä½œä¸ºå‡€å€¼ã€‚ä¼ é€’ç»™å‡½æ•°çš„idæ˜¯ä»æ¸²æŸ“çš„æ¨¡æ¿ä¸­è·å¾—çš„ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†è¿™ä¸¤ä¸ªç»„ä»¶æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬å¯ä»¥</p><blockquote><p>æ‰¾å‡ºå®ƒä»¬ä¹‹é—´çš„å…±åŒç‚¹ï¼Œå¹¶å°†å…¶æŠ½è±¡å¦‚ä¸‹ï¼š</p></blockquote><p>ä»æ•°æ®æºè·å–æ•°æ® (mockData.js)<br>onClick å‡½æ•°</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å°†ä¸Šé¢çš„æ“ä½œæ”¾åˆ°é«˜é˜¶ç»„ä»¶ä¸­ï¼Œä»¥é¿å…ä»£ç é‡å¤å¹¶ç¡®ä¿å¯é‡ç”¨æ€§ã€‚</p><p>HoComponent å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªç»„ä»¶å’ŒfetchDataã€‚fetchDataæ–¹æ³•ç”¨äºç¡®å®šè¦åœ¨è¡¨ç¤ºç»„ä»¶ä¸­æ˜¾ç¤ºä»€ä¹ˆã€‚è¿™æ„å‘³ç€æ— è®ºåœ¨å“ªé‡Œä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œä½œä¸ºfetchData ä¼ é€’çš„å‡½æ•°éƒ½å°†è¢«ç”¨æ¥ä»mockData ä¸­è·å–æ•°æ®ã€‚</p><p>ç„¶åå°†æ•°æ®å®ä¾‹returnedData è®¾ç½®ä¸ºfetchDataçš„å†…å®¹ï¼Œç„¶åä½œä¸ºprops ä¼ é€’ç»™åœ¨é«˜é˜¶ç»„ä»¶ä¸­åˆ›å»ºçš„æ–°ç»„ä»¶ã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹æ–°åˆ›å»ºçš„é«˜é˜¶ç»„ä»¶å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚æˆ‘ä»¬éœ€è¦ç¼–è¾‘Staff.vue å’ŒCompanies.vueã€‚</p><pre><code class="html">    // src/components/Staff.vue    &lt;template&gt;      &lt;main&gt;        &lt;h3&gt;Staff List&lt;/h3&gt;        &lt;div v-for=&quot;(staff, i) in returnedData&quot; :key=&quot;i&quot;&gt;          {{ staff.name }}: {{ staff.awards }} Salesman of the year Award ğŸ‰          &lt;button @click=&quot;increaseAwards(staff.id);&quot;&gt;+&lt;/button&gt;          &lt;button @click=&quot;decreaseAwards(staff.id);&quot;&gt;-&lt;/button&gt;        &lt;/div&gt;      &lt;/main&gt;    &lt;/template&gt;    &lt;script&gt;      export default {        props: [&quot;returnedData&quot;]      };    &lt;/script&gt;</code></pre><pre><code class="html">    // src/components/Companies.vue    &lt;template&gt;      &lt;main&gt;        &lt;h3&gt;Paper Companies&lt;/h3&gt;        &lt;div v-for=&quot;(companies, i) in returnedData&quot; :key=&quot;i&quot;&gt;          {{ companies.name }} - ${{ companies.net          }}&lt;button @click=&quot;setWorth(companies.id);&quot;&gt;Set Company Value&lt;/button&gt;        &lt;/div&gt;      &lt;/main&gt;    &lt;/template&gt;    &lt;script&gt;      export default {        props: [&quot;returnedData&quot;]      };    &lt;/script&gt;</code></pre><p>æ­£å¦‚ä½ åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­çœ‹åˆ°çš„ï¼Œå¯¹äºè¿™ä¸¤ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬å»æ‰äº†å‡½æ•°å’Œæ•°æ®å®ä¾‹å˜é‡ï¼Œæ˜¾ç¤ºå†…å®¹æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ç°åœ¨éƒ½å°†ä»è¿™äº›propsä¸­è·å¾—ã€‚å¯¹äºåˆ æ‰çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°†å¾ˆå¿«ä¼šè®²åˆ°ã€‚</p><p>åœ¨ App.vue ç»„ä»¶ä¸­ï¼Œç”¨ä»¥ä¸‹ä»£ç ç¼–è¾‘script æ ‡ç­¾ä¸­çš„ç°æœ‰å†…å®¹ï¼š</p><pre><code class="html">    // src/App.vue    &lt;script&gt;      // import the Companies component      import Companies from &quot;./components/Companies&quot;;      // import the Staff component      import Staff from &quot;./components/Staff&quot;;      // import the higher order component      import HoComponent from &quot;./components/HoComponent.js&quot;;      // Create a const variable which contains the Companies component wrapped in the higher order component      const CompaniesComponent = HoComponent(Companies, mockData =&gt; mockData.getCompanies()      );      // Create a const variable which contains the Staff component wrapped in the higher order component      const StaffComponent = HoComponent(Staff, mockData =&gt; mockData.getStaff());      export default {        name: &quot;App&quot;,        components: {          CompaniesComponent,          StaffComponent        }      };    &lt;/script&gt;</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼ŒHoComponentç”¨äºåŒ…è£… Staff å’Œ Companies ç»„ä»¶ã€‚</p><p>æ¯ä¸ªç»„ä»¶ä½œä¸ºHoComponent çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¿”å›å¦ä¸€ä¸ªå‡½æ•°ï¼ŒæŒ‡å®šåº”è¯¥ä»mockDataè·å–ä»€ä¹ˆæ•°æ®ã€‚è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„é«˜é˜¶ç»„ä»¶(HoComponent.js)ä¸­çš„fetchData å‡½æ•°ã€‚</p><p>å¦‚æœä½ ç°åœ¨åˆ·æ–°åº”ç”¨ç¨‹åºï¼Œä½ åº”è¯¥ä»ç„¶å¯ä»¥çœ‹åˆ°æ¥è‡ªmockData æ–‡ä»¶çš„æ•°æ®åƒå¾€å¸¸ä¸€æ ·å‘ˆç°ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œè¿™äº›æŒ‰é’®æ— æ³•å·¥ä½œï¼Œå› ä¸ºå®ƒä»¬è¿˜æ²¡æœ‰ç»‘å®šåˆ°ä»»ä½•å‡½æ•°ã€‚è®©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><pre><code class="html">    // src/App.vue    &lt;template&gt;      &lt;div id=&quot;app&quot;&gt;        &lt;CompaniesComponent @click=&quot;onEventHappen&quot; /&gt;        &lt;StaffComponent @click=&quot;onEventHappen&quot; /&gt;      &lt;/div&gt;    &lt;/template&gt;    &lt;script&gt;      // import the Companies component      import Companies from &quot;./components/Companies&quot;;      // import the Staff component      import Staff from &quot;./components/Staff&quot;;      // import the higher order component      import HoComponent from &quot;./components/HoComponent.js&quot;;      // import the source data from mockData only to be used for event handlers      import sourceData from &quot;./components/mockData.js&quot;;      // Create a const variable which contains the Companies component wrapped in the higher order component      const CompaniesComponent = HoComponent(Companies, mockData =&gt;      mockData.getCompanies()      );      // Create a const variable which contains the Staff component wrapped in the higher order component      const StaffComponent = HoComponent(Staff, mockData =&gt; mockData.getStaff());      export default {        name: &quot;App&quot;,        components: {          CompaniesComponent,          StaffComponent          },        methods: {          onEventHappen(value) {            // set the variable setFunction to the name of the function that was passed iin the value emitted from child component i.e. if value.name is &#39;increaseAward&#39;, setFunction is set to increaseAward()            let setFunction = sourceData[value.name];            // call the corresponding function with the id passed as an argument.            setFunction(value.id);          }        }      };    &lt;/script&gt;    &lt;style&gt;    #app {      font-family: &quot;Avenir&quot;, Helvetica, Arial, sans-serif;      -webkit-font-smoothing: antialiased;      -moz-osx-font-smoothing: grayscale;      text-align: center;      color: #2c3e50;      margin-top: 60px;    }    &lt;/style&gt;</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæˆ‘ä»¬åœ¨App.vueç»„ä»¶ä¸­æ·»åŠ äº†ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚</p><p>vueçš„ç»„ä»¶ã€‚æ¯å½“Staff.vue æˆ–Companies.vue ç»„ä»¶è¢«ç‚¹å‡»æ—¶ï¼ŒonEventHappen æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ã€‚</p><p>åœ¨onEventHappenæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°†å˜é‡setFunction è®¾ç½®ä¸ºä»å­ç»„ä»¶å‘å‡ºçš„å€¼ä¸­ä¼ é€’çš„å‡½æ•°åï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœvalue.nameæ˜¯â€™increaseAwardâ€™ï¼Œé‚£ä¹ˆsetFunctionè®¾ç½®ä¸ºincreaseAward()ã€‚setFunction å°†ä»¥idä½œä¸ºå‚æ•°æ‰§è¡Œã€‚</p><p>æœ€åï¼Œä¸ºäº†å°†äº‹ä»¶ç›‘å¬å™¨ä¼ é€’ç»™å°è£…åœ¨é«˜é˜¶ç»„ä»¶ä¸­çš„ç»„ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ HoComponent.jsæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢è¿™è¡Œä»£ç ã€‚</p><pre><code class="js">    props: {    returnedData: this.returnedData    },    on: { ...this.$listeners }</code></pre><h2 id="vue-hoc"><a href="#vue-hoc" class="headerlink" title="vue-hoc"></a>vue-hoc</h2><p>æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<a href="https://github.com/jackmellis/vue-hoc" target="_blank" rel="noopener">vue-hoc</a>åº“æ¥å¸®åŠ©åˆ›å»ºé«˜é˜¶ç»„ä»¶ã€‚vue-hocå¸®åŠ©ä½ è½»æ¾åœ°åˆ›å»ºé«˜é˜¶ç»„ä»¶ï¼Œä½ è¦åšçš„å°±æ˜¯ä¼ é€’åŸºæœ¬ç»„ä»¶ã€åº”ç”¨äºHOCçš„ä¸€ç³»åˆ—ç»„ä»¶é€‰é¡¹å’Œåœ¨æ¸²æŸ“é˜¶æ®µä¼ é€’ç»™ç»„ä»¶çš„æ•°æ®å±æ€§ã€‚<br>vue-hoc å¯ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼š<br>    <code>npm install --save vue-hoc</code></p><p>å¤åˆ¶ä»£ç vue-hocæ’ä»¶æœ‰ä¸€äº›ä¾‹å­å¯ä»¥è®©ä½ å¼€å§‹åˆ›å»ºæ›´é«˜é˜¶çš„ç»„ä»¶ï¼Œä½ å¯ä»¥<a href="https://github.com/jackmellis/vue-hoc/blob/master/packages/vue-hoc/README.md" target="_blank" rel="noopener">æŸ¥çœ‹è¿™é‡Œ</a>.</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€å¼ å›¾ç†æ¸… Vue 3.0 çš„å“åº”å¼ç³»ç»Ÿ</title>
      <link href="/2019/10/29/Vue/%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%90%86%E6%B8%85-Vue-3-0-%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
      <url>/2019/10/29/Vue/%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%90%86%E6%B8%85-Vue-3-0-%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<p>è½¬è‡ª</p><p>ä½œè€…ï¼šJrain<br><a href="https://juejin.im/post/5d9da45af265da5b8072de5d" target="_blank" rel="noopener">é“¾æ¥</a></p><p><img src="https://user-gold-cdn.xitu.io/2019/10/9/16dafca37b2e0534?imageslim" alt="vue reactive"></p><h2 id="ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­"><a href="#ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­"></a>ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­</h2><p>Vue 3.0 çš„å“åº”å¼ç³»ç»Ÿæ˜¯ç‹¬ç«‹çš„æ¨¡å—ï¼Œå¯ä»¥å®Œå…¨è„±ç¦» Vue è€Œä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ clone äº†æºç ä¸‹æ¥ä»¥åï¼Œå¯ä»¥ç›´æ¥åœ¨ <code>packages/reactivity</code> æ¨¡å—ä¸‹è°ƒè¯•ã€‚</p><p>1.åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ <code>yarn dev reactivity</code>ï¼Œç„¶åè¿›å…¥ <code>packages/reactivity</code> ç›®å½•æ‰¾åˆ°äº§å‡ºçš„ <code>dist/reactivity.global.js</code> æ–‡ä»¶ã€‚<br>2.æ–°å»ºä¸€ä¸ª <code>index.html</code>ï¼Œå†™å…¥å¦‚ä¸‹ä»£ç ï¼š</p><pre><code class="html">&lt;script src=&quot;./dist/reactivity.global.js&quot;&gt;&lt;/script&gt;&lt;script&gt;const { reactive, effect } = VueObserverconst origin = {  count: 0}const state = reactive(origin)const fn = () =&gt; {  const count = state.count  console.log(`set count to ${count}`)}effect(fn)&lt;/script&gt;</code></pre><ol start="3"><li>åœ¨æµè§ˆå™¨æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œäºæ§åˆ¶å°æ‰§è¡Œ <code>state.count++</code>ï¼Œä¾¿å¯çœ‹åˆ°è¾“å‡º <code>set count to 1</code>ã€‚</li></ol><p>åœ¨ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>reactive()</code> å‡½æ•°æŠŠ <code>origin</code> å¯¹è±¡è½¬åŒ–æˆäº†<code>Proxy</code> å¯¹è±¡ <code>state</code>ï¼›ä½¿ç”¨ <code>effect()</code> å‡½æ•°æŠŠ <code>fn()</code> ä½œä¸ºå“åº”å¼å›è°ƒã€‚å½“ <code>state.count</code> å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¾¿è§¦å‘äº† <code>fn()</code>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä»¥è¿™ä¸ªä¾‹å­ç»“åˆä¸Šæ–‡çš„æµç¨‹å›¾ï¼Œæ¥è®²è§£è¿™å¥—å“åº”å¼ç³»ç»Ÿæ˜¯æ€ä¹ˆè¿è¡Œçš„ã€‚</p><h3 id="åˆå§‹åŒ–é˜¶æ®µ"><a href="#åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="åˆå§‹åŒ–é˜¶æ®µ"></a>åˆå§‹åŒ–é˜¶æ®µ</h3><blockquote><p>åœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œä¸»è¦åšäº†ä¸¤ä»¶äº‹ã€‚</p></blockquote><p>1.æŠŠ origin å¯¹è±¡è½¬åŒ–æˆå“åº”å¼çš„ Proxy å¯¹è±¡ stateã€‚<br>2.æŠŠå‡½æ•° fn() ä½œä¸ºä¸€ä¸ªå“åº”å¼çš„ effect å‡½æ•°ã€‚</p><p>å¤§å®¶éƒ½çŸ¥é“ï¼ŒVue 3.0 ä½¿ç”¨äº† <code>Proxy</code> æ¥ä»£æ›¿ä¹‹å‰çš„ <code>Object.defineProperty()</code>ï¼Œæ”¹å†™äº†å¯¹è±¡çš„ <code>getter/setter</code>ï¼Œå®Œæˆä¾èµ–æ”¶é›†å’Œå“åº”è§¦å‘ã€‚ä½†æ˜¯åœ¨è¿™ä¸€é˜¶æ®µä¸­ï¼Œæˆ‘ä»¬æš‚æ—¶å…ˆä¸ç®¡å®ƒæ˜¯å¦‚ä½•æ”¹å†™å¯¹è±¡çš„ <code>getter/setter</code> çš„ï¼Œè¿™ä¸ªåœ¨åç»­çš„â€<strong>ä¾èµ–æ”¶é›†é˜¶æ®µ</strong>â€œä¼šè¯¦ç»†è¯´æ˜ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™éƒ¨åˆ†çš„å†…å®¹æµ“ç¼©æˆä¸€ä¸ªåªæœ‰ä¸¤è¡Œä»£ç çš„ <code>reactive()</code> å‡½æ•°ï¼š</p><pre><code class="js">    export default reactive (target){        const observed = new Proxy(target,handler);        return observed;    }</code></pre><p>å½“ä¸€ä¸ªæ™®é€šçš„å‡½æ•° <code>fn()</code> è¢« <code>effect()</code> åŒ…è£¹ä¹‹åï¼Œå°±ä¼šå˜æˆä¸€ä¸ªå“åº”å¼çš„ effect å‡½æ•°ï¼Œè€Œ <code>fn()</code> ä¹Ÿä¼šè¢«ç«‹å³æ‰§è¡Œä¸€æ¬¡ã€‚</p><p><strong>ç”±äºåœ¨ fn() é‡Œé¢æœ‰å¼•ç”¨åˆ° Proxy å¯¹è±¡çš„å±æ€§ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥ä¼šè§¦å‘å¯¹è±¡çš„ getterï¼Œä»è€Œå¯åŠ¨ä¾èµ–æ”¶é›†</strong>ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸ª effect å‡½æ•°ä¹Ÿä¼šè¢«å‹å…¥ä¸€ä¸ªåä¸ºâ€<code>activeReactiveEffectStack</code>â€œï¼ˆæ­¤å¤„ä¸º <code>effectStack</code>ï¼‰çš„æ ˆä¸­ï¼Œä¾›åç»­ä¾èµ–æ”¶é›†çš„æ—¶å€™ä½¿ç”¨ã€‚</p><pre><code class="js">export function effect (fn) {  // æ„é€ ä¸€ä¸ª effect  const effect = function effect(...args) {    return run(effect, fn, args)  }  // ç«‹å³æ‰§è¡Œä¸€æ¬¡  effect()  return effect}export function run(effect, fn, args) {  if (effectStack.indexOf(effect) === -1) {    try {      // å¾€æ± å­é‡Œæ”¾å…¥å½“å‰ effect      effectStack.push(effect)      // ç«‹å³æ‰§è¡Œä¸€é fn()      // fn() æ‰§è¡Œè¿‡ç¨‹ä¼šå®Œæˆä¾èµ–æ”¶é›†ï¼Œä¼šç”¨åˆ° effect      return fn(...args)    } finally {      // å®Œæˆä¾èµ–æ”¶é›†åä»æ± å­ä¸­æ‰”æ‰è¿™ä¸ª effect      effectStack.pop()    }  }}</code></pre><p>è‡³æ­¤ï¼Œåˆå§‹åŒ–é˜¶æ®µå·²ç»å®Œæˆã€‚æ¥ä¸‹æ¥å°±æ˜¯æ•´ä¸ªç³»ç»Ÿæœ€å…³é”®çš„ä¸€æ­¥â€”â€”ä¾èµ–æ”¶é›†é˜¶æ®µã€‚<br><a id="more"></a></p><h3 id="ä¾èµ–æ”¶é›†é˜¶æ®µ"><a href="#ä¾èµ–æ”¶é›†é˜¶æ®µ" class="headerlink" title="ä¾èµ–æ”¶é›†é˜¶æ®µ"></a>ä¾èµ–æ”¶é›†é˜¶æ®µ</h3><p>è¿™ä¸ªé˜¶æ®µçš„è§¦å‘æ—¶æœºï¼Œå°±æ˜¯åœ¨ <code>effect</code> è¢«ç«‹å³æ‰§è¡Œï¼Œå…¶å†…éƒ¨çš„ <code>fn()</code> è§¦å‘äº† <code>Proxy</code> å¯¹è±¡çš„ <code>getter</code> çš„æ—¶å€™ã€‚ç®€å•æ¥è¯´ï¼Œåªè¦æ‰§è¡Œåˆ°ç±»ä¼¼ <code>state.count</code> çš„è¯­å¥ï¼Œå°±ä¼šè§¦å‘ <code>state çš„ getter</code>ã€‚</p><p>ä¾èµ–æ”¶é›†é˜¶æ®µæœ€é‡è¦çš„ç›®çš„ï¼Œå°±æ˜¯å»ºç«‹ä¸€ä»½â€ä¾èµ–æ”¶é›†è¡¨â€œï¼Œä¹Ÿå°±æ˜¯å›¾ç¤ºçš„â€<code>targetMap</code>â€œã€‚<code>targetMap</code> æ˜¯ä¸€ä¸ª <code>WeakMap</code>ï¼Œå…¶ key å€¼æ˜¯<del>å½“å‰çš„ <code>Prox</code>y å¯¹è±¡ <code>state</code></del>ä»£ç†å‰çš„å¯¹è±¡originï¼Œè€Œ value åˆ™æ˜¯è¯¥å¯¹è±¡æ‰€å¯¹åº”çš„ <code>depsMap</code>ã€‚</p><p><code>depsMap</code> æ˜¯ä¸€ä¸ª Mapï¼Œkey å€¼ä¸ºè§¦å‘ <code>getter</code> æ—¶çš„å±æ€§å€¼ï¼ˆæ­¤å¤„ä¸º countï¼‰ï¼Œè€Œ value åˆ™æ˜¯è§¦å‘è¿‡è¯¥å±æ€§å€¼æ‰€å¯¹åº”çš„å„ä¸ª effectã€‚</p><p>è¿˜æ˜¯æœ‰ç‚¹ç»•ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å†ä¸¾ä¸ªä¾‹å­ã€‚å‡è®¾æœ‰ä¸ª Proxy å¯¹è±¡å’Œ effect å¦‚ä¸‹ï¼š</p><pre><code class="js">const state = reactive({  count: 0,  age: 18})const effect1 = effect(() =&gt; {  console.log(&#39;effect1: &#39; + state.count)})const effect2 = effect(() =&gt; {  console.log(&#39;effect2: &#39; + state.age)})const effect3 = effect(() =&gt; {  console.log(&#39;effect3: &#39; + state.count, state.age)})</code></pre><p>è¿™æ ·ï¼Œ<code>{ target -&gt; key -&gt; dep }</code> çš„å¯¹åº”å…³ç³»å°±å»ºç«‹èµ·æ¥äº†ï¼Œä¾èµ–æ”¶é›†ä¹Ÿå°±å®Œæˆäº†</p><pre><code class="js">export function track (target, operationType, key) {  const effect = effectStack[effectStack.length - 1]  if (effect) {    let depsMap = targetMap.get(target)    if (depsMap === void 0) {      targetMap.set(target, (depsMap = new Map()))    }    let dep = depsMap.get(key)    if (dep === void 0) {      depsMap.set(key, (dep = new Set()))    }    if (!dep.has(effect)) {      dep.add(effect)    }  }}</code></pre><p>å¼„æ˜ç™½ä¾èµ–æ”¶é›†è¡¨ targetMap æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºè¿™æ˜¯æ•´ä¸ªå“åº”å¼ç³»ç»Ÿæ ¸å¿ƒä¸­çš„æ ¸å¿ƒã€‚</p><h3 id="å“åº”é˜¶æ®µ"><a href="#å“åº”é˜¶æ®µ" class="headerlink" title="å“åº”é˜¶æ®µ"></a>å“åº”é˜¶æ®µ</h3><p>å›é¡¾ä¸Šä¸€ç« èŠ‚çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª <code>{ count: 0, age: 18 }</code> çš„ Proxyï¼Œå¹¶æ„é€ äº†ä¸‰ä¸ª effectã€‚åœ¨æ§åˆ¶å°ä¸Šçœ‹çœ‹æ•ˆæœï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2019/10/9/16dafca37dadf75d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="effect"></p><p>å½“ä¿®æ”¹å¯¹è±¡çš„æŸä¸ªå±æ€§å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº”çš„ <code>setter</code>ã€‚</p><p>setter é‡Œé¢çš„ <code>trigger()</code> å‡½æ•°ä¼šä»ä¾èµ–æ”¶é›†è¡¨é‡Œæ‰¾åˆ°å½“å‰å±æ€§å¯¹åº”çš„å„ä¸ª <code>dep</code>ï¼Œç„¶åæŠŠå®ƒä»¬æ¨å…¥åˆ° <code>effects</code> å’Œ <code>computedEffects</code>ï¼ˆè®¡ç®—å±æ€§ï¼‰ é˜Ÿåˆ—ä¸­ï¼Œæœ€åé€šè¿‡ <code>scheduleRun()</code> æŒ¨ä¸ªæ‰§è¡Œé‡Œé¢çš„ effectã€‚</p><p>ç”±äºå·²ç»å»ºç«‹äº†ä¾èµ–æ”¶é›†è¡¨ï¼Œæ‰€ä»¥è¦æ‰¾åˆ°å±æ€§æ‰€å¯¹åº”çš„ dep ä¹Ÿå°±è½»è€Œæ˜“ä¸¾äº†</p><pre><code class="js">export function trigger (target, operationType, key) {  // å–å¾—å¯¹åº”çš„ depsMap  const depsMap = targetMap.get(target)  if (depsMap === void 0) {    return  }  // å–å¾—å¯¹åº”çš„å„ä¸ª dep  const effects = new Set()  if (key !== void 0) {    const dep = depsMap.get(key)    dep &amp;&amp; dep.forEach(effect =&gt; {      effects.add(effect)    })  }  // ç®€åŒ–ç‰ˆ scheduleRunï¼ŒæŒ¨ä¸ªæ‰§è¡Œ effect  effects.forEach(effect =&gt; {    effect()  })}</code></pre><p>è‡³æ­¤ï¼Œå“åº”å¼é˜¶æ®µå®Œæˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue3.x </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£Node.jsä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹</title>
      <link href="/2019/09/30/Node/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Node-js%E4%B8%AD%E7%9A%84%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/"/>
      <url>/2019/09/30/Node/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Node-js%E4%B8%AD%E7%9A%84%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5d43017be51d4561f40adcf9" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><code>è¿›ç¨‹</code>ä¸<code>çº¿ç¨‹</code>æ˜¯ä¸€ä¸ªç¨‹åºå‘˜çš„å¿…çŸ¥æ¦‚å¿µï¼Œé¢è¯•ç»å¸¸è¢«é—®åŠï¼Œä½†æ˜¯ä¸€äº›æ–‡ç« å†…å®¹åªæ˜¯è®²è®²ç†è®ºçŸ¥è¯†ï¼Œå¯èƒ½ä¸€äº›å°ä¼™ä¼´å¹¶æ²¡æœ‰çœŸçš„ç†è§£ï¼Œåœ¨å®é™…å¼€å‘ä¸­åº”ç”¨ä¹Ÿæ¯”è¾ƒå°‘ã€‚æœ¬ç¯‡æ–‡ç« é™¤äº†ä»‹ç»æ¦‚å¿µï¼Œé€šè¿‡Node.js çš„è§’åº¦è®²è§£<code>è¿›ç¨‹</code>ä¸<code>çº¿ç¨‹</code>ï¼Œå¹¶ä¸”è®²è§£ä¸€äº›åœ¨é¡¹ç›®ä¸­çš„å®æˆ˜çš„åº”ç”¨ï¼Œè®©ä½ ä¸ä»…èƒ½è¿æˆ˜é¢è¯•å®˜è¿˜å¯ä»¥åœ¨å®æˆ˜ä¸­å®Œç¾åº”ç”¨</p><h2 id="æ–‡ç« å¯¼è§ˆ"><a href="#æ–‡ç« å¯¼è§ˆ" class="headerlink" title="æ–‡ç« å¯¼è§ˆ"></a>æ–‡ç« å¯¼è§ˆ</h2><p><img src="https://user-gold-cdn.xitu.io/2019/8/8/16c6cf612c275894?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="è¿›ç¨‹ä¸çº¿ç¨‹"></p><h2 id="é¢è¯•ä¼šé—®"><a href="#é¢è¯•ä¼šé—®" class="headerlink" title="é¢è¯•ä¼šé—®"></a>é¢è¯•ä¼šé—®</h2><ul><li>Node.jsæ˜¯å•çº¿ç¨‹å—ï¼Ÿ</li></ul><ul><li>Node.js åšè€—æ—¶çš„è®¡ç®—æ—¶å€™ï¼Œå¦‚ä½•é¿å…é˜»å¡ï¼Ÿ</li></ul><ul><li>Node.jså¦‚ä½•å®ç°å¤šè¿›ç¨‹çš„å¼€å¯å’Œå…³é—­ï¼Ÿ</li></ul><ul><li>Node.jså¯ä»¥åˆ›å»ºçº¿ç¨‹å—ï¼Ÿ</li></ul><ul><li>ä½ ä»¬å¼€å‘è¿‡ç¨‹ä¸­å¦‚ä½•å®ç°è¿›ç¨‹å®ˆæŠ¤çš„ï¼Ÿ</li></ul><ul><li>é™¤äº†ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œä½ ä»¬è‡ªå·±æ˜¯å¦å°è£…è¿‡ä¸€ä¸ªå¤šè¿›ç¨‹æ¶æ„?</li></ul><h2 id="è¿›ç¨‹"><a href="#è¿›ç¨‹" class="headerlink" title="è¿›ç¨‹"></a>è¿›ç¨‹</h2><p>è¿›ç¨‹<code>Process</code>æ˜¯è®¡ç®—æœºä¸­çš„ç¨‹åºå…³äºæŸæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œæ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿç»“æ„çš„åŸºç¡€ï¼Œè¿›ç¨‹æ˜¯çº¿ç¨‹çš„å®¹å™¨ï¼ˆæ¥è‡ªç™¾ç§‘ï¼‰ã€‚è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ã€‚æˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªæœåŠ¡ã€è¿è¡Œä¸€ä¸ªå®ä¾‹ï¼Œå°±æ˜¯å¼€ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ï¼Œä¾‹å¦‚ Java é‡Œçš„ JVM æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼ŒNode.js é‡Œé€šè¿‡ node app.js å¼€å¯ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ï¼Œå¤šè¿›ç¨‹å°±æ˜¯è¿›ç¨‹çš„å¤åˆ¶ï¼ˆforkï¼‰ï¼Œfork å‡ºæ¥çš„<strong>æ¯ä¸ªè¿›ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„ç‹¬ç«‹ç©ºé—´åœ°å€ã€æ•°æ®æ ˆï¼Œä¸€ä¸ªè¿›ç¨‹æ— æ³•è®¿é—®å¦å¤–ä¸€ä¸ªè¿›ç¨‹é‡Œå®šä¹‰çš„å˜é‡ã€æ•°æ®ç»“æ„ï¼Œåªæœ‰å»ºç«‹äº† IPC é€šä¿¡ï¼Œè¿›ç¨‹ä¹‹é—´æ‰å¯æ•°æ®å…±äº«</strong>ã€‚</p><ul><li>Node.jså¼€å¯æœåŠ¡è¿›ç¨‹ä¾‹å­</li></ul><pre><code class="js">const http = require(&#39;http&#39;);const server = http.createServer();server.listen(3000,()=&gt;{    process.title=&#39;ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—æµ‹è¯•è¿›ç¨‹&#39;;    console.log(&#39;è¿›ç¨‹id&#39;,process.pid)})</code></pre><p>è¿è¡Œä¸Šé¢ä»£ç åï¼Œä»¥ä¸‹ä¸º Mac ç³»ç»Ÿè‡ªå¸¦çš„ç›‘æ§å·¥å…· â€œæ´»åŠ¨ç›‘è§†å™¨â€ æ‰€å±•ç¤ºçš„æ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšå¼€å¯çš„ Nodejs è¿›ç¨‹ 7663</p><p><img src="https://user-gold-cdn.xitu.io/2019/8/1/16c4dc0ca13fec40?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="è¿›ç¨‹1"></p><h2 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h2><p>çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œé¦–å…ˆæˆ‘ä»¬è¦æ¸…æ¥šçº¿ç¨‹æ˜¯éš¶å±äºè¿›ç¨‹çš„ï¼Œè¢«åŒ…å«äºè¿›ç¨‹ä¹‹ä¸­ã€‚<strong>ä¸€ä¸ªçº¿ç¨‹åªèƒ½éš¶å±äºä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯ä¸€ä¸ªè¿›ç¨‹æ˜¯å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹çš„</strong>ã€‚</p><h3 id="å•çº¿ç¨‹"><a href="#å•çº¿ç¨‹" class="headerlink" title="å•çº¿ç¨‹"></a>å•çº¿ç¨‹</h3><p><strong>å•çº¿ç¨‹å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹åªå¼€ä¸€ä¸ªçº¿ç¨‹</strong></p><p>Javascript å°±æ˜¯å±äºå•çº¿ç¨‹ï¼Œç¨‹åºé¡ºåºæ‰§è¡Œ(è¿™é‡Œæš‚ä¸”ä¸æJSå¼‚æ­¥)ï¼Œå¯ä»¥æƒ³è±¡ä¸€ä¸‹é˜Ÿåˆ—ï¼Œå‰é¢ä¸€ä¸ªæ‰§è¡Œå®Œä¹‹åï¼Œåé¢æ‰å¯ä»¥æ‰§è¡Œï¼Œå½“ä½ åœ¨ä½¿ç”¨å•çº¿ç¨‹è¯­è¨€ç¼–ç æ—¶åˆ‡å‹¿æœ‰è¿‡å¤šè€—æ—¶çš„åŒæ­¥æ“ä½œï¼Œå¦åˆ™çº¿ç¨‹ä¼šé€ æˆé˜»å¡ï¼Œå¯¼è‡´åç»­å“åº”æ— æ³•å¤„ç†ã€‚ä½ å¦‚æœé‡‡ç”¨ Javascript è¿›è¡Œç¼–ç æ—¶å€™ï¼Œè¯·å°½å¯èƒ½çš„åˆ©ç”¨Javascriptå¼‚æ­¥æ“ä½œçš„ç‰¹æ€§ã€‚</p><p><strong>ç»å…¸è®¡ç®—è€—æ—¶é€ æˆçº¿ç¨‹é˜»å¡çš„ä¾‹å­</strong></p><pre><code class="js">const http = require(&#39;http&#39;);const longComputation = () =&gt; {  let sum = 0;  for (let i = 0; i &lt; 1e10; i++) {    sum += i;  };  return sum;};const server = http.createServer();server.on(&#39;request&#39;, (req, res) =&gt; {  if (req.url === &#39;/compute&#39;) {    console.info(&#39;è®¡ç®—å¼€å§‹&#39;,new Date());    const sum = longComputation();    console.info(&#39;è®¡ç®—ç»“æŸ&#39;,new Date());    return res.end(`Sum is ${sum}`);  } else {    res.end(&#39;Ok&#39;)  }});server.listen(3000);//æ‰“å°ç»“æœ//è®¡ç®—å¼€å§‹ 2019-07-28T07:08:49.849Z//è®¡ç®—ç»“æŸ 2019-07-28T07:09:04.522Z</code></pre><p>æŸ¥çœ‹æ‰“å°ç»“æœï¼Œå½“æˆ‘ä»¬è°ƒç”¨<code>127.0.0.1:3000/compute</code><br>çš„æ—¶å€™ï¼Œå¦‚æœæƒ³è¦è°ƒç”¨å…¶ä»–çš„è·¯ç”±åœ°å€æ¯”å¦‚<code>127.0.0.1/</code>å¤§çº¦éœ€è¦15ç§’æ—¶é—´ï¼Œä¹Ÿå¯ä»¥è¯´ä¸€ä¸ªç”¨æˆ·è¯·æ±‚å®Œç¬¬ä¸€ä¸ªcomputeæ¥å£åéœ€è¦ç­‰å¾…15ç§’ï¼Œè¿™å¯¹äºç”¨æˆ·æ¥è¯´æ˜¯æå…¶ä¸å‹å¥½çš„ã€‚ä¸‹æ–‡æˆ‘ä¼šé€šè¿‡åˆ›å»ºå¤šè¿›ç¨‹çš„æ–¹å¼child_process.fork å’Œcluster æ¥è§£å†³è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br><a id="more"></a></p><blockquote><p>å•çº¿ç¨‹çš„ä¸€äº›è¯´æ˜</p><ul><li>Node.js è™½ç„¶æ˜¯å•çº¿ç¨‹æ¨¡å‹ï¼Œä½†æ˜¯å…¶åŸºäºäº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥éé˜»å¡æ¨¡å¼ï¼Œå¯ä»¥åº”ç”¨äºé«˜å¹¶å‘åœºæ™¯ï¼Œé¿å…äº†çº¿ç¨‹åˆ›å»ºã€çº¿ç¨‹ä¹‹é—´ä¸Šä¸‹æ–‡åˆ‡æ¢æ‰€äº§ç”Ÿçš„èµ„æºå¼€é”€ã€‚</li><li>å½“ä½ çš„é¡¹ç›®ä¸­éœ€è¦æœ‰å¤§é‡è®¡ç®—ï¼ŒCPU è€—æ—¶çš„æ“ä½œæ—¶å€™ï¼Œè¦æ³¨æ„è€ƒè™‘å¼€å¯å¤šè¿›ç¨‹æ¥å®Œæˆäº†ã€‚</li><li>Node.js å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé”™è¯¯ä¼šå¼•èµ·æ•´ä¸ªåº”ç”¨é€€å‡ºï¼Œåº”ç”¨çš„å¥å£®æ€§å€¼å¾—è€ƒéªŒï¼Œå°¤å…¶æ˜¯é”™è¯¯çš„å¼‚å¸¸æŠ›å‡ºï¼Œä»¥åŠè¿›ç¨‹å®ˆæŠ¤æ˜¯å¿…é¡»è¦åšçš„ã€‚</li><li>å•çº¿ç¨‹æ— æ³•åˆ©ç”¨å¤šæ ¸CPUï¼Œä½†æ˜¯åæ¥Node.js æä¾›çš„APIä»¥åŠä¸€äº›ç¬¬ä¸‰æ–¹å·¥å…·ç›¸åº”éƒ½å¾—åˆ°äº†è§£å†³ï¼Œæ–‡ç« åé¢éƒ½ä¼šè®²åˆ°ã€‚</li></ul></blockquote><h2 id="Node-js-ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹"><a href="#Node-js-ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹" class="headerlink" title="Node.js ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹"></a>Node.js ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹</h2><p>Node.js æ˜¯ Javascript åœ¨æœåŠ¡ç«¯çš„è¿è¡Œç¯å¢ƒï¼Œæ„å»ºåœ¨ chrome çš„ V8 å¼•æ“ä¹‹ä¸Šï¼ŒåŸºäºäº‹ä»¶é©±åŠ¨ã€éé˜»å¡I/Oæ¨¡å‹ï¼Œå……åˆ†åˆ©ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„å¼‚æ­¥ I/O è¿›è¡Œå¤šä»»åŠ¡çš„æ‰§è¡Œï¼Œé€‚åˆäº I/O å¯†é›†å‹çš„åº”ç”¨åœºæ™¯ï¼Œå› ä¸ºå¼‚æ­¥ï¼Œç¨‹åºæ— éœ€é˜»å¡ç­‰å¾…ç»“æœè¿”å›ï¼Œè€Œæ˜¯åŸºäºå›è°ƒé€šçŸ¥çš„æœºåˆ¶ï¼ŒåŸæœ¬åŒæ­¥æ¨¡å¼ç­‰å¾…çš„æ—¶é—´ï¼Œåˆ™å¯ä»¥ç”¨æ¥å¤„ç†å…¶å®ƒä»»åŠ¡</p><blockquote><p>ç§‘æ™®ï¼šåœ¨ Web æœåŠ¡å™¨æ–¹é¢ï¼Œè‘—åçš„ Nginx ä¹Ÿæ˜¯é‡‡ç”¨æ­¤æ¨¡å¼ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰ï¼Œé¿å…äº†å¤šçº¿ç¨‹çš„çº¿ç¨‹åˆ›å»ºã€çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼ŒNginx é‡‡ç”¨ C è¯­è¨€è¿›è¡Œç¼–å†™ï¼Œä¸»è¦ç”¨æ¥åšé«˜æ€§èƒ½çš„ Web æœåŠ¡å™¨ï¼Œä¸é€‚åˆåšä¸šåŠ¡ã€‚</p></blockquote><p>Webä¸šåŠ¡å¼€å‘ä¸­ï¼Œå¦‚æœä½ æœ‰é«˜å¹¶å‘åº”ç”¨åœºæ™¯é‚£ä¹ˆ Node.js ä¼šæ˜¯ä½ ä¸é”™çš„é€‰æ‹©ã€‚</p><p>åœ¨å•æ ¸ CPU ç³»ç»Ÿä¹‹ä¸Šæˆ‘ä»¬é‡‡ç”¨ å•è¿›ç¨‹ + å•çº¿ç¨‹ çš„æ¨¡å¼æ¥å¼€å‘ã€‚åœ¨å¤šæ ¸ CPU ç³»ç»Ÿä¹‹ä¸Šï¼Œå¯ä»¥é€šè¿‡ <code>child_process.fork</code> å¼€å¯å¤šä¸ªè¿›ç¨‹ï¼ˆNode.js åœ¨ v0.8 ç‰ˆæœ¬ä¹‹åæ–°å¢äº†Cluster æ¥å®ç°å¤šè¿›ç¨‹æ¶æ„ï¼‰ ï¼Œå³ å¤šè¿›ç¨‹ + å•çº¿ç¨‹ æ¨¡å¼ã€‚æ³¨æ„ï¼šå¼€å¯å¤šè¿›ç¨‹ä¸æ˜¯ä¸ºäº†è§£å†³é«˜å¹¶å‘ï¼Œä¸»è¦æ˜¯è§£å†³äº†å•è¿›ç¨‹æ¨¡å¼ä¸‹ Node.js CPU åˆ©ç”¨ç‡ä¸è¶³çš„æƒ…å†µï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸ CPU çš„æ€§èƒ½ã€‚</p><h3 id="Node-js-ä¸­çš„è¿›ç¨‹"><a href="#Node-js-ä¸­çš„è¿›ç¨‹" class="headerlink" title="Node.js ä¸­çš„è¿›ç¨‹"></a>Node.js ä¸­çš„è¿›ç¨‹</h3><h4 id="process-æ¨¡å—"><a href="#process-æ¨¡å—" class="headerlink" title="process æ¨¡å—"></a>process æ¨¡å—</h4><p>Node.js ä¸­çš„è¿›ç¨‹ Process æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæ— éœ€ require ç›´æ¥ä½¿ç”¨ï¼Œç»™æˆ‘ä»¬æä¾›äº†å½“å‰è¿›ç¨‹ä¸­çš„ç›¸å…³ä¿¡æ¯ã€‚å®˜æ–¹æ–‡æ¡£æä¾›äº†è¯¦ç»†çš„è¯´æ˜ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥äº²è‡ªå®è·µä¸‹ Process æ–‡æ¡£ã€‚</p><ul><li>process.envï¼šç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚é€šè¿‡  process.env.NODE_ENV è·å–ä¸åŒç¯å¢ƒé¡¹ç›®é…ç½®ä¿¡æ¯</li><li>process.nextTickï¼šè¿™ä¸ªåœ¨è°ˆåŠ Event Loop æ—¶ç»å¸¸ä¸ºä¼šæåˆ°</li><li>process.pidï¼šè·å–å½“å‰è¿›ç¨‹id</li><li>process.ppidï¼šå½“å‰è¿›ç¨‹å¯¹åº”çš„çˆ¶è¿›ç¨‹</li><li>process.cwd()ï¼šè·å–å½“å‰è¿›ç¨‹å·¥ä½œç›®å½•ï¼Œ</li><li>process.platformï¼šè·å–å½“å‰è¿›ç¨‹è¿è¡Œçš„æ“ä½œç³»ç»Ÿå¹³å°</li><li>process.uptime()ï¼šå½“å‰è¿›ç¨‹å·²è¿è¡Œæ—¶é—´ï¼Œä¾‹å¦‚ï¼špm2 å®ˆæŠ¤è¿›ç¨‹çš„ uptime å€¼</li><li>è¿›ç¨‹äº‹ä»¶ï¼šprocess.on(â€˜uncaughtExceptionâ€™, cb) æ•è·å¼‚å¸¸ä¿¡æ¯ã€process.on(â€˜exitâ€™, cbï¼‰è¿›ç¨‹æ¨å‡ºç›‘å¬</li><li>ä¸‰ä¸ªæ ‡å‡†æµï¼šprocess.stdout æ ‡å‡†è¾“å‡ºã€process.stdin æ ‡å‡†è¾“å…¥ã€process.stderr æ ‡å‡†é”™è¯¯è¾“å‡º</li><li>process.title æŒ‡å®šè¿›ç¨‹åç§°ï¼Œæœ‰çš„æ—¶å€™éœ€è¦ç»™è¿›ç¨‹æŒ‡å®šä¸€ä¸ªåç§°</li></ul><p>ä»¥ä¸Šä»…åˆ—ä¸¾äº†éƒ¨åˆ†å¸¸ç”¨åˆ°åŠŸèƒ½ç‚¹ï¼Œé™¤äº† Process ä¹‹å¤– Node.js è¿˜æä¾›äº† child_process æ¨¡å—ç”¨æ¥å¯¹å­è¿›ç¨‹è¿›è¡Œæ“ä½œï¼Œåœ¨ä¸‹æ–‡ Nodejsè¿›ç¨‹åˆ›å»ºä¼šç»§ç»­è®²è¿°ã€‚</p><h3 id="Node-js-è¿›ç¨‹åˆ›å»º"><a href="#Node-js-è¿›ç¨‹åˆ›å»º" class="headerlink" title="Node.js è¿›ç¨‹åˆ›å»º"></a>Node.js è¿›ç¨‹åˆ›å»º</h3><p>è¿›ç¨‹åˆ›å»ºæœ‰å¤šç§æ–¹å¼ï¼Œæœ¬ç¯‡æ–‡ç« ä»¥child_processæ¨¡å—å’Œclusteræ¨¡å—è¿›è¡Œè®²è§£ã€‚</p><h4 id="child-processæ¨¡å—"><a href="#child-processæ¨¡å—" class="headerlink" title="child_processæ¨¡å—"></a>child_processæ¨¡å—</h4><p>child_process æ˜¯ Node.js çš„å†…ç½®æ¨¡å—ï¼Œå®˜ç½‘åœ°å€ï¼š</p><blockquote><p>child_process å®˜ç½‘åœ°å€ï¼š<a href="https://link.juejin.im/?target=http%3A%2F%2Fnodejs.cn%2Fapi%2Fchild_process.html%23child_process_child_process">nodejs.cn/api/child_pâ€¦</a></p></blockquote><p>å‡ ä¸ªå¸¸ç”¨å‡½æ•°ï¼š å››ç§æ–¹å¼</p><ul><li><code>child_process.spawn()</code>ï¼šé€‚ç”¨äºè¿”å›å¤§é‡æ•°æ®ï¼Œä¾‹å¦‚å›¾åƒå¤„ç†ï¼ŒäºŒè¿›åˆ¶æ•°æ®å¤„ç†ã€‚</li><li><code>child_process.exec()</code>ï¼šé€‚ç”¨äºå°é‡æ•°æ®ï¼ŒmaxBuffer é»˜è®¤å€¼ä¸º 200 * 1024 è¶…å‡ºè¿™ä¸ªé»˜è®¤å€¼å°†ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œæ•°æ®é‡è¿‡å¤§å¯é‡‡ç”¨ spawnã€‚</li><li><code>child_process.execFile()</code>ï¼šç±»ä¼¼ child_process.exec()ï¼ŒåŒºåˆ«æ˜¯ä¸èƒ½é€šè¿‡ shell æ¥æ‰§è¡Œï¼Œä¸æ”¯æŒåƒ I/O é‡å®šå‘å’Œæ–‡ä»¶æŸ¥æ‰¾è¿™æ ·çš„è¡Œä¸º</li><li><code>child_process.fork()</code>ï¼š è¡ç”Ÿæ–°çš„è¿›ç¨‹ï¼Œè¿›ç¨‹ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ V8 å®ä¾‹ã€å†…å­˜ï¼Œç³»ç»Ÿèµ„æºæ˜¯æœ‰é™çš„ï¼Œä¸å»ºè®®è¡ç”Ÿå¤ªå¤šçš„å­è¿›ç¨‹å‡ºæ¥ï¼Œé€šé•¿æ ¹æ®ç³»ç»Ÿ<strong> CPU æ ¸å¿ƒæ•°</strong>è®¾ç½®ã€‚</li></ul><blockquote><p>CPU æ ¸å¿ƒæ•°è¿™é‡Œç‰¹åˆ«è¯´æ˜ä¸‹ï¼Œfork ç¡®å®å¯ä»¥å¼€å¯å¤šä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯å¹¶ä¸å»ºè®®è¡ç”Ÿå‡ºæ¥å¤ªå¤šçš„è¿›ç¨‹ï¼Œcpuæ ¸å¿ƒæ•°çš„è·å–æ–¹å¼<code>const cpus = require(&#39;os&#39;).cpus()</code>;,è¿™é‡Œ cpus è¿”å›ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼ŒåŒ…å«æ‰€å®‰è£…çš„æ¯ä¸ª CPU/å†…æ ¸çš„ä¿¡æ¯ï¼ŒäºŒè€…æ€»å’Œçš„æ•°ç»„å“¦ã€‚å‡è®¾ä¸»æœºè£…æœ‰ä¸¤ä¸ªcpuï¼Œæ¯ä¸ªcpuæœ‰4ä¸ªæ ¸ï¼Œé‚£ä¹ˆæ€»æ ¸æ•°å°±æ˜¯8ã€‚</p></blockquote><p><em>forkå¼€å¯å­è¿›ç¨‹ Demo</em></p><p>forkå¼€å¯å­è¿›ç¨‹è§£å†³æ–‡ç« èµ·åˆçš„è®¡ç®—è€—æ—¶é€ æˆçº¿ç¨‹é˜»å¡ã€‚ åœ¨è¿›è¡Œ compute è®¡ç®—æ—¶åˆ›å»ºå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹è®¡ç®—å®Œæˆé€šè¿‡ send æ–¹æ³•å°†ç»“æœå‘é€ç»™ä¸»è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹é€šè¿‡ message ç›‘å¬åˆ°ä¿¡æ¯åå¤„ç†å¹¶é€€å‡ºã€‚</p><blockquote><p>fork_app.js</p></blockquote><pre><code class="js">const http = require(&#39;http&#39;);const fork = require(&#39;child_process&#39;).fork;const server = http.createServer((req, res) =&gt; {    if(req.url == &#39;/compute&#39;){        const compute = fork(&#39;./fork_compute.js&#39;);        compute.send(&#39;å¼€å¯ä¸€ä¸ªæ–°çš„å­è¿›ç¨‹&#39;);        // å½“ä¸€ä¸ªå­è¿›ç¨‹ä½¿ç”¨ process.send() å‘é€æ¶ˆæ¯æ—¶ä¼šè§¦å‘ &#39;message&#39; äº‹ä»¶        compute.on(&#39;message&#39;, sum =&gt; {            res.end(`Sum is ${sum}`);            compute.kill();        });        // å­è¿›ç¨‹ç›‘å¬åˆ°ä¸€äº›é”™è¯¯æ¶ˆæ¯é€€å‡º        compute.on(&#39;close&#39;, (code, signal) =&gt; {            console.log(`æ”¶åˆ°closeäº‹ä»¶ï¼Œå­è¿›ç¨‹æ”¶åˆ°ä¿¡å· ${signal} è€Œç»ˆæ­¢ï¼Œé€€å‡ºç  ${code}`);            compute.kill();        })    }else{        res.end(`ok`);    }});server.listen(3000, 127.0.0.1, () =&gt; {    console.log(`server started at http://${127.0.0.1}:${3000}`);});</code></pre><blockquote><p>fork_compute.js</p></blockquote><p>é’ˆå¯¹æ–‡åˆéœ€è¦è¿›è¡Œè®¡ç®—çš„çš„ä¾‹å­æˆ‘ä»¬åˆ›å»ºå­è¿›ç¨‹æ‹†åˆ†å‡ºæ¥å•ç‹¬è¿›è¡Œè¿ç®—ã€‚</p><pre><code class="js">const computation = () =&gt; {    let sum = 0;    console.info(&#39;è®¡ç®—å¼€å§‹&#39;);    console.time(&#39;è®¡ç®—è€—æ—¶&#39;);    for (let i = 0; i &lt; 1e10; i++) {        sum += i    };    console.info(&#39;è®¡ç®—ç»“æŸ&#39;);    console.timeEnd(&#39;è®¡ç®—è€—æ—¶&#39;);    return sum;};process.on(&#39;message&#39;, msg =&gt; {    console.log(msg, &#39;process.pid&#39;, process.pid); // å­è¿›ç¨‹id    const sum = computation();    // å¦‚æœNode.jsè¿›ç¨‹æ˜¯é€šè¿‡è¿›ç¨‹é—´é€šä¿¡äº§ç”Ÿçš„ï¼Œé‚£ä¹ˆï¼Œprocess.send()æ–¹æ³•å¯ä»¥ç”¨æ¥ç»™çˆ¶è¿›ç¨‹å‘é€æ¶ˆæ¯    process.send(sum);})</code></pre><h4 id="clusteræ¨¡å—"><a href="#clusteræ¨¡å—" class="headerlink" title="clusteræ¨¡å—"></a>clusteræ¨¡å—</h4><p>cluster å¼€å¯å­è¿›ç¨‹Demo</p><pre><code class="js">const http = require(&#39;http&#39;);const numCPUs = require(&#39;os&#39;).cpus().length;const cluster = require(&#39;cluster&#39;);if(cluster.isMaster){    console.log(&#39;Master proces id is&#39;,process.pid);    // fork workers    for(let i= 0;i&lt;numCPUs;i++){        cluster.fork();    }    cluster.on(&#39;exit&#39;,function(worker,code,signal){        console.log(&#39;worker process died,id&#39;,worker.process.pid)    })}else{    // Workerå¯ä»¥å…±äº«åŒä¸€ä¸ªTCPè¿æ¥    // è¿™é‡Œæ˜¯ä¸€ä¸ªhttpæœåŠ¡å™¨    http.createServer(function(req,res){        res.writeHead(200);        res.end(&#39;hello word&#39;);    }).listen(8000);}</code></pre><p>clusteråŸç†åˆ†æ</p><p><img src="https://user-gold-cdn.xitu.io/2019/8/3/16c5658b2e97e9b2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="clusteråŸç†åˆ†æ"></p><p>clusteræ¨¡å—è°ƒç”¨forkæ–¹æ³•æ¥åˆ›å»ºå­è¿›ç¨‹ï¼Œè¯¥æ–¹æ³•ä¸child_processä¸­çš„forkæ˜¯åŒä¸€ä¸ªæ–¹æ³•ã€‚</p><p>clusteræ¨¡å—é‡‡ç”¨çš„æ˜¯ç»å…¸çš„ä¸»ä»æ¨¡å‹ï¼ŒClusterä¼šåˆ›å»ºä¸€ä¸ªmasterï¼Œç„¶åæ ¹æ®ä½ æŒ‡å®šçš„æ•°é‡å¤åˆ¶å‡ºå¤šä¸ªå­è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨cluster.isMasterå±æ€§åˆ¤æ–­å½“å‰è¿›ç¨‹æ˜¯masterè¿˜æ˜¯worker(å·¥ä½œè¿›ç¨‹)ã€‚ç”±masterè¿›ç¨‹æ¥ç®¡ç†æ‰€æœ‰çš„å­è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹ä¸è´Ÿè´£å…·ä½“çš„ä»»åŠ¡å¤„ç†ï¼Œä¸»è¦å·¥ä½œæ˜¯è´Ÿè´£è°ƒåº¦å’Œç®¡ç†ã€‚</p><p>clusteræ¨¡å—ä½¿ç”¨å†…ç½®çš„è´Ÿè½½å‡è¡¡æ¥æ›´å¥½åœ°å¤„ç†çº¿ç¨‹ä¹‹é—´çš„å‹åŠ›ï¼Œè¯¥è´Ÿè½½å‡è¡¡ä½¿ç”¨äº†Round-robinç®—æ³•ï¼ˆä¹Ÿè¢«ç§°ä¹‹ä¸ºå¾ªç¯ç®—æ³•ï¼‰ã€‚å½“ä½¿ç”¨Round-robinè°ƒåº¦ç­–ç•¥æ—¶ï¼Œmaster accepts()æ‰€æœ‰ä¼ å…¥çš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†ç›¸åº”çš„TCPè¯·æ±‚å¤„ç†å‘é€ç»™é€‰ä¸­çš„å·¥ä½œè¿›ç¨‹ï¼ˆè¯¥æ–¹å¼ä»ç„¶é€šè¿‡IPCæ¥è¿›è¡Œé€šä¿¡ï¼‰ã€‚</p><p>å¼€å¯å¤šè¿›ç¨‹æ—¶å€™ç«¯å£ç–‘é—®è®²è§£ï¼šå¦‚æœå¤šä¸ªNodeè¿›ç¨‹ç›‘å¬åŒä¸€ä¸ªç«¯å£æ—¶ä¼šå‡ºç° Error:listen EADDRIUNSçš„é”™è¯¯ï¼Œè€Œclusteræ¨¡å—ä¸ºä»€ä¹ˆå¯ä»¥è®©å¤šä¸ªå­è¿›ç¨‹ç›‘å¬åŒä¸€ä¸ªç«¯å£å‘¢?åŸå› æ˜¯masterè¿›ç¨‹å†…éƒ¨å¯åŠ¨äº†ä¸€ä¸ªTCPæœåŠ¡å™¨ï¼Œè€ŒçœŸæ­£ç›‘å¬ç«¯å£çš„åªæœ‰è¿™ä¸ªæœåŠ¡å™¨ï¼Œå½“æ¥è‡ªå‰ç«¯çš„è¯·æ±‚è§¦å‘æœåŠ¡å™¨çš„connectionäº‹ä»¶åï¼Œmasterä¼šå°†å¯¹åº”çš„socketå…·æŸ„å‘é€ç»™å­è¿›ç¨‹ã€‚</p><h4 id="child-process-æ¨¡å—ä¸cluster-æ¨¡å—æ€»ç»“"><a href="#child-process-æ¨¡å—ä¸cluster-æ¨¡å—æ€»ç»“" class="headerlink" title="child_process æ¨¡å—ä¸cluster æ¨¡å—æ€»ç»“"></a>child_process æ¨¡å—ä¸cluster æ¨¡å—æ€»ç»“</h4><p>æ— è®ºæ˜¯ child_process æ¨¡å—è¿˜æ˜¯ cluster æ¨¡å—ï¼Œä¸ºäº†è§£å†³ Node.js å®ä¾‹å•çº¿ç¨‹è¿è¡Œï¼Œæ— æ³•åˆ©ç”¨å¤šæ ¸ CPU çš„é—®é¢˜è€Œå‡ºç°çš„ã€‚æ ¸å¿ƒå°±æ˜¯<strong>çˆ¶è¿›ç¨‹ï¼ˆå³ master è¿›ç¨‹ï¼‰è´Ÿè´£ç›‘å¬ç«¯å£ï¼Œæ¥æ”¶åˆ°æ–°çš„è¯·æ±‚åå°†å…¶åˆ†å‘ç»™ä¸‹é¢çš„ worker è¿›ç¨‹</strong>ã€‚</p><p>clusteræ¨¡å—çš„ä¸€ä¸ªå¼Šç«¯ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2019/8/3/16c565aaeb065b4a?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="clusterå¼Šç«¯"></p><p>clusterå†…éƒ¨éšæ—¶çš„æ„å»ºTCPæœåŠ¡å™¨çš„æ–¹å¼æ¥è¯´å¯¹ä½¿ç”¨è€…ç¡®å®ç®€å•å’Œé€æ˜äº†å¾ˆå¤šï¼Œä½†æ˜¯è¿™ç§æ–¹å¼æ— æ³•åƒä½¿ç”¨child_processé‚£æ ·çµæ´»ï¼Œå› ä¸ºä¸€ç›´ä¸»è¿›ç¨‹åªèƒ½ç®¡ç†ä¸€ç»„ç›¸åŒçš„å·¥ä½œè¿›ç¨‹ï¼Œè€Œè‡ªè¡Œé€šè¿‡child_processæ¥åˆ›å»ºå·¥ä½œè¿›ç¨‹ï¼Œä¸€ä¸ªä¸»è¿›ç¨‹å¯ä»¥æ§åˆ¶å¤šç»„è¿›ç¨‹ã€‚åŸå› æ˜¯child_processæ“ä½œå­è¿›ç¨‹æ—¶ï¼Œå¯ä»¥éšå¼çš„åˆ›å»ºå¤šä¸ªTCPæœåŠ¡å™¨ï¼Œå¯¹æ¯”ä¸Šé¢çš„ä¸¤å¹…å›¾åº”è¯¥èƒ½ç†è§£æˆ‘è¯´çš„å†…å®¹ã€‚</p><h4 id="Node-jsè¿›ç¨‹é€šä¿¡åŸç†"><a href="#Node-jsè¿›ç¨‹é€šä¿¡åŸç†" class="headerlink" title="Node.jsè¿›ç¨‹é€šä¿¡åŸç†"></a>Node.jsè¿›ç¨‹é€šä¿¡åŸç†</h4><p>å‰é¢è®²è§£çš„æ— è®ºæ˜¯child_processæ¨¡å—ï¼Œè¿˜æ˜¯clusteræ¨¡å—ï¼Œéƒ½éœ€è¦ä¸»è¿›ç¨‹å’Œå·¥ä½œè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚é€šè¿‡fork()æˆ–è€…å…¶ä»–APIï¼Œåˆ›å»ºäº†å­è¿›ç¨‹ä¹‹åï¼Œä¸ºäº†å®ç°çˆ¶å­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œçˆ¶å­è¿›ç¨‹ä¹‹é—´æ‰èƒ½é€šè¿‡messageå’Œsend()ä¼ é€’ä¿¡æ¯ã€‚</p><p>IPCè¿™ä¸ªè¯æˆ‘æƒ³å¤§å®¶å¹¶ä¸é™Œç”Ÿï¼Œä¸ç®¡é‚£ä¸€å¼ å¼€å‘è¯­è¨€åªè¦æåˆ°è¿›ç¨‹é€šä¿¡ï¼Œéƒ½ä¼šæåˆ°å®ƒã€‚IPCçš„å…¨ç§°æ˜¯Inter-Process Communication,å³è¿›ç¨‹é—´é€šä¿¡ã€‚å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†è®©ä¸åŒçš„è¿›ç¨‹èƒ½å¤Ÿäº’ç›¸è®¿é—®èµ„æºå¹¶è¿›è¡Œåè°ƒå·¥ä½œã€‚å®ç°è¿›ç¨‹é—´é€šä¿¡çš„æŠ€æœ¯æœ‰å¾ˆå¤šï¼Œå¦‚å‘½åç®¡é“ï¼ŒåŒ¿åç®¡é“ï¼Œsocketï¼Œä¿¡å·é‡ï¼Œå…±äº«å†…å­˜ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰ã€‚Nodeä¸­å®ç°IPCé€šé“æ˜¯ä¾èµ–äºlibuvã€‚windowsä¸‹ç”±å‘½åç®¡é“(name pipe)å®ç°ï¼Œ*nixç³»ç»Ÿåˆ™é‡‡ç”¨Unix Domain Socketå®ç°ã€‚è¡¨ç°åœ¨åº”ç”¨å±‚ä¸Šçš„è¿›ç¨‹é—´é€šä¿¡åªæœ‰ç®€å•çš„messageäº‹ä»¶å’Œsend()æ–¹æ³•ï¼Œæ¥å£ååˆ†ç®€æ´å’Œæ¶ˆæ¯åŒ–ã€‚</p><p>IPCåˆ›å»ºå’Œå®ç°ç¤ºæ„å›¾</p><p><img src="https://user-gold-cdn.xitu.io/2019/8/4/16c5b379ad12199e?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="IPC"></p><p>IPCé€šä¿¡ç®¡é“æ˜¯å¦‚ä½•åˆ›å»ºçš„</p><p><img src="https://user-gold-cdn.xitu.io/2019/8/4/16c5b3812e3bb7d9?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="IPCé€šä¿¡"></p><p>çˆ¶è¿›ç¨‹åœ¨å®é™…åˆ›å»ºå­è¿›ç¨‹ä¹‹å‰ï¼Œä¼šåˆ›å»ºIPCé€šé“å¹¶ç›‘å¬å®ƒï¼Œç„¶åæ‰çœŸæ­£çš„åˆ›å»ºå‡ºå­è¿›ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿä¼šé€šè¿‡ç¯å¢ƒå˜é‡ï¼ˆNODE_CHANNEL_FDï¼‰å‘Šè¯‰å­è¿›ç¨‹è¿™ä¸ªIPCé€šé“çš„æ–‡ä»¶æè¿°ç¬¦ã€‚å­è¿›ç¨‹åœ¨å¯åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®æ–‡ä»¶æè¿°ç¬¦å»è¿æ¥è¿™ä¸ªå·²å­˜åœ¨çš„IPCé€šé“ï¼Œä»è€Œå®Œæˆçˆ¶å­è¿›ç¨‹ä¹‹é—´çš„è¿æ¥</p><h4 id="Node-jså¥æŸ„ä¼ é€’"><a href="#Node-jså¥æŸ„ä¼ é€’" class="headerlink" title="Node.jså¥æŸ„ä¼ é€’"></a>Node.jså¥æŸ„ä¼ é€’</h4><p>è®²å¥æŸ„ä¹‹å‰ï¼Œå…ˆæƒ³ä¸€ä¸ªé—®é¢˜ï¼Œsendå¥æŸ„å‘é€çš„æ—¶å€™ï¼ŒçœŸçš„æ˜¯å°†æœåŠ¡å™¨å¯¹è±¡å‘é€ç»™äº†å­è¿›ç¨‹ï¼Ÿ</p><h4 id="å­è¿›ç¨‹å¯¹è±¡send-æ–¹æ³•å¯ä»¥å‘é€çš„å¥æŸ„ç±»å‹"><a href="#å­è¿›ç¨‹å¯¹è±¡send-æ–¹æ³•å¯ä»¥å‘é€çš„å¥æŸ„ç±»å‹" class="headerlink" title="å­è¿›ç¨‹å¯¹è±¡send()æ–¹æ³•å¯ä»¥å‘é€çš„å¥æŸ„ç±»å‹"></a>å­è¿›ç¨‹å¯¹è±¡send()æ–¹æ³•å¯ä»¥å‘é€çš„å¥æŸ„ç±»å‹</h4><p>net.Socket TCPå¥—æ¥å­—<br>net.Server TCPæœåŠ¡å™¨ï¼Œä»»æ„å»ºç«‹åœ¨TCPæœåŠ¡ä¸Šçš„åº”ç”¨å±‚æœåŠ¡éƒ½å¯ä»¥äº«å—å®ƒå¸¦æ¥çš„å¥½å¤„<br>net.Native C++å±‚é¢çš„TCPå¥—æ¥å­—æˆ–IPCç®¡é“<br>dgram.Socket UDPå¥—æ¥å­—<br>dgram.Native C++å±‚é¢çš„UDPå¥—æ¥å­—</p><h4 id="sendå¥æŸ„å‘é€åŸç†åˆ†æ"><a href="#sendå¥æŸ„å‘é€åŸç†åˆ†æ" class="headerlink" title="sendå¥æŸ„å‘é€åŸç†åˆ†æ"></a>sendå¥æŸ„å‘é€åŸç†åˆ†æ</h4><p>ç»“åˆå¥æŸ„çš„å‘é€ä¸è¿˜åŸç¤ºæ„å›¾æ›´å®¹æ˜“ç†è§£ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2019/8/4/16c5b52b15d87bbe?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="sendå¥"></p><p>send()æ–¹æ³•åœ¨å°†æ¶ˆæ¯å‘é€åˆ°IPCç®¡é“å‰ï¼Œå®é™…å°†æ¶ˆæ¯ç»„è£…æˆäº†ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªå‚æ•°æ˜¯hadlerï¼Œå¦ä¸€ä¸ªæ˜¯messageã€‚messageå‚æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="js">{    cmd:&#39;NODE_HANDLE&#39;,    type:&#39;net.Server&#39;,    msg:message}</code></pre><p>å‘é€åˆ°IPCç®¡é“ä¸­çš„å®é™…ä¸Šæ˜¯æˆ‘ä»¬è¦å‘é€çš„å¥æŸ„æ–‡ä»¶æè¿°ç¬¦ã€‚è¿™ä¸ªmessageå¯¹è±¡åœ¨å†™å…¥åˆ°IPCç®¡é“æ—¶ï¼Œä¹Ÿä¼šé€šè¿‡<code>JSON.stringfy()</code>è¿›è¡Œåºåˆ—åŒ–ã€‚æ‰€ä»¥æœ€ç»ˆå‘é€åˆ°IPCé€šé“ä¸­çš„ä¿¡æ¯éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œsend()æ–¹æ³•èƒ½å‘é€æ¶ˆæ¯å’Œå¥æŸ„å¹¶ä¸æ„å‘³ç€å®ƒèƒ½å‘é€ä»»ä½•å¯¹è±¡ã€‚</p><p>è¿æ¥äº†IPCé€šé“çš„å­çº¿ç¨‹å¯ä»¥è¯»å–çˆ¶è¿›ç¨‹å‘æ¥çš„æ¶ˆæ¯ï¼Œå°†å­—ç¬¦ä¸²é€šè¿‡<code>JSON.parse()</code>è§£æè¿˜åŸä¸ºå¯¹è±¡åï¼Œæ‰è§¦å‘messageäº‹ä»¶å°†æ¶ˆæ¯ä¼ é€’ç»™åº”ç”¨å±‚ä½¿ç”¨ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯å¯¹è±¡è¿˜è¦è¢«è¿›è¡Œè¿‡æ»¤å¤„ç†ï¼Œmessage.cmdçš„å€¼å¦‚æœä»¥NODE_ä¸ºå‰ç¼€ï¼Œå®ƒå°†å“åº”ä¸€ä¸ªå†…éƒ¨äº‹ä»¶internalMessageï¼Œå¦‚æœmessage.cmdå€¼ä¸ºNODE_HANDLE,å®ƒå°†å–å‡º<code>message.type</code>å€¼å’Œå¾—åˆ°çš„æ–‡ä»¶æè¿°ç¬¦ä¸€èµ·è¿˜åŸå‡ºä¸€ä¸ªå¯¹åº”çš„å¯¹è±¡ã€‚</p><p>ä»¥å‘é€çš„TCPæœåŠ¡å™¨å¥æŸ„ä¸ºä¾‹ï¼Œå­è¿›ç¨‹æ”¶åˆ°æ¶ˆæ¯åçš„è¿˜åŸè¿‡ç¨‹ä»£ç å¦‚ä¸‹:</p><pre><code class="js">function(message,handle,emit){    var self = this;    var server = new net.Server();    server.listen(handler,function(){      emit(server);    });}</code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¤šè¿›ç¨‹ vs å¤šçº¿ç¨‹</p><p>å±æ€§<br>å¤šè¿›ç¨‹<br>å¤šçº¿ç¨‹<br>æ¯”è¾ƒ</p><p>æ•°æ®<br>æ•°æ®å…±äº«å¤æ‚ï¼Œéœ€è¦ç”¨IPCï¼›æ•°æ®æ˜¯åˆ†å¼€çš„ï¼ŒåŒæ­¥ç®€å•<br>å› ä¸ºå…±äº«è¿›ç¨‹æ•°æ®ï¼Œæ•°æ®å…±äº«ç®€å•ï¼ŒåŒæ­¥å¤æ‚<br>å„æœ‰åƒç§‹</p><p>CPUã€å†…å­˜<br>å ç”¨å†…å­˜å¤šï¼Œåˆ‡æ¢å¤æ‚ï¼ŒCPUåˆ©ç”¨ç‡ä½<br>å ç”¨å†…å­˜å°‘ï¼Œåˆ‡æ¢ç®€å•ï¼ŒCPUåˆ©ç”¨ç‡é«˜<br>å¤šçº¿ç¨‹æ›´å¥½</p><p>é”€æ¯ã€åˆ‡æ¢<br>åˆ›å»ºé”€æ¯ã€åˆ‡æ¢å¤æ‚ï¼Œé€Ÿåº¦æ…¢<br>åˆ›å»ºé”€æ¯ã€åˆ‡æ¢ç®€å•ï¼Œé€Ÿåº¦å¾ˆå¿«<br>å¤šçº¿ç¨‹æ›´å¥½</p><p>coding<br>ç¼–ç ç®€å•ã€è°ƒè¯•æ–¹ä¾¿<br>ç¼–ç ã€è°ƒè¯•å¤æ‚<br>ç¼–ç ã€è°ƒè¯•å¤æ‚</p><p>å¯é æ€§<br>è¿›ç¨‹ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¼šç›¸äº’å½±å“<br>çº¿ç¨‹åŒå‘¼å¸å…±å‘½è¿<br>å¤šè¿›ç¨‹æ›´å¥½</p><p>åˆ†å¸ƒå¼<br>å¯ç”¨äºå¤šæœºå¤šæ ¸åˆ†å¸ƒå¼ï¼Œæ˜“äºæ‰©å±•<br>åªèƒ½ç”¨äºå¤šæ ¸åˆ†å¸ƒå¼<br>å¤šè¿›ç¨‹æ›´å¥½</p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨17é“é¢˜ä¸­ç†è§£javascriptçš„ç±»å‹è½¬æ¢</title>
      <link href="/2019/08/08/Js/%E5%9C%A817%E9%81%93%E9%A2%98%E4%B8%AD%E7%90%86%E8%A7%A3javascript%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/"/>
      <url>/2019/08/08/Js/%E5%9C%A817%E9%81%93%E9%A2%98%E4%B8%AD%E7%90%86%E8%A7%A3javascript%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5d4999fff265da038f47f5c7" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><p>ç±»å‹è½¬æ¢æ˜¯å°†å€¼ä»ä¸€ç§ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹çš„è¿‡ç¨‹ï¼ˆæ¯”å¦‚å­—ç¬¦ä¸²è½¬æ•°å­—ï¼Œå¯¹è±¡è½¬å¸ƒå°”å€¼ç­‰ï¼‰ã€‚ä»»ä½•ç±»å‹ä¸è®ºæ˜¯åŸå§‹ç±»å‹è¿˜æ˜¯å¯¹è±¡ç±»å‹éƒ½å¯ä»¥è¿›è¡Œç±»å‹è½¬æ¢ï¼ŒJavaScript çš„åŸå§‹ç±»å‹æœ‰ï¼š<code>number, string, boolean, null, undefined, Symbol</code>ã€‚</p><pre><code class="js">true + false12 / &quot;6&quot;&quot;number&quot; + 15 + 315 + 3 + &quot;number&quot;[1] &gt; null&quot;foo&quot; + + &quot;bar&quot;&quot;true&quot; == truefalse == &quot;false&quot;null == &quot;&quot;!!&quot;false&quot; == !!&quot;true&quot;[&quot;x&quot;] == &quot;x&quot;[] + null + 1[1,2,3] == [1,2,3]{} + [] + {} + [1]! + [] + [] + ![]new Date(0) - 0new Date(0) + 0</code></pre><p>ç±»ä¼¼äºä¸Šé¢çš„è¿™äº›é—®é¢˜å¤§æ¦‚ç‡ä¹Ÿä¼šåœ¨ JS é¢è¯•ä¸­è¢«é—®åˆ°, æ‰€ä»¥ç»§ç»­å¾€ä¸‹è¯»ã€‚</p><h2 id="éšå¼è½¬æ¢VSæ˜¾ç¤ºè½¬æ¢"><a href="#éšå¼è½¬æ¢VSæ˜¾ç¤ºè½¬æ¢" class="headerlink" title="éšå¼è½¬æ¢VSæ˜¾ç¤ºè½¬æ¢"></a>éšå¼è½¬æ¢VSæ˜¾ç¤ºè½¬æ¢</h2><p>ç±»å‹è½¬æ¢å¯ä»¥åˆ†ä¸º<strong>éšå¼ç±»å‹è½¬æ¢</strong>å’Œ<strong>æ˜¾å¼ç±»å‹è½¬æ¢</strong>ã€‚</p><p>å½“å¼€å‘äººå‘˜é€šè¿‡ç¼–å†™é€‚å½“çš„ä»£ç (å¦‚Number(value))ç”¨äºåœ¨ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢æ—¶ï¼Œå°±ç§°ä¸º<code>æ˜¾å¼ç±»å‹å¼ºåˆ¶è½¬æ¢(æˆ–å¼ºåˆ¶ç±»å‹è½¬æ¢)</code>ã€‚</p><p>ç„¶è€Œ JavaScript æ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œåœ¨æŸäº›æ“ä½œä¸‹ï¼Œå€¼å¯ä»¥åœ¨ä¸¤ç§ç±»å‹ä¹‹é—´è‡ªåŠ¨çš„è½¬æ¢ï¼Œè¿™å«åš<code>éšå¼ç±»å‹è½¬æ¢</code>ã€‚åœ¨å¯¹ä¸åŒç±»å‹çš„å€¼ä½¿ç”¨è¿ç®—ç¬¦æ—¶é€šå¸¸ä¼šå‘ç”Ÿéšå¼ç±»å‹è½¬æ¢ã€‚æ¯”å¦‚ 1 == null, 2 / â€œ5â€, null + new Date()ã€‚å½“å€¼è¢« if è¯­å¥åŒ…è£¹æ—¶ä¹Ÿæœ‰å¯èƒ½å‘ç”Ÿï¼Œæ¯”å¦‚ if(value) {} ä¼šå°† value è½¬æ¢ä¸º booleanç±»å‹ã€‚</p><p><code>ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦</code>ï¼ˆ===ï¼‰ä¸ä¼šè§¦å‘ç±»å‹éšå¼è½¬æ¢ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ç”¨æ¥æ¯”è¾ƒå€¼å’Œç±»å‹æ˜¯å¦éƒ½ç›¸ç­‰ã€‚</p><p><strong>éšå¼ç±»å‹è½¬æ¢æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œä½¿ç”¨å®ƒè™½ç„¶å¯ä»¥å†™æ›´å°‘çš„ä»£ç ä½†æœ‰æ—¶å€™ä¼šå‡ºç°éš¾ä»¥è¢«å‘ç°çš„bug</strong>ã€‚</p><h2 id="ä¸‰ç§ç±»å‹è½¬æ¢"><a href="#ä¸‰ç§ç±»å‹è½¬æ¢" class="headerlink" title="ä¸‰ç§ç±»å‹è½¬æ¢"></a>ä¸‰ç§ç±»å‹è½¬æ¢</h2><p>æˆ‘ä»¬éœ€è¦çŸ¥é“çš„ç¬¬ä¸€ä¸ªè§„åˆ™æ˜¯ï¼š<strong>åœ¨ JS ä¸­åªæœ‰ 3 ç§ç±»å‹çš„è½¬æ¢</strong></p><ul><li>to string</li><li>to boolean</li><li>to number</li></ul><p>ç¬¬äºŒï¼Œ<strong>ç±»å‹è½¬æ¢çš„é€»è¾‘åœ¨åŸå§‹ç±»å‹å’Œå¯¹è±¡ç±»å‹ä¸Šæ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯ä»–ä»¬éƒ½åªä¼šè½¬æ¢æˆä¸Šé¢ 3 ç§ç±»å‹ä¹‹ä¸€</strong>ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆåˆ†æä¸€ä¸‹åŸå§‹ç±»å‹è½¬æ¢ã€‚</p><h2 id="String-ç±»å‹è½¬æ¢"><a href="#String-ç±»å‹è½¬æ¢" class="headerlink" title="String ç±»å‹è½¬æ¢"></a>String ç±»å‹è½¬æ¢</h2><p><code>String()</code> æ–¹æ³•å¯ä»¥ç”¨æ¥æ˜¾å¼å°†å€¼è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œéšå¼è½¬æ¢é€šå¸¸åœ¨æœ‰ <code>+</code> è¿ç®—ç¬¦å¹¶ä¸”æœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯ <code>string</code> ç±»å‹æ—¶è¢«è§¦å‘ï¼Œå¦‚ï¼š</p><pre><code class="js">String(123) // æ˜¾å¼ç±»å‹è½¬æ¢123 + &#39;&#39; // éšå¼ç±»å‹è½¬æ¢</code></pre><p>æ‰€æœ‰åŸå§‹ç±»å‹è½¬ String ç±»å‹</p><pre><code class="js">String(123)  // &#39;123&#39;String(-12.3)  // &#39;-12.3&#39;String(null)  // &#39;null&#39;String(undefined)  // &#39;undefined&#39;String(true)  // &#39;true&#39;</code></pre><p>Symbol ç±»å‹è½¬ String ç±»å‹æ˜¯æ¯”è¾ƒä¸¥æ ¼çš„ï¼Œå®ƒåªèƒ½è¢«æ˜¾å¼çš„è½¬æ¢</p><pre><code class="js">String(Symbol(&#39;symbol&#39;))  // &#39;Symbol(symbol)&#39;&#39;&#39; + Symbol(&#39;symbol&#39;)  // TypeError is thrown</code></pre><h2 id="Boolean-ç±»å‹è½¬æ¢"><a href="#Boolean-ç±»å‹è½¬æ¢" class="headerlink" title="Boolean ç±»å‹è½¬æ¢"></a>Boolean ç±»å‹è½¬æ¢</h2><p><code>Boolean()</code> æ–¹æ³•å¯ä»¥ç”¨æ¥æ˜¾å¼å°†å€¼è½¬æ¢æˆ boolean å‹ã€‚</p><p>éšå¼ç±»å‹è½¬æ¢é€šå¸¸åœ¨é€»è¾‘åˆ¤æ–­æˆ–è€…æœ‰é€»è¾‘è¿ç®—ç¬¦æ—¶è¢«è§¦å‘<code>ï¼ˆ|| &amp;&amp; !ï¼‰</code>ã€‚</p><pre><code class="js">Boolean(2)    // æ˜¾ç¤ºç±»å‹è½¬æ¢if(2) {}      // é€»è¾‘åˆ¤æ–­è§¦å‘éšå¼ç±»å‹è½¬æ¢!!2           // é€»è¾‘è¿ç®—ç¬¦è§¦å‘éšå¼ç±»å‹è½¬æ¢2 || &#39;hello&#39;  // é€»è¾‘è¿ç®—ç¬¦è§¦å‘éšå¼ç±»å‹è½¬æ¢</code></pre><a id="more"></a><p>æ³¨æ„: é€»è¾‘è¿ç®—ç¬¦ï¼ˆæ¯”å¦‚ || å’Œ &amp;&amp;ï¼‰æ˜¯åœ¨å†…éƒ¨åšäº† boolean ç±»å‹è½¬æ¢ï¼Œä½†å®é™…ä¸Šè¿”å›çš„æ˜¯<code>åŸå§‹æ“ä½œæ•°çš„å€¼</code>ï¼Œå³ä½¿ä»–ä»¬éƒ½ä¸æ˜¯ boolean ç±»å‹ã€‚</p><pre><code class="js">// è¿”å› number ç±»å‹ 123ï¼Œè€Œä¸æ˜¯ boolean å‹ true// &#39;hello&#39; å’Œ &#39;123&#39; ä»ç„¶åœ¨å†…éƒ¨ä¼šè½¬æ¢æˆ boolean å‹æ¥è®¡ç®—è¡¨è¾¾å¼let x = &#39;hello&#39; &amp;&amp; 123  // x === 123</code></pre><p>boolean ç±»å‹è½¬æ¢åªä¼šæœ‰ true æˆ–è€… false ä¸¤ç§ç»“æœã€‚</p><pre><code class="js">Boolean(&#39;&#39;)           // falseBoolean(0)            // false  Boolean(-0)           // falseBoolean(NaN)          // falseBoolean(null)         // falseBoolean(undefined)     // falseBoolean(false)        // false</code></pre><p><strong>ä»»ä½•ä¸åœ¨ä¸Šé¢åˆ—è¡¨ä¸­çš„å€¼éƒ½ä¼šè½¬æ¢ä¸º true</strong>, åŒ…æ‹¬ <code>object, function, Array, Date</code> ç­‰ï¼Œ<code>Symbol</code> ç±»å‹æ˜¯çœŸå€¼ï¼Œç©ºå¯¹è±¡å’Œç©ºæ•°ç»„ä¹Ÿæ˜¯çœŸå€¼ã€‚</p><pre><code class="js">Boolean({})             // trueBoolean([])             // trueBoolean(Symbol())       // true!!Symbol()              // trueBoolean(function() {})  // true</code></pre><h2 id="Number-ç±»å‹è½¬æ¢"><a href="#Number-ç±»å‹è½¬æ¢" class="headerlink" title="Number ç±»å‹è½¬æ¢"></a>Number ç±»å‹è½¬æ¢</h2><p>å’Œ <code>Boolean()</code>ã€<code>String()</code> æ–¹æ³•ä¸€æ ·ï¼Œ <code>Number()</code> æ–¹æ³•å¯ä»¥ç”¨æ¥æ˜¾å¼å°†å€¼è½¬æ¢æˆ number ç±»å‹ã€‚<br>number çš„éšå¼ç±»å‹è½¬æ¢æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨ä¸‹é¢å¤šç§æƒ…å†µä¸‹è¢«è§¦å‘ã€‚</p><ul><li>æ¯”è¾ƒæ“ä½œï¼ˆ&gt;, &lt;, &lt;=, &gt;=ï¼‰</li><li>æŒ‰ä½æ“ä½œï¼ˆ| &amp; ^ ~ï¼‰</li><li>ç®—æ•°æ“ä½œï¼ˆ- + * / %ï¼‰ï¼Œ æ³¨æ„ï¼Œå½“ + æ“ä½œå­˜åœ¨ä»»æ„çš„æ“ä½œæ•°æ˜¯ string ç±»å‹æ—¶ï¼Œä¸ä¼šè§¦å‘ number ç±»å‹çš„éšå¼è½¬æ¢</li><li>ä¸€ å…ƒ + æ“ä½œ</li><li>éä¸¥æ ¼ç›¸ç­‰æ“ä½œï¼ˆ== æˆ–è€… != ï¼‰ï¼Œæ³¨æ„ï¼Œ== æ“ä½œä¸¤ä¸ªæ“ä½œæ•°éƒ½æ˜¯ string ç±»å‹æ—¶ï¼Œä¸ä¼šå‘ç”Ÿ number ç±»å‹çš„éšå¼è½¬æ¢</li></ul><pre><code class="js">Number(&#39;123&#39;)    // æ˜¾ç¤ºç±»å‹è½¬æ¢+ &#39;123&#39;          //  éšå¼ç±»å‹è½¬æ¢123 != &quot;456&quot;    //  éšå¼ç±»å‹è½¬æ¢4 &gt; &quot;5&quot;        //  éšå¼ç±»å‹è½¬æ¢5 / null      //  éšå¼ç±»å‹è½¬æ¢true | 0      //  éšå¼ç±»å‹è½¬æ¢</code></pre><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹åŸå§‹ç±»å‹æ˜¾ç¤ºè½¬æ¢ number ç±»å‹ä¼šå‘ç”Ÿä»€ä¹ˆ</p><pre><code class="js">Number(null)                   // 0Number(undefined)              // NaNNumber(true)                   // 1Number(false)                  // 0Number(&quot; 12 &quot;)                 // 12Number(&quot;-12.34&quot;)               // -12.34Number(&quot;\n&quot;)                   // 0Number(&quot; 12s &quot;)                // NaNNumber(123)                    // 123</code></pre><p>å½“å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—æ—¶ï¼Œå¼•æ“é¦–å…ˆåˆ é™¤å‰å°¾ç©ºæ ¼ã€<code>\nã€\t</code> å­—ç¬¦ï¼Œå¦‚æœè¢«ä¿®å‰ªçš„å­—ç¬¦ä¸²ä¸æˆä¸ºä¸€ä¸ªæœ‰æ•ˆçš„æ•°å­—ï¼Œåˆ™è¿”å› NaNã€‚å¦‚æœå­—ç¬¦ä¸²ä¸ºç©ºï¼Œåˆ™è¿”å› 0ã€‚</p><p>Number() æ–¹æ³•å¯¹äº null å’Œ undefined çš„å¤„ç†æ˜¯ä¸åŒçš„ï¼Œ null ä¼šè½¬æ¢ä¸º 0, undefined ä¼šè½¬æ¢ä¸º NaN</p><p><strong>ä¸ç®¡æ˜¯æ˜¾å¼è¿˜æ˜¯éšå¼è½¬æ¢éƒ½ä¸èƒ½å°† Symbol ç±»å‹è½¬ä¸º number ç±»å‹ï¼Œå½“è¯•å›¾è¿™æ ·æ“ä½œæ—¶ï¼Œä¼šæŠ›å‡ºé”™è¯¯</strong>ã€‚</p><pre><code class="js">Number(Symbol(&#39;my symbol&#39;))    // TypeError is thrown+Symbol(&#39;123&#39;)                 // TypeError is thrown</code></pre><p>è¿™é‡Œ<strong>æœ‰ 2 ä¸ªç‰¹æ®Šçš„è§„åˆ™</strong>éœ€è¦è®°ä½ï¼š</p><ol><li>å½“å°† == åº”ç”¨äº null æˆ– undefined æ—¶ï¼Œä¸ä¼šå‘ç”Ÿæ•°å€¼è½¬æ¢ã€‚null åªç­‰äº null æˆ– undefinedï¼Œä¸ç­‰äºå…¶ä»–ä»»ä½•å€¼ã€‚<pre><code class="js">null == 0               // false, null is not converted to 0null == null            // trueundefined == undefined  // truenull == undefined       // trueundefined == 0          // false</code></pre></li><li>NaN ä¸ç­‰äºä»»ä½•å€¼ï¼ŒåŒ…æ‹¬å®ƒè‡ªå·±</li></ol><pre><code class="js">NaN === NaN  // falseif(value !== value) { console.log(&#39;the value is NaN&#39;) }</code></pre><h2 id="object-ç±»å‹è½¬æ¢"><a href="#object-ç±»å‹è½¬æ¢" class="headerlink" title="object ç±»å‹è½¬æ¢"></a>object ç±»å‹è½¬æ¢</h2><p>åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»æ·±å…¥äº†è§£äº†åŸå§‹ç±»å‹çš„è½¬æ¢ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ object ç±»å‹çš„è½¬æ¢ã€‚</p><p>å½“æ¶‰åŠåˆ°å¯¹è±¡çš„æ“ä½œæ¯”å¦‚ï¼š<code>[1] + [2,3]</code>ï¼Œå¼•æ“é¦–å…ˆä¼šå°è¯•å°† object ç±»å‹è½¬ä¸ºåŸå§‹ç±»å‹ï¼Œç„¶ååœ¨å°†åŸå§‹ç±»å‹è½¬ä¸ºæœ€ç»ˆéœ€è¦çš„ç±»å‹ï¼Œè€Œä¸”ä»ç„¶åªæœ‰ 3 ç§ç±»å‹çš„è½¬æ¢ï¼š<code>number, string, boolean</code></p><p>æœ€ç®€å•çš„æƒ…å†µæ˜¯ boolean ç±»å‹çš„è½¬æ¢ï¼Œä»»ä½•éåŸå§‹ç±»å‹æ€»æ˜¯ä¼šè½¬æ¢æˆ true,æ— è®ºå¯¹è±¡æˆ–æ•°ç»„æ˜¯å¦ä¸ºç©ºã€‚</p><p>å¯¹è±¡é€šè¿‡å†…éƒ¨ <code>[[ToPrimitive]]</code> æ–¹æ³•è½¬æ¢ä¸ºåŸå§‹ç±»å‹ï¼Œè¯¥æ–¹æ³•è´Ÿè´£æ•°å­—å’Œå­—ç¬¦ä¸²è½¬æ¢ã€‚</p><p><code>[[ToPrimitive]]</code> æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªè¾“å…¥å€¼å’Œä¸€ä¸ªéœ€è¦è½¬æ¢çš„ç±»å‹<code>ï¼ˆNumer or Stringï¼‰</code><br>number å’Œ stringçš„è½¬æ¢éƒ½ä½¿ç”¨äº†å¯¹è±¡çš„ä¸¤ä¸ªæ–¹æ³•ï¼š <code>valueOf</code> å’Œ <code>toString</code>ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½åœ¨ <code>Object.prototype</code> ä¸Šè¢«å£°æ˜ï¼Œå› æ­¤å¯ç”¨äºä»»ä½•æ´¾ç”Ÿç±»ï¼Œæ¯”å¦‚ <code>Date, Array</code>ç­‰ã€‚</p><blockquote><p>é€šå¸¸ä¸Š [[ToPrimitive]] ç®—æ³•å¦‚ä¸‹ï¼š</p></blockquote><ul><li>å¦‚æœè¾“å…¥çš„å€¼å·²ç»æ˜¯åŸå§‹ç±»å‹ï¼Œç›´æ¥è¿”å›è¿™ä¸ªå€¼ã€‚</li><li>è¾“å…¥çš„å€¼è°ƒç”¨ toString() æ–¹æ³•ï¼Œå¦‚æœç»“æœæ˜¯åŸå§‹ç±»å‹ï¼Œåˆ™è¿”å›ã€‚</li><li>è¾“å…¥çš„å€¼è°ƒç”¨ valueOf() æ–¹æ³•ï¼Œå¦‚æœç»“æœæ˜¯åŸå§‹ç±»å‹ï¼Œåˆ™è¿”å›ã€‚</li><li>å¦‚æœä¸Šé¢ 3 ä¸ªæ­¥éª¤ä¹‹åï¼Œè½¬æ¢åçš„å€¼ä»ç„¶ä¸æ˜¯åŸå§‹ç±»å‹ï¼Œåˆ™æŠ›å‡º TypeError é”™è¯¯ã€‚</li></ul><p>number ç±»å‹çš„è½¬æ¢é¦–å…ˆä¼šè°ƒç”¨ <code>valueOf()</code> æ–¹æ³•ï¼Œå¦‚æœä¸æ˜¯åŸå§‹å€¼åœ¨è°ƒç”¨ <code>toString()</code> æ–¹æ³•ã€‚ string ç±»å‹çš„è½¬æ¢åˆ™ç›¸åã€‚</p><p>å¤§å¤šæ•° JS å†…ç½®å¯¹è±¡ç±»å‹çš„ valueOf() è¿”å›è¿™ä¸ªå¯¹è±¡æœ¬èº«ï¼Œå…¶ç»“æœç»å¸¸è¢«å¿½ç•¥ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹ã€‚æ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹å½“ object éœ€è¦è½¬æ¢æˆ number æˆ– string ç±»å‹æ—¶æœ€ç»ˆéƒ½è°ƒç”¨äº† <code>toString()</code> æ–¹æ³•ã€‚</p><p>å½“è¿ç®—ç¬¦ä¸åŒæ—¶ï¼Œ<code>[[ToPrimitive]]</code> æ–¹æ³•æ¥å—çš„è½¬æ¢ç±»å‹å‚æ•°ä¹Ÿä¸ç›¸åŒã€‚å½“å­˜åœ¨ == æˆ–è€… + è¿ç®—ç¬¦æ—¶ä¸€èˆ¬ä¼šå…ˆè§¦å‘ number ç±»å‹çš„è½¬æ¢å†è§¦å‘ string ç±»å‹è½¬æ¢ã€‚</p><p>åœ¨ JS ä¸­ä½ å¯ä»¥é€šè¿‡é‡å†™å¯¹è±¡çš„ <code>toString å’Œ valueOf</code> æ–¹æ³•æ¥ä¿®æ”¹å¯¹è±¡åˆ°åŸå§‹ç±»å‹è½¬æ¢çš„é€»è¾‘ã€‚</p><h2 id="ç­”æ¡ˆè§£æ"><a href="#ç­”æ¡ˆè§£æ" class="headerlink" title="ç­”æ¡ˆè§£æ"></a>ç­”æ¡ˆè§£æ</h2><pre><code class="js">true + false // 1  // &#39;+&#39; è¿ç®—ç¬¦ä¼šè§¦å‘ number ç±»å‹è½¬æ¢å¯¹äº true å’Œ false12 / &quot;6&quot; // 2       //ç®—æ•°è¿ç®—ç¬¦ä¼šæŠŠå­—ç¬¦ä¸² â€˜6â€™ è½¬ä¸º number ç±»å‹&quot;number&quot; + 15 + 3 // &#39;number153&#39;// &#39;+&#39; è¿ç®—ç¬¦æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºçš„æ‰§è¡Œï¼Œæ‰€ä»¥ä¼˜å…ˆæ‰§è¡Œ â€œnumberâ€ + 15, æŠŠ 15 è½¬ä¸º string ç±»å‹ï¼Œå¾—åˆ° â€œnumber15â€ ç„¶ååŒç†æ‰§è¡Œ â€œnumber15â€ + 315 + 3 + &quot;number&quot;  // &quot;18number&quot;// 15 + 3 å…ˆæ‰§è¡Œï¼Œè¿ç®—ç¬¦ä¸¤è¾¹éƒ½æ˜¯ number ç±»å‹ ï¼Œä¸ç”¨è½¬æ¢ï¼Œç„¶åæ‰§è¡Œ 18 + â€œnumberâ€ æœ€ç»ˆå¾—åˆ° â€œ18numberâ€[1] &gt; null // true// ==&gt; &#39;1&#39; &gt; 0// ==&gt; 1 &gt; 0// ==&gt; true// æ¯”è¾ƒè¿ç®—ç¬¦ &gt; æ‰§è¡Œ number ç±»å‹éšå¼è½¬æ¢ã€‚&quot;foo&quot; + + &quot;bar&quot; // &quot;fooNaN&quot;// ==&gt; &quot;foo&quot; + (+&quot;bar&quot;)// ==&gt; &quot;foo&quot; + NaN// ==&gt; &quot;fooNaN&quot;// ä¸€å…ƒ + è¿ç®—ç¬¦æ¯”äºŒå…ƒ + è¿ç®—ç¬¦å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚æ‰€ä»¥ + barè¡¨è¾¾å¼å…ˆæ±‚å€¼ã€‚ä¸€å…ƒåŠ å·æ‰§è¡Œå­—ç¬¦ä¸²â€œbarâ€ çš„ number ç±»å‹è½¬æ¢ã€‚å› ä¸ºå­—ç¬¦ä¸²ä¸ä»£è¡¨ä¸€ä¸ªæœ‰æ•ˆçš„æ•°å­—ï¼Œæ‰€ä»¥ç»“æœæ˜¯NaNã€‚åœ¨ç¬¬äºŒæ­¥ä¸­ï¼Œè®¡ç®—è¡¨è¾¾å¼&#39;foo&#39; + NaNã€‚&quot;true&quot; == true // falsefalse == &quot;false&quot; // false// == è¿ç®—ç¬¦æ‰§è¡Œ number ç±»å‹è½¬æ¢ï¼Œ&#39;true&#39; è½¬æ¢ä¸º NaNï¼Œ boolean ç±»å‹ true è½¬æ¢ä¸º 1null == &quot;&quot; // false// null ä¸ç­‰äºä»»ä½•å€¼é™¤äº† null å’Œ undefined!!&quot;false&quot; == !!&quot;true&quot; // true// !! è¿ç®—ç¬¦å°†å­—ç¬¦ä¸² &#39;true&#39; å’Œ &#39;false&#39; è½¬ä¸º boolean ç±»å‹ true, å› ä¸ºä¸æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œç„¶åä¸¤è¾¹éƒ½æ˜¯ boolean å‹ä¸åœ¨æ‰§è¡Œéšå¼è½¬æ¢æ“ä½œã€‚[&quot;x&quot;] == &quot;x&quot; // true// == è¿ç®—ç¬¦å¯¹æ•°ç»„ç±»å‹æ‰§è¡Œ number è½¬æ¢ï¼Œå…ˆè°ƒç”¨å¯¹è±¡çš„ valueOf() æ–¹æ³•ï¼Œç»“æœæ˜¯æ•°ç»„æœ¬èº«ï¼Œä¸æ˜¯åŸå§‹ç±»å‹å€¼ï¼Œæ‰€ä»¥æ‰§è¡Œå¯¹è±¡çš„ toString() æ–¹æ³•ï¼Œå¾—åˆ°å­—ç¬¦ä¸² &#39;x&#39;[] + null + 1 // &#39;null1&#39;// &#39;+&#39; è¿ç®—ç¬¦æ‰§è¡Œ number ç±»å‹è½¬æ¢ï¼Œå…ˆè°ƒç”¨å¯¹è±¡çš„ valueOf() æ–¹æ³•ï¼Œç»“æœæ˜¯æ•°ç»„æœ¬èº«ï¼Œä¸æ˜¯åŸå§‹ç±»å‹å€¼ï¼Œæ‰€ä»¥æ‰§è¡Œå¯¹è±¡çš„ toString() æ–¹æ³•ï¼Œå¾—åˆ°å­—ç¬¦ä¸² &#39;&#39;ï¼Œ æ¥ä¸‹æ¥æ‰§è¡Œè¡¨è¾¾å¼ &#39;&#39; + null + 1ã€‚[1,2,3] == [1,2,3] // false// å½“è¿ç®—ç¬¦ä¸¤è¾¹ç±»å‹ç›¸åŒæ—¶ï¼Œä¸ä¼šæ‰§è¡Œç±»å‹è½¬æ¢ï¼Œä¸¤ä¸ªæ•°ç»„çš„å†…å­˜åœ°å€ä¸ä¸€æ ·ï¼Œæ‰€ä»¥è¿”å› false0 || &quot;0&quot; &amp;&amp; {}  // {}// é€»è¾‘è¿ç®—ç¬¦ || å’Œ &amp;&amp; å°†å€¼è½¬ä¸º boolean å‹ï¼Œä½†æ˜¯ä¼šè¿”å›åŸå§‹å€¼ï¼ˆä¸æ˜¯ booleanï¼‰ã€‚{} + [] + {} + [1] // &#39;0[object Object]1&#39;// æ‰€æœ‰çš„æ“ä½œæ•°éƒ½ä¸æ˜¯åŸå§‹ç±»å‹ï¼Œæ‰€ä»¥ä¼šæŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºæ‰§è¡Œ number ç±»å‹çš„éšå¼è½¬æ¢ï¼Œ object å’Œ array ç±»å‹çš„ valueOf() æ–¹æ³•è¿”å›å®ƒä»¬æœ¬èº«ï¼Œæ‰€ä»¥ç›´æ¥å¿½ç•¥ï¼Œæ‰§è¡Œ toString() æ–¹æ³•ã€‚ è¿™é‡Œçš„æŠ€å·§æ˜¯ï¼Œç¬¬ä¸€ä¸ª {} ä¸è¢«è§†ä¸º objectï¼Œè€Œæ˜¯å—å£°æ˜è¯­å¥ï¼Œå› æ­¤å®ƒè¢«å¿½ç•¥ã€‚è®¡ç®—ä» +[] è¡¨è¾¾å¼å¼€å§‹ï¼Œè¯¥è¡¨è¾¾å¼é€šè¿‡toString()æ–¹æ³•è½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œç„¶åè½¬æ¢ä¸º0ã€‚! + [] + [] + ![] // &#39;truefalse&#39;// ä¸€å…ƒè¿ç®—ç¬¦ä¼˜å…ˆæ‰§è¡Œï¼Œ+[] è½¬ä¸º number ç±»å‹ 0ï¼Œ![] è½¬ä¸º boolean å‹ falseã€‚new Date(0) - 0 // 0// &#39;-&#39; è¿ç®—ç¬¦æ‰§è¡Œ number ç±»å‹éšå¼è½¬æ¢å¯¹äº Date å‹çš„å€¼ï¼ŒDate.valueOf() è¿”å›åˆ°æ¯«ç§’çš„æ—¶é—´æˆ³ã€‚new Date(0) + 0 //&quot;Thu Jan 01 1970 08:00:00 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)0&quot;// +&#39; è¿ç®—ç¬¦è§¦å‘é»˜è®¤è½¬æ¢ï¼Œå› æ­¤ä½¿ç”¨ toString() æ–¹æ³•ï¼Œè€Œä¸æ˜¯ valueOf()ã€‚</code></pre>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptå¼‚æ­¥ç¼–ç¨‹å›è°ƒåœ°ç‹±çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ</title>
      <link href="/2019/08/01/Js/JavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1%E7%9A%84%E4%B8%80%E4%BA%9B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
      <url>/2019/08/01/Js/JavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1%E7%9A%84%E4%B8%80%E4%BA%9B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/bc7b8d542dcd" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><blockquote><p>å¼‚æ­¥ç¼–ç¨‹åœ¨JavaScriptä¸­éå¸¸é‡è¦ã€‚è¿‡å¤šçš„å¼‚æ­¥ç¼–ç¨‹ä¹Ÿå¸¦äº†å›è°ƒåµŒå¥—çš„é—®é¢˜ï¼Œæœ¬æ–‡ä¼šæä¾›ä¸€äº›è§£å†³â€œå›è°ƒåœ°ç‹±â€çš„æ–¹æ³•ã€‚</p></blockquote><pre><code class="js">setTimeout(function(){    console.log(&quot;å»¶æ—¶è§¦å‘&quot;)},2000)fs.readFile(&#39;./samp.txt&#39;,&#39;utf-8&#39;,function(res,error){    console.log(res);})</code></pre><p>ä¸Šé¢å°±æ˜¯å…¸å‹çš„å›è°ƒå‡½æ•°ï¼Œä¸è®ºæ˜¯åœ¨æµè§ˆå™¨ä¸­ï¼Œè¿˜æ˜¯åœ¨nodeä¸­ï¼ŒJavaScriptæœ¬èº«æ˜¯å•çº¿ç¨‹ï¼Œå› æ­¤ï¼Œä¸ºäº†åº”å¯¹ä¸€äº›å•çº¿ç¨‹å¸¦æ¥çš„é—®é¢˜ï¼Œå¼‚æ­¥ç¼–ç¨‹æˆä¸ºäº†JavaScriptä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚</p><p>ä¸è®ºæ˜¯æµè§ˆå™¨ä¸­æœ€ä¸ºå¸¸è§çš„<strong>ajaxã€äº‹ä»¶ç›‘å¬ï¼Œè¿˜æ˜¯nodeä¸­æ–‡ä»¶è¯»å–ã€ç½‘ç»œç¼–ç¨‹ã€æ•°æ®åº“ç­‰æ“ä½œ</strong>ï¼Œéƒ½ç¦»ä¸å¼€å¼‚æ­¥ç¼–ç¨‹ã€‚åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œè®¸å¤šæ“ä½œéƒ½ä¼šæ”¾<strong>åœ¨å›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰</strong>ä¸­ã€‚åŒæ­¥ä¸å¼‚æ­¥çš„æ··æ‚ã€è¿‡å¤šçš„å›è°ƒåµŒå¥—éƒ½ä¼šä½¿å¾—ä»£ç å˜å¾—éš¾ä»¥ç†è§£ä¸ç»´æŠ¤ï¼Œè¿™ä¹Ÿæ˜¯å¸¸å—äººè¯Ÿç—…çš„åœ°æ–¹ã€‚</p><p>å…ˆçœ‹ä¸‹é¢è¿™æ®µä»£ç </p><pre><code class="js">fs.readFile(&#39;./sample.txt&#39;, &#39;utf-8&#39;, (err, content) =&gt; {    let keyword = content.substring(0, 5);    db.find(`select * from sample where kw = ${keyword}`, (err, res) =&gt; {        get(`/sampleget?count=${res.length}`, data =&gt; {           console.log(data);        });    });});</code></pre><p>é¦–å…ˆæˆ‘ä»¬è¯»å–çš„ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å…³é”®å­—keywordï¼Œç„¶åæ ¹æ®è¯¥keywordè¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ï¼Œæœ€åä¾æ®æŸ¥è¯¢ç»“æœè¯·æ±‚æ•°æ®ã€‚</p><ul><li>æ–‡ä»¶è¯»å–ï¼šfs.readFile</li><li>æ•°æ®åº“æŸ¥è¯¢ï¼šdb.find</li><li>httpè¯·æ±‚ï¼šget</li></ul><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ²¡å¢åŠ ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚ï¼Œå°±ä¼šå¤šæ·»åŠ ä¸€å±‚å›è°ƒå‡½æ•°çš„åµŒå¥—ï¼Œè¿™æ®µä»£ç ä¸­ä¸‰ä¸ªå¼‚æ­¥å‡½æ•°çš„åµŒå¥—å·²ç»å¼€å§‹ä½¿ä¸€æ®µæœ¬å¯ä»¥è¯­è¨€æ˜ç¡®çš„ä»£ç ç¼–ç¨‹ä¸æ˜“é˜…è¯»ä¸ç»´æŠ¤äº†ã€‚</p><p>æŠ½è±¡å‡ºæ¥è¿™ç§ä»£ç ä¼šå˜æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code class="js">asyncFunc1(opt, (...args1) =&gt; {    asyncFunc2(opt, (...args2) =&gt; {        asyncFunc3(opt, (...args3) =&gt; {            asyncFunc4(opt, (...args4) =&gt; {                // some operation            });        });    });});</code></pre><p>å·¦ä¾§æ˜æ˜¾å‡ºç°äº†ä¸€ä¸ªä¸‰è§’å½¢çš„ç¼©è¿›åŒºåŸŸï¼Œè¿‡å¤šçš„å›è°ƒä¹Ÿå°±è®©æˆ‘ä»¬é™·å…¥<code>â€œå›è°ƒåœ°ç‹±â€</code>ã€‚æ¥ä¸‹æ¥ä¼šä»‹ç»ä¸€äº›æ–¹æ³•æ¥è§„é¿å›è°ƒåœ°ç‹±ã€‚</p><h2 id="ä¸€ã€æ‹†è§£function"><a href="#ä¸€ã€æ‹†è§£function" class="headerlink" title="ä¸€ã€æ‹†è§£function"></a>ä¸€ã€æ‹†è§£function</h2><p>å›è°ƒåµŒå¥—æ‰€å¸¦æ¥çš„ä¸€ä¸ªé‡è¦é—®é¢˜å°±æ˜¯ä»£ç ä¸æ˜“é˜…è¯»ä¸ç»´æŠ¤ã€‚å› ä¸ºæ™®éæ¥è¯´ï¼Œè¿‡å¤šçš„ç¼©è¿›ï¼ˆåµŒå¥—ï¼‰ä¼šæå¤§çš„å½±å“ä»£ç çš„å¯è¯»æ€§ã€‚åŸºäºè¿™ä¸€ç‚¹ï¼Œå¯ä»¥è¿›è¡Œä¸€ä¸ªæœ€ç®€å•çš„ä¼˜åŒ–â€”â€”å°†å„æ­¥æ‹†è§£ä¸ºå•ä¸ªçš„<code>function</code></p><pre><code class="js">function getData(count) {    get(`/sampleget?count=${count}`, data =&gt; {        console.log(data);    });}function queryDB(kw) {    db.find(`select * from sample where kw = ${kw}`, (err, res) =&gt; {        getData(res.length);    });}function readFile(filepath) {    fs.readFile(filepath, &#39;utf-8&#39;, (err, content) =&gt; {        let keyword = content.substring(0, 5);        queryDB(keyword);    });}readFile(&#39;./sample.txt&#39;);</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä¸Šé¢çš„æ”¹å†™æ–¹å¼ï¼Œä»£ç æ¸…æ™°äº†è®¸å¤šã€‚è¯¥æ–¹æ³•éå¸¸ç®€å•ï¼Œå…·æœ‰ä¸€å®šçš„æ•ˆæœï¼Œä½†æ˜¯ç¼ºå°‘é€šç”¨æ€§ã€‚</p><h2 id="äºŒã€äº‹ä»¶å‘å¸ƒ-ç›‘å¬æ¨¡å¼"><a href="#äºŒã€äº‹ä»¶å‘å¸ƒ-ç›‘å¬æ¨¡å¼" class="headerlink" title="äºŒã€äº‹ä»¶å‘å¸ƒ/ç›‘å¬æ¨¡å¼"></a>äºŒã€äº‹ä»¶å‘å¸ƒ/ç›‘å¬æ¨¡å¼</h2><p>å¦‚æœåœ¨æµè§ˆå™¨ä¸­å†™è¿‡äº‹ä»¶ç›‘å¬<code>addEventListener</code>ï¼Œé‚£ä¹ˆä½ å¯¹è¿™ç§äº‹ä»¶å‘å¸ƒ/ç›‘å¬çš„æ¨¡å¼ä¸€å®šä¸é™Œç”Ÿã€‚</p><p>å€Ÿé‰´è¿™ç§æ€æƒ³ï¼Œä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥ç›‘å¬æŸä¸€äº‹ä»¶ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè¿›è¡Œç›¸åº”å›è°ƒæ“ä½œï¼›å¦ä¸€æ–¹é¢ï¼Œå½“æŸäº›æ“ä½œå®Œæˆåï¼Œé€šè¿‡å‘å¸ƒäº‹ä»¶è§¦å‘å›è°ƒã€‚è¿™æ ·å°±å¯ä»¥å°†åŸæœ¬æ†ç»‘åœ¨ä¸€èµ·çš„ä»£ç è§£è€¦ã€‚<br><a id="more"></a></p><pre><code class="js">const events = require(&#39;events&#39;);const eventEmitter = new events.EventEmitter();eventEmitter.on(&#39;db&#39;, (err, kw) =&gt; {    db.find(`select * from sample where kw = ${kw}`, (err, res) =&gt; {        eventEmitter(&#39;get&#39;, res.length);    });});eventEmitter.on(&#39;get&#39;, (err, count) =&gt; {    get(`/sampleget?count=${count}`, data =&gt; {        console.log(data);    });});fs.readFile(&#39;./sample.txt&#39;, &#39;utf-8&#39;, (err, content) =&gt; {    let keyword = content.substring(0, 5);    eventEmitter. emit(&#39;db&#39;, keyword);});</code></pre><p>ä½¿ç”¨è¿™ç§æ¨¡å¼çš„å®ç°éœ€è¦ä¸€ä¸ªäº‹ä»¶å‘å¸ƒ/ç›‘å¬çš„åº“ã€‚ä¸Šé¢ä»£ç ä¸­ä½¿ç”¨nodeåŸç”Ÿçš„eventsæ¨¡å—ï¼Œå½“ç„¶ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ å–œæ¬¢çš„åº“ã€‚</p><h2 id="ä¸‰ã€Promise"><a href="#ä¸‰ã€Promise" class="headerlink" title="ä¸‰ã€Promise"></a>ä¸‰ã€Promise</h2><p><code>Promise</code>æ˜¯ä¸€ç§å¼‚æ­¥è§£å†³æ–¹æ¡ˆï¼Œæœ€æ—©ç”±ç¤¾åŒºæå‡ºå¹¶å®ç°ï¼Œåæ¥å†™è¿›äº†es6è§„èŒƒã€‚</p><p>ç›®å‰ä¸€äº›ä¸»æµçš„æµè§ˆå™¨å·²ç»åŸç”Ÿå®ç°äº†Promiseçš„APIï¼Œå¯ä»¥åœ¨Can I useé‡ŒæŸ¥çœ‹æµè§ˆå™¨çš„æ”¯æŒæƒ…å†µã€‚å½“ç„¶ï¼Œå¦‚æœæƒ³è¦åšæµè§ˆå™¨çš„å…¼å®¹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€äº›<code>Promise</code>çš„å®ç°åº“ï¼Œä¾‹å¦‚bluebirdã€ Qç­‰ã€‚ä¸‹é¢ä»¥bluebirdä¸ºä¾‹ï¼š</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†å¼‚æ­¥æ–¹æ³•æ”¹å†™ä¸º<code>Promise</code>ï¼Œå¯¹äºç¬¦åˆnodeè§„èŒƒçš„å›è°ƒå‡½æ•°ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯Errorï¼‰ï¼Œå¯ä»¥ä½¿ç”¨<code>bluebird</code>çš„promisifyæ–¹æ³•ã€‚è¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ ‡å‡†çš„å¼‚æ­¥æ–¹æ³•å¹¶è¿”å›ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚</p><pre><code class="js">const bluebird = require(&#39;bluebird&#39;);const fs = require(&quot;fs&quot;);const readFile = bluebird.promisify(fs.readFile);</code></pre><p>è¿™æ ·ï¼ŒreadFileå°±å˜æˆäº†ä¸€ä¸ªPromiseå¯¹è±¡ã€‚</p><p>ä½†æ˜¯ï¼Œæœ‰çš„å¼‚æ­¥æ–¹æ³•æ— æ³•è¿›è¡Œè½¬æ¢ï¼Œæˆ–è€…æˆ‘ä»¬éœ€è¦ä½¿ç”¨åŸç”Ÿ<code>Promise</code>ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è¿›è¡Œä¸€äº›æ”¹é€ ã€‚ä¸‹é¢æä¾›ä¸€ç§æ”¹é€ çš„æ–¹æ³•ã€‚</p><p>ä»¥fs.readFileä¸ºä¾‹ï¼Œå€ŸåŠ©åŸç”Ÿ<code>Promise</code>æ¥æ”¹é€ è¯¥æ–¹æ³•ï¼š</p><pre><code class="js">const readFile = function (filepath) {    let resolve,        reject;    let promise = new Promise((_resolve, _reject) =&gt; {        resolve = _resolve;        reject = _reject;    });    let deferred = {        resolve,        reject,        promise    };    fs.readFile(filepath, &#39;utf-8&#39;, function (err, ...args) {        if (err) {            deferred.reject(err);        }        else {            deferred.resolve(...args);        }    });    return deferred.promise;}</code></pre><p>æˆ‘ä»¬åœ¨æ–¹æ³•ä¸­åˆ›å»ºäº†ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå¹¶åœ¨å¼‚æ­¥å›è°ƒä¸­æ ¹æ®ä¸åŒçš„æƒ…å†µä½¿ç”¨rejectä¸resolveæ¥æ”¹å˜Promiseå¯¹è±¡çš„çŠ¶æ€ã€‚è¯¥æ–¹æ³•è¿”å›è¿™ä¸ªPromiseå¯¹è±¡ã€‚å…¶ä»–çš„ä¸€äº›å¼‚æ­¥æ–¹æ³•ä¹Ÿå¯ä»¥å‚ç…§è¿™ç§æ–¹å¼è¿›è¡Œæ”¹é€ ã€‚</p><p>å‡è®¾é€šè¿‡æ”¹é€ ï¼ŒreadFileã€queryDBä¸getDataæ–¹æ³•å‡ä¼šè¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ã€‚ä»£ç å°±å˜ä¸ºäº†:</p><pre><code class="js">readFile(&#39;./sample.txt&#39;).then(content =&gt; {    let keyword = content.substring(0, 5);    return queryDB(keyword);}).then(res =&gt; {    return getData(res.length);}).then(data =&gt; {    console.log(data);}).catch(err =&gt; {    console.warn(err);});</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œä¹‹å‰çš„åµŒå¥—æ“ä½œç¼–ç¨‹äº†é€šè¿‡thenè¿æ¥çš„é“¾å¼æ“ä½œã€‚ä»£ç çš„æ•´æ´åº¦ä¸Šæœ‰äº†ä¸€ä¸ªè¾ƒå¤§çš„æé«˜ã€‚</p><h2 id="å››ã€generator"><a href="#å››ã€generator" class="headerlink" title="å››ã€generator"></a>å››ã€generator</h2><p><code>generator</code>æ˜¯es6ä¸­çš„ä¸€ä¸ªæ–°çš„è¯­æ³•ã€‚åœ¨functionå…³é”®å­—åæ·»åŠ *å³å¯å°†å‡½æ•°å˜ä¸º<code>generator</code>ã€‚</p><pre><code class="js">const gen = function* () {    yield 1;    yield 2;    return 3;}</code></pre><p>æ‰§è¡Œ<code>generator</code>å°†ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨äºéå†<code>generator</code>å†…éƒ¨çš„çŠ¶æ€</p><pre><code class="js">let g = gen();g.next(); // { value: 1, done: false }g.next(); // { value: 2, done: false }g.next(); // { value: 3, done: true }g.next(); // { value: undefined, done: true }</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>generator</code>å‡½æ•°æœ‰ä¸€ä¸ªæœ€å¤§çš„ç‰¹ç‚¹ï¼Œå¯ä»¥åœ¨å†…éƒ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­äº¤å‡ºç¨‹åºçš„æ§åˆ¶æƒï¼Œ<code>yield</code>ç›¸å½“äºèµ·åˆ°äº†ä¸€ä¸ªæš‚åœçš„ä½œç”¨ï¼›è€Œå½“ä¸€å®šæƒ…å†µä¸‹ï¼Œå¤–éƒ¨åˆå°†æ§åˆ¶æƒå†ç§»äº¤å›æ¥ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç”¨<code>generator</code>æ¥å°è£…ä»£ç ï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡å¤„ä½¿ç”¨<code>yield</code>å…³é”®è¯ï¼Œæ­¤æ—¶<code>generator</code>ä¼šå°†ç¨‹åºæ‰§è¡Œæƒäº¤ç»™å…¶ä»–ä»£ç ï¼Œè€Œåœ¨å¼‚æ­¥ä»»åŠ¡å®Œæˆåï¼Œè°ƒç”¨nextæ–¹æ³•æ¥æ¢å¤<code>yield</code>ä¸‹æ–¹ä»£ç çš„æ‰§è¡Œã€‚ä»¥readFileä¸ºä¾‹ï¼Œå¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p><pre><code class="js">// æˆ‘ä»¬çš„ä¸»ä»»åŠ¡â€”â€”æ˜¾ç¤ºå…³é”®å­—// ä½¿ç”¨yieldæš‚æ—¶ä¸­æ–­ä¸‹æ–¹ä»£ç æ‰§è¡Œ// yieldåé¢ä¸ºpromiseå¯¹è±¡const showKeyword = function* (filepath) {    console.log(&#39;å¼€å§‹è¯»å–&#39;);    let keyword = yield readFile(filepath);    console.log(`å…³é”®å­—ä¸º${filepath}`);}// generatorçš„æµç¨‹æ§åˆ¶let gen = showKeyword();let res = gen.next();res.value.then(res =&gt; gen.next(res));</code></pre><p>åœ¨ä¸»ä»»åŠ¡éƒ¨åˆ†ï¼ŒåŸæœ¬<code>readFile</code>å¼‚æ­¥çš„éƒ¨åˆ†å˜æˆäº†ç±»ä¼¼åŒæ­¥çš„å†™æ³•ï¼Œä»£ç å˜å¾—éå¸¸æ¸…æ™°ã€‚è€Œåœ¨ä¸‹åŠéƒ¨åˆ†ï¼Œåˆ™æ˜¯å¯¹äºä»€ä¹ˆæ—¶å€™éœ€è¦ç§»äº¤å›æ§åˆ¶æƒç»™<code>generator</code>çš„æµç¨‹æ§åˆ¶ã€‚</p><p>ç„¶è€Œï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ§åˆ¶<code>generator</code>çš„æµç¨‹ï¼Œå¦‚æœèƒ½å¤Ÿè‡ªåŠ¨æ‰§è¡Œ<code>generator</code>â€”â€”åœ¨éœ€è¦çš„æ—¶å€™è‡ªåŠ¨ç§»äº¤æ§åˆ¶æƒï¼Œé‚£ä¹ˆä¼šæ›´åŠ å…·æœ‰å®ç”¨æ€§ã€‚<br>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ co è¿™ä¸ªåº“ã€‚å®ƒå¯ä»¥æ˜¯çœå»æˆ‘ä»¬å¯¹äº<code>generator</code>æµç¨‹æ§åˆ¶çš„ä»£ç </p><pre><code class="js">const co = reuqire(&#39;co&#39;);// æˆ‘ä»¬çš„ä¸»ä»»åŠ¡â€”â€”æ˜¾ç¤ºå…³é”®å­—// ä½¿ç”¨yieldæš‚æ—¶ä¸­æ–­ä¸‹æ–¹ä»£ç æ‰§è¡Œ// yieldåé¢ä¸ºpromiseå¯¹è±¡const showKeyword = function* (filepath) {    console.log(&#39;å¼€å§‹è¯»å–&#39;);    let keyword = yield readFile(filepath);    console.log(`å…³é”®å­—ä¸º${filepath}`);}// ä½¿ç”¨coco(showKeyword);</code></pre><p>å…¶ä¸­ï¼Œyeildå…³é”®å­—åé¢éœ€è¦æ˜¯<code>functio, promise, generator, arrayæˆ–object</code>ã€‚å¯ä»¥æ”¹å†™æ–‡ç« ä¸€å¼€å§‹çš„ä¾‹å­ï¼š</p><pre><code class="js">const co = reuqire(&#39;co&#39;);const task = function* (filepath) {   let keyword = yield readFile(filepath);   let count = yield queryDB(keyword);   let data = yield getData(res.length);   console.log(data);});co(task, &#39;./sample.txt&#39;);</code></pre><p>äº”ã€async/await</p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„æ–¹æ³•è™½ç„¶éƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†å¼‚æ­¥ç¼–ç¨‹ä¸­å›è°ƒå¸¦æ¥çš„é—®é¢˜ã€‚ç„¶è€Œ</p><ul><li>functionæ‹†åˆ†çš„æ–¹å¼å…¶å®ä»…ä»…åªæ˜¯æ‹†åˆ†ä»£ç å—ï¼Œæ—¶å¸¸ä¼šä¸åˆ©äºåç»­ç»´æŠ¤ï¼›</li><li>äº‹ä»¶å‘å¸ƒ/ç›‘å¬æ–¹å¼æ¨¡ç³Šäº†å¼‚æ­¥æ–¹æ³•ä¹‹é—´çš„æµç¨‹å…³ç³»ï¼›</li><li>Promiseè™½ç„¶ä½¿å¾—å¤šä¸ªåµŒå¥—çš„å¼‚æ­¥è°ƒç”¨èƒ½å¤Ÿé€šè¿‡é“¾å¼çš„APIè¿›è¡Œæ“ä½œï¼Œä½†æ˜¯è¿‡å¤šçš„thenä¹Ÿå¢åŠ äº†ä»£ç çš„å†—ä½™ï¼Œä¹Ÿå¯¹é˜…è¯»ä»£ç ä¸­å„é˜¶æ®µçš„å¼‚æ­¥ä»»åŠ¡äº§ç”Ÿäº†ä¸€å®šå¹²æ‰°ï¼›</li><li>é€šè¿‡generatorè™½ç„¶èƒ½æä¾›è¾ƒå¥½çš„è¯­æ³•ç»“æ„ï¼Œä½†æ˜¯æ¯•ç«Ÿgeneratorä¸yieldçš„è¯­å¢ƒç”¨åœ¨è¿™é‡Œå¤šå°‘è¿˜æœ‰äº›ä¸å¤ªè´´åˆ‡ã€‚</li></ul><p>å› æ­¤ï¼Œè¿™é‡Œå†ä»‹ç»ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå°±æ˜¯es7ä¸­çš„async/awaitã€‚</p><p>ç®€å•ä»‹ç»ä¸€ä¸‹async/awaitã€‚åŸºæœ¬ä¸Šï¼Œä»»ä½•ä¸€ä¸ªå‡½æ•°éƒ½å¯ä»¥æˆä¸ºasyncå‡½æ•°ï¼Œä»¥ä¸‹éƒ½æ˜¯åˆæ³•çš„ä¹¦å†™å½¢å¼ï¼š</p><pre><code class="js">async function foo () {};const foo = async function () {};const foo = async () =&gt; {};</code></pre><p>åœ¨asyncå‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨awaitè¯­å¥ã€‚awaitåä¸€èˆ¬æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ã€‚</p><pre><code class="js">async function foo () {    console.log(&#39;å¼€å§‹&#39;);    let res = await post(data);    console.log(`postå·²å®Œæˆï¼Œç»“æœä¸ºï¼š${res}`);};</code></pre><p>å½“ä¸Šé¢çš„å‡½æ•°æ‰§è¡Œåˆ°awaitæ—¶ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œå‡½æ•°æŒ‚èµ·ï¼Œç­‰å¾…<code>await</code>åçš„<code>Promise</code>è¿”å›ï¼Œå†æ‰§è¡Œä¸‹é¢çš„è¯­å¥ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™æ®µå¼‚æ­¥æ“ä½œçš„ä»£ç ï¼Œçœ‹èµ·æ¥å°±åƒæ˜¯â€œåŒæ­¥æ“ä½œâ€ã€‚è¿™å°±å¤§å¤§æ–¹ä¾¿äº†å¼‚æ­¥ä»£ç çš„ç¼–å†™ä¸é˜…è¯»ã€‚ä¸‹é¢æ”¹å†™æˆ‘ä»¬çš„ä¾‹å­ã€‚</p><pre><code class="js">const printData = async function (filepath) {   let keyword = await readFile(filepath);   let count = await queryDB(keyword);   let data = await getData(res.length);   console.log(data);});printData(&#39;./sample.txt&#39;);</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œä»£ç ç®€æ´æ¸…æ™°ï¼Œå¼‚æ­¥ä»£ç ä¹Ÿå…·æœ‰äº†â€œåŒæ­¥â€ä»£ç çš„ç»“æ„ã€‚</p><p>æ³¨æ„ï¼Œå…¶ä¸­<code>readFileã€queryDBä¸getData</code>æ–¹æ³•éƒ½éœ€è¦è¿”å›ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨ç¬¬ä¸‰éƒ¨åˆ†Promiseé‡Œæä¾›çš„æ–¹å¼è¿›è¡Œæ”¹å†™ã€‚</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å¼‚æ­¥ç¼–ç¨‹ä½œä¸ºJavaScriptä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå…·æœ‰éå¸¸é‡è¦çš„ä½ç½®ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬é¿å…åŒæ­¥ä»£ç å¸¦æ¥çš„çº¿ç¨‹é˜»å¡çš„åŒæ—¶ï¼Œä¹Ÿä¸ºç¼–ç ä¸é˜…è¯»å¸¦æ¥äº†ä¸€å®šçš„å›°éš¾ã€‚è¿‡å¤šçš„å›è°ƒåµŒå¥—å¾ˆå®¹æ˜“ä¼šè®©æˆ‘ä»¬é™·å…¥â€œå›è°ƒåœ°ç‹±â€ä¸­ï¼Œä½¿ä»£ç å˜æˆä¸€å›¢ä¹±éº»ã€‚ä¸ºäº†è§£å†³â€œå›è°ƒåœ°ç‹±â€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–‡ä¸­æ‰€è¿°çš„è¿™äº”ç§å¸¸ç”¨æ–¹æ³•ï¼š</p><ul><li>functionæ‹†è§£</li><li>äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼</li><li>Promise</li><li>Generator</li><li>async / await</li></ul><p>ç†è§£å„ç±»æ–¹æ³•çš„åŸç†ä¸å®ç°æ–¹å¼ï¼Œäº†è§£å…¶ä¸­åˆ©å¼Šï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½å¾—è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Webpack Freestyle ä¹‹ Long Term Cache(webpack å®ç°æŒä¹…æ€§ç¼“å­˜)</title>
      <link href="/2019/07/31/Tools/Webpack-Freestyle-%E4%B9%8B-Long-Term-Cache-webpack-%E5%AE%9E%E7%8E%B0%E6%8C%81%E4%B9%85%E6%80%A7%E7%BC%93%E5%AD%98/"/>
      <url>/2019/07/31/Tools/Webpack-Freestyle-%E4%B9%8B-Long-Term-Cache-webpack-%E5%AE%9E%E7%8E%B0%E6%8C%81%E4%B9%85%E6%80%A7%E7%BC%93%E5%AD%98/</url>
      
        <content type="html"><![CDATA[<p><a href="https://zhuanlan.zhihu.com/p/27710902" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h2 id="How-Browser-Cache-Works"><a href="#How-Browser-Cache-Works" class="headerlink" title="How Browser Cache Works"></a>How Browser Cache Works</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦ææ¸…æ¥šæµè§ˆå™¨ç¼“å­˜æ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚ é‚£ä¹ˆï¼Œå°±è®©æˆ‘ç”»ä¸€å¼ å›¾æ¥å‘Šè¯‰å¤§å®¶å§ï¼Œå˜»å˜»ã€‚</p><p><img src="https://pic2.zhimg.com/80/v2-5babc40038bcc8add9c5f8bcb717c7b5_hd.png" alt="pic"></p><ul><li>æµè§ˆå™¨: æˆ‘éœ€è¦ foo.js</li><li>æœåŠ¡å™¨: è®©æˆ‘æ‰¾æ‰¾ã€‚æ‰¾åˆ°äº†ï¼Œç»™ä½ ï¼Œç¼“å­˜æœ‰æ•ˆæœŸä¸º 1 å¹´ã€‚</li><li>æµè§ˆå™¨: å¥½ï¼Œæˆ‘æŠŠä»–ç¼“å­˜åˆ°ç£ç›˜é‡Œã€‚</li></ul><p>è¿‡äº† 2 å¤©ï¼Œ</p><p><img src="https://pic4.zhimg.com/80/v2-b5e4a95482e0008758b94ec96c0f60a3_hd.png" alt="pic1"></p><p>æµè§ˆå™¨: æˆ‘éœ€è¦ foo.js ï¼Œåœ¨ç¼“å­˜é‡Œæ‰¾åˆ°äº†ã€‚ç¼“å­˜è¿˜æœ‰æ•ˆï¼Œé‚£ç›´æ¥è¯»ç¼“å­˜ã€‚<br>ç”¨æˆ·ï¼šå“‡å¡ï¼Œè¿™ç½‘é¡µç§’å¼€å•Šã€‚</p><p>åˆè¿‡äº† 2 å¤©ï¼Œfoo.js çš„ä»£ç æ›´æ–°äº†ã€‚ï¼ˆå†…å®¹ä» Hello world å˜æˆäº† Goodbye world ï¼‰</p><p><img src="https://pic2.zhimg.com/80/v2-680f699d7e09991af4f6bf260559aef1_hd.png" alt="pic2"></p><p>æµè§ˆå™¨ï¼šæˆ‘éœ€è¦ foo.js ï¼Œåœ¨ç¼“å­˜é‡Œæ‰¾åˆ°äº†ã€‚ç¼“å­˜è¿˜æœ‰æ•ˆï¼Œé‚£ç›´æ¥è¯»ç¼“å­˜ã€‚<br>äº§å“ç»ç†ï¼šï¼Ÿï¼Ÿï¼Ÿè¿™é¡µé¢æ€ä¹ˆè·Ÿä»¥å‰ä¸€æ ·å•Šï¼Ÿ</p><p>å¾ˆå°´å°¬ã€‚foo.js æ˜æ˜æ›´æ–°äº†ï¼Œä½†æ˜¯æµè§ˆå™¨è¿˜æ˜¯è¯»å–åœ¨ç¼“å­˜ä¸­æ—§çš„ foo.js ï¼ŒåŸå› æ˜¯æˆ‘ä»¬ç”¨äº†ç¼“å­˜ï¼Œä¸ç”¨ç¼“å­˜å°±æ²¡è¿™äº‹å„¿äº†ã€‚?</p><p>è§£å†³åŠæ³•å˜›ï¼Œå½“ç„¶æœ‰çš„ã€‚æ¯”å¦‚æ¯æ¬¡åˆ©ç”¨ç¼“å­˜ä¹‹å‰ï¼Œ<code>å…ˆå‘æœåŠ¡å™¨ç¡®è®¤æ–‡ä»¶æ˜¯å¦æœ‰æ›´æ–°ï¼Œæœ‰æ›´æ–°åˆ™ä½¿ç”¨æ–°çš„å¦åˆ™è¯»ç¼“å­˜</code>ã€‚è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯<code>æŠŠç¼“å­˜ç ´åæ‰ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¦è¯´çš„*Cache Busting Technique*</code> </p><h2 id="Cache-Busting-Technique"><a href="#Cache-Busting-Technique" class="headerlink" title="Cache Busting Technique"></a>Cache Busting Technique</h2><p>å› ä¸º foo.js çš„ä»£ç å˜åŒ–äº†ï¼Œä½†æ˜¯ä»–çš„ç¼“å­˜è¿˜æ²¡å¤±æ•ˆï¼Œæ­¤æ—¶æµè§ˆå™¨è¿˜æ˜¯ä¼šè¯»å–ä»¥å‰çš„ç¼“å­˜äº†çš„ foo.js ï¼Œå¹¶ä¸ä¼šå»æœåŠ¡å™¨ä¸‹è½½æœ€æ–°çš„ã€‚è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦ç ´åç¼“å­˜ï¼ˆ Cache Busting ï¼‰ã€‚</p><p>ç ´åç¼“å­˜å¹¶ä¸æ˜¯ç¦æ­¢ç¼“å­˜ï¼Œè€Œæ˜¯æ¢ä¸€ç§æ–¹å¼è®©ç¼“å­˜å¤±æ•ˆã€‚æ¯”å¦‚ï¼š</p><p>1.ä¿®æ”¹æ–‡ä»¶çš„åå­—ï¼šfoo.js -&gt; foo.v2.js<br>2.ä¿®æ”¹æ–‡ä»¶çš„è·¯å¾„ï¼š/static/foo.js -&gt; /static/v2/foo.js<br>3.åŠ  query string : foo.js -&gt; foo.js?v=qwer</p><p>æˆ‘ä»¬ä¸‹é¢å°†é‡‡ç”¨ç¬¬ä¸€ç§æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹æ–‡ä»¶çš„åå­—ã€‚æˆ‘ä»¬æŠŠæ›´æ–°åçš„ foo.js çš„æ–‡ä»¶åæ”¹æˆ foo.v2.js ã€‚è¿™æ ·ï¼Œæµè§ˆå™¨å°±ä¸ä¼šå»è¯»å–ç¼“å­˜é‡Œçš„æ—§çš„ foo.js ï¼Œè€Œæ˜¯å‘æœåŠ¡è¯·è¯·æ±‚ foo.v2.js ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://pic2.zhimg.com/80/v2-103471cbe5d028bc9e1122db6e4243b9_hd.png" alt="pic4"></p><p>é‚£ä¹ˆï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰å¾ˆå¤šå¾ˆå¤šçš„é™æ€æ–‡ä»¶ï¼Œç„¶åæ¯æ¬¡éœ€è¦æ›´æ–°å¾ˆå¤šå¾ˆå¤šçš„æ–‡ä»¶ï¼Œé‚£æ˜¯ä¸æ˜¯è¦æ‰‹åŠ¨åœ°ä¸€ä¸ªä¸€ä¸ªåœ°ä¿®æ”¹æ–‡ä»¶çš„åå­—å‘¢ï¼Ÿæˆ‘ä»¬çš„ç†æƒ³å½“ç„¶æ˜¯ï¼šå“ªä¸ªæ–‡ä»¶æ›´æ–°äº†ï¼Œå°±<strong>è‡ªåŠ¨</strong>åœ°ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶åã€‚</p><p>å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬æ‰“åŒ…å‡ºæ¥çš„é™æ€æ–‡ä»¶åªæœ‰ä¸€ä¸ªå•ç‹¬çš„ JavaScript æ–‡ä»¶ app.js ï¼Œé‚£ä¹ˆæ¯æ¬¡æ”¹åŠ¨ä¸€ç‚¹ä»£ç ï¼Œapp.js çš„æ–‡ä»¶åè‚¯å®šéƒ½ä¼šå˜ã€‚ä½†å®é™…ä¸Šï¼Œæˆ‘åªæ”¹åŠ¨äº†æŸä¸ªæ¨¡å—çš„ä»£ç ï¼ˆå…¶ä»–æ¨¡å—å¹¶æ²¡æœ‰ä¿®æ”¹ï¼‰ï¼Œå°±ç ´åäº†å…¶ä»–æ¨¡å—çš„ç¼“å­˜ï¼Œè¿™æ˜¾ç„¶æ²¡æœ‰å……åˆ†åˆ©ç”¨åˆ°ç¼“å­˜å•Šã€‚æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼šå“ªä¸ªæ¨¡å—æ›´æ–°äº†ç ´åä»–çš„ç¼“å­˜ï¼Œæ²¡æ›´æ–°çš„æ¨¡å—ç»§ç»­åˆ©ç”¨ç¼“å­˜ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ° webpack çš„ code splittingï¼ˆå¦‚æœè¿˜ä¸ä¼šçš„è¯ï¼Œå¯ä»¥é˜…è¯» <a href="https://zhuanlan.zhihu.com/p/26710831?refer=ElemeFE" target="_blank" rel="noopener">Webpack å¤§æ³•ä¹‹ Code Splitting</a> ï¼‰ã€‚æŠŠæ•´ä¸ª App åˆ†æˆä¸€ä¸ªä¸ª chunk ï¼Œç„¶åå“ªä¸ª chunk å‘ç”Ÿæ”¹å˜ï¼Œæˆ‘å°±ç ´åä»–çš„ç¼“å­˜ï¼›æ²¡æœ‰æ›´æ–°çš„ chunk ï¼Œåˆ™ç»§ç»­åˆ©ç”¨ç¼“å­˜ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±æŠŠç¼“å­˜çš„ä½œç”¨å‘æŒ¥åˆ°æ·‹æ¼“å°½è‡´ï½</p><p>æ‰€ä»¥ï¼Œ<code>code splitting</code> çš„ä½œç”¨é™¤äº†â€å‡å°‘æ–‡ä»¶å¤§å°â€ä¹‹å¤–ï¼Œè¿˜èƒ½æ›´å……åˆ†åœ°åˆ©ç”¨ç¼“å­˜ã€‚æ‰€ä»¥ï¼Œä¸‹é¢å°±è®©æˆ‘ä»¬ç”¨ webpack æ¥å®ç°æŒä¹…æ€§ç¼“å­˜å§ã€‚</p><h2 id="Webpack-amp-Caching"><a href="#Webpack-amp-Caching" class="headerlink" title="Webpack &amp; Caching"></a>Webpack &amp; Caching</h2><p>é¦–å…ˆï¼ŒæŠŠæˆ‘ä»¬çš„ <a href="https://link.zhihu.com/?target=https%3A//github.com/lyyourc/webpack-code-splitting-demo">demo é¡¹ç›®</a>ï¼ˆå·²ç»å®ç°äº† code splitting ï¼‰ä¸‹è½½å¹¶å®‰è£…å¥½ä¾èµ–ã€‚</p><p>æ¥ç€ï¼Œä¿®æ”¹ webpack é…ç½®æ–‡ä»¶ï¼Œç»™æˆ‘ä»¬æ‰“åŒ…åçš„é™æ€æ–‡ä»¶ç”Ÿæˆéšæœºçš„å”¯ä¸€çš„åå­—ã€‚ï¼ˆ changed files ï¼‰</p><pre><code class="js">// webpack.config.jsmodule.exports = {  output: {    //...    filename: &#39;[name].[chunkhash:8].js&#39;,    chunkFilename: &#39;[name].[chunkhash:8].chunk.js&#39;,    //...  },}</code></pre><p>æˆ‘ä»¬ä½¿ç”¨äº† <code>[chunkhash]</code> è¿™ä¸ªå ä½ç¬¦ï¼Œå¹¶ä¸”ä¸ºäº†æ›´å¥½åœ°åˆ†è¾¨å’Œå±•ç¤º demo ï¼Œæˆ‘ä»¬æˆªå–äº†ä»–çš„å‰ 8 ä¸ªå­—ç¬¦ <code>[chunkhash:8]</code>ï¼Œä½†æ˜¯åœ¨å®é™…ç”Ÿäº§ä¸­æˆ‘ä»¬ä¸è¦é‚£ä¹ˆåšï¼</p><p>å¥½å’¯ï¼Œç°åœ¨æ¥çœ‹çœ‹æˆ‘ä»¬çš„æ‰“åŒ…åçš„æ–‡ä»¶ï¼š</p><pre><code class="js">                    Asset            Size    Chunk Namescommon-in-lazy.fa79d198.chunk.js    11.6 kB  common-in-lazy    used-twice.c2c4927c.chunk.js    17.1 kB  used-twice        Photos.28d663ec.chunk.js    8.57 kB  Photos         Emoji.d3ea8991.chunk.js    1.15 kB  Emoji                 app.724a238a.js    2.53 kB  app              vendor.05be8f94.js     104 kB  vendor</code></pre><p>é‚£ä¹ˆï¼Œç°åœ¨æˆ‘ä»¬æ¥ä¿®æ”¹ä¸€ä¸‹ App.vue ï¼Œæ·»åŠ ä¸ª <code>&lt;footer&gt;</code> æ ‡ç­¾ï¼ˆ changed files ï¼‰ :</p><pre><code class="html">&lt;template&gt;&lt;div id=&quot;app&quot;&gt;  &lt;!-- old codes --&gt;  &lt;footer&gt; A Footer &lt;/footer&gt;&lt;/div&gt;&lt;/template&gt;</code></pre><a id="more"></a><p>æ­¤æ—¶çš„æ‰“åŒ…å˜æˆäº†ï¼š</p><pre><code class="js">                        Asset       Size  Chunk Namescommon-in-lazy.fa79d198.chunk.js    11.6 kB  common-in-lazy    used-twice.c2c4927c.chunk.js    17.1 kB  used-twice        Photos.28d663ec.chunk.js    8.57 kB  Photos         Emoji.d3ea8991.chunk.js    1.15 kB  Emoji                 app.fdc2eedb.js    2.57 kB  app              vendor.b611a5da.js     104 kB  vendor</code></pre><p>æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬çš„ app chunk çš„ hash ä» 724a238a å˜æˆäº† fdc2eedb ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰€å¸Œæœ›çœ‹åˆ°çš„ä¸œè¥¿ã€‚ä½†æ˜¯ï¼Œä¸æ­¤åŒæ—¶ vendor chunk çš„ hash ä¹Ÿå˜äº†ï¼ˆ05be8f94 -&gt; b611a5daï¼‰ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä¿®æ”¹ vendor chunk çš„ä»£ç ï¼Œä¸ºä»€ä¹ˆä»–çš„ hash ä¹Ÿå˜äº†å‘¢ï¼Ÿ?</p><p>åŸå› æ˜¯ <code>vendor chunk</code> é‡Œé¢åŒ…å«äº† <code>webpack</code> çš„ <code>runtime</code> ä»£ç ï¼ˆç”¨æ¥è§£æå’ŒåŠ è½½æ¨¡å—ä¹‹ç±»çš„è¿è¡Œæ—¶ä»£ç ï¼‰ï¼š</p><p>è§£å†³åŠæ³•å°±æ˜¯æŠŠ webpack çš„ runtime ä»£ç æå–å‡ºæ¥ï¼ˆ changed files ï¼‰ï¼š</p><pre><code class="js">new webpack.optimize.CommonsChunkPlugin({   name: [&#39;manifast&#39;] }),</code></pre><p>æŠŠä¹‹å‰ App.vue æ›´æ–°äº†çš„ä»£ç æš‚æ—¶å»æ‰ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æ·»åŠ çš„ <code>&lt;footer&gt;</code> æ ‡ç­¾å»æ‰ï¼š</p><p>æ¥ç€æŒ‰ç…§ä¹‹å‰çš„ï¼Œä¿®æ”¹ App.vue ï¼Œæ·»åŠ  <code></code> æ ‡ç­¾ï¼ˆ changed files ï¼‰ï¼š</p><pre><code class="html">&lt;template&gt;&lt;div id=&quot;app&quot;&gt;  &lt;!-- old codes --&gt;  &lt;footer&gt; A Footer &lt;/footer&gt;&lt;/div&gt;&lt;/template&gt;</code></pre><p>è€Œæ­¤æ—¶çš„æ‰“åŒ…ï¼š</p><pre><code class="js">                        Asset       Size  Chunk Namescommon-in-lazy.fa79d198.chunk.js    11.6 kB  common-in-lazy    used-twice.c2c4927c.chunk.js    17.1 kB  used-twice        Photos.28d663ec.chunk.js    8.57 kB  Photos         Emoji.d3ea8991.chunk.js    1.15 kB  Emoji                 app.fdc2eedb.js    2.57 kB  app              vendor.3b70f9d8.js     103 kB  vendor            manifast.1442e3f3.js    1.54 kB  manifast</code></pre><p>å¾ˆå¼€å¿ƒï¼Œæ­¤æ—¶åªæœ‰ <code>app.js</code> å’Œ <code>manifast.js</code> è¿™ 2 ä¸ª chunk çš„æ–‡ä»¶åçš„ hash å‘ç”Ÿäº†æ”¹å˜ï¼Œvendor.js chunk å’Œå…¶ä»– chunk éƒ½æ²¡å˜ï¼Œèˆ’æœã€‚</p><p>ä½†æ˜¯ï¼Œå‡å¦‚æˆ‘ä»¬ç»™ App.vue éšä¾¿å¼•å…¥ä¸€ä¸ªæ¨¡å—çš„è¯ï¼Œæ¯”å¦‚ï¼ˆ changed files ï¼‰ï¼š</p><pre><code class="js">&lt;script&gt;//...import noop from &#39;./shared/utils.js&#39;&lt;/script&gt;</code></pre><p>è€Œæ­¤æ—¶çš„æ‰“åŒ…ï¼š</p><pre><code class="js">                        Asset       Size  Chunk Namescommon-in-lazy.30b1e9b6.chunk.js    11.6 kB  common-in-lazy    used-twice.9eccbe5a.chunk.js    17.1 kB  used-twice        Photos.6096611c.chunk.js    8.57 kB  Photos         Emoji.6208da60.chunk.js    1.15 kB  Emoji                 app.4675a374.js    2.61 kB  app              vendor.8b538297.js     103 kB  vendor            manifast.25580296.js    1.54 kB  manifast</code></pre><p>å§æ§½å±…ç„¶æ‰€æœ‰ chunk çš„ hash éƒ½å‘ç”Ÿäº†æ”¹å˜ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p><p><strong>åŸå› æ˜¯åœ¨ webpack é‡Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰ä¸€ä¸ª module id </strong>ï¼Œmodule id æ˜¯è¯¥æ¨¡å—åœ¨<a href="https://link.zhihu.com/?target=https%3A//webpack.js.org/concepts/dependency-graph/">æ¨¡å—ä¾èµ–å…³ç³»å›¾</a>é‡ŒæŒ‰é¡ºåºåˆ†é…çš„åºå·ï¼Œå¦‚æœè¿™ä¸ª module id å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆä»–çš„ chunkhash ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚ï¼ˆä¸ç¡®å®šè¿™é‡Œæ˜¯å¦æ­£ç¡®ï¼Œå¸Œæœ›å¤§ä½¬æŒ‡å‡ºé”™è¯¯ï¼‰</p><p><img src="https://pic4.zhimg.com/80/v2-5a4b6bef5809e00512873d481a3670e7_hd.png" alt="pic5"></p><p>æ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸€ç§æ–°çš„æ–¹å¼æ¥è®¡ç®— module id ã€‚ <strong>HashedModuleIdsPlugin</strong> è¿™ä¸ªæ’ä»¶ï¼Œä»–æ˜¯æ ¹æ®æ¨¡å—æ‰€åœ¨è·¯å¾„æ¥æ˜ å°„å…¶ module id ï¼Œè¿™æ ·å°±ç®—å¼•å…¥äº†æ–°çš„æ¨¡å—ï¼Œä¹Ÿä¸ä¼šå½±å“ module id çš„å€¼ï¼Œåªè¦æ¨¡å—çš„è·¯å¾„ä¸æ”¹å˜çš„è¯ã€‚</p><p>ä¿®æ”¹æˆ‘ä»¬çš„ webpack é…ç½®ã€‚å¹¶ä¸”ï¼Œå»æ‰ä¸Šé¢ App.vue å¼•å…¥çš„ noop æ¨¡å—ã€‚ï¼ˆ changed files ï¼‰</p><pre><code class="js">// webpack.config.jsplugins: [  new webpack.HashedModuleIdsPlugin(),  // ...],</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰ app chunk å’Œ manifast chunk çš„ hash å‘ç”Ÿäº†æ”¹å˜ï¼Œå…¶ä»– chunk ä¸å˜æ‰€ä»¥ä»–ä»¬çš„ç¼“å­˜å°±æ²¡è¢«ç ´åã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç”¨ webpack å®ç° long term cache ï¼š</p><ul><li>ç”Ÿæˆç¨³å®šçš„ hash æ–‡ä»¶å</li><li>æå– webpack çš„ runtime ä»£ç </li><li>code splitting</li></ul><p>è¿˜æœ‰ä¸€äº›ä¸œè¥¿æˆ‘ä»¬æ˜¯æ²¡è®²åˆ°çš„ï¼Œæ¯”å¦‚ CSS çš„ cache ï¼Œå†…è” manifast chunk ç­‰ç­‰ï¼Œå°±ç•™ç»™å¤§å®¶å»æ¢ç´¢å’¯ã€‚</p><p>æœ€åéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwebpack æ˜¯å…è®¸å…¶ä»– plugin æ¥ä¿®æ”¹ chunkhash çš„ï¼Œå¦‚æœä»–ä»¬ä¸èƒ½æ­£ç¡®åœ°å¤„ç†çš„è¯ï¼Œé‚£ä¹ˆï¼Œå‡è®¾ä½ æ›´æ–°äº†ä»£ç ï¼Œä½†æ˜¯å¯¹åº”çš„ chunkhash æ²¡å˜ï¼Œå¹¶ä¸”æ­¤æ—¶ç¼“å­˜è¿˜æ²¡å¤±æ•ˆï¼Œå°±ä¼šå¯¼è‡´çº¿ä¸Šçš„ä»£ç è¿˜æ˜¯æ—§çš„ï¼Œç”¨æˆ·çœ‹åˆ°çš„è¿˜æ˜¯ä»¥å‰çš„é¡µé¢ã€‚å› æ­¤ï¼Œä¸€å®šè¦ç‰¹åˆ«æ³¨æ„ chunkhash åˆ°åº•æ­£ä¸æ­£ç¡®ï¼ï¼</p><p>å¸Œæœ›æœ¬æ–‡å¯ä»¥å¸®åŠ©åˆ°å¤§å®¶ï¼Œè¿™æ ·æˆ‘ä¼šå¾ˆå¼€å¿ƒçš„ã€‚(<em> </em>)</p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€šè¿‡ä¸€ä¸ªé—®é¢˜å­¦ä¹ map,filter,reduceè¯­æ³•</title>
      <link href="/2019/07/24/Js/%E9%80%9A%E8%BF%87%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98%E5%AD%A6%E4%B9%A0map-filter-reduce%E8%AF%AD%E6%B3%95/"/>
      <url>/2019/07/24/Js/%E9%80%9A%E8%BF%87%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98%E5%AD%A6%E4%B9%A0map-filter-reduce%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¯”å¦‚ä¸€ä¸ªä»1-10çš„ç®€å•çš„æ•°ç»„ï¼Œéœ€è¦ä»ä¸­å–å¥‡æ•°ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ"><a href="#æ¯”å¦‚ä¸€ä¸ªä»1-10çš„ç®€å•çš„æ•°ç»„ï¼Œéœ€è¦ä»ä¸­å–å¥‡æ•°ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ" class="headerlink" title="æ¯”å¦‚ä¸€ä¸ªä»1-10çš„ç®€å•çš„æ•°ç»„ï¼Œéœ€è¦ä»ä¸­å–å¥‡æ•°ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ"></a>æ¯”å¦‚ä¸€ä¸ªä»1-10çš„ç®€å•çš„æ•°ç»„ï¼Œéœ€è¦ä»ä¸­å–å¥‡æ•°ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ</h2><p>è¿™ä¸ªé—®é¢˜ä¸éš¾ï¼Œæœ‰çš„å°‘ä¾ å¯èƒ½ä¼šä½¿ç”¨forå¾ªç¯æ¥è¿‡æ»¤å‡ºå¶æ•°ï¼ŒæŸäº›å°‘ä¾ å¯èƒ½ä¼šä½¿ç”¨whileå¾ªç¯ï¼Œåˆæˆ–æ˜¯ä½¿ç”¨æ•°ç»„è‡ªå¸¦çš„filteræ–¹æ³•ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆä¸è€ƒè™‘ä½¿ç”¨forå’Œwhileè¿™äº›è¿­ä»£æ–¹æ³•ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨æ•°ç»„è‡ªå¸¦çš„filteræ–¹æ³•ï¼Œå¦‚æœä½¿ç”¨filteræ–¹æ³•çš„è¯ï¼Œ</p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];// è¿‡æ»¤å‡ºæ‰€æœ‰å¥‡æ•°nums.filter(num =&gt; num % 2 !== 0);console.log(nums);</code></pre><p>è¿˜æ˜¯æŒºç®€å•çš„å¯¹å§ï¼Ÿ</p><p>ç›¸ä¿¡å¤§éƒ¨åˆ†å°‘ä¾ éƒ½èƒ½å¾ˆè½»æ¾å®Œæˆã€‚</p><p>åœ¨filterå‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>num % 2 !== 0</code> æ¥åˆ¤æ–­ æ˜¯å¦æ˜¯ä¸€ä¸ªå¥‡æ•°ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå¥‡æ•°ï¼Œå°±è¿‡æ»¤å‡ºæ¥ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæœ‰çš„å°‘ä¾ å¯èƒ½å°±ä¼šæƒ³åˆ°ï¼Œå¦‚æœæŠŠè¿™ä¸ªåˆ¤æ–­è¿‡ç¨‹å•ç‹¬åˆ†æˆä¸€ä¸ªå‡½æ•°ï¼Œä¼šæ–¹ä¾¿ä¸€äº›ï¼Œä¹Ÿæ–¹ä¾¿ä»¥åçš„ä¿®æ”¹æ‰©å±•ã€‚</p><p>æ¯”å¦‚å•ç‹¬å†™ä¸€ä¸ªisOddå‡½æ•°</p><pre><code class="js">const isOdd = num =&gt; num % 2 !== 0;</code></pre><p>ç„¶ååœ¨filteré‡Œé¢ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œæ˜¯å§ï¼Ÿ</p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;// è¿‡æ»¤å‡ºæ‰€æœ‰å¥‡æ•°const odd = nums.filter(isOdd);console.log(odd);</code></pre><h2 id="å¦‚æœè¦æŠŠnumsé‡Œé¢çš„æ•°å­—ç¿»å€ï¼Œç”¨mapå‡½æ•°ï¼Œåˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ"><a href="#å¦‚æœè¦æŠŠnumsé‡Œé¢çš„æ•°å­—ç¿»å€ï¼Œç”¨mapå‡½æ•°ï¼Œåˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ" class="headerlink" title="å¦‚æœè¦æŠŠnumsé‡Œé¢çš„æ•°å­—ç¿»å€ï¼Œç”¨mapå‡½æ•°ï¼Œåˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ"></a>å¦‚æœè¦æŠŠnumsé‡Œé¢çš„æ•°å­—ç¿»å€ï¼Œç”¨mapå‡½æ•°ï¼Œåˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</h2><p>èªæ˜çš„å°‘ä¾ è¿™æ¬¡è‚¯å®šä¸€ä¸‹å°±æ˜ç™½äº†ï¼š</p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const double = num =&gt; num *2;const doubleNumbers = nums.map(double);console.log(doubleNumbers);</code></pre><h2 id="ä»numsé‡Œé¢è¿‡æ»¤å‡ºæ‰€æœ‰å¥‡æ•°ï¼Œå¹¶ç¿»å€è¿™äº›å¥‡æ•°ã€‚"><a href="#ä»numsé‡Œé¢è¿‡æ»¤å‡ºæ‰€æœ‰å¥‡æ•°ï¼Œå¹¶ç¿»å€è¿™äº›å¥‡æ•°ã€‚" class="headerlink" title="ä»numsé‡Œé¢è¿‡æ»¤å‡ºæ‰€æœ‰å¥‡æ•°ï¼Œå¹¶ç¿»å€è¿™äº›å¥‡æ•°ã€‚"></a>ä»numsé‡Œé¢è¿‡æ»¤å‡ºæ‰€æœ‰å¥‡æ•°ï¼Œå¹¶ç¿»å€è¿™äº›å¥‡æ•°ã€‚</h2><p>è¿™ä¸ªé—®é¢˜ä¹Ÿä¸éš¾æ˜¯å§ï¼Ÿ</p><p>è®©æˆ‘çŒœä¸€ä¸‹ï¼Œä¸€äº›å°‘ä¾ åº”è¯¥ä¼šå†™æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const doubleNums = nums.filter(isOdd).map(double);console.log(doubleNums);</code></pre><h2 id="å¦‚æœæˆ‘ä»¬è¿˜æƒ³ç»§ç»­ç®—å‡ºæ‰€æœ‰å¥‡æ•°ç¿»å€åçš„å’Œçš„è¯"><a href="#å¦‚æœæˆ‘ä»¬è¿˜æƒ³ç»§ç»­ç®—å‡ºæ‰€æœ‰å¥‡æ•°ç¿»å€åçš„å’Œçš„è¯" class="headerlink" title="å¦‚æœæˆ‘ä»¬è¿˜æƒ³ç»§ç»­ç®—å‡ºæ‰€æœ‰å¥‡æ•°ç¿»å€åçš„å’Œçš„è¯"></a>å¦‚æœæˆ‘ä»¬è¿˜æƒ³ç»§ç»­ç®—å‡ºæ‰€æœ‰å¥‡æ•°ç¿»å€åçš„å’Œçš„è¯</h2><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const add = (sum,num) =&gt; sum += num;const doubleNums = nums.filter(isOdd).map(double).reduce(add,0);console.log(doubleNums);</code></pre><p>å—¯ï¼Œä¸€ä¸ªä¸²ä¸€ä¸ªçœ‹èµ·æ¥å¾ˆé…·æ˜¯å§ï¼Ÿ æœ€åçš„ç»“æœä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚</p><p>è¿™æ ·ä¸²èµ·æ¥çš„åæœå°±æ˜¯ï¼Œæˆ‘ä»¬ä¼šéå†3æ¬¡æ•°ç»„ï¼Œfilterçš„æ—¶å€™éå†ä¸€æ¬¡ï¼Œmapçš„æ—¶å€™éå†ä¸€æ¬¡ï¼Œreduceçš„æ—¶å€™å†éå†ä¸€æ¬¡ã€‚</p><p>ç°åœ¨æ•°ç»„åªæœ‰10ä¸ªæ•°å­—ï¼Œå½±å“è¿˜ä¸å¤§ï¼Œä½†æ˜¯å¦‚æœæ˜¯å¾ˆå¤§çš„æ•°ç»„ï¼Œæ¯”å¦‚100ä¸‡ä¸ªæ•°å­—ï¼Œéå†3éçš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šå¤šè®¿é—®<strong>150ä¸‡æ¬¡</strong>ï¼Œ</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœè®©ä½ è‡ªå·±ä»ä¸­é—´å–å‡ºæ‰€æœ‰å¥‡æ•°ï¼Œç¿»å€ï¼Œå¹¶æ±‚å’Œï¼Œä½ ä¼šè§‰å¾—æ€ä¹ˆåšç®€å•ä¸€äº›å‘¢ï¼Ÿ</p><blockquote><p>æ˜¯ä¸æ˜¯è§‰å¾—ä¸‹é¢è¿™æ ·æ‰æ¯”è¾ƒæ­£å¸¸ï¼Ÿ</p></blockquote><ul><li>é¦–å…ˆï¼Œä»ç¬¬ä¸€ä¸ªæ•°å­—å¼€å§‹ï¼Œå¦‚æœå®ƒæ˜¯å¥‡æ•°ï¼Œå°±æ‹¿å‡ºæ¥ï¼Œç¿»å€ï¼Œç„¶åæ‰¾ä¸ªåœ°æ–¹æ”¾èµ·æ¥</li><li>æ¥ç€ï¼Œç»§ç»­çœ‹ç¬¬äºŒä¸ªæ•°å­—ï¼Œå¦‚æœæ˜¯å¶æ•°ï¼Œå°±è·³è¿‡ï¼Œå¦‚æœæ˜¯å¥‡æ•°ï¼Œå°±æ‹¿å‡ºæ¥ï¼Œç¿»å€ï¼Œç„¶åå’Œå¼€å§‹çš„ç¿»å€åçš„å¥‡æ•°åŠ èµ·æ¥ï¼Œæ‰¾ä¸ªåœ°æ–¹æ”¾èµ·æ¥ã€‚</li><li>æ¥ç€çœ‹ç¬¬ä¸‰ä¸ªæ•°å­—ï¼Œä»¥æ­¤ç±»æ¨ï¼Œåªè¦æ˜¯å¥‡æ•°ï¼Œå°±ç¿»å€ï¼Œç„¶åå’Œä¹‹å‰çš„ç»“æœåŠ èµ·æ¥ã€‚</li><li>ç›´åˆ°æˆ‘ä»¬æ‰¾å¯»åˆ°æœ€åä¸€ä¸ªæ•°å­—ï¼Œå°±å¯ä»¥ç®—å‡ºæœ€ç»ˆç»“æœäº†ï¼Œ</li></ul><p>å¦‚æœä½¿ç”¨è¿­ä»£çš„è¯ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·:<br><a id="more"></a></p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const add = (sum,num) =&gt; sum += num;// ä¿å­˜æœ€ç»ˆç»“æœlet result = 0;for (let i =0; i&lt; nums.length; i++){    if(nums[i]%2 != 0){        result = result + nums[i]*2;    }}console.log(result); // 50</code></pre><p>æ²¡é”™ï¼Œé€šå¸¸è¿™æ ·æ‰æ˜¯æ­£å¸¸çš„æ“ä½œã€‚</p><p>ä½†æ˜¯ï¼Œ</p><p>è¿™æ ·çš„ä»£ç ä¸å¤ªæ–¹ä¾¿ï¼Œ</p><p>å°‘ä¾ ä½ è‚¯å®šä¹Ÿä¸æƒ³æ¯æ¬¡éƒ½å†™è¿™ä¹ˆä¸€å¤§å †forå¾ªç¯è¯­å¥å§ï¼Ÿ</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè¯•ç€ç»§ç»­ä¼˜åŒ–ä¸€ä¸‹ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆè¯•ç€ç”¨ä¸€ä¸ªå«åšmagic(é­”æ³•)çš„å‡½æ•°æŠŠè¿™äº›æ­¥éª¤åŒ…è£¹èµ·æ¥:</p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const magic = array =&gt; {    const length = array.length,    let i = 0;    let sum = 0;    for(i, i &lt; length; i++){        if(array[i] % 2 !== 0){            sum = sum + array[i]*2;        }    }    return sum;}console.log(magic(nums)); // 50</code></pre><p>ç°åœ¨çœ‹èµ·æ¥å¥½å¤šäº†ï¼Œä¸è¿‡ï¼Œmagicå†…éƒ¨çš„æ“ä½œçœ‹èµ·æ¥ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œ</p><p>å…¶ä»–å°‘ä¾ çœ‹è§äº†å¯èƒ½å¾ˆéš¾ä¸€çœ¼å°±æ˜ç™½magicå‡½æ•°åœ¨åšä»€ä¹ˆ,</p><p>æˆ‘ä»¬å¯ä»¥è¯•ç€æŠŠé‡Œé¢çš„ä¸€äº›æ­¥éª¤åˆ†æˆæ›´å°çš„å‡½æ•°:</p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const add = (sum,num) =&gt; sum += num;const magic = array =&gt; {    const length = array.length,    let i = 0;    let sum = 0;    for(i, i &lt; length; i++){        if(isOdd(array[i])){            sum = add(sum,double(array[i]));        }    }    return sum;}console.log(magic(nums)); // 50</code></pre><p>ç°åœ¨æ¯”è¾ƒç®€æ´ä¹Ÿæ¯”è¾ƒæ¸…æ™°äº†ï¼Œä¸è¿‡ï¼Œå‡å¦‚æˆ‘ä»¬ç°åœ¨è¦è®¡ç®—æ˜¯å¶æ•°è€Œä¸æ˜¯å¥‡æ•°æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>æˆ–è€…å¦‚æœæ›´å¤æ‚äº›ï¼Œå¦‚æœæ˜¯å¶æ•°ï¼Œå°±åè¿‡æ¥ï¼Œé™¤ä»¥äºŒï¼Œç„¶åæ±‚å’Œï¼Œåˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>éš¾é“æˆ‘ä»¬åˆè¦å¤åˆ¶ä¸€æ¬¡magicå‡½æ•°ï¼Œç„¶åæ”¹åŠ¨forå¾ªç¯é‡Œé¢çš„é€»è¾‘å—ï¼Ÿ</p><p>ä¹Ÿè®¸ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠforå¾ªç¯å†…éƒ¨çš„é€»è¾‘å•ç‹¬æå–æˆä¸€ä¸ªå¤–éƒ¨å‡½æ•°ï¼</p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const isEvent = num =&gt; !isOdd(num)const double = num =&gt; num *2;const part = num =&gt; num /2;const add = (sum,num) =&gt; sum += num;const magic = (array,fn,sum) =&gt; {    const length = array.length,    let i = 0;    for(i, i &lt; length; i++){        sum = magicFriends(sum,array[i])    }    return sum;}function magicFriends(sum,num){    if(isOdd(num)){        sum = add(sum,double(num));    }    return sum ;}console.log(magic(nums,magicFriends,0)); // 50</code></pre><h2 id="æ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»ï¼"><a href="#æ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»ï¼" class="headerlink" title="æ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»ï¼"></a>æ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»ï¼</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç»™ä»£ç é‡Œé¢éƒ¨åˆ†å‡½æ•°å’Œå‚æ•°æ”¹ä¸€ä¸‹åå­—:</p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const isEvent = num =&gt; !isOdd(num)const double = num =&gt; num *2;const part = num =&gt; num /2;const add = (sum,num) =&gt; sum += num;const reduce = (array,reducer,result) =&gt; {    const length = array.length,    let i = 0;    for(i, i &lt; length; i++){        result = reducer(sum,array[i])    }    return result;}consot magicFriends = (sum,num) =&gt;{    if(isOdd(num)){        sum = add(sum,double(num));    }    return sum ;}console.log(reduce(nums,magicFriends,0)); // 50</code></pre><p>æ˜¯ä¸æ˜¯æœ‰ç‚¹çœ¼ç†Ÿäº†ï¼Ÿ æ¥ç€ï¼Œæˆ‘ä»¬æ¢æˆæ•°ç»„è‡ªå¸¦çš„reduceå‡½æ•°:</p><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const isEvent = num =&gt; !isOdd(num)const double = num =&gt; num *2;const part = num =&gt; num /2;const add = (sum,num) =&gt; sum += num;consot magicFriends = (sum,num) =&gt;{    if(isOdd(num)){        sum = add(sum,double(num));    }    return sum ;}console.log(nums.reduce(magicFriends,0)); // 50</code></pre><h2 id="æœ€åå›åˆ°æˆ‘ä»¬ä¸Šé¢çš„é—®é¢˜"><a href="#æœ€åå›åˆ°æˆ‘ä»¬ä¸Šé¢çš„é—®é¢˜" class="headerlink" title="æœ€åå›åˆ°æˆ‘ä»¬ä¸Šé¢çš„é—®é¢˜:"></a>æœ€åå›åˆ°æˆ‘ä»¬ä¸Šé¢çš„é—®é¢˜:</h2><pre><code class="js">const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const add = (sum,num) =&gt; sum += num;const result = nums.reduces((sum,num)=&gt; isOdd(num) ? add(sum,dobule(num) : sum,0));console.log(result); // 50</code></pre><p>è¿™æ¬¡æˆ‘ä»¬ç”¨reduceåªéå†äº†ä¸€æ¬¡æ•°ç»„å°±å®Œæˆäº†ä¹‹å‰çš„æ“ä½œï¼</p><p>ç°åœ¨çŸ¥é“ä¸ºä»€ä¹ˆä¹‹å‰è¦æŠŠreduceå«åšmagic(é­”æ³•)äº†å§ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ä½¿ç”¨ vue + typescript ç¼–å†™é¡µé¢(1)</title>
      <link href="/2019/07/15/Ts/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-vue-typescript-%E7%BC%96%E5%86%99%E9%A1%B5%E9%9D%A2-1/"/>
      <url>/2019/07/15/Ts/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-vue-typescript-%E7%BC%96%E5%86%99%E9%A1%B5%E9%9D%A2-1/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5c662a7de51d4562e71c4277#comment" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="èµ·æ­¥"><a href="#èµ·æ­¥" class="headerlink" title="èµ·æ­¥"></a>èµ·æ­¥</h1><p>ä½¿ç”¨ vue-cli åˆ›å»ºé¡¹ç›®</p><p><code>vue create demo</code> ï¼Œdemoå°±æ˜¯åˆ›å»ºé¡¹ç›®çš„åç§°<br>æç¤ºé€‰æ‹©é¢„è®¾ï¼Œé€‰æ‹© <code>Manually select features</code> å›è½¦ç¡®è®¤<br>é€‰æ‹©<code>typescript</code> <code>vuex</code>  <code>router</code> <code>babel</code> <code>css pre-processors</code>ï¼Œä¸ä½¿ç”¨<code>linter</code>ï¼Œä¸é€‰å•å…ƒæµ‹è¯•æœ‰éœ€è¦å¦è¯´<br>å›è½¦åæŒ‰ç…§éœ€è¦é€‰æ‹©åˆé€‚çš„é€‰é¡¹<br>é€‰æ‹©å®Œæ¯•åå›è½¦ç­‰å¾…èµ„æºå‡†å¤‡</p><h2 id="ç¼–ç å¼€å§‹"><a href="#ç¼–ç å¼€å§‹" class="headerlink" title="ç¼–ç å¼€å§‹"></a>ç¼–ç å¼€å§‹</h2><p>ç†Ÿæ‚‰å‡ ä¸ªvueçš„è£…é¥°å™¨ <code>vue-property-decorator</code></p><p>ä»¥ä¸‹çš„è£…é¥°å™¨çš„åŠŸèƒ½å’ŒåŸjsç¼–å†™çš„åŠŸèƒ½ç›¸åŒ/ç›¸ä¼¼ï¼Œå¯ä»¥å‚ç…§å®˜æ–¹æ–‡æ¡£ç±»æ¯”è§£è¯»ã€‚</p><pre><code class="js">import { Vue, Component, Inject, Provide, Prop, Model, Watch, Emit, Mixins } from &#39;vue-property-decorator&#39;</code></pre><h3 id="1-Vue-å®é™…ä¸Šå°±æ˜¯-Vue-æœ¬èº«-ç»§æ‰¿vueç›¸å…³å±æ€§å’Œå‡½æ•°"><a href="#1-Vue-å®é™…ä¸Šå°±æ˜¯-Vue-æœ¬èº«-ç»§æ‰¿vueç›¸å…³å±æ€§å’Œå‡½æ•°" class="headerlink" title="1. Vue å®é™…ä¸Šå°±æ˜¯ Vue æœ¬èº«,ç»§æ‰¿vueç›¸å…³å±æ€§å’Œå‡½æ•°"></a>1. Vue å®é™…ä¸Šå°±æ˜¯ Vue æœ¬èº«,ç»§æ‰¿vueç›¸å…³å±æ€§å’Œå‡½æ•°</h3><pre><code class="js">class MyComponent extends Vue { }</code></pre><h3 id="2-Component-å£°æ˜æˆä¸€ä¸ªvueçš„ç»„ä»¶å®ä¾‹ï¼Œå¦‚æœä¸ä½¿ç”¨ï¼Œåˆ™ä¸èƒ½å¾—åˆ°ä¸€ä¸ªvueç»„ä»¶"><a href="#2-Component-å£°æ˜æˆä¸€ä¸ªvueçš„ç»„ä»¶å®ä¾‹ï¼Œå¦‚æœä¸ä½¿ç”¨ï¼Œåˆ™ä¸èƒ½å¾—åˆ°ä¸€ä¸ªvueç»„ä»¶" class="headerlink" title="2. @Component å£°æ˜æˆä¸€ä¸ªvueçš„ç»„ä»¶å®ä¾‹ï¼Œå¦‚æœä¸ä½¿ç”¨ï¼Œåˆ™ä¸èƒ½å¾—åˆ°ä¸€ä¸ªvueç»„ä»¶"></a>2. @Component å£°æ˜æˆä¸€ä¸ªvueçš„ç»„ä»¶å®ä¾‹ï¼Œå¦‚æœä¸ä½¿ç”¨ï¼Œåˆ™ä¸èƒ½å¾—åˆ°ä¸€ä¸ªvueç»„ä»¶</h3><p>ç¬¬ä¸€ç§æ–¹å¼ï¼Œä¸éœ€è¦å®šä¹‰é¢å¤–å†…å®¹:</p><pre><code class="js">@Componentclass MyComponent extends Vue { }</code></pre><p>ç¬¬äºŒç§æ–¹å¼ï¼Œå®šä¹‰ç›¸å…³å†…å®¹:</p><pre><code class="js">@Component({    /* è¿™é‡Œå’Œjsç‰ˆæœ¬ç¼–å†™çš„ vue ç»„ä»¶å†…å®¹ç›¸åŒï¼Œ     * å‡¡æ˜¯ä¸èƒ½åœ¨tsé‡Œé¢å®Œæˆçš„éƒ½å¯ä»¥åœ¨è¿™é‡Œå®Œæˆ      * æœ€ç»ˆä¼šè¢«åˆå¹¶åˆ°ä¸€ä¸ªå®ä¾‹ä¸­ã€‚     * åœ¨è¿™é‡Œå®šä¹‰çš„å†…å®¹ï¼Œä¸ä¼šè¢«è¯­æ³•å™¨è·å–åˆ°ï¼Œå› æ­¤å¿…é¡»è¦åŒæ­¥åœ¨classä¸­å£°æ˜     */    data(){        return { myname:&quot;&quot;,age:18 }    }})class MyComponent extends Vue {    private myname:string;    mounted(){        this.myname;            this.age;// è¯­æ³•å™¨æŠ¥é”™ï¼Œå½“å‰ç±»æ‰¾ä¸åˆ°ageå±æ€§    }}</code></pre><h3 id="3-Provide-å‘ä»»æ„å±‚çº§çš„å­ç»„ä»¶æä¾›å¯è®¿é—®çš„å±æ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±æ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°"><a href="#3-Provide-å‘ä»»æ„å±‚çº§çš„å­ç»„ä»¶æä¾›å¯è®¿é—®çš„å±æ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±æ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°" class="headerlink" title="3.@Provide å‘ä»»æ„å±‚çº§çš„å­ç»„ä»¶æä¾›å¯è®¿é—®çš„å±æ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±æ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°"></a>3.@Provide å‘ä»»æ„å±‚çº§çš„å­ç»„ä»¶æä¾›å¯è®¿é—®çš„å±æ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±æ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°</h3><pre><code class="js">@Componentclass ParentComponent extends Vue {     @Provide() private info!:string;    @Provide(&quot;next&quot;) private infoNext!:string;}</code></pre><h3 id="4-Inject-è·å–çˆ¶çº§ç”±Provideæä¾›çš„å±æ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±æ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°ï¼Œå¤šä¸ªçˆ¶çº§æä¾›ç›¸åŒåç§°å±æ€§æ—¶ï¼Œè·å–æœ€è¿‘çˆ¶çº§çš„åç§°å±æ€§"><a href="#4-Inject-è·å–çˆ¶çº§ç”±Provideæä¾›çš„å±æ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±æ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°ï¼Œå¤šä¸ªçˆ¶çº§æä¾›ç›¸åŒåç§°å±æ€§æ—¶ï¼Œè·å–æœ€è¿‘çˆ¶çº§çš„åç§°å±æ€§" class="headerlink" title="4. @Inject è·å–çˆ¶çº§ç”±Provideæä¾›çš„å±æ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±æ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°ï¼Œå¤šä¸ªçˆ¶çº§æä¾›ç›¸åŒåç§°å±æ€§æ—¶ï¼Œè·å–æœ€è¿‘çˆ¶çº§çš„åç§°å±æ€§"></a>4. @Inject è·å–çˆ¶çº§ç”±Provideæä¾›çš„å±æ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±æ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°ï¼Œå¤šä¸ªçˆ¶çº§æä¾›ç›¸åŒåç§°å±æ€§æ—¶ï¼Œè·å–æœ€è¿‘çˆ¶çº§çš„åç§°å±æ€§</h3><pre><code class="js">@Componentclass MyComponent extends Vue {     @Inject() private info!:string;    @Inject(&quot;next&quot;) private infoNext!:string;}</code></pre><h3 id="5-Prop-ç”±æ ‡ç­¾å±æ€§æ³¨å…¥ï¼Œè·å–å¯¹åº”æ ‡ç­¾å±æ€§ä¸Šå€¼-å¯é…ç½®å…·ä½“propå†…å®¹ï¼Œå‚ç…§jsç‰ˆæœ¬propså†…å®¹"><a href="#5-Prop-ç”±æ ‡ç­¾å±æ€§æ³¨å…¥ï¼Œè·å–å¯¹åº”æ ‡ç­¾å±æ€§ä¸Šå€¼-å¯é…ç½®å…·ä½“propå†…å®¹ï¼Œå‚ç…§jsç‰ˆæœ¬propså†…å®¹" class="headerlink" title="5. @Prop ç”±æ ‡ç­¾å±æ€§æ³¨å…¥ï¼Œè·å–å¯¹åº”æ ‡ç­¾å±æ€§ä¸Šå€¼,å¯é…ç½®å…·ä½“propå†…å®¹ï¼Œå‚ç…§jsç‰ˆæœ¬propså†…å®¹"></a>5. @Prop ç”±æ ‡ç­¾å±æ€§æ³¨å…¥ï¼Œè·å–å¯¹åº”æ ‡ç­¾å±æ€§ä¸Šå€¼,å¯é…ç½®å…·ä½“propå†…å®¹ï¼Œå‚ç…§jsç‰ˆæœ¬propså†…å®¹</h3><pre><code class="js">@Componentclass MyComponent extends Vue {    @Prop() age!:number;   @Prop({default:1}) sex!:number;}</code></pre><pre><code class="html">&lt;template&gt;    &lt;MyComponent :age=&quot;16&quot; /&gt;&lt;/template&gt;&lt;script lang=&quot;ts&quot;&gt;  import MyComponent from &#39;./MyComponent.vue&#39;;@Component({    components:{ MyComponent }})class PComponent extends Vue { }&lt;/script&gt;</code></pre><a id="more"></a><h3 id="6-Model-æ˜¯v-modelçš„è£…é¥°å™¨ï¼Œå½“è‡ªå®šä¹‰ç»„ä»¶æƒ³ä½¿ç”¨v-modelæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œé…åˆemitå¯ä»¥åŒå‘ä¼ é€’å±æ€§å€¼"><a href="#6-Model-æ˜¯v-modelçš„è£…é¥°å™¨ï¼Œå½“è‡ªå®šä¹‰ç»„ä»¶æƒ³ä½¿ç”¨v-modelæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œé…åˆemitå¯ä»¥åŒå‘ä¼ é€’å±æ€§å€¼" class="headerlink" title="6. @Model æ˜¯v-modelçš„è£…é¥°å™¨ï¼Œå½“è‡ªå®šä¹‰ç»„ä»¶æƒ³ä½¿ç”¨v-modelæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œé…åˆemitå¯ä»¥åŒå‘ä¼ é€’å±æ€§å€¼"></a>6. @Model æ˜¯v-modelçš„è£…é¥°å™¨ï¼Œå½“è‡ªå®šä¹‰ç»„ä»¶æƒ³ä½¿ç”¨v-modelæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œé…åˆemitå¯ä»¥åŒå‘ä¼ é€’å±æ€§å€¼</h3><pre><code class="html">&lt;template&gt;    &lt;input type=&quot;checkbox&quot; :checked=&quot;checked&quot; @change=&quot;changed&quot;/&gt;&lt;/template&gt;&lt;script lang=&quot;ts&quot;&gt;@Componentclass MyComponent extends Vue {    @Model(&quot;change&quot;) checked!:number;   changed(event:any){ /* è¿™é‡Œæ˜¯å·æ‡’å†™çš„anyï¼Œåœ¨å®é™…é¡¹ç›®ä¸­éœ€è¦é¿å… */       this.$emit(&quot;change&quot;,event.target.value)   }}&lt;/script&gt;</code></pre><pre><code class="html">&lt;template&gt;    &lt;MyComponent :age=&quot;16&quot; v-model=&quot;mycheck&quot; /&gt;&lt;/template&gt;&lt;script lang=&quot;ts&quot;&gt; import MyComponent from &#39;./MyComponent.vue&#39;;@Component({    components:{ MyComponent }})class PComponent extends Vue {    private mycheck:boolean = false;}&lt;/script&gt;</code></pre><h3 id="7-Watch-è§‚å¯ŸæŸä¸ªå±æ€§æ›´æ–°"><a href="#7-Watch-è§‚å¯ŸæŸä¸ªå±æ€§æ›´æ–°" class="headerlink" title="7. @Watch è§‚å¯ŸæŸä¸ªå±æ€§æ›´æ–°"></a>7. @Watch è§‚å¯ŸæŸä¸ªå±æ€§æ›´æ–°</h3><pre><code class="js">@Componentclass MyComponent extends Vue {    @Prop() age!:number;   @Watch(&quot;age&quot;)   ageChange(newVal:number,oldVal:number){       /*ageå±æ€§æ›´æ–°æ—¶ï¼Œå¤„ç†ç›¸å…³å†…å®¹*/   }}</code></pre><h3 id="8-Emit-this-emit-çš„è£…é¥°å™¨-å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œé»˜è®¤ä½¿ç”¨å‡½æ•°åç§°ã€‚æœ‰è¿”å›å€¼æ—¶ï¼Œä½¿ç”¨è¿”å›å€¼ï¼Œæ²¡æœ‰åˆ™ä½¿ç”¨"><a href="#8-Emit-this-emit-çš„è£…é¥°å™¨-å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œé»˜è®¤ä½¿ç”¨å‡½æ•°åç§°ã€‚æœ‰è¿”å›å€¼æ—¶ï¼Œä½¿ç”¨è¿”å›å€¼ï¼Œæ²¡æœ‰åˆ™ä½¿ç”¨" class="headerlink" title="8. @Emit this.$emit çš„è£…é¥°å™¨,å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œé»˜è®¤ä½¿ç”¨å‡½æ•°åç§°ã€‚æœ‰è¿”å›å€¼æ—¶ï¼Œä½¿ç”¨è¿”å›å€¼ï¼Œæ²¡æœ‰åˆ™ä½¿ç”¨"></a>8. @Emit this.$emit çš„è£…é¥°å™¨,å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œé»˜è®¤ä½¿ç”¨å‡½æ•°åç§°ã€‚æœ‰è¿”å›å€¼æ—¶ï¼Œä½¿ç”¨è¿”å›å€¼ï¼Œæ²¡æœ‰åˆ™ä½¿ç”¨</h3><pre><code class="js">@Componentclass MyComponent extends Vue {    private myname = &quot;&quot;;   @Emit()   ageChangeA(){ /* ä»…å‘é€ this.$emit(&#39;ageChangeA&#39;) */   }   @Emit()   ageChangeB(age:number){ /* å‘é€ age  this.$emit(&#39;ageChangeB&#39;,age) */   }   @Emit()   ageChangeC(age:number){  return 1 /* this.$emit(&#39;ageChangeC&#39;,1) å‘é€return ç»“æœ*/ }}</code></pre><h3 id="9-Mixins"><a href="#9-Mixins" class="headerlink" title="9. Mixins"></a>9. Mixins</h3><pre><code class="js">// MyMixin.ts@Componentexport default class MyMixin extends Vue {    /* å¦‚æœä½¿ç”¨private ä¿®é¥°ï¼Œåˆ™ä¸¤ä¸ªç›¸åŒçš„ ç§æœ‰å±æ€§æ··å…¥æ—¶ï¼Œä¼šäº§ç”Ÿå†²çª */   protected myname = &quot;å¼ ä¸‰&quot;;   created(){  /* æ··å…¥å¯¹è±¡æœ‰è‡ªå·±çš„ ç”Ÿå‘½å‘¨æœŸå‡½æ•°*/ }   getMyName(){ console.log(&quot;å¼ ä¸‰æ··å…¥&quot;) }}</code></pre><pre><code class="js">// OtherMixin.ts@Componentexport default class OtherMixin extends Vue {    /* å¦‚æœä½¿ç”¨private ä¿®é¥°ï¼Œåˆ™ä¸¤ä¸ªç›¸åŒçš„ ç§æœ‰å±æ€§æ··å…¥æ—¶ï¼Œä¼šäº§ç”Ÿå†²çª */   protected myname = &quot;æå››&quot;;   created(){  /* æ··å…¥å¯¹è±¡æœ‰è‡ªå·±çš„ ç”Ÿå‘½å‘¨æœŸå‡½æ•°*/ }   getMyName(){ console.log(&quot;æå››æ··å…¥&quot;) }}</code></pre><pre><code class="js">@Componentclass MyComponent extends Mixins(MyMixin,OtherMixin) {    private myname = &quot;&quot;; /* æ··å…¥å¯¹è±¡å·²ç»å®šä¹‰ï¼Œè¿™é‡Œäº§ç”Ÿå±æ€§å†²çª */   mounted(){       this.getMyName() // æå››æ··å…¥   }}</code></pre><h3 id="å¯¹äºcomputedï¼Œä½¿ç”¨-get-æ›¿ä»£"><a href="#å¯¹äºcomputedï¼Œä½¿ç”¨-get-æ›¿ä»£" class="headerlink" title="å¯¹äºcomputedï¼Œä½¿ç”¨ get æ›¿ä»£"></a>å¯¹äºcomputedï¼Œä½¿ç”¨ get æ›¿ä»£</h3><pre><code class="js">@Componentclass MyComponent extends Vue {    private myname = &quot;&quot;; /* æ··å…¥å¯¹è±¡å·²ç»å®šä¹‰ï¼Œè¿™é‡Œäº§ç”Ÿå±æ€§å†²çª */   get upperName(){       return &quot;A&quot; + this.myname   }}</code></pre><p><strong>è£…é¥°å™¨å¯ä»¥å‚ç…§ <a href="https://link.juejin.im/?target=http%3A%2F%2Fnpm.taobao.org%2Fpackage%2Fvue-property-decorator">vue-property-decorator</a></strong></p><ul><li>æ²¡æœ‰filters,æ²¡æœ‰æŒ‡ä»¤ç›¸å…³è£…é¥°å™¨ï¼Œæœ‰éœ€è¦å¯ä»¥åœ¨@Componenté‡Œé¢è¡¥å……ï¼Œæˆ–è€…å¯ä»¥ç›´æ¥å®šä¹‰å‡½æ•°è°ƒç”¨è®¡ç®—è¿”å›å€¼ åœ¨classé‡Œå®šä¹‰çš„å±æ€§å³dataå±æ€§ï¼Œéœ€è¦èµ‹å€¼åˆå§‹å€¼ã€‚</li></ul><h2 id="typescript-æ··ç”¨js"><a href="#typescript-æ··ç”¨js" class="headerlink" title="typescript æ··ç”¨js"></a>typescript æ··ç”¨js</h2><p>å½“æˆ‘ä»¬å¼•ç”¨äº†ä¸€ä¸ªjsç¼–å†™çš„æ¨¡å—æ—¶ä¼šæŠ¥é”™ï¼Œè¿™æ—¶å€™ï¼Œå¦‚æœä¸åœ¨å¼•å…¥çš„indexæ–‡ä»¶é‡Œé¢æ·»åŠ .d.tsæè¿°æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¨¡å—å°±æ²¡æ³•åœ¨è¯­ä¹‰ä¸Šä¸€è‡´é€šè¿‡.</p><h3 id="é€šç”¨å…¼å®¹æ€§è§£å†³æ–¹æ¡ˆ"><a href="#é€šç”¨å…¼å®¹æ€§è§£å†³æ–¹æ¡ˆ" class="headerlink" title="é€šç”¨å…¼å®¹æ€§è§£å†³æ–¹æ¡ˆ"></a>é€šç”¨å…¼å®¹æ€§è§£å†³æ–¹æ¡ˆ</h3><p>å¦‚æœè¿™ä¸ªæ¨¡å—æ˜¯ç”±npmä¸‹è½½çš„ï¼Œå¹¶ä¸”æœ‰@typesç‰ˆæœ¬ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>npm install @types/xx</code>ä¸‹è½½</p><p>å¯æƒœ,å¤§éƒ¨åˆ†éƒ½æ˜¯æ²¡æœ‰ç¼–å†™å£°æ˜æ–‡ä»¶çš„.ä½†æ˜¯åˆéœ€è¦ä½¿ç”¨åˆ°è¿™ä¸ªæ¨¡å—æ—¶,åº”è¯¥æ€ä¹ˆåš.</p><p><strong>è‡ªå®šä¹‰æè¿°æ–‡ä»¶</strong></p><p>åœ¨é¡¹ç›®çš„ã€æ ¹ç›®å½•ã€‘ä¸‹å®šä¹‰ã€æ¨¡å—ç›¸åŒçš„åç§°ã€‘çš„æè¿°æ–‡ä»¶A.d.ts,åœ¨æè¿°æ–‡ä»¶å†…ç¼–å†™æ¨¡å—å£°æ˜æè¿°</p><pre><code class="js">// A.d.tsdeclare module &#39;*&#39;;</code></pre><p>è¿™æ ·å±äºä¸€åŠ³æ°¸é€¸çš„æè¿°,ä½†æ˜¯æ— æ³•æè¿°åˆ°å…·ä½“æ¨¡å—å†…å®¹,å› æ­¤è¿™ç§æ–¹å¼ä»…ä»…å¼•å…¥çš„ç»„ä»¶æ²¡æœ‰ä»»ä½•æ“ä½œæ—¶,æ¯”å¦‚å¼•å…¥çš„æ˜¯ç¬¬ä¸‰æ–¹å¼€å‘çš„vueç»„ä»¶,å¯ä»¥ç”¨è¿™ç§æ–¹å¼å·æ‡’.</p><p><strong>è¯¦ç»†æè¿°æ–‡ä»¶</strong></p><pre><code class="js">// A.d.tsdeclare module  &quot;A&quot; {    // æ·»åŠ å…·ä½“çš„æè¿°å†…å®¹};</code></pre><p>å¯ä»¥ä»è¿™é‡ŒæŸ¥è¯¢åˆ°<a href="http://microsoft.github.io/TypeSearch/" target="_blank" rel="noopener">@type</a>åŒ…æŸ¥è¯¢ï¼Œå·²ç»è¢«ç¼–å†™çš„æ–‡ä»¶å£°æ˜å¯ä»¥ç›´æ¥ä¸‹è½½</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScript çš„å¥½å¤„éƒ½æœ‰å•¥ï¼Ÿå’Œ JavaScript çš„åŒºåˆ«åœ¨å“ªï¼Ÿ</title>
      <link href="/2019/07/04/Ts/TypeScript-%E7%9A%84%E5%A5%BD%E5%A4%84%E9%83%BD%E6%9C%89%E5%95%A5%EF%BC%9F%E5%92%8C-JavaScript-%E7%9A%84%E5%8C%BA%E5%88%AB%E5%9C%A8%E5%93%AA%EF%BC%9F/"/>
      <url>/2019/07/04/Ts/TypeScript-%E7%9A%84%E5%A5%BD%E5%A4%84%E9%83%BD%E6%9C%89%E5%95%A5%EF%BC%9F%E5%92%8C-JavaScript-%E7%9A%84%E5%8C%BA%E5%88%AB%E5%9C%A8%E5%93%AA%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<p><a href="https://zhuanlan.zhihu.com/p/38526585" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><p><strong>åœ¨æˆ‘çœ‹æ¥ TypeScript ç›¸å¯¹äº JavaScript ï¼Œé™¤äº†é™æ€ç±»å‹å¤–æ²¡å¸¦æ¥ä»»ä½•ä¸œè¥¿ã€‚</strong></p><p>æ—¢ç„¶å¦‚æ­¤</p><h2 id="é™æ€ç±»å‹æœ‰ä»€ä¹ˆå¥½å¤„"><a href="#é™æ€ç±»å‹æœ‰ä»€ä¹ˆå¥½å¤„" class="headerlink" title="é™æ€ç±»å‹æœ‰ä»€ä¹ˆå¥½å¤„"></a>é™æ€ç±»å‹æœ‰ä»€ä¹ˆå¥½å¤„</h2><p>é™æ€ç±»å‹çš„å¥½å¤„åˆ°å¤„éƒ½æœ‰è¯´ï¼Œè¿™é‡Œå°±ä¸è¯´å¾—å¤ªè¯¦ç»†äº†ï¼Œéšä¾¿åˆ—ä¸€ç‚¹ã€‚</p><ul><li>æœç»æ‰‹è¯¯å¯¼è‡´çš„å˜é‡åé”™è¯¯</li><li>è‡ªåŠ¨å®Œæˆ</li><li>é‡æ„æ”¯æŒ</li><li>ç±»å‹å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå……å½“æ–‡æ¡£</li></ul><p>é™æ€ç±»å‹è§£æ”¾è„‘å®¹é‡ï¼Œè‡ªåŠ¨å®Œæˆè®©æˆ‘ä¸éœ€è¦è®°å¿†å“ªä¸ªå˜é‡é‡Œæœ‰å“ªäº›å±æ€§ï¼Œä¹Ÿä¸éœ€è¦è®°å®Œæ•´çš„å˜é‡åã€‚</p><p>å‡½æ•°ä¸Šçš„ç±»å‹çº¦æŸå¤–åŠ å°½é‡ä¸»åŠ¨å†™çº¯å‡½æ•°è®©æˆ‘åœ¨å†™å‡½æ•°å®ç°çš„æ—¶å€™ä¸éœ€è¦å…³æ³¨å‡½æ•°ä¹‹å¤–çš„ä»»ä½•ä¸œè¥¿ï¼Œæ³¨æ„åŠ›èšç„¦åœ¨å½“å‰å‡½æ•°ã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿä¸åªæœ‰å¥½å¤„ã€‚</p><h2 id="é™æ€ç±»å‹æœ‰ä»€ä¹ˆä¸è¶³"><a href="#é™æ€ç±»å‹æœ‰ä»€ä¹ˆä¸è¶³" class="headerlink" title="é™æ€ç±»å‹æœ‰ä»€ä¹ˆä¸è¶³"></a>é™æ€ç±»å‹æœ‰ä»€ä¹ˆä¸è¶³</h2><ul><li>ç±»å‹æ ‡æ³¨éº»çƒ¦ã€‚</li><li>ç°é˜¶æ®µå¤§éƒ¨åˆ†é™æ€ç±»å‹è¯­è¨€çš„ç±»å‹ç³»ç»Ÿè¿˜ä¸å¤Ÿå¼ºã€‚</li><li>eval å’Œ new Function() è¿™ç§éªšæ“ä½œç±»å‹ç³»ç»Ÿç®¡ä¸åˆ°ã€‚</li><li>éœ€è¦ç¼–è¯‘ï¼Œç±»å‹æ£€æŸ¥ä¼šå¢åŠ ç¼–è¯‘æ—¶é•¿ï¼Œè¯­æ³•å’Œç±»å‹ç³»ç»Ÿå¤æ‚çš„è¯æ—¶é—´ç‰¹åˆ«ç‰¹åˆ«é•¿ï¼Œæ¯”å¦‚ scalaã€‚</li></ul><p>æ ‡æ³¨éº»çƒ¦çš„é—®é¢˜æ— æ³•æ ¹ç»ï¼Œä½†æ˜¯ç±»å‹æ¨å¯¼èƒ½è§£å†³å¤§éƒ¨åˆ†çš„ç±»å‹æ ‡æ³¨é—®é¢˜ã€‚</p><p>ç±»å‹ç³»ç»Ÿä¸å¤Ÿå¼ºçš„é—®é¢˜ä¼šéšç€æ—¶é—´æ…¢æ…¢å˜å¥½ã€‚</p><p>ç¼–è¯‘çš„é—®é¢˜åœ¨ ts å¯èƒ½ä¹Ÿå¹¶ä¸ç®—é—®é¢˜ï¼Œts çš„ç±»å‹æ£€æŸ¥å¹¶ä¸å½±å“ ts ç¼–è¯‘æˆ jsã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´å°±ç®—ç±»å‹æ£€æŸ¥ä¸é€šè¿‡ ts ä¹Ÿèƒ½è·‘èµ·æ¥ã€‚æ‰€ä»¥å¯¹ ts æ¥è¯´ç±»å‹æ£€æŸ¥å¯ä»¥ä»ç¼–è¯‘ä¸­æå–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„ç¼–è¯‘å’Œç±»å‹æ£€æŸ¥ä¸¤éƒ¨åˆ†ã€‚</p><p>å…ˆç¼–è¯‘è¾“å‡ºï¼Œå†åšç±»å‹æ£€æŸ¥ï¼Œç¼–è¯‘çš„éƒ¨åˆ†ç›¸å½“äº babel è¿™ç§å·¥å…·åšçš„äº‹ã€‚</p><p>ç±»å‹æ£€æŸ¥ä¹Ÿå¯ä»¥å•ç‹¬è¿è¡Œã€‚</p><p>é‚£ä¹ˆï¼Œ</p><h2 id="TypeScript-çš„ç±»å‹ç³»ç»Ÿæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ"><a href="#TypeScript-çš„ç±»å‹ç³»ç»Ÿæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="TypeScript çš„ç±»å‹ç³»ç»Ÿæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ"></a>TypeScript çš„ç±»å‹ç³»ç»Ÿæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ</h2><ul><li><a href="https://link.zhihu.com/?target=https%3A//github.com/Microsoft/TypeScript/issues/14833">å›¾çµå®Œå¤‡</a>ã€‚ï¼ˆè™½ç„¶ä¸å¤ªæ¸…æ¥šè¿™æ„å‘³ç€ä»€ä¹ˆï¼‰</li><li>æ¸è¿›çš„ç±»å‹ç³»ç»Ÿï¼Œæ‰€æœ‰ç±»å‹æ ‡æ³¨éƒ½æ˜¯å¯é€‰çš„ï¼Œæ—¢æ˜¯å¤©ä½¿åˆæ˜¯æ¶é­”çš„ <a href="https://link.zhihu.com/?target=https%3A//github.com/Microsoft/TypeScript/blob/master/doc/spec.md%233.1">any</a> ç±»å‹ã€‚ï¼ˆè¢« Haskell å¤§ç‰› <a href="https://www.zhihu.com/people/axurez" target="_blank" rel="noopener">Colliot</a> ç§°ä¸º ts ç±»å‹ç³»ç»Ÿçš„æ¼æ´ï¼‰</li><li>æ”¯æŒå±€éƒ¨ç±»å‹æ¨å¯¼ã€‚</li><li>ä¸°å¯Œçš„ç±»å‹å±‚é¢çš„è®¡ç®—ï¼Œå¦‚ <a href="https://link.zhihu.com/?target=https%3A//www.typescriptlang.org/docs/handbook/advanced-types.html">index types, mapped types, conditional types</a> ç­‰ç­‰ã€‚</li><li>æ”¯æŒ<a href="">é¸­å­ç±»å‹</a>ã€‚ï¼ˆæˆ–å«ç»“æ„å­ç±»å‹ï¼Ÿï¼‰</li><li>åƒ js æ”¯æŒå¯¹è±¡å­—é¢é‡ä¸€æ ·æ”¯æŒæ–¹ä¾¿çš„å¯¹è±¡å­—é¢ç±»å‹ï¼ˆobject literal typeï¼‰ï¼Œå­—ç¬¦ä¸²å’Œæ•°å­—è¿˜æœ‰å¸ƒå°”å€¼å­—é¢ç±»å‹ã€‚</li><li>ç©ºå®‰å…¨ã€‚</li><li>åŸºäºæ§åˆ¶æµçš„ç±»å‹åˆ†æ</li></ul><p>è¿˜æœ‰è®¸å¤šæˆ‘è§‰å¾—æ¯”è¾ƒå¹³å¸¸çš„ç‚¹å°±æ²¡æœ‰åˆ—å‡ºæ¥ï¼Œæ¯”å¦‚æ”¯æŒç±»å‹åˆ«åï¼Œæ³›å‹ï¼Œåå˜é€†å˜åŒå˜ç­‰ç­‰ã€‚</p><p>ts æ˜¯ä¸€é—¨éå¸¸éå¸¸éå¸¸å·¥ç¨‹çš„è¯­è¨€ï¼Œå¾ˆå¼ºå¤§ï¼Œä½†æ˜¯å¯èƒ½å’Œä¼˜é›…æ²¾ä¸ä¸ŠåŠç‚¹å…³ç³»ã€‚</p><p>å¯é€‰çš„ç±»å‹æ ‡æ³¨æ­é…ç±»å‹æ¨å¯¼ï¼Œè®© ts çš„ç±»å‹ç³»ç»Ÿæ›´åƒæ˜¯å·¥å…·ï¼Œè€Œä¸æ˜¯æ·é”ã€‚å¥½çš„äº§å“æ˜¯ç”¨å®Œå³èµ°çš„ã€‚</p><p>æœ‰æ—¶å€™ï¼Œç¨å¾®å¼€ä¸ªæ´ï¼Œèƒ½è®©äº‹æƒ…å˜ç®€å•å¾ˆå¤šã€‚æ¯”å¦‚ anyã€‚</p><p><code>é¸­å­ç±»å‹</code>åŠ ä¸Šä¸Šé¢æåˆ°çš„ç‰¹æ€§å¯ä»¥è®©ä½ ä¾æ—§æ„Ÿè§‰å’Œ js ä¸€æ ·ï¼Œåƒå¤§æµ·é‡Œçš„é±¼ä¸€æ ·è‡ªç”±ã€‚</p><p><a href="https://link.zhihu.com/?target=https%3A//www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare">Null References: The Billion Dollar Mistake</a> ï¼Œè€Œ js é‡Œæœ‰ä¸¤ä¸ª nullï¼ˆnull å’Œ undefinedï¼‰ï¼Œè™½ç„¶å‰ç«¯é€šå¸¸ä¸ä¼šé€ æˆéå¸¸ä¸¥é‡çš„æŸå¤±ï¼Œä½†æ˜¯ js ä¹Ÿæ…¢æ…¢è¢«åº”ç”¨åˆ°ä¸ä»…ä»…æ˜¯å‰ç«¯çš„è®¸å¤šåœ°æ–¹äº†ã€‚</p><p>ts è¿™ä¹ˆå¥½ï¼Œ</p><h2 id="æ€ä¹ˆå­¦-TypeScriptï¼Ÿ"><a href="#æ€ä¹ˆå­¦-TypeScriptï¼Ÿ" class="headerlink" title="æ€ä¹ˆå­¦ TypeScriptï¼Ÿ"></a>æ€ä¹ˆå­¦ TypeScriptï¼Ÿ</h2><p>æˆä¹Ÿæ¸è¿›ï¼Œè´¥ä¹Ÿæ¸è¿›ï¼Œæœ‰éƒ¨åˆ†äººé€šè¿‡å¯é€‰çš„ç±»å‹æ ‡æ³¨ï¼Œä¸€æ­¥ä¸€æ­¥æ— ç—›åœ°è¿‡æ¸¡åˆ°å­¦ä¼š tsã€‚</p><p>è€Œå¦ä¸€éƒ¨åˆ†äººç©äº†ä¸€ä¼šå„¿ï¼Œå‘ç°å’Œå†™ js å¹¶æ²¡æœ‰ä¸€ä¸ç‚¹åŒºåˆ«ï¼Œè€Œä¸”è¿˜ç¦»å¼€äº†ç†Ÿæ‚‰çš„ç¯å¢ƒï¼Œå°±æ”¾å¼ƒäº†ã€‚</p><p>ts å¹¶ä¸ä¼šå¼ºè¿«ä½ ä½¿ç”¨ç±»å‹ï¼Œæ‰€ä»¥å°±éœ€è¦æ›´å¼ºçš„åŠ¨åŠ›æ¥æ¨åŠ¨è‡ªå·±å­¦ä¹ ã€‚</p><p>å¦‚æœèº«è¾¹æœ‰ä¼š ts çš„æœ‹å‹çš„è¯ï¼Œå¯¹å­¦ä¹  ts ä¼šæ¯”è¾ƒæœ‰å¸®åŠ©ã€‚</p><p>å¤šè®©ä¼š ts çš„æœ‹å‹çœ‹è‡ªå·±çš„ä»£ç ï¼Œæ”¹è‰¯è‡ªå·±çš„å†™æ³•ã€‚å¤šå†™ï¼Œå¾ˆå®¹æ˜“å°±èƒ½å­¦ä¼šã€‚</p><p>å¦‚æœèº«è¾¹æ²¡æœ‰ä¼š ts çš„äººï¼Œå…¶å®æˆ‘æ›´å»ºè®®å…ˆç”¨ <a href="https://github.com/Microsoft/TypeScript/wiki/JSDoc-support-in-JavaScript" target="_blank" rel="noopener">JSDoc</a>ã€‚</p><p>ä½¿ç”¨ vscode æˆ–è€… webstorm çš„æ—¶å€™ç›´æ¥å†™ JSDoc å°±è¡Œäº†ï¼Œvsc æˆ– webstorm ä¼šä¾é  ts æ¥æä¾›ç±»å‹æ¨å¯¼å’Œè‡ªåŠ¨å®Œæˆã€‚</p><p>è¿™æ ·å¯ä»¥åœ¨å·¥ä½œæˆ–è‡ªå·±å†™ä¸œè¥¿çš„æ—¶å€™æ…¢æ…¢ä¹ æƒ¯å¹¶ä¸”ä¸»åŠ¨å»ä½¿ç”¨ç±»å‹æ ‡æ³¨ã€‚</p><p>åœ¨ä½¿ç”¨ä¸€æ®µæ—¶é—´åæ„Ÿè§‰ JSDoc å·²ç»ä¸å¤Ÿç”¨äº†ï¼Œæ»¡è¶³ä¸äº†è‡ªå·±çš„éœ€æ±‚äº†ï¼Œå†å¼€å§‹ä½¿ç”¨ tsã€‚</p><p>åŒæ—¶ä¹Ÿè¦å¤šä¸»åŠ¨å»äº†è§£å’Œå­¦ä¹ ä¸€äº› ts çš„ä»£ç ï¼Œä¸ç„¶çš„è¯ï¼Œä¸çŸ¥é“ ts æœ‰å¤šå¥½ï¼Œè‡ªç„¶å°±ä¸ä¼šè§‰å¾— JSDoc ä¸å¤Ÿç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vueä¸­ä¸å¸¸ç”¨çš„APIçš„ä½¿ç”¨æ–¹æ³•æ€»ç»“</title>
      <link href="/2019/06/13/Vue/vue%E4%B8%AD%E4%B8%8D%E5%B8%B8%E7%94%A8%E7%9A%84API%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/"/>
      <url>/2019/06/13/Vue/vue%E4%B8%AD%E4%B8%8D%E5%B8%B8%E7%94%A8%E7%9A%84API%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="errorHandler"><a href="#errorHandler" class="headerlink" title="errorHandler"></a>errorHandler</h2><p>å®˜ç½‘ä»‹ç»åŠä½¿ç”¨ï¼š</p><p>æŒ‡å®šç»„ä»¶çš„æ¸²æŸ“å’Œè§‚å¯ŸæœŸé—´æœªæ•è·é”™è¯¯çš„å¤„ç†å‡½æ•°ã€‚è¿™ä¸ªå¤„ç†å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå¯è·å–é”™è¯¯ä¿¡æ¯å’Œ Vue å®ä¾‹</p><pre><code class="js">Vue.config.errorHandler = function (err, vm, info) {  //å¤„ç†é”™è¯¯ä¿¡æ¯, è¿›è¡Œé”™è¯¯ä¸ŠæŠ¥  //erré”™è¯¯å¯¹è±¡  //vm Vueå®ä¾‹  //`info` æ˜¯ Vue ç‰¹å®šçš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚é”™è¯¯æ‰€åœ¨çš„ç”Ÿå‘½å‘¨æœŸé’©å­  //åªåœ¨ 2.2.0+ å¯ç”¨}</code></pre><h2 id="Vue-observable-object"><a href="#Vue-observable-object" class="headerlink" title="Vue.observable( object )"></a>Vue.observable( object )</h2><p>è¿™ä¸ªç›¸å½“äºä¸€ä¸ªç®€å•çš„storeç®¡ç†ï¼Œåœ¨ä¸ç”¨vuexçš„æƒ…å†µä¸‹ï¼Œä¸åŒç»„ä»¶ä¹‹é—´é€šä¿¡å¯ä»¥ç”¨<code>Vue.observeable</code></p><p>å®˜ç½‘ä»‹ç»ï¼š</p><p>è®©ä¸€ä¸ªå¯¹è±¡å¯å“åº”ã€‚Vue å†…éƒ¨ä¼šç”¨å®ƒæ¥å¤„ç† data å‡½æ•°è¿”å›çš„å¯¹è±¡ã€‚</p><p>è¿”å›çš„å¯¹è±¡å¯ä»¥ç›´æ¥ç”¨äºæ¸²æŸ“å‡½æ•°å’Œè®¡ç®—å±æ€§å†…ï¼Œå¹¶ä¸”ä¼šåœ¨å‘ç”Ÿæ”¹å˜æ—¶è§¦å‘ç›¸åº”çš„æ›´æ–°ã€‚ä¹Ÿå¯ä»¥ä½œä¸ºæœ€å°åŒ–çš„è·¨ç»„ä»¶çŠ¶æ€å­˜å‚¨å™¨ï¼Œç”¨äºç®€å•çš„åœºæ™¯ï¼š</p><p>ä½¿ç”¨ï¼š</p><p>åœ¨store.jsä¸­</p><pre><code class="js">impor vue from &#39;vue&#39;;export const store = vue.observable({count:0});export const mutation = {    setCount(count){        store.count = count;    }}</code></pre><p>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</p><pre><code class="js">&lt;template&gt;  &lt;div class=&quot;hello&quot;&gt;    &lt;p @click=&quot;setCount(testCount + 1)&quot;&gt;+&lt;/p&gt;    &lt;p @click=&quot;setCount(testCount - 1)&quot;&gt;-&lt;/p&gt;    &lt;test /&gt;    &lt;p&gt;{{testCount}}&lt;/p&gt;  &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import test from &#39;./test&#39;import { store,  mutation} from &#39;@/store&#39;export default {  name: &#39;HelloWorld&#39;,  data () {    return {      msg: &#39;Welcome to Your Vue.js App&#39;    }  },  components: {    test  },  methods: {    setCount: mutation.setCount  },  computed: {    testCount(){      return store.count    }  }}&lt;/script&gt;&lt;!-- Add &quot;scoped&quot; attribute to limit CSS to this component only --&gt;&lt;style scoped&gt;h1, h2 {  font-weight: normal;}ul {  list-style-type: none;  padding: 0;}li {  display: inline-block;  margin: 0 10px;}a {  color: #42b983;}&lt;/style&gt;</code></pre><a id="more"></a><p>test ç»„ä»¶</p><pre><code class="js">&lt;template&gt;  &lt;div&gt;test{{testCount}}&lt;/div&gt;&lt;/template&gt;&lt;script&gt;import { store } from &#39;@/store&#39;;export default {  computed: {    testCount(){      return store.count    }  }}&lt;/script&gt;&lt;style scoped&gt;&lt;/style&gt;</code></pre><h1 id="errorCaptured-2-5-0æ–°å¢çš„ç”Ÿå‘½å‘¨æœŸé’©å­"><a href="#errorCaptured-2-5-0æ–°å¢çš„ç”Ÿå‘½å‘¨æœŸé’©å­" class="headerlink" title="errorCaptured(2.5.0æ–°å¢çš„ç”Ÿå‘½å‘¨æœŸé’©å­)"></a>errorCaptured(2.5.0æ–°å¢çš„ç”Ÿå‘½å‘¨æœŸé’©å­)</h1><p>å®˜ç½‘ä»‹ç»ï¼š</p><p>å½“æ•è·ä¸€ä¸ªæ¥è‡ªå­å­™ç»„ä»¶çš„é”™è¯¯æ—¶è¢«è°ƒç”¨ã€‚æ­¤é’©å­ä¼šæ”¶åˆ°ä¸‰ä¸ªå‚æ•°ï¼šé”™è¯¯å¯¹è±¡ã€å‘ç”Ÿé”™è¯¯çš„ç»„ä»¶å®ä¾‹ä»¥åŠä¸€ä¸ªåŒ…å«é”™è¯¯æ¥æºä¿¡æ¯çš„å­—ç¬¦ä¸²ã€‚æ­¤é’©å­å¯ä»¥è¿”å› false ä»¥é˜»æ­¢è¯¥é”™è¯¯ç»§ç»­å‘ä¸Šä¼ æ’­ã€‚</p><p>ä¸errorhandlerçš„ä¸åŒä¹‹å¤„ï¼š</p><p>errorCaptured å’Œ errorHandler çš„è§¦å‘æ—¶æœºéƒ½æ˜¯ç›¸åŒçš„ï¼Œä¸åŒçš„æ˜¯ errorCaptured å‘ç”Ÿåœ¨å‰ï¼Œä¸”å¦‚æœæŸä¸ªç»„ä»¶çš„ errorCaptured æ–¹æ³•è¿”å›äº† falseï¼Œé‚£ä¹ˆè¿™ä¸ªå¼‚å¸¸ä¿¡æ¯ä¸ä¼šå†å‘ä¸Šå†’æ³¡ä¹Ÿä¸ä¼šå†è°ƒç”¨ errorHandler æ–¹æ³•</p><h1 id="parent"><a href="#parent" class="headerlink" title="parent"></a>parent</h1><p>å®˜ç½‘ä»‹ç»ï¼š</p><p>æŒ‡å®šå·²åˆ›å»ºçš„å®ä¾‹ä¹‹çˆ¶å®ä¾‹ï¼Œåœ¨ä¸¤è€…ä¹‹é—´å»ºç«‹çˆ¶å­å…³ç³»ã€‚å­å®ä¾‹å¯ä»¥ç”¨ this.$parent è®¿é—®çˆ¶å®ä¾‹ï¼Œå­å®ä¾‹è¢«æ¨å…¥çˆ¶å®ä¾‹çš„ $children æ•°ç»„ä¸­ã€‚</p><p>æ³¨æ„:èŠ‚åˆ¶åœ°ä½¿ç”¨ $parent å’Œ $children - å®ƒä»¬çš„ä¸»è¦ç›®çš„æ˜¯ä½œä¸ºè®¿é—®ç»„ä»¶çš„åº”æ€¥æ–¹æ³•ã€‚æ›´æ¨èç”¨ props å’Œ events å®ç°çˆ¶å­ç»„ä»¶é€šä¿¡</p><p>ä½¿ç”¨:</p><pre><code class="js">    this.$parent.xxx() //ç›´æ¥åœ¨å­ç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶ä¸­æ–¹æ³•</code></pre><h1 id="mixin"><a href="#mixin" class="headerlink" title="mixin"></a>mixin</h1><p>å®˜ç½‘ä»‹ç»ï¼š</p><p>mixins é€‰é¡¹æ¥å—ä¸€ä¸ªæ··å…¥å¯¹è±¡çš„æ•°ç»„ã€‚è¿™äº›æ··å…¥å®ä¾‹å¯¹è±¡å¯ä»¥åƒæ­£å¸¸çš„å®ä¾‹å¯¹è±¡ä¸€æ ·åŒ…å«é€‰é¡¹ï¼Œä»–ä»¬å°†åœ¨ Vue.extend() é‡Œæœ€ç»ˆé€‰æ‹©ä½¿ç”¨ç›¸åŒçš„é€‰é¡¹åˆå¹¶é€»è¾‘åˆå¹¶ã€‚ä¸¾ä¾‹ï¼šå¦‚æœä½ çš„æ··å…¥åŒ…å«ä¸€ä¸ªé’©å­è€Œåˆ›å»ºç»„ä»¶æœ¬èº«ä¹Ÿæœ‰ä¸€ä¸ªï¼Œä¸¤ä¸ªå‡½æ•°å°†è¢«è°ƒç”¨ã€‚</p><p>mixinså°±æ˜¯å®šä¹‰ä¸€éƒ¨åˆ†å…¬å…±çš„æ–¹æ³•æˆ–è€…è®¡ç®—å±æ€§,ç„¶åæ··å…¥åˆ°å„ä¸ªç»„ä»¶ä¸­ä½¿ç”¨,æ–¹ä¾¿ç®¡ç†ä¸ç»Ÿä¸€ä¿®æ”¹</p><p>1ã€åœ¨assetsæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªjsæ–‡ä»¶</p><pre><code class="js">// åˆ›å»ºä¸€ä¸ªéœ€è¦æ··å…¥çš„å¯¹è±¡ export const mixinTest1 = {    created() {        this.hello();    },    methods: {        hello() {            console.log(&#39;mixinTest1&#39;);        }    }};</code></pre><p>2ã€åœ¨ç»„ä»¶ä¸­ä½¿ç”¨åˆšåˆšåˆ›å»ºçš„æ··å…¥</p><pre><code class="js">import {mixinTest1} from &#39;./../assets/js/mixin&#39;;export default {    mixins:[mixinTest1],    name: &#39;hello&#39;,    data () {        return {            msg: &#39;Welcome to Your Vue.js App&#39;        }    }}</code></pre><p>3ã€å¦‚æœç»„ä»¶ä¸­å®šä¹‰çš„æ–¹æ³•ä¸æ··å…¥å¯¹è±¡ä¸­çš„æ–¹æ³•/å±æ€§ä¸€æ ·,ç»„ä»¶ä¸­çš„ä¼˜å…ˆçº§å¤§äºæ··å…¥å¯¹è±¡ä¸­çš„(æ–¹æ³•ä¼šè°ƒç”¨å¤šæ¬¡)</p><p>4ã€æ··å…¥å¯¹è±¡ä¸­å¯ä»¥å®šä¹‰æŠ½è±¡æ–¹æ³•,ä½¿ç”¨æ··å…¥çš„ç»„ä»¶å¿…é¡»é‡å†™è¯¥æ–¹æ³•</p><pre><code class="js">...methods: {    handlePlaylist() {        throw new Error(&#39;component must implement handlePlaylist method&#39;)    }}...</code></pre><h1 id="provide-inject"><a href="#provide-inject" class="headerlink" title="provide / inject"></a>provide / inject</h1><p>å®˜ç½‘ä»‹ç»ï¼š</p><p>è¿™å¯¹é€‰é¡¹éœ€è¦ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å…è®¸ä¸€ä¸ªç¥–å…ˆç»„ä»¶å‘å…¶æ‰€æœ‰å­å­™åä»£æ³¨å…¥ä¸€ä¸ªä¾èµ–ï¼Œä¸è®ºç»„ä»¶å±‚æ¬¡æœ‰å¤šæ·±ï¼Œå¹¶åœ¨èµ·ä¸Šä¸‹æ¸¸å…³ç³»æˆç«‹çš„æ—¶é—´é‡Œå§‹ç»ˆç”Ÿæ•ˆã€‚å¦‚æœä½ ç†Ÿæ‚‰ Reactï¼Œè¿™ä¸ React çš„ä¸Šä¸‹æ–‡ç‰¹æ€§å¾ˆç›¸ä¼¼ã€‚</p><p>provide é€‰é¡¹åº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å‡½æ•°ã€‚è¯¥å¯¹è±¡åŒ…å«å¯æ³¨å…¥å…¶å­å­™çš„å±æ€§ã€‚åœ¨è¯¥å¯¹è±¡ä¸­ä½ å¯ä»¥ä½¿ç”¨ ES2015 Symbols ä½œä¸º keyï¼Œä½†æ˜¯åªåœ¨åŸç”Ÿæ”¯æŒ Symbol å’Œ Reflect.ownKeys çš„ç¯å¢ƒä¸‹å¯å·¥ä½œã€‚</p><p>inject é€‰é¡¹åº”è¯¥æ˜¯ï¼š</p><p>ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæˆ–<br>ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„ key æ˜¯æœ¬åœ°çš„ç»‘å®šåï¼Œvalue æ˜¯ï¼š<br>åœ¨å¯ç”¨çš„æ³¨å…¥å†…å®¹ä¸­æœç´¢ç”¨çš„ key (å­—ç¬¦ä¸²æˆ– Symbol)ï¼Œæˆ–<br>ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„ï¼š<br>from å±æ€§æ˜¯åœ¨å¯ç”¨çš„æ³¨å…¥å†…å®¹ä¸­æœç´¢ç”¨çš„ key (å­—ç¬¦ä¸²æˆ– Symbol)<br>default å±æ€§æ˜¯é™çº§æƒ…å†µä¸‹ä½¿ç”¨çš„ value</p><ul><li>æ³¨æ„ï¼šprovide å’Œ inject ä¸»è¦ä¸ºé«˜é˜¶æ’ä»¶/ç»„ä»¶åº“æä¾›ç”¨ä¾‹ã€‚å¹¶ä¸æ¨èç›´æ¥ç”¨äºåº”ç”¨ç¨‹åºä»£ç ä¸­ã€‚</li></ul><p>æˆ‘ä¹‹å‰ä½¿ç”¨åˆ°<code>provide / inject</code>æ˜¯<strong>æ¨¡æ‹Ÿé¡µé¢æ•°æ®å›åˆ°åˆå§‹çŠ¶æ€</strong>ï¼Œç›¸å½“äºåˆ·æ–°å½“å‰é¡µé¢ï¼Œä½†æ˜¯ç›´æ¥åˆ·æ–°å½“å‰é¡µé¢ä¼šæœ‰å‡ ç§’çš„ç©ºç™½æœŸï¼Œä½“éªŒä¸å¥½ï¼Œæ‰€ä»¥ç”¨åˆ°äº†<code>provide / inject</code></p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><p>1.ä¿®æ”¹App.vueä»£ç å¦‚ä¸‹å›¾æ‰€ç¤º</p><pre><code class="js">&lt;template&gt;    &lt;div id=&quot;app&quot;&gt;        &lt;router-view v-if=&quot;isRouterActive&quot;/&gt;    &lt;/div&gt;&lt;/template&gt;&lt;script&gt;    export default{        name: &#39;App&#39;,        provide:{            retrun{                reload:this.reload            }        },        data(){            return{                isRouterActive: true            }        },        methods:{            reload(){                this.isRouterActive = false;                this.$nextTick(()=&gt;{                     this.isRouterActive = true;                })            }        }    }&lt;/script&gt;</code></pre><p>é€šè¿‡å£°æ˜reloadæ–¹æ³•ï¼Œæ§åˆ¶isRouterAliceå±æ€§true or false æ¥æ§åˆ¶router-viewçš„æ˜¾ç¤ºæˆ–éšè—ï¼Œä»è€Œæ§åˆ¶é¡µé¢çš„å†æ¬¡åŠ è½½</p><p>2.åœ¨éœ€è¦å½“å‰é¡µé¢åˆ·æ–°çš„é¡µé¢ä¸­æ³¨å…¥App.vueç»„ä»¶æä¾›ï¼ˆprovideï¼‰çš„ reload ä¾èµ–ï¼Œç„¶åç›´æ¥ç”¨this.reloadæ¥è°ƒç”¨å°±è¡Œ</p><pre><code class="js">export defalut{    inject:[&#39;reload&#39;],    data(){        return{        }    },    methods:{        reloadPage(){            this.reload();        }    }}</code></pre><h1 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a>keep-alive</h1><p>å®˜ç½‘ä»‹ç»ï¼š</p><p><code>&lt;keep-alive&gt;</code> åŒ…è£¹åŠ¨æ€ç»„ä»¶æ—¶ï¼Œä¼šç¼“å­˜ä¸æ´»åŠ¨çš„ç»„ä»¶å®ä¾‹ï¼Œè€Œä¸æ˜¯é”€æ¯å®ƒä»¬ã€‚å’Œ <code>&lt;transition&gt;</code> ç›¸ä¼¼ï¼Œ<code>&lt;keep-alive&gt;</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç»„ä»¶ï¼šå®ƒè‡ªèº«ä¸ä¼šæ¸²æŸ“ä¸€ä¸ª DOM å…ƒç´ ï¼Œä¹Ÿä¸ä¼šå‡ºç°åœ¨çˆ¶ç»„ä»¶é“¾ä¸­ã€‚</p><p>å½“ç»„ä»¶åœ¨ <code>&lt;keep-alive&gt;</code> å†…è¢«åˆ‡æ¢ï¼Œå®ƒçš„ activated å’Œ deactivated è¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°å°†ä¼šè¢«å¯¹åº”æ‰§è¡Œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScript é«˜çº§æŠ€å·§</title>
      <link href="/2019/06/12/Ts/TypeScript-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7/"/>
      <url>/2019/06/12/Ts/TypeScript-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5cffb431f265da1b7401f466?utm_source=gold_browser_extension" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç”¨äº†ä¸€æ®µæ—¶é—´çš„ typescript ä¹‹åï¼Œæ·±æ„Ÿä¸­å¤§å‹é¡¹ç›®ä¸­ typescript çš„å¿…è¦æ€§ï¼Œå®ƒèƒ½å¤Ÿæå‰åœ¨ç¼–è¯‘æœŸé¿å…è®¸å¤š bugï¼Œå¦‚å¾ˆæ¶å¿ƒçš„æ‹¼å†™é—®é¢˜ã€‚è€Œè¶Šæ¥è¶Šå¤šçš„ package ä¹Ÿå¼€å§‹ä½¿ç”¨ tsï¼Œå­¦ä¹  ts å·²æ˜¯åŠ¿åœ¨å¿…è¡Œã€‚</p><h2 id="01-keyof"><a href="#01-keyof" class="headerlink" title="01 keyof"></a>01 keyof</h2><p><code>keyof</code> ä¸ <code>Object.keys</code> ç•¥æœ‰ç›¸ä¼¼ï¼Œåªä¸è¿‡ <code>keyof</code> å– <code>interface</code> çš„é”®ã€‚</p><pre><code class="js">interface Point {    x: number;    y: number;}// type keys = &quot;x&quot; | &quot;y&quot;type keys = keyof Point;</code></pre><p>å‡è®¾æœ‰ä¸€ä¸ª <code>object</code> å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ typescript å®ç°ä¸€ä¸ª get å‡½æ•°æ¥è·å–å®ƒçš„å±æ€§å€¼</p><pre><code class="js">const data = {  a: 3,  hello: &#39;world&#39;}function get(o: object, name: string) {  return o[name]}</code></pre><p>æˆ‘ä»¬åˆšå¼€å§‹å¯èƒ½ä¼šè¿™ä¹ˆå†™ï¼Œä¸è¿‡å®ƒæœ‰å¾ˆå¤šç¼ºç‚¹<br>1.æ— æ³•ç¡®è®¤è¿”å›ç±»å‹ï¼šè¿™å°†æŸå¤± ts æœ€å¤§çš„ç±»å‹æ ¡éªŒåŠŸèƒ½<br>2.æ— æ³•å¯¹ key åšçº¦æŸï¼šå¯èƒ½ä¼šçŠ¯æ‹¼å†™é”™è¯¯çš„é—®é¢˜</p><p>è¿™æ—¶å¯ä»¥ä½¿ç”¨ <code>keyof</code> æ¥åŠ å¼º <code>get</code> å‡½æ•°çš„ç±»å‹åŠŸèƒ½ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥çœ‹çœ‹ <code>_.get</code> çš„ <code>type</code> æ ‡è®°ä»¥åŠå®ç°</p><pre><code class="js">function get&lt;T extends object, K extends keyof T&gt;(o: T, name: K): T[K] {  return o[name]}</code></pre><h2 id="02-Partial-amp-Pick"><a href="#02-Partial-amp-Pick" class="headerlink" title="02 Partial &amp; Pick"></a>02 Partial &amp; Pick</h2><p>æ—¢ç„¶äº†è§£äº† <code>keyof</code>ï¼Œå¯ä»¥ä½¿ç”¨å®ƒå¯¹å±æ€§åšä¸€äº›æ‰©å±•ï¼Œ å¦‚å®ç° <code>Partial</code> å’Œ <code>Pick</code>ï¼Œ<code>Pick</code> ä¸€èˆ¬ç”¨åœ¨ <code>_.pick</code> ä¸­</p><pre><code class="js">type Partial&lt;T&gt; = {  [P in keyof T]?: T[P];};type Pick&lt;T, K extends keyof T&gt; = {  [P in K]: T[P];};interface User {  id: number;  age: number;  name: string;};// ç›¸å½“äº: type PartialUser = { id?: number; age?: number; name?: string; }type PartialUser = Partial&lt;User&gt;// ç›¸å½“äº: type PickUser = { id: number; age: number; }type PickUser = Pick&lt;User, &quot;id&quot; | &quot;age&quot;&gt;</code></pre><h2 id="03-Condition-Type"><a href="#03-Condition-Type" class="headerlink" title="03 Condition Type"></a>03 Condition Type</h2><p>ç±»ä¼¼äº js ä¸­çš„ <code>?:</code> è¿ç®—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ‰©å±•ä¸€äº›åŸºæœ¬ç±»å‹</p><pre><code class="js">T extends U ? X : Ytype isTrue&lt;T&gt; = T extends true ? true : false// ç›¸å½“äº type t = falsetype t = isTrue&lt;number&gt;// ç›¸å½“äº type t = falsetype t1 = isTrue&lt;false&gt;</code></pre><h2 id="04-never-amp-Exclude-amp-Omit"><a href="#04-never-amp-Exclude-amp-Omit" class="headerlink" title="04 never &amp; Exclude &amp; Omit"></a>04 never &amp; Exclude &amp; Omit</h2><p>å®˜æ–¹æ–‡æ¡£å¯¹ <code>never</code> çš„æè¿°å¦‚ä¸‹</p><blockquote><p>the never type represents the type of values that never occur.</p></blockquote><p>ç»“åˆ <code>never</code> ä¸ <code>conditional type</code> å¯ä»¥æ¨å‡ºå¾ˆå¤šæœ‰æ„æ€è€Œä¸”å®ç”¨çš„ç±»å‹ï¼Œæ¯”å¦‚ <code>Omit</code></p><pre><code class="js">type Exclude&lt;T, U&gt; = T extends U ? never : T;// ç›¸å½“äº: type A = &#39;a&#39;type A = Exclude&lt;&#39;x&#39; | &#39;a&#39;, &#39;x&#39; | &#39;y&#39; | &#39;z&#39;&gt;</code></pre><a id="more"></a><p>ç»“åˆ <code>Exclude</code> å¯ä»¥æ¨å‡º <code>Omit</code> çš„å†™æ³•</p><pre><code class="js">type Omit&lt;T, K extends keyof any&gt; = Pick&lt;T, Exclude&lt;keyof T, K&gt;&gt;;interface User {  id: number;  age: number;  name: string;};// ç›¸å½“äº: type PickUser = { age: number; name: string; }type OmitUser = Omit&lt;User, &quot;id&quot;&gt;</code></pre><h2 id="05-typeof"><a href="#05-typeof" class="headerlink" title="05 typeof"></a>05 typeof</h2><p>é¡¾åæ€ä¹‰ï¼Œ<code>typeof</code> ä»£è¡¨å–æŸä¸ªå€¼çš„ <code>type</code>ï¼Œå¯ä»¥ä»ä»¥ä¸‹ç¤ºä¾‹æ¥å±•ç¤ºä»–ä»¬çš„ç”¨æ³•</p><pre><code class="js">const a: number = 3// ç›¸å½“äº: const b: number = 4const b: typeof a = 4</code></pre><p>åœ¨ä¸€ä¸ªå…¸å‹çš„æœåŠ¡ç«¯é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æŠŠä¸€äº›å·¥å…·å¡åˆ° <code>context</code> ä¸­ï¼Œå¦‚<code>config</code>ï¼Œ<code>logger</code>ï¼Œ<code>db models</code>, <code>utils</code> ç­‰ï¼Œæ­¤æ—¶å°±ä½¿ç”¨åˆ° <code>typeof</code>ã€‚</p><pre><code class="js">import logger from &#39;./logger&#39;import utils from &#39;./utils&#39;interface Context extends KoaContect {  logger: typeof logger,  utils: typeof utils}app.use((ctx: Context) =&gt; {  ctx.logger.info(&#39;hello, world&#39;)  // ä¼šæŠ¥é”™ï¼Œå› ä¸º logger.ts ä¸­æ²¡æœ‰æš´éœ²æ­¤æ–¹æ³•ï¼Œå¯ä»¥æœ€å¤§é™åº¦çš„é¿å…æ‹¼å†™é”™è¯¯  ctx.loger.info(&#39;hello, world&#39;)})</code></pre><h2 id="06-is"><a href="#06-is" class="headerlink" title="06 is"></a>06 is</h2><p>åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸ª koa çš„é”™è¯¯å¤„ç†æµç¨‹ï¼Œä»¥ä¸‹æ˜¯å¯¹ error è¿›è¡Œé›†ä¸­å¤„ç†ï¼Œå¹¶ä¸”æ ‡è¯† code çš„è¿‡ç¨‹</p><pre><code class="js">app.use(async (ctx, next) =&gt; {  try {    await next();  } catch (err) {    let code = &#39;BAD_REQUEST&#39;    if (err.isAxiosError) {      code = `Axios-${err.code}`    } else if (err instanceof Sequelize.BaseError) {    }    ctx.body = {      code    }  }})</code></pre><p>åœ¨ <code>err.code</code> å¤„ï¼Œä¼šç¼–è¯‘å‡ºé”™ï¼Œæç¤º Property â€˜codeâ€™ does not exist on type â€˜Errorâ€™.ts(2339)ã€‚</p><p>æ­¤æ—¶å¯ä»¥ä½¿ç”¨ <code>as AxiosError</code> æˆ–è€… <code>as any</code> æ¥é¿å…æŠ¥é”™ï¼Œä¸è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢ä¹Ÿä¸å¤Ÿå‹å¥½</p><pre><code class="js">if ((err as AxiosError).isAxiosError) {  code = `Axios-${(err as AxiosError).code}`}</code></pre><p>æ­¤æ—¶å¯ä»¥ä½¿ç”¨ is æ¥åˆ¤å®šå€¼çš„ç±»å‹</p><pre><code class="js">function isAxiosError (error: any): error is AxiosError {  return error.isAxiosError}if (isAxiosError(err)) {  code = `Axios-${err.code}`}</code></pre><p>åœ¨ <code>GraphQL</code> çš„æºç ä¸­ï¼Œæœ‰å¾ˆå¤šè¯¸å¦‚æ­¤ç±»çš„ç”¨æ³•ï¼Œç”¨ä»¥æ ‡è¯†ç±»å‹</p><pre><code class="js">export function isType(type: any): type is GraphQLType;export function isScalarType(type: any): type is GraphQLScalarType;export function isObjectType(type: any): type is GraphQLObjectType;export function isInterfaceType(type: any): type is GraphQLInterfaceType;</code></pre><h2 id="07-interface-amp-type"><a href="#07-interface-amp-type" class="headerlink" title="07 interface &amp; type"></a>07 interface &amp; type</h2><p>interface ä¸ type çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿå¯ä»¥å‚è€ƒä»¥ä¸‹ stackoverflow çš„é—®é¢˜</p><p><a href="https://stackoverflow.com/questions/37233735/typescript-interfaces-vs-types" target="_blank" rel="noopener">https://stackoverflow.com/questions/37233735/typescript-interfaces-vs-types</a></p><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<code>1</code>interface<code>ä¸</code>type` åŒºåˆ«å¾ˆå°ï¼Œæ¯”å¦‚ä»¥ä¸‹ä¸¤ç§å†™æ³•å·®ä¸å¤š</p><pre><code class="js">interface A {  a: number;  b: number;};type B {  a: number;  b: number;}</code></pre><p>å…¶ä¸­ interface å¯ä»¥å¦‚ä¸‹åˆå¹¶å¤šä¸ªï¼Œè€Œ type åªèƒ½ä½¿ç”¨ &amp; ç±»è¿›è¡Œè¿æ¥ã€‚</p><pre><code class="js">interface A {    a: number;}interface A {    b: number;}const a: A = {    a: 3,    b: 4}</code></pre><h2 id="08-Dictionary-amp-Many"><a href="#08-Dictionary-amp-Many" class="headerlink" title="08 Dictionary &amp; Many"></a>08 Dictionary &amp; Many</h2><p>è¿™å‡ ä¸ªè¯­æ³•ç³–æ˜¯ä» <code>lodash</code> çš„ <code>types</code> æºç ä¸­å­¦åˆ°çš„ï¼Œå¹³æ—¶å·¥ä½œä¸­çš„ä½¿ç”¨é¢‘ç‡è¿˜æŒºé«˜ã€‚</p><pre><code class="js">interface Dictionary&lt;T&gt; {  [index: string]: T;};interface NumericDictionary&lt;T&gt; {  [index: number]: T;};const data:Dictionary&lt;number&gt; = {  a: 3,  b: 4}</code></pre><h2 id="09-ä½¿ç”¨-const-enum-ç»´æŠ¤å¸¸é‡è¡¨"><a href="#09-ä½¿ç”¨-const-enum-ç»´æŠ¤å¸¸é‡è¡¨" class="headerlink" title="09 ä½¿ç”¨ const enum ç»´æŠ¤å¸¸é‡è¡¨"></a>09 ä½¿ç”¨ const enum ç»´æŠ¤å¸¸é‡è¡¨</h2><p>ç›¸æ¯”ä½¿ç”¨å­—é¢é‡å¯¹è±¡ç»´æŠ¤å¸¸é‡ï¼Œconst enum å¯ä»¥æä¾›æ›´å®‰å…¨çš„ç±»å‹æ£€æŸ¥</p><pre><code class="js">// ä½¿ç”¨ object ç»´æŠ¤å¸¸é‡const enum TODO_STATUS {    TODO = &#39;TODO&#39;,    DONE = &#39;DONE&#39;,    DOING = &#39;DOING&#39;}</code></pre><pre><code class="js">// ä½¿ç”¨ const enum ä¼Ÿåå¸¸é‡const enum TODO_STATUS {    TODO = &#39;TODO&#39;,    DONE = &#39;DONE&#39;,    DOING = &#39;DOING&#39;}function todos (status: TODO_STATUS): Todo[];todos(TODO_STATUS.TODO)</code></pre><h2 id="10-VS-Code-Tips-amp-Typescript-Command"><a href="#10-VS-Code-Tips-amp-Typescript-Command" class="headerlink" title="10 VS Code Tips &amp; Typescript Command"></a>10 VS Code Tips &amp; Typescript Command</h2><p>ä½¿ç”¨ VS Code æœ‰æ—¶ä¼šå‡ºç°ï¼Œä½¿ç”¨ tsc ç¼–è¯‘æ—¶äº§ç”Ÿçš„é—®é¢˜ä¸ vs code æç¤ºçš„é—®é¢˜ä¸ä¸€è‡´</p><p>æ‰¾åˆ°é¡¹ç›®å³ä¸‹è§’çš„ Typescript å­—æ ·ï¼Œå³ä¾§æ˜¾ç¤ºå®ƒçš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥ç‚¹å‡»é€‰æ‹© Use Workspace Versionï¼Œå®ƒè¡¨ç¤ºä¸é¡¹ç›®ä¾èµ–çš„ typescript ç‰ˆæœ¬ä¸€ç›´ã€‚</p><p>æˆ–è€…ç¼–è¾‘ <code>.vs-code/settings.json</code></p><pre><code class="js">{  &quot;typescript.tsdk&quot;: &quot;node_modules/typescript/lib&quot;}</code></pre><h2 id="11-Typescript-Roadmap"><a href="#11-Typescript-Roadmap" class="headerlink" title="11 Typescript Roadmap"></a>11 Typescript Roadmap</h2><p>æœ€åä¸€æ¡ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ¡ï¼Œç¿»é˜… Roadmapï¼Œäº†è§£ ts çš„ä¸€äº›æ–°çš„ç‰¹æ€§ä¸ bug ä¿®å¤æƒ…å†µã€‚</p><p><a href="https://github.com/Microsoft/TypeScript/wiki/Roadmap" target="_blank" rel="noopener">Typescript Roadmap</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (åå››) --Nodeé¡¹ç›®-å•†å“åˆ—è¡¨</title>
      <link href="/2019/05/25/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81%E5%9B%9B)%20--Node%E9%A1%B9%E7%9B%AE-%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8/"/>
      <url>/2019/05/25/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81%E5%9B%9B)%20--Node%E9%A1%B9%E7%9B%AE-%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="Node-jsé¡¹ç›®ä»‹ç»"><a href="#Node-jsé¡¹ç›®ä»‹ç»" class="headerlink" title="Node.jsé¡¹ç›®ä»‹ç»"></a>Node.jsé¡¹ç›®ä»‹ç»</h1><p>åˆ©ç”¨å­¦åˆ°çš„çŸ¥è¯†ï¼Œå®ç°ä¸€ä¸ªç®€å•ä½†å®ç”¨çš„å°é¡¹ç›®å¦‚ä¸‹ï¼š</p><p>è¿™æ˜¯ä¸€ä¸ªå•†å“åˆ—è¡¨ï¼Œå…·æœ‰å±•ç¤ºå•†å“ä¿¡æ¯ï¼Œæ·»åŠ å•†å“ï¼Œåˆ é™¤å•†å“çš„åŠŸèƒ½ã€‚</p><h2 id="é¡¹ç›®çš„æ–‡ä»¶å¤¹ç»“æ„"><a href="#é¡¹ç›®çš„æ–‡ä»¶å¤¹ç»“æ„" class="headerlink" title="é¡¹ç›®çš„æ–‡ä»¶å¤¹ç»“æ„"></a>é¡¹ç›®çš„æ–‡ä»¶å¤¹ç»“æ„</h2><p>â”œâ”€â”€ package.json<br>â”œâ”€â”€ server.js # æœåŠ¡å™¨ä»£ç <br>â”œâ”€â”€ config # é¡¹ç›®é…ç½®æ–‡ä»¶å¤¹<br>â”‚     â”œâ”€â”€ config.dev.js # å¼€å‘ç¯å¢ƒé…ç½®<br>â”‚     â”œâ”€â”€ config.prod.js # ç”Ÿäº§ç¯å¢ƒé…ç½®<br>â”‚     â”œâ”€â”€ index.js # å¯¼å‡ºå½“å‰æ‰€å¤„ç¯å¢ƒåŠé…ç½®<br>â”œâ”€â”€ libs # é¡¹ç›®å·¥å…·æ–‡ä»¶å¤¹<br>â”‚     â”œâ”€â”€ database.js # è¿æ¥æ•°æ®åº“<br>â”‚     â”œâ”€â”€ http.js # æœåŠ¡å™¨é…ç½®<br>â”‚     â”œâ”€â”€ router.js # å¤„ç†è·¯ç”±<br>â”œâ”€â”€ router # é¡¹ç›®è·¯ç”±é…ç½®æ–‡ä»¶å¤¹<br>â”‚     â”œâ”€â”€ index.js # è¿æ¥æ•°æ®åº“<br>â”‚     â”œâ”€â”€ list.js # è·å–å•†å“åˆ—è¡¨æ¥å£é…ç½®<br>â”‚     â”œâ”€â”€ add.js # å¢åŠ å•†å“æ¥å£é…ç½®<br>â”‚     â”œâ”€â”€ del.js # åˆ é™¤å•†å“æ¥å£é…ç½®<br>â”œâ”€â”€ static # é™æ€èµ„æºæ–‡ä»¶å¤¹<br>â”‚     â”œâ”€â”€ index.html # å‰ç«¯HTMLé¡µé¢<br>â”‚     â”œâ”€â”€ js # å‰ç«¯JavaScriptæ–‡ä»¶å¤¹<br>â”‚     â”œâ”€â”€ css # å‰ç«¯CSSæ–‡ä»¶å¤¹<br>â”‚     â”œâ”€â”€ fonts # å‰ç«¯å­—ä½“æ–‡ä»¶å¤¹<br>â”‚     â”œâ”€â”€ upload # å‰ç«¯ä¸Šä¼ æ–‡ä»¶å¤¹</p><h2 id="åˆ¤æ–­å½“å‰æ‰€å¤„ç¯å¢ƒ"><a href="#åˆ¤æ–­å½“å‰æ‰€å¤„ç¯å¢ƒ" class="headerlink" title="åˆ¤æ–­å½“å‰æ‰€å¤„ç¯å¢ƒ"></a>åˆ¤æ–­å½“å‰æ‰€å¤„ç¯å¢ƒ</h2><p>é€šå¸¸é¡¹ç›®åœ¨å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒè¦é‡‡ç”¨ä¸åŒçš„ï¼ŒæœåŠ¡å™¨ã€è´¦å·ã€åŸŸåã€ç«¯å£ç­‰é…ç½®ï¼Œå¦‚æœç”¨äººå·¥è¿›è¡Œåˆ‡æ¢æ“ä½œéº»çƒ¦ä¸”å®¹æ˜“å‡ºé”™ï¼Œå› æ­¤é€šå¸¸ä½¿ç”¨ç¯å¢ƒå˜é‡è¿›è¡Œåˆ¤æ–­ã€‚</p><p>é¦–å…ˆå¼•å…¥processæ¨¡å—<code>const process=require(&#39;process&#39;)</code>ï¼Œè¯¥æ¨¡å—æä¾›äº†å½“å‰Node.jsè¿›ç¨‹çš„ä¿¡æ¯ã€‚</p><p>1.å¯ä»¥é€šè¿‡process.envç¯å¢ƒå˜é‡è·å–å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒç³»ç»Ÿç­‰å‚æ•°å·®å¼‚ï¼Œå¦‚å¼€å‘ç¯å¢ƒè¿è¡Œåœ¨Windowsç³»ç»Ÿä¸Šï¼Œè€Œç”Ÿäº§ç¯å¢ƒè¿è¡Œåœ¨Linuxç³»ç»Ÿï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨<code>process.env.OS === &#39;Windows_NT&#39;</code>åˆ¤æ–­å½“å‰æ‰€å¤„çš„æ˜¯å¦å¼€å‘ç¯å¢ƒã€‚</p><pre><code class="js">const mode = process.env.OS === &#39;Windows_NT&#39; ? &#39;env&#39; : &#39;prod&#39;</code></pre><p>2.ä¹Ÿå¯ä»¥é€šè¿‡package.jsonä¸­é…ç½®çš„å¯åŠ¨å‘½ä»¤åˆ¤æ–­å¤„äºå¼€å‘è¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œå¦‚å¼€å‘ç¯å¢ƒå‘½ä»¤<code>npm start --dev</code>å’Œç”Ÿäº§ç¯å¢ƒå‘½ä»¤<code>npm run build --build</code>ã€‚</p><pre><code class="js">const mode = process.argv[2] === &#39;--dev&#39; ? &#39;env&#39; : &#39;prod&#39;</code></pre><h2 id="åˆå§‹åŒ–å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒé…ç½®"><a href="#åˆå§‹åŒ–å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒé…ç½®" class="headerlink" title="åˆå§‹åŒ–å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒé…ç½®"></a>åˆå§‹åŒ–å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒé…ç½®</h2><p>åœ¨/config/index.jsä¸­ï¼Œåˆ¤æ–­æ‰€å¤„çš„ç¯å¢ƒï¼Œå¹¶å°†ç›¸åº”ç¯å¢ƒçš„æ ‡è¯†å’Œå‚æ•°ä½œä¸ºæ¨¡å—å¯¼å‡ºã€‚å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç›´æ¥å¼•ç”¨ç›¸åº”çš„é…ç½®ä½¿ç”¨ã€‚</p><pre><code class="js">const process = require(&#39;process&#39;)// å¯ä»¥é€šè¿‡å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒç³»ç»Ÿç­‰å‚æ•°å·®å¼‚ï¼Œåˆ¤æ–­å¤„äºå“ªä¸ªç¯å¢ƒã€‚// const mode = process.env.OS === &#39;Windows_NT&#39; ? &#39;env&#39; : &#39;prod&#39;// ä¹Ÿå¯ä»¥é€šè¿‡package.jsonä¸­é…ç½®çš„å¯åŠ¨å‘½ä»¤åˆ¤æ–­å¤„äºå¼€å‘è¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒã€‚const mode = process.argv[2] === &#39;--dev&#39; ? &#39;env&#39; : &#39;prod&#39;module.exports = {  mode, // å½“å‰æ‰€å¤„ç¯å¢ƒ  ...(mode === &#39;env&#39; ? require(&#39;./config.dev&#39;) : require(&#39;./config.prod&#39;))  // å½“å‰ç¯å¢ƒçš„é…ç½®}</code></pre><p>1.ä»¥å¼€å‘ç¯å¢ƒä¸ºä¾‹ï¼Œéœ€è¦ä½¿ç”¨çš„é…ç½®ä¸ºæœåŠ¡å™¨åŸŸåã€ç«¯å£å·ã€è´¦å·ã€å¯†ç ã€æ•°æ®åº“åï¼Œä»¥åŠHTTPç«¯å£ã€é™æ€æ–‡ä»¶ç»å¯¹è·¯å¾„ã€ä¸Šä¼ æ–‡ä»¶ä¿å­˜ç»å¯¹è·¯å¾„ï¼Œå¦‚ä¸‹ï¼š</p><pre><code class="js">module.exports = {  // æ•°æ®åº“é…ç½®  DB_HOST: &#39;localhost&#39;,  DB_PORT: 3306,  DB_USER: &#39;root&#39;,  DB_PASS: &#39;&#39;,  DB_NAME: &#39;test&#39;,  // HTTPç«¯å£  HTTP_PORT: 8080,  // é™æ€æ–‡ä»¶ç»å¯¹è·¯å¾„  HTTP_ROOT: path.resolve(__dirname, &#39;../static/&#39;),  // ä¸Šä¼ æ–‡ä»¶ä¿å­˜ç»å¯¹è·¯å¾„  HTTP_UPLOAD: path.resolve(__dirname, &#39;../static/upload&#39;)}</code></pre><h2 id="è¿æ¥æ•°æ®åº“"><a href="#è¿æ¥æ•°æ®åº“" class="headerlink" title="è¿æ¥æ•°æ®åº“"></a>è¿æ¥æ•°æ®åº“</h2><p>åœ¨libæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºdatabase.jsï¼Œç”¨äºè¿æ¥æ•°æ®åº“ã€‚</p><a id="more"></a><pre><code class="js">// å¼•å…¥mysqlå’Œco-mysqlï¼Œç”¨äºè¿æ¥æ•°æ®åº“const mysql = require(&#39;mysql&#39;)const coMysql = require(&#39;co-mysql&#39;)// å¼•å…¥æ•°æ®åº“é…ç½®const {  DB_HOST,  DB_PORT,  DB_USER,  DB_PASS,  DB_NAME} = require(&#39;../config&#39;)// 1. åˆ›å»ºæœåŠ¡å™¨è¿æ¥æ± const pool = mysql.createPool({  host: DB_HOST,  port: DB_PORT,  user: DB_USER,  password: DB_PASS,  database: DB_NAME})// 2. ä½¿ç”¨co-mysqlåŒ…è£…è¿æ¥æ± ï¼Œå°†è¿æ¥è½¬æ¢ä¸ºAsync/Awaitå¼‚æ­¥æ–¹å¼const connection = coMysql(pool)// 3. ä½œä¸ºæ¨¡å—å¯¼å‡ºä½¿ç”¨module.exports = connection</code></pre><p>åˆ›å»ºæ•°æ®åº“è¿æ¥åï¼Œå¯ä»¥åœ¨server.jsä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œå¹¶æŸ¥çœ‹item_tableè¡¨çš„æ•°æ®</p><pre><code class="js">const connection = require(&#39;./lib/database&#39;);(async () =&gt; {  // æŸ¥è¯¢item_tableè¡¨ä¸­çš„æ•°æ®  const response = await connection.query(`SELECT * FROM item_table`)  console.log(response)})()</code></pre><p>è‹¥æ­£å¸¸è¿æ¥ï¼Œå³å¯æ‰“å°æ•°æ®å¦‚ä¸‹ï¼š</p><pre><code class="js">[ RowDataPacket { ID: 1, title: &#39;è¿åŠ¨æœ&#39;, price: 299, count: 998 } ]ice: 199, count: 999 },  RowDataPacket { ID: 2, title: &#39;è¿åŠ¨è£¤&#39;, price: 299, count: 998 } ]</code></pre><h2 id="åˆ›å»ºè·¯ç”±"><a href="#åˆ›å»ºè·¯ç”±" class="headerlink" title="åˆ›å»ºè·¯ç”±"></a>åˆ›å»ºè·¯ç”±</h2><p>åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯è¦é€šè¿‡if elseè¯­å¥æ¥åˆ¤æ–­è¯·æ±‚çš„æ¥å£è·¯å¾„ï¼Œå¹¶è¿›è¡Œç›¸åº”æ“ä½œã€‚</p><p>è¿™æ ·ä¼šæå¤§åœ°é™ä½å¼€å‘æ•ˆç‡ï¼Œä¹Ÿä¸åˆ©äºåæœŸä»£ç ç»´æŠ¤ã€‚</p><p>å› æ­¤ï¼Œé€šå¸¸çš„å¼€å‘ä¸­ï¼Œéƒ½ä¼šä½¿ç”¨è·¯ç”±å¯¹ä¸åŒçš„æ¥å£è¿›è¡Œæ“ä½œã€‚</p><p>ç°åœ¨æˆ‘ä»¬å°±æ¥è‡ªå·±å®ç°ä¸€ä¸ªç®€å•çš„è·¯ç”±ï¼š</p><p><strong>1.å…ˆåˆ›å»ºä¸€ä¸ªrouterå¯¹è±¡ï¼Œç”¨äºå­˜å‚¨è·¯ç”±è¡¨ã€‚å…¶ä¸­æœ‰2ä¸ªå±æ€§ï¼Œåˆ†åˆ«ä¸ºgetã€postï¼Œåˆ†åˆ«ç”¨äºå­˜å‚¨ç›¸åº”getã€postè¯·æ±‚åœ°å€çš„å›è°ƒæ–¹æ³•</strong></p><pre><code class="js">// åˆ›å»ºè·¯ç”±è¡¨let router = {  // å­˜å‚¨getè¯·æ±‚çš„è·¯ç”±  get: {  },  // å­˜å‚¨postè¯·æ±‚çš„è·¯ç”±  post: {  }}</code></pre><p><strong>2. åˆ›å»ºä¸€ä¸ªaddRouteræ–¹æ³•ï¼Œç”¨äºæ·»åŠ è·¯ç”±é…ç½®ï¼Œå‚æ•°methodä¸ºè¯·æ±‚æ–¹æ³•ï¼Œurlä¸ºè¯·æ±‚åœ°å€ï¼Œcallbackä¸ºå¤„ç†è¯¥è¯·æ±‚çš„å›è°ƒå‡½æ•°ã€‚</strong></p><pre><code class="js">// æ·»åŠ è·¯ç”±çš„æ–¹æ³•ï¼Œmethodä¸ºè¯·æ±‚æ–¹æ³•ï¼Œurlä¸ºè¯·æ±‚åœ°å€ï¼Œcallbackä¸ºå¤„ç†è¯¥è¯·æ±‚çš„å›è°ƒå‡½æ•°function addRouter(method, url, callback) {  // ä¸ºä¾¿äºå¤„ç†ï¼Œå°†methodå’Œurlç»Ÿä¸€è½¬æ¢æˆå°å†™  method = method.toLowerCase()  url = url.toLowerCase()  // å°†å¤„ç†è¯·æ±‚çš„å›è°ƒå‡½æ•°ï¼ŒæŒ‰æ–¹æ³•åå’Œåœ°å€å‚¨å­˜åˆ°è·¯ç”±è¡¨ä¸­  router[method][url] = callback}</code></pre><p><strong>3. åˆ›å»ºä¸€ä¸ªfindRouteræ–¹æ³•ï¼Œç”¨äºæŸ¥æ‰¾ç›¸åº”è·¯ç”±çš„å›è°ƒå‡½æ•°ã€‚å‚æ•°methodä¸ºè¯·æ±‚æ–¹æ³•ï¼Œurlä¸ºè¯·æ±‚åœ°å€ï¼Œè¿”å›å¤„ç†è·¯ç”±çš„å›è°ƒå‡½æ•°ã€‚</strong></p><pre><code class="js">// æŸ¥æ‰¾å¤„ç†è¯·æ±‚çš„å›è°ƒå‡½æ•°çš„æ–¹æ³•ï¼Œmethodä¸ºè¯·æ±‚æ–¹æ³•ï¼Œurlä¸ºè¯·æ±‚åœ°å€ï¼Œè¿”å›å¤„ç†è·¯ç”±çš„å›è°ƒå‡½æ•°function findRouter(method, url) {  // ä¸ºä¾¿äºå¤„ç†ï¼Œå°†methodå’Œurlç»Ÿä¸€è½¬æ¢æˆå°å†™  method = method.toLowerCase()  url = url.toLowerCase()  // æ‰¾åˆ°è·¯ç”±å¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œä¸å­˜åœ¨åˆ™é»˜è®¤è¿”å›null  const callback = router[method][url] || null  // å°†å›è°ƒå‡½æ•°è¿”å›  return callback}</code></pre><p><strong>4. å°†è·¯ç”±é…ç½®ä½œä¸ºæ¨¡å—å¯¼å‡º</strong></p><pre><code class="js">// å°†æ·»åŠ è·¯ç”±å’ŒæŸ¥æ‰¾è·¯ç”±æ–¹æ³•å¯¼å‡ºmodule.exports = {  addRouter,  findRouter}</code></pre><h2 id="åˆ›å»ºæœåŠ¡å™¨"><a href="#åˆ›å»ºæœåŠ¡å™¨" class="headerlink" title="åˆ›å»ºæœåŠ¡å™¨"></a>åˆ›å»ºæœåŠ¡å™¨</h2><p>åœ¨å®ç°äº†è·¯ç”±ä¹‹åï¼Œå°±å¯ä»¥ä»¥æ­¤ä¸ºåŸºç¡€å®ç°æœåŠ¡å™¨äº†ã€‚</p><p>å®ç°æœåŠ¡å™¨åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><p>1.å¼•å…¥æ‰€éœ€Node.jsæ¨¡å—ã€æœåŠ¡å™¨é…ç½®ã€è·¯ç”±æ¨¡å—<br>2.å°è£…ç»Ÿä¸€å¤„ç†è¯·æ±‚æ•°æ®çš„æ–¹æ³•<br>3.æ¥æ”¶åˆ°çš„è¯·æ±‚åˆ†ä¸ºPOSTè¯·æ±‚ã€GETè¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç†<br>4.POSTè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç†<br>5.GETè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€è¯»å–æ–‡ä»¶è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç†</p><p>æ¥ä¸‹æ¥ï¼ŒæŒ‰æ­¥éª¤å®ç°æ¯éƒ¨åˆ†ä»£ç ã€‚</p><p><strong>1. å¼•å…¥æ‰€éœ€Node.jsæ¨¡å—ã€æœåŠ¡å™¨é…ç½®ã€è·¯ç”±æ¨¡å—</strong></p><pre><code class="js">// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—const http = require(&#39;http&#39;)const url = require(&#39;url&#39;)const querystring = require(&#39;querystring&#39;)const zlib = require(&#39;zlib&#39;)const fs = require(&#39;fs&#39;)const { Form } = require(&#39;multiparty&#39;)// å¼•å…¥æœåŠ¡å™¨é…ç½®const {  HTTP_PORT,  HTTP_ROOT,  HTTP_UPLOAD} = require(&#39;../config&#39;)// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•const { findRouter } = require(&#39;./router&#39;)const server = http.createServer((req, res) =&gt; {  // æœåŠ¡å™¨ä»£ç })// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at ${HTTP_PORT}`)</code></pre><p><strong>2. å°è£…ç»Ÿä¸€å¤„ç†è¯·æ±‚æ•°æ®çš„æ–¹æ³•</strong></p><p>è¦å¤„ç†æ‰€æœ‰è¯·æ±‚æ¥å£ï¼Œéœ€è¦çš„å‚æ•°ä¸ºmethodï¼ˆè¯·æ±‚æ–¹æ³•ï¼‰ã€pathnameï¼ˆè¯·æ±‚æ¥å£è·¯å¾„ï¼‰ã€queryï¼ˆqueryæ•°æ®ï¼‰ã€postï¼ˆpostæ•°æ®ï¼‰ã€filesï¼ˆæ–‡ä»¶æ•°æ®ï¼‰ã€‚</p><p>é¦–å…ˆï¼Œæ ¹æ®methodï¼ˆè¯·æ±‚æ–¹æ³•ï¼‰ã€pathnameï¼ˆè¯·æ±‚æ¥å£è·¯å¾„ï¼‰ï¼Œè·å–åœ¨è·¯ç”±é…ç½®æ—¶ï¼Œå·²ç»é…ç½®å¥½çš„ç›¸åº”æ¥å£çš„å›è°ƒå‡½æ•°ã€‚<br>å…¶æ¬¡ï¼Œè‹¥å›è°ƒå‡½æ•°å­˜åœ¨ï¼Œåˆ™ç›´æ¥å°†å‚æ•°ä¼ å…¥å›è°ƒå‡½æ•°å¤„ç†ã€‚<br>æœ€åï¼Œè‹¥å›è°ƒå‡½æ•°ä¸å­˜åœ¨ï¼Œåˆ™é»˜è®¤ä¸ºè¯·æ±‚ä¸€ä¸ªé™æ€æ–‡ä»¶ï¼Œå³å¯å°†æ–‡ä»¶è¯»å–ä¹‹åå‘é€ç»™å‰ç«¯ã€‚</p><pre><code class="js">// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—...// å¼•å…¥æœåŠ¡å™¨é…ç½®...// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•...const server = http.createServer((req, res) =&gt; {  // é€šè¿‡è·¯ç”±å¤„ç†è¯·æ±‚æ•°æ®çš„å…¬å…±æ–¹æ³•  async function processData(method, pathname, query, post, files) {    const callback = findRouter(method, pathname)  // è·å–å¤„ç†è¯·æ±‚çš„å›è°ƒå‡½æ•°    // è‹¥å›è°ƒå‡½æ•°å­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºè·¯ç”±æœ‰é…ç½®ç›¸åº”çš„æ•°æ®å¤„ç†ï¼Œå³è¯¥è¯·æ±‚ä¸æ˜¯è·å–é™æ€æ–‡ä»¶ã€‚    if (callback) {      try {        // æ ¹æ®è·¯ç”±å¤„ç†æ¥å£æ•°æ®        await callback(res, query, post, files)      } catch (error) {        // å‡ºç°é”™è¯¯çš„å¤„ç†        res.writeHead(500)        res.write(&#39;Internal Server Error&#39;)        res.end()      }    } else {      // è‹¥å›è°ƒå‡½æ•°ä¸å­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºè¯¥è¯·æ±‚ä¸ºè¯·æ±‚ä¸€ä¸ªé™æ€æ–‡ä»¶ï¼Œå¦‚htmlã€cssã€jsç­‰      ...    }  }})// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at ${HTTP_PORT}`)</code></pre><p><strong>3. æ¥æ”¶åˆ°çš„è¯·æ±‚åˆ†ä¸ºPOSTè¯·æ±‚ã€GETè¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç†</strong></p><p>æ ¹æ®è¯·æ±‚çš„methodï¼Œå°†è¯·æ±‚åˆ†ä¸ºPOSTè¯·æ±‚ã€GETè¯·æ±‚ã€‚</p><p>è‹¥ä¸ºPOSTè¯·æ±‚ï¼Œåˆ™éœ€è¦è¿›ä¸€æ­¥åˆ¤æ–­æ˜¯æ™®é€šæ•°æ®è¯·æ±‚ï¼Œè¿˜æ˜¯æ–‡ä»¶è¯·æ±‚ï¼Œå¹¶åˆ†åˆ«è¿›è¡Œå¤„ç†ã€‚</p><p>è€ŒGETè¯·æ±‚ï¼Œåªéœ€è¦å°†æ•°æ®ä¼ å…¥processDataæ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œåœ¨processDataæ–¹æ³•ä¸­ï¼ŒåŒºåˆ†GETè¯·æ±‚è·å–æ•°æ®ï¼Œè¿˜æ˜¯è·å–é™æ€æ–‡ä»¶ã€‚</p><pre><code class="js">// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—...// å¼•å…¥æœåŠ¡å™¨é…ç½®...// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•...const server = http.createServer((req, res) =&gt; {  // è§£æè¯·æ±‚æ•°æ®  // è·å–è¯·æ±‚è·¯å¾„åŠqueryæ•°æ®  const method = req.method  const {    pathname,    query  } = url.parse(req.url, true)  // å¤„ç†POSTè¯·æ±‚  if (method === &#39;POST&#39;) {    // POSTè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç†    ...  } else {  // å¤„ç†GETè¯·æ±‚    // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯GETè¯·æ±‚ï¼Œåªæœ‰queryæ•°æ®    processData(method, url, query, {}, {})  }  // é€šè¿‡è·¯ç”±å¤„ç†è¯·æ±‚æ•°æ®çš„å…¬å…±æ–¹æ³•  async function processData(method, pathname, query, post, files) {    ...  }})// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at ${HTTP_PORT}`)</code></pre><p><strong>4. POSTè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç†</strong></p><p>åˆ¤æ–­è¯·æ±‚å¤´çš„content-typeä¸º<code>application/x-www-form-urlencoded</code>æ—¶ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚åªæ˜¯å•çº¯ä¼ è¾“æ•°æ®ï¼Œå¯ä»¥ç›´æ¥å½“åšå­—ç¬¦ä¸²å¤„ç†ã€‚<br>è‹¥è¯·æ±‚å¤´çš„content-typeä¸å¯¹ï¼Œåˆ™è¡¨ç¤ºè¯¥è¯·æ±‚æ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Œå¯ä»¥ç”¨multipartyè¿›è¡Œå¤„ç†ã€‚</p><pre><code class="js">// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—...// å¼•å…¥æœåŠ¡å™¨é…ç½®...// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•...const server = http.createServer((req, res) =&gt; {  // è§£æè¯·æ±‚æ•°æ®  // è·å–è¯·æ±‚è·¯å¾„åŠqueryæ•°æ®  const method = req.method  const {    pathname,    query  } = url.parse(req.url, true)  // å¤„ç†POSTè¯·æ±‚  if (method === &#39;POST&#39;) {    // æ ¹æ®è¯·æ±‚å¤´çš„content-typeå±æ€§å€¼ï¼ŒåŒºåˆ†æ˜¯æ™®é€šPOSTè¯·æ±‚ï¼Œè¿˜æ˜¯æ–‡ä»¶è¯·æ±‚ã€‚    // content-typeä¸ºapplication/x-www-form-urlencodedæ—¶ï¼Œè¡¨ç¤ºæ˜¯æ™®é€šPOSTè¯·æ±‚    // æ™®é€šPOSTè¯·æ±‚ç›´æ¥è¿›è¡Œå¤„ç†ï¼Œæ–‡ä»¶è¯·æ±‚ä½¿ç”¨multipartyå¤„ç†    if (req.headers[&#39;content-type&#39;].startsWith(&#39;application/x-www-form-urlencoded&#39;)) {      // æ™®é€šPOSTè¯·æ±‚      let arr = []  // å­˜å‚¨Bufferæ•°æ®      // æ¥æ”¶æ•°æ®      req.on(&#39;data&#39;, (buffer) =&gt; {        arr.push(buffer)      })      // æ•°æ®æ¥æ”¶å®Œæˆ      req.on(&#39;end&#39;, () =&gt; {        const data = Buffer.concat(arr)  // åˆå¹¶æ¥æ”¶åˆ°çš„æ•°æ®        const post = querystring.parse(data.toString()) // å°†æ¥æ”¶åˆ°çš„æ•°æ®è½¬æ¢ä¸ºJSON        // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯æ™®é€šPOSTè¯·æ±‚ï¼Œä¸å­˜åœ¨æ–‡ä»¶æ•°æ®        processData(method, pathname, query, post, {})      })    } else {      // æ–‡ä»¶POSTè¯·æ±‚      const form = new Form({        uploadDir: HTTP_UPLOAD  // æŒ‡å®šæ–‡ä»¶å­˜å‚¨ç›®å½•      })      // å¤„ç†è¯·æ±‚æ•°æ®      form.parse(req)      let post = {} // å­˜å‚¨æ•°æ®å‚æ•°      let files = {}  // å­˜å‚¨æ–‡ä»¶æ•°æ®      // é€šè¿‡fieldäº‹ä»¶å¤„ç†æ™®é€šæ•°æ®      form.on(&#39;field&#39;, (name, value) =&gt; {        post[name] = value      })      // é€šè¿‡fileæ—¶é—´å¤„ç†æ–‡ä»¶æ•°æ®      form.on(&#39;file&#39;, (name, file) =&gt; {        files[name] = file      })      // å¤„ç†é”™è¯¯      form.on(&#39;error&#39;, (error) =&gt; {        console.error(error)      })      // æ•°æ®ä¼ è¾“å®Œæˆæ—¶ï¼Œè§¦å‘closeäº‹ä»¶      form.on(&#39;close&#39;, () =&gt; {        // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯POSTæ–‡ä»¶è¯·æ±‚ï¼Œqueryã€postã€filesæ•°æ®éƒ½å­˜åœ¨        processData(method, pathname, query, post, files)      })    }  } else {  // å¤„ç†GETè¯·æ±‚    // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯GETè¯·æ±‚ï¼Œåªæœ‰queryæ•°æ®    processData(method, url, query, {}, {})  }  // é€šè¿‡è·¯ç”±å¤„ç†è¯·æ±‚æ•°æ®çš„å…¬å…±æ–¹æ³•  async function processData(method, pathname, query, post, files) {    ...  }})// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at ${HTTP_PORT}`)</code></pre><p><strong>5. GETè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€è¯»å–æ–‡ä»¶è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç†</strong></p><p>GETè¯·æ±‚å¯ä»¥ç›´æ¥ç”¨<code>processData</code>æ–¹æ³•ç»Ÿä¸€å¤„ç†ï¼Œè‹¥è·¯ç”±ä¸­æœªé…ç½®å¤„ç†æ•°æ®çš„æ–¹æ³•ï¼Œåˆ™è¡¨ç¤ºè¯¥è¯·æ±‚ä¸ºè·å–é™æ€æ–‡ä»¶ï¼Œéœ€è¦è¿›è¡Œå•ç‹¬å¤„ç†ï¼Œå¦åˆ™åªéœ€è¦è°ƒç”¨è·¯ç”±é…ç½®çš„å›è°ƒå‡½æ•°å¤„ç†å³å¯ã€‚</p><pre><code class="js">// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—...// å¼•å…¥æœåŠ¡å™¨é…ç½®...// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•...const server = http.createServer((req, res) =&gt; {  // è§£æè¯·æ±‚æ•°æ®  // è·å–è¯·æ±‚è·¯å¾„åŠqueryæ•°æ®  const method = req.method  const {    pathname,    query  } = url.parse(req.url, true)  // å¤„ç†POSTè¯·æ±‚  if (method === &#39;POST&#39;) {    ...  } else {  // å¤„ç†GETè¯·æ±‚    // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯GETè¯·æ±‚ï¼Œåªæœ‰queryæ•°æ®    processData(method, url, query, {}, {})  }  // é€šè¿‡è·¯ç”±å¤„ç†è¯·æ±‚æ•°æ®çš„å…¬å…±æ–¹æ³•  async function processData(method, pathname, query, post, files) {    const callback = findRouter(method, pathname)  // è·å–å¤„ç†è¯·æ±‚çš„å›è°ƒå‡½æ•°    // è‹¥å›è°ƒå‡½æ•°å­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºè·¯ç”±æœ‰é…ç½®ç›¸åº”çš„æ•°æ®å¤„ç†ï¼Œå³è¯¥è¯·æ±‚ä¸æ˜¯è·å–é™æ€æ–‡ä»¶ã€‚    if (callback) {      try {        // æ ¹æ®è·¯ç”±å¤„ç†æ¥å£æ•°æ®        await callback(res, query, post, files)      } catch (error) {        // å‡ºç°é”™è¯¯çš„å¤„ç†        res.writeHead(500)        res.write(&#39;Internal Server Error&#39;)        res.end()      }    } else {      // è‹¥å›è°ƒå‡½æ•°ä¸å­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºè¯¥è¯·æ±‚ä¸ºè¯·æ±‚ä¸€ä¸ªé™æ€æ–‡ä»¶ï¼Œå¦‚htmlã€cssã€jsç­‰      const filePath = HTTP_ROOT + pathname      // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨      fs.stat(filePath, (error, stat) =&gt; {        if (error) {          // å‡ºç°é”™è¯¯è¡¨ç¤ºæ–‡ä»¶ä¸å­˜åœ¨          res.writeHead(404)          res.write(&#39;Not Found&#39;)          res.end()        } else {          // æ–‡ä»¶å­˜åœ¨åˆ™è¿›è¡Œè¯»å–          // åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚          const readStream = fs.createReadStream(filePath)          // åˆ›å»ºä¸€ä¸ªGzipå¯¹è±¡ï¼Œç”¨äºå°†æ–‡ä»¶å‹ç¼©æˆ          const gz = zlib.createGzip()          // å‘æµè§ˆå™¨å‘é€ç»è¿‡gzipå‹ç¼©çš„æ–‡ä»¶ï¼Œè®¾ç½®å“åº”å¤´ï¼Œå¦åˆ™æµè§ˆå™¨æ— æ³•è¯†åˆ«ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œä¸‹è½½ã€‚          res.setHeader(&#39;content-encoding&#39;, &#39;gzip&#39;)          // å°†è¯»å–çš„å†…å®¹ï¼Œé€šè¿‡gzipå‹ç¼©ä¹‹åï¼Œåœ¨é€šè¿‡ç®¡é“æ¨é€åˆ°resä¸­ï¼Œç”±äºresç»§æ‰¿è‡ªStreamæµï¼Œå› æ­¤ä¹Ÿå¯ä»¥æ¥æ”¶ç®¡é“çš„æ¨é€ã€‚          readStream.pipe(gz).pipe(res)          readStream.on(&#39;error&#39;, (error) =&gt; {            console.error(error)          })        }      })    }  }})// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at ${HTTP_PORT}`)</code></pre><h2 id="æµ‹è¯•æœåŠ¡å™¨"><a href="#æµ‹è¯•æœåŠ¡å™¨" class="headerlink" title="æµ‹è¯•æœåŠ¡å™¨"></a>æµ‹è¯•æœåŠ¡å™¨</h2><p>åœ¨server.jsä¸­å¼•å…¥å°è£…çš„httpæ¨¡å—ï¼š</p><pre><code class="js">const http = require(&#39;./lib/http&#39;)</code></pre><p>å†ä½¿ç”¨node server.jså¯åŠ¨æœåŠ¡å™¨ï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®<code>http://localhost:8080/index.html</code>ï¼Œçœ‹åˆ°htmlé¡µé¢</p><h2 id="æ·»åŠ å„æ¥å£è·¯ç”±é…ç½®"><a href="#æ·»åŠ å„æ¥å£è·¯ç”±é…ç½®" class="headerlink" title="æ·»åŠ å„æ¥å£è·¯ç”±é…ç½®"></a>æ·»åŠ å„æ¥å£è·¯ç”±é…ç½®</h2><p>è·å–å•†å“åˆ—è¡¨è·¯ç”±å›è°ƒå‡½æ•°</p><p>æŸ¥è¯¢<code>item_table</code>è¡¨ä¸­çš„å•†å“æ•°æ®åï¼Œè¿”å›ç»™å‰å°ï¼Œå¹¶å°†å›è°ƒå‡½æ•°ä½œä¸ºæ¨¡å—å¯¼å‡ºã€‚</p><pre><code class="js">const connection = require(&#39;../lib/database&#39;)module.exports = async (res, query, post, files) =&gt; {  try {    // æŸ¥è¯¢å•†å“åˆ—è¡¨    const data = await connection.query(`SELECT * FROM item_table`)    res.writeJson({      error: 0, // errorä¸º0åˆ™è¡¨ç¤ºæ¥å£æ­£å¸¸      data  // æŸ¥è¯¢åˆ°çš„å•†å“åˆ—è¡¨æ•°æ®    })  } catch (error) {    console.error(error)    res.writeJson({      error: 1, // errorä¸º1åˆ™è¡¨ç¤ºæ¥å£å‡ºé”™      msg: &#39;æ•°æ®åº“å‡ºé”™&#39; // æ¥å£çš„é”™è¯¯ä¿¡æ¯    })  }  res.end()}</code></pre><h3 id="æ·»åŠ å•†å“è·¯ç”±å›è°ƒå‡½æ•°"><a href="#æ·»åŠ å•†å“è·¯ç”±å›è°ƒå‡½æ•°" class="headerlink" title="æ·»åŠ å•†å“è·¯ç”±å›è°ƒå‡½æ•°"></a>æ·»åŠ å•†å“è·¯ç”±å›è°ƒå‡½æ•°</h3><p>åº”ç¦æ­¢queryè¯­å¥ä½¿ç”¨å¦‚ä¸‹å†™æ³•ï¼Œå®¹æ˜“é€ æˆæ³¨å…¥æ”»å‡»ã€‚<br><code>connection.query(INSERT INTO item_table (title, price, count) VALUES(&#39;${title}, ${price} ${count}&#39;))</code><br>æ­¤æ—¶è‹¥ç”¨æˆ·ä¼ å…¥å‚æ•°å¦‚ä¸‹ï¼š</p><p><code>http://localhost:8080/add?title=a&#39;)%3B%20DELETE%20FROM%20item_table%3B%20SELECT%20(1&amp;price=19.8&amp;count=200</code></p><p>å°±ä¼šè®©æœåŠ¡å™¨æ‰§è¡Œä¸€ä¸ªè¿™æ ·çš„è¯­å¥ï¼š</p><pre><code class="js">INSERT INTO item_table (title, price, count) VALUES(&#39;a&#39;); DELETE FROM item_table; SELECT (&#39;1&#39;, 19.8, 200)</code></pre><p>å…¶æ„ä¹‰ä¸ºï¼š</p><p>1.æ’å…¥ä¸€ä¸ªè™šå‡æ•°æ®<br>2.åˆ é™¤item_tableè¡¨ä¸­æ‰€æœ‰æ•°æ®<br>3.è¿”å›ä¸€ä¸ªè™šå‡æ•°æ®</p><p>è¿™æ ·å°±ä¼šå¯¼è‡´item_tableè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®è¢«åˆ é™¤ã€‚</p><p>ä¸ºé˜²æ­¢æ³¨å…¥æ”»å‡»ï¼Œå¯ä»¥ä½¿ç”¨å ä½ç¬¦?ä»£æ›¿éœ€è¦æ’å…¥æ•°æ®åº“çš„å‚æ•°ï¼Œç¬¬äºŒä¸ªæ•°ç»„å‚æ•°ä¸­çš„3ä¸ªå€¼ä¼šæŒ‰é¡ºåºå¡«å……å ä½ç¬¦ï¼Œè¯¥æ–¹æ³•å¯ä»¥é¿å…å¤§éƒ¨åˆ†æ³¨å…¥æ”»å‡»ï¼Œå¦‚ä¸‹ï¼š</p><pre><code class="js">await connection.query(`INSERT INTO item_table (title, price, count) VALUES(?,?,?)`, [title, price, count])</code></pre><pre><code class="js">const connection = require(&#39;../lib/database&#39;)module.exports = async (res, query, post, files) =&gt; {  let {    title,    price,    count  } = post  // åˆ¤æ–­æ˜¯å¦æœ‰ä¼ å‚  if (!title || !price || !count) {    res.writeJson({      error: 1,      msg: &#39;å‚æ•°ä¸åˆæ³•&#39;    })  } else {    // å°†ä»·æ ¼å’Œæ•°é‡è½¬ä¸ºæ•°å­—    price = Number(price)    count = Number(count)    // åˆ¤æ–­ä»·æ ¼å’Œæ•°é‡æ˜¯å¦éæ•°å­—    if (isNaN(price) || isNaN(count)) {      res.writeJson({        error: 1,        msg: &#39;å‚æ•°ä¸åˆæ³•&#39;      })    } else {      try {        // ä½¿ç”¨å ä½ç¬¦?ä»£æ›¿éœ€è¦æ’å…¥æ•°æ®åº“çš„å‚æ•°ï¼Œç¬¬äºŒä¸ªæ•°ç»„å‚æ•°ä¸­çš„3ä¸ªå€¼ä¼šæŒ‰é¡ºåºå¡«å……å ä½ç¬¦ï¼Œè¯¥æ–¹æ³•å¯ä»¥é¿å…å¤§éƒ¨åˆ†æ³¨å…¥æ”»å‡»ã€‚        await connection.query(`INSERT INTO item_table (title, price, count) VALUES(?,?,?)`, [title, price, count])        res.writeJson({          error: 0,          msg: &#39;æ·»åŠ å•†å“æˆåŠŸ&#39;        })      } catch (error) {        console.error(error)        res.writeJson({          error: 1,          msg: &#39;æ•°æ®åº“å†…éƒ¨é”™è¯¯&#39;        })      }    }  }  res.end()}</code></pre><h3 id="åˆ é™¤å•†å“è·¯ç”±å›è°ƒå‡½æ•°"><a href="#åˆ é™¤å•†å“è·¯ç”±å›è°ƒå‡½æ•°" class="headerlink" title="åˆ é™¤å•†å“è·¯ç”±å›è°ƒå‡½æ•°"></a>åˆ é™¤å•†å“è·¯ç”±å›è°ƒå‡½æ•°</h3><pre><code class="js">const connection = require(&#39;../lib/database&#39;)module.exports = async (res, query, post, files) =&gt; {  const ID = query.id  if (!ID) {    res.writeJson({      error: 1,      msg: &#39;å‚æ•°ä¸åˆæ³•&#39;    })  } else {    await connection.query(`DELETE FROM item_table WHERE ID=${ID}`)    res.writeJson({      error: 0,      msg: &#39;åˆ é™¤æˆåŠŸ&#39;    })  }  res.end()}</code></pre><h3 id="æ·»åŠ å„æ¥å£è·¯ç”±é…ç½®-1"><a href="#æ·»åŠ å„æ¥å£è·¯ç”±é…ç½®-1" class="headerlink" title="æ·»åŠ å„æ¥å£è·¯ç”±é…ç½®"></a>æ·»åŠ å„æ¥å£è·¯ç”±é…ç½®</h3><p>åœ¨<code>/router/index.js</code>ä¸­ï¼Œå¼•ç”¨å„ä¸ªæ¥å£çš„é…ç½®ï¼Œå¹¶ç”¨addRouteræ–¹æ³•æ·»åŠ åˆ°è·¯ç”±è¡¨ä¸­ï¼Œå³å¯åœ¨æ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼ŒæŸ¥æ‰¾è·¯ç”±å¹¶è¿›è¡Œå¤„ç†ã€‚</p><pre><code class="js">const {  addRouter} = require(&#39;../lib/router&#39;)// æ·»åŠ è·å–å•†å“åˆ—è¡¨æ¥å£addRouter(&#39;get&#39;, &#39;/list&#39;, require(&#39;./list&#39;))// æ·»åŠ å•†å“æ¥å£addRouter(&#39;post&#39;, &#39;/add&#39;, require(&#39;./add&#39;))// åˆ é™¤å•†å“æ¥å£addRouter(&#39;get&#39;, &#39;/del&#39;, require(&#39;./del&#39;))</code></pre><h3 id="åœ¨ä¸»æ¨¡å—ä¸­å¼•ç”¨è·¯ç”±"><a href="#åœ¨ä¸»æ¨¡å—ä¸­å¼•ç”¨è·¯ç”±" class="headerlink" title="åœ¨ä¸»æ¨¡å—ä¸­å¼•ç”¨è·¯ç”±"></a>åœ¨ä¸»æ¨¡å—ä¸­å¼•ç”¨è·¯ç”±</h3><p>åœ¨/server.jsä¸­ï¼Œå¼•ç”¨routeræ¨¡å—ï¼Œå°±å¯ä»¥å®Œæˆæ•´ä¸ªæœåŠ¡ç«¯çš„é…ç½®ã€‚</p><pre><code class="js">const connection = require(&#39;./lib/database&#39;)const http = require(&#39;./lib/http&#39;)const router = require(&#39;./router&#39;)</code></pre><h3 id="å®Œæˆå‰ç«¯åŠŸèƒ½"><a href="#å®Œæˆå‰ç«¯åŠŸèƒ½" class="headerlink" title="å®Œæˆå‰ç«¯åŠŸèƒ½"></a>å®Œæˆå‰ç«¯åŠŸèƒ½</h3><p>åœ¨/static/index.htmlä¸­ï¼Œä½¿ç”¨jqueryä¸ºå‰ç«¯é¡µé¢å®ç°å¦‚ä¸‹åŠŸèƒ½ï¼š</p><p>1.æ˜¾ç¤ºå•†å“åˆ—è¡¨<br>2.æ·»åŠ éšæœºåç§°ã€ä»·æ ¼ã€åº“å­˜çš„å•†å“<br>3.åˆ é™¤å¯¹åº”å•†å“</p><pre><code class="js">// æŸ¥è¯¢å•†å“åˆ—è¡¨çš„æ–¹æ³•function getList() {  $.ajax({    url: &#39;/list&#39;,    dataType: &#39;json&#39;  }).then(res =&gt; {    let html = ``    res.data.forEach((item, index) =&gt; {      html += (        `            &lt;tr&gt;              &lt;td&gt;${item.title}&lt;/td&gt;              &lt;td&gt;ï¿¥${item.price}&lt;/td&gt;              &lt;td&gt;${item.count}&lt;/td&gt;              &lt;td&gt;                &lt;a data-id=&quot;${item.ID}&quot; href=&quot;#&quot; class=&quot;glyphicon glyphicon-trash&quot;&gt;åˆ é™¤&lt;/a&gt;              &lt;/td&gt;            &lt;/tr&gt;          `      )    })    $(&#39;tbody&#39;).html(html)  });} getList()// ç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œéšæœºæ·»åŠ ä¸€ä¸ªå•†å“$(&#39;#addBtn&#39;).on(&#39;click&#39;, function () {  $.ajax({    url: &#39;/add&#39;,    method: &#39;post&#39;,    data: {      title: `test${Math.floor(Math.random() * 100)}`,      price: Math.floor(Math.random() * 100),      count: Math.floor(Math.random() * 100)    }  })    .then((response) =&gt; {      getList()    })})// ç‚¹å‡»åˆ é™¤æŒ‰é’®$(&#39;tbody&#39;).on(&#39;click&#39;, &#39;a&#39;, function () {  $.ajax({    url: &#39;/del&#39;,    data: {      id: $(this).attr(&#39;data-id&#39;)    }  })    .then((response) =&gt; {      getList()    })})</code></pre>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (åä¸‰) --Streamæµ</title>
      <link href="/2019/05/06/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81%E4%B8%89)%20--Stream%E6%B5%81/"/>
      <url>/2019/05/06/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81%E4%B8%89)%20--Stream%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<h2 id="File-Systemçš„é—®é¢˜"><a href="#File-Systemçš„é—®é¢˜" class="headerlink" title="File Systemçš„é—®é¢˜"></a>File Systemçš„é—®é¢˜</h2><p>æˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨File Systemæ¨¡å—å¯¹æ–‡ä»¶è¿›è¡Œè¯»å–ï¼Œå¦‚ä¸‹ï¼š</p><pre><code class="js">fs.readFile(&#39;./test.txt&#39;, (error, buffer) =&gt; {  if (error) {    console.error(error)  } else {    // è¯»å–æ–‡ä»¶æˆåŠŸ    res.write(buffer)  }})</code></pre><p>è¿™æ ·æ“ä½œç®€å•æœ‰æ•ˆï¼Œä½†è¿™ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><p>1.å ç”¨å†…å­˜<br>ä½¿ç”¨fsè¯»å–æ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€æ¬¡æ€§å°†æ–‡ä»¶çš„æ‰€æœ‰å†…å®¹è¯»å–åˆ°å†…å­˜ä¸­ï¼Œå†ä¸€æ¬¡æ€§å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œå› æ­¤ä¼šå ç”¨å¤§é‡å†…å­˜ã€‚</p><p>2.èµ„æºä½¿ç”¨æ•ˆç‡ä½<br>ä»ç£ç›˜è¯»å–æ–‡ä»¶æœŸé—´ï¼Œç£ç›˜å¤„äºå¿™ç¢ŒçŠ¶æ€ï¼Œè€Œç½‘ç»œå¤„äºç©ºé—²çŠ¶æ€ã€‚<br>ç£ç›˜è¯»å–å®Œæˆåï¼Œå¼€å§‹å‘é€æ–‡ä»¶æ—¶ï¼Œæƒ…å†µæ­£ç›¸åï¼Œç½‘ç»œå¤„äºå¿™ç¢ŒçŠ¶æ€ï¼Œæ­¤æ—¶ç£ç›˜å´å¤„äºç©ºé—²çŠ¶æ€</p><h2 id="Streamæµ"><a href="#Streamæµ" class="headerlink" title="Streamæµ"></a>Streamæµ</h2><p>ç›¸æ¯”File Systemï¼ŒStreamæµè¯»å–æ–‡ä»¶æ˜¯è¯»ä¸€ä»½ï¼Œå‘ä¸€ä»½ï¼ŒStreamæµçš„å†™å…¥æ“ä½œä¹Ÿæœ‰åŒæ ·ç‰¹ç‚¹ï¼Œå› æ­¤å¯ä»¥è§£å†³File Systemåœ¨ä¸Šé¢æåˆ°çš„2ä¸ªé—®é¢˜ã€‚</p><p>æ¥ä¸‹æ¥å®ç°ä¸€ä¸ªç®€å•çš„æµï¼Œå°†1.txtæ–‡ä»¶çš„å†…å®¹å†™å…¥åˆ°2.txtä¸­ï¼š</p><pre><code class="js">const fs = require(&#39;fs&#39;)// åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚const readStream = fs.createReadStream(&#39;./1.txt&#39;)// åˆ›å»ºä¸€ä¸ªå¯å†™æµã€‚const writeStream = fs.createWriteStream(&#39;./2.txt&#39;)// å°†å¯è¯»æµè¯»å–çš„æ•°æ®ï¼Œé€šè¿‡ç®¡é“pipeæ¨é€åˆ°å†™å…¥æµä¸­ï¼Œå³å¯å°†1.txtçš„å†…å®¹ï¼Œå†™å…¥åˆ°2.txtä¸­ã€‚readStream.pipe(writeStream)// è¯»å–å‡ºç°é”™è¯¯æ—¶ä¼šè§¦å‘erroräº‹ä»¶ã€‚readStream.on(&#39;error&#39;, (error) =&gt; {  console.error(error)})// å†™å…¥å®Œæˆæ—¶ï¼Œè§¦å‘finishäº‹ä»¶ã€‚writeStream.on(&#39;finish&#39;, () =&gt; {  console.log(&#39;finish&#39;)})</code></pre><h2 id="ä½¿ç”¨Zlibå‹ç¼©æ–‡ä»¶"><a href="#ä½¿ç”¨Zlibå‹ç¼©æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨Zlibå‹ç¼©æ–‡ä»¶"></a>ä½¿ç”¨Zlibå‹ç¼©æ–‡ä»¶</h2><p>å¯ä»¥ä½¿ç”¨Zlibæ¨¡å—ï¼Œé…åˆStreamæµï¼Œå®ç°æ–‡ä»¶å‹ç¼©åŠŸèƒ½ï¼Œå¦‚ä¸‹ï¼š</p><pre><code class="js">const fs = require(&#39;fs&#39;)// å¼•å…¥zlibæ¨¡å—ï¼Œç”¨äºå®ç°å‹ç¼©åŠŸèƒ½const zlib = require(&#39;zlib&#39;)// åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚const readStream = fs.createReadStream(&#39;./google.jpg&#39;)// åˆ›å»ºä¸€ä¸ªå¯å†™æµã€‚const writeStream = fs.createWriteStream(&#39;./google.jpg.gz&#39;)// åˆ›å»ºä¸€ä¸ªGzipå¯¹è±¡ï¼Œç”¨äºå°†æ–‡ä»¶å‹ç¼©æˆ.gzæ–‡ä»¶const gzip = zlib.createGzip()// å°†å¯è¯»æµè¯»å–çš„æ•°æ®ï¼Œå…ˆé€šè¿‡ç®¡é“pipeæ¨é€åˆ°gzipä¸­ï¼Œå†æ¨é€åˆ°å†™å…¥æµä¸­ã€‚// ä¹Ÿå°±æ˜¯å…ˆå°†å¯è¯»æµçš„æ•°æ®å‹ç¼©ï¼Œå†æ¨é€åˆ°å¯å†™æµä¸­ã€‚readStream.pipe(gzip).pipe(writeStream)// è¯»å–å‡ºç°é”™è¯¯æ—¶ä¼šè§¦å‘erroräº‹ä»¶ã€‚readStream.on(&#39;error&#39;, (error) =&gt; {  console.error(error)})// å†™å…¥å®Œæˆæ—¶ï¼Œè§¦å‘finishäº‹ä»¶ã€‚writeStream.on(&#39;finish&#39;, () =&gt; {  console.log(&#39;finish&#39;)})</code></pre><a id="more"></a><h2 id="ä½¿ç”¨æµä¼ è¾“æ–‡ä»¶åˆ°å‰å°"><a href="#ä½¿ç”¨æµä¼ è¾“æ–‡ä»¶åˆ°å‰å°" class="headerlink" title="ä½¿ç”¨æµä¼ è¾“æ–‡ä»¶åˆ°å‰å°"></a>ä½¿ç”¨æµä¼ è¾“æ–‡ä»¶åˆ°å‰å°</h2><p>å­¦ä¹ äº†æµï¼Œæˆ‘ä»¬å°±å¯ä»¥æ›´åŠ é«˜æ•ˆåœ°å°†æ–‡ä»¶ä¼ è¾“åˆ°å‰å°ï¼š</p><!-- more --><pre><code class="js">const http = require(&#39;http&#39;)const zlib = require(&#39;zlib&#39;)const url = require(&#39;url&#39;)const fs = require(&#39;fs&#39;)const server = http.createServer((req, res) =&gt; {  const {    pathname  } = url.parse(req.url, true)// åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚  const readStream = fs.createReadStream(`./${pathname}`)  // åˆ›å»ºä¸€ä¸ªGzipå¯¹è±¡ï¼Œç”¨äºå°†æ–‡ä»¶å‹ç¼©æˆ.gzæ–‡ä»¶  const gzip = zlib.createGzip()  // å°†è¯»å–çš„å†…å®¹ï¼Œåœ¨é€šè¿‡ç®¡é“æ¨é€åˆ°resä¸­ï¼Œè¯¥æ–¹æ³•ä¸ç»è¿‡å‹ç¼©  readStream.pipe(res)  // å¤„ç†å¯è¯»æµæŠ¥é”™ï¼Œé˜²æ­¢è¯·æ±‚ä¸å­˜åœ¨çš„æ–‡ä»¶  readStream.on(&#39;error&#39;, (error) =&gt; {    console.error(error);    res.writeHead(404)    res.write(&#39;Not Found&#39;)    res.end()  })})server.listen(8080)</code></pre><p>ä½†å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œè™½ç„¶å®ç°äº†ä½¿ç”¨æµä¼ è¾“æ–‡ä»¶ï¼Œä½†å¹¶æ²¡æœ‰ç”¨åˆ°gzipå‹ç¼©ï¼Œåœ¨ä¼ è¾“æ—¶è¿˜æ˜¯æ›´å¤šåœ°æ¶ˆè€—ç½‘ç»œèµ„æºï¼Œæ¥ä¸‹æ¥å¯ä»¥å¼•å…¥gzipå‹ç¼©ã€‚</p><h2 id="æ–‡ä»¶ç»è¿‡gzipå‹ç¼©åä¼ è¾“åˆ°å‰å°"><a href="#æ–‡ä»¶ç»è¿‡gzipå‹ç¼©åä¼ è¾“åˆ°å‰å°" class="headerlink" title="æ–‡ä»¶ç»è¿‡gzipå‹ç¼©åä¼ è¾“åˆ°å‰å°"></a>æ–‡ä»¶ç»è¿‡gzipå‹ç¼©åä¼ è¾“åˆ°å‰å°</h2><p>ä½†æ­¤æ—¶å¦‚æœåªæ˜¯ç®€å•çš„ç”¨<code>readStream.pipe(gzip).pipe(res)</code>ä¼ è¾“æ–‡ä»¶ï¼Œæµè§ˆå™¨åœ¨è®¿é—®æ—¶æ— æ³•ç›´æ¥æ‰“å¼€ï¼Œè€Œæ˜¯ä¼šè§¦å‘æ–‡ä»¶ä¸‹è½½ã€‚<br>è¿™æ˜¯å› ä¸ºæœªè®¾ç½®è¯·æ±‚å¤´å±æ€§<code>content-encoding</code>çš„å€¼ï¼Œå¯¼è‡´æµè§ˆå™¨æ— æ³•è¯†åˆ«ç”¨gzipå‹ç¼©è¿‡çš„æ–‡ä»¶ï¼Œè¿™å°±éœ€è¦ä¿®æ”¹è¯·æ±‚å¤´<code>res.setHeader(&#39;content-encoding&#39;, &#39;gzip&#39;)</code>ï¼Œè®©æµè§ˆå™¨å¯ä»¥è¯†åˆ«ã€‚</p><p>è¿™æ ·æµè§ˆå™¨å°±å¯ä»¥æ­£å¸¸æ‰“å¼€æ–‡ä»¶äº†ï¼Œä½†è‹¥æµè§ˆå™¨è®¿é—®çš„æ˜¯ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œæµè§ˆå™¨ä¼šæŠ¥é”™â€œæ— æ³•è®¿é—®æ­¤ç½‘ç«™â€ï¼Œè¿™æ˜¯å› ä¸ºè¯·æ±‚å¤´å±æ€§<code>content-encoding</code>å·²è¢«è®¾ç½®ä¸ºgzipï¼Œä½†æœåŠ¡ç«¯ä¼ ç»™æµè§ˆå™¨çš„æ˜¯Not Foundå­—ç¬¦ä¸²ï¼Œæµè§ˆå™¨æ— æ³•è¯†åˆ«ã€‚</p><p>æ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>fs.stat</code>æ–¹æ³•ï¼Œå…ˆæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™è¿”å›Not Foundï¼Œè‹¥å­˜åœ¨åˆ™ç»§ç»­ä¼ è¾“ã€‚</p><pre><code class="js">const http = require(&#39;http&#39;)const zlib = require(&#39;zlib&#39;)const url = require(&#39;url&#39;)const fs = require(&#39;fs&#39;)const server = http.createServer((req, res) =&gt; {  const {    pathname  } = url.parse(req.url, true)  // æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„  const filepath = `./${pathname}`  // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨  fs.stat(filepath, (error, stat) =&gt; {    if (error) {      console.error(error);      res.setHeader(&#39;content-encoding&#39;, &#39;identity&#39;)      res.writeHead(404)      res.write(&#39;Not Found&#39;)      res.end()    } else {      // åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚      const readStream = fs.createReadStream(filepath)      // åˆ›å»ºä¸€ä¸ªGzipå¯¹è±¡ï¼Œç”¨äºå°†æ–‡ä»¶å‹ç¼©æˆ.gzæ–‡ä»¶      const gzip = zlib.createGzip()      // å‘æµè§ˆå™¨å‘é€ç»è¿‡gzipå‹ç¼©çš„æ–‡ä»¶ï¼Œè®¾ç½®å“åº”å¤´ï¼Œå¦åˆ™æµè§ˆå™¨æ— æ³•è¯†åˆ«ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œä¸‹è½½ã€‚      res.setHeader(&#39;content-encoding&#39;, &#39;gzip&#39;)      // å°†è¯»å–çš„å†…å®¹ï¼Œé€šè¿‡gzipå‹ç¼©ä¹‹åï¼Œåœ¨é€šè¿‡ç®¡é“æ¨é€åˆ°resä¸­ï¼Œç”±äºresç»§æ‰¿è‡ªStreamæµï¼Œå› æ­¤ä¹Ÿå¯ä»¥æ¥æ”¶ç®¡é“çš„æ¨é€ã€‚      readStream.pipe(gzip).pipe(res)      // å¤„ç†å¯è¯»æµæŠ¥é”™ï¼Œé˜²æ­¢æ–‡ä»¶ä¸­é€”è¢«åˆ é™¤æˆ–å‡ºé”™ï¼Œå¯¼è‡´æŠ¥é”™ã€‚      readStream.on(&#39;error&#39;, (error) =&gt; {        console.error(error);        res.setHeader(&#39;content-encoding&#39;, &#39;identity&#39;)        res.writeHead(404)        res.write(&#39;Not Found&#39;)        res.end()      })    }  })})server.listen(8080)</code></pre><h2 id="å¯åŠ¨å™¨"><a href="#å¯åŠ¨å™¨" class="headerlink" title="å¯åŠ¨å™¨"></a>å¯åŠ¨å™¨</h2><p>å¸¸ç”¨çš„å¯åŠ¨å™¨æœ‰foreverã€pm2ç­‰ï¼Œå®ƒä»¬ä¸»è¦ç”¨åœ¨é¡¹ç›®éƒ¨ç½²é˜¶æ®µ</p><p>1.ä½¿åº”ç”¨ä¸é—´æ–­è¿è¡Œï¼Œå¦‚æœä¸ä½¿ç”¨å¯åŠ¨å™¨ï¼Œå‘½ä»¤è¡Œçª—å£ä¸€æ—¦å…³é—­ï¼Œæˆ–è€…å‡ºç°æŠ¥é”™ï¼Œåº”ç”¨å°±ä¼šåœæ­¢è¿è¡Œï¼Œå¯åŠ¨å™¨ä¼šå¸®åŠ©åº”ç”¨è‡ªåŠ¨é‡å¯ã€‚<br>2.è‹¥å‡ºç°æœåŠ¡å™¨é‡å¯ï¼Œå¯åŠ¨å™¨ä¼šè‡ªåŠ¨å¯åŠ¨åº”ç”¨ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ“ä½œã€‚</p><p>å¸¸ç”¨çš„å¯åŠ¨å™¨æœ‰<code>foreverã€pm2</code>ç­‰ï¼Œæ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹foreverçš„ä½¿ç”¨ã€‚</p><h3 id="forever"><a href="#forever" class="headerlink" title="forever"></a>forever</h3><p>foreveræ–‡æ¡£å¯å‚è€ƒï¼š<a href="https://github.com/foreverjs/forever#readme" target="_blank" rel="noopener">github.com/foreverjs/fâ€¦</a></p><blockquote><p>ä½¿ç”¨foreverå¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼š</p></blockquote><ul><li>å®‰è£…foreverï¼š<code>npm install forever -g</code></li><li>åœ¨å‘½ä»¤è¡Œè¿è¡Œ<code>forever start server.js</code>ï¼Œæ›¿ä»£<code>node server.js</code>å‘½ä»¤ã€‚</li><li>å‘½ä»¤è¡Œçª—å£æç¤º<code>info: Forever processing file: server.js</code>ï¼Œè¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼Œæ­¤æ—¶å¦‚æœå°†çª—å£å…³é—­ï¼Œåº”ç”¨ç…§æ ·å¯ä»¥è®¿é—®ã€‚</li><li>å¦‚æœéœ€è¦å…³é—­æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œ<code>forever stop server.js</code>ã€‚è¿˜æœ‰ä¸€ä¸ªå‘½ä»¤æ˜¯<code>forever stopall</code>ï¼Œåœæ­¢å…¨éƒ¨åœ¨è¿è¡Œçš„ä»»åŠ¡ï¼Œä½†ä½¿ç”¨è¦æ…é‡ã€‚</li></ul><p>foreverå¯åŠ¨æ—¶ï¼Œè¿˜å¯ä»¥æ·»åŠ ä¸€äº›é…ç½®ï¼Œä¾‹å¦‚<code>forever start xxx.js -l c:/xxx.log -e c:/xxx_err.log -aï¼Œforever start xxx.js</code>è¡¨ç¤ºå¯åŠ¨xxx.jsã€‚</p><p>-l c:/xxx.logè¡¨ç¤ºå°†logä¿¡æ¯è¾“å‡ºåˆ°c:/xxx.logæ–‡ä»¶ã€‚<br>-e c:/xxx_err.logè¡¨ç¤ºå°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°c:/xxx_err.logæ–‡ä»¶ã€‚<br>-a è¡¨ç¤ºæ–°çš„æ—¥å¿—æ·»åŠ åˆ°æ—§æ—¥å¿—ä¹‹åï¼Œå³ä¿ç•™æ—§æ—¥å¿—ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (åäºŒ) --ä½¿ç”¨async/awaitå¼‚æ­¥æ“ä½œæ•°æ®åº“</title>
      <link href="/2019/04/29/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81%E4%BA%8C)%20--%E4%BD%BF%E7%94%A8async-await%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/2019/04/29/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81%E4%BA%8C)%20--%E4%BD%BF%E7%94%A8async-await%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡ä½¿ç”¨Node.jsæ“ä½œæ•°æ®åº“ï¼Œè™½ç„¶èƒ½å®ç°åŠŸèƒ½ï¼Œä½†æ˜¯å¼‚æ­¥æ“ä½œéœ€è¦ä¸æ–­å†™å›è°ƒå‡½æ•°ï¼Œä»£ç ä¸¥é‡å†—ä½™ï¼Œè€Œä¸”é˜…è¯»å›°éš¾ã€‚</p><p>å¯ä»¥ä½¿ç”¨<a href="https://github.com/haoxins/co-mysql" target="_blank" rel="noopener">co-mysql</a>ï¼Œå°†<code>query</code>æ–¹æ³•è¯¥å†™ä¸ºè¿”å›ä¸€ä¸ª<code>Promise</code>ï¼Œå°±å¯ä»¥ä½¿ç”¨<code>async/await</code>è¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å‚è€ƒä¸€ä¸‹å®ƒçš„æºç ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å®ç°å°†å›è°ƒå‡½æ•°è½¬æ¢ä¸º</p><pre><code class="js">module.exports = wrapper;var slice = [].slice;// è¯¥æ¨¡å—å¯¼å‡ºä¸ºä¸€ä¸ªåŒ…è£…å‡½æ•°ï¼Œè¿è¡Œå®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¸¦æœ‰queryæ–¹æ³•çš„å¯¹è±¡ã€‚function wrapper(client) {  // clientå³ä¸ºmysql.createPoolæˆ–mysql.createConnectionæ–¹æ³•åˆ›å»ºçš„è¿æ¥å¯¹è±¡ã€‚  var query = client.query;  var o = {};  o.query = function () {    // æå–è°ƒç”¨queryæ–¹æ³•æ—¶ï¼Œä¼ å…¥çš„æ‰€æœ‰å‚æ•°ï¼Œå°†å…¶å­˜å…¥ä¸€ä¸ªæ•°ç»„ã€‚    var args = slice.call(arguments);    // åˆ›å»ºä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå®ƒå°†ä½œä¸ºo.queryçš„è¿”å›å€¼ï¼Œè®©å…¶æ”¯æŒasync/awaitæ–¹å¼è°ƒç”¨ã€‚    var p = new Promise(function (resolve, reject) {      // ä¸ºargså¢åŠ ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå®ƒå°†ä½œä¸ºclient.queryæ–¹æ³•çš„å›è°ƒå‡½æ•°è¿è¡Œï¼Œå®ƒæ¥æ”¶åˆ°ç»“æœæ—¶ï¼Œå°†è¿›è¡Œåˆ¤æ–­è¿è¡Œrejectè¿˜æ˜¯resolve      args.push(function (err, rows) {        if (err) {          reject(err);        } else {          resolve(rows);        }      });      // ç”¨applyæ–¹æ³•ï¼Œå°†o.queryæ¥æ”¶åˆ°çš„å‚æ•°éƒ½ä¼ ç»™client.queryï¼Œå®ƒå¯ä»¥ç­‰åŒäº      /*         client.query(args[0], function(err, rows) {          if (err) {            reject(err);          } else {            resolve(rows);          }        })      */      query.apply(client, args);    });    return p;  };  return o;}</code></pre><p>äºæ˜¯ä¸Šä¸€ç¯‡çš„ä»£ç å¯ä»¥è¿›è¡Œå¦‚ä¸‹ä¼˜åŒ–ï¼š<br><a id="more"></a></p><pre><code class="js">const http = require(&#39;http&#39;)const url = require(&#39;url&#39;)const fs = require(&#39;fs&#39;)const mysql = require(&#39;mysql&#39;)const coMysql = require(&#39;co-mysql&#39;)// 1. è¿æ¥æœåŠ¡å™¨const pool = mysql.createPool({  connectionLimit: 10,  // å»ºç«‹çš„è¿æ¥æ•°é‡ï¼Œé»˜è®¤ä¸º10ä¸ª  host: &#39;localhost&#39;,  // åœ°å€  port: 3306,  // ç«¯å£ï¼Œä¸ä¼ åˆ™é»˜è®¤3306  user: &#39;root&#39;,  // ç™»å½•å  password: &#39;&#39;,  // å¯†ç   database: &#39;test&#39;  // è¿æ¥çš„æ•°æ®åº“})const connection = coMysql(pool)/* const username = &#39;lily&#39;const password = &#39;888888&#39;// å‘æ•°æ®åº“ä¸­æ’å…¥æ•°æ®connection.query(`INSERT INTO user_table (username, password) VALUES (&#39;${username}&#39;, &#39;${password}&#39;)`, (err, data) =&gt; {  if (err) {    console.error(err)  } else {    console.log(data)  }})// æŸ¥è¯¢user_tableè¡¨çš„æ•°æ®connection.query(`SELECT * FROM User_table`, (err, data) =&gt; {  if (err) {    console.error(err)  } else {    console.log(data)  }}) */// more// 2. ä¸HTTPæ¨¡å—é…åˆä½¿ç”¨const server = http.createServer(async (req, res) =&gt; {  const {    pathname,    query  } = url.parse(req.url, true)  if (pathname === &#39;/reg&#39;) {    // è·å–getè¯·æ±‚æ•°æ®    const {      username,      password    } = query    // æ ¡éªŒå‚æ•°æ˜¯å¦æ­£ç¡®    if (!username || !password) {      res.write(JSON.stringify({        error: 1,        msg: &#39;ç”¨æˆ·åæˆ–å¯†ç ä¸å¯ä¸ºç©º&#39;      }))      res.end()    } else if (username.length &gt; 32) {      res.write(JSON.stringify({        error: 1,        msg: &#39;ç”¨æˆ·åçš„é•¿åº¦ä¸å¯è¶…è¿‡32ä½&#39;      }))      res.end()    } else if (password.length &gt; 32) {      res.write(JSON.stringify({        error: 1,        msg: &#39;å¯†ç çš„é•¿åº¦ä¸å¯è¶…è¿‡32ä½&#39;      }))      res.end()    } else {  // æ ¡éªŒé€šè¿‡ï¼Œå¼€å§‹æ³¨å†Œæµç¨‹      try {        // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨        const data = await connection.query(`SELECT ID FROM User_table WHERE username=&#39;${username}&#39;`)        if (data.length) {          res.write(JSON.stringify({            error: 1,            msg: &#39;æ­¤ç”¨æˆ·åå·²è¢«å ç”¨&#39;          }))        } else {          // å°†ç”¨æˆ·åå’Œå¯†ç æ’å…¥æ•°æ®åº“          await connection.query(`INSERT INTO userddd_table (username, password) VALUES(&#39;${username}&#39;, &#39;${password}&#39;)`)          res.write(JSON.stringify({            error: 0,            msg: &#39;æ³¨å†ŒæˆåŠŸ&#39;          }))        }      } catch (error) {        console.error(error)        res.writeHead(500)      }      res.end()    }  } else if (pathname === &#39;/login&#39;) {    let arr = []    req.on(&#39;data&#39;, (buffer) =&gt; {      // è·å–POSTè¯·æ±‚çš„Bufferæ•°æ®      arr.push(buffer)    })    req.on(&#39;end&#39;, async () =&gt; {      // å°†Bufferæ•°æ®åˆå¹¶      let buffer = Buffer.concat(arr)      // å¤„ç†æ¥æ”¶åˆ°çš„POSTæ•°æ®      const post = JSON.parse(buffer.toString())      // è·å–postè¯·æ±‚æ•°æ®      const {        username,        password      } = post      try {        // æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢        const data = await connection.query(`SELECT username, password FROM User_table WHERE username=&#39;${username}&#39;`)        if (!data.length) {          // ç”¨æˆ·ä¸å­˜åœ¨          res.write(JSON.stringify({            error: 1,            msg: &#39;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#39;          }))        } else if (data[0].password !== password) {          // å¯†ç ä¸æ­£ç¡®          res.write(JSON.stringify({            error: 1,            msg: &#39;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#39;          }))        } else {          res.write(JSON.stringify({            error: 0,            msg: &#39;ç™»å½•æˆåŠŸ&#39;          }))        }      } catch (error) {        console.error(error)        res.writeHead(500)      }      res.end()    })  } else {    // è‹¥è¯·æ±‚ä¸ä¸ºæ¥å£ï¼Œåˆ™é»˜è®¤ä¸ºè¯·æ±‚æ–‡ä»¶    if (pathname !== &#39;/favicon.ico&#39;) {      fs.readFile(`.${pathname}`, (err, buffer) =&gt; {        if (err) {          res.writeHead(404)        } else {          res.write(buffer)        }        res.end()      })    } else {      res.writeHead(404)      res.end()    }  }})server.listen(8080)</code></pre>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (åä¸€) --ä½¿ç”¨Nodejsæ“ä½œæ•°æ®åº“</title>
      <link href="/2019/04/21/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81%E4%B8%80%EF%BC%89--%E4%BD%BF%E7%94%A8Nodejs%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/2019/04/21/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81%E4%B8%80%EF%BC%89--%E4%BD%BF%E7%94%A8Nodejs%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h2 id="Nodejsæ“ä½œæ•°æ®åº“"><a href="#Nodejsæ“ä½œæ•°æ®åº“" class="headerlink" title="Nodejsæ“ä½œæ•°æ®åº“"></a>Nodejsæ“ä½œæ•°æ®åº“</h2><p>Nodejsæ“ä½œæ•°æ®åº“éœ€è¦ç”¨åˆ°<code>mysql</code>æ¨¡å—ï¼Œé€šè¿‡<code>npm i mysql -D</code>è¿›è¡Œå®‰è£…ã€‚</p><p>ä¹‹åå¯ä»¥é€šè¿‡<code>mysql.createConnection</code>æ–¹æ³•æ–°å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œéœ€è¦ä¼ å…¥çš„å‚æ•°æœ‰åœ°å€ã€ç«¯å£ã€ç™»å½•åã€å¯†ç ï¼Œä»¥åŠéœ€è¦è¿æ¥çš„æ•°æ®åº“ã€‚</p><p><code>mysql.createConnection</code>ä¼šè¿”å›ä¸€ä¸ª<code>connection</code>å¯¹è±¡ï¼Œå¯ä½¿ç”¨<code>connection.query</code>æ–¹æ³•ï¼Œä¼ å…¥SQLè¯­å¥ï¼Œå¯¹æ•°æ®åº“è¿›è¡Œç›¸åº”æ“ä½œã€‚</p><pre><code class="js">const mysql = require(&#39;mysql&#39;)// 1. è¿æ¥æœåŠ¡å™¨const connection = mysql.createConnection({  host: &#39;localhost&#39;,  // åœ°å€  port: 3306,  // ç«¯å£ï¼Œä¸ä¼ åˆ™é»˜è®¤3306  user: &#39;root&#39;,  // ç™»å½•å  password: &#39;&#39;,  // å¯†ç   database: &#39;test&#39;  // è¿æ¥çš„æ•°æ®åº“})const username = &#39;zzz&#39;const password = &#39;888888&#39;// å‘æ•°æ®åº“ä¸­æ’å…¥æ•°æ®connection.query(`INSERT INTO user_table (username, password) VALUES (&#39;${username}&#39;, &#39;${password}&#39;)`, (err, data) =&gt; {  if (err) {    console.error(err)  } else {    console.log(data)  }})// æŸ¥è¯¢user_tableè¡¨çš„æ•°æ®db.query(`SELECT * FROM User_table`, (err, data) =&gt; {  if (err) {    console.error(err)  } else {    console.log(data)  }})</code></pre><p>INSERTè¯­å¥çš„æ‰“å°çš„æ˜¯æ’å…¥ç»“æœï¼š</p><pre><code class="js">OkPacket {  fieldCount: 0,  affectedRows: 1,  insertId: 8,    // è¿”å›äº†å½“å‰æ’å…¥è¯­å¥çš„idï¼Œå¯ä»¥ç”¨æ¥å‘ŠçŸ¥å‰ç«¯æ’å…¥æ•°æ®çš„id  serverStatus: 2,  warningCount: 0,  message: &#39;&#39;,  protocol41: true,  changedRows: 0 }</code></pre><p>SELECTè¯­å¥çš„æ‰“å°ç»“æœä¸ºæŸ¥è¯¢åˆ°çš„æ‰€æœ‰æ•°æ®ï¼š</p><pre><code class="js">[ RowDataPacket { ID: 1, username: &#39;lee&#39;, password: &#39;123456&#39; },  RowDataPacket { ID: 3, username: &#39;chen&#39;, password: &#39;654321&#39; },  RowDataPacket { ID: 8, username: &#39;zzz&#39;, password: &#39;888888&#39; } ]</code></pre><p>ä½†<code>mysql.createConnection</code>æ–¹æ³•æœ‰ä¸€ä¸ªç¼ºé™·ï¼Œå°±æ˜¯å®ƒä¸€æ¬¡åªèƒ½åˆ›å»ºä¸€ä¸ªè¿æ¥ï¼Œä¸€æ—¦æœ‰å¤šä¸ªç”¨æˆ·åŒæ—¶è¯·æ±‚ï¼Œå°±ä¼šé€ æˆè¯·æ±‚æ’é˜Ÿç­‰å¾…ã€‚</p><p>å› æ­¤ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå¯ä»¥æ”¹ç”¨<code>mysql.createPool</code>æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªè¿æ¥æ± ï¼Œå®ƒå¯ä»¥åˆ›å»ºnä¸ªä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ï¼Œéœ€è¦ä½¿ç”¨æ—¶ï¼Œå¯ä»¥è‡ªåŠ¨ä»ä¸­é€‰å–ä¸€ä¸ªç©ºé—²çš„è¿æ¥ä½¿ç”¨ã€‚</p><pre><code class="js">const connection = mysql.createPool({  connectionLimit: 10,  // å»ºç«‹çš„è¿æ¥æ•°é‡ï¼Œé»˜è®¤ä¸º10ä¸ª  host: &#39;localhost&#39;,  // åœ°å€  port: 3306,  // ç«¯å£ï¼Œä¸ä¼ åˆ™é»˜è®¤3306  user: &#39;root&#39;,  // ç™»å½•å  password: &#39;&#39;,  // å¯†ç   database: &#39;test&#39;  // è¿æ¥çš„æ•°æ®åº“})</code></pre><a id="more"></a><h2 id="ä¸HTTPæ¨¡å—é…åˆå®ç°æ¥å£"><a href="#ä¸HTTPæ¨¡å—é…åˆå®ç°æ¥å£" class="headerlink" title="ä¸HTTPæ¨¡å—é…åˆå®ç°æ¥å£"></a>ä¸HTTPæ¨¡å—é…åˆå®ç°æ¥å£</h2><p>å®Œæˆäº†åŸºæœ¬æ“ä½œåï¼Œå°±å¯ä»¥å®ç°ä¸€ä¸ªå®Œæ•´çš„æ³¨å†Œã€ç™»å½•æµç¨‹</p><pre><code class="js">const http = require(&#39;http&#39;)const url = require(&#39;url&#39;)const fs = require(&#39;fs&#39;)const mysql = require(&#39;mysql&#39;)// 1. è¿æ¥æœåŠ¡å™¨const connection = mysql.createPool({  connectionLimit: 10,  // å»ºç«‹çš„è¿æ¥æ•°é‡ï¼Œé»˜è®¤ä¸º10ä¸ª  host: &#39;localhost&#39;,  // åœ°å€  port: 3306,  // ç«¯å£ï¼Œä¸ä¼ åˆ™é»˜è®¤3306  user: &#39;root&#39;,  // ç™»å½•å  password: &#39;&#39;,  // å¯†ç   database: &#39;test&#39;  // è¿æ¥çš„æ•°æ®åº“})// 2. ä¸HTTPæ¨¡å—é…åˆä½¿ç”¨const server = http.createServer((req, res) =&gt; {  const {    pathname,    query  } = url.parse(req.url, true)  if (pathname === &#39;/reg&#39;) {    // è·å–getè¯·æ±‚æ•°æ®    const {      username,      password    } = query    // æ ¡éªŒå‚æ•°æ˜¯å¦æ­£ç¡®    if (!username || !password) {      res.write(JSON.stringify({        error: 1,        msg: &#39;ç”¨æˆ·åæˆ–å¯†ç ä¸å¯ä¸ºç©º&#39;      }))      res.end()    } else if (username.length &gt; 32) {      res.write(JSON.stringify({        error: 1,        msg: &#39;ç”¨æˆ·åçš„é•¿åº¦ä¸å¯è¶…è¿‡32ä½&#39;      }))      res.end()    } else if (password.length &gt; 32) {      res.write(JSON.stringify({        error: 1,        msg: &#39;å¯†ç çš„é•¿åº¦ä¸å¯è¶…è¿‡32ä½&#39;      }))    } else {  // æ ¡éªŒé€šè¿‡ï¼Œå¼€å§‹æ³¨å†Œæµç¨‹      // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨      connection.query(`SELECT ID FROM User_table WHERE username=&#39;${username}&#39;`, (err, data) =&gt; {        if (err) {          res.writeHead(500)          res.end()        } else {          if (data.length) {            res.write(JSON.stringify({              error: 1,              msg: &#39;æ­¤ç”¨æˆ·åå·²è¢«å ç”¨&#39;            }))            res.end()          } else {            // å°†ç”¨æˆ·åå’Œå¯†ç æ’å…¥æ•°æ®åº“            connection.query(`INSERT INTO user_table (username, password) VALUES(&#39;${username}&#39;, &#39;${password}&#39;)`, (err, data) =&gt; {              if (err) {                res.writeHead(500)                res.end()              } else {                res.write(JSON.stringify({                  error: 0,                  msg: &#39;æ³¨å†ŒæˆåŠŸ&#39;                }))                res.end()              }            })          }        }      })    }  } else if (pathname === &#39;/login&#39;) {    let arr = []    req.on(&#39;data&#39;, (buffer) =&gt; {      // è·å–POSTè¯·æ±‚çš„Bufferæ•°æ®      arr.push(buffer)    })    req.on(&#39;end&#39;, () =&gt; {      // å°†Bufferæ•°æ®åˆå¹¶      let buffer = Buffer.concat(arr)      // å¤„ç†æ¥æ”¶åˆ°çš„POSTæ•°æ®      const post = JSON.parse(buffer.toString())      // è·å–postè¯·æ±‚æ•°æ®      const {        username,        password      } = post      // æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢      connection.query(`SELECT username, password FROM User_table WHERE username=&#39;${username}&#39;`, (err, data) =&gt; {        if (err) {          console.error(err)        } else {          if (!data.length) {            // ç”¨æˆ·ä¸å­˜åœ¨            res.write(JSON.stringify({              error: 1,              msg: &#39;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#39;            }))            res.end()          } else if (data[0].password !== password) {            // å¯†ç ä¸æ­£ç¡®            res.write(JSON.stringify({              error: 1,              msg: &#39;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#39;            }))            res.end()          } else {            res.write(JSON.stringify({              error: 0,              msg: &#39;ç™»å½•æˆåŠŸ&#39;            }))            res.end()          }        }      })    })  } else {    // è‹¥è¯·æ±‚ä¸ä¸ºæ¥å£ï¼Œåˆ™é»˜è®¤ä¸ºè¯·æ±‚æ–‡ä»¶    fs.readFile(`.${pathname}`, (err, buffer) =&gt; {      if (err) {        res.writeHead(404)        res.write(buffer)      } else {        res.write(buffer)      }      res.end()    })  }})server.listen(8080)</code></pre>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (å) --æ•°æ®åº“å…¥é—¨</title>
      <link href="/2019/04/21/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81)%20--%E6%95%B0%E6%8D%AE%E5%BA%93%E5%85%A5%E9%97%A8/"/>
      <url>/2019/04/21/Node/Node%E5%AD%A6%E4%B9%A0(%E5%8D%81)%20--%E6%95%B0%E6%8D%AE%E5%BA%93%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="æ•°æ®åº“çš„åˆ†ç±»"><a href="#æ•°æ®åº“çš„åˆ†ç±»" class="headerlink" title="æ•°æ®åº“çš„åˆ†ç±»"></a>æ•°æ®åº“çš„åˆ†ç±»</h2><p>1.<strong>æ–‡ä»¶æ•°æ®åº“</strong> å®ƒçš„ä¼˜ç‚¹æ˜¯ï¼šæ•°æ®ä¿å­˜åœ¨å•ä¸€æ–‡ä»¶ä¸­ï¼Œå› æ­¤éƒ¨ç½²ååˆ†æ–¹ä¾¿ï¼Œå¸¸ç”¨æ¥åµŒå…¥åˆ°APPä¸­ä¿å­˜æ•°æ®ï¼Œä»¥åŠæ‰‹æœºä¸­çš„çŸ­ä¿¡ã€é€šè¯è®°å½•ç­‰ã€‚</p><p>å¸¸ç”¨çš„æœ‰SQLiteã€Accessç­‰ã€‚</p><p>2.<strong>å…³ç³»å‹æ•°æ®åº“</strong> å…³ç³»å‹æ•°æ®åº“çš„åŠŸèƒ½å¼ºå¤§ï¼Œé€‚ç”¨åœºæ™¯ä¸°å¯Œï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ•°æ®ä¹‹é—´äº’ç›¸æ˜¯å…³è”çš„ã€‚</p><p>æ¯”å¦‚æ·˜å®ï¼Œä¸€ä¸ªç”¨æˆ·ä¸‹æœ‰ä¸ªäººä¿¡æ¯ã€è®¢å•ä¿¡æ¯ã€èŠå¤©è®°å½•ç­‰ï¼Œå¯ä»¥åˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒè¡¨ä¸­ï¼Œé€šè¿‡ç”¨æˆ·IDç›¸äº’å…³è”èµ·æ¥ã€‚ä½†å®ƒçš„æ€§èƒ½ä¸æ˜¯æœ€å¼ºçš„ã€‚</p><p>å¸¸ç”¨æœ‰SQLã€‚</p><p>3.<strong>åˆ†å¸ƒå¼æ•°æ®åº“</strong> å®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥å®‰è£…åœ¨å¤šå°æœºå™¨ä¸Šï¼Œå¯ä»¥å°†æŸ¥è¯¢ç­‰æ“ä½œåˆ†æ•£å¼€ï¼Œåˆç†åˆ©ç”¨æœåŠ¡å™¨èµ„æºã€‚</p><p>è¿˜å¯ä»¥å°†æ•°æ®è®¾ç½®å¤šä¸ªå¤‡ä»½ï¼Œä¸€æ—¦å…¶ä¸­ä¸€å°æœåŠ¡å™¨å¼‚å¸¸ï¼Œå¯ä»¥ç”±å…¶ä»–æœåŠ¡å™¨åŒæ­¥æ•°æ®ã€‚</p><p>å¸¸ç”¨çš„æœ‰MongoDBã€‚</p><p>4.<strong>NoSQL</strong> å®ƒåªèƒ½æ”¯æŒç®€å•æŸ¥è¯¢ï¼Œä½†æ€§èƒ½å¼ºäºå…³ç³»å‹æ•°æ®åº“ï¼Œå¸¸ç”¨æ¥åšæ¥å£ã€æ•°æ®ç¼“å­˜ç­‰ã€‚</p><p>å¸¸ç”¨çš„æœ‰MongoDBã€Memcachedã€Redisç­‰ã€‚</p><h2 id="SQLè¯­å¥"><a href="#SQLè¯­å¥" class="headerlink" title="SQLè¯­å¥"></a>SQLè¯­å¥</h2><p>ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€(Structured Query Language)ç®€ç§°SQLï¼Œå®ƒä¸»è¦ç”¨æ¥å­˜å–ã€æŸ¥è¯¢ã€æ›´æ–°å’Œç®¡ç†å…³ç³»æ•°æ®åº“ç³»ç»Ÿã€‚</p><p>SQL åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šæ•°æ®å®šä¹‰è¯­è¨€ (DDL)å’Œæ•°æ®æ“ä½œè¯­è¨€ (DML) ã€‚</p><h2 id="DDLè¯­å¥"><a href="#DDLè¯­å¥" class="headerlink" title="DDLè¯­å¥"></a>DDLè¯­å¥</h2><p>CREATE DATABASE - åˆ›å»ºæ–°æ•°æ®åº“<br>ALTER DATABASE - ä¿®æ”¹æ•°æ®åº“<br>CREATE TABLE - åˆ›å»ºæ–°è¡¨<br>ALTER TABLE - å˜æ›´ï¼ˆæ”¹å˜ï¼‰æ•°æ®åº“è¡¨<br>DROP TABLE - åˆ é™¤è¡¨<br>CREATE INDEX - åˆ›å»ºç´¢å¼•ï¼ˆæœç´¢é”®ï¼‰<br>DROP INDEX - åˆ é™¤ç´¢å¼•</p><h2 id="DDMè¯­å¥"><a href="#DDMè¯­å¥" class="headerlink" title="DDMè¯­å¥"></a>DDMè¯­å¥</h2><p>æ•°æ®æ“ä½œè¯­è¨€ (DML) æ˜¯æœ€å¸¸ç”¨çš„æ“ä½œï¼Œå³å¢åˆ æ”¹æŸ¥ï¼Œå®ƒåŒ…æ‹¬å¦‚ä¸‹éƒ¨åˆ†ï¼š</p><p>1.å¢INSERT INTO - å‘æ•°æ®åº“è¡¨ä¸­æ’å…¥æ•°æ®<br>INSERT INTO &lt;è¡¨&gt; (å­—æ®µ, â€¦) VALUES(å€¼, â€¦);<br>INSERT INTO user_table (username, password) VALUES(â€˜leeâ€™, â€˜123456â€™);<br>åœ¨user_tableè¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®ã€‚</p><p>2.åˆ DELETE - ä»æ•°æ®åº“è¡¨ä¸­åˆ é™¤æ•°æ®<br>DELETE FROM &lt;è¡¨&gt; WHERE æ¡ä»¶;<br>DELETE FROM user_table WHERE ID=2;<br>åˆ é™¤user_tableè¡¨ä¸­IDä¸º2çš„é¡¹ç›®ã€‚</p><p>3.æ”¹UPDATE - æ›´æ–°æ•°æ®åº“è¡¨ä¸­çš„æ•°æ®<br>UPDATE &lt;è¡¨&gt; SET å­—æ®µ=æ–°å€¼,å­—æ®µ=æ–°å€¼,â€¦ WHERE æ¡ä»¶;<br>UPDATE user_table SET password=â€™888888â€™, username=â€™chenâ€™ WHERE ID=1;<br>å°†user_tableè¡¨ä¸­IDä¸º1çš„ç”¨æˆ·åå’Œå¯†ç æ›´æ–°ã€‚</p><p>4.æŸ¥SELECT - ä»æ•°æ®åº“è¡¨ä¸­è·å–æ•°æ®<br>SELECT å­—æ®µåˆ—è¡¨ FROM &lt;è¡¨&gt; WHERE æ¡ä»¶ ORDER BY å­—æ®µ LIMIT 30,30;<br>SELECT ID FROM user_table WHERE username=â€˜leeâ€™ ORDER BY ID ASC LIMIT 0,10;<br>æŸ¥è¯¢user_tableè¡¨ä¸­usernameä¸ºleeçš„ç”¨æˆ·çš„IDï¼Œå–0~10ä¸ªï¼ŒæŒ‰å‡åºæ’åˆ—ã€‚</p><h2 id="æ•°æ®åº“ç´¢å¼•"><a href="#æ•°æ®åº“ç´¢å¼•" class="headerlink" title="æ•°æ®åº“ç´¢å¼•"></a>æ•°æ®åº“ç´¢å¼•</h2><p>æ•°æ®åº“çš„ç´¢å¼•éœ€è¦ä½œç”¨æ˜¯æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œå¦å¤–è¿˜å¯ä»¥å¯¹æ•°æ®è¿›è¡Œé™åˆ¶ï¼Œå¦‚é™åˆ¶ä¸ºâ€œå”¯ä¸€â€ã€‚</p><p>ç´¢å¼•çš„ç±»å‹æœ‰å››ç§ï¼Œå¦‚ä¸‹ï¼š</p><p>1.ä¸»é”®</p><p>å…·æœ‰â€œå”¯ä¸€â€å’Œâ€œç´¢å¼•â€çš„åŒé‡ä¼˜ç‚¹ã€‚</p><p>2.å”¯ä¸€</p><p>å®šä¹‰å­—æ®µä¸ºå”¯ä¸€ï¼Œå³ä¸å¯é‡å¤ã€‚</p><p>3.ç´¢å¼•</p><p>ä¼˜ç‚¹ï¼šæé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œç›¸å½“äºä¹¦çš„ç›®å½•ã€‚</p><p>ç¼ºç‚¹ï¼šé™ä½å¢ã€åˆ ã€æ”¹çš„æ€§èƒ½ï¼Œå› ä¸ºè¿™äº›æ“ä½œå¯èƒ½ä¼šè§¦å‘æ•°æ®åº“æ•´ç†ã€é‡å»ºç´¢å¼•ã€‚å¦å¤–ï¼Œç´¢å¼•ä¹Ÿä¼šå ç”¨ç£ç›˜ç©ºé—´ã€‚</p><p>4.å…¨æ–‡ç´¢å¼•</p><p>é€‚åˆæ–‡æœ¬æœç´¢ï¼Œå¸¸ç”¨åœ¨æœç´¢å¼•æ“ä¸­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (ä¹)--Websocket</title>
      <link href="/2019/04/20/Node/Node%E5%AD%A6%E4%B9%A0(%E4%B9%9D)%20--Websocket/"/>
      <url>/2019/04/20/Node/Node%E5%AD%A6%E4%B9%A0(%E4%B9%9D)%20--Websocket/</url>
      
        <content type="html"><![CDATA[<h1 id="WebSocketçš„ä¼˜åŠ¿"><a href="#WebSocketçš„ä¼˜åŠ¿" class="headerlink" title="WebSocketçš„ä¼˜åŠ¿"></a>WebSocketçš„ä¼˜åŠ¿</h1><p>1.æ€§èƒ½é«˜ã€‚</p><p>æ ¹æ®æµ‹è¯•ç¯å¢ƒæ•°æ®çš„ä¸åŒï¼Œå¤§çº¦ä¼šæ¯”æ™®é€šAjaxè¯·æ±‚é«˜2-10å€ã€‚ HTTPæ˜¯æ–‡æœ¬åè®®ï¼Œæ•°æ®é‡æ¯”è¾ƒå¤§ã€‚</p><p>è€ŒWebSocketæ˜¯åŸºäºäºŒè¿›åˆ¶çš„åè®®ï¼Œåœ¨å»ºç«‹è¿æ¥æ—¶ç”¨çš„è™½ç„¶æ˜¯æ–‡æœ¬æ•°æ®ï¼Œä½†ä¹‹åä¼ è¾“çš„éƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œå› æ­¤æ€§èƒ½æ¯”Ajaxè¯·æ±‚é«˜ã€‚</p><p>2.åŒå‘é€šä¿¡ã€‚</p><p>å¦‚æœæ˜¯æ™®é€šAjaxè¯·æ±‚ï¼Œéœ€è¦å®æ—¶è·å–æ•°æ®ï¼Œåªèƒ½ç”¨è®¡æ—¶å™¨å®šæ—¶å‘é€è¯·æ±‚ï¼Œè¿™æ ·ä¼šæµªè´¹æœåŠ¡å™¨èµ„æºå’Œæµé‡ã€‚</p><p>è€Œé€šè¿‡WebSocketï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å‰ç«¯å‘é€ä¿¡æ¯ã€‚</p><p>3.å®‰å…¨æ€§é«˜</p><p>ç”±äºWebSocketå‡ºç°è¾ƒæ™šï¼Œç›¸æ¯”HTTPåè®®ï¼Œåœ¨å®‰å…¨æ€§ä¸Šè€ƒè™‘çš„æ›´åŠ å……åˆ†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œå°è¯•ç”¨<code>Socket.io</code>å»ºç«‹ä¸€ä¸ªåŸºäºWebSocketçš„åŒå‘é€šä¿¡ã€‚</p><h2 id="Socket-io"><a href="#Socket-io" class="headerlink" title="Socket.io"></a>Socket.io</h2><p><code>Socket.io</code>æ˜¯åœ¨ä½¿ç”¨WebSocketæ—¶çš„ä¸€ä¸ªå¸¸ç”¨åº“ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ¤æ–­åœ¨æ”¯æŒWebSocketçš„æµè§ˆå™¨ä¸­ä½¿ç”¨WebSocketï¼Œåœ¨å…¶ä»–æµè§ˆå™¨ä¸­ï¼Œä¼šä½¿ç”¨å¦‚flashç­‰æ–¹å¼å®Œæˆé€šä¿¡ã€‚</p><p>1.æ“ä½œç®€å•<br>2.å…¼å®¹ä½ç«¯æµè§ˆå™¨ï¼Œå¦‚IE6<br>3.è‡ªåŠ¨è¿›è¡Œæ•°æ®è§£æ<br>4.è‡ªåŠ¨é‡è¿ è‹¥å‡ºç°è¿æ¥æ–­å¼€çš„æƒ…å†µï¼ŒWebSocketä¼šè¿›è¡Œè‡ªåŠ¨é‡è¿ã€‚</p><h2 id="ä½¿ç”¨Socket-ioå»ºç«‹ä¸€ä¸ªWebSocketåº”ç”¨"><a href="#ä½¿ç”¨Socket-ioå»ºç«‹ä¸€ä¸ªWebSocketåº”ç”¨" class="headerlink" title="ä½¿ç”¨Socket.ioå»ºç«‹ä¸€ä¸ªWebSocketåº”ç”¨"></a>ä½¿ç”¨Socket.ioå»ºç«‹ä¸€ä¸ªWebSocketåº”ç”¨</h2><pre><code class="js">const http = require(&#39;http&#39;)const io = require(&#39;socket.io&#39;)// 1. å»ºç«‹HTTPæœåŠ¡å™¨ã€‚const server = http.createServer((req, res) =&gt; {})server.listen(8080)// 2. å»ºç«‹WebSocketï¼Œè®©socket.ioç›‘å¬HTTPæœåŠ¡å™¨ï¼Œä¸€æ—¦å‘ç°æ˜¯WebSocketè¯·æ±‚ï¼Œåˆ™ä¼šè‡ªåŠ¨è¿›è¡Œå¤„ç†ã€‚const ws = io.listen(server)// å»ºç«‹è¿æ¥å®Œæˆåï¼Œè§¦å‘connectionäº‹ä»¶ã€‚// è¯¥äº‹ä»¶ä¼šè¿”å›ä¸€ä¸ªsocketå¯¹è±¡ï¼ˆhttps://socket.io/docs/server-api/#Socketï¼‰ï¼Œå¯ä»¥åˆ©ç”¨socketå¯¹è±¡è¿›è¡Œå‘é€ã€æ¥æ”¶æ•°æ®æ“ä½œã€‚ws.on(&#39;connection&#39;, (socket) =&gt; {  // æ ¹æ®äº‹ä»¶åï¼Œå‘å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œæ•°æ®æ•°é‡ä¸é™ã€‚  socket.emit(&#39;msg&#39;, &#39;æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ç¬¬ä¸€æ¡&#39;, &#39;æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ç¬¬äºŒæ¡&#39;)  // æ ¹æ®äº‹ä»¶åæ¥æ”¶å®¢æˆ·ç«¯è¿”å›çš„æ•°æ®  socket.on(&#39;msg&#39;, (...msgs) =&gt; {    console.log(msgs)  })  // ä½¿ç”¨è®¡æ—¶å™¨å‘å®¢æˆ·ç«¯å‘é€æ•°æ®  setInterval(() =&gt; {    socket.emit(&#39;timer&#39;, new Date().getTime())  }, 500);})</code></pre><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;  &lt;meta charset=&quot;UTF-8&quot;&gt;  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;  &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt;  &lt;!-- å¼•ç”¨Socket.ioçš„å®¢æˆ·ç«¯jsæ–‡ä»¶ï¼Œç”±äºSocket.ioå·²åœ¨æœåŠ¡ç«¯ç›‘å¬äº†HTTPæœåŠ¡å™¨çš„è¯·æ±‚ï¼Œä¸€æ—¦æ”¶åˆ°å¯¹è¯¥æ–‡ä»¶çš„è¯·æ±‚ï¼Œåˆ™ä¼šè‡ªåŠ¨è¿”å›è¯¥æ–‡ä»¶ï¼Œä¸éœ€è¦å¼€å‘äººå‘˜é…ç½®ã€‚ --&gt;  &lt;!-- è¯¥æ–‡ä»¶åœ¨æœåŠ¡ç«¯çš„ä½ç½®ä¸º/node_modules/socket.io/node_modules/socket.io-client/dist/socket.io.js --&gt;  &lt;script src=&quot;http://localhost:8080/socket.io/socket.io.js&quot;&gt;&lt;/script&gt;  &lt;script&gt;    // ä¸æœåŠ¡å™¨å»ºç«‹WebSocketè¿æ¥ï¼Œè¯¥è¿æ¥ä¸ºwsåè®®ï¼Œsocket.ioä¸éœ€è¦æ‹…å¿ƒè·¨åŸŸé—®é¢˜ã€‚    const socket = io.connect(&#39;ws://localhost:8080/&#39;)    // æ ¹æ®äº‹ä»¶åï¼Œå‘æœåŠ¡ç«¯å‘é€æ•°æ®ï¼Œæ•°æ®æ•°é‡ä¸é™ã€‚    socket.emit(&#39;msg&#39;, &#39;å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®ç¬¬ä¸€æ¡&#39;, &#39;å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®ç¬¬äºŒæ¡&#39;)    // æ ¹æ®äº‹ä»¶åæ¥æ”¶æœåŠ¡ç«¯è¿”å›çš„æ•°æ®    socket.on(&#39;msg&#39;, (...msgs) =&gt; {      console.log(msgs)    })    // æ¥æ”¶æœåŠ¡ç«¯é€šè¿‡è®¡æ—¶å™¨å‘é€æ¥çš„æ•°æ®    socket.on(&#39;timer&#39;, (time) =&gt; {      console.log(time)    })  &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><a id="more"></a><p>ç”¨æµè§ˆå™¨æ‰“å¼€index.htmlï¼Œå³å¯åœ¨æ§åˆ¶å°çœ‹åˆ°æ‰“å°çš„æ¶ˆæ¯ã€‚</p><h1 id="åŸç”Ÿå®ç°WebSocketåº”ç”¨"><a href="#åŸç”Ÿå®ç°WebSocketåº”ç”¨" class="headerlink" title="åŸç”Ÿå®ç°WebSocketåº”ç”¨"></a>åŸç”Ÿå®ç°WebSocketåº”ç”¨</h1><p>ä¸Šé¢ä½¿ç”¨äº†Socket.ioå®ç°WebSocketï¼Œä¹Ÿæ˜¯å¼€å‘ä¸­å¸¸ç”¨çš„æ–¹å¼ã€‚</p><p>ä½†è¿™æ ·ä¸åˆ©äºäº†è§£å…¶åŸç†ï¼Œè¿™é‡Œä½¿ç”¨Nodejsçš„Netæ¨¡å—å’ŒWebç«¯çš„WebSocket APIå®ç°WebSocketæœåŠ¡å™¨ã€‚</p><h2 id="æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªNetæœåŠ¡å™¨"><a href="#æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªNetæœåŠ¡å™¨" class="headerlink" title="æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªNetæœåŠ¡å™¨"></a>æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªNetæœåŠ¡å™¨</h2><pre><code class="js">// å¼•å…¥netæ¨¡å—const net = require(&#39;net&#39;)// ä½¿ç”¨netæ¨¡å—åˆ›å»ºæœåŠ¡å™¨ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªåŸå§‹çš„socketå¯¹è±¡ï¼Œä¸Socket.ioçš„socketå¯¹è±¡ä¸åŒã€‚const server = net.createServer((socket) =&gt; {})server.listen(8080)</code></pre><h2 id="Webç«¯åˆ›å»ºä¸€ä¸ªWebSocketé“¾æ¥"><a href="#Webç«¯åˆ›å»ºä¸€ä¸ªWebSocketé“¾æ¥" class="headerlink" title="Webç«¯åˆ›å»ºä¸€ä¸ªWebSocketé“¾æ¥"></a>Webç«¯åˆ›å»ºä¸€ä¸ªWebSocketé“¾æ¥</h2><p>åˆ›å»ºä¸€ä¸ªWebSocketè¿æ¥ï¼Œæ­¤æ—¶æ§åˆ¶å°çš„Networkæ¨¡å—å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¤„äºpendingçŠ¶æ€çš„HTTPè¿æ¥ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2019/3/13/16977a451448747d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="socket"></p><p>è¿™ä¸ªè¿æ¥æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œä¸æ™®é€šHTTPè¯·æ±‚çš„è¯·æ±‚ä½ å¤´ç›¸æ¯”ï¼Œå¢åŠ äº†ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits  // æ‰©å±•ä¿¡æ¯</li><li>Sec-WebSocket-Key: O3PKSb95qaSB7/+XfaTg7Q== // å‘é€ä¸€ä¸ªKeyåˆ°æœåŠ¡ç«¯ï¼Œç”¨äºæ ¡éªŒæœåŠ¡ç«¯æ˜¯å¦æ”¯æŒWebSocket</li><li>Sec-WebSocket-Version: 13 // WebSocketç‰ˆæœ¬</li><li>Upgrade: websocket  // å‘ŠçŸ¥æœåŠ¡å™¨é€šä¿¡åè®®å°†ä¼šå‡çº§åˆ°WebSocketè‹¥æœåŠ¡å™¨æ”¯æŒåˆ™ç»§ç»­ä¸‹ä¸€æ­¥</li></ul><pre><code class="js">const ws = new WebSocket(&#39;ws://localhost:8080/&#39;)</code></pre><h2 id="æœåŠ¡ç«¯ä½¿ç”¨socket-onceï¼Œè§¦å‘ä¸€æ¬¡dataäº‹ä»¶å¤„ç†HTTPè¯·æ±‚å¤´æ•°æ®"><a href="#æœåŠ¡ç«¯ä½¿ç”¨socket-onceï¼Œè§¦å‘ä¸€æ¬¡dataäº‹ä»¶å¤„ç†HTTPè¯·æ±‚å¤´æ•°æ®" class="headerlink" title="æœåŠ¡ç«¯ä½¿ç”¨socket.onceï¼Œè§¦å‘ä¸€æ¬¡dataäº‹ä»¶å¤„ç†HTTPè¯·æ±‚å¤´æ•°æ®"></a>æœåŠ¡ç«¯ä½¿ç”¨socket.onceï¼Œè§¦å‘ä¸€æ¬¡dataäº‹ä»¶å¤„ç†HTTPè¯·æ±‚å¤´æ•°æ®</h2><pre><code class="js">socket.once(&#39;data&#39;, (buffer) =&gt; {  // æ¥æ”¶åˆ°HTTPè¯·æ±‚å¤´æ•°æ®  const str = buffer.toString()  console.log(str)})</code></pre><p>æ‰“å°ç»“æœå¦‚ä¸‹:</p><pre><code class="js">GET / HTTP/1.1Host: localhost:8080Connection: UpgradePragma: no-cacheCache-Control: no-cacheUpgrade: websocketOrigin: file://Sec-WebSocket-Version: 13User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/72.0.3626.121 Safari/537.36Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: _ga=GA1.1.1892261700.1545540050; _gid=GA1.1.774798563.1552221410; io=7X0VY8jhwRTdRHBfAAABSec-WebSocket-Key: JStOineTIKaQskxefzer7Q==Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits</code></pre><p>å°†å›è½¦ç¬¦è½¬æ¢ä¸º\r\næ˜¾ç¤ºï¼Œç»“æœå¦‚ä¸‹ï¼š</p><pre><code class="js">GET / HTTP/1.1\r\nHost: localhost:8080\r\nConnection: Upgrade\r\nPragma: no-cache\r\nCache-Control: no-cache\r\nUpgrade: websocket\r\nOrigin: file://\r\nSec-WebSocket-Version: 13\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36\r\nAccept-Encoding: gzip, deflate, br\r\nAccept-Language: zh-CN,zh;q=0.9\r\nCookie: _ga=GA1.1.1892261700.1545540050; _gid=GA1.1.774798563.1552221410; io=7X0VY8jhwRTdRHBfAAAB\r\nSec-WebSocket-Key: dRB1xDJ/vV+IAGnG7TscNQ==\r\nSec-WebSocket-Extensions: permessage-deflate; client_max_window_bits\r\n\r\n</code></pre><h2 id="å°†è¯·æ±‚å¤´å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡"><a href="#å°†è¯·æ±‚å¤´å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡" class="headerlink" title="å°†è¯·æ±‚å¤´å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡"></a>å°†è¯·æ±‚å¤´å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡</h2><p>åˆ›å»ºä¸€ä¸ªparseHeaderæ–¹æ³•å¤„ç†è¯·æ±‚å¤´ã€‚</p><pre><code class="js">function parseHeader(str) {  // å°†è¯·æ±‚å¤´æ•°æ®æŒ‰å›è½¦ç¬¦åˆ‡å‰²ä¸ºæ•°ç»„ï¼Œå¾—åˆ°æ¯ä¸€è¡Œæ•°æ®  let arr = str.split(&#39;\r\n&#39;).filter(item =&gt; item)  // ç¬¬ä¸€è¡Œæ•°æ®ä¸ºGET / HTTP/1.1ï¼Œå¯ä»¥ä¸¢å¼ƒã€‚  arr.shift()  console.log(arr)  /*     å¤„ç†ç»“æœä¸ºï¼š    [ &#39;Host: localhost:8080&#39;,      &#39;Connection: Upgrade&#39;,      &#39;Pragma: no-cache&#39;,      &#39;Cache-Control: no-cache&#39;,      &#39;Upgrade: websocket&#39;,      &#39;Origin: file://&#39;,      &#39;Sec-WebSocket-Version: 13&#39;,      &#39;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36&#39;,      &#39;Accept-Encoding: gzip, deflate, br&#39;,      &#39;Accept-Language: zh-CN,zh;q=0.9&#39;,      &#39;Cookie: _ga=GA1.1.1892261700.1545540050; _gid=GA1.1.774798563.1552221410; io=7X0VY8jhwRTdRHBfAAAB&#39;,      &#39;Sec-WebSocket-Key: jqxd7P0Xx9TGkdMfogptRw==&#39;,      &#39;Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits&#39; ]  */  let headers = {}  // å­˜å‚¨æœ€ç»ˆå¤„ç†çš„æ•°æ®  arr.forEach((item) =&gt; {    // éœ€è¦ç”¨&quot;:&quot;å°†æ•°ç»„åˆ‡å‰²æˆkeyå’Œvalue    let [name, value] = item.split(&#39;:&#39;)    // å»é™¤æ— ç”¨çš„ç©ºæ ¼ï¼Œå°†å±æ€§åè½¬ä¸ºå°å†™    name = name.replace(/^\s|\s+$/g, &#39;&#39;).toLowerCase()    value = value.replace(/^\s|\s+$/g, &#39;&#39;)    // è·å–æ‰€æœ‰çš„è¯·æ±‚å¤´å±æ€§    headers[name] = value  })  return headers}</code></pre><p>æ‰“å°ç»“æœå¦‚ä¸‹:</p><pre><code class="js">{ host: &#39;localhost&#39;,  connection: &#39;Upgrade&#39;,  pragma: &#39;no-cache&#39;,  &#39;cache-control&#39;: &#39;no-cache&#39;,  upgrade: &#39;websocket&#39;,  origin: &#39;file&#39;,  &#39;sec-websocket-version&#39;: &#39;13&#39;,  &#39;user-agent&#39;:   &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36&#39;,  &#39;accept-encoding&#39;: &#39;gzip, deflate, br&#39;,  &#39;accept-language&#39;: &#39;zh-CN,zh;q=0.9&#39;,  cookie:   &#39;_ga=GA1.1.1892261700.1545540050; _gid=GA1.1.585339125.1552405260&#39;,  &#39;sec-websocket-key&#39;: &#39;TipyPZNW+KNvV3fePNpriw==&#39;,  &#39;sec-websocket-extensions&#39;: &#39;permessage-deflate; client_max_window_bits&#39; }</code></pre><h2 id="æ ¹æ®è¯·æ±‚å¤´å‚æ•°ï¼Œåˆ¤æ–­æ˜¯å¦WebSocketè¯·æ±‚"><a href="#æ ¹æ®è¯·æ±‚å¤´å‚æ•°ï¼Œåˆ¤æ–­æ˜¯å¦WebSocketè¯·æ±‚" class="headerlink" title="æ ¹æ®è¯·æ±‚å¤´å‚æ•°ï¼Œåˆ¤æ–­æ˜¯å¦WebSocketè¯·æ±‚"></a>æ ¹æ®è¯·æ±‚å¤´å‚æ•°ï¼Œåˆ¤æ–­æ˜¯å¦WebSocketè¯·æ±‚</h2><p>æ ¹æ®<code>headers[&#39;upgrade&#39;] !== &#39;websocket&#39;</code>ï¼Œåˆ¤æ–­è¯¥HTTPè¿æ¥æ˜¯å¦å¯å‡çº§ä¸ºWebSocketï¼Œè‹¥å¯ä»¥å‡çº§ï¼Œè¡¨ç¤ºä¸ºWebSocketè¯·æ±‚ã€‚<br>æ ¹æ®<code>headers[&#39;sec-websocket-version&#39;] !== &#39;13&#39;</code>ï¼Œåˆ¤æ–­WebSocketçš„ç‰ˆæœ¬æ˜¯å¦ä¸º13ï¼Œä»¥å…å› ä¸ºç‰ˆæœ¬ä¸åŒå‡ºç°å…¼å®¹é—®é¢˜ã€‚</p><pre><code class="js">socket.once(&#39;data&#39;, (buffer) =&gt; {  // æ¥æ”¶åˆ°HTTPè¯·æ±‚å¤´æ•°æ®  const str = buffer.toString()  console.log(str)  // 4. å°†è¯·æ±‚å¤´æ•°æ®è½¬ä¸ºå¯¹è±¡  const headers = parseHeader(str)  console.log(headers)  // 5. åˆ¤æ–­è¯·æ±‚æ˜¯å¦ä¸ºWebSocketè¿æ¥  if (headers[&#39;upgrade&#39;] !== &#39;websocket&#39;) {    // è‹¥å½“å‰è¯·æ±‚ä¸æ˜¯WebSocketè¿æ¥ï¼Œåˆ™å…³é—­è¿æ¥    console.log(&#39;éWebSocketè¿æ¥&#39;)    socket.end()  } else if (headers[&#39;sec-websocket-version&#39;] !== &#39;13&#39;) {    // åˆ¤æ–­WebSocketç‰ˆæœ¬æ˜¯å¦ä¸º13ï¼Œé˜²æ­¢æ˜¯å…¶ä»–ç‰ˆæœ¬ï¼Œé€ æˆå…¼å®¹é”™è¯¯    console.log(&#39;WebSocketç‰ˆæœ¬é”™è¯¯&#39;)    socket.end()  } else {    // è¯·æ±‚ä¸ºWebSocketè¿æ¥æ—¶ï¼Œè¿›ä¸€æ­¥å¤„ç†  }})</code></pre><h2 id="æ ¡éªŒSec-WebSocket-Keyï¼Œå®Œæˆè¿æ¥"><a href="#æ ¡éªŒSec-WebSocket-Keyï¼Œå®Œæˆè¿æ¥" class="headerlink" title="æ ¡éªŒSec-WebSocket-Keyï¼Œå®Œæˆè¿æ¥"></a>æ ¡éªŒSec-WebSocket-Keyï¼Œå®Œæˆè¿æ¥</h2><p>æ ¹æ®åè®®è§„å®šçš„æ–¹å¼ï¼Œå‘å‰ç«¯è¿”å›ä¸€ä¸ªè¯·æ±‚å¤´ï¼Œå®Œæˆå»ºç«‹WebSocketè¿æ¥çš„è¿‡ç¨‹ã€‚</p><p>è‹¥å®¢æˆ·ç«¯æ ¡éªŒç»“æœæ­£ç¡®ï¼Œåœ¨æ§åˆ¶å°çš„Networkæ¨¡å—å¯ä»¥çœ‹åˆ°HTTPè¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º101 Switching Protocolsï¼ŒåŒæ—¶å®¢æˆ·ç«¯çš„ws.onopenäº‹ä»¶è¢«è§¦å‘ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2019/3/13/16977a4514369b43?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="console"></p><pre><code class="js">socket.once(&#39;data&#39;, (buffer) =&gt; {  // æ¥æ”¶åˆ°HTTPè¯·æ±‚å¤´æ•°æ®  const str = buffer.toString()  console.log(str)  // 4. å°†è¯·æ±‚å¤´æ•°æ®è½¬ä¸ºå¯¹è±¡  const headers = parseHeader(str)  console.log(headers)  // 5. åˆ¤æ–­è¯·æ±‚æ˜¯å¦ä¸ºWebSocketè¿æ¥  if (headers[&#39;upgrade&#39;] !== &#39;websocket&#39;) {    // è‹¥å½“å‰è¯·æ±‚ä¸æ˜¯WebSocketè¿æ¥ï¼Œåˆ™å…³é—­è¿æ¥    console.log(&#39;éWebSocketè¿æ¥&#39;)    socket.end()  } else if (headers[&#39;sec-websocket-version&#39;] !== &#39;13&#39;) {    // åˆ¤æ–­WebSocketç‰ˆæœ¬æ˜¯å¦ä¸º13ï¼Œé˜²æ­¢æ˜¯å…¶ä»–ç‰ˆæœ¬ï¼Œé€ æˆå…¼å®¹é”™è¯¯    console.log(&#39;WebSocketç‰ˆæœ¬é”™è¯¯&#39;)    socket.end()  } else {      // 6. æ ¡éªŒSec-WebSocket-Keyï¼Œå®Œæˆè¿æ¥      /*         åè®®ä¸­è§„å®šçš„æ ¡éªŒç”¨GUIDï¼Œå¯å‚è€ƒå¦‚ä¸‹é“¾æ¥ï¼š        https://tools.ietf.org/html/rfc6455#section-5.5.2        https://stackoverflow.com/questions/13456017/what-does-258eafa5-e914-47da-95ca-c5ab0dc85b11-means-in-websocket-protocol      */      const GUID = &#39;258EAFA5-E914-47DA-95CA-C5AB0DC85B11&#39;      const key = headers[&#39;sec-websocket-key&#39;]      const hash = crypto.createHash(&#39;sha1&#39;)  // åˆ›å»ºä¸€ä¸ªç­¾åç®—æ³•ä¸ºsha1çš„å“ˆå¸Œå¯¹è±¡      hash.update(`${key}${GUID}`)  // å°†keyå’ŒGUIDè¿æ¥åï¼Œæ›´æ–°åˆ°hash      const result = hash.digest(&#39;base64&#39;) // ç”Ÿæˆbase64å­—ç¬¦ä¸²      const header = `HTTP/1.1 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-Websocket-Accept: ${result}\r\n\r\n` // ç”Ÿæˆä¾›å‰ç«¯æ ¡éªŒç”¨çš„è¯·æ±‚å¤´      socket.write(header)  // è¿”å›HTTPå¤´ï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯æ ¡éªŒç»“æœï¼ŒHTTPçŠ¶æ€ç 101è¡¨ç¤ºåˆ‡æ¢åè®®ï¼šhttps://httpstatuses.com/101ã€‚      // è‹¥å®¢æˆ·ç«¯æ ¡éªŒç»“æœæ­£ç¡®ï¼Œåœ¨æ§åˆ¶å°çš„Networkæ¨¡å—å¯ä»¥çœ‹åˆ°HTTPè¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º101 Switching Protocolsï¼ŒåŒæ—¶å®¢æˆ·ç«¯çš„ws.onopenäº‹ä»¶è¢«è§¦å‘ã€‚      console.log(header)      // å¤„ç†èŠå¤©æ•°æ®    }  })</code></pre><h2 id="å»ºç«‹è¿æ¥åï¼Œé€šè¿‡dataäº‹ä»¶æ¥æ”¶å®¢æˆ·ç«¯çš„æ•°æ®å¹¶å¤„ç†"><a href="#å»ºç«‹è¿æ¥åï¼Œé€šè¿‡dataäº‹ä»¶æ¥æ”¶å®¢æˆ·ç«¯çš„æ•°æ®å¹¶å¤„ç†" class="headerlink" title="å»ºç«‹è¿æ¥åï¼Œé€šè¿‡dataäº‹ä»¶æ¥æ”¶å®¢æˆ·ç«¯çš„æ•°æ®å¹¶å¤„ç†"></a>å»ºç«‹è¿æ¥åï¼Œé€šè¿‡dataäº‹ä»¶æ¥æ”¶å®¢æˆ·ç«¯çš„æ•°æ®å¹¶å¤„ç†</h2><p>è¿æ¥å¼€å§‹åï¼Œå¯ä»¥åœ¨æ§åˆ¶å°çš„Networkæ¨¡å—çœ‹åˆ°ï¼Œè¯¥è¿æ¥ä¼šä¸€ç›´ä¿ç•™åœ¨pendingçŠ¶æ€ï¼Œç›´åˆ°è¿æ¥æ–­å¼€ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2019/3/13/16977a4524cc9dca?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="console1"></p><p>æ­¤æ—¶å¯ä»¥é€šè¿‡dataäº‹ä»¶å¤„ç†å®¢æˆ·ç«¯çš„æ•°æ®ï¼Œä½†æ­¤æ—¶åŒæ–¹é€šä¿¡çš„æ•°æ®ä¸ºäºŒè¿›åˆ¶ï¼Œéœ€è¦æŒ‰ç…§å…¶æ ¼å¼è¿›è¡Œå¤„ç†åæ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p><p>æ ¼å¼å¦‚ä¸‹ï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2019/3/13/16977a45146a18d6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="console2"></p><p>å¤„ç†æ”¶åˆ°çš„æ•°æ®ï¼š</p><pre><code class="js">function decodeWsFrame(data) {  let start = 0;  let frame = {    isFinal: (data[start] &amp; 0x80) === 0x80,    opcode: data[start++] &amp; 0xF,    masked: (data[start] &amp; 0x80) === 0x80,    payloadLen: data[start++] &amp; 0x7F,    maskingKey: &#39;&#39;,    payloadData: null  };  if (frame.payloadLen === 126) {    frame.payloadLen = (data[start++] &lt;&lt; 8) + data[start++];  } else if (frame.payloadLen === 127) {    frame.payloadLen = 0;    for (let i = 7; i &gt;= 0; --i) {      frame.payloadLen += (data[start++] &lt;&lt; (i * 8));    }  }  if (frame.payloadLen) {    if (frame.masked) {      const maskingKey = [        data[start++],        data[start++],        data[start++],        data[start++]      ];      frame.maskingKey = maskingKey;      frame.payloadData = data        .slice(start, start + frame.payloadLen)        .map((byte, idx) =&gt; byte ^ maskingKey[idx % 4]);    } else {      frame.payloadData = data.slice(start, start + frame.payloadLen);    }  }  console.dir(frame)  return frame;}</code></pre><p>å¤„ç†å‘å‡ºçš„æ•°æ®ï¼š</p><pre><code class="js">function encodeWsFrame(data) {  const isFinal = data.isFinal !== undefined ? data.isFinal : true,    opcode = data.opcode !== undefined ? data.opcode : 1,    payloadData = data.payloadData ? Buffer.from(data.payloadData) : null,    payloadLen = payloadData ? payloadData.length : 0;  let frame = [];  if (isFinal) frame.push((1 &lt;&lt; 7) + opcode);  else frame.push(opcode);  if (payloadLen &lt; 126) {    frame.push(payloadLen);  } else if (payloadLen &lt; 65536) {    frame.push(126, payloadLen &gt;&gt; 8, payloadLen &amp; 0xFF);  } else {    frame.push(127);    for (let i = 7; i &gt;= 0; --i) {      frame.push((payloadLen &amp; (0xFF &lt;&lt; (i * 8))) &gt;&gt; (i * 8));    }  }  frame = payloadData ? Buffer.concat([Buffer.from(frame), payloadData]) : Buffer.from(frame);  console.dir(decodeWsFrame(frame));  return frame;}</code></pre><p>å¯¹èŠå¤©æ•°æ®è¿›è¡Œå¤„ç†ï¼š</p><pre><code class="js">socket.once(&#39;data&#39;, (buffer) =&gt; {  // æ¥æ”¶åˆ°HTTPè¯·æ±‚å¤´æ•°æ®  const str = buffer.toString()  console.log(str)  // 4. å°†è¯·æ±‚å¤´æ•°æ®è½¬ä¸ºå¯¹è±¡  const headers = parseHeader(str)  console.log(headers)  // 5. åˆ¤æ–­è¯·æ±‚æ˜¯å¦ä¸ºWebSocketè¿æ¥  if (headers[&#39;upgrade&#39;] !== &#39;websocket&#39;) {    // è‹¥å½“å‰è¯·æ±‚ä¸æ˜¯WebSocketè¿æ¥ï¼Œåˆ™å…³é—­è¿æ¥    console.log(&#39;éWebSocketè¿æ¥&#39;)    socket.end()  } else if (headers[&#39;sec-websocket-version&#39;] !== &#39;13&#39;) {    // åˆ¤æ–­WebSocketç‰ˆæœ¬æ˜¯å¦ä¸º13ï¼Œé˜²æ­¢æ˜¯å…¶ä»–ç‰ˆæœ¬ï¼Œé€ æˆå…¼å®¹é”™è¯¯    console.log(&#39;WebSocketç‰ˆæœ¬é”™è¯¯&#39;)    socket.end()  } else {      // 6. æ ¡éªŒSec-WebSocket-Keyï¼Œå®Œæˆè¿æ¥      /*         åè®®ä¸­è§„å®šçš„æ ¡éªŒç”¨GUIDï¼Œå¯å‚è€ƒå¦‚ä¸‹é“¾æ¥ï¼š        https://tools.ietf.org/html/rfc6455#section-5.5.2        https://stackoverflow.com/questions/13456017/what-does-258eafa5-e914-47da-95ca-c5ab0dc85b11-means-in-websocket-protocol      */      const GUID = &#39;258EAFA5-E914-47DA-95CA-C5AB0DC85B11&#39;      const key = headers[&#39;sec-websocket-key&#39;]      const hash = crypto.createHash(&#39;sha1&#39;)  // åˆ›å»ºä¸€ä¸ªç­¾åç®—æ³•ä¸ºsha1çš„å“ˆå¸Œå¯¹è±¡      hash.update(`${key}${GUID}`)  // å°†keyå’ŒGUIDè¿æ¥åï¼Œæ›´æ–°åˆ°hash      const result = hash.digest(&#39;base64&#39;) // ç”Ÿæˆbase64å­—ç¬¦ä¸²      const header = `HTTP/1.1 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-Websocket-Accept: ${result}\r\n\r\n` // ç”Ÿæˆä¾›å‰ç«¯æ ¡éªŒç”¨çš„è¯·æ±‚å¤´      socket.write(header)  // è¿”å›HTTPå¤´ï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯æ ¡éªŒç»“æœï¼ŒHTTPçŠ¶æ€ç 101è¡¨ç¤ºåˆ‡æ¢åè®®ï¼šhttps://httpstatuses.com/101ã€‚      // è‹¥å®¢æˆ·ç«¯æ ¡éªŒç»“æœæ­£ç¡®ï¼Œåœ¨æ§åˆ¶å°çš„Networkæ¨¡å—å¯ä»¥çœ‹åˆ°HTTPè¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º101 Switching Protocolsï¼ŒåŒæ—¶å®¢æˆ·ç«¯çš„ws.onopenäº‹ä»¶è¢«è§¦å‘ã€‚      console.log(header)      // 7. å»ºç«‹è¿æ¥åï¼Œé€šè¿‡dataäº‹ä»¶æ¥æ”¶å®¢æˆ·ç«¯çš„æ•°æ®å¹¶å¤„ç†      socket.on(&#39;data&#39;, (buffer) =&gt; {        const data = decodeWsFrame(buffer)        console.log(data)        console.log(data.payloadData &amp;&amp; data.payloadData.toString())        // opcodeä¸º8ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯å‘èµ·äº†æ–­å¼€è¿æ¥        if (data.opcode === 8) {          socket.end()  // ä¸å®¢æˆ·ç«¯æ–­å¼€è¿æ¥        } else {          // æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®æ—¶çš„å¤„ç†ï¼Œæ­¤å¤„é»˜è®¤ä¸ºè¿”å›æ¥æ”¶åˆ°çš„æ•°æ®ã€‚          socket.write(encodeWsFrame({ payloadData: `æœåŠ¡ç«¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¸ºï¼š${data.payloadData ? data.payloadData.toString() : &#39;&#39;}` }))        }      })    }  })</code></pre><p>è¿™æ ·ï¼Œä¸€ä¸ªç®€å•çš„åŸºäºWebSocketçš„èŠå¤©åº”ç”¨å°±åˆ›å»ºå®Œæˆäº†ï¼Œåœ¨å¯åŠ¨æœåŠ¡å™¨åï¼Œå¯ä»¥æ‰“å¼€index.htmlçœ‹åˆ°æ•ˆæœã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (å…«)--Ajaxè·¨åŸŸ</title>
      <link href="/2019/04/20/Node/Node%E5%AD%A6%E4%B9%A0(%E5%85%AB)%20--Ajax%E8%B7%A8%E5%9F%9F/"/>
      <url>/2019/04/20/Node/Node%E5%AD%A6%E4%B9%A0(%E5%85%AB)%20--Ajax%E8%B7%A8%E5%9F%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="Ajaxè·¨åŸŸé—®é¢˜çš„äº§ç”ŸåŸå› "><a href="#Ajaxè·¨åŸŸé—®é¢˜çš„äº§ç”ŸåŸå› " class="headerlink" title="Ajaxè·¨åŸŸé—®é¢˜çš„äº§ç”ŸåŸå› "></a>Ajaxè·¨åŸŸé—®é¢˜çš„äº§ç”ŸåŸå› </h2><p>Ajaxè¯·æ±‚æ— æ³•è·¨åŸŸï¼Œåœ¨å‰ç«¯å¼€å‘ä¸­æ˜¯ä¸ªå¸¸è§é—®é¢˜ï¼Œå®ƒçš„äº§ç”ŸåŸå› æ˜¯ï¼Œ<strong>åœ¨æµè§ˆå™¨æ¥æ”¶æœåŠ¡ç«¯è¿”å›æ•°æ®æ—¶ï¼Œä¼šæ£€æŸ¥è¯¥æ•°æ®æ˜¯å¦å’Œå½“å‰å‘èµ·è¯·æ±‚çš„ç½‘å€åœ¨åŒä¸€åŸŸåä¸‹ã€‚è‹¥ä¸æ˜¯ï¼Œåˆ™ä¼šä¸¢å¼ƒè¯¥æ•°æ®ï¼Œå¹¶è¿”å›ä¸€ä¸ªè·¨åŸŸé”™è¯¯</strong>ã€‚</p><blockquote><p>åœ¨Ajaxè¯·æ±‚ä¸­ï¼Œéµå¾ªå¦‚ä¸‹æµç¨‹ï¼š<br>ç½‘é¡µæäº¤ä¸€ä¸ªAjaxè¯·æ±‚åˆ°æµè§ˆå™¨ï¼Œæµè§ˆå™¨å°†è¯·æ±‚å‘è‡³æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œè¿”å›å“åº”æ•°æ®ç»™æµè§ˆå™¨ï¼ˆæœåŠ¡å™¨é€šå¸¸ä¸ä¼šå¯¹åŸŸåè¿›è¡ŒåŒºåˆ†ï¼‰ï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°å“åº”æ•°æ®æ—¶ï¼Œæ£€æµ‹è¿”å›æ•°æ®çš„åŸŸåæ˜¯å¦å’Œå½“å‰é¡µé¢åŸŸåç›¸åŒï¼Œè‹¥ç›¸åŒåˆ™å°†æ•°æ®è¿”å›ç»™ç½‘é¡µï¼Œä¸åŒåˆ™ä¸¢å¼ƒæ•°æ®ã€‚</p></blockquote><h2 id="Ajaxè·¨åŸŸçš„å¤„ç†æ–¹æ³•"><a href="#Ajaxè·¨åŸŸçš„å¤„ç†æ–¹æ³•" class="headerlink" title="Ajaxè·¨åŸŸçš„å¤„ç†æ–¹æ³•"></a>Ajaxè·¨åŸŸçš„å¤„ç†æ–¹æ³•</h2><p>æ—¢ç„¶è·¨åŸŸé—®é¢˜çš„äº§ç”ŸåŸå› åœ¨äºæµè§ˆå™¨çš„é™åˆ¶ï¼Œé‚£ä¹ˆç½‘é¡µç«¯åœ¨è¯·æ±‚æ—¶æ— æ³•ä¸»åŠ¨è§„é¿ï¼Œæ­¤æ—¶å°±éœ€è¦æœåŠ¡ç«¯è¿›è¡Œå¤„ç†ã€‚</p><p>æœåŠ¡ç«¯åªéœ€è¦åœ¨å“åº”Ajaxè¯·æ±‚æ—¶ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŠ å…¥ä¸€ä¸ª<code>Access-Control-Allow-Origin</code>å±æ€§ï¼Œå¹¶è®¾ç½®ä¸º<code>*</code>ï¼ˆè¡¨ç¤ºå…¨éƒ¨åŸŸåï¼‰æˆ–è€…å½“å‰åŸŸåå°±å¯ä»¥è®©æµè§ˆå™¨ä¸å†è¿›è¡Œé™åˆ¶.</p><pre><code class="js">const http = require(&#39;http&#39;)const server = http.createServer((req, res) =&gt; {  console.log(req.headers.origin)  res.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;)  res.write(`{&quot;resultCode&quot;: &quot;0000&quot;, &quot;msg&quot;: &quot;success&quot;}`)  res.end()})server.listen(8080)</code></pre><p>å½“ç„¶åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä¸å¯ä»¥ç®€å•åœ°è®¾ç½®<code>res.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;)</code>ï¼Œè€Œæ˜¯è¦é€šè¿‡<code>req.headers.origin</code>åˆ¤æ–­å‘èµ·è¯·æ±‚çš„åŸŸåæ˜¯å¦åˆæ³•ï¼Œå†è®¾ç½®<code>Access-Control-Allow-Origin</code>å±æ€§ï¼Œä»¥å…å‡ºç°å®‰å…¨é—®é¢˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (ä¸ƒ) --POSTæ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2019/04/04/Node/Node%E5%AD%A6%E4%B9%A0(%E4%B8%83)%20--POST%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2019/04/04/Node/Node%E5%AD%A6%E4%B9%A0(%E4%B8%83)%20--POST%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ä¾‹å­"><a href="#ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ä¾‹å­" class="headerlink" title="ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ä¾‹å­"></a>ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ä¾‹å­</h2><p>å¤„ç†æ–‡ä»¶ä¸Šä¼ æ•°æ®ï¼Œä¹Ÿæ˜¯å‰åç«¯äº¤äº’ä¸­é‡è¦çš„åŠŸèƒ½ï¼Œå®ƒçš„å¤„ç†æ–¹å¼ä¸æ•°æ®ä¸åŒã€‚</p><p>æ¥ä¸‹æ¥ï¼Œé€šè¿‡ä¸€ä¸ªä¾‹å­æŸ¥çœ‹æœåŠ¡ç«¯æ¥æ”¶åˆ°çš„æ–‡ä»¶ä¸Šä¼ æ•°æ®ã€‚</p><p>é¦–å…ˆï¼Œåœ¨<code>post_file.html</code>ä¸­ï¼Œæ–°å»ºä¸€ä¸ªç”¨ä¸ä¸Šä¼ æ–‡ä»¶çš„è¡¨å•ï¼š</p><p><code>form</code>çš„å±æ€§<code>enctype=&quot;multipart/form-data&quot;</code>ä»£è¡¨è¡¨å•ä¸Šä¼ çš„æ˜¯æ–‡ä»¶ã€‚</p><p><code>enctype</code>çš„é»˜è®¤å€¼ä¸º<code>enctype=&quot;application/x-www-form-urlencoded&quot;</code>è¡¨ç¤ºä¸Šä¼ çš„æ˜¯æ•°æ®ç±»å‹ï¼Œæ­¤æ—¶æœåŠ¡ç«¯æ¥æ”¶åˆ°çš„æ•°æ®ä¸ºâ€œusername=lee&amp;password=123456&amp;file=upload.txtâ€ã€‚</p><pre><code class="js">&lt;form action=&quot;http://localhost:8080/upload&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;  ç”¨æˆ·ï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;lee&quot;&gt;&lt;br/&gt;  å¯†ç ï¼š&lt;input type=&quot;password&quot; name=&quot;password&quot; value=&quot;123456&quot;&gt;&lt;br/&gt;  &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;&quot;&gt;&lt;br/&gt;  &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;&lt;/form&gt;</code></pre><p>å…¶æ¬¡ï¼Œåœ¨server.jsä¸­ï¼ŒæŸ¥çœ‹æ¥æ”¶åˆ°çš„è¡¨å•æäº¤æ•°æ®ï¼š</p><pre><code class="js">const http = require(&#39;http&#39;)const server = http.createServer((req, res) =&gt; {  let arr = []  req.on(&#39;data&#39;, (buffer) =&gt; {    arr.push(buffer)  })  req.on(&#39;end&#39;, () =&gt; {    let buffer = Buffer.concat(arr)    console.log(buffer.toString())  })})server.listen(8080)</code></pre><p>æœ€åï¼Œåœ¨è¡¨å•ä¸­ä¸Šä¼ /lesson16/upload.txtæ–‡ä»¶ï¼Œå¹¶æŸ¥çœ‹æ‰“å°å‡ºçš„ç»“æœï¼š</p><pre><code class="js">------WebKitFormBoundaryL5AGcit70yhKB92YContent-Disposition: form-data; name=&quot;username&quot;lee------WebKitFormBoundaryL5AGcit70yhKB92YContent-Disposition: form-data; name=&quot;password&quot;123456Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;upload.txt&quot;Content-Type: text/plainupload------WebKitFormBoundaryL5AGcit70yhKB92Y--</code></pre><h2 id="æ–‡ä»¶ä¸Šä¼ æ•°æ®åˆ†æ"><a href="#æ–‡ä»¶ä¸Šä¼ æ•°æ®åˆ†æ" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ•°æ®åˆ†æ"></a>æ–‡ä»¶ä¸Šä¼ æ•°æ®åˆ†æ</h2><p>é€šè¿‡åˆ†æä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼ŒæœåŠ¡ç«¯æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p><p><code>.è¡¨å•ä¸Šä¼ çš„æ•°æ®ï¼Œè¢«åˆ†éš”ç¬¦â€œ------WebKitFormBoundaryL5AGcit70yhKB92Yâ€éš”å¼€ï¼Œåˆ†éš”ç¬¦åœ¨æ¯æ¬¡ä¸Šä¼ æ—¶éƒ½ä¸åŒã€‚åˆ†éš”ç¬¦æ•°æ®å¯ä»¥ä»</code>req.headers[â€˜content-typeâ€™]<code>ä¸­è·å–ï¼Œå¦‚ï¼š</code>const boundary = â€˜â€“â€™ + req.headers[â€˜content-typeâ€™].split(â€˜; â€˜)[1].split(â€˜=â€™)[1]`ã€‚</p><p>2.å‰ä¸¤æ®µæ•°æ®ä¸­ï¼Œåˆ†åˆ«å¯ä»¥è·å–åˆ°è¡¨å•ä¸Šä¼ çš„å­—æ®µåname=â€usernameâ€ï¼Œä»¥åŠæ•°æ®â€œleeâ€ã€‚</p><p>3.ç¬¬ä¸‰æ®µæ•°æ®ä¸­ï¼Œå¤šäº†ä¸€ä¸ªå­—æ®µfilename=â€upload.txtâ€ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æ–‡ä»¶çš„åŸå§‹åç§°ã€‚ä»¥åŠå¯ä»¥è·å–åˆ°æ–‡ä»¶ç±»å‹â€œContent-Type: text/plainâ€ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚æœ€åæ˜¯æ–‡ä»¶çš„å†…å®¹â€œuploadâ€ã€‚</p><p>ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œæ–‡ä»¶ä¸Šä¼ æ•°æ®è™½ç„¶æœ‰äº›ä¹±ï¼Œä½†è¿˜æ˜¯æœ‰è§„å¾‹çš„ï¼Œé‚£ä¹ˆå¤„ç†æ€è·¯å°±æ˜¯æŒ‰ç…§è§„å¾‹ï¼Œå°†æ•°æ®åˆ‡å‰²ä¹‹åï¼Œå–å‡ºå…¶ä¸­æœ‰ç”¨çš„éƒ¨åˆ†ã€‚</p><h2 id="æ–‡ä»¶ä¸Šä¼ æ•°æ®ç®€åŒ–"><a href="#æ–‡ä»¶ä¸Šä¼ æ•°æ®ç®€åŒ–" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ•°æ®ç®€åŒ–"></a>æ–‡ä»¶ä¸Šä¼ æ•°æ®ç®€åŒ–</h2><p>å…ˆå›é¡¾ä¸€ä¸‹ä¸Šé¢çš„æ•°æ®ï¼Œå¹¶å°†å›è½¦ç¬¦æ ‡è®°å‡ºæ¥ï¼š</p><pre><code class="js">------WebKitFormBoundaryL5AGcit70yhKB92Y\r\nContent-Disposition: form-data; name=&quot;username&quot;\r\n\r\nlee\r\n------WebKitFormBoundaryL5AGcit70yhKB92Y\r\nContent-Disposition: form-data; name=&quot;password&quot;\r\n\r\n123456\r\nContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;upload.txt&quot;\r\nContent-Type: text/plain\r\n\r\nupload\r\n------WebKitFormBoundaryL5AGcit70yhKB92Y--</code></pre><a id="more"></a><p>å¯ä»¥çœ‹å‡ºï¼Œæ¯æ®µæ•°æ®çš„ç»“æ„å…¶å®æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class="js">------WebKitFormBoundaryL5AGcit70yhKB92Y\r\nContent-Disposition: form-data; name=&quot;username&quot;\r\n\r\nlee\r\</code></pre><p>å°†æ¯æ®µä¸Šä¼ æ•°æ®ç®€åŒ–å¦‚ä¸‹ï¼š</p><pre><code class="js">&lt;åˆ†éš”ç¬¦&gt;\r\nå­—æ®µå¤´\r\n\r\nå†…å®¹\r\n</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä¸ªè¡¨å•çš„æ•°æ®ï¼Œå°±æ˜¯æŒ‰ç…§è¿™æ ·çš„æ•°æ®æ ¼å¼ç»„è£…è€Œæˆã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¡¨å•æ•°æ®çš„ç»“å°¾ä¸å†æ˜¯\r\nï¼Œè€Œæ˜¯â€œâ€“â€ã€‚</p><h2 id="æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†æ­¥éª¤"><a href="#æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†æ­¥éª¤" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†æ­¥éª¤"></a>æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†æ­¥éª¤</h2><p>1.ç”¨&lt;åˆ†éš”ç¬¦&gt;åˆ‡åˆ†æ•°æ®ï¼š</p><p>2.åˆ é™¤æ•°ç»„å¤´å°¾æ•°æ®ï¼š</p><p>3.å°†æ¯ä¸€é¡¹æ•°æ®å¤´å°¾çš„çš„\r\nåˆ é™¤ï¼š</p><p>4.å°†æ¯ä¸€é¡¹æ•°æ®ä¸­é—´çš„\r\n\r\nåˆ é™¤ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœï¼š</p><h2 id="Bufferçš„æ•°æ®å¤„ç†"><a href="#Bufferçš„æ•°æ®å¤„ç†" class="headerlink" title="Bufferçš„æ•°æ®å¤„ç†"></a>Bufferçš„æ•°æ®å¤„ç†</h2><p>ç”±äºæ–‡ä»¶éƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä¸èƒ½ç›´æ¥å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²åå†è¿›è¡Œå¤„ç†ï¼Œå¦åˆ™æ•°æ®ä¼šå‡ºé”™ï¼Œå› æ­¤è¦é€šè¿‡Bufferæ¨¡å—è¿›è¡Œæ•°æ®å¤„ç†æ“ä½œã€‚</p><p>Bufferæ¨¡å—æä¾›äº†indexOfæ–¹æ³•è·å–Bufferæ•°æ®ä¸­ï¼Œå…¶å‚æ•°æ‰€åœ¨ä½ç½®çš„indexå€¼ã€‚</p><p>Bufferæ¨¡å—æä¾›äº†sliceæ–¹æ³•ï¼Œå¯é€šè¿‡indexå€¼åˆ‡åˆ†Bufferæ•°æ®ã€‚</p><pre><code class="js">let buffer = Buffer.from(&#39;lee\r\nchen\r\ntest&#39;)const index = buffer.indexOf(&#39;\r\n&#39;)console.log(index)console.log(buffer.slice(0, index).toString())</code></pre><p>å¯ä»¥çœ‹åˆ°æ‰“å°ç»“æœåˆ†åˆ«ä¸º3å’Œâ€leeâ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°äº†â€\r\nâ€æ‰€åœ¨çš„indexä¸º3ï¼Œä¹‹åä»Bufferæ•°æ®çš„indexä¸º0çš„ä½ç½®ï¼Œåˆ‡å‰²åˆ°indexä¸º3çš„ä½ç½®ï¼Œå¾—åˆ°äº†æ­£ç¡®çš„ç»“æœã€‚</p><p>ç”±æ­¤ï¼Œå¯ä»¥å°è£…ä¸€ä¸ªä¸“é—¨ç”¨äºåˆ‡å‰²Bufferæ•°æ®çš„æ–¹æ³•ï¼š</p><pre><code class="js">module.exports = function bufferSplit(buffer, separator) {  let result = [];  let index = 0;  while ((index = buffer.indexOf(separator)) != -1) {    result.push(buffer.slice(0, index));    buffer = buffer.slice(index + separator.length);  }  result.push(buffer);  return result;}</code></pre><p>æœ‰äº†bufferSplitæ–¹æ³•ï¼Œå°±å¯ä»¥æ­£å¼å¼€å§‹å¤„ç†æ•°æ®äº†ã€‚</p><h2 id="æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†"><a href="#æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†"></a>æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†</h2><p>æ ¹æ®ä¸Šé¢çš„æ€è·¯ï¼Œå°±å¯ä»¥å®ç°ä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹ã€‚</p><pre><code class="js">const http = require(&#39;http&#39;)const fs = require(&#39;fs&#39;)const bufferSplit = require(&#39;./bufferSplit&#39;)const server = http.createServer((req, res) =&gt; {  const boundary = `--${req.headers[&#39;content-type&#39;].split(&#39;; &#39;)[1].split(&#39;=&#39;)[1]}`  // è·å–åˆ†éš”ç¬¦  let arr = []  req.on(&#39;data&#39;, (buffer) =&gt; {    arr.push(buffer)  })  req.on(&#39;end&#39;, () =&gt; {    const buffer = Buffer.concat(arr)    console.log(buffer.toString())    // 1. ç”¨&lt;åˆ†éš”ç¬¦&gt;åˆ‡åˆ†æ•°æ®    let result = bufferSplit(buffer, boundary)    console.log(result.map(item =&gt; item.toString()))    // 2. åˆ é™¤æ•°ç»„å¤´å°¾æ•°æ®    result.pop()    result.shift()    console.log(result.map(item =&gt; item.toString()))    // 3. å°†æ¯ä¸€é¡¹æ•°æ®å¤´å°¾çš„çš„\r\nåˆ é™¤    result = result.map(item =&gt; item.slice(2, item.length - 2))    console.log(result.map(item =&gt; item.toString()))    // 4. å°†æ¯ä¸€é¡¹æ•°æ®ä¸­é—´çš„\r\n\r\nåˆ é™¤ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœ    result.forEach(item =&gt; {      console.log(bufferSplit(item, &#39;\r\n\r\n&#39;).map(item =&gt; item.toString()))      let [info, data] = bufferSplit(item, &#39;\r\n\r\n&#39;)  // æ•°æ®ä¸­å«æœ‰æ–‡ä»¶ä¿¡æ¯ï¼Œä¿æŒä¸ºBufferç±»å‹      info = info.toString()  // infoä¸ºå­—æ®µä¿¡æ¯ï¼Œè¿™æ˜¯å­—ç¬¦ä¸²ç±»å‹æ•°æ®ï¼Œç›´æ¥è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè‹¥ä¸ºæ–‡ä»¶ä¿¡æ¯ï¼Œåˆ™æ•°æ®ä¸­å«æœ‰ä¸€ä¸ªå›è½¦ç¬¦\r\nï¼Œå¯ä»¥æ®æ­¤åˆ¤æ–­æ•°æ®ä¸ºæ–‡ä»¶è¿˜æ˜¯ä¸ºæ™®é€šæ•°æ®ã€‚      if (info.indexOf(&#39;\r\n&#39;) &gt;= 0) {  // è‹¥ä¸ºæ–‡ä»¶ä¿¡æ¯ï¼Œåˆ™å°†Bufferè½¬ä¸ºæ–‡ä»¶ä¿å­˜        // è·å–å­—æ®µå        let infoResult = info.split(&#39;\r\n&#39;)[0].split(&#39;; &#39;)        let name = infoResult[1].split(&#39;=&#39;)[1]        name = name.substring(1, name.length - 1)        // è·å–æ–‡ä»¶å        let filename = infoResult[2].split(&#39;=&#39;)[1]        filename = filename.substring(1, filename.length - 1)        console.log(name)        console.log(filename)        // å°†æ–‡ä»¶å­˜å‚¨åˆ°æœåŠ¡å™¨        fs.writeFile(`./upload/${filename}`, data, err =&gt; {          if (err) {            console.log(err)          } else {            console.log(&#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ&#39;)          }        })      } else {  // è‹¥ä¸ºæ•°æ®ï¼Œåˆ™ç›´æ¥è·å–å­—æ®µåç§°å’Œå€¼        let name = info.split(&#39;; &#39;)[1].split(&#39;=&#39;)[1]        name = name.substring(1, name.length - 1)        const value = data.toString()        console.log(name, value)      }    })  })})server.listen(8080)</code></pre><h2 id="multiparty"><a href="#multiparty" class="headerlink" title="multiparty"></a>multiparty</h2><p>æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥å®ŒæˆPOSTè¯·æ±‚çš„å¤„ç†ï¼Œå¦‚<a href="https://github.com/pillarjs/multiparty" target="_blank" rel="noopener">multiparty</a>ã€‚</p><h3 id="multiparty-demo"><a href="#multiparty-demo" class="headerlink" title="multiparty demo"></a>multiparty demo</h3><p>é€šè¿‡å¦‚ä¸‹ä¾‹å­ï¼Œå¯ä»¥æµ‹è¯•ä¸€ä¸‹multipartyçš„åŠŸèƒ½ã€‚</p><p>å®ƒä¼šåœ¨fieldäº‹ä»¶ä¸­ï¼Œå°†æ•°æ®ä¿¡æ¯çš„å­—æ®µåå’Œå€¼è¿”å›ã€‚åœ¨fileäº‹ä»¶ä¸­ï¼Œå°†æ–‡ä»¶çš„å­—æ®µåå’Œä¿¡æ¯è¿”å›ã€‚</p><p>ä¸Šä¼ æˆåŠŸåï¼Œä¼šåœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹åˆ›å»ºä¸€ä¸ªä¸Šä¼ çš„æ–‡ä»¶ï¼Œå¹¶ä¼šå°†æ–‡ä»¶é‡å‘½åï¼ˆå¦‚ï¼šIqUHkFe0u2h2TsiBztjKxoBR.jpgï¼‰ï¼Œä»¥é˜²æ­¢é‡åã€‚</p><p>è‹¥ä¸Šä¼ å‡ºç°å¤±è´¥ï¼Œå·²ä¿å­˜çš„æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ é™¤ã€‚</p><p>closeäº‹ä»¶è¡¨ç¤ºè¡¨å•æ•°æ®å…¨éƒ¨è§£æå®Œæˆï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­å¤„ç†å·²ç»æ¥æ”¶åˆ°çš„ä¿¡æ¯ã€‚</p><pre><code class="js">const http = require(&#39;http&#39;)const multiparty = require(&#39;multiparty&#39;)const server = http.createServer((req, res) =&gt; {  const form = new multiparty.Form({    uploadDir: &#39;./upload&#39; // æŒ‡å®šæ–‡ä»¶å­˜å‚¨ç›®å½•  })  form.parse(req) // å°†è¯·æ±‚å‚æ•°ä¼ å…¥ï¼Œmultipartyä¼šè¿›è¡Œç›¸åº”å¤„ç†  form.on(&#39;field&#39;, (name, value) =&gt; { // æ¥æ”¶åˆ°æ•°æ®å‚æ•°æ—¶ï¼Œè§¦å‘fieldäº‹ä»¶    console.log(name, value)  })  form.on(&#39;file&#39;, (name, file, ...rest) =&gt; { // æ¥æ”¶åˆ°æ–‡ä»¶å‚æ•°æ—¶ï¼Œè§¦å‘fileäº‹ä»¶    console.log(name, file)  })  form.on(&#39;close&#39;, () =&gt; {  // è¡¨å•æ•°æ®è§£æå®Œæˆï¼Œè§¦å‘closeäº‹ä»¶    console.log(&#39;è¡¨å•æ•°æ®è§£æå®Œæˆ&#39;)  })})server.listen(8080)</code></pre>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (å…­) --åŸºæœ¬æ¨¡å—</title>
      <link href="/2019/04/01/Node/Node%E5%AD%A6%E4%B9%A0(%E5%85%AD)%20--%E5%9F%BA%E6%9C%AC%E6%A8%A1%E5%9D%97/"/>
      <url>/2019/04/01/Node/Node%E5%AD%A6%E4%B9%A0(%E5%85%AD)%20--%E5%9F%BA%E6%9C%AC%E6%A8%A1%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<h2 id="assert-æ–­è¨€"><a href="#assert-æ–­è¨€" class="headerlink" title="assert (æ–­è¨€)"></a>assert (æ–­è¨€)</h2><p>assertï¼ˆæ–­è¨€ï¼‰é€šå¸¸ç”¨æ¥å¯¹ä»£ç è¿›è¡Œæ ¡éªŒï¼Œè‹¥å‡ºé”™åˆ™é˜»æ­¢ç¨‹åºè¿è¡Œï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><pre><code class="js">const assert = require(&#39;assert&#39;)assert(2 &gt; 1, &#39;2 &gt; 1&#39;)assert(1 &gt; 2, &#39;1 &gt; 2&#39;)</code></pre><p>ä»£ç åœ¨è¿è¡Œåˆ°assert(2 &gt; 1, â€˜2 &gt; 1â€™)æ—¶ï¼Œç”±äº2 &gt; 1ä¸ºtrueï¼Œæ­¤æ—¶ä¸ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><p>è€Œè¿è¡Œåˆ°assert(1 &gt; 2, â€˜1 &gt; 2â€™)æ—¶ï¼Œç”±äº1 &gt; 2ä¸ºfalseï¼Œæ­¤æ—¶ä¼šæŠ›å‡ºé”™è¯¯å¦‚ä¸‹ï¼š</p><pre><code class="js">AssertionError [ERR_ASSERTION]: 1 &gt; 2    at Object.&lt;anonymous&gt; (C:\projects\nodejs-tutorial\lesson11\assert.js:5:1)    at Module._compile (internal/modules/cjs/loader.js:734:30)    at Object.Module._extensions..js (internal/modules/cjs/loader.js:745:10)    at Module.load (internal/modules/cjs/loader.js:626:32)    at tryModuleLoad (internal/modules/cjs/loader.js:566:12)    at Function.Module._load (internal/modules/cjs/loader.js:558:3)    at Function.Module.runMain (internal/modules/cjs/loader.js:797:12)    at executeUserCode (internal/bootstrap/node.js:526:15)    at startMainThreadExecution (internal/bootstrap/node.js:439:3)</code></pre><h3 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h3><p>é€šå¸¸å¯ä»¥åœ¨ä¸€ä¸ªæ¨¡å—æˆ–å‡½æ•°çš„æ¯ä¸ªé˜¶æ®µä½¿ç”¨assertï¼Œæˆ–è€…åœ¨å¯¹å‡½æ•°ä¼ å‚è¿›è¡Œassertæ ¡éªŒï¼Œä»¥ä¿è¯ä»£ç è¿è¡Œçš„æ­£ç¡®æ€§ã€‚</p><h3 id="assert-deepStrictEqual"><a href="#assert-deepStrictEqual" class="headerlink" title="assert.deepStrictEqual"></a>assert.deepStrictEqual</h3><p><code>assert.deepStrictEqual(actual, expected[, message])</code>ç”¨äºå¯¹actual å‚æ•°å’Œ expectedçš„æ·±åº¦æ¯”è¾ƒï¼Œå³ä¸ä»…æ ¡éªŒå®ƒä»¬æ˜¯å¦ç›¸ç­‰ï¼ŒåŒæ—¶ä¹Ÿè¦æ ¡éªŒå®ƒä»¬çš„æˆå‘˜ä¹‹é—´æ˜¯å¦ç›¸ç­‰ã€‚</p><p><code>assert.deepStrictEqual</code>åœ¨æ ¡éªŒå¯¹è±¡æˆ–æ•°ç»„æ—¶æ¯”è¾ƒæœ‰ç”¨ã€‚</p><p><code>assert.deepStrictEqual</code>çš„æ¯”è¾ƒç›¸å½“äº<code>===</code>ï¼Œä¹Ÿå°±æ˜¯ä¸ä»…æ˜¯å€¼ç›¸ç­‰ï¼Œå€¼çš„ç±»å‹ä¹Ÿè¦ç›¸ç­‰ã€‚</p><h3 id="assert-deepStrictEqualçš„ç”¨æ³•"><a href="#assert-deepStrictEqualçš„ç”¨æ³•" class="headerlink" title="assert.deepStrictEqualçš„ç”¨æ³•"></a>assert.deepStrictEqualçš„ç”¨æ³•</h3><p>1.ä½¿ç”¨<code>assert.deepStrictEqual</code>æ¯”è¾ƒå¯¹è±¡ï¼š</p><pre><code class="js">const assert = require(&#39;assert&#39;)const obj1 = {  a: 1,  b: 2,  children: {    c: 3  }}const obj2 = {  a: 1,  b: 2,  children: {    c: 3  }}const obj3 = {  a: 1,  b: 2,  children: {    c: &#39;3&#39;  }}assert.deepStrictEqual(obj1, obj2, &#39;obj1 !== obj2&#39;)assert.deepStrictEqual(obj1, obj3, &#39;obj1 !== obj3&#39;)</code></pre><a id="more"></a><p>ä»£ç ä¼šæŠ›å‡ºé”™è¯¯ï¼šobj1 !== obj3ã€‚</p><p>2.ä½¿ç”¨<code>assert.deepStrictEqual</code>æ¯”è¾ƒæ•°ç»„</p><pre><code class="js">const assert = require(&#39;assert&#39;)const arr1 = [{  a: 1,  b: 2,  children: [{    c: 3  }]}]const arr2 = [{  a: 1,  b: 2,  children: [{    c: 3  }]}]const arr3 = [{  a: 1,  b: 2,  children: [{    c: &#39;3&#39;  }]}]assert.deepStrictEqual(arr1, arr2, &#39;arr1 !== arr2&#39;)assert.deepStrictEqual(arr1, arr3, &#39;arr1 !== arr3&#39;)</code></pre><h2 id="path-è·¯å¾„"><a href="#path-è·¯å¾„" class="headerlink" title="path(è·¯å¾„)"></a>path(è·¯å¾„)</h2><p>pathæ¨¡å—ä¸»è¦ç”¨æ¥å¯¹æ–‡ä»¶è·¯å¾„è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚æå–è·¯å¾„ã€åç¼€ï¼Œæ‹¼æ¥è·¯å¾„ç­‰ã€‚</p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><pre><code class="js">const path = require(&#39;path&#39;)const str = &#39;/root/a/b/1.txt&#39;console.log(path.dirname(str))  // è·å–æ–‡ä»¶ç›®å½•ï¼š/root/a/bconsole.log(path.basename(str)) // è·å–æ–‡ä»¶åï¼š1.txtconsole.log(path.extname(str)) // è·å–æ–‡ä»¶åç¼€ï¼š.txtconsole.log(path.resolve(str, &#39;../c&#39;, &#39;build&#39;, &#39;strict&#39;)) // å°†è·¯å¾„è§£æä¸ºç»å¯¹è·¯å¾„ï¼šC:\root\a\b\c\build\strictconsole.log(path.resolve(str, &#39;../c&#39;, &#39;build&#39;, &#39;strict&#39;, &#39;../..&#39;, &#39;assets&#39;)) // å°†è·¯å¾„è§£æä¸ºç»å¯¹è·¯å¾„ï¼šC:\root\a\b\c\assetsconsole.log(path.resolve(__dirname, &#39;build&#39;)) // å°†è·¯å¾„è§£æä¸ºç»å¯¹è·¯å¾„ï¼šC:\projects\nodejs-tutorial\lesson12\build</code></pre><p>å€¼å¾—ä¸€æçš„æ˜¯<code>path.resolve</code>æ–¹æ³•ï¼Œå®ƒå¯ä»¥æ¥æ”¶ä»»æ„ä¸ªå‚æ•°ï¼Œç„¶åæ ¹æ®æ¯ä¸ªè·¯å¾„å‚æ•°ä¹‹é—´çš„å…³ç³»ï¼Œå°†è·¯å¾„æœ€ç»ˆè§£æä¸ºä¸€ä¸ª<em>ç»å¯¹è·¯å¾„</em>ã€‚</p><p><code>__dirname</code>æŒ‡çš„æ˜¯å½“å‰æ¨¡å—æ‰€åœ¨çš„ç»å¯¹è·¯å¾„åç§°ï¼Œå®ƒçš„å€¼ä¼šè‡ªåŠ¨æ ¹æ®å½“å‰çš„ç»å¯¹è·¯å¾„å˜åŒ–ï¼Œç­‰åŒäº<code>path.dirname(__filename)</code>çš„ç»“æœã€‚</p><h2 id="URLæ¨¡å—"><a href="#URLæ¨¡å—" class="headerlink" title="URLæ¨¡å—"></a>URLæ¨¡å—</h2><h3 id="url-parse"><a href="#url-parse" class="headerlink" title="url.parse"></a>url.parse</h3><p>URLæ¨¡å—ç”¨äºå¯¹URLçš„è§£æï¼Œå¸¸ç”¨çš„æ˜¯url.parseæ–¹æ³•ã€‚</p><p>å‡è®¾æœ‰ä¸€ä¸ªurlä¸º<code>https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4</code>ï¼Œå¯ä»¥ç”¨url.parseæ–¹æ³•è¿›è¡Œè§£æã€‚</p><pre><code class="js">const url = require(&#39;url&#39;)const str = &#39;https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4&#39;console.log(url.parse(str))</code></pre><p>æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p><pre><code class="js">Url {  protocol: &#39;https:&#39;,  slashes: true,  auth: null,  host: &#39;www.google.com:8080&#39;,  port: &#39;8080&#39;,  hostname: &#39;www.google.com&#39;,  hash: null,  search: &#39;?x=1&amp;y=2&amp;y=3&amp;y=4&#39;,  query: &#39;x=1&amp;y=2&amp;y=3&amp;y=4&#39;,  pathname: &#39;/a/b&#39;,  path: &#39;/a/b?x=1&amp;y=2&amp;y=3&amp;y=4&#39;,  href: &#39;https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4&#39; }</code></pre><p>å¯ä»¥çœ‹åˆ°urlçš„ä¿¡æ¯å¦‚ç«¯å£å·ã€åŸŸåã€queryå‚æ•°ç­‰éƒ½è¢«è§£æå‡ºæ¥äº†ã€‚</p><p>å¦‚æœéœ€è¦å°†queryå‚æ•°è½¬ä¸ºå¯¹è±¡ï¼Œåˆ™å¯ä»¥ä¸ºurl.parseå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ trueï¼Œå¦‚<code>console.log(url.parse(str, true))</code>ï¼Œæ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p><pre><code class="js">Url {  protocol: &#39;https:&#39;,  slashes: true,  auth: null,  host: &#39;www.google.com:8080&#39;,  port: &#39;8080&#39;,  hostname: &#39;www.google.com&#39;,  hash: null,  search: &#39;?x=1&amp;y=2&amp;y=3&amp;y=4&#39;,  query: [Object: null prototype] { x: &#39;1&#39;, y: [ &#39;2&#39;, &#39;3&#39;, &#39;4&#39; ] },  pathname: &#39;/a/b&#39;,  path: &#39;/a/b?x=1&amp;y=2&amp;y=3&amp;y=4&#39;,  href: &#39;https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4&#39; }</code></pre><p>åŒæ—¶å¯ä»¥çœ‹åˆ°y=2&amp;y=3&amp;y=4å‚æ•°è¢«è§£æä¸ºäº†y: [ â€˜2â€™, â€˜3â€™, â€˜4â€™ ]ã€‚</p><h3 id="new-URL"><a href="#new-URL" class="headerlink" title="new URL()"></a>new URL()</h3><p>é™¤äº†ç”¨<code>url.parse</code>æ–¹æ³•è§£æurlï¼Œè¿˜å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°URLï¼Œåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå…¶ä¸­å¸¦æœ‰è§£æåçš„æ•°æ®ã€‚</p><p>å®ä¾‹æœ‰ä¸€ä¸ªtoStringæ–¹æ³•ï¼Œå¯ä»¥å°†å®ä¾‹è§£æä¸ºå­—ç¬¦ä¸²urlã€‚</p><pre><code class="js">const { URL } = require(&#39;url&#39;)const urlObj = new URL(str)console.log(urlObj)console.log(urlObj.toString())</code></pre><pre><code class="js">URL {  href: &#39;https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4&#39;,  origin: &#39;https://www.google.com:8080&#39;,  protocol: &#39;https:&#39;,  username: &#39;&#39;,  password: &#39;&#39;,  host: &#39;www.google.com:8080&#39;,  hostname: &#39;www.google.com&#39;,  port: &#39;8080&#39;,  pathname: &#39;/a/b&#39;,  search: &#39;?x=1&amp;y=2&amp;y=3&amp;y=4&#39;,  searchParams:   URLSearchParams { &#39;x&#39; =&gt; &#39;1&#39;, &#39;y&#39; =&gt; &#39;2&#39;, &#39;y&#39; =&gt; &#39;3&#39;, &#39;y&#39; =&gt; &#39;4&#39; },  hash: &#39;&#39; }https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4    // toStringæ–¹æ³•è§£æå‡ºçš„url</code></pre><h2 id="querystringæ¨¡å—"><a href="#querystringæ¨¡å—" class="headerlink" title="querystringæ¨¡å—"></a>querystringæ¨¡å—</h2><p>querystringç”¨æ¥å¯¹urlä¸­çš„queryå­—ç¬¦ä¸²è¿›è¡Œè§£æï¼Œå¸¸ç”¨çš„æ–¹æ³•æœ‰<code>querystring.parse</code>å’Œ<code>querystring.stringify</code>ã€‚</p><h3 id="querystring-parse"><a href="#querystring-parse" class="headerlink" title="querystring.parse"></a>querystring.parse</h3><p>querystring.parseæ–¹æ³•ç”¨äºè§£æURL æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚</p><pre><code class="js">const querystring = require(&#39;querystring&#39;)console.log(querystring.parse(&#39;foo=bar&amp;abc=xyz&amp;abc=123&#39;))//{ foo: &#39;bar&#39;, abc: [ &#39;xyz&#39;, &#39;123&#39; ] }</code></pre><h3 id="querystring-stringify"><a href="#querystring-stringify" class="headerlink" title="querystring.stringify"></a>querystring.stringify</h3><p>querystring.stringifyç”¨äºå°†å¯¹è±¡è½¬æ¢ä¸ºURLæŸ¥è¯¢å­—ç¬¦ä¸²ã€‚</p><pre><code class="js">console.log(querystring.stringify({ foo: &#39;bar&#39;, baz: [&#39;qux&#39;, &#39;quux&#39;], corge: &#39;&#39; }))// foo=bar&amp;baz=qux&amp;baz=quux&amp;corge=</code></pre><h2 id="netæ¨¡å—"><a href="#netæ¨¡å—" class="headerlink" title="netæ¨¡å—"></a>netæ¨¡å—</h2><p>net æ¨¡å—ç”¨äºåˆ›å»ºåŸºäºæµçš„ TCP æˆ– IPC çš„æœåŠ¡å™¨ï¼ˆnet.createServer()ï¼‰ä¸å®¢æˆ·ç«¯ï¼ˆnet.createConnection()ï¼‰ã€‚</p><p>netæ¨¡å—æ˜¯ä¸“é—¨ç”¨äºç½‘ç»œé€šä¿¡çš„æ¨¡å—ï¼Œè‹¥å½“å‰çš„æ•°æ®äº¤äº’ä¸é€šè¿‡HTTPåè®®ï¼Œå°±å¯ä»¥ä½¿ç”¨netæ¨¡å—ï¼Œå¦‚<code>WebSocket</code>ã€‚</p><p>HTTPåè®®æœ¬è´¨ä¸Šæ˜¯ä»¥æ–‡æœ¬å½¢å¼ä¼ è¾“æ•°æ®ï¼Œå®ƒçš„ä¼ è¾“æ•°æ®é‡è¾ƒå¤§ï¼Œè€Œä¸”å®ƒçš„ä¼ è¾“éœ€è¦äºŒè¿›åˆ¶å’Œæ–‡æœ¬ä¹‹é—´è¿›è¡Œè½¬æ¢å’Œè§£æã€‚</p><p>åœ¨nodejsä¸­ï¼ŒHTTPæ¨¡å—æ˜¯ç»§æ‰¿è‡ªnetæ¨¡å—çš„ã€‚</p><h3 id="OSIå‚è€ƒæ¨¡å‹"><a href="#OSIå‚è€ƒæ¨¡å‹" class="headerlink" title="OSIå‚è€ƒæ¨¡å‹"></a>OSIå‚è€ƒæ¨¡å‹</h3><p>OSIï¼ˆOpen System Interconnectï¼‰ï¼Œå³å¼€æ”¾å¼ç³»ç»Ÿäº’è”ã€‚ å®ƒæ˜¯ISOï¼ˆå›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼‰ç»„ç»‡åœ¨1985å¹´ç ”ç©¶çš„ç½‘ç»œäº’è”æ¨¡å‹ã€‚è¯¥ä½“ç³»ç»“æ„æ ‡å‡†å®šä¹‰äº†ç½‘ç»œäº’è”çš„ä¸ƒå±‚æ¡†æ¶ï¼ˆ<strong>ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚å’Œåº”ç”¨å±‚</strong>ï¼‰ï¼Œå³OSIå¼€æ”¾ç³»ç»Ÿäº’è¿å‚è€ƒæ¨¡å‹ã€‚åœ¨è¿™ä¸€æ¡†æ¶ä¸‹è¿›ä¸€æ­¥è¯¦ç»†è§„å®šäº†æ¯ä¸€å±‚çš„åŠŸèƒ½ï¼Œä»¥å®ç°å¼€æ”¾ç³»ç»Ÿç¯å¢ƒä¸­çš„äº’è¿æ€§ã€äº’æ“ä½œæ€§å’Œåº”ç”¨çš„å¯ç§»æ¤æ€§ã€‚</p><h3 id="OSIå‚è€ƒæ¨¡å‹åˆ†å±‚"><a href="#OSIå‚è€ƒæ¨¡å‹åˆ†å±‚" class="headerlink" title="OSIå‚è€ƒæ¨¡å‹åˆ†å±‚"></a>OSIå‚è€ƒæ¨¡å‹åˆ†å±‚</h3><p>OSIå‚è€ƒæ¨¡å‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸ƒå±‚ï¼š</p><p><strong>ç‰©ç†å±‚ â†’ æ•°æ®é“¾è·¯å±‚ â†’ ç½‘ç»œå±‚ï¼ˆIPåè®®ï¼‰ â†’ ä¼ è¾“å±‚ï¼ˆTCPå±‚ï¼‰ â†’ ä¼šè¯å±‚ â†’ è¡¨ç°å±‚ â†’ åº”ç”¨å±‚ï¼ˆHTTPåè®®ç­‰ï¼‰</strong></p><p>OSIå‚è€ƒæ¨¡å‹è¯¦ç»†ä»‹ç»å¦‚ä¸‹ï¼š</p><p>ç¬¬1å±‚ç‰©ç†å±‚ï¼šå¤„äºOSIå‚è€ƒæ¨¡å‹çš„æœ€åº•å±‚ã€‚ç‰©ç†å±‚çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨ç‰©ç†ä¼ è¾“ä»‹è´¨ä¸ºæ•°æ®é“¾è·¯å±‚æä¾›ç‰©ç†è¿æ¥ï¼Œä»¥ä¾¿é€æ˜çš„ä¼ é€æ¯”ç‰¹æµã€‚å¸¸ç”¨è®¾å¤‡æœ‰ï¼ˆå„ç§ç‰©ç†è®¾å¤‡ï¼‰ç½‘å¡ã€é›†çº¿å™¨ã€ä¸­ç»§å™¨ã€è°ƒåˆ¶è§£è°ƒå™¨ã€ç½‘çº¿ã€åŒç»çº¿ã€åŒè½´ç”µç¼†ã€‚</p><p>ç¬¬2å±‚æ•°æ®é“¾è·¯å±‚ï¼šåœ¨æ­¤å±‚å°†æ•°æ®åˆ†å¸§ï¼Œå¹¶å¤„ç†æµæ§åˆ¶ã€‚å±è”½ç‰©ç†å±‚ï¼Œä¸ºç½‘ç»œå±‚æä¾›ä¸€ä¸ªæ•°æ®é“¾è·¯çš„è¿æ¥ï¼Œåœ¨ä¸€æ¡æœ‰å¯èƒ½å‡ºå·®é”™çš„ç‰©ç†è¿æ¥ä¸Šï¼Œè¿›è¡Œå‡ ä¹æ— å·®é”™çš„æ•°æ®ä¼ è¾“ï¼ˆå·®é”™æ§åˆ¶ï¼‰ã€‚æœ¬å±‚æŒ‡å®šæ‹“æ‰‘ç»“æ„å¹¶æä¾›ç¡¬ä»¶å¯»å€ã€‚å¸¸ç”¨è®¾å¤‡æœ‰ç½‘æ¡¥ã€äº¤æ¢æœºï¼›</p><p>ç¬¬3å±‚ç½‘ç»œå±‚ï¼šæœ¬å±‚é€šè¿‡å¯»å€æ¥å»ºç«‹ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ï¼Œä¸ºæºç«¯çš„è¿è¾“å±‚é€æ¥çš„åˆ†ç»„ï¼Œé€‰æ‹©åˆé€‚çš„è·¯ç”±å’Œäº¤æ¢èŠ‚ç‚¹ï¼Œæ­£ç¡®æ— è¯¯åœ°æŒ‰ç…§åœ°å€ä¼ é€ç»™ç›®çš„ç«¯çš„è¿è¾“å±‚ã€‚å®ƒåŒ…æ‹¬é€šè¿‡äº’è¿ç½‘ç»œæ¥è·¯ç”±å’Œä¸­ç»§æ•°æ® ï¼›é™¤äº†é€‰æ‹©è·¯ç”±ä¹‹å¤–ï¼Œç½‘ç»œå±‚è¿˜è´Ÿè´£å»ºç«‹å’Œç»´æŠ¤è¿æ¥ï¼Œæ§åˆ¶ç½‘ç»œä¸Šçš„æ‹¥å¡ä»¥åŠåœ¨å¿…è¦çš„æ—¶å€™ç”Ÿæˆè®¡è´¹ä¿¡æ¯ã€‚</p><p>ç¬¬4å±‚ä¼ è¾“å±‚ï¼šâ€”å¸¸è§„æ•°æ®é€’é€ï¼é¢å‘è¿æ¥æˆ–æ— è¿æ¥ã€‚ä¸ºä¼šè¯å±‚ç”¨æˆ·æä¾›ä¸€ä¸ªç«¯åˆ°ç«¯çš„å¯é ã€é€æ˜å’Œä¼˜åŒ–çš„æ•°æ®ä¼ è¾“æœåŠ¡æœºåˆ¶ã€‚åŒ…æ‹¬å…¨åŒå·¥æˆ–åŠåŒå·¥ã€æµæ§åˆ¶å’Œé”™è¯¯æ¢å¤æœåŠ¡ï¼›ä¼ è¾“å±‚æŠŠæ¶ˆæ¯åˆ†æˆè‹¥å¹²ä¸ªåˆ†ç»„ï¼Œå¹¶åœ¨æ¥æ”¶ç«¯å¯¹å®ƒä»¬è¿›è¡Œé‡ç»„ã€‚ä¸åŒçš„åˆ†ç»„å¯ä»¥é€šè¿‡ä¸åŒçš„è¿æ¥ä¼ é€åˆ°ä¸»æœºã€‚è¿™æ ·æ—¢èƒ½è·å¾—è¾ƒé«˜çš„å¸¦å®½ï¼Œåˆä¸å½±å“ä¼šè¯å±‚ã€‚åœ¨å»ºç«‹è¿æ¥æ—¶ä¼ è¾“å±‚å¯ä»¥è¯·æ±‚æœåŠ¡è´¨é‡ï¼Œè¯¥æœåŠ¡è´¨é‡æŒ‡å®šå¯æ¥å—çš„è¯¯ç ç‡ã€å»¶è¿Ÿé‡ã€å®‰å…¨æ€§ç­‰å‚æ•°ï¼Œè¿˜å¯ä»¥å®ç°åŸºäºç«¯åˆ°ç«¯çš„æµé‡æ§åˆ¶åŠŸèƒ½ã€‚</p><p>ç¬¬5å±‚ä¼šè¯å±‚ï¼šåœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´å»ºç«‹ç«¯è¿æ¥ã€‚ä¸ºç«¯ç³»ç»Ÿçš„åº”ç”¨ç¨‹åºä¹‹é—´æä¾›äº†å¯¹è¯æ§åˆ¶æœºåˆ¶ã€‚æ­¤æœåŠ¡åŒ…æ‹¬å»ºç«‹è¿æ¥æ˜¯ä»¥å…¨åŒå·¥è¿˜æ˜¯ä»¥åŠåŒå·¥çš„æ–¹å¼è¿›è¡Œè®¾ç½®ï¼Œå°½ç®¡å¯ä»¥åœ¨å±‚4ä¸­å¤„ç†åŒå·¥æ–¹å¼ ï¼›ä¼šè¯å±‚ç®¡ç†ç™»å…¥å’Œæ³¨é”€è¿‡ç¨‹ã€‚å®ƒå…·ä½“ç®¡ç†ä¸¤ä¸ªç”¨æˆ·å’Œè¿›ç¨‹ä¹‹é—´çš„å¯¹è¯ã€‚å¦‚æœåœ¨æŸä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªç”¨æˆ·æ‰§è¡Œä¸€é¡¹ç‰¹å®šçš„æ“ä½œï¼Œä¼šè¯å±‚åè®®å°±ä¼šç®¡ç†è¿™äº›æ“ä½œï¼Œå¦‚é˜»æ­¢ä¸¤ä¸ªç”¨æˆ·åŒæ—¶æ›´æ–°æ•°æ®åº“ä¸­çš„åŒä¸€ç»„æ•°æ®ã€‚</p><p>ç¬¬6å±‚è¡¨ç¤ºå±‚ï¼šä¸»è¦ç”¨äºå¤„ç†ä¸¤ä¸ªé€šä¿¡ç³»ç»Ÿä¸­äº¤æ¢ä¿¡æ¯çš„è¡¨ç¤ºæ–¹å¼ã€‚ä¸ºä¸Šå±‚ç”¨æˆ·è§£å†³ç”¨æˆ·ä¿¡æ¯çš„è¯­æ³•é—®é¢˜ã€‚å®ƒåŒ…æ‹¬æ•°æ®æ ¼å¼äº¤æ¢ã€æ•°æ®åŠ å¯†ä¸è§£å¯†ã€æ•°æ®å‹ç¼©ä¸ç»ˆç«¯ç±»å‹çš„è½¬æ¢ã€‚</p><p>ç¬¬7å±‚åº”ç”¨å±‚ï¼šOSIä¸­çš„æœ€é«˜å±‚ã€‚ä¸ºç‰¹å®šç±»å‹çš„ç½‘ç»œåº”ç”¨æä¾›äº†è®¿é—®OSIç¯å¢ƒçš„æ‰‹æ®µã€‚åº”ç”¨å±‚ç¡®å®šè¿›ç¨‹ä¹‹é—´é€šä¿¡çš„æ€§è´¨ï¼Œä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€è¦ã€‚åº”ç”¨å±‚ä¸ä»…è¦æä¾›åº”ç”¨è¿›ç¨‹æ‰€éœ€è¦çš„ä¿¡æ¯äº¤æ¢å’Œè¿œç¨‹æ“ä½œï¼Œè€Œä¸”è¿˜è¦ä½œä¸ºåº”ç”¨è¿›ç¨‹çš„ç”¨æˆ·ä»£ç†ï¼Œæ¥å®Œæˆä¸€äº›ä¸ºè¿›è¡Œä¿¡æ¯äº¤æ¢æ‰€å¿…éœ€çš„åŠŸèƒ½ã€‚å®ƒåŒ…æ‹¬ï¼šæ–‡ä»¶ä¼ é€è®¿é—®å’Œç®¡ç†FTAMã€è™šæ‹Ÿç»ˆç«¯VTã€äº‹åŠ¡å¤„ç†TPã€è¿œç¨‹æ•°æ®åº“è®¿é—®RDAã€åˆ¶é€ æŠ¥æ–‡è§„èŒƒMMSã€ç›®å½•æœåŠ¡DSç­‰åè®®ï¼›åº”ç”¨å±‚èƒ½ä¸åº”ç”¨ç¨‹åºç•Œé¢æ²Ÿé€šï¼Œä»¥è¾¾åˆ°å±•ç¤ºç»™ç”¨æˆ·çš„ç›®çš„ã€‚ åœ¨æ­¤å¸¸è§çš„åè®®æœ‰:HTTPï¼ŒHTTPSï¼ŒFTPï¼ŒTELNETï¼ŒSSHï¼ŒSMTPï¼ŒPOP3ç­‰ã€‚</p><h3 id="OSIå‚è€ƒæ¨¡å‹å„å±‚åŠŸèƒ½"><a href="#OSIå‚è€ƒæ¨¡å‹å„å±‚åŠŸèƒ½" class="headerlink" title="OSIå‚è€ƒæ¨¡å‹å„å±‚åŠŸèƒ½"></a>OSIå‚è€ƒæ¨¡å‹å„å±‚åŠŸèƒ½</h3><p>(1)ç‰©ç†å±‚(Physical Layer)<br>ç‰©ç†å±‚æ˜¯OSIå‚è€ƒæ¨¡å‹çš„æœ€ä½å±‚ï¼Œå®ƒåˆ©ç”¨ä¼ è¾“ä»‹è´¨ä¸ºæ•°æ®é“¾è·¯å±‚æä¾›ç‰©ç†è¿æ¥ã€‚<br>å®ƒä¸»è¦å…³å¿ƒçš„æ˜¯é€šè¿‡ç‰©ç†é“¾è·¯ä»ä¸€ä¸ªèŠ‚ç‚¹å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ä¼ é€æ¯”ç‰¹æµï¼Œç‰©ç†é“¾è·¯å¯èƒ½æ˜¯é“œçº¿ã€å«æ˜Ÿã€å¾®æ³¢æˆ–å…¶ä»–çš„é€šè®¯åª’ä»‹ã€‚<br>å®ƒå…³å¿ƒçš„é—®é¢˜æœ‰ï¼šå¤šå°‘ä¼ç”µå‹ä»£è¡¨1ï¼Ÿå¤šå°‘ä¼ç”µå‹ä»£è¡¨0ï¼Ÿæ—¶é’Ÿé€Ÿç‡æ˜¯å¤šå°‘ï¼Ÿé‡‡ç”¨å…¨åŒå·¥è¿˜æ˜¯åŠåŒå·¥ä¼ è¾“ï¼Ÿæ€»çš„æ¥è¯´ç‰©ç†å±‚å…³å¿ƒçš„æ˜¯é“¾è·¯çš„æœºæ¢°ã€ç”µæ°”ã€åŠŸèƒ½å’Œè§„ç¨‹ç‰¹æ€§ã€‚</p><p>(2)æ•°æ®é“¾è·¯å±‚(Data Link Layer)<br>æ•°æ®é“¾è·¯å±‚æ˜¯ä¸ºç½‘ç»œå±‚æä¾›æœåŠ¡çš„ï¼Œè§£å†³ä¸¤ä¸ªç›¸é‚»ç»“ç‚¹ä¹‹é—´çš„é€šä¿¡é—®é¢˜ï¼Œä¼ é€çš„åè®®æ•°æ®å•å…ƒç§°ä¸ºæ•°æ®å¸§ã€‚<br>æ•°æ®å¸§ä¸­åŒ…å«ç‰©ç†åœ°å€ï¼ˆåˆç§°MACåœ°å€ï¼‰ã€æ§åˆ¶ç ã€æ•°æ®åŠæ ¡éªŒç ç­‰ä¿¡æ¯ã€‚è¯¥å±‚çš„ä¸»è¦ä½œç”¨æ˜¯é€šè¿‡æ ¡éªŒã€ç¡®è®¤å’Œåé¦ˆé‡å‘ç­‰æ‰‹æ®µï¼Œå°†ä¸å¯é çš„ç‰©ç†é“¾è·¯è½¬æ¢æˆå¯¹ç½‘ç»œå±‚æ¥è¯´æ— å·®é”™çš„æ•°æ®é“¾è·¯ã€‚<br>æ­¤å¤–ï¼Œæ•°æ®é“¾è·¯å±‚è¿˜è¦åè°ƒæ”¶å‘åŒæ–¹çš„æ•°æ®ä¼ è¾“é€Ÿç‡ï¼Œå³è¿›è¡Œæµé‡æ§åˆ¶ï¼Œä»¥é˜²æ­¢æ¥æ”¶æ–¹å› æ¥ä¸åŠå¤„ç†å‘é€æ–¹æ¥çš„é«˜é€Ÿæ•°æ®è€Œå¯¼è‡´ç¼“å†²å™¨æº¢å‡ºåŠçº¿è·¯é˜»å¡ã€‚</p><p>(3)ç½‘ç»œå±‚(Network Layer)<br>ç½‘ç»œå±‚æ˜¯ä¸ºä¼ è¾“å±‚æä¾›æœåŠ¡çš„ï¼Œä¼ é€çš„åè®®æ•°æ®å•å…ƒç§°ä¸ºæ•°æ®åŒ…æˆ–åˆ†ç»„ã€‚<br>è¯¥å±‚çš„ä¸»è¦ä½œç”¨æ˜¯è§£å†³å¦‚ä½•ä½¿æ•°æ®åŒ…é€šè¿‡å„ç»“ç‚¹ä¼ é€çš„é—®é¢˜ï¼Œå³é€šè¿‡è·¯å¾„é€‰æ‹©ç®—æ³•ï¼ˆè·¯ç”±ï¼‰å°†æ•°æ®åŒ…é€åˆ°ç›®çš„åœ°ã€‚<br>å¦å¤–ï¼Œä¸ºé¿å…é€šä¿¡å­ç½‘ä¸­å‡ºç°è¿‡å¤šçš„æ•°æ®åŒ…è€Œé€ æˆç½‘ç»œé˜»å¡ï¼Œéœ€è¦å¯¹æµå…¥çš„æ•°æ®åŒ…æ•°é‡è¿›è¡Œæ§åˆ¶ï¼ˆæ‹¥å¡æ§åˆ¶ï¼‰ã€‚<br>å½“æ•°æ®åŒ…è¦è·¨è¶Šå¤šä¸ªé€šä¿¡å­ç½‘æ‰èƒ½åˆ°è¾¾ç›®çš„åœ°æ—¶ï¼Œè¿˜è¦è§£å†³ç½‘é™…äº’è¿çš„é—®é¢˜ã€‚</p><p>(4)ä¼ è¾“å±‚(Transport Layer)<br>ä¼ è¾“å±‚çš„ä½œç”¨æ˜¯ä¸ºä¸Šå±‚åè®®æä¾›ç«¯åˆ°ç«¯çš„å¯é å’Œé€æ˜çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ŒåŒ…æ‹¬å¤„ç†å·®é”™æ§åˆ¶å’Œæµé‡æ§åˆ¶ç­‰é—®é¢˜ã€‚<br>è¯¥å±‚å‘é«˜å±‚å±è”½äº†ä¸‹å±‚æ•°æ®é€šä¿¡çš„ç»†èŠ‚ï¼Œä½¿é«˜å±‚ç”¨æˆ·çœ‹åˆ°çš„åªæ˜¯åœ¨ä¸¤ä¸ªä¼ è¾“å®ä½“é—´çš„ä¸€æ¡ä¸»æœºåˆ°ä¸»æœºçš„ã€å¯ç”±ç”¨æˆ·æ§åˆ¶å’Œè®¾å®šçš„ã€å¯é çš„æ•°æ®é€šè·¯ã€‚<br>ä¼ è¾“å±‚ä¼ é€çš„åè®®æ•°æ®å•å…ƒç§°ä¸ºæ®µæˆ–æŠ¥æ–‡ã€‚</p><p>(5)ä¼šè¯å±‚(Session Layer)<br>ä¼šè¯å±‚ä¸»è¦åŠŸèƒ½æ˜¯ç®¡ç†å’Œåè°ƒä¸åŒä¸»æœºä¸Šå„ç§è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼ˆå¯¹è¯ï¼‰ï¼Œå³è´Ÿè´£å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¼šè¯ã€‚ä¼šè¯å±‚å¾—åçš„åŸå› æ˜¯å®ƒå¾ˆç±»ä¼¼äºä¸¤ä¸ªå®ä½“é—´çš„ä¼šè¯æ¦‚å¿µã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªäº¤äº’çš„ç”¨æˆ·ä¼šè¯ä»¥ç™»å½•åˆ°è®¡ç®—æœºå¼€å§‹ï¼Œä»¥æ³¨é”€ç»“æŸã€‚</p><p>(6)è¡¨ç¤ºå±‚(Presentation Layer)<br>è¡¨ç¤ºå±‚å¤„ç†æµç»ç»“ç‚¹çš„æ•°æ®ç¼–ç çš„è¡¨ç¤ºæ–¹å¼é—®é¢˜ï¼Œä»¥ä¿è¯ä¸€ä¸ªç³»ç»Ÿåº”ç”¨å±‚å‘å‡ºçš„ä¿¡æ¯å¯è¢«å¦ä¸€ç³»ç»Ÿçš„åº”ç”¨å±‚è¯»å‡ºã€‚<br>å¦‚æœå¿…è¦ï¼Œè¯¥å±‚å¯æä¾›ä¸€ç§æ ‡å‡†è¡¨ç¤ºå½¢å¼ï¼Œç”¨äºå°†è®¡ç®—æœºå†…éƒ¨çš„å¤šç§æ•°æ®è¡¨ç¤ºæ ¼å¼è½¬æ¢æˆç½‘ç»œé€šä¿¡ä¸­é‡‡ç”¨çš„æ ‡å‡†è¡¨ç¤ºå½¢å¼ã€‚<br>æ•°æ®å‹ç¼©å’ŒåŠ å¯†ä¹Ÿæ˜¯è¡¨ç¤ºå±‚å¯æä¾›çš„è½¬æ¢åŠŸèƒ½ä¹‹ä¸€ã€‚</p><p>(7)åº”ç”¨å±‚(Application Layer)<br>åº”ç”¨å±‚æ˜¯OSIå‚è€ƒæ¨¡å‹çš„æœ€é«˜å±‚ï¼Œæ˜¯ç”¨æˆ·ä¸ç½‘ç»œçš„æ¥å£ã€‚<br>è¯¥å±‚é€šè¿‡åº”ç”¨ç¨‹åºæ¥å®Œæˆç½‘ç»œç”¨æˆ·çš„åº”ç”¨éœ€æ±‚ï¼Œå¦‚æ–‡ä»¶ä¼ è¾“ã€æ”¶å‘ç”µå­é‚®ä»¶ç­‰ã€‚</p><h3 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h3><p>TCPå®Œæˆäº†OSIå‚è€ƒæ¨¡å‹ä¸­çš„<strong>ç¬¬å››å±‚ä¼ è¾“å±‚</strong>çš„åŠŸèƒ½ï¼Œnetæ¨¡å—ç®€å•æ¥è¯´å°±æ˜¯TCPåè®®çš„nodeå®ç°ã€‚</p><p>TCPï¼ˆTransmission Control Protocol ä¼ è¾“æ§åˆ¶åè®®ï¼‰æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ï¼Œç”±IETFçš„RFC 793å®šä¹‰ã€‚</p><p>å½“åº”ç”¨å±‚å‘TCPå±‚å‘é€ç”¨äºç½‘é—´ä¼ è¾“çš„ã€ç”¨8ä½å­—èŠ‚è¡¨ç¤ºçš„æ•°æ®æµï¼ŒTCPåˆ™æŠŠæ•°æ®æµåˆ†å‰²æˆé€‚å½“é•¿åº¦çš„æŠ¥æ–‡æ®µï¼Œæœ€å¤§ä¼ è¾“æ®µå¤§å°ï¼ˆMSSï¼‰é€šå¸¸å—è¯¥è®¡ç®—æœºè¿æ¥çš„ç½‘ç»œçš„æ•°æ®é“¾è·¯å±‚çš„æœ€å¤§ä¼ é€å•å…ƒï¼ˆMTUï¼‰é™åˆ¶ã€‚ä¹‹åTCPæŠŠæ•°æ®åŒ…ä¼ ç»™IPå±‚ï¼Œç”±å®ƒæ¥é€šè¿‡ç½‘ç»œå°†åŒ…ä¼ é€ç»™æ¥æ”¶ç«¯å®ä½“çš„TCPå±‚ã€‚<br>TCPä¸ºäº†ä¿è¯æŠ¥æ–‡ä¼ è¾“çš„å¯é  [1]  ï¼Œå°±ç»™æ¯ä¸ªåŒ…ä¸€ä¸ªåºå·ï¼ŒåŒæ—¶åºå·ä¹Ÿä¿è¯äº†ä¼ é€åˆ°æ¥æ”¶ç«¯å®ä½“çš„åŒ…çš„æŒ‰åºæ¥æ”¶ã€‚ç„¶åæ¥æ”¶ç«¯å®ä½“å¯¹å·²æˆåŠŸæ”¶åˆ°çš„å­—èŠ‚å‘å›ä¸€ä¸ªç›¸åº”çš„ç¡®è®¤(ACK)ï¼›å¦‚æœå‘é€ç«¯å®ä½“åœ¨åˆç†çš„å¾€è¿”æ—¶å»¶(RTT)å†…æœªæ”¶åˆ°ç¡®è®¤ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ•°æ®ï¼ˆå‡è®¾ä¸¢å¤±äº†ï¼‰å°†ä¼šè¢«é‡ä¼ ã€‚<br><em>TCPçš„å¯é æ€§è™½ç„¶å¾ˆå¥½ï¼Œä½†å®ƒä¹Ÿå› æ­¤ç‰ºç‰²äº†æ•ˆç‡ï¼Œå®ƒæ¯”è¾ƒé€‚åˆäºä¼ è¾“æ–‡ä»¶ç­‰åœºæ™¯ã€‚å¦‚æœåœ¨å¯¹å¯é æ€§è¦æ±‚ä¸é«˜ï¼Œä½†å¯¹æ•ˆç‡è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ï¼Œå¦‚è§†é¢‘ç›´æ’­ç­‰ï¼Œå°±å¯ä»¥ä½¿ç”¨UDP</em>ã€‚</p><h3 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h3><p>UDP æ˜¯User Datagram Protocolçš„ç®€ç§°ï¼Œ ä¸­æ–‡åæ˜¯ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œæ˜¯OSIï¼ˆOpen System Interconnectionï¼Œå¼€æ”¾å¼ç³»ç»Ÿäº’è”ï¼‰ å‚è€ƒæ¨¡å‹ä¸­ä¸€ç§æ— è¿æ¥çš„ä¼ è¾“å±‚åè®®ï¼Œæä¾›é¢å‘äº‹åŠ¡çš„ç®€å•ä¸å¯é ä¿¡æ¯ä¼ é€æœåŠ¡ï¼ŒIETF RFC 768æ˜¯UDPçš„æ­£å¼è§„èŒƒã€‚UDPåœ¨IPæŠ¥æ–‡çš„åè®®å·æ˜¯17ã€‚</p><p>UDPæŠ¥æ–‡æ²¡æœ‰å¯é æ€§ä¿è¯ã€é¡ºåºä¿è¯å’Œæµé‡æ§åˆ¶å­—æ®µç­‰ï¼Œå¯é æ€§è¾ƒå·®ã€‚ä½†æ˜¯æ­£å› ä¸ºUDPåè®®çš„æ§åˆ¶é€‰é¡¹è¾ƒå°‘ï¼Œåœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­å»¶è¿Ÿå°ã€æ•°æ®ä¼ è¾“æ•ˆç‡é«˜ï¼Œé€‚åˆå¯¹å¯é æ€§è¦æ±‚ä¸é«˜çš„åº”ç”¨ç¨‹åºï¼Œå¦‚éŸ³é¢‘ã€è§†é¢‘å’Œæ™®é€šæ•°æ®åœ¨ä¼ é€æ—¶ä½¿ç”¨UDPè¾ƒå¤šï¼Œæˆ–è€…å¯ä»¥ä¿éšœå¯é æ€§çš„åº”ç”¨ç¨‹åºï¼Œå¦‚DNSã€TFTPã€SNMPç­‰ã€‚</p><p>Nodejsä¹Ÿæä¾›äº†UDP/Datagramæ¨¡å—ï¼Œå¯ä»¥åœ¨éœ€è¦ä½¿ç”¨UDPæ—¶è°ƒç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vueä¸­axiosè¯·æ±‚çš„å°è£…</title>
      <link href="/2019/03/29/Vue/vue%E4%B8%ADaxios%E8%AF%B7%E6%B1%82%E7%9A%84%E5%B0%81%E8%A3%85/"/>
      <url>/2019/03/29/Vue/vue%E4%B8%ADaxios%E8%AF%B7%E6%B1%82%E7%9A%84%E5%B0%81%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Axios æ˜¯ä¸€ä¸ªåŸºäº promise çš„ HTTP åº“ï¼Œå¯ä»¥ç”¨åœ¨æµè§ˆå™¨å’Œ node.js ä¸­, ä¹Ÿæ˜¯vueå®˜æ–¹æ¨èä½¿ç”¨çš„httpåº“ï¼›å°è£…axiosï¼Œä¸€æ–¹é¢ä¸ºäº†ä»¥åç»´æŠ¤æ–¹ä¾¿ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œè‡ªå®šä¹‰å¤„ç†ï¼Œä¸å¤šBB,å¼€æ</p><h2 id="è®¾ç½®æ¥å£è¯·æ±‚å‰ç¼€"><a href="#è®¾ç½®æ¥å£è¯·æ±‚å‰ç¼€" class="headerlink" title="è®¾ç½®æ¥å£è¯·æ±‚å‰ç¼€"></a>è®¾ç½®æ¥å£è¯·æ±‚å‰ç¼€</h2><p>ä¸€èˆ¬æˆ‘ä»¬å¼€å‘éƒ½ä¼šæœ‰å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒï¼Œå‰ç¼€éœ€è¦åŠ ä»¥åŒºåˆ†ï¼Œæˆ‘ä»¬åˆ©ç”¨nodeç¯å¢ƒå˜é‡æ¥ä½œåˆ¤æ–­</p><pre><code class="js">if(process.env.NODE_ENV === &quot;development&quot;){    axios.default.baseURL = &quot;XXXX&quot;}else if(process.env.NODE_ENV === &quot;production&quot;){    axios.default.baseURL = &quot;XXXX&quot;}</code></pre><p>åœ¨localhostè°ƒè¯•æ—¶ï¼Œç›´æ¥ç”¨å¼€å‘åœ°å€ä¸€èˆ¬éƒ½ä¼šæœ‰è·¨åŸŸçš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦<code>vue.config.js</code>é…ç½®ä»£ç†</p><pre><code class="js">module.exports = {  devServer: {    proxy: {      &#39;/proxyApi&#39;: {        target: &#39;http://dev.xxx.com&#39;,        changeOrigin: true,        pathRewrite: {          &#39;/proxyApi&#39;: &#39;&#39;        }      }    }  }}</code></pre><p>è¿™æ ·å°±æˆåŠŸæŠŠ/proxyApi æŒ‡å‘äº† <code>XXXX</code>ï¼Œé‡å¯æœåŠ¡</p><h2 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h2><p>æ¥ç€è®¾ç½®è¶…æ—¶æ—¶é—´å’Œè¯·æ±‚å¤´ä¿¡æ¯</p><pre><code class="js">axios.defaults.timeout = 10000// è¯·æ±‚å¤´ä¿¡æ¯æ˜¯ä¸ºpostè¯·æ±‚è®¾ç½®axios.defaults.headers.post[&#39;Content-Type&#39;] = &#39;application/x-www-form-urlencoded;charset=UTF-8&#39;</code></pre><p>axioså¾ˆå¥½ç”¨ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯å®ƒçš„æ‹¦æˆªå™¨ååˆ†å¼ºå¤§ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸ºè¯·æ±‚å’Œå“åº”è®¾ç½®æ‹¦æˆªå™¨ï¼Œæ¯”å¦‚è¯·æ±‚æ‹¦æˆªå™¨å¯ä»¥åœ¨æ¯ä¸ªè¯·æ±‚é‡ŒåŠ ä¸Štokenï¼Œåšäº†ç»Ÿä¸€å¤„ç†åç»´æŠ¤èµ·æ¥ä¹Ÿæ–¹ä¾¿ï¼Œå“åº”æ‹¦æˆªå™¨å¯ä»¥åœ¨æ¥æ”¶åˆ°å“åº”åå…ˆåšä¸€å±‚æ“ä½œï¼Œå¦‚æ ¹æ®çŠ¶æ€ç åˆ¤æ–­ç™»å½•çŠ¶æ€ã€æˆæƒã€‚<br><a id="more"></a></p><pre><code class="js">// è¯·æ±‚æ‹¦æˆªå™¨axios.interceptors.request.use(  config =&gt; {    // æ¯æ¬¡å‘é€è¯·æ±‚ä¹‹å‰åˆ¤æ–­æ˜¯å¦å­˜åœ¨token    // å¦‚æœå­˜åœ¨ï¼Œåˆ™ç»Ÿä¸€åœ¨httpè¯·æ±‚çš„headeréƒ½åŠ ä¸Štokenï¼Œè¿™æ ·åå°æ ¹æ®tokenåˆ¤æ–­ä½ çš„ç™»å½•æƒ…å†µï¼Œæ­¤å¤„tokenä¸€èˆ¬æ˜¯ç”¨æˆ·å®Œæˆç™»å½•åå‚¨å­˜åˆ°localstorageé‡Œçš„    token &amp;&amp; (config.headers.Authorization = token)    return config  },  error =&gt; {    return Promise.error(error)  })// å“åº”æ‹¦æˆªå™¨axios.interceptors.response.use(response =&gt; {  // å¦‚æœè¿”å›çš„çŠ¶æ€ç ä¸º200ï¼Œè¯´æ˜æ¥å£è¯·æ±‚æˆåŠŸï¼Œå¯ä»¥æ­£å¸¸æ‹¿åˆ°æ•°æ®  // å¦åˆ™çš„è¯æŠ›å‡ºé”™è¯¯  if (response.status === 200) {    if (response.data.code === 511) {      // æœªæˆæƒè°ƒå–æˆæƒæ¥å£    } else if (response.data.code === 510) {      // æœªç™»å½•è·³è½¬ç™»å½•é¡µ    } else {      return Promise.resolve(response)    }  } else {    return Promise.reject(response)  }}, error =&gt; {  // æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå¯¹å¼‚å¸¸çŠ¶æ€ä½œç»Ÿä¸€å¤„ç†  if (error.response.status) {    // å¤„ç†è¯·æ±‚å¤±è´¥çš„æƒ…å†µ    // å¯¹ä¸åŒè¿”å›ç å¯¹ç›¸åº”å¤„ç†    return Promise.reject(error.response)  }})</code></pre><h2 id="get-postçš„å°è£…"><a href="#get-postçš„å°è£…" class="headerlink" title="get postçš„å°è£…"></a>get postçš„å°è£…</h2><p>httpGet: ä¸€ä¸ªå‚æ•°æ˜¯è¯·æ±‚çš„url,ä¸€ä¸ªå°±æºå¸¦çš„è¯·æ±‚å‚æ•°ï¼Œè¿”å›promiseå¯¹è±¡</p><pre><code class="js">// get è¯·æ±‚export function httpGet({  url,  params = {}}) {  return new Promise((resolve, reject) =&gt; {    axios.get(url, {      params    }).then((res) =&gt; {      resolve(res.data)    }).catch(err =&gt; {      reject(err)    })  })}</code></pre><p>httpPost: åŸç†å’Œgetå·®ä¸å¤šï¼Œéœ€è¦æ³¨æ„ï¼Œè¿™é‡Œå¤šäº†ä¸ªdataå‚æ•°ï¼Œpostè¯·æ±‚æäº¤å‰éœ€è¦å¯¹å®ƒè¿›è¡Œåºåˆ—å·æ“ä½œï¼Œè¿™é‡Œæ˜¯é€šè¿‡<code>transformRequest</code>åšå¤„ç†ï¼›å¦å¤–ä¸¤ä¸ªå‚æ•°url,paramså’Œgetè¯·æ±‚çš„ä¸€æ ·ï¼›</p><pre><code class="js">// postè¯·æ±‚export function httpPost({  url,  data = {},  params = {}}) {  return new Promise((resolve, reject) =&gt; {    axios({      url,      method: &#39;post&#39;,      transformRequest: [function (data) {        let ret = &#39;&#39;        for (let it in data) {          ret += encodeURIComponent(it) + &#39;=&#39; + encodeURIComponent(data[it]) + &#39;&amp;&#39;        }        return ret      }],      // å‘é€çš„æ•°æ®      data,      // urlå‚æ•°      params    }).then(res =&gt; {      resolve(res.data)    })  })}</code></pre><h3 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨"></a>å¦‚ä½•ä½¿ç”¨</h3><p>æˆ‘æŠŠæ‰€æœ‰çš„æ¥å£è°ƒç”¨éƒ½åœ¨api.jsæ–‡ä»¶ä¸­</p><p>å…ˆå¼•å…¥å°è£…å¥½çš„æ–¹æ³•ï¼Œå†åœ¨è¦è°ƒç”¨çš„æ¥å£é‡æ–°å°è£…æˆä¸€ä¸ªæ–¹æ³•æš´éœ²å‡ºå»</p><pre><code class="js">import { httpGet, httpPost } from &#39;./http&#39;export const getorglist = (params = {}) =&gt; httpGet({ url: &#39;apps/api/org/list&#39;, params })</code></pre><p>åœ¨é¡µé¢ä¸­å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š</p><pre><code class="js">// .vueimport { getorglist } from &#39;@/assets/js/api&#39;getorglist({ id: 200 }).then(res =&gt; {  console.log(res)})</code></pre><p>è¿™æ ·å¯ä»¥æŠŠapiç»Ÿä¸€ç®¡ç†èµ·æ¥ï¼Œä»¥åç»´æŠ¤ä¿®æ”¹åªéœ€è¦åœ¨api.jsæ–‡ä»¶æ“ä½œå³å¯</p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><h3 id="http-js"><a href="#http-js" class="headerlink" title="http.js"></a>http.js</h3><pre><code class="js">// http.jsimport axios from &#39;axios&#39;// ç¯å¢ƒçš„åˆ‡æ¢if (process.env.NODE_ENV === &#39;development&#39;) {  axios.defaults.baseURL = &#39;/proxyApi&#39;} else if (process.env.NODE_ENV === &#39;production&#39;) {  axios.defaults.baseURL = &#39;http://prod.xxx.com&#39;}// è¯·æ±‚æ‹¦æˆªå™¨axios.interceptors.request.use(  config =&gt; {    token &amp;&amp; (config.headers.Authorization = token)    return config  },  error =&gt; {    return Promise.error(error)  })axios.defaults.timeout = 10000axios.defaults.headers.post[&#39;Content-Type&#39;] = &#39;application/x-www-form-urlencoded;charset=UTF-8&#39;// å“åº”æ‹¦æˆªå™¨axios.interceptors.response.use(response =&gt; {  if (response.status === 200) {    if (response.data.code === 511) {      // æœªæˆæƒè°ƒå–æˆæƒæ¥å£    } else if (response.data.code === 510) {      // æœªç™»å½•è·³è½¬ç™»å½•é¡µ    } else {      return Promise.resolve(response)    }  } else {    return Promise.reject(response)  }}, error =&gt; {  // æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå¯¹å¼‚å¸¸çŠ¶æ€ä½œç»Ÿä¸€å¤„ç†  if (error.response.status) {    // å¤„ç†è¯·æ±‚å¤±è´¥çš„æƒ…å†µ    // å¯¹ä¸åŒè¿”å›ç å¯¹ç›¸åº”å¤„ç†    return Promise.reject(error.response)  }})// get è¯·æ±‚export function httpGet({  url,  params = {}}) {  return new Promise((resolve, reject) =&gt; {    axios.get(url, {      params    }).then((res) =&gt; {      resolve(res.data)    }).catch(err =&gt; {      reject(err)    })  })}// postè¯·æ±‚export function httpPost({  url,  data = {},  params = {}}) {  return new Promise((resolve, reject) =&gt; {    axios({      url,      method: &#39;post&#39;,      transformRequest: [function (data) {        let ret = &#39;&#39;        for (let it in data) {          ret += encodeURIComponent(it) + &#39;=&#39; + encodeURIComponent(data[it]) + &#39;&amp;&#39;        }        return ret      }],      // å‘é€çš„æ•°æ®      data,      // urlå‚æ•°      params    }).then(res =&gt; {      resolve(res.data)    })  })}</code></pre><h3 id="api-js"><a href="#api-js" class="headerlink" title="api.js"></a>api.js</h3><pre><code class="js">// api.jsimport { httpGet, httpPost } from &#39;./http&#39;export const getorglist = (params = {}) =&gt; httpGet({ url: &#39;apps/api/org/list&#39;, params })export const save = (data) =&gt; {  return httpPost({    url: &#39;apps/wechat/api/save_member&#39;,    data  })}</code></pre><h3 id="vue"><a href="#vue" class="headerlink" title="vue"></a>vue</h3><pre><code class="js">// .vue&lt;script&gt;import { getorglist } from &#39;@/assets/js/api&#39;export default {  name: &#39;upload-card&#39;,  data() {},  mounted() {    getorglist({ id: 200 }).then(res =&gt; {      // console.log(res)    })  },}&lt;/script&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•åœ¨ Web å…³é—­é¡µé¢æ—¶å‘é€ Ajax è¯·æ±‚</title>
      <link href="/2019/03/28/Ajax/%E5%A6%82%E4%BD%95%E5%9C%A8-Web-%E5%85%B3%E9%97%AD%E9%A1%B5%E9%9D%A2%E6%97%B6%E5%8F%91%E9%80%81-Ajax-%E8%AF%B7%E6%B1%82/"/>
      <url>/2019/03/28/Ajax/%E5%A6%82%E4%BD%95%E5%9C%A8-Web-%E5%85%B3%E9%97%AD%E9%A1%B5%E9%9D%A2%E6%97%B6%E5%8F%91%E9%80%81-Ajax-%E8%AF%B7%E6%B1%82/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨ç”¨æˆ·ç¦»å¼€é¡µé¢çš„æ—¶å€™ï¼Œåšä¸€äº›ä¸ŠæŠ¥æ¥è®°å½•ç”¨æˆ·è¡Œä¸ºã€‚åˆæˆ–è€…æ˜¯å‘é€æœåŠ¡å™¨ajaxè¯·æ±‚ï¼Œé€šçŸ¥æœåŠ¡å™¨ç”¨æˆ·å·²ç»ç¦»å¼€ï¼Œæ¯”å¦‚ç›´æ’­é—´å†…çš„é€€æˆ¿æ“ä½œã€‚</p><p>æœ¬æ–‡ä¸»è¦åˆ†ä¸¤éƒ¨åˆ†æ¥è®²è§£æ€ä¹ˆå®Œæˆé€€å‡ºè¡Œä¸ºçš„ä¸ŠæŠ¥ã€‚</p><h2 id="äº‹ä»¶ç›‘å¬"><a href="#äº‹ä»¶ç›‘å¬" class="headerlink" title="äº‹ä»¶ç›‘å¬"></a>äº‹ä»¶ç›‘å¬</h2><p>æµè§ˆå™¨æœ‰ä¸¤ä¸ªäº‹ä»¶å¯ä»¥ç”¨æ¥ç›‘å¬é¡µé¢å…³é—­ï¼Œ<code>beforeunload</code>å’Œ<code>unload</code>ã€‚<br><code>beforeunload</code>æ˜¯åœ¨æ–‡æ¡£å’Œèµ„æºå°†è¦å…³é—­çš„æ—¶å€™è°ƒç”¨çš„ï¼Œ è¿™æ—¶å€™æ–‡æ¡£è¿˜æ˜¯å¯è§çš„ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªå…³é—­çš„äº‹ä»¶è¿˜æ˜¯å¯ä»¥å–æ¶ˆçš„ã€‚æ¯”å¦‚ä¸‹é¢è¿™ç§å†™æ³•å°±ä¼šè®©ç”¨æˆ·å¯¼è‡´åœ¨åˆ·æ–°æˆ–è€…å…³é—­é¡µé¢æ—¶å€™ï¼Œæœ‰ä¸ªå¼¹çª—æé†’ç”¨æˆ·æ˜¯å¦å…³é—­ã€‚</p><pre><code class="js">window.addEventListener(&quot;beforeunload&quot;, function (event) {  // Cancel the event as stated by the standard.  event.preventDefault();  // Chrome requires returnValue to be set.  event.returnValue = &#39;&#39;;});</code></pre><blockquote><p>unloadåˆ™æ˜¯åœ¨é¡µé¢å·²ç»æ­£åœ¨è¢«å¸è½½æ—¶å‘ç”Ÿï¼Œæ­¤æ—¶æ–‡æ¡£æ‰€å¤„çš„çŠ¶æ€æ˜¯ï¼š<br>1.æ‰€æœ‰èµ„æºä»å­˜åœ¨ï¼ˆå›¾ç‰‡ï¼Œiframeç­‰ï¼‰ï¼›<br>2.å¯¹äºç”¨æˆ·æ‰€æœ‰èµ„æºä¸å¯è§ï¼›<br>3.ç•Œé¢äº¤äº’æ— æ•ˆï¼ˆwindow.open, alert, confirm ç­‰ï¼‰ï¼›<br>4.é”™è¯¯ä¸ä¼šåœæ­¢å¸è½½æ–‡æ¡£çš„è¿‡ç¨‹ã€‚</p></blockquote><p>åŸºäºä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•å°±å¯ä»¥å®ç°å¯¹é¡µé¢å…³é—­çš„äº‹ä»¶ç›‘å¬äº†ï¼Œä¸ºäº†ç¨³å¦¥ï¼Œå¯ä»¥ä¸¤ä¸ªäº‹ä»¶éƒ½ç›‘å¬ã€‚ç„¶åå¯¹ç›‘å¬å‡½æ•°åšå¤„ç†ï¼Œè®©å…³é—­äº‹ä»¶åªè°ƒç”¨ä¸€æ¬¡ã€‚</p><h2 id="è¯·æ±‚å‘é€"><a href="#è¯·æ±‚å‘é€" class="headerlink" title="è¯·æ±‚å‘é€"></a>è¯·æ±‚å‘é€</h2><p>æœ‰äº†ä¸Šé¢çš„ç›‘å¬ï¼Œäº‹æƒ…åªå®Œæˆäº†ä¸€åŠï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç›‘å¬ä¸­ç›´æ¥å‘é€ajaxè¯·æ±‚ï¼Œå°±ä¼šå‘ç°è¯·æ±‚è¢«æµè§ˆå™¨abortäº†ï¼Œæ— æ³•å‘é€å‡ºå»ã€‚åœ¨é¡µé¢å¸è½½çš„æ—¶å€™ï¼Œæµè§ˆå™¨å¹¶ä¸èƒ½ä¿è¯å¼‚æ­¥çš„è¯·æ±‚èƒ½å¤ŸæˆåŠŸå‘å‡ºå»ã€‚</p><p>æˆ‘ä»¬æœ‰å‡ ç§æ–¹å¼å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><h3 id="æ–¹æ¡ˆ1-å‘é€åŒæ­¥çš„ajaxè¯·æ±‚"><a href="#æ–¹æ¡ˆ1-å‘é€åŒæ­¥çš„ajaxè¯·æ±‚" class="headerlink" title="æ–¹æ¡ˆ1: å‘é€åŒæ­¥çš„ajaxè¯·æ±‚"></a>æ–¹æ¡ˆ1: å‘é€åŒæ­¥çš„ajaxè¯·æ±‚</h3><pre><code class="js">var oAjax = new XMLHttpRequest();oAjax.open(&#39;POST&#39;, url + &#39;/user/register&#39;, false);//falseè¡¨ç¤ºåŒæ­¥è¯·æ±‚oAjax.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);oAjax.onreadystatechange = function() {    if (oAjax.readyState == 4 &amp;&amp; oAjax.status == 200) {        var data = JSON.parse(oAjax.responseText);    } else {        console.log(oAjax);    }};oAjax.send(&#39;a=1&amp;b=2&#39;);</code></pre><p>è¿™ç§æ–¹å¼è™½ç„¶æœ‰æ•ˆï¼Œä½†æ˜¯ç”¨æˆ·éœ€è¦ç­‰å¾…è¯·æ±‚ç»“æŸæ‰å¯ä»¥å…³é—­é¡µé¢ã€‚å¯¹ç”¨æˆ·çš„ä½“éªŒä¸å¥½ã€‚</p><a id="more"></a><h3 id="å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œå¹¶ä¸”åœ¨æœåŠ¡ç«¯å¿½ç•¥ajaxçš„abort"><a href="#å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œå¹¶ä¸”åœ¨æœåŠ¡ç«¯å¿½ç•¥ajaxçš„abort" class="headerlink" title="å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œå¹¶ä¸”åœ¨æœåŠ¡ç«¯å¿½ç•¥ajaxçš„abort"></a>å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œå¹¶ä¸”åœ¨æœåŠ¡ç«¯å¿½ç•¥ajaxçš„abort</h3><p>è™½ç„¶å¼‚æ­¥è¯·æ±‚ä¼šè¢«æµè§ˆå™¨abortï¼Œä½†æ˜¯å¦‚æœæœåŠ¡ç«¯å¯ä»¥å¿½ç•¥abortï¼Œä»ç„¶æ­£å¸¸æ‰§è¡Œï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚æ¯”å¦‚PHPæœ‰<code>ignore_user_abort</code>å‡½æ•°å¯ä»¥å¿½ç•¥abortã€‚è¿™æ ·éœ€è¦æ”¹é€ åå°ï¼Œä¸€èˆ¬ä¸å¤ªå¯è¡Œ..</p><h3 id="æ–¹æ¡ˆ3ï¼šä½¿ç”¨navigator-sendBeaconå‘é€å¼‚æ­¥è¯·æ±‚"><a href="#æ–¹æ¡ˆ3ï¼šä½¿ç”¨navigator-sendBeaconå‘é€å¼‚æ­¥è¯·æ±‚" class="headerlink" title="æ–¹æ¡ˆ3ï¼šä½¿ç”¨navigator.sendBeaconå‘é€å¼‚æ­¥è¯·æ±‚"></a>æ–¹æ¡ˆ3ï¼šä½¿ç”¨<code>navigator.sendBeacon</code>å‘é€å¼‚æ­¥è¯·æ±‚</h3><p>æ ¹æ®MDNçš„ä»‹ç»ï¼š</p><blockquote><p>è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºæ»¡è¶³ ç»Ÿè®¡å’Œè¯Šæ–­ä»£ç  çš„éœ€è¦ï¼Œè¿™äº›ä»£ç é€šå¸¸å°è¯•åœ¨å¸è½½ï¼ˆunloadï¼‰æ–‡æ¡£ä¹‹å‰å‘webæœåŠ¡å™¨å‘é€æ•°æ®ã€‚è¿‡æ—©çš„å‘é€æ•°æ®å¯èƒ½å¯¼è‡´é”™è¿‡æ”¶é›†æ•°æ®çš„æœºä¼šã€‚ç„¶è€Œï¼Œ å¯¹äºå¼€å‘è€…æ¥è¯´ä¿è¯åœ¨æ–‡æ¡£å¸è½½æœŸé—´å‘é€æ•°æ®ä¸€ç›´æ˜¯ä¸€ä¸ªå›°éš¾ã€‚å› ä¸ºç”¨æˆ·ä»£ç†é€šå¸¸ä¼šå¿½ç•¥åœ¨å¸è½½äº‹ä»¶å¤„ç†å™¨ä¸­äº§ç”Ÿçš„å¼‚æ­¥ <code>XMLHttpRequest</code> ã€‚</p></blockquote><pre><code class="js">navigator.sendBeacon(url [, data]);</code></pre><p><code>sendBeacon</code>æ”¯æŒå‘é€çš„dataå¯ä»¥æ˜¯<code>ArrayBufferView, Blob, DOMString</code>, æˆ–è€… <code>FormData</code> ç±»å‹çš„æ•°æ®ã€‚</p><p>ä¸‹é¢æ˜¯å‡ ç§ä½¿ç”¨<code>sendBeacon</code>å‘é€è¯·æ±‚çš„æ–¹å¼ï¼Œå¯ä»¥ä¿®æ”¹headerå’Œå†…å®¹çš„æ ¼å¼ï¼Œå› ä¸ºä¸€èˆ¬å’ŒæœåŠ¡å™¨çš„é€šä¿¡æ–¹å¼éƒ½æ˜¯å›ºå®šçš„ï¼Œå¦‚æœä¿®æ”¹äº†headeræˆ–è€…å†…å®¹ï¼ŒæœåŠ¡å™¨å°±æ— æ³•æ­£å¸¸è¯†åˆ«å‡ºæ¥äº†ã€‚</p><p>ï¼ˆ1ï¼‰ä½¿ç”¨Blobæ¥å‘é€ ä½¿ç”¨blobå‘é€çš„å¥½å¤„æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰å†…å®¹çš„æ ¼å¼å’Œheaderã€‚æ¯”å¦‚ä¸‹é¢è¿™ç§è®¾ç½®æ–¹å¼ï¼Œå°±æ˜¯å¯ä»¥è®¾ç½®content-typeä¸ºapplication/x-www-form-urlencodedã€‚</p><pre><code class="js">blob = new Blob([`room_id=123`], {type : &#39;application/x-www-form-urlencoded&#39;});navigator.sendBeacon(&quot;/cgi-bin/leave_room&quot;, blob);</code></pre><p><img src="https://user-gold-cdn.xitu.io/2019/3/5/1694d78d66686fa5?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="1"></p><p>ï¼ˆ2ï¼‰ä½¿ç”¨FormDataå¯¹è±¡ï¼Œä½†æ˜¯è¿™æ—¶<code>content-type</code>ä¼šè¢«è®¾ç½®æˆ<code>&quot;multipart/form-data&quot;</code>ã€‚</p><pre><code class="js">var fd = new FormData();fd.append(&#39;room_id&#39;, 123);navigator.sendBeacon(&quot;/cgi-bin/leave_room&quot;, fd);</code></pre><p><img src="https://user-gold-cdn.xitu.io/2019/3/5/1694d78d632c79f3?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="2"></p><p>ï¼ˆ3ï¼‰æ•°æ®ä¹Ÿå¯ä»¥ä½¿ç”¨<code>URLSearchParams</code> å¯¹è±¡ï¼Œcontent-typeä¼šè¢«è®¾ç½®æˆâ€text/plain;charset=UTF-8â€ ã€‚</p><pre><code class="js">var params = new URLSearchParams({ room_id: 123 })navigator.sendBeacon(&quot;/cgi-bin/leave_room&quot;, params);</code></pre><p><img src="https://user-gold-cdn.xitu.io/2019/3/5/1694d78d64c21552?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="3"><br>é€šè¿‡å°è¯•ï¼Œå¯ä»¥å‘ç°ä½¿ç”¨blobå‘é€æ¯”è¾ƒæ–¹ä¾¿ï¼Œå†…å®¹çš„è®¾ç½®ä¹Ÿæ¯”è¾ƒçµæ´»ï¼Œå¦‚æœå‘é€çš„æ¶ˆæ¯æŠ“åŒ…åå‘ç°åå°æ²¡æœ‰è¯†åˆ«å‡ºæ¥ï¼Œå¯ä»¥å°è¯•ä¿®æ”¹å†…å®¹çš„stringæˆ–è€…headerï¼Œæ¥æ‰¾åˆ°åˆé€‚çš„æ–¹å¼å‘é€è¯·æ±‚ã€‚</p><p><a href="https://juejin.im/post/5c7e541b6fb9a049e06415a5#comment" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Ajax </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ajax </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Œä»æºç ä¸­å­¦ä¹ ã€é¢è¯•å®˜éƒ½ä¸çŸ¥é“çš„Vueé¢˜ç›®ç­”æ¡ˆ</title>
      <link href="/2019/03/27/Vue/%E3%80%8C%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%AD%E5%AD%A6%E4%B9%A0%E3%80%8D%E9%9D%A2%E8%AF%95%E5%AE%98%E9%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Vue%E9%A2%98%E7%9B%AE%E7%AD%94%E6%A1%88/"/>
      <url>/2019/03/27/Vue/%E3%80%8C%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%AD%E5%AD%A6%E4%B9%A0%E3%80%8D%E9%9D%A2%E8%AF%95%E5%AE%98%E9%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Vue%E9%A2%98%E7%9B%AE%E7%AD%94%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5c959f74f265da610c068fa8#heading-11" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å½“å›ç­”é¢è¯•å®˜é—®åŠçš„Vueé—®é¢˜ï¼Œæˆ‘ä»¬é™¤äº†ç…§æœ¬å®£ç§‘çš„å›ç­”å¤–ï¼Œå…¶å®è¿˜å¯ä»¥æ ¹æ®å°‘é‡çš„æºç æ¥ç§€ä¸€æŠŠï¼Œæ¥ä½“ç°å‡ºä½ å¯¹Vueçš„æ·±åº¦äº†è§£ã€‚</p><h2 id="â€œnew-Vue-åšäº†ä»€ä¹ˆï¼Ÿâ€"><a href="#â€œnew-Vue-åšäº†ä»€ä¹ˆï¼Ÿâ€" class="headerlink" title="â€œnew Vue() åšäº†ä»€ä¹ˆï¼Ÿâ€"></a>â€œnew Vue() åšäº†ä»€ä¹ˆï¼Ÿâ€</h2><p>newå…³é”®å­—ä»£è¡¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡, è€ŒVueå®é™…ä¸Šæ˜¯ä¸€ä¸ªç±», æºç ä½ç½®æ˜¯<code>/src/core/instance/index.js</code>ã€‚</p><pre><code class="js">function Vue (options) {  if (process.env.NODE_ENV !== &#39;production&#39; &amp;&amp;    !(this instanceof Vue)  ) {    warn(&#39;Vue is a constructor and should be called with the `new` keyword&#39;)  }  this._init(options)}</code></pre><p>æ¥ç€æˆ‘ä»¬è·³è½¬è¿½è¸ªè‡³<code>this._init()</code>ï¼Œå³<code>Vue.prototype._init</code>,ä½äº<code>src\core\instance\init.js</code>åœ¨<code>_init()</code>æ–¹æ³•çš„å†…éƒ¨æœ‰ä¸€ç³»åˆ— <code>init*</code> çš„æ–¹æ³•</p><pre><code class="js">Vue.prototype._init = function (options?: Object) {    const vm: Component = this    // ...å¿½ç•¥ï¼Œä»ç¬¬45è¡Œçœ‹èµ·    if (process.env.NODE_ENV !== &#39;production&#39;) {      initProxy(vm)    } else {      vm._renderProxy = vm    }    // expose real self    vm._self = vm    initLifecycle(vm)    initEvents(vm)    initRender(vm)    callHook(vm, &#39;beforeCreate&#39;)    initInjections(vm) // resolve injections before data/props    initState(vm)    initProvide(vm) // resolve provide after data/props    callHook(vm, &#39;created&#39;)    // ...å¿½ç•¥    if (vm.$options.el) {      vm.$mount(vm.$options.el)    }  }}</code></pre><h3 id="è¿™é‡Œæˆ‘ä»¬å™è¿°ä¸€ä¸‹"><a href="#è¿™é‡Œæˆ‘ä»¬å™è¿°ä¸€ä¸‹" class="headerlink" title="è¿™é‡Œæˆ‘ä»¬å™è¿°ä¸€ä¸‹"></a>è¿™é‡Œæˆ‘ä»¬å™è¿°ä¸€ä¸‹</h3><ul><li><code>initProxy</code>ï¼Œä½œç”¨åŸŸä»£ç†ï¼Œæ‹¦æˆªç»„ä»¶å†…è®¿é—®å…¶å®ƒç»„ä»¶çš„æ•°æ®ã€‚</li><li><code>initLifecycle</code>, å»ºç«‹çˆ¶å­ç»„ä»¶å…³ç³»ï¼Œåœ¨å½“å‰å®ä¾‹ä¸Šæ·»åŠ ä¸€äº›å±æ€§å’Œç”Ÿå‘½å‘¨æœŸæ ‡è¯†ã€‚å¦‚ï¼š<code>$childrenã€$refsã€_isMounted</code>ç­‰ã€‚</li><li><code>initEvents</code>ï¼Œç”¨æ¥å­˜æ”¾é™¤@hook:ç”Ÿå‘½å‘¨æœŸé’©å­åç§°=â€ç»‘å®šçš„å‡½æ•°â€äº‹ä»¶çš„å¯¹è±¡ã€‚å¦‚ï¼š<code>$onã€$emit</code>ç­‰ã€‚</li><li><code>initRender</code>ï¼Œç”¨äºåˆå§‹åŒ–<code>$slotsã€$attrsã€$listeners</code></li><li><code>initInjections</code>ï¼Œåˆå§‹åŒ–injectï¼Œä¸€èˆ¬ç”¨äºæ›´æ·±å±‚æ¬¡çš„ç»„ä»¶é€šä¿¡ï¼Œç›¸å½“äºåŠ å¼ºç‰ˆçš„propsã€‚ç”¨äºç»„ä»¶åº“å¼€å‘è¾ƒå¤šã€‚</li></ul><blockquote><p>åªè¦åœ¨ä¸Šä¸€å±‚çº§çš„å£°æ˜çš„provideï¼Œé‚£ä¹ˆä¸‹ä¸€å±‚çº§æ— è®ºå¤šæ·±éƒ½èƒ½å¤Ÿé€šè¿‡injectæ¥è®¿é—®åˆ°provideçš„æ•°æ®ã€‚è¿™ä¹ˆåšä¹Ÿæ˜¯æœ‰æ˜æ˜¾çš„ç¼ºç‚¹ï¼š<strong>åœ¨ä»»æ„å±‚çº§éƒ½èƒ½è®¿é—®ï¼Œå¯¼è‡´æ•°æ®è¿½è¸ªæ¯”è¾ƒå›°éš¾ï¼Œä¸çŸ¥é“æ˜¯å“ªä¸€ä¸ªå±‚çº§å£°æ˜äº†è¿™ä¸ªæˆ–è€…ä¸çŸ¥é“å“ªä¸€å±‚çº§æˆ–è‹¥å¹²ä¸ªå±‚çº§ä½¿ç”¨</strong>ã€‚</p></blockquote><ul><li>initStateï¼Œæ˜¯å¾ˆå¤šé€‰é¡¹åˆå§‹åŒ–çš„æ±‡æ€»ï¼ŒåŒ…æ‹¬ï¼špropsã€methodsã€dataã€computed å’Œ watch ç­‰ã€‚</li><li>initProvideï¼Œåˆå§‹åŒ–provideã€‚</li><li>vm.$mountï¼ŒæŒ‚è½½å®ä¾‹ã€‚</li></ul><h2 id="â€œä»€ä¹ˆé˜¶æ®µæ‰èƒ½è®¿é—®DOMï¼Ÿâ€"><a href="#â€œä»€ä¹ˆé˜¶æ®µæ‰èƒ½è®¿é—®DOMï¼Ÿâ€" class="headerlink" title="â€œä»€ä¹ˆé˜¶æ®µæ‰èƒ½è®¿é—®DOMï¼Ÿâ€"></a>â€œä»€ä¹ˆé˜¶æ®µæ‰èƒ½è®¿é—®DOMï¼Ÿâ€</h2><p>è¿™ä¸ªå›ç­”å¯ä»¥ä»<code>beforeCreate</code>ä»¥åŠ <code>created</code>çš„è°ƒç”¨æ—¶æœºè°ˆèµ·ï¼Œæˆ‘ä»¬æ ¹æ®ä¸Šé¢çš„æ¦‚è¿°ï¼Œæ¥ç®€åŒ–ä¸‹ä»£ç :</p><pre><code class="js">callHook(vm, &#39;beforeCreate&#39;)// åˆå§‹åŒ– inject// åˆå§‹åŒ– propsã€methodsã€dataã€computed å’Œ watch// åˆå§‹åŒ– providecallHook(vm, &#39;created&#39;)// æŒ‚è½½å®ä¾‹ vm.$mount(vm.$options.el)</code></pre><p>æ‰€ä»¥å½“é¢è¯•å®˜é—®ä½ ï¼š</p><ul><li>beforeCreateä»¥åŠ created è°ƒç”¨æ—¶ï¼Œå“ªäº›æ•°æ®èƒ½ç”¨ä¸å¦ï¼Ÿ</li><li>ä»€ä¹ˆé˜¶æ®µæ‰èƒ½è®¿é—®DOMï¼Ÿ</li><li>ä¸ºä»€ä¹ˆcreatedä¹‹åæ‰æŒ‚è½½å®ä¾‹ï¼Ÿ</li></ul><h2 id="â€œè°ˆè°ˆä½ å¯¹Vueçš„ç”Ÿå‘½å‘¨æœŸçš„ç†è§£â€"><a href="#â€œè°ˆè°ˆä½ å¯¹Vueçš„ç”Ÿå‘½å‘¨æœŸçš„ç†è§£â€" class="headerlink" title="â€œè°ˆè°ˆä½ å¯¹Vueçš„ç”Ÿå‘½å‘¨æœŸçš„ç†è§£â€"></a>â€œè°ˆè°ˆä½ å¯¹Vueçš„ç”Ÿå‘½å‘¨æœŸçš„ç†è§£â€</h2><p>å¸¸è§„å›ç­”è¿™é‡Œå°±ä¸è¯´äº†ï¼Œæ¥ç¨å¾®æ·±å…¥ç‚¹çš„ï¼š</p><a id="more"></a><p>1.<code>created/mounted/updated/destroyed</code>ï¼Œä»¥åŠå¯¹åº”çš„<code>before</code>é’©å­ã€‚åˆ†åˆ«æ˜¯åˆ›å»º=&gt;æŒ‚è½½=&gt;æ›´æ–°=&gt;é”€æ¯ã€‚</p><p>2.Vueæºç ä¸­å®šä¹‰äº†ä¸€ä¸ª<code>mergeHook</code>å‡½æ•°æ¥éå†ä¸€ä¸ªå¸¸é‡æ•°ç»„<code>LIFECYCLE_HOOKS</code>ï¼Œè¯¥æ•°ç»„å®é™…ä¸Šæ˜¯<strong>ç”±ä¸ç”Ÿå‘½å‘¨æœŸé’©å­åŒåçš„å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„</strong>ã€‚</p><pre><code class="js">// v2.6.10 æœ€æ–°ç‰ˆvar LIFECYCLE_HOOKS = [    &#39;beforeCreate&#39;,    &#39;created&#39;,    &#39;beforeMount&#39;,    &#39;mounted&#39;,    &#39;beforeUpdate&#39;,    &#39;updated&#39;,    &#39;beforeDestroy&#39;,    &#39;destroyed&#39;,    &#39;activated&#39;,    &#39;deactivated&#39;,    &#39;errorCaptured&#39;,    // v2.6+     &#39;serverPrefetch&#39;];</code></pre><blockquote><p>äºæ˜¯ï¼Œä½ å¯ä»¥ç­”å¤šactivated &amp; deactivatedï¼ˆkeep-alive ç»„ä»¶æ¿€æ´»/åœç”¨ï¼‰ã€errorCapturedï¼ˆv2.5 ä»¥ä¸Šç‰ˆæœ¬æœ‰çš„ä¸€ä¸ªé’©å­ï¼Œç”¨äºå¤„ç†é”™è¯¯ï¼‰è¿™ä¸‰ä¸ªã€‚</p></blockquote><h3 id="æ–°ç”Ÿå‘½å‘¨æœŸé’©å­ï¼šserverPrefetchæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#æ–°ç”Ÿå‘½å‘¨æœŸé’©å­ï¼šserverPrefetchæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æ–°ç”Ÿå‘½å‘¨æœŸé’©å­ï¼šserverPrefetchæ˜¯ä»€ä¹ˆï¼Ÿ"></a>æ–°ç”Ÿå‘½å‘¨æœŸé’©å­ï¼šserverPrefetchæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>serverPrefetch</code>å‰èº«æ˜¯<code>ssrPrefetch</code>ã€‚é¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯ç”¨æ¥å¤„ç†ssrçš„ã€‚å…è®¸æˆ‘ä»¬åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­â€œç­‰å¾…â€å¼‚æ­¥æ•°æ®ã€‚å¯åœ¨ä»»ä½•ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œè€Œä¸ä»…ä»…æ˜¯è·¯ç”±ç»„ä»¶ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2019/3/25/169b418d400ff0b7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="serverPrefetch"></p><pre><code class="js">&lt;!-- Item.vue --&gt;&lt;template&gt;  &lt;div v-if=&quot;item&quot;&gt;{{ item.title }}&lt;/div&gt;  &lt;div v-else&gt;...&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default {  computed: {    item () {      return this.$store.state.items[this.$route.params.id]    }  },  serverPrefetch () {    return this.fetchItem()  },  mounted () {    if (!this.item) {      this.fetchItem()    }  },  methods: {    fetchItem () {      // return the Promise from the action      return this.$store.dispatch(&#39;fetchItem&#39;, this.$route.params.id)    }  }}&lt;/script&gt;</code></pre><p>ç»å¤§å¤šæ•°çš„é¢è¯•å®˜éƒ½ä¸ä¼šå»å…³æ³¨v2.6+ ä»¥åçš„ä»£ç è®°å½•å’Œå˜æ›´ã€‚è¿™é‡Œå¦‚æœä½ è¯´å‡ºè¿™ä¸ªv2.6.10çš„å˜åŒ–ï¼Œå•§å•§â€¦é¢è¯•å®˜è‚¯å®šæ›´åŠ æ¬£èµä½ ã€‚</p><h3 id="ç”Ÿå‘½å‘¨æœŸé’©å­çš„åˆå¹¶ç­–ç•¥"><a href="#ç”Ÿå‘½å‘¨æœŸé’©å­çš„åˆå¹¶ç­–ç•¥" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸé’©å­çš„åˆå¹¶ç­–ç•¥"></a>ç”Ÿå‘½å‘¨æœŸé’©å­çš„åˆå¹¶ç­–ç•¥</h3><p>æ‹¿<code>callHook(vm, &#39;created&#39;)</code>è®²ï¼Œå…ˆåˆ¤æ–­ç»„ä»¶çš„é€‰é¡¹ä¸­æœ‰æ— å¯¹åº”åå­—çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå†åˆ¤æ–­æ˜¯å¦æœ‰ <code>parentVal(vm)</code>ã€‚è‹¥å­˜åœ¨<code>parentVal(vm)</code>ä¸”éƒ½æœ‰å¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œåˆ™ä¼šå°†ä¸¤è€…<code>concat</code>ä¸ºä¸€ä¸ªæ•°ç»„<code>(parentVal.concat(childVal))</code>ã€‚æ‰€ä»¥ï¼Œç”Ÿå‘½å‘¨æœŸé’©å­å…¶å®æ˜¯å¯ä»¥å†™æˆæ•°ç»„ã€‚å¦‚ï¼š</p><pre><code class="js">created: [function () {  console.log(&#39;first&#39;)},function () {  console.log(&#39;second&#39;)},function () {  console.log(&#39;third&#39;)}]</code></pre><p>é’©å­å‡½æ•°å°†æŒ‰é¡ºåºæ‰§è¡Œ</p><h2 id="Vue-router-è·¯ç”±æ¨¡å¼æœ‰å‡ ç§ï¼Ÿâ€"><a href="#Vue-router-è·¯ç”±æ¨¡å¼æœ‰å‡ ç§ï¼Ÿâ€" class="headerlink" title="Vue-router è·¯ç”±æ¨¡å¼æœ‰å‡ ç§ï¼Ÿâ€"></a>Vue-router è·¯ç”±æ¨¡å¼æœ‰å‡ ç§ï¼Ÿâ€</h2><p>ä¸‰ç§ <code>&quot;hash&quot; | &quot;history&quot; | &quot;abstract&quot;</code>ï¼Œä¸€èˆ¬äººåªçŸ¥é“ä¸¤ç§<code>&quot;hash&quot; | &quot;history&quot;</code>ã€‚</p><pre><code class="js">switch (mode) {  case &#39;history&#39;:    this.history = new HTML5History(this, options.base)    break  case &#39;hash&#39;:    this.history = new HashHistory(this, options.base, this.fallback)    break  case &#39;abstract&#39;:    this.history = new AbstractHistory(this, options.base)    break  default:    if (process.env.NODE_ENV !== &#39;production&#39;) {      assert(false, `invalid mode: ${mode}`)    }}</code></pre><p><code># mode</code><br>ç±»å‹: <code>string</code><br>é»˜è®¤å€¼: <code>&quot;hash&quot; (æµè§ˆå™¨ç¯å¢ƒ) | &quot;abstract&quot;</code> (Node.js ç¯å¢ƒ)<br>å¯é€‰å€¼: <code>&quot;hash&quot; | &quot;history&quot; | &quot;abstract&quot;</code><br>é…ç½®è·¯ç”±æ¨¡å¼:</p><p><code>hash</code>: ä½¿ç”¨ URL hash å€¼æ¥ä½œè·¯ç”±ã€‚æ”¯æŒæ‰€æœ‰æµè§ˆå™¨ï¼ŒåŒ…æ‹¬ä¸æ”¯æŒ HTML5 History Api çš„æµè§ˆå™¨ã€‚<br><code>history</code>: ä¾èµ– HTML5 History API å’ŒæœåŠ¡å™¨é…ç½®ã€‚æŸ¥çœ‹ HTML5 History æ¨¡å¼ã€‚<br><code>abstract</code>: æ”¯æŒæ‰€æœ‰ JavaScript è¿è¡Œç¯å¢ƒï¼Œå¦‚ Node.js æœåŠ¡å™¨ç«¯ã€‚å¦‚æœå‘ç°æ²¡æœ‰æµè§ˆå™¨çš„ APIï¼Œè·¯ç”±ä¼šè‡ªåŠ¨å¼ºåˆ¶è¿›å…¥è¿™ä¸ªæ¨¡å¼.</p><h2 id="â€œè°ˆè°ˆä½ å¯¹keep-aliveçš„äº†è§£ï¼Ÿâ€"><a href="#â€œè°ˆè°ˆä½ å¯¹keep-aliveçš„äº†è§£ï¼Ÿâ€" class="headerlink" title="â€œè°ˆè°ˆä½ å¯¹keep-aliveçš„äº†è§£ï¼Ÿâ€"></a>â€œè°ˆè°ˆä½ å¯¹keep-aliveçš„äº†è§£ï¼Ÿâ€</h2><p>å…ˆè´´ä¸€ä¸ªå¸¸è§„å›ç­”ï¼š</p><blockquote><p><code>keep-alive</code>æ˜¯ Vue å†…ç½®çš„ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥ä½¿è¢«åŒ…å«çš„ç»„ä»¶ä¿ç•™çŠ¶æ€ï¼Œæˆ–é¿å…é‡æ–°æ¸²æŸ“ã€‚<br>åœ¨vue 2.1.0 ç‰ˆæœ¬ä¹‹åï¼Œ<code>keep-alive</code>æ–°åŠ å…¥äº†ä¸¤ä¸ªå±æ€§: <code>include</code>(åŒ…å«çš„ç»„ä»¶ç¼“å­˜) ä¸ <code>exclude</code>(æ’é™¤çš„ç»„ä»¶ä¸ç¼“å­˜ï¼Œä¼˜å…ˆçº§å¤§äºinclude) ã€‚</p></blockquote><p>ç„¶åä½ å¯ä»¥å¼€å§‹éªšäº†ï¼š</p><p>1.<code>&lt;keep-alive&gt;</code>æ˜¯ Vue æºç ä¸­å®ç°çš„ä¸€ä¸ªå…¨å±€æŠ½è±¡ç»„ä»¶ï¼Œé€šè¿‡è‡ªå®šä¹‰ <code>render</code> å‡½æ•°å¹¶ä¸”åˆ©ç”¨äº†<strong>æ’æ§½æ¥å®ç°æ•°æ®ç¼“å­˜å’Œæ›´æ–°</strong>ã€‚å®ƒçš„å®šä¹‰åœ¨<code>src/core/components/keep-alive.js</code> ä¸­ï¼š</p><pre><code class="js">export default {  name: &#39;keep-alive&#39;,  abstract: true,  ...}</code></pre><p>2.æ‰€æœ‰çš„æŠ½è±¡ç»„ä»¶æ˜¯é€šè¿‡å®šä¹‰<code>abstract</code>é€‰é¡¹æ¥å£°æ˜çš„ã€‚æŠ½è±¡ç»„ä»¶ä¸æ¸²æŸ“çœŸå®DOMï¼Œä¸”ä¸ä¼šå‡ºç°åœ¨çˆ¶å­å…³ç³»çš„è·¯å¾„ä¸Šï¼ˆinitLifecycleä¼šå¿½ç•¥æŠ½è±¡ç»„ä»¶ï¼‰ï¼Œç›¸å…³ä»£ç ç‰‡æ®µï¼š</p><pre><code class="js">if (parent &amp;&amp; !options.abstract) {  // abstract å³ `ptions.abstract`  // while å¾ªç¯æŸ¥æ‰¾ç¬¬ä¸€ä¸ªéæŠ½è±¡çš„çˆ¶ç»„ä»¶  while (parent.$options.abstract &amp;&amp; parent.$parent) {    parent = parent.$parent  }  parent.$children.push(vm)}</code></pre><h2 id="äº†è§£Vue2-6-æ–°å…¨å±€APIï¼šVue-observable-å—ï¼Ÿâ€"><a href="#äº†è§£Vue2-6-æ–°å…¨å±€APIï¼šVue-observable-å—ï¼Ÿâ€" class="headerlink" title="äº†è§£Vue2.6+æ–°å…¨å±€APIï¼šVue.observable()å—ï¼Ÿâ€"></a>äº†è§£Vue2.6+æ–°å…¨å±€APIï¼šVue.observable()å—ï¼Ÿâ€</h2><p>Vue2.6+æ–°çš„å…¨å±€APIæ˜¯<code>Vue.observable()</code>,å®ƒçš„ä½¿ç”¨æ–¹å¼</p><pre><code class="js">import vue from vue;const state = Vue.observable ({   counter: 0,});export default {   render () {     return (       &lt;div&gt;         {state.counter}           &lt;button v-on:click={() =&gt; {state.counter ++; }}&gt;           Increment counter         &lt;/ button&gt;       &lt;/ div&gt;     );   },};</code></pre><p>è€Œå®ƒå®šä¹‰åœ¨<code>/src/core/global-api/index.js</code>ç¬¬48è¡Œï¼š</p><pre><code class="js">import { observe } from &#39;core/observer/index&#39;// ...// 2.6 explicit observable APIVue.observable = &lt;T&gt;(obj: T): T =&gt; {observe(obj)return obj}</code></pre><p>å†çœ‹çœ‹å®ƒimportçš„observeï¼Œæœ€è¿‘ä¸€æ¬¡æäº¤åœ¨<code>12/1/2018</code></p><p>æ ¸å¿ƒå°±æ˜¯æš´éœ²å‡º<code>observe(obj)</code>è§‚æµ‹åçš„æ•°æ®ï¼Œä»£ç å•¥éƒ½æ²¡æ”¹</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (äº”) --Node.jsçš„æ¨¡å—åŒ–</title>
      <link href="/2019/03/26/Node/Node%E5%AD%A6%E4%B9%A0(%E4%BA%94)%20--Node-js%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96/"/>
      <url>/2019/03/26/Node/Node%E5%AD%A6%E4%B9%A0(%E4%BA%94)%20--Node-js%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="Nodejså®šä¹‰æ¨¡å—"><a href="#Nodejså®šä¹‰æ¨¡å—" class="headerlink" title="Nodejså®šä¹‰æ¨¡å—"></a>Nodejså®šä¹‰æ¨¡å—</h1><p>Nodejsçš„æ¨¡å—åŒ–ç”±äºå‡ºç°çš„è¾ƒæ—©ï¼Œå› æ­¤å®ƒéµå¾ªçš„æ˜¯<code>CommonJS</code>è§„èŒƒï¼Œè€ŒéES6çš„æ¨¡å—åŒ–ã€‚</p><p>åœ¨Nodejsçš„æ¨¡å—åŒ–ä¸­ï¼Œæœ€å¸¸ç”¨åˆ°çš„æœ‰<code>moduleå¯¹è±¡ã€exportså¯¹è±¡ã€requireæ–¹æ³•</code>ã€‚</p><p>å…¶ä¸­moduleå’Œexportsç”¨äºè¾“å‡ºæ¨¡å—ï¼Œrequireç”¨äºå¼•ç”¨æ¨¡å—ã€‚</p><h2 id="ä¸€ä¸ªç®€å•çš„æ¨¡å—ä¾‹å­"><a href="#ä¸€ä¸ªç®€å•çš„æ¨¡å—ä¾‹å­" class="headerlink" title="ä¸€ä¸ªç®€å•çš„æ¨¡å—ä¾‹å­"></a>ä¸€ä¸ªç®€å•çš„æ¨¡å—ä¾‹å­</h2><p>å…ˆæ–°å»ºä¸€ä¸ªmodule1.jsæ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">module.exports.a = 1module.exports.b = 2let c = 3</code></pre><p>åœ¨require.jsä¸­ï¼Œå¼•å…¥æ¨¡å—å¹¶æ‰“å°ï¼š</p><pre><code class="js">const module1 = require(&#39;./module1&#39;)console.log(module1)</code></pre><p>å¯ä»¥çœ‹åˆ°æ‰“å°ç»“æœï¼š{ a: 1, b: 2 }ã€‚</p><p>è¿™æ®µä»£ç çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><p> 1.module1.jså¯¹å¤–è¾“å‡ºäº†module.exportsï¼Œmodule.exportsä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå«æœ‰aå’Œbå±æ€§ã€‚<br> 2.module1.jsä¸­è™½ç„¶å®šä¹‰äº†å˜é‡cï¼Œä½†å®ƒåªåœ¨module1.jsè¿™ä¸ªæ¨¡å—ä¸­å­˜åœ¨ï¼Œä»å¤–éƒ¨æ— æ³•è®¿é—®ã€‚<br> 3.åœ¨require.jsä¸­å¼•ç”¨module1.jsï¼Œå¿…é¡»ä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚<br> 4.è‹¥å¼•ç”¨æ—¶ä¸å¸¦è·¯å¾„ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨æ¨¡å—åç§°ï¼Œåˆ™ä¼šé»˜è®¤å¼•ç”¨é¡¹ç›®ç›®å½•ä¸‹çš„node_modulesæ–‡ä»¶å¤¹ä¸‹çš„æ¨¡å—ï¼Œå¦‚ï¼š</p><pre><code class="js">const module2 = require(&#39;module2&#39;)console.log(module2)  // { a: 1, b: 2 }</code></pre><p>è‹¥æ­¤æ—¶é¡¹ç›®ç›®å½•ä¸‹çš„node_modulesæ–‡ä»¶å¤¹ä¸‹å­˜åœ¨module2.jsæ–‡ä»¶ï¼Œåˆ™ä¼šå¼•ç”¨è¯¥æ–‡ä»¶ã€‚</p><p>è‹¥ä¸å­˜åœ¨ï¼Œåˆ™ä¼šæŸ¥æ‰¾ç³»ç»Ÿçš„node_modulesæ–‡ä»¶å¤¹ä¸‹ï¼Œå³å…¨å±€å®‰è£…çš„æ¨¡å—ï¼Œæ˜¯å¦å­˜åœ¨module2ã€‚</p><p>è‹¥è¿˜ä¸å­˜åœ¨è¯¥æ¨¡å—ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚</p><p>é€šè¿‡requireå¯¼å…¥çš„æ¨¡å—ï¼Œå¯ä»¥è¢«ä»»æ„å‘½åï¼Œå› æ­¤å†™æˆconst a = require(â€˜module2â€™)ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><h2 id="module-exports"><a href="#module-exports" class="headerlink" title="module.exports"></a>module.exports</h2><p>ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­çš„æ¨¡å—å¯¼å‡ºï¼Œè¿˜å¯ä»¥çœç•¥moduleï¼Œç›´æ¥å†™æˆ<code>exports.a = 1; exports.b = 1</code>; â€¦ã€‚</p><p>ä½†ç›´æ¥ä½¿ç”¨exportså¯¼å‡ºï¼Œä¹Ÿä»…æ”¯æŒè¿™ç§å†™æ³•ï¼Œè‹¥å†™æˆï¼š</p><pre><code class="js">exports = {  a: 1,  b: 2}</code></pre><a id="more"></a><p>åœ¨å¼•ç”¨æ¨¡å—æ—¶ï¼Œåªèƒ½æ¥æ”¶åˆ°{}ï¼Œä¹Ÿå°±æ˜¯è¯´exportsåªæ”¯æŒ<code>exports.a = 1</code>;è¿™æ ·çš„è¯­æ³•ã€‚</p><p>å¦‚æœè¦å°†æ•´ä¸ªæ¨¡å—ç›´æ¥å®šä¹‰ä¸ºä¸€ä¸ªå¯¹è±¡ã€å‡½æ•°ã€å˜é‡ã€ç±»ï¼Œåˆ™éœ€è¦ä½¿ç”¨<code>module.exports = 123</code>ã€‚</p><pre><code class="js">module.exports = {  a: 1,  b: 2}module.exports = 123module.exports = {  a: 1,  b: 2,  c: 3}module.exports = function () {  console.log(&#39;test&#39;)}module.exports = class {  constructor(name) {    this.name = name  }  show() {    console.log(`Show ${this.name}`)  }}</code></pre><p>module.exportså¯ä»¥è®©æ¨¡å—è¢«èµ‹å€¼æˆä»»æ„ç±»å‹ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯æ­¤æ—¶module.exportsç±»ä¼¼äºä¸€ä¸ªæ¨¡å—å†…çš„å…¨å±€å˜é‡ã€‚</p><p>å¯¹å®ƒçš„é‡å¤èµ‹å€¼ï¼Œåªæœ‰æœ€åçš„å€¼æœ‰æ•ˆï¼Œä¹‹å‰çš„å€¼ä¼šç›´æ¥è¢«è¦†ç›–ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œmodule3.jsæ¨¡å—æœ€ç»ˆå¯¼å‡ºä¸ºä¸€ä¸ªç±»ã€‚</p><p>å› æ­¤ï¼Œé€šå¸¸æ¨èä½¿ç”¨module.exportsï¼Œå¯ä»¥é¿å…å‡ºé”™ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (å››) --å¤„ç†æ¥æ”¶åˆ°çš„POSTæ•°æ®</title>
      <link href="/2019/03/25/Node/Node%E5%AD%A6%E4%B9%A0(%E5%9B%9B)%20--%E5%A4%84%E7%90%86%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84POST%E6%95%B0%E6%8D%AE/"/>
      <url>/2019/03/25/Node/Node%E5%AD%A6%E4%B9%A0(%E5%9B%9B)%20--%E5%A4%84%E7%90%86%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84POST%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<p>POSTæ•°æ®é‡é€šå¸¸è¾ƒå¤§ï¼Œé€šå¸¸ä¸ä¼šä¸€æ¬¡æ€§ä»å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡ç«¯ï¼Œå…·ä½“æ¯æ¬¡å‘é€çš„å¤§å°ç”±åè®®ï¼Œä»¥åŠå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„åå•†å†³å®šã€‚</p><p>å› æ­¤ï¼ŒNodejsåœ¨å¤„ç†POSTæ•°æ®æ—¶ï¼Œéœ€è¦é€šè¿‡requestå¯¹è±¡çš„dataäº‹ä»¶ï¼Œè·å–æ¯æ¬¡ä¼ è¾“çš„æ•°æ®ï¼Œå¹¶åœ¨endäº‹ä»¶è°ƒç”¨æ—¶ï¼Œå¤„ç†æ‰€æœ‰è·å–çš„æ•°æ®ã€‚</p><p>requestå¯¹è±¡æ˜¯ä¸€ä¸ª<a href="https://link.juejin.im/?target=http%3A%2F%2Fnodejs.cn%2Fapi%2Fhttp.html%23http_class_http_incomingmessage">http.IncomingMessage</a> ç±»ï¼Œè€Œå®ƒå®ç°äº†<a href="https://link.juejin.im/?target=http%3A%2F%2Fnodejs.cn%2Fapi%2Fstream.html%23stream_class_stream_readable">å¯è¯»æµæ¥å£</a>ï¼Œå› æ­¤å…·æœ‰äº†å¯è¯»æµçš„dataã€endç­‰äº‹ä»¶ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œdataäº‹ä»¶ä¸­ä¼ å…¥çš„å‚æ•°æ˜¯<code>Buffer</code>ï¼Œ<code>Buffer</code>åªæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶çš„æ•°æ®ï¼Œå®ƒæœ‰å¯èƒ½åªæ˜¯ä¸€æ®µå­—ç¬¦ä¸²æ•°æ®ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥å¤„ç†Bufferæ•°æ®çš„æ—¶å€™è¦æ³¨æ„è¿™ä¸€ç‚¹ã€‚</p><pre><code class="js">const http = require(&#39;http&#39;)const querystring = require(&#39;querystring&#39;)const server = http.createServer((req, res) =&gt; {  let bufferArray = []  // ç”¨äºå­˜å‚¨dataäº‹ä»¶è·å–çš„Bufferæ•°æ®ã€‚  req.on(&#39;data&#39;, (buffer) =&gt; {    bufferArray.push(buffer)  // å°†Bufferæ•°æ®å­˜å‚¨åœ¨æ•°ç»„ä¸­ã€‚  })  req.on(&#39;end&#39;, () =&gt; {    // Buffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä½¿ç”¨æ—¶æ— éœ€ require(&#39;buffer&#39;).Bufferã€‚    // Buffer.concatæ–¹æ³•ç”¨äºåˆå¹¶Bufferæ•°ç»„ã€‚    const buffer = Buffer.concat(bufferArray)    // å·²çŸ¥Bufferæ•°æ®åªæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™å¯ä»¥ç›´æ¥ç”¨toStringå°†å…¶è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚    const post = querystring.parse(buffer.toString())    console.log(post)  })})server.listen(8080)</code></pre><h2 id="åŒæ—¶å¤„ç†GET-POSTè¯·æ±‚"><a href="#åŒæ—¶å¤„ç†GET-POSTè¯·æ±‚" class="headerlink" title="åŒæ—¶å¤„ç†GET/POSTè¯·æ±‚"></a>åŒæ—¶å¤„ç†GET/POSTè¯·æ±‚</h2><p>é€šå¸¸åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒåŒä¸€å°æœåŠ¡å™¨éœ€è¦æ¥æ”¶å¤šç§ç±»å‹çš„è¯·æ±‚ï¼Œå¹¶åŒºåˆ†ä¸åŒæ¥å£ï¼Œå‘å®¢æˆ·ç«¯è¿”å›æ•°æ®ã€‚</p><p>æœ€å¸¸ç”¨çš„æ–¹å¼ï¼Œ<strong>å°±æ˜¯å¯¹è¯·æ±‚çš„æ–¹æ³•ã€urlè¿›è¡ŒåŒºåˆ†åˆ¤æ–­ï¼Œè·å–åˆ°æ¯ä¸ªè¯·æ±‚çš„æ•°æ®åï¼Œç»Ÿä¸€ç”±ä¸€ä¸ªå›è°ƒå‡½æ•°è¿›è¡Œå¤„ç†</strong>ã€‚</p><pre><code class="js">const http = require(&#39;http&#39;)const url = require(&#39;url&#39;)const querystring = require(&#39;querystring&#39;)const server = http.createServer((req, res) =&gt; {  // å®šä¹‰å…¬å…±å˜é‡ï¼Œå­˜å‚¨è¯·æ±‚æ–¹æ³•ã€è·¯å¾„ã€æ•°æ®  const method = req.method  let path = &#39;&#39;  let get = {}  let post = {}  // åˆ¤æ–­è¯·æ±‚æ–¹æ³•ä¸ºGETè¿˜æ˜¯POSTï¼ŒåŒºåˆ†å¤„ç†æ•°æ®  if (method === &#39;GET&#39;) {    // ä½¿ç”¨url.parseè§£ægetæ•°æ®    const { pathname, query } = url.parse(req.url, true)    path = pathname    get = query    complete()  } else if (method === &#39;POST&#39;) {    path = req.url    let arr = []    req.on(&#39;data&#39;, (buffer) =&gt; {      // è·å–POSTè¯·æ±‚çš„Bufferæ•°æ®      arr.push(buffer)    })    req.on(&#39;end&#39;, () =&gt; {      // å°†Bufferæ•°æ®åˆå¹¶      let buffer = Buffer.concat(arr)      // å¤„ç†æ¥æ”¶åˆ°çš„POSTæ•°æ®      post = querystring.parse(buffer.toString())      complete()    })  }  // åœ¨å›è°ƒå‡½æ•°ä¸­ç»Ÿä¸€å¤„ç†è§£æåçš„æ•°æ®  function complete() {    console.log(method, path, get, post)  }})server.listen(8080)</code></pre><a id="more"></a><h2 id="å®ç°ä¸€ä¸ªå¸¦æ¥å£è¯·æ±‚çš„ç®€å•æœåŠ¡å™¨"><a href="#å®ç°ä¸€ä¸ªå¸¦æ¥å£è¯·æ±‚çš„ç®€å•æœåŠ¡å™¨" class="headerlink" title="å®ç°ä¸€ä¸ªå¸¦æ¥å£è¯·æ±‚çš„ç®€å•æœåŠ¡å™¨"></a>å®ç°ä¸€ä¸ªå¸¦æ¥å£è¯·æ±‚çš„ç®€å•æœåŠ¡å™¨</h2><p>è™½ç„¶å½“å‰è¿˜æœªæ¶‰åŠåˆ°æ•°æ®åº“çš„çŸ¥è¯†ï¼Œä½†å·²ç»å¯ä»¥é€šè¿‡æ–‡ä»¶è¯»å†™ï¼Œå®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨ï¼Œéœ€æ±‚å¦‚ä¸‹ï¼š</p><ul><li>ç”¨æˆ·é€šè¿‡GETæ–¹æ³•è¯·æ±‚/regæ¥å£ï¼Œå®ç°æ³¨å†Œæµç¨‹ã€‚</li><li>ç”¨æˆ·é€šè¿‡POSTæ–¹æ³•è¯·æ±‚/loginæ¥å£ï¼Œå®ç°ç™»å½•æµç¨‹ã€‚</li><li>éæ¥å£è¯·æ±‚åˆ™ç›´æ¥è¿”å›ç›¸åº”æ–‡ä»¶ã€‚</li></ul><p><strong>å®ç°æ€è·¯</strong></p><ul><li>æ–°å»ºusers.jsonæ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ç”¨æˆ·åˆ—è¡¨æ•°æ®ã€‚</li><li>æ–°å»ºindex.htmlæ–‡ä»¶ï¼Œå®ç°è¡¨å•åŠæ³¨å†Œã€ç™»å½•çš„å‰ç«¯è¯·æ±‚åŠŸèƒ½ã€‚</li><li>æœåŠ¡ç«¯åˆ¤æ–­è¯·æ±‚è·¯å¾„ï¼Œå†³å®šæ˜¯å‰ç«¯æ˜¯é€šè¿‡æ¥å£æ ¡éªŒç”¨æˆ·æ•°æ®ï¼Œè¿˜æ˜¯è¯·æ±‚HTMLæ–‡ä»¶ã€‚</li><li>è‹¥æ˜¯æ¥å£è¯·æ±‚ï¼Œåˆ™é€šè¿‡ç”¨æˆ·åˆ—è¡¨åˆ¤æ–­ç”¨æˆ·çŠ¶æ€ï¼Œå®ç°æ³¨å†Œå’Œç™»å½•æµç¨‹ã€‚</li></ul><h3 id="ä»£ç åŠç¤ºä¾‹"><a href="#ä»£ç åŠç¤ºä¾‹" class="headerlink" title="ä»£ç åŠç¤ºä¾‹"></a>ä»£ç åŠç¤ºä¾‹</h3><h4 id="html"><a href="#html" class="headerlink" title="html"></a>html</h4><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;  &lt;meta charset=&quot;UTF-8&quot;&gt;  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;  &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt;  ç”¨æˆ·ï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot;&gt;&lt;br/&gt;  å¯†ç ï¼š&lt;input type=&quot;text&quot; name=&quot;password&quot; id=&quot;password&quot;&gt;&lt;br/&gt;  &lt;input type=&quot;button&quot; value=&quot;æ³¨å†Œ&quot; id=&quot;reg&quot;&gt;  &lt;input type=&quot;button&quot; value=&quot;ç™»å½•&quot; id=&quot;login&quot;&gt;  &lt;script&gt;    // æ³¨å†Œ    document.querySelector(&#39;#reg&#39;).addEventListener(&#39;click&#39;, async function () {      const response = await fetch(`/reg?username=${document.querySelector(&#39;#username&#39;).value}&amp;password=${document.querySelector(&#39;#password&#39;).value}`)      const result = await response.json()      console.log(result)      alert(result.msg)    })    // ç™»å½•    document.querySelector(&#39;#login&#39;).addEventListener(&#39;click&#39;, async function () {      const response = await fetch(`/login`, {        method: &#39;POST&#39;,        body: JSON.stringify({          username: document.querySelector(&#39;#username&#39;).value,          password: document.querySelector(&#39;#password&#39;).value        })      })      const result = await response.json()      console.log(result)      alert(result.msg)    })  &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h4 id="server-js"><a href="#server-js" class="headerlink" title="server.js"></a>server.js</h4><pre><code class="js">const http = require(&#39;http&#39;)const url = require(&#39;url&#39;)const fs = require(&#39;fs&#39;)const querystring = require(&#39;querystring&#39;)const server = http.createServer((req, res) =&gt; {  // å®šä¹‰å…¬å…±å˜é‡ï¼Œå­˜å‚¨è¯·æ±‚æ–¹æ³•ã€è·¯å¾„ã€æ•°æ®  const method = req.method  let path = &#39;&#39;  let get = {}  let post = {}  // åˆ¤æ–­è¯·æ±‚æ–¹æ³•ä¸ºGETè¿˜æ˜¯POSTï¼ŒåŒºåˆ†å¤„ç†æ•°æ®  if (method === &#39;GET&#39;) {    // ä½¿ç”¨url.parseè§£ægetæ•°æ®    const { pathname, query } = url.parse(req.url, true)    path = pathname    get = query    complete()  } else if (method === &#39;POST&#39;) {    path = req.url    let arr = []    req.on(&#39;data&#39;, (buffer) =&gt; {      // è·å–POSTè¯·æ±‚çš„Bufferæ•°æ®      arr.push(buffer)    })    req.on(&#39;end&#39;, () =&gt; {      // å°†Bufferæ•°æ®åˆå¹¶      let buffer = Buffer.concat(arr)      // å¤„ç†æ¥æ”¶åˆ°çš„POSTæ•°æ®      post = JSON.parse(buffer.toString())      complete()    })  }  // åœ¨å›è°ƒå‡½æ•°ä¸­ç»Ÿä¸€å¤„ç†è§£æåçš„æ•°æ®  function complete() {    try {      if (path === &#39;/reg&#39;) {        // è·å–getè¯·æ±‚æ•°æ®        const {          username,          password        } = get        // è¯»å–user.jsonæ–‡ä»¶        fs.readFile(&#39;./users.json&#39;, (error, data) =&gt; {          if (error) {            res.writeHead(404)          } else {            // è¯»å–ç”¨æˆ·æ•°æ®            const users = JSON.parse(data.toString())            const usernameIndex = users.findIndex((item) =&gt; {              return username === item.username            })            // åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å­˜åœ¨            if (usernameIndex &gt;= 0) {              res.write(JSON.stringify({                error: 1,                msg: &#39;æ­¤ç”¨æˆ·åå·²å­˜åœ¨&#39;              }))              res.end()            } else {              // ç”¨æˆ·åä¸å­˜åœ¨åˆ™åœ¨ç”¨æˆ·åˆ—è¡¨ä¸­å¢åŠ ä¸€ä¸ªç”¨æˆ·              users.push({                username,                password              })              // å°†æ–°çš„ç”¨æˆ·åˆ—è¡¨ä¿å­˜åˆ°user.jsonæ–‡ä»¶ä¸­              fs.writeFile(&#39;./users.json&#39;, JSON.stringify(users), (error) =&gt; {                if (error) {                  res.writeHead(404)                } else {                  res.write(JSON.stringify({                    error: 0,                    msg: &#39;æ³¨å†ŒæˆåŠŸ&#39;                  }))                }                res.end()              })            }          }        })      } else if (path === &#39;/login&#39;) {        const {          username,          password        } = post        // è¯»å–users.json        fs.readFile(&#39;./users.json&#39;, (error, data) =&gt; {          if (error) {            res.writeHead(404)          } else {            // è·å–useråˆ—è¡¨æ•°æ®            const users = JSON.parse(data.toString())            const usernameIndex = users.findIndex((item) =&gt; {              return username === item.username            })            if (usernameIndex &gt;= 0) {              // ç”¨æˆ·åå­˜åœ¨ï¼Œåˆ™æ ¡éªŒå¯†ç æ˜¯å¦æ­£ç¡®              if (users[usernameIndex].password === password) {                res.write(JSON.stringify({                  error: 0,                  msg: &#39;ç™»å½•æˆåŠŸ&#39;                }))              } else {                res.write(JSON.stringify({                  error: 1,                  msg: &#39;å¯†ç é”™è¯¯&#39;                }))              }            } else {              res.write(JSON.stringify({                error: 1,                msg: &#39;è¯¥ç”¨æˆ·ä¸å­˜åœ¨&#39;              }))            }          }          res.end()        })      } else {        // è‹¥ä¸æ˜¯æ³¨å†Œæˆ–ç™»å½•æ¥å£ï¼Œåˆ™ç›´æ¥è¿”å›ç›¸åº”æ–‡ä»¶        fs.readFile(`.${path}`, (error, data) =&gt; {          if (error) {            res.writeHead(404)          } else {            res.write(data)          }          res.end()        })      }    } catch (error) {      console.error(error);    }  }})server.listen(8080)</code></pre>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (ä¸‰) --å¤„ç†æ¥æ”¶åˆ°çš„GETæ•°æ®</title>
      <link href="/2019/03/19/Node/Node%E5%AD%A6%E4%B9%A0(%E4%B8%89)%20--%E5%A4%84%E7%90%86%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84GET%E6%95%B0%E6%8D%AE/"/>
      <url>/2019/03/19/Node/Node%E5%AD%A6%E4%B9%A0(%E4%B8%89)%20--%E5%A4%84%E7%90%86%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84GET%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="å¸¸ç”¨è¯·æ±‚æ–¹å¼"><a href="#å¸¸ç”¨è¯·æ±‚æ–¹å¼" class="headerlink" title="å¸¸ç”¨è¯·æ±‚æ–¹å¼"></a>å¸¸ç”¨è¯·æ±‚æ–¹å¼</h1><p>GETå’ŒPOSTæ˜¯æœ€å¸¸ç”¨çš„HTTPè¯·æ±‚æ–¹æ³•ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰DELETEã€HEADã€OPTIONSã€PUTã€TRACEç­‰ï¼Œä½†éƒ½å¾ˆå°‘ç”¨åˆ°ã€‚</p><table><thead><tr><th>GET</th><th style="text-align:right">POST</th></tr></thead><tbody><tr><td>ä¸»è¦ç”¨äºè·å–æ•°æ®</td><td style="text-align:right">ä¸»è¦ç”¨äºå‘é€æ•°æ®</td></tr><tr><td>æ•°æ®æ”¾åœ¨HTTPè¯·æ±‚Headerä¸­ï¼Œé€šè¿‡URLè¿›è¡Œä¼ è¾“ï¼Œå®¹é‡&lt;=32k</td><td style="text-align:right">æ•°æ®æ”¾åœ¨HTTPè¯·æ±‚bodyä¸­,å®¹é‡å¤§ï¼Œé€šå¸¸ä¸Šé™2G</td></tr></tbody></table><h2 id="å¤„ç†Getæ•°æ®"><a href="#å¤„ç†Getæ•°æ®" class="headerlink" title="å¤„ç†Getæ•°æ®"></a>å¤„ç†Getæ•°æ®</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Nodejsè‡ªå¸¦çš„urlå’Œquerystringæ¨¡å—å¤„ç†æ¥æ”¶åˆ°çš„GETæ•°æ®ã€‚</p><p>é¦–å…ˆæ–°å»ºä¸€ä¸ªå¸¦formè¡¨å•çš„HTMLæ–‡ä»¶ï¼Œè®²è¾“å…¥çš„æ•°æ®æäº¤åˆ°æœåŠ¡å™¨åœ°å€ï¼š</p><pre><code class="html">&lt;form action=&quot;http://localhost:8080/login&quot; method=&quot;get&quot;&gt;  ç”¨æˆ·ï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br/&gt;  å¯†ç ï¼š&lt;input type=&quot;text&quot; name=&quot;password&quot;&gt;&lt;br/&gt;  &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;&lt;/form&gt;</code></pre><p>æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°è¯·æ±‚æ•°æ®æ—¶ï¼Œå¯ä»¥æœ‰3ç§æ–¹å¼å¤„ç†æ•°æ®ï¼š</p><ol><li>å°†è¯·æ±‚æ•°æ®ä¸­çš„req.urlè¿›è¡Œå­—ç¬¦ä¸²åˆ‡å‰²ï¼Œå†ç”¨querystringæ¨¡å—è·å–æ•°æ®ã€‚</li></ol><pre><code class="js">const [ pathname, queryStr ] = req.url.split(&#39;?&#39;)const query = querystring.parse(queryStr)console.log(pathname, query)</code></pre><ol start="2"><li>ç”¨URLæ„é€ å‡½æ•°å®ä¾‹åŒ–ä¸€ä¸ªurlå¯¹è±¡ï¼Œä»ä¸­è·å–åˆ°pathnameå’Œsearchå€¼ï¼Œå†ç”¨querystringæ¨¡å—è§£æsearchæ•°æ®</li></ol><pre><code class="js">const url = new URL(`http://localhost:8080${req.url}`)const { pathname, search } = urlconst query = querystring.parse(search.substring(1, url.search.length))console.log(pathname, query)</code></pre><ol start="3"><li>ä½¿ç”¨urlæ¨¡å—çš„parseæ–¹æ³•ï¼Œç›´æ¥è§£æå‡ºæ•°æ®ã€‚</li></ol><pre><code class="js">// parseæ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°è‹¥ä¼ trueï¼Œåˆ™ä¼šç›´æ¥å°†è§£æå‡ºçš„queryå€¼è½¬ä¸ºå¯¹è±¡å½¢å¼ï¼Œå¦åˆ™å®ƒåªæ˜¯å­—ç¬¦ä¸²å½¢å¼const { pathname, query } = url.parse(req.url, true)console.log(pathname, query)</code></pre>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (äºŒ) --ä½¿ç”¨httpå’Œfsæ¨¡å—å®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨</title>
      <link href="/2019/03/19/Node/Node%E5%AD%A6%E4%B9%A0(%E4%BA%8C)%20--%E4%BD%BF%E7%94%A8http%E5%92%8Cfs%E6%A8%A1%E5%9D%97%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2019/03/19/Node/Node%E5%AD%A6%E4%B9%A0(%E4%BA%8C)%20--%E4%BD%BF%E7%94%A8http%E5%92%8Cfs%E6%A8%A1%E5%9D%97%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h1><p>1.åˆ›å»ºä¸€ä¸ªwwwç›®å½•ï¼Œå­˜å‚¨é™æ€æ–‡ä»¶1.htmlã€1.jpgã€‚</p><pre><code>* htmlæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</code></pre><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;  &lt;meta charset=&quot;UTF-8&quot;&gt;  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;  &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt;  ç½‘é¡µå†…å®¹  &lt;img src=&quot;/1.jpg&quot; alt=&quot;&quot;&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><ol start="2"><li><p>é¢„æœŸå®ç°çš„ç»“æœä¸ºï¼š<br> a. åœ¨æµè§ˆå™¨è®¿é—®<code>http://localhost:8080/1.html</code>ã€‚<br> b. è¯»å–åˆ°<code>www/1.html</code>ï¼Œç”±<code>HTML</code>æ–‡ä»¶å‘èµ·å¯¹<code>www/1.jpg</code>çš„è¯·æ±‚ã€‚<br> c. ç½‘é¡µä¸­æ˜¾ç¤º<code>HTML</code>å†…å®¹å’Œå›¾ç‰‡ã€‚</p></li><li><p>ä½¿ç”¨Nodejså®ç°æœåŠ¡ç«¯ä»£ç ï¼š</p></li></ol><pre><code class="js">const http = require(&#39;http&#39;)const fs = require(&#39;fs&#39;)const server = http.createServer((request, response) =&gt; {  console.log(request.url)  // åœ¨requestå¯¹è±¡ä¸­ï¼Œå¯ä»¥è·å–è¯·æ±‚çš„URLï¼Œé€šè¿‡URLåˆ¤æ–­è¯·æ±‚çš„èµ„æºã€‚  fs.readFile(`./www${request.url}`, (error, buffer) =&gt; { // æ ¹æ®URLæŸ¥æ‰¾è¯»å–ç›¸åº”çš„æ–‡ä»¶ã€‚    if (error) {  // è‹¥è¯»å–é”™è¯¯ï¼Œåˆ™å‘å‰ç«¯è¿”å›404çŠ¶æ€ç ï¼Œä»¥åŠå†…å®¹Not Foundã€‚      response.writeHead(404)      response.write(&#39;Not Found&#39;)    } else {  // è‹¥è¯»å–æˆåŠŸï¼Œåˆ™å‘å‰ç«¯è¿”å›è¯»å–åˆ°çš„æ–‡ä»¶ã€‚      response.write(buffer)    }    response.end()  // å…³é—­è¿æ¥ã€‚  })})server.listen(8080)</code></pre><h2 id="æœåŠ¡å™¨éœ€è¦å…·å¤‡çš„åŸºæœ¬åŠŸèƒ½"><a href="#æœåŠ¡å™¨éœ€è¦å…·å¤‡çš„åŸºæœ¬åŠŸèƒ½" class="headerlink" title="æœåŠ¡å™¨éœ€è¦å…·å¤‡çš„åŸºæœ¬åŠŸèƒ½"></a>æœåŠ¡å™¨éœ€è¦å…·å¤‡çš„åŸºæœ¬åŠŸèƒ½</h2><p>1.å“åº”è¯·æ±‚<br>    å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œå¯ä»¥æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åšå‡ºå›åº”ï¼Œå¦‚è¿”å›é™æ€æ–‡ä»¶ã€‚<br>2 æ•°æ®äº¤äº’<br>    å®šä¹‰æ¥å£ï¼Œå®¢æˆ·ç«¯æ ¹æ®æ¥å£ï¼Œä¸æœåŠ¡ç«¯è¿›è¡Œæ•°æ®äº¤äº’ã€‚<br>    ä¾‹å¦‚åœ¨ä¸€ä¸ªè´­ç‰©æµç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯è¯·æ±‚å•†å“æ•°æ®ï¼Œå±•ç°ç»™å®¢æˆ·ï¼Œå®¢æˆ·åœ¨è´­ä¹°æ—¶ï¼Œå®¢æˆ·ç«¯å°†è´­ä¹°çš„å•†å“ä¿¡æ¯å‘é€ç»™æœåŠ¡ç«¯å¤„ç†ã€‚<br>    æ•°æ®åº“<br>3.å¯¹æ•°æ®åº“ä¸­å­˜å‚¨çš„æ•°æ®è¿›è¡Œè¯»å†™æ“ä½œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå­¦ä¹ (ä¸€) --NodeJsç®€ä»‹</title>
      <link href="/2019/03/18/Node/Node%E5%AD%A6%E4%B9%A0(%E4%B8%80)%20--NodeJs%E7%AE%80%E4%BB%8B/"/>
      <url>/2019/03/18/Node/Node%E5%AD%A6%E4%B9%A0(%E4%B8%80)%20--NodeJs%E7%AE%80%E4%BB%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="NodeJsç®€ä»‹"><a href="#NodeJsç®€ä»‹" class="headerlink" title="NodeJsç®€ä»‹"></a>NodeJsç®€ä»‹</h2><ul><li>ç®€å•çš„è¯´Node.jså°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„Javascript</li><li>Node.jsæ˜¯ä¸€ä¸ªåŸºäºChromeV8å¼•æ“çš„Javascriptçš„æ‰§è¡Œç¯å¢ƒ</li><li>Node.jsä½¿ç”¨äº†ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ï¼Œéé˜»å¡å¼I/Oçš„æ¨¡å‹ï¼Œä½¿å…¶è½»é‡æœ‰é«˜æ•ˆ</li></ul><h2 id="NodeJsçš„åº”ç”¨ç¯å¢ƒ"><a href="#NodeJsçš„åº”ç”¨ç¯å¢ƒ" class="headerlink" title="NodeJsçš„åº”ç”¨ç¯å¢ƒ"></a>NodeJsçš„åº”ç”¨ç¯å¢ƒ</h2><p>ç”±äºNodejsç›®å‰è¿˜ä¸å¤Ÿæˆç†Ÿï¼Œå› æ­¤ä¸€èˆ¬ä¸ä¼šç”¨ä½œç‹¬ç«‹å¼€å‘ï¼Œå®ƒçš„ä¸»è¦ç”¨é€”å¦‚ä¸‹</p><h3 id="ä¸­é—´å±‚"><a href="#ä¸­é—´å±‚" class="headerlink" title="ä¸­é—´å±‚"></a>ä¸­é—´å±‚</h3><p>é€šå¸¸åœ¨å¼€å‘åº”ç”¨æ—¶ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œåç«¯çš„ä¸»æœåŠ¡å™¨éƒ½ä¸ä¼šç›´æ¥æš´éœ²ç»™å®¢æˆ·ç«¯ï¼Œä¸¤ç«¯ä¹‹é—´é€šå¸¸éœ€è¦æœ‰ä¸€ä¸ªä¸­é—´å±‚è¿›è¡Œé€šä¿¡ã€‚</p><p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå¦‚æœä¸­é—´å±‚å‡ºç°é—®é¢˜ï¼Œä¸ä¼šå½±å“åç«¯çš„ä¸»æœåŠ¡å™¨ã€‚å¦å¤–ï¼Œä¸­é—´å±‚å¯ä»¥åšç¼“å­˜ï¼Œæˆ–è€…å®ç°ä¸€äº›ä¸šåŠ¡é€»è¾‘ï¼Œèµ·åˆ°é™ä½ä¸»æœåŠ¡å™¨å¤æ‚åº¦ï¼Œæé«˜æ€§èƒ½çš„ä½œç”¨ã€‚</p><p>ä¸­é—´å±‚ä¹Ÿå¯ä»¥åƒCDNä¸€æ ·åœ¨å„å¤„éƒ¨ç½²ï¼Œä»¥æé«˜ç”¨æˆ·çš„è®¿é—®æ•ˆç‡ã€‚</p><h3 id="å°å‹æœåŠ¡"><a href="#å°å‹æœåŠ¡" class="headerlink" title="å°å‹æœåŠ¡"></a>å°å‹æœåŠ¡</h3><p>å¯ä»¥å®ç°ä¸€äº›å°å‹åº”ç”¨ï¼Œæˆ–æŸä¸ªåŠŸèƒ½æ¨¡å—ã€‚</p><h3 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" class="headerlink" title="å·¥å…·ç±»"></a>å·¥å…·ç±»</h3><p>å·¥å…·ç±» Nodejså¯ä»¥ç”¨æ¥å¼€å‘ä¸€äº›å®ç”¨å·¥å…·ï¼Œå¦‚Webpackã€Gulpç­‰ç­‰ã€‚</p><h2 id="Nodejsçš„ä¼˜åŠ¿"><a href="#Nodejsçš„ä¼˜åŠ¿" class="headerlink" title="Nodejsçš„ä¼˜åŠ¿"></a>Nodejsçš„ä¼˜åŠ¿</h2><ul><li><p>Nodejsçš„è¯­æ³•ä¸å‰å°JavaScriptç›¸åŒï¼Œå› æ­¤ä¾¿äºå‰ç«¯å¼€å‘å…¥æ‰‹</p></li><li><p>æ€§èƒ½é«˜</p></li><li><p>åˆ©äºä¸å‰ç«¯ä»£ç ç»“åˆï¼Œä¾‹å¦‚åœ¨åšåŒæ ·ä¸€ä¸ªæ•°æ®æ ¡éªŒæ—¶ï¼Œå‰åå°ä»£ç å¯ä»¥å…±ç”¨ï¼Œä¸éœ€è¦å•ç‹¬å¼€å‘ã€‚</p></li></ul><h2 id="Nodejsçš„å¸è½½"><a href="#Nodejsçš„å¸è½½" class="headerlink" title="Nodejsçš„å¸è½½"></a>Nodejsçš„å¸è½½</h2><p>å½“éœ€è¦å‡çº§Nodejsæ—¶ï¼Œå»ºè®®å…ˆå®Œå…¨å¸è½½æ—§ç‰ˆæœ¬ï¼Œç‰¹åˆ«æ˜¯å…¨å±€å·²ä¸‹è½½çš„ä¾èµ–ï¼Œå¦åˆ™æœ‰å°æ¦‚ç‡ä¼šå‡ºç°æ›´æ–°ç‰ˆæœ¬åï¼Œæ–°å®‰è£…ä¾èµ–æ—¶æŠ¥é”™ã€‚</p><blockquote><p>å®Œæ•´å¸è½½æ­¥éª¤ï¼š<br>é€šè¿‡ç³»ç»Ÿè‡ªå¸¦å¸è½½å·¥å…·ï¼Œå¸è½½Nodejsï¼Œä¹‹åæœ€å¥½å°†Nodejså®‰è£…ç›®å½•æ•´ä¸ªåˆ é™¤ã€‚<br>æ‰‹åŠ¨åˆ é™¤å®‰è£…ç›®å½•ï¼Œå¦‚C:\Program Files\nodejsç›®å½•ä¸‹çš„node_modulesæ–‡ä»¶å¤¹ã€‚<br>æ‰¾åˆ°ç”¨æˆ·ç›®å½•ï¼Œå¦‚C:\Users\ä½ çš„ç”¨æˆ·åï¼Œå…¶ä¸­å¦‚æœæœ‰node_modulesæ–‡ä»¶å¤¹ï¼Œåˆ™ä¸€èµ·åˆ é™¤ã€‚</p></blockquote><h2 id="å¯åŠ¨ä¸€ä¸ªNodejsæœåŠ¡å™¨"><a href="#å¯åŠ¨ä¸€ä¸ªNodejsæœåŠ¡å™¨" class="headerlink" title="å¯åŠ¨ä¸€ä¸ªNodejsæœåŠ¡å™¨"></a>å¯åŠ¨ä¸€ä¸ªNodejsæœåŠ¡å™¨</h2><p>æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªserver.jsæ–‡ä»¶ï¼Œåœ¨å‘½ä»¤è¡Œé€šè¿‡node server.jså‘½ä»¤ï¼Œå°±å¯ä»¥è¿è¡Œä¸€ä¸ªæœåŠ¡å™¨ï¼Œåœ¨æµè§ˆå™¨è®¿é—®ä¸­è®¿é—®<code>http://127.0.0.1:3000/</code>ï¼Œå°±å¯ä»¥çœ‹åˆ°Hello Worldã€‚</p><pre><code class="js">// å¼•å…¥Nodejsè‡ªå¸¦çš„httpæ¨¡å—const http = require(&#39;http&#39;);// å¼•å…¥Nodejsè‡ªå¸¦çš„child_processæ¨¡å—const childProcess = require(&#39;child_process&#39;);const hostname = &#39;127.0.0.1&#39;; // æœ¬æœºåœ°å€const port = 3000; // ç«¯å£// åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨const server = http.createServer((req, res) =&gt; {  res.statusCode = 200; // è®¾ç½®å“åº”çŠ¶æ€ç   res.setHeader(&#39;Content-Type&#39;, &#39;text/plain&#39;); // è®¾ç½®å“åº”å¤´  res.end(&#39;Hello World\n&#39;); // å‘å‰å°è¾“å‡ºå†…å®¹});// å¼€å¯ç›‘å¬server.listen(port, hostname, () =&gt; {  // åœ¨å‘½ä»¤è¡Œæ‰“å°è¿è¡Œç»“æœ  console.log(`Server running at http://${hostname}:${port}/`);  // ä½¿ç”¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€åœ°å€  childProcess.exec(`start http://${hostname}:${port}/`);});</code></pre><h2 id="response-write"><a href="#response-write" class="headerlink" title="response.write"></a>response.write</h2><p>æˆ‘ä»¬ä½¿ç”¨äº†http.createServeråˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œåœ¨å®ƒçš„å›è°ƒå‡½æ•°ä¸­ï¼Œä¼šä¼ å…¥2ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸ºrequestï¼ˆè¯·æ±‚å¯¹è±¡ï¼‰å’Œresponseï¼ˆå“åº”å¯¹è±¡ï¼‰ã€‚</p><p>é€šå¸¸ä½¿ç”¨<code>response.write</code>æ–¹æ³•å‘å‰ç«¯è¿”å›æ•°æ®ï¼Œè¯¥æ–¹æ³•å¯è°ƒç”¨å¤šæ¬¡ï¼Œè¿”å›çš„æ•°æ®ä¼šè¢«æ‹¼æ¥åˆ°ä¸€èµ·ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»è°ƒç”¨<code>response.end</code>æ–¹æ³•ç»“æŸè¯·æ±‚ï¼Œå¦åˆ™å‰ç«¯ä¼šä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œ<code>response.end</code>æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨æ¥å‘å‰ç«¯è¿”å›æ•°æ®ã€‚</p><pre><code class="js">const server = http.createServer((request, response) =&gt; {  response.write(&#39;a&#39;)  response.write(&#39;b&#39;)  response.write(&#39;c&#39;)  response.end(&#39;d&#39;)})</code></pre><!-- mode --><h2 id="File-System"><a href="#File-System" class="headerlink" title="File System"></a>File System</h2><p>File Systemæ˜¯Nodejsä¸­ç”¨æ¥æ“ä½œæ–‡ä»¶çš„åº“ï¼Œå¯ä»¥é€šè¿‡<code>const fs = require(&#39;fs&#39;)</code>å¼•ç”¨ã€‚</p><p>å¸¸ç”¨çš„æ–¹æ³•æœ‰å¼‚æ­¥æ–‡ä»¶è¯»å–<code>fs.readFile</code>ã€å¼‚æ­¥æ–‡ä»¶å†™å…¥<code>fs.writeFile</code>ã€åŒæ­¥æ–‡ä»¶è¯»å–<code>fs.readFileSync</code>ã€åŒæ­¥æ–‡ä»¶å†™å…¥<code>fs.writeFileSync</code>ã€‚ç”±äºåŒæ­¥æ“ä½œå¯èƒ½ä¼šé€ æˆé˜»å¡ï¼Œé€šå¸¸å»ºè®®ä½¿ç”¨<strong>å¼‚æ­¥æ“ä½œé¿å…</strong>è¯¥é—®é¢˜ã€‚</p><h3 id="fs-writeFile"><a href="#fs-writeFile" class="headerlink" title="fs.writeFile"></a>fs.writeFile</h3><p>fs.writeFileå¯å‘æ–‡ä»¶å†™å…¥ä¿¡æ¯ï¼Œè‹¥æ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºã€‚</p><pre><code class="js">fs.writeFile(&#39;./test.txt&#39;, &#39;test&#39;, (error) =&gt; {  if (error) {    console.log(&#39;æ–‡ä»¶å†™å…¥å¤±è´¥&#39;, error)  } else {    console.log(&#39;æ–‡ä»¶å†™å…¥æˆåŠŸ&#39;)  }})</code></pre><blockquote><p>fs.writeFileçš„ä¸»è¦å‚æ•°ï¼š</p></blockquote><p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå†™å…¥çš„æ–‡ä»¶è·¯å¾„<br>ç¬¬äºŒä¸ªå‚æ•°ä¸ºå†™å…¥å†…å®¹ï¼ˆå¯ä¸º<code>&lt;string&gt;</code> | <Buffer> | <TypedArray> | <DataView>ï¼‰<br>ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œä¼ å…¥æ•°æ®ä¸ºerrorå¯¹è±¡ï¼Œå…¶ä¸ºnullæ—¶è¡¨ç¤ºæˆåŠŸã€‚</p><h3 id="fs-readFile"><a href="#fs-readFile" class="headerlink" title="fs.readFile"></a>fs.readFile</h3><p>fs.readFileç”¨æ¥è¯»å–æ–‡ä»¶ã€‚</p><pre><code class="js">fs.readFile(&#39;./test.txt&#39;, (error, data) =&gt; {  if (error) {    console.log(&#39;æ–‡ä»¶è¯»å–å¤±è´¥&#39;, error)  } else {    // æ­¤å¤„å› ç¡®å®šè¯»å–åˆ°çš„æ•°æ®æ˜¯å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥ç”¨toStringæ–¹æ³•å°†Bufferè½¬ä¸ºå­—ç¬¦ä¸²ã€‚    // è‹¥æ˜¯éœ€è¦ä¼ è¾“ç»™æµè§ˆå™¨å¯ä»¥ç›´æ¥ç”¨Bufferï¼Œæœºå™¨ä¹‹é—´é€šä¿¡æ˜¯ç›´æ¥ç”¨Bufferæ•°æ®ã€‚    console.log(&#39;æ–‡ä»¶è¯»å–æˆåŠŸ&#39;, data.toString())  }})</code></pre><blockquote><p>fs.readFileä¸»è¦å‚æ•°ï¼š<br>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¯»å–çš„æ–‡ä»¶è·¯å¾„<br>ç¬¬äºŒä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ã€‚å›è°ƒå‡½æ•°ä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºerrorå¯¹è±¡ï¼Œå…¶ä¸ºnullæ—¶è¡¨ç¤ºæˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºæ•°æ®ï¼Œå¯ä¸º<code>&lt;string&gt;</code> | <code>&lt;Buffer&gt;</code>ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES2019çš„æ–°åŠŸèƒ½</title>
      <link href="/2019/03/16/Js/ES2019%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/"/>
      <url>/2019/03/16/Js/ES2019%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ECMAScript æ¯å¹´éƒ½ä¼šå‘å¸ƒä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œå…¶ä¸­çš„ææ¡ˆæ˜¯å·²ç»æ­£å¼é€šè¿‡çš„ï¼Œå¹¶åˆ†å‘ç»™å¼€å‘è€…å’Œç”¨æˆ·ã€‚æœ¬æ–‡å°†è®¨è®ºè¯¥è¯­è¨€çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä»¥åŠå®ƒåˆå…·æœ‰äº†ä»€ä¹ˆæ–°åŠŸèƒ½ã€‚</p><p>ES10/ES2019 åœ¨æœ¬æ¬¡æ›´æ–°ä¸­æœ‰å¾ˆå¤§çš„æ”¹è¿›ã€‚å®ƒå¼•å…¥äº†ä¸€äº›<strong>æ–°çš„å‡½æ•°å’Œæ–¹æ³•ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿç¼–å†™æ›´å°‘çš„ä»£ç ï¼Œå¹¶æé«˜å·¥ä½œæ•ˆç‡</strong>ã€‚</p><h2 id="flat"><a href="#flat" class="headerlink" title="flat()"></a>flat()</h2><p><code>flat()</code> æ˜¯ä¸€ç§ç”¨äºæ‰å¹³æ•°ç»„çš„æ–¹æ³•ã€‚åœ¨æŸäº›æ—¶å€™ï¼Œæ•°ç»„çš„å…ƒç´ è¿˜æ˜¯æ•°ç»„ï¼Œè¿™äº›ç±»å‹çš„æ•°ç»„ç§°ä¸ºåµŒå¥—æ•°ç»„ã€‚</p><p>è¦å–æ¶ˆæ•°ç»„çš„åµŒå¥—ï¼ˆæ‰å¹³å®ƒä»¬ï¼‰ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ä½¿ç”¨<code>é€’å½’</code>ã€‚ç°åœ¨å¼•å…¥<code>flat()</code>ï¼Œå¯ä»¥ç”¨ä¸€è¡Œä»£ç å®Œæˆã€‚ ä¸€ä¸ªè¢«å±•å¹³çš„æ•°ç»„æ˜¯ä¸€ä¸ªæ·±åº¦ä¸º 0 çš„æ•°ç»„ï¼Œ<em>flat() æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä»£è¡¨æ·±åº¦çš„æ•°å­—ã€‚æ·±åº¦æŒ‡çš„æ˜¯æ•°ç»„å†…åµŒå¥—çš„æ•°é‡</em>ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­å¯ä»¥å¸®ä½ ç†è§£åµŒå¥—å’Œæ·±åº¦ã€‚</p><pre><code class="js">var arr = [1,2,3,[4,5,6,[7,8,9,[1,2,3]]]];console.log(arr.flat(3)); // [1,2,3,4,5,6,7,8,9,1,2,3]</code></pre><p>é€šå¸¸åœ¨ JavaScript ä¸­ï¼Œæ•°ç»„çš„æ·±åº¦å¯ä»¥ä¸ºæ— ç©·å¤§ï¼Œæˆ–è€…ç›´åˆ°å†…å­˜ä¸è¶³ä¸ºæ­¢ã€‚å‡è®¾ä¸€ä¸ªæ•°ç»„çš„åµŒå¥—æ·±åº¦ä¸º3ï¼Œå¹¶ä¸”æˆ‘ä»¬ä»…å°†å…¶å±•å¹³åˆ°æ·±åº¦ 2ï¼Œé‚£ä¹ˆä¸»æ•°ç»„ä¸­ä»ç„¶ä¼šå­˜åœ¨ä¸€ä¸ªåµŒå¥—æ•°ç»„ã€‚</p><h2 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap()"></a>flatMap()</h2><p><code>flatMap()</code> ç”¨äºå±•å¹³åµŒå¥—æ•°ç»„å¹¶æ ¹æ®ç»™å‡ºçš„åƒ <code>map()</code> è¿™æ ·çš„å‡½æ•°æ›´æ”¹å€¼ã€‚æ­¤å‡½æ•°ä½œç”¨äºæ•°ç»„å¹¶ç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚å›è°ƒå‡½æ•°ç”¨äºæŒ‡ç¤ºæ•°ç»„åº”è¯¥æ€æ ·è¢«å±•å¹³ã€‚å®ƒå°±åƒ map ä¸€æ ·å·¥ä½œï¼Œæ­¤å¤–ä¹Ÿä½¿å®ƒå˜å¾—æ‰å¹³ã€‚å¦‚æœä½ æƒ³äº†è§£æœ‰å…³ map çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹å…³äº<a href="https://link.juejin.im/?target=https%3A%2F%2Fhackernoon.com%2Fmap-filter-reduce-ebbed4be4201">this</a>çš„æ–‡ç« ã€‚</p><p>flatMap()<code></code> å¯ç”¨äºå±•å¹³æ·±åº¦ä¸º1çš„æ•°ç»„ï¼Œå®ƒåœ¨å†…éƒ¨è°ƒç”¨ map å‡½æ•°ï¼Œåè·Ÿç€å‚æ•°æ·±åº¦ä¸º1çš„ flat å‡½æ•°.</p><pre><code class="js">var array = arr.flatMap((callback(currentValue)));</code></pre><p>è¿”å›å€¼</p><p>å¸¦æœ‰æ“çºµå€¼çš„æ‰å¹³æ•°ç»„ï¼Œç”±æä¾›ç»™å®ƒçš„å›è°ƒå‡½æ•°æä¾›ã€‚å°±åƒä¸€ä¸ªmapä¸€æ ·ã€‚</p><p><strong>map() + flat() =&gt; flatmap()</strong></p><pre><code class="js">var arr = [1,2,3,4];console.log(arr.map(x=&gt;[x*2])); // [2],[4],[6],[8]console.log(arr.flatMap(x=&gt;[x*2])); //[2,4,6,8]</code></pre><p>åœ¨æ­¤ä¾‹ä¸­ï¼Œæˆ‘ä»¬é€ä¸ªæ˜¾ç¤º map å’Œ flatMap ä»¥æ˜¾ç¤ºä¸¤ä¸ªå‡½æ•°ä¹‹é—´çš„å·®å¼‚ã€‚ map() è¿”å›åµŒå¥—æ•°ç»„ï¼Œ<br>è€ŒflatMap() çš„è¾“å‡ºé™¤äº†æ•°ç»„çš„å±•å¹³å¤–ï¼Œè¿˜ä¸ map çš„ç»“æ„ç›¸åŒã€‚</p><h2 id="Object-fromEntries"><a href="#Object-fromEntries" class="headerlink" title="Object.fromEntries()"></a>Object.fromEntries()</h2><p>å¦ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å‡½æ•° <code>Object.fromEntries</code> ç”¨äºæ ¹æ®æä¾›çš„é”®å€¼å¯¹ç”Ÿæˆå¯¹è±¡ã€‚å®ƒæ¥å—ä¸€ä¸ªé”®å€¼å¯¹åˆ—è¡¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„å±æ€§ç”±å‚æ•° <code>entries</code>66n ç»™å‡ºã€‚å®ƒçš„ä½œç”¨ä¸ <strong>Object.entries()</strong>ç›¸å</p><p>å‚æ•°<br>æ¥å—ä»»ä½•å¯è¿­ä»£çš„å¯¹è±¡ï¼Œå³æ•°ç»„ã€‚</p><a id="more"></a><p>è¿”å›å€¼<br>è¿”å›æœ‰ç»™å®šé”®å€¼å¯¹çš„å¯¹è±¡ã€‚</p><pre><code class="js">const entries = new Map([    [&#39;apple&#39;,&#39;orange&#39;],    [&#39;grapes&#39;,&#39;peach&#39;]]);const obj = Object.formEntries(entries);console.log(obj);// {apple:&quot;orange&quot;,grapes:&quot;peach&quot;}</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“å‘ <code>fromEntries()</code> å‡½æ•°æä¾›äº†ä¸€ä¸ªmapï¼ˆå°†å€¼æˆå¯¹å­˜å‚¨ï¼‰æ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å¯¹åº”çš„é”®å€¼å¯¹å’Œ map ä¸­ä¸€æ ·ã€‚</p><h2 id="trimStart"><a href="#trimStart" class="headerlink" title="trimStart()"></a>trimStart()</h2><p><code>trimStart()</code> æ–¹æ³•åˆ é™¤å­—ç¬¦ä¸²å¼€å¤´çš„ç©ºæ ¼ã€‚ <code>trimLeft()</code> æ˜¯æ­¤æ–¹æ³•çš„åˆ«åã€‚</p><pre><code class="js">var message = &#39;  Hello World&#39;;console.log(message);// &#39;  Hello World&#39;console.log(message.trimStart());//&#39;Hello World&#39;</code></pre><h2 id="trimEnd"><a href="#trimEnd" class="headerlink" title="trimEnd()"></a>trimEnd()</h2><p>trimEnd() æ–¹æ³•åˆ é™¤å­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼ã€‚ trimRight() æ˜¯æ­¤æ–¹æ³•çš„åˆ«åã€‚</p><pre><code class="js">var message = &#39;Hello World  &#39;;console.log(message);// &#39;  Hello World&#39;console.log(message.trimEnd());//&#39;Hello World&#39;</code></pre><h2 id="ä¿®æ”¹-catch-ç»‘å®š"><a href="#ä¿®æ”¹-catch-ç»‘å®š" class="headerlink" title="ä¿®æ”¹ catch ç»‘å®š"></a>ä¿®æ”¹ catch ç»‘å®š</h2><p>åœ¨ ES10 ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»<strong>é€šè¿‡è¯­æ³•ä¸º catch å­å¥ç»‘å®šå¼‚å¸¸å˜é‡ï¼Œæ— è®ºæ˜¯å¦æœ‰å¿…è¦</strong>ã€‚å¾ˆå¤šæ—¶å€™ catch å—æ˜¯å¤šä½™çš„ã€‚ ES10 ææ¡ˆä½¿æˆ‘ä»¬èƒ½å¤Ÿç®€å•çš„æŠŠå˜é‡çœç•¥æ‰ã€‚</p><p>ç¤ºä¾‹</p><pre><code class="js">function isValid(ison){    try{        JSON.parse(json);        return true;    }catch {        return false;    }}</code></pre><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æ²¡æœ‰ä¸º catch æä¾›å˜é‡ã€‚</p><h2 id="ç¬¦å·æè¿°"><a href="#ç¬¦å·æè¿°" class="headerlink" title="ç¬¦å·æè¿°"></a>ç¬¦å·æè¿°</h2><p>å½“æˆ‘ä»¬åœ¨ JS ä¸­åˆ›å»ºä¸€ä¸ª <code>Symbol</code> æ—¶ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªåœ¨ä»¥åç”¨äºè°ƒè¯•çš„æè¿°ã€‚å¾—åˆ°è¿™ä¸ªæè¿°çš„è¿‡ç¨‹æœ‰ç‚¹æ— èŠï¼Œå¿…é¡»å†æ¬¡é‡æ–°æ„é€  Symbolï¼Œå¹¶åœ¨ <code>toString()</code> æ–¹æ³•çš„å¸®åŠ©ä¸‹æ‰èƒ½è®¿é—®æè¿°ã€‚</p><p>ES10æ·»åŠ äº†ä¸€ä¸ªæ–°çš„åä¸º <code>description</code> çš„åªè¯»å±æ€§ï¼Œå®ƒè¿”å› Symbol çš„æè¿°ã€‚</p><p>ç¤ºä¾‹</p><pre><code class="js">const symbol = Symbol(&quot;this is a symbol&quot;);console.log(symbol.toString()); // Symbol(My Symbol);console.log(symbol.destription); // My Symbol</code></pre><p>å¯ä»¥çœ‹åˆ°ä½¿ç”¨ Symbol çš„.description å±æ€§èƒ½å¤Ÿç›´æ¥è·å–æè¿°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ€ä¹ˆæé«˜ä»£ç è´¨é‡ï¼Ÿ-æ¥è‡ªGoogleçš„ç ”å‘ç»éªŒæ€»ç»“</title>
      <link href="/2019/03/14/%E6%9D%82%E6%96%87/%E6%80%8E%E4%B9%88%E6%8F%90%E9%AB%98%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%EF%BC%9F-%E6%9D%A5%E8%87%AAGoogle%E7%9A%84%E7%A0%94%E5%8F%91%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/"/>
      <url>/2019/03/14/%E6%9D%82%E6%96%87/%E6%80%8E%E4%B9%88%E6%8F%90%E9%AB%98%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%EF%BC%9F-%E6%9D%A5%E8%87%AAGoogle%E7%9A%84%E7%A0%94%E5%8F%91%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5c88ac2b5188257dda56c87e" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><p>ä½ çš„å›¢é˜Ÿæœ‰æ²¡æœ‰è¿‡è¿™æ ·çš„ç»å†ï¼šå¼€å‘æ•ˆç‡ä½ï¼Œæ‹›äº†å¾ˆå¤šäººï¼Œå¤©å¤©åŠ ç­ï¼Œå‡ºæ´»å´ä¸å¤šï¼Œçº¿ä¸Šbugé¢‘å‘ï¼Œé¢†å¯¼å‘é£™ï¼Œä¸­å±‚æŸæ‰‹æ— ç­–ï¼Œå·¥ç¨‹å¸ˆæŠ±æ€¨ä¸æ–­ï¼ŒæŸ¥æ‰¾bugå›°éš¾ã€‚å…¶å®è¿™äº›éƒ½æ˜¯ä»£ç è´¨é‡å·®æƒ¹çš„ç¥¸ã€‚ä»£ç è´¨é‡æ˜¯ç ”å‘è´¨é‡ç®¡ç†çš„æ ¹æœ¬ï¼Œå®ƒå†³å®šäº†æ•´ä¸ªå¼€å‘å›¢é˜Ÿçš„å¼€å‘æ•ˆç‡ï¼Œé¡¹ç›®è´¨é‡ï¼Œå…¶ä»–ç›‘æ§ï¼Œå‘Šè­¦ï¼Œæ—¥å¿—ç­‰æ‰‹æ®µéƒ½åªèƒ½æ˜¯äº‹åè¡¥å¿ã€‚æœ¬æ–‡å°±å¦‚ä½•ä¿è¯ä»£ç è´¨é‡æ€»ç»“äº†ä¸€äº›ç»éªŒå’Œæ–¹æ³•ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚</p><p>ä»£ç è´¨é‡æœ¬èº«å¹¶æ²¡æœ‰ä¸€ä¸ªç‰¹åˆ«æ˜ç¡®çš„é‡åŒ–æŒ‡æ ‡ï¼Œè€Œä¸”æ ¹æ®å…¬å¸å‘å±•çš„ä¸åŒé˜¶æ®µï¼Œå›¢é˜Ÿè§„æ¨¡çš„å¤§å°ä¸åŒï¼Œé¡¹ç›®æ€§è´¨çš„ä¸åŒç­‰ï¼Œå¯¹ä»£ç è´¨é‡çš„è¦æ±‚ä¹Ÿä¸å°½ç›¸åŒï¼ä¸è¿‡å¦‚æœé¡¹ç›®ä¸­å‡ºç°ä»¥ä¸‹æƒ…å†µæ—¶å€™ï¼Œå°±è¯´æ˜ä»£ç è´¨é‡è¦å€¼å¾—é‡è§†äº†ï¼</p><blockquote><ul><li>æ·»åŠ æˆ–ä¿®æ”¹ä¸€ä¸ªç®€å•åŠŸèƒ½æ—¶ï¼Œæ¶‰åŠè¦ä¿®æ”¹çš„åœ°æ–¹ç‰¹åˆ«å¤šï¼Œè€Œä¸”å¾ˆåˆ†æ•£ï¼›</li><li>ä»£ç ä¸å¯å¤ç”¨ï¼šç›¸ä¼¼çš„åŠŸèƒ½æ— æ³•å¤ç”¨ä»£ç ï¼Œè¦é‡æ–°å¼€å‘ï¼›</li><li>çº¿ä¸Šbugé¢‘å‘ï¼Œæ’é”™å›°éš¾ï¼Œä¿®å¤éš¾åº¦å¤§ï¼Œæ—¶é—´é•¿ï¼›</li><li>æœ‰å¾ˆå¤šå¥‡æ€ªçš„ä»£ç ï¼Œä»£ç è¯»ä¸æ‡‚ï¼Œæ–°äººæ— æ³•å¾ˆå¿«äº†è§£ä»£ç ï¼›</li><li>ä»£ç ä¸­å‘ç‰¹åˆ«å¤šï¼Œä¸æ•¢å¤§åŠ¨ï¼Œä¸€ä¸å°å¿ƒå°±è¸©å‘ï¼›</li></ul></blockquote><p>ä»¥ä¸Šè¿™äº›é—®é¢˜ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ä»£ç è´¨é‡ä¸é«˜å¯¼è‡´çš„ï¼ŒåŒ…æ‹¬ <strong>ä»£ç æ— æ³¨é‡Šï¼Œæ— æ–‡æ¡£ï¼Œå‘½åå·®ï¼Œé¡¹ç›®å±‚æ¬¡ç»“æ„å·®ï¼Œè°ƒç”¨å…³ç³»æ··ä¹±ï¼Œåˆ°å¤„hardcode</strong>ï¼Œä¸´æ—¶è§£å†³æ–¹æ¡ˆç­‰ç­‰ã€‚æ€ä¹ˆæ‰èƒ½æ—¶åˆ»ä¿è¯ä»£ç çš„é«˜è´¨é‡ï¼Œé¿å…ä»¥ä¸Šé—®é¢˜å‘ç”Ÿï¼Ÿå½“ç„¶å›¢é˜Ÿçš„æŠ€æœ¯ç´ è´¨å¾ˆé‡è¦ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›æ–¹æ³•å¯å¾ªçš„</p><h2 id="å¹æ¯›æ±‚ç–µèˆ¬åœ°æ‰§è¡Œç¼–ç è§„èŒƒ"><a href="#å¹æ¯›æ±‚ç–µèˆ¬åœ°æ‰§è¡Œç¼–ç è§„èŒƒ" class="headerlink" title="å¹æ¯›æ±‚ç–µèˆ¬åœ°æ‰§è¡Œç¼–ç è§„èŒƒ"></a>å¹æ¯›æ±‚ç–µèˆ¬åœ°æ‰§è¡Œç¼–ç è§„èŒƒ</h2><p><strong>ä¸¥æ ¼æ‰§è¡Œä»£ç ç¼–å†™è§„èŒƒ</strong>ï¼Œå¯ä»¥ä½¿ä¸€ä¸ªé¡¹ç›®ä¹ƒè‡³ä¸€ä¸ªå…¬å¸çš„ä»£ç å…·æœ‰å®Œå…¨ç»Ÿä¸€çš„é£æ ¼ï¼Œå°±åƒåŒä¸€ä¸ªäººç¼–å†™çš„ä¸€æ ·ï¼Œè€Œä¸”<strong>å‘½åè‰¯å¥½çš„å˜é‡ï¼Œå‡½æ•°ï¼Œç±»å’Œæ³¨é‡Š</strong>ï¼Œä¹Ÿæ— ç–‘å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ï¼å…·ä½“è½å®åˆ°æ‰§è¡Œå±‚é¢ï¼Œå¯ä»¥å‚ç…§Googleçš„ç¼–ç è§„èŒƒæˆ–è€…javaå®˜æ–¹çš„ç¼–ç è§„èŒƒï¼Œç½‘ä¸Šå¯ä»¥æ‰¾åˆ°ï¼Œå…³é”®æ˜¯è¦ä¸¥æ ¼éµå®ˆï¼Œå¹¶ä¸”åœ¨code reviewæ—¶ï¼Œä¸¥æ ¼è¦æ±‚ï¼Œæ²¡æœ‰æŒ‰ç…§è§„èŒƒçš„ä¸€å®šè¦æŒ‡å‡ºå¹¶ä¸”è¦æ±‚ä¿®æ”¹ï¼</p><p>å®é™…æƒ…å†µå¾€å¾€æ˜¯è™½ç„¶å¤§å®¶éƒ½çŸ¥é“ä¼˜ç§€çš„ä»£ç è§„èŒƒæ˜¯æ€æ ·çš„ï¼Œä½†åœ¨å…·ä½“å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå´æ‰§è¡Œçš„å·®å¼ºäººæ„ï¼Œå¾ˆå¤šæƒ…å†µæ˜¯è®¤è¯†ä¸Šä¸å¤Ÿé‡è§†ï¼Œè§‰å¾—ä¸€ä¸ªå˜é‡æˆ–è€…å‡½æ•°çš„å‘½åæˆå“ªæ ·å…³ç³»ä¸å¤§ï¼Œæ‰€ä»¥ä¸å¤Ÿæ¨æ•²ï¼Œæ³¨é‡Šå¾ˆå¤šä¹Ÿéƒ½ä¸å†™ï¼Œcode reviewçš„æ—¶å€™å¤§å®¶ä¹Ÿéƒ½äº‹ä¸å…³å·±å¿ƒæ€ï¼Œæˆ–è€…è§‰å¾—æ²¡å¿…è¦å¤ªæŠ ç»†èŠ‚ï¼Œå¯¼è‡´æ…¢æ…¢çš„æ•´ä¸ªcode baseå˜å¾—è¶Šæ¥è¶Šå·®ï¼æ‰€ä»¥è¿™é‡Œè¿˜æ˜¯è¦å¼ºè°ƒä¸€ä¸‹ï¼Œ<strong>ç»†èŠ‚å†³å®šæˆè´¥ï¼Œæé«˜å›¢é˜Ÿå¯¹ä»£ç è§„èŒƒçš„è®¤åŒåŠå…¶ä¸¥æ ¼çš„æ‰§è¡Œæ˜¯å…³é”®</strong>ï¼</p><h2 id="ç¼–å†™é«˜è´¨é‡çš„å•å…ƒæµ‹è¯•"><a href="#ç¼–å†™é«˜è´¨é‡çš„å•å…ƒæµ‹è¯•" class="headerlink" title="ç¼–å†™é«˜è´¨é‡çš„å•å…ƒæµ‹è¯•"></a>ç¼–å†™é«˜è´¨é‡çš„å•å…ƒæµ‹è¯•</h2><p><strong>å•å…ƒæµ‹è¯•</strong>æ˜¯æœ€å®¹æ˜“æ‰§è¡Œï¼Œä¸”å¯¹æé«˜ä»£ç è´¨é‡è§æ•ˆæœ€å¿«çš„æ–¹æ³•ä¹‹ä¸€è¿˜ã€‚ä½†è¿˜æ˜¯æœ‰å¾ˆå¤šå…¬å¸å¯¹å•å…ƒæµ‹è¯•é‡è§†ä¸å¤Ÿï¼ŒåŒ…æ‹¬ä¸€äº›å¤§çš„äº’è”ç½‘å…¬å¸ï¼Œä¸å†™æˆ–è€…éšä¾¿å†™å†™</p><p>æœ‰äº›å·¥ç¨‹å¸ˆè§‰å¾—æœ‰æµ‹è¯•å›¢é˜Ÿå°±å¤Ÿäº†ï¼Œå†å†™å•å…ƒæµ‹è¯•å°±æ˜¯æµªè´¹æ—¶é—´ã€‚å…¶å®æµ‹è¯•å›¢é˜Ÿçš„æµ‹è¯•å’Œå•å…ƒæµ‹è¯•æ˜¯åœ¨ä¸åŒå±‚é¢ä¸Šçš„ï¼Œæµ‹è¯•å›¢é˜Ÿçš„æµ‹è¯•ä¸€èˆ¬æ˜¯é»‘ç›’æµ‹è¯•ï¼Œç³»ç»Ÿå±‚é¢çš„é›†æˆæµ‹è¯•ï¼Œå¯¹äºå¤æ‚ç³»ç»Ÿæ¥è¯´ï¼Œç»„åˆçˆ†ç‚¸ï¼Œæµ‹è¯•å›¢é˜Ÿæ— æ³•ç©·ä¸¾æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ã€‚å•å…ƒæµ‹è¯•æ˜¯ä»£ç å±‚é¢çš„æµ‹è¯•ï¼Œä¸€èˆ¬æ˜¯é’ˆå¯¹ç±»çš„æµ‹è¯•ã€‚æ—¢ç„¶æ— æ³•ä»ç³»ç»Ÿçš„æ•´ä½“ä¸Šä¿è¯100%ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œé‚£å•å…ƒæµ‹è¯•èµ·ç èƒ½ä¿è¯æˆ‘ä»¬ä»£ç åœ¨ç»†ç²’åº¦ä¸Šè¿è¡Œç¬¦åˆé¢„æœŸã€‚</p><p>æœ‰äº›å·¥ç¨‹å¸ˆè®¤ä¸ºå¼€å‘ä»»åŠ¡é‡æ²¡æ—¶é—´å†™ã€‚è¿™ä¸ªè¿˜æ˜¯æ²¡æœ‰è¶³å¤Ÿé‡è§†å•å…ƒæµ‹è¯•ï¼Œè§‰å¾—æ˜¯å¯æœ‰å¯æ— çš„éƒ¨åˆ†ï¼Œæ‰ä¼šæœ‰è¿™æ ·çš„æƒ³æ³•ã€‚å†™å¥½å•å…ƒæµ‹è¯•ï¼ŒèŠ‚çœå¾ˆå¤šè§£å†³çº¿ä¸Šbugçš„æ—¶é—´ï¼Œå¼€å‘æ—¶é—´åè€Œæ›´å……è¶³äº†ã€‚</p><p>è¿˜æœ‰å¾ˆå¤šå·¥ç¨‹å¸ˆè™½ç„¶åœ¨å†™å•å…ƒæµ‹è¯•ï¼Œä½†åªå¯¹æ­£å¸¸æµç¨‹åšæµ‹è¯•ã€‚ä»£ç ä¸­çš„bugå¤šæ•°æ˜¯å†™ä»£ç æ—¶å¼‚å¸¸æƒ…å†µæ²¡æœ‰è€ƒè™‘å…¨é¢å¯¼è‡´çš„ï¼Œæ­£å¸¸æµç¨‹ä¸€èˆ¬ä¸ä¼šå‡ºé—®é¢˜ã€‚å•å…ƒæµ‹è¯•çš„ä½œç”¨å°±åœ¨äºæµ‹è¯•å„ç§å¼‚å¸¸æƒ…å†µä¸‹ä»£ç çš„è¿è¡Œæ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œæ‰€ä»¥åªå¯¹æ­£å¸¸æµç¨‹æµ‹è¯•æ— æ³•å‘æŒ¥å•å…ƒæµ‹è¯•çœŸæ­£çš„ä½œç”¨</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå•å…ƒæµ‹è¯•ä»£ç é‡è¦æ¯”è¦æµ‹è¯•çš„ä»£ç å¤šï¼Œä¸€èˆ¬æ˜¯1-2å€çš„æ ·å­ï¼Œå†™å•å…ƒæµ‹è¯•æœ¬èº«æ²¡æœ‰å¤ªå¤šçš„æŠ€æœ¯æŒ‘æˆ˜ï¼Œä¸»è¦çœ‹å·¥ç¨‹å¸ˆé€»è¾‘æ˜¯å¦ç¼œå¯†ï¼Œèƒ½å¤Ÿè€ƒè™‘å„ç§å¼‚å¸¸æƒ…å†µï¼Œå†™èµ·æ¥æ¯”è¾ƒæ¯ç‡¥ï¼Œæ‰€ä»¥å†™é«˜è´¨é‡çš„å•å…ƒæµ‹è¯•çš„ä¸€æ–¹é¢è¦é å·¥ç¨‹å¸ˆçš„è€å¿ƒæ‰§è¡Œï¼Œå¦ä¸€æ–¹é¢è¦é å›¢é˜Ÿçš„ä¸¥æ ¼è¦æ±‚ã€‚å½“ç„¶è¿™äº›éƒ½æ˜¯å»ºç«‹åœ¨å¯¹å•å…ƒæµ‹è¯•é‡è¦æ€§çš„è®¤åŒä¹‹ä¸Šã€‚</p><h2 id="ä¸æµäºå½¢å¼çš„Code-Review"><a href="#ä¸æµäºå½¢å¼çš„Code-Review" class="headerlink" title="ä¸æµäºå½¢å¼çš„Code Review"></a>ä¸æµäºå½¢å¼çš„Code Review</h2><p>å¦‚æœè¯´å•å…ƒæµ‹è¯•å¾ˆå¤šå·¥ç¨‹å¸ˆä¸æ€ä¹ˆé‡è§†ï¼Œé‚£code reviewå°±æ˜¯ä¸æ€ä¹ˆæ¥å—ï¼è·Ÿå¾ˆå¤šå¤§å‹äº’è”ç½‘å…¬å¸çš„äººèŠè¿‡ï¼Œå¯¹code reviewéƒ½ä¸æ€ä¹ˆè®¤å¯ï¼Œå¤§éƒ¨åˆ†ååº”éƒ½æ˜¯ï¼Œè¿™ç©æ„ä¸å¯èƒ½å¾ˆå¥½çš„æ‰§è¡Œï¼Œæµªè´¹æ—¶é—´ï¼Œæ˜¯çš„ï¼Œcode reviewåšçš„å†æµç•…ï¼Œä¹Ÿæ˜¯è¦èŠ±æ—¶é—´çš„ï¼Œå…³é”®åœ¨äºæˆ‘ä»¬æ˜¯æ„¿æ„èŠ±2å¤©å†™ä»£ç èŠ±5å¤©ä¿®bug,è¿˜æ˜¯æ„¿æ„èŠ±ï¼“å¤©å†™ä»£ç èŠ±åŠå¤©ä¿®bug.</p><p>å…¶å®ï¼Œcode reviewçš„å¥½å¤„ä¸ä»…ä»…æ˜¯èƒ½å¤Ÿå¤§å¤§æé«˜ä»£ç è´¨é‡ï¼Œå‡å°‘ä»£ç bugï¼Œä½ æƒ³æƒ³å¦‚æœæˆ‘ä»¬æ²¡æœ‰code reviewï¼Œå¹³æ—¶å†™çš„ä»£ç â€œå·å·â€å°±commitäº†ï¼Œéš¾å…æœ‰äººä¸è‡ªå¾‹ï¼Œæœ‰äº†code reviewï¼Œç›´æ’­ä»£ç ï¼Œæ›å…‰dirty codeï¼Œå¤§å®¶å°±ä¼šæ›´è®¤çœŸäº›ï¼å…¶æ¬¡æ¥è®²ï¼Œcode reviewä¹Ÿæ˜¯ä¸€ç§æœ‰æ•ˆæŠ€æœ¯ä¼ å¸®å¸¦çš„é€”å¾„ï¼Œæ¯æ¬¡code reviewéƒ½æ˜¯ä¸€æ¬¡æ¡ˆä¾‹çš„å‰–æï¼Œå¯ä»¥å¸®åŠ©åˆçº§çš„å·¥ç¨‹å¸ˆåŸ¹å…»ç¼–ç è§„èŒƒï¼Œæé«˜ç¼–ç è´¨é‡ï¼Œè®¾è®¡èƒ½åŠ›ç”šè‡³äºæ¶æ„èƒ½åŠ›ï¼Œåè¿‡æ¥ï¼Œreviewåˆ«äººå†™çš„å¥½çš„ä»£ç ï¼Œå¯¹è‡ªå·±ä¹Ÿæ˜¯ä¸€ç§å­¦ä¹ å’Œæé«˜</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œä¸¥æ ¼çš„code reviewä¸ä»…èƒ½ä¿è¯ä»£ç çš„è´¨é‡ï¼Œè¿˜èƒ½å½¢æˆè‰¯å¥½çš„æŠ€æœ¯æ°›å›´ã€‚</p><h2 id="å¼€å‘æœªåŠ¨æ–‡æ¡£å…ˆè¡Œ"><a href="#å¼€å‘æœªåŠ¨æ–‡æ¡£å…ˆè¡Œ" class="headerlink" title="å¼€å‘æœªåŠ¨æ–‡æ¡£å…ˆè¡Œ"></a>å¼€å‘æœªåŠ¨æ–‡æ¡£å…ˆè¡Œ</h2><p>ç¼–å†™æŠ€æœ¯æ–‡æ¡£å¯¹å¤§éƒ¨åˆ†å·¥ç¨‹å¸ˆæ¥è¯´éƒ½æ˜¯æŒºåæ„Ÿçš„äº‹æƒ…ã€‚ä¸€èˆ¬æ¥è®²åœ¨å¼€å‘æŸä¸ªç³»ç»Ÿæˆ–è€…é‡è¦æ¨¡å—æˆ–è€…åŠŸèƒ½ä¹‹å‰éœ€è¦å…ˆå†™æŠ€æœ¯æ–‡æ¡£ï¼Œç„¶åå‘é€ç»™åŒç»„æˆ–è€…ç›¸å…³åŒäº‹å®¡æŸ¥ï¼Œåœ¨å®¡æŸ¥æ²¡æœ‰é—®é¢˜çš„æƒ…å†µä¸‹å†å¼€å‘ï¼Œè¿™æ ·èƒ½å¤Ÿäº‹å…ˆè¾¾æˆå…±è¯†ï¼Œå¼€å‘å‡ºæ¥çš„ä¸œè¥¿ä¸è‡³äºèµ°æ ·ï¼Œè€Œä¸”å½“å¼€å‘å®Œæˆä¹‹åè¿›è¡Œcode reviewçš„é˜¶æ®µï¼Œä»£ç å®¡æŸ¥è€…é€šè¿‡é˜…è¯»å¼€å‘æ–‡æ¡£ä¹Ÿå¯ä»¥å¿«é€Ÿçš„ç†è§£ä»£ç ï¼</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæ–‡æ¡£å¯¹äºå›¢é˜Ÿå’Œå…¬å¸æ¥è®²éƒ½æ˜¯é‡è¦çš„è´¢å¯Œï¼Œå¯¹äºæ–°äººåŠ å…¥å…¬å¸ç†Ÿæ‚‰ä»£ç ï¼Œäº§å“ï¼Œå¯¹äºä»»åŠ¡çš„äº¤æ¥ç­‰ç­‰éƒ½å¾ˆæœ‰å¸®åŠ©ï¼Œè€Œä¸”ä½œä¸ºä¸€ä¸ªè§„èŒƒåŒ–çš„æŠ€æœ¯å›¢é˜Ÿï¼ŒæŠ€æœ¯æ–‡æ¡£æ˜¯ä¸€ç§æ‘’å¼ƒä½œåŠå¼å¼€å‘å’Œä¸ªäººè‹±é›„ä¸»ä¹‰çš„æœ‰æ•ˆæ–¹æ³•ï¼Œæ˜¯ä¿è¯å›¢é˜Ÿæœ‰æ•ˆåä½œçš„é€”å¾„ï¼</p><p>ä¸è¿‡ï¼Œæœ‰å¾ˆå¤šå·¥ç¨‹å¸ˆæå‡ºè¯´ä¸ä¼šå†™æŠ€æœ¯æ–‡æ¡£ï¼Œä¸çŸ¥é“å†™ä»€ä¹ˆï¼Œå¸Œæœ›ç»™ä¸€ä¸ªæ¨¡æ¿æˆ–è€…ç›®å½•ï¼æˆ‘ä¹‹å‰æ›¾ç»æƒ³è¿‡æ˜¯å¦å¯ä»¥ç»™å‡ºä¸€ä¸ªå›ºå®šçš„æ¨¡æ¿ï¼Œä½†æœ€åè¿˜æ˜¯æ”¾å¼ƒäº†ï¼Œæ¯”è¾ƒéš¾ï¼Œéš¾ç‚¹åœ¨äºï¼Œæ¯ä¸ªé¡¹ç›®ä¾§é‡ç‚¹éƒ½ä¸ä¸€æ ·ä¸å®¹æ˜“æ€»ç»“ï¼Œå¦‚æœç¡¬è¦ç»™å‡ºä¸€ä¸ªå¾ˆå®½æ³›çš„ç›®å½•ï¼Œä¸å…·æœ‰æŒ‡å¯¼æ€§ä¹Ÿæ²¡æœ‰æ„ä¹‰ï¼å¤§ä½“ä¸Šæ¥è®²ï¼Œæ–‡æ¡£çš„å†…å®¹ä¸»è¦æ˜¯å°†åšçš„ä¸œè¥¿è®²æ¸…æ¥šï¼ŒåŒ…æ‹¬å‡ºé—®é¢˜èƒŒæ™¯ï¼Œè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œå¤–éƒ¨æ€ä¹ˆç”¨æˆ–è°ƒç”¨ï¼Œå†…éƒ¨å¦‚ä½•å®ç°ï¼Œå¤§çš„æ¶æ„ï¼Œå…³é”®åŠŸèƒ½å’Œç®—æ³•ç­‰ï¼Œä»¥åŠä¸€äº›éåŠŸèƒ½æ€§çš„è€ƒè™‘ã€‚</p><h2 id="æŒç»­é‡æ„ï¼Œé‡æ„ï¼Œé‡æ„"><a href="#æŒç»­é‡æ„ï¼Œé‡æ„ï¼Œé‡æ„" class="headerlink" title="æŒç»­é‡æ„ï¼Œé‡æ„ï¼Œé‡æ„"></a>æŒç»­é‡æ„ï¼Œé‡æ„ï¼Œé‡æ„</h2><p>ä¸ªäººæ¯”è¾ƒåå¯¹å¹³æ—¶ä¸æ³¨é‡ä»£ç è´¨é‡ï¼Œå †ç Œçƒ‚ä»£ç ï¼Œå®åœ¨ç»´æŠ¤ä¸äº†äº†å°±å¤§åˆ€é˜”æ–§çš„é‡æ„ç”šè‡³é‡å†™ã€‚æœ‰æ—¶å€™é¡¹ç›®ä»£ç å¤ªå¤šäº†ï¼Œé‡æ„å¾ˆéš¾åšåˆ°å½»åº•ï¼Œæœ€ååˆæå‡ºæ¥ä¸€ä¸ªå››ä¸åƒçš„æ€ªç‰©ï¼Œæ›´éº»çƒ¦äº†ï¼</p><p>ä¼˜ç§€çš„ä»£ç æˆ–æ¶æ„ä¸æ˜¯ä¸€å¼€å§‹å°±èƒ½å®Œå…¨è®¾è®¡å¥½çš„ï¼Œå°±åƒä¼˜ç§€çš„å…¬å¸æˆ–äº§å“ä¹Ÿéƒ½æ˜¯è¿­ä»£å‡ºæ¥çš„ä¸€æ ·çš„ï¼Œæˆ‘ä»¬æ— æ³•100%é‡è§æœªæ¥çš„éœ€æ±‚ï¼Œä¹Ÿæ²¡æœ‰è¶³å¤Ÿçš„ç²¾åŠ›ï¼Œæ—¶é—´ï¼Œèµ„æºä¸ºé¥è¿œçš„æœªæ¥ä¹°å•ï¼Œæ‰€ä»¥éšç€ç³»ç»Ÿçš„æ¼”è¿›ï¼Œé‡æ„ä»£ç ä¹Ÿæ˜¯ä¸å¯é¿å…çš„ï¼Œè™½ç„¶ä¸Šé¢è¯´äº†ä¸æ”¯æŒå¤§åˆ€é˜”æ–§æ¨åˆ°é‡æ¥å¼çš„å¤§é‡æ„ï¼Œä½†æŒç»­çš„å°é‡æ„è¿˜æ˜¯æ¯”è¾ƒæ¨å´‡çš„ï¼Œä¹Ÿæ˜¯æ—¶åˆ»ä¿è¯ä»£ç è´¨é‡é˜²æ­¢ä»£ç è…åŒ–æœ‰æ•ˆæ‰‹æ®µï¼ç®€å•ä¸€å¥è¯å°±æ˜¯ä¸è¦ç­‰åˆ°é—®é¢˜å †å¾—å¤ªå¤šäº†å†é‡‡å–é‡æ„ï¼Œè¦æ—¶åˆ»æœ‰äººå¯¹ä»£ç æ•´ä½“è´Ÿè´£ä»»ï¼Œå¹³æ—¶æ²¡äº‹å°±æ”¹æ”¹ä»£ç ï¼Œè€Œä¸è¦è§‰å¾—é‡æ„ä»£ç å°±æ˜¯æµªè´¹æ—¶é—´ï¼Œä¸åŠ¡æ­£ä¸šï¼</p><p>ç‰¹åˆ«æ˜¯ä¸€äº›ä¸šåŠ¡å¼€å‘å›¢é˜Ÿï¼Œæœ‰æ—¶å€™ä¸ºäº†å¿«é€Ÿå®Œæˆä¸€ä¸ªäº§å“æˆ–è€…ä¸šåŠ¡åŠŸèƒ½ï¼Œåªè¿½æ±‚é€Ÿåº¦ï¼Œåˆ°å¤„hard codeï¼Œåœ¨å®Œå…¨ä¸è€ƒè™‘éåŠŸèƒ½æ€§éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œå †ç Œä¸€äº›çƒ‚ä»£ç ï¼Œè¿™ç§æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒå¸¸è§çš„ã€‚ä¸è¿‡æ²¡å…³ç³»ï¼Œç­‰æœ‰æ—¶é—´ä¸€å®šè¦è®°ç€é‡æ„ï¼Œä¸ç„¶çƒ‚ä»£ç è¶Šå †è¶Šå¤šï¼Œæ€»æœ‰ä¸€å¤©ä¼šæ²¡äººèƒ½ç»´æŠ¤ã€‚</p><h2 id="é¡¹ç›®ä¸å›¢é˜Ÿâ€å¾®æœåŠ¡åŒ–â€"><a href="#é¡¹ç›®ä¸å›¢é˜Ÿâ€å¾®æœåŠ¡åŒ–â€" class="headerlink" title="é¡¹ç›®ä¸å›¢é˜Ÿâ€å¾®æœåŠ¡åŒ–â€"></a>é¡¹ç›®ä¸å›¢é˜Ÿâ€å¾®æœåŠ¡åŒ–â€</h2><p>åªæœ‰å°é¡¹ç›®æ˜¯å¯ä»¥ç»´æŠ¤çš„ï¼Œå¤§é¡¹ç›®æ˜¯æ— æ³•ç»´æŠ¤çš„ï¼å›¢é˜Ÿäººæ¯”è¾ƒå°‘çš„æ—¶å€™ï¼Œåå‡ ä¸ªäººçš„æ ·å­ï¼Œä»£ç é‡ä¹Ÿä¸å¤šï¼Œä¸è¶…è¿‡10ä¸‡è¡Œï¼Œæ€ä¹ˆå¼€å‘ï¼Œæ€ä¹ˆç®¡ç†éƒ½æ²¡é—®é¢˜ï¼Œå¤§å®¶äº’ç›¸éƒ½äº†è§£å½¼æ­¤åšçš„ä¸œè¥¿ï¼Œä»£ç è´¨é‡å¤ªå·®äº†ï¼Œå¤§ä¸äº†é‡å†™ä¸€éï¼ä½†å¦‚æœæ˜¯ä¸€ä¸ªæå…¶åºå¤§çš„é¡¹ç›®ï¼Œå‡ åä¸‡è¡Œä»£ç ï¼Œå‡ åä¸ªå¼€å‘ç»´æŠ¤ï¼Œé‚£åŸºæœ¬ä¸Šæ²¡äººèƒ½å¯¹ä»£ç è´Ÿè´£äº†ï¼</p><p>æ‰€ä»¥å½“é¡¹ç›®å¤ªå¤§äº†ä¹‹åï¼Œå°±éœ€è¦å¯¹ä»£ç å’Œå›¢é˜Ÿè¿›è¡Œæ‹†åˆ†ï¼Œæ¨¡å—åŒ–ï¼Œå¤§å›¢é˜Ÿæ‹†æˆå‡ ä¸ªå°å›¢é˜Ÿï¼Œå¤§é¡¹ç›®æ‹†æˆå‡ ä¸ªå°é¡¹ç›®ï¼Œè¿™æ ·æ¯ä¸ªå›¢é˜Ÿæ¯ä¸ªé¡¹ç›®çš„ä»£ç éƒ½ä¸è‡³äºå¾ˆå¤šï¼Œä¹Ÿä¸è‡³äºå‡ºç°ä»£ç è´¨é‡å¤ªå·®æ— æ³•ç»´æŠ¤çš„æƒ…å†µï¼Œå…¶å®å¾ˆå¤šæŠ€æœ¯ä¹Ÿéƒ½ä½“ç°äº†è¿™ç§æ€æƒ³ï¼Œæ¯”å¦‚å¤§åˆ°soa, å¾®æœåŠ¡ï¼Œå°åˆ°jar, .soç­‰libæ¨¡å—å¼€å‘ï¼ŒClassç±»çš„å°è£…ï¼Œéƒ½æ˜¯ä¸€ç§æ‹†åˆ†çš„æ€æƒ³ï¼</p><h2 id="é‡è§†ä»£ç å…³æ³¨ç»†èŠ‚"><a href="#é‡è§†ä»£ç å…³æ³¨ç»†èŠ‚" class="headerlink" title="é‡è§†ä»£ç å…³æ³¨ç»†èŠ‚"></a>é‡è§†ä»£ç å…³æ³¨ç»†èŠ‚</h2><p>ä»¥ä¸Šå…¶ä»–çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯æ²»æ ‡ä¸æ²»æœ¬ï¼Œæ‰¾åˆ°å¯¹çš„äººç”¨å¥½å¯¹çš„äººï¼Œæ‰“é€ ä¼˜ç§€çš„æŠ€æœ¯æ–‡åŒ–ï¼Œæ‰æ˜¯èƒ½ä¸€ç›´å“è¶Šçš„æ ¹æœ¬ã€‚æœ‰å¾ˆå¤šå·¥ç¨‹å¸ˆæ¯”è¾ƒçƒ­è¡·äºå­¦ä¹ æ¶æ„ï¼Œå·¥å…·ï¼Œæ¡†æ¶å±‚é¢çš„ä¸œè¥¿ï¼Œè§è¿‡å¾ˆå¤šå·¥ç¨‹å¸ˆï¼Œè¿˜æ²¡å†™ä¸‰äº”å¹´ä»£ç å°±è½¬åšæ¶æ„å¸ˆï¼Œä¸å†™ä»£ç äº†ï¼Œåˆ°å¤„å¿½æ‚ ï¼Œå¾ˆä¸å¥½ï¼Œäº’è”ç½‘ä¿¡æ¯å¦‚æ­¤é€æ˜ï¼Œä¸åŒçš„äººå»åšåŒä¸€ä¸ªé¡¹ç›®ï¼Œå…¶å®æœ€åè®¾è®¡å‡ºæ¥çš„æ¶æ„,åŠŸèƒ½å¤§çº¦éƒ½å·®ä¸å¤šï¼Œæœ€åå¤§å®¶éƒ½èƒ½æŠŠè¿™ä¸ªç³»ç»Ÿå®ç°ï¼Œä½†æœ‰äº›äººåšå‡ºæ¥çš„ç³»ç»Ÿï¼Œbugå¾ˆå¤šï¼Œæ€§èƒ½å¾ˆå·®ï¼Œæ‰©å±•æ€§ä¹Ÿä¸å¥½ï¼Œæœ€å¤šèƒ½å«ä¸ªPOCã€‚</p><p>é«˜æ‰‹ä¹‹é—´çš„ç«äº‰è¿˜æ˜¯åœ¨äºç»†èŠ‚ï¼Œä¸€ä¸ªç®—æ³•å¤Ÿä¸å¤Ÿä¼˜åŒ–ï¼Œæ•°æ®å­˜å–çš„æ•ˆç‡é«˜ä¸é«˜ï¼Œå†…å­˜æ˜¯å¦å¤ŸèŠ‚çœç­‰ç­‰ï¼Œè¿™æ˜¯ç´¯ç§¯èµ·æ¥å†³å®šäº†ä¸€ä¸ªç³»ç»Ÿæ˜¯ä¸æ˜¯å¤Ÿä¼˜ç§€ã€‚</p><p><strong>å›½å†…å·¥ç¨‹å¸ˆæ™®éæ·±åº¦ä¸å¤Ÿï¼Œåšå‡ å¹´æŠ€æœ¯å°±è½¬ç®¡ç†æˆ–è€…çº¯æ¶æ„è®¾è®¡ä¸å†™ä»£ç äº†ï¼Œè€Œå›½å¤–ä¸ä¸€æ ·ï¼Œå¤§é¾„ç å†œå¾ˆå¤šï¼Œæ‰€ä»¥å›½å¤–çš„ä¼˜ç§€å¼€æºé¡¹ç›®æ¯”è¾ƒå¤šï¼Œè€Œå›½å†…å¾ˆå°‘</strong></p><h2 id="å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨"><a href="#å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨" class="headerlink" title="å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨"></a>å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨</h2><p>ä»£ç ä¸­çš„å¾ˆå¤šä½çº§è´¨é‡é—®é¢˜ä¸éœ€è¦äººå·¥å»å®¡æŸ¥ï¼Œjavaå¼€å‘æœ‰å¾ˆå¤šç°æˆçš„å·¥å…·å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼šcheckstyleï¼Œfindbugs, pmd, jacaco, sonarç­‰ã€‚</p><p>Checkstyle,findbugs,pmdæ˜¯é™æ€ä»£ç åˆ†æå·¥å…·ï¼Œé€šè¿‡åˆ†ææºä»£ç æˆ–è€…å­—èŠ‚ç ï¼Œæ‰¾å‡ºä»£ç çš„ç¼ºé™·ï¼Œæ¯”å¦‚å‚æ•°ä¸åŒ¹é…ï¼Œæœ‰æ­§ä¹‰çš„åµŒå¥—è¯­å¥ï¼Œé”™è¯¯çš„é€’å½’ï¼Œéæ³•è®¡ç®—ï¼Œå¯èƒ½å‡ºç°çš„ç©ºæŒ‡é’ˆå¼•ç”¨ç­‰ç­‰ã€‚ä¸‰è€…éƒ½å¯ä»¥é›†æˆåˆ°gradleç­‰æ„å»ºå·¥å…·ä¸­ã€‚</p><p>Jacocoæ˜¯ä¸€ç§å•å…ƒæµ‹è¯•è¦†ç›–ç‡ç»Ÿè®¡å·¥å…·ï¼Œä¹Ÿå¯ä»¥é›†æˆåˆ°gradleç­‰æ„å»ºå·¥å…·ä¸­ï¼Œå¯ä»¥ç”Ÿæˆæ¼‚äº®çš„æµ‹è¯•è¦†ç›–ç‡ç»Ÿè®¡æŠ¥è¡¨ï¼ŒåŒæ—¶Eclipseæä¾›äº†æ’ä»¶å¯ä»¥EclEmmaå¯ä»¥ç›´è§‚çš„åœ¨IDEä¸­æŸ¥çœ‹å•å…ƒæµ‹è¯•çš„è¦†ç›–æƒ…å†µã€‚</p><p>Sonar Sonar æ˜¯ä¸€ä¸ªç”¨äºä»£ç è´¨é‡ç®¡ç†çš„å¹³å°ã€‚å¯ä»¥åœ¨ä¸€ä¸ªç»Ÿä¸€çš„å¹³å°ä¸Šæ˜¾ç¤ºç®¡ç†é™æ€åˆ†æï¼Œå•å…ƒæµ‹è¯•è¦†ç›–ç‡ç­‰è´¨é‡æŠ¥å‘Šã€‚</p><h2 id="æœ€åï¼Œæ€»ç»“"><a href="#æœ€åï¼Œæ€»ç»“" class="headerlink" title="æœ€åï¼Œæ€»ç»“"></a>æœ€åï¼Œæ€»ç»“</h2><p>ä»¥ä¸Šæ‰€æœ‰çš„è¿™äº›æ–¹æ³•è®ºåº”è¯¥éƒ½æ²¡å•¥æ–°å¥‡çš„ï¼Œä¹Ÿæ²¡æœ‰è‘µèŠ±å®å…¸ä¼¼çš„æ€æ‰‹é”ï¼Œè¯´å‡ºæ¥æ„Ÿè§‰éƒ½å¾ˆç®€å•çš„ï¼Œç°åœ¨äº’è”ç½‘è¿™ä¹ˆå‘è¾¾ï¼Œä¿¡æ¯éƒ½å¾ˆé€æ˜ï¼Œæ‰€ä»¥å¤§æ–¹å‘å¤§å®¶éƒ½çŸ¥é“ï¼Œå…·ä½“çš„ç­–ç•¥å’Œæ¶æ„å„å®¶ä¹Ÿéƒ½å·®ä¸å¤šï¼Œæœ€åè°åšçš„å¥½ï¼Œ<strong>å…³é”®åœ¨äºæ‰§è¡Œå’Œç»†èŠ‚</strong>ï¼Œç»å¸¸å¬åˆ°æœ‰äººè¯´æˆ‘ä»¬åšäº†å•å…ƒæµ‹è¯•å•Šï¼Œæˆ‘ä»¬åšäº†æ€§èƒ½æµ‹è¯•ï¼Œå¯æœ€åè¿˜æ˜¯ä¸€å †æ€§èƒ½é—®é¢˜ä¸€å †bugï¼Œé‚£å°±è¦å»è€ƒè™‘ä¸€ä¸‹åˆ°åº•åšçš„å¤Ÿä¸å¤Ÿå¥½ï¼Œæ˜¯å¦åšåˆ°äº†å…·ä½“é—®é¢˜å…·ä½“åˆ†æï¼Œä¸ç”Ÿæ¬ç¡¬å¥—ï¼Œä»å†³ç­–åˆ°æ‰§è¡Œå†åˆ°è€ƒæ ¸æ˜¯å¦å½¢æˆäº†é—­ç¯ï¼Œå¾ˆå¤šæ—¶å€™åªæ˜¯ç©ºå–Šå£å·ï¼Œå£å·å–Šå¾—100åˆ†ï¼Œè½å®åˆ°æ‰§è¡Œåªèƒ½å¾—ï¼•0åˆ†ï¼Œæœ€ååˆå®Œå…¨æ²¡è€ƒæ ¸ï¼Œå¥½åå¤§å®¶ä¹Ÿéƒ½ä¸çŸ¥ï¼Œåˆ‡è®°æ•äºè¨€è€Œè®·äºè¡Œ</p>]]></content>
      
      
      <categories>
          
          <category> æ‚æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6 Classä¸­çš„constructoræ–¹æ³•å’Œsuperçš„ä½œç”¨</title>
      <link href="/2019/03/12/Js/ES6-Class%E4%B8%AD%E7%9A%84constructor%E6%96%B9%E6%B3%95%E5%92%8Csuper%E7%9A%84%E4%BD%9C%E7%94%A8/"/>
      <url>/2019/03/12/Js/ES6-Class%E4%B8%AD%E7%9A%84constructor%E6%96%B9%E6%B3%95%E5%92%8Csuper%E7%9A%84%E4%BD%9C%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é¦–å…ˆï¼ŒES6 çš„ class å±äºä¸€ç§â€œè¯­æ³•ç³–â€ï¼Œæ‰€ä»¥åªæ˜¯å†™æ³•æ›´åŠ ä¼˜é›…ï¼Œæ›´åŠ åƒé¢å¯¹å¯¹è±¡çš„ç¼–ç¨‹ï¼Œå…¶æ€æƒ³å’Œ ES5 æ˜¯ä¸€è‡´çš„ã€‚</p><h2 id="construcot"><a href="#construcot" class="headerlink" title="construcot"></a>construcot</h2><pre><code class="js">function Point(x, y) {  this.x = x;  this.y = y;}Point.prototype.toString = function() {  return &#39;(&#39; + this.x + &#39;,&#39; + this.y + &#39;)&#39;;}</code></pre><p>ç­‰åŒäº</p><pre><code class="js">class Point {  constructor(x, y) {    this.x = x;    this.y = y;  }  toString() {    return &#39;(&#39; + this.x + &#39;,&#39; + this.y + &#39;)&#39;;  }}</code></pre><p>å…¶ä¸­ <code>constructor</code> æ–¹æ³•æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªé»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡ new å‘½ä»¤åˆ›å»ºå¯¹è±¡å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚ä¸€ä¸ªç±»å¿…é¡»æœ‰ <code>constructor</code> æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä¸€ä¸ªé»˜è®¤çš„ constructor æ–¹æ³•ä¼šè¢«é»˜è®¤æ·»åŠ ã€‚æ‰€ä»¥å³ä½¿ä½ æ²¡æœ‰æ·»åŠ æ„é€ å‡½æ•°ï¼Œä¹Ÿæ˜¯ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°çš„ã€‚ä¸€èˆ¬ <code>constructor</code> æ–¹æ³•è¿”å›å®ä¾‹å¯¹è±¡ this ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æŒ‡å®š  <code>constructor</code> æ–¹æ³•è¿”å›ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼Œè®©è¿”å›çš„å®ä¾‹å¯¹è±¡ä¸æ˜¯è¯¥ç±»çš„å®ä¾‹ã€‚</p><h2 id="super"><a href="#super" class="headerlink" title="super"></a>super</h2><p>ä¸‹é¢å¥½å¥½åˆ†æä¸€ä¸‹ <code>super</code> å…³é”®å­—çš„ä½œç”¨ï¼š</p><blockquote><p><code>super</code> è¿™ä¸ªå…³é”®å­—ï¼Œæ—¢å¯ä»¥å½“åšå‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“åšå¯¹è±¡ä½¿ç”¨ã€‚è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå®ƒçš„ç”¨æ³•å®Œå…¨ä¸ç”¨ã€‚</p></blockquote><p><strong>1.å½“å‡½æ•°ä½¿ç”¨</strong></p><pre><code class="js">class A {}class B extends A {  constructor() {    super();  // ES6 è¦æ±‚ï¼Œå­ç±»çš„æ„é€ å‡½æ•°å¿…é¡»æ‰§è¡Œä¸€æ¬¡ super å‡½æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚  }}</code></pre><ul><li>æ³¨ï¼šåœ¨ <code>constructor</code> ä¸­å¿…é¡»è°ƒç”¨ <code>super</code> æ–¹æ³•ï¼Œå› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„ this å¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„ this å¯¹è±¡ï¼Œç„¶åå¯¹å…¶è¿›è¡ŒåŠ å·¥,è€Œ <code>super</code> å°±ä»£è¡¨äº†çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚<code>super</code> è™½ç„¶ä»£è¡¨äº†çˆ¶ç±» A çš„æ„é€ å‡½æ•°ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯å­ç±» B çš„å®ä¾‹ï¼Œå³ <code>super</code> å†…éƒ¨çš„ this æŒ‡çš„æ˜¯ Bï¼Œå› æ­¤ super() åœ¨è¿™é‡Œç›¸å½“äº <code>`A.prototype.constructor.call(this, props)</code>ã€‚</li></ul><pre><code class="js">class A {  constructor() {    console.log(new.target.name); // new.target æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°  }}class B extends A {  constructor() {    super();  }}new A(); // Anew B(); // B</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ super() æ‰§è¡Œæ—¶ï¼Œå®ƒæŒ‡å‘çš„æ˜¯ å­ç±» B çš„æ„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯çˆ¶ç±» A çš„æ„é€ å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œsuper() å†…éƒ¨çš„ this æŒ‡å‘çš„æ˜¯ Bã€‚</p><a id="more"></a><p><strong>2.å½“å¯¹è±¡ä½¿ç”¨</strong></p><p>åœ¨æ™®é€šæ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼›åœ¨é™æ€æ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»ã€‚</p><pre><code class="js">class A {  c() {    return 2;  }}class B extends A {  constructor() {    super();    console.log(super.c()); // 2  }}let b = new B();</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±» B å½“ä¸­çš„ super.c()ï¼Œå°±æ˜¯å°† super å½“ä½œä¸€ä¸ªå¯¹è±¡ä½¿ç”¨ã€‚è¿™æ—¶ï¼Œsuper åœ¨æ™®é€šæ–¹æ³•ä¹‹ä¸­ï¼ŒæŒ‡å‘ A.prototypeï¼Œæ‰€ä»¥ super.c() å°±ç›¸å½“äº A.prototype.c()ã€‚</p><ul><li>é€šè¿‡ super è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œsuper ä¼šç»‘å®šå­ç±»çš„ thisã€‚</li></ul><pre><code class="js">class A {  constructor() {    this.x = 1;  }  s() {    console.log(this.x);  }}class B extends A {  constructor() {    super();    this.x = 2;  }  m() {    super.s();  }}let b = new B();b.m(); // 2</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œsuper.s() è™½ç„¶è°ƒç”¨çš„æ˜¯ A.prototytpe.s()ï¼Œä½†æ˜¯ A.prototytpe.s()ä¼šç»‘å®šå­ç±» B çš„ thisï¼Œå¯¼è‡´è¾“å‡ºçš„æ˜¯ 2ï¼Œè€Œä¸æ˜¯ 1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯ super.s.call(this)ã€‚<br>ç”±äºç»‘å®šå­ç±»çš„ thisï¼Œæ‰€ä»¥å¦‚æœé€šè¿‡ super å¯¹æŸä¸ªå±æ€§èµ‹å€¼ï¼Œè¿™æ—¶ super å°±æ˜¯ thisï¼Œèµ‹å€¼çš„å±æ€§ä¼šå˜æˆå­ç±»å®ä¾‹çš„å±æ€§ã€‚</p><p>ç”±äºç»‘å®šå­ç±»çš„ thisï¼Œæ‰€ä»¥å¦‚æœé€šè¿‡ super å¯¹æŸä¸ªå±æ€§èµ‹å€¼ï¼Œè¿™æ—¶ super å°±æ˜¯ thisï¼Œèµ‹å€¼çš„å±æ€§ä¼šå˜æˆå­ç±»å®ä¾‹çš„å±æ€§ã€‚</p><pre><code class="js">class A {  constructor() {    this.x = 1;  }}class B extends A {  constructor() {    super();    this.x = 2;    super.x = 3;    console.log(super.x); // undefined    console.log(this.x); // 3  }}let b = new B();</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œsuper.x èµ‹å€¼ä¸º 3ï¼Œè¿™æ—¶ç­‰åŒäºå¯¹ this.x èµ‹å€¼ä¸º 3ã€‚è€Œå½“è¯»å– super.x çš„æ—¶å€™ï¼Œè°ƒç”¨çš„æ˜¯ A.prototype.xï¼Œä½†å¹¶æ²¡æœ‰ x æ–¹æ³•ï¼Œæ‰€ä»¥è¿”å› undefinedã€‚<br>æ³¨æ„ï¼Œä½¿ç”¨ super çš„æ—¶å€™ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®šæ˜¯ä½œä¸ºå‡½æ•°ï¼Œè¿˜æ˜¯ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p><pre><code class="js">class A {}class B extends A {  constructor() {    super();    console.log(super); // æŠ¥é”™  }}</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œconsole.log(super); çš„å½“ä¸­çš„ superï¼Œæ— æ³•çœ‹å‡ºæ˜¯ä½œä¸ºå‡½æ•°ä½¿ç”¨ï¼Œè¿˜æ˜¯ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œæ‰€ä»¥ JavaScript å¼•æ“è§£æä»£ç çš„æ—¶å€™å°±ä¼šæŠ¥é”™ã€‚è¿™æ˜¯ï¼Œå¦‚æœèƒ½æ¸…æ™°çš„è¡¨æ˜ super çš„æ•°æ®ç±»å‹ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚</p><p>æœ€åï¼Œç”±äºå¯¹è±¡æ€»æ˜¯ç»§æ‰¿å…¶ä»–å¯¹è±¡çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä»»æ„ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½¿ç”¨ super å…³é”®å­—ã€‚</p><h2 id="ç»“è¯­ï¼š"><a href="#ç»“è¯­ï¼š" class="headerlink" title="ç»“è¯­ï¼š"></a>ç»“è¯­ï¼š</h2><p>ES6 çš„ class æ¯•ç«Ÿæ˜¯ä¸€ä¸ªâ€œè¯­æ³•ç³–â€ï¼Œæ‰€ä»¥åªè¦ç†è§£äº† JavaScript ä¸­å¯¹è±¡çš„æ¦‚å¿µå’Œé¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œclass å°±ä¸éš¾ç†è§£å•¦</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>30 Seconds of ES6 ï¼ˆä¸€ï¼‰</title>
      <link href="/2019/01/27/Js/30-Seconds-of-ES6-%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>/2019/01/27/Js/30-Seconds-of-ES6-%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="é¡¹ç›®èƒŒæ™¯ç®€ä»‹"><a href="#é¡¹ç›®èƒŒæ™¯ç®€ä»‹" class="headerlink" title="é¡¹ç›®èƒŒæ™¯ç®€ä»‹"></a>é¡¹ç›®èƒŒæ™¯ç®€ä»‹</h1><p><a href="https://github.com/30-seconds/30-seconds-of-code" target="_blank" rel="noopener">30 seconds of code</a>  æ˜¯ä¸€ä¸ªéå¸¸ä¼˜è´¨ç²¾é€‰çš„ JavaScript é¡¹ç›® ï¼Œæ€»ç»“äº†å¤§é‡çš„ä½¿ç”¨ ES6  è¯­æ³•å®ç°çš„ä»£ç å—ï¼Œé¡¹ç›®çš„è®¾è®¡ç›®æ ‡å°±æ˜¯æ›´ç®€æ´ï¼Œæ›´é«˜æ•ˆï¼Œæ›´å¿«é€Ÿçš„å®ç°åŸºç¡€ä»£ç æ¨¡å—ï¼Œç¢ç‰‡åŒ–å­¦ä¹ å®ç”¨å¹²è´§ï¼Œ 30 ç§’æŒæ¡ä¸€ä¸ªé«˜è´¨é‡ ES6 ä»£ç å— ã€‚</p><h2 id="å­¦ä¹ åˆè¡·"><a href="#å­¦ä¹ åˆè¡·" class="headerlink" title="å­¦ä¹ åˆè¡·"></a>å­¦ä¹ åˆè¡·</h2><p>å­¦ä¹  ES6 åŸºç¡€çŸ¥è¯†ï¼Œæå‡ç¨‹åºç®—æ³•èƒ½åŠ›ï¼›å­¦ä¹  JavaScript åŸºç¡€ä» API å¼€å§‹ã€‚<br>æ¯ç¯‡ç²¾é€‰ 5 æ®µä¼˜ç§€ä»£ç å—ï¼Œå’Œ 5 ä¸ªä»¥ä¸Š API ï¼Œä¸ºå‰ç«¯å¤§å…¨æ ˆæ‰“ä¸‹åšå®æ ¹åŸºï¼</p><h2 id="å­¦ä¹ æ–¹æ³•"><a href="#å­¦ä¹ æ–¹æ³•" class="headerlink" title="å­¦ä¹ æ–¹æ³•"></a>å­¦ä¹ æ–¹æ³•</h2><p>è®¤çœŸè§£è¯»è‹±æ–‡ç‰ˆ 30 seconds of code çš„æ¯ä¸ª ES6 ä»£ç å—ï¼Œå¹¶æŠŠå…¶ä¸­çš„ API é‡ç‚¹åˆ†æã€‚<br>è®¤è¯†æ–°å•è¯ï¼Œæå‡è‹±è¯­æ°´å¹³ï¼Œç›®æ ‡å¯ä»¥è½»æ¾ç¿»é˜…è‹±æ–‡ç‰ˆä¸“ä¸šä¹¦ï¼Œå…¨é¢æå‡å‰ç«¯æŠ€æœ¯è½¯å®åŠ›ã€‚</p><h3 id="Adapter-é€‚é…å™¨-ary"><a href="#Adapter-é€‚é…å™¨-ary" class="headerlink" title="Adapter é€‚é…å™¨ ary"></a>Adapter é€‚é…å™¨ ary</h3><p>åˆ›å»ºä¸€ä¸ªæ¥å—æœ€å¤š n ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¿½ç•¥ä»»ä½•å…¶ä»–å‚æ•°ã€‚ä½¿ç”¨ <code>Array.prototype.sliceï¼ˆ0ï¼Œnï¼‰</code> æ–¹æ³•å’Œ spread æ‰©å±•è¿ç®—ç¬¦ ï¼ˆâ€¦ï¼‰ è°ƒç”¨æä¾›çš„å‡½æ•° fn ï¼ˆæœ€å¤š n ä¸ªå‚æ•°ï¼‰ã€‚</p><pre><code class="js">const ary = (fn , n) =&gt; (...args) =&gt; fn(...args.slice(0, n));const firstTwoMax = ary(Math.max, 2);console.log([[2, 6, &#39;a&#39;], [8, 4, 6], [10]].map(x =&gt; firstTwoMax(...x)));//[6, 8, 10]</code></pre><h3 id="MDN-è§£æ-Array-prototype-slice-æ¡ˆä¾‹"><a href="#MDN-è§£æ-Array-prototype-slice-æ¡ˆä¾‹" class="headerlink" title="MDN è§£æ Array.prototype.slice() æ¡ˆä¾‹"></a>MDN è§£æ Array.prototype.slice() æ¡ˆä¾‹</h3><p>è¯¥ slice() æ–¹æ³•è¿”å›ä¸€ä¸ªé˜µåˆ—çš„ä¸€éƒ¨åˆ†çš„ä¸€ä¸ªæµ…æ‹·è´ï¼Œåˆ°é€‰è‡ªæ–°çš„æ•°ç»„å¯¹è±¡ begin åˆ° end ( end ä¸åŒ…æ‹¬)ã€‚åŸå§‹æ•°ç»„ä¸ä¼šè¢«ä¿®æ”¹ã€‚</p><pre><code class="js">var animals = [&#39;ant&#39;, &#39;bison&#39;, &#39;camel&#39;, &#39;duck&#39;, &#39;elephant&#39;];console.log(animals.slice(2,4));//[&#39;camel&#39;, &#39;duck&#39;]console.log(animals);// [&quot;ant&quot;, &quot;bison&quot;, &quot;camel&quot;, &quot;duck&quot;, &quot;elephant&quot;]</code></pre><h3 id="MDN-è§£æ-Math-max-æ¡ˆä¾‹"><a href="#MDN-è§£æ-Math-max-æ¡ˆä¾‹" class="headerlink" title="MDN è§£æ Math.max() æ¡ˆä¾‹"></a>MDN è§£æ Math.max() æ¡ˆä¾‹</h3><p>è¯¥ Math.max() å‡½æ•°è¿”å›é›¶ä¸ªæˆ–å¤šä¸ªæ•°å­—ä¸­çš„æœ€å¤§å€¼ã€‚</p><p>console.log(Math.max(-10, 20)); //20</p><h3 id="Array-æ•°ç»„-all"><a href="#Array-æ•°ç»„-all" class="headerlink" title="Array   æ•°ç»„   all"></a>Array   æ•°ç»„   all</h3><p>å¦‚æœæä¾›çš„è°“è¯å‡½æ•°å¯¹é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½è¿”å›  true ï¼Œåˆ™è¿”å›  trueï¼Œå¦åˆ™è¿”å› false ã€‚ä½¿ç”¨   Array.prototype.everyï¼ˆï¼‰ æµ‹è¯•é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦åŸºäº  fn  è¿”å›  true  ã€‚çœç•¥ç¬¬äºŒä¸ªå‚æ•°  fn  ï¼Œå°†å¸ƒå°”å€¼ç”¨ä½œé»˜è®¤å€¼ã€‚</p><pre><code class="js">const all = (arr, fn = Boolean) =&gt; arr.every(fn);console.log(all);console.log(all([4, 2, 3], x =&gt; x &gt;1));//trueconsole.log(all([1, 2, 3]));//true</code></pre><h3 id="MDN-è§£æ-Array-prototype-every-æ¡ˆä¾‹"><a href="#MDN-è§£æ-Array-prototype-every-æ¡ˆä¾‹" class="headerlink" title="MDN  è§£æ Array.prototype.every()  æ¡ˆä¾‹"></a>MDN  è§£æ Array.prototype.every()  æ¡ˆä¾‹</h3><p>è¯¥  every()  æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½é€šè¿‡äº†ç”±æä¾›çš„å‡½æ•°å®ç°çš„æµ‹è¯•ã€‚å¯¹äºç©ºæ•°ç»„ï¼Œä»»ä½•æƒ…å†µä¸‹è°ƒç”¨è¯¥æ–¹æ³•éƒ½ä¼šè¿”å› trueã€‚</p><pre><code class="js">console.log([12, 5, 8, 130, 44].every(x =&gt; x &gt;= 10));//falseconsole.log([12, 54, 18, 130, 44].every(x =&gt; x &gt;=10));//trueconsole.log([].every(x =&gt; x));//true</code></pre><h3 id="Array-æ•°ç»„-allEqual"><a href="#Array-æ•°ç»„-allEqual" class="headerlink" title="Array   æ•°ç»„   allEqual"></a>Array   æ•°ç»„   allEqual</h3><p>æ£€æŸ¥æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦ç›¸ç­‰ã€‚ä½¿ç”¨  Array.prototype.everyï¼ˆï¼‰ æ£€æŸ¥æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦ä¸ç¬¬ä¸€ä¸ªå…ƒç´ ç›¸åŒã€‚</p><pre><code class="js">const allEqual = arr =&gt; arr.every( val =&gt; val === arr[0]);console.log(allEqual([1, 2, 3, 4, 5, 6]));//falseconsole.log(allEqual([1, 1, 1, 1]));//true</code></pre><h3 id="Array-æ•°ç»„-any"><a href="#Array-æ•°ç»„-any" class="headerlink" title="Array   æ•°ç»„   any"></a>Array   æ•°ç»„   any</h3><p>å¦‚æœæä¾›çš„è°“è¯å‡½æ•°å¯¹é›†åˆä¸­çš„è‡³å°‘ä¸€ä¸ªå…ƒç´ è¿”å›  true  ï¼Œåˆ™è¿”å›  true   ï¼Œå¦åˆ™è¿”å›  false   ã€‚ä½¿ç”¨ Array.prototype.someï¼ˆï¼‰ æµ‹è¯•é›†åˆä¸­çš„ä»»ä½•å…ƒç´ æ˜¯å¦åŸºäº  fn  è¿”å›  true ã€‚çœç•¥ç¬¬äºŒä¸ªå‚æ•°  fn ï¼Œå°†å¸ƒå°”å€¼ç”¨ä½œé»˜è®¤å€¼ã€‚</p><pre><code class="js">const any = (arr, fn = Boolean) =&gt; arr.some(fn);+console.log(any([0, 1, 2, 0], x =&gt; x &gt;=2));//trueconsole.log(any([0, 0, 1, 0]));//true</code></pre><h3 id="MDN-è§£æ-Array-prototype-some-æ¡ˆä¾‹"><a href="#MDN-è§£æ-Array-prototype-some-æ¡ˆä¾‹" class="headerlink" title="MDN  è§£æ Array.prototype.some()  æ¡ˆä¾‹"></a>MDN  è§£æ Array.prototype.some()  æ¡ˆä¾‹</h3><p>è¯¥   some ()   æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ é€šè¿‡äº†ç”±æä¾›çš„å‡½æ•°å®ç°çš„æµ‹è¯•ã€‚æ­¤æ–¹æ³•è¿”å›   false   æ”¾åœ¨ç©ºæ•°ç»„ä¸Šçš„ä»»ä½•æ¡ä»¶ã€‚</p><pre><code class="js">console.log([2, 5, 8, 1, 4].some(x =&gt; x &gt; 10));//falseconsole.log([12, 5, 8 ,1 , 4].some( x =&gt; x &gt;10));//true</code></pre><h3 id="Array-æ•°ç»„-arrayToCSV"><a href="#Array-æ•°ç»„-arrayToCSV" class="headerlink" title="Array   æ•°ç»„   arrayToCSV"></a>Array   æ•°ç»„   arrayToCSV</h3><p>å°†äºŒç»´æ•°ç»„è½¬æ¢ä¸ºé€—å·åˆ†éš”å€¼ï¼ˆ  csv  ï¼‰å­—ç¬¦ä¸²ã€‚ä½¿ç”¨ Array.prototype.map () å’Œ  Array.prototype.joinï¼ˆdelimiterï¼‰  å°†ä¸€ç»´æ•°ç»„ç»„åˆæˆå­—ç¬¦ä¸²ã€‚ä½¿ç”¨   Array.prototype.joinï¼ˆâ€™\nâ€™ï¼‰ ï¼ˆ  ï¼Œæ¢è¡Œç¬¦å·ï¼‰ä¸¤ä¸ªç»„åˆçš„å…¨è¡Œåˆ°  CSV  æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæ¯æ’åˆ†æ¡å’Œä¸€ä¸ªæ¢è¡Œç¬¦ã€‚åœ¨ç¬¬äºŒ  omit  å‚æ•°delimiter ï¼Œä½¿ç”¨  delimiterï¼ˆé»˜è®¤ï¼‰ã€‚</p><pre><code class="js">const arrayToCSV = (arr, delimiter = &#39;,&#39;) =&gt; arr.map( v =&gt; v.map( x =&gt; `&quot;${x}&quot;`).join(delimiter)).join(&#39;\n&#39;);console.log(arrayToCSV([[&#39;a&#39;, &#39;b&#39;], [&#39;c&#39;, &#39;d&#39;]]));//&quot;a&quot;,&quot;b&quot; //&quot;c&quot;,&quot;d&quot;console.log(arrayToCSV([[&#39;a&#39;, &#39;b&#39;],[&#39;c&#39;, &#39;d&#39;]],&#39;;&#39;));//&quot;a&quot;,&quot;b&quot; //&quot;c&quot;,&quot;d&quot;</code></pre><h3 id="MDN-è§£æ-Array-prototype-map-æ¡ˆä¾‹"><a href="#MDN-è§£æ-Array-prototype-map-æ¡ˆä¾‹" class="headerlink" title="MDN  è§£æ Array.prototype.map()  æ¡ˆä¾‹"></a>MDN  è§£æ Array.prototype.map()  æ¡ˆä¾‹</h3><p>è¯¥   map()   æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æœæ˜¯åœ¨è°ƒç”¨æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä¸Šè°ƒç”¨æä¾›çš„å‡½æ•°ã€‚</p><pre><code class="js">var array1 = [1, 4, 9 ,16];const map1 = array1.map(x =&gt; x * 2);console.log(map1);// [2, 8, 18, 32]console.log(array1);//[1, 4, 9, 16]</code></pre><h3 id="MDN-è§£æ-Array-prototype-join-æ¡ˆä¾‹"><a href="#MDN-è§£æ-Array-prototype-join-æ¡ˆä¾‹" class="headerlink" title="MDN  è§£æ Array.prototype.join()  æ¡ˆä¾‹"></a>MDN  è§£æ Array.prototype.join()  æ¡ˆä¾‹</h3><p>è¯¥  join()  æ–¹æ³•é€šè¿‡è¿æ¥æ•°ç»„ï¼ˆæˆ–ç±»æ•°ç»„å¯¹è±¡ï¼‰ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆç”±é€—å·æˆ–æŒ‡å®šçš„åˆ†éš”ç¬¦å­—ç¬¦ä¸²åˆ†éš”ï¼‰æ¥åˆ›å»ºå¹¶è¿”å›æ–°å­—ç¬¦ä¸²ã€‚å¦‚æœæ•°ç»„åªæœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œé‚£ä¹ˆå°†è¿”å›è¯¥é¡¹ç›®è€Œä¸ä½¿ç”¨åˆ†éš”ç¬¦ã€‚å¦‚æœå…ƒç´ æ˜¯  undefined  æˆ–  null ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</p><pre><code class="js">var elements = [&#39;Fire&#39;, &#39;Wind&#39;, &#39;Rain&#39;];console.log(console.log(elements.join(&#39;-&#39;)));//Fire-Wind-Rain</code></pre>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Es6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue ç»„ä»¶ä¹‹é—´çš„é€šä¿¡</title>
      <link href="/2019/01/20/Vue/vue-%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/"/>
      <url>/2019/01/20/Vue/vue-%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯Vueç»„ä»¶ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Vueç»„ä»¶ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Vueç»„ä»¶ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Vueç»„ä»¶ï¼Ÿ</h1><p>ç»„ä»¶ (Component) æ˜¯ Vue.js æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ã€‚ç»„ä»¶å¯ä»¥æ‰©å±• HTML å…ƒç´ ï¼Œå°è£…å¯é‡ç”¨çš„ä»£ç ã€‚åœ¨è¾ƒé«˜å±‚é¢ä¸Šï¼Œç»„ä»¶æ˜¯è‡ªå®šä¹‰å…ƒç´ ï¼ŒVue.js çš„ç¼–è¯‘å™¨ä¸ºå®ƒæ·»åŠ ç‰¹æ®ŠåŠŸèƒ½ã€‚åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œç»„ä»¶ä¹Ÿå¯ä»¥æ˜¯åŸç”Ÿ HTML å…ƒç´ çš„å½¢å¼ï¼Œä»¥ is ç‰¹æ€§æ‰©å±•ã€‚</p><h2 id="Vueç»„ä»¶é—´é€šä¿¡"><a href="#Vueç»„ä»¶é—´é€šä¿¡" class="headerlink" title="Vueç»„ä»¶é—´é€šä¿¡"></a>Vueç»„ä»¶é—´é€šä¿¡</h2><p>å¸¸è§ä½¿ç”¨åœºæ™¯å¯ä»¥åˆ†ä¸ºä¸‰ç±»:</p><p>çˆ¶å­ç»„ä»¶é€šä¿¡: props; $parent / $children; provide / inject ; ref ;  $attrs / $listeners<br>å…„å¼Ÿç»„ä»¶é€šä¿¡: eventBus ;     vuex<br>è·¨çº§é€šä¿¡:  eventBusï¼›Vuexï¼›provide / inject ã€$attrs / $listeners</p><h3 id="çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡"><a href="#çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡" class="headerlink" title="çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡"></a>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡</h3><ul><li>æ–¹æ³•ä¸€ï¼šprops</li></ul><p>ä½¿ç”¨propsï¼Œçˆ¶ç»„ä»¶å¯ä»¥ä½¿ç”¨propså‘å­ç»„ä»¶ä¼ é€’æ•°æ®ã€‚</p><p>çˆ¶ç»„ä»¶vueæ¨¡æ¿father.vue</p><pre><code class="html">&lt;template&gt;    &lt;child :msg=&quot;message&quot;&gt;&lt;/child&gt;&lt;/template&gt;&lt;script&gt;import child from &#39;./child.vue&#39;;export default {    components: {        child    },    data () {        return {            message: &#39;father message&#39;;        }    }}&lt;/script&gt;</code></pre><p>å­ç»„ä»¶vueæ¨¡æ¿child.vue</p><pre><code class="html">&lt;template&gt;    &lt;div&gt;{{msg}}&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default {    props: {        msg: {            type: String,            required: true        }    }}&lt;/script&gt;</code></pre><ul><li>æ–¹æ³•äºŒ ä½¿ç”¨$children</li></ul><p>ä½¿ç”¨<code>$children</code>å¯ä»¥åœ¨çˆ¶ç»„ä»¶ä¸­è®¿é—®å­ç»„ä»¶ã€‚</p><h3 id="å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡"><a href="#å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡" class="headerlink" title="å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡"></a>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡</h3><ul><li>æ–¹æ³•ä¸€:ä½¿ç”¨vueäº‹ä»¶<br>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’äº‹ä»¶æ–¹æ³•ï¼Œå­ç»„ä»¶é€šè¿‡$emitè§¦å‘äº‹ä»¶ï¼Œå›è°ƒç»™çˆ¶ç»„ä»¶ã€‚</li></ul><p>çˆ¶ç»„ä»¶vueæ¨¡æ¿father.vue</p><pre><code class="html">&lt;template&gt;    &lt;child @msgFunc=&quot;func&quot;&gt;&lt;/child&gt;&lt;/template&gt;&lt;script&gt;import child from &#39;./child.vue&#39;;export default {    components: {        child    },    methods: {        func (msg) {            console.log(msg);        }    }}&lt;/script&gt;</code></pre><p>å­ç»„ä»¶vueæ¨¡æ¿child.vue<br><a id="more"></a></p><pre><code class="html">&lt;template&gt;    &lt;button @click=&quot;handleClick&quot;&gt;ç‚¹æˆ‘&lt;/button&gt;&lt;/template&gt;&lt;script&gt;export default {    props: {        msg: {            type: String,            required: true        }    },    methods () {        handleClick () {            //........            this.$emit(&#39;msgFunc&#39;);        }    }}&lt;/script&gt;</code></pre><ul><li>æ–¹æ³•äºŒï¼š é€šè¿‡ä¿®æ”¹çˆ¶ç»„ä»¶ä¼ é€’çš„propsæ¥ä¿®æ”¹çˆ¶ç»„ä»¶æ•°æ®</li></ul><p>è¿™ç§æ–¹æ³•åªèƒ½åœ¨çˆ¶ç»„ä»¶ä¼ é€’ä¸€ä¸ªå¼•ç”¨å˜é‡æ—¶å¯ä»¥ä½¿ç”¨ï¼Œå­—é¢å˜é‡æ— æ³•è¾¾åˆ°ç›¸åº”æ•ˆæœã€‚å› ä¸ºå¼•ç”¨å˜é‡æœ€ç»ˆæ— è®ºæ˜¯çˆ¶ç»„ä»¶ä¸­çš„æ•°æ®è¿˜æ˜¯å­ç»„ä»¶å¾—åˆ°çš„propsä¸­çš„æ•°æ®éƒ½æ˜¯æŒ‡å‘åŒä¸€å—å†…å­˜åœ°å€ï¼Œæ‰€ä»¥ä¿®æ”¹äº†å­ç»„ä»¶ä¸­propsçš„æ•°æ®å³ä¿®æ”¹äº†çˆ¶ç»„ä»¶çš„æ•°æ®ã€‚</p><p>ä½†æ˜¯å¹¶ä¸æ¨èè¿™ä¹ˆåšï¼Œå¹¶ä¸å»ºè®®ç›´æ¥ä¿®æ”¹propsçš„å€¼ï¼Œå¦‚æœæ•°æ®æ˜¯ç”¨äºæ˜¾ç¤ºä¿®æ”¹çš„ï¼Œåœ¨å®é™…å¼€å‘ä¸­æˆ‘ç»å¸¸ä¼šå°†å…¶æ”¾å…¥dataä¸­ï¼Œåœ¨éœ€è¦å›ä¼ ç»™çˆ¶ç»„ä»¶çš„æ—¶å€™å†ç”¨äº‹ä»¶å›ä¼ æ•°æ®ã€‚è¿™æ ·åšä¿æŒäº†ç»„ä»¶ç‹¬ç«‹ä»¥åŠè§£è€¦ï¼Œä¸ä¼šå› ä¸ºä½¿ç”¨åŒä¸€ä»½æ•°æ®è€Œå¯¼è‡´æ•°æ®æµå¼‚å¸¸æ··ä¹±ï¼Œåªé€šè¿‡ç‰¹å®šçš„æ¥å£ä¼ é€’æ•°æ®æ¥è¾¾åˆ°ä¿®æ”¹æ•°æ®çš„ç›®çš„ï¼Œè€Œå†…éƒ¨æ•°æ®çŠ¶æ€ç”±ä¸“é—¨çš„dataè´Ÿè´£ç®¡ç†ã€‚</p><ul><li>æ–¹æ³•ä¸‰ï¼šä½¿ç”¨$parent</li></ul><p>ä½¿ç”¨$parentå¯ä»¥è®¿é—®çˆ¶ç»„ä»¶çš„æ•°æ®ã€‚</p><h3 id="éçˆ¶å­ç»„ä»¶ã€å…„å¼Ÿç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’"><a href="#éçˆ¶å­ç»„ä»¶ã€å…„å¼Ÿç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’" class="headerlink" title="éçˆ¶å­ç»„ä»¶ã€å…„å¼Ÿç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’"></a>éçˆ¶å­ç»„ä»¶ã€å…„å¼Ÿç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’</h3><p>éçˆ¶å­ç»„ä»¶é€šä¿¡ï¼ŒVueå®˜æ–¹æ¨è<a href="https://cn.vuejs.org/v2/guide/components.html#%E9%9D%9E%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1" target="_blank" rel="noopener">ä½¿ç”¨ä¸€ä¸ªVueå®ä¾‹ä½œä¸ºä¸­å¤®äº‹ä»¶æ€»çº¿</a>ã€‚</p><p>Vueå†…éƒ¨æœ‰ä¸€ä¸ªäº‹ä»¶æœºåˆ¶ï¼Œå¯ä»¥å‚è€ƒæºç ã€‚</p><p>$onæ–¹æ³•ç”¨æ¥ç›‘å¬ä¸€ä¸ªäº‹ä»¶ã€‚</p><p>$emitç”¨æ¥è§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚</p><pre><code class="js">/*æ–°å»ºä¸€ä¸ªVueå®ä¾‹ä½œä¸ºä¸­å¤®äº‹ä»¶æ€»å«Œ*/let event = new Vue();/*ç›‘å¬äº‹ä»¶*/event.$on(&#39;eventName&#39;, (val) =&gt; {    //......do something});/*è§¦å‘äº‹ä»¶*/event.$emit(&#39;eventName&#39;, &#39;this is a message.&#39;);</code></pre><h3 id="å¤šå±‚çº§çˆ¶å­ç»„ä»¶é€šä¿¡ï¼š"><a href="#å¤šå±‚çº§çˆ¶å­ç»„ä»¶é€šä¿¡ï¼š" class="headerlink" title="å¤šå±‚çº§çˆ¶å­ç»„ä»¶é€šä¿¡ï¼š"></a>å¤šå±‚çº§çˆ¶å­ç»„ä»¶é€šä¿¡ï¼š</h3><p>åœ¨Vue1.0ä¸­å®ç°äº†$broadcastä¸$dispatchä¸¤ä¸ªæ–¹æ³•ç”¨æ¥å‘å­ç»„ä»¶ï¼ˆæˆ–çˆ¶ç»„ä»¶ï¼‰å¹¿æ’­ï¼ˆæˆ–æ´¾å‘ï¼‰ï¼Œå½“å­ç»„ä»¶ï¼ˆæˆ–çˆ¶ç»„ä»¶ï¼‰ä¸Šç›‘å¬äº†äº‹ä»¶å¹¶è¿”å›trueçš„æ—¶å€™ä¼šå‘çˆ·å­™çº§ç»„ä»¶ç»§ç»­å¹¿æ’­ï¼ˆæˆ–æ´¾å‘ï¼‰äº‹ä»¶ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•åœ¨Vue2.0é‡Œé¢å·²ç»è¢«ç§»é™¤äº†ã€‚</p><p>ä¹‹å‰åœ¨å­¦ä¹ é¥¿äº†ä¹ˆçš„å¼€æºç»„ä»¶åº“elementçš„æ—¶å€™å‘ç°ä»–ä»¬é‡æ–°å®ç°äº†broadcastä»¥åŠdispatchçš„æ–¹æ³•ï¼Œä»¥mixinçš„æ–¹å¼å¼•å…¥ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://github.com/answershuto/learnVue/blob/master/docs/%E8%AF%B4%E8%AF%B4element%E7%BB%84%E4%BB%B6%E5%BA%93broadcast%E4%B8%8Edispatch.MarkDown" target="_blank" rel="noopener">ã€Šè¯´è¯´elementç»„ä»¶åº“broadcastä¸dispatchã€‹</a>ã€‚ä½†æ˜¯è·ŸVue1.0çš„ä¸¤ä¸ªæ–¹æ³•å®ç°æœ‰ç•¥å¾®çš„ä¸åŒã€‚è¿™ä¸¤ä¸ªæ–¹æ³•å®ç°äº†å‘å­å­™ç»„ä»¶äº‹ä»¶å¹¿æ’­ä»¥åŠå‘å¤šå±‚çº§çˆ¶ç»„ä»¶äº‹ä»¶æ´¾å‘çš„åŠŸèƒ½ã€‚ä½†æ˜¯å¹¶éå¹¿ä¹‰ä¸Šçš„äº‹ä»¶å¹¿æ’­ï¼Œå®ƒéœ€è¦æŒ‡å®šä¸€ä¸ªcommentNameè¿›è¡Œå‘æŒ‡å®šç»„ä»¶åç»„ä»¶å®šå‘å¹¿æ’­ï¼ˆæ´¾å‘ï¼‰äº‹ä»¶ã€‚</p><p>å…¶å®è¿™ä¸¤ä¸ªæ–¹æ³•å†…éƒ¨å®ç°è¿˜æ˜¯ç”¨åˆ°çš„è¿˜æ˜¯$parentä»¥åŠ$childrenï¼Œç”¨ä»¥éå†å­èŠ‚ç‚¹æˆ–æ˜¯é€çº§å‘ä¸ŠæŸ¥è¯¢çˆ¶èŠ‚ç‚¹ï¼Œè®¿é—®åˆ°æŒ‡å®šç»„ä»¶åçš„æ—¶å€™ï¼Œè°ƒç”¨$emitè§¦å‘æŒ‡å®šäº‹ä»¶ã€‚</p><h3 id="å¤æ‚çš„å•é¡µåº”ç”¨æ•°æ®ç®¡ç†"><a href="#å¤æ‚çš„å•é¡µåº”ç”¨æ•°æ®ç®¡ç†" class="headerlink" title="å¤æ‚çš„å•é¡µåº”ç”¨æ•°æ®ç®¡ç†"></a>å¤æ‚çš„å•é¡µåº”ç”¨æ•°æ®ç®¡ç†</h3><p>å½“åº”ç”¨è¶³å¤Ÿå¤æ‚æƒ…å†µä¸‹ï¼Œè¯·ä½¿ç”¨vuexè¿›è¡Œæ•°æ®ç®¡ç†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>keep-aliveç»„ä»¶çš„ä½¿ç”¨åŠå…¶å®ç°åŸç†</title>
      <link href="/2019/01/13/Vue/keep-alive%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%85%B6%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/"/>
      <url>/2019/01/13/Vue/keep-alive%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%85%B6%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a>keep-alive</h1><p>keep-aliveæ˜¯Vue.jsçš„ä¸€ä¸ªå†…ç½®ç»„ä»¶ã€‚å®ƒèƒ½å¤Ÿä¸æ´»åŠ¨çš„ç»„ä»¶å®ä¾‹ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å°†å…¶é”€æ¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç»„ä»¶ï¼Œä¸ä¼šè¢«æ¸²æŸ“åˆ°çœŸå®DOMä¸­ï¼Œä¹Ÿä¸ä¼šå‡ºç°åœ¨çˆ¶ç»„ä»¶é“¾ä¸­ã€‚</p><p>å®ƒæä¾›äº†includeä¸excludeä¸¤ä¸ªå±æ€§ï¼Œå…è®¸ç»„ä»¶æœ‰æ¡ä»¶åœ°è¿›è¡Œç¼“å­˜ã€‚</p><p>å…·ä½“å†…å®¹å¯ä»¥å‚è€ƒ<a href="https://cn.vuejs.org/v2/api/#keep-alive" target="_blank" rel="noopener">å®˜ç½‘</a>ã€‚</p><h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><pre><code class="js">&lt;keep-alive&gt;    &lt;component&gt;&lt;/component&gt;&lt;/keep-alive&gt;</code></pre><p>è¿™é‡Œçš„componentç»„ä»¶ä¼šè¢«ç¼“å­˜èµ·æ¥ã€‚</p><p><code>ä¸¾ä¸ªæ —å­</code></p><pre><code class="html">&lt;keep-alive&gt;    &lt;coma v-if=&quot;test&quot;&gt;&lt;/coma&gt;    &lt;comb v-else&gt;&lt;/comb&gt;&lt;keep-alive/&gt;&lt;button @click=&quot;test=handleClick&quot;&gt;è¯·ç‚¹å‡»&lt;/button&gt;</code></pre><pre><code class="js">export default {    data () {        return {            test: true        }    },    methods: {        handleClick () {            this.test = !this.test;        }    }}</code></pre><p>åœ¨ç‚¹å‡»buttonæ—¶å€™ï¼Œcomaä¸combä¸¤ä¸ªç»„ä»¶ä¼šå‘ç”Ÿåˆ‡æ¢ï¼Œä½†æ˜¯è¿™æ—¶å€™è¿™ä¸¤ä¸ªç»„ä»¶çš„çŠ¶æ€ä¼šè¢«ç¼“å­˜èµ·æ¥ï¼Œæ¯”å¦‚è¯´comaä¸combç»„ä»¶ä¸­éƒ½æœ‰ä¸€ä¸ªinputæ ‡ç­¾ï¼Œé‚£ä¹ˆinputæ ‡ç­¾ä¸­çš„å†…å®¹ä¸ä¼šå› ä¸ºç»„ä»¶çš„åˆ‡æ¢è€Œæ¶ˆå¤±ã€‚</p><h3 id="props"><a href="#props" class="headerlink" title="props"></a>props</h3><p>keep-aliveç»„ä»¶æä¾›äº†<code>include</code>ä¸<code>exclude</code>ä¸¤ä¸ªå±æ€§æ¥å…è®¸ç»„ä»¶æœ‰æ¡ä»¶åœ°è¿›è¡Œç¼“å­˜ï¼ŒäºŒè€…éƒ½å¯ä»¥ç”¨é€—å·åˆ†éš”å­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼æˆ–ä¸€ä¸ªæ•°ç»„æ¥è¡¨ç¤ºã€‚</p><pre><code class="html">&lt;keep-alive include=&quot;a&quot;&gt;  &lt;component&gt;&lt;/component&gt;&lt;/keep-alive&gt;</code></pre><pre><code class="html">å°†ç¼“å­˜nameä¸ºaçš„ç»„ä»¶ã€‚&lt;keep-alive exclude=&quot;a&quot;&gt;  &lt;component&gt;&lt;/component&gt;&lt;/keep-alive&gt;</code></pre><p>nameä¸ºaçš„ç»„ä»¶å°†ä¸ä¼šè¢«ç¼“å­˜ã€‚</p><h3 id="ç”Ÿå‘½é’©å­"><a href="#ç”Ÿå‘½é’©å­" class="headerlink" title="ç”Ÿå‘½é’©å­"></a>ç”Ÿå‘½é’©å­</h3><p>keep-aliveæä¾›äº†ä¸¤ä¸ªç”Ÿå‘½é’©å­ï¼Œåˆ†åˆ«æ˜¯activatedä¸deactivatedã€‚</p><p>å› ä¸ºkeep-aliveä¼šå°†ç»„ä»¶ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸ä¼šé”€æ¯ä»¥åŠé‡æ–°åˆ›å»ºï¼Œæ‰€ä»¥ä¸ä¼šé‡æ–°è°ƒç”¨ç»„ä»¶çš„createdç­‰æ–¹æ³•ï¼Œéœ€è¦ç”¨activatedä¸deactivatedè¿™ä¸¤ä¸ªç”Ÿå‘½é’©å­æ¥å¾—çŸ¥å½“å‰ç»„ä»¶æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚</p><h2 id="æ·±å…¥keep-aliveç»„ä»¶å®ç°"><a href="#æ·±å…¥keep-aliveç»„ä»¶å®ç°" class="headerlink" title="æ·±å…¥keep-aliveç»„ä»¶å®ç°"></a>æ·±å…¥keep-aliveç»„ä»¶å®ç°</h2><p>è¯´å®Œäº†keep-aliveç»„ä»¶çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬ä»æºç è§’åº¦çœ‹ä¸€ä¸‹keep-aliveç»„ä»¶ç©¶ç«Ÿæ˜¯å¦‚ä½•å®ç°ç»„ä»¶çš„ç¼“å­˜çš„å‘¢ï¼Ÿ</p><h3 id="createdä¸destroyedé’©å­"><a href="#createdä¸destroyedé’©å­" class="headerlink" title="createdä¸destroyedé’©å­"></a>createdä¸destroyedé’©å­</h3><p>createdé’©å­ä¼šåˆ›å»ºä¸€ä¸ªcacheå¯¹è±¡ï¼Œç”¨æ¥ä½œä¸ºç¼“å­˜å®¹å™¨ï¼Œä¿å­˜vnodeèŠ‚ç‚¹ã€‚</p><pre><code class="js">created () {    /* ç¼“å­˜å¯¹è±¡ */    this.cache = Object.create(null)},</code></pre><p>destroyedé’©å­åˆ™åœ¨ç»„ä»¶è¢«é”€æ¯çš„æ—¶å€™æ¸…é™¤cacheç¼“å­˜ä¸­çš„æ‰€æœ‰ç»„ä»¶å®ä¾‹ã€‚</p><pre><code class="js">/* destroyedé’©å­ä¸­é”€æ¯æ‰€æœ‰cacheä¸­çš„ç»„ä»¶å®ä¾‹ */destroyed () {    for (const key in this.cache) {        pruneCacheEntry(this.cache[key])    }},</code></pre><a id="more"></a><h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><p>æ¥ä¸‹æ¥æ˜¯renderå‡½æ•°ã€‚</p><pre><code class="js">render () {    /* å¾—åˆ°slotæ’æ§½ä¸­çš„ç¬¬ä¸€ä¸ªç»„ä»¶ */    const vnode: VNode = getFirstComponentChild(this.$slots.default)    const componentOptions: ?VNodeComponentOptions = vnode &amp;&amp; vnode.componentOptions    if (componentOptions) {        // check pattern        /* è·å–ç»„ä»¶åç§°ï¼Œä¼˜å…ˆè·å–ç»„ä»¶çš„nameå­—æ®µï¼Œå¦åˆ™æ˜¯ç»„ä»¶çš„tag */        const name: ?string = getComponentName(componentOptions)        /* nameä¸åœ¨inlcudeä¸­æˆ–è€…åœ¨exludeä¸­åˆ™ç›´æ¥è¿”å›vnodeï¼ˆæ²¡æœ‰å–ç¼“å­˜ï¼‰ */        if (name &amp;&amp; (        (this.include &amp;&amp; !matches(this.include, name)) ||        (this.exclude &amp;&amp; matches(this.exclude, name))        )) {            return vnode        }        const key: ?string = vnode.key == null        // same constructor may get registered as different local components        // so cid alone is not enough (#3269)        ? componentOptions.Ctor.cid + (componentOptions.tag ? `::${componentOptions.tag}` : &#39;&#39;)        : vnode.key        /* å¦‚æœå·²ç»åšè¿‡ç¼“å­˜äº†åˆ™ç›´æ¥ä»ç¼“å­˜ä¸­è·å–ç»„ä»¶å®ä¾‹ç»™vnodeï¼Œè¿˜æœªç¼“å­˜è¿‡åˆ™è¿›è¡Œç¼“å­˜ */        if (this.cache[key]) {            vnode.componentInstance = this.cache[key].componentInstance        } else {            this.cache[key] = vnode        }        /* keepAliveæ ‡è®°ä½ */        vnode.data.keepAlive = true    }    return vnode}</code></pre><p>é¦–å…ˆé€šè¿‡getFirstComponentChildè·å–ç¬¬ä¸€ä¸ªå­ç»„ä»¶ï¼Œè·å–è¯¥ç»„ä»¶çš„nameï¼ˆå­˜åœ¨ç»„ä»¶ååˆ™ç›´æ¥ä½¿ç”¨ç»„ä»¶åï¼Œå¦åˆ™ä¼šä½¿ç”¨tagï¼‰ã€‚æ¥ä¸‹æ¥ä¼šå°†è¿™ä¸ªnameé€šè¿‡includeä¸excludeå±æ€§è¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…ä¸æˆåŠŸï¼ˆè¯´æ˜ä¸éœ€è¦è¿›è¡Œç¼“å­˜ï¼‰åˆ™ä¸è¿›è¡Œä»»ä½•æ“ä½œç›´æ¥è¿”å›vnodeï¼Œvnodeæ˜¯ä¸€ä¸ªVNodeç±»å‹çš„å¯¹è±¡ï¼Œä¸äº†è§£VNodeçš„åŒå­¦å¯ä»¥å‚è€ƒç¬”è€…çš„å¦ä¸€ç¯‡æ–‡ç« <a href="https://github.com/answershuto/learnVue/blob/master/docs/VNode%E8%8A%82%E7%82%B9.MarkDown" target="_blank" rel="noopener">ã€ŠVNodeèŠ‚ç‚¹ã€‹</a> .</p><pre><code class="js">/* æ£€æµ‹nameæ˜¯å¦åŒ¹é… */function matches (pattern: string | RegExp, name: string): boolean {  if (typeof pattern === &#39;string&#39;) {    /* å­—ç¬¦ä¸²æƒ…å†µï¼Œå¦‚a,b,c */    return pattern.split(&#39;,&#39;).indexOf(name) &gt; -1  } else if (isRegExp(pattern)) {    /* æ­£åˆ™ */    return pattern.test(name)  }  /* istanbul ignore next */  return false}</code></pre><p>æ£€æµ‹includeä¸excludeå±æ€§åŒ¹é…çš„å‡½æ•°å¾ˆç®€å•ï¼Œincludeä¸excludeå±æ€§æ”¯æŒå­—ç¬¦ä¸²å¦‚â€a,b,câ€è¿™æ ·ç»„ä»¶åä»¥é€—å·éš”å¼€çš„æƒ…å†µä»¥åŠæ­£åˆ™è¡¨è¾¾å¼ã€‚matchesé€šè¿‡è¿™ä¸¤ç§æ–¹å¼åˆ†åˆ«æ£€æµ‹æ˜¯å¦åŒ¹é…å½“å‰ç»„ä»¶ã€‚</p><pre><code class="js">if (this.cache[key]) {    vnode.componentInstance = this.cache[key].componentInstance} else {    this.cache[key] = vnode}</code></pre><p>æ¥ä¸‹æ¥çš„äº‹æƒ…å¾ˆç®€å•ï¼Œæ ¹æ®keyåœ¨this.cacheä¸­æŸ¥æ‰¾ï¼Œå¦‚æœå­˜åœ¨åˆ™è¯´æ˜ä¹‹å‰å·²ç»ç¼“å­˜è¿‡äº†ï¼Œç›´æ¥å°†ç¼“å­˜çš„vnodeçš„componentInstanceï¼ˆç»„ä»¶å®ä¾‹ï¼‰è¦†ç›–åˆ°ç›®å‰çš„vnodeä¸Šé¢ã€‚å¦åˆ™å°†vnodeå­˜å‚¨åœ¨cacheä¸­ã€‚</p><p>æœ€åè¿”å›vnodeï¼ˆæœ‰ç¼“å­˜æ—¶è¯¥vnodeçš„componentInstanceå·²ç»è¢«æ›¿æ¢æˆç¼“å­˜ä¸­çš„äº†ï¼‰ã€‚</p><h3 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h3><p>ç”¨watchæ¥ç›‘å¬pruneCacheä¸pruneCacheè¿™ä¸¤ä¸ªå±æ€§çš„æ”¹å˜ï¼Œåœ¨æ”¹å˜çš„æ—¶å€™ä¿®æ”¹cacheç¼“å­˜ä¸­çš„ç¼“å­˜æ•°æ®ã€‚</p><pre><code class="js">watch: {    /* ç›‘è§†includeä»¥åŠexcludeï¼Œåœ¨è¢«ä¿®æ”¹çš„æ—¶å€™å¯¹cacheè¿›è¡Œä¿®æ­£ */    include (val: string | RegExp) {        pruneCache(this.cache, this._vnode, name =&gt; matches(val, name))    },    exclude (val: string | RegExp) {        pruneCache(this.cache, this._vnode, name =&gt; !matches(val, name))    }},</code></pre><p>æ¥çœ‹ä¸€ä¸‹pruneCacheçš„å®ç°ã€‚</p><pre><code class="js">/* ä¿®æ­£cache */function pruneCache (cache: VNodeCache, current: VNode, filter: Function) {  for (const key in cache) {    /* å–å‡ºcacheä¸­çš„vnode */    const cachedNode: ?VNode = cache[key]    if (cachedNode) {      const name: ?string = getComponentName(cachedNode.componentOptions)      /* nameä¸ç¬¦åˆfilteræ¡ä»¶çš„ï¼ŒåŒæ—¶ä¸æ˜¯ç›®å‰æ¸²æŸ“çš„vnodeæ—¶ï¼Œé”€æ¯vnodeå¯¹åº”çš„ç»„ä»¶å®ä¾‹ï¼ˆVueå®ä¾‹ï¼‰ï¼Œå¹¶ä»cacheä¸­ç§»é™¤ */      if (name &amp;&amp; !filter(name)) {        if (cachedNode !== current) {          pruneCacheEntry(cachedNode)        }        cache[key] = null      }    }  }} /* é”€æ¯vnodeå¯¹åº”çš„ç»„ä»¶å®ä¾‹ï¼ˆVueå®ä¾‹ï¼‰ */function pruneCacheEntry (vnode: ?VNode) {  if (vnode) {    vnode.componentInstance.$destroy()  }}</code></pre><p>éå†cacheä¸­çš„æ‰€æœ‰é¡¹ï¼Œå¦‚æœä¸ç¬¦åˆfilteræŒ‡å®šçš„è§„åˆ™çš„è¯ï¼Œåˆ™ä¼šæ‰§è¡ŒpruneCacheEntryã€‚pruneCacheEntryåˆ™ä¼šè°ƒç”¨ç»„ä»¶å®ä¾‹çš„$destroyæ–¹æ³•æ¥å°†ç»„ä»¶é”€æ¯ã€‚</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>Vue.jså†…éƒ¨å°†DOMèŠ‚ç‚¹æŠ½è±¡æˆäº†ä¸€ä¸ªä¸ªçš„VNodeèŠ‚ç‚¹ï¼Œkeep-aliveç»„ä»¶çš„ç¼“å­˜ä¹Ÿæ˜¯åŸºäºVNodeèŠ‚ç‚¹çš„è€Œä¸æ˜¯ç›´æ¥å­˜å‚¨DOMç»“æ„ã€‚å®ƒå°†æ»¡è¶³æ¡ä»¶ï¼ˆpruneCacheä¸pruneCacheï¼‰çš„ç»„ä»¶åœ¨cacheå¯¹è±¡ä¸­ç¼“å­˜èµ·æ¥ï¼Œåœ¨éœ€è¦é‡æ–°æ¸²æŸ“çš„æ—¶å€™å†å°†vnodeèŠ‚ç‚¹ä»cacheå¯¹è±¡ä¸­å–å‡ºå¹¶æ¸²æŸ“ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vuexæºç è§£æ</title>
      <link href="/2019/01/06/Vue/Vuex%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/01/06/Vue/Vuex%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æˆ‘ä»¬åœ¨ä½¿ç”¨Vue.jså¼€å‘å¤æ‚çš„åº”ç”¨æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°å¤šä¸ªç»„ä»¶å…±äº«åŒä¸€ä¸ªçŠ¶æ€ï¼Œäº¦æˆ–æ˜¯å¤šä¸ªç»„ä»¶ä¼šå»æ›´æ–°åŒä¸€ä¸ªçŠ¶æ€ï¼Œåœ¨åº”ç”¨ä»£ç é‡è¾ƒå°‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç»„ä»¶é—´é€šä¿¡å»ç»´æŠ¤ä¿®æ”¹æ•°æ®ï¼Œæˆ–è€…æ˜¯é€šè¿‡äº‹ä»¶æ€»çº¿æ¥è¿›è¡Œæ•°æ®çš„ä¼ é€’ä»¥åŠä¿®æ”¹ã€‚ä½†æ˜¯å½“åº”ç”¨é€æ¸åºå¤§ä»¥åï¼Œä»£ç å°±ä¼šå˜å¾—éš¾ä»¥ç»´æŠ¤ï¼Œä»çˆ¶ç»„ä»¶å¼€å§‹é€šè¿‡propä¼ é€’å¤šå±‚åµŒå¥—çš„æ•°æ®ç”±äºå±‚çº§è¿‡æ·±è€Œæ˜¾å¾—å¼‚å¸¸è„†å¼±ï¼Œè€Œäº‹ä»¶æ€»çº¿ä¹Ÿä¼šå› ä¸ºç»„ä»¶çš„å¢å¤šã€ä»£ç é‡çš„å¢å¤§è€Œæ˜¾å¾—äº¤äº’é”™ç»¼å¤æ‚ï¼Œéš¾ä»¥æ‹æ¸…å…¶ä¸­çš„ä¼ é€’å…³ç³»ã€‚</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½å°†æ•°æ®å±‚ä¸ç»„ä»¶å±‚æŠ½ç¦»å¼€æ¥å‘¢ï¼ŸæŠŠæ•°æ®å±‚æ”¾åˆ°å…¨å±€å½¢æˆä¸€ä¸ªå•ä¸€çš„Storeï¼Œç»„ä»¶å±‚å˜å¾—æ›´è–„ï¼Œä¸“é—¨ç”¨æ¥è¿›è¡Œæ•°æ®çš„å±•ç¤ºåŠæ“ä½œã€‚æ‰€æœ‰æ•°æ®çš„å˜æ›´éƒ½éœ€è¦ç»è¿‡å…¨å±€çš„Storeæ¥è¿›è¡Œï¼Œå½¢æˆä¸€ä¸ªå•å‘æ•°æ®æµï¼Œä½¿æ•°æ®å˜åŒ–å˜å¾—â€œå¯é¢„æµ‹â€ã€‚</p><p>Vuexæ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºVue.jsæ¡†æ¶è®¾è®¡çš„ã€ç”¨äºå¯¹Vue.jsåº”ç”¨ç¨‹åºè¿›è¡ŒçŠ¶æ€ç®¡ç†çš„åº“ï¼Œå®ƒå€Ÿé‰´äº†Fluxã€reduxçš„åŸºæœ¬æ€æƒ³ï¼Œå°†å…±äº«çš„æ•°æ®æŠ½ç¦»åˆ°å…¨å±€ï¼Œä»¥ä¸€ä¸ªå•ä¾‹å­˜æ”¾ï¼ŒåŒæ—¶åˆ©ç”¨Vue.jsçš„å“åº”å¼æœºåˆ¶æ¥è¿›è¡Œé«˜æ•ˆçš„çŠ¶æ€ç®¡ç†ä¸æ›´æ–°ã€‚æ­£æ˜¯å› ä¸ºVuexä½¿ç”¨äº†Vue.jså†…éƒ¨çš„â€œå“åº”å¼æœºåˆ¶â€ï¼Œæ‰€ä»¥Vuexæ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºVue.jsè®¾è®¡å¹¶ä¸ä¹‹é«˜åº¦å¥‘åˆçš„æ¡†æ¶ï¼ˆä¼˜ç‚¹æ˜¯æ›´åŠ ç®€æ´é«˜æ•ˆï¼Œç¼ºç‚¹æ˜¯åªèƒ½è·ŸVue.jsæ­é…ä½¿ç”¨ï¼‰ã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•åŠAPIå¯ä»¥å‚è€ƒVuexçš„å®˜ç½‘ã€‚</p><p>Vuexå®ç°äº†ä¸€ä¸ªå•å‘æ•°æ®æµï¼Œåœ¨å…¨å±€æ‹¥æœ‰ä¸€ä¸ªStateå­˜æ”¾æ•°æ®ï¼Œæ‰€æœ‰ä¿®æ”¹Stateçš„æ“ä½œå¿…é¡»é€šè¿‡Mutationè¿›è¡Œï¼ŒMutationçš„åŒæ—¶æä¾›äº†è®¢é˜…è€…æ¨¡å¼ä¾›å¤–éƒ¨æ’ä»¶è°ƒç”¨è·å–Stateæ•°æ®çš„æ›´æ–°ã€‚æ‰€æœ‰å¼‚æ­¥æ¥å£éœ€è¦èµ°Actionï¼Œå¸¸è§äºè°ƒç”¨åç«¯æ¥å£å¼‚æ­¥è·å–æ›´æ–°æ•°æ®ï¼Œè€ŒActionä¹Ÿæ˜¯æ— æ³•ç›´æ¥ä¿®æ”¹Stateçš„ï¼Œè¿˜æ˜¯éœ€è¦é€šè¿‡Mutationæ¥ä¿®æ”¹Stateçš„æ•°æ®ã€‚æœ€åï¼Œæ ¹æ®Stateçš„å˜åŒ–ï¼Œæ¸²æŸ“åˆ°è§†å›¾ä¸Šã€‚Vuexè¿è¡Œä¾èµ–Vueå†…éƒ¨æ•°æ®åŒå‘ç»‘å®šæœºåˆ¶ï¼Œéœ€è¦newä¸€ä¸ªVueå¯¹è±¡æ¥å®ç°â€œå“åº”å¼åŒ–â€ï¼Œæ‰€ä»¥Vuexæ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºVue.jsè®¾è®¡çš„çŠ¶æ€ç®¡ç†åº“ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>ä½¿ç”¨è¿‡Vuexçš„æœ‹å‹ä¸€å®šçŸ¥é“ï¼ŒVuexçš„å®‰è£…ååˆ†ç®€å•ï¼Œåªéœ€è¦æä¾›ä¸€ä¸ªstoreï¼Œç„¶åæ‰§è¡Œä¸‹é¢ä¸¤å¥ä»£ç å³å®Œæˆçš„Vuexçš„å¼•å…¥ã€‚</p><pre><code class="js">Vue.use(Vuex);/*å°†storeæ”¾å…¥Vueåˆ›å»ºæ—¶çš„optionä¸­*/new Vue({    el: &#39;#app&#39;,    store});</code></pre><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒVuexæ˜¯æ€æ ·æŠŠstoreæ³¨å…¥åˆ°Vueå®ä¾‹ä¸­å»çš„å‘¢ï¼Ÿ</p><p>Vue.jsæä¾›äº†<code>Vue.use</code>æ–¹æ³•ç”¨æ¥ç»™Vue.jså®‰è£…æ’ä»¶ï¼Œå†…éƒ¨é€šè¿‡è°ƒç”¨æ’ä»¶çš„installæ–¹æ³•(å½“æ’ä»¶æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™)æ¥è¿›è¡Œæ’ä»¶çš„å®‰è£…ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Vuexçš„installå®ç°ã€‚</p><pre><code class="js">/*æš´éœ²ç»™å¤–éƒ¨çš„æ’ä»¶installæ–¹æ³•ï¼Œä¾›Vue.useè°ƒç”¨å®‰è£…æ’ä»¶*/export function install (_Vue) {  if (Vue) {    /*é¿å…é‡å¤å®‰è£…ï¼ˆVue.useå†…éƒ¨ä¹Ÿä¼šæ£€æµ‹ä¸€æ¬¡æ˜¯å¦é‡å¤å®‰è£…åŒä¸€ä¸ªæ’ä»¶ï¼‰*/    if (process.env.NODE_ENV !== &#39;production&#39;) {      console.error(        &#39;[vuex] already installed. Vue.use(Vuex) should be called only once.&#39;      )    }    return  }  /*ä¿å­˜Vueï¼ŒåŒæ—¶ç”¨äºæ£€æµ‹æ˜¯å¦é‡å¤å®‰è£…*/  Vue = _Vue  /*å°†vuexInitæ··æ·†è¿›Vueçš„beforeCreate(Vue2.0)æˆ–_initæ–¹æ³•(Vue1.0)*/  applyMixin(Vue)}</code></pre><p>è¿™æ®µinstallä»£ç åšäº†ä¸¤ä»¶äº‹æƒ…ï¼Œä¸€ä»¶æ˜¯é˜²æ­¢Vuexè¢«é‡å¤å®‰è£…ï¼Œå¦ä¸€ä»¶æ˜¯æ‰§è¡ŒapplyMixinï¼Œç›®çš„æ˜¯æ‰§è¡ŒvuexInitæ–¹æ³•åˆå§‹åŒ–Vuexã€‚Vuexé’ˆå¯¹Vue1.0ä¸2.0åˆ†åˆ«è¿›è¡Œäº†ä¸åŒçš„å¤„ç†ï¼Œå¦‚æœæ˜¯Vue1.0ï¼ŒVuexä¼šå°†vuexInitæ–¹æ³•æ”¾å…¥Vueçš„_initæ–¹æ³•ä¸­ï¼Œè€Œå¯¹äºVue2.0ï¼Œåˆ™ä¼šå°†vuexinitæ··æ·†è¿›Vueçš„beforeCreacteé’©å­ä¸­ã€‚æ¥çœ‹ä¸€ä¸‹vuexInitçš„ä»£ç ã€‚</p><pre><code class="js"> /*Vuexçš„inité’©å­ï¼Œä¼šå­˜å…¥æ¯ä¸€ä¸ªVueå®ä¾‹ç­‰é’©å­åˆ—è¡¨*/  function vuexInit () {    const options = this.$options    // store injection    if (options.store) {      /*å­˜åœ¨storeå…¶å®ä»£è¡¨çš„å°±æ˜¯RootèŠ‚ç‚¹ï¼Œç›´æ¥æ‰§è¡Œstoreï¼ˆfunctionæ—¶ï¼‰æˆ–è€…ä½¿ç”¨storeï¼ˆéfunctionï¼‰*/      this.$store = typeof options.store === &#39;function&#39;        ? options.store()        : options.store    } else if (options.parent &amp;&amp; options.parent.$store) {      /*å­ç»„ä»¶ç›´æ¥ä»çˆ¶ç»„ä»¶ä¸­è·å–$storeï¼Œè¿™æ ·å°±ä¿è¯äº†æ‰€æœ‰ç»„ä»¶éƒ½å…¬ç”¨äº†å…¨å±€çš„åŒä¸€ä»½store*/      this.$store = options.parent.$store    }  }</code></pre><p>vuexInitä¼šå°è¯•ä»optionsä¸­è·å–storeï¼Œå¦‚æœå½“å‰ç»„ä»¶æ˜¯æ ¹ç»„ä»¶ï¼ˆRootèŠ‚ç‚¹ï¼‰ï¼Œåˆ™optionsä¸­ä¼šå­˜åœ¨storeï¼Œç›´æ¥è·å–èµ‹å€¼ç»™$storeå³å¯ã€‚å¦‚æœå½“å‰ç»„ä»¶éæ ¹ç»„ä»¶ï¼Œåˆ™é€šè¿‡optionsä¸­çš„parentè·å–çˆ¶ç»„ä»¶çš„$storeå¼•ç”¨ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ‰€æœ‰çš„ç»„ä»¶éƒ½è·å–åˆ°äº†åŒä¸€ä»½å†…å­˜åœ°å€çš„Storeå®ä¾‹ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸€ä¸ªç»„ä»¶ä¸­é€šè¿‡this.$storeæ„‰å¿«åœ°è®¿é—®å…¨å±€çš„Storeå®ä¾‹äº†ã€‚</p><p>é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯Storeå®ä¾‹ï¼Ÿ</p><h2 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h2><p>æˆ‘ä»¬ä¼ å…¥åˆ°æ ¹ç»„ä»¶åˆ°storeï¼Œå°±æ˜¯Storeå®ä¾‹ï¼Œç”¨Vuexæä¾›åˆ°Storeæ–¹æ³•æ„é€ ã€‚</p><pre><code class="js">export default new Vuex.Store({    strict: true,    modules: {        moduleA,        moduleB    }});</code></pre><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Storeçš„å®ç°ã€‚é¦–å…ˆæ˜¯æ„é€ å‡½æ•°ã€‚</p><a id="more"></a><pre><code class="js">constructor (options = {}) {    // Auto install if it is not done yet and `window` has `Vue`.    // To allow users to avoid auto-installation in some cases,    // this code should be placed here. See #731    /*      åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹ï¼Œå¦‚æœæ’ä»¶è¿˜æœªå®‰è£…ï¼ˆ!Vueå³åˆ¤æ–­æ˜¯å¦æœªå®‰è£…ï¼‰ï¼Œåˆ™å®ƒä¼šè‡ªåŠ¨å®‰è£…ã€‚      å®ƒå…è®¸ç”¨æˆ·åœ¨æŸäº›æƒ…å†µä¸‹é¿å…è‡ªåŠ¨å®‰è£…ã€‚    */    if (!Vue &amp;&amp; typeof window !== &#39;undefined&#39; &amp;&amp; window.Vue) {      install(window.Vue)    }    if (process.env.NODE_ENV !== &#39;production&#39;) {      assert(Vue, `must call Vue.use(Vuex) before creating a store instance.`)      assert(typeof Promise !== &#39;undefined&#39;, `vuex requires a Promise polyfill in this browser.`)      assert(this instanceof Store, `Store must be called with the new operator.`)    }    const {      /*ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«åº”ç”¨åœ¨ store ä¸Šçš„æ’ä»¶æ–¹æ³•ã€‚è¿™äº›æ’ä»¶ç›´æ¥æ¥æ”¶ store ä½œä¸ºå”¯ä¸€å‚æ•°ï¼Œå¯ä»¥ç›‘å¬ mutationï¼ˆç”¨äºå¤–éƒ¨åœ°æ•°æ®æŒä¹…åŒ–ã€è®°å½•æˆ–è°ƒè¯•ï¼‰æˆ–è€…æäº¤ mutation ï¼ˆç”¨äºå†…éƒ¨æ•°æ®ï¼Œä¾‹å¦‚ websocket æˆ– æŸäº›è§‚å¯Ÿè€…ï¼‰*/      plugins = [],      /*ä½¿ Vuex store è¿›å…¥ä¸¥æ ¼æ¨¡å¼ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä»»ä½• mutation å¤„ç†å‡½æ•°ä»¥å¤–ä¿®æ”¹ Vuex state éƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚*/      strict = false    } = options    /*ä»optionä¸­å–å‡ºstateï¼Œå¦‚æœstateæ˜¯functionåˆ™æ‰§è¡Œï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå¯¹è±¡*/    let {      state = {}    } = options    if (typeof state === &#39;function&#39;) {      state = state()    }    // store internal state    /* ç”¨æ¥åˆ¤æ–­ä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯å¦æ˜¯ç”¨mutationä¿®æ”¹stateçš„ */    this._committing = false    /* å­˜æ”¾action */    this._actions = Object.create(null)    /* å­˜æ”¾mutation */    this._mutations = Object.create(null)    /* å­˜æ”¾getter */    this._wrappedGetters = Object.create(null)    /* moduleæ”¶é›†å™¨ */    this._modules = new ModuleCollection(options)    /* æ ¹æ®namespaceå­˜æ”¾module */    this._modulesNamespaceMap = Object.create(null)    /* å­˜æ”¾è®¢é˜…è€… */    this._subscribers = []    /* ç”¨ä»¥å®ç°Watchçš„Vueå®ä¾‹ */    this._watcherVM = new Vue()    // bind commit and dispatch to self    /*å°†dispatchä¸commitè°ƒç”¨çš„thisç»‘å®šä¸ºstoreå¯¹è±¡æœ¬èº«ï¼Œå¦åˆ™åœ¨ç»„ä»¶å†…éƒ¨this.dispatchæ—¶çš„thisä¼šæŒ‡å‘ç»„ä»¶çš„vm*/    const store = this    const { dispatch, commit } = this    /* ä¸ºdispatchä¸commitç»‘å®šthisï¼ˆStoreå®ä¾‹æœ¬èº«ï¼‰ */    this.dispatch = function boundDispatch (type, payload) {      return dispatch.call(store, type, payload)    }    this.commit = function boundCommit (type, payload, options) {      return commit.call(store, type, payload, options)    }    // strict mode    /*ä¸¥æ ¼æ¨¡å¼(ä½¿ Vuex store è¿›å…¥ä¸¥æ ¼æ¨¡å¼ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä»»ä½• mutation å¤„ç†å‡½æ•°ä»¥å¤–ä¿®æ”¹ Vuex state éƒ½ä¼šæŠ›å‡ºé”™è¯¯)*/    this.strict = strict    // init root module.    // this also recursively registers all sub-modules    // and collects all module getters inside this._wrappedGetters    /*åˆå§‹åŒ–æ ¹moduleï¼Œè¿™ä¹ŸåŒæ—¶é€’å½’æ³¨å†Œäº†æ‰€æœ‰å­modleï¼Œæ”¶é›†æ‰€æœ‰moduleçš„getteråˆ°_wrappedGettersä¸­å»ï¼Œthis._modules.rootä»£è¡¨æ ¹moduleæ‰ç‹¬æœ‰ä¿å­˜çš„Moduleå¯¹è±¡*/    installModule(this, state, [], this._modules.root)    // initialize the store vm, which is responsible for the reactivity    // (also registers _wrappedGetters as computed properties)    /* é€šè¿‡vmé‡è®¾storeï¼Œæ–°å»ºVueå¯¹è±¡ä½¿ç”¨Vueå†…éƒ¨çš„å“åº”å¼å®ç°æ³¨å†Œstateä»¥åŠcomputed */    resetStoreVM(this, state)    // apply plugins    /* è°ƒç”¨æ’ä»¶ */    plugins.forEach(plugin =&gt; plugin(this))    /* devtoolæ’ä»¶ */    if (Vue.config.devtools) {      devtoolPlugin(this)    }  }</code></pre><p>Storeçš„æ„é€ ç±»é™¤äº†åˆå§‹åŒ–ä¸€äº›å†…éƒ¨å˜é‡ä»¥å¤–ï¼Œä¸»è¦æ‰§è¡Œäº†installModuleï¼ˆåˆå§‹åŒ–moduleï¼‰ä»¥åŠresetStoreVMï¼ˆé€šè¿‡VMä½¿storeâ€œå“åº”å¼â€ï¼‰ã€‚</p><h2 id="installModule"><a href="#installModule" class="headerlink" title="installModule"></a>installModule</h2><p>installModuleçš„ä½œç”¨ä¸»è¦æ˜¯ç”¨ä¸ºmoduleåŠ ä¸Šnamespaceåå­—ç©ºé—´ï¼ˆå¦‚æœæœ‰ï¼‰åï¼Œæ³¨å†Œmutationã€actionä»¥åŠgetterï¼ŒåŒæ—¶é€’å½’å®‰è£…æ‰€æœ‰å­moduleã€‚</p><pre><code class="js">/*åˆå§‹åŒ–module*/function installModule (store, rootState, path, module, hot) {  /* æ˜¯å¦æ˜¯æ ¹module */  const isRoot = !path.length  /* è·å–moduleçš„namespace */  const namespace = store._modules.getNamespace(path)  // register in namespace map  /* å¦‚æœæœ‰namespaceåˆ™åœ¨_modulesNamespaceMapä¸­æ³¨å†Œ */  if (module.namespaced) {    store._modulesNamespaceMap[namespace] = module  }  // set state  if (!isRoot &amp;&amp; !hot) {    /* è·å–çˆ¶çº§çš„state */    const parentState = getNestedState(rootState, path.slice(0, -1))    /* moduleçš„name */    const moduleName = path[path.length - 1]    store.`_withCommit`(() =&gt; {      /* å°†å­moduleè®¾ç½®ç§°å“åº”å¼çš„ */      Vue.set(parentState, moduleName, module.state)    })  }  const local = module.context = makeLocalContext(store, namespace, path)  /* éå†æ³¨å†Œmutation */  module.forEachMutation((mutation, key) =&gt; {    const namespacedType = namespace + key    registerMutation(store, namespacedType, mutation, local)  })  /* éå†æ³¨å†Œaction */  module.forEachAction((action, key) =&gt; {    const namespacedType = namespace + key    registerAction(store, namespacedType, action, local)  })  /* éå†æ³¨å†Œgetter */  module.forEachGetter((getter, key) =&gt; {    const namespacedType = namespace + key    registerGetter(store, namespacedType, getter, local)  })  /* é€’å½’å®‰è£…mudule */  module.forEachChild((child, key) =&gt; {    installModule(store, rootState, path.concat(key), child, hot)  })}</code></pre><h2 id="resetStoreVM"><a href="#resetStoreVM" class="headerlink" title="resetStoreVM"></a>resetStoreVM</h2><p>åœ¨è¯´resetStoreVMä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªå°demoã€‚</p><pre><code class="js">let globalData = {    d: &#39;hello world&#39;};new Vue({    data () {        return {            $$state: {                globalData            }        }    }});/* modify */setTimeout(() =&gt; {    globalData.d = &#39;hi~&#39;;}, 1000);Vue.prototype.globalData = globalData;/* ä»»æ„æ¨¡æ¿ä¸­ */&lt;div&gt;{{globalData.d}}&lt;/div&gt;</code></pre><p>ä¸Šè¿°ä»£ç åœ¨å…¨å±€æœ‰ä¸€ä¸ªglobalDataï¼Œå®ƒè¢«ä¼ å…¥ä¸€ä¸ªVueå¯¹è±¡çš„dataä¸­ï¼Œä¹‹ååœ¨ä»»æ„Vueæ¨¡æ¿ä¸­å¯¹è¯¥å˜é‡è¿›è¡Œå±•ç¤ºï¼Œå› ä¸ºæ­¤æ—¶globalDataå·²ç»åœ¨Vueçš„prototypeä¸Šäº†æ‰€ä»¥ç›´æ¥é€šè¿‡this.prototypeè®¿é—®ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¨¡æ¿ä¸­çš„ã€‚æ­¤æ—¶ï¼ŒsetTimeoutåœ¨1sä¹‹åå°†globalData.dè¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬å‘ç°æ¨¡æ¿ä¸­çš„globalData.då‘ç”Ÿäº†å˜åŒ–ã€‚å…¶å®ä¸Šè¿°éƒ¨åˆ†å°±æ˜¯Vuexä¾èµ–Vueæ ¸å¿ƒå®ç°æ•°æ®çš„â€œå“åº”å¼åŒ–â€ã€‚</p><p>æ¥ç€æ¥çœ‹ä»£ç ã€‚</p><pre><code class="js">/* é€šè¿‡vmé‡è®¾storeï¼Œæ–°å»ºVueå¯¹è±¡ä½¿ç”¨Vueå†…éƒ¨çš„å“åº”å¼å®ç°æ³¨å†Œstateä»¥åŠcomputed */function resetStoreVM (store, state, hot) {  /* å­˜æ”¾ä¹‹å‰çš„vmå¯¹è±¡ */  const oldVm = store._vm   // bind store public getters  store.getters = {}  const wrappedGetters = store._wrappedGetters  const computed = {}  /* é€šè¿‡Object.definePropertyä¸ºæ¯ä¸€ä¸ªgetteræ–¹æ³•è®¾ç½®getæ–¹æ³•ï¼Œæ¯”å¦‚è·å–this.$store.getters.testçš„æ—¶å€™è·å–çš„æ˜¯store._vm.testï¼Œä¹Ÿå°±æ˜¯Vueå¯¹è±¡çš„computedå±æ€§ */  forEachValue(wrappedGetters, (fn, key) =&gt; {    // use computed to leverage its lazy-caching mechanism    computed[key] = () =&gt; fn(store)    Object.defineProperty(store.getters, key, {      get: () =&gt; store._vm[key],      enumerable: true // for local getters    })  })  // use a Vue instance to store the state tree  // suppress warnings just in case the user has added  // some funky global mixins  const silent = Vue.config.silent  /* Vue.config.silentæš‚æ—¶è®¾ç½®ä¸ºtrueçš„ç›®çš„æ˜¯åœ¨newä¸€ä¸ªVueå®ä¾‹çš„è¿‡ç¨‹ä¸­ä¸ä¼šæŠ¥å‡ºä¸€åˆ‡è­¦å‘Š */  Vue.config.silent = true  /*  è¿™é‡Œnewäº†ä¸€ä¸ªVueå¯¹è±¡ï¼Œè¿ç”¨Vueå†…éƒ¨çš„å“åº”å¼å®ç°æ³¨å†Œstateä»¥åŠcomputed*/  store._vm = new Vue({    data: {      $$state: state    },    computed  })  Vue.config.silent = silent  // enable strict mode for new vm  /* ä½¿èƒ½ä¸¥æ ¼æ¨¡å¼ï¼Œä¿è¯ä¿®æ”¹storeåªèƒ½é€šè¿‡mutation */  if (store.strict) {    enableStrictMode(store)  }  if (oldVm) {    /* è§£é™¤æ—§vmçš„stateçš„å¼•ç”¨ï¼Œä»¥åŠé”€æ¯æ—§çš„Vueå¯¹è±¡ */    if (hot) {      // dispatch changes in all subscribed watchers      // to force getter re-evaluation for hot reloading.      store._withCommit(() =&gt; {        oldVm._data.$$state = null      })    }    Vue.nextTick(() =&gt; oldVm.$destroy())  }}</code></pre><p>resetStoreVMé¦–å…ˆä¼šéå†wrappedGettersï¼Œä½¿ç”¨Object.definePropertyæ–¹æ³•ä¸ºæ¯ä¸€ä¸ªgetterç»‘å®šä¸Šgetæ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç»„ä»¶é‡Œè®¿é—®this.$store.getter.testå°±ç­‰åŒäºè®¿é—®store._vm.testã€‚</p><pre><code class="js">forEachValue(wrappedGetters, (fn, key) =&gt; {  // use computed to leverage its lazy-caching mechanism  computed[key] = () =&gt; fn(store)  Object.defineProperty(store.getters, key, {    get: () =&gt; store._vm[key],    enumerable: true // for local getters  })})</code></pre><p>ä¹‹åVuexé‡‡ç”¨äº†newä¸€ä¸ªVueå¯¹è±¡æ¥å®ç°æ•°æ®çš„â€œå“åº”å¼åŒ–â€ï¼Œè¿ç”¨Vue.jså†…éƒ¨æä¾›çš„æ•°æ®åŒå‘ç»‘å®šåŠŸèƒ½æ¥å®ç°storeçš„æ•°æ®ä¸è§†å›¾çš„åŒæ­¥æ›´æ–°ã€‚</p><pre><code class="js">store._vm = new Vue({  data: {    $$state: state  },  computed})</code></pre><p>è¿™æ—¶å€™æˆ‘ä»¬è®¿é—®store._vm.testä¹Ÿå°±è®¿é—®äº†Vueå®ä¾‹ä¸­çš„å±æ€§ã€‚</p><p>è¿™ä¸¤æ­¥æ‰§è¡Œå®Œä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡this.$store.getter.testè®¿é—®vmä¸­çš„testå±æ€§äº†ã€‚</p><h2 id="ä¸¥æ ¼æ¨¡å¼"><a href="#ä¸¥æ ¼æ¨¡å¼" class="headerlink" title="ä¸¥æ ¼æ¨¡å¼"></a>ä¸¥æ ¼æ¨¡å¼</h2><p>Vuexçš„Storeæ„é€ ç±»çš„optionæœ‰ä¸€ä¸ªstrictçš„å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶Vuexæ‰§è¡Œä¸¥æ ¼æ¨¡å¼ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä¿®æ”¹stateçš„æ“ä½œå¿…é¡»é€šè¿‡mutationå®ç°ï¼Œå¦åˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><pre><code class="js">/* ä½¿èƒ½ä¸¥æ ¼æ¨¡å¼ */function enableStrictMode (store) {  store._vm.$watch(function () { return this._data.$$state }, () =&gt; {    if (process.env.NODE_ENV !== &#39;production&#39;) {      /* æ£€æµ‹storeä¸­çš„_committingçš„å€¼ï¼Œå¦‚æœæ˜¯trueä»£è¡¨ä¸æ˜¯é€šè¿‡mutationçš„æ–¹æ³•ä¿®æ”¹çš„ */      assert(store._committing, `Do not mutate vuex store state outside mutation handlers.`)    }  }, { deep: true, sync: true })}</code></pre><p>é¦–å…ˆï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒVuexä¼šåˆ©ç”¨vmçš„$watchæ–¹æ³•æ¥è§‚å¯Ÿ$$stateï¼Œä¹Ÿå°±æ˜¯Storeçš„stateï¼Œåœ¨å®ƒè¢«ä¿®æ”¹çš„æ—¶å€™è¿›å…¥å›è°ƒã€‚æˆ‘ä»¬å‘ç°ï¼Œå›è°ƒä¸­åªæœ‰ä¸€å¥è¯ï¼Œç”¨assertæ–­è¨€æ¥æ£€æµ‹store._committingï¼Œå½“store._committingä¸ºfalseçš„æ—¶å€™ä¼šè§¦å‘æ–­è¨€ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>æˆ‘ä»¬å‘ç°ï¼ŒStoreçš„commitæ–¹æ³•ä¸­ï¼Œæ‰§è¡Œmutationçš„è¯­å¥æ˜¯è¿™æ ·çš„ã€‚</p><pre><code class="js">this._withCommit(() =&gt; {  entry.forEach(function commitIterator (handler) {    handler(payload)  })})</code></pre><p>å†æ¥çœ‹çœ‹_withCommitçš„å®ç°ã€‚</p><pre><code class="js">_withCommit (fn) {  /* è°ƒç”¨withCommitä¿®æ”¹stateçš„å€¼æ—¶ä¼šå°†storeçš„committingå€¼ç½®ä¸ºtrueï¼Œå†…éƒ¨ä¼šæœ‰æ–­è¨€æ£€æŸ¥è¯¥å€¼ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹åªå…è®¸ä½¿ç”¨mutationæ¥ä¿®æ”¹storeä¸­çš„å€¼ï¼Œè€Œä¸å…è®¸ç›´æ¥ä¿®æ”¹storeçš„æ•°å€¼ */  const committing = this._committing  this._committing = true  fn()  this._committing = committing}</code></pre><p>æˆ‘ä»¬å‘ç°ï¼Œé€šè¿‡commitï¼ˆmutationï¼‰ä¿®æ”¹stateæ•°æ®çš„æ—¶å€™ï¼Œä¼šå†è°ƒç”¨mutationæ–¹æ³•ä¹‹å‰å°†committingç½®ä¸ºtrueï¼Œæ¥ä¸‹æ¥å†é€šè¿‡mutationå‡½æ•°ä¿®æ”¹stateä¸­çš„æ•°æ®ï¼Œè¿™æ—¶å€™è§¦å‘$watchä¸­çš„å›è°ƒæ–­è¨€committingæ˜¯ä¸ä¼šæŠ›å‡ºå¼‚å¸¸çš„ï¼ˆæ­¤æ—¶committingä¸ºtrueï¼‰ã€‚è€Œå½“æˆ‘ä»¬ç›´æ¥ä¿®æ”¹stateçš„æ•°æ®æ—¶ï¼Œè§¦å‘$watchçš„å›è°ƒæ‰§è¡Œæ–­è¨€ï¼Œè¿™æ—¶committingä¸ºfalseï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è¿™å°±æ˜¯Vuexçš„ä¸¥æ ¼æ¨¡å¼çš„å®ç°ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹Storeæä¾›çš„ä¸€äº›APIã€‚</p><h2 id="commitï¼ˆmutationï¼‰"><a href="#commitï¼ˆmutationï¼‰" class="headerlink" title="commitï¼ˆmutationï¼‰"></a>commitï¼ˆmutationï¼‰</h2><pre><code class="js">/* è°ƒç”¨mutationçš„commitæ–¹æ³• */commit (_type, _payload, _options) {  // check object-style commit  /* æ ¡éªŒå‚æ•° */  const {    type,    payload,    options  } = unifyObjectStyle(_type, _payload, _options)  const mutation = { type, payload }  /* å–å‡ºtypeå¯¹åº”çš„mutationçš„æ–¹æ³• */  const entry = this._mutations[type]  if (!entry) {    if (process.env.NODE_ENV !== &#39;production&#39;) {      console.error(`[vuex] unknown mutation type: ${type}`)    }    return  }  /* æ‰§è¡Œmutationä¸­çš„æ‰€æœ‰æ–¹æ³• */  this._withCommit(() =&gt; {    entry.forEach(function commitIterator (handler) {      handler(payload)    })  })  /* é€šçŸ¥æ‰€æœ‰è®¢é˜…è€… */  this._subscribers.forEach(sub =&gt; sub(mutation, this.state))  if (    process.env.NODE_ENV !== &#39;production&#39; &amp;&amp;    options &amp;&amp; options.silent  ) {    console.warn(      `[vuex] mutation type: ${type}. Silent option has been removed. ` +      &#39;Use the filter functionality in the vue-devtools&#39;    )  }}</code></pre><p>commitæ–¹æ³•ä¼šæ ¹æ®typeæ‰¾åˆ°å¹¶è°ƒç”¨_mutationsä¸­çš„æ‰€æœ‰typeå¯¹åº”çš„mutationæ–¹æ³•ï¼Œæ‰€ä»¥å½“æ²¡æœ‰namespaceçš„æ—¶å€™ï¼Œcommitæ–¹æ³•ä¼šè§¦å‘æ‰€æœ‰moduleä¸­çš„mutationæ–¹æ³•ã€‚å†æ‰§è¡Œå®Œæ‰€æœ‰çš„mutationä¹‹åä¼šæ‰§è¡Œ_subscribersä¸­çš„æ‰€æœ‰è®¢é˜…è€…ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹_subscribersæ˜¯ä»€ä¹ˆã€‚</p><p>Storeç»™å¤–éƒ¨æä¾›äº†ä¸€ä¸ªsubscribeæ–¹æ³•ï¼Œç”¨ä»¥æ³¨å†Œä¸€ä¸ªè®¢é˜…å‡½æ•°ï¼Œä¼špushåˆ°Storeå®ä¾‹çš„_subscribersä¸­ï¼ŒåŒæ—¶è¿”å›ä¸€ä¸ªä»_subscribersä¸­æ³¨é”€è¯¥è®¢é˜…è€…çš„æ–¹æ³•ã€‚</p><pre><code class="js">/* æ³¨å†Œä¸€ä¸ªè®¢é˜…å‡½æ•°ï¼Œè¿”å›å–æ¶ˆè®¢é˜…çš„å‡½æ•° */subscribe (fn) {  const subs = this._subscribers  if (subs.indexOf(fn) &lt; 0) {    subs.push(fn)  }  return () =&gt; {    const i = subs.indexOf(fn)    if (i &gt; -1) {      subs.splice(i, 1)    }  }}</code></pre><p>åœ¨commitç»“æŸä»¥ååˆ™ä¼šè°ƒç”¨è¿™äº›_subscribersä¸­çš„è®¢é˜…è€…ï¼Œè¿™ä¸ªè®¢é˜…è€…æ¨¡å¼æä¾›ç»™å¤–éƒ¨ä¸€ä¸ªç›‘è§†stateå˜åŒ–çš„å¯èƒ½ã€‚stateé€šè¿‡mutationæ”¹å˜æ—¶ï¼Œå¯ä»¥æœ‰æ•ˆè¡¥è·è¿™äº›å˜åŒ–ã€‚</p><h2 id="dispatchï¼ˆactionï¼‰"><a href="#dispatchï¼ˆactionï¼‰" class="headerlink" title="dispatchï¼ˆactionï¼‰"></a>dispatchï¼ˆactionï¼‰</h2><p>æ¥çœ‹ä¸€ä¸‹dispatchçš„å®ç°ã€‚</p><pre><code class="js">/* è°ƒç”¨actionçš„dispatchæ–¹æ³• */dispatch (_type, _payload) {  // check object-style dispatch  const {    type,    payload  } = unifyObjectStyle(_type, _payload)  /* actionsä¸­å–å‡ºtypeå¯¹åº”çš„ation */  const entry = this._actions[type]  if (!entry) {    if (process.env.NODE_ENV !== &#39;production&#39;) {      console.error(`[vuex] unknown action type: ${type}`)    }    return  }  /* æ˜¯æ•°ç»„åˆ™åŒ…è£…Promiseå½¢æˆä¸€ä¸ªæ–°çš„Promiseï¼Œåªæœ‰ä¸€ä¸ªåˆ™ç›´æ¥è¿”å›ç¬¬0ä¸ª */  return entry.length &gt; 1    ? Promise.all(entry.map(handler =&gt; handler(payload)))    : entry[0](payload)}</code></pre><p>ä»¥åŠregisterActionæ—¶å€™åšçš„äº‹æƒ…ã€‚</p><pre><code class="js">/* éå†æ³¨å†Œaction */function registerAction (store, type, handler, local) {  /* å–å‡ºtypeå¯¹åº”çš„action */  const entry = store._actions[type] || (store._actions[type] = [])  entry.push(function wrappedActionHandler (payload, cb) {    let res = handler.call(store, {      dispatch: local.dispatch,      commit: local.commit,      getters: local.getters,      state: local.state,      rootGetters: store.getters,      rootState: store.state    }, payload, cb)    /* åˆ¤æ–­æ˜¯å¦æ˜¯Promise */    if (!isPromise(res)) {      /* ä¸æ˜¯Promiseå¯¹è±¡çš„æ—¶å€™è½¬åŒ–ç§°Promiseå¯¹è±¡ */      res = Promise.resolve(res)    }    if (store._devtoolHook) {      /* å­˜åœ¨devtoolæ’ä»¶çš„æ—¶å€™è§¦å‘vuexçš„errorç»™devtool */      return res.catch(err =&gt; {        store._devtoolHook.emit(&#39;vuex:error&#39;, err)        throw err      })    } else {      return res    }  })}</code></pre><p>å› ä¸ºregisterActionçš„æ—¶å€™å°†pushè¿›_actionsçš„actionè¿›è¡Œäº†ä¸€å±‚å°è£…ï¼ˆwrappedActionHandlerï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿›è¡Œdispatchçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸­è·å–stateã€commitç­‰æ–¹æ³•ã€‚ä¹‹åï¼Œæ‰§è¡Œç»“æœresä¼šè¢«è¿›è¡Œåˆ¤æ–­æ˜¯å¦æ˜¯Promiseï¼Œä¸æ˜¯åˆ™ä¼šè¿›è¡Œä¸€å±‚å°è£…ï¼Œå°†å…¶è½¬åŒ–æˆPromiseå¯¹è±¡ã€‚dispatchæ—¶åˆ™ä»_actionsä¸­å–å‡ºï¼Œåªæœ‰ä¸€ä¸ªçš„æ—¶å€™ç›´æ¥è¿”å›ï¼Œå¦åˆ™ç”¨Promise.allå¤„ç†å†è¿”å›ã€‚</p><h2 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h2><pre><code class="js">/* è§‚å¯Ÿä¸€ä¸ªgetteræ–¹æ³• */watch (getter, cb, options) {  if (process.env.NODE_ENV !== &#39;production&#39;) {    assert(typeof getter === &#39;function&#39;, `store.watch only accepts a function.`)  }  return this._watcherVM.$watch(() =&gt; getter(this.state, this.getters), cb, options)}</code></pre><p>ç†Ÿæ‚‰Vueçš„æœ‹å‹åº”è¯¥å¾ˆç†Ÿæ‚‰watchè¿™ä¸ªæ–¹æ³•ã€‚è¿™é‡Œé‡‡ç”¨äº†æ¯”è¾ƒå·§å¦™çš„è®¾è®¡ï¼Œ_watcherVMæ˜¯ä¸€ä¸ªVueçš„å®ä¾‹ï¼Œæ‰€ä»¥watchå°±å¯ä»¥ç›´æ¥é‡‡ç”¨äº†Vueå†…éƒ¨çš„watchç‰¹æ€§æä¾›äº†ä¸€ç§è§‚å¯Ÿæ•°æ®getterå˜åŠ¨çš„æ–¹æ³•ã€‚</p><h2 id="registerModule"><a href="#registerModule" class="headerlink" title="registerModule"></a>registerModule</h2><pre><code class="js">/* æ³¨å†Œä¸€ä¸ªåŠ¨æ€moduleï¼Œå½“ä¸šåŠ¡è¿›è¡Œå¼‚æ­¥åŠ è½½çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¯¥æ¥å£è¿›è¡Œæ³¨å†ŒåŠ¨æ€module */registerModule (path, rawModule) {  /* è½¬åŒ–ç§°Array */  if (typeof path === &#39;string&#39;) path = [path]  if (process.env.NODE_ENV !== &#39;production&#39;) {    assert(Array.isArray(path), `module path must be a string or an Array.`)    assert(path.length &gt; 0, &#39;cannot register the root module by using registerModule.&#39;)  }  /*æ³¨å†Œ*/  this._modules.register(path, rawModule)  /*åˆå§‹åŒ–module*/  installModule(this, this.state, path, this._modules.get(path))  // reset store to update getters...  /* é€šè¿‡vmé‡è®¾storeï¼Œæ–°å»ºVueå¯¹è±¡ä½¿ç”¨Vueå†…éƒ¨çš„å“åº”å¼å®ç°æ³¨å†Œstateä»¥åŠcomputed */  resetStoreVM(this, this.state)}</code></pre><p>registerModuleç”¨ä»¥æ³¨å†Œä¸€ä¸ªåŠ¨æ€æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯åœ¨storeåˆ›å»ºä»¥åå†æ³¨å†Œæ¨¡å—çš„æ—¶å€™ç”¨è¯¥æ¥å£ã€‚å†…éƒ¨å®ç°å®é™…ä¸Šä¹Ÿåªæœ‰installModuleä¸resetStoreVMä¸¤ä¸ªæ­¥éª¤ï¼Œå‰é¢å·²ç»è®²è¿‡ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚</p><h2 id="unregisterModule"><a href="#unregisterModule" class="headerlink" title="unregisterModule"></a>unregisterModule</h2><pre><code class="js"> /* æ³¨é”€ä¸€ä¸ªåŠ¨æ€module */unregisterModule (path) {  /* è½¬åŒ–ç§°Array */  if (typeof path === &#39;string&#39;) path = [path]  if (process.env.NODE_ENV !== &#39;production&#39;) {    assert(Array.isArray(path), `module path must be a string or an Array.`)  }  /*æ³¨é”€*/  this._modules.unregister(path)  this._withCommit(() =&gt; {    /* è·å–çˆ¶çº§çš„state */    const parentState = getNestedState(this.state, path.slice(0, -1))    /* ä»çˆ¶çº§ä¸­åˆ é™¤ */    Vue.delete(parentState, path[path.length - 1])  })  /* é‡åˆ¶store */  resetStore(this)}</code></pre><p>åŒæ ·ï¼Œä¸registerModuleå¯¹åº”çš„æ–¹æ³•unregisterModuleï¼ŒåŠ¨æ€æ³¨é”€æ¨¡å—ã€‚å®ç°æ–¹æ³•æ˜¯å…ˆä»stateä¸­åˆ é™¤æ¨¡å—ï¼Œç„¶åç”¨resetStoreæ¥é‡åˆ¶storeã€‚</p><h2 id="resetStore"><a href="#resetStore" class="headerlink" title="resetStore"></a>resetStore</h2><pre><code class="js">/* é‡åˆ¶store */function resetStore (store, hot) {  store._actions = Object.create(null)  store._mutations = Object.create(null)  store._wrappedGetters = Object.create(null)  store._modulesNamespaceMap = Object.create(null)  const state = store.state  // init all modules  installModule(store, state, [], store._modules.root, true)  // reset vm  resetStoreVM(store, state, hot)}</code></pre><p>è¿™é‡Œçš„resetStoreå…¶å®ä¹Ÿå°±æ˜¯å°†storeä¸­çš„_actionsç­‰è¿›è¡Œåˆå§‹åŒ–ä»¥åï¼Œé‡æ–°æ‰§è¡ŒinstallModuleä¸resetStoreVMæ¥åˆå§‹åŒ–moduleä»¥åŠç”¨Vueç‰¹æ€§ä½¿å…¶â€œå“åº”å¼åŒ–â€ï¼Œè¿™è·Ÿæ„é€ å‡½æ•°ä¸­çš„æ˜¯ä¸€è‡´çš„ã€‚</p><h2 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h2><p>Vueæä¾›äº†ä¸€ä¸ªéå¸¸å¥½ç”¨çš„æ’ä»¶Vue.js devtools</p><pre><code class="js">/* ä»windowå¯¹è±¡çš„__VUE_DEVTOOLS_GLOBAL_HOOK__ä¸­è·å–devtoolæ’ä»¶ */const devtoolHook =  typeof window !== &#39;undefined&#39; &amp;&amp;  window.__VUE_DEVTOOLS_GLOBAL_HOOK__export default function devtoolPlugin (store) {  if (!devtoolHook) return  /* devtollæ’ä»¶å®ä¾‹å­˜å‚¨åœ¨storeçš„_devtoolHookä¸Š */  store._devtoolHook = devtoolHook  /* å‡ºå‘vuexçš„åˆå§‹åŒ–äº‹ä»¶ï¼Œå¹¶å°†storeçš„å¼•ç”¨åœ°å€ä¼ ç»™deltoolæ’ä»¶ï¼Œä½¿æ’ä»¶è·å–storeçš„å®ä¾‹ */  devtoolHook.emit(&#39;vuex:init&#39;, store)  /* ç›‘å¬travel-to-stateäº‹ä»¶ */  devtoolHook.on(&#39;vuex:travel-to-state&#39;, targetState =&gt; {    /* é‡åˆ¶state */    store.replaceState(targetState)  })  /* è®¢é˜…storeçš„å˜åŒ– */  store.subscribe((mutation, state) =&gt; {    devtoolHook.emit(&#39;vuex:mutation&#39;, mutation, state)  })}</code></pre><p>å¦‚æœå·²ç»å®‰è£…äº†è¯¥æ’ä»¶ï¼Œåˆ™ä¼šåœ¨windowså¯¹è±¡ä¸Šæš´éœ²ä¸€ä¸ª<strong>VUE_DEVTOOLS_GLOBAL_HOOK</strong>ã€‚devtoolHookç”¨åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šè§¦å‘â€œvuex:initâ€äº‹ä»¶é€šçŸ¥æ’ä»¶ï¼Œç„¶åé€šè¿‡onæ–¹æ³•ç›‘å¬â€œvuex:travel-to-stateâ€äº‹ä»¶æ¥é‡ç½®stateã€‚æœ€åé€šè¿‡Storeçš„subscribeæ–¹æ³•æ¥æ·»åŠ ä¸€ä¸ªè®¢é˜…è€…ï¼Œåœ¨è§¦å‘commitæ–¹æ³•ä¿®æ”¹mutationæ•°æ®ä»¥åï¼Œè¯¥è®¢é˜…è€…ä¼šè¢«é€šçŸ¥ï¼Œä»è€Œè§¦å‘â€œvuex:mutationâ€äº‹ä»¶ã€‚</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>Vuexæ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„åº“ï¼Œä»£ç é‡ä¸å¤šä¸”ç»“æ„æ¸…æ™°ï¼Œéå¸¸é€‚åˆç ”ç©¶å­¦ä¹ å…¶å†…éƒ¨å®ç°ã€‚æœ€è¿‘çš„ä¸€ç³»åˆ—æºç é˜…è¯»ä¹Ÿä½¿æˆ‘è‡ªå·±å—ç›ŠåŒªæµ…ï¼Œå†™è¿™ç¯‡æ–‡ç« ä¹Ÿå¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°æ›´å¤šæƒ³è¦å­¦ä¹ æ¢ç´¢Vuexå†…éƒ¨å®ç°åŸç†çš„åŒå­¦ã€‚</p><p><a href="https://github.com/answershuto/learnVue/blob/master/docs/Vuex%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.MarkDown" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vuex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue.jså¼‚æ­¥æ›´æ–°DOMç­–ç•¥åŠnextTick</title>
      <link href="/2019/01/01/Vue/Vue-js%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0DOM%E7%AD%96%E7%95%A5%E5%8F%8AnextTick/"/>
      <url>/2019/01/01/Vue/Vue-js%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0DOM%E7%AD%96%E7%95%A5%E5%8F%8AnextTick/</url>
      
        <content type="html"><![CDATA[<h2 id="æ“ä½œDOM"><a href="#æ“ä½œDOM" class="headerlink" title="æ“ä½œDOM"></a>æ“ä½œDOM</h2><p>åœ¨ä½¿ç”¨vue.jsçš„æ—¶å€™ï¼Œæœ‰æ—¶å€™å› ä¸ºä¸€äº›ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯ï¼Œä¸å¾—ä¸å»æ“ä½œDOMï¼Œæ¯”å¦‚è¿™æ ·ï¼š</p><pre><code class="html">&lt;template&gt;  &lt;div&gt;    &lt;div ref=&quot;test&quot;&gt;{{test}}&lt;/div&gt;    &lt;button @click=&quot;handleClick&quot;&gt;tet&lt;/button&gt;  &lt;/div&gt;&lt;/template&gt;</code></pre><pre><code class="js">export default {    data () {        return {            test: &#39;begin&#39;        };    },    methods () {        handleClick () {            this.test = &#39;end&#39;;            console.log(this.$refs.test.innerText);//æ‰“å°â€œbeginâ€        }    }}</code></pre><p>æ‰“å°çš„ç»“æœæ˜¯beginï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬æ˜æ˜å·²ç»å°†testè®¾ç½®æˆäº†â€œendâ€ï¼Œè·å–çœŸå®DOMèŠ‚ç‚¹çš„innerTextå´æ²¡æœ‰å¾—åˆ°æˆ‘ä»¬é¢„æœŸä¸­çš„â€œendâ€ï¼Œè€Œæ˜¯å¾—åˆ°ä¹‹å‰çš„å€¼â€œbeginâ€å‘¢ï¼Ÿ</p><h2 id="Watcheré˜Ÿåˆ—"><a href="#Watcheré˜Ÿåˆ—" class="headerlink" title="Watcheré˜Ÿåˆ—"></a>Watcheré˜Ÿåˆ—</h2><p>å¸¦ç€ç–‘é—®ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†Vue.jsæºç çš„Watchå®ç°ã€‚å½“æŸä¸ªå“åº”å¼æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå®ƒçš„setterå‡½æ•°ä¼šé€šçŸ¥é—­åŒ…ä¸­çš„Depï¼ŒDepåˆ™ä¼šè°ƒç”¨å®ƒç®¡ç†çš„æ‰€æœ‰Watchå¯¹è±¡ã€‚è§¦å‘Watchå¯¹è±¡çš„updateå®ç°ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹updateçš„å®ç°ã€‚</p><pre><code class="js">update () {    /* istanbul ignore else */    if (this.lazy) {        this.dirty = true    } else if (this.sync) {        /*åŒæ­¥åˆ™æ‰§è¡Œrunç›´æ¥æ¸²æŸ“è§†å›¾*/        this.run()    } else {        /*å¼‚æ­¥æ¨é€åˆ°è§‚å¯Ÿè€…é˜Ÿåˆ—ä¸­ï¼Œä¸‹ä¸€ä¸ªtickæ—¶è°ƒç”¨ã€‚*/        queueWatcher(this)    }}</code></pre><p>æˆ‘ä»¬å‘ç°Vue.jsé»˜è®¤æ˜¯ä½¿ç”¨å¼‚æ­¥æ‰§è¡ŒDOMæ›´æ–°ã€‚ å½“å¼‚æ­¥æ‰§è¡Œupdateçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨queueWatcherå‡½æ•°ã€‚</p><pre><code class="js">//å°†ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡pushè¿›è§‚å¯Ÿè€…é˜Ÿåˆ—ï¼Œåœ¨é˜Ÿåˆ—ä¸­å·²ç»å­˜åœ¨ç›¸åŒçš„idåˆ™è¯¥è§‚å¯Ÿè€…å¯¹è±¡å°†è¢«è·³è¿‡ï¼Œé™¤éå®ƒæ˜¯åœ¨é˜Ÿåˆ—è¢«åˆ·æ–°æ—¶æ¨é€*/export function queueWatcher (watcher: Watcher) {  /*è·å–watcherçš„id*/  const id = watcher.id  /*æ£€éªŒidæ˜¯å¦å­˜åœ¨ï¼Œå·²ç»å­˜åœ¨åˆ™ç›´æ¥è·³è¿‡ï¼Œä¸å­˜åœ¨åˆ™æ ‡è®°å“ˆå¸Œè¡¨hasï¼Œç”¨äºä¸‹æ¬¡æ£€éªŒ*/  if (has[id] == null) {    has[id] = true    if (!flushing) {      /*å¦‚æœæ²¡æœ‰flushæ‰ï¼Œç›´æ¥pushåˆ°é˜Ÿåˆ—ä¸­å³å¯*/      queue.push(watcher)    } else {      // if already flushing, splice the watcher based on its id      // if already past its id, it will be run next immediately.      let i = queue.length - 1      while (i &gt;= 0 &amp;&amp; queue[i].id &gt; watcher.id) {        i--      }      queue.splice(Math.max(i, index) + 1, 0, watcher)    }    // queue the flush    if (!waiting) {      waiting = true      nextTick(flushSchedulerQueue)    }  }}</code></pre><a id="more"></a><p>æŸ¥çœ‹queueWatcherçš„æºç æˆ‘ä»¬å‘ç°ï¼ŒWatchå¯¹è±¡å¹¶ä¸æ˜¯ç«‹å³æ›´æ–°è§†å›¾ï¼Œè€Œæ˜¯è¢«pushè¿›äº†ä¸€ä¸ªé˜Ÿåˆ—queueï¼Œæ­¤æ—¶çŠ¶æ€å¤„äºwaitingçš„çŠ¶æ€ï¼Œè¿™æ—¶å€™ä¼šç»§ç»­ä¼šæœ‰Watchå¯¹è±¡è¢«pushè¿›è¿™ä¸ªé˜Ÿåˆ—queueï¼Œç­‰åˆ°ä¸‹ä¸€ä¸ªtickè¿è¡Œæ—¶ï¼Œè¿™äº›Watchå¯¹è±¡æ‰ä¼šè¢«éå†å–å‡ºï¼Œæ›´æ–°è§†å›¾ã€‚åŒæ—¶ï¼Œidé‡å¤çš„Watcherä¸ä¼šè¢«å¤šæ¬¡åŠ å…¥åˆ°queueä¸­å»ï¼Œå› ä¸ºåœ¨æœ€ç»ˆæ¸²æŸ“æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å…³å¿ƒæ•°æ®çš„æœ€ç»ˆç»“æœã€‚</p><p>é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯ä¸‹ä¸€ä¸ªtickï¼Ÿ</p><h2 id="nextTick"><a href="#nextTick" class="headerlink" title="nextTick"></a>nextTick</h2><p>vue.jsæä¾›äº†ä¸€ä¸ª<code>nextTick</code>å‡½æ•°ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ä¸Šé¢è°ƒç”¨çš„nextTickã€‚</p><p>nextTickçš„å®ç°æ¯”è¾ƒç®€å•ï¼Œæ‰§è¡Œçš„ç›®çš„æ˜¯åœ¨microtaskæˆ–è€…taskä¸­æ¨å…¥ä¸€ä¸ªfuntionï¼Œåœ¨å½“å‰æ ˆæ‰§è¡Œå®Œæ¯•ï¼ˆä¹Ÿè¡Œè¿˜ä¼šæœ‰ä¸€äº›æ’åœ¨å‰é¢çš„éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼‰ä»¥åæ‰§è¡ŒnextTickä¼ å…¥çš„funtionï¼Œçœ‹ä¸€ä¸‹æºç </p><pre><code class="js">/** * Defer a task to execute it asynchronously. */ /*    å»¶è¿Ÿä¸€ä¸ªä»»åŠ¡ä½¿å…¶å¼‚æ­¥æ‰§è¡Œï¼Œåœ¨ä¸‹ä¸€ä¸ªtickæ—¶æ‰§è¡Œï¼Œä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªfunction    è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯åœ¨taskæˆ–è€…microtaskä¸­æ¨å…¥ä¸€ä¸ªtimerFuncï¼Œåœ¨å½“å‰è°ƒç”¨æ ˆæ‰§è¡Œå®Œä»¥åä»¥æ­¤æ‰§è¡Œç›´åˆ°æ‰§è¡Œåˆ°timerFunc    ç›®çš„æ˜¯å»¶è¿Ÿåˆ°å½“å‰è°ƒç”¨æ ˆæ‰§è¡Œå®Œä»¥åæ‰§è¡Œ*/export const nextTick = (function () {  /*å­˜æ”¾å¼‚æ­¥æ‰§è¡Œçš„å›è°ƒ*/  const callbacks = []  /*ä¸€ä¸ªæ ‡è®°ä½ï¼Œå¦‚æœå·²ç»æœ‰timerFuncè¢«æ¨é€åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­å»åˆ™ä¸éœ€è¦é‡å¤æ¨é€*/  let pending = false  /*ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘å‡½æ•°å°†è¢«æ¨é€åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰åˆ°ä¸»çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œæ—¶ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„timerFuncè¢«è°ƒç”¨*/  let timerFunc  /*ä¸‹ä¸€ä¸ªtickæ—¶çš„å›è°ƒ*/  function nextTickHandler () {    /*ä¸€ä¸ªæ ‡è®°ä½ï¼Œæ ‡è®°ç­‰å¾…çŠ¶æ€ï¼ˆå³å‡½æ•°å·²ç»è¢«æ¨å…¥ä»»åŠ¡é˜Ÿåˆ—æˆ–è€…ä¸»çº¿ç¨‹ï¼Œå·²ç»åœ¨ç­‰å¾…å½“å‰æ ˆæ‰§è¡Œå®Œæ¯•å»æ‰§è¡Œï¼‰ï¼Œè¿™æ ·å°±ä¸éœ€è¦åœ¨pushå¤šä¸ªå›è°ƒåˆ°callbacksæ—¶å°†timerFuncå¤šæ¬¡æ¨å…¥ä»»åŠ¡é˜Ÿåˆ—æˆ–è€…ä¸»çº¿ç¨‹*/    pending = false    /*æ‰§è¡Œæ‰€æœ‰callback*/    const copies = callbacks.slice(0)    callbacks.length = 0    for (let i = 0; i &lt; copies.length; i++) {      copies[i]()    }  }  // the nextTick behavior leverages the microtask queue, which can be accessed  // via either native Promise.then or MutationObserver.  // MutationObserver has wider support, however it is seriously bugged in  // UIWebView in iOS &gt;= 9.3.3 when triggered in touch event handlers. It  // completely stops working after triggering a few times... so, if native  // Promise is available, we will use it:  /* istanbul ignore if */  /*    è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼Œä¸€å…±æœ‰Promiseã€MutationObserverä»¥åŠsetTimeoutä¸‰ç§å°è¯•å¾—åˆ°timerFuncçš„æ–¹æ³•    ä¼˜å…ˆä½¿ç”¨Promiseï¼Œåœ¨Promiseä¸å­˜åœ¨çš„æƒ…å†µä¸‹ä½¿ç”¨MutationObserverï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šåœ¨microtaskä¸­æ‰§è¡Œï¼Œä¼šæ¯”setTimeoutæ›´æ—©æ‰§è¡Œï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨ã€‚    å¦‚æœä¸Šè¿°ä¸¤ç§æ–¹æ³•éƒ½ä¸æ”¯æŒçš„ç¯å¢ƒåˆ™ä¼šä½¿ç”¨setTimeoutï¼Œåœ¨taskå°¾éƒ¨æ¨å…¥è¿™ä¸ªå‡½æ•°ï¼Œç­‰å¾…è°ƒç”¨æ‰§è¡Œã€‚    å‚è€ƒï¼šhttps://www.zhihu.com/question/55364497  */  if (typeof Promise !== &#39;undefined&#39; &amp;&amp; isNative(Promise)) {    /*ä½¿ç”¨Promise*/    var p = Promise.resolve()    var logError = err =&gt; { console.error(err) }    timerFunc = () =&gt; {      p.then(nextTickHandler).catch(logError)      // in problematic UIWebViews, Promise.then doesn&#39;t completely break, but      // it can get stuck in a weird state where callbacks are pushed into the      // microtask queue but the queue isn&#39;t being flushed, until the browser      // needs to do some other work, e.g. handle a timer. Therefore we can      // &quot;force&quot; the microtask queue to be flushed by adding an empty timer.      if (isIOS) setTimeout(noop)    }  } else if (typeof MutationObserver !== &#39;undefined&#39; &amp;&amp; (    isNative(MutationObserver) ||    // PhantomJS and iOS 7.x    MutationObserver.toString() === &#39;[object MutationObserverConstructor]&#39;  )) {    // use MutationObserver where native Promise is not available,    // e.g. PhantomJS IE11, iOS7, Android 4.4    /*æ–°å»ºä¸€ä¸ªtextNodeçš„DOMå¯¹è±¡ï¼Œç”¨MutationObserverç»‘å®šè¯¥DOMå¹¶æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œåœ¨DOMå˜åŒ–çš„æ—¶å€™åˆ™ä¼šè§¦å‘å›è°ƒ,è¯¥å›è°ƒä¼šè¿›å…¥ä¸»çº¿ç¨‹ï¼ˆæ¯”ä»»åŠ¡é˜Ÿåˆ—ä¼˜å…ˆæ‰§è¡Œï¼‰ï¼Œå³textNode.data = String(counter)æ—¶ä¾¿ä¼šè§¦å‘å›è°ƒ*/    var counter = 1    var observer = new MutationObserver(nextTickHandler)    var textNode = document.createTextNode(String(counter))    observer.observe(textNode, {      characterData: true    })    timerFunc = () =&gt; {      counter = (counter + 1) % 2      textNode.data = String(counter)    }  } else {    // fallback to setTimeout    /* istanbul ignore next */    /*ä½¿ç”¨setTimeoutå°†å›è°ƒæ¨å…¥ä»»åŠ¡é˜Ÿåˆ—å°¾éƒ¨*/    timerFunc = () =&gt; {      setTimeout(nextTickHandler, 0)    }  }  /*    æ¨é€åˆ°é˜Ÿåˆ—ä¸­ä¸‹ä¸€ä¸ªtickæ—¶æ‰§è¡Œ    cb å›è°ƒå‡½æ•°    ctx ä¸Šä¸‹æ–‡  */  return function queueNextTick (cb?: Function, ctx?: Object) {    let _resolve    /*cbå­˜åˆ°callbacksä¸­*/    callbacks.push(() =&gt; {      if (cb) {        try {          cb.call(ctx)        } catch (e) {          handleError(e, ctx, &#39;nextTick&#39;)        }      } else if (_resolve) {        _resolve(ctx)      }    })    if (!pending) {      pending = true      timerFunc()    }    if (!cb &amp;&amp; typeof Promise !== &#39;undefined&#39;) {      return new Promise((resolve, reject) =&gt; {        _resolve = resolve      })    }  }})()</code></pre><p>å®ƒæ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°,è¿”å›ä¸€ä¸ªqueueNextTickæ¥å£ã€‚</p><p>ä¼ å…¥çš„cbä¼šè¢«pushè¿›callbacksä¸­å­˜æ”¾èµ·æ¥ï¼Œç„¶åæ‰§è¡ŒtimerFuncï¼ˆpendingæ˜¯ä¸€ä¸ªçŠ¶æ€æ ‡è®°ï¼Œä¿è¯timerFuncåœ¨ä¸‹ä¸€ä¸ªtickä¹‹å‰åªæ‰§è¡Œä¸€æ¬¡ï¼‰ã€‚</p><p>timerFuncæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>çœ‹äº†æºç å‘ç°timerFuncä¼šæ£€æµ‹å½“å‰ç¯å¢ƒè€Œä¸åŒå®ç°ï¼Œå…¶å®å°±æ˜¯æŒ‰ç…§Promiseï¼ŒMutationObserverï¼ŒsetTimeoutä¼˜å…ˆçº§ï¼Œå“ªä¸ªå­˜åœ¨ä½¿ç”¨å“ªä¸ªï¼Œæœ€ä¸æµçš„ç¯å¢ƒä¸‹ä½¿ç”¨setTimeoutã€‚</p><p>è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼Œä¸€å…±æœ‰Promiseã€MutationObserverä»¥åŠsetTimeoutä¸‰ç§å°è¯•å¾—åˆ°timerFuncçš„æ–¹æ³•ã€‚ ä¼˜å…ˆä½¿ç”¨Promiseï¼Œåœ¨Promiseä¸å­˜åœ¨çš„æƒ…å†µä¸‹ä½¿ç”¨MutationObserverï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•çš„å›è°ƒå‡½æ•°éƒ½ä¼šåœ¨microtaskä¸­æ‰§è¡Œï¼Œå®ƒä»¬ä¼šæ¯”setTimeoutæ›´æ—©æ‰§è¡Œï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨ã€‚ å¦‚æœä¸Šè¿°ä¸¤ç§æ–¹æ³•éƒ½ä¸æ”¯æŒçš„ç¯å¢ƒåˆ™ä¼šä½¿ç”¨setTimeoutï¼Œåœ¨taskå°¾éƒ¨æ¨å…¥è¿™ä¸ªå‡½æ•°ï¼Œç­‰å¾…è°ƒç”¨æ‰§è¡Œã€‚</p><p>ä¸ºä»€ä¹ˆè¦ä¼˜å…ˆä½¿ç”¨microtaskï¼Ÿæˆ‘åœ¨é¡¾è½¶çµåœ¨çŸ¥ä¹çš„å›ç­”ä¸­å­¦ä¹ åˆ°ï¼š</p><ul><li>JS çš„ event loop æ‰§è¡Œæ—¶ä¼šåŒºåˆ† task å’Œ microtaskï¼Œå¼•æ“åœ¨æ¯ä¸ª task æ‰§è¡Œå®Œæ¯•ï¼Œä»é˜Ÿåˆ—ä¸­å–ä¸‹ä¸€ä¸ª task æ¥æ‰§è¡Œä¹‹å‰ï¼Œä¼šå…ˆæ‰§è¡Œå®Œæ‰€æœ‰ microtask é˜Ÿåˆ—ä¸­çš„ microtaskã€‚<br>setTimeout å›è°ƒä¼šè¢«åˆ†é…åˆ°ä¸€ä¸ªæ–°çš„ task ä¸­æ‰§è¡Œï¼Œè€Œ Promise çš„ resolverã€MutationObserver çš„å›è°ƒéƒ½ä¼šè¢«å®‰æ’åˆ°ä¸€ä¸ªæ–°çš„ microtask ä¸­æ‰§è¡Œï¼Œä¼šæ¯” setTimeout äº§ç”Ÿçš„ task å…ˆæ‰§è¡Œã€‚<br>è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ microtaskï¼Œä¼˜å…ˆä½¿ç”¨ Promiseï¼Œå¦‚æœæµè§ˆå™¨ä¸æ”¯æŒï¼Œå†å°è¯• MutationObserverã€‚<br>å®åœ¨ä¸è¡Œï¼Œåªèƒ½ç”¨ setTimeout åˆ›å»º task äº†ã€‚<br>ä¸ºå•¥è¦ç”¨ microtaskï¼Ÿ<br>æ ¹æ® HTML Standardï¼Œåœ¨æ¯ä¸ª task è¿è¡Œå®Œä»¥åï¼ŒUI éƒ½ä¼šé‡æ¸²æŸ“ï¼Œé‚£ä¹ˆåœ¨ microtask ä¸­å°±å®Œæˆæ•°æ®æ›´æ–°ï¼Œå½“å‰ task ç»“æŸå°±å¯ä»¥å¾—åˆ°æœ€æ–°çš„ UI äº†ã€‚<br>åä¹‹å¦‚æœæ–°å»ºä¸€ä¸ª task æ¥åšæ•°æ®æ›´æ–°ï¼Œé‚£ä¹ˆæ¸²æŸ“å°±ä¼šè¿›è¡Œä¸¤æ¬¡ã€‚<br>å‚è€ƒé¡¾è½¶çµçŸ¥ä¹çš„å›ç­”ï¼š[<a href="https://www.zhihu.com/question/55364497/answer/144215284]" target="_blank" rel="noopener">https://www.zhihu.com/question/55364497/answer/144215284]</a></li></ul><p>é¦–å…ˆæ˜¯Promiseï¼Œ(Promise.resolve()).then()å¯ä»¥åœ¨microtaskä¸­åŠ å…¥å®ƒçš„å›è°ƒï¼Œ</p><p>MutationObserveræ–°å»ºä¸€ä¸ªtextNodeçš„DOMå¯¹è±¡ï¼Œç”¨MutationObserverç»‘å®šè¯¥DOMå¹¶æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œåœ¨DOMå˜åŒ–çš„æ—¶å€™åˆ™ä¼šè§¦å‘å›è°ƒ,è¯¥å›è°ƒä¼šè¿›å…¥microtaskï¼Œå³textNode.data = String(counter)æ—¶ä¾¿ä¼šåŠ å…¥è¯¥å›è°ƒã€‚</p><p>setTimeoutæ˜¯æœ€åçš„ä¸€ç§å¤‡é€‰æ–¹æ¡ˆï¼Œå®ƒä¼šå°†å›è°ƒå‡½æ•°åŠ å…¥taskä¸­ï¼Œç­‰åˆ°æ‰§è¡Œã€‚</p><p>ç»¼ä¸Šï¼ŒnextTickçš„ç›®çš„å°±æ˜¯äº§ç”Ÿä¸€ä¸ªå›è°ƒå‡½æ•°åŠ å…¥taskæˆ–è€…microtaskä¸­ï¼Œå½“å‰æ ˆæ‰§è¡Œå®Œä»¥åï¼ˆå¯èƒ½ä¸­é—´è¿˜æœ‰åˆ«çš„æ’åœ¨å‰é¢çš„å‡½æ•°ï¼‰è°ƒç”¨è¯¥å›è°ƒå‡½æ•°ï¼Œèµ·åˆ°äº†å¼‚æ­¥è§¦å‘ï¼ˆå³ä¸‹ä¸€ä¸ªtickæ—¶è§¦å‘ï¼‰çš„ç›®çš„ã€‚</p><h2 id="flushSchedulerQueue"><a href="#flushSchedulerQueue" class="headerlink" title="flushSchedulerQueue"></a>flushSchedulerQueue</h2><pre><code class="js">/*Github:https://github.com/answershuto*//** * Flush both queues and run the watchers. */ /*nextTickçš„å›è°ƒå‡½æ•°ï¼Œåœ¨ä¸‹ä¸€ä¸ªtickæ—¶flushæ‰ä¸¤ä¸ªé˜Ÿåˆ—åŒæ—¶è¿è¡Œwatchers*/function flushSchedulerQueue () {  flushing = true  let watcher, id  // Sort queue before flush.  // This ensures that:  // 1. Components are updated from parent to child. (because parent is always  //    created before the child)  // 2. A component&#39;s user watchers are run before its render watcher (because  //    user watchers are created before the render watcher)  // 3. If a component is destroyed during a parent component&#39;s watcher run,  //    its watchers can be skipped.  /*    ç»™queueæ’åºï¼Œè¿™æ ·åšå¯ä»¥ä¿è¯ï¼š    1.ç»„ä»¶æ›´æ–°çš„é¡ºåºæ˜¯ä»çˆ¶ç»„ä»¶åˆ°å­ç»„ä»¶çš„é¡ºåºï¼Œå› ä¸ºçˆ¶ç»„ä»¶æ€»æ˜¯æ¯”å­ç»„ä»¶å…ˆåˆ›å»ºã€‚    2.ä¸€ä¸ªç»„ä»¶çš„user watchersæ¯”render watcherå…ˆè¿è¡Œï¼Œå› ä¸ºuser watcherså¾€å¾€æ¯”render watcheræ›´æ—©åˆ›å»º    3.å¦‚æœä¸€ä¸ªç»„ä»¶åœ¨çˆ¶ç»„ä»¶watcherè¿è¡ŒæœŸé—´è¢«é”€æ¯ï¼Œå®ƒçš„watcheræ‰§è¡Œå°†è¢«è·³è¿‡ã€‚  */  queue.sort((a, b) =&gt; a.id - b.id)  // do not cache length because more watchers might be pushed  // as we run existing watchers  /*è¿™é‡Œä¸ç”¨index = queue.length;index &gt; 0; index--çš„æ–¹å¼å†™æ˜¯å› ä¸ºä¸è¦å°†lengthè¿›è¡Œç¼“å­˜ï¼Œå› ä¸ºåœ¨æ‰§è¡Œå¤„ç†ç°æœ‰watcherå¯¹è±¡æœŸé—´ï¼Œæ›´å¤šçš„watcherå¯¹è±¡å¯èƒ½ä¼šè¢«pushè¿›queue*/  for (index = 0; index &lt; queue.length; index++) {    watcher = queue[index]    id = watcher.id    /*å°†hasçš„æ ‡è®°åˆ é™¤*/    has[id] = null    /*æ‰§è¡Œwatcher*/    watcher.run()    // in dev build, check and stop circular updates.    /*      åœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œæ£€æµ‹watchæ˜¯å¦åœ¨æ­»å¾ªç¯ä¸­      æ¯”å¦‚è¿™æ ·ä¸€ç§æƒ…å†µ      watch: {        test () {          this.test++;        }      }      æŒç»­æ‰§è¡Œäº†ä¸€ç™¾æ¬¡watchä»£è¡¨å¯èƒ½å­˜åœ¨æ­»å¾ªç¯    */    if (process.env.NODE_ENV !== &#39;production&#39; &amp;&amp; has[id] != null) {      circular[id] = (circular[id] || 0) + 1      if (circular[id] &gt; MAX_UPDATE_COUNT) {        warn(          &#39;You may have an infinite update loop &#39; + (            watcher.user              ? `in watcher with expression &quot;${watcher.expression}&quot;`              : `in a component render function.`          ),          watcher.vm        )        break      }    }  }  // keep copies of post queues before resetting state  /**/  /*å¾—åˆ°é˜Ÿåˆ—çš„æ‹·è´*/  const activatedQueue = activatedChildren.slice()  const updatedQueue = queue.slice()  /*é‡ç½®è°ƒåº¦è€…çš„çŠ¶æ€*/  resetSchedulerState()  // call component updated and activated hooks  /*ä½¿å­ç»„ä»¶çŠ¶æ€éƒ½æ”¹ç¼–æˆactiveåŒæ—¶è°ƒç”¨activatedé’©å­*/  callActivatedHooks(activatedQueue)  /*è°ƒç”¨updatedé’©å­*/  callUpdateHooks(updatedQueue)  // devtool hook  /* istanbul ignore if */  if (devtools &amp;&amp; config.devtools) {    devtools.emit(&#39;flush&#39;)  }}</code></pre><p>flushSchedulerQueueæ˜¯ä¸‹ä¸€ä¸ªtickæ—¶çš„å›è°ƒå‡½æ•°ï¼Œä¸»è¦ç›®çš„æ˜¯æ‰§è¡ŒWatcherçš„runå‡½æ•°ï¼Œç”¨æ¥æ›´æ–°è§†å›¾</p><h2 id="ä¸ºä»€ä¹ˆè¦å¼‚æ­¥æ›´æ–°è§†å›¾"><a href="#ä¸ºä»€ä¹ˆè¦å¼‚æ­¥æ›´æ–°è§†å›¾" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å¼‚æ­¥æ›´æ–°è§†å›¾"></a>ä¸ºä»€ä¹ˆè¦å¼‚æ­¥æ›´æ–°è§†å›¾</h2><p>æ¥çœ‹ä¸€ä¸‹ä¸‹é¢è¿™ä¸€æ®µä»£ç </p><pre><code class="html">&lt;template&gt;  &lt;div&gt;    &lt;div&gt;{{test}}&lt;/div&gt;  &lt;/div&gt;&lt;/template&gt;</code></pre><pre><code class="js">export default {    data () {        return {            test: 0        };    },    mounted () {      for(let i = 0; i &lt; 1000; i++) {        this.test++;      }    }}</code></pre><p>ç°åœ¨æœ‰è¿™æ ·çš„ä¸€ç§æƒ…å†µï¼Œmountedçš„æ—¶å€™testçš„å€¼ä¼šè¢«++å¾ªç¯æ‰§è¡Œ1000æ¬¡ã€‚ æ¯æ¬¡++æ—¶ï¼Œéƒ½ä¼šæ ¹æ®å“åº”å¼è§¦å‘setter-&gt;Dep-&gt;Watcher-&gt;update-&gt;patchã€‚ å¦‚æœè¿™æ—¶å€™æ²¡æœ‰å¼‚æ­¥æ›´æ–°è§†å›¾ï¼Œé‚£ä¹ˆæ¯æ¬¡++éƒ½ä¼šç›´æ¥æ“ä½œDOMæ›´æ–°è§†å›¾ï¼Œè¿™æ˜¯éå¸¸æ¶ˆè€—æ€§èƒ½çš„ã€‚ æ‰€ä»¥Vue.jså®ç°äº†ä¸€ä¸ªqueueé˜Ÿåˆ—ï¼Œåœ¨ä¸‹ä¸€ä¸ªtickçš„æ—¶å€™ä¼šç»Ÿä¸€æ‰§è¡Œqueueä¸­Watcherçš„runã€‚åŒæ—¶ï¼Œæ‹¥æœ‰ç›¸åŒidçš„Watcherä¸ä¼šè¢«é‡å¤åŠ å…¥åˆ°è¯¥queueä¸­å»ï¼Œæ‰€ä»¥ä¸ä¼šæ‰§è¡Œ1000æ¬¡Watcherçš„runã€‚æœ€ç»ˆæ›´æ–°è§†å›¾åªä¼šç›´æ¥å°†testå¯¹åº”çš„DOMçš„0å˜æˆ1000ã€‚ ä¿è¯æ›´æ–°è§†å›¾æ“ä½œDOMçš„åŠ¨ä½œæ˜¯åœ¨å½“å‰æ ˆæ‰§è¡Œå®Œä»¥åä¸‹ä¸€ä¸ªtickçš„æ—¶å€™è°ƒç”¨ï¼Œå¤§å¤§ä¼˜åŒ–äº†æ€§èƒ½ã€‚</p><h2 id="è®¿é—®çœŸå®DOMèŠ‚ç‚¹æ›´æ–°åçš„æ•°æ®"><a href="#è®¿é—®çœŸå®DOMèŠ‚ç‚¹æ›´æ–°åçš„æ•°æ®" class="headerlink" title="è®¿é—®çœŸå®DOMèŠ‚ç‚¹æ›´æ–°åçš„æ•°æ®"></a>è®¿é—®çœŸå®DOMèŠ‚ç‚¹æ›´æ–°åçš„æ•°æ®</h2><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ä¿®æ”¹dataä¸­çš„æ•°æ®åè®¿é—®çœŸå®çš„DOMèŠ‚ç‚¹æ›´æ–°åçš„æ•°æ®ï¼Œåªéœ€è¦è¿™æ ·ï¼Œæˆ‘ä»¬æŠŠæ–‡ç« ç¬¬ä¸€ä¸ªä¾‹å­è¿›è¡Œä¿®æ”¹ã€‚</p><pre><code class="html">&lt;template&gt;  &lt;div&gt;    &lt;div ref=&quot;test&quot;&gt;{{test}}&lt;/div&gt;    &lt;button @click=&quot;handleClick&quot;&gt;tet&lt;/button&gt;  &lt;/div&gt;&lt;/template&gt;</code></pre><pre><code class="js">export default {    data () {        return {            test: &#39;begin&#39;        };    },    methods () {        handleClick () {            this.test = &#39;end&#39;;            this.$nextTick(() =&gt; {                console.log(this.$refs.test.innerText);//æ‰“å°&quot;end&quot;            });            console.log(this.$refs.test.innerText);//æ‰“å°â€œbeginâ€        }    }}</code></pre><p>ä½¿ç”¨Vue.jsçš„global APIçš„$nextTickæ–¹æ³•ï¼Œå³å¯åœ¨å›è°ƒä¸­è·å–å·²ç»æ›´æ–°å¥½çš„DOMå®ä¾‹äº†ã€‚</p><p><a href="https://github.com/answershuto/learnVue/blob/master/docs/Vue.js%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0DOM%E7%AD%96%E7%95%A5%E5%8F%8AnextTick.MarkDown" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vueäº‹ä»¶API</title>
      <link href="/2018/12/16/Vue/Vue%E4%BA%8B%E4%BB%B6API/"/>
      <url>/2018/12/16/Vue/Vue%E4%BA%8B%E4%BB%B6API/</url>
      
        <content type="html"><![CDATA[<h1 id="Vueäº‹ä»¶API"><a href="#Vueäº‹ä»¶API" class="headerlink" title="Vueäº‹ä»¶API"></a>Vueäº‹ä»¶API</h1><p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒVue.jsä¸ºæˆ‘ä»¬æä¾›äº†å››ä¸ªäº‹ä»¶APIï¼Œåˆ†åˆ«æ˜¯<code>$onï¼Œ$onceï¼Œ$offï¼Œ$emit</code>ã€‚</p><h2 id="åˆå§‹åŒ–äº‹ä»¶"><a href="#åˆå§‹åŒ–äº‹ä»¶" class="headerlink" title="åˆå§‹åŒ–äº‹ä»¶"></a>åˆå§‹åŒ–äº‹ä»¶</h2><p>åˆå§‹åŒ–äº‹ä»¶åœ¨vmä¸Šåˆ›å»ºä¸€ä¸ª_eventså¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾äº‹ä»¶ã€‚_eventsçš„å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code class="js">{    eventName: [func1, func2, func3]}</code></pre><p>å­˜æ”¾äº‹ä»¶åä»¥åŠå¯¹åº”æ‰§è¡Œæ–¹æ³•ã€‚</p><pre><code class="js">/*åˆå§‹åŒ–äº‹ä»¶*/export function initEvents (vm: Component) {  /*åœ¨vmä¸Šåˆ›å»ºä¸€ä¸ª_eventså¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾äº‹ä»¶ã€‚*/  vm._events = Object.create(null)  /*è¿™ä¸ªboolæ ‡å¿—ä½æ¥è¡¨æ˜æ˜¯å¦å­˜åœ¨é’©å­ï¼Œè€Œä¸éœ€è¦é€šè¿‡å“ˆå¸Œè¡¨çš„æ–¹æ³•æ¥æŸ¥æ‰¾æ˜¯å¦æœ‰é’©å­ï¼Œè¿™æ ·åšå¯ä»¥å‡å°‘ä¸å¿…è¦çš„å¼€é”€ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚*/  vm._hasHookEvent = false  // init parent attached events  /*åˆå§‹åŒ–çˆ¶ç»„ä»¶attachçš„äº‹ä»¶*/  const listeners = vm.$options._parentListeners  if (listeners) {    updateComponentListeners(vm, listeners)  }}</code></pre><h2 id="on"><a href="#on" class="headerlink" title="$on"></a>$on</h2><p>$onæ–¹æ³•ç”¨æ¥åœ¨vmå®ä¾‹ä¸Šç›‘å¬ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œè¯¥äº‹ä»¶å¯ç”¨$emitè§¦å‘ã€‚</p><pre><code class="js">  Vue.prototype.$on = function (event: string | Array&lt;string&gt;, fn: Function): Component {    const vm: Component = this    /*å¦‚æœæ˜¯æ•°ç»„çš„æ—¶å€™ï¼Œåˆ™é€’å½’$onï¼Œä¸ºæ¯ä¸€ä¸ªæˆå‘˜éƒ½ç»‘å®šä¸Šæ–¹æ³•*/    if (Array.isArray(event)) {      for (let i = 0, l = event.length; i &lt; l; i++) {        this.$on(event[i], fn)      }    } else {      (vm._events[event] || (vm._events[event] = [])).push(fn)      // optimize hook:event cost by using a boolean flag marked at registration      // instead of a hash lookup      /*è¿™é‡Œåœ¨æ³¨å†Œäº‹ä»¶çš„æ—¶å€™æ ‡è®°boolå€¼ä¹Ÿå°±æ˜¯ä¸ªæ ‡å¿—ä½æ¥è¡¨æ˜å­˜åœ¨é’©å­ï¼Œè€Œä¸éœ€è¦é€šè¿‡å“ˆå¸Œè¡¨çš„æ–¹æ³•æ¥æŸ¥æ‰¾æ˜¯å¦æœ‰é’©å­ï¼Œè¿™æ ·åšå¯ä»¥å‡å°‘ä¸å¿…è¦çš„å¼€é”€ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚*/      if (hookRE.test(event)) {        vm._hasHookEvent = true      }    }    return vm  }</code></pre><h2 id="once"><a href="#once" class="headerlink" title="$once"></a>$once</h2><p>$onceç›‘å¬ä¸€ä¸ªåªèƒ½è§¦å‘ä¸€æ¬¡çš„äº‹ä»¶ï¼Œåœ¨è§¦å‘ä»¥åä¼šè‡ªåŠ¨ç§»é™¤è¯¥äº‹ä»¶ã€‚</p><pre><code class="js">Vue.prototype.$once = function (event: string, fn: Function): Component {    const vm: Component = this    function on () {      /*åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™å°†è¯¥äº‹ä»¶é”€æ¯*/      vm.$off(event, on)      /*æ‰§è¡Œæ³¨å†Œçš„æ–¹æ³•*/      fn.apply(vm, arguments)    }    on.fn = fn    vm.$on(event, on)    return vm  }</code></pre><a id="more"></a><h2 id="off"><a href="#off" class="headerlink" title="$off"></a>$off</h2><p>$offç”¨æ¥ç§»é™¤è‡ªå®šä¹‰äº‹ä»¶</p><pre><code class="js">Vue.prototype.$off = function (event?: string | Array&lt;string&gt;, fn?: Function): Component {    const vm: Component = this    // all    /*å¦‚æœä¸ä¼ å‚æ•°åˆ™æ³¨é”€æ‰€æœ‰äº‹ä»¶*/    if (!arguments.length) {      vm._events = Object.create(null)      return vm    }    // array of events    /*å¦‚æœeventæ˜¯æ•°ç»„åˆ™é€’å½’æ³¨é”€äº‹ä»¶*/    if (Array.isArray(event)) {      for (let i = 0, l = event.length; i &lt; l; i++) {        this.$off(event[i], fn)      }      return vm    }    // specific event    const cbs = vm._events[event]    /*Github:https://github.com/answershuto*/    /*æœ¬èº«ä¸å­˜åœ¨è¯¥äº‹ä»¶åˆ™ç›´æ¥è¿”å›*/    if (!cbs) {      return vm    }    /*å¦‚æœåªä¼ äº†eventå‚æ•°åˆ™æ³¨é”€è¯¥eventæ–¹æ³•ä¸‹çš„æ‰€æœ‰æ–¹æ³•*/    if (arguments.length === 1) {      vm._events[event] = null      return vm    }    // specific handler    /*éå†å¯»æ‰¾å¯¹åº”æ–¹æ³•å¹¶åˆ é™¤*/    let cb    let i = cbs.length    while (i--) {      cb = cbs[i]      if (cb === fn || cb.fn === fn) {        cbs.splice(i, 1)        break      }    }    return vm  }</code></pre><h2 id="emit"><a href="#emit" class="headerlink" title="$emit"></a>$emit</h2><p>$emitç”¨æ¥è§¦å‘æŒ‡å®šçš„è‡ªå®šä¹‰äº‹ä»¶ã€‚</p><pre><code class="js">Vue.prototype.$emit = function (event: string): Component {    const vm: Component = this    if (process.env.NODE_ENV !== &#39;production&#39;) {      const lowerCaseEvent = event.toLowerCase()      if (lowerCaseEvent !== event &amp;&amp; vm._events[lowerCaseEvent]) {        tip(          `Event &quot;${lowerCaseEvent}&quot; is emitted in component ` +          `${formatComponentName(vm)} but the handler is registered for &quot;${event}&quot;. ` +          `Note that HTML attributes are case-insensitive and you cannot use ` +          `v-on to listen to camelCase events when using in-DOM templates. ` +          `You should probably use &quot;${hyphenate(event)}&quot; instead of &quot;${event}&quot;.`        )      }    }    let cbs = vm._events[event]    if (cbs) {      /*å°†ç±»æ•°ç»„çš„å¯¹è±¡è½¬æ¢æˆæ•°ç»„*/      cbs = cbs.length &gt; 1 ? toArray(cbs) : cbs      const args = toArray(arguments, 1)      /*éå†æ‰§è¡Œ*/      for (let i = 0, l = cbs.length; i &lt; l; i++) {        cbs[i].apply(vm, args)      }    }    return vm  }</code></pre>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vueæºç ä¹‹ä»æºç è§’åº¦å†çœ‹æ•°æ®ç»‘å®š</title>
      <link href="/2018/12/09/Vue/vue%E6%BA%90%E7%A0%81%E4%B9%8B%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%86%8D%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A/"/>
      <url>/2018/12/09/Vue/vue%E6%BA%90%E7%A0%81%E4%B9%8B%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%86%8D%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/answershuto/learnVue/blob/master/docs/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%86%8D%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A.MarkDown" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="å‰æ–‡"><a href="#å‰æ–‡" class="headerlink" title="å‰æ–‡"></a>å‰æ–‡</h1><p>å‰é¢å·²ç»è®²è¿‡Vueæ•°æ®ç»‘å®šçš„åŸç†äº†ï¼Œç°åœ¨ä»æºç æ¥çœ‹ä¸€ä¸‹æ•°æ®ç»‘å®šåœ¨Vueä¸­æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹Vue.jså®˜ç½‘ä»‹ç»å“åº”å¼åŸç†çš„è¿™å¼ å›¾ã€‚</p><p><img src="https://camo.githubusercontent.com/3845b9554e62650727fa7cae8f1c169060b879f7/68747470733a2f2f636e2e7675656a732e6f72672f696d616765732f646174612e706e67" alt="Vue"></p><p>è¿™å¼ å›¾æ¯”è¾ƒæ¸…æ™°åœ°å±•ç¤ºäº†æ•´ä¸ªæµç¨‹ï¼Œé¦–å…ˆé€šè¿‡ä¸€æ¬¡æ¸²æŸ“æ“ä½œè§¦å‘Dataçš„getterï¼ˆè¿™é‡Œä¿è¯åªæœ‰è§†å›¾ä¸­éœ€è¦è¢«ç”¨åˆ°çš„dataæ‰ä¼šè§¦å‘getterï¼‰è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œè¿™æ—¶å€™å…¶å®Watcherä¸dataå¯ä»¥çœ‹æˆä¸€ç§è¢«ç»‘å®šçš„çŠ¶æ€ï¼ˆå®é™…ä¸Šæ˜¯dataçš„é—­åŒ…ä¸­æœ‰ä¸€ä¸ªDepsè®¢é˜…è€…ï¼Œåœ¨ä¿®æ”¹çš„æ—¶å€™ä¼šé€šçŸ¥æ‰€æœ‰çš„Watcherè§‚å¯Ÿè€…ï¼‰ï¼Œåœ¨dataå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ä¼šè§¦å‘å®ƒçš„setterï¼Œsetteré€šçŸ¥Watcherï¼ŒWatcherè¿›è¡Œå›è°ƒé€šçŸ¥ç»„ä»¶é‡æ–°æ¸²æŸ“çš„å‡½æ•°ï¼Œä¹‹åæ ¹æ®diffç®—æ³•æ¥å†³å®šæ˜¯å¦å‘ç”Ÿè§†å›¾çš„æ›´æ–°ã€‚</p><p>Vueåœ¨åˆå§‹åŒ–ç»„ä»¶æ•°æ®æ—¶ï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸçš„<code>beforeCreate</code>ä¸<code>created</code>é’©å­å‡½æ•°ä¹‹é—´å®ç°äº†å¯¹<code>dataã€propsã€computedã€methodsã€eventsä»¥åŠwatch</code>çš„å¤„ç†ã€‚</p><h2 id="initData"><a href="#initData" class="headerlink" title="initData"></a>initData</h2><p>è¿™é‡Œæ¥è®²ä¸€ä¸‹<a href="">initData</a>ï¼Œå¯ä»¥å‚è€ƒæºç instanceä¸‹çš„<code>state.js</code>æ–‡ä»¶ï¼Œä¸‹é¢æ‰€æœ‰çš„ä¸­æ–‡æ³¨é‡Šéƒ½æ˜¯æˆ‘åŠ çš„ï¼Œè‹±æ–‡æ³¨é‡Šæ˜¯å°¤å¤§åŠ çš„ï¼Œè¯·ä¸è¦å¿½ç•¥è‹±æ–‡æ³¨é‡Šï¼Œè‹±æ–‡æ³¨é‡Šéƒ½è®²åˆ°äº†æ¯”è¾ƒå…³é”®æˆ–è€…æ™¦æ¶©éš¾æ‡‚çš„ç‚¹ã€‚</p><p>åŠ æ³¨é‡Šç‰ˆçš„vueæºç ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡<a href="https://github.com/answershuto/learnVue/tree/master/vue-src" target="_blank" rel="noopener">ä¼ é€é—¨</a>æŸ¥çœ‹ï¼Œè¿™äº›æ˜¯æˆ‘åœ¨é˜…è¯»Vueæºç è¿‡ç¨‹ä¸­åŠ çš„æ³¨é‡Šï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚</p><p>initDataä¸»è¦æ˜¯åˆå§‹åŒ–dataä¸­çš„æ•°æ®ï¼Œå°†æ•°æ®è¿›è¡ŒObserverï¼Œç›‘å¬æ•°æ®çš„å˜åŒ–ï¼Œå…¶ä»–çš„ç›‘è§†åŸç†ä¸€è‡´ï¼Œè¿™é‡Œä»¥dataä¸ºä¾‹ã€‚</p><pre><code class="js">function initData (vm: Component) {  /*å¾—åˆ°dataæ•°æ®*/  let data = vm.$options.data  data = vm._data = typeof data === &#39;function&#39;    ? getData(data, vm)    : data || {}  /*åˆ¤æ–­æ˜¯å¦æ˜¯å¯¹è±¡*/  if (!isPlainObject(data)) {    data = {}    process.env.NODE_ENV !== &#39;production&#39; &amp;&amp; warn(      &#39;data functions should return an object:\n&#39; +      &#39;https://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function&#39;,      vm    )  }  // proxy data on instance  /*éå†dataå¯¹è±¡*/  const keys = Object.keys(data)  const props = vm.$options.props  let i = keys.length  //éå†dataä¸­çš„æ•°æ®  while (i--) {    /*ä¿è¯dataä¸­çš„keyä¸ä¸propsä¸­çš„keyé‡å¤ï¼Œpropsä¼˜å…ˆï¼Œå¦‚æœæœ‰å†²çªä¼šäº§ç”Ÿwarning*/    if (props &amp;&amp; hasOwn(props, keys[i])) {      process.env.NODE_ENV !== &#39;production&#39; &amp;&amp; warn(        `The data property &quot;${keys[i]}&quot; is already declared as a prop. ` +        `Use prop default value instead.`,        vm      )    } else if (!isReserved(keys[i])) {      /*åˆ¤æ–­æ˜¯å¦æ˜¯ä¿ç•™å­—æ®µ*/      /*è¿™é‡Œæ˜¯æˆ‘ä»¬å‰é¢è®²è¿‡çš„ä»£ç†ï¼Œå°†dataä¸Šé¢çš„å±æ€§ä»£ç†åˆ°äº†vmå®ä¾‹ä¸Š*/      proxy(vm, `_data`, keys[i])    }  }  /*Github:https://github.com/answershuto*/  // observe data  /*ä»è¿™é‡Œå¼€å§‹æˆ‘ä»¬è¦observeäº†ï¼Œå¼€å§‹å¯¹æ•°æ®è¿›è¡Œç»‘å®šï¼Œè¿™é‡Œæœ‰å°¤å¤§å¤§çš„æ³¨é‡ŠasRootDataï¼Œè¿™æ­¥ä½œä¸ºæ ¹æ•°æ®ï¼Œä¸‹é¢ä¼šè¿›è¡Œé€’å½’observeè¿›è¡Œå¯¹æ·±å±‚å¯¹è±¡çš„ç»‘å®šã€‚*/  observe(data, true /* asRootData */)}</code></pre><p>å…¶å®è¿™æ®µä»£ç ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼Œä¸€æ˜¯å°†_dataä¸Šé¢çš„æ•°æ®ä»£ç†åˆ°vmä¸Šï¼Œå¦ä¸€ä»¶äº‹é€šè¿‡observeå°†æ‰€æœ‰æ•°æ®å˜æˆobservableã€‚</p><h2 id="proxy"><a href="#proxy" class="headerlink" title="proxy"></a>proxy</h2><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹proxyä»£ç†ã€‚</p><pre><code class="js">/*æ·»åŠ ä»£ç†*/export function proxy (target: Object, sourceKey: string, key: string) {  sharedPropertyDefinition.get = function proxyGetter () {    return this[sourceKey][key]  }  sharedPropertyDefinition.set = function proxySetter (val) {    this[sourceKey][key] = val  }  Object.defineProperty(target, key, sharedPropertyDefinition)}</code></pre><p>è¿™é‡Œæ¯”è¾ƒå¥½ç†è§£ï¼Œé€šè¿‡proxyå‡½æ•°å°†dataä¸Šé¢çš„æ•°æ®ä»£ç†åˆ°vmä¸Šï¼Œè¿™æ ·å°±å¯ä»¥ç”¨app.textä»£æ›¿app._data.textäº†ã€‚</p><h2 id="observe"><a href="#observe" class="headerlink" title="observe"></a>observe</h2><p>æ¥ä¸‹æ¥æ˜¯<a href="https://github.com/answershuto/learnVue/blob/master/docs/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%86%8D%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A.MarkDown" target="_blank" rel="noopener">observe</a>ï¼Œè¿™ä¸ªå‡½æ•°å®šä¹‰åœ¨coreæ–‡ä»¶ä¸‹observerçš„index.jsæ–‡ä»¶ä¸­ã€‚</p><!-- mroe --><pre><code class="js">/** * Attempt to create an observer instance for a value, * returns the new observer if successfully observed, * or the existing observer if the value already has one. */ /* å°è¯•åˆ›å»ºä¸€ä¸ªObserverå®ä¾‹ï¼ˆ__ob__ï¼‰ï¼Œå¦‚æœæˆåŠŸåˆ›å»ºObserverå®ä¾‹åˆ™è¿”å›æ–°çš„Observerå®ä¾‹ï¼Œå¦‚æœå·²æœ‰Observerå®ä¾‹åˆ™è¿”å›ç°æœ‰çš„Observerå®ä¾‹ã€‚ */export function observe (value: any, asRootData: ?boolean): Observer | void {  /*åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªå¯¹è±¡*/  if (!isObject(value)) {    return  }  let ob: Observer | void  /*è¿™é‡Œç”¨__ob__è¿™ä¸ªå±æ€§æ¥åˆ¤æ–­æ˜¯å¦å·²ç»æœ‰Observerå®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰Observerå®ä¾‹åˆ™ä¼šæ–°å»ºä¸€ä¸ªObserverå®ä¾‹å¹¶èµ‹å€¼ç»™__ob__è¿™ä¸ªå±æ€§ï¼Œå¦‚æœå·²æœ‰Observerå®ä¾‹åˆ™ç›´æ¥è¿”å›è¯¥Observerå®ä¾‹*/  if (hasOwn(value, &#39;__ob__&#39;) &amp;&amp; value.__ob__ instanceof Observer) {    ob = value.__ob__  } else if (    /*è¿™é‡Œçš„åˆ¤æ–­æ˜¯ä¸ºäº†ç¡®ä¿valueæ˜¯å•çº¯çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å‡½æ•°æˆ–è€…æ˜¯Regexpç­‰æƒ…å†µã€‚*/    observerState.shouldConvert &amp;&amp;    !isServerRendering() &amp;&amp;    (Array.isArray(value) || isPlainObject(value)) &amp;&amp;    Object.isExtensible(value) &amp;&amp;    !value._isVue  ) {    ob = new Observer(value)  }  if (asRootData &amp;&amp; ob) {    /*å¦‚æœæ˜¯æ ¹æ•°æ®åˆ™è®¡æ•°ï¼Œåé¢Observerä¸­çš„observeçš„asRootDataétrue*/    ob.vmCount++  }  return ob}</code></pre><p>Vueçš„å“åº”å¼æ•°æ®éƒ½ä¼šæœ‰ä¸€ä¸ª<strong>ob</strong>çš„å±æ€§ä½œä¸ºæ ‡è®°ï¼Œé‡Œé¢å­˜æ”¾äº†è¯¥å±æ€§çš„è§‚å¯Ÿå™¨ï¼Œä¹Ÿå°±æ˜¯Observerçš„å®ä¾‹ï¼Œé˜²æ­¢é‡å¤ç»‘å®šã€‚</p><h2 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h2><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹æ–°å»ºçš„Observerã€‚Observerçš„ä½œç”¨<strong>å°±æ˜¯éå†å¯¹è±¡çš„æ‰€æœ‰å±æ€§å°†å…¶è¿›è¡ŒåŒå‘ç»‘å®š</strong>ã€‚</p><pre><code class="js">/** * Observer class that are attached to each observed * object. Once attached, the observer converts target * object&#39;s property keys into getter/setters that * collect dependencies and dispatches updates. */export class  {  value: any;  dep: Dep;  vmCount: number; // number of vms that has this object as root $data  constructor (value: any) {    this.value = value    this.dep = new Dep()    this.vmCount = 0    /*    å°†Observerå®ä¾‹ç»‘å®šåˆ°dataçš„__ob__å±æ€§ä¸Šé¢å»ï¼Œä¹‹å‰è¯´è¿‡observeçš„æ—¶å€™ä¼šå…ˆæ£€æµ‹æ˜¯å¦å·²ç»æœ‰__ob__å¯¹è±¡å­˜æ”¾Observerå®ä¾‹äº†ï¼Œdefæ–¹æ³•å®šä¹‰å¯ä»¥å‚è€ƒhttps://github.com/vuejs/vue/blob/dev/src/core/util/lang.js#L16    */    def(value, &#39;__ob__&#39;, this)    if (Array.isArray(value)) {      /*          å¦‚æœæ˜¯æ•°ç»„ï¼Œå°†ä¿®æ”¹åå¯ä»¥æˆªè·å“åº”çš„æ•°ç»„æ–¹æ³•æ›¿æ¢æ‰è¯¥æ•°ç»„çš„åŸå‹ä¸­çš„åŸç”Ÿæ–¹æ³•ï¼Œè¾¾åˆ°ç›‘å¬æ•°ç»„æ•°æ®å˜åŒ–å“åº”çš„æ•ˆæœã€‚          è¿™é‡Œå¦‚æœå½“å‰æµè§ˆå™¨æ”¯æŒ__proto__å±æ€§ï¼Œåˆ™ç›´æ¥è¦†ç›–å½“å‰æ•°ç»„å¯¹è±¡åŸå‹ä¸Šçš„åŸç”Ÿæ•°ç»„æ–¹æ³•ï¼Œå¦‚æœä¸æ”¯æŒè¯¥å±æ€§ï¼Œåˆ™ç›´æ¥è¦†ç›–æ•°ç»„å¯¹è±¡çš„åŸå‹ã€‚      */      const augment = hasProto        ? protoAugment  /*ç›´æ¥è¦†ç›–åŸå‹çš„æ–¹æ³•æ¥ä¿®æ”¹ç›®æ ‡å¯¹è±¡*/        : copyAugment   /*å®šä¹‰ï¼ˆè¦†ç›–ï¼‰ç›®æ ‡å¯¹è±¡æˆ–æ•°ç»„çš„æŸä¸€ä¸ªæ–¹æ³•*/      augment(value, arrayMethods, arrayKeys)      /*Github:https://github.com/answershuto*/      /*å¦‚æœæ˜¯æ•°ç»„åˆ™éœ€è¦éå†æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜è¿›è¡Œobserve*/      this.observeArray(value)    } else {      /*å¦‚æœæ˜¯å¯¹è±¡åˆ™ç›´æ¥walkè¿›è¡Œç»‘å®š*/      this.walk(value)    }  }  /**   * Walk through each property and convert them into   * getter/setters. This method should only be called when   * value type is Object.   */  walk (obj: Object) {    const keys = Object.keys(obj)    /*walkæ–¹æ³•ä¼šéå†å¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§è¿›è¡ŒdefineReactiveç»‘å®š*/    for (let i = 0; i &lt; keys.length; i++) {      defineReactive(obj, keys[i], obj[keys[i]])    }  }  /**   * Observe a list of Array items.   */  observeArray (items: Array&lt;any&gt;) {    /*æ•°ç»„éœ€è¦ä¾¿åˆ©æ¯ä¸€ä¸ªæˆå‘˜è¿›è¡Œobserve*/    for (let i = 0, l = items.length; i &lt; l; i++) {      observe(items[i])    }  }}</code></pre><p>Observerä¸ºæ•°æ®åŠ ä¸Šå“åº”å¼å±æ€§è¿›è¡ŒåŒå‘ç»‘å®šã€‚<strong>å¦‚æœæ˜¯å¯¹è±¡åˆ™è¿›è¡Œæ·±åº¦éå†ï¼Œä¸ºæ¯ä¸€ä¸ªå­å¯¹è±¡éƒ½ç»‘å®šä¸Šæ–¹æ³•ï¼Œå¦‚æœæ˜¯æ•°ç»„åˆ™ä¸ºæ¯ä¸€ä¸ªæˆå‘˜éƒ½ç»‘å®šä¸Šæ–¹æ³•</strong>ã€‚</p><p>å¦‚æœæ˜¯ä¿®æ”¹ä¸€ä¸ªæ•°ç»„çš„æˆå‘˜ï¼Œè¯¥æˆå‘˜æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£åªéœ€è¦<code>é€’å½’å¯¹æ•°ç»„çš„æˆå‘˜è¿›è¡ŒåŒå‘ç»‘å®šå³å¯</code>ã€‚ä½†è¿™æ—¶å€™å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œï¼Ÿå¦‚æœæˆ‘ä»¬è¿›è¡Œpopã€pushç­‰æ“ä½œçš„æ—¶å€™ï¼Œpushè¿›å»çš„å¯¹è±¡æ ¹æœ¬æ²¡æœ‰è¿›è¡Œè¿‡åŒå‘ç»‘å®šï¼Œæ›´åˆ«è¯´popäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç›‘å¬æ•°ç»„çš„è¿™äº›å˜åŒ–å‘¢ï¼Ÿ Vue.jsæä¾›çš„æ–¹æ³•æ˜¯é‡å†™pushã€popã€shiftã€unshiftã€spliceã€sortã€reverseè¿™ä¸ƒä¸ªæ•°ç»„æ–¹æ³•ã€‚ä¿®æ”¹æ•°ç»„åŸå‹æ–¹æ³•çš„ä»£ç å¯ä»¥å‚è€ƒobserver/array.jsä»¥åŠobserver/index.jsã€‚</p><pre><code class="js">export class Observer {  value: any;  dep: Dep;  vmCount: number; // number of vms that has this object as root $data  constructor (value: any) {    //.......    if (Array.isArray(value)) {      /*          å¦‚æœæ˜¯æ•°ç»„ï¼Œå°†ä¿®æ”¹åå¯ä»¥æˆªè·å“åº”çš„æ•°ç»„æ–¹æ³•æ›¿æ¢æ‰è¯¥æ•°ç»„çš„åŸå‹ä¸­çš„åŸç”Ÿæ–¹æ³•ï¼Œè¾¾åˆ°ç›‘å¬æ•°ç»„æ•°æ®å˜åŒ–å“åº”çš„æ•ˆæœã€‚          è¿™é‡Œå¦‚æœå½“å‰æµè§ˆå™¨æ”¯æŒ__proto__å±æ€§ï¼Œåˆ™ç›´æ¥è¦†ç›–å½“å‰æ•°ç»„å¯¹è±¡åŸå‹ä¸Šçš„åŸç”Ÿæ•°ç»„æ–¹æ³•ï¼Œå¦‚æœä¸æ”¯æŒè¯¥å±æ€§ï¼Œåˆ™ç›´æ¥è¦†ç›–æ•°ç»„å¯¹è±¡çš„åŸå‹ã€‚      */      const augment = hasProto        ? protoAugment  /*ç›´æ¥è¦†ç›–åŸå‹çš„æ–¹æ³•æ¥ä¿®æ”¹ç›®æ ‡å¯¹è±¡*/        : copyAugment   /*å®šä¹‰ï¼ˆè¦†ç›–ï¼‰ç›®æ ‡å¯¹è±¡æˆ–æ•°ç»„çš„æŸä¸€ä¸ªæ–¹æ³•*/      augment(value, arrayMethods, arrayKeys)      /*å¦‚æœæ˜¯æ•°ç»„åˆ™éœ€è¦éå†æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜è¿›è¡Œobserve*/      this.observeArray(value)    } else {      /*å¦‚æœæ˜¯å¯¹è±¡åˆ™ç›´æ¥walkè¿›è¡Œç»‘å®š*/      this.walk(value)    }  }}/** * Augment an target Object or Array by intercepting * the prototype chain using __proto__ */ /*ç›´æ¥è¦†ç›–åŸå‹çš„æ–¹æ³•æ¥ä¿®æ”¹ç›®æ ‡å¯¹è±¡æˆ–æ•°ç»„*/function protoAugment (target, src: Object) {  /* eslint-disable no-proto */  target.__proto__ = src  /* eslint-enable no-proto */}/** * Augment an target Object or Array by defining * hidden properties. *//* istanbul ignore next *//*å®šä¹‰ï¼ˆè¦†ç›–ï¼‰ç›®æ ‡å¯¹è±¡æˆ–æ•°ç»„çš„æŸä¸€ä¸ªæ–¹æ³•*/function copyAugment (target: Object, src: Object, keys: Array&lt;string&gt;) {  for (let i = 0, l = keys.length; i &lt; l; i++) {    const key = keys[i]    def(target, key, src[key])  }}</code></pre><pre><code class="js">/* * not type checking this file because flow doesn&#39;t play well with * dynamically accessing methods on Array prototype */import { def } from &#39;../util/index&#39;/*å–å¾—åŸç”Ÿæ•°ç»„çš„åŸå‹*/const arrayProto = Array.prototype/*åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„å¯¹è±¡ï¼Œä¿®æ”¹è¯¥å¯¹è±¡ä¸Šçš„æ•°ç»„çš„ä¸ƒä¸ªæ–¹æ³•ï¼Œé˜²æ­¢æ±¡æŸ“åŸç”Ÿæ•°ç»„æ–¹æ³•*/export const arrayMethods = Object.create(arrayProto)/** * Intercept mutating methods and emit events */ /*è¿™é‡Œé‡å†™äº†æ•°ç»„çš„è¿™äº›æ–¹æ³•ï¼Œåœ¨ä¿è¯ä¸æ±¡æŸ“åŸç”Ÿæ•°ç»„åŸå‹çš„æƒ…å†µä¸‹é‡å†™æ•°ç»„çš„è¿™äº›æ–¹æ³•ï¼Œæˆªè·æ•°ç»„çš„æˆå‘˜å‘ç”Ÿçš„å˜åŒ–ï¼Œæ‰§è¡ŒåŸç”Ÿæ•°ç»„æ“ä½œçš„åŒæ—¶depé€šçŸ¥å…³è”çš„æ‰€æœ‰è§‚å¯Ÿè€…è¿›è¡Œå“åº”å¼å¤„ç†*/;[  &#39;push&#39;,  &#39;pop&#39;,  &#39;shift&#39;,  &#39;unshift&#39;,  &#39;splice&#39;,  &#39;sort&#39;,  &#39;reverse&#39;].forEach(function (method) {  // cache original method  /*å°†æ•°ç»„çš„åŸç”Ÿæ–¹æ³•ç¼“å­˜èµ·æ¥ï¼Œåé¢è¦è°ƒç”¨*/  const original = arrayProto[method]  def(arrayMethods, method, function mutator () {    // avoid leaking arguments:    // http://jsperf.com/closure-with-arguments    let i = arguments.length    const args = new Array(i)    while (i--) {      args[i] = arguments[i]    }    /*è°ƒç”¨åŸç”Ÿçš„æ•°ç»„æ–¹æ³•*/    const result = original.apply(this, args)    /*æ•°ç»„æ–°æ’å…¥çš„å…ƒç´ éœ€è¦é‡æ–°è¿›è¡Œobserveæ‰èƒ½å“åº”å¼*/    const ob = this.__ob__    let inserted    switch (method) {      case &#39;push&#39;:        inserted = args        break      case &#39;unshift&#39;:        inserted = args        break      case &#39;splice&#39;:        inserted = args.slice(2)        break    }    if (inserted) ob.observeArray(inserted)    // notify change    /*depé€šçŸ¥æ‰€æœ‰æ³¨å†Œçš„è§‚å¯Ÿè€…è¿›è¡Œå“åº”å¼å¤„ç†*/    ob.dep.notify()    return result  })})</code></pre><p>ä»æ•°ç»„çš„åŸå‹æ–°å»ºä¸€ä¸ª<code>Object.create(arrayProto)</code>å¯¹è±¡ï¼Œé€šè¿‡ä¿®æ”¹æ­¤åŸå‹å¯ä»¥ä¿è¯åŸç”Ÿæ•°ç»„æ–¹æ³•ä¸è¢«æ±¡æŸ“ã€‚å¦‚æœå½“å‰æµè§ˆå™¨æ”¯æŒ<code>__proto__</code>è¿™ä¸ªå±æ€§çš„è¯å°±å¯ä»¥ç›´æ¥è¦†ç›–è¯¥å±æ€§åˆ™ä½¿æ•°ç»„å¯¹è±¡å…·æœ‰äº†é‡å†™åçš„æ•°ç»„æ–¹æ³•ã€‚å¦‚æœæ²¡æœ‰è¯¥å±æ€§çš„æµè§ˆå™¨ï¼Œåˆ™å¿…é¡»é€šè¿‡éå†defæ‰€æœ‰éœ€è¦é‡å†™çš„æ•°ç»„æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•æ•ˆç‡è¾ƒä½ï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨ç¬¬ä¸€ç§ã€‚</p><p>åœ¨ä¿è¯ä¸æ±¡æŸ“ä¸è¦†ç›–æ•°ç»„åŸç”Ÿæ–¹æ³•æ·»åŠ ç›‘å¬ï¼Œä¸»è¦åšäº†ä¸¤ä¸ªæ“ä½œï¼Œç¬¬ä¸€æ˜¯é€šçŸ¥æ‰€æœ‰æ³¨å†Œçš„è§‚å¯Ÿè€…è¿›è¡Œå“åº”å¼å¤„ç†ï¼Œç¬¬äºŒæ˜¯å¦‚æœæ˜¯æ·»åŠ æˆå‘˜çš„æ“ä½œï¼Œéœ€è¦å¯¹æ–°æˆå‘˜è¿›è¡Œobserveã€‚</p><p>ä½†æ˜¯ä¿®æ”¹äº†æ•°ç»„çš„åŸç”Ÿæ–¹æ³•ä»¥åæˆ‘ä»¬è¿˜æ˜¯æ²¡æ³•åƒåŸç”Ÿæ•°ç»„ä¸€æ ·ç›´æ¥é€šè¿‡æ•°ç»„çš„ä¸‹æ ‡æˆ–è€…è®¾ç½®lengthæ¥ä¿®æ”¹æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡<code>Vue.setä»¥åŠsplice</code>æ–¹æ³•ã€‚</p><h2 id="Watcher"><a href="#Watcher" class="headerlink" title="Watcher"></a>Watcher</h2><p><a href="https://github.com/vuejs/vue/blob/dev/src/core/observer/watcher.js#L24" target="_blank" rel="noopener">Watcher</a>æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ã€‚ä¾èµ–æ”¶é›†ä»¥åWatcherå¯¹è±¡ä¼šè¢«ä¿å­˜åœ¨Depsä¸­ï¼Œæ•°æ®å˜åŠ¨çš„æ—¶å€™ä¼šç”±Depsé€šçŸ¥Watcherå®ä¾‹ï¼Œç„¶åç”±Watcherå®ä¾‹å›è°ƒcbè¿›è¡Œè§†å›¾çš„æ›´æ–°</p><pre><code class="js">export default class Watcher {  vm: Component;  expression: string;  cb: Function;  id: number;  deep: boolean;  user: boolean;  lazy: boolean;  sync: boolean;  dirty: boolean;  active: boolean;  deps: Array&lt;Dep&gt;;  newDeps: Array&lt;Dep&gt;;  depIds: ISet;  newDepIds: ISet;  getter: Function;  value: any;  constructor (    vm: Component,    expOrFn: string | Function,    cb: Function,    options?: Object  ) {    this.vm = vm    /*_watcherså­˜æ”¾è®¢é˜…è€…å®ä¾‹*/    vm._watchers.push(this)    // options    if (options) {      this.deep = !!options.deep      this.user = !!options.user      this.lazy = !!options.lazy      this.sync = !!options.sync    } else {      this.deep = this.user = this.lazy = this.sync = false    }    this.cb = cb    this.id = ++uid // uid for batching    this.active = true    this.dirty = this.lazy // for lazy watchers    this.deps = []    this.newDeps = []    this.depIds = new Set()    this.newDepIds = new Set()    this.expression = process.env.NODE_ENV !== &#39;production&#39;      ? expOrFn.toString()      : &#39;&#39;    // parse expression for getter    /*æŠŠè¡¨è¾¾å¼expOrFnè§£ææˆgetter*/    if (typeof expOrFn === &#39;function&#39;) {      this.getter = expOrFn    } else {      this.getter = parsePath(expOrFn)      if (!this.getter) {        this.getter = function () {}        process.env.NODE_ENV !== &#39;production&#39; &amp;&amp; warn(          `Failed watching path: &quot;${expOrFn}&quot; ` +          &#39;Watcher only accepts simple dot-delimited paths. &#39; +          &#39;For full control, use a function instead.&#39;,          vm        )      }    }    this.value = this.lazy      ? undefined      : this.get()  }  /**   * Evaluate the getter, and re-collect dependencies.   */   /*è·å¾—getterçš„å€¼å¹¶ä¸”é‡æ–°è¿›è¡Œä¾èµ–æ”¶é›†*/  get () {    /*å°†è‡ªèº«watcherè§‚å¯Ÿè€…å®ä¾‹è®¾ç½®ç»™Dep.targetï¼Œç”¨ä»¥ä¾èµ–æ”¶é›†ã€‚*/    pushTarget(this)    let value    const vm = this.vm    /*      æ‰§è¡Œäº†getteræ“ä½œï¼Œçœ‹ä¼¼æ‰§è¡Œäº†æ¸²æŸ“æ“ä½œï¼Œå…¶å®æ˜¯æ‰§è¡Œäº†ä¾èµ–æ”¶é›†ã€‚      åœ¨å°†Dep.targetè®¾ç½®ä¸ºè‡ªç”Ÿè§‚å¯Ÿè€…å®ä¾‹ä»¥åï¼Œæ‰§è¡Œgetteræ“ä½œã€‚      è­¬å¦‚è¯´ç°åœ¨çš„çš„dataä¸­å¯èƒ½æœ‰aã€bã€cä¸‰ä¸ªæ•°æ®ï¼Œgetteræ¸²æŸ“éœ€è¦ä¾èµ–aè·Ÿcï¼Œ      é‚£ä¹ˆåœ¨æ‰§è¡Œgetterçš„æ—¶å€™å°±ä¼šè§¦å‘aè·Ÿcä¸¤ä¸ªæ•°æ®çš„getterå‡½æ•°ï¼Œ      åœ¨getterå‡½æ•°ä¸­å³å¯åˆ¤æ–­Dep.targetæ˜¯å¦å­˜åœ¨ç„¶åå®Œæˆä¾èµ–æ”¶é›†ï¼Œ      å°†è¯¥è§‚å¯Ÿè€…å¯¹è±¡æ”¾å…¥é—­åŒ…ä¸­çš„Depçš„subsä¸­å»ã€‚    */    if (this.user) {      try {        value = this.getter.call(vm, vm)      } catch (e) {        handleError(e, vm, `getter for watcher &quot;${this.expression}&quot;`)      }    } else {      value = this.getter.call(vm, vm)    }    // &quot;touch&quot; every property so they are all tracked as    // dependencies for deep watching    /*å¦‚æœå­˜åœ¨deepï¼Œåˆ™è§¦å‘æ¯ä¸ªæ·±å±‚å¯¹è±¡çš„ä¾èµ–ï¼Œè¿½è¸ªå…¶å˜åŒ–*/    if (this.deep) {      /*é€’å½’æ¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œè§¦å‘å®ƒä»¬çš„getterï¼Œä½¿å¾—å¯¹è±¡æˆ–æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜éƒ½è¢«ä¾èµ–æ”¶é›†ï¼Œå½¢æˆä¸€ä¸ªâ€œæ·±ï¼ˆdeepï¼‰â€ä¾èµ–å…³ç³»*/      traverse(value)    }    /*å°†è§‚å¯Ÿè€…å®ä¾‹ä»targetæ ˆä¸­å–å‡ºå¹¶è®¾ç½®ç»™Dep.target*/    popTarget()    this.cleanupDeps()    return value  }  /**   * Add a dependency to this directive.   */   /*æ·»åŠ ä¸€ä¸ªä¾èµ–å…³ç³»åˆ°Depsé›†åˆä¸­*/  addDep (dep: Dep) {    const id = dep.id    if (!this.newDepIds.has(id)) {      this.newDepIds.add(id)      this.newDeps.push(dep)      if (!this.depIds.has(id)) {        dep.addSub(this)      }    }  }  /**   * Clean up for dependency collection.   */   /*æ¸…ç†ä¾èµ–æ”¶é›†*/  cleanupDeps () {    /*ç§»é™¤æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡*/    let i = this.deps.length    while (i--) {      const dep = this.deps[i]      if (!this.newDepIds.has(dep.id)) {        dep.removeSub(this)      }    }    let tmp = this.depIds    this.depIds = this.newDepIds    this.newDepIds = tmp    this.newDepIds.clear()    tmp = this.deps    this.deps = this.newDeps    this.newDeps = tmp    this.newDeps.length = 0  }  /**   * Subscriber interface.   * Will be called when a dependency changes.   */   /*      è°ƒåº¦è€…æ¥å£ï¼Œå½“ä¾èµ–å‘ç”Ÿæ”¹å˜çš„æ—¶å€™è¿›è¡Œå›è°ƒã€‚   */  update () {    /* istanbul ignore else */    if (this.lazy) {      this.dirty = true    } else if (this.sync) {      /*åŒæ­¥åˆ™æ‰§è¡Œrunç›´æ¥æ¸²æŸ“è§†å›¾*/      this.run()    } else {      /*å¼‚æ­¥æ¨é€åˆ°è§‚å¯Ÿè€…é˜Ÿåˆ—ä¸­ï¼Œç”±è°ƒåº¦è€…è°ƒç”¨ã€‚*/      queueWatcher(this)    }  }  /**   * Scheduler job interface.   * Will be called by the scheduler.   */   /*      è°ƒåº¦è€…å·¥ä½œæ¥å£ï¼Œå°†è¢«è°ƒåº¦è€…å›è°ƒã€‚    */  run () {    if (this.active) {      const value = this.get()      if (        value !== this.value ||        // Deep watchers and watchers on Object/Arrays should fire even        // when the value is the same, because the value may        // have mutated.        /*            å³ä¾¿å€¼ç›¸åŒï¼Œæ‹¥æœ‰Deepå±æ€§çš„è§‚å¯Ÿè€…ä»¥åŠåœ¨å¯¹è±¡ï¼æ•°ç»„ä¸Šçš„è§‚å¯Ÿè€…åº”è¯¥è¢«è§¦å‘æ›´æ–°ï¼Œå› ä¸ºå®ƒä»¬çš„å€¼å¯èƒ½å‘ç”Ÿæ”¹å˜ã€‚        */        isObject(value) ||        this.deep      ) {        // set new value        const oldValue = this.value        /*è®¾ç½®æ–°çš„å€¼*/        this.value = value        /*è§¦å‘å›è°ƒæ¸²æŸ“è§†å›¾*/        if (this.user) {          try {            this.cb.call(this.vm, value, oldValue)          } catch (e) {            handleError(e, this.vm, `callback for watcher &quot;${this.expression}&quot;`)          }        } else {          this.cb.call(this.vm, value, oldValue)        }      }    }  }  /**   * Evaluate the value of the watcher.   * This only gets called for lazy watchers.   */   /*è·å–è§‚å¯Ÿè€…çš„å€¼*/  evaluate () {    this.value = this.get()    this.dirty = false  }  /**   * Depend on all deps collected by this watcher.   */   /*æ”¶é›†è¯¥watcherçš„æ‰€æœ‰depsä¾èµ–*/  depend () {    let i = this.deps.length    while (i--) {      this.deps[i].depend()    }  }  /**   * Remove self from all dependencies&#39; subscriber list.   */   /*å°†è‡ªèº«ä»æ‰€æœ‰ä¾èµ–æ”¶é›†è®¢é˜…åˆ—è¡¨åˆ é™¤*/  teardown () {    if (this.active) {      // remove self from vm&#39;s watcher list      // this is a somewhat expensive operation so we skip it      // if the vm is being destroyed.      /*ä»vmå®ä¾‹çš„è§‚å¯Ÿè€…åˆ—è¡¨ä¸­å°†è‡ªèº«ç§»é™¤ï¼Œç”±äºè¯¥æ“ä½œæ¯”è¾ƒè€—è´¹èµ„æºï¼Œæ‰€ä»¥å¦‚æœvmå®ä¾‹æ­£åœ¨è¢«é”€æ¯åˆ™è·³è¿‡è¯¥æ­¥éª¤ã€‚*/      if (!this.vm._isBeingDestroyed) {        remove(this.vm._watchers, this)      }      let i = this.deps.length      while (i--) {        this.deps[i].removeSub(this)      }      this.active = false    }  }}</code></pre><h2 id="Dep"><a href="#Dep" class="headerlink" title="Dep"></a>Dep</h2><p>æ¥çœ‹çœ‹Depç±»ã€‚å…¶å®Depå°±æ˜¯ä¸€ä¸ªå‘å¸ƒè€…ï¼Œå¯ä»¥è®¢é˜…å¤šä¸ªè§‚å¯Ÿè€…ï¼Œä¾èµ–æ”¶é›†ä¹‹åDepsä¸­ä¼šå­˜åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªWatcherå¯¹è±¡ï¼Œåœ¨æ•°æ®å˜æ›´çš„æ—¶å€™é€šçŸ¥æ‰€æœ‰çš„Watcherã€‚</p><pre><code class="js">/** * A dep is an observable that can have multiple * directives subscribing to it. */export default class Dep {  static target: ?Watcher;  id: number;  subs: Array&lt;Watcher&gt;;  constructor () {    this.id = uid++    this.subs = []  }  /*æ·»åŠ ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡*/  addSub (sub: Watcher) {    this.subs.push(sub)  }  /*ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡*/  removeSub (sub: Watcher) {    remove(this.subs, sub)  }  /*ä¾èµ–æ”¶é›†ï¼Œå½“å­˜åœ¨Dep.targetçš„æ—¶å€™æ·»åŠ è§‚å¯Ÿè€…å¯¹è±¡*/  depend () {    if (Dep.target) {      Dep.target.addDep(this)    }  }  /*é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…*/  notify () {    // stabilize the subscriber list first    const subs = this.subs.slice()    for (let i = 0, l = subs.length; i &lt; l; i++) {      subs[i].update()    }  }}// the current target watcher being evaluated.// this is globally unique because there could be only one// watcher being evaluated at any time.Dep.target = null/*ä¾èµ–æ”¶é›†å®Œéœ€è¦å°†Dep.targetè®¾ä¸ºnullï¼Œé˜²æ­¢åé¢é‡å¤æ·»åŠ ä¾èµ–ã€‚*/</code></pre><h2 id="defineReactive"><a href="#defineReactive" class="headerlink" title="defineReactive"></a>defineReactive</h2><p>æ¥ä¸‹æ¥æ˜¯defineReactiveã€‚defineReactiveçš„ä½œç”¨æ˜¯<strong>é€šè¿‡Object.definePropertyä¸ºæ•°æ®å®šä¹‰ä¸Šgetter\setteræ–¹æ³•ï¼Œè¿›è¡Œä¾èµ–æ”¶é›†åé—­åŒ…ä¸­çš„Depsä¼šå­˜æ”¾Watcherå¯¹è±¡</strong>ã€‚è§¦å‘setteræ”¹å˜æ•°æ®çš„æ—¶å€™ä¼šé€šçŸ¥Depsè®¢é˜…è€…é€šçŸ¥æ‰€æœ‰çš„Watcherè§‚å¯Ÿè€…å¯¹è±¡è¿›è¡Œè¯•å›¾çš„æ›´æ–°ã€‚</p><pre><code class="js">/** * Define a reactive property on an Object. */export function defineReactive (  obj: Object,  key: string,  val: any,  customSetter?: Function) {  /*åœ¨é—­åŒ…ä¸­å®šä¹‰ä¸€ä¸ªdepå¯¹è±¡*/  const dep = new Dep()  const property = Object.getOwnPropertyDescriptor(obj, key)  if (property &amp;&amp; property.configurable === false) {    return  }  /*å¦‚æœä¹‹å‰è¯¥å¯¹è±¡å·²ç»é¢„è®¾äº†getterä»¥åŠsetterå‡½æ•°åˆ™å°†å…¶å–å‡ºæ¥ï¼Œæ–°å®šä¹‰çš„getter/setterä¸­ä¼šå°†å…¶æ‰§è¡Œï¼Œä¿è¯ä¸ä¼šè¦†ç›–ä¹‹å‰å·²ç»å®šä¹‰çš„getter/setterã€‚*/  // cater for pre-defined getter/setters  const getter = property &amp;&amp; property.get  const setter = property &amp;&amp; property.set  /*å¯¹è±¡çš„å­å¯¹è±¡é€’å½’è¿›è¡Œobserveå¹¶è¿”å›å­èŠ‚ç‚¹çš„Observerå¯¹è±¡*/  let childOb = observe(val)  Object.defineProperty(obj, key, {    enumerable: true,    configurable: true,    get: function reactiveGetter () {      /*å¦‚æœåŸæœ¬å¯¹è±¡æ‹¥æœ‰getteræ–¹æ³•åˆ™æ‰§è¡Œ*/      const value = getter ? getter.call(obj) : val      if (Dep.target) {        /*è¿›è¡Œä¾èµ–æ”¶é›†*/        dep.depend()        if (childOb) {          /*å­å¯¹è±¡è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå…¶å®å°±æ˜¯å°†åŒä¸€ä¸ªwatcherè§‚å¯Ÿè€…å®ä¾‹æ”¾è¿›äº†ä¸¤ä¸ªdependä¸­ï¼Œä¸€ä¸ªæ˜¯æ­£åœ¨æœ¬èº«é—­åŒ…ä¸­çš„dependï¼Œå¦ä¸€ä¸ªæ˜¯å­å…ƒç´ çš„depend*/          childOb.dep.depend()        }        if (Array.isArray(value)) {          /*æ˜¯æ•°ç»„åˆ™éœ€è¦å¯¹æ¯ä¸€ä¸ªæˆå‘˜éƒ½è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå¦‚æœæ•°ç»„çš„æˆå‘˜è¿˜æ˜¯æ•°ç»„ï¼Œåˆ™é€’å½’ã€‚*/          dependArray(value)        }      }      return value    },    set: function reactiveSetter (newVal) {      /*é€šè¿‡getteræ–¹æ³•è·å–å½“å‰å€¼ï¼Œä¸æ–°å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸€è‡´åˆ™ä¸éœ€è¦æ‰§è¡Œä¸‹é¢çš„æ“ä½œ*/      const value = getter ? getter.call(obj) : val      /* eslint-disable no-self-compare */      if (newVal === value || (newVal !== newVal &amp;&amp; value !== value)) {        return      }      /* eslint-enable no-self-compare */      if (process.env.NODE_ENV !== &#39;production&#39; &amp;&amp; customSetter) {        customSetter()      }      if (setter) {        /*å¦‚æœåŸæœ¬å¯¹è±¡æ‹¥æœ‰setteræ–¹æ³•åˆ™æ‰§è¡Œsetter*/        setter.call(obj, newVal)      } else {        val = newVal      }      /*æ–°çš„å€¼éœ€è¦é‡æ–°è¿›è¡Œobserveï¼Œä¿è¯æ•°æ®å“åº”å¼*/      childOb = observe(newVal)      /*depå¯¹è±¡é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…*/      dep.notify()    }  })}</code></pre>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vuæºç ä¹‹ä¾èµ–æ”¶é›†</title>
      <link href="/2018/12/02/Vue/Vu%E6%BA%90%E7%A0%81%E4%B9%8B%E4%BE%9D%E8%B5%96%E6%94%B6%E9%9B%86/"/>
      <url>/2018/12/02/Vue/Vu%E6%BA%90%E7%A0%81%E4%B9%8B%E4%BE%9D%E8%B5%96%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆè¦ä¾èµ–æ”¶é›†ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ä¾èµ–æ”¶é›†ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä¾èµ–æ”¶é›†ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ä¾èµ–æ”¶é›†ï¼Ÿ</h1><p>å…ˆçœ‹è¿™æ®µä»£ç </p><pre><code class="js">new Vue({    template:         `&lt;div&gt;            &lt;span&gt;text1:&lt;/span&gt; {{text1}}            &lt;span&gt;text2:&lt;/span&gt; {{text2}}        &lt;div&gt;`,    data: {        text1: &#39;text1&#39;,        text2: &#39;text2&#39;,        text3: &#39;text3&#39;    }});</code></pre><p>æŒ‰ç…§ä¹‹å‰<a href="https://github.com/answershuto/learnVue/blob/master/docs/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86.MarkDown" target="_blank" rel="noopener">ã€Šå“åº”å¼åŸç†ã€‹</a>ä¸­çš„æ–¹æ³•ç»‘å®šåˆ™ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜â€”â€”text3åœ¨å®é™…æ¨¡æ¿ä¸­å¹¶æ²¡æœ‰è¢«ç”¨åˆ°ï¼Œç„¶è€Œå½“text3çš„æ•°æ®è¢«ä¿®æ”¹çš„æ—¶å€™ï¼ˆthis.text3 = â€˜testâ€™ï¼‰çš„æ—¶å€™ï¼ŒåŒæ ·ä¼šè§¦å‘text3çš„setterå¯¼è‡´é‡æ–°æ‰§è¡Œæ¸²æŸ“ï¼Œè¿™æ˜¾ç„¶ä¸æ­£ç¡®ã€‚</p><h2 id="å…ˆè¯´è¯´Dep"><a href="#å…ˆè¯´è¯´Dep" class="headerlink" title="å…ˆè¯´è¯´Dep"></a>å…ˆè¯´è¯´Dep</h2><p>å½“å¯¹dataä¸Šçš„å¯¹è±¡è¿›è¡Œä¿®æ”¹å€¼çš„æ—¶å€™ä¼šè§¦å‘å®ƒçš„<code>setter</code>ï¼Œé‚£ä¹ˆå–å€¼çš„æ—¶å€™è‡ªç„¶å°±ä¼šè§¦å‘<code>getter</code>äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦åœ¨æœ€å¼€å§‹è¿›è¡Œä¸€æ¬¡renderï¼Œé‚£ä¹ˆæ‰€æœ‰è¢«æ¸²æŸ“æ‰€ä¾èµ–çš„dataä¸­çš„æ•°æ®å°±ä¼šè¢«<code>getter</code>æ”¶é›†åˆ°<code>Dep</code>çš„<code>subs</code>ä¸­å»ã€‚åœ¨å¯¹dataä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹çš„æ—¶å€™<code>setter</code>åªä¼šè§¦å‘<code>Dep</code>çš„<code>subs</code>çš„å‡½æ•°ã€‚</p><p>å®šä¹‰ä¸€ä¸ªä¾èµ–æ”¶é›†ç±»Depã€‚</p><pre><code class="js">class Dep {    constructor () {        this.subs = [];    }    addSub (sub: Watcher) {        this.subs.push(sub)    }    removeSub (sub: Watcher) {        remove(this.subs, sub)    }    /*Github:https://github.com/answershuto*/    notify () {        // stabilize the subscriber list first        const subs = this.subs.slice()        for (let i = 0, l = subs.length; i &lt; l; i++) {            subs[i].update()        }    }}function remove (arr, item) {    if (arr.length) {        const index = arr.indexOf(item)        if (index &gt; -1) {            return arr.splice(index, 1)    }}</code></pre><h2 id="Watcher"><a href="#Watcher" class="headerlink" title="Watcher"></a>Watcher</h2><p>è®¢é˜…è€…ï¼Œå½“ä¾èµ–æ”¶é›†çš„æ—¶å€™ä¼š<code>addSub</code>åˆ°subä¸­ï¼Œåœ¨ä¿®æ”¹dataä¸­æ•°æ®çš„æ—¶å€™ä¼šè§¦å‘depå¯¹è±¡çš„<code>notify</code>ï¼Œé€šçŸ¥æ‰€æœ‰<code>Watcher</code>å¯¹è±¡å»ä¿®æ”¹å¯¹åº”è§†å›¾ã€‚</p><pre><code class="js">class Watcher {    constructor (vm, expOrFn, cb, options) {        this.cb = cb;        this.vm = vm;        /*åœ¨è¿™é‡Œå°†è§‚å¯Ÿè€…æœ¬èº«èµ‹å€¼ç»™å…¨å±€çš„targetï¼Œåªæœ‰è¢«targetæ ‡è®°è¿‡çš„æ‰ä¼šè¿›è¡Œä¾èµ–æ”¶é›†*/        Dep.target = this;        /*Github:https://github.com/answershuto*/        /*è§¦å‘æ¸²æŸ“æ“ä½œè¿›è¡Œä¾èµ–æ”¶é›†*/        this.cb.call(this.vm);    }    update () {        this.cb.call(this.vm);    }}</code></pre><a id="more"></a><h2 id="å¼€å§‹ä¾èµ–æ”¶é›†"><a href="#å¼€å§‹ä¾èµ–æ”¶é›†" class="headerlink" title="å¼€å§‹ä¾èµ–æ”¶é›†"></a>å¼€å§‹ä¾èµ–æ”¶é›†</h2><pre><code class="js">class Vue {    constructor(options) {        this._data = options.data;        observer(this._data, options.render);        let watcher = new Watcher(this, );    }}function defineReactive (obj, key, val, cb) {    /*åœ¨é—­åŒ…å†…å­˜å‚¨ä¸€ä¸ªDepå¯¹è±¡*/    const dep = new Dep();    Object.defineProperty(obj, key, {        enumerable: true,        configurable: true,        get: ()=&gt;{            if (Dep.target) {                /*Watcherå¯¹è±¡å­˜åœ¨å…¨å±€çš„Dep.targetä¸­*/                dep.addSub(Dep.target);            }        },        set:newVal=&gt; {            /*åªæœ‰ä¹‹å‰addSubä¸­çš„å‡½æ•°æ‰ä¼šè§¦å‘*/            dep.notify();        }    })}Dep.target = null;</code></pre><p>å°†è§‚å¯Ÿè€…Watcherå®ä¾‹èµ‹å€¼ç»™å…¨å±€çš„Dep.targetï¼Œç„¶åè§¦å‘renderæ“ä½œåªæœ‰è¢«Dep.targetæ ‡è®°è¿‡çš„æ‰ä¼šè¿›è¡Œä¾èµ–æ”¶é›†ã€‚æœ‰Dep.targetçš„å¯¹è±¡ä¼šå°†Watcherçš„å®ä¾‹pushåˆ°subsä¸­ï¼Œåœ¨å¯¹è±¡è¢«ä¿®æ”¹å‡ºå‘setteræ“ä½œçš„æ—¶å€™depä¼šè°ƒç”¨subsä¸­çš„Watcherå®ä¾‹çš„updateæ–¹æ³•è¿›è¡Œæ¸²æŸ“ã€‚</p><p><a href="https://github.com/answershuto/learnVue/blob/master/docs/%E4%BE%9D%E8%B5%96%E6%94%B6%E9%9B%86.MarkDown" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue æºç åˆ†æä¹‹å“åº”å¼åŸç†</title>
      <link href="/2018/11/25/Vue/vue-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/"/>
      <url>/2018/11/25/Vue/vue-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/answershuto/learnVue/blob/master/docs/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%86%8D%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A.MarkDown" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="å…³äºVue-js"><a href="#å…³äºVue-js" class="headerlink" title="å…³äºVue.js"></a>å…³äºVue.js</h1><p>Vue.jsæ˜¯ä¸€æ¬¾MVVMæ¡†æ¶ï¼Œä¸Šæ‰‹å¿«é€Ÿç®€å•æ˜“ç”¨ï¼Œé€šè¿‡å“åº”å¼åœ¨ä¿®æ”¹æ•°æ®çš„æ—¶å€™æ›´æ–°è§†å›¾ã€‚Vue.jsçš„å“åº”å¼åŸç†ä¾èµ–äº<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener">Object.defineProperty</a>ï¼Œå°¤å¤§å¤§åœ¨Vue.jsæ–‡æ¡£ä¸­å°±å·²ç»æåˆ°è¿‡ï¼Œè¿™ä¹Ÿæ˜¯Vue.jsä¸æ”¯æŒIE8 ä»¥åŠæ›´ä½ç‰ˆæœ¬æµè§ˆå™¨çš„åŸå› ã€‚Vueé€šè¿‡è®¾å®šå¯¹è±¡å±æ€§çš„ <code>setter/getter</code> æ–¹æ³•æ¥ç›‘å¬æ•°æ®çš„å˜åŒ–ï¼Œé€šè¿‡<code>getter</code>è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œè€Œæ¯ä¸ª<code>setter</code>æ–¹æ³•å°±æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œåœ¨æ•°æ®å˜æ›´çš„æ—¶å€™é€šçŸ¥è®¢é˜…è€…æ›´æ–°è§†å›¾ã€‚</p><h2 id="å°†æ•°æ®dataå˜æˆå¯è§‚å¯Ÿï¼ˆobservableï¼‰çš„"><a href="#å°†æ•°æ®dataå˜æˆå¯è§‚å¯Ÿï¼ˆobservableï¼‰çš„" class="headerlink" title="å°†æ•°æ®dataå˜æˆå¯è§‚å¯Ÿï¼ˆobservableï¼‰çš„"></a>å°†æ•°æ®dataå˜æˆå¯è§‚å¯Ÿï¼ˆobservableï¼‰çš„</h2><p>é‚£ä¹ˆVueæ˜¯å¦‚ä½•å°†æ‰€æœ‰dataä¸‹é¢çš„æ‰€æœ‰å±æ€§å˜æˆå¯è§‚å¯Ÿçš„ï¼ˆobservableï¼‰å‘¢ï¼Ÿ</p><pre><code class="js">function observable(value,cb){    Object.keys(value).forEach((key)=&gt; defineReactive(value, key, value[key] , cb));}function defineReactive (obj, key, val, cb) {    Object.defineProperty(obj, key, {        enumerable: true,        configurable: true,        get: ()=&gt;{            /*....ä¾èµ–æ”¶é›†ç­‰....*/            /*Github:https://github.com/answershuto*/            return val        },        set:newVal=&gt; {            val = newVal;            cb();/*è®¢é˜…è€…æ”¶åˆ°æ¶ˆæ¯çš„å›è°ƒ*/        }    })}class Vue(){    constructor(options){        this._data = options.data;        observe(this._data, options.render)    }}let app = new Vue({    el: &#39;#app&#39;,    data: {        text: &#39;text&#39;,        text2: &#39;text2&#39;    },    render(){        console.log(&quot;render&quot;);    }})</code></pre><p>ä¸ºäº†ä¾¿äºç†è§£ï¼Œé¦–å…ˆè€ƒè™‘ä¸€ç§æœ€ç®€å•çš„æƒ…å†µï¼Œä¸è€ƒè™‘æ•°ç»„ç­‰æƒ…å†µï¼Œä»£ç å¦‚ä¸Šæ‰€ç¤ºã€‚åœ¨initDataä¸­ä¼šè°ƒç”¨observeè¿™ä¸ªå‡½æ•°å°†Vueçš„æ•°æ®è®¾ç½®æˆobservableçš„ã€‚å½“_dataæ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™å°±ä¼šè§¦å‘setï¼Œå¯¹è®¢é˜…è€…è¿›è¡Œå›è°ƒï¼ˆåœ¨è¿™é‡Œæ˜¯renderï¼‰ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œéœ€è¦å¯¹app._data.textæ“ä½œæ‰ä¼šè§¦å‘setã€‚ä¸ºäº†å·æ‡’ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹ä¾¿çš„æ–¹æ³•é€šè¿‡app.textç›´æ¥è®¾ç½®å°±èƒ½è§¦å‘setå¯¹è§†å›¾è¿›è¡Œé‡ç»˜ã€‚é‚£ä¹ˆå°±éœ€è¦ç”¨åˆ°ä»£ç†ã€‚</p><h2 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h2><p>æˆ‘ä»¬å¯ä»¥åœ¨Vueçš„æ„é€ å‡½æ•°constructorä¸­ä¸ºdataæ‰§è¡Œä¸€ä¸ªä»£ç†<a href="https://github.com/vuejs/vue/blob/dev/src/core/instance/state.js#L33" target="_blank" rel="noopener">proxy</a>ã€‚è¿™æ ·æˆ‘ä»¬å°±æŠŠdataä¸Šé¢çš„å±æ€§ä»£ç†åˆ°äº†vmå®ä¾‹ä¸Šã€‚</p><pre><code class="js">_proxy.call(this, options.data);/*æ„é€ å‡½æ•°ä¸­*//*ä»£ç†*/function _proxy (data) {    const that = this;    Object.keys(data).forEach(key =&gt; {        Object.defineProperty(that, key, {            configurable: true,            enumerable: true,            get: function proxyGetter () {                return that._data[key];            },            set: function proxySetter (val) {                that._data[key] = val;            }        })    });}</code></pre><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨app.textä»£æ›¿app._data.textäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript å¤æ‚åˆ¤æ–­çš„æ›´ä¼˜é›…å†™æ³•</title>
      <link href="/2018/11/18/Js/JavaScript-%E5%A4%8D%E6%9D%82%E5%88%A4%E6%96%AD%E7%9A%84%E6%9B%B4%E4%BC%98%E9%9B%85%E5%86%99%E6%B3%95/"/>
      <url>/2018/11/18/Js/JavaScript-%E5%A4%8D%E6%9D%82%E5%88%A4%E6%96%AD%E7%9A%84%E6%9B%B4%E4%BC%98%E9%9B%85%E5%86%99%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5bdfef86e51d453bf8051bf8?utm_source=gold_browser_extension" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æˆ‘ä»¬ç¼–å†™jsä»£ç æ—¶ç»å¸¸é‡åˆ°å¤æ‚é€»è¾‘åˆ¤æ–­çš„æƒ…å†µï¼Œé€šå¸¸å¤§å®¶å¯ä»¥ç”¨if/elseæˆ–è€…switchæ¥å®ç°å¤šä¸ªæ¡ä»¶åˆ¤æ–­ï¼Œä½†è¿™æ ·ä¼šæœ‰ä¸ªé—®é¢˜ï¼Œéšç€é€»è¾‘å¤æ‚åº¦çš„å¢åŠ ï¼Œä»£ç ä¸­çš„if/else/switchä¼šå˜å¾—è¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œè¶Šæ¥è¶Šçœ‹ä¸æ‡‚ï¼Œé‚£ä¹ˆå¦‚ä½•æ›´ä¼˜é›…çš„å†™åˆ¤æ–­é€»è¾‘ï¼Œæœ¬æ–‡å¸¦ä½ è¯•ä¸€ä¸‹ã€‚</p><h2 id="ä¸¾ä¸ªä¾‹å­"><a href="#ä¸¾ä¸ªä¾‹å­" class="headerlink" title="ä¸¾ä¸ªä¾‹å­"></a>ä¸¾ä¸ªä¾‹å­</h2><pre><code class="js">/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param {number} status æ´»åŠ¨çŠ¶æ€ï¼š1 å¼€å›¢è¿›è¡Œä¸­ 2 å¼€å›¢å¤±è´¥ 3 å•†å“å”®ç½„ 4 å¼€å›¢æˆåŠŸ 5 ç³»ç»Ÿå–æ¶ˆ */const onButtonClick = (status)=&gt;{  if(status == 1){    sendLog(&#39;processing&#39;)    jumpTo(&#39;IndexPage&#39;)  }else if(status == 2){    sendLog(&#39;fail&#39;)    jumpTo(&#39;FailPage&#39;)  }else if(status == 3){    sendLog(&#39;fail&#39;)    jumpTo(&#39;FailPage&#39;)  }else if(status == 4){    sendLog(&#39;success&#39;)    jumpTo(&#39;SuccessPage&#39;)  }else if(status == 5){    sendLog(&#39;cancel&#39;)    jumpTo(&#39;CancelPage&#39;)  }else {    sendLog(&#39;other&#39;)    jumpTo(&#39;Index&#39;)  }}</code></pre><p>é€šè¿‡ä»£ç å¯ä»¥çœ‹åˆ°è¿™ä¸ªæŒ‰é’®çš„ç‚¹å‡»é€»è¾‘ï¼šæ ¹æ®ä¸åŒæ´»åŠ¨çŠ¶æ€åšä¸¤ä»¶äº‹æƒ…ï¼Œå‘é€æ—¥å¿—åŸ‹ç‚¹å’Œè·³è½¬åˆ°å¯¹åº”é¡µé¢ï¼Œå¤§å®¶å¯ä»¥å¾ˆè½»æ˜“çš„æå‡ºè¿™æ®µä»£ç çš„æ”¹å†™æ–¹æ¡ˆï¼Œswitchå‡ºåœºï¼š</p><pre><code class="js">/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param {number} status æ´»åŠ¨çŠ¶æ€ï¼š1 å¼€å›¢è¿›è¡Œä¸­ 2 å¼€å›¢å¤±è´¥ 3 å•†å“å”®ç½„ 4 å¼€å›¢æˆåŠŸ 5 ç³»ç»Ÿå–æ¶ˆ */const onButtonClick = (status)=&gt;{  switch (status){    case 1:      sendLog(&#39;processing&#39;)      jumpTo(&#39;IndexPage&#39;)      break    case 2:    case 3:      sendLog(&#39;fail&#39;)      jumpTo(&#39;FailPage&#39;)      break      case 4:      sendLog(&#39;success&#39;)      jumpTo(&#39;SuccessPage&#39;)      break    case 5:      sendLog(&#39;cancel&#39;)      jumpTo(&#39;CancelPage&#39;)      break    default:      sendLog(&#39;other&#39;)      jumpTo(&#39;Index&#39;)      break  }}</code></pre><a id="more"></a><p>å—¯ï¼Œè¿™æ ·çœ‹èµ·æ¥æ¯”if/elseæ¸…æ™°å¤šäº†ï¼Œç»†å¿ƒçš„åŒå­¦ä¹Ÿå‘ç°äº†å°æŠ€å·§ï¼Œcase 2å’Œcase 3é€»è¾‘ä¸€æ ·çš„æ—¶å€™ï¼Œå¯ä»¥çœå»æ‰§è¡Œè¯­å¥å’Œbreakï¼Œåˆ™case 2çš„æƒ…å†µè‡ªåŠ¨æ‰§è¡Œcase 3çš„é€»è¾‘ã€‚</p><p>è¿™æ—¶æœ‰åŒå­¦ä¼šè¯´ï¼Œè¿˜æœ‰æ›´ç®€å•çš„å†™æ³•ï¼šï¼ˆè¡¨é©±åŠ¨ç¼–ç¨‹ï¼‰</p><pre><code class="js">const actions = {  &#39;1&#39;: [&#39;processing&#39;,&#39;IndexPage&#39;],  &#39;2&#39;: [&#39;fail&#39;,&#39;FailPage&#39;],  &#39;3&#39;: [&#39;fail&#39;,&#39;FailPage&#39;],  &#39;4&#39;: [&#39;success&#39;,&#39;SuccessPage&#39;],  &#39;5&#39;: [&#39;cancel&#39;,&#39;CancelPage&#39;],  &#39;default&#39;: [&#39;other&#39;,&#39;Index&#39;],}/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param {number} status æ´»åŠ¨çŠ¶æ€ï¼š1å¼€å›¢è¿›è¡Œä¸­ 2å¼€å›¢å¤±è´¥ 3 å•†å“å”®ç½„ 4 å¼€å›¢æˆåŠŸ 5 ç³»ç»Ÿå–æ¶ˆ */const onButtonClick = (status)=&gt;{  let action = actions[status] || actions[&#39;default&#39;],      logName = action[0],      pageName = action[1]  sendLog(logName)  jumpTo(pageName)}</code></pre><p>ä¸Šé¢ä»£ç ç¡®å®çœ‹èµ·æ¥æ›´æ¸…çˆ½äº†ï¼Œè¿™ç§æ–¹æ³•çš„èªæ˜ä¹‹å¤„åœ¨äºï¼šå°†åˆ¤æ–­æ¡ä»¶ä½œä¸ºå¯¹è±¡çš„å±æ€§åï¼Œå°†å¤„ç†é€»è¾‘ä½œä¸ºå¯¹è±¡çš„å±æ€§å€¼ï¼Œåœ¨æŒ‰é’®ç‚¹å‡»çš„æ—¶å€™ï¼Œé€šè¿‡å¯¹è±¡å±æ€§æŸ¥æ‰¾çš„æ–¹å¼æ¥è¿›è¡Œé€»è¾‘åˆ¤æ–­ï¼Œè¿™ç§å†™æ³•ç‰¹åˆ«é€‚åˆ<strong>ä¸€å…ƒæ¡ä»¶åˆ¤æ–­</strong>çš„æƒ…å†µã€‚</p><p>æ˜¯ä¸æ˜¯è¿˜æœ‰å…¶ä»–å†™æ³•å‘¢ï¼Ÿ</p><pre><code class="js">const actions = new Map([  [1, [&#39;processing&#39;,&#39;IndexPage&#39;]],  [2, [&#39;fail&#39;,&#39;FailPage&#39;]],  [3, [&#39;fail&#39;,&#39;FailPage&#39;]],  [4, [&#39;success&#39;,&#39;SuccessPage&#39;]],  [5, [&#39;cancel&#39;,&#39;CancelPage&#39;]],  [&#39;default&#39;, [&#39;other&#39;,&#39;Index&#39;]]])/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param {number} status æ´»åŠ¨çŠ¶æ€ï¼š1 å¼€å›¢è¿›è¡Œä¸­ 2 å¼€å›¢å¤±è´¥ 3 å•†å“å”®ç½„ 4 å¼€å›¢æˆåŠŸ 5 ç³»ç»Ÿå–æ¶ˆ */const onButtonClick = (status)=&gt;{  let action = actions.get(status) || actions.get(&#39;default&#39;)  sendLog(action[0])  jumpTo(action[1])}</code></pre><p>è¿™æ ·å†™ç”¨åˆ°äº†es6é‡Œçš„<strong>Mapå¯¹è±¡</strong>ï¼Œæ˜¯ä¸æ˜¯æ›´çˆ½äº†ï¼ŸMapå¯¹è±¡å’ŒObjectå¯¹è±¡æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><blockquote><p>ä¸€ä¸ªå¯¹è±¡é€šå¸¸éƒ½æœ‰è‡ªå·±çš„åŸå‹ï¼Œæ‰€ä»¥ä¸€ä¸ªå¯¹è±¡æ€»æœ‰ä¸€ä¸ªâ€prototypeâ€é”®ã€‚<br>ä¸€ä¸ªå¯¹è±¡çš„é”®åªèƒ½æ˜¯å­—ç¬¦ä¸²æˆ–è€…Symbolsï¼Œä½†ä¸€ä¸ªMapçš„é”®å¯ä»¥æ˜¯ä»»æ„å€¼ã€‚<br>ä½ å¯ä»¥é€šè¿‡sizeå±æ€§å¾ˆå®¹æ˜“åœ°å¾—åˆ°ä¸€ä¸ªMapçš„é”®å€¼å¯¹ä¸ªæ•°ï¼Œè€Œå¯¹è±¡çš„é”®å€¼å¯¹ä¸ªæ•°åªèƒ½æ‰‹åŠ¨ç¡®è®¤ã€‚</p></blockquote><p>æˆ‘ä»¬éœ€è¦æŠŠé—®é¢˜å‡çº§ä¸€ä¸‹ï¼Œä»¥å‰æŒ‰é’®ç‚¹å‡»æ—¶å€™åªéœ€è¦åˆ¤æ–­statusï¼Œç°åœ¨è¿˜éœ€è¦åˆ¤æ–­ç”¨æˆ·çš„èº«ä»½ï¼š</p><pre><code class="js">/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param {number} status æ´»åŠ¨çŠ¶æ€ï¼š1å¼€å›¢è¿›è¡Œä¸­ 2å¼€å›¢å¤±è´¥ 3 å¼€å›¢æˆåŠŸ 4 å•†å“å”®ç½„ 5 æœ‰åº“å­˜æœªå¼€å›¢ * @param {string} identity èº«ä»½æ ‡è¯†ï¼šguestå®¢æ€ masterä¸»æ€ */const onButtonClick = (status,identity)=&gt;{  if(identity == &#39;guest&#39;){    if(status == 1){      //do sth    }else if(status == 2){      //do sth    }else if(status == 3){      //do sth    }else if(status == 4){      //do sth    }else if(status == 5){      //do sth    }else {      //do sth    }  }else if(identity == &#39;master&#39;) {    if(status == 1){      //do sth    }else if(status == 2){      //do sth    }else if(status == 3){      //do sth    }else if(status == 4){      //do sth    }else if(status == 5){      //do sth    }else {      //do sth    }  }}</code></pre><p>åŸè°…æˆ‘ä¸å†™æ¯ä¸ªåˆ¤æ–­é‡Œçš„å…·ä½“é€»è¾‘äº†ï¼Œå› ä¸ºä»£ç å¤ªå†—é•¿äº†ã€‚<br>åŸè°…æˆ‘åˆç”¨äº†if/elseï¼Œå› ä¸ºæˆ‘çœ‹åˆ°å¾ˆå¤šäººä¾ç„¶åœ¨ç”¨if/elseå†™è¿™ç§å¤§æ®µçš„é€»è¾‘åˆ¤æ–­ã€‚<br>ä»ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ä½ çš„é€»è¾‘å‡çº§ä¸ºäºŒå…ƒåˆ¤æ–­æ—¶ï¼Œä½ çš„åˆ¤æ–­é‡ä¼šåŠ å€ï¼Œä½ çš„ä»£ç é‡ä¹Ÿä¼šåŠ å€ï¼Œè¿™æ—¶æ€ä¹ˆå†™æ›´æ¸…çˆ½å‘¢ï¼Ÿ</p><pre><code class="js">const actions = new Map([  [&#39;guest_1&#39;, ()=&gt;{/*do sth*/}],  [&#39;guest_2&#39;, ()=&gt;{/*do sth*/}],  [&#39;guest_3&#39;, ()=&gt;{/*do sth*/}],  [&#39;guest_4&#39;, ()=&gt;{/*do sth*/}],  [&#39;guest_5&#39;, ()=&gt;{/*do sth*/}],  [&#39;master_1&#39;, ()=&gt;{/*do sth*/}],  [&#39;master_2&#39;, ()=&gt;{/*do sth*/}],  [&#39;master_3&#39;, ()=&gt;{/*do sth*/}],  [&#39;master_4&#39;, ()=&gt;{/*do sth*/}],  [&#39;master_5&#39;, ()=&gt;{/*do sth*/}],  [&#39;default&#39;, ()=&gt;{/*do sth*/}],])/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param {string} identity èº«ä»½æ ‡è¯†ï¼šguestå®¢æ€ masterä¸»æ€ * @param {number} status æ´»åŠ¨çŠ¶æ€ï¼š1 å¼€å›¢è¿›è¡Œä¸­ 2 å¼€å›¢å¤±è´¥ 3 å¼€å›¢æˆåŠŸ 4 å•†å“å”®ç½„ 5 æœ‰åº“å­˜æœªå¼€å›¢ */const onButtonClick = (identity,status)=&gt;{  let action = actions.get(`${identity}_${status}`) || actions.get(&#39;default&#39;)  action.call(this)}</code></pre><p>ä¸Šè¿°ä»£ç æ ¸å¿ƒé€»è¾‘æ˜¯ï¼š<strong>æŠŠä¸¤ä¸ªæ¡ä»¶æ‹¼æ¥æˆå­—ç¬¦ä¸²ï¼Œå¹¶é€šè¿‡ä»¥æ¡ä»¶æ‹¼æ¥å­—ç¬¦ä¸²ä½œä¸ºé”®ï¼Œä»¥å¤„ç†å‡½æ•°ä½œä¸ºå€¼çš„Mapå¯¹è±¡è¿›è¡ŒæŸ¥æ‰¾å¹¶æ‰§è¡Œ</strong>ï¼Œè¿™ç§å†™æ³•åœ¨å¤šå…ƒæ¡ä»¶åˆ¤æ–­æ—¶å€™å°¤å…¶å¥½ç”¨ã€‚</p><p>å½“ç„¶ä¸Šè¿°ä»£ç å¦‚æœç”¨Objectå¯¹è±¡æ¥å®ç°ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼š</p><pre><code class="js">const actions = {  &#39;guest_1&#39;:()=&gt;{/*do sth*/},  &#39;guest_2&#39;:()=&gt;{/*do sth*/},  //....}const onButtonClick = (identity,status)=&gt;{  let action = actions[`${identity}_${status}`] || actions[&#39;default&#39;]  action.call(this)}</code></pre><p>å¦‚æœæœ‰äº›åŒå­¦è§‰å¾—æŠŠæŸ¥è¯¢æ¡ä»¶æ‹¼æˆå­—ç¬¦ä¸²æœ‰ç‚¹åˆ«æ‰­ï¼Œé‚£è¿˜æœ‰ä¸€ç§æ–¹æ¡ˆï¼Œå°±æ˜¯<strong>ç”¨Mapå¯¹è±¡</strong>ï¼Œä»¥Objectå¯¹è±¡ä½œä¸ºkeyï¼š</p><pre><code class="js">const actions = new Map([  [{identity:&#39;guest&#39;,status:1},()=&gt;{/*do sth*/}],  [{identity:&#39;guest&#39;,status:2},()=&gt;{/*do sth*/}],  //...])const onButtonClick = (identity,status)=&gt;{  let action = [...actions].filter(([key,value])=&gt;(key.identity == identity &amp;&amp; key.status == status))  action.forEach(([key,value])=&gt;value.call(this))}</code></pre><p>æ˜¯ä¸æ˜¯åˆé«˜çº§äº†ä¸€ç‚¹ç‚¹ï¼Ÿ</p><p>è¿™é‡Œä¹Ÿçœ‹å‡ºæ¥Mapä¸Objectçš„åŒºåˆ«ï¼Œ<code>Mapå¯ä»¥ç”¨ä»»ä½•ç±»å‹çš„æ•°æ®ä½œä¸ºkey</code>ã€‚</p><p>æˆ‘ä»¬ç°åœ¨å†å°†éš¾åº¦å‡çº§ä¸€ç‚¹ç‚¹ï¼Œå‡å¦‚guestæƒ…å†µä¸‹ï¼Œstatus1-4çš„å¤„ç†é€»è¾‘éƒ½ä¸€æ ·æ€ä¹ˆåŠï¼Œæœ€å·®çš„æƒ…å†µæ˜¯è¿™æ ·ï¼š</p><pre><code class="js">const actions = new Map([  [{identity:&#39;guest&#39;,status:1},()=&gt;{/* functionA */}],  [{identity:&#39;guest&#39;,status:2},()=&gt;{/* functionA */}],  [{identity:&#39;guest&#39;,status:3},()=&gt;{/* functionA */}],  [{identity:&#39;guest&#39;,status:4},()=&gt;{/* functionA */}],  [{identity:&#39;guest&#39;,status:5},()=&gt;{/* functionB */}],  //...])</code></pre><p>å¥½ä¸€ç‚¹çš„å†™æ³•æ˜¯å°†å¤„ç†é€»è¾‘å‡½æ•°è¿›è¡Œç¼“å­˜ï¼š</p><pre><code class="js">const actions = ()=&gt;{  const functionA = ()=&gt;{/*do sth*/}  const functionB = ()=&gt;{/*do sth*/}  return new Map([    [{identity:&#39;guest&#39;,status:1},functionA],    [{identity:&#39;guest&#39;,status:2},functionA],    [{identity:&#39;guest&#39;,status:3},functionA],    [{identity:&#39;guest&#39;,status:4},functionA],    [{identity:&#39;guest&#39;,status:5},functionB],    //...  ])}const onButtonClick = (identity,status)=&gt;{  let action = [...actions()].filter(([key,value])=&gt;(key.identity == identity &amp;&amp; key.status == status))  action.forEach(([key,value])=&gt;value.call(this))}</code></pre><p>è¿™æ ·å†™å·²ç»èƒ½æ»¡è¶³æ—¥å¸¸éœ€æ±‚äº†ï¼Œä½†è®¤çœŸä¸€ç‚¹è®²ï¼Œä¸Šé¢é‡å†™äº†4æ¬¡functionAè¿˜æ˜¯æœ‰ç‚¹ä¸çˆ½ï¼Œå‡å¦‚åˆ¤æ–­æ¡ä»¶å˜å¾—ç‰¹åˆ«å¤æ‚ï¼Œæ¯”å¦‚identityæœ‰3ç§çŠ¶æ€ï¼Œstatusæœ‰10ç§çŠ¶æ€ï¼Œé‚£ä½ éœ€è¦å®šä¹‰30æ¡å¤„ç†é€»è¾‘ï¼Œè€Œå¾€å¾€è¿™äº›é€»è¾‘é‡Œé¢å¾ˆå¤šéƒ½æ˜¯ç›¸åŒçš„ï¼Œè¿™ä¼¼ä¹ä¹Ÿæ˜¯ç¬”è€…ä¸æƒ³æ¥å—çš„ï¼Œé‚£å¯ä»¥è¿™æ ·å®ç°:</p><pre><code class="js">const actions = ()=&gt;{  const functionA = ()=&gt;{/*do sth*/}  const functionB = ()=&gt;{/*do sth*/}  return new Map([    [/^guest_[1-4]$/,functionA],    [/^guest_5$/,functionB],    //...  ])}const onButtonClick = (identity,status)=&gt;{  let action = [...actions()].filter(([key,value])=&gt;(key.test(`${identity}_${status}`)))  action.forEach(([key,value])=&gt;value.call(this))}</code></pre><p>è¿™é‡ŒMapçš„ä¼˜åŠ¿æ›´åŠ å‡¸æ˜¾ï¼Œå¯ä»¥ç”¨æ­£åˆ™ç±»å‹ä½œä¸ºkeyäº†ï¼Œè¿™æ ·å°±æœ‰äº†æ— é™å¯èƒ½ï¼Œå‡å¦‚éœ€æ±‚å˜æˆï¼Œå‡¡æ˜¯guestæƒ…å†µéƒ½è¦å‘é€ä¸€ä¸ªæ—¥å¿—åŸ‹ç‚¹ï¼Œä¸åŒstatusæƒ…å†µä¹Ÿéœ€è¦å•ç‹¬çš„é€»è¾‘å¤„ç†ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™:</p><pre><code class="js">const actions = ()=&gt;{  const functionA = ()=&gt;{/*do sth*/}  const functionB = ()=&gt;{/*do sth*/}  const functionC = ()=&gt;{/*send log*/}  return new Map([    [/^guest_[1-4]$/,functionA],    [/^guest_5$/,functionB],    [/^guest_.*$/,functionC],    //...  ])}const onButtonClick = (identity,status)=&gt;{  let action = [...actions()].filter(([key,value])=&gt;(key.test(`${identity}_${status}`)))  action.forEach(([key,value])=&gt;value.call(this))}</code></pre><p>ä¹Ÿå°±æ˜¯è¯´<strong>åˆ©ç”¨æ•°ç»„å¾ªç¯çš„ç‰¹æ€§ï¼Œç¬¦åˆæ­£åˆ™æ¡ä»¶çš„é€»è¾‘éƒ½ä¼šè¢«æ‰§è¡Œï¼Œé‚£å°±å¯ä»¥åŒæ—¶æ‰§è¡Œå…¬å…±é€»è¾‘å’Œå•ç‹¬é€»è¾‘</strong>ï¼Œå› ä¸ºæ­£åˆ™çš„å­˜åœ¨ï¼Œä½ å¯ä»¥æ‰“å¼€æƒ³è±¡åŠ›è§£é”æ›´å¤šçš„ç©æ³•ï¼Œæœ¬æ–‡å°±ä¸èµ˜è¿°äº†ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡å·²ç»æ•™ä½ äº†8ç§é€»è¾‘åˆ¤æ–­å†™æ³•ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>if/else</li><li>switch</li><li>ä¸€å…ƒåˆ¤æ–­æ—¶ï¼šå­˜åˆ°Objecté‡Œ</li><li>ä¸€å…ƒåˆ¤æ–­æ—¶ï¼šå­˜åˆ°Mapé‡Œ</li><li>å¤šå…ƒåˆ¤æ–­æ—¶ï¼šå°†conditionæ‹¼æ¥æˆå­—ç¬¦ä¸²å­˜åˆ°Objecté‡Œ</li><li>å¤šå…ƒåˆ¤æ–­æ—¶ï¼šå°†conditionæ‹¼æ¥æˆå­—ç¬¦ä¸²å­˜åˆ°Mapé‡Œ</li><li>å¤šå…ƒåˆ¤æ–­æ—¶ï¼šå°†conditionå­˜ä¸ºObjectå­˜åˆ°Mapé‡Œ</li><li>å¤šå…ƒåˆ¤æ–­æ—¶ï¼šå°†conditionå†™ä½œæ­£åˆ™å­˜åˆ°Mapé‡Œ</li></ul><p>è‡³æ­¤ï¼Œæœ¬æ–‡ä¹Ÿå°†å‘Šä¸€æ®µè½ï¼Œæ„¿ä½ æœªæ¥çš„äººç”Ÿé‡Œï¼Œä¸åªæ˜¯æœ‰if/else/switchã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>websocketé€šä¿¡äº†è§£</title>
      <link href="/2018/11/04/HTTP/websocket%E9%80%9A%E4%BF%A1%E4%BA%86%E8%A7%A3/"/>
      <url>/2018/11/04/HTTP/websocket%E9%80%9A%E4%BF%A1%E4%BA%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="websocket"><a href="#websocket" class="headerlink" title="websocket"></a>websocket</h1><p>websocketæ˜¯HTML5å‡ºçš„åè®®ï¼Œä»–æ˜¯ä¸€ä¸ªæŒä¹…åŒ–çš„åè®®ã€‚</p><h2 id="websocketæ˜¯ä»€ä¹ˆæ ·çš„åè®®ï¼Œæœ‰ä»€ä¹ˆä¸ä¼˜ç‚¹ï¼Ÿ"><a href="#websocketæ˜¯ä»€ä¹ˆæ ·çš„åè®®ï¼Œæœ‰ä»€ä¹ˆä¸ä¼˜ç‚¹ï¼Ÿ" class="headerlink" title="websocketæ˜¯ä»€ä¹ˆæ ·çš„åè®®ï¼Œæœ‰ä»€ä¹ˆä¸ä¼˜ç‚¹ï¼Ÿ"></a>websocketæ˜¯ä»€ä¹ˆæ ·çš„åè®®ï¼Œæœ‰ä»€ä¹ˆä¸ä¼˜ç‚¹ï¼Ÿ</h2><p>é¦–å…ˆwebsocketæ˜¯ä¸€ä¸ªæŒä¹…åŒ–çš„åè®®ï¼Œåœ¨HTTPä¸­ä¸€ä¸ªrequeståªèƒ½æœ‰ä¸€ä¸ªresponse,è€Œä¸”è¿™ä¸ªresponseä¹Ÿæ˜¯è¢«åŠ¨çš„ï¼Œä¸èƒ½ä¸»åŠ¨å‘èµ·ã€‚</p><p>ä¸‹é¢æ˜¯ç”¨websocketè¯·æ±‚çš„headerå¤´</p><pre><code class="js">GET /chat HTTP/1.1Host: server.example.com//å‘ŠçŸ¥æœåŠ¡å™¨æ˜¯ä½¿ç”¨websocketçš„åè®®Upgrade: websocket   Connection: UpgradeSec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw== //æ˜¯ä¸€ä¸ªBase64 encodeçš„å€¼ï¼Œè¿™ä¸ªæ˜¯æµè§ˆå™¨éšæœºç”Ÿæˆçš„ï¼ŒéªŒè¯æœåŠ¡å™¨Sec-WebSocket-Protocol: chat, superchat  // æ˜¯ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å­—ç¬¦ä¸²ï¼Œç”¨æ¥åŒºåˆ†åŒURLä¸‹ï¼Œä¸åŒçš„æœåŠ¡æ‰€éœ€è¦çš„åè®®Sec-WebSocket-Version: 13 //  æ˜¯å‘Šè¯‰æœåŠ¡å™¨æ‰€ä½¿ç”¨çš„Websocket Draftï¼ˆåè®®ç‰ˆæœ¬ï¼‰Origin: http://example.com</code></pre><p>ä¸‹é¢æ˜¯æœåŠ¡å™¨çš„è¿”å›å¤´</p><pre><code class="js">HTTP/1.1 101 Switching ProtocolsUpgrade: websocketConnection: UpgradeSec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk=Sec-WebSocket-Protocol: chat</code></pre><p>ä¸‹é¢æ˜¯HTTPå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå·²ç»åˆ‡æ¢åè®®äº†</p><pre><code class="js">Upgrade: websocketConnection: Upgrade</code></pre><a id="more"></a><p>##ã€€websocketçš„ä½œç”¨</p><p>ajaxè½®è¯¢çš„åŸç†å¾ˆç®€å•ï¼Œæ¯éš”å‡ ç§’å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œè¯¢é—®æœåŠ¡å™¨æ˜¯å¦æœ‰ä¿¡æ¯ã€‚</p><p>http long pollçš„åŸç†ä¸ajaxè½®è¯¢å·®ä¸å¤šï¼Œä¸è¿‡  é‡‡ç”¨çš„æ˜¯é˜»å¡æ¨¡å‹ï¼ˆä¸€ç›´æ‰“ç”µè¯ï¼Œæ²¡æ”¶åˆ°å°±ä¸æŒ‚ç”µè¯ï¼‰</p><p>è¿™ä¸¤è€…å…±åŒçš„åœ°æ–¹éƒ½æ˜¯åœ¨ä¸æ–­åœ°å»ºç«‹HTTPè¿æ¥ï¼Œç­‰å¾…æœåŠ¡ç«¯å¤„ç†ï¼Œä¸Šé¢è¿™ä¸¤ç§éƒ½æ˜¯éå¸¸æ¶ˆè€—èµ„æºçš„ã€‚å¯ä»¥ä½“ç°å‡ºHTTPçš„å¦å¤–ä¸€ä¸ªç‰¹ç‚¹ï¼š<strong>è¢«åŠ¨æ€§</strong></p><p>å…¶å®æˆ‘ä»¬æ‰€ç”¨çš„ç¨‹åºæ˜¯è¦ç»è¿‡ä¸¤å±‚ä»£ç†çš„ï¼Œå³HTTPåè®®åœ¨Nginxç­‰æœåŠ¡å™¨çš„è§£æä¸‹ï¼Œç„¶åå†ä¼ é€ç»™ç›¸åº”çš„Handlerï¼ˆPHPç­‰ï¼‰æ¥å¤„ç†ã€‚<br>ç®€å•åœ°è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸å¿«é€Ÿçš„æ¥çº¿å‘˜ï¼ˆNginxï¼‰ï¼Œä»–è´Ÿè´£æŠŠé—®é¢˜è½¬äº¤ç»™ç›¸åº”çš„å®¢æœï¼ˆHandlerï¼‰ã€‚</p><p>Websocket <strong>åªéœ€è¦ä¸€æ¬¡HTTPæ¡æ‰‹ï¼Œæ‰€ä»¥è¯´æ•´ä¸ªé€šè®¯è¿‡ç¨‹æ˜¯å»ºç«‹åœ¨ä¸€æ¬¡è¿æ¥/çŠ¶æ€ä¸­ï¼Œä¹Ÿå°±é¿å…äº†HTTPçš„éçŠ¶æ€æ€§</strong>ï¼ŒæœåŠ¡ç«¯ä¼šä¸€ç›´çŸ¥é“ä½ çš„ä¿¡æ¯ï¼Œç›´åˆ°ä½ å…³é—­è¯·æ±‚ï¼Œè¿™æ ·å°±è§£å†³äº†æ¥çº¿å‘˜è¦åå¤è§£æHTTPåè®®ï¼Œè¿˜è¦æŸ¥çœ‹identity infoçš„ä¿¡æ¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> websocket </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>call stack</title>
      <link href="/2018/11/04/Js/call-stack/"/>
      <url>/2018/11/04/Js/call-stack/</url>
      
        <content type="html"><![CDATA[<h1 id="Call-Stack-è°ƒç”¨å †æ ˆ"><a href="#Call-Stack-è°ƒç”¨å †æ ˆ" class="headerlink" title="Call Stack(è°ƒç”¨å †æ ˆ)"></a>Call Stack(è°ƒç”¨å †æ ˆ)</h1><p>MDN(è§£é‡Šcall Stack)</p><hr><blockquote><p>A <strong>call stack</strong> is a mechanism for an interpreter (like the JavaScript interpreter in a web browser) to keep track of its place in a script that calls multiple functions â€” what function is currently being run, what functions are called from within that function and should be called next, etc.(è°ƒç”¨å †æ ˆæ˜¯ä¸€ç§æœºåˆ¶ï¼Œç”¨äºè§£é‡Šå™¨ï¼ˆå¦‚Webæµè§ˆå™¨ä¸­çš„JavaScriptè§£é‡Šå™¨ï¼‰è·Ÿè¸ªå…¶åœ¨è°ƒç”¨å¤šä¸ªå‡½æ•°çš„è„šæœ¬ä¸­çš„ä½ç½®â€”â€”å½“å‰æ­£åœ¨è¿è¡Œä»€ä¹ˆå‡½æ•°ã€åœ¨è¯¥å‡½æ•°ä¸­è°ƒç”¨ä»€ä¹ˆå‡½æ•°ä»¥åŠæ¥ä¸‹æ¥åº”è¯¥è°ƒç”¨ä»€ä¹ˆå‡½æ•°ï¼Œç­‰ç­‰ã€‚)</p></blockquote><ul><li>When a script calls a function, the interpreter adds it to the call stack and then starts carrying out the function.</li><li>Any functions that are called by that function are added to the call stack further up, and run where their calls are reached.</li><li>When the current function is finished, the interpreter takes it off the stack and resumes execution where it left off in the last code listing.</li><li>If the stack takes up more space than it had assigned to it, it results in a â€œstack overflowâ€ error.</li></ul><h2 id="è°ƒç”¨æ ˆ"><a href="#è°ƒç”¨æ ˆ" class="headerlink" title="è°ƒç”¨æ ˆ"></a>è°ƒç”¨æ ˆ</h2><p>è°ƒç”¨æ ˆæ˜¯ä¸€ç§æ•°æ®ç»“æ„ã€‚ä»–è®°å½•äº†æˆ‘ä»¬åœ¨ç¨‹åºä¸­çš„ä½ç½®ï¼›å¦‚æœæˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä»–å°±ä¼šå°†è¿™ä¸ªå‡½æ•°æ¨å…¥æ ˆé¡¶ï¼Œå½“æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°åï¼Œå°±ä¼šä»æ ˆé¡¶å¼¹å‡ºï¼Œè¿™å°±æ˜¯è°ƒç”¨æ ˆæ‰€åšçš„äº‹æƒ…ï¼›</p><pre><code class="js">function multiply(x,y){    return x * y;}function printSquare(x){    var s = multiply(x,x);    console.log(s)}printSquare(5);</code></pre><p>æ¯ä¸€ä¸ªè¿›å…¥è°ƒç”¨æ ˆçš„ç§°ä¸º<code>è°ƒç”¨å¸§</code>ã€‚<br><a id="more"></a><br>â€œå †æ ˆæº¢å‡ºâ€ï¼Œå½“ä½ è¾¾åˆ°è°ƒç”¨æ ˆçš„æœ€å¤§çš„å¤§å°çš„æ—¶å€™å°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼›è€Œä¸”è¿™ç›¸å½“å®¹æ˜“å‘ç”Ÿï¼Œç‰¹åˆ«æ˜¯åœ¨ä½ å†™é€’å½’çš„æ—¶å€™å´æ²¡æœ‰å…¨æ–¹ä½çš„æµ‹è¯•å®ƒã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p><pre><code class="js">function foo(){    foo();}foo()</code></pre><h2 id="ä»€ä¹ˆæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿ</h2><p>ç®€è€Œè¨€ä¹‹ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡å°±æ˜¯è¯„ä¼°å’Œæ‰§è¡ŒJavaScriptä»£ç ç¯å¢ƒçš„æŠ½è±¡æ¦‚å¿µã€‚æ¯å½“JavaScriptä»£ç åœ¨è¿è¡Œæ—¶ï¼Œä»–éƒ½æ˜¯åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­è¿è¡Œçš„ï¼›</p><h3 id="æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç±»å‹"><a href="#æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç±»å‹" class="headerlink" title="æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç±»å‹"></a>æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç±»å‹</h3><ul><li><p>å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡  è¿™æ˜¯é»˜è®¤æˆ–è€…è¯´åŸºç¡€çš„ä¸Šä¸‹æ–‡ï¼Œä»»ä½•ä¸åœ¨å‡½æ•°å†…éƒ¨çš„ä»£ç éƒ½åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­ã€‚å®ƒä¼šæ‰§è¡Œä¸¤ä»¶äº‹ï¼šåˆ›å»ºä¸€ä¸ªå…¨å±€çš„ window å¯¹è±¡ï¼ˆæµè§ˆå™¨çš„æƒ…å†µä¸‹ï¼‰ï¼Œå¹¶ä¸”è®¾ç½® this çš„å€¼ç­‰äºè¿™ä¸ªå…¨å±€å¯¹è±¡ã€‚<strong>ä¸€ä¸ªç¨‹åºä¸­åªä¼šæœ‰ä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡</strong>ã€‚</p></li><li><p>å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡  æ¯å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶, éƒ½ä¼šä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸Šä¸‹æ–‡ã€‚æ¯ä¸ªå‡½æ•°éƒ½æœ‰å®ƒè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä¸è¿‡æ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶åˆ›å»ºçš„ã€‚å‡½æ•°ä¸Šä¸‹æ–‡å¯ä»¥æœ‰ä»»æ„å¤šä¸ªã€‚æ¯å½“ä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«åˆ›å»ºï¼Œå®ƒä¼šæŒ‰å®šä¹‰çš„é¡ºåºï¼ˆå°†åœ¨åæ–‡è®¨è®ºï¼‰æ‰§è¡Œä¸€ç³»åˆ—æ­¥éª¤</p></li><li><p>evalå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ æ‰§è¡Œåœ¨ eval å‡½æ•°å†…éƒ¨çš„ä»£ç ä¹Ÿä¼šæœ‰å®ƒå±äºè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä½†ç”±äº JavaScript å¼€å‘è€…å¹¶ä¸ç»å¸¸ä½¿ç”¨ evalï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä¸ä¼šè®¨è®ºå®ƒ</p></li></ul><h3 id="æ‰§è¡Œæ ˆ"><a href="#æ‰§è¡Œæ ˆ" class="headerlink" title="æ‰§è¡Œæ ˆ"></a>æ‰§è¡Œæ ˆ</h3><p>æ‰§è¡Œæ ˆï¼Œä¹Ÿå°±æ˜¯åœ¨å…¶å®ƒç¼–ç¨‹è¯­è¨€ä¸­æ‰€è¯´çš„â€œè°ƒç”¨æ ˆâ€ï¼Œæ˜¯<strong>ä¸€ç§æ‹¥æœ‰ LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰æ•°æ®ç»“æ„</strong>çš„æ ˆï¼Œè¢«ç”¨æ¥å­˜å‚¨ä»£ç è¿è¡Œæ—¶åˆ›å»ºçš„æ‰€æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡<br>ã€‚<br>å½“ JavaScript å¼•æ“ç¬¬ä¸€æ¬¡é‡åˆ°ä½ çš„è„šæœ¬æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€çš„æ‰§è¡Œä¸Šä¸‹æ–‡å¹¶ä¸”å‹å…¥å½“å‰æ‰§è¡Œæ ˆã€‚æ¯å½“å¼•æ“é‡åˆ°ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œå®ƒä¼šä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å¹¶å‹å…¥æ ˆçš„é¡¶éƒ¨ã€‚<br>å¼•æ“ä¼šæ‰§è¡Œé‚£äº›æ‰§è¡Œä¸Šä¸‹æ–‡ä½äºæ ˆé¡¶çš„å‡½æ•°ã€‚å½“è¯¥å‡½æ•°æ‰§è¡Œç»“æŸæ—¶ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡ä»æ ˆä¸­å¼¹å‡ºï¼Œæ§åˆ¶æµç¨‹åˆ°è¾¾å½“å‰æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸Šä¸‹æ–‡ã€‚</p><h3 id="æ€ä¹ˆåˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿ"><a href="#æ€ä¹ˆåˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿ" class="headerlink" title="æ€ä¹ˆåˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿ"></a>æ€ä¹ˆåˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿ</h3><blockquote><p>åœ¨ JavaScript ä»£ç æ‰§è¡Œå‰ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡å°†ç»å†åˆ›å»ºé˜¶æ®µã€‚åœ¨åˆ›å»ºé˜¶æ®µä¼šå‘ç”Ÿä¸‰ä»¶äº‹ï¼š</p></blockquote><p>1.this å€¼çš„å†³å®šï¼Œå³æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„ This ç»‘å®šã€‚<br>2.åˆ›å»ºè¯æ³•ç¯å¢ƒç»„ä»¶ã€‚<br>3.åˆ›å»ºå˜é‡ç¯å¢ƒç»„ä»¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆå­¦è€…å¯èƒ½ä¸çŸ¥é“çš„vueæŠ€å·§</title>
      <link href="/2018/10/21/Vue/%E5%88%9D%E5%AD%A6%E8%80%85%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84vue%E6%8A%80%E5%B7%A7/"/>
      <url>/2018/10/21/Vue/%E5%88%9D%E5%AD%A6%E8%80%85%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84vue%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="æŠ€å·§-å‘ç‚¹"><a href="#æŠ€å·§-å‘ç‚¹" class="headerlink" title="æŠ€å·§/å‘ç‚¹"></a>æŠ€å·§/å‘ç‚¹</h1><h2 id="setTimeout-setInterval"><a href="#setTimeout-setInterval" class="headerlink" title="setTimeout/ setInterval"></a>setTimeout/ setInterval</h2><ul><li>åœºæ™¯ä¸€ ï¼šthisæŒ‡å‘æ”¹å˜æ— æ³•ç”¨thisè®¿é—®vueå®ä¾‹</li></ul><pre><code class="js">  mounted(){    setTimeout( function () {    //setIntervalåŒç†    console.log(this); //æ­¤æ—¶thisæŒ‡å‘Windowå¯¹è±¡    }ï¼Œ1000) ;  }</code></pre><ul><li>è§£å†³æ–¹æ³• :ä½¿ç”¨ç®­å¤´å‡½æ•°æˆ–è€…ç¼“å­˜this</li></ul><pre><code class="js">  //ç®­å¤´å‡½æ•°è®¿é—®thiså®ä¾‹å› ä¸ºç®­å¤´å‡½æ•°æœ¬èº«æ²¡æœ‰ç»‘å®šthis  setTimeout(() =&gt; {    console. log(this);},  500) ;    //ä½¿ç”¨å˜é‡è®¿é—®thiså®ä¾‹let self=this;  },1000);  setTimeout (function () {    console. log(self);//ä½¿ç”¨selfå˜é‡è®¿é—®thiså®ä¾‹  }, 1000) ;â€‹</code></pre><h3 id="setIntervalè·¯ç”±è·³è½¬ç»§ç»­è¿è¡Œå¹¶æ²¡æœ‰é”€æ¯"><a href="#setIntervalè·¯ç”±è·³è½¬ç»§ç»­è¿è¡Œå¹¶æ²¡æœ‰é”€æ¯" class="headerlink" title="setIntervalè·¯ç”±è·³è½¬ç»§ç»­è¿è¡Œå¹¶æ²¡æœ‰é”€æ¯"></a>setIntervalè·¯ç”±è·³è½¬ç»§ç»­è¿è¡Œå¹¶æ²¡æœ‰é”€æ¯</h3><blockquote><p>åœºæ™¯ä¸€ :æ¯”å¦‚ä¸€äº›å¼¹å¹•ï¼Œèµ°é©¬ç¯æ–‡å­—ï¼Œè¿™ç±»éœ€è¦å®šæ—¶è°ƒç”¨çš„ï¼Œè·¯ç”±è·³è½¬ä¹‹åï¼Œå› ä¸ºç»„ä»¶å·²ç»é”€æ¯äº†ï¼Œä½†æ˜¯setlntervalè¿˜æ²¡æœ‰é”€æ¯ï¼Œè¿˜åœ¨ç»§ç»­åå°è°ƒç”¨ï¼Œæ§åˆ¶å°ä¼šä¸æ–­æŠ¥é”™ï¼Œå¦‚æœè¿ç®—é‡å¤§çš„è¯ï¼Œæ— æ³•åŠæ—¶æ¸…é™¤ï¼Œä¼šå¯¼è‡´ä¸¥é‡çš„é¡µé¢å¡é¡¿ã€‚</p></blockquote><ul><li>è§£å†³æ–¹æ³• :åœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸbeforeDestroyåœæ­¢setInterval</li></ul><pre><code class="js">  created() {       this.intervalid = setInterval(() =&gt; {          this.layerError = &quot;&quot;;          this.Timer = null;      }, 100000);   }  beforeDestroy( ){    //æˆ‘é€šå¸¸æ˜¯æŠŠsetInterval( )å®šæ—¶å™¨èµ‹å€¼ç»™thiså®ä¾‹ï¼Œç„¶åå°±å¯ä»¥åƒä¸‹é¢è¿™ä¹ˆæš‚åœã€‚    clearInterval(this.intervalid);  }</code></pre><h2 id="Vueè·¯ç”±æ‹¦æˆªæµè§ˆå™¨åé€€å®ç°è‰ç¨¿ä¿å­˜ç±»ä¼¼éœ€æ±‚"><a href="#Vueè·¯ç”±æ‹¦æˆªæµè§ˆå™¨åé€€å®ç°è‰ç¨¿ä¿å­˜ç±»ä¼¼éœ€æ±‚" class="headerlink" title="Vueè·¯ç”±æ‹¦æˆªæµè§ˆå™¨åé€€å®ç°è‰ç¨¿ä¿å­˜ç±»ä¼¼éœ€æ±‚"></a>Vueè·¯ç”±æ‹¦æˆªæµè§ˆå™¨åé€€å®ç°è‰ç¨¿ä¿å­˜ç±»ä¼¼éœ€æ±‚</h2><ul><li><p>åœºæ™¯ä¸€ :ä¸ºäº†é˜²æ­¢ç”¨æˆ·çªç„¶ç¦»å¼€ï¼Œæ²¡æœ‰ä¿å­˜å·²è¾“å…¥çš„ä¿¡æ¯</p></li><li><p>è§£å†³æ–¹æ³• :</p></li></ul><pre><code class="js">â€‹  //åœ¨è·¯ç”±ç»„ä»¶ä¸­:mounted(){}ï¼Œ  beforeRouteLeave (to, from, next) {      if(ç”¨æˆ·å·²ç»è¾“å…¥ä¿¡æ¯){        //å‡ºç°å¼¹çª—æé†’ä¿å­˜è‰ç¨¿ï¼Œæˆ–è€…è‡ªåŠ¨åå°ä¸ºå…¶ä¿å­˜      }else{        next(true);//ç”¨æˆ·ç¦»å¼€      }  }â€‹</code></pre><h2 id="è‡ªå®šä¹‰ç»„ä»¶æ·»åŠ clickç­‰äº‹ä»¶ä¸ç”Ÿæ•ˆ"><a href="#è‡ªå®šä¹‰ç»„ä»¶æ·»åŠ clickç­‰äº‹ä»¶ä¸ç”Ÿæ•ˆ" class="headerlink" title="è‡ªå®šä¹‰ç»„ä»¶æ·»åŠ clickç­‰äº‹ä»¶ä¸ç”Ÿæ•ˆ"></a>è‡ªå®šä¹‰ç»„ä»¶æ·»åŠ clickç­‰äº‹ä»¶ä¸ç”Ÿæ•ˆ</h2><ul><li>åœºæ™¯ä¸€ :ä¸€äº›è‡ªå®šä¹‰ç»„ä»¶ï¼Œéœ€è¦é¢å¤–æ·»åŠ ä¸€äº›äº‹ä»¶æ¥å®ç°ä¸€äº›ç‰¹å®šéœ€æ±‚</li></ul><pre><code class="html">  &lt;template&gt;    &lt;el-progress type=&quot;circle&quot; :percentage=â€œ0&quot; @click=â€œstopProgressâ€&gt;&lt;/elprogress&gt;  &lt;/template&gt;  &lt;script&gt;    export default {       methods:{            stopProgress() {             console.log(&#39;åœæ­¢&#39;)            }        }    }  &lt;/script&gt;</code></pre><a id="more"></a><ul><li>è§£å†³æ–¹æ³•:ä½¿ç”¨.nativeä¿®é¥°ç¬¦</li></ul><pre><code class="html">  &lt;template&gt;    &lt;el-progress type=&quot;circle&quot; :percentage=â€œ0&quot; @click.native=â€œstopProgressâ€&gt;&lt;/el-progress&gt;  &lt;/template&gt;  &lt;script&gt;    export default {        methods:{            stopProgress() {             console.log(&#39;åœæ­¢&#39;)            }        }    }  &lt;/script&gt;</code></pre><h2 id="æ‰‹åŠ¨æ“æ§è‡ªå®šä¹‰ç»„ä»¶"><a href="#æ‰‹åŠ¨æ“æ§è‡ªå®šä¹‰ç»„ä»¶" class="headerlink" title="æ‰‹åŠ¨æ“æ§è‡ªå®šä¹‰ç»„ä»¶"></a>æ‰‹åŠ¨æ“æ§è‡ªå®šä¹‰ç»„ä»¶</h2><ul><li><p>åœºæ™¯ä¸€ :ä¸€äº›è‡ªå®šä¹‰ç»„ä»¶ï¼Œéœ€è¦å»è·å–ç»„ä»¶å¯¹è±¡è¿›è¡Œä¸€äº›å…¶ä»–çš„Domæ“ä½œ</p></li><li><p>è§£å†³æ–¹æ³• :ä½¿ç”¨refå±æ€§æš´éœ²ç»„ä»¶è·å–å¥æŸ„</p></li></ul><pre><code class="html">â€‹  &lt;template&gt;    &lt;el-progress type=&quot;circle&quot; :percentage=&quot;O&quot; ref=&quot;progress&quot;&gt;&lt;/el-progress&gt;&lt;/template&gt;  &lt;script&gt;    this.$refs.progress //ç»„ä»¶å¯¹è±¡å®ä¾‹ï¼Œ å¯ä»¥æ‰‹åŠ¨è°ƒç”¨ç»„ä»¶çš„å†…ç½®æ–¹æ³•å’Œå±æ€§    this.$refs.progress.$el //ç»„ä»¶ å¯¹è±¡çš„æœ€å¤–å±‚domå…ƒç´   &lt;/script&gt;â€‹</code></pre><h2 id="æ·±åº¦ä½œç”¨é€‰æ‹©å™¨"><a href="#æ·±åº¦ä½œç”¨é€‰æ‹©å™¨" class="headerlink" title="æ·±åº¦ä½œç”¨é€‰æ‹©å™¨"></a>æ·±åº¦ä½œç”¨é€‰æ‹©å™¨</h2><ul><li>åœºæ™¯ä¸€ : scopedçš„æ ·å¼ï¼Œå¸Œæœ›å½±å“åˆ°å­ç»„ä»¶çš„é»˜è®¤æ ·å¼</li></ul><blockquote><p>åœ¨æ ·å¼ä¸­è®¾ç½®å®Œscopedåœ¨æµè§ˆå™¨è§£æä¸ºå¦‚ä¸‹å›¾è¿™æ ·ï¼Œaæ˜¯ä¸ªdivï¼Œa divé‡Œé¢åŒ…å«ä¸€ä¸ªç»„ä»¶é‡Œé¢è§£æå®Œäº†divçš„æ ·å¼åå­—ä¸ºbï¼Œæƒ³åœ¨çˆ¶ç»„ä»¶å½±å“åˆ°å­ç»„ä»¶çš„é»˜è®¤æ ·å¼ã€‚</p></blockquote><p>è§£å†³æ–¹æ³•ï¼š</p><pre><code class="html">â€‹  &lt;style scoped&gt;    .a &gt;&gt;&gt; .b { /* ... */ }  &lt;/style&gt;    //æœ‰äº›åƒSassä¹‹ç±»çš„é¢„å¤„ç†å™¨æ— æ³•æ­£ç¡®è§£æ&gt;&gt;&gt;ã€‚è¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥ä½¿ç”¨/deep/æ“ä½œç¬¦å–è€Œä»£ä¹‹- - - -è¿™æ˜¯ä¸€ä¸ª&gt;&gt;&gt;çš„åˆ«åï¼ŒåŒæ ·å¯ä»¥æ­£å¸¸å·¥ä½œã€‚  &lt;style scoped lang=â€œscssâ€&gt;    .a /deep/ .b { /* ... */ }  &lt;/style&gt;</code></pre><h2 id="Vueæ•°ç»„-å¯¹è±¡æ›´æ–°è§†å›¾ä¸æ›´æ–°"><a href="#Vueæ•°ç»„-å¯¹è±¡æ›´æ–°è§†å›¾ä¸æ›´æ–°" class="headerlink" title="Vueæ•°ç»„/å¯¹è±¡æ›´æ–°è§†å›¾ä¸æ›´æ–°"></a>Vueæ•°ç»„/å¯¹è±¡æ›´æ–°è§†å›¾ä¸æ›´æ–°</h2><ul><li>åœºæ™¯ä¸€ :å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¹ æƒ¯äºè¿™æ ·æ“ä½œæ•°ç»„å’Œå¯¹è±¡</li></ul><pre><code class="js">â€‹  data() {     return {        arr: [1,2,3],        obj:{          a: 1,          b: 2         }    };   },â€‹  // æ•°ç»„æ›´æ–°è§†å›¾ä¸æ›´æ–°  this.arr[0] = &#39;OBKoro1&#39;;  this.arr.length = 1;  console.log(arr);// [&#39;OBKoro1&#39;];   // æ•°æ®æ›´æ–°ï¼Œå¯¹è±¡è§†å›¾ä¸æ›´æ–°      this.obj.c = &#39;OBKoro1&#39;;  delete this.obj.a;  console.log(obj);  // {b:2,c:&#39;OBKoro1&#39;}</code></pre><blockquote><p>è§£å†³æ–¹æ³• ï¼š</p></blockquote><ul><li><p>this. $set(ä½ è¦æ”¹å˜çš„æ•°ç»„/å¯¹è±¡ï¼Œä½ è¦æ”¹å˜çš„ä½ç½®/key,ä½ è¦æ”¹æˆä»€ä¹ˆvalue)</p></li><li><p>æ•°ç»„åŸç”Ÿæ–¹æ³•è§¦å‘è§†å›¾æ›´æ–°ï¼ˆ vueå®˜ç½‘å¯æŸ¥ï¼‰:</p></li><li><p>æ•´ä½“æ›¿æ¢æ•°ç»„/å¯¹è±¡</p></li></ul><p><img src="https://user-gold-cdn.xitu.io/2018/10/19/1668a00148264e2c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="vue"></p><h2 id="Vue-Filtersè¿‡æ»¤å™¨çš„ä½¿ç”¨"><a href="#Vue-Filtersè¿‡æ»¤å™¨çš„ä½¿ç”¨" class="headerlink" title="Vue Filtersè¿‡æ»¤å™¨çš„ä½¿ç”¨"></a>Vue Filtersè¿‡æ»¤å™¨çš„ä½¿ç”¨</h2><ul><li>åœºæ™¯ä¸€ :å¸¸è§çš„æ•°æ®æ–‡æœ¬çš„æ ¼å¼åŒ–</li></ul><pre><code class="js">  // åœ¨åŒèŠ±æ‹¬å·ä¸­  &lt;div&gt;{{ message | DateFormat }}&lt;/div&gt; //å±•ç¤ºæ­£ç¡®æ—¶é—´  // åœ¨&#39;v-bind&#39;ä¸­  &lt;div v-bind:id=&quot;rawId | formatId&quot;&gt;&lt;/div&gt;â€‹//   Demo:ä¸€ä¸ªæ—¥æœŸè¿‡æ»¤å™¨è¿”å›yyyy- MM-ddhh:mm:ssçš„æ ·å¼//   å¼•å…¥ä¸€ä¸ªæå‰å†™å¥½æ—¥æœŸæ ¼å¼åŒ–çš„js  import dayjs from &#39;dayjs&#39;;  export default {     data() {        return {                //æ—¶é—´æ¯«ç§’                message:18324798324789             }    },    filters: {        //ä¼ å…¥è¿›è¡Œæ—¥æœŸæ ¼å¼åŒ–      DateFormat(value) {        return dayjs(value).format(â€œYYYY-MM-DD HH:mm:ss&quot;)        }     }  }</code></pre><h2 id="Vueæ·±åº¦watchä¸watchç«‹å³è§¦å‘å›è°ƒ"><a href="#Vueæ·±åº¦watchä¸watchç«‹å³è§¦å‘å›è°ƒ" class="headerlink" title="Vueæ·±åº¦watchä¸watchç«‹å³è§¦å‘å›è°ƒ"></a>Vueæ·±åº¦watchä¸watchç«‹å³è§¦å‘å›è°ƒ</h2><ul><li><p>åœºæ™¯ä¸€ :åœ¨watché‡Œé¢ç›‘æµ‹å¯¹è±¡é‡Œé¢å¯¹åº”çš„å€¼æ˜¯ç›‘æµ‹ä¸åˆ°çš„ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•ã€‚</p></li><li><p>é€‰é¡¹: deep</p></li><li><p>åœ¨é€‰é¡¹å‚æ•°ä¸­æŒ‡å®šdeep:true,å¯ä»¥ç›‘å¬å¯¹è±¡ä¸­å­å±æ€§çš„å˜åŒ–ã€‚</p></li><li><p>é€‰é¡¹: immediate</p></li><li><p>åœ¨é€‰é¡¹å‚æ•°ä¸­æŒ‡å®šimmediate:true,å°†ç«‹å³ä»¥è¡¨è¾¾å¼çš„å½“å‰å€¼è§¦å‘å›è°ƒï¼Œä¹Ÿå°±æ˜¯é»˜è®¤è§¦å‘ä¸€æ¬¡ã€‚</p></li></ul><pre><code class="js">  watch: {    obj: {        handler(val, oldVal) {          console.log(&#39;å±æ€§å˜åŒ–è§¦å‘è¿™ä¸ªå›è°ƒ&#39;,val, oldVal);         },        deep: true // ç›‘æµ‹è¿™ä¸ªå¯¹è±¡ä¸­æ¯ä¸€ä¸ªå±æ€§çš„å˜åŒ–    },    step: { // å±æ€§ //watch       handler(val, oldVal) {        console.log(&quot;é»˜è®¤è§¦å‘ä¸€æ¬¡&quot;, val, oldVal);        },       immediate: true // é»˜è®¤è§¦å‘ä¸€æ¬¡    }  }</code></pre>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSSå¯¹æ¯” JavaScriptåŠ¨ç”»</title>
      <link href="/2018/08/26/%E6%9D%82%E6%96%87/CSS%E5%AF%B9%E6%AF%94-JavaScript%E5%8A%A8%E7%94%BB/"/>
      <url>/2018/08/26/%E6%9D%82%E6%96%87/CSS%E5%AF%B9%E6%AF%94-JavaScript%E5%8A%A8%E7%94%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨ç½‘é¡µä¸Šåˆ›å»ºåŠ¨ç”»æœ‰ä¸¤ç§ä¸»è¦æ–¹æ³•ï¼šä½¿ç”¨ CSS å’Œä½¿ç”¨ JavaScriptã€‚æ‚¨é€‰æ‹©å“ªç§æ–¹æ³•å®é™…ä¸Šå–å†³äºé¡¹ç›®çš„å…¶ä»–ä¾èµ–å…³ç³»ï¼Œä»¥åŠæ‚¨å°è¯•å®ç°ä»€ä¹ˆç±»å‹çš„æ•ˆæœã€‚</p><blockquote><p>TL;DR</p></blockquote><ul><li>ä½¿ç”¨ CSS åŠ¨ç”»æ¥å®ç°è¾ƒç®€å•çš„â€œä¸€æ¬¡æ€§â€è½¬æ¢ï¼Œä¾‹å¦‚åˆ‡æ¢ UI å…ƒç´ çŠ¶æ€ã€‚</li><li>å½“æ‚¨éœ€è¦é«˜çº§æ•ˆæœï¼ˆä¾‹å¦‚å¼¹è·³ã€åœæ­¢ã€æš‚åœã€å€’é€€æˆ–å‡é€Ÿï¼‰æ—¶ï¼Œè¯·ä½¿ç”¨ JavaScript åŠ¨ç”»ã€‚</li><li>å¦‚æœé€‰æ‹©ä½¿ç”¨ JavaScript æ¥ç¼–å†™åŠ¨ç”»ï¼Œå¯é€‰ç”¨ Web Animations API æˆ–ç”¨èµ·æ¥é¡ºæ‰‹çš„ç°ä»£æ¡†æ¶ã€‚</li></ul><p>å¤§å¤šæ•°åŸºæœ¬åŠ¨ç”»å¯ä»¥ä½¿ç”¨ CSS æˆ– JavaScript æ¥åˆ›å»ºï¼Œä½†å·¥ä½œé‡å’Œæ—¶é—´å°†æœ‰æ‰€ä¸åŒï¼ˆå¦è¯·å‚è€ƒ <a href="https://developers.google.com/web/fundamentals/design-and-ux/animations/animations-and-performance?hl=zh-cn#css-vs-javascript-performance" target="_blank" rel="noopener">CSS å¯¹æ¯” JavaScript çš„æ€§èƒ½</a>ï¼‰ã€‚æ¯ä¸€ç§æ–¹æ³•éƒ½æœ‰å…¶ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œä½†ä»¥ä¸‹å†…å®¹æ˜¯å¾ˆå¥½çš„æŒ‡å¯¼åŸåˆ™ï¼š</p><ul><li><p>å½“æ‚¨ä¸º UI å…ƒç´ é‡‡ç”¨è¾ƒå°çš„ç‹¬ç«‹çŠ¶æ€æ—¶ï¼Œä½¿ç”¨ CSSã€‚ CSS å˜æ¢å’ŒåŠ¨ç”»éå¸¸é€‚åˆäºä»ä¾§é¢å¼•å…¥å¯¼èˆªèœå•ï¼Œæˆ–æ˜¾ç¤ºå·¥å…·æç¤ºã€‚æœ€åï¼Œå¯ä»¥ä½¿ç”¨ JavaScript æ¥æ§åˆ¶çŠ¶æ€ï¼Œä½†åŠ¨ç”»æœ¬èº«æ˜¯é‡‡ç”¨ CSSã€‚</p></li><li><p>åœ¨éœ€è¦å¯¹åŠ¨ç”»è¿›è¡Œå¤§é‡æ§åˆ¶æ—¶ï¼Œä½¿ç”¨ JavaScriptã€‚ Web Animations API æ˜¯ä¸€ä¸ªåŸºäºæ ‡å‡†çš„æ–¹*æ³•ï¼Œç°å·²åœ¨ Chrome å’Œ Opera ä¸­æä¾›ã€‚è¯¥æ–¹æ³•å¯æä¾›å®é™…å¯¹è±¡ï¼Œéå¸¸é€‚åˆå¤æ‚çš„å¯¹è±¡å¯¼å‘å‹åº”ç”¨ã€‚åœ¨éœ€è¦åœæ­¢ã€æš‚åœã€å‡é€Ÿæˆ–å€’é€€æ—¶ï¼ŒJavaScript ä¹Ÿéå¸¸æœ‰ç”¨ã€‚</p></li><li><p>å¦‚æœæ‚¨éœ€è¦æ‰‹åŠ¨åè°ƒæ•´ä¸ªåœºæ™¯ï¼Œå¯ç›´æ¥ä½¿ç”¨ <code>requestAnimationFrame</code>ã€‚è¿™å±äºé«˜çº§ JavaScript æ–¹æ³•ï¼Œä½†å¦‚æœæ‚¨æ„å»ºæ¸¸æˆæˆ–ç»˜åˆ¶åˆ° HTML ç”»å¸ƒï¼Œåˆ™è¯¥æ–¹æ³•éå¸¸æœ‰ç”¨ã€‚</p></li></ul><p>æˆ–è€…ï¼Œå¦‚æœæ‚¨å·²ä½¿ç”¨åŒ…æ‹¬åŠ¨ç”»åŠŸèƒ½çš„ JavaScript æ¡†æ¶ï¼Œæ¯”å¦‚é€šè¿‡ jQuery çš„ .animate() æ–¹æ³•æˆ– GreenSock çš„ TweenMaxï¼Œåˆ™å¯èƒ½å‘ç°ç»§ç»­ä½¿ç”¨è¯¥æ–¹æ³•å®ç°åŠ¨ç”»åœ¨æ€»ä½“ä¸Šæ›´æ–¹ä¾¿ã€‚</p><a id="more"></a><h2 id="ä½¿ç”¨-CSS-ç¼–å†™åŠ¨ç”»"><a href="#ä½¿ç”¨-CSS-ç¼–å†™åŠ¨ç”»" class="headerlink" title="ä½¿ç”¨ CSS ç¼–å†™åŠ¨ç”»"></a>ä½¿ç”¨ CSS ç¼–å†™åŠ¨ç”»</h2><p>ä½¿ç”¨ CSS ç¼–å†™åŠ¨ç”»æ˜¯ä½¿å†…å®¹åœ¨å±å¹•ä¸Šç§»åŠ¨çš„æœ€ç®€å•æ–¹å¼ã€‚æ­¤æ–¹æ³•è¢«ç§°ä¸ºå£°æ˜å¼ï¼Œå› ä¸ºæ‚¨å¯ä»¥æŒ‡å®šæ‚¨æƒ³è¦çš„ç»“æœã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº› CSS ä»£ç ï¼Œè®©ä¸€ä¸ªå…ƒç´ åŒæ—¶åœ¨ X è½´å’Œ Y è½´ä¸Šç§»åŠ¨ 100pxã€‚å…¶å®ç°æ–¹æ³•æ˜¯ä½¿ç”¨ CSS å˜æ¢ï¼Œç”¨æ—¶è®¾ç½®ä¸º 500 æ¯«ç§’ã€‚å½“æ·»åŠ äº† move ç±»æ—¶ï¼Œtransform å€¼è¢«æ”¹å˜å¹¶ä¸”å˜æ¢å¼€å§‹ã€‚</p><pre><code class="js">.box {  -webkit-transform: translate(0, 0);  -webkit-transition: -webkit-transform 500ms;  transform: translate(0, 0);  transition: transform 500ms;}.box.move {  -webkit-transform: translate(100px, 100px);  transform: translate(100px, 100px);}</code></pre><p>é™¤äº†å˜æ¢çš„æŒç»­æ—¶é—´ä¹‹å¤–ï¼Œè¿˜æœ‰é’ˆå¯¹ç¼“åŠ¨çš„é€‰é¡¹ï¼Œç¼“åŠ¨åŸºæœ¬ä¸Šæ˜¯åŠ¨ç”»è¡¨ç°çš„æ–¹å¼</p><p>å¦‚æœåœ¨ä¸Šè¿°ä»£ç æ®µä¸­ï¼Œæ‚¨åˆ›å»ºå•ç‹¬çš„ CSS ç±»æ¥ç®¡ç†åŠ¨ç”»ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ JavaScript æ¥æ‰“å¼€å’Œå…³é—­æ¯ä¸ªåŠ¨ç”»ï¼š</p><pre><code class="js">box.classList.add(&#39;move&#39;)ï¼›</code></pre><p>æ­¤æ“ä½œå°†ç»™æ‚¨çš„åº”ç”¨å¸¦æ¥è‰¯å¥½çš„å¹³è¡¡ã€‚æ‚¨å¯ä»¥ä¾§é‡äºä½¿ç”¨ JavaScript æ¥ç®¡ç†çŠ¶æ€ï¼Œåªéœ€åœ¨ç›®æ ‡å…ƒç´ ä¸Šè®¾ç½®ç›¸åº”çš„ç±»ï¼Œè®©æµè§ˆå™¨å»å¤„ç†åŠ¨ç”»ã€‚å¦‚æœæ‚¨æŒ‰ç…§è¿™ç§æ–¹æ³•ï¼Œåˆ™å¯ä»¥ä¾¦å¬å…ƒç´ çš„ <code>transitionend</code> äº‹ä»¶ï¼Œä½†å‰ææ˜¯æ‚¨èƒ½å¤Ÿæ”¾å¼ƒå¯¹ Internet Explorer è¾ƒæ—§ç‰ˆæœ¬çš„æ”¯æŒï¼›IE 10 æ˜¯æ”¯æŒè¿™äº›äº‹ä»¶çš„é¦–ä¸ªç‰ˆæœ¬ã€‚æ‰€æœ‰å…¶ä»–æµè§ˆå™¨å‡å·²æ”¯æŒæ­¤äº‹ä»¶æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚</p><p>ä¾¦å¬å˜æ¢ç»“æŸæ‰€éœ€çš„ JavaScript å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="js">var box = document.querySelector(&#39;.box&#39;);box.addEventListener(&#39;transitionend&#39;, onTransitionEnd, false);function onTransitionEnd() {  // Handle the transition finishing.}</code></pre><p>é™¤äº†ä½¿ç”¨ CSS å˜æ¢ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ CSS åŠ¨ç”»ï¼Œè¿™å…è®¸æ‚¨å¯¹å•ä¸ªåŠ¨ç”»å…³é”®å¸§ã€æŒç»­æ—¶é—´å’Œè¿­ä»£è¿›è¡Œæ›´å¤šæ§åˆ¶ã€‚</p><p>ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä¸å˜æ¢ç›¸åŒçš„æ–¹å¼ä¸ºæ–¹æ¡†è®¾ç½®åŠ¨ç”»ï¼Œä½†æ˜¯è®¾ç½®åŠ¨ç”»æ—¶æ²¡æœ‰ä»»ä½•ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ç‚¹å‡»ï¼‰ï¼Œè€Œæ˜¯é‡‡ç”¨æ— é™é‡å¤ã€‚è¿˜å¯ä»¥åŒæ—¶æ›´æ”¹å¤šä¸ªå±æ€§ï¼š</p><pre><code class="css">/** * This is a simplified version without * vendor prefixes.With them included * (which you will need), things get far * more verbose! */.box {  /* Choose the animation */  animation-name: movingBox;  /* The animationâ€™s duration */  animation-duration: 1300ms;  /* The number of times we want      the animation to run */  animation-iteration-count: infinite;  /* Causes the animation to reverse      on every odd iteration */  animation-direction: alternate;}@keyframes movingBox {  0% {    transform: translate(0, 0);    opacity: 0.3;  }  25% {    opacity: 0.9;  }  50% {    transform: translate(100px, 100px);    opacity: 0.2;  }  100% {    transform: translate(30px, 30px);    opacity: 0.8;  }}</code></pre><p>å€ŸåŠ© CSS åŠ¨ç”»ï¼Œå¯ç‹¬ç«‹äºç›®æ ‡å…ƒç´ æ¥å®šä¹‰åŠ¨ç”»æœ¬èº«ï¼Œå¹¶ä¸”ä½¿ç”¨ animation-name å±æ€§æ¥é€‰æ‹©æ‰€éœ€çš„åŠ¨ç”»ã€‚</p><p>CSS åŠ¨ç”»åœ¨æŸç§ç¨‹åº¦ä¸Šä»é‡‡ç”¨ä¾›åº”å•†å‰ç¼€ï¼Œåœ¨ Safariã€Safari Mobile å’Œ Android æµè§ˆå™¨ä¸­ä½¿ç”¨-webkit-ã€‚Chromeã€Operaã€Internet Explorer å’Œ Firefox å‡ä¸é‡‡ç”¨å‰ç¼€ã€‚è®¸å¤šå·¥å…·å¯å¸®åŠ©æ‚¨åˆ›å»ºæ‰€éœ€çš„ CSS å‰ç¼€ç‰ˆæœ¬ï¼Œä½¿æ‚¨èƒ½å¤Ÿåœ¨æºæ–‡ä»¶ä¸­ç¼–å†™æ— å‰ç¼€çš„ç‰ˆæœ¬ã€‚</p><h2 id="ä½¿ç”¨-JavaScript-å’Œ-Web-Animations-API-ç¼–å†™åŠ¨ç”»"><a href="#ä½¿ç”¨-JavaScript-å’Œ-Web-Animations-API-ç¼–å†™åŠ¨ç”»" class="headerlink" title="ä½¿ç”¨ JavaScript å’Œ Web Animations API ç¼–å†™åŠ¨ç”»"></a>ä½¿ç”¨ JavaScript å’Œ Web Animations API ç¼–å†™åŠ¨ç”»</h2><p>æ¯”è¾ƒè€Œè¨€ï¼Œä½¿ç”¨ JavaScript åˆ›å»ºåŠ¨ç”»æ¯”ç¼–å†™ CSS å˜æ¢æˆ–åŠ¨ç”»æ›´å¤æ‚ï¼Œä½†å®ƒä¸€èˆ¬å¯ä¸ºå¼€å‘è€…æä¾›æ›´å¤šåŠŸèƒ½ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Web Animations API ç»™ç‰¹å®šçš„ CSS å±æ€§è®¾ç½®åŠ¨ç”»ï¼Œæˆ–æ„å»ºå¯ç»„åˆçš„æ•ˆæœå¯¹è±¡ã€‚</p><p>JavaScript åŠ¨ç”»æ˜¯å‘½ä»¤å¼ï¼Œå› ä¸ºæ‚¨å°†å®ƒä»¬ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†åµŒå…¥ä»£ç ä¸­ã€‚æ‚¨è¿˜å¯ä»¥å°†å®ƒä»¬å°è£…åœ¨å…¶ä»–å¯¹è±¡å†…ã€‚ä»¥ä¸‹æ˜¯åœ¨é‡æ–°åˆ›å»ºæˆ‘ä»¬ä¹‹å‰æ‰€è®¨è®ºçš„ CSS å˜æ¢æ—¶éœ€è¦ç¼–å†™çš„ JavaScriptï¼š</p><pre><code class="js">var target = document.querySelector(&#39;.box&#39;);var player = target.animate([  {transform: &#39;translate(0)&#39;},  {transform: &#39;translate(100px, 100px)&#39;}], 500);player.addEventListener(&#39;finish&#39;, function() {  target.style.transform = &#39;translate(100px, 100px)&#39;;});</code></pre><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒWeb Animations ä»…ä¿®æ”¹å…ƒç´ çš„å‘ˆç°å½¢å¼ã€‚å¦‚æœæ‚¨æƒ³è®©æ‚¨çš„å¯¹è±¡ä¿æŒåœ¨å®ƒå·²ç§»åŠ¨åˆ°çš„ä½ç½®ï¼Œåˆ™åº”åœ¨åŠ¨ç”»å®Œæˆæ—¶ï¼ŒæŒ‰ç…§æˆ‘ä»¬çš„ç¤ºä¾‹ä¿®æ”¹å…¶åº•å±‚æ ·å¼ã€‚</p><p>Web Animations API æ˜¯æ¥è‡ª W3C çš„æ–°æ ‡å‡†ï¼Œåœ¨ Chrome å’Œ Opera ä¸­å—åŸç”Ÿæ”¯æŒï¼Œä¸”æ­£åœ¨è¿›è¡Œé’ˆå¯¹ Firefox çš„å¼€å‘ã€‚å¯¹äºå…¶ä»–çš„ç°ä»£æµè§ˆå™¨ï¼Œæä¾› polyfillã€‚</p><p>ä½¿ç”¨ JavaScript åŠ¨ç”»ï¼Œæ‚¨å¯ä»¥å®Œå…¨æ§åˆ¶å…ƒç´ åœ¨æ¯ä¸ªæ­¥éª¤çš„æ ·å¼ã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥åœ¨æ‚¨è®¤ä¸ºåˆé€‚æ—¶å‡æ…¢åŠ¨ç”»ã€æš‚åœåŠ¨ç”»ã€åœæ­¢åŠ¨ç”»ã€å€’é€€åŠ¨ç”»å’Œæ“çºµå…ƒç´ ã€‚å¦‚æœæ‚¨æ­£åœ¨æ„å»ºå¤æ‚çš„å¯¹è±¡å¯¼å‘å‹åº”ç”¨ï¼Œåˆ™æ­¤æ–¹æ³•ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºæ‚¨å¯ä»¥æ­£ç¡®å°è£…æ‚¨çš„è¡Œä¸ºã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ‚æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ Redux-Saga ç®¡ç† React åº”ç”¨ä¸­çš„å¼‚æ­¥ action ï¼ˆä¸Šï¼‰</title>
      <link href="/2018/08/21/React/React-saga/%E4%BD%BF%E7%94%A8-Redux-Saga-%E7%AE%A1%E7%90%86-React-%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E5%BC%82%E6%AD%A5-action-%EF%BC%88%E4%B8%8A%EF%BC%89/"/>
      <url>/2018/08/21/React/React-saga/%E4%BD%BF%E7%94%A8-Redux-Saga-%E7%AE%A1%E7%90%86-React-%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E5%BC%82%E6%AD%A5-action-%EF%BC%88%E4%B8%8A%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¯ä»¥ç”¨<code>Donâ€™t call me, Iâ€™ll call you</code>è¿™å¥è¯æ¥æ¯”å–»<code>react-saga</code>ã€‚</p><h2 id="Generators-å…ˆè¡Œï¼"><a href="#Generators-å…ˆè¡Œï¼" class="headerlink" title="Generators å…ˆè¡Œï¼"></a>Generators å…ˆè¡Œï¼</h2><p>ä¸ºäº†ç†è§£ Sagasï¼Œæˆ‘ä»¬é¦–å…ˆè¦ç†è§£ä»€ä¹ˆæ˜¯ <code>Generator</code>ã€‚ä¸‹é¢æ˜¯ <a href="https://link.juejin.im/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FStatements%2Ffunction%252A">MDN</a> å¯¹ Generator çš„æè¿°ï¼š</p><blockquote><p>Generator æ˜¯åœ¨æ‰§è¡Œæ—¶èƒ½æš‚åœï¼Œåé¢åˆèƒ½ä»æš‚åœå¤„ç»§ç»­æ‰§è¡Œçš„å‡½æ•°ã€‚å®ƒçš„ä¸Šä¸‹æ–‡ä¼šåœ¨ç»§ç»­æ‰§è¡Œæ—¶ä¿å­˜ã€‚</p></blockquote><p>ä½ å¯ä»¥æŠŠ Generator ç†è§£æˆä¸€ç§éå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ï¼Œï¼ˆè¯‘æ³¨ï¼šGenerator æ‰§è¡Œåè¿”å›çš„éå†å™¨å¯¹è±¡ï¼‰æä¾›ä¸€ä¸ª <code>next</code> æ–¹æ³•ã€‚æ‰§è¡Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¿”å›ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œæˆ–è€…è¿”å›éå†ç»“æŸçš„çŠ¶æ€ã€‚è¿™å°±éœ€è¦ Generator èƒ½å¤Ÿç»´æŠ¤å†…éƒ¨çŠ¶æ€ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ Generator ç¤ºä¾‹ï¼Œå®ƒç”Ÿæˆçš„éå†å™¨å¯¹è±¡ä¼šè¿”å›å‡ ä¸ªå­—ç¬¦ä¸²ï¼š</p><pre><code class="js">function * helloWorld(){    yield hello;    yield world;    return helloWorld;}var f = helloWorld();f.next() // {value:&#39;hello&#39;,done:false}f.next() // {value:&#39;world&#39;,done:false}f.next() // {value:&#39;helloWorld&#39;,done:true}</code></pre><p>next æ–¹æ³•çš„è¿”å›å€¼ç»“æ„éå¸¸ç®€å• â€” åªè¦æˆ‘ä»¬é€šè¿‡ yield/return è¿”å›å€¼ï¼Œè¿™ä¸ªè¿”å›å€¼å°±æ˜¯ value å±æ€§çš„å€¼ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰è¿”å›å€¼ï¼Œvalue å±æ€§çš„å€¼å°±æ˜¯ undefinedï¼Œdone å±æ€§çš„å€¼å°±æ˜¯ trueã€‚<br>è¿˜æœ‰ä¸€ç‚¹å€¼çš„æ³¨æ„çš„æ˜¯ï¼Œæ‰§è¡Œ helloWorld åï¼Œå‡½æ•°ä¼šåœ¨è°ƒç”¨ yield çš„åœ°æ–¹åœä¸‹æ¥ã€‚å½“æˆ‘ä»¬è°ƒç”¨ next æ–¹æ³•åï¼Œå‡½æ•°ä¼šç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª yieldã€‚å¦‚æœæˆ‘ä»¬è°ƒç”¨äº† return è¯­å¥æˆ–è€…å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œdone å±æ€§å°±ä¼šä¸ºçœŸã€‚</p><ul><li>å¦‚æœçŠ¶æ€åºåˆ—çš„é•¿åº¦ä¸ç¡®å®šæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥å†™ï¼š</li></ul><pre><code class="js">var results = generator.next();while(!results.done){ console.log(results.value); results = generator.next();}console.log(results.value);</code></pre><h2 id="ä»€ä¹ˆæ˜¯-Sagasï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Sagasï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Sagasï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Sagasï¼Ÿ</h2><p>Sagas æ˜¯é€šè¿‡ Generator å‡½æ•°æ¥åˆ›å»ºçš„ã€‚<a href="https://link.juejin.im/?target=https%3A%2F%2Fgithub.com%2Fredux-saga%2Fredux-saga">å®˜æ–¹æ–‡æ¡£</a> çš„è§£é‡Šå¦‚ä¸‹ï¼š</p><blockquote><p>Saga å°±åƒåº”ç”¨ä¸­çš„ä¸€ä¸ªç‹¬ç«‹çº¿ç¨‹ï¼Œå®Œå…¨è´Ÿè´£ç®¡ç†å¼‚æ­¥ actionã€‚</p></blockquote><p>ä½ å¯ä»¥æŠŠ Saga æƒ³è±¡æˆä¸€ä¸ªä»¥æœ€å¿«é€Ÿåº¦ä¸æ–­åœ°è°ƒç”¨ next æ–¹æ³•å¹¶å°è¯•è·å–æ‰€æœ‰ yield è¡¨è¾¾å¼å€¼çš„çº¿ç¨‹ã€‚ä½ å¯èƒ½ä¼šé—®è¿™å’Œ React æœ‰ä»€ä¹ˆå…³ç³»ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒï¼Œæ‰€ä»¥é¦–å…ˆæ¥çœ‹çœ‹å¦‚ä½•åœ¨ React &amp; Redux åº”ç”¨ä½¿ç”¨ Sagaï¼š<br>åœ¨ React &amp; Redux åº”ç”¨ä¸­ï¼Œä¸€ä¸ªå¸¸è§çš„ç”¨æ³•ä»è°ƒç”¨ä¸€ä¸ª action å¼€å§‹ã€‚è¢«åˆ†é…ç”¨æ¥å¤„ç†è¿™ä¸ª action çš„ reducer ä¼šä½¿ç”¨æ–°çš„ state æ›´æ–° storeï¼Œéšåè§†å›¾å°±ä¼šè¢«æ›´æ–°æ¸²æŸ“ã€‚<br><a id="more"></a></p><p>å¦‚æœä¸€ä¸ª Saga è¢«åˆ†é…ç”¨æ¥å¤„ç†è¿™ä¸ª action â€” è¿™ä¸ª action é€šå¸¸å°±æ˜¯ä¸ªå¼‚æ­¥ actionï¼ˆæ¯”å¦‚ä¸€ä¸ªå¯¹æœåŠ¡ç«¯çš„è¯·æ±‚ï¼‰ï¼Œä¸€æ—¦è¿™ä¸ª action å®Œæˆåï¼ŒSaga ä¼šè°ƒç”¨å¦ä¸€ä¸ª action è®© reducer è¿›è¡Œå¤„ç†ã€‚</p><h2 id="å¸¸è§ç”¨ä¾‹"><a href="#å¸¸è§ç”¨ä¾‹" class="headerlink" title="å¸¸è§ç”¨ä¾‹"></a>å¸¸è§ç”¨ä¾‹</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå¸¸è§æµç¨‹æ¥è¯´æ˜ï¼š<br>ç”¨æˆ·ä¸é¡µé¢è¿›è¡Œäº¤äº’ï¼Œè¿™ä¸ªäº¤äº’åŠ¨ä½œä¼šè§¦å‘ä¸€ä¸ªä»æœåŠ¡ç«¯è¯·æ±‚æ•°æ®çš„åŠ¨ä½œ(æ­¤æ—¶é¡µé¢æ˜¾ç¤º loading æç¤º)ï¼Œæœ€ç»ˆæˆ‘ä»¬ç”¨è¯·æ±‚å›æ¥çš„æ•°æ®å»æ¸²æŸ“é¡µé¢çš„å†…å®¹ã€‚<br>è®©æˆ‘ä»¬ä¸ºæ¯æ­¥åˆ›å»ºä¸€ä¸ª actionï¼Œç„¶åç”¨ Redux-Saga å®ç°ä¸€ä¸ªç®€åŒ–çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼š</p><pre><code class="js">// saga.jsimport { take } from &#39;redux-saga/effects&#39;function* mySaga(){    yield take(USER_INTERACTED_WITH_UI_ACTION);}</code></pre><p>è¿™ä¸ª Saga çš„å‡½æ•°åå«åš <code>mySaga</code>ã€‚å®ƒè°ƒç”¨äº† Redux-Saga <a href="https://link.juejin.im/?target=https%3A%2F%2Fredux-saga.js.org%2Fdocs%2Fapi%2F%23effect-creators">effect</a> çš„ <code>take</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šé˜»å¡ Saga çš„æ‰§è¡Œï¼Œç›´åˆ°æœ‰äººè°ƒç”¨äº†ä½œä¸ºå‚æ•°çš„é‚£ä¸ª actionï¼ŒSaga çš„æ‰§è¡Œä¹Ÿä¼šç»“æŸï¼Œå°±åƒæˆ‘ä»¬å‰é¢çœ‹åˆ°çš„ Generator ä¸€æ ·ï¼ˆdone å˜ä¸º trueï¼‰ã€‚</p><p>ç°åœ¨æˆ‘ä»¬è¦è®©é¡µé¢å±•ç¤º loading æç¤ºæ¥å“åº”è¿™ä¸ª actionã€‚å¯ä»¥é€šè¿‡ <code>put</code> æ–¹æ³•è°ƒç”¨å¦ä¸€ä¸ª actionï¼Œç„¶ååˆ†é… reducer æ¥å¤„ç†ï¼Œä»è€Œå®Œæˆä¸Šè¿°åŠŸèƒ½ã€‚å¦‚ä¸‹ï¼š</p><pre><code class="js">// saga.jsimport { take, put } from &#39;redux-saga/effects&#39;function* mySaga(){    yield take(USER_INTERACTED_WITH_UI_ACTION);    yield put(SHOW_LOADING_ACTION, {isLoading: true});}// reducer.js...case SHOW_LOADING_ACTION: (state, isLoading) =&gt; {    return Object.assign({}, state, {showLoading: isLoading});}...</code></pre><p>ä¸‹ä¸€æ­¥æ˜¯è°ƒç”¨ <code>call</code> æ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‡½æ•°å’Œä¸€ç»„å‚æ•°ï¼Œä½¿ç”¨è¿™äº›å‚æ•°æ¥æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬ç»™ <code>call</code> æ–¹æ³•ä¼ é€’ä¸€ä¸ªè¯·æ±‚æœåŠ¡ç«¯å¹¶è¿”å›ä¸€ä¸ª Promise çš„ <code>GET</code> å‡½æ•°ï¼Œå®ƒä¼šä¿å­˜è¯·æ±‚ç»“æœï¼š</p><pre><code class="js">// saga.jsimport { take, put, call } from &#39;redux-saga/effects&#39;function* mySaga(){    yield take(USER_INTERACTED_WITH_UI_ACTION);    yield put(SHOW_LOADING_ACTION, {isLoading: true});    const data = yield call(GET, &#39;https://my.server.com/getdata&#39;);    yield put(SHOW_DATA_ACTION, {data: data});}// reducer.js...case SHOW_DATA_ACTION: (state, data) =&gt; {    return Object.assign({}, state, {data: data, showLoading: false};}...</code></pre><p>é€šè¿‡è°ƒç”¨ <code>SHOW_DATA_ACTION</code> æ¥ç”¨æ¥æ”¶çš„æ•°æ®æ›´æ–°é¡µé¢ã€‚</p><h2 id="åˆšåˆšå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><a href="#åˆšåˆšå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="åˆšåˆšå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"></a>åˆšåˆšå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h2><p>åº”ç”¨å¯åŠ¨åï¼Œæ‰€æœ‰çš„ Sagas éƒ½ä¼šè¢«æ‰§è¡Œï¼Œä½ å¯ä»¥è®¤ä¸ºä¸€ç›´åœ¨è°ƒç”¨ next æ–¹æ³•ç›´åˆ°ç»“æŸã€‚take æ–¹æ³•ç±»ä¼¼äºçº¿ç¨‹æŒ‚èµ·çš„ä½œç”¨ï¼Œä¸€æ—¦è°ƒç”¨äº†<code>USER_INTERACTED_WITH_UI_ACTION</code>ï¼Œçº¿ç¨‹å°±ä¼šæ¢å¤æ‰§è¡Œã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬ç»§ç»­è°ƒç”¨ <code>SHOW_LOADING_ACTION</code>ï¼Œreducer ä¼šå¤„ç†è¿™ä¸ª actionã€‚ç”±äº Saga è¿˜åœ¨ç»§ç»­è¿è¡Œï¼Œcall æ–¹æ³•ä¼šå‘èµ·å¯¹æœåŠ¡ç«¯çš„è¯·æ±‚ï¼ŒSaga ä¼šåœ¨å†æ¬¡æŒ‚èµ·ï¼Œç›´åˆ°è¯·æ±‚ç»“æŸã€‚</p><h2 id="æ¯æ¬¡éƒ½ä½¿ç”¨"><a href="#æ¯æ¬¡éƒ½ä½¿ç”¨" class="headerlink" title="æ¯æ¬¡éƒ½ä½¿ç”¨"></a>æ¯æ¬¡éƒ½ä½¿ç”¨</h2><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒSaga åªå¤„ç†äº†ä¸€ä¸ªç”¨æˆ·äº¤äº’çš„ actionï¼Œå› ä¸ºæˆ‘ä»¬ç”¨ put æ–¹æ³•æ‰§è¡Œäº† <code>SHOW_DATA_ACTION</code> è¿™ä¸ª actionï¼Œç„¶ååé¢å°±æ²¡æœ‰ yield äº†ï¼ˆdone å°±æ˜¯ true äº†å¯¹å§ï¼Ÿï¼‰ã€‚<br>å¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨æ¯æ¬¡è°ƒç”¨ <code>USER_INTERACTED_WITH_UI_ACTION</code> è¿™ä¸ª action çš„æ—¶å€™ï¼Œéƒ½ä¼šæ‰§è¡Œè¿™ä¸€ç³»åˆ—çš„ actionsï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ while(true) è¯­å¥æ¥åŒ…è£¹ Saga å†…éƒ¨çš„é€»è¾‘ä»£ç ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">// saga.jsimport { take, put, call } from &#39;redux-saga/effects&#39;1. function* mySaga(){2.   while (true){3.    yield take(USER_INTERACTED_WITH_UI_ACTION);4.    yield put(SHOW_LOADING_ACTION, {isLoading: true});5.    const data = yield call(GET, &#39;https://my.server.com/getdata&#39;);6.    yield put(SHOW_DATA_ACTION, {data: data});7.  }8. }// reducer.js...case SHOW_LOADING_ACTION: (state, isLoading) =&gt; {    return Object.assign({}, state, {showLoading: isLoading});},case SHOW_DATA_ACTION: (state, data) =&gt; {    return Object.assign({}, state, {data: data, showLoading: false};}...</code></pre><p>è¿™ä¸ªæ— é™å¾ªç¯ä¸ä¼šé€ æˆå †æ ˆæº¢å‡ºï¼Œä¹Ÿä¸ä¼šä½¿ä½ çš„åº”ç”¨å´©æºƒï¼å› ä¸º <code>take</code> æ–¹æ³•å°±åƒçº¿ç¨‹æŒ‚èµ·ä¸€æ ·ï¼Œ<code>mySaga</code> æ‰§è¡Œåä¼šä¸€ç›´ä¿æŒ <code>pending</code> çŠ¶æ€ï¼Œç›´åˆ°é‚£ä¸ª <code>action</code> è¢«è§¦å‘ã€‚ä¸‹æ¬¡é‡æ–°è¿›å…¥å¾ªç¯åï¼Œä¹Ÿä¼šé‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚</p><ul><li>è®©æˆ‘ä»¬ä¸€æ­¥æ­¥åœ°çœ‹ä¸€ä¸‹ä¸Šé¢çš„è¿‡ç¨‹ï¼š</li></ul><p>1.åº”ç”¨å¯åŠ¨ï¼Œæ‰§è¡Œæ‰€æœ‰ Sagasã€‚<br>2.mySaga è¿è¡Œï¼Œè¿›å…¥ while(true) å¾ªç¯ï¼Œåœ¨ç¬¬ 3 è¡ŒæŒ‚èµ·ã€‚<br>3.USER_INTERACTED_WITH_UI_ACTION è¿™ä¸ª action è¢«è§¦å‘ã€‚<br>4.Saga çš„çº¿ç¨‹æ¿€æ´»ï¼Œæ‰§è¡Œç¬¬ 4 è¡Œï¼Œè§¦å‘ SHOW_LOADING_ACTION è¿™ä¸ª actionï¼Œç„¶ååˆ†é…çš„ reducer è¿›è¡Œå¤„ç†ï¼ˆreducer å¤„ç†åï¼Œé¡µé¢å°±ä¼šæ˜¾ç¤º loading æç¤ºï¼‰ã€‚<br>5.å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼ˆç¬¬ 5 è¡Œï¼‰ï¼Œç„¶åä¼šå†æ¬¡æŒ‚èµ·ï¼Œç›´åˆ°è¯·æ±‚çš„ Promise å˜ä¸º resolvedï¼Œè¯·æ±‚ç»“æœçš„æ•°æ®ä¼šèµ‹å€¼ç»™ data å˜é‡ã€‚<br>6.SHOW_DATA_ACTION æ¥æ”¶ data ä½œä¸ºå‚æ•°è¢«è§¦å‘ï¼Œç„¶å reducer å°±å¯ä»¥ä½¿ç”¨è¿™äº›æ•°æ®æ¥æ›´æ–°é¡µé¢ã€‚<br>å†æ¬¡è¿›å…¥å¾ªç¯ï¼Œå›åˆ°ç¬¬ 2 æ­¥ã€‚</p><h2 id="æ¥ä¸‹æ¥"><a href="#æ¥ä¸‹æ¥" class="headerlink" title="æ¥ä¸‹æ¥"></a>æ¥ä¸‹æ¥</h2><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Redux-Saga ç›¸å…³çš„åŸºæœ¬æ¦‚å¿µï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ React åº”ç”¨ä¸­ä½¿ç”¨å®ƒã€‚ä¸‹ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šå±•ç¤ºåœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨å®ƒè·å¾—çš„ä»·å€¼ã€‚</p><p><a href="https://juejin.im/post/5ac1cb9d6fb9a028cf32a046" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React-saga </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React-saga </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javascriptå¼‚æ­¥ç¼–ç¨‹(generatorå’Œasync)</title>
      <link href="/2018/08/20/Js/Javascript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%EF%BC%88generator%E5%92%8Casync%EF%BC%89/"/>
      <url>/2018/08/20/Js/Javascript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%EF%BC%88generator%E5%92%8Casync%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»Promiseå¼€å§‹ï¼ŒJavaScriptå°±åœ¨å¼•å…¥æ–°åŠŸèƒ½ï¼Œæ¥å¸®åŠ©æ›´ç®€å•çš„æ–¹æ³•æ¥å¤„ç†å¼‚æ­¥ç¼–ç¨‹ï¼Œå¸®åŠ©æˆ‘ä»¬è¿œç¦»å›è°ƒåœ°ç‹±ã€‚<br>Promiseæ˜¯ä¸‹è¾¹è¦è®²çš„<code>Generator/yield</code>ä¸<code>async/await</code>çš„åŸºç¡€ï¼Œå¸Œæœ›ä½ å·²ç»æå‰äº†è§£äº†å®ƒã€‚</p><p>åœ¨å¤§æ¦‚ES6çš„æ—¶ä»£ï¼Œæ¨å‡ºäº†<code>Generator/yield</code>ä¸¤ä¸ªå…³é”®å­—ï¼Œä½¿ç”¨<code>Generator</code>å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¸®åŠ©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå¤„ç†Promiseçš„è§£é‡Šå™¨ã€‚</p><p>ç„¶åï¼Œåœ¨ES7å·¦å³ï¼Œæˆ‘ä»¬åˆå¾—åˆ°äº†<code>async/await</code>è¿™æ ·çš„è¯­æ³•ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä»¥æ¥è¿‘ç¼–å†™åŒæ­¥ä»£ç çš„æ–¹å¼æ¥ç¼–å†™å¼‚æ­¥ä»£ç ï¼ˆæ— éœ€ä½¿ç”¨<code>.then()</code>æˆ–è€…å›è°ƒå‡½æ•°ï¼‰ã€‚</p><p>ä¸¤è€…éƒ½èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¾ˆæ–¹ä¾¿çš„è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹ï¼Œä½†åŒæ ·ï¼Œè¿™ä¸¤è€…ä¹‹é—´ä¹Ÿæ˜¯æœ‰ä¸å°‘åŒºåˆ«çš„ã€‚</p><h2 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h2><p><code>Generator</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥åœ¨å‡½æ•°å†…éƒ¨é€šè¿‡yieldè¿”å›ä¸€ä¸ªå€¼ï¼ˆæ­¤æ—¶ï¼Œ<strong>Generatorå‡½æ•°çš„æ‰§è¡Œä¼šæš‚å®šï¼Œç›´åˆ°ä¸‹æ¬¡è§¦å‘<code>.next()</code></strong>ï¼‰<br>åˆ›å»ºä¸€ä¸ªGeneratorå‡½æ•°çš„æ–¹æ³•æ˜¯åœ¨functionå…³é”®å­—åæ·»åŠ <code>*</code>æ ‡è¯†ã€‚</p><p>åœ¨è°ƒç”¨ä¸€ä¸ªGeneratorå‡½æ•°åï¼Œå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼Œå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªGeneratorå¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨å¯¹è±¡çš„nextå‡½æ•°ï¼Œå¯ä»¥è·å¾—yield/returnçš„è¿”å›å€¼ã€‚<br>æ— è®ºæ˜¯è§¦å‘äº†yieldè¿˜æ˜¯returnï¼Œnext()å‡½æ•°æ€»ä¼šè¿”å›ä¸€ä¸ªå¸¦æœ‰valueå’Œdoneå±æ€§çš„å¯¹è±¡ã€‚</p><p>valueä¸ºè¿”å›å€¼ï¼Œdoneåˆ™æ˜¯ä¸€ä¸ªBooleanå¯¹è±¡ï¼Œç”¨æ¥æ ‡è¯†Generatoræ˜¯å¦è¿˜èƒ½ç»§ç»­æä¾›è¿”å›å€¼ã€‚</p><p>PS: <strong>generator()å‡½æ•°çš„æ‰§è¡Œæ˜¯æƒ°æ€§çš„ï¼Œyieldåçš„ä»£ç åªåœ¨è§¦å‘next()åæ‰§è¡Œ</strong></p><pre><code class="js">function * oddGenerator () {  yield 1  yield 3  return 5}let iterator = oddGenerator()let first = iterator.next()  // { value: 1, done: false }let second = iterator.next() // { value: 3, done: false }let third = iterator.next()  // { value: 5, done: true  }</code></pre><a id="more"></a><h3 id="next-çš„å‚æ•°ä¼ é€’"><a href="#next-çš„å‚æ•°ä¼ é€’" class="headerlink" title="next()çš„å‚æ•°ä¼ é€’"></a>next()çš„å‚æ•°ä¼ é€’</h3><p>æˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨next()çš„æ—¶å€™ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥åœ¨ä¸Šæ¬¡yieldå‰æ¥æ”¶åˆ°è¿™ä¸ªå‚æ•°ï¼š</p><pre><code class="js">function * outputGenerator () {  let ret1 = yield 1  console.log(`got ret1: ${ret1}`)  let ret2 = yield 2  console.log(`got ret2: ${ret2}`)}let iterator = outputGenerator()iterator.next(1)iterator.next(2) // got ret1: 2iterator.next(3) // got ret2: 3</code></pre><p>ç¬¬ä¸€çœ¼çœ‹ä¸Šå»å¯èƒ½ä¼šæœ‰äº›è¯¡å¼‚ï¼Œä¸ºä»€ä¹ˆç¬¬ä¸€æ¡logæ˜¯åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨nextæ—¶æ‰è¿›è¡Œè¾“å‡ºçš„</p><p>è¿™å°±åˆè¦è¯´åˆ°ä¸Šè¾¹çš„Generatorçš„å®ç°äº†ï¼Œä¸Šè¾¹è¯´åˆ°äº†ï¼Œyieldä¸returnéƒ½æ˜¯ç”¨æ¥è¿”å›å€¼çš„è¯­æ³•ã€‚<br>å‡½æ•°åœ¨æ‰§è¡Œæ—¶é‡åˆ°è¿™ä¸¤ä¸ªå…³é”®å­—åå°±ä¼šæš‚åœæ‰§è¡Œï¼Œç­‰å¾…ä¸‹æ¬¡æ¿€æ´»ã€‚</p><p>ç„¶å<code>let ret1 = yield 1</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªèµ‹å€¼è¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šå…ˆæ‰§è¡Œ=å³è¾¹çš„éƒ¨åˆ†ï¼Œåœ¨=å³è¾¹æ‰§è¡Œçš„è¿‡ç¨‹ä¸­é‡åˆ°äº†yieldå…³é”®å­—ï¼Œå‡½æ•°ä¹Ÿå°±åœ¨æ­¤å¤„æš‚åœäº†ï¼Œåœ¨ä¸‹æ¬¡è§¦å‘next()æ—¶æ‰è¢«æ¿€æ´»ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬ç»§ç»­è¿›è¡Œä¸Šæ¬¡æœªå®Œæˆçš„èµ‹å€¼è¯­å¥<code>let ret1 = XXX</code>ï¼Œå¹¶åœ¨å†æ¬¡é‡åˆ°yieldæ—¶æš‚åœã€‚</p><ul><li>è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆç¬¬äºŒæ¬¡è°ƒç”¨next()çš„å‚æ•°ä¼šè¢«ç¬¬ä¸€æ¬¡yieldèµ‹å€¼çš„å˜é‡æ¥æ”¶åˆ°</li></ul><h3 id="ç”¨ä½œè¿­ä»£å™¨ä½¿ç”¨"><a href="#ç”¨ä½œè¿­ä»£å™¨ä½¿ç”¨" class="headerlink" title="ç”¨ä½œè¿­ä»£å™¨ä½¿ç”¨"></a>ç”¨ä½œè¿­ä»£å™¨ä½¿ç”¨</h3><p>å› ä¸ºGeneratorå¯¹è±¡æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨äº<code>for...of</code>å¾ªç¯ï¼š</p><blockquote><p>ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œç”¨ä½œè¿­ä»£å™¨ä¸­çš„ä½¿ç”¨ï¼Œåˆ™åªä¼šä½œç”¨äºyield,returnçš„è¿”å›å€¼ä¸è®¡å…¥è¿­ä»£</p></blockquote><pre><code class="js">function * oddGenerator () {  yield 1  yield 3  yield 5  return &#39;won\&#39;t be iterate&#39;}for (let value of oddGenerator()) {  console.log(value)}// &gt; 1// &gt; 3// &gt; 5</code></pre><h3 id="Generatorå‡½æ•°å†…éƒ¨çš„Generator"><a href="#Generatorå‡½æ•°å†…éƒ¨çš„Generator" class="headerlink" title="Generatorå‡½æ•°å†…éƒ¨çš„Generator"></a>Generatorå‡½æ•°å†…éƒ¨çš„Generator</h3><p>é™¤äº†yieldè¯­æ³•ä»¥å¤–ï¼Œå…¶å®è¿˜æœ‰ä¸€ä¸ª<code>yield*</code>è¯­æ³•ï¼Œå¯ä»¥ç²—ç•¥çš„ç†è§£ä¸ºæ˜¯ <strong>Generatorå‡½æ•°ç‰ˆçš„[â€¦]</strong><br>ç”¨æ¥å±•å¼€Generatorè¿­ä»£å™¨çš„ã€‚</p><pre><code class="js">function * gen1 () {  yield 1  yield* gen2()  yield 5}function * gen2 () {  yield 2  yield 3  yield 4  return &#39;won\&#39;t be iterate&#39;}for (let value of gen1()) {  console.log(value)}// &gt; 1// &gt; 2// &gt; 3// &gt; 4// &gt; 5</code></pre><h3 id="æ¨¡æ‹Ÿå®ç°Promiseæ‰§è¡Œå™¨"><a href="#æ¨¡æ‹Ÿå®ç°Promiseæ‰§è¡Œå™¨" class="headerlink" title="æ¨¡æ‹Ÿå®ç°Promiseæ‰§è¡Œå™¨"></a>æ¨¡æ‹Ÿå®ç°Promiseæ‰§è¡Œå™¨</h3><p>ç„¶åæˆ‘ä»¬ç»“åˆç€Promiseï¼Œæ¥å®ç°ä¸€ä¸ªç®€æ˜“çš„æ‰§è¡Œå™¨ã€‚</p><p>æœ€å—æ¬¢è¿çš„ç±»ä¼¼çš„åº“æ˜¯ï¼š <a href="https://www.npmjs.com/package/co" target="_blank" rel="noopener">co</a></p><pre><code class="js">function run (gen) {  gen = gen()  return next(gen.next())  function next ({done, value}) {    return new Promise(resolve =&gt; {     if (done) { // finish       resolve(value)     } else { // not yet       value.then(data =&gt; {         next(gen.next(data)).then(resolve)       })     }   })  }}function getRandom () {  return new Promise(resolve =&gt; {    setTimeout(_ =&gt; resolve(Math.random() * 10 | 0), 1000)  })}function * main () {  let num1 = yield getRandom()  let num2 = yield getRandom()  return num1 + num2}run(main).then(data =&gt; {  console.log(`got data: ${data}`);})</code></pre><ul><li>ä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨çš„æ¨¡æ‹Ÿï¼ˆä»…ä½œä¸¾ä¾‹è¯´æ˜ï¼‰</li></ul><p>åœ¨ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çº¦å®šyieldåè¾¹çš„å¿…ç„¶æ˜¯ä¸€ä¸ªPromiseå‡½æ•°<br>æˆ‘ä»¬åªçœ‹main()å‡½æ•°çš„ä»£ç ï¼Œä½¿ç”¨Generatorç¡®å®èƒ½å¤Ÿè®©æˆ‘ä»¬è®©è¿‘ä¼¼åŒæ­¥çš„æ–¹å¼æ¥ç¼–å†™å¼‚æ­¥ä»£ç <br>ä½†æ˜¯ï¼Œè¿™æ ·å†™å°±æ„å‘³ç€æˆ‘ä»¬å¿…é¡»æœ‰ä¸€ä¸ªå¤–éƒ¨å‡½æ•°è´Ÿè´£å¸®æˆ‘ä»¬æ‰§è¡Œmain()å‡½æ•°è¿™ä¸ªGeneratorï¼Œå¹¶å¤„ç†å…¶ä¸­ç”Ÿæˆçš„Promiseï¼Œç„¶ååœ¨thenå›è°ƒä¸­å°†ç»“æœè¿”å›åˆ°Generatorå‡½æ•°ï¼Œä»¥ä¾¿å¯ä»¥æ‰§è¡Œä¸‹è¾¹çš„ä»£ç ã€‚</p><h2 id="async"><a href="#async" class="headerlink" title="async"></a>async</h2><p>æˆ‘ä»¬ç”¨ä½œasync/awiaté‡å†™ä¸Šé¢generatorçš„ä¾‹å­ï¼š</p><pre><code class="js">function getRandom () {  return new Promise(resolve =&gt; {    setTimeout(_ =&gt; resolve(Math.random() * 10 | 0), 1000)  })}async function main () {  let num1 = await getRandom()  let num2 = await getRandom()  return num1 + num2}console.log(`got data: ${await main()}`)</code></pre><blockquote><p>è¿™æ ·çœ‹ä¸Šå»ï¼Œå¥½åƒæˆ‘ä»¬ä»Generator/yieldæ¢åˆ°async/awaitåªéœ€è¦æŠŠ*éƒ½æ”¹ä¸ºasyncï¼Œyieldéƒ½æ”¹ä¸ºawaitå°±å¯ä»¥äº†ã€‚ æ‰€ä»¥å¾ˆå¤šäººéƒ½ç›´æ¥æ‹¿Generator/yieldæ¥è§£é‡Šasync/awaitçš„è¡Œä¸ºï¼Œä½†è¿™ä¼šå¸¦æ¥å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p></blockquote><ul><li>Generatoræœ‰å…¶ä»–çš„ç”¨é€”ï¼Œè€Œä¸ä»…ä»…æ˜¯ç”¨æ¥å¸®åŠ©ä½ å¤„ç†Promise</li><li>è¿™æ ·çš„è§£é‡Šè®©é‚£äº›ä¸ç†Ÿæ‚‰è¿™ä¸¤è€…çš„äººç†è§£èµ·æ¥æ›´å›°éš¾ï¼ˆå› ä¸ºä½ è¿˜è¦å»è§£é‡Šé‚£äº›ç±»ä¼¼coçš„åº“ï¼‰</li></ul><p>async/awaitæ˜¯ <strong>å¤„ç†Promiseçš„ä¸€ä¸ªæå…¶æ–¹ä¾¿çš„æ–¹æ³•ï¼Œä½†å¦‚æœä½¿ç”¨ä¸å½“çš„è¯ï¼Œä¹Ÿä¼šé€ æˆä¸€äº›ä»¤äººå¤´ç–¼çš„é—®é¢˜</strong></p><h3 id="Asyncå‡½æ•°å§‹ç»ˆè¿”å›ä¸€ä¸ªPromise"><a href="#Asyncå‡½æ•°å§‹ç»ˆè¿”å›ä¸€ä¸ªPromise" class="headerlink" title="Asyncå‡½æ•°å§‹ç»ˆè¿”å›ä¸€ä¸ªPromise"></a>Asyncå‡½æ•°å§‹ç»ˆè¿”å›ä¸€ä¸ªPromise</h3><p>ä¸€ä¸ªasyncå‡½æ•°ï¼Œæ— è®ºä½ return 1æˆ–è€…throw new Error()ã€‚<br>åœ¨è°ƒç”¨æ–¹æ¥è®²ï¼Œæ¥æ”¶åˆ°çš„å§‹ç»ˆæ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼š</p><pre><code class="js">async function throwError () {  throw new Error()}async function returnNumber () {  return 1}console.log(returnNumber() instanceof Promise) // trueconsole.log(throwError() instanceof Promise)   // true</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºå‡½æ•°æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œä½ éƒ½è¦æŒ‰ç…§Promiseçš„æ–¹å¼æ¥å¤„ç†å®ƒã€‚</p><h3 id="Awaitæ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„ï¼Œå¹¶ä¸èƒ½å¹¶è¡Œæ‰§è¡Œ"><a href="#Awaitæ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„ï¼Œå¹¶ä¸èƒ½å¹¶è¡Œæ‰§è¡Œ" class="headerlink" title="Awaitæ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„ï¼Œå¹¶ä¸èƒ½å¹¶è¡Œæ‰§è¡Œ"></a>Awaitæ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„ï¼Œå¹¶ä¸èƒ½å¹¶è¡Œæ‰§è¡Œ</h3><p>JavaScriptæ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™å°±æ„å‘³ç€awaitä¸€åªèƒ½ä¸€æ¬¡å¤„ç†ä¸€ä¸ªï¼Œå¦‚æœä½ æœ‰å¤šä¸ªPromiseéœ€è¦å¤„ç†ï¼Œåˆ™å°±æ„å‘³ç€ï¼Œä½ è¦ç­‰åˆ°å‰ä¸€ä¸ªPromiseå¤„ç†å®Œæˆæ‰èƒ½è¿›è¡Œä¸‹ä¸€ä¸ªçš„å¤„ç†ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬åŒæ—¶å‘é€å¤§é‡çš„è¯·æ±‚ï¼Œè¿™æ ·å¤„ç†å°±ä¼šéå¸¸æ…¢ï¼Œone by oneï¼š</p><pre><code class="js">const bannerImages = [];async function getImageInfo(){    return bannerImages.map(async banner =&gt; await getImageInfo(banner));}</code></pre><p>å°±åƒè¿™æ ·çš„å››ä¸ªå®šæ—¶å™¨ï¼Œæˆ‘ä»¬éœ€è¦ç­‰å¾…4sæ‰èƒ½æ‰§è¡Œå®Œæ¯•ï¼š</p><pre><code class="js">function delay () {  return new Promise(resolve =&gt; setTimeout(resolve, 1000))}let tasks = [1, 2, 3, 4]async function runner (tasks) {  for (let task of tasks) {    await delay()  }}console.time(&#39;runner&#39;)await runner(tasks)console.timeEnd(&#39;runner&#39;)</code></pre><p>åƒè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Promise.all()</code>è¿›è¡Œå¦‚ä¸‹ä¼˜åŒ–ï¼š</p><pre><code class="js">function delay () {  return new Promise(resolve =&gt; setTimeout(resolve, 1000))}let tasks = [1, 2, 3, 4]async function runner (tasks) {  tasks = tasks.map(delay)  await Promise.all(tasks)}console.time(&#39;runner&#39;)await runner(tasks)console.timeEnd(&#39;runner&#39;)</code></pre><p>è‰æ¡ˆä¸­æåˆ°è¿‡await*ï¼Œä½†ç°åœ¨è²Œä¼¼è¿˜ä¸æ˜¯æ ‡å‡†ï¼Œæ‰€ä»¥è¿˜æ˜¯é‡‡ç”¨Promise.allåŒ…è£¹ä¸€å±‚çš„æ–¹æ³•æ¥å®ç°</p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒPromiseå¯¹è±¡åœ¨åˆ›å»ºæ—¶å°±ä¼šæ‰§è¡Œå‡½æ•°å†…éƒ¨çš„ä»£ç ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨mapåˆ›å»ºè¿™ä¸ªæ•°ç»„æ—¶ï¼Œæ‰€æœ‰çš„Promiseä»£ç éƒ½ä¼šæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šåŒæ—¶å‘å‡ºå»ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡await Promise.allæ¥ç›‘å¬æ‰€æœ‰Promiseçš„å“åº”ã€‚</p><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>Generatorä¸async functionéƒ½æ˜¯è¿”å›ä¸€ä¸ªç‰¹å®šç±»å‹çš„å¯¹è±¡ï¼š</p><p>Generator: ä¸€ä¸ªç±»ä¼¼{ value: XXX, done: true }è¿™æ ·ç»“æ„çš„Object<br>Async: å§‹ç»ˆè¿”å›ä¸€ä¸ªPromiseï¼Œä½¿ç”¨awaitæˆ–è€….then()æ¥è·å–è¿”å›å€¼<br>Generatoræ˜¯å±äºç”Ÿæˆå™¨ï¼Œä¸€ç§ç‰¹æ®Šçš„è¿­ä»£å™¨ï¼Œç”¨æ¥è§£å†³å¼‚æ­¥å›è°ƒé—®é¢˜æ„Ÿè§‰æœ‰äº›ä¸åŠ¡æ­£ä¸šäº†ã€‚ã€‚ è€Œasyncåˆ™æ˜¯ä¸ºäº†æ›´ç®€æ´çš„ä½¿ç”¨Promiseè€Œæå‡ºçš„è¯­æ³•ï¼Œç›¸æ¯”Generator + coè¿™ç§çš„å®ç°æ–¹å¼ï¼Œæ›´ä¸ºä¸“æ³¨ï¼Œç”Ÿæ¥å°±æ˜¯ä¸ºäº†å¤„ç†å¼‚æ­¥ç¼–ç¨‹ã€‚</p><p>ç°åœ¨å·²ç»æ˜¯2018å¹´äº†ï¼Œasyncä¹Ÿæ˜¯ç”¨äº†å¥½ä¹…ï¼Œå°±è®©Generatorå»åšä»–è¯¥åšçš„äº‹æƒ…å§ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘å¯¹React v16.4ç”Ÿå‘½å‘¨æœŸçš„ç†è§£</title>
      <link href="/2018/08/13/React/%E6%88%91%E5%AF%B9React-v16-4%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%9A%84%E7%90%86%E8%A7%A3/"/>
      <url>/2018/08/13/React/%E6%88%91%E5%AF%B9React-v16-4%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%9A%84%E7%90%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>react v16.3ç”Ÿå‘½å‘¨æœŸ<br><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-8-13/68110756.jpg" alt="react v16.3"></p><p>react v16.4ç”Ÿå‘½å‘¨æœŸ<br><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-8-13/64176249.jpg" alt="react v16.4"></p><p><strong>React v16è¦åºŸé™¤çš„ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°</strong></p><ul><li><del>componentWillMount</del></li><li><del>componentWillReceiveProps</del></li><li><del>componentWillUpdate</del></li></ul><blockquote><p>æ³¨ï¼šç›®å‰åœ¨16ç‰ˆæœ¬ä¸­<del>componentWillMount</del>ï¼Œ<del>componentWillReceiveProps</del>ï¼Œ<del>componentWillUpdate</del>å¹¶æœªå®Œå…¨åˆ é™¤è¿™ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè€Œä¸”æ–°å¢äº†<del>UNSAFE_componentWillMount</del>ï¼Œ<del>UNSAFE_componentWillReceiveProps</del>ï¼Œ<del>UNSAFE_componentWillUpdate</del>ä¸‰ä¸ªå‡½æ•°ï¼Œå®˜æ–¹è®¡åˆ’åœ¨17ç‰ˆæœ¬å®Œå…¨åˆ é™¤è¿™ä¸‰ä¸ªå‡½æ•°ï¼Œåªä¿ç•™UNSAVE_å‰ç¼€çš„ä¸‰ä¸ªå‡½æ•°ï¼Œç›®çš„æ˜¯ä¸ºäº†å‘ä¸‹å…¼å®¹ï¼Œä½†æ˜¯å¯¹äºå¼€å‘è€…è€Œè¨€åº”è¯¥å°½é‡é¿å…ä½¿ç”¨ä»–ä»¬ï¼Œè€Œæ˜¯ä½¿ç”¨æ–°å¢çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ›¿ä»£å®ƒä»¬</p></blockquote><p><strong>å–è€Œä»£ä¹‹çš„ç”Ÿå‘½å‘¨æœŸ</strong></p><ul><li>static getDerivedStateFromProps</li><li>getSnapshotBeforeUpdate</li></ul><p>æˆ‘ä»¬å°†Reactçš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œç„¶åè¯¦ç»†è®²è§£æ¯ä¸ªé˜¶æ®µå…·ä½“è°ƒç”¨äº†ä»€ä¹ˆå‡½æ•°ï¼Œè¿™ä¸‰ä¸ªé˜¶æ®µæ˜¯ï¼š</p><ul><li>æŒ‚è½½é˜¶æ®µ</li><li>æ›´æ–°é˜¶æ®µ</li><li>å¸è½½é˜¶æ®µ</li></ul><h1 id="æŒ‚è½½é˜¶æ®µ"><a href="#æŒ‚è½½é˜¶æ®µ" class="headerlink" title="æŒ‚è½½é˜¶æ®µ"></a>æŒ‚è½½é˜¶æ®µ</h1><a id="more"></a><p>æŒ‚è½½é˜¶æ®µï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºç»„ä»¶çš„åˆå§‹åŒ–é˜¶æ®µï¼Œå°±æ˜¯å°†æˆ‘ä»¬çš„ç»„ä»¶æ’å…¥åˆ°DOMä¸­ï¼Œåªä¼šå‘ç”Ÿä¸€æ¬¡</p><blockquote><p>è¿™ä¸ªé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°è°ƒç”¨å¦‚ä¸‹</p></blockquote><ul><li>constructor</li><li>getDerviedStateFromProps</li><li><del>componentWillMount/UNSAVE_componentWillMount</del></li><li>render</li><li>componentDidMount</li></ul><h2 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h2><p>ç»„ä»¶æ„é€ å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œ</p><p>å¦‚æœæ²¡æœ‰æ˜¾ç¤ºå®šä¹‰å®ƒï¼Œæˆ‘ä»¬ä¼šæ‹¥æœ‰ä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°</p><p>å¦‚æœæ˜¾ç¤ºå®šä¹‰äº†æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ„é€ å‡½æ•°ç¬¬ä¸€è¡Œæ‰§è¡Œsuper(props)ï¼Œå¦åˆ™æˆ‘ä»¬æ— æ³•åœ¨æ„é€ å‡½æ•°é‡Œæ‹¿åˆ°thiså¯¹è±¡ï¼Œè¿™äº›éƒ½å±äºES6çš„çŸ¥è¯†</p><p>åœ¨æ„é€ å‡½æ•°é‡Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåšä¸¤ä»¶äº‹ï¼š</p><ul><li>åˆå§‹åŒ–stateå¯¹è±¡</li><li>ç»™è‡ªå®šä¹‰æ–¹æ³•ç»‘å®šthis</li></ul><pre><code class="js">class App extends React.Component{    constructor(props){        super(props);        this.state = {            select,            height: &#39;atuo&#39;,            externalClass,            externalClassText        }        this.handleClick = this.handleClick.bind(this);    }}</code></pre><p><strong>ç¦æ­¢åœ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨setStateï¼Œå¯ä»¥ç›´æ¥ç»™stateè®¾ç½®åˆå§‹å€¼</strong></p><h2 id="getDerivedStateFromProps"><a href="#getDerivedStateFromProps" class="headerlink" title="getDerivedStateFromProps"></a>getDerivedStateFromProps</h2><p><code>static getDerivedStateFromProps(nextProps,prevState)</code></p><p>ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢ä½¿ç”¨thisï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°propså’Œstateï¼Œåˆ†åˆ«æŒ‡æ¥æ”¶åˆ°çš„æ–°å‚æ•°å’Œå½“å‰çš„stateå¯¹è±¡ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ç”¨æ¥æ›´æ–°å½“å‰çš„stateå¯¹è±¡ï¼Œå¦‚æœä¸éœ€è¦æ›´æ–°å¯ä»¥è¿”å›null</p><p>è¯¥å‡½æ•°ä¼šåœ¨æŒ‚è½½æ—¶ï¼Œæ¥æ”¶åˆ°æ–°çš„propsï¼Œè°ƒç”¨äº†setStateå’ŒforceUpdateæ—¶è¢«è°ƒç”¨</p><p>åœ¨React v16.3æ—¶åªæœ‰åœ¨æŒ‚è½½æ—¶å’Œæ¥æ”¶åˆ°æ–°çš„propsè¢«è°ƒç”¨ï¼Œæ®è¯´è¿™æ˜¯å®˜æ–¹çš„å¤±è¯¯ï¼Œåæ¥ä¿®å¤äº†</p><p>è¿™ä¸ªæ–¹æ³•å°±æ˜¯ä¸ºäº†å–ä»£ä¹‹å‰çš„<del>componentWillMountã€componentWillReceivePropså’ŒcomponentWillUpdate</del></p><p>å½“æˆ‘ä»¬æ¥æ”¶åˆ°æ–°çš„å±æ€§æƒ³å»ä¿®æ”¹æˆ‘ä»¬stateï¼Œå¯ä»¥ä½¿ç”¨<code>getDerivedStateFromProps</code></p><pre><code class="js">class ExampleComponent extends React.Component {  state = {    isScrollingDown: false,    lastRow: null  }  static getDerivedStateFromProps(nextProps,prevState){      if(nextProps.currentRow !== prevState.lastRow){          return {            isScrollingDown:            nextProps.currentRow &gt; prevState.lastRow,            lastRow: nextProps.currentRow        }      }      return null;  }}</code></pre><h2 id="componentWillMount-UNSAFE-componentWillMount"><a href="#componentWillMount-UNSAFE-componentWillMount" class="headerlink" title="componentWillMount/UNSAFE_componentWillMount"></a><del>componentWillMount/UNSAFE_componentWillMount</del></h2><p>åœ¨16ç‰ˆæœ¬è¿™ä¸¤ä¸ªæ–¹æ³•å¹¶å­˜ï¼Œä½†æ˜¯åœ¨17ç‰ˆæœ¬ä¸­<del>componentWillMount</del>è¢«åˆ é™¤ï¼Œåªä¿ç•™<del>UNSAFE_componentWillMount</del>ï¼Œç›®çš„æ˜¯ä¸ºäº†åšå‘ä¸‹å…¼å®¹ï¼Œå¯¹äºæ–°çš„åº”ç”¨ï¼Œç”¨<del>getDerivedStateFromProps</del>ä»£æ›¿å®ƒä»¬<br>ç”±äº<del>componentWillMount/ UNSAFE_componentWillMount</del>æ˜¯åœ¨renderä¹‹å‰è°ƒç”¨ï¼Œæ‰€ä»¥å°±ç®—åœ¨è¿™ä¸ªæ–¹æ³•ä¸­è°ƒç”¨setStateä¹Ÿä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰</p><h2 id="render"><a href="#render" class="headerlink" title="render"></a>render</h2><p>renderæ–¹æ³•æ˜¯reactä¸­æœ€æ ¸å¿ƒçš„æ–¹æ³•ï¼Œä¸€ä¸ªç»„ä»¶ä¸­å¿…é¡»è¦è¿™ä¸ªæ–¹æ³•ï¼š</p><blockquote><p>è¿”å›çš„ç±»å‹æœ‰ä»¥ä¸‹å‡ ç§</p></blockquote><ul><li>åŸç”ŸDOMï¼Œå¦‚div</li><li>Fragmentï¼ˆç‰‡æ®µï¼‰</li><li>Reactç»„ä»¶</li><li>Portalsï¼ˆæ’æ§½ï¼‰</li><li>å­—ç¬¦ä¸²å’Œæ•°å­—ï¼Œè¢«æ¸²æŸ“æˆtextèŠ‚ç‚¹</li><li>Booleanå’Œnullï¼Œä¸ä¼šæ¸²æŸ“ä»»ä½•ä¸œè¥¿</li></ul><blockquote><p>å…³äºFragmentå’ŒPortalsæ˜¯React16æ–°å¢çš„ï¼Œå¦‚æœå¤§å®¶ä¸æ¸…æ¥šå¯ä»¥å»é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼Œåœ¨è¿™é‡Œå°±ä¸å±•å¼€äº†</p></blockquote><p>renderå‡½æ•°æ˜¯çº¯å‡½æ•°ï¼Œé‡Œé¢åªåšä¸€ä»¶äº‹ï¼Œå°±æ˜¯è¿”å›éœ€è¦æ¸²æŸ“çš„ä¸œè¥¿ï¼Œä¸åº”è¯¥åŒ…å«å…¶å®ƒçš„ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æ•°æ®è¯·æ±‚ï¼Œå¯¹äºè¿™äº›ä¸šåŠ¡é€»è¾‘è¯·ç§»åˆ°<code>componentDidMount</code>å’Œ<code>componentDidUpdate</code>ä¸­</p><h2 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount"></a>componentDidMount</h2><p>ç»„ä»¶å¸è½½ä¹‹åè°ƒç”¨ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è·å–åˆ°DOMèŠ‚ç‚¹å¹¶æ“ä½œï¼Œæ¯”å¦‚å¯¹canvasï¼Œsvgçš„æ“ä½œï¼ŒæœåŠ¡å™¨è¯·æ±‚ï¼Œè®¢é˜…éƒ½å¯ä»¥å†™åœ¨è¿™ä¸ªé‡Œé¢ï¼Œä½†æ˜¯è®°å¾—åœ¨<code>componentWillUnmount</code>ä¸­å–æ¶ˆè®¢é˜…</p><pre><code class="js">componentDidMount() {    const { progressCanvas, progressSVG } = this    const canvas = progressCanvas.current    const ctx = canvas.getContext(&#39;2d&#39;)    canvas.width = canvas.getBoundingClientRect().width    canvas.height = canvas.getBoundingClientRect().height    const svg = progressSVG.current    const rect = document.createElementNS(&#39;http://www.w3.org/2000/svg&#39;, &#39;rect&#39;)    rect.setAttribute(&#39;x&#39;, 0)    rect.setAttribute(&#39;y&#39;, 0)    rect.setAttribute(&#39;width&#39;, 0)    rect.setAttribute(&#39;height&#39;, svg.getBoundingClientRect().height)    rect.setAttribute(&#39;style&#39;, &#39;fill:red&#39;)    const animate = document.createElementNS(&#39;http://www.w3.org/2000/svg&#39;, &#39;animate&#39;)    animate.setAttribute(&#39;attributeName&#39;, &#39;width&#39;)    animate.setAttribute(&#39;from&#39;, 0)    animate.setAttribute(&#39;to&#39;, svg.getBoundingClientRect().width)    animate.setAttribute(&#39;begin&#39;, &#39;0ms&#39;)    animate.setAttribute(&#39;dur&#39;, &#39;1684ms&#39;)    animate.setAttribute(&#39;repeatCount&#39;, &#39;indefinite&#39;)    animate.setAttribute(&#39;calcMode&#39;, &#39;linear&#39;)    rect.appendChild(animate)    svg.appendChild(rect)    svg.pauseAnimations()    this.canvas = canvas    this.svg = svg    this.ctx = ctx }</code></pre><p>åœ¨<code>componentDidMount</code>ä¸­è°ƒç”¨setStateä¼šè§¦å‘ä¸€æ¬¡é¢å¤–çš„æ¸²æŸ“ï¼Œå¤šè°ƒç”¨äº†ä¸€æ¬¡renderå‡½æ•°ï¼Œä½†æ˜¯ç”¨æˆ·å¯¹æ­¤æ²¡æœ‰æ„ŸçŸ¥ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨æµè§ˆå™¨åˆ·æ–°å±å¹•å‰æ‰§è¡Œçš„ï¼Œä½†æ˜¯æˆ‘ä»¬åº”è¯¥åœ¨å¼€å‘ä¸­é¿å…å®ƒï¼Œå› ä¸ºå®ƒä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨constructorä¸­åˆå§‹åŒ–æˆ‘ä»¬çš„stateå¯¹è±¡ï¼Œè€Œä¸åº”è¯¥åœ¨componentDidMountè°ƒç”¨stateæ–¹æ³•</p><h1 id="æ›´æ–°é˜¶æ®µ"><a href="#æ›´æ–°é˜¶æ®µ" class="headerlink" title="æ›´æ–°é˜¶æ®µ"></a>æ›´æ–°é˜¶æ®µ</h1><p>æ›´æ–°é˜¶æ®µï¼Œå½“ç»„ä»¶çš„propsæ”¹å˜äº†ï¼Œæˆ–ç»„ä»¶å†…éƒ¨è°ƒç”¨äº†setStateæˆ–è€…forceUpdateå‘ç”Ÿï¼Œä¼šå‘ç”Ÿå¤šæ¬¡</p><p>è¿™ä¸ªé˜¶æ®µç”Ÿå‘½å‘¨æœŸå‡½æ•°å¦‚ä¸‹ï¼š</p><ul><li><del>componentWillReceiveProps/UNSAFE_componentWillReceiveProps</del></li><li>getRerviedStateFromProps</li><li>shouldComponentUpdate</li><li><del>componentWillUpdate/UNSAFE_componentWillUpdate</del></li><li>render</li><li>getSnapshotBeforeUpdate</li><li>componentDidUpdate</li></ul><h2 id="componentWillReceiveProps-UNSAFE-componentWillReceiveProps"><a href="#componentWillReceiveProps-UNSAFE-componentWillReceiveProps" class="headerlink" title="componentWillReceiveProps/UNSAFE_componentWillReceiveProps"></a><del>componentWillReceiveProps/UNSAFE_componentWillReceiveProps</del></h2><p><code>componentWillReceiveProps(nextProps, prevState)</code><br><code>UNSAFE_componentWillReceiveProps(nextProps, prevState)</code></p><p>åœ¨16ç‰ˆæœ¬è¿™ä¸¤ä¸ªæ–¹æ³•å¹¶å­˜ï¼Œä½†æ˜¯åœ¨17ç‰ˆæœ¬ä¸­<code>componentWillReceiveProps</code>è¢«åˆ é™¤ï¼Œ<code>UNSAFE_componentWillReceiveProps</code>ï¼Œç›®çš„æ˜¯ä¸ºäº†åšå‘ä¸‹å…¼å®¹ï¼Œå¯¹äºæ–°çš„åº”ç”¨ï¼Œç”¨<code>getDerivedStateFromProps</code>ä»£æ›¿å®ƒä»¬</p><p>æ³¨æ„ï¼Œå½“æˆ‘ä»¬çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ—¶å€™ï¼Œä¹Ÿä¼šå¯¼è‡´æˆ‘ä»¬çš„å­ç»„ä»¶è°ƒç”¨<code>componentWillReceiveProps/UNSAFE_componentWillReceiveProps</code>ï¼Œå³ä½¿æˆ‘ä»¬çš„å±æ€§å’Œä¹‹å‰çš„ä¸€æ ·ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢å»è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå‰åå±æ€§ä¸ä¸€è‡´æ‰å»è°ƒç”¨setState</p><p>åœ¨è£…è½½é˜¶æ®µè¿™ä¸¤ä¸ªå‡½æ•°ä¸ä¼šè¢«è§¦å‘ï¼Œåœ¨ç»„ä»¶å†…éƒ¨è°ƒç”¨äº†setStateå’ŒforceUpdateä¹Ÿä¸ä¼šè§¦å‘è¿™ä¸¤ä¸ªå‡½æ•°</p><h2 id="getDerivedStateFromProps-1"><a href="#getDerivedStateFromProps-1" class="headerlink" title="`getDerivedStateFromProps"></a>`getDerivedStateFromProps</h2><p>è¿™ä¸ªæ–¹æ³•åœ¨è£…è½½é˜¶æ®µå·²ç»è®²è¿‡äº†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œè®°ä½åœ¨æ›´æ–°é˜¶æ®µï¼Œæ— è®ºæˆ‘ä»¬æ¥æ”¶åˆ°æ–°çš„å±æ€§ï¼Œè°ƒç”¨äº†setStateè¿˜æ˜¯è°ƒç”¨äº†forceUpdateï¼Œè¿™ä¸ªæ–¹æ³•éƒ½ä¼šè¢«è°ƒç”¨</p><h2 id="shouldComponentUpdate"><a href="#shouldComponentUpdate" class="headerlink" title="shouldComponentUpdate"></a>shouldComponentUpdate</h2><p><code>shouldComponentUpdate(nextProps,nextState)</code></p><p>æœ‰ä¸¤ä¸ªå‚æ•°nextPropså’ŒnextStateï¼Œè¡¨ç¤ºæ–°çš„å±æ€§å’Œå˜åŒ–ä¹‹åçš„stateï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œtrueè¡¨ç¤ºä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œfalseè¡¨ç¤ºä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œé»˜è®¤è¿”å›true</p><p>æ³¨æ„å½“æˆ‘ä»¬è°ƒç”¨<code>forceUpdate</code>å¹¶ä¸ä¼šè§¦å‘æ­¤æ–¹æ³•</p><p>å› ä¸ºé»˜è®¤æ˜¯è¿”å›trueï¼Œä¹Ÿå°±æ˜¯åªè¦æ¥æ”¶åˆ°æ–°çš„å±æ€§å’Œè°ƒç”¨äº†setStateéƒ½ä¼šè§¦å‘é‡æ–°çš„æ¸²æŸ“ï¼Œè¿™ä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†this.propsä¸nextPropsä»¥åŠthis.stateä¸nextStateè¿›è¡Œæ¯”è¾ƒæ¥å†³å®šæ˜¯å¦è¿”å›falseï¼Œæ¥å‡å°‘é‡æ–°æ¸²æŸ“</p><p>ä½†æ˜¯å®˜æ–¹æå€¡æˆ‘ä»¬ä½¿ç”¨<code>PureComponent</code>æ¥å‡å°‘é‡æ–°æ¸²æŸ“çš„æ¬¡æ•°è€Œä¸æ˜¯æ‰‹å·¥ç¼–å†™shouldComponentUpdateä»£ç ï¼Œå…·ä½“è¯¥æ€ä¹ˆé€‰æ‹©ï¼Œå…¨å‡­å¼€å‘è€…è‡ªå·±é€‰æ‹©</p><p>åœ¨æœªæ¥çš„ç‰ˆæœ¬ï¼ŒshouldComponentUpdateè¿”å›falseï¼Œä»ç„¶å¯èƒ½å¯¼è‡´ç»„ä»¶é‡æ–°çš„æ¸²æŸ“ï¼Œè¿™æ˜¯å®˜æ–¹è‡ªå·±è¯´çš„</p><blockquote><p>Currently, if shouldComponentUpdate() returns false, then UNSAFE_componentWillUpdate(), render(), and componentDidUpdate() will not be invoked. In the future React may treat shouldComponentUpdate() as a hint rather than a strict directive, and returning false may still result in a re-rendering of the component.</p></blockquote><h2 id="componentWillUpdate-UNSAFE-componentWillUpdate"><a href="#componentWillUpdate-UNSAFE-componentWillUpdate" class="headerlink" title="componentWillUpdate/UNSAFE_componentWillUpdate"></a><del>componentWillUpdate/UNSAFE_componentWillUpdate</del></h2><p><code>componentWillUpdate(nextProps, nextState)</code><br><code>UNSAFE_componentWillUpdate(nextProps, nextState)</code></p><p>åœ¨16ç‰ˆæœ¬è¿™ä¸¤ä¸ªæ–¹æ³•å¹¶å­˜ï¼Œä½†æ˜¯åœ¨17ç‰ˆæœ¬ä¸­<del>componentWillUpdate</del>è¢«åˆ é™¤ï¼Œ<del>UNSAFE_componentWillUpdate</del>ï¼Œç›®çš„æ˜¯ä¸ºäº†åšå‘ä¸‹å…¼å®¹</p><p>åœ¨è¿™ä¸ªæ–¹æ³•é‡Œï¼Œä½ ä¸èƒ½è°ƒç”¨setStateï¼Œå› ä¸ºèƒ½èµ°åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œè¯´æ˜shouldComponentUpdateè¿”å›trueï¼Œæ­¤æ—¶ä¸‹ä¸€ä¸ªstateçŠ¶æ€å·²ç»è¢«ç¡®å®šï¼Œé©¬ä¸Šå°±è¦æ‰§è¡Œrenderé‡æ–°æ¸²æŸ“äº†ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ•´ä¸ªç”Ÿå‘½å‘¨æœŸæ··ä¹±ï¼Œåœ¨è¿™é‡Œä¹Ÿä¸èƒ½è¯·æ±‚ä¸€äº›ç½‘ç»œæ•°æ®ï¼Œå› ä¸ºåœ¨å¼‚æ­¥æ¸²æŸ“ä¸­ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç½‘ç»œè¯·æ±‚å¤šæ¬¡ï¼Œå¼•èµ·ä¸€äº›æ€§èƒ½é—®é¢˜</p><p>å¦‚æœä½ åœ¨è¿™ä¸ªæ–¹æ³•é‡Œä¿å­˜äº†æ»šåŠ¨ä½ç½®ï¼Œä¹Ÿæ˜¯ä¸å‡†ç¡®çš„ï¼Œè¿˜æ˜¯å› ä¸ºå¼‚æ­¥æ¸²æŸ“çš„é—®é¢˜ï¼Œå¦‚æœä½ éè¦è·å–æ»šåŠ¨ä½ç½®çš„è¯ï¼Œè¯·åœ¨<code>getSnapshotBeforeUpdate</code>è°ƒç”¨</p><h2 id="render-1"><a href="#render-1" class="headerlink" title="`render"></a>`render</h2><p>æ›´æ–°é˜¶æ®µä¹Ÿä¼šè§¦å‘ï¼Œè£…è½½é˜¶æ®µå·²ç»è®²è¿‡äº†ï¼Œä¸å†èµ˜è¿°</p><h2 id="getSnapshotBeforeUpdate"><a href="#getSnapshotBeforeUpdate" class="headerlink" title="getSnapshotBeforeUpdate"></a>getSnapshotBeforeUpdate</h2><p><code>getSnapshotBeforeUpdate(prevProps, prevState)</code></p><p>è¿™ä¸ªæ–¹æ³•åœ¨renderä¹‹åï¼ŒcomponentDidUpdateä¹‹å‰è°ƒç”¨ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°prevPropså’ŒprevStateï¼Œè¡¨ç¤ºä¹‹å‰çš„å±æ€§å’Œä¹‹å‰çš„stateï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ ç»™componentDidUpdateï¼Œå¦‚æœä½ ä¸æƒ³è¦è¿”å›å€¼ï¼Œè¯·è¿”å›nullï¼Œä¸å†™çš„è¯æ§åˆ¶å°ä¼šæœ‰è­¦å‘Š</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/12/1652d5a54fe61cee?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="componentDidUpdate"></p><p>è¿˜æœ‰è¿™ä¸ªæ–¹æ³•ä¸€å®šè¦å’ŒcomponentDidUpdateä¸€èµ·ä½¿ç”¨ï¼Œå¦åˆ™æ§åˆ¶å°ä¹Ÿä¼šæœ‰è­¦å‘Š</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/12/1652d5bf732e3ff3?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="componentDidUpdate1"></p><p>å‰é¢è¯´è¿‡è¿™ä¸ªæ–¹æ³•æ—¶ç”¨æ¥ä»£æ›¿<del>componentWillUpdate/UNSAVE_componentWillUpdate</del>ï¼Œä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸‹ï¼š</p><pre><code class="js">class ScrollingList extends React.Component {  constructor(props) {    super(props);    this.listRef = React.createRef();  }  getSnapshotBeforeUpdate(prevProps, prevState) {    // Are we adding new items to the list?    // Capture the scroll position so we can adjust scroll later.    if (prevProps.list.length &lt; this.props.list.length) {      const list = this.listRef.current;      return list.scrollHeight - list.scrollTop;    }    return null;  }  componentDidUpdate(prevProps, prevState, snapshot) {    // If we have a snapshot value, we&#39;ve just added new items.    // Adjust scroll so these new items don&#39;t push the old ones out of view.    // (snapshot here is the value returned from getSnapshotBeforeUpdate)    if (snapshot !== null) {      const list = this.listRef.current;      list.scrollTop = list.scrollHeight - snapshot;    }  }  render() {    return (      &lt;div ref={this.listRef}&gt;{/* ...contents... */}&lt;/div&gt;    );  }}</code></pre><h2 id="componentDidUpdate"><a href="#componentDidUpdate" class="headerlink" title="componentDidUpdate"></a>componentDidUpdate</h2><p><code>componentDidUpdate(prevProps, prevState, snapshot)</code></p><p>è¯¥æ–¹æ³•åœ¨getSnapshotBeforeUpdateæ–¹æ³•ä¹‹åè¢«è°ƒç”¨ï¼Œæœ‰ä¸‰ä¸ªå‚æ•°<code>prevPropsï¼ŒprevStateï¼Œsnapshot</code>ï¼Œ<strong>è¡¨ç¤ºä¹‹å‰çš„propsï¼Œä¹‹å‰çš„stateï¼Œå’Œsnapshot</strong>ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯<code>getSnapshotBeforeUpdate</code>è¿”å›çš„</p><h1 id="å¸è½½é˜¶æ®µ"><a href="#å¸è½½é˜¶æ®µ" class="headerlink" title="å¸è½½é˜¶æ®µ"></a>å¸è½½é˜¶æ®µ</h1><p>å¸è½½é˜¶æ®µï¼Œå½“æˆ‘ä»¬çš„ç»„ä»¶è¢«å¸è½½æˆ–è€…é”€æ¯äº†</p><p>è¿™ä¸ªé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°åªæœ‰ä¸€ä¸ª</p><ul><li><code>componentWillUnmount</code></li></ul><h2 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h2><p>å½“æˆ‘ä»¬çš„ç»„ä»¶è¢«å¸è½½æˆ–è€…é”€æ¯äº†å°±ä¼šè°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°é‡Œå»æ¸…é™¤ä¸€äº›å®šæ—¶å™¨ï¼Œå–æ¶ˆç½‘ç»œè¯·æ±‚ï¼Œæ¸…ç†æ— æ•ˆçš„DOMå…ƒç´ ç­‰åƒåœ¾æ¸…ç†å·¥ä½œ</p><p>æ³¨æ„ä¸è¦åœ¨è¿™ä¸ªå‡½æ•°é‡Œå»è°ƒç”¨setStateï¼Œå› ä¸ºç»„ä»¶ä¸ä¼šé‡æ–°æ¸²æŸ“äº†</p><p><a href="https://juejin.im/post/5b6f1800f265da282d45a79a?utm_source=gold_browser_extension#comment" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯å¸¸è§ç®—æ³•Jså®ç°</title>
      <link href="/2018/08/10/HTTP/%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95Js%E5%AE%9E%E7%8E%B0/"/>
      <url>/2018/08/10/HTTP/%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95Js%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h1><pre><code class="js">var arr = [2,53,53.2,1,1223,5,2,675,967,2,1231,9344,3855,1];</code></pre><h2 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h2><p><strong>åŸç†</strong>ï¼š<br>æ¯”è¾ƒç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ ï¼Œæ¯”è¾ƒå¤§çš„æ”¾ç½®å³ç«¯</p><pre><code class="js">function bubbleSort(arr){    var i = j =0    for(var i = 1;i &lt; arr.length;i++){        for(var j = 0;j &lt;= arr.length - i;j++){            var temp = 0            if(arr[j] &gt; arr[j+1]){                temp = arr[j];                arr[j] = arr[j+1];                arr[j+1] = temp;            }        }    }}// bubbleSort(arr);// console.log(arr)</code></pre><h2 id="å¿«æ’"><a href="#å¿«æ’" class="headerlink" title="å¿«æ’"></a>å¿«æ’</h2><p><strong>åŸç†ï¼š</strong><br>æ ¹æ®åŸºæ•°å°†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†çš„æ•°æ®è¦æ¯”å¦ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°ï¼Œç„¶åè¿›è¡Œé€’å½’è°ƒç”¨ï¼Œç›´åˆ°æœ€åä¸€ä¸ªå…ƒç´ <br><a id="more"></a></p><pre><code class="js">function quickSort(arr){    if (arr.length &lt;= 1) { return arr; }ã€€ã€€var pivotIndex = Math.floor(arr.length / 2) ;ã€€ã€€var pivot = arr.splice(pivotIndex, 1)[0];ã€€ã€€var left = [];ã€€ã€€var right = [];ã€€ã€€for (var i = 0; i &lt; arr.length; i++){ã€€ã€€ã€€ã€€if (arr[i] &lt; pivot) {ã€€ã€€ã€€ã€€ã€€ã€€left.push(arr[i]);ã€€ã€€ã€€ã€€} else {ã€€ã€€ã€€ã€€ã€€ã€€right.push(arr[i]);ã€€ã€€ã€€ã€€}ã€€ã€€}   ã€€return quickSort(left).concat([pivot], quickSort(right));}// console.log(quickSort(arr));</code></pre><h2 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h2><p><strong>åŸç†</strong><br>1ï¼‰ ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æ’åº</p><p>2ï¼‰ å–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»åå‘å‰æ‰«æ</p><p>3ï¼‰ å¦‚æœè¯¥å…ƒç´ ï¼ˆå·²æ’åºï¼‰å¤§äºæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½®</p><p>4ï¼‰ é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æ’åºçš„å…ƒç´ å°äºæˆ–è€…ç­‰äºæ–°å…ƒç´ çš„ä½ç½®</p><p>5ï¼‰å°†æ–°å…ƒç´ æ’å…¥åˆ°ä¸‹ä¸€ä½ç½®ä¸­</p><p>6ï¼‰ é‡å¤æ­¥éª¤2</p><pre><code class="js">function insertSort(arr){// å‡è®¾ç¬¬0ä¸ªå…ƒç´ å¼€å§‹æ˜¯æœ‰åºæ’åºï¼Œç¬¬1ä¸ªå…ƒç´ ä¹‹åæ˜¯æ— åºæ’åº// æ‰€ä»¥ä»ç¬¬1ä¸ªå…ƒç´ å°†æ— éœ€æ•°åˆ—çš„å…ƒç´ æ’å…¥æœ‰åºæ•°åˆ—ä¸­for(var i = 1; i &lt; arr.length; i++){    // å‡åº    if(arr[i] &lt; arr[i - 1]){        // å–å‡ºæ— åºæ•°ç»„ä¸­å¼Ÿiä¸ªå…ƒç´ ä½œä¸ºè¢«æ’å…¥å…ƒç´         var guard = arr[i];        // è®°ä½æœ‰åºæ•°åˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ä½ç½®ï¼Œå¹¶å°†æ•°åˆ—ä½ç½®æ‰©å¤§ä¸€ä¸ª        var j = i - 1;        arr[i] = arr[j];        // æ¯”å¤§å°æ‰¾åˆ°è¢«æ’å…¥å…ƒç´ çš„ä½ç½®        while (j &gt;= 0 &amp;&amp; guard &lt; arr[j]) {            arr[j + 1] = arr[j];            j--;        }        arr[j + 1] = guard; // æ’å…¥    }}}insertSort(arr);console.log(arr)</code></pre><h2 id="äºŒåˆ†æŸ¥æ‰¾"><a href="#äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾"></a>äºŒåˆ†æŸ¥æ‰¾</h2><p><strong>åŸç†</strong><br>äºŒåˆ†æŸ¥æ‰¾ï¼Œä¹Ÿä¸ºæŠ˜åŠæŸ¥æ‰¾ã€‚é¦–å…ˆè¦æ‰¾åˆ°ä¸€ä¸ªä¸­é—´å€¼ï¼Œé€šè¿‡ä¸ä¸­é—´å€¼æ¯”è¾ƒï¼Œå¤§çš„æ”¾åˆï¼Œå°çš„æ”¾åœ¨å·¦è¾¹ã€‚<br>å†åœ¨ä¸¤è¾¹ä¸­å¯»æ‰¾ä¸­é—´å€¼ï¼ŒæŒç»­ä»¥ä¸Šæ“ä½œï¼Œç›´åˆ°æ‰¾åˆ°æ‰€åœ¨ä½ç½®ä¸ºæ­¢ã€‚</p><pre><code class="js">function binarySort(left,right){    var result = [],        il = 0,        ir = 0;    while (il &lt; left.length &amp;&amp; ir &lt; right.length) {        if (left[il] &lt; right[ir]) {            result.push(left[il++]);        } else {            result.push(right[ir++]);        }    }    while(left[il]){        result.push(left[il++]);    }    while(right[ir]){        result.push(right[ir++]);    }    return result;}console.log(binarySort(arr,1))</code></pre>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”¨canvaså‹ç¼©ä¸Šä¼ çš„å›¾ç‰‡</title>
      <link href="/2018/08/07/Js/%E7%94%A8canvas%E5%8E%8B%E7%BC%A9%E4%B8%8A%E4%BC%A0%E7%9A%84%E5%9B%BE%E7%89%87/"/>
      <url>/2018/08/07/Js/%E7%94%A8canvas%E5%8E%8B%E7%BC%A9%E4%B8%8A%E4%BC%A0%E7%9A%84%E5%9B%BE%E7%89%87/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç°åœ¨æ‘„åƒå¤´å·²ç»æ˜¯æ‰‹æœºçš„æ ‡é…äº†ï¼Œç§»åŠ¨ç½‘ç«™ä¹Ÿåšå¾—è¶Šæ¥è¶ŠåƒAPPã€‚ç„¶è€Œæ‹ç…§ä¸Šä¼ è¿™ä»¶äº‹æƒ…çš„ä½“éªŒä¼¼ä¹ä»ç„¶ä¸å¦‚APPï¼Œä¸»è¦åŸå› æ˜¯ç°åœ¨æ‰‹æœºæ‹æ‘„çš„ç…§ç‰‡å¤ªå¤§ï¼Œä¸Šä¼ éå¸¸æ¶ˆè€—æµé‡ä¹Ÿéå¸¸è€—æ—¶ã€‚APPéƒ½ä¼šåœ¨ä¸Šä¼ å‰ç¼©å°è¦ä¸Šä¼ çš„ç…§ç‰‡å°ºå¯¸ï¼Œä»¥æœŸæ›´èŠ‚çœæµé‡å’Œæ—¶é—´ã€‚åœ¨HTML5æ—¶ä»£ï¼Œåˆ©ç”¨æ–‡ä»¶APIå’ŒCanvasæŠ€æœ¯ï¼ŒWebä¸Šä¹Ÿå¯ä»¥åšåˆ°å›¾ç‰‡å‹ç¼©ä¸Šä¼ ã€‚</p><h2 id="è¿‡æ»¤æ–‡ä»¶ç±»å‹"><a href="#è¿‡æ»¤æ–‡ä»¶ç±»å‹" class="headerlink" title="è¿‡æ»¤æ–‡ä»¶ç±»å‹"></a>è¿‡æ»¤æ–‡ä»¶ç±»å‹</h2><p>é¦–å…ˆæˆ‘ä»¬å¸Œæœ›ç”¨æˆ·èƒ½ç›´æ¥é€‰æ‹©æ‰‹æœºç…§ç‰‡ï¼Œè€Œä¸æ˜¯åœ¨å„ç§ç±»å‹çš„æ–‡ä»¶ä¸­é€‰æ‹©ã€‚åªéœ€è¦åœ¨<code>input</code>æ ‡ç­¾ä¸­åŠ å…¥<code>accept</code>å±æ€§å°±å¯ä»¥å®ç°è¿™ä¸€ç‚¹ï¼š</p><pre><code class="html">&lt;div id=&quot;preview&quot;&gt;&lt;/div&gt;&lt;form&gt;    &lt;input type=&quot;file&quot; accept=&quot;image/*&quot;&gt;    &lt;input type=&quot;submit&quot;&gt;&lt;form&gt;</code></pre><p>åœ¨<code>Android4ä»¥ä¸Šï¼ŒiOS7ä»¥ä¸Š</code>è®¾å¤‡å®æµ‹ï¼Œå½“ç”¨æˆ·ç‚¹å‡»è¿™ä¸ªæ–‡ä»¶é€‰æ‹©å™¨çš„æ—¶å€™ï¼Œæ‰‹æœºä¼šè‡ªåŠ¨è°ƒå‡ºå›¾ç‰‡åº“ï¼Œå¹¶å¸¦æœ‰æ‹ç…§é€‰æ‹©ã€‚</p><h2 id="è¯»æ–‡ä»¶ç”Ÿæˆé¢„è§ˆ"><a href="#è¯»æ–‡ä»¶ç”Ÿæˆé¢„è§ˆ" class="headerlink" title="è¯»æ–‡ä»¶ç”Ÿæˆé¢„è§ˆ"></a>è¯»æ–‡ä»¶ç”Ÿæˆé¢„è§ˆ</h2><p>ç”¨æˆ·é€‰æ‹©äº†å›¾ç‰‡ä¹‹åï¼Œéœ€è¦è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¯»å‡ºçš„å†…å®¹å¯ä¾›ç”Ÿæˆé¢„è§ˆå›¾ï¼Œä¹Ÿå¯ä»¥ä¾›åé¢å‹ç¼©ä½¿ç”¨ã€‚ä½¿ç”¨HTML5çš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader" target="_blank" rel="noopener">FileReader API</a>å¯ä»¥è¾¾æˆè¿™ä¸€ç›®çš„ã€‚</p><pre><code class="js">var file = document.querySeletor(&quot;[type=file]&quot;);file.addEventListener(&#39;change&#39;,function(e){    for(var i = 0,f; f &lt; e.target.file[i]; i++){        if(f.type.indexOf(&#39;image&#39;) != 0) continue;        var render = new FileReader();        render.onload = function(e){            var img = document.createElement(&#39;img&#39;);            img.src = e.targte.result;            document.getElementById(&#39;preview&#39;).appendChild(img);        }        render.readAsDataURL(f)    }},false)</code></pre><a id="more"></a><p>å¦‚æœä¸éœ€è¦é¢„è§ˆå›¾ï¼Œå¯ä»¥ä¸æŠŠimgå¯¹è±¡æ·»åŠ åˆ°DOMä¸Šã€‚</p><h2 id="å‹ç¼©"><a href="#å‹ç¼©" class="headerlink" title="å‹ç¼©"></a>å‹ç¼©</h2><p>åˆ©ç”¨Canvasæ¸²æŸ“ä¸Šä¸‹æ–‡çš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/drawImage" target="_blank" rel="noopener">drawImage</a>æ¥å£ï¼Œå¯ä»¥æŠŠä¸€å¼ å›¾ç‰‡ç»˜åˆ¶åˆ°Canvasä¸Šï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¯ä»¥é‡æ–°å®šä¹‰å›¾ç‰‡å°ºå¯¸ï¼Œç„¶åå†ç”¨Canvasçš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLCanvasElement/toDataURL" target="_blank" rel="noopener">toDataURL</a>æ¥å£å¯ä»¥ç”Ÿæˆå‡ºå‹ç¼©åçš„å›¾ç‰‡ã€‚</p><pre><code class="js">var images = document.querySeletorAll(&#39;#preview img&#39;);var iWidth = 400,iHeight = 300;var compressedImages = [];[].forEach.call(images,function(image){    var canvas = document.createElement(&#39;canvas&#39;);    canvas.width = iWidth;    canvas.height = iHeight;    canvas.getContent(&#39;2d&#39;).drawImage(image);    var compressed = canvas.toDataURL(&quot;imgae/jepg&quot;,0.7);    compressedImages.push(compressed);})</code></pre><h2 id="ä¸Šä¼ "><a href="#ä¸Šä¼ " class="headerlink" title="ä¸Šä¼ "></a>ä¸Šä¼ </h2><p>ä¸Šé¢ä¸€æ­¥éª¤ç”Ÿæˆçš„å‹ç¼©åå›¾ç‰‡æ˜¯Data URLå½¢å¼çš„ï¼Œä¸Šä¼ å‰éœ€è¦æŠŠå¼€å¤´éƒ¨åˆ†çš„<code>data:image/jpeg;base64</code>,æˆªæ‰æ‰æ˜¯å›¾ç‰‡çš„<code>Base64</code>ç¼–ç å½¢å¼ã€‚</p><p>å¯ä»¥ç›´æ¥æŠŠ<code>Base64</code>çš„å­—ç¬¦ä¸²ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åç”±æœåŠ¡ç«¯è§£ç ä¸ºJPGå›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥åœ¨å‰ç«¯è§£ç ä¸Šä¼ ã€‚å¦‚æœè¦åœ¨å‰ç«¯è§£ç å¹¶ä»¥æ–‡ä»¶æ–¹å¼ä¸Šä¼ ï¼Œå…ˆè¦ç”¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WindowBase64/atob" target="_blank" rel="noopener">atob</a>å‡½æ•°æŠŠ<code>Base64</code>è§£å¼€ï¼Œç„¶åè½¬æ¢ä¸º<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" target="_blank" rel="noopener">ArrayBuffer</a>ï¼Œå†ç”¨å®ƒåˆ›å»ºä¸€ä¸ª<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Blob" target="_blank" rel="noopener">Blob</a>å¯¹è±¡ã€‚æ–‡ä»¶æ–¹å¼ä¸Šä¼ éœ€è¦ç”¨<code>multipart/form-data</code>æ ¼å¼ï¼Œå¯ä»¥åˆ©ç”¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/Using_FormData_Objects" target="_blank" rel="noopener">FormData</a>å¯¹è±¡ç»„è£…ç”Ÿæˆå¥½çš„Blobå¯¹è±¡æ¥å®ç°ã€‚</p><pre><code class="js">function b64toBlob(b64Data,contentType,sliceSize){    contentType = contentType || &#39;&#39;;    sliceSize = sliceSize || 512;    var byteCharacters = atob(b64Data);    var byteData = [];    for(var offset = 0; offset &lt; byteCharacters.length; offset += sliceSize){        var slice = byteCharacters.slice(offset, offset + sliceSize);        var byteNumbers = new Array(slice.length);        for (var i = 0; i &lt; slice.length; i++) {            byteNumbers[i] = slice.charCodeAt(i);        }        var byteArray = new Uint8Array(byteNumbers);        byteArrays.push(byteArray);    }    var blob = new Blob(byteArray,{type:content})    return blob;}var fileBlob = b64toBlob(compressed.substr(23),&#39;images/jepg&#39;);var formData = new FormData();formData.append(&#39;file&#39;,fileBlob);var xhr = new XMLHttpRequest();xhr.open(&#39;POST&#39;,&#39;upload.php&#39;);xhr.send(formData);</code></pre><h2 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h2><p>æœ€åï¼Œè¯·ä¸è¦å¿˜è®°åœ¨æœåŠ¡ç«¯å¯¹ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶æ•°æ®è¿›è¡Œåˆæ³•æ€§æ£€æŸ¥ï¼Œæ¯•ç«Ÿé»‘å®¢ä¹Ÿå¯èƒ½ç”¨éæµè§ˆå™¨ä¸Šä¼ åƒåœ¾æ–‡ä»¶æˆ–è€…æ¶æ„è„šæœ¬ã€‚</p><h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p><img src="https://lib.xts.so/xts-img/x/2017/02/3037522307.png" alt="æ‰«ææŸ¥çœ‹"></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptä¸­çš„â€œthisâ€æ˜¯ä»€ä¹ˆï¼Ÿ</title>
      <link href="/2018/08/05/Js/JavaScript%E4%B8%AD%E7%9A%84%E2%80%9Cthis%E2%80%9D%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/"/>
      <url>/2018/08/05/Js/JavaScript%E4%B8%AD%E7%9A%84%E2%80%9Cthis%E2%80%9D%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åŸæ–‡ï¼š<a href="https://medium.com/m/global-identity?redirectUrl=https%3A%2F%2Fblog.bitsrc.io%2Fwhat-is-this-in-javascript-3b03480514a7" target="_blank" rel="noopener">What is â€œthisâ€ in JavaScript?</a></p></blockquote><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¦‚æœä½ æ›¾ä½¿ç”¨JavaScriptåº“åšè¿‡å¼€å‘ï¼Œé‚£ä¹ˆä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ä¸€ä¸ªåä¸º thisçš„ç‰¹å®šå…³é”®å­—ã€‚è™½ç„¶ thisåœ¨JavaScriptä¸­éå¸¸å¸¸è§ï¼Œä½†æ˜¯å®Œå…¨ç†è§£thiså…³é”®å­—çš„åŸç†ä»¥åŠåœ¨ä»£ç ä¸­å¦‚ä½•ä½¿ç”¨å¯¹ç›¸å½“ä¸€éƒ¨åˆ†çš„å¼€å‘è€…æ¥è¯´ç€å®ä¸æ˜“ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å¸®ä½ æ·±å…¥ç†è§£ thisåŠå…¶å·¥ä½œæœºåˆ¶ã€‚<br>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£… Nodeã€‚ç„¶åï¼Œæ‰“å¼€å‘½ä»¤è¡Œç»ˆç«¯å¹¶è¿è¡Œ node å‘½ä»¤ã€‚</p><h2 id="å…¨å±€ç¯å¢ƒä¸­çš„â€œthisâ€"><a href="#å…¨å±€ç¯å¢ƒä¸­çš„â€œthisâ€" class="headerlink" title="å…¨å±€ç¯å¢ƒä¸­çš„â€œthisâ€"></a>å…¨å±€ç¯å¢ƒä¸­çš„â€œthisâ€</h2><p>thisçš„å·¥ä½œæœºåˆ¶ç†è§£èµ·æ¥å¹¶ä¸æ˜¯å¾ˆå®¹æ˜“ã€‚æˆ‘ä»¬é€šè¿‡å°† thisç½®äºä¸åŒç¯å¢ƒä¸‹ï¼Œåˆ†åˆ«æ¥ç†è§£ thisæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹ globalç¯å¢ƒã€‚</p><p>åœ¨å…¨å±€ç¯å¢ƒä¸­ï¼Œ thisç›¸å½“äºå…¨å±€å¯¹è±¡ globalã€‚</p><pre><code class="js">this === global;true;</code></pre><p>ä½†è¿™åªåœ¨ <strong>nodeä¸­æ‰æœ‰æ•ˆã€‚å¦‚æœæˆ‘ä»¬å°†ç›¸åŒçš„ä»£ç æ”¾åœ¨jsæ–‡ä»¶ä¸­è¿è¡Œï¼Œå¾—åˆ°çš„è¾“å‡ºä¸ºfalse</strong>ã€‚</p><p>å¦‚æœæƒ³æµ‹è¯•æ•ˆæœï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º index.jsçš„æ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹ä»£ç ï¼š</p><pre><code class="js">console.log(this === global);</code></pre><p>ç„¶åä½¿ç”¨ nodeå‘½ä»¤è¿è¡Œæ­¤æ–‡ä»¶ï¼š</p><pre><code class="js">$ node index.jsfalse</code></pre><p>åŸå› æ˜¯åœ¨JavaScriptæ–‡ä»¶ä¸­ï¼Œ thisç­‰åŒäº <code>module.exports</code>è€Œä¸æ˜¯ global ã€‚</p><h2 id="å‡½æ•°ä¸­çš„â€œthisâ€"><a href="#å‡½æ•°ä¸­çš„â€œthisâ€" class="headerlink" title="å‡½æ•°ä¸­çš„â€œthisâ€"></a>å‡½æ•°ä¸­çš„â€œthisâ€</h2><p>å‡½æ•°ä¸­çš„ thiså€¼é€šå¸¸æ˜¯ç”±å‡½æ•°çš„è°ƒç”¨æ–¹æ¥å®šä¹‰ã€‚å› æ­¤ï¼Œæ¯æ¬¡æ‰§è¡Œå‡½æ•°ï¼Œå‡½æ•°å†…çš„ thiså€¼å¯èƒ½éƒ½ä¸ä¸€æ ·ã€‚</p><p>åœ¨ index.jsæ–‡ä»¶ä¸­ï¼Œç¼–å†™ä¸€ä¸ªéå¸¸ç®€å•çš„å‡½æ•°ï¼Œæ¥æ£€æŸ¥ thisæ˜¯å¦ç­‰äºglobalå¯¹è±¡ã€‚</p><pre><code class="js">function rajat() {  console.log(this === global)}rajat()</code></pre><a id="more"></a><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨ nodeè¿è¡Œæ­¤ä»£ç ï¼Œå¾—åˆ°çš„è¾“å‡ºä¸º true ã€‚å¦‚æœåœ¨æ–‡ä»¶çš„é¡¶éƒ¨æ·»åŠ  â€œuse strictâ€ï¼Œå¹¶å†æ¬¡è¿è¡Œå®ƒï¼Œå°†ä¼šå¾—åˆ°ä¸€ä¸ª falseè¾“å‡ºï¼Œå› ä¸ºç°åœ¨çš„ thiså€¼ä¸º undefined ã€‚<br>ä¸ºäº†è¿›ä¸€æ­¥è§£é‡Šè¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥å®šä¹‰è¶…çº§è‹±é›„çš„çœŸå®å§“åå’Œè‹±é›„åå­—</p><pre><code class="js">function Hero(heroName, realName) {  this.realName = realName;  this.heroName = heroName;}const superman= Hero(&quot;Superman&quot;, &quot;Clark Kent&quot;);console.log(superman);</code></pre><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ªå‡½æ•°å¹¶ä¸æ˜¯ä»¥<code>ä¸¥æ ¼æ¨¡å¼</code>ç¼–å†™çš„ã€‚ nodeè¿è¡Œæ­¤ä»£ç ï¼Œå¹¶ä¸ä¼šå¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„â€œSupermanâ€å’Œâ€œClark Kentâ€ï¼Œä½†å®ƒåªä¼šç»™æˆ‘ä»¬ä¸€ä¸ª undefined ã€‚</p><p>èƒŒåçš„åŸå› æ˜¯ï¼Œ<strong>ç”±äºå‡½æ•°ä¸æ˜¯ä»¥ä¸¥æ ¼æ¨¡å¼ç¼–å†™çš„ï¼Œ thisæŒ‡å‘globalå¯¹è±¡</strong>ã€‚<br>å¦‚æœåœ¨<code>ä¸¥æ ¼æ¨¡å¼</code>ä¸‹è¿è¡Œæ­¤ä»£ç ï¼Œæˆ‘ä»¬ä¼šæ”¶åˆ°æŠ¥é”™ï¼Œå› ä¸ºJavaScriptä¸å…è®¸å°†å±æ€§ realNameå’Œ heroNameèµ‹ç»™ undefined ã€‚å…¶å®è¿™æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œå› ä¸ºå®ƒé˜»æ­¢æˆ‘ä»¬åˆ›å»ºå…¨å±€å˜é‡ã€‚</p><p>å¦å¤–ï¼Œä»¥å¤§å†™å½¢å¼ä¹¦å†™å‡½æ•°åæ„å‘³ç€æˆ‘ä»¬éœ€è¦å°†å®ƒè§†ä¸ºæ„é€ å‡½æ•°ï¼Œä½¿ç”¨ newè¿ç®—ç¬¦æ¥è°ƒç”¨ã€‚ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢ä¸Šé¢ä»£ç æ®µçš„æœ€åä¸¤è¡Œ</p><pre><code class="js">onst superman = new Hero(&quot;Superman&quot;, &quot;Clark Kent&quot;);console.log(superman);</code></pre><p>å†æ¬¡è¿è¡Œ node index.jså‘½ä»¤ï¼Œç°åœ¨ä¼šå¾—åˆ°ä½ é¢„æœŸçš„è¾“å‡ºã€‚</p><h2 id="æ„é€ å‡½æ•°ä¸­çš„â€œthisâ€"><a href="#æ„é€ å‡½æ•°ä¸­çš„â€œthisâ€" class="headerlink" title="æ„é€ å‡½æ•°ä¸­çš„â€œthisâ€"></a>æ„é€ å‡½æ•°ä¸­çš„â€œthisâ€</h2><p>JavaScriptæ²¡æœ‰ç‰¹å®šçš„æ„é€ å‡½æ•°ã€‚æˆ‘ä»¬æ‰€èƒ½åšçš„å°±æ˜¯ä½¿ç”¨ newè¿ç®—ç¬¦å°†å‡½æ•°è°ƒç”¨è½¬æ¢ä¸ºæ„é€ å‡½æ•°è°ƒç”¨ï¼Œå¦‚ä¸Šä¸€èŠ‚æ‰€ç¤ºã€‚<br>æ„é€ å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡å¹¶å°†å…¶è®¾ç½®ä¸ºå‡½æ•°çš„ thiså‚æ•°ã€‚æ„é€ å‡½æ•°ä¼šéšå¼çš„è¿”å›è¿™ä¸ªå¯¹è±¡ï¼Œé™¤éæˆ‘ä»¬æ˜ç¡®çš„è¿”å›äº†å¦å¤–ä¸€ä¸ªå¯¹è±¡ã€‚<br>åœ¨ heroå‡½æ•°å†…éƒ¨æ·»åŠ ä¸‹é¢çš„ returnè¯­å¥ï¼š</p><pre><code class="js">return {  heroName: &quot;Batman&quot;,  realName: &quot;Bruce Wayne&quot;,};</code></pre><p>å¦‚æœæˆ‘ä»¬å†æ¬¡è¿è¡Œ nodeå‘½ä»¤ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° ä¸Šé¢çš„ returnè¯­å¥è¦†ç›–äº†æ„é€ å‡½æ•°è°ƒç”¨ã€‚</p><p>returnè¯­å¥ä¸ä¼šè¦†ç›–æ„é€ å‡½æ•°è°ƒç”¨çš„å”¯ä¸€æƒ…å½¢æ˜¯ï¼Œ<strong>returnè¯­å¥è¿”å›çš„ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡</strong>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹è±¡å°†åŒ…å«åŸå§‹å€¼ã€‚</p><h2 id="æ–¹æ³•ä¸­çš„â€œthisâ€"><a href="#æ–¹æ³•ä¸­çš„â€œthisâ€" class="headerlink" title="æ–¹æ³•ä¸­çš„â€œthisâ€"></a>æ–¹æ³•ä¸­çš„â€œthisâ€</h2><p>å½“å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œ thisæŒ‡å‘çš„æ˜¯è¯¥å¯¹è±¡ï¼Œä¹Ÿç§°ä¸ºå‡½æ•°è°ƒç”¨çš„æ¥æ”¶å™¨(receiver)ã€‚<br>å‡è®¾ heroå¯¹è±¡æœ‰ä¸€ä¸ª dialogueæ–¹æ³• ï¼Œé‚£ä¹ˆ dialogueä¸­çš„ thiså€¼æŒ‡å‘ heroæœ¬èº«ã€‚æ­¤æ—¶çš„ heroä¹Ÿè¢«ç§°ä¸º dialogueæ–¹æ³•è°ƒç”¨çš„æ¥æ”¶è€…ã€‚</p><pre><code class="js">const hero = {  heroName: &quot;Batman&quot;,  dialogue() {    console.log(`I am ${this.heroName}!`);  }};hero.dialogue();</code></pre><p>è¿™ä¸ªä¾‹å­éå¸¸ç®€å•ï¼Œä½†åœ¨å®é™…æƒ…å†µä¸­ï¼Œæˆ‘ä»¬çš„æ–¹æ³•å¾ˆéš¾è·Ÿè¸ªæ¥æ”¶å™¨ã€‚åœ¨ index.jsçš„æœ«å°¾æ·»åŠ ä»¥ä¸‹ä»£ç æ®µã€‚</p><pre><code class="js">const saying = hero.dialogue;saying();</code></pre><p>å¦‚æœæˆ‘å°† dialogueçš„å¼•ç”¨å­˜å‚¨åœ¨å¦ä¸€ä¸ªå˜é‡ä¸­ï¼Œå¹¶å°†è¯¥å˜é‡ä½œä¸ºå‡½æ•°è°ƒç”¨ã€‚ nodeè¿è¡Œä»£ç  ï¼Œ thiså°†è¿”å› undefined ï¼Œå› ä¸ºè¯¥æ–¹æ³•å·²ç»ä¸¢å¤±äº†æ¥æ”¶å™¨ã€‚ thisæ­¤æ—¶æŒ‡å‘ global ï¼Œè€Œä¸æ˜¯ hero ã€‚</p><p>å½“æˆ‘ä»¬å°†ä¸€ä¸ªæ–¹æ³•ä½œä¸ºå›è°ƒä¼ é€’ç»™å¦ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œé€šå¸¸ä¼šä¸¢å¤±æ¥æ”¶å™¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ åŒ…è£…å‡½æ•°æˆ–ä½¿ç”¨ <code>bind</code>æ–¹æ³•å°† thisä¸ç‰¹å®šå¯¹è±¡ç»‘å®šæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="call-å’Œ-apply"><a href="#call-å’Œ-apply" class="headerlink" title="call() å’Œ apply()"></a>call() å’Œ apply()</h2><p>è™½ç„¶å‡½æ•°çš„ thiså€¼æ˜¯éšå¼è®¾ç½®çš„ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨å‡½æ•°æ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨ call()å’Œ apply()æ˜ç¡®è®¾ç½® thiså‚æ•°ã€‚</p><p>æˆ‘ä»¬é‡æ„ä¸€ä¸‹å‰é¢ç« èŠ‚çš„ä»£ç ç‰‡æ®µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="js">function dialogue () {  console.log (`I am ${this.heroName}`);}const hero = {  heroName: &#39;Batman&#39;,};</code></pre><p>å¦‚æœè¦å°† heroå¯¹è±¡ä½œä¸º dialogueå‡½æ•°çš„æ¥æ”¶å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨ call()æˆ– apply() ï¼š</p><pre><code class="js">dialogue.call(hero)// ordialogue.apply(hero)</code></pre><p>å¦‚æœä½ æ˜¯åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ä½¿ç”¨ callæˆ– apply ï¼ŒJavaScriptå¼•æ“ä¼šå¿½ç•¥ä¼ é€’ç»™ callæˆ– applyçš„ nullæˆ– undefined ï¼ˆè¯‘è€…æ³¨ï¼šè¢«æ›¿æ¢ä¸ºglobalï¼‰ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå»ºè®®å§‹ç»ˆä»¥ä¸¥æ ¼æ¨¡å¼ç¼–å†™ä»£ç çš„åŸå› ä¹‹ä¸€ã€‚</p><h2 id="bind"><a href="#bind" class="headerlink" title="bind()"></a>bind()</h2><p>å½“æˆ‘ä»¬å°†ä¸€ä¸ªæ–¹æ³•ä½œä¸ºå›è°ƒå‡½æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæ€»æ˜¯å­˜åœ¨ä¸¢å¤±æ–¹æ³•çš„åŸæœ‰æ¥æ”¶å™¨çš„é£é™©ï¼Œä½¿å¾— thiså‚æ•°æŒ‡å‘å…¨å±€å¯¹è±¡ã€‚</p><p><code>bind()</code>æ–¹æ³•å¯ä»¥å°† thiså‚æ•°å›ºå®šçš„ç»‘å®šåˆ°ä¸€ä¸ªå€¼ä¸Šã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼Œ bindä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ dialogueå‡½æ•°ï¼Œå¹¶å°† thiså€¼è®¾ç½®ä¸º hero ã€‚ï¼ˆè¯‘è€…æ³¨ï¼š<code>bind()</code>æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ï¼Œç§°ä¸ºç»‘å®šå‡½æ•°-bound function-BFï¼Œå½“è°ƒç”¨è¿™ä¸ªç»‘å®šå‡½æ•°æ—¶ï¼Œç»‘å®šå‡½æ•°ä¼šä»¥åˆ›å»ºå®ƒæ—¶ä¼ å…¥ <code>bind()</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸º thisï¼Œä¼ å…¥ <code>bind()</code>æ–¹æ³•çš„ç¬¬äºŒä¸ªä»¥åŠä»¥åçš„å‚æ•°åŠ ä¸Šç»‘å®šå‡½æ•°è¿è¡Œæ—¶æœ¬èº«çš„å‚æ•°æŒ‰ç…§é¡ºåºä½œä¸ºåŸå‡½æ•°çš„å‚æ•°æ¥è°ƒç”¨åŸå‡½æ•°ã€‚ï¼‰</p><pre><code class="js">const hero = {  heroName: &quot;Batman&quot;,  dialogue() {    console.log(`I am ${this.heroName}`);  }};setTimeOut(hero.dialogue.bind(hero), 1000);</code></pre><p>è¿™æ ·çš„è¯ï¼Œå³ä½¿ä½¿ç”¨ callæˆ– applyæ–¹æ³•ä¹Ÿæ— æ³•æ”¹å˜ thisçš„å€¼ ã€‚</p><h2 id="ç®­å¤´å‡½æ•°ä¸­çš„â€œthisâ€"><a href="#ç®­å¤´å‡½æ•°ä¸­çš„â€œthisâ€" class="headerlink" title="ç®­å¤´å‡½æ•°ä¸­çš„â€œthisâ€"></a>ç®­å¤´å‡½æ•°ä¸­çš„â€œthisâ€</h2><p>ç®­å¤´å‡½æ•°å†…çš„ thisä¸å…¶ä»–ç±»å‹çš„JavaScriptå‡½æ•°æœ‰å¾ˆå¤§çš„ä¸åŒã€‚An arrow function uses the this value from its enclosing execution context, since it does have one of its own.</p><p>ç®­å¤´å‡½æ•°ä¼š<strong>æ°¸ä¹…åœ°æ•è· thiså€¼ï¼Œé˜»æ­¢ applyæˆ– callåç»­æ›´æ”¹å®ƒ</strong>ã€‚</p><p>ä¸ºäº†è§£é‡Šç®­å¤´å‡½æ•°ä¸­çš„ thisæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼š</p><pre><code class="js">const batman = this;const bruce = () =&gt; {  console.log(this === batman);};bruce(); //  true</code></pre><p>è¿™é‡Œï¼Œæˆ‘ä»¬å°† thiså€¼å­˜å‚¨åœ¨å˜é‡ä¸­ï¼Œç„¶åå°†è¯¥å€¼ä¸ç®­å¤´å‡½æ•°å†…çš„ thiså€¼è¿›è¡Œæ¯”è¾ƒã€‚åœ¨ç»ˆç«¯ä¸­è¿è¡Œ node index.jsï¼Œè¾“å‡ºåº”è¯¥ä¸º true ã€‚</p><p>ç®­å¤´å‡½æ•°å†…çš„ thiså€¼æ— æ³•æ˜ç¡®è®¾ç½®ã€‚æ­¤å¤–ï¼Œä½¿ç”¨ call ã€ applyæˆ– bindç­‰æ–¹æ³•ç»™ thisä¼ å€¼ï¼Œç®­å¤´å‡½æ•°ä¼šå¿½ç•¥ã€‚<strong>ç®­å¤´å‡½æ•°å¼•ç”¨çš„æ˜¯ç®­å¤´å‡½æ•°åœ¨åˆ›å»ºæ—¶è®¾ç½®çš„ thiså€¼</strong>ã€‚ï¼ˆè¯‘è€…æ³¨ï¼š<strong>ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰thisç»‘å®šï¼Œå¿…é¡»é€šè¿‡æŸ¥æ‰¾ä½œç”¨åŸŸé“¾æ¥å†³å®šå®ƒçš„å€¼ï¼Œå¦‚æœç®­å¤´å‡½æ•°è¢«éç®­å¤´å‡½æ•°åŒ…è£¹ï¼Œé‚£ä¹ˆthiså€¼ç”±å¤–å›´æœ€è¿‘ä¸€å±‚éç®­å¤´å‡½æ•°å†³å®šï¼Œå¦åˆ™ä¸ºundefinedã€‚</strong>ï¼‰</p><p>ç®­å¤´å‡½æ•°ä¹Ÿä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½åœ¨ç®­å¤´å‡½æ•°å†…ç»™ thisè®¾ç½®å±æ€§ã€‚</p><p>é‚£ä¹ˆç®­å¤´å‡½æ•°å¯¹ this å¯ä»¥åšä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ç®­å¤´å‡½æ•° <strong>å¯ä»¥ä½¿æˆ‘ä»¬åœ¨å›è°ƒå‡½æ•°ä¸­è®¿é—®this</strong> ã€‚é€šè¿‡ä¸‹é¢çš„ counterå¯¹è±¡æ¥çœ‹çœ‹å¦‚ä½•åšåˆ°çš„ï¼š</p><pre><code class="js">const counter = {  count: 0,  increase() {    setInterval(function() {      console.log(++this.count);    }, 1000);  }}counter.increase();</code></pre><p>ä½¿ç”¨ node index.jsè¿è¡Œæ­¤ä»£ç ï¼Œåªä¼šå¾—åˆ°ä¸€ä¸ª NaNçš„åˆ—è¡¨ã€‚è¿™æ˜¯å› ä¸º this.countå·²ç»ä¸æ˜¯æŒ‡å‘ counterå¯¹è±¡äº†ã€‚å®ƒå®é™…ä¸ŠæŒ‡å‘çš„ä¸º globalå¯¹è±¡ã€‚</p><p>å¦‚æœæƒ³è®©è®¡æ•°å™¨æ­£å¸¸å·¥ä½œï¼Œå¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°é‡å†™å®ƒã€‚</p><p>å›è°ƒå‡½æ•°ä½¿ç”¨ thisä¸ increaseæ–¹æ³•ç»‘å®šï¼Œ counterç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚</p><p>æ³¨æ„ ï¼šä¸è¦å°† <code>++this.count</code> å†™æˆ this.count + 1ã€‚åè€…åªä¼šå¢åŠ countçš„å€¼ä¸€æ¬¡ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šè¿”å›ç›¸åŒçš„å€¼ã€‚</p><h2 id="Classä¸­çš„â€œthisâ€"><a href="#Classä¸­çš„â€œthisâ€" class="headerlink" title="Classä¸­çš„â€œthisâ€"></a>Classä¸­çš„â€œthisâ€</h2><p>ç±»æ˜¯JavaScriptåº”ç”¨ç¨‹åºä¸­æœ€é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ç±»ä¸­çš„thisæœ‰ä½•ä¸åŒã€‚</p><p>ç±»é€šå¸¸åŒ…å«ä¸€ä¸ª constructor ï¼Œ <strong>thiså¯ä»¥æŒ‡å‘ä»»ä½•æ–°åˆ›å»ºçš„å¯¹è±¡</strong>ã€‚</p><p>ä¸è¿‡åœ¨ä½œä¸ºæ–¹æ³•æ—¶ï¼Œå¦‚æœè¯¥æ–¹æ³•ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨ï¼Œ thisä¹Ÿå¯ä»¥æŒ‡å‘ä»»ä½•å…¶ä»–å€¼ã€‚ä¸æ–¹æ³•ä¸€æ ·ï¼Œç±»ä¹Ÿå¯èƒ½å¤±å»å¯¹æ¥æ”¶å™¨çš„è·Ÿè¸ªã€‚</p><p>æˆ‘ä»¬å°†ä¹‹å‰åˆ›å»ºçš„ Heroå‡½æ•°æ”¹é€ ä¸ºç±»ã€‚è¯¥ç±»åŒ…å«ä¸€ä¸ªæ„é€ å‡½æ•°å’Œä¸€ä¸ª dialogue()æ–¹æ³•ã€‚æœ€åï¼Œåˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹å¹¶è°ƒç”¨ dialogueæ–¹æ³•ã€‚</p><pre><code class="js">class Hero {  constructor(heroName) {    this.heroName = heroName;  }  dialogue() {    console.log(`I am ${this.heroName}`)  }}const batman = new Hero(&quot;Batman&quot;);batman.dialogue();</code></pre><p>æ„é€ å‡½æ•°é‡Œçš„ thisæŒ‡å‘æ–°åˆ›å»ºçš„ ç±»å®ä¾‹ã€‚å½“æˆ‘ä»¬è°ƒç”¨ <code>batman.dialogue()</code>æ—¶ï¼Œ dialogue()ä½œä¸ºæ–¹æ³•è¢«è°ƒç”¨ï¼Œ batmanæ˜¯å®ƒçš„æ¥æ”¶å™¨ã€‚</p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬å°† <code>dialogue()</code>æ–¹æ³•çš„å¼•ç”¨å­˜å‚¨èµ·æ¥ï¼Œå¹¶ç¨åå°†å…¶ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼Œæˆ‘ä»¬ä¼šä¸¢å¤±è¯¥æ–¹æ³•çš„æ¥æ”¶å™¨ï¼Œæ­¤æ—¶ thiså‚æ•°æŒ‡å‘ <code>undefined</code></p><pre><code class="js">const say = batman.dialogue;say();</code></pre><p>å‡ºç°é”™è¯¯çš„åŸå› æ˜¯JavaScript ç±»æ˜¯éšå¼çš„è¿è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹çš„ã€‚æˆ‘ä»¬æ˜¯åœ¨æ²¡æœ‰ä»»ä½•è‡ªåŠ¨ç»‘å®šçš„æƒ…å†µä¸‹è°ƒç”¨ say()å‡½æ•°çš„ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä½¿ç”¨ bind()å°† dialogue()å‡½æ•°ä¸ batmanç»‘å®šåœ¨ä¸€èµ·ã€‚</p><pre><code class="js">const say = batman.dialogue.bind(batman);say();</code></pre><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ æ„é€ å‡½æ•°æ–¹æ³•ä¸­åšè¿™ä¸ªç»‘å®šã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘ä»¬éœ€è¦åœ¨JavaScriptä¸­ä½¿ç”¨ this ï¼Œå°±åƒæˆ‘ä»¬éœ€è¦åœ¨è‹±è¯­ä¸­ä½¿ç”¨ä»£è¯ä¸€æ ·ã€‚ä»¥è¿™ä¸¤å¥è¯ä¸ºä¾‹ï¼š</p><blockquote><ul><li>Rajat loves DC Comics.</li><li>Rajat also loves Marvel movies.</li></ul></blockquote><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£è¯å°†è¿™ä¸¤ä¸ªå¥å­ç»„åˆåœ¨ä¸€èµ·ï¼Œæ‰€ä»¥è¿™ä¸¤å¥è¯ç°åœ¨æˆäº†ï¼š</p><blockquote><ul><li>Rajat loves DC Comics, and he also loves Marvel Comics</li></ul></blockquote><p>è¿™ä¸ªç®€çŸ­çš„è¯­æ³•è¯¾å®Œç¾åœ°è§£é‡Šäº† thisåœ¨JavaScriptä¸­çš„é‡è¦æ€§ã€‚å°±åƒä»£è¯ heå°†ä¸¤ä¸ªå¥å­è¿æ¥åœ¨ä¸€èµ·ä¸€æ ·ï¼Œ thiså¯ä»¥ä½œä¸ºå†æ¬¡å¼•ç”¨ç›¸åŒå†…å®¹çš„æ·å¾„ã€‚</p><p><a href="https://juejin.im/post/5b6676e6f265da0fa00a3a12?utm_source=gold_browser_extension#comment" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> This </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–å†™ä¸€ä¸ªplugin</title>
      <link href="/2018/08/03/Tools/%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAplugin/"/>
      <url>/2018/08/03/Tools/%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAplugin/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Webpack é€šè¿‡ Plugin æœºåˆ¶è®©å…¶æ›´åŠ çµæ´»ï¼Œä»¥é€‚åº”å„ç§åº”ç”¨åœºæ™¯ã€‚ åœ¨ Webpack è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æœã€‚</p><h2 id="æœ€åŸºç¡€çš„-Plugin"><a href="#æœ€åŸºç¡€çš„-Plugin" class="headerlink" title="æœ€åŸºç¡€çš„ Plugin"></a>æœ€åŸºç¡€çš„ Plugin</h2><p>ä¸€ä¸ªæœ€åŸºç¡€çš„ Plugin çš„ä»£ç æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class="js">class BasicPlugin{  // åœ¨æ„é€ å‡½æ•°ä¸­è·å–ç”¨æˆ·ç»™è¯¥æ’ä»¶ä¼ å…¥çš„é…ç½®  construcor(options){  }  apply(compiler){    // Webpack ä¼šè°ƒç”¨ BasicPlugin å®ä¾‹çš„ apply æ–¹æ³•ç»™æ’ä»¶å®ä¾‹ä¼ å…¥ compiler å¯¹è±¡      compiler.plugin(&#39;compilatio&#39;,function(compilatio){    })  }}// å¯¼å‡º Pluginmodule.exports = BasicPlugin;</code></pre><a id="more"></a><p>åœ¨ä½¿ç”¨è¿™ä¸ª Plugin æ—¶ï¼Œç›¸å…³é…ç½®ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">const BasicPlugin = require(&#39;./BasicPlugin.js&#39;);module.export = {  plugins:[    new BasicPlugin(options),  ]}</code></pre><h3 id="pluginå·¥ä½œåŸç†"><a href="#pluginå·¥ä½œåŸç†" class="headerlink" title="pluginå·¥ä½œåŸç†"></a>pluginå·¥ä½œåŸç†</h3><p>Webpack å¯åŠ¨åï¼Œåœ¨è¯»å–é…ç½®çš„è¿‡ç¨‹ä¸­ä¼šå…ˆæ‰§è¡Œ <code>new BasicPlugin(options)</code> åˆå§‹åŒ–ä¸€ä¸ª <code>BasicPlugin</code> è·å¾—å…¶å®ä¾‹ã€‚ åœ¨åˆå§‹åŒ– <code>compiler</code> å¯¹è±¡åï¼Œå†è°ƒç”¨ <code>basicPlugin.apply(compiler)</code> ç»™æ’ä»¶å®ä¾‹ä¼ å…¥ <code>compiler</code> å¯¹è±¡ã€‚ æ’ä»¶å®ä¾‹åœ¨è·å–åˆ° <code>compiler</code> å¯¹è±¡åï¼Œå°±å¯ä»¥é€šè¿‡ <code>compiler.plugin(äº‹ä»¶åç§°, å›è°ƒå‡½æ•°)</code> ç›‘å¬åˆ° Webpack å¹¿æ’­å‡ºæ¥çš„äº‹ä»¶ã€‚ å¹¶ä¸”å¯ä»¥é€šè¿‡ <code>compiler</code> å¯¹è±¡å»æ“ä½œ Webpackã€‚</p><p>é€šè¿‡ä»¥ä¸Šæœ€ç®€å•çš„ Plugin ç›¸ä¿¡ä½ å¤§æ¦‚æ˜ç™½äº† Plugin çš„å·¥ä½œåŸç†ï¼Œä½†å®é™…å¼€å‘ä¸­è¿˜æœ‰å¾ˆå¤šç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œä¸‹é¢æ¥è¯¦ç»†ä»‹ç»ã€‚</p><p>åœ¨å¼€å‘ Plugin æ—¶æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå¯¹è±¡å°±æ˜¯ <code>Compiler</code> å’Œ <code>Compilation</code>ï¼Œ<strong>å®ƒä»¬æ˜¯ Plugin å’Œ Webpack ä¹‹é—´çš„æ¡¥æ¢</strong>ã€‚</p><blockquote><p>Compiler å’Œ Compilation çš„å«ä¹‰å¦‚ä¸‹ï¼š</p></blockquote><ul><li>Compiler å¯¹è±¡åŒ…å«äº† Webpack ç¯å¢ƒæ‰€æœ‰çš„çš„é…ç½®ä¿¡æ¯ï¼ŒåŒ…å« optionsï¼Œloadersï¼Œplugins è¿™äº›ä¿¡æ¯ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨ Webpack å¯åŠ¨æ—¶å€™è¢«å®ä¾‹åŒ–ï¼Œå®ƒæ˜¯å…¨å±€å”¯ä¸€çš„ï¼Œå¯ä»¥ç®€å•åœ°æŠŠå®ƒç†è§£ä¸º Webpack å®ä¾‹ï¼›</li><li>Compilation å¯¹è±¡åŒ…å«äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ç­‰ã€‚å½“ Webpack ä»¥å¼€å‘æ¨¡å¼è¿è¡Œæ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å˜åŒ–ï¼Œä¸€æ¬¡æ–°çš„ Compilation å°†è¢«åˆ›å»ºã€‚Compilation å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šäº‹ä»¶å›è°ƒä¾›æ’ä»¶åšæ‰©å±•ã€‚é€šè¿‡ Compilation ä¹Ÿèƒ½è¯»å–åˆ° Compiler å¯¹è±¡ã€‚</li></ul><p>Compiler å’Œ Compilation çš„åŒºåˆ«åœ¨äºï¼š<strong>Compiler ä»£è¡¨äº†æ•´ä¸ª Webpack ä»å¯åŠ¨åˆ°å…³é—­çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€Œ Compilation åªæ˜¯ä»£è¡¨äº†ä¸€æ¬¡æ–°çš„ç¼–è¯‘</strong>ã€‚</p><h2 id="äº‹ä»¶æµ"><a href="#äº‹ä»¶æµ" class="headerlink" title="äº‹ä»¶æµ"></a>äº‹ä»¶æµ</h2><p>Webpack å°±åƒä¸€æ¡ç”Ÿäº§çº¿ï¼Œè¦ç»è¿‡ä¸€ç³»åˆ—å¤„ç†æµç¨‹åæ‰èƒ½å°†æºæ–‡ä»¶è½¬æ¢æˆè¾“å‡ºç»“æœã€‚ è¿™æ¡ç”Ÿäº§çº¿ä¸Šçš„æ¯ä¸ªå¤„ç†æµç¨‹çš„èŒè´£éƒ½æ˜¯å•ä¸€çš„ï¼Œå¤šä¸ªæµç¨‹ä¹‹é—´æœ‰å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œåªæœ‰å®Œæˆå½“å‰å¤„ç†åæ‰èƒ½äº¤ç»™ä¸‹ä¸€ä¸ªæµç¨‹å»å¤„ç†ã€‚ æ’ä»¶å°±åƒæ˜¯ä¸€ä¸ªæ’å…¥åˆ°ç”Ÿäº§çº¿ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ç‰¹å®šçš„æ—¶æœºå¯¹ç”Ÿäº§çº¿ä¸Šçš„èµ„æºåšå¤„ç†ã€‚</p><p>Webpack é€šè¿‡ Tapable æ¥ç»„ç»‡è¿™æ¡å¤æ‚çš„ç”Ÿäº§çº¿ã€‚ Webpack åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šå¹¿æ’­äº‹ä»¶ï¼Œæ’ä»¶åªéœ€è¦ç›‘å¬å®ƒæ‰€å…³å¿ƒçš„äº‹ä»¶ï¼Œå°±èƒ½åŠ å…¥åˆ°è¿™æ¡ç”Ÿäº§çº¿ä¸­ï¼Œå»æ”¹å˜ç”Ÿäº§çº¿çš„è¿ä½œã€‚ Webpack çš„äº‹ä»¶æµæœºåˆ¶ä¿è¯äº†æ’ä»¶çš„æœ‰åºæ€§ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿæ‰©å±•æ€§å¾ˆå¥½ã€‚</p><p>Webpack çš„äº‹ä»¶æµæœºåˆ¶åº”ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå’Œ Node.js ä¸­çš„ EventEmitter éå¸¸ç›¸ä¼¼ã€‚ Compiler å’Œ Compilation éƒ½ç»§æ‰¿è‡ª Tapableï¼Œå¯ä»¥ç›´æ¥åœ¨ Compiler å’Œ Compilation å¯¹è±¡ä¸Šå¹¿æ’­å’Œç›‘å¬äº‹ä»¶ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code class="js">/*** å¹¿æ’­å‡ºäº‹ä»¶* event-name ä¸ºäº‹ä»¶åç§°ï¼Œæ³¨æ„ä¸è¦å’Œç°æœ‰çš„äº‹ä»¶é‡å* params ä¸ºé™„å¸¦çš„å‚æ•°*/compiler.apply(&#39;event-name&#39;,params);/*** ç›‘å¬åç§°ä¸º event-name çš„äº‹ä»¶ï¼Œå½“ event-name äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œã€‚* åŒæ—¶å‡½æ•°ä¸­çš„ params å‚æ•°ä¸ºå¹¿æ’­äº‹ä»¶æ—¶é™„å¸¦çš„å‚æ•°ã€‚*/compiler.plugin(&#39;event-name&#39;,function(params) {});</code></pre><p>åŒç†ï¼Œ<code>compilation.apply</code> å’Œ <code>compilation.plugin</code> ä½¿ç”¨æ–¹æ³•å’Œä¸Šé¢ä¸€è‡´ã€‚</p><p>åœ¨å¼€å‘æ’ä»¶æ—¶ï¼Œä½ å¯èƒ½ä¼šä¸çŸ¥é“è¯¥å¦‚ä½•ä¸‹æ‰‹ï¼Œå› ä¸ºä½ ä¸çŸ¥é“è¯¥ç›‘å¬å“ªä¸ªäº‹ä»¶æ‰èƒ½å®Œæˆä»»åŠ¡ã€‚</p><blockquote><p>åœ¨å¼€å‘æ’ä»¶æ—¶ï¼Œè¿˜éœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p></blockquote><ul><li>åªè¦èƒ½æ‹¿åˆ° Compiler æˆ– Compilation å¯¹è±¡ï¼Œå°±èƒ½å¹¿æ’­å‡ºæ–°çš„äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨æ–°å¼€å‘çš„æ’ä»¶ä¸­ä¹Ÿèƒ½å¹¿æ’­å‡ºäº‹ä»¶ï¼Œç»™å…¶å®ƒæ’ä»¶ç›‘å¬ä½¿ç”¨ã€‚</li><li>ä¼ ç»™æ¯ä¸ªæ’ä»¶çš„ Compiler å’Œ Compilation å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªå¼•ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªæ’ä»¶ä¸­ä¿®æ”¹äº† Compiler æˆ– Compilation å¯¹è±¡ä¸Šçš„å±æ€§ï¼Œä¼šå½±å“åˆ°åé¢çš„æ’ä»¶ã€‚</li></ul><p>æœ‰äº›äº‹ä»¶æ˜¯å¼‚æ­¥çš„ï¼Œè¿™äº›å¼‚æ­¥çš„äº‹ä»¶ä¼šé™„å¸¦ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œåœ¨æ’ä»¶å¤„ç†å®Œä»»åŠ¡æ—¶éœ€è¦è°ƒç”¨å›è°ƒå‡½æ•°é€šçŸ¥ Webpackï¼Œæ‰ä¼šè¿›å…¥ä¸‹ä¸€å¤„ç†æµç¨‹ã€‚ä¾‹å¦‚ï¼š</p><pre><code class="js">  compiler.plugin(&#39;emit&#39;,function(compilation, callback) {    // æ”¯æŒå¤„ç†é€»è¾‘    // å¤„ç†å®Œæ¯•åæ‰§è¡Œ callback ä»¥é€šçŸ¥ Webpack    // å¦‚æœä¸æ‰§è¡Œ callbackï¼Œè¿è¡Œæµç¨‹å°†ä¼šä¸€ç›´å¡åœ¨è¿™ä¸å¾€ä¸‹æ‰§è¡Œ    callback();  });</code></pre><h2 id="å¸¸ç”¨-API"><a href="#å¸¸ç”¨-API" class="headerlink" title="å¸¸ç”¨ API"></a>å¸¸ç”¨ API</h2><h3 id="è¯»å–è¾“å‡ºèµ„æºã€ä»£ç å—ã€æ¨¡å—åŠå…¶ä¾èµ–"><a href="#è¯»å–è¾“å‡ºèµ„æºã€ä»£ç å—ã€æ¨¡å—åŠå…¶ä¾èµ–" class="headerlink" title="è¯»å–è¾“å‡ºèµ„æºã€ä»£ç å—ã€æ¨¡å—åŠå…¶ä¾èµ–"></a>è¯»å–è¾“å‡ºèµ„æºã€ä»£ç å—ã€æ¨¡å—åŠå…¶ä¾èµ–</h3><p>æœ‰äº›æ’ä»¶å¯èƒ½éœ€è¦è¯»å– Webpack çš„å¤„ç†ç»“æœï¼Œä¾‹å¦‚è¾“å‡ºèµ„æºã€ä»£ç å—ã€æ¨¡å—åŠå…¶ä¾èµ–ï¼Œä»¥ä¾¿åšä¸‹ä¸€æ­¥å¤„ç†ã€‚</p><p>åœ¨ emit äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä»£è¡¨æºæ–‡ä»¶çš„è½¬æ¢å’Œç»„è£…å·²ç»å®Œæˆï¼Œåœ¨è¿™é‡Œå¯ä»¥è¯»å–åˆ°æœ€ç»ˆå°†è¾“å‡ºçš„èµ„æºã€ä»£ç å—ã€æ¨¡å—åŠå…¶ä¾èµ–ï¼Œå¹¶ä¸”å¯ä»¥ä¿®æ”¹è¾“å‡ºèµ„æºçš„å†…å®¹ã€‚ æ’ä»¶ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">class Plugin {  apply(compiler) {    compiler.plugin(&#39;emit&#39;, function (compilation, callback) {      // compilation.chunks å­˜æ”¾æ‰€æœ‰ä»£ç å—ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„      compilation.chunks.forEach(function (chunk) {        // chunk ä»£è¡¨ä¸€ä¸ªä»£ç å—        // ä»£ç å—ç”±å¤šä¸ªæ¨¡å—ç»„æˆï¼Œé€šè¿‡ chunk.forEachModule èƒ½è¯»å–ç»„æˆä»£ç å—çš„æ¯ä¸ªæ¨¡å—        chunk.forEachModule(function (module) {          // module ä»£è¡¨ä¸€ä¸ªæ¨¡å—          // module.fileDependencies å­˜æ”¾å½“å‰æ¨¡å—çš„æ‰€æœ‰ä¾èµ–çš„æ–‡ä»¶è·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„          module.fileDependencies.forEach(function (filepath) {          });        });        // Webpack ä¼šæ ¹æ® Chunk å»ç”Ÿæˆè¾“å‡ºçš„æ–‡ä»¶èµ„æºï¼Œæ¯ä¸ª Chunk éƒ½å¯¹åº”ä¸€ä¸ªåŠå…¶ä»¥ä¸Šçš„è¾“å‡ºæ–‡ä»¶        // ä¾‹å¦‚åœ¨ Chunk ä¸­åŒ…å«äº† CSS æ¨¡å—å¹¶ä¸”ä½¿ç”¨äº† ExtractTextPlugin æ—¶ï¼Œ        // è¯¥ Chunk å°±ä¼šç”Ÿæˆ .js å’Œ .css ä¸¤ä¸ªæ–‡ä»¶        chunk.files.forEach(function (filename) {          // compilation.assets å­˜æ”¾å½“å‰æ‰€æœ‰å³å°†è¾“å‡ºçš„èµ„æº          // è°ƒç”¨ä¸€ä¸ªè¾“å‡ºèµ„æºçš„ source() æ–¹æ³•èƒ½è·å–åˆ°è¾“å‡ºèµ„æºçš„å†…å®¹          let source = compilation.assets[filename].source();        });      });      // è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶ï¼Œè¦è®°å¾—è°ƒç”¨ callback é€šçŸ¥ Webpack æœ¬æ¬¡äº‹ä»¶ç›‘å¬å¤„ç†ç»“æŸã€‚      // å¦‚æœå¿˜è®°äº†è°ƒç”¨ callbackï¼ŒWebpack å°†ä¸€ç›´å¡åœ¨è¿™é‡Œè€Œä¸ä¼šå¾€åæ‰§è¡Œã€‚      callback();    })  }}</code></pre><h3 id="ç›‘å¬æ–‡ä»¶çš„å˜åŒ–"><a href="#ç›‘å¬æ–‡ä»¶çš„å˜åŒ–" class="headerlink" title="ç›‘å¬æ–‡ä»¶çš„å˜åŒ–"></a>ç›‘å¬æ–‡ä»¶çš„å˜åŒ–</h3><p>åœ¨å¼€å‘æ’ä»¶æ—¶ç»å¸¸éœ€è¦çŸ¥é“æ˜¯å“ªä¸ªæ–‡ä»¶å‘ç”Ÿå˜åŒ–å¯¼è‡´äº†æ–°çš„ <code>Compilation</code>ï¼Œä¸ºæ­¤å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š</p><pre><code class="js">// å½“ä¾èµ–çš„æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ä¼šè§¦å‘ watch-run äº‹ä»¶compiler.plugin(&#39;watch-run&#39;, (watching, callback) =&gt; {    // è·å–å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶åˆ—è¡¨    const changedFiles = watching.compiler.watchFileSystem.watcher.mtimes;    // changedFiles æ ¼å¼ä¸ºé”®å€¼å¯¹ï¼Œé”®ä¸ºå‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶è·¯å¾„ã€‚    if (changedFiles[filePath] !== undefined) {      // filePath å¯¹åº”çš„æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–    }    callback();});</code></pre><p>é»˜è®¤æƒ…å†µä¸‹ Webpack åªä¼šç›‘è§†å…¥å£å’Œå…¶ä¾èµ–çš„æ¨¡å—æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹é¡¹ç›®å¯èƒ½éœ€è¦å¼•å…¥æ–°çš„æ–‡ä»¶ï¼Œä¾‹å¦‚å¼•å…¥ä¸€ä¸ª HTML æ–‡ä»¶ã€‚ ç”±äº JavaScript æ–‡ä»¶ä¸ä¼šå»å¯¼å…¥ HTML æ–‡ä»¶ï¼ŒWebpack å°±ä¸ä¼šç›‘å¬ HTML æ–‡ä»¶çš„å˜åŒ–ï¼Œç¼–è¾‘ HTML æ–‡ä»¶æ—¶å°±ä¸ä¼šé‡æ–°è§¦å‘æ–°çš„ <code>Compilation</code>ã€‚ ä¸ºäº†ç›‘å¬ HTML æ–‡ä»¶çš„å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ HTML æ–‡ä»¶åŠ å…¥åˆ°ä¾èµ–åˆ—è¡¨ä¸­ï¼Œä¸ºæ­¤å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š</p><pre><code class="js">compiler.plugin(&#39;after-compile&#39;, (compilation, callback) =&gt; {  // æŠŠ HTML æ–‡ä»¶æ·»åŠ åˆ°æ–‡ä»¶ä¾èµ–åˆ—è¡¨ï¼Œå¥½è®© Webpack å»ç›‘å¬ HTML æ¨¡å—æ–‡ä»¶ï¼Œåœ¨ HTML æ¨¡ç‰ˆæ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°å¯åŠ¨ä¸€æ¬¡ç¼–è¯‘    compilation.fileDependencies.push(filePath);    callback();})</code></pre><h3 id="ä¿®æ”¹è¾“å‡ºèµ„æº"><a href="#ä¿®æ”¹è¾“å‡ºèµ„æº" class="headerlink" title="ä¿®æ”¹è¾“å‡ºèµ„æº"></a>ä¿®æ”¹è¾“å‡ºèµ„æº</h3><p>æœ‰äº›åœºæ™¯ä¸‹æ’ä»¶éœ€è¦ä¿®æ”¹ã€å¢åŠ ã€åˆ é™¤è¾“å‡ºçš„èµ„æºï¼Œè¦åšåˆ°è¿™ç‚¹éœ€è¦ç›‘å¬ emit äº‹ä»¶ï¼Œå› ä¸ºå‘ç”Ÿ emit äº‹ä»¶æ—¶æ‰€æœ‰æ¨¡å—çš„è½¬æ¢å’Œä»£ç å—å¯¹åº”çš„æ–‡ä»¶å·²ç»ç”Ÿæˆå¥½ï¼Œ éœ€è¦è¾“å‡ºçš„èµ„æºå³å°†è¾“å‡ºï¼Œå› æ­¤ emit äº‹ä»¶æ˜¯ä¿®æ”¹ Webpack è¾“å‡ºèµ„æºçš„æœ€åæ—¶æœºã€‚</p><p>æ‰€æœ‰éœ€è¦è¾“å‡ºçš„èµ„æºä¼šå­˜æ”¾åœ¨ <code>compilation.assets</code> ä¸­ï¼Œ<code>compilation.assets</code> æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œé”®ä¸ºéœ€è¦è¾“å‡ºçš„æ–‡ä»¶åç§°ï¼Œå€¼ä¸ºæ–‡ä»¶å¯¹åº”çš„å†…å®¹ã€‚</p><p>è®¾ç½® <code>compilation.assets</code> çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">compiler.plugin(&#39;emit&#39;, (compilation, callback) =&gt; {  // è®¾ç½®åç§°ä¸º fileName çš„è¾“å‡ºèµ„æº  compilation.assets[fileName] = {    // è¿”å›æ–‡ä»¶å†…å®¹    source: () =&gt; {      // fileContent æ—¢å¯ä»¥æ˜¯ä»£è¡¨æ–‡æœ¬æ–‡ä»¶çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»£è¡¨äºŒè¿›åˆ¶æ–‡ä»¶çš„ Buffer      return fileContent;      },    // è¿”å›æ–‡ä»¶å¤§å°      size: () =&gt; {      return Buffer.byteLength(fileContent, &#39;utf8&#39;);    }  };  callback();});</code></pre><p>è¯»å– <code>compilation.assets</code> çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">compiler.plugin(&#39;emit&#39;, (compilation, callback) =&gt; {  // è¯»å–åç§°ä¸º fileName çš„è¾“å‡ºèµ„æº  const asset = compilation.assets[fileName];  // è·å–è¾“å‡ºèµ„æºçš„å†…å®¹  asset.source();  // è·å–è¾“å‡ºèµ„æºçš„æ–‡ä»¶å¤§å°  asset.size();  callback();});</code></pre><h2 id="åˆ¤æ–­-Webpack-ä½¿ç”¨äº†å“ªäº›æ’ä»¶"><a href="#åˆ¤æ–­-Webpack-ä½¿ç”¨äº†å“ªäº›æ’ä»¶" class="headerlink" title="åˆ¤æ–­ Webpack ä½¿ç”¨äº†å“ªäº›æ’ä»¶"></a>åˆ¤æ–­ Webpack ä½¿ç”¨äº†å“ªäº›æ’ä»¶</h2><p>åœ¨å¼€å‘ä¸€ä¸ªæ’ä»¶æ—¶å¯èƒ½éœ€è¦æ ¹æ®å½“å‰é…ç½®æ˜¯å¦ä½¿ç”¨äº†å…¶å®ƒæŸä¸ªæ’ä»¶è€Œåšä¸‹ä¸€æ­¥å†³å®šï¼Œå› æ­¤éœ€è¦è¯»å– Webpack å½“å‰çš„æ’ä»¶é…ç½®æƒ…å†µã€‚ ä»¥åˆ¤æ–­å½“å‰æ˜¯å¦ä½¿ç”¨äº† <code>ExtractTextPlugin</code> ä¸ºä¾‹ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š</p><pre><code class="js">// åˆ¤æ–­å½“å‰é…ç½®ä½¿ç”¨ä½¿ç”¨äº† ExtractTextPluginï¼Œ// compiler å‚æ•°å³ä¸º Webpack åœ¨ apply(compiler) ä¸­ä¼ å…¥çš„å‚æ•°function hasExtractTextPlugin(compiler) {  // å½“å‰é…ç½®æ‰€æœ‰ä½¿ç”¨çš„æ’ä»¶åˆ—è¡¨  const plugins = compiler.options.plugins;  // å» plugins ä¸­å¯»æ‰¾æœ‰æ²¡æœ‰ ExtractTextPlugin çš„å®ä¾‹  return plugins.find(plugin=&gt;plugin.__proto__.constructor === ExtractTextPlugin) != null;}</code></pre><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>ä¸‹é¢æˆ‘ä»¬ä¸¾ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œå¸¦ä½ ä¸€æ­¥æ­¥å»å®ç°ä¸€ä¸ªæ’ä»¶ã€‚</p><p>è¯¥æ’ä»¶çš„åç§°å–åå« <code>EndWebpackPlugin</code>ï¼Œä½œç”¨<em>æ˜¯åœ¨ Webpack å³å°†é€€å‡ºæ—¶å†é™„åŠ ä¸€äº›é¢å¤–çš„æ“ä½œ</em>ï¼Œä¾‹å¦‚åœ¨ Webpack æˆåŠŸç¼–è¯‘å’Œè¾“å‡ºäº†æ–‡ä»¶åæ‰§è¡Œå‘å¸ƒæ“ä½œæŠŠè¾“å‡ºçš„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚ åŒæ—¶è¯¥æ’ä»¶è¿˜èƒ½åŒºåˆ† Webpack æ„å»ºæ˜¯å¦æ‰§è¡ŒæˆåŠŸã€‚ä½¿ç”¨è¯¥æ’ä»¶æ—¶æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code class="js">module.exports = {  plugins:[    // åœ¨åˆå§‹åŒ– EndWebpackPlugin æ—¶ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯åœ¨æˆåŠŸæ—¶çš„å›è°ƒå‡½æ•°å’Œå¤±è´¥æ—¶çš„å›è°ƒå‡½æ•°ï¼›    new EndWebpackPlugin(() =&gt; {      // Webpack æ„å»ºæˆåŠŸï¼Œå¹¶ä¸”æ–‡ä»¶è¾“å‡ºäº†åä¼šæ‰§è¡Œåˆ°è¿™é‡Œï¼Œåœ¨è¿™é‡Œå¯ä»¥åšå‘å¸ƒæ–‡ä»¶æ“ä½œ    }, (err) =&gt; {      // Webpack æ„å»ºå¤±è´¥ï¼Œerr æ˜¯å¯¼è‡´é”™è¯¯çš„åŸå›       console.error(err);    })  ]}</code></pre><blockquote><p>è¦å®ç°è¯¥æ’ä»¶ï¼Œéœ€è¦å€ŸåŠ©ä¸¤ä¸ªäº‹ä»¶ï¼š</p></blockquote><ul><li>doneï¼šåœ¨æˆåŠŸæ„å»ºå¹¶ä¸”è¾“å‡ºäº†æ–‡ä»¶åï¼ŒWebpack å³å°†é€€å‡ºæ—¶å‘ç”Ÿï¼›</li><li>failedï¼šåœ¨æ„å»ºå‡ºç°å¼‚å¸¸å¯¼è‡´æ„å»ºå¤±è´¥ï¼ŒWebpack å³å°†é€€å‡ºæ—¶å‘ç”Ÿï¼›</li></ul><p>å®ç°è¯¥æ’ä»¶éå¸¸ç®€å•ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">class EndWebpackPlugin {  constructor(doneCallback, failCallback) {    // å­˜ä¸‹åœ¨æ„é€ å‡½æ•°ä¸­ä¼ å…¥çš„å›è°ƒå‡½æ•°    this.doneCallback = doneCallback;    this.failCallback = failCallback;  }  apply(compiler) {    compiler.plugin(&#39;done&#39;, (stats) =&gt; {        // åœ¨ done äº‹ä»¶ä¸­å›è°ƒ doneCallback        this.doneCallback(stats);    });    compiler.plugin(&#39;failed&#39;, (err) =&gt; {        // åœ¨ failed äº‹ä»¶ä¸­å›è°ƒ failCallback        this.failCallback(err);    });  }}// å¯¼å‡ºæ’ä»¶module.exports = EndWebpackPlugin;</code></pre><p>ä»å¼€å‘è¿™ä¸ªæ’ä»¶å¯ä»¥çœ‹å‡ºï¼Œæ‰¾åˆ°åˆé€‚çš„äº‹ä»¶ç‚¹å»å®ŒæˆåŠŸèƒ½åœ¨å¼€å‘æ’ä»¶æ—¶æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚ åœ¨ 5-1å·¥ä½œåŸç†æ¦‚æ‹¬ ä¸­è¯¦ç»†ä»‹ç»è¿‡ Webpack åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¹¿æ’­å‡ºå¸¸ç”¨äº‹ä»¶ï¼Œä½ å¯ä»¥ä»ä¸­æ‰¾åˆ°ä½ éœ€è¦çš„äº‹ä»¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–å†™ä¸€ä¸ªloader</title>
      <link href="/2018/08/03/Tools/%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAloader/"/>
      <url>/2018/08/03/Tools/%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAloader/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Loader å°±åƒæ˜¯ä¸€ä¸ªç¿»è¯‘å‘˜ï¼Œèƒ½æŠŠæºæ–‡ä»¶ç»è¿‡è½¬åŒ–åè¾“å‡ºæ–°çš„ç»“æœï¼Œå¹¶ä¸”ä¸€ä¸ªæ–‡ä»¶è¿˜å¯ä»¥é“¾å¼çš„ç»è¿‡å¤šä¸ªç¿»è¯‘å‘˜ç¿»è¯‘ã€‚</p><blockquote><p>ä»¥å¤„ç† SCSS æ–‡ä»¶ä¸ºä¾‹ï¼š</p></blockquote><p>SCSS æºä»£ç ä¼šå…ˆäº¤ç»™ sass-loader æŠŠ SCSS è½¬æ¢æˆ CSSï¼›<br>æŠŠ sass-loader è¾“å‡ºçš„ CSS äº¤ç»™ css-loader å¤„ç†ï¼Œæ‰¾å‡º CSS ä¸­ä¾èµ–çš„èµ„æºã€å‹ç¼© CSS ç­‰ï¼›<br>æŠŠ css-loader è¾“å‡ºçš„ CSS äº¤ç»™ style-loader å¤„ç†ï¼Œè½¬æ¢æˆé€šè¿‡è„šæœ¬åŠ è½½çš„ JavaScript ä»£ç ï¼›</p><pre><code class="js">module.exports = {  module:{    rules:[       // å¢åŠ å¯¹ SCSS æ–‡ä»¶çš„æ”¯æŒ       test: /\.scss/,       // SCSS æ–‡ä»¶çš„å¤„ç†é¡ºåºä¸ºå…ˆ sass-loader å† css-loader å† style-loader       use:[         &#39;style.loader&#39;,         {           loader:&#39;css-loader&#39;,           options:{              minimize:true,            }         },         &#39;scss-loader&#39;       ],    ]  }}</code></pre><h2 id="Loader-çš„èŒè´£"><a href="#Loader-çš„èŒè´£" class="headerlink" title="Loader çš„èŒè´£"></a>Loader çš„èŒè´£</h2><p>ç”±ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼šä¸€ä¸ª Loader çš„èŒè´£æ˜¯å•ä¸€çš„ï¼Œåªéœ€è¦å®Œæˆä¸€ç§è½¬æ¢ã€‚ å¦‚æœä¸€ä¸ªæºæ–‡ä»¶éœ€è¦ç»å†å¤šæ­¥è½¬æ¢æ‰èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œå°±é€šè¿‡å¤šä¸ª Loader å»è½¬æ¢ã€‚ åœ¨è°ƒç”¨å¤šä¸ª Loader å»è½¬æ¢ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ¯ä¸ª Loader ä¼šé“¾å¼çš„é¡ºåºæ‰§è¡Œï¼Œ ç¬¬ä¸€ä¸ª Loader å°†ä¼šæ‹¿åˆ°éœ€å¤„ç†çš„åŸå†…å®¹ï¼Œä¸Šä¸€ä¸ª Loader å¤„ç†åçš„ç»“æœä¼šä¼ ç»™ä¸‹ä¸€ä¸ªæ¥ç€å¤„ç†ï¼Œæœ€åçš„ Loader å°†å¤„ç†åçš„æœ€ç»ˆç»“æœè¿”å›ç»™ Webpackã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨ä½ å¼€å‘ä¸€ä¸ª Loader æ—¶ï¼Œè¯· <strong>ä¿æŒå…¶èŒè´£çš„å•ä¸€æ€§</strong>ï¼Œä½ åªéœ€ <strong>å…³å¿ƒè¾“å…¥å’Œè¾“å‡º</strong>ã€‚<br><a id="more"></a><br>ç”±äº Webpack æ˜¯è¿è¡Œåœ¨ Node.js ä¹‹ä¸Šçš„ï¼Œä¸€ä¸ª Loader å…¶å®å°±æ˜¯ä¸€ä¸ª Node.js æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—éœ€è¦å¯¼å‡ºä¸€ä¸ªå‡½æ•°ã€‚ è¿™ä¸ªå¯¼å‡ºçš„å‡½æ•°çš„å·¥ä½œå°±æ˜¯è·å¾—å¤„ç†å‰çš„åŸå†…å®¹ï¼Œå¯¹åŸå†…å®¹æ‰§è¡Œå¤„ç†åï¼Œè¿”å›å¤„ç†åçš„å†…å®¹ã€‚</p><p>ä¸€ä¸ªç®€å•çš„loaderæºç </p><pre><code class="js">module.exports = function(source){  // source ä¸º compiler ä¼ é€’ç»™ Loader çš„ä¸€ä¸ªæ–‡ä»¶çš„åŸå†…å®¹  // è¯¥å‡½æ•°éœ€è¦è¿”å›å¤„ç†åçš„å†…å®¹ï¼Œè¿™é‡Œç®€å•èµ·è§ï¼Œç›´æ¥æŠŠåŸå†…å®¹è¿”å›äº†ï¼Œç›¸å½“äºè¯¥ Loader æ²¡æœ‰åšä»»ä½•è½¬æ¢  return source;}</code></pre><p>ç”±äº Loader è¿è¡Œåœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥è°ƒç”¨ä»»ä½• Node.js è‡ªå¸¦çš„ APIï¼Œæˆ–è€…å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—è¿›è¡Œè°ƒç”¨ï¼š</p><pre><code class="js">const sass = require(&#39;node-sass&#39;);module.exports = function(source) {  return sass(source);};</code></pre><h2 id="Loader-è¿›é˜¶"><a href="#Loader-è¿›é˜¶" class="headerlink" title="Loader è¿›é˜¶"></a>Loader è¿›é˜¶</h2><p>ä»¥ä¸Šåªæ˜¯ä¸ªæœ€ç®€å•çš„ Loaderï¼ŒWebpack è¿˜æä¾›ä¸€äº› API ä¾› Loader è°ƒç”¨ï¼Œä¸‹é¢æ¥ä¸€ä¸€ä»‹ç»ã€‚</p><h3 id="è·å¾—-Loader-çš„-options"><a href="#è·å¾—-Loader-çš„-options" class="headerlink" title="è·å¾— Loader çš„ options**"></a>è·å¾— Loader çš„ options**</h3><p>åœ¨æœ€ä¸Šé¢å¤„ç† SCSS æ–‡ä»¶çš„ Webpack é…ç½®ä¸­ï¼Œç»™ css-loader ä¼ äº† options å‚æ•°ï¼Œä»¥æ§åˆ¶ css-loaderã€‚ å¦‚ä½•åœ¨è‡ªå·±ç¼–å†™çš„ Loader ä¸­è·å–åˆ°ç”¨æˆ·ä¼ å…¥çš„ options å‘¢ï¼Ÿéœ€è¦è¿™æ ·åšï¼š</p><pre><code class="js">const loaderUtils = require(&#39;loader-utils&#39;);module.exports = function(source) {  // è·å–åˆ°ç”¨æˆ·ç»™å½“å‰ Loader ä¼ å…¥çš„ options  const options = loaderUtils.getOptions(this);  return source;};</code></pre><h3 id="è¿”å›å…¶å®ƒç»“æœ"><a href="#è¿”å›å…¶å®ƒç»“æœ" class="headerlink" title="è¿”å›å…¶å®ƒç»“æœ"></a>è¿”å›å…¶å®ƒç»“æœ</h3><p>ä¸Šé¢çš„ Loader éƒ½åªæ˜¯è¿”å›äº†åŸå†…å®¹è½¬æ¢åçš„å†…å®¹ï¼Œä½†æœ‰äº›åœºæ™¯ä¸‹è¿˜éœ€è¦è¿”å›é™¤äº†å†…å®¹ä¹‹å¤–çš„ä¸œè¥¿ã€‚</p><p>ä¾‹å¦‚ä»¥ç”¨ <code>babel-loader</code> è½¬æ¢ ES6 ä»£ç ä¸ºä¾‹ï¼Œå®ƒè¿˜éœ€è¦è¾“å‡ºè½¬æ¢åçš„ ES5 ä»£ç å¯¹åº”çš„ <code>Source Map</code>ï¼Œä»¥æ–¹ä¾¿è°ƒè¯•æºç ã€‚ ä¸ºäº†æŠŠ <code>Source Map</code> ä¹Ÿä¸€èµ·éšç€ ES5 ä»£ç è¿”å›ç»™ Webpackï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p><pre><code class="js">module.exports = function(source) {  // é€šè¿‡ this.callback å‘Šè¯‰ Webpack è¿”å›çš„ç»“æœ  this.callback(null, source, sourceMaps);  // å½“ä½ ä½¿ç”¨ this.callback è¿”å›å†…å®¹æ—¶ï¼Œè¯¥ Loader å¿…é¡»è¿”å› undefinedï¼Œ  // ä»¥è®© Webpack çŸ¥é“è¯¥ Loader è¿”å›çš„ç»“æœåœ¨ this.callback ä¸­ï¼Œè€Œä¸æ˜¯ return ä¸­  return;};</code></pre><p>å…¶ä¸­çš„ <code>this.callback</code> æ˜¯ Webpack ç»™ Loader æ³¨å…¥çš„ APIï¼Œä»¥æ–¹ä¾¿ Loader å’Œ Webpack ä¹‹é—´é€šä¿¡ã€‚ <code>this.callback</code> çš„è¯¦ç»†ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code class="js">this.callback(    // å½“æ— æ³•è½¬æ¢åŸå†…å®¹æ—¶ï¼Œç»™ Webpack è¿”å›ä¸€ä¸ª Error    err: Error | null,    // åŸå†…å®¹è½¬æ¢åçš„å†…å®¹    content: string | Buffer,    // ç”¨äºæŠŠè½¬æ¢åçš„å†…å®¹å¾—å‡ºåŸå†…å®¹çš„ Source Mapï¼Œæ–¹ä¾¿è°ƒè¯•    sourceMap?: SourceMap,    // å¦‚æœæœ¬æ¬¡è½¬æ¢ä¸ºåŸå†…å®¹ç”Ÿæˆäº† AST è¯­æ³•æ ‘ï¼Œå¯ä»¥æŠŠè¿™ä¸ª AST è¿”å›ï¼Œ    // ä»¥æ–¹ä¾¿ä¹‹åéœ€è¦ AST çš„ Loader å¤ç”¨è¯¥ ASTï¼Œä»¥é¿å…é‡å¤ç”Ÿæˆ ASTï¼Œæå‡æ€§èƒ½    abstractSyntaxTree?: AST);</code></pre><blockquote><p>Source Map çš„ç”Ÿæˆå¾ˆè€—æ—¶ï¼Œé€šå¸¸åœ¨å¼€å‘ç¯å¢ƒä¸‹æ‰ä¼šç”Ÿæˆ Source Mapï¼Œå…¶å®ƒç¯å¢ƒä¸‹ä¸ç”¨ç”Ÿæˆï¼Œä»¥åŠ é€Ÿæ„å»ºã€‚ ä¸ºæ­¤ Webpack ä¸º Loader æä¾›äº† this.sourceMap API å»å‘Šè¯‰ Loader å½“å‰æ„å»ºç¯å¢ƒä¸‹ç”¨æˆ·æ˜¯å¦éœ€è¦ Source Mapã€‚ å¦‚æœä½ ç¼–å†™çš„ Loader ä¼šç”Ÿæˆ Source Mapï¼Œè¯·è€ƒè™‘åˆ°è¿™ç‚¹ã€‚</p></blockquote><h3 id="åŒæ­¥ä¸å¼‚æ­¥"><a href="#åŒæ­¥ä¸å¼‚æ­¥" class="headerlink" title="åŒæ­¥ä¸å¼‚æ­¥"></a>åŒæ­¥ä¸å¼‚æ­¥</h3><p>Loader æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¹‹åˆ†ï¼Œä¸Šé¢ä»‹ç»çš„ Loader éƒ½æ˜¯åŒæ­¥çš„ Loaderï¼Œå› ä¸ºå®ƒä»¬çš„è½¬æ¢æµç¨‹éƒ½æ˜¯åŒæ­¥çš„ï¼Œè½¬æ¢å®Œæˆåå†è¿”å›ç»“æœã€‚ ä½†åœ¨æœ‰äº›åœºæ™¯ä¸‹è½¬æ¢çš„æ­¥éª¤åªèƒ½æ˜¯å¼‚æ­¥å®Œæˆçš„ï¼Œä¾‹å¦‚ä½ éœ€è¦é€šè¿‡ç½‘ç»œè¯·æ±‚æ‰èƒ½å¾—å‡ºç»“æœï¼Œå¦‚æœé‡‡ç”¨åŒæ­¥çš„æ–¹å¼ç½‘ç»œè¯·æ±‚å°±ä¼šé˜»å¡æ•´ä¸ªæ„å»ºï¼Œå¯¼è‡´æ„å»ºéå¸¸ç¼“æ…¢ã€‚</p><p>åœ¨è½¬æ¢æ­¥éª¤æ˜¯å¼‚æ­¥æ—¶ï¼Œä½ å¯ä»¥è¿™æ ·ï¼š</p><pre><code class="js">module.exports = function(source) {    // å‘Šè¯‰ Webpack æœ¬æ¬¡è½¬æ¢æ˜¯å¼‚æ­¥çš„ï¼ŒLoader ä¼šåœ¨ callback ä¸­å›è°ƒç»“æœ    var callback = this.async();    someAsyncOperation(source, function(err, result, sourceMaps, ast) {        // é€šè¿‡ callback è¿”å›å¼‚æ­¥æ‰§è¡Œåçš„ç»“æœ        callback(err, result, sourceMaps, ast);    });};</code></pre><h3 id="å¤„ç†äºŒè¿›åˆ¶æ•°æ®"><a href="#å¤„ç†äºŒè¿›åˆ¶æ•°æ®" class="headerlink" title="å¤„ç†äºŒè¿›åˆ¶æ•°æ®"></a>å¤„ç†äºŒè¿›åˆ¶æ•°æ®</h3><p>åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼ŒWebpack ä¼ ç»™ Loader çš„åŸå†…å®¹éƒ½æ˜¯ <code>UTF-8</code> æ ¼å¼ç¼–ç çš„å­—ç¬¦ä¸²ã€‚ ä½†æœ‰äº›åœºæ™¯ä¸‹ Loader ä¸æ˜¯å¤„ç†æ–‡æœ¬æ–‡ä»¶ï¼Œè€Œæ˜¯å¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¾‹å¦‚ <code>file-loade</code>rï¼Œå°±éœ€è¦ Webpack ç»™ Loader ä¼ å…¥äºŒè¿›åˆ¶æ ¼å¼çš„æ•°æ®ã€‚ ä¸ºæ­¤ï¼Œä½ éœ€è¦è¿™æ ·ç¼–å†™ Loaderï¼š</p><pre><code class="js">module.exports = function(source) {    // åœ¨ exports.raw === true æ—¶ï¼ŒWebpack ä¼ ç»™ Loader çš„ source æ˜¯ Buffer ç±»å‹çš„    source instanceof Buffer === true;    // Loader è¿”å›çš„ç±»å‹ä¹Ÿå¯ä»¥æ˜¯ Buffer ç±»å‹çš„    // åœ¨ exports.raw !== true æ—¶ï¼ŒLoader ä¹Ÿå¯ä»¥è¿”å› Buffer ç±»å‹çš„ç»“æœ    return source;};// é€šè¿‡ exports.raw å±æ€§å‘Šè¯‰ Webpack è¯¥ Loader æ˜¯å¦éœ€è¦äºŒè¿›åˆ¶æ•°æ®module.exports.raw = true;</code></pre><h3 id="ç¼“å­˜åŠ é€Ÿ"><a href="#ç¼“å­˜åŠ é€Ÿ" class="headerlink" title="ç¼“å­˜åŠ é€Ÿ"></a>ç¼“å­˜åŠ é€Ÿ</h3><p>åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œæœ‰äº›è½¬æ¢æ“ä½œéœ€è¦å¤§é‡è®¡ç®—éå¸¸è€—æ—¶ï¼Œå¦‚æœæ¯æ¬¡æ„å»ºéƒ½é‡æ–°æ‰§è¡Œé‡å¤çš„è½¬æ¢æ“ä½œï¼Œæ„å»ºå°†ä¼šå˜å¾—éå¸¸ç¼“æ…¢ã€‚ ä¸ºæ­¤ï¼ŒWebpack ä¼šé»˜è®¤ç¼“å­˜æ‰€æœ‰ Loader çš„å¤„ç†ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨éœ€è¦è¢«å¤„ç†çš„æ–‡ä»¶æˆ–è€…å…¶ä¾èµ–çš„æ–‡ä»¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ æ˜¯ä¸ä¼šé‡æ–°è°ƒç”¨å¯¹åº”çš„ Loader å»æ‰§è¡Œè½¬æ¢æ“ä½œçš„ã€‚</p><p>å¦‚æœä½ æƒ³è®© Webpack ä¸ç¼“å­˜è¯¥ Loader çš„å¤„ç†ç»“æœï¼Œå¯ä»¥è¿™æ ·ï¼š</p><pre><code class="js">module.exports = function(source) {  // å…³é—­è¯¥ Loader çš„ç¼“å­˜åŠŸèƒ½  this.cacheable(false);  return source;};</code></pre><h2 id="å…¶å®ƒ-Loader-API"><a href="#å…¶å®ƒ-Loader-API" class="headerlink" title="å…¶å®ƒ Loader API"></a>å…¶å®ƒ Loader API</h2><p>é™¤äº†ä»¥ä¸Šæåˆ°çš„åœ¨ Loader ä¸­èƒ½è°ƒç”¨çš„ Webpack API å¤–ï¼Œè¿˜å­˜åœ¨ä»¥ä¸‹å¸¸ç”¨ APIï¼š</p><blockquote><ul><li>this.contextï¼šå½“å‰å¤„ç†æ–‡ä»¶çš„æ‰€åœ¨ç›®å½•ï¼Œå‡å¦‚å½“å‰ Loader å¤„ç†çš„æ–‡ä»¶æ˜¯ /src/main.jsï¼Œåˆ™ this.context å°±ç­‰äº /srcã€‚</li><li>this.resourceï¼šå½“å‰å¤„ç†æ–‡ä»¶çš„å®Œæ•´è¯·æ±‚è·¯å¾„ï¼ŒåŒ…æ‹¬ querystringï¼Œä¾‹å¦‚ /src/main.js?name=1ã€‚</li><li>this.resourcePathï¼šå½“å‰å¤„ç†æ–‡ä»¶çš„è·¯å¾„ï¼Œä¾‹å¦‚ /src/main.jsã€‚</li><li>this.resourceQueryï¼šå½“å‰å¤„ç†æ–‡ä»¶çš„ querystringã€‚</li><li>this.targetï¼šç­‰äº Webpack é…ç½®ä¸­çš„ Targetï¼Œè¯¦æƒ…è§ 2-7å…¶å®ƒé…ç½®é¡¹-Targetã€‚</li><li>this.loadModuleï¼šå½“ Loader åœ¨å¤„ç†ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå¦‚æœä¾èµ–å…¶å®ƒæ–‡ä»¶çš„å¤„ç†ç»“æœæ‰èƒ½å¾—å‡ºå½“å‰æ–‡ä»¶çš„ç»“æœæ—¶ï¼Œ å°±å¯ä»¥é€šè¿‡ this.loadModule(request: string, callback: function(err, source, sourceMap, module)) å»è·å¾— request å¯¹åº”æ–‡ä»¶çš„å¤„ç†ç»“æœã€‚</li><li>this.resolveï¼šåƒ require è¯­å¥ä¸€æ ·è·å¾—æŒ‡å®šæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œä½¿ç”¨æ–¹æ³•ä¸º resolve(context: string, &gt; * request: string, callback: function(err, result: string))ã€‚</li><li>this.addDependencyï¼šç»™å½“å‰å¤„ç†æ–‡ä»¶æ·»åŠ å…¶ä¾èµ–çš„æ–‡ä»¶ï¼Œä»¥ä¾¿å†å…¶ä¾èµ–çš„æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé‡æ–°è°ƒç”¨ Loader å¤„ç†è¯¥æ–‡ä»¶ã€‚ä½¿ç”¨æ–¹æ³•ä¸º addDependency(file: string)ã€‚</li><li>this.addContextDependencyï¼šå’Œ addDependency ç±»ä¼¼ï¼Œä½† addContextDependency æ˜¯æŠŠæ•´ä¸ªç›®å½•åŠ å…¥åˆ°å½“å‰æ­£åœ¨å¤„ç†æ–‡ä»¶çš„ä¾èµ–ä¸­ã€‚ä½¿ç”¨æ–¹æ³•ä¸º addContextDependency(directory: string)ã€‚</li><li>this.clearDependenciesï¼šæ¸…é™¤å½“å‰æ­£åœ¨å¤„ç†æ–‡ä»¶çš„æ‰€æœ‰ä¾èµ–ï¼Œä½¿ç”¨æ–¹æ³•ä¸º clearDependencies()ã€‚</li><li>this.emitFileï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨æ–¹æ³•ä¸º emitFile(name: string, content: Buffer|string, sourceMap: {â€¦})ã€‚</li></ul></blockquote><h2 id="åŠ è½½æœ¬åœ°-Loader"><a href="#åŠ è½½æœ¬åœ°-Loader" class="headerlink" title="åŠ è½½æœ¬åœ° Loader"></a>åŠ è½½æœ¬åœ° Loader</h2><p>åœ¨å¼€å‘ Loader çš„è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†æµ‹è¯•ç¼–å†™çš„ Loader æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œï¼Œéœ€è¦æŠŠå®ƒé…ç½®åˆ° Webpack ä¸­åï¼Œæ‰å¯èƒ½ä¼šè°ƒç”¨è¯¥ Loaderã€‚ åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œä½¿ç”¨çš„ Loader éƒ½æ˜¯é€šè¿‡ Npm å®‰è£…çš„ï¼Œè¦ä½¿ç”¨ Loader æ—¶ä¼šç›´æ¥ä½¿ç”¨ Loader çš„åç§°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">module.exports = {  module: {    rules: [      {        test: /\.css/,        use: [&#39;style-loader&#39;],      },    ]  },};</code></pre><p>å¦‚æœè¿˜é‡‡å–ä»¥ä¸Šçš„æ–¹æ³•å»ä½¿ç”¨æœ¬åœ°å¼€å‘çš„ Loader å°†ä¼šå¾ˆéº»çƒ¦ï¼Œå› ä¸ºä½ éœ€è¦ç¡®ä¿ç¼–å†™çš„ Loader çš„æºç æ˜¯åœ¨ <code>node_modules</code> ç›®å½•ä¸‹ã€‚ ä¸ºæ­¤ä½ éœ€è¦å…ˆæŠŠç¼–å†™çš„ Loader å‘å¸ƒåˆ° Npm ä»“åº“åå†å®‰è£…åˆ°æœ¬åœ°é¡¹ç›®ä½¿ç”¨ã€‚</p><h3 id="Npm-link"><a href="#Npm-link" class="headerlink" title="Npm link"></a>Npm link</h3><p>Npm link ä¸“é—¨ç”¨äºå¼€å‘å’Œè°ƒè¯•æœ¬åœ° Npm æ¨¡å—ï¼Œèƒ½åšåˆ°åœ¨ä¸å‘å¸ƒæ¨¡å—çš„æƒ…å†µä¸‹ï¼ŒæŠŠæœ¬åœ°çš„ä¸€ä¸ªæ­£åœ¨å¼€å‘çš„æ¨¡å—çš„æºç é“¾æ¥åˆ°é¡¹ç›®çš„ node_modules ç›®å½•ä¸‹ï¼Œè®©é¡¹ç›®å¯ä»¥ç›´æ¥ä½¿ç”¨æœ¬åœ°çš„ Npm æ¨¡å—ã€‚ ç”±äºæ˜¯é€šè¿‡è½¯é“¾æ¥çš„æ–¹å¼å®ç°çš„ï¼Œç¼–è¾‘äº†æœ¬åœ°çš„ Npm æ¨¡å—ä»£ç ï¼Œåœ¨é¡¹ç›®ä¸­ä¹Ÿèƒ½ä½¿ç”¨åˆ°ç¼–è¾‘åçš„ä»£ç ã€‚</p><blockquote><p>å®Œæˆ Npm link çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p></blockquote><p>ç¡®ä¿æ­£åœ¨å¼€å‘çš„æœ¬åœ° Npm æ¨¡å—ï¼ˆä¹Ÿå°±æ˜¯æ­£åœ¨å¼€å‘çš„ Loaderï¼‰çš„ package.json å·²ç»æ­£ç¡®é…ç½®å¥½ï¼›<br>åœ¨æœ¬åœ° Npm æ¨¡å—æ ¹ç›®å½•ä¸‹æ‰§è¡Œ npm linkï¼ŒæŠŠæœ¬åœ°æ¨¡å—æ³¨å†Œåˆ°å…¨å±€ï¼›<br>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ npm link loader-nameï¼ŒæŠŠç¬¬2æ­¥æ³¨å†Œåˆ°å…¨å±€çš„æœ¬åœ° Npm æ¨¡å—é“¾æ¥åˆ°é¡¹ç›®çš„ node_moduels ä¸‹ï¼Œå…¶ä¸­çš„ loader-name æ˜¯æŒ‡åœ¨ç¬¬1æ­¥ä¸­çš„ package.json æ–‡ä»¶ä¸­é…ç½®çš„æ¨¡å—åç§°ã€‚<br>é“¾æ¥å¥½ Loader åˆ°é¡¹ç›®åä½ å°±å¯ä»¥åƒä½¿ç”¨ä¸€ä¸ªçœŸæ­£çš„ Npm æ¨¡å—ä¸€æ ·ä½¿ç”¨æœ¬åœ°çš„ Loader äº†ã€‚</p><h3 id="ResolveLoader"><a href="#ResolveLoader" class="headerlink" title="ResolveLoader"></a>ResolveLoader</h3><p>æ›¾ä»‹ç»è¿‡ <code>ResolveLoader</code> ç”¨äºé…ç½® Webpack å¦‚ä½•å¯»æ‰¾ Loaderã€‚ é»˜è®¤æƒ…å†µä¸‹åªä¼šå» <code>node_modules</code> ç›®å½•ä¸‹å¯»æ‰¾ï¼Œä¸ºäº†è®© Webpack åŠ è½½æ”¾åœ¨æœ¬åœ°é¡¹ç›®ä¸­çš„ Loader éœ€è¦ä¿®æ”¹ <code>resolveLoader.modules</code>ã€‚</p><p>å‡å¦‚æœ¬åœ°çš„ Loader åœ¨é¡¹ç›®ç›®å½•ä¸­çš„ <code>./loaders/loader-name</code> ä¸­ï¼Œåˆ™éœ€è¦å¦‚ä¸‹é…ç½®ï¼š</p><pre><code class="js">module.exports = {  resolveLoader:{    // å»å“ªäº›ç›®å½•ä¸‹å¯»æ‰¾ Loaderï¼Œæœ‰å…ˆåé¡ºåºä¹‹åˆ†    modules: [&#39;node_modules&#39;,&#39;./loaders/&#39;],  }}</code></pre><p>åŠ ä¸Šä»¥ä¸Šé…ç½®åï¼Œ Webpack ä¼šå…ˆå» <code>node_modules</code> é¡¹ç›®ä¸‹å¯»æ‰¾ Loaderï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œä¼šå†å» <code>./loaders/</code> ç›®å½•ä¸‹å¯»æ‰¾ã€‚</p><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>ä¸Šé¢è®²äº†è®¸å¤šç†è®ºï¼Œæ¥ä¸‹æ¥ä»å®é™…å‡ºå‘ï¼Œæ¥ç¼–å†™ä¸€ä¸ªè§£å†³å®é™…é—®é¢˜çš„ Loaderã€‚</p><p>è¯¥ Loader åå«<code>comment-require-loader</code>ï¼Œä½œç”¨æ˜¯æŠŠ JavaScript ä»£ç ä¸­çš„æ³¨é‡Šè¯­æ³•</p><p><code>// @require &#39;../style/index.css&#39;</code></p><p>è½¬æ¢æˆ</p><p><code>require(&#39;../style/index.css&#39;);</code></p><p>è¯¥ Loader çš„ä½¿ç”¨åœºæ™¯æ˜¯å»æ­£ç¡®åŠ è½½é’ˆå¯¹ <code>Fis3</code>ç¼–å†™çš„ JavaScriptï¼Œè¿™äº› JavaScript ä¸­å­˜åœ¨é€šè¿‡æ³¨é‡Šçš„æ–¹å¼åŠ è½½ä¾èµ–çš„ CSS æ–‡ä»¶ã€‚</p><p>è¯¥ Loader çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code class="js">module.exports = {  module: {    rules: [      {        test: /\.js$/,        use: [&#39;comment-require-loader&#39;],        // é’ˆå¯¹é‡‡ç”¨äº† fis3 CSS å¯¼å…¥è¯­æ³•çš„ JavaScript æ–‡ä»¶é€šè¿‡ comment-require-loader å»è½¬æ¢        include: [path.resolve(__dirname, &#39;node_modules/imui&#39;)]      }    ]  }};</code></pre><p>è¯¥ Loader çš„å®ç°éå¸¸ç®€å•ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">function replace(source) {    // ä½¿ç”¨æ­£åˆ™æŠŠ // @require &#39;../style/index.css&#39; è½¬æ¢æˆ require(&#39;../style/index.css&#39;);      return source.replace(/(\/\/ *@require) +((&#39;|&quot;).+(&#39;|&quot;)).*/, &#39;require($2);&#39;);}module.exports = function (content) {    return replace(content);};</code></pre>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpackåŸç†åŠå®ç°</title>
      <link href="/2018/08/03/%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/webpack%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E7%8E%B0/"/>
      <url>/2018/08/03/%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/webpack%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="å·¥ä½œåŸç†æ¦‚æ‹¬"><a href="#å·¥ä½œåŸç†æ¦‚æ‹¬" class="headerlink" title="å·¥ä½œåŸç†æ¦‚æ‹¬"></a>å·¥ä½œåŸç†æ¦‚æ‹¬</h1><p>Webpack ä»¥å…¶ä½¿ç”¨ç®€å•è‘—ç§°ï¼Œåœ¨ä½¿ç”¨å®ƒçš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨è€…åªéœ€æŠŠå®ƒå½“ä½œä¸€ä¸ªé»‘ç›’ï¼Œéœ€è¦å…³å¿ƒçš„åªæœ‰å®ƒæš´éœ²å‡ºæ¥çš„é…ç½®ã€‚ æœ¬èŠ‚å°†å¸¦ä½ èµ°è¿›è¿™ä¸ªé»‘ç›’ï¼Œçœ‹çœ‹ Webpack æ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚</p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><blockquote><p>åœ¨äº†è§£ Webpack åŸç†å‰ï¼Œéœ€è¦æŒæ¡ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œä»¥æ–¹ä¾¿åé¢çš„ç†è§£ï¼š</p></blockquote><ul><li>entry: å…¥å£ï¼ŒWebpack æ‰§è¡Œæ„å»ºçš„ç¬¬ä¸€æ­¥å°†ä» Entry å¼€å§‹ï¼Œå¯æŠ½è±¡æˆè¾“å…¥ã€‚</li><li>module: æ¨¡å—ï¼Œåœ¨ Webpack é‡Œä¸€åˆ‡çš†æ¨¡å—ï¼Œä¸€ä¸ªæ¨¡å—å¯¹åº”ç€ä¸€ä¸ªæ–‡ä»¶ã€‚Webpack ä¼šä»é…ç½®çš„ Entry å¼€å§‹é€’å½’æ‰¾å‡ºæ‰€æœ‰ä¾èµ–çš„æ¨¡å—ã€‚</li><li>chunk: ä»£ç å—ï¼Œä¸€ä¸ª Chunk ç”±å¤šä¸ªæ¨¡å—ç»„åˆè€Œæˆï¼Œç”¨äºä»£ç åˆå¹¶ä¸åˆ†å‰²ã€‚</li><li>loader: æ¨¡å—è½¬æ¢å™¨ï¼Œç”¨äºæŠŠæ¨¡å—åŸå†…å®¹æŒ‰ç…§éœ€æ±‚è½¬æ¢æˆæ–°å†…å®¹ã€‚</li><li>plugins: æ‰©å±•æ’ä»¶ï¼Œåœ¨ Webpack æ„å»ºæµç¨‹ä¸­çš„ç‰¹å®šæ—¶æœºä¼šå¹¿æ’­å‡ºå¯¹åº”çš„äº‹ä»¶ï¼Œæ’ä»¶å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶çš„å‘ç”Ÿï¼Œåœ¨ç‰¹å®šæ—¶æœºåšå¯¹åº”çš„äº‹æƒ…ã€‚</li></ul><h2 id="æµç¨‹æ¦‚æ‹¬"><a href="#æµç¨‹æ¦‚æ‹¬" class="headerlink" title="æµç¨‹æ¦‚æ‹¬"></a>æµç¨‹æ¦‚æ‹¬</h2><blockquote><p>Webpack çš„è¿è¡Œæµç¨‹æ˜¯ä¸€ä¸ªä¸²è¡Œçš„è¿‡ç¨‹ï¼Œä»å¯åŠ¨åˆ°ç»“æŸä¼šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š</p></blockquote><p>1.åˆå§‹åŒ–å‚æ•°ï¼šä»é…ç½®æ–‡ä»¶å’Œ Shell è¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°ï¼›<br>2.å¼€å§‹ç¼–è¯‘ï¼šç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å¯¹è±¡ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶ï¼Œæ‰§è¡Œå¯¹è±¡çš„ run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘ï¼›<br>3.ç¡®å®šå…¥å£ï¼šæ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰çš„å…¥å£æ–‡ä»¶ï¼›<br>4.ç¼–è¯‘æ¨¡å—ï¼šä»å…¥å£æ–‡ä»¶å‡ºå‘ï¼Œè°ƒç”¨æ‰€æœ‰é…ç½®çš„ Loader å¯¹æ¨¡å—è¿›è¡Œç¿»è¯‘ï¼Œå†æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç†ï¼›<br>5.å®Œæˆæ¨¡å—ç¼–è¯‘ï¼šåœ¨ç»è¿‡ç¬¬4æ­¥ä½¿ç”¨ Loader ç¿»è¯‘å®Œæ‰€æœ‰æ¨¡å—åï¼Œå¾—åˆ°äº†æ¯ä¸ªæ¨¡å—è¢«ç¿»è¯‘åçš„æœ€ç»ˆå†…å®¹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼›<br><a id="more"></a><br>6.è¾“å‡ºèµ„æºï¼šæ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„ Chunkï¼Œå†æŠŠæ¯ä¸ª Chunk è½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åæœºä¼šï¼›<br>7.è¾“å‡ºå®Œæˆï¼šåœ¨ç¡®å®šå¥½è¾“å‡ºå†…å®¹åï¼Œæ ¹æ®é…ç½®ç¡®å®šè¾“å‡ºçš„è·¯å¾„å’Œæ–‡ä»¶åï¼ŒæŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>åœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­ï¼ŒWebpack ä¼šåœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹å¹¿æ’­å‡ºç‰¹å®šçš„äº‹ä»¶ï¼Œæ’ä»¶åœ¨ç›‘å¬åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶åä¼šæ‰§è¡Œç‰¹å®šçš„é€»è¾‘ï¼Œå¹¶ä¸”æ’ä»¶å¯ä»¥è°ƒç”¨ Webpack æä¾›çš„ API æ”¹å˜ Webpack çš„è¿è¡Œç»“æœ</p><h2 id="æµç¨‹ç»†èŠ‚"><a href="#æµç¨‹ç»†èŠ‚" class="headerlink" title="æµç¨‹ç»†èŠ‚"></a>æµç¨‹ç»†èŠ‚</h2><blockquote><p>Webpack çš„æ„å»ºæµç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰å¤§é˜¶æ®µï¼š</p></blockquote><p>1.åˆå§‹åŒ–ï¼šå¯åŠ¨æ„å»ºï¼Œè¯»å–ä¸åˆå¹¶é…ç½®å‚æ•°ï¼ŒåŠ è½½ Pluginï¼Œå®ä¾‹åŒ– Compilerã€‚<br>2.ç¼–è¯‘ï¼šä» Entry å‘å‡ºï¼Œé’ˆå¯¹æ¯ä¸ª Module ä¸²è¡Œè°ƒç”¨å¯¹åº”çš„ Loader å»ç¿»è¯‘æ–‡ä»¶å†…å®¹ï¼Œå†æ‰¾åˆ°è¯¥ Module ä¾èµ–çš„ Moduleï¼Œé€’å½’åœ°è¿›è¡Œç¼–è¯‘å¤„ç†ã€‚<br>3.è¾“å‡ºï¼šå¯¹ç¼–è¯‘åçš„ Module ç»„åˆæˆ Chunkï¼ŒæŠŠ Chunk è½¬æ¢æˆæ–‡ä»¶ï¼Œè¾“å‡ºåˆ°æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>å¦‚æœåªæ‰§è¡Œä¸€æ¬¡æ„å»ºï¼Œä»¥ä¸Šé˜¶æ®µå°†ä¼šæŒ‰ç…§é¡ºåºå„æ‰§è¡Œä¸€æ¬¡ã€‚ä½†åœ¨å¼€å¯ç›‘å¬æ¨¡å¼ä¸‹ï¼Œæµç¨‹å°†å˜ä¸ºå¦‚ä¸‹ï¼š</p><p><img src="http://webpack.wuhaolin.cn/5%E5%8E%9F%E7%90%86/img/5-1%E7%9B%91%E5%90%AC%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B.png" alt="æµç¨‹"></p><p>åœ¨æ¯ä¸ªå¤§é˜¶æ®µä¸­åˆä¼šå‘ç”Ÿå¾ˆå¤šäº‹ä»¶ï¼ŒWebpack ä¼šæŠŠè¿™äº›äº‹ä»¶å¹¿æ’­å‡ºæ¥ä¾›ç»™ Plugin ä½¿ç”¨ï¼Œä¸‹é¢æ¥ä¸€ä¸€ä»‹ç»ã€‚</p><h3 id="åˆå§‹åŒ–é˜¶æ®µ"><a href="#åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="åˆå§‹åŒ–é˜¶æ®µ"></a>åˆå§‹åŒ–é˜¶æ®µ</h3><table><thead><tr><th>äº‹ä»¶å</th><th style="text-align:right">è§£é‡Š</th></tr></thead><tbody><tr><td>åˆå§‹åŒ–å‚æ•°</td><td style="text-align:right">ä»é…ç½®æ–‡ä»¶å’Œ Shell è¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°ã€‚ è¿™ä¸ªè¿‡ç¨‹ä¸­è¿˜ä¼šæ‰§è¡Œé…ç½®æ–‡ä»¶ä¸­çš„æ’ä»¶å®ä¾‹åŒ–è¯­å¥ new Plugin()ã€‚</td></tr><tr><td>å®ä¾‹åŒ–</td><td style="text-align:right">Compilerç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å®ä¾‹ï¼ŒCompiler è´Ÿè´£æ–‡ä»¶ç›‘å¬å’Œå¯åŠ¨ç¼–è¯‘ã€‚Compiler å®ä¾‹ä¸­åŒ…å«äº†å®Œæ•´çš„ Webpack é…ç½®ï¼Œå…¨å±€åªæœ‰ä¸€ä¸ª Compiler å®ä¾‹ã€‚</td></tr><tr><td>åŠ è½½æ’ä»¶</td><td style="text-align:right">ä¾æ¬¡è°ƒç”¨æ’ä»¶çš„ apply æ–¹æ³•ï¼Œè®©æ’ä»¶å¯ä»¥ç›‘å¬åç»­çš„æ‰€æœ‰äº‹ä»¶èŠ‚ç‚¹ã€‚åŒæ—¶ç»™æ’ä»¶ä¼ å…¥ compiler å®ä¾‹çš„å¼•ç”¨ï¼Œä»¥æ–¹ä¾¿æ’ä»¶é€šè¿‡ compiler è°ƒç”¨ Webpack æä¾›çš„ APIã€‚</td></tr><tr><td>environment</td><td style="text-align:right">å¼€å§‹åº”ç”¨ Node.js é£æ ¼çš„æ–‡ä»¶ç³»ç»Ÿåˆ° compiler å¯¹è±¡ï¼Œä»¥æ–¹ä¾¿åç»­çš„æ–‡ä»¶å¯»æ‰¾å’Œè¯»å–ã€‚</td></tr><tr><td>entry-option</td><td style="text-align:right">è¯»å–é…ç½®çš„ Entrysï¼Œä¸ºæ¯ä¸ª Entry å®ä¾‹åŒ–ä¸€ä¸ªå¯¹åº”çš„ EntryPluginï¼Œä¸ºåé¢è¯¥ Entry çš„é€’å½’è§£æå·¥ä½œåšå‡†å¤‡ã€‚</td></tr><tr><td>after-plugins</td><td style="text-align:right">è°ƒç”¨å®Œæ‰€æœ‰å†…ç½®çš„å’Œé…ç½®çš„æ’ä»¶çš„ apply æ–¹æ³•ã€‚</td></tr><tr><td>after-resolvers</td><td style="text-align:right">æ ¹æ®é…ç½®åˆå§‹åŒ–å®Œ resolverï¼Œresolver è´Ÿè´£åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­å¯»æ‰¾æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ã€‚</td></tr></tbody></table><h2 id="ç¼–è¯‘é˜¶æ®µ"><a href="#ç¼–è¯‘é˜¶æ®µ" class="headerlink" title="ç¼–è¯‘é˜¶æ®µ"></a>ç¼–è¯‘é˜¶æ®µ</h2><table><thead><tr><th>äº‹ä»¶å</th><th style="text-align:right">è§£é‡Š</th></tr></thead><tbody><tr><td>run</td><td style="text-align:right">å¯åŠ¨ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚</td></tr><tr><td>watch-run</td><td style="text-align:right">å’Œ run ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºå®ƒæ˜¯åœ¨ç›‘å¬æ¨¡å¼ä¸‹å¯åŠ¨çš„ç¼–è¯‘ï¼Œåœ¨è¿™ä¸ªäº‹ä»¶ä¸­å¯ä»¥è·å–åˆ°æ˜¯å“ªäº›æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–å¯¼è‡´é‡æ–°å¯åŠ¨ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚</td></tr><tr><td>compile</td><td style="text-align:right">è¯¥äº‹ä»¶æ˜¯ä¸ºäº†å‘Šè¯‰æ’ä»¶ä¸€æ¬¡æ–°çš„ç¼–è¯‘å°†è¦å¯åŠ¨ï¼ŒåŒæ—¶ä¼šç»™æ’ä»¶å¸¦ä¸Š compiler å¯¹è±¡ã€‚</td></tr><tr><td>compilation</td><td style="text-align:right">å½“ Webpack ä»¥å¼€å‘æ¨¡å¼è¿è¡Œæ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°æ–‡ä»¶å˜åŒ–ï¼Œä¸€æ¬¡æ–°çš„ Compilation å°†è¢«åˆ›å»ºã€‚ä¸€ä¸ª Compilation å¯¹è±¡åŒ…å«äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ç­‰ã€‚Compilation å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šäº‹ä»¶å›è°ƒä¾›æ’ä»¶åšæ‰©å±•ã€‚</td></tr><tr><td>make</td><td style="text-align:right">ä¸€ä¸ªæ–°çš„ Compilation åˆ›å»ºå®Œæ¯•ï¼Œå³å°†ä» Entry å¼€å§‹è¯»å–æ–‡ä»¶ï¼Œæ ¹æ®æ–‡ä»¶ç±»å‹å’Œé…ç½®çš„ Loader å¯¹æ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘å®Œåå†æ‰¾å‡ºè¯¥æ–‡ä»¶ä¾èµ–çš„æ–‡ä»¶ï¼Œé€’å½’çš„ç¼–è¯‘å’Œè§£æã€‚</td></tr><tr><td>after-compile</td><td style="text-align:right">ä¸€æ¬¡ Compilation æ‰§è¡Œå®Œæˆã€‚</td></tr><tr><td>invalid</td><td style="text-align:right">å½“é‡åˆ°æ–‡ä»¶ä¸å­˜åœ¨ã€æ–‡ä»¶ç¼–è¯‘é”™è¯¯ç­‰å¼‚å¸¸æ—¶ä¼šè§¦å‘è¯¥äº‹ä»¶ï¼Œè¯¥äº‹ä»¶ä¸ä¼šå¯¼è‡´ Webpack é€€å‡ºã€‚</td></tr></tbody></table><p>åœ¨ç¼–è¯‘é˜¶æ®µä¸­ï¼Œæœ€é‡è¦çš„è¦æ•° compilation äº‹ä»¶äº†ï¼Œå› ä¸ºåœ¨ compilation é˜¶æ®µè°ƒç”¨äº† Loader å®Œæˆäº†æ¯ä¸ªæ¨¡å—çš„è½¬æ¢æ“ä½œï¼Œåœ¨ compilation é˜¶æ®µåˆåŒ…æ‹¬å¾ˆå¤šå°çš„äº‹ä»¶ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p><table><thead><tr><th>äº‹ä»¶å</th><th style="text-align:right">è§£é‡Š</th></tr></thead><tbody><tr><td>build-module</td><td style="text-align:right">ä½¿ç”¨å¯¹åº”çš„ Loader å»è½¬æ¢ä¸€ä¸ªæ¨¡å—ã€‚</td></tr><tr><td>normal-module-loader</td><td style="text-align:right">åœ¨ç”¨ Loader å¯¹ä¸€ä¸ªæ¨¡å—è½¬æ¢å®Œåï¼Œä½¿ç”¨ acorn è§£æè½¬æ¢åçš„å†…å®¹ï¼Œè¾“å‡ºå¯¹åº”çš„æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œä»¥æ–¹ä¾¿ Webpack åé¢å¯¹ä»£ç çš„åˆ†æã€‚</td></tr><tr><td>program</td><td style="text-align:right">ä»é…ç½®çš„å…¥å£æ¨¡å—å¼€å§‹ï¼Œåˆ†æå…¶ ASTï¼Œå½“é‡åˆ° require ç­‰å¯¼å…¥å…¶å®ƒæ¨¡å—è¯­å¥æ—¶ï¼Œä¾¿å°†å…¶åŠ å…¥åˆ°ä¾èµ–çš„æ¨¡å—åˆ—è¡¨ï¼ŒåŒæ—¶å¯¹æ–°æ‰¾å‡ºçš„ä¾èµ–æ¨¡å—é€’å½’åˆ†æï¼Œæœ€ç»ˆææ¸…æ‰€æœ‰æ¨¡å—çš„ä¾èµ–å…³ç³»ã€‚</td></tr><tr><td>seal</td><td style="text-align:right">æ‰€æœ‰æ¨¡å—åŠå…¶ä¾èµ–çš„æ¨¡å—éƒ½é€šè¿‡ Loader è½¬æ¢å®Œæˆåï¼Œæ ¹æ®ä¾èµ–å…³ç³»å¼€å§‹ç”Ÿæˆ Chunkã€‚</td></tr></tbody></table><h3 id="è¾“å‡ºé˜¶æ®µ"><a href="#è¾“å‡ºé˜¶æ®µ" class="headerlink" title="è¾“å‡ºé˜¶æ®µ"></a>è¾“å‡ºé˜¶æ®µ</h3><table><thead><tr><th>äº‹ä»¶å</th><th style="text-align:right">è§£é‡Š</th></tr></thead><tbody><tr><td>should-emit</td><td style="text-align:right">æ‰€æœ‰éœ€è¦è¾“å‡ºçš„æ–‡ä»¶å·²ç»ç”Ÿæˆå¥½ï¼Œè¯¢é—®æ’ä»¶å“ªäº›æ–‡ä»¶éœ€è¦è¾“å‡ºï¼Œå“ªäº›ä¸éœ€è¦ã€‚</td></tr><tr><td>emit</td><td style="text-align:right">ç¡®å®šå¥½è¦è¾“å‡ºå“ªäº›æ–‡ä»¶åï¼Œæ‰§è¡Œæ–‡ä»¶è¾“å‡ºï¼Œå¯ä»¥åœ¨è¿™é‡Œè·å–å’Œä¿®æ”¹è¾“å‡ºå†…å®¹ã€‚</td></tr><tr><td>after-emit</td><td style="text-align:right">æ–‡ä»¶è¾“å‡ºå®Œæ¯•ã€‚</td></tr><tr><td>done</td><td style="text-align:right">æˆåŠŸå®Œæˆä¸€æ¬¡å®Œæˆçš„ç¼–è¯‘å’Œè¾“å‡ºæµç¨‹ã€‚</td></tr><tr><td>failed</td><td style="text-align:right">å¦‚æœåœ¨ç¼–è¯‘å’Œè¾“å‡ºæµç¨‹ä¸­é‡åˆ°å¼‚å¸¸å¯¼è‡´ Webpack é€€å‡ºæ—¶ï¼Œå°±ä¼šç›´æ¥è·³è½¬åˆ°æœ¬æ­¥éª¤ï¼Œæ’ä»¶å¯ä»¥åœ¨æœ¬äº‹ä»¶ä¸­è·å–åˆ°å…·ä½“çš„é”™è¯¯åŸå› ã€‚</td></tr></tbody></table><p>åœ¨è¾“å‡ºé˜¶æ®µå·²ç»å¾—åˆ°äº†å„ä¸ªæ¨¡å—ç»è¿‡è½¬æ¢åçš„ç»“æœå’Œå…¶ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”æŠŠç›¸å…³æ¨¡å—ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªä¸ª Chunkã€‚ åœ¨è¾“å‡ºé˜¶æ®µä¼šæ ¹æ® Chunk çš„ç±»å‹ï¼Œä½¿ç”¨å¯¹åº”çš„æ¨¡ç‰ˆç”Ÿæˆæœ€ç»ˆè¦è¦è¾“å‡ºçš„æ–‡ä»¶å†…å®¹ã€‚</p><p><a href="http://webpack.wuhaolin.cn/5%E5%8E%9F%E7%90%86/5-2%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> åŸç†åŠå®ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ Intersection Observer å®ç°å›¾ç‰‡å»¶è¿ŸåŠ è½½</title>
      <link href="/2018/08/01/HTTP/%E4%BD%BF%E7%94%A8-Intersection-Observer-%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD/"/>
      <url>/2018/08/01/HTTP/%E4%BD%BF%E7%94%A8-Intersection-Observer-%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<p><img src="https://img.c7sky.com/2017/08/17/lazy-loading-images-using-intersection-observer-banner.png" alt="img"></p><h1 id="å»¶è¿ŸåŠ è½½æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Ÿ"><a href="#å»¶è¿ŸåŠ è½½æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Ÿ" class="headerlink" title="å»¶è¿ŸåŠ è½½æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Ÿ"></a>å»¶è¿ŸåŠ è½½æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Ÿ</h1><p>å»¶è¿ŸåŠ è½½å›¾ç‰‡çš„ç›®çš„åœ¨äºï¼Œåœ¨å‘å‡ºå¯¹åº”çš„ç½‘ç»œè¯·æ±‚ä¹‹å‰ä½ è¦ä¸€ç›´ç­‰åˆ°ç”¨æˆ·æ»šåŠ¨é¡µé¢è®©å›¾ç‰‡è¿›å…¥å¯è§åŒºåŸŸã€‚å¦‚æœä½ çš„ç½‘é¡µåŒ…æ‹¬äº†å¤šå¼ å›¾ç‰‡ï¼Œä½†ä½ åªåœ¨æ¯å¼ å›¾ç‰‡æ»šåŠ¨åˆ°è§†åŒºæ—¶æ‰åŠ è½½ï¼Œä½ å°†æœ€ç»ˆä¼šèŠ‚çœå¸¦å®½å¹¶ç¡®ä¿ä½ çš„ç½‘é¡µåŠ è½½çš„æ›´å¿«ã€‚</p><p>ä¸ºäº†è®©ä½ åœ¨å®é™…ä¸­äº†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬æƒ³è±¡ä¸‹é¢è¿™ä¸ªé¡µé¢ï¼Œä»–æœ‰ä¸‰å¼ å›¾ç‰‡ã€‚</p><p><img src="https://307a6ed092846b809be7-9cfa4cf7c673a59966ad8296f4c88804.ssl.cf3.rackcdn.com/intersection-observer/intersection-observer.png" alt="lazyimg"></p><p>å¦‚æœç”¨æˆ·è®¿é—®é¡µé¢æ—¶ä»…çœ‹åˆ°äº†ç¬¬ä¸€å¼ å›¾ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³åŠ è½½ç½‘é¡µåº•éƒ¨çš„æ¯”è¨å›¾ç‰‡ï¼Œé™¤éç”¨æˆ·å‘ä¸‹æ»šåŠ¨ç›´åˆ°å›¾ç‰‡çœŸæ­£è¿›å…¥è§†åŒºã€‚å¦‚æœæˆ‘ä»¬å»¶è¿ŸåŠ è½½å›¾ç‰‡ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·åªåœ¨ä»–ä»¬éœ€è¦æ—¶ä¸‹è½½ä»–ä»¬éœ€è¦çš„ä¸œè¥¿ï¼Œè¿™è®©ä½ çš„ç½‘é¡µæ›´åŠ ç²¾ç®€ã€‚</p><p>å¯¹äºæ›´æœ‰ç»éªŒçš„å¼€å‘è€…ï¼Œä½ ä¹Ÿè®¸å¾ˆç†Ÿæ‚‰å»¶è¿ŸåŠ è½½å›¾ç‰‡ï¼Œæ¯•ç«Ÿè¿™ä¸ªæ¦‚å¿µå·²ç»æœ‰äº†ä¸€æ®µæ—¶é—´ã€‚é‚£ä¹ˆæœ‰ä»€ä¹ˆæ–°ä¸œè¥¿å‘¢ï¼Ÿï¼ç°åœ¨æœ‰å¾ˆå¤šå»¶è¿ŸåŠ è½½åº“å¯ä»¥å®Œæˆè¿™é¡¹å·¥ä½œ.</p><p>é—®é¢˜åœ¨äºï¼Œå‡ ä¹æ‰€æœ‰è¿™äº›åº“éƒ½æ˜¯åˆ©ç”¨æ»šåŠ¨äº‹ä»¶æˆ–è€…ä½¿ç”¨å®šæ—¶å™¨æ¥æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨è§†åŒºå†…ã€‚è¿™ä¸ªæ–¹æ³•çš„é—®é¢˜æ˜¯å®ƒå¼ºåˆ¶æµè§ˆå™¨é‡æ–°å¸ƒå±€æ•´ä¸ªé¡µé¢ï¼Œè€Œä¸”åœ¨ç‰¹å®šæ¡ä»¶ä¸‹ä¼šå¯¼è‡´ä½ çš„ç½‘ç«™å¡é¡¿ï¼ˆjankï¼‰ã€‚æˆ‘ä»¬å¯ä»¥åšçš„æ›´å¥½ï¼<br><a id="more"></a></p><h2 id="æ•‘æ˜Ÿ-Intersection-Observerï¼"><a href="#æ•‘æ˜Ÿ-Intersection-Observerï¼" class="headerlink" title="æ•‘æ˜Ÿ Intersection Observerï¼"></a>æ•‘æ˜Ÿ Intersection Observerï¼</h2><p>è¿™å°±æ˜¯ <code>Intersection Observer</code> çš„ç”¨æ­¦ä¹‹åœ°ã€‚Intersection Observer å†…ç½®äºå¤§å¤šæ•°ç°ä»£æµè§ˆå™¨ï¼Œå¯ä»¥è®©ä½ çŸ¥é“ä¸€ä¸ªè¢«è§‚å¯Ÿå…ƒç´ ä½•æ—¶è¿›å…¥æˆ–ç¦»å¼€äº†æµè§ˆå™¨è§†å£ã€‚è¿™ä½¿å¾—å®ƒå¾ˆç†æƒ³ï¼Œå› ä¸ºå®ƒå¯ä»¥å¼‚æ­¥ä¼ è¾“æ•°æ®ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“ä¸»çº¿ç¨‹ï¼Œè¿™è®©å®ƒæˆä¸ºä¸€ä¸ªæä¾›åé¦ˆçš„æœ‰æ•ˆæ‰‹æ®µã€‚</p><p>åœ¨ Paul çš„ç¤ºä¾‹ä¸­ï¼Œå®ƒå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<br>Intersection Observer æ¥å®ç°å½“å›¾ç‰‡è¿›å…¥è§†å£æ—¶å»¶è¿ŸåŠ è½½ã€‚æˆ‘ä½¿ç”¨äº†ä»–çš„åˆå§‹ä»£ç ï¼Œå¹¶ç¨ä½œä¿®æ”¹è®©å®ƒæ›´å®¹æ˜“ç†è§£ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è¿‡ä¸€é Intersection Observer çš„åŸºç¡€çŸ¥è¯†å¹¶å‘ä½ å±•ç¤ºä½ è¯¥å¦‚ä½•ç”¨ä¸€ä¸ªè¶…çº§é«˜æ•ˆçš„æ–¹æ³•æ¥å»¶è¿ŸåŠ è½½å›¾ç‰‡ã€‚</p><h3 id="å…¥é—¨"><a href="#å…¥é—¨" class="headerlink" title="å…¥é—¨"></a>å…¥é—¨</h3><p>æƒ³è±¡ä¸€ä¸ªæœ‰ä¸‰å¼ å›¾ç‰‡çš„åŸºæœ¬çš„ HTML é¡µé¢ï¼Œå°±åƒä¸Šé¢é‚£ä¸ªä¸€æ ·ï¼Œåœ¨è¿™ä¸ªç½‘é¡µä¸Šï¼Œä½ å°†æœ‰å¦‚ä¸‹ä»£ç çš„å›¾ç‰‡å…ƒç´ ï¼š</p><pre><code class="html">&lt;img class=&quot;js-lazy-image&quot; data-src=&quot;burger.png&quot;&gt;</code></pre><p>ä½ ä¹Ÿè®¸æ³¨æ„åˆ°ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå›¾ç‰‡æ–‡ä»¶æ²¡æœ‰ src å±æ€§ä¹ˆã€‚è¿™æ˜¯å› ä¸ºå®ƒä½¿ç”¨äº†ç§°ä¸º data-src çš„ data å±æ€§æ¥æŒ‡å‘å›¾ç‰‡æºã€‚æˆ‘ä»¬å°†ä½¿ç”¨è¿™æ¥åŠ è½½å›¾ç‰‡ï¼Œå½“å®ƒä»¬è¿›å…¥è§†å£æ—¶ã€‚ä½ ä¹Ÿè®¸è¿˜æ³¨æ„åˆ°å›¾ç‰‡å…ƒç´ è¿˜æœ‰ä¸€ä¸ªç§°ä¸º js-lazy-image çš„ class â€”â€” æˆ‘ä»¬å°†å¾ˆå¿«åœ¨ JavaScript ä»£ç ä¸­ç”¨å®ƒæ¥ç¡®å®šæˆ‘ä»¬æƒ³å»¶è¿ŸåŠ è½½çš„å…ƒç´ ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå»¶è¿ŸåŠ è½½é¡µé¢ä¸­å›¾ç‰‡çš„ä»£ç ã€‚åœ¨æˆ‘ä»¬çš„ JavaScript æ–‡ä»¶ä¸­ï¼ˆéœ€è¦åœ¨é¡µé¢ä¸­å¼•ç”¨ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ Intersection Observerã€‚</p><p>ä¸Šé¢çš„ç¤ºä¾‹ä¸­çœ‹èµ·æ¥åƒæ˜¯ä¸€å †ä»£ç ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥åˆ†è§£ã€‚é¦–å…ˆï¼Œæˆ‘é€‰æ‹©äº†é¡µé¢ä¸­æ‰€æœ‰åŒ…å« js-lazy-image ç±»çš„å›¾ç‰‡ã€‚ç„¶åæˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ IntersectionObserverï¼Œå¹¶ç”¨å®ƒæ¥è§‚å¯Ÿæ‰€æœ‰æˆ‘ä»¬å·²ç»é€‰æ‹©çš„å¸¦æœ‰ js-lazy-image ç±»çš„å›¾ç‰‡ã€‚ä½¿ç”¨ IntersectionObserver çš„é»˜è®¤é€‰é¡¹ï¼Œä½ çš„å›è°ƒä¼šåœ¨å…ƒç´ éƒ¨åˆ†è¿›å…¥è§†åŒºå’Œå®Œå…¨ç¦»å¼€è§†å£æ—¶è¢«è°ƒç”¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä¼šä¼ é€’ä¸€äº›é¢å¤–çš„é…ç½®é€‰é¡¹ç»™ IntersectionObserverã€‚ä½¿ç”¨ rootMargin å…è®¸ä½ æŒ‡å®šæ ¹å…ƒç´ çš„ margin å€¼ï¼Œè®©ä½ å¯ä»¥æ‰©å±•æˆ–è€…ç¼©å‡ intersections çš„ä½¿ç”¨åŒºåŸŸã€‚æˆ‘ä»¬æƒ³ç¡®ä¿å¦‚æœå›¾ç‰‡è¿›å…¥äº† Y è½´çš„ 50px å†…ï¼Œæˆ‘ä»¬å°†å¼€å§‹ä¸‹è½½ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ª Intersection Observer å¹¶ä¸”æ­£åœ¨è§‚å¯Ÿé¡µé¢ä¸Šçš„å›¾ç‰‡ï¼Œæˆ‘ä»¬ç°åœ¨æ¥äº†è§£ intersection äº‹ä»¶ï¼Œå®ƒå°†åœ¨å…ƒç´ è¿›å…¥è§†åŒºæ—¶è§¦å‘ã€‚</p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ¯å½“æˆ‘ä»¬æ­£åœ¨è§‚å¯Ÿçš„å…ƒç´ è¿›å…¥åˆ°ç”¨æˆ·è§†å£å†…ï¼ŒonIntersection å‡½æ•°å°†è¢«è§¦å‘ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾ªç¯æˆ‘ä»¬æ‰€è§‚å¯Ÿçš„å›¾ç‰‡å¹¶ç¡®å®šå“ªä¸€ä¸ªåœ¨è§†å£ä¸­ã€‚å¦‚æœå½“å‰å…ƒç´ å¤„åœ¨äº¤å‰æ¯”ä¾‹ï¼ˆintersection ratioï¼‰ä¹‹ä¸­ï¼Œæˆ‘ä»¬å°±çŸ¥é“è¿™å›¾ç‰‡åœ¨ç”¨æˆ·è§†å£ä¹‹ä¸­å¹¶ä¸”æˆ‘ä»¬å¯ä»¥åŠ è½½å®ƒäº†ã€‚ä¸€æ—¦å›¾ç‰‡åŠ è½½å®Œæ¯•ï¼Œæˆ‘ä»¬ä¸åœ¨éœ€è¦è§‚å¯Ÿå®ƒï¼Œä½¿ç”¨ unobserve() å°†å®ƒä» Intersection Observer çš„è§‚å¯Ÿåˆ—è¡¨ä¸­ç§»é™¤ã€‚</p><p>å°±æ˜¯è¿™æ ·ï¼ä¸€æ—¦ç”¨æˆ·æ»šåŠ¨å¹¶ä¸”å›¾ç‰‡è¿›å…¥è§†åŒºï¼Œå¯¹åº”çš„å›¾ç‰‡å°†è¢«åŠ è½½ã€‚è¿™ä¸ªä»£ç æœ€æ£’çš„åœ°æ–¹åœ¨äº Intersection Observer æ¯” Barry White æ›´åŠ æµç•…ã€‚</p><h2 id="æµè§ˆå™¨æ”¯æŒ"><a href="#æµè§ˆå™¨æ”¯æŒ" class="headerlink" title="æµè§ˆå™¨æ”¯æŒ"></a>æµè§ˆå™¨æ”¯æŒ</h2><p>Firefoxã€Chrome å’Œ Opera æ”¯æŒï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½æ¶ˆæ¯ã€‚</p><p>ç„¶è€Œï¼Œä¸ºäº†ç¡®ä¿æˆ‘ä»¬çš„ä»£ç ä¸ä¼šåœ¨ä¸æ”¯æŒå®ƒçš„æµè§ˆå™¨ä¸­é€ æˆç ´åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‰¹æ€§æ£€æµ‹æ¥ç¡®å®šæˆ‘ä»¬åº”è¯¥å¦‚ä½•æ¥åŠ è½½å›¾ç‰‡ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„ä»£ç ã€‚</p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥äº† IntersectionObserver æ˜¯å¦åœ¨å½“å‰æµè§ˆå™¨ä¸­å¯ç”¨ï¼Œå¦‚æœä¸å¯ç”¨æˆ‘ä»¬å°±ç«‹å³åŠ è½½è¿™äº›å›¾ç‰‡ï¼Œå¦åˆ™ä½¿ç”¨æˆ‘ä»¬çš„é»˜è®¤è¡Œä¸ºã€‚</p><p>å¦‚æœä½ çœŸçš„å–œæ¬¢ Intersection Observer API çš„æ˜“ç”¨æ€§å¹¶æƒ³ä½¿ç”¨ polyfill æ¥æ›¿ä»£ã€‚WICG åˆ›å»ºäº†ä¸€ä¸ªæ”¾åœ¨äº†ä»–ä»¬çš„ Github ä»“åº“ã€‚å”¯ä¸€çš„ç¼ºç‚¹æ˜¯ä½ æ— æ³•è·å–åˆ°åŸç”Ÿå®ç°ç»™ä½ å¸¦æ¥çš„æ€§èƒ½ä¼˜åŠ¿ã€‚</p><p>ä½ ç”šè‡³å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼Œåƒ Robin Osborne å»ºè®®çš„é‚£æ ·ï¼Œä¸ºä¸å¯ç”¨ JavaScript çš„ç”¨æˆ·æ·»åŠ æ”¯æŒã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨è¿™ç¯‡æ–‡ç« æ±‡æ€»ï¼Œæˆ‘ä»¬ä½¿ç”¨ Intersection Observer æ¥å»¶è¿ŸåŠ è½½å›¾ç‰‡ï¼Œä½†ä½ å¯ä»¥ç”¨å®ƒæ¥åšçš„æ›´å¤šã€‚å®ƒå¯ä»¥ç”¨äºåˆ¤æ–­æŸäººæ˜¯å¦æ­£åœ¨æŸ¥çœ‹å¹¿å‘Šï¼Œæˆ–è€…ç”šè‡³æ˜¯ iFrame ä¸­çš„å…ƒç´ æ˜¯å¦åœ¨è§†åŒºä¸­ã€‚æ˜“äºç†è§£çš„ API ä½¿å®ƒè·å¾—äº†æ›´å¤šçš„å¯èƒ½æ€§ã€‚</p><p>å¦‚æœä½ æƒ³å­¦ä¹ æ›´å¤šå…³äº Intersection Observer çš„ä¿¡æ¯ï¼Œæˆ‘æ¨èé˜…è¯» Google Developers ç½‘ç«™ä¸Š è¿™ç¯‡å†…å®¹ä¸°å¯Œçš„æ–‡ç« ã€‚æˆ‘ä¹Ÿå¼ºçƒˆæ¨èè§‚çœ‹ Youtube ä¸Š <a href="https://www.youtube.com/watch?v=ncYQkOrKTaI&amp;list=PLNYkxOF6rcIBykcJ7bvTpqU7vt-oey72J&amp;index=7" target="_blank" rel="noopener">Paul Lewis</a> çš„è§†é¢‘ç³»åˆ—ï¼Œå®ƒåŒ…å«äº†è®¸å¤šå¾ˆæ£’çš„æŠ€å·§ï¼Œä½ ç»å¯¹ä¼šå­¦åˆ°äº›ä¸œè¥¿ã€‚</p><p><a href="https://c7sky.com/lazy-loading-images-using-intersection-observer.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‡’åŠ è½½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fetchä½¿ç”¨çš„å¸¸è§é—®é¢˜åŠè§£å†³åŠæ³•</title>
      <link href="/2018/07/27/study/fetch%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/"/>
      <url>/2018/07/27/study/fetch%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¯´é“fetchå°±ä¸å¾—ä¸æ<code>XMLHttpRequest</code>äº†ï¼ŒXHRåœ¨å‘é€webè¯·æ±‚æ—¶éœ€è¦å¼€å‘è€…é…ç½®ç›¸å…³è¯·æ±‚ä¿¡æ¯å’ŒæˆåŠŸåçš„å›è°ƒï¼Œå°½ç®¡å¼€å‘è€…åªå…³å¿ƒè¯·æ±‚æˆåŠŸåçš„ä¸šåŠ¡å¤„ç†ï¼Œä½†æ˜¯ä¹Ÿè¦é…ç½®å…¶ä»–ç¹çå†…å®¹ï¼Œå¯¼è‡´é…ç½®å’Œè°ƒç”¨æ¯”è¾ƒæ··ä¹±ï¼Œä¹Ÿä¸ç¬¦åˆå…³æ³¨åˆ†ç¦»çš„åŸåˆ™ï¼›fetchçš„å‡ºç°æ­£æ˜¯ä¸ºäº†è§£å†³XHRå­˜åœ¨çš„è¿™äº›é—®é¢˜ã€‚ä¾‹å¦‚ä¸‹é¢ä»£ç ï¼š</p><pre><code class="js">fetch(url).then(function(response){    return response.json();}).then(function(data){    console.log(data)}).catch(function(e){    console.log(&quot;Oops,error&quot;)})</code></pre><p>ä¸Šé¢è¿™æ®µä»£ç è®©å¼€å‘è€…åªå…³æ³¨è¯·æ±‚æˆåŠŸåçš„ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œå…¶ä»–çš„ä¸ç”¨å…³å¿ƒï¼Œç›¸å½“ç®€å•ï¼›ä¹Ÿæ¯”è¾ƒç¬¦åˆç°ä»£Promiseå½¢å¼ï¼Œæ¯”è¾ƒå‹å¥½ã€‚</p><p>fetchæ˜¯åŸºäºPromiseè®¾è®¡çš„ï¼Œä»ä¸Šé¢ä»£ç ä¹Ÿèƒ½çœ‹å¾—å‡ºæ¥ï¼Œè¿™å°±è¦æ±‚fetchè¦é…åˆPromiseä¸€èµ·ä½¿ç”¨ã€‚æ­£æ˜¯è¿™ç§è®¾è®¡ï¼Œfetchæ‰€å¸¦æ¥çš„ä¼˜ç‚¹æ­£å¦‚ã€ä¼ ç»Ÿ Ajax å·²æ­»ï¼ŒFetch æ°¸ç”Ÿæ€»ç»“ã€‘çš„ä¸€æ ·ï¼š</p><ul><li><p>è¯­æ³•ç®€å•ï¼Œæ›´åŠ è¯­ä¹‰åŒ–</p></li><li><p>åŸºäºæ ‡å‡†çš„Promiseå®ç°ï¼Œæ”¯æŒasync/await</p></li><li><p>ä½¿ç”¨isomorphic-fetchå¯ä»¥æ–¹ä¾¿åŒæ„</p></li></ul><p>ä¸è¿‡è¯è¯´å›æ¥ï¼Œfetchè™½ç„¶æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œä½†æ˜¯ä½¿ç”¨fetchæ¥è¿›è¡Œé¡¹ç›®å¼€å‘æ—¶ï¼Œä¹Ÿæ˜¯æœ‰ä¸€äº›å¸¸è§é—®é¢˜çš„ï¼Œä¸‹é¢å°±æ¥è¯´è¯´fetchä½¿ç”¨çš„å¸¸è§é—®é¢˜ã€‚</p><h2 id="fetchå…¼å®¹æ€§"><a href="#fetchå…¼å®¹æ€§" class="headerlink" title="fetchå…¼å®¹æ€§"></a>fetchå…¼å®¹æ€§</h2><p>fetchæ˜¯ç›¸å¯¹è¾ƒæ–°çš„æŠ€æœ¯ï¼Œå½“ç„¶å°±ä¼šå­˜åœ¨æµè§ˆå™¨å…¼å®¹æ€§çš„é—®é¢˜ï¼Œå€Ÿç”¨ä¸Šé¢åº”ç”¨æ–‡ç« çš„ä¸€å¹…å›¾åŠ ä»¥è¯´æ˜fetchåœ¨å„ç§æµè§ˆå™¨çš„åŸç”Ÿæ”¯æŒæƒ…å†µï¼š</p><p><img src="https://images2015.cnblogs.com/blog/408483/201702/408483-20170221215434991-1565736785.png" alt="fetchå…¼å®¹æ€§"></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œåœ¨å„ä¸ªæµè§ˆå™¨ä½ç‰ˆæœ¬çš„æƒ…å†µä¸‹éƒ½æ˜¯ä¸è¢«æ”¯æŒçš„ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­é€šç”¨fetchå‘¢ï¼Œå½“ç„¶å°±è¦è€ƒè™‘fetchçš„<code>polyfill</code>äº†ã€‚<br><a id="more"></a><br>ä¸Šé¢è¯´è¿‡ï¼Œfetchæ˜¯åŸºäºPromiseæ¥å®ç°çš„ï¼Œæ‰€ä»¥åœ¨ä½ç‰ˆæœ¬æµè§ˆå™¨ä¸­Promiseå¯èƒ½ä¹Ÿæœªè¢«åŸç”Ÿæ”¯æŒï¼Œæ‰€ä»¥è¿˜éœ€è¦Promiseçš„polyfillï¼›å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ç°fetchçš„polyfilléœ€è¦æ¶‰åŠåˆ°çš„ï¼š</p><ul><li><strong>promiseçš„polyfill</strong>ï¼Œä¾‹å¦‚es6-promiseã€babel-polyfillæä¾›çš„promiseå®ç°ã€‚</li><li><strong>fetchçš„polyfillå®ç°</strong>ï¼Œä¾‹å¦‚isomorphic-fetchå’Œwhatwg-fetch</li></ul><p>è¿™æ ·æ˜¯å¦å°±å¯ä»¥å®‰å…¨çš„ä½¿ç”¨fetchæ¥è¿›è¡Œå‰åç«¯é€šä¿¡äº†ï¼Ÿä¸Šé¢è¯´äº†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯è¿™æ ·ï¼Œä½†æ˜¯IE8/9åˆ™æ¯”è¾ƒç‰¹æ®Šï¼šIE8å®ƒä½¿ç”¨çš„æ˜¯ES3ï¼Œè€ŒIE9åˆ™å¯¹ES5éƒ¨åˆ†æ”¯æŒã€‚è¿™ç§æƒ…å†µä¸‹è¿˜éœ€è¦ES5çš„polyfill <code>es5-shim</code>æ”¯æŒäº†ã€‚</p><p>ä¸Šè¿°æœ‰å…³promiseçš„polyfillå®ç°ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼š</p><blockquote><p>babel-runtimeæ˜¯ä¸èƒ½ä½œä¸ºPromiseçš„polyfillçš„å®ç°çš„ï¼Œå¦åˆ™åœ¨IE8/9ä¸‹ä½¿ç”¨fetchä¼šæŠ¥Promiseæœªå®šä¹‰ã€‚ä¸ºä»€ä¹ˆï¼Ÿæˆ‘æƒ³å¤§å®¶çŒœåˆ°äº†ï¼Œå› ä¸ºbabel-runtimeå®ç°çš„polyfillæ˜¯å±€éƒ¨å®ç°è€Œä¸æ˜¯å…¨å±€å®ç°ï¼Œfetchåº•å±‚å®ç°ç”¨åˆ°Promiseå°±æ˜¯ä»å…¨å±€ä¸­å»å–çš„ï¼Œæ‹¿ä¸åˆ°è¿™æŠ¥ä¸Šè¿°é”™è¯¯ã€‚</p></blockquote><p>å¦å¤–ï¼Œé¡ºä¾¿è¡¥å……ä¸€ä¸‹fetchçš„polyfillå®ç°æ€è·¯æ˜¯ï¼š</p><blockquote><p>é¦–å…ˆåˆ¤æ–­æµè§ˆå™¨æ˜¯å¦åŸç”Ÿæ”¯æŒfetchï¼Œå¦åˆ™ç»“åˆPromiseä½¿ç”¨XMLHttpRequestçš„æ–¹å¼æ¥å®ç°ï¼›è¿™æ­£æ˜¯whatwg-fetchçš„å®ç°æ€è·¯ï¼Œè€ŒåŒæ„åº”ç”¨ä¸­ä½¿ç”¨çš„isomorphic-fetchï¼Œå…¶å®¢æˆ·ç«¯fetchçš„å®ç°æ˜¯ç›´æ¥require whatwg-fetchæ¥å®ç°çš„ã€‚</p></blockquote><h2 id="fetché»˜è®¤ä¸æºå¸¦cookie"><a href="#fetché»˜è®¤ä¸æºå¸¦cookie" class="headerlink" title="fetché»˜è®¤ä¸æºå¸¦cookie"></a>fetché»˜è®¤ä¸æºå¸¦cookie</h2><p>fetchå‘é€è¯·æ±‚é»˜è®¤æ˜¯ä¸å‘é€cookieçš„ï¼Œä¸ç®¡æ˜¯åŒåŸŸè¿˜æ˜¯è·¨åŸŸï¼›é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œå¯¹äºé‚£äº›éœ€è¦æƒé™éªŒè¯çš„è¯·æ±‚å°±å¯èƒ½æ— æ³•æ­£å¸¸è·å–æ•°æ®ï¼Œè¿™æ—¶å¯ä»¥é…ç½®å…¶<code>credentials</code>é¡¹ï¼Œå…¶æœ‰3ä¸ªå€¼ï¼š</p><ul><li>omit: é»˜è®¤å€¼ï¼Œå¿½ç•¥cookieçš„å‘é€</li><li>same-origin: è¡¨ç¤ºcookieåªèƒ½åŒåŸŸå‘é€ï¼Œä¸èƒ½è·¨åŸŸå‘é€</li><li>include: cookieæ—¢å¯ä»¥åŒåŸŸå‘é€ï¼Œä¹Ÿå¯ä»¥è·¨åŸŸå‘é€</li></ul><p><code>credentials</code>æ‰€è¡¨è¾¾çš„å«ä¹‰ï¼Œå…¶å®ä¸XHR2ä¸­çš„<code>withCredentials</code>å±æ€§ç±»ä¼¼ï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦æºå¸¦cookieï¼›å…·ä½“å¯ä»¥å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„<a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">è·¨åŸŸèµ„æºå…±äº« CORS</a> è¯¦è§£ä¸­<code>withCredentials</code>ä¸€èŠ‚çš„ä»‹ç»ï¼›</p><p>è¿™æ ·ï¼Œè‹¥è¦fetchè¯·æ±‚æºå¸¦cookieä¿¡æ¯ï¼Œåªéœ€è®¾ç½®ä¸€ä¸‹credentialsé€‰é¡¹å³å¯ï¼Œä¾‹å¦‚</p><pre><code class="js">fetch(url, {credentials: &#39;include&#39;});</code></pre><p>å¦å¤–è¡¥å……ä¸€ç‚¹ï¼š</p><blockquote><p>fetché»˜è®¤å¯¹æœåŠ¡ç«¯é€šè¿‡Set-Cookieå¤´è®¾ç½®çš„cookieä¹Ÿä¼šå¿½ç•¥ï¼Œè‹¥æƒ³é€‰æ‹©æ¥å—æ¥è‡ªæœåŠ¡ç«¯çš„cookieä¿¡æ¯ï¼Œä¹Ÿå¿…é¡»è¦é…ç½®<code>credentials</code>é€‰é¡¹ï¼›</p></blockquote><h2 id="fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject"><a href="#fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject" class="headerlink" title="fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject"></a>fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject</h2><p>ä¸»è¦æ˜¯ç”±fetchè¿”å›promiseå¯¼è‡´çš„ï¼Œå› ä¸ºfetchè¿”å›çš„promiseåœ¨æŸäº›é”™è¯¯çš„httpçŠ¶æ€ä¸‹å¦‚ <strong>400ã€500</strong>ç­‰ä¸ä¼šrejectï¼Œç›¸åå®ƒä¼šè¢«resolveï¼›åªæœ‰ç½‘ç»œé”™è¯¯ä¼šå¯¼è‡´è¯·æ±‚ä¸èƒ½å®Œæˆæ—¶ï¼Œfetch æ‰ä¼šè¢« rejectï¼›æ‰€ä»¥ä¸€èˆ¬ä¼šå¯¹fetchè¯·æ±‚åšä¸€å±‚å°è£…ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š</p><pre><code class="js">function checkStatus(response) {  if (response.status &gt;= 200 &amp;&amp; response.status &lt; 300) {    return response;  }  const error = new Error(response.statusText);  error.response = response;  throw error;}function parseJSON(response) {  return response.json();}export default function request(url, options) {  let opt = options||{};  return fetch(url, {credentials: &#39;include&#39;, ...opt})    .then(checkStatus)    .then(parseJSON)    .then((data) =&gt; ( data ))    .catch((err) =&gt; ( err ));}</code></pre><h2 id="fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†"><a href="#fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†" class="headerlink" title="fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†"></a>fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†</h2><p>ç”¨è¿‡fetchçš„éƒ½çŸ¥é“ï¼Œfetchä¸åƒå¤§å¤šæ•°ajaxåº“é‚£æ ·å¯¹è¯·æ±‚è®¾ç½®è¶…æ—¶timeoutï¼Œå®ƒæ²¡æœ‰æœ‰å…³è¯·æ±‚è¶…æ—¶çš„featureï¼Œè¿™ä¸€ç‚¹æ¯”è¾ƒè›‹ç–¼ã€‚æ‰€ä»¥åœ¨fetchæ ‡å‡†æ·»åŠ è¶…æ—¶featureä¹‹å‰ï¼Œéƒ½éœ€è¦polyfillè¯¥ç‰¹æ€§ã€‚</p><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯<code>abort()</code>, timeoutå¯ä»¥é€šè¿‡<code>timeout+abort</code>æ–¹å¼æ¥å®ç°ï¼Œèµ·åˆ°çœŸæ­£è¶…æ—¶ä¸¢å¼ƒå½“å‰çš„è¯·æ±‚ã€‚</p><p>è€Œåœ¨ç›®å‰çš„fetchæŒ‡å¯¼è§„èŒƒä¸­ï¼Œfetchå¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“å®ä¾‹ï¼Œè€Œåªæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼›<em>å…¶è¿”å›çš„promiseå®ä¾‹æ ¹æ®PromiseæŒ‡å¯¼è§„èŒƒæ ‡å‡†æ˜¯ä¸èƒ½abortçš„ï¼Œä¹Ÿä¸èƒ½æ‰‹åŠ¨æ”¹å˜promiseå®ä¾‹çš„çŠ¶æ€ï¼Œåªèƒ½ç”±å†…éƒ¨æ¥æ ¹æ®è¯·æ±‚ç»“æœæ¥æ”¹å˜promiseçš„çŠ¶æ€</em>ã€‚</p><p><strong>æ—¢ç„¶ä¸èƒ½æ‰‹åŠ¨æ§åˆ¶fetchæ–¹æ³•æ‰§è¡Œåè¿”å›çš„promiseå®ä¾‹çŠ¶æ€ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯ä»¥æ‰‹åŠ¨æ§åˆ¶çŠ¶æ€çš„æ–°Promiseå®ä¾‹å‘¢</strong>ã€‚æ‰€ä»¥ï¼š</p><p>å®ç°fetchçš„timeoutåŠŸèƒ½ï¼Œå…¶æ€æƒ³å°±æ˜¯æ–°åˆ›å»ºä¸€ä¸ªå¯ä»¥æ‰‹åŠ¨æ§åˆ¶promiseçŠ¶æ€çš„å®ä¾‹ï¼Œæ ¹æ®ä¸åŒæƒ…å†µæ¥å¯¹æ–°promiseå®ä¾‹è¿›è¡Œresolveæˆ–è€…rejectï¼Œä»è€Œè¾¾åˆ°å®ç°timeoutçš„åŠŸèƒ½ï¼›</p><p>ç›®å‰å¯ä»¥æœ‰ä¸¤ç§ä¸åŒçš„è§£å†³æ–¹æ³•ï¼š</p><ul><li>ç¬¬ä¸€ç§ï¼šå•çº¯setTimeoutæ–¹å¼</li></ul><pre><code class="js">var oldFetchfn = fetch; //æ‹¦æˆªåŸå§‹çš„fetchæ–¹æ³•window.fetch = function(input, opts){//å®šä¹‰æ–°çš„fetchæ–¹æ³•ï¼Œå°è£…åŸæœ‰çš„fetchæ–¹æ³•    return new Promise(function(resolve, reject){        var timeoutId = setTimeout(function(){            reject(new Error(&quot;fetch timeout&quot;))        }, opts.timeout);        oldFetchfn(input, opts).then(            res=&gt;{                clearTimeout(timeoutId);                resolve(res)            },            err=&gt;{                clearTimeout(timeoutId);                reject(err)            }        )    })}</code></pre><p>ä¸Šé¢æ–¹æ³•å¯ä»¥æ¨¡æ‹Ÿxhrçš„abort()åŠŸèƒ½</p><pre><code class="js">var oldFetch = fetch;window.fetch = function(input, opts){    return new promise(function(resolve,reject){        var abort_promise = function(){            reject(new Error(&quot;fetch abort&quot;));        }        var p = oldFetchfn(input, opts).then(resolve, reject);        p.abort = abort_promise;        return p;    })}</code></pre><ul><li>æ–¹æ³•äºŒï¼šåˆ©ç”¨Promise.raceæ–¹æ³•</li></ul><p>Promise.raceæ–¹æ³•æ¥å—ä¸€ä¸ªpromiseå®ä¾‹æ•°ç»„å‚æ•°ï¼Œè¡¨ç¤ºå¤šä¸ªpromiseå®ä¾‹ä¸­ä»»ä½•ä¸€ä¸ªæœ€å…ˆæ”¹å˜çŠ¶æ€ï¼Œé‚£ä¹ˆraceæ–¹æ³•è¿”å›çš„promiseå®ä¾‹çŠ¶æ€å°±è·Ÿç€æ”¹å˜ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="http://es6.ruanyifeng.com/#docs/promise#Promise-race" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><pre><code class="js">var oldFetchfn = fetch; //æ‹¦æˆªåŸå§‹çš„fetchæ–¹æ³•window.fetch = function(input, opts){//å®šä¹‰æ–°çš„fetchæ–¹æ³•ï¼Œå°è£…åŸæœ‰çš„fetchæ–¹æ³•    var fetchPromise = oldFetchfn(input, opts);    var timeoutPromise = new Promise(function(resolve, reject){        setTimeout(()=&gt;{             reject(new Error(&quot;fetch timeout&quot;))        }, opts.timeout)    });    retrun Promise.race([fetchPromise, timeoutPromise])}</code></pre><p>æœ€åï¼Œå¯¹fetchçš„timeoutçš„ä¸Šè¿°å®ç°æ–¹å¼è¡¥å……å‡ ç‚¹ï¼š</p><ul><li><p>timeoutä¸æ˜¯è¯·æ±‚è¿æ¥è¶…æ—¶çš„å«ä¹‰ï¼Œå®ƒè¡¨ç¤ºè¯·æ±‚çš„responseæ—¶é—´ï¼ŒåŒ…æ‹¬è¯·æ±‚çš„è¿æ¥ã€æœåŠ¡å™¨å¤„ç†åŠæœåŠ¡å™¨å“åº”å›æ¥çš„æ—¶é—´ï¼›</p></li><li><p>fetchçš„timeoutå³ä½¿è¶…æ—¶å‘ç”Ÿäº†ï¼Œæœ¬æ¬¡è¯·æ±‚ä¹Ÿä¸ä¼šè¢«abortä¸¢å¼ƒæ‰ï¼Œå®ƒåœ¨åå°ä»ç„¶ä¼šå‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œåªæ˜¯æœ¬æ¬¡è¯·æ±‚çš„å“åº”å†…å®¹è¢«ä¸¢å¼ƒè€Œå·²ï¼›</p></li></ul><h2 id="fetchä¸æ”¯æŒjsonp"><a href="#fetchä¸æ”¯æŒjsonp" class="headerlink" title="fetchä¸æ”¯æŒjsonp"></a>fetchä¸æ”¯æŒjsonp</h2><p>fetchæ˜¯ä¸æœåŠ¡å™¨ç«¯è¿›è¡Œå¼‚æ­¥äº¤äº’çš„ï¼Œè€ŒJSONPæ˜¯ <strong>å¤–é“¾ä¸€ä¸ªjavascriptèµ„æºï¼Œå¹¶ä¸æ˜¯çœŸæ­£ajax</strong>ï¼Œæ‰€ä»¥fetchä¸JSONPæ²¡æœ‰ä»€ä¹ˆç›´æ¥å…³è”ï¼Œå½“ç„¶è‡³å°‘ç›®å‰æ˜¯ä¸æ”¯æŒJSONPçš„ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬æŠŠJSONPä¸fetchå…³è”åœ¨ä¸€èµ·æœ‰ç‚¹å·®å¼ºäººæ„ï¼Œfetchåªæ˜¯ä¸€ä¸ªajaxåº“ï¼Œæˆ‘ä»¬ä¸å¯èƒ½ä½¿fetchæ”¯æŒJSONPï¼›åªæ˜¯æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªJSONPï¼Œåªä¸è¿‡è¿™ä¸ªJSONPçš„å®ç°è¦ä¸fetchçš„å®ç°ç±»ä¼¼ï¼Œå³<strong>åŸºäºPromiseæ¥å®ç°ä¸€ä¸ªJSONP</strong>ï¼›è€Œå…¶å¤–åœ¨è¡¨ç°ç»™äººæ„Ÿè§‰æ˜¯fetchæ”¯æŒJSONPä¸€æ ·ï¼›</p><p>ç›®å‰æ¯”è¾ƒæˆç†Ÿçš„å¼€æºJSONPå®ç°<a href="https://github.com/camsong/fetch-jsonp" target="_blank" rel="noopener">fetch-jsonp</a>ç»™æˆ‘ä»¬æä¾›äº†è§£å†³æ–¹æ¡ˆï¼Œæƒ³äº†è§£å¯ä»¥è‡ªè¡Œå‰å¾€ã€‚ä¸è¿‡å†æ¬¡æƒ³å” å¨ä¸€ä¸‹å…¶JSONPçš„å®ç°æ­¥éª¤ï¼Œå› ä¸ºåœ¨æœ¬äººé¢è¯•çš„å‰ç«¯å€™é€‰äººä¸­å¤§éƒ¨åˆ†äººå¯¹JSONPçš„å®ç°è¯­ç„‰ä¸è¯¦ï¼›</p><p>ä½¿ç”¨å®ƒéå¸¸ç®€å•ï¼Œé¦–å…ˆéœ€è¦ç”¨npmå®‰è£…fetch-jsonp</p><pre><code class="js"> npm install fetch-jsonp --save-dev</code></pre><p>ç„¶ååœ¨åƒä¸‹é¢ä¸€æ ·ä½¿ç”¨ï¼š</p><pre><code class="js">fetchJsonp(fetchJsonp(&#39;/users.jsonp&#39;, {    timeout: 3000,    jsonpCallback: &#39;custom_callback&#39;  })  .then(function(response) {    return response.json()  }).catch(function(ex) {    console.log(&#39;parsing failed&#39;, ex)  })</code></pre><h2 id="fetchä¸æ”¯æŒprogressäº‹ä»¶"><a href="#fetchä¸æ”¯æŒprogressäº‹ä»¶" class="headerlink" title="fetchä¸æ”¯æŒprogressäº‹ä»¶"></a>fetchä¸æ”¯æŒprogressäº‹ä»¶</h2><p>XHRæ˜¯åŸç”Ÿæ”¯æŒprogressäº‹ä»¶çš„ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç è¿™æ ·ï¼š</p><pre><code class="js">var xhr = new XMLHttpRequest()xhr.open(&#39;POST&#39;, &#39;/uploads&#39;)xhr.onload = function() {}xhr.onerror = function() {}function updateProgress (event) {  if (event.lengthComputable) {    var percent = Math.round((event.loaded / event.total) * 100)    console.log(percent)  }xhr.upload.onprogress =updateProgress; //ä¸Šä¼ çš„progressäº‹ä»¶xhr.onprogress = updateProgress; //ä¸‹è½½çš„progressäº‹ä»¶}xhr.send();</code></pre><p>ä½†æ˜¯fetchæ˜¯ä¸æ”¯æŒæœ‰å…³progressäº‹ä»¶çš„ï¼›ä¸è¿‡å¯å–œçš„æ˜¯ï¼Œæ ¹æ®fetchçš„æŒ‡å¯¼è§„èŒƒæ ‡å‡†ï¼Œå…¶å†…éƒ¨è®¾è®¡å®ç°äº†Requestå’ŒResponseç±»ï¼›å…¶ä¸­Responseå°è£…ä¸€äº›æ–¹æ³•å’Œå±æ€§ï¼Œé€šè¿‡Responseå®ä¾‹å¯ä»¥è®¿é—®è¿™äº›æ–¹æ³•å’Œå±æ€§ï¼Œä¾‹å¦‚<code>response.json()ã€response.body</code>ç­‰ç­‰ï¼›</p><p>å€¼å¾—å…³æ³¨çš„åœ°æ–¹æ˜¯ï¼Œ<code>response.body</code>æ˜¯ä¸€ä¸ªå¯è¯»å­—èŠ‚æµå¯¹è±¡ï¼Œå…¶å®ç°äº†ä¸€ä¸ª<code>getRender()</code>æ–¹æ³•ï¼Œå…¶å…·ä½“ä½œç”¨æ˜¯ï¼š</p><blockquote><p>getRender()æ–¹æ³•ç”¨äºè¯»å–å“åº”çš„åŸå§‹å­—èŠ‚æµï¼Œè¯¥å­—èŠ‚æµæ˜¯å¯ä»¥å¾ªç¯è¯»å–çš„ï¼Œç›´è‡³bodyå†…å®¹ä¼ è¾“å®Œæˆï¼›</p></blockquote><p>å› æ­¤ï¼Œåˆ©ç”¨åˆ°è¿™ç‚¹å¯ä»¥æ¨¡æ‹Ÿå‡ºfetchçš„progress,ä»£ç å®ç°å¦‚ä¸‹</p><pre><code class="js">// fetch() returns a promise that resolves once headers have been receivedfetch(url).then(response =&gt; {  // response.body is a readable stream.  // Calling getReader() gives us exclusive access to the stream&#39;s content  var reader = response.body.getReader();  var bytesReceived = 0;  // read() returns a promise that resolves when a value has been received  reader.read().then(function processResult(result) {    // Result objects contain two properties:    // done  - true if the stream has already given you all its data.    // value - some data. Always undefined when done is true.    if (result.done) {      console.log(&quot;Fetch complete&quot;);      return;    }    // result.value for fetch streams is a Uint8Array    bytesReceived += result.value.length;    console.log(&#39;Received&#39;, bytesReceived, &#39;bytes of data so far&#39;);    // Read some more, and call this function again    return reader.read().then(processResult);  });});</code></pre><p>å¦å¤–ï¼Œgithubä¸Šä¹Ÿæœ‰ä½¿ç”¨<code>Promise+XHR</code>ç»“åˆçš„æ–¹å¼å®ç°ç±»fetchçš„progressæ•ˆæœ(å½“ç„¶è¿™è·Ÿfetchå®Œå…¨ä¸æ­è¾¹ï¼‰å¯ä»¥å‚è€ƒè¿™é‡Œï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="js">function fetchProgress(url, opts={}, onProgress){    return new Promise(funciton(resolve, reject){        var xhr = new XMLHttpRequest();        xhr.open(opts.method || &#39;get&#39;, url);        for(var key in opts.headers || {}){            xhr.setRequestHeader(key, opts.headers[key]);        }        xhr.onload = e =&gt; resolve(e.target.responseText)        xhr.onerror = reject;        if (xhr.upload &amp;&amp; onProgress){            xhr.upload.onprogress = onProgress; //ä¸Šä¼         }        if (&#39;onprogerss&#39; in xhr &amp;&amp; onProgress){            xhr.onprogress = onProgress; //ä¸‹è½½        }        xhr.send(opts.body)    })}fetchProgress(&#39;/upload&#39;).then(console.log)</code></pre><h2 id="fetchè·¨åŸŸé—®é¢˜"><a href="#fetchè·¨åŸŸé—®é¢˜" class="headerlink" title="fetchè·¨åŸŸé—®é¢˜"></a>fetchè·¨åŸŸé—®é¢˜</h2><p>æ—¢ç„¶æ˜¯ajaxåº“ï¼Œå°±ä¸å¯é¿å…ä¸è·¨åŸŸæ‰¯ä¸Šå…³ç³»ï¼›XHR2æ˜¯æ”¯æŒè·¨åŸŸè¯·æ±‚çš„ï¼Œåªä¸è¿‡è¦æ»¡è¶³æµè§ˆå™¨ç«¯æ”¯æŒ<code>CORS</code>ï¼ŒæœåŠ¡å™¨é€šè¿‡<code>Access-Control-Allow-Origin</code>æ¥å…è®¸æŒ‡å®šçš„æºè¿›è¡Œè·¨åŸŸï¼Œä»…æ­¤ä¸€ç§æ–¹å¼ã€‚</p><p>ä¸XHR2ä¸€æ ·ï¼Œfetchä¹Ÿæ˜¯æ”¯æŒè·¨åŸŸè¯·æ±‚çš„ï¼Œåªä¸è¿‡å…¶è·¨åŸŸè¯·æ±‚åšæ³•ä¸XHR2ä¸€æ ·ï¼Œ<code>éœ€è¦å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æ”¯æŒ</code>ï¼›å¦å¤–ï¼Œfetchè¿˜æ”¯æŒä¸€ç§è·¨åŸŸï¼Œä¸éœ€è¦æœåŠ¡å™¨æ”¯æŒçš„å½¢å¼ï¼Œå…·ä½“å¯ä»¥<code>é€šè¿‡å…¶modeçš„é…ç½®é¡¹æ¥è¯´æ˜</code>ã€‚</p><p>fetchçš„modeé…ç½®é¡¹æœ‰3ä¸ªå€¼ï¼Œå¦‚ä¸‹ï¼š</p><ul><li><p>same-originï¼šè¯¥æ¨¡å¼æ˜¯ä¸å…è®¸è·¨åŸŸçš„ï¼Œå®ƒéœ€è¦éµå®ˆåŒæºç­–ç•¥ï¼Œå¦åˆ™æµè§ˆå™¨ä¼šè¿”å›ä¸€ä¸ªerrorå‘ŠçŸ¥ä¸èƒ½è·¨åŸŸï¼›å…¶å¯¹åº”çš„response typeä¸ºbasicã€‚</p></li><li><p>cors: è¯¥æ¨¡å¼æ”¯æŒè·¨åŸŸè¯·æ±‚ï¼Œé¡¾åæ€ä¹‰å®ƒæ˜¯ä»¥CORSçš„å½¢å¼è·¨åŸŸï¼›å½“ç„¶è¯¥æ¨¡å¼ä¹Ÿå¯ä»¥åŒåŸŸè¯·æ±‚ä¸éœ€è¦åç«¯é¢å¤–çš„CORSæ”¯æŒï¼›å…¶å¯¹åº”çš„response typeä¸ºcorsã€‚</p></li><li><p>no-cors: è¯¥æ¨¡å¼ç”¨äºè·¨åŸŸè¯·æ±‚ä½†æ˜¯æœåŠ¡å™¨ä¸å¸¦CORSå“åº”å¤´ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡ç«¯ä¸æ”¯æŒCORSï¼›è¿™ä¹Ÿæ˜¯fetchçš„ç‰¹æ®Šè·¨åŸŸè¯·æ±‚æ–¹å¼ï¼›å…¶å¯¹åº”çš„response typeä¸ºopaqueã€‚</p></li></ul><p>é’ˆå¯¹è·¨åŸŸè¯·æ±‚ï¼Œcorsæ¨¡å¼æ˜¯å¸¸è§è·¨åŸŸè¯·æ±‚å®ç°ï¼Œä½†æ˜¯fetchè‡ªå¸¦çš„<code>no-cors</code>è·¨åŸŸè¯·æ±‚æ¨¡å¼åˆ™è¾ƒä¸ºé™Œç”Ÿï¼Œè¯¥æ¨¡å¼æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„ç‰¹ç‚¹ï¼š</p><blockquote><p>è¯¥æ¨¡å¼å…è®¸æµè§ˆå™¨å‘é€æœ¬æ¬¡è·¨åŸŸè¯·æ±‚ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®å“åº”è¿”å›çš„å†…å®¹ï¼Œè¿™ä¹Ÿæ˜¯å…¶response typeä¸ºopaqueé€æ˜çš„åŸå› ã€‚</p></blockquote><p>è¿™ä¸<code>&lt;img/&gt;</code>å‘é€çš„è¯·æ±‚ç±»ä¼¼ï¼Œåªæ˜¯è¯¥æ¨¡å¼ä¸èƒ½è®¿é—®å“åº”çš„å†…å®¹ä¿¡æ¯ï¼›ä½†æ˜¯å®ƒå¯ä»¥è¢«å…¶ä»–APIsè¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚<code>ServiceWorker</code>ã€‚å¦å¤–ï¼Œè¯¥æ¨¡å¼è¿”å›çš„repsonseå¯ä»¥åœ¨Cache APIä¸­è¢«å­˜å‚¨èµ·æ¥ä»¥ä¾¿åç»­çš„å¯¹å®ƒçš„ä½¿ç”¨ï¼Œè¿™ç‚¹å¯¹scriptã€csså’Œå›¾ç‰‡çš„CDNèµ„æºæ˜¯éå¸¸åˆé€‚çš„ï¼Œå› ä¸ºè¿™äº›èµ„æºå“åº”å¤´ä¸­éƒ½æ²¡æœ‰CORSå¤´ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œfetchçš„è·¨åŸŸè¯·æ±‚æ˜¯ä½¿ç”¨CORSæ–¹å¼ï¼Œéœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡ç«¯çš„æ”¯æŒã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Fetch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæ¨¡å—åŒ– --- Commonjsã€AMDã€CMDã€ES6 modules</title>
      <link href="/2018/07/25/study/JavaScript%E6%A8%A1%E5%9D%97%E5%8C%96-Commonjs%E3%80%81AMD%E3%80%81CMD%E3%80%81ES6-modules/"/>
      <url>/2018/07/25/study/JavaScript%E6%A8%A1%E5%9D%97%E5%8C%96-Commonjs%E3%80%81AMD%E3%80%81CMD%E3%80%81ES6-modules/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>éšç€å‰ç«¯jsä»£ç å¤æ‚åº¦çš„æé«˜ï¼Œ<code>JavaScriptæ¨¡å—åŒ–</code>è¿™ä¸ªæ¦‚å¿µä¾¿è¢«æå‡ºæ¥ï¼Œå‰ç«¯ç¤¾åŒºä¹Ÿä¸æ–­åœ°å®ç°å‰ç«¯æ¨¡å—åŒ–ï¼Œç›´åˆ°es6å¯¹å…¶è¿›è¡Œäº†è§„èŒƒï¼Œä¸‹é¢å°±ä»‹ç»JavaScriptæ¨¡å—åŒ–ã€‚</p><p><code>JavaScriptæ¨¡å—åŒ–</code>æ˜¯å¦‚ä½•ä¸€æ­¥ä¸€æ­¥åœ°å‘å±•èµ·æ¥çš„ï¼Œå¹¶ä¸”ä¹Ÿä¼šä¸»è¦å¯¹è¿™äº›æ¨¡å—åŒ–æ–¹å¼åšä¸€ä¸ªç®€å•çš„æ¯”è¾ƒã€‚</p><h2 id="ç¬¬ä¸€é˜¶æ®µï¼šæ— æ¨¡å—åŒ–"><a href="#ç¬¬ä¸€é˜¶æ®µï¼šæ— æ¨¡å—åŒ–" class="headerlink" title="ç¬¬ä¸€é˜¶æ®µï¼šæ— æ¨¡å—åŒ–"></a>ç¬¬ä¸€é˜¶æ®µï¼šæ— æ¨¡å—åŒ–</h2><p>JavaScriptæœ€åˆçš„ä½œç”¨ä»…ä»…æ˜¯éªŒè¯è¡¨å•ï¼Œåæ¥ä¼šæ·»åŠ ä¸€äº›åŠ¨ç”»ï¼Œä½†æ˜¯è¿™äº›jsä»£ç å¾ˆå¤šåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å°±å¯ä»¥å®Œæˆäº†ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨htmlæ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ª<code>script</code>æ ‡ç­¾ã€‚</p><p>åæ¥ï¼Œéšç€å‰ç«¯å¤æ‚åº¦æé«˜ï¼Œä¸ºäº†èƒ½å¤Ÿæé«˜é¡¹ç›®ä»£ç çš„å¯è¯»æ€§ã€å¯æ‰©å±•æ€§ç­‰ï¼Œæˆ‘ä»¬çš„jsæ–‡ä»¶é€æ¸å¤šäº†èµ·æ¥ï¼Œä¸å†æ˜¯ä¸€ä¸ªjsæ–‡ä»¶å°±å¯ä»¥è§£å†³çš„äº†ï¼Œè€Œæ˜¯æŠŠæ¯ä¸€ä¸ªjsæ–‡ä»¶å½“åšä¸€ä¸ªæ¨¡å—ã€‚é‚£ä¹ˆï¼Œè¿™æ—¶çš„jså¼•å…¥æ–¹å¼æ˜¯æ€æ ·çš„å‘¢ï¼Ÿå¤§æ¦‚æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p><pre><code class="html">&lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt; ã€€&lt;script src=&quot;jquery_scroller.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;main.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;other1.js&quot;&gt;&lt;/script&gt; ã€€&lt;script src=&quot;other2.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;other3.js&quot;&gt;&lt;/script&gt;</code></pre><p>å³ç®€å•çš„å°†æ‰€æœ‰çš„jsæ–‡ä»¶ç»Ÿç»Ÿæ”¾åœ¨ä¸€èµ·ã€‚ä½†æ˜¯è¿™äº›æ–‡ä»¶çš„é¡ºåºè¿˜ä¸èƒ½å‡ºé”™ï¼Œæ¯”å¦‚jqueryéœ€è¦å…ˆå¼•å…¥ï¼Œæ‰èƒ½å¼•å…¥jqueryæ’ä»¶ï¼Œæ‰èƒ½åœ¨å…¶ä»–çš„æ–‡ä»¶ä¸­ä½¿ç”¨jqueryã€‚</p><ul><li>ä¼˜ç‚¹</li></ul><p>ç›¸æ¯”äºä½¿ç”¨ä¸€ä¸ªjsæ–‡ä»¶ï¼Œè¿™ç§å¤šä¸ªjsæ–‡ä»¶å®ç°æœ€ç®€å•çš„æ¨¡å—åŒ–çš„æ€æƒ³æ˜¯è¿›æ­¥çš„</p><ul><li>ç¼ºç‚¹</li></ul><p><strong>æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸ</strong>ã€‚ å› ä¸ºæ¯ä¸€ä¸ªæ¨¡å—éƒ½æ˜¯æš´éœ²åœ¨å…¨å±€çš„ï¼Œç®€å•çš„ä½¿ç”¨ï¼Œä¼šå¯¼è‡´å…¨å±€å˜é‡å‘½åå†²çªï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½åç©ºé—´çš„æ–¹å¼æ¥è§£å†³ã€‚å¯¹äºå¤§å‹é¡¹ç›®ï¼Œå„ç§jså¾ˆå¤šï¼Œå¼€å‘äººå‘˜å¿…é¡»æ‰‹åŠ¨è§£å†³æ¨¡å—å’Œä»£ç åº“çš„ä¾èµ–å…³ç³»ï¼ŒåæœŸç»´æŠ¤æˆæœ¬è¾ƒé«˜ã€‚<br><strong>ä¾èµ–å…³ç³»ä¸æ˜æ˜¾ï¼Œä¸åˆ©äºç»´æŠ¤</strong>ã€‚ æ¯”å¦‚main.jséœ€è¦ä½¿ç”¨jqueryï¼Œä½†æ˜¯ï¼Œä»ä¸Šé¢çš„æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ˜¯çœ‹ä¸å‡ºæ¥çš„ï¼Œå¦‚æœjqueryå¿˜è®°äº†ï¼Œé‚£ä¹ˆå°±ä¼šæŠ¥é”™ã€‚</p><a id="more"></a><h2 id="ç¬¬äºŒé˜¶æ®µï¼š-CommonJSè§„èŒƒ"><a href="#ç¬¬äºŒé˜¶æ®µï¼š-CommonJSè§„èŒƒ" class="headerlink" title="ç¬¬äºŒé˜¶æ®µï¼š CommonJSè§„èŒƒ"></a>ç¬¬äºŒé˜¶æ®µï¼š CommonJSè§„èŒƒ</h2><p><code>CommonJS</code>å°±æ˜¯ä¸€ä¸ª<code>JavaScriptæ¨¡å—åŒ–</code>çš„è§„èŒƒï¼Œè¯¥è§„èŒƒæœ€åˆæ˜¯ç”¨åœ¨æœåŠ¡å™¨ç«¯çš„<code>node</code>çš„ï¼Œå‰ç«¯çš„<code>webpack</code>ä¹Ÿæ˜¯å¯¹CommonJSåŸç”Ÿæ”¯æŒçš„ã€‚</p><p>æ ¹æ®è¿™ä¸ªè§„èŒƒï¼Œ<em>æ¯ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—</em>ï¼Œå…¶å†…éƒ¨å®šä¹‰çš„å˜é‡æ˜¯å±äºè¿™ä¸ªæ¨¡å—çš„ï¼Œä¸ä¼šå¯¹å¤–æš´éœ²ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šæ±¡æŸ“å…¨å±€å˜é‡ã€‚</p><p>CommonJSçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯é€šè¿‡ <strong>require æ–¹æ³•æ¥åŒæ­¥åŠ è½½æ‰€è¦ä¾èµ–çš„å…¶ä»–æ¨¡å—ï¼Œç„¶åé€šè¿‡ exports æˆ–è€… module.exports æ¥å¯¼å‡ºéœ€è¦æš´éœ²çš„æ¥å£</strong>ã€‚å¦‚ä¸‹æ‰€ç¤º</p><pre><code class="js">// a.jsvar x = 5; var addX = function (value) { return value + x; }; module.exports.x = x; module.exports.addX = addX;</code></pre><p>è¿™é‡Œçš„<code>a.js</code>å°±æ˜¯ä¸€ä¸ª<code>CommonJS</code>è§„èŒƒçš„æ¨¡å—äº†ã€‚ è¿™é‡Œçš„<code>module</code>å°±ä»£è¡¨äº†è¿™ä¸ªæ¨¡å—ï¼Œ<code>module</code>çš„<code>exports</code>å±æ€§å°±æ˜¯å¯¹å¤–æš´éœ²çš„æ¥å£ï¼Œå¯ä»¥å¯¹å¤–å¯¼å‡ºå¤–éƒ¨å¯ä»¥è®¿é—®çš„å˜é‡ï¼Œæ¯”å¦‚è¿™é‡Œçš„xå’ŒaddXã€‚</p><p>exports æ˜¯å¯¹ module.exports çš„å¼•ç”¨ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåœ¨ä¸€ä¸ªæ¨¡å—çš„<strong>é¡¶éƒ¨</strong>æœ‰è¿™å¥ä»£ç ï¼š</p><pre><code class="js">export = export.Module;</code></pre><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥ç»™exportsèµ‹å€¼ï¼Œæ¯”å¦‚<code>numberã€function</code>ç­‰ã€‚</p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨å…¶ä»–æ¨¡å—ä¸­å¼•å…¥è¿™ä¸ªæ¨¡å—ä½¿ç”¨äº†ï¼š</p><pre><code class="js">var a = require(&#39;./a.js&#39;); console.log(example.x); // 5 console.log(example.addX(1)); // 6</code></pre><p>è¿™é‡Œçš„requireå°±ä¼šè·å–åˆ°a.jsæ‰€æš´éœ²çš„module.exportså˜é‡ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨å…¶æš´éœ²çš„xå’ŒaddXäº†ã€‚</p><ul><li>ä¼˜ç‚¹ï¼š</li></ul><p>CommonJSè§„èŒƒåœ¨æœåŠ¡å™¨ç«¯ç‡å…ˆå®Œæˆäº†JavaScriptçš„æ¨¡å—åŒ–ï¼Œ<strong>è§£å†³äº†ä¾èµ–ã€å…¨å±€å˜é‡æ±¡æŸ“çš„é—®é¢˜</strong>ï¼Œè¿™ä¹Ÿæ˜¯jsè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¿…è¦æ¡ä»¶ã€‚</p><ul><li>ç¼ºç‚¹ï¼š</li></ul><p>æ­¤æ–‡ä¸»è¦æ˜¯æµè§ˆå™¨ç«¯jsçš„æ¨¡å—åŒ–ï¼Œ ç”±äº CommonJS æ˜¯<code>åŒæ­¥åŠ è½½æ¨¡å—</code>çš„ï¼Œåœ¨æœåŠ¡å™¨ç«¯ï¼Œæ–‡ä»¶éƒ½æ˜¯ä¿å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œæ‰€ä»¥åŒæ­¥åŠ è½½æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¯¹äºæµè§ˆå™¨ç«¯ï¼Œéœ€è¦å°†æ–‡ä»¶ä»æœåŠ¡å™¨ç«¯è¯·æ±‚è¿‡æ¥ï¼Œé‚£ä¹ˆåŒæ­¥åŠ è½½å°±ä¸é€‚ç”¨äº†ï¼Œæ‰€ä»¥ï¼ŒCommonJSæ˜¯ä¸é€‚ç”¨äºæµè§ˆå™¨ç«¯çš„ã€‚</p><h2 id="ç¬¬ä¸‰é˜¶æ®µï¼š-AMDè§„èŒƒ"><a href="#ç¬¬ä¸‰é˜¶æ®µï¼š-AMDè§„èŒƒ" class="headerlink" title="ç¬¬ä¸‰é˜¶æ®µï¼š AMDè§„èŒƒ"></a>ç¬¬ä¸‰é˜¶æ®µï¼š AMDè§„èŒƒ</h2><p>ä¹‹å‰æåˆ°: CommonJSè§„èŒƒåŠ è½½æ¨¡å—æ˜¯<code>åŒæ­¥</code>çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰åŠ è½½å®Œæˆï¼Œæ‰èƒ½æ‰§è¡Œåé¢çš„æ“ä½œã€‚AMDè§„èŒƒåˆ™æ˜¯<code>éåŒæ­¥</code>åŠ è½½æ¨¡å—ï¼Œå…è®¸æŒ‡å®šå›è°ƒå‡½æ•°ã€‚ç”±äºNode.jsä¸»è¦ç”¨äºæœåŠ¡å™¨ç¼–ç¨‹ï¼Œæ¨¡å—æ–‡ä»¶ä¸€èˆ¬éƒ½å·²ç»å­˜åœ¨äºæœ¬åœ°ç¡¬ç›˜ï¼Œæ‰€ä»¥åŠ è½½èµ·æ¥æ¯”è¾ƒå¿«ï¼Œä¸ç”¨è€ƒè™‘éåŒæ­¥åŠ è½½çš„æ–¹å¼ï¼Œæ‰€ä»¥CommonJSè§„èŒƒæ¯”è¾ƒé€‚ç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ˜¯æµè§ˆå™¨ç¯å¢ƒï¼Œè¦ä»æœåŠ¡å™¨ç«¯åŠ è½½æ¨¡å—ï¼Œè¿™æ—¶å°±å¿…é¡»é‡‡ç”¨éåŒæ­¥æ¨¡å¼ï¼Œå› æ­¤æµè§ˆå™¨ç«¯ä¸€èˆ¬é‡‡ç”¨AMDè§„èŒƒã€‚è€ŒAMDè§„èŒƒçš„å®ç°ï¼Œå°±æ˜¯å¤§åé¼é¼çš„<code>require.js</code>äº†</p><p>AMDæ ‡å‡†ä¸­ï¼Œå®šä¹‰äº†ä¸‹é¢ä¸¤ä¸ªAPIï¼š</p><pre><code class="js">   1.require([module], callback)   2.define(id, [depends], callback)</code></pre><p>å³é€šè¿‡defineæ¥å®šä¹‰ä¸€ä¸ªæ¨¡å—ï¼Œç„¶åä½¿ç”¨requireæ¥åŠ è½½ä¸€ä¸ªæ¨¡å—ã€‚ å¹¶ä¸”ï¼Œrequireè¿˜æ”¯æŒCommonJSçš„æ¨¡å—å¯¼å‡ºæ–¹å¼ã€‚</p><p>å®šä¹‰alertæ¨¡å—ï¼š</p><pre><code class="js">define(function () {    var alertName = function (str) {      alert(&quot;I am &quot; + str);    }    var alertAge = function (num) {      alert(&quot;I am &quot; + num + &quot; years old&quot;);    }    return {      alertName: alertName,      alertAge: alertAge    };  });</code></pre><p>å¼•å…¥æ¨¡å—ï¼š</p><pre><code class="js">require([&#39;alert&#39;], function (alert) {  alert.alertName(&#39;JohnZhu&#39;);  alert.alertAge(21);});</code></pre><p>ä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨require.jsçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»è¦ <strong>æå‰åŠ è½½æ‰€æœ‰çš„ä¾èµ–ï¼Œç„¶åæ‰å¯ä»¥ä½¿ç”¨ï¼Œè€Œä¸æ˜¯éœ€è¦ä½¿ç”¨æ—¶å†åŠ è½½</strong>ã€‚</p><ul><li>ä¼˜ç‚¹ï¼š</li></ul><p>é€‚åˆåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­å¼‚æ­¥åŠ è½½æ¨¡å—ã€‚å¯ä»¥å¹¶è¡ŒåŠ è½½å¤šä¸ªæ¨¡å—ã€‚</p><ul><li>ç¼ºç‚¹ï¼š</li></ul><p>æé«˜äº†å¼€å‘æˆæœ¬ï¼Œå¹¶ä¸”ä¸èƒ½æŒ‰éœ€åŠ è½½ï¼Œè€Œæ˜¯å¿…é¡»æå‰åŠ è½½æ‰€æœ‰çš„ä¾èµ–ã€‚</p><h2 id="ç¬¬å››é˜¶æ®µï¼šCMDè§„èŒƒ"><a href="#ç¬¬å››é˜¶æ®µï¼šCMDè§„èŒƒ" class="headerlink" title="ç¬¬å››é˜¶æ®µï¼šCMDè§„èŒƒ"></a>ç¬¬å››é˜¶æ®µï¼šCMDè§„èŒƒ</h2><p>CMDè§„èŒƒæ˜¯é˜¿é‡Œçš„ç‰ä¼¯æå‡ºæ¥çš„ï¼Œå®ç°jsåº“ä¸ºsea.jsã€‚ å®ƒå’Œrequirejséå¸¸ç±»ä¼¼ï¼Œå³ä¸€ä¸ªjsæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œä½†æ˜¯CMDçš„åŠ è½½æ–¹å¼æ›´åŠ ä¼˜ç§€ï¼Œæ˜¯<code>é€šè¿‡æŒ‰éœ€åŠ è½½</code>çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯å¿…é¡»åœ¨æ¨¡å—å¼€å§‹å°±åŠ è½½æ‰€æœ‰çš„ä¾èµ–ã€‚å¦‚ä¸‹ï¼š</p><pre><code class="js">define(function(require, exports, module) {    var $ = require(&#39;jquery&#39;);    var Spinning = require(&#39;./spinning&#39;);    exports.doSomething = ...    module.exports = ...})</code></pre><ul><li>ä¼˜ç‚¹ï¼š</li></ul><p>åŒæ ·å®ç°äº†æµè§ˆå™¨ç«¯çš„æ¨¡å—åŒ–åŠ è½½ã€‚<br>å¯ä»¥æŒ‰éœ€åŠ è½½ï¼Œä¾èµ–å°±è¿‘ã€‚</p><ul><li>ç¼ºç‚¹ï¼š</li></ul><p>ä¾èµ–SPMæ‰“åŒ…ï¼Œæ¨¡å—çš„åŠ è½½é€»è¾‘åé‡ã€‚</p><p>å…¶å®ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡º <strong>AMDå’ŒCMDçš„åŒºåˆ«</strong>äº†ï¼Œ<em>å‰è€…æ˜¯å¯¹äºä¾èµ–çš„æ¨¡å—æå‰æ‰§è¡Œï¼Œè€Œåè€…æ˜¯å»¶è¿Ÿæ‰§è¡Œã€‚ å‰è€…æ¨å´‡ä¾èµ–å‰ç½®ï¼Œè€Œåè€…æ¨å´‡ä¾èµ–å°±è¿‘</em>ï¼Œå³åªåœ¨éœ€è¦ç”¨åˆ°æŸä¸ªæ¨¡å—çš„æ—¶å€™å†requireã€‚ å¦‚ä¸‹ï¼š</p><pre><code class="js">// AMD define([&#39;./a&#39;, &#39;./b&#39;], function(a, b) {    // ä¾èµ–å¿…é¡»ä¸€å¼€å§‹å°±å†™å¥½    a.doSomething()    // æ­¤å¤„ç•¥å» 100 è¡Œ    b.doSomething()    //...});// CMDdefine(function(require, exports, module) {    var a = require(&#39;./a&#39;)    a.doSomething()    //æ­¤å¤„ç•¥å»100è¡Œ    varb=require(&#39;./b&#39;)    //ä¾èµ–å¯ä»¥å°±è¿‘ä¹¦å†™    b.doSomething()    //...});</code></pre><h2 id="ç¬¬äº”é˜¶æ®µï¼š-ES6æ¨¡å—åŒ–"><a href="#ç¬¬äº”é˜¶æ®µï¼š-ES6æ¨¡å—åŒ–" class="headerlink" title="ç¬¬äº”é˜¶æ®µï¼š ES6æ¨¡å—åŒ–"></a>ç¬¬äº”é˜¶æ®µï¼š ES6æ¨¡å—åŒ–</h2><p>ä¹‹å‰çš„å‡ ç§æ¨¡å—åŒ–æ–¹æ¡ˆéƒ½æ˜¯å‰ç«¯ç¤¾åŒºè‡ªå·±å®ç°çš„ï¼Œåªæ˜¯å¾—åˆ°äº†å¤§å®¶çš„è®¤å¯å’Œå¹¿æ³›ä½¿ç”¨ï¼Œè€ŒES6çš„æ¨¡å—åŒ–æ–¹æ¡ˆæ˜¯çœŸæ­£çš„è§„èŒƒã€‚ åœ¨ES6ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>import</code> å…³é”®å­—å¼•å…¥æ¨¡å—ï¼Œé€šè¿‡ <code>export</code> å…³é”®å­—å¯¼å‡ºæ¨¡å—ï¼ŒåŠŸèƒ½è¾ƒä¹‹äºå‰å‡ ä¸ªæ–¹æ¡ˆæ›´ä¸ºå¼ºå¤§ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æ‰€æ¨å´‡çš„.</p><p>ä½†æ˜¯ç”±äºES6ç›®å‰æ— æ³•åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡<code>babel</code>å°†ä¸è¢«æ”¯æŒçš„<code>import</code>ç¼–è¯‘ä¸ºå½“å‰å—åˆ°å¹¿æ³›æ”¯æŒçš„ <code>require</code>ã€‚</p><p>è™½ç„¶ç›®å‰importå’Œrequireçš„åŒºåˆ«ä¸å¤§ï¼Œä½†æ˜¯è¿˜æ˜¯æ¨èä½¿ç”¨ä½¿ç”¨es6ï¼Œå› ä¸ºæœªæ¥es6å¿…å®šæ˜¯ä¸»æµï¼Œå¯¹äºä»£ç çš„è¿ç§»æˆæœ¬è¿˜æ˜¯éå¸¸å®¹æ˜“çš„ã€‚ å¦‚ï¼š</p><pre><code class="js">import store from &#39;../store/index&#39;import {mapState, mapMutations, mapActions} from &#39;vuex&#39;import axios from &#39;../assets/js/request&#39;import util from &#39;../utils/js/util.js&#39;export default {    created () {    this.getClassify();    this.RESET_VALUE();    console.log(&#39;created&#39; ,new Date().getTime());}</code></pre><h2 id="ç¬¬å…­é˜¶æ®µï¼š-UMD"><a href="#ç¬¬å…­é˜¶æ®µï¼š-UMD" class="headerlink" title="ç¬¬å…­é˜¶æ®µï¼š UMD"></a>ç¬¬å…­é˜¶æ®µï¼š UMD</h2><p>é€šè¿‡ä¸€å±‚è‡ªæ‰§è¡Œå‡½æ•°æ¥å…¼å®¹å„ç§æ¨¡å—åŒ–è§„èŒƒçš„å†™æ³•ï¼Œå…¼å®¹ AMD / CMD / CommonJS ç­‰æ¨¡å—åŒ–è§„èŒƒï¼Œè´´ä¸Šä»£ç èƒœè¿‡åƒè¨€ä¸‡è¯­ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ ES Module ç”±äºä¼šå¯¹é™æ€ä»£ç è¿›è¡Œåˆ†æï¼Œæ•…è¿™ç§è¿è¡Œæ—¶çš„æ–¹æ¡ˆæ— æ³•ä½¿ç”¨ï¼Œæ­¤æ—¶é€šè¿‡ CommonJS è¿›è¡Œå…¼å®¹ï¼›</p><pre><code class="js">(function (global, factory) {  if (typeof exports === &#39;object&#39;) {    module.exports = factory();  } else if (typeof define === &#39;function&#39; &amp;&amp; define.amd) {    define(factory);  } else {    this.eventUtil = factory();  }})(this, function (exports) { â€‹ // Define Module  Object.defineProperty(exports, &quot;__esModule&quot;, {    value: true  });  exports.default = 42;});</code></pre><h2 id="æ„å»ºå·¥å…·ä¸­çš„å®ç°"><a href="#æ„å»ºå·¥å…·ä¸­çš„å®ç°" class="headerlink" title="æ„å»ºå·¥å…·ä¸­çš„å®ç°"></a>æ„å»ºå·¥å…·ä¸­çš„å®ç°</h2><p>ä¸ºäº†æ¨¡å—åŒ–åœ¨æµè§ˆå™¨ä¸­å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸€äº›æ¨¡å—åŒ–æ‰“åŒ…å·¥å…·è¿›è¡Œæ‰“åŒ…(ä»¥webpackä¸ºä¾‹)ï¼Œå®šä¹‰äº†é¡¹ç›®å…¥å£ä¹‹åï¼Œä¼šå…ˆå¿«é€Ÿåœ°è¿›è¡Œä¾èµ–çš„åˆ†æï¼Œç„¶åå°†æ‰€æœ‰ä¾èµ–çš„æ¨¡å—è½¬æ¢æˆæµè§ˆå™¨å…¼å®¹çš„å¯¹åº”æ¨¡å—åŒ–è§„èŒƒçš„å®ç°ï¼›</p><h3 id="æ¨¡å—åŒ–çš„åŸºç¡€"><a href="#æ¨¡å—åŒ–çš„åŸºç¡€" class="headerlink" title="æ¨¡å—åŒ–çš„åŸºç¡€"></a>æ¨¡å—åŒ–çš„åŸºç¡€</h3><p>ä»ä¸Šé¢çš„ä»‹ç»ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¯¹å…¶è§„èŒƒå’Œå®ç°æœ‰äº†ä¸€å®šçš„äº†è§£ï¼›åœ¨æµè§ˆå™¨ä¸­ï¼Œè¦å®ç° CommonJS è§„èŒƒï¼Œåªéœ€è¦å®ç° module / exports / require / global è¿™å‡ ä¸ªå±æ€§ï¼Œç”±äºæµè§ˆå™¨ä¸­æ˜¯æ— æ³•è®¿é—®æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œå› æ­¤ require è¿‡ç¨‹ä¸­çš„æ–‡ä»¶å®šä½éœ€è¦æ”¹é€ ä¸ºåŠ è½½å¯¹åº”çš„ JS ç‰‡æ®µï¼ˆwebpack é‡‡ç”¨çš„æ–¹å¼ä¸ºé€šè¿‡å‡½æ•°ä¼ å‚å®ç°ä¾èµ–çš„å¼•å…¥ï¼‰ã€‚</p><p>ä¸‹é¢ä¸ºwebpackæ‰“åŒ…å‡ºæ¥çš„ä»£ç å¿«ç…§å¦‚ä¸‹ï¼š</p><pre><code class="js">(function (modules) {  // The module cache  var installedModules = {};  // The require function  function __webpack_require__(moduleId) {}  return __webpack_require__(0); // ---&gt; 0})({  0: function (module, exports, __webpack_require__) {    // Define module A    var moduleB = __webpack_require__(1); // ---&gt; 1  },  1: function (module, exports, __webpack_require__) {    // Define module B    exports = {}; // ---&gt; 2  }});</code></pre><p>å®é™…ä¸Šï¼ŒES Module çš„å¤„ç†åŒ CommonJS ç›¸å·®æ— å‡ ï¼Œåªæ˜¯åœ¨å®šä¹‰æ¨¡å—å’Œå¼•å…¥æ¨¡å—æ—¶ä¼šå»å¤„ç† __esModule æ ‡è¯†ï¼Œä»è€Œå…¼å®¹å…¶åœ¨è¯­æ³•ä¸Šçš„å·®å¼‚ã€‚</p><h3 id="å¼‚æ­¥å’Œæ‰©å±•"><a href="#å¼‚æ­¥å’Œæ‰©å±•" class="headerlink" title="å¼‚æ­¥å’Œæ‰©å±•"></a>å¼‚æ­¥å’Œæ‰©å±•</h3><p>1ã€æµè§ˆå™¨ç¯å¢ƒä¸‹ï¼Œç½‘ç»œèµ„æºå—åˆ°è¾ƒå¤§çš„é™åˆ¶ï¼Œå› æ­¤æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å¦‚æœä½“ç§¯å·¨å¤§ï¼Œå¯¹é¡µé¢æ€§èƒ½çš„æŸè€—æå¤§ï¼Œå› æ­¤éœ€è¦å¯¹æ„å»ºçš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œæ‹†åˆ†ï¼ŒåŒæ—¶æ¨¡å—ä¹Ÿéœ€è¦æ”¯æŒåŠ¨æ€åŠ è½½ï¼›</p><p>webpack æä¾›äº†ä¸¤ä¸ªæ–¹æ³• <code>require.ensure()</code> å’Œ <code>import()</code> ï¼ˆæ¨èä½¿ç”¨ï¼‰è¿›è¡Œæ¨¡å—çš„åŠ¨æ€åŠ è½½ï¼Œè‡³äºå…¶ä¸­çš„åŸç†ï¼Œè·Ÿä¸Šé¢æåŠçš„ AMD &amp; CMD æ‰€è§ç•¥åŒï¼Œimport() æ‰§è¡Œåè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå…¶ä¸­æ‰€åšçš„å·¥ä½œæ— éä¹Ÿæ˜¯åŠ¨æ€æ–°å¢ script æ ‡ç­¾ï¼Œç„¶åé€šè¿‡ <code>onload / onerror</code> äº‹ä»¶è¿›ä¸€æ­¥å¤„ç†ã€‚</p><p>2ã€ç”±äº require å‡½æ•°æ˜¯å®Œå…¨è‡ªå®šä¹‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¨¡å—åŒ–ä¸­å®ç°æ›´å¤šçš„ç‰¹æ€§ï¼Œæ¯”å¦‚é€šè¿‡ä¿®æ”¹ require.resolve æˆ– Module._extensions æ‰©å±•æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼Œä½¿å¾— css / .jsx / .vue / å›¾ç‰‡ç­‰æ–‡ä»¶ä¹Ÿèƒ½ä¸ºæ¨¡å—åŒ–æ‰€ä½¿ç”¨ï¼›</p><h2 id="é™„å½•ä¸€ï¼šç‰¹æ€§ä¸€è§ˆè¡¨"><a href="#é™„å½•ä¸€ï¼šç‰¹æ€§ä¸€è§ˆè¡¨" class="headerlink" title="é™„å½•ä¸€ï¼šç‰¹æ€§ä¸€è§ˆè¡¨"></a>é™„å½•ä¸€ï¼šç‰¹æ€§ä¸€è§ˆè¡¨</h2><table><thead><tr><th>æ¨¡å—åŒ–è§„èŒƒ</th><th style="text-align:right">åŠ è½½æ–¹å¼</th><th style="text-align:right">åŠ è½½æ—¶æœº</th><th style="text-align:right">è¿è¡Œç¯å¢ƒ</th><th style="text-align:right">å¤‡æ³¨</th></tr></thead><tbody><tr><td>AMD</td><td style="text-align:right">å¼‚æ­¥</td><td style="text-align:right">è¿è¡Œæ—¶</td><td style="text-align:right">æµè§ˆå™¨</td><td style="text-align:right"></td></tr><tr><td>CMD</td><td style="text-align:right">å¼‚æ­¥</td><td style="text-align:right">è¿è¡Œæ—¶</td><td style="text-align:right">æµè§ˆå™¨</td><td style="text-align:right"></td></tr><tr><td>CommonJS</td><td style="text-align:right">åŒæ­¥/å¼‚æ­¥</td><td style="text-align:right">è¿è¡Œæ—¶</td><td style="text-align:right">æµè§ˆå™¨/node</td><td style="text-align:right"></td></tr><tr><td>ES Module</td><td style="text-align:right">åŒæ­¥/å¼‚æ­¥</td><td style="text-align:right">ç¼–è¯‘é˜¶æ®µ</td><td style="text-align:right">æµè§ˆå™¨/node</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨¡å—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£BFC,IFC,GFCå’ŒFFC</title>
      <link href="/2018/07/23/CSS3/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3BFC-IFC-GFC%E5%92%8CFFC/"/>
      <url>/2018/07/23/CSS3/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3BFC-IFC-GFC%E5%92%8CFFC/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>BFC,IFC,IFC,FFFæ˜¯ä»€ä¹ˆï¼Œä¸»è¦è§£å†³çš„ä»€ä¹ˆé—®é¢˜ï¼Œå“ªäº›å…ƒç´ ä¼šç”ŸæˆBFCï¼Ÿæœ¬æ–‡ä¸»è¦é’ˆå¯¹è¿™å‡ ä¸ªé—®é¢˜æ¥äº†è§£ã€‚<br>åœ¨è§£é‡Šä¹‹å‰ï¼Œéœ€è¦å…ˆä»‹ç» <strong>Box</strong>ã€<strong>Formatting Context</strong>çš„æ¦‚å¿µã€‚</p><blockquote><p><strong>Box: CSSå¸ƒå±€çš„åŸºæœ¬å•ä½</strong></p></blockquote><p>Box æ˜¯ CSS å¸ƒå±€çš„å¯¹è±¡å’ŒåŸºæœ¬å•ä½ï¼Œ ç›´è§‚ç‚¹æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªé¡µé¢æ˜¯ç”±å¾ˆå¤šä¸ª Box ç»„æˆçš„ã€‚<code>å…ƒç´ çš„ç±»å‹å’Œ display å±æ€§ï¼Œå†³å®šäº†è¿™ä¸ª Box çš„ç±»å‹</code>ã€‚ ä¸åŒç±»å‹çš„ Boxï¼Œ ä¼šå‚ä¸ä¸åŒçš„ <code>Formatting Context</code>ï¼ˆä¸€ä¸ªå†³å®šå¦‚ä½•æ¸²æŸ“æ–‡æ¡£çš„å®¹å™¨ï¼‰ï¼Œå› æ­¤Boxå†…çš„å…ƒç´ ä¼šä»¥ä¸åŒçš„æ–¹å¼æ¸²æŸ“ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æœ‰å“ªäº›ç›’å­ï¼š</p><blockquote><p>block-level box:<br><code>display å±æ€§ä¸º block, list-item, table çš„å…ƒç´ ï¼Œä¼šç”Ÿæˆ block-level boxã€‚å¹¶ä¸”å‚ä¸ block fomatting context</code>ï¼›</p></blockquote><p>inline-level box:<br><code>display å±æ€§ä¸º inline, inline-block, inline-table çš„å…ƒç´ ï¼Œä¼šç”Ÿæˆ inline-level boxã€‚å¹¶ä¸”å‚ä¸ inline formatting context</code>ï¼›</p><p>run-in box: <code>display å±æ€§ä¸ºflex,grid</code></p><ul><li>å¦‚æœ run-in box åŒ…å« block boxï¼Œé‚£ä¹ˆè¿™ä¸ª run-in box ä¹Ÿæˆä¸º block box</li><li>å¦‚æœç´§è·Ÿåœ¨ run-in box ä¹‹åçš„å…„å¼ŸèŠ‚ç‚¹æ˜¯ block boxï¼Œé‚£ä¹ˆè¿™ä¸ª run-in box å°±ä¼šåšä¸ºæ­¤ block box é‡Œçš„ inline boxï¼Œrun-in box ä¸èƒ½è¿›å…¥å·²ç»ä¸€ä¸ªå·²ç»ä»¥ run-in box å¼€å¤´çš„å—å†…ï¼Œä¹Ÿä¸èƒ½è¿›å…¥æœ¬èº«å°±æ˜¯ display:run-in; çš„å—å†…</li><li>å¦åˆ™ï¼Œrun-in box æˆä¸º block box</li></ul><blockquote><p><strong>Formatting context</strong><br>ormatting context æ˜¯ W3C CSS2.1 è§„èŒƒä¸­çš„ä¸€ä¸ªæ¦‚å¿µã€‚å®ƒæ˜¯é¡µé¢ä¸­çš„ä¸€å—æ¸²æŸ“åŒºåŸŸï¼Œå¹¶ä¸”æœ‰ä¸€å¥—æ¸²æŸ“è§„åˆ™ï¼Œå®ƒå†³å®šäº†å…¶å­å…ƒç´ å°†å¦‚ä½•å®šä½ï¼Œä»¥åŠå’Œå…¶ä»–å…ƒç´ çš„å…³ç³»å’Œç›¸äº’ä½œç”¨ã€‚æœ€å¸¸è§çš„ Formatting context æœ‰ Block fomatting context (ç®€ç§°BFC)å’Œ Inline formatting context (ç®€ç§°IFC)ã€‚</p></blockquote><h2 id="BFC"><a href="#BFC" class="headerlink" title="BFC"></a>BFC</h2><p><code>BFC(Block formatting context)</code>ç›´è¯‘ä¸ºâ€å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡â€ã€‚å®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œåªæœ‰<strong>Block-level box</strong>å‚ä¸ï¼Œ å®ƒè§„å®šäº†å†…éƒ¨çš„Block-level Boxå¦‚ä½•å¸ƒå±€ï¼Œå¹¶ä¸”ä¸è¿™ä¸ªåŒºåŸŸå¤–éƒ¨æ¯«ä¸ç›¸å¹²ã€‚</p><h3 id="BFCå¸ƒå±€è§„åˆ™ï¼š"><a href="#BFCå¸ƒå±€è§„åˆ™ï¼š" class="headerlink" title="BFCå¸ƒå±€è§„åˆ™ï¼š"></a>BFCå¸ƒå±€è§„åˆ™ï¼š</h3><ul><li>å†…éƒ¨çš„Boxä¼šåœ¨å‚ç›´æ–¹å‘ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ”¾ç½®ã€‚</li><li>Boxå‚ç›´æ–¹å‘çš„è·ç¦»ç”±marginå†³å®šã€‚å±äºåŒä¸€ä¸ªBFCçš„ä¸¤ä¸ªç›¸é‚»Boxçš„marginä¼šå‘ç”Ÿé‡å </li><li>æ¯ä¸ªå…ƒç´ çš„margin boxçš„å·¦è¾¹ï¼Œ ä¸åŒ…å«å—border boxçš„å·¦è¾¹ç›¸æ¥è§¦(å¯¹äºä»å·¦å¾€å³çš„æ ¼å¼åŒ–ï¼Œå¦åˆ™ç›¸å)ã€‚å³ä½¿å­˜åœ¨æµ®åŠ¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</li><li>BFCçš„åŒºåŸŸä¸ä¼šä¸float boxé‡å ã€‚</li><li>BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚åä¹‹ä¹Ÿå¦‚æ­¤ã€‚</li><li>è®¡ç®—BFCçš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿå‚ä¸è®¡ç®—</li></ul><a id="more"></a><h3 id="å“ªäº›å…ƒç´ ä¼šç”ŸæˆBFC"><a href="#å“ªäº›å…ƒç´ ä¼šç”ŸæˆBFC" class="headerlink" title="å“ªäº›å…ƒç´ ä¼šç”ŸæˆBFC"></a>å“ªäº›å…ƒç´ ä¼šç”ŸæˆBFC</h3><ul><li>æ ¹å…ƒç´ </li><li>floatå±æ€§ä¸ä¸ºnone</li><li>positionä¸ºabsoluteæˆ–fixed</li><li>displayä¸ºinline-block, table-cell, table-caption, flex, inline-flex</li><li>overflowä¸ä¸ºvisible</li></ul><h3 id="BFCçš„ä½œç”¨åŠåŸç†"><a href="#BFCçš„ä½œç”¨åŠåŸç†" class="headerlink" title="BFCçš„ä½œç”¨åŠåŸç†"></a>BFCçš„ä½œç”¨åŠåŸç†</h3><ul><li>è‡ªé€‚åº”ä¸¤æ å¸ƒå±€</li></ul><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡é€šè¿‡è§¦å‘mainç”ŸæˆBFCï¼Œ æ¥å®ç°è‡ªé€‚åº”ä¸¤æ å¸ƒå±€ã€‚</p><pre><code class="css">.main {    overflow: hidden;}</code></pre><ul><li>æ¸…é™¤å†…éƒ¨æµ®åŠ¨</li></ul><p>ä¸ºè¾¾åˆ°æ¸…é™¤å†…éƒ¨æµ®åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥è§¦å‘parç”ŸæˆBFCï¼Œé‚£ä¹ˆparåœ¨è®¡ç®—é«˜åº¦æ—¶ï¼Œparå†…éƒ¨çš„æµ®åŠ¨å…ƒç´ childä¹Ÿä¼šå‚ä¸è®¡ç®—ã€‚</p><pre><code class="css">.par {    overflow: hidden;}</code></pre><ul><li>é˜²æ­¢å‚ç›´ margin é‡å </li></ul><p>æˆ‘ä»¬å¯ä»¥åœ¨på¤–é¢åŒ…è£¹ä¸€å±‚å®¹å™¨ï¼Œå¹¶è§¦å‘è¯¥å®¹å™¨ç”Ÿæˆä¸€ä¸ªBFCã€‚é‚£ä¹ˆä¸¤ä¸ªPä¾¿ä¸å±äºåŒä¸€ä¸ªBFCï¼Œå°±ä¸ä¼šå‘ç”Ÿmarginé‡å äº†ã€‚</p><pre><code class="html">&lt;style&gt;    .wrap {        overflow: hidden;    }    p {        color: #f55;        background: #fcc;        width: 200px;        line-height: 100px;        text-align:center;        margin: 100px;    }&lt;/style&gt;&lt;body&gt;    &lt;p&gt;Haha&lt;/p&gt;    &lt;div class=&quot;wrap&quot;&gt;        &lt;p&gt;Hehe&lt;/p&gt;    &lt;/div&gt;&lt;/body&gt;</code></pre><p>å› ä¸ºBFCå†…éƒ¨çš„å…ƒç´ å’Œå¤–éƒ¨çš„å…ƒç´ ç»å¯¹ä¸ä¼šäº’ç›¸å½±å“ï¼Œå› æ­¤ï¼Œ å½“BFCå¤–éƒ¨å­˜åœ¨æµ®åŠ¨æ—¶ï¼Œå®ƒä¸åº”è¯¥å½±å“BFCå†…éƒ¨Boxçš„å¸ƒå±€ï¼ŒBFCä¼šé€šè¿‡å˜çª„ï¼Œè€Œä¸ä¸æµ®åŠ¨æœ‰é‡å ã€‚åŒæ ·çš„ï¼Œå½“BFCå†…éƒ¨æœ‰æµ®åŠ¨æ—¶ï¼Œä¸ºäº†ä¸å½±å“å¤–éƒ¨å…ƒç´ çš„å¸ƒå±€ï¼ŒBFCè®¡ç®—é«˜åº¦æ—¶ä¼šåŒ…æ‹¬æµ®åŠ¨çš„é«˜åº¦ã€‚é¿å…marginé‡å ä¹Ÿæ˜¯è¿™æ ·çš„ä¸€ä¸ªé“ç†ã€‚</p><h2 id="IFC"><a href="#IFC" class="headerlink" title="IFC"></a>IFC</h2><p>IFC(Inline-Formatting-Contexts)å³å†…è”æ ¼å¼åŒ–ä¸Šä¸‹æ–‡å¸ƒå±€ã€‚ä¸€èˆ¬éƒ½æ˜¯è¡Œå†…å…ƒç´ æ¯”å¦‚ï¼šinput a img span ä»¥åŠdisplay å±æ€§å€¼ä¸ºinline-blockçš„å…ƒç´ ã€‚</p><h3 id="è¡Œå†…å…ƒç´ æœ‰å“ªäº›ç‰¹ç‚¹å‘¢ã€‚ï¼Ÿå¦‚ä¸‹åˆ—ä¸¾ï¼š"><a href="#è¡Œå†…å…ƒç´ æœ‰å“ªäº›ç‰¹ç‚¹å‘¢ã€‚ï¼Ÿå¦‚ä¸‹åˆ—ä¸¾ï¼š" class="headerlink" title="è¡Œå†…å…ƒç´ æœ‰å“ªäº›ç‰¹ç‚¹å‘¢ã€‚ï¼Ÿå¦‚ä¸‹åˆ—ä¸¾ï¼š"></a>è¡Œå†…å…ƒç´ æœ‰å“ªäº›ç‰¹ç‚¹å‘¢ã€‚ï¼Ÿå¦‚ä¸‹åˆ—ä¸¾ï¼š</h3><ul><li>æ°´å¹³æ–¹å‘æ ¹æ®directionä¾æ¬¡å¸ƒå±€ã€‚</li><li>ä¸ä¼šåœ¨å…ƒç´ å‰åæ¢è¡Œã€‚</li><li>å—white-spaceå±æ€§çš„å½±å“ã€‚</li><li><strong>margin/padding åœ¨ç«–ç›´æ–¹å‘æ— æ•ˆï¼Œæ°´å¹³æ–¹å‘æœ‰æ•ˆçš„</strong>ã€‚</li><li><strong>white/height å¯¹éæ›¿æ¢è¡Œå†…å…ƒç´ æ— æ•ˆï¼Œå®½åº¦ç”±å…ƒç´ å†…å®¹å†³å®š</strong>ã€‚</li><li>éæ›¿æ¢è¡Œå†…å…ƒç´ çš„è¡Œæ¡†é«˜ç”±line-heightå†³å®šè€Œæ›¿æ¢è¡Œå†…å…ƒç´ çš„è¡Œæ¡†é«˜åˆ™æ˜¯ç”±heightï¼Œpaddingï¼Œborderï¼Œmarginå†³å®š</li><li>æµ®åŠ¨æˆ–è€…ç»å¯¹å®šä½ä¼šè½¬åŒ–ä¸ºblock</li><li>vertical-alignå±æ€§ç”Ÿæ•ˆ</li></ul><h3 id="IFCçš„å¸ƒå±€è§„åˆ™å¦‚ä¸‹ï¼š"><a href="#IFCçš„å¸ƒå±€è§„åˆ™å¦‚ä¸‹ï¼š" class="headerlink" title="IFCçš„å¸ƒå±€è§„åˆ™å¦‚ä¸‹ï¼š"></a>IFCçš„å¸ƒå±€è§„åˆ™å¦‚ä¸‹ï¼š</h3><ul><li>æ¡†ä¼šä»<em>åŒ…å«å—</em>çš„é¡¶éƒ¨å¼€å§‹ï¼Œç„¶åä¸€ä¸ªæ¥ä¸€ä¸ªçš„æ’åˆ—ã€‚</li><li>åœ¨æ”¾ç½®è¿™äº›æ¡†çš„æ—¶å€™ï¼Œä»–ä»¬åœ¨æ°´å¹³æ–¹å‘ä¸Šçš„å¤–è¾¹è·ï¼Œè¾¹æ¡†å’Œå†…è¾¹è·æ‰€å çš„ç©ºé—´éƒ½ä¼šè¢«è€ƒè™‘åœ¨å†…ï¼ˆè¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªä¸€ä¸ªçš„æ¡†ï¼‰ã€‚ç„¶è€Œåœ¨å‚ç›´æ–¹å‘ä¸Šï¼Œè¿™äº›æ¡†å¯èƒ½ä¼šä»¥ä¸åŒçš„æ–¹å¼æ¥å¯¹é½ï¼Œæ¯”å¦‚ä»–ä»¬å¯ä»¥é¡¶éƒ¨å¯¹é½ï¼Œæˆ–è€…åº•éƒ¨å¯¹é½ä¹Ÿæœ‰å¯èƒ½æŒ‰ç…§æ–‡æœ¬çš„åŸºçº¿å¯¹é½ã€‚<code>è€ŒæŠŠè¿™ä¸€è¡Œä¸Šçš„æ¡†éƒ½åŒ…å«è¿›å»çš„ä¸€ä¸ªå¤§æ¡†æˆ‘ä»¬ç§°ä¹‹ä¸ºæ”¹è¡Œçš„è¡Œæ¡†</code>ã€‚æ°´å¹³çš„padding,border,marginæœ‰æ•ˆï¼Œç«–ç›´æ–¹å‘åˆ™æ— æ•ˆã€‚ä¸èƒ½æŒ‡å®šæ¡†é«˜ã€‚</li><li>è¡Œå®½çš„å®½åº¦ç”±åŒ…å«å—å’Œå­˜åœ¨çš„æµ®åŠ¨å†³å®šçš„ã€‚è¡Œæ¡†çš„é«˜åº¦è‡³å°‘ä¼šé«˜åˆ°è¶³ä»¥åŒ…å«ä»–å†…éƒ¨çš„æ‰€æœ‰æ¡†ã€‚</li><li>å½“ä¸€è¡Œä¸Šçš„è¡Œçº§æ€»å®½åº¦ï¼ˆæŸä¸€ä¸ªå°æ¡†çš„å®½åº¦æˆ–è€…è‹¥å¹²ä¸ªå°æ¡†çš„æ€»å®½åº¦ï¼‰å°äºè¡Œå®½çš„æ—¶å€™ï¼Œä»–ä»¬åœ¨è¡Œå®½å†…çš„æ°´å¹³æ–¹å‘ä¸Šçš„æ’å¸ƒç”±text-alignå†³å®šã€‚</li><li>å½“ä¸€ä¸ªè¡Œå†…æ¡†çš„å®½åº¦è¶…è¿‡äº†è¯¥è¡Œçš„è¡Œå®½çš„æ—¶å€™ï¼Œå°±ä¼šè¢«åˆ†æˆå‡ ä¸ªæ¡†ã€‚(ex.æ–‡å­—æ¢è¡Œçš„æ—¶å€™ å­—éƒ½ä¸åœ¨åŒä¸€è¡Œäº†ï¼Œé‚£æ¢è¡Œçš„æ—¶å€™è‡ªç„¶å°±ä¼šå¤šä¸€ä»½æ¡†ï¼Œè‡ªç„¶ä¹Ÿå°±å¤šäº†ä¸€ä»½è¡Œå®½)ä½†æ˜¯å¦‚æœè®¾ç½®è¿™ä¸ªæ¡†å°±ä¸èƒ½è¢«åˆ†å‰²çš„è¯ï¼ˆæ¯”å¦‚ï¼Œæ–‡å­—å¼ºåˆ¶ä¸ç»™æ¢è¡Œwhite-spaceè®¾ç½®ä¸ºnowrapï¼‰é‚£ä¹ˆè¿™æ—¶å€™è¯¥è¡Œå†…æ¡†å°±ä¼šæº¢å‡ºè¯¥è¡Œçš„è¡Œå®½ã€‚</li><li>ä¸€èˆ¬æƒ…å†µä¸‹è¡Œå®½çš„å·¦è¾¹ç´§è´´åœ¨ä»–çš„åŒ…å«å—çš„å·¦è¾¹ï¼ŒåŒæ ·ä»–çš„å³è¾¹ä¹Ÿæ˜¯ç´§è´´åœ¨å…¶åŒ…å«å—çš„å³è¾¹ã€‚ä½†æ˜¯ä¹Ÿä¸ä¸€å®šï¼Œæ¯”å¦‚å‡ºç°æµ®åŠ¨çš„è¯ï¼Œæµ®åŠ¨å…ƒç´ å¯èƒ½ä¼šæ’åœ¨åŒ…å«å—å’Œè¡Œæ¡†ä¹‹é—´ã€‚æ‰€ä»¥ä¸€èˆ¬åœ¨åŒä¸€ä¸ªIFCä¸­è¡Œæ¡†é€šå¸¸æœ‰ç›¸åŒçš„å®½åº¦ï¼ˆåŒ…å«å¿«çš„å®½åº¦ï¼‰ä½†æ˜¯æŸä¸€è¡Œçš„è¡Œå®½çš„å®½åº¦ä¹Ÿå¯èƒ½å—æµ®åŠ¨å…ƒç´ å½±å“ï¼Œå‡å°‘äº†æ°´å¹³å¯ç”¨çš„å®½åº¦äº†ã€‚åœ¨åŒä¸€ä¸ªIFCä¸­ï¼Œè¡Œæ¡†çš„é«˜åº¦é€šå¸¸æ˜¯å˜åŒ–çš„ï¼Œä¸ä¸€å®šçš„ï¼Œæ¯”å¦‚æŸä¸€è¡Œçš„æŸä¸ªæ¡†æ˜¯ä¸ªå¾ˆé«˜çš„å›¾ç‰‡ï¼Œè€Œæ”¹è¡Œæ¡†ä¸­å…¶ä»–æ¡†åªæ˜¯æ–‡å­—ã€‚</li><li>è®¡ç®—è¡Œæ¡†å†…å„ä¸ªæ¡†çš„é«˜åº¦ï¼Œå¯¹äºéæ›¿æ¢å…ƒç´ å°±æ˜¯èµ·line-height,è€Œå¯¹äºæ›¿æ¢å…ƒç´ å°±æ˜¯è¾¹ç•Œæ¡†çš„é«˜åº¦äº†ã€‚ <code>è¡Œæ¡†çš„é«˜æ˜¯æœ€é¡¶ç«¯æ¡†çš„é¡¶è¾¹åˆ°æœ€åº•ç«¯æ¡†çš„åº•è¾¹çš„è·ç¦»</code>ã€‚</li></ul><blockquote><p>è¡¥å……ï¼šåŒ…å«å—çš„æ¦‚å¿µï¼š<br>ç®€å•è¯´å°±æ˜¯å®šä½å‚è€ƒæ¡†æˆ–è€…å®šä½åæ ‡å‚è€ƒç³»ï¼Œå…ƒç´ ä¸€æ—¦å®šä¹‰äº†å®šä½æ˜¾ç¤ºï¼ˆç›¸å¯¹ã€ç»å¯¹ã€å›ºå®šï¼‰éƒ½å…·æœ‰åŒ…å«å—æ€§è´¨ï¼Œå®ƒæ‰€åŒ…å«çš„å®šä½å…ƒç´ éƒ½å°†ä»¥è¯¥åŒ…å«å—ä¸ºåæ ‡ç³»è¿›è¡Œå®šä½å’Œè°ƒæ•´ã€‚<br>æ˜¯è§†è§‰æ ¼å¼åŒ–æ¨¡å‹çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå®ƒä¸æ¡†æ¨¡å‹ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªçŸ©å½¢ï¼Œè€Œè¿™ä¸ªçŸ©å½¢çš„ä½œç”¨æ˜¯ä¸ºå®ƒé‡Œé¢åŒ…å«çš„å…ƒç´ æä¾›ä¸€ä¸ªå‚è€ƒï¼Œå…ƒç´ çš„å°ºå¯¸å’Œä½ç½®çš„è®¡ç®—å¾€å¾€æ˜¯ç”±è¯¥å…ƒç´ æ‰€åœ¨çš„åŒ…å«å—å†³å®šçš„ã€‚</p></blockquote><h2 id="FFC"><a href="#FFC" class="headerlink" title="FFC"></a>FFC</h2><p>å¼¹æ€§å¸ƒå±€(FFC-Flex Formattig-Contexts è‡ªé€‚åº”æ ¼å¼åŒ–ä¸Šä¸‹æ–‡)ç”³æ˜ display:flex;  æˆ–è€…display:inline-flex(è¡Œå†…å¼¹æ€§å¸ƒå±€)</p><p>è¿™ä¸ªå¸ƒå±€æ˜¯æˆ‘æœ€çˆ±çš„å¸ƒå±€ä¹‹ä¸€äº†ï¼Œå› ä¸ºä»–å¯ä»¥éå¸¸è½»æ¾çš„å®ç°å…ƒç´ çš„ä¸Šä¸‹å±…ä¸­ï¼Œå·¦å³å±…ä¸­ï¼›åªéœ€è¦<code>justify-content:center</code>ï¼ˆå·¦å³å±…ä¸­ï¼‰<code>align-items:center;</code>(ä¸Šä¸‹å±…ä¸­)å°±okäº†.ç”³æ˜flexä¹‹åè¿™ä¸ªå…ƒç´ å°±ä¼šæˆä¸ºä¸€ä¸ªflexå®¹å™¨ï¼Œè€Œä»–çš„å­å…ƒç´ å°±ä¼šè‡ªåŠ¨æˆä¸ºè¿™ä¸ªå®¹å™¨çš„æˆå‘˜ï¼Œç®€ç§°ä¸ºé¡¹ç›®ã€‚è€Œå…¶ä¸­åˆä¼šæœ‰ä¸¤ä¸ªè½´çº¿ï¼ˆç±»ä¼¼äºç¬›å¡å°”åæ ‡ç³»çš„ä¸¤ä¸ªè½´å§ï¼‰æ¨ªçš„ç§°ä¹‹ä¸ºä¸»è½´ï¼Œç«–ç€çš„ç§°ä¹‹ä¸ºäº¤å‰è½´ï¼Œå®¹å™¨æ˜¯ä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œä»–å¯¹è‡ªå·±å†…éƒ¨çš„é¡¹ç›®æœ‰ç€è‡ªå·±çš„ä¸€å¥—æ¸²æŸ“è§„åˆ™ï¼Œä¸å—å®¹å™¨å¤–éƒ¨çš„å½±å“ï¼ŒåŒæ ·çš„ï¼Œå®¹å™¨å†…éƒ¨çš„è§„åˆ™ä¹Ÿä¸ä¼šå½±å“å¤–é¢ã€‚</p><h3 id="å®¹å™¨å±æ€§ï¼š"><a href="#å®¹å™¨å±æ€§ï¼š" class="headerlink" title="å®¹å™¨å±æ€§ï¼š"></a>å®¹å™¨å±æ€§ï¼š</h3><p>å…­ä¸ªå±æ€§åˆ†åˆ«ä¸ºï¼š<code>flex-direction,flex-wrap,flex-flow,justify-content,align-items,align-content</code></p><h3 id="é¡¹ç›®å±æ€§ï¼š"><a href="#é¡¹ç›®å±æ€§ï¼š" class="headerlink" title="é¡¹ç›®å±æ€§ï¼š"></a>é¡¹ç›®å±æ€§ï¼š</h3><p>å…­ä¸ªå±æ€§åˆ†åˆ«ä¸ºï¼š<code>orderï¼Œflex-growï¼Œflex-shrinkï¼Œflex-basisï¼Œflexï¼Œalign-self</code></p><h3 id="GFC"><a href="#GFC" class="headerlink" title="GFC"></a>GFC</h3><p>GFCï¼ˆGrid Formatting Contextsï¼‰æ …æ ¼æ ¼å¼åŒ–ä¸Šä¸‹æ–‡</p><p>å½“ä¸ºä¸€ä¸ªå…ƒç´ è®¾ç½®displayå€¼ä¸ºgridçš„æ—¶å€™ï¼Œæ­¤å…ƒç´ å°†ä¼šè·å¾—ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ç½‘æ ¼å®¹å™¨ï¼ˆgrid containerï¼‰ä¸Šå®šä¹‰ç½‘æ ¼å®šä¹‰è¡Œï¼ˆgrid definition rowsï¼‰å’Œç½‘æ ¼å®šä¹‰åˆ—ï¼ˆgrid definition columnsï¼‰å±æ€§å„åœ¨ç½‘æ ¼é¡¹ç›®ï¼ˆgrid itemï¼‰ä¸Šå®šä¹‰ç½‘æ ¼è¡Œï¼ˆgrid rowï¼‰å’Œç½‘æ ¼åˆ—ï¼ˆgrid columnsï¼‰ä¸ºæ¯ä¸€ä¸ªç½‘æ ¼é¡¹ç›®ï¼ˆgrid itemï¼‰å®šä¹‰ä½ç½®å’Œç©ºé—´ã€‚</p><p>é‚£ä¹ˆGFCæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œå’Œtableåˆæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ<br>é¦–å…ˆåŒæ ·æ˜¯ä¸€ä¸ªäºŒç»´çš„è¡¨æ ¼ï¼Œä½†GridLayoutä¼šæœ‰æ›´åŠ ä¸°å¯Œçš„å±æ€§æ¥æ§åˆ¶è¡Œåˆ—ï¼Œæ§åˆ¶å¯¹é½ä»¥åŠæ›´ä¸ºç²¾ç»†çš„æ¸²æŸ“è¯­ä¹‰å’Œæ§åˆ¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Css3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½ çœŸçš„äº†è§£setStateå—ï¼Ÿ</title>
      <link href="/2018/07/19/React/%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BA%86%E8%A7%A3setState%E5%90%97%EF%BC%9F/"/>
      <url>/2018/07/19/React/%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BA%86%E8%A7%A3setState%E5%90%97%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<p><img src="https://user-gold-cdn.xitu.io/2018/7/11/16488940d3621cc9?imageView2/1/w/1304/h/734/q/85/format/webp/interlace/1" alt="setState"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>çœ‹ä¹‹å‰ï¼Œä¸ºäº†æ–¹ä¾¿ç†è§£å’Œç®€åŒ–æµç¨‹ï¼Œæˆ‘ä»¬é»˜è®¤reactå†…éƒ¨ä»£ç æ‰§è¡Œåˆ° <strong>performWorkã€performWorkOnRootã€performSyncWorkã€performAsyncWork</strong> è¿™å››ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå°±æ˜¯reactå»updateæ›´æ–°å¹¶ä¸”ä½œç”¨åˆ°UIä¸Šã€‚</p><h2 id="åˆæˆäº‹ä»¶ä¸­çš„setState"><a href="#åˆæˆäº‹ä»¶ä¸­çš„setState" class="headerlink" title="åˆæˆäº‹ä»¶ä¸­çš„setState"></a>åˆæˆäº‹ä»¶ä¸­çš„setState</h2><p>é¦–å…ˆå¾—äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯<code>åˆæˆäº‹ä»¶</code>ï¼Œreactä¸ºäº†è§£å†³è·¨å¹³å°ï¼Œå…¼å®¹æ€§é—®é¢˜ï¼Œè‡ªå·±å°è£…äº†ä¸€å¥—äº‹ä»¶æœºåˆ¶ï¼Œä»£ç†äº†åŸç”Ÿçš„äº‹ä»¶ï¼Œåƒåœ¨jsxä¸­å¸¸è§çš„<code>onClick</code>ã€<code>onChange</code>è¿™äº›éƒ½æ˜¯åˆæˆäº‹ä»¶ã€‚</p><pre><code class="js">class App extends Component {  state = { val: 0 }  increment = () =&gt; {    this.setState({ val: this.state.val + 1 })    console.log(this.state.val) // è¾“å‡ºçš„æ˜¯æ›´æ–°å‰çš„val --&gt; 0  }  render() {    return (      &lt;div onClick={this.increment}&gt;        {`Counter is: ${this.state.val}`}      &lt;/div&gt;    )  }}</code></pre><p>åˆæˆäº‹ä»¶ä¸­çš„<code>setState</code>å†™æ³•æ¯”è¾ƒå¸¸è§ï¼Œç‚¹å‡»äº‹ä»¶é‡Œå»æ”¹å˜ <code>this.state.val</code> çš„çŠ¶æ€å€¼ï¼Œåœ¨ <code>increment</code> äº‹ä»¶ä¸­æ‰“ä¸ªæ–­ç‚¹å¯ä»¥çœ‹åˆ°è°ƒç”¨æ ˆï¼Œè¿™é‡Œæˆ‘è´´ä¸€å¼ è‡ªå·±ç”»çš„æµç¨‹å›¾ï¼š<br><a id="more"></a><br><img src="https://user-gold-cdn.xitu.io/2018/7/11/164888c0fb049aef?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="åˆæˆäº‹ä»¶"></p><p>ä» <code>dispatchInteractiveEvent</code> åˆ° <code>callCallBack</code> ä¸ºæ­¢ï¼Œéƒ½æ˜¯å¯¹åˆæˆäº‹ä»¶çš„å¤„ç†å’Œæ‰§è¡Œï¼Œä» <code>setState</code> åˆ° requestWork æ˜¯è°ƒç”¨ <code>this.setState</code> çš„é€»è¾‘ï¼Œè¿™è¾¹ä¸»è¦çœ‹ä¸‹ <code>requestWork</code> è¿™ä¸ªå‡½æ•°ï¼ˆä» <code>dispatchEvent</code> åˆ° <code>requestWork</code> çš„è°ƒç”¨æ ˆæ˜¯å±äº <code>interactiveUpdates$1</code> çš„ stry ä»£ç å—ï¼Œä¸‹æ–‡ä¼šæåˆ°ï¼‰ã€‚</p><pre><code class="js">function requestWork(root, expirationTime) {  addRootToSchedule(root, expirationTime);  if (isRendering) {    // Prevent reentrancy. Remaining work will be scheduled at the end of    // the currently rendering batch.    return;  }  if (isBatchingUpdates) {    // Flush work at the end of the batch.    if (isUnbatchingUpdates) {      // ...unless we&#39;re inside unbatchedUpdates, in which case we should      // flush it now.      nextFlushedRoot = root;      nextFlushedExpirationTime = Sync;      performWorkOnRoot(root, Sync, false);    }    return;  }  // TODO: Get rid of Sync and use current time?  if (expirationTime === Sync) {    performSyncWork();  } else {    scheduleCallbackWithExpiration(expirationTime);  }}</code></pre><p>åœ¨ <code>requestWork</code> ä¸­æœ‰ä¸‰ä¸ªifåˆ†æ”¯ï¼Œä¸‰ä¸ªåˆ†æ”¯ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³• <code>performWorkOnRoot</code> å’Œ <code>performSyncWork</code> ï¼Œå°±æ˜¯æˆ‘ä»¬é»˜è®¤çš„updateå‡½æ•°ï¼Œä½†æ˜¯åœ¨åˆæˆäº‹ä»¶ä¸­ï¼Œèµ°çš„æ˜¯ç¬¬äºŒä¸ªifåˆ†æ”¯ï¼Œç¬¬äºŒä¸ªåˆ†æ”¯ä¸­æœ‰ä¸¤ä¸ªæ ‡è¯† <code>isBatchingUpdates</code> å’Œ <code>isUnbatchingUpdates</code> ä¸¤ä¸ªåˆå§‹å€¼éƒ½ä¸º  <strong>false</strong> ï¼Œä½†æ˜¯åœ¨ <code>interactiveUpdates$1</code> ä¸­ä¼šæŠŠ <code>isBatchingUpdates</code> è®¾ä¸º <strong>true</strong> ï¼Œä¸‹é¢å°±æ˜¯ <code>interactiveUpdates$1</code> çš„ä»£ç ï¼š</p><pre><code class="js">function interactiveUpdates$1(fn, a, b) {  if (isBatchingInteractiveUpdates) {    return fn(a, b);  }  // If there are any pending interactive updates, synchronously flush them.  // This needs to happen before we read any handlers, because the effect of  // the previous event may influence which handlers are called during  // this event.  if (!isBatchingUpdates &amp;&amp; !isRendering &amp;&amp; lowestPendingInteractiveExpirationTime !== NoWork) {    // Synchronously flush pending interactive updates.    performWork(lowestPendingInteractiveExpirationTime, false, null);    lowestPendingInteractiveExpirationTime = NoWork;  }  var previousIsBatchingInteractiveUpdates = isBatchingInteractiveUpdates;  var previousIsBatchingUpdates = isBatchingUpdates;  isBatchingInteractiveUpdates = true;  isBatchingUpdates = true;  // æŠŠrequestWorkä¸­çš„isBatchingUpdatesæ ‡è¯†æ”¹ä¸ºtrue  try {    return fn(a, b);  } finally {    isBatchingInteractiveUpdates = previousIsBatchingInteractiveUpdates;    isBatchingUpdates = previousIsBatchingUpdates;    if (!isBatchingUpdates &amp;&amp; !isRendering) {      performSyncWork();    }  }}</code></pre><p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æŠŠ <code>isBatchingUpdates</code> è®¾ä¸ºäº† true ,å¯¼è‡´åœ¨ <code>requestWork</code> æ–¹æ³•ä¸­ï¼Œ <code>isBatchingUpdates</code> ä¸º true ï¼Œä½†æ˜¯ <code>isUnbatchingUpdates</code> æ˜¯ false ï¼Œè€Œè¢«ç›´æ¥returnäº†ã€‚</p><p>é‚£returnå®Œçš„é€»è¾‘å›åˆ°å“ªé‡Œå‘¢ï¼Œæœ€ç»ˆæ­£æ˜¯å›åˆ°äº† <code>interactiveUpdates</code> è¿™ä¸ªæ–¹æ³•ï¼Œä»”ç»†çœ‹ä¸€çœ¼ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢æœ‰ä¸ª <strong>try finally</strong>è¯­æ³•ï¼Œå‰ç«¯åŒå­¦è¿™ä¸ªå…¶å®æ˜¯ç”¨çš„æ¯”è¾ƒå°‘çš„ï¼Œç®€å•çš„è¯´å°±æ˜¯ä¼šå…ˆæ‰§è¡Œ try ä»£ç å—ä¸­çš„è¯­å¥ï¼Œç„¶åå†æ‰§è¡Œ finally ä¸­çš„ä»£ç ï¼Œè€Œ fn(a, b) æ˜¯åœ¨tryä»£ç å—ä¸­ï¼Œåˆšæ‰è¯´åˆ°åœ¨ <code>requestWork</code> ä¸­è¢«returnæ‰çš„ä¹Ÿå°±æ˜¯è¿™ä¸ªfnï¼ˆä¸Šæ–‡æåˆ°çš„ ä»<code>dispatchEvent</code> åˆ° <code>requestWork</code> çš„ä¸€æ•´ä¸ªè°ƒç”¨æ ˆï¼‰ã€‚</p><p>æ‰€ä»¥å½“ä½ åœ¨ <code>increment</code> ä¸­è°ƒç”¨ <code>setState</code> ä¹‹åå»console.logçš„æ—¶å€™ï¼Œæ˜¯å±äº try ä»£ç å—ä¸­çš„æ‰§è¡Œï¼Œä½†æ˜¯ç”±äºæ˜¯åˆæˆäº‹ä»¶ï¼Œtryä»£ç å—æ‰§è¡Œå®Œstateå¹¶æ²¡æœ‰æ›´æ–°ï¼Œæ‰€ä»¥ä½ è¾“å…¥çš„ç»“æœæ˜¯æ›´æ–°å‰çš„ state å€¼ï¼Œè¿™å°±å¯¼è‡´äº†æ‰€è°“çš„â€å¼‚æ­¥â€ï¼Œä½†æ˜¯å½“ä½ çš„tryä»£ç å—æ‰§è¡Œå®Œçš„æ—¶å€™ï¼ˆä¹Ÿå°±æ˜¯ä½ çš„incrementåˆæˆäº‹ä»¶ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå»æ‰§è¡Œ finally é‡Œçš„ä»£ç ï¼Œåœ¨ finally ä¸­æ‰§è¡Œäº† <code>performSyncWork</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™æ‰ä¼šå»æ›´æ–°ä½ çš„ state å¹¶ä¸”æ¸²æŸ“åˆ°UIä¸Šã€‚</p><h2 id="ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„setState"><a href="#ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„setState" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„setState"></a>ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„setState</h2><pre><code class="js">class App extends Component {  state = { val: 0 } componentDidMount() {    this.setState({ val: this.state.val + 1 })   console.log(this.state.val) // è¾“å‡ºçš„è¿˜æ˜¯æ›´æ–°å‰çš„å€¼ --&gt; 0 }  render() {    return (      &lt;div&gt;        {`Counter is: ${this.state.val}`}      &lt;/div&gt;    )  }}</code></pre><blockquote><p>é’©å­å‡½æ•°ä¸­<code>setState</code>çš„è°ƒç”¨æ ˆï¼š</p></blockquote><p><img src="https://user-gold-cdn.xitu.io/2018/7/11/164888cef54b5edd?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="é’©å­å‡½æ•°"></p><p>å…¶å®è¿˜æ˜¯å’Œåˆæˆäº‹ä»¶ä¸€æ ·ï¼Œå½“ <code>componentDidmount</code> æ‰§è¡Œçš„æ—¶å€™ï¼Œreactå†…éƒ¨å¹¶æ²¡æœ‰æ›´æ–°ï¼Œæ‰§è¡Œå®Œ<code>componentDidmount</code>  åæ‰å» <code>commitUpdateQueue</code> æ›´æ–°ã€‚è¿™å°±å¯¼è‡´ä½ åœ¨ <code>componentDidmount</code> ä¸­ <code>setState</code> å®Œå»<code>console.log</code>æ‹¿çš„ç»“æœè¿˜æ˜¯æ›´æ–°å‰çš„å€¼ã€‚</p><h2 id="åŸç”Ÿäº‹ä»¶ä¸­çš„setState"><a href="#åŸç”Ÿäº‹ä»¶ä¸­çš„setState" class="headerlink" title="åŸç”Ÿäº‹ä»¶ä¸­çš„setState"></a>åŸç”Ÿäº‹ä»¶ä¸­çš„setState</h2><pre><code class="js">class App extends Component {  state = { val: 0 }  changeValue = () =&gt; {    this.setState({ val: this.state.val + 1 })    console.log(this.state.val) // è¾“å‡ºçš„æ˜¯æ›´æ–°åçš„å€¼ --&gt; 1  } componentDidMount() {    document.body.addEventListener(&#39;click&#39;, this.changeValue, false) }  render() {    return (      &lt;div&gt;        {`Counter is: ${this.state.val}`}      &lt;/div&gt;    )  }}</code></pre><p>åŸç”Ÿäº‹ä»¶æ˜¯æŒ‡é<code>react</code>åˆæˆäº‹ä»¶ï¼ŒåŸç”Ÿè‡ªå¸¦çš„äº‹ä»¶ç›‘å¬ <code>addEventListener</code> ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç”¨åŸç”Ÿjsã€jqç›´æ¥ <code>document.querySelector().onclick</code> è¿™ç§ç»‘å®šäº‹ä»¶çš„å½¢å¼éƒ½å±äºåŸç”Ÿäº‹ä»¶ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2018/7/11/164888d958a2df16?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="åŸç”Ÿäº‹ä»¶"></p><p>åŸç”Ÿäº‹ä»¶çš„è°ƒç”¨æ ˆå°±æ¯”è¾ƒç®€å•äº†ï¼Œå› ä¸ºæ²¡æœ‰èµ°åˆæˆäº‹ä»¶çš„é‚£ä¸€å¤§å †ï¼Œç›´æ¥è§¦å‘clickäº‹ä»¶ï¼Œåˆ° <code>requestWork</code> ,åœ¨<code>requestWork</code>é‡Œç”±äº <code>expirationTime === Sync</code> çš„åŸå› ï¼Œç›´æ¥èµ°äº† <code>performSyncWork</code> å»æ›´æ–°ï¼Œå¹¶ä¸åƒåˆæˆäº‹ä»¶æˆ–é’©å­å‡½æ•°ä¸­è¢«returnï¼Œæ‰€ä»¥å½“ä½ åœ¨åŸç”Ÿäº‹ä»¶ä¸­<code>setState</code>åï¼Œèƒ½åŒæ­¥æ‹¿åˆ°æ›´æ–°åçš„stateå€¼ã€‚</p><h2 id="setTimeoutä¸­çš„setState"><a href="#setTimeoutä¸­çš„setState" class="headerlink" title="setTimeoutä¸­çš„setState"></a>setTimeoutä¸­çš„setState</h2><pre><code class="js">class App extends Component {  state = { val: 0 } componentDidMount() {    setTimeout(_ =&gt; {      this.setState({ val: this.state.val + 1 })      console.log(this.state.val) // è¾“å‡ºæ›´æ–°åçš„å€¼ --&gt; 1    }, 0) }  render() {    return (      &lt;div&gt;        {`Counter is: ${this.state.val}`}      &lt;/div&gt;    )  }}</code></pre><p>åœ¨ <code>setTimeout</code> ä¸­å» <code>setState</code> å¹¶ä¸ç®—æ˜¯ä¸€ä¸ªå•ç‹¬çš„åœºæ™¯ï¼Œå®ƒæ˜¯éšç€ä½ å¤–å±‚å»å†³å®šçš„ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨åˆæˆäº‹ä»¶ä¸­ <code>setTimeout</code> ï¼Œå¯ä»¥åœ¨é’©å­å‡½æ•°ä¸­ <code>setTimeout</code> ï¼Œä¹Ÿå¯ä»¥åœ¨åŸç”Ÿäº‹ä»¶<code>setTimeout</code>ï¼Œä½†æ˜¯ä¸ç®¡æ˜¯å“ªä¸ªåœºæ™¯ä¸‹ï¼ŒåŸºäº <strong>event loop</strong>çš„æ¨¡å‹ä¸‹ï¼Œ <code>setTimeout</code> ä¸­é‡Œå» <code>setState</code> æ€»èƒ½æ‹¿åˆ°æœ€æ–°çš„<code>state</code>å€¼ã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼Œæ¯”å¦‚ä¹‹å‰çš„åˆæˆäº‹ä»¶ï¼Œç”±äºä½ æ˜¯ <code>setTimeout(_ =&gt; { this.setState()}, 0)</code> æ˜¯åœ¨ try ä»£ç å—ä¸­,å½“ä½  try ä»£ç å—æ‰§è¡Œåˆ° <code>setTimeout</code> çš„æ—¶å€™ï¼ŒæŠŠå®ƒä¸¢åˆ°åˆ—é˜Ÿé‡Œï¼Œå¹¶æ²¡æœ‰å»æ‰§è¡Œï¼Œè€Œæ˜¯å…ˆæ‰§è¡Œçš„ <code>finally</code> ä»£ç å—ï¼Œç­‰ finally æ‰§è¡Œå®Œäº†ï¼Œ <code>isBatchingUpdates</code> åˆå˜ä¸ºäº† false ï¼Œå¯¼è‡´æœ€åå»æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„ setState æ—¶å€™ï¼Œ <code>requestWork</code> èµ°çš„æ˜¯å’ŒåŸç”Ÿäº‹ä»¶ä¸€æ ·çš„ <code>expirationTime === Sync if</code>åˆ†æ”¯ï¼Œæ‰€ä»¥è¡¨ç°å°±ä¼šå’ŒåŸç”Ÿäº‹ä»¶ä¸€æ ·ï¼Œå¯ä»¥åŒæ­¥æ‹¿åˆ°æœ€æ–°çš„stateå€¼ã€‚</p><h2 id="setStateä¸­çš„æ‰¹é‡æ›´æ–°"><a href="#setStateä¸­çš„æ‰¹é‡æ›´æ–°" class="headerlink" title="setStateä¸­çš„æ‰¹é‡æ›´æ–°"></a>setStateä¸­çš„æ‰¹é‡æ›´æ–°</h2><pre><code class="js">class App extends Component {  state = { val: 0 }  batchUpdates = () =&gt; {    this.setState({ val: this.state.val + 1 })    this.setState({ val: this.state.val + 1 })    this.setState({ val: this.state.val + 1 }) }  render() {    return (      &lt;div onClick={this.batchUpdates}&gt;        {`Counter is ${this.state.val}`} // 1      &lt;/div&gt;    )  }}</code></pre><p>ä¸Šé¢çš„ç»“æœæœ€ç»ˆæ˜¯1ï¼Œåœ¨ <code>setState</code> çš„æ—¶å€™reactå†…éƒ¨ä¼šåˆ›å»ºä¸€ä¸ª <code>updateQueue</code> ï¼Œé€šè¿‡ <code>firstUpdate</code> ã€ <code>lastUpdate</code> ã€ <code>lastUpdate.next</code> å»ç»´æŠ¤ä¸€ä¸ªæ›´æ–°çš„é˜Ÿåˆ—ï¼Œåœ¨æœ€ç»ˆçš„ <code>performWork</code> ä¸­ï¼Œç›¸åŒçš„keyä¼šè¢«è¦†ç›–ï¼Œåªä¼šå¯¹æœ€åä¸€æ¬¡çš„ <code>setState</code> è¿›è¡Œæ›´æ–°ï¼Œä¸‹é¢æ˜¯éƒ¨åˆ†å®ç°ä»£ç ï¼š</p><pre><code class="js">function createUpdateQueue(baseState) {  var queue = {    expirationTime: NoWork,    baseState: baseState,    firstUpdate: null,    lastUpdate: null,    firstCapturedUpdate: null,    lastCapturedUpdate: null,    firstEffect: null,    lastEffect: null,    firstCapturedEffect: null,    lastCapturedEffect: null  };  return queue;}function appendUpdateToQueue(queue, update, expirationTime) {  // Append the update to the end of the list.  if (queue.lastUpdate === null) {    // Queue is empty    queue.firstUpdate = queue.lastUpdate = update;  } else {    queue.lastUpdate.next = update;    queue.lastUpdate = update;  }  if (queue.expirationTime === NoWork || queue.expirationTime &gt; expirationTime) {    // The incoming update has the earliest expiration of any update in the    // queue. Update the queue&#39;s expiration time.    queue.expirationTime = expirationTime;  }}</code></pre><p>çœ‹ä¸ªğŸŒ°</p><pre><code class="js">class App extends React.Component {  state = { val: 0 }  componentDidMount() {    this.setState({ val: this.state.val + 1 })    console.log(this.state.val)    this.setState({ val: this.state.val + 1 })    console.log(this.state.val)    setTimeout(_ =&gt; {      this.setState({ val: this.state.val + 1 })      console.log(this.state.val);      this.setState({ val: this.state.val + 1 })      console.log(this.state.val)    }, 0)  }  render() {    return &lt;div&gt;{this.state.val}&lt;/div&gt;  }}</code></pre><p>ç»“åˆä¸Šé¢åˆ†æçš„ï¼Œé’©å­å‡½æ•°ä¸­çš„ <code>setState</code> æ— æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åçš„å€¼ï¼Œæ‰€ä»¥å‰ä¸¤æ¬¡éƒ½æ˜¯è¾“å‡º0ï¼Œå½“æ‰§è¡Œåˆ° <code>setTimeout</code> é‡Œçš„æ—¶å€™ï¼Œå‰é¢ä¸¤ä¸ªstateçš„å€¼å·²ç»è¢«æ›´æ–°ï¼Œç”±äº setState æ‰¹é‡æ›´æ–°çš„ç­–ç•¥ï¼Œ <code>this.state.val</code> åªå¯¹æœ€åä¸€æ¬¡çš„ç”Ÿæ•ˆï¼Œä¸º1ï¼Œè€Œåœ¨ setTimmout ä¸­ setState æ˜¯å¯ä»¥åŒæ­¥æ‹¿åˆ°æ›´æ–°ç»“æœï¼Œæ‰€ä»¥ setTimeout ä¸­çš„ä¸¤æ¬¡è¾“å‡º2ï¼Œ3ï¼Œæœ€ç»ˆç»“æœå°±ä¸º 0, 0, 2, 3 ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><p>setState åªåœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ˜¯â€œå¼‚æ­¥â€çš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’Œ <code>setTimeout</code> ä¸­éƒ½æ˜¯åŒæ­¥çš„ã€‚</p></li><li><p>setStateçš„â€œå¼‚æ­¥â€å¹¶ä¸æ˜¯è¯´å†…éƒ¨ç”±å¼‚æ­¥ä»£ç å®ç°ï¼Œå…¶å®æœ¬èº«æ‰§è¡Œçš„è¿‡ç¨‹å’Œä»£ç éƒ½æ˜¯åŒæ­¥çš„ï¼Œåªæ˜¯åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°çš„è°ƒç”¨é¡ºåºåœ¨æ›´æ–°ä¹‹å‰ï¼Œå¯¼è‡´åœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ²¡æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åçš„å€¼ï¼Œå½¢å¼äº†æ‰€è°“çš„â€œå¼‚æ­¥â€ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡ç¬¬äºŒä¸ªå‚æ•° <code>setState(partialState, callback)</code> ä¸­çš„callbackæ‹¿åˆ°æ›´æ–°åçš„ç»“æœã€‚</p></li><li><p>setState çš„æ‰¹é‡æ›´æ–°ä¼˜åŒ–ä¹Ÿæ˜¯å»ºç«‹åœ¨â€œå¼‚æ­¥â€ï¼ˆåˆæˆäº‹ä»¶ã€é’©å­å‡½æ•°ï¼‰ä¹‹ä¸Šçš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’ŒsetTimeout ä¸­ä¸ä¼šæ‰¹é‡æ›´æ–°ï¼Œåœ¨â€œå¼‚æ­¥â€ä¸­å¦‚æœå¯¹åŒä¸€ä¸ªå€¼è¿›è¡Œå¤šæ¬¡ setState ï¼Œ setState çš„æ‰¹é‡æ›´æ–°ç­–ç•¥ä¼šå¯¹å…¶è¿›è¡Œè¦†ç›–ï¼Œå–æœ€åä¸€æ¬¡çš„æ‰§è¡Œï¼Œå¦‚æœæ˜¯åŒæ—¶ setState å¤šä¸ªä¸åŒçš„å€¼ï¼Œåœ¨æ›´æ–°æ—¶ä¼šå¯¹å…¶è¿›è¡Œåˆå¹¶æ‰¹é‡æ›´æ–°ã€‚</p></li></ul><p><a href="https://juejin.im/post/5b45c57c51882519790c7441#comment" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ajax Fetch Axiosä¹‹é—´çš„è¯¦ç»†åŒºåˆ«ä»¥åŠä¼˜ç¼ºç‚¹</title>
      <link href="/2018/07/18/study/Ajax-Fetch-Axios%E4%B9%8B%E9%97%B4%E7%9A%84%E8%AF%A6%E7%BB%86%E5%8C%BA%E5%88%AB%E4%BB%A5%E5%8F%8A%E4%BC%98%E7%BC%BA%E7%82%B9/"/>
      <url>/2018/07/18/study/Ajax-Fetch-Axios%E4%B9%8B%E9%97%B4%E7%9A%84%E8%AF%A6%E7%BB%86%E5%8C%BA%E5%88%AB%E4%BB%A5%E5%8F%8A%E4%BC%98%E7%BC%BA%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<p>å°†jQueryçš„ajaxã€axioså’Œfetchåšä¸ªç®€å•çš„æ¯”è¾ƒï¼Œæ‰€è°“ä»è€…è§ä»æ™ºè€…è§æ™ºï¼Œæœ€ç»ˆä½¿ç”¨å“ªä¸ªè¿˜æ˜¯è‡ªè¡Œæ–Ÿé…Œ</p><h1 id="jQuery-ajax"><a href="#jQuery-ajax" class="headerlink" title="jQuery ajax"></a>jQuery ajax</h1><pre><code class="js">$.ajax({   type: &#39;POST&#39;,   url: url,   data: data,   dataType: dataType,   success: function () {},   error: function () {}})</code></pre><blockquote><p>ä¼˜ç¼ºç‚¹ï¼š</p></blockquote><ul><li><p>æœ¬èº«æ˜¯é’ˆå¯¹mvcæ¨¡å¼çš„ç¼–ç¨‹ï¼Œä¸ç¬¦åˆç°åœ¨mvvmçš„æµªæ½®</p></li><li><p>åŸºäºåŸç”Ÿçš„XHRå¼€å‘ï¼ŒXHRæœ¬èº«çš„æ¶æ„ä¸æ¸…æ™°ï¼Œå·²ç»æœ‰äº†fetchçš„æ›¿ä»£æ–¹æ¡ˆ</p></li><li><p>JQueryæ•´ä¸ªé¡¹ç›®å¤ªå¤§ï¼Œå•çº¯ä½¿ç”¨ajaxå´è¦å¼•å…¥æ•´ä¸ªJQueryéå¸¸çš„ä¸åˆç†ï¼ˆé‡‡å–ä¸ªæ€§åŒ–æ‰“åŒ…çš„æ–¹æ¡ˆåˆä¸èƒ½äº«å—CDNæœåŠ¡ï¼‰</p></li></ul><p>å°½ç®¡JQueryå¯¹æˆ‘ä»¬å‰ç«¯çš„å¼€å‘å·¥ä½œæ›¾æœ‰ç€ï¼ˆç°åœ¨ä¹Ÿä»ç„¶æœ‰ç€ï¼‰æ·±è¿œçš„å½±å“ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°éšç€VUEï¼ŒREACTæ–°ä¸€ä»£æ¡†æ¶çš„å…´èµ·ï¼Œä»¥åŠESè§„èŒƒçš„å®Œå–„ï¼Œæ›´å¤šAPIçš„æ›´æ–°ï¼ŒJQueryè¿™ç§å¤§è€Œå…¨çš„JSåº“ï¼Œæœªæ¥çš„è·¯ä¼šè¶Šèµ°è¶Šçª„ã€‚</p><h1 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h1><p><a href="https://www.kancloud.cn/yunye/axios/234845" target="_blank" rel="noopener">axiosä¸­æ–‡æ–‡æ¡£</a></p><pre><code class="js">axios({    method: &#39;POST&#39;,    url: &#39;&#39;    data:{        name:&#39;zhang&#39;    }}).then(function (response){    console.log(response)}).then(function (error){    console.log(error)})</code></pre><a id="more"></a><p>Vue2.0ä¹‹åï¼Œå°¤é›¨æºªæ¨èå¤§å®¶ç”¨axiosæ›¿æ¢JQuery ajaxï¼Œæƒ³å¿…è®©Axiosè¿›å…¥äº†å¾ˆå¤šäººçš„ç›®å…‰ä¸­ã€‚Axiosæœ¬è´¨ä¸Šä¹Ÿæ˜¯å¯¹åŸç”ŸXHRçš„å°è£…ï¼Œåªä¸è¿‡å®ƒæ˜¯Promiseçš„å®ç°ç‰ˆæœ¬ï¼Œç¬¦åˆæœ€æ–°çš„ESè§„èŒƒï¼Œä»å®ƒçš„å®˜ç½‘ä¸Šå¯ä»¥çœ‹åˆ°å®ƒæœ‰ä»¥ä¸‹å‡ æ¡ç‰¹æ€§ï¼š</p><blockquote><p>ä¼˜ç¼ºç‚¹ï¼š</p></blockquote><ul><li>ä» node.js åˆ›å»º http è¯·æ±‚</li><li>æ”¯æŒ Promise API</li><li>å®¢æˆ·ç«¯æ”¯æŒé˜²æ­¢CSRF</li><li><strong>æä¾›äº†ä¸€äº›å¹¶å‘è¯·æ±‚çš„æ¥å£</strong>ï¼ˆé‡è¦ï¼Œæ–¹ä¾¿äº†å¾ˆå¤šçš„æ“ä½œ</li></ul><p>è¿™ä¸ªæ”¯æŒé˜²æ­¢CSRFå…¶å®æŒºå¥½ç©çš„ï¼Œæ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Œå°±æ˜¯è®©ä½ çš„æ¯ä¸ªè¯·æ±‚éƒ½å¸¦ä¸€ä¸ªä»cookieä¸­æ‹¿åˆ°çš„key, æ ¹æ®æµè§ˆå™¨åŒæºç­–ç•¥ï¼Œå‡å†’çš„ç½‘ç«™æ˜¯æ‹¿ä¸åˆ°ä½ cookieä¸­å¾—keyçš„ï¼Œè¿™æ ·ï¼Œåå°å°±å¯ä»¥è½»æ¾è¾¨åˆ«å‡ºè¿™ä¸ªè¯·æ±‚æ˜¯å¦æ˜¯ç”¨æˆ·åœ¨å‡å†’ç½‘ç«™ä¸Šçš„è¯¯å¯¼è¾“å…¥ï¼Œä»è€Œé‡‡å–æ­£ç¡®çš„ç­–ç•¥ã€‚</p><p>Axiosæ—¢æä¾›äº†å¹¶å‘çš„å°è£…ï¼Œä¹Ÿæ²¡æœ‰ä¸‹æ–‡ä¼šæåˆ°çš„fetchçš„å„ç§é—®é¢˜ï¼Œè€Œä¸”ä½“ç§¯ä¹Ÿè¾ƒå°ï¼Œå½“ä¹‹æ— æ„§ç°åœ¨æœ€åº”è¯¥é€‰ç”¨çš„è¯·æ±‚çš„æ–¹å¼ã€‚</p><h1 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h1><p>fetchå·ç§°æ˜¯AJAXçš„æ›¿ä»£å“ï¼Œå®ƒçš„å¥½å¤„åœ¨<a href="https://github.com/camsong/blog/issues/2" target="_blank" rel="noopener">ã€Šä¼ ç»Ÿ Ajax å·²æ­»ï¼ŒFetch æ°¸ç”Ÿã€‹</a>ä¸­æåˆ°æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><p>ç¬¦åˆå…³æ³¨åˆ†ç¦»ï¼Œæ²¡æœ‰å°†è¾“å…¥ã€è¾“å‡ºå’Œç”¨äº‹ä»¶æ¥è·Ÿè¸ªçš„çŠ¶æ€æ··æ‚åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œ<br>æ›´å¥½æ›´æ–¹ä¾¿çš„å†™æ³•ï¼Œè¯¸å¦‚ï¼š</p><pre><code class="js">try{  let response = await fetch(url);  let data = response.json();  console.log(data);}catch (e){    console.log(&quot;Oops, error&quot;, e);}</code></pre><blockquote><p>ä¼˜ç¼ºç‚¹ï¼š</p></blockquote><ul><li>ç¬¦åˆå…³æ³¨åˆ†ç¦»ï¼Œæ²¡æœ‰å°†è¾“å…¥ã€è¾“å‡ºå’Œç”¨äº‹ä»¶æ¥è·Ÿè¸ªçš„çŠ¶æ€æ··æ‚åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œ</li><li>æ›´å¥½æ›´æ–¹ä¾¿çš„å†™æ³•</li><li>æ›´åŠ åº•å±‚ï¼Œæä¾›çš„APIä¸°å¯Œï¼ˆrequest, responseï¼‰</li><li>è„±ç¦»äº†XHRï¼Œæ˜¯ESè§„èŒƒé‡Œæ–°çš„å®ç°æ–¹å¼</li></ul><p>1ï¼‰fetchtchåªå¯¹ç½‘ç»œè¯·æ±‚æŠ¥é”™ï¼Œå¯¹400ï¼Œ500éƒ½å½“åšæˆåŠŸçš„è¯·æ±‚ï¼Œéœ€è¦å°è£…å»å¤„ç†<br>2ï¼‰fetché»˜è®¤ä¸ä¼šå¸¦cookieï¼Œéœ€è¦æ·»åŠ é…ç½®é¡¹<br>3ï¼‰fetchä¸æ”¯æŒabortï¼Œä¸æ”¯æŒè¶…æ—¶æ§åˆ¶ï¼Œä½¿ç”¨setTimeoutåŠPromise.rejectçš„å®ç°çš„è¶…æ—¶æ§åˆ¶å¹¶ä¸èƒ½é˜»æ­¢è¯·æ±‚è¿‡ç¨‹ç»§ç»­åœ¨åå°è¿è¡Œï¼Œé€ æˆäº†é‡çš„æµªè´¹<br>4ï¼‰fetchæ²¡æœ‰åŠæ³•åŸç”Ÿç›‘æµ‹è¯·æ±‚çš„è¿›åº¦ï¼Œè€ŒXHRå¯ä»¥</p><p>PS: fetchçš„å…·ä½“é—®é¢˜å¤§å®¶å¯ä»¥å‚è€ƒï¼š<a href="http://undefinedblog.com/window-fetch-is-not-as-good-as-you-imagined/?utm_source=caibaojian.com" target="_blank" rel="noopener">ã€Šfetchæ²¡æœ‰ä½ æƒ³è±¡çš„é‚£ä¹ˆç¾ã€‹</a><a href="https://www.cnblogs.com/huilixieqi/p/6494380.html" target="_blank" rel="noopener">ã€Šfetchä½¿ç”¨çš„å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ³•ã€‹</a></p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å¿ƒé‡Œä¸€å®šæœ‰ä¸ªç–‘é—®ï¼Œè¿™é¬¼ä¸œè¥¿å°±æ˜¯ä¸ªåŠæ‹‰å­å·¥ç¨‹å˜›ï¼Œæˆ‘è¿˜æ˜¯å›å»ç”¨Jqueryæˆ–è€…Axiosç®—äº†â€”â€”å…¶å®æˆ‘å°±æ˜¯è¿™ä¹ˆæ‰“ç®—çš„ã€‚ä½†æ˜¯ï¼Œå¿…é¡»è¦æå‡ºçš„æ˜¯ï¼Œæˆ‘å‘ç°fetchåœ¨å‰ç«¯çš„åº”ç”¨ä¸Šæœ‰ä¸€é¡¹<code>xhr</code>æ€ä¹ˆä¹Ÿæ¯”ä¸ä¸Šçš„èƒ½åŠ›ï¼š<strong>è·¨åŸŸçš„å¤„ç†</strong>ã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“å› ä¸ºåŒæºç­–ç•¥çš„é—®é¢˜ï¼Œæµè§ˆå™¨çš„è¯·æ±‚æ˜¯å¯èƒ½éšä¾¿è·¨åŸŸçš„â€”â€”ä¸€å®šè¦æœ‰è·¨åŸŸå¤´æˆ–è€…å€ŸåŠ©JSONPï¼Œä½†æ˜¯ï¼Œ<strong>fetchä¸­å¯ä»¥è®¾ç½®modeä¸ºâ€no-corsâ€ï¼ˆä¸è·¨åŸŸï¼‰</strong>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="js">fetch(&#39;/users.json&#39;, {    method: &#39;post&#39;,    mode: &#39;no-cors&#39;,    data: {}}).then(function() { /* handle response */ });</code></pre><h1 id="ä¸ºä»€ä¹ˆè¦ç”¨axios"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨axios" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨axios"></a>ä¸ºä»€ä¹ˆè¦ç”¨axios</h1><blockquote><p>axios æ˜¯ä¸€ä¸ªåŸºäºPromise ç”¨äºæµè§ˆå™¨å’Œ nodejs çš„ HTTP å®¢æˆ·ç«¯ï¼Œå®ƒæœ¬èº«å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p></blockquote><ul><li>ä»æµè§ˆå™¨ä¸­åˆ›å»º XMLHttpRequest</li><li>ä» node.js å‘å‡º http è¯·æ±‚</li><li>æ”¯æŒ Promise API</li><li>æ‹¦æˆªè¯·æ±‚å’Œå“åº”</li><li>è½¬æ¢è¯·æ±‚å’Œå“åº”æ•°æ®</li><li>å–æ¶ˆè¯·æ±‚</li><li>è‡ªåŠ¨è½¬æ¢JSONæ•°æ®</li><li>å®¢æˆ·ç«¯æ”¯æŒé˜²æ­¢CSRF/XSRF</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Ajax </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€šè¿‡ç¤ºä¾‹æ¥å­¦ä¹ ES2016, 2017, 2018çš„æ–°ç‰¹æ€§</title>
      <link href="/2018/07/17/Js/%E9%80%9A%E8%BF%87%E7%A4%BA%E4%BE%8B%E6%9D%A5%E5%AD%A6%E4%B9%A0ES2016-2017-2018%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7/"/>
      <url>/2018/07/17/Js/%E9%80%9A%E8%BF%87%E7%A4%BA%E4%BE%8B%E6%9D%A5%E5%AD%A6%E4%B9%A0ES2016-2017-2018%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/es_16_17_18.png" alt="es678"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ–‡ä¼šè¾…ä»¥æœ‰ç”¨çš„ä¾‹å­æ¥è®²è¿°TC39ä¸­çš„18ä¸ªç‰¹æ€§ï¼Œå®ƒä»¬åˆ†åˆ«åœ¨ES2016, ES2017å’ŒES2018ä¸­åŠ å…¥ã€‚<br>é‰´äºæœ¬æ–‡å†…å®¹å¾ˆé•¿ï¼Œæˆ‘ä»¬å°†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†æ¥ä»‹ç»ï¼Œæ­¤ä¸ºç¬¬ä¸€éƒ¨åˆ†ã€‚</p><h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2><h3 id="Array-prototype-includes"><a href="#Array-prototype-includes" class="headerlink" title="Array.prototype.includes"></a>Array.prototype.includes</h3><p>includesæ˜¯ä¸€ä¸ªArrayä¸Šå¾ˆæœ‰ç”¨çš„å‡½æ•°ï¼Œç”¨äºå¿«é€ŸæŸ¥æ‰¾æ•°ç»„ä¸­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ ã€‚(åŒ…æ‹¬NaNï¼Œæ‰€ä»¥å’ŒindexOfä¸ä¸€æ ·)ã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/includes.png" alt="includes"></p><h3 id="æŒ‡æ•°å‡½æ•°çš„ä¸­ç¼€å½¢å¼"><a href="#æŒ‡æ•°å‡½æ•°çš„ä¸­ç¼€å½¢å¼" class="headerlink" title="æŒ‡æ•°å‡½æ•°çš„ä¸­ç¼€å½¢å¼"></a>æŒ‡æ•°å‡½æ•°çš„ä¸­ç¼€å½¢å¼</h3><p>åŠ /å‡æ³•æˆ‘ä»¬é€šå¸¸éƒ½æ˜¯ç”¨å…¶ä¸­ç¼€å½¢å¼ï¼Œç›´è§‚æ˜“æ‡‚ã€‚åœ¨ECMAScript2016ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>**</code>æ¥æ›¿ä»£<code>Math.pow</code>ã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/pow.png" alt="pow"><br><a id="more"></a></p><h2 id="ES7"><a href="#ES7" class="headerlink" title="ES7"></a>ES7</h2><h3 id="Object-values"><a href="#Object-values" class="headerlink" title="Object.values()"></a>Object.values()</h3><p><code>Object.values()</code>å‡½æ•°å’Œ<code>Object.keys()</code>å¾ˆç›¸ä¼¼ï¼Œå®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ä¸­è‡ªå·±å±æ€§çš„æ‰€æœ‰å€¼(é€šè¿‡åŸå‹é“¾ç»§æ‰¿çš„ä¸ç®—)ã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/objvalues.png" alt="objvalues"></p><h3 id="Object-entries"><a href="#Object-entries" class="headerlink" title="Object.entries()"></a>Object.entries()</h3><p><code>Object.entries()</code>å’Œ<code>Object.keys</code>ç›¸å…³ï¼Œä¸è¿‡entries()å‡½æ•°ä¼šå°†keyå’Œvalueä»¥æ•°ç»„çš„å½¢å¼éƒ½è¿”å›ã€‚è¿™æ ·ï¼Œä½¿ç”¨å¾ªç¯æˆ–åˆ™å°†å¯¹è±¡è½¬ä¸ºMapå°±å¾ˆæ–¹ä¾¿äº†ã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/objentry1.png" alt="objentry1"></p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/objentry2.png" alt="objentry2"></p><h3 id="å­—ç¬¦ä¸²è¿½åŠ "><a href="#å­—ç¬¦ä¸²è¿½åŠ " class="headerlink" title="å­—ç¬¦ä¸²è¿½åŠ "></a>å­—ç¬¦ä¸²è¿½åŠ </h3><p>æä¾›äº†ä¸¤ä¸ªå­—ç¬¦ä¸²è¿½åŠ çš„æ–¹æ³•<code>String.prototype.padStart</code>å’Œ<code>String.prototype.padEnd</code>ï¼Œæ–¹ä¾¿æˆ‘ä»¬å°†ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿½åŠ åˆ°æŸä¸ªå­—ç¬¦ä¸²çš„å¤´å°¾ã€‚</p><pre><code class="js">&#39;someString&#39;.padStart(numberOfCharcters [,stringForPadding]);&#39;5&#39;.padStart(10) // &#39;          5&#39;&#39;5&#39;.padStart(10, &#39;=*&#39;) //&#39;=*=*=*=*=5&#39;&#39;5&#39;.padEnd(10) // &#39;5         &#39;&#39;5&#39;.padEnd(10, &#39;=*&#39;) //&#39;5=*=*=*=*=&#39;</code></pre><p>è¿™ä¸ªå¯¹äºæ ¼å¼åŒ–è¾“å‡ºå¾ˆæœ‰ç”¨ï¼</p><h4 id="padStartä¾‹å­"><a href="#padStartä¾‹å­" class="headerlink" title="padStartä¾‹å­"></a>padStartä¾‹å­</h4><p>æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸åŒé•¿åº¦å…ƒç´ çš„æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥å¾€å‰é¢è¿½åŠ 0æ¥ä½¿å¾—ä»–ä»¬æ‰“å°çš„é•¿åº¦éƒ½ä¸º10ã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/padStart.png" alt="padStart"></p><h4 id="padEndä¾‹å­"><a href="#padEndä¾‹å­" class="headerlink" title="padEndä¾‹å­"></a>padEndä¾‹å­</h4><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/padEnd.png" alt="padEndä¾‹å­"></p><pre><code class="js">const cars = {  &#39;ğŸš™BMW&#39;: &#39;10&#39;,  &#39;ğŸš˜Tesla&#39;: &#39;5&#39;,  &#39;ğŸš–Lamborghini&#39;: &#39;0&#39;}Object.entries(cars).map(([name, count]) =&gt; {  //padEnd appends &#39; -&#39; until the name becomes 20 characters  //padStart prepends &#39;0&#39; until the count becomes 3 characters.  console.log(`${name.padEnd(20, &#39; -&#39;)} Count: ${count.padStart(3, &#39;0&#39;)}`)});//Prints..// ğŸš™BMW - - - - - - -  Count: 010// ğŸš˜Tesla - - - - - -  Count: 005// ğŸš–Lamborghini - - -  Count: 000</code></pre><h4 id="ä½¿ç”¨padStartå’ŒpadEndæ¥æ ¼å¼åŒ–Emojiså’Œå…¶ä»–å®½å­—ç¬¦"><a href="#ä½¿ç”¨padStartå’ŒpadEndæ¥æ ¼å¼åŒ–Emojiså’Œå…¶ä»–å®½å­—ç¬¦" class="headerlink" title="ä½¿ç”¨padStartå’ŒpadEndæ¥æ ¼å¼åŒ–Emojiså’Œå…¶ä»–å®½å­—ç¬¦"></a>ä½¿ç”¨padStartå’ŒpadEndæ¥æ ¼å¼åŒ–Emojiså’Œå…¶ä»–å®½å­—ç¬¦</h4><p>Emojiså’Œå®½å­—ç¬¦ä½¿ç”¨å¤šä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œå› æ­¤å¯èƒ½ä½¿ç”¨padStartå’ŒpadEndçš„ç»“æœå¹¶éå¦‚ä½ æ‰€æ„¿ã€‚</p><p>æ¯”å¦‚ï¼šæˆ‘ä»¬è¿½åŠ â¤ï¸åˆ°heartå‰é¢ï¼š</p><pre><code class="js">//ä½ ä¼šå‘ç°ä¸ä»…æ²¡æœ‰5ä¸ªæ¡ƒå¿ƒï¼Œæœ‰ä¸€ä¸ªæ¡ƒå¿ƒè¿˜å¾ˆå¥‡æ€ªã€‚&#39;heart&#39;.padStart(10, &quot;â¤ï¸&quot;); // prints.. &#39;â¤ï¸â¤ï¸â¤heart&#39;</code></pre><p>è¿™æ˜¯å› ä¸ºâ¤ï¸å æœ‰2ä¸ªå­—èŠ‚(â€˜\u2764\uFE0Fâ€™)ï¼Œè€Œheartæœ¬èº«æœ‰5ä¸ªå­—èŠ‚ï¼Œå› æ­¤åªæœ‰5ä¸ªå­—èŠ‚çš„ä½™åœ°ã€‚æ‰€ä»¥åªæ˜¯è¿½åŠ äº†2ä¸ªåŠçš„æ¡ƒå¿ƒã€‚æœ€åè¿½åŠ çš„â€™\u2764â€™ä¼šæ˜¾ç¤ºä¸ºå°é»‘æ¡ƒå¿ƒã€‚</p><h3 id="Object-getOwnPropertyDescriptors"><a href="#Object-getOwnPropertyDescriptors" class="headerlink" title="Object.getOwnPropertyDescriptors"></a>Object.getOwnPropertyDescriptors</h3><p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œç”šè‡³åŒ…æ‹¬get/setå‡½æ•°ã€‚ES2017åŠ å…¥è¿™ä¸ªå‡½æ•°çš„ä¸»è¦åŠ¨æœºåœ¨äºæ–¹ä¾¿å°†ä¸€ä¸ªå¯¹è±¡æ·±åº¦æ‹·è´ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶å¯ä»¥å°†getter/setteræ‹·è´ã€‚å’ŒObject.assignä¸åŒã€‚</p><p>Object.assignå°†ä¸€ä¸ªå¯¹è±¡é™¤äº†getter/setterä»¥å¤–çš„éƒ½æ·±åº¦æ‹·è´äº†ã€‚</p><p>å°†åŸå¯¹è±¡Caræ‹·è´åˆ°ElectricCarï¼Œä½ å°±ä¼šå‘ç°Object.getOwnPropertyDescriptorsæ‹·è´äº† getterå’Œsetterï¼Œè€ŒObject.assignæ²¡æœ‰ã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/objcopy.png" alt="objcopy"></p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/objcopy2.png" alt="objcopy2"></p><h3 id="å…è®¸åœ¨å‡½æ•°å‚æ•°æœ€åæ·»åŠ é€—å·"><a href="#å…è®¸åœ¨å‡½æ•°å‚æ•°æœ€åæ·»åŠ é€—å·" class="headerlink" title="å…è®¸åœ¨å‡½æ•°å‚æ•°æœ€åæ·»åŠ é€—å·"></a>å…è®¸åœ¨å‡½æ•°å‚æ•°æœ€åæ·»åŠ é€—å·</h3><p>è¿™æ˜¯ä¸€ä¸ªå¾ˆå°çš„æ”¹åŠ¨ï¼Œæ–¹ä¾¿gitç®—æ³•æ›´åŠ æ–¹ä¾¿åŒºåˆ†ä»£ç èŒè´£ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªè¯¦ç»†çš„ä¾‹å­æ¥ç†è§£ï¼š</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/gitcomma.png" alt="gitcomma"></p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥åœ¨æœ€åæ·»åŠ é€—å·ã€‚</p><h3 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async/Await"></a>Async/Await</h3><p>è¿„ä»Šä¸ºæ­¢ï¼Œæˆ‘ä»‹ç»çš„ç‰¹æ€§ä¸­æœ€æœ‰ç”¨çš„å°±å±è¿™ä¸ªåŠŸèƒ½äº†ã€‚Asyncå‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ‘†è„±â€œå›è°ƒåœ°ç‹±â€ï¼Œå¹¶ä¸”æ•´ä¸ªä»£ç ä¼šæ›´åŠ ç®€æ´ã€‚</p><p>asyncå…³é”®å­—å‘Šè¯‰JavaScriptç¼–è¯‘å™¨å¯¹äºæ ‡å®šçš„å‡½æ•°è¦åŒºåˆ«å¯¹å¾…ã€‚å½“ç¼–è¯‘å™¨é‡åˆ°awaitå‡½æ•°çš„æ—¶å€™ä¼šæš‚åœã€‚å®ƒä¼šç­‰åˆ°awaitæ ‡å®šçš„å‡½æ•°è¿”å›çš„promiseã€‚è¯¥promiseè¦ä¹ˆå¾—åˆ°ç»“æœã€è¦ä¹ˆrejectã€‚</p><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼ŒgetAmountå‡½æ•°è°ƒç”¨getUserå’ŒgetBankBalanceä¸¤ä¸ªå¼‚æ­¥å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç”¨promiseæ¥å®ç°å®ƒï¼Œä¸è¿‡ç”¨async awaitæ›´åŠ ç®€æ´ã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/async_await.png" alt="async_await"></p><h4 id="asyncå‡½æ•°è¿”å›Promise"><a href="#asyncå‡½æ•°è¿”å›Promise" class="headerlink" title="asyncå‡½æ•°è¿”å›Promise"></a>asyncå‡½æ•°è¿”å›Promise</h4><p>å¦‚æœä½ æƒ³è·å–ä¸€ä¸ªasyncå‡½æ•°çš„ç»“æœï¼Œä½ éœ€è¦ä½¿ç”¨Promiseçš„thenè¯­æ³•ã€‚</p><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³ç”¨console.logæ¥æ‰“å°doubleAndAddçš„ç»“æœï¼Œå¯ä»¥ä½¿ç”¨thenè¯­æ³•ï¼Œå°†console.logå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/async_promise.png" alt="async_promise"></p><h4 id="å¹¶è¡Œå¤„ç†"><a href="#å¹¶è¡Œå¤„ç†" class="headerlink" title="å¹¶è¡Œå¤„ç†"></a>å¹¶è¡Œå¤„ç†</h4><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ˜¾ç¤ºåœ°è°ƒç”¨äº†awaitä¸¤æ¬¡ï¼Œå› ä¸ºæ¯æ¬¡éƒ½ç­‰å¾…äº†1ç§’é’Ÿï¼Œå› æ­¤æ€»è®¡ä¸¤ç§’é’Ÿã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Promise.allå‡½æ•°æ¥è®©ä»–ä»¬å¹¶è¡Œå¤„ç†ã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/await_parallel.png" alt="await_parallel"></p><h4 id="async-awaitçš„é”™è¯¯å¤„ç†"><a href="#async-awaitçš„é”™è¯¯å¤„ç†" class="headerlink" title="async/awaitçš„é”™è¯¯å¤„ç†"></a>async/awaitçš„é”™è¯¯å¤„ç†</h4><p>æœ‰å¾ˆå¤šæ–¹æ³•æ¥å¤„ç†é”™è¯¯ã€‚</p><ul><li>æ–¹æ³•1ï¼šåœ¨å‡½æ•°ä¸­ä½¿ç”¨try-catch</li></ul><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/trycatch.png" alt="trycatch"></p><ul><li>æ–¹æ³•2ï¼šcatchæ¯ä¸€ä¸ªawaitè¡¨è¾¾å¼</li></ul><p>å› ä¸ºæ¯ä¸€ä¸ªawaitè¡¨è¾¾å¼éƒ½ä¼šè¿”å›Promiseï¼Œä½ å¯ä»¥å¯¹ä¸€ä¸ªè¿›è¡Œcatchæ“ä½œã€‚</p><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/await_catch.png" alt="await_catch"></p><ul><li>æ–¹æ³•3ï¼šcatchæ•´ä¸ªasync-awaitå‡½æ•°</li></ul><p><img src="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/catch_all.png" alt="catch_all"></p><p><a href="https://blog.fundebug.com/2018/07/17/new_in_es16_17_18/" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šå›¾è§£HTTPå­¦ä¹ ã€‹ç¬”è®°</title>
      <link href="/2018/07/13/HTTP/%E3%80%8A%E5%9B%BE%E8%A7%A3HTTP%E5%AD%A6%E4%B9%A0%E3%80%8B%E7%AC%94%E8%AE%B0/"/>
      <url>/2018/07/13/HTTP/%E3%80%8A%E5%9B%BE%E8%A7%A3HTTP%E5%AD%A6%E4%B9%A0%E3%80%8B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»ä¸€é“é¢˜å¼•å‘çš„æ€è€ƒ"><a href="#ä»ä¸€é“é¢˜å¼•å‘çš„æ€è€ƒ" class="headerlink" title="ä»ä¸€é“é¢˜å¼•å‘çš„æ€è€ƒ"></a>ä»ä¸€é“é¢˜å¼•å‘çš„æ€è€ƒ</h1><p><a href="https://zhanghao-web.github.io/2018/07/10/HTTP/%E4%BB%8E%E8%BE%93%E5%85%A5url%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%E5%88%B0%E5%BA%95%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88/#more">ä»è¾“å…¥ç½‘é¡µåˆ°å‘ˆç°ç½‘é¡µé¡µé¢è¿™ä¸€è¿‡ç¨‹ç»å†äº†ä»€ä¹ˆï¼Ÿ</a></p><h2 id="HTTPçš„è¯ç”Ÿ"><a href="#HTTPçš„è¯ç”Ÿ" class="headerlink" title="HTTPçš„è¯ç”Ÿ"></a>HTTPçš„è¯ç”Ÿ</h2><p>åœ¨æ·±å…¥äº†è§£HTTPä¹‹å‰ï¼Œå…ˆä»‹ç»HTTPè¯ç”Ÿçš„èƒŒæ™¯ã€‚cernçš„timbernersLee æå‡ºä¸€ç§èƒ½è®©è¿œéš”ä¸¤åœ°çš„ç ”ç©¶è€…ä»¬å…±äº«çŸ¥è¯†ç‚¹çš„è®¾æƒ³ã€‚</p><h2 id="ç½‘ç»œåŸºç¡€-TCP-IP"><a href="#ç½‘ç»œåŸºç¡€-TCP-IP" class="headerlink" title="ç½‘ç»œåŸºç¡€ TCP/IP"></a>ç½‘ç»œåŸºç¡€ TCP/IP</h2><p>é€šå¸¸ä½¿ç”¨çš„ç½‘ç»œï¼ˆåŒ…æ‹¬äº’è”ç½‘ï¼‰æ˜¯åœ¨TCP/IPåè®®æ—çš„åŸºç¡€ä¸Šè¿ä½œçš„ã€‚è€ŒHTTPå±äºå®ƒå†…éƒ¨çš„ä¸€ä¸ªå­é›†ã€‚</p><p>TCP/IPåè®®æ—æŒ‰å±‚æ¬¡åˆ†ä¸ºä»¥ä¸‹4å±‚</p><ul><li><p>åº”ç”¨å±‚</p><p>åº”ç”¨å±‚å†³å®šäº†å‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡æ—¶é€šä¿¡çš„æ´»åŠ¨ã€‚</p><p>TCP/IPåè®®æ—é¢„å­˜äº†å„ç±»é€šç”¨çš„åº”ç”¨æœåŠ¡ï¼Œæ¯”å¦‚ï¼ŒFTP(file transfer protocol,æ–‡ä»¶ä¼ è¾“åè®®)å’Œ<br>DNS(Domain Name system)åŸŸåç³»ç»ŸæœåŠ¡å°±æ˜¯å…¶ä¸­ä¸¤ç±»ã€‚</p><p>HTTPåè®®ä¹Ÿå¤„äºè¯¥å±‚ã€‚</p></li><li><p>ä¼ è¾“å±‚</p></li></ul><p>ä¼ è¾“å±‚å¯¹ä¸Šå±‚åº”ç”¨å±‚ï¼Œæä¾›å¤„äºç½‘ç»œè¿æ¥ä¸­çš„ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚</p><p>åœ¨ä¼ è¾“å±‚ä¸­æœ‰ä¸¤ä¸ªæ€§è´¨ä¸åŒçš„åè®®ï¼šTCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’ŒUDPï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰</p><ul><li>ç½‘ç»œå±‚ï¼ˆåˆåç½‘ç»œäº’è”å±‚ï¼‰</li></ul><p>ç½‘ç»œå±‚ç”¨æ¥å¤„ç†åœ¨ç½‘ç»œä¸ŠæµåŠ¨çš„æ•°æ®åŒ…ã€‚ä¸å¯¹æ–¹è®¡ç®—æœºä¹‹é—´é€šè¿‡å¤šå°è®¡ç®—æœºæˆ–ç½‘ç»œè®¾å¤‡è¿›è¡Œä¼ è¾“æ—¶ï¼Œç½‘ç»œå±‚æ‰€èµ·çš„ä½œç”¨å°±æ˜¯åœ¨ä¼—å¤šçš„é€‰é¡¹å†…é€‰æ‹©ä¸€æ¡ä¼ è¾“è·¯çº¿ã€‚</p><ul><li>æ•°æ®é“¾è·¯å±‚ï¼ˆåˆåç½‘ç»œæ¥å£å±‚ï¼‰</li></ul><p>ç”¨æ¥å¤„ç†è¿æ¥ç½‘ç»œçš„ç¡¬ä»¶éƒ¨åˆ†ã€‚åŒ…æ‹¬æ§åˆ¶æ“ä½œç³»ç»Ÿï¼Œç¡¬ä»¶çš„è®¾å¤‡é©±åŠ¨ï¼ŒNIC(ç½‘ç»œé€‚é…å™¨ï¼Œå³ç½‘å¡)ï¼ŒåŠå…‰çº¤ç­‰ç‰©ç†å¯è§éƒ¨åˆ†ï¼Œ</p><p>åˆ©ç”¨TCP/IPåè®®æ—è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œä¼šé€šè¿‡åˆ†å±‚é¡ºåºä¸å¯¹æ–¹è¿›è¡Œé€šä¿¡ã€‚<strong>å‘é€ç«¯ä»åº”ç”¨å±‚å¾€ä¸‹èµ°ï¼Œæ¥æ”¶ç«¯åˆ™å¾€åº”ç”¨å±‚å¾€ä¸‹èµ°ã€‚å‘é€ç«¯æ¯é€šè¿‡ä¸€å±‚åˆ™å¢åŠ é¦–éƒ¨ï¼Œæ¥æ”¶ç«¯æ¯é€šè¿‡ä¸€å±‚åˆ™åˆ é™¤é¦–éƒ¨</strong>ã€‚</p><p>TCPä½äºä¼ è¾“å±‚ï¼Œæä¾›å¯é çš„å­—èŠ‚æµæœåŠ¡</p><h3 id="è´Ÿè´£åŸŸåè§£æçš„DNSæœåŠ¡"><a href="#è´Ÿè´£åŸŸåè§£æçš„DNSæœåŠ¡" class="headerlink" title="è´Ÿè´£åŸŸåè§£æçš„DNSæœåŠ¡"></a>è´Ÿè´£åŸŸåè§£æçš„DNSæœåŠ¡</h3><p>DNSå’ŒHTTPåè®®ä»¥ä¸€æ ·ä½äºåº”ç”¨çš„åè®®ã€‚å®ƒæä¾›åŸŸååˆ°IPåœ°å€ä¹‹é—´çš„è§£ææœåŠ¡</p><h3 id="URIå’ŒURL"><a href="#URIå’ŒURL" class="headerlink" title="URIå’ŒURL"></a>URIå’ŒURL</h3><p>ä¸URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰ç›¸æ¯”ï¼Œæˆ‘ä»¬æ›´ç†Ÿæ‚‰URLï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰ã€‚URIç”¨å­—ç¬¦ä¸²æ ‡è¯†æŸä¸€äº’è”ç½‘èµ„æºï¼Œè€ŒURLè¡¨ç¤ºèµ„æºçš„åœ°ç‚¹ã€‚å¯è§URLæ˜¯URIçš„å­é›†ã€‚</p><h2 id="ç®€å•çš„HTTPåè®®"><a href="#ç®€å•çš„HTTPåè®®" class="headerlink" title="ç®€å•çš„HTTPåè®®"></a>ç®€å•çš„HTTPåè®®</h2><p>è¯·æ±‚è®¿é—®æ–‡æœ¬æˆ–å›¾åƒèµ„æºç­‰çš„ä¸€ç«¯ç§°ä¸ºå®¢æˆ·ç«¯ï¼Œè€Œæä¾›èµ„æºå“åº”çš„ä¸€ç«¯ç§°ä¸ºæœåŠ¡ç«¯</p><p>è¯·æ±‚æŠ¥æ–‡<strong>ç”± è¯·æ±‚æ–¹æ³•ï¼Œè¯·æ±‚URIï¼Œåè®®ç‰ˆæœ¬ï¼Œå¯é€‰è¯·æ±‚é¦–éƒ¨å­—æ®µå’Œå†…å®¹å®ä½“æ„æˆçš„</strong>ã€‚</p><p>å“åº”æŠ¥æ–‡<strong>ç”±åè®®ç‰ˆæœ¬ï¼ŒçŠ¶æ€ç ï¼ˆè¡¨ç¤ºè¯·æ±‚æˆåŠŸæˆ–å¤±è´¥çš„æ•°å­—ä»£ç ï¼‰ï¼Œç”¨ä»¥è§£é‡ŠçŠ¶æ€ç çš„åŸå› çŸ­è¯­ï¼Œå¯é€‰çš„å“åº”é¦–éƒ¨å­—æ®µä»¥åŠå®ä½“ä¸»ä½“æ„æˆ</strong>ã€‚</p><h3 id="HTTPæ˜¯ä¸ä¿å­˜çŠ¶æ€çš„åè®®ï¼ˆå³æ— çŠ¶æ€åè®®ï¼‰"><a href="#HTTPæ˜¯ä¸ä¿å­˜çŠ¶æ€çš„åè®®ï¼ˆå³æ— çŠ¶æ€åè®®ï¼‰" class="headerlink" title="HTTPæ˜¯ä¸ä¿å­˜çŠ¶æ€çš„åè®®ï¼ˆå³æ— çŠ¶æ€åè®®ï¼‰"></a>HTTPæ˜¯ä¸ä¿å­˜çŠ¶æ€çš„åè®®ï¼ˆå³æ— çŠ¶æ€åè®®ï¼‰</h3><p>HTTPåè®®è‡ªèº«ä¸å¯¹è¯·æ±‚å’Œå“åº”ä¹‹é—´çš„é€šä¿¡çŠ¶æ€è¿›è¡Œä¿å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨HTTPè¿™ä¸ªçº§åˆ«ï¼Œåè®®å¯¹äºå‘é€è¿‡çš„è¯·æ±‚æˆ–å“åº”éƒ½ä¸åšæŒä¹…åŒ–å¤„ç†ã€‚</p><p>è¿™æ ·æ˜¯ä¸ºäº†æ›´å¿«åœ°å¤„ç†å¤§é‡äº‹åŠ¡ï¼Œç¡®ä¿åè®®çš„å¯ä¼¸ç¼©æ€§ï¼Œè€Œç‰¹æ„æŠŠHTTPåè®®è®¾è®¡æˆå¦‚æ­¤ç®€å•çš„ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ç§æ— çŠ¶æ€çš„é—®é¢˜ï¼Œäºæ˜¯å¼•å…¥äº†cookieæŠ€æœ¯ã€‚æœ‰äº†cookieå†ç”¨HTTPåè®®é€šä¿¡ï¼Œå°±å¯ä»¥ç®¡ç†çŠ¶æ€äº†ã€‚<br><a id="more"></a></p><h3 id="å‘ŠçŸ¥æœåŠ¡å™¨æ„å›¾çš„HTTPæ–¹æ³•"><a href="#å‘ŠçŸ¥æœåŠ¡å™¨æ„å›¾çš„HTTPæ–¹æ³•" class="headerlink" title="å‘ŠçŸ¥æœåŠ¡å™¨æ„å›¾çš„HTTPæ–¹æ³•"></a>å‘ŠçŸ¥æœåŠ¡å™¨æ„å›¾çš„HTTPæ–¹æ³•</h3><ul><li><p>GET è·å–èµ„æº</p></li><li><p>POST ä¼ è¾“å®ä½“ä¸»ä½“</p></li><li><p>PUT ä¼ è¾“æ–‡ä»¶</p></li><li><p>HEAD è·å–æŠ¥æ–‡å¤´éƒ¨</p></li><li><p>DELETE åˆ é™¤æ–‡ä»¶</p></li><li><p>OPTIONS è¯¢é—®æ”¯æŒçš„æ–¹æ³•</p></li><li><p>TRACE è¿½è¸ªè·¯å¾„</p></li><li><p>CONNECT è¦æ±‚ç”¨éš§é“åè®®è¿æ¥ä»£ç†</p></li></ul><p>å› ä¸ºPUT å’Œ DELETEæ–¹æ³•ä¸€æ ·ä¸å¸¦éªŒè¯æœºåˆ¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥å­˜åœ¨å®‰å…¨æ€§ã€‚ä¸å¸¸ç”¨</p><h3 id="æŒä¹…è¿æ¥èŠ‚çœé€šä¿¡é‡"><a href="#æŒä¹…è¿æ¥èŠ‚çœé€šä¿¡é‡" class="headerlink" title="æŒä¹…è¿æ¥èŠ‚çœé€šä¿¡é‡"></a>æŒä¹…è¿æ¥èŠ‚çœé€šä¿¡é‡</h3><p>HTTPåè®®çš„åˆå§‹ç‰ˆæœ¬ä¸­ï¼Œæ¯è¿›è¡Œä¸€æ¬¡HTTPé€šä¿¡å°±è¦æ–­å¼€ä¸€æ¬¡TCPé“¾æ¥ï¼Œå¦‚æœè¦è¯·æ±‚ä¸€ä¸ªåŒ…å«å¾ˆå¤šå›¾ç‰‡èµ„æºçš„ç½‘ç«™ï¼Œä¼šè¿›è¡Œå¾ˆå¤šæ¬¡TCPçš„è¿æ¥å’Œä¸­æ–­ï¼Œå¢åŠ é€šä¿¡é‡çš„å¼€é”€ã€‚</p><p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒHTTP/1.1å’Œä¸€éƒ¨åˆ†HTTP/1.0æƒ³å‡ºäº†æŒä¹…è¿æ¥ï¼ˆä¹Ÿæˆä¸ºHTTP keep-aliveï¼‰</p><h4 id="ç®¡é“åŒ–"><a href="#ç®¡é“åŒ–" class="headerlink" title="ç®¡é“åŒ–"></a>ç®¡é“åŒ–</h4><p>æŒä¹…è¿æ¥ä½¿å¾—å¤šæ•°è¯·æ±‚ä»¥ç®¡é“åŒ–ï¼ˆpipeliningï¼‰æ–¹å¼å‘é€æˆä¸ºå¯èƒ½ã€‚ä»å‰å‘é€è¯·æ±‚åéœ€è¦ç­‰å¾…å¹¶æ”¶åˆ°å“åº”ã€‚ç®¡é“åŒ–æŠ€æœ¯çš„å‡ºç°è§£å†³äº†ä¸ç”¨ç­‰å¾…å“åº”äº¦å¯ç›´æ¥å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚</p><p>ç®¡é“åŒ–æŠ€æœ¯è¦æ¯”æŒä¹…è¿æ¥è¿˜è¦å¿«ã€‚</p><h3 id="ä½¿ç”¨cookieçš„çŠ¶æ€ç®¡ç†"><a href="#ä½¿ç”¨cookieçš„çŠ¶æ€ç®¡ç†" class="headerlink" title="ä½¿ç”¨cookieçš„çŠ¶æ€ç®¡ç†"></a>ä½¿ç”¨cookieçš„çŠ¶æ€ç®¡ç†</h3><p>cookieæŠ€æœ¯é€šè¿‡åœ¨è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å†™å…¥cookieä¿¡æ¯æ¥æ§åˆ¶å®¢æˆ·ç«¯çš„çŠ¶æ€ã€‚</p><p>cookieä¼šæ ¹æ®ä»æœåŠ¡å™¨ç«¯å‘é€çš„å“åº”æŠ¥æ–‡å†…çš„ä¸€ä¸ªå«åšSet-Cookieçš„é¦–éƒ¨å­—æ®µä¿¡æ¯ï¼Œé€šçŸ¥å®¢æˆ·ç«¯ä¿å­˜Cookieã€‚å½“ä¸‹æ¬¡å®¢æˆ·ç«¯åœ¨å¾€è¯¥æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­åŠ å…¥cookieå€¼åå‘é€å‡ºå»</p><h2 id="HTTPæŠ¥æ–‡å†…çš„HTTPä¿¡æ¯"><a href="#HTTPæŠ¥æ–‡å†…çš„HTTPä¿¡æ¯" class="headerlink" title="HTTPæŠ¥æ–‡å†…çš„HTTPä¿¡æ¯"></a>HTTPæŠ¥æ–‡å†…çš„HTTPä¿¡æ¯</h2><p>HTTPæŠ¥æ–‡å¤§è‡´å¯åˆ†ä¸ºæŠ¥æ–‡é¦–éƒ¨å’ŒæŠ¥æ–‡ä¸»ä½“ä¸¤å—ã€‚</p><p><strong>æŠ¥æ–‡ä¸»ä½“å’Œå®ä½“ä¸»ä½“çš„å·®å¼‚</strong></p><p>æŠ¥æ–‡ï¼ˆmessageï¼‰æ˜¯HTTPé€šä¿¡çš„åŸºæœ¬å•ä½ã€‚ç”±8ä½ç»„å­—èŠ‚æµç»„æˆï¼Œé€šè¿‡HTTPé€šä¿¡ä¼ è¾“ã€‚</p><p>å®ä½“ï¼ˆentityï¼‰ä½œä¸ºè¯·æ±‚æˆ–å“åº”çš„æœ‰æ•ˆè½½è·æ•°æ®è¢«ä¼ è¾“ï¼Œå…¶å†…å®¹ç”±å®ä½“é¦–éƒ¨å’Œå®ä½“ä¸»ä½“ç»„æˆã€‚</p><p>é€šå¸¸ï¼ŒæŠ¥æ–‡ä¸»ä½“ç­‰äºå®ä½“ä¸»ä½“ï¼Œåªæœ‰å½“ä¼ è¾“è¿‡ç¨‹ä¸­è¿›è¡Œç¼–ç æ“ä½œæ—¶ï¼Œå®ä½“ä¸»ä½“çš„å†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œæ‰å¯¼è‡´å®ƒå’ŒæŠ¥æ–‡ä¸»ä½“äº§ç”Ÿå·®å¼‚ã€‚</p><p><strong>å‹ç¼©ä¼ è¾“çš„å†…å®¹ç¼–ç </strong></p><p>å¸¸è§çš„å†…å®¹ç¼–ç æœ‰ä»¥ä¸‹å‡ ç§</p><ul><li>gzipï¼ˆGNU zipï¼‰</li><li>compressï¼ˆUNIXç³»ç»Ÿçš„æ ‡å‡†å‹ç¼©ï¼‰</li><li>deflateï¼ˆzlibï¼‰</li><li>identityï¼ˆä¸è¿›è¡Œç¼–ç ï¼‰</li></ul><p><strong>åˆ†å‰²å‘é€çš„åˆ†å—ä¼ è¾“ç¼–ç </strong></p><p>è¿™ç§æŠŠå®ä½“ä¸»ä½“åˆ†å—çš„åŠŸèƒ½ç§°ä¸ºåˆ†å—ä¼ è¾“ç¼–ç </p><p>åˆ†å—ä¼ è¾“ç¼–ç ä¼šå°†å®ä½“ä¸»ä½“åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼ˆå—ï¼‰ã€‚æ¯ä¸€å—éƒ½ä¼šç”¨åå…­è¿›åˆ¶æ¥æ ‡è®°å—çš„å¤§å°ï¼Œè€Œå®ä½“ä¸»ä½“çš„æœ€åä¸€å—ä¼šä½¿ç”¨â€œ0ï¼ˆCR+LFï¼‰â€æ¥æ ‡è®°ã€‚</p><p><strong>å‘é€å¤šç§æ•°æ®çš„å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆ</strong></p><p>å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆåŒ…å«çš„å¯¹è±¡å¦‚ä¸‹</p><ul><li><p>multipart/form-data</p><p>åœ¨webè¡¨å•æ–‡ä»¶ä¸Šä¼ æ—¶ä½¿ç”¨</p></li><li><p>multipart/byteranges</p><p>çŠ¶æ€ç 206å“åº”æŠ¥æ–‡åŒ…å«äº†å¤šä¸ªèŒƒå›´çš„å†…å®¹æ—¶ä½¿ç”¨</p></li></ul><p><strong>è·å–éƒ¨åˆ†å†…å®¹çš„èŒƒå›´è¯·æ±‚</strong></p><p>è¦å®ç°è¯¥åŠŸèƒ½éœ€è¦æŒ‡å®šä¸‹è½½çš„å®ä½“èŒƒå›´ï¼Œåƒè¿™æ ·ï¼ŒæŒ‡å®šèŒƒå›´å‘é€çš„è¯·æ±‚å«åšèŒƒå›´è¯·æ±‚ã€‚</p><p><strong>å†…å®¹åå•†è¿”å›æœ€åˆé€‚çš„å†…å®¹</strong></p><p>å†…å®¹åå•†æœºåˆ¶æ˜¯æŒ‡å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å°±å“åº”çš„èµ„æºå†…å®¹è¿›è¡Œäº¤æ¶‰ï¼Œç„¶åæä¾›ç»™å®¢æˆ·ç«¯æœ€ä¸ºé€‚åˆçš„èµ„æºã€‚å†…å®¹åå•†ä¼šä»¥å“åº”èµ„æºçš„è¯­è¨€ï¼Œå­—ç¬¦é›†ï¼Œç¼–ç æ–¹å¼ç­‰ä½œä¸ºåˆ¤æ–­çš„åŸºå‡†ã€‚</p><p>åŒ…å«åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­çš„æŸäº›é¦–éƒ¨å­—æ®µå°±æ˜¯åˆ¤æ–­çš„åŸºå‡†ã€‚</p><ul><li>Accept</li><li>Accept-Charset</li><li>Accept-Encoding</li><li>Accept-Language</li><li>Content-Language</li></ul><p>å†…å®¹åå•†æŠ€æœ¯æœ‰ä»¥ä¸‹3ä¸­ç±»å‹</p><ul><li>æœåŠ¡å™¨é©±åŠ¨åå•†</li><li>å®¢æˆ·ç«¯é©±åŠ¨åå•†</li><li>é€æ˜åå•†</li></ul><h2 id="è¿”å›ç»“æœçš„HTTPçŠ¶æ€ç "><a href="#è¿”å›ç»“æœçš„HTTPçŠ¶æ€ç " class="headerlink" title="è¿”å›ç»“æœçš„HTTPçŠ¶æ€ç "></a>è¿”å›ç»“æœçš„HTTPçŠ¶æ€ç </h2><h3 id="2XX-æˆåŠŸ"><a href="#2XX-æˆåŠŸ" class="headerlink" title="2XX æˆåŠŸ"></a>2XX æˆåŠŸ</h3><p><strong>200 ok</strong> è¡¨ç¤ºä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åœ¨æœåŠ¡å™¨ç«¯å·²è¢«æ­£å¸¸å¤„ç†</p><p><strong>204 No Content</strong> è¯·æ±‚å¤„ç†æˆåŠŸï¼Œä½†æ²¡æœ‰èµ„æºå¯è¿”å›</p><p><strong>206 partial content</strong> è¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ è€ŒæœåŠ¡å™¨æˆåŠŸæ‰§è¡Œäº†è¿™éƒ¨åˆ†çš„getè¯·æ±‚</p><h3 id="3XX-é‡å®šå‘"><a href="#3XX-é‡å®šå‘" class="headerlink" title="3XX é‡å®šå‘"></a>3XX é‡å®šå‘</h3><p><strong>301 moved permanently</strong><br>æ°¸ä¹…æ€§é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²è¢«åˆ†é…äº†æ–°çš„URIï¼Œä»¥ååº”ä½¿ç”¨èµ„æºç°åœ¨æ‰€æŒ‡çš„URIã€‚</p><p><strong>302 Found</strong><br>ä¸´æ—¶é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²è¢«åˆ†é…äº†æ–°çš„URIï¼Œå¸Œæœ›ç”¨æˆ·ï¼ˆæœ¬æ¬¡ï¼‰èƒ½ä½¿ç”¨æ–°çš„URIè®¿é—®ã€‚</p><p><strong>303 see other</strong><br>ä¸´æ—¶é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ªURIï¼Œåº”ä½¿ç”¨getæ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æºã€‚</p><p><strong>304 Not Modified</strong></p><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€é™„å¸¦æ¡ä»¶çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨å…è®¸è¯·æ±‚è®¿é—®èµ„æºã€‚</p><p><strong>307 Temporary Redirect</strong><br>ä¸´æ—¶é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç ä¸302 Foundæœ‰ç€ç›¸åŒçš„å«ä¹‰ã€‚</p><h3 id="4XX-å®¢æˆ·ç«¯é”™è¯¯"><a href="#4XX-å®¢æˆ·ç«¯é”™è¯¯" class="headerlink" title="4XX å®¢æˆ·ç«¯é”™è¯¯"></a>4XX å®¢æˆ·ç«¯é”™è¯¯</h3><p><strong>400 Bad Request</strong><br>è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚æŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚</p><p><strong>401 Unauthorized</strong><br>è¯¥çŠ¶æ€ç è¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰HTTPè®¤è¯çš„è®¤è¯ä¿¡æ¯ã€‚</p><p><strong>403 Forbidden</strong><br>è¯¥çŠ¶æ€ç è¡¨æ˜å¯¹è¯·æ±‚çš„èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»äº†</p><p><strong>404 Not Found</strong><br>è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºæ— æ³•å†æœåŠ¡å™¨ä¸Šæ‰¾åˆ°</p><h3 id="5XX-æœåŠ¡å™¨é”™è¯¯"><a href="#5XX-æœåŠ¡å™¨é”™è¯¯" class="headerlink" title="5XX æœåŠ¡å™¨é”™è¯¯"></a>5XX æœåŠ¡å™¨é”™è¯¯</h3><p><strong>500 Internal Server Error</strong></p><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ã€‚ä¹Ÿå¯èƒ½æ˜¯webåº”ç”¨å­˜åœ¨çš„bugæˆ–æŸäº›ä¸´æ—¶çš„æ•…éšœã€‚</p><p><strong>503 Service Unavailable</strong></p><p>è¯¥çŠ¶æ€ç è¡¨æ˜æœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨åœæœºç»´æŠ¤ï¼Œç°åœ¨æ— æ³•å¤„ç†è¯·æ±‚ã€‚</p><h2 id="ä¸HTTPåä½œçš„webæœåŠ¡å™¨"><a href="#ä¸HTTPåä½œçš„webæœåŠ¡å™¨" class="headerlink" title="ä¸HTTPåä½œçš„webæœåŠ¡å™¨"></a>ä¸HTTPåä½œçš„webæœåŠ¡å™¨</h2><p>HTTP/1.1å…è®¸ä¸€å°HTTPæœåŠ¡å™¨æ­å»ºå¤šä¸ªwebç«™ç‚¹ã€‚å³ä½¿ç‰©ç†å±‚é¢åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä½†åªè¦ä½¿ç”¨è™šæ‹Ÿä¸»æœºçš„åŠŸèƒ½ï¼Œåˆ™å¯ä»¥å‡è±¡å·²å…·æœ‰å¤šå°æœåŠ¡å™¨ã€‚</p><p>åœ¨ç›¸åŒçš„IPåœ°å€ä¸‹ï¼Œç”±äºè™šæ‹Ÿä¸»æœºå¯ä»¥å¯„å­˜å¤šä¸ªä¸åŒçš„ä¸»æœºåå’ŒåŸŸåçš„webç½‘ç«™ï¼Œå› æ­¤åœ¨å‘é€HTTPè¯·æ±‚æ—¶ï¼Œå¿…é¡»åœ¨hosté¦–éƒ¨å†…å®Œæ•´æŒ‡å®šä¸»æœºåæˆ–åŸŸåçš„URI</p><h3 id="é€šä¿¡æ•°æ®è½¬å‘ç¨‹åº-ä»£ç†ã€ç½‘å…³ã€éš§é“"><a href="#é€šä¿¡æ•°æ®è½¬å‘ç¨‹åº-ä»£ç†ã€ç½‘å…³ã€éš§é“" class="headerlink" title="é€šä¿¡æ•°æ®è½¬å‘ç¨‹åº:ä»£ç†ã€ç½‘å…³ã€éš§é“"></a>é€šä¿¡æ•°æ®è½¬å‘ç¨‹åº:ä»£ç†ã€ç½‘å…³ã€éš§é“</h3><p>è¿™äº›åº”ç”¨ç¨‹åºå’ŒæœåŠ¡å™¨å¯ä»¥å°†è¯·æ±‚è½¬å‘ç»™é€šä¿¡çº¿è·¯ä¸Šçš„ä¸‹ä¸€ç«™æœåŠ¡å™¨ï¼Œå¹¶ä¸”èƒ½æ¥æ”¶ä»é‚£å°æœåŠ¡å™¨å‘é€çš„å“åº”å†è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚</p><h4 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h4><p>ä»£ç†æ˜¯ä¸€ç§æœ‰è½¬å‘åŠŸèƒ½çš„åº”ç”¨ç¨‹åºï¼Œä»–æ‰®æ¼”äº†ä½äºæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯â€œä¸­é—´äººâ€çš„è§’è‰²ï¼Œæ¥æ”¶æœ‰å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å¹¶è½¬å‘ç»™æœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæ¥å—æœåŠ¡å™¨è¿”å›çš„å“åº”å¹¶è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚</p><p>æ¯ä¸€æ¬¡é€šè¿‡ä»£ç†æœåŠ¡å™¨è½¬å‘ç»™è¯·æ±‚æˆ–å“åº”æ—¶ï¼Œä¹Ÿä¼šå†™å…¥<strong>Via</strong>é¦–éƒ¨ä¿¡æ¯ï¼Œç”¨æ¥æ ‡è®°ç»è¿‡çš„ä¸»æœºä¿¡æ¯ã€‚</p><p>ä½¿ç”¨ä»£ç†çš„ç†ç”±æœ‰ï¼Œ<strong>åˆ©ç”¨ç¼“å­˜æŠ€æœ¯å‡å°‘ç½‘ç»œå®½å¸¦çš„æµé‡ï¼Œç»„ç»‡å†…éƒ¨é’ˆå¯¹ç‰¹å®šç½‘ç«™çš„è®¿é—®æ§åˆ¶ï¼Œä»¥è·å–è®¿é—®æ—¥å¿—ä¸ºä¸»è¦ç›®çš„</strong>ï¼Œç­‰ç­‰ã€‚</p><p>ä»£ç†æœ‰å¤šç§ä½¿ç”¨æ–¹æ³•ï¼ŒæŒ‰ä¸¤ç§åŸºå‡†åˆ†ç±»ï¼Œä¸€ç§æ˜¯å¦ä½¿ç”¨ç¼“å­˜æŠ€æœ¯ï¼Œå¦ä¸€ç§æ˜¯å¦ä¼šä¿®æ”¹æŠ¥æ–‡ã€‚</p><h4 id="ç½‘å…³"><a href="#ç½‘å…³" class="headerlink" title="ç½‘å…³"></a>ç½‘å…³</h4><p>ç½‘å…³æ˜¯è½¬å‘å…¶ä»–æœåŠ¡å™¨é€šä¿¡æ•°æ®çš„æœåŠ¡å™¨ï¼Œæ¥æ”¶ä»å®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚æ—¶ï¼Œå®ƒå°±åƒè‡ªå·±æ‹¥æœ‰èµ„æºçš„æºæœåŠ¡å™¨ä¸€æ ·å¯¹è¯·æ±‚å¤„ç†ã€‚</p><p>ç½‘å…³çš„å·¥ä½œæœºåˆ¶å’Œä»£ç†ååˆ†ç›¸ä¼¼ï¼Œè€Œç½‘å…³èƒ½ä½¿é€šä¿¡çº¿è·¯ä¸Šçš„æœåŠ¡å™¨æä¾›éHTTPåè®®æœåŠ¡ã€‚åˆ©ç”¨ç½‘å…³å¯ä»¥æé«˜é€šä¿¡çš„å®‰å…¨æ€§ï¼Œå› ä¸ºå¯ä»¥åœ¨å®¢æˆ·ç«¯ä¸ç½‘å…³ä¹‹é—´çš„é€šä¿¡çº¿è·¯ä¸ŠåŠ å¯†ä»¥ç¡®ä¿è¿æ¥çš„å®‰å…¨ã€‚</p><h4 id="éš§é“"><a href="#éš§é“" class="headerlink" title="éš§é“"></a>éš§é“</h4><p>éš§é“æ˜¯åœ¨ç›¸éš”æ·±è¿œçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸¤è€…ä¹‹é—´è¿›è¡Œä¸­è½¬ï¼Œå¹¶ä¿æŒåŒæ–¹é€šä¿¡è¿æ¥çš„åº”ç”¨ç¨‹åºã€‚</p><p>éš§é“çš„ç›®çš„æ˜¯ç¡®ä¿å®¢æˆ·ç«¯èƒ½ä¸æœåŠ¡å™¨è¿›è¡Œå®‰å…¨çš„é€šä¿¡ã€‚</p><h3 id="ä¿å­˜èµ„æºçš„ç¼“å­˜"><a href="#ä¿å­˜èµ„æºçš„ç¼“å­˜" class="headerlink" title="ä¿å­˜èµ„æºçš„ç¼“å­˜"></a>ä¿å­˜èµ„æºçš„ç¼“å­˜</h3><p>ç¼“å­˜æ˜¯æŒ‡ä»£ç†æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æœ¬åœ°ç£ç›˜å†…ä¿å­˜çš„èµ„æºå‰¯æœ¬ï¼Œåˆ©ç”¨ç¼“å­˜å¯å‡å°‘å¯¹æºæœåŠ¡å™¨çš„è®¿é—®ï¼Œå› æ­¤ä¹Ÿå°±èŠ‚çœäº†é€šä¿¡æµé‡å’Œé€šä¿¡æ—¶é—´ã€‚</p><p>å³ä½¿å­˜åœ¨ç¼“å­˜ï¼Œä¹Ÿä¼šå› ä¸º<strong>å®¢æˆ·ç«¯çš„è¦æ±‚ï¼Œç¼“å­˜çš„æœ‰æ•ˆæœŸ</strong>ç­‰å› ç´ ï¼Œå‘æºæœåŠ¡å™¨ç¡®è®¤èµ„æºçš„æœ‰æ•ˆæ€§ã€‚è‹¥åˆ¤æ–­ç¼“å­˜å¤±è´¥ï¼Œç¼“å­˜æœåŠ¡å™¨å°†ä¼šå†æ¬¡ä»æºæœåŠ¡å™¨ä¸Šè·å–â€œæ–°â€èµ„æºã€‚</p><h2 id="HTTPé¦–éƒ¨"><a href="#HTTPé¦–éƒ¨" class="headerlink" title="HTTPé¦–éƒ¨"></a>HTTPé¦–éƒ¨</h2><p>HTTPåè®®çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å¿…å®šåŒ…å«HTTPé¦–éƒ¨</p><h3 id="HTTPæŠ¥æ–‡é¦–éƒ¨"><a href="#HTTPæŠ¥æ–‡é¦–éƒ¨" class="headerlink" title="HTTPæŠ¥æ–‡é¦–éƒ¨"></a>HTTPæŠ¥æ–‡é¦–éƒ¨</h3><p>HTTPè¯·æ±‚æŠ¥æ–‡ç”±æ–¹æ³•ï¼ŒURIï¼ŒHTTPç‰ˆæœ¬ï¼ŒHTTPé¦–éƒ¨å­—æ®µç­‰éƒ¨åˆ†æ„æˆ</p><p>HTTPå“åº”æŠ¥æ–‡ç”±HTTPç‰ˆæœ¬ï¼ŒçŠ¶æ€ç ï¼ˆæ•°å­—å’ŒåŸå› çŸ­è¯­ï¼‰HTTPé¦–éƒ¨å­—æ®µç­‰3éƒ¨åˆ†æ„æˆã€‚</p><h3 id="HTTPé¦–éƒ¨å­—æ®µ"><a href="#HTTPé¦–éƒ¨å­—æ®µ" class="headerlink" title="HTTPé¦–éƒ¨å­—æ®µ"></a>HTTPé¦–éƒ¨å­—æ®µ</h3><p>HTTPé¦–éƒ¨å­—æ®µæ˜¯ç”±å­—æ®µåå’Œå­—æ®µå€¼æ„æˆçš„ï¼Œä¸­é—´ç”¨å†’å·â€œï¼šâ€åˆ†å‰²ï¼›</p><p><code>é¦–éƒ¨å­—æ®µå:å­—æ®µå€¼</code><br>å¦‚<code>Content-Type: text/html</code></p><p>HTTPé¦–éƒ¨å­—æ®µæ ¹æ®å®é™…ç”¨é€”è¢«åˆ†ä¸ºä»¥ä¸‹4ä¸­ç±»å‹ã€‚</p><ul><li>é€šç”¨é¦–éƒ¨å­—æ®µ</li><li>è¯·æ±‚é¦–éƒ¨å­—æ®µ</li><li>å“åº”é¦–éƒ¨å­—æ®µ</li><li>å®ä½“é¦–éƒ¨å­—æ®µ</li></ul><p>HTTPé¦–éƒ¨å­—æ®µå°†å®šä¹‰æˆç¼“å­˜ä»£ç†å’Œéç¼“å­˜ä»£ç†çš„è¡Œä¸ºï¼Œåˆ†ä¸º2ç§ç±»å‹</p><p>ç«¯åˆ°ç«¯é¦–éƒ¨ï¼ˆEnd-to-end Headerï¼‰</p><p>é€è·³é¦–éƒ¨ï¼ˆHop-by-hop headerï¼‰</p><p>ä¸‹é¢åˆ—ä¸¾äº†HTTP/1.1ä¸­çš„é€è·³é¦–éƒ¨å­—æ®µã€‚é™¤äº†è¿™8ä¸ªé¦–éƒ¨å­—æ®µä¹‹å¤–ï¼Œå…¶ä»–æ‰€æœ‰å­—æ®µéƒ½å±äºç«¯åˆ°ç«¯é¦–éƒ¨å­—æ®µã€‚</p><ul><li>Connection</li><li>Keep-Alive</li><li>Proxy-Authenticate</li><li>Proxy-Authorization</li><li>Trailer</li><li>TE</li><li>Transfer-Encoding</li><li>Upgrade</li></ul><h3 id="HTTP-1-1é€šç”¨é¦–éƒ¨å­—æ®µ"><a href="#HTTP-1-1é€šç”¨é¦–éƒ¨å­—æ®µ" class="headerlink" title="HTTP/1.1é€šç”¨é¦–éƒ¨å­—æ®µ"></a>HTTP/1.1é€šç”¨é¦–éƒ¨å­—æ®µ</h3><h4 id="cache-control"><a href="#cache-control" class="headerlink" title="cache-control"></a>cache-control</h4><p>é€šè¿‡æŒ‡å®šé¦–éƒ¨å­—æ®µcache-controlçš„æŒ‡ä»¤ï¼Œå°±èƒ½æ“ä½œç¼“å­˜çš„å·¥ä½œæœºåˆ¶</p><h4 id="connection"><a href="#connection" class="headerlink" title="connection"></a>connection</h4><p>connectioné¦–éƒ¨å­—æ®µå…·æœ‰å¦‚ä¸‹ä¸¤ä¸ªä½œç”¨</p><ul><li>æ§åˆ¶ä¸å†è½¬å‘ç»™ä»£ç†çš„é¦–éƒ¨å­—æ®µ</li><li>ç®¡ç†æŒä¹…è¿æ¥</li></ul><h4 id="Date"><a href="#Date" class="headerlink" title="Date"></a>Date</h4><p>é¦–éƒ¨å­—æ®µDateè¡¨æ˜åˆ›å»ºHTTPæŠ¥æ–‡çš„æ—¥æœŸå’Œæ—¶é—´</p><h4 id="Pragma"><a href="#Pragma" class="headerlink" title="Pragma"></a>Pragma</h4><p>pragmaæ˜¯HTTP/1.1ä¹‹å‰çš„ç‰ˆæœ¬å†å²é—ç•™å­—æ®µï¼Œä»…ä½œä¸ºä¸HTTP/1.0çš„å‘åå…¼å®¹è€Œå®šä¹‰</p><h4 id="Tralier"><a href="#Tralier" class="headerlink" title="Tralier"></a>Tralier</h4><p>é¦–éƒ¨å­—æ®µä¼šäº‹å…ˆè¯´æ˜åœ¨æŠ¥æ–‡ä¸»ä½“åè®°å½•äº†å“ªäº›é¦–éƒ¨å­—æ®µã€‚</p><h4 id="Transfer-Encoding"><a href="#Transfer-Encoding" class="headerlink" title="Transfer-Encoding"></a>Transfer-Encoding</h4><p>è§„å®šäº†ä¼ è¾“æŠ¥æ–‡ä¸»ä½“é‡‡ç”¨çš„ç¼–ç æ–¹å¼</p><h4 id="Upgrade"><a href="#Upgrade" class="headerlink" title="Upgrade"></a>Upgrade</h4><p>ç”¨äºæ£€æµ‹HTTPåè®®åŠå…¶ä»–åè®®æ˜¯å¦å¯ä½¿ç”¨æ›´é«˜çš„ç‰ˆæœ¬è¿›è¡Œé€šä¿¡ï¼Œå…¶å‚æ•°å€¼å¯ä»¥ç”¨æ¥æŒ‡å®šä¸€ä¸ªå®Œå…¨ä¸åŒçš„é€šä¿¡åè®®</p><h4 id="Via"><a href="#Via" class="headerlink" title="Via"></a>Via</h4><p>ä¸ºäº†è¿½è¸ªå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡çš„ä¼ è¾“è·¯å¾„</p><h4 id="Waring"><a href="#Waring" class="headerlink" title="Waring"></a>Waring</h4><p>é€šå¸¸ä¼šå‘ŠçŸ¥ç”¨æˆ·ä¸€äº›ä¸ç¼“å­˜ç›¸å…³çš„é—®é¢˜çš„è­¦å‘Š</p><h2 id="ç¡®ä¿Webå®‰å…¨çš„HTTPS"><a href="#ç¡®ä¿Webå®‰å…¨çš„HTTPS" class="headerlink" title="ç¡®ä¿Webå®‰å…¨çš„HTTPS"></a>ç¡®ä¿Webå®‰å…¨çš„HTTPS</h2><p>åœ¨HTTPåè®®ä¸­æœ‰å¯èƒ½å­˜åœ¨ä¿¡æ¯çªƒå¬æˆ–èº«ä»½ä¼ªè£…ç­‰å®‰å…¨é—®é¢˜ï¼Œä½¿ç”¨HTTPSé€šä¿¡æœºåˆ¶å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¿™äº›é—®é¢˜ã€‚</p><h3 id="HTTPçš„ç¼ºç‚¹"><a href="#HTTPçš„ç¼ºç‚¹" class="headerlink" title="HTTPçš„ç¼ºç‚¹"></a>HTTPçš„ç¼ºç‚¹</h3><p>HTTPä¸»è¦ç”±ä»¥ä¸‹ä¸è¶³ï¼š</p><ul><li>é€šä¿¡é£Ÿç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½è¢«çªƒå¬</li><li>ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡ä¼ªè£…</li><li>æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥æœ‰å¯èƒ½å·²é­ç¯¡æ”¹</li></ul><p>è¿™äº›é—®é¢˜ä¸ä»…åœ¨HTTPä¸Šå‡ºç°ï¼Œå…¶ä»–æœªåŠ å¯†çš„åè®®ä¸­ä¹Ÿä¼šå­˜åœ¨è¿™ç±»é—®é¢˜ã€‚</p><p>é€šè¿‡å’ŒSSLï¼ˆsecure socket layer å®‰å…¨å¥—æ¥å±‚ï¼‰æˆ–TSLï¼ˆå®‰å…¨å±‚ä¼ è¾“åè®®ï¼‰çš„ç»„åˆä½¿ç”¨åŠ å¯†HTTPçš„é€šä¿¡å†…å®¹ã€‚</p><h3 id="HTTP-åŠ å¯†-è®¤è¯-å®Œæ•´æ€§ä¿æŠ¤-HTTPS"><a href="#HTTP-åŠ å¯†-è®¤è¯-å®Œæ•´æ€§ä¿æŠ¤-HTTPS" class="headerlink" title="HTTP+åŠ å¯†+è®¤è¯+å®Œæ•´æ€§ä¿æŠ¤ = HTTPS"></a>HTTP+åŠ å¯†+è®¤è¯+å®Œæ•´æ€§ä¿æŠ¤ = HTTPS</h3><p>æˆ‘ä»¬æŠŠæ·»åŠ äº†åŠ å¯†æ–¹å¼åŠè®¤è¯æœºåˆ¶çš„HTTPç§°ä¸ºHTTPSï¼ˆHTTP Secureï¼‰</p><h4 id="HTTPSæ˜¯èº«æŠ«SSLå¤–å£³çš„HTTP"><a href="#HTTPSæ˜¯èº«æŠ«SSLå¤–å£³çš„HTTP" class="headerlink" title="HTTPSæ˜¯èº«æŠ«SSLå¤–å£³çš„HTTP"></a>HTTPSæ˜¯èº«æŠ«SSLå¤–å£³çš„HTTP</h4><p>SSLé‡‡ç”¨ä¸€ç§ä½³ä½œå…¬å¼€å¯†é’¥åŠ å¯†ï¼ˆpublic-key cryptographyï¼‰çš„åŠ å¯†å¤„ç†æ–¹å¼</p><p>è¿™ç§åŠ å¯†æ–¹æ³•ä¸­åŠ å¯†ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œè€Œå¯†é’¥å´æ˜¯ä¿å¯†çš„ã€‚</p><p><strong>HTTPSé‡‡ç”¨æ··åˆåŠ å¯†æœºåˆ¶</strong><br>HTTPSé‡‡ç”¨å…±äº«å¯†é’¥åŠ å¯†å’Œå…¬å¼€å¯†é’¥åŠ å¯†ä¸¤è€…å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚</p><p><strong>è¯æ˜å…¬å¼€å¯†é’¥æ­£ç¡®æ€§çš„è¯ä¹¦</strong></p><p><strong>HTTPSçš„å®‰å…¨é€šä¿¡æœºåˆ¶</strong></p><p><strong>ä¸ºä»€ä¹ˆä¸ä¸€ç›´ä½¿ç”¨HTTPS</strong></p><p>åŸå› æœ‰ï¼Œå› ä¸ºä¸çº¯æ–‡æœ¬é€šä¿¡ç›¸æ¯”ï¼ŒåŠ å¯†é€šä¿¡ä¼šæ¶ˆè€—æ›´å¤šçš„CPUåŠå†…å­˜èµ„æºã€‚å› æ­¤ï¼Œå¦‚æœæ˜¯éæ•æ„Ÿä¿¡æ¯åˆ™ä½¿ç”¨HTTPé€šä¿¡ã€‚åªæœ‰åœ¨åŒ…å«ä¸ªäººä¿¡æ¯ç­‰æ•æ„Ÿæ•°æ®æ—¶ï¼Œæ‰ä¼šåˆ©ç”¨HTTPSåŠ å¯†é€šä¿¡ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæƒ³è¦èŠ‚çº¦è´­ä¹°è¯ä¹¦çš„å¼€é”€ä¹Ÿæ˜¯åŸå› ä¹‹ä¸€ã€‚</p><h2 id="ç¡®å®šè®¿é—®ç”¨æˆ·èº«ä»½çš„è®¤è¯"><a href="#ç¡®å®šè®¿é—®ç”¨æˆ·èº«ä»½çš„è®¤è¯" class="headerlink" title="ç¡®å®šè®¿é—®ç”¨æˆ·èº«ä»½çš„è®¤è¯"></a>ç¡®å®šè®¿é—®ç”¨æˆ·èº«ä»½çš„è®¤è¯</h2><p>ä¸ºäº†è®¤è¯ä½¿ç”¨è€…çš„ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯æŒ‡ä»¥ä¸‹è¿™äº›ï¼š</p><ul><li>å¯†ç ï¼ˆåªæœ‰æœ¬äººæ‰ä¼šçŸ¥é“çš„å­—ç¬¦ä¸²ä¿¡æ¯ï¼‰</li><li>åŠ¨æ€ä»¤ç‰Œï¼šä»…é™æœ¬äººæŒæœ‰çš„è®¾å¤‡å†…æ˜¾ç¤ºä¸€æ¬¡æ€§å¯†ç </li><li>æ•°å­—è¯ä¹¦ï¼šä»…é™æœ¬äººï¼ˆç»ˆç«¯ï¼‰æŒæœ‰çš„ä¿¡æ¯</li><li>ç”Ÿç‰©è®¤è¯ï¼šæŒ‡çº¹å’Œè™¹è†œç­‰æœ¬äººçš„ç”Ÿç†ä¿¡æ¯</li><li>ICå¡ç­‰ï¼šä»…é™æœ¬äººæŒæœ‰çš„ä¿¡æ¯</li></ul><p><strong>HTTPä½¿ç”¨çš„è®¤è¯æ–¹å¼</strong></p><blockquote><p>HTTP/1.1ä½¿ç”¨çš„è®¤è¯æ–¹å¼å¦‚ä¸‹</p></blockquote><ul><li>BASICè®¤è¯ï¼ˆåŸºæœ¬è®¤è¯ï¼‰</li><li>DIGESTè®¤è¯ï¼ˆæ‘˜è¦è®¤è¯ï¼‰</li><li>SSLå®¢æˆ·ç«¯è®¤è¯</li><li>FormBaseè®¤è¯ï¼ˆåŸºäºè¡¨å•è®¤è¯ï¼‰</li></ul><p>ä¸ºå‡è½»è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰é€ æˆçš„æŸå¤±ï¼Œå»ºè®®äº‹å…ˆåœ¨Cookieå†…åŠ ä¸Šhttponlyå±æ€§</p><h2 id="åŸºäºHTTPçš„åŠŸèƒ½è¿½åŠ åè®®"><a href="#åŸºäºHTTPçš„åŠŸèƒ½è¿½åŠ åè®®" class="headerlink" title="åŸºäºHTTPçš„åŠŸèƒ½è¿½åŠ åè®®"></a>åŸºäºHTTPçš„åŠŸèƒ½è¿½åŠ åè®®</h2><h3 id="æ¶ˆé™¤HTTPç“¶é¢ˆçš„SPDY"><a href="#æ¶ˆé™¤HTTPç“¶é¢ˆçš„SPDY" class="headerlink" title="æ¶ˆé™¤HTTPç“¶é¢ˆçš„SPDY"></a>æ¶ˆé™¤HTTPç“¶é¢ˆçš„SPDY</h3><p>è‹¥æƒ³åœ¨ç°æœ‰çš„Webå®ç°æ‰€éœ€çš„åŠŸèƒ½ï¼Œä»¥ä¸‹è¿™äº›HTTPæ ‡å‡†å°±ä¼šæˆä¸ºç“¶é¢ˆ</p><ul><li>ä¸€æ¡è¿æ¥ä¸Šåªèƒ½å‘é€ä¸€æ¡è¯·æ±‚</li><li>è¯·æ±‚åªèƒ½ä»å®¢æˆ·ç«¯å¼€å§‹ã€‚å®¢æˆ·ç«¯ä¸å¯ä»¥æ¥æ”¶é™¤å“åº”ä»¥å¤–çš„æŒ‡ä»¤ã€‚</li><li>è¯·æ±‚/å“åº”é¦–éƒ¨æœªç»å‹ç¼©å°±å‘é€ã€‚é¦–éƒ¨ä¿¡æ¯è¶Šå¤šå»¶è¿Ÿè¶Šå¤§</li><li>å‘é€å†—é•¿çš„é¦–éƒ¨ã€‚æ¯æ¬¡äº’ç›¸å‘é€ç›¸åŒçš„é¦–éƒ¨é€ æˆçš„æµªè´¹è¾ƒå¤š</li><li>å¯çƒ­è®®é€‰æ‹©æ•°æ®å‹ç¼©æ ¼å¼ã€‚éå¼ºåˆ¶å‹ç¼©å‘é€ã€‚</li></ul><p><strong>Ajaxçš„è§£å†³æ–¹æ³•</strong></p><p>Ajaxæ˜¯ä¸€ç§javascriptå’ŒDOMçš„æ“ä½œï¼Œä»¥è¾¾åˆ°å±€éƒ¨webé¡µé¢æ›¿æ¢åŠ è½½çš„å¼‚æ­¥é€šä¿¡æ‰‹æ®µã€‚è€Œåˆ©ç”¨Ajaxå®æ—¶åœ°ä»æœåŠ¡å™¨è·å–å†…å®¹ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´å¤§é‡è¯·æ±‚äº§ç”Ÿã€‚</p><p><strong>Cometçš„è§£å†³æ–¹æ³•</strong></p><p>ä¸€æ—¦æœåŠ¡å™¨ç«¯æœ‰å†…å®¹æ›´æ–°äº†ï¼Œcometä¸ä¼šè®©è¯·æ±‚ç­‰å¾…ï¼Œè€Œæ˜¯ç›´æ¥ç»™å®¢æˆ·ç«¯è¿”å›å“åº”ã€‚è¿™æ˜¯ä¸€ç§é€šè¿‡å»¶è¿Ÿåº”ç­”ï¼Œæ¨¡æ‹Ÿå®ç°æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯æ¨é€ï¼ˆServer Pushï¼‰çš„åŠŸèƒ½ã€‚</p><p>å†…å®¹ä¸Šè™½ç„¶å¯ä»¥åšåˆ°å®æ—¶æ›´æ–°ï¼Œä½†ä¸ºäº†ä¿ç•™å“åº”ï¼Œä¸€æ¬¡è¿æ¥çš„æŒç»­æ—¶é—´ä¹Ÿå˜é•¿äº†ã€‚æœŸé—´ï¼Œä¸ºäº†ç»´æŒè¿æ¥ä¼šæ¶ˆè€—æ›´å¤šçš„èµ„æºã€‚</p><p><strong>SPDYçš„è®¾è®¡ä¸åŠŸèƒ½</strong></p><p>SPDYä»¥ä¼šè¯å±‚çš„å½¢å¼åŠ å…¥ï¼Œæ§åˆ¶å¯¹æ•°æ®çš„æµåŠ¨ï¼Œä½†è¿˜æ˜¯é‡‡ç”¨HTTPå»ºç«‹é€šä¿¡è¿æ¥ã€‚</p><p>ä½¿ç”¨SPDYåï¼ŒHTTPåè®®é¢å¤–è·å¾—ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>å¤šè·¯å¤ç”¨æµ é€šè¿‡å•ä¸€çš„TCPè¿æ¥ï¼Œå¯ä»¥æ— é™åˆ¶å¤„ç†å¤šä¸ªHTTPè¯·æ±‚ã€‚</li><li>èµ‹äºˆè¯·æ±‚ä¼˜å…ˆçº§ </li><li>å‹ç¼©HTTPé¦–éƒ¨</li><li>æ¨é€åŠŸèƒ½</li><li>æœåŠ¡å™¨æç¤ºåŠŸèƒ½</li></ul><h3 id="ä½¿ç”¨æµè§ˆå™¨è¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„WebSocket"><a href="#ä½¿ç”¨æµè§ˆå™¨è¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„WebSocket" class="headerlink" title="ä½¿ç”¨æµè§ˆå™¨è¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„WebSocket"></a>ä½¿ç”¨æµè§ˆå™¨è¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„WebSocket</h3><p>ä¸€æ—¦webæœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¹‹é—´å»ºç«‹websocketåè®®çš„é€šä¿¡è¿æ¥ï¼Œä¹‹åæ‰€æœ‰çš„é€šä¿¡éƒ½ä¾é è¿™ä¸ªä¸“ç”¨åè®®è¿›è¡Œã€‚é€šä¿¡è¿‡ç¨‹ä¸­å¯äº’ç›¸å‘é€JSONï¼ŒXMLï¼ŒHTMLæˆ–å›¾ç‰‡ç­‰ä»»æ„æ ¼å¼çš„æ•°æ®</p><h4 id="WebSocketåè®®çš„ç‰¹ç‚¹"><a href="#WebSocketåè®®çš„ç‰¹ç‚¹" class="headerlink" title="WebSocketåè®®çš„ç‰¹ç‚¹"></a>WebSocketåè®®çš„ç‰¹ç‚¹</h4><ul><li>æ¨é€åŠŸèƒ½ </li><li>å‡å°‘é€šä¿¡é‡ ä¸ºäº†å®ç°Websocketï¼Œåœ¨HTTPè¿æ¥å»ºç«‹ä¹‹åï¼Œéœ€è¦å®Œæˆä¸€æ¬¡â€œæ¡æ‰‹â€çš„æ­¥éª¤</li></ul><h3 id="æœŸç›¼å·²ä¹…çš„HTTP-2-0"><a href="#æœŸç›¼å·²ä¹…çš„HTTP-2-0" class="headerlink" title="æœŸç›¼å·²ä¹…çš„HTTP/2.0"></a>æœŸç›¼å·²ä¹…çš„HTTP/2.0</h3><p>HTTP/2.0çš„ç‰¹ç‚¹</p><ul><li>SPDY</li><li>HTTP Speed + Mobility</li><li>Network-Friendly HTTP Upgrade</li></ul><p>HTTP/2.0 çš„7é¡¹æŠ€æœ¯åŠè®¨è®º</p><ul><li>å‹ç¼©</li><li>å¤šè·¯å¤ç”¨</li><li>TSLä¹‰åŠ¡åŒ–</li><li>åå•†</li><li>å®¢æˆ·ç«¯æ‹‰æ‹½/æœåŠ¡å™¨æ¨é€</li><li>æµé‡æ§åˆ¶</li><li>websocket</li></ul><h3 id="WebæœåŠ¡å™¨ç®¡ç†æ–‡ä»¶çš„WebDAV"><a href="#WebæœåŠ¡å™¨ç®¡ç†æ–‡ä»¶çš„WebDAV" class="headerlink" title="WebæœåŠ¡å™¨ç®¡ç†æ–‡ä»¶çš„WebDAV"></a>WebæœåŠ¡å™¨ç®¡ç†æ–‡ä»¶çš„WebDAV</h3><p>WebDAVï¼ˆåŸºäºä¸‡ç»´ç½‘çš„åˆ†å¸ƒå¼åˆ›ä½œå’Œç‰ˆæœ¬æ§åˆ¶ï¼‰ æ˜¯ä¸€ä¸ªå¯å¯¹WebæœåŠ¡å™¨ä¸Šçš„å†…å®¹ç›´æ¥è¿›è¡Œæ–‡ä»¶å¤åˆ¶ï¼Œç¼–è¾‘ç­‰æ“ä½œçš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>é™¤äº†åˆ›å»ºã€åˆ é™¤ç­‰åŸºæœ¬åŠŸèƒ½å¤–ï¼Œä»–è¿˜å…·å¤‡æ–‡ä»¶åˆ›å»ºè€…ç®¡ç†ï¼Œæ–‡ä»¶ç¼–è¾‘è¿‡ç¨‹ä¸­ç¦æ­¢å…¶ä»–ç”¨æˆ·å†…å®¹è¦†ç›–çš„åŠ <br>é”åŠŸèƒ½ï¼Œä»¥åŠå¯¹æ–‡ä»¶å†…å®¹ä¿®æ”¹çš„ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½ã€‚</p><h2 id="æ„å»ºWebå†…å®¹çš„æŠ€æœ¯"><a href="#æ„å»ºWebå†…å®¹çš„æŠ€æœ¯" class="headerlink" title="æ„å»ºWebå†…å®¹çš„æŠ€æœ¯"></a>æ„å»ºWebå†…å®¹çš„æŠ€æœ¯</h2><p><strong>HTML</strong><br><strong>CSS</strong><br><strong>JAVASCRIPT</strong></p><p>ä¸WebæœåŠ¡å™¨åŠç¨‹åºåä½œçš„CGI</p><p>CGIï¼ˆé€šç”¨ç½‘å…³æ¥å£ï¼‰æ˜¯æŒ‡WebæœåŠ¡å™¨åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚åè½¬å‘ç»™ç¨‹åºçš„ä¸€ç»„æœºåˆ¶ã€‚åœ¨CGIçš„ä½œç”¨ä¸‹ï¼Œç¨‹åºä¼šå¯¹è¯·æ±‚å†…å®¹åšå‡ºç›¸åº”çš„åŠ¨ä½œã€‚</p><h2 id="é’ˆå¯¹webçš„æ”»å‡»æŠ€æœ¯"><a href="#é’ˆå¯¹webçš„æ”»å‡»æŠ€æœ¯" class="headerlink" title="é’ˆå¯¹webçš„æ”»å‡»æŠ€æœ¯"></a>é’ˆå¯¹webçš„æ”»å‡»æŠ€æœ¯</h2><p>å¯¹Webåº”ç”¨çš„æ”»å‡»æ¨¡å¼æœ‰ä»¥ä¸‹ä¸¤ç§</p><ul><li>ä¸»åŠ¨æ”»å‡»  å…·æœ‰ä»£è¡¨æ€§çš„æ”»å‡»æ˜¯SQLæ³¨å…¥æ”»å‡»å’ŒOSå‘½ä»¤æ³¨å…¥æ”»å‡»</li></ul><ul><li>è¢«åŠ¨æ”»å‡» å…·æœ‰ä»£è¡¨æ€§çš„æ”»å‡»æ˜¯è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œè·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ (CORS)</li></ul><p>å®æ–½webåº”ç”¨çš„å®‰å…¨å¯¹ç­–å¯å¤§è‡´åˆ†ä¸ºä»¥ä¸‹ä¸¤éƒ¨åˆ†ã€‚</p><ul><li>å®¢æˆ·ç«¯çš„éªŒè¯</li><li>webåº”ç”¨ç«¯ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰çš„éªŒè¯<br>  <code>è¾“å…¥å€¼éªŒè¯</code><br>  <code>è¾“å‡ºå€¼è½¬ä¹‰</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ</title>
      <link href="/2018/07/10/HTTP/%E4%BB%8E%E8%BE%93%E5%85%A5url%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%E5%88%B0%E5%BA%95%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88/"/>
      <url>/2018/07/10/HTTP/%E4%BB%8E%E8%BE%93%E5%85%A5url%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%E5%88%B0%E5%BA%95%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åˆšå¼€å§‹å†™è¿™ç¯‡æ–‡ç« è¿˜æ˜¯æŒºçº ç»“çš„ï¼Œå› ä¸ºç½‘ä¸Šæœç´¢â€œä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆâ€ï¼Œä½ å¯ä»¥æœåˆ°ä¸€å¤§å †çš„èµ„æ–™ã€‚è€Œä¸”é¢è¯•è¿™é“é¢˜åŸºæœ¬æ˜¯å¿…è€ƒé¢˜ï¼ŒäºŒæœˆä»½é¢è¯•çš„æ—¶å€™ï¼Œè™½ç„¶çŸ¥é“è¿™ä¸ªè¿‡ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä¸è¿‡å½“é¢è¯•å®˜ä¸€æ­¥æ­¥è¿½é—®ä¸‹å»çš„ï¼Œå¾ˆå¤šç»†èŠ‚å°±ä¸å¤ªæ¸…æ¥šäº†ã€‚</p><p>ã€€ã€€æœ€è¿‘åˆšå¥½ä¹Ÿåœ¨çœ‹httpåè®®ç›¸å…³çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æƒ³å¯¹è¿™ä¸ªè¯é¢˜æ¥ä¸ªæ·±å…¥çš„æ€»ç»“ï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯ <strong>é€šè¿‡è¾“å…¥urlä¹‹åå‘ç”Ÿçš„äº‹æƒ…æ¥åšçŸ¥è¯†çš„æ€»ç»“å’Œæ‰©å±•</strong>ã€‚æ‰€ä»¥æ–‡ç« å¯èƒ½ä¼šå¾ˆæ‚ã€‚</p><pre><code>æ€»çš„è¿‡ç¨‹å¤§æ¦‚å¦‚ä¸‹:</code></pre><h2 id="è¾“å…¥åœ°å€"><a href="#è¾“å…¥åœ°å€" class="headerlink" title="è¾“å…¥åœ°å€"></a>è¾“å…¥åœ°å€</h2><p>å½“æˆ‘ä»¬å¼€å§‹åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ç½‘å€çš„æ—¶å€™ï¼Œæµè§ˆå™¨å…¶å®å°±å·²ç»åœ¨æ™ºèƒ½çš„åŒ¹é…å¯èƒ½å¾— url äº†ï¼Œä»–ä¼šä»å†å²è®°å½•ï¼Œä¹¦ç­¾ç­‰åœ°æ–¹ï¼Œæ‰¾åˆ°å·²ç»è¾“å…¥çš„å­—ç¬¦ä¸²å¯èƒ½å¯¹åº”çš„ urlï¼Œç„¶åç»™å‡ºæ™ºèƒ½æç¤ºï¼Œè®©ä½ å¯ä»¥è¡¥å…¨urlåœ°å€ã€‚å¯¹äº googleçš„chrome çš„æµè§ˆå™¨ï¼Œä»–ç”šè‡³ä¼šç›´æ¥ä»ç¼“å­˜ä¸­æŠŠç½‘é¡µå±•ç¤ºå‡ºæ¥ï¼Œå°±æ˜¯è¯´ï¼Œä½ è¿˜æ²¡æœ‰æŒ‰ä¸‹ enterï¼Œé¡µé¢å°±å‡ºæ¥äº†ã€‚</p><h2 id="æµè§ˆå™¨æŸ¥æ‰¾åŸŸåçš„ipåœ°å€"><a href="#æµè§ˆå™¨æŸ¥æ‰¾åŸŸåçš„ipåœ°å€" class="headerlink" title="æµè§ˆå™¨æŸ¥æ‰¾åŸŸåçš„ipåœ°å€"></a>æµè§ˆå™¨æŸ¥æ‰¾åŸŸåçš„ipåœ°å€</h2><ul><li><p>1ã€è¯·æ±‚ä¸€æ—¦å‘èµ·ï¼Œæµè§ˆå™¨é¦–å…ˆè¦åšçš„äº‹æƒ…å°±æ˜¯è§£æè¿™ä¸ªåŸŸåï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæµè§ˆå™¨ä¼šé¦–å…ˆæŸ¥çœ‹æœ¬åœ°ç¡¬ç›˜çš„ hosts æ–‡ä»¶ï¼Œçœ‹çœ‹å…¶ä¸­æœ‰æ²¡æœ‰å’Œè¿™ä¸ªåŸŸåå¯¹åº”çš„è§„åˆ™ï¼Œå¦‚æœæœ‰çš„è¯å°±ç›´æ¥ä½¿ç”¨ hosts æ–‡ä»¶é‡Œé¢çš„ ip åœ°å€ã€‚</p></li><li><p>2ã€å¦‚æœåœ¨æœ¬åœ°çš„ hosts æ–‡ä»¶æ²¡æœ‰èƒ½å¤Ÿæ‰¾åˆ°å¯¹åº”çš„ ip åœ°å€ï¼Œæµè§ˆå™¨ä¼šå‘å‡ºä¸€ä¸ª DNSè¯·æ±‚åˆ°æœ¬åœ°DNSæœåŠ¡å™¨ ã€‚æœ¬åœ°DNSæœåŠ¡å™¨ä¸€èˆ¬éƒ½æ˜¯ä½ çš„ç½‘ç»œæ¥å…¥æœåŠ¡å™¨å•†æä¾›ï¼Œæ¯”å¦‚ä¸­å›½ç”µä¿¡ï¼Œä¸­å›½ç§»åŠ¨ã€‚</p></li><li><p>3ã€æŸ¥è¯¢ä½ è¾“å…¥çš„ç½‘å€çš„DNSè¯·æ±‚åˆ°è¾¾æœ¬åœ°DNSæœåŠ¡å™¨ä¹‹åï¼Œæœ¬åœ°DNSæœåŠ¡å™¨ä¼šé¦–å…ˆæŸ¥è¯¢å®ƒçš„ç¼“å­˜è®°å½•ï¼Œå¦‚æœç¼“å­˜ä¸­æœ‰æ­¤æ¡è®°å½•ï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›ç»“æœï¼Œæ­¤è¿‡ç¨‹æ˜¯é€’å½’çš„æ–¹å¼è¿›è¡ŒæŸ¥è¯¢ã€‚å¦‚æœæ²¡æœ‰ï¼Œæœ¬åœ°DNSæœåŠ¡å™¨è¿˜è¦å‘DNSæ ¹æœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ã€‚</p></li><li><p>4ã€æ ¹DNSæœåŠ¡å™¨æ²¡æœ‰è®°å½•å…·ä½“çš„åŸŸåå’ŒIPåœ°å€çš„å¯¹åº”å…³ç³»ï¼Œè€Œæ˜¯å‘Šè¯‰æœ¬åœ°DNSæœåŠ¡å™¨ï¼Œä½ å¯ä»¥åˆ°åŸŸæœåŠ¡å™¨ä¸Šå»ç»§ç»­æŸ¥è¯¢ï¼Œå¹¶ç»™å‡ºåŸŸæœåŠ¡å™¨çš„åœ°å€ã€‚è¿™ç§è¿‡ç¨‹æ˜¯è¿­ä»£çš„è¿‡ç¨‹ã€‚</p></li><li><p>5ã€æœ¬åœ°DNSæœåŠ¡å™¨ç»§ç»­å‘åŸŸæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¯·æ±‚çš„å¯¹è±¡æ˜¯.comåŸŸæœåŠ¡å™¨ã€‚.comåŸŸæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œä¹Ÿä¸ä¼šç›´æ¥è¿”å›åŸŸåå’ŒIPåœ°å€çš„å¯¹åº”å…³ç³»ï¼Œè€Œæ˜¯å‘Šè¯‰æœ¬åœ°DNSæœåŠ¡å™¨ï¼Œä½ çš„åŸŸåçš„è§£ææœåŠ¡å™¨çš„åœ°å€ã€‚</p></li><li><p>6ã€æœ€åï¼Œæœ¬åœ°DNSæœåŠ¡å™¨å‘åŸŸåçš„è§£ææœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œè¿™æ—¶å°±èƒ½æ”¶åˆ°ä¸€ä¸ªåŸŸåå’ŒIPåœ°å€å¯¹åº”å…³ç³»ï¼Œæœ¬åœ°DNSæœåŠ¡å™¨ä¸ä»…è¦æŠŠIPåœ°å€è¿”å›ç»™ç”¨æˆ·ç”µè„‘ï¼Œè¿˜è¦æŠŠè¿™ä¸ªå¯¹åº”å…³ç³»ä¿å­˜åœ¨ç¼“å­˜ä¸­ï¼Œä»¥å¤‡ä¸‹æ¬¡åˆ«çš„ç”¨æˆ·æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥ç›´æ¥è¿”å›ç»“æœï¼ŒåŠ å¿«ç½‘ç»œè®¿é—®ã€‚</p></li></ul><a id="more"></a><p>ä¸‹é¢ä¸€å›¾å®Œç¾è§£é‡Šäº†ä¸Šé¢æ‰€è¿°</p><p><img src="http://www.maixj.net/wp-content/uploads/2015/10/dns.jpg" alt="æŸ¥æ‰¾åŸŸåè¿‡ç¨‹"></p><h3 id="çŸ¥è¯†æ‰©å±•ï¼š"><a href="#çŸ¥è¯†æ‰©å±•ï¼š" class="headerlink" title="çŸ¥è¯†æ‰©å±•ï¼š"></a>çŸ¥è¯†æ‰©å±•ï¼š</h3><h4 id="ä»€ä¹ˆæ˜¯DNS"><a href="#ä»€ä¹ˆæ˜¯DNS" class="headerlink" title="ä»€ä¹ˆæ˜¯DNS"></a>ä»€ä¹ˆæ˜¯DNS</h4><p>DNSï¼ˆDomain Name Systemï¼ŒåŸŸåç³»ç»Ÿï¼‰ï¼Œå› ç‰¹ç½‘ä¸Šä½œä¸º<code>åŸŸå</code>å’Œ<code>IPåœ°å€</code>ç›¸äº’æ˜ å°„çš„ä¸€ä¸ª<code>åˆ†å¸ƒå¼æ•°æ®åº“</code>ï¼Œèƒ½å¤Ÿä½¿ç”¨æˆ·æ›´æ–¹ä¾¿çš„è®¿é—®äº’è”ç½‘ï¼Œè€Œä¸ç”¨å»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æ¥è¯»å–çš„IPæ•°ä¸²ã€‚é€šè¿‡<code>ä¸»æœºå</code>ï¼Œæœ€ç»ˆå¾—åˆ°è¯¥<code>ä¸»æœºå</code>å¯¹åº”çš„IPåœ°å€çš„è¿‡ç¨‹å«åš<code>åŸŸåè§£æ</code>ï¼ˆæˆ–ä¸»æœºåè§£æï¼‰ã€‚</p><p>é€šä¿—çš„è®²ï¼Œæˆ‘ä»¬æ›´ä¹ æƒ¯äºè®°ä½ä¸€ä¸ªç½‘ç«™çš„åå­—ï¼Œæ¯”å¦‚<a href="http://www.baidu.com,è€Œä¸æ˜¯è®°ä½å®ƒçš„`ipåœ°å€`ï¼Œæ¯”å¦‚ï¼š167.23.10.2ã€‚è€Œè®¡ç®—æœºæ›´æ“…é•¿è®°ä½`ç½‘ç«™çš„ipåœ°å€`ï¼Œè€Œä¸æ˜¯åƒwww.baidu.comç­‰é“¾æ¥ã€‚å› ä¸ºï¼ŒDNSå°±ç›¸å½“äºä¸€ä¸ªç”µè¯æœ¬ï¼Œæ¯”å¦‚ä½ è¦æ‰¾www.baidu.comè¿™ä¸ªåŸŸåï¼Œé‚£æˆ‘ç¿»ä¸€ç¿»æˆ‘çš„ç”µè¯æœ¬ï¼Œæˆ‘å°±çŸ¥é“ï¼Œå“¦ï¼Œå®ƒçš„ç”µè¯ï¼ˆipï¼‰æ˜¯167.23.10.2ã€‚">www.baidu.com,è€Œä¸æ˜¯è®°ä½å®ƒçš„`ipåœ°å€`ï¼Œæ¯”å¦‚ï¼š167.23.10.2ã€‚è€Œè®¡ç®—æœºæ›´æ“…é•¿è®°ä½`ç½‘ç«™çš„ipåœ°å€`ï¼Œè€Œä¸æ˜¯åƒwww.baidu.comç­‰é“¾æ¥ã€‚å› ä¸ºï¼ŒDNSå°±ç›¸å½“äºä¸€ä¸ªç”µè¯æœ¬ï¼Œæ¯”å¦‚ä½ è¦æ‰¾www.baidu.comè¿™ä¸ªåŸŸåï¼Œé‚£æˆ‘ç¿»ä¸€ç¿»æˆ‘çš„ç”µè¯æœ¬ï¼Œæˆ‘å°±çŸ¥é“ï¼Œå“¦ï¼Œå®ƒçš„ç”µè¯ï¼ˆipï¼‰æ˜¯167.23.10.2ã€‚</a></p><h4 id="DNSæŸ¥è¯¢çš„ä¸¤ç§æ–¹å¼ï¼šé€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢"><a href="#DNSæŸ¥è¯¢çš„ä¸¤ç§æ–¹å¼ï¼šé€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢" class="headerlink" title="DNSæŸ¥è¯¢çš„ä¸¤ç§æ–¹å¼ï¼šé€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢"></a>DNSæŸ¥è¯¢çš„ä¸¤ç§æ–¹å¼ï¼šé€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢</h4><p>1ã€<strong>é€’å½’è§£æ</strong></p><p>å½“å±€éƒ¨DNSæœåŠ¡å™¨è‡ªå·±ä¸èƒ½å›ç­”å®¢æˆ·æœºçš„DNSæŸ¥è¯¢æ—¶ï¼Œå®ƒå°±éœ€è¦å‘å…¶ä»–DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ã€‚æ­¤æ—¶æœ‰ä¸¤ç§æ–¹å¼ï¼Œå¦‚å›¾æ‰€ç¤ºçš„æ˜¯é€’å½’æ–¹å¼ã€‚å±€éƒ¨DNSæœåŠ¡å™¨è‡ªå·±è´Ÿè´£å‘å…¶ä»–DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œä¸€èˆ¬æ˜¯å…ˆå‘è¯¥åŸŸåçš„æ ¹åŸŸæœåŠ¡å™¨æŸ¥è¯¢ï¼Œå†ç”±æ ¹åŸŸåæœåŠ¡å™¨ä¸€çº§çº§å‘ä¸‹æŸ¥è¯¢ã€‚æœ€åå¾—åˆ°çš„æŸ¥è¯¢ç»“æœè¿”å›ç»™å±€éƒ¨DNSæœåŠ¡å™¨ï¼Œå†ç”±å±€éƒ¨DNSæœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p><img src="http://s16.sinaimg.cn/mw690/4078ccd6hcdcf48aab7af&amp;690" alt="é€’å½’è§£æ"></p><p>2ã€<strong>è¿­ä»£è§£æ</strong></p><p>å½“å±€éƒ¨DNSæœåŠ¡å™¨è‡ªå·±ä¸èƒ½å›ç­”å®¢æˆ·æœºçš„DNSæŸ¥è¯¢æ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿­ä»£æŸ¥è¯¢çš„æ–¹å¼è¿›è¡Œè§£æï¼Œå¦‚å›¾æ‰€ç¤ºã€‚å±€éƒ¨DNSæœåŠ¡å™¨ä¸æ˜¯è‡ªå·±å‘å…¶ä»–DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œæ˜¯æŠŠèƒ½è§£æè¯¥åŸŸåçš„å…¶ä»–DNSæœåŠ¡å™¨çš„IPåœ°å€è¿”å›ç»™å®¢æˆ·ç«¯DNSç¨‹åºï¼Œå®¢æˆ·ç«¯DNSç¨‹åºå†ç»§ç»­å‘è¿™äº›DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œç›´åˆ°å¾—åˆ°æŸ¥è¯¢ç»“æœä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿­ä»£è§£æåªæ˜¯å¸®ä½ æ‰¾åˆ°ç›¸å…³çš„æœåŠ¡å™¨è€Œå·²ï¼Œè€Œä¸ä¼šå¸®ä½ å»æŸ¥ã€‚æ¯”å¦‚è¯´ï¼šbaidu.comçš„æœåŠ¡å™¨ipåœ°å€åœ¨192.168.4.5è¿™é‡Œï¼Œä½ è‡ªå·±å»æŸ¥å§ï¼Œæœ¬äººæ¯”è¾ƒå¿™ï¼Œåªèƒ½å¸®ä½ åˆ°è¿™é‡Œäº†ã€‚</p><p><img src="http://s12.sinaimg.cn/mw690/4078ccd6h7afb21339ebb&amp;690" alt="è¿­ä»£è§£æ"></p><p>3ã€<strong>DNSåŸŸåç§°ç©ºé—´çš„ç»„ç»‡æ–¹å¼</strong></p><p>æˆ‘ä»¬åœ¨å‰é¢æœ‰è¯´åˆ°æ ¹DNSæœåŠ¡å™¨ï¼ŒåŸŸDNSæœåŠ¡å™¨ï¼Œè¿™äº›éƒ½æ˜¯DNSåŸŸåç§°ç©ºé—´çš„ç»„ç»‡æ–¹å¼ã€‚æŒ‰å…¶åŠŸèƒ½å‘½åç©ºé—´ä¸­ç”¨æ¥æè¿° DNS åŸŸåç§°çš„äº”ä¸ªç±»åˆ«çš„ä»‹ç»è¯¦è§ä¸‹è¡¨ä¸­ï¼Œä»¥åŠä¸æ¯ä¸ªåç§°ç±»å‹çš„ç¤ºä¾‹</p><p><img src="http://img1.51cto.com/attachment/201203/171409287.jpg" alt="DNSåŸŸåçš„ç»„ç»‡æ–¹å¼"></p><p>4ã€<strong>DNSè´Ÿè½½å‡è¡¡</strong></p><p>å½“ä¸€ä¸ªç½‘ç«™æœ‰è¶³å¤Ÿå¤šçš„ç”¨æˆ·çš„æ—¶å€™ï¼Œå‡å¦‚æ¯æ¬¡è¯·æ±‚çš„èµ„æºéƒ½ä½äºåŒä¸€å°æœºå™¨ä¸Šé¢ï¼Œé‚£ä¹ˆè¿™å°æœºå™¨éšæ—¶å¯èƒ½ä¼šè¹¦æ‰ã€‚å¤„ç†åŠæ³•å°±æ˜¯ç”¨DNSè´Ÿè½½å‡è¡¡æŠ€æœ¯ï¼Œå®ƒçš„åŸç†æ˜¯åœ¨DNSæœåŠ¡å™¨ä¸­ä¸ºåŒä¸€ä¸ªä¸»æœºåé…ç½®å¤šä¸ªIPåœ°å€,åœ¨åº”ç­”DNSæŸ¥è¯¢æ—¶,DNSæœåŠ¡å™¨å¯¹æ¯ä¸ªæŸ¥è¯¢å°†ä»¥DNSæ–‡ä»¶ä¸­ä¸»æœºè®°å½•çš„IPåœ°å€æŒ‰é¡ºåºè¿”å›ä¸åŒçš„è§£æç»“æœ,å°†å®¢æˆ·ç«¯çš„è®¿é—®å¼•å¯¼åˆ°ä¸åŒçš„æœºå™¨ä¸Šå»,ä½¿å¾—ä¸åŒçš„å®¢æˆ·ç«¯è®¿é—®ä¸åŒçš„æœåŠ¡å™¨,ä»è€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ï½¡ä¾‹å¦‚å¯ä»¥æ ¹æ®æ¯å°æœºå™¨çš„è´Ÿè½½é‡ï¼Œè¯¥æœºå™¨ç¦»ç”¨æˆ·åœ°ç†ä½ç½®çš„è·ç¦»ç­‰ç­‰ã€‚</p><h2 id="æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚"><a href="#æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚" class="headerlink" title="æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚"></a>æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚</h2><p>æ‹¿åˆ°åŸŸåå¯¹åº”çš„IPåœ°å€ä¹‹åï¼Œæµè§ˆå™¨ä¼šä»¥ä¸€ä¸ªéšæœºç«¯å£ï¼ˆ1024&lt;ç«¯å£&lt;65535ï¼‰å‘æœåŠ¡å™¨çš„WEBç¨‹åºï¼ˆå¸¸ç”¨çš„æœ‰httpd,nginxç­‰ï¼‰80ç«¯å£å‘èµ·TCPçš„è¿æ¥è¯·æ±‚ã€‚è¿™ä¸ªè¿æ¥è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ç«¯åï¼ˆè¿™ä¸­é—´é€šè¿‡å„ç§è·¯ç”±è®¾å¤‡ï¼Œå±€åŸŸç½‘å†…é™¤å¤–ï¼‰ï¼Œè¿›å…¥åˆ°ç½‘å¡ï¼Œç„¶åæ˜¯è¿›å…¥åˆ°å†…æ ¸çš„TCP/IPåè®®æ ˆï¼ˆç”¨äºè¯†åˆ«è¯¥è¿æ¥è¯·æ±‚ï¼Œè§£å°åŒ…ï¼Œä¸€å±‚ä¸€å±‚çš„å‰¥å¼€ï¼‰ï¼Œè¿˜æœ‰å¯èƒ½è¦ç»è¿‡Netfilteré˜²ç«å¢™ï¼ˆå±äºå†…æ ¸çš„æ¨¡å—ï¼‰çš„è¿‡æ»¤ï¼Œæœ€ç»ˆåˆ°è¾¾WEBç¨‹åºï¼Œæœ€ç»ˆå»ºç«‹äº†TCP/IPçš„è¿æ¥ã€‚</p><p>å»ºç«‹äº†TCPè¿æ¥ä¹‹åï¼Œå‘èµ·ä¸€ä¸ªhttpè¯·æ±‚ã€‚ä¸€ä¸ªå…¸å‹çš„ http request header ä¸€èˆ¬éœ€è¦åŒ…æ‹¬è¯·æ±‚çš„æ–¹æ³•ï¼Œä¾‹å¦‚ GET æˆ–è€… POST ç­‰ï¼Œä¸å¸¸ç”¨çš„è¿˜æœ‰ PUT å’Œ DELETE ã€HEADã€OPTIONä»¥åŠ TRACE æ–¹æ³•ï¼Œä¸€èˆ¬çš„æµè§ˆå™¨åªèƒ½å‘èµ· GET æˆ–è€… POST è¯·æ±‚ã€‚</p><blockquote><p>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·httpè¯·æ±‚çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€äº›è¯·æ±‚ä¿¡æ¯ï¼Œè¯·æ±‚ä¿¡æ¯åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p></blockquote><ul><li>è¯·æ±‚æ–¹æ³•URIåè®®/ç‰ˆæœ¬</li><li>è¯·æ±‚å¤´(Request Header)</li><li>è¯·æ±‚æ­£æ–‡ï¼š</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„HTTPè¯·æ±‚ä¾‹å­ï¼š</p><pre><code class="js">GET/sample.jspHTTP/1.1Accept:image/gif.image/jpeg,*/*Accept-Language:zh-cnConnection:Keep-AliveHost:localhostUser-Agent:Mozila/4.0(compatible;MSIE5.01;Window NT5.0)Accept-Encoding:gzip,deflateusername=jinqiao&amp;password=1234</code></pre><p><strong>æ³¨æ„ï¼šæœ€åä¸€ä¸ªè¯·æ±‚å¤´ä¹‹åæ˜¯ä¸€ä¸ªç©ºè¡Œï¼Œå‘é€å›è½¦ç¬¦å’Œæ¢è¡Œç¬¦ï¼Œé€šçŸ¥æœåŠ¡å™¨ä»¥ä¸‹ä¸å†æœ‰è¯·æ±‚å¤´</strong>ã€‚</p><p>ï¼ˆ1ï¼‰è¯·æ±‚çš„ç¬¬ä¸€è¡Œæ˜¯â€œæ–¹æ³•URLè®®/ç‰ˆæœ¬â€ï¼šGET/sample.jsp HTTP/1.1</p><p>ï¼ˆ2ï¼‰è¯·æ±‚å¤´(Request Header)<br>ã€€ã€€ è¯·æ±‚å¤´åŒ…å«è®¸å¤šæœ‰å…³çš„å®¢æˆ·ç«¯ç¯å¢ƒå’Œè¯·æ±‚æ­£æ–‡çš„æœ‰ç”¨ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œè¯·æ±‚å¤´å¯ä»¥å£°æ˜æµè§ˆå™¨æ‰€ç”¨çš„è¯­è¨€ï¼Œè¯·æ±‚æ­£æ–‡çš„é•¿åº¦ç­‰ã€‚</p><p>ï¼ˆ3ï¼‰è¯·æ±‚æ­£æ–‡<br>    è¯·æ±‚å¤´å’Œè¯·æ±‚æ­£æ–‡ä¹‹é—´æ˜¯ä¸€ä¸ªç©ºè¡Œï¼Œè¿™ä¸ªè¡Œéå¸¸é‡è¦ï¼Œå®ƒè¡¨ç¤ºè¯·æ±‚å¤´å·²ç»ç»“æŸï¼Œæ¥ä¸‹æ¥çš„æ˜¯è¯·æ±‚æ­£æ–‡ã€‚è¯·æ±‚æ­£æ–‡ä¸­å¯ä»¥åŒ…å«å®¢æˆ·æäº¤çš„æŸ¥è¯¢å­—ç¬¦ä¸²ä¿¡æ¯ï¼š<code>username=jinqiao&amp;password=1234</code></p><h3 id="çŸ¥è¯†æ‰©å±•"><a href="#çŸ¥è¯†æ‰©å±•" class="headerlink" title="çŸ¥è¯†æ‰©å±•"></a>çŸ¥è¯†æ‰©å±•</h3><h4 id="TCPçš„ä¸‰æ¬¡æ¡æ‰‹"><a href="#TCPçš„ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="TCPçš„ä¸‰æ¬¡æ¡æ‰‹"></a>TCPçš„ä¸‰æ¬¡æ¡æ‰‹</h4><p>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯Aå°†æ ‡å¿—ä½SYNç½®ä¸º1,éšæœºäº§ç”Ÿä¸€ä¸ªå€¼ä¸º<code>seq=J</code>ï¼ˆJçš„å–å€¼èŒƒå›´ä¸º=1234567ï¼‰çš„æ•°æ®åŒ…åˆ°æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯Aè¿›å…¥<code>SYN_SENT</code>çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯Bç¡®è®¤ï¼›</p><p>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯Bæ”¶åˆ°æ•°æ®åŒ…åç”±æ ‡å¿—ä½<code>SYN=1</code>çŸ¥é“å®¢æˆ·ç«¯Aè¯·æ±‚å»ºç«‹è¿æ¥ï¼ŒæœåŠ¡ç«¯Bå°†æ ‡å¿—ä½SYNå’ŒACKéƒ½ç½®ä¸º1ï¼Œ<code>ack=J+1</code>ï¼Œéšæœºäº§ç”Ÿä¸€ä¸ªå€¼<code>seq=K</code>ï¼Œå¹¶å°†è¯¥æ•°æ®åŒ…å‘é€ç»™å®¢æˆ·ç«¯Aä»¥ç¡®è®¤è¿æ¥è¯·æ±‚ï¼ŒæœåŠ¡ç«¯Bè¿›å…¥<code>SYN_RCVD</code>çŠ¶æ€ã€‚</p><p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯Aæ”¶åˆ°ç¡®è®¤åï¼Œæ£€æŸ¥ackæ˜¯å¦ä¸º<code>J+1</code>ï¼ŒACKæ˜¯å¦ä¸º1ï¼Œå¦‚æœæ­£ç¡®åˆ™å°†æ ‡å¿—ä½ACKç½®ä¸º1ï¼Œ<code>ack=K+1</code>ï¼Œå¹¶å°†è¯¥æ•°æ®åŒ…å‘é€ç»™æœåŠ¡ç«¯Bï¼ŒæœåŠ¡ç«¯Bæ£€æŸ¥ackæ˜¯å¦ä¸º<code>K+1</code>ï¼ŒACKæ˜¯å¦ä¸º1ï¼Œå¦‚æœæ­£ç¡®åˆ™è¿æ¥å»ºç«‹æˆåŠŸï¼Œå®¢æˆ·ç«¯Aå’ŒæœåŠ¡ç«¯Bè¿›å…¥<code>ESTABLISHED</code>çŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œéšåå®¢æˆ·ç«¯Aä¸æœåŠ¡ç«¯Bä¹‹é—´å¯ä»¥å¼€å§‹ä¼ è¾“æ•°æ®äº†ã€‚</p><p>å¦‚å›¾æ‰€ç¤º</p><p><img src="http://www.2cto.com/uploadfile/2013/1022/20131022025346218.png" alt="TCPä¸‰æ¬¡æ¡æ‰‹"></p><h4 id="ä¸ºä»€éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ"><a href="#ä¸ºä»€éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ" class="headerlink" title="ä¸ºä»€éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ"></a>ä¸ºä»€éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</h4><p>ã€Šè®¡ç®—æœºç½‘ç»œã€‹ç¬¬å››ç‰ˆä¸­è®²â€œä¸‰æ¬¡æ¡æ‰‹â€çš„ç›®çš„æ˜¯ <strong>â€œä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯â€</strong></p><p>ä¹¦ä¸­çš„ä¾‹å­æ˜¯è¿™æ ·çš„ï¼Œâ€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€çš„äº§ç”Ÿåœ¨è¿™æ ·ä¸€ç§æƒ…å†µä¸‹ï¼šclientå‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾serverã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½†serveræ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯clientå†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘clientå‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚</p><p>å‡è®¾ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦serverå‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ç”±äºç°åœ¨clientå¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼Œå› æ­¤ä¸ä¼šç†ç¬serverçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘serverå‘é€æ•°æ®ã€‚ä½†serverå´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸€ç›´ç­‰å¾…clientå‘æ¥æ•°æ®ã€‚è¿™æ ·ï¼Œserverçš„å¾ˆå¤šèµ„æºå°±ç™½ç™½æµªè´¹æ‰äº†ã€‚</p><p>é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€çš„åŠæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡å‘ç”Ÿã€‚ä¾‹å¦‚åˆšæ‰é‚£ç§æƒ…å†µï¼Œclientä¸ä¼šå‘serverçš„ç¡®è®¤å‘å‡ºç¡®è®¤ã€‚serverç”±äºæ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±çŸ¥é“clientå¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¿æ¥ã€‚â€ã€‚ä¸»è¦ç›®çš„ <strong>é˜²æ­¢serverç«¯ä¸€ç›´ç­‰å¾…ï¼Œæµªè´¹èµ„æº</strong>ã€‚</p><h4 id="TCPå››æ¬¡æŒ¥æ‰‹"><a href="#TCPå››æ¬¡æŒ¥æ‰‹" class="headerlink" title="TCPå››æ¬¡æŒ¥æ‰‹"></a>TCPå››æ¬¡æŒ¥æ‰‹</h4><p>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šClientå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­Clientåˆ°Serverçš„æ•°æ®ä¼ é€ï¼ŒClientè¿›å…¥<code>FIN_WAIT_1</code>çŠ¶æ€ã€‚</p><p>ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šServeræ”¶åˆ°FINåï¼Œå‘é€ä¸€ä¸ªACKç»™Clientï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼ˆä¸SYNç›¸åŒï¼Œä¸€ä¸ªFINå ç”¨ä¸€ä¸ªåºå·ï¼‰ï¼ŒServerè¿›å…¥<code>CLOSE_WAIT</code>çŠ¶æ€ã€‚</p><p>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šServerå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­Serveråˆ°Clientçš„æ•°æ®ä¼ é€ï¼ŒServerè¿›å…¥<code>LAST_ACK</code>çŠ¶æ€ã€‚</p><p>ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šClientæ”¶åˆ°FINåï¼ŒClientè¿›å…¥TIME_WAITçŠ¶æ€ï¼Œæ¥ç€å‘é€ä¸€ä¸ªACKç»™Serverï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼ŒServerè¿›å…¥<code>CLOSED</code>çŠ¶æ€ï¼Œå®Œæˆå››æ¬¡æŒ¥æ‰‹ã€‚</p><p>å¦‚å›¾æ‰€ç¤º:</p><p><img src="http://www.2cto.com/uploadfile/2013/1022/20131022025350523.png" alt="TCPå››æ¬¡æŒ¥æ‰‹"></p><h4 id="ä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œå…³é—­è¿æ¥å´æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œå…³é—­è¿æ¥å´æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œå…³é—­è¿æ¥å´æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œå…³é—­è¿æ¥å´æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ</h4><p>è¿™æ˜¯å› ä¸ºæœåŠ¡ç«¯åœ¨<code>LISTEN</code>çŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°å»ºç«‹è¿æ¥è¯·æ±‚çš„SYNæŠ¥æ–‡åï¼ŒæŠŠACKå’ŒSYNæ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡é‡Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚è€Œå…³é—­è¿æ¥æ—¶ï¼Œå½“æ”¶åˆ°å¯¹æ–¹çš„FINæŠ¥æ–‡æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå¯¹æ–¹ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ï¼Œå·±æ–¹ä¹Ÿæœªå¿…å…¨éƒ¨æ•°æ®éƒ½å‘é€ç»™å¯¹æ–¹äº†ï¼Œæ‰€ä»¥å·±æ–¹å¯ä»¥ç«‹å³closeï¼Œä¹Ÿå¯ä»¥å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹åï¼Œå†å‘é€FINæŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºåŒæ„ç°åœ¨å…³é—­è¿æ¥ï¼Œå› æ­¤ï¼Œå·±æ–¹<code>ACKå’ŒFIN</code>ä¸€èˆ¬éƒ½ä¼šåˆ†å¼€å‘é€ã€‚</p><h2 id="æµè§ˆå™¨çš„æ°¸ä¹…é‡å®šå‘å“åº”"><a href="#æµè§ˆå™¨çš„æ°¸ä¹…é‡å®šå‘å“åº”" class="headerlink" title="æµè§ˆå™¨çš„æ°¸ä¹…é‡å®šå‘å“åº”"></a>æµè§ˆå™¨çš„æ°¸ä¹…é‡å®šå‘å“åº”</h2><p>æœåŠ¡å™¨ç»™æµè§ˆå™¨å“åº”ä¸€ä¸ª301æ°¸ä¹…é‡å®šå‘å“åº”ï¼Œè¿™æ ·æµè§ˆå™¨å°±ä¼šè®¿é—®â€œ<code>http://www.google.com/</code>â€ è€Œéâ€œ<code>http://google.com/</code>â€ã€‚</p><p>ä¸ºä»€ä¹ˆæœåŠ¡å™¨ä¸€å®šè¦é‡å®šå‘è€Œä¸æ˜¯ç›´æ¥å‘é€ç”¨æˆ·æƒ³çœ‹çš„ç½‘é¡µå†…å®¹å‘¢ï¼Ÿå…¶ä¸­ä¸€ä¸ªåŸå› è·Ÿæœç´¢å¼•æ“æ’åæœ‰å…³ã€‚å¦‚æœä¸€ä¸ªé¡µé¢æœ‰ä¸¤ä¸ªåœ°å€ï¼Œå°±åƒ<code>http://www.yy.com/å’Œhttp://yy.com/</code>ï¼Œæœç´¢å¼•æ“ä¼šè®¤ä¸ºå®ƒä»¬æ˜¯ä¸¤ä¸ªç½‘ç«™ï¼Œç»“æœé€ æˆæ¯ä¸ªæœç´¢é“¾æ¥éƒ½å‡å°‘ä»è€Œé™ä½æ’åã€‚è€Œæœç´¢å¼•æ“çŸ¥é“301æ°¸ä¹…é‡å®šå‘æ˜¯ä»€ä¹ˆæ„æ€ï¼Œè¿™æ ·å°±ä¼šæŠŠè®¿é—®å¸¦wwwçš„å’Œä¸å¸¦wwwçš„åœ°å€å½’åˆ°åŒä¸€ä¸ªç½‘ç«™æ’åä¸‹ã€‚è¿˜æœ‰å°±æ˜¯ç”¨ä¸åŒçš„åœ°å€ä¼šé€ æˆç¼“å­˜å‹å¥½æ€§å˜å·®ï¼Œå½“ä¸€ä¸ªé¡µé¢æœ‰å¥½å‡ ä¸ªåå­—æ—¶ï¼Œå®ƒå¯èƒ½ä¼šåœ¨ç¼“å­˜é‡Œå‡ºç°å¥½å‡ æ¬¡ã€‚</p><h3 id="çŸ¥è¯†æ‰©å±•-1"><a href="#çŸ¥è¯†æ‰©å±•-1" class="headerlink" title="çŸ¥è¯†æ‰©å±•"></a>çŸ¥è¯†æ‰©å±•</h3><h4 id="301å’Œ302çš„åŒºåˆ«ã€‚"><a href="#301å’Œ302çš„åŒºåˆ«ã€‚" class="headerlink" title="301å’Œ302çš„åŒºåˆ«ã€‚"></a>301å’Œ302çš„åŒºåˆ«ã€‚</h4><p>301å’Œ302çŠ¶æ€ç éƒ½è¡¨ç¤ºé‡å®šå‘ï¼Œå°±æ˜¯è¯´æµè§ˆå™¨åœ¨æ‹¿åˆ°æœåŠ¡å™¨è¿”å›çš„è¿™ä¸ªçŠ¶æ€ç åä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„URLåœ°å€ï¼Œè¿™ä¸ªåœ°å€å¯ä»¥ä»å“åº”çš„Locationé¦–éƒ¨ä¸­è·å–ï¼ˆç”¨æˆ·çœ‹åˆ°çš„æ•ˆæœå°±æ˜¯ä»–è¾“å…¥çš„åœ°å€Aç¬é—´å˜æˆäº†å¦ä¸€ä¸ªåœ°å€Bï¼‰â€”â€”è¿™æ˜¯å®ƒä»¬çš„å…±åŒç‚¹ã€‚</p><p>ä»–ä»¬çš„ä¸åŒåœ¨äºã€‚<strong>301è¡¨ç¤ºæ—§åœ°å€Açš„èµ„æºå·²ç»è¢«æ°¸ä¹…åœ°ç§»é™¤äº†ï¼ˆè¿™ä¸ªèµ„æºä¸å¯è®¿é—®äº†ï¼‰ï¼Œæœç´¢å¼•æ“åœ¨æŠ“å–æ–°å†…å®¹çš„åŒæ—¶ä¹Ÿå°†æ—§çš„ç½‘å€äº¤æ¢ä¸ºé‡å®šå‘ä¹‹åçš„ç½‘å€</strong>ï¼›</p><p>302è¡¨ç¤º <strong>æ—§åœ°å€Açš„èµ„æºè¿˜åœ¨ï¼ˆä»ç„¶å¯ä»¥è®¿é—®ï¼‰ï¼Œè¿™ä¸ªé‡å®šå‘åªæ˜¯ä¸´æ—¶åœ°ä»æ—§åœ°å€Aè·³è½¬åˆ°åœ°å€Bï¼Œæœç´¢å¼•æ“ä¼šæŠ“å–æ–°çš„å†…å®¹è€Œä¿å­˜æ—§çš„ç½‘å€ã€‚ SEO302å¥½äº301</strong></p><h4 id="é‡å®šå‘åŸå› ï¼š"><a href="#é‡å®šå‘åŸå› ï¼š" class="headerlink" title="é‡å®šå‘åŸå› ï¼š"></a>é‡å®šå‘åŸå› ï¼š</h4><p>ï¼ˆ1ï¼‰ç½‘ç«™è°ƒæ•´ï¼ˆå¦‚æ”¹å˜ç½‘é¡µç›®å½•ç»“æ„ï¼‰ï¼›</p><p>ï¼ˆ2ï¼‰ç½‘é¡µè¢«ç§»åˆ°ä¸€ä¸ªæ–°åœ°å€ï¼›</p><p>ï¼ˆ3ï¼‰ç½‘é¡µæ‰©å±•åæ”¹å˜(å¦‚åº”ç”¨éœ€è¦æŠŠ.phpæ”¹æˆ.Htmlæˆ–.shtml)ã€‚<br>    è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸åšé‡å®šå‘ï¼Œåˆ™ç”¨æˆ·æ”¶è—å¤¹æˆ–æœç´¢å¼•æ“æ•°æ®åº“ä¸­æ—§åœ°å€åªèƒ½è®©è®¿é—®å®¢æˆ·å¾—åˆ°ä¸€ä¸ª404é¡µé¢é”™è¯¯ä¿¡æ¯ï¼Œè®¿é—®æµé‡ç™½ç™½ä¸§å¤±ï¼›å†è€…æŸäº›æ³¨å†Œäº†å¤šä¸ªåŸŸåçš„ç½‘ç«™ï¼Œä¹Ÿéœ€è¦é€šè¿‡é‡å®šå‘è®©è®¿é—®è¿™äº›åŸŸåçš„ç”¨æˆ·è‡ªåŠ¨è·³è½¬åˆ°ä¸»ç«™ç‚¹ç­‰ã€‚</p><h3 id="ä»€ä¹ˆæ—¶å€™è¿›è¡Œ301æˆ–è€…302è·³è½¬å‘¢ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™è¿›è¡Œ301æˆ–è€…302è·³è½¬å‘¢ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™è¿›è¡Œ301æˆ–è€…302è·³è½¬å‘¢ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™è¿›è¡Œ301æˆ–è€…302è·³è½¬å‘¢ï¼Ÿ</h3><p>å½“ä¸€ä¸ªç½‘ç«™æˆ–è€…ç½‘é¡µ24â€”48å°æ—¶å†…ä¸´æ—¶ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„ä½ç½®ï¼Œè¿™æ—¶å€™å°±è¦è¿›è¡Œ302è·³è½¬ï¼Œè€Œä½¿ç”¨301è·³è½¬çš„åœºæ™¯å°±æ˜¯ä¹‹å‰çš„ç½‘ç«™å› ä¸ºæŸç§åŸå› éœ€è¦ç§»é™¤æ‰ï¼Œç„¶åè¦åˆ°æ–°çš„åœ°å€è®¿é—®ï¼Œæ˜¯æ°¸ä¹…æ€§çš„ã€‚</p><blockquote><p>æ¸…æ™°æ˜ç¡®è€Œè¨€ï¼šä½¿ç”¨301è·³è½¬çš„å¤§æ¦‚åœºæ™¯å¦‚ä¸‹ï¼š</p><ul><li>1ã€åŸŸååˆ°æœŸä¸æƒ³ç»­è´¹ï¼ˆæˆ–è€…å‘ç°äº†æ›´é€‚åˆç½‘ç«™çš„åŸŸåï¼‰ï¼Œæƒ³æ¢ä¸ªåŸŸåã€‚</li><li>2ã€åœ¨æœç´¢å¼•æ“çš„æœç´¢ç»“æœä¸­å‡ºç°äº†ä¸å¸¦wwwçš„åŸŸåï¼Œè€Œå¸¦wwwçš„åŸŸåå´æ²¡æœ‰æ”¶å½•ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨301é‡å®šå‘æ¥å‘Šè¯‰æœç´¢å¼•æ“æˆ‘ä»¬ç›®æ ‡çš„åŸŸåæ˜¯å“ªä¸€ä¸ªã€‚</li><li>3ã€ç©ºé—´æœåŠ¡å™¨ä¸ç¨³å®šï¼Œæ¢ç©ºé—´çš„æ—¶å€™ã€‚</li></ul></blockquote><h2 id="æµè§ˆå™¨è·Ÿè¸ªé‡å®šå‘åœ°å€"><a href="#æµè§ˆå™¨è·Ÿè¸ªé‡å®šå‘åœ°å€" class="headerlink" title="æµè§ˆå™¨è·Ÿè¸ªé‡å®šå‘åœ°å€"></a>æµè§ˆå™¨è·Ÿè¸ªé‡å®šå‘åœ°å€</h2><p>ç°åœ¨æµè§ˆå™¨çŸ¥é“äº† â€œ<code>http://www.google.com/</code>â€œæ‰æ˜¯è¦è®¿é—®çš„æ­£ç¡®åœ°å€ï¼Œæ‰€ä»¥å®ƒä¼šå‘é€å¦ä¸€ä¸ªhttpè¯·æ±‚ã€‚è¿™é‡Œæ²¡æœ‰å•¥å¥½è¯´çš„</p><h2 id="æœåŠ¡å™¨å¤„ç†è¯·æ±‚"><a href="#æœåŠ¡å™¨å¤„ç†è¯·æ±‚" class="headerlink" title="æœåŠ¡å™¨å¤„ç†è¯·æ±‚"></a>æœåŠ¡å™¨å¤„ç†è¯·æ±‚</h2><p>ç»è¿‡å‰é¢çš„é‡é‡æ­¥éª¤ï¼Œæˆ‘ä»¬ç»ˆäºå°†æˆ‘ä»¬çš„httpè¯·æ±‚å‘é€åˆ°äº†æœåŠ¡å™¨è¿™é‡Œï¼Œå…¶å®å‰é¢çš„é‡å®šå‘å·²ç»æ˜¯åˆ°è¾¾æœåŠ¡å™¨äº†ï¼Œé‚£ä¹ˆï¼ŒæœåŠ¡å™¨æ˜¯å¦‚ä½•å¤„ç†æˆ‘ä»¬çš„è¯·æ±‚çš„å‘¢ï¼Ÿ</p><p>åç«¯ä»åœ¨å›ºå®šçš„ç«¯å£æ¥æ”¶åˆ°TCPæŠ¥æ–‡å¼€å§‹ï¼Œå®ƒä¼šå¯¹TCPè¿æ¥è¿›è¡Œå¤„ç†ï¼Œå¯¹HTTPåè®®è¿›è¡Œè§£æï¼Œå¹¶æŒ‰ç…§æŠ¥æ–‡æ ¼å¼è¿›ä¸€æ­¥å°è£…æˆ<code>HTTP Request</code>å¯¹è±¡ï¼Œä¾›ä¸Šå±‚ä½¿ç”¨ã€‚</p><p>ä¸€äº›å¤§ä¸€ç‚¹çš„ç½‘ç«™ä¼šå°†ä½ çš„è¯·æ±‚åˆ°åå‘ä»£ç†æœåŠ¡å™¨ä¸­ï¼Œå› ä¸ºå½“ç½‘ç«™è®¿é—®é‡éå¸¸å¤§ï¼Œç½‘ç«™è¶Šæ¥è¶Šæ…¢ï¼Œä¸€å°æœåŠ¡å™¨å·²ç»ä¸å¤Ÿç”¨äº†ã€‚äºæ˜¯å°†åŒä¸€ä¸ªåº”ç”¨éƒ¨ç½²åœ¨å¤šå°æœåŠ¡å™¨ä¸Šï¼Œå°†å¤§é‡ç”¨æˆ·çš„è¯·æ±‚åˆ†é…ç»™å¤šå°æœºå™¨å¤„ç†ã€‚æ­¤æ—¶ï¼Œå®¢æˆ·ç«¯ä¸æ˜¯ç›´æ¥é€šè¿‡HTTPåè®®è®¿é—®æŸç½‘ç«™åº”ç”¨æœåŠ¡å™¨ï¼Œè€Œæ˜¯å…ˆè¯·æ±‚åˆ°Nginxï¼ŒNginxå†è¯·æ±‚åº”ç”¨æœåŠ¡å™¨ï¼Œç„¶åå°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè¿™é‡ŒNginxçš„ä½œç”¨æ˜¯<strong>åå‘ä»£ç†æœåŠ¡å™¨</strong>ã€‚åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªå¥½å¤„ï¼Œå…¶ä¸­ä¸€å°æœåŠ¡å™¨ä¸‡ä¸€æŒ‚äº†ï¼Œåªè¦è¿˜æœ‰å…¶ä»–æœåŠ¡å™¨æ­£å¸¸è¿è¡Œï¼Œå°±ä¸ä¼šå½±å“ç”¨æˆ·ä½¿ç”¨ã€‚</p><p>å¦‚å›¾æ‰€ç¤º</p><p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1489904964343&amp;di=c6043cd72bb60f4e129589b6a8f79299&amp;imgtype=0&amp;src=http%3A%2F%2Fhi.csdn.net%2Fattachment%2F201110%2F10%2F0_1318255239Hxxe.gif" alt="å¤„ç†è¯·æ±‚"></p><p>é€šè¿‡Nginxçš„åå‘ä»£ç†ï¼Œæˆ‘ä»¬åˆ°è¾¾äº†webæœåŠ¡å™¨ï¼ŒæœåŠ¡ç«¯è„šæœ¬å¤„ç†æˆ‘ä»¬çš„è¯·æ±‚ï¼Œè®¿é—®æˆ‘ä»¬çš„æ•°æ®åº“ï¼Œè·å–éœ€è¦è·å–çš„å†…å®¹ç­‰ç­‰ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¶‰åŠå¾ˆå¤šåç«¯è„šæœ¬çš„å¤æ‚æ“ä½œã€‚ç”±äºå¯¹è¿™ä¸€å—ä¸ç†Ÿï¼Œæ‰€ä»¥è¿™ä¸€å—åªèƒ½ä»‹ç»è¿™ä¹ˆå¤šäº†ã€‚</p><h3 id="æ‰©å±•é˜…è¯»ï¼š"><a href="#æ‰©å±•é˜…è¯»ï¼š" class="headerlink" title="æ‰©å±•é˜…è¯»ï¼š"></a>æ‰©å±•é˜…è¯»ï¼š</h3><h4 id="ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿ</h4><p>å®¢æˆ·ç«¯æœ¬æ¥å¯ä»¥ç›´æ¥é€šè¿‡HTTPåè®®è®¿é—®æŸç½‘ç«™åº”ç”¨æœåŠ¡å™¨ï¼Œç½‘ç«™ç®¡ç†å‘˜å¯ä»¥åœ¨ä¸­é—´åŠ ä¸Šä¸€ä¸ªNginxï¼Œå®¢æˆ·ç«¯è¯·æ±‚Nginxï¼ŒNginxè¯·æ±‚åº”ç”¨æœåŠ¡å™¨ï¼Œç„¶åå°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶Nginxå°±æ˜¯åå‘ä»£ç†æœåŠ¡å™¨ã€‚</p><p><img src="http://www.2cto.com/uploadfile/Collfiles/20150518/201505180932502.jpg" alt="Nginx"></p><h2 id="æœåŠ¡å™¨è¿”å›ä¸€ä¸ªHTTPå“åº”"><a href="#æœåŠ¡å™¨è¿”å›ä¸€ä¸ªHTTPå“åº”" class="headerlink" title="æœåŠ¡å™¨è¿”å›ä¸€ä¸ªHTTPå“åº”"></a>æœåŠ¡å™¨è¿”å›ä¸€ä¸ªHTTPå“åº”</h2><p>ç»è¿‡å‰é¢çš„6ä¸ªæ­¥éª¤ï¼ŒæœåŠ¡å™¨æ”¶åˆ°äº†æˆ‘ä»¬çš„è¯·æ±‚ï¼Œä¹Ÿå¤„ç†æˆ‘ä»¬çš„è¯·æ±‚ï¼Œåˆ°è¿™ä¸€æ­¥ï¼Œå®ƒä¼šæŠŠå®ƒçš„å¤„ç†ç»“æœè¿”å›ï¼Œä¹Ÿå°±æ˜¯è¿”å›ä¸€ä¸ªHTPPå“åº”ã€‚<br>HTTPå“åº”ä¸HTTPè¯·æ±‚ç›¸ä¼¼ï¼Œ</p><blockquote><p>HTTPå“åº”ä¹Ÿç”±3ä¸ªéƒ¨åˆ†æ„æˆï¼Œåˆ†åˆ«æ˜¯ï¼š</p></blockquote><ul><li>çŠ¶æ€è¡Œ</li><li>å“åº”å¤´(Response Header)</li><li>å“åº”æ­£æ–‡</li></ul><pre><code class="js">HTTP/1.1 200 OKDate: Sat, 31 Dec 2005 23:59:59 GMTContent-Type: text/html;charset=ISO-8859-1Content-Length: 122ï¼œhtmlï¼ï¼œheadï¼ï¼œtitleï¼httpï¼œ/titleï¼ï¼œ/headï¼ï¼œbodyï¼ï¼œ!-- body goes here --ï¼ï¼œ/bodyï¼ï¼œ/htmlï¼</code></pre><p>çŠ¶æ€è¡Œï¼š</p><p>çŠ¶æ€è¡Œç”±<code>åè®®ç‰ˆæœ¬ã€æ•°å­—å½¢å¼çš„çŠ¶æ€ä»£ç ã€åŠç›¸åº”çš„çŠ¶æ€</code>æè¿°ï¼Œå„å…ƒç´ ä¹‹é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚<br>æ ¼å¼: <code>HTTP-Version Status-Code Reason-Phrase CRLF</code></p><p>ä¾‹å¦‚: <code>HTTP/1.1 200 OK \r\n</code></p><p>â€“ åè®®ç‰ˆæœ¬ï¼šæ˜¯ç”¨<code>http1.0</code>è¿˜æ˜¯å…¶ä»–ç‰ˆæœ¬</p><p>â€“ çŠ¶æ€æè¿°ï¼šçŠ¶æ€æè¿°ç»™å‡ºäº†å…³äºçŠ¶æ€ä»£ç çš„ç®€çŸ­çš„æ–‡å­—æè¿°ã€‚æ¯”å¦‚çŠ¶æ€ä»£ç ä¸º200æ—¶çš„æè¿°ä¸º ok</p><p>â€“ çŠ¶æ€ä»£ç ï¼šçŠ¶æ€ä»£ç ç”±ä¸‰ä½æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰äº†å“åº”çš„ç±»åˆ«ï¼Œä¸”æœ‰äº”ç§å¯èƒ½å–å€¼ã€‚å¦‚ä¸‹</p><blockquote><p>1xxï¼šä¿¡æ¯æ€§çŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å·²æ¥æ”¶äº†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå®¢æˆ·ç«¯å¯ç»§ç»­å‘é€è¯·æ±‚ã€‚</p></blockquote><ul><li>100 Continue</li><li>101 Switching Protocols</li></ul><blockquote><p>2xxï¼šæˆåŠŸçŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å·²æˆåŠŸæ¥æ”¶åˆ°è¯·æ±‚å¹¶è¿›è¡Œå¤„ç†ã€‚</p></blockquote><ul><li>200 OK è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ</li><li>204 No Content æˆåŠŸï¼Œä½†ä¸è¿”å›ä»»ä½•å®ä½“çš„ä¸»ä½“éƒ¨åˆ†</li><li>206 Partial Content æˆåŠŸæ‰§è¡Œäº†ä¸€ä¸ªèŒƒå›´ï¼ˆRangeï¼‰è¯·æ±‚</li></ul><blockquote><p>3xxï¼šé‡å®šå‘çŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¦æ±‚å®¢æˆ·ç«¯é‡å®šå‘ã€‚</p></blockquote><ul><li>301 Moved Permanently æ°¸ä¹…æ€§é‡å®šå‘ï¼Œå“åº”æŠ¥æ–‡çš„Locationé¦–éƒ¨åº”è¯¥æœ‰è¯¥èµ„æºçš„æ–°URL</li><li>302 Found ä¸´æ—¶æ€§é‡å®šå‘ï¼Œå“åº”æŠ¥æ–‡çš„Locationé¦–éƒ¨ç»™å‡ºçš„URLç”¨æ¥ä¸´æ—¶å®šä½èµ„æº</li><li>303 See Other è¯·æ±‚çš„èµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ªURIï¼Œå®¢æˆ·ç«¯åº”ä½¿ç”¨GETæ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æº</li><li>304 Not Modified æœåŠ¡å™¨å†…å®¹æ²¡æœ‰æ›´æ–°ï¼Œå¯ä»¥ç›´æ¥è¯»å–æµè§ˆå™¨ç¼“å­˜</li><li>307 Temporary Redirect ä¸´æ—¶é‡å®šå‘ã€‚ä¸302 Foundå«ä¹‰ä¸€æ ·ã€‚302ç¦æ­¢POSTå˜æ¢ä¸ºGETï¼Œä½†å®é™…ä½¿ç”¨æ—¶å¹¶ä¸ä¸€å®šï¼Œ307åˆ™æ›´å¤šæµè§ˆå™¨å¯èƒ½ä¼šéµå¾ªè¿™ä¸€æ ‡å‡†ï¼Œä½†ä¹Ÿä¾èµ–äºæµè§ˆå™¨å…·ä½“å®ç°</li></ul><blockquote><p>4xxï¼šå®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯çš„è¯·æ±‚æœ‰éæ³•å†…å®¹ã€‚</p></blockquote><ul><li>400 Bad Request è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£</li><li>401 Unauthonzed è¡¨ç¤ºè¯·æ±‚æœªç»æˆæƒï¼Œè¯¥çŠ¶æ€ä»£ç å¿…é¡»ä¸ WWW-Authenticate æŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨</li><li>403 Forbidden è¡¨ç¤ºæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡ï¼Œé€šå¸¸ä¼šåœ¨å“åº”æ­£æ–‡ä¸­ç»™å‡ºä¸æä¾›æœåŠ¡çš„åŸå› </li><li>404 Not Found è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ï¼Œä¾‹å¦‚ï¼Œè¾“å…¥äº†é”™è¯¯çš„URL</li></ul><blockquote><p>5xxï¼šæœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨æœªèƒ½æ­£å¸¸å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚è€Œå‡ºç°æ„å¤–é”™è¯¯ã€‚</p></blockquote><ul><li>500 Internel Server Error è¡¨ç¤ºæœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯ï¼Œå¯¼è‡´æ— æ³•å®Œæˆå®¢æˆ·ç«¯çš„è¯·æ±‚</li><li>503 Service Unavailable è¡¨ç¤ºæœåŠ¡å™¨å½“å‰ä¸èƒ½å¤Ÿå¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œåœ¨ä¸€æ®µæ—¶é—´ä¹‹åï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šæ¢å¤æ­£å¸¸</li></ul><blockquote><p>å“åº”å¤´ï¼š</p></blockquote><p>å“åº”å¤´éƒ¨ï¼šç”±å…³é”®å­—/å€¼å¯¹ç»„æˆï¼Œæ¯è¡Œä¸€å¯¹ï¼Œå…³é”®å­—å’Œå€¼ç”¨è‹±æ–‡å†’å·â€:â€åˆ†éš”ï¼Œå…¸å‹çš„å“åº”å¤´æœ‰ï¼š</p><p><img src="https://images2015.cnblogs.com/blog/776370/201703/776370-20170322193336611-2098719977.png" alt="å“åº”å¤´"></p><blockquote><p>å“åº”æ­£æ–‡</p></blockquote><p>åŒ…å«ç€æˆ‘ä»¬éœ€è¦çš„ä¸€äº›å…·ä½“ä¿¡æ¯ï¼Œæ¯”å¦‚cookieï¼Œhtml,imageï¼Œåç«¯è¿”å›çš„è¯·æ±‚æ•°æ®ç­‰ç­‰ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå“åº”æ­£æ–‡å’Œå“åº”å¤´ä¹‹é—´æœ‰ä¸€è¡Œç©ºæ ¼ï¼Œè¡¨ç¤ºå“åº”å¤´çš„ä¿¡æ¯åˆ°ç©ºæ ¼ä¸ºæ­¢ï¼Œä¸‹å›¾æ˜¯fiddleræŠ“åˆ°çš„è¯·æ±‚æ­£æ–‡ï¼Œçº¢è‰²æ¡†ä¸­çš„ï¼šå“åº”æ­£æ–‡ï¼š</p><p><img src="https://images2015.cnblogs.com/blog/776370/201703/776370-20170319190828323-2078498869.png" alt="å“åº”æ­£æ–‡"></p><h2 id="æµè§ˆå™¨æ˜¾ç¤ºHTML"><a href="#æµè§ˆå™¨æ˜¾ç¤ºHTML" class="headerlink" title="æµè§ˆå™¨æ˜¾ç¤ºHTML"></a>æµè§ˆå™¨æ˜¾ç¤ºHTML</h2><p>åœ¨æµè§ˆå™¨æ²¡æœ‰å®Œæ•´æ¥å—å…¨éƒ¨HTMLæ–‡æ¡£æ—¶ï¼Œå®ƒå°±å·²ç»å¼€å§‹æ˜¾ç¤ºè¿™ä¸ªé¡µé¢äº†ï¼Œæµè§ˆå™¨æ˜¯å¦‚ä½•æŠŠé¡µé¢å‘ˆç°åœ¨å±å¹•ä¸Šçš„å‘¢ï¼Ÿä¸åŒæµè§ˆå™¨å¯èƒ½è§£æçš„è¿‡ç¨‹ä¸å¤ªä¸€æ ·ï¼Œè¿™é‡Œæˆ‘ä»¬åªä»‹ç»webkitçš„æ¸²æŸ“è¿‡ç¨‹ï¼Œä¸‹å›¾å¯¹åº”çš„å°±æ˜¯WebKitæ¸²æŸ“çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬ï¼š</p><ul><li>è§£æhtmlä»¥æ„å»ºdomæ ‘ -&gt; æ„å»ºrenderæ ‘ -&gt; å¸ƒå±€renderæ ‘ -&gt; ç»˜åˆ¶renderæ ‘</li></ul><p><img src="https://segmentfault.com/img/bVCZ1H?w=694&amp;h=340" alt="è§£æhtml"></p><p>æµè§ˆå™¨åœ¨è§£æhtmlæ–‡ä»¶æ—¶ï¼Œä¼š<strong>è‡ªä¸Šè€Œä¸‹</strong>åŠ è½½ï¼Œå¹¶åœ¨åŠ è½½è¿‡ç¨‹ä¸­è¿›è¡Œè§£ææ¸²æŸ“ã€‚åœ¨è§£æè¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°è¯·æ±‚å¤–éƒ¨èµ„æºæ—¶ï¼Œå¦‚<code>å›¾ç‰‡ã€å¤–é“¾çš„CSSã€iconfont</code>ç­‰ï¼Œè¯·æ±‚è¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸ä¼šå½±å“htmlæ–‡æ¡£è¿›è¡ŒåŠ è½½ã€‚</p><p>è§£æè¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨é¦–å…ˆä¼šè§£æHTMLæ–‡ä»¶æ„å»ºDOMæ ‘ï¼Œç„¶åè§£æCSSæ–‡ä»¶æ„å»ºæ¸²æŸ“æ ‘ï¼Œç­‰åˆ°æ¸²æŸ“æ ‘æ„å»ºå®Œæˆåï¼Œæµè§ˆå™¨å¼€å§‹å¸ƒå±€æ¸²æŸ“æ ‘å¹¶å°†å…¶ç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæ¶‰åŠåˆ°ä¸¤ä¸ªæ¦‚å¿µ: <strong>reflow(å›æµ)å’Œrepain(é‡ç»˜)</strong>ã€‚</p><p>DOMèŠ‚ç‚¹ä¸­çš„å„ä¸ªå…ƒç´ éƒ½æ˜¯ä»¥ç›’æ¨¡å‹çš„å½¢å¼å­˜åœ¨ï¼Œè¿™äº›éƒ½éœ€è¦æµè§ˆå™¨å»<em>è®¡ç®—å…¶ä½ç½®å’Œå¤§å°ç­‰ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºrelow</em>;å½“ç›’æ¨¡å‹çš„ä½ç½®,å¤§å°ä»¥åŠå…¶ä»–å±æ€§ï¼Œå¦‚é¢œè‰²,å­—ä½“,ç­‰ç¡®å®šä¸‹æ¥ä¹‹åï¼Œæµè§ˆå™¨ä¾¿å¼€å§‹<em>ç»˜åˆ¶å†…å®¹ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºrepain</em>ã€‚</p><p>é¡µé¢åœ¨<strong>é¦–æ¬¡åŠ è½½</strong>æ—¶å¿…ç„¶ä¼šç»å†reflowå’Œrepainã€‚reflowå’Œrepainè¿‡ç¨‹æ˜¯éå¸¸æ¶ˆè€—æ€§èƒ½çš„ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼Œå®ƒä¼šç ´åç”¨æˆ·ä½“éªŒï¼Œæœ‰æ—¶ä¼šé€ æˆé¡µé¢å¡é¡¿ã€‚æ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½å¯èƒ½å°‘çš„å‡å°‘reflowå’Œrepainã€‚</p><p><img src="https://segmentfault.com/img/bVC1uE?w=734&amp;h=689" alt="åŠ è½½js"></p><p>å½“æ–‡æ¡£åŠ è½½è¿‡ç¨‹ä¸­é‡åˆ°jsæ–‡ä»¶ï¼Œhtmlæ–‡æ¡£ä¼šæŒ‚èµ·<strong>æ¸²æŸ“ï¼ˆåŠ è½½è§£ææ¸²æŸ“åŒæ­¥ï¼‰çš„çº¿ç¨‹</strong>sï¼Œä¸ä»…è¦ç­‰å¾…æ–‡æ¡£ä¸­jsæ–‡ä»¶åŠ è½½å®Œæ¯•ï¼Œè¿˜è¦ç­‰å¾…è§£ææ‰§è¡Œå®Œæ¯•ï¼Œæ‰å¯ä»¥æ¢å¤htmlæ–‡æ¡£çš„æ¸²æŸ“çº¿ç¨‹ã€‚å› ä¸ºJSæœ‰å¯èƒ½ä¼šä¿®æ”¹DOMï¼Œæœ€ä¸ºç»å…¸çš„document.writeï¼Œè¿™æ„å‘³ç€ï¼Œåœ¨JSæ‰§è¡Œå®Œæˆå‰ï¼Œåç»­æ‰€æœ‰èµ„æºçš„ä¸‹è½½å¯èƒ½æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œè¿™æ˜¯jsé˜»å¡åç»­èµ„æºä¸‹è½½çš„æ ¹æœ¬åŸå› ã€‚æ‰€ä»¥æˆ‘æ˜å¹³æ—¶çš„ä»£ç ä¸­ï¼Œjsæ˜¯æ”¾åœ¨htmlæ–‡æ¡£æœ«å°¾çš„ã€‚</p><p>JSçš„è§£ææ˜¯<strong>ç”±æµè§ˆå™¨ä¸­çš„JSè§£æå¼•æ“å®Œæˆçš„</strong>ï¼Œæ¯”å¦‚è°·æ­Œçš„æ˜¯V8ã€‚JSæ˜¯<strong>å•çº¿ç¨‹è¿è¡Œ</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨åŒä¸€ä¸ªæ—¶é—´å†…åªèƒ½åšä¸€ä»¶äº‹ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½éœ€è¦æ’é˜Ÿï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸï¼Œåä¸€ä¸ªä»»åŠ¡æ‰èƒ½å¼€å§‹ã€‚ä½†æ˜¯åˆå­˜åœ¨æŸäº›ä»»åŠ¡æ¯”è¾ƒè€—æ—¶ï¼Œå¦‚IOè¯»å†™ç­‰ï¼Œæ‰€ä»¥éœ€è¦ä¸€ç§æœºåˆ¶å¯ä»¥å…ˆæ‰§è¡Œæ’åœ¨åé¢çš„ä»»åŠ¡ï¼Œè¿™å°±æ˜¯ï¼š<code>åŒæ­¥ä»»åŠ¡(synchronous)å’Œå¼‚æ­¥ä»»åŠ¡(asynchronous)</code>ã€‚</p><p>JSçš„æ‰§è¡Œæœºåˆ¶å°±å¯ä»¥çœ‹åšæ˜¯<strong>ä¸€ä¸ªä¸»çº¿ç¨‹åŠ ä¸Šä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—(task queue)</strong>ã€‚åŒæ­¥ä»»åŠ¡å°±æ˜¯æ”¾åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¼‚æ­¥ä»»åŠ¡æ˜¯æ”¾åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚æ‰€æœ‰çš„åŒæ­¥ä»»åŠ¡åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆ;å¼‚æ­¥ä»»åŠ¡æœ‰äº†è¿è¡Œç»“æœå°±ä¼šåœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­æ”¾ç½®ä¸€ä¸ªäº‹ä»¶ï¼›è„šæœ¬è¿è¡Œæ—¶å…ˆä¾æ¬¡è¿è¡Œæ‰§è¡Œæ ˆï¼Œç„¶åä¼šä»ä»»åŠ¡é˜Ÿåˆ—é‡Œæå–äº‹ä»¶ï¼Œè¿è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸æ–­é‡å¤çš„ï¼Œæ‰€ä»¥åˆå«åš<code>äº‹ä»¶å¾ªç¯(Event loop)</code>ã€‚</p><h2 id="æµè§ˆå™¨å‘é€è¯·æ±‚åµŒå…¥HTMLä¸­çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ï¼Œcss-jsç­‰ï¼‰"><a href="#æµè§ˆå™¨å‘é€è¯·æ±‚åµŒå…¥HTMLä¸­çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ï¼Œcss-jsç­‰ï¼‰" class="headerlink" title="æµè§ˆå™¨å‘é€è¯·æ±‚åµŒå…¥HTMLä¸­çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ï¼Œcss,jsç­‰ï¼‰"></a>æµè§ˆå™¨å‘é€è¯·æ±‚åµŒå…¥HTMLä¸­çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ï¼Œcss,jsç­‰ï¼‰</h2><p>å…¶å®è¿™ä¸ªæ­¥éª¤å¯ä»¥å¹¶åˆ—åœ¨æ­¥éª¤8ä¸­ï¼Œåœ¨æµè§ˆå™¨æ˜¾ç¤ºHTMLæ—¶ï¼Œå®ƒä¼šæ³¨æ„åˆ°éœ€è¦è·å–å…¶ä»–åœ°å€å†…å®¹çš„æ ‡ç­¾ã€‚è¿™æ—¶ï¼Œæµè§ˆå™¨ä¼šå‘é€ä¸€ä¸ªè·å–è¯·æ±‚æ¥é‡æ–°è·å¾—è¿™äº›æ–‡ä»¶ã€‚æ¯”å¦‚æˆ‘è¦è·å–å¤–å›¾ç‰‡ï¼ŒCSSï¼ŒJSæ–‡ä»¶ç­‰ï¼Œç±»ä¼¼äºä¸‹é¢çš„é“¾æ¥ï¼š</p><p>å›¾ç‰‡ï¼š<code>http://static.ak.fbcdn.net/rsrc.php/z12E0/hash/8q2anwu7.gif</code></p><p>CSSå¼æ ·è¡¨ï¼š<code>http://static.ak.fbcdn.net/rsrc.php/z448Z/hash/2plh8s4n.css</code></p><p>JavaScript æ–‡ä»¶ï¼š<code>http://static.ak.fbcdn.net/rsrc.php/zEMOA/hash/c8yzb6ub.js</code></p><p>è¿™äº›åœ°å€éƒ½è¦ç»å†ä¸€ä¸ªå’ŒHTMLè¯»å–ç±»ä¼¼çš„è¿‡ç¨‹ã€‚æ‰€ä»¥æµè§ˆå™¨ä¼šåœ¨DNSä¸­æŸ¥æ‰¾è¿™äº›åŸŸåï¼Œå‘é€è¯·æ±‚ï¼Œé‡å®šå‘ç­‰ç­‰â€¦</p><p>ä¸åƒåŠ¨æ€é¡µé¢ï¼Œé™æ€æ–‡ä»¶ä¼šå…è®¸æµè§ˆå™¨å¯¹å…¶è¿›è¡Œç¼“å­˜ã€‚æœ‰çš„æ–‡ä»¶å¯èƒ½ä¼šä¸éœ€è¦ä¸æœåŠ¡å™¨é€šè®¯ï¼Œè€Œä»ç¼“å­˜ä¸­ç›´æ¥è¯»å–ï¼Œæˆ–è€…å¯ä»¥æ”¾åˆ°CDNä¸­\</p><p><a href="https://www.cnblogs.com/xianyulaodi/p/6547807.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°é—­äº†å†…å¿ƒå´åŒ…å®¹äº†å¤©ä¸‹ï¼Œé—­åŒ…ä½ å¹¶ä¸å­¤ç‹¬</title>
      <link href="/2018/07/06/Js/%E5%B0%81%E9%97%AD%E4%BA%86%E5%86%85%E5%BF%83%E5%8D%B4%E5%8C%85%E5%AE%B9%E4%BA%86%E5%A4%A9%E4%B8%8B%EF%BC%8C%E9%97%AD%E5%8C%85%E4%BD%A0%E5%B9%B6%E4%B8%8D%E5%AD%A4%E7%8B%AC/"/>
      <url>/2018/07/06/Js/%E5%B0%81%E9%97%AD%E4%BA%86%E5%86%85%E5%BF%83%E5%8D%B4%E5%8C%85%E5%AE%B9%E4%BA%86%E5%A4%A9%E4%B8%8B%EF%BC%8C%E9%97%AD%E5%8C%85%E4%BD%A0%E5%B9%B6%E4%B8%8D%E5%AD%A4%E7%8B%AC/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ–‡ä¹‹æ‰€ä»¥ä¼šå†™è¿™ç§è€ç”Ÿå¸¸è°ˆçš„æ–‡ç« ï¼Œæ˜¯ä¸ºäº†æ¥ä¸‹æ¥çš„è®¾è®¡æ¨¡å¼åšé“ºå«ã€‚æ—¢ç„¶å·²ç»æç¬”äº†ï¼Œå°±æ‰“ç®—ä¸æ”¹äº†ï¼Œç»§ç»­å†™ä¸‹å»ï¼Œç›¸ä¿¡ä¹Ÿä¸€å®šæœ‰å¾ˆå¤šäººå¯¹é—­åŒ…è¿™æ ·çš„æ¦‚å¿µæœ‰äº›æ¨¡ç³Šï¼Œé‚£å°±ç§ä¸€ç§ã€çœ‹ä¸€çœ‹</p><p>æ¯•ç«Ÿé—­åŒ…å’Œé«˜é˜¶å‡½æ•°è¿™ä¸¤ç§æ¦‚å¿µï¼Œåœ¨å¼€å‘ä¸­æ˜¯éå¸¸æœ‰åˆ†é‡çš„ã€‚å¥½å¤„å¤šå¤šï¼Œå¦™å¤„å¤šå¤šï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸å†å…œåœˆå­äº†ï¼Œç›´æ¥å¼€å§‹ä»Šå¤©çš„ä¸»é¢˜ï¼Œé—­åŒ…&amp;é«˜é˜¶å‡½æ•°</p><h2 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h2><p>é¦–å…ˆå˜é‡ä½œç”¨åŸŸåˆ†ä¸ºä¸¤ç±»ï¼š<code>å…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸ</code>ï¼Œè¿™ä¸ªæ²¡è¯è¯´å¤§å®¶éƒ½æ‡‚ã€‚æˆ‘ä»¬å¸¸è¯´çš„å˜é‡ä½œç”¨åŸŸå…¶å®ä¹Ÿä¸»è¦æ˜¯åœ¨å‡½æ•°ä¸­å£°æ˜çš„ä½œç”¨åŸŸ</p><ul><li>åœ¨å‡½æ•°ä¸­å£°æ˜å˜é‡æ—¶æ²¡æœ‰varå…³é”®å­—ï¼Œå°±ä»£è¡¨æ˜¯ <strong>å…¨å±€å˜é‡</strong></li><li>åœ¨å‡½æ•°ä¸­å£°æ˜å˜é‡å¸¦æœ‰varå…³é”®å­—çš„å³æ˜¯ <strong>å±€éƒ¨å˜é‡</strong>ï¼Œå±€éƒ¨å˜é‡åªèƒ½&lt;åœ¨å‡½æ•°å†…æ‰èƒ½è®¿é—®åˆ°&gt;</li></ul><pre><code class="js">function fn() {    var a = 110;     // aä¸ºå±€éƒ¨å˜é‡    console.log(a);  // 110}fn();console.log(a);     // a is not defined  å¤–éƒ¨è®¿é—®ä¸åˆ°å†…éƒ¨çš„å˜é‡</code></pre><p>ä¸Šé¢ä»£ç å±•ç¤ºäº†åœ¨å‡½æ•°ä¸­å£°æ˜çš„å±€éƒ¨å˜é‡aåœ¨å‡½æ•°å¤–éƒ¨ç¡®å®æ— æ³•æ‹¿åˆ°ã€‚å°æ ·å„¿çš„è¿˜æŒºåš£å¼ ï¼Œå¯¹äºè¿éš¾è€Œä¸Šçš„coderæ¥è¯´ï¼Œè¿˜ä¸ä¿¡æ‹¿ä¸ä¸‹aäº†</p><p>å‡½æ•°å¯ä»¥åˆ›é€ å‡½æ•°ä½œç”¨åŸŸï¼Œåœ¨å‡½æ•°ä½œç”¨åŸŸä¸­å¦‚æœè¦æŸ¥æ‰¾ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œå¦‚æœåœ¨è¯¥å‡½æ•°å†…æ²¡æœ‰å£°æ˜è¿™ä¸ªå˜é‡ï¼Œå°±ä¼šå‘è¯¥å‡½æ•°çš„å¤–å±‚ç»§ç»­æŸ¥æ‰¾ï¼Œä¸€ç›´æŸ¥åˆ°å…¨å±€å˜é‡ä¸ºæ­¢</p><p>æ‰€ä»¥å˜é‡çš„æŸ¥æ‰¾æ˜¯<code>ç”±å†…è€Œå¤–</code>çš„ï¼Œè¿™ä¹Ÿå½¢æˆäº†æ‰€è°“çš„<code>ä½œç”¨åŸŸé“¾</code><br><a id="more"></a></p><pre><code class="js">var a = 7;function outer() {    var b = 9;    function inner() {        var c = 8;        alert(b);        alert(a);    }    inner();    alert(c);   // c is not defined}outer();    // è°ƒç”¨å‡½æ•°</code></pre><p>åˆ©ç”¨ä½œç”¨åŸŸé“¾ï¼Œæˆ‘ä»¬è¯•ç€å»æ‹¿åˆ°aï¼Œæ”¹é€ ä¸€ä¸‹ <strong>fnå‡½æ•°</strong></p><pre><code class="js">function fn() {    var a = 110;     // aä¸ºå±€éƒ¨å˜é‡    return function() {        console.log(a);    }    console.log(a);  // 110}var fn2 = fn();fn2();      // 110</code></pre><p>å¦‚æ­¤è¿™èˆ¬ï¼Œè¿™èˆ¬å¦‚æ­¤ï¼Œè½»è€Œæ˜“ä¸¾ï¼Œå°caseçš„äº‹ï¼Œå°±å¯ä»¥ä»å¤–é¢è®¿é—®åˆ°å±€éƒ¨å˜é‡aäº†</p><p>é‚£ä¹ˆåˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å‘ç°äº†é—­åŒ…çš„å…¶ä¸­ä¸€ä¸ªæ„ä¹‰ï¼š<strong>é—­åŒ…å°±æ˜¯èƒ½å¤Ÿè¯»å–å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„å‡½æ•°</strong>ï¼Œå—¯ï¼Œæ²¡æ¯›ç—…ï¼Œç»§ç»­å¾€ä¸‹çœ‹</p><h2 id="å˜é‡å£°æ˜å‘¨æœŸ"><a href="#å˜é‡å£°æ˜å‘¨æœŸ" class="headerlink" title="å˜é‡å£°æ˜å‘¨æœŸ"></a>å˜é‡å£°æ˜å‘¨æœŸ</h2><blockquote><p>åœ¨è§£å†³äº†ä¸Šé¢å¦‚ä½•æ‹¿åˆ°å°æ ·å„¿açš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¸å¦¨å†æŠŠå˜é‡ç”Ÿå‘½å‘¨æœŸè¿™ä¸ªæ¦‚å¿µå…ˆç®€å•åœ°è¿‡ä¸€éã€‚</p></blockquote><ul><li>å¯¹äºå…¨å±€å˜é‡æ¥è¯´ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸè‡ªç„¶æ˜¯æ°¸ä¹…çš„(forever)ï¼Œé™¤éæˆ‘ä»¬ä¸é«˜å…´ï¼Œä¸»åŠ¨å¹²æ‰å®ƒï¼ŒæŠ¥é”€å®ƒã€‚</li><li>è€Œå¯¹äºåœ¨å‡½æ•°ä¸­é€šè¿‡varå£°æ˜çš„å±€éƒ¨å˜é‡æ¥è¯´ï¼Œå°±æ²¡é‚£ä¹ˆå¹¸è¿äº†ï¼Œå½“å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œå±€éƒ¨å˜é‡ä»¬å°±å¤±å»äº†ä»·å€¼ï¼Œå°±è¢«åƒåœ¾å›æ”¶æœºåˆ¶ç»™å½“æˆåƒåœ¾å¤„ç†æ‰äº†</li></ul><p>æ¯”å¦‚åƒä¸‹é¢è¿™æ ·çš„ä»£ç å°±å¾ˆå¯æ€œ</p><pre><code class="js">function fn() {    var a = 123;    // fnæ‰§è¡Œå®Œæ¯•åï¼Œå˜é‡aå°±å°†è¢«é”€æ¯äº†    console.log(a);}fn();</code></pre><p>è™½ç„¶ä»¥ä¸Šåƒåœ¾å›æ”¶çš„è¿‡ç¨‹æˆ‘ä»¬æ— æ³•äº²çœ¼çœ‹è§ï¼Œä½†æ˜¯å¬è€…ä¼¤å¿ƒé—»è€…æµæ³ªå•Šã€‚å¯ä¸å¯ä»¥ä¸è¦å¦‚æ­¤æ®‹å¿ï¼Œæˆ‘æ„¿å€¾å…¶æ‰€æœ‰ï¼Œæ¢ä½ ä¸‰ç”Ÿä¸‰ä¸–ã€‚</p><p>æ‚²ä¼¤çš„åˆ°æ¥ï¼Œæˆ‘ä»¬æ— æ³•æ‹’ç»ï¼Œé‚£å°±è®©æˆ‘ä»¬æƒ³åŠæ³•å»æ”¹å˜è¿™ä¸€åˆ‡ã€‚ç°åœ¨å†è®©æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™æ®µä»£ç ï¼š</p><pre><code class="js">function add() {    var a = 1;    return function() {        a++;        console.log(a);    }}var fn = add();fn();   // 2fn();   // 3fn();   // 4</code></pre><p>è¿™æ®µä»£ç æœ€ç¥å¥‡çš„åœ°æ–¹å°±æ˜¯ï¼Œå½“addå‡½æ•°æ‰§è¡Œå®Œåï¼Œå±€éƒ¨å˜é‡aå¹¶æ²¡æœ‰è¢«é”€æ¯ï¼Œè€Œæ˜¯ä¾ç„¶å­˜åœ¨ï¼Œè¿™å…¶ä¸­åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬æ…¢æ…¢åˆ†æä¸€ä¸‹ï¼š</p><ul><li>å½“fn = add()æ—¶ï¼Œfnè¿”å›äº†ä¸€ä¸ªå‡½æ•°çš„å¼•ç”¨ï¼Œè¿™ä¸ªå‡½æ•°é‡Œæœ‰å±€éƒ¨å˜é‡a</li><li>æ—¢ç„¶è¿™ä¸ªå±€éƒ¨å˜é‡è¿˜èƒ½è¢«å¤–éƒ¨è®¿é—®fn()ï¼Œå°±æ²¡æœ‰å¿…è¦æŠŠå®ƒç»™é”€æ¯äº†ï¼Œäºæ˜¯å°±ä¿ç•™äº†ä¸‹æ¥</li></ul><p>é—­åŒ…æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œå¯ä»¥å®Œæˆå¾ˆå¤šå·¥ä½œï¼Œå…¶ä¸­å°±åŒ…æ‹¬ä¸€é“ç½‘ä¸Šå¸¸è€ƒçš„ç»å…¸é¢˜ç›®</p><pre><code class="js">    &lt;ul&gt;        &lt;li&gt;1&lt;/li&gt;        &lt;li&gt;2&lt;/li&gt;        &lt;li&gt;3&lt;/li&gt;        &lt;li&gt;4&lt;/li&gt;    &lt;/ul&gt;    &lt;script&gt;        var aLi = document.getElementsByTagName(&#39;li&#39;);        for (var i = 0; i &lt; aLi.length; i++) {            aLi[i].onclick = function() {                console.log(i);     // ?            };        }    &lt;/script&gt;</code></pre><p>è¿‡è¿™é“é¢˜çš„è§‚ä¼—è¯·ä¸¾æ‰‹ï¼Œç¡®å®è¿™é“é¢˜çš„ç›®çš„å°±æ˜¯ä¸ºäº†è€ƒå¯¹é—­åŒ…çš„ç†è§£ã€‚ä¸Šé¢çš„ç­”æ¡ˆæ— è®ºæ€ä¹ˆç‚¹ç»“æœéƒ½æ˜¯4ã€‚</p><p>è¿™æ˜¯å› ä¸ºlièŠ‚ç‚¹çš„onclickäº‹ä»¶å±äºå¼‚æ­¥çš„ï¼Œåœ¨clickè¢«è§¦å‘çš„æ—¶å€™ï¼Œforå¾ªç¯ä»¥è¿…é›·ä¸åŠæ©è€³ç›—é“ƒçš„é€Ÿåº¦å°±æ‰§è¡Œå®Œæ¯•äº†ï¼Œæ­¤æ—¶å˜é‡içš„å€¼å·²ç»æ˜¯4äº†</p><p>å› æ­¤åœ¨liçš„clickäº‹ä»¶å‡½æ•°é¡ºç€ä½œç”¨åŸŸé“¾ä»å†…å‘å¤–å¼€å§‹æ‰¾içš„æ—¶å€™ï¼Œå‘ç°içš„å€¼å·²ç»å…¨æ˜¯4äº†</p><p><strong>è§£å†³æ–¹æ³•</strong><br>å°±éœ€è¦é€šè¿‡é—­åŒ…ï¼ŒæŠŠæ¯æ¬¡å¾ªç¯çš„iå€¼éƒ½å­˜ä¸‹æ¥ã€‚ç„¶åå½“clickäº‹ä»¶ç»§ç»­é¡ºç€ä½œç”¨åŸŸé“¾æŸ¥æ‰¾çš„æ—¶å€™ï¼Œä¼šå…ˆæ‰¾åˆ°è¢«å­˜ä¸‹æ¥çš„iï¼Œè¿™æ ·æ¯ä¸€ä¸ªliç‚¹å‡»éƒ½å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„iå€¼äº†</p><pre><code class="js"> &lt;script&gt;        var aLi = document.getElementsByTagName(&#39;li&#39;);        for (var i = 0; i &lt; aLi.length; i++) {            (function(n) {    // nä¸ºå¯¹åº”çš„ç´¢å¼•å€¼                aLi[i].onclick = function() {                      console.log(n);     // 0, 1, 2, 3                };            })(i);  // è¿™é‡Œiæ¯å¾ªç¯ä¸€æ¬¡éƒ½å­˜ä¸€ä¸‹ï¼Œç„¶åæŠŠ0,1,2,3ä¼ ç»™ä¸Šé¢çš„å½¢å‚n        }&lt;/script&gt;</code></pre><h2 id="å…¶ä»–ä½œç”¨"><a href="#å…¶ä»–ä½œç”¨" class="headerlink" title="å…¶ä»–ä½œç”¨"></a>å…¶ä»–ä½œç”¨</h2><p>é—­åŒ…åº”ç”¨éå¸¸å¹¿æ³›ï¼Œæˆ‘ä»¬è¿™é‡Œå°±è¯´ä¸€ä¸‹å¤§å®¶ç†ŸçŸ¥çš„ï¼Œæ¯”å¦‚å¯ä»¥ <strong>å°è£…ç§æœ‰å˜é‡</strong>ï¼Œå¯ä»¥æŠŠä¸€äº›ä¸éœ€è¦æš´éœ²åœ¨å…¨å±€çš„å˜é‡å°è£…æˆç§æœ‰å˜é‡ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢é€ æˆå˜é‡çš„å…¨å±€æ±¡æŸ“</p><pre><code class="js">var sum = (function() {    var cache = {};     // å°†cacheæ”¾å…¥å‡½æ•°å†…éƒ¨ï¼Œé¿å…è¢«å…¶ä»–åœ°æ–¹ä¿®æ”¹    return function() {        var args = Array.prototype.join.call(arguments, &#39;,&#39;);        if (args in cache) {            return cache[args];        }        var a = 0;        for (var i = 0; i &lt; arguments.length; i++) {            a += arguments[i];        }        return cache[args] = a;    }})();</code></pre><p>é™¤æ­¤ä¹‹å¤–ç›¸ä¿¡å¾ˆå¤šäººéƒ½è§è¿‡ä¸€äº›åº“å¦‚<code>jQuery</code>,<code>underscore</code>ä»–ä»¬çš„æœ€å¤–å±‚éƒ½æ˜¯ç±»ä¼¼å¦‚ä¸‹æ ·å­çš„ä»£ç </p><pre><code class="js">(function(win, undefined) {    var a = 1;    var obj = {};    obj.fn = function() {};    // æœ€åæŠŠæƒ³è¦æš´éœ²å‡ºå»çš„å†…å®¹å¯ä»¥æŒ‚è½½åˆ°windowä¸Š    win.obj = obj;})(window);</code></pre><p>æ˜¯çš„ï¼Œæ²¡é”™ï¼Œåˆ©ç”¨é—­åŒ…ä¹Ÿå¯ä»¥åšåˆ°<code>æ¨¡å—åŒ–</code>ã€‚å¦å¤–è¿˜å¯ä»¥å°†<code>å˜é‡çš„ä½¿ç”¨å»¶é•¿</code>ï¼Œå†æ¥çœ‹ä¸€ä¸ªä¾‹å­</p><pre><code class="js">var monitor = (function() {    var imgs = [];    return function(src){        var img = new Image();        imgs.push(img);        img.src = src;    }})();monitor(&#39;http://dd.com/srp.gif&#39;);</code></pre><p>ä¸Šé¢çš„ä»£ç æ˜¯ç”¨äºæ‰“ç‚¹è¿›è¡Œç»Ÿè®¡æ•°æ®çš„æƒ…å½¢ï¼Œåœ¨ä¹‹å‰çš„ä¸€äº›æµè§ˆå™¨ä¸­ï¼Œä¼šå‡ºç°æ‰“ç‚¹ä¸¢å¤±çš„æƒ…å†µï¼Œå› ä¸ºimgæ˜¯å‡½æ•°å†…çš„å±€éƒ¨å˜é‡ï¼Œå½“å‡½æ•°æ‰§è¡Œå®Œåimgå°±è¢«é”€æ¯äº†ï¼Œè€Œæ­¤æ—¶å¯èƒ½httpè¯·æ±‚è¿˜æ²¡æœ‰å‘å‡ºã€‚</p><p>æ‰€ä»¥é‡åˆ°è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼ŒæŠŠimgå˜é‡ç”¨é—­åŒ…å°è£…èµ·æ¥ï¼Œå°±å¯ä»¥è§£å†³äº†</p><h2 id="å†…å­˜ç®¡ç†"><a href="#å†…å­˜ç®¡ç†" class="headerlink" title="å†…å­˜ç®¡ç†"></a>å†…å­˜ç®¡ç†</h2><p>å¾ˆå¤šäººéƒ½å¬è¿‡ä¸€ä¸ªç‰ˆæœ¬ï¼Œå°±æ˜¯é—­åŒ…ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Œæ‰€ä»¥è¦å°½é‡å‡å°‘é—­åŒ…çš„ä½¿ç”¨</p><blockquote><p>Just nowå°±æ¥ä¸ºé—­åŒ…æ¥æ­£åï¼Œä¸æ˜¯ä½ æƒ³è±¡é‚£æ ·çš„ï¼š</p></blockquote><ul><li><p>å±€éƒ¨å˜é‡æœ¬æ¥åº”è¯¥éšç€å‡½æ•°çš„æ‰§è¡Œå®Œæ¯•è¢«é”€æ¯ï¼Œä½†å¦‚æœå±€éƒ¨å˜é‡è¢«å°è£…åœ¨é—­åŒ…å½¢æˆçš„ç¯å¢ƒä¸­ï¼Œé‚£è¿™ä¸ªå±€éƒ¨å˜é‡å°±ä¸€ç›´èƒ½å­˜åœ¨ã€‚ä»æˆ‘ä»¬ä¸Šé¢å®è·µå¾—å‡ºçš„ç»“æœæ¥çœ‹ï¼Œè¿™è¯è¯´çš„æ²¡æ¯›ç—…</p></li><li><p>Butä¹‹æ‰€ä»¥ä½¿ç”¨é—­åŒ…æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦æŠŠä¸€äº›å˜é‡å­˜èµ·æ¥æ–¹ä¾¿ä»¥åä½¿ç”¨ï¼Œè¿™å’Œæ”¾åˆ°å…¨å±€ä¸‹ï¼Œå¯¹å†…å­˜çš„å½±å“æ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸ç®—æ˜¯å†…å­˜æ³„æ¼ã€‚å¦‚æœåœ¨å°†æ¥æƒ³å›æ”¶è¿™äº›å˜é‡ï¼Œç›´æ¥æŠŠå˜é‡è®¾ä¸ºnullå³å¯äº†</p></li><li><p>è¿˜æœ‰å°±æ˜¯åœ¨ä½¿ç”¨é—­åŒ…çš„åŒæ—¶æ¯”è¾ƒå®¹æ˜“å½¢æˆå¾ªç¯å¼•ç”¨ï¼Œå¦‚æœé—­åŒ…çš„ä½œç”¨åŸŸé“¾ä¸­ä¿å­˜ç€ä¸€äº›DOMèŠ‚ç‚¹ï¼Œæ­¤æ—¶å°±æœ‰å¯èƒ½é€ æˆå†…å­˜æ³„æ¼ã€‚ä½†è¿™æœ¬èº«å¹¶éé—­åŒ…çš„é—®é¢˜ï¼Œä¹Ÿå¹¶éjsçš„é—®é¢˜</p></li><li><p>è¦æ€ªå°±æ€ªè€ç‰ˆæœ¬çš„IEåŒå¿—å§ï¼Œå®ƒå†…éƒ¨å®ç°çš„åƒåœ¾å›æ”¶æœºåˆ¶é‡‡ç”¨çš„æ˜¯å¼•ç”¨è®¡æ•°ç­–ç•¥ã€‚åœ¨è€åŒå¿—IEä¸­ï¼Œå¦‚æœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å½¢æˆäº†å¾ªç¯å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡éƒ½ä¸èƒ½è¢«å›æ”¶ï¼Œä½†å¾ªç¯å¼•ç”¨é€ æˆçš„å†…å­˜æ³„æ¼å…¶æœ¬è´¨ä¹Ÿä¸æ˜¯é—­åŒ…çš„é”™</p></li><li><p>åŒæ ·è¦è§£å†³å¾ªç¯å¼•ç”¨ä»£ç†çš„å†…å­˜æ³„æ¼é—®é¢˜ï¼Œåªéœ€æŠŠå¾ªç¯å¼•ç”¨ä¸­çš„å˜é‡è®¾ä¸ºnullå°±å¥½</p></li></ul><p>ä¸Šé¢å°±æ˜¯æˆ‘ä»¬æ›¿é—­åŒ…çš„æ­£åï¼Œé—­åŒ…ä¹Ÿä¸å®¹æ˜“ï¼Œè¢«äººç”¨è¿˜ä¸è®¨å¥½ã€‚å®ƒæ˜ç™½ï¼Œä¸æ˜¯å®ƒçš„é”…ï¼Œå®ƒæ˜¯ä¸éœ€è¦èƒŒçš„ï¼</p><h2 id="è¿™ä¸æ˜¯ç»ˆç‚¹"><a href="#è¿™ä¸æ˜¯ç»ˆç‚¹" class="headerlink" title="è¿™ä¸æ˜¯ç»ˆç‚¹"></a>è¿™ä¸æ˜¯ç»ˆç‚¹</h2><p>è™½ç„¶ä¸æ˜¯ç»ˆç‚¹ï¼Œä½†è¿˜æ˜¯è¦æä¸ªæ€»ç»“æ€§å‘ç‚çš„ï¼Œä¸ç„¶æ€ä¹ˆå¯¹å¾—èµ·æ‰æ¡ƒä½“å…„</p><blockquote><p>é—­åŒ…ï¼š</p></blockquote><ul><li>æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè¯»å–å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„å‡½æ•°ï¼Œå®è´¨ä¸Šæ˜¯å˜é‡çš„è§£æè¿‡ç¨‹(ç”±å†…è€Œå¤–)</li><li>å¯ä»¥ç”¨æ¥å°è£…ç§æœ‰å˜é‡ï¼Œå®ç°æ¨¡å—åŒ–</li><li>å¯ä»¥ä¿å­˜å˜é‡åˆ°å†…å­˜ä¸­</li></ul><p><a href="https://juejin.im/post/5acfeb7ff265da239867a97f" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é—­åŒ… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½ éœ€è¦äº†è§£çš„23ç§javascriptè®¾è®¡æ¨¡å¼</title>
      <link href="/2018/07/02/Js/%E4%BD%A0%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%8423%E7%A7%8Djavascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>/2018/07/02/Js/%E4%BD%A0%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%8423%E7%A7%8Djavascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆè¦å­¦ä¹ è®¾è®¡æ¨¡å¼ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦å­¦ä¹ è®¾è®¡æ¨¡å¼ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å­¦ä¹ è®¾è®¡æ¨¡å¼ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦å­¦ä¹ è®¾è®¡æ¨¡å¼ï¼Ÿ</h1><p>åœ¨è®¸å¤šè®¿è°ˆä¸­ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°å¾ˆå¤šé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„æ¥å£ï¼ŒæŠ½è±¡ç±»ï¼Œä»£ç†å’Œä»¥åŠå…¶ä»–ä¸è®¾è®¡æ¨¡å¼ç›¸å…³çš„é—®é¢˜ã€‚ ä¸€æ—¦äº†è§£äº†è®¾è®¡æ¨¡å¼ï¼Œå®ƒä¼šè®©ä½ è½»æ¾åº”å¯¹ä»»ä½•è®¿è°ˆï¼Œå¹¶å¯ä»¥åœ¨ä½ çš„é¡¹ç›®ä¸­åº”ç”¨è¿™äº›ç‰¹æ€§ã€‚åœ¨åº”ç”¨ç¨‹åºä¸­å®ç°è®¾è®¡æ¨¡å¼å·²ç»å¾—åˆ°éªŒè¯å’Œæµ‹è¯•ã€‚</p><p>ä¸ºäº†ä½¿åº”ç”¨ç¨‹åºå…·æœ‰å¯æ‰©å±•æ€§ï¼Œå¯é æ€§å’Œæ˜“ç»´æŠ¤æ€§ï¼Œåº”è¯¥ç¼–å†™ç¬¦åˆè®¾è®¡æ¨¡å¼çš„ä»£ç ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼</h2><ul><li>è®¾è®¡æ¨¡å¼æ˜¯æˆ‘ä»¬æ¯å¤©ç¼–ç¨‹é‡åˆ°çš„å¯é‡ç”¨è§£å†³æ–¹æ¡ˆã€‚</li><li>è®¾è®¡æ¨¡å¼ä¸»è¦æ˜¯ä¸ºäº†è§£å†³å¯¹è±¡çš„ç”Ÿæˆå’Œæ•´åˆé—®é¢˜ã€‚</li><li>æ¢å¥è¯è¯´ï¼Œè®¾è®¡æ¨¡å¼å¯ä»¥ä½œä¸ºå¯åº”ç”¨äºç°å®ä¸–ç•Œç¼–ç¨‹é—®é¢˜çš„æ¨¡æ¿ã€‚</li></ul><h2 id="è®¾è®¡æ¨¡å¼çš„å‘å±•å†å²"><a href="#è®¾è®¡æ¨¡å¼çš„å‘å±•å†å²" class="headerlink" title="è®¾è®¡æ¨¡å¼çš„å‘å±•å†å²"></a>è®¾è®¡æ¨¡å¼çš„å‘å±•å†å²</h2><p>è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µæ˜¯ç”±å››äººå¸®ï¼ˆã€Šè®¾è®¡æ¨¡å¼ï¼ˆå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ï¼‰ã€‹çš„å››ä½ä½œè€…ï¼‰æå‡ºã€‚</p><blockquote><p>å››äººå¸®æŠŠè¿™æœ¬ä¹¦åˆ†æˆä¸¤éƒ¨åˆ†ï¼š</p></blockquote><ul><li>ç¬¬ä¸€éƒ¨åˆ†è§£é‡Šé¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹ã€‚</li><li>ç¬¬äºŒéƒ¨åˆ†æ˜¯å…³äº 23 ä¸ªç»å…¸è®¾è®¡æ¨¡å¼çš„æ¼”å˜ã€‚</li></ul><p>è‡ªæå‡ºè®¾è®¡æ¨¡å¼æ¦‚å¿µåï¼Œå››äººå¸®è®¾è®¡æ¨¡å¼åœ¨è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚</p><h2 id="è®¾è®¡æ¨¡å¼åˆ†ç±»"><a href="#è®¾è®¡æ¨¡å¼åˆ†ç±»" class="headerlink" title="è®¾è®¡æ¨¡å¼åˆ†ç±»"></a>è®¾è®¡æ¨¡å¼åˆ†ç±»</h2><p>æ ¹æ®å®é™…åº”ç”¨ä¸­é‡åˆ°çš„ä¸åŒé—®é¢˜ï¼Œå››äººå¸®å°†è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰ç§ç±»å‹ã€‚</p><ul><li>åˆ›å»ºå‹æ¨¡å¼</li><li>ç»“æ„å‹æ¨¡å¼</li><li>è¡Œä¸ºå‹æ¨¡å¼</li></ul><p>æ¥ä¸‹æ¥å°†æ¦‚è¿°å±äºè¿™ä¸‰ç§ç±»å‹çš„ 23 ç§è®¾è®¡æ¨¡å¼çš„ä¸»è¦æ¦‚å¿µã€‚</p><h2 id="åˆ›å»ºå‹æ¨¡å¼"><a href="#åˆ›å»ºå‹æ¨¡å¼" class="headerlink" title="åˆ›å»ºå‹æ¨¡å¼"></a>åˆ›å»ºå‹æ¨¡å¼</h2><p>è¿™ç±»æ¨¡å¼ç”¨äº<strong>å¯¹è±¡çš„ç”Ÿæˆå’Œç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†</strong>ã€‚</p><blockquote><p>åˆ›å»ºæ¨¡å¼å¯ä»¥å†³å®šç”Ÿæˆå“ªäº›å¯¹è±¡ï¼Œæé«˜äº†ç¨‹åºçš„çµæ´»æ€§ï¼Œæ¨¡å¼å¦‚ä¸‹ï¼š</p></blockquote><ul><li>æŠ½è±¡å·¥å‚æ¨¡å¼</li><li>ç”Ÿæˆå™¨æ¨¡å¼</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼</li><li>å•ä¾‹æ¨¡å¼</li><li>åŸå‹æ¨¡å¼</li></ul><h3 id="JavaScript-æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#JavaScript-æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="JavaScript æŠ½è±¡å·¥å‚æ¨¡å¼"></a>JavaScript æŠ½è±¡å·¥å‚æ¨¡å¼</h3><blockquote><p>æŠ½è±¡å·¥å‚æ¨¡å¼ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><a id="more"></a><p>å®ƒå°±åƒä¸€ä¸ªå·¥å‚ï¼Œä½†ä¸€åˆ‡è¢«å°é”èµ·æ¥ï¼š</p><ul><li>æä¾›å¯¹è±¡çš„æ–¹æ³•</li><li>æ„å»ºå¯¹è±¡çš„å·¥å‚</li><li>æœ€ç»ˆçš„å¯¹è±¡</li><li>æœ€ç»ˆå¯¹è±¡åŒ…å«ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„å¯¹è±¡</li></ul><p>ç­–ç•¥æ¨¡å¼åªæ˜¯ä½¿ç”¨ç»„åˆçš„æ–¹å¼ï¼Œæ¢å¥è¯è¯´ï¼Œå®ƒçš„ç±»å­—æ®µå®é™…ä¸Šæ˜¯å¯¹è±¡æœ¬èº«ã€‚</p><blockquote><p>æŠ½è±¡å·¥å‚æ¨¡å¼çš„ç”¨å¤„ï¼Ÿ</p></blockquote><p>æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥åˆ›å»ºç±»ç°‡ç±»çš„å¯¹è±¡ï¼Œè€Œä¸éœ€è¦æŒ‡å®šå…·ä½“çš„ç±»ï¼Œè¿™ä½¿å¾—æŠ½è±¡å·¥å‚å¾ˆçµæ´»ã€‚</p><p>é€šè¿‡æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥å¯¹ä»»ä½•ç±»ç°‡å¯¹è±¡è¿›è¡Œå»ºæ¨¡å¹¶é€šè¿‡ç»Ÿä¸€çš„æ¥å£ä¾›å¤–éƒ¨å¯¹è±¡ä½¿ç”¨ã€‚</p><p>æŠ½è±¡å·¥å‚å”¯ä¸€ä¸å¥½çš„åœ°æ–¹æ˜¯<strong>å®ƒå¯èƒ½å˜å¾—éå¸¸å¤æ‚</strong></p><h3 id="JavaScript-çš„ç”Ÿæˆå™¨æ¨¡å¼ï¼ˆBuilder-æ¨¡å¼ï¼‰"><a href="#JavaScript-çš„ç”Ÿæˆå™¨æ¨¡å¼ï¼ˆBuilder-æ¨¡å¼ï¼‰" class="headerlink" title="JavaScript çš„ç”Ÿæˆå™¨æ¨¡å¼ï¼ˆBuilder æ¨¡å¼ï¼‰"></a>JavaScript çš„ç”Ÿæˆå™¨æ¨¡å¼ï¼ˆBuilder æ¨¡å¼ï¼‰</h3><blockquote><p>Builder æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>Builder æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºåˆ›å»ºç”±å…¶ä»–å¯¹è±¡ç»„åˆæ„æˆçš„å¯¹è±¡çš„æ¨¡å¼ã€‚åˆ›å»ºéƒ¨ä»¶çš„æ–¹æ³•åº”è¯¥ç‹¬ç«‹äºä¸»å¯¹è±¡ã€‚å¦å¤–ï¼Œä¸ºäº†ä»ä¸šåŠ¡æ–¹éšè—éƒ¨ä»¶çš„åˆ›å»ºç»†èŠ‚ï¼Œä¸¤è€…æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚</p><p>åœ¨ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼æ—¶ï¼Œç”Ÿæˆå™¨çŸ¥é“æ‰€æœ‰çš„ç»†èŠ‚ï¼Œä¸”åˆ›å»ºç»†èŠ‚å®Œå…¨å¯¹å…¶ä»–ç›¸å…³ç±»å±è”½ã€‚</p><h3 id="JavaScript-å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#JavaScript-å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="JavaScript å·¥å‚æ–¹æ³•æ¨¡å¼"></a>JavaScript å·¥å‚æ–¹æ³•æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Ÿ</p></blockquote><p>æ ¹æ®å®šä¹‰ï¼Œåªè¦æƒ³ä¸€ä¸ªæ–¹æ³•è¿”å›å…¬å…±è¶…ç±»çš„å‡ ä¸ªå¯èƒ½çš„ç±»ä¸­çš„ä¸€ä¸ªï¼Œå°±å¯ä»¥ä½¿ç”¨å·¥å‚æ¨¡å¼ã€‚</p><p>å‡è®¾æˆ‘æƒ³éšæœºå‘å±å¹•ä¸Šå°„å‡»æ•Œäººã€‚é‚£ä¹ˆå¦‚æœæ‰€æœ‰ä¸œè¥¿éƒ½ç¡¬ç¼–ç å¥½äº†ï¼Œå¹¶ä¸”ä¸çŸ¥é“æ•Œäººçš„å…·ä½“ç±»å‹ä¼šè®©å¤„ç†å˜å¾—å¾ˆå›°éš¾ã€‚</p><p>ä½†æ˜¯ï¼Œå‡è®¾æˆ‘åˆ›å»ºäº†ä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œæ¯ä¸ªå¯èƒ½çš„æ•Œäººç±»éƒ½ç”±ä¸€ä¸ªæ•°å­—ä»£æ›¿ï¼Œå¹¶å¯ä»¥ç”±è¯¥éšæœºæ•°ç”Ÿæˆå™¨è¿”å›ã€‚</p><p>ç„¶åå¯ä»¥å°†è¿™ä¸ªæ•°å­—å‘é€ç»™å·¥å‚å¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥è¿”å›ä¸€ä¸ªåŠ¨æ€åˆ›å»ºçš„æ•Œäººã€‚</p><p>æ‰€ä»¥ï¼ŒMOL çš„ä¸»è¦æ¦‚å¿µéå¸¸é‡è¦ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶é€‰æ‹©ç±»ï¼Œè¿™å°±æ˜¯å·¥å‚æ¨¡å¼èƒ½å¤Ÿæä¾›çš„ã€‚</p><blockquote><p>ä½•æ—¶ä½¿ç”¨å·¥å‚æ¨¡å¼</p></blockquote><p>å½“ä¸çŸ¥é“éœ€è¦ä½•ç§ç±»å‹çš„å¯¹è±¡æ—¶å¯ä»¥ä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚</p><p>ä½†æ˜¯ï¼Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œç¡®ä¿æ‰€æœ‰æ½œåœ¨çš„ç±»éƒ½å…·æœ‰ç›¸åŒçš„å­ç±»å±‚æ¬¡ç»“æ„ï¼Œè¿™æ„å‘³ç€åœ¨ç»§æ‰¿è·¯å¾„ä¸Šæœ‰ç›¸åŒçš„çˆ¶ç±»ã€‚</p><p>å¯ä»¥ä½¿ç”¨å·¥å‚æ¨¡å¼æ¥é›†ä¸­ç±»åˆ«é€‰æ‹©çš„ä»£ç ã€‚æˆ–æ˜¯ä¸å¸Œæœ›ç”¨æˆ·çŸ¥é“æ¯ä¸€ä¸ªå¯èƒ½çš„å­ç±»æ—¶ã€‚</p><h3 id="JavaScript-å•ä¾‹æ¨¡å¼"><a href="#JavaScript-å•ä¾‹æ¨¡å¼" class="headerlink" title="JavaScript å•ä¾‹æ¨¡å¼"></a>JavaScript å•ä¾‹æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ</p></blockquote><p>å½“æƒ³è¦é¿å…å®ä¾‹åŒ–å¤šä¸ªå¯¹è±¡æ—¶ä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚å•ä¾‹ä½¿å¾—åªèƒ½ä»ç±»å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ã€‚</p><p>ç°åœ¨ä½ å¯èƒ½ä¼šé—®è‡ªå·±ï¼Œæˆ‘ä»€ä¹ˆæ—¶å€™ä¼šæƒ³è¦è¿™æ ·åšï¼Ÿ å…¶å®ï¼Œæœ‰å¾ˆå¤šåœºæ™¯ã€‚</p><p>æˆ‘ä»¬å·²ç»æ¼”ç¤ºè¿‡æ‹¼å­—æ¸¸æˆé‡Œä½¿ç”¨ä¸€ä¸ªç±»å®¹çº³æ‰€æœ‰å¯èƒ½çš„å­—æ¯ï¼Œå¹¶ä¸”æ‹¼å­—æ¸¸æˆæ˜¯ä¸€æ¬¾éå¸¸å¸¸è§çš„æ£‹ç›˜æ¸¸æˆï¼Œè¿™é‡Œä½¿ç”¨å•ä¾‹æ¨¡å¼æ˜¯å¾ˆæ˜æ™ºçš„é€‰æ‹©ã€‚</p><p>è¿™ä¸ªå•ä¾‹ç±»åŒ…å«æ‰€æœ‰å¯èƒ½çš„æ‹¼å­—æ¸¸æˆå­—æ¯ï¼Œä»¥ä¾¿ç©å®¶å¯ä»¥ä½¿ç”¨è¿™ä¸ªå•ä¾‹ç±»å–å¾—æ‰€æœ‰å­—æ¯ï¼Œä¸åŒç©å®¶å¯ä»¥åŒæ—¶è¯·æ±‚è·å–ã€‚</p><p>å•ä¾‹ä½¿å¾—æ¯ä¸ªç©å®¶éƒ½å…±äº«ç›¸åŒçš„å­—æ¯åˆ—è¡¨ï¼Œæ¯ä¸ªç©å®¶å¯ä»¥æ ¹æ®è¿™ä¸ªå­—æ¯åˆ—è¡¨æ¥æ‹¼æ¥è‡ªå·±çš„å•è¯ã€‚</p><h3 id="Javascript-åŸå‹æ¨¡å¼"><a href="#Javascript-åŸå‹æ¨¡å¼" class="headerlink" title="Javascript åŸå‹æ¨¡å¼"></a>Javascript åŸå‹æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯åŸå‹æ¨¡å¼ï¼Ÿ</p></blockquote><p>å½“æƒ³è¦é€šè¿‡å…‹éš†æˆ–æ‹·è´å¯¹è±¡æ¥ç”Ÿæˆå¯¹è±¡æ—¶ï¼Œè¿™å°±æ˜¯åŸå‹æ¨¡å¼ã€‚</p><p>é€šè¿‡åŸå‹æ¨¡å¼å¯ä»¥åœ¨è¿è¡Œæ—¶æ·»åŠ å·²çŸ¥çˆ¶ç±»çš„å­ç±»å®ä¾‹ã€‚</p><p>å½“æœ‰è®¸å¤šç±»åªåœ¨è¿è¡Œæ—¶éœ€è¦ä½¿ç”¨æ—¶å¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼ã€‚åŸå‹æ¨¡å¼çš„å¥½å¤„ä¹‹ä¸€æ˜¯å‡å°‘äº†åˆ›å»ºå¤šä¸ªå­ç±»ã€‚</p><h2 id="ç»“æ„å‹æ¨¡å¼"><a href="#ç»“æ„å‹æ¨¡å¼" class="headerlink" title="ç»“æ„å‹æ¨¡å¼"></a>ç»“æ„å‹æ¨¡å¼</h2><blockquote><p>è¿™ç±»æ¨¡å¼æè¿°äº†å‘ç°æœ‰å¯¹è±¡æ·»åŠ åŠŸèƒ½çš„ä¸åŒæ–¹å¼ç®€å•åœ°è¯´ï¼Œè¿™ä¸ªæ¨¡å¼ç€é‡äºè§£è€¦å¯¹è±¡çš„æ¥å£å®ç°æ¨¡å¼å¦‚ä¸‹ï¼š</p></blockquote><ul><li>é€‚é…å™¨æ¨¡å¼</li><li>æ¡¥æ¥æ¨¡å¼</li><li>ç»„åˆæ¨¡å¼</li><li>è£…é¥°è€…æ¨¡å¼</li><li>å¤–è§‚æ¨¡å¼</li><li>äº«å…ƒæ¨¡å¼</li><li>ä»£ç†æ¨¡å¼</li></ul><h3 id="JavaScript-é€‚é…å™¨è®¾è®¡æ¨¡å¼"><a href="#JavaScript-é€‚é…å™¨è®¾è®¡æ¨¡å¼" class="headerlink" title="JavaScript é€‚é…å™¨è®¾è®¡æ¨¡å¼"></a>JavaScript é€‚é…å™¨è®¾è®¡æ¨¡å¼</h3><blockquote><p>é€‚é…å™¨æ¨¡å¼çš„ä½œç”¨</p></blockquote><p>é€‚é…å™¨è®¾è®¡æ¨¡å¼å…è®¸ä½¿ç”¨ä¸¤ä¸ªå®Œå…¨ä¸å…¼å®¹çš„æ¥å£ä¸€èµ·å·¥ä½œï¼Œæ­£å¦‚å…¶åå­—ä¸€æ ·ï¼Œé€‚é…ä¸åŒæ¥å£ã€‚</p><p>å‡è®¾ä½ å¢™ä¸Šçš„æ’åº§åªæœ‰ä¸¤åº§æ’å¤´ï¼Œä½†æ˜¯ä½ æƒ³è¿æ¥ä¸€ä¸ªä¸‰åº§çš„æ’å¤´ï¼Œè¿™æ—¶å°±éœ€è¦é€‚é…å™¨äº†ã€‚</p><p>å½“å®¢æˆ·æœŸæœ›ä½¿ç”¨ç›®æ ‡æ¥å£æ˜¯ä¸¤åº§æ’å¤´ï¼Œä½†æ˜¯ä½ åªæœ‰ä¸‰åº§æ’å¤´ï¼Œè¿™å°±æ˜¯é€‚é…å™¨å°†è¦æ‰§è¡Œçš„æ“ä½œ æŠŠä¸‰åº§è½¬æ¢æˆä¸¤åº§ã€‚</p><p>é€‚é…å™¨æ¨¡å¼å…è®¸ä½¿ç”¨ä»»ä½•ç°æœ‰æ¥å£é€‚é…ä¸ºç›®æ ‡æ¥å£ã€‚</p><p>ä»å¦ä¸€ä¸ªè§’åº¦çœ‹ä»»ä½•ç±»éƒ½å¯ä»¥ååŒå·¥ä½œåªè¦é€‚é…å™¨è§£å†³äº†æ‰€æœ‰ç±»éƒ½å¿…é¡»å®ç°ç›¸åŒæ¥å£çš„é—®é¢˜ã€‚</p><h3 id="Javascript-æ¡¥æ¥æ¨¡å¼"><a href="#Javascript-æ¡¥æ¥æ¨¡å¼" class="headerlink" title="Javascript æ¡¥æ¥æ¨¡å¼"></a>Javascript æ¡¥æ¥æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯æ¡¥æ¥æ¨¡å¼</p></blockquote><p>å®˜æ–¹å®šä¹‰æ˜¯å°†æŠ½è±¡ä¸å…¶å®ç°åˆ†ç¦»å¼€æ¥ï¼Œå› æ­¤ä¸¤è€…å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚</p><p>è¯¥æ¨¡å¼ç”¨äºå°†æŠ½è±¡ä¸å…¶å®ç°åˆ†å¼€ï¼Œä»¥ä¾¿ä¸¤è€…éƒ½å¯ä»¥ç‹¬ç«‹ä¿®æ”¹ã€‚è¯¥æ¨¡å¼åŒ…å«ä¸€ä¸ªç”¨äºæ¡¥æ¥æŠ½è±¡ç±»å’Œå®ç°ç±»çš„æ¥å£ã€‚é€šè¿‡æ¡¥æ¥æ¨¡å¼ï¼Œä¸¤ç§ç±»å‹éƒ½å¯ä»¥ä¿®æ”¹è€Œä¸ä¼šç›¸äº’å½±å“ã€‚</p><blockquote><p>æ¡¥æ¥æ¨¡å¼å®ç°æŒ‡å—</p></blockquote><p>å½“æƒ³è¦é¿å…æŠ½è±¡ä¸å…¶å®ç°ä¹‹é—´çš„æ°¸ä¹…ç»‘å®šæ—¶å¯ä»¥ä½¿ç”¨æ¡¥æ¥æ¨¡å¼ã€‚</p><p>æŠ½è±¡å’Œå®ƒä»¬çš„å®ç°éƒ½åº”è¯¥å¯ä»¥é€šè¿‡å­ç±»è¿›è¡Œæ‰©å±•ã€‚å½“æŠ½è±¡çš„å®ç°æœ‰å˜åŒ–æ—¶ä¸åº”è¯¥å½±å“åˆ°è°ƒç”¨æ–¹ï¼ŒåŠè°ƒç”¨æ–¹ä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚</p><p>å½“éœ€è¦åœ¨å¤šä¸ªå¯¹è±¡ä¹‹é—´å…±äº«ä¸€ä¸ªå®ç°æ—¶ï¼Œå¯ä»¥é€‰æ‹©è¿™ç§æ¨¡å¼ã€‚</p><p>æœ€åæˆ‘ä»¬å¸Œæœ›å®Œå…¨å¯¹è°ƒç”¨æ–¹éšè—æŠ½è±¡çš„å®ç°ã€‚</p><h3 id="JavaScript-ç»„åˆæ¨¡å¼"><a href="#JavaScript-ç»„åˆæ¨¡å¼" class="headerlink" title="JavaScript ç»„åˆæ¨¡å¼"></a>JavaScript ç»„åˆæ¨¡å¼</h3><p>ç»„åˆæ¨¡å¼ä»å®šä¹‰ä¸Šçœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œä¸€æ—¦ç”¨èµ·æ¥å°±ä¼šæ„Ÿè§‰å¾ˆåˆç†ã€‚</p><p>å®ƒå…è®¸ç»Ÿä¸€å¤„ç†å•ä¸ªå¯¹è±¡å’Œå¯¹è±¡ç»„åˆï¼Œè¿™æ˜¯ç»„åˆè®¾è®¡æ¨¡å¼çš„å…¸å‹å®šä¹‰ã€‚</p><p>ç»„åˆæ¨¡å¼å¯ä»¥è¡¨ç¤ºä¸º<strong>éƒ¨åˆ† - æ•´ä½“çš„å±‚æ¬¡ç»“æ„</strong>ã€‚è¯¥ç»“æ„çš„ç»„ä»¶åˆå¯ä»¥åˆ’åˆ†ä¸ºæ›´å°çš„ç»„ä»¶ã€‚</p><p>ä¸€ä¸ªæ›´åˆä¹é€»è¾‘çš„å®šä¹‰æ˜¯ç»„åˆè®¾è®¡æ¨¡å¼æ˜¯<code>ç”¨æ¥ç»“æ„åŒ–æ•°æ®æˆ–å•ç‹¬è¡¨ç¤ºæ•´ä¸ªå¯¹è±¡çš„æ¯ä¸ªéƒ¨åˆ†çš„äº’ç›¸æ“ä½œ</code>ã€‚</p><h3 id="JavaScript-è£…é¥°æ¨¡å¼"><a href="#JavaScript-è£…é¥°æ¨¡å¼" class="headerlink" title="JavaScript è£…é¥°æ¨¡å¼"></a>JavaScript è£…é¥°æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯è£…é¥°æ¨¡å¼ï¼Ÿ</p></blockquote><p>åŠ¨æ€çš„ä¸ºä¸€ä¸ªå¯¹è±¡é™„åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œè£…é¥°æ¨¡å¼å¯ä»¥ä¸é€šè¿‡ç»§æ‰¿æ¥å®ç°åŠŸèƒ½æ‰©å±•ã€‚</p><p>è¿™ç§æ¨¡å¼å±äºç»“æ„è®¾è®¡æ¨¡å¼ç±»åˆ«ï¼Œä¹Ÿè¢«ç§°ä¸ºåŒ…è£…æ¨¡å¼ï¼Œè£…é¥°è®¾è®¡æ¨¡å¼è§£å†³äº†åœ¨ä¸æ”¹å˜å¯¹è±¡ç°æœ‰ç»“æ„çš„æƒ…å†µä¸‹æ·»åŠ é™„åŠ åŠŸèƒ½çš„é—®é¢˜ã€‚</p><p>å¦å¤–ï¼Œè¯¥æ¨¡å¼åˆ›å»ºäº†ä¸€ä¸ªè£…é¥°å™¨ç±»ï¼Œå®ƒåŒ…è£…åŸå§‹ç±»å¹¶åœ¨è¿è¡Œæ—¶å‘å¯¹è±¡æ·»åŠ æ–°çš„è¡Œä¸ºæˆ–æ“ä½œã€‚</p><blockquote><p>è£…é¥°æ¨¡å¼çš„å®ç°æŒ‡å—</p></blockquote><p>å½“é€‰æ‹©è¿™ç§æ¨¡å¼æ—¶ï¼Œ<strong>éœ€è¦åŠ¨æ€åœ°å‘å•ä¸ªå¯¹è±¡æ·»åŠ æ–°çš„åŠŸèƒ½ï¼Œå¹¶ä¸”è€Œä¸ä¼šå½±å“å…¶ä»–å¯¹è±¡</strong>ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œä¸ºåŸæœ‰ä»£ç æ·»åŠ æ–°çš„åŠŸèƒ½å¯èƒ½ä¼šå¾ˆå›°éš¾ï¼Œç”¨ä¿®é¥°å™¨ä¿®æ”¹ä»£ç ä¼šæ›´å®¹æ˜“äº›ã€‚</p><p>é€šè¿‡ç»§æ‰¿æ¥å®ç°åŠŸèƒ½æ‰©å±•ä¼šäº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œå¹¶ä¸”æœ‰å¯èƒ½è¿™äº›å­ç±»è¿˜ä¸è¶³ä»¥è¦†ç›–æ‰€æœ‰éœ€è¦æ‰©å±•çš„åŠŸèƒ½ã€‚</p><p>å½“æ— æ³•æŸ¥çœ‹ç±»å®šä¹‰æˆ–æ— æ³•ç»§æ‰¿æ—¶ï¼Œéœ€è¦é€‰æ‹©è£…é¥°æ¨¡å¼ã€‚</p><p>ä¾‹å¦‚ï¼Œå°½ç®¡ç±»è¢«å°è£…èµ·æ¥æ— æ³•ä¿®æ”¹ï¼Œé€šè¿‡è£…é¥°æ¨¡å¼ä»ç„¶å¯ä»¥è¿›è¡Œæ‰©å±•ï¼Œå¹¶ä¸”ï¼Œæˆ‘ç›¸ä¿¡ä½ è‚¯å®šä¹Ÿé‡åˆ°è¿‡æ— æ³•é€šè¿‡ç»§æ‰¿æ¥å®ç°åŠŸèƒ½æ‰©å±•çš„æƒ…å†µï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œé€‰æ‹©è£…é¥°æ¨¡å¼ã€‚</p><h3 id="Javascript-å¤–è§‚æ¨¡å¼"><a href="#Javascript-å¤–è§‚æ¨¡å¼" class="headerlink" title="Javascript å¤–è§‚æ¨¡å¼"></a>Javascript å¤–è§‚æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯å¤–è§‚æ¨¡å¼ï¼Ÿ</p></blockquote><p><strong>ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ç»Ÿä¸€æ¥å£</strong>ã€‚å¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªæ›´é«˜å±‚æ¬¡çš„æ¥å£ï¼Œä½¿å­ç³»ç»Ÿæ›´æ˜“äºä½¿ç”¨ã€‚æœ¯è¯­å¤–è§‚æ¥è‡ªæ³•è¯­ faÃ§adeï¼Œæ„æ€æ˜¯æ­£é¢æˆ–è„¸ã€‚</p><p>ç®€å•æ¥è¯´æ˜¯å¤–è§‚æ¨¡å¼éšè—äº†å­ç³»ç»Ÿçš„å®ç°å¤æ‚æ€§ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç®€æ´çš„æ¥å£ã€‚è¯¥æ¥å£è´Ÿè´£è°ƒç”¨ç°æœ‰å­ç³»ç»Ÿçš„åŠŸèƒ½</p><blockquote><p>å¤–è§‚æ¨¡å¼å®ç°æŒ‡å—</p></blockquote><p>å½“æˆ‘ä»¬æƒ³ä¸ºå­ç³»ç»Ÿæä¾›ä¸€ä¸ªç®€å•çš„æ¥å£æ—¶éœ€è¦ä½¿ç”¨å¤–è§‚æ¨¡å¼ã€‚éšç€å­ç³»ç»Ÿçš„å‘å±•ï¼Œå­ç³»ç»Ÿå¾€å¾€ä¼šå˜å¾—æ›´åŠ å¤æ‚ã€‚</p><p>å½“æˆ‘ä»¬åœ¨åº”ç”¨ä¸€äº›æ¨¡å¼æ—¶ï¼Œå¤§å¤šæ•°æ¨¡å¼ä¼šå¯¼è‡´æ›´å¤šçš„ç±»åˆ›å»ºå‡ºæ¥ï¼Œè¿™ä½¿å¾—å­ç³»ç»Ÿå¯ç”¨æ€§æ›´å¥½ï¼Œæ›´å®¹æ˜“è‡ªå®šä¹‰éœ€è¦çš„åŠŸèƒ½ï¼Œä½†å¯¹äºä¸å¤ªéœ€è¦è‡ªå®šä¹‰çš„ä¸šåŠ¡æ–¹è€Œè¨€ï¼Œå®ƒä¹Ÿå˜å¾—æ›´åŠ å›°éš¾ã€‚</p><p>å¤–è§‚æ¨¡å¼å°†å­ç³»ç»ŸåŒ…è£…æˆä¸€ä¸ªç®€å•é»˜è®¤çš„æ¥å£ï¼Œè¶³ä»¥åº”ä»˜å¤§å¤šæ•°æƒ…å†µçš„ä½¿ç”¨ã€‚</p><p>å¦å¤–ï¼Œå½“ä¸šåŠ¡æ–¹å’Œå­ç³»ç»Ÿçš„å®ç°å­˜åœ¨è¿‡å¤šä¾èµ–æ—¶ä¹Ÿå¯ä»¥é€‰æ‹©å¤–è§‚æ¨¡å¼ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤–è§‚æ¨¡å¼å°†å­ç³»ç»Ÿä»ä¸šåŠ¡æ–¹å’Œå…¶ä»–å­ç³»ç»Ÿä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä»è€Œæé«˜å­ç³»ç»Ÿçš„ç‹¬ç«‹æ€§å’Œå¯ç§»æ¤æ€§ã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¦‚æœå­ç³»ç»Ÿè¿‡äºè€¦åˆï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å¤–è§‚æ¨¡å¼æä¾›çš„æ¥å£æ¥ç®€åŒ–å­ç³»ç»Ÿä¹‹é—´çš„ä¾èµ–ã€‚</p><h3 id="JavaScript-äº«å…ƒæ¨¡å¼"><a href="#JavaScript-äº«å…ƒæ¨¡å¼" class="headerlink" title="JavaScript äº«å…ƒæ¨¡å¼"></a>JavaScript äº«å…ƒæ¨¡å¼</h3><p>å½“éœ€è¦åˆ›å»ºå¤§é‡ç›¸ä¼¼å¯¹è±¡æ—¶éœ€è¦ä½¿ç”¨äº«å…ƒæ¨¡å¼ï¼Œè¿™é‡Œçš„å¤§é‡æ˜¯ä¸Šä¸‡çš„é‡çº§è€Œä¸æ˜¯å¹³æ—¶æ¥è§¦çš„ä¸Šç™¾ã€‚</p><p>äº«å…ƒæ¨¡å¼é€šè¿‡ <strong>å…±äº«å¯¹è±¡çš„ç›¸ä¼¼éƒ¨åˆ†</strong>ï¼Œé¿å…é‡å¤åˆ›å»ºï¼Œæ¥è¾¾åˆ°å‡å°å†…å­˜çš„ä½¿ç”¨ã€‚</p><h3 id="JavaScript-ä»£ç†æ¨¡å¼"><a href="#JavaScript-ä»£ç†æ¨¡å¼" class="headerlink" title="JavaScript ä»£ç†æ¨¡å¼"></a>JavaScript ä»£ç†æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯ä»£ç†è®¾è®¡æ¨¡å¼ï¼Ÿ</p></blockquote><p>ä»£ç†æ˜¯ä¸€ä¸ª <strong>å°†è¢«ç”¨æ¥é™åˆ¶è®¿é—®å¦ä¸€ä¸ªç±»çš„ç±»</strong>ã€‚</p><p>è¿™å¯èƒ½æ˜¯å‡ºäºå®‰å…¨çš„è€ƒè™‘ï¼Œé€šè¿‡ä»£ç†æ¥å†³å®šéœ€è¦ä»£ç†çš„å¯¹è±¡å“ªäº›æ–¹æ³•æ˜¯å¯ç”¨çš„ã€‚</p><h2 id="è¡Œä¸ºå‹æ¨¡å¼"><a href="#è¡Œä¸ºå‹æ¨¡å¼" class="headerlink" title="è¡Œä¸ºå‹æ¨¡å¼"></a>è¡Œä¸ºå‹æ¨¡å¼</h2><p>è¿™ç±»æ¨¡å¼æè¿°äº†<code>å¯¹è±¡å¦‚ä½•ç›¸äº’ä½œç”¨</code>ï¼Œæ¨¡å¼å¦‚ä¸‹ï¼š</p><ul><li>è´£ä»»é“¾æ¨¡å¼</li><li>å‘½ä»¤æ¨¡å¼</li><li>è§£é‡Šå™¨æ¨¡å¼</li><li>è¿­ä»£å™¨æ¨¡å¼</li><li>ä¸­ä»‹è€…æ¨¡å¼</li><li>å¤‡å¿˜å½•æ¨¡å¼</li><li>è§‚å¯Ÿè€…æ¨¡å¼</li><li>çŠ¶æ€æ¨¡å¼</li><li>ç­–ç•¥æ¨¡å¼</li><li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</li><li>è®¿é—®è€…æ¨¡å¼</li></ul><h3 id="JavaScript-è´£ä»»é“¾æ¨¡å¼"><a href="#JavaScript-è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="JavaScript è´£ä»»é“¾æ¨¡å¼"></a>JavaScript è´£ä»»é“¾æ¨¡å¼</h3><p>è´£ä»»é“¾æ¨¡å¼æœ‰ä¸€ç»„å¯¹è±¡ï¼ŒæœŸæœ›å®ƒä»¬ä¹‹é—´èƒ½å¤Ÿè§£å†³é—®é¢˜ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå¯¹è±¡æ— æ³•è§£å†³å®ƒï¼Œåˆ™å°†æ•°æ®ä¼ é€’ç»™è´£ä»»é“¾ä¸­çš„ä¸‹ä¸€ä¸ªæ•°æ®ã€‚</p><p>é€šè¿‡å¤šä¸ªæ¥æ”¶è€…å¯¹è±¡æ¥å¤„ç†è¯·æ±‚ï¼Œé¿å…å°†è¯·æ±‚çš„å‘é€è€…è€¦åˆåˆ°å…¶æ¥æ”¶è€…ã€‚å°†æ¥æ”¶å¯¹è±¡ä¸²è”èµ·æ¥ï¼Œä¼ é€’è¯·æ±‚ç›´åˆ°è¢«å…¶ä¸­ä¸€ä¸ªå¤„ç†æ‰ã€‚</p><p>è´£ä»»é“¾æ¨¡å¼ä¸º <strong>è¯·æ±‚åˆ›å»ºä¸€ç³»åˆ—æ¥æ”¶è€…å¯¹è±¡</strong>ã€‚ åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œé€šå¸¸æ¯ä¸ªæ¥æ”¶å™¨éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶å™¨çš„å¼•ç”¨ã€‚</p><p>å¦‚æœä¸€ä¸ªæ¥æ”¶è€…ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œåˆ™å®ƒå°†è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ¥å—è€…ã€‚</p><h3 id="JavaScript-å‘½ä»¤æ¨¡å¼"><a href="#JavaScript-å‘½ä»¤æ¨¡å¼" class="headerlink" title="JavaScript å‘½ä»¤æ¨¡å¼"></a>JavaScript å‘½ä»¤æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯å‘½ä»¤æ¨¡å¼ï¼Ÿ</p></blockquote><p>å‘½ä»¤è®¾è®¡æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œå…¶å¯¹è±¡ç”¨äºè¡¨ç¤ºå’Œå°è£…ç¨åè°ƒç”¨æŸä¸ªæ–¹æ³•æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯åŒ…æ‹¬æ–¹æ³•åç§°ï¼Œæ‹¥æœ‰æ–¹æ³•çš„å¯¹è±¡å’Œæ–¹æ³•å‚æ•°çš„å€¼ã€‚</p><p>åŸºæœ¬ä¸Šï¼Œå®ƒå…è®¸ä½ åšçš„æ˜¯å­˜å‚¨ä»£ç æ¸…å•ï¼Œåœ¨ç¨åæˆ–å¤šæ¬¡æ‰§è¡Œï¼Œå¹¶ä¸”é€šå¸¸ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯ä»¥æ’¤é”€å‘½ä»¤ã€‚</p><p>å½“è¿™äº›å°è£…çš„å¯¹è±¡è°ƒç”¨ execute() æ–¹æ³•ï¼Œä¸šåŠ¡æ–¹æˆ–ç¨‹åºä¼šæ‰§è¡ŒæŒ‡å®šå‘½ä»¤æˆ–ä¸€æ®µä»£ç ã€‚</p><p>ç„¶åï¼Œè°ƒç”¨è€…å¯¹è±¡åœ¨è°ƒç”¨æ—¶ä¼šä¼ é€’å‘½ä»¤ç»™å‘½ä»¤æ¥æ”¶è€…ï¼Œå‘½ä»¤æ¥æ”¶è€…æ‹¥æœ‰å®é™…æƒ³è¦æ‰§è¡Œçš„ä»£ç ï¼Œä¸€æ—¦ä»è°ƒç”¨è€…æ¥æ”¶åˆ°å‘½ä»¤å°±ç«‹é©¬æ‰§è¡Œã€‚</p><p>ä¾‹å¦‚æœ‰ä¸ªâ€TurnTVOnâ€çš„å‘½ä»¤å¯¹è±¡ï¼Œç„¶åä¸€ä¸ªâ€œDeviceButtonâ€çš„å¯¹è±¡ï¼Œä¸€æ—¦â€DeviceButtonâ€å¯¹è±¡è¢«è°ƒç”¨å°±ä¼šå‘é€â€TurnTVOnâ€å‘½ä»¤ã€‚æ‰€æœ‰è¿™äº›ä¹‹é—´çš„æ¥å£å¯ä»¥ä½¿ç”¨å¤šæ€ï¼Œæ‰€ä»¥æ— è®ºä½•æ—¶è°ƒç”¨ TurnTVOnï¼Œè¯¥æ–¹æ³•å°†ç”±å‘½ä»¤æ¥æ”¶è€…æ‰§è¡Œã€‚</p><h3 id="JavaScript-è§£é‡Šå™¨æ¨¡å¼"><a href="#JavaScript-è§£é‡Šå™¨æ¨¡å¼" class="headerlink" title="JavaScript è§£é‡Šå™¨æ¨¡å¼"></a>JavaScript è§£é‡Šå™¨æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯è§£é‡Šå™¨æ¨¡å¼</p></blockquote><p>è§£é‡Šå™¨æ¨¡å¼å¾ˆå®¹æ˜“è¢«å¿½ç•¥ï¼Œå¹¶ä¸”ç½‘ä¸Šå¾ˆå°‘æœ‰ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœä¸ JavaScript åå°„æŠ€æœ¯ç»“åˆä½¿ç”¨ï¼Œä¼šå˜å¾—éå¸¸æœ‰ç”¨ã€‚å®ƒç”¨äºå°†æ•°æ®çš„ä¸€ç§è¡¨ç¤ºè½¬æ¢ä¸ºå¦ä¸€ç§è¡¨ç¤ºã€‚</p><h3 id="JavaScript-è¿­ä»£å™¨æ¨¡å¼"><a href="#JavaScript-è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="JavaScript è¿­ä»£å™¨æ¨¡å¼"></a>JavaScript è¿­ä»£å™¨æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯è¿­ä»£å™¨æ¨¡å¼ï¼Ÿ</p></blockquote><p>è¿­ä»£å™¨æ¨¡å¼æä¾›ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼æ¥è®¿é—®ä¸åŒç±»å‹çš„å¯¹è±¡é›†åˆã€‚</p><p>ä¾‹å¦‚ï¼ŒArrayï¼ŒArrayList å’Œ HashTableï¼Œè¿™ä¸‰ä¸ªé›†åˆåŒ…å«ç›¸åŒç±»å‹çš„å¯¹è±¡ï¼Œé€šè¿‡è¿­ä»£å™¨å¯ä»¥å–åˆ°é›†åˆé‡Œçš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶åšç›¸åŒçš„å¤„ç†ã€‚</p><p>è¿­ä»£å™¨æ¨¡å¼åšçš„æ˜¯æä¾›ç»Ÿä¸€çš„æ–¹å¼æ¥å¾ªç¯éå†è¿™äº›ä¸åŒç±»å‹çš„é›†åˆã€‚</p><h3 id="JavaScript-ä¸­ä»‹è€…è®¡æ¨¡å¼"><a href="#JavaScript-ä¸­ä»‹è€…è®¡æ¨¡å¼" class="headerlink" title="JavaScript ä¸­ä»‹è€…è®¡æ¨¡å¼"></a>JavaScript ä¸­ä»‹è€…è®¡æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯ä¸­ä»‹è€…æ¨¡å¼ï¼Ÿ</p></blockquote><p>ç”¨äºå¤„ç†ç›¸å…³å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ã€‚æ‰€æœ‰é€šä¿¡ç”±ä¸­ä»‹è€…å®Œæˆï¼Œé€šä¿¡åŒæ–¹ä¸éœ€è¦äº†è§£å¯¹æ–¹çš„ä»»ä½•ä¿¡æ¯ã€‚</p><p>æ›´ä¸¥æ ¼çš„å®šä¹‰æ˜¯ï¼Œä¸­ä»‹è€…æ¨¡å¼å…è®¸é€šè¿‡å°è£…ä¸åŒå¯¹è±¡ä¹‹é—´ç›¸äº’ä½œç”¨å’Œç›¸äº’é€šä¿¡çš„æ–¹å¼æ¥å®ç°æ¾è€¦åˆï¼Œå¹¶ä¸”ä¸­ä»‹è€…æ¨¡å¼å…è®¸æ¯ä¸ªå¯¹è±¡çš„è¡Œä¸ºå½¼æ­¤ç‹¬ç«‹åœ°å˜åŒ–ã€‚</p><h3 id="Javascript-å¤‡å¿˜å½•æ¨¡å¼"><a href="#Javascript-å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="Javascript å¤‡å¿˜å½•æ¨¡å¼"></a>Javascript å¤‡å¿˜å½•æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯å¤‡å¿˜å½•æ¨¡å¼ï¼Ÿ</p></blockquote><p>ç”¨äºå­˜å‚¨å¯¹è±¡ä»¥å‰çŠ¶æ€çš„æ¨¡å¼ï¼Œé¦–å…ˆï¼Œå¤‡å¿˜å½•æ¨¡å¼éœ€è¦ä¸€ä¸ªå¤‡å¿˜å½•å¯¹è±¡ç”¨äºå­˜å‚¨å¯¹è±¡çš„ä¸åŒçŠ¶æ€ï¼Œä¸åŒçš„çŠ¶æ€åŠä¸€äº›å­—æ®µæ‹¥æœ‰ä¸åŒçš„å€¼ã€‚</p><p>ç„¶åï¼Œç”¨äºä»å½“å‰ç›®æ ‡å¤‡å¿˜å½•å¯¹è±¡è¯»å†™å€¼çš„åˆå§‹å¯¹è±¡ï¼Œåˆ›å»ºæ–°çš„å¤‡å¿˜å½•å¯¹è±¡å¹¶èµ‹å€¼ç»™å½“å‰å¤‡å¿˜å½•å¯¹è±¡ã€‚</p><p>æœ€åï¼Œå†…éƒ¨æ˜¯ä¸€ä¸ª ArrayList å¯¹è±¡ç”¨äºæŒæœ‰ä¹‹å‰æ‰€æœ‰çš„å¤‡å¿˜å½•å¯¹è±¡ï¼Œè¯¥ ArrayList å¯¹è±¡åŒæ—¶ç”¨äºå­˜å‚¨å’Œæ£€ç´¢å¤‡å¿˜å½•å¯¹è±¡</p><h3 id="Javascript-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#Javascript-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="Javascript è§‚å¯Ÿè€…æ¨¡å¼"></a>Javascript è§‚å¯Ÿè€…æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿ</p></blockquote><p>å½“å¦ä¸€ä¸ªå¯¹è±¡æ›´æ”¹æ—¶éœ€è¦å…¶ä»–å¯¹è±¡æ¥æ”¶æ›´æ–°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¯¹è±¡æˆ–å‘å¸ƒè€…ä»£è¡¨è‚¡ç¥¨å¸‚åœºä¸­çš„æ•°åƒä¸ªè‚¡ç¥¨ï¼Œå½“éœ€è¦å°†æ›´æ–°å‘é€ç»™å¤šä¸ªè®¢é˜…è€…æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥å®Œæˆã€‚</p><blockquote><p>è§‚å¯Ÿè€…æ¨¡å¼çš„å¥½å¤„</p></blockquote><p>æ¾è€¦åˆã€‚ å¯¹è±¡æˆ–å‘å¸ƒè€…å®Œå…¨ä¸ç”¨çŸ¥é“è§‚å¯Ÿè€…æˆ–è®¢é˜…è€…çš„å­˜åœ¨ï¼Œæˆ‘æŠŠè¿™åˆ†ä¸ºä¸¤ç§ä¸åŒçš„æ¦‚å¿µï¼Œå› ä¸ºæˆ‘è§‰å¾—å‘å¸ƒ - è®¢é˜…æ›´æœ‰æ„ä¹‰ï¼Œä½† OLP çš„åŸºæœ¬æœ¯è¯­ä½¿ç”¨çš„æ˜¯å¯¹è±¡ - è§‚å¯Ÿè€…ã€‚</p><blockquote><p>åå¤„</p></blockquote><p>è§‚å¯Ÿè€…æ¨¡å¼å”¯ä¸€çš„ç¼ºç‚¹æ˜¯å¯¹è±¡æˆ–å‘å¸ƒè€…å¯èƒ½å‘é€å¯¹è§‚å¯Ÿè€…ï¼Œè®¢é˜…è€…æ— å…³ç´§è¦çš„æ›´æ–°ã€‚</p><h3 id="JavaScript-çŠ¶æ€æ¨¡å¼"><a href="#JavaScript-çŠ¶æ€æ¨¡å¼" class="headerlink" title="JavaScript çŠ¶æ€æ¨¡å¼"></a>JavaScript çŠ¶æ€æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯çŠ¶æ€æ¨¡å¼ï¼Ÿ</p></blockquote><p>å®ƒå…è®¸å¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å…¶è¡Œä¸ºï¼Œè¿™æ ·è®©å¯¹è±¡çœ‹èµ·æ¥æ”¹å˜äº†å®ƒæ‰€å±çš„ç±»ã€‚</p><p>çŠ¶æ€æ¨¡å¼ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>é¦–å…ˆï¼Œå°†æ‹¥æœ‰æ‰€è°“çš„â€œä¸Šä¸‹æ–‡â€æˆ–â€œè´¦æˆ·â€ï¼Œå®ƒå°†è¦åšçš„æ˜¯ç»´æŠ¤ä¸€ä¸ªå°†å®šä¹‰å½“å‰çŠ¶æ€çš„ ConcreteState å­ç±»çš„å®ä¾‹ã€‚</li><li>ç„¶åï¼Œæ‹¥æœ‰â€œçŠ¶æ€â€ï¼Œè¯¥çŠ¶æ€å®šä¹‰äº†ä¸€ä¸ªç”¨äºå°è£…ä¸ä¸Šä¸‹æ–‡ç‰¹å®šçŠ¶æ€å…³è”çš„è¡Œä¸ºæ¥å£ã€‚</li><li>æœ€åæ˜¯å…·ä½“çš„çŠ¶æ€ï¼Œæ¯ä¸ªå­ç±»å°†å®ç°ä¸ä¸Šä¸‹æ–‡çŠ¶æ€ç›¸å…³çš„è¡Œä¸º</li></ul><h3 id="Javascript-ç­–ç•¥æ¨¡å¼"><a href="#Javascript-ç­–ç•¥æ¨¡å¼" class="headerlink" title="Javascript ç­–ç•¥æ¨¡å¼"></a>Javascript ç­–ç•¥æ¨¡å¼</h3><blockquote><p>ä½•æ—¶ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Ÿ</p></blockquote><p>å¦‚æœè¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œè¯¥ç±»å°†å…·æœ‰ä¸åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…¶ä»–è¡Œä¸ºç›¸ä¼¼çš„è¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼ã€‚</p><p>ä¾‹å¦‚ï¼Œæœ‰çš„åŠ¨ç‰©å¯ä»¥é£ï¼Œæœ‰çš„åŠ¨ç‰©ä¸èƒ½é£ï¼Œè¿™é‡Œçš„ç›¸ä¼¼è¡Œä¸ºå°±æ˜¯é£è¡Œï¼Œä¸è®ºè¯¥åŠ¨ç‰©æ˜¯å¦èƒ½é£è¡Œã€‚</p><p>å¯ä»¥ä»ä»¥ä¸‹ç±»ä¸­é€‰æ‹©ç±»å¯¹è±¡ï¼š</p><p>1.ä¸ä¼šé£è¡Œ<br>2.ç”¨ç¿…è†€é£ç¿”<br>3.é£å¾—å¿«</p><p>é€šè¿‡ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€çš„åˆ›å»ºå…¨æ–°çš„ä¸åŒç±»å‹çš„é£è¡Œç±»åŠ¨ç‰©ã€‚</p><p>å½“éœ€è¦åŠ¨æ€å†³å®šéœ€è¦ä½¿ç”¨çš„è¡Œä¸ºæ—¶å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼ã€‚</p><blockquote><p>ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„å…¶ä»–å¥½å¤„</p></blockquote><p>å®ƒé€šå¸¸ä¼šå‡å°‘å¾ˆé•¿çš„æ¡ä»¶åˆ—è¡¨ï¼Œæ‰€ä»¥å¦‚æœä½ çœ‹åˆ°ä½¿ç”¨è®¸å¤šä¸åŒç±»å‹çš„æ¡ä»¶æ—¶ï¼Œç­–ç•¥æ¨¡å¼ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚å½“ç„¶ï¼Œè¿˜é¿å…äº†é‡å¤çš„ä»£ç ã€‚</p><p>ç­–ç•¥æ¨¡å¼å¯ä»¥é˜²æ­¢å…¶ä»–ç±»çš„å˜åŒ–å½±å“åˆ°å½“å‰ç±»ã€‚ä¹Ÿå¯ä»¥å‘ä¸šåŠ¡æ–¹éšè—å¤æ‚å’Œæ•æ„Ÿä»£ç ã€‚</p><p>åå¤„ï¼š<strong>ç­–ç•¥æ¨¡å¼ä¼šå¢åŠ å¯¹è±¡å’Œç±»çš„æ•°é‡</strong>ã€‚</p><h3 id="JavaScript-æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#JavaScript-æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="JavaScript æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>JavaScript æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Ÿ</p></blockquote><p>ç”¨äºåˆ›å»ºä¸€ç»„æ‰§è¡Œç±»ä¼¼æ–¹æ³•çš„å­ç±»ã€‚</p><p>è¦å®ç°å®ƒï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå°†åŒ…å«ä¸€ä¸ªåä¸ºæ¨¡æ¿æ–¹æ³•çš„æ–¹æ³•ã€‚</p><p>åˆ›å»ºåŒ…å«ç§°ä¸ºæ¨¡æ¿æ–¹æ³•çš„æŠ½è±¡ç±»ï¼Œå¹¶ä¸”æ¨¡æ¿æ–¹æ³•åŒ…å«æ¯ä¸ªå­ç±»å¯¹è±¡å°†è°ƒç”¨çš„ä¸€ç³»åˆ—æ–¹æ³•è°ƒç”¨ã€‚åœ¨æŸäº›æƒ…å†µä¸‹å­ç±»ä¹Ÿä¼šé‡è½½ä¸€äº›ä¸åˆé€‚çš„æ–¹æ³•è°ƒç”¨ã€‚</p><h3 id="Javascript-è®¿é—®è€…æ¨¡å¼"><a href="#Javascript-è®¿é—®è€…æ¨¡å¼" class="headerlink" title="Javascript è®¿é—®è€…æ¨¡å¼"></a>Javascript è®¿é—®è€…æ¨¡å¼</h3><blockquote><p>ä»€ä¹ˆæ˜¯è®¿é—®è€…æ¨¡å¼</p></blockquote><p>è®¿é—®è€…æ¨¡å¼å…è®¸å°†æ–¹æ³•æ·»åŠ åˆ°ä¸åŒç±»å‹çš„ç±»ä¸­ - ä½†å®ƒä»¬ä¸å¿…æ˜¯ä¸åŒçš„ç±»å‹ - åªä¼šè®©å¤æ‚åº¦æœ‰æ‰€å¢åŠ ï¼Œå¹¶ä¸ä¼šå¯¹ç±»æœ‰å¤ªå¤šä¿®æ”¹ã€‚</p><p>è¿™å¯ä»¥æ ¹æ®æ‰€ä½¿ç”¨çš„ç±»åˆ¶ä½œå®Œå…¨ä¸åŒçš„æ–¹æ³•ã€‚</p><p>ä¹Ÿå¯ä»¥è¯´è®¿é—®è€…æ¨¡å¼å¯ä»¥ä¸ºç°æœ‰ç±»åˆ›å»ºå¤–éƒ¨ç±»æ¥è¿›è¡Œæ‰©å±•ä»¥é¿å…å¯¹åŸæœ‰ç±»åšä¿®æ”¹ã€‚</p><p>æ³¨æ„ï¼šæŒæ¡æŠ½è±¡ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼Œå°è£…ï¼Œæ¥å£ï¼Œç±»å’ŒæŠ½è±¡ç±»ç­‰é¢å‘å¯¹è±¡æ¦‚å¿µçš„åŸºæœ¬çŸ¥è¯†å¯¹äºæ›´å¥½åœ°ç†è§£è®¾è®¡æ¨¡å¼éå¸¸é‡è¦ã€‚</p><p><a href="https://mp.weixin.qq.com/s/Ov62U8kktVv7Jz0Ukhekkg" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Airbnb React/JSX ç¼–ç è§„èŒƒ</title>
      <link href="/2018/06/28/study/Airbnb-React-JSX-%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/"/>
      <url>/2018/06/28/study/Airbnb-React-JSX-%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç®—æ˜¯æœ€åˆç†çš„React/JSXç¼–ç è§„èŒƒä¹‹ä¸€äº†</p><p>æ­¤ç¼–ç è§„èŒƒä¸»è¦åŸºäºç›®å‰æµè¡Œçš„JavaScriptæ ‡å‡†ï¼Œå°½ç®¡æŸäº›å…¶ä»–çº¦å®š(å¦‚async/awaitï¼Œé™æ€classå±æ€§)å¯èƒ½åœ¨ä¸åŒçš„é¡¹ç›®ä¸­è¢«å¼•å…¥æˆ–è€…è¢«ç¦ç”¨ã€‚ç›®å‰çš„çŠ¶æ€æ˜¯ä»»ä½•stage-3ä¹‹å‰çš„è§„èŒƒéƒ½ä¸åŒ…æ‹¬ä¹Ÿä¸æ¨èä½¿ç”¨ã€‚</p><h2 id="Basic-Rules-åŸºæœ¬è§„èŒƒ"><a href="#Basic-Rules-åŸºæœ¬è§„èŒƒ" class="headerlink" title="Basic Rules åŸºæœ¬è§„èŒƒ"></a>Basic Rules åŸºæœ¬è§„èŒƒ</h2><p>æ¯ä¸ªæ–‡ä»¶åªå†™ä¸€ä¸ªæ¨¡å—.<br>ä½†æ˜¯å¤šä¸ª<a href="https://reactjs.org/docs/components-and-props.html#stateless-functions" target="_blank" rel="noopener">æ— çŠ¶æ€æ¨¡å—</a>å¯ä»¥æ”¾åœ¨å•ä¸ªæ–‡ä»¶ä¸­. eslint: <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/no-multi-comp.md#ignorestateless" target="_blank" rel="noopener">react/no-multi-comp</a>.<br>æ¨èä½¿ç”¨JSXè¯­æ³•.<br>ä¸è¦ä½¿ç”¨ <code>React.createElement</code>ï¼Œé™¤éä»ä¸€ä¸ªéJSXçš„æ–‡ä»¶ä¸­åˆå§‹åŒ–ä½ çš„app.</p><h2 id="åˆ›å»ºæ¨¡å—"><a href="#åˆ›å»ºæ¨¡å—" class="headerlink" title="åˆ›å»ºæ¨¡å—"></a>åˆ›å»ºæ¨¡å—</h2><p>class vs React.createClass vs stateless</p><ul><li>å¦‚æœä½ çš„æ¨¡å—æœ‰å†…éƒ¨çŠ¶æ€æˆ–è€…æ˜¯refs, æ¨èä½¿ç”¨ <code>class extends React.Component</code> è€Œä¸æ˜¯ <code>React.createClass</code>. eslint:</li></ul><pre><code class="js">const Listing = React.createClass({  // ...  render() {    return &lt;div&gt;{this.state.hello}&lt;/div&gt;;  }});// goodclass Listing extends React.Component {  // ...  render() {    return &lt;div&gt;{this.state.hello}&lt;/div&gt;;  }}</code></pre><ul><li>å¦‚æœä½ çš„æ¨¡å—æ²¡æœ‰çŠ¶æ€æˆ–æ˜¯æ²¡æœ‰å¼•ç”¨refsï¼Œ æ¨èä½¿ç”¨æ™®é€šå‡½æ•°ï¼ˆéç®­å¤´å‡½æ•°ï¼‰è€Œä¸æ˜¯ç±»:</li></ul><pre><code class="js">// badclass Listing extends React.Component {  render() {    return &lt;div&gt;{this.props.hello}&lt;/div&gt;;  }}// bad (relying on function name inference is discouraged)const Listing = ({ hello }) =&gt; (  &lt;div&gt;{hello}&lt;/div&gt;);// goodfunction Listing({ hello }) {  return &lt;div&gt;{hello}&lt;/div&gt;;}</code></pre><a id="more"></a><h2 id="Mixins"><a href="#Mixins" class="headerlink" title="Mixins"></a>Mixins</h2><p><a href="https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html" target="_blank" rel="noopener">ä¸è¦ä½¿ç”¨Mixins</a></p><h2 id="Naming-å‘½å"><a href="#Naming-å‘½å" class="headerlink" title="Naming å‘½å"></a>Naming å‘½å</h2><ul><li>æ‰©å±•åï¼šReactæ¨¡å—ä½¿ç”¨.jsxæ‰©å±•åã€‚</li><li>æ–‡ä»¶åï¼šæ–‡ä»¶åä½¿ç”¨å¸•æ–¯å¡å‘½åã€‚å¦‚ï¼ŒReservationCard.jsxã€‚</li><li>å¼•ç”¨å‘½å: Reactæ¨¡å—åä½¿ç”¨å¸•æ–¯å¡å‘½åï¼Œå®ä¾‹ä½¿ç”¨éª†é©¼å¼å‘½å. eslint: react/jsx-pascal-case</li></ul><pre><code class="js">// badimport reservationCard from &#39;./ReservationCard&#39;;// goodimport ReservationCard from &#39;./ReservationCard&#39;;// badconst ReservationItem = &lt;ReservationCard /&gt;;// goodconst reservationItem = &lt;ReservationCard /&gt;;</code></pre><ul><li>æ¨¡å—å‘½å: æ¨¡å—ä½¿ç”¨å½“å‰æ–‡ä»¶åä¸€æ ·çš„åç§°. æ¯”å¦‚ ReservationCard.jsx åº”è¯¥åŒ…å«åä¸º ReservationCardçš„æ¨¡å—. ä½†æ˜¯ï¼Œå¦‚æœæ•´ä¸ªæ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œä½¿ç”¨ index.jsä½œä¸ºå…¥å£æ–‡ä»¶ï¼Œç„¶åç›´æ¥ä½¿ç”¨ index.js æˆ–è€…æ–‡ä»¶å¤¹åä½œä¸ºæ¨¡å—çš„åç§°:</li></ul><pre><code class="js">// badimport Footer from &#39;./Footer/Footer&#39;;// badimport Footer from &#39;./Footer/index&#39;;// goodimport Footer from &#39;./Footer&#39;;</code></pre><ul><li>é«˜é˜¶æ¨¡å—å‘½å: å¯¹äºç”Ÿæˆä¸€ä¸ªæ–°çš„æ¨¡å—ï¼Œå…¶ä¸­çš„æ¨¡å—å <code>displayName</code> åº”è¯¥ä¸ºé«˜é˜¶æ¨¡å—åå’Œä¼ å…¥æ¨¡å—åçš„ç»„åˆ. ä¾‹å¦‚, é«˜é˜¶æ¨¡å— <code>withFoo()</code>, å½“ä¼ å…¥ä¸€ä¸ª Bar æ¨¡å—çš„æ—¶å€™ï¼Œ ç”Ÿæˆçš„æ¨¡å—å <code>displayName</code> åº”è¯¥ä¸º <code>withFoo(Bar)</code>.</li></ul><blockquote><p>ä¸ºä»€ä¹ˆï¼Ÿä¸€ä¸ªæ¨¡å—çš„ displayName å¯èƒ½ä¼šåœ¨å¼€å‘è€…å·¥å…·æˆ–è€…é”™è¯¯ä¿¡æ¯ä¸­ä½¿ç”¨åˆ°ï¼Œå› æ­¤æœ‰ä¸€ä¸ªèƒ½æ¸…æ¥šçš„è¡¨è¾¾è¿™å±‚å…³ç³»çš„å€¼èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£æ¨¡å—å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæ›´å¥½çš„Debug.</p></blockquote><pre><code class="js">// badexport default function withFoo(WrappedComponent) {  return function WithFoo(props) {    return &lt;WrappedComponent {...props} foo /&gt;;  }}// goodexport default function withFoo(WrappedComponent) {  function WithFoo(props) {    return &lt;WrappedComponent {...props} foo /&gt;;  }  const wrappedComponentName = WrappedComponent.displayName    || WrappedComponent.name    || &#39;Component&#39;;  WithFoo.displayName = `withFoo(${wrappedComponentName})`;  return WithFoo;}</code></pre><ul><li>å±æ€§å‘½å: é¿å…ä½¿ç”¨DOMç›¸å…³çš„å±æ€§æ¥ç”¨ä½œå…¶ä»–çš„ç”¨é€”ã€‚</li></ul><blockquote><p>ä¸ºä»€ä¹ˆï¼Ÿå¯¹äº<code>style</code> å’Œ <code>className</code>è¿™æ ·çš„å±æ€§åï¼Œæˆ‘ä»¬éƒ½ä¼šé»˜è®¤å®ƒä»¬ä»£è¡¨ä¸€äº›ç‰¹æ®Šçš„å«ä¹‰ï¼Œå¦‚å…ƒç´ çš„æ ·å¼ï¼ŒCSS classçš„åç§°ã€‚åœ¨ä½ çš„åº”ç”¨ä¸­ä½¿ç”¨è¿™äº›å±æ€§æ¥è¡¨ç¤ºå…¶ä»–çš„å«ä¹‰ä¼šä½¿ä½ çš„ä»£ç æ›´éš¾é˜…è¯»ï¼Œæ›´éš¾ç»´æŠ¤ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¼•èµ·bugã€‚</p></blockquote><pre><code class="js">// bad&lt;MyComponent style=&quot;fancy&quot; /&gt;// good&lt;MyComponent variant=&quot;fancy&quot; /&gt;</code></pre><h2 id="Declaration-å£°æ˜æ¨¡å—"><a href="#Declaration-å£°æ˜æ¨¡å—" class="headerlink" title="Declaration å£°æ˜æ¨¡å—"></a>Declaration å£°æ˜æ¨¡å—</h2><ul><li>ä¸è¦ä½¿ç”¨ displayName æ¥å‘½åReactæ¨¡å—ï¼Œè€Œæ˜¯ä½¿ç”¨å¼•ç”¨æ¥å‘½åæ¨¡å—ï¼Œ å¦‚ class åç§°.</li></ul><pre><code class="js">// badexport default React.createClass({  displayName: &#39;ReservationCard&#39;,  // stuff goes here});// goodexport default class ReservationCard extends React.Component {}</code></pre><h2 id="Alignment-ä»£ç å¯¹é½"><a href="#Alignment-ä»£ç å¯¹é½" class="headerlink" title="Alignment ä»£ç å¯¹é½"></a>Alignment ä»£ç å¯¹é½</h2><p>éµå¾ªä»¥ä¸‹çš„JSXè¯­æ³•ç¼©è¿›/æ ¼å¼.</p><pre><code class="js">// bad&lt;Foo superLongParam=&quot;bar&quot;     anotherSuperLongParam=&quot;baz&quot; /&gt;// good, æœ‰å¤šè¡Œå±æ€§çš„è¯, æ–°å»ºä¸€è¡Œå…³é—­æ ‡ç­¾&lt;Foo  superLongParam=&quot;bar&quot;  anotherSuperLongParam=&quot;baz&quot;/&gt;// è‹¥èƒ½åœ¨ä¸€è¡Œä¸­æ˜¾ç¤º, ç›´æ¥å†™æˆä¸€è¡Œ&lt;Foo bar=&quot;bar&quot; /&gt;// å­å…ƒç´ æŒ‰ç…§å¸¸è§„æ–¹å¼ç¼©è¿›&lt;Foo  superLongParam=&quot;bar&quot;  anotherSuperLongParam=&quot;baz&quot;&gt;  &lt;Quux /&gt;&lt;/Foo&gt;</code></pre><h2 id="Quotes-å•å¼•å·è¿˜æ˜¯åŒå¼•å·"><a href="#Quotes-å•å¼•å·è¿˜æ˜¯åŒå¼•å·" class="headerlink" title="Quotes å•å¼•å·è¿˜æ˜¯åŒå¼•å·"></a>Quotes å•å¼•å·è¿˜æ˜¯åŒå¼•å·</h2><ul><li>å¯¹äºJSXå±æ€§å€¼æ€»æ˜¯ä½¿ç”¨åŒå¼•å·(â€œ), å…¶ä»–å‡ä½¿ç”¨å•å¼•å·(â€˜). eslint: jsx-quotes</li></ul><blockquote><p>ä¸ºä»€ä¹ˆ? HTMLå±æ€§ä¹Ÿæ˜¯ç”¨åŒå¼•å·, å› æ­¤JSXçš„å±æ€§ä¹Ÿéµå¾ªæ­¤çº¦å®š.</p></blockquote><pre><code class="js">// bad&lt;Foo bar=&#39;bar&#39; /&gt;// good&lt;Foo bar=&quot;bar&quot; /&gt;// bad&lt;Foo style={{ left: "20px" }} /&gt;// good&lt;Foo style={{ left: '20px' }} /&gt;</code></pre><h2 id="Spacing-ç©ºæ ¼"><a href="#Spacing-ç©ºæ ¼" class="headerlink" title="Spacing ç©ºæ ¼"></a>Spacing ç©ºæ ¼</h2><ul><li>æ€»æ˜¯åœ¨è‡ªåŠ¨å…³é—­çš„æ ‡ç­¾å‰åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¹Ÿä¸éœ€è¦æ¢è¡Œ.</li></ul><pre><code class="js">// bad&lt;Foo/&gt;// very bad&lt;Foo                 /&gt;// bad&lt;Foo /&gt;// good&lt;Foo /&gt;</code></pre><ul><li>ä¸è¦åœ¨JSX {} å¼•ç”¨æ‹¬å·é‡Œä¸¤è¾¹åŠ ç©ºæ ¼</li></ul><pre><code class="js">// bad&lt;Foo bar={ baz } /&gt;// good&lt;Foo bar={baz} /&gt;</code></pre><h2 id="Props-å±æ€§"><a href="#Props-å±æ€§" class="headerlink" title="Props å±æ€§"></a>Props å±æ€§</h2><ul><li>JSXå±æ€§åä½¿ç”¨éª†é©¼å¼é£æ ¼camelCase.</li></ul><pre><code class="js">// bad&lt;Foo  UserName=&quot;hello&quot;  phone_number={12345678}/&gt;// good&lt;Foo  userName=&quot;hello&quot;  phoneNumber={12345678}/&gt;</code></pre><ul><li>å¦‚æœå±æ€§å€¼ä¸º true, å¯ä»¥ç›´æ¥çœç•¥.</li></ul><pre><code class="js">// bad&lt;Foo  hidden={true}/&gt;// good&lt;Foo  hidden/&gt;// good&lt;Foo hidden /&gt;</code></pre><ul><li><code>&lt;img&gt;</code> æ ‡ç­¾æ€»æ˜¯æ·»åŠ  alt å±æ€§. å¦‚æœå›¾ç‰‡ä»¥presentation(æ„Ÿè§‰æ˜¯ä»¥ç±»ä¼¼PPTæ–¹å¼æ˜¾ç¤º?)æ–¹å¼æ˜¾ç¤ºï¼Œalt å¯ä¸ºç©º, æˆ–è€…<code>&lt;img&gt;</code> è¦åŒ…å«role=â€presentationâ€.</li></ul><pre><code class="js">// bad&lt;img src=&quot;hello.jpg&quot; /&gt;// good&lt;img src=&quot;hello.jpg&quot; alt=&quot;Me waving hello&quot; /&gt;// good&lt;img src=&quot;hello.jpg&quot; alt=&quot;&quot; /&gt;// good&lt;img src=&quot;hello.jpg&quot; role=&quot;presentation&quot; /&gt;</code></pre><ul><li>ä¸è¦åœ¨ alt å€¼é‡Œä½¿ç”¨å¦‚ â€œimageâ€, â€œphotoâ€, or â€œpictureâ€åŒ…æ‹¬å›¾ç‰‡å«ä¹‰è¿™æ ·çš„è¯ï¼Œ ä¸­æ–‡ä¹Ÿä¸€æ ·.</li></ul><blockquote><p>ä¸ºä»€ä¹ˆ? å±å¹•åŠ©è¯»å™¨å·²ç»æŠŠ img æ ‡ç­¾æ ‡æ³¨ä¸ºå›¾ç‰‡äº†, æ‰€ä»¥æ²¡æœ‰å¿…è¦å†åœ¨ alt é‡Œè¯´æ˜äº†.</p></blockquote><pre><code class="js">// bad&lt;img src=&quot;hello.jpg&quot; alt=&quot;Picture of me waving hello&quot; /&gt;// good&lt;img src=&quot;hello.jpg&quot; alt=&quot;Me waving hello&quot; /&gt;</code></pre><ul><li>ä½¿ç”¨æœ‰æ•ˆæ­£ç¡®çš„ aria roleå±æ€§å€¼ ARIA roles.</li></ul><pre><code class="js">// bad - not an ARIA role&lt;div role=&quot;datepicker&quot; /&gt;// bad - abstract ARIA role&lt;div role=&quot;range&quot; /&gt;// good&lt;div role=&quot;button&quot; /&gt;</code></pre><ul><li>ä¸è¦åœ¨æ ‡ç­¾ä¸Šä½¿ç”¨ accessKey å±æ€§.</li></ul><blockquote><p>ä¸ºä»€ä¹ˆ? å±å¹•åŠ©è¯»å™¨åœ¨é”®ç›˜å¿«æ·é”®ä¸é”®ç›˜å‘½ä»¤æ—¶é€ æˆçš„ä¸ç»Ÿä¸€æ€§ä¼šå¯¼è‡´é˜…è¯»æ€§æ›´åŠ å¤æ‚.</p></blockquote><pre><code class="js">// bad&lt;div accessKey=&quot;h&quot; /&gt;// good&lt;div /&gt;</code></pre><ul><li>é¿å…ä½¿ç”¨æ•°ç»„çš„indexæ¥ä½œä¸ºå±æ€§keyçš„å€¼ï¼Œæ¨èä½¿ç”¨å”¯ä¸€ID.</li></ul><pre><code class="js">// bad{todos.map((todo, index) =&gt;  &lt;Todo    {...todo}    key={index}  /&gt;)}// good{todos.map(todo =&gt; (  &lt;Todo    {...todo}    key={todo.id}  /&gt;))}</code></pre><ul><li>å¯¹äºæ‰€æœ‰éå¿…é¡»çš„å±æ€§ï¼Œæ€»æ˜¯æ‰‹åŠ¨å»å®šä¹‰defaultPropså±æ€§.</li></ul><blockquote><p>ä¸ºä»€ä¹ˆ? propTypes å¯ä»¥ä½œä¸ºæ¨¡å—çš„æ–‡æ¡£è¯´æ˜, å¹¶ä¸”å£°æ˜ defaultProps çš„è¯æ„å‘³ç€é˜…è¯»ä»£ç çš„äººä¸éœ€è¦å»å‡è®¾ä¸€äº›é»˜è®¤å€¼ã€‚æ›´é‡è¦çš„æ˜¯, æ˜¾ç¤ºçš„å£°æ˜é»˜è®¤å±æ€§å¯ä»¥è®©ä½ çš„æ¨¡å—è·³è¿‡å±æ€§ç±»å‹çš„æ£€æŸ¥.</p></blockquote><pre><code class="js">// badfunction SFC({ foo, bar, children }) {  return &lt;div&gt;{foo}{bar}{children}&lt;/div&gt;;}SFC.propTypes = {  foo: PropTypes.number.isRequired,  bar: PropTypes.string,  children: PropTypes.node,};// goodfunction SFC({ foo, bar, children }) {  return &lt;div&gt;{foo}{bar}{children}&lt;/div&gt;;}SFC.propTypes = {  foo: PropTypes.number.isRequired,  bar: PropTypes.string,  children: PropTypes.node,};SFC.defaultProps = {  bar: &#39;&#39;,  children: null,};</code></pre><ul><li>å°½å¯èƒ½å°‘åœ°ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦</li></ul><blockquote><p>ä¸ºä»€ä¹ˆ? é™¤éä½ å¾ˆæƒ³ä¼ é€’ä¸€äº›ä¸å¿…è¦çš„å±æ€§</p></blockquote><p><strong>ä¾‹å¤–æƒ…å†µ:</strong></p><ul><li>ä½¿ç”¨äº†å˜é‡æå‡çš„é«˜é˜¶ç»„ä»¶</li></ul><pre><code class="js">function HOC(WrappedComponent) {  return class Proxy extends React.Component {    Proxy.propTypes = {      text: PropTypes.string,      isLoading: PropTypes.bool    };    render() {      return &lt;WrappedComponent {...this.props} /&gt;    }  }}  </code></pre><p>åªæœ‰åœ¨æ¸…æ¥šæ˜ç™½æ‰©å±•å¯¹è±¡æ—¶æ‰ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ã€‚è¿™éå¸¸æœ‰ç”¨å°¤å…¶æ˜¯åœ¨ä½¿ç”¨Mochaæµ‹è¯•ç»„ä»¶çš„æ—¶å€™ã€‚</p><pre><code class="js">export default function Foo {  const props = {    text: &#39;&#39;,    isPublished: false  }  return (&lt;div {...props} /&gt;);}</code></pre><p>ç‰¹åˆ«æé†’ï¼šå°½å¯èƒ½åœ°ç­›é€‰å‡ºä¸å¿…è¦çš„å±æ€§ã€‚åŒæ—¶ï¼Œä½¿ç”¨prop-types-exactæ¥é¢„é˜²é—®é¢˜å‡ºç°ã€‚</p><pre><code class="js"> //goodrender() {  const { irrelevantProp, ...relevantProps  } = this.props;  return &lt;WrappedComponent {...relevantProps} /&gt;}//badrender() {  const { irrelevantProp, ...relevantProps  } = this.props;  return &lt;WrappedComponent {...this.props} /&gt;}</code></pre><h2 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h2><p>æ€»æ˜¯åœ¨Refsé‡Œä½¿ç”¨å›è°ƒå‡½æ•°.</p><pre><code class="js">// bad&lt;Foo  ref=&quot;myRef&quot;/&gt;// good&lt;Foo  ref={(ref) =&gt; { this.myRef = ref; }}/&gt;</code></pre><h2 id="Parentheses-æ‹¬å·"><a href="#Parentheses-æ‹¬å·" class="headerlink" title="Parentheses æ‹¬å·"></a>Parentheses æ‹¬å·</h2><ul><li>å°†å¤šè¡Œçš„JSXæ ‡ç­¾å†™åœ¨()é‡Œ</li></ul><pre><code class="js">// badrender() {  return &lt;MyComponent className=&quot;long body&quot; foo=&quot;bar&quot;&gt;           &lt;MyChild /&gt;         &lt;/MyComponent&gt;;}// goodrender() {  return (    &lt;MyComponent className=&quot;long body&quot; foo=&quot;bar&quot;&gt;      &lt;MyChild /&gt;    &lt;/MyComponent&gt;  );}// good, å•è¡Œå¯ä»¥ä¸éœ€è¦render() {  const body = &lt;div&gt;hello&lt;/div&gt;;  return &lt;MyComponent&gt;{body}&lt;/MyComponent&gt;;}</code></pre><h2 id="Tags-æ ‡ç­¾"><a href="#Tags-æ ‡ç­¾" class="headerlink" title="Tags æ ‡ç­¾"></a>Tags æ ‡ç­¾</h2><ul><li>æ²¡æœ‰å­å…ƒç´ æ ‡ç­¾æ€»æ˜¯è‡ªå·±é—­åˆ</li></ul><pre><code class="js">// bad&lt;foo className=&quot;stuff&quot;&gt;&lt;/foo&gt;//good&lt;foo className=&quot;stuff&quot;/&gt;</code></pre><ul><li>å¦‚æœæ¨¡å—æœ‰å¤šè¡Œçš„å±æ€§ï¼Œ å…³é—­æ ‡ç­¾æ—¶æ–°å»ºä¸€è¡Œ.</li></ul><pre><code class="js">// bad&lt;Foo  bar=&quot;bar&quot;  baz=&quot;baz&quot; /&gt;// good&lt;Foo  bar=&quot;bar&quot;  baz=&quot;baz&quot;/&gt;</code></pre><h2 id="Methodså‡½æ•°"><a href="#Methodså‡½æ•°" class="headerlink" title="Methodså‡½æ•°"></a>Methodså‡½æ•°</h2><ul><li>ä½¿ç”¨ç®­å¤´å‡½æ•°æ¥è·å–æœ¬åœ°å˜é‡.</li></ul><pre><code class="js">function ItemList(props) {  return (    &lt;ul&gt;      {props.items.map((item, index) =&gt; (        &lt;Item          key={item.key}          onClick={() =&gt; doSomethingWith(item.name, index)}        /&gt;      ))}    &lt;/ul&gt;  );}</code></pre><ul><li>å½“åœ¨ render() é‡Œä½¿ç”¨äº‹ä»¶å¤„ç†æ–¹æ³•æ—¶ï¼Œæå‰åœ¨æ„é€ å‡½æ•°é‡ŒæŠŠ this ç»‘å®šä¸Šå».</li></ul><blockquote><p>ä¸ºä»€ä¹ˆ? åœ¨æ¯æ¬¡ render è¿‡ç¨‹ä¸­ï¼Œ å†è°ƒç”¨ bind éƒ½ä¼šæ–°å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæµªè´¹èµ„æº.</p></blockquote><pre><code class="js">// badclass extends React.Component {  onClickDiv() {    // do stuff  }  render() {    return &lt;div onClick={this.onClickDiv.bind(this)} /&gt;;  }}// goodclass extends React.Component {  constructor(props) {    super(props);    this.onClickDiv = this.onClickDiv.bind(this);  }  onClickDiv() {    // do stuff  }  render() {    return &lt;div onClick={this.onClickDiv} /&gt;;  }}</code></pre><ul><li>åœ¨Reactæ¨¡å—ä¸­ï¼Œä¸è¦ç»™æ‰€è°“çš„ç§æœ‰å‡½æ•°æ·»åŠ  _ å‰ç¼€ï¼Œæœ¬è´¨ä¸Šå®ƒå¹¶ä¸æ˜¯ç§æœ‰çš„.</li></ul><blockquote><p>ä¸ºä»€ä¹ˆï¼Ÿ_ ä¸‹åˆ’çº¿å‰ç¼€åœ¨æŸäº›è¯­è¨€ä¸­é€šå¸¸è¢«ç”¨æ¥è¡¨ç¤ºç§æœ‰å˜é‡æˆ–è€…å‡½æ•°ã€‚ä½†æ˜¯ä¸åƒå…¶ä»–çš„ä¸€äº›è¯­è¨€ï¼Œåœ¨JSä¸­æ²¡æœ‰åŸç”Ÿæ”¯æŒæ‰€è°“çš„ç§æœ‰å˜é‡ï¼Œæ‰€æœ‰çš„å˜é‡å‡½æ•°éƒ½æ˜¯å…±æœ‰çš„ã€‚å°½ç®¡ä½ çš„æ„å›¾æ˜¯ä½¿å®ƒç§æœ‰åŒ–ï¼Œåœ¨ä¹‹å‰åŠ ä¸Šä¸‹åˆ’çº¿å¹¶ä¸ä¼šä½¿è¿™äº›å˜é‡ç§æœ‰åŒ–ï¼Œå¹¶ä¸”æ‰€æœ‰çš„å±æ€§ï¼ˆåŒ…æ‹¬æœ‰ä¸‹åˆ’çº¿å‰ç¼€åŠæ²¡æœ‰å‰ç¼€çš„ï¼‰éƒ½åº”è¯¥è¢«è§†ä¸ºæ˜¯å…±æœ‰çš„ã€‚äº†è§£æ›´å¤šè¯¦æƒ…è¯·æŸ¥çœ‹Issue <a href="https://github.com/airbnb/javascript/issues/1024" target="_blank" rel="noopener">#1024</a>, å’Œ <a href="https://github.com/airbnb/javascript/issues/490" target="_blank" rel="noopener">#490</a> ã€‚</p></blockquote><pre><code class="js">// badReact.createClass({  _onClickSubmit() {    // do stuff  },  // other stuff});// goodclass extends React.Component {  onClickSubmit() {    // do stuff  }  // other stuff}</code></pre><ul><li>åœ¨ render æ–¹æ³•ä¸­æ€»æ˜¯ç¡®ä¿ return è¿”å›å€¼.</li></ul><pre><code class="js">// badrender() {  (&lt;div /&gt;);}// goodrender() {  return (&lt;div /&gt;);}</code></pre><h2 id="Ordering-React-æ¨¡å—ç”Ÿå‘½å‘¨æœŸ"><a href="#Ordering-React-æ¨¡å—ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Ordering React æ¨¡å—ç”Ÿå‘½å‘¨æœŸ"></a>Ordering React æ¨¡å—ç”Ÿå‘½å‘¨æœŸ</h2><ul><li>class extends React.Component çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°:</li></ul><p>1.å¯é€‰çš„ static æ–¹æ³•<br>2.constructor æ„é€ å‡½æ•°<br>3.getChildContext è·å–å­å…ƒç´ å†…å®¹<br>4.componentWillMount æ¨¡å—æ¸²æŸ“å‰<br>5.componentDidMount æ¨¡å—æ¸²æŸ“å<br>6.componentWillReceiveProps æ¨¡å—å°†æ¥å—æ–°çš„æ•°æ®<br>7.shouldComponentUpdate åˆ¤æ–­æ¨¡å—éœ€ä¸éœ€è¦é‡æ–°æ¸²æŸ“<br>8.componentWillUpdate ä¸Šé¢çš„æ–¹æ³•è¿”å› trueï¼Œ æ¨¡å—å°†é‡æ–°æ¸²æŸ“<br>9.componentDidUpdate æ¨¡å—æ¸²æŸ“ç»“æŸ<br>10.componentWillUnmount æ¨¡å—å°†ä»DOMä¸­æ¸…é™¤, åšä¸€äº›æ¸…ç†ä»»åŠ¡<br>11.ç‚¹å‡»å›è°ƒæˆ–è€…äº‹ä»¶å¤„ç†å™¨ å¦‚ onClickSubmit() æˆ– onChangeDescription()<br>12.render é‡Œçš„ getter æ–¹æ³• å¦‚ getSelectReason() æˆ– getFooterContent()<br>13.å¯é€‰çš„ render æ–¹æ³• å¦‚ renderNavigation() æˆ– renderProfilePicture()<br>14.render render() æ–¹æ³•</p><ul><li>å¦‚ä½•å®šä¹‰ <code>propTypes</code>, <code>defaultProps</code>, <code>contextTypes</code>, ç­‰ç­‰å…¶ä»–å±æ€§â€¦</li></ul><pre><code class="js">import React from &#39;react&#39;;import PropTypes from &#39;prop-types&#39;;const propTypes = {  id: PropTypes.number.isRequired,  url: PropTypes.string.isRequired,  text: PropTypes.string,};const defaultProps = {  text: &#39;Hello World&#39;,};class Link extends React.Component {  static methodsAreOk() {    return true;  }  render() {    return &lt;a href={this.props.url} data-id={this.props.id}&gt;{this.props.text}&lt;/a&gt;;  }}Link.propTypes = propTypes;Link.defaultProps = defaultProps;export default Link;</code></pre><ul><li>React.createClass çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä¸ä½¿ç”¨classç¨æœ‰ä¸åŒ:</li></ul><p>1.displayName è®¾å®šæ¨¡å—åç§°<br>2.propTypes è®¾ç½®å±æ€§çš„ç±»å‹<br>3.contextTypes è®¾ç½®ä¸Šä¸‹æ–‡ç±»å‹<br>4.childContextTypes è®¾ç½®å­å…ƒç´ ä¸Šä¸‹æ–‡ç±»å‹<br>5.mixins æ·»åŠ ä¸€äº›mixins<br>6.statics<br>7.defaultProps è®¾ç½®é»˜è®¤çš„å±æ€§å€¼<br>8.getDefaultProps è·å–é»˜è®¤å±æ€§å€¼<br>9.getInitialState æˆ–è€…åˆå§‹çŠ¶æ€<br>10.getChildContext<br>11.componentWillMount<br>12.componentDidMount<br>13.componentWillReceiveProps<br>14.shouldComponentUpdate<br>15.componentWillUpdate<br>16.componentDidUpdate<br>17.componentWillUnmount<br>18.clickHandlers or eventHandlers like onClickSubmit() or onChangeDescription()<br>19.getter methods for render like getSelectReason() or getFooterContent()<br>20.Optional render methods like renderNavigation() or renderProfilePicture()<br>21.render</p><h2 id="isMounted"><a href="#isMounted" class="headerlink" title="isMounted"></a>isMounted</h2><blockquote><p>ä¸ºä»€ä¹ˆ? isMounted åäººç±»è®¾è®¡æ¨¡å¼:(), åœ¨ ES6 classes ä¸­æ— æ³•ä½¿ç”¨ï¼Œ å®˜æ–¹å°†åœ¨æœªæ¥çš„ç‰ˆæœ¬é‡Œåˆ é™¤æ­¤æ–¹æ³•.</p></blockquote><h2 id="æ›´å¤šç¼–ç è§„èŒƒ"><a href="#æ›´å¤šç¼–ç è§„èŒƒ" class="headerlink" title="æ›´å¤šç¼–ç è§„èŒƒ"></a>æ›´å¤šç¼–ç è§„èŒƒ</h2><p><a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener">javascript</a><br><a href="https://cn.vuejs.org/v2/style-guide" target="_blank" rel="noopener">vue</a></p><p><a href="https://github.com/JasonBoy/javascript/tree/master/react" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–ç é£æ ¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯è·¯ç”±å®ç°ä¸react-routeræºç åˆ†æ</title>
      <link href="/2018/06/21/React/React-router/%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0%E4%B8%8Ereact-router%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
      <url>/2018/06/21/React/React-router/%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0%E4%B8%8Ereact-router%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨å•é¡µåº”ç”¨ä¸Šï¼Œå‰ç«¯è·¯ç”±å¹¶ä¸é™Œç”Ÿã€‚å¾ˆå¤šå‰ç«¯æ¡†æ¶ä¹Ÿä¼šæœ‰ç‹¬ç«‹å¼€å‘æˆ–æ¨èé…å¥—ä½¿ç”¨çš„è·¯ç”±ç³»ç»Ÿã€‚é‚£ä¹ˆï¼Œå½“æˆ‘ä»¬åœ¨è°ˆå‰ç«¯è·¯ç”±çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥è°ˆäº›ä»€ä¹ˆï¼Ÿæœ¬æ–‡å°†ç®€è¦åˆ†æå¹¶å®ç°ä¸€ä¸ªçš„å‰ç«¯è·¯ç”±ï¼Œå¹¶å¯¹ react-router è¿›è¡Œåˆ†æã€‚</p><h2 id="ä¸€ä¸ªæç®€å‰ç«¯è·¯ç”±å®ç°"><a href="#ä¸€ä¸ªæç®€å‰ç«¯è·¯ç”±å®ç°" class="headerlink" title="ä¸€ä¸ªæç®€å‰ç«¯è·¯ç”±å®ç°"></a>ä¸€ä¸ªæç®€å‰ç«¯è·¯ç”±å®ç°</h2><p>è°ˆä¸€ä¸‹å‰ç«¯è·¯ç”±çš„ç®€è¦åŸç†ï¼Œä»¥hashå½¢å¼ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨History APIåšå¤„ç†ï¼‰ä¸ºä¾‹ï¼Œå½“urlçš„hashå‘ç”Ÿå˜åŒ–æ—¶ï¼Œè§¦å‘hashchangeæ³¨å†Œçš„å›è°ƒï¼Œåœ¨å›è°ƒä¸­è¿›è¡Œä¸åŒçš„æ“ä½œï¼Œå±•ç¤ºä¸åŒçš„é¡µé¢ã€‚ç›´æ¥çœ‹ä»£ç æ¯”è¾ƒç›´è§‚ã€‚</p><pre><code class="js">    function Router(){        this.routes = {};        this.currentUrl = &#39;&#39;;    }    // å­˜å‚¨è·¯ç”±æ›´æ–°æ—¶çš„å›è°ƒåˆ°å›è°ƒæ•°ç»„routesä¸­ï¼Œå›è°ƒå‡½æ•°å°†è´Ÿè´£å¯¹é¡µé¢çš„æ›´æ–°    Router.prototype.route = function(path,callback) {        this.routes[path] = callback || function(){};    }    // è·¯ç”±æ‰§è¡Œå½“å‰urlå¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œæ›´æ–°é¡µé¢    Router.prototype.refresh = function(){        this.currentUrl = location.hash.slice(1) || &#39;/&#39;;        this.routes[this.currentUrl]()    }    // è·¯ç”±ç›‘å¬    Router.prototype.init = function(){        window.addEventListener(&#39;load&#39;,this.refresh.bind(this),false);        window.addEventListener(&#39;hashChange&#39;,this.refresh.bind(this),false);    }    window.Router = new Router();    window.Router.init();</code></pre><blockquote><p>ä¸Šé¢è·¯ç”±ç³»ç»ŸRouterå¯¹è±¡å®ç°ï¼Œä¸»è¦æä¾›ä¸‰ä¸ªæ–¹æ³•</p><ul><li>route å­˜å‚¨è·¯ç”±æ›´æ–°æ—¶çš„å›è°ƒåˆ°å›è°ƒæ•°ç»„routesä¸­ï¼Œå›è°ƒå‡½æ•°å°†è´Ÿè´£å¯¹é¡µé¢çš„æ›´æ–°</li><li>refresh æ‰§è¡Œå½“å‰urlå¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œæ›´æ–°é¡µé¢</li><li>init ç›‘å¬æµè§ˆå™¨ url hash æ›´æ–°äº‹ä»¶</li></ul></blockquote><p>Routerè°ƒç”¨æ–¹æ³•ä»¥åŠå‘ˆç°æ•ˆæœå¦‚ä¸‹ï¼Œç‚¹å‡»å¯¹åº”çš„urlï¼ŒèƒŒæ™¯è‰²å‘ç”Ÿä¸åŒçš„å˜åŒ–</p><pre><code class="html">    &lt;ul&gt;        &lt;li&gt;&lt;a href=&quot;#&quot;&gt;turn white&lt;/a&gt;&lt;/li&gt;        &lt;li&gt;&lt;a href=&quot;#/blue&quot;&gt;turn bule&lt;/a&gt;&lt;/li&gt;        &lt;li&gt;&lt;a href=&quot;#/green&quot;&gt;&lt;/a&gt;turn green&lt;/li&gt;    &lt;ul&gt;</code></pre><pre><code class="js">    var content = document.quserSelecotor(&#39;body&#39;);    // change page anything    function changebBgColor(color){        content.style.backgroundColor = color;    }    Router(&#39;/&#39;,function(){        changeBgColor(&#39;white&#39;);    })    Router(&#39;/blue&#39;,function(){        changeBgColor(&#39;blue&#39;);    })    Router(&#39;/green&#39;,function(){        changeBgColor(&#39;green&#39;);    })</code></pre><a id="more"></a><p><img src="https://cloud.githubusercontent.com/assets/10385585/15266370/156436f6-19d5-11e6-8c90-c24f6d8cc24e.gif" alt="router"></p><p>ä»¥ä¸Šä¸ºä¸€ä¸ªå‰ç«¯è·¯ç”±çš„ç®€å•å®ç°ï¼Œè™½ç„¶ç®€å•ï¼Œä½†å®é™…ä¸Šå¾ˆå¤šè·¯ç”±ç³»ç»Ÿçš„æ ¹åŸºéƒ½ç«‹äºæ­¤ï¼Œå…¶ä»–è·¯ç”±ç³»ç»Ÿä¸»è¦æ˜¯å¯¹è‡ªèº«ä½¿ç”¨çš„æ¡†æ¶æœºåˆ¶çš„è¿›è¡Œé…å¥—åŠä¼˜åŒ–ï¼Œå¦‚ä¸ react é…å¥—çš„ <a href="https://github.com/ReactTraining/react-router" target="_blank" rel="noopener">react-router</a>ã€‚</p><h2 id="react-router-åˆ†æ"><a href="#react-router-åˆ†æ" class="headerlink" title="react-router åˆ†æ"></a>react-router åˆ†æ</h2><h3 id="react-router-ä¸-history-ç»“åˆå½¢å¼"><a href="#react-router-ä¸-history-ç»“åˆå½¢å¼" class="headerlink" title="react-router ä¸ history ç»“åˆå½¢å¼"></a>react-router ä¸ history ç»“åˆå½¢å¼</h3><p>react-routeræ˜¯åŸºäºhistoryæ¨¡å—æä¾›çš„apiè¿›è¡Œå¼€å‘çš„ï¼Œç»“åˆçš„å½¢å¼æœ¬æ–‡è®°ä¸º<strong>åŒ…è£…å½¢å¼</strong>ã€‚æ‰€ä»¥åœ¨å¼€å§‹å¯¹å…¶åˆ†æä¹‹å‰ï¼Œå…ˆ<code>ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•è¿›è¡Œå¯¹è±¡çš„åŒ…è£…</code>ã€‚</p><pre><code class="js">//åŸå¯¹è±¡var historyModule = {    listener: [],    listen: function(listener){        this.listener.push(listener);        console.log(&#39;historyModule listen&#39;);    },    updateLocation: funcion(){        this.listener.forEach(function(listener){            listener(&#39;new location&#39;);        })    }}//Routerå°†ç”¨historyModuleå¯¹è±¡å°†å…¶åŒ…è£…var Router = {    source:{},    init: function(source){        this.source = source;    },    listen: function(listener){        return this.source.listen(function(location){            console.log(&#39;Router listen tirgger&#39;);            listener(location);        })    }}//å°†historyModuleæ³¨å…¥åˆ°Routerä¸­Router.init(historyModule);//Router æ³¨å†Œç›‘å¬Router.listen(function(location){    console.log(loaction + &#39;-&gt; router setstate&#39;);})// historyModule è§¦å‘å›è°ƒhistoryModule.updateLocation()</code></pre><p>è¿”å›ï¼š<br><img src="https://cloud.githubusercontent.com/assets/10385585/15266368/fd76c04a-19d4-11e6-9e9f-817f71eaab09.png" alt="demo"></p><p>å¯çœ‹åˆ° historyModule ä¸­å«æœ‰æœºåˆ¶ï¼šhistoryModule.updateLocation() -&gt; listener( )ï¼ŒRouter é€šè¿‡å¯¹å…¶è¿›è¡ŒåŒ…è£…å¼€å‘ï¼Œé’ˆå¯¹ historyModule çš„æœºåˆ¶å¯¹ Router ä¹Ÿèµ·åˆ°äº†ä½œç”¨ï¼Œå³historyModule.updateLocation() å°†è§¦å‘ Router.listen ä¸­çš„å›è°ƒå‡½æ•° ã€‚<a href="https://github.com/joeyguo/blog/blob/master/lab/2016/router/package-style.html" target="_blank" rel="noopener">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a><br>è¿™ç§åŒ…è£…å½¢å¼èƒ½å¤Ÿå……åˆ†åˆ©ç”¨åŸå¯¹è±¡ï¼ˆhistoryModule ï¼‰çš„å†…éƒ¨æœºåˆ¶ï¼Œå‡å°‘å¼€å‘æˆæœ¬ï¼Œä¹Ÿæ›´å¥½çš„åˆ†ç¦»åŒ…è£…å‡½æ•°ï¼ˆRouterï¼‰çš„é€»è¾‘ï¼Œå‡å°‘å¯¹åŸå¯¹è±¡çš„å½±å“ã€‚</p><h3 id="react-router-ä½¿ç”¨æ–¹å¼"><a href="#react-router-ä½¿ç”¨æ–¹å¼" class="headerlink" title="react-router ä½¿ç”¨æ–¹å¼"></a>react-router ä½¿ç”¨æ–¹å¼</h3><p>react-router ä»¥ <code>react component</code> çš„ç»„ä»¶æ–¹å¼æä¾› APIï¼Œ åŒ…å« <code>Routerï¼ŒRouteï¼ŒRedirectï¼ŒLink</code> ç­‰ç­‰ï¼Œè¿™æ ·èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ <code>react component</code> æä¾›çš„ç”Ÿå‘½å‘¨æœŸç‰¹æ€§ï¼ŒåŒæ—¶ä¹Ÿè®©å®šä¹‰è·¯ç”±è·Ÿå†™ react component è¾¾åˆ°ç»Ÿä¸€ï¼Œå¦‚ä¸‹</p><pre><code class="js">    render((    &lt;Router history={browserHistory}&gt;        &lt;Route path=&quot;/&quot; component={App}&gt;        &lt;Route path=&quot;about&quot; component={About}/&gt;        &lt;Route path=&quot;users&quot; component={Users}&gt;            &lt;Route path=&quot;/user/:userId&quot; component={User}/&gt;        &lt;/Route&gt;        &lt;Route path=&quot;*&quot; component={NoMatch}/&gt;        &lt;/Route&gt;    &lt;/Router&gt;    ), document.body)</code></pre><p>å°±è¿™æ ·ï¼Œå£°æ˜äº†ä¸€ä»½å«æœ‰ path to component çš„å„ä¸ªæ˜ å°„çš„è·¯ç”±è¡¨ã€‚</p><p>react-router è¿˜æä¾›çš„ Link ç»„ä»¶ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œä½œä¸ºæä¾›æ›´æ–° url çš„é€”å¾„ï¼Œè§¦å‘ Link åæœ€ç»ˆå°†é€šè¿‡å¦‚ä¸Šé¢å®šä¹‰çš„è·¯ç”±è¡¨è¿›è¡ŒåŒ¹é…ï¼Œå¹¶æ‹¿åˆ°å¯¹åº”çš„ component åŠ state è¿›è¡Œ render æ¸²æŸ“é¡µé¢ã€‚</p><pre><code class="js">&lt;Link to={`/user/89757`}&gt;&#39;joey&#39;&lt;/Link&gt;</code></pre><p>è¿™é‡Œä¸ç»†è®² react-router çš„ä½¿ç”¨ï¼Œè¯¦æƒ…å¯è§ï¼š<a href="https://github.com/reactjs/react-router" target="_blank" rel="noopener">https://github.com/reactjs/react-router</a></p><h2 id="ä»ç‚¹å‡»-Link-åˆ°-render-å¯¹åº”-component-ï¼Œè·¯ç”±ä¸­å‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#ä»ç‚¹å‡»-Link-åˆ°-render-å¯¹åº”-component-ï¼Œè·¯ç”±ä¸­å‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="ä»ç‚¹å‡» Link åˆ° render å¯¹åº” component ï¼Œè·¯ç”±ä¸­å‘ç”Ÿäº†ä»€ä¹ˆ"></a>ä»ç‚¹å‡» Link åˆ° render å¯¹åº” component ï¼Œè·¯ç”±ä¸­å‘ç”Ÿäº†ä»€ä¹ˆ</h2><h3 id="ä¸ºä½•èƒ½å¤Ÿè§¦å‘-render-component-ï¼Ÿ"><a href="#ä¸ºä½•èƒ½å¤Ÿè§¦å‘-render-component-ï¼Ÿ" class="headerlink" title="ä¸ºä½•èƒ½å¤Ÿè§¦å‘ render component ï¼Ÿ"></a>ä¸ºä½•èƒ½å¤Ÿè§¦å‘ render component ï¼Ÿ</h3><p>ä¸»è¦æ˜¯å› ä¸ºè§¦å‘äº† <code>react setState</code> çš„æ–¹æ³•ä»è€Œèƒ½å¤Ÿè§¦å‘ <code>render component</code>ã€‚</p><p>ä»é¡¶å±‚ç»„ä»¶ Router å‡ºå‘ï¼ˆä¸‹é¢ä»£ç ä» <code>react-router/Router</code> ä¸­æ‘˜å–ï¼‰ï¼Œå¯çœ‹åˆ° Router åœ¨ react component ç”Ÿå‘½å‘¨æœŸä¹‹ç»„ä»¶è¢«æŒ‚è½½å‰ componentWillMount ä¸­ä½¿ç”¨ this.history.listen å»æ³¨å†Œäº† url æ›´æ–°çš„å›è°ƒå‡½æ•°ã€‚å›è°ƒå‡½æ•°å°†åœ¨ url æ›´æ–°æ—¶è§¦å‘ï¼Œå›è°ƒä¸­çš„ setState èµ·åˆ° render äº†æ–°çš„ component çš„ä½œç”¨ã€‚</p><pre><code class="js">    React.prototype.componentWillMount = function componentWillMount(){        var createHistory = this.props.history;        this.history = _useRoutes2[&#39;default&#39;](createHistory)({            routes: _RouteUtils.createRoutes(routes || children),            parseQueryString: parseQueryString,            stringifyQuery: stringifyQuery        });        this._unlisten = this.history.listen(function (error, state) {            _this.setState(state, _this.props.onUpdate);        });    }</code></pre><p>ä¸Šé¢çš„ _useRoutes2 å¯¹ history æ“ä½œä¾¿æ˜¯å¯¹å…¶åšä¸€å±‚åŒ…è£…ï¼Œæ‰€ä»¥è°ƒç”¨çš„ this.history å®é™…ä¸ºåŒ…è£…ä»¥åçš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å«æœ‰ _useRoutes2 ä¸­çš„ listen æ–¹æ³•ï¼Œå¦‚ä¸‹</p><pre><code class="js">    function listen(listener){        rerurn listen(function(location){            // .. çœç•¥å…¶ä»–          match(location, function (error, redirectLocation, nextState) {            listener(null, nextState);          });        })    }</code></pre><p>å¯çœ‹åˆ°ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†</p><ul><li><p>ä½¿ç”¨äº† history æ¨¡å—çš„ listen æ³¨å†Œäº†ä¸€ä¸ªå«æœ‰ setState çš„å›è°ƒå‡½æ•°ï¼ˆè¿™æ ·å°±èƒ½ä½¿ç”¨ history æ¨¡å—ä¸­çš„æœºåˆ¶ï¼‰</p></li><li><p>å›è°ƒä¸­çš„ match æ–¹æ³•ä¸º react-router æ‰€ç‰¹æœ‰ï¼Œmatch å‡½æ•°æ ¹æ®å½“å‰ location ä»¥åŠå‰é¢å†™çš„ Route è·¯ç”±è¡¨åŒ¹é…å‡ºå¯¹åº”çš„è·¯ç”±å­é›†å¾—åˆ°æ–°çš„è·¯ç”±çŠ¶æ€å€¼ stateï¼Œå…·ä½“å®ç°å¯è§ react-router/matchRoutes ï¼Œå†æ ¹æ® state å¾—åˆ°å¯¹åº”çš„ component ï¼Œæœ€ç»ˆæ‰§è¡Œäº† match ä¸­çš„å›è°ƒ listener(null, nextState) ï¼Œå³æ‰§è¡Œäº† Router ä¸­çš„ç›‘å¬å›è°ƒï¼ˆsetStateï¼‰ï¼Œä»è€Œæ›´æ–°äº†å±•ç¤ºã€‚</p></li></ul><p>ä»¥ä¸Šï¼Œä¸ºèµ·å§‹æ³¨å†Œçš„ç›‘å¬ï¼ŒåŠå›è°ƒçš„ä½œç”¨ã€‚</p><h3 id="å¦‚ä½•è§¦å‘ç›‘å¬çš„å›è°ƒå‡½æ•°çš„æ‰§è¡Œï¼Ÿ"><a href="#å¦‚ä½•è§¦å‘ç›‘å¬çš„å›è°ƒå‡½æ•°çš„æ‰§è¡Œï¼Ÿ" class="headerlink" title="å¦‚ä½•è§¦å‘ç›‘å¬çš„å›è°ƒå‡½æ•°çš„æ‰§è¡Œï¼Ÿ"></a>å¦‚ä½•è§¦å‘ç›‘å¬çš„å›è°ƒå‡½æ•°çš„æ‰§è¡Œï¼Ÿ</h3><p>è¿™é‡Œè¿˜å¾—ä»å¦‚ä½•æ›´æ–° url è¯´èµ·ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œurl æ›´æ–°ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šç®€å•çš„ hash æ›´æ–°æˆ–ä½¿ç”¨ history api è¿›è¡Œåœ°å€æ›´æ–°ã€‚</p><p>åœ¨ react-router ä¸­ï¼Œå…¶æä¾›äº† Link ç»„ä»¶ï¼Œè¯¥ç»„ä»¶èƒ½åœ¨ render ä¸­ä½¿ç”¨ï¼Œæœ€ç»ˆä¼šè¡¨ç°ä¸º a æ ‡ç­¾ï¼Œå¹¶å°† Link ä¸­çš„å„ä¸ªå‚æ•°ç»„åˆæ”¾å®ƒçš„ href å±æ€§ä¸­ã€‚å¯ä»¥ä» react-router/ Link ä¸­çœ‹åˆ°ï¼Œå¯¹è¯¥ç»„ä»¶çš„ç‚¹å‡»äº‹ä»¶è¿›è¡Œäº†é˜»æ­¢äº†æµè§ˆå™¨çš„é»˜è®¤è·³è½¬è¡Œä¸ºï¼Œè€Œæ”¹ç”¨ history æ¨¡å—çš„ <code>pushState</code> æ–¹æ³•å»è§¦å‘ url æ›´æ–°ã€‚</p><pre><code class="js">Link.prototype.render = function render() {    // .. çœç•¥å…¶ä»–    props.onClick = function (e) {      return _this.handleClick(e);    };    if (history) {     // .. çœç•¥å…¶ä»–      props.href = history.createHref(to, query);    }    return _react2[&#39;default&#39;].createElement(&#39;a&#39;, props);};Link.prototype.handleClick = function handleClick(event) {    // .. çœç•¥å…¶ä»–    event.preventDefault();    this.context.history.pushState(this.props.state, this.props.to, this.props.query);};</code></pre><p>å¯¹ history æ¨¡å—çš„ pushState æ–¹æ³•å¯¹ url çš„æ›´æ–°å½¢å¼ï¼ŒåŒæ ·åˆ†ä¸ºä¸¤ç§ï¼Œ<br>åˆ†åˆ«åœ¨ <code>history/createBrowserHistory</code> åŠ <code>history/createHashHistory</code> å„è‡ªçš„ <code>finishTransition</code> ä¸­ï¼Œå¦‚ <code>history/createBrowserHistory</code> ä¸­ä½¿ç”¨çš„æ˜¯ <code>window.history.replaceState(historyState, null, path)</code>;<br>è€Œ <code>history/createHashHistory</code> åˆ™ä½¿ç”¨ <code>window.location.hash = url</code>ï¼Œ<br>è°ƒç”¨å“ªä¸ªæ˜¯æ ¹æ®æˆ‘ä»¬ä¸€å¼€å§‹åˆ›å»º history çš„æ–¹å¼ã€‚</p><p>æ›´æ–° url çš„æ˜¾ç¤ºæ˜¯ä¸€éƒ¨åˆ†ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æ ¹æ® url å»æ›´æ–°å±•ç¤ºï¼Œä¹Ÿå°±æ˜¯è§¦å‘å‰é¢çš„ç›‘å¬ã€‚è¿™æ˜¯åœ¨å‰é¢ <code>finishTransition</code> æ›´æ–° url ä¹‹åå®ç°çš„ï¼Œè°ƒç”¨çš„æ˜¯ <code>history/createHistory</code> ä¸­çš„ <code>updateLocation</code> æ–¹æ³•ï¼Œ<code>changeListeners</code> ä¸­ä¸º <code>history/createHistory</code> ä¸­çš„ listen ä¸­æ‰€æ·»åŠ çš„ï¼Œå¦‚ä¸‹</p><pre><code class="js">function updateLocation(newLocation) {   // ç¤ºæ„ä»£ç     location = newLocation;    changeListeners.forEach(function (listener) {      listener(location);    });}function listen(listener) {     // ç¤ºæ„ä»£ç     changeListeners.push(listener);}</code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><blockquote><p>å¯ä»¥å°†ä»¥ä¸Š react-router çš„æ•´ä¸ªåŒ…è£…é—­ç¯æ€»ç»“ä¸º</p></blockquote><ul><li><p>å›è°ƒå‡½æ•°ï¼šå«æœ‰èƒ½å¤Ÿæ›´æ–° react UI çš„ react setState æ–¹æ³•ã€‚</p></li><li><p>æ³¨å†Œå›è°ƒï¼šåœ¨ Router componentWillMount ä¸­ä½¿ç”¨ history.listen æ³¨å†Œçš„å›è°ƒå‡½æ•°ï¼Œæœ€ç»ˆæ”¾åœ¨ history æ¨¡å—çš„ å›è°ƒå‡½æ•°æ•°ç»„ changeListeners ä¸­ã€‚</p></li><li><p>è§¦å‘å›è°ƒï¼šLink ç‚¹å‡»è§¦å‘ history ä¸­å›è°ƒå‡½æ•°æ•°ç»„ changeListeners çš„æ‰§è¡Œï¼Œä»è€Œè§¦å‘åŸæ¥ listen ä¸­çš„ setState æ–¹æ³•ï¼Œæ›´æ–°äº†é¡µé¢</p></li></ul><p>è‡³äºå‰è¿›ä¸åé€€çš„å®ç°ï¼Œæ˜¯é€šè¿‡ç›‘å¬ popstate ä»¥åŠ hashchange çš„äº‹ä»¶ï¼Œå½“å‰è¿›æˆ–åé€€ url æ›´æ–°æ—¶ï¼Œè§¦å‘è¿™ä¸¤ä¸ªäº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œå›è°ƒçš„æ‰§è¡Œæ–¹å¼ Link å¤§è‡´ç›¸åŒï¼Œæœ€ç»ˆåŒæ ·æ›´æ–°äº† UI ï¼Œè¿™é‡Œå°±ä¸å†è¯´æ˜ã€‚</p><p>react-router ä¸»è¦æ˜¯åˆ©ç”¨åº•å±‚ history æ¨¡å—çš„æœºåˆ¶ï¼Œé€šè¿‡ç»“åˆ react çš„æ¶æ„æœºåˆ¶åšä¸€å±‚åŒ…è£…ï¼Œå®é™…è‡ªèº«çš„å†…å®¹å¹¶ä¸å¤šï¼Œä½†å…¶åŒ…è£…çš„æ€æƒ³ç¬”è€…è®¤ä¸ºå¾ˆå€¼å¾—å­¦ä¹ ï¼Œæœ‰å…´è¶£çš„å»ºè®®é˜…è¯»ä¸‹æºç ï¼Œç›¸ä¿¡ä¼šæœ‰å…¶ä»–æ”¶è·ã€‚</p><p><a href="https://github.com/joeyguo/blog/issues/2" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React-router </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React-router </tag>
            
            <tag> è·¯ç”± </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç§»åŠ¨ç«¯å¸¸è§Bugæ±‡æ€»</title>
      <link href="/2018/06/08/Mobile/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%B8%B8%E8%A7%81Bug%E6%B1%87%E6%80%BB/"/>
      <url>/2018/06/08/Mobile/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%B8%B8%E8%A7%81Bug%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ–‡æ˜¯æ‘˜å½•æ•´ç†äº†ç§»åŠ¨ç«¯å¸¸è§çš„ä¸€äº›bugä»¥åŠè§£å†³æ–¹æ¡ˆ</p><h2 id="ç‚¹å‡»æ ·å¼é—ªçƒ"><a href="#ç‚¹å‡»æ ·å¼é—ªçƒ" class="headerlink" title="ç‚¹å‡»æ ·å¼é—ªçƒ"></a>ç‚¹å‡»æ ·å¼é—ªçƒ</h2><p>Q: å½“ä½ ç‚¹å‡»ä¸€ä¸ªé“¾æ¥æˆ–è€…é€šè¿‡Javascriptå®šä¹‰çš„å¯ç‚¹å‡»å…ƒç´ çš„æ—¶å€™ï¼Œå®ƒå°±ä¼šå‡ºç°ä¸€ä¸ªåŠé€æ˜çš„ç°è‰²èƒŒæ™¯ã€‚</p><p>A:æ ¹æœ¬åŸå› æ˜¯-webkit-tap-highlight-colorï¼Œè¿™ä¸ªå±æ€§æ˜¯ç”¨äºè®¾å®šå…ƒç´ åœ¨ç§»åŠ¨è®¾å¤‡ï¼ˆå¦‚Adnroidã€iOSï¼‰ä¸Šè¢«è§¦å‘ç‚¹å‡»äº‹ä»¶æ—¶ï¼Œå“åº”çš„èƒŒæ™¯æ¡†çš„é¢œè‰²ã€‚å»ºè®®å†™åœ¨æ ·å¼åˆå§‹åŒ–ä¸­ä»¥é¿å…æ‰€ä»¥é—®é¢˜ï¼šdiv,input(selector) {-webkit-tap-highlight-color: rgba(0,0,0,0);}å¦å¤–å‡ºç°è“è‰²è¾¹æ¡†ï¼šoutline:noneï¼›</p><pre><code class="js">-webkit-tap-highlight-color : rgba (255, 255, 255, 0) ;// i.e . Nexus5/Chrome and Kindle Fire HD 7 &#39;&#39;-webkit-tap-highlight-color : transparent ;  </code></pre><h2 id="å±è”½ç”¨æˆ·é€‰æ‹©"><a href="#å±è”½ç”¨æˆ·é€‰æ‹©" class="headerlink" title="å±è”½ç”¨æˆ·é€‰æ‹©"></a>å±è”½ç”¨æˆ·é€‰æ‹©</h2><p>Q: ç¦æ­¢ç”¨æˆ·é€‰æ‹©é¡µé¢ä¸­çš„æ–‡å­—æˆ–è€…å›¾ç‰‡</p><p>A:ä»£ç å¦‚ä¸‹</p><pre><code class="css">-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;</code></pre><h2 id="ç§»åŠ¨ç«¯å¦‚ä½•æ¸…é™¤è¾“å…¥æ¡†å†…é˜´å½±"><a href="#ç§»åŠ¨ç«¯å¦‚ä½•æ¸…é™¤è¾“å…¥æ¡†å†…é˜´å½±" class="headerlink" title="ç§»åŠ¨ç«¯å¦‚ä½•æ¸…é™¤è¾“å…¥æ¡†å†…é˜´å½±"></a>ç§»åŠ¨ç«¯å¦‚ä½•æ¸…é™¤è¾“å…¥æ¡†å†…é˜´å½±</h2><p>Q: åœ¨iOSä¸Šï¼Œè¾“å…¥æ¡†é»˜è®¤æœ‰å†…éƒ¨é˜´å½±ï¼Œä½†æ— æ³•ä½¿ç”¨ box-shadow æ¥æ¸…é™¤ï¼Œå¦‚æœä¸éœ€è¦é˜´å½±ï¼Œå¯ä»¥è¿™æ ·å…³é—­ï¼š</p><p>A:ä»£ç å¦‚ä¸‹</p><pre><code class="css">-webkit-appearance: none;</code></pre><h2 id="ç¦æ­¢æ–‡æœ¬ç¼©æ”¾"><a href="#ç¦æ­¢æ–‡æœ¬ç¼©æ”¾" class="headerlink" title="ç¦æ­¢æ–‡æœ¬ç¼©æ”¾"></a>ç¦æ­¢æ–‡æœ¬ç¼©æ”¾</h2><p>Q: ç¦æ­¢æ–‡æœ¬ç¼©æ”¾</p><p>A:ä»£ç å¦‚ä¸‹</p><pre><code class="css">-webkit-text-size-adjust: 100%;</code></pre><a id="more"></a><h2 id="å¦‚ä½•ç¦æ­¢ä¿å­˜æˆ–æ‹·è´å›¾åƒ"><a href="#å¦‚ä½•ç¦æ­¢ä¿å­˜æˆ–æ‹·è´å›¾åƒ" class="headerlink" title="å¦‚ä½•ç¦æ­¢ä¿å­˜æˆ–æ‹·è´å›¾åƒ"></a>å¦‚ä½•ç¦æ­¢ä¿å­˜æˆ–æ‹·è´å›¾åƒ</h2><p>Q: å¦‚ä½•ç¦æ­¢ä¿å­˜æˆ–æ‹·è´å›¾åƒ</p><p>A:ä»£ç å¦‚ä¸‹</p><pre><code class="css">img{-webkit-touch-callout: none;}</code></pre><h2 id="è§£å†³å­—ä½“åœ¨ç§»åŠ¨ç«¯æ¯”ä¾‹ç¼©å°åå‡ºç°é”¯é½¿çš„é—®é¢˜"><a href="#è§£å†³å­—ä½“åœ¨ç§»åŠ¨ç«¯æ¯”ä¾‹ç¼©å°åå‡ºç°é”¯é½¿çš„é—®é¢˜" class="headerlink" title="è§£å†³å­—ä½“åœ¨ç§»åŠ¨ç«¯æ¯”ä¾‹ç¼©å°åå‡ºç°é”¯é½¿çš„é—®é¢˜"></a>è§£å†³å­—ä½“åœ¨ç§»åŠ¨ç«¯æ¯”ä¾‹ç¼©å°åå‡ºç°é”¯é½¿çš„é—®é¢˜</h2><p>Q: è§£å†³å­—ä½“åœ¨ç§»åŠ¨ç«¯æ¯”ä¾‹ç¼©å°åå‡ºç°é”¯é½¿çš„é—®é¢˜</p><p>A:ä»£ç å¦‚ä¸‹</p><pre><code class="css">-webkit-font-smoothing: antialiased;</code></pre><h2 id="è®¾ç½®inputé‡Œé¢placeholderå­—ä½“çš„å¤§å°"><a href="#è®¾ç½®inputé‡Œé¢placeholderå­—ä½“çš„å¤§å°" class="headerlink" title="è®¾ç½®inputé‡Œé¢placeholderå­—ä½“çš„å¤§å°"></a>è®¾ç½®inputé‡Œé¢placeholderå­—ä½“çš„å¤§å°</h2><p>Q: è®¾ç½®inputé‡Œé¢placeholderå­—ä½“çš„å¤§å°</p><p>A:ä»£ç å¦‚ä¸‹</p><pre><code class="css">::-webkit-input-placeholder{ font-size:10pt;}</code></pre><h2 id="audioå…ƒç´ å’Œvideoå…ƒç´ åœ¨ioså’Œandriodä¸­æ— æ³•è‡ªåŠ¨æ’­æ”¾"><a href="#audioå…ƒç´ å’Œvideoå…ƒç´ åœ¨ioså’Œandriodä¸­æ— æ³•è‡ªåŠ¨æ’­æ”¾" class="headerlink" title="audioå…ƒç´ å’Œvideoå…ƒç´ åœ¨ioså’Œandriodä¸­æ— æ³•è‡ªåŠ¨æ’­æ”¾"></a>audioå…ƒç´ å’Œvideoå…ƒç´ åœ¨ioså’Œandriodä¸­æ— æ³•è‡ªåŠ¨æ’­æ”¾</h2><p>Q: audioå…ƒç´ å’Œvideoå…ƒç´ åœ¨ioså’Œandriodä¸­æ— æ³•è‡ªåŠ¨æ’­æ”¾</p><p>A:ä»£ç å¦‚ä¸‹,è§¦å±åŠæ’­æ”¾</p><pre><code class="js">$(&#39;html&#39;).on(&#39;touchstart&#39;,function(){audio.play()})</code></pre><h2 id="æ‰‹æœºæ‹ç…§å’Œä¸Šä¼ å›¾ç‰‡"><a href="#æ‰‹æœºæ‹ç…§å’Œä¸Šä¼ å›¾ç‰‡" class="headerlink" title="æ‰‹æœºæ‹ç…§å’Œä¸Šä¼ å›¾ç‰‡"></a>æ‰‹æœºæ‹ç…§å’Œä¸Šä¼ å›¾ç‰‡</h2><p>Q: é’ˆå¯¹fileç±»å‹å¢åŠ ä¸åŒçš„acceptå­—æ®µ</p><p>A:ä»£ç å¦‚ä¸‹</p><pre><code class="html">&lt;input type=&quot;file&quot;&gt;çš„accept å±æ€§&lt;!-- é€‰æ‹©ç…§ç‰‡ --&gt;&lt;input type=file accept=&quot;image/*&quot;&gt;&lt;!-- é€‰æ‹©è§†é¢‘ --&gt;&lt;input type=file accept=&quot;video/*&quot;&gt;</code></pre><h2 id="è¾“å…¥æ¡†è‡ªåŠ¨å¡«å……é¢œè‰²"><a href="#è¾“å…¥æ¡†è‡ªåŠ¨å¡«å……é¢œè‰²" class="headerlink" title="è¾“å…¥æ¡†è‡ªåŠ¨å¡«å……é¢œè‰²"></a>è¾“å…¥æ¡†è‡ªåŠ¨å¡«å……é¢œè‰²</h2><p>Q: é’ˆå¯¹inputæ ‡ç­¾å·²ç»è¾“å…¥è¿‡çš„ï¼Œä¼šé’ˆå¯¹æ›¾ç»è¾“å…¥çš„å†…å®¹å¡«å……é»„è‰²èƒŒæ™¯ï¼Œè¿™æ˜¯webkitå†…æ ¸è‡ªåŠ¨æ·»åŠ çš„ï¼Œå¯¹åº”çš„å±æ€§æ˜¯autocomplete,é»˜è®¤æ˜¯on,å¦å¯¹åº”çš„æ ·å¼æ˜¯input:-webkit-autofill ä¸”æ˜¯ä¸å¯æ›´æ”¹çš„ã€‚</p><p>A:æ–¹æ¡ˆå¦‚ä¸‹ 1 è®¾ç½®æ ‡ç­¾çš„autocomplete=â€offâ€,äº²æµ‹æ— æ•ˆå¯èƒ½ 2 è®¾ç½®ç›’å­çš„å†…é˜´å½±ä¸ºä½ å¸¸æ€çš„é¢œè‰²ï¼ˆä¸‹é¢ä»¥ç™½è‰²ä¸ºä¾‹ï¼‰</p><pre><code class="css"> box-shadow:0 0  0 1000px  #fff inset ; -webkit-box-shadow: 0 0 0px 1000px #fff inset;</code></pre><h2 id="å¼€å¯ç¡¬ä»¶åŠ é€Ÿ"><a href="#å¼€å¯ç¡¬ä»¶åŠ é€Ÿ" class="headerlink" title="å¼€å¯ç¡¬ä»¶åŠ é€Ÿ"></a>å¼€å¯ç¡¬ä»¶åŠ é€Ÿ</h2><p>Q: ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½</p><p>A:ä»£ç å¦‚ä¸‹</p><pre><code class="css">-webkit-transform: translate3d(0, 0, 0);-moz-transform: translate3d(0, 0, 0);-ms-transform: translate3d(0, 0, 0);transform: translate3d(0, 0, 0);</code></pre><h2 id="ç”¨æˆ·è®¾ç½®å­—å·æ”¾å¤§æˆ–è€…ç¼©å°å¯¼è‡´é¡µé¢å¸ƒå±€é”™è¯¯"><a href="#ç”¨æˆ·è®¾ç½®å­—å·æ”¾å¤§æˆ–è€…ç¼©å°å¯¼è‡´é¡µé¢å¸ƒå±€é”™è¯¯" class="headerlink" title="ç”¨æˆ·è®¾ç½®å­—å·æ”¾å¤§æˆ–è€…ç¼©å°å¯¼è‡´é¡µé¢å¸ƒå±€é”™è¯¯"></a>ç”¨æˆ·è®¾ç½®å­—å·æ”¾å¤§æˆ–è€…ç¼©å°å¯¼è‡´é¡µé¢å¸ƒå±€é”™è¯¯</h2><pre><code class="css">body      {          -webkit-text-size-adjust: 100% !important;          text-size-adjust: 100% !important;          -moz-text-size-adjust: 100% !important;      }</code></pre><h2 id="ç§»åŠ¨ç«¯å»é™¤typeä¸ºnumberçš„ç®­å¤´"><a href="#ç§»åŠ¨ç«¯å»é™¤typeä¸ºnumberçš„ç®­å¤´" class="headerlink" title="ç§»åŠ¨ç«¯å»é™¤typeä¸ºnumberçš„ç®­å¤´"></a>ç§»åŠ¨ç«¯å»é™¤typeä¸ºnumberçš„ç®­å¤´</h2><pre><code class="css"> input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{      -webkit-appearance: none !important;      margin: 0;  }</code></pre><h2 id="å®ç°æ¨ªå±ç«–å±çš„æ–¹æ¡ˆ"><a href="#å®ç°æ¨ªå±ç«–å±çš„æ–¹æ¡ˆ" class="headerlink" title="å®ç°æ¨ªå±ç«–å±çš„æ–¹æ¡ˆ"></a>å®ç°æ¨ªå±ç«–å±çš„æ–¹æ¡ˆ</h2><h3 id="css-ç”¨-css3åª’ä½“æŸ¥è¯¢ï¼Œç¼ºç‚¹æ˜¯å®½åº¦å’Œé«˜åº¦ä¸å¥½æ§åˆ¶"><a href="#css-ç”¨-css3åª’ä½“æŸ¥è¯¢ï¼Œç¼ºç‚¹æ˜¯å®½åº¦å’Œé«˜åº¦ä¸å¥½æ§åˆ¶" class="headerlink" title="css ç”¨ css3åª’ä½“æŸ¥è¯¢ï¼Œç¼ºç‚¹æ˜¯å®½åº¦å’Œé«˜åº¦ä¸å¥½æ§åˆ¶"></a>css ç”¨ css3åª’ä½“æŸ¥è¯¢ï¼Œç¼ºç‚¹æ˜¯å®½åº¦å’Œé«˜åº¦ä¸å¥½æ§åˆ¶</h3><pre><code class="css">@media screen and (orientation: portrait) {    .main {        -webkit-transform:rotate(-90deg);        -moz-transform: rotate(-90deg);        -ms-transform: rotate(-90deg);        transform: rotate(-90deg);        width: 100vh;        height: 100vh;        /*å»æ‰overflow å¾®ä¿¡æ˜¾ç¤ºæ­£å¸¸ï¼Œä½†æ˜¯æµè§ˆå™¨æœ‰é—®é¢˜ï¼Œç«–å±æ—¶å¼ºåˆ¶æ¨ªå±ç¼©å°*/        overflow: hidden;    }}@media screen and (orientation: landscape) {    .main {        -webkit-transform:rotate(0);        -moz-transform: rotate(0);        -ms-transform: rotate(0);        transform: rotate(0)    }}</code></pre><h3 id="js-åˆ¤æ–­å±å¹•çš„æ–¹å‘æˆ–è€…resizeäº‹ä»¶"><a href="#js-åˆ¤æ–­å±å¹•çš„æ–¹å‘æˆ–è€…resizeäº‹ä»¶" class="headerlink" title="js åˆ¤æ–­å±å¹•çš„æ–¹å‘æˆ–è€…resizeäº‹ä»¶"></a>js åˆ¤æ–­å±å¹•çš„æ–¹å‘æˆ–è€…resizeäº‹ä»¶</h3><pre><code class="js">var evt = &quot;onorientationchange&quot; in window ? &quot;orientationchange&quot; : &quot;resize&quot;;    window.addEventListener(evt, function() {        var width = document.documentElement.clientWidth;         var height =  document.documentElement.clientHeight;          $print =  $(&#39;#print&#39;);         if( width &gt; height ){            $print.width(width);            $print.height(height);            $print.css(&#39;top&#39;,  0 );            $print.css(&#39;left&#39;,  0 );            $print.css(&#39;transform&#39; , &#39;none&#39;);            $print.css(&#39;transform-origin&#39; , &#39;50% 50%&#39;);         }         else{            $print.width(height);            $print.height(width);            $print.css(&#39;top&#39;,  (height-width)/2 );            $print.css(&#39;left&#39;,  0-(height-width)/2 );            $print.css(&#39;transform&#39; , &#39;rotate(90deg)&#39;);            $print.css(&#39;transform-origin&#39; , &#39;50% 50%&#39;);         }    }, false);</code></pre><p><a href="https://juejin.im/post/5af918636fb9a07ac5603ecb" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Bug </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mobile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•™ç§‘ä¹¦å¼çš„æ­£åˆ™åŒ¹é…</title>
      <link href="/2018/06/03/study/%E6%95%99%E7%A7%91%E4%B9%A6%E5%BC%8F%E7%9A%84%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D/"/>
      <url>/2018/06/03/study/%E6%95%99%E7%A7%91%E4%B9%A6%E5%BC%8F%E7%9A%84%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><img src="https://user-gold-cdn.xitu.io/2018/5/31/163b417d183f6d30?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="regexp"></p><blockquote><p>æ­£åˆ™åœ¨jsä¸­æ˜¯ä¸€ç±»æ¯”è¾ƒç‰¹æ®Šçš„å¯¹è±¡ï¼Œå®ƒ<strong>å¯ä»¥åŒ¹é…å„ä¸ªåœºæ™¯éœ€è¦çš„æ ¼å¼éªŒè¯ï¼Œä¾‹å¦‚é‚®ç®±ã€æ‰‹æœºå·ã€ç”¨æˆ·ç™»å½•åã€å¯†ç ç­‰ç­‰</strong>ï¼Œä¼¼ä¹æ— å¤„ä¸åœ¨ï¼Œåœ¨å¸¸è§çš„å­—ç¬¦ä¸²æ£€ç´¢æˆ–æ›¿æ¢ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸€ç§æ¨¡å¼è¡¨ç¤ºæ£€ç´¢æˆ–æ›¿æ¢çš„è§„åˆ™ï¼Œæ¥åŒ¹é…ä¸€ç³»åˆ—ç¬¦åˆæŸä¸ªå¥æ³•è§„åˆ™çš„å­—ç¬¦ä¸²ã€‚</p></blockquote><p>ä»¥ä¸‹æ˜¯æ­£åˆ™çš„è¾ƒä¸ºå®˜æ–¹çš„è§£é‡Šï¼š</p><blockquote><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯ç”¨äºåŒ¹é…å­—ç¬¦ä¸²ä¸­å­—ç¬¦ç»„åˆçš„æ¨¡å¼ã€‚åœ¨ JavaScriptä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯¹è±¡ã€‚è¿™äº›æ¨¡å¼è¢«ç”¨äº RegExp çš„ <code>exec</code> å’Œ <code>test</code> æ–¹æ³•, ä»¥åŠ <code>String</code> çš„ <code>match</code>ã€<code>replace</code>ã€<code>search</code> å’Œ <code>split</code> æ–¹æ³•ã€‚</p></blockquote><h2 id="åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼ˆä»¥ä¸‹æœ‰ä¸¤ç§æ–¹å¼æ¥å‚è€ƒï¼‰ï¼š"><a href="#åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼ˆä»¥ä¸‹æœ‰ä¸¤ç§æ–¹å¼æ¥å‚è€ƒï¼‰ï¼š" class="headerlink" title="åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼ˆä»¥ä¸‹æœ‰ä¸¤ç§æ–¹å¼æ¥å‚è€ƒï¼‰ï¼š"></a>åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼ˆä»¥ä¸‹æœ‰ä¸¤ç§æ–¹å¼æ¥å‚è€ƒï¼‰ï¼š</h2><h3 id="ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æ„é€ å‡½æ•°ï¼ˆnew-çš„æ–¹å¼æ¥åˆ›å»º"><a href="#ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æ„é€ å‡½æ•°ï¼ˆnew-çš„æ–¹å¼æ¥åˆ›å»º" class="headerlink" title="ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æ„é€ å‡½æ•°ï¼ˆnew çš„æ–¹å¼æ¥åˆ›å»º)"></a>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æ„é€ å‡½æ•°ï¼ˆnew çš„æ–¹å¼æ¥åˆ›å»º)</h3><pre><code class="js">let regex = new RegExp(&quot;a&quot;)let regex = new RegExp(&quot;^[a-zA-Z]&quot;,&#39;g&#39;) ;    //å½“ä½¿ç”¨å¼•å·æ—¶ä¸å¿…å†åŠ åæ–œæ â€™ï¼â€™let regex = new RegExp(/^[a-zA-Z]/,&#39;gi&#39;);      //å½“æœ‰æ–œæ æ—¶å°± ä¸ç”¨å†åŠ å¼•å·</code></pre><a id="more"></a><h3 id="åˆ›å»ºå­—é¢é‡ï¼ˆç”±ä¸¤ä¸ªæ–œæ â€™ï¼ï¼â€™åŒ…è£¹éœ€è¦åŒ¹é…çš„å†…å®¹"><a href="#åˆ›å»ºå­—é¢é‡ï¼ˆç”±ä¸¤ä¸ªæ–œæ â€™ï¼ï¼â€™åŒ…è£¹éœ€è¦åŒ¹é…çš„å†…å®¹" class="headerlink" title="åˆ›å»ºå­—é¢é‡ï¼ˆç”±ä¸¤ä¸ªæ–œæ â€™ï¼ï¼â€™åŒ…è£¹éœ€è¦åŒ¹é…çš„å†…å®¹)"></a>åˆ›å»ºå­—é¢é‡ï¼ˆç”±ä¸¤ä¸ªæ–œæ â€™ï¼ï¼â€™åŒ…è£¹éœ€è¦åŒ¹é…çš„å†…å®¹)</h3><pre><code class="js">let regex = /ab/ ;let regex=/^[a-zA-Z]/ ;</code></pre><p><font color ="red">è¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥æ¥åˆ›å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä½†æ˜¯ç›¸å¯¹æ¥è¯´ç¬¬äºŒç§æ–¹å¼æ›´åŠ å¸¸ç”¨ä¸€äº›</font>ã€‚</p><h2 id="æ­£åˆ™è¡¨è¾¾å¼çš„å‚æ•°ï¼Œå†™åœ¨-åé¢ï¼Œå¯æ··åˆä½¿ç”¨"><a href="#æ­£åˆ™è¡¨è¾¾å¼çš„å‚æ•°ï¼Œå†™åœ¨-åé¢ï¼Œå¯æ··åˆä½¿ç”¨" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼çš„å‚æ•°ï¼Œå†™åœ¨//åé¢ï¼Œå¯æ··åˆä½¿ç”¨"></a>æ­£åˆ™è¡¨è¾¾å¼çš„å‚æ•°ï¼Œå†™åœ¨//åé¢ï¼Œå¯æ··åˆä½¿ç”¨</h2><ul><li>g   å…¨å±€åŒ¹é…;æ‰¾åˆ°æ‰€æœ‰åŒ¹é…ï¼Œè€Œä¸æ˜¯åœ¨ç¬¬ä¸€ä¸ªåŒ¹é…ååœæ­¢</li><li>i    åŒ¹é…å…¨éƒ¨å¤§å°å†™</li><li>m    å¤šè¡Œ; å°†å¼€å§‹å’Œç»“æŸå­—ç¬¦ï¼ˆ^å’Œ$ï¼‰è§†ä¸ºåœ¨å¤šè¡Œä¸Šå·¥ä½œï¼ˆä¹Ÿå°±æ˜¯ï¼Œåˆ†åˆ«åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å§‹å’Œç»“æŸï¼ˆç”± \n æˆ– \r åˆ†å‰²ï¼‰ï¼Œè€Œä¸åªæ˜¯åªåŒ¹é…æ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸²çš„æœ€å¼€å§‹å’Œæœ€æœ«å°¾å¤„ã€‚</li><li>s   ä¸mç›¸åï¼Œå•è¡ŒåŒ¹é…</li></ul><blockquote><p>let regex=/^[a-zA-Z]/gim ;</p></blockquote><h2 id="æ­£åˆ™ä¸­å¸¸ç”¨æ–¹æ³•ä»¥åŠå­—ç¬¦ä¸²ä¸­ä¸æ­£åˆ™ç›¸å…³çš„æ–¹æ³•"><a href="#æ­£åˆ™ä¸­å¸¸ç”¨æ–¹æ³•ä»¥åŠå­—ç¬¦ä¸²ä¸­ä¸æ­£åˆ™ç›¸å…³çš„æ–¹æ³•" class="headerlink" title="æ­£åˆ™ä¸­å¸¸ç”¨æ–¹æ³•ä»¥åŠå­—ç¬¦ä¸²ä¸­ä¸æ­£åˆ™ç›¸å…³çš„æ–¹æ³•"></a>æ­£åˆ™ä¸­å¸¸ç”¨æ–¹æ³•ä»¥åŠå­—ç¬¦ä¸²ä¸­ä¸æ­£åˆ™ç›¸å…³çš„æ–¹æ³•</h2><h3 id="test-æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„å€¼æ˜¯å¦åŒ¹é…ç»™å‡ºçš„æ­£åˆ™è§„åˆ™-è¿”å›å¸ƒå°”å€¼-trueæˆ–falseã€‚"><a href="#test-æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„å€¼æ˜¯å¦åŒ¹é…ç»™å‡ºçš„æ­£åˆ™è§„åˆ™-è¿”å›å¸ƒå°”å€¼-trueæˆ–falseã€‚" class="headerlink" title="test()æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„å€¼æ˜¯å¦åŒ¹é…ç»™å‡ºçš„æ­£åˆ™è§„åˆ™,è¿”å›å¸ƒå°”å€¼ trueæˆ–falseã€‚"></a>test()æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„å€¼æ˜¯å¦åŒ¹é…ç»™å‡ºçš„æ­£åˆ™è§„åˆ™,è¿”å›å¸ƒå°”å€¼ trueæˆ–falseã€‚</h3><p>æ£€ç´¢â€abâ€æ˜¯å¦åŒ¹é…å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼ /../ï¼Œæ­£ç¡®è¿”å›trueï¼Œä¸åŒ¹é…è¿”å›false</p><pre><code class="js">/../.test(&quot;ab&quot;);        // true</code></pre><h3 id="exec-æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå€¼ï¼Œå¦‚æœæ‰¾åˆ°åŒ¹é…çš„æ–‡æœ¬ï¼Œåˆ™è¿”å›ä¸€ä¸ªç»“æœçš„æ•°ç»„ï¼Œåä¹‹è¿”å›null"><a href="#exec-æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå€¼ï¼Œå¦‚æœæ‰¾åˆ°åŒ¹é…çš„æ–‡æœ¬ï¼Œåˆ™è¿”å›ä¸€ä¸ªç»“æœçš„æ•°ç»„ï¼Œåä¹‹è¿”å›null" class="headerlink" title="exec()æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå€¼ï¼Œå¦‚æœæ‰¾åˆ°åŒ¹é…çš„æ–‡æœ¬ï¼Œåˆ™è¿”å›ä¸€ä¸ªç»“æœçš„æ•°ç»„ï¼Œåä¹‹è¿”å›null"></a>exec()æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå€¼ï¼Œå¦‚æœæ‰¾åˆ°åŒ¹é…çš„æ–‡æœ¬ï¼Œåˆ™è¿”å›ä¸€ä¸ªç»“æœçš„æ•°ç»„ï¼Œåä¹‹è¿”å›null</h3><p>æ£€ç´¢æ­£åˆ™è¡¨è¾¾å¼/abc/æ˜¯å¦æœ‰åœ¨å­—ç¬¦ä¸²ä¸­defaabcæœ‰åŒ¹é…åˆ°ï¼Œè¿”å›åŒ¹é…åˆ°å†…å®¹ï¼Œç´¢å¼•å€¼ï¼Œä»¥åŠæ£€ç´¢çš„å­—ç¬¦ä¸²</p><pre><code class="js">/abc/.exec(&quot;defaabc&quot;)       //  [&quot;abc&quot;, index: 4, input: &quot;defaabc&quot;]// æ£€ç´¢/qqq/æ˜¯å¦åœ¨abcdefaabcä¸­åŒ¹é…åˆ°ï¼Œè¿”å› null/qqq/.exec(&quot;abcdefaabc&quot;)     // null</code></pre><h3 id="compile-æ–¹æ³•ç”¨äºæ”¹å˜æ­£åˆ™åŒ¹é…å†…å®¹"><a href="#compile-æ–¹æ³•ç”¨äºæ”¹å˜æ­£åˆ™åŒ¹é…å†…å®¹" class="headerlink" title="compile()æ–¹æ³•ç”¨äºæ”¹å˜æ­£åˆ™åŒ¹é…å†…å®¹"></a>compile()æ–¹æ³•ç”¨äºæ”¹å˜æ­£åˆ™åŒ¹é…å†…å®¹</h3><p>å°†/abc/çš„åŒ¹é…å†…å®¹æ”¹æˆåé¢çš„å­—ç¬¦ä¸²çš„å†…å®¹</p><pre><code class="js">/abc/.compile(&#39;defâ€™)    //  /def/</code></pre><h3 id="split-å°†å­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„"><a href="#split-å°†å­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„" class="headerlink" title="split()å°†å­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„"></a>split()å°†å­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„</h3><p>å°†å­—ç¬¦ä¸²abcdä»¥/b/ä¸­çš„båˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„</p><pre><code class="js">&quot;abcd&quot;.split(/b/);       // [&quot;a&quot;, &quot;cd&quot;]</code></pre><h3 id="replace-æ–¹æ³•ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­ç”¨ä¸€äº›å­—ç¬¦æ›¿æ¢å¦ä¸€äº›å­—ç¬¦æˆ–è€…æ›¿æ¢ä¸€ä¸ªä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­—ç¬¦ä¸²"><a href="#replace-æ–¹æ³•ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­ç”¨ä¸€äº›å­—ç¬¦æ›¿æ¢å¦ä¸€äº›å­—ç¬¦æˆ–è€…æ›¿æ¢ä¸€ä¸ªä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­—ç¬¦ä¸²" class="headerlink" title="replace()æ–¹æ³•ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­ç”¨ä¸€äº›å­—ç¬¦æ›¿æ¢å¦ä¸€äº›å­—ç¬¦æˆ–è€…æ›¿æ¢ä¸€ä¸ªä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­—ç¬¦ä¸²"></a>replace()æ–¹æ³•ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­ç”¨ä¸€äº›å­—ç¬¦æ›¿æ¢å¦ä¸€äº›å­—ç¬¦æˆ–è€…æ›¿æ¢ä¸€ä¸ªä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­—ç¬¦ä¸²</h3><pre><code class="js">//ç”¨æ­£åˆ™å†…å®¹/\d\d\d/å»åŒ¹é…å­—ç¬¦ä¸²12345abcdeï¼Œå°†åŒ¹é…çš„å†…å®¹æ›¿æ¢æˆ*ï¼Œå¹¶è¿”å›æ›¿æ¢å®Œæˆçš„å­—ç¬¦ä¸²&#39;12345abcde&#39;.replace(/\d\d\d/g,&#39;*&#39;);     //  &quot;*45abcde&quot;// å»æ‰å­—ç¬¦ä¸²çš„å¼•å·ï¼Œå…¨å±€æ£€ç´¢&#39;ï¼Œæ›¿æ¢æˆ&#39;&#39;ç©º&#39;12345abcde&#39;.replace(/&#39;/g,&#39;&#39;);     //12345abcde// å»æ‰å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„ç©ºæ ¼ï¼Œtab,æ¢é¡µç¬¦ï¼Œæ¢è¡Œç¬¦&#39; 12 345ab cd    e &#39;.replace(/\s/g,&#39;&#39;);     // &quot;12345abcde&quot;</code></pre><h3 id="search-ç”¨äºæ£€ç´¢å­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²æˆ–ä¸æ­£åˆ™è¡¨è¾¾å¼ç›¸åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œè¿”å›åŒ¹é…çš„å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®çš„ç´¢å¼•ï¼Œåä¹‹è¿”å›-1"><a href="#search-ç”¨äºæ£€ç´¢å­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²æˆ–ä¸æ­£åˆ™è¡¨è¾¾å¼ç›¸åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œè¿”å›åŒ¹é…çš„å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®çš„ç´¢å¼•ï¼Œåä¹‹è¿”å›-1" class="headerlink" title="search() ç”¨äºæ£€ç´¢å­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²æˆ–ä¸æ­£åˆ™è¡¨è¾¾å¼ç›¸åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œè¿”å›åŒ¹é…çš„å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®çš„ç´¢å¼•ï¼Œåä¹‹è¿”å›-1"></a>search() ç”¨äºæ£€ç´¢å­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²æˆ–ä¸æ­£åˆ™è¡¨è¾¾å¼ç›¸åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œè¿”å›åŒ¹é…çš„å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®çš„ç´¢å¼•ï¼Œåä¹‹è¿”å›-1</h3><pre><code class="js">&#39;abcdedfasdfs&#39;.search(/d/);      // 3// å³ä½¿æ˜¯å…¨å±€åŒ¹é…ï¼Œä¹Ÿåªä¼šåŒ¹é…åˆ°ç¬¬ä¸€ä¸ªçš„ä½ç½®&#39;abcdedfasdfs&#39;.search(/d/g);     // 3// å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ï¼Œè¿”å›-1&#39;abcdedfasdfs&#39;.search(/o/g);     // -1</code></pre><h3 id="match-æ–¹æ³•å¯åœ¨å­—ç¬¦ä¸²å†…æ£€ç´¢æŒ‡å®šçš„å€¼ï¼Œæˆ–æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…"><a href="#match-æ–¹æ³•å¯åœ¨å­—ç¬¦ä¸²å†…æ£€ç´¢æŒ‡å®šçš„å€¼ï¼Œæˆ–æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…" class="headerlink" title="match()æ–¹æ³•å¯åœ¨å­—ç¬¦ä¸²å†…æ£€ç´¢æŒ‡å®šçš„å€¼ï¼Œæˆ–æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…"></a>match()æ–¹æ³•å¯åœ¨å­—ç¬¦ä¸²å†…æ£€ç´¢æŒ‡å®šçš„å€¼ï¼Œæˆ–æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…</h3><pre><code class="js">// æ£€ç´¢æŒ‡å®šçš„å€¼ï¼Œå¹¶è¿”å›,b+æŒ‡å¤šä¸ª&quot;aabbbbccbbaab&quot;.match(/b+/g);     //  [&quot;bbbb&quot;, &quot;bb&quot;, &quot;b&quot;]</code></pre><h2 id="æ­£åˆ™è§„åˆ™ï¼ˆå¸¸ç”¨"><a href="#æ­£åˆ™è§„åˆ™ï¼ˆå¸¸ç”¨" class="headerlink" title="æ­£åˆ™è§„åˆ™ï¼ˆå¸¸ç”¨)"></a>æ­£åˆ™è§„åˆ™ï¼ˆå¸¸ç”¨)</h2><h3 id="å­—ç¬¦ç±»è§„åˆ™"><a href="#å­—ç¬¦ç±»è§„åˆ™" class="headerlink" title="å­—ç¬¦ç±»è§„åˆ™"></a>å­—ç¬¦ç±»è§„åˆ™</h3><p><img src="https://user-gold-cdn.xitu.io/2018/5/29/163aad82a90e33a8?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å­—ç¬¦ç±»"></p><h3 id="èŒƒå›´ç¬¦å·åŒ¹é…è§„åˆ™"><a href="#èŒƒå›´ç¬¦å·åŒ¹é…è§„åˆ™" class="headerlink" title="èŒƒå›´ç¬¦å·åŒ¹é…è§„åˆ™"></a>èŒƒå›´ç¬¦å·åŒ¹é…è§„åˆ™</h3><p><img src="https://user-gold-cdn.xitu.io/2018/5/30/163aee18e6b545ee?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="èŒƒå›´ç¬¦å·åŒ¹é…è§„åˆ™"></p><h3 id="åˆ†ç»„åŒ¹é…è§„åˆ™"><a href="#åˆ†ç»„åŒ¹é…è§„åˆ™" class="headerlink" title="åˆ†ç»„åŒ¹é…è§„åˆ™"></a>åˆ†ç»„åŒ¹é…è§„åˆ™</h3><p><img src="https://user-gold-cdn.xitu.io/2018/5/30/163aee220257fe90?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="åˆ†ç»„åŒ¹é…è§„åˆ™"></p><h3 id="é‡å¤åŒ¹é…è§„åˆ™"><a href="#é‡å¤åŒ¹é…è§„åˆ™" class="headerlink" title="é‡å¤åŒ¹é…è§„åˆ™"></a>é‡å¤åŒ¹é…è§„åˆ™</h3><p><img src="https://user-gold-cdn.xitu.io/2018/5/30/163aee281db6f27b?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="é‡å¤åŒ¹é…è§„åˆ™"></p><p><a href="https://juejin.im/post/5b0cf331f265da0905017b48?utm_source=gold_browser_extension" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RegExp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–°ä¸€ä»£çš„å‰ç«¯å­˜å‚¨æ–¹æ¡ˆ--indexedDB</title>
      <link href="/2018/05/27/study/%E6%96%B0%E4%B8%80%E4%BB%A3%E7%9A%84%E5%89%8D%E7%AB%AF%E5%AD%98%E5%82%A8%E6%96%B9%E6%A1%88-indexedDB/"/>
      <url>/2018/05/27/study/%E6%96%B0%E4%B8%80%E4%BB%A3%E7%9A%84%E5%89%8D%E7%AB%AF%E5%AD%98%E5%82%A8%E6%96%B9%E6%A1%88-indexedDB/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰ç«¯å­˜å‚¨"><a href="#å‰ç«¯å­˜å‚¨" class="headerlink" title="å‰ç«¯å­˜å‚¨"></a>å‰ç«¯å­˜å‚¨</h1><p><img src="https://user-gold-cdn.xitu.io/2018/5/27/163a05ff03a923bd?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="indexedDB"></p><p>æˆ‘ä»¬éƒ½çŸ¥é“åœ¨å‰ç«¯å¼€å‘å½“ä¸­,æœ‰æ—¶ä¼šå› ä¸ºæŸäº›éœ€æ±‚,è¦å°†ä¸€äº›æ•°æ®å­˜å‚¨åœ¨å‰ç«¯æœ¬åœ°å½“ä¸­.æ¯”å¦‚è¯´:ä¸ºäº†ä¼˜åŒ–æ€§èƒ½,å°†ä¸€äº›å¸¸ç”¨çš„æ•°æ®å­˜åœ¨æœ¬åœ°,è¿™æ ·ä»¥åéœ€è¦çš„æ—¶å€™ç›´æ¥ä»æœ¬åœ°æ‹¿,ä¸éœ€è¦å†å‘åç«¯è¿›è¡Œè¯·æ±‚.è¿˜æœ‰å°±æ˜¯ä¸ºäº†é˜²æ­¢CSRFæ”»å‡»,åç«¯ç»™å‰ç«¯ä¸€ä¸ªtoken,å‰ç«¯å°±éœ€è¦å°†è¿™ä¸ªtokenå­˜åœ¨æœ¬åœ°.ä¹‹åæ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦å¸¦ä¸Šè¿™ä¸ªtoken.ç­‰ç­‰ä¸ä¸€è€Œè¶³.</p><p>è€Œè¿™äº›éœ€æ±‚å°±ä¸æ²¹é¿å…çš„é€ å°±ä¸€ä¸ªå‰ç«¯çš„å‘å±•æ–¹å‘â€“<strong>å‰ç«¯å­˜å‚¨</strong></p><p>åœ¨å‰ç«¯çš„â€™ä¸Šå¤æ—¶ä»£â€™é‡Œ,æˆ‘ä»¬å‰ç«¯æƒ³è¦å­˜å‚¨æ•°æ®,åªæœ‰ä¸€ç§æ–¹å¼,é‚£å°±æ˜¯<code>Cookie</code>.ä½†æ˜¯<code>Cookie</code>è™½ç„¶å¯ä»¥åšå‰ç«¯å­˜å‚¨æ–¹æ¡ˆ,ä½†æ˜¯å´ä¹Ÿæœ‰ç€å¾ˆå¤šå±€é™æ€§.é¦–å…ˆå®ƒçš„å­˜å‚¨ç©ºé—´å¤§å°åªæœ‰<code>4K</code>,å…¶æ¬¡å®ƒçš„å­˜å‚¨æœ‰æ•ˆæ—¶é—´æœ‰é™åˆ¶,ç„¶åå­˜åœ¨<code>Cookie</code>ä¸­çš„æ•°æ®,åœ¨ä½ æ¯æ¬¡è¿›è¡Œè¯·æ±‚çš„æ—¶å€™éƒ½ä¼šå°†å®ƒå¸¦ä¸Š.ä½¿å¾—æ¯æ¬¡çš„è¯·æ±‚æ•°æ®éƒ½ä¼šæ— æ„ä¹‰çš„å¢å¤§.</p><p>æœ€å,ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€ç‚¹.<code>Cookie</code>è®¾è®¡ä¹‹åˆå°±ä¸æ˜¯å°±æ˜¯è®©æˆ‘ä»¬å‰ç«¯å­˜æ•°æ®ç”¨çš„.å®ƒåªæ˜¯ä¸ºäº†è®©ç½‘ç«™éªŒè¯ç”¨æˆ·èº«ä»½ç”¨çš„.è‡³äº<code>Cookie</code>çš„æœ¬åœ°å­˜å‚¨åŠŸèƒ½åªæ˜¯å®ƒçš„ä¸€ä¸ªæ‰‹æ®µè€Œå·².å…³äºè¿™ç‚¹ä½ ä»¬å¯ä»¥çœ‹ä¸‹æˆ‘çš„å¦å¤–ä¸€ç¯‡æ–‡ç« â€”<a href="https://juejin.im/post/59708bbe518825103c098332" target="_blank" rel="noopener">åœ¨HTML5çš„æ—¶ä»£,é‡æ–°è®¤è¯†Cookie</a></p><p>â€ƒâ€ƒç»¼ä¸Šæ‰€è¿°,ä½¿ç”¨Cookieä½œä¸ºå‰ç«¯å­˜å‚¨æœ‰è¿™è®¸å¤šç¼ºç‚¹,æ‰€ä»¥ç»è¿‡å‰ç«¯ç¤¾åŒºçš„ä¸æ–­åŠªåŠ›,åœ¨HTML5ä¸­æœ‰äº†çœŸæ­£çš„å‰ç«¯å­˜å‚¨æ–¹æ¡ˆWeb Storage.å®ƒåˆ†ä¸ºä¸¤ç§,ä¸€ç§æ˜¯<code>æ°¸ä¹…å­˜å‚¨çš„localStorage</code>,ä¸€ç§æ˜¯<code>ä¼šè¯æœŸé—´å­˜å‚¨çš„sessionStorage</code>.å¯¹æ¯”Cookie,<code>Web Storage</code>çš„<strong>ä¼˜åŠ¿</strong>å¾ˆæ˜æ˜¾:</p><blockquote><ul><li>å­˜å‚¨ç©ºé—´æ›´å¤§,æœ‰5Må¤§å°</li><li>åœ¨æµè§ˆå™¨å‘é€è¯·æ±‚æ˜¯ä¸ä¼šå¸¦ä¸Š<code>web Storage</code>é‡Œçš„æ•°æ®</li><li>æ›´åŠ å‹å¥½çš„API</li><li>å¯ä»¥åšæ°¸ä¹…å­˜å‚¨(localStorage).</li></ul></blockquote><a id="more"></a><p>è¿™ä¸€åˆ‡çœ‹èµ·æ¥å¾ˆå®Œç¾,ä½†æ˜¯éšç€å‰ç«¯çš„ä¸æ–­å‘å±•,web Storageä¹Ÿæœ‰äº†ä¸€äº›ä¸å¤ªåˆé€‚çš„åœ°æ–¹:</p><blockquote><ul><li>éšç€webåº”ç”¨ç¨‹åºçš„ä¸æ–­å‘å±•,5Mçš„å­˜å‚¨å¤§å°å¯¹äºä¸€äº›å¤§å‹çš„webåº”ç”¨ç¨‹åºæ¥è¯´æœ‰äº›ä¸å¤Ÿ</li><li>web Storage<strong>åªèƒ½å­˜å‚¨stringç±»å‹</strong>çš„æ•°æ®.å¯¹äºObjectç±»å‹çš„æ•°æ®åªèƒ½å…ˆç”¨<code>JSON.stringify()</code>è½¬æ¢ä¸€ä¸‹åœ¨å­˜å‚¨.</li></ul></blockquote><p>åŸºäºä¸Šè¿°åŸå› ,å‰ç«¯ç¤¾åŒºåˆæå‡ºäº†æµè§ˆå™¨æ•°æ®åº“å­˜å‚¨è¿™ä¸ªæ¦‚å¿µ.è€Œ<code>Web SQL Database</code>å’Œ<code>indexedDB</code>(ç´¢å¼•æ•°æ®åº“)æ˜¯å¯¹è¿™ä¸ªæ¦‚å¿µçš„å®ç°.å…¶ä¸­<em>Web SQL Databaseåœ¨ç›®å‰æ¥è¯´åŸºæœ¬å·²ç»è¢«æ”¾å¼ƒ</em>.æ‰€ä»¥ç›®å‰ä¸»æµçš„æµè§ˆå™¨æ•°æ®åº“çš„å®ç°å°±æ˜¯indexedDB(ç´¢å¼•æ•°æ®åº“).ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦ä»‹ç»çš„ æ–°ä¸€ä»£çš„å‰ç«¯å­˜å‚¨æ–¹æ¡ˆâ€“<strong>indexedDB</strong></p><h2 id="ä»€ä¹ˆæ˜¯indexedDB"><a href="#ä»€ä¹ˆæ˜¯indexedDB" class="headerlink" title="ä»€ä¹ˆæ˜¯indexedDB"></a>ä»€ä¹ˆæ˜¯indexedDB</h2><h3 id="indexedDBçš„ä»‹ç»"><a href="#indexedDBçš„ä»‹ç»" class="headerlink" title="indexedDBçš„ä»‹ç»"></a>indexedDBçš„ä»‹ç»</h3><blockquote><p>IndexedDB æ˜¯ä¸€ç§ä½¿ç”¨æµè§ˆå™¨å­˜å‚¨å¤§é‡æ•°æ®çš„æ–¹æ³•.å®ƒåˆ›é€ çš„æ•°æ®å¯ä»¥è¢«æŸ¥è¯¢ï¼Œå¹¶ä¸”å¯ä»¥ç¦»çº¿ä½¿ç”¨. IndexedDBå¯¹äºé‚£äº›éœ€è¦å­˜å‚¨å¤§é‡æ•°æ®ï¼Œæˆ–è€…æ˜¯éœ€è¦ç¦»çº¿ä½¿ç”¨çš„ç¨‹åºæ˜¯éå¸¸æœ‰æ•ˆçš„è§£å†³æ–¹æ³•. â€” MDN</p></blockquote><h3 id="indexedDBçš„æ¦‚å¿µ"><a href="#indexedDBçš„æ¦‚å¿µ" class="headerlink" title="indexedDBçš„æ¦‚å¿µ"></a>indexedDBçš„æ¦‚å¿µ</h3><blockquote><p>ä½¿ç”¨IndexedDBï¼Œä½ å¯ä»¥å­˜å‚¨æˆ–è€…è·å–æ•°æ®ï¼Œä½¿ç”¨ä¸€ä¸ªkeyç´¢å¼•çš„ã€‚ ä½ å¯ä»¥åœ¨äº‹åŠ¡(transaction)ä¸­å®Œæˆå¯¹æ•°æ®çš„ä¿®æ”¹ã€‚å’Œå¤§å¤šæ•°webå­˜å‚¨è§£å†³æ–¹æ¡ˆç›¸åŒï¼ŒindexedDBä¹Ÿéµä»åŒæºåè®®(same-origin policy). æ‰€ä»¥ä½ åªèƒ½è®¿é—®åŒåŸŸä¸­å­˜å‚¨çš„æ•°æ®ï¼Œè€Œä¸èƒ½è®¿é—®å…¶ä»–åŸŸçš„ã€‚<br>APIåŒ…å«å¼‚æ­¥(asynchronous) API å’ŒåŒæ­¥(synchronous)APIä¸¤ç§ã€‚  å¼‚æ­¥APIé€‚åˆå¤§å¤šæ•°æƒ…å†µ, åŒæ­¥APIå¿…é¡»åŒ WebWorkersä¸€åŒä½¿ç”¨. ç›®å‰ï¼Œæ²¡æœ‰ä¸»æµæµè§ˆå™¨æ”¯æŒåŒæ­¥APIã€‚ å³ä½¿åŒæ­¥APIè¢«æ”¯æŒäº†ï¼Œä½ ä¹Ÿä¼šåœ¨å¤§å¤šæ•°çš„æƒ…å†µä½¿ç”¨å¼‚æ­¥APIã€‚<br>IndexedDB æ˜¯ WebSQL æ•°æ®åº“çš„å–ä»£å“, W3Cç»„ç»‡åœ¨2010å¹´11æœˆ18æ—¥åºŸå¼ƒäº†webSql.  IndexedDB å’ŒWebSQLçš„ä¸åŒç‚¹åœ¨äºWebSQL æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼ˆå¤æ‚ï¼‰IndexedDB æ˜¯key-valueå‹æ•°æ®åº“ï¼ˆç®€å•å¥½ä½¿ï¼‰.</p></blockquote><p>ä¸Šé¢æ˜¯<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API/Basic_Concepts_Behind_IndexedDB" target="_blank" rel="noopener">MDN</a>ä¸Šå¯¹äºIndexedDBçš„ä»‹ç».å…¶ç®€å•è€Œè¨€,indexedDBå°±æ˜¯ä¸€ä¸ªåŸºäºäº‹åŠ¡æ“ä½œçš„key-valueå‹æ•°å‰ç«¯æ•°æ®åº“.å…¶APIå¤§å¤šæ˜¯å¼‚æ­¥çš„</p><h2 id="indexedDBçš„ä½¿ç”¨"><a href="#indexedDBçš„ä½¿ç”¨" class="headerlink" title="indexedDBçš„ä½¿ç”¨"></a>indexedDBçš„ä½¿ç”¨</h2><h3 id="åˆ›å»ºä¸€ä¸ªindexedDBæ•°æ®åº“"><a href="#åˆ›å»ºä¸€ä¸ªindexedDBæ•°æ®åº“" class="headerlink" title="åˆ›å»ºä¸€ä¸ªindexedDBæ•°æ®åº“"></a>åˆ›å»ºä¸€ä¸ªindexedDBæ•°æ®åº“</h3><pre><code class="js">const request = indexedDB.open(&#39;myDatabase&#39;,1);request.addEventListener(&#39;success&#39;, e =&gt; {   console.log(&quot;è¿æ¥æ•°æ®åº“æˆåŠŸ&quot;);});request.addEventListener(&#39;error&#39;, e =&gt; {    console.log(&quot;è¿æ¥æ•°æ®åº“å¤±è´¥&quot;);});</code></pre><p>åœ¨ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬ä½¿ç”¨<code>indexedDB.open()</code>åˆ›å»ºä¸€ä¸ª<code>indexedDB</code>æ•°æ®åº“<code>.open()</code>æ–¹æ³•æ¥å—å¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°.</p><p>ç¬¬ä¸€ä¸ªæ˜¯æ•°æ®åº“å,ç¬¬äºŒä¸ªæ˜¯æ•°æ®åº“çš„ç‰ˆæœ¬å·.<br>åŒæ—¶è¿”å›ä¸€ä¸ª<code>IDBOpenDBRequestå¯¹è±¡</code>ç”¨äºæ“ä½œæ•°æ®åº“.å…¶ä¸­å¯¹äºopen()çš„ç¬¬ä¸€ä¸ªå‚æ•°æ•°æ®åº“å,open()ä¼šå…ˆå»æŸ¥æ‰¾æœ¬åœ°æ˜¯å¦å·²æœ‰è¿™ä¸ªæ•°æ®åº“,å¦‚æœæœ‰åˆ™ç›´æ¥å°†è¿™ä¸ªæ•°æ®åº“è¿”å›,å¦‚æœæ²¡æœ‰,åˆ™å…ˆåˆ›å»ºè¿™ä¸ªæ•°æ®åº“,å†è¿”å›.å¯¹äºç¬¬äºŒä¸ªå‚æ•°ç‰ˆæœ¬å·,åˆ™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°,å¦‚æœä¸ä¼ ,é»˜è®¤ä¸º1.ä½†å¦‚æœä¼ å…¥å°±å¿…é¡»æ˜¯ä¸€ä¸ªæ•´æ•°.</p><p>åœ¨é€šè¿‡å¯¹<code>indexedDB.open()</code>æ–¹æ³•æ‹¿åˆ°ä¸€ä¸ªæ•°æ®åº“å¯¹è±¡<code>IDBOpenDBRequest</code>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›‘å¬è¿™ä¸ªå¯¹è±¡çš„successäº‹ä»¶å’Œerroräº‹ä»¶æ¥æ‰§è¡Œç›¸åº”çš„æ“ä½œ.</p><h3 id="åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“"><a href="#åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“" class="headerlink" title="åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“"></a>åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“</h3><p>å†æœ‰äº†ä¸€ä¸ªæ•°æ®åº“ä¹‹å,æˆ‘ä»¬è·å–å°±æƒ³è¦å»å­˜å‚¨æ•°æ®äº†,ä½†æ˜¯å•åªæœ‰æ•°æ®åº“è¿˜ä¸å¤Ÿ,æˆ‘ä»¬è¿˜éœ€è¦æœ‰<code>å¯¹è±¡ä»“åº“(object store)</code>.<code>å¯¹è±¡ä»“åº“(object store)</code>æ˜¯indexedDBæ•°æ®åº“çš„åŸºç¡€,å…¶ç±»ä¼¼äºMySQLä¸­è¡¨çš„æ¦‚å¿µ.</p><p>è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“å¿…é¡»åœ¨<code>upgradeneeded</code>äº‹ä»¶ä¸­,è€Œ<code>upgradeneeded</code>äº‹ä»¶åªä¼šåœ¨ç‰ˆæœ¬å·æ›´æ–°çš„æ—¶å€™è§¦å‘.è¿™æ˜¯å› ä¸º<em>indexedDB APIä¸­ä¸å…è®¸æ•°æ®åº“ä¸­çš„æ•°æ®ä»“åº“åœ¨åŒä¸€ç‰ˆæœ¬ä¸­å‘ç”Ÿå˜åŒ–</em></p><pre><code class="js">const request = indexedDB.open(&#39;myDatabase&#39;,2);request.addEventListener(&#39;upgradeneeded&#39;,e =&gt; {    const db = e.target.result;    const store = db.createObjectStore(&#39;User&#39;,{keyPath: &#39;userId&#39;,autoIncrement: false});    console.log(&#39;åˆ›å»ºå¯¹è±¡ä»“åº“æˆåŠŸ&#39;);})</code></pre><p>åœ¨ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬ç›‘å¬<code>upgradeneeded</code>äº‹ä»¶,å¹¶åœ¨è¿™ä¸ªäº‹ä»¶è§¦å‘æ—¶ä½¿ç”¨<code>createObjectStore()</code>æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ä»“åº“.</p><p><code>createObjectStore()</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°,ç¬¬ä¸€ä¸ªæ˜¯å¯¹è±¡ä»“åº“çš„åå­—,åœ¨åŒä¸€æ•°æ®åº“ä¸­,<strong>ä»“åº“åä¸èƒ½é‡å¤</strong>.ç¬¬äºŒä¸ªæ˜¯å¯é€‰å‚æ•°.ç”¨äºæŒ‡å®šæ•°æ®çš„ä¸»é”®,ä»¥åŠæ˜¯å¦è‡ªå¢ä¸»é”®.</p><h3 id="åˆ›å»ºäº‹åŠ¡"><a href="#åˆ›å»ºäº‹åŠ¡" class="headerlink" title="åˆ›å»ºäº‹åŠ¡"></a>åˆ›å»ºäº‹åŠ¡</h3><p>â€ƒâ€ƒOKç°åœ¨æˆ‘ä»¬æœ‰äº†æ•°æ®åº“å’Œå¯¹è±¡ä»“åº“äº†,æˆ‘ä»¬æ˜¯å¦å°±å¯ä»¥å­˜å‚¨æ•°æ®äº†äº†.å¾ˆæŠ±æ­‰,è¿˜æ˜¯ä¸è¡Œ.æˆ‘ä»¬è¿˜å·®æœ€åä¸€æ ·ä¸œè¥¿â€”-äº‹åŠ¡.</p><h4 id="ä»€ä¹ˆæ˜¯äº‹åŠ¡"><a href="#ä»€ä¹ˆæ˜¯äº‹åŠ¡" class="headerlink" title="ä»€ä¹ˆæ˜¯äº‹åŠ¡"></a>ä»€ä¹ˆæ˜¯äº‹åŠ¡</h4><blockquote><p>ä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡é€šå¸¸åŒ…å«äº†ä¸€ä¸ªåºåˆ—çš„å¯¹æ•°æ®åº“çš„è¯»/å†™æ“ä½œã€‚å®ƒçš„å­˜åœ¨åŒ…å«æœ‰ä»¥ä¸‹ä¸¤ä¸ªç›®çš„</p><ul><li>ä¸ºæ•°æ®åº“æ“ä½œåºåˆ—æä¾›äº†ä¸€ä¸ªä»å¤±è´¥ä¸­æ¢å¤åˆ°æ­£å¸¸çŠ¶æ€çš„æ–¹æ³•ï¼ŒåŒæ—¶æä¾›äº†æ•°æ®åº“å³ä½¿åœ¨å¼‚å¸¸çŠ¶æ€ä¸‹ä»èƒ½ä¿æŒä¸€è‡´æ€§çš„æ–¹æ³•ã€‚</li><li>å½“å¤šä¸ªåº”ç”¨ç¨‹åºåœ¨å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œå¯ä»¥åœ¨è¿™äº›åº”ç”¨ç¨‹åºä¹‹é—´æä¾›ä¸€ä¸ªéš”ç¦»æ–¹æ³•ï¼Œä»¥é˜²æ­¢å½¼æ­¤çš„æ“ä½œäº’ç›¸å¹²æ‰°ã€‚</li></ul></blockquote><blockquote><p>å¹¶éä»»æ„çš„å¯¹æ•°æ®åº“çš„æ“ä½œåºåˆ—éƒ½æ˜¯æ•°æ®åº“äº‹åŠ¡ã€‚æ•°æ®åº“äº‹åŠ¡æ‹¥æœ‰ä»¥ä¸‹å››ä¸ªç‰¹æ€§ï¼Œä¹ æƒ¯ä¸Šè¢«ç§°ä¹‹ä¸ºACIDç‰¹æ€§ã€‚</p><ul><li>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œï¼ŒåŒ…å«åœ¨å…¶ä¸­çš„å¯¹æ•°æ®åº“çš„æ“ä½œè¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œ</li><li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡åº”ç¡®ä¿æ•°æ®åº“çš„çŠ¶æ€ä»ä¸€ä¸ªä¸€è‡´çŠ¶æ€è½¬å˜ä¸ºå¦ä¸€ä¸ªä¸€è‡´çŠ¶æ€ã€‚ä¸€è‡´çŠ¶æ€çš„å«ä¹‰æ˜¯æ•°æ®åº“ä¸­çš„æ•°æ®åº”æ»¡è¶³å®Œæ•´æ€§çº¦æŸ</li><li>éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šå¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸åº”å½±å“å…¶ä»–äº‹åŠ¡çš„æ‰§è¡Œ</li><li>æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šå·²è¢«æäº¤çš„äº‹åŠ¡å¯¹æ•°æ®åº“çš„ä¿®æ”¹åº”è¯¥æ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­</li></ul></blockquote><p>ä¸Šé¢æ˜¯ç»´åŸºç™¾ç§‘ä¸Šå¯¹æ•°æ®åº“äº‹åŠ¡çš„è§£é‡Š.ç®€å•æ¥è¯´äº‹åŠ¡å°±æ˜¯ç”¨æ¥ä¿è¯æ•°æ®åº“æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸ,è¦ä¹ˆå…¨éƒ¨å¤±è´¥çš„ä¸€ä¸ªé™åˆ¶.æ¯”å¦‚,åœ¨ä¿®æ”¹å¤šæ¡æ•°æ®æ—¶,å‰é¢å‡ æ¡å·²ç»æˆåŠŸäº†.,åœ¨ä¸­é—´çš„æŸä¸€æ¡æ˜¯å¤±è´¥äº†.é‚£ä¹ˆåœ¨è¿™æ—¶,å¦‚æœæ˜¯åŸºäºäº‹åŠ¡çš„æ•°æ®åº“æ“ä½œ,é‚£ä¹ˆè¿™æ—¶æ•°æ®åº“å°±åº”è¯¥é‡ç½®å‰é¢æ•°æ®çš„ä¿®æ”¹,æ”¾å¼ƒåé¢çš„æ•°æ®ä¿®æ”¹.ç›´æ¥è¿”å›é”™è¯¯,ä¸€æ¡æ•°æ®ä¹Ÿä¸ä¿®æ”¹.</p><pre><code class="js">const request = indexedDB.open(&#39;myDatabase&#39;, 3);request.addEventListener(&#39;success&#39;, e =&gt; {    const db = e.target.result;    const tx = db.transaction(&#39;Users&#39;,&#39;readwrite&#39;);});</code></pre><p>ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬ä½¿ç”¨<code>transaction()</code>æ¥åˆ›å»ºä¸€ä¸ªäº‹åŠ¡.</p><p><code>transaction()</code>æ¥å—ä¸¤ä¸ªå‚æ•°,ç¬¬ä¸€ä¸ªæ˜¯ä½ è¦æ“ä½œçš„å¯¹è±¡ä»“åº“åç§°,ç¬¬äºŒä¸ªæ˜¯ä½ åˆ›å»ºçš„äº‹åŠ¡æ¨¡å¼.ä¼ å…¥ <code>readonly</code>æ—¶åªèƒ½å¯¹å¯¹è±¡ä»“åº“è¿›è¡Œè¯»æ“ä½œ,æ— æ³•å†™æ“ä½œ.å¯ä»¥ä¼ å…¥<code>readwrite</code>è¿›è¡Œè¯»å†™æ“ä½œ.</p><h3 id="æ“ä½œæ•°æ®"><a href="#æ“ä½œæ•°æ®" class="headerlink" title="æ“ä½œæ•°æ®"></a>æ“ä½œæ•°æ®</h3><blockquote><p>å¥½äº†ç°åœ¨æœ‰äº†æ•°æ®åº“,å¯¹è±¡ä»“åº“,äº‹åŠ¡ä¹‹åæˆ‘ä»¬ç»ˆäºå¯ä»¥å­˜å‚¨æ•°æ®äº†.</p><ul><li>add() : å¢åŠ æ•°æ®ã€‚æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä¸ºéœ€è¦ä¿å­˜åˆ°å¯¹è±¡ä»“åº“ä¸­çš„å¯¹è±¡ã€‚</li><li>put() : å¢åŠ æˆ–ä¿®æ”¹æ•°æ®ã€‚æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä¸ºéœ€è¦ä¿å­˜åˆ°å¯¹è±¡ä»“åº“ä¸­çš„å¯¹è±¡ã€‚</li><li>get() : è·å–æ•°æ®ã€‚æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä¸ºéœ€è¦è·å–æ•°æ®çš„ä¸»é”®å€¼ã€‚</li><li>delete() : åˆ é™¤æ•°æ®ã€‚æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä¸ºéœ€è¦è·å–æ•°æ®çš„ä¸»é”®å€¼ã€‚</li></ul></blockquote><p>add å’Œ put çš„ä½œç”¨ç±»ä¼¼ï¼ŒåŒºåˆ«<em>åœ¨äº put ä¿å­˜æ•°æ®æ—¶ï¼Œå¦‚æœè¯¥æ•°æ®çš„ä¸»é”®åœ¨æ•°æ®åº“ä¸­å·²ç»æœ‰ç›¸åŒä¸»é”®çš„æ—¶å€™ï¼Œåˆ™ä¼šä¿®æ”¹æ•°æ®åº“ä¸­å¯¹åº”ä¸»é”®çš„å¯¹è±¡ï¼Œè€Œä½¿ç”¨ add ä¿å­˜æ•°æ®ï¼Œå¦‚æœè¯¥ä¸»é”®å·²ç»å­˜åœ¨ï¼Œåˆ™ä¿å­˜å¤±è´¥</em>ã€‚</p><h4 id="æ·»åŠ æ•°æ®"><a href="#æ·»åŠ æ•°æ®" class="headerlink" title="æ·»åŠ æ•°æ®"></a>æ·»åŠ æ•°æ®</h4><pre><code class="js">const request = indexedDB.open(&#39;myDatabase&#39;, 3);request.addEventListener(&#39;success&#39;, e =&gt; {    const db = e.target.result;    const tx = db.transaction(&#39;Users&#39;,&#39;readwrite&#39;);    const store = tx.objectStore(&#39;Users&#39;);    // ä¿å­˜æ•°æ®    const reqAdd = store.add({&#39;userId&#39;: 1, &#39;userName&#39;: &#39;æç™½&#39;, &#39;age&#39;: 24});    reqAdd.addEventListener(&#39;success&#39;, e =&gt; {      console.log(&#39;ä¿å­˜æˆåŠŸ&#39;)    })    // è·å–æ•°æ®    const reqGet = store.get(1);    reqGet.addEventListener(&#39;success&#39;, e =&gt; {      console.log(this.result.userName);    // æç™½    })    //åˆ é™¤æ•°æ®    const reqDelete = store.delete(1);    reqDelete.addEventListener(&#39;success&#39;, e =&gt; {      console.log(&#39;åˆ é™¤æ•°æ®æˆåŠŸ&#39;);    // æç™½    })});</code></pre><h3 id="ä½¿ç”¨æ¸¸æ ‡"><a href="#ä½¿ç”¨æ¸¸æ ‡" class="headerlink" title="ä½¿ç”¨æ¸¸æ ‡"></a>ä½¿ç”¨æ¸¸æ ‡</h3><p>â€ƒâ€ƒåœ¨ä¸Šé¢å½“ä¸­æˆ‘ä»¬ä½¿ç”¨<code>get()</code>æ–¹æ³•ä¼ å…¥ä¸€ä¸ªä¸»é”®æ¥è·å–æ•°æ®,ä½†æ˜¯è¿™æ ·åªèƒ½å¤Ÿè·å–åˆ°ä¸€æ¡æ•°æ®.å¦‚æœæˆ‘ä»¬æƒ³è¦è·å–å¤šæ¡æ•°æ®äº†æ€ä¹ˆåŠ.æˆ‘ä»¬å¯ä»¥<strong>ä½¿ç”¨æ¸¸æ ‡,æ¥è·å–ä¸€ä¸ªåŒºé—´å†…çš„æ•°æ®</strong>.</p><p>è¦ä½¿ç”¨æ¸¸æ ‡,æˆ‘ä»¬éœ€è¦ä½¿ç”¨å¯¹è±¡ä»“åº“ä¸Šçš„<code>openCursor()</code>æ–¹æ³•åˆ›å»ºå¸æ‰“å¼€.<code>openCursor()</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°.</p><blockquote><p>openCursor(range?: IDBKeyRange | number | string | Date | IDBArrayKey, direction?: IDBCursorDirection): IDBRequest;</p></blockquote><p>â€ƒâ€ƒç¬¬ä¸€ä¸ªæ˜¯èŒƒå›´,èŒƒå›´å¯ä»¥æ˜¯ä¸€ä¸ª<code>IDBKeyRange</code>å¯¹è±¡.ç”¨ä»¥ä¸‹æ–¹å¼åˆ›å»º.</p><pre><code class="js">// boundRange è¡¨ç¤ºä¸»é”®å€¼ä»1åˆ°10(åŒ…å«1å’Œ10)çš„é›†åˆã€‚// å¦‚æœç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºtrueï¼Œåˆ™è¡¨ç¤ºä¸åŒ…å«æœ€å°é”®å€¼1ï¼Œå¦‚æœç¬¬å››å‚æ•°ä¸ºtrueï¼Œåˆ™è¡¨ç¤ºä¸åŒ…å«æœ€å¤§é”®å€¼10ï¼Œé»˜è®¤éƒ½ä¸ºfalsevar boundRange = IDBKeyRange.bound(1, 10, false, false);// onlyRange è¡¨ç¤ºç”±ä¸€ä¸ªä¸»é”®å€¼çš„é›†åˆã€‚only() å‚æ•°åˆ™ä¸ºä¸»é”®å€¼ï¼Œæ•´æ•°ç±»å‹ã€‚var onlyRange = IDBKeyRange.only(1);// lowerRaneg è¡¨ç¤ºå¤§äºç­‰äº1çš„ä¸»é”®å€¼çš„é›†åˆã€‚// ç¬¬äºŒä¸ªå‚æ•°å¯é€‰ï¼Œä¸ºtrueåˆ™è¡¨ç¤ºä¸åŒ…å«æœ€å°ä¸»é”®1ï¼Œfalseåˆ™åŒ…å«ï¼Œé»˜è®¤ä¸ºfalsevar lowerRange = IDBKeyRange.lowerBound(1, false);// upperRange è¡¨ç¤ºå°äºç­‰äº10çš„ä¸»é”®å€¼çš„é›†åˆã€‚// ç¬¬äºŒä¸ªå‚æ•°å¯é€‰ï¼Œä¸ºtrueåˆ™è¡¨ç¤ºä¸åŒ…å«æœ€å¤§ä¸»é”®10ï¼Œfalseåˆ™åŒ…å«ï¼Œé»˜è®¤ä¸ºfalsevar upperRange = IDBKeyRange.upperBound(10, false);</code></pre><p>â€ƒâ€ƒç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–¹å‘.ä¸»è¦æœ‰ä¸€ä¸‹å‡ ç§</p><pre><code class="js">next : æ¸¸æ ‡ä¸­çš„æ•°æ®æŒ‰ä¸»é”®å€¼å‡åºæ’åˆ—ï¼Œä¸»é”®å€¼ç›¸ç­‰çš„æ•°æ®éƒ½è¢«è¯»å–nextunique : æ¸¸æ ‡ä¸­çš„æ•°æ®æŒ‰ä¸»é”®å€¼å‡åºæ’åˆ—ï¼Œä¸»é”®å€¼ç›¸ç­‰åªè¯»å–ç¬¬ä¸€æ¡æ•°æ®prev : æ¸¸æ ‡ä¸­çš„æ•°æ®æŒ‰ä¸»é”®å€¼é™åºæ’åˆ—ï¼Œä¸»é”®å€¼ç›¸ç­‰çš„æ•°æ®éƒ½è¢«è¯»å–prevunique : æ¸¸æ ‡ä¸­çš„æ•°æ®æŒ‰ä¸»é”®å€¼é™åºæ’åˆ—ï¼Œä¸»é”®å€¼ç›¸ç­‰åªè¯»å–ç¬¬ä¸€æ¡æ•°æ®</code></pre><p>â€ƒâ€ƒä¸‹é¢è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­</p><pre><code class="js">const request = indexedDB.open(&#39;myDatabase&#39;, 4);request.addEventListener(&#39;success&#39;, e =&gt; {    const db = e.target.result;    const tx = db.transaction(&#39;Users&#39;,&#39;readwrite&#39;);    const store = tx.objectStore(&#39;Users&#39;);    const range = IDBKeyRange.bound(1,10);    const req = store.openCursor(range, &#39;next&#39;);    req.addEventListener(&#39;success&#39;, e =&gt; {      const cursor = this.result;        if(cursor){            console.log(cursor.value.userName);            cursor.continue();        }else{            console.log(&#39;æ£€ç´¢ç»“æŸ&#39;);        }    })});</code></pre><p>â€ƒâ€ƒåœ¨ä¸Šé¢çš„ä»£ç ä¸­å¦‚æœæ£€ç´¢åˆ°ç¬¦åˆæ¡ä»¶çš„æ•°æ®æ—¶,æˆ‘ä»¬å¯ä»¥:</p><blockquote><p>ä½¿ç”¨<code>cursor.value</code>æ‹¿åˆ°æ•°æ®.<br>ä½¿ç”¨<code>cursor.updata()</code>æ›´æ–°æ•°æ®.<br>ä½¿ç”¨<code>cursor.delete()</code>åˆ é™¤æ•°æ®.<br>ä½¿ç”¨<code>cursor.continue()</code>è¯»å–ä¸‹ä¸€æ¡æ•°æ®.</p></blockquote><h3 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h3><p>â€ƒâ€ƒåœ¨ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬è·å–æ•°æ®éƒ½æ˜¯ç”¨çš„ä¸»é”®.ä½†æ˜¯,åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸çŸ¥é“æˆ‘ä»¬éœ€è¦æ•°æ®çš„ä¸»é”®æ˜¯ä»€ä¹ˆ,æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªå¤§æ¦‚çš„æ¡ä»¶.æ¯”å¦‚è¯´å¹´é¾„å¤§äº20å²çš„ç”¨æˆ·.è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°ç´¢å¼•.ä»¥ä¾¿æœ‰æ¡ä»¶çš„æŸ¥æ‰¾.</p><h4 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a>åˆ›å»ºç´¢å¼•</h4><p>â€ƒâ€ƒæˆ‘ä»¬ä½¿ç”¨å¯¹è±¡ä»“åº“çš„<code>createIndex()</code>æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªç´¢å¼•.</p><blockquote><p>createIndex(name: string, keyPath: string | string[], optionalParameters?: IDBIndexParameters): IDBIndex;</p></blockquote><p>createIndex()æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°:</p><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°nameæ˜¯ç´¢å¼•å,ä¸èƒ½é‡å¤.</li><li>ç¬¬äºŒä¸ªå‚æ•°keyPathæ˜¯ä½ è¦åœ¨å­˜å‚¨å¯¹è±¡ä¸Šçš„é‚£ä¸ªå±æ€§ä¸Šå»ºç«‹ç´¢å¼•,å¯ä»¥æ˜¯ä¸€ä¸ªå•ä¸ªçš„keyå€¼,ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«keyå€¼é›†åˆçš„æ•°ç»„.</li><li>ç¬¬ä¸‰ä¸ªå‚æ•°optionalParametersæ˜¯ä¸€ä¸ªå¯é€‰çš„å¯¹è±¡å‚æ•°{unique, multiEntry}</li></ul><p>1.<code>unique</code>: ç”¨æ¥æŒ‡å®šç´¢å¼•å€¼æ˜¯å¦å¯ä»¥é‡å¤,ä¸ºtrueä»£è¡¨ä¸èƒ½ç›¸åŒ,ä¸ºfalseæ—¶ä»£è¡¨å¯ä»¥ç›¸åŒ<br>2.<code>multiEntry</code>: å½“ç¬¬äºŒä¸ªå‚æ•°keyPathä¸ºä¸€ä¸ªæ•°ç»„æ—¶.å¦‚æœmultiEntryæ˜¯true,åˆ™ä¼šä»¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å»ºç«‹ä¸€æ¡ç´¢å¼•.å¦‚æœæ˜¯false,åˆ™ä»¥æ•´ä¸ªæ•°ç»„ä¸ºkeyPathå€¼,æ·»åŠ ä¸€æ¡ç´¢å¼•.</p><pre><code class="js">const request = indexedDB.open(&#39;myDatabase&#39;, 5);request.addEventListener(&#39;upgradeneeded&#39;, e =&gt; {    const db = e.target.result;    const  store = db.createObjectStore(&#39;Users&#39;, {keyPath: &#39;userId&#39;, autoIncrement: false});    const idx = store.createIndex(&#39;ageIndex&#39;,&#39;age&#39;,{unique: false})});</code></pre><p>â€ƒâ€ƒè¿™æ ·æˆ‘ä»¬å°±åˆ›å»ºäº†ä¸€æ¡ç´¢å¼•.</p><h4 id="ä½¿ç”¨ç´¢å¼•"><a href="#ä½¿ç”¨ç´¢å¼•" class="headerlink" title="ä½¿ç”¨ç´¢å¼•"></a>ä½¿ç”¨ç´¢å¼•</h4><p>â€ƒâ€ƒè¿™åœ¨åˆ›å»ºäº†ä¸€æ¡ç´¢å¼•ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ¥ä½¿ç”¨å®ƒäº†.æˆ‘ä»¬ä½¿ç”¨å¯¹è±¡ä»“åº“ä¸Šçš„<code>index</code>æ–¹æ³•,é€šè¿‡ä¼ å…¥ä¸€ä¸ªç´¢å¼•å.æ¥æ‹¿åˆ°ä¸€ä¸ªç´¢å¼•å¯¹è±¡.</p><pre><code class="js">const index = store.index(&#39;ageIndex&#39;);</code></pre><p>â€ƒâ€ƒç„¶åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªç´¢å¼•äº†.æ¯”å¦‚è¯´æˆ‘ä»¬è¦æ‹¿åˆ°å¹´é¾„åœ¨20å²ä»¥ä¸Šçš„æ•°æ®,å‡åºæ’åˆ—.</p><pre><code class="js">const request = indexedDB.open(&#39;myDatabase&#39;, 4);request.addEventListener(&#39;success&#39;, e =&gt; {    const db = e.target.result;    const tx = db.transaction(&#39;Users&#39;,&#39;readwrite&#39;);    const store = tx.objectStore(&#39;Users&#39;);    const index = store.index(&#39;ageIndex&#39;);    const req = index.openCursor(IDBKeyRange.lowerBound(20), &#39;next&#39;);//20å²ä»¥ä¸Šçš„æ•°æ®,å‡åºæ’åˆ—    req.addEventListener(&#39;success&#39;, e =&gt; {      const cursor = e.target.result;        if(cursor){            console.log(cursor.value.age);            cursor.continue();        }else{            console.log(&#39;æ£€ç´¢ç»“æŸ&#39;);        }    })});</code></pre><h2 id="indexedDBçš„å…¼å®¹æ€§"><a href="#indexedDBçš„å…¼å®¹æ€§" class="headerlink" title="indexedDBçš„å…¼å®¹æ€§"></a>indexedDBçš„å…¼å®¹æ€§</h2><p><img src="https://user-gold-cdn.xitu.io/2018/5/27/163a05e409de5bd7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="indexedDBå…¼å®¹æ€§"></p><p><a href="https://juejin.im/post/5b09a641f265da0dcd0b674f?utm_source=gold_browser_extension" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> indexedDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tokenï¼šæœåŠ¡ç«¯èº«ä»½éªŒè¯çš„æµè¡Œæ–¹æ¡ˆ</title>
      <link href="/2018/05/23/study/Token%EF%BC%9A%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E6%B5%81%E8%A1%8C%E6%96%B9%E6%A1%88/"/>
      <url>/2018/05/23/study/Token%EF%BC%9A%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E6%B5%81%E8%A1%8C%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h1 id="èº«ä»½è®¤è¯"><a href="#èº«ä»½è®¤è¯" class="headerlink" title="èº«ä»½è®¤è¯"></a>èº«ä»½è®¤è¯</h1><p>æœåŠ¡ç«¯æä¾›èµ„æºç»™å®¢æˆ·ç«¯ï¼Œä½†æ˜¯æŸäº›èµ„æºæ˜¯æœ‰æ¡ä»¶çš„ã€‚æ‰€ä»¥æœåŠ¡ç«¯è¦èƒ½å¤Ÿè¯†åˆ«è¯·æ±‚è€…çš„èº«ä»½ï¼Œç„¶åå†åˆ¤æ–­æ‰€è¯·æ±‚çš„èµ„æºæ˜¯å¦å¯ä»¥ç»™è¯·æ±‚è€…ã€‚</p><p>tokenæ˜¯ä¸€ç§èº«ä»½éªŒè¯çš„æœºåˆ¶ï¼Œåˆå§‹æ—¶ç”¨æˆ·æäº¤è´¦å·æ•°æ®ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯é‡‡ç”¨ä¸€å®šçš„ç­–ç•¥ç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆtokenï¼‰ï¼Œtokenå­—ç¬¦ä¸²ä¸­åŒ…å«äº†å°‘é‡çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶ä¸”æœ‰ä¸€å®šçš„æœŸé™ã€‚æœåŠ¡ç«¯ä¼šæŠŠtokenå­—ç¬¦ä¸²ä¼ ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¿å­˜tokenå­—ç¬¦ä¸²ï¼Œå¹¶åœ¨æ¥ä¸‹æ¥çš„è¯·æ±‚ä¸­å¸¦ä¸Šè¿™ä¸ªå­—ç¬¦ä¸²ã€‚</p><p>å®ƒçš„å·¥ä½œæµç¨‹å¤§æ¦‚æ˜¯è¿™æ ·</p><h2 id="Tokenæœºåˆ¶"><a href="#Tokenæœºåˆ¶" class="headerlink" title="Tokenæœºåˆ¶"></a>Tokenæœºåˆ¶</h2><blockquote><p>åœ¨è¿™æ ·çš„æµç¨‹ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸‹é¢å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>å¦‚ä½•æ ¹æ®tokenè·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Ÿ</li><li>ç¡®ä¿è¯†åˆ«ä¼ªé€ çš„tokenï¼Ÿ</li><li>è¿™é‡Œæ˜¯æŒ‡tokenä¸æ˜¯ç»è¿‡æœåŠ¡ç«¯æ¥ç”Ÿæˆçš„ã€‚</li><li>å¦‚ä½•åº”ä»˜å†’å……çš„æƒ…å†µï¼Ÿ</li><li>éæ³•å®¢æˆ·ç«¯æ‹¦æˆªäº†åˆæ³•å®¢æˆ·ç«¯çš„tokenï¼Œç„¶åä½¿ç”¨è¿™ä¸ªtokenå‘æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œå†’å……åˆæ³•å®¢æˆ·ç«¯ã€‚</li></ul></blockquote><h2 id="ç”¨æˆ·åŒ¹é…"><a href="#ç”¨æˆ·åŒ¹é…" class="headerlink" title="ç”¨æˆ·åŒ¹é…"></a>ç”¨æˆ·åŒ¹é…</h2><p>æœåŠ¡ç«¯åœ¨ç”Ÿæˆtokenæ—¶ï¼ŒåŠ å…¥å°‘é‡çš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ¯”å¦‚ç”¨æˆ·çš„idã€‚æœåŠ¡ç«¯æ¥æ”¶åˆ°tokenä¹‹åï¼Œå¯ä»¥è§£æå‡ºè¿™äº›æ•°æ®ï¼Œä»è€Œå°†tokenå’Œç”¨æˆ·å…³è”äº†èµ·æ¥ã€‚</p><h2 id="é˜²ä¼ªé€ "><a href="#é˜²ä¼ªé€ " class="headerlink" title="é˜²ä¼ªé€ "></a>é˜²ä¼ªé€ </h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå»ºè®®æ”¾å…¥tokençš„æ•°æ®æ˜¯ä¸æ•æ„Ÿçš„æ•°æ®ï¼Œè¿™æ ·åªè¦æœåŠ¡ç«¯ä½¿ç”¨ç§é’¥å¯¹æ•°æ®ç”Ÿæˆç­¾åï¼Œç„¶åå’Œæ•°æ®æ‹¼æ¥èµ·æ¥ï¼Œä½œä¸ºtokençš„ä¸€éƒ¨åˆ†å³å¯ã€‚æ¯”å¦‚JWTï¼Œå‚è€ƒJSON Web Token - åœ¨Webåº”ç”¨é—´å®‰å…¨åœ°ä¼ é€’ä¿¡æ¯ã€‚</p><p>åœ¨æˆ‘çŸ¥é“JWTä¹‹å‰ï¼Œæˆ‘å…ˆäº†è§£çš„æ˜¯å¦ä¸€ç§æ¨¡å¼ã€‚åŸºäºåŠ å¯†çš„ç®—æ³•ï¼Œå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼ŒæŠŠåŠ å¯†çš„ç»“æœä½œä¸ºtokenï¼ˆ<code>http://blog.leapoahead.com/2015/09/06/understanding-jwt/</code>ï¼‰ã€‚</p><p>æœ¬æ–‡ä¸»è¦è®¨è®ºåä¸€ç§æ¨¡å¼ã€‚</p><h2 id="é˜²å†’å……"><a href="#é˜²å†’å……" class="headerlink" title="é˜²å†’å……"></a>é˜²å†’å……</h2><h3 id="åŠ å¹²æ‰°ç "><a href="#åŠ å¹²æ‰°ç " class="headerlink" title="åŠ å¹²æ‰°ç "></a>åŠ å¹²æ‰°ç </h3><p>æœåŠ¡ç«¯åœ¨ç”Ÿæˆtokenæ—¶ï¼Œä½¿ç”¨äº†å®¢æˆ·ç«¯çš„UAä½œä¸ºå¹²æ‰°ç å¯¹æ•°æ®åŠ å¯†ï¼Œå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚æ—¶ï¼Œä¼šåŒæ—¶ä¼ å…¥tokenã€UAï¼ŒæœåŠ¡ç«¯ä½¿ç”¨UAå¯¹tokenè§£å¯†ï¼Œä»è€ŒéªŒè¯ç”¨æˆ·çš„èº«ä»½ã€‚<br><a id="more"></a><br>å¦‚æœåªæ˜¯æŠŠtokenæ‹·è´åˆ°å¦ä¸€ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ï¼Œä¸åŒçš„UAä¼šå¯¼è‡´åœ¨æœåŠ¡ç«¯è§£ætokenå¤±è´¥ï¼Œä»è€Œå®ç°äº†ä¸€å®šç¨‹åº¦çš„é˜²å†’å……ã€‚ä½†æ˜¯æ”»å‡»è€…å¦‚æœçŒœåˆ°æœåŠ¡ç«¯ä½¿ç”¨UAä½œä¸ºåŠ å¯†é’¥ï¼Œä»–å¯ä»¥ä¿®æ”¹è‡ªå·±çš„UAã€‚</p><h3 id="æœ‰æ•ˆæœŸ"><a href="#æœ‰æ•ˆæœŸ" class="headerlink" title="æœ‰æ•ˆæœŸ"></a>æœ‰æ•ˆæœŸ</h3><p>ç»™tokenåŠ ä¸Šæœ‰æ•ˆæœŸï¼Œå³ä½¿è¢«å†’å……ä¹Ÿåªæ˜¯åœ¨ä¸€å®šçš„æ—¶é—´æ®µå†…æœ‰æ•ˆã€‚è¿™ä¸æ˜¯å®Œç¾çš„é˜²å¾¡æªæ–½ï¼Œåªæ˜¯å°½é‡å‡å°‘æŸå¤±ã€‚</p><p>æœåŠ¡ç«¯åœ¨ç”Ÿæˆtokenæ—¶ï¼ŒåŠ å…¥æœ‰æ•ˆæœŸã€‚æ¯æ¬¡æœåŠ¡ç«¯æ¥æ”¶åˆ°è¯·æ±‚ï¼Œè§£ætokenä¹‹åï¼Œåˆ¤æ–­æ˜¯å¦å·²è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸå°±æ‹’ç»æœåŠ¡ã€‚</p><h3 id="tokenåˆ·æ–°"><a href="#tokenåˆ·æ–°" class="headerlink" title="tokenåˆ·æ–°"></a>tokenåˆ·æ–°</h3><p>å¦‚æœtokenè¿‡æœŸäº†ï¼Œå®¢æˆ·ç«¯åº”è¯¥å¯¹tokenç»­æœŸæˆ–è€…é‡æ–°ç”Ÿæˆtokenã€‚</p><blockquote><p>è¿™å–å†³äºtokençš„è¿‡æœŸæœºåˆ¶ã€‚<br>æœåŠ¡å™¨ç¼“å­˜tokenåŠå¯¹åº”çš„è¿‡æœŸæ—¶é—´<br>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥é‡‡ç”¨ç»­æœŸçš„æ–¹å¼ï¼ŒæœåŠ¡å™¨æ›´æ–°è¿‡æœŸæ—¶é—´ï¼Œtokenå†æ¬¡æœ‰æ•ˆã€‚<br>tokenä¸­å«æœ‰è¿‡æœŸæ—¶é—´<br>è¿™ä¸ªæ—¶å€™éœ€è¦é‡æ–°ç”Ÿæˆtokenã€‚</p></blockquote><p>åœ¨tokenç»­æœŸæˆ–è€…é‡æ–°ç”Ÿæˆtokençš„æ—¶å€™ï¼Œéœ€è¦é¢å¤–åŠ å…¥æ•°æ®æ¥éªŒè¯èº«ä»½ã€‚å› ä¸ºtokenå·²ç»è¿‡æœŸäº†ï¼Œå³tokenå·²ç»ä¸èƒ½ç”¨æ¥éªŒè¯ç”¨æˆ·çš„èº«ä»½äº†ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è¯·æ±‚ç”¨æˆ·é‡æ–°è¾“å…¥è´¦å·å’Œå¯†ç ï¼Œä½†æ˜¯ç”¨æˆ·ä½“éªŒç¨å·®ã€‚</p><p>å¦ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨æ‘˜è¦ã€‚æœåŠ¡ç«¯ç”Ÿæˆtokenï¼ŒåŒæ—¶ç”Ÿæˆtokençš„æ‘˜è¦ï¼Œç„¶åä¸€èµ·è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯ä¿å­˜æ‘˜è¦ï¼Œä¸€èˆ¬è¯·æ±‚åªéœ€è¦ç”¨åˆ°tokenï¼Œåœ¨åˆ·æ–°tokenæ—¶ï¼Œæ‰éœ€è¦ç”¨åˆ°æ‘˜è¦ã€‚æœåŠ¡ç«¯éªŒè¯æ‘˜è¦ï¼Œæ¥éªŒè¯ç”¨æˆ·çš„èº«ä»½ã€‚å› ä¸ºæ‘˜è¦ä¸ä¼šé¢‘ç¹çš„åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¼ è¾“ï¼Œæ‰€ä»¥è¢«æˆªå–çš„æ¦‚ç‡è¾ƒå°ã€‚</p><h2 id="Tokenå·¥ä½œæµç¨‹"><a href="#Tokenå·¥ä½œæµç¨‹" class="headerlink" title="Tokenå·¥ä½œæµç¨‹"></a>Tokenå·¥ä½œæµç¨‹</h2><h3 id="ç”Ÿæˆtoken"><a href="#ç”Ÿæˆtoken" class="headerlink" title="ç”Ÿæˆtoken"></a>ç”Ÿæˆtoken</h3><p>ä¸€èˆ¬åœ¨ç™»å½•çš„æ—¶å€™ç”Ÿæˆtokenã€‚Tokenç®¡ç†è€…è´Ÿè´£æ ¹æ®ç”¨æˆ·çš„æ•°æ®ç”Ÿæˆtokenå’Œæ‘˜è¦ï¼Œæ‘˜è¦ç”¨æ¥ç»™APPç«¯åˆ·æ–°tokenç”¨ï¼Œç±»ä¼¼äºå¾®ä¿¡ç™»å½•ä¸­çš„refresh_tokenã€‚</p><p>ç”Ÿæˆtokençš„è¿‡ç¨‹ä¸­ï¼Œuaçš„å……ä½œå¹²æ‰°ç ã€‚æ²¡æœ‰ç›¸åŒçš„uaï¼Œå°±æ— æ³•è§£æç”Ÿæˆçš„tokenå­—ç¬¦ä¸²ã€‚å¦‚æœå®¢æˆ·ç«¯æ˜¯æ··åˆå¼€å‘çš„æ¨¡å¼ï¼Œç”Ÿæˆtokenå’Œä½¿ç”¨tokençš„ä»£ç†å¯èƒ½ä¸åŒï¼ˆæ¯”å¦‚ä¸€ä¸ªæ˜¯h5ï¼Œä¸€ä¸ªæ˜¯åŸç”Ÿï¼‰ï¼Œuaå°±ä¼šä¸åŒï¼Œtokenå°±æ— æ³•æˆåŠŸçš„ä½¿ç”¨ã€‚å¯ä»¥é€‰æ‹©å…¶ä»–çš„å®¢æˆ·ç«¯æ•°æ®ä½œä¸ºå¹²æ‰°ç ï¼Œ</p><blockquote><p>æ³¨æ„è€ƒè™‘ä¸‹é¢çš„é—®é¢˜ï¼š</p><ul><li>ä¸åŒçš„å®¢æˆ·ç«¯ï¼Œå¹²æ‰°ç åº”è¯¥ä¸åŒ</li><li>å¹²æ‰°ç çš„å¾ˆå¤§ä¸€ä¸ªä½œç”¨æ˜¯é˜²å†’å……ï¼Œå¦‚æœé€‰æ‹©çš„å……å½“å¹²æ‰°ç çš„å®¢æˆ·ç«¯æ•°æ®æ²¡æœ‰åŒºåˆ†æ€§ï¼Œå°±è¾¾ä¸åˆ°æ•ˆæœã€‚é€‰æ‹©å……å½“å¹²æ‰°ç çš„æ•°æ®ï¼Œåœ¨å“ªäº›æƒ…å†µä¸‹ä¼šå˜åŒ–ï¼Ÿè¿™äº›æƒ…å†µæ˜¯å¦åˆç†ï¼Ÿ</li><li>æ¯”å¦‚å¹²æ‰°ç æ•°æ®ä¸­å«æœ‰appçš„ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆappç‰ˆæœ¬å‡çº§å°±ä¼šå¯¼è‡´å¹²æ‰°ç å˜åŒ–ã€‚æœåŠ¡ç«¯æ ¹æ®æ–°çš„å¹²æ‰°ç ï¼Œæ— æ³•è§£ææ—§çš„tokenï¼Œæ­¤æ—¶ç”¨æˆ·å¿…é¡»é‡æ–°ç™»å½•ã€‚è¿™ç§æƒ…å†µæ˜¯åˆç†çš„å—ï¼Ÿå¦‚æœä¸åˆç†ï¼Œå¹²æ‰°ç ä¸­å°±ä¸åº”è¯¥å«æœ‰appçš„ç‰ˆæœ¬å·ã€‚</li></ul></blockquote><h3 id="æ‹¦æˆªéªŒè¯"><a href="#æ‹¦æˆªéªŒè¯" class="headerlink" title="æ‹¦æˆªéªŒè¯"></a>æ‹¦æˆªéªŒè¯</h3><p>å®¢æˆ·ç«¯çš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½å¿…é¡»æºå¸¦tokenã€uaï¼Œæ‹¦æˆªå™¨ä¼šå¯¹æ•æ„Ÿèµ„æºçš„è®¿é—®è¿›è¡Œæ‹¦æˆªï¼Œç„¶åæ ¹æ®uaè§£ætokenï¼Œè§£æä¸æˆåŠŸï¼Œè¡¨ç¤ºtokenå’Œuaä¸åŒ¹é…ã€‚è§£ææˆåŠŸä¹‹åï¼Œåˆ¤æ–­tokenæ˜¯å¦å·²è¿‡æœŸï¼Œå¦‚æœæ˜¯ï¼Œæ‹’ç»æœåŠ¡ã€‚æ‰€æœ‰éƒ½okçš„æƒ…å†µä¸‹ï¼Œæ‹¦æˆªå™¨æ”¾è¡Œï¼Œè¯·æ±‚ä¼ è¾¾åˆ°ä¸šåŠ¡æœåŠ¡è€…ã€‚</p><h3 id="Tokenåˆ·æ–°"><a href="#Tokenåˆ·æ–°" class="headerlink" title="Tokenåˆ·æ–°"></a>Tokenåˆ·æ–°</h3><p>å½“tokenè¿‡æœŸï¼Œç”¨æˆ·éœ€è¦åˆ·æ–°tokenã€‚åˆ·æ–°tokenæœ¬è´¨ä¸Šæ˜¯è¿™æ ·çš„ï¼š</p><p>å®¢æˆ·ç«¯éœ€è¦æŠŠtokenã€æ‘˜è¦ã€uaéƒ½ä¼ ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å¯¹tokené‡æ–°ç”Ÿæˆæ‘˜è¦ï¼Œé€šè¿‡åˆ¤æ–­ä¸¤ä¸ªæ‘˜è¦æ˜¯å¦ç›¸åŒæ¥éªŒè¯è¿™æ¬¡è¯·æ±‚åˆ·æ–°tokençš„å®¢æˆ·ç«¯ï¼Œæ˜¯ä¸æ˜¯ä¸Šæ¬¡è¯·æ±‚ç”Ÿæˆtokençš„å®¢æˆ·ç«¯ã€‚éªŒè¯é€šè¿‡ï¼ŒæœåŠ¡ç«¯éœ€è¦ä½¿ç”¨ç”¨æˆ·æ•°æ®é‡æ–°ç”Ÿæˆtokenï¼Œç”¨æˆ·æ•°æ®åˆ™æ¥è‡ªç”¨uaè§£ætokençš„ç»“æœã€‚</p><h2 id="HTML-amp-JSç­‰å‰ç«¯çŸ¥è¯†ç³»åˆ—ä¹‹Ajax-postè¯·æ±‚å¸¦æœ‰tokenå‘Djangoè¯·æ±‚"><a href="#HTML-amp-JSç­‰å‰ç«¯çŸ¥è¯†ç³»åˆ—ä¹‹Ajax-postè¯·æ±‚å¸¦æœ‰tokenå‘Djangoè¯·æ±‚" class="headerlink" title="HTML&amp;JSç­‰å‰ç«¯çŸ¥è¯†ç³»åˆ—ä¹‹Ajax postè¯·æ±‚å¸¦æœ‰tokenå‘Djangoè¯·æ±‚"></a>HTML&amp;JSç­‰å‰ç«¯çŸ¥è¯†ç³»åˆ—ä¹‹Ajax postè¯·æ±‚å¸¦æœ‰tokenå‘Djangoè¯·æ±‚</h2><p>æˆ‘ä»¬ åœ¨æ¯æ¿ä¸Šå†™å…¥è¿™æ®µä»£ç ï¼š</p><pre><code class="js">&lt;script type=&quot;text/javascript&quot;&gt;        // ä¸ªäººå®šä¹‰å¤§å‡½æ•°ï¼Œä¸æ˜¯é‡ç‚¹ï¼Œå¯ä»¥å¿½ç•¥        $(document).ready(function(){            get_sys_load();            var csrftoken = getCookie(&#39;csrftoken&#39;);            var active_node = $(&quot;#mainnav-menu a[href=&#39;{{ request.path }}&#39;]&quot;);            active_node.parent().addClass(&quot;active-link&quot;);            if (active_node.parent().parent().hasClass(&quot;collapse&quot;)){                active_node.parent().parent().addClass(&quot;in&quot;);            }        });//end doc ready        // ä¸ªäººå®šä¹‰å¤§å‡½æ•°ï¼Œä¸æ˜¯é‡ç‚¹ï¼Œå¯ä»¥å¿½ç•¥        function  get_sys_load(){            $.ajax({                url: &quot;{% url 'get_server_host_status' %}&quot;,                type: &quot;GET&quot;,                dataType: &quot;json&quot;,                success: function(callback){                    for( i in callback){                            console.log(i,callback[i]);                            $(&#39;#&#39;+ i +&#39;_display&#39;).text(callback[i]);                            $(&#39;#&#39;+ i +&#39;_width&#39;).text(callback[i]);                            $(&#39;#&#39;+ i +&#39;_attr&#39;).css(&#39;width&#39;,callback[i]+&#39;%&#39;)                    }// end for                },// end sucess func                error: function(callback){                    alert(callback)                }// end error func            })        }        // è¿™ä¸ªæ‰æ˜¯é‡ç‚¹çš„ä»£ç ï¼Œå¿…é¡»å†™        function getCookie(name) {            var cookieValue = null;            if (document.cookie &amp;&amp; document.cookie !== &#39;&#39;) {                var cookies = document.cookie.split(&#39;;&#39;);                for (var i = 0; i &lt; cookies.length; i++) {                    var cookie = jQuery.trim(cookies[i]);                    // Does this cookie string begin with the name we want?                    if (cookie.substring(0, name.length + 1) === (name + &#39;=&#39;)) {                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));                        break;                    }                }            }            return cookieValue;        }        // è¿™ä¸ªæ‰æ˜¯é‡ç‚¹çš„ä»£ç ï¼Œå¿…é¡»å†™        function csrfSafeMethod(method) {            // these HTTP methods do not require CSRF protection            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));        }        $.ajaxSetup({            beforeSend: function(xhr, settings) {                if (!csrfSafeMethod(settings.type) &amp;&amp; !this.crossDomain) {                    xhr.setRequestHeader(&quot;X-CSRFToken&quot;, csrftoken);                }            }        });    &lt;/script&gt;    {% block  bottom-js %}    {% endblock %}</code></pre><p>æˆ‘ä»¬åœ¨å­æ¿ä¸Šè°ƒç”¨è¿™ç«¯jsä»£ç ï¼Œè°ƒç”¨çš„å‰ææ˜¯å­æ¿çš„htmlé¡µé¢å¿…é¡»åµŒå¥—äº†è¿™ä¸ª csrf_token, ä»£ç å¦‚ä¸‹</p><pre><code class="js">htmlé¡µé¢çš„ä»£ç ï¼š==================&lt;span&gt;{% csrf_token %}&lt;/span&gt;========================JQueryä»£ç  ======={% block  bottom-js %}<script>    function run_cmd(){        var csrftoken = getCookie('csrftoken');     // è°ƒç”¨è·å–tokençš„æ–¹æ³•æ¥è·å–tokenï¼ŒgetCookieæ˜¯å‰é¢å®šä¹‰å¥½çš„å‡½æ•°ã€‚        var input_cmd = $('textarea').val();        $.ajax({            url:"{% url 'put_cmd' %}",            type:'POST',            dataType:'json',            token: csrftoken,                  // æŠŠtokenå¡å…¥å¤´éƒ¨            data:{'host_id':$('#host_id').text(),'minion_name':$('#minion_id').text(),'cmd':input_cmd},            success: function(callback){                console.log(callback)            }, // end success            error: function (callback) {                console.log(callback);                $('code').append(callback)            }        })    }    function show_result(content){    }</script>{% endblock %}</code></pre><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨æäº¤postè¯·æ±‚ï¼Œå°±èƒ½å¤Ÿæ­£å¸¸æäº¤äº†ï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘çš„ä¿¡æ¯ï¼š<br><a href="https://docs.djangoproject.com/en/dev/ref/csrf/#ajax" target="_blank" rel="noopener">ajax token</a>ã€‚</p><h2 id="ç™»å½•åä¿å­˜tokenåˆ°cookieä¸­"><a href="#ç™»å½•åä¿å­˜tokenåˆ°cookieä¸­" class="headerlink" title="ç™»å½•åä¿å­˜tokenåˆ°cookieä¸­"></a>ç™»å½•åä¿å­˜tokenåˆ°cookieä¸­</h2><pre><code class="js">// 1.å¼•å…¥ç›¸åº”JSã€€ã€€&lt;script src=&quot;web/js/jquery-1.9.1.min.js&quot;&gt;&lt;/script&gt;ã€€ã€€&lt;script src=&quot;web/js/jquery.cookie.js&quot;&gt;&lt;/script&gt;// 2.ä¿å­˜cookieã€€ã€€$.cookie(&quot;åç§°&quot;,&quot;å€¼&quot;) //$.cookie(&#39;cookieName&#39;, &#39;cookieValue&#39;);ã€€ã€€$.cookie(&quot;åç§°&quot;,&quot;å€¼&quot;,{expires:å¤±æ•ˆæ—¶é—´})// 3.è·å–cookieã€€ã€€$.cookie(&quot;åç§°&quot;) //$.cookie(&#39;cookieName&#39;);// 4.åˆ é™¤cookieã€€ã€€$.cookie(&quot;åç§°&quot;,null)</code></pre><h2 id="Tokenæœºåˆ¶ç›¸æ¯”Cookieæœºåˆ¶çš„ä¼˜ç‚¹"><a href="#Tokenæœºåˆ¶ç›¸æ¯”Cookieæœºåˆ¶çš„ä¼˜ç‚¹" class="headerlink" title="Tokenæœºåˆ¶ç›¸æ¯”Cookieæœºåˆ¶çš„ä¼˜ç‚¹"></a>Tokenæœºåˆ¶ç›¸æ¯”Cookieæœºåˆ¶çš„ä¼˜ç‚¹</h2><ul><li><p><strong>æ”¯æŒè·¨åŸŸè®¿é—®:</strong>cookieæ˜¯ä¸å…è®¸è·¨åŸŸè®¿é—®çš„ï¼Œè¿™ä¸€ç‚¹å¯¹tokenæœºåˆ¶æ˜¯ä¸å­˜åœ¨çš„ï¼Œå‰ææ˜¯ä¼ è¾“çš„ç”¨æˆ·è®¤è¯ä¿¡æ¯é€šè¿‡HTTPå¤´ä¼ è¾“.</p></li><li><p><strong>æ— çŠ¶æ€(ä¹Ÿç§°ï¼šæœåŠ¡ç«¯å¯æ‰©å±•è¡Œ):</strong>Tokenæœºåˆ¶åœ¨æœåŠ¡ç«¯ä¸éœ€è¦å­˜å‚¨sessionä¿¡æ¯ï¼Œå› ä¸ºToken è‡ªèº«åŒ…å«äº†æ‰€æœ‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼Œåªéœ€è¦åœ¨å®¢æˆ·ç«¯çš„cookieæˆ–æœ¬åœ°ä»‹è´¨å­˜å‚¨çŠ¶æ€ä¿¡æ¯.</p></li><li><p><strong>æ›´é€‚ç”¨äºcdn:</strong> å¯ä»¥é€šè¿‡å†…å®¹åˆ†å‘ç½‘ç»œè¯·æ±‚ä½ æœåŠ¡ç«¯çš„æ‰€æœ‰èµ„æ–™ï¼ˆå¦‚ï¼šjavascriptï¼ŒHTML,å›¾ç‰‡ç­‰ï¼‰ï¼Œè€Œä½ çš„æœåŠ¡ç«¯åªè¦æä¾›APIå³å¯</p></li><li><p><strong>å»è€¦</strong>: ä¸éœ€è¦ç»‘å®šåˆ°ä¸€ä¸ªç‰¹å®šçš„èº«ä»½éªŒè¯æ–¹æ¡ˆã€‚Tokenå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç”Ÿæˆï¼Œåªè¦åœ¨ä½ çš„APIè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä½ å¯ä»¥è¿›è¡ŒTokenç”Ÿæˆè°ƒç”¨å³å¯.</p></li><li><p><strong>æ›´é€‚ç”¨äºç§»åŠ¨åº”ç”¨:</strong> å½“ä½ çš„å®¢æˆ·ç«¯æ˜¯ä¸€ä¸ªåŸç”Ÿå¹³å°ï¼ˆiOS, Androidï¼ŒWindows 8ç­‰ï¼‰æ—¶ï¼ŒCookieæ˜¯ä¸è¢«æ”¯æŒçš„ï¼ˆä½ éœ€è¦é€šè¿‡Cookieå®¹å™¨è¿›è¡Œå¤„ç†ï¼‰ï¼Œè¿™æ—¶é‡‡ç”¨Tokenè®¤è¯æœºåˆ¶å°±ä¼šç®€å•å¾—å¤šã€‚</p></li><li><p><strong>CSRF</strong>:å› ä¸ºä¸å†ä¾èµ–äºCookieï¼Œæ‰€ä»¥ä½ å°±ä¸éœ€è¦è€ƒè™‘å¯¹CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰çš„é˜²èŒƒã€‚</p></li><li><p><strong>æ€§èƒ½:</strong> ä¸€æ¬¡ç½‘ç»œå¾€è¿”æ—¶é—´ï¼ˆé€šè¿‡æ•°æ®åº“æŸ¥è¯¢sessionä¿¡æ¯ï¼‰æ€»æ¯”åšä¸€æ¬¡HMACSHA256è®¡ç®— çš„TokenéªŒè¯å’Œè§£æè¦è´¹æ—¶å¾—å¤š.ä¸éœ€è¦ä¸ºç™»å½•é¡µé¢åšç‰¹æ®Šå¤„ç†: å¦‚æœä½ ä½¿ç”¨Protractor åšåŠŸèƒ½æµ‹è¯•çš„æ—¶å€™ï¼Œä¸å†éœ€è¦ä¸ºç™»å½•é¡µé¢åšç‰¹æ®Šå¤„ç†.</p></li><li><p><strong>åŸºäºæ ‡å‡†åŒ–:</strong>ä½ çš„APIå¯ä»¥é‡‡ç”¨æ ‡å‡†åŒ–çš„ JSON Web Token (JWT). è¿™ä¸ªæ ‡å‡†å·²ç»å­˜åœ¨å¤šä¸ªåç«¯åº“ï¼ˆ.NET, Ruby, Java,Python, PHPï¼‰å’Œå¤šå®¶å…¬å¸çš„æ”¯æŒï¼ˆå¦‚ï¼šFirebase,Google, Microsoftï¼‰.</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Token </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>promiseçš„åŸç†</title>
      <link href="/2018/05/21/%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/promise%E7%9A%84%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/"/>
      <url>/2018/05/21/%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/promise%E7%9A%84%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å…ˆä¸Šä¸€å›¾!<br><img src="https://mengera88.github.io/images/promises.png" alt="promise"></p><p>æœ¬æ–‡çš„promiseæºç æ˜¯æŒ‰ç…§<a href="https://promisesaplus.com/" target="_blank" rel="noopener">Promise/A+è§„èŒƒ</a>æ¥ç¼–å†™çš„ï¼ˆä¸æƒ³çœ‹è‹±æ–‡ç‰ˆçš„ç§»æ­¥<a href="http://www.ituring.com.cn/article/66566" target="_blank" rel="noopener">Promise/A+è§„èŒƒä¸­æ–‡ç¿»è¯‘</a>ï¼‰</p><h2 id="å¼•å­"><a href="#å¼•å­" class="headerlink" title="å¼•å­"></a>å¼•å­</h2><p>ä¸ºäº†è®©å¤§å®¶æ›´å®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªåœºæ™¯å¼€å§‹è®²è§£ï¼Œè®©å¤§å®¶ä¸€æ­¥ä¸€æ­¥è·Ÿç€æ€è·¯æ€è€ƒï¼Œç›¸ä¿¡ä½ ä¸€å®šä¼šæ›´å®¹æ˜“çœ‹æ‡‚ã€‚</p><p>è€ƒè™‘ä¸‹é¢ä¸€ç§è·å–ç”¨æˆ·idçš„è¯·æ±‚å¤„ç†</p><pre><code class="js">function getUrlId() {    return new Promise(function(resolve) {        //å¼‚æ­¥è¯·æ±‚        http.get(url,function(results) {            resolve(results.id);        })    })}getUrlId().then(function(id){    //ä¸€äº›å¤„ç†})</code></pre><p><code>getUserId</code>æ–¹æ³•è¿”å›ä¸€ä¸ª<code>promise</code>ï¼Œå¯ä»¥é€šè¿‡å®ƒçš„<code>then</code>æ–¹æ³•æ³¨å†Œ(æ³¨æ„æ³¨å†Œè¿™ä¸ªè¯)åœ¨<code>promise</code>å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶æ‰§è¡Œçš„å›è°ƒã€‚è¿™ç§æ‰§è¡Œæ–¹å¼ï¼Œä½¿å¾—å¼‚æ­¥è°ƒç”¨å˜å¾—ååˆ†é¡ºæ‰‹ã€‚<br><a id="more"></a></p><h2 id="åŸç†å‰–æ"><a href="#åŸç†å‰–æ" class="headerlink" title="åŸç†å‰–æ"></a>åŸç†å‰–æ</h2><p>é‚£ä¹ˆç±»ä¼¼è¿™ç§åŠŸèƒ½çš„Promiseæ€ä¹ˆå®ç°å‘¢ï¼Ÿå…¶å®æŒ‰ç…§ä¸Šé¢ä¸€å¥è¯ï¼Œå®ç°ä¸€ä¸ªæœ€åŸºç¡€çš„é›å½¢è¿˜æ˜¯å¾ˆeasyçš„ã€‚</p><h3 id="æç®€promiseé›å½¢"><a href="#æç®€promiseé›å½¢" class="headerlink" title="æç®€promiseé›å½¢"></a>æç®€promiseé›å½¢</h3><pre><code class="js">function Promise(fn) {    var value = null,        callbacks = [];  //callbacksä¸ºæ•°ç»„ï¼Œå› ä¸ºå¯èƒ½åŒæ—¶æœ‰å¾ˆå¤šä¸ªå›è°ƒ    this.then = function (onFulfilled) {        callbacks.push(onFulfilled);    };    function resolve(value) {        callbacks.forEach(function (callback) {            callback(value);        });    }    fn(resolve);}</code></pre><p>ä¸Šè¿°ä»£ç å¾ˆç®€å•ï¼Œå¤§è‡´çš„é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>è°ƒç”¨thenæ–¹æ³•ï¼Œå°†æƒ³è¦åœ¨Promiseå¼‚æ­¥æ“ä½œæˆåŠŸæ—¶æ‰§è¡Œçš„å›è°ƒæ”¾å…¥callbacksé˜Ÿåˆ—ï¼Œå…¶å®ä¹Ÿå°±æ˜¯æ³¨å†Œå›è°ƒå‡½æ•°ï¼Œå¯ä»¥å‘è§‚å¯Ÿè€…æ¨¡å¼æ–¹å‘æ€è€ƒï¼›</li><li>åˆ›å»ºPromiseå®ä¾‹æ—¶ä¼ å…¥çš„å‡½æ•°ä¼šè¢«èµ‹äºˆä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ï¼Œå³resolveï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•°valueï¼Œä»£è¡¨å¼‚æ­¥æ“ä½œè¿”å›çš„ç»“æœï¼Œå½“ä¸€æ­¥æ“ä½œæ‰§è¡ŒæˆåŠŸåï¼Œç”¨æˆ·ä¼šè°ƒç”¨resolveæ–¹æ³•ï¼Œè¿™æ—¶å€™å…¶å®çœŸæ­£æ‰§è¡Œçš„æ“ä½œæ˜¯å°†callbacksé˜Ÿåˆ—ä¸­çš„å›è°ƒä¸€ä¸€æ‰§è¡Œï¼›</li></ul><p>å¯ä»¥ç»“åˆä¾‹1ä¸­çš„ä»£ç æ¥çœ‹ï¼Œé¦–å…ˆnew Promiseæ—¶ï¼Œä¼ ç»™promiseçš„å‡½æ•°å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œæ¥ç€è°ƒç”¨promiseå¯¹è±¡çš„thenå±æ€§ï¼Œæ³¨å†Œè¯·æ±‚æˆåŠŸçš„å›è°ƒå‡½æ•°ï¼Œç„¶åå½“å¼‚æ­¥è¯·æ±‚å‘é€æˆåŠŸæ—¶ï¼Œè°ƒç”¨resolve(results.id)æ–¹æ³•, è¯¥æ–¹æ³•æ‰§è¡Œthenæ–¹æ³•æ³¨å†Œçš„å›è°ƒæ•°ç»„ã€‚</p><p>ç›¸ä¿¡ä»”ç»†çš„äººåº”è¯¥å¯ä»¥çœ‹å‡ºæ¥ï¼Œthenæ–¹æ³•åº”è¯¥èƒ½å¤Ÿé“¾å¼è°ƒç”¨ï¼Œä½†æ˜¯ä¸Šé¢çš„æœ€åŸºç¡€ç®€å•çš„ç‰ˆæœ¬æ˜¾ç„¶æ— æ³•æ”¯æŒé“¾å¼è°ƒç”¨ã€‚æƒ³è®©thenæ–¹æ³•æ”¯æŒé“¾å¼è°ƒç”¨ï¼Œå…¶å®ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼š</p><pre><code class="js">this.then = function (onFulfilled) {    callbacks.push(onFulfilled);    return this;};</code></pre><p>see?åªè¦ç®€å•ä¸€å¥è¯å°±å¯ä»¥å®ç°ç±»ä¼¼ä¸‹é¢çš„é“¾å¼è°ƒç”¨ï¼š</p><pre><code class="js">// ä¾‹2getUserId().then(function (id) {    // ä¸€äº›å¤„ç†}).then(function (id) {    // ä¸€äº›å¤„ç†});</code></pre><h3 id="åŠ å…¥å»¶æ—¶æœºåˆ¶"><a href="#åŠ å…¥å»¶æ—¶æœºåˆ¶" class="headerlink" title="åŠ å…¥å»¶æ—¶æœºåˆ¶"></a>åŠ å…¥å»¶æ—¶æœºåˆ¶</h3><p>ç»†å¿ƒçš„åŒå­¦åº”è¯¥å‘ç°ï¼Œä¸Šè¿°ä»£ç å¯èƒ½è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœåœ¨thenæ–¹æ³•æ³¨å†Œå›è°ƒä¹‹å‰ï¼Œresolveå‡½æ•°å°±æ‰§è¡Œäº†ï¼Œæ€ä¹ˆåŠï¼Ÿæ¯”å¦‚promiseå†…éƒ¨çš„å‡½æ•°æ˜¯åŒæ­¥å‡½æ•°ï¼š</p><pre><code class="js">// ä¾‹3function getUserId() {    return new Promise(function (resolve) {        resolve(9876);    });}getUserId().then(function (id) {    // ä¸€äº›å¤„ç†});</code></pre><p>è¿™æ˜¾ç„¶æ˜¯ä¸å…è®¸çš„ï¼ŒPromises/A+è§„èŒƒæ˜ç¡®è¦æ±‚å›è°ƒéœ€è¦é€šè¿‡å¼‚æ­¥æ–¹å¼æ‰§è¡Œï¼Œç”¨ä»¥ä¿è¯ä¸€è‡´å¯é çš„æ‰§è¡Œé¡ºåºã€‚å› æ­¤æˆ‘ä»¬è¦åŠ å…¥ä¸€äº›å¤„ç†ï¼Œä¿è¯åœ¨resolveæ‰§è¡Œä¹‹å‰ï¼Œthenæ–¹æ³•å·²ç»æ³¨å†Œå®Œæ‰€æœ‰çš„å›è°ƒã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·æ”¹é€ ä¸‹resolveå‡½æ•°:</p><pre><code class="js">function resolve(value) {    setTimeout(function() {        callbacks.forEach(function (callback) {            callback(value);        });    }, 0)}</code></pre><p>ä¸Šè¿°ä»£ç çš„æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡setTimeoutæœºåˆ¶ï¼Œå°†resolveä¸­æ‰§è¡Œå›è°ƒçš„é€»è¾‘æ”¾ç½®åˆ°JSä»»åŠ¡é˜Ÿåˆ—æœ«å°¾ï¼Œä»¥ä¿è¯åœ¨resolveæ‰§è¡Œæ—¶ï¼Œthenæ–¹æ³•çš„å›è°ƒå‡½æ•°å·²ç»æ³¨å†Œå®Œæˆ.</p><p>ä½†æ˜¯ï¼Œè¿™æ ·å¥½åƒè¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç»†æƒ³ä¸€ä¸‹ï¼šå¦‚æœPromiseå¼‚æ­¥æ“ä½œå·²ç»æˆåŠŸï¼Œè¿™æ—¶ï¼Œåœ¨å¼‚æ­¥æ“ä½œæˆåŠŸä¹‹å‰æ³¨å†Œçš„å›è°ƒéƒ½ä¼šæ‰§è¡Œï¼Œä½†æ˜¯åœ¨Promiseå¼‚æ­¥æ“ä½œæˆåŠŸè¿™ä¹‹åè°ƒç”¨çš„thenæ³¨å†Œçš„å›è°ƒå°±å†ä¹Ÿä¸ä¼šæ‰§è¡Œäº†ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p><h3 id="åŠ å…¥çŠ¶æ€"><a href="#åŠ å…¥çŠ¶æ€" class="headerlink" title="åŠ å…¥çŠ¶æ€"></a>åŠ å…¥çŠ¶æ€</h3><p>æ©ï¼Œä¸ºäº†è§£å†³ä¸Šä¸€èŠ‚æŠ›å‡ºçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»åŠ å…¥çŠ¶æ€æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å¤§å®¶ç†ŸçŸ¥çš„pendingã€fulfilledã€rejectedã€‚</p><p>Promises/A+è§„èŒƒä¸­çš„2.1Promise Statesä¸­æ˜ç¡®è§„å®šäº†ï¼Œpendingå¯ä»¥è½¬åŒ–ä¸ºfulfilledæˆ–rejectedå¹¶ä¸”åªèƒ½è½¬åŒ–ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœpendingè½¬åŒ–åˆ°fulfilledçŠ¶æ€ï¼Œé‚£ä¹ˆå°±ä¸èƒ½å†è½¬åŒ–åˆ°rejectedã€‚å¹¶ä¸”fulfilledå’ŒrejectedçŠ¶æ€åªèƒ½ç”±pendingè½¬åŒ–è€Œæ¥ï¼Œä¸¤è€…ä¹‹é—´ä¸èƒ½äº’ç›¸è½¬æ¢ã€‚ä¸€å›¾èƒœåƒè¨€</p><p><img src="https://segmentfault.com/img/remote/1460000009478380?w=353&amp;h=260" alt="promiseçŠ¶æ€"></p><p>æ”¹è¿›åçš„ä»£ç æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class="js">function Promise(fn) {    var state = &#39;pending&#39;,        value = null,        callbacks = [];    this.then = function (onFulfilled) {        if (state === &#39;pending&#39;) {            callbacks.push(onFulfilled);            return this;        }        onFulfilled(value);        return this;    };    function resolve(newValue) {        value = newValue;        state = &#39;fulfilled&#39;;        setTimeout(function () {            callbacks.forEach(function (callback) {                callback(value);            });        }, 0);    }    fn(resolve);}</code></pre><p>ä¸Šè¿°ä»£ç çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼šresolveæ‰§è¡Œæ—¶ï¼Œä¼šå°†çŠ¶æ€è®¾ç½®ä¸ºfulfilledï¼Œåœ¨æ­¤ä¹‹åè°ƒç”¨thenæ·»åŠ çš„æ–°å›è°ƒï¼Œéƒ½ä¼šç«‹å³æ‰§è¡Œã€‚</p><p>è¿™é‡Œæ²¡æœ‰ä»»ä½•åœ°æ–¹å°†stateè®¾ä¸ºrejectedï¼Œä¸ºäº†è®©å¤§å®¶èšç„¦åœ¨æ ¸å¿ƒä»£ç ä¸Šï¼Œè¿™ä¸ªé—®é¢˜åé¢ä¼šæœ‰ä¸€å°èŠ‚ä¸“é—¨åŠ å…¥ã€‚</p><h3 id="é“¾å¼Promise"><a href="#é“¾å¼Promise" class="headerlink" title="é“¾å¼Promise"></a>é“¾å¼Promise</h3><p>é‚£ä¹ˆè¿™é‡Œé—®é¢˜åˆæ¥äº†ï¼Œå¦‚æœç”¨æˆ·å†thenå‡½æ•°é‡Œé¢æ³¨å†Œçš„ä»ç„¶æ˜¯ä¸€ä¸ªPromiseï¼Œè¯¥å¦‚ä½•è§£å†³ï¼Ÿæ¯”å¦‚ä¸‹é¢çš„ä¾‹4ï¼š</p><pre><code class="js">// ä¾‹4getUserId()    .then(getUserJobById)    .then(function (job) {        // å¯¹jobçš„å¤„ç†    });function getUserJobById(id) {    return new Promise(function (resolve) {        http.get(baseUrl + id, function(job) {            resolve(job);        });    });}</code></pre><p>è¿™ç§åœºæ™¯ç›¸ä¿¡ç”¨è¿‡promiseçš„äººéƒ½çŸ¥é“ä¼šæœ‰å¾ˆå¤šï¼Œé‚£ä¹ˆç±»ä¼¼è¿™ç§å°±æ˜¯æ‰€è°“çš„é“¾å¼Promiseã€‚</p><p>é“¾å¼Promiseæ˜¯æŒ‡åœ¨å½“å‰promiseè¾¾åˆ°fulfilledçŠ¶æ€åï¼Œå³å¼€å§‹è¿›è¡Œä¸‹ä¸€ä¸ªpromiseï¼ˆåé‚»promiseï¼‰ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è¡”æ¥å½“å‰promiseå’Œåé‚»promiseå‘¢ï¼Ÿï¼ˆè¿™æ˜¯è¿™é‡Œçš„éš¾ç‚¹ï¼‰ã€‚</p><p>å…¶å®ä¹Ÿä¸æ˜¯è¾£ä¹ˆéš¾ï¼Œåªè¦åœ¨thenæ–¹æ³•é‡Œé¢returnä¸€ä¸ªpromiseå°±å¥½å•¦ã€‚Promises/A+è§„èŒƒä¸­çš„2.2.7å°±æ˜¯è¿™ä¹ˆè¯´å“’(å¾®ç¬‘è„¸)~</p><p>ä¸‹é¢æ¥çœ‹çœ‹è¿™æ®µæš—è—ç„æœºçš„thenæ–¹æ³•å’Œresolveæ–¹æ³•æ”¹é€ ä»£ç ï¼š</p><pre><code class="js">function Promise(fn) {    var state = &#39;pending&#39;,        value = null,        callbacks = [];    this.then = function (onFulfilled) {        return new Promise(function (resolve) {            handle({                onFulfilled: onFulfilled || null,                resolve: resolve            });        });    };    function handle(callback) {        if (state === &#39;pending&#39;) {            callbacks.push(callback);            return;        }        //å¦‚æœthenä¸­æ²¡æœ‰ä¼ é€’ä»»ä½•ä¸œè¥¿        if(!callback.onFulfilled) {            callback.resolve(value);            return;        }        var ret = callback.onFulfilled(value);        callback.resolve(ret);    }    function resolve(newValue) {        if (newValue &amp;&amp; (typeof newValue === &#39;object&#39; || typeof newValue === &#39;function&#39;)) {            var then = newValue.then;            if (typeof then === &#39;function&#39;) {                then.call(newValue, resolve);                return;            }        }        state = &#39;fulfilled&#39;;        value = newValue;        setTimeout(function () {            callbacks.forEach(function (callback) {                handle(callback);            });        }, 0);    }    fn(resolve);}</code></pre><p>æˆ‘ä»¬ç»“åˆä¾‹4çš„ä»£ç ï¼Œåˆ†æä¸‹ä¸Šé¢çš„ä»£ç é€»è¾‘ï¼Œä¸ºäº†æ–¹ä¾¿é˜…è¯»ï¼Œæˆ‘æŠŠä¾‹4çš„ä»£ç è´´åœ¨è¿™é‡Œï¼š</p><pre><code class="js">// ä¾‹4getUserId()    .then(getUserJobById)    .then(function (job) {        // å¯¹jobçš„å¤„ç†    });function getUserJobById(id) {    return new Promise(function (resolve) {        http.get(baseUrl + id, function(job) {            resolve(job);        });    });}</code></pre><ul><li>thenæ–¹æ³•ä¸­ï¼Œåˆ›å»ºå¹¶è¿”å›äº†æ–°çš„Promiseå®ä¾‹ï¼Œè¿™æ˜¯ä¸²è¡ŒPromiseçš„åŸºç¡€ï¼Œå¹¶ä¸”æ”¯æŒé“¾å¼è°ƒç”¨ã€‚</li><li>handleæ–¹æ³•æ˜¯promiseå†…éƒ¨çš„æ–¹æ³•ã€‚thenæ–¹æ³•ä¼ å…¥çš„å½¢å‚onFulfilledä»¥åŠåˆ›å»ºæ–°Promiseå®ä¾‹æ—¶ä¼ å…¥çš„resolveå‡è¢«pushåˆ°å½“å‰promiseçš„callbacksé˜Ÿåˆ—ä¸­ï¼Œè¿™æ˜¯è¡”æ¥å½“å‰promiseå’Œåé‚»promiseçš„å…³é”®æ‰€åœ¨ï¼ˆè¿™é‡Œä¸€å®šè¦å¥½å¥½çš„åˆ†æä¸‹handleçš„ä½œç”¨ï¼‰ã€‚</li><li>getUserIdç”Ÿæˆçš„promiseï¼ˆç®€ç§°getUserId promiseï¼‰å¼‚æ­¥æ“ä½œæˆåŠŸï¼Œæ‰§è¡Œå…¶å†…éƒ¨æ–¹æ³•resolveï¼Œä¼ å…¥çš„å‚æ•°æ­£æ˜¯å¼‚æ­¥æ“ä½œçš„ç»“æœid</li><li>è°ƒç”¨handleæ–¹æ³•å¤„ç†callbacksé˜Ÿåˆ—ä¸­çš„å›è°ƒï¼šgetUserJobByIdæ–¹æ³•ï¼Œç”Ÿæˆæ–°çš„promiseï¼ˆgetUserJobById promiseï¼‰</li><li>æ‰§è¡Œä¹‹å‰ç”±getUserId promiseçš„thenæ–¹æ³•ç”Ÿæˆçš„æ–°promise(ç§°ä¸ºbridge promise)çš„resolveæ–¹æ³•ï¼Œä¼ å…¥å‚æ•°ä¸ºgetUserJobById promiseã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šå°†è¯¥resolveæ–¹æ³•ä¼ å…¥getUserJobById promiseçš„thenæ–¹æ³•ä¸­ï¼Œå¹¶ç›´æ¥è¿”å›ã€‚</li><li>åœ¨getUserJobById promiseå¼‚æ­¥æ“ä½œæˆåŠŸæ—¶ï¼Œæ‰§è¡Œå…¶callbacksä¸­çš„å›è°ƒï¼šgetUserId bridge promiseä¸­çš„resolveæ–¹æ³•</li><li>æœ€åæ‰§è¡ŒgetUserId bridge promiseçš„åé‚»promiseçš„callbacksä¸­çš„å›è°ƒã€‚</li></ul><p><img src="https://segmentfault.com/img/remote/1460000009478381?w=2137&amp;h=1262" alt="promiseimg"></p><h3 id="å¤±è´¥å¤„ç†"><a href="#å¤±è´¥å¤„ç†" class="headerlink" title="å¤±è´¥å¤„ç†"></a>å¤±è´¥å¤„ç†</h3><p>åœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶ï¼Œæ ‡è®°å…¶çŠ¶æ€ä¸ºrejectedï¼Œå¹¶æ‰§è¡Œæ³¨å†Œçš„å¤±è´¥å›è°ƒ:</p><pre><code class="js">//ä¾‹5function getUserId() {    return new Promise(function(resolve) {        //å¼‚æ­¥è¯·æ±‚        http.get(url, function(error, results) {            if (error) {                reject(error);            }            resolve(results.id)        })    })}getUserId().then(function(id) {    //ä¸€äº›å¤„ç†}, function(error) {    console.log(error)})</code></pre><p>æœ‰äº†ä¹‹å‰å¤„ç†<code>fulfilled</code>çŠ¶æ€çš„ç»éªŒï¼Œæ”¯æŒé”™è¯¯å¤„ç†å˜å¾—å¾ˆå®¹æ˜“,åªéœ€è¦åœ¨æ³¨å†Œå›è°ƒã€å¤„ç†çŠ¶æ€å˜æ›´ä¸Šéƒ½è¦åŠ å…¥æ–°çš„é€»è¾‘ï¼š</p><pre><code class="js">function Promise(fn) {    var state = &#39;pending&#39;,        value = null,        callbacks = [];    this.then = function (onFulfilled, onRejected) {        return new Promise(function (resolve, reject) {            handle({                onFulfilled: onFulfilled || null,                onRejected: onRejected || null,                resolve: resolve,                reject: reject            });        });    };    function handle(callback) {        if (state === &#39;pending&#39;) {            callbacks.push(callback);            return;        }        var cb = state === &#39;fulfilled&#39; ? callback.onFulfilled : callback.onRejected,            ret;        if (cb === null) {            cb = state === &#39;fulfilled&#39; ? callback.resolve : callback.reject;            cb(value);            return;        }        ret = cb(value);        callback.resolve(ret);    }    function resolve(newValue) {        if (newValue &amp;&amp; (typeof newValue === &#39;object&#39; || typeof newValue === &#39;function&#39;)) {            var then = newValue.then;            if (typeof then === &#39;function&#39;) {                then.call(newValue, resolve, reject);                return;            }        }        state = &#39;fulfilled&#39;;        value = newValue;        execute();    }    function reject(reason) {        state = &#39;rejected&#39;;        value = reason;        execute();    }    function execute() {        setTimeout(function () {            callbacks.forEach(function (callback) {                handle(callback);            });        }, 0);    }    fn(resolve, reject);}</code></pre><p>ä¸Šè¿°ä»£ç å¢åŠ äº†æ–°çš„rejectæ–¹æ³•ï¼Œä¾›å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼ŒåŒæ—¶æŠ½å‡ºäº†resolveå’Œrejectå…±ç”¨çš„éƒ¨åˆ†ï¼Œå½¢æˆexecuteæ–¹æ³•ã€‚</p><p>é”™è¯¯å†’æ³¡æ˜¯ä¸Šè¿°ä»£ç å·²ç»æ”¯æŒï¼Œä¸”éå¸¸å®ç”¨çš„ä¸€ä¸ªç‰¹æ€§ã€‚åœ¨handleä¸­å‘ç°æ²¡æœ‰æŒ‡å®šå¼‚æ­¥æ“ä½œå¤±è´¥çš„å›è°ƒæ—¶ï¼Œä¼šç›´æ¥å°†bridge promise(thenå‡½æ•°è¿”å›çš„promiseï¼ŒååŒ)è®¾ä¸ºrejectedçŠ¶æ€ï¼Œå¦‚æ­¤è¾¾æˆæ‰§è¡Œåç»­å¤±è´¥å›è°ƒçš„æ•ˆæœã€‚è¿™æœ‰åˆ©äºç®€åŒ–ä¸²è¡ŒPromiseçš„å¤±è´¥å¤„ç†æˆæœ¬ï¼Œå› ä¸ºä¸€ç»„å¼‚æ­¥æ“ä½œå¾€å¾€ä¼šå¯¹åº”ä¸€ä¸ªå®é™…åŠŸèƒ½ï¼Œå¤±è´¥å¤„ç†æ–¹æ³•é€šå¸¸æ˜¯ä¸€è‡´çš„ï¼š</p><pre><code class="js">//ä¾‹6getUserId()    .then(getUserJobById)    .then(function (job) {        // å¤„ç†job    }, function (error) {        // getUserIdæˆ–è€…getUerJobByIdæ—¶å‡ºç°çš„é”™è¯¯        console.log(error);    });</code></pre><h3 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h3><p>ç»†å¿ƒçš„åŒå­¦ä¼šæƒ³åˆ°ï¼šå¦‚æœåœ¨æ‰§è¡ŒæˆåŠŸå›è°ƒã€å¤±è´¥å›è°ƒæ—¶ä»£ç å‡ºé”™æ€ä¹ˆåŠï¼Ÿå¯¹äºè¿™ç±»å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨try-catchæ•è·é”™è¯¯ï¼Œå¹¶å°†bridge promiseè®¾ä¸ºrejectedçŠ¶æ€ã€‚handleæ–¹æ³•æ”¹é€ å¦‚ä¸‹ï¼š</p><pre><code class="js">function handle(callback) {    if (state === &#39;pending&#39;) {        callbacks.push(callback);        return;    }    var cb = state === &#39;fulfilled&#39; ? callback.onFulfilled : callback.onRejected,        ret;    if (cb === null) {        cb = state === &#39;fulfilled&#39; ? callback.resolve : callback.reject;        cb(value);        return;    }    try {        ret = cb(value);        callback.resolve(ret);    } catch (e) {        callback.reject(e);    }}</code></pre><p>å¦‚æœåœ¨å¼‚æ­¥æ“ä½œä¸­ï¼Œå¤šæ¬¡æ‰§è¡Œresolveæˆ–è€…rejectä¼šé‡å¤å¤„ç†åç»­å›è°ƒï¼Œå¯ä»¥é€šè¿‡å†…ç½®ä¸€ä¸ªæ ‡å¿—ä½è§£å†³ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åˆšå¼€å§‹çœ‹promiseæºç çš„æ—¶å€™æ€»ä¸èƒ½å¾ˆå¥½çš„ç†è§£thenå’Œresolveå‡½æ•°çš„è¿è¡Œæœºç†ï¼Œä½†æ˜¯å¦‚æœä½ é™ä¸‹å¿ƒæ¥ï¼Œåè¿‡æ¥æ ¹æ®æ‰§è¡Œpromiseæ—¶çš„é€»è¾‘æ¥æ¨æ¼”ï¼Œå°±ä¸éš¾ç†è§£äº†ã€‚è¿™é‡Œä¸€å®šè¦æ³¨æ„çš„ç‚¹æ˜¯ï¼špromiseé‡Œé¢çš„thenå‡½æ•°ä»…ä»…æ˜¯æ³¨å†Œäº†åç»­éœ€è¦æ‰§è¡Œçš„ä»£ç ï¼ŒçœŸæ­£çš„æ‰§è¡Œæ˜¯åœ¨resolveæ–¹æ³•é‡Œé¢æ‰§è¡Œçš„ï¼Œç†æ¸…äº†è¿™å±‚ï¼Œå†æ¥åˆ†ææºç ä¼šçœåŠ›çš„å¤šã€‚</p><p>ç°åœ¨å›é¡¾ä¸‹Promiseçš„å®ç°è¿‡ç¨‹ï¼Œå…¶ä¸»è¦ä½¿ç”¨äº†è®¾è®¡æ¨¡å¼ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼š</p><ul><li>é€šè¿‡Promise.prototype.thenå’ŒPromise.prototype.catchæ–¹æ³•å°†è§‚å¯Ÿè€…æ–¹æ³•æ³¨å†Œåˆ°è¢«è§‚å¯Ÿè€…Promiseå¯¹è±¡ä¸­ï¼ŒåŒæ—¶è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ï¼Œä»¥ä¾¿å¯ä»¥é“¾å¼è°ƒç”¨ã€‚</li><li>è¢«è§‚å¯Ÿè€…ç®¡ç†å†…éƒ¨pendingã€fulfilledå’Œrejectedçš„çŠ¶æ€è½¬å˜ï¼ŒåŒæ—¶é€šè¿‡æ„é€ å‡½æ•°ä¸­ä¼ é€’çš„resolveå’Œrejectæ–¹æ³•ä»¥ä¸»åŠ¨è§¦å‘çŠ¶æ€è½¬å˜å’Œé€šçŸ¥è§‚å¯Ÿè€…ã€‚</li></ul><p><a href="https://segmentfault.com/a/1190000009478377" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> åŸç†ä¸å®ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Promise </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…«æ®µä»£ç å½»åº•æŒæ¡ Promise</title>
      <link href="/2018/05/20/Js/%E5%85%AB%E6%AE%B5%E4%BB%A3%E7%A0%81%E5%BD%BB%E5%BA%95%E6%8E%8C%E6%8F%A1-Promise/"/>
      <url>/2018/05/20/Js/%E5%85%AB%E6%AE%B5%E4%BB%A3%E7%A0%81%E5%BD%BB%E5%BA%95%E6%8E%8C%E6%8F%A1-Promise/</url>
      
        <content type="html"><![CDATA[<h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><h2 id="Promiseçš„ç«‹å³æ‰§è¡Œæ€§"><a href="#Promiseçš„ç«‹å³æ‰§è¡Œæ€§" class="headerlink" title="Promiseçš„ç«‹å³æ‰§è¡Œæ€§"></a>Promiseçš„ç«‹å³æ‰§è¡Œæ€§</h2><pre><code class="js">//1var p = new Promise(function(resolve, reject){  console.log(&quot;create a promise&quot;);  resolve(&quot;success&quot;);});//2console.log(&quot;after new Promise&quot;);//3p.then(function(value){  console.log(value);});</code></pre><p>æ§åˆ¶å°è¾“å‡ºï¼š</p><pre><code class="js">&quot;create a promise&quot;&quot;after new Promise&quot;&quot;success&quot;</code></pre><p>Promiseå¯¹è±¡<code>è¡¨ç¤ºæœªæ¥æŸä¸ªå°†è¦å‘ç”Ÿçš„äº‹ä»¶</code>ï¼Œä½†åœ¨åˆ›å»ºï¼ˆnewï¼‰Promiseæ—¶ï¼Œä½œä¸ºPromiseå‚æ•°ä¼ å…¥çš„å‡½æ•°æ˜¯ä¼šè¢«ç«‹å³æ‰§è¡Œçš„ï¼Œåªæ˜¯å…¶ä¸­æ‰§è¡Œçš„ä»£ç å¯ä»¥æ˜¯<code>å¼‚æ­¥ä»£ç </code>ã€‚æœ‰äº›åŒå­¦ä¼šè®¤ä¸ºï¼Œå½“Promiseå¯¹è±¡è°ƒç”¨thenæ–¹æ³•æ—¶ï¼ŒPromiseæ¥æ”¶çš„å‡½æ•°æ‰ä¼šæ‰§è¡Œï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚å› æ­¤ï¼Œä»£ç ä¸­â€create a promiseâ€å…ˆäºâ€after new Promiseâ€è¾“å‡ºã€‚</p><h2 id="Promise-ä¸‰ç§çŠ¶æ€"><a href="#Promise-ä¸‰ç§çŠ¶æ€" class="headerlink" title="Promise ä¸‰ç§çŠ¶æ€"></a>Promise ä¸‰ç§çŠ¶æ€</h2><pre><code class="js">var p1 = new Promise(function(resolve,reject){  resolve(1);});var p2 = new Promise(function(resolve,reject){  setTimeout(function(){    resolve(2);  }, 500);});var p3 = new Promise(function(resolve,reject){  setTimeout(function(){    reject(3);  }, 500);});console.log(p1);console.log(p2);console.log(p3);setTimeout(function(){  console.log(p2);}, 1000);setTimeout(function(){  console.log(p3);}, 1000);p1.then(function(value){  console.log(value);});p2.then(function(value){  console.log(value);});p3.catch(function(err){  console.log(err);});</code></pre><a id="more"></a><p>æ§åˆ¶å°è¾“å‡ºï¼š</p><pre><code class="js">Promise {[[PromiseStatus]]: &quot;resolved&quot;, [[PromiseValue]]: 1}Promise {[[PromiseStatus]]: &quot;pending&quot;, [[PromiseValue]]: undefined}Promise {[[PromiseStatus]]: &quot;pending&quot;, [[PromiseValue]]: undefined}123Promise {[[PromiseStatus]]: &quot;resolved&quot;, [[PromiseValue]]: 2}Promise {[[PromiseStatus]]: &quot;rejected&quot;, [[PromiseValue]]: 3}</code></pre><p>Promiseçš„å†…éƒ¨å®ç°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºã€‚Promiseæœ‰ä¸‰ç§çŠ¶æ€ï¼š<code>pendingï¼Œresolvedï¼Œrejected</code>ã€‚å½“Promiseåˆšåˆ›å»ºå®Œæˆæ—¶ï¼Œå¤„äºpendingçŠ¶æ€ï¼›å½“Promiseä¸­çš„å‡½æ•°å‚æ•°æ‰§è¡Œäº†resolveåï¼ŒPromiseç”±pendingçŠ¶æ€å˜æˆresolvedçŠ¶æ€ï¼›å¦‚æœåœ¨Promiseçš„å‡½æ•°å‚æ•°ä¸­æ‰§è¡Œçš„ä¸æ˜¯resolveæ–¹æ³•ï¼Œè€Œæ˜¯rejectæ–¹æ³•ï¼Œé‚£ä¹ˆPromiseä¼šç”±pendingçŠ¶æ€å˜æˆrejectedçŠ¶æ€ã€‚</p><p>p2ã€p3åˆšåˆ›å»ºå®Œæˆæ—¶ï¼Œæ§åˆ¶å°è¾“å‡ºçš„è¿™ä¸¤å°Promiseéƒ½å¤„äºpendingçŠ¶æ€ï¼Œä½†ä¸ºä»€ä¹ˆp1æ˜¯resolvedçŠ¶æ€å‘¢ï¼Ÿ è¿™æ˜¯<strong>å› ä¸ºp1çš„å‡½æ•°å‚æ•°ä¸­æ‰§è¡Œçš„æ˜¯ä¸€æ®µåŒæ­¥ä»£ç </strong>ï¼ŒPromiseåˆšåˆ›å»ºå®Œæˆï¼Œresolveæ–¹æ³•å°±å·²ç»è¢«è°ƒç”¨äº†ï¼Œå› è€Œç´§è·Ÿç€çš„è¾“å‡ºæ˜¾ç¤ºp1æ˜¯resolvedçŠ¶æ€ã€‚æˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªsetTimeoutå‡½æ•°ï¼Œå»¶è¿Ÿ1såå†æ¬¡è¾“å‡ºp2ã€p3çš„çŠ¶æ€ï¼Œæ­¤æ—¶p2ã€p3å·²ç»æ‰§è¡Œå®Œæˆï¼ŒçŠ¶æ€åˆ†åˆ«å˜æˆresolvedå’Œrejectedã€‚</p><h2 id="Promise-çŠ¶æ€çš„ä¸å¯é€†æ€§"><a href="#Promise-çŠ¶æ€çš„ä¸å¯é€†æ€§" class="headerlink" title="Promise çŠ¶æ€çš„ä¸å¯é€†æ€§"></a>Promise çŠ¶æ€çš„ä¸å¯é€†æ€§</h2><pre><code class="js">var p1 = new Promise(function(resolve, reject){  resolve(&quot;success1&quot;);  resolve(&quot;success2&quot;);});var p2 = new Promise(function(resolve, reject){  resolve(&quot;success&quot;);  reject(&quot;reject&quot;);});p1.then(function(value){  console.log(value);});p2.then(function(value){  console.log(value);});</code></pre><p>æ§åˆ¶å°è¾“å‡ºï¼š</p><pre><code class="js">&quot;success1&quot;&quot;success&quot;</code></pre><p>PromiseçŠ¶æ€çš„ä¸€æ—¦å˜æˆresolvedæˆ–rejectedæ—¶ï¼ŒPromiseçš„çŠ¶æ€å’Œå€¼å°±å›ºå®šä¸‹æ¥äº†ï¼Œä¸è®ºä½ åç»­å†æ€ä¹ˆè°ƒç”¨resolveæˆ–rejectæ–¹æ³•ï¼Œéƒ½ä¸èƒ½æ”¹å˜å®ƒçš„çŠ¶æ€å’Œå€¼ã€‚å› æ­¤ï¼Œp1ä¸­<code>resolve(&quot;success2&quot;)</code>å¹¶ä¸èƒ½å°†p1çš„å€¼æ›´æ”¹ä¸º<code>success2</code>ï¼Œp2ä¸­<code>reject(&quot;reject&quot;)</code>ä¹Ÿä¸èƒ½å°†p2çš„çŠ¶æ€ç”±resolvedæ”¹å˜ä¸ºrejected.</p><h2 id="é“¾å¼è°ƒç”¨"><a href="#é“¾å¼è°ƒç”¨" class="headerlink" title="é“¾å¼è°ƒç”¨"></a>é“¾å¼è°ƒç”¨</h2><pre><code class="js">var p = new Promise(function(resolve, reject){  resolve(1);});p.then(function(value){               //ç¬¬ä¸€ä¸ªthen  console.log(value);  return value*2;}).then(function(value){              //ç¬¬äºŒä¸ªthen  console.log(value);}).then(function(value){              //ç¬¬ä¸‰ä¸ªthen  console.log(value);  return Promise.resolve(&#39;resolve&#39;);}).then(function(value){              //ç¬¬å››ä¸ªthen  console.log(value);  return Promise.reject(&#39;reject&#39;);}).then(function(value){              //ç¬¬äº”ä¸ªthen  console.log(&#39;resolve: &#39;+ value);}, function(err){  console.log(&#39;reject: &#39; + err);})</code></pre><p>æ§åˆ¶å°è¾“å‡ºï¼š</p><pre><code class="js">12undefined&quot;resolve&quot;&quot;reject: reject&quot;</code></pre><p>Promiseå¯¹è±¡çš„thenæ–¹æ³•<em>è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥é€šè¿‡é“¾å¼è°ƒç”¨thenæ–¹æ³•</em>ã€‚thenæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Promiseæ‰§è¡ŒæˆåŠŸæ—¶çš„å›è°ƒï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯Promiseæ‰§è¡Œå¤±è´¥æ—¶çš„å›è°ƒã€‚</p><p>ä¸¤ä¸ªå‡½æ•°åªä¼šæœ‰ä¸€ä¸ªè¢«è°ƒç”¨ï¼Œå‡½æ•°çš„è¿”å›å€¼å°†è¢«ç”¨ä½œåˆ›å»ºthenè¿”å›çš„Promiseå¯¹è±¡ã€‚è¿™ä¸¤ä¸ªå‚æ•°çš„è¿”å›å€¼å¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ç§æƒ…å†µä¸­çš„ä¸€ç§ï¼š</p><ul><li><p>return ä¸€ä¸ªåŒæ­¥çš„å€¼ ï¼Œæˆ–è€… undefinedï¼ˆå½“æ²¡æœ‰è¿”å›ä¸€ä¸ªæœ‰æ•ˆå€¼æ—¶ï¼Œé»˜è®¤è¿”å›undefinedï¼‰ï¼Œthenæ–¹æ³•å°†è¿”å›ä¸€ä¸ªresolvedçŠ¶æ€çš„Promiseå¯¹è±¡ï¼ŒPromiseå¯¹è±¡çš„å€¼å°±æ˜¯è¿™ä¸ªè¿”å›å€¼ã€‚</p></li><li><p>return å¦ä¸€ä¸ª Promiseï¼Œthenæ–¹æ³•å°†æ ¹æ®è¿™ä¸ªPromiseçš„çŠ¶æ€å’Œå€¼åˆ›å»ºä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡è¿”å›ã€‚</p></li><li><p>throw ä¸€ä¸ªåŒæ­¥å¼‚å¸¸ï¼Œthenæ–¹æ³•å°†è¿”å›ä¸€ä¸ªrejectedçŠ¶æ€çš„Promise,  å€¼æ˜¯è¯¥å¼‚å¸¸ã€‚</p></li></ul><p>æ ¹æ®ä»¥ä¸Šåˆ†æï¼Œä»£ç ä¸­ç¬¬ä¸€ä¸ªthenä¼šè¿”å›ä¸€ä¸ªå€¼ä¸º2ï¼ˆ1*2ï¼‰ï¼ŒçŠ¶æ€ä¸ºresolvedçš„Promiseå¯¹è±¡ï¼Œäºæ˜¯ç¬¬äºŒä¸ªthenè¾“å‡ºçš„å€¼æ˜¯2ã€‚ç¬¬äºŒä¸ªthenä¸­æ²¡æœ‰è¿”å›å€¼ï¼Œå› æ­¤å°†è¿”å›é»˜è®¤çš„undefinedï¼Œäºæ˜¯åœ¨ç¬¬ä¸‰ä¸ªthenä¸­è¾“å‡ºundefinedã€‚ç¬¬ä¸‰ä¸ªthenå’Œç¬¬å››ä¸ªthenä¸­åˆ†åˆ«è¿”å›ä¸€ä¸ªçŠ¶æ€æ˜¯resolvedçš„Promiseå’Œä¸€ä¸ªçŠ¶æ€æ˜¯rejectedçš„Promiseï¼Œä¾æ¬¡ç”±ç¬¬å››ä¸ªthenä¸­æˆåŠŸçš„å›è°ƒå‡½æ•°å’Œç¬¬äº”ä¸ªthenä¸­å¤±è´¥çš„å›è°ƒå‡½æ•°å¤„ç†ã€‚</p><h2 id="Promise-then-å›è°ƒå¼‚æ­¥æ€§"><a href="#Promise-then-å›è°ƒå¼‚æ­¥æ€§" class="headerlink" title="Promise then() å›è°ƒå¼‚æ­¥æ€§"></a>Promise then() å›è°ƒå¼‚æ­¥æ€§</h2><pre><code class="js">var p = new Promise(function(resolve, reject){  resolve(&quot;success&quot;);});p.then(function(value){  console.log(value);});console.log(&quot;which one is called first ?&quot;);</code></pre><p>æ§åˆ¶å°è¾“å‡ºï¼š</p><pre><code class="js">&quot;which one is called first ?&quot;&quot;success&quot;</code></pre><p>Promise<strong>æ¥æ”¶çš„å‡½æ•°å‚æ•°æ˜¯åŒæ­¥æ‰§è¡Œ</strong>çš„ï¼Œä½†thenæ–¹æ³•ä¸­çš„å›è°ƒå‡½æ•°æ‰§è¡Œåˆ™æ˜¯å¼‚æ­¥çš„ï¼Œå› æ­¤ï¼Œâ€successâ€ä¼šåœ¨åé¢è¾“å‡ºã€‚</p><h2 id="Promise-ä¸­çš„å¼‚å¸¸"><a href="#Promise-ä¸­çš„å¼‚å¸¸" class="headerlink" title="Promise ä¸­çš„å¼‚å¸¸"></a>Promise ä¸­çš„å¼‚å¸¸</h2><pre><code class="js">var p1 = new Promise( function(resolve,reject){  foo.bar();  resolve( 1 );});p1.then(  function(value){    console.log(&#39;p1 then value: &#39; + value);  },  function(err){    console.log(&#39;p1 then err: &#39; + err);  }).then(  function(value){    console.log(&#39;p1 then then value: &#39;+value);  },  function(err){    console.log(&#39;p1 then then err: &#39; + err);  });// P2var p2 = new Promise(function(resolve,reject){  resolve( 2 );});p2.then(  function(value){    console.log(&#39;p2 then value: &#39; + value);    foo.bar();  },  function(err){    console.log(&#39;p2 then err: &#39; + err);  }).then(  function(value){    console.log(&#39;p2 then then value: &#39; + value);  },  function(err){    console.log(&#39;p2 then then err: &#39; + err);    return 1;  }).then(  function(value){    console.log(&#39;p2 then then then value: &#39; + value);  },  function(err){    console.log(&#39;p2 then then then err: &#39; + err);  });</code></pre><p> æ§åˆ¶å°è¾“å‡ºï¼š</p><pre><code class="js">p1 then err: ReferenceError: foo is not definedp2 then value: 2p1 then then value: undefinedp2 then then err: ReferenceError: foo is not definedp2 then then then value: 1</code></pre><p>Promiseä¸­çš„å¼‚å¸¸ç”±thenå‚æ•°ä¸­ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ï¼ˆPromiseæ‰§è¡Œå¤±è´¥çš„å›è°ƒï¼‰å¤„ç†ï¼Œå¼‚å¸¸ä¿¡æ¯å°†ä½œä¸ºPromiseçš„å€¼ã€‚å¼‚å¸¸ä¸€æ—¦å¾—åˆ°å¤„ç†ï¼Œthenè¿”å›çš„åç»­Promiseå¯¹è±¡å°†æ¢å¤æ­£å¸¸ï¼Œå¹¶ä¼šè¢«Promiseæ‰§è¡ŒæˆåŠŸçš„å›è°ƒå‡½æ•°å¤„ç†ã€‚å¦å¤–ï¼Œéœ€è¦æ³¨æ„p1ã€p2 å¤šçº§thençš„å›è°ƒå‡½æ•°æ˜¯äº¤æ›¿æ‰§è¡Œçš„ ï¼Œè¿™æ­£æ˜¯ç”±Promise thenå›è°ƒçš„å¼‚æ­¥æ€§å†³å®šçš„ã€‚</p><h2 id="Promise-resolve"><a href="#Promise-resolve" class="headerlink" title="Promise.resolve()"></a>Promise.resolve()</h2><pre><code class="js">var p1 = Promise.resolve( 1 );var p2 = Promise.resolve( p1 );var p3 = new Promise(function(resolve, reject){  resolve(1);});var p4 = new Promise(function(resolve, reject){  resolve(p1);});console.log(p1 === p2);console.log(p1 === p3);console.log(p1 === p4);console.log(p3 === p4);p4.then(function(value){  console.log(&#39;p4=&#39; + value);});p2.then(function(value){  console.log(&#39;p2=&#39; + value);})p1.then(function(value){  console.log(&#39;p1=&#39; + value);})</code></pre><p>æ§åˆ¶å°è¾“å‡ºï¼š</p><pre><code class="js">truefalsefalsefalsep2=1p1=1p4=1</code></pre><p><code>Promise.resolve(...)</code>å¯ä»¥æ¥æ”¶ä¸€ä¸ªå€¼æˆ–è€…æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ä½œä¸ºå‚æ•°ã€‚å½“å‚æ•°æ˜¯æ™®é€šå€¼æ—¶ï¼Œå®ƒè¿”å›ä¸€ä¸ªresolvedçŠ¶æ€çš„Promiseå¯¹è±¡ï¼Œå¯¹è±¡çš„å€¼å°±æ˜¯è¿™ä¸ªå‚æ•°ï¼›å½“å‚æ•°æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡æ—¶ï¼Œå®ƒç›´æ¥è¿”å›è¿™ä¸ªPromiseå‚æ•°ã€‚å› æ­¤ï¼Œp1 === p2ã€‚ä½†é€šè¿‡newçš„æ–¹å¼åˆ›å»ºçš„Promiseå¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå› æ­¤åé¢çš„ä¸‰ä¸ªæ¯”è¾ƒç»“æœéƒ½æ˜¯falseã€‚å¦å¤–ï¼Œä¸ºä»€ä¹ˆp4çš„thenæœ€å…ˆè°ƒç”¨ï¼Œä½†åœ¨æ§åˆ¶å°ä¸Šæ˜¯æœ€åè¾“å‡ºç»“æœçš„å‘¢ï¼Ÿå› ä¸ºp4çš„resolveä¸­æ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡p1ï¼Œresolveä¼šå¯¹p1â€æ‹†ç®±â€œï¼Œè·å–p1çš„çŠ¶æ€å’Œå€¼ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œå¯å‚è€ƒä¸‹ä¸€èŠ‚ã€‚</p><h2 id="resolve-vs-reject"><a href="#resolve-vs-reject" class="headerlink" title="resolve vs reject"></a>resolve vs reject</h2><pre><code class="js">var p1 = new Promise(function(resolve, reject){  resolve(Promise.resolve(&#39;resolve&#39;));});var p2 = new Promise(function(resolve, reject){  resolve(Promise.reject(&#39;reject&#39;));});var p3 = new Promise(function(resolve, reject){  reject(Promise.resolve(&#39;resolve&#39;));});p1.then(  function fulfilled(value){    console.log(&#39;fulfilled: &#39; + value);  },  function rejected(err){    console.log(&#39;rejected: &#39; + err);  });p2.then(  function fulfilled(value){    console.log(&#39;fulfilled: &#39; + value);  },  function rejected(err){    console.log(&#39;rejected: &#39; + err);  });p3.then(  function fulfilled(value){    console.log(&#39;fulfilled: &#39; + value);  },  function rejected(err){    console.log(&#39;rejected: &#39; + err);  });</code></pre><p>æ§åˆ¶å°è¾“å‡ºï¼š</p><pre><code class="js">p3 rejected: [object Promise]p1 fulfilled: resolvep2 rejected: reject</code></pre><p>Promiseå›è°ƒå‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°<code>resolve</code>ï¼Œä¼šå¯¹Promiseæ‰§è¡Œâ€æ‹†ç®±â€åŠ¨ä½œã€‚å³å½“<code>resolve</code>çš„å‚æ•°æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡æ—¶ï¼Œ<code>resolve</code>ä¼šâ€æ‹†ç®±â€è·å–è¿™ä¸ª<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€å’Œå€¼ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ã€‚p1â€æ‹†ç®±â€åï¼Œè·å–åˆ°<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€æ˜¯<code>resolved</code>ï¼Œå› æ­¤fulfilledå›è°ƒè¢«æ‰§è¡Œï¼›p2â€æ‹†ç®±â€åï¼Œè·å–åˆ°<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€æ˜¯<code>rejected</code>ï¼Œå› æ­¤<code>rejected</code>å›è°ƒè¢«æ‰§è¡Œã€‚ä½†<code>Promise</code>å›è°ƒå‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°rejectä¸å…·å¤‡â€æ‹†ç®±â€œçš„èƒ½åŠ›ï¼Œrejectçš„å‚æ•°ä¼šç›´æ¥ä¼ é€’ç»™thenæ–¹æ³•ä¸­çš„<code>rejected</code>å›è°ƒã€‚å› æ­¤ï¼Œå³ä½¿p3 rejectæ¥æ”¶äº†ä¸€ä¸ª<code>resolved</code>çŠ¶æ€çš„<code>Promise</code>ï¼Œthenæ–¹æ³•ä¸­è¢«è°ƒç”¨çš„ä¾ç„¶æ˜¯<code>rejected</code>ï¼Œå¹¶ä¸”å‚æ•°å°±æ˜¯rejectæ¥æ”¶åˆ°çš„<code>Promise</code>å¯¹è±¡ã€‚</p><p><a href="https://juejin.im/post/597724c26fb9a06bb75260e8" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Promise </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç²¾è¯» React é«˜é˜¶ç»„ä»¶</title>
      <link href="/2018/05/19/React/%E7%B2%BE%E8%AF%BB-React-%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/"/>
      <url>/2018/05/19/React/%E7%B2%BE%E8%AF%BB-React-%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h1><p><code>é«˜é˜¶ç»„ä»¶ï¼ˆ higher-order component ï¼ŒHOC ï¼‰</code>æ˜¯ React ä¸­å¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§è¿›é˜¶æŠ€å·§ã€‚å®ƒæœ¬èº«å¹¶ä¸æ˜¯ React çš„ APIï¼Œè€Œæ˜¯ä¸€ç§ React ç»„ä»¶çš„è®¾è®¡ç†å¿µï¼Œä¼—å¤šçš„ React åº“å·²ç»è¯æ˜äº†å®ƒçš„ä»·å€¼ï¼Œä¾‹å¦‚è€³ç†Ÿèƒ½è¯¦çš„ <code>react-redux</code>ã€‚</p><p>é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µå…¶å®å¹¶ä¸éš¾ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡ç±»æ¯”é«˜é˜¶å‡½æ•°è¿…é€ŸæŒæ¡ã€‚é«˜é˜¶å‡½æ•°æ˜¯æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥åˆ°å‡½æ•°ä¸­å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚è¿™é‡Œæˆ‘ä»¬æŠŠå‡½æ•°æ›¿æ¢ä¸ºç»„ä»¶ï¼Œå°±æ˜¯é«˜é˜¶ç»„ä»¶äº†ã€‚</p><pre><code class="js">const EnhancedComponent = higherOrderComponent(WrappedComponent);</code></pre><p>å½“ç„¶äº†è§£é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µåªæ˜¯ä¸‡é‡Œé•¿å¾ç¬¬ä¸€æ­¥ï¼Œç²¾è¯»æ–‡ç« åœ¨é˜è¿°å…¶æ¦‚å¿µä¸å®ç°å¤–ï¼Œä¹Ÿå¼ºè°ƒäº†å…¶é‡è¦æ€§ä¸å±€é™æ€§ï¼Œä»¥åŠä¸å…¶ä»–æ–¹æ¡ˆçš„æ¯”è¾ƒï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥é¢†ç•¥å§ã€‚</p><h2 id="å†…å®¹æ¦‚è¦"><a href="#å†…å®¹æ¦‚è¦" class="headerlink" title="å†…å®¹æ¦‚è¦"></a>å†…å®¹æ¦‚è¦</h2><p>é«˜é˜¶ç»„ä»¶å¸¸è§æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§æ˜¯ <code>Props Proxy</code>ï¼Œå®ƒèƒ½å¤Ÿå¯¹ <code>WrappedComponent</code> çš„ <code>props</code> è¿›è¡Œæ“ä½œï¼Œæå– <code>WrappedComponent state</code> ä»¥åŠä½¿ç”¨å…¶ä»–å…ƒç´ æ¥åŒ…è£¹ <code>WrappedComponent</code>ã€‚<code>Props Proxy</code> ä½œä¸ºä¸€å±‚ä»£ç†ï¼Œå…·æœ‰éš”ç¦»çš„ä½œç”¨ï¼Œå› æ­¤ä¼ å…¥ <code>WrappedComponent</code> çš„ <code>ref</code> å°†æ— æ³•è®¿é—®åˆ°å…¶æœ¬èº«ï¼Œéœ€è¦åœ¨ <code>Props Proxy</code> å†…å®Œæˆä¸­è½¬ï¼Œå…·ä½“å¯å‚è€ƒä»¥ä¸‹ä»£ç ï¼Œ<code>react-redux</code> ä¹Ÿæ˜¯è¿™æ ·å®ç°çš„ã€‚<br><a id="more"></a><br>æ­¤å¤–å„ä¸ª Props Proxy çš„é»˜è®¤åç§°æ˜¯ç›¸åŒçš„ï¼Œéœ€è¦æ ¹æ® WrappedComponent æ¥è¿›è¡Œä¸åŒå‘½åã€‚</p><pre><code class="js">function ppHOC(WrappedComponent) {  return class PP extends React.Component {    // å®ç° HOC ä¸åŒçš„å‘½å    static displayName = `HOC(${WrappedComponent.displayName})`;    getWrappedInstance() {      return this.wrappedInstance;    }    // å®ç° ref çš„è®¿é—®    setWrappedInstance(ref) {      this.wrappedInstance = ref;    }    render() {      return &lt;WrappedComponent {        ...this.props,        ref: this.setWrappedInstance.bind(this),      } /&gt;    }  }}@ppHOCclass Example extends React.Component {  static displayName = &#39;Example&#39;;  handleClick() { ... }  ...}class App extends React.Component {  handleClick() {    this.refs.example.getWrappedInstance().handleClick();  }  render() {    return (      &lt;div&gt;        &lt;button onClick={this.handleClick.bind(this)}&gt;æŒ‰é’®&lt;/button&gt;        &lt;Example ref=&quot;example&quot; /&gt;      &lt;/div&gt;    );  }}</code></pre><p>å¦ä¸€ç§æ˜¯ Inheritance Inversionï¼ŒHOC ç±»ç»§æ‰¿äº† WrappedComponentï¼Œæ„å‘³ç€å¯ä»¥è®¿é—®åˆ° WrappedComponent çš„ stateã€propsã€ç”Ÿå‘½å‘¨æœŸå’Œ render ç­‰æ–¹æ³•ã€‚å¦‚æœåœ¨ HOC ä¸­å®šä¹‰äº†ä¸ WrappedComponent åŒåæ–¹æ³•ï¼Œå°†ä¼šå‘ç”Ÿè¦†ç›–ï¼Œå°±å¿…é¡»æ‰‹åŠ¨é€šè¿‡ super è¿›è¡Œè°ƒç”¨äº†ã€‚é€šè¿‡å®Œå…¨æ“ä½œ WrappedComponent çš„ render æ–¹æ³•è¿”å›çš„å…ƒç´ æ ‘ï¼Œå¯ä»¥çœŸæ­£å®ç°æ¸²æŸ“åŠ«æŒã€‚è¿™ç§æ–¹æ¡ˆä¾ç„¶æ˜¯ç»§æ‰¿çš„æ€æƒ³ï¼Œå¯¹äº WrappedComponent ä¹Ÿæœ‰è¾ƒå¼ºçš„ä¾µå…¥æ€§ï¼Œå› æ­¤å¹¶ä¸å¸¸è§ã€‚</p><pre><code class="js">function ppHOC(WrappedComponent) {  return class ExampleEnhance extends WrappedComponent {    ...    componentDidMount() {      super.componentDidMount();    }    componentWillUnmount() {      super.componentWillUnmount();    }    render() {      ...      return super.render();    }  }}</code></pre><h2 id="ç²¾è¯»"><a href="#ç²¾è¯»" class="headerlink" title="ç²¾è¯»"></a>ç²¾è¯»</h2><h3 id="HOC-çš„é€‚ç”¨èŒƒå›´"><a href="#HOC-çš„é€‚ç”¨èŒƒå›´" class="headerlink" title="HOC çš„é€‚ç”¨èŒƒå›´"></a>HOC çš„é€‚ç”¨èŒƒå›´</h3><p>å¯¹æ¯” HOC èŒƒå¼ <code>compose(render)(state)</code> ä¸<code>çˆ¶ç»„ä»¶ï¼ˆParent Componentï¼‰</code>çš„èŒƒå¼ render(render(state))ï¼Œå¦‚æœå®Œå…¨åˆ©ç”¨ HOC æ¥å®ç° React çš„ <code>implement</code>ï¼Œå°†æ“ä½œä¸ view åˆ†ç¦»ï¼Œä¹Ÿæœªå°ä¸å¯ï¼Œä½†å´ä¸ä¼˜é›…ã€‚HOC æœ¬è´¨ä¸Šæ˜¯ç»Ÿä¸€åŠŸèƒ½æŠ½è±¡ï¼Œå¼ºè°ƒé€»è¾‘ä¸ UI åˆ†ç¦»ã€‚ä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œå‰ç«¯æ— æ³•é€ƒç¦» DOM ï¼Œè€Œé€»è¾‘ä¸ DOM çš„ç›¸å…³æ€§ä¸»è¦å‘ˆç° 3 ç§å…³è”å½¢å¼ï¼š</p><ul><li>ä¸ DOM ç›¸å…³ï¼Œå»ºè®®ä½¿ç”¨çˆ¶ç»„ä»¶ï¼Œç±»ä¼¼äºåŸç”Ÿ HTML ç¼–å†™</li><li>ä¸ DOM ä¸ç›¸å…³ï¼Œå¦‚æ ¡éªŒã€æƒé™ã€è¯·æ±‚å‘é€ã€æ•°æ®è½¬æ¢è¿™ç±»ï¼Œé€šè¿‡æ•°æ®å˜åŒ–é—´æ¥æ§åˆ¶ DOMï¼Œå¯ä»¥ä½¿ç”¨ HOC æŠ½è±¡</li><li>äº¤å‰çš„éƒ¨åˆ†ï¼ŒDOM ç›¸å…³ï¼Œä½†å¯ä»¥åšåˆ°å®Œå…¨å†…èšï¼Œå³è¿™äº› DOM ä¸ä¼šå’Œå¤–éƒ¨æœ‰å…³è”ï¼Œå‡å¯</li></ul><p>DOM çš„æ¸²æŸ“é€‚åˆä½¿ç”¨çˆ¶ç»„ä»¶ï¼Œè¿™æ˜¯ React JSX åŸç”Ÿæ”¯æŒçš„æ–¹å¼ï¼Œæ¸…æ™°æ˜“æ‡‚ã€‚æœ€å¥½æ˜¯èƒ½å°è£…æˆæœ¨å¶ç»„ä»¶ï¼ˆDumb Componentï¼‰ã€‚HOC é€‚åˆåš DOM ä¸ç›¸å…³åˆæ˜¯å¤šä¸ªç»„ä»¶å…±æ€§çš„æ“ä½œã€‚å¦‚ Form ä¸­ï¼Œvalidator æ ¡éªŒæ“ä½œå°±æ˜¯çº¯æ•°æ®æ“ä½œçš„ï¼Œæ”¾åˆ°äº† HOC ä¸­ã€‚ä½† validator ä¿¡æ¯æ²¡æœ‰æ”¾åˆ° HOC ä¸­ã€‚ä½†å¦‚æœèƒ½æŠŠ Error ä¿¡æ¯å±•ç¤ºè¿™äº›é€»è¾‘èƒ½å¤Ÿå®Œå…¨éš”ç¦»ï¼Œä¹Ÿå¯ä»¥æ”¾åˆ° HOC ä¸­ï¼ˆå¯ç»“åˆä¸‹ä¸€å°èŠ‚ Form å…·ä½“å®è·µè¯¦ç»†äº†è§£ï¼‰ã€‚ æ•°æ®è¯·æ±‚æ˜¯å¦ä¸€ç±» DOM ä¸ç›¸å…³çš„åœºæ™¯ï¼Œ<a href="https://github.com/heroku/react-refetch" target="_blank" rel="noopener">react-refetch</a> çš„å®ç°å°±æ˜¯ä½¿ç”¨äº† HOCï¼Œåšåˆ°äº†é«˜æ•ˆå’Œä¼˜é›…</p><pre><code class="js">connect(props =&gt; ({  usersFetch: `/users?status=${props.status}&amp;page=${props.page}`,  userStatsFetch: { url: `/users/stats`, force: true }}))(UsersList)</code></pre><h3 id="HOC-çš„å…·ä½“å®è·µ"><a href="#HOC-çš„å…·ä½“å®è·µ" class="headerlink" title="HOC çš„å…·ä½“å®è·µ"></a>HOC çš„å…·ä½“å®è·µ</h3><p>HOC åœ¨çœŸå®åœºæ™¯ä¸‹çš„è¿è¡Œéå¸¸å¤šï¼Œä¹‹å‰ç¬”è€…åœ¨ åŸºäºDecoratorçš„ç»„ä»¶æ‰©å±•å®è·µ ä¸€æ–‡ä¸­ä¹Ÿæè¿‡ä½¿ç”¨é«˜é˜¶ç»„ä»¶å°†æ›´ç»†ç²’åº¦çš„ç»„ä»¶ç»„åˆæˆ Selector ä¸ Searchã€‚ç»“åˆç²¾è¯»æ–‡ç« ï¼Œè¿™æ¬¡è®©æˆ‘ä»¬é€šè¿‡ Form ç»„ä»¶çš„æŠ½è±¡æ¥è¡¨ç° HOC å…·æœ‰çš„è‰¯å¥½æ‰©å±•æœºåˆ¶ã€‚</p><p>Form ä¸­ä¼šåŒ…å«å„ç§ä¸åŒçš„ç»„ä»¶ï¼Œå¸¸è§çš„æœ‰ Inputã€Selectorã€Checkbox ç­‰ç­‰ï¼Œä¹Ÿä¼šæœ‰æ ¹æ®ä¸šåŠ¡éœ€æ±‚åŠ å…¥çš„è‡ªå®šä¹‰ç»„ä»¶ã€‚Form çµæ´»å¤šå˜ï¼Œä»åŠŸèƒ½ä¸Šçœ‹ï¼Œè¡¨å•æ ¡éªŒå¯èƒ½ä¸ºå•ç»„ä»¶å€¼æ ¡éªŒï¼Œä¹Ÿå¯èƒ½ä¸ºå…¨è¡¨å•å€¼æ ¡éªŒï¼Œå¯èƒ½ä¸ºå¸¸è§„æ£€éªŒï¼Œæ¯”å¦‚ï¼šéç©ºã€è¾“å…¥é™åˆ¶ï¼Œä¹Ÿå¯èƒ½éœ€è¦ä¸æœåŠ¡ç«¯é…åˆï¼Œç”šè‡³éœ€è¦æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è¿›è¡Œå®šåˆ¶ã€‚ä» UI ä¸Šçœ‹ï¼Œæ£€éªŒç»“æœæ˜¾ç¤ºçš„ä½ç½®ï¼Œå¯èƒ½åœ¨ç»„ä»¶ä¸‹æ–¹ï¼Œä¹Ÿå¯èƒ½æ˜¯åœ¨ç»„ä»¶å³ä¾§ã€‚</p><p>ç›´æ¥è£¸å†™ Formï¼Œæ— ç–‘æ˜¯æœºæ¢°è€Œåˆé‡å¤çš„ã€‚å°† Form ä¸­ç»„ä»¶çš„ value ç»è¿‡ validatorï¼ŒæŠŠ valueï¼Œvalidator äº§ç”Ÿçš„ error ä¿¡æ¯å‚¨å­˜åˆ° state æˆ– redux store ä¸­ï¼Œç„¶ååœ¨ view å±‚å®Œæˆæ˜¾ç¤ºã€‚è¿™æ¡è·¯å¤§å®¶éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¯ä»¥è¿›è¡Œå¤ç”¨ï¼Œåªæ˜¯æˆ‘ä»¬é¢å¯¹çš„æ˜¯ä¸åŒçš„ç»„ä»¶ï¼Œä¸åŒçš„ validatorï¼Œä¸åŒçš„ view è€Œå·²ã€‚å¯¹äº Form è€Œè¨€ï¼Œæ—¢è¦æ»¡è¶³é€šç”¨ï¼Œåˆè¦æ»¡è¶³éƒ¨åˆ†ä¸ªæ€§åŒ–çš„éœ€æ±‚ï¼Œä»¥å¾€å•çº¯çš„é…ç½®åŒ–åªä¼šè®©ä½¿ç”¨æ„ˆåŠ ç¹çï¼Œæˆ‘ä»¬æ‰€éœ€è¦æŠ½è±¡çš„æ˜¯ Form åŠŸèƒ½è€Œé UIï¼Œå› æ­¤é€šè¿‡ HOC é’ˆå¯¹ Form çš„åŠŸèƒ½è¿›è¡Œæå–å°±æˆä¸ºäº†å¿…ç„¶ã€‚</p><p><img src="https://user-images.githubusercontent.com/9314735/27116337-3f1f16a8-5103-11e7-8dc6-c7197e1b1eab.png" alt="HOC"></p><p>è‡³äº HOC åœ¨ Form ä¸Šçš„å…·ä½“å®ç°ï¼Œé¦–å…ˆå°†è¡¨å•ä¸­çš„ç»„ä»¶ï¼ˆInputã€Selectorâ€¦ï¼‰ä¸ç›¸åº” validator ä¸ç»„ä»¶å€¼å›è°ƒå‡½æ•°åï¼ˆtriggerï¼‰ä¼ å…¥ Decoratorï¼Œå°† validator ä¸ trigger ç›¸ç»‘å®šã€‚Decorator å®Œæˆäº†å„ç§ä¸åŒç»„ä»¶ä¸ Form å†…ç½® Store é—´ value çš„ä¼ é€’ã€æ ¡éªŒåŠŸèƒ½çš„æŠ½è±¡ï¼Œå³ç²¾è¯»æ–‡ç« ä¸­æåˆ° Props Proxy æ–¹å¼çš„å…¶ä¸­ä¸¤ç§ä½œç”¨ï¼š<strong>æå–state ä¸ æ“ä½œprops</strong></p><pre><code class="js">function formFactoryFactory({  validator,  trigger = &#39;onChange&#39;,  ...}) {  return FormFactory(WrappedComponent) {    return class Decorator extends React.Component {      getBind(trigger, validator) {        ...      }      render() {        const newProps = {          ...this.props,          [trigger]: this.getBind(trigger, validator),          ...        }        return &lt;WrappedComponent {...newProps} /&gt;      }    }  }}// è°ƒç”¨formFactoryFactory({  validator: (value) =&gt; {    return value !== &#39;&#39;;  }})(&lt;Input placeholder=&quot;è¯·è¾“å…¥...&quot; /&gt;)</code></pre><p>å½“ç„¶ä¸ºäº†è€ƒè™‘ä¸ªæ€§åŒ–éœ€æ±‚ï¼ŒForm Store ä¹Ÿå‘å¤–æš´éœ²å¾ˆå¤š APIï¼Œå¯ä»¥ç›´æ¥è·å–å’Œä¿®æ”¹ valueã€error çš„å€¼ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦å¯¹ä¸€ä¸ªè¡¨å•çš„æ‰€æœ‰å€¼æäº¤åˆ°åç«¯è¿›è¡Œæ ¡éªŒï¼Œæ ¹æ®åç«¯è¿”å›ï¼Œåˆ†åˆ«åˆ—å‡ºå„é¡¹çš„æ ¡éªŒé”™è¯¯ä¿¡æ¯ï¼Œå°±éœ€è¦å€ŸåŠ©ç›¸åº”é¡¹çš„ setError å»å®Œæˆäº†ã€‚</p><p>è¿™é‡Œä¸»è¦å‚è€ƒäº† <a href="https://github.com/react-component/form" target="_blank" rel="noopener">rc-form</a> çš„å®ç°æ–¹å¼ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥é˜…è¯»å…¶æºç ã€‚</p><pre><code class="js">import { createForm } from &#39;rc-form&#39;;class Form extends React.Component {  submit = () =&gt; {    this.props.form.validateFields((error, value) =&gt; {      console.log(error, value);    });  }  render() {    const { getFieldError, getFieldDecorator } = this.props.form;    const errors = getFieldError(&#39;required&#39;);    return (      &lt;div&gt;        {getFieldDecorator(&#39;required&#39;, {          rules: [{ required: true }],        })(&lt;Input /&gt;)}        {errors ? errors.join(&#39;,&#39;) : null}        &lt;button onClick={this.submit}&gt;submit&lt;/button&gt;      &lt;/div&gt;    );  }}export createForm()(Form);</code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>React å§‹ç»ˆå¼ºè°ƒç»„åˆä¼˜äºç»§æ‰¿çš„ç†å¿µï¼ŒæœŸæœ›é€šè¿‡å¤ç”¨å°ç»„ä»¶æ¥æ„å»ºå¤§ç»„ä»¶ä½¿å¾—å¼€å‘å˜å¾—ç®€å•è€Œåˆé«˜æ•ˆï¼Œä¸ä¼ ç»Ÿé¢å‘å¯¹è±¡æ€æƒ³æ˜¯æˆªç„¶ä¸åŒçš„ã€‚é«˜é˜¶å‡½æ•°ï¼ˆHOCï¼‰çš„å‡ºç°æ›¿ä»£äº†åŸæœ‰ Mixin ä¾µå…¥å¼çš„æ–¹æ¡ˆï¼Œå¯¹æ¯”éšå¼çš„ Mixin æˆ–æ˜¯ç»§æ‰¿ï¼ŒHOC èƒ½å¤Ÿåœ¨ Devtools ä¸­æ˜¾ç¤ºå‡ºæ¥ï¼Œæ»¡è¶³æŠ½è±¡ä¹‹ä½™ï¼Œä¹Ÿæ–¹ä¾¿äº†å¼€å‘ä¸æµ‹è¯•ã€‚å½“ç„¶ï¼Œä¸å¯è¿‡åº¦æŠ½è±¡æ˜¯æˆ‘ä»¬å§‹ç»ˆè¦ç§‰æŒçš„åŸåˆ™ã€‚å¸Œæœ›è¯»è€…é€šè¿‡æœ¬æ¬¡é˜…è¯»ä¸è®¨è®ºï¼Œèƒ½ç»“åˆè‡ªå·±å…·ä½“çš„ä¸šåŠ¡å¼€å‘åœºæ™¯ï¼Œè·å¾—ä¸€äº›å¯å‘ã€‚</p><p><a href="https://github.com/dt-fe/weekly/blob/master/12.%E7%B2%BE%E8%AF%BB%20React%20%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6.md" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾è¯´ES Modules</title>
      <link href="/2018/05/17/Js/%E5%9B%BE%E8%AF%B4ES-Modules/"/>
      <url>/2018/05/17/Js/%E5%9B%BE%E8%AF%B4ES-Modules/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åŸæ–‡ï¼šES modules: <a href="https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/" target="_blank" rel="noopener">A cartoon deep-dive, Lin Clark</a></p><p>ES modulesï¼ˆESMï¼‰ æ˜¯ JavaScript å®˜æ–¹çš„æ ‡å‡†åŒ–æ¨¡å—ç³»ç»Ÿã€‚<br>ç„¶è€Œï¼Œå®ƒåœ¨æ ‡å‡†åŒ–çš„é“è·¯ä¸Šå·²ç»èŠ±è´¹äº†è¿‘ 10 å¹´çš„æ—¶é—´ã€‚</p><p>å¯å–œçš„æ˜¯ï¼Œæ ‡å‡†åŒ–ä¹‹è·¯é©¬ä¸Šå°±è¦å®Œæˆäº†ã€‚ç­‰åˆ° 2018 å¹´ 5 æœˆ Firefox 60 å‘å¸ƒä¹‹åï¼Œæ‰€æœ‰çš„ä¸»æµæµè§ˆå™¨å°±éƒ½æ”¯æŒ ESM äº†ã€‚åŒæ—¶ï¼ŒNode æ¨¡å—å·¥ä½œå°ç»„ä¹Ÿæ­£åœ¨ä¸º Node.js æ·»åŠ  ESM æ”¯æŒã€‚<a href="https://www.youtube.com/watch?v=qR_b5gajwug" target="_blank" rel="noopener">ä¸º WebAssembly æä¾› ESM é›†æˆçš„å·¥ä½œ</a>ä¹Ÿæ­£åœ¨å¦‚ç«å¦‚è¼çš„è¿›è¡Œã€‚</p><p>è®¸å¤š JS å¼€å‘è€…éƒ½çŸ¥é“ï¼Œå¯¹ ESM çš„è®¨è®ºä»å¼€å§‹è‡³ä»Šä¸€ç›´éƒ½æ²¡åœè¿‡ã€‚ä½†æ˜¯å¾ˆå°‘æœ‰äººçœŸæ­£ç†è§£ ESM çš„å·¥ä½œåŸç†ã€‚</p><p>ä»Šå¤©ï¼Œè®©æˆ‘ä»¬æ¥æ¢³ç†æ¢³ç† ESM åˆ°åº•è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠå®ƒè·Ÿå…¶ä»–æ¨¡å—ç³»ç»Ÿä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</p><h2 id="ä¸ºä»€ä¹ˆè¦æ¨¡å—åŒ–"><a href="#ä¸ºä»€ä¹ˆè¦æ¨¡å—åŒ–" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æ¨¡å—åŒ–"></a>ä¸ºä»€ä¹ˆè¦æ¨¡å—åŒ–</h2><p>è¯´åˆ° JS ç¼–ç¨‹ï¼Œå…¶å®è¯´çš„å°±æ˜¯<strong>å¦‚ä½•ç®¡ç†å˜é‡</strong>ã€‚<br>ç¼–ç¨‹çš„è¿‡ç¨‹éƒ½æ˜¯å…³äºå¦‚ä½•ç»™å˜é‡èµ‹å€¼ï¼Œè¦ä¹ˆç›´æ¥èµ‹å€¼ç»™å˜é‡ï¼Œè¦ä¹ˆæ˜¯æŠŠä¸¤ä¸ªå˜é‡ç»“åˆèµ·æ¥ç„¶åå†æŠŠç»“æœèµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ã€‚</p><p><img src="https://segmentfault.com/img/bV72g6?w=3399&amp;h=1207" alt="esmpic1"></p><p>å› ä¸ºå¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯å…³äºæ”¹å˜å˜é‡çš„ï¼Œæ‰€ä»¥å¦‚ä½•ç»„ç»‡è¿™äº›å˜é‡å°±ç›´æ¥å½±å“äº†ç¼–ç è´¨é‡ï¼Œä»¥åŠç»´æŠ¤å®ƒä»¬çš„æˆæœ¬ã€‚</p><p>å¦‚æœä»£ç ä¸­ä»…æœ‰å°‘é‡çš„å˜é‡ï¼Œé‚£ä¹ˆç»„ç»‡èµ·æ¥å…¶å®æ˜¯å¾ˆç®€å•çš„ã€‚<br>JS æœ¬èº«å°±æä¾›äº†ä¸€ç§æ–¹å¼å¸®ä½ ç»„ç»‡å˜é‡ï¼Œç§°ä¸º<strong>å‡½æ•°ä½œç”¨åŸŸ</strong>ã€‚å› ä¸ºå‡½æ•°ä½œç”¨åŸŸçš„ç¼˜æ•…ï¼Œä¸€ä¸ªå‡½æ•°æ— æ³•è®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä¸­å®šä¹‰çš„å˜é‡ã€‚<br><a id="more"></a><br><img src="https://segmentfault.com/img/bV72kE?w=2478&amp;h=1446" alt="esmpic2"></p><p>è¿™ç§æ–¹å¼æ˜¯å¾ˆæœ‰æ•ˆçš„ã€‚å®ƒä½¿å¾—æˆ‘ä»¬åœ¨å†™ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œåªéœ€è¦è€ƒè™‘å½“å‰å‡½æ•°ï¼Œè€Œä¸å¿…æ‹…å¿ƒå…¶å®ƒå‡½æ•°å¯èƒ½ä¼šæ”¹å˜å½“å‰å‡½æ•°çš„å˜é‡ã€‚<br>ä¸è¿‡ï¼Œå®ƒä¹Ÿæœ‰ä¸å¥½çš„åœ°æ–¹ã€‚å®ƒä¼šè®©æˆ‘ä»¬å¾ˆéš¾åœ¨ä¸åŒå‡½æ•°ä¹‹é—´<strong>å…±äº«å˜é‡</strong>ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è·Ÿå½“å‰å‡½æ•°ä»¥å¤–çš„å‡½æ•°å…±äº«å˜é‡è¦æ€ä¹ˆåŠå‘¢ï¼Ÿä¸€ç§é€šç”¨çš„<code>åšæ³•æ˜¯æŠŠè¦å…±äº«çš„å˜é‡æå‡åˆ°ä¸Šä¸€å±‚ä½œç”¨åŸŸï¼Œæ¯”å¦‚å…¨å±€ä½œç”¨åŸŸ</code>ã€‚</p><p>åœ¨ jQuery æ—¶ä»£è¿™ç§æå‡åšæ³•ç›¸å½“æ™®éã€‚åœ¨æˆ‘ä»¬åŠ è½½ä»»ä½• jQuery æ’ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿ jQuery å·²ç»å­˜åœ¨äºå…¨å±€ä½œç”¨åŸŸã€‚</p><p><img src="https://segmentfault.com/img/bV72np?w=2478&amp;h=2229" alt="esmpic3"></p><p>è¿™ç§åšæ³•ä¹Ÿç¡®å®è¡Œä¹‹æœ‰æ•ˆï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†ä»¤äººçƒ¦æ¼çš„å½±å“ã€‚</p><blockquote><p>é¦–å…ˆï¼Œæ‰€æœ‰çš„ <code>script</code>å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºæ’åˆ—ï¼Œå¼€å‘è€…å¿…é¡»éå¸¸è°¨æ…åœ°ç¡®ä¿æ²¡æœ‰ä»»ä½•ä¸€ä¸ªè„šæœ¬æ’åˆ—é”™è¯¯ã€‚</p></blockquote><p>å¦‚æœæ’åˆ—é”™äº†ï¼Œé‚£ä¹ˆåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œåº”ç”¨å°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚å½“å‡½æ•°åœ¨å…¨å±€ä½œç”¨åŸŸå¯»æ‰¾ jQuery å˜é‡æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šæŠ›å‡ºå¼‚å¸¸é”™è¯¯ï¼Œå¹¶ä¸”åœæ­¢ç»§ç»­è¿è¡Œã€‚</p><p><img src="https://segmentfault.com/img/bV72oH?w=2478&amp;h=2229" alt="esmpic4"></p><p>è¿™åŒæ—¶ä¹Ÿä½¿å¾—ä»£ç çš„åæœŸç»´æŠ¤å˜å¾—å›°éš¾ã€‚<br>å®ƒä¼šä½¿å¾—ç§»é™¤æ—§ä»£ç æˆ–è€…è„šæœ¬æ ‡ç­¾å˜å¾—å……æ»¡ä¸ç¡®å®šæ€§ã€‚ä½ æ ¹æœ¬ä¸çŸ¥é“ç§»é™¤å®ƒä¼šå¸¦æ¥ä»€ä¹ˆå½±å“ã€‚<strong>ä»£ç ä¹‹é—´çš„ä¾èµ–æ˜¯ä¸é€æ˜çš„</strong>ã€‚ä»»ä½•å‡½æ•°éƒ½å¯èƒ½ä¾èµ–å…¨å±€ä½œç”¨åŸŸä¸­çš„ä»»ä½•å˜é‡ï¼Œä»¥è‡³äºä½ ä¹Ÿä¸çŸ¥é“å“ªä¸ªå‡½æ•°ä¾èµ–å“ªä¸ªè„šæœ¬ã€‚</p><h2 id="æ¨¡å—åŒ–çš„ä½œç”¨"><a href="#æ¨¡å—åŒ–çš„ä½œç”¨" class="headerlink" title="æ¨¡å—åŒ–çš„ä½œç”¨"></a>æ¨¡å—åŒ–çš„ä½œç”¨</h2><blockquote><p><strong>æ¨¡å—åŒ–ä¸ºä½ æä¾›äº†ä¸€ç§æ›´å¥½çš„æ–¹å¼æ¥ç»„ç»‡å˜é‡å’Œå‡½æ•°</strong>ã€‚ä½ å¯ä»¥æŠŠç›¸å…³çš„å˜é‡å’Œå‡½æ•°æ”¾åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªæ¨¡å—ã€‚</p></blockquote><p>è¿™ç§ç»„ç»‡æ–¹å¼ä¼šæŠŠå‡½æ•°å’Œå˜é‡æ”¾åœ¨<code>æ¨¡å—ä½œç”¨åŸŸ</code>ä¸­ã€‚æ¨¡å—ä¸­çš„å‡½æ•°å¯ä»¥é€šè¿‡<code>æ¨¡å—ä½œç”¨åŸŸæ¥å…±äº«å˜é‡</code>ã€‚</p><p>ä¸è¿‡ï¼Œä¸å‡½æ•°ä½œç”¨åŸŸä¸åŒçš„æ˜¯ï¼Œæ¨¡å—ä½œç”¨åŸŸè¿˜æä¾›äº†ä¸€ç§æš´éœ²å˜é‡ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨çš„æ–¹å¼ã€‚æ¨¡å—å¯ä»¥æ˜ç¡®åœ°æŒ‡å®šå“ªäº›å˜é‡ã€ç±»æˆ–å‡½æ•°å¯¹å¤–æš´éœ²ã€‚</p><p>å¯¹å¤–æš´éœ²çš„è¿‡ç¨‹ç§°ä¸º<strong>å¯¼å‡º</strong>ã€‚ä¸€æ—¦å¯¼å‡ºï¼Œå…¶ä»–æ¨¡å—å°±å¯ä»¥æ˜ç¡®åœ°å£°ç§°å®ƒä»¬ä¾èµ–è¿™äº›å¯¼å‡ºçš„å˜é‡ã€ç±»æˆ–è€…å‡½æ•°ã€‚</p><p><img src="https://segmentfault.com/img/bV72tP?w=2478&amp;h=2229" alt="esmpic5"></p><p>å› ä¸ºè¿™æ˜¯ä¸€ç§æ˜ç¡®çš„å…³ç³»ï¼Œæ‰€ä»¥ä½ å¯ä»¥å¾ˆç®€å•åœ°è¾¨åˆ«å“ªäº›ä»£ç èƒ½ç§»é™¤ï¼Œå“ªäº›ä¸èƒ½ç§»é™¤ã€‚</p><p>æ‹¥æœ‰äº†åœ¨æ¨¡å—ä¹‹é—´å¯¼å‡ºå’Œå¯¼å…¥å˜é‡çš„èƒ½åŠ›ä¹‹åï¼Œä½ å°±å¯ä»¥æŠŠä»£ç åˆ†å‰²æˆæ›´å°çš„ã€å¯ä»¥ç‹¬ç«‹è¿è¡Œåœ°ä»£ç å—äº†ã€‚ç„¶åï¼Œä½ å°±å¯ä»¥åƒæ­ä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼ŒåŸºäºè¿™äº›ä»£ç å—ï¼Œåˆ›å»ºæ‰€æœ‰ä¸åŒç±»å‹çš„åº”ç”¨ã€‚</p><p>ç”±äºæ¨¡å—åŒ–æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œæ‰€ä»¥å†å²ä¸Šæ›¾ç»å¤šæ¬¡å°è¯•ä¸º JS æ·»åŠ æ¨¡å—åŒ–çš„åŠŸèƒ½ã€‚ä¸è¿‡æˆªæ­¢åˆ°ç›®å‰ï¼ŒçœŸæ­£å¾—åˆ°å¹¿æ³›ä½¿ç”¨çš„åªæœ‰ä¸¤ä¸ªæ¨¡å—ç³»ç»Ÿã€‚<br>ä¸€ä¸ªæ˜¯ Node.js ä½¿ç”¨çš„ <code>CommonJS ï¼ˆCJSï¼‰</code>ï¼›å¦ä¸€ä¸ªæ˜¯ JS è§„èŒƒçš„æ–°æ¨¡å—ç³»ç»Ÿ <code>EcmaScript modulesï¼ˆESMï¼‰</code>ï¼ŒNode.js ä¹Ÿæ­£åœ¨æ·»åŠ å¯¹ ESM çš„æ”¯æŒã€‚</p><p>ä¸‹é¢å°±è®©æˆ‘ä»¬æ¥æ·±å…¥ç†è§£ä¸‹è¿™ä¸ªæ–°çš„æ¨¡å—ç³»ç»Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><h2 id="ESM-åŸç†"><a href="#ESM-åŸç†" class="headerlink" title="ESM åŸç†"></a>ESM åŸç†</h2><p>å½“ä½ åœ¨ä½¿ç”¨æ¨¡å—è¿›è¡Œå¼€å‘æ—¶ï¼Œå…¶å®æ˜¯åœ¨æ„å»ºä¸€å¼ <strong>ä¾èµ–å…³ç³»å›¾</strong>ã€‚ä¸åŒæ¨¡å—ä¹‹é—´çš„è¿çº¿å°±ä»£è¡¨äº†ä»£ç ä¸­çš„å¯¼å…¥è¯­å¥ã€‚</p><p>æ­£æ˜¯è¿™äº›å¯¼å…¥è¯­å¥å‘Šè¯‰æµè§ˆå™¨æˆ–è€… Node è¯¥å»åŠ è½½å“ªäº›ä»£ç ã€‚<br>æˆ‘ä»¬è¦åšçš„æ˜¯ä¸ºä¾èµ–å…³ç³»å›¾æŒ‡å®šä¸€ä¸ª<strong>å…¥å£æ–‡ä»¶</strong>ã€‚ä»è¿™ä¸ªå…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæµè§ˆå™¨æˆ–è€… Node å°±ä¼šé¡ºç€å¯¼å…¥è¯­å¥æ‰¾å‡ºæ‰€ä¾èµ–çš„å…¶ä»–ä»£ç æ–‡ä»¶ã€‚</p><p><img src="https://segmentfault.com/img/bV75dW?w=1861&amp;h=1082" alt="esmpic6"></p><p>ä½†æ˜¯å‘¢ï¼Œæµè§ˆå™¨å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™äº›ä»£ç æ–‡ä»¶ã€‚å®ƒéœ€è¦è§£ææ‰€æœ‰çš„æ–‡ä»¶ï¼Œå¹¶æŠŠå®ƒä»¬å˜æˆä¸€ç§ç§°ä¸º<code>æ¨¡å—è®°å½•ï¼ˆModule Recordï¼‰</code>çš„æ•°æ®ç»“æ„ã€‚åªæœ‰è¿™æ ·ï¼Œå®ƒæ‰çŸ¥é“ä»£ç æ–‡ä»¶ä¸­åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><p><img src="https://segmentfault.com/img/bV75fA?w=2545&amp;h=1462" alt="esmpic7"></p><p>è§£æä¹‹åï¼Œè¿˜éœ€è¦æŠŠæ¨¡å—è®°å½•å˜æˆä¸€ä¸ªæ¨¡å—å®ä¾‹ã€‚æ¨¡å—å®ä¾‹ä¼šæŠŠä»£ç å’ŒçŠ¶æ€ç»“åˆèµ·æ¥ã€‚</p><ul><li>æ‰€è°“ä»£ç ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ç»„æŒ‡ä»¤é›†åˆã€‚å®ƒå°±åƒæ˜¯åˆ¶ä½œæŸæ ·ä¸œè¥¿çš„é…æ–¹ï¼ŒæŒ‡å¯¼ä½ è¯¥å¦‚ä½•åˆ¶ä½œã€‚ä½†æ˜¯å®ƒæœ¬èº«å¹¶ä¸èƒ½è®©ä½ å®Œæˆåˆ¶ä½œã€‚ä½ è¿˜éœ€è¦ä¸€äº›åŸæ–™ï¼Œè¿™æ ·æ‰å¯ä»¥æŒ‰ç…§è¿™äº›æŒ‡ä»¤å®Œæˆåˆ¶ä½œã€‚</li><li>æ‰€è°“çŠ¶æ€ï¼Œå®ƒå°±æ˜¯åŸæ–™ã€‚å…·ä½“ç‚¹ï¼ŒçŠ¶æ€æ˜¯å˜é‡åœ¨ä»»ä½•æ—¶å€™çš„çœŸå®å€¼ã€‚å½“ç„¶ï¼Œå˜é‡å®é™…ä¸Šå°±æ˜¯å†…å­˜åœ°å€çš„åˆ«åï¼Œå†…å­˜æ‰æ˜¯æ­£åœ¨å­˜å‚¨å€¼çš„åœ°æ–¹ã€‚</li></ul><p>æ‰€ä»¥ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæ¨¡å—å®ä¾‹ä¸­ä»£ç å’ŒçŠ¶æ€çš„ç»“åˆï¼Œå°±æ˜¯<strong>æŒ‡ä»¤é›†å’Œå˜é‡å€¼çš„ç»“åˆ</strong>ã€‚</p><p><img src="https://segmentfault.com/img/bV75iE?w=3067&amp;h=2284" alt="esmpic8"></p><p>å¯¹äºæ¨¡å—è€Œè¨€ï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯<strong>æ¨¡å—å®ä¾‹</strong>ã€‚<br>æ¨¡å—åŠ è½½ä¼šä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæœ€ç»ˆç”Ÿæˆå®Œæ•´çš„æ¨¡å—å®ä¾‹å…³ç³»å›¾ã€‚</p><blockquote><p>å¯¹äº ESM ï¼Œè¿™ä¸ªè¿‡ç¨‹åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li>æ„å»ºï¼šæŸ¥æ‰¾ï¼Œä¸‹è½½ï¼Œç„¶åæŠŠæ‰€æœ‰æ–‡ä»¶è§£ææˆæ¨¡å—è®°å½•ã€‚</li><li>å®ä¾‹åŒ–ï¼šä¸ºæ‰€æœ‰æ¨¡å—åˆ†é…å†…å­˜ç©ºé—´ï¼ˆæ­¤åˆ»è¿˜æ²¡æœ‰å¡«å……å€¼ï¼‰ï¼Œç„¶åä¾ç…§å¯¼å‡ºã€å¯¼å…¥è¯­å¥æŠŠæ¨¡å—æŒ‡å‘å¯¹åº”çš„å†…å­˜åœ°å€ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºé“¾æ¥ï¼ˆLinkingï¼‰ã€‚</li><li>è¿è¡Œï¼šè¿è¡Œä»£ç ï¼Œä»è€ŒæŠŠå†…å­˜ç©ºé—´å¡«å……ä¸ºçœŸå®å€¼ã€‚</li></ul></blockquote><p><img src="https://segmentfault.com/img/bV75nE?w=9150&amp;h=3359" alt="esmpic9"></p><p>å¤§å®¶éƒ½è¯´ ESM æ˜¯å¼‚æ­¥çš„ã€‚<br>å› ä¸ºå®ƒæŠŠæ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºäº†ä¸‰ä¸ªä¸åŒçš„é˜¶æ®µï¼š<strong>åŠ è½½ã€å®ä¾‹åŒ–å’Œè¿è¡Œï¼Œå¹¶ä¸”è¿™ä¸‰ä¸ªé˜¶æ®µæ˜¯å¯ä»¥ç‹¬ç«‹è¿›è¡Œçš„</strong>ã€‚</p><p>è¿™æ„å‘³ç€ï¼ŒESM è§„èŒƒç¡®å®å¼•å…¥äº†ä¸€ç§å¼‚æ­¥æ–¹å¼ï¼Œä¸”è¿™ç§å¼‚æ­¥æ–¹å¼åœ¨ CJS ä¸­æ˜¯æ²¡æœ‰çš„ã€‚<br>åé¢æˆ‘ä»¬ä¼šè¯¦ç»†è¯´åˆ°ä¸ºä»€ä¹ˆï¼Œç„¶è€Œåœ¨ CJS ä¸­ï¼Œä¸€ä¸ªæ¨¡å—åŠå…¶ä¾èµ–çš„åŠ è½½ã€å®ä¾‹åŒ–å’Œè¿è¡Œæ˜¯ä¸€èµ·é¡ºåºæ‰§è¡Œçš„ï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•é—´æ–­ã€‚</p><p>ä¸è¿‡ï¼Œè¿™ä¸‰ä¸ªé˜¶æ®µæœ¬èº«æ˜¯æ²¡å¿…è¦å¼‚æ­¥åŒ–ã€‚å®ƒä»¬å¯ä»¥åŒæ­¥æ‰§è¡Œï¼Œè¿™å–å†³äºå®ƒæ˜¯<strong>ç”±è°æ¥åŠ è½½çš„</strong>ã€‚å› ä¸º ESM æ ‡å‡†å¹¶æ²¡æœ‰æ˜ç¡®è§„èŒƒæ‰€æœ‰ç›¸å…³å†…å®¹ã€‚å®é™…ä¸Šï¼Œè¿™äº›å·¥ä½œåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå¹¶ä¸”åˆ†åˆ«æ˜¯ç”±ä¸åŒçš„æ ‡å‡†æ‰€è§„èŒƒçš„ã€‚</p><p>å…¶ä¸­ï¼Œ<a href="https://tc39.github.io/ecma262/#sec-modules" target="_blank" rel="noopener">ESM æ ‡å‡†</a> è§„èŒƒäº†å¦‚ä½•æŠŠæ–‡ä»¶è§£æä¸ºæ¨¡å—è®°å½•ï¼Œå¦‚ä½•å®ä¾‹åŒ–å’Œå¦‚ä½•è¿è¡Œæ¨¡å—ã€‚ä½†æ˜¯å®ƒæ²¡æœ‰è§„èŒƒå¦‚ä½•è·å–æ–‡ä»¶ã€‚</p><p>æ–‡ä»¶æ˜¯ç”±<code>åŠ è½½å™¨</code>æ¥æå–çš„ï¼Œè€ŒåŠ è½½å™¨ç”±å¦ä¸€ä¸ªä¸åŒçš„æ ‡å‡†æ‰€è§„èŒƒã€‚å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œè¿™ä¸ªæ ‡å‡†å°±æ˜¯<code>HTML</code>ã€‚ä½†æ˜¯ä½ è¿˜å¯ä»¥æ ¹æ®æ‰€ä½¿ç”¨çš„å¹³å°ä½¿ç”¨ä¸åŒçš„åŠ è½½å™¨ã€‚</p><p><img src="https://segmentfault.com/img/bV78qI?w=3576&amp;h=2044" alt="esmpic10"></p><p>åŠ è½½å™¨ä¹ŸåŒæ—¶æ§åˆ¶ç€å¦‚ä½•åŠ è½½æ¨¡å—ã€‚å®ƒä¼šè°ƒç”¨ ESM çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ <code>ParseModuleã€Module.Instantiate å’Œ Module.Evaluate</code> ã€‚å®ƒå°±åƒæ˜¯æ§åˆ¶ç€ JS å¼•æ“çš„æœ¨å¶ã€‚</p><p><img src="https://segmentfault.com/img/bV78ta?w=2779&amp;h=1835" alt="esmpic11"></p><p>ä¸‹é¢æˆ‘ä»¬å°†æ›´åŠ è¯¦ç»†åœ°è¯´æ˜æ¯ä¸€æ­¥ã€‚</p><h3 id="æ„å»º"><a href="#æ„å»º" class="headerlink" title="æ„å»º"></a>æ„å»º</h3><blockquote><p>å¯¹äºæ¯ä¸ªæ¨¡å—ï¼Œåœ¨æ„å»ºé˜¶æ®µä¼šåšä¸‰ä¸ªå¤„ç†ï¼š</p></blockquote><ul><li>ç¡®å®šè¦ä»å“ªé‡Œä¸‹è½½åŒ…å«è¯¥æ¨¡å—çš„æ–‡ä»¶ï¼Œä¹Ÿç§°ä¸º<code>æ¨¡å—å®šä½ï¼ˆModule Resolutionï¼‰</code></li><li>æå–æ–‡ä»¶ï¼Œé€šè¿‡ä» URL ä¸‹è½½æˆ–è€…ä»æ–‡ä»¶ç³»ç»ŸåŠ è½½</li><li>è§£ææ–‡ä»¶ä¸ºæ¨¡å—è®°å½•</li></ul><h4 id="ä¸‹è½½æ¨¡å—"><a href="#ä¸‹è½½æ¨¡å—" class="headerlink" title="ä¸‹è½½æ¨¡å—"></a>ä¸‹è½½æ¨¡å—</h4><p>åŠ è½½å™¨è´Ÿè´£å®šä½æ–‡ä»¶å¹¶ä¸”æå–ã€‚é¦–å…ˆï¼Œå®ƒéœ€è¦æ‰¾åˆ°å…¥å£æ–‡ä»¶ã€‚åœ¨ HTML ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ <code>&lt;script&gt;</code> æ ‡ç­¾æ¥å‘Šè¯‰åŠ è½½å™¨ã€‚</p><p><img src="https://segmentfault.com/img/bV78vT?w=2080&amp;h=780" alt="esmpic12"></p><p>ä½†æ˜¯ï¼ŒåŠ è½½å™¨è¦å¦‚ä½•å®šä½ <code>main.js</code> ç›´æ¥ä¾èµ–çš„æ¨¡å—å‘¢ï¼Ÿ<br>è¿™ä¸ªæ—¶å€™å¯¼å…¥è¯­å¥å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å¯¼å…¥è¯­å¥ä¸­æœ‰ä¸€éƒ¨åˆ†ç§°ä¸º<code>æ¨¡å—å®šä½ç¬¦ï¼ˆModule Specifierï¼‰</code>ï¼Œå®ƒä¼šå‘Šè¯‰åŠ è½½å™¨å»å“ªå®šä½æ¨¡å—ã€‚</p><p><img src="https://segmentfault.com/img/bV78wX?w=2821&amp;h=590" alt="esmpic13"></p><p>å¯¹äºæ¨¡å—å®šä½ç¬¦ï¼Œæœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼šå®ƒä»¬åœ¨æµè§ˆå™¨å’Œ Node ä¸­ä¼šæœ‰ä¸åŒçš„å¤„ç†ã€‚æ¯ä¸ªå¹³å°éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—æ–¹å¼æ¥è§£ææ¨¡å—å®šä½ç¬¦ã€‚è¿™äº›æ–¹å¼ç§°ä¸º<code>æ¨¡å—å®šä½ç®—æ³•</code>ï¼Œä¸åŒçš„å¹³å°ä¼šä½¿ç”¨ä¸åŒçš„æ¨¡å—å®šä½ç®—æ³•ã€‚<br>å½“å‰ï¼Œä¸€äº›åœ¨ Node ä¸­èƒ½å·¥ä½œæ¨¡å—å®šä½ç¬¦å¹¶ä¸èƒ½åœ¨æµè§ˆå™¨ä¸­å·¥ä½œï¼Œä½†æ˜¯å·²ç»æœ‰ä¸€é¡¹å·¥ä½œæ­£åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>åœ¨è¿™ä¸ªé—®é¢˜è¢«è§£å†³ä¹‹å‰ï¼Œæµè§ˆå™¨åªæ¥å— URL ä½œä¸ºæ¨¡å—å®šä½ç¬¦ã€‚<br>å®ƒä»¬ä¼šä» URL åŠ è½½æ¨¡å—æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ˜¯åœ¨æ•´ä¸ªå…³ç³»å›¾ä¸ŠåŒæ—¶å‘ç”Ÿçš„ã€‚å› ä¸ºåœ¨è§£æå®Œè¿™ä¸ªæ¨¡å—ä¹‹å‰ï¼Œä½ æ ¹æœ¬ä¸çŸ¥é“å®ƒä¾èµ–å“ªäº›æ¨¡å—ã€‚è€Œä¸”åœ¨å®ƒä¸‹è½½å®Œæˆä¹‹å‰ï¼Œä½ ä¹Ÿæ— æ³•è§£æå®ƒã€‚</p><p>è¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬å¿…é¡»ä¸€å±‚å±‚éå†ä¾èµ–æ ‘ï¼Œå…ˆè§£ææ–‡ä»¶ï¼Œç„¶åæ‰¾å‡ºä¾èµ–ï¼Œæœ€ååˆå®šä½å¹¶åŠ è½½è¿™äº›ä¾èµ–ï¼Œå¦‚æ­¤å¾€å¤ã€‚</p><p><img src="https://segmentfault.com/img/bV78z4?w=4084&amp;h=2467" alt="esmpic14"></p><p>å¦‚æœä¸»çº¿ç¨‹æ­£åœ¨ç­‰å¾…è¿™äº›æ¨¡å—æ–‡ä»¶ä¸‹è½½å®Œæˆï¼Œè®¸å¤šå…¶ä»–ä»»åŠ¡å°†ä¼šå †ç§¯åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œé€ æˆé˜»å¡ã€‚è¿™æ˜¯å› ä¸ºåœ¨æµè§ˆå™¨ä¸­ï¼Œä¸‹è½½ä¼šè€—è´¹å¤§é‡çš„æ—¶é—´ã€‚</p><p><img src="https://segmentfault.com/img/bV78AB?w=500&amp;h=270" alt="esmpic15"></p><p>è€Œé˜»å¡ä¸»çº¿ç¨‹ä¼šä½¿å¾—åº”ç”¨å˜å¾—å¡é¡¿ï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚è¿™æ˜¯ ESM æ ‡å‡†æŠŠç®—æ³•åˆ†æˆå¤šä¸ªé˜¶æ®µçš„åŸå› ä¹‹ä¸€ã€‚å°†æ„å»ºåˆ’åˆ†ä¸ºä¸€ä¸ªç‹¬ç«‹é˜¶æ®µåï¼Œæµè§ˆå™¨å¯ä»¥åœ¨è¿›å…¥åŒæ­¥çš„å®ä¾‹åŒ–è¿‡ç¨‹ä¹‹å‰ä¸‹è½½æ–‡ä»¶ç„¶åç†è§£æ¨¡å—å…³ç³»å›¾ã€‚</p><blockquote><p>ESM å’Œ CJS ä¹‹é—´æœ€ä¸»è¦çš„åŒºåˆ«ä¹‹ä¸€å°±æ˜¯ï¼ŒESM æŠŠç®—æ³•åŒ–ä¸ºä¸ºå¤šä¸ªé˜¶æ®µã€‚</p></blockquote><p>CJS ä½¿ç”¨ä¸åŒçš„ç®—æ³•æ˜¯å› ä¸ºå®ƒä»æ–‡ä»¶ç³»ç»ŸåŠ è½½æ–‡ä»¶ï¼Œè¿™è€—è´¹çš„æ—¶é—´è¿œè¿œå°äºä»ç½‘ç»œä¸Šä¸‹è½½ã€‚å› æ­¤ Node åœ¨åŠ è½½æ–‡ä»¶çš„æ—¶å€™å¯ä»¥é˜»å¡ä¸»çº¿ç¨‹ï¼Œè€Œä¸é€ æˆå¤ªå¤§å½±å“ã€‚è€Œä¸”æ—¢ç„¶æ–‡ä»¶å·²ç»åŠ è½½å®Œæˆäº†ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥ç›´æ¥è¿›è¡Œå®ä¾‹åŒ–å’Œè¿è¡Œã€‚æ‰€ä»¥åœ¨ CJS ä¸­å®ä¾‹åŒ–å’Œè¿è¡Œå¹¶ä¸æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„é˜¶æ®µã€‚</p><p>è¿™ä¹Ÿæ„å‘³ç€ï¼Œ<strong>ä½ å¯ä»¥åœ¨è¿”å›æ¨¡å—å®ä¾‹ä¹‹å‰ï¼Œé¡ºç€æ•´é¢—ä¾èµ–æ ‘å»é€ä¸€åŠ è½½ã€å®ä¾‹åŒ–å’Œè¿è¡Œæ¯ä¸€ä¸ªä¾èµ–</strong>ã€‚</p><p><img src="https://segmentfault.com/img/bV78PU?w=3045&amp;h=1813" alt="esmpic16"></p><p>CJS çš„æ–¹å¼å¯¹ ESM ä¹Ÿæœ‰ä¸€äº›å¯å‘ï¼Œè¿™ä¸ªåé¢ä¼šè§£é‡Šã€‚<br>å…¶ä¸­ä¸€ä¸ªå°±æ˜¯ï¼Œåœ¨ Node çš„ CJS ä¸­ï¼Œä½ å¯ä»¥åœ¨æ¨¡å—å®šä½ç¬¦ä¸­ä½¿ç”¨å˜é‡ã€‚å› ä¸ºå·²ç»æ‰§è¡Œäº† require ä¹‹å‰çš„ä»£ç ï¼Œæ‰€ä»¥æ¨¡å—å®šä½ç¬¦ä¸­çš„å˜é‡æ­¤åˆ»æ˜¯æœ‰å€¼çš„ï¼Œè¿™æ ·å°±å¯ä»¥è¿›è¡Œæ¨¡å—å®šä½çš„å¤„ç†äº†ã€‚</p><p>ä½†æ˜¯å¯¹äº ESMï¼Œåœ¨è¿è¡Œä»»ä½•ä»£ç ä¹‹å‰ï¼Œä½ é¦–å…ˆéœ€è¦å»ºç«‹æ•´ä¸ªæ¨¡å—ä¾èµ–çš„å…³ç³»å›¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å»ºç«‹å…³ç³»å›¾æ—¶å˜é‡æ˜¯è¿˜æ²¡æœ‰å€¼</strong>çš„ï¼Œå› ä¸ºä»£ç éƒ½è¿˜æ²¡è¿è¡Œã€‚</p><p><img src="https://segmentfault.com/img/bV78Ss?w=2827&amp;h=827" alt="esmpic17"></p><p>ä¸è¿‡å‘¢ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ç¡®å®éœ€è¦åœ¨æ¨¡å—å®šä½ç¬¦ä¸­ä½¿ç”¨å˜é‡ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®å½“å‰çš„çŠ¶å†µåŠ è½½ä¸åŒçš„ä¾èµ–ã€‚</p><p>ä¸ºäº†åœ¨ ESM ä¸­å®ç°è¿™ç§æ–¹å¼ï¼Œäººä»¬å·²ç»æå‡ºäº†ä¸€ä¸ª<em>åŠ¨æ€å¯¼å…¥</em>ææ¡ˆã€‚è¯¥ææ¡ˆå…è®¸ä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼ <code>import(\</code>${path}/foo.js<code>)</code>çš„å¯¼å…¥è¯­å¥ã€‚</p><p>è¿™ç§æ–¹å¼å®é™…ä¸Šæ˜¯æŠŠä½¿ç”¨ <code>import()</code> åŠ è½½çš„æ–‡ä»¶å½“æˆäº†ä¸€ä¸ªå…¥å£æ–‡ä»¶ã€‚åŠ¨æ€å¯¼å…¥çš„æ¨¡å—ä¼šå¼€å¯ä¸€ä¸ªå…¨æ–°çš„ç‹¬ç«‹ä¾èµ–å…³ç³»æ ‘ã€‚</p><p><img src="https://segmentfault.com/img/bV78TU?w=2952&amp;h=2294" alt="esmpic18"></p><p>ä¸è¿‡æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™<code>ä¸¤æ£µä¾èµ–å…³ç³»æ ‘å…±æœ‰çš„æ¨¡å—ä¼šå…±äº«åŒä¸€ä¸ªæ¨¡å—å®ä¾‹</code>ã€‚è¿™æ˜¯å› ä¸ºåŠ è½½å™¨ä¼šç¼“å­˜æ¨¡å—å®ä¾‹ã€‚åœ¨ç‰¹å®šçš„å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œæ¯ä¸ªæ¨¡å—åªä¼šæœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„æ¨¡å—å®ä¾‹ã€‚</p><p>è¿™ç§æ–¹å¼æœ‰åŠ©äºæé«˜ JS å¼•æ“çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¨¡å—æ–‡ä»¶åªä¼šè¢«ä¸‹è½½ä¸€æ¬¡ï¼Œå³ä½¿æœ‰å¤šä¸ªæ¨¡å—ä¾èµ–å®ƒã€‚è¿™ä¹Ÿæ˜¯ç¼“å­˜æ¨¡å—çš„åŸå› ä¹‹ä¸€ï¼Œåé¢è¯´åˆ°è¿è¡Œçš„æ—¶å€™ä¼šä»‹ç»å¦ä¸€ä¸ªåŸå› ã€‚</p><p>åŠ è½½å™¨ä½¿ç”¨<code>æ¨¡å—æ˜ å°„ï¼ˆModule Mapï¼‰</code>æ¥ç®¡ç†ç¼“å­˜ã€‚æ¯ä¸ªå…¨å±€ä½œç”¨åŸŸéƒ½åœ¨ä¸€ä¸ªå•ç‹¬çš„æ¨¡å—æ˜ å°„ä¸­è·Ÿè¸ªå…¶æ¨¡å—ã€‚</p><p>å½“åŠ è½½å™¨è¦ä»ä¸€ä¸ª URL åŠ è½½æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šæŠŠ URL è®°å½•åˆ°æ¨¡å—æ˜ å°„ä¸­ï¼Œå¹¶æŠŠå®ƒæ ‡è®°ä¸ºæ­£åœ¨ä¸‹è½½çš„æ–‡ä»¶ã€‚ç„¶åå®ƒä¼šå‘å‡ºè¿™ä¸ªæ–‡ä»¶è¯·æ±‚å¹¶ç»§ç»­å¼€å§‹è·å–ä¸‹ä¸€ä¸ªæ–‡ä»¶ã€‚</p><p><img src="https://segmentfault.com/img/bV785X?w=3221&amp;h=1096" alt="esmpic18"></p><p>å½“å…¶ä»–æ¨¡å—ä¹Ÿä¾èµ–è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼ŸåŠ è½½å™¨ä¼šæŸ¥æ‰¾æ¨¡å—æ˜ å°„ä¸­çš„æ¯ä¸€ä¸ª URL ã€‚å¦‚æœå‘ç° URL çš„çŠ¶æ€ä¸ºæ­£åœ¨ä¸‹è½½ï¼Œåˆ™ä¼šè·³è¿‡è¯¥ URL ï¼Œç„¶åå¼€å§‹ä¸‹ä¸€ä¸ªä¾èµ–çš„å¤„ç†ã€‚</p><p>ä¸è¿‡ï¼Œæ¨¡å—æ˜ å°„çš„ä½œç”¨å¹¶ä¸ä»…ä»…æ˜¯è®°å½•å“ªäº›æ–‡ä»¶å·²ç»ä¸‹è½½ã€‚ä¸‹é¢æˆ‘ä»¬å°†ä¼šçœ‹åˆ°ï¼Œæ¨¡å—æ˜ å°„ä¹Ÿå¯ä»¥ä½œä¸ºæ¨¡å—çš„ç¼“å­˜ã€‚</p><h4 id="è§£ææ¨¡å—"><a href="#è§£ææ¨¡å—" class="headerlink" title="è§£ææ¨¡å—"></a>è§£ææ¨¡å—</h4><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†æ¨¡å—æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒè§£æä¸ºæ¨¡å—è®°å½•ã€‚<br>è¿™æœ‰åŠ©äºæµè§ˆå™¨ç†è§£æ¨¡å—çš„ä¸åŒéƒ¨åˆ†ã€‚</p><p><img src="https://segmentfault.com/img/bV789W?w=3670&amp;h=1462" alt="esmpic19"></p><p>ä¸€æ—¦æ¨¡å—è®°å½•åˆ›å»ºå®Œæˆï¼Œå®ƒå°±ä¼šè¢«è®°å½•åœ¨<code>æ¨¡å—æ˜ å°„</code>ä¸­ã€‚æ‰€ä»¥ï¼Œåç»­ä»»ä½•æ—¶å€™å†æ¬¡è¯·æ±‚è¿™ä¸ªæ¨¡å—æ—¶ï¼ŒåŠ è½½å™¨å°±å¯ä»¥ç›´æ¥ä»<code>æ¨¡å—æ˜ å°„</code>ä¸­è·å–è¯¥æ¨¡å—ã€‚</p><p><img src="https://segmentfault.com/img/bV79aU?w=3196&amp;h=1527" alt="esmpic20"></p><p>è§£æè¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªçœ‹ä¼¼å¾®ä¸è¶³é“çš„ç»†èŠ‚ï¼Œä½†æ˜¯å®é™…é€ æˆçš„å½±å“å´å¾ˆå¤§ã€‚é‚£å°±æ˜¯æ‰€æœ‰çš„æ¨¡å—éƒ½æŒ‰ç…§<strong>ä¸¥æ ¼æ¨¡å¼</strong>æ¥è§£æçš„ã€‚<br>ä¹Ÿè¿˜æœ‰å…¶ä»–çš„å°ç»†èŠ‚ï¼Œæ¯”å¦‚ï¼Œå…³é”®å­— <code>await</code> åœ¨æ¨¡å—çš„æœ€é¡¶å±‚æ˜¯ä¿ç•™å­—ï¼Œ <code>this</code> çš„å€¼ä¸º <code>undefinded</code>ã€‚</p><p>è¿™ç§ä¸åŒçš„è§£ææ–¹å¼ç§°ä¸ºè§£æç›®æ ‡ï¼ˆParse Goalï¼‰ã€‚å¦‚æœæŒ‰ç…§ä¸åŒçš„è§£æç›®æ ‡æ¥è§£æç›¸åŒçš„æ–‡ä»¶ï¼Œä¼šå¾—åˆ°ä¸åŒçš„ç»“æœã€‚å› æ­¤ï¼Œåœ¨è§£ææ–‡ä»¶ä¹‹å‰ï¼Œå¿…é¡»æ¸…æ¥šåœ°çŸ¥é“æ‰€è§£æçš„æ–‡ä»¶ç±»å‹æ˜¯ä»€ä¹ˆï¼Œä¸ç®¡å®ƒæ˜¯ä¸æ˜¯ä¸€ä¸ªæ¨¡å—æ–‡ä»¶ã€‚</p><p>åœ¨æµè§ˆå™¨ä¸­ï¼ŒçŸ¥é“æ–‡ä»¶ç±»å‹æ˜¯å¾ˆç®€å•çš„ã€‚åªéœ€è¦åœ¨ <code>&lt;script&gt;</code> è„šæœ¬ä¸­æ·»åŠ  type=â€moduleâ€ å±æ€§å³å¯ã€‚è¿™å‘Šè¯‰æµè§ˆå™¨è¿™ä¸ªæ–‡ä»¶éœ€è¦è¢«è§£æä¸ºä¸€ä¸ªæ¨¡å—ã€‚è€Œä¸”ï¼Œå› ä¸ºåªæœ‰æ¨¡å—æ‰èƒ½è¢«å¯¼å…¥ï¼Œæ‰€ä»¥æµè§ˆå™¨ä»¥æ­¤æ¨æµ‹æ‰€æœ‰çš„å¯¼å…¥ä¹Ÿéƒ½æ˜¯æ¨¡å—æ–‡ä»¶ã€‚</p><p><img src="https://segmentfault.com/img/bV79fk?w=2700&amp;h=1677" alt="esmpic21"></p><p>ä¸è¿‡åœ¨ Node ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸ä½¿ç”¨ <code>HTML</code> æ ‡ç­¾ï¼Œæ‰€ä»¥ä¹Ÿæ²¡åŠæ³•é€šè¿‡ <code>type</code> å±æ€§æ¥è¾¨åˆ«ã€‚ç¤¾åŒºæå‡ºä¸€ç§è§£å†³åŠæ³•æ˜¯ä½¿ç”¨ <code>.mjs</code> æ‹“å±•åã€‚ä½¿ç”¨è¯¥æ‹“å±•åä¼šå‘Šè¯‰ Node è¯´â€œè¿™æ˜¯ä¸ªæ¨¡å—æ–‡ä»¶â€ã€‚ä½ ä¼šçœ‹åˆ°å¤§å®¶æ­£åœ¨è®¨è®ºæŠŠè¿™ä¸ªä½œä¸ºè§£æç›®æ ‡ã€‚ä¸è¿‡è®¨è®ºä»åœ¨ç»§ç»­ï¼Œæ‰€ä»¥ç›®å‰ä»ä¸æ˜ç¡® Node ç¤¾åŒºæœ€ç»ˆä¼šé‡‡ç”¨å“ªç§æ–¹å¼ã€‚</p><p>æ— è®ºæœ€ç»ˆä½¿ç”¨å“ªç§æ–¹å¼ï¼ŒåŠ è½½å™¨éƒ½ä¼šå†³å®šæ˜¯å¦æŠŠä¸€ä¸ªæ–‡ä»¶ä½œä¸ºæ¨¡å—æ¥è§£æã€‚å¦‚æœæ˜¯æ¨¡å—ï¼Œè€Œä¸”åŒ…å«å¯¼å…¥è¯­å¥ï¼Œé‚£å®ƒä¼šé‡æ–°å¼€å§‹å¤„ç†ç›´è‡³æ‰€æœ‰çš„æ–‡ä»¶éƒ½å·²æå–å’Œè§£æã€‚</p><p>åˆ°è¿™é‡Œï¼Œæ„å»ºé˜¶æ®µå·®ä¸å¤šå°±å®Œæˆäº†ã€‚åœ¨åŠ è½½è¿‡ç¨‹å¤„ç†å®Œæˆåï¼Œä½ å·²ç»ä»æœ€å¼€å§‹åªæœ‰ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œåˆ°ç°åœ¨å¾—åˆ°äº†ä¸€å †æ¨¡å—è®°å½•ã€‚</p><p><img src="https://segmentfault.com/img/bV79h6?w=2561&amp;h=2080" alt="esmpic22"></p><p>ä¸‹ä¸€æ­¥ä¼šå®ä¾‹åŒ–è¿™äº›æ¨¡å—å¹¶ä¸”æŠŠæ‰€æœ‰çš„å®ä¾‹é“¾æ¥èµ·æ¥ã€‚</p><h4 id="å®ä¾‹åŒ–"><a href="#å®ä¾‹åŒ–" class="headerlink" title="å®ä¾‹åŒ–"></a>å®ä¾‹åŒ–</h4><p>æ­£å¦‚å‰æ–‡æ‰€è¿°ï¼Œä¸€ä¸ªæ¨¡å—å®ä¾‹ç»“åˆäº†ä»£ç å’ŒçŠ¶æ€ã€‚çŠ¶æ€å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥å®ä¾‹åŒ–çš„è¿‡ç¨‹å°±æ˜¯æŠŠæ‰€æœ‰å€¼å†™å…¥å†…å­˜çš„è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆï¼ŒJS å¼•æ“ä¼šåˆ›å»ºä¸€ä¸ªÂ·æ¨¡å—ç¯å¢ƒè®°å½•ï¼ˆModule Environment Recordï¼‰Â·ã€‚å®ƒç®¡ç†ç€æ¨¡å—è®°å½•çš„æ‰€æœ‰å˜é‡ã€‚ç„¶åï¼Œå¼•æ“ä¼šæ‰¾å‡ºå¤šæœ‰å¯¼å‡ºåœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚<strong>æ¨¡å—ç¯å¢ƒè®°å½•ä¼šè·Ÿè¸ªæ¯ä¸ªå¯¼å‡ºå¯¹åº”äºå“ªä¸ªå†…å­˜åœ°å€</strong>ã€‚</p><p>è¿™äº›å†…å­˜åœ°å€æ­¤æ—¶è¿˜æ²¡æœ‰å€¼ï¼Œåªæœ‰ç­‰åˆ°è¿è¡Œåå®ƒä»¬æ‰ä¼šè¢«å¡«å……ä¸Šå®é™…å€¼ã€‚æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œæ‰€æœ‰å¯¼å‡ºçš„å‡½æ•°å£°æ˜éƒ½åœ¨è¿™ä¸ªé˜¶æ®µåˆå§‹åŒ–ï¼Œè¿™ä¼šä½¿å¾—åé¢çš„è¿è¡Œé˜¶æ®µå˜å¾—æ›´åŠ ç®€å•ã€‚</p><p>ä¸ºäº†å®ä¾‹åŒ–æ¨¡å—å…³ç³»å›¾ï¼Œå¼•æ“ä¼šé‡‡ç”¨<code>æ·±åº¦ä¼˜å…ˆ</code>çš„ååºéå†æ–¹å¼ã€‚<br>å³ï¼Œå®ƒä¼šé¡ºç€å…³ç³»å›¾åˆ°è¾¾æœ€åº•ç«¯æ²¡æœ‰ä»»ä½•ä¾èµ–çš„æ¨¡å—ï¼Œç„¶åè®¾ç½®å®ƒä»¬çš„å¯¼å‡ºã€‚</p><p><img src="https://segmentfault.com/img/bV8cbJ?w=6086&amp;h=2505" alt="esmpic23"></p><p>æœ€ç»ˆï¼Œå¼•æ“ä¼šæŠŠæ¨¡å—ä¸‹çš„æ‰€æœ‰ä¾èµ–å¯¼å‡ºé“¾æ¥åˆ°å½“å‰æ¨¡å—ã€‚ç„¶åå›åˆ°ä¸Šä¸€å±‚æŠŠæ¨¡å—çš„å¯¼å…¥é“¾æ¥èµ·æ¥ã€‚</p><p><img src="https://segmentfault.com/img/bV8ccp?w=6086&amp;h=2505" alt="esmpic24"></p><p>è¿™ä¸ªè¿‡ç¨‹è·Ÿ CJS æ˜¯ä¸åŒçš„ã€‚åœ¨ CJS ä¸­ï¼Œæ•´ä¸ªå¯¼å‡ºå¯¹è±¡åœ¨å¯¼å‡ºæ—¶éƒ½æ˜¯<code>å€¼æ‹·è´</code>ã€‚<br>å³ï¼Œæ‰€æœ‰çš„å¯¼å‡ºå€¼éƒ½æ˜¯<code>æ‹·è´å€¼</code>ï¼Œè€Œ<code>ä¸æ˜¯å¼•ç”¨</code>ã€‚<br>æ‰€ä»¥ï¼Œå¦‚æœå¯¼å‡ºæ¨¡å—å†…å¯¼å‡ºçš„å€¼æ”¹å˜äº†ï¼Œå¯¼å…¥æ¨¡å—ä¸­å¯¼å…¥çš„å€¼ä¹Ÿä¸ä¼šæ”¹å˜ã€‚</p><p><img src="https://segmentfault.com/img/bV8cde?w=3426&amp;h=776" alt="esmpic25"></p><p>ç›¸åï¼ŒESM åˆ™ä½¿ç”¨ç§°ä¸º<code>å®æ—¶ç»‘å®šï¼ˆLive Bindingï¼‰</code>çš„æ–¹å¼ã€‚å¯¼å‡ºå’Œå¯¼å…¥çš„æ¨¡å—éƒ½æŒ‡å‘ç›¸åŒçš„å†…å­˜åœ°å€ï¼ˆå³<code>å€¼å¼•ç”¨</code>ï¼‰ã€‚æ‰€ä»¥ï¼Œå½“å¯¼å‡ºæ¨¡å—å†…å¯¼å‡ºçš„å€¼æ”¹å˜åï¼Œå¯¼å…¥æ¨¡å—ä¸­çš„å€¼ä¹Ÿå®æ—¶æ”¹å˜äº†ã€‚</p><p>æ¨¡å—å¯¼å‡ºçš„å€¼åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥èƒ½å‘ç”Ÿæ”¹å˜ï¼Œä½†æ˜¯å¯¼å…¥æ¨¡å—å´ä¸èƒ½æ”¹å˜å®ƒæ‰€å¯¼å…¥çš„å€¼ï¼Œå› ä¸ºå®ƒæ˜¯åªè¯»çš„ã€‚<br>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—å¯¼å…¥äº†ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå®ƒåªèƒ½æ”¹å˜è¯¥å¯¹è±¡çš„å±æ€§ï¼Œè€Œä¸èƒ½æ”¹å˜å¯¹è±¡æœ¬èº«ã€‚</p><p><img src="https://segmentfault.com/img/bV8cd7?w=6086&amp;h=2505" alt="esmpic25"></p><p>ESM é‡‡ç”¨è¿™ç§å®æ—¶ç»‘å®šçš„åŸå› æ˜¯ï¼Œå¼•æ“å¯ä»¥åœ¨ä¸è¿è¡Œä»»ä½•æ¨¡å—ä»£ç çš„æƒ…å†µä¸‹å®Œæˆé“¾æ¥ã€‚åé¢ä¼šè§£é‡Šåˆ°ï¼Œè¿™å¯¹è§£å†³è¿è¡Œé˜¶æ®µçš„å¾ªç¯ä¾èµ–é—®é¢˜ä¹Ÿæ˜¯æœ‰å¸®åŠ©çš„ã€‚</p><p>å®ä¾‹åŒ–é˜¶æ®µå®Œæˆåï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ‰€æœ‰æ¨¡å—å®ä¾‹ï¼Œä»¥åŠå·²å®Œæˆé“¾æ¥çš„å¯¼å…¥ã€å¯¼å‡ºå€¼ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹è¿è¡Œä»£ç å¹¶ä¸”å¾€å†…å­˜ç©ºé—´å†…å¡«å……å€¼äº†ã€‚</p><h4 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h4><p>æœ€åä¸€æ­¥æ˜¯å¾€å·²ç”³è¯·å¥½çš„å†…å­˜ç©ºé—´ä¸­å¡«å…¥çœŸå®å€¼ã€‚JS å¼•æ“é€šè¿‡è¿è¡Œé¡¶å±‚ä»£ç ï¼ˆå‡½æ•°å¤–çš„ä»£ç ï¼‰æ¥å®Œæˆå¡«å……ã€‚</p><p>é™¤äº†å¡«å……å€¼ä»¥å¤–ï¼Œè¿è¡Œä»£ç ä¹Ÿä¼šå¼•å‘ä¸€äº›å‰¯ä½œç”¨ï¼ˆSide Effectï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¨¡å—å¯èƒ½ä¼šå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚</p><p><img src="https://segmentfault.com/img/bV8ce1?w=2412&amp;h=705" alt="esmpic26"></p><p>å› ä¸ºè¿™äº›æ½œåœ¨å‰¯ä½œç”¨çš„å­˜åœ¨ï¼Œæ‰€ä»¥<em>æ¨¡å—ä»£ç åªèƒ½è¿è¡Œä¸€æ¬¡</em>ã€‚<br>å‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œå®ä¾‹åŒ–é˜¶æ®µä¸­å‘ç”Ÿçš„é“¾æ¥å¯ä»¥å¤šæ¬¡è¿›è¡Œï¼Œå¹¶ä¸”æ¯æ¬¡çš„ç»“æœéƒ½ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¿è¡Œé˜¶æ®µè¿›è¡Œå¤šæ¬¡çš„è¯ï¼Œåˆ™å¯èƒ½ä¼šæ¯æ¬¡éƒ½å¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚</p><p>è¿™æ­£æ˜¯ä¸ºä»€ä¹ˆä¼šä½¿ç”¨<code>æ¨¡å—æ˜ å°„</code>çš„åŸå› ä¹‹ä¸€ã€‚æ¨¡å—æ˜ å°„ä¼šä»¥ <code>URL</code> ä¸ºç´¢å¼•æ¥ç¼“å­˜æ¨¡å—ï¼Œä»¥ç¡®ä¿æ¯ä¸ªæ¨¡å—åªæœ‰ä¸€ä¸ªæ¨¡å—è®°å½•ã€‚è¿™ä¿è¯äº†æ¯ä¸ªæ¨¡å—åªä¼šè¿è¡Œä¸€æ¬¡ã€‚è·Ÿå®ä¾‹åŒ–ä¸€æ ·ï¼Œè¿è¡Œé˜¶æ®µä¹Ÿé‡‡ç”¨<code>æ·±åº¦ä¼˜å…ˆçš„ååºéå†</code>æ–¹å¼ã€‚</p><p>é‚£å¯¹äºå‰é¢è°ˆåˆ°çš„å¾ªç¯ä¾èµ–ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><p><strong>å¾ªç¯ä¾èµ–</strong>ä¼šä½¿å¾—ä¾èµ–å…³ç³»å›¾ä¸­å‡ºç°ä¸€ä¸ªä¾èµ–ç¯ï¼Œå³ä½ ä¾èµ–æˆ‘ï¼Œæˆ‘ä¹Ÿä¾èµ–ä½ ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™ä¸ªç¯ä¼šéå¸¸å¤§ã€‚ä¸è¿‡ï¼Œä¸ºäº†è§£é‡Šå¥½è¿™ä¸ªé—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸¾ä¾‹ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¾èµ–ã€‚</p><p><img src="https://segmentfault.com/img/bV8chF?w=3164&amp;h=1416" alt="esmpic27"></p><p>é¦–å…ˆæ¥çœ‹ä¸‹è¿™ç§æƒ…å†µåœ¨ <code>CJS</code> ä¸­ä¼šå‘ç”Ÿä»€ä¹ˆã€‚<br>æœ€å¼€å§‹æ—¶ï¼Œ<code>main</code> æ¨¡å—ä¼šè¿è¡Œ <code>require</code>è¯­å¥ã€‚ç´§æ¥ç€ï¼Œä¼šå»åŠ è½½ <code>counter</code> æ¨¡å—ã€‚</p><p><img src="https://segmentfault.com/img/bV8cih?w=3289&amp;h=1850" alt="esmpic28"></p><p><code>counter</code> æ¨¡å—ä¼šè¯•å›¾å»è®¿é—®å¯¼å‡ºå¯¹è±¡çš„ <code>message</code> ã€‚ä¸è¿‡ï¼Œç”±äº <code>main</code> æ¨¡å—ä¸­è¿˜æ²¡è¿è¡Œåˆ° <code>message</code> å¤„ï¼Œæ‰€ä»¥æ­¤æ—¶å¾—åˆ°çš„ message ä¸º undefinedã€‚JS å¼•æ“ä¼šä¸ºæœ¬åœ°å˜é‡åˆ†é…ç©ºé—´å¹¶æŠŠå€¼è®¾ä¸º undefined ã€‚</p><p><img src="https://segmentfault.com/img/bV8ci8?w=3426&amp;h=776" alt="esmpic29"></p><p>è¿è¡Œé˜¶æ®µç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ° <code>counter</code> æ¨¡å—é¡¶å±‚ä»£ç çš„æœ«å°¾å¤„ã€‚æˆ‘ä»¬æƒ³çŸ¥é“ï¼Œå½“ <code>counter</code> æ¨¡å—è¿è¡Œç»“æŸåï¼Œ<code>message</code> æ˜¯å¦ä¼šå¾—åˆ°çœŸå®å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªè¶…æ—¶å®šæ—¶å™¨ã€‚ä¹‹åè¿è¡Œé˜¶æ®µä¾¿è¿”å›åˆ° <code>main.js</code> ä¸­ã€‚</p><p><img src="https://segmentfault.com/img/bV8ckc?w=3164&amp;h=1416" alt="esmpic30"></p><p>è¿™æ—¶ï¼Œ<code>message</code> å°†ä¼šè¢«åˆå§‹åŒ–å¹¶æ·»åŠ åˆ°å†…å­˜ä¸­ã€‚ä½†æ˜¯è¿™ä¸ª <code>message</code> ä¸ <code>counter</code> æ¨¡å—ä¸­çš„ <code>message</code> ä¹‹é—´å¹¶æ²¡æœ‰ä»»ä½•å…³è”å…³ç³»ï¼Œæ‰€ä»¥ <code>counter</code> æ¨¡å—ä¸­çš„ <code>message</code> ä»ç„¶ä¸º undefinedã€‚</p><p><img src="https://segmentfault.com/img/bV8ck5?w=3426&amp;h=1477" alt="esmpic31"></p><p>å¦‚æœå¯¼å‡ºå€¼é‡‡ç”¨çš„æ˜¯å®æ—¶ç»‘å®šæ–¹å¼ï¼Œé‚£ä¹ˆ <code>counter</code> æ¨¡å—æœ€ç»ˆä¼šå¾—åˆ°çœŸå®çš„ <code>message</code> å€¼ã€‚å½“è¶…æ—¶å®šæ—¶å™¨å¼€å§‹è®¡æ—¶æ—¶ï¼Œ<code>main.js</code> çš„è¿è¡Œå°±å·²ç»å®Œæˆå¹¶è®¾ç½®äº† <code>message</code> å€¼ã€‚</p><p>æ”¯æŒ<code>å¾ªç¯ä¾èµ–</code>æ˜¯ ESM è®¾è®¡ä¹‹åˆå°±è€ƒè™‘åˆ°çš„ä¸€å¤§åŸå› ã€‚ä¹Ÿæ­£æ˜¯è¿™ç§åˆ†æ®µè®¾è®¡ä½¿å…¶æˆä¸ºå¯èƒ½ã€‚</p><p><a href="https://segmentfault.com/a/1190000014318751#articleHeader7" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MVC,MPC,MVVMå›¾ç¤º</title>
      <link href="/2018/05/05/%E6%9D%82%E6%96%87/MVC-MPC-MVVM%E5%9B%BE%E7%A4%BA/"/>
      <url>/2018/05/05/%E6%9D%82%E6%96%87/MVC-MPC-MVVM%E5%9B%BE%E7%A4%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="MVC-MPC-MVVMåŒºåˆ«"><a href="#MVC-MPC-MVVMåŒºåˆ«" class="headerlink" title="MVC,MPC,MVVMåŒºåˆ«"></a>MVC,MPC,MVVMåŒºåˆ«</h1><p>MVCï¼ˆModel-View-Controllerï¼‰æ˜¯æœ€å¸¸è§çš„è½¯ä»¶æ¶æ„ä¹‹ä¸€ï¼Œä¸šç•Œæœ‰ç€å¹¿æ³›åº”ç”¨ã€‚å®ƒæœ¬èº«å¾ˆå®¹æ˜“ç†è§£ï¼Œä½†æ˜¯è¦è®²æ¸…æ¥šï¼Œå®ƒä¸è¡ç”Ÿçš„ MVP å’Œ MVVM æ¶æ„çš„åŒºåˆ«å°±ä¸å®¹æ˜“äº†ã€‚</p><h2 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h2><p>MVCæ¨¡å¼çš„æ„æ€æ˜¯ï¼Œè½¯ä»¶å¯ä»¥åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015020105.png" alt="MVC"></p><ul><li>M(Model) æ•°æ®ä¿å­˜â€”å°†æ–°çš„æ•°æ®å‘é€åˆ° Viewï¼Œç”¨æˆ·å¾—åˆ°åé¦ˆ</li><li>V(View) ç”¨æˆ·ç•Œé¢â€”View ä¼ é€æŒ‡ä»¤åˆ° Controller</li><li>C(Controller) ä¸šåŠ¡é€»è¾‘â€”å®Œæˆä¸šåŠ¡é€»è¾‘åï¼Œè¦æ±‚ Model æ”¹å˜çŠ¶æ€</li></ul><blockquote><p>æ‰€æœ‰é€šä¿¡éƒ½æ˜¯å•å‘çš„ã€‚</p></blockquote><h3 id="äº’åŠ¨æ¨¡å¼"><a href="#äº’åŠ¨æ¨¡å¼" class="headerlink" title="äº’åŠ¨æ¨¡å¼"></a>äº’åŠ¨æ¨¡å¼</h3><blockquote><p>æ¥å—ç”¨æˆ·æŒ‡ä»¤æ—¶ï¼ŒMVC å¯ä»¥åˆ†æˆä¸¤ç§æ–¹å¼ã€‚ä¸€ç§æ˜¯é€šè¿‡ View æ¥å—æŒ‡ä»¤ï¼Œä¼ é€’ç»™ Controllerã€‚</p></blockquote><a id="more"></a><p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015020106.png" alt="äº’åŠ¨æ¨¡å¼"></p><blockquote><p>å¦ä¸€ç§æ˜¯ç›´æ¥é€šè¿‡controlleræ¥å—æŒ‡ä»¤ã€‚</p></blockquote><p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015020107.png" alt="æ¥å—æŒ‡ä»¤"></p><h3 id="å®ä¾‹ï¼šBackbone"><a href="#å®ä¾‹ï¼šBackbone" class="headerlink" title="å®ä¾‹ï¼šBackbone"></a>å®ä¾‹ï¼šBackbone</h3><p>å®é™…é¡¹ç›®å¾€å¾€é‡‡ç”¨æ›´çµæ´»çš„æ–¹å¼ï¼Œä»¥ Backbone.js ä¸ºä¾‹ã€‚</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015020108.png" alt="backbone"></p><ul><li>ç”¨æˆ·å¯ä»¥å‘ View å‘é€æŒ‡ä»¤ï¼ˆDOM äº‹ä»¶ï¼‰ï¼Œå†ç”± View ç›´æ¥è¦æ±‚ Model æ”¹å˜çŠ¶æ€ã€‚</li><li>ç”¨æˆ·ä¹Ÿå¯ä»¥ç›´æ¥å‘ Controller å‘é€æŒ‡ä»¤ï¼ˆæ”¹å˜ URL è§¦å‘ hashChange äº‹ä»¶ï¼‰ï¼Œå†ç”± Controller å‘é€ç»™ Viewã€‚</li><li><code>Controller</code> éå¸¸è–„ï¼Œåªèµ·åˆ°è·¯ç”±çš„ä½œç”¨ï¼Œè€Œ <code>View</code> éå¸¸åšï¼Œä¸šåŠ¡é€»è¾‘éƒ½éƒ¨ç½²åœ¨ Viewã€‚æ‰€ä»¥ï¼ŒBackbone ç´¢æ€§å–æ¶ˆäº†  Controllerï¼Œåªä¿ç•™ä¸€ä¸ª Routerï¼ˆè·¯ç”±å™¨ï¼‰ã€‚</li></ul><h2 id="MVP"><a href="#MVP" class="headerlink" title="MVP"></a>MVP</h2><p>MVPæ¨¡å¼æ˜¯<strong>å°†controllerå˜ä¸ºäº†presenter</strong>ï¼ŒåŒæ—¶æ”¹å˜äº†é€šä¿¡çš„æ–¹å‘</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015020109.png" alt="MVP"></p><ul><li>å„éƒ¨åˆ†ä¹‹é—´çš„é€šä¿¡ï¼Œéƒ½æ˜¯åŒå‘çš„ã€‚</li><li>View ä¸ Model ä¸å‘ç”Ÿè”ç³»ï¼Œéƒ½é€šè¿‡ <code>Presenter</code> ä¼ é€’ã€‚</li><li><code>View</code> éå¸¸è–„ï¼Œä¸éƒ¨ç½²ä»»ä½•ä¸šåŠ¡é€»è¾‘ï¼Œç§°ä¸ºâ€è¢«åŠ¨è§†å›¾â€ï¼ˆPassive Viewï¼‰ï¼Œå³æ²¡æœ‰ä»»ä½•ä¸»åŠ¨æ€§ï¼Œè€Œ <code>Presenter</code>éå¸¸åšï¼Œæ‰€æœ‰é€»è¾‘éƒ½éƒ¨ç½²åœ¨é‚£é‡Œã€‚</li></ul><h2 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h2><p>MVVM æ¨¡å¼å°† <code>Presenter</code> æ”¹åä¸º <code>ViewModel</code>ï¼ŒåŸºæœ¬ä¸Šä¸ MVP æ¨¡å¼å®Œå…¨ä¸€è‡´ã€‚</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015020110.png" alt="MVVM"></p><p>å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œå®ƒé‡‡ç”¨åŒå‘ç»‘å®šï¼ˆdata-bindingï¼‰ï¼šViewçš„å˜åŠ¨ï¼Œè‡ªåŠ¨åæ˜ åœ¨ ViewModelï¼Œåä¹‹äº¦ç„¶</p><p><a href="http://www.ruanyifeng.com/blog/2015/02/mvcmvp_mvvm.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> æ‚æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AjaxåŸç†ä¸å®ç°</title>
      <link href="/2018/05/04/%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/Ajax%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/"/>
      <url>/2018/05/04/%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/Ajax%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>AJAXå…¨ç§°ä¸ºâ€œAsynchronous JavaScript and XMLâ€ï¼ˆå¼‚æ­¥JavaScriptå’ŒXMLï¼‰ï¼Œæ˜¯ä¸€ç§åˆ›å»ºäº¤äº’å¼ç½‘é¡µåº”ç”¨çš„ç½‘é¡µå¼€å‘æŠ€æœ¯ã€‚</p><h2 id="åŸç†ä¸å®ç°"><a href="#åŸç†ä¸å®ç°" class="headerlink" title="åŸç†ä¸å®ç°"></a>åŸç†ä¸å®ç°</h2><blockquote><p>åŸç†ï¼šAjaxçš„åŸç†ç®€å•æ¥è¯´é€šè¿‡XmlHttpRequestå¯¹è±¡æ¥å‘æœåŠ¡å™¨å‘å¼‚æ­¥è¯·æ±‚ï¼Œä»æœåŠ¡å™¨è·å¾—æ•°æ®ï¼Œç„¶åç”¨javascriptæ¥æ“ä½œDOMè€Œæ›´æ–°é¡µé¢ã€‚</p></blockquote><p>æŠŠæœåŠ¡å™¨ç«¯çœ‹æˆä¸€ä¸ªæ•°æ®æ¥å£(åªè´Ÿè´£åæ•°æ®)ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ª<code>çº¯æ–‡æœ¬æµ</code>ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæ–‡æœ¬æµå¯ä»¥æ˜¯<code>XMLæ ¼å¼</code>ï¼Œå¯ä»¥æ˜¯<code>Html</code>ï¼Œå¯ä»¥æ˜¯<code>Javascriptä»£ç </code>ï¼Œä¹Ÿå¯ä»¥åªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¿™æ—¶å€™ï¼Œ<code>XMLHttpRequest</code>å‘æœåŠ¡å™¨ç«¯è¯·æ±‚è¿™ä¸ªé¡µé¢ï¼ŒæœåŠ¡å™¨ç«¯å°†æ–‡æœ¬çš„ç»“æœå†™å…¥é¡µé¢ï¼Œè¿™å’Œæ™®é€šçš„webå¼€å‘æµç¨‹æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯ï¼Œ<font color = "red">å®¢æˆ·ç«¯åœ¨å¼‚æ­¥è·å–è¿™ä¸ªç»“æœåï¼Œä¸æ˜¯ç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ï¼Œè€Œæ˜¯å…ˆç”±javascriptæ¥å¤„ç†ï¼Œç„¶åå†æ˜¾ç¤ºåœ¨é¡µé¢</font>ã€‚</p><h3 id="æ ¸å¿ƒ"><a href="#æ ¸å¿ƒ" class="headerlink" title="æ ¸å¿ƒ"></a>æ ¸å¿ƒ</h3><p>Ajaxå…¶æ ¸å¿ƒæœ‰JavaScriptã€XMLHTTPRequestã€DOMå¯¹è±¡ç»„æˆï¼ŒXMLHttpRequestæ˜¯ajaxçš„æ ¸å¿ƒæœºåˆ¶ï¼Œæ˜¯JavaScriptçš„ä¸€ä¸ªå†…ç½®å¯¹è±¡ã€‚å®ƒæ˜¯åœ¨IE5ä¸­é¦–å…ˆå¼•å…¥çš„ï¼Œæ˜¯ä¸€ç§æ”¯æŒå¼‚æ­¥è¯·æ±‚çš„æŠ€æœ¯ã€‚ç®€å•çš„è¯´ï¼Œä¹Ÿå°±æ˜¯javascriptå¯ä»¥åŠæ—¶å‘æœåŠ¡å™¨æå‡ºè¯·æ±‚å’Œå¤„ç†å“åº”ï¼Œè€Œä¸é˜»å¡ç”¨æˆ·ã€‚è¾¾åˆ°æ— åˆ·æ–°çš„æ•ˆæœã€‚</p><h3 id="XMLHTTPRequestå¯¹è±¡"><a href="#XMLHTTPRequestå¯¹è±¡" class="headerlink" title="XMLHTTPRequestå¯¹è±¡"></a>XMLHTTPRequestå¯¹è±¡</h3><p>Ajaxçš„ä¸€ä¸ªæœ€å¤§çš„ç‰¹ç‚¹æ˜¯æ— éœ€åˆ·æ–°é¡µé¢ä¾¿å¯å‘æœåŠ¡å™¨ä¼ è¾“æˆ–è¯»å†™æ•°æ®(åˆç§°æ— åˆ·æ–°æ›´æ–°é¡µé¢),è¿™ä¸€ç‰¹ç‚¹ä¸»è¦å¾—ç›ŠäºXMLHTTPç»„ä»¶XMLHTTPRequestå¯¹è±¡ã€‚<br><a id="more"></a><br><strong>XMLHttpRequest å¯¹è±¡æ–¹æ³•æè¿°</strong><br>Ajaxå¼•æ“ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„JavaScriptåº”ç”¨ç¨‹åºï¼Œç”¨æ¥å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œè¯»å†™æœåŠ¡å™¨å’Œæ›´æ”¹DOMå†…å®¹ã€‚JavaScriptçš„Ajaxå¼•æ“è¯»å–ä¿¡æ¯ï¼Œå¹¶ä¸”äº’åŠ¨åœ°é‡å†™DOMï¼Œè¿™ä½¿ç½‘é¡µèƒ½æ— ç¼åŒ–é‡æ„ï¼Œä¹Ÿå°±æ˜¯åœ¨é¡µé¢å·²ç»ä¸‹è½½å®Œæ¯•åæ”¹å˜é¡µé¢å†…å®¹ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸€ç›´åœ¨é€šè¿‡JavaScriptå’ŒDOMåœ¨å¹¿æ³›ä½¿ç”¨çš„æ–¹æ³•ï¼Œä½†è¦ä½¿ç½‘é¡µçœŸæ­£åŠ¨æ€èµ·æ¥ï¼Œä¸ä»…è¦å†…éƒ¨çš„äº’åŠ¨ï¼Œè¿˜éœ€è¦ä»å¤–éƒ¨è·å–æ•°æ®ï¼Œåœ¨ä»¥å‰ï¼Œæˆ‘ä»¬æ˜¯è®©ç”¨æˆ·æ¥è¾“å…¥æ•°æ®å¹¶é€šè¿‡DOMæ¥æ”¹å˜ç½‘é¡µå†…å®¹çš„ï¼Œä½†ç°åœ¨ï¼ŒXMLHTTPRequestï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸é‡è½½é¡µé¢çš„æƒ…å†µä¸‹è¯»å†™æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼Œä½¿ç”¨æˆ·çš„è¾“å…¥è¾¾åˆ°æœ€å°‘ã€‚</p><p>Ajaxä½¿WEBä¸­çš„ç•Œé¢ä¸åº”ç”¨åˆ†ç¦»ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯æ•°æ®ä¸å‘ˆç°åˆ†ç¦»ï¼‰ï¼Œè€Œåœ¨ä»¥å‰ä¸¤è€…æ˜¯æ²¡æœ‰æ¸…æ™°çš„ç•Œé™çš„ï¼Œæ•°æ®ä¸å‘ˆç°åˆ†ç¦»çš„åˆ†ç¦»ï¼Œæœ‰åˆ©äºåˆ†å·¥åˆä½œã€å‡å°‘éæŠ€æœ¯äººå‘˜å¯¹é¡µé¢çš„ä¿®æ”¹é€ æˆçš„WEBåº”ç”¨ç¨‹åºé”™è¯¯ã€æé«˜æ•ˆç‡ã€ä¹Ÿæ›´åŠ é€‚ç”¨äºç°åœ¨çš„å‘å¸ƒç³»ç»Ÿã€‚ä¹Ÿå¯ä»¥æŠŠä»¥å‰çš„ä¸€äº›æœåŠ¡å™¨è´Ÿæ‹…çš„å·¥ä½œè½¬å«åˆ°å®¢æˆ·ç«¯ï¼Œåˆ©äºå®¢æˆ·ç«¯é—²ç½®çš„å¤„ç†èƒ½åŠ›æ¥å¤„ç†ã€‚</p><h2 id="ä¼˜ç‚¹ä¸ç¼ºç‚¹"><a href="#ä¼˜ç‚¹ä¸ç¼ºç‚¹" class="headerlink" title="ä¼˜ç‚¹ä¸ç¼ºç‚¹"></a>ä¼˜ç‚¹ä¸ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>æ— éœ€åˆ·æ–°é¡µé¢æ›´æ–°æ•°æ®</li><li>ç•Œé¢ä¸åº”ç”¨åˆ†ç¦»ï¼ˆå‘ˆç°ä¸æ•°æ®åˆ†ç¦»ï¼‰</li><li>åŸºäºè§„èŒƒå¹¿æ³›ä½¿ç”¨</li><li>å¼‚æ­¥ä¸æœåŠ¡å™¨é€šä¿¡</li><li>å‰åç«¯è´Ÿè½½å¹³è¡¡</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>ç ´åäº†æµè§ˆå™¨çš„backå’ŒhistoryåŠŸèƒ½</li><li>æœç´¢å¼•æ“çš„æ”¯æŒè¾ƒå¼±</li><li>ajaxçš„å®‰å…¨é—®é¢˜ï¼ˆè·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ï¼ŒSQLæ³¨å…¥æ”»å‡»ç­‰ç­‰ï¼‰</li><li>Ajaxä¸èƒ½å¾ˆå¥½åœ°æ”¯æŒç§»åŠ¨ç«¯</li><li>ç ´åç¨‹åºçš„å¼‚å¸¸å¤„ç†æœºåˆ¶</li><li>å®¢æˆ·ç«¯è¿‡è‚¥ï¼Œå®¹æ˜“é€ æˆå®¢æˆ·ç«¯çš„å¼€å‘æˆæœ¬</li></ul><h2 id="AJAXæ³¨æ„ç‚¹åŠé€‚ç”¨å’Œä¸é€‚ç”¨åœºæ™¯"><a href="#AJAXæ³¨æ„ç‚¹åŠé€‚ç”¨å’Œä¸é€‚ç”¨åœºæ™¯" class="headerlink" title="AJAXæ³¨æ„ç‚¹åŠé€‚ç”¨å’Œä¸é€‚ç”¨åœºæ™¯"></a>AJAXæ³¨æ„ç‚¹åŠé€‚ç”¨å’Œä¸é€‚ç”¨åœºæ™¯</h2><h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><p>Ajaxå¼€å‘æ—¶ï¼Œç½‘ç»œå»¶è¿Ÿâ€”â€”å³ç”¨æˆ·å‘å‡ºè¯·æ±‚åˆ°æœåŠ¡å™¨å‘å‡ºå“åº”ä¹‹é—´çš„é—´éš”â€”â€”éœ€è¦æ…é‡è€ƒè™‘ã€‚ä¸ç»™äºˆç”¨æˆ·æ˜ç¡®çš„å›åº”ï¼Œæ²¡æœ‰æ°å½“çš„é¢„è¯»æ•°æ®ï¼Œæˆ–è€…å¯¹XMLHttpRequestçš„ä¸æ°å½“å¤„ç†ï¼Œéƒ½ä¼šä½¿ç”¨æˆ·æ„Ÿåˆ°å»¶è¿Ÿï¼Œè¿™æ˜¯ç”¨æˆ·ä¸å¸Œæœ›çœ‹åˆ°çš„ï¼Œä¹Ÿæ˜¯ä»–ä»¬æ— æ³•ç†è§£çš„ã€‚é€šå¸¸çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œä½¿ç”¨ä¸€ä¸ªå¯è§†åŒ–çš„ç»„ä»¶æ¥å‘Šè¯‰ç”¨æˆ·ç³»ç»Ÿæ­£åœ¨è¿›è¡Œåå°æ“ä½œå¹¶ä¸”æ­£åœ¨è¯»å–æ•°æ®å’Œå†…å®¹ã€‚</p><h3 id="Ajaxé€‚ç”¨åœºæ™¯"><a href="#Ajaxé€‚ç”¨åœºæ™¯" class="headerlink" title="Ajaxé€‚ç”¨åœºæ™¯"></a>Ajaxé€‚ç”¨åœºæ™¯</h3><ul><li>è¡¨å•é©±åŠ¨çš„äº¤äº’</li><li>æ·±å±‚æ¬¡çš„æ ‘çš„å¯¼èˆª</li><li>å¿«é€Ÿçš„ç”¨æˆ·ä¸ç”¨æˆ·é—´çš„äº¤æµå“åº”</li><li>ç±»ä¼¼æŠ•ç¥¨ã€yes/noç­‰æ— å…³ç—›ç—’çš„åœºæ™¯</li><li>å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤å’Œæ“çºµç›¸å…³æ•°æ®çš„åœºæ™¯</li><li>æ™®é€šçš„æ–‡æœ¬è¾“å…¥æç¤ºå’Œè‡ªåŠ¨å®Œæˆçš„åœºæ™¯</li></ul><h3 id="Ajaxä¸é€‚ç”¨åœºæ™¯"><a href="#Ajaxä¸é€‚ç”¨åœºæ™¯" class="headerlink" title="Ajaxä¸é€‚ç”¨åœºæ™¯"></a>Ajaxä¸é€‚ç”¨åœºæ™¯</h3><ul><li>éƒ¨åˆ†ç®€å•çš„è¡¨å•</li><li>æœç´¢</li><li>åŸºæœ¬çš„å¯¼èˆª</li><li>æ›¿æ¢å¤§é‡çš„æ–‡æœ¬</li><li>å¯¹å‘ˆç°çš„æ“çºµ</li></ul><h2 id="ä½¿ç”¨ES6å»å®ç°ä¸€ä¸ªajax"><a href="#ä½¿ç”¨ES6å»å®ç°ä¸€ä¸ªajax" class="headerlink" title="ä½¿ç”¨ES6å»å®ç°ä¸€ä¸ªajax"></a>ä½¿ç”¨ES6å»å®ç°ä¸€ä¸ªajax</h2><pre><code class="js">function Ajax(method,url){    const p =  new Promise((resolve,reject) =&gt;{        const xhr = new XMLHttpRequest();        xhr.open(method,url,true)        xhr.onReadyStateChange(data){            if(xhr.readyStatus == 4){                if(xhr.status == 200){                    resolve(json.parse(xhr.responseText))                }else{                    reject(new throw (&#39;not found&#39;))                }            }        }        xhr.send(null)    })}</code></pre>]]></content>
      
      
      <categories>
          
          <category> åŸç†ä¸å®ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ajax </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jsonpçš„åŸç†ä¸å®ç°</title>
      <link href="/2018/05/03/%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/Jsonp%E7%9A%84%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/"/>
      <url>/2018/05/03/%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/Jsonp%E7%9A%84%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>Jsonpæ˜¯ä¸€ç§è·¨åŸŸé€šä¿¡çš„æ‰‹æ®µï¼Œå®ƒçš„åŸç†å®ç°å¾ˆç®€å•ï¼š</p><ul><li>1.é¦–å…ˆåˆ©ç”¨scriptæ ‡ç­¾çš„srcå±æ€§æ¥å®ç°è·¨åŸŸ</li><li>2.é€šè¿‡å°†å‰ç«¯æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ ç»™æœåŠ¡å™¨ç«¯ï¼Œç”±æœåŠ¡å™¨ç«¯æ³¨å…¥å‚æ•°ä¹‹åå†è¿”å›ï¼Œå®ç°æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯é€šä¿¡</li><li>3.ç”±äºä½¿ç”¨scriptçš„srcå±æ€§ï¼Œæ‰€ä»¥åªæ”¯æŒgetæ–¹æ³•</li></ul><h2 id="å®ç°æµç¨‹"><a href="#å®ç°æµç¨‹" class="headerlink" title="å®ç°æµç¨‹"></a>å®ç°æµç¨‹</h2><p>1.è®¾å®šä¸€ä¸ªscriptæ ‡ç­¾</p><pre><code class="js">&lt;script src=&quot;http://jsonp.js?callback=xxx&quot;&gt;&lt;/script&gt;</code></pre><p>2.callbackå®šä¹‰äº†ä¸€ä¸ªå‡½æ•°åï¼Œè€Œè¿œç¨‹æœåŠ¡ç«¯é€šè¿‡è°ƒç”¨æŒ‡å®šçš„å‡½æ•°å¹¶ä¼ å…¥å‚æ•°å®ç°å‚æ•°ä¼ é€’ï¼Œå°†fn(response)ä¼ é€’å›å®¢æˆ·ç«¯</p><pre><code class="js">$callback = !empty($_GET[&#39;callback&#39;]) ? $_GET[&#39;callback&#39;]: &#39;callback&#39;;echo $callback.&#39;(.json_encode($data))&#39;;</code></pre><p>3.å®¢æˆ·ç«¯æ¥æ”¶åˆ°è¿”å›çš„jsè„šæœ¬ï¼Œå¼€å§‹è§£æå’Œæ‰§è¡Œfn(response)<br><a id="more"></a></p><h2 id="jsonpçš„ç®€å•å®ç°"><a href="#jsonpçš„ç®€å•å®ç°" class="headerlink" title="jsonpçš„ç®€å•å®ç°"></a>jsonpçš„ç®€å•å®ç°</h2><p>ä¸€ä¸ªç®€å•çš„jsonpå®ç°ï¼Œå…¶å®å°±æ˜¯æ‹¼æ¥urlå­—ç¬¦ä¸²ï¼ŒåŠ¨æ€çš„æ·»åŠ åˆ°scriptå…ƒç´ çš„å¤´éƒ¨</p><pre><code class="js">function jsonp(req){    var script = document.createElement(&#39;script&#39;);    var url = req.url + &#39;?callback=&#39; + req.callback.name;    script.src = url;    document.getElementsByTagName(&#39;head&#39;)[0].appendChild(&#39;script&#39;);}</code></pre><p>å‰ç«¯jsç¤ºä¾‹</p><pre><code class="js">function hello(res){    alert(&#39;hello&#39; + res.data);}jsonp({    url:&#39;&#39;,    callback: hello})</code></pre><p>æœåŠ¡å™¨ç«¯ä»£ç </p><pre><code class="js">var http = requrie(&#39;http&#39;);var urllib = require(&#39;url&#39;);var port = 8080;var data = {&#39;data&#39;:&#39;world&#39;};http.createServer(function(req,res){    var params = urllib.parse(req.url,true);    if(params.query.callback){        console.log(params.query.callback);        //jsonp        var str = params.query.callback + &#39;(&#39; + JSON.stringify(data) + &#39;)&#39;;        res.end(str);    } else {        res.end();    }}).listen(port,function(){    console.log(&#39;jsonp server is on&#39;);});</code></pre><p>ç„¶è€Œï¼Œè¿™ä¸ªå®ç°è™½ç„¶ç®€å•ï¼Œä½†æœ‰ä¸€äº›ä¸è¶³çš„åœ°æ–¹ï¼š</p><p>1.æˆ‘ä»¬ä¼ é€’çš„å›è°ƒå¿…é¡»æ˜¯ä¸€ä¸ªå…¨å±€æ–¹æ³•ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“è¦å°½é‡å‡å°‘å…¨å±€çš„æ–¹æ³•ã€‚<br>2.éœ€è¦åŠ å…¥ä¸€äº›å‚æ•°æ ¡éªŒï¼Œç¡®ä¿æ¥å£å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚</p><h2 id="å¯é çš„jsonpå®ç°"><a href="#å¯é çš„jsonpå®ç°" class="headerlink" title="å¯é çš„jsonpå®ç°"></a>å¯é çš„jsonpå®ç°</h2><p>jsonpéƒ¨åˆ†æºç </p><pre><code class="js">(function (global) {    var id = 0,        container = document.getElementsByTagName(&quot;head&quot;)[0];    function jsonp(options) {        if(!options || !options.url) return;        var scriptNode = document.createElement(&quot;script&quot;),            data = options.data || {},            url = options.url,            callback = options.callback,            fnName = &quot;jsonp&quot; + id++;        // æ·»åŠ å›è°ƒå‡½æ•°        data[&quot;callback&quot;] = fnName;        // æ‹¼æ¥url        var params = [];        for (var key in data) {            params.push(encodeURIComponent(key) + &quot;=&quot; + encodeURIComponent(data[key]));        }        url = url.indexOf(&quot;?&quot;) &gt; 0 ? (url + &quot;&amp;&quot;) : (url + &quot;?&quot;);        url += params.join(&quot;&amp;&quot;);        scriptNode.src = url;        // ä¼ é€’çš„æ˜¯ä¸€ä¸ªåŒ¿åçš„å›è°ƒå‡½æ•°ï¼Œè¦æ‰§è¡Œçš„è¯ï¼Œæš´éœ²ä¸ºä¸€ä¸ªå…¨å±€æ–¹æ³•        global[fnName] = function (ret) {            callback &amp;&amp; callback(ret);            container.removeChild(scriptNode);            delete global[fnName];        }        // å‡ºé”™å¤„ç†        scriptNode.onerror = function () {            callback &amp;&amp; callback({error:&quot;error&quot;});            container.removeChild(scriptNode);            global[fnName] &amp;&amp; delete global[fnName];        }        scriptNode.type = &quot;text/javascript&quot;;        container.appendChild(scriptNode)    }    global.jsonp = jsonp;})(this);</code></pre><p>ä½¿ç”¨ç¤ºä¾‹</p><pre><code class="js">jsonp({    url: &#39;www.example.com&#39;,    data: {id :1},    callback: function(ret){        console.log(ret)    }})</code></pre><h2 id="JSONPçš„ä¼˜ç¼ºç‚¹"><a href="#JSONPçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="JSONPçš„ä¼˜ç¼ºç‚¹"></a>JSONPçš„ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>å®ƒä¸åƒXMLHttpRequestå¯¹è±¡å®ç°çš„Ajaxè¯·æ±‚é‚£æ ·å—åˆ°åŒæºç­–ç•¥çš„é™åˆ¶ï¼ŒJSONPå¯ä»¥è·¨è¶ŠåŒæºç­–ç•¥ï¼›</li><li>å®ƒçš„å…¼å®¹æ€§æ›´å¥½ï¼Œåœ¨æ›´åŠ å¤è€çš„æµè§ˆå™¨ä¸­éƒ½å¯ä»¥è¿è¡Œï¼Œä¸éœ€è¦XMLHttpRequestæˆ–ActiveXçš„æ”¯æŒ</li><li>åœ¨è¯·æ±‚å®Œæ¯•åå¯ä»¥é€šè¿‡è°ƒç”¨callbackçš„æ–¹å¼å›ä¼ ç»“æœã€‚å°†å›è°ƒæ–¹æ³•çš„æƒé™ç»™äº†è°ƒç”¨æ–¹ã€‚è¿™ä¸ªå°±ç›¸å½“äºå°†controllerå±‚å’Œviewå±‚ç»ˆäºåˆ† å¼€äº†ã€‚æˆ‘æä¾›çš„jsonpæœåŠ¡åªæä¾›çº¯æœåŠ¡çš„æ•°æ®ï¼Œè‡³äºæä¾›æœåŠ¡ä»¥ åçš„é¡µé¢æ¸²æŸ“å’Œåç»­viewæ“ä½œéƒ½ç”±è°ƒç”¨è€…æ¥è‡ªå·±å®šä¹‰å°±å¥½äº†ã€‚å¦‚æœæœ‰ä¸¤ä¸ªé¡µé¢éœ€è¦æ¸²æŸ“åŒä¸€ä»½æ•°æ®ï¼Œä½ ä»¬åªéœ€è¦æœ‰ä¸åŒçš„æ¸²æŸ“é€»è¾‘å°±å¯ä»¥äº†ï¼Œé€»è¾‘éƒ½å¯ä»¥ä½¿ç”¨åŒ ä¸€ä¸ªjsonpæœåŠ¡ã€‚</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>å®ƒåªæ”¯æŒGETè¯·æ±‚è€Œä¸æ”¯æŒPOSTç­‰å…¶å®ƒç±»å‹çš„HTTPè¯·æ±‚</li><li>å®ƒåªæ”¯æŒè·¨åŸŸHTTPè¯·æ±‚è¿™ç§æƒ…å†µï¼Œä¸èƒ½è§£å†³ä¸åŒåŸŸçš„ä¸¤ä¸ªé¡µé¢ä¹‹é—´å¦‚ä½•è¿›è¡ŒJavaScriptè°ƒç”¨çš„é—®é¢˜ã€‚</li><li>jsonpåœ¨è°ƒç”¨å¤±è´¥çš„æ—¶å€™ä¸ä¼šè¿”å›å„ç§HTTPçŠ¶æ€ç ã€‚</li><li>ç¼ºç‚¹æ˜¯å®‰å…¨æ€§ã€‚ä¸‡ä¸€å‡å¦‚æä¾›jsonpçš„æœåŠ¡å­˜åœ¨é¡µé¢æ³¨å…¥æ¼æ´ï¼Œå³å®ƒè¿”å›çš„javascriptçš„å†…å®¹è¢«äººæ§åˆ¶çš„ã€‚é‚£ä¹ˆç»“æœæ˜¯ä»€ä¹ˆï¼Ÿæ‰€æœ‰è°ƒç”¨è¿™ä¸ª jsonpçš„ç½‘ç«™éƒ½ä¼šå­˜åœ¨æ¼æ´ã€‚äºæ˜¯æ— æ³•æŠŠå±é™©æ§åˆ¶åœ¨ä¸€ä¸ªåŸŸåä¸‹â€¦æ‰€ä»¥åœ¨ä½¿ç”¨jsonpçš„æ—¶å€™å¿…é¡»è¦ä¿è¯ä½¿ç”¨çš„jsonpæœåŠ¡å¿…é¡»æ˜¯å®‰å…¨å¯ä¿¡çš„</li></ul><h3 id="å®‰å…¨é˜²èŒƒ"><a href="#å®‰å…¨é˜²èŒƒ" class="headerlink" title="å®‰å…¨é˜²èŒƒ"></a>å®‰å…¨é˜²èŒƒ</h3><ul><li>é˜²æ­¢callbackå‚æ•°æ„å¤–æˆªæ–­jsä»£ç ,ç‰¹æ®Šå­—ç¬¦å•å¼•å·åŒå¼•å·,æ¢è¡Œç¬¦å­˜åœ¨é£é™©.</li><li>é˜²æ­¢callbackå‚æ•°æ¶æ„æ·»åŠ scriptæ ‡ç­¾,é€ æˆxssæ¼æ´</li><li>é˜²æ­¢è·¨åŸŸè¯·æ±‚æ»¥ç”¨,é˜»æ­¢éæ³•ç«™ç‚¹æ¶æ„è°ƒç”¨</li></ul>]]></content>
      
      
      <categories>
          
          <category> åŸç†ä¸å®ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jsonp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹</title>
      <link href="/2018/05/02/study/%E4%BB%80%E4%B9%88%E6%98%AF%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
      <url>/2018/05/02/study/%E4%BB%80%E4%B9%88%E6%98%AF%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Functional-programming"><a href="#Functional-programming" class="headerlink" title="Functional programming"></a>Functional programming</h1><p>ä½ å¯èƒ½å¬è¯´è¿‡å‡½æ•°å¼ç¼–ç¨‹ï¼ˆFunctional programmingï¼‰ï¼Œç”šè‡³å·²ç»ä½¿ç”¨äº†ä¸€æ®µæ—¶é—´ã€‚</p><p>ä½†æ˜¯ï¼Œä½ èƒ½è¯´æ¸…æ¥šï¼Œå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆå—</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017022201.jpg" alt="å‡½æ•°å¼ç¼–ç¨‹"></p><p>ç½‘ä¸Šæœç´¢ä¸€ä¸‹ï¼Œä½ ä¼šè½»æ¾æ‰¾åˆ°å¥½å¤šç­”æ¡ˆã€‚</p><blockquote><p>ä¸é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œè¿‡ç¨‹å¼ç¼–ç¨‹å¹¶åˆ—çš„ç¼–ç¨‹èŒƒå¼<br>ä¸»è¦çš„ç‰¹å¾ï¼š<a href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/ch2.html#%E4%B8%BA%E4%BD%95%E9%92%9F%E7%88%B1%E4%B8%80%E7%AD%89%E5%85%AC%E6%B0%91" target="_blank" rel="noopener">å‡½æ•°æ˜¯ç¬¬ä¸€ç­‰å…¬æ°‘</a><br>å¼ºè°ƒå°†è®¡ç®—è¿‡ç¨‹åˆ†è§£æˆå¯å¤ç”¨çš„å‡½æ•°ï¼Œå…¸å‹çš„ä¾‹å­å°±æ˜¯mapå‡½æ•°å’Œreduceå‡½æ•°ç»„æˆçš„<code>MapReduceå‡½æ•°</code><br>åªæœ‰çº¯å‡½æ•°ï¼Œæ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°ï¼Œæ‰è¢«ç§°ä¸ºå‡½æ•°</p></blockquote><p>ä¸Šé¢è¿™äº›è¯´æ³•éƒ½å¯¹ï¼Œä½†è¿˜ä¸å¤Ÿï¼Œéƒ½æ²¡æœ‰å›ç­”ä¸‹é¢è¿™ä¸ªæ›´æ·±å±‚çš„é—®é¢˜ã€‚</p><a id="more"></a><blockquote><p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ</strong></p></blockquote><h2 id="èŒƒç•´è®º"><a href="#èŒƒç•´è®º" class="headerlink" title="èŒƒç•´è®º"></a>èŒƒç•´è®º</h2><p>å‡½æ•°å¼ç¼–ç¨‹çš„èµ·æºï¼Œæ˜¯ä¸€é—¨å«åšèŒƒç•´è®ºï¼ˆCategory Theoryï¼‰çš„æ•°å­¦åˆ†æ”¯</p><p>ç†è§£å‡½æ•°å¼ç¼–ç¨‹çš„å…³é”®ï¼Œå°±æ˜¯ç†è§£èŒƒç•´è®ºã€‚å®ƒæ˜¯ä¸€é—¨å¾ˆå¤æ‚çš„æ•°å­¦ï¼Œè®¤ä¸ºä¸–ç•Œä¸Šæ‰€æœ‰çš„æ¦‚å¿µä½“ç³»ï¼Œéƒ½å¯ä»¥æŠ½è±¡æˆä¸€ä¸ªä¸ªçš„â€èŒƒç•´â€ï¼ˆcategoryï¼‰ã€‚</p><h3 id="èŒƒç•´çš„æ¦‚å¿µ"><a href="#èŒƒç•´çš„æ¦‚å¿µ" class="headerlink" title="èŒƒç•´çš„æ¦‚å¿µ"></a>èŒƒç•´çš„æ¦‚å¿µ</h3><p>ä»€ä¹ˆæ˜¯èŒƒç•´å‘¢ï¼Ÿ</p><p>ç»´åŸºç™¾ç§‘çš„ä¸€å¥è¯å®šä¹‰å¦‚ä¸‹ã€‚</p><blockquote><p>â€œèŒƒç•´å°±æ˜¯ä½¿ç”¨ç®­å¤´è¿æ¥çš„ç‰©ä½“ã€‚â€ï¼ˆIn mathematics, a category is an algebraic structure that comprises â€œobjectsâ€ that are linked by â€œarrowsâ€. ï¼‰</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½¼æ­¤ä¹‹é—´å­˜åœ¨æŸç§å…³ç³»çš„æ¦‚å¿µã€äº‹ç‰©ã€å¯¹è±¡ç­‰ç­‰ï¼Œéƒ½æ„æˆâ€èŒƒç•´â€ã€‚éšä¾¿ä»€ä¹ˆä¸œè¥¿ï¼Œåªè¦èƒ½æ‰¾å‡ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå°±èƒ½å®šä¹‰ä¸€ä¸ªâ€èŒƒç•´â€ã€‚</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017022210.jpg" alt="èŒƒç•´"></p><p>ä¸Šå›¾ä¸­ï¼Œå„ä¸ªç‚¹ä¸å®ƒä»¬ä¹‹é—´çš„ç®­å¤´ï¼Œå°±æ„æˆä¸€ä¸ªèŒƒç•´ã€‚</p><p>ç®­å¤´è¡¨ç¤ºèŒƒç•´æˆå‘˜ä¹‹é—´çš„å…³ç³»ï¼Œæ­£å¼çš„åç§°å«åš<code>&quot;æ€å°„&quot;</code>ï¼ˆmorphismï¼‰ã€‚èŒƒç•´è®ºè®¤ä¸ºï¼ŒåŒä¸€ä¸ªèŒƒç•´çš„æ‰€æœ‰æˆå‘˜ï¼Œå°±æ˜¯ä¸åŒçŠ¶æ€çš„<code>&quot;å˜å½¢&quot;</code>ï¼ˆtransformationï¼‰ã€‚é€šè¿‡<code>&quot;æ€å°„&quot;</code>ï¼Œä¸€ä¸ªæˆå‘˜å¯ä»¥å˜å½¢æˆå¦ä¸€ä¸ªæˆå‘˜ã€‚</p><h3 id="æ•°å­¦æ¨¡å‹"><a href="#æ•°å­¦æ¨¡å‹" class="headerlink" title="æ•°å­¦æ¨¡å‹"></a>æ•°å­¦æ¨¡å‹</h3><p>æ—¢ç„¶â€èŒƒç•´â€æ˜¯æ»¡è¶³æŸç§å˜å½¢å…³ç³»çš„æ‰€æœ‰å¯¹è±¡ï¼Œå°±å¯ä»¥æ€»ç»“å‡ºå®ƒçš„æ•°å­¦æ¨¡å‹ã€‚</p><ul><li>æ‰€æœ‰æˆå‘˜æ˜¯ä¸€ä¸ªé›†åˆ</li><li>å˜å½¢å…³ç³»æ˜¯å‡½æ•°</li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒèŒƒç•´è®ºæ˜¯é›†åˆè®ºæ›´ä¸Šå±‚çš„æŠ½è±¡ï¼Œç®€å•çš„ç†è§£å°±æ˜¯â€é›†åˆ + å‡½æ•°â€ã€‚</p><p>ç†è®ºä¸Šé€šè¿‡å‡½æ•°ï¼Œå°±å¯ä»¥ä»èŒƒç•´çš„ä¸€ä¸ªæˆå‘˜ï¼Œç®—å‡ºå…¶ä»–æ‰€æœ‰æˆå‘˜ã€‚</p><h3 id="èŒƒç•´ä¸å®¹å™¨"><a href="#èŒƒç•´ä¸å®¹å™¨" class="headerlink" title="èŒƒç•´ä¸å®¹å™¨"></a>èŒƒç•´ä¸å®¹å™¨</h3><blockquote><p>æˆ‘ä»¬å¯ä»¥æŠŠâ€èŒƒç•´â€æƒ³è±¡æˆæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢åŒ…å«ä¸¤æ ·ä¸œè¥¿ã€‚</p><ul><li>å€¼ï¼ˆvalueï¼‰</li><li>å€¼çš„å˜å½¢å…³ç³»ï¼Œä¹Ÿå°±æ˜¯å‡½æ•°ã€‚</li></ul></blockquote><p>ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ä»£ç ï¼Œå®šä¹‰ä¸€ä¸ªç®€å•çš„èŒƒç•´ã€‚</p><pre><code class="js">class Category{    constructor(val){        this.val = val;    }    addOne(x){        return x +1;    }}</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Category</code>æ˜¯ä¸€ä¸ªç±»ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªå€¼ï¼ˆ<code>this.val</code>ï¼‰å’Œä¸€ç§å˜å½¢å…³ç³»ï¼ˆaddOneï¼‰ã€‚ä½ å¯èƒ½å·²ç»çœ‹å‡ºæ¥äº†ï¼Œè¿™é‡Œçš„èŒƒç•´ï¼Œå°±æ˜¯æ‰€æœ‰å½¼æ­¤ä¹‹é—´<code>ç›¸å·®1</code>çš„æ•°å­—ã€‚</p><p>æ³¨æ„ï¼Œæœ¬æ–‡åé¢çš„éƒ¨åˆ†ï¼Œå‡¡æ˜¯æåˆ°â€å®¹å™¨â€çš„åœ°æ–¹ï¼Œå…¨éƒ¨éƒ½æ˜¯æŒ‡â€èŒƒç•´â€ã€‚</p><h3 id="èŒƒç•´è®ºä¸å‡½æ•°ç¼–ç¨‹å¼çš„å…³ç³»"><a href="#èŒƒç•´è®ºä¸å‡½æ•°ç¼–ç¨‹å¼çš„å…³ç³»" class="headerlink" title="èŒƒç•´è®ºä¸å‡½æ•°ç¼–ç¨‹å¼çš„å…³ç³»"></a>èŒƒç•´è®ºä¸å‡½æ•°ç¼–ç¨‹å¼çš„å…³ç³»</h3><p>èŒƒç•´è®ºä½¿ç”¨å‡½æ•°ï¼Œè¡¨è¾¾èŒƒç•´ä¹‹é—´çš„å…³ç³»<br><strong>æœ¬è´¨ä¸Šï¼Œå‡½æ•°å¼ç¼–ç¨‹åªæ˜¯èŒƒç•´è®ºçš„è¿ç®—æ–¹æ³•ï¼Œè·Ÿæ•°ç†é€»è¾‘ã€å¾®ç§¯åˆ†ã€è¡Œåˆ—å¼æ˜¯åŒä¸€ç±»ä¸œè¥¿ï¼Œéƒ½æ˜¯æ•°å­¦æ–¹æ³•ï¼Œåªæ˜¯ç¢°å·§å®ƒèƒ½ç”¨æ¥å†™ç¨‹åºã€‚</strong><br>æ‰€ä»¥ï¼Œä½ æ˜ç™½äº†å—ï¼Œä¸ºä»€ä¹ˆå‡½æ•°å¼ç¼–ç¨‹è¦æ±‚å‡½æ•°å¿…é¡»æ˜¯çº¯çš„ï¼Œä¸èƒ½æœ‰å‰¯ä½œç”¨ï¼Ÿå› ä¸º<font color = "red">å®ƒæ˜¯ä¸€ç§æ•°å­¦è¿ç®—ï¼ŒåŸå§‹ç›®çš„å°±æ˜¯æ±‚å€¼ï¼Œä¸åšå…¶ä»–äº‹æƒ…ï¼Œå¦åˆ™å°±æ— æ³•æ»¡è¶³å‡½æ•°è¿ç®—æ³•åˆ™äº†ï¼Œæ€»ä¹‹ï¼Œåœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œå‡½æ•°å°±æ˜¯ä¸€ä¸ªç®¡é“ï¼ˆpipeï¼‰ã€‚è¿™å¤´è¿›å»ä¸€ä¸ªå€¼ï¼Œé‚£å¤´å°±ä¼šå‡ºæ¥ä¸€ä¸ªæ–°çš„å€¼ï¼Œæ²¡æœ‰å…¶ä»–ä½œç”¨ã€‚<br></font></p><h2 id="å‡½æ•°çš„åˆæˆä¸æŸ¯é‡ŒåŒ–"><a href="#å‡½æ•°çš„åˆæˆä¸æŸ¯é‡ŒåŒ–" class="headerlink" title="å‡½æ•°çš„åˆæˆä¸æŸ¯é‡ŒåŒ–"></a>å‡½æ•°çš„åˆæˆä¸æŸ¯é‡ŒåŒ–</h2><p>å‡½æ•°å¼ç¼–ç¨‹æœ‰ä¸¤ä¸ªæœ€åŸºæœ¬çš„è¿ç®—: åˆæˆä¸æŸ¯é‡ŒåŒ–</p><h3 id="å‡½æ•°çš„åˆæˆ"><a href="#å‡½æ•°çš„åˆæˆ" class="headerlink" title="å‡½æ•°çš„åˆæˆ"></a>å‡½æ•°çš„åˆæˆ</h3><p>å¦‚æœä¸€ä¸ªå€¼è¦ç»è¿‡å¤šä¸ªå‡½æ•°ï¼Œæ‰èƒ½å˜æˆå¦å¤–ä¸€ä¸ªå€¼ï¼Œå°±å¯ä»¥æŠŠæ‰€æœ‰ä¸­é—´æ­¥éª¤åˆå¹¶æˆä¸€ä¸ªå‡½æ•°ï¼Œè¿™å«åš<code>&quot;å‡½æ•°çš„åˆæˆ&quot;ï¼ˆcomposeï¼‰</code>ã€‚</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017022204.png" alt="compose"></p><p>ä¸Šå›¾ä¸­ï¼ŒXå’ŒYä¹‹é—´çš„å˜å½¢å…³ç³»æ˜¯<code>å‡½æ•°f</code>ï¼ŒYå’ŒZä¹‹é—´çš„å˜å½¢å…³ç³»æ˜¯<code>å‡½æ•°g</code>ï¼Œé‚£ä¹ˆXå’ŒZä¹‹é—´çš„å…³ç³»ï¼Œå°±æ˜¯gå’Œfçš„åˆæˆ<code>å‡½æ•°gÂ·f</code>ã€‚</p><p>åˆæˆä¸¤ä¸ªå‡½æ•°çš„ç®€å•ä»£ç å¦‚ä¸‹ã€‚</p><pre><code class="js">const compose = function(f,g){    return function(x){        return f(g(x));    }}</code></pre><p>å‡½æ•°çš„åˆæˆè¿˜å¿…é¡»æ»¡è¶³ç»“åˆå¾‹ã€‚</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017022209.png" alt="ç»“åˆå¾‹"></p><pre><code class="js">compose(f, compose(g, h))// ç­‰åŒäºcompose(compose(f, g), h)// ç­‰åŒäºcompose(f, g, h)</code></pre><p><font color = "red">åˆæˆä¹Ÿæ˜¯å‡½æ•°å¿…é¡»æ˜¯çº¯çš„ä¸€ä¸ªåŸå› </font>ã€‚å› ä¸ºä¸€ä¸ªä¸çº¯çš„å‡½æ•°ï¼Œæ€ä¹ˆè·Ÿå…¶ä»–å‡½æ•°åˆæˆï¼Ÿæ€ä¹ˆä¿è¯å„ç§åˆæˆä»¥åï¼Œå®ƒä¼šè¾¾åˆ°é¢„æœŸçš„è¡Œä¸ºï¼Ÿ</p><p>å‰é¢è¯´è¿‡ï¼Œ<em>å‡½æ•°å°±åƒæ•°æ®çš„ç®¡é“ï¼ˆpipeï¼‰ã€‚é‚£ä¹ˆï¼Œå‡½æ•°åˆæˆå°±æ˜¯å°†è¿™äº›ç®¡é“è¿äº†èµ·æ¥ï¼Œè®©æ•°æ®ä¸€å£æ°”ä»å¤šä¸ªç®¡é“ä¸­ç©¿è¿‡</em>ã€‚</p><h3 id="æŸ¯é‡ŒåŒ–"><a href="#æŸ¯é‡ŒåŒ–" class="headerlink" title="æŸ¯é‡ŒåŒ–"></a>æŸ¯é‡ŒåŒ–</h3><p><code>f(x)</code>å’Œ<code>g(x)</code>åˆæˆä¸º<code>f(g(x))</code>ï¼Œæœ‰ä¸€ä¸ªéšè—çš„å‰æï¼Œå°±æ˜¯få’Œgéƒ½åªèƒ½æ¥å—ä¸€ä¸ªå‚æ•°ã€‚å¦‚æœå¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ï¼Œæ¯”å¦‚<code>f(x, y)</code>å’Œ<code>g(a, b, c)</code>ï¼Œå‡½æ•°åˆæˆå°±éå¸¸éº»çƒ¦ã€‚</p><p>è¿™æ—¶å€™å°±éœ€è¦æŸ¯é‡ŒåŒ–ï¼Œæ‰€è°“â€œæŸ¯é‡ŒåŒ–â€å°±æ˜¯æŠŠä¸€ä¸ªå¤šå‚æ•°çš„å‡½æ•°ï¼Œè½¬åŒ–ä¸ºå•å‚æ•°çš„å‡½æ•°</p><pre><code class="js">// æŸ¯é‡ŒåŒ–ä¹‹å‰function(x,y){    return x + y;}add (1,2) // 3// æŸ¯é‡ŒåŒ–ä¹‹åfunction(y){    return function(x){        return x + y;    }}add(2)(1); // 3</code></pre><p>æœ‰äº†æŸ¯é‡ŒåŒ–ä»¥åï¼Œæˆ‘ä»¬å°±èƒ½åšåˆ°ï¼Œæ‰€æœ‰å‡½æ•°åªæ¥å—ä¸€ä¸ªå‚æ•°ã€‚åæ–‡çš„å†…å®¹é™¤éå¦æœ‰è¯´æ˜ï¼Œéƒ½é»˜è®¤å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯æ‰€è¦å¤„ç†çš„é‚£ä¸ªå€¼ã€‚</p><h2 id="å‡½å­ï¼ˆfunctorï¼‰"><a href="#å‡½å­ï¼ˆfunctorï¼‰" class="headerlink" title="å‡½å­ï¼ˆfunctorï¼‰"></a>å‡½å­ï¼ˆfunctorï¼‰</h2><p>å‡½æ•°ä¸ä»…å¯ä»¥ç”¨äºåŒä¸€ä¸ªèŒƒç•´ä¹‹ä¸­å€¼çš„è½¬æ¢ï¼Œè¿˜å¯ä»¥ç”¨äºå°†ä¸€ä¸ªèŒƒç•´è½¬æˆå¦ä¸€ä¸ªèŒƒç•´ã€‚è¿™å°±æ¶‰åŠåˆ°äº†å‡½å­ï¼ˆFunctorï¼‰ã€‚</p><h3 id="å‡½å­çš„æ¦‚å¿µ"><a href="#å‡½å­çš„æ¦‚å¿µ" class="headerlink" title="å‡½å­çš„æ¦‚å¿µ"></a>å‡½å­çš„æ¦‚å¿µ</h3><p>å‡½å­æ˜¯å‡½æ•°å¼ç¼–ç¨‹é‡Œé¢æœ€é‡è¦çš„æ•°æ®ç±»å‹ï¼Œä¹Ÿæ˜¯åŸºæœ¬çš„è¿ç®—å•ä½å’ŒåŠŸèƒ½å•ä½ã€‚</p><p>å®ƒé¦–å…ˆæ˜¯ä¸€ç§èŒƒç•´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯ä¸€ä¸ªå®¹å™¨ï¼ŒåŒ…å«äº†å€¼å’Œå˜å½¢å…³ç³»ã€‚æ¯”è¾ƒç‰¹æ®Šçš„æ˜¯ï¼Œ<strong>å®ƒçš„å˜å½¢å…³ç³»å¯ä»¥ä¾æ¬¡ä½œç”¨äºæ¯ä¸€ä¸ªå€¼ï¼Œå°†å½“å‰å®¹å™¨å˜å½¢æˆå¦ä¸€ä¸ªå®¹å™¨</strong>ã€‚</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017022203.png" alt="functor"></p><p>ä¸Šå›¾ä¸­ï¼Œå·¦ä¾§çš„åœ†åœˆå°±æ˜¯ä¸€ä¸ªå‡½å­ï¼Œè¡¨ç¤ºäººåçš„èŒƒç•´ã€‚å¤–éƒ¨ä¼ å…¥å‡½æ•°fï¼Œä¼šè½¬æˆå³è¾¹è¡¨ç¤ºæ—©é¤çš„èŒƒç•´ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€å¼ æ›´ä¸€èˆ¬çš„å›¾ã€‚</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017022211.jpg" alt="functor-1"></p><p>ä¸Šå›¾ä¸­ï¼Œå‡½æ•°få®Œæˆå€¼çš„è½¬æ¢<code>ï¼ˆaåˆ°bï¼‰</code>ï¼Œå°†å®ƒä¼ å…¥<code>å‡½å­</code>ï¼Œå°±å¯ä»¥å®ç°èŒƒç•´çš„è½¬æ¢<code>ï¼ˆFaåˆ°Fbï¼‰</code>ã€‚</p><h3 id="å‡½å­çš„ä»£ç å®ç°"><a href="#å‡½å­çš„ä»£ç å®ç°" class="headerlink" title="å‡½å­çš„ä»£ç å®ç°"></a>å‡½å­çš„ä»£ç å®ç°</h3><p>ä»»ä½•å…·æœ‰<code>map</code>æ–¹æ³•çš„æ•°æ®ç»“æ„ï¼Œéƒ½å¯ä»¥å½“ä½œå‡½å­çš„å®ç°ã€‚</p><pre><code class="js">class Functor{    construcor(val){        this.val = val;    }    map(f){        return new Functor(f(this.val));    }}</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Functor</code>æ˜¯ä¸€ä¸ªå‡½å­ï¼Œå®ƒçš„<code>map</code>æ–¹æ³•æ¥å—å‡½æ•°<code>f</code>ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å‡½å­ï¼Œé‡Œé¢åŒ…å«çš„å€¼æ˜¯è¢«få¤„ç†è¿‡çš„<code>ï¼ˆf(this.val)ï¼‰</code>ã€‚<br><strong>ä¸€èˆ¬çº¦å®šï¼Œå‡½å­çš„æ ‡å¿—å°±æ˜¯å®¹å™¨å…·æœ‰<code>map</code>æ–¹æ³•ã€‚è¯¥æ–¹æ³•å°†å®¹å™¨é‡Œé¢çš„æ¯ä¸€ä¸ªå€¼ï¼Œæ˜ å°„åˆ°å¦ä¸€ä¸ªå®¹å™¨</strong>ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›ç”¨æ³•çš„ç¤ºä¾‹ã€‚</p><pre><code class="js">(new Functot(2)).map(function(two){    return two + 2;}); //Functor(4)(new Functor(&#39;flamethrowers&#39;)).map(function(s) {  return s.toUpperCase();});// Functor(&#39;FLAMETHROWERS&#39;)(new Functor(&#39;bombs&#39;)).map(_.concat(&#39; away&#39;)).map(_.prop(&#39;length&#39;));// Functor(10)</code></pre><p>ä¸Šé¢çš„ä¾‹å­è¯´æ˜ï¼Œå‡½æ•°å¼ç¼–ç¨‹é‡Œé¢çš„è¿ç®—ï¼Œéƒ½æ˜¯é€šè¿‡å‡½å­å®Œæˆï¼Œå³è¿ç®—ä¸ç›´æ¥é’ˆå¯¹å€¼ï¼Œè€Œæ˜¯é’ˆå¯¹è¿™ä¸ªå€¼çš„å®¹å™¨â€”-å‡½å­ã€‚å‡½å­æœ¬èº«å…·æœ‰å¯¹å¤–æ¥å£ï¼ˆ<code>mapæ–¹æ³•</code>ï¼‰ï¼Œå„ç§å‡½æ•°å°±æ˜¯è¿ç®—ç¬¦ï¼Œé€šè¿‡æ¥å£æ¥å…¥å®¹å™¨ï¼Œå¼•å‘å®¹å™¨é‡Œé¢çš„å€¼çš„å˜å½¢ã€‚</p><p>å› æ­¤ï¼Œå­¦ä¹ å‡½æ•°å¼ç¼–ç¨‹ï¼Œ<strong>å®é™…ä¸Šå°±æ˜¯å­¦ä¹ å‡½å­çš„å„ç§è¿ç®—</strong>ã€‚ç”±äºå¯ä»¥æŠŠè¿ç®—æ–¹æ³•å°è£…åœ¨å‡½å­é‡Œé¢ï¼Œæ‰€ä»¥åˆè¡ç”Ÿå‡ºå„ç§ä¸åŒç±»å‹çš„å‡½å­ï¼Œæœ‰å¤šå°‘ç§è¿ç®—ï¼Œå°±æœ‰å¤šå°‘ç§å‡½å­ã€‚å‡½æ•°å¼ç¼–ç¨‹å°±å˜æˆäº†è¿ç”¨ä¸åŒçš„å‡½å­ï¼Œè§£å†³å®é™…é—®é¢˜ã€‚</p><h2 id="ofæ–¹æ³•"><a href="#ofæ–¹æ³•" class="headerlink" title="ofæ–¹æ³•"></a>ofæ–¹æ³•</h2><p>ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œä¸Šé¢ç”Ÿæˆæ–°çš„å‡½å­çš„æ—¶å€™ï¼Œç”¨äº†newå‘½ä»¤ã€‚è¿™å®åœ¨å¤ªä¸åƒå‡½æ•°å¼ç¼–ç¨‹äº†ï¼Œå› ä¸ºnewå‘½ä»¤æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ‡å¿—ã€‚</p><p><strong>å‡½æ•°å¼ç¼–ç¨‹ä¸€èˆ¬çº¦å®šï¼Œå‡½å­æœ‰ä¸€ä¸ªofæ–¹æ³•ï¼Œç”¨æ¥ç”Ÿæˆæ–°çš„å®¹å™¨ã€‚</strong></p><p>ä¸‹é¢å°±ç”¨<code>of</code>æ–¹æ³•æ›¿æ¢æ‰<code>new</code>ã€‚</p><pre><code class="js">Functor.of = function(val) {  return new Functor(val);};</code></pre><p>è¿™å°±æ›´åƒå‡½æ•°å¼ç¼–ç¨‹äº†ã€‚</p><h2 id="Maybe-å‡½å­"><a href="#Maybe-å‡½å­" class="headerlink" title="Maybe å‡½å­"></a>Maybe å‡½å­</h2><p>å‡½å­æ¥å—å„ç§å‡½æ•°ï¼Œå¤„ç†å®¹å™¨å†…éƒ¨çš„å€¼ã€‚è¿™é‡Œå°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå®¹å™¨å†…éƒ¨çš„å€¼å¯èƒ½æ˜¯ä¸€ä¸ªç©ºå€¼ï¼ˆæ¯”å¦‚<code>null</code>ï¼‰ï¼Œè€Œå¤–éƒ¨å‡½æ•°æœªå¿…æœ‰å¤„ç†ç©ºå€¼çš„æœºåˆ¶ï¼Œå¦‚æœä¼ å…¥ç©ºå€¼ï¼Œå¾ˆå¯èƒ½å°±ä¼šå‡ºé”™ã€‚</p><pre><code class="js">Functor.of(null).map(function (s) {  return s.toUpperCase();});// TypeError</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½å­é‡Œé¢çš„å€¼æ˜¯<code>null</code>ï¼Œç»“æœå°å†™å˜æˆå¤§å†™çš„æ—¶å€™å°±å‡ºé”™äº†ã€‚</p><p>Maybe å‡½å­å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€ç±»é—®é¢˜è€Œè®¾è®¡çš„ã€‚ç®€å•è¯´ï¼Œ<strong>å®ƒçš„mapæ–¹æ³•é‡Œé¢è®¾ç½®äº†ç©ºå€¼æ£€æŸ¥</strong>ã€‚</p><pre><code class="js">class Maybe extends Functor {  map(f) {    return this.val ? Maybe.of(f(this.val)) : Maybe.of(null);  }</code></pre><p>æœ‰äº† Maybe å‡½å­ï¼Œå¤„ç†ç©ºå€¼å°±ä¸ä¼šå‡ºé”™äº†ã€‚</p><pre><code class="js">Maybe.of(null).map(function (s) {  return s.toUpperCase();});// Maybe(null)</code></pre><h2 id="Eitherå‡½å­"><a href="#Eitherå‡½å­" class="headerlink" title="Eitherå‡½å­"></a>Eitherå‡½å­</h2><p>æ¡ä»¶è¿ç®—<code>if...else</code>æ˜¯æœ€å¸¸è§çš„è¿ç®—ä¹‹ä¸€ï¼Œå‡½æ•°å¼ç¼–ç¨‹é‡Œé¢ï¼Œä½¿ç”¨<code>Either</code>å‡½å­è¡¨è¾¾ã€‚</p><p>Either å‡½å­å†…éƒ¨æœ‰ä¸¤ä¸ªå€¼ï¼š<code>å·¦å€¼ï¼ˆLeftï¼‰</code>å’Œ<code>å³å€¼ï¼ˆRightï¼‰</code>ã€‚å³å€¼æ˜¯æ­£å¸¸æƒ…å†µä¸‹ä½¿ç”¨çš„å€¼ï¼Œå·¦å€¼æ˜¯å³å€¼ä¸å­˜åœ¨æ—¶ä½¿ç”¨çš„é»˜è®¤å€¼ã€‚</p><pre><code class="js">class Either extends Functor{    construcor(left,right){        this.left = left;        this.right = right;    }    map(f){        return this.right ? Either.of(this.left,f(this.right)) : Either.of(f(this.left),this.right);    }}Either.of = function(left,right){    return new Either(left,right);}// ä¸‹é¢æ˜¯ç”¨æ³•ã€‚var addOne = function (x) {  return x + 1;};Either.of(5, 6).map(addOne);// Either(5, 7);Either.of(1, null).map(addOne);// Either(2, null);</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå³å€¼æœ‰å€¼ï¼Œå°±ä½¿ç”¨å³å€¼ï¼Œå¦åˆ™ä½¿ç”¨å·¦å€¼ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒEither å‡½å­è¡¨è¾¾äº†æ¡ä»¶è¿ç®—ã€‚</p><p><strong>Either å‡½å­çš„å¸¸è§ç”¨é€”æ˜¯æä¾›é»˜è®¤å€¼</strong>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><pre><code class="js">Either.of({address: &#39;xxx&#39;}, currentUser.address).map(updateField);</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰æä¾›åœ°å€ï¼ŒEither å‡½å­å°±ä¼šä½¿ç”¨å·¦å€¼çš„é»˜è®¤åœ°å€ã€‚</p><p>Either å‡½å­çš„å¦ä¸€ä¸ªç”¨é€”æ˜¯ä»£æ›¿<code>try...catch</code>ï¼Œä½¿ç”¨å·¦å€¼è¡¨ç¤ºé”™è¯¯ã€‚</p><pre><code class="js">function parseJSON(json) {  try {    return Either.of(null, JSON.parse(json));  } catch (e: Error) {    return Either.of(e, null);  }}</code></pre><h2 id="apå‡½å­"><a href="#apå‡½å­" class="headerlink" title="apå‡½å­"></a>apå‡½å­</h2><p>å‡½å­é‡Œé¢åŒ…å«çš„å€¼ï¼Œå®Œå…¨å¯èƒ½æ˜¯å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥æƒ³è±¡è¿™æ ·ä¸€ç§æƒ…å†µï¼Œä¸€ä¸ªå‡½å­çš„å€¼æ˜¯æ•°å€¼ï¼Œå¦ä¸€ä¸ªå‡½å­çš„å€¼æ˜¯å‡½æ•°ã€‚</p><pre><code class="js">function addTwo(x) {  return x + 2;}const A = Functor.of(2);const B = Functor.of(addTwo)</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½å­Aå†…éƒ¨çš„å€¼æ˜¯2ï¼Œå‡½å­Bå†…éƒ¨çš„å€¼æ˜¯å‡½æ•°addTwoã€‚</p><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬æƒ³è®©å‡½å­Bå†…éƒ¨çš„å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨å‡½å­Aå†…éƒ¨çš„å€¼è¿›è¡Œè¿ç®—ã€‚è¿™æ—¶å°±éœ€è¦ç”¨åˆ° <strong>ap å‡½å­</strong>ã€‚</p><p><strong>ap æ˜¯ applicativeï¼ˆåº”ç”¨ï¼‰çš„ç¼©å†™</strong>ã€‚å‡¡æ˜¯éƒ¨ç½²äº†apæ–¹æ³•çš„å‡½å­ï¼Œå°±æ˜¯ ap å‡½å­ã€‚</p><pre><code class="js">class Ap extends Functor{    ap(F){        return Ap.of(this.val(F.val));    }}</code></pre><blockquote><p>æ³¨æ„ï¼Œapæ–¹æ³•çš„å‚æ•°ä¸æ˜¯å‡½æ•°ï¼Œè€Œæ˜¯å¦ä¸€ä¸ªå‡½å­ã€‚</p></blockquote><p>å› æ­¤ï¼Œå‰é¢ä¾‹å­å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼ã€‚</p><pre><code class="js">Ap.of(addTwo).ap(Functor.of(2))//Ap(4)</code></pre><p>ap å‡½å­çš„æ„ä¹‰åœ¨äºï¼Œ<strong>å¯¹äºé‚£äº›å¤šå‚æ•°çš„å‡½æ•°ï¼Œå°±å¯ä»¥ä»å¤šä¸ªå®¹å™¨ä¹‹ä¸­å–å€¼ï¼Œå®ç°å‡½å­çš„é“¾å¼æ“ä½œ</strong>ã€‚</p><pre><code class="js">function add (y){    return function(y){        return x + y;    }}Ap.of(add).ap(Maybe.of(2)).ap(Maybe.of(3)); //Ap(5)</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°addæ˜¯æŸ¯é‡ŒåŒ–ä»¥åçš„å½¢å¼ï¼Œä¸€å…±éœ€è¦ä¸¤ä¸ªå‚æ•°ã€‚é€šè¿‡ ap å‡½å­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°ä»ä¸¤ä¸ªå®¹å™¨ä¹‹ä¸­å–å€¼ã€‚å®ƒè¿˜æœ‰å¦å¤–ä¸€ç§å†™æ³•ã€‚</p><pre><code class="js">Ap.of(add(2).ap(Maybe.of(3)));</code></pre><h2 id="Monad-å‡½å­"><a href="#Monad-å‡½å­" class="headerlink" title="Monad å‡½å­"></a>Monad å‡½å­</h2><p>å‡½å­æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥åŒ…å«ä»»ä½•å€¼ã€‚å‡½å­ä¹‹ä¸­å†åŒ…å«ä¸€ä¸ªå‡½å­ï¼Œä¹Ÿæ˜¯å®Œå…¨åˆæ³•çš„ã€‚ä½†æ˜¯ï¼Œè¿™æ ·å°±ä¼šå‡ºç°å¤šå±‚åµŒå¥—çš„å‡½å­ã€‚</p><pre><code class="js">Maybe.of(  Maybe.of(    Maybe.of({name: &#39;Mulburry&#39;, number: 8402})  ))</code></pre><p>ä¸Šé¢è¿™ä¸ªå‡½å­ï¼Œä¸€å…±æœ‰ä¸‰ä¸ª<code>MaybeåµŒå¥—</code>ã€‚å¦‚æœè¦å–å‡ºå†…éƒ¨çš„å€¼ï¼Œå°±è¦è¿ç»­å–ä¸‰æ¬¡<code>this.val</code>ã€‚è¿™å½“ç„¶å¾ˆä¸æ–¹ä¾¿ï¼Œå› æ­¤å°±å‡ºç°äº† <strong>Monad å‡½å­</strong>ã€‚</p><p><font color = "red">Monad å‡½å­çš„ä½œç”¨æ˜¯ï¼Œæ€»æ˜¯è¿”å›ä¸€ä¸ªå•å±‚çš„å‡½å­</font>ã€‚å®ƒæœ‰ä¸€ä¸ªflatMapæ–¹æ³•ï¼Œä¸mapæ–¹æ³•ä½œç”¨ç›¸åŒï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯<code>å¦‚æœç”Ÿæˆäº†ä¸€ä¸ªåµŒå¥—å‡½å­ï¼Œå®ƒä¼šå–å‡ºåè€…å†…éƒ¨çš„å€¼ï¼Œä¿è¯è¿”å›çš„æ°¸è¿œæ˜¯ä¸€ä¸ªå•å±‚çš„å®¹å™¨ï¼Œä¸ä¼šå‡ºç°åµŒå¥—çš„æƒ…å†µ</code>ã€‚</p><pre><code class="js">class Monad extends Functor {  join() {    return this.val;  }  flatMap(f) {    return this.map(f).join();  }}</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå‡½æ•°<code>f</code>è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½å­ï¼Œé‚£ä¹ˆ<code>this.map(f)</code>å°±ä¼šç”Ÿæˆä¸€ä¸ªåµŒå¥—çš„å‡½å­ã€‚æ‰€ä»¥ï¼Œ<code>join</code>æ–¹æ³•ä¿è¯äº†<code>flatMap</code>æ–¹æ³•æ€»æ˜¯è¿”å›ä¸€ä¸ªå•å±‚çš„å‡½å­ã€‚è¿™æ„å‘³ç€åµŒå¥—çš„å‡½å­ä¼šè¢«é“ºå¹³ï¼ˆ<code>flatten</code>ï¼‰ã€‚</p><h2 id="IO-æ“ä½œ"><a href="#IO-æ“ä½œ" class="headerlink" title="IO æ“ä½œ"></a>IO æ“ä½œ</h2><p>Monad å‡½å­çš„é‡è¦åº”ç”¨ï¼Œå°±æ˜¯<strong>å®ç° I/O ï¼ˆè¾“å…¥è¾“å‡ºï¼‰æ“ä½œ</strong>ã€‚</p><pre><code class="js">var fs = require(&#39;fs&#39;);var readFile = function(filename){    return new IO(function(){        return fs.readFileSync(filename,&#39;utf-8&#39;);    });}var print = function(x) {  return new IO(function() {    console.log(x);    return x;  });}</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè¯»å–æ–‡ä»¶å’Œæ‰“å°æœ¬èº«éƒ½æ˜¯ä¸çº¯çš„æ“ä½œï¼Œä½†æ˜¯readFileå’Œprintå´æ˜¯çº¯å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬æ€»æ˜¯è¿”å› IO å‡½å­ã€‚</p><p>å¦‚æœ IO å‡½å­æ˜¯ä¸€ä¸ª<code>Monad</code>ï¼Œå…·æœ‰<code>flatMap</code>æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åƒä¸‹é¢è¿™æ ·è°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•°ã€‚</p><pre><code class="js">readFile(&#39;./user.txt&#39;).flatMap(print)</code></pre><p>è¿™å°±æ˜¯ç¥å¥‡çš„åœ°æ–¹ï¼Œä¸Šé¢çš„ä»£ç å®Œæˆäº†ä¸çº¯çš„æ“ä½œï¼Œä½†æ˜¯å› ä¸º<code>flatMap</code>è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª IO å‡½å­ï¼Œæ‰€ä»¥è¿™ä¸ªè¡¨è¾¾å¼æ˜¯çº¯çš„ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªçº¯çš„è¡¨è¾¾å¼ï¼Œå®Œæˆå¸¦æœ‰å‰¯ä½œç”¨çš„æ“ä½œï¼Œè¿™å°±æ˜¯ Monad çš„ä½œç”¨ã€‚</p><p>ç”±äºè¿”å›è¿˜æ˜¯ IO å‡½å­ï¼Œæ‰€ä»¥å¯ä»¥å®ç°<em>é“¾å¼æ“ä½œ</em>ã€‚å› æ­¤ï¼Œåœ¨å¤§å¤šæ•°åº“é‡Œé¢ï¼Œ<code>flatMap</code>æ–¹æ³•è¢«æ”¹åæˆ<code>chain</code>ã€‚</p><pre><code class="js">var tail = function(x) {  return new IO(function() {    return x[x.length - 1];  });}readFile(&#39;./user.txt&#39;).flatMap(tail).flatMap(print)// ç­‰åŒäºreadFile(&#39;./user.txt&#39;).chain(tail).chain(print)</code></pre><p>ä¸Šé¢ä»£ç è¯»å–äº†æ–‡ä»¶<code>user.txt</code>ï¼Œç„¶åé€‰å–æœ€åä¸€è¡Œè¾“å‡ºã€‚</p><p><a href="http://www.ruanyifeng.com/blog/2017/02/fp-tutorial.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å‡½æ•°å¼ç¼–ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°è£…å¸¸ç”¨çš„è·¨æµè§ˆå™¨çš„äº‹ä»¶å¯¹è±¡</title>
      <link href="/2018/05/01/Js/%E5%B0%81%E8%A3%85%E5%B8%B8%E7%94%A8%E7%9A%84%E8%B7%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1EventUtil/"/>
      <url>/2018/05/01/Js/%E5%B0%81%E8%A3%85%E5%B8%B8%E7%94%A8%E7%9A%84%E8%B7%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1EventUtil/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘æŠŠã€Šjavascripté«˜çº§ç¨‹åºè®¾è®¡ã€‹çœ‹å®Œäº†ï¼Œå‘ç°é‡Œé¢æœ‰å¾ˆå¤šè·¨æµè§ˆå™¨çš„ä»£ç ï¼Œæ€»ç»“ä¸€ä¸‹ï¼Œæ–¹ä¾¿è®°å½•ã€‚</p><h2 id="è·¨æµè§ˆå™¨çš„äº‹ä»¶å¯¹è±¡EventUtil-äº‹ä»¶å¤„ç†ç¨‹åº"><a href="#è·¨æµè§ˆå™¨çš„äº‹ä»¶å¯¹è±¡EventUtil-äº‹ä»¶å¤„ç†ç¨‹åº" class="headerlink" title="è·¨æµè§ˆå™¨çš„äº‹ä»¶å¯¹è±¡EventUtil(äº‹ä»¶å¤„ç†ç¨‹åº)"></a>è·¨æµè§ˆå™¨çš„äº‹ä»¶å¯¹è±¡EventUtil(äº‹ä»¶å¤„ç†ç¨‹åº)</h2><pre><code class="js">var EventUtil = {    addHandler: function(element,type,handler) { //äº‹ä»¶ç›‘å¬        if(element.addEventListener) {            element.addEventListener(type,handler,false);        }else if(element.attachEvent) {            element.attachEvent(&quot;on&quot;+type,handler);        }else {            element[&quot;on&quot; +type] = handler;        }    },    removeHandler: function(element,type,handler){ //ç§»é™¤äº‹ä»¶ç›‘å¬        if(element.removeEventListener) {            element.removeEventListener(type,handler,false);        }else if(element.detachEvent) {            element.detachEvent(&quot;on&quot;+type,handler);        }else {            element[&quot;on&quot; +type] = null;        }    },    getEvent: function(event) {//è·å–eventå¯¹è±¡ï¼Œè¿”å›eventå¯¹è±¡çš„å¼•ç”¨        return event ? event : window.event;    },    getTarget: function(event) {//è¿”å›äº‹ä»¶ç›®æ ‡ã€‚        return event.target || event.srcElement;    },    preventDefault: function(event){//å–æ¶ˆæˆ–è€…é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸º        if(event.preventDefault) {            event.preventDefault();        }else {            event.returnValue = false;        }    },    stopPropagation: function(event) {//é˜»æ­¢äº‹ä»¶æµï¼Œé˜»æ­¢äº‹ä»¶å†’æ³¡        if(event.stopPropagation) {            event.stopPropagation();        }else {            event.cancelBubble = true;        }    },    getRelatedTarget: function(event){//è¿”å›ç›¸å…³å…ƒç´ ä¿¡æ¯ï¼ˆä»…å¯¹äºmouseoverå’Œmouseoutäº‹ä»¶ï¼‰        if (event.relatedTarget){            return event.relatedTarget;        } else if (event.toElement){            return event.toElement;        } else if (event.fromElement){            return event.fromElement;        } else {            return null;        }    },    getWheelDelta: function(event) {//è·å–é¼ æ ‡æ»šè½®å¢é‡å€¼ï¼Œæ£€æµ‹æ˜¯å¦åŒ…å«WheelDelta        if(event.wheelDelta) {            return event.wheelDelta;        }else {            return -event.detail * 40        }    },    getCharCode: function(event) {//è·å–é”®ç›˜æŒ‰é”®é”®ç ã€‚        if(typeof event.charCode == &#39;number&#39;) {            return event.charCode;        }else {            return event.keyCode;        }    },    getButton:function(event){//åœ¨mouseupæˆ–è€…mousedownçš„æ—¶å€™ï¼Œeventå­˜åœ¨ä¸€ä¸ªbuttonå±æ€§ï¼Œç”¨äºåˆ¤æ–­æ˜¯æŒ‰äº†é¼ æ ‡å·¦é”®ï¼Œå³é”®ï¼Œè¿˜æ˜¯ä¸­é”®ï¼Œ0é¼ æ ‡ä¸»é”®æŒ‰é’®ï¼Œ1æ˜¯ä¸­é—´ï¼Œ2æ˜¯æ¬¡é”®ï¼ˆå³é”®ï¼‰        if(document.implementation.hasFeature(&quot;MouseEvents&quot;,&quot;2.0&quot;)){            return event.button;        }else{            switch(event.button){                case 0:                case 1:                case 3:                case 5:                case 7:                  return 0;                case 2:                case 6:                   return 2;                case 4:                  return 1;            }        }    }};</code></pre><a id="more"></a><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><p>ä¾‹å¦‚clickäº‹ä»¶</p><pre><code class="js">var btn1 = document.getElementById(&quot;myBtn1&quot;);var handler = function(){alert(&quot;hello haorooms&quot;);}EventUtil.addHandler(btn1, &quot;click&quot;, handler);//EventUtil.removeHandler(btn1, &quot;click&quot;, handler);</code></pre>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React V16.3 å³å°†æ›´æ”¹çš„ç”Ÿå‘½å‘¨æœŸ</title>
      <link href="/2018/04/30/React/React-V16-3-%E5%8D%B3%E5%B0%86%E6%9B%B4%E6%94%B9%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
      <url>/2018/04/30/React/React-V16-3-%E5%8D%B3%E5%B0%86%E6%9B%B4%E6%94%B9%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="å³å°†æ›´æ”¹çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#å³å°†æ›´æ”¹çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="å³å°†æ›´æ”¹çš„ç”Ÿå‘½å‘¨æœŸ"></a>å³å°†æ›´æ”¹çš„ç”Ÿå‘½å‘¨æœŸ</h1><p>ä¸€å¹´å¤šæ¥ï¼ŒReactå›¢é˜Ÿä¸€ç›´è‡´åŠ›äºå®ç°å¼‚æ­¥æ¸²æŸ“ã€‚ä¸Šä¸ªæœˆï¼Œä»–åœ¨JSConfå†°å²›çš„æ¼”è®²ä¸­ï¼Œä¸¹æ­ç¤ºäº†ä¸€äº›ä»¤äººå…´å¥‹çš„æ–°çš„å¼‚æ­¥æ¸²æŸ“å¯èƒ½æ€§ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸æ‚¨åˆ†äº«æˆ‘ä»¬åœ¨å­¦ä¹ è¿™äº›åŠŸèƒ½æ—¶å­¦åˆ°çš„ä¸€äº›ç»éªŒæ•™è®­ï¼Œä»¥åŠä¸€äº›å¸®åŠ©æ‚¨å‡†å¤‡ç»„ä»¶ä»¥åœ¨å¯åŠ¨æ—¶è¿›è¡Œå¼‚æ­¥æ¸²æŸ“çš„æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬äº†è§£åˆ°çš„æœ€å¤§é—®é¢˜ä¹‹ä¸€æ˜¯ï¼Œæˆ‘ä»¬çš„ä¸€äº›ä¼ ç»Ÿç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¼šå¯¼è‡´ä¸€äº›ä¸å®‰å…¨çš„ç¼–ç å®è·µã€‚ä»–ä»¬æ˜¯ï¼š</p><ul><li>componentWillMount</li><li>componentWillReceiveProps</li><li>componentWillUpdate</li></ul><p>è¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ç»å¸¸è¢«è¯¯è§£å’Œæ»¥ç”¨;æ­¤å¤–ï¼Œæˆ‘ä»¬é¢„è®¡ä»–ä»¬çš„æ½œåœ¨æ»¥ç”¨å¯èƒ½åœ¨å¼‚æ­¥æ¸²æŸ“æ–¹é¢æœ‰æ›´å¤§çš„é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åœ¨å³å°†å‘å¸ƒçš„ç‰ˆæœ¬ä¸­ä¸ºè¿™äº›ç”Ÿå‘½å‘¨æœŸæ·»åŠ ä¸€ä¸ªâ€œ<code>UNSAFE_</code>â€å‰ç¼€ã€‚ ï¼ˆè¿™é‡Œï¼Œâ€œä¸å®‰å…¨â€ä¸æ˜¯æŒ‡å®‰å…¨æ€§ï¼Œè€Œæ˜¯è¡¨ç¤ºä½¿ç”¨è¿™äº›ç”Ÿå‘½å‘¨æœŸçš„ä»£ç å°†æ›´æœ‰å¯èƒ½åœ¨æœªæ¥çš„Reactç‰ˆæœ¬ä¸­å­˜åœ¨ç¼ºé™·ï¼Œç‰¹åˆ«æ˜¯ä¸€æ—¦å¯ç”¨äº†å¼‚æ­¥æ¸²æŸ“ï¼‰ã€‚</p><h2 id="é€æ­¥è¿ç§»è·¯å¾„"><a href="#é€æ­¥è¿ç§»è·¯å¾„" class="headerlink" title="é€æ­¥è¿ç§»è·¯å¾„"></a>é€æ­¥è¿ç§»è·¯å¾„</h2><p>Reactéµå¾ªè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶, æ‰€ä»¥è¿™ç§æ”¹å˜å°†æ˜¯æ¸è¿›çš„ã€‚æˆ‘ä»¬ç›®å‰çš„è®¡åˆ’æ˜¯ï¼š</p><ul><li><p><strong>16.3</strong>ï¼šä¸ºä¸å®‰å…¨ç”Ÿå‘½å‘¨æœŸå¼•å…¥åˆ«åUNSAFE_componentWillMountï¼ŒUNSAFE_componentWillReceivePropså’ŒUNSAFE_componentWillUpdateã€‚ ï¼ˆæ—§çš„ç”Ÿå‘½å‘¨æœŸåç§°å’Œæ–°çš„åˆ«åéƒ½å¯ä»¥åœ¨æ­¤ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚ï¼‰</p></li><li><p><strong>æœªæ¥çš„16.xç‰ˆæœ¬</strong>ï¼šä¸ºcomponentWillMountï¼ŒcomponentWillReceivePropså’ŒcomponentWillUpdateå¯ç”¨å¼ƒç”¨è­¦å‘Šã€‚ ï¼ˆæ—§çš„ç”Ÿå‘½å‘¨æœŸåç§°å’Œæ–°çš„åˆ«åéƒ½å¯ä»¥åœ¨æ­¤ç‰ˆæœ¬ä¸­ä½¿ç”¨ï¼Œä½†æ—§åç§°ä¼šè®°å½•DEVæ¨¡å¼è­¦å‘Šã€‚ï¼‰</p></li><li><p><strong>17.0</strong>ï¼šåˆ é™¤componentWillMountï¼ŒcomponentWillReceivePropså’ŒcomponentWillUpdateã€‚ ï¼ˆä»ç°åœ¨å¼€å§‹ï¼Œåªæœ‰æ–°çš„â€œUNSAFE_â€ç”Ÿå‘½å‘¨æœŸåç§°å°†èµ·ä½œç”¨ã€‚ï¼‰</p></li></ul><p><strong>è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨æ˜¯Reactåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œé‚£ä¹ˆæ‚¨ä¸å¿…å¯¹é—ç•™æ–¹æ³•è¿›è¡Œä»»ä½•æ“ä½œã€‚å³å°†å‘å¸ƒçš„16.3ç‰ˆæœ¬çš„ä¸»è¦ç›®çš„æ˜¯è®©å¼€æºé¡¹ç›®ç»´æŠ¤äººå‘˜åœ¨ä»»ä½•å¼ƒç”¨è­¦å‘Šä¹‹å‰æ›´æ–°å…¶åº“ã€‚è¿™äº›è­¦å‘Šå°†åœ¨æœªæ¥çš„16.xç‰ˆæœ¬å‘å¸ƒä¹‹å‰ä¸ä¼šå¯ç”¨</strong>ã€‚</p><h2 id="ä»ä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸè¿ç§»"><a href="#ä»ä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸè¿ç§»" class="headerlink" title="ä»ä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸè¿ç§»"></a>ä»ä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸè¿ç§»</h2><p>å¦‚æœæ‚¨æƒ³å¼€å§‹ä½¿ç”¨React 16.3ä¸­å¼•å…¥çš„æ–°ç»„ä»¶APIï¼ˆæˆ–è€…å¦‚æœæ‚¨æ˜¯ç»´æŠ¤äººå‘˜æå‰æ›´æ–°åº“ï¼‰ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™äº›ç¤ºä¾‹å¯ä»¥å¸®åŠ©æ‚¨å¼€å§‹è€ƒè™‘ç»„ä»¶çš„å˜åŒ–ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæˆ‘ä»¬è®¡åˆ’åœ¨æ–‡æ¡£ä¸­æ·»åŠ é¢å¤–çš„â€œé…æ–¹â€ï¼Œä»¥å±•ç¤ºå¦‚ä½•ä»¥é¿å…æœ‰é—®é¢˜çš„ç”Ÿå‘½å‘¨æœŸçš„æ–¹å¼æ‰§è¡Œå¸¸è§ä»»åŠ¡ã€‚</p><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å°†ç®€è¦æ¦‚è¿°ä¸º16.3ç‰ˆè®¡åˆ’çš„ç”Ÿå‘½å‘¨æœŸæ›´æ”¹ï¼š</p><ul><li>æˆ‘ä»¬æ­£åœ¨æ·»åŠ ä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸåˆ«åï¼š</li></ul><p>(1) UNSAFE_componentWillMountï¼Œ</p><p>(2) UNSAFE_componentWillReceiveProps</p><p>(3) UNSAFE_componentWillUpdateã€‚ ï¼ˆæ—§çš„ç”Ÿå‘½å‘¨æœŸåç§°å’Œæ–°çš„åˆ«åéƒ½å°†å—æ”¯æŒã€‚ï¼‰</p><ul><li>æˆ‘ä»¬ä»‹ç»äº†ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸï¼Œåˆ†åˆ«æ˜¯getDerivedStateFromPropså’ŒgetSnapshotBeforeUpdateã€‚</li></ul><h3 id="æ–°çš„ç”Ÿå‘½å‘¨æœŸ-getDerivedStateFromProps"><a href="#æ–°çš„ç”Ÿå‘½å‘¨æœŸ-getDerivedStateFromProps" class="headerlink" title="æ–°çš„ç”Ÿå‘½å‘¨æœŸ: getDerivedStateFromProps"></a>æ–°çš„ç”Ÿå‘½å‘¨æœŸ: getDerivedStateFromProps</h3><a id="more"></a><pre><code class="js">class Example extends React.Component {  static getDerivedStateFromProps(nextProps, prevState) {    // ...  }}</code></pre><p>æ–°çš„é™æ€<code>getDerivedStateFromProps</code>ç”Ÿå‘½å‘¨æœŸåœ¨ç»„ä»¶å®ä¾‹åŒ–ä»¥åŠæ¥æ”¶æ–°<code>props</code>åè°ƒç”¨ã€‚å®ƒå¯ä»¥è¿”å›ä¸€ä¸ªå¯¹è±¡æ¥æ›´æ–°<code>state</code>ï¼Œæˆ–è€…è¿”å›nullæ¥è¡¨ç¤ºæ–°çš„<code>props</code>ä¸éœ€è¦ä»»ä½•<code>state</code>æ›´æ–°ã€‚</p><p>ä¸<code>componentDidUpdate</code>ä¸€èµ·ï¼Œè¿™ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸåº”è¯¥è¦†ç›–ä¼ ç»Ÿ<code>componentWillReceiveProps</code>çš„æ‰€æœ‰ç”¨ä¾‹ã€‚</p><h3 id="æ–°çš„ç”Ÿå‘½å‘¨æœŸ-getSnapshotBeforeUpdate"><a href="#æ–°çš„ç”Ÿå‘½å‘¨æœŸ-getSnapshotBeforeUpdate" class="headerlink" title="æ–°çš„ç”Ÿå‘½å‘¨æœŸ: getSnapshotBeforeUpdate"></a>æ–°çš„ç”Ÿå‘½å‘¨æœŸ: getSnapshotBeforeUpdate</h3><pre><code class="js">class Example extends React.Component {  getSnapshotBeforeUpdate(prevProps, prevState) {    // ...  }}</code></pre><p>æ–°çš„<code>getSnapshotBeforeUpdate</code>ç”Ÿå‘½å‘¨æœŸåœ¨æ›´æ–°ä¹‹å‰è¢«è°ƒç”¨ï¼ˆä¾‹å¦‚ï¼Œåœ¨DOMè¢«æ›´æ–°ä¹‹å‰ï¼‰ã€‚æ­¤ç”Ÿå‘½å‘¨æœŸçš„è¿”å›å€¼å°†ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™<code>componentDidUpdate</code>ã€‚ ï¼ˆè¿™ä¸ªç”Ÿå‘½å‘¨æœŸä¸æ˜¯ç»å¸¸éœ€è¦çš„ï¼Œä½†å¯ä»¥ç”¨äºåœ¨æ¢å¤æœŸé—´æ‰‹åŠ¨ä¿å­˜æ»šåŠ¨ä½ç½®çš„æƒ…å†µã€‚ï¼‰</p><p>You can find their type signatures in this gist.</p><p>æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ä½¿ç”¨è¿™ä¸¤ç§ç”Ÿå‘½å‘¨æœŸçš„ï¼Œä¾‹å­å¦‚ä¸‹:</p><h4 id="ä¾‹å¦‚"><a href="#ä¾‹å¦‚" class="headerlink" title="ä¾‹å¦‚"></a>ä¾‹å¦‚</h4><ul><li><p>Initializing stateï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰Ini</p></li><li><p>Fetching external dataï¼ˆè·å–å¤–éƒ¨æ•°æ®ï¼‰</p></li><li><p>Adding event listenersï¼ˆæ·»åŠ äº‹ä»¶ç›‘å¬ï¼‰</p></li><li><p>Updating state based on propsï¼ˆåŸºäºpropsæ›´æ–°stateï¼‰</p></li><li><p>Invoking external callbacks(è°ƒç”¨å¤–éƒ¨çš„callbacks)</p></li><li><p>Side effects on props change</p></li><li><p>Fetching external data when props changeï¼ˆpropsæ”¹å˜æ—¶è·å–å¤–éƒ¨æ•°æ®ï¼‰</p></li><li><p>Reading DOM properties before an update(åœ¨æ›´æ–°ä¹‹å‰è¯»å–DOMå±æ€§)</p></li></ul><blockquote><p>æ³¨æ„<br>ä¸ºç®€æ´èµ·è§ï¼Œä¸‹é¢çš„ç¤ºä¾‹æ˜¯ä½¿ç”¨å®éªŒç±»å±æ€§è½¬æ¢ç¼–å†™çš„ï¼Œä½†å¦‚æœæ²¡æœ‰å®ƒï¼Œåˆ™åº”ç”¨ç›¸åŒçš„è¿ç§»ç­–ç•¥ã€‚</p></blockquote><h3 id="åˆå§‹åŒ–çŠ¶æ€ï¼š"><a href="#åˆå§‹åŒ–çŠ¶æ€ï¼š" class="headerlink" title="åˆå§‹åŒ–çŠ¶æ€ï¼š"></a>åˆå§‹åŒ–çŠ¶æ€ï¼š</h3><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªè°ƒç”¨<code>componentWillMount</code>ä¸­å¸¦æœ‰<code>setState</code>çš„ç»„ä»¶ï¼š</p><pre><code class="js">// Beforeclass ExampleComponent extends React.Component {  state = {};  componentWillMount() {    this.setState({      currentColor: this.props.defaultColor,      palette: &#39;rgb&#39;,    });  }}</code></pre><p>è¿™ç§ç±»å‹çš„ç»„ä»¶æœ€ç®€å•çš„é‡æ„æ˜¯å°†çŠ¶æ€åˆå§‹åŒ–ç§»åŠ¨åˆ°æ„é€ å‡½æ•°æˆ–å±æ€§åˆå§‹å€¼è®¾å®šé¡¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="js">// Afterclass ExampleComponent extends React.Component {  state = {    currentColor: this.props.defaultColor,    palette: &#39;rgb&#39;,  };}</code></pre><h3 id="è·å–å¤–éƒ¨æ•°æ®"><a href="#è·å–å¤–éƒ¨æ•°æ®" class="headerlink" title="è·å–å¤–éƒ¨æ•°æ®"></a>è·å–å¤–éƒ¨æ•°æ®</h3><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨componentWillMountè·å–å¤–éƒ¨æ•°æ®çš„ç»„ä»¶ç¤ºä¾‹ï¼š</p><pre><code class="js">// Beforeclass ExampleComponent extends React.Component {  state = {    externalData: null,  };  componentWillMount() {    this._asyncRequest = asyncLoadData().then(      externalData =&gt; {        this._asyncRequest = null;        this.setState({externalData});      }    );  }  componentWillUnmount() {    if (this._asyncRequest) {      this._asyncRequest.cancel();    }  }  render() {    if (this.state.externalData === null) {      // Render loading state ...    } else {      // Render real UI ...    }  }}</code></pre><p>å¯¹äºå¤§å¤šæ•°ç”¨ä¾‹ï¼Œå»ºè®®çš„å‡çº§è·¯å¾„æ˜¯å°†æ•°æ®æå–ç§»å…¥<code>componentDidMount</code>ï¼š</p><pre><code class="js">// Afterclass ExampleComponent extends React.Component {  state = {    externalData: null,  };  componentDidMount() {    this._asyncRequest = asyncLoadData().then(      externalData =&gt; {        this._asyncRequest = null;        this.setState({externalData});      }    );  }  componentWillUnmount() {    if (this._asyncRequest) {      this._asyncRequest.cancel();    }  }  render() {    if (this.state.externalData === null) {      // Render loading state ...    } else {      // Render real UI ...    }  }}</code></pre><p>æœ‰ä¸€ä¸ªå¸¸è§çš„é”™è¯¯è§‚å¿µè®¤ä¸ºï¼Œåœ¨<code>componentWillMount</code>ä¸­æå–å¯ä»¥é¿å…ç¬¬ä¸€ä¸ªç©ºçš„æ¸²æŸ“ã€‚åœ¨å®è·µä¸­ï¼Œè¿™ä»æ¥éƒ½ä¸æ˜¯çœŸçš„ï¼Œå› ä¸ºReactæ€»æ˜¯åœ¨<code>componentWillMount</code>ä¹‹åç«‹å³æ‰§è¡Œæ¸²æŸ“ã€‚å¦‚æœæ•°æ®åœ¨<code>componentWillMount</code>è§¦å‘çš„æ—¶é—´å†…ä¸å¯ç”¨ï¼Œåˆ™æ— è®ºä½ åœ¨å“ªé‡Œæå–æ•°æ®ï¼Œç¬¬ä¸€ä¸ªæ¸²æŸ“ä»å°†æ˜¾ç¤ºåŠ è½½çŠ¶æ€ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹å°†æå–ç§»åˆ°<code>componentDidMount</code>æ²¡æœ‰æ˜æ˜¾æ•ˆæœã€‚</p><blockquote><p>æ³¨æ„ï¼š<br>ä¸€äº›é«˜çº§ç”¨ä¾‹ï¼ˆä¾‹å¦‚ï¼ŒåƒRelayè¿™æ ·çš„åº“ï¼‰å¯èƒ½æƒ³è¦å°è¯•ä½¿ç”¨çƒ­åˆ‡çš„é¢„å–å¼‚æ­¥æ•°æ®ã€‚åœ¨è¿™é‡Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªè¿™æ ·åšçš„ä¾‹å­ã€‚</p></blockquote><p>å½“æ”¯æŒæœåŠ¡å™¨æ¸²æŸ“æ—¶ï¼Œç›®å‰éœ€è¦åŒæ­¥æä¾›æ•°æ® - <code>componentWillMount</code>é€šå¸¸ç”¨äºæ­¤ç›®çš„ï¼Œä½†æ„é€ å‡½æ•°å¯ä»¥ç”¨ä½œæ›¿æ¢ã€‚å³å°†åˆ°æ¥çš„æ‚¬å¿µAPIå°†ä½¿å¾—å¼‚æ­¥æ•°æ®åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‘ˆç°ä¸­éƒ½å¯ä»¥æ¸…æ™°åœ°è·å–ã€‚</p><h3 id="æ·»åŠ æ—¶é—´ç›‘å¬"><a href="#æ·»åŠ æ—¶é—´ç›‘å¬" class="headerlink" title="æ·»åŠ æ—¶é—´ç›‘å¬"></a>æ·»åŠ æ—¶é—´ç›‘å¬</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨å®‰è£…æ—¶ç›‘å¬å¤–éƒ¨äº‹ä»¶è°ƒåº¦ç¨‹åºçš„ç»„ä»¶ç¤ºä¾‹ï¼š</p><pre><code class="js">// Beforeclass ExampleComponent extends React.Component {  componentWillMount() {    this.setState({      subscribedValue: this.props.dataSource.value,    });    // This is not safe; it can leak!    this.props.dataSource.subscribe(      this.handleSubscriptionChange    );  }  componentWillUnmount() {    this.props.dataSource.unsubscribe(      this.handleSubscriptionChange    );  }  handleSubscriptionChange = dataSource =&gt; {    this.setState({      subscribedValue: dataSource.value,    });  };}</code></pre><p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¼šå¯¼è‡´æœåŠ¡å™¨æ¸²æŸ“ï¼ˆ<code>componentWillUnmount</code>æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ï¼‰å’Œå¼‚æ­¥æ¸²æŸ“ï¼ˆåœ¨æ¸²æŸ“å®Œæˆä¹‹å‰æ¸²æŸ“å¯èƒ½è¢«ä¸­æ–­ï¼Œå¯¼è‡´<code>componentWillUnmount</code>ä¸è¢«è°ƒç”¨ï¼‰çš„å†…å­˜æ³„æ¼ã€‚</p><p>äººä»¬ç»å¸¸è®¤ä¸º<code>componentWillMount</code>å’Œ<code>componentWillUnmount</code>æ€»æ˜¯é…å¯¹ï¼Œä½†è¿™å¹¶ä¸èƒ½ä¿è¯ã€‚åªæœ‰è°ƒç”¨<code>componentDidMount</code>åï¼ŒReactæ‰èƒ½ä¿è¯ç¨åè°ƒç”¨<code>componentWillUnmount</code>è¿›è¡Œæ¸…ç†ã€‚</p><p>å‡ºäºè¿™ä¸ªåŸå› ï¼Œæ·»åŠ äº‹ä»¶ç›‘å¬çš„æ¨èæ–¹å¼æ˜¯ä½¿ç”¨<code>componentDidMount</code>ç”Ÿå‘½å‘¨æœŸï¼š</p><pre><code class="js">// Afterclass ExampleComponent extends React.Component {  state = {    subscribedValue: this.props.dataSource.value,  };  componentDidMount() {    // Event listeners are only safe to add after mount,    // So they won&#39;t leak if mount is interrupted or errors.    this.props.dataSource.subscribe(      this.handleSubscriptionChange    );    // External values could change between render and mount,    // In some cases it may be important to handle this case.    if (      this.state.subscribedValue !==      this.props.dataSource.value    ) {      this.setState({        subscribedValue: this.props.dataSource.value,      });    }  }  componentWillUnmount() {    this.props.dataSource.unsubscribe(      this.handleSubscriptionChange    );  }  handleSubscriptionChange = dataSource =&gt; {    this.setState({      subscribedValue: dataSource.value,    });  };}</code></pre><p>æœ‰æ—¶å€™æ›´æ–°ç›‘å¬ä»¥å“åº”å±æ€§å˜åŒ–å¾ˆé‡è¦ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯åƒReduxæˆ–MobXè¿™æ ·çš„åº“ï¼Œåº“çš„å®¹å™¨ç»„ä»¶ä¼šä¸ºæ‚¨å¤„ç†ã€‚å¯¹äºåº”ç”¨ç¨‹åºä½œè€…ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå°å‹åº“<code>create-subscription</code>æ¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¼šå°†å®ƒä¸React 16.3ä¸€èµ·å‘å¸ƒã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>create-subscription</code>æ¥ä¼ é€’ç›‘å¬çš„å€¼ï¼Œè€Œä¸æ˜¯åƒä¸Šä¾‹é‚£æ ·ä¼ é€’ç›‘å¬ çš„<code>dataSource prop</code>ã€‚</p><pre><code class="js">import {createSubscription} from &#39;create-subscription&#39;;const Subscription = createSubscription({  getCurrentValue(sourceProp) {    // Return the current value of the subscription (sourceProp).    return sourceProp.value;  },  subscribe(sourceProp, callback) {    function handleSubscriptionChange() {      callback(sourceProp.value);    }    // Subscribe (e.g. add an event listener) to the subscription (sourceProp).    // Call callback(newValue) whenever a subscription changes.    sourceProp.subscribe(handleSubscriptionChange);    // Return an unsubscribe method.    return function unsubscribe() {      sourceProp.unsubscribe(handleSubscriptionChange);    };  },});// Rather than passing the subscribable source to our ExampleComponent,// We could just pass the subscribed value directly:`&lt;Subscription source={dataSource}&gt;`  {value =&gt; `&lt;ExampleComponent subscribedValue={value} /&gt;`}`&lt;/Subscription&gt;`;</code></pre><blockquote><p>æ³¨æ„<br>åƒRelay / Apolloè¿™æ ·çš„åº“åº”è¯¥ä½¿ç”¨ä¸åˆ›å»ºè®¢é˜…ç›¸åŒçš„æŠ€æœ¯æ‰‹åŠ¨ç®¡ç†è®¢é˜…ï¼ˆå¦‚æ­¤å¤„æ‰€å¼•ç”¨çš„ï¼‰ï¼Œå¹¶é‡‡ç”¨æœ€é€‚åˆå…¶åº“ä½¿ç”¨çš„ä¼˜åŒ–æ–¹å¼ã€‚</p></blockquote><h3 id="åŸºäºpropsæ›´æ–°state"><a href="#åŸºäºpropsæ›´æ–°state" class="headerlink" title="åŸºäºpropsæ›´æ–°state"></a>åŸºäºpropsæ›´æ–°state</h3><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨æ—§ç‰ˆ<code>componentWillReceiveProps</code>ç”Ÿå‘½å‘¨æœŸåŸºäºæ–°çš„é“å…·å€¼æ›´æ–°çŠ¶æ€çš„ç»„ä»¶ç¤ºä¾‹ï¼š</p><pre><code class="js">// Beforeclass ExampleComponent extends React.Component {  state = {    isScrollingDown: false,  };  componentWillReceiveProps(nextProps) {    if (this.props.currentRow !== nextProps.currentRow) {      this.setState({        isScrollingDown:          nextProps.currentRow &gt; this.props.currentRow,      });    }  }}</code></pre><p>å°½ç®¡ä¸Šé¢çš„ä»£ç æœ¬èº«å¹¶æ²¡æœ‰é—®é¢˜ï¼Œä½†<code>componentWillReceiveProps</code>ç”Ÿå‘½å‘¨æœŸé€šå¸¸ä¼šè¢«é”™è¯¯åœ°ç”¨äºè§£å†³é—®é¢˜ã€‚å› æ­¤ï¼Œè¯¥æ–¹æ³•å°†è¢«å¼ƒç”¨ã€‚</p><p>ä»ç‰ˆæœ¬16.3å¼€å§‹ï¼Œ<code>æ›´æ–°stateä»¥å“åº”props</code>æ›´æ”¹çš„æ¨èæ–¹æ³•æ˜¯ä½¿ç”¨æ–°çš„é™æ€<code>getDerivedStateFromProps</code>ç”Ÿå‘½å‘¨æœŸã€‚ ï¼ˆç”Ÿå‘½å‘¨æœŸåœ¨ç»„ä»¶åˆ›å»ºæ—¶ä»¥åŠæ¯æ¬¡æ”¶åˆ°æ–°é“å…·æ—¶è°ƒç”¨ï¼‰ï¼š</p><pre><code class="js">// Afterclass ExampleComponent extends React.Component {  // Initialize state in constructor,  // Or with a property initializer.  state = {    isScrollingDown: false,    lastRow: null,  };  static getDerivedStateFromProps(nextProps, prevState) {    if (nextProps.currentRow !== prevState.lastRow) {      return {        isScrollingDown:          nextProps.currentRow &gt; prevState.lastRow,        lastRow: nextProps.currentRow,      };    }    // Return null to indicate no change to state.    return null;  }}</code></pre><p>ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>props.currentRow</code>æ˜¯ä¸€ä¸ªé•œåƒçŠ¶æ€ï¼ˆå¦‚state.lastRowï¼‰ã€‚è¿™ä½¿å¾—<code>getDerivedStateFromProps</code>å¯ä»¥åƒåœ¨<code>componentWillReceiveProps</code>ä¸­ä¸€æ ·è®¿é—®ä»¥å‰çš„propså€¼ã€‚</p><p>æ‚¨å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸åªæ˜¯å°†å…ˆå‰çš„<code>props</code>ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>getDerivedStateFromProps</code>ã€‚æˆ‘ä»¬åœ¨è®¾è®¡APIæ—¶è€ƒè™‘äº†è¿™ä¸ªé€‰é¡¹ï¼Œä½†æœ€ç»ˆå†³å®šåå¯¹å®ƒï¼ŒåŸå› æœ‰ä¸¤ä¸ª</p><ul><li><p>åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨getDerivedStateFromPropsï¼ˆå®ä¾‹åŒ–åï¼‰æ—¶ï¼ŒprevPropså‚æ•°å°†ä¸ºnullï¼Œéœ€è¦åœ¨è®¿é—®prevPropsæ—¶æ·»åŠ if-not-nullæ£€æŸ¥ã€‚</p></li><li><p>æ²¡æœ‰å°†ä»¥å‰çš„propsä¼ é€’ç»™è¿™ä¸ªå‡½æ•°ï¼Œåœ¨æœªæ¥ç‰ˆæœ¬çš„Reactä¸­é‡Šæ”¾å†…å­˜çš„ä¸€ä¸ªæ­¥éª¤ã€‚ ï¼ˆå¦‚æœReactä¸éœ€è¦å°†å…ˆå‰çš„é“å…·ä¼ é€’ç»™ç”Ÿå‘½å‘¨æœŸï¼Œé‚£ä¹ˆå®ƒä¸éœ€è¦å°†å…ˆå‰çš„é“å…·å¯¹è±¡ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚ï¼‰</p></li></ul><blockquote><p>Note<br>å¦‚æœæ‚¨æ­£åœ¨ç¼–å†™å…±äº«ç»„ä»¶ï¼Œé‚£ä¹ˆreact-lifecycles-compat polyfillå¯ä»¥ä½¿æ–°çš„getDerivedStateFromPropsç”Ÿå‘½å‘¨æœŸä¸æ—§ç‰ˆæœ¬çš„Reactä¸€èµ·ä½¿ç”¨ã€‚è¯¦ç»†äº†è§£å¦‚ä½•åœ¨ä¸‹é¢ä½¿ç”¨å®ƒã€‚</p></blockquote><h3 id="è°ƒç”¨å¤–éƒ¨å›è°ƒå‡½æ•°"><a href="#è°ƒç”¨å¤–éƒ¨å›è°ƒå‡½æ•°" class="headerlink" title="è°ƒç”¨å¤–éƒ¨å›è°ƒå‡½æ•°"></a>è°ƒç”¨å¤–éƒ¨å›è°ƒå‡½æ•°</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨å†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨å¤–éƒ¨å‡½æ•°çš„ç»„ä»¶ç¤ºä¾‹ï¼š</p><pre><code class="js">// Beforeclass ExampleComponent extends React.Component {  componentWillUpdate(nextProps, nextState) {    if (      this.state.someStatefulValue !==      nextState.someStatefulValue    ) {      nextProps.onChange(nextState.someStatefulValue);    }  }}</code></pre><p>åœ¨å¼‚æ­¥æ¨¡å¼ä¸‹ä½¿ç”¨<code>componentWillUpdate</code>éƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¤–éƒ¨å›è°ƒå¯èƒ½ä¼šå¤šæ¬¡è°ƒç”¨åªæ›´æ–°ä¸€æ¬¡ã€‚ç›¸åï¼Œåº”è¯¥ä½¿ç”¨<code>componentDidUpdate</code>ç”Ÿå‘½å‘¨æœŸï¼Œå› ä¸ºå®ƒä¿è¯æ¯æ¬¡æ›´æ–°åªè°ƒç”¨ä¸€æ¬¡ï¼š</p><pre><code class="js">// Afterclass ExampleComponent extends React.Component {  componentDidUpdate(prevProps, prevState) {    if (      this.state.someStatefulValue !==      prevState.someStatefulValue    ) {      this.props.onChange(this.state.someStatefulValue);    }  }}</code></pre><h3 id="propsæ”¹å˜çš„å‰¯ä½œç”¨"><a href="#propsæ”¹å˜çš„å‰¯ä½œç”¨" class="headerlink" title="propsæ”¹å˜çš„å‰¯ä½œç”¨"></a>propsæ”¹å˜çš„å‰¯ä½œç”¨</h3><p>ä¸ä¸Šè¿° äº‹ä¾‹ç±»ä¼¼ï¼Œæœ‰æ—¶ç»„ä»¶åœ¨é“å…·æ›´æ”¹æ—¶ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚</p><pre><code class="js">// Beforeclass ExampleComponent extends React.Component {  componentWillReceiveProps(nextProps) {    if (this.props.isVisible !== nextProps.isVisible) {      logVisibleChange(nextProps.isVisible);    }  }}</code></pre><p>ä¸<code>componentWillUpdate</code>ä¸€æ ·ï¼Œ<code>componentWillReceiveProps</code>å¯èƒ½ä¼šå¤šæ¬¡è°ƒç”¨ä½†æ˜¯åªæ›´æ–°ä¸€æ¬¡ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œé¿å…åœ¨æ­¤æ–¹æ³•ä¸­å¯¼è‡´çš„å‰¯ä½œç”¨éå¸¸é‡è¦ã€‚ç›¸åï¼Œåº”è¯¥ä½¿ç”¨<code>componentDidUpdate</code>ï¼Œå› ä¸ºå®ƒä¿è¯æ¯æ¬¡æ›´æ–°åªè°ƒç”¨ä¸€æ¬¡ï¼š</p><pre><code class="js">// Afterclass ExampleComponent extends React.Component {  componentDidUpdate(prevProps, prevState) {    if (this.props.isVisible !== prevProps.isVisible) {      logVisibleChange(this.props.isVisible);    }  }}</code></pre><h3 id="propsæ”¹å˜æ—¶è·å–å¤–éƒ¨æ•°æ®"><a href="#propsæ”¹å˜æ—¶è·å–å¤–éƒ¨æ•°æ®" class="headerlink" title="propsæ”¹å˜æ—¶è·å–å¤–éƒ¨æ•°æ®"></a>propsæ”¹å˜æ—¶è·å–å¤–éƒ¨æ•°æ®</h3><p>ä»¥ä¸‹æ˜¯æ ¹æ®<code>propsvalues</code>æå–å¤–éƒ¨æ•°æ®çš„ç»„ä»¶ç¤ºä¾‹ï¼š</p><pre><code class="js">// Beforeclass ExampleComponent extends React.Component {  state = {    externalData: null,  };  componentDidMount() {    this._loadAsyncData(this.props.id);  }  componentWillReceiveProps(nextProps) {    if (nextProps.id !== this.props.id) {      this.setState({externalData: null});      this._loadAsyncData(nextProps.id);    }  }  componentWillUnmount() {    if (this._asyncRequest) {      this._asyncRequest.cancel();    }  }  render() {    if (this.state.externalData === null) {      // Render loading state ...    } else {      // Render real UI ...    }  }  _loadAsyncData(id) {    this._asyncRequest = asyncLoadData(id).then(      externalData =&gt; {        this._asyncRequest = null;        this.setState({externalData});      }    );  }}</code></pre><p>æ­¤ç»„ä»¶çš„æ¨èå‡çº§è·¯å¾„æ˜¯å°†æ•°æ®æ›´æ–°ç§»åŠ¨åˆ°<code>componentDidUpdate</code>ä¸­ã€‚åœ¨æ¸²æŸ“æ–°é“å…·ä¹‹å‰ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨æ–°çš„<code>getDerivedStateFromProps</code>ç”Ÿå‘½å‘¨æœŸæ¸…é™¤é™ˆæ—§çš„æ•°æ®ï¼š</p><pre><code class="js">// Afterclass ExampleComponent extends React.Component {  state = {    externalData: null,  };  static getDerivedStateFromProps(nextProps, prevState) {    // Store prevId in state so we can compare when props change.    // Clear out previously-loaded data (so we don&#39;t render stale stuff).    if (nextProps.id !== prevState.prevId) {      return {        externalData: null,        prevId: nextProps.id,      };    }    // No state update necessary    return null;  }  componentDidMount() {    this._loadAsyncData(this.props.id);  }  componentDidUpdate(prevProps, prevState) {    if (this.state.externalData === null) {      this._loadAsyncData(this.props.id);    }  }  componentWillUnmount() {    if (this._asyncRequest) {      this._asyncRequest.cancel();    }  }  render() {    if (this.state.externalData === null) {      // Render loading state ...    } else {      // Render real UI ...    }  }  _loadAsyncData(id) {    this._asyncRequest = asyncLoadData(id).then(      externalData =&gt; {        this._asyncRequest = null;        this.setState({externalData});      }    );  }}</code></pre><blockquote><p>æ³¨æ„<br>å¦‚æœæ‚¨ä½¿ç”¨æ”¯æŒå–æ¶ˆçš„HTTPåº“ï¼ˆå¦‚axiosï¼‰ï¼Œé‚£ä¹ˆå¸è½½æ—¶å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚å¾ˆç®€å•ã€‚å¯¹äºåŸç”ŸPromiseï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„æ–¹æ³•ã€‚</p></blockquote><h3 id="åœ¨æ›´æ–°ä¹‹å‰è¯»å–DOMå±æ€§"><a href="#åœ¨æ›´æ–°ä¹‹å‰è¯»å–DOMå±æ€§" class="headerlink" title="åœ¨æ›´æ–°ä¹‹å‰è¯»å–DOMå±æ€§"></a>åœ¨æ›´æ–°ä¹‹å‰è¯»å–DOMå±æ€§</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç»„ä»¶çš„ä¾‹å­ï¼Œå®ƒåœ¨æ›´æ–°ä¹‹å‰ä»DOMä¸­è¯»å–å±æ€§ï¼Œä»¥ä¾¿åœ¨åˆ—è¡¨ä¸­ä¿æŒæ»šåŠ¨ä½ç½®ï¼š</p><pre><code class="js">componentWillUpdate(nextProps, nextState) {    // Are we adding new items to the list?    // Capture the scroll position so we can adjust scroll later.    if (this.props.list.length &lt; nextProps.list.length) {      this.previousScrollOffset =        this.listRef.scrollHeight - this.listRef.scrollTop;    }  }  componentDidUpdate(prevProps, prevState) {    // If previousScrollOffset is set, we&#39;ve just added new items.    // Adjust scroll so these new items don&#39;t push the old ones out of view.    if (this.previousScrollOffset !== null) {      this.listRef.scrollTop =        this.listRef.scrollHeight -        this.previousScrollOffset;      this.previousScrollOffset = null;    }  }  render() {    return (      `&lt;div&gt;`        {/* ...contents... */}      `&lt;/div&gt;`    );  }  setListRef = ref =&gt; {    this.listRef = ref;  };}</code></pre><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>componentWillUpdate</code>è¢«ç”¨æ¥è¯»å–DOMå±æ€§ã€‚ä½†æ˜¯ï¼Œå¯¹äºå¼‚æ­¥æ¸²æŸ“ï¼Œâ€œrenderâ€é˜¶æ®µç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚c<code>omponentWillUpdate</code>å’Œ<code>render</code>ï¼‰ä¸â€œcommitâ€é˜¶æ®µç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚<code>componentDidUpdate</code>ï¼‰ä¹‹é—´å¯èƒ½å­˜åœ¨å»¶è¿Ÿã€‚å¦‚æœç”¨æˆ·åœ¨è¿™æ®µæ—¶é—´å†…åšäº†ç±»ä¼¼è°ƒæ•´çª—å£å¤§å°çš„æ“ä½œï¼Œåˆ™ä»<code>componentWillUpdate</code>ä¸­è¯»å–çš„<code>scrollHeight</code>å€¼å°†å¤±æ•ˆã€‚</p><p>è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ–°çš„â€œcommitâ€é˜¶æ®µç”Ÿå‘½å‘¨æœŸ<code>getSnapshotBeforeUpdate</code>ã€‚åœ¨æ•°æ®å‘ç”Ÿå˜åŒ–ä¹‹å‰ç«‹å³è°ƒç”¨è¯¥æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ›´æ–°DOMä¹‹å‰ï¼‰ã€‚å®ƒå¯ä»¥å°†Reactçš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>componentDidUpdate</code>ï¼Œåœ¨æ•°æ®å‘ç”Ÿå˜åŒ–åç«‹å³è°ƒç”¨å®ƒã€‚</p><p>è¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå¯ä»¥åƒè¿™æ ·ä¸€èµ·ä½¿ç”¨ï¼š</p><pre><code class="js">class ScrollingList extends React.Component {  listRef = null;  getSnapshotBeforeUpdate(prevProps, prevState) {    // Are we adding new items to the list?    // Capture the scroll position so we can adjust scroll later.    if (prevProps.list.length &lt; this.props.list.length) {      return (        this.listRef.scrollHeight - this.listRef.scrollTop      );    }    return null;  }  componentDidUpdate(prevProps, prevState, snapshot) {    // If we have a snapshot value, we&#39;ve just added new items.    // Adjust scroll so these new items don&#39;t push the old ones out of view.    // (snapshot here is the value returned from getSnapshotBeforeUpdate)    if (snapshot !== null) {      this.listRef.scrollTop =        this.listRef.scrollHeight - snapshot;    }  }  render() {    return (      `&lt;div&gt;`        {/* ...contents... */}      `&lt;/div&gt;`    );  }  setListRef = ref =&gt; {    this.listRef = ref;  };}</code></pre><blockquote><p>æ³¨æ„<br>å¦‚æœæ‚¨æ­£åœ¨ç¼–å†™å…±äº«ç»„ä»¶ï¼Œé‚£ä¹ˆ<code>react-lifecycles-compat polyfill</code>å¯ä»¥ä½¿æ–°çš„<code>getSnapshotBeforeUpdate</code>ç”Ÿå‘½å‘¨æœŸä¸æ—§ç‰ˆæœ¬çš„Reactä¸€èµ·ä½¿ç”¨ã€‚è¯¦ç»†äº†è§£å¦‚ä½•ä½¿ç”¨å®ƒã€‚</p></blockquote><h2 id="å…¶å®ƒæƒ…å†µ"><a href="#å…¶å®ƒæƒ…å†µ" class="headerlink" title="å…¶å®ƒæƒ…å†µ"></a>å…¶å®ƒæƒ…å†µ</h2><p>é™¤äº†ä»¥ä¸Šçš„ä¸€äº›å¸¸è§çš„ä¾‹å­ï¼Œè¿˜å¯èƒ½ä¼šæœ‰åˆ«çš„æƒ…å†µæœ¬ç¯‡æ–‡ç« æ²¡æœ‰æ¶µç›–åˆ°ï¼Œå¦‚æœæ‚¨ä»¥æœ¬åšæ–‡æœªæ¶‰åŠçš„æ–¹å¼ä½¿ç”¨é™¤äº†ä»¥ä¸Š <code>componentWillMount</code>ï¼Œ<code>componentWillUpdate</code>æˆ–<code>componentWillReceiveProps</code>ï¼Œå¹¶ä¸”ä¸ç¡®å®šå¦‚ä½•è¿ç§»è¿™äº›ä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸï¼Œä½ å¯ä»¥æä¾›æ‚¨çš„ä»£ç ç¤ºä¾‹å’Œæˆ‘ä»¬çš„æ–‡æ¡£ï¼Œå¹¶ä¸”ä¸€èµ·æäº¤ä¸€ä¸ªæ–°é—®é¢˜ã€‚æˆ‘ä»¬å°†åœ¨æ›´æ–°è¿™ä»½æ–‡ä»¶æ—¶æä¾›æ–°çš„æ›¿ä»£æ¨¡å¼ã€‚</p><p>å½“React 16.3å‘å¸ƒæ—¶ï¼Œæˆ‘ä»¬è¿˜å°†å‘å¸ƒä¸€ä¸ªæ–°çš„npmåŒ…ï¼Œ react-lifecycles-compatã€‚è¯¥npmåŒ…ä¼šå¡«å……ç»„ä»¶ï¼Œä»¥ä¾¿æ–°çš„getDerivedStateFromPropså’ŒgetSnapshotBeforeUpdateç”Ÿå‘½å‘¨æœŸä¹Ÿå¯ä»¥ä¸æ—§ç‰ˆæœ¬çš„Reactï¼ˆ0.14.9+ï¼‰ä¸€èµ·ä½¿ç”¨ã€‚</p><p>è¦ä½¿ç”¨è¿™ä¸ªpolyfillï¼Œé¦–å…ˆå°†å®ƒä½œä¸ºä¾èµ–é¡¹æ·»åŠ åˆ°æ‚¨çš„åº“ä¸­ï¼š</p><pre><code class="js"># Yarnyarn add react-lifecycles-compat# NPMnpm install react-lifecycles-compat --save</code></pre><p>æ¥ä¸‹æ¥ï¼Œæ›´æ–°æ‚¨çš„ç»„ä»¶ä»¥ä½¿ç”¨æ–°çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ã€‚</p><p>æœ€åï¼Œä½¿ç”¨polyfillå°†ç»„ä»¶å‘åå…¼å®¹æ—§ç‰ˆæœ¬çš„Reactï¼š</p><pre><code class="js">import React from &#39;react&#39;;import {polyfill} from &#39;react-lifecycles-compat&#39;;class ExampleComponent extends React.Component {  static getDerivedStateFromProps(nextProps, prevState) {    // Your state update logic here ...  }}// Polyfill your component to work with older versions of React:polyfill(ExampleComponent);export default ExampleComponent;</code></pre><p><a href="https://mp.weixin.qq.com/s/dYVdOGtcka3_ODfap1pvJQ" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javascript å¼‚æ­¥ç¼–ç¨‹</title>
      <link href="/2018/04/29/Js/Javascript-%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/"/>
      <url>/2018/04/29/Js/Javascript-%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆJavaScriptçš„å¼‚æ­¥ç¼–ç¨‹ç»å¸¸è¢«äººæèµ·ï¼Œæˆ‘æƒ³åˆ°ä»¥ä¸‹ä¸¤ç‚¹åŸå› ã€‚"><a href="#ä¸ºä»€ä¹ˆJavaScriptçš„å¼‚æ­¥ç¼–ç¨‹ç»å¸¸è¢«äººæèµ·ï¼Œæˆ‘æƒ³åˆ°ä»¥ä¸‹ä¸¤ç‚¹åŸå› ã€‚" class="headerlink" title="ä¸ºä»€ä¹ˆJavaScriptçš„å¼‚æ­¥ç¼–ç¨‹ç»å¸¸è¢«äººæèµ·ï¼Œæˆ‘æƒ³åˆ°ä»¥ä¸‹ä¸¤ç‚¹åŸå› ã€‚"></a>ä¸ºä»€ä¹ˆJavaScriptçš„å¼‚æ­¥ç¼–ç¨‹ç»å¸¸è¢«äººæèµ·ï¼Œæˆ‘æƒ³åˆ°ä»¥ä¸‹ä¸¤ç‚¹åŸå› ã€‚</h1><p>é¦–å…ˆï¼ŒJavaScriptæ˜¯å•çº¿ç¨‹çš„ï¼Œç”¨äº‹ä»¶å¾ªç¯çš„æœºåˆ¶æ¥ä¿è¯ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚å¦‚æœæœ‰åŒæ­¥çš„ajaxè¯·æ±‚æˆ–è€…å¾ˆå¤æ‚çš„è¿ç®—ï¼ŒJavaScriptè¦ç­‰è¿™äº›æ“ä½œå®Œæˆï¼Œæ‰èƒ½å“åº”å…¶ä»–äº‹ä»¶ï¼Œé¡µé¢ä¼šè¿›å…¥å‡æ­»çŠ¶æ€ã€‚<br>ç„¶è€Œå¯¹äºæ—¥æ¸å¤æ‚çš„webåº”ç”¨æ¥è¯´ï¼Œè¿™ä¸ªæ˜¯è‡´å‘½çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆNode.jsé€‚åˆé«˜I/Oæ“ä½œçš„ä¸šåŠ¡ï¼Œè€ŒåƒPHPï¼Œç›´åˆ°ç°åœ¨ï¼ŒI/Oæ“ä½œä¹Ÿæ²¡æœ‰æä¾›å¯¹åº”çš„å¼‚æ­¥ç‰ˆæœ¬ï¼Œå¯¹äºPHPæ¥è¯´æ¯ä¸ªè¯·æ±‚éƒ½åœ¨php-fpmçš„ä¸€ä¸ªæ–°çº¿ç¨‹é‡Œï¼Œè¿™ä¸ªçº¿ç¨‹é˜»å¡äº†ä¸å½±å“å…¶ä»–çº¿ç¨‹ï¼Œå¼‚æ­¥ä¹Ÿå°±æ²¡æœ‰é‚£ä¹ˆè¿«åˆ‡ã€‚</p><p>å…¶æ¬¡ï¼ŒJavaScriptä½œä¸ºåŠ¨æ€è¯­è¨€ï¼Œå‡½æ•°æ˜¯ä¸€ç­‰ä¸€çš„å…¬æ°‘ï¼Œå¯ä»¥éšæ„å®šä¹‰å‡½æ•°ï¼Œå°†å‡½æ•°ä½œä¸ºå˜é‡ä¼ å€¼ä¼ å‚ï¼Œæå¤§çš„æ–¹ä¾¿äº†JSerçµæ´»çš„è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹ã€‚åœ¨Cè¯­è¨€é‡Œé¢ï¼Œä¹Ÿæœ‰å¼‚æ­¥ç¼–ç¨‹ï¼Œä¸ç®¡æ˜¯IOCPæ¨¡å‹è¿˜æ˜¯epoolæ¨¡å‹ï¼Œä»–ä»¬éƒ½æ˜¯åˆ›å»ºå¤šä¸ªçº¿ç¨‹æ¥ç»Ÿä¸€çš„å¤„ç†å›è°ƒï¼Œåœ¨æ¯ä¸ªçº¿ç¨‹å‡½æ•°é‡Œç”¨ä¸€ä¸ªæ­»å¾ªç¯ï¼Œåœ¨æ­»å¾ªç¯é‡Œç”¨ä¸€ä¸ªé˜»å¡çš„çš„æ“ä½œå»ç­‰å¾…å®Œæˆçš„I/Oæ“ä½œã€‚<br>è¿™æ ·çš„è¯ï¼ŒI/Oæ“ä½œå‡½æ•°å’Œå›è°ƒå‡½æ•°ä¸åœ¨åŒä¸€ä¸ªçº¿ç¨‹é‡Œï¼Œè¿™ä¸ªç»™æµç¨‹æ§åˆ¶å¸¦æ¥å¾ˆå¤§çš„ä¸ä¾¿ã€‚Node.jsåº•å±‚è‚¯å®šä¹Ÿæ˜¯ç”¨çš„è¿™ä¸ªæ¥å¤„ç†I/Oçš„ï¼Œä½†è¿™å¯¹äºJSeræ¥è¯´æ˜¯é€æ˜çš„ï¼Œä¸ç”¨æ“å¿ƒã€‚</p><p>å¥½åƒæœ‰ç‚¹è·‘åäº†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹JavaScriptä¸­æœ‰å“ªäº›çµæ´»çš„å¼‚æ­¥ç¼–ç¨‹å§ã€‚</p><p>ç¼–ç¨‹ï¼Œå°±æ˜¯ç”±coderå®šå¥½ä»£ç çš„æ‰§è¡Œé¡ºåºï¼Œè®©è®¡ç®—æœºå»è·‘ã€‚é‚£å¯¹äºåŒæ­¥æ“ä½œï¼Œè¿™ä¸ªè¿‡ç¨‹å¾ˆç®€å•ã€‚æ¯”å¦‚æ‰§è¡Œæˆ‘ä»¬æœ‰Aå’ŒBæ“ä½œï¼ŒAæ“ä½œå®Œæˆå†æ‰§è¡ŒBï¼Œå¦‚ä¸‹</p><pre><code class="js">A();B();</code></pre><p>è¿™æ ·å°±èƒ½å¾ˆå¥½çš„ä½“ç°æµç¨‹ï¼Œä½†æ˜¯å½“Aæ“ä½œæ˜¯ä¸ªå¼‚æ­¥æ“ä½œçš„æ—¶å€™ï¼ŒAæ“ä½œä¸€å¼€å§‹åªæ‰§è¡Œä¸€ä¸ªå‘èµ·çš„æ“ä½œï¼ˆå‘èµ·è¯·æ±‚ï¼Œå‘èµ·ç­‰å¾…ï¼‰ï¼Œè‡³äºä»€ä¹ˆæ—¶å€™èƒ½å®Œæˆåªæœ‰AçŸ¥é“ã€‚è¿™æ—¶å€™å¦‚æœè¿˜æŒ‰å¦‚ä¸Šçš„æ–¹å¼ç»„ç»‡ä»£ç ï¼Œå°±ä¸èƒ½ä¿è¯â€œAæ“ä½œå®Œæˆå†æ‰§è¡ŒBâ€ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠBç›´æ¥ç³…åˆè¿›Aã€‚</p><pre><code class="js">function A(){B()}</code></pre><p>è¿™æ ·ä»£ç ä¹‹é—´è€¦åˆåº¦å¤ªé«˜ï¼Œå¢åŠ ä»£ç å¤ç”¨çš„éš¾åº¦ ï¼Œäºæ˜¯æœ‰äº†callbackå½¢å¼ã€‚</p><a id="more"></a><h2 id="callback"><a href="#callback" class="headerlink" title="callback"></a>callback</h2><blockquote><p><em>è¢«å¹¿æ³›åæ§½çš„callbackï¼ŒçœŸæ­£è¯¥è¢«åæ§½çš„åº”è¯¥æ˜¯ä¸åˆæ ¼çš„JSerå§</em>ã€‚</p></blockquote><p><code>setTimeout</code>å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å¼‚æ­¥æ“ä½œï¼Œå»¶è¿Ÿæ—¶é—´åˆ°äº†æ—¶å€™åªæœ‰<code>setTimeout</code>è‡ªå·±èƒ½å¾—åˆ°é€šçŸ¥ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä»¥å‡½æ•°çš„å½¢å¼å…ˆå‘Šè¯‰<code>setTimeout</code>å»¶è¿Ÿæ—¶é—´åˆ°äº†æ—¶å€™æˆ‘ä»¬è¦æ‰§è¡Œä»€ä¹ˆæ“ä½œã€‚</p><pre><code class="js">setTimeout(() =&gt; {    console.log(1);    console.log(2);}, 1000);</code></pre><p>æˆ‘ä»¬éƒ½ç”¨setTimeoutæ¥è¡¨ç¤ºå¼‚æ­¥æ“ä½œã€‚</p><pre><code class="js">function A(callback){    console.log(&#39;do a start&#39;);    setTimeout(() =&gt; {        console.log(&#39;do a end&#39;);        callback();    }, 1000);}function B() {    console.log(&#39;do b&#39;);}A(B);</code></pre><p>è¿™æ ·ä¿è¯äº†â€œAæ“ä½œå®Œæˆå†æ‰§è¡ŒBâ€ï¼Œä¹Ÿè§£å†³äº†è€¦åˆåº¦é«˜çš„é—®é¢˜ã€‚</p><p><strong>ä½†æ˜¯callbackåœ¨æµç¨‹å¤æ‚çš„æƒ…å†µä¸‹ï¼Œéš¾ä»¥è¾¾åˆ°ç†æƒ³ç¼–ç ä½“éªŒï¼›åœ¨æµç¨‹é•¿çš„æƒ…å†µä¸‹ä¼šå½¢æˆå›è°ƒåœ°ç‹±ï¼Œæµç¨‹éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤</strong>ã€‚</p><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><blockquote><p><em>callbackçš„é—®é¢˜æ˜¯ä¸‹ä¸€æ­¥çš„æ“ä½œä¸æ˜¯é è¿”å›å€¼ï¼Œè€Œæ˜¯è¦é callbackæ¥å†³å®šçš„ã€‚è¿™ä¸ªæ˜¯è·ŸåŒæ­¥æ“ä½œæœ€å¤§çš„åŒºåˆ«ï¼Œä¹Ÿæ˜¯å¯¼è‡´callbackçƒ¦æ¼çš„æ ¹æœ¬åŸå› ã€‚</em></p></blockquote><p><code>Promise</code>è®©å¼‚æ­¥æ“ä½œçš„çŠ¶æ€è¿”å›å‡ºæ¥ï¼Œè€Œä¸æ˜¯åœ¨å†…éƒ¨å¤„ç†ï¼Œæ˜¯é“¾å¼è°ƒç”¨çš„åŸºç¡€ï¼Œä¹Ÿç»™ä¹‹ååŒæ­¥æ–¹å¼çš„å†™æ³•å¥ å®šåŸºç¡€ã€‚</p><pre><code class="js">function A(){    console.log(&#39;do a start&#39;);    return new Promise((resolve,reject) =&gt; {        setTimeout(() =&gt; {            console.log(&#39;do a end&#39;);            resolve();        },1000)    })}function B(){    console.log(&#39;do B&#39;);}A().then(B)</code></pre><p>é…åˆ<code>defer</code>ï¼Œ<code>Promise.all</code>å’Œ<code>Promise.race</code>ï¼Œä½¿ç”¨Promiseå¯ä»¥å†™å‡ºå¾ˆæ¸…æ™°çš„å¼‚æ­¥æµç¨‹ã€‚ä»æœ¬è´¨ä¸Šæ¥è®²ï¼Œ<strong>Promiseè¿æ¥äº†å¼‚æ­¥æ“ä½œå’Œæ“ä½œç»“æœï¼Œåªæ˜¯å°†å›è°ƒå»¶åï¼Œå†é€šè¿‡é“¾å¼è°ƒç”¨è®©æµç¨‹æ›´æ¸…æ™°</strong>ã€‚</p><h2 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h2><blockquote><p><em>è°ƒç”¨<code>generator</code>å‡½æ•°ä¸ç«‹å³æ‰§è¡Œï¼Œè°ƒç”¨ä¸€æ¬¡<code>next</code>æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ª<code>yield</code>ï¼Œæ‹¿åˆ°<code>yield</code>å³è¾¹è¡¨è¾¾å¼çš„å€¼ï¼Œä¸‹æ¬¡è°ƒç”¨nextä¼ çš„å€¼èµ‹å€¼ç»™yieldå·¦è¾¹ã€‚</em></p></blockquote><p>å¾ˆå°´å°¬å•Šï¼Œå†™å®Œä¸Šé¢ä¸€æ®µè¯ï¼Œè‡ªå·±å†å›å¤´çœ‹ï¼Œä¹Ÿä¸çŸ¥é“è¯´çš„å•¥ã€‚è¿˜æ˜¯æ¥çœ‹ä»£ç å§ã€‚</p><pre><code class="js">function* generator(){    console.log(&#39;start&#39;);    const res = yield 1 + 3;    console.log(res);    return res;}const gen = generator();const res1 = gen.next();console.log(res1);const res2 = gen.next(5);console.log(res2);</code></pre><p>å¯ä»¥çœ‹åˆ°yieldçš„å·¦å€¼ä¸æ˜¯ç­‰äºyieldå³è¾¹çš„ç»“æœï¼Œè€Œæ˜¯ç­‰äºä½ ä¸‹ä¸€æ¬¡è°ƒç”¨nextçš„æ—¶å€™ä¼ å…¥çš„å€¼ã€‚è¿™ä¸ªç‰¹æ€§ï¼Œä½¿å¾—<code>generatoré…åˆPromise</code>ï¼Œèƒ½å¾ˆå¥½çš„æ§åˆ¶å¼‚æ­¥ã€‚å¦‚æœyieldå³è¾¹æ˜¯ä¸€ä¸ªPromiseï¼Œåœ¨Promiseçš„çŠ¶æ€å˜æˆresolvedçš„æ—¶å€™è°ƒç”¨ä¸‹ä¸€æ¬¡nextï¼Œä¼ å…¥PromiseValueã€‚</p><pre><code class="js">function sleep(msTime = 1000){    return new Promise((resolve,reject) =&gt; {        setTimeout(resolve,msTime);    });}function* generator() {    const startTime = Date.now();    yield sleep(1000);    console.log(Date.now() - startTime);}const gen = generator();gen.next().value.then((val) =&gt; {    gen.next(val);});</code></pre><p>è¿™æ ·æ‰€æœ‰çš„æµç¨‹æ§åˆ¶çš„å›è°ƒä»£ç éƒ½è„±ç¦»äº†é€»è¾‘å‡½æ•°æœ¬èº«ï¼Œåœ¨<code>generator</code>é‡Œï¼ŒåŒæ­¥å’Œå¼‚æ­¥çš„ä»£ç æ··åœ¨ä¸€èµ·äº†ï¼Œä½†æ˜¯æ•´ä¸ªå†™æ³•çœ‹ä¸Šå»æ˜¯ä¸€ä¸ªåŒæ­¥çš„ï¼Œå¼‚å¸¸çš„æ¸…æ™°ã€‚è€Œåé¢çš„æ§åˆ¶ä»£ç ï¼Œå¯ä»¥å†™æˆä¸€ä¸ªé€šç”¨çš„æ§åˆ¶å‡½æ•°ï¼Œè®©<code>generator</code>è‡ªæ‰§è¡Œï¼Œè¿™ä¸ªæ˜¯<code>co</code>æ¨¡å—åšçš„ã€‚</p><pre><code class="js">import co from &#39;co&#39;;const doSomeThing = co.wrap(function* generator() {    const startTime = Date.now();    yield sleep(1000);    console.log(Date.now() - startTime);});doSomeThing();</code></pre><p>ä½¿ç”¨coæ¨¡å—yieldå³å€¼å¯ä»¥æ˜¯<code>promise</code>å’Œ<code>trunkå‡½æ•°</code>ï¼ˆä¸ºä»€ä¹ˆæ˜¯è¿™ä¸¤ä¸ªï¼Ÿå› ä¸ºè¿™ä¸¤ä¸ªéƒ½èƒ½ä»å›æ‰é‡Œæ‹¿åˆ°ä¸Šä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„çŠ¶æ€ï¼‰ï¼Œä¸èƒ½æ˜¯åŸºæœ¬ç±»å‹ï¼Œç¡®å®ä»å¼‚æ­¥çš„è§’åº¦è€ƒè™‘yieldå³å€¼æ”¾åŸºæœ¬ç±»å‹æ²¡æœ‰å•¥æ„ä¹‰ï¼Œä½†æ˜¯å› ä¸ºè¿™ä¸ªæŠ¥é”™æ˜¯æœ‰ç‚¹éš¾ä»¥æ¥å—çš„ã€‚è¿˜å€¼å¾—ä¸€æçš„æ˜¯coåšäº†ä¸€äº›å¤„ç†ï¼Œyieldå³å€¼ä¹Ÿå¯ä»¥æ˜¯<code>Array</code>å’Œ<code>Object</code>ï¼Œä½†æ˜¯é‡Œé¢çš„å€¼è¿˜æ˜¯å¿…é¡»æ˜¯promiseå’Œtrunkã€‚</p><h2 id="async-await"><a href="#async-await" class="headerlink" title="async/await"></a>async/await</h2><blockquote><p><em>async/<code>await</code>æ˜¯es2017å‡ºçš„è§„èŒƒï¼Œå¯ä»¥è¯´coå’Œgeneratorçš„<code>è¯­æ³•ç³–</code>ã€‚ä¸ä¸€æ ·çš„æ˜¯awaitçš„å³å€¼<strong>å…¼å®¹äº†åŸºæœ¬ç±»å‹</strong>ï¼Œä½†æ˜¯ä¸å†å¤„ç†Arrayå’ŒObjectã€‚</em></p></blockquote><pre><code class="js">async function doSomeThing() {    const startTime = Date.now();    await sleep(1000);    console.log(Date.now() - startTime);}doSomeThing();</code></pre><p>ä»<code>async/await</code>æ¥çœ‹JavaScriptçš„å¼‚æ­¥ç¼–ç¨‹ï¼Œå¯ä»¥è¯´æ˜¯å¾ˆæ¸…æ¥šäº†ï¼ŒåŒæ­¥å’Œå¼‚æ­¥æ— ç¼è¿æ¥ï¼Œå†™èµ·æ¥è¡Œäº‘æµæ°´ï¼Œçœ‹æ¥æ¸…æ™°æ˜äº†ã€‚æƒ³å¿…å¤§å®¶éƒ½æƒ³ç”¨<code>async/await</code>æ¥æé«˜å·¥ä½œæ•ˆç‡å§ï¼Œé‚£ä¹ˆä½¿ç”¨async/awaitè¦<strong>æ³¨æ„</strong>ä»€ä¹ˆå‘¢ï¼Ÿ</p><ul><li><p>1.<code>async/await</code>ç¦»ä¸å¼€<code>Promise</code>ï¼Œä½¿ç”¨<code>Promise.all</code>å’Œ<code>Promise.race</code>ç­‰ä¼˜åŒ–æµç¨‹ã€‚awaitå†™èµ·æ¥å¤ªæ–¹ä¾¿äº†ï¼Œå½“ä¸¤ä¸ªæ“ä½œå¯ä»¥å¹¶è¡Œçš„æ—¶å€™è¿˜è¯·ç”¨Promise.allï¼Œè¿ç»­ä¸¤ä¸ªawaitæ˜¯ä¸²è¡Œçš„æ“ä½œã€‚</p></li><li><p>2.asyncå‡½æ•°å§‹ç»ˆè¿”å›çš„ä¸€ä¸ªPromiseï¼Œå°±ç®—ç®€å•å¦‚ä¸‹å‡½æ•°ã€‚</p></li></ul><pre><code class="js">async function doSomeThing() {    return 123;}</code></pre><ul><li><p>3.awaitå³è¾¹å¼‚æ­¥æ“ä½œå˜æˆ<code>rejected</code>çš„æ—¶å€™æŠ›å‡ºé”™è¯¯èƒ½è¢«<code>try/catch</code>æ•æ‰åˆ°ï¼Œè¯·ä¸è¦åå•¬ä½¿ç”¨<code>try/catch</code>ã€‚</p></li><li><p>4.è¿˜æœ‰ä¸€ç‚¹é‡è¦çš„å¿˜è®°è¯´äº†ï¼Œä¸æ”¯æŒçš„ç¯å¢ƒä¸‹è¯·è½¬ç ã€‚</p></li></ul><p>ç°åœ¨çš„<code>async/await</code>æ¯”è¾ƒå®Œç¾äº†ï¼Œçºµè§‚è¿™ä¸ªå˜åŒ–å†ç¨‹ï¼Œå…¶å®ä¹Ÿæ˜¯è›®è¾›é…¸çš„ã€‚åœ¨Callbackçš„è·¯ä¸ŠåšæŒèµ°äº†å¾ˆä¹…ï¼ŒæœŸé—´ä¹Ÿå‡ºäº†wind.jsç­‰åº“ï¼Œæˆ–è€…ä½¿ç”¨trunkå‡½æ•°ï¼Œæˆ–è€…ä½¿ç”¨æµå¼ç¼–ç¨‹çš„rx.jsç­‰ã€‚å¯ä»¥çœ‹åˆ°å…ˆè¾ˆä»¬çš„åŠªåŠ›ï¼Œæ­£æ˜¯ä»–ä»¬çš„åŠªåŠ›å¦‚ä»Šæˆ‘ä»¬å¯ä»¥æ‰å¯ä»¥äº«å—å¦‚æ­¤ç¡•æœã€‚</p><p><code>trunkå‡½æ•°</code>(é˜®ä¸€å³°è€å¸ˆçš„ä»‹ç»)æ˜¯ä¸ªå¾ˆæœ‰æ„æ€çš„æƒ³æ³•ï¼Œé€šè¿‡æŠŠcallbackå½¢å¼çš„å‡½æ•°æŸ¯é‡ŒåŒ–ï¼Œå¾ˆç®€å•çš„å°±è·Ÿpromiseä¸€æ ·åšåˆ°äº†å»¶è¿Ÿäº†å›æ‰ã€‚é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ç®€å•çš„ç”¨trunkå‡½æ•°æ¥å®ç°é“¾å¼è°ƒç”¨ï¼Œç­”æ¡ˆæ˜¯noã€‚</p><p>ä¸æ€•å¤§å®¶ç¬‘è¯ï¼Œå› ä¸ºPromiseçš„thenå¼ºè°ƒçš„è¦è¿”å›ä¸€ä¸ªPromiseï¼Œæ‰€ä»¥ï¼Œåœ¨å†™æœ¬æ–‡ä¹‹å‰æˆ‘è¿˜ä¸€ç›´ä»¥ä¸ºPromiseé“¾å¼è°ƒç”¨æ˜¯ä¾èµ–å›æ‰çš„è¿”å›å€¼ã€‚å›æƒ³èµ·æ¥ï¼Œæœ‰ç‚¹å¥½ç¬‘ï¼Œåœ¨ä¸‹ä¸€ä¸ªthenè°ƒç”¨ä¹‹å‰ï¼Œcallbackéƒ½è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œæ€ä¹ˆå¯èƒ½ä¾èµ–ä»–çš„è¿”å›å€¼æ¥é“¾å¼è°ƒç”¨å‘¢ã€‚</p><p>è¿™è®©æˆ‘ä»¬å›åˆ°ä¸€ä¸ªç¼–ç¨‹çš„æœ€åŸºæœ¬ï¼Œå°±æ˜¯å®šä¹‰å¥½ä¸€ç³»åˆ—çš„æ“ä½œå’Œæ“ä½œä¹‹å‰çš„å…³ç³»ã€‚ç®€å•çš„æ¥å°†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸€ç³»åˆ—çš„æ“ä½œçœ‹æˆä¸€ä¸ªæ•°ç»„æˆ–è€…è¯´é“¾è¡¨å¯èƒ½æ›´è´´åˆ‡ä¸€ç‚¹ï¼Œæ˜¯ä¸€ç¯æ‰£ä¸€ç¯çš„ï¼Œç¨‹åºå¼€å§‹æ‰§è¡Œï¼Œæ•°ç»„ç¬¬ä¸€ä¸ªæ“ä½œå®Œæˆï¼Œç„¶åæ‰§è¡Œç¬¬äºŒä¸ªæ“ä½œï¼Œä¾æ¬¡ç±»æ¨ï¼Œç›´åˆ°æ‰§è¡Œå®Œæ¯•ã€‚</p><blockquote><p>åœ¨å¼‚æ­¥ç¼–ç¨‹é‡Œé¢å¦‚ä½•åº”è¯¥å…³å¿ƒçš„å¤§æ¦‚æœ‰ä¸‰ä¸ªé—®é¢˜ï¼š</p><ol><li>å¦‚ä½•ç”Ÿæˆè¿™ä¸ªæ•°ç»„ï¼ˆåºåˆ—ï¼‰</li><li>å†™æ‰§è¡Œå™¨ï¼Œå¦‚ä½•æœ‰åºçš„æ‰§è¡Œå®Œè¿™ä¸ªæ•°ç»„ï¼Œåœ¨ä¸€ä¸ªæ“ä½œå®Œæˆä¹‹åé€šçŸ¥ä¸‹ä¸€ä¸ªæ“ä½œå¼€å§‹æ‰§è¡Œ</li><li>çœ‹ä¼¼ä¸Šé¢å·²ç»å®Œæˆäº†æ‰€æœ‰é—®é¢˜ï¼Œä½†è¿˜æœ‰ä¸€ä¸ªéšè—é—®é¢˜éœ€è¦è§£å†³ã€‚åœ¨å·²çŸ¥çš„ä»»ä½•äº‹æƒ…ä»å®è§‚çš„è§’åº¦æ¥è®²ï¼Œéƒ½æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œä»å‰åˆ°åçš„æ¨ç§»ï¼ŒçŠ¹å¦‚æ—¶é—´çš„æ¨ç§»ã€‚ä½†æ˜¯ä»å¾®è§‚çš„è§’åº¦ï¼Œå¿…å®šä¼šæœ‰äº‹ä»¶çš„åˆ†æ”¯å’Œåˆæµï¼ˆä¸çŸ¥é“è¿™æ ·è¯´ä¼šä¸ä¼šè¢«æ‰“ï¼‰ã€‚å¦‚ä½•å¤„ç†è¿™ä¸€éƒ¨åˆ†çš„é€»è¾‘ä¹Ÿæ˜¯é‡ä¸­ä¹‹é‡ã€‚</li></ol></blockquote><p>å¯¹ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨æ•°ç»„ï¼Œå¯ä»¥åˆ—ä¸ºå‡½æ•°çš„å‚æ•°ï¼Œå¯ä»¥åƒPromiseä¸€æ ·é“¾å¼è°ƒç”¨æœ€åç»„æˆï¼Œå¥¥è¿˜æœ‰callbackã€‚</p><p>åˆ°ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“è”æƒ³åˆ°runSequenceè¿™ç§å‡½æ•°åï¼Œäºæ˜¯é›å½¢å°±æœ‰äº†</p><pre><code class="js">`function runSequence(...seqs) { }`</code></pre><p>æ‹¿åˆ°<code>seqs</code>å°±æ˜¯å¹²ï¼Œä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œå‘—ï¼Œé‡è¦çš„å°±æ˜¯å¦‚ä½•ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œã€‚ä»è¿™ä¸€ç‚¹æ¥çœ‹çš„åŒ–ï¼Œæ¯ä¸ªå¼‚æ­¥æ“ä½œéƒ½ä¼šæœ‰callbackï¼Œåªæ˜¯callbackçš„æ—¶æœºå’Œå†™æ³•ä¸ä¸€æ ·ï¼Œæˆ–ä¼˜æˆ–åŠ£ï¼Œä»callbacké‡Œè°ƒç”¨ä¸‹ä¸€æ¬¡æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥æŠŠcallbackæƒ³æˆnextå€Ÿç”¨koaçš„æ€æƒ³æŠŠåºåˆ—æ‰§è¡Œå®Œã€‚è¿™ä¸ªè¦æ±‚æ¯ä¸ªæ“ä½œéƒ½ä¼šè°ƒç”¨å¹¶ä¸”åªè°ƒç”¨ä¸€æ¬¡nextï¼Œä»¥æœ€æ™®é€šcallbackå‡½æ•°ä¸ºä¾‹ã€‚</p><pre><code class="js">function runSequence(...seqs) {    let i = 0;    const next = (index, ...args) =&gt; {        if (i !== index) {            console.warn(&#39;next call twice&#39;);            return;        }        let arg, callback;        if (typeof args[args.length - 1] === &#39;function&#39;) {            arg = args.slice(0, args.length - 1);            callback = args[args.length - 1];        } else {            arg = args;            callback = null;        }        const seq = seqs[i++];        if (!seq) {            callback &amp;&amp; callback(null, ...arg);            return;        }        try {            seq.call(null, ...arg, ((i, err, ...res) =&gt; {                if (err) {                    callback &amp;&amp; callback(err);                } else {                    next.call(null, i, ...res, callback);                }            }).bind(null, i));        } catch (err) {            callback &amp;&amp; callback(err);        }    }    return (...args) =&gt; {        next.call(null, 0, ...args);    }}</code></pre><p>å¤§åŠŸå‘Šæˆï¼Œæˆ‘ä»¬æ¥å†™ä¸€äº›ç®€å•çš„ä¾‹å­æµ‹è¯•ä¸€ä¸‹</p><pre><code class="js">const res = {    a: &#39;b&#39;,    b: &#39;c&#39;,}function fetch(key, next) {    console.log(`fetch ${key} start`, Date.now() | 0);    if (!key) {        next(&#39;err key&#39;);    }    setTimeout(() =&gt; {        console.log(`fetch ${key} end`, Date.now() | 0);        if (!res[key]) {            next(`${key} not found`);        } else {            next(null, res[key]);        }    }, 1000);}function runError(next) {    throw new Error(&#39;erred&#39;);    next();}runSequence(fetch, fetch, (data, next) =&gt; {    next(null, data + &#39;1&#39;);    next(null, data + &#39;2&#39;);}, (data, next) =&gt; {    console.log(data);    next(null, data + &#39;3&#39;);}, runError)(&#39;a&#39;, (err, ...data) =&gt; {    console.log(err, ...data, &#39;finish all&#39;);});</code></pre><p>logå¦‚ä¸‹</p><pre><code class="js">// fetch a start 5682// fetch a end 6686// fetch b start 6687// fetch b start 6687// c1// Error: erred &quot;finish all&quot;// warn: next call twice</code></pre><p>çœ‹ä¸Šå»æ²¡æ¯›ç—…äº†ã€‚æˆ‘ä»¬å¯ä»¥æ¥è§£å†³ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼Œè¿˜æ˜¯æ‹¿æ¥ä¸»ä¹‰ï¼Œå€Ÿé‰´<code>Promise.all</code>å’Œ<code>Promise.race</code>ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™callbackå†™ä¸€ä¸ªå¯¹åº”çš„allå’Œraceã€‚ç›´æ¥è´´ä»£ç </p><p>æ€»çš„æ¥è¯´ï¼Œä»»ä½•æ–¹æ¡ˆï¼Œåªè¦æ˜¯æœ‰è§„èŒƒï¼ŒæŒ‰è§„èŒƒèµ°å°±èƒ½å¾ˆå¥½çš„ä¼˜åŒ–è¿™ä¸ªæµç¨‹ã€‚æ¯”å¦‚æœ€åä¸€ä¸ªå‡½æ•°æ˜¯callbackï¼Œcallbackæœ€åï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯errç­‰ç­‰ã€‚ä½¿ç”¨Promiseä¹Ÿæœ‰ä¸€å®šéµå¾ªçš„ï¼Œå¦‚æœPromise.resolve(123, 345);ï¼Œåé¢çš„å‚æ•°å°±ä¼šè¢«å¿½ç•¥äº†ï¼Œå¦‚æœä½¿ç”¨äº†è¿™ä¸€ç‚¹runSequenceä¹Ÿèƒ½ä¼˜åŒ–å¾ˆå¤šã€‚runSequence.allæ•°ç»„é‡Œåªèƒ½ç”¨å‡½æ•°bindçš„å½¢å¼æ¥å†™ï¼Œå°±å¾ˆä¸‘ï¼Œå°±å¯ä»¥ç”¨thunkifyæ¥ä¼˜åŒ–ã€‚</p><p><a href="https://mp.weixin.qq.com/s/5swBKkITeG8yf9hZJbGfWg" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªExpressåº”ç”¨</title>
      <link href="/2018/04/28/Node/%E6%90%AD%E5%BB%BA%E4%BD%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAExpress%E5%BA%94%E7%94%A8/"/>
      <url>/2018/04/28/Node/%E6%90%AD%E5%BB%BA%E4%BD%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAExpress%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="Expressä»‹ç»"><a href="#Expressä»‹ç»" class="headerlink" title="Expressä»‹ç»"></a>Expressä»‹ç»</h1><ul><li>Express æ˜¯ä¸€ä¸ªç®€æ´è€Œçµæ´»çš„ node.js Webåº”ç”¨æ¡†æ¶, æä¾›ä¸€ç³»åˆ—å¼ºå¤§ç‰¹æ€§å¸®åŠ©ä½ åˆ›å»ºå„ç§Webåº”ç”¨</li><li>ä¸°å¯Œçš„HTTPå·¥å…·ä»¥åŠæ¥è‡ªConnectæ¡†æ¶çš„ä¸­é—´ä»¶éšå–éšç”¨ï¼Œåˆ›å»ºå¼ºå¥ã€å‹å¥½çš„APIå˜å¾—å¿«é€Ÿåˆç®€å•</li><li>Express ä¸å¯¹ node.js å·²æœ‰çš„ç‰¹æ€§è¿›è¡ŒäºŒæ¬¡æŠ½è±¡ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨å®ƒä¹‹ä¸Šæ‰©å±•äº†Webåº”ç”¨æ‰€éœ€çš„åŠŸèƒ½</li></ul><p>ä½¿ç”¨ Express å¯ä»¥å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ªå®Œæ•´åŠŸèƒ½çš„ç½‘ç«™ï¼Œå®ƒæœ‰ä¸€å¥—å¥å£®çš„ç‰¹æ€§ï¼Œå¯ç”¨äºå¼€å‘å•é¡µã€å¤šé¡µå’Œæ··åˆWebåº”ç”¨ã€‚</p><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><p>åœ¨ç¡®è®¤å·²ç»å®‰è£…äº†nodeä¹‹å(<a href="https://nodejs.org/en/#download" target="_blank" rel="noopener">ä¸‹è½½</a>), åœ¨ä½ çš„æœºå™¨ä¸Šåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œè®©æˆ‘ä»¬æ¥å¼€å§‹ä½ çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åºå§</p><pre><code class="js">//æ–°å»ºä¸€ä¸ªç›®å½•æ–‡ä»¶å¤¹,åˆå§‹åŒ–ä¸€ä¸ªpackjson.jsonæ–‡ä»¶    $mkdir express-demo &amp;&amp; cd express-demo  &amp;&amp; npm init</code></pre><pre><code class="js">//å®‰è£…Express$ npm install express -g</code></pre><p>ç°åœ¨æˆ‘ä»¬æ¥å†™çœŸæ­£çš„ä»£ç äº†ï¼åˆ›å»ºä¸€ä¸ªåä¸ºapp.js æˆ–è€… server.jsçš„æ–‡ä»¶ï¼Œå«ä»€ä¹ˆçœ‹ä½ ä¸ªäººå–œå¥½äº†ã€‚ è½½å…¥express ç„¶åä½¿ç”¨ä»£ç  express()åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨ç¨‹åº:<br><a id="more"></a></p><pre><code class="js">var express = require(&#39;express&#39;);var app = express();</code></pre><p>åœ¨è¿™ä¸ªåº”ç”¨ç¨‹åºå®ä¾‹é‡Œï¼Œä½ å¯ä»¥é€šè¿‡ app.VERB()å®šä¹‰è·¯ç”±ï¼Œä¸‹é¢çš„ä¾‹å­æ˜¯â€GET /â€œè¿”å› â€œHello Worldâ€ å­—ç¬¦ä¸²ã€‚ req å’Œ res å¯¹è±¡æ˜¯å’ŒnodeåŸç”Ÿæä¾›ç»™ä½ çš„ä¸€è‡´çš„ï¼Œä½ ä¹Ÿå¯ä»¥æ‰§è¡Œ res.pipe(), req.on(â€˜dataâ€™, callback) ç­‰ä»»ä½•äº‹æƒ…åœ¨æ²¡æœ‰Expressçš„æƒ…å†µä¸‹å¯ä»¥åšçš„äº‹æƒ…ã€‚</p><p>Express ç»™è¿™äº›å¯¹è±¡åŠ äº†ä¸€ä¸ªå°è£…å¥½çš„æ–¹æ³•ï¼Œæ¯”å¦‚ res.send(), å®ƒä¼šå¸®ä½ è®¾ç½®Content-Length:</p><pre><code class="js">app.get(&#39;./&#39;,function(req,res){    console.log(&quot;GET è¯·æ±‚æˆåŠŸ&quot;)ï¼›    req.send(&#39;Hello Express&#39;);})</code></pre><p>ç°åœ¨æˆ‘ä»¬é€šè¿‡æ‰§è¡Œ app.listen() æ¥ç»‘å®šå¹¶ç›‘å¬è¿æ¥ã€‚ å®ƒæ¥å—çš„å‚æ•°å’Œnodenet.Server#listen()çš„æ–¹æ³•ä¸€è‡´:</p><pre><code class="js">app.listen(3000,function(){    console.log(&#39;Listening on port %d&#39;, server.address().port);})</code></pre><p>ç„¶ååœ¨ç»ˆç«¯æ‰§è¡Œ<code>node app.js</code> æ‰“å¼€3000ç«¯å£çš„é¡µé¢å°±ä¼šçœ‹åˆ°<code>Hello Express</code>äº†</p><h2 id="ä½¿ç”¨express-generator-å¿«é€Ÿç”Ÿæˆä¸€ä¸ªåº”ç”¨ç¨‹åº"><a href="#ä½¿ç”¨express-generator-å¿«é€Ÿç”Ÿæˆä¸€ä¸ªåº”ç”¨ç¨‹åº" class="headerlink" title="ä½¿ç”¨express-generator å¿«é€Ÿç”Ÿæˆä¸€ä¸ªåº”ç”¨ç¨‹åº"></a>ä½¿ç”¨express-generator å¿«é€Ÿç”Ÿæˆä¸€ä¸ªåº”ç”¨ç¨‹åº</h2><h3 id="å®‰è£…express-generator"><a href="#å®‰è£…express-generator" class="headerlink" title="å®‰è£…express-generator"></a>å®‰è£…express-generator</h3><pre><code class="js">$ npm install express-generator -g</code></pre><p>è¿™ä¸ªå·¥å…·æä¾›äº†ä¸€ä¸ªéå¸¸ç®€å•çš„ç”Ÿæˆä¸€ä¸ªç¨‹åºéª¨æ¶çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒä¹Ÿæœ‰å±€é™ï¼Œæ¯”å¦‚å®ƒåªæ”¯æŒå¾ˆå°‘çš„å‡ ä¸ªæ¨¡æ¿å¼•æ“ã€‚ è€Œäº‹å®ä¸ŠExpresså‡ ä¹æ”¯æŒæ‰€æœ‰çš„ä¸ºnodeæ‰€å»ºçš„æ¨¡æ¿å¼•æ“ã€‚ ä½¿ç”¨ â€“helpæŸ¥çœ‹ä¸€ä¸‹å¸®åŠ©:</p><pre><code class="js">Usage: express [options]Options:  -h, --help          è¾“å‡ºå¸®åŠ©ä¿¡æ¯  -V, --version       è¾“å‡ºç‰ˆæœ¬å·  -e, --ejs           æ·»åŠ  ejs æ¨¡æ¿å¼•æ“æ”¯æŒ (é»˜è®¤ä¸ºjade)  -H, --hogan         æ·»åŠ  hogan.jsæ¨¡æ¿å¼•æ“æ”¯æŒ  -c, --css   æ ·å¼ &lt;å¼•æ“&gt; æ”¯æŒ (less|stylus) (é»˜è®¤ä¸ºcss)  -f, --force         å¼ºåˆ¶åœ¨éç©ºç›®å½•æ‰§è¡Œ</code></pre><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><pre><code class="js"> $ express myapp</code></pre><p>ç”Ÿæˆç›®å½•çš„å¦‚ä¸‹:<br><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-28/74845117.jpg" alt="express"></p><p>é»˜è®¤ä¸º<a href="http://jade-lang.com/" target="_blank" rel="noopener">jade</a>å’Œ<code>css</code>çš„ç»“æ„</p><p><strong>å¦‚æœä½ æƒ³ç”Ÿæˆä¸€ä¸ªæ”¯æŒ<a href="https://ejs.bootcss.com/" target="_blank" rel="noopener">ejs</a>, <a href="http://stylus-lang.com/" target="_blank" rel="noopener">Stylus</a>çš„åº”ç”¨ç¨‹åºï¼Œåªéœ€è¦ç®€å•çš„æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤</strong>ï¼š</p><p>åˆ™ç”Ÿæˆçš„ç›®å½•ä¸º<br><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-28/16498387.jpg" alt="ejs"></p><ul><li>app.jsï¼šå¯åŠ¨æ–‡ä»¶ï¼Œæˆ–è€…è¯´å…¥å£æ–‡ä»¶</li><li>package.jsonï¼šå­˜å‚¨ç€å·¥ç¨‹çš„ä¿¡æ¯åŠæ¨¡å—ä¾èµ–ï¼Œå½“åœ¨ dependencies ä¸­æ·»åŠ ä¾èµ–çš„æ¨¡å—æ—¶ï¼Œè¿è¡Œnpm installï¼Œnpm ä¼šæ£€æŸ¥å½“å‰ç›®å½•ä¸‹çš„ package.jsonï¼Œå¹¶è‡ªåŠ¨å®‰è£…æ‰€æœ‰æŒ‡å®šçš„æ¨¡å—</li><li>node_modulesï¼šå­˜æ”¾ package.json ä¸­å®‰è£…çš„æ¨¡å—ï¼Œå½“ä½ åœ¨ package.json æ·»åŠ ä¾èµ–çš„æ¨¡å—å¹¶å®‰è£…åï¼Œå­˜æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹</li><li>publicï¼šå­˜æ”¾ imageã€cssã€js ç­‰æ–‡ä»¶</li><li>routesï¼šå­˜æ”¾è·¯ç”±æ–‡ä»¶</li><li>viewsï¼šå­˜æ”¾è§†å›¾æ–‡ä»¶æˆ–è€…è¯´æ¨¡ç‰ˆæ–‡ä»¶</li><li>binï¼šå­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶</li></ul><p><strong>æ‰§è¡Œåº”ç”¨</strong></p><pre><code class="js">cd myappnpm installDEBUG=myapp:* npm start</code></pre><p>æ‰“å¼€3000ç«¯å£å°±ä¼šçœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼š<br><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-28/44690178.jpg" alt="expressapp"></p><p>è¿™äº›å°±æ˜¯ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºåˆ›å»ºå’Œè¿è¡Œçš„æ‰€æœ‰æ­¥éª¤ã€‚ è®°ä½Expressæ²¡æœ‰é™å®šä»»ä½•çš„ç›®å½•ç»“æ„ï¼Œè¿™åªæ˜¯ä¸€ä¸ªæ–¹ä¾¿ä½ å·¥ä½œçš„åŸºæœ¬ç»“æ„ã€‚ å¦‚æœä½ æƒ³å¾—åˆ°æ›´å¤šæ€ä¹ˆç»„ç»‡ç›®å½•ç»“æ„é€‰æ‹©ï¼Œå¯ä»¥æŸ¥çœ‹githubä¸Šçš„<a href="https://github.com/expressjs/express/tree/master/examples" target="_blank" rel="noopener">ç¤ºä¾‹</a>ã€‚</p><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p>æœ€åç»™å¤§å®¶æ¨èä¸€ä¸ªæ›´è¯¦ç»†çš„ä¾‹å­ï¼š<a href="http://ourjs.com/detail/56b2a6f088feaf2d031d2468" target="_blank" rel="noopener">ä½¿ç”¨expressæ­å»ºä¸€ä¸ªç®€å•çš„åšå®¢</a>;</p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Express </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2017 å¹´å´›èµ·çš„ JS é¡¹ç›®</title>
      <link href="/2018/04/26/%E6%9D%82%E6%96%87/2017-%E5%B9%B4%E5%B4%9B%E8%B5%B7%E7%9A%84-JS-%E9%A1%B9%E7%9B%AE/"/>
      <url>/2018/04/26/%E6%9D%82%E6%96%87/2017-%E5%B9%B4%E5%B4%9B%E8%B5%B7%E7%9A%84-JS-%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ€å—æ¬¢è¿é¡¹ç›®"><a href="#æœ€å—æ¬¢è¿é¡¹ç›®" class="headerlink" title="æœ€å—æ¬¢è¿é¡¹ç›®"></a>æœ€å—æ¬¢è¿é¡¹ç›®</h1><p><img src="https://risingstars.js.org/img/risingstars.png" alt="start"><br>ä¸‹é¢æ˜¯ä¸åˆ†ç±»åˆ«çš„ 2017 å¹´åº¦æœ€å—æ¬¢è¿ Javascript é¡¹ç›®ï¼Œå¦‚æœä½ æ—¶é—´å¾ˆç´§ï¼Œçœ‹è¿™éƒ¨åˆ†å°±å¤Ÿäº†ã€‚</p><h2 id="Vue-js-è‰è”å† å†›"><a href="#Vue-js-è‰è”å† å†›" class="headerlink" title="Vue.js è‰è”å† å†›"></a>Vue.js è‰è”å† å†›</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/40473742.jpg" alt="vue"></p><p><code>Vue.js</code> å†æ¬¡å¼ºåŠ¿ç™»é¡¶å¹´åº¦æ’è¡Œæ¦œå† å†›ï¼Œä»Šå¹´åœ¨ GitHub ä¸Šæ–°å¢äº†è¶…è¿‡ 40K çš„ starã€‚ç›¸è¾ƒäº 2016 å¹´çš„ï¼ˆ26K starï¼‰ï¼Œä»Šå¹´ Vue.js é¢†å…ˆæ’è¡Œæ¦œç¬¬ 2 åï¼ˆ React ï¼‰çš„ä¼˜åŠ¿æ›´å¤§äº†ã€‚</p><blockquote><p>é‚£ä¹ˆï¼Œæ˜¯ä»€ä¹ˆä»¤ Vue.js å¦‚æ­¤å‡ºä¼—ï¼Ÿ</p><ul><li>é¦–å…ˆï¼Œå®ƒå­¦ä¹ æ›²çº¿å¹³ç¼“ï¼Œä½¿ç”¨äº†ä¸ <code>React</code> ç›¸ä¼¼è¯­æ³•æ›´è®© WEB å¼€å‘è€…ç†Ÿæ‚‰çš„ç»„ä»¶æ–¹æ¡ˆï¼›</li><li>å‘å±•è‰¯å¥½çš„ç”Ÿæ€åœˆï¼Œç¤¾åŒºä¸­æ¶Œç°å‡ºäº‹å®ä¸Šçš„å®˜æ–¹æ ‡å‡†åº“ï¼šè·¯ç”±<code>vue-router</code>ï¼ŒçŠ¶æ€ç®¡ç†åº“: <code>Vuex</code>ï¼›</li><li>æŠŠæ¨¡æ¿ã€é€»è¾‘å’Œæ ·å¼æ”¾å…¥å•ä¸ª .vue æ–‡ä»¶ä¸­çš„å•æ–‡ä»¶ç»„ä»¶è®¾è®¡ç†å¿µåœ¨æ¨¡å—åŒ–ä»£è¡Œå…¶é“çš„ä»Šå¤©æ˜¾å¾—éå¸¸äº²åˆ‡ï¼›</li><li>è¢«æµè¡Œçš„ PHP æ¡†æ¶ Laravel é€‰ä¸ºé»˜è®¤çš„è§†å›¾å¼•æ“ï¼ˆView Engineï¼‰ï¼›</li><li>ä¸º <a href="https://github.com/yyx990803" target="_blank" rel="noopener">Evan You</a> ä¸ªäººç»´æŠ¤ï¼Œé€šè¿‡ä¼—ç­¹æ–¹å¼æ¥è·å–æ”¯æŒçš„å¼€æºé¡¹ç›®ï¼Œè€Œä¸æ˜¯ç”± Facebook æˆ– Google è¿™æ ·çš„äº’è”ç½‘å·¨å¤´æ¥ä¸»å¯¼ã€‚</li></ul></blockquote><p>ä¹Ÿè®¸æ­£å› ä¸ºä¸Šè¿°æœ€åä¸€ç‚¹ï¼ŒVue.js åœ¨ä¸­å›½æ‹¥æœ‰å¤§é‡çš„æ‹¥è¶¸ã€‚ä¸ä»…è¢«ä¸­å›½æœ€å¤§çš„ç”µå•†å¹³å°é˜¿é‡Œå·´å·´ä½¿ç”¨ï¼Œä¹Ÿè·å¾—äº† GitLab ä¸ Adobe è¿™äº›å…¬å¸é’çã€‚</p><h2 id="React-å†æ¬¡è·å¾—äºšå†›"><a href="#React-å†æ¬¡è·å¾—äºšå†›" class="headerlink" title="React å†æ¬¡è·å¾—äºšå†›"></a>React å†æ¬¡è·å¾—äºšå†›</h2><p>React å’Œ 2016 ä¸€æ ·ç¨³å ç¬¬äºŒåï¼Œ2017 å¹´å®ƒåœ¨ GitHub ä¸Šè·å¾—äº†è¶…è¿‡ 27K starï¼ˆå†æ¬¡æ˜ç¡®ä¸‹ï¼Œæ­¤å¤„æˆ‘ä»¬åˆ†æçš„æ˜¯ä»Šå¹´æ–°å¢çš„ star æ•°é‡è€Œéæ‰€æœ‰çš„ star æ•°é‡ï¼‰ã€‚</p><p><code>Create React App</code>ï¼Œæ˜¯æ’è¡Œæ¦œçš„å­£å†›ï¼Œå·²ç»æˆä¸ºæ–°å»º React é¡¹ç›®çš„é¦–é€‰æ–¹å¼ã€‚å®ƒçš„å¤§è·æˆåŠŸè®©ä¸å°‘ React æ ·æ¿é¡¹ç›®ï¼ˆReact Boilerplatesï¼‰æ…¢æ…¢æ·¡å‡ºå†å²èˆå°ã€‚</p><p><code>Dan Abramov</code>ï¼ˆ <code>Redux</code> ä½œè€…ï¼Œç°å°±èŒäº Facebookï¼‰åˆ›å»º <code>Create React App</code> çš„ç¡®æ˜¯åšäº†ä¸€ä»¶äº†ä¸èµ·çš„å·¥ä½œï¼Œä»–åœ¨åŠŸèƒ½æ€§ä¸ç®€æ´æ€§ä¹‹é—´å–å¾—äº†å·§å¦™çš„å¹³è¡¡ï¼Œæ¯”å¦‚ï¼Œå®ƒæ²¡æœ‰é›†æˆèŠ±å“¨çš„æ ·å¼è§£å†³æ–¹æ¡ˆï¼ˆåªä½¿ç”¨äº†çº¯ç²¹çš„ CSSï¼‰å’ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œå´å…·æœ‰æ°åˆ°å¥½å¤„çš„å°è£…ï¼Œè¿™äº›é€ å°±äº†è‰¯å¥½çš„å¼€å‘ä½“éªŒã€‚</p><a id="more"></a><h2 id="Axios"><a href="#Axios" class="headerlink" title="Axios"></a>Axios</h2><p><a href="https://github.com/axios/axios" target="_blank" rel="noopener">Axios</a> åº“æ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„ HTTP å®¢æˆ·ç«¯ã€‚å®ƒèƒ½åŒæ—¶åœ¨ç”¨æˆ·ç«¯ï¼ˆåœ¨ç”¨æˆ·ç«¯å‘èµ· Ajax è¯·æ±‚ï¼‰ä¸æœåŠ¡å™¨ç«¯ï¼ˆåœ¨ Node.js ç¯å¢ƒä¸­ï¼‰ä½¿ç”¨ã€‚</p><p>Axios çš„æˆåŠŸæˆ–è®¸ä¸ Vue.js æœ‰æ¯”è¾ƒå¤§çš„å…³ç³»ï¼Œå› ä¸ºå¤§é‡çš„ Vue.js æ•™ç¨‹éƒ½ä½¿ç”¨å®ƒæ¥å‘èµ· API è¯·æ±‚è·å–æ•°æ®ã€‚</p><h2 id="Puppeteer"><a href="#Puppeteer" class="headerlink" title="Puppeteer"></a>Puppeteer</h2><p><a href="https://github.com/GoogleChrome/puppeteer" target="_blank" rel="noopener">Puppeteer</a> æ˜¯17å¹´çš„å¤§äº‹ä»¶ä¹‹ä¸€ï¼Œæ˜¯ Google Chrome å›¢é˜Ÿå¼€å‘çš„ä¸€ä¸ªæ— ç•Œé¢ Chrome æµè§ˆå™¨ï¼Œå³ä¸€ä¸ªåœ¨åå°è¿è¡Œï¼Œä¸”èƒ½è¢«ä»£ç é©±åŠ¨å’Œæ§åˆ¶çš„æµè§ˆå™¨ã€‚</p><blockquote><p>å®ƒå¯ä½œå¦‚ä¸‹ç”¨é€”:<br>åœ¨çœŸå®æµè§ˆå™¨ä¸­è¿›è¡Œè‡ªåŠ¨åŒ–ç•Œé¢æµ‹è¯•ï¼›<br>ç”¨ç”Ÿæˆé¡µé¢å¿«ç…§çš„æ–¹å¼æ¥å®ç°æœåŠ¡ç«¯æ¸²æŸ“ï¼›<br>åˆ©ç”¨ Google Chrome â€œä¿å­˜ä¸º PDFâ€ çš„åŠŸèƒ½ç”ŸæˆPDFæ–‡ä»¶ï¼›</p></blockquote><h2 id="å‰ç«¯æ¡†æ¶"><a href="#å‰ç«¯æ¡†æ¶" class="headerlink" title="å‰ç«¯æ¡†æ¶"></a>å‰ç«¯æ¡†æ¶</h2><p>å‰ç«¯æ¡†æ¶æ–¹é¢å‘æ¥æ˜¯å…µå®¶å¿…äº‰ä¹‹åœ°ï¼Œä¸è¿‡å¦‚ä»Šå·²å‘ˆä¸‰å®¶é¼è¶³åˆ†ç«‹ï¼Œå¤§å±€å°˜åŸƒè½å®šä¹‹åŠ¿ã€‚</p><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/63945944.jpg" alt="å‰ç«¯æ¡†æ¶"></p><h3 id="Vueã€Reactã€Angular-ä¸‰è¶³é¼ç«‹"><a href="#Vueã€Reactã€Angular-ä¸‰è¶³é¼ç«‹" class="headerlink" title="Vueã€Reactã€Angular ä¸‰è¶³é¼ç«‹"></a>Vueã€Reactã€Angular ä¸‰è¶³é¼ç«‹</h3><p>æ¯«æ— ç–‘é—®ï¼Œç›®å‰å…¬è®¤çš„ 3 å¤§ UI æ¡†æ¶åˆ†åˆ«æ˜¯ <code>Vue.jsï¼ŒReact å’Œ Angular</code> ã€‚</p><p>æˆ‘ä»¬ä¹ æƒ¯ç§°ä»–ä»¬ä¸º_æ¡†æ¶<em>ï¼Œä½†å‡†ç¡®åœ°è®²åªæœ‰ Angular æ˜¯</em>æ¡†æ¶<em>ï¼ŒVue.js å’Œ React åº”å½’ç±»ä¸º</em>åº“_ã€‚</p><p>å‰æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»åˆ†æäº† Vue.js çš„æˆåŠŸå› ç´ å’Œå®ƒçš„é›†æˆæ–¹æ¡ˆã€‚</p><blockquote><p>ä¸ Vue.js ç›¸å¯¹åº”çš„ï¼ŒReact æ–¹é¢å´ä¾ç„¶å¤„äºç¢ç‰‡åŒ–çš„çŠ¶æ€ï¼Œå¼€å‘è€…éœ€è¦æ ¹æ®è‡ªèº«é¡¹ç›®çš„æƒ…å†µï¼Œè¿›è¡ŒæŠ€æœ¯é€‰å‹ï¼š<br>é¡µé¢é—´çš„è·¯ç”±åˆ‡æ¢é—®é¢˜ï¼›<br>å¦‚ä½•è·å–æ•°æ®ï¼›<br>å¦‚ä½•æŠŠæ•°æ®ç»‘å®šåˆ°è¡¨å•ï¼›<br>å¦‚ä½•å­˜å‚¨åº”ç”¨çš„çŠ¶æ€ï¼›</p></blockquote><p>ç›¸åï¼ŒAngular ç”Ÿæ€åœˆåˆ™æ›´å¯æ§ä¹Ÿæ›´ç¨³å®šã€‚æœ‰ä¸€ç§å«<em>Angular å‡†åˆ™</em> çš„æœ€ä½³å®è·µç”¨æ¥æŒ‡å¯¼å¼€å‘ã€‚</p><p>è¿™å¯èƒ½ç»™äººä¸€ç§ <code>Angular</code> å¯¹äºå¤šäººååŒå·¥ä½œæ›´å‹å¥½çš„å°è±¡ã€‚æ­¤å¤–ï¼Œéšç€æ”¯æŒé™æ€ç±»å‹çš„ <code>TypeScript</code> åŠ å…¥ï¼ŒAngular ä¹ŸåŠ¿å¿…èƒ½å¾—åˆ°æ›´å¤šç†Ÿæ‚‰ C# æˆ– Java çš„åç«¯å¼€å‘äººå‘˜äººè§‚æ³¨ä¸é’çã€‚</p><h3 id="å°‘å³æ˜¯å¤š"><a href="#å°‘å³æ˜¯å¤š" class="headerlink" title="å°‘å³æ˜¯å¤š"></a>å°‘å³æ˜¯å¤š</h3><p>åœ¨ä¸‰å·¨å¤´ä¹‹åï¼Œèƒ½éå¸¸æœ‰è¶£çš„å‘ç°ç¬¬å››å <a href="https://preactjs.com/" target="_blank" rel="noopener">Preact</a>ã€‚</p><p>Preact æ˜¯ä¸€ä¸ª React çš„å°å‹æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼šæœ‰ç›¸åŒçš„ APIï¼Œå´åªæœ‰ 3KB çš„å¤§å°ã€‚</p><p>ç±»ä¼¼çš„è¿˜æœ‰è®¸å¤šç«äº‰è€…ï¼Œä¸ºäº†åŒºåˆ«äºä¸‰å·¨å¤´ï¼Œå®ƒä»¬åœ¨æµè§ˆå™¨çš„æ€§èƒ½ä¸Šä¸‹åŠŸå¤«ï¼ŒåŠªåŠ›åšå‡ºè‡ªå·±çš„ç‰¹è‰²ã€‚</p><h2 id="Node-js-æ¡†æ¶"><a href="#Node-js-æ¡†æ¶" class="headerlink" title="Node.js æ¡†æ¶"></a>Node.js æ¡†æ¶</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/86424227.jpg" alt="node"><br>JavaScript å·²ä¸ä»…ä»…å±€é™äº Web å‰ç«¯åº”ç”¨ï¼Œä¹Ÿè¢«è¶Šæ¥è¶Šå¤šçš„äººä½¿ç”¨å¼€å‘åç«¯åº”ç”¨ã€‚Node.js ç¤¾åŒºé¢‡å…·æœ‰å½±å“åŠ›çš„ Mikeal Rogers åšå‡ºäº† Node.js ä¼šåœ¨ä¸€å¹´å†…è¶…è¶Š Javaçš„é¢„æµ‹ã€‚</p><p>å’Œå…¶ä»–è¯­è¨€éƒ½æœ‰äº‹å®ä¸Šçš„æ ‡å‡†æ¡†æ¶ä¸åŒçš„æ˜¯ï¼ˆå¦‚ Ruby æœ‰ Ruby on Railsï¼ŒPython æœ‰ Djangoï¼ŒPHP æœ‰ Laravelï¼‰ï¼Œç›®å‰åŸºäº Node.js å†™æœåŠ¡ç«¯ç¨‹åºè¿˜æ²¡æœ‰ä¸€ä¸ªå¤§å®¶éƒ½è®¤å¯çš„æ ‡å‡†æ¡†æ¶ã€‚</p><p><a href="https://expressjs.com/" target="_blank" rel="noopener">Express</a> å¹¶ä¸æ˜¯ 2017 å¹´åº¦çš„ Node.js æ¡†æ¶åˆ†ç±»æ’è¡Œå† å†›ï¼Œæ¯•ç«Ÿè¿™ä¸ªé¡¹ç›®å·²ç»æˆç«‹å¤šå¹´ï¼Œä½†å®ƒå·²è½¬å˜ä¸ºè®¸å¤šæ¡†æ¶å’Œ CMS çš„åŸºç¡€ç»„ä»¶ï¼ŒåŒ…æ‹¬ Feathersã€Keystone å’Œ Nestã€‚</p><p>Express çš„æç®€ä¸»ä¹‰è®¾è®¡ä¼¼ä¹å®Œç¾åœ°ç¬¦åˆäº†å½“ä»Šå¾®æœåŠ¡ç†å¿µçš„å‘å±•è¶‹åŠ¿ï¼šæŠŠä¸€ä¸ªå¤§å‹ç¨‹åºè§£è€¦æˆå‡ ä¸ªå°çš„åº”ç”¨ã€‚</p><blockquote><p>ä¸å»å¹´ç›¸æ¯”, ä»Šå¹´æœ‰ 3 ä¸ªæ–°é¢å­”è¿›å…¥äº† node.js æ¡†æ¶åˆ†ç±»æ’è¡Œçš„ TOP 10ï¼š</p><ul><li><a href="https://www.fastify.io/" target="_blank" rel="noopener">Fastify</a> æ˜¯ä¸€ä¸ªå— Hapi å¯å‘è€Œå¼€å‘çš„é€šç”¨ Web æ¡†æ¶ï¼Œä¹Ÿé€‚åˆç”¨ä½œ JSON HTTP API æœåŠ¡å™¨ï¼›</li><li><a href="https://serverjs.io/" target="_blank" rel="noopener">Server.js</a> æ³¨é‡äºâ€œå¼€ç®±å³ç”¨â€çš„å¼€å‘ä½“éªŒï¼›</li><li><a href="https://nestjs.com/" target="_blank" rel="noopener">Nest</a> æ˜¯ä¸€ä¸ªç”¨ TypeScript å†™çš„æ¡†æ¶ï¼Œå…¶æ¨¡å—åŒ–å’Œæ§åˆ¶å™¨ç»„åˆçš„æ¶æ„è®¾è®¡ï¼Œè®© Angular ç”¨æˆ·æ„Ÿåˆ°ååˆ†äº²åˆ‡ã€‚</li></ul></blockquote><h2 id="React-ç”Ÿæ€åœˆ"><a href="#React-ç”Ÿæ€åœˆ" class="headerlink" title="React ç”Ÿæ€åœˆ"></a>React ç”Ÿæ€åœˆ</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/46926901.jpg" alt="React ç”Ÿæ€åœˆ"></p><p>React åªä¸“æ³¨äºè§†å›¾å±‚ (View Layer)ï¼Œè¿™åœ¨ä¸ºæ•´ä¸ªç”Ÿæ€åœˆç•™ä¸‹æ›´å¤šå‘å±•ç©ºé—´çš„åŒæ—¶ï¼Œä¹Ÿä¸ºè‡ªèº«å¿«é€Ÿå‘å‰å‘å±•åˆ›é€ äº†æœºä¼šã€‚è¿™ä¸ªåˆ†ç±»ä¸‹æˆ‘ä»¬ä¼šç»Ÿè®¡åŸºäº React å’Œ React Native æ„å»ºçš„é¡¹ç›®ã€‚</p><p><a href="https://github.com/facebook/create-react-app" target="_blank" rel="noopener">Create React App</a>é€šè¿‡é›†æˆä¼˜ç§€çš„é¢„ç½®å’ŒåŒ…ï¼Œè§£å†³äº†æ–°å»º React åº”ç”¨æ—¶è¦è¿›è¡Œç¹çå¤æ‚çš„é…ç½®é—®é¢˜ã€‚ä»Šå¹´ Facebook ä¹Ÿç»§ç»­ä¿æŒäº†é¢‘ç¹æ›´æ–°çš„èŠ‚å¥ï¼Œä½¿ä»–æˆä¸ºç›®å‰ React ç”Ÿæ€ä¸­æœ€æ´»è·ƒçš„é¡¹ç›®ã€‚<a href="https://stackblitz.com/" target="_blank" rel="noopener">https://stackblitz.com/</a></p><p>ä½œä¸º Create React App çš„ä¸€ä¸ªæˆåŠŸæ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ <a href="https://stackblitz.com/" target="_blank" rel="noopener">StackBlitz</a>ï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨çº¿ IDEï¼Œé€šè¿‡ Create React Appï¼Œè®©ä½ åœ¨æ•°ç§’å†…å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­åˆ›å»ºä¸€ä¸ªåº”ç”¨ã€‚</p><p>å³ä½¿ Create React App å·²è¢«é»˜è®¤ä¸º React çš„æ–°å»ºå·¥å…·åŒ…ï¼Œå¼€å‘è€…ä»¬ä»ç„¶å¯ä»¥æœ‰å…¶å®ƒé€‰é¡¹ï¼Œä¾‹å¦‚ <a href="https://www.reactboilerplate.com/" target="_blank" rel="noopener">React boilerplate</a>ï¼Œè¿™ä¹Ÿæ˜¯ååˆ†å—äººå…³æ³¨çš„é¡¹ç›®ï¼Œç»§æ‰¿äº†è¯¸å¦‚ GraphQL çš„å¾ˆå¤šæœ‰ç”¨åŠŸèƒ½ã€‚</p><p><a href="http://ant.design/index-cn" target="_blank" rel="noopener">Ant Design</a>ï¼Œ<a href="https://pro.ant.design/index-cn" target="_blank" rel="noopener">Ant Design Pro</a> å’Œ <a href="http://www.material-ui.com/" target="_blank" rel="noopener">Material UI</a> æ˜¯ React ç»„ä»¶çš„æ ·å¼å·¥å…·é›†ï¼Œå®ƒä»¬èƒ½å¸®åŠ©ç¨‹åºå‘˜åœ¨æ–°å»ºåº”ç”¨æ—¶è€Œä¸å†æ‹…å¿ƒæ ·å¼é—®é¢˜ã€‚</p><p>ç¬¬ 10 å <a href="https://github.com/acdlite/recompose" target="_blank" rel="noopener">Recompose</a> çš„äººæ°”å€¼ä¹Ÿè¯æ˜äº†å¼€å‘è€…ä»¬å–œæ¬¢ React çš„åŸå› ï¼šå®ƒçš„<code>â€œå‡½æ•°å¼â€ç‰¹æ€§</code>ï¼Œä¸€åˆ‡çš†å‡½æ•°ã€‚Recompose æä¾›äº†ä¸€å…¨å¥—çš„å‡½æ•°æ¥å¸®åŠ©ä½ èµ°çš„æ›´è¿œã€‚</p><h2 id="Vue-js-ç”Ÿæ€åœˆ"><a href="#Vue-js-ç”Ÿæ€åœˆ" class="headerlink" title="Vue.js ç”Ÿæ€åœˆ"></a>Vue.js ç”Ÿæ€åœˆ</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/88257899.jpg" alt="vue ç”Ÿæ€åœˆ"></p><p>åœ¨ 2017 å¹´ï¼Œä¼´éšç€ Vue.js ç”¨æˆ·çš„å¢é•¿ï¼Œè®¸å¤š Vue.js ç”Ÿæ€åœˆä¸­çš„é¡¹ç›®ä¹Ÿå¾—åˆ°äº†ä»¤äººæƒŠå–œåœ°å¿«é€Ÿæˆé•¿ã€‚</p><p><a href="http://element.eleme.io/" target="_blank" rel="noopener">Element</a> å’Œ <a href="https://www.iviewui.com/" target="_blank" rel="noopener">iView</a> æ˜¯ä¸¤ä¸ªæœ€å—æ¬¢è¿çš„ UI ç»„ä»¶å·¥å…·åŒ…ï¼Œä¸“æ³¨äºæ¡Œé¢ç«¯ UI ç•Œé¢çš„å¿«é€Ÿå¼€å‘ã€‚è€Œ <a href="http://mint-ui.github.io/#!/en" target="_blank" rel="noopener">Mint UI</a> ä¸ <a href="https://vux.li/" target="_blank" rel="noopener">vux</a> åˆ™ç›¸åï¼Œæ˜¯ç§»åŠ¨ç«¯æœ€å—æ¬¢è¿çš„ UI å·¥å…·åŒ…ã€‚</p><p><a href="https://vuetifyjs.com/zh-Hans/" target="_blank" rel="noopener">Vuetify</a> æ˜¯ä¸€æ¬¾åŠŸèƒ½æœ€å®Œå¤‡çš„èƒ½åŒæ—¶é€‚ç”¨äºç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯çš„ Material Design ç»„ä»¶æ¡†æ¶å†…ç½®äº†åŒ…æ‹¬æœåŠ¡ç«¯æ¸²æŸ“ã€PWAã€CLI æ¨¡æ¿æ”¯æŒç­‰è¯¸å¤šç‰¹æ€§ã€‚</p><p><a href="https://nuxtjs.org/" target="_blank" rel="noopener">Nuxt</a> åˆ™æ˜¯ä¸€æ¬¾åŸºäº Vue.js çš„æ›´é«˜çº§çš„æ¡†æ¶ï¼Œå®ƒèƒ½è®©æˆ‘ä»¬æµç•…åœ°å¼€å‘å…·å¤‡æœåŠ¡å™¨ç«¯æ¸²æŸ“èƒ½åŠ›çš„ Vue.js åº”ç”¨ï¼Œè€Œå®ƒçš„é€šç”¨æ€§ä½¿æˆ‘ä»¬èƒ½ç”¨åŒæ ·çš„ä»£ç åº“æ¥æ„å»ºå•é¡µå¼•ç”¨ï¼Œç”šè‡³ç”Ÿæˆé™æ€ç½‘ç«™ã€‚</p><p><a href="https://weex.apache.org/" target="_blank" rel="noopener">Weex</a> æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨ Vue.js è¯­æ³•å’Œ API æ¥è¿›è¡ŒåŸç”Ÿæ¸²æŸ“çš„ç§»åŠ¨æ¡Œé¢åº”ç”¨å¼€å‘ã€‚å®ƒç”±é˜¿é‡Œå·´å·´å…¬å¸å¼€å‘ï¼Œå¹¶å·²è¿ç”¨äºä¸–ç•Œä¸Šä¸€äº›æœ€é«˜é¢‘ä½¿ç”¨çš„ç§»åŠ¨åº”ç”¨ä¸­ï¼Œååˆ†æ³¨é‡æ€§èƒ½é—®é¢˜ä¸Šçš„ä¼˜åŒ–ã€‚</p><h2 id="ç§»åŠ¨å¼€å‘"><a href="#ç§»åŠ¨å¼€å‘" class="headerlink" title="ç§»åŠ¨å¼€å‘"></a>ç§»åŠ¨å¼€å‘</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/87223585.jpg" alt="ç§»åŠ¨å¼€å‘"></p><p>æ— æ‰€ä¸èƒ½çš„ JavaScriptï¼Œè‡ªç„¶å¯å·²ç”¨æ¥ç¼–å†™ç§»åŠ¨åº”ç”¨ï¼Œè¿™æ„ä¸ºç€ä½ å¯ä»¥åœ¨ WEB ç«¯ä¸ Native ç«¯å¤ç”¨ä½ çš„ç»„ä»¶ã€‚</p><p>åœ¨æœ¬åˆ†ç±»ä¸­ï¼Œæˆ‘ä»¬ä¸º 3 å¤§å‰ç«¯æ¡†æ¶æ‰¾åˆ°äº†å¯¹åº”çš„è§£å†³æ–¹æ¡ˆï¼š<br>React: <a href="http://facebook.github.io/react-native/" target="_blank" rel="noopener">React Native</a><br>Vueï¼š<a href="https://weex.apache.org" target="_blank" rel="noopener">Weex</a> å’Œ <a href="http://quasar-framework.org/" target="_blank" rel="noopener">Quasar</a><br>Angularï¼š<a href="https://ionicframework.com/" target="_blank" rel="noopener">Ionic</a> å’Œ <a href="https://www.nativescript.org/" target="_blank" rel="noopener">NativeScript</a></p><p>ä¸ 2016 å¹´ä¸€æ ·ï¼ŒReact Native ä¸¤å¹´è‰è”å¤´åï¼Œå®ƒèƒ½è®©æˆ‘ä»¬ä½¿ç”¨æŠŠ JavaScript ç¼–è¯‘æˆèƒ½å¤Ÿè¿è¡Œåœ¨ iOSã€Android ç”šè‡³æ˜¯ Windows ç³»ç»Ÿçš„åŸç”Ÿ APP åº”ç”¨ã€‚</p><p>æ­£å¦‚è§†é¢‘ <a href="https://www.youtube.com/watch?v=1cI-978DHaA" target="_blank" rel="noopener">ä½¿ç”¨ React Native æ¥è·¨å¹³å°ç¼–è¯‘APPä¸­</a>æ‰€ç‰¹åˆ«å¼ºè°ƒçš„ï¼šâ€œWrite One, Run Everywhereâ€ çš„æ‰¿è¯ºå·²ç»å˜æˆç°å®ã€‚</p><h2 id="ç¼–è¯‘å·¥å…·ï¼šCompilers"><a href="#ç¼–è¯‘å·¥å…·ï¼šCompilers" class="headerlink" title="ç¼–è¯‘å·¥å…·ï¼šCompilers"></a>ç¼–è¯‘å·¥å…·ï¼šCompilers</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/76841479.jpg" alt="ç¼–è¯‘å·¥å…·"></p><p>è¿™é‡Œæˆ‘ä»¬å°†è®¨è®ºé‚£äº›ç¼–è¯‘åˆ°æ ‡å‡† JavaScript ä»£ç çš„è¯­è¨€ã€‚</p><blockquote><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨æ­å»ºè‡ªå·±çš„æ„å»ºå·¥ä½œæµæ—¶éœ€è¦ç¼–è¯‘å™¨å¯èƒ½æœ‰ 2 ä¸ªåŸå› ï¼š<br>æƒ³ç«‹å³ä½¿ç”¨æœ€æ–°çš„ JavaScript è¯­è¨€ç‰¹æ€§ï¼Œå¹¶æŠŠå®ƒåº”ç”¨åˆ°å°½å¯èƒ½å¤šçš„æµè§ˆå™¨ä¸­ï¼Œè¿™ç±»éœ€æ±‚è®© <a href="https://babeljs.io/" target="_blank" rel="noopener">Babel</a> è·å¾—äº†æˆåŠŸï¼Œå¾ˆå¤šé¡¹ç›®éƒ½ä¾èµ–äºå®ƒï¼›<br>æƒ³ä¸ºè¯­è¨€æ·»åŠ æ–°çš„ç‰¹æ€§ï¼Œæ¯”å¦‚â€œç±»å‹æ£€æŸ¥â€ï¼›<br>å¯¹ Javascript ç¨‹åºå‘˜è¿›è¡Œåˆ†ç±»æœ‰ä¸ªçƒ­é—¨çš„é—®é¢˜æ˜¯ï¼šä½ æ˜¯ç”¨ç±»å‹çš„ï¼Œè¿˜æ˜¯ä¸ç”¨ç±»å‹çš„ï¼Ÿ</p></blockquote><p>JavaScript æœ¬èº«å¸¦æœ‰åŸºæœ¬çš„åŠ¨æ€ç±»å‹ï¼Œä½†ç¼ºä¹é™æ€ç±»å‹ã€‚è€Œå¾ˆå¤šå¼€å‘è€…å€¾å‘äºåœ¨ä»£ç ä¸­ä½¿ç”¨ç±»å‹ï¼Œå°¤å…¶åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥è®©ä»£ç å˜å¾—æ›´ä¸ºå¥å£®ä¸”æ˜“äºé˜…è¯»å’Œç†è§£ã€‚</p><p>å¦‚æœä½ éœ€è¦ç±»å‹ï¼Œæœ‰ä¸¤ä¸ªä¸»æµå¯é€‰é¡¹ï¼šå¾®è½¯çš„ <a href="http://www.typescriptlang.org/" target="_blank" rel="noopener">TypeScript</a> å’Œ Facebook çš„ <a href="https://flow.org/" target="_blank" rel="noopener">Flow</a>ï¼ˆFacebook åœ¨è‡ªå·±çš„ä¸»è¦é¡¹ç›® Reactï¼ŒReact Nativeï¼ŒJest ä¸­éƒ½æœ‰ä½¿ç”¨)</p><p>ä½ å¯ä»¥ä» James Kyle çš„æ–‡ç« æ¥æ„Ÿå—ä¸¤è€…çš„åŒºåˆ«: <a href="https://medium.com/the-thinkmill/adopting-flow-typescript-3549a3a36d51" target="_blank" rel="noopener">A Comparison Between Adopting Flow or TypeScript</a></p><h2 id="æ„å»ºå·¥å…·ï¼šBuild-Tools"><a href="#æ„å»ºå·¥å…·ï¼šBuild-Tools" class="headerlink" title="æ„å»ºå·¥å…·ï¼šBuild Tools"></a>æ„å»ºå·¥å…·ï¼šBuild Tools</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/33742960.jpg" alt="æ„å»ºå·¥å…·"></p><p>æ„å»ºå·¥å…·åˆ†ç±»ä¸­çš„æ’è¡Œå† å†›æ˜¯ <a href="https://parceljs.org/" target="_blank" rel="noopener">Parcel</a>ï¼Œè¿™æˆ–è®¸æ˜¯ä»Šå¹´æœ€å¤§çš„æƒŠå–œï¼Œä½œä¸ºä¸€ä¸ª 8 æœˆä»½æ‰åœ¨ GitHub ä¸Šå‘å¸ƒçš„æ–°é¡¹ç›®å´å·²è¾¾åˆ° 14K ä¸ª star çš„å…³æ³¨åº¦ã€‚</p><p>Parcel ä¸ä»…æä¾›ç°ä»£å‰ç«¯å¼€å‘æ‰€éœ€çš„å„ç§åŠŸèƒ½ï¼Œè¿˜æœ‰ä¸ªç¢¾å‹æ€§çš„ä¼˜åŠ¿ï¼šé›¶é…ç½®ï¼è¿™æ˜¯å®ƒä¸ä¾é å¤§é‡ â€œloadersâ€ çš„ Webpack æœ€å¤§åŒºåˆ«ã€‚</p><p>è¯·åˆ«è¯¯è§£æ•°å­—ï¼Œ<a href="https://webpack.js.org/" target="_blank" rel="noopener">Webpack</a> ä¾ç„¶æ˜¯æœ€æµè¡Œçš„æ„å»ºåº”ç”¨ï¼Œå®ƒåœ¨ GitHub ä¸Š æœ‰ 35K çš„ star å’Œè¶… 500 äººçš„è´¡çŒ®è€…ã€‚ç›®å‰æœ‰è®¸å¤šé¡¹ç›®ä½¿ç”¨äº†å®ƒï¼ŒåŒ…æ‹¬ä»Šå¹´æœ€æµè¡Œçš„ä¸¤ä¸ªé¡¹ç›®ï¼šCreate React App å’Œ <a href="https://www.gatsbyjs.org/" target="_blank" rel="noopener">Gatsby</a>ã€‚</p><p>Webpack ä¸æ–­åœ¨è¿­ä»£æ›´æ–°ï¼Œ2.0 ç‰ˆæœ¬å¯ä»¥è®©å¼€å‘è€…é€šè¿‡åŠ¨æ€åŠ è½½çš„æ–¹å¼è½»æ¾å®ç°â€œä»£ç åˆ†å‰²â€çš„åŠŸèƒ½ã€‚</p><p>Webpack ä¸ Parcel åŒæ—¶å®šä½äºæ„å»º WEB åº”ç”¨ï¼Œè€Œ <a href="https://rollupjs.org/guide/en" target="_blank" rel="noopener">Rollup</a> åˆ™å®šä½äºåº“çš„æ„å»ºï¼Œå®ƒä¸“æ³¨äº ES6 æ¨¡å—çš„æ€§èƒ½æå‡ä¸Šã€‚</p><p>Rollup å·²è¢«ä¸€äº›ä¸»æµçš„åº“ä½¿ç”¨ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ React å›¢é˜Ÿä¹Ÿåœ¨ 2017 å¹´æŠŠå®ƒä»¬çš„æ„å»ºç³»ç»Ÿä» <a href="http://browserify.org/" target="_blank" rel="noopener">Browserify</a> åˆ‡æ¢åˆ°äº† Rollupã€‚</p><p>åœ¨ <a href="https://reactjs.org/blog/2017/12/15/improving-the-repository-infrastructure.html" target="_blank" rel="noopener">React åšå®¢</a>ä¸­æåˆ°</p><ul><li>Rollup å¯ä»¥é¢„ç¼–è¯‘å¹¶ä¸”é›†æˆåˆ°åº”ç”¨ä¸­ï¼Œèƒ½ä¸ React ä¹‹ç±»ç›¸ä¼¼çš„åº“åšåˆ°å®Œç¾é…åˆã€‚</li></ul><p><a href="https://poi.js.org/" target="_blank" rel="noopener">Poi</a> ä¸ Parcel æœ‰åŒæ ·çš„ç›®æ ‡ï¼šä¸€æ¬¾ç°ä»£ç½‘ç»œåº”ç”¨æ„å»ºå·¥å…·ï¼Œå®ƒé»˜è®¤é›¶é…ç½®ä½†ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ preset æ¥æ‰©å±•ã€‚</p><h2 id="æµ‹è¯•æ¡†æ¶"><a href="#æµ‹è¯•æ¡†æ¶" class="headerlink" title="æµ‹è¯•æ¡†æ¶"></a>æµ‹è¯•æ¡†æ¶</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/80887474.jpg" alt="æµ‹è¯•æ¡†æ¶"></p><p><a href="https://facebook.github.io/jest/" target="_blank" rel="noopener">Jest</a> æœ€åˆæ˜¯ Facebook å› ä¸º React ç»„ä»¶æµ‹è¯•ç›®çš„è€Œå¼€å‘çš„ï¼Œä½†æœ€è¿‘å‡ ä¸ªæœˆé©å‘½æ€§çš„ç‰ˆæœ¬å˜æ›´ï¼ˆå‘å¸ƒäº† 22 ä¸ªå¤§ç‰ˆæœ¬ï¼‰ä½¿å¾—å®ƒç°åœ¨èƒ½åŒæ—¶ç”¨äºæµ‹è¯•å‰ç«¯ã€åç«¯ä»£ç ã€‚</p><blockquote><p>Jest æœ‰å‡ ä¸ªå¤§çš„é—ªå…‰ç‚¹ï¼š<br>æ— éœ€é…ç½®ï¼Œé»˜è®¤åœ°è®¾å®šå·²ç»æ»¡è¶³é€šå¸¸éœ€æ±‚ï¼›<br>å¼ºå¤§çš„å¼€å‘è€…ä½“éªŒ (æ™ºèƒ½è§‚å¯Ÿæ¨¡å¼ï¼Œç›´è§‚çš„é”™è¯¯æŠ¥å‘Š)ï¼›<br>è¯­æ³•ä¸Šä¸ Mocha å¾ˆæ¥è¿‘ï¼Œè®¸å¤šç¨‹åºå‘˜ç†Ÿæ‚‰ describe å’Œ it è¿™æ ·çš„å…³é”®è¯ï¼›<br>ä¸éœ€è¦é¢å¤–çš„åº“æ¥åˆ›å»º assertionsï¼Œå·²å…¨éƒ¨å†…ç½®ï¼›<br>ç‹¬ç‰¹çš„â€å¿«ç…§â€æ¨¡å¼å¯ä»¥ä½œä¸ºé‡æ–°è¿è¡Œæµ‹è¯•æ—¶çš„å¯¹æ¯”åŸºå‡†ï¼›</p></blockquote><p><a href="https://github.com/avajs/ava" target="_blank" rel="noopener">AVA</a>ï¼Œå»å¹´çš„ç¬¬ä¸€åï¼Œä»ç„¶æœ‰è®¸å¤šå¸å¼•äººçš„ç‰¹ç‚¹ã€‚</p><p>è¿™ä¸ªé¡¹ç›®ç”± Sindre Sorhus åˆ›å»ºå¹¶åœ¨ä»–æ‰€æœ‰çš„é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œç†Ÿæ‚‰ä»–çš„åŒå­¦è‚¯å®šçŸ¥é“è¿™æ„å‘³ç€ä»€ä¹ˆï¼</p><p>ç›¸è¾ƒäº Jestï¼ŒAVA æ›´ä¾§é‡äºå¹¶è¡Œæµ‹è¯•ä¸Šçš„é€Ÿåº¦ï¼Œæ›´è½»é‡ï¼Œä¹Ÿæ›´æ¥è¿‘æµ‹è¯•æ ‡å‡†ï¼Œè¯­æ³•ä¸Šä¸æµ‹è¯•æ¡†æ¶ <a href="https://github.com/substack/tape" target="_blank" rel="noopener">Tape</a> æ¥è¿‘ã€‚</p><h2 id="IDE-å’Œç¼–è¾‘å™¨"><a href="#IDE-å’Œç¼–è¾‘å™¨" class="headerlink" title="IDE å’Œç¼–è¾‘å™¨"></a>IDE å’Œç¼–è¾‘å™¨</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/98882368.jpg" alt="IDE"></p><p>åœ¨è¿™é‡Œæˆ‘ä»¬è®¨è®ºçš„æ˜¯åˆ©ç”¨ WEB æŠ€æœ¯æ¥æ„å»ºçš„å¼€æºçš„ä»£ç ç¼–è¾‘å™¨ï¼ˆ Sublime ç²‰ä¸ä»¬å¯¹ä¸ä½äº†ï¼ï¼‰ã€‚</p><p>2016 å¹´ç”±å¾®è½¯ä¸»å¯¼çš„ VS Code ä¸ GitHub ä¸»å¯¼çš„ Atom åœ¨æœ¬ç±»åˆ«ä¸­é½å¤´å¹¶è¿›ã€‚ä»Šå¹´ä»–ä»¬ä¹Ÿä¾ç„¶å¤„äºé¢†å…ˆåœ°ä½ï¼Œä¸è¿‡åœ¨äº’ç›¸è¾ƒé‡ä¸­ï¼ŒVS Code å·±é¢†å…ˆå®ƒçš„å¯¹æ‰‹ä¸€å¤§æˆªã€‚</p><p>æ¯ä¸ªæœˆ VS Code éƒ½ä¼šå‘å¸ƒæ–°ç‰ˆæœ¬ï¼Œå¸¦æ¥æ›´å¤šå®ç”¨ IDE åŠŸèƒ½åŒæ—¶æ€§èƒ½ä¸Šå´æ²¡æœ‰å¤ªå¤§çš„æŸè€—ã€‚</p><blockquote><p>å³ä½¿ä¸å®‰è£…ä»»ä½•æ’ä»¶ï¼Œä½ ä¹Ÿæœ‰ä¸€å¤§å †å¼€ç®±å³ç”¨çš„åŠŸèƒ½ï¼š<br>Git é›†æˆåŠŸèƒ½ï¼›<br>è‡ªåŠ¨è¡¥å…¨ï¼šJavaScript è¯­æ³•ï¼Œæ–‡ä»¶è·¯å¾„è¿›è¡Œè¡¥å…¨ï¼Œnpm åŒ…åå­—ç­‰ç­‰ï¼›<br>React è¯­æ³•é›†æˆç­‰ï¼›</p></blockquote><p>æ­¤å¤–ï¼Œä½ å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­æ·»åŠ  Prettier æ’ä»¶ï¼Œè¿™æ ·æ¯æ¬¡ä¿å­˜æ—¶å®ƒéƒ½ä¼šè‡ªåŠ¨æ ¼å¼åŒ–æ–‡ä»¶ï¼Œåœ¨è¿™æ ·çš„ç¼–ç¨‹ç¯å¢ƒä¸‹ç¼–ç çœŸæ˜¯ä¸€ç§äº«å—ã€‚</p><h2 id="CSS-in-JavaScript"><a href="#CSS-in-JavaScript" class="headerlink" title="CSS in JavaScript"></a>CSS in JavaScript</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/64211475.jpg" alt="css in js"></p><p>ç›®å‰ React ç¤¾åŒºä»ç„¶æ²¡æœ‰å°±å¦‚ä½•æœ‰æ•ˆç®¡ç†ç»„ä»¶æ ·å¼è¿™ä¸ªé—®é¢˜è¾¾æˆå…±è¯†ï¼Œå³æ²¡æœ‰æ ‡å‡†çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>å¦‚æœæ— éœ€å¤ªå¤šè‡ªå®šä¹‰çš„æ ‡å‡†æ ·å¼ï¼Œå¯ä»¥ç”¨ Material UI æˆ– Ant Design è¿™æ ·ç°æˆçš„ç»„ä»¶å·¥å…·åŒ…ã€‚å¦‚æœéœ€è¦æ›´é«˜åº¦çµæ´»çš„è‡ªå®šä¹‰ï¼Œä½ ä»ç„¶èƒ½ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼ï¼šç”¨ä¸€ä¸ªåƒ Bootstrap æˆ– Bulma è¿™æ ·çš„å…¨å±€ CSS æ ·å¼ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶çš„ className å±æ€§æ¥è¾¾åˆ°ç›®çš„ã€‚è¿™æ ·åšç¼ºç‚¹æ˜¯ç»„ä»¶æ— æ³•è¿›è¡Œè‡ªæˆ‘æ ·å¼ç®¡ç†ï¼Œå› ä¸ºæ ·å¼åˆ†å¸ƒåœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚</p><p>CSS in JavaScript æ¦‚å¿µçš„å‡ºç°å³æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p><p>æ¦‚å¿µæœ¬èº«å¾ˆç®€å•ï¼šæ—¢ç„¶æˆ‘ä»¬åœ¨ React ä¸­å·±èƒ½é€šè¿‡ JavaScript æ¥åŒæ—¶æ§åˆ¶é€»è¾‘å’Œæ¨¡æ¿éƒ¨åˆ†ï¼Œä½•ä¸å†è¿›ä¸€æ­¥ï¼Œè¿æ ·å¼ä¹Ÿä¸€å¹¶ç®¡ç†äº†å‘¢ï¼Ÿ</p><p><a href="https://www.styled-components.com/" target="_blank" rel="noopener">Styled Components</a> æ˜¯ä»Šå¹´æœ¬ç±»åˆ«çš„å† å†›ï¼Œå®ƒåˆ©ç”¨ JavasScript æœ€è¿‘æ–°åŠ å…¥çš„æ¨¡æ¿å­—ç¬¦ä¸²ç‰¹æ€§ï¼Œè®©å¼€å‘è€…åœ¨ React ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨æ ‡å‡†çš„ CSS è¯­æ³•ç¼–å†™æ ·å¼ã€‚</p><p><a href="https://github.com/css-modules/css-modules" target="_blank" rel="noopener">CSS Modules</a>ï¼Œä½œä¸ºæœ¬ç±»åˆ«çš„äºšå†›ï¼Œåˆ™é‡‡ç”¨äº†æ··åˆçš„è§£å†³æ–¹æ¡ˆã€‚å®ƒè®©å¼€å‘è€…è‡ªå·±æŒ‘é€‰è¯¸å¦‚æ ‡å‡† CSS, SASS, NO slug Less, NO slug Stylusç­‰æ–¹å¼ç¼–å†™æ ·å¼ï¼Œå†ä»¥æ–‡ä»¶çš„æ–¹å¼å¯¼å…¥åˆ°ç»„ä»¶ä¸­ã€‚</p><p><a href="http://markdalgleish.com/" target="_blank" rel="noopener">Mark Dalgleish</a>ï¼ŒCSS Modules çš„ä½œè€…ï¼Œå†™äº†ä¸€ç¯‡æœ‰æ„æ€çš„æ–‡ç« æ¥é˜è¿° CSS-in-JavaScript è§£å†³æ–¹æ¡ˆï¼š<a href="https://medium.com/seek-blog/a-unified-styling-language-d0c208de2660" target="_blank" rel="noopener">A Unified Styling Language</a>ã€‚å¦‚æœä½ å¯¹ CSS-in-Javascript è§£å†³æ–¹æ¡ˆä»æŒæ€€ç–‘æ€åº¦çš„è¯ï¼Œé‚£æ­¤æ–‡ç»å¯¹ä¸å®¹é”™è¿‡ã€‚</p><h2 id="é™æ€ç½‘ç«™ç”Ÿæˆå™¨"><a href="#é™æ€ç½‘ç«™ç”Ÿæˆå™¨" class="headerlink" title="é™æ€ç½‘ç«™ç”Ÿæˆå™¨"></a>é™æ€ç½‘ç«™ç”Ÿæˆå™¨</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/39790757.jpg" alt="é™æ€ç½‘ç«™ç”Ÿæˆå™¨"></p><p>é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼ˆSSGï¼ŒStatic Site Generatorï¼‰æ˜¯æŒ‡èƒ½å¤Ÿç”Ÿæˆä¸€å¨ HTMLã€CSSã€JS æ–‡ä»¶ï¼Œæ–¹ä¾¿ä½ å¿«é€Ÿéƒ¨ç½²åˆ° WEB æœåŠ¡å™¨ä¸Šè€Œä¸éœ€è¦å®‰è£…å’Œé…ç½®æ•°æ®åº“çš„å·¥å…·ã€‚</p><p>é™æ€ç½‘ç«™å…·æœ‰é€Ÿåº¦å¿«ï¼Œç¨³å®šä¸”æ˜“äºç»´æŠ¤çš„ç‰¹ç‚¹ã€‚ä½œä¸º 2016 å¹´çš„äºšå†›ï¼ŒGatsby ä»Šå¹´æˆåŠŸæ‹¨å¾—å¤´ç­¹ã€‚å®ƒæ–°å¢äº†è®¸å¤šæ–°åŠŸèƒ½æ¥åŠ©ä½ ä¼˜åŒ–é™æ€ç½‘ç«™ï¼š</p><p>å¿«é€Ÿæµè§ˆå’Œå¯¼å‡ºé€Ÿåº¦ï¼›<br>ä¸»åŠ¨é¢„åŠ è½½æœºèƒ½ï¼›<br>æ™ºèƒ½ä»£ç åˆ†è§£ (æ¨¡æ¿ + ç½‘é¡µæ•°æ®)ï¼›<br><a href="https://www.gatsbyjs.org/" target="_blank" rel="noopener">Gatsby</a> ä½¿ç”¨ React æ¥åšè§†å›¾å±‚(View Layer)ï¼Œæ„å»ºæ—¶å€™åˆ™ç”¨ GraphQL æ¥æŸ¥è¯¢å†…å®¹ã€‚å®ƒæœ‰ä¸€ä¸ªå¼ºå¤§çš„ç¤¾åŒºå¹¶ä¸” React å®˜ç½‘ä¹Ÿæ˜¯ç”¨ Gatsby çš„æ¥æ­å»ºçš„.</p><p><a href="https://github.com/nozzle/react-static" target="_blank" rel="noopener">React Static</a> æ˜¯æœ¬ç±»åˆ«çš„æ–°é¢å­”ã€‚å®ƒä» Create React App é¡¹ç›®ä¸­è·å¾—çµæ„Ÿï¼Œå®šä½äºåšä¸€ä¸ªè½»é‡çš„ Gatsby æ›¿ä»£æ–¹æ¡ˆï¼Œä¸“æ³¨äºæ€§èƒ½å’Œç®€æ´ã€‚</p><p>æ­¤å¤–ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ <a href="https://zeit.co/blog/next4" target="_blank" rel="noopener">Next.js</a> ä¹Ÿèƒ½å½“é™æ€ç½‘ç«™ç”Ÿæˆå™¨æ¥ç”¨ã€‚</p><h2 id="GraphQL"><a href="#GraphQL" class="headerlink" title="GraphQL"></a>GraphQL</h2><p><img src="http://hexobed.oss-cn-beijing.aliyuncs.com/18-4-27/51248317.jpg" alt="GraphQL"></p><p>åœ¨æœªæ¥å›é¡¾ GraphQL çš„å†å²æ—¶ï¼Œ2017 å¹´å¾ˆæœ‰å¯èƒ½ä¼šæˆä¸ºä¸€ä¸ªè½¬æŠ˜ç‚¹ã€‚</p><p>åƒ the New York Times è¿™æ ·çš„å¤§å…¬å¸å¼€å§‹ä½¿ç”¨ GraphQLï¼Œ<a href="https://code.facebook.com/posts/1362748677097871/relay-modern-simpler-faster-more-extensible/" target="_blank" rel="noopener">Relay</a> å’Œ <a href="https://dev-blog.apollodata.com/apollo-client-2-0-5c8d0affcec7" target="_blank" rel="noopener">Apollo</a> (ä¸¤ä¸ªä¸»è¦çš„ GraphQL å®¢æˆ·ç«¯æ¡†æ¶) ä¹Ÿåœ¨ä»Šå¹´å‘å¸ƒäº†ä¸¤ä¸ªé‡è¦çš„ç‰ˆæœ¬æ›´æ–°ã€‚</p><p>åœ¨è¿™ä¸¤å¤§åº“çš„èº«åï¼Œåƒ Graphcool è¿™æ ·çš„å…¬å¸ä¹Ÿæä¾›äº†å¤§é‡çš„å·¥å…·å’Œåº“ï¼Œè€Œ Vulcan è¿™æ ·çš„å…¨æ ˆæ¡†æ¶ä¹Ÿå¼€å§‹é‡‡ç”¨ GraphQL ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ä»Šå¹´æœ€æœ‰äººæ°”çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ <a href="https://www.gatsbyjs.org/" target="_blank" rel="noopener">Gatsby</a> ä¹Ÿåœ¨æ•°æ®å¤„ç†ä¸­ä½¿ç”¨äº† GraphQL ã€‚</p><p>éšç€è¶Šæ¥è¶Šå¤šçš„äººåŠ å…¥åˆ° GraphQL é˜µè¥æ¥, å¯ä»¥é¢„è§å…¶åœ¨æŠ€æœ¯ä¸Šå¹¿æ³›å–ä»£ REST åªæ˜¯ä¸€ä¸ªæ—¶é—´é—®é¢˜ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¸Œæœ›æˆ‘ä»¬ä»Šå¹´å¯¹ JavaScript é¢†åŸŸåšå‡ºçš„å›é¡¾èƒ½å¤Ÿå¯¹ä½ æœ‰æ‰€å¯å‘ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼ŒVue.js ä¸¤å¹´è‰è”å† å†›å¹¶ä¸”æ²¡æœ‰ä¸æ¯«åœä¸‹æ¥çš„å¾å…†ã€‚</p><p>React ç”Ÿæ€åœˆä¹Ÿæœ€ç»ˆè§£å†³äº†è¯ä¹¦é—®é¢˜ï¼Œç»§ç»­ç¹è£å‘å±•çš„åŠ¿å¤´ã€‚</p><p>ä½†æ˜¯å¦‚æœè®©æˆ‘ä»¬è¯„é€‰<em>2017 é¡¹ç›®ä¹‹æ˜Ÿ</em>çš„è¯ï¼Œé‚£ç»å¯¹æ˜¯ <a href="https://prettier.io/" target="_blank" rel="noopener">Prettier</a>ã€‚æœ‰äº†å®ƒï¼Œæˆ‘ä»¬å†™ä»£ç æ—¶çš„å†ä¹Ÿä¸ç”¨æ‹…å¿ƒæ ¼å¼é—®é¢˜ï¼</p><p>State of JavaScript 2017 survey æ”¶é›†å’Œåˆ†æäº† 23,000 ä½å¼€å‘è€…çš„è°ƒç ”é—®å·ï¼Œèƒ½å¸®åŠ©ä½ ä»å¦ä¸€ä¸ªè§†è§’æ¥è§£è¯»ç¤¾åŒºæ¼”åŒ–çš„æ–¹å‘ã€‚</p><p><a href="https://zhuanlan.zhihu.com/p/33163673" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> æ‚æ–‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>reduxå­¦ä¹ ä¹‹å‡çº§æ°´æœåº—é¢</title>
      <link href="/2018/04/25/React/Redux/redux%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%8D%87%E7%BA%A7%E6%B0%B4%E6%9E%9C%E5%BA%97%E9%9D%A2/"/>
      <url>/2018/04/25/React/Redux/redux%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%8D%87%E7%BA%A7%E6%B0%B4%E6%9E%9C%E5%BA%97%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¼˜é›…çš„å¤„ç†-async-action"><a href="#ä¼˜é›…çš„å¤„ç†-async-action" class="headerlink" title="ä¼˜é›…çš„å¤„ç† async action"></a>ä¼˜é›…çš„å¤„ç† async action</h2><p>é˜¿å¤§é€šè¿‡è¯·äº†ä¸€ä¸ªé‡‡è´­å‘˜å®Œæˆäº†è€—æ—¶çš„è¿›å£å•†å“çš„å”®å–ã€‚</p><p>ä½†æ˜¯ï¼Œé˜¿å¤§åŒæ—¶ä¹Ÿå‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼šé¡¾å®¢è¦ä¹°æ°´æœç”Ÿé²œçš„è¯éœ€è¦æ‰¾<strong>é”€å”®å‘˜</strong>ï¼Œè¦ä¹°è¿›å£æ°´æœç”Ÿé²œçš„è¯è¦æ‰¾<strong>é‡‡è´­å‘˜</strong>ï¼Œè¿™æ ·çš„è¯ï¼Œé¡¾å®¢éœ€è¦æ‰¾ä¸åŒçš„äººï¼Œå¾ˆéº»çƒ¦ã€‚é˜¿å¤§æƒ³äº†æƒ³ï¼Œèƒ½ä¸èƒ½è®©é¡¾å®¢åªæ‰¾<strong>é”€å”®å‘˜</strong>ï¼Œç„¶å<strong>é”€å”®å‘˜</strong>å¦‚æœæœ‰éœ€æ±‚å†æ‰¾<strong>é‡‡è´­å‘˜</strong>é‡‡è´­å‘¢ã€‚</p><p>é˜¿å¤§æƒ³åˆ°äº†åŠæ³•ï¼Œè®©<strong>é”€å”®å‘˜</strong>æŠŠæ‰€æœ‰çš„éœ€æ±‚éƒ½å‘Šè¯‰é‡‡è´­å‘˜ï¼Œç„¶å<strong>é‡‡è´­å‘˜</strong>å†ä¼ é€’ç»™<strong>æ”¶é“¶å‘˜</strong>ï¼Œè¿™æ ·ï¼Œå¦‚æœæ˜¯éœ€è¦é‡‡è´­çš„æ°´æœç”Ÿé²œï¼Œå°±å¯ä»¥ç‹¬è‡ªå»å¤„ç†äº†ï¼Œè¿™æ ·å°±éœ€è¦æŠŠ<strong>é‡‡è´­å‘˜</strong>æ”¹æˆè¿™æ ·äº†ï¼š</p><pre><code class="js">const API = store =&gt; {  // å’Œ æ”¶é“¶å‘˜ å¯¹æ¥çš„æ–¹å¼  const next = store.dispatch;  // æ¥ç®¡é”€å”®å‘˜ä¼ æ¥çš„é¡¾å®¢éœ€æ±‚  store.dispatch = action =&gt; {    // å¤„ç†å®Œäº†ä¹‹åå†å¯¹æ¥ æ”¶é“¶å‘˜    switch (action.type) {      case &#39;BUY_IMPORTED_APPLE&#39;: fetching(2000, () =&gt; next(action)); break;      case &#39;BUY_IMPORTED_EGG&#39;: fetching(3000, () =&gt; next(action)); break;      default: next(action);    }  }}API(store);</code></pre><p>ç„¶åé¡¾å®¢æ¥äº†ä¹‹åå°±éƒ½åªç”¨æ‰¾é”€å”®å‘˜äº†ï¼š<br><a id="more"></a></p><pre><code class="js">store.dispatch(buyApple(3));store.dispatch(buyImportedApple(10));store.dispatch(buyEgg(1));store.dispatch(buyImportedEgg(10));store.dispatch(buyApple(4));store.dispatch(buyImportedApple(10));store.dispatch(buyEgg(8));store.dispatch(buyImportedEgg(10));// {&quot;fruit&quot;:{&quot;apple&quot;:3,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:0,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:3,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:1,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:1,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:10},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:20},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:20},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:10}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:20},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:20}}</code></pre><h3 id="å›¾è§£"><a href="#å›¾è§£" class="headerlink" title="å›¾è§£"></a>å›¾è§£</h3><p><img src="https://user-gold-cdn.xitu.io/2018/4/20/162e3327a35fb0a4?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="asyncAction"></p><h2 id="ç¼–å†™å’Œä½¿ç”¨ä¸­é—´ä»¶"><a href="#ç¼–å†™å’Œä½¿ç”¨ä¸­é—´ä»¶" class="headerlink" title="ç¼–å†™å’Œä½¿ç”¨ä¸­é—´ä»¶"></a>ç¼–å†™å’Œä½¿ç”¨ä¸­é—´ä»¶</h2><p>é˜¿å¤§é€šè¿‡æ”¹å–„æµç¨‹å¯¹æ¥å®Œæˆäº†æ°´æœåº—çš„å‡çº§ã€‚</p><p>ä½†æ˜¯é˜¿å¤§åˆæœ‰ä¸€ä¸ªæ–°çš„æƒ³æ³•ï¼Œä»–æƒ³è¯¦ç»†çš„çœ‹çœ‹æ¯ä¸€ä¸ªé¡¾å®¢çš„<code>è´­ä¹°éœ€æ±‚</code>æ¥äº†ä¹‹åï¼Œè´¦æœ¬çš„å‰åå˜åŒ–ã€‚çœ‹æ¥åˆè¦åŠ ä¸€ä¸ªæ–°è§’è‰²<strong>è®°å½•å‘˜</strong>äº†ã€‚éš¾é“è¦åƒåŠ é‡‡è´­å‘˜é‚£æ ·æ‰‹åŠ¨çš„ä¸€ä¸ªä¸ªçš„åŠ å—ï¼Ÿé‚£å¯å¤ªéº»çƒ¦äº†ã€‚æ­£å¥½é˜¿å¤§å‘ç° redux é‡Œæœ‰ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯<strong>ä¸­é—´ä»¶</strong>ã€‚ä¸­é—´ä»¶æ˜¯å¹²å˜›çš„å‘¢ï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯æŠŠé¡¾å®¢çš„éœ€æ±‚ä»é”€å”®å‘˜åˆ°æ”¶é“¶å‘˜ä¹‹é—´åŠ ä¸Šå„ç§è§’è‰²æ¥å¤„ç†ã€‚æ¯ä¸€ä¸ªè§’è‰²å°±æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ã€‚æ¥ä¸‹æ¥é˜¿å¤§å°±å¼€å§‹æ¥å†™ä¸­é—´ä»¶äº†ã€‚</p><p>redux ä¸­é—´ä»¶å†™èµ·æ¥å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªå‡½æ•°è€Œå·²ã€‚æŒ‰ç…§å®ƒçš„è¦æ±‚ã€‚è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª<strong>{ dispatch, getState }</strong>å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ª <strong>action</strong></p><p>é‚£è¿™æ ·ï¼Œå°±å¯ä»¥æŠŠåŸæ¥çš„<code>é‡‡è´­å‘˜ä¹Ÿæ”¹é€ æˆä¸­é—´ä»¶</code>äº†ï¼Œå…¶å®é‡‡è´­å‘˜å°±æ˜¯æ‹¿åˆ°äº†é¡¾å®¢éœ€æ±‚ä¹‹åè®©é¡¾å®¢çš„éœ€æ±‚å»¶è¿Ÿ <strong>dispatch</strong>ï¼Œè¿™ç”¨<code>å»¶è¿Ÿç”¨å‡½æ•°</code>å°±å¯ä»¥åšåˆ°äº†:</p><pre><code class="js">// next æ˜¯ç”¨ä¸­é—´ä»¶å¢å¼ºä¹‹åçš„ dispatch// dispatch æ˜¯æœ€åŸå§‹çš„ store.dispatchconst thunkMiddleware = ({ dispatch }) =&gt; next =&gt; action =&gt; {  if (typeof action === &#39;function&#39;) {    // å‡½æ•°å½¢å¼çš„ action å°±æŠŠ dispatch ç»™è¿™ä¸ª actionï¼Œè®© action å†³å®šä»€ä¹ˆæ—¶å€™ dispatch ï¼ˆæ§åˆ¶åè½¬ï¼‰    return action(dispatch);  }  // æ™®é€šçš„ action å°±ç›´æ¥ä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å¤„ç†  return next(action);}</code></pre><p>ç„¶åæˆ‘ä»¬å°±éœ€è¦æŠŠåŸæ¥çš„é¡¾å®¢éœ€æ±‚æ”¹ä¸€ä¸‹äº†ï¼š</p><pre><code class="js">// ä¹°æ°´æœ - è¿›å£è‹¹æœfunction buyImportedApple(num) {  // è¿”å›ä¸€ä¸ªå‡½æ•°ç±»å‹çš„ actionï¼Œè¿™ä¸ªå‡½æ•°æ¥å— dispatchï¼Œå¯ä»¥å†³å®šä»€ä¹ˆæ—¶å€™ dispatch  return dispatch =&gt; API.fetchImportedApple(() =&gt; dispatch({    type: &#39;BUY_IMPORTED_APPLE&#39;,    payload: num  }));}// ä¹°ç”Ÿé²œ - è¿›å£é¸¡è›‹function buyImportedEgg(num) {  return dispatch =&gt; API.fetchImportedEgg(() =&gt; dispatch({    type: &#39;BUY_IMPORTED_EGG&#39;,    payload: num  }));}</code></pre><p>ç„¶å<code>é‡‡è´­å‘˜</code>å°±å¯ä»¥åªè´Ÿè´£é‡‡è´­äº†ï¼Œæ”¹å›å»ï¼š</p><pre><code class="js">// é‡‡è´­å•†å“ç”Ÿæˆå™¨ï¼Œä¸åŒçš„å•†å“éœ€è¦ä¸åŒçš„æ—¶é—´é‡‡è´­function fetching(time, callback) {  // ç”¨å»¶æ—¶æ¨¡æ‹Ÿé‡‡è´­æ—¶é—´  const timer = setTimeout(() =&gt; {    clearTimeout(timer);    // é‡‡è´­å®Œæˆï¼Œé€šçŸ¥é”€å”®å‘˜    callback();  }, time);}// é‡‡è´­è¿›å£è‹¹æœéœ€è¦ 2 å¤©ï¼ˆ2sï¼‰function fetchImportedApple(callback) {  fetching(2000, callback);}// é‡‡è´­è¿›å£è‹¹æœéœ€è¦ 3 å¤©ï¼ˆ3sï¼‰function fetchImportedEgg(callback) {  fetching(3000, callback);}// é‡‡è´­å‘˜const API = {  fetchImportedApple, // é‡‡è´­è¿›å£è‹¹æœ  fetchImportedEgg // é‡‡è´­è¿›å£é¸¡è›‹}</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬åœ¨æ·»åŠ ä¸€ä¸ª<code>è®°å½•å‘˜</code>çš„ä¸­é—´ä»¶ï¼š</p><pre><code class="js">const loggerMiddleware = ({ getState }) =&gt; next =&gt; action =&gt; {  console.log(`state before: ${JSON.stringify(getState())}`);  console.log(`action: ${JSON.stringify(action)}`);  const result = next(action);  console.log(`state after: ${JSON.stringify(getState())}`);  console.log(&#39;================================================&#39;);  return result;}</code></pre><p>åˆ é™¤æ‰åŸæ¥çš„ç›‘å¬ï¼š</p><pre><code class="js">//- store.subscribe(() =&gt; console.log(JSON.stringify(store.getState())));</code></pre><p>å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡ redux çš„ <strong>applyMiddleware</strong> æ¥ä¸²è”èµ·è¿™äº›ä¸­é—´ä»¶å•¦ã€‚</p><pre><code class="js">const { createStore, combineReducers, applyMiddleware } = require(&#39;redux&#39;);// ä¸­é—´ä»¶çš„è°ƒç”¨é¡ºåºæ˜¯ä»å³åˆ°å·¦const store = createStore(reducer, applyMiddleware(thunkMiddleware, loggerMiddleware));</code></pre><p>å¥½äº†ï¼Œå¤§åŠŸå‘Šæˆï¼Œå¼€å§‹æœåŠ¡é¡¾å®¢ï¼š</p><pre><code class="js">store.dispatch(buyApple(3));store.dispatch(buyImportedApple(10));// state before: {&quot;fruit&quot;:{&quot;apple&quot;:0,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:0,&quot;importedEgg&quot;:0}}// action: {&quot;type&quot;:&quot;BUY_APPLE&quot;,&quot;payload&quot;:3}// state after: {&quot;fruit&quot;:{&quot;apple&quot;:3,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:0,&quot;importedEgg&quot;:0}}// ================================================// state before: {&quot;fruit&quot;:{&quot;apple&quot;:3,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:0,&quot;importedEgg&quot;:0}}// action: {&quot;type&quot;:&quot;BUY_EGG&quot;,&quot;payload&quot;:1}// state after: {&quot;fruit&quot;:{&quot;apple&quot;:3,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:1,&quot;importedEgg&quot;:0}}// ================================================</code></pre><p>ä¸Šé¢æˆ‘ä»¬å†™çš„ä¸¤ä¸ªä¸­é—´ä»¶å…¶å®å°±æ˜¯ <code>redux-thunk</code> å’Œ <code>redux-logger</code> çš„ç®€ç‰ˆã€‚åœ¨å®é™…ä¸­ï¼Œæ¨èä½¿ç”¨å®ƒä»¬ï¼Œä¼šæ›´å¯ä¿¡ã€‚</p><h3 id="å›¾è§£-1"><a href="#å›¾è§£-1" class="headerlink" title="å›¾è§£"></a>å›¾è§£</h3><p><img src="https://user-gold-cdn.xitu.io/2018/4/23/162f0a03fc97dbca?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="redux-chunk"></p><p>ç¼–å†™ redux ä¸­é—´ä»¶éœ€è¦æŒ‰ç…§è¦æ±‚æ¥ï¼Œè¿”å›è¿™æ ·çš„å‡½æ•°</p><pre><code class="js">// ä¸­é—´ä»¶æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢æœ‰åŸå§‹çš„ dispatchï¼Œå’Œ getState æ–¹æ³•ç”¨äºè·å– state// ä¸­é—´ä»¶å‡½æ•°è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª next å‚æ•°ï¼Œè¿™ä¸ª next æ˜¯ä¸‹ä¸€ä¸ªä¸­é—´ä»¶è¦åšçš„äº‹æƒ… action =&gt; { ... }function thunkMiddleware({ dispatch, getState }) {  return function(next) {    return function(action) {      // åšä½ çš„äº‹æƒ…    }  }}</code></pre><p><a href="https://juejin.im/user/57d8a928d203090069c13a21/likes" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Redux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>reduxå­¦ä¹ ä¹‹å¼€åº—å–æ°´æœ</title>
      <link href="/2018/04/25/React/Redux/redux%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%BC%80%E5%BA%97%E5%8D%96%E6%B0%B4%E6%9E%9C/"/>
      <url>/2018/04/25/React/Redux/redux%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%BC%80%E5%BA%97%E5%8D%96%E6%B0%B4%E6%9E%9C/</url>
      
        <content type="html"><![CDATA[<h1 id="Redux-æ˜¯ä»€ä¹ˆ"><a href="#Redux-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Redux æ˜¯ä»€ä¹ˆ"></a>Redux æ˜¯ä»€ä¹ˆ</h1><p>æ¯å½“æˆ‘ä»¬è°ˆåŠåˆ° <a href="https://github.com/reactjs/redux" target="_blank" rel="noopener">redux</a>ï¼Œå¤§å®¶éƒ½ä¼šè¯´æ˜¯ <a href="https://github.com/facebook/react" target="_blank" rel="noopener">react</a> çš„çŠ¶æ€ç®¡ç†å·¥å…·ã€‚è¿™ä¹ˆè¯´ç¡®å®æ²¡é”™ï¼Œæ¯•ç«Ÿ redux é¡¹ç›®ä¹Ÿæ˜¯ <code>React Community</code> ç»„ç»‡ä¸‹çš„ä¸€ä¸ªå­é¡¹ç›®ã€‚è€Œä¸” redux çš„è¯ç”Ÿä¹Ÿæ˜¯å’Œ react è¿™ä¸ª ui åº“æ€¥éœ€ä¸€ä¸ªçŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆæœ‰å¾ˆå¤§çš„è”ç³»ã€‚ä½†æ˜¯ redux å’Œ react å¹¶æ²¡æœ‰ä»»ä½•çš„è€¦åˆã€‚è™½ç„¶å®ƒä»¬ç»å¸¸ä¸€èµ·ç”¨ï¼Œä½†æ˜¯ <code>redux çš„ç”¨é€”å¹¶ä¸å±€é™äº react</code>ï¼Œæˆ–è€…è¯´ï¼Œå’Œ <code>react çš„ç»“åˆåªæ˜¯ redux çš„ä½¿ç”¨æ–¹å¼ä¹‹ä¸€</code>ã€‚</p><p>é‚£ä¹ˆæ’‡å¼€ react ä¸è°ˆï¼Œ redux åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ã€‚</p><p>åœ¨å®é™…çš„å¼€å‘å½“ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç¢°åˆ°è¿™æ ·çš„éœ€æ±‚ï¼šç›‘å¬ä¸€ä¸ªäº‹ä»¶ï¼Œå½“äº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸€äº›æƒ³åšçš„äº‹æƒ…ã€‚</p><h2 id="reduxåŸºç¡€ç”¨æ³•â€”å–æ°´æœ"><a href="#reduxåŸºç¡€ç”¨æ³•â€”å–æ°´æœ" class="headerlink" title="reduxåŸºç¡€ç”¨æ³•â€”å–æ°´æœ"></a>reduxåŸºç¡€ç”¨æ³•â€”å–æ°´æœ</h2><p>ä¸€å¤©ï¼Œç¨‹åºå‘˜é˜¿å¤§ï¼ˆåŒ–åï¼‰æƒ³è¦å»ä¹°æ°´æœåƒï¼Œå‘ç°å°åŒºå‘¨å›´å±…ç„¶æ²¡æœ‰æ°´æœåº—ï¼Œäºæ˜¯å°±æ‰“ç®—è‡ªå·±å¼€ä¸€ä¸ªæ°´æœåº—èµšç‚¹å°é’±ã€‚<br>é˜¿å¤§åˆ†æäº†ä¸€ä¸‹æ°´æœåº—çš„è¥ä¸šæ¨¡å¼ã€‚å…¶å®å°±æ˜¯<strong>å¤„ç†æ¯ä¸€ä½é¡¾å®¢çš„éœ€æ±‚</strong>ï¼Œç„¶åè®°è´¦çœ‹çœ‹æ¯å¤©çš„ç›ˆäºã€‚é‚£ä¹ˆæŠ½è±¡æˆç¨‹åºå°±æ˜¯<code>ç›‘å¬é¡¾å®¢çš„è¡Œä¸ºï¼Œå¹¶æŠŠæ¯ä¸ªè¡Œä¸ºçš„ç»“æœéƒ½è®°åœ¨è´¦ä¸Š</code>ï¼Œè¿™æ­£å¥½æ˜¯ <strong>redux</strong> æ‰€æ“…é•¿çš„ã€‚é˜¿å¤§èƒ¸æœ‰æˆç«¹ï¼Œè¯´ç€å°±å¼€å§‹å†™äº†èµ·æ¥ï¼š</p><h3 id="é¦–å…ˆæ¨¡æ‹Ÿé¡¾å®¢çš„è´­ä¹°è¡Œä¸ºï¼š"><a href="#é¦–å…ˆæ¨¡æ‹Ÿé¡¾å®¢çš„è´­ä¹°è¡Œä¸ºï¼š" class="headerlink" title="é¦–å…ˆæ¨¡æ‹Ÿé¡¾å®¢çš„è´­ä¹°è¡Œä¸ºï¼š"></a>é¦–å…ˆæ¨¡æ‹Ÿé¡¾å®¢çš„è´­ä¹°è¡Œä¸ºï¼š</h3><pre><code class="js">const action = {  type: &#39;BUY_APPLE&#39;, // ä¹°è‹¹æœ  payload: {    count: 2 // ä¹° 2 æ–¤  }}</code></pre><p>é‚£ä¸åŒçš„é¡¾å®¢è¦çš„æ–¤æ•°å¯èƒ½ä¸åŒï¼Œäºæ˜¯ä»–å†™äº†ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š</p><pre><code class="js">/** * åªè¦çŸ¥é“æ–¤æ•°å°±å¯ä»¥å¿«é€Ÿç”Ÿæˆé¡¾å®¢çš„å„ç§éœ€æ±‚ * @param {number} num é¡¾å®¢è¦ä¹°çš„æ–¤æ•° */function buyApple(num) {  return {    type: &#39;BUY_APPLE&#39;,    payload: {      count: num    }  }}</code></pre><p>ç„¶åæ˜¯è´¦æœ¬çš„ç»“æ„ï¼Œè®°å½•æ¯å¤©å–äº†å¤šå°‘æ–¤ï¼š<br><a id="more"></a></p><pre><code class="js">// è¢«æ‰˜ç®¡çš„æ•°æ® state// è´¦æœ¬ï¼Œä»Šå¤©å·²å–çš„è‹¹æœï¼š0 æ–¤ï¼›ä¸ºäº†ç®€ä¾¿ï¼Œå°±åªä¸¾ä¸€ä¸ªä¾‹å­ï¼Œäº‹å®ä¸Šè¿˜æœ‰å¾ˆå¤šå…¶ä»–æ°´æœï¼Œå¤§å®¶è‡ªè¡Œè„‘è¡¥const state = { apple: 0 };</code></pre><p>å¥½äº†ï¼Œç°åœ¨é¡¾å®¢éœ€æ±‚ï¼Œè´¦æœ¬éƒ½æœ‰äº†ï¼Œé‚£è°æ¥è®°è´¦å‘¢ï¼Ÿæ‰€ä»¥é˜¿å¤§è¯·äº†ä¸€ä¸ª<code>æ”¶é“¶å‘˜</code>è´Ÿè´£è®°è´¦ï¼Œå¹¶å‘Šè¯‰ä»–è¿™ä¹ˆè®°è´¦ï¼š</p><pre><code class="js">/** * ç›‘å¬å‡½æ•° listener * æ”¶é“¶å‘˜åªè¦çŸ¥é“é¡¾å®¢çš„éœ€æ±‚å°±èƒ½æ­£ç¡®çš„æ“ä½œè´¦æœ¬ * @param {object} state è´¦æœ¬ * @param {object} action é¡¾å®¢çš„éœ€æ±‚ */function reducer(state, action) {  // æ³¨å†Œ â€˜ä¹°è‹¹æœâ€™ äº‹ä»¶  // å¦‚æœæœ‰äººä¹°äº†è‹¹æœï¼ŒåŠ ä¸Šé¡¾å®¢ä¹°çš„æ–¤æ•°ï¼Œæ›´æ–°è´¦æœ¬  if (action.type === &#39;BUY_APPLE&#39;) {    return Object.assign({}, state, {      apple: state.apple + action.payload.count    });  }  // æ²¡æ³¨å†Œçš„äº‹ä»¶ä¸ä½œå¤„ç†  // ä¹°å’±ä»¬åº—é‡Œæ²¡æœ‰çš„ä¸œè¥¿ï¼Œä¸æ›´æ–°è´¦æœ¬ï¼ŒåŸæ ·è¿”å›  return state;}</code></pre><p>å¥½ï¼Œä¸‡äº‹ä¿±å¤‡ï¼Œå¯ä»¥æ­£å¼çš„ç›‘å¬é¡¾å®¢çš„è´­ä¹°éœ€æ±‚å¹¶æ›´æ–°è´¦æœ¬äº†ï¼š</p><pre><code class="js">const {createStore} = require(&#39;redux&#39;);// åˆ›å»ºæ°´æœåº—éœ€è¦æ”¶é“¶å‘˜ï¼ˆç›‘å¬å‡½æ•° listenerï¼‰å’Œè´¦æœ¬ï¼ˆè¢«æ‰˜ç®¡çš„æ•°æ®ï¼‰const store = createStore(reducer, state);</code></pre><p>ä¸ä»…å¦‚æ­¤ï¼Œredux è¿˜æä¾›äº†ä¸€ä¸ªåŠŸèƒ½ï¼Œæ¯æœåŠ¡ä¸€ä¸ªé¡¾å®¢ï¼Œéƒ½å¯ä»¥é¢å¤–åšä¸€äº›äº‹æƒ…ï¼Œäºæ˜¯é˜¿å¤§å°±æƒ³çœ‹çœ‹æ¯ç¬”äº¤æ˜“ä¹‹åçš„è´¦æœ¬ï¼š</p><pre><code class="js">// store.getState() å¯ä»¥è·å–æœ€æ–°çš„ statestore.subscribe(() =&gt; console.log(JSON.stringify(store.getState())));</code></pre><p>å¥½äº†ï¼Œé¡¾å®¢å¼€å§‹æ¥ä¹°æ°´æœäº†ï¼š</p><pre><code class="js">// è§¦å‘ç”¨æˆ·è´­ä¹°æ°´æœçš„äº‹ä»¶// é”€å”®å‘˜å¼€å§‹é”€å”®store.dispatch(buyApple(3)); // {&quot;apple&quot;:3}store.dispatch(buyApple(4)); // {&quot;apple&quot;:7}</code></pre><p>åº—é“ºç¨³å®šçš„è¿è¥äº†ä¸‹å»ï¼Œé˜¿å¤§å¿ƒé‡Œç¾æ»‹æ»‹~</p><h3 id="è®²è§£"><a href="#è®²è§£" class="headerlink" title="è®²è§£"></a>è®²è§£</h3><p>ä¸è¿‡åœ¨æ­¤ä¹‹å‰è¦å…ˆè¯´ redux ç‰¹åˆ«è®²ç©¶ä¹Ÿæ˜¯ç‰¹åˆ«é‡è¦çš„ 3 ç‚¹ï¼š</p><ul><li>åªèƒ½æœ‰å”¯ä¸€çš„ store å¯¹è±¡ä¿å­˜æ•´ä¸ªåº”ç”¨çš„ state</li><li>state æ˜¯åªè¯»çš„ï¼Œåªèƒ½é€šè¿‡ dispatch(action) çš„æ–¹å¼æ¥æ”¹å˜ state</li><li>reducer å¿…é¡»æ˜¯çº¯å‡½æ•°</li></ul><h4 id="action"><a href="#action" class="headerlink" title="action"></a>action</h4><p>action æ˜¯è¡Œä¸ºä¿¡æ¯çš„æŠ½è±¡ï¼Œå¯¹è±¡ç±»å‹ï¼Œå®ƒæè¿°å‘ç”Ÿäº†ä»€ä¹ˆã€‚è¿™ä¸ªå¯¹è±¡å¿…é¡»æœ‰ä¸€ä¸ª type å±æ€§ï¼Œå¯¹äºå¯¹è±¡é‡Œé¢çš„å…¶ä»–å†…å®¹ï¼Œredux ä¸åšé™åˆ¶ã€‚ä½†æ˜¯æ¨èç¬¦åˆ Flux Standard Action è§„èŒƒï¼š</p><pre><code class="js">{  type: &#39;ACTION_TYPE&#39;,  payload, // action æºå¸¦çš„æ•°æ®}</code></pre><h4 id="action-creator"><a href="#action-creator" class="headerlink" title="action creator"></a>action creator</h4><p>action creator é¡¾åæ€ä¹‰å°±æ˜¯ç”¨æ¥åˆ›å»º action çš„ï¼Œaction creator åªç®€å•çš„è¿”å› actionã€‚</p><pre><code class="js">function createAction(num) {  return {    type: &#39;ACTION_TYPE&#39;,    payload,  }}</code></pre><h4 id="state"><a href="#state" class="headerlink" title="state"></a>state</h4><p>state æ˜¯è¢«æ‰˜ç®¡çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡è§¦å‘ç›‘å¬äº‹ä»¶ï¼Œæˆ‘ä»¬è¦æ“ä½œçš„æ•°æ®ã€‚</p><h4 id="reducer"><a href="#reducer" class="headerlink" title="reducer"></a>reducer</h4><p>reducer æ˜¯ç”¨æ¥æ§åˆ¶ state æ”¹å˜çš„å‡½æ•°ã€‚action æè¿°äº†å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä½†æ˜¯å¹¶ä¸ä¼šçŸ¥é“ç›¸åº”çš„ state è¯¥æ€ä¹ˆæ”¹å˜ã€‚å¯¹äºä¸åŒçš„ actionï¼Œç›¸åº”çš„ state å˜åŒ–æ˜¯ç”¨ reducer æ¥æè¿°çš„ã€‚</p><p>reducer æ¥å—ä¸¤ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ <code>state</code>ï¼Œç¬¬äºŒä¸ªæ˜¯ <code>action</code>ï¼Œå¹¶è¿”å›è®¡ç®—ä¹‹åæ–°çš„ stateã€‚reducer å¿…é¡»æ˜¯ä¸€ä¸ª<strong>çº¯å‡½æ•°</strong>ï¼Œå¯¹äºç›¸åŒçš„è¾“å…¥ state å’Œ actionï¼Œä¸€å®šä¼šè¿”å›ç›¸åŒçš„æ–°çš„ stateã€‚</p><pre><code class="js">nextState = reducer(prevState, action);</code></pre><p>å› ä¸º reducer æ˜¯çº¯å‡½æ•°ï¼Œæ‰€ä»¥åŸæ¥çš„ <strong>prevState</strong> å¹¶ä¸ä¼šæ”¹å˜ï¼Œæ–°çš„ <strong>nextState</strong> æ˜¯ä¸€ä¸ªæœ€æ–°çš„å¿«ç…§ã€‚</p><h4 id="store"><a href="#store" class="headerlink" title="store"></a>store</h4><p>store æ˜¯æŠŠä¸Šé¢ä¸‰ä¸ªå…ƒç´ åˆèµ·æ¥çš„ä¸€ä¸ªå¤§å¯¹è±¡:</p><pre><code class="js">{  createStore,  combineReducers,  bindActionCreators,  applyMiddleware,  compose,  __DO_NOT_USE__ActionTypes}</code></pre><blockquote><p>å®ƒè´Ÿè´£ï¼š</p><ul><li>æ‰˜ç®¡åº”ç”¨çš„ state</li><li>å…è®¸é€šè¿‡ store.getState() æ–¹æ³•è®¿é—®åˆ°æ‰˜ç®¡çš„ state</li><li>å…è®¸é€šè¿‡ store.dispatch() æ–¹æ³•æ¥è§¦å‘ action æ›´æ–° state</li><li>å…è®¸é€šè¿‡ store.subscribe() æ³¨å†Œç›‘å¬å‡½æ•°ç›‘å¬æ¯ä¸€æ¬¡çš„ action è§¦å‘</li><li>å…è®¸æ³¨é”€é€šè¿‡ store.subscribe() æ–¹æ³•æ³¨å†Œçš„ç›‘å¬å‡½æ•°</li></ul></blockquote><pre><code class="js">// æ³¨å†Œconst unsubscribe = store.subscribe(() =&gt; { /** do something */});// æ³¨é”€unsubscribe();</code></pre><p><img src="https://user-gold-cdn.xitu.io/2018/4/18/162d7d65eb48257f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="å›¾è§£"></p><h2 id="reduceræ‹†åˆ†"><a href="#reduceræ‹†åˆ†" class="headerlink" title="reduceræ‹†åˆ†"></a>reduceræ‹†åˆ†</h2><p>è°çŸ¥é“æ°´æœåº—ç”Ÿæ„è¶Šæ¥è¶Šå¥½ï¼Œäºæ˜¯é˜¿å¤§å¼€å§‹æ‹“å±•ä¸šåŠ¡ï¼Œä¸ä»…å–æ°´æœï¼Œè¿˜å–èµ·äº†ç”Ÿé²œï¼Œäºæ˜¯æœ‰äº†æ°´æœéƒ¨å’Œç”Ÿé²œéƒ¨ã€‚</p><p>äºæ˜¯é˜¿å¤§æƒ³äº†æƒ³æœªæ¥è´­ä¹°ç”Ÿé²œçš„é¡¾å®¢çš„è¡Œä¸ºï¼š</p><pre><code class="js">// ä¹°ç”Ÿé²œ - é¸¡è›‹function buyEgg(num) {  return {    type: &#39;BUY_EGG&#39;,    payload: {      count: num    }  }}</code></pre><p>åˆ†äº†ä¸åŒçš„éƒ¨é—¨ä¹‹åï¼Œä¸åŒçš„ä¸šåŠ¡æœ‰ä¸åŒçš„è®°è´¦æ–¹å¼ï¼Œå¾—åˆ†è´¦è®°äº†ï¼Œå¼€æ¥è¦å¢åŠ ä¸€ä¸ªç”Ÿé²œçš„è®°è´¦æœ¬ï¼š</p><pre><code class="js">const freshState = {  egg: 0};</code></pre><p>åŸæ¥çš„æ°´æœè´¦æœ¬ä¹Ÿè¦æ”¹ä¸ªåå­—ï¼š</p><pre><code class="js">//- const state = {+ const fruitsState = {    apple: 0  };</code></pre><p>ç„¶åå¢åŠ ç”Ÿé²œéƒ¨çš„æ”¶é“¶å‘˜, ç®¡ç†ç”Ÿé²œè´¦æœ¬ <code>freshState</code>ï¼š</p><pre><code class="js">// ç”Ÿé²œéƒ¨æ”¶é“¶å‘˜function freshReducer(state = freshState, action) {  if (action.type === &#39;BUY_EGG&#39;) {    return Object.assign({}, state, {      egg: state.egg + action.payload.count    });  }  return state;}</code></pre><p>ç„¶ååŸæ¥æ°´æœéƒ¨çš„æ”¶é“¶å‘˜ç®¡ç†æ°´æœè´¦æœ¬ fruitsState éœ€è¦ä¿®æ”¹ä¸‹ï¼š</p><pre><code class="js">// æ°´æœéƒ¨æ”¶é“¶å‘˜//- function reducer(state, action) {+ function fruitReducer(state = fruitState, action) {   if (action.type === &#39;BUY_APPLE&#39;) {     return Object.assign({}, state, {       apple: state.apple + action.payload.count     });   }   return state; }</code></pre><p>ä½†æ˜¯é˜¿å¤§å¹¶ä¸æƒ³çœ‹å„ä¸ªéƒ¨é—¨çš„åˆ†è´¦æœ¬ï¼Œä»–åªæƒ³çœ‹ä¸€ä¸ªæ€»è´¦æœ¬å°±å¥½äº†ã€‚åˆšå¥½ redux æä¾›äº† <strong>combineReducers</strong> åŠŸèƒ½ï¼Œå¯ä»¥æŠŠå„ä¸ªæ”¶é“¶å‘˜ç®¡ç†çš„è´¦æœ¬åˆèµ·æ¥ï¼š</p><pre><code class="js">//- const { createStore } = require(&#39;redux&#39;);+ const { createStore, combineReducers } = require(&#39;redux&#39;);// æ€»è´¦æœ¬+ const state = {+   fruits: fruitsReducer,+   fresh: freshReducer+ };// æ€»æ”¶é“¶å‘˜+ const reducer = combineReducers(state);// åˆ›å»ºæ–°çš„æ°´æœç”Ÿé²œåº—//- const store = createStore(reducer, state);+ const store = createStore(reducer);</code></pre><p>è¿™æ ·ï¼Œæ°´æœç”Ÿé²œåº—å°±å¯ä»¥è¥ä¸šäº†ï¼Œé”€å”®å‘˜åˆå¼€å§‹å¤„ç†é¡¾å®¢çš„è´­ç‰©éœ€æ±‚äº†ï¼š</p><pre><code class="js">store.dispatch(buyApple(3)); // {&quot;fruit&quot;:{&quot;apple&quot;:3},&quot;fresh&quot;:{&quot;egg&quot;:0}}store.dispatch(buyEgg(1)); // {&quot;fruit&quot;:{&quot;apple&quot;:3},&quot;fresh&quot;:{&quot;egg&quot;:1}}store.dispatch(buyApple(4)); // {&quot;fruit&quot;:{&quot;apple&quot;:7},&quot;fresh&quot;:{&quot;egg&quot;:1}}store.dispatch(buyEgg(8)); // {&quot;fruit&quot;:{&quot;apple&quot;:7},&quot;fresh&quot;:{&quot;egg&quot;:9}}// ...</code></pre><h3 id="å›¾è§£ï¼š"><a href="#å›¾è§£ï¼š" class="headerlink" title="å›¾è§£ï¼š"></a>å›¾è§£ï¼š</h3><p><img src="https://user-gold-cdn.xitu.io/2018/4/18/162d7f51769b18c2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="reducer"></p><h4 id="combineReducers"><a href="#combineReducers" class="headerlink" title="combineReducers"></a>combineReducers</h4><p>å½“ä¸šåŠ¡åœºæ™¯è¶Šæ¥è¶Šå¤æ‚çš„æ—¶å€™ï¼Œstate çš„ç»“æ„ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šå¤æ‚è€Œä¸”åºå¤§ã€‚å¦‚æœåªç”¨ä¸€ä¸ª reducer æ¥è®¡ç®— state çš„å˜åŒ–åŠ¿å¿…ä¼šç‰¹åˆ«éº»çƒ¦ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥æŠŠ state é‡Œç‹¬ç«‹çš„æ•°æ®åˆ†ç¦»å‡ºæ¥ï¼Œå•ç‹¬ç”¨ä¸€ä¸ª reducer æ¥è®¡ç®—ï¼Œç„¶åå†é€šè¿‡ <strong>combineReducers</strong> æ–¹æ³•åˆå…¥åˆ° state ä¸­ã€‚<br>combineReducers æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯æœ€ç»ˆçš„ state</p><pre><code class="js">const reducer = combineReducers({  fruits: fruitsReducer,  fresh: freshReducer});</code></pre><h2 id="å¤„ç†-async-action"><a href="#å¤„ç†-async-action" class="headerlink" title="å¤„ç† async action"></a>å¤„ç† async action</h2><p>é˜¿å¤§é€šè¿‡ redux çš„ bindReducers æ–¹æ³•å°†æ°´æœåº—çš„ä¸šåŠ¡åˆ†æ²»æˆåŠŸï¼Œåº—é“ºä¹Ÿè¶Šåšè¶Šå¤§ã€‚ä»¥è‡³äºæœ‰é¡¾å®¢å¼€å§‹æƒ³è¦ä¹°ä¸€äº›è¿›å£çš„æ°´æœç”Ÿé²œã€‚</p><p>é˜¿å¤§è€ƒè™‘äº†ä¸€ä¸‹ï¼Œå†³å®šç»§ç»­æ‹“å±•è¿™ä¸ªåº—é“ºï¼Œä»äº‹è¿›å£å•†å“çš„é”€å”®ã€‚é¦–å…ˆæ˜¯é¡¾å®¢çš„éœ€æ±‚è¡Œä¸ºéœ€è¦è´­ä¹°è¿›å£æ°´æœç”Ÿé²œï¼š</p><pre><code class="js">// ä¹°æ°´æœ - è¿›å£è‹¹æœ+ function buyImportedApple(num) {+   return {+     type: &#39;BUY_IMPORTED_APPLE&#39;,+     payload: {+       num+     }+   }+ }// ä¹°ç”Ÿé²œ - è¿›å£é¸¡è›‹+ function buyImportedEgg(num) {+   return  {+     type: &#39;BUY_IMPORTED_EGG&#39;,+     payload: {+       num+     }+   }+ }</code></pre><p>ç„¶åæ°´æœéƒ¨å’Œç”Ÿé²œéƒ¨çš„è´¦æœ¬ä¹Ÿè¦æ›´æ–°å•¦ï¼š</p><pre><code class="js">// æ°´æœè´¦æœ¬ const fruitState = {   orange: 0,   apple: 0,   banana: 0,+  importedApple: 0 }; // ç”Ÿé²œè´¦æœ¬ const freshState = {   egg: 0,   fish: 0,   vegetable: 0,+  importedEgg: 0 };</code></pre><p>åŒæ ·çš„ï¼Œç›¸åº”éƒ¨é—¨çš„æ”¶é“¶å‘˜ä»¬ä¹Ÿè¦å­¦ä¼šæ€ä¹ˆå¤„ç†è¿›å£æ°´æœç”Ÿé²œçš„è®°è´¦ï¼Œä»–ä»¬çš„è®°è´¦æ–¹å¼è¦æ”¹æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code class="js">// æ°´æœéƒ¨æ”¶é“¶å‘˜function fruitReducer(state = fruitState, action) {  // å¦‚æœæœ‰äººä¹°äº†ç›¸åº”çš„æ°´æœï¼Œæ›´æ–°è´¦æœ¬  switch (action.type) {    case &#39;BUY_APPLE&#39;:      return Object.assign({}, state, {        apple: state.apple + action.payload.count      });    case &#39;BUY_IMPORTED_APPLE&#39;:      return Object.assign({}, state, {        importedApple: state.importedApple + action.payload.count      });    // ä¹°å…¶ä»–çš„ä¸œè¥¿ï¼Œä¸æ›´æ–°è´¦æœ¬ï¼ŒåŸæ ·è¿”å›    default: return state;  } ;}// ç”Ÿé²œéƒ¨æ”¶é“¶å‘˜function freshReducer(state = freshState, action) {  switch (action.type) {    case &#39;BUY_EGG&#39;:      return Object.assign({}, state, {        egg: state.egg + action.payload.count      });    case &#39;BUY_IMPORTED_EGG&#39;:      return Object.assign({}, state, {        importedEgg: state.importedEgg + action.payload.count      });    default: return state;  } ;}</code></pre><p>å¯æ˜¯è¿™æ—¶å€™é˜¿å¤§å‘ç°ï¼Œè¿›å£æ°´æœç”Ÿé²œä¸èƒ½å¤§é‡å­˜åœ¨è‡ªå·±ä»“åº“å–ï¼Œå› ä¸ºå®ƒä»¬åˆè´µåˆå®¹æ˜“åï¼Œåªæœ‰å½“é¡¾å®¢éœ€è¦ä¹°çš„æ—¶å€™ï¼Œæ‰èƒ½å»é‡‡è´­è¿™äº›æ°´æœç”Ÿé²œï¼Œäºæ˜¯é˜¿å¤§åˆé›‡äº†ä¸€ä¸ª<strong>é‡‡è´­å‘˜</strong>ä¸“é—¨è´Ÿè´£å¤„ç†è¦ä¹°è¿›å£æ°´æœå’Œç”Ÿé²œçš„é¡¾å®¢ï¼Œç­‰åˆ°è´§äº†å†é€šçŸ¥é”€å”®å‘˜å–è´§ç»™é¡¾å®¢ï¼š</p><pre><code class="js">// é‡‡è´­å•†å“ç”Ÿæˆå™¨ï¼Œä¸åŒçš„å•†å“éœ€è¦ä¸åŒçš„æ—¶é—´é‡‡è´­function fetchGoodsGenerator(time, action) {  // ç”¨å»¶æ—¶æ¨¡æ‹Ÿé‡‡è´­æ—¶é—´  const timer = setTimeout(() =&gt; {    clearTimeout(timer);    // é‡‡è´­å®Œæˆï¼Œé€šçŸ¥é”€å”®å‘˜    store.dispatch(action);  }, time);}// é‡‡è´­è¿›å£è‹¹æœéœ€è¦ 2 å¤©ï¼ˆ2sï¼‰function fetchImportedApple(action) {  fetchGoodsGenerator(2000, action);}// é‡‡è´­è¿›å£é¸¡è›‹éœ€è¦ 3 å¤©ï¼ˆ3sï¼‰function fetchImportedEgg(action) {  fetchGoodsGenerator(3000, action);}// é‡‡è´­å‘˜const API = {  fetchImportedApple, // é‡‡è´­è¿›å£è‹¹æœ  fetchImportedEgg // é‡‡è´­è¿›å£é¸¡è›‹}</code></pre><p>å¥½äº†ï¼Œå¸ƒç½®å®Œäº†ä¹‹åï¼Œé¡¾å®¢å¼€å§‹æ¥ä¹°æ°´æœç”Ÿé²œäº†ï¼š</p><pre><code class="js">// é”€å”®å‘˜å¼€å§‹é”€å”®ï¼Œé‡‡è´­å‘˜å¼€å§‹é‡‡è´­store.dispatch(buyApple(3));API.fetchImportedApple(buyImportedApple(10));store.dispatch(buyEgg(1));API.fetchImportedEgg(buyImportedEgg(10));store.dispatch(buyApple(4));API.fetchImportedApple(buyImportedApple(10));store.dispatch(buyEgg(8));API.fetchImportedEgg(buyImportedEgg(10));// {&quot;fruit&quot;:{&quot;apple&quot;:3,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:0,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:3,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:1,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:1,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:0},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:10},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:20},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:0}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:20},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:10}}// {&quot;fruit&quot;:{&quot;apple&quot;:7,&quot;importedApple&quot;:20},&quot;fresh&quot;:{&quot;egg&quot;:9,&quot;importedEgg&quot;:20}}</code></pre><h3 id="å›¾è§£"><a href="#å›¾è§£" class="headerlink" title="å›¾è§£"></a>å›¾è§£</h3><p><img src="https://user-gold-cdn.xitu.io/2018/4/18/162d925e3fdc050d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="async action"></p><p>åœ¨å®é™…çš„å¼€å‘å½“ä¸­æˆ‘ä»¬ç»å¸¸ä¼šè°ƒç”¨ä¸€äº› API æ¥å£è·å–æ•°æ®æ›´æ–° stateã€‚åˆšå¼€å§‹ä½¿ç”¨ redux çš„ä¸€ä¸ªè¯¯åŒºå°±æ˜¯åœ¨ reducer é‡Œæ¥æ”¶åˆ°å¼‚æ­¥çš„ action ä¹‹åï¼Œå°±åœ¨ reducer é‡Œåšå¼‚æ­¥æ“ä½œï¼Œè°ƒç”¨ APIã€‚ä½†æ˜¯è¿™æ ·æ˜¯é”™è¯¯çš„ã€‚reducer åªèƒ½æ˜¯çº¯å‡½æ•°ï¼Œä¸èƒ½æœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚è¿™æ ·æ‰èƒ½ä¿è¯å¯¹äºç›¸åŒçš„è¾“å…¥ï¼Œä¸€å®šä¼šæœ‰ç›¸åŒçš„è¾“å‡ºã€‚</p><p><a href="https://juejin.im/user/57d8a928d203090069c13a21/likes" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Redux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç‰‡æ‡’åŠ è½½è¸©å‘</title>
      <link href="/2018/04/24/%E6%80%A7%E8%83%BD/%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD%E8%B8%A9%E5%9D%91/"/>
      <url>/2018/04/24/%E6%80%A7%E8%83%BD/%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD%E8%B8%A9%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>å¯¹ç½‘é¡µåŠ è½½é€Ÿåº¦å½±å“æœ€å¤§çš„å°±æ˜¯å›¾ç‰‡ï¼Œä¸€å¼ æ™®é€šçš„å›¾ç‰‡å¯èƒ½ä¼šæœ‰å¥½å‡  M çš„å¤§å°ï¼Œå½“å›¾ç‰‡å¾ˆå¤šæ—¶ï¼Œç½‘é¡µçš„åŠ è½½é€Ÿåº¦å˜å¾—å¾ˆç¼“æ…¢ã€‚<br>ä¸ºäº†ä¼˜åŒ–ç½‘é¡µæ€§èƒ½ä»¥åŠç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬å¯¹å›¾ç‰‡è¿›è¡Œæ‡’åŠ è½½ã€‚</p><hr><p>æ‡’åŠ è½½æ˜¯ä¸€ç§å¯¹ç½‘é¡µæ€§èƒ½ä¼˜åŒ–çš„æ–¹å¼ï¼Œå®ƒçš„åŸç†æ˜¯ä¼˜å…ˆåŠ è½½åœ¨å¯è§†åŒºåŸŸå†…çš„å›¾ç‰‡ï¼Œè€Œä¸ä¸€æ¬¡æ€§åŠ è½½æ‰€ä»¥å›¾ç‰‡ã€‚å½“æµè§ˆå™¨æ»šåŠ¨ï¼Œå›¾ç‰‡è¿›å…¥å¯è§†åŒºæ—¶å†å»åŠ è½½å›¾ç‰‡ã€‚é€šè¿‡è®¾ç½®å›¾ç‰‡çš„ src å±æ€§æ¥è®©æµè§ˆå™¨å‘èµ·å›¾ç‰‡çš„è¯·æ±‚ã€‚å½“è¿™ä¸ªå±æ€§ä¸ºç©ºæˆ–è€…æ²¡æœ‰æ—¶ï¼Œå°±ä¸ä¼šå‘é€è¯·æ±‚ã€‚</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><blockquote><p>æ‡’åŠ è½½çš„å®ç°ä¸»è¦æ˜¯åˆ¤æ–­å½“å‰å›¾ç‰‡æ˜¯å¦åˆ°äº†å¯è§†åŒºåŸŸè¿™ä¸€æ ¸å¿ƒé€»è¾‘ã€‚æˆ‘ä»¬å…ˆæ¥æ•´ç†ä¸€ä¸‹å®ç°æ€è·¯ï¼š<br>1.æ‹¿åˆ°æ‰€æœ‰çš„å›¾ç‰‡ img dom ã€‚<br>2.éå†æ¯ä¸ªå›¾ç‰‡åˆ¤æ–­å½“å‰å›¾ç‰‡æ˜¯å¦åˆ°äº†å¯è§†åŒºèŒƒå›´å†…ã€‚<br>3.å¦‚æœåˆ°äº†å°±è®¾ç½®å›¾ç‰‡çš„ src å±æ€§ã€‚<br>4.ç»‘å®š window çš„ scroll äº‹ä»¶ï¼Œå¯¹å…¶è¿›è¡Œäº‹ä»¶ç›‘å¬ã€‚</p></blockquote><a id="more"></a><h3 id="HTML-ç»“æ„"><a href="#HTML-ç»“æ„" class="headerlink" title="HTML ç»“æ„"></a>HTML ç»“æ„</h3><pre><code class="html">&lt;div class=&quot;container&quot;&gt;    &lt;div class=&quot;img-area&quot;&gt;        &lt;img id=&quot;first&quot; data-src=&quot;./img/ceng.png&quot; alt=&quot;&quot;&gt;    &lt;/div&gt;    &lt;div class=&quot;img-area&quot;&gt;        &lt;img data-src=&quot;./img/data.png&quot; alt=&quot;&quot;&gt;    &lt;/div&gt;    &lt;div class=&quot;img-area&quot;&gt;        &lt;img data-src=&quot;./img/huaji.png&quot; alt=&quot;&quot;&gt;    &lt;/div&gt;    &lt;div class=&quot;img-area&quot;&gt;        &lt;img data-src=&quot;./img/liqi1.png&quot; alt=&quot;&quot;&gt;    &lt;/div&gt;    &lt;div class=&quot;img-area&quot;&gt;        &lt;img data-src=&quot;./img/liqi2.png&quot; alt=&quot;&quot;&gt;    &lt;/div&gt;    &lt;div class=&quot;img-area&quot;&gt;        &lt;img data-src=&quot;./img/steve-jobs.jpg&quot; alt=&quot;&quot;&gt;    &lt;/div&gt;&lt;/div&gt;</code></pre><p>æ­¤æ—¶ img æ ‡ç­¾æ˜¯æ²¡æœ‰ <code>src</code> å±æ€§çš„ï¼Œæˆ‘ä»¬æŠŠçœŸå®çš„å›¾ç‰‡åœ°å€æ”¾åœ¨ä¸€ä¸ªå±æ€§é‡Œï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ HTML5 çš„ data å±æ€§ï¼Œå°†çœŸå®åœ°å€æ”¾åœ¨è‡ªå®šä¹‰çš„ <code>data-src</code> ä¸­ã€‚</p><h3 id="åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›å…¥äº†å¯è§†åŒºåŸŸ"><a href="#åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›å…¥äº†å¯è§†åŒºåŸŸ" class="headerlink" title="åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›å…¥äº†å¯è§†åŒºåŸŸ"></a>åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›å…¥äº†å¯è§†åŒºåŸŸ</h3><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>ç¬¬ä¸€ç§æ–¹æ³•æˆ‘ä»¬é€šè¿‡è®¡ç®—è¯¥å›¾ç‰‡è·ç¦» document é¡¶éƒ¨çš„é«˜åº¦æ˜¯å¦å°äºå½“å‰å¯è§†åŒºåŸŸç›¸å¯¹äº document é¡¶éƒ¨é«˜åº¦æ¥åˆ¤æ–­ã€‚</p><p>å¯è§†åŒºåŸŸç›¸å¯¹äº document é¡¶éƒ¨é«˜åº¦çš„è®¡ç®—æ–¹æ³•ï¼š</p><pre><code class="js">const clientHeight = document.documentElement.clientHeight; // è§†å£é«˜åº¦ï¼Œä¹Ÿå°±æ˜¯çª—å£çš„é«˜åº¦ã€‚const scrollHeight = document.documentElement.scrollTop + clientHeight; // æ»šåŠ¨æ¡åç§»æ–‡æ¡£é¡¶éƒ¨çš„é«˜åº¦ï¼ˆä¹Ÿå°±æ˜¯æ–‡æ¡£ä»é¡¶éƒ¨å¼€å§‹åˆ°å¯è§†åŒºåŸŸè¢«æŠ¹å»çš„é«˜åº¦ï¼‰ + è§†å£é«˜åº¦</code></pre><p>ç”»äº†ä¸€å¼ å›¾æ–¹ä¾¿ç†è§£:<br><img src="https://user-gold-cdn.xitu.io/2018/4/23/162f0988f351ecca?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="dataimg"></p><p>ç„¶åå°±æ˜¯è®¡ç®—è¯¥å›¾ç‰‡è·ç¦»æ–‡æ¡£é¡¶éƒ¨çš„é«˜åº¦ã€‚æœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡å…ƒç´ çš„ <code>offsetTop</code> å±æ€§æ¥è®¡ç®—ã€‚ä»ä¸Šå›¾æˆ‘ä»¬äº†è§£åˆ°å…ƒç´ çš„ offsetTop å±æ€§æ˜¯ç›¸å¯¹äºä¸€ä¸ª position ä¸º é static çš„ç¥–å…ˆå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯ <code>child.offsetParent</code> ã€‚åŒæ—¶éœ€è¦å°†ç¥–å…ˆå…ƒç´ çš„ border è€ƒè™‘åœ¨å†…ï¼Œæˆ‘ä»¬é€šè¿‡<code>child.offsetParent.clientTop</code>å¯ä»¥æ‹¿åˆ°è¾¹æ¡†åšåº¦ã€‚</p><p>ç”±æ­¤æˆ‘ä»¬å¾—åˆ°å…ƒç´ è·ç¦»æ–‡æ¡£é¡¶éƒ¨çš„é«˜åº¦çš„è®¡ç®—æ–¹æ³•ï¼š</p><pre><code class="js">function getTop(el, initVal) {    let top = el.offsetTop + initVal;    if (el.offsetParent !== null) {        top += el.offsetParent.clientTop;        return getTop(el.offsetParent, top);    } else {        return top;    }}</code></pre><p>è¿™é‡Œçš„è¿™ä¸ªæ–¹æ³•ä½¿ç”¨äº† <code>å°¾é€’å½’è°ƒç”¨</code> ã€‚å¯ä»¥æé«˜é€’å½’æ€§èƒ½ã€‚å½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥ç”¨å¾ªç¯æ¥å®ç°ï¼š</p><pre><code class="js">function getTop(el) {    let top = el.offsetTop;    var parent = el.offsetParent;    while(parent !== null) {        top += parent.offsetTop + parent.clientTop;        parent = parent.offsetParent;    }    return top;}</code></pre><p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨ <code>element.getBoundingClientRect() API</code> ç›´æ¥å¾—åˆ° top å€¼ã€‚</p><pre><code class="js">var first  = document.getElementById(&#39;first&#39;);getTop(first, 0);  // 130console.log(first.getBoundingClientRect().top); // 130</code></pre><p>äºæ˜¯æˆ‘ä»¬å¾—åˆ°åˆ¤æ–­æ–¹æ³•ï¼š</p><pre><code class="js">function inSight(el) {    const clientHeight = document.documentElement.clientHeight;    const scrollHeight = document.documentElement.scrollTop + clientHeight;    // æ–¹æ³•ä¸€    return getTop(el, 0) &lt; scrollHeight;    // æ–¹æ³•äºŒ    // return el.getBoundingClientRect().top &lt; clientHeight;}</code></pre><p>æ¥ä¸‹æ¥å°±æ˜¯å¯¹æ¯ä¸ªå›¾ç‰‡è¿›è¡Œåˆ¤æ–­å’Œèµ‹å€¼ã€‚</p><pre><code class="js">function loadImg(el) {    if (!el.src) {        el.src = el.dataset.src;    }}function checkImgs() {    const imgs = document.getElementsByTagName(&#39;img&#39;);    Array.from(imgs).forEach(el =&gt; {        if (inSight(el)) {            loadImg(el);        }    })    console.log(count++);}</code></pre><p>æœ€åç»™ window ç»‘å®š onscroll äº‹ä»¶ä»¥åŠ onload äº‹ä»¶ï¼š</p><pre><code class="js">window.addEventListener(&#39;scroll&#39;, checkImgs, false);window.onload = checkImgs;</code></pre><p>æˆ‘ä»¬çŸ¥é“ç±»ä¼¼ scroll æˆ– resize è¿™æ ·çš„äº‹ä»¶æµè§ˆå™¨å¯èƒ½åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è§¦å‘å¾ˆå¤šæ¬¡ï¼Œä¸ºäº†æé«˜ç½‘é¡µæ€§èƒ½ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª<strong>èŠ‚æµå‡½æ•°</strong>æ¥æ§åˆ¶å‡½æ•°çš„å¤šæ¬¡è§¦å‘ï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…ï¼ˆå¦‚ 500msï¼‰åªæ‰§è¡Œä¸€æ¬¡å›è°ƒã€‚</p><pre><code class="js">/** * æŒç»­è§¦å‘äº‹ä»¶ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œåªæ‰§è¡Œä¸€æ¬¡äº‹ä»¶ã€‚ * @param fun è¦æ‰§è¡Œçš„å‡½æ•° * @param delay å»¶è¿Ÿæ—¶é—´ * @param time åœ¨ time æ—¶é—´å†…å¿…é¡»æ‰§è¡Œä¸€æ¬¡ */function throttle(fun, delay, time) {    var timeout;    var previous = +new Date();    return function () {        var now = +new Date();        var context = this;        var args = arguments;        clearTimeout(timeout);        if (now - previous &gt;= time) {            fun.apply(context, args);            previous = now;        } else {            timeout = setTimeout(function () {                fun.apply(context, args);            }, delay);        }    }}window.addEventListener(&#39;scroll&#39;, throttle(checkImgs, 200, 1000), false);</code></pre><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>HTML5 æœ‰ä¸€ä¸ªæ–°çš„ IntersectionObserver APIï¼Œå®ƒå¯ä»¥è‡ªåŠ¨è§‚å¯Ÿå…ƒç´ æ˜¯å¦å¯è§ã€‚</p><p>ä¸»è¦ç”¨æ³•ï¼š</p><pre><code class="js">var observer = new IntersectionObserver(callback, option);// å¼€å§‹è§‚å¯Ÿobserver.observe(document.getElementById(&#39;first&#39;));// åœæ­¢è§‚å¯Ÿobserver.unobserve(document.getElementById(&#39;first&#39;));// å…³é—­è§‚å¯Ÿå™¨observer.disconnect();</code></pre><p>ç›®æ ‡çš„å¯è§æ€§å‘ç”Ÿå˜åŒ–æ—¶å°±ä¼šè°ƒç”¨è§‚å¯Ÿå™¨çš„ callbackã€‚</p><pre><code class="js">function callback(changes: IntersectionObserverEntry[]) {    console.log(changes[0])}// IntersectionObserverEntry{    time: 29.499999713152647,    intersectionRatio: 1,    boundingClientRect: DOMRectReadOnly {        bottom: 144,        height: 4,        left: 289,        right: 293,        top: 140,        width: 4,        x: 289,        y: 140    },    intersectionRect: DOMRectReadOnly,    isIntersecting: true,    rootBounds: DOMRectReadOnly,    target: img#first}</code></pre><blockquote><p>è¯¦ç»†é‡Šä¹‰ï¼š<br>timeï¼š å¯è§æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶é—´ï¼Œæ˜¯ä¸€ä¸ªé«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œå•ä½ä¸ºæ¯«ç§’<br>intersectionRatioï¼š ç›®æ ‡å…ƒç´ çš„å¯è§æ¯”ä¾‹ï¼Œå³ intersectionRect å  boundingClientRect çš„æ¯”ä¾‹ï¼Œå®Œå…¨å¯è§æ—¶ä¸º 1 ï¼Œå®Œå…¨ä¸å¯è§æ—¶å°äºç­‰äº 0<br>boundingClientRectï¼š ç›®æ ‡å…ƒç´ çš„çŸ©å½¢åŒºåŸŸçš„ä¿¡æ¯<br>intersectionRectï¼š ç›®æ ‡å…ƒç´ ä¸è§†å£ï¼ˆæˆ–æ ¹å…ƒç´ ï¼‰çš„äº¤å‰åŒºåŸŸçš„ä¿¡æ¯<br>rootBoundsï¼š æ ¹å…ƒç´ çš„çŸ©å½¢åŒºåŸŸçš„ä¿¡æ¯ï¼ŒgetBoundingClientRect() æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰æ ¹å…ƒç´ ï¼ˆå³ç›´æ¥ç›¸å¯¹äºè§†å£æ»šåŠ¨ï¼‰ï¼Œåˆ™è¿”å› null<br>isIntersectingï¼š æ˜¯å¦è¿›å…¥äº†è§†å£ï¼Œboolean å€¼<br>targetï¼š è¢«è§‚å¯Ÿçš„ç›®æ ‡å…ƒç´ ï¼Œæ˜¯ä¸€ä¸ª DOM èŠ‚ç‚¹å¯¹è±¡</p></blockquote><p>ä½¿ç”¨ IntersectionObserver å®ç°å›¾ç‰‡æ‡’åŠ è½½ï¼š</p><pre><code class="js">function query(tag) {    return Array.from(document.getElementsByTagName(tag));}var observer = new IntersectionObserver(    (changes) =&gt; {        changes.forEach((change) =&gt; {            if (change.intersectionRatio &gt; 0) {                var img = change.target;                img.src = img.dataset.src;                observer.unobserve(img);            }        })    })query(&#39;img&#39;).forEach((item) =&gt; {    observer.observe(item);})</code></pre><p><a href="https://juejin.im/post/5add55dd6fb9a07aad171f76?utm_source=gold_browser_extension" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ€§èƒ½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBå‰ç«¯å¼€å‘äººå‘˜é¡»çŸ¥çš„å¸¸è§æµè§ˆå™¨å…¼å®¹é—®é¢˜åŠè§£å†³æŠ€å·§</title>
      <link href="/2018/04/23/%E6%80%A7%E8%83%BD/WEB%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E9%A1%BB%E7%9F%A5%E7%9A%84%E5%B8%B8%E8%A7%81%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%8A%80%E5%B7%A7/"/>
      <url>/2018/04/23/%E6%80%A7%E8%83%BD/WEB%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E9%A1%BB%E7%9F%A5%E7%9A%84%E5%B8%B8%E8%A7%81%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸ºä»€ä¹ˆä¼šæœ‰å…¼å®¹é—®é¢˜ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šæœ‰å…¼å®¹é—®é¢˜ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šæœ‰å…¼å®¹é—®é¢˜ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šæœ‰å…¼å®¹é—®é¢˜ï¼Ÿ</h2><p>ç”±äºå¸‚åœºä¸Šæµè§ˆå™¨ç§ç±»ä¼—å¤šï¼Œè€Œä¸åŒæµè§ˆå™¨å…¶å†…æ ¸äº¦ä¸å°½ç›¸åŒï¼Œæ‰€ä»¥å„ä¸ªæµè§ˆå™¨å¯¹ç½‘é¡µçš„è§£æå°±æœ‰ä¸€å®šå‡ºå…¥ï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´æµè§ˆå™¨å…¼å®¹é—®é¢˜å‡ºç°çš„ä¸»è¦åŸå› ï¼Œæˆ‘ä»¬çš„ç½‘é¡µéœ€è¦åœ¨ä¸»æµæµè§ˆå™¨ä¸Šæ­£å¸¸è¿è¡Œï¼Œå°±éœ€è¦åšå¥½æµè§ˆå™¨å…¼å®¹ã€‚</p><p>ä½¿ç”¨Tridentå†…æ ¸çš„æµè§ˆå™¨ï¼šIEã€Maxthonã€TTï¼› ä½¿ç”¨Geckoå†…æ ¸çš„æµè§ˆå™¨ï¼šNetcape6åŠä»¥ä¸Šç‰ˆæœ¬ã€FireFoxï¼› ä½¿ç”¨Prestoå†…æ ¸çš„æµè§ˆå™¨ï¼šOpera7åŠä»¥ä¸Šç‰ˆæœ¬ï¼› ä½¿ç”¨Webkitå†…æ ¸çš„æµè§ˆå™¨ï¼šSafariã€Chromeã€‚</p><p>è€Œæˆ‘ç°åœ¨æ‰€è¯´çš„å…¼å®¹æ€§é—®é¢˜ï¼Œä¸»è¦æ˜¯è¯´IEä¸å‡ ä¸ªä¸»æµæµè§ˆå™¨å¦‚firefoxï¼Œgoogleç­‰ã€‚è€Œå¯¹IEæµè§ˆå™¨æ¥è¯´ï¼ŒIE7åˆæ˜¯ä¸ªè·¨åº¦ï¼Œå› ä¸ºä¹‹å‰çš„ç‰ˆæœ¬æ›´æ–°ç”šæ…¢ï¼Œbugç”šå¤šã€‚ä»IE8å¼€å§‹ï¼ŒIEæµè§ˆå™¨æ¸æ¸éµå¾ªæ ‡å‡†ï¼Œåˆ°IE9åç”±äºå¤§å®¶éƒ½ä¸€è‡´è®¤ä¸ºæ ‡å‡†å¾ˆé‡è¦ï¼Œå¯ä»¥è¯´åœ¨å…¼å®¹æ€§ä¸Šæ¯”è¾ƒå¥½äº†ï¼Œä½†æ˜¯åœ¨ä¸­å›½æ¥è¯´ï¼Œç”±äºxpçš„å æœ‰ç‡é—®é¢˜ï¼Œä½¿ç”¨IE7ä»¥ä¸‹çš„ç”¨æˆ·ä»ç„¶å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸è€ƒè™‘ä½ç‰ˆæœ¬æµè§ˆå™¨çš„å…¼å®¹ã€‚</p><p>å¯¹æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Œä¸€èˆ¬åˆ†ï¼ŒHTMLï¼ŒJavascriptå…¼å®¹ï¼ŒCSSå…¼å®¹ã€‚ å…¶ä¸­htmlç›¸å…³é—®é¢˜æ¯”è¾ƒå®¹æ˜“å¤„ç†ï¼Œæ— éæ˜¯é«˜ç‰ˆæœ¬æµè§ˆå™¨ç”¨äº†ä½ç‰ˆæœ¬æµè§ˆå™¨æ— æ³•è¯†åˆ«çš„å…ƒç´ ï¼Œå¯¼è‡´å…¶ä¸èƒ½è§£æï¼Œæ‰€ä»¥å¹³æ—¶æ³¨æ„ä¸€ç‚¹å°±æ˜¯ã€‚ç‰¹åˆ«æ˜¯HTML5å¢åŠ äº†è®¸å¤šæ–°æ ‡ç­¾ï¼Œä½ç‰ˆæœ¬æµè§ˆå™¨æœ‰ç‚¹å½±å“æ—¶ä»£è¿›æ­¥å•Š</p><h3 id="é—®é¢˜ä¸€ï¼šä¸åŒæµè§ˆå™¨çš„æ ‡ç­¾é»˜è®¤çš„å¤–è¾¹è·å’Œå†…è¾¹è·ä¸åŒ"><a href="#é—®é¢˜ä¸€ï¼šä¸åŒæµè§ˆå™¨çš„æ ‡ç­¾é»˜è®¤çš„å¤–è¾¹è·å’Œå†…è¾¹è·ä¸åŒ" class="headerlink" title="é—®é¢˜ä¸€ï¼šä¸åŒæµè§ˆå™¨çš„æ ‡ç­¾é»˜è®¤çš„å¤–è¾¹è·å’Œå†…è¾¹è·ä¸åŒ"></a>é—®é¢˜ä¸€ï¼šä¸åŒæµè§ˆå™¨çš„æ ‡ç­¾é»˜è®¤çš„å¤–è¾¹è·å’Œå†…è¾¹è·ä¸åŒ</h3><p>é—®é¢˜ç—‡çŠ¶ï¼šéšä¾¿å†™å‡ ä¸ªæ ‡ç­¾ï¼Œä¸åŠ æ ·å¼æ§åˆ¶çš„æƒ…å†µä¸‹ï¼Œå„è‡ªçš„margin å’Œpaddingå·®å¼‚è¾ƒå¤§ã€‚<br>ç¢°åˆ°é¢‘ç‡:100%<br>è§£å†³æ–¹æ¡ˆï¼šcssé‡Œ <em>{margin:0;padding:0;}<br>å¤‡æ³¨ï¼šè¿™ä¸ªæ˜¯æœ€å¸¸è§çš„ä¹Ÿæ˜¯æœ€æ˜“è§£å†³çš„ä¸€ä¸ªæµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼Œå‡ ä¹æ‰€æœ‰çš„cssæ–‡ä»¶å¼€å¤´éƒ½ä¼šç”¨é€šé…ç¬¦</em>æ¥è®¾ç½®å„ä¸ªæ ‡ç­¾çš„å†…å¤–è¡¥ä¸æ˜¯0ã€‚</p><h3 id="é—®é¢˜äºŒï¼šå—å±æ€§æ ‡ç­¾floatåï¼Œåˆæœ‰æ¨ªè¡Œçš„marginæƒ…å†µä¸‹ï¼Œåœ¨ie6æ˜¾ç¤ºmarginæ¯”è®¾ç½®çš„å¤§"><a href="#é—®é¢˜äºŒï¼šå—å±æ€§æ ‡ç­¾floatåï¼Œåˆæœ‰æ¨ªè¡Œçš„marginæƒ…å†µä¸‹ï¼Œåœ¨ie6æ˜¾ç¤ºmarginæ¯”è®¾ç½®çš„å¤§" class="headerlink" title="é—®é¢˜äºŒï¼šå—å±æ€§æ ‡ç­¾floatåï¼Œåˆæœ‰æ¨ªè¡Œçš„marginæƒ…å†µä¸‹ï¼Œåœ¨ie6æ˜¾ç¤ºmarginæ¯”è®¾ç½®çš„å¤§"></a>é—®é¢˜äºŒï¼šå—å±æ€§æ ‡ç­¾floatåï¼Œåˆæœ‰æ¨ªè¡Œçš„marginæƒ…å†µä¸‹ï¼Œåœ¨ie6æ˜¾ç¤ºmarginæ¯”è®¾ç½®çš„å¤§</h3><p>é—®é¢˜ç—‡çŠ¶:å¸¸è§ç—‡çŠ¶æ˜¯ie6ä¸­åé¢çš„ä¸€å—è¢«é¡¶åˆ°ä¸‹ä¸€è¡Œ<br>ç¢°åˆ°é¢‘ç‡ï¼š90%ï¼ˆç¨å¾®å¤æ‚ç‚¹çš„é¡µé¢éƒ½ä¼šç¢°åˆ°ï¼Œfloatå¸ƒå±€æœ€å¸¸è§çš„æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼‰<br>è§£å†³æ–¹æ¡ˆï¼šåœ¨floatçš„æ ‡ç­¾æ ·å¼æ§åˆ¶ä¸­åŠ å…¥ display:inline;å°†å…¶è½¬åŒ–ä¸ºè¡Œå†…å±æ€§<br>å¤‡æ³¨ï¼šæˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯div+csså¸ƒå±€äº†ï¼Œè€Œdivå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å—å±æ€§æ ‡ç­¾ï¼Œæ¨ªå‘å¸ƒå±€çš„æ—¶å€™æˆ‘ä»¬é€šå¸¸éƒ½æ˜¯ç”¨div floatå®ç°çš„ï¼Œæ¨ªå‘çš„é—´è·è®¾ç½®å¦‚æœç”¨marginå®ç°ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªå¿…ç„¶ä¼šç¢°åˆ°çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p><h3 id="é—®é¢˜ä¸‰ï¼šè®¾ç½®è¾ƒå°é«˜åº¦æ ‡ç­¾ï¼ˆä¸€èˆ¬å°äº10pxï¼‰ï¼Œåœ¨ie6ï¼Œie7ï¼Œé¨æ¸¸ä¸­é«˜åº¦è¶…å‡ºè‡ªå·±è®¾ç½®é«˜åº¦"><a href="#é—®é¢˜ä¸‰ï¼šè®¾ç½®è¾ƒå°é«˜åº¦æ ‡ç­¾ï¼ˆä¸€èˆ¬å°äº10pxï¼‰ï¼Œåœ¨ie6ï¼Œie7ï¼Œé¨æ¸¸ä¸­é«˜åº¦è¶…å‡ºè‡ªå·±è®¾ç½®é«˜åº¦" class="headerlink" title="é—®é¢˜ä¸‰ï¼šè®¾ç½®è¾ƒå°é«˜åº¦æ ‡ç­¾ï¼ˆä¸€èˆ¬å°äº10pxï¼‰ï¼Œåœ¨ie6ï¼Œie7ï¼Œé¨æ¸¸ä¸­é«˜åº¦è¶…å‡ºè‡ªå·±è®¾ç½®é«˜åº¦"></a>é—®é¢˜ä¸‰ï¼šè®¾ç½®è¾ƒå°é«˜åº¦æ ‡ç­¾ï¼ˆä¸€èˆ¬å°äº10pxï¼‰ï¼Œåœ¨ie6ï¼Œie7ï¼Œé¨æ¸¸ä¸­é«˜åº¦è¶…å‡ºè‡ªå·±è®¾ç½®é«˜åº¦</h3><p>é—®é¢˜ç—‡çŠ¶ï¼šie6ã€7å’Œé¨æ¸¸é‡Œè¿™ä¸ªæ ‡ç­¾çš„é«˜åº¦ä¸å—æ§åˆ¶ï¼Œè¶…å‡ºè‡ªå·±è®¾ç½®çš„é«˜åº¦<br>ç¢°åˆ°é¢‘ç‡ï¼š60%<br>è§£å†³æ–¹æ¡ˆï¼šç»™è¶…å‡ºé«˜åº¦çš„æ ‡ç­¾è®¾ç½®overflow:hidden;æˆ–è€…è®¾ç½®è¡Œé«˜line-height å°äºä½ è®¾ç½®çš„é«˜åº¦ã€‚<br>å¤‡æ³¨ï¼šè¿™ç§æƒ…å†µä¸€èˆ¬å‡ºç°åœ¨æˆ‘ä»¬è®¾ç½®å°åœ†è§’èƒŒæ™¯çš„æ ‡ç­¾é‡Œã€‚å‡ºç°è¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ie8ä¹‹å‰çš„æµè§ˆå™¨éƒ½ä¼šç»™æ ‡ç­¾ä¸€ä¸ªæœ€å°é»˜è®¤çš„è¡Œé«˜çš„é«˜åº¦ã€‚å³ä½¿ä½ çš„æ ‡ç­¾æ˜¯ç©ºçš„ï¼Œè¿™ä¸ªæ ‡ç­¾çš„é«˜åº¦è¿˜æ˜¯ä¼šè¾¾åˆ°é»˜è®¤çš„è¡Œé«˜ã€‚</p><a id="more"></a><h3 id="é—®é¢˜å››ï¼šè¡Œå†…å±æ€§æ ‡ç­¾ï¼Œè®¾ç½®display-blockåé‡‡ç”¨floatå¸ƒå±€ï¼Œåˆæœ‰æ¨ªè¡Œçš„marginçš„æƒ…å†µï¼Œie6é—´è·bugï¼ˆç±»ä¼¼ç¬¬äºŒç§ï¼‰"><a href="#é—®é¢˜å››ï¼šè¡Œå†…å±æ€§æ ‡ç­¾ï¼Œè®¾ç½®display-blockåé‡‡ç”¨floatå¸ƒå±€ï¼Œåˆæœ‰æ¨ªè¡Œçš„marginçš„æƒ…å†µï¼Œie6é—´è·bugï¼ˆç±»ä¼¼ç¬¬äºŒç§ï¼‰" class="headerlink" title="é—®é¢˜å››ï¼šè¡Œå†…å±æ€§æ ‡ç­¾ï¼Œè®¾ç½®display:blockåé‡‡ç”¨floatå¸ƒå±€ï¼Œåˆæœ‰æ¨ªè¡Œçš„marginçš„æƒ…å†µï¼Œie6é—´è·bugï¼ˆç±»ä¼¼ç¬¬äºŒç§ï¼‰"></a>é—®é¢˜å››ï¼šè¡Œå†…å±æ€§æ ‡ç­¾ï¼Œè®¾ç½®display:blockåé‡‡ç”¨floatå¸ƒå±€ï¼Œåˆæœ‰æ¨ªè¡Œçš„marginçš„æƒ…å†µï¼Œie6é—´è·bugï¼ˆç±»ä¼¼ç¬¬äºŒç§ï¼‰</h3><p>é—®é¢˜ç—‡çŠ¶ï¼šie6é‡Œçš„é—´è·æ¯”è¶…è¿‡è®¾ç½®çš„é—´è·<br>ç¢°åˆ°å‡ ç‡ï¼š20%<br>è§£å†³æ–¹æ¡ˆï¼šåœ¨display:block;åé¢åŠ å…¥display:inline;display:table;<br>å¤‡æ³¨ï¼šè¡Œå†…å±æ€§æ ‡ç­¾ï¼Œä¸ºäº†è®¾ç½®å®½é«˜ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®display:block;(é™¤äº†inputæ ‡ç­¾æ¯”è¾ƒç‰¹æ®Š)ã€‚åœ¨ç”¨floatå¸ƒå±€å¹¶æœ‰æ¨ªå‘çš„marginåï¼Œåœ¨ie6ä¸‹ï¼Œä»–å°±å…·æœ‰äº†å—å±æ€§floatåçš„æ¨ªå‘marginçš„bugã€‚ä¸è¿‡å› ä¸ºå®ƒæœ¬èº«å°±æ˜¯è¡Œå†…å±æ€§æ ‡ç­¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å†åŠ ä¸Šdisplay:inlineçš„è¯ï¼Œå®ƒçš„é«˜å®½å°±ä¸å¯è®¾äº†ã€‚è¿™æ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦åœ¨display:inlineåé¢åŠ å…¥display:talbeã€‚</p><h3 id="å›¾ç‰‡é»˜è®¤æœ‰é—´è·"><a href="#å›¾ç‰‡é»˜è®¤æœ‰é—´è·" class="headerlink" title="å›¾ç‰‡é»˜è®¤æœ‰é—´è·"></a>å›¾ç‰‡é»˜è®¤æœ‰é—´è·</h3><p>é—®é¢˜ç—‡çŠ¶ï¼šå‡ ä¸ªimgæ ‡ç­¾æ”¾åœ¨ä¸€èµ·çš„æ—¶å€™ï¼Œæœ‰äº›æµè§ˆå™¨ä¼šæœ‰é»˜è®¤çš„é—´è·ï¼ŒåŠ ä¸Šé—®é¢˜ä¸€ä¸­æåˆ°çš„é€šé…ç¬¦ä¹Ÿä¸èµ·ä½œç”¨ã€‚<br>ç¢°åˆ°å‡ ç‡ï¼š20%<br>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨floatå±æ€§ä¸ºimgå¸ƒå±€<br>å¤‡æ³¨ï¼šå› ä¸ºimgæ ‡ç­¾æ˜¯è¡Œå†…å±æ€§æ ‡ç­¾ï¼Œæ‰€ä»¥åªè¦ä¸è¶…å‡ºå®¹å™¨å®½åº¦ï¼Œimgæ ‡ç­¾éƒ½ä¼šæ’åœ¨ä¸€è¡Œé‡Œï¼Œä½†æ˜¯éƒ¨åˆ†æµè§ˆå™¨çš„imgæ ‡ç­¾ä¹‹é—´ä¼šæœ‰ä¸ªé—´è·ã€‚å»æ‰è¿™ä¸ªé—´è·ä½¿ç”¨floatæ˜¯æ­£é“</p><h3 id="æ ‡ç­¾æœ€ä½é«˜åº¦è®¾ç½®min-heightä¸å…¼å®¹"><a href="#æ ‡ç­¾æœ€ä½é«˜åº¦è®¾ç½®min-heightä¸å…¼å®¹" class="headerlink" title="æ ‡ç­¾æœ€ä½é«˜åº¦è®¾ç½®min-heightä¸å…¼å®¹"></a>æ ‡ç­¾æœ€ä½é«˜åº¦è®¾ç½®min-heightä¸å…¼å®¹</h3><p>é—®é¢˜ç—‡çŠ¶ï¼šå› ä¸ºmin-heightæœ¬èº«å°±æ˜¯ä¸€ä¸ªä¸å…¼å®¹çš„csså±æ€§ï¼Œæ‰€ä»¥è®¾ç½®min-heightæ—¶ä¸èƒ½å¾ˆå¥½çš„è¢«å„ä¸ªæµè§ˆå™¨å…¼å®¹<br>ç¢°åˆ°å‡ ç‡ï¼š5%<br>è§£å†³æ–¹æ¡ˆï¼šå¦‚æœæˆ‘ä»¬è¦è®¾ç½®ä¸€ä¸ªæ ‡ç­¾çš„æœ€å°é«˜åº¦200pxï¼Œéœ€è¦è¿›è¡Œçš„è®¾ç½®ä¸ºï¼š{min-height:200px; height:auto !important; height:200px; overflow:visible;}<br>å¤‡æ³¨ï¼šåœ¨B/Sç³»ç»Ÿå‰ç«¯å¼€æ—¶ï¼Œæœ‰å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬æœ‰è¿™ç§éœ€æ±‚ã€‚å½“å†…å®¹å°äºä¸€ä¸ªå€¼ï¼ˆå¦‚300pxï¼‰æ—¶ã€‚å®¹å™¨çš„é«˜åº¦ä¸º300pxï¼›å½“å†…å®¹é«˜åº¦å¤§äºè¿™ä¸ªå€¼æ—¶ï¼Œå®¹å™¨é«˜åº¦è¢«æ’‘é«˜ï¼Œè€Œä¸æ˜¯å‡ºç°æ»šåŠ¨æ¡ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±ä¼šé¢ä¸´è¿™ä¸ªå…¼å®¹æ€§é—®é¢˜ã€‚</p><h3 id="é—®é¢˜ä¸ƒï¼šé€æ˜åº¦çš„å…¼å®¹cssè®¾ç½®"><a href="#é—®é¢˜ä¸ƒï¼šé€æ˜åº¦çš„å…¼å®¹cssè®¾ç½®" class="headerlink" title="é—®é¢˜ä¸ƒï¼šé€æ˜åº¦çš„å…¼å®¹cssè®¾ç½®"></a>é—®é¢˜ä¸ƒï¼šé€æ˜åº¦çš„å…¼å®¹cssè®¾ç½®</h3><p>æ–¹æ³•æ˜¯ï¼šæ¯å†™ä¸€å°æ®µä»£ç ï¼ˆå¸ƒå±€ä¸­çš„ä¸€è¡Œæˆ–è€…ä¸€å—ï¼‰æˆ‘ä»¬éƒ½è¦åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸­çœ‹æ˜¯å¦å…¼å®¹ï¼Œå½“ç„¶ç†Ÿç»ƒåˆ°ä¸€å®šçš„ç¨‹åº¦å°±æ²¡è¿™ä¹ˆéº»çƒ¦äº†ã€‚å»ºè®®ç»å¸¸ä¼šç¢°åˆ°å…¼å®¹æ€§é—®é¢˜çš„æ–°æ‰‹ä½¿ç”¨ã€‚å¾ˆå¤šå…¼å®¹æ€§é—®é¢˜éƒ½æ˜¯å› ä¸ºæµè§ˆå™¨å¯¹æ ‡ç­¾çš„é»˜è®¤å±æ€§è§£æä¸åŒé€ æˆçš„ï¼Œåªè¦æˆ‘ä»¬ç¨åŠ è®¾ç½®éƒ½èƒ½è½»æ¾åœ°è§£å†³è¿™äº›å…¼å®¹é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬ç†Ÿæ‚‰æ ‡ç­¾çš„é»˜è®¤å±æ€§çš„è¯ï¼Œå°±èƒ½å¾ˆå¥½çš„ç†è§£ä¸ºä»€ä¹ˆä¼šå‡ºç°å…¼å®¹é—®é¢˜ä»¥åŠæ€ä¹ˆå»è§£å†³è¿™äº›å…¼å®¹é—®é¢˜ã€‚</p><h3 id="æŠ€å·§ä¸€ï¼šcss-hack"><a href="#æŠ€å·§ä¸€ï¼šcss-hack" class="headerlink" title="æŠ€å·§ä¸€ï¼šcss hack"></a>æŠ€å·§ä¸€ï¼šcss hack</h3><p>ä½¿ç”¨hacker æˆ‘å¯ä»¥æŠŠæµè§ˆå™¨åˆ†ä¸º3ç±»ï¼š<code>ie6</code> ï¼›<code>ie7å’Œé¨æ¸¸</code>ï¼›<code>å…¶ä»–ï¼ˆie8 chrome ff safari operaç­‰ï¼‰</code></p><p>ie6è®¤è¯†çš„hacker æ˜¯ä¸‹åˆ’çº¿_ å’Œæ˜Ÿå· <em><br>ie7 é¨æ¸¸è®¤è¯†çš„hackeræ˜¯æ˜Ÿå· </em> ï¼ˆåŒ…æ‹¬ä¸Šé¢é—®é¢˜6ä¸­çš„ !importantä¹Ÿç®—æ˜¯hackçš„ä¸€ç§ã€‚ä¸è¿‡å®ç”¨æ€§è¾ƒå°ã€‚ï¼‰</p><p>å› ä¸ºä¼˜å…ˆçº§ç›¸åŒä¸”ç›¸å†²çªçš„å±æ€§è®¾ç½®åä¸€ä¸ªä¼šè¦†ç›–æ‰å‰ä¸€ä¸ªï¼Œæ‰€ä»¥ä¹¦å†™çš„æ¬¡åºæ˜¯å¾ˆé‡è¦çš„ã€‚</p><p>è¶Šå°‘çš„æµ®åŠ¨ï¼Œå°±ä¼šè¶Šå°‘çš„ä»£ç ï¼Œä¼šæœ‰æ›´çµæ´»çš„é¡µé¢ï¼Œä¼šæœ‰æ‰©å±•æ€§æ›´å¼ºçš„é¡µé¢ã€‚è¿™ä¸å¤šè¯´ï¼Œå½’ç»“ä¸ºåˆ°ä¸€å®šæ°´å¹³äº†ï¼Œæµ®åŠ¨ä¼šç”¨çš„è¾ƒå°‘ã€‚å¦å¤–ï¼Œæ‚¨ä¹Ÿä¼šé¿å…ä½¿ç”¨æµ®åŠ¨+marginçš„ç”¨æ³•ã€‚æ‰€ä»¥ï¼Œè¶Šåæ¥è¶Šä¸æ˜“é‡åˆ°è¿™ç§bugã€‚</p><h3 id="æŠ€å·§äºŒï¼špaddingï¼Œmarignï¼Œheightï¼Œwidth"><a href="#æŠ€å·§äºŒï¼špaddingï¼Œmarignï¼Œheightï¼Œwidth" class="headerlink" title="æŠ€å·§äºŒï¼špaddingï¼Œmarignï¼Œheightï¼Œwidth"></a>æŠ€å·§äºŒï¼špaddingï¼Œmarignï¼Œheightï¼Œwidth</h3><p>æ³¨æ„æ˜¯æŠ€å·§ï¼Œä¸æ˜¯æ–¹æ³•ï¼š å†™å¥½æ ‡å‡†å¤´ <a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtdâ€&gt;" target="_blank" rel="noopener">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtdâ€&gt;</a> <a href="http://www.w3.org/1999/xhtmlâ€&gt;" target="_blank" rel="noopener">http://www.w3.org/1999/xhtmlâ€&gt;</a> <strong>å°½é‡ç”¨paddingï¼Œæ…ç”¨margin</strong>ï¼Œheightå°½é‡è¡¥ä¸Š100%ï¼Œçˆ¶çº§heightæœ‰å®šå€¼å­çº§heightä¸ç”¨100%ï¼Œå­çº§å…¨ä¸ºæµ®åŠ¨æ—¶åº•éƒ¨è¡¥ä¸ªç©ºclear:bothçš„divå®½å°½é‡ç”¨marginï¼Œæ…ç”¨paddingï¼Œwidthç®—å‡†å®é™…è¦çš„å‡å»padding</p><h3 id="æŠ€å·§ä¸‰ï¼šæ˜¾ç¤ºç±»ï¼ˆdisplay-block-inlineï¼‰"><a href="#æŠ€å·§ä¸‰ï¼šæ˜¾ç¤ºç±»ï¼ˆdisplay-block-inlineï¼‰" class="headerlink" title="æŠ€å·§ä¸‰ï¼šæ˜¾ç¤ºç±»ï¼ˆdisplay:block,inlineï¼‰"></a>æŠ€å·§ä¸‰ï¼šæ˜¾ç¤ºç±»ï¼ˆdisplay:block,inlineï¼‰</h3><p>display:block,inlineä¸¤ä¸ªå…ƒç´ </p><p>display:block; //å¯ä»¥ä¸ºå†…åµŒå…ƒç´ æ¨¡æ‹Ÿä¸ºå—å…ƒç´ </p><p>display:inline; //å®ç°åŒä¸€è¡Œæ’åˆ—çš„çš„æ•ˆæœ</p><p>display:table; //for FF,æ¨¡æ‹Ÿtableçš„æ•ˆæœ</p><h3 id="æŠ€å·§å››ï¼šæ€æ ·ä½¿ä¸€ä¸ªdivå±‚å±…ä¸­äºæµè§ˆå™¨ä¸­ï¼Ÿ"><a href="#æŠ€å·§å››ï¼šæ€æ ·ä½¿ä¸€ä¸ªdivå±‚å±…ä¸­äºæµè§ˆå™¨ä¸­ï¼Ÿ" class="headerlink" title="æŠ€å·§å››ï¼šæ€æ ·ä½¿ä¸€ä¸ªdivå±‚å±…ä¸­äºæµè§ˆå™¨ä¸­ï¼Ÿ"></a>æŠ€å·§å››ï¼šæ€æ ·ä½¿ä¸€ä¸ªdivå±‚å±…ä¸­äºæµè§ˆå™¨ä¸­ï¼Ÿ</h3><pre><code class="html">&lt;style type=&quot;text/css&quot;&gt;div {position:absolute;top:50%;left:50%;margin:-100px 0 0 -100px;width:200px;height:200px;border:1px solid red; }&lt;/style&gt;</code></pre><p>2ï¼‰divé‡Œçš„å†…å®¹ï¼ŒIEé»˜è®¤ä¸ºå±…ä¸­ï¼Œè€ŒFFé»˜è®¤ä¸ºå·¦å¯¹é½ï¼Œå¯ä»¥å°è¯•å¢åŠ ä»£ç margin: 0 auto;</p><h3 id="æŠ€å·§äº”ï¼šfloatçš„divé—­åˆ-æ¸…é™¤æµ®åŠ¨-è‡ªé€‚åº”é«˜åº¦"><a href="#æŠ€å·§äº”ï¼šfloatçš„divé—­åˆ-æ¸…é™¤æµ®åŠ¨-è‡ªé€‚åº”é«˜åº¦" class="headerlink" title="æŠ€å·§äº”ï¼šfloatçš„divé—­åˆ;æ¸…é™¤æµ®åŠ¨;è‡ªé€‚åº”é«˜åº¦"></a>æŠ€å·§äº”ï¼šfloatçš„divé—­åˆ;æ¸…é™¤æµ®åŠ¨;è‡ªé€‚åº”é«˜åº¦</h3><p>â‘  ä¾‹å¦‚ï¼šï¼œdiv id=â€floatAâ€&gt;ï¼œdiv id=â€floatBâ€&gt;ï¼œdiv id=â€NOTfloatCâ€&gt;</p><p>â‘¡ä½œä¸ºå¤–éƒ¨ wrapper çš„ div ä¸è¦å®šæ­»é«˜åº¦,ä¸ºäº†è®©é«˜åº¦èƒ½è‡ªé€‚åº”ï¼Œè¦åœ¨wrapperé‡Œé¢åŠ ä¸Šoverflow:hidden; å½“åŒ…å«floatçš„boxçš„æ—¶å€™ï¼Œé«˜åº¦è‡ªé€‚åº”åœ¨IEä¸‹æ— æ•ˆï¼Œè¿™æ—¶å€™åº”è¯¥è§¦å‘IEçš„layoutç§æœ‰å±æ€§(ä¸‡æ¶çš„IEå•Šï¼)ç”¨zoom:1;å¯ä»¥åšåˆ°ï¼Œè¿™æ ·å°±è¾¾åˆ°äº†å…¼å®¹ã€‚ </p><p>â‘¢å¯¹äºæ’ç‰ˆ,æˆ‘ä»¬ç”¨å¾—æœ€å¤šçš„cssæè¿°å¯èƒ½å°±æ˜¯float:left.æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨næ çš„float divåé¢åšä¸€ä¸ªç»Ÿä¸€çš„èƒŒæ™¯,</p><p>â‘£ä¸‡èƒ½float é—­åˆ(éå¸¸é‡è¦!)</p><p>å…³äº clear float çš„åŸç†å¯å‚è§ [How To ClearFloats Without Structural Markup],å°†ä»¥ä¸‹ä»£ç åŠ å…¥Global CSS ä¸­,ç»™éœ€è¦é—­åˆçš„divåŠ ä¸Šclass=â€clearfixâ€å³å¯,å±¡è¯•ä¸çˆ½ã€‚</p><h3 id="html5shiv-js"><a href="#html5shiv-js" class="headerlink" title="html5shiv.js"></a>html5shiv.js</h3><p>è§£å†³ ie9 ä»¥ä¸‹æµè§ˆå™¨å¯¹ html5 æ–°å¢æ ‡ç­¾ä¸è¯†åˆ«çš„é—®é¢˜ã€‚</p><pre><code class="javascript">&lt;!--[if lt IE 9]&gt;  &lt;script type=&quot;text/javascript&quot; src=&quot;https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt;</code></pre><h3 id="BFC-è§£å†³è¾¹è·é‡å é—®é¢˜"><a href="#BFC-è§£å†³è¾¹è·é‡å é—®é¢˜" class="headerlink" title="BFC è§£å†³è¾¹è·é‡å é—®é¢˜"></a>BFC è§£å†³è¾¹è·é‡å é—®é¢˜</h3><p>å½“ç›¸é‚»å…ƒç´ éƒ½è®¾ç½®äº† margin è¾¹è·æ—¶ï¼Œmargin å°†å–æœ€å¤§å€¼ï¼Œèˆå¼ƒå°å€¼ã€‚ä¸ºäº†ä¸è®©è¾¹è·é‡å ï¼Œå¯ä»¥ç»™å­å…ƒç´ åŠ ä¸€ä¸ªçˆ¶å…ƒç´ ï¼Œå¹¶è®¾ç½®è¯¥çˆ¶å…ƒç´ ä¸º BFCï¼šoverflow: hidden;</p><h3 id="IE6-åŒå€è¾¹è·çš„é—®é¢˜"><a href="#IE6-åŒå€è¾¹è·çš„é—®é¢˜" class="headerlink" title="IE6 åŒå€è¾¹è·çš„é—®é¢˜"></a>IE6 åŒå€è¾¹è·çš„é—®é¢˜</h3><p>è®¾ç½® ie6 ä¸­è®¾ç½®æµ®åŠ¨ï¼ŒåŒæ—¶åˆè®¾ç½® marginï¼Œä¼šå‡ºç°åŒå€è¾¹è·çš„é—®é¢˜<br>display: inline;</p><h3 id="è§£å†³-IE9-ä»¥ä¸‹æµè§ˆå™¨ä¸èƒ½ä½¿ç”¨-opacity"><a href="#è§£å†³-IE9-ä»¥ä¸‹æµè§ˆå™¨ä¸èƒ½ä½¿ç”¨-opacity" class="headerlink" title="è§£å†³ IE9 ä»¥ä¸‹æµè§ˆå™¨ä¸èƒ½ä½¿ç”¨ opacity"></a>è§£å†³ IE9 ä»¥ä¸‹æµè§ˆå™¨ä¸èƒ½ä½¿ç”¨ opacity</h3><p>opacity: 0.5;<br>filter: alpha(opacity = 50);<br>filter: progid:DXImageTransform.Microsoft.Alpha(style = 0, opacity = 50);</p><h3 id="è§£å†³-IE6-ä¸æ”¯æŒ-fixed-ç»å¯¹å®šä½ä»¥åŠIE6ä¸‹è¢«ç»å¯¹å®šä½çš„å…ƒç´ åœ¨æ»šåŠ¨çš„æ—¶å€™ä¼šé—ªåŠ¨çš„é—®é¢˜"><a href="#è§£å†³-IE6-ä¸æ”¯æŒ-fixed-ç»å¯¹å®šä½ä»¥åŠIE6ä¸‹è¢«ç»å¯¹å®šä½çš„å…ƒç´ åœ¨æ»šåŠ¨çš„æ—¶å€™ä¼šé—ªåŠ¨çš„é—®é¢˜" class="headerlink" title="è§£å†³ IE6 ä¸æ”¯æŒ fixed ç»å¯¹å®šä½ä»¥åŠIE6ä¸‹è¢«ç»å¯¹å®šä½çš„å…ƒç´ åœ¨æ»šåŠ¨çš„æ—¶å€™ä¼šé—ªåŠ¨çš„é—®é¢˜"></a>è§£å†³ IE6 ä¸æ”¯æŒ fixed ç»å¯¹å®šä½ä»¥åŠIE6ä¸‹è¢«ç»å¯¹å®šä½çš„å…ƒç´ åœ¨æ»šåŠ¨çš„æ—¶å€™ä¼šé—ªåŠ¨çš„é—®é¢˜</h3><pre><code class="css">/* IE6 hack */*html, *html body {  background-image: url(about:blank);  background-attachment: fixed;}*html #menu {  position: absolute;  top: expression(((e=document.documentElement.scrollTop) ? e : document.body.scrollTop) + 100 + &#39;px&#39;);}</code></pre><h3 id="IE6-èƒŒæ™¯é—ªçƒçš„é—®é¢˜"><a href="#IE6-èƒŒæ™¯é—ªçƒçš„é—®é¢˜" class="headerlink" title="IE6 èƒŒæ™¯é—ªçƒçš„é—®é¢˜"></a>IE6 èƒŒæ™¯é—ªçƒçš„é—®é¢˜</h3><p>é—®é¢˜ï¼šé“¾æ¥ã€æŒ‰é’®ç”¨ CSSsprites ä½œä¸ºèƒŒæ™¯ï¼Œåœ¨ ie6 ä¸‹ä¼šæœ‰èƒŒæ™¯å›¾é—ªçƒçš„ç°è±¡ã€‚åŸå› æ˜¯ IE6 æ²¡æœ‰å°†èƒŒæ™¯å›¾ç¼“å­˜ï¼Œæ¯æ¬¡è§¦å‘ hover çš„æ—¶å€™éƒ½ä¼šé‡æ–°åŠ è½½</p><p>è§£å†³ï¼šå¯ä»¥ç”¨ JavaScript è®¾ç½® ie6 ç¼“å­˜è¿™äº›å›¾ç‰‡ï¼š</p><pre><code class="css">document.execCommand(&quot;BackgroundImageCache&quot;, false, true);</code></pre><h3 id="è§£å†³åœ¨-IE6-ä¸‹ï¼Œåˆ—è¡¨ä¸æ—¥æœŸé”™ä½çš„é—®é¢˜"><a href="#è§£å†³åœ¨-IE6-ä¸‹ï¼Œåˆ—è¡¨ä¸æ—¥æœŸé”™ä½çš„é—®é¢˜" class="headerlink" title="è§£å†³åœ¨ IE6 ä¸‹ï¼Œåˆ—è¡¨ä¸æ—¥æœŸé”™ä½çš„é—®é¢˜"></a>è§£å†³åœ¨ IE6 ä¸‹ï¼Œåˆ—è¡¨ä¸æ—¥æœŸé”™ä½çš„é—®é¢˜</h3><p>æ—¥æœŸ<code>span</code> æ ‡ç­¾æ”¾åœ¨æ ‡é¢˜ <code>a</code> æ ‡ç­¾ä¹‹å‰å³å¯</p><h3 id="è§£å†³-IE6-ä¸æ”¯æŒ-min-height-å±æ€§çš„é—®é¢˜"><a href="#è§£å†³-IE6-ä¸æ”¯æŒ-min-height-å±æ€§çš„é—®é¢˜" class="headerlink" title="è§£å†³ IE6 ä¸æ”¯æŒ min-height å±æ€§çš„é—®é¢˜"></a>è§£å†³ IE6 ä¸æ”¯æŒ min-height å±æ€§çš„é—®é¢˜</h3><p>min-height: 350px;<br>_height: 350px;</p><h3 id="è®©-IE7-IE8-æ”¯æŒ-CSS3-background-sizeå±æ€§"><a href="#è®©-IE7-IE8-æ”¯æŒ-CSS3-background-sizeå±æ€§" class="headerlink" title="è®© IE7 IE8 æ”¯æŒ CSS3 background-sizeå±æ€§"></a>è®© IE7 IE8 æ”¯æŒ CSS3 background-sizeå±æ€§</h3><pre><code class="css">html {  height: 100%;}body {  height: 100%;  margin: 0;  padding: 0;  background-image: url(&#39;img/37.png&#39;);  background-repeat: no-repeat;  background-size: cover;  -ms-behavior: url(&#39;css/backgroundsize.min.htc&#39;);  behavior: url(&#39;css/backgroundsize.min.htc&#39;);}</code></pre><h3 id="IE6-7-line-height-å¤±æ•ˆçš„é—®é¢˜"><a href="#IE6-7-line-height-å¤±æ•ˆçš„é—®é¢˜" class="headerlink" title="IE6-7 line-height å¤±æ•ˆçš„é—®é¢˜"></a>IE6-7 line-height å¤±æ•ˆçš„é—®é¢˜</h3><p>é—®é¢˜ï¼šåœ¨ie ä¸­ img ä¸æ–‡å­—æ”¾ä¸€èµ·æ—¶ï¼Œline-height ä¸èµ·ä½œç”¨</p><p>è§£å†³ï¼šéƒ½è®¾ç½®æˆ float</p><h3 id="td-è‡ªåŠ¨æ¢è¡Œçš„é—®é¢˜"><a href="#td-è‡ªåŠ¨æ¢è¡Œçš„é—®é¢˜" class="headerlink" title="td è‡ªåŠ¨æ¢è¡Œçš„é—®é¢˜"></a>td è‡ªåŠ¨æ¢è¡Œçš„é—®é¢˜</h3><p>é—®é¢˜ï¼štable å®½åº¦å›ºå®šï¼Œtd è‡ªåŠ¨æ¢è¡Œ</p><p>è§£å†³ï¼šè®¾ç½® Table ä¸º table-layout: fixedï¼Œtd ä¸º word-wrap: break-word</p><h3 id="é”®ç›˜äº‹ä»¶-keyCode-å…¼å®¹æ€§å†™æ³•"><a href="#é”®ç›˜äº‹ä»¶-keyCode-å…¼å®¹æ€§å†™æ³•" class="headerlink" title="é”®ç›˜äº‹ä»¶ keyCode å…¼å®¹æ€§å†™æ³•"></a>é”®ç›˜äº‹ä»¶ keyCode å…¼å®¹æ€§å†™æ³•</h3><pre><code class="js">var inp = document.getElementById(&#39;inp&#39;)var result = document.getElementById(&#39;result&#39;)function getKeyCode(e) {  e = e ? e : (window.event ? window.event : &quot;&quot;)  return e.keyCode ? e.keyCode : e.which}inp.onkeypress = function(e) {  result.innerHTML = getKeyCode(e)}</code></pre><h3 id="æ±‚çª—å£å¤§å°çš„å…¼å®¹å†™æ³•"><a href="#æ±‚çª—å£å¤§å°çš„å…¼å®¹å†™æ³•" class="headerlink" title="æ±‚çª—å£å¤§å°çš„å…¼å®¹å†™æ³•"></a>æ±‚çª—å£å¤§å°çš„å…¼å®¹å†™æ³•</h3><pre><code class="js">// æµè§ˆå™¨çª—å£å¯è§†åŒºåŸŸå¤§å°ï¼ˆä¸åŒ…æ‹¬å·¥å…·æ å’Œæ»šåŠ¨æ¡ç­‰è¾¹çº¿ï¼‰// 1600 * 525var client_w = document.documentElement.clientWidth || document.body.clientWidth;var client_h = document.documentElement.clientHeight || document.body.clientHeight;// ç½‘é¡µå†…å®¹å®é™…å®½é«˜ï¼ˆåŒ…æ‹¬å·¥å…·æ å’Œæ»šåŠ¨æ¡ç­‰è¾¹çº¿ï¼‰// 1600 * 8var scroll_w = document.documentElement.scrollWidth || document.body.scrollWidth;var scroll_h = document.documentElement.scrollHeight || document.body.scrollHeight;// ç½‘é¡µå†…å®¹å®é™…å®½é«˜ (ä¸åŒ…æ‹¬å·¥å…·æ å’Œæ»šåŠ¨æ¡ç­‰è¾¹çº¿ï¼‰// 1600 * 8var offset_w = document.documentElement.offsetWidth || document.body.offsetWidth;var offset_h = document.documentElement.offsetHeight || document.body.offsetHeight;// æ»šåŠ¨çš„é«˜åº¦var scroll_Top = document.documentElement.scrollTop||document.body.scrollTop;</code></pre>]]></content>
      
      
      <categories>
          
          <category> å…¼å®¹æ€§ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æµè§ˆå™¨å…¼å®¹æ€§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¯ä¸ª JavaScript å·¥ç¨‹å¸ˆéƒ½åº”å½“çŸ¥é“çš„ 10 ä¸ªé¢è¯•é¢˜</title>
      <link href="/2018/04/23/Interview/%E6%AF%8F%E4%B8%AA-JavaScript-%E5%B7%A5%E7%A8%8B%E5%B8%88%E9%83%BD%E5%BA%94%E5%BD%93%E7%9F%A5%E9%81%93%E7%9A%84-10-%E4%B8%AA%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
      <url>/2018/04/23/Interview/%E6%AF%8F%E4%B8%AA-JavaScript-%E5%B7%A5%E7%A8%8B%E5%B8%88%E9%83%BD%E5%BA%94%E5%BD%93%E7%9F%A5%E9%81%93%E7%9A%84-10-%E4%B8%AA%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒ½è¯´å‡ºæ¥ä¸¤ç§å¯¹äº-JavaScript-å·¥ç¨‹å¸ˆå¾ˆé‡è¦çš„ç¼–ç¨‹èŒƒå¼ä¹ˆï¼Ÿ"><a href="#èƒ½è¯´å‡ºæ¥ä¸¤ç§å¯¹äº-JavaScript-å·¥ç¨‹å¸ˆå¾ˆé‡è¦çš„ç¼–ç¨‹èŒƒå¼ä¹ˆï¼Ÿ" class="headerlink" title="èƒ½è¯´å‡ºæ¥ä¸¤ç§å¯¹äº JavaScript å·¥ç¨‹å¸ˆå¾ˆé‡è¦çš„ç¼–ç¨‹èŒƒå¼ä¹ˆï¼Ÿ"></a>èƒ½è¯´å‡ºæ¥ä¸¤ç§å¯¹äº JavaScript å·¥ç¨‹å¸ˆå¾ˆé‡è¦çš„ç¼–ç¨‹èŒƒå¼ä¹ˆï¼Ÿ</h2><p>JavaScript æ˜¯ä¸€é—¨å¤šèŒƒå¼ï¼ˆmulti-paradigmï¼‰çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒæ—¢<code>æ”¯æŒå‘½ä»¤å¼ï¼ˆimperative</code>ï¼‰/<code>é¢å‘è¿‡ç¨‹ï¼ˆproceduralï¼‰</code>ç¼–ç¨‹ï¼Œä¹Ÿæ”¯æŒ<code>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼ŒObject-Oriented Programmingï¼‰</code>ï¼Œè¿˜æ”¯æŒ<code>å‡½æ•°å¼ç¼–ç¨‹ï¼ˆfunctional programming</code>ï¼‰ã€‚JavaScript æ‰€æ”¯æŒçš„é¢å‘å¯¹è±¡ç¼–ç¨‹åŒ…æ‹¬åŸå‹ç»§æ‰¿ï¼ˆprototypal inheritanceï¼‰ã€‚</p><h3 id="é¢è¯•åŠ åˆ†é¡¹"><a href="#é¢è¯•åŠ åˆ†é¡¹" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>åŸå‹ç»§æ‰¿ï¼ˆå³ï¼šåŸå‹ï¼ŒOLOOâ€”â€”é“¾æ¥åˆ°å…¶å®ƒå¯¹è±¡çš„å¯¹è±¡ï¼‰ï¼›</li><li>å‡½æ•°å¼ç¼–ç¨‹ï¼ˆå³ï¼šé—­åŒ…ï¼ˆclosureï¼‰ï¼Œä¸€ç±»å‡½æ•°ï¼ˆfirst class functionsï¼‰ï¼Œlambda å‡½æ•°ï¼šç®­å¤´å‡½æ•°ï¼‰ã€‚</li></ul><h3 id="é¢è¯•å‡åˆ†é¡¹"><a href="#é¢è¯•å‡åˆ†é¡¹" class="headerlink" title="é¢è¯•å‡åˆ†é¡¹"></a>é¢è¯•å‡åˆ†é¡¹</h3><ul><li>è¿èŒƒå¼éƒ½ä¸çŸ¥é“ï¼Œæ›´åˆ«æä»€ä¹ˆåŸå‹ OOï¼ˆprototypal ooï¼‰æˆ–è€…å‡½æ•°å¼ç¼–ç¨‹äº†ã€‚</li></ul><h3 id="æ·±å…¥äº†è§£"><a href="#æ·±å…¥äº†è§£" class="headerlink" title="æ·±å…¥äº†è§£"></a>æ·±å…¥äº†è§£</h3><p><a href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3" target="_blank" rel="noopener">The Two Pillars of JavaScript Part 1ï¼šJS</a> ä¸¤å¤§æ”¯æŸ±ä¹‹ä¸€ï¼šåŸå‹ OO<br><a href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-pt-2-functional-programming-a63aa53a41a4" target="_blank" rel="noopener">The Two Pillars of JavaScript Part 2ï¼šJS</a> ä¸¤å¤§æ”¯æŸ±ä¹‹äºŒï¼šå‡½æ•°å¼ç¼–ç¨‹</p><h2 id="ä»€ä¹ˆæ˜¯å‡½æ•°ç¼–ç¨‹"><a href="#ä»€ä¹ˆæ˜¯å‡½æ•°ç¼–ç¨‹" class="headerlink" title="ä»€ä¹ˆæ˜¯å‡½æ•°ç¼–ç¨‹"></a>ä»€ä¹ˆæ˜¯å‡½æ•°ç¼–ç¨‹</h2><p>å‡½æ•°å¼ç¼–ç¨‹ï¼Œæ˜¯å°†æ•°å­¦å‡½æ•°ç»„åˆèµ·æ¥ï¼Œå¹¶ä¸”é¿å…äº†çŠ¶æ€å…±äº«ï¼ˆshared stateï¼‰åŠå¯å˜æ•°æ®ï¼ˆmutable dataï¼‰ï¼Œç”±æ­¤è€Œäº§ç”Ÿçš„ç¼–ç¨‹è¯­è¨€ã€‚å‘æ˜äº 1958 å¹´çš„ Lisp å°±æ˜¯é¦–æ‰¹æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹çš„è¯­è¨€ä¹‹ä¸€ï¼Œè€Œ Î» æ¼”ç®—ï¼ˆlambda calculusï¼‰åˆ™å¯ä»¥è¯´æ˜¯å­•è‚²äº†è¿™é—¨è¯­è¨€ã€‚å³ä½¿åœ¨ä»Šå¤©ï¼ŒLisp è¿™ä¸ªå®¶æ—çš„ç¼–ç¨‹è¯­è¨€åº”ç”¨èŒƒå›´ä¾ç„¶å¾ˆå¹¿ã€‚</p><p>å‡½æ•°å¼ç¼–ç¨‹å¯æ˜¯ JavaScript è¯­è¨€ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªæ¦‚å¿µï¼ˆå®ƒå¯æ˜¯ JavaScript çš„ä¸¤å¤§æ”¯æŸ±ä¹‹ä¸€ï¼‰ã€‚ES5 è§„èŒƒä¸­å°±å¢åŠ äº†å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°å¼å·¥å…·ã€‚<br><a id="more"></a></p><h3 id="é¢è¯•åŠ åˆ†é¡¹-1"><a href="#é¢è¯•åŠ åˆ†é¡¹-1" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>çº¯å‡½æ•°ï¼ˆpure functionsï¼‰/å‡½æ•°çš„çº¯ç²¹æ€§ï¼ˆfunction purityï¼‰</li><li>çŸ¥é“å¦‚ä½•é¿å…å‰¯ä½œç”¨ï¼ˆside-effectsï¼‰</li><li>ç®€å•å‡½æ•°çš„ç»„åˆ</li><li>å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼šLispï¼ŒMLï¼ŒHaskellï¼ŒErlangï¼ŒClojureï¼ŒElmï¼ŒF#ï¼ŒOCamlï¼Œç­‰ç­‰</li><li>æåˆ°äº† JavaScript è¯­è¨€ä¸­æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼ˆFPï¼‰çš„ç‰¹æ€§ï¼šä¸€ç±»å‡½æ•°ï¼Œé«˜é˜¶å‡½æ•°ï¼ˆhigher order functionsï¼‰ï¼Œä½œä¸ºå‚æ•°ï¼ˆargumentsï¼‰/å€¼ï¼ˆvaluesï¼‰çš„å‡½æ•°</li></ul><h3 id="é¢è¯•å‡åˆ†é¡¹-1"><a href="#é¢è¯•å‡åˆ†é¡¹-1" class="headerlink" title="é¢è¯•å‡åˆ†é¡¹"></a>é¢è¯•å‡åˆ†é¡¹</h3><ul><li>æ²¡æœ‰æåˆ°çº¯å‡½æ•°ï¼Œä»¥åŠå¦‚ä½•é¿å…å‰¯ä½œç”¨</li><li>æ²¡æœ‰æä¾›å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„ä¾‹å­</li><li>æ²¡æœ‰è¯´æ˜¯ JavaScript ä¸­çš„å“ªäº›ç‰¹æ€§ä½¿å¾—å‡½æ•°å¼ç¼–ç¨‹å¾—ä»¥å®ç°</li></ul><h3 id="æ·±å…¥äº†è§£-1"><a href="#æ·±å…¥äº†è§£-1" class="headerlink" title="æ·±å…¥äº†è§£"></a>æ·±å…¥äº†è§£</h3><p><a href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-pt-2-functional-programming-a63aa53a41a4" target="_blank" rel="noopener">The Two Pillars of JavaScript Part 2ï¼šJS</a> ä¸¤å¤§æ”¯æŸ±ä¹‹äºŒï¼šå‡½æ•°å¼ç¼–ç¨‹</p><h2 id="ç±»ç»§æ‰¿å’ŒåŸå‹ç»§æ‰¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#ç±»ç»§æ‰¿å’ŒåŸå‹ç»§æ‰¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="ç±»ç»§æ‰¿å’ŒåŸå‹ç»§æ‰¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>ç±»ç»§æ‰¿å’ŒåŸå‹ç»§æ‰¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><p><strong>ç±»ç»§æ‰¿ï¼ˆClass Inheritanceï¼‰</strong>ï¼šå®ä¾‹ï¼ˆinstancesï¼‰ç”±ç±»ç»§æ‰¿è€Œæ¥ï¼ˆç±»å’Œå®ä¾‹çš„å…³ç³»ï¼Œå¯ä»¥ç±»æ¯”ä¸ºå»ºç­‘å›¾çº¸å’Œå®é™…å»ºç­‘ ğŸ  çš„å…³ç³»ï¼‰ï¼ŒåŒæ—¶è¿˜ä¼šåˆ›å»ºçˆ¶ç±»â€”å­ç±»è¿™æ ·ä¸€ç§å…³ç³»ï¼Œä¹Ÿå«åšç±»çš„åˆ†å±‚åˆ†ç±»ï¼ˆhierarchical class taxonomiesï¼‰ã€‚é€šå¸¸æ˜¯ç”¨ new å…³é”®å­—è°ƒç”¨ç±»çš„æ„é€ å‡½æ•°ï¼ˆconstructor functionsï¼‰æ¥åˆ›å»ºå®ä¾‹çš„ã€‚ä¸è¿‡åœ¨ ES6 ä¸­ï¼Œè¦ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œä¸ç”¨ class å…³é”®å­—ä¹Ÿå¯ä»¥ã€‚</p><p><strong>åŸå‹ç»§æ‰¿ï¼ˆPrototypal Inheritanceï¼‰</strong>ï¼šå®ä¾‹/å¯¹è±¡ç›´æ¥ä»å…¶å®ƒå¯¹è±¡ç»§æ‰¿è€Œæ¥ï¼Œåˆ›å»ºå®ä¾‹çš„è¯ï¼Œå¾€å¾€ç”¨å·¥å‚å‡½æ•°ï¼ˆfactory functionsï¼‰æˆ–è€… <code>Object.create()</code> æ–¹æ³•ã€‚å®ä¾‹å¯ä»¥ä»å¤šä¸ªä¸åŒçš„å¯¹è±¡ç»„åˆè€Œæ¥ï¼Œè¿™æ ·å°±èƒ½é€‰æ‹©æ€§åœ°ç»§æ‰¿äº†ã€‚</p><blockquote><p>åœ¨ JavaScript ä¸­ï¼ŒåŸå‹ç»§æ‰¿æ¯”ç±»ç»§æ‰¿æ›´ç®€å•ï¼Œä¹Ÿæ›´çµæ´»ã€‚</p></blockquote><h3 id="é¢è¯•åŠ åˆ†é¡¹-2"><a href="#é¢è¯•åŠ åˆ†é¡¹-2" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>ç±»ï¼šä¼šåˆ›å»ºç´§å¯†çš„è€¦åˆï¼Œæˆ–è€…è¯´å±‚çº§ç»“æ„ï¼ˆhierarchiesï¼‰/åˆ†ç±»ï¼ˆtaxonomiesï¼‰ã€‚</li><li>åŸå‹ï¼šæåˆ°äº†è¡”æ¥ç»§æ‰¿ï¼ˆconcatenative inheritanceï¼‰ã€åŸå‹å§”æ‰˜ï¼ˆ prototype delegationï¼‰ã€å‡½æ•°ç»§æ‰¿ï¼ˆfunctional inheritanceï¼‰ï¼Œä»¥åŠå¯¹è±¡ç»„åˆï¼ˆobject compositionï¼‰ã€‚</li></ul><h3 id="é¢è¯•å‡åˆ†é¡¹-2"><a href="#é¢è¯•å‡åˆ†é¡¹-2" class="headerlink" title="é¢è¯•å‡åˆ†é¡¹"></a>é¢è¯•å‡åˆ†é¡¹</h3><ul><li>åŸå‹ç»§æ‰¿å’Œç»„åˆï¼Œä¸ç±»ç»§æ‰¿ç›¸æ¯”ï¼Œä¸çŸ¥é“å“ªä¸ªæ›´å¥½ã€‚</li></ul><h3 id="å‡½æ•°å¼ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå„æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œä¸è¶³å‘¢ï¼Ÿ"><a href="#å‡½æ•°å¼ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå„æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œä¸è¶³å‘¢ï¼Ÿ" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå„æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œä¸è¶³å‘¢ï¼Ÿ"></a>å‡½æ•°å¼ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå„æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œä¸è¶³å‘¢ï¼Ÿ</h3><p><strong>é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¼˜ç‚¹</strong>ï¼šå…³äºâ€œå¯¹è±¡â€çš„ä¸€äº›åŸºç¡€æ¦‚å¿µç†è§£èµ·æ¥æ¯”è¾ƒå®¹æ˜“ï¼Œæ–¹æ³•è°ƒç”¨çš„å«ä¹‰ä¹Ÿå¥½è§£é‡Šã€‚é¢å‘å¯¹è±¡ç¼–ç¨‹é€šå¸¸ä½¿ç”¨å‘½ä»¤å¼çš„ç¼–ç é£æ ¼ï¼Œå£°æ˜å¼ï¼ˆdeclarative styleï¼‰çš„ç”¨å¾—æ¯”è¾ƒå°‘ã€‚è¿™æ ·çš„ä»£ç è¯»èµ·æ¥ï¼Œåƒæ˜¯ä¸€ç»„ç›´æ¥çš„ã€è®¡ç®—æœºå¾ˆå®¹æ˜“å°±èƒ½éµå¾ªçš„æŒ‡ä»¤ã€‚</p><p><strong>é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸è¶³</strong>ï¼šé¢å‘å¯¹è±¡ç¼–ç¨‹å¾€å¾€éœ€è¦å…±äº«çŠ¶æ€ã€‚å¯¹è±¡åŠå…¶è¡Œä¸ºå¸¸å¸¸ä¼šæ·»åŠ åˆ°åŒä¸€ä¸ªå®ä½“ä¸Šï¼Œè¿™æ ·ä¸€æ¥ï¼Œå¦‚æœä¸€å †å‡½æ•°éƒ½è¦è®¿é—®è¿™ä¸ªå®ä½“ï¼Œè€Œä¸”è¿™äº›å‡½æ•°çš„æ‰§è¡Œé¡ºåºä¸ç¡®å®šçš„è¯ï¼Œå¾ˆå¯èƒ½å°±ä¼šå‡ºä¹±å­äº†ï¼Œæ¯”å¦‚ç«äº‰æ¡ä»¶ï¼ˆrace conditionsï¼‰è¿™ç§ç°è±¡ï¼ˆå‡½æ•° A ä¾èµ–äºå®ä½“çš„æŸä¸ªå±æ€§ï¼Œä½†æ˜¯åœ¨ A è®¿é—®å±æ€§ä¹‹å‰ï¼Œå±æ€§å·²ç»è¢«å‡½æ•° B ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆå‡½æ•° A åœ¨ä½¿ç”¨å±æ€§çš„æ—¶å€™ï¼Œå¾ˆå¯èƒ½å°±å¾—ä¸åˆ°é¢„æœŸçš„ç»“æœï¼‰ã€‚</p><p><strong>å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜ç‚¹</strong>ï¼šç”¨å‡½æ•°å¼èŒƒå¼æ¥ç¼–ç¨‹ï¼Œå°±ä¸éœ€è¦æ‹…å¿ƒå…±äº«çŠ¶æ€æˆ–è€…å‰¯ä½œç”¨äº†ã€‚è¿™æ ·å°±é¿å…äº†å‡ ä¸ªå‡½æ•°åœ¨è°ƒç”¨åŒä¸€æ‰¹èµ„æºæ—¶å¯èƒ½äº§ç”Ÿçš„ bug äº†ã€‚æ‹¥æœ‰äº†â€œæ— å‚é£æ ¼â€ï¼ˆpoint-free styleï¼Œä¹Ÿå«éšå¼ç¼–ç¨‹ï¼‰ä¹‹ç±»çš„ç‰¹æ€§ä¹‹åï¼Œå‡½æ•°å¼ç¼–ç¨‹å°±å¤§å¤§ç®€åŒ–äº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„æ–¹å¼æ¥æŠŠä»£ç ç»„åˆæˆå¤ç”¨æ€§æ›´å¼ºçš„ä»£ç äº†ï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹å¯åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚</p><p>å‡½æ•°å¼ç¼–ç¨‹æ›´åçˆ±<code>å£°æ˜å¼</code>ã€<code>ç¬¦å·å¼</code>ï¼ˆdenotational styleï¼‰çš„ç¼–ç é£æ ¼ï¼Œè¿™æ ·çš„ä»£ç ï¼Œå¹¶ä¸æ˜¯é‚£ç§ä¸ºäº†å®ç°æŸç§ç›®çš„è€Œéœ€è¦æŒ‰éƒ¨å°±ç­åœ°æ‰§è¡Œçš„ä¸€å¤§å †æŒ‡ä»¤ï¼Œè€Œæ˜¯å…³æ³¨å®è§‚ä¸Šè¦åšä»€ä¹ˆã€‚è‡³äºå…·ä½“åº”è¯¥æ€ä¹ˆåšï¼Œå°±éƒ½éšè—åœ¨å‡½æ•°å†…éƒ¨äº†ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¦æ˜¯æƒ³é‡æ„ä»£ç ã€ä¼˜åŒ–æ€§èƒ½ï¼Œé‚£å°±å¤§æœ‰å¯ä¸ºäº†ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šä»¥åšä¸€é“èœä¸ºä¾‹ï¼Œå°±æ˜¯ç”± <code>ä¹°èœ</code> -&gt; <code>æ´—èœ</code> -&gt; <code>ç‚’èœ</code> è¿™ä¸‰æ­¥ç»„æˆï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸ç®¡åšä»€ä¹ˆèœï¼Œè¿™ä¸ªæµç¨‹éƒ½æ˜¯ä¸ä¼šå˜çš„ã€‚è€Œæƒ³è¦ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œè‡ªç„¶å°±æ˜¯è¦æ·±å…¥æ¯ä¸€æ­¥ä¹‹ä¸­äº†ã€‚è¿™æ ·ä¸ç®¡å†…éƒ¨å¦‚ä½•é‡æ„ã€ä¼˜åŒ–ï¼Œæ•´ä½“çš„æµç¨‹å¹¶ä¸ä¼šå˜ï¼Œè¿™å°±æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„å¥½å¤„ã€‚ï¼‰ç”šè‡³å¯ä»¥æŠŠä¸€ç§ç®—æ³•æ¢æˆå¦ä¸€ç§æ›´é«˜æ•ˆçš„ç®—æ³•ï¼ŒåŒæ—¶è¿˜åŸºæœ¬ä¸éœ€è¦ä¿®æ”¹ä»£ç ï¼ˆæ¯”å¦‚æŠŠåŠæ—©æ±‚å€¼ç­–ç•¥ï¼ˆeager evaluationï¼‰æ›¿æ¢ä¸ºæƒ°æ€§æ±‚å€¼ç­–ç•¥ï¼ˆlazy evaluationï¼‰ï¼‰ã€‚</p><p>åˆ©ç”¨çº¯å‡½æ•°è¿›è¡Œçš„è®¡ç®—ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°<em>æ‰©å±•åˆ°å¤šå¤„ç†å™¨ç¯å¢ƒä¸‹</em>ï¼Œæˆ–è€…<em>åº”ç”¨åˆ°åˆ†å¸ƒå¼è®¡ç®—é›†ç¾¤ä¸Š</em>ï¼ŒåŒæ—¶è¿˜<em>ä¸ç”¨æ‹…å¿ƒçº¿ç¨‹èµ„æºå†²çªã€ç«äº‰æ¡ä»¶</em>ä¹‹ç±»çš„é—®é¢˜ã€‚</p><p><strong>å‡½æ•°å¼ç¼–ç¨‹çš„ä¸è¶³</strong>ï¼šä»£ç å¦‚æœè¿‡åº¦åˆ©ç”¨äº†å‡½æ•°å¼çš„ç¼–ç¨‹ç‰¹æ€§ï¼ˆå¦‚æ— å‚é£æ ¼ã€å¤§é‡æ–¹æ³•çš„ç»„åˆï¼‰ï¼Œå°±ä¼šå½±å“å…¶å¯è¯»æ€§ï¼Œä»è€Œç®€æ´åº¦æœ‰ä½™ã€æ˜“è¯»æ€§ä¸è¶³ã€‚</p><p>å¤§éƒ¨åˆ†å·¥ç¨‹å¸ˆè¿˜æ˜¯æ›´ç†Ÿæ‚‰é¢å‘å¯¹è±¡ç¼–ç¨‹ã€å‘½ä»¤å¼ç¼–ç¨‹ï¼Œå¯¹äºåˆšæ¥è§¦å‡½æ•°å¼ç¼–ç¨‹çš„äººæ¥è¯´ï¼Œå³ä½¿åªæ˜¯è¿™ä¸ªé¢†åŸŸçš„ä¸€äº›çš„ç®€å•æœ¯è¯­ï¼Œéƒ½å¯èƒ½è®©ä»–æ€€ç–‘äººç”Ÿã€‚</p><p>å‡½æ•°å¼ç¼–ç¨‹çš„å­¦ä¹ æ›²çº¿æ›´é™¡å³­ï¼Œå› ä¸ºé¢å‘å¯¹è±¡ç¼–ç¨‹å¤ªæ™®åŠäº†ï¼Œå­¦ä¹ èµ„æ–™å¤ªå¤šäº†ã€‚ç›¸æ¯”è€Œè¨€ï¼Œå‡½æ•°å¼ç¼–ç¨‹åœ¨å­¦æœ¯é¢†åŸŸçš„åº”ç”¨æ›´å¹¿æ³›ä¸€äº›ï¼Œåœ¨å·¥ä¸šç•Œçš„åº”ç”¨ç¨é€Šä¸€ç­¹ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸é‚£ä¹ˆâ€œå¹³æ˜“è¿‘äººâ€äº†ã€‚åœ¨æ¢è®¨å‡½æ•°å¼ç¼–ç¨‹æ—¶ï¼Œäººä»¬å¾€å¾€ç”¨ Î» æ¼”ç®—ã€ä»£æ•°ã€èŒƒç•´å­¦ç­‰å­¦ç§‘çš„ä¸“ä¸šæœ¯è¯­å’Œä¸“ä¸šç¬¦å·æ¥æè¿°ç›¸å…³çš„æ¦‚å¿µï¼Œé‚£ä¹ˆå…¶ä»–äººæƒ³è¦å…¥é—¨å‡½æ•°å¼ç¼–ç¨‹çš„è¯ï¼Œå°±å¾—å…ˆæŠŠè¿™äº›é¢†åŸŸçš„åŸºç¡€çŸ¥è¯†ææ˜ç™½ï¼Œèƒ½ä¸è®©äººå¤´å¤§ä¹ˆã€‚</p><h3 id="é¢è¯•åŠ åˆ†é¡¹-3"><a href="#é¢è¯•åŠ åˆ†é¡¹-3" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>å…±äº«çŠ¶æ€çš„ç¼ºç‚¹ã€èµ„æºç«äº‰ã€ç­‰ç­‰ï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰</li><li>å‡½æ•°å¼ç¼–ç¨‹èƒ½å¤Ÿæå¤§åœ°ç®€åŒ–åº”ç”¨å¼€å‘</li><li>é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹å­¦ä¹ æ›²çº¿çš„ä¸åŒ</li><li>ä¸¤ç§ç¼–ç¨‹æ–¹å¼å„è‡ªçš„ä¸è¶³ä¹‹å¤„ï¼Œä»¥åŠå¯¹ä»£ç åæœŸç»´æŠ¤å¸¦æ¥çš„å½±å“</li><li>å‡½æ•°å¼é£æ ¼çš„ä»£ç åº“ï¼Œå­¦ä¹ æ›²çº¿ä¼šå¾ˆé™¡å³­</li><li>é¢å‘å¯¹è±¡ç¼–ç¨‹é£æ ¼çš„ä»£ç åº“ï¼Œä¿®æ”¹èµ·æ¥å¾ˆéš¾ï¼Œå¾ˆå®¹æ˜“å‡ºé—®é¢˜ï¼ˆå’Œæ°´å¹³ç›¸å½“çš„å‡½æ•°å¼é£æ ¼çš„ä»£ç ç›¸æ¯”ï¼‰</li><li><code>ä¸å¯å˜æ€§</code>ï¼ˆimmutabilityï¼‰ï¼Œèƒ½å¤Ÿæå¤§åœ°æå‡ç¨‹åºå†å²çŠ¶æ€ï¼ˆprogram state historyï¼‰çš„å¯è§æ€§ï¼ˆaccessibleï¼‰å’Œæ‰©å±•æ€§ï¼ˆmalleableï¼‰ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæƒ³è¦æ·»åŠ è¯¸å¦‚æ— é™æ’¤é”€/é‡åšã€å€’å¸¦/å›æ”¾ã€å¯åé€€çš„è°ƒè¯•ä¹‹ç±»çš„åŠŸèƒ½çš„è¯ï¼Œå°±ç®€å•å¤šäº†ã€‚ä¸ç®¡æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹è¿˜æ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼Œè¿™ä¸¤ç§èŒƒå¼éƒ½èƒ½å®ç°ä¸å¯å˜æ€§ï¼Œä½†æ˜¯è¦ç”¨é¢å‘å¯¹è±¡æ¥å®ç°çš„è¯ï¼Œå…±äº«çŠ¶æ€å¯¹è±¡çš„æ•°é‡å°±ä¼šå‰§å¢ï¼Œä»£ç ä¹Ÿä¼šå˜å¾—å¤æ‚å¾ˆå¤šã€‚</li></ul><h3 id="é¢è¯•å‡åˆ†é¡¹-3"><a href="#é¢è¯•å‡åˆ†é¡¹-3" class="headerlink" title="é¢è¯•å‡åˆ†é¡¹"></a>é¢è¯•å‡åˆ†é¡¹</h3><p>æ²¡æœ‰è®²è¿™ä¸¤ç§ç¼–ç¨‹èŒƒå¼çš„ç¼ºç‚¹â€”â€”å¦‚æœç†Ÿæ‚‰è‡³å°‘å…¶ä¸­ä¸€ç§èŒƒå¼çš„è¯ï¼Œåº”è¯¥èƒ½å¤Ÿè¯´å‡ºå¾ˆå¤šè¿™ç§èŒƒå¼çš„ç¼ºç‚¹å§ã€‚</p><h2 id="ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ç±»ç»§æ‰¿ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ç±»ç»§æ‰¿ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ç±»ç»§æ‰¿ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ç±»ç»§æ‰¿ï¼Ÿ</h2><p>åƒä¸‡åˆ«ç”¨ç±»ç»§æ‰¿ï¼æˆ–è€…è¯´å°½é‡åˆ«ç”¨ã€‚å¦‚æœéè¦ç”¨ï¼Œå°±åªç”¨å®ƒç»§æ‰¿ä¸€çº§ï¼ˆone levelï¼‰å°±å¥½äº†ï¼Œå¤šçº§çš„ç±»ç»§æ‰¿ç®€ç›´å°±æ˜¯åæ¨¡å¼çš„ã€‚è¿™ä¸ªè¯é¢˜ï¼ˆä¸å¤ªæ˜ç™½æ˜¯å…³äºä»€ä¹ˆçš„â€¦â€¦ï¼‰æˆ‘ä¹Ÿå‚ä¸è®¨è®ºè¿‡å¥½äº›å¹´äº†ï¼Œä»…æœ‰çš„ä¸€äº›å›ç­”æœ€ç»ˆä¹Ÿæ²¦ä¸º å¸¸è§çš„è¯¯è§£ ä¹‹ä¸€ã€‚æ›´å¤šçš„æ—¶å€™ï¼Œè¿™ä¸ªè¯é¢˜è®¨è®ºç€è®¨è®ºç€å°±æ²¡åŠ¨é™äº†ã€‚</p><blockquote><p>å¦‚æœä¸€ä¸ªç‰¹æ€§æœ‰æ—¶å€™å¾ˆæœ‰ç”¨<br>ä½†æœ‰æ—¶å€™åˆå¾ˆå±é™©<br>å¹¶ä¸”è¿˜æœ‰å¦ä¸€ç§æ›´å¥½çš„ç‰¹æ€§å¯ä»¥ç”¨<br>é‚£åŠ¡å¿…è¦ç”¨å¦ä¸€ç§æ›´å¥½çš„ç‰¹æ€§<br>~ Douglas Crockford</p></blockquote><h3 id="é¢è¯•åŠ åˆ†é¡¹-4"><a href="#é¢è¯•åŠ åˆ†é¡¹-4" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>å°½é‡åˆ«ç”¨ï¼Œç”šè‡³æ˜¯å½»åº•ä¸ç”¨ç±»ç»§æ‰¿ã€‚</li><li>æœ‰æ—¶å€™åªç»§æ‰¿ä¸€çº§çš„è¯ä¹Ÿè¿˜æ˜¯ OK çš„ï¼Œæ¯”å¦‚ä»æ¡†æ¶çš„åŸºç±»ç»§æ‰¿ï¼Œä¾‹å¦‚ React.Componentã€‚</li><li>ç›¸æ¯”ç±»ç»§æ‰¿ï¼Œå¯¹è±¡ç»„åˆï¼ˆobject compositionï¼‰æ›´å¥½ä¸€äº›ã€‚</li></ul><h2 id="ä»€ä¹ˆæ—¶å€™è¯¥ç”¨åŸå‹ç»§æ‰¿ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™è¯¥ç”¨åŸå‹ç»§æ‰¿ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™è¯¥ç”¨åŸå‹ç»§æ‰¿ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™è¯¥ç”¨åŸå‹ç»§æ‰¿ï¼Ÿ</h2><p>åŸå‹ç»§æ‰¿å¯ä»¥åˆ†ä¸ºä¸‹é¢å‡ ç±»ï¼š</p><ul><li>å§”æ‰˜ï¼ˆdelegationï¼Œä¹Ÿå°±æ˜¯åŸå‹é“¾ï¼‰</li><li>ç»„åˆï¼ˆconcatenativeï¼Œæ¯”å¦‚æ··ç”¨ï¼ˆmixinsï¼‰ã€Object.assign()ï¼‰</li><li>å‡½æ•°å¼ï¼ˆfunctionalï¼Œè¿™ä¸ªå‡½æ•°å¼åŸå‹ç»§æ‰¿ä¸æ˜¯å‡½æ•°å¼ç¼–ç¨‹ã€‚è¿™é‡Œçš„å‡½æ•°æ˜¯ç”¨æ¥åˆ›å»ºä¸€ä¸ªé—­åŒ…ï¼Œä»¥å®ç°ç§æœ‰çŠ¶æ€ï¼ˆprivate stateï¼‰æˆ–è€…å°è£…ï¼ˆencapsulationï¼‰ï¼‰</li></ul><p>ä¸Šé¢è¿™ä¸‰ç§åŸå‹ç»§æ‰¿éƒ½æœ‰å„è‡ªçš„é€‚ç”¨åœºæ™¯ï¼Œä¸è¿‡å®ƒä»¬éƒ½å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºéƒ½èƒ½å®ç°ç»„åˆç»§æ‰¿ï¼ˆcompositionï¼‰ï¼Œä¹Ÿå°±æ˜¯å»ºç«‹äº† A æ‹¥æœ‰ç‰¹æ€§ Bï¼ˆhas-aï¼‰ã€A ç”¨åˆ°äº†ç‰¹æ€§ Bï¼ˆuses-aï¼‰ æˆ–è€… A å¯ä»¥å®ç°ç‰¹æ€§ Bï¼ˆcan-doï¼‰ çš„è¿™æ ·ä¸€ç§å…³ç³»ã€‚ç›¸æ¯”è€Œè¨€ï¼Œç±»ç»§æ‰¿å»ºç«‹çš„æ˜¯ A å°±æ˜¯ B è¿™æ ·ä¸€ç§å…³ç³»ã€‚</p><h3 id="é¢è¯•åŠ åˆ†é¡¹-5"><a href="#é¢è¯•åŠ åˆ†é¡¹-5" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>çŸ¥é“åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¸é€‚åˆç”¨æ¨¡å—åŒ–ï¼ˆmodulesï¼‰æˆ–è€…å‡½æ•°å¼ç¼–ç¨‹ã€‚</li><li>çŸ¥é“éœ€è¦ç»„åˆå¤šä¸ªä¸åŒæ¥æºçš„å¯¹è±¡æ—¶ï¼Œåº”è¯¥æ€ä¹ˆåšã€‚</li><li>çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ç»§æ‰¿ã€‚</li></ul><h3 id="é¢è¯•å‡åˆ†é¡¹-4"><a href="#é¢è¯•å‡åˆ†é¡¹-4" class="headerlink" title="é¢è¯•å‡åˆ†é¡¹"></a>é¢è¯•å‡åˆ†é¡¹</h3><ul><li>ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨åŸå‹ã€‚</li><li>ä¸çŸ¥é“æ··ç”¨å’Œ Object.assign()ã€‚</li></ul><h2 id="ä¸ºä»€ä¹ˆè¯´â€œå¯¹è±¡ç»„åˆæ¯”ç±»ç»§æ‰¿æ›´å¥½â€ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¯´â€œå¯¹è±¡ç»„åˆæ¯”ç±»ç»§æ‰¿æ›´å¥½â€ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¯´â€œå¯¹è±¡ç»„åˆæ¯”ç±»ç»§æ‰¿æ›´å¥½â€ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¯´â€œå¯¹è±¡ç»„åˆæ¯”ç±»ç»§æ‰¿æ›´å¥½â€ï¼Ÿ</h2><p>è¿™å¥è¯å¼•ç”¨çš„æ˜¯ã€Šè®¾è®¡èŠ±çº¹ã€‹ï¼ˆDesign Patternsï¼Œè®¾è®¡æ¨¡å¼ï¼‰è¿™æœ¬ä¹¦çš„å†…å®¹ã€‚æ„æ€æ˜¯è¦æƒ³å®ç°ä»£ç é‡ç”¨ï¼Œå°±åº”è¯¥æŠŠä¸€å †å°çš„åŠŸèƒ½å•å…ƒç»„åˆæˆæ»¡è¶³éœ€æ±‚çš„å„ç§å¯¹è±¡ï¼Œè€Œä¸æ˜¯é€šè¿‡ç±»ç»§æ‰¿å¼„å‡ºæ¥ä¸€å±‚ä¸€å±‚çš„å¯¹è±¡ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå°±æ˜¯å°½é‡ç¼–ç¨‹å®ç° <code>can-do</code>ã€<code>has-a</code> æˆ–è€… <code>uses-a</code> è¿™ç§å…³ç³»ï¼Œè€Œä¸æ˜¯ is-a è¿™ç§å…³ç³»ã€‚</p><h3 id="é¢è¯•åŠ åˆ†é¡¹-6"><a href="#é¢è¯•åŠ åˆ†é¡¹-6" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>é¿å…ä½¿ç”¨ç±»ç»§æ‰¿ã€‚</li><li>é¿å…ä½¿ç”¨é—®é¢˜å¤šå¤šçš„åŸºç±»ã€‚</li><li>é¿å…ç´§è€¦åˆã€‚</li><li>é¿å…æå…¶ä¸çµæ´»çš„å±‚æ¬¡åˆ†ç±»ï¼ˆtaxonomyï¼‰ï¼ˆç±»ç»§æ‰¿æ‰€äº§ç”Ÿçš„ is-a å…³ç³»å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šè¯¯ç”¨çš„æƒ…å†µï¼‰</li><li>é¿å…å¤§çŒ©çŒ©é¦™è•‰é—®é¢˜ï¼ˆâ€œä½ åªæ˜¯æƒ³è¦ä¸€æ ¹é¦™è•‰ï¼Œç»“æœæœ€åå´æ•´å‡ºæ¥ä¸€åªæ‹¿ç€é¦™è•‰çš„å¤§çŒ©çŒ©ï¼Œè¿˜æœ‰æ•´ä¸ªä¸›æ—â€ï¼‰ã€‚</li><li>è¦è®©ä»£ç æ›´å…·æ‰©å±•æ€§ã€‚</li></ul><h3 id="é¢è¯•å‡åˆ†é¡¹-5"><a href="#é¢è¯•å‡åˆ†é¡¹-5" class="headerlink" title="é¢è¯•å‡åˆ†é¡¹"></a>é¢è¯•å‡åˆ†é¡¹</h3><ul><li>æ²¡æœ‰æåˆ°ä¸Šé¢ä»»ä½•ä¸€ç§é—®é¢˜ã€‚</li><li>æ²¡æœ‰è¡¨è¾¾æ¸…æ¥šå¯¹è±¡ç»„åˆä¸ç±»ç»§æ‰¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¹Ÿæ²¡æœ‰æåˆ°å¯¹è±¡ç»„åˆçš„ä¼˜ç‚¹ã€‚</li></ul><h2 id="åŒå‘æ•°æ®ç»‘å®š-å•å‘æ•°æ®æµçš„å«ä¹‰å’ŒåŒºåˆ«"><a href="#åŒå‘æ•°æ®ç»‘å®š-å•å‘æ•°æ®æµçš„å«ä¹‰å’ŒåŒºåˆ«" class="headerlink" title="åŒå‘æ•°æ®ç»‘å®š/å•å‘æ•°æ®æµçš„å«ä¹‰å’ŒåŒºåˆ«"></a>åŒå‘æ•°æ®ç»‘å®š/å•å‘æ•°æ®æµçš„å«ä¹‰å’ŒåŒºåˆ«</h2><p><strong>åŒå‘æ•°æ®ç»‘å®šï¼ˆtwo-way data bindingï¼‰</strong>ï¼Œæ„å‘³ç€ UI å±‚æ‰€å‘ˆç°çš„å†…å®¹å’Œ Model å±‚çš„æ•°æ®åŠ¨æ€åœ°ç»‘å®šåœ¨ä¸€èµ·äº†ï¼Œå…¶ä¸­ä¸€ä¸ªå‘ç”Ÿäº†å˜åŒ–ï¼Œå°±ä¼šç«‹åˆ»åæ˜ åœ¨å¦ä¸€ä¸ªä¸Šã€‚æ¯”å¦‚ç”¨æˆ·åœ¨å‰ç«¯é¡µé¢çš„è¡¨å•æ§ä»¶ä¸­è¾“å…¥äº†ä¸€ä¸ªå€¼ï¼ŒModel å±‚å¯¹åº”è¯¥æ§ä»¶çš„å˜é‡å°±ä¼šç«‹åˆ»æ›´æ–°ä¸ºç”¨æˆ·æ‰€è¾“å…¥çš„å€¼ï¼›åä¹‹äº¦ç„¶ï¼Œå¦‚æœ Modal å±‚çš„æ•°æ®æœ‰å˜åŒ–ï¼Œå˜åŒ–åçš„æ•°æ®ä¹Ÿä¼šç«‹åˆ»åæ˜ è‡³ UI å±‚ã€‚</p><p><strong>å•å‘æ•°æ®æµï¼ˆone-way data flowï¼‰</strong>ï¼Œ æ„å‘³ç€åªæœ‰ Model å±‚æ‰æ˜¯å•ä¸€æ•°æ®æºï¼ˆsingle source of truthï¼‰ã€‚UI å±‚çš„å˜åŒ–ä¼šè§¦å‘å¯¹åº”çš„æ¶ˆæ¯æœºåˆ¶ï¼Œå‘ŠçŸ¥ Model å±‚ç”¨æˆ·çš„ç›®çš„ï¼ˆå¯¹åº” React çš„ storeï¼‰ã€‚åªæœ‰ Model å±‚æ‰æœ‰æ›´æ”¹åº”ç”¨çŠ¶æ€çš„æƒé™ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ•°æ®æ°¸è¿œéƒ½æ˜¯å•å‘æµåŠ¨çš„ï¼Œä¹Ÿå°±æ›´å®¹æ˜“äº†è§£åº”ç”¨çš„çŠ¶æ€æ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚</p><p>é‡‡ç”¨å•å‘æ•°æ®æµçš„åº”ç”¨ï¼Œå…¶çŠ¶æ€çš„å˜åŒ–æ˜¯å¾ˆå®¹æ˜“è·Ÿè¸ªçš„ï¼Œé‡‡ç”¨åŒå‘æ•°æ®ç»‘å®šçš„åº”ç”¨ï¼Œå°±å¾ˆéš¾è·Ÿè¸ªå¹¶ç†è§£çŠ¶æ€çš„å˜åŒ–äº†ã€‚</p><h3 id="é¢è¯•åŠ åˆ†é¡¹-7"><a href="#é¢è¯•åŠ åˆ†é¡¹-7" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>React æ˜¯å•å‘æ•°æ®æµçš„å…¸å‹ï¼Œé¢è¯•æ—¶æåˆ°è¿™ä¸ªæ¡†æ¶çš„è¯ä¼šåŠ åˆ†ã€‚Cycle.js åˆ™æ˜¯å¦ä¸€ä¸ªå¾ˆæµè¡Œçš„å•å‘æ•°æ®æµçš„åº“ã€‚</li><li>Angular åˆ™æ˜¯åŒå‘æ•°æ®ç»‘å®šçš„å…¸å‹ã€‚</li></ul><h2 id="å•ä½“æ¶æ„å’Œå¾®æœåŠ¡æ¶æ„å„æœ‰ä½•ä¼˜åŠ£ï¼Ÿ"><a href="#å•ä½“æ¶æ„å’Œå¾®æœåŠ¡æ¶æ„å„æœ‰ä½•ä¼˜åŠ£ï¼Ÿ" class="headerlink" title="å•ä½“æ¶æ„å’Œå¾®æœåŠ¡æ¶æ„å„æœ‰ä½•ä¼˜åŠ£ï¼Ÿ"></a>å•ä½“æ¶æ„å’Œå¾®æœåŠ¡æ¶æ„å„æœ‰ä½•ä¼˜åŠ£ï¼Ÿ</h2><p><code>é‡‡ç”¨å•ä½“æ¶æ„</code>ï¼ˆmonolithic architectureï¼‰çš„åº”ç”¨ï¼Œå„ç»„ä»¶çš„ä»£ç æ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“å­˜åœ¨çš„ï¼Œç»„ä»¶ä¹‹é—´äº’ç›¸åˆä½œï¼Œå…±äº«å†…å­˜å’Œèµ„æºã€‚</p><p>è€Œ<code>å¾®æœåŠ¡æ¶æ„</code>ï¼ˆmicroservice architectureï¼‰åˆ™æ˜¯ç”±è®¸è®¸å¤šå¤šä¸ªäº’ç›¸ç‹¬ç«‹çš„å°åº”ç”¨ç»„æˆï¼Œæ¯ä¸ªåº”ç”¨éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œåº”ç”¨åœ¨æ‰©å®¹æ—¶ä¹Ÿæ˜¯ç‹¬ç«‹äºå…¶å®ƒåº”ç”¨è¿›è¡Œçš„ã€‚</p><p><code>å•ä½“æ¶æ„çš„ä¼˜åŠ¿</code>ï¼šå¤§éƒ¨åˆ†åº”ç”¨éƒ½æœ‰ç›¸å½“æ•°é‡çš„æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆcross-cutting concernsï¼‰ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ï¼Œæµé‡é™åˆ¶ï¼Œè¿˜æœ‰å®¡è®¡è·Ÿè¸ªå’Œ DOS é˜²æŠ¤ç­‰å®‰å…¨æ–¹é¢çš„éœ€æ±‚ï¼Œå•ä½“æ¶æ„åœ¨è¿™æ–¹é¢å°±å¾ˆæœ‰ä¼˜åŠ¿ã€‚</p><p>å½“æ‰€æœ‰åŠŸèƒ½éƒ½è¿è¡Œåœ¨ä¸€ä¸ªåº”ç”¨é‡Œçš„æ—¶å€™ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†ç»„ä»¶ä¸æ¨ªåˆ‡å…³æ³¨ç‚¹ç›¸å…³è”ã€‚</p><p>å•ä½“æ¶æ„ä¹Ÿæœ‰æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ï¼Œæ¯•ç«Ÿè®¿é—®å…±äº«å†…å­˜è¿˜æ˜¯æ¯”è¿›ç¨‹é—´é€šä¿¡ï¼ˆinter-process communicationï¼ŒIPCï¼‰è¦å¿«çš„ã€‚</p><p><code>å•ä½“æ¶æ„çš„åŠ£åŠ¿</code>ï¼šéšç€å•ä½“æ¶æ„åº”ç”¨åŠŸèƒ½çš„ä¸æ–­å¼€å‘ï¼Œå„é¡¹æœåŠ¡ä¹‹é—´çš„è€¦åˆç¨‹åº¦ä¹Ÿä¼šä¸æ–­å¢åŠ ï¼Œè¿™æ ·ä¸€æ¥å°±å¾ˆéš¾æŠŠå„é¡¹æœåŠ¡åˆ†ç¦»å¼€æ¥äº†ï¼Œè¦åšç‹¬ç«‹æ‰©å®¹æˆ–è€…ä»£ç ç»´æŠ¤ä¹Ÿå°±æ›´ä¸æ–¹ä¾¿äº†ã€‚</p><p><code>å¾®æœåŠ¡çš„ä¼˜åŠ¿</code>ï¼šå¾®æœåŠ¡æ¶æ„ä¸€èˆ¬éƒ½æœ‰æ›´å¥½çš„ç»„ç»‡ç»“æ„ï¼Œå› ä¸ºæ¯é¡¹æœåŠ¡éƒ½æœ‰è‡ªå·±ç‰¹å®šçš„åˆ†å·¥ï¼Œè€Œä¸”ä¹Ÿä¸ä¼šå¹²æ¶‰å…¶å®ƒç»„ä»¶æ‰€è´Ÿè´£çš„éƒ¨åˆ†ã€‚æœåŠ¡è§£è€¦ä¹‹åï¼Œæƒ³è¦é‡æ–°ç»„åˆã€é…ç½®æ¥ä¸ºå„ä¸ªä¸åŒçš„åº”ç”¨æä¾›æœåŠ¡çš„è¯ï¼Œä¹Ÿæ›´æ–¹ä¾¿äº†ï¼ˆæ¯”å¦‚åŒæ—¶ä¸º Web å®¢æˆ·ç«¯å’Œå…¬å…± API æä¾›æœåŠ¡ï¼‰ã€‚</p><p>å¦‚æœç”¨åˆç†çš„æ¶æ„æ¥éƒ¨ç½²å¾®æœåŠ¡çš„è¯ï¼Œå®ƒåœ¨æ€§èƒ½ä¸Šä¹Ÿæ˜¯å¾ˆæœ‰ä¼˜åŠ¿çš„ï¼Œå› ä¸ºè¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥å¾ˆè½»æ¾åœ°åˆ†ç¦»çƒ­é—¨æœåŠ¡ï¼Œå¯¹å…¶è¿›è¡Œæ‰©å®¹ï¼ŒåŒæ—¶è¿˜ä¸ä¼šå½±å“åˆ°åº”ç”¨ä¸­çš„å…¶å®ƒéƒ¨åˆ†ã€‚</p><p><code>å¾®æœåŠ¡çš„åŠ£åŠ¿</code>ï¼šåœ¨å®é™…æ„å»ºä¸€ä¸ªæ–°çš„å¾®æœåŠ¡æ¶æ„çš„æ—¶å€™ï¼Œä¼šé‡åˆ°å¾ˆå¤šåœ¨è®¾è®¡é˜¶æ®µæ²¡æœ‰é¢„æ–™åˆ°çš„æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚å¦‚æœæ˜¯å•ä½“æ¶æ„åº”ç”¨çš„è¯å°±å¾ˆç®€å•ï¼Œæ–°å»ºä¸€ä¸ªä¸­é—´ä»¶ï¼ˆshared magic helpers ä¸çŸ¥é“æ€ä¹ˆç¿»è¯‘â€¦â€¦ï¼‰æ¥è§£å†³è¿™æ ·çš„é—®é¢˜å°±è¡Œäº†ï¼Œæ²¡ä»€ä¹ˆéº»çƒ¦çš„ã€‚</p><p>ä½†æ˜¯åœ¨å¾®æœåŠ¡æ¶æ„ä¸­å°±ä¸ä¸€æ ·äº†ï¼Œè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¦ä¹ˆä¸ºæ¯ä¸ªæ¨ªåˆ‡å…³æ³¨ç‚¹éƒ½å¼•å…¥ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œè¦ä¹ˆå°±æŠŠæ‰€æœ‰æ¨ªåˆ‡å…³æ³¨ç‚¹çš„è§£å†³æ–¹æ¡ˆå°è£…åˆ°ä¸€ä¸ªæœåŠ¡å±‚ä¸­ï¼Œè®©æ‰€æœ‰æµé‡éƒ½ä»è¿™é‡Œèµ°ä¸€éå°±è¡Œäº†ã€‚</p><p>ä¸ºäº†è§£å†³æ¨ªåˆ‡å…³æ³¨ç‚¹çš„é—®é¢˜ï¼Œè™½ç„¶å•ä½“æ¶æ„ä¹Ÿè¶‹å‘äºæŠŠæ‰€æœ‰çš„è·¯ç”±æµé‡éƒ½ä»ä¸€ä¸ªå¤–éƒ¨æœåŠ¡å±‚èµ°ä¸€éï¼Œä½†æ˜¯åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œå¯ä»¥ç­‰åˆ°é¡¹ç›®éå¸¸æˆç†Ÿä¹‹åå†è¿›è¡Œè¿™ç§æ”¹é€ ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠè¿˜è¿™ç¬”æŠ€æœ¯å€ºçš„æ—¶é—´å°½é‡å¾€åæ‹–ä¸€æ‹–ã€‚</p><p>å¾®æœåŠ¡ä¸€èˆ¬éƒ½æ˜¯éƒ¨ç½²åœ¨è™šæ‹Ÿæœºæˆ–å®¹å™¨ä¸Šçš„ï¼Œéšç€åº”ç”¨è§„æ¨¡çš„ä¸æ–­å¢åŠ ï¼Œè™šæ‹ŸæœºæŠ¢å·¥ä½œï¼ˆVM wrangling workï¼‰çš„æƒ…å†µä¹Ÿä¼šè¿…é€Ÿå¢åŠ ã€‚ä»»åŠ¡çš„åˆ†é…ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡å®¹å™¨ç¾¤ï¼ˆcontainer fleetï¼‰ç®¡ç†å·¥å…·æ¥è‡ªåŠ¨å®ç°çš„ã€‚</p><h3 id="é¢è¯•åŠ åˆ†é¡¹-8"><a href="#é¢è¯•åŠ åˆ†é¡¹-8" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>å¯¹äºå¾®æœåŠ¡çš„ç§¯ææ€åº¦ï¼Œè™½ç„¶åˆå§‹æˆæœ¬ä¼šæ¯”å•ä½“æ¶æ„è¦é«˜ä¸€äº›ã€‚çŸ¥é“å¾®æœåŠ¡çš„æ€§èƒ½å’Œæ‰©å®¹åœ¨é•¿æœŸçœ‹æ¥è¡¨ç°æ›´ä½³ã€‚</li><li>åœ¨å¾®æœåŠ¡æ¶æ„å’Œå•ä½“æ¶æ„åº”ç”¨ä¸Šéƒ½æœ‰å®æˆ˜ç»éªŒã€‚èƒ½å¤Ÿä½¿åº”ç”¨ä¸­çš„å„é¡¹æœåŠ¡åœ¨ä»£ç å±‚é¢äº’ç›¸ç‹¬ç«‹ï¼Œä½†æ˜¯åˆå¯ä»¥åœ¨å¼€å‘åˆæœŸè¿…é€Ÿåœ°å°†å„é¡¹æœåŠ¡æ‰“åŒ…æˆä¸€æ•´ä¸ªçš„å•ä½“æ¶æ„åº”ç”¨ã€‚å¾®æœåŠ¡åŒ–çš„æ”¹é€ å¯ä»¥åœ¨åº”ç”¨ç›¸å½“æˆç†Ÿä¹‹åï¼Œæ”¹é€ æˆæœ¬åœ¨å¯æ‰¿å—èŒƒå›´å†…çš„æ—¶å€™å†è¿›è¡Œã€‚</li></ul><h3 id="é¢è¯•å‡åˆ†é¡¹-6"><a href="#é¢è¯•å‡åˆ†é¡¹-6" class="headerlink" title="é¢è¯•å‡åˆ†é¡¹"></a>é¢è¯•å‡åˆ†é¡¹</h3><ul><li>ä¸çŸ¥é“å•ä½“æ¶æ„å’Œå¾®æœåŠ¡æ¶æ„çš„åŒºåˆ«ã€‚</li><li>ä¸çŸ¥é“å¾®æœåŠ¡æ¶æ„é¢å¤–çš„å¼€é”€ï¼Œæˆ–è€…æ²¡æœ‰å®é™…ç»éªŒã€‚</li><li>ä¸çŸ¥é“å¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒIPC å’Œç½‘ç»œé€šä¿¡æ‰€å¯¼è‡´çš„é¢å¤–çš„æ€§èƒ½å¼€é”€ã€‚</li><li>è¿‡åˆ†è´¬ä½å¾®æœåŠ¡ã€‚è¯´ä¸æ¸…æ¥šä»€ä¹ˆæ—¶å€™åº”è¯¥æŠŠå•ä½“æ¶æ„åº”ç”¨è§£è€¦æˆå¾®æœåŠ¡ã€‚</li><li>ä½ä¼°äº†å¯ç‹¬ç«‹æ‰©å®¹çš„å¾®æœåŠ¡çš„ä¼˜åŠ¿ã€‚</li></ul><h2 id="å¼‚æ­¥ç¼–ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿåˆä¸ºä»€ä¹ˆåœ¨-JavaScript-ä¸­è¿™ä¹ˆé‡è¦ï¼Ÿ"><a href="#å¼‚æ­¥ç¼–ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿåˆä¸ºä»€ä¹ˆåœ¨-JavaScript-ä¸­è¿™ä¹ˆé‡è¦ï¼Ÿ" class="headerlink" title="å¼‚æ­¥ç¼–ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿåˆä¸ºä»€ä¹ˆåœ¨ JavaScript ä¸­è¿™ä¹ˆé‡è¦ï¼Ÿ"></a>å¼‚æ­¥ç¼–ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿåˆä¸ºä»€ä¹ˆåœ¨ JavaScript ä¸­è¿™ä¹ˆé‡è¦ï¼Ÿ</h2><p>åœ¨åŒæ­¥ç¼–ç¨‹ä¸­ï¼Œä»£ç ä¼šæŒ‰é¡ºåºè‡ªé¡¶å‘ä¸‹ä¾æ¬¡æ‰§è¡Œï¼ˆæ¡ä»¶è¯­å¥å’Œå‡½æ•°è°ƒç”¨é™¤å¤–ï¼‰ï¼Œå¦‚æœé‡åˆ°ç½‘ç»œè¯·æ±‚æˆ–è€…ç£ç›˜è¯»/å†™ï¼ˆI/Oï¼‰è¿™ç±»è€—æ—¶çš„ä»»åŠ¡ï¼Œå°±ä¼šå µå¡åœ¨è¿™æ ·çš„åœ°æ–¹ã€‚</p><p>åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼ŒJS è¿è¡Œåœ¨äº‹ä»¶å¾ªç¯ï¼ˆevent loopï¼‰ä¸­ã€‚å½“éœ€è¦æ‰§è¡Œä¸€ä¸ªé˜»å¡æ“ä½œï¼ˆblocking operationï¼‰æ—¶ï¼Œä¸»çº¿ç¨‹å‘èµ·ä¸€ä¸ªï¼ˆå¼‚æ­¥ï¼‰è¯·æ±‚ï¼Œï¼ˆå·¥ä½œçº¿ç¨‹å°±ä¼šå»æ‰§è¡Œè¿™ä¸ªå¼‚æ­¥æ“ä½œï¼Œï¼‰åŒæ—¶ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚ï¼ˆå·¥ä½œçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œï¼‰å°±ä¼šå‘èµ·å“åº”ï¼Œè§¦å‘ä¸­æ–­ï¼ˆinterruptï¼‰ï¼Œæ‰§è¡Œäº‹ä»¶å¤„ç†ç¨‹åºï¼ˆevent handlerï¼‰ï¼Œæ‰§è¡Œå®Œåä¸»çº¿ç¨‹ç»§ç»­å¾€åèµ°ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸€ä¸ªç¨‹åºçº¿ç¨‹å°±å¯ä»¥å¤„ç†å¤§é‡çš„å¹¶å‘æ“ä½œäº†ã€‚</p><p>ç”¨æˆ·ç•Œé¢ï¼ˆuser interfaceï¼ŒUIï¼‰å¤©ç„¶å°±æ˜¯å¼‚æ­¥çš„ï¼Œå¤§éƒ¨åˆ†æ—¶é—´å®ƒéƒ½åœ¨ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œä»è€Œä¸­æ–­äº‹ä»¶å¾ªç¯ï¼Œè§¦å‘äº‹ä»¶å¤„ç†ç¨‹åºã€‚</p><p>Node.js é»˜è®¤æ˜¯å¼‚æ­¥çš„ï¼Œé‡‡ç”¨å®ƒæ„å»ºçš„æœåŠ¡ç«¯å’Œç”¨æˆ·ç•Œé¢çš„æ‰§è¡Œæœºåˆ¶å·®ä¸å¤šï¼Œåœ¨äº‹ä»¶å¾ªç¯ä¸­ç­‰å¾…ç½‘ç»œè¯·æ±‚ï¼Œç„¶åä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å¤„ç†è¿™äº›è¯·æ±‚ã€‚</p><p>å¼‚æ­¥åœ¨ JavaScript ä¸­éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒæ—¢é€‚åˆç¼–å†™ UIï¼Œåœ¨æœåŠ¡ç«¯ä¹Ÿæœ‰ä¸Šä½³çš„æ€§èƒ½è¡¨ç°ã€‚</p><h3 id="é¢è¯•åŠ åˆ†é¡¹-9"><a href="#é¢è¯•åŠ åˆ†é¡¹-9" class="headerlink" title="é¢è¯•åŠ åˆ†é¡¹"></a>é¢è¯•åŠ åˆ†é¡¹</h3><ul><li>ç†è§£é˜»å¡çš„å«ä¹‰ï¼Œä»¥åŠå¯¹æ€§èƒ½å¸¦æ¥çš„å½±å“ã€‚</li><li>ç†è§£äº‹ä»¶å¤„ç†ç¨‹åºï¼Œä»¥åŠå®ƒä¸ºä»€ä¹ˆå¯¹ UI éƒ¨åˆ†çš„ä»£ç å¾ˆé‡è¦ã€‚</li></ul><h3 id="é¢è¯•å‡åˆ†é¡¹-7"><a href="#é¢è¯•å‡åˆ†é¡¹-7" class="headerlink" title="é¢è¯•å‡åˆ†é¡¹"></a>é¢è¯•å‡åˆ†é¡¹</h3><p>ä¸ç†Ÿæ‚‰åŒæ­¥ã€å¼‚æ­¥çš„æ¦‚å¿µã€‚<br>è®²ä¸æ¸…æ¥šå¼‚æ­¥ä»£ç å’Œ UI ä»£ç çš„æ€§èƒ½å½±å“ï¼Œä¹Ÿè¯´ä¸æ˜ç™½å®ƒä¿©ä¹‹é—´çš„å…³ç³»ã€‚</p><p><a href="https://segmentfault.com/a/1190000014143796" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Interview </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯å·¥ç¨‹ç²¾ç²¹ï¼ˆä¸€ï¼‰ï¼šé™æ€èµ„æºç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜</title>
      <link href="/2018/04/22/%E6%80%A7%E8%83%BD/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E7%B2%BE%E7%B2%B9%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0%E4%B8%8E%E7%BC%93%E5%AD%98/"/>
      <url>/2018/04/22/%E6%80%A7%E8%83%BD/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E7%B2%BE%E7%B2%B9%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0%E4%B8%8E%E7%BC%93%E5%AD%98/</url>
      
        <content type="html"><![CDATA[<p>æ¯ä¸ªå‚ä¸è¿‡å¼€å‘ä¼ä¸šçº§webåº”ç”¨çš„å‰ç«¯å·¥ç¨‹å¸ˆæˆ–è®¸éƒ½æ›¾æ€è€ƒè¿‡å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ–¹é¢çš„é—®é¢˜ã€‚æˆ‘ä»¬æœ‰é›…è™14æ¡æ€§èƒ½ä¼˜åŒ–åŸåˆ™ï¼Œè¿˜æœ‰ä¸¤æœ¬å¾ˆç»å…¸çš„æ€§èƒ½ä¼˜åŒ–æŒ‡å¯¼ä¹¦ï¼š<code>ã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾æŒ‡å—ã€‹</code>ã€<code>ã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾è¿›é˜¶æŒ‡å—ã€‹</code>ã€‚ç»éªŒä¸°å¯Œçš„å·¥ç¨‹å¸ˆå¯¹äºå‰ç«¯æ€§èƒ½ä¼˜åŒ–æ–¹æ³•è€³æ¿¡ç›®æŸ“ï¼ŒåŸºæœ¬éƒ½èƒ½ä¸€ä¸€åˆ—ä¸¾å‡ºæ¥ã€‚è¿™äº›æ€§èƒ½ä¼˜åŒ–åŸåˆ™å¤§æ¦‚æ˜¯åœ¨7å¹´å‰æå‡ºçš„ï¼Œå¯¹äºwebæ€§èƒ½ä¼˜åŒ–è‡³ä»Šéƒ½æœ‰éå¸¸é‡è¦çš„æŒ‡å¯¼æ„ä¹‰ã€‚</p><hr><p>ç„¶è€Œï¼Œå¯¹äºæ„å»ºå¤§å‹webåº”ç”¨çš„å›¢é˜Ÿæ¥è¯´ï¼Œè¦åšæŒè´¯å½»è¿™äº›ä¼˜åŒ–åŸåˆ™å¹¶ä¸æ˜¯ä¸€ä»¶ååˆ†å®¹æ˜“çš„äº‹ã€‚å› ä¸ºä¼˜åŒ–åŸåˆ™ä¸­å¾ˆå¤šè¦æ±‚æ˜¯ä¸å·¥ç¨‹ç®¡ç†ç›¸è¿èƒŒçš„ï¼Œæ¯”å¦‚â€œæŠŠcssæ”¾åœ¨å¤´éƒ¨â€å’Œâ€œæŠŠjsæ”¾åœ¨å°¾éƒ¨â€è¿™ä¸¤æ¡åŸåˆ™ï¼Œæˆ‘ä»¬ä¸èƒ½è®©å›¢é˜Ÿçš„å·¥ç¨‹å¸ˆåœ¨å†™æ ·å¼å’Œè„šæœ¬å¼•ç”¨çš„æ—¶å€™éƒ½å»ä¿®æ”¹ä¸€ä¸ªç›¸åŒçš„é¡µé¢æ–‡ä»¶ã€‚è¿™æ ·åšä¼šä¸¥é‡å½±å“å›¢é˜Ÿæˆå‘˜é—´å¹¶è¡Œå¼€å‘çš„æ•ˆç‡ï¼Œå°¤å…¶æ˜¯åœ¨å›¢é˜Ÿæœ‰ç‰ˆæœ¬ç®¡ç†çš„æƒ…å†µä¸‹ï¼Œæ¯å¤©è¦èŠ±å¤§é‡çš„æ—¶é—´è¿›è¡Œä»£ç ä¿®æ”¹åˆå¹¶ï¼Œè¿™é¡¹æˆæœ¬æ˜¯éš¾ä»¥æ¥å—çš„ã€‚å› æ­¤åœ¨å‰ç«¯å·¥ç¨‹ç•Œï¼Œæ€»ä¼šçœ‹åˆ°å‘¨æœŸæ€§çš„æ€§èƒ½ä¼˜åŒ–å·¥ä½œï¼Œè¾›å‹¤çš„å‰ç«¯å·¥ç¨‹å¸ˆä»¬æ¯åˆ°æœˆåœ†ä¹‹å¤œå°±ä¼šå€¾å·¢å‡ºåŠ¨æ ¹æ®ä¼˜åŒ–åŸåˆ™åšä¸€æ¬¡æ€§èƒ½ä¼˜åŒ–ã€‚</p><hr><p>æœ¬æ–‡ä»ä¸€ä¸ªå…¨æ–°çš„è§†è§’æ¥æ€è€ƒwebæ€§èƒ½ä¼˜åŒ–ä¸å‰ç«¯å·¥ç¨‹ä¹‹é—´çš„å…³ç³»ï¼Œé€šè¿‡è§£è¯»ç™¾åº¦å‰ç«¯é›†æˆè§£å†³æ–¹æ¡ˆå°ç»„ï¼ˆF.I.Sï¼‰åœ¨æ‰“é€ é«˜æ€§èƒ½å‰ç«¯æ¶æ„å¹¶ç»Ÿä¸€ç™¾åº¦40å¤šæ¡å‰ç«¯äº§å“çº¿çš„è¿‡ç¨‹ä¸­æ‰€ç»å†çš„æŠ€æœ¯å°è¯•ï¼Œæ­ç¤ºå‰ç«¯æ€§èƒ½ä¼˜åŒ–åœ¨å‰ç«¯æ¶æ„åŠå¼€å‘å·¥å…·è®¾è®¡å±‚é¢çš„å®ç°æ€è·¯ã€‚</p><h2 id="æ€§èƒ½ä¼˜åŒ–åŸåˆ™åŠåˆ†ç±»"><a href="#æ€§èƒ½ä¼˜åŒ–åŸåˆ™åŠåˆ†ç±»" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–åŸåˆ™åŠåˆ†ç±»"></a>æ€§èƒ½ä¼˜åŒ–åŸåˆ™åŠåˆ†ç±»</h2><p>ç¬”è€…å…ˆå‡è®¾æœ¬æ–‡çš„è¯»è€…æ˜¯æœ‰å‰ç«¯å¼€å‘ç»éªŒçš„å·¥ç¨‹å¸ˆï¼Œå¹¶å¯¹ä¼ä¸šçº§webåº”ç”¨å¼€å‘åŠæ€§èƒ½ä¼˜åŒ–æœ‰ä¸€å®šçš„æ€è€ƒï¼Œå› æ­¤æˆ‘ä¸ä¼šé‡å¤ä»‹ç»é›…è™14æ¡æ€§èƒ½ä¼˜åŒ–åŸåˆ™ã€‚å¦‚æœæ‚¨æ²¡æœ‰è¿™äº›å‰ç»­çŸ¥è¯†ï¼Œè¯·ç§»æ­¥<a href="https://developer.yahoo.com/performance/rules.html" target="_blank" rel="noopener">è¿™é‡Œ</a>æ¥å­¦ä¹ ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠé›…è™14æ¡ä¼˜åŒ–åŸåˆ™ï¼Œã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾æŒ‡å—ã€‹ä»¥åŠã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾è¿›é˜¶æŒ‡å—ã€‹ä¸­æåˆ°çš„ä¼˜åŒ–ç‚¹åšä¸€æ¬¡æ¢³ç†ï¼ŒæŒ‰ç…§ä¼˜åŒ–æ–¹å‘åˆ†ç±»ï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€å¼ è¡¨æ ¼ï¼š</p><a id="more"></a><table><thead><tr><th>ä¼˜åŒ–æ–¹å‘</th><th style="text-align:right">ä¼˜åŒ–æ‰‹æ®µ  </th></tr></thead><tbody><tr><td>è¯·æ±‚æ•°é‡</td><td style="text-align:right">åˆå¹¶è„šæœ¬å’Œæ ·å¼è¡¨ï¼ŒCSS Spritesï¼Œæ‹†åˆ†åˆå§‹åŒ–è´Ÿè½½ï¼Œåˆ’åˆ†ä¸»åŸŸ </td></tr><tr><td>è¯·æ±‚å¸¦å®½</td><td style="text-align:right">å¯GZipï¼Œç²¾ç®€JavaScriptï¼Œç§»é™¤é‡å¤è„šæœ¬ï¼Œå›¾åƒä¼˜åŒ–  </td></tr><tr><td>ç¼“å­˜åˆ©ç”¨</td><td style="text-align:right">ä½¿ç”¨CDNï¼Œä½¿ç”¨å¤–éƒ¨JavaScriptå’ŒCSSï¼Œæ·»åŠ Expireså¤´ï¼Œå‡å°‘DNSæŸ¥æ‰¾ï¼Œé…ç½®ETagï¼Œä½¿AjaXå¯ç¼“å­˜  </td></tr><tr><td>é¡µé¢ç»“æ„</td><td style="text-align:right">å°†æ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨ï¼Œå°†è„šæœ¬æ”¾åœ¨åº•éƒ¨ï¼Œå°½æ—©åˆ·æ–°æ–‡æ¡£çš„è¾“å‡º   </td></tr><tr><td>ä»£ç æ ¡éªŒ</td><td style="text-align:right">é¿å…CSSè¡¨è¾¾å¼ï¼Œé¿å…é‡å®šå‘   </td></tr></tbody></table><p>è¡¨æ ¼1 æ€§èƒ½ä¼˜åŒ–åŸåˆ™åˆ†ç±»</p><ul><li>ç›®å‰å¤§å¤šæ•°å‰ç«¯å›¢é˜Ÿå¯ä»¥åˆ©ç”¨yui compressoræˆ–è€…google closure compilerç­‰å‹ç¼©å·¥å…·å¾ˆå®¹æ˜“åšåˆ°â€œç²¾ç®€Javascriptâ€è¿™æ¡åŸåˆ™ï¼›</li><li>åŒæ ·çš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å›¾ç‰‡å‹ç¼©å·¥å…·å¯¹å›¾åƒè¿›è¡Œå‹ç¼©ï¼Œå®ç°â€œå›¾åƒä¼˜åŒ–â€åŸåˆ™ã€‚è¿™ä¸¤æ¡åŸåˆ™æ˜¯å¯¹å•ä¸ªèµ„æºçš„å¤„ç†ï¼Œå› æ­¤ä¸ä¼šå¼•èµ·ä»»ä½•å·¥ç¨‹æ–¹é¢çš„é—®é¢˜ã€‚</li><li>å¾ˆå¤šå›¢é˜Ÿä¹Ÿé€šè¿‡å¼•å…¥ä»£ç æ ¡éªŒæµç¨‹æ¥ç¡®ä¿å®ç°â€œé¿å…cssè¡¨è¾¾å¼â€å’Œâ€œé¿å…é‡å®šå‘â€åŸåˆ™ã€‚</li><li>ç›®å‰ç»å¤§å¤šæ•°äº’è”ç½‘å…¬å¸ä¹Ÿå·²ç»å¼€å¯äº†æœåŠ¡ç«¯çš„Gzipå‹ç¼©ï¼Œå¹¶ä½¿ç”¨CDNå®ç°é™æ€èµ„æºçš„ç¼“å­˜å’Œå¿«é€Ÿè®¿é—®ï¼›</li><li>ä¸€äº›æŠ€æœ¯å®åŠ›é›„åšçš„å‰ç«¯å›¢é˜Ÿç”šè‡³ç ”å‘å‡ºäº†è‡ªåŠ¨CSS Spriteså·¥å…·ï¼Œè§£å†³äº†CSS Spritesåœ¨å·¥ç¨‹ç»´æŠ¤æ–¹é¢çš„éš¾é¢˜ã€‚</li><li>ä½¿ç”¨â€œæŸ¥æ‰¾-æ›¿æ¢â€æ€è·¯ï¼Œæˆ‘ä»¬ä¼¼ä¹ä¹Ÿå¯ä»¥å¾ˆå¥½çš„å®ç°â€œåˆ’åˆ†ä¸»åŸŸâ€åŸåˆ™ã€‚</li></ul><p>æˆ‘ä»¬æŠŠä»¥ä¸Šè¿™äº›å·²ç»æˆç†Ÿåº”ç”¨åˆ°å®é™…ç”Ÿäº§ä¸­çš„ä¼˜åŒ–æ‰‹æ®µå»é™¤æ‰ï¼Œç•™ä¸‹é‚£äº›è¿˜æ²¡æœ‰å¾ˆå¥½å®ç°çš„ä¼˜åŒ–åŸåˆ™ã€‚å†æ¥å›é¡¾ä¸€ä¸‹ä¹‹å‰çš„æ€§èƒ½ä¼˜åŒ–åˆ†ç±»ï¼š</p><table><thead><tr><th>ä¼˜åŒ–æ–¹å‘</th><th style="text-align:right">ä¼˜åŒ–æ‰‹æ®µ  </th></tr></thead><tbody><tr><td>è¯·æ±‚æ•°é‡</td><td style="text-align:right">åˆå¹¶è„šæœ¬å’Œæ ·å¼è¡¨ï¼Œæ‹†åˆ†åˆå§‹åŒ–è´Ÿè½½ </td></tr><tr><td>è¯·æ±‚å¸¦å®½</td><td style="text-align:right">ç§»é™¤é‡å¤è„šæœ¬  </td></tr><tr><td>ç¼“å­˜åˆ©ç”¨</td><td style="text-align:right">æ·»åŠ Expireså¤´ï¼Œé…ç½®ETagï¼Œä½¿Ajaxå¯ç¼“å­˜ </td></tr><tr><td>é¡µé¢ç»“æ„</td><td style="text-align:right">å°†æ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨ï¼Œå°†è„šæœ¬æ”¾åœ¨åº•éƒ¨ï¼Œå°½æ—©åˆ·æ–°æ–‡æ¡£çš„è¾“å‡º   </td></tr></tbody></table><p>è¡¨æ ¼2 è¾ƒéš¾å®ç°çš„ä¼˜åŒ–åŸåˆ™</p><p>ç°åœ¨æœ‰å¾ˆå¤šé¡¶å°–çš„å‰ç«¯å›¢é˜Ÿå¯ä»¥å°†ä¸Šè¿°è¿˜å‰©ä¸‹çš„ä¼˜åŒ–åŸåˆ™ä¹Ÿéƒ½ä¸€ä¸€è§£å†³ï¼Œä½†ä¸šç•Œå¤§å¤šæ•°å›¢é˜Ÿéƒ½è¿˜æ²¡èƒ½å¾ˆå¥½çš„è§£å†³è¿™äº›é—®é¢˜ã€‚å› æ­¤ï¼Œæœ¬æ–‡å°†å°±è¿™äº›åŸåˆ™çš„è§£å†³æ–¹æ¡ˆåšè¿›ä¸€æ­¥çš„åˆ†æä¸è®²è§£ï¼Œä»è€Œä¸ºé‚£äº›è¿˜æ²¡æœ‰è¿›å…¥å‰ç«¯å·¥ä¸šåŒ–å¼€å‘çš„å›¢é˜Ÿæä¾›ä¸€äº›åŸºç¡€æŠ€æœ¯å»ºè®¾æ„è§ï¼Œä¹Ÿå€Ÿæ­¤æœºä¼šä¸ä¸šç•Œé¡¶å°–çš„å‰ç«¯å›¢é˜Ÿåœ¨å·¥ä¸šåŒ–å·¥ç¨‹åŒ–æ–¹å‘ä¸Šäº¤æµä¸€ä¸‹å½¼æ­¤çš„å¿ƒå¾—ã€‚</p><h2 id="é™æ€èµ„æºç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜"><a href="#é™æ€èµ„æºç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜" class="headerlink" title="é™æ€èµ„æºç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜"></a>é™æ€èµ„æºç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜</h2><p>å¦‚è¡¨æ ¼2æ‰€ç¤ºï¼Œâ€œç¼“å­˜åˆ©ç”¨â€åˆ†ç±»ä¸­ä¿ç•™äº†â€œæ·»åŠ Expireså¤´â€å’Œâ€œé…ç½®ETagâ€ä¸¤é¡¹ã€‚æˆ–è®¸æœ‰äº›äººä¼šè´¨ç–‘ï¼Œæ˜æ˜è¿™ä¸¤é¡¹åªè¦é…ç½®äº†æœåŠ¡å™¨çš„ç›¸å…³é€‰é¡¹å°±å¯ä»¥å®ç°ï¼Œä¸ºä»€ä¹ˆè¯´å®ƒä»¬éš¾ä»¥è§£å†³å‘¢ï¼Ÿç¡®å®ï¼Œå¼€å¯è¿™ä¸¤é¡¹å¾ˆå®¹æ˜“ï¼Œä½†å¼€å¯äº†ç¼“å­˜åï¼Œæˆ‘ä»¬çš„é¡¹ç›®å°±å¼€å§‹é¢ä¸´å¦ä¸€ä¸ªæŒ‘æˆ˜ï¼šå¦‚ä½•æ›´æ–°è¿™äº›ç¼“å­˜ã€‚</p><p>ç›¸ä¿¡å¤§å¤šæ•°å›¢é˜Ÿä¹Ÿæ‰¾åˆ°äº†ç±»ä¼¼çš„ç­”æ¡ˆï¼Œå®ƒå’Œã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾æŒ‡å—ã€‹å…³äºâ€œæ·»åŠ Expireså¤´â€æ‰€è¯´çš„åŸåˆ™ä¸€æ ·â€”â€”ä¿®è®¢æ–‡ä»¶åã€‚å³ï¼š</p><p><strong>æœ€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆæ˜¯ä¿®æ”¹å…¶æ‰€æœ‰é“¾æ¥ï¼Œè¿™æ ·ï¼Œå…¨æ–°çš„è¯·æ±‚å°†ä»åŸå§‹æœåŠ¡å™¨ä¸‹è½½æœ€æ–°çš„å†…å®¹ã€‚</strong></p><p>æ€è·¯æ²¡é”™ï¼Œä½†è¦æ€ä¹ˆæ”¹å˜é“¾æ¥å‘¢ï¼Ÿå˜æˆä»€ä¹ˆæ ·çš„é“¾æ¥æ‰èƒ½æœ‰æ•ˆæ›´æ–°ç¼“å­˜ï¼Œåˆèƒ½æœ€å¤§é™åº¦é¿å…é‚£äº›æ²¡æœ‰ä¿®æ”¹è¿‡çš„æ–‡ä»¶ç¼“å­˜ä¸å¤±æ•ˆå‘¢ï¼Ÿ</p><p>å…ˆæ¥çœ‹çœ‹ç°åœ¨ä¸€èˆ¬å‰ç«¯å›¢é˜Ÿçš„åšæ³•ï¼š</p><pre><code class="javascript">&lt;script scr = &quot;a.js?t=202131&quot;&gt;&lt;/script&gt;</code></pre><p>æˆ–è€…</p><pre><code class="javascript">&lt;script src = &quot;a.js?v=1.0.0&quot;&gt;&lt;/script&gt;</code></pre><p>å¤§å®¶ä¼šé‡‡ç”¨æ·»åŠ queryçš„å½¢å¼ä¿®æ”¹é“¾æ¥ã€‚è¿™æ ·åšæ˜¯æ¯”è¾ƒç›´è§‚çš„è§£å†³æ–¹æ¡ˆï¼Œä½†åœ¨è®¿é—®é‡è¾ƒå¤§çš„ç½‘ç«™ï¼Œè¿™ä¹ˆåšå¯èƒ½å°†é¢ä¸´ä¸€äº›æ–°çš„é—®é¢˜ã€‚</p><p>é€šå¸¸ä¸€ä¸ªå¤§å‹çš„webåº”ç”¨å‡ ä¹æ¯å¤©éƒ½ä¼šæœ‰è¿­ä»£å’Œæ›´æ–°ï¼Œå‘å¸ƒæ–°ç‰ˆæœ¬ä¹Ÿå°±æ˜¯å‘å¸ƒæ–°çš„é™æ€èµ„æºå’Œé¡µé¢çš„è¿‡ç¨‹ã€‚ä»¥ä¸Šè¿°ä»£ç ä¸ºä¾‹ï¼Œå‡è®¾ç°åœ¨çº¿ä¸Šè¿è¡Œç€index.htmlæ–‡ä»¶ï¼Œå¹¶ä¸”ä½¿ç”¨äº†çº¿ä¸Šçš„a.jsèµ„æºã€‚index.htmlçš„å†…å®¹ä¸ºï¼š</p><pre><code class="javascript">&lt;script src = &quot;a.js?v=1.0.0&quot;&gt;&lt;/script&gt;</code></pre><p>è¿™æ¬¡æˆ‘ä»¬æ›´æ–°äº†é¡µé¢ä¸­çš„ä¸€äº›å†…å®¹ï¼Œå¾—åˆ°ä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼Œå¹¶å¼€å‘äº†æ–°çš„ä¸ä¹‹åŒ¹é…çš„a.jsèµ„æºæ¥å®Œæˆé¡µé¢äº¤äº’ï¼Œæ–°çš„index.htmlæ–‡ä»¶çš„å†…å®¹å› æ­¤è€Œå˜æˆäº†</p><pre><code class="javascript">&lt;script src = &quot;a.js?v=1.0.1&quot;&gt;&lt;/script&gt;</code></pre><p>å¥½äº†ï¼Œç°åœ¨è¦å¼€å§‹å°†ä¸¤ä»½æ–°çš„æ–‡ä»¶å‘å¸ƒåˆ°çº¿ä¸Šå»ã€‚å¯ä»¥çœ‹åˆ°ï¼Œindex.htmlå’Œa.jsçš„èµ„æºå®é™…ä¸Šæ˜¯è¦è¦†ç›–çº¿ä¸Šçš„åŒåæ–‡ä»¶çš„ã€‚ä¸ç®¡æ€æ ·ï¼Œåœ¨å‘å¸ƒçš„è¿‡ç¨‹ä¸­ï¼Œindex.htmlå’Œa.jsæ€»æœ‰ä¸€ä¸ªå…ˆåçš„é¡ºåºï¼Œä»è€Œä¸­é—´å‡ºç°ä¸€æ®µæˆ–å¤§æˆ–å°çš„æ—¶é—´é—´éš”ã€‚å¯¹äºä¸€ä¸ªå¤§å‹äº’è”ç½‘åº”ç”¨æ¥è¯´å³ä½¿åœ¨ä¸€ä¸ªå¾ˆå°çš„æ—¶é—´é—´éš”å†…ï¼Œéƒ½æœ‰å¯èƒ½å‡ºç°æ–°ç”¨æˆ·è®¿é—®ã€‚åœ¨è¿™ä¸ªæ—¶é—´é—´éš”ä¸­ï¼Œè®¿é—®äº†ç½‘ç«™çš„ç”¨æˆ·ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ</p><blockquote><p>1.å¦‚æœå…ˆè¦†ç›–index.htmlï¼Œåè¦†ç›–a.jsï¼Œç”¨æˆ·åœ¨è¿™ä¸ªæ—¶é—´é—´éš™è®¿é—®ï¼Œä¼šå¾—åˆ°æ–°çš„index.htmlé…åˆæ—§çš„a.jsçš„æƒ…å†µï¼Œä»è€Œå‡ºç°é”™è¯¯çš„é¡µé¢ã€‚<br>2.å¦‚æœå…ˆè¦†ç›–a.jsï¼Œåè¦†ç›–index.htmlï¼Œç”¨æˆ·åœ¨è¿™ä¸ªé—´éš™è®¿é—®ï¼Œä¼šå¾—åˆ°æ—§çš„index.htmlé…åˆæ–°çš„a.jsçš„æƒ…å†µï¼Œä»è€Œä¹Ÿå‡ºç°äº†é”™è¯¯çš„é¡µé¢ã€‚</p></blockquote><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¤§å‹webåº”ç”¨åœ¨ç‰ˆæœ¬ä¸Šçº¿çš„è¿‡ç¨‹ä¸­ç»å¸¸ä¼šè¾ƒé›†ä¸­çš„å‡ºç°å‰ç«¯æŠ¥é”™æ—¥å¿—çš„åŸå› ï¼Œä¹Ÿæ˜¯ä¸€äº›äº’è”ç½‘å…¬å¸é€‰æ‹©åŠ ç­åˆ°åŠå¤œç­‰å¾…è®¿é—®ä½å³°æœŸå†ä¸Šçº¿çš„åŸå› ä¹‹ä¸€ã€‚æ­¤å¤–ï¼Œç”±äºé™æ€èµ„æºæ–‡ä»¶ç‰ˆæœ¬æ›´æ–°æ˜¯â€œè¦†ç›–å¼â€çš„ï¼Œè€Œé¡µé¢éœ€è¦é€šè¿‡ä¿®æ”¹queryæ¥æ›´æ–°ï¼Œå¯¹äºä½¿ç”¨CDNç¼“å­˜çš„webäº§å“æ¥è¯´ï¼Œè¿˜å¯èƒ½é¢ä¸´CDNç¼“å­˜æ”»å‡»çš„é—®é¢˜ã€‚æˆ‘ä»¬å†æ¥è§‚å¯Ÿä¸€ä¸‹å‰é¢è¯´çš„ç‰ˆæœ¬æ›´æ–°æ‰‹æ®µï¼š</p><pre><code class="javascript">&lt;script src = &quot;a.js?v=1.0.0&quot;&gt;&lt;/script&gt;</code></pre><p>æˆ‘ä»¬ä¸éš¾é¢„æµ‹ï¼Œa.jsçš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬æ˜¯â€œ1.0.1â€ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ»æ„æ„é€ ä¸€ä¸²è¿™æ ·çš„è¯·æ±‚â€œa.js?v=1.0.1â€ã€â€œa.js?v=1.0.2â€ã€â€¦â€¦è®©<strong>CDNå°†å½“å‰çš„èµ„æºç¼“å­˜ä¸ºâ€œæœªæ¥çš„ç‰ˆæœ¬â€</strong>ã€‚è¿™æ ·å½“è¿™ä¸ªé¡µé¢æ‰€ç”¨çš„èµ„æºæœ‰æ›´æ–°æ—¶ï¼Œå³ä½¿æ›´æ”¹äº†é“¾æ¥åœ°å€ï¼Œä¹Ÿä¼šå› ä¸ºCDNçš„åŸå› è¿”å›ç»™ç”¨æˆ·æ—§ç‰ˆæœ¬çš„é™æ€èµ„æºï¼Œä»è€Œé€ æˆé¡µé¢é”™è¯¯ã€‚å³ä¾¿ä¸æ˜¯åˆ»æ„åˆ¶é€ çš„æ”»å‡»ï¼Œåœ¨ä¸Šçº¿é—´éš™å‡ºç°è®¿é—®ä¹Ÿå¯èƒ½å¯¼è‡´åŒºåŸŸæ€§çš„CDNç¼“å­˜é”™è¯¯ã€‚</p><p>æ­¤å¤–ï¼Œå½“ç‰ˆæœ¬æœ‰æ›´æ–°æ—¶ï¼Œä¿®æ”¹æ‰€æœ‰å¼•ç”¨é“¾æ¥ä¹Ÿæ˜¯ä¸€ä»¶ä¸å·¥ç¨‹ç®¡ç†ç›¸æ‚–çš„äº‹ï¼Œè‡³å°‘æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯ä»¥â€œæŸ¥æ‰¾-æ›¿æ¢â€çš„å·¥å…·æ¥è‡ªåŠ¨åŒ–çš„è§£å†³ç‰ˆæœ¬å·ä¿®æ”¹çš„é—®é¢˜ã€‚</p><p>å¯¹ä»˜è¿™ä¸ªé—®é¢˜ï¼Œç›®å‰æ¥è¯´æœ€ä¼˜æ–¹æ¡ˆå°±æ˜¯åŸºäºæ–‡ä»¶å†…å®¹çš„hashç‰ˆæœ¬å†—ä½™æœºåˆ¶äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›å·¥ç¨‹å¸ˆæºç æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p><pre><code class="javascript">&lt;script src = &quot;a.js?v=1.0.0&quot;&gt;&lt;/script&gt;</code></pre><p>ä½†æ˜¯çº¿ä¸Šä»£ç æ˜¯è¿™æ ·çš„</p><pre><code class="javascript">&lt;script src = &quot;a_2131e3.js&quot;&gt;&lt;/script&gt;</code></pre><p>å…¶ä¸­â€_82244e91â€è¿™ä¸²å­—ç¬¦æ˜¯æ ¹æ®a.jsçš„æ–‡ä»¶å†…å®¹è¿›è¡Œhashè¿ç®—å¾—åˆ°çš„ï¼Œåªæœ‰æ–‡ä»¶å†…å®¹å‘ç”Ÿå˜åŒ–äº†æ‰ä¼šæœ‰æ›´æ”¹ã€‚ç”±äºç‰ˆæœ¬åºåˆ—æ˜¯ä¸æ–‡ä»¶åå†™åœ¨ä¸€èµ·çš„ï¼Œè€Œä¸æ˜¯åŒåæ–‡ä»¶è¦†ç›–ï¼Œå› æ­¤ä¸ä¼šå‡ºç°ä¸Šè¿°è¯´çš„é‚£äº›é—®é¢˜ã€‚åŒæ—¶ï¼Œè¿™ä¹ˆåšè¿˜æœ‰å…¶ä»–çš„å¥½å¤„ï¼š</p><blockquote><p>1.çº¿ä¸Šçš„a.jsä¸æ˜¯åŒåæ–‡ä»¶è¦†ç›–ï¼Œè€Œæ˜¯æ–‡ä»¶å+hashçš„å†—ä½™ï¼Œæ‰€ä»¥å¯ä»¥å…ˆä¸Šçº¿é™æ€èµ„æºï¼Œå†ä¸Šçº¿htmlé¡µé¢ï¼Œä¸å­˜åœ¨é—´éš™é—®é¢˜ï¼›<br>2.é‡åˆ°é—®é¢˜å›æ»šç‰ˆæœ¬çš„æ—¶å€™ï¼Œæ— éœ€å›æ»ša.jsï¼Œåªé¡»å›æ»šé¡µé¢å³å¯ï¼›<br>3.ç”±äºé™æ€èµ„æºç‰ˆæœ¬å·æ˜¯æ–‡ä»¶å†…å®¹çš„hashï¼Œå› æ­¤æ‰€æœ‰é™æ€èµ„æºå¯ä»¥å¼€å¯æ°¸ä¹…å¼ºç¼“å­˜ï¼Œåªæœ‰æ›´æ–°äº†å†…å®¹çš„æ–‡ä»¶æ‰ä¼šç¼“å­˜å¤±æ•ˆï¼Œç¼“å­˜åˆ©ç”¨ç‡å¤§å¢ï¼›<br>4.ä¿®æ”¹é™æ€èµ„æºåä¼šåœ¨çº¿ä¸Šäº§ç”Ÿæ–°çš„æ–‡ä»¶ï¼Œä¸€ä¸ªæ–‡ä»¶å¯¹åº”ä¸€ä¸ªç‰ˆæœ¬ï¼Œå› æ­¤ä¸ä¼šå—åˆ°æ„é€ CDNç¼“å­˜å½¢å¼çš„æ”»å‡»</p></blockquote><p>è™½ç„¶è¿™ç§æ–¹æ¡ˆæ˜¯ç›¸æ¯”ä¹‹ä¸‹æœ€å®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼Œä½†å®ƒæ— æ³•é€šè¿‡æ‰‹å·¥çš„å½¢å¼æ¥ç»´æŠ¤ï¼Œå› ä¸ºè¦ä¾é æ‰‹å·¥çš„å½¢å¼æ¥è®¡ç®—å’Œæ›¿æ¢hashå€¼ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„æ–‡ä»¶ã€‚è¿™å°†æ˜¯ä¸€é¡¹éå¸¸ç¹çä¸”å®¹æ˜“å‡ºé”™çš„å·¥ä½œï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å€ŸåŠ©å·¥å…·ã€‚(webpack,gulpç­‰)</p><p><a href="http://www.infoq.com/cn/articles/front-end-engineering-and-performance-optimization-part1" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> æ€§èƒ½ä¼˜åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€§èƒ½ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½ ä¸çŸ¥é“çš„JSON.parse()å’ŒJSON.stringify()é«˜çº§æŠ€å·§</title>
      <link href="/2018/04/20/Js/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JSON-parse-%E5%92%8CJSON-stringify-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7/"/>
      <url>/2018/04/20/Js/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JSON-parse-%E5%92%8CJSON-stringify-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>JSONå¯¹è±¡çš„ä¸¤ä¸ªæ–¹æ³•ï¼šJSON.parse() å’Œ JSON.stringify() é€šå¸¸ç”¨åšJSONå¯¹è±¡å’Œå­—ç¬¦ä¸²ä¹‹é—´çš„ç›¸äº’è½¬æ¢;</p><h2 id="JSON-parse"><a href="#JSON-parse" class="headerlink" title="JSON.parse()"></a>JSON.parse()</h2><p>JSON.parse() å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒå¯ä»¥åœ¨è¿”å›ä¹‹å‰è½¬æ¢å¯¹è±¡å€¼ã€‚æ¯”å¦‚è¿™ä¾‹å­ä¸­ï¼Œå°†è¿”å›å¯¹è±¡çš„å±æ€§å€¼å¤§å†™ï¼š</p><pre><code class="javascript">const user = {  name: &#39;John&#39;,  email: &#39;john@awesome.com&#39;,  plan: &#39;Pro&#39;};const userStr = JSON.stringify(user);const newUserStr = JSON.parse(userStr, (key, value) =&gt; {  if (typeof value === &#39;string&#39;) {    return value.toUpperCase();  }  return value;});console.log(newUserStr); //{name: &quot;JOHN&quot;, email: &quot;JOHN@AWESOME.COM&quot;, plan: &quot;PRO&quot;}</code></pre><p>æ³¨ï¼šå°¾éšé€—å·åœ¨JSON ä¸­æ— æ•ˆï¼Œæ‰€ä»¥å¦‚æœä¼ é€’ç»™å®ƒçš„å­—ç¬¦ä¸²æœ‰å°¾éšé€—å·ï¼ŒJSON.parse()å°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚<br><a id="more"></a></p><h2 id="JSON-stringify"><a href="#JSON-stringify" class="headerlink" title="JSON.stringify()"></a>JSON.stringify()</h2><p>JSON.stringify() å¯ä»¥å¸¦ä¸¤ä¸ªé¢å¤–çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ›¿æ¢å‡½æ•°ï¼Œç¬¬äºŒä¸ªé—´éš”å­—ç¬¦ä¸²ï¼Œç”¨ä½œéš”å¼€è¿”å›å­—ç¬¦ä¸²ã€‚</p><blockquote><p>å‚æ•°ï¼š</p><ul><li>value ï¼š å°†è¦è½¬ä¸ºJSONå­—ç¬¦ä¸²çš„javascriptå¯¹è±¡ã€‚</li><li>replacer ï¼šè¯¥å‚æ•°å¯ä»¥æ˜¯å¤šç§ç±»å‹,å¦‚æœæ˜¯ä¸€ä¸ªå‡½æ•°,åˆ™å®ƒå¯ä»¥æ”¹å˜ä¸€ä¸ªjavascriptå¯¹è±¡åœ¨å­—ç¬¦ä¸²åŒ–è¿‡ç¨‹ä¸­çš„è¡Œä¸º, å¦‚æœæ˜¯ä¸€ä¸ªåŒ…å« String å’Œ Number å¯¹è±¡çš„æ•°ç»„,åˆ™å®ƒå°†ä½œä¸ºä¸€ä¸ªç™½åå•.åªæœ‰é‚£äº›é”®å­˜åœ¨åŸŸè¯¥ç™½åå•ä¸­çš„é”®å€¼å¯¹æ‰ä¼šè¢«åŒ…å«è¿›æœ€ç»ˆç”Ÿæˆçš„JSONå­—ç¬¦ä¸²ä¸­.å¦‚æœè¯¥å‚æ•°å€¼ä¸ºnullæˆ–è€…è¢«çœç•¥,åˆ™æ‰€æœ‰çš„é”®å€¼å¯¹éƒ½ä¼šè¢«åŒ…å«è¿›æœ€ç»ˆç”Ÿæˆçš„JSONå­—ç¬¦ä¸²ä¸­ã€‚</li><li>space ï¼šè¯¥å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ª String æˆ– Number å¯¹è±¡,ä½œç”¨æ˜¯ä¸ºäº†åœ¨è¾“å‡ºçš„JSONå­—ç¬¦ä¸²ä¸­æ’å…¥ç©ºç™½ç¬¦æ¥å¢å¼ºå¯è¯»æ€§. å¦‚æœæ˜¯Numberå¯¹è±¡, åˆ™è¡¨ç¤ºç”¨å¤šå°‘ä¸ªç©ºæ ¼æ¥ä½œä¸ºç©ºç™½ç¬¦; æœ€å¤§å¯ä¸º10,å¤§äº10çš„æ•°å€¼ä¹Ÿå–10.æœ€å°å¯ä¸º1,å°äº1çš„æ•°å€¼æ— æ•ˆ,åˆ™ä¸ä¼šæ˜¾ç¤ºç©ºç™½ç¬¦. å¦‚æœæ˜¯ä¸ª Stringå¯¹è±¡, åˆ™è¯¥å­—ç¬¦ä¸²æœ¬èº«ä¼šä½œä¸ºç©ºç™½ç¬¦,å­—ç¬¦ä¸²æœ€é•¿å¯ä¸º10ä¸ªå­—ç¬¦.è¶…è¿‡çš„è¯ä¼šæˆªå–å‰åä¸ªå­—ç¬¦. å¦‚æœè¯¥å‚æ•°è¢«çœç•¥ (æˆ–è€…ä¸ºnull), åˆ™ä¸ä¼šæ˜¾ç¤ºç©ºç™½ç¬¦</li></ul></blockquote><p>æ›¿æ¢å‡½æ•°å¯ä»¥ç”¨æ¥è¿‡æ»¤å€¼ï¼Œå› ä¸ºä»»ä½•è¿”å› <code>undefined</code> çš„å€¼å°†ä¸åœ¨è¿”å›çš„å­—ç¬¦ä¸²ä¸­ï¼š</p><pre><code class="javascript">const user = {  id: 229,  name: &#39;John&#39;,  email: &#39;john@awesome.com&#39;};function replacer(key, value) {  console.log(typeof value);  if (key === &#39;email&#39;) {    return undefined;  }  return value;}const userStr = JSON.stringify(user, replacer);// &quot;{&quot;id&quot;:229,&quot;name&quot;:&quot;John&quot;}&quot;</code></pre><p>ä¼ å…¥ä¸€ä¸ªé—´éš”å‚æ•°çš„ç¤ºä¾‹ï¼š</p><pre><code class="javascript">const user = {  name: &#39;John&#39;,  email: &#39;john@awesome.com&#39;,  plan: &#39;Pro&#39;};const userStr = JSON.stringify(user, null, &#39;...&#39;);// &quot;{// ...&quot;name&quot;: &quot;John&quot;,// ...&quot;email&quot;: &quot;john@awesome.com&quot;,// ...&quot;plan&quot;: &quot;Pro&quot;// }&quot;</code></pre><h2 id="toJSONæ–¹æ³•"><a href="#toJSONæ–¹æ³•" class="headerlink" title="toJSONæ–¹æ³•"></a>toJSONæ–¹æ³•</h2><p>å¦‚æœä¸€ä¸ªè¢«åºåˆ—åŒ–çš„å¯¹è±¡æ‹¥æœ‰ toJSON æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥ toJSON æ–¹æ³•å°±ä¼šè¦†ç›–è¯¥å¯¹è±¡é»˜è®¤çš„åºåˆ—åŒ–è¡Œä¸ºï¼šä¸æ˜¯é‚£ä¸ªå¯¹è±¡è¢«åºåˆ—åŒ–ï¼Œè€Œæ˜¯è°ƒç”¨ toJSON æ–¹æ³•åçš„è¿”å›å€¼ä¼šè¢«åºåˆ—åŒ–</p><pre><code class="javascript">var obj = {    foo: &#39;foo&#39;,    toJSON:function(){        return &#39;bar&#39;;    }}JSON.stringify(obj);//&#39;&quot;bar&quot;&#39;JSON.stringify({x:obj});//&#39;{&quot;x&quot;:&quot;bar&quot;}&#39;</code></pre><p>åˆ©ç”¨toJSONæ–¹æ³•,æˆ‘ä»¬å¯ä»¥ä¿®æ”¹å¯¹è±¡è½¬æ¢æˆJSONçš„é»˜è®¤è¡Œä¸ºã€‚</p><h2 id="ç”¨-JSON-stringify-æ¥æ ¼å¼åŒ–å¯¹è±¡"><a href="#ç”¨-JSON-stringify-æ¥æ ¼å¼åŒ–å¯¹è±¡" class="headerlink" title="ç”¨ JSON.stringify æ¥æ ¼å¼åŒ–å¯¹è±¡"></a>ç”¨ JSON.stringify æ¥æ ¼å¼åŒ–å¯¹è±¡</h2><p>åœ¨å®é™…ä½¿ç”¨ä¸­,æˆ‘ä»¬å¯èƒ½ä¼šæ ¼å¼åŒ–ä¸€äº›å¤æ‚çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡å¾€å¾€å¯¹è±¡å†…åµŒå¥—å¯¹è±¡ã€‚ç›´æ¥çœ‹èµ·æ¥å¹¶ä¸é‚£ä¹ˆç›´è§‚,ç»“åˆä¸Šé¢çš„çš„ replacer å’Œ space å‚æ•°,æˆ‘ä»¬å¯ä»¥è¿™æ ·æ ¼å¼åŒ–å¤æ‚å¯¹è±¡ï¼š</p><pre><code class="javascript">var censor = function(key,value){    if(typeof(value) == &#39;function&#39;){         return Function.prototype.toString.call(value)    }    return value;}var foo = {bar:&quot;1&quot;,baz:3,o:{name:&#39;xiaoli&#39;,age:21,info:{sex:&#39;ç”·&#39;,getSex:function(){return &#39;sex&#39;;}}}};console.log(JSON.stringify(foo,censor,4))</code></pre><p>å®é™…è¿”å›çš„å­—ç¬¦ä¸²ï¼Œè®°ä½æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹:</p><pre><code class="javascript">{    &quot;bar&quot;: &quot;1&quot;,    &quot;baz&quot;: 3,    &quot;o&quot;: {        &quot;name&quot;: &quot;xiaoli&quot;,        &quot;age&quot;: 21,        &quot;info&quot;: {            &quot;sex&quot;: &quot;ç”·&quot;,            &quot;getSex&quot;: &quot;function (){return &#39;sex&#39;;}&quot;        }    }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯ä»£ç è§„èŒƒ-JSç¯‡</title>
      <link href="/2018/04/19/Record/%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83-JS%E7%AF%87/"/>
      <url>/2018/04/19/Record/%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83-JS%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/zhanghao-web/spec" target="_blank" rel="noopener">æ›´å¤šå‰ç«¯ä»£ç è§„èŒƒè¯·ç§»æ­¥</a></p><hr><p>å¦‚æœæ˜¯ä¸ªäººæˆ–è€…å°ä½œåŠå¼€å‘ï¼Œå…¶å®è¿™äº›æ‰€è°“çš„ç¼–ç è§„èŒƒä¹Ÿæ²¡å•¥æ„æ€ï¼Œå› ä¸ºå¤§å®¶å†™å¥½çš„ä»£ç ç›´æ¥å°±ç»™æ‰”åˆ°ç½‘ä¸Šå»äº†ï¼Œå¾ˆå°‘æœ‰æ‰“åŒ…ã€å‹ç¼©ã€æ ¡æ£€ç­‰è¿‡ç¨‹ï¼Œåˆ«äººæ¥ä¿®æ”¹ä½ ä»£ç çš„æƒ…å†µä¹Ÿæ¯”è¾ƒå°‘ã€‚ä½†æ˜¯ï¼Œå¯¹äºä¸€å®šè§„æ¨¡çš„å›¢é˜Ÿæ¥è¯´ï¼Œè¿™äº›ä¸œè¥¿è¿˜æ˜¯æŒºæœ‰å¿…è¦çš„ï¼ä¸€ä¸ªæ˜¯ä¿æŒä»£ç çš„æ•´æ´ç¾è§‚ï¼ŒåŒæ—¶è‰¯å¥½çš„ä»£ç ç¼–å†™æ ¼å¼å’Œæ³¨é‡Šæ–¹å¼å¯ä»¥è®©åæ¥è€…å¾ˆå¿«åœ°äº†è§£ä½ ä»£ç çš„å¤§æ¦‚æ€è·¯ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p><h1 id="ä¸è§„èŒƒå†™æ³•ä¸¾ä¾‹"><a href="#ä¸è§„èŒƒå†™æ³•ä¸¾ä¾‹" class="headerlink" title="ä¸è§„èŒƒå†™æ³•ä¸¾ä¾‹"></a>ä¸è§„èŒƒå†™æ³•ä¸¾ä¾‹</h1><ol><li>å¥å°¾æ²¡æœ‰åˆ†å·<pre><code class="javascript">var isHotel = json.type == &quot;hotel&quot; ? true : false</code></pre></li><li>å˜é‡å‘½åå„ç§å„æ ·<pre><code class="javascript">var is_hotel;var isHotel;var ishotel;</code></pre></li><li>if ç¼©å†™<pre><code class="javascript">if (isHotel) console.log(true)else console.log(false)</code></pre></li><li>ä½¿ç”¨ eval<pre><code class="javascript">var json = eval(jsonText);</code></pre></li><li><p>å˜é‡æœªå®šä¹‰åˆ°å¤„éƒ½æ˜¯</p><pre><code class="javascript">function() { var isHotel = &#39;true&#39;; ....... var html = isHotel ? &#39;&lt;p&gt;hotel&lt;/p&gt;&#39; : &quot;&quot;;}</code></pre></li><li>è¶…é•¿å‡½æ•°<pre><code class="javascript">function() { var isHotel = &#39;true&#39;; //....... æ­¤å¤„çœç•¥500è¡Œ return false;}</code></pre><a id="more"></a><h1 id="å‰ç«¯è§„èŒƒä¹‹JavaScript"><a href="#å‰ç«¯è§„èŒƒä¹‹JavaScript" class="headerlink" title="å‰ç«¯è§„èŒƒä¹‹JavaScript"></a>å‰ç«¯è§„èŒƒä¹‹JavaScript</h1><h2 id="å˜é‡ã€å¸¸é‡ã€ç±»çš„å‘½åæŒ‰ï¼ˆå¿…é¡»ï¼‰ä»¥ä¸‹è§„åˆ™æ‰§è¡Œï¼š"><a href="#å˜é‡ã€å¸¸é‡ã€ç±»çš„å‘½åæŒ‰ï¼ˆå¿…é¡»ï¼‰ä»¥ä¸‹è§„åˆ™æ‰§è¡Œï¼š" class="headerlink" title="å˜é‡ã€å¸¸é‡ã€ç±»çš„å‘½åæŒ‰ï¼ˆå¿…é¡»ï¼‰ä»¥ä¸‹è§„åˆ™æ‰§è¡Œï¼š"></a>å˜é‡ã€å¸¸é‡ã€ç±»çš„å‘½åæŒ‰ï¼ˆå¿…é¡»ï¼‰ä»¥ä¸‹è§„åˆ™æ‰§è¡Œï¼š</h2></li></ol><p>ã€€ã€€1ï¼‰ å˜é‡ï¼šå¿…é¡»é‡‡ç”¨éª†é©¼å³°çš„å‘½åä¸”é¦–å­—æ¯å°å†™</p><pre><code class="javascript"> // æ­£ç¡®çš„å‘½å  var isHotel,      isHotelBeijing,      isHotelBeijingHandian;  // ä¸æ¨èçš„å‘½å  var is_Hotel,      ishotelbeijing,      IsHotelBeiJing;</code></pre><p>ã€€ã€€2ï¼‰ å¸¸é‡ï¼šå¿…é¡»é‡‡ç”¨å…¨å¤§å†™çš„å‘½åï¼Œä¸”å•è¯ä»¥_åˆ†å‰²ï¼Œå¸¸é‡é€šå¸¸ç”¨äºajaxè¯·æ±‚urlï¼Œå’Œä¸€äº›ä¸ä¼šæ”¹å˜çš„æ•°æ®</p><pre><code class="javascript">// æ­£ç¡®çš„å‘½å  var HOTEL_GET_URL = &#39;http://map.baidu.com/detail&#39;,      PLACE_TYPE = &#39;hotel&#39;;</code></pre><p>ã€€ã€€3ï¼‰ ç±»ï¼šå¿…é¡»é‡‡ç”¨éª†é©¼å³°çš„å‘½åä¸”é¦–å­—æ¯å¤§å†™ï¼Œå¦‚ï¼š</p><pre><code class="javascript"> // æ­£ç¡®çš„å†™æ³•  var FooAndToo = function(name) {      this.name = name;  }</code></pre><h2 id="ifä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­"><a href="#ifä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­" class="headerlink" title="ifä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­"></a>ifä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­</h2><pre><code class="javascript"> //æ­£ç¡®çš„å†™æ³•  if (isOk) {      console.log(&quot;ok&quot;);  }  //ä¸æ¨èçš„å†™æ³•  if(isOk){      console.log(&quot;ok&quot;);  }</code></pre><ul><li>()ä¸­çš„åˆ¤æ–­æ¡ä»¶å‰åéƒ½(å¿…é¡»)åŠ ç©ºæ ¼</li><li><p>()é‡Œçš„åˆ¤æ–­å‰å(ç¦æ­¢)åŠ ç©ºæ ¼ï¼Œå¦‚ï¼šæ­£ç¡®çš„å†™æ³•: if (isOk)ï¼›ä¸æ¨èçš„å†™æ³•: if ( isOk )<br>ã€€ã€€2ï¼‰switchä¸­çš„ç©ºæ ¼, å…ˆä¸Šä¾‹å­</p><pre><code class="javascript">//æ­£ç¡®çš„å†™æ³•switch(name) {    case &quot;hotel&quot;:        console.log(name);        break;    case &quot;moive&quot;:        console.log(name);        break;    default:        // code}  </code></pre></li></ul><h2 id="forä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­"><a href="#forä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­" class="headerlink" title="forä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­"></a>forä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­</h2><pre><code class="javascript"> // æ­£ç¡®çš„å†™æ³•  var names = [&quot;hotel&quot;, &quot;movie&quot;],      i, len;  for (i=0, len=names.length; i &lt; len; i++) {      // code  }  </code></pre><ul><li>foråï¼ˆå¿…é¡»ï¼‰åŠ ç©ºæ ¼</li><li>æ¯ä¸ª;åï¼ˆå¿…é¡»ï¼‰åŠ ç©ºæ ¼</li><li>()ä¸­ç¦æ­¢ç”¨varå£°æ˜å˜é‡; ä¸”å˜é‡çš„èµ‹å€¼ = å‰åï¼ˆç¦æ­¢ï¼‰åŠ ç©ºæ ¼</li></ul><h2 id="function-ä¸­çš„ç©ºæ ¼-å…ˆä¸Šä¾‹å­"><a href="#function-ä¸­çš„ç©ºæ ¼-å…ˆä¸Šä¾‹å­" class="headerlink" title="function ä¸­çš„ç©ºæ ¼, å…ˆä¸Šä¾‹å­"></a>function ä¸­çš„ç©ºæ ¼, å…ˆä¸Šä¾‹å­</h2><pre><code class="javascript"> // æ­£ç¡®çš„å†™æ³•  function call(name) {  }  var cell = function () {  };</code></pre><ul><li>å‚æ•°çš„åæ‹¬å·åï¼ˆå¿…é¡»ï¼‰åŠ ç©ºæ ¼</li><li>function åï¼ˆå¿…é¡»ï¼‰åŠ ç©ºæ ¼</li></ul><h2 id="var-ä¸­ç©ºæ ¼åŠå®šä¹‰ï¼Œå…ˆä¸Šä¾‹å­"><a href="#var-ä¸­ç©ºæ ¼åŠå®šä¹‰ï¼Œå…ˆä¸Šä¾‹å­" class="headerlink" title="var ä¸­ç©ºæ ¼åŠå®šä¹‰ï¼Œå…ˆä¸Šä¾‹å­"></a>var ä¸­ç©ºæ ¼åŠå®šä¹‰ï¼Œå…ˆä¸Šä¾‹å­</h2><pre><code class="javascript">// ä¸€ä¸ªæ¨èçš„varå†™æ³•ç»„  function(res) {      var code = 1 + 1,          json = JSON.parse(res),          type, html;      // code  }</code></pre><ul><li>å£°æ˜å˜é‡ = å‰åï¼ˆå¿…é¡»ï¼‰æ·»åŠ ç©ºæ ¼</li><li>æ¯ä¸ªå˜é‡çš„èµ‹å€¼å£°æ˜ä»¥,ç»“æŸåï¼ˆå¿…é¡»ï¼‰æ¢è¡Œè¿›è¡Œä¸‹ä¸€ä¸ªå˜é‡èµ‹å€¼å£°æ˜<br><em>ï¼ˆæ¨èï¼‰å°†æ‰€æœ‰ä¸éœ€è¦è¿›è¡Œèµ‹å€¼çš„å˜é‡å£°æ˜æ”¾ç½®æœ€åä¸€è¡Œï¼Œä¸”å˜é‡ä¹‹é—´ä¸éœ€è¦æ¢è¡Œ</em>ï¼ˆæ¨èï¼‰å½“ä¸€ç»„å˜é‡å£°æ˜å®Œæˆåï¼Œç©ºä¸€è¡Œåç¼–å†™å…¶ä½™ä»£ç </li></ul><h2 id="åœ¨åŒä¸€ä¸ªå‡½æ•°å†…éƒ¨ï¼Œå±€éƒ¨å˜é‡çš„å£°æ˜å¿…é¡»ç½®äºé¡¶ç«¯"><a href="#åœ¨åŒä¸€ä¸ªå‡½æ•°å†…éƒ¨ï¼Œå±€éƒ¨å˜é‡çš„å£°æ˜å¿…é¡»ç½®äºé¡¶ç«¯" class="headerlink" title="åœ¨åŒä¸€ä¸ªå‡½æ•°å†…éƒ¨ï¼Œå±€éƒ¨å˜é‡çš„å£°æ˜å¿…é¡»ç½®äºé¡¶ç«¯"></a>åœ¨åŒä¸€ä¸ªå‡½æ•°å†…éƒ¨ï¼Œå±€éƒ¨å˜é‡çš„å£°æ˜å¿…é¡»ç½®äºé¡¶ç«¯</h2><p>å› ä¸ºå³ä½¿æ”¾åˆ°ä¸­é—´ï¼Œjsè§£æå™¨ä¹Ÿä¼šæå‡è‡³é¡¶éƒ¨ï¼ˆhostingï¼‰</p><pre><code class="javascript"> // æ­£ç¡®çš„ä¹¦å†™ var clear = function(el) {     var id = el.id,         name = el.getAttribute(&quot;data-name&quot;);     .........     return true; } // ä¸æ¨èçš„ä¹¦å†™ var clear = function(el) {     var id = el.id;     ......     var name = el.getAttribute(&quot;data-name&quot;);     .........     return true; }</code></pre><h2 id="å—å†…å‡½æ•°å¿…é¡»ç”¨å±€éƒ¨å˜é‡å£°æ˜"><a href="#å—å†…å‡½æ•°å¿…é¡»ç”¨å±€éƒ¨å˜é‡å£°æ˜" class="headerlink" title="å—å†…å‡½æ•°å¿…é¡»ç”¨å±€éƒ¨å˜é‡å£°æ˜"></a>å—å†…å‡½æ•°å¿…é¡»ç”¨å±€éƒ¨å˜é‡å£°æ˜</h2><pre><code class="javascript">// é”™è¯¯çš„å†™æ³• var call = function(name) {     if (name == &quot;hotel&quot;) {         function foo() {             console.log(&quot;hotel foo&quot;);         }     }     foo &amp;&amp; foo(); } // æ¨èçš„å†™æ³• var call = function(name) {     var foo;     if (name == &quot;hotel&quot;) {         foo = function() {             console.log(&quot;hotel foo&quot;);         }     }     foo &amp;&amp; foo(); }</code></pre><p>å¼•èµ·çš„bugï¼šç¬¬ä¸€ç§å†™æ³•fooçš„å£°æ˜è¢«æå‰äº†; è°ƒç”¨callæ—¶ï¼šç¬¬ä¸€ç§å†™æ³•ä¼šè°ƒç”¨fooå‡½æ•°ï¼Œç¬¬äºŒç§å†™æ³•ä¸ä¼šè°ƒç”¨fooå‡½æ•°</p><p>æ³¨ï¼šä¸åŒæµè§ˆå™¨è§£æä¸åŒï¼Œå…·ä½“è¯·ç§»æ­¥æ±¤å§†å¤§å”<a href="http://www.cnblogs.com/TomXu/archive/2012/01/30/2326372.html" target="_blank" rel="noopener">æ·±å…¥è§£æJavascriptå‡½æ•°ç¯‡</a></p><h2 id="ç¦æ­¢ï¼‰ä½¿ç”¨evalï¼Œé‡‡å–-parseJSON"><a href="#ç¦æ­¢ï¼‰ä½¿ç”¨evalï¼Œé‡‡å–-parseJSON" class="headerlink" title="ç¦æ­¢ï¼‰ä½¿ç”¨evalï¼Œé‡‡å–$.parseJSON"></a>ç¦æ­¢ï¼‰ä½¿ç”¨evalï¼Œé‡‡å–$.parseJSON</h2><blockquote><p>ä¸‰ä¸ªåŸå› ï¼š<br>æœ‰æ³¨å…¥é£é™©ï¼Œå°¤å…¶æ˜¯ajaxè¿”å›æ•°æ®<br>ä¸æ–¹ä¾¿debug<br>æ•ˆç‡ä½ï¼Œevalæ˜¯ä¸€ä¸ªæ‰§è¡Œæ•ˆç‡å¾ˆä½çš„å‡½æ•°</p></blockquote><p>å»ºè®®ï¼šä½¿ç”¨new Functionæ¥ä»£æ›¿evalçš„ä½¿ç”¨ï¼Œæœ€å¥½å°±åˆ«ç”¨ã€‚</p><h2 id="é™¤äº†ä¸‰ç›®è¿ç®—ï¼Œif-elseç­‰ï¼ˆç¦æ­¢ï¼‰ç®€å†™"><a href="#é™¤äº†ä¸‰ç›®è¿ç®—ï¼Œif-elseç­‰ï¼ˆç¦æ­¢ï¼‰ç®€å†™" class="headerlink" title="é™¤äº†ä¸‰ç›®è¿ç®—ï¼Œif,elseç­‰ï¼ˆç¦æ­¢ï¼‰ç®€å†™"></a>é™¤äº†ä¸‰ç›®è¿ç®—ï¼Œif,elseç­‰ï¼ˆç¦æ­¢ï¼‰ç®€å†™</h2><pre><code class="javascript"> // æ­£ç¡®çš„ä¹¦å†™ if (true) {     alert(name); } console.log(name); // ä¸æ¨èçš„ä¹¦å†™ if (true)     alert(name); console.log(name); // ä¸æ¨èçš„ä¹¦å†™ if (true) alert(name); console.log(name)</code></pre><h2 id="ï¼ˆæ¨èï¼‰åœ¨éœ€è¦ä»¥-é—­åˆçš„ä»£ç æ®µå‰å¢åŠ æ¢è¡Œï¼Œå¦‚ï¼šfor-if"><a href="#ï¼ˆæ¨èï¼‰åœ¨éœ€è¦ä»¥-é—­åˆçš„ä»£ç æ®µå‰å¢åŠ æ¢è¡Œï¼Œå¦‚ï¼šfor-if" class="headerlink" title="ï¼ˆæ¨èï¼‰åœ¨éœ€è¦ä»¥{}é—­åˆçš„ä»£ç æ®µå‰å¢åŠ æ¢è¡Œï¼Œå¦‚ï¼šfor if"></a>ï¼ˆæ¨èï¼‰åœ¨éœ€è¦ä»¥{}é—­åˆçš„ä»£ç æ®µå‰å¢åŠ æ¢è¡Œï¼Œå¦‚ï¼šfor if</h2><pre><code class="java"> // æ²¡æœ‰æ¢è¡Œï¼Œå°çš„ä»£ç æ®µæ— æ³•åŒºåˆ† if (wl &amp;&amp; wl.length) {     for (i = 0, l = wl.length; i &lt; l; ++i) {         p = wl[i];         type = Y.Lang.type(r[p]);         if (s.hasOwnProperty(p)) {             if (merge &amp;&amp; type == &#39;object&#39;) {                 Y.mix(r[p], s[p]);             } else if (ov || !(p in r)) {                 r[p] = s[p];             }         }     } } // æœ‰äº†æ¢è¡Œï¼Œé€»è¾‘æ¸…æ¥šå¤šäº† if (wl &amp;&amp; wl.length) {     for (i = 0, l = wl.length; i &lt; l; ++i) {         p = wl[i];         type = Y.Lang.type(r[p]);         if (s.hasOwnProperty(p)) {             // å¤„ç†mergeé€»è¾‘             if (merge &amp;&amp; type == &#39;object&#39;) {                 Y.mix(r[p], s[p]);             } else if (ov || !(p in r)) {                 r[p] = s[p];             }         }     } }</code></pre><p>æ¢è¡Œå¯ä»¥æ˜¯ç©ºè¡Œï¼Œä¹Ÿå¯ä»¥æ˜¯æ³¨é‡Š</p><h2 id="æ¨èï¼‰ä½¿ç”¨Functionè¿›è¡Œç±»çš„å®šä¹‰ï¼Œ-ä¸æ¨è-ç»§æ‰¿ï¼Œå¦‚éœ€ç»§æ‰¿é‡‡ç”¨æˆç†Ÿçš„ç±»åº“å®ç°ç»§æ‰¿"><a href="#æ¨èï¼‰ä½¿ç”¨Functionè¿›è¡Œç±»çš„å®šä¹‰ï¼Œ-ä¸æ¨è-ç»§æ‰¿ï¼Œå¦‚éœ€ç»§æ‰¿é‡‡ç”¨æˆç†Ÿçš„ç±»åº“å®ç°ç»§æ‰¿" class="headerlink" title="(æ¨èï¼‰ä½¿ç”¨Functionè¿›è¡Œç±»çš„å®šä¹‰ï¼Œ(ä¸æ¨è)ç»§æ‰¿ï¼Œå¦‚éœ€ç»§æ‰¿é‡‡ç”¨æˆç†Ÿçš„ç±»åº“å®ç°ç»§æ‰¿"></a>(æ¨èï¼‰ä½¿ç”¨Functionè¿›è¡Œç±»çš„å®šä¹‰ï¼Œ(ä¸æ¨è)ç»§æ‰¿ï¼Œå¦‚éœ€ç»§æ‰¿é‡‡ç”¨æˆç†Ÿçš„ç±»åº“å®ç°ç»§æ‰¿</h2><pre><code class="javascript">// ç±»çš„å®ç° function Person(name) {     this.name = name; } Person.prototype.sayName = function() {     alert(this.name); }; var me = new Person(&quot;Nicholas&quot;); // å°†thisæ”¾åˆ°å±€éƒ¨å˜é‡self function Persion(name, sex) {     var self = this;     self.name = name;     self.sex = sex; }</code></pre><p> å¹³æ—¶å’±ä»¬å†™ä»£ç ï¼ŒåŸºæœ¬éƒ½æ˜¯å°ç¨‹åºï¼ŒçœŸå¿ƒç”¨ä¸ä¸Šä»€ä¹ˆç»§æ‰¿ï¼Œè€Œä¸”ç»§æ‰¿å¹¶ä¸æ˜¯JSçš„æ“…é•¿çš„è¯­è¨€ç‰¹æ€§ï¼Œå°½é‡å°‘ç”¨ã€‚å¦‚æœéè¦ä½¿ç”¨çš„è¯ï¼Œæ³¨æ„ä¸€ç‚¹ï¼š</p><pre><code class="java"> function A(){    //...}function B(){    //...}B.prototype = new A();B.prototype.constructor = B; //åŸåˆ™ä¸Šï¼Œè®°å¾—æŠŠè¿™å¥è¯åŠ ä¸Š</code></pre><p> ç»§æ‰¿ä»åŸåˆ™ä¸Šæ¥è®²ï¼Œåˆ«æ”¹å˜ä»–çš„æ„é€ å‡½æ•°ï¼Œå¦åˆ™è¿™ä¸ªç»§æ‰¿å°±æ˜¾å¾—å¾ˆåˆ«æ‰­äº†~ </p><h2 id="æ¨è-ä½¿ç”¨å±€éƒ¨å˜é‡ç¼“å­˜åå¤æŸ¥æ‰¾çš„å¯¹è±¡-åŒ…æ‹¬ä½†ä¸é™äºå…¨å±€å˜é‡ã€domæŸ¥è¯¢ç»“æœã€ä½œç”¨åŸŸé“¾è¾ƒæ·±çš„å¯¹è±¡"><a href="#æ¨è-ä½¿ç”¨å±€éƒ¨å˜é‡ç¼“å­˜åå¤æŸ¥æ‰¾çš„å¯¹è±¡-åŒ…æ‹¬ä½†ä¸é™äºå…¨å±€å˜é‡ã€domæŸ¥è¯¢ç»“æœã€ä½œç”¨åŸŸé“¾è¾ƒæ·±çš„å¯¹è±¡" class="headerlink" title="(æ¨è)ä½¿ç”¨å±€éƒ¨å˜é‡ç¼“å­˜åå¤æŸ¥æ‰¾çš„å¯¹è±¡(åŒ…æ‹¬ä½†ä¸é™äºå…¨å±€å˜é‡ã€domæŸ¥è¯¢ç»“æœã€ä½œç”¨åŸŸé“¾è¾ƒæ·±çš„å¯¹è±¡)"></a>(æ¨è)ä½¿ç”¨å±€éƒ¨å˜é‡ç¼“å­˜åå¤æŸ¥æ‰¾çš„å¯¹è±¡(åŒ…æ‹¬ä½†ä¸é™äºå…¨å±€å˜é‡ã€domæŸ¥è¯¢ç»“æœã€ä½œç”¨åŸŸé“¾è¾ƒæ·±çš„å¯¹è±¡)</h2><pre><code class="java"> // ç¼“å­˜å¯¹è±¡ var getComment = function() {     var dom = $(&quot;#common-container&quot;),               // ç¼“å­˜dom         appendTo = $.appendTo,                      // ç¼“å­˜å…¨å±€å˜é‡         data = this.json.data;                      // ç¼“å­˜ä½œç”¨åŸŸé“¾è¾ƒæ·±çš„å¯¹è±¡ }</code></pre><h2 id="å½“éœ€è¦ç¼“å­˜thisæ—¶å¿…é¡»ä½¿ç”¨selfå˜é‡è¿›è¡Œç¼“å­˜"><a href="#å½“éœ€è¦ç¼“å­˜thisæ—¶å¿…é¡»ä½¿ç”¨selfå˜é‡è¿›è¡Œç¼“å­˜" class="headerlink" title="å½“éœ€è¦ç¼“å­˜thisæ—¶å¿…é¡»ä½¿ç”¨selfå˜é‡è¿›è¡Œç¼“å­˜"></a>å½“éœ€è¦ç¼“å­˜thisæ—¶å¿…é¡»ä½¿ç”¨selfå˜é‡è¿›è¡Œç¼“å­˜</h2><pre><code class="java">// ç¼“å­˜this function Row(name) {     var self = this;     self.name = name;     $(&quot;.row&quot;).click(function() {         self.getName();     }); }</code></pre><p> selfæ˜¯ä¸€ä¸ªä¿ç•™å­—ï¼Œä¸è¿‡ç”¨å®ƒä¹Ÿæ²¡å…³ç³»ã€‚åœ¨è¿™é‡Œï¼Œçœ‹ä¸ªäººçˆ±å¥½å§ï¼Œå¯ä»¥ç”¨_this, that, meç­‰è¿™äº›è¯ï¼Œéƒ½è¡Œï¼Œä½†æ˜¯å›¢é˜Ÿå¼€å‘çš„æ—¶å€™ç»Ÿä¸€ä¸‹æ¯”è¾ƒå¥½ã€‚</p><p>##ï¼ˆä¸æ¨èï¼‰è¶…é•¿å‡½æ•°, å½“å‡½æ•°è¶…è¿‡100è¡Œï¼Œå°±è¦æƒ³æƒ³æ˜¯å¦èƒ½å°†å‡½æ•°æ‹†ä¸ºä¸¤ä¸ªæˆ–å¤šä¸ªå‡½æ•°</p><p><a href="http://www.cnblogs.com/hustskyking/p/javascript-spec.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Standard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Record </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯ä»£ç è§„èŒƒ-CSSç¯‡</title>
      <link href="/2018/04/18/Record/%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83-CSS%E7%AF%87/"/>
      <url>/2018/04/18/Record/%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83-CSS%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h2 id="tabé”®ç”¨ï¼ˆå¿…é¡»ï¼‰å››ä¸ªç©ºæ ¼ä»£æ›¿"><a href="#tabé”®ç”¨ï¼ˆå¿…é¡»ï¼‰å››ä¸ªç©ºæ ¼ä»£æ›¿" class="headerlink" title="tabé”®ç”¨ï¼ˆå¿…é¡»ï¼‰å››ä¸ªç©ºæ ¼ä»£æ›¿"></a>tabé”®ç”¨ï¼ˆå¿…é¡»ï¼‰å››ä¸ªç©ºæ ¼ä»£æ›¿</h2><p>ã€€ã€€å› ä¸ºåœ¨ä¸åŒç³»ç»Ÿçš„ç¼–è¾‘å·¥å…·å¯¹tabè§£æä¸ä¸€æ ·ï¼Œwindowsä¸‹çš„tabé”®æ˜¯å å››ä¸ªç©ºæ ¼çš„ä½ç½®ï¼Œè€Œåœ¨linuxä¸‹ä¼šå˜æˆå å…«ä¸ªç©ºæ ¼çš„ä½ç½®ï¼ˆé™¤éä½ è‡ªå·±è®¾å®šäº†tabé”®æ‰€å çš„ä½ç½®é•¿åº¦ï¼‰ã€‚</p><h2 id="æ¯ä¸ªæ ·å¼å±æ€§åï¼ˆå¿…é¡»ï¼‰åŠ -â€œ-â€"><a href="#æ¯ä¸ªæ ·å¼å±æ€§åï¼ˆå¿…é¡»ï¼‰åŠ -â€œ-â€" class="headerlink" title="æ¯ä¸ªæ ·å¼å±æ€§åï¼ˆå¿…é¡»ï¼‰åŠ  â€œ;â€"></a>æ¯ä¸ªæ ·å¼å±æ€§åï¼ˆå¿…é¡»ï¼‰åŠ  â€œ;â€</h2><pre><code>æ–¹ä¾¿å‹ç¼©å·¥å…·&quot;æ–­å¥&quot;ã€‚</code></pre><h2 id="Classå‘½åä¸­ï¼ˆç¦æ­¢ï¼‰å‡ºç°å¤§å†™å­—æ¯ï¼Œï¼ˆå¿…é¡»ï¼‰é‡‡ç”¨â€-â€œå¯¹classä¸­çš„å­—æ¯åˆ†éš”ï¼Œå¦‚ï¼š"><a href="#Classå‘½åä¸­ï¼ˆç¦æ­¢ï¼‰å‡ºç°å¤§å†™å­—æ¯ï¼Œï¼ˆå¿…é¡»ï¼‰é‡‡ç”¨â€-â€œå¯¹classä¸­çš„å­—æ¯åˆ†éš”ï¼Œå¦‚ï¼š" class="headerlink" title="Classå‘½åä¸­ï¼ˆç¦æ­¢ï¼‰å‡ºç°å¤§å†™å­—æ¯ï¼Œï¼ˆå¿…é¡»ï¼‰é‡‡ç”¨â€ - â€œå¯¹classä¸­çš„å­—æ¯åˆ†éš”ï¼Œå¦‚ï¼š"></a>Classå‘½åä¸­ï¼ˆç¦æ­¢ï¼‰å‡ºç°å¤§å†™å­—æ¯ï¼Œï¼ˆå¿…é¡»ï¼‰é‡‡ç”¨â€ - â€œå¯¹classä¸­çš„å­—æ¯åˆ†éš”ï¼Œå¦‚ï¼š</h2><pre><code class="css"> /* æ­£ç¡®çš„å†™æ³• */ .hotel-title {     font-weight: bold; } /* ä¸æ¨èçš„å†™æ³• */ .hotelTitle {     font-weight: bold; }</code></pre><ul><li>ç”¨â€-â€œéš”å¼€æ¯”ä½¿ç”¨é©¼å³°æ˜¯æ›´åŠ æ¸…æ™°ã€‚</li><li>äº§å“çº¿-äº§å“-æ¨¡å—-å­æ¨¡å—ï¼Œå‘½åçš„æ—¶å€™ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ï¼ˆ@Artwlï¼‰</li></ul><h2 id="ç©ºæ ¼çš„ä½¿ç”¨ï¼Œä»¥ä¸‹è§„åˆ™ï¼ˆå¿…é¡»ï¼‰æ‰§è¡Œï¼š"><a href="#ç©ºæ ¼çš„ä½¿ç”¨ï¼Œä»¥ä¸‹è§„åˆ™ï¼ˆå¿…é¡»ï¼‰æ‰§è¡Œï¼š" class="headerlink" title="ç©ºæ ¼çš„ä½¿ç”¨ï¼Œä»¥ä¸‹è§„åˆ™ï¼ˆå¿…é¡»ï¼‰æ‰§è¡Œï¼š"></a>ç©ºæ ¼çš„ä½¿ç”¨ï¼Œä»¥ä¸‹è§„åˆ™ï¼ˆå¿…é¡»ï¼‰æ‰§è¡Œï¼š</h2><pre><code class="css">.hotel-content {     font-weight: bold; }</code></pre><ul><li>é€‰æ‹©å™¨ä¸ { ä¹‹å‰ï¼ˆå¿…é¡»ï¼‰è¦æœ‰ç©ºæ ¼</li><li>å±æ€§åçš„ : åï¼ˆå¿…é¡»ï¼‰è¦æœ‰ç©ºæ ¼</li><li>å±æ€§åçš„ : å‰ï¼ˆç¦æ­¢ï¼‰åŠ ç©ºæ ¼</li></ul><h2 id="å¤šé€‰æ‹©å™¨è§„åˆ™ä¹‹é—´ï¼ˆå¿…é¡»ï¼‰æ¢è¡Œ"><a href="#å¤šé€‰æ‹©å™¨è§„åˆ™ä¹‹é—´ï¼ˆå¿…é¡»ï¼‰æ¢è¡Œ" class="headerlink" title="å¤šé€‰æ‹©å™¨è§„åˆ™ä¹‹é—´ï¼ˆå¿…é¡»ï¼‰æ¢è¡Œ"></a>å¤šé€‰æ‹©å™¨è§„åˆ™ä¹‹é—´ï¼ˆå¿…é¡»ï¼‰æ¢è¡Œ</h2><p>å½“æ ·å¼é’ˆå¯¹å¤šä¸ªé€‰æ‹©å™¨æ—¶æ¯ä¸ªé€‰æ‹©å™¨å ä¸€è¡Œ</p><pre><code class="css"> /* æ¨èçš„å†™æ³• */ a.btn, input.btn, input[type=&quot;button&quot;] {     ...... }</code></pre><a id="more"></a><h2 id="ï¼ˆç¦æ­¢ï¼‰å°†æ ·å¼å†™ä¸ºå•è¡Œ-å¦‚"><a href="#ï¼ˆç¦æ­¢ï¼‰å°†æ ·å¼å†™ä¸ºå•è¡Œ-å¦‚" class="headerlink" title="ï¼ˆç¦æ­¢ï¼‰å°†æ ·å¼å†™ä¸ºå•è¡Œ, å¦‚"></a>ï¼ˆç¦æ­¢ï¼‰å°†æ ·å¼å†™ä¸ºå•è¡Œ, å¦‚</h2><pre><code class="css">.hotel-content {margin: 10px; background-color: #efefef;}</code></pre><p>å•è¡Œæ˜¾ç¤ºä¸å¥½æ³¨é‡Šï¼Œä¸å¥½å¤‡æ³¨ï¼Œè¿™åº”è¯¥æ˜¯å‹ç¼©å·¥å…·çš„æ´»å„¿~</p><h2 id="ï¼ˆç¦æ­¢ï¼‰å‘-0-åæ·»åŠ å•ä½-å¦‚ï¼š"><a href="#ï¼ˆç¦æ­¢ï¼‰å‘-0-åæ·»åŠ å•ä½-å¦‚ï¼š" class="headerlink" title="ï¼ˆç¦æ­¢ï¼‰å‘ 0 åæ·»åŠ å•ä½, å¦‚ï¼š"></a>ï¼ˆç¦æ­¢ï¼‰å‘ 0 åæ·»åŠ å•ä½, å¦‚ï¼š</h2><pre><code class="css">.obj {    left: 0px;}</code></pre><h2 id="ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨cssåŸç”Ÿimport"><a href="#ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨cssåŸç”Ÿimport" class="headerlink" title="ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨cssåŸç”Ÿimport"></a>ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨cssåŸç”Ÿimport</h2><p>ä½¿ç”¨cssåŸç”Ÿimportæœ‰å¾ˆå¤šå¼Šç«¯ï¼Œæ¯”å¦‚ä¼šå¢åŠ è¯·æ±‚æ•°ç­‰â€¦.</p><h2 id="ï¼ˆæ¨èï¼‰å±æ€§çš„ä¹¦å†™é¡ºåº-ä¸¾ä¸ªä¾‹å­"><a href="#ï¼ˆæ¨èï¼‰å±æ€§çš„ä¹¦å†™é¡ºåº-ä¸¾ä¸ªä¾‹å­" class="headerlink" title="ï¼ˆæ¨èï¼‰å±æ€§çš„ä¹¦å†™é¡ºåº, ä¸¾ä¸ªä¾‹å­:"></a>ï¼ˆæ¨èï¼‰å±æ€§çš„ä¹¦å†™é¡ºåº, ä¸¾ä¸ªä¾‹å­:</h2><pre><code class="css">.hotel-content {     /* å®šä½ */     display: block;     position: absolute;     left: 0;     top: 0;     /* ç›’æ¨¡å‹ */     width: 50px;     height: 50px;     margin: 10px;     border: 1px solid black;     / *å…¶ä»–* /     color: #efefef; }</code></pre><ul><li>å®šä½ç›¸å…³, å¸¸è§çš„æœ‰ï¼šdisplay position left top float ç­‰</li><li>ç›’æ¨¡å‹ç›¸å…³, å¸¸è§çš„æœ‰ï¼šwidth height margin padding border ç­‰</li><li>å…¶ä»–å±æ€§</li></ul><blockquote><p>æŒ‰ç…§è¿™æ ·çš„é¡ºåºä¹¦å†™å¯è§æå‡æµè§ˆå™¨æ¸²æŸ“domçš„æ€§èƒ½<br>ã€€ç®€å•ä¸¾ä¸ªä¾‹å­ï¼Œç½‘é¡µä¸­çš„å›¾ç‰‡ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®widthå’Œheightï¼Œåœ¨å›¾ç‰‡è½½å…¥ä¹‹å‰ï¼Œä»–æ‰€å çš„ç©ºé—´ä¸º0ï¼Œä½†æ˜¯å½“ä»–åŠ è½½å®Œæ¯•ä¹‹åï¼Œé‚£å—ä¸º0çš„ç©ºé—´çªç„¶è¢«æ’‘å¼€äº†ï¼Œè¿™æ ·ä¼šå¯¼è‡´ï¼Œä»–ä¸‹é¢çš„å…ƒç´ é‡æ–°æ’åˆ—å’Œæ¸²æŸ“ï¼Œé€ æˆé‡ç»˜ï¼ˆrepaintï¼‰å’Œå›æµï¼ˆreflowï¼‰ã€‚æˆ‘ä»¬åœ¨å†™cssçš„æ—¶å€™ï¼ŒæŠŠå…ƒç´ çš„å®šä½æ”¾åœ¨å‰å¤´ï¼Œé¦–å…ˆè®©æµè§ˆå™¨çŸ¥é“è¯¥å…ƒç´ æ˜¯åœ¨æ–‡æœ¬æµå†…è¿˜æ˜¯å¤–ï¼Œå…·ä½“åœ¨é¡µé¢çš„å“ªä¸ªéƒ¨ä½ï¼Œæ¥ç€è®©æµè§ˆå™¨çŸ¥é“ä»–ä»¬çš„å®½åº¦å’Œé«˜åº¦ï¼Œborderç­‰è¿™äº›å ç”¨ç©ºé—´çš„å±æ€§ï¼Œå…¶ä»–çš„å±æ€§éƒ½æ˜¯åœ¨è¿™ä¸ªå›ºå®šçš„åŒºåŸŸå†…æ¸²æŸ“çš„ï¼Œå·®ä¸å¤šå°±æ˜¯è¿™ä¸ªæ„æ€å§~(@frec)</p></blockquote><p> æ¨èæ–‡ç« ï¼š <a href="https://css-tricks.com/poll-results-how-do-you-order-your-css-properties/" target="_blank" rel="noopener">https://css-tricks.com/poll-results-how-do-you-order-your-css-properties/</a><br>          <a href="http://www.mozilla.org/css/base/content.css" target="_blank" rel="noopener">http://www.mozilla.org/css/base/content.css</a></p><h2 id="å°å›¾ç‰‡ï¼ˆå¿…é¡»ï¼‰sprite-åˆå¹¶"><a href="#å°å›¾ç‰‡ï¼ˆå¿…é¡»ï¼‰sprite-åˆå¹¶" class="headerlink" title="å°å›¾ç‰‡ï¼ˆå¿…é¡»ï¼‰sprite åˆå¹¶"></a>å°å›¾ç‰‡ï¼ˆå¿…é¡»ï¼‰sprite åˆå¹¶</h2><p>æ¨èæ–‡ç« ï¼š<a href="http://www.alloyteam.com/2012/09/update-ispriter-smart-merging-css-sprite/" target="_blank" rel="noopener">NodeJsæ™ºèƒ½åˆå¹¶CSSç²¾çµå›¾å·¥å…·iSpriter</a></p><h2 id="æ¨èï¼‰å½“ç¼–å†™é’ˆå¯¹ç‰¹å®šhtmlç»“æ„çš„æ ·å¼æ—¶ï¼Œä½¿ç”¨å…ƒç´ å-ç±»å"><a href="#æ¨èï¼‰å½“ç¼–å†™é’ˆå¯¹ç‰¹å®šhtmlç»“æ„çš„æ ·å¼æ—¶ï¼Œä½¿ç”¨å…ƒç´ å-ç±»å" class="headerlink" title="(æ¨èï¼‰å½“ç¼–å†™é’ˆå¯¹ç‰¹å®šhtmlç»“æ„çš„æ ·å¼æ—¶ï¼Œä½¿ç”¨å…ƒç´ å + ç±»å"></a>(æ¨èï¼‰å½“ç¼–å†™é’ˆå¯¹ç‰¹å®šhtmlç»“æ„çš„æ ·å¼æ—¶ï¼Œä½¿ç”¨å…ƒç´ å + ç±»å</h2><p>/<em> æ‰€æœ‰çš„navéƒ½æ˜¯é’ˆå¯¹ulç¼–å†™çš„ </em>/</p><pre><code class="css"> ul.nav {     ...... }</code></pre><p>â€œ.a divâ€å’Œâ€.a div.bâ€ï¼Œä¸ºä»€ä¹ˆåè€…å¥½ï¼Ÿå¦‚æœéœ€æ±‚æœ‰æ‰€å˜åŒ–ï¼Œåœ¨â€.aâ€ä¸‹æœ‰å¤šåŠ äº†ä¸€ä¸ªdivï¼Œè¯•é—®ï¼Œå¼€å§‹çš„æ ·å¼æ˜¯ä¸æ˜¯ä¼šå½±å“åæ¥çš„divå•Š~</p><h2 id="æ¨èï¼‰IE-Hack-List"><a href="#æ¨èï¼‰IE-Hack-List" class="headerlink" title="(æ¨èï¼‰IE Hack List"></a>(æ¨èï¼‰IE Hack List</h2><pre><code class="css"> /* é’ˆå¯¹ieçš„hack */ selector {     property: value;     /* æ‰€æœ‰æµè§ˆå™¨ */      property: value\9;   /* æ‰€æœ‰IEæµè§ˆå™¨ */      property: value\0;   /* IE8 */     +property: value;    /* IE7 */     _property: value;    /* IE6 */     *property: value;    /* IE6-7 */ }</code></pre><p>å½“ä½¿ç”¨hackçš„æ—¶å€™æƒ³æƒ³èƒ½ä¸èƒ½ç”¨æ›´å¥½çš„æ ·å¼ä»£æ›¿</p><h2 id="ï¼ˆä¸æ¨èï¼‰ieä½¿ç”¨filter-ï¼ˆ-ç¦æ­¢ï¼‰ä½¿ç”¨expression"><a href="#ï¼ˆä¸æ¨èï¼‰ieä½¿ç”¨filter-ï¼ˆ-ç¦æ­¢ï¼‰ä½¿ç”¨expression" class="headerlink" title="ï¼ˆä¸æ¨èï¼‰ieä½¿ç”¨filter,ï¼ˆ ç¦æ­¢ï¼‰ä½¿ç”¨expression"></a>ï¼ˆä¸æ¨èï¼‰ieä½¿ç”¨filter,ï¼ˆ ç¦æ­¢ï¼‰ä½¿ç”¨expression</h2><p>è¿™é‡Œä¸»è¦æ˜¯æ•ˆç‡é—®é¢˜ï¼Œåº”è¯¥å½“æ ¼å¤–æ³¨æ„ï¼Œå’±ä»¬è¦å°‘ç”¨çƒ§CPUçš„ä¸œè¥¿~ </p><h2 id="ç¦æ­¢ï¼‰ä½¿ç”¨è¡Œå†…ï¼ˆinlineï¼‰æ ·å¼"><a href="#ç¦æ­¢ï¼‰ä½¿ç”¨è¡Œå†…ï¼ˆinlineï¼‰æ ·å¼" class="headerlink" title="(ç¦æ­¢ï¼‰ä½¿ç”¨è¡Œå†…ï¼ˆinlineï¼‰æ ·å¼"></a>(ç¦æ­¢ï¼‰ä½¿ç”¨è¡Œå†…ï¼ˆinlineï¼‰æ ·å¼</h2><pre><code class="html">&lt;p style=&quot;font-size: 12px; color: #FFFFFF&quot;&gt;é–é¸£å›&lt;/p&gt;</code></pre><p>åƒè¿™æ ·çš„è¡Œå†…æ ·å¼ï¼Œæœ€å¥½ç”¨ä¸€ä¸ªclassä»£æ›¿ã€‚åˆå¦‚è¦éšè—æŸä¸ªå…ƒç´ ï¼Œå¯ä»¥ç»™ä»–åŠ ä¸€ä¸ªclass</p><p>.hide {<br>    display: none;<br>}<br>å°½é‡åšåˆ°æ ·å¼å’Œç»“æ„åˆ†ç¦»~</p><h2 id="ï¼ˆæ¨èï¼‰reset-cssæ ·å¼"><a href="#ï¼ˆæ¨èï¼‰reset-cssæ ·å¼" class="headerlink" title="ï¼ˆæ¨èï¼‰reset.cssæ ·å¼"></a>ï¼ˆæ¨èï¼‰reset.cssæ ·å¼</h2><p>æ¨èç½‘ç«™ï¼š<a href="http://www.cssreset.com/" target="_blank" rel="noopener">http://www.cssreset.com/</a></p><h2 id="ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨â€-â€æ¥é€‰æ‹©å…ƒç´ "><a href="#ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨â€-â€æ¥é€‰æ‹©å…ƒç´ " class="headerlink" title="ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨â€*â€æ¥é€‰æ‹©å…ƒç´ "></a>ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨â€*â€æ¥é€‰æ‹©å…ƒç´ </h2><pre><code class="css">/*åˆ«è¿™æ ·å†™*/* {    margin: 0;    padding: 0;}</code></pre><p>è¿™æ ·å†™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œä¸€äº›å…ƒç´ åœ¨æµè§ˆå™¨ä¸­é»˜è®¤æœ‰marginæˆ–paddingå€¼ï¼Œä½†æ˜¯åªæ˜¯éƒ¨åˆ†å…ƒç´ ï¼Œæ²¡æœ‰å¿…è¦å°†æ‰€æœ‰å…ƒç´ çš„marginã€paddingå€¼éƒ½ç½®ä¸º0ã€‚</p><p>é“¾æ¥çš„æ ·å¼ï¼Œï¼ˆåŠ¡å¿…ï¼‰æŒ‰ç…§è¿™ä¸ªé¡ºåºæ¥ä¹¦å†™</p><pre><code class="css">a:link -&gt; a:visited -&gt; a:hover -&gt; a:active</code></pre><p><a href="http://www.cnblogs.com/hustskyking/p/css-spec.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Standard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Record </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack3,ä»å…¥é—¨åˆ°æ”¾å¼ƒ</title>
      <link href="/2018/04/17/Tools/webpack3-%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/"/>
      <url>/2018/04/17/Tools/webpack3-%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><blockquote><p>é¦–å…ˆï¼Œè¿™ç¯‡æ–‡ç« æ˜¯æ ¹æ® webpack ç‰ˆæœ¬ (å³ v3.4.1) æ’°å†™ï¼Œè¾ƒé•¿ä¸€æ®µæ—¶é—´å†…æ— éœ€æ‹…å¿ƒè¿‡æ—¶çš„é—®é¢˜ã€‚å…¶æ¬¡ï¼Œè¿™åº”è¯¥ä¼šæ˜¯ä¸€ç¯‡æé•¿çš„æ–‡ç« ï¼Œæ¶µç›–äº†åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•ï¼Œæœ‰æ›´é«˜çº§åŠŸèƒ½çš„éœ€æ±‚å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ç»§ç»­å­¦ä¹ ã€‚å†æ¬¡ï¼Œå³ä½¿æ˜¯åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¹Ÿå†…å®¹ç¹å¤šï¼Œæˆ‘å°½å¯èƒ½åœ°è§£é‡Šé€šä¿—æ˜“æ‡‚ï¼Œå°†æˆ‘å­¦ä¹ è¿‡ç¨‹ä¸­çš„ç–‘æƒ‘å’Œå‘ä¸€ä¸€è§£é‡Šï¼Œå¦‚æœ‰çº°æ¼ï¼Œæ•¬è¯·é›…æ­£ã€‚å†æ¬¡ï¼Œä¸ºäº†æ¸…æ™°æœ‰æ•ˆåœ°è®²è§£ï¼Œæˆ‘ä¼šæ¼”ç¤ºä»é›¶ç¼–å†™ demoï¼Œåªè¦ä¸€æ­¥æ­¥è·Ÿç€åšï¼Œå°±ä¼šæ¸…æ™°è®¸å¤šã€‚</p></blockquote><p><a href="https://github.com/zhanghao-web/webpack-demo" target="_blank" rel="noopener">æœ¬æ–‡demoåœ°å€</a></p><h2 id="Webpackï¼Œä½•è®¸äººä¹Ÿï¼Ÿ"><a href="#Webpackï¼Œä½•è®¸äººä¹Ÿï¼Ÿ" class="headerlink" title="Webpackï¼Œä½•è®¸äººä¹Ÿï¼Ÿ"></a>Webpackï¼Œä½•è®¸äººä¹Ÿï¼Ÿ</h2><p>å€Ÿç”¨å®˜æ–¹çš„è¯´æ³•:</p><blockquote><p>webpack is a module bundler. Its main purpose is to bundle JavaScript files for usage in a browser, yet it is also capable of transforming, bundling, or packaging just about any resource or asset.</p></blockquote><p>ç®€è¨€ä¹‹ï¼Œwebpack æ˜¯ä¸€ä¸ªæ¨¡å—æ‰“åŒ…å™¨ (module bundler)ï¼Œèƒ½å¤Ÿå°†ä»»ä½•èµ„æºå¦‚ JavaScript æ–‡ä»¶ã€CSS æ–‡ä»¶ã€å›¾ç‰‡ç­‰æ‰“åŒ…æˆä¸€ä¸ªæˆ–å°‘æ•°æ–‡ä»¶ã€‚</p><h2 id="ä¸ºä»€ä¹ˆè¦ç”¨ä»‹ä¸ª-Webpack"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨ä»‹ä¸ª-Webpack" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨ä»‹ä¸ª Webpack?"></a>ä¸ºä»€ä¹ˆè¦ç”¨ä»‹ä¸ª Webpack?</h2><p>é¦–å…ˆï¼Œå®šä¹‰å·²ç»è¯´æ˜äº† webpack èƒ½å°†å¤šä¸ªèµ„æºæ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å°‘æ•°æ–‡ä»¶ï¼Œè¿™æ„å‘³ç€ä¸ä»¥å¾€çš„å‘èµ·å¤šä¸ª HTTP è¯·æ±‚æ¥è·å¾—èµ„æºç›¸æ¯”ï¼Œç°åœ¨åªéœ€è¦å‘èµ·å°‘é‡çš„ HTTP è¯·æ±‚ã€‚</p><p>å…¶æ¬¡ï¼Œwebpack èƒ½å°†ä½ çš„èµ„æºè½¬æ¢ä¸ºæœ€é€‚åˆæµè§ˆå™¨çš„â€œæ ¼å¼â€ï¼Œæå‡åº”ç”¨æ€§èƒ½ã€‚æ¯”å¦‚åªå¼•ç”¨è¢«åº”ç”¨ä½¿ç”¨çš„èµ„æº (å‰”é™¤æœªè¢«ä½¿ç”¨çš„ä»£ç )ï¼Œæ‡’åŠ è½½èµ„æº (åªåœ¨éœ€è¦çš„æ—¶å€™æ‰åŠ è½½ç›¸åº”çš„èµ„æº)ã€‚</p><p>å†æ¬¡ï¼Œå¯¹äºå¼€å‘é˜¶æ®µï¼Œwebpack ä¹Ÿæä¾›äº†å®æ—¶åŠ è½½å’Œçƒ­åŠ è½½çš„åŠŸèƒ½ï¼Œå¤§å¤§åœ°èŠ‚çœäº†å¼€å‘æ—¶é—´ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰è®¸å¤šä¼˜ç§€ä¹‹å¤„ä¹‹å¤„å€¼å¾—å»æŒ–æ˜ã€‚ä¸è¿‡ï¼Œwebpack æœ€æ ¸å¿ƒçš„è¿˜æ˜¯æ‰“åŒ…çš„åŠŸèƒ½ã€‚</p><h2 id="webpackï¼Œgulp-gruntï¼Œnpmï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#webpackï¼Œgulp-gruntï¼Œnpmï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="webpackï¼Œgulp/gruntï¼Œnpmï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«?"></a>webpackï¼Œgulp/gruntï¼Œnpmï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«?</h2><p>webpack æ˜¯æ¨¡å—æ‰“åŒ…å™¨ï¼ˆmodule bundlerï¼‰ï¼ŒæŠŠæ‰€æœ‰çš„æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å°‘é‡æ–‡ä»¶ï¼Œä½¿ä½ åªéœ€åŠ è½½å°‘é‡æ–‡ä»¶å³å¯è¿è¡Œæ•´ä¸ªåº”ç”¨ï¼Œè€Œæ— éœ€åƒä¹‹å‰é‚£æ ·åŠ è½½å¤§é‡çš„å›¾ç‰‡ï¼Œcssæ–‡ä»¶ï¼Œjsæ–‡ä»¶ï¼Œå­—ä½“æ–‡ä»¶ç­‰ç­‰ã€‚</p><p>è€Œgulpï¼grunt æ˜¯è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œæˆ–è€…å«ä»»åŠ¡è¿è¡Œå™¨ï¼ˆtask runnerï¼‰ï¼Œæ˜¯æŠŠä½ æ‰€æœ‰é‡å¤çš„æ‰‹åŠ¨æ“ä½œè®©ä»£ç æ¥åšï¼Œä¾‹å¦‚å‹ç¼©JSä»£ç ã€CSSä»£ç ï¼Œä»£ç æ£€æŸ¥ã€ä»£ç ç¼–è¯‘ç­‰ç­‰ï¼Œè‡ªåŠ¨åŒ–æ„å»ºå·¥å…·å¹¶ä¸èƒ½æŠŠæ‰€æœ‰æ¨¡å—æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œä¹Ÿä¸èƒ½æ„å»ºä¸åŒæ¨¡å—ä¹‹é—´çš„ä¾èµ–å›¾ã€‚</p><p>ä¸¤è€…æ¥æ¯”è¾ƒçš„è¯ï¼Œgulp/grunt æ— æ³•åšæ¨¡å—æ‰“åŒ…çš„äº‹ï¼Œwebpack è™½ç„¶æœ‰ loader å’Œ pluginå¯ä»¥åšä¸€éƒ¨åˆ† gulpï¼grunt èƒ½åšçš„äº‹ï¼Œä½†æ˜¯ç»ˆç©¶ webpack çš„æ’ä»¶è¿˜æ˜¯ä¸å¦‚ gulpï¼grunt çš„æ’ä»¶ä¸°å¯Œï¼Œèƒ½åšçš„äº‹æ¯”è¾ƒæœ‰é™ã€‚</p><p>äºæ˜¯æœ‰äººä¸¤è€…ç»“åˆç€ç”¨ï¼Œå°† webpack æ”¾åˆ° gulpï¼grunt ä¸­ç”¨ã€‚ç„¶è€Œï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯ç”¨ npm scripts å–ä»£ gulpï¼gruntï¼Œnpm æ˜¯ node çš„åŒ…ç®¡ç†å™¨ (node package manager)ï¼Œç”¨äºç®¡ç† node çš„ç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…ï¼Œnpm å¯¹äºä»»åŠ¡å‘½ä»¤çš„è‰¯å¥½æ”¯æŒè®©ä½ æœ€ç»ˆçœå´äº†ç¼–å†™ä»»åŠ¡ä»£ç çš„å¿…è¦ï¼Œå–è€Œä»£ä¹‹çš„ï¼Œæ˜¯è€ç¥–å®—çš„å‡ ä¸ªå‘½ä»¤è¡Œï¼Œä»…é å‡ å¥å‘½ä»¤è¡Œå°±è¶³ä»¥å®Œæˆä½ çš„æ¨¡å—æ‰“åŒ…å’Œè‡ªåŠ¨åŒ–æ„å»ºçš„æ‰€æœ‰éœ€æ±‚ã€‚</p><a id="more"></a><h2 id="å‡†å¤‡å¼€å§‹"><a href="#å‡†å¤‡å¼€å§‹" class="headerlink" title="å‡†å¤‡å¼€å§‹"></a>å‡†å¤‡å¼€å§‹</h2><p>å…ˆæ¥çœ‹çœ‹ä¸€ä¸ª webpack çš„ä¸€ä¸ªå®Œå¤‡çš„é…ç½®æ–‡ä»¶ï¼Œæ˜¯ <a href="https://webpack.js.org/configuration/#options" target="_blank" rel="noopener">ä»‹æ ·</a> çš„ï¼Œå½“ç„¶å•¦ï¼Œè¿™é‡Œé¢æœ‰å¾ˆå¤šé…ç½®é¡¹æ˜¯å³ä½¿åˆ°è¿™ä¸ªè½¯ä»¶è¢«åºŸå¼ƒä½ ä¹Ÿç”¨ä¸ä¸Šçš„ï¼šï¼‰ï¼Œæ‰€ä»¥æ— éœ€æ‹…å¿ƒã€‚</p><h2 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h2><p>å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®å®šä½ å·²ç»å®‰è£…äº†å½“å‰ Node çš„è¾ƒæ–°ç‰ˆæœ¬ã€‚</p><p>ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä»¥æ–°å»ºæˆ‘ä»¬çš„ demo ç›®å½•ï¼š</p><pre><code class="javascript">$ mkdir webpack-demo &amp;&amp; cd webpack-demo &amp;&amp; npm init -y$ npm i --save-dev webpack$ mkdir src &amp;&amp; cd src &amp;&amp; touch index.js</code></pre><p>æˆ‘ä»¬ä½¿ç”¨å·¥å…·å‡½æ•°åº“ lodash æ¥æ¼”ç¤ºæˆ‘ä»¬çš„ demoã€‚å…ˆå®‰è£…ä¹‹ï¼š</p><pre><code class="javascript">$ npm i --save lodash</code></pre><p>src/index.js</p><pre><code class="javascript">import _ from &#39;lodash&#39;;function component() {  const element = document.createElement(&#39;div&#39;);  element.innerHTML = _.join([&#39;Hello&#39;, &#39;webpack&#39;], &#39; &#39;);  return element;}document.body.appendChild(component());</code></pre><blockquote><p>Tips<br>import å’Œ export å·²ç»æ˜¯ ES6 çš„æ ‡å‡†ï¼Œä½†æ˜¯ä»æœªå¾—åˆ°å¤§å¤šæ•°æµè§ˆå™¨çš„æ”¯æŒ (å¯å–œçš„æ˜¯ï¼Œ Chrome 61 å·²ç»å¼€å§‹é»˜è®¤æ”¯æŒäº†ï¼Œè§ ES6 modules)ï¼Œä¸è¿‡ webpack æä¾›äº†å¯¹è¿™ä¸ªç‰¹æ€§çš„æ”¯æŒï¼Œä½†æ˜¯é™¤äº†è¿™ä¸ªç‰¹æ€§ï¼Œå…¶ä»–çš„ ES6 ç‰¹æ€§å¹¶ä¸ä¼šå¾—åˆ° webpack çš„ç‰¹åˆ«æ”¯æŒï¼Œå¦‚æœ‰éœ€è¦ï¼Œé¡»å€ŸåŠ© Babel è¿›è¡Œè½¬è¯‘ (transpile)ã€‚</p></blockquote><p>ç„¶åæ–°å»ºå‘å¸ƒç‰ˆæœ¬ç›®å½•ï¼š</p><pre><code class="javascript">$ cd .. &amp;&amp; mkdir dist &amp;&amp; cd dist &amp;&amp; touch index.html</code></pre><p>dist/index.html</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&gt;webpack demo&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;script src=&quot;bundle.js&quot;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>ç°åœ¨ï¼Œæˆ‘ä»¬è¿è¡Œ webpack æ¥æ‰“åŒ… index.js ä¸º bundle.jsï¼Œæœ¬åœ°å®‰è£…äº† webpack åå¯ä»¥é€šè¿‡ <code>node_modules/.bin/webpack</code> æ¥è®¿é—® webpack çš„äºŒè¿›åˆ¶ç‰ˆæœ¬ã€‚</p><pre><code class="javascript">$ cd ..$ ./node_modules/.bin/webpack src/index.js dist/bundle.js //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰“åŒ…çš„å…¥å£æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰“åŒ…çš„å‡ºå£æ–‡ä»¶</code></pre><p>å’»å’»å’»ï¼Œå¤§è‡´å¦‚ä¸‹è¾“å‡ºä¸€æ³¢ï¼š</p><pre><code class="javascript">Hash: de8ed072e2c7b3892179Version: webpack 3.4.1Time: 390ms    Asset    Size  Chunks                    Chunk Namesbundle.js  544 kB       0  [emitted]  [big]  main   [0] ./src/index.js 225 bytes {0} [built]   [2] (webpack)/buildin/global.js 509 bytes {0} [built]   [3] (webpack)/buildin/module.js 517 bytes {0} [built]    + 1 hidden module</code></pre><p>ç°åœ¨ï¼Œä½ å·²ç»å¾—åˆ°äº†ä½ çš„ç¬¬ä¸€ä¸ªæ‰“åŒ…æ–‡ä»¶ (bundle.js) äº†ã€‚</p><h2 id="ä½¿ç”¨é…ç½®æ–‡ä»¶"><a href="#ä½¿ç”¨é…ç½®æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨é…ç½®æ–‡ä»¶"></a>ä½¿ç”¨é…ç½®æ–‡ä»¶</h2><p>åƒä¸Šé¢è¿™æ ·ä½¿ç”¨ webpack åº”è¯¥æ˜¯æœ€æŒ«çš„å§¿åŠ¿äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨ webpack çš„é…ç½®æ–‡ä»¶æ¥æé«˜æˆ‘ä»¬çš„å§¿åŠ¿æ°´å¹³ã€‚</p><pre><code class="javascript">$ touch webpack.config.js</code></pre><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);module.exports = {  entry: &#39;./src/index.js&#39;, // å…¥å£èµ·ç‚¹ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªå…¥å£èµ·ç‚¹  output: { // è¾“å‡ºï¼Œåªå¯æŒ‡å®šä¸€ä¸ªè¾“å‡ºé…ç½®    filename: &#39;bundle.js&#39;, // è¾“å‡ºæ–‡ä»¶å    path: path.resolve(__dirname, &#39;dist&#39;) // è¾“å‡ºæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•  }};</code></pre><p>æ‰§è¡Œï¼š</p><pre><code class="javascript">$ ./node_modules/.bin/webpack --config webpack.config.js //`--config` åˆ¶å®š webpack çš„é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯ `webpack.config.js`</code></pre><p>æ‰€ä»¥è¿™é‡Œå¯ä»¥çœå´ <code>--config webpack.config.js</code>ã€‚ä½†æ˜¯æ¯æ¬¡éƒ½è¦å†™ <code>./node_modules/.bin/webpack</code> å®åœ¨è®©äººä¸çˆ½ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åŠ¨ç”¨ <code>NPM Scripts</code>ã€‚</p><p>package.json</p><pre><code class="javascript">{  ...  &quot;scripts&quot;: {    &quot;build&quot;: &quot;webpack&quot;  },  ...}</code></pre><p>æ‰§è¡Œï¼š</p><pre><code class="javascript">$ npm run build</code></pre><p>ä¸€æ³¢è¾“å‡ºåä¾¿å¾—åˆ°äº†æ‰“åŒ…æ–‡ä»¶ã€‚</p><h2 id="æ‰“åŒ…å…¶ä»–ç±»å‹çš„æ–‡ä»¶"><a href="#æ‰“åŒ…å…¶ä»–ç±»å‹çš„æ–‡ä»¶" class="headerlink" title="æ‰“åŒ…å…¶ä»–ç±»å‹çš„æ–‡ä»¶"></a>æ‰“åŒ…å…¶ä»–ç±»å‹çš„æ–‡ä»¶</h2><p>å› ä¸ºå…¶ä»–æ–‡ä»¶å’Œ JS æ–‡ä»¶ç±»å‹ä¸åŒï¼Œè¦æŠŠä»–ä»¬åŠ è½½åˆ° JS æ–‡ä»¶ä¸­å°±éœ€è¦ç»è¿‡åŠ è½½å™¨ (loader) çš„å¤„ç†</p><h3 id="åŠ è½½-CSS"><a href="#åŠ è½½-CSS" class="headerlink" title="åŠ è½½ CSS"></a>åŠ è½½ CSS</h3><p>æˆ‘ä»¬éœ€è¦å®‰è£…ä¸¤ä¸ª loader æ¥å¤„ç† CSS æ–‡ä»¶ï¼š</p><pre><code class="javascript">$ npm i --save-dev style-loader css-loader</code></pre><p>style-loader é€šè¿‡æ’å…¥ style æ ‡ç­¾å°† CSS åŠ å…¥åˆ° DOM ä¸­ï¼Œ<code>css-loader</code> ä¼šåƒè§£é‡Š <code>import/require()</code> ä¸€æ ·è§£é‡Š @import å’Œ url()ã€‚</p><pre><code class="javascript">const path = require(&#39;path&#39;);module.exports = {  entry: &#39;./src/index.js&#39;,  output: {    filename: &#39;bundle.js&#39;,     path: path.resolve(__dirname, &#39;dist&#39;)  },  module: { // å¦‚ä½•å¤„ç†é¡¹ç›®ä¸­ä¸åŒç±»å‹çš„æ¨¡å—    rules: [ // ç”¨äºè§„å®šåœ¨ä¸åŒæ¨¡å—è¢«åˆ›å»ºæ—¶å¦‚ä½•å¤„ç†æ¨¡å—çš„è§„åˆ™æ•°ç»„      {        test: /\.css$/, // åŒ¹é…ç‰¹å®šæ–‡ä»¶çš„æ­£åˆ™è¡¨è¾¾å¼æˆ–æ­£åˆ™è¡¨è¾¾å¼æ•°ç»„        use: [ // åº”ç”¨äºæ¨¡å—çš„ loader ä½¿ç”¨åˆ—è¡¨          &#39;style-loader&#39;,          &#39;css-loader&#39;        ]      }    ]  }};</code></pre><p>æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª CSS æ–‡ä»¶ï¼š</p><pre><code class="javascript">$ cd src &amp;&amp; touch style.css</code></pre><p>src/style.css</p><pre><code class="css">.hello {  color: red;}</code></pre><p>src/index.js</p><pre><code class="javascript">import _ from &#39;lodash&#39;;import &#39;./style.css&#39;; // é€šè¿‡`import`å¼•å…¥ CSS æ–‡ä»¶function component() {  const element = document.createElement(&#39;div&#39;);  element.innerHTML = _.join([&#39;Hello&#39;, &#39;webpack&#39;], &#39; &#39;);  element.classList.add(&#39;hello&#39;); // åœ¨ç›¸åº”å…ƒç´ ä¸Šæ·»åŠ ç±»å  return element;}document.body.appendChild(component());</code></pre><p>æ‰§è¡Œ<code>npm run build</code>ï¼Œç„¶åæ‰“å¼€<code>index.html</code>ï¼Œå°±å¯ä»¥çœ‹åˆ°çº¢è‰²çš„å­—ä½“äº†ã€‚CSS æ–‡ä»¶æ­¤æ—¶å·²ç»è¢«æ‰“åŒ…åˆ° bundle.js ä¸­ã€‚å†æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œå°±å¯ä»¥çœ‹åˆ° webpack åšäº†äº›ä»€ä¹ˆã€‚</p><h3 id="åŠ è½½å›¾ç‰‡"><a href="#åŠ è½½å›¾ç‰‡" class="headerlink" title="åŠ è½½å›¾ç‰‡"></a>åŠ è½½å›¾ç‰‡</h3><pre><code class="javascript">$ npm install --save-dev file-loader</code></pre><p>file-loader æŒ‡ç¤º webpack ä»¥æ–‡ä»¶æ ¼å¼å‘å‡ºæ‰€éœ€å¯¹è±¡å¹¶è¿”å›æ–‡ä»¶çš„å…¬å…±URLï¼Œå¯ç”¨äºä»»ä½•æ–‡ä»¶çš„åŠ è½½ã€‚</p><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);module.exports = {  entry: &#39;./src/index.js&#39;,  output: {    filename: &#39;bundle.js&#39;,     path: path.resolve(__dirname, &#39;dist&#39;)  },  module: {    rules: [      {        test: /\.css$/,        use: [          &#39;style-loader&#39;,          &#39;css-loader&#39;        ]      },      { // å¢åŠ åŠ è½½å›¾ç‰‡çš„è§„åˆ™        test: /\.(png|svg|jpg|gif)$/,        use: [          &#39;file-loader&#39;        ]      }    ]  }};</code></pre><p>æˆ‘ä»¬åœ¨å½“å‰é¡¹ç›®çš„Srcç›®å½•ä¸­å¦‚ä¸‹å¢åŠ å›¾ç‰‡</p><p>src/index.js</p><pre><code class="javascript">import _ from &#39;lodash&#39;;import &#39;./style.css&#39;;import Icon from &#39;./icon.jpg&#39;; // Icon æ˜¯å›¾ç‰‡çš„ URLfunction component() {  const element = document.createElement(&#39;div&#39;);  element.innerHTML = _.join([&#39;Hello&#39;, &#39;webpack&#39;], &#39; &#39;);  element.classList.add(&#39;hello&#39;);  const myIcon = new Image();  myIcon.src = Icon;  element.appendChild(myIcon);  return element;}document.body.appendChild(component());</code></pre><p>src/style.css</p><pre><code class="javascript">.hello {  color: red;  background: url(./icon.jpg);}</code></pre><p>å†<code>npm run build</code>ä¹‹ã€‚ç°åœ¨ä½ å¯ä»¥çœ‹åˆ°å•ç‹¬çš„å›¾ç‰‡å’Œä»¥å›¾ç‰‡ä¸ºåŸºç¡€çš„èƒŒæ™¯å›¾äº†ã€‚</p><h3 id="åŠ è½½å­—ä½“"><a href="#åŠ è½½å­—ä½“" class="headerlink" title="åŠ è½½å­—ä½“"></a>åŠ è½½å­—ä½“</h3><p>åŠ è½½å­—ä½“ç”¨çš„ä¹Ÿæ˜¯ file-loaderã€‚</p><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);module.exports = {  entry: &#39;./src/index.js&#39;,  output: {    filename: &#39;bundle.js&#39;,     path: path.resolve(__dirname, &#39;dist&#39;)  },  module: {    rules: [      {        test: /\.css$/,        use: [          &#39;style-loader&#39;,          &#39;css-loader&#39;        ]      },      {        test: /\.(png|svg|jpg|gif)$/,        use: [          &#39;file-loader&#39;        ]      },      { // å¢åŠ åŠ è½½å­—ä½“çš„è§„åˆ™        test: /\.(woff|woff2|eot|ttf|otf)$/,        use: [          &#39;file-loader&#39;        ]      }    ]  }};</code></pre><p>åœ¨å½“å‰é¡¹ç›®çš„Srcç›®å½•ä¸­å¦‚ä¸‹å¢åŠ å­—ä½“ï¼š</p><p>src/style.css</p><pre><code class="css">@font-face {  font-family: MyFont;  src: url(./my-font.ttf);}.hello {  color: red;  background: url(./icon.jpg);  font-family: MyFont;}</code></pre><p>è¿è¡Œæ‰“åŒ…å‘½ä»¤ä¹‹åä¾¿å¯ä»¥çœ‹åˆ°æ‰“åŒ…å¥½çš„æ–‡ä»¶å’Œå‘ç”Ÿæ”¹å˜çš„é¡µé¢ã€‚</p><h3 id="åŠ è½½-JSON-æ–‡ä»¶"><a href="#åŠ è½½-JSON-æ–‡ä»¶" class="headerlink" title="åŠ è½½ JSON æ–‡ä»¶"></a>åŠ è½½ JSON æ–‡ä»¶</h3><p>å› ä¸º webpack å¯¹ JSON æ–‡ä»¶çš„æ”¯æŒæ˜¯å†…ç½®çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ·»åŠ ã€‚</p><p>src/data.json</p><pre><code class="json">{  &quot;name&quot;: &quot;webpack-demo&quot;,  &quot;version&quot;: &quot;1.0.0&quot;,  &quot;author&quot;: &quot;Sam Yang&quot;}</code></pre><p>src/index.js</p><pre><code class="javascript">import _ from &#39;lodash&#39;;import &#39;./style.css&#39;;import Icon from &#39;./icon.jpg&#39;;import Data from &#39;./data.json&#39;; // Data å˜é‡åŒ…å«å¯ç›´æ¥ä½¿ç”¨çš„ JSON è§£æå¾—åˆ°çš„å¯¹è±¡function component() {  const element = document.createElement(&#39;div&#39;);  element.innerHTML = _.join([&#39;Hello&#39;, &#39;webpack&#39;], &#39; &#39;);  element.classList.add(&#39;hello&#39;);  const myIcon = new Image();  myIcon.src = Icon;  element.appendChild(myIcon);  console.log(Data);  return element;}document.body.appendChild(component());</code></pre><p>å…³äºå…¶ä»–æ–‡ä»¶çš„åŠ è½½ï¼Œå¯ä»¥å¯»æ±‚ç›¸åº”çš„ loaderã€‚</p><h2 id="è¾“å‡ºç®¡ç†"><a href="#è¾“å‡ºç®¡ç†" class="headerlink" title="è¾“å‡ºç®¡ç†"></a>è¾“å‡ºç®¡ç†</h2><p>å‰é¢æˆ‘ä»¬åªæœ‰ä¸€ä¸ªè¾“å…¥æ–‡ä»¶ï¼Œä½†ç°å®æ˜¯æˆ‘ä»¬å¾€å¾€æœ‰ä¸æ­¢ä¸€ä¸ªè¾“å…¥æ–‡ä»¶ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦è¾“å…¥å¤šä¸ªå…¥å£æ–‡ä»¶å¹¶ç®¡ç†è¾“å‡ºæ–‡ä»¶ã€‚æˆ‘ä»¬åœ¨ src ç›®å½•ä¸‹å¢åŠ ä¸€ä¸ª print.js æ–‡ä»¶ã€‚</p><p>src/print.js</p><pre><code class="javascript">export default function printMe() {  console.log(&#39;I get called from print.js!&#39;);}</code></pre><p>src/index.js</p><pre><code class="javascript">import _ from &#39;lodash&#39;;import printMe from &#39;./print.js&#39;;// import &#39;./style.css&#39;;// import Icon from &#39;./icon.jpg&#39;;// import Data from &#39;./data.json&#39;;function component() {  const element = document.createElement(&#39;div&#39;);  const btn = document.createElement(&#39;button&#39;);  element.innerHTML = _.join([&#39;Hello&#39;, &#39;webpack&#39;], &#39; &#39;);  // element.classList.add(&#39;hello&#39;);  // const myIcon = new Image();  // myIcon.src = Icon;  // element.appendChild(myIcon);  // console.log(Data);  btn.innerHTML = &#39;Click me and check the console!&#39;;  btn.onclick = printMe;  element.appendChild(btn);  return element;}document.body.appendChild(component());</code></pre><p>dist/index.html</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&gt;webpack demo&lt;/title&gt;    &lt;script src=&quot;./print.bundle.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;    &lt;!-- &lt;script src=&quot;bundle.js&quot;&gt;&lt;/script&gt; --&gt;    &lt;script src=&quot;./app.bundle.js&quot;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);module.exports = {  // entry: &#39;./src/index.js&#39;,  entry: {    app: &#39;./src/index.js&#39;,    print: &#39;./src/print.js&#39;  },  output: {    // filename: &#39;bundle.js&#39;,    filename: &#39;[name].bundle.js&#39;, // æ ¹æ®å…¥å£èµ·ç‚¹ååŠ¨æ€ç”Ÿæˆ bundle åï¼Œå¯ä»¥ä½¿ç”¨åƒ &quot;js/[name]/bundle.js&quot; è¿™æ ·çš„æ–‡ä»¶å¤¹ç»“æ„    path: path.resolve(__dirname, &#39;dist&#39;)  },  // ...};</code></pre><blockquote><p>Tips<br>filename: â€˜[name].bundle.jsâ€™ä¸­çš„[name]ä¼šæ›¿æ¢ä¸ºå¯¹åº”çš„å…¥å£èµ·ç‚¹åï¼Œå…¶ä»–å¯ç”¨çš„æ›¿æ¢è¯·å‚è§ output.filenameã€‚</p></blockquote><p>ç°åœ¨å¯ä»¥æ‰“åŒ…æ–‡ä»¶äº†ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†å…¥å£æ–‡ä»¶åæˆ–å¢åŠ äº†å…¥å£æ–‡ä»¶ï¼Œindex.htmlæ˜¯ä¸ä¼šè‡ªåŠ¨å¼•ç”¨æ–°æ–‡ä»¶çš„ï¼Œè€Œæ‰‹åŠ¨ä¿®æ”¹å®åœ¨å¤ªæŒ«ã€‚æ˜¯æ—¶å€™ä½¿ç”¨æ’ä»¶ (plugin) æ¥å®Œæˆè¿™ä¸€ä»»åŠ¡äº†ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>HtmlWebpackPlugin</code> è‡ªåŠ¨ç”Ÿæˆ html æ–‡ä»¶ã€‚</p><blockquote><p>loader å’Œ pluginï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<br>loader (åŠ è½½å™¨)ï¼Œé‡åœ¨â€œåŠ è½½â€äºŒå­—ï¼Œæ˜¯ç”¨äºé¢„å¤„ç†æ–‡ä»¶çš„ï¼Œåªç”¨äºåœ¨åŠ è½½ä¸åŒç±»å‹çš„æ–‡ä»¶æ—¶å¯¹ä¸åŒç±»å‹çš„æ–‡ä»¶åšç›¸åº”çš„å¤„ç†ã€‚è€Œ plugin (æ’ä»¶)ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯ç”¨æ¥å¢åŠ  webpack çš„åŠŸèƒ½çš„ï¼Œä½œç”¨äºæ•´ä¸ª webpack çš„æ„å»ºè¿‡ç¨‹ã€‚åœ¨ webpack è¿™ä¸ªå¤§å…¬å¸ä¸­ï¼Œloader æ˜¯ä¿å®‰å¤§å”ï¼Œè´Ÿè´£å¯¹è¿›å…¥å…¬å¸çš„ä¸åŒäººå‘˜çš„å¤„ç†ï¼Œè€Œ plugin åˆ™æ˜¯å…¬å¸é‡Œä¸åŒèŒä½çš„èŒå‘˜ï¼Œè´Ÿè´£å…¬å¸é‡Œçš„å„ç§ä¸åŒä¸šåŠ¡ï¼Œæ¯å¢åŠ ä¸€ç§æ–°å‹çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬å°±éœ€è¦å¢åŠ ä¸€ç§ pluginã€‚</p></blockquote><p>å®‰è£…æ’ä»¶ï¼š</p><pre><code class="javascript">$ npm i --save-dev html-webpack-plugin</code></pre><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);module.exports = {  // entry: &#39;./src/index.js&#39;,  entry: {    app: &#39;./src/index.js&#39;,    print: &#39;./src/print.js&#39;  },  output: {    // filename: &#39;bundle.js&#39;,    filename: &#39;[name].bundle.js&#39;,    path: path.resolve(__dirname, &#39;dist&#39;)  },  plugins: [ // æ’ä»¶å±æ€§ï¼Œæ˜¯æ’ä»¶çš„å®ä¾‹æ•°ç»„    new HtmlWebpackPlugin({      title: &#39;webpack demo&#39;,  // ç”Ÿæˆ HTML æ–‡æ¡£çš„æ ‡é¢˜      filename: &#39;index.html&#39; // å†™å…¥ HTML æ–‡ä»¶çš„æ–‡ä»¶åï¼Œé»˜è®¤ `index.html`    })  ],  // ...};</code></pre><p>ä½ å¯ä»¥å…ˆæŠŠ dist æ–‡ä»¶å¤¹çš„index.htmlæ–‡ä»¶åˆ é™¤ï¼Œç„¶åæ‰§è¡Œæ‰“åŒ…å‘½ä»¤ã€‚å’»å’»å’»ï¼Œæˆ‘ä»¬çœ‹åˆ° dist ç›®å½•ä¸‹å·²ç»è‡ªåŠ¨ç”Ÿæˆäº†ä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼Œä½†å³ä½¿ä¸åˆ é™¤åŸå…ˆçš„index.htmlï¼Œè¯¥æ’ä»¶é»˜è®¤ç”Ÿæˆçš„index.htmlä¹Ÿä¼šæ›¿æ¢åŸæœ¬çš„index.htmlã€‚</p><p>æ­¤åˆ»ï¼Œå½“ä½ ç»†ç»†è§‚å¯Ÿ dist ç›®å½•æ—¶ï¼Œè™½ç„¶ç°åœ¨ç”Ÿæˆäº†æ–°çš„æ‰“åŒ…æ–‡ä»¶ï¼Œä½†åŸæœ¬çš„æ‰“åŒ…æ–‡ä»¶bundle.jsåŠå…¶ä»–ä¸ç”¨çš„æ–‡ä»¶ä»ç„¶å­˜åœ¨åœ¨ dist ç›®å½•ä¸­ï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡æ„å»ºå‰æˆ‘ä»¬éœ€è¦æ™´ç©º dist ç›®å½•ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>CleanWebpackPlugin</code> æ’ä»¶ã€‚</p><pre><code class="javascript">$ npm i clean-webpack-plugin --save-dev</code></pre><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);const CleanWebpackPlugin = require(&#39;clean-webpack-plugin&#39;);module.exports = {  // entry: &#39;./src/index.js&#39;,  entry: {    app: &#39;./src/index.js&#39;,    print: &#39;./src/print.js&#39;  },  output: {    // filename: &#39;bundle.js&#39;,    filename: &#39;[name].bundle.js&#39;,    path: path.resolve(__dirname, &#39;dist&#39;)  },  plugins: [    new HtmlWebpackPlugin({      title: &#39;webpack demo&#39;,      filename: &#39;index.html&#39;    }),    new CleanWebpackPlugin([&#39;dist&#39;]) // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ¸…ç†çš„ç›®å½•çš„å­—ç¬¦ä¸²æ•°ç»„  ],  // ...};</code></pre><p>æ‰“åŒ…ä¹‹ï¼Œç°åœ¨ï¼Œdist ä¸­åªå­˜åœ¨æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶ã€‚</p><h2 id="webpack-æä¾›äº†å¾ˆå¤šä¾¿äºå¼€å‘æ—¶ä½¿ç”¨çš„åŠŸèƒ½ï¼Œæ¥ä¸€ä¸€çœ‹çœ‹å§ã€‚"><a href="#webpack-æä¾›äº†å¾ˆå¤šä¾¿äºå¼€å‘æ—¶ä½¿ç”¨çš„åŠŸèƒ½ï¼Œæ¥ä¸€ä¸€çœ‹çœ‹å§ã€‚" class="headerlink" title="webpack æä¾›äº†å¾ˆå¤šä¾¿äºå¼€å‘æ—¶ä½¿ç”¨çš„åŠŸèƒ½ï¼Œæ¥ä¸€ä¸€çœ‹çœ‹å§ã€‚"></a>webpack æä¾›äº†å¾ˆå¤šä¾¿äºå¼€å‘æ—¶ä½¿ç”¨çš„åŠŸèƒ½ï¼Œæ¥ä¸€ä¸€çœ‹çœ‹å§ã€‚</h2><h3 id="ä½¿ç”¨ä»£ç æ˜ å°„-source-map"><a href="#ä½¿ç”¨ä»£ç æ˜ å°„-source-map" class="headerlink" title="ä½¿ç”¨ä»£ç æ˜ å°„ (source map)"></a>ä½¿ç”¨ä»£ç æ˜ å°„ (source map)</h3><p>å½“ä½ çš„ä»£ç è¢«æ‰“åŒ…åï¼Œå¦‚æœæ‰“åŒ…åçš„ä»£ç å‘ç”Ÿäº†é”™è¯¯ï¼Œä½ å¾ˆéš¾è¿½è¸ªåˆ°é”™è¯¯å‘ç”Ÿçš„åŸå§‹ä½ç½®ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ä»£ç æ˜ å°„ (source map) è¿™ç§å·¥å…·ï¼Œå®ƒèƒ½å°†ç¼–è¯‘åçš„ä»£ç æ˜ å°„å›åŸå§‹çš„æºç ï¼Œä½ çš„é”™è¯¯æ˜¯èµ·æºäºæ‰“åŒ…å‰çš„b.jsçš„æŸä¸ªä½ç½®ï¼Œä»£ç æ˜ å°„å°±èƒ½å‘Šè¯‰ä½ é”™è¯¯æ˜¯é‚£ä¸ªæ¨¡å—çš„é‚£ä¸ªä½ç½®ã€‚webpack é»˜è®¤æä¾›äº† 10 ç§é£æ ¼çš„ä»£ç æ˜ å°„ï¼Œä½¿ç”¨å®ƒä»¬ä¼šæ˜æ˜¾å½±å“åˆ°æ„å»º (build) å’Œé‡æ„å»º (rebuildï¼Œæ¯æ¬¡ä¿®æ”¹åéœ€è¦é‡æ–°æ„å»º) çš„é€Ÿåº¦ï¼Œåç§é£æ ¼çš„å·®å¼‚å¯ä»¥å‚çœ‹ devtoolã€‚å…³äºå¦‚ä½•é€‰æ‹©æ˜ å°„é£æ ¼å¯ä»¥å‚çœ‹ Webpack devtool source mapã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä¸ºäº†å‡†ç¡®æ˜¾ç¤ºé”™è¯¯ä½ç½®ï¼Œé€‰æ‹©é€Ÿåº¦è¾ƒæ…¢çš„<code>inline-source-map</code>ã€‚</p><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);const CleanWebpackPlugin = require(&#39;clean-webpack-plugin&#39;);module.exports = {  devtool: &#39;inline-source-map&#39;, // æ§åˆ¶æ˜¯å¦ç”Ÿæˆä»¥åŠå¦‚ä½•ç”Ÿæˆ source map  // entry: &#39;./src/index.js&#39;,  entry: {    app: &#39;./src/index.js&#39;,    print: &#39;./src/print.js&#39;  },  // ...};</code></pre><p>ç°åœ¨æ¥æ‰‹åŠ¨åˆ¶é€ ä¸€äº›é”™è¯¯ï¼š</p><p>src/print.js</p><pre><code class="javascript">  export default function printMe() {-   console.log(&#39;I get called from print.js!&#39;);+   cosnole.log(&#39;I get called from print.js!&#39;);  }</code></pre><p>æ‰“åŒ…ä¹‹åæ‰“å¼€index.htmlå†ç‚¹å‡»æŒ‰é’®ï¼Œä½ å°±ä¼šçœ‹åˆ°æ§åˆ¶å°æ˜¾ç¤ºå¦‚ä¸‹æŠ¥é”™ï¼š</p><pre><code class="javascript"> Uncaught ReferenceError: cosnole is not defined    at HTMLButtonElement.printMe (print.js:2)</code></pre><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¾ˆæ¸…æ¥šå“ªé‡Œå‘ç”Ÿäº†é”™è¯¯ï¼Œç„¶åè½»æ¾åœ°æ”¹æ­£ä¹‹ã€‚</p><h3 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h3><p>ä½ ä¸€å®šæœ‰è¿™æ ·çš„ä½“éªŒï¼Œå¼€å‘æ—¶æ¯æ¬¡ä¿®æ”¹ä»£ç ä¿å­˜åéƒ½éœ€è¦é‡æ–°æ‰‹åŠ¨æ„å»ºä»£ç å¹¶æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨ä»¥è§‚å¯Ÿä¿®æ”¹æ•ˆæœï¼Œè¿™æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¦å®æ—¶åŠ è½½ä»£ç ã€‚å¯å–œçš„æ˜¯ï¼Œwebpack æä¾›äº†å¯¹å®æ—¶åŠ è½½ä»£ç çš„æ”¯æŒã€‚æˆ‘ä»¬éœ€è¦å®‰è£… webpack-dev-server ä»¥è·å¾—æ”¯æŒã€‚</p><pre><code class="javascript">$ npm i --save-dev webpack-dev-server</code></pre><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);const CleanWebpackPlugin = require(&#39;clean-webpack-plugin&#39;);module.exports = {  devtool: &#39;inline-source-map&#39;,  devServer: { // æ£€æµ‹ä»£ç å˜åŒ–å¹¶è‡ªåŠ¨é‡æ–°ç¼–è¯‘å¹¶è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨    contentBase: path.resolve(__dirname, &#39;dist&#39;) // è®¾ç½®é™æ€èµ„æºçš„æ ¹ç›®å½•  },  // entry: &#39;./src/index.js&#39;,  entry: {    app: &#39;./src/index.js&#39;,    print: &#39;./src/print.js&#39;  },  // ...};</code></pre><p>package.json</p><pre><code class="javascript">{  ...  &quot;scripts&quot;: {    &quot;build&quot;: &quot;webpack&quot;,    &quot;start&quot;: &quot;webpack-dev-server --open&quot;  },  ...}</code></pre><blockquote><p>Tips<br>ä½¿ç”¨ webpack-dev-server æ—¶ï¼Œwebpack å¹¶æ²¡æœ‰å°†æ‰€æœ‰ç”Ÿæˆçš„æ–‡ä»¶å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯æ”¾åœ¨å†…å­˜ä¸­ï¼Œæä¾›æ›´å¿«çš„å†…å­˜å†…è®¿é—®ï¼Œä¾¿äºå®æ—¶æ›´æ–°ã€‚</p></blockquote><p>ç°åœ¨ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œ<code>npm start</code> (startæ˜¯ npm scripts çš„å†…ç½®å±æ€§ï¼Œå¯ç›´æ¥è¿è¡Œ)ï¼Œç„¶åæµè§ˆå™¨è‡ªåŠ¨åŠ è½½åº”ç”¨çš„é¡µé¢ï¼Œé»˜è®¤åœ¨<code>localhost:8080</code>æ˜¾ç¤ºã€‚</p><h2 id="æ¨¡å—çƒ­æ›¿æ¢-HMR-Hot-Module-Replacement"><a href="#æ¨¡å—çƒ­æ›¿æ¢-HMR-Hot-Module-Replacement" class="headerlink" title="æ¨¡å—çƒ­æ›¿æ¢ (HMR, Hot Module Replacement)"></a>æ¨¡å—çƒ­æ›¿æ¢ (HMR, Hot Module Replacement)</h2><p>webpack æä¾›äº†å¯¹æ¨¡å—çƒ­æ›¿æ¢ (æˆ–è€…å«çƒ­åŠ è½½) çš„æ”¯æŒã€‚è¿™ä¸€ç‰¹æ€§èƒ½å¤Ÿè®©åº”ç”¨è¿è¡Œçš„æ—¶å€™æ›¿æ¢ã€å¢åŠ æˆ–åˆ é™¤æ¨¡å—ï¼Œè€Œæ— éœ€è¿›è¡Œå®Œå…¨çš„é‡è½½ã€‚æƒ³è¿›ä¸€æ­¥åœ°äº†è§£å…¶å·¥ä½œæœºç†ï¼Œå¯ä»¥å‚è§ Hot Module Replacementï¼Œä½†è¿™å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œä½ å¯ä»¥é€‰æ‹©è·³è¿‡æœºç†éƒ¨åˆ†ç»§ç»­å¾€ä¸‹é˜…è¯»ã€‚</p><blockquote><p>Tips<br>æ¨¡å—çƒ­æ›¿æ¢ï¼ˆHMRï¼‰åªæ›´æ–°å‘ç”Ÿå˜æ›´ï¼ˆæ›¿æ¢ã€æ·»åŠ ã€åˆ é™¤ï¼‰çš„æ¨¡å—ï¼Œè€Œæ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ï¼ˆå®æ—¶åŠ è½½ï¼ŒLiveReloadï¼‰ï¼Œè¿™æ ·å¯ä»¥æ˜¾è‘—åŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œä¸€æ—¦æ‰“å¼€äº† webpack-dev-server çš„ hot æ¨¡å¼ï¼Œåœ¨è¯•å›¾é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ä¹‹å‰ï¼Œçƒ­æ¨¡å¼ä¼šå°è¯•ä½¿ç”¨ HMR æ¥æ›´æ–°ã€‚</p></blockquote><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);const CleanWebpackPlugin = require(&#39;clean-webpack-plugin&#39;);const webpack = require(&#39;webpack&#39;); // å¼•å…¥ webpack ä¾¿äºè°ƒç”¨å…¶å†…ç½®æ’ä»¶module.exports = {  devtool: &#39;inline-source-map&#39;,  devServer: {    contentBase: path.resolve(__dirname, &#39;dist&#39;),    hot: true, // å‘Šè¯‰ dev-server æˆ‘ä»¬åœ¨ç”¨ HMR    hotOnly: true // æŒ‡å®šå¦‚æœçƒ­åŠ è½½å¤±è´¥äº†ç¦æ­¢åˆ·æ–°é¡µé¢ (è¿™æ˜¯ webpack çš„é»˜è®¤è¡Œä¸º)ï¼Œè¿™æ ·ä¾¿äºæˆ‘ä»¬çŸ¥é“å¤±è´¥æ˜¯å› ä¸ºä½•ç§é”™è¯¯  },  // entry: &#39;./src/index.js&#39;,  entry: {    app: &#39;./src/index.js&#39;,    // print: &#39;./src/print.js&#39;  },  // ...  plugins: [    new HtmlWebpackPlugin({      title: &#39;webpack demo&#39;,      filename: &#39;index.html&#39;    }),    new CleanWebpackPlugin([&#39;dist&#39;]),    new webpack.HotModuleReplacementPlugin(), // å¯ç”¨ HMR    new webpack.NamedModulesPlugin() // æ‰“å°æ—¥å¿—ä¿¡æ¯æ—¶ webpack é»˜è®¤ä½¿ç”¨æ¨¡å—çš„æ•°å­— ID æŒ‡ä»£æ¨¡å—ï¼Œä¸ä¾¿äº debugï¼Œè¿™ä¸ªæ’ä»¶å¯ä»¥å°†å…¶æ›¿æ¢ä¸ºæ¨¡å—çš„çœŸå®è·¯å¾„  ],  // ...};</code></pre><blockquote><p>Tips<br>webpack-dev-server ä¼šä¸ºæ¯ä¸ªå…¥å£æ–‡ä»¶åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬ä¼šç›‘æ§è¯¥å…¥å£æ–‡ä»¶çš„ä¾èµ–æ¨¡å—çš„æ›´æ–°ï¼Œå¦‚æœè¯¥å…¥å£æ–‡ä»¶ç¼–å†™äº† HMR å¤„ç†å‡½æ•°ï¼Œå®ƒå°±èƒ½æ¥æ”¶ä¾èµ–æ¨¡å—çš„æ›´æ–°ï¼Œåä¹‹ï¼Œæ›´æ–°ä¼šå‘ä¸Šå†’æ³¡ï¼Œç›´åˆ°å®¢æˆ·ç«¯è„šæœ¬ä»æ²¡æœ‰å¤„ç†å‡½æ•°çš„è¯ï¼Œwebpack-dev-server ä¼šé‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ã€‚å¦‚æœå…¥å£æ–‡ä»¶æœ¬èº«å‘ç”Ÿäº†æ›´æ–°ï¼Œå› ä¸ºå‘ä¸Šä¼šå†’æ³¡åˆ°å®¢æˆ·ç«¯è„šæœ¬ï¼Œå¹¶ä¸”ä¸å­˜åœ¨ HMR å¤„ç†å‡½æ•°ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´é¡µé¢é‡è½½ã€‚</p></blockquote><p>æˆ‘ä»¬å·²ç»å¼€å¯äº† HMR çš„åŠŸèƒ½ï¼ŒHMR çš„æ¥å£å·²ç»æš´éœ²åœ¨<code>module.hot</code>å±æ€§ä¹‹ä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ HMR API å³å¯å®ç°çƒ­åŠ è½½ã€‚å½“â€œè¢«åŠ è½½æ¨¡å—â€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¾èµ–è¯¥æ¨¡å—çš„æ¨¡å—ä¾¿èƒ½æ£€æµ‹åˆ°æ”¹å˜å¹¶æ¥æ”¶æ”¹å˜ä¹‹åçš„æ¨¡å—ã€‚</p><p>src/index.js</p><pre><code class="javascript">import _ from &#39;lodash&#39;;import printMe from &#39;./print.js&#39;;// import &#39;./style.css&#39;;// import Icon from &#39;./icon.jpg&#39;;// import Data from &#39;./data.json&#39;;function component() {  const element = document.createElement(&#39;div&#39;);  const btn = document.createElement(&#39;button&#39;);  element.innerHTML = _.join([&#39;Hello&#39;, &#39;webpack&#39;], &#39; &#39;);  // element.classList.add(&#39;hello&#39;);  // const myIcon = new Image();  // myIcon.src = Icon;  // element.appendChild(myIcon);  // console.log(Data);  btn.innerHTML = &#39;Click me and check the console!&#39;;  btn.onclick = printMe;  element.appendChild(btn);  return element;}document.body.appendChild(component());if(module.hot) { // ä¹ æƒ¯ä¸Šæˆ‘ä»¬ä¼šæ£€æŸ¥æ˜¯å¦å¯ä»¥è®¿é—® `module.hot` å±æ€§  module.hot.accept(&#39;./print.js&#39;, function() { // æ¥å—ç»™å®šä¾èµ–æ¨¡å—çš„æ›´æ–°ï¼Œå¹¶è§¦å‘ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¯¹è¿™äº›æ›´æ–°åšå‡ºå“åº”    console.log(&#39;Accepting the updated printMe module!&#39;);    printMe();  });}</code></pre><p><code>npm start</code>ä¹‹ã€‚ä¸ºäº†æ¼”ç¤ºæ•ˆæœï¼Œæˆ‘ä»¬åšå¦‚ä¸‹ä¿®æ”¹ï¼š</p><p>src/print.js</p><pre><code class="javascript">  export default function printMe() {-   console.log(&#39;I get called from print.js!&#39;);+   console.log(&#39;Updating print.js...&#39;);  }</code></pre><p>æˆ‘ä»¬ä¼šçœ‹åˆ°æ§åˆ¶å°æ‰“å°å‡ºçš„ä¿¡æ¯ä¸­å«æœ‰ä»¥ä¸‹å‡ è¡Œï¼š</p><pre><code class="javascript">index.js:33 Accepting the updated printMe module!print.js:2 Updating print.js...log.js:23 [HMR] Updated modules:log.js:23 [HMR]  - ./src/print.jslog.js:23 [HMR] App is up to date.</code></pre><blockquote><p>Tips<br>webpack-dev-server åœ¨ inline mode (æ­¤ä¸ºé»˜è®¤æ¨¡å¼) æ—¶ï¼Œä¼šä¸ºæ¯ä¸ªå…¥å£èµ·ç‚¹ (entry) åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯è„šæœ¬ï¼Œæ‰€ä»¥ä½ ä¼šåœ¨ä¸Šé¢çš„è¾“å‡ºä¸­çœ‹åˆ°æœ‰äº›ä¿¡æ¯é‡å¤è¾“å‡ºä¸¤æ¬¡ã€‚</p></blockquote><p>ä½†æ˜¯å½“ä½ ç‚¹å‡»é¡µé¢çš„æŒ‰é’®æ—¶ï¼Œä½ ä¼šå‘ç°æ§åˆ¶å°è¾“å‡ºçš„æ˜¯æ—§çš„printMeå‡½æ•°è¾“å‡ºçš„ä¿¡æ¯ï¼Œå› ä¸ºonclickäº‹ä»¶ç»‘å®šçš„ä»æ˜¯åŸå§‹çš„printMeå‡½æ•°ã€‚æˆ‘ä»¬éœ€è¦åœ¨module.hot.accepté‡Œæ›´æ–°ç»‘å®šã€‚</p><p>src/index.js</p><pre><code class="javascript">import _ from &#39;lodash&#39;;import printMe from &#39;./print.js&#39;;// import &#39;./style.css&#39;;// import Icon from &#39;./icon.jpg&#39;;// import Data from &#39;./data.json&#39;;// ...// document.body.appendChild(component());var element = component();document.body.appendChild(element);if(module.hot) {  module.hot.accept(&#39;./print.js&#39;, function() {    console.log(&#39;Accepting the updated printMe module!&#39;);    // printMe();    document.body.removeChild(element);    element = component();    document.body.appendChild(element);  });}</code></pre><p>æ¨¡å—çƒ­æ›¿æ¢ä¹Ÿå¯ä»¥ç”¨äºæ ·å¼çš„ä¿®æ”¹ï¼Œæ•ˆæœè·Ÿæ§åˆ¶å°ä¿®æ”¹ä¸€æ ·ä¸€æ ·çš„ã€‚</p><p>src/index.js</p><pre><code class="javascript">import _ from &#39;lodash&#39;;import printMe from &#39;./print.js&#39;;import &#39;./style.css&#39;;// import Icon from &#39;./icon.jpg&#39;;// import Data from &#39;./data.json&#39;;// ...</code></pre><p><code>npm start</code>ä¹‹ï¼Œåšå¦‚ä¸‹ä¿®æ”¹ï¼š</p><pre><code class="css">/* ... */body {  background-color: yellow;}</code></pre><p>å¯ä»¥å‘ç°åœ¨ä¸é‡è½½é¡µé¢çš„å‰æä¸‹æˆ‘ä»¬å¯¹æ ·å¼çš„ä¿®æ”¹è¿›è¡Œäº†çƒ­åŠ è½½ï¼Œæ£’ï¼</p><h2 id="ç”Ÿäº§ç¯å¢ƒ"><a href="#ç”Ÿäº§ç¯å¢ƒ" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒ"></a>ç”Ÿäº§ç¯å¢ƒ</h2><h3 id="è‡ªåŠ¨æ–¹å¼"><a href="#è‡ªåŠ¨æ–¹å¼" class="headerlink" title="è‡ªåŠ¨æ–¹å¼"></a>è‡ªåŠ¨æ–¹å¼</h3><p>æˆ‘ä»¬åªéœ€è¦è¿è¡Œwebpack -p (ç›¸å½“äº webpack â€“optimize-minimize â€“define process.env.NODE_ENV=â€â€˜productionâ€™â€)è¿™ä¸ªå‘½ä»¤ï¼Œä¾¿å¯ä»¥è‡ªåŠ¨æ„å»ºç”Ÿäº§ç‰ˆæœ¬çš„åº”ç”¨ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šå®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li>ä½¿ç”¨ UglifyJsPlugin (webpack.optimize.UglifyJsPlugin) å‹ç¼© JS æ–‡ä»¶ (æ­¤æ’ä»¶å’Œ uglifyjs-webpack-plugin ç›¸åŒ)</li><li>è¿è¡Œ LoaderOptionsPlugin æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶æ˜¯ç”¨æ¥è¿ç§»çš„ï¼Œè§ document</li><li>è®¾ç½® NodeJS çš„ç¯å¢ƒå˜é‡ï¼Œè§¦å‘æŸäº› package åŒ…ä»¥ä¸åŒæ–¹å¼ç¼–è¯‘</li></ul><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œwebpack -pè®¾ç½®çš„process.env.NODE_ENVç¯å¢ƒå˜é‡ï¼Œæ˜¯ç”¨äºç¼–è¯‘åçš„ä»£ç çš„ï¼Œåªæœ‰åœ¨æ‰“åŒ…åçš„ä»£ç ä¸­ï¼Œè¿™ä¸€ç¯å¢ƒå˜é‡æ‰æ˜¯æœ‰æ•ˆçš„ã€‚å¦‚æœåœ¨ webpack é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨æ­¤ç¯å¢ƒå˜é‡ï¼Œå¾—åˆ°çš„æ˜¯ undefinedï¼Œå¯ä»¥å‚è§ #2537ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶æˆ‘ä»¬ç¡®å®éœ€è¦åœ¨ webpack é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ process.env.NODE_ENVï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿä¸€ä¸ªæ–¹æ³•æ˜¯è¿è¡ŒNODE_ENV=â€™productionâ€™ webpack -på‘½ä»¤ï¼Œä¸è¿‡è¿™ä¸ªå‘½ä»¤åœ¨Windowsä¸­æ˜¯ä¼šå‡ºé—®é¢˜çš„ã€‚ä¸ºäº†è§£å†³å…¼å®¹é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨ <code>cross-env</code> è§£å†³è·¨å¹³å°çš„é—®é¢˜ã€‚</p><pre><code class="javascript">$ npm i --save-dev cross-env</code></pre><p>package.json</p><pre><code class="json">{  ...  &quot;scripts&quot;: {    &quot;build&quot;: &quot;cross-env NODE_ENV=production webpack -p&quot;,    &quot;start&quot;: &quot;webpack-dev-server --open&quot;  },  ...}</code></pre><p>ç°åœ¨å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨<code>process.env.NODE_ENV</code>äº†ã€‚</p><p>webpack.config.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);const CleanWebpackPlugin = require(&#39;clean-webpack-plugin&#39;);const webpack = require(&#39;webpack&#39;);module.exports = {  // ...  output: {    // filename: &#39;bundle.js&#39;,    // filename: &#39;[name].bundle.js&#39;,    filename: process.env.NODE_ENV === &#39;production&#39; ? &#39;[name].[chunkhash].js&#39; : &#39;[name].bundle.js&#39;, // åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨`process.env.NODE_ENV`    path: path.resolve(__dirname, &#39;dist&#39;)  },  plugins: [    new HtmlWebpackPlugin({      title: &#39;webpack demo&#39;,      filename: &#39;index.html&#39;    }),    new CleanWebpackPlugin([&#39;dist&#39;]),    // new webpack.HotModuleReplacementPlugin(), // å…³é—­ HMR åŠŸèƒ½    new webpack.NamedModulesPlugin()  ],  // ...};</code></pre><blockquote><p>Tips<br>[chunkhash]ä¸èƒ½å’Œ HMR ä¸€èµ·ä½¿ç”¨ï¼Œæ¢å¥è¯è¯´ï¼Œä¸åº”è¯¥åœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ [chunkhash] (æˆ–è€… [hash])ï¼Œè¿™ä¼šå¯¼è‡´è®¸å¤šé—®é¢˜ã€‚</p></blockquote><p>build ä¹‹ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç”Ÿäº§ç‰ˆæœ¬çš„å‹ç¼©å¥½çš„æ‰“åŒ…æ–‡ä»¶ã€‚</p><h3 id="å¤šé…ç½®æ–‡ä»¶é…ç½®"><a href="#å¤šé…ç½®æ–‡ä»¶é…ç½®" class="headerlink" title="å¤šé…ç½®æ–‡ä»¶é…ç½®"></a>å¤šé…ç½®æ–‡ä»¶é…ç½®</h3><p>æœ‰æ—¶æˆ‘ä»¬ä¼šéœ€è¦ä¸ºä¸åŒçš„ç¯å¢ƒé…ç½®ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥é€‰æ‹© ç®€æ˜“æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨è¾ƒä¸ºå…ˆè¿›çš„æ–¹æ³•ã€‚å…ˆå‡†å¤‡ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«äº†æ‰€æœ‰ç¯å¢ƒéƒ½åŒ…å«çš„é…ç½®ï¼Œç„¶åç”¨ <code>webpack-merge</code> å°†å®ƒå’Œç‰¹å®šç¯å¢ƒçš„é…ç½®æ–‡ä»¶åˆå¹¶å¹¶å¯¼å‡ºï¼Œè¿™æ ·å°±å‡å°‘äº†åŸºæœ¬é…ç½®çš„é‡å¤ã€‚</p><pre><code class="javascript">$ npm i --save-dev webpack-merge</code></pre><p>webpack.common.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);const CleanWebpackPlugin = require(&#39;clean-webpack-plugin&#39;);module.exports = {  entry: {    app: &#39;./src/index.js&#39;,    print: &#39;./src/print.js&#39;  },  output: {    path: path.resolve(__dirname, &#39;dist&#39;)  },  plugins: [    new HtmlWebpackPlugin({      title: &#39;webpack demo&#39;,      filename: &#39;index.html&#39;    }),    new CleanWebpackPlugin([&#39;dist&#39;])  ],  module: {    rules: [      {        test: /\.css$/,        use: [          &#39;style-loader&#39;,          &#39;css-loader&#39;        ]      },      {        test: /\.(png|svg|jpg|gif)$/,        use: [          &#39;file-loader&#39;        ]      },      {        test: /\.(woff|woff2|eot|ttf|otf)$/,        use: [          &#39;file-loader&#39;        ]      }    ]  }};</code></pre><p>webpack.dev.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);const webpack = require(&#39;webpack&#39;);const Merge = require(&#39;webpack-merge&#39;);const CommonConfig = require(&#39;./webpack.common.js&#39;);module.exports = Merge(CommonConfig, {  devtool: &#39;cheap-module-eval-source-map&#39;,  devServer: {    contentBase: path.resolve(__dirname, &#39;dist&#39;),    hot: true,    hotOnly: true  },  output: {    filename: &#39;[name].bundle.js&#39;  },  plugins: [    new webpack.DefinePlugin({      &#39;process.env.NODE_ENV&#39;: JSON.stringify(&#39;development&#39;) // åœ¨ç¼–è¯‘çš„ä»£ç é‡Œè®¾ç½®äº†`process.env.NODE_ENV`å˜é‡    }),    new webpack.HotModuleReplacementPlugin(),    new webpack.NamedModulesPlugin()  ]});</code></pre><p>webpack.prod.js</p><pre><code class="javascript">const path = require(&#39;path&#39;);const webpack = require(&#39;webpack&#39;);const Merge = require(&#39;webpack-merge&#39;);const CommonConfig = require(&#39;./webpack.common.js&#39;);module.exports = Merge(CommonConfig, {  devtool: &#39;cheap-module-source-map&#39;,  output: {    filename: &#39;[name].[chunkhash].js&#39;  },  plugins: [    new webpack.DefinePlugin({      &#39;process.env.NODE_ENV&#39;: JSON.stringify(&#39;production&#39;)    }),    new webpack.optimize.UglifyJsPlugin()  ]});</code></pre><p>package.json</p><pre><code class="json">{  ...  &quot;scripts&quot;: {    &quot;build&quot;: &quot;cross-env NODE_ENV=production webpack -p&quot;,    &quot;start&quot;: &quot;webpack-dev-server --open&quot;,    &quot;build:dev&quot;: &quot;webpack-dev-server --open --config webpack.dev.js&quot;,    &quot;build:prod&quot;: &quot;webpack --progress --config webpack.prod.js&quot;  },  ...}</code></pre><p>ç°åœ¨åªéœ€æ‰§è¡Œnpm run build:devæˆ–npm run build:prodä¾¿å¯ä»¥å¾—åˆ°å¼€å‘ç‰ˆæˆ–è€…ç”Ÿäº§ç‰ˆäº†ï¼</p><p><a href="https://segmentfault.com/a/1190000010871559" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSé«˜çº§ä¹‹é¢è¯•å¿…é¡»çŸ¥é“çš„å‡ ä¸ªç‚¹</title>
      <link href="/2018/04/16/Interview/JS%E9%AB%98%E7%BA%A7%E4%B9%8B%E9%9D%A2%E8%AF%95%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E7%9A%84%E5%87%A0%E4%B8%AA%E7%82%B9/"/>
      <url>/2018/04/16/Interview/JS%E9%AB%98%E7%BA%A7%E4%B9%8B%E9%9D%A2%E8%AF%95%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E7%9A%84%E5%87%A0%E4%B8%AA%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="å‡½æ•°çš„3ç§å®šä¹‰"><a href="#å‡½æ•°çš„3ç§å®šä¹‰" class="headerlink" title="å‡½æ•°çš„3ç§å®šä¹‰"></a>å‡½æ•°çš„3ç§å®šä¹‰</h1><h2 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°å£°æ˜"></a>å‡½æ•°å£°æ˜</h2><pre><code class="javascript">//ES5function getSum(){}function (){}//åŒ¿åå‡½æ•°//ES6()=&gt;{}//å¦‚æœ{}å†…å®¹åªæœ‰ä¸€è¡Œ{}å’Œreturnå…³é”®å­—å¯çœ,</code></pre><h2 id="å‡½æ•°è¡¨è¾¾å¼ï¼ˆå­—é¢é‡å½¢å¼ï¼‰"><a href="#å‡½æ•°è¡¨è¾¾å¼ï¼ˆå­—é¢é‡å½¢å¼ï¼‰" class="headerlink" title="å‡½æ•°è¡¨è¾¾å¼ï¼ˆå­—é¢é‡å½¢å¼ï¼‰"></a>å‡½æ•°è¡¨è¾¾å¼ï¼ˆå­—é¢é‡å½¢å¼ï¼‰</h2><pre><code class="javascript">//ES5var sum=function getSum(){}//ES6let sum=()=&gt;{}//å¦‚æœ{}å†…å®¹åªæœ‰ä¸€è¡Œ{}å’Œreturnå…³é”®å­—å¯çœ,</code></pre><h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><pre><code class="javascript">var sum=new GetSum(num1,num2)</code></pre><h2 id="ä¸‰ç§æ–¹æ³•çš„å¯¹æ¯”"><a href="#ä¸‰ç§æ–¹æ³•çš„å¯¹æ¯”" class="headerlink" title="ä¸‰ç§æ–¹æ³•çš„å¯¹æ¯”"></a>ä¸‰ç§æ–¹æ³•çš„å¯¹æ¯”</h2><p>1.å‡½æ•°å£°æ˜æœ‰é¢„è§£æ,è€Œä¸”å‡½æ•°å£°æ˜çš„ä¼˜å…ˆçº§é«˜äºå˜é‡;<br>2.ä½¿ç”¨Functionæ„é€ å‡½æ•°å®šä¹‰å‡½æ•°çš„æ–¹å¼æ˜¯ä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼,è¿™ç§æ–¹å¼ä¼šå¯¼è‡´è§£æä¸¤æ¬¡ä»£ç ï¼Œå½±å“æ€§èƒ½ã€‚ç¬¬ä¸€æ¬¡è§£æå¸¸è§„çš„JavaScriptä»£ç ï¼Œç¬¬äºŒæ¬¡è§£æä¼ å…¥æ„é€ å‡½æ•°çš„å­—ç¬¦ä¸²</p><h2 id="Es5å‡½æ•°ä¸­çš„4ç§è°ƒç”¨"><a href="#Es5å‡½æ•°ä¸­çš„4ç§è°ƒç”¨" class="headerlink" title="Es5å‡½æ•°ä¸­çš„4ç§è°ƒç”¨"></a>Es5å‡½æ•°ä¸­çš„4ç§è°ƒç”¨</h2><p>åœ¨ES5ä¸­å‡½æ•°å†…å®¹çš„thisæŒ‡å‘å’Œè°ƒç”¨æ–¹æ³•æœ‰å…³</p><h3 id="å‡½æ•°è°ƒç”¨æ¨¡å¼"><a href="#å‡½æ•°è°ƒç”¨æ¨¡å¼" class="headerlink" title="å‡½æ•°è°ƒç”¨æ¨¡å¼"></a>å‡½æ•°è°ƒç”¨æ¨¡å¼</h3><p>åŒ…æ‹¬å‡½æ•°å()å’ŒåŒ¿åå‡½æ•°è°ƒç”¨,<code>thisæŒ‡å‘window</code></p><pre><code class="javascript"> function getSum() {    console.log(this) //window } getSum() (function() {    console.log(this) //window })() var getSum=function() {    console.log(this) //window }</code></pre><a id="more"></a><h3 id="æ–¹æ³•è°ƒç”¨"><a href="#æ–¹æ³•è°ƒç”¨" class="headerlink" title="æ–¹æ³•è°ƒç”¨"></a>æ–¹æ³•è°ƒç”¨</h3><p>å¯¹è±¡.æ–¹æ³•å(),<code>thisæŒ‡å‘å¯¹è±¡</code></p><pre><code class="javascript">var objList = {   name: &#39;methods&#39;,   getSum: function() {     console.log(this) //objListå¯¹è±¡   }}objList.getSum()</code></pre><h3 id="æ„é€ å™¨è°ƒç”¨"><a href="#æ„é€ å™¨è°ƒç”¨" class="headerlink" title="æ„é€ å™¨è°ƒç”¨"></a>æ„é€ å™¨è°ƒç”¨</h3><p>new æ„é€ å‡½æ•°å(),<code>thisæŒ‡å‘æ„é€ å‡½æ•°</code></p><pre><code class="javascript">function Person() {  console.log(this); //æŒ‡å‘æ„é€ å‡½æ•°Person}var personOne = new Person();</code></pre><h3 id="é—´æ¥è°ƒç”¨"><a href="#é—´æ¥è°ƒç”¨" class="headerlink" title="é—´æ¥è°ƒç”¨"></a>é—´æ¥è°ƒç”¨</h3><p>åˆ©ç”¨callå’Œapplyæ¥å®ç°,thiså°±æ˜¯callå’Œapplyå¯¹åº”çš„ç¬¬ä¸€ä¸ªå‚æ•°,å¦‚æœä¸ä¼ å€¼æˆ–è€…ç¬¬ä¸€ä¸ªå€¼ä¸ºnull,<code>undefinedæ—¶thisæŒ‡å‘window</code></p><pre><code class="javascript">function foo() {   console.log(this);}foo.apply(&#39;æˆ‘æ˜¯applyæ”¹å˜çš„thiså€¼&#39;);//æˆ‘æ˜¯applyæ”¹å˜çš„thiså€¼foo.call(&#39;æˆ‘æ˜¯callæ”¹å˜çš„thiså€¼&#39;);//æˆ‘æ˜¯callæ”¹å˜çš„thiså€¼</code></pre><h3 id="Es6å‡½æ•°çš„è°ƒç”¨"><a href="#Es6å‡½æ•°çš„è°ƒç”¨" class="headerlink" title="Es6å‡½æ•°çš„è°ƒç”¨"></a>Es6å‡½æ•°çš„è°ƒç”¨</h3><p>ç®­å¤´å‡½æ•°ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½ç”¨newå‘½ä»¤å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯<br>ç®­å¤´å‡½æ•°çš„thisæ˜¯å’Œå®šä¹‰æ—¶æœ‰å…³å’Œè°ƒç”¨æ— å…³<br>è°ƒç”¨å°±æ˜¯å‡½æ•°è°ƒç”¨æ¨¡å¼</p><pre><code class="javascript">(() =&gt; {   console.log(this)//window})()let arrowFun = () =&gt; {  console.log(this)//window}arrowFun()let arrowObj = {  arrFun: function() {   (() =&gt; {     console.log(this)//arrowObj   })()   } } arrowObj.arrFun();</code></pre><h2 id="call-applyå’Œbind"><a href="#call-applyå’Œbind" class="headerlink" title="call,applyå’Œbind"></a>call,applyå’Œbind</h2><p>1.IE5ä¹‹å‰ä¸æ”¯æŒcallå’Œapply,bindæ˜¯ES5å‡ºæ¥çš„;<br>2.callå’Œapplyå¯ä»¥è°ƒç”¨å‡½æ•°,æ”¹å˜this,å®ç°ç»§æ‰¿å’Œå€Ÿç”¨åˆ«çš„å¯¹è±¡çš„æ–¹æ³•;</p><h3 id="callå’Œapplyå®šä¹‰"><a href="#callå’Œapplyå®šä¹‰" class="headerlink" title="callå’Œapplyå®šä¹‰"></a>callå’Œapplyå®šä¹‰</h3><p>è°ƒç”¨æ–¹æ³•,ç”¨ä¸€ä¸ªå¯¹è±¡æ›¿æ¢æ‰å¦ä¸€ä¸ªå¯¹è±¡(this)<br>å¯¹è±¡.call(æ–°thiså¯¹è±¡,å®å‚1,å®å‚2,å®å‚3â€¦..) å‚æ•°åˆ—è¡¨<br>å¯¹è±¡.apply(æ–°thiså¯¹è±¡,[å®å‚1,å®å‚2,å®å‚3â€¦..]) å‚æ•°æ•°ç»„</p><h3 id="callå’Œapplyç”¨æ³•"><a href="#callå’Œapplyç”¨æ³•" class="headerlink" title="callå’Œapplyç”¨æ³•"></a>callå’Œapplyç”¨æ³•</h3><p>1.é—´æ¥è°ƒç”¨å‡½æ•°,æ”¹å˜ä½œç”¨åŸŸçš„thiså€¼<br>2.åŠ«æŒå…¶ä»–å¯¹è±¡çš„æ–¹æ³•</p><pre><code class="javascript">var foo = {  name:&quot;å¼ ä¸‰&quot;,  logName:function(){    console.log(this.name);  }}var bar={  name:&quot;æå››&quot;};foo.logName.call(bar);//æå››å®è´¨æ˜¯callæ”¹å˜äº†fooçš„thisæŒ‡å‘ä¸ºbar,å¹¶è°ƒç”¨è¯¥å‡½æ•°</code></pre><p>3.ä¸¤ä¸ªå‡½æ•°å®ç°ç»§æ‰¿</p><pre><code class="javascript">function Animal(name){  this.name = name;  this.showName = function(){  console.log(this.name);  }}function Cat(name){    Animal.call(this, name);  } var cat = new Cat(&quot;Black Cat&quot;);cat.showName(); //Black Cat</code></pre><p>4.ä¸ºç±»æ•°ç»„(argumentså’ŒnodeList)æ·»åŠ æ•°ç»„æ–¹æ³•push,pop</p><pre><code class="javascript">(function(){  Array.prototype.push.call(arguments,&#39;ç‹äº”&#39;);  console.log(arguments);//[&#39;å¼ ä¸‰&#39;,&#39;æå››&#39;,&#39;ç‹äº”&#39;]})(&#39;å¼ ä¸‰&#39;,&#39;æå››&#39;)</code></pre><p>5.åˆå¹¶æ•°ç»„</p><pre><code class="javascript">let arr1=[1,2,3]; let arr2=[4,5,6]; Array.prototype.push.apply(arr1,arr2); //å°†arr2åˆå¹¶åˆ°äº†arr1ä¸­</code></pre><p>6.æ±‚æ•°ç»„æœ€å¤§å€¼</p><pre><code class="javascript">Math.max.apply(null,arr)</code></pre><p>7.åˆ¤æ–­å­—ç¬¦ç±»å‹</p><pre><code class="javascript">Object.prototype.toString.call({})</code></pre><h3 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h3><p>bindæ˜¯functionçš„ä¸€ä¸ªå‡½æ•°æ‰©å±•æ–¹æ³•ï¼Œbindä»¥åä»£ç é‡æ–°ç»‘å®šäº†funcå†…éƒ¨çš„thisæŒ‡å‘,ä¸ä¼šè°ƒç”¨æ–¹æ³•,ä¸å…¼å®¹IE8</p><pre><code class="javascript">var name = &#39;æå››&#39; var foo = {   name: &quot;å¼ ä¸‰&quot;,   logName: function(age) {   console.log(this.name, age);   } } var fooNew = foo.logName; var fooNewBind = foo.logName.bind(foo); fooNew(10)//æå››,10 fooNewBind(11)//å¼ ä¸‰,11  å› ä¸ºbindæ”¹å˜äº†fooNewBindé‡Œé¢çš„thisæŒ‡å‘</code></pre><h2 id="å¸¸è§çš„å››ç§è®¾è®¡æ¨¡å¼"><a href="#å¸¸è§çš„å››ç§è®¾è®¡æ¨¡å¼" class="headerlink" title="å¸¸è§çš„å››ç§è®¾è®¡æ¨¡å¼"></a>å¸¸è§çš„å››ç§è®¾è®¡æ¨¡å¼</h2><h3 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h3><p>ç®€å•çš„å·¥å‚æ¨¡å¼å¯ä»¥ç†è§£ä¸ºè§£å†³å¤šä¸ªç›¸ä¼¼çš„é—®é¢˜;</p><pre><code class="javascript">function CreatePerson(name,age,sex) {    var obj = new Object();    obj.name = name;    obj.age = age;    obj.sex = sex;    obj.sayName = function(){        return this.name;    }    return obj;}var p1 = new CreatePerson(&quot;longen&quot;,&#39;28&#39;,&#39;ç”·&#39;);var p2 = new CreatePerson(&quot;tugenhua&quot;,&#39;27&#39;,&#39;å¥³&#39;);console.log(p1.name); // longenconsole.log(p1.age);  // 28console.log(p1.sex);  // ç”·console.log(p1.sayName()); // longenconsole.log(p2.name);  // tugenhuaconsole.log(p2.age);   // 27console.log(p2.sex);   // å¥³console.log(p2.sayName()); // tugenhua  </code></pre><h3 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h3><p>åªèƒ½è¢«å®ä¾‹åŒ–(æ„é€ å‡½æ•°ç»™å®ä¾‹æ·»åŠ å±æ€§ä¸æ–¹æ³•)ä¸€æ¬¡</p><pre><code class="javascript">// å•ä½“æ¨¡å¼var Singleton = function(name){    this.name = name;};Singleton.prototype.getName = function(){    return this.name;}// è·å–å®ä¾‹å¯¹è±¡var getInstance = (function() {    var instance = null;    return function(name) {        if(!instance) {//ç›¸å½“äºä¸€ä¸ªä¸€æ¬¡æ€§é˜€é—¨,åªèƒ½å®ä¾‹åŒ–ä¸€æ¬¡            instance = new Singleton(name);        }        return instance;    }})();// æµ‹è¯•å•ä½“æ¨¡å¼çš„å®ä¾‹,æ‰€ä»¥a===bvar a = getInstance(&quot;aa&quot;);var b = getInstance(&quot;bb&quot;);  </code></pre><h3 id="æ²™ç®±æ¨¡å¼"><a href="#æ²™ç®±æ¨¡å¼" class="headerlink" title="æ²™ç®±æ¨¡å¼"></a>æ²™ç®±æ¨¡å¼</h3><p>å°†ä¸€äº›å‡½æ•°æ”¾åˆ°è‡ªæ‰§è¡Œå‡½æ•°é‡Œé¢,ä½†è¦ç”¨é—­åŒ…æš´éœ²æ¥å£,ç”¨å˜é‡æ¥æ”¶æš´éœ²çš„æ¥å£,å†è°ƒç”¨é‡Œé¢çš„å€¼,å¦åˆ™æ— æ³•ä½¿ç”¨é‡Œé¢çš„å€¼</p><pre><code class="javascript">let sandboxModel=(function(){    function sayName(){};    function sayAge(){};    return{        sayName:sayName,        sayAge:sayAge    }})()</code></pre><h3 id="å‘å¸ƒè€…è®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒè€…è®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒè€…è®¢é˜…æ¨¡å¼"></a>å‘å¸ƒè€…è®¢é˜…æ¨¡å¼</h3><p>å°±ä¾‹å¦‚å¦‚æˆ‘ä»¬å…³æ³¨äº†æŸä¸€ä¸ªå…¬ä¼—å·,ç„¶åä»–å¯¹åº”çš„æœ‰æ–°çš„æ¶ˆæ¯å°±ä¼šç»™ä½ æ¨é€,</p><pre><code class="javascript">//å‘å¸ƒè€…ä¸è®¢é˜…æ¨¡å¼    var shoeObj = {}; // å®šä¹‰å‘å¸ƒè€…    shoeObj.list = []; // ç¼“å­˜åˆ—è¡¨ å­˜æ”¾è®¢é˜…è€…å›è°ƒå‡½æ•°    // å¢åŠ è®¢é˜…è€…    shoeObj.listen = function(fn) {        shoeObj.list.push(fn); // è®¢é˜…æ¶ˆæ¯æ·»åŠ åˆ°ç¼“å­˜åˆ—è¡¨    }    // å‘å¸ƒæ¶ˆæ¯    shoeObj.trigger = function() {            for (var i = 0, fn; fn = this.list[i++];) {                fn.apply(this, arguments);//ç¬¬ä¸€ä¸ªå‚æ•°åªæ˜¯æ”¹å˜fnçš„this,            }        }     // å°çº¢è®¢é˜…å¦‚ä¸‹æ¶ˆæ¯    shoeObj.listen(function(color, size) {        console.log(&quot;é¢œè‰²æ˜¯ï¼š&quot; + color);        console.log(&quot;å°ºç æ˜¯ï¼š&quot; + size);    });    // å°èŠ±è®¢é˜…å¦‚ä¸‹æ¶ˆæ¯    shoeObj.listen(function(color, size) {        console.log(&quot;å†æ¬¡æ‰“å°é¢œè‰²æ˜¯ï¼š&quot; + color);        console.log(&quot;å†æ¬¡æ‰“å°å°ºç æ˜¯ï¼š&quot; + size);    });    shoeObj.trigger(&quot;çº¢è‰²&quot;, 40);    shoeObj.trigger(&quot;é»‘è‰²&quot;, 42);  </code></pre><p>ä»£ç å®ç°é€»è¾‘æ˜¯ç”¨æ•°ç»„å­˜è´®è®¢é˜…è€…, å‘å¸ƒè€…å›è°ƒå‡½æ•°é‡Œé¢é€šçŸ¥çš„æ–¹å¼æ˜¯éå†è®¢é˜…è€…æ•°ç»„,å¹¶å°†å‘å¸ƒè€…å†…å®¹ä¼ å…¥è®¢é˜…è€…æ•°ç»„</p><p>æ›´å¤šè®¾è®¡æ¨¡å¼è¯·æˆ³:<a href="https://www.cnblogs.com/tugenhua0707/p/5198407.html" target="_blank" rel="noopener">Javascriptå¸¸ç”¨çš„è®¾è®¡æ¨¡å¼è¯¦è§£</a></p><h2 id="åŸå‹é“¾"><a href="#åŸå‹é“¾" class="headerlink" title="åŸå‹é“¾"></a>åŸå‹é“¾</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å¯¹è±¡ç»§æ‰¿å±æ€§çš„ä¸€ä¸ªé“¾æ¡</p><h3 id="æ„é€ å‡½æ•°-å®ä¾‹ä¸åŸå‹å¯¹è±¡çš„å…³ç³»"><a href="#æ„é€ å‡½æ•°-å®ä¾‹ä¸åŸå‹å¯¹è±¡çš„å…³ç³»" class="headerlink" title="æ„é€ å‡½æ•°,å®ä¾‹ä¸åŸå‹å¯¹è±¡çš„å…³ç³»"></a>æ„é€ å‡½æ•°,å®ä¾‹ä¸åŸå‹å¯¹è±¡çš„å…³ç³»</h3><p><a href="https://user-gold-cdn.xitu.io/2018/6/8/163deceaab1052c8?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" target="_blank" rel="noopener">æ„é€ å‡½æ•°,å®ä¾‹ä¸åŸå‹å¯¹è±¡çš„å…³ç³»</a></p><pre><code class="javascript">var Person = function (name) { this.name = name; }//personæ˜¯æ„é€ å‡½æ•°var o3personTwo = new Person(&#39;personTwo&#39;)//personTwoæ˜¯å®ä¾‹</code></pre><p><a href="https://user-gold-cdn.xitu.io/2018/6/8/163decf026f2d9d7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" target="_blank" rel="noopener">æ„é€ å‡½æ•°,å®ä¾‹ä¸åŸå‹å¯¹è±¡çš„å…³ç³»ä¾‹å­</a></p><p>åŸå‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„constructorå±æ€§æŒ‡å‘æ„é€ å‡½æ•°</p><h2 id="åˆ›å»ºå®ä¾‹çš„æ–¹æ³•"><a href="#åˆ›å»ºå®ä¾‹çš„æ–¹æ³•" class="headerlink" title="åˆ›å»ºå®ä¾‹çš„æ–¹æ³•"></a>åˆ›å»ºå®ä¾‹çš„æ–¹æ³•</h2><p>1.å­—é¢é‡</p><pre><code class="javascript">let obj={&#39;name&#39;:&#39;å¼ ä¸‰&#39;}</code></pre><p>2.Objectæ„é€ å‡½æ•°åˆ›å»º</p><pre><code class="javascript">let Obj=new Object()Obj.name=&#39;å¼ ä¸‰&#39;</code></pre><p>3.ä½¿ç”¨å·¥å‚æ¨¡å¼åˆ›å»ºå¯¹è±¡</p><pre><code class="javascript">function createPerson(name){ var o = new Object(); o.name = name; }; return o;}var person1 = createPerson(&#39;å¼ ä¸‰&#39;);</code></pre><p>4.ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡</p><pre><code class="javascript">function Person(name){ this.name = name;}var person1 = new Person(&#39;å¼ ä¸‰&#39;);</code></pre><h2 id="newè¿ç®—ç¬¦"><a href="#newè¿ç®—ç¬¦" class="headerlink" title="newè¿ç®—ç¬¦"></a>newè¿ç®—ç¬¦</h2><p>1.åˆ›äº†ä¸€ä¸ªæ–°å¯¹è±¡;<br>2.thisæŒ‡å‘æ„é€ å‡½æ•°;<br>3.æ„é€ å‡½æ•°æœ‰è¿”å›,ä¼šæ›¿æ¢newå‡ºæ¥çš„å¯¹è±¡,å¦‚æœæ²¡æœ‰å°±æ˜¯newå‡ºæ¥çš„å¯¹è±¡<br>4.æ‰‹åŠ¨å°è£…ä¸€ä¸ªnewè¿ç®—ç¬¦</p><pre><code class="javascript">var new2 = function (func) {    var o = Object.create(func.prototype); ã€€ã€€ //åˆ›å»ºå¯¹è±¡    var k = func.call(o);ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€//æ”¹å˜thisæŒ‡å‘ï¼ŒæŠŠç»“æœä»˜ç»™k    if (typeof k === &#39;object&#39;) {ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€//åˆ¤æ–­kçš„ç±»å‹æ˜¯ä¸æ˜¯å¯¹è±¡        return k;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ //æ˜¯ï¼Œè¿”å›k    } else {        return o;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ //ä¸æ˜¯è¿”å›è¿”å›æ„é€ å‡½æ•°çš„æ‰§è¡Œç»“æœ    }}  </code></pre><p>æ›´å¤šè¯¦æƒ…:<a href="https://www.cnblogs.com/chengzp/p/prototype.html" target="_blank" rel="noopener">è¯¦è°ˆJavaScriptåŸå‹é“¾</a></p><h2 id="å¯¹è±¡çš„åŸå‹é“¾"><a href="#å¯¹è±¡çš„åŸå‹é“¾" class="headerlink" title="å¯¹è±¡çš„åŸå‹é“¾"></a>å¯¹è±¡çš„åŸå‹é“¾</h2><p><a href="https://user-gold-cdn.xitu.io/2018/6/8/163ded0dad3145ec?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" target="_blank" rel="noopener">å¯¹è±¡çš„åŸå‹é“¾</a></p><h2 id="ç»§æ‰¿çš„æ–¹å¼"><a href="#ç»§æ‰¿çš„æ–¹å¼" class="headerlink" title="ç»§æ‰¿çš„æ–¹å¼"></a>ç»§æ‰¿çš„æ–¹å¼</h2><p>JSæ˜¯ä¸€é—¨å¼±ç±»å‹åŠ¨æ€è¯­è¨€,å°è£…å’Œç»§æ‰¿æ˜¯ä»–çš„ä¸¤å¤§ç‰¹æ€§</p><h3 id="åŸå‹é“¾ç»§æ‰¿"><a href="#åŸå‹é“¾ç»§æ‰¿" class="headerlink" title="åŸå‹é“¾ç»§æ‰¿"></a>åŸå‹é“¾ç»§æ‰¿</h3><p>å°†çˆ¶ç±»çš„å®ä¾‹ä½œä¸ºå­ç±»çš„åŸå‹<br><strong>ä»£ç å®ç°</strong></p><p>å®šä¹‰çˆ¶ç±»:</p><pre><code class="javascript">// å®šä¹‰ä¸€ä¸ªåŠ¨ç‰©ç±»function Animal (name) {  // å±æ€§  this.name = name || &#39;Animal&#39;;  // å®ä¾‹æ–¹æ³•  this.sleep = function(){    console.log(this.name + &#39;æ­£åœ¨ç¡è§‰ï¼&#39;);  }}// åŸå‹æ–¹æ³•Animal.prototype.eat = function(food) {  console.log(this.name + &#39;æ­£åœ¨åƒï¼š&#39; + food);};</code></pre><p>å­ç±»:</p><pre><code class="javascript">function Cat(){}Cat.prototype = new Animal();Cat.prototype.name = &#39;cat&#39;;//ã€€Test Codevar cat = new Cat();console.log(cat.name);//catconsole.log(cat.eat(&#39;fish&#39;));//catæ­£åœ¨åƒï¼šfish  undefinedconsole.log(cat.sleep());//catæ­£åœ¨ç¡è§‰ï¼ undefinedconsole.log(cat instanceof Animal); //trueconsole.log(cat instanceof Cat); //true</code></pre><p><strong>ä¼˜ç¼ºç‚¹</strong><br>ç®€å•æ˜“äºå®ç°,ä½†æ˜¯è¦æƒ³ä¸ºå­ç±»æ–°å¢å±æ€§å’Œæ–¹æ³•ï¼Œå¿…é¡»è¦åœ¨new Animal()è¿™æ ·çš„è¯­å¥ä¹‹åæ‰§è¡Œ,æ— æ³•å®ç°å¤šç»§æ‰¿</p><h3 id="æ„é€ ç»§æ‰¿"><a href="#æ„é€ ç»§æ‰¿" class="headerlink" title="æ„é€ ç»§æ‰¿"></a>æ„é€ ç»§æ‰¿</h3><p>å®è´¨æ˜¯åˆ©ç”¨callæ¥æ”¹å˜Catä¸­çš„thisæŒ‡å‘<br><strong>ä»£ç å®ç°</strong><br>å­ç±»:</p><pre><code class="javascript">function Cat(name){  Animal.call(this);  this.name = name || &#39;Tom&#39;;}</code></pre><p><strong>ä¼˜ç¼ºç‚¹</strong><br>å¯ä»¥å®ç°å¤šç»§æ‰¿,ä¸èƒ½ç»§æ‰¿åŸå‹å±æ€§/æ–¹æ³•</p><h3 id="å®ä¾‹ç»§æ‰¿"><a href="#å®ä¾‹ç»§æ‰¿" class="headerlink" title="å®ä¾‹ç»§æ‰¿"></a>å®ä¾‹ç»§æ‰¿</h3><p>ä¸ºçˆ¶ç±»å®ä¾‹æ·»åŠ æ–°ç‰¹æ€§ï¼Œä½œä¸ºå­ç±»å®ä¾‹è¿”å›<br><strong>ä»£ç å®ç°</strong><br>å­ç±»</p><pre><code class="javascript">function Cat(name){  var instance = new Animal();  instance.name = name || &#39;Tom&#39;;  return instance;}</code></pre><p><strong>ä¼˜ç¼ºç‚¹</strong><br>ä¸é™åˆ¶è°ƒç”¨æ–¹å¼,ä½†ä¸èƒ½å®ç°å¤šç»§æ‰¿</p><h3 id="æ‹·è´ç»§æ‰¿"><a href="#æ‹·è´ç»§æ‰¿" class="headerlink" title="æ‹·è´ç»§æ‰¿"></a>æ‹·è´ç»§æ‰¿</h3><p>å°†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•æ‹·è´ä¸€ä»½åˆ°å­ç±»ä¸­<br>å­ç±»:</p><pre><code class="javascript">function Cat(name){  var animal = new Animal();  for(var p in animal){    Cat.prototype[p] = animal[p];  }  Cat.prototype.name = name || &#39;Tom&#39;;}</code></pre><p><strong>ä¼˜ç¼ºç‚¹</strong><br>æ”¯æŒå¤šç»§æ‰¿,ä½†æ˜¯æ•ˆç‡ä½å ç”¨å†…å­˜</p><h3 id="ç»„åˆç»§æ‰¿"><a href="#ç»„åˆç»§æ‰¿" class="headerlink" title="ç»„åˆç»§æ‰¿"></a>ç»„åˆç»§æ‰¿</h3><p>é€šè¿‡è°ƒç”¨çˆ¶ç±»æ„é€ ï¼Œç»§æ‰¿çˆ¶ç±»çš„å±æ€§å¹¶ä¿ç•™ä¼ å‚çš„ä¼˜ç‚¹ï¼Œç„¶åé€šè¿‡å°†çˆ¶ç±»å®ä¾‹ä½œä¸ºå­ç±»åŸå‹ï¼Œå®ç°å‡½æ•°å¤ç”¨<br>å­ç±»:</p><pre><code class="javascript">function Cat(name){  Animal.call(this);  this.name = name || &#39;Tom&#39;;}Cat.prototype = new Animal();Cat.prototype.constructor = Cat;</code></pre><h3 id="å¯„ç”Ÿç»„åˆç»§æ‰¿"><a href="#å¯„ç”Ÿç»„åˆç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿç»„åˆç»§æ‰¿"></a>å¯„ç”Ÿç»„åˆç»§æ‰¿</h3><pre><code class="javascript">function Cat(name){  Animal.call(this);  this.name = name || &#39;Tom&#39;;}(function(){  // åˆ›å»ºä¸€ä¸ªæ²¡æœ‰å®ä¾‹æ–¹æ³•çš„ç±»  var Super = function(){};  Super.prototype = Animal.prototype;  //å°†å®ä¾‹ä½œä¸ºå­ç±»çš„åŸå‹  Cat.prototype = new Super();})();</code></pre><h3 id="ES6çš„extendsç»§æ‰¿"><a href="#ES6çš„extendsç»§æ‰¿" class="headerlink" title="ES6çš„extendsç»§æ‰¿"></a>ES6çš„extendsç»§æ‰¿</h3><p>ES6 çš„ç»§æ‰¿æœºåˆ¶æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨superæ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹this,é“¾æ¥æè¿°</p><pre><code class="javascript">class ColorPoint extends Point {  constructor(x, y, color) {    super(x, y); // è°ƒç”¨çˆ¶ç±»çš„constructor(x, y)    this.color = color;  }  toString() {    return this.color + &#39; &#39; + super.toString(); // è°ƒç”¨çˆ¶ç±»çš„toString()  }}   </code></pre><p>æ›´å¤šè¯¦æƒ…è¯·æˆ³:<a href="https://www.cnblogs.com/humin/p/4556820.html#undefined" target="_blank" rel="noopener">JSç»§æ‰¿çš„å®ç°æ–¹å¼</a></p><p><a href="https://segmentfault.com/a/1190000014405410?utm_source=channel-hottest#articleHeader16" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Interview </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React,Redux,React-redux</title>
      <link href="/2018/04/15/React/React-Redux-React-redux/"/>
      <url>/2018/04/15/React/React-Redux-React-redux/</url>
      
        <content type="html"><![CDATA[<h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><p><a href="">react</a><br>ä¸€äº›å°å‹é¡¹ç›®ï¼Œåªä½¿ç”¨ <code>React</code> å®Œå…¨å¤Ÿç”¨äº†ï¼Œæ•°æ®ç®¡ç†ä½¿ç”¨propsã€state<code>å³å¯ï¼Œé‚£ä»€ä¹ˆæ—¶å€™éœ€è¦å¼•å…¥Reduxå‘¢ï¼Ÿå½“æ¸²æŸ“ä¸€ä¸ªç»„ä»¶çš„æ•°æ®æ˜¯é€šè¿‡propsä»çˆ¶ç»„ä»¶ä¸­è·å–æ—¶ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯</code>A â€“&gt; B<code>ï¼Œä½†éšç€ä¸šåŠ¡å¤æ‚åº¦çš„å¢åŠ ï¼Œæœ‰å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</code>A â€“&gt; B â€“&gt; C â€“&gt; D â€“&gt; E<code>ï¼ŒEéœ€è¦çš„æ•°æ®éœ€è¦ä»Aé‚£é‡Œé€šè¿‡propsä¼ é€’è¿‡æ¥ï¼Œä»¥åŠå¯¹åº”çš„</code>E â€“&gt; A<code>é€†å‘ä¼ é€’</code>callback<code>ã€‚ç»„ä»¶BCDæ˜¯ä¸éœ€è¦è¿™äº›æ•°æ®çš„ï¼Œä½†æ˜¯åˆå¿…é¡»ç»ç”±å®ƒä»¬æ¥ä¼ é€’ï¼Œè¿™ç¡®å®æœ‰ç‚¹ä¸çˆ½ï¼Œè€Œä¸”ä¼ é€’çš„</code>props<code>ä»¥åŠ</code>callback<code>å¯¹BCDç»„ä»¶çš„å¤ç”¨ä¹Ÿä¼šé€ æˆå½±å“ã€‚æˆ–è€…å…„å¼Ÿç»„ä»¶ä¹‹é—´æƒ³è¦å…±äº«æŸäº›æ•°æ®ï¼Œä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ä¼ é€’ã€è·å–ç­‰ã€‚è¯¸å¦‚æ­¤ç±»çš„æƒ…å†µï¼Œå°±æœ‰å¿…è¦å¼•å…¥</code>Redux`äº†ã€‚</p><blockquote><p>å…¶å® <code>A --&gt; B --&gt; C --&gt; D --&gt; E</code> è¿™ç§æƒ…å†µï¼ŒReactä¸ä½¿ç”¨propså±‚å±‚ä¼ é€’ä¹Ÿæ˜¯èƒ½æ‹¿åˆ°æ•°æ®çš„ï¼Œä½¿ç”¨<a href="https://reactjs.org/docs/context.html" target="_blank" rel="noopener">Context</a>å³å¯ã€‚åé¢è¦è®²åˆ°çš„<code>react-redux</code>å°±æ˜¯é€šè¿‡<code>Context</code>è®©å„ä¸ªå­ç»„ä»¶æ‹¿åˆ°<code>store</code>ä¸­çš„æ•°æ®çš„ã€‚</p></blockquote><h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p><a href="">Redux</a><br>å…¶å®æˆ‘ä»¬åªæ˜¯æƒ³æ‰¾ä¸ªåœ°æ–¹å­˜æ”¾ä¸€äº›å…±äº«æ•°æ®è€Œå·²ï¼Œå¤§å®¶éƒ½å¯ä»¥è·å–åˆ°ï¼Œä¹Ÿéƒ½å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œä»…æ­¤è€Œå·²ã€‚<br>é‚£æ”¾åœ¨ä¸€ä¸ªå…¨éƒ¨å˜é‡é‡Œé¢è¡Œä¸è¡Œï¼Ÿè¡Œï¼Œå½“ç„¶è¡Œï¼Œä½†æ˜¯å¤ªä¸ä¼˜é›…ï¼Œä¹Ÿä¸å®‰å…¨ï¼Œå› ä¸ºæ˜¯å…¨å±€å˜é‡å˜›ï¼Œè°éƒ½èƒ½è®¿é—®ã€è°éƒ½èƒ½ä¿®æ”¹ï¼Œæœ‰å¯èƒ½ä¸€ä¸å°å¿ƒè¢«å“ªä¸ªå°ä¼™ä¼´è¦†ç›–äº†ä¹Ÿè¯´ä¸å®šã€‚é‚£å…¨å±€å˜é‡ä¸è¡Œå°±ç”¨ç§æœ‰å˜é‡å‘—ï¼Œ<code>ç§æœ‰å˜é‡</code>ã€ä¸èƒ½è½»æ˜“è¢«ä¿®æ”¹<code>ï¼Œæ˜¯ä¸æ˜¯ç«‹é©¬å°±æƒ³åˆ°</code>é—­åŒ…`äº†â€¦</p><p>ç°åœ¨è¦å†™è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå…¶æ»¡è¶³ï¼š</p><ul><li>å­˜æ”¾ä¸€ä¸ªæ•°æ®å¯¹è±¡</li><li>å¤–ç•Œèƒ½è®¿é—®åˆ°è¿™ä¸ªæ•°æ®</li><li>å¤–ç•Œä¹Ÿèƒ½ä¿®æ”¹è¿™ä¸ªæ•°æ®</li><li>å½“æ•°æ®æœ‰å˜åŒ–çš„æ—¶å€™ï¼Œé€šçŸ¥è®¢é˜…è€…</li></ul><a id="more"></a><pre><code class="javascript">function createStore(reducer, initialState) {  // currentStateå°±æ˜¯é‚£ä¸ªæ•°æ®  let currentState = initialState;  let listener = () =&gt; {};  function getState() {    return currentState;  }  function dispatch(action) {    currentState = reducer(currentState, action); // æ›´æ–°æ•°æ®    listener(); // æ‰§è¡Œè®¢é˜…å‡½æ•°    return action;  }  function subscribe(newListener) {    listener = newListener;    // å–æ¶ˆè®¢é˜…å‡½æ•°    return function unsubscribe() {      listener = () =&gt; {};    };  }  return {    getState,    dispatch,    subscribe  };}const store = createStore(reducer);store.getState(); // è·å–æ•°æ®store.dispatch({type: &#39;ADD_TODO&#39;}); // æ›´æ–°æ•°æ®store.subscribe(() =&gt; {/* update UI */}); // æ³¨å†Œè®¢é˜…å‡½æ•°</code></pre><p>æ›´æ–°æ•°æ®æ‰§è¡Œçš„æ­¥éª¤ï¼š</p><ul><li>Whatï¼šæƒ³å¹²ä»€ä¹ˆ â€” dispatch(action)</li><li>Howï¼šæ€ä¹ˆå¹²ï¼Œå¹²çš„ç»“æœ â€” reducer(oldState, action) =&gt; newState</li><li>Then?ï¼šé‡æ–°æ‰§è¡Œè®¢é˜…å‡½æ•°ï¼ˆæ¯”å¦‚é‡æ–°æ¸²æŸ“UIç­‰ï¼‰</li></ul><p>è¿™æ ·å°±å®ç°äº†ä¸€ä¸ªstoreï¼Œæä¾›ä¸€ä¸ªæ•°æ®å­˜å‚¨ä¸­å¿ƒï¼Œå¯ä»¥ä¾›å¤–éƒ¨è®¿é—®ã€ä¿®æ”¹ç­‰ï¼Œè¿™å°±æ˜¯Reduxçš„ä¸»è¦æ€æƒ³ã€‚<br>æ‰€ä»¥ï¼ŒReduxç¡®å®å’ŒReactæ²¡æœ‰ä»€ä¹ˆæœ¬è´¨å…³ç³»ï¼ŒReduxå¯ä»¥ç»“åˆå…¶ä»–åº“æ­£å¸¸ä½¿ç”¨ã€‚åªä¸è¿‡Reduxè¿™ç§æ•°æ®ç®¡ç†æ–¹å¼ï¼Œè·ŸReactçš„æ•°æ®é©±åŠ¨è§†å›¾ç†å¿µå¾ˆåˆæ‹ï¼Œå®ƒä¿©ç»“åˆåœ¨ä¸€èµ·ï¼Œå¼€å‘éå¸¸ä¾¿åˆ©ã€‚</p><p>ç°åœ¨æ—¢ç„¶æœ‰äº†ä¸€ä¸ªå®‰å…¨çš„åœ°æ–¹å­˜å–æ•°æ®ï¼Œæ€ä¹ˆç»“åˆåˆ°Reacté‡Œé¢å‘¢ï¼Ÿ<br>æˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œåˆ›å»ºä¸€ä¸ª<code>window.store = createStore(reducer)</code>ï¼Œç„¶ååœ¨éœ€è¦çš„åœ°æ–¹é€šè¿‡<code>store.getState()</code>å»è·å–æ•°æ®ï¼Œé€šè¿‡<code>store.dispatch</code>å»æ›´æ–°æ•°æ®ï¼Œé€šè¿‡<code>store.subscribe</code>å»è®¢é˜…æ•°æ®å˜åŒ–ç„¶åè¿›è¡Œ<code>setState...</code>å¦‚æœå¾ˆå¤šåœ°æ–¹éƒ½è¿™æ ·åšä¸€éï¼Œå®åœ¨æ˜¯ä¸å ªå…¶é‡ï¼Œè€Œä¸”ï¼Œè¿˜æ˜¯æ²¡æœ‰é¿å…æ‰å…¨å±€å˜é‡çš„ä¸ä¼˜é›…ã€‚</p><h2 id="React-Redux"><a href="#React-Redux" class="headerlink" title="React-Redux"></a>React-Redux</h2><p><a href="https://github.com/reactjs/react-redux" target="_blank" rel="noopener">React-Redux</a></p><p>ç”±äºå…¨å±€å˜é‡æœ‰è¯¸å¤šçš„ç¼ºç‚¹ï¼Œé‚£å°±æ¢ä¸ªæ€è·¯ï¼ŒæŠŠstoreç›´æ¥é›†æˆåˆ°Reactåº”ç”¨çš„é¡¶å±‚propsé‡Œé¢ï¼Œåªè¦å„ä¸ªå­ç»„ä»¶èƒ½è®¿é—®åˆ°é¡¶å±‚propså°±è¡Œäº†ï¼Œæ¯”å¦‚è¿™æ ·ï¼š</p><pre><code class="javascript">&lt;TopWrapComponent store={store}&gt;  &lt;App /&gt;&lt;/TopWrapComponent&gt;,</code></pre><p>Reactæ°å¥½æä¾›äº†è¿™ä¹ˆä¸€ä¸ªé’©å­ï¼Œ<a href="https://reactjs.org/docs/context.html" target="_blank" rel="noopener">Context</a>ï¼Œç”¨æ³•å¾ˆç®€å•ï¼Œçœ‹ä¸€ä¸‹å®˜æ–¹demoå°±æ˜äº†ã€‚ç°åœ¨å„ä¸ªå­ç»„ä»¶å·²ç»èƒ½å¤Ÿè½»æ˜“åœ°è®¿é—®åˆ°storeäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å­ç»„ä»¶æŠŠstoreä¸­ç”¨åˆ°çš„æ•°æ®å–å‡ºæ¥ã€ä¿®æ”¹ã€ä»¥åŠè®¢é˜…æ›´æ–°UIç­‰ã€‚æ¯ä¸ªå­ç»„ä»¶éƒ½éœ€è¦è¿™æ ·åšä¸€éï¼Œæ˜¾ç„¶ï¼Œè‚¯å®šæœ‰æ›´ä¾¿åˆ©çš„æ–¹æ³•ï¼š<a href="https://reactjs.org/docs/higher-order-components.html" target="_blank" rel="noopener">é«˜é˜¶ç»„ä»¶</a>ã€‚é€šè¿‡é«˜é˜¶ç»„ä»¶æŠŠ<code>store.getState()</code>ã€<code>store.dispatch</code>ã€<code>store.subscribe</code>å°è£…èµ·æ¥ï¼Œå­ç»„ä»¶å¯¹storeå°±æ— æ„ŸçŸ¥äº†ï¼Œå­ç»„ä»¶æ­£å¸¸ä½¿ç”¨propsè·å–æ•°æ®ä»¥åŠæ­£å¸¸ä½¿ç”¨callbackè§¦å‘å›è°ƒï¼Œç›¸å½“äºæ²¡æœ‰storeå­˜åœ¨ä¸€æ ·ã€‚</p><pre><code class="javascript">function connect(mapStateToProps, mapDispatchToProps) {  return function(WrappedComponent) {    class Connect extends React.Component {      componentDidMount() {        // ç»„ä»¶åŠ è½½å®Œæˆåè®¢é˜…storeå˜åŒ–ï¼Œå¦‚æœstoreæœ‰å˜åŒ–åˆ™æ›´æ–°UI        this.unsubscribe = this.context.store.subscribe(this.handleStoreChange.bind(this));      }      componentWillUnmount() {        // ç»„ä»¶é”€æ¯åï¼Œå–æ¶ˆè®¢é˜…äº‹ä»¶        this.unsubscribe();      }      handleStoreChange() {        // æ›´æ–°UI        this.forceUpdate();      }      render() {        return (          &lt;WrappedComponent            {...this.props}            {...mapStateToProps(this.context.store.getState())} // å‚æ•°æ˜¯storeé‡Œé¢çš„æ•°æ®            {...mapDispatchToProps(this.context.store.dispatch)} // å‚æ•°æ˜¯store.dispatch          /&gt;        );      }    }    Connect.contextTypes = {      store: PropTypes.object    };    return Connect;  };}</code></pre><p>ä½¿ç”¨connectçš„æ—¶å€™ï¼Œæˆ‘ä»¬çŸ¥é“è¦å†™ä¸€äº›æ ·æ¿åŒ–çš„ä»£ç ï¼Œæ¯”å¦‚<code>mapStateToProps</code>ã€<code>mapDispatchToProps</code>è¿™ä¸¤ä¸ªå‡½æ•°ï¼š</p><pre><code class="javascript">const mapStateToProps = state =&gt; {  return {    count: state.count  };};const mapDispatchToProps = dispatch =&gt; {  return {    dispatch  };};export default connect(mapStateToProps, mapDispatchToProps)(Child);// ä¸Šè¿°ä»£ç æ‰§è¡Œä¹‹åï¼Œå¯ä»¥çœ‹åˆ°connectå‡½æ•°é‡Œé¢çš„  &lt;WrappedComponent    {...this.props}    {...mapStateToProps(this.context.store.getState())}    {...mapDispatchToProps(this.context.store.dispatch)}  /&gt;// å°±å˜æˆäº†  &lt;WrappedComponent    {...this.props}    {count: store.getState().count}    {dispatch: store.dispatch}  /&gt;// è¿™æ ·ï¼Œå­ç»„ä»¶Childçš„propsé‡Œé¢å°±å¤šäº†countå’Œdispatchä¸¤ä¸ªå±æ€§// countå¯ä»¥ç”¨æ¥æ¸²æŸ“UIï¼Œdispatchå¯ä»¥ç”¨æ¥è§¦å‘å›è°ƒ</code></pre><p>Soï¼Œè¿™æ ·å°±OKäº†ï¼ŸOKäº†ã€‚<br>é€šè¿‡ä¸€ä¸ªé—­åŒ…ç”Ÿæˆä¸€ä¸ªæ•°æ®ä¸­å¿ƒstoreï¼Œç„¶åæŠŠè¿™ä¸ªstoreç»‘å®šåˆ°Reactçš„é¡¶å±‚propsé‡Œé¢ï¼Œå­ç»„ä»¶é€šè¿‡HOCå»ºç«‹ä¸é¡¶å±‚props.storeçš„è”ç³»ï¼Œè¿›è€Œè·å–æ•°æ®ã€ä¿®æ”¹æ•°æ®ã€æ›´æ–°UIã€‚<br>è¿™é‡Œä¸»è¦è®²äº†ä¸€ä¸‹ä¸‰è€…æ€ä¹ˆçªœåœ¨ä¸€èµ·çš„ï¼Œå¦‚æœæƒ³äº†è§£æ›´é«˜çº§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚reduxä¸­é—´ä»¶ã€reduceræ‹†åˆ†ã€connectçš„å…¶ä»–å‚æ•°ç­‰ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹å¯¹åº”çš„æºç ã€‚</p><p><a href="https://juejin.im/post/5acce5ac5188257cc20da02d" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥ï¼š</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€å¼ºæ—¥æœŸæ­£åˆ™è¡¨è¾¾å¼</title>
      <link href="/2018/04/14/Js/%E6%9C%80%E5%BC%BA%E6%97%A5%E6%9C%9F%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2018/04/14/Js/%E6%9C%80%E5%BC%BA%E6%97%A5%E6%9C%9F%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€å•çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY-MM-DDï¼‰ï¼š"><a href="#ç®€å•çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY-MM-DDï¼‰ï¼š" class="headerlink" title="ç®€å•çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY/MM/DDï¼‰ï¼š"></a>ç®€å•çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY/MM/DDï¼‰ï¼š</h2><pre><code class="javascript">^\d{4}(\-|\/|\.)\d{1,2}\1\d{1,2}$</code></pre><h2 id="æ¼”åŒ–çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY-MM-DD-YY-MM-DDï¼‰"><a href="#æ¼”åŒ–çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY-MM-DD-YY-MM-DDï¼‰" class="headerlink" title="æ¼”åŒ–çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY/MM/DD| YY/MM/DDï¼‰"></a>æ¼”åŒ–çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY/MM/DD| YY/MM/DDï¼‰</h2><pre><code class="javascript"> ^(^(\d{4}|\d{2})(\-|\/|\.)\d{1,2}\3\d{1,2}$)|(^\d{4}å¹´\d{1,2}æœˆ\d{1,2}æ—¥$)$</code></pre><h2 id="åŠ å…¥é—°å¹´çš„åˆ¤æ–­çš„ï¼š"><a href="#åŠ å…¥é—°å¹´çš„åˆ¤æ–­çš„ï¼š" class="headerlink" title="åŠ å…¥é—°å¹´çš„åˆ¤æ–­çš„ï¼š"></a>åŠ å…¥é—°å¹´çš„åˆ¤æ–­çš„ï¼š</h2><p>å®ä¾‹ï¼š</p><pre><code class="javascript"> ^((((1[6-9]|[2-9]\d)\d{2})-(0?[13578]|1[02])-(0?[1-9]|[12]\d|3[01]))|(((1[6-9]|[2-9]\d)\d{2})-(0?[13456789]|1[012])-(0?[1-9]|[12]\d|30))|(((1[6-9]|[2-9]\d)\d{2})-0?2-(0?[1-9]|1\d|2[0-8]))|(((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))-0?2-29-))$</code></pre><p>åˆ†æï¼š<br>1ã€ä»€ä¹ˆæ˜¯åˆæ³•çš„æ—¥æœŸèŒƒå›´ï¼Ÿå¯¹äºä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œè¿™ä¸ªé—®é¢˜æœ‰ä¸åŒçš„è§£é‡Šã€‚è¿™é‡Œé‡‡çº³MSDNä¸­çš„çº¦å®šï¼š<br>DateTimeå€¼ç±»å‹è¡¨ç¤ºå€¼èŒƒå›´åœ¨å…¬å…ƒï¼ˆåŸºç£çºªå…ƒï¼‰0001 å¹´ 1 æœˆ 1 æ—¥åˆå¤œ 12:00:00 åˆ°å…¬å…ƒ (C.E.) 9999 å¹´ 12 æœˆ 31 æ—¥æ™šä¸Š 11:59:59 ä¹‹é—´çš„æ—¥æœŸå’Œæ—¶é—´ã€‚</p><p>2ã€å…³äºé—°å¹´çš„é˜é‡Šã€‚<br>å…³äºå…¬å†é—°å¹´æ˜¯è¿™æ ·è§„å®šçš„ï¼šåœ°çƒç»•å¤ªé˜³å…¬è½¬ä¸€å‘¨å«åšä¸€å›å½’å¹´ï¼Œä¸€å›å½’å¹´é•¿365æ—¥5æ—¶48åˆ† 46ç§’ã€‚å› æ­¤ï¼Œå…¬å†è§„å®šæœ‰å¹³å¹´å’Œé—°å¹´ï¼Œå¹³å¹´ä¸€å¹´æœ‰365æ—¥ï¼Œæ¯”å›å½’å¹´çŸ­0.2422æ—¥ï¼Œå››å¹´å…±çŸ­0.9688æ—¥ï¼Œæ•…æ¯å››å¹´å¢åŠ ä¸€æ—¥ï¼Œè¿™ä¸€å¹´æœ‰366æ—¥ï¼Œå°±æ˜¯é—°å¹´ã€‚ä½†å››å¹´å¢åŠ ä¸€æ—¥æ¯”å››ä¸ªå›å½’å¹´åˆå¤š0.0312æ—¥,400å¹´åå°†å¤š3.12æ—¥,æ•…åœ¨400å¹´ä¸­å°‘è®¾3ä¸ªé—°å¹´,ä¹Ÿå°±æ˜¯åœ¨400å¹´ä¸­åªè®¾97ä¸ªé—°å¹´ï¼Œè¿™æ ·å…¬å†å¹´çš„å¹³å‡é•¿åº¦ä¸å›å½’å¹´å°±ç›¸è¿‘ä¼¼äº†ã€‚ç”±æ­¤è§„å®šï¼šå¹´ä»½æ˜¯æ•´ç™¾æ•°çš„å¿…é¡»æ˜¯400çš„å€æ•°æ‰æ˜¯é—°å¹´ï¼Œä¾‹å¦‚1900å¹´ã€2100å¹´å°±ä¸æ˜¯é—°å¹´ã€‚<br> <a id="more"></a></p><p>é¦–å…ˆéœ€è¦éªŒè¯å¹´ä»½ï¼Œæ˜¾ç„¶ï¼Œå¹´ä»½èŒƒå›´ä¸º 0001 - 9999ï¼ŒåŒ¹é…YYYYçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š</p><pre><code class="javascript">[0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3}</code></pre><p>å…¶ä¸­ [0-9] ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸º \dï¼Œä½† \d ä¸å¦‚ [0-9] ç›´è§‚ï¼Œå› æ­¤ä¸‹é¢æˆ‘å°†ä¸€ç›´é‡‡ç”¨ [0-9]</p><p>ç”¨æ­£åˆ™è¡¨è¾¾å¼éªŒè¯æ—¥æœŸçš„éš¾ç‚¹æœ‰äºŒï¼šä¸€æ˜¯å¤§å°æœˆä»½çš„å¤©æ•°ä¸åŒï¼ŒäºŒæ˜¯é—°å¹´çš„è€ƒè™‘ã€‚</p><blockquote><p>å¯¹äºç¬¬ä¸€ä¸ªéš¾ç‚¹ï¼Œæˆ‘ä»¬é¦–å…ˆä¸è€ƒè™‘é—°å¹´ï¼Œå‡è®¾2æœˆä»½éƒ½æ˜¯28å¤©ï¼Œè¿™æ ·ï¼Œæœˆä»½å’Œæ—¥æœŸå¯ä»¥åˆ†æˆä¸‰ç§æƒ…å†µï¼š<br>1ã€æœˆä»½ä¸º 1, 3, 5, 7, 8, 10, 12ï¼Œå¤©æ•°èŒƒå›´ä¸º 01 - 31ï¼ŒåŒ¹é…MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š</p></blockquote><pre><code class="javascript">(0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01])</code></pre><p>2ã€æœˆä»½ä¸º 4, 6, 9, 11ï¼Œå¤©æ•°èŒƒå›´ä¸º 01-30ï¼ŒåŒ¹é…MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š</p><pre><code class="javascript">(0[469]|11)-(0[1-9]|[12][0-9]|30)</code></pre><p>3ã€æœˆä»½ä¸º 2ï¼Œè€ƒè™‘å¹³å¹´æƒ…å†µï¼ŒåŒ¹é…MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š</p><pre><code class="javascript">02-(0[1-9]|[1][0-9]|2[0-8])</code></pre><p>æ ¹æ®ä¸Šé¢çš„æˆæœï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åŒ¹é…å¹³å¹´æ—¥æœŸæ ¼å¼ä¸ºYYYY-MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š</p><pre><code class="javascript">([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3})-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8])))</code></pre><blockquote><p>æ¥ç€æˆ‘ä»¬æ¥è§£å†³ç¬¬äºŒä¸ªéš¾ç‚¹ï¼šé—°å¹´çš„è€ƒè™‘ã€‚æ ¹æ®é—°å¹´çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†é—°å¹´åˆ†ä¸ºä¸¤ç±»ï¼š</p></blockquote><p>1ã€èƒ½è¢«4æ•´é™¤ä½†ä¸èƒ½è¢«100æ•´é™¤çš„å¹´ä»½ã€‚å¯»æ‰¾åä¸¤ä½çš„å˜åŒ–è§„å¾‹ï¼Œå¯ä»¥å¾ˆå¿«å¾—åˆ°ä¸‹é¢çš„æ­£åˆ™åŒ¹é…ï¼š</p><pre><code class="javascript">([0-9]{2})(0[48]|[2468][048]|[13579][26])</code></pre><p>2ã€èƒ½è¢«400æ•´é™¤çš„å¹´ä»½ã€‚èƒ½è¢«400æ•´é™¤çš„æ•°è‚¯å®šèƒ½è¢«100æ•´é™¤ï¼Œå› æ­¤åä¸¤ä½è‚¯å®šæ˜¯00ï¼Œæˆ‘ä»¬åªè¦ä¿è¯å‰ä¸¤ä½èƒ½è¢«4æ•´é™¤å³å¯ï¼Œç›¸åº”çš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š</p><pre><code class="javscript">(0[48]|[2468][048]|[3579][26])00</code></pre><p>2.æœ€å¼ºéªŒè¯æ—¥æœŸçš„æ­£åˆ™è¡¨è¾¾å¼,æ·»åŠ äº†é—°å¹´çš„éªŒè¯</p><p>è¿™ä¸ªæ—¥æœŸæ­£åˆ™è¡¨è¾¾å¼æ”¯æŒ<br>YYYY-MM-DD<br>YYYY/MM/DD<br>YYYY_MM_DD<br>YYYY.MM.DDçš„å½¢å¼</p><p>match : 2008-2-29 2008/02/29</p><p>not match : 2008-2-30   2007-2-29</p><h2 id="å®Œæ•´çš„æ­£åˆ™è¡¨è¾¾å¼å¦‚ä¸‹"><a href="#å®Œæ•´çš„æ­£åˆ™è¡¨è¾¾å¼å¦‚ä¸‹" class="headerlink" title="å®Œæ•´çš„æ­£åˆ™è¡¨è¾¾å¼å¦‚ä¸‹"></a>å®Œæ•´çš„æ­£åˆ™è¡¨è¾¾å¼å¦‚ä¸‹</h2><pre><code class="javascript">((^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(10|12|0?[13578])([-\/\._])(3[01]|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(11|0?[469])([-\/\._])(30|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(0?2)([-\/\._])(2[0-8]|1[0-9]|0?[1-9])$)|(^([2468][048]00)([-\/\._])(0?2)([-\/\._])(29)$)|(^([3579][26]00)([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][0][48])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][0][48])([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][2468][048])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][2468][048])([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][13579][26])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][13579][26])([-\/\._])(0?2)([-\/\._])(29)$))</code></pre><p>é—°å¹´çš„2æœˆä»½æœ‰29å¤©ï¼Œå› æ­¤åŒ¹é…é—°å¹´æ—¥æœŸæ ¼å¼ä¸ºYYYY-MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š</p><pre><code class="javascript">(([0-9]{2})(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00))-02-29</code></pre><p>æœ€åï¼Œå°†å¹³å¹´å’Œé—°å¹´çš„æ—¥æœŸéªŒè¯è¡¨è¾¾å¼åˆå¹¶ï¼Œæˆ‘ä»¬å¾—åˆ°æœ€ç»ˆçš„éªŒè¯æ—¥æœŸæ ¼å¼ä¸ºYYYY-MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š</p><pre><code class="javascript">([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3})-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8]))))|((([0-9]{2})(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00))-02-29)</code></pre><p>DD/MM/YYYYæ ¼å¼çš„æ­£åˆ™éªŒè¯è¡¨è¾¾å¼ä¸ºï¼š</p><pre><code class="javascript">(((0[1-9]|[12][0-9]|3[01])/((0[13578]|1[02]))|((0[1-9]|[12][0-9]|30)/(0[469]|11))|(0[1-9]|[1][0-9]|2[0-8])/(02))/([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3}))|(29/02/(([0-9]{2})(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00)))</code></pre>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ­£åˆ™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jQuery ä¸ Zeptoçš„åŒºåˆ«</title>
      <link href="/2018/04/13/Js/jQuery-%E4%B8%8E-Zepto%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/2018/04/13/Js/jQuery-%E4%B8%8E-Zepto%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<blockquote><p>jQuery çš„æ„ä¹‰æ˜¯åœ¨äºæŠ¹å¹³ DOMã€BOMã€CSSOM çš„å¤šæµè§ˆå™¨å·®å¼‚ï¼Œå¹¶ç»Ÿä¸€æä¾›æ¥å£ã€‚å®ƒä¸èƒ½å½“ä½œ Frameworkï¼ˆæ¡†æ¶ï¼‰è¢«ä½¿ç”¨ï¼Œè€Œæ˜¯æ‰®æ¼” Utilityï¼ˆå·¥å…·ï¼‰çš„è§’è‰²ã€‚</p></blockquote><p>è™½ç„¶ Zepto å’Œ jQuery çš„ä¸­çš„å¾ˆå¤š API çš„ç”¨æ³•æ˜¯ç›¸ä¼¼çš„ï¼Œä½†ä»æœ‰ä¸€äº› API åœ¨ç”¨æ³•ä¸Šå·®å¼‚å¾ˆå¤§ã€‚ä¸‹é¢å°±å®é™…ä½¿ç”¨ä¸­é‡åˆ°çš„åœºæ™¯åšä¸€ä¸‹åˆ—ä¸¾ã€‚</p><h2 id="åˆ›å»ºDOMèŠ‚ç‚¹å¹¶èµ‹ä¸å±æ€§"><a href="#åˆ›å»ºDOMèŠ‚ç‚¹å¹¶èµ‹ä¸å±æ€§" class="headerlink" title="åˆ›å»ºDOMèŠ‚ç‚¹å¹¶èµ‹ä¸å±æ€§"></a>åˆ›å»ºDOMèŠ‚ç‚¹å¹¶èµ‹ä¸å±æ€§</h2><p>ä½¿ç”¨ <code>$</code> æ“ä½œç¬¦å¯ä»¥è½»æ¾åˆ›å»ºèŠ‚ç‚¹å¹¶èµ‹äºˆå±æ€§ï¼Œå…·ä½“ä»£ç æ˜¯ <code>$(htmlString, attributes)</code> ï¼Œæ”¯æŒé“¾å¼å†™æ³•ã€‚å–œæ¬¢åˆ¨æ ¹é—®åº•çš„åŒå­¦å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„æ–‡æ¡£ã€‚</p><p><a href="http://api.jquery.com/jQuery/#jQuery-html-attributes" target="_blank" rel="noopener">jquertæ–‡æ¡£</a><br><a href="http://zeptojs.com/#" target="_blank" rel="noopener">zeptoæ–‡æ¡£</a></p><h3 id="DOMæ“ä½œçš„åŒºåˆ«"><a href="#DOMæ“ä½œçš„åŒºåˆ«" class="headerlink" title="DOMæ“ä½œçš„åŒºåˆ«"></a>DOMæ“ä½œçš„åŒºåˆ«</h3><p><strong>jqueryæ“ä½œulå…ƒç´ æ—¶å€™ï¼Œæ·»åŠ idä¸ä¼šç”Ÿæ•ˆ</strong></p><pre><code class="javascript">(function($){    $(function){         var $list = $(&#39;&lt;ul&gt;&lt;li&gt;jQuery æ’å…¥&lt;/li&gt;&lt;/ul&gt;&#39;, {            id: &#39;insert-by-jquery&#39;        });        $list.appendTo($(&#39;body&#39;));    }})(window.jQuery)// Result// &lt;ul&gt;&lt;li&gt;jQuery æ’å…¥&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>zeptoæ“ä½œulå…ƒç´ æ—¶å€™ï¼Œæ·»åŠ idä¼šç”Ÿæ•ˆ</strong></p><pre><code class="javascript">zepto(function($){         var $list = $(&#39;&lt;ul&gt;&lt;li&gt;jQuery æ’å…¥&lt;/li&gt;&lt;/ul&gt;&#39;, {            id: &#39;insert-by-jquery&#39;        });        $list.appendTo($(&#39;body&#39;));})// Result// &lt;ul id=&quot;insert-by-zepto&quot;&gt;&lt;li&gt;Zepto æ’å…¥&lt;/li&gt;&lt;/ul&gt;</code></pre><a id="more"></a><h3 id="äº‹ä»¶è§¦å‘çš„åŒºåˆ«"><a href="#äº‹ä»¶è§¦å‘çš„åŒºåˆ«" class="headerlink" title="äº‹ä»¶è§¦å‘çš„åŒºåˆ«"></a>äº‹ä»¶è§¦å‘çš„åŒºåˆ«</h3><p><strong>jqueryæ—¶loadäº‹ä»¶çš„å¤„ç†å‡½æ•°ä¸ä¼šæ‰§è¡Œ</strong></p><pre><code class="javascript">(function($) {    $(function() {            $script = $(&#39;&lt;script /&gt;&#39;, {            src: &#39;http://cdn.amazeui.org/amazeui/1.0.1/js/amazeui.js&#39;,            id: &#39;ui-jquery&#39;        });        $script.appendTo($(&#39;body&#39;));        $script.on(&#39;load&#39;, function() {            console.log(&#39;jQ script loaded&#39;);//æ²¡æœ‰æ‰“å°å‡º        });    });})(window.jQuery);</code></pre><p><strong>ä½¿ç”¨ Zepto æ—¶ load äº‹ä»¶çš„å¤„ç†å‡½æ•°ä¼šæ‰§è¡Œ</strong></p><pre><code class="javascript">Zepto(function($) {      $script = $(&#39;&lt;script /&gt;&#39;, {        src: &#39;http://cdn.amazeui.org/amazeui/1.0.1/js/amazeui.js&#39;,        id: &#39;ui-zepto&#39;    });    $script.appendTo($(&#39;body&#39;));    $script.on(&#39;load&#39;, function() {        console.log(&#39;zepto script loaded&#39;); //zepto script loaded    });});</code></pre><h3 id="äº‹ä»¶å§”æ‰˜çš„åŒºåˆ«"><a href="#äº‹ä»¶å§”æ‰˜çš„åŒºåˆ«" class="headerlink" title="äº‹ä»¶å§”æ‰˜çš„åŒºåˆ«"></a>äº‹ä»¶å§”æ‰˜çš„åŒºåˆ«</h3><p><strong>åœ¨ Zepto ä¸­ï¼Œå½“ a è¢«ç‚¹å‡»åï¼Œä¾æ¬¡å¼¹å‡ºäº†å†…å®¹ä¸ºâ€aäº‹ä»¶â€œå’Œâ€bäº‹ä»¶â€œçš„å¼¹å‡ºæ¡†ã€‚è¯´æ˜è™½ç„¶äº‹ä»¶å§”æ‰˜åœ¨.aä¸Šå¯æ˜¯å´ä¹Ÿè§¦å‘äº†.bä¸Šçš„å§”æ‰˜ã€‚</strong></p><p><strong>ä½†æ˜¯åœ¨ jQuery ä¸­åªä¼šè§¦å‘ .a ä¸Šé¢çš„å§”æ‰˜ã€‚</strong></p><pre><code class="javascript">var $doc = $(document);// Class &#39;a&#39; bind event &#39;a&#39;$doc.on(&#39;click&#39;, &#39;.a&#39;, function () {    alert(&#39;aäº‹ä»¶&#39;);    // Class &#39;a&#39; change to class &#39;b&#39;    $(this).removeClass(&#39;a&#39;).addClass(&#39;b&#39;);});// Class &#39;b&#39; bind event &#39;b&#39;$doc.on(&#39;click&#39;, &#39;.b&#39;, function () {    alert(&#39;bäº‹ä»¶&#39;);});</code></pre><p><strong>åŸç†åˆ†æ</strong></p><pre><code class="javascript">// Zepto source code$.fn.on = function(event, selector, data, callback, one) {    var autoRemove, delegator, $this = this    if (event &amp;&amp; !isString(event)) {        // Core code        $.each(event, function (type, fn) {            $this.on(type, selector, data, fn, one)        }) return $this    }    //...}</code></pre><blockquote><p>åœ¨ Zepto ä¸­ä»£ç è§£æçš„æ—¶å€™ï¼Œdocumentä¸Šæ‰€æœ‰çš„clickå§”æ‰˜äº‹ä»¶éƒ½ä¾æ¬¡æ”¾å…¥åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç‚¹å‡»çš„æ—¶å€™å…ˆçœ‹å½“å‰å…ƒç´ æ˜¯ä¸æ˜¯.aï¼Œç¬¦åˆåˆ™æ‰§è¡Œï¼Œç„¶åæŸ¥çœ‹æ˜¯ä¸æ˜¯.bï¼Œç¬¦åˆåˆ™æ‰§è¡Œã€‚</p></blockquote><p>è¿™æ ·çš„è¯ï¼Œå°±å¯¼è‡´å¦‚æœ.açš„äº‹ä»¶åœ¨å‰é¢ï¼Œä¼šå…ˆæ‰§è¡Œ.aäº‹ä»¶ï¼Œç„¶åclassæ›´æ”¹æˆbï¼ŒZeptoå†æŸ¥çœ‹å½“å‰å…ƒç´ æ˜¯ä¸æ˜¯.bï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><blockquote><p>åœ¨ jQuery ä¸­ä»£ç è§£æçš„æ—¶å€™ï¼Œdocumentä¸Šå§”æ‰˜äº†2ä¸ªclickäº‹ä»¶ï¼Œç‚¹å‡»åé€šè¿‡é€‰æ‹©ç¬¦è¿›è¡ŒåŒ¹é…ï¼Œæ‰§è¡Œç›¸åº”å…ƒç´ çš„å§”æ‰˜äº‹ä»¶ã€‚</p></blockquote><p>è¿™æ ·å°±å¾ˆå¥½çš„é¿å…äº†åœ¨ Zepto ä¸­çš„å‘ç”Ÿçš„æƒ…å†µã€‚</p><h2 id="APIæ–¹é¢çš„åŒºåˆ«"><a href="#APIæ–¹é¢çš„åŒºåˆ«" class="headerlink" title="APIæ–¹é¢çš„åŒºåˆ«"></a>APIæ–¹é¢çš„åŒºåˆ«</h2><h3 id="winth-å’Œ-heightçš„åŒºåˆ«"><a href="#winth-å’Œ-heightçš„åŒºåˆ«" class="headerlink" title="winth() å’Œ heightçš„åŒºåˆ«"></a><code>winth()</code> å’Œ <code>height</code>çš„åŒºåˆ«</h3><blockquote><ul><li>Zepto ç”±ç›’æ¨¡å‹(box-sizing)å†³å®šï¼›</li></ul></blockquote><blockquote><ul><li>jQuery ä¼šå¿½ç•¥ç›’æ¨¡å‹ï¼Œå§‹ç»ˆè¿”å›å†…å®¹åŒºåŸŸçš„å®½/é«˜(ä¸åŒ…å«paddingã€border)ã€‚</li></ul></blockquote><p>è§£å†³æ–¹å¼å°±æ˜¯ä½¿ç”¨ <code>.css(&#39;width&#39;)</code> è€Œä¸æ˜¯<code>.width()</code> ã€‚ä¸‹é¢æˆ‘ä»¬ä¸¾ä¸ªå«åšã€Šè¾¹æ¡†ä¸‰è§’å½¢å®½é«˜çš„è·å–ã€‹çš„æ —å­æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚</p><p>é¦–å…ˆç”¨ä¸‹é¢çš„ HTML å’Œ CSS ç”»äº†ä¸€ä¸ªå°ä¸‰è§’å½¢å§ã€‚</p><pre><code class="javascript">// html&lt;div class=&quot;caret&quot;&gt;&lt;/div&gt;// css.caret{    width:0;    height:0;    border-width: 0 20px 20px;    border-color: transparent transparent blue;     border-style: none dotted solid;}</code></pre><blockquote><ul><li>jQuery ä½¿ç”¨ .width() å’Œ .css(â€˜widthâ€™) éƒ½è¿”å› ï¼Œé«˜åº¦ä¹Ÿä¸€æ ·ï¼›</li></ul></blockquote><blockquote><ul><li>Zepto ä½¿ç”¨ .width() è¿”å› ï¼Œä½¿ç”¨ .css(â€˜widthâ€™) è¿”å› 0px ã€‚<br>æ‰€ä»¥ï¼Œè¿™ç§åœºæ™¯ï¼ŒjQuery ä½¿ç”¨ <code>.outerWidth() /</code> .outerHeight() ï¼›Zepto ä½¿ç”¨ <code>.width() / .height()</code> ã€‚</li></ul></blockquote><h3 id="offSet-çš„åŒºåˆ«"><a href="#offSet-çš„åŒºåˆ«" class="headerlink" title="offSet()çš„åŒºåˆ«"></a>offSet()çš„åŒºåˆ«</h3><pre><code class="javascript">// offset() {function}// @desc Zepto// @return top|left|width|height// @desc jQuery// @return width|height</code></pre><h3 id="è·å–éšè—å…ƒç´ widthå’Œheightçš„åŒºåˆ«"><a href="#è·å–éšè—å…ƒç´ widthå’Œheightçš„åŒºåˆ«" class="headerlink" title="è·å–éšè—å…ƒç´ widthå’Œheightçš„åŒºåˆ«"></a>è·å–éšè—å…ƒç´ widthå’Œheightçš„åŒºåˆ«</h3><p>Zepto æ— æ³•è·å–éšè—å…ƒç´ å®½é«˜ï¼ŒjQuery å¯ä»¥ã€‚</p><h3 id="extend-çš„åŒºåˆ«"><a href="#extend-çš„åŒºåˆ«" class="headerlink" title="extend() çš„åŒºåˆ«"></a>extend() çš„åŒºåˆ«</h3><p><strong>jQuery åœ¨åŸå‹ä¸Šæ‹“å±•æ–¹æ³•ä½¿ç”¨çš„æ–¹å¼æ˜¯ï¼š</strong></p><pre><code class="javascript">// For example// Extend a function named &#39;sayHello&#39; to the protorype of jQuery(function($) {    $.fn.extend({        sayHello: function() {            $(this).html(&#39;Hello !&#39;);        }    });})(window.jQuery);</code></pre><p><strong>Zepto ä¸­å¹¶æ²¡æœ‰ä¸ºåŸå‹å®šä¹‰extendæ–¹æ³•ï¼Œæ‰€ä»¥å¦‚æœè¦æ˜¯è¦åœ¨ Zepto çš„åŸå‹ä¸Šæ‹“å±•æ–¹æ³•å¯ä»¥ä½¿ç”¨çš„æ–¹å¼æ˜¯ï¼š</strong></p><pre><code class="javascript">// For example// Extend a function named &#39;sayHello&#39; to the protorype of ZeptoZepto(function($) {    sayHello: function() {        $(this).html(&#39;Hello !&#39;);    }});</code></pre><p>éšç€ jQuery 2.x çš„å‘å¸ƒä»¥åŠæœªæ¥ 3.0 å¯¹æµè§ˆå™¨æ”¯æŒçš„åˆ’åˆ†ï¼Œä¼¼ä¹æ‰¾ä¸åˆ°å†ä½¿ç”¨ Zepto çš„ç†ç”±äº†ã€‚å¦‚æœä½ çœŸåœ¨ä¹æ–‡ä»¶å¤§å°ï¼Œé‚£ä½ å¯ä»¥è‡ªè¡Œæ‰“åŒ… jQuery ä¸­éœ€è¦çš„æ¨¡å—ã€‚è¿™å’Œ Zepto æ˜¯ä¸€æ ·çš„ï¼ŒZepto å®˜æ–¹æä¾›çš„ç‰ˆæœ¬åªæ‰“åŒ…äº†å¾ˆåŸºç¡€çš„æ¨¡å—ã€‚</p><p><a href="https://segmentfault.com/a/1190000003409961" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jQuery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Es6ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹---è¿›é˜¶ç¯‡</title>
      <link href="/2018/04/12/Js/Es6%E4%BD%A0%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B-%E8%BF%9B%E9%98%B6%E7%AF%87/"/>
      <url>/2018/04/12/Js/Es6%E4%BD%A0%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B-%E8%BF%9B%E9%98%B6%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h2 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h2><p>æ¨¡å—åŒ–æ˜¯ä¸€ä¸ªè¿›è¡Œå¾ˆä¹…çš„è¯é¢˜ï¼Œå‘å±•å†ç¨‹ä¸­å‡ºç°è¿‡å¾ˆå¤šæ¨¡å¼ï¼Œä¾‹å¦‚AMD,CommonJSç­‰ç­‰ã€‚</p><p><strong>Module</strong>æ˜¯ES6çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œæ˜¯è¯­è¨€å±‚é¢å¯¹æ¨¡å—åŒ–çš„æ”¯æŒã€‚</p><blockquote><p>ä¸ä¹‹å‰æ¨¡å—åŠ è½½æœºåˆ¶ä¸åŒï¼ŒModuleæ˜¯åŠ¨æ€åŠ è½½ï¼Œå¯¼å…¥çš„å˜é‡çš„<strong>åªè¯»å¼•ç”¨</strong>ï¼Œè€Œä¸æ˜¯æ‹·è´ã€‚</p></blockquote><pre><code class="javascript">// 1. export default å¯ä»¥åšé»˜è®¤å¯¼å‡º// a.jsexport default 5;      // é»˜è®¤å¯¼å‡º// b.jsimport b, {a} from &#39;./a.js&#39;;    // é»˜è®¤å¯¼å…¥ï¼Œä¸éœ€è¦åŠ èŠ±æ‹¬å·// 2. åŠ¨æ€çš„åŠ è½½æœºåˆ¶// a.jsexport let a = 10;export let b = 10;export function add() {  a = 15;  b = 20;  return a+b;};// b.jsimport {a, b, add} from &#39;./a.js&#39;;a+b;    // 20add();  // 35a+b;    // 35</code></pre><h2 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h2><p>symbolæ˜¯es6çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œä»–æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p><p>1.symbolæ˜¯â€œæ–°â€çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä»es6å¼€å§‹åŸºæœ¬æ•°æ®ç±»å‹å˜æˆäº†6ä¸ªï¼Œ<strong>undefind,null,number,boolean,string,symbol</strong><br>2.symbolå¯ä»¥ç”¨ä½œobjectçš„<em>key</em><br>3.symbolå­˜åœ¨å…¨å±€ä½œç”¨åŸŸï¼Œåˆ©ç”¨<strong>Symbol.for(key)æ–¹æ³•</strong>ï¼Œå¯ä»¥åˆ›å»º(å…¨å±€ä½œç”¨åŸŸæ— æŒ‡å®šé”®)æˆ–è·å–å…¨å±€ä½œç”¨åŸŸçš„symbolï¼›åˆ©ç”¨<strong>symbol.keyFor(sym)</strong>å¯ä»¥è·å–æŒ‡å®šçš„symbolçš„å€¼<br>4.Javascriptå†…éƒ¨ä½¿ç”¨äº†å¾ˆå¤šå†…ç½®symbolå€¼ï¼Œä½œä¸ºç‰¹æ®Šçš„é”®ï¼Œæ¥å®ç°ä¸€äº›å†…éƒ¨åŠŸèƒ½ï¼›ä¾‹å¦‚ï¼š<strong>symbol.iterator</strong>ç”¨äºæ ‡ç¤ºå¯¹è±¡çš„è¿­ä»£å™¨</p><blockquote><p>â€œæ–°â€ ä»…ä»…æ˜¯é’ˆå¯¹å‰ç«¯å¼€å‘äººå‘˜æ¥è¯´çš„ï¼Œå…¶å® Symbol æ¦‚å¿µæœ¬èº«å·²ç»åœ¨ JavaScript è¯­è¨€å†…éƒ¨é•¿æ—¶é—´ä½¿ç”¨äº†<br><a id="more"></a><br><code>`</code>javascript<br>// 1. â€œSymbol(desc)â€ æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ symbolï¼Œå‚æ•° â€œdescâ€ ä»…ç”¨åš symbol çš„æè¿°ï¼Œå¹¶ä¸ç”¨äºå”¯ä¸€æ ‡ç¤º symbol<br>Symbol(â€˜abcâ€™) === Symbol(â€˜abcâ€™); // falseï¼Œâ€™abcâ€™ä»…ä½œä¸ºä¸¤ä¸ª symbol çš„æè¿°ä¿¡æ¯</p></blockquote><p>// 2. â€œSymbol.for(key)â€ æ–¹æ³•ï¼Œå‚æ•° â€œkeyâ€ æ˜¯ç”¨äºåœ¨å…¨å±€ä½œç”¨åŸŸä¸­æ ‡ç¤º symbol çš„å”¯ä¸€é”®ï¼ŒåŒæ—¶ä¹Ÿä½œä¸ºè¯¥ symbol çš„æè¿°ä¿¡æ¯<br>Symbol.for(â€˜abcâ€™) === Symbol(â€˜abcâ€™); //true å·¦ä¾§ä¸ºåˆ›å»ºï¼Œå³ä¾§ä¸ºè·å–<br>Symbol.for(â€˜abcâ€™) === Symbol(â€˜abcâ€™); //false</p><p>// 3. symbol æ— æ³•è¢« forâ€¦in éå†åˆ° (ä¸å¯æšä¸¾)ï¼Œå¯ä»¥åˆ©ç”¨ Object.getOwnPropertySymbols è·å–<br>const obj = {<br>    [Symbol(â€˜abcâ€™)]:â€™abcâ€™,<br>    â€˜abcâ€™:â€™abcâ€™<br>};<br>for(let i in obj){<br>    console.log(i);//abc<br>}<br>Object.getOwnPropertySymbols(obj);//[Symbol(abc)]</p><pre><code>## Iterator + for ...ofES6 ä¸­é™¤äº†æ–°ç‰¹æ€§å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–°çš„è§„èŒƒï¼Œé‚£å°±æ˜¯å…³äºè¿­ä»£çš„è§„èŒƒï¼Œä»–åŒ…æ‹¬ä¸¤éƒ¨åˆ†åˆ†åˆ«æ˜¯ â€œå¯è¿­ä»£è§„èŒƒï¼ˆiterable protocolï¼‰â€ å’Œ â€œè¿­ä»£å™¨è§„èŒƒï¼ˆiterator protocolï¼‰â€ã€‚ä»»ä½•å®ç°äº†å‰è€…çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥è¿›è¡Œ forâ€¦of å¾ªç¯ã€‚**String,Map,Set,Array**ç­‰æ˜¯åŸç”Ÿå¯è¿­ä»£å¯¹è±¡ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯åœ¨åŸå‹(prototype)å¯¹è±¡ä¸­å®ç°äº†`Symbol.iterator`é”®å¯¹åº”çš„æ–¹æ³•ã€‚&gt; for...ofæ˜¯å¯¹å¯¹è±¡è¿­ä»£å™¨çš„éå†ï¼ˆé”®å’Œå€¼éƒ½å¯ä»¥éå†ï¼‰ï¼Œè€Œfor...inæ˜¯å¯¹è±¡å¯æšä¸¾å€¼çš„éå†ä¸‹é¢ç”¨ä»£ç æ¥è§£é‡Šä¸€ä¸‹ä¸¤ä¸ªè§„èŒƒï¼š```javascript//1.è¿­ä»£å™¨è§„èŒƒconst iter = {    conter:0,    next(){ // è¿­ä»£å™¨æ˜¯å®ç°äº† &quot;next()&quot; å‡½æ•°çš„å¯¹è±¡        if(++this.conter &lt; 10){            return{ // è¿”å›ä¸€ä¸ªå«æœ‰ä¸¤ä¸ªé”®å€¼å¯¹çš„å¯¹è±¡ï¼ŒObject {done =&gt; boolean, value =&gt; any}                done:false,                value:this.conter            }        }else{            this.conter = 0;            return { // done = true æ—¶ï¼Œvalueéå¿…é¡»                done : true;            }        }    }}// 2. å¯è¿­ä»£è§„èŒƒï¼Œå®ç° &quot;Symbol.iterator =&gt; func()&quot; é”®å€¼å¯¹ï¼›è€Œ &quot;func()&quot; è¿”å›ä¸€ä¸ª è¿­ä»£å™¨å¯¹è±¡const iterObj = {};for(let i of iterObj){};iterObj[Symbol.iterator] = function(){    return iter;}for(let i of iterObj){    console.log(i);//1,2,3,4,5,6,7,8,9}</code></pre><h2 id="å…³äºé›†åˆ"><a href="#å…³äºé›†åˆ" class="headerlink" title="å…³äºé›†åˆ"></a>å…³äºé›†åˆ</h2><p>åŸæ¥æˆ‘ä»¬ä½¿ç”¨é›†åˆï¼Œå¤šæ•°æƒ…å†µä¸‹ä¼šç›´æ¥ç”¨ Object ä»£æ›¿ï¼ŒES6æ–°å¢äº†ä¸¤ä¸ªç‰¹æ€§ï¼Œ<em>Map</em> å’Œ <em>Set</em>ï¼Œä»–ä»¬æ˜¯å¯¹ JavaScript å…³äºé›†åˆæ¦‚å¿µçš„è¡¥å……ã€‚</p><h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p>ä¸ºä»€ä¹ˆè¦æœ‰Mapè¿™ç§æ•°æ®ç»“æ„ï¼Ÿç›´æ¥ä½¿ç”¨Objectä¸å¥½å—ï¼Ÿæ˜¯ä¸æ˜¯å®Œå…¨å¯ä»¥ä½¿ç”¨Mapå–ä»£objectç”¨äºæ•°æ®å­˜å–ï¼Ÿ</p><blockquote><p>Mapå’ŒObjectçš„åŒºåˆ«ï¼Ÿ<br>1.Mapå’ŒObjectéƒ½å¯ä»¥ç”¨ä½œæ•°æ®å­˜å–ï¼ŒMapé€‚ç”¨äºå­˜å–éœ€è¦<strong>å¸¸éœ€è¦å˜åŒ–(å¢å‡é”®å€¼å¯¹)æˆ–éå†çš„æ•°å‰§é›†</strong>ï¼Œè€ŒObjecté€‚ç”¨äº<strong>å­˜å–é™æ€ï¼ˆä¾‹å¦‚é…ç½®ä¿¡æ¯ï¼‰</strong>çš„æ•°æ®é›†<br>2.Objectçš„keyå¿…é¡»æ˜¯<code>String</code>æˆ–è€…<code>symbol</code>ç±»å‹ï¼Œè€ŒMapå´æ— æ­¤é™åˆ¶ï¼Œå¯ä»¥æ˜¯<code>ä»»ä½•å€¼</code><br>3.Mapå¯ä»¥å¾ˆæ–¹ä¾¿çš„å–åˆ°é”®å¯¹å€¼çš„æ•°é‡ï¼Œè€ŒObjectåˆ™éœ€è¦ç”¨é¢å¤–é€”å¾„</p></blockquote><h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><p>Setä½œä¸ºæœ€ç®€å•çš„é›†åˆï¼Œæœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p><p>1.Setå¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å€¼ï¼Œ<strong>éå†é¡ºåºä¸æ’å…¥é¡ºåºç›¸åŒ</strong></p><p>2.Setå†…<strong>æ— é‡å¤å€¼</strong></p><pre><code class="javascript">// 1. Set çš„æ„é€ å‡½æ•°å¯ä»¥ä¼ å…¥ä¸€ä¸ª â€œå¯è¿­ä»£çš„å¯¹è±¡ï¼ˆä¾‹å¦‚æ•°ç»„ï¼‰â€ï¼Œå…¶ä¸­åŒ…å«ä»»æ„å€¼const first = new Set([&#39;a&#39;, 1, {&#39;b&#39;: 1}, null]);    // Set {&quot;a&quot;, 1, Object {b: 1}, null}// 2. Set æ— æ³•æ’å…¥é‡å¤çš„å€¼first.add(1);    // Set {&quot;a&quot;, 1, Object {b: 1}, null}</code></pre><h2 id="WeakMap-WeakSet"><a href="#WeakMap-WeakSet" class="headerlink" title="WeakMap + WeakSet"></a>WeakMap + WeakSet</h2><p><code>WeakMap</code> ä¸ <code>WeakSet</code> ä½œä¸ºä¸€ä¸ªæ¯”è¾ƒæ–°é¢–çš„æ¦‚å¿µï¼Œå…¶ä¸»è¦ç‰¹ç‚¹åœ¨äºå¼±å¼•ç”¨ã€‚</p><p>ç›¸æ¯”äº Map ä¸ Set çš„å¼ºå¼•ç”¨ï¼Œå¼±å¼•ç”¨å¯ä»¥ä»¤å¯¹è±¡åœ¨ â€œé€‚å½“â€ æƒ…å†µä¸‹æ­£ç¡®è¢« GC å›æ”¶ï¼Œå‡å°‘å†…å­˜èµ„æºæµªè´¹ã€‚</p><p><strong>ä½†ç”±äºä¸æ˜¯å¼ºå¼•ç”¨ï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œéå†æˆ–å–å¾—å€¼æ•°é‡ï¼Œåªèƒ½ç”¨äºå€¼çš„å­˜å–ï¼ˆWeakMapï¼‰æˆ–æ˜¯å¦å­˜åœ¨å€¼å¾—åˆ¤æ–­ï¼ˆWeakSetï¼‰</strong></p><blockquote><ul><li>åœ¨å¼±å¼•ç”¨çš„æƒ…å†µä¸‹ï¼ŒGC å›æ”¶æ—¶ï¼Œä¸ä¼šæŠŠå…¶è§†ä½œä¸€ä¸ªå¼•ç”¨ï¼›å¦‚æœæ²¡æœ‰å…¶ä»–å¼ºå¼•ç”¨å­˜åœ¨ï¼Œé‚£è¿™ä¸ªå¯¹è±¡å°†è¢«å›æ”¶</li></ul></blockquote><pre><code class="javascript">// 1. WeakMap é”®å¿…é¡»æ˜¯å¯¹è±¡const err = new WeakMap([[&#39;a&#39;,1]]);    // TypeError: Invalid value used as weak map key// 2. WeakMap/WeakSet çš„å¼±å¼•ç”¨const wm = new WeakMap([[{&#39;a&#39;:1},1]]);    // Object {&#39;a&#39;: 1} ä¼šæ­£å¸¸è¢« GC å›æ”¶const ws = new WeakSet(); ws.add({&#39;a&#39;:1});    // Object {&#39;a&#39;: 1} ä¼šæ­£å¸¸è¢« GC å›æ”¶const obj = {&#39;b&#39;: 1};ws.add(obj);        // Object {&#39;b&#39;: 1} ä¸ä¼šè¢«æ­£å¸¸ GC å›æ”¶ï¼Œå› ä¸ºå­˜åœ¨ä¸€ä¸ªå¼ºå¼•ç”¨obj = undefined;    // Object {&#39;b&#39;: 1} ä¼šæ­£å¸¸è¢« GC å›æ”¶</code></pre><h2 id="å¼‚æ­¥ç¼–ç¨‹"><a href="#å¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="å¼‚æ­¥ç¼–ç¨‹"></a>å¼‚æ­¥ç¼–ç¨‹</h2><p>åœ¨ ES6 ä¹‹å‰ï¼ŒJavaScript çš„å¼‚æ­¥ç¼–ç¨‹éƒ½è·³ä¸å‡ºå›è°ƒå‡½æ•°è¿™ä¸ªæ–¹å¼ã€‚å›è°ƒå‡½æ•°æ–¹å¼ä½¿ç”¨éå¸¸ç®€å•ï¼Œåœ¨ç®€å•å¼‚æ­¥ä»»åŠ¡è°ƒç”¨æ—¶å€™æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†å¦‚æœå‡ºç°å¤æ‚çš„å¼‚æ­¥ä»»åŠ¡åœºæ™¯æ—¶ï¼Œå°±æ˜¾å¾—åŠ›ä¸ä»å¿ƒäº†ï¼Œæœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯å¤šå±‚å›è°ƒå‡½æ•°çš„åµŒå¥—ä¼šå¯¼è‡´ä»£ç çš„æ¨ªå‘å‘å±•ï¼Œéš¾ä»¥ç»´æŠ¤ï¼›ES6 å¸¦æ¥äº†ä¸¤ä¸ªæ–°ç‰¹æ€§æ¥è§£å†³å¼‚æ­¥ç¼–ç¨‹çš„éš¾é¢˜ã€‚</p><pre><code class="javascript">// ä¸€ä¸ªç®€å•çš„å¤šå±‚åµŒå¥—å›è°ƒå‡½æ•°çš„ä¾‹å­ (Node.js)const git = require(&#39;shell&#39;).git;const commitMsg = &#39;...&#39;;git.add(&#39;pattern/for/some/files/*&#39;, (err) =&gt; {  if(!err){    git.commit(commitMsg, (err) =&gt; {      if(!err){        git.push(pushOption);      }else{        console.log(err);      }    });  }else{    console.log(err);  }});</code></pre><h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><p>Promiseæ˜¯ES6çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œtaä»–æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p><p>1.æœ¬è´¨è¿˜æ˜¯å›è°ƒå‡½æ•°<br>2.åŒºåˆ†æˆåŠŸå’Œå¤±è´¥çš„å›è°ƒï¼Œçœå»åµŒå¥—åœ¨å†…å±‚çš„åˆ¤æ–­é€»è¾‘<br>3.å¯ä»¥å¾ˆè½»æ¾çš„å®Œæˆå›è°ƒå‡½æ•°æ¨¡å¼åˆ°promiseæ¨¡å¼çš„è½¬åŒ–<br>4.ä»£ç ç”±å›è°ƒå‡½æ•°åµŒå¥—çš„æ¨ªå‘æ‰©å±•ï¼Œå˜ä¸ºé“¾å¼è°ƒç”¨çš„çºµå‘æ‰©å±•ï¼Œä¾¿äºç¼–ç¨‹å’Œç»´æŠ¤</p><p>promise è™½ç„¶ä¼˜åŠ¿é¢‡å¤šï¼Œä½†æ˜¯ä»£ç ç»“æ„ä»ä¸åŒæ­¥ä»£ç åŒºåˆ«è¾ƒå¤§</p><pre><code class="javascript">// ä¸Šä¾‹ç”¨ Promise å®ç°// å‡å®š git.add, git.commit, git.push å‡åšäº† Promise å°è£…ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡const git = require(&#39;shell&#39;).git;const commitMsg = &#39;...&#39;;git.add(&#39;pattern/for/some/files/*&#39;)  .then(() =&gt; git.commit(commitMsg))  .then(git.push)  .catch((err) =&gt; {    console.log(err);  });</code></pre><h3 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h3><p>Generator ä½œä¸º ES6 çš„æ–°ç‰¹æ€§ï¼Œæ˜¯ä¸€ä¸ªè¯­è¨€å±‚é¢çš„å‡çº§ã€‚å®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š<br>1.å¯ä»¥ä½¿ç”¨yieldå…³é”®å­—ï¼Œç»ˆæ­¢æ‰§è¡Œè¿”å›ï¼ˆå†…åˆ°å¤–ï¼‰<br>2.å¯ä»¥é€šè¿‡next(val)æ–¹æ³•è°ƒç”¨é‡æ–°å”¤é†’ï¼Œç»§ç»­æ‰§è¡Œï¼ˆå¤–å›å†…ï¼‰<br>3.è¿è¡Œæ—¶ï¼ˆåŒ…æ‹¬æŒ‚èµ·æ€ï¼‰ï¼Œ<strong>å…±äº«å±€éƒ¨å˜é‡</strong><br>4.<code>Generator</code> æ‰§è¡Œä¼šè¿”å›ä¸€ä¸ªç»“æœå¯¹è±¡ï¼Œç»“æœå¯¹è±¡æœ¬èº«æ—¢æ˜¯è¿­ä»£å™¨ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¯è¿­ä»£å¯¹è±¡ï¼ˆåŒæ—¶æ»¡è¶³ä¸¤ä¸ªè¿­ä»£è§„èŒƒï¼‰ï¼Œæ‰€ä»¥ Generator å¯ä»¥<code>ç›´æ¥ç”¨äº è‡ªå®šä¹‰å¯¹è±¡è¿­ä»£å™¨</code></p><p>ç”±äºå…·å¤‡ä»¥ä¸Šç‰¹ç‚¹ï¼ˆç¬¬å››ç‚¹é™¤å¤–ï¼‰ï¼ŒGenerator ä¹Ÿæ˜¯ JavaScript å¯¹ åç¨‹ï¼ˆcoroutineï¼‰çš„å®ç°ï¼Œåç¨‹å¯ä»¥ç†è§£ä¸º â€œå¯ç”±å¼€å‘äººå‘˜æ§åˆ¶è°ƒåº¦çš„å¤šçº¿ç¨‹â€</p><blockquote><ul><li>åç¨‹æŒ‰ç…§è°ƒåº¦æœºåˆ¶æ¥åŒºåˆ†ï¼Œå¯ä»¥åˆ†ä¸ºå¯¹ç§°å¼å’Œéå¯¹ç§°å¼</li></ul></blockquote><blockquote><ul><li>éå¯¹ç§°å¼ï¼šè¢«è°ƒç”¨è€…ï¼ˆåç¨‹ï¼‰æŒ‚èµ·æ—¶ï¼Œå¿…é¡»å°†æ§åˆ¶æƒè¿”è¿˜è°ƒç”¨è€…ï¼ˆåç¨‹ï¼‰</li></ul></blockquote><blockquote><ul><li>å¯¹ç§°å¼ï¼šè¢«è°ƒç”¨è€…ï¼ˆåç¨‹ï¼‰æŒ‚èµ·æ—¶ï¼Œå¯å°†æ§åˆ¶æƒè½¬ç»™ â€œä»»æ„â€ å…¶ä»–åç¨‹</li></ul></blockquote><blockquote><ul><li>JavaScript å®ç°çš„æ˜¯ éå¯¹ç§°å¼åç¨‹ï¼ˆsemi-coroutineï¼‰ï¼›éå¯¹ç§°å¼åç¨‹ç›¸æ¯”äºå¯¹ç§°å¼åç¨‹ï¼Œä»£ç é€»è¾‘æ›´æ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤</li></ul></blockquote><p>åç¨‹ç»™ JavaScript æä¾›äº†ä¸€ä¸ªæ–°çš„æ–¹å¼å»å®Œæˆå¼‚æ­¥ç¼–ç¨‹ï¼›ç”±äº Generator çš„æ‰§è¡Œä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œéœ€è¦æ‰‹åŠ¨å»éå†ï¼Œæ‰€ä»¥å¦‚æœè¦è¾¾åˆ°è‡ªåŠ¨æ‰§è¡Œçš„ç›®çš„ï¼Œé™¤äº†æœ¬èº«è¯­æ³•å¤–ï¼Œè¿˜éœ€è¦å®ç°ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œä¾‹å¦‚ <code>TJ å¤§ç¥çš„ co æ¡†æ¶</code>ã€‚</p><pre><code class="javascript">// ä¸Šä¾‹ç”¨ Generator å®ç°// å‡å®š git.add, git.commit, git.push å‡åšäº† Promise å°è£…ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡const co = require(&#39;co&#39;);const git = require(&#39;shell&#39;).git;co(function* (){  const commitMsg = &#39;...&#39;;      // å…±äº«çš„å±€éƒ¨å˜é‡  yield git.add(&#39;pattern/for/some/files/*&#39;);  yield git.commit(commitMsg);  yield git.push();}).catch((err) =&gt; {  console.log(err);});</code></pre><p>Generator æ˜¯ä¸€ä¸ª ES6 æœ€ä½³çš„å¼‚æ­¥ç¼–ç¨‹é€‰æ‹©ä¹ˆï¼Ÿæ˜¾ç„¶ä¸æ˜¯ï¼Œå› ä¸ºé™¤äº†åŸºæœ¬è¯­æ³•å¤–ï¼Œæˆ‘ä»¬è¿˜è¦é¢å¤–å»å®ç°æ‰§è¡Œå™¨æ¥è¾¾åˆ°æ‰§è¡Œçš„ç›®çš„ï¼Œä½†æ˜¯å®ƒæ•´ä½“çš„ä»£ç ç»“æ„æ˜¯ä¼˜äºå›è°ƒå‡½æ•°åµŒå¥—å’Œ Promise æ¨¡å¼çš„ã€‚</p><h3 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async-Await"></a>Async-Await</h3><p>è¿™å¹¶ä¸æ˜¯ä¸€ä¸ª ES6 æ–°ç‰¹æ€§ï¼Œè€Œæ˜¯ ES7 çš„è¯­æ³•ï¼Œæ”¾åœ¨è¿™é‡Œæ˜¯å› ä¸ºå®ƒå°†æ˜¯ JavaScript ç›®å‰æ”¯æŒå¼‚æ­¥ç¼–ç¨‹æœ€å¥½çš„æ–¹å¼</p><pre><code class="javascript">// ä¸Šä¾‹ç”¨ async-await å®ç°// å‡å®š git.add, git.commit, git.push å‡åšäº† Promise å°è£…ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡const git = require(&#39;shell&#39;).git;(async function(){    const commitMsg = &#39;&#39;; //å…±äº«å±€éƒ¨å˜é‡    try(){        await git.add(&#39;pattern/for/some/files/*&#39;);        await git.commit(commitMsg);        await git.push();    }catch(err){        console.log(err);    }})()</code></pre><h2 id="å…ƒç¼–ç¨‹"><a href="#å…ƒç¼–ç¨‹" class="headerlink" title="å…ƒç¼–ç¨‹"></a>å…ƒç¼–ç¨‹</h2><p>å…ƒç¼–ç¨‹æ˜¯æŒ‡çš„æ˜¯å¼€å‘äººå‘˜å¯¹ â€œè¯­è¨€æœ¬èº«è¿›è¡Œç¼–ç¨‹â€ã€‚ä¸€èˆ¬æ˜¯ç¼–ç¨‹è¯­è¨€æš´éœ²äº†ä¸€äº› APIï¼Œä¾›å¼€å‘äººå‘˜æ¥æ“ä½œè¯­è¨€æœ¬èº«çš„æŸäº›ç‰¹æ€§ã€‚ES6 ä¸¤ä¸ªæ–°ç‰¹æ€§ Proxy å’Œ Reflect æ˜¯ JavaScript å…³äºå¯¹è±¡å…ƒç¼–ç¨‹èƒ½åŠ›çš„æ‰©å±•ã€‚</p><h3 id="proxy"><a href="#proxy" class="headerlink" title="proxy"></a>proxy</h3><p>Proxy æ˜¯ ES6 åŠ å…¥çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œå®ƒå¯ä»¥ <code>â€œä»£ç†â€ å¯¹è±¡çš„åŸç”Ÿè¡Œä¸º</code>ï¼Œæ›¿æ¢ä¸º<code>æ‰§è¡Œè‡ªå®šä¹‰è¡Œä¸º</code>ã€‚</p><p>è¿™æ ·çš„å…ƒç¼–ç¨‹èƒ½åŠ›ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ›´è½»æ¾çš„æ‰©å±•å‡ºä¸€äº›ç‰¹æ®Šå¯¹è±¡ã€‚</p><blockquote><ul><li>ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥è¢«â€œä»£ç†â€</li><li>åˆ©ç”¨ Proxy.revocable(target, handler) å¯ä»¥åˆ›å»ºå‡ºä¸€ä¸ªå¯é€†çš„ â€œè¢«ä»£ç†â€ å¯¹è±¡</li></ul></blockquote><pre><code class="javascript">// ç®€å• element é€‰æ‹©æ§åˆ¶å·¥å…·çš„å®ç°const cacheElement = function(target, prop) {  if(target.hasOwnProperty(prop)){      return target[prop];    }else{      return target[prop] = document.getElementById(prop);    }}const elControl = new Proxy(cacheElement, {  get: (target, prop) =&gt; {    return cacheElement(target, prop);  },  set: (target, prop, val) =&gt; {    cacheElement(target, prop).textContent = val;  },  apply: (target, thisArg, args) =&gt; {    return Reflect.ownKeys(target);  }});elControl.first;     // div#firstelControl.second;    // div#secondelControl.first = 5;    // div#first =&gt; 5elControl.second = 10;  // div#second =&gt; 10elControl();    // [&#39;first&#39;, &#39;second&#39;]</code></pre><h3 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h3><p>ES6 ä¸­å¼•å…¥çš„ <code>Reflect</code> æ˜¯å¦ä¸€ä¸ªå…ƒç¼–ç¨‹çš„ç‰¹æ€§ï¼Œå®ƒä½¿å¾—æˆ‘ä»¬å¯ä»¥ç›´æ¥æ“çºµå¯¹è±¡çš„åŸç”Ÿè¡Œä¸ºã€‚<code>Reflect</code> å¯æ“çºµçš„è¡Œä¸ºä¸ <code>Proxy</code> å¯ä»£ç†çš„è¡Œä¸ºæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œè¿™ä½¿å¾—å¯ä»¥åœ¨ <code>Proxy</code> çš„è‡ªå®šä¹‰æ–¹æ³•ä¸­æ–¹ä¾¿çš„ä½¿ç”¨ <code>Reflect</code> è°ƒèµ·åŸç”Ÿè¡Œä¸º</p><pre><code class="javascript">// 1. Proxy çš„è‡ªå®šä¹‰æ–¹æ³•ä¸­ï¼Œé€šè¿‡ Reflect è°ƒç”¨åŸç”Ÿè¡Œä¸ºconst customProxy = new Proxy({  &#39;custom&#39;: 1}, {  get: (target, prop) =&gt; {    console.log(`get ${prop} !`);    return Reflect.get(target, undefined, prop);  }});customProxy.custom;  // get custom, 1// 2. ä¸ Object å¯¹è±¡ä¸Šå·²ç»å¼€æ”¾çš„æ“ä½œåŸç”Ÿè¡Œä¸ºæ–¹æ³•ç›¸æ¯”ï¼Œè¯­æ³•æ›´åŠ æ¸…æ™°æ˜“ç”¨ï¼ˆä¾‹å¦‚ï¼šObject.hasOwnProperty ä¸ Reflect.hasï¼‰const symb = Symbol(&#39;b&#39;);const a = {  [symb]: 1,  &#39;b&#39;: 2};if(Reflect.has(a, symb) &amp;&amp; Reflect.has(a, &#39;b&#39;)){  // good  console.log(&#39;good&#39;);}Reflect.ownKeys(a);  // [&quot;b&quot;, Symbol(b)]</code></pre><h2 id="è¿›é˜¶é˜…è¯»"><a href="#è¿›é˜¶é˜…è¯»" class="headerlink" title="è¿›é˜¶é˜…è¯»"></a>è¿›é˜¶é˜…è¯»</h2><p>å¦‚æœä½ å…³æ³¨å…¼å®¹æ€§ï¼Œæ¨èçœ‹ï¼š<a href="https://kangax.github.io/compat-table/es6/ï¼Œè¿™é‡Œä»‹ç»äº†ä»" target="_blank" rel="noopener">https://kangax.github.io/compat-table/es6/ï¼Œè¿™é‡Œä»‹ç»äº†ä»</a> ES5 åˆ° ES2016+ çš„æ‰€æœ‰ç‰¹æ€§ï¼ˆåŒ…æ‹¬ä»æœªå®šç¨¿çš„ç‰¹æ€§ï¼‰åŠå…¶åœ¨å„ç¯å¢ƒçš„å…¼å®¹æ€§</p><p>å¦‚æœä½ å…³æ³¨æ€§èƒ½ï¼Œæ¨èçœ‹ï¼š<a href="http://kpdecker.github.io/six-speed/ï¼Œè¿™é‡Œé€šè¿‡æ€§èƒ½æµ‹è¯•ï¼Œå°†" target="_blank" rel="noopener">http://kpdecker.github.io/six-speed/ï¼Œè¿™é‡Œé€šè¿‡æ€§èƒ½æµ‹è¯•ï¼Œå°†</a> ES6 ç‰¹æ€§çš„åŸç”Ÿå®ç°ä¸ ES5 polyfill ç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”ï¼Œè¦†ç›–äº†å„ä¸»æµç¯å¢ƒï¼›åŒæ—¶ä¹Ÿå¯ä»¥ä¾§é¢å¯¹æ¯”å‡ºå„ç¯å¢ƒåœ¨åŸç”Ÿå®ç°ä¸Šçš„æ€§èƒ½ä¼˜åŠ£</p><p>å¦‚æœä½ æƒ³å…¨é¢äº†è§£ç‰¹æ€§ï¼Œæ¨èçœ‹ï¼š<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScriptï¼Œè¦†ç›–ç‰¹æ€§çš„å„æ–¹é¢ï¼ŒåŒ…æ‹¬å…¨é¢çš„" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/JavaScriptï¼Œè¦†ç›–ç‰¹æ€§çš„å„æ–¹é¢ï¼ŒåŒ…æ‹¬å…¨é¢çš„</a> APIï¼ˆåŒ…æ‹¬ä¸æ¨èå’ŒåºŸå¼ƒçš„ï¼‰å’ŒåŸºç¡€ç”¨æ³•</p><p>å¦‚æœä½ æƒ³çœ‹ç‰¹æ€§æ›´å¤šçš„ä½¿ç”¨ç¤ºä¾‹å’Œå¯¹åº”çš„ polyfill å®ç°ï¼Œæ¨èçœ‹ï¼š<a href="http://es6-features.org/#Constantsï¼Œè¿™é‡Œå¯¹å„ä¸ªç‰¹æ€§éƒ½ç»™å‡ºäº†ä½¿ç”¨ä¸°å¯Œçš„ä¾‹å­å’Œä¸€ä¸ª" target="_blank" rel="noopener">http://es6-features.org/#Constantsï¼Œè¿™é‡Œå¯¹å„ä¸ªç‰¹æ€§éƒ½ç»™å‡ºäº†ä½¿ç”¨ä¸°å¯Œçš„ä¾‹å­å’Œä¸€ä¸ª</a> polyfill å®ç°ï¼Œç®€å•æ˜äº†</p><p>å¦‚æœæƒ³äº†è§£ ECMA Script æœ€å¤šæœ€å…¨é¢çš„ç»†èŠ‚ï¼Œè‹±è¯­åˆæ¯”è¾ƒè¿‡ç¡¬ï¼Œæ¨èåœ¨éœ€è¦æ—¶çœ‹ï¼š<a href="http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdfï¼Œï¼ˆæˆ–è€…ç›´æ¥çœ‹æœ€æ–°çš„ï¼šhttps://tc39.github.io/ecma262/ï¼‰" target="_blank" rel="noopener">http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdfï¼Œï¼ˆæˆ–è€…ç›´æ¥çœ‹æœ€æ–°çš„ï¼šhttps://tc39.github.io/ecma262/ï¼‰</a></p><p><a href="http://taobaofed.org/blog/2016/11/03/es6-advanced/" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Es6ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹---åŸºç¡€ç¯‡</title>
      <link href="/2018/04/11/Js/Es6%E4%BD%A0%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B-%E5%9F%BA%E7%A1%80%E7%AF%87/"/>
      <url>/2018/04/11/Js/Es6%E4%BD%A0%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B-%E5%9F%BA%E7%A1%80%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p>ES6ï¼Œæˆ–è®¸åº”è¯¥å« ES2015ï¼ˆ2015 å¹´ 6 æœˆæ­£å¼å‘å¸ƒï¼‰ï¼Œå¯¹äºå¤§å¤šæ•°å‰ç«¯åŒå­¦éƒ½ä¸é™Œç”Ÿã€‚</p><h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h1 id="let-const"><a href="#let-const" class="headerlink" title="let + const"></a>let + const</h1><p>è¿™ä¸ªå¤§æ¦‚æ˜¯å¼€å§‹äº†è§£ ES6 åï¼Œæˆ‘ä»¬ç¬¬ä¸€ä¸ªæ„Ÿè§‰è‡ªå·±å®Œå…¨æ˜ç™½å¹¶å…´è‡´å‹ƒå‹ƒçš„å¼€å§‹ä½¿ç”¨çš„ç‰¹æ€§ã€‚</p><pre><code class="javascript">// å®šä¹‰å¸¸é‡const REG_GET_INPUT = /^\d{1,3}$/;// å®šä¹‰é…ç½®é¡¹let config = {  isDev : false,  pubDir: &#39;./admin/&#39;}// å¼•å…¥ gulplet gulp    = require(&#39;gulp&#39;);// å¼•å…¥gulpç›¸å…³æ’ä»¶let concat  = require(&#39;gulp-concat&#39;);let uglify  = require(&#39;gulp-uglify&#39;);let cssnano = require(&#39;gulp-cssnano&#39;);</code></pre><p>å¾ˆå¤šäººçœ‹å®Œæ¦‚å¿µä¹‹åï¼Œç¬¬ä¸€å°è±¡éƒ½æ˜¯ï¼šâ€œconst æ˜¯è¡¨ç¤ºä¸å¯å˜çš„å€¼ï¼Œè€Œ let åˆ™æ˜¯ç”¨æ¥æ›¿æ¢åŸæ¥çš„ var çš„ã€‚â€</p><p>æ‰€ä»¥å°±ä¼šå‡ºç°ä¸Šé¢ä»£ç ä¸­çš„æ ·å­ï¼›ä¸€æ®µä»£ç ä¸­å‡ºç°å¤§é‡çš„ letï¼Œåªæœ‰éƒ¨åˆ†å¸¸é‡ç”¨ const å»åšå®šä¹‰ï¼Œè¿™æ ·çš„ä½¿ç”¨æ–¹å¼æ˜¯é”™è¯¯çš„ã€‚</p><h3 id="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹"><a href="#ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹" class="headerlink" title="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹"></a>ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹</h3><p><code>const</code> çš„å®šä¹‰æ˜¯<code>ä¸å¯é‡æ–°èµ‹å€¼</code>çš„å€¼ï¼Œä¸<code>ä¸å¯å˜çš„å€¼</code>(immutable value)ä¸åŒï¼›const å®šä¹‰çš„ Objectï¼Œåœ¨å®šä¹‰ä¹‹åä»å¯ä»¥ä¿®æ”¹å…¶å±æ€§ã€‚</p><p>æ‰€ä»¥å…¶å®ä»–çš„ä½¿ç”¨åœºæ™¯å¾ˆå¹¿ï¼ŒåŒ…æ‹¬å¸¸é‡ã€é…ç½®é¡¹ä»¥åŠå¼•ç”¨çš„ç»„ä»¶ã€å®šä¹‰çš„ â€œå¤§éƒ¨åˆ†â€ ä¸­é—´å˜é‡ç­‰ï¼Œéƒ½åº”è¯¥ä»¥<strong>const</strong>åšå®šä¹‰ã€‚åä¹‹å°± <strong>let</strong> è€Œè¨€ï¼Œä»–çš„ä½¿ç”¨åœºæ™¯åº”è¯¥æ˜¯ç›¸å¯¹è¾ƒå°‘çš„ï¼Œæˆ‘ä»¬åªä¼šåœ¨ <strong>loop(forï¼Œwhile å¾ªç¯)</strong>åŠå°‘é‡å¿…é¡»<strong>é‡å®šä¹‰</strong>çš„å˜é‡ä¸Šç”¨åˆ°ä»–ã€‚</p><blockquote><p>çŒœæƒ³ï¼šå°±æ‰§è¡Œæ•ˆç‡è€Œè¨€ï¼ŒConstç”±äºä¸å¯é‡æ–°èµ‹å€¼ï¼Œæ‰€ä»¥å¯ä»¥åšæ›´å¤šè¯­æ³•é™æ€åˆ†ææ–¹é¢çš„ä¼˜åŒ–ï¼Œä»è€Œæœ‰æ›´é«˜çš„æ‰§è¡Œæ•ˆç‡</p></blockquote><p>æ‰€ä»¥ä¸Šé¢ä»£ç ä¸­ï¼Œæ‰€æœ‰ä½¿ç”¨ let çš„éƒ¨åˆ†ï¼Œå…¶å®éƒ½åº”è¯¥æ˜¯ç”¨ const çš„ã€‚<br><a id="more"></a></p><h2 id="Template-Stringsï¼ˆå­—ç¬¦ä¸²æ¨¡æ¿ï¼‰"><a href="#Template-Stringsï¼ˆå­—ç¬¦ä¸²æ¨¡æ¿ï¼‰" class="headerlink" title="Template Stringsï¼ˆå­—ç¬¦ä¸²æ¨¡æ¿ï¼‰"></a>Template Stringsï¼ˆå­—ç¬¦ä¸²æ¨¡æ¿ï¼‰</h2><p>å­—ç¬¦ä¸²æ¨¡æ¿æ˜¯æˆ‘åˆšæ¥è§¦ES6æ—¶æœ€å–œæ¬¢çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œä»–è¯­æ³•ç®€æ´ï¼Œè¯­ä¹‰æ˜ç¡®ï¼Œè€Œä¸”å¾ˆå¥½çš„è§£å†³äº†ä¹‹å‰å­—ç¬¦ä¸²æ‹¼æ¥éº»çƒ¦çš„é—®é¢˜<br>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»–çš„ä¸€èˆ¬ä½¿ç”¨åœºæ™¯ï¼š</p><pre><code class="javascript">const start = &#39;hi all&#39;;const getName = () =&gt; {  return &#39;jelly&#39;;};const conf = {  fav: &#39;Coding&#39;};// æ¨¡æ¿const msg = `${start}, my name is ${getName()}, ${conf.fav} is my favourite`;</code></pre><h3 id="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-1"><a href="#ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-1" class="headerlink" title="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹"></a>ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹</h3><pre><code class="javascript">// 1. ä¸å¼•å·æ··ç”¨const wantToSay = `I&#39;m a &quot;tbfed&quot;`;// 2. æ”¯æŒå¤šè¡Œæ–‡æœ¬const slogan = `I have a dream today!`;// æ¯”è¾ƒé€‚åˆå†™HTMLconst resultTpl = `  &lt;section&gt;    &lt;div&gt;...&lt;/div&gt;  &lt;/section&gt;`;</code></pre><h2 id="Enhanced-Object-Literalsï¼ˆå¢å¼ºçš„å¯¹è±¡å­—é¢é‡ï¼‰"><a href="#Enhanced-Object-Literalsï¼ˆå¢å¼ºçš„å¯¹è±¡å­—é¢é‡ï¼‰" class="headerlink" title="Enhanced Object Literalsï¼ˆå¢å¼ºçš„å¯¹è±¡å­—é¢é‡ï¼‰"></a>Enhanced Object Literalsï¼ˆå¢å¼ºçš„å¯¹è±¡å­—é¢é‡ï¼‰</h2><p>å¢å¼ºçš„å¯¹è±¡å­—é¢é‡æ˜¯ ES6 ä¸­çš„å‡ååŠŸèƒ½ï¼Œä»–è®¾è®¡äº†å¾ˆå¤šç®€å†™ï¼Œè¿™äº›ç®€å†™ä¸ä½†ä¿ç•™äº†æ˜ç¡®çš„è¯­ä¹‰ï¼Œè¿˜å‡å°‘äº†æˆ‘ä»¬å¤šä½™çš„ä»£ç é‡ã€‚</p><p>å½“ä»–çš„ä½¿ç”¨æˆä¸ºä¸€ä¸ªä¹ æƒ¯æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è‡ªå·±ä»£ç å˜å¾—æ›´ä¸ºä¼˜é›…ã€‚</p><h3 id="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-2"><a href="#ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-2" class="headerlink" title="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹"></a>ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹</h3><pre><code class="javascript">const _bookNum = 4;const basicConfig = {  level: 5}const config = {  // ç›´æ¥æŒ‡å®šåŸå‹å¯¹è±¡  __proto__: basicConfig,  // å±æ€§ç®€å†™ ç›¸å½“äº_bookNum:_bookNum  _bookNum,  // æ–¹æ³•ç®€å†™   //ç›¸å½“äº getBookNum:function(){..}  getBookNum() {    return this.bookNum;  }}</code></pre><h2 id="Arrows-and-Lexical-Thisï¼ˆç®­å¤´å‡½æ•°ï¼‰"><a href="#Arrows-and-Lexical-Thisï¼ˆç®­å¤´å‡½æ•°ï¼‰" class="headerlink" title="Arrows and Lexical Thisï¼ˆç®­å¤´å‡½æ•°ï¼‰"></a>Arrows and Lexical Thisï¼ˆç®­å¤´å‡½æ•°ï¼‰</h2><p>ç®­å¤´å‡½æ•°æ˜¯ES6ä¸­çš„ä¸€ä¸ªæ–°çš„è¯­æ³•ç‰¹æ€§ï¼Œä»–çš„ç”¨æ³•ç®€å•ï¼Œå½¢æ€ä¼˜é›…ï¼Œå¤‡å—äººä»¬é’çã€‚<br>å¤§å¤šæ•°åŒå­¦åˆè¯†è¿™ä¸ªç‰¹æ€§æ—¶ï¼Œæ›´å¤šçš„ä»…ä»…ç”¨å®ƒä½œä¸ºå‡½æ•°å®šä¹‰çš„ç®€å†™ï¼Œè¿™å…¶å®å°±æœ‰äº›å±ˆæ‰äº†ã€‚</p><pre><code class="javascript">// æœªä½¿ç”¨ç®­å¤´å‡½æ•°çš„å†™æ³•{  ...  addOptions: function (options) {    var self = this;    options.forEach(function(name, opts){      self[name] = self.addChild(name, opts);    });  } }// ä½¿ç”¨ç®­å¤´å‡½æ•°åçš„å†™æ³•{  ...  addOptions: function (options) {    options.forEach((name, opts) =&gt; {      this[name] = this.addChild(name, opts);    });  } }</code></pre><p>å¯ä»¥æ³¨æ„åˆ°ä¸Šä¸‹ä¸¤æ®µä»£ç çš„åŒºåˆ«ã€‚</p><p>åœ¨æœªä½¿ç”¨ç®­å¤´å‡½æ•°å‰ï¼Œæˆ‘ä»¬åœ¨è¿‡ç¨‹å‡½æ•°ä¸­ä½¿ç”¨çˆ¶çº§ thisï¼Œéœ€è¦å°†å…¶æ˜¾å¼ç¼“å­˜åˆ°å¦ä¸€ä¸ªä¸­é—´å˜é‡ä¸­ï¼Œå› ä¸ºè¿‡ç¨‹å‡½æ•°æœ‰ç‹¬ç«‹çš„ this å˜é‡ï¼Œä¼šè¦†ç›–çˆ¶çº§ï¼›ä½¿ç”¨ç®­å¤´å‡½æ•°åï¼Œä¸ä½†ç®€å†™äº†ä¸€ä¸ªè¿‡ç¨‹å‡½æ•°ï¼ˆ forEach çš„å‚æ•°ï¼‰ï¼Œè¿˜çœç•¥æ‰äº† this çš„ä¸­é—´å˜é‡çš„å®šä¹‰ã€‚</p><p><strong>åŸå› ï¼šç®­å¤´å‡½æ•°æ²¡æœ‰ç‹¬ç«‹æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆ this ï¼‰ï¼Œæ‰€ä»¥å…¶å†…éƒ¨å¼•ç”¨ this å¯¹è±¡ä¼šç›´æ¥è®¿é—®çˆ¶çº§ã€‚</strong></p><p>å½“ç„¶ï¼Œä»è¿™å—æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œç®­å¤´å‡½æ•°æ˜¯æ— æ³•æ›¿ä»£å…¨éƒ¨ function çš„ä½¿ç”¨åœºæ™¯çš„ï¼Œä¾‹å¦‚æˆ‘ä»¬éœ€è¦æœ‰<em>ç‹¬ç«‹ this</em> çš„å‡½æ•°ã€‚</p><h3 id="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-3"><a href="#ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-3" class="headerlink" title="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹"></a>ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹</h3><blockquote><ul><li>ç®­å¤´å‡½æ•°ä¸ä½†æ²¡æœ‰ç‹¬ç«‹çš„thisï¼Œä»–ä¹Ÿæ²¡æœ‰ç‹¬ç«‹çš„argumentsï¼Œæ‰€ä»¥å¦‚æœéœ€è¦å–ä¸å®šå‚çš„æ—¶å€™ï¼Œè¦ä¹ˆä½¿ç”¨ functionï¼Œè¦ä¹ˆç”¨ ES6 çš„å¦ä¸€ä¸ªæ–°ç‰¹æ€§ restï¼ˆå…·ä½“åœ¨ rest ä¸­ä¼šæœ‰è¯¦è§£ï¼‰ã€‚</li></ul></blockquote><blockquote><ul><li>ç®­å¤´å‡½æ•°è¯­æ³•å¾ˆçµæ´»ï¼Œåœ¨åªæœ‰ä¸€ä¸ªå‚æ•°æˆ–è€…åªæœ‰ä¸€å¥è¡¨è¾¾å¼åšæ–¹æ³•ä½“æ—¶ï¼Œå¯ä»¥çœç•¥ç›¸åº”æ‹¬å·ã€‚</li></ul></blockquote><pre><code class="javascript">// å®Œæ•´å†™æ³•const getOptions = (name, key) =&gt; {  ...}// çœç•¥å‚æ•°æ‹¬å·const getOptions = key =&gt; {  ... }// çœç•¥å‚æ•°å’Œæ–¹æ³•ä½“æ‹¬å·const getOptions = key =&gt; console.log(key);// æ— å‚æ•°æˆ–æ–¹æ³•ä½“ï¼Œæ‹¬å·ä¸èƒ½çœç•¥const noop = () =&gt; {};</code></pre><p>æœ‰ä¸ªç®€å•å°æ —å­ï¼Œè¿™ä¸€çµæ´»çš„è¯­æ³•åœ¨å†™è¿ç»­çš„Promiseé“¾å¼è°ƒç”¨æ—¶ï¼Œå¯ä»¥ä½¿ä»£ç æ›´åŠ ä¼˜é›…</p><pre><code class="javascript">gitPromise  .then(() =&gt; git.add())  .then(() =&gt; git.commit())  .then(() =&gt; git.log())  .then((msg) =&gt; {      ...  })  .then(() =&gt; git.push())  .catch((err) =&gt; {      utils.error(err);  });</code></pre><h2 id="Destructuringï¼ˆè§£æ„ï¼‰"><a href="#Destructuringï¼ˆè§£æ„ï¼‰" class="headerlink" title="Destructuringï¼ˆè§£æ„ï¼‰"></a>Destructuringï¼ˆè§£æ„ï¼‰</h2><p>è§£æ„è¿™ä¸ªç‰¹æ€§å¯ä»¥ç®€å•è§£è¯»ä¸ºåˆ†åˆ«å®šä¹‰ï¼Œç”¨äºä¸€æ¬¡å®šä¹‰å¤šä¸ªå˜é‡ï¼Œå¸¸å¸¸ç”¨äºåˆ†è§£æ–¹æ³•è¿”å›å¯¹è±¡ä¸ºå¤šä¸ªå˜é‡ï¼Œåˆ†åˆ«ä½¿ç”¨ã€‚<br>ä½¿ç”¨è¿‡ES6çš„åŒå­¦åº”è¯¥æˆ–å¤šæˆ–å°‘æ¥è§¦è¿‡è¿™ä¸ªç‰¹æ€§ï¼Œä½†æ˜¯ä½ å¯èƒ½ä¸çŸ¥é“å®ƒå¦‚ä¸‹å‡ ä¸ªç”¨æ³•ï¼š</p><h3 id="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-4"><a href="#ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-4" class="headerlink" title="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹"></a>ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹</h3><pre><code class="javascript">const bookSet = [&#39;UED&#39;, &#39;TB fed&#39;, &#39;Not find&#39;];const bookCollection = () =&gt; {  return {book1: &#39;UED&#39;, book2: &#39;TB fed&#39;};};// 1. è§£æ„ä¹Ÿå¯ä»¥è®¾ç½®é»˜è®¤å€¼const {book1, book3 = &#39;Not find&#39;} = bookCollection();// 2. è§£æ„æ•°ç»„æ—¶å€™æ˜¯å¯ä»¥è·³è¿‡å…¶ä¸­æŸå‡ é¡¹çš„const [book1,,book3] = bookSet;  // book1 = &#39;UED&#39;, book3 = &#39;Not find&#39;// 3. è§£æ„å¯ä»¥å–åˆ°æŒ‡å®šå¯¹è±¡çš„ä»»ä½•å±æ€§ï¼ŒåŒ…æ‹¬å®ƒåŒ…å«çš„æ–¹æ³•const {length: setLength} = bookSet;  // setLength = 3</code></pre><h2 id="Rest-Spread"><a href="#Rest-Spread" class="headerlink" title="Rest + Spread"></a>Rest + Spread</h2><p>Rest å’Œ Spread ä¸»è¦æ˜¯åº”ç”¨ <code>... è¿ç®—ç¬¦</code>ï¼Œå®Œæˆå€¼çš„èšåˆå’Œåˆ†è§£ã€‚</p><h3 id="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-5"><a href="#ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-5" class="headerlink" title="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹"></a>ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹</h3><pre><code class="javascript">// 1. rest å¾—åˆ°çš„æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„è€Œä¸æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„const getOptions = function(...args){  console.log(args.join); // function};// 2. rest å¯ä»¥é…åˆç®­å¤´å‡½æ•°ä½¿ç”¨ï¼Œè¾¾åˆ°å–å¾—æ‰€æœ‰å‚æ•°çš„ç›®çš„const getOptions = (...args) =&gt; {  console.log(args); // array};// 3. spread å¯ä»¥ç”¨äºè§£æ„æ—¶ï¼Œèšåˆæ‰€å¾—çš„å€¼const [opt1, ...opts] = [&#39;one&#39;, &#39;two&#39;, &#39;three&#39;, &#39;four&#39;];// 4. spread å¯ä»¥ç”¨äºæ•°ç»„å®šä¹‰const opts = [&#39;one&#39;, &#39;two&#39;, &#39;three&#39;, &#39;four&#39;];const config = [&#39;other&#39;, ...opts];</code></pre><h2 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h2><p>ES6 ä¸­å®ç°çš„ä¸€ä¸ªè¯­æ³•ç³–ï¼Œç”¨äº<strong>ç®€åŒ–åŸºäºåŸå‹é›†æˆå®ç°ç±»å®šä¹‰</strong>çš„åœºæ™¯ã€‚<br>è™½ç„¶æœ‰å¾ˆå¤šäººä¸å¤ªå–œæ¬¢è¿™ä¸ªç‰¹æ€§ï¼Œè®¤ä¸ºå®ƒä½œä¸ºä¸€ä¸ªç®€å•å¢å¼ºæ‰©å±•ï¼Œå¹¶æ²¡æœ‰å…¶ä»–è¯­è¨€ class åº”æœ‰çš„ç‰¹ç‚¹ã€‚<br>ä½†æ˜¯å°±æˆ‘è‡ªå·±è§‚ç‚¹æ¥çœ‹ï¼Œè¿˜æ˜¯æ„Ÿè§‰è¿™æ ·ä¸€ç§å†™æ³•ç¡®å®æ¯”åŸæœ‰çš„åŸå‹ç»§æ‰¿çš„å†™æ³•è¯­ä¹‰æ›´æ¸…æ™°ã€æ˜ç¡®ï¼Œè€Œä¸”è¯­æ³•æ›´ç®€å•ã€‚</p><p>åŒæ ·ï¼Œå¯èƒ½æœ‰äº›ç”¨æ³•æ˜¯ä½ ä¹‹å‰å®¹æ˜“å¿½ç•¥æ‰çš„ï¼Œåœ¨æ­¤åšä¸ªè¡¥å……ã€‚</p><h3 id="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-6"><a href="#ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-6" class="headerlink" title="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹"></a>ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹</h3><pre><code class="javascript">// 1. é™æ€å˜é‡// ES6 çš„ç±»å®šä¹‰å®ç°äº†é™æ€æ–¹æ³•çš„å®šä¹‰ï¼Œä½†é™æ€å˜é‡å‘¢ï¼Ÿ// å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼å®ç°:class TbFedMembers{  static get HuaChen(){    return &#39;jelly&#39;;  }}TbFedMembers.HuaChen; // &quot;åŒ–è¾°&quot;// 2. ç§æœ‰å±æ€§ï¼ˆç§æœ‰å±æ€§æœ‰å¤šç§å®ç°æ–¹å¼ï¼Œåªè°ˆåŠå…¶ä¸­ä¸€ç§ï¼‰// é—­åŒ…const TbFedMembers = (() =&gt; {  const HuaChen = &#39;jelly&#39;;  return class{    getOneMemberName(){      return HuaChen;    }  };})();</code></pre><h2 id="Promises"><a href="#Promises" class="headerlink" title="Promises"></a>Promises</h2><p>Promise ä¸åªæ˜¯ä¸€ä¸ªå¯¹è±¡ã€ä¸€ä¸ªè¯­æ³•ï¼Œä»–æ›´æ˜¯ä¸€ç§å¼‚æ­¥ç¼–ç¨‹æ–¹å¼çš„å˜åŒ–<br>ç›¸ä¿¡ä½¿ç”¨è¿‡ ES6 çš„åŒå­¦éƒ½å·²ç»å¼€å§‹å°è¯•äº† Promiseï¼Œç”šè‡³åœ¨ä¸æ”¯æŒES6çš„æ—¶å€™ï¼Œå·²ç»å¼€å§‹ä½¿ç”¨ä¸€äº›åŸºäº Promise æ€æƒ³çš„å¼€æºæ¡†æ¶ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬ä¹‹å‰ç”¨ Promise ç©¶ç«Ÿç”¨çš„å¯¹ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆéœ€è¦æ³¨æ„çš„ç‚¹å‘¢ï¼Ÿ</p><h3 id="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-7"><a href="#ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹-7" class="headerlink" title="ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹"></a>ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹</h3><pre><code class="javascript">// 1. å¤šä¸ªå¼‚æ­¥ä»»åŠ¡åŒæ—¶æ‰§è¡Œç”¨ Promise.allï¼Œé¡ºåºæ‰§è¡Œä½¿ç”¨é“¾å¼è°ƒç”¨// Promise.allPromise  .all([jsBuildPromise, cssBuildPromise])  .then(() =&gt; {    ...  });// chainjsBuildPromise  .then(() =&gt; cssBuildPromise)  .then(() =&gt; {    ...  });// 2. Promise çš„é“¾å¼è°ƒç”¨éœ€è¦æ¯ä¸€ä¸ªè¿‡ç¨‹è¿”å›ä¸€ä¸ª Promise å¯¹è±¡æ‰èƒ½ä¿è¯é¡ºåºæ‰§è¡ŒgitPromise  .then(() =&gt; git.add())  // æ­£ç¡®ï¼Œç®­å¤´å‡½æ•°ç®€å†™  .then(() =&gt; {    git.commit(); // é”™è¯¯ï¼Œå‡½æ•°è¿”å› undefinedï¼Œä¼šç«‹å³æ‰§è¡Œä¸‹ä¸€è¿‡ç¨‹  })  .then(() =&gt; {    return git.log(); // æ­£ç¡®  });// 3. Promise éœ€è¦è°ƒç”¨ catch æ–¹æ³•æ¥æ•è·é”™è¯¯ï¼Œè€Œä¸”è¿‡ç¨‹å†…çš„é”™è¯¯ä¸ä¼šé˜»å¡åç»­ä»£ç æ‰§è¡Œnew Promise(() =&gt; {  f;  // not define error !}).catch((err) =&gt; {  console.log(err)  // show &#39;f is not define&#39;});console.log(&#39;error test&#39;);  // æ­¤è¡Œå¯ä»¥è¢«æ­£å¸¸æ‰§è¡Œ</code></pre><p><a href="http://taobaofed.org/blog/2016/07/22/es6-basics/" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸå’Œæ‰§è¡Œä¸Šä¸‹æ–‡</title>
      <link href="/2018/04/09/Js/%E4%BB%80%E4%B9%88%E6%98%AF%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87/"/>
      <url>/2018/04/09/Js/%E4%BB%80%E4%B9%88%E6%98%AF%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h1><p>é¦–å…ˆæˆ‘ä»¬è¯´ä¸‹ä½œç”¨åŸŸï¼Œç®€å•åœ°æ¥è¯´ä½œç”¨åŸŸæŒ‡çš„æ˜¯ä¸€ä¸ªåŒºåŸŸï¼Œé‡Œé¢åŒ…æ‹¬å˜é‡ï¼Œå‡½æ•°ï¼Œå¸¸é‡ç­‰ç­‰å®šä¹‰ä¿¡æ¯å’Œèµ‹å€¼ä¿¡æ¯ï¼Œä»¥åŠè¿™ä¸ªåŒºåŸŸå†…ä»£ç ä¹¦å†™çš„ç»“æ„ä¿¡æ¯ã€‚ä½œç”¨åŸŸå¯ä»¥åµŒå¥—ï¼Œæˆ‘ä»¬é€šå¸¸çŸ¥é“jså‡½æ•°å†…æ˜¯å¯ä»¥äº§ç”Ÿä½œç”¨åŸŸçš„ã€‚<br>ä¸‹é¢æˆ‘ä»¬ç”¨å…·ä½“ä»£ç æ¥ç¤ºä¾‹ä¸‹ï¼š</p><p><img src="https://image-static.segmentfault.com/114/508/1145089023-5923b87dde95f_articlex" alt="scope"></p><p><code>å…¨å±€ä½œç”¨åŸŸ</code>ï¼ˆglobal scopeï¼‰é‡Œé¢å®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªå‡½æ•°ã€‚walk å‡½æ•°ç”Ÿæˆçš„ä½œç”¨åŸŸé‡Œé¢å®šä¹‰äº†ä¸€ä¸ªå˜é‡ï¼Œä¸¤ä¸ªå‡½æ•°ã€‚innerFunc å’Œ anotherInnerFunc è¿™ä¸¤ä¸ªå‡½æ•°ç”Ÿæˆçš„ä½œç”¨åŸŸé‡Œé¢åˆ†åˆ«å®šä¹‰äº†ä¸€ä¸ªå˜é‡ã€‚åœ¨è§„èŒƒä¸­ä½œç”¨åŸŸæ›´å®˜æ–¹çš„å«æ³•æ˜¯è¯æ³•ç¯å¢ƒï¼ˆLexical Environmentsï¼‰ã€‚ä»€ä¹ˆæ„æ€ï¼Ÿå°±æ˜¯ä½œç”¨åŸŸåŒ…å«å“ªäº›å†…å®¹å–å†³äºä½ ä»£ç æ€ä¹ˆå†™ï¼Œä½ æŠŠå®šä¹‰ go å˜é‡å†™åœ¨äº† walk å‡½æ•°é‡Œé¢ï¼Œé‚£ä¹ˆ go å˜é‡å°±å±äº<code>walk å‡½æ•°ä½œç”¨åŸŸ</code>ã€‚</p><blockquote><p>ä½œç”¨åŸŸå…¶å®ç”±ä¸¤éƒ¨åˆ†ç»„æˆ(å…¨å±€ä½œç”¨åŸŸï¼Œå±€éƒ¨ä½œç”¨åŸŸ)<br>1.è®°å½•ä½œç”¨åŸŸå†…å˜é‡ä¿¡æ¯ï¼ˆæˆ‘ä»¬å‡è®¾å˜é‡ï¼Œå¸¸é‡ï¼Œå‡½æ•°ç­‰ç»Ÿç§°ä¸ºå˜é‡ï¼‰å’Œä»£ç ç»“æ„ä¿¡æ¯çš„ä¸œè¥¿ï¼Œç§°ä¹‹ä¸º Environment Recordã€‚<br>2.ä¸€ä¸ªå¼•ç”¨ <code>__outer__</code>ï¼Œè¿™ä¸ªå¼•ç”¨æŒ‡å‘å½“å‰ä½œç”¨åŸŸçš„çˆ¶ä½œç”¨åŸŸã€‚æ‹¿ä¸Šé¢ä»£ç ä¸ºä¾‹ã€‚innerFunc çš„å‡½æ•°ä½œç”¨åŸŸæœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘ walk å‡½æ•°ä½œç”¨åŸŸï¼Œwalk å‡½æ•°ä½œç”¨åŸŸæœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘å…¨å±€ä½œç”¨åŸŸã€‚å…¨å±€ä½œç”¨åŸŸçš„ <code>__outer__</code>ä¸º nullã€‚</p></blockquote><h2 id="ç”Ÿæˆä½œç”¨åŸŸçš„è¯­æ³•"><a href="#ç”Ÿæˆä½œç”¨åŸŸçš„è¯­æ³•" class="headerlink" title="ç”Ÿæˆä½œç”¨åŸŸçš„è¯­æ³•"></a>ç”Ÿæˆä½œç”¨åŸŸçš„è¯­æ³•</h2><a id="more"></a><p>1.å‡½æ•°å£°æ˜</p><pre><code class="javascript">function f(){    var inner = &#39;inner&#39;;    console.log(inner);}f();//innerconsole.log( inner );//Uncaught ReferenceError: inner is not defined</code></pre><p>2.catchè¯­å¥</p><pre><code class="javascript">try {  throw new Error( &#39;customized error&#39; );} catch( err ) {  var iamnoterror = &#39;not error&#39;;  console.log( iamnoterror ); // not error  console.log( err ); // Error: customized error}console.log( iamnoterror ); // not errorconsole.log( err ); // Uncaught ReferenceError: e is not defined</code></pre><p>catchè¯­å¥ç”Ÿæˆçš„ä½œç”¨åŸŸåªä¼šæ¡†ä½å‚æ•°éƒ¨åˆ†çš„å˜é‡ï¼Œä½¿å…¶ä¸èƒ½åœ¨å¤–éƒ¨è®¿é—®ã€‚å¯¹äº catch è¯­å¥ä½“é‡Œé¢å£°æ˜çš„å˜é‡å¹¶ä¸èµ·ä½œç”¨</p><p>3.è¯­å¥å—</p><pre><code class="javascript">if ( true ) {  let bv = &#39;bv&#39;;  const B_C = &#39;BC&#39;;  let blockFunc = function() {}  function notBlockFunc() {}  console.log( bv ); // bv  console.log( B_C ); // BC  console.log( notBlockFunc ); // function notBlockFunc() {}  console.log( blockFunc ); // function () {}}console.log( bv ); // Uncaught ReferenceError: bv is not definedconsole.log( B_C ); // Uncaught ReferenceError: B_C is not definedconsole.log( notBlockFunc ); // function notBlockFunc() {}console.log( blockFunc ); // ReferenceError: blockFunc is not defined</code></pre><p>è¯­å¥å— {} ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œä½†æ˜¯è¿™ä¸ªä½œç”¨åŸŸåªç»‘å®šå—çº§å˜é‡ï¼Œå¸¸é‡ç­‰ï¼Œå³ letï¼Œconst å£°æ˜çš„å±äºå—çº§ä½œç”¨åŸŸï¼Œè€Œ var å£°æ˜çš„è¿˜æ˜¯å±äºå—çº§ä½œç”¨åŸŸçš„çˆ¶ä½œç”¨åŸŸã€‚</p><h1 id="æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆexecution-contextï¼‰"><a href="#æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆexecution-contextï¼‰" class="headerlink" title="æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆexecution contextï¼‰"></a>æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆexecution contextï¼‰</h1><p>æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ç”¨äºè·Ÿè¸ªä»£ç çš„è¿è¡Œæƒ…å†µï¼Œå…¶ç‰¹å¾å¦‚ä¸‹:</p><blockquote><ul><li>ä¸€æ®µä»£ç å—å¯¹åº”ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œè¢«å°è£…æˆå‡½æ•°çš„ä»£ç è¢«è§†ä½œä¸€æ®µä»£ç å—ï¼Œæˆ–è€…å…¨å±€ä½œç”¨åŸŸä¹Ÿè¢«è§†ä½œä¸€ä¸ªä»£ç å—ã€‚</li></ul></blockquote><blockquote><ul><li>å½“ç¨‹åºè¿è¡Œï¼Œè¿›å…¥åˆ°æŸæ®µä»£ç å—æ—¶ï¼Œä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«åˆ›å»ºï¼Œå¹¶è¢«æ”¾å…¥ä¸€ä¸ª stack ä¸­ã€‚å½“ç¨‹åºè¿è¡Œåˆ°è¿™æ®µä»£ç å—ç»“å°¾åï¼Œå¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«å¼¹å‡º stack</li></ul></blockquote><blockquote><ul><li>å½“ç¨‹åºåœ¨æŸæ®µä»£ç å—ä¸­è¿è¡Œåˆ°æŸä¸ªç‚¹éœ€è¦è½¬åˆ°äº†å¦ä¸€ä¸ªä»£ç å—æ—¶ï¼ˆè°ƒç”¨äº†å¦ä¸€ä¸ªå‡½æ•°ï¼‰ï¼Œé‚£ä¹ˆå½“å‰çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡çš„çŠ¶æ€ä¼šè¢«ç½®ä¸ºæŒ‚èµ·ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡æ”¾å…¥ stack çš„é¡¶éƒ¨ã€‚</li></ul></blockquote><blockquote><ul><li>stack æœ€é¡¶éƒ¨çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡è¢«ç§°ä¸º running execution contextã€‚å½“é¡¶éƒ¨çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡è¢«å¼¹å‡ºåï¼Œä¸Šä¸€ä¸ªæŒ‚èµ·çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡ç»§ç»­æ‰§è¡Œã€‚</li></ul></blockquote><p>æˆ‘ä»¬ç”¨ä»£ç æ¥ç¤ºä¾‹ä¸‹ï¼ˆä» outer è°ƒç”¨åˆ° level1 è°ƒç”¨ï¼Œå†é€å±‚è¿”å›ï¼‰ï¼š<br><img src="https://image-static.segmentfault.com/184/331/1843310870-5923b8a26d26a_articlex" alt="outer"></p><p>æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡çš„å†…éƒ¨å±æ€§ï¼š</p><p>[[code evaluation]]ï¼šå½“å‰ä»£ç å—æ‰§è¡Œçš„çŠ¶æ€ï¼šprerformï¼Œsuspendï¼Œresumeã€‚</p><p>[[Function]]ï¼šå¦‚æœå½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹åº”çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§å°±ä¿å­˜çš„è¿™ä¸ªå‡½æ•°å¯¹è±¡ã€‚å¦‚æœå¯¹åº”çš„æ˜¯å…¨å±€ç¯å¢ƒï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ª script æˆ–è€… moduleï¼‰ï¼Œå±æ€§å€¼æ˜¯ nullã€‚</p><p>[[Real]]ï¼šç±»ä¼¼ä¸æ²™ç®±çš„æ¦‚å¿µï¼Ÿï¼ˆæˆ‘è¿˜æ²¡æœ‰çœ‹æ‡‚ï¼Œä¸è¿‡ä¸å¤ªå½±å“æ­¤ç¯‡çš„å†…å®¹ï¼‰</p><p>å¦‚æœç¨‹åºæ‰§è¡Œåˆ°æŸä¸ªç‚¹æŠ›å‡ºå¼‚å¸¸äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªè®°å½•æ‰§è¡Œä¸Šä¸‹æ–‡çš„ stack æ¥è¿½è¸ªåˆ°åº•å“ªé‡Œå‡ºé”™äº†ï¼Œå¯ä»¥çœ‹åˆ°æ•´ä¸ªè°ƒç”¨æ ˆï¼Œæ­¤æ—¶å†…éƒ¨å±æ€§ [[Function]] å°±èµ·åˆ°ä½œç”¨äº†ï¼š</p><p>å¦‚æœç¨‹åºæ‰§è¡Œåˆ°æŸä¸ªç‚¹æŠ›å‡ºå¼‚å¸¸äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªè®°å½•æ‰§è¡Œä¸Šä¸‹æ–‡çš„ stack æ¥è¿½è¸ªåˆ°åº•å“ªé‡Œå‡ºé”™äº†ï¼Œå¯ä»¥çœ‹åˆ°æ•´ä¸ªè°ƒç”¨æ ˆï¼Œæ­¤æ—¶å†…éƒ¨å±æ€§ [[Function]] å°±èµ·åˆ°ä½œç”¨äº†ï¼š</p><p><img src="https://image-static.segmentfault.com/604/427/604427279-5923b8b23e1a4_articlex" alt="error"></p><h1 id="ä½œç”¨åŸŸä¸æ‰§è¡Œä¸Šä¸‹æ–‡çš„å…³ç³»"><a href="#ä½œç”¨åŸŸä¸æ‰§è¡Œä¸Šä¸‹æ–‡çš„å…³ç³»" class="headerlink" title="ä½œç”¨åŸŸä¸æ‰§è¡Œä¸Šä¸‹æ–‡çš„å…³ç³»"></a>ä½œç”¨åŸŸä¸æ‰§è¡Œä¸Šä¸‹æ–‡çš„å…³ç³»</h1><p>å› ä¸ºåœ¨ä¸€ä¸ªå‡½æ•°è¢«æ‰§è¡Œæ—¶ï¼Œåˆ›å»ºçš„æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡é™¤äº†ä¿å­˜äº†äº›ä»£ç æ‰§è¡Œçš„ä¿¡æ¯ï¼Œè¿˜ä¼šæŠŠå½“å‰çš„ä½œç”¨åŸŸä¿å­˜åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œæ‰€ä»¥ä»–ä»¬çš„å…³ç³»åªæ˜¯å­˜å‚¨å…³ç³»ã€‚</p><h2 id="å˜é‡æŸ¥æ‰¾"><a href="#å˜é‡æŸ¥æ‰¾" class="headerlink" title="å˜é‡æŸ¥æ‰¾"></a>å˜é‡æŸ¥æ‰¾</h2><p>ç»“åˆä½œç”¨åŸŸå’Œæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹å˜é‡æŸ¥æ‰¾çš„è¿‡ç¨‹ã€‚å…¶å®ç¬¬ä¸€æ­¥ä¸æ˜¯åˆ°ä½œç”¨åŸŸé‡Œé¢æ‰¾ Environment Recordï¼Œè€Œæ˜¯å…ˆä»å½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ‰¾ä¿å­˜çš„ä½œç”¨åŸŸï¼ˆå¯¹è±¡ï¼‰ï¼Œç„¶åå†æ˜¯é€šè¿‡ä½œç”¨åŸŸé“¾å‘ä¸ŠæŸ¥æ‰¾å˜é‡ã€‚è€Œä¸”åŒä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¿å­˜çš„ä½œç”¨åŸŸï¼ˆå¯¹è±¡ï¼‰æ˜¯å¯å˜çš„ï¼Œå½“ä»£ç åœ¨åŒä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œçš„æ—¶å€™ï¼Œå¦‚æœç¢°åˆ°æœ‰å¿…è¦ç”Ÿæˆä¸€ä¸ªæ–°ä½œç”¨åŸŸçš„æ—¶å€™ï¼Œè¿™ä¸ªæ–°çš„ä½œç”¨åŸŸä¼šè¢«æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„å¤´éƒ¨ï¼Œç„¶åæ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¿å­˜çš„ä½œç”¨åŸŸå¯¹è±¡å°±æ›´æ–°æˆè¿™ä¸ªæ–°çš„ä½œç”¨åŸŸã€‚ç­‰è¿™ä¸ªæ–°çš„ä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸå®Œæˆåï¼Œä½œç”¨åŸŸé“¾åˆä¼šæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶å†µï¼Œç„¶åæ‰§è¡Œä¸Šä¸‹æ–‡ä¿å­˜çš„ä½œç”¨åŸŸä¹Ÿä¼šæ¢å¤æˆä¹‹å‰çš„<br><img src="https://image-static.segmentfault.com/362/224/362224718-5923b8c5ad74b_articlex" alt="ç¤ºä¾‹"></p><h2 id="this"><a href="#this" class="headerlink" title="this"></a>this</h2><p>ç½‘ä¸Šæœ‰æŠŠæ‰§è¡Œä¸Šä¸‹æ–‡ç­‰åŒäº this çš„æ–‡ç« ï¼Œå…¶å® this çš„å€¼æ˜¯é€šè¿‡å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ä¿å­˜çš„ä½œç”¨åŸŸï¼ˆå¯¹è±¡ï¼‰æ¥è·å–åˆ°çš„ï¼Œè§„èŒƒå¦‚ä¸‹ã€‚</p><blockquote><p>ResolveThisBinding ( )<br>The abstract operation ResolveThisBinding determines the binding of the keyword this using the LexicalEnvironment of the running execution context. ResolveThisBinding performs the following steps:</p></blockquote><p>1.Let envRec be GetThisEnvironment( ).</p><p>2.Return envRec.GetThisBinding().</p><p><a href="https://segmentfault.com/a/1190000009522006" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>props å’Œ state çš„åŒºåˆ« </title>
      <link href="/2018/04/08/React/props-%E5%92%8C-state-%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/2018/04/08/React/props-%E5%92%8C-state-%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<p>reactæ˜¯åŸºäºçŠ¶æ€å®ç°å¯¹DOMæ§åˆ¶å’Œæ¸²æŸ“ã€‚ç»„ä»¶çŠ¶æ€å¯åˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§æ˜¯ç»„ä»¶é—´çš„çŠ¶æ€ä¼ é€’ï¼Œå¦ä¸€ç§æ˜¯ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ã€‚è¿™ä¸¤ç§çŠ¶æ€ä½¿ç”¨<code>props</code>å’Œ<code>state</code>è¡¨ç¤ºã€‚<code>props</code>ç”¨äºçˆ¶ç»„ä»¶å‘å­ç»„ä»¶çš„æ•°æ®ä¼ é€’ï¼Œç»„ä»¶å†…éƒ¨ä¹Ÿæœ‰è‡ªå·±çš„çŠ¶æ€ï¼š<code>state</code>ï¼Œè¿™äº›çŠ¶æ€åªèƒ½åœ¨ç»„ä»¶å†…éƒ¨ä¿®æ”¹ã€‚</p><h1 id="æ•°æ®æµä¸props"><a href="#æ•°æ®æµä¸props" class="headerlink" title="æ•°æ®æµä¸props"></a>æ•°æ®æµä¸props</h1><p>reactçš„æ•°æ®æµæ˜¯å•å‘çš„ï¼Œåªä¼šä»çˆ¶ç»„ä»¶ä¼ é€’åˆ°å­ç»„ä»¶ã€‚å±æ€§propsï¼ˆpropertiesï¼‰æ˜¯çˆ¶å­ç»„ä»¶è¿›è¡Œä¼ é€’çŠ¶æ€çš„æ¥å£ã€‚Reactä¼šå‘ä¸‹éå†æ•´ä¸ªç»„ä»¶æ ‘ï¼Œå¹¶é‡æ–°æ¸²æŸ“ä½¿ç”¨è¿™ä¸ªå±æ€§çš„ç»„ä»¶ã€‚</p><h2 id="è®¾ç½®props"><a href="#è®¾ç½®props" class="headerlink" title="è®¾ç½®props"></a>è®¾ç½®props</h2><p>å¯ä»¥åœ¨ç»„ä»¶æŒ‚è½½æ—¶è®¾ç½®<code>props</code></p><pre><code class="javascript">var sites = [{title:&#39;baidu.com&#39;}];&lt;ListSites sites = {sites}/&gt;</code></pre><p>ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ç»„ä»¶å®ä¾‹çš„<code>SetProps()</code>æ–¹æ³•è®¾ç½®props</p><pre><code class="javascript">var sites = [{title:&#39;baidu.com&#39;}];ReactDOM.render(    &lt;ListSites/&gt;,    document.getElementById(&#39;example&#39;))</code></pre><a id="more"></a><p>SetProps()æ–¹æ³•åªèƒ½ç”¨äºç»„ä»¶å¤–éƒ¨è°ƒç”¨ï¼Œä¸èƒ½åœ¨ç»„ä»¶å†…ä½¿ç”¨<code>this.SetProps()</code>ä¿®æ”¹ç»„ä»¶å±æ€§ã€‚ç»„ä»¶å†…éƒ¨çš„this.propsæ˜¯åªè¯»çš„ï¼Œåªèƒ½ç”¨äºè®¿é—®propså±æ€§ï¼Œä¸èƒ½ä¿®æ”¹ç»„ä»¶è‡ªèº«çš„å±æ€§ã€‚</p><h3 id="JSXè¯­æ³•ä¸­çš„å±æ€§è®¾ç½®"><a href="#JSXè¯­æ³•ä¸­çš„å±æ€§è®¾ç½®" class="headerlink" title="JSXè¯­æ³•ä¸­çš„å±æ€§è®¾ç½®"></a>JSXè¯­æ³•ä¸­çš„å±æ€§è®¾ç½®</h3><p>JSXè¯­æ³•ä¸­ï¼Œpropså¯ä»¥è®¾ç½®ä¸ºå­—ç¬¦ä¸²ï¼š</p><pre><code class="javascript">&lt;a href=&quot;http://itbilu.com&quot;&gt;ITç¬”å½•&lt;/a&gt;</code></pre><p>æˆ–æ˜¯é€šè¿‡{}è¯­æ³•è®¾ç½®ï¼š</p><pre><code class="javascript">var obj = {url:&#39;itbilu.com&#39;, name:&#39;ITç¬”å½•&#39;};&lt;a href=&quot;http://{obj.url}&quot;&gt;{obj.name}&lt;/a&gt;</code></pre><p>JSXè¿˜æ”¯æŒå°†propsç›´æ¥è®¾ç½®ä¸ºä¸€ä¸ªå¯¹è±¡ï¼š</p><pre><code class="javascript">class Site extends React.Component{    render(){        var obj = ({url:&#39;baidu.com&#39;,name:&#39;ITç¬”å½•&#39;})        return(            &lt;Site {...obj}/&gt;        )    }}</code></pre><p>propsè¿˜å¯ä»¥ç”¨æ¥æ·»åŠ äº‹ä»¶å¤„ç†ï¼š</p><pre><code class="javascript">var saveBtn = React.createClass({    render:function(){        &lt;a onClick={this.handleClick}&gt;ä¿å­˜&lt;/a&gt;    }    handleClick:function(){        //...    }})</code></pre><h3 id="propsçš„ä¼ é€’"><a href="#propsçš„ä¼ é€’" class="headerlink" title="propsçš„ä¼ é€’"></a>propsçš„ä¼ é€’</h3><p>ç»„ä»¶æ¥æ”¶ä¸Šçº§ç»„ä»¶çš„propsï¼Œå¹¶ä¼ é€’åˆ°ä¸‹çº§ç»„ä»¶ï¼Œå¦‚ï¼š</p><pre><code class="javascript">var myCheackBox = React.createClass ({    render:myCheackBox(){        var myClass = this.props.cheacked ? &#39;MyCheacked&#39;:&#39;MyCheackBox&#39;;        return(            &lt;div className = {myClass} onClick = {this.props.onClick}&gt;                {this.props.children}            &lt;/div&gt;        )    }})React.render(    &lt;MyCheackBox cheacked = {true} onClick = {console.log.bind(console)}&gt;        hello world    &lt;MyCheackBox/&gt;,    document.getElementById(&#39;example&#39;))</code></pre><h2 id="ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸State"><a href="#ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸State" class="headerlink" title="ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸State"></a>ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸State</h2><p>propså¯ä»¥ç†è§£ä¸ºçˆ¶å­ç»„ä»¶çš„çŠ¶æ€ä¼ é€’ï¼Œè€ŒReactæœ‰è‡ªå·±å†…éƒ¨çš„çŠ¶æ€ï¼Œè¿™ä¸ªå†…éƒ¨çŠ¶æ€åˆ™ç”¨Stateè¡¨ç¤ºã€‚</p><p>å¦‚ï¼Œç”¨stateå®šä¹‰ä¸€ä¸ª<DropDown />ç»„ä»¶çš„çŠ¶æ€ï¼š</p><pre><code class="javascript">var SiteDropdown = React.createClass({     getInitalState: function() {        return: {        showOptions: false        }     }     render:function(){         var opts;         if(this.state.showOptions){             &lt;ul&gt;                &lt;li&gt;itbilu.com&lt;/li&gt;                &lt;li&gt;yijiebuyi.com&lt;/li&gt;                &lt;li&gt;niefengjun.cn&lt;/li&gt;             &lt;/ul&gt;         };         return( &lt;div onClick={this.handleClick} &gt;                &lt;/div&gt;        )     },     handleClick:function(){         this.SetState ({             showOptions: true         })     }  }})</code></pre><p>éšç€stateçš„å˜åŒ–ï¼Œrenderä¹Ÿä¼šè°ƒç”¨ï¼Œreactä¼šå¯¹æ¯”renderè¿”å›çš„å€¼ï¼Œå¦‚æœæœ‰å˜åŒ–å°±ä¼šDOMï¼›<br>stateä¸propsç±»ä¼¼ï¼Œåªèƒ½é€šè¿‡setState()æ–¹æ³•ä¿®æ”¹ã€‚ä¸åŒçš„æ˜¯ï¼Œstateåªèƒ½åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨ï¼Œå…¶å®æ˜¯å¯¹ç»„ä»¶æœ¬èº«çŠ¶æ€çš„ä¸€ä¸ªå¼•ç”¨</p><h2 id="propsä¸stateçš„æ¯”è¾ƒ"><a href="#propsä¸stateçš„æ¯”è¾ƒ" class="headerlink" title="propsä¸stateçš„æ¯”è¾ƒ"></a>propsä¸stateçš„æ¯”è¾ƒ</h2><p><code>React</code>ä¼šæ ¹æ®<code>props</code>å’Œ<code>state</code>æ›´æ–°è§†å›¾çŠ¶æ€ï¼Œè™½ç„¶äºŒè€…æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ˜¯ä¸¤è€…çš„åº”ç”¨èŒƒå›´ä¸åŒã€‚å…·ä½“è¡¨ç°å¦‚ä¸‹ï¼š</p><blockquote><ul><li>propsä¼šåœ¨æ•´ä¸ªç»„ä»¶æ•°ä¸­ä¼ é€’æ•°æ®å’Œé…ç½®ï¼Œpropså¯ä»¥è®¾ç½®ä»»å‘½ç±»å‹çš„æ•°æ®ï¼Œåº”è¯¥æŠŠå½“ä½œç»„ä»¶çš„æ•°æ®æºã€‚å…¶ä¸ä½†å¯ä»¥ç”¨äºä¸Šçº§ç»„ä»¶ä¸ä¸‹çº§ç»„ä»¶çš„é€šä¿¡ï¼Œä¹Ÿå¯ä»¥ç”¨ä½œäº‹ä»¶å¤„ç†å™¨</li></ul></blockquote><blockquote><ul><li>stateåªèƒ½ç»„ä»¶å†…éƒ¨ä½¿ç”¨ï¼Œstateåªåº”è¯¥ç”¨äºå­˜å‚¨ç®€å•çš„è§†å›¾çŠ¶ï¼ˆå¦‚ï¼šä¸Šé¢ç¤ºä¾‹ç”¨äºæ§åˆ¶ä¸‹æ‹‰æ¡†çš„å¯è§çŠ¶æ€ï¼‰</li></ul></blockquote><blockquote><ul><li>propsä¸stateéƒ½ä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Œè€Œåº”è¯¥åˆ†åˆ«ä½¿ç”¨SetProps()å’ŒSetProps()ä¿®æ”¹</li></ul></blockquote><p><a href="https://itbilu.com/javascript/react/4k5RfzDKx.html#props" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Reactï¼šç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</title>
      <link href="/2018/04/04/React/React%EF%BC%9A%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
      <url>/2018/04/04/React/React%EF%BC%9A%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œéšç€è¯¥ç»„ä»¶çš„propsæˆ–è€…stateå‘ç”Ÿæ”¹å˜ï¼Œå…¶DOMè¡¨ç°ä¹Ÿä¼šæœ‰ç›¸åº”çš„å˜åŒ–ã€‚ä¸€ä¸ªç»„ä»¶å°±æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå¯¹äºç‰¹å®šåœ°è¾“å…¥ï¼Œå®ƒæ€»è¿”å›ä¸€è‡´çš„è¾“å‡ºã€‚</p><p>ä¸€ä¸ªReactç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š<strong>å®ä¾‹åŒ–ã€å­˜åœ¨æœŸå’Œé”€æ¯æ—¶</strong>ã€‚</p><h1 id="å®ä¾‹åŒ–"><a href="#å®ä¾‹åŒ–" class="headerlink" title="å®ä¾‹åŒ–"></a>å®ä¾‹åŒ–</h1><p>å½“ç»„ä»¶åœ¨<em>å®¢æˆ·ç«¯</em>è¢«å®ä¾‹åŒ–ï¼Œç¬¬ä¸€æ¬¡è¢«åˆ›å»ºæ—¶ï¼Œä»¥ä¸‹æ–¹æ³•ä¾æ¬¡è¢«è°ƒç”¨ï¼š</p><p>1ã€getDefaultProps<br>2ã€getInitialState  </p><p>1ã€2æ­¥éª¤ä½¿ç”¨Es6è¯­æ³•åˆ™ä¸º</p><pre><code class="javascript">constructor(props){    super(props);    this.state = {}}</code></pre><p>3ã€componentWillMount<br>4ã€render<br>5ã€componentDidMount</p><p>å½“ç»„ä»¶åœ¨<em>æœåŠ¡ç«¯</em>è¢«å®ä¾‹åŒ–ï¼Œé¦–æ¬¡è¢«åˆ›å»ºæ—¶ï¼Œä»¥ä¸‹æ–¹æ³•ä¾æ¬¡è¢«è°ƒç”¨ï¼š<br>1ã€getDefaultProps<br>2ã€getInitialState<br>3ã€componentWillMount<br>4ã€render</p><p>componentDidMount ä¸ä¼šåœ¨æœåŠ¡ç«¯è¢«æ¸²æŸ“çš„è¿‡ç¨‹ä¸­è°ƒç”¨ã€‚</p><h2 id="getDefaultProps"><a href="#getDefaultProps" class="headerlink" title="getDefaultProps"></a>getDefaultProps</h2><p>å¯¹äºæ¯ä¸ªç»„ä»¶å®ä¾‹æ¥è®²ï¼Œè¿™ä¸ªæ–¹æ³•åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œè¯¥ç»„ä»¶ç±»çš„æ‰€æœ‰åç»­åº”ç”¨ï¼ŒgetDefaultPops å°†ä¸ä¼šå†è¢«è°ƒç”¨ï¼Œå…¶è¿”å›çš„å¯¹è±¡å¯ä»¥ç”¨äºè®¾ç½®é»˜è®¤çš„ props(propertiesçš„ç¼©å†™) å€¼ã€‚</p><pre><code class="javascript">var Hello = React.createClass({    getDefaultProps:function(){        return{            name : &quot;tom&quot;,            git : &quot;dwqs&quot;        }    },    render : function(){        return{            &lt;div&gt;Hello,{this.props.name},git username is {this.props.git}&lt;/div&gt;        }    }})ReactDOM.render(&lt;Hello/&gt;,document.body)</code></pre><a id="more"></a><p>ä¹Ÿå¯ä»¥åœ¨æŒ‚è½½ç»„ä»¶çš„æ—¶å€™è®¾ç½® propsï¼š</p><pre><code class="javascript">var data = [{title:&#39;Hello&#39;}];&lt;Hello data={data}/&gt;&gt;</code></pre><p>æˆ–è€…è°ƒç”¨ <code>setProps</code> ï¼ˆä¸€èˆ¬ä¸éœ€è¦è°ƒç”¨ï¼‰æ¥è®¾ç½®å…¶ props</p><pre><code class="javascript">var data = [{title:&#39;data&#39;}];var Hello = ReactDOM.render(&lt;/Demo&gt;,document.body);Hello.setProps({data:data})</code></pre><p><strong>ä½†åªèƒ½åœ¨å­ç»„ä»¶æˆ–ç»„ä»¶æ ‘ä¸Šè°ƒç”¨ setPropsã€‚åˆ«è°ƒç”¨ this.setProps æˆ–è€… ç›´æ¥ä¿®æ”¹ this.propsã€‚å°†å…¶å½“åšåªè¯»æ•°æ®ã€‚</strong></p><p>Reacté€šè¿‡ <code>propTypes</code> æä¾›äº†ä¸€ç§éªŒè¯ props çš„æ–¹å¼ï¼ŒpropTypes æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œç”¨äºå®šä¹‰å±æ€§ç±»å‹ï¼š</p><pre><code class="javascript">var survey = React.createClass({    propTypes:{        survey:React.propTypes.shape({            id: React.propType.number.isRequered;        }).isRequiered,        onClick:React.propTypes.func,        name: React.propTypes.string,        score: React.propTypes.array        //...    },   // ...})</code></pre><p>ç»„ä»¶åˆå§‹åŒ–æ—¶ï¼Œå¦‚æœä¼ é€’çš„å±æ€§å’Œ propTypes ä¸åŒ¹é…ï¼Œåˆ™ä¼šæ‰“å°ä¸€ä¸ª console.warn æ—¥å¿—ã€‚å¦‚æœæ˜¯å¯é€‰é…ç½®ï¼Œå¯ä»¥å»æ‰.isRequiredã€‚propTypes çš„è¯¦è§£å¯<a href="https://facebook.github.io/react/docs/typechecking-with-proptypes.html" target="_blank" rel="noopener">æˆ³æ­¤</a></p><h2 id="getInitalState"><a href="#getInitalState" class="headerlink" title="getInitalState"></a>getInitalState</h2><p>å¯¹äºç»„ä»¶çš„æ¯ä¸ªå®ä¾‹æ¥è¯´ï¼Œè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨getInitalStateæœ‰ä¸”åªæœ‰ä¸€æ¬¡ï¼ŒgetInitalStateç”¨æ¥åˆå§‹åŒ–æ¯ä¸ªå®ä¾‹çš„ stateï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œï¼Œå¯ä»¥è®¿é—®ç»„ä»¶çš„ propsã€‚æ¯ä¸€ä¸ªReactç»„ä»¶éƒ½æœ‰è‡ªå·±çš„ stateï¼Œå…¶ä¸ props çš„åŒºåˆ«åœ¨äº stateåªå­˜åœ¨ç»„ä»¶çš„å†…éƒ¨ï¼Œprops åœ¨æ‰€æœ‰å®ä¾‹ä¸­å…±äº«ã€‚</p><blockquote><p>getInitialState å’Œ getDefaultPops çš„è°ƒç”¨æ˜¯æœ‰åŒºåˆ«çš„ï¼ŒgetDefaultPops æ˜¯å¯¹äºç»„ä»¶ç±»æ¥è¯´åªè°ƒç”¨ä¸€æ¬¡ï¼Œåç»­è¯¥ç±»çš„åº”ç”¨éƒ½ä¸ä¼šè¢«è°ƒç”¨ï¼Œè€Œ getInitialState æ˜¯å¯¹äºæ¯ä¸ªç»„ä»¶å®ä¾‹æ¥è®²éƒ½ä¼šè°ƒç”¨ï¼Œå¹¶ä¸”åªè°ƒä¸€æ¬¡</p></blockquote><pre><code class="javascript">var LikeButton = React.createClass({    getInitalState:function(){        return {liked :false}    }    handleClick:function(event){        this.setState({liked : !this.state.liked})    }    render:function(){        var text = this.state.liked ? &#39;liked&#39; : &#39;dont like&#39;        return(            &lt;p onClick = {this.handleClick}&gt;                you {text} this book;            &lt;/p&gt;        )    }})ReactDOM.render(  &lt;LikeButton /&gt;,  document.getElementById(&#39;example&#39;));</code></pre><p>æ¯æ¬¡ä¿®æ”¹ stateï¼Œéƒ½ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Œå®ä¾‹åŒ–åé€šè¿‡ state æ›´æ–°ç»„ä»¶ï¼Œä¼šä¾æ¬¡è°ƒç”¨ä¸‹åˆ—æ–¹æ³•</p><p>1ã€shouldComponentUpdate<br>2ã€conponentWillUpdate<br>3ã€render<br>4ã€conponentDidUpdate</p><p>ä½†æ˜¯ä¸è¦ç›´æ¥ä¿®æ”¹ <em>this.state</em>ï¼Œè¦é€šè¿‡ <em>this.setState</em> æ–¹æ³•æ¥ä¿®æ”¹ã€‚</p><h2 id="componentWillMount"><a href="#componentWillMount" class="headerlink" title="componentWillMount"></a>componentWillMount</h2><p>åœ¨é¦–æ¬¡æ¸²æŸ“æ‰§è¡Œå‰ç«‹å³è°ƒç”¨ä¸”ä»…è°ƒç”¨ä¸€æ¬¡ã€‚å¦‚æœåœ¨è¿™ä¸ªæ–¹æ³•å†…éƒ¨è°ƒç”¨ setState å¹¶ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œè¿™ä¹Ÿæ˜¯åœ¨ render æ–¹æ³•è°ƒç”¨ä¹‹å‰ä¿®æ”¹ state çš„æœ€åä¸€æ¬¡æœºä¼šã€‚</p><h2 id="render"><a href="#render" class="headerlink" title="render"></a>render</h2><p>è¯¥æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹ŸDOMï¼Œç”¨æ¥è¡¨ç¤ºç»„ä»¶çš„è¾“å‡ºã€‚å¯¹äºä¸€ä¸ªç»„ä»¶æ¥è®²ï¼Œrenderæ–¹æ³•æ˜¯å”¯ä¸€ä¸€ä¸ªå¿…éœ€çš„æ–¹æ³•ã€‚renderæ–¹æ³•éœ€è¦æ»¡è¶³ä¸‹é¢å‡ ç‚¹ï¼š</p><p>1.åªèƒ½é€šè¿‡this.stateå’Œthis.propsè®¿é—®æ•°æ®ï¼ˆä¸èƒ½ä¿®æ”¹ï¼‰<br>2.å¯ä»¥è¿”å›nullå’Œfalse æˆ–è€…ä»»ä½•Reactç»„ä»¶<br>3.åªèƒ½å‡ºç°ä¸€ä¸ªé¡¶çº§ç»„ä»¶ï¼Œä¸èƒ½è¿”å›ä¸€ç»„å…ƒç´ <br>4.ä¸èƒ½æ”¹å˜ç»„ä»¶çš„çŠ¶æ€<br>5.ä¸èƒ½ä¿®æ”¹Domçš„è¾“å‡º</p><p>renderæ–¹æ³•è¿”å›çš„ç»“æœå¹¶ä¸æ˜¯çœŸæ­£çš„DOMå…ƒç´ ï¼Œè€Œæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„è¡¨ç°ï¼Œç±»ä¼¼äºä¸€ä¸ªDOM treeçš„ç»“æ„çš„å¯¹è±¡ã€‚reactä¹‹æ‰€ä»¥æ•ˆç‡é«˜ï¼Œå°±æ˜¯è¿™ä¸ªåŸå› ã€‚</p><h2 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount"></a>componentDidMount</h2><p>è¯¥æ–¹æ³•ä¸ä¼šåœ¨æœåŠ¡ç«¯è¢«æ¸²æŸ“çš„è¿‡ç¨‹ä¸­è°ƒç”¨ã€‚è¯¥æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå·²ç»æ¸²æŸ“å‡ºçœŸå®çš„ DOMï¼Œå¯ä»¥å†è¯¥æ–¹æ³•ä¸­é€šè¿‡ <code>this.getDOMNode()</code> è®¿é—®åˆ°çœŸå®çš„ DOM(æ¨èä½¿ç”¨ <code>ReactDOM.findDOMNode()</code>)ã€‚</p><pre><code class="javascript">var data = [..];var comp = React.createClass({    render: function(){        return &lt;imput .. /&gt;    },    conponentDidMount: function(){        $(this.getDOMNode()).autoComplete({            src: data        })    }})</code></pre><p>ç”±äºç»„ä»¶å¹¶ä¸æ˜¯çœŸå®çš„ DOM èŠ‚ç‚¹ï¼Œè€Œæ˜¯å­˜åœ¨äºå†…å­˜ä¹‹ä¸­çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå«åšè™šæ‹Ÿ DOM ï¼ˆvirtual DOMï¼‰ã€‚åªæœ‰å½“å®ƒæ’å…¥æ–‡æ¡£ä»¥åï¼Œæ‰ä¼šå˜æˆçœŸå®çš„ DOM ã€‚<strong>æœ‰æ—¶éœ€è¦ä»ç»„ä»¶è·å–çœŸå® DOM çš„èŠ‚ç‚¹ï¼Œè¿™æ—¶å°±è¦ç”¨åˆ° ref å±æ€§</strong></p><pre><code class="javascript">var Aera = React.createClass ({    render:function(){        this.getDOMNode();//renderè°ƒç”¨æ—¶ï¼Œè¿™é‡ŒæœªæŒ‚è½½ï¼Œä¼šæŠ¥é”™        return(            return &lt;canvas ref=&#39;mainCanvas&#39;&gt;        )    }ï¼Œ    componentDidMount: function(){        var canvas = this.refs.mainCanvas.getDOMNode();        //è¿™æ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥è®¿é—®åˆ° Canvas èŠ‚ç‚¹    }})</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº <code>this.refs.[refName]</code> å±æ€§è·å–çš„æ˜¯çœŸå® DOM ï¼Œæ‰€ä»¥å¿…é¡»ç­‰åˆ°è™šæ‹Ÿ DOM æ’å…¥æ–‡æ¡£ä»¥åï¼Œæ‰èƒ½ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><h1 id="å­˜åœ¨æœŸ"><a href="#å­˜åœ¨æœŸ" class="headerlink" title="å­˜åœ¨æœŸ"></a>å­˜åœ¨æœŸ</h1><p>æ­¤æ—¶ç»„ä»¶å·²ç»æ¸²æŸ“å¥½å¹¶ä¸”ç”¨æˆ·å¯ä»¥ä¸å®ƒè¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚é¼ æ ‡ç‚¹å‡»ï¼Œæ‰‹æŒ‡ç‚¹æŒ‰ï¼Œæˆ–è€…å…¶å®ƒçš„ä¸€äº›äº‹ä»¶ï¼Œå¯¼è‡´åº”ç”¨çŠ¶æ€çš„æ”¹å˜ï¼Œä½ å°†ä¼šçœ‹åˆ°ä¸‹é¢çš„æ–¹æ³•ä¾æ¬¡è¢«è°ƒç”¨<br>1ã€componentWillReceiveProps<br>2ã€shouldComponentUpdate<br>3ã€componentWillUpdate<br>4ã€render<br>5ã€componentDidUpdate</p><h2 id="componentWillReceiveProps"><a href="#componentWillReceiveProps" class="headerlink" title="componentWillReceiveProps"></a>componentWillReceiveProps</h2><p>ç»„ä»¶çš„ props å±æ€§å¯ä»¥é€šè¿‡çˆ¶ç»„ä»¶æ¥æ›´æ”¹ï¼Œè¿™æ—¶ï¼ŒcomponentWillReceiveProps å°†æ¥è¢«è°ƒç”¨ã€‚å¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•é‡Œæ›´æ–° state,ä»¥è§¦å‘ render æ–¹æ³•é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚</p><pre><code class="javascript">componentWillReceliveProps:function(nextProps){    if(nextProps.click !== undefined){        this.setState({            checked: nextProps.checked        })    }}</code></pre><h2 id="shouldComponentUpdate"><a href="#shouldComponentUpdate" class="headerlink" title="shouldComponentUpdate"></a>shouldComponentUpdate</h2><p>å¦‚æœä½ ç¡®å®šç»„ä»¶çš„ props æˆ–è€… state çš„æ”¹å˜ä¸éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œå¯ä»¥é€šè¿‡åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé€šè¿‡è¿”å› <code>false</code> æ¥é˜»æ­¢ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œè¿”å› <code>false</code>åˆ™ä¸ä¼šæ‰§è¡Œ render ä»¥åŠåé¢çš„ <code>componentWillUpdate</code>ï¼Œ<code>componentDidUpdate</code>æ–¹æ³•ã€‚</p><p>è¯¥æ–¹æ³•æ˜¯éå¿…é¡»çš„ï¼Œå¹¶ä¸”å¤§å¤šæ•°æƒ…å†µä¸‹æ²¡æœ‰åœ¨å¼€å‘ä¸­ä½¿ç”¨ã€‚</p><pre><code class="javascript">shouldComponentUpdate: function(nextProps, nextState){    return this.state.checked === nextState.checked;    //return false åˆ™ä¸æ›´æ–°ç»„ä»¶}</code></pre><h2 id="componentWillUpdate"><a href="#componentWillUpdate" class="headerlink" title="componentWillUpdate"></a>componentWillUpdate</h2><p>è¿™ä¸ªæ–¹æ³•å’Œ componentWillMount ç±»ä¼¼ï¼Œåœ¨ç»„ä»¶æ¥æ”¶åˆ°äº†æ–°çš„ props æˆ–è€… state å³å°†è¿›è¡Œé‡æ–°æ¸²æŸ“å‰ï¼ŒcomponentWillUpdate(object nextProps, object nextState) ä¼šè¢«è°ƒç”¨ï¼Œæ³¨æ„<strong>ä¸è¦åœ¨æ­¤æ–¹é¢é‡Œå†å»æ›´æ–° props æˆ–è€… state</strong>ã€‚</p><h2 id="componentDidUpdate"><a href="#componentDidUpdate" class="headerlink" title="componentDidUpdate"></a>componentDidUpdate</h2><p>è¿™ä¸ªæ–¹æ³•å’Œ componentDidMount ç±»ä¼¼ï¼Œåœ¨ç»„ä»¶é‡æ–°è¢«æ¸²æŸ“ä¹‹åï¼ŒcomponentDidUpdate(object prevProps, object prevState) ä¼šè¢«è°ƒç”¨ã€‚å¯ä»¥åœ¨è¿™é‡Œè®¿é—®å¹¶ä¿®æ”¹ DOMã€‚</p><h1 id="é”€æ¯æœŸ"><a href="#é”€æ¯æœŸ" class="headerlink" title="é”€æ¯æœŸ"></a>é”€æ¯æœŸ</h1><h2 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h2><p>æ¯å½“Reactä½¿ç”¨å®Œä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶å¿…é¡»ä» DOM ä¸­å¸è½½åè¢«é”€æ¯ï¼Œæ­¤æ—¶ componentWillUnmout ä¼šè¢«æ‰§è¡Œï¼Œå®Œæˆæ‰€æœ‰çš„æ¸…ç†å’Œé”€æ¯å·¥ä½œï¼Œåœ¨ conponentDidMount ä¸­æ·»åŠ çš„ä»»åŠ¡éƒ½éœ€è¦å†è¯¥æ–¹æ³•ä¸­æ’¤é”€ï¼Œå¦‚åˆ›å»ºçš„å®šæ—¶å™¨æˆ–äº‹ä»¶ç›‘å¬å™¨ã€‚</p><p>å½“å†æ¬¡è£…è½½ç»„ä»¶æ—¶ï¼Œä»¥ä¸‹æ–¹æ³•ä¼šè¢«ä¾æ¬¡è°ƒç”¨ï¼š<br>1ã€getInitialState<br>2ã€componentWillMount<br>3ã€render<br>4ã€componentDidMount</p><h1 id="åæ¨¡å¼"><a href="#åæ¨¡å¼" class="headerlink" title="åæ¨¡å¼"></a>åæ¨¡å¼</h1><p>åœ¨ getInitialState æ–¹æ³•ä¸­ï¼Œå°è¯•é€šè¿‡ this.props æ¥åˆ›å»º state çš„åšæ³•æ˜¯ä¸€ç§åæ¨¡å¼ã€‚</p><pre><code class="javascript">//åæ¨¡å¼getDefaultProps: function(){    return {        data: new Date()    }},getInitialState: function(){    return {        day: this.props.date - new Date()    }},render: function(){    return &lt;div&gt;Day:{this.state.day}&lt;/div&gt;}</code></pre><p>ç»è¿‡è®¡ç®—åçš„å€¼ä¸åº”è¯¥èµ‹ç»™ stateï¼Œæ­£ç¡®çš„æ¨¡å¼åº”è¯¥æ˜¯åœ¨æ¸²æŸ“æ—¶è®¡ç®—è¿™äº›å€¼ã€‚è¿™æ ·ä¿è¯äº†è®¡ç®—åçš„å€¼æ°¸è¿œä¸ä¼šä¸æ´¾ç”Ÿå‡ºå®ƒçš„ props å€¼ä¸åŒæ­¥ã€‚</p><pre><code class="javascript">getDefaultProps: function(){    return {        data: new Date()    }},render: function(){    var day = this.props.date - new Date();    return &lt;div&gt;Day:{day}&lt;/div&gt;}</code></pre><p>å¦‚æœåªæ˜¯ç®€å•çš„åˆå§‹åŒ– stateï¼Œé‚£ä¹ˆåº”ç”¨åæ¨¡å¼æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä¸‹é¢çš„ä¸€å¼ å›¾æ€»ç»“ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼š<br><img src="https://cloud.githubusercontent.com/assets/7871813/17771719/2c764710-6577-11e6-8393-f6acc6f262c2.png" alt="ç»„ä»¶ç”Ÿå‘½"></p><p><a href="https://github.com/dwqs/blog/issues/15" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Context APIè¯¦è§£</title>
      <link href="/2018/04/03/React/Context-API%E8%AF%A6%E8%A7%A3/"/>
      <url>/2018/04/03/React/Context-API%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>Reactåœ¨ç‰ˆæœ¬<code>16.3-alpha</code>é‡Œå¼•å…¥äº†æ–°çš„Context APIï¼Œç¤¾åŒºä¸€ç‰‡æœŸå¾…ä¹‹å£°ã€‚æˆ‘ä»¬å…ˆé€šè¿‡ç®€å•çš„ä¾‹å­ï¼Œçœ‹ä¸‹æ–°çš„Context APIé•¿å•¥æ ·ï¼Œç„¶åå†ç®€å•æ¢è®¨ä¸‹æ–°çš„APIçš„æ„ä¹‰ã€‚</p><p><a href="https://github.com/chyingp/blog/tree/master/demo/2018.02.08-react-16.3" target="_blank" rel="noopener">Demoåœ°å€</a></p><h1 id="çœ‹ä¸‹æ–°çš„Context-API"><a href="#çœ‹ä¸‹æ–°çš„Context-API" class="headerlink" title="çœ‹ä¸‹æ–°çš„Context API"></a>çœ‹ä¸‹æ–°çš„Context API</h1><p>éœ€è¦å®‰è£…16.3-alphaç‰ˆæœ¬çš„reactã€‚<br>ä¸‹é¢ï¼Œç›´æ¥æ¥çœ‹ä»£ç ï¼Œå¦‚æœç”¨è¿‡<code>react-redux</code>åº”è¯¥ä¼šè§‰å¾—å¾ˆçœ¼ç†Ÿã€‚<br>é¦–å…ˆï¼Œåˆ›å»º<code>context</code>å®ä¾‹ï¼š</p><pre><code class="javascript">import React from &#39;react&#39;;import ReactDOM from &#39;react-dom&#39;;// åˆ›å»ºcontextå®ä¾‹const ThemeContext = React.createContext({  background: &#39;red&#39;,  color: &#39;white&#39;});</code></pre><p>ç„¶åï¼Œå®šä¹‰Appç»„ä»¶ï¼Œæ³¨æ„è¿™é‡Œç”¨åˆ°äº†<code>Provider</code>ç»„ä»¶ï¼Œç±»ä¼¼<code>react-redux</code>çš„Providerç»„ä»¶</p><a id="more"></a><pre><code class="javascript">class App extends React.Component {  render () {    return (      &lt;ThemeContext.Provider value={{background: 'green', color: 'white'}}&gt;        &lt;Header /&gt;       &lt;/ThemeContext.Provider&gt;    );  }}</code></pre><p>æ¥ä¸‹æ¥ï¼Œå®šä¹‰<code>Header</code>ã€<code>Title</code>ç»„ä»¶ã€‚æ³¨æ„ï¼š</p><p>Titleç»„ä»¶ç”¨åˆ°äº†<code>Consumer</code>ç»„ä»¶ï¼Œè¡¨ç¤ºè¦æ¶ˆè´¹<code>Provider</code>ä¼ é€’çš„æ•°æ®ã€‚<br>Titleç»„ä»¶æ˜¯Appçš„å­™ç»„ä»¶ï¼Œä½†è·³è¿‡äº†<code>Header</code>æ¶ˆè´¹æ•°æ®ã€‚</p><pre><code class="javascript">class Header extends React.Component {  render () {    return (      &lt;Title&gt;Hello React Context API&lt;/Title&gt;    );  }}class Title extends React.Component {  render () {    return (      &lt;ThemeContext.Consumer&gt;        {context =&gt; (          &lt;h1 style={{background: context.background, color: context.color}}&gt;            {this.props.children}          &lt;/h1&gt;        )}      &lt;/ThemeContext.Consumer&gt;    );  }}</code></pre><p>æœ€åå¸¸è§„æ“ä½œ</p><pre><code class="javascript">ReactDOM.render(  &lt;App /&gt;,   document.getElementById(&#39;container&#39;));</code></pre><h1 id="ä¸ºä»€ä¹ˆæœ‰æ–°çš„Context-API"><a href="#ä¸ºä»€ä¹ˆæœ‰æ–°çš„Context-API" class="headerlink" title="ä¸ºä»€ä¹ˆæœ‰æ–°çš„Context API"></a>ä¸ºä»€ä¹ˆæœ‰æ–°çš„Context API</h1><p>è¿‡<code>redux + react-redux</code>çš„åŒå­¦ï¼Œåº”è¯¥ä¼šè§‰å¾—æ–°çš„Context APIå¾ˆçœ¼ç†Ÿã€‚è€Œæœ‰çœ‹è¿‡<code>react-redux</code>æºç çš„åŒå­¦å°±çŸ¥é“ï¼Œreact-reduxæœ¬èº«å°±æ˜¯åŸºäºæ—§ç‰ˆæœ¬çš„Context APIå®ç°çš„ã€‚</p><p>æ—¢ç„¶å·²ç»æœ‰äº†ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šæœ‰æ–°çš„Context APIå‘¢ï¼Ÿ</p><blockquote><p>ç°æœ‰Context APIçš„å®ç°å­˜åœ¨ä¸€å®šé—®é¢˜ï¼šæ¯”å¦‚å½“çˆ¶ç»„ä»¶çš„shouldComponentUpdateæ€§èƒ½ä¼˜åŒ–ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¶ˆè´¹äº†contextæ•°æ®çš„å­ç»„ä»¶ä¸æ›´æ–°ã€‚<br>1.é™ä½å¤æ‚åº¦ï¼šç±»ä¼¼reduxå…¨å®¶æ¡¶è¿™æ ·çš„è§£å†³æ–¹æ¡ˆï¼Œç»™é¡¹ç›®å¼•å…¥äº†ä¸€å®šçš„å¤æ‚åº¦ï¼Œå°¤å…¶æ˜¯å¯¹æ–¹æ¡ˆäº†è§£ä¸è¶³çš„åŒå­¦ï¼Œé‡åˆ°é—®é¢˜å¯èƒ½ä¸€ç­¹è«å±•ã€‚<br>2.æ–°Context APIçš„å¼•å…¥ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥ä¸å°‘é¡¹ç›®å¯¹reduxå…¨å®¶æ¡¶çš„ä¾èµ–ã€‚</p></blockquote><p><a href="http://cnodejs.org/topic/5a7bd5c4497a08f571384f03" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react 16.3æ–°ç‰¹æ€§</title>
      <link href="/2018/04/02/React/react-16-3%E6%96%B0%E7%89%B9%E6%80%A7/"/>
      <url>/2018/04/02/React/react-16-3%E6%96%B0%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="Context-API"><a href="#Context-API" class="headerlink" title="Context API"></a>Context API</h1><p>Context APIæ€»æ˜¯å¾ˆè®©äººè¿·æƒ‘ã€‚è¿™ä¸ªAPIæ˜¯å®˜æ–¹çš„ï¼Œä½†æ˜¯å®˜æ–¹åˆä¸å¸Œæœ›å¼€å‘è€…ä»¬ä½¿ç”¨è¿™ä¸ªAPIï¼Œè¯´æ˜¯è¿™ä¸ªAPIä¼šåœ¨ä»¥åå‘ç”Ÿæ”¹å˜ã€‚ç°åœ¨å°±æ˜¯é‚£ä¸ªæ”¹å˜çš„æ—¶åˆ»ã€‚æ–°çš„APIå·²ç»è¢«mergeäº†ã€‚è€Œä¸”å®ƒçœ‹èµ·æ¥æ›´åŠ çš„â€œç”¨æˆ·å‹å¥½â€äº†ã€‚å°¤å…¶æ˜¯ä½ ä¸å¾—ä¸ä½¿ç”¨reduxã€mobxçš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©æ–°çš„Context APIå®ç°æ›´åŠ ç®€å•çš„çŠ¶æ€ç®¡ç†ã€‚</p><p>æ–°çš„APIç”¨èµ·æ¥éå¸¸çš„ç®€å•ï¼š<strong>React.createContext()</strong>ï¼Œè¿™æ ·å°±åˆ›å»ºäº†ä¸¤ä¸ªç»„ä»¶ï¼š</p><pre><code class="javascript">import {context} from &#39;react&#39;;const ThemeContext = createContext({  background: &#39;yellow&#39;,  color: &#39;white&#39;});</code></pre><p>è°ƒç”¨createContextæ–¹æ³•ä¼šè¿”å›ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯<code>Provider</code>ï¼Œä¸€ä¸ªæ˜¯<code>Consumer</code>ã€‚</p><p>é‚£ä¸ªProvideræ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç»„ä»¶ã€‚å®ƒå¯ä»¥ç”¨æ¥ç»™å­æ ‘é‡Œçš„ç»„ä»¶æä¾›æ•°æ®ã€‚ä¸€ä¸ªä¾‹å­ï¼š</p><pre><code class="javascript">class Application extends React.Component {  render() {    &lt;ThemeContext.Provider value={{background: 'black', color: 'white'}}&gt;      &lt;Header /&gt;      &lt;Main /&gt;      &lt;Footer /&gt;    &lt;/ThemeContext.Provider&gt;  }}</code></pre><p>ä¸Šä¾‹å±•ç¤ºäº†å¦‚ä½•ä¼ é€’â€œthemeâ€ contextçš„ã€‚å½“ç„¶è¿™äº›å€¼å¯ä»¥æ˜¯åŠ¨æ€çš„ï¼ˆæ¯”å¦‚ï¼ŒåŸºäºthis.stateï¼‰ã€‚</p><a id="more"></a><p>ä¸‹ä¸€æ­¥å°±æ˜¯ä½¿ç”¨Consumerã€‚</p><pre><code class="javascript">const Header = () =&gt; {  &lt;ThemeContext.Consumer&gt;    {(context) =&gt; {      return (        &lt;p style={{background: context.background, color: context.color}}&gt;          Welcome!        &lt;/p&gt;      );    }}  &lt;/ThemeContext.Consumer&gt;}</code></pre><p>æ¥ä¸‹æ¥ï¼Œå®šä¹‰Headerã€Titleç»„ä»¶ã€‚æ³¨æ„ï¼š</p><p>Titleç»„ä»¶ç”¨åˆ°äº†Consumerç»„ä»¶ï¼Œè¡¨ç¤ºè¦æ¶ˆè´¹Providerä¼ é€’çš„æ•°æ®ã€‚<br>Titleç»„ä»¶æ˜¯Appçš„å­™ç»„ä»¶ï¼Œä½†è·³è¿‡äº†Headeræ¶ˆè´¹æ•°æ®ã€‚</p><pre><code class="javascript">    class Header extends React.Component {  render () {    return (      &lt;Title&gt;Hello React Context API&lt;/Title&gt;    );  }}class Title extends React.Component {  render () {    return (      &lt;ThemeContext.Consumer&gt;        {context =&gt; (          &lt;h1 style={{background: context.background, color: context.color}}&gt;            {this.props.children}          &lt;/h1&gt;        )}      &lt;/ThemeContext.Consumer&gt;    );  }}</code></pre><p>å¦‚æœåœ¨render Consumerçš„æ—¶å€™æ²¡æœ‰åµŒå¥—åœ¨ä¸€ä¸ªProvideré‡Œé¢ã€‚é‚£ä¹ˆå°±ä¼šä½¿ç”¨createContextæ–¹æ³•è°ƒç”¨çš„æ—¶å€™è®¾ç½®çš„é»˜è®¤å€¼ã€‚</p><p><strong>æ³¨æ„ï¼š</strong><br>Consumerå¿…é¡»å¯ä»¥è®¿é—®åˆ°åŒä¸€ä¸ªContextç»„ä»¶ã€‚å¦‚æœä½ è¦åˆ›å»ºä¸€ä¸ªæ–°çš„contextï¼Œç”¨çš„æ˜¯åŒæ ·çš„å…¥å‚ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°å»ºçš„contextçš„æ•°æ®æ˜¯ä¸å¯è®¿é—®çš„ã€‚å› æ­¤ï¼Œå¯ä»¥æŠŠContextå½“åšä¸€ä¸ªç»„ä»¶ï¼Œå®ƒå¯ä»¥åˆ›å»ºä¸€æ¬¡ï¼Œç„¶åå¯ä»¥exportï¼Œå¯ä»¥importã€‚</p><p>è¿™ä¸ªæ–°çš„è¯­æ³•ç”¨äº†function as childæ¨¡å¼ï¼ˆæœ‰æ—¶ä¹Ÿå«åšrender propæ¨¡å¼ï¼‰ã€‚å¦‚æœä¸æ˜¯å¾ˆç†Ÿæ‚‰è¿™ä¸ªæ¨¡å¼ï¼Œé‚£ä¹ˆæ¨èä½ çœ‹ä¸€ä¸‹è¿™äº›æ–‡ç« ã€‚<br>æ–°çš„APIä¸å†è¦æ±‚ä½ å£°æ˜<code>contextProps</code>äº†ã€‚<br>Contextä¼ é€’çš„æ•°æ®å’ŒContext.Providerç»„ä»¶çš„valueå±æ€§æ˜¯ä¸€æ ·çš„ã€‚å¯¹Provideræ•°æ®çš„ä¿®æ”¹ä¼šå¼•èµ·æ‰€æœ‰çš„æ¶ˆè´¹è€…<code>ï¼ˆconsumerï¼‰</code>é‡ç»˜ã€‚</p><h1 id="æ–°çš„å£°æ˜å‘¨æœŸæ–¹æ³•"><a href="#æ–°çš„å£°æ˜å‘¨æœŸæ–¹æ³•" class="headerlink" title="æ–°çš„å£°æ˜å‘¨æœŸæ–¹æ³•"></a>æ–°çš„å£°æ˜å‘¨æœŸæ–¹æ³•</h1><p>å‚è€ƒè¿™ä¸ªRFCã€‚æ–°çš„å£°æ˜å‘¨æœŸæ–¹æ³•ä¼šè¢«å¼•å…¥ï¼Œè€Œæ—§çš„ä¼šè¢«åºŸå¼ƒã€‚</p><p>è¿™ä¸€æ”¹å˜ä¸»è¦æ˜¯ä¸ºäº†å¼ºåˆ¶æ¨è¡Œæœ€ä½³å®è·µã€‚ä½ å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« æ¥äº†è§£ä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¼šå˜å¾—å¾ˆè¯¡å¼‚ã€‚è¿™äº›æœ€ä½³æ¨¡å¼åœ¨React 16çš„å¼‚æ­¥ç»˜åˆ¶æ¨¡å¼(Async Mode)ä¸‹æ˜¾å¾—éå¸¸é‡è¦ã€‚</p><blockquote><p>è¦è¢«åºŸå¼ƒçš„æ–¹æ³•ï¼š<br>componentWillMountâ€“&gt;ä½¿ç”¨componentDidMountä»£æ›¿<br>componentWillUpdateâ€“&gt;ä½¿ç”¨componentDidUpdateä»£æ›¿<br>componentWillReceivePropsâ€“&gt;ä½¿ç”¨ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼šstatic getDerivedStateFromPropsæ¥ä»£æ›¿ã€‚</p></blockquote><p>ä¸è¿‡è¿™äº›å¹¶ä¸ä¼šç«‹åˆ»å‘ç”Ÿï¼Œä»–ä»¬å¯ä»¥ç”¨åˆ°React 16.4ã€‚åœ¨React 17é‡Œå°†è¢«å½»åº•ç§»é™¤ã€‚å¦‚æœä½ å¼€å¯äº†StrictModeæˆ–è€…AsyncModeï¼Œå¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹å¼æ¥ä½¿ç”¨ï¼Œä½†æ˜¯ä¼šæ”¶åˆ°è­¦å‘Š</p><p>UNSAFE_componentWillMount</p><p>UNSAFE_componentWillReceiveProps</p><p>UNSAFE_componentWillUpdate</p><h2 id="static-getDerivedStateFromProps"><a href="#static-getDerivedStateFromProps" class="headerlink" title="static getDerivedStateFromProps"></a>static getDerivedStateFromProps</h2><p>å½“componentWillReceivePropsæˆ‘ä»¬éœ€è¦å…¶ä»–çš„æ–¹å¼æ ¹æ®propsçš„å˜åŠ¨æ›´æ–°stateã€‚ç¤¾åŒºå†³å®šå¼•å…¥ä¸€ä¸ªæ–°çš„staticæ–¹æ³•æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä»€ä¹ˆæ˜¯é™æ€æ–¹æ³•ï¼Ÿä¸€ä¸ªé™æ€æ–¹æ³•å°±æ˜¯å­˜åœ¨äºç±»å†…ï¼Œè€Œä¸æ˜¯ç±»çš„å®ä¾‹å†…çš„æ–¹æ³•ã€‚é™æ€æ–¹æ³•è®¿é—®ä¸åˆ°thisï¼Œå¹¶ä¸”åœ¨å£°æ˜çš„æ—¶å€™æœ‰staticå…³é”®å­—åœ¨å‰é¢ä¿®é¥°ã€‚</p><p>ä½†æ˜¯ï¼Œé—®é¢˜æ¥äº†ã€‚æ—¢ç„¶è¿™ä¸ªæ–¹æ³•æ²¡æœ‰åŠæ³•è®¿é—®thisï¼Œé‚£ä¹ˆå¦‚ä½•è°ƒç”¨this.setStateå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ï¼Œä¸è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•ç›´æ¥è¿”å›éœ€è¦æ›´æ–°çš„stateçš„æ•°æ®ï¼Œæˆ–è€…è¿”å›nullï¼Œå¦‚æœæ²¡æœ‰ä»€ä¹ˆéœ€è¦æ›´æ–°çš„è¯ã€‚</p><pre><code class="javascript">static getDerivedStateFromProps(nextProps, prevState) {  if(nextProps.currentRow === prevState.lastRow) {    return null;  }  return {    lastRow: nextProps.currentRow,    isCrollingDown: nextProps.curentRow &gt; prevState.lastRow  }}</code></pre><p>è°ƒç”¨è¿™ä¸ªæ–¹æ³•å’Œä¹‹å‰è°ƒç”¨this.setStateçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚åªä¼šä¿®æ”¹è¿™äº›è¿”å›çš„å€¼ï¼Œå¦‚æœæ˜¯nullçš„è¯åˆ™ä¸ä¿®æ”¹stateã€‚stateçš„å…¶ä»–å€¼éƒ½ä¼šä¿ç•™ã€‚</p><p>å€¼å¾—æ³¨æ„æ˜¯<br>ä½ éœ€è¦å®šä¹‰åˆå§‹stateçš„å€¼ã€‚æ— è®ºæ˜¯åœ¨constructoré‡Œï¼Œæˆ–è€…æ˜¯ç±»å±æ€§ã€‚å¦åˆ™ä¼šæŠ¥è­¦å‘Šã€‚<br>è¿™ä¸ªæ–¹æ³•getDerivedStateFromProps()ä¼šåœ¨ç¬¬ä¸€æ¬¡æŒ‚è½½å’Œé‡ç»˜çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨åˆ°ï¼Œå› æ­¤ä½ åŸºæœ¬ä¸ç”¨åœ¨constructoré‡Œæ ¹æ®ä¼ å…¥çš„propsæ¥setStateã€‚</p><p>å¦‚æœå®šä¹‰äº†getDerivedStateFromPropsåï¼Œåˆå®šä¹‰äº†componentWillReceivePropsã€‚é‚£ä¹ˆï¼Œåªæœ‰å‰è€…ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä¸”ä½ ä¼šæ”¶åˆ°ä¸€ä¸ªè­¦å‘Šã€‚</p><p>ä¸€èˆ¬ä½ ä¼šä½¿ç”¨ä¸€ä¸ªå›è°ƒæ¥ä¿è¯æŸäº›ä»£ç å®åœ¨stateæ›´æ–°ä¹‹åæ‰è¢«è°ƒç”¨çš„ã€‚é‚£ä¹ˆï¼Œè¯·æŠŠè¿™äº›ä»£ç éƒ½ç§»åˆ°componentDidUpdateé‡Œã€‚<br>å¦‚æœä½ ä¸å–œæ¬¢ä½¿ç”¨staticå…³é”®å­—ï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿™æ ·ï¼š</p><pre><code class="javascript">ComponentName.getDerivedStateFromProps = (nextProps, prevState) =&gt; {  // Your code here}</code></pre><h2 id="static-mode"><a href="#static-mode" class="headerlink" title="static mode"></a>static mode</h2><p>ä¸¥æ ¼æ¨¡å¼æ˜¯ä¸€ä¸ªæ–°çš„æ–¹å¼æ¥ç¡®ä¿ä½ çš„ä»£ç æ˜¯æŒ‰ç…§æœ€ä½³å®è·µå¼€å‘çš„ã€‚å®ƒå®é™…æ˜¯ä¸€ä¸ªåœ¨React.StrictModeä¸‹çš„ç»„ä»¶ã€‚å®ƒå¯ä»¥ç”¨åœ¨ä½ çš„ç»„ä»¶æ ‘çš„ä»»ä½•ä¸€éƒ¨åˆ†ä¸Šã€‚</p><pre><code class="javascript">import {StrictMode} from &#39;react&#39;class Application extends React.Component {  render() {    return (      &lt;StrictMode&gt;        &lt;Context.Provider value={{background: 'black', color: 'white'}}&gt;          &lt;Header /&gt;          &lt;Main /&gt;          &lt;Footer /&gt;        &lt;/Context.Provider&gt;      &lt;/StrictMode&gt;    );  }}</code></pre><p>å¦‚æœä¸€ä¸ªåœ¨StricModeå­æ ‘é‡Œçš„ç»„ä»¶ä½¿ç”¨äº†componentWillMountæ–¹æ³•ï¼Œé‚£ä¹ˆä½ ä¼šçœ‹åˆ°ä¸€ä¸ªæŠ¥é”™æ¶ˆæ¯ã€‚</p><h2 id="asyncMode"><a href="#asyncMode" class="headerlink" title="asyncMode"></a>asyncMode</h2><p>å¼‚æ­¥æ¨¡å¼åœ¨React.unsafe_AsyncModeä¸‹ã€‚ä½¿ç”¨AsncModeä¹Ÿä¼šæ‰“å¼€StrictModeæ¨¡å¼ä¸‹çš„è­¦å‘Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®€è¿°HTTPåè®®</title>
      <link href="/2018/04/02/HTTP/%E7%AE%80%E8%BF%B0HTTP%E5%8D%8F%E8%AE%AE/"/>
      <url>/2018/04/02/HTTP/%E7%AE%80%E8%BF%B0HTTP%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯HTTPåè®®"><a href="#ä»€ä¹ˆæ˜¯HTTPåè®®" class="headerlink" title="ä»€ä¹ˆæ˜¯HTTPåè®®"></a>ä»€ä¹ˆæ˜¯HTTPåè®®</h1><p>åè®®æ˜¯æŒ‡è®¡ç®—æœºé€šä¿¡ç½‘ç»œä¸­ä¸¤å°è®¡ç®—æœºä¹‹é—´è¿›è¡Œé€šä¿¡æ‰€å¿…é¡»å…±åŒéµå®ˆçš„è§„å®šæˆ–è§„åˆ™ï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®(HTTP)æ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œå®ƒå…è®¸å°†è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€(HTML)æ–‡æ¡£ä»WebæœåŠ¡å™¨ä¼ é€åˆ°å®¢æˆ·ç«¯çš„æµè§ˆå™¨</p><p>1.è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼ŒHyperText Transfer Protocol)æ˜¯äº’è”ç½‘ä¸Šåº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ç½‘ç»œåè®®ä¹‹ä¸€ï¼Œæ‰€æœ‰çš„WWWæ–‡ä»¶å¿…é¡»éµå¾ªè¿™ä¸ªæ ‡å‡†ã€‚</p><p>2.HTTPæ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯çš„è¯·æ±‚å’Œåº”ç­”çš„æ ‡å‡†ï¼ˆTCPï¼‰ã€‚å®¢æˆ·ç«¯æ˜¯ç»ˆç«¯ç”¨æˆ·ï¼ŒæœåŠ¡å™¨ç«¯æ˜¯ç½‘ç«™ã€‚é€šè¿‡ä½¿ç”¨Webæµè§ˆå™¨ã€ç½‘ç»œçˆ¬è™«æˆ–è€…å…¶å®ƒçš„å·¥å…·ï¼Œå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªåˆ°æœåŠ¡å™¨ä¸ŠæŒ‡å®šç«¯å£ï¼ˆé»˜è®¤ç«¯å£ä¸º80ï¼‰çš„HTTPè¯·æ±‚ã€‚ï¼ˆæˆ‘ä»¬ç§°è¿™ä¸ªå®¢æˆ·ç«¯ï¼‰å«ç”¨æˆ·ä»£ç†ï¼ˆuser agentï¼‰ã€‚åº”ç­”çš„æœåŠ¡å™¨ä¸Šå­˜å‚¨ç€ï¼ˆä¸€äº›ï¼‰èµ„æºï¼Œæ¯”å¦‚HTMLæ–‡ä»¶å’Œå›¾åƒã€‚</p><p>3.ç”±HTTPå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œå»ºç«‹ä¸€ä¸ªåˆ°æœåŠ¡å™¨æŒ‡å®šç«¯å£ï¼ˆé»˜è®¤æ˜¯80ç«¯å£ï¼‰çš„TCPè¿æ¥ã€‚HTTPæœåŠ¡å™¨åˆ™åœ¨é‚£ä¸ªç«¯å£ç›‘å¬å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ã€‚ä¸€æ—¦æ”¶åˆ°è¯·æ±‚ï¼ŒæœåŠ¡å™¨ï¼ˆå‘å®¢æˆ·ç«¯ï¼‰å‘å›ä¸€ä¸ªçŠ¶æ€è¡Œï¼Œæ¯”å¦‚â€HTTP/1.1 200 OKâ€ï¼Œå’Œï¼ˆå“åº”çš„ï¼‰æ¶ˆæ¯ï¼Œæ¶ˆæ¯çš„æ¶ˆæ¯ä½“å¯èƒ½æ˜¯è¯·æ±‚çš„æ–‡ä»¶ã€é”™è¯¯æ¶ˆæ¯ã€æˆ–è€…å…¶å®ƒä¸€äº›ä¿¡æ¯ã€‚</p><p>4.HTTPä½¿ç”¨TCPè€Œä¸æ˜¯UDPçš„åŸå› åœ¨äºï¼ˆæ‰“å¼€ï¼‰ä¸€ä¸ªç½‘é¡µå¿…é¡»ä¼ é€å¾ˆå¤šæ•°æ®ï¼Œè€ŒTCPåè®®æä¾›ä¼ è¾“æ§åˆ¶ï¼ŒæŒ‰é¡ºåºç»„ç»‡æ•°æ®ï¼Œå’Œé”™è¯¯çº æ­£ã€‚</p><p>5.ä¸€æ¬¡HTTPæ“ä½œç§°ä¸ºä¸€ä¸ªäº‹åŠ¡ï¼Œå…¶å·¥ä½œè¿‡ç¨‹å¯åˆ†ä¸ºå››æ­¥ï¼š</p><pre><code>1),é¦–å…ˆå®¢æˆ·æœºä¸æœåŠ¡å™¨éœ€è¦å»ºç«‹è¿æ¥ã€‚åªè¦å•å‡»æŸä¸ªè¶…çº§é“¾æ¥ï¼ŒHTTPçš„å·¥ä½œå°±å¼€å§‹äº†ã€‚2),å»ºç«‹è¿æ¥åï¼Œå®¢æˆ·æœºå‘é€ä¸€ä¸ªè¯·æ±‚ç»™æœåŠ¡å™¨ï¼Œè¯·æ±‚æ–¹å¼çš„æ ¼å¼ä¸ºï¼šç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆURLï¼‰ã€åè®®ç‰ˆæœ¬å·ï¼Œåè¾¹æ˜¯MIMEä¿¡æ¯åŒ…æ‹¬è¯·æ±‚ä¿®é¥°ç¬¦ã€å®¢æˆ·æœºä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚3),æœåŠ¡å™¨æ¥åˆ°è¯·æ±‚åï¼Œç»™äºˆç›¸åº”çš„å“åº”ä¿¡æ¯ï¼Œå…¶æ ¼å¼ä¸ºä¸€ä¸ªçŠ¶æ€è¡Œï¼ŒåŒ…æ‹¬ä¿¡æ¯çš„åè®®ç‰ˆæœ¬å·ã€ä¸€ä¸ªæˆåŠŸæˆ–é”™è¯¯çš„ä»£ç ï¼Œåè¾¹æ˜¯MIMEä¿¡æ¯åŒ…æ‹¬æœåŠ¡å™¨ä¿¡æ¯ã€å®ä½“ä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚4),å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡å™¨æ‰€è¿”å›çš„ä¿¡æ¯é€šè¿‡æµè§ˆå™¨æ˜¾ç¤ºåœ¨ç”¨æˆ·çš„æ˜¾ç¤ºå±ä¸Šï¼Œç„¶åå®¢æˆ·æœºä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥ã€‚</code></pre><p>å¦‚æœåœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­çš„æŸä¸€æ­¥å‡ºç°é”™è¯¯ï¼Œé‚£ä¹ˆäº§ç”Ÿé”™è¯¯çš„ä¿¡æ¯å°†è¿”å›åˆ°å®¢æˆ·ç«¯ï¼Œç”±æ˜¾ç¤ºå±è¾“å‡ºã€‚å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œè¿™äº›è¿‡ç¨‹æ˜¯ç”±HTTPè‡ªå·±å®Œæˆçš„ï¼Œç”¨æˆ·åªè¦ç”¨é¼ æ ‡ç‚¹å‡»ï¼Œç­‰å¾…ä¿¡æ¯æ˜¾ç¤ºå°±å¯ä»¥äº†ã€‚</p><a id="more"></a><ol start="6"><li>HTTPæŠ¥æ–‡ç”±ä»å®¢æˆ·æœºåˆ°æœåŠ¡å™¨çš„è¯·æ±‚å’Œä»æœåŠ¡å™¨åˆ°å®¢æˆ·æœºçš„å“åº”æ„æˆã€‚</li></ol><p>è¯·æ±‚æŠ¥æ–‡æ ¼å¼å¦‚ä¸‹ï¼š<br>    è¯·æ±‚è¡Œ ï¼ é€šç”¨ä¿¡æ¯å¤´ ï¼ è¯·æ±‚å¤´ ï¼ å®ä½“å¤´ ï¼ æŠ¥æ–‡ä¸»ä½“</p><pre><code>è¯·æ±‚è¡Œä»¥æ–¹æ³•å­—æ®µå¼€å§‹ï¼Œåé¢åˆ†åˆ«æ˜¯ URL å­—æ®µå’Œ HTTP åè®®ç‰ˆæœ¬å­—æ®µï¼Œå¹¶ä»¥ CRLF ç»“å°¾ã€‚SP æ˜¯åˆ†éš”ç¬¦ã€‚é™¤äº†åœ¨æœ€åçš„ CRLF åºåˆ—ä¸­ CF å’Œ LF æ˜¯å¿…éœ€çš„ä¹‹å¤–ï¼Œå…¶ä»–éƒ½å¯ä»¥ä¸è¦ã€‚æœ‰å…³é€šç”¨ä¿¡æ¯å¤´ï¼Œè¯·æ±‚å¤´å’Œå®ä½“å¤´æ–¹é¢çš„å…·ä½“å†…å®¹å¯ä»¥å‚ç…§ç›¸å…³æ–‡ä»¶ã€‚</code></pre><p>åº”ç­”æŠ¥æ–‡æ ¼å¼å¦‚ä¸‹ï¼š<br>    çŠ¶æ€è¡Œ ï¼ é€šç”¨ä¿¡æ¯å¤´ ï¼ å“åº”å¤´ ï¼ å®ä½“å¤´ ï¼ æŠ¥æ–‡ä¸»ä½“</p><pre><code>çŠ¶æ€ç å…ƒç”±3ä½æ•°å­—ç»„æˆï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦è¢«ç†è§£æˆ–è¢«æ»¡è¶³ã€‚åŸå› åˆ†ææ˜¯å¯¹åŸæ–‡çš„çŠ¶æ€ç ä½œç®€çŸ­çš„æè¿°ï¼ŒçŠ¶æ€ç ç”¨æ¥æ”¯æŒè‡ªåŠ¨æ“ä½œï¼Œè€ŒåŸå› åˆ†æç”¨æ¥ä¾›ç”¨æˆ·ä½¿ç”¨ã€‚å®¢æˆ·æœºæ— éœ€ç”¨æ¥æ£€æŸ¥æˆ–æ˜¾ç¤ºè¯­æ³•ã€‚æœ‰å…³é€šç”¨ä¿¡æ¯å¤´ï¼Œå“åº”å¤´å’Œå®ä½“å¤´æ–¹é¢çš„å…·ä½“å†…å®¹å¯ä»¥å‚ç…§ç›¸å…³æ–‡ä»¶ã€‚</code></pre><p>7.é€šç”¨å¤´åŸŸåŒ…å«è¯·æ±‚å’Œå“åº”æ¶ˆæ¯éƒ½æ”¯æŒçš„å¤´åŸŸï¼Œé€šç”¨å¤´åŸŸåŒ…å«<strong>Cache-Controlã€Connectionã€Dateã€Pragmaã€Transfer-Encodingã€Upgradeã€Via</strong>ã€‚å¯¹é€šç”¨å¤´åŸŸçš„æ‰©å±•è¦æ±‚é€šè®¯åŒæ–¹éƒ½æ”¯æŒæ­¤æ‰©å±•ï¼Œå¦‚æœå­˜åœ¨ä¸æ”¯æŒçš„é€šç”¨å¤´åŸŸï¼Œä¸€èˆ¬å°†ä¼šä½œä¸ºå®ä½“å¤´åŸŸå¤„ç†ã€‚</p><p><em>è¯·æ±‚æ¶ˆæ¯çš„ç¬¬ä¸€è¡Œä¸º</em>ï¼šMethodSPRequest-URISPHTTP-VersionCRLFMethodè¡¨ç¤ºå¯¹äºRequest-URIå®Œæˆçš„æ–¹æ³•ï¼Œè¿™ä¸ªå­—æ®µæ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼ŒåŒ…æ‹¬OPTIONSã€GETã€HEADã€POSTã€PUTã€DELETEã€TRACEã€‚æ–¹æ³•GETå’ŒHEADåº”è¯¥è¢«æ‰€æœ‰çš„é€šç”¨WEBæœåŠ¡å™¨æ”¯æŒï¼Œå…¶ä»–æ‰€æœ‰æ–¹æ³•çš„å®ç°æ˜¯å¯é€‰çš„ã€‚GETæ–¹æ³•å–å›ç”±Request-URIæ ‡è¯†çš„ä¿¡æ¯ã€‚HEADæ–¹æ³•ä¹Ÿæ˜¯å–å›ç”±Request-URIæ ‡è¯†çš„ä¿¡æ¯ï¼Œåªæ˜¯å¯ä»¥åœ¨å“åº”æ—¶ï¼Œä¸è¿”å›æ¶ˆæ¯ä½“ã€‚POSTæ–¹æ³•å¯ä»¥è¯·æ±‚æœåŠ¡å™¨æ¥æ”¶åŒ…å«åœ¨è¯·æ±‚ä¸­çš„å®ä½“ä¿¡æ¯ï¼Œå¯ä»¥ç”¨äºæäº¤è¡¨å•ï¼Œå‘æ–°é—»ç»„ã€BBSã€é‚®ä»¶ç¾¤ç»„å’Œæ•°æ®åº“å‘é€æ¶ˆæ¯ã€‚</p><p><em>å“åº”æ¶ˆæ¯çš„ç¬¬ä¸€è¡Œçš„æ ¼å¼ä¸º</em>ï¼šHTTP-VersionSPStatus-CodeSPReason-PhraseCRLFã€‚HTTP-Versionè¡¨ç¤ºæ”¯æŒçš„HTTPç‰ˆæœ¬ï¼Œä¾‹å¦‚ä¸ºHTTP/1.1ã€‚Status-Codeæ˜¯ä¸€ä¸ªä¸‰ä¸ªæ•°å­—çš„ç»“æœä»£ç ã€‚Reason-Phraseç»™Status-Codeæä¾›ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æè¿°ã€‚Status-Codeä¸»è¦ç”¨äºæœºå™¨è‡ªåŠ¨è¯†åˆ«ï¼ŒReason-Phraseä¸»è¦ç”¨äºå¸®åŠ©ç”¨æˆ·ç†è§£ã€‚Status-Codeçš„ç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰å“åº”çš„ç±»åˆ«ï¼Œåä¸¤ä¸ªæ•°å­—æ²¡æœ‰åˆ†ç±»çš„ä½œç”¨ã€‚</p><p>è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯éƒ½å¯ä»¥åŒ…å«å®ä½“ä¿¡æ¯ï¼Œå®ä½“ä¿¡æ¯ä¸€èˆ¬ç”±å®ä½“å¤´åŸŸå’Œå®ä½“ç»„æˆã€‚å®ä½“å¤´åŸŸåŒ…å«å…³äºå®ä½“çš„åŸä¿¡æ¯ï¼Œå®ä½“å¤´åŒ…æ‹¬Allowã€Content-Baseã€Content-Encodingã€Content-Languageã€Content-Lengthã€Content-Locationã€Content-MD5ã€Content-Rangeã€Content-Typeã€Etagã€Expiresã€Last-Modifiedã€extension-headerã€‚extension-headerå…è®¸å®¢æˆ·ç«¯å®šä¹‰æ–°çš„å®ä½“å¤´ï¼Œä½†æ˜¯è¿™äº›åŸŸå¯èƒ½æ— æ³•è¢«æ¥å—æ–¹è¯†åˆ«ã€‚å®ä½“å¯ä»¥æ˜¯ä¸€ä¸ªç»è¿‡ç¼–ç çš„å­—èŠ‚æµï¼Œå®ƒçš„ç¼–ç æ–¹å¼ç”±Content-Encodingæˆ–Content-Typeå®šä¹‰ï¼Œå®ƒçš„é•¿åº¦ç”±Content-Lengthæˆ–Content-Rangeå®šä¹‰ã€‚</p><p><a href="https://blog.csdn.net/Prince_fmx/article/details/78202527" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Http åè®®è¯¦è§£</title>
      <link href="/2018/04/02/HTTP/Http-%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3/"/>
      <url>/2018/04/02/HTTP/Http-%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>HTTPæ˜¯ä¸€ä¸ªå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œç”±äºå…¶ç®€æ·ã€å¿«é€Ÿçš„æ–¹å¼ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚å®ƒäº1990å¹´æå‡ºï¼Œç»è¿‡å‡ å¹´çš„ä½¿ç”¨ä¸å‘å±•ï¼Œå¾—åˆ°ä¸æ–­åœ°å®Œå–„å’Œæ‰©å±•ã€‚ç›®å‰åœ¨WWWä¸­ä½¿ç”¨çš„æ˜¯HTTP/1.0çš„ç¬¬å…­ç‰ˆï¼ŒHTTP/1.1çš„è§„èŒƒåŒ–å·¥ä½œæ­£åœ¨è¿›è¡Œä¹‹ä¸­ï¼Œè€Œä¸”HTTP-NG(Next Generation of HTTP)çš„å»ºè®®å·²ç»æå‡ºã€‚</p><blockquote><p>HTTPåè®®çš„ä¸»è¦ç‰¹ç‚¹å¯æ¦‚æ‹¬å¦‚ä¸‹ï¼š<br>1.æ”¯æŒå®¢æˆ·/æœåŠ¡å™¨æ¨¡å¼ã€‚<br>2.ç®€å•å¿«é€Ÿï¼šå®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰<strong>GETã€HEADã€POST</strong>ã€‚æ¯ç§æ–¹æ³•è§„å®šäº†å®¢æˆ·ä¸æœåŠ¡å™¨è”ç³»çš„ç±»å‹ä¸åŒã€‚ç”±äºHTTPåè®®ç®€å•ï¼Œä½¿å¾—HTTPæœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œé€šä¿¡é€Ÿåº¦å¾ˆå¿«ã€‚<br>3.çµæ´»ï¼šHTTPå…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ã€‚æ­£åœ¨ä¼ è¾“çš„ç±»å‹ç”±Content-TypeåŠ ä»¥æ ‡è®°<br>4.æ— è¿æ¥ï¼šæ— è¿æ¥çš„å«ä¹‰æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚<br>5.æ— çŠ¶æ€ï¼šHTTPåè®®æ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±è¾ƒå¿«ã€‚</p></blockquote><h2 id="HTTPåè®®è¯¦è§£ä¹‹URLç¯‡"><a href="#HTTPåè®®è¯¦è§£ä¹‹URLç¯‡" class="headerlink" title="HTTPåè®®è¯¦è§£ä¹‹URLç¯‡"></a>HTTPåè®®è¯¦è§£ä¹‹URLç¯‡</h2><p><font color = "blue">http(è¶…æ–‡æœ¬ä¼ è¾“åè®®)</font> æ˜¯ä¸€ä¸ªåŸºäºè¯·æ±‚ä¸å“åº”æ¨¡å¼çš„ã€æ— çŠ¶æ€çš„ã€åº”ç”¨å±‚çš„åè®®ï¼Œå¸¸åŸºäºTCPçš„è¿æ¥æ–¹å¼ï¼ŒHTTP1.1ç‰ˆæœ¬ä¸­ç»™å‡ºä¸€ç§æŒç»­è¿æ¥çš„æœºåˆ¶ï¼Œç»å¤§å¤šæ•°çš„Webå¼€å‘ï¼Œéƒ½æ˜¯æ„å»ºåœ¨HTTPåè®®ä¹‹ä¸Šçš„Webåº”ç”¨ã€‚</p><p>HTTP URL (URLæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„URIï¼ŒåŒ…å«äº†ç”¨äºæŸ¥æ‰¾æŸä¸ªèµ„æºçš„è¶³å¤Ÿçš„ä¿¡æ¯)çš„æ ¼å¼å¦‚ä¸‹ï¼š<br><a href="http://host[&quot;:&quot;port][abs_path]">http://host[&quot;:&quot;port][abs_path]</a></p><p>httpè¡¨ç¤ºè¦é€šè¿‡HTTPåè®®æ¥å®šä½ç½‘ç»œèµ„æºï¼›<br><em>host</em>è¡¨ç¤ºåˆæ³•çš„Internetä¸»æœºåŸŸåæˆ–è€…IPåœ°å€ï¼›<br><em>port</em>æŒ‡å®šä¸€ä¸ªç«¯å£å·ï¼Œä¸ºç©ºåˆ™ä½¿ç”¨ç¼ºçœç«¯å£80ï¼›<br><em>abs_path</em>æŒ‡å®šè¯·æ±‚èµ„æºçš„URIï¼›å¦‚æœURLä¸­æ²¡æœ‰ç»™å‡ºabs_pathï¼Œé‚£ä¹ˆå½“å®ƒä½œä¸ºè¯·æ±‚URIæ—¶ï¼Œå¿…é¡»ä»¥â€œ/â€çš„å½¢å¼ç»™å‡ºï¼Œé€šå¸¸è¿™ä¸ªå·¥ä½œæµè§ˆå™¨è‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆã€‚</p><a id="more"></a><p>eg:<br>1ã€è¾“å…¥ï¼š<a href="http://www.guet.edu.cn" target="_blank" rel="noopener">www.guet.edu.cn</a><br>æµè§ˆå™¨è‡ªåŠ¨è½¬æ¢æˆï¼š<a href="http://www.guet.edu.cn/" target="_blank" rel="noopener">http://www.guet.edu.cn/</a><br>2ã€http:192.168.0.116:8080/index.jsp </p><h2 id="HTTPåè®®è¯¦è§£ä¹‹è¯·æ±‚ç¯‡"><a href="#HTTPåè®®è¯¦è§£ä¹‹è¯·æ±‚ç¯‡" class="headerlink" title="HTTPåè®®è¯¦è§£ä¹‹è¯·æ±‚ç¯‡"></a>HTTPåè®®è¯¦è§£ä¹‹è¯·æ±‚ç¯‡</h2><p>httpè¯·æ±‚ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šè¯·æ±‚è¡Œã€æ¶ˆæ¯æŠ¥å¤´ã€è¯·æ±‚æ­£æ–‡</p><h3 id="1ã€è¯·æ±‚è¡Œä»¥ä¸€ä¸ªæ–¹æ³•ç¬¦å·å¼€å¤´ï¼Œä»¥ç©ºæ ¼åˆ†å¼€ï¼Œåé¢è·Ÿç€è¯·æ±‚çš„URIå’Œåè®®çš„ç‰ˆæœ¬ï¼Œæ ¼å¼å¦‚ä¸‹ï¼šMethod-Request-URI-HTTP-Version-CRLF"><a href="#1ã€è¯·æ±‚è¡Œä»¥ä¸€ä¸ªæ–¹æ³•ç¬¦å·å¼€å¤´ï¼Œä»¥ç©ºæ ¼åˆ†å¼€ï¼Œåé¢è·Ÿç€è¯·æ±‚çš„URIå’Œåè®®çš„ç‰ˆæœ¬ï¼Œæ ¼å¼å¦‚ä¸‹ï¼šMethod-Request-URI-HTTP-Version-CRLF" class="headerlink" title="1ã€è¯·æ±‚è¡Œä»¥ä¸€ä¸ªæ–¹æ³•ç¬¦å·å¼€å¤´ï¼Œä»¥ç©ºæ ¼åˆ†å¼€ï¼Œåé¢è·Ÿç€è¯·æ±‚çš„URIå’Œåè®®çš„ç‰ˆæœ¬ï¼Œæ ¼å¼å¦‚ä¸‹ï¼šMethod Request-URI HTTP-Version CRLF"></a>1ã€è¯·æ±‚è¡Œä»¥ä¸€ä¸ªæ–¹æ³•ç¬¦å·å¼€å¤´ï¼Œä»¥ç©ºæ ¼åˆ†å¼€ï¼Œåé¢è·Ÿç€è¯·æ±‚çš„URIå’Œåè®®çš„ç‰ˆæœ¬ï¼Œæ ¼å¼å¦‚ä¸‹ï¼šMethod Request-URI HTTP-Version CRLF</h3><p>å…¶ä¸­ Methodè¡¨ç¤ºè¯·æ±‚æ–¹æ³•ï¼›Request-URIæ˜¯ä¸€ä¸ªç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼›HTTP-Versionè¡¨ç¤ºè¯·æ±‚çš„HTTPåè®®ç‰ˆæœ¬ï¼›CRLFè¡¨ç¤ºå›è½¦å’Œæ¢è¡Œï¼ˆé™¤äº†ä½œä¸ºç»“å°¾çš„CRLFå¤–ï¼Œä¸å…è®¸å‡ºç°å•ç‹¬çš„CRæˆ–LFå­—ç¬¦ï¼‰ã€‚</p><blockquote><p>è¯·æ±‚æ–¹æ³•ï¼ˆæ‰€æœ‰æ–¹æ³•å…¨ä¸ºå¤§å†™ï¼‰æœ‰å¤šç§ï¼Œå„ä¸ªæ–¹æ³•çš„è§£é‡Šå¦‚ä¸‹ï¼š<br>GET     è¯·æ±‚è·å–Request-URIæ‰€æ ‡è¯†çš„èµ„æº<br>POST    åœ¨Request-URIæ‰€æ ‡è¯†çš„èµ„æºåé™„åŠ æ–°çš„æ•°æ®<br>HEAD    è¯·æ±‚è·å–ç”±Request-URIæ‰€æ ‡è¯†çš„èµ„æºçš„å“åº”æ¶ˆæ¯æŠ¥å¤´<br>PUT     è¯·æ±‚æœåŠ¡å™¨å­˜å‚¨ä¸€ä¸ªèµ„æºï¼Œå¹¶ç”¨Request-URIä½œä¸ºå…¶æ ‡è¯†<br>DELETE  è¯·æ±‚æœåŠ¡å™¨åˆ é™¤Request-URIæ‰€æ ‡è¯†çš„èµ„æº<br>TRACE   è¯·æ±‚æœåŠ¡å™¨å›é€æ”¶åˆ°çš„è¯·æ±‚ä¿¡æ¯ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­<br>CONNECT ä¿ç•™å°†æ¥ä½¿ç”¨<br>OPTIONS è¯·æ±‚æŸ¥è¯¢æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œæˆ–è€…æŸ¥è¯¢ä¸èµ„æºç›¸å…³çš„é€‰é¡¹å’Œéœ€æ±‚</p></blockquote><blockquote><p>åº”ç”¨ç¤ºä¾‹<br>GETæ–¹æ³•ï¼šåœ¨æµè§ˆå™¨çš„åœ°å€æ ä¸­è¾“å…¥ç½‘å€çš„æ–¹å¼è®¿é—®ç½‘é¡µæ—¶ï¼Œæµè§ˆå™¨é‡‡ç”¨GETæ–¹æ³•å‘æœåŠ¡å™¨è·å–èµ„æºï¼Œeg:GET /form.html HTTP/1.1 (CRLF)</p></blockquote><p>POSTæ–¹æ³•è¦æ±‚è¢«è¯·æ±‚æœåŠ¡å™¨æ¥å—é™„åœ¨è¯·æ±‚åé¢çš„æ•°æ®ï¼Œå¸¸ç”¨äºæäº¤è¡¨å•ã€‚<br>egï¼šPOST /reg.jsp HTTP/ (CRLF)<br>Accept:image/gif,image/x-xbit,â€¦ (CRLF)<br>â€¦<br>HOST:<a href="http://www.guet.edu.cn" target="_blank" rel="noopener">www.guet.edu.cn</a> (CRLF)<br>Content-Length:22 (CRLF)<br>Connection:Keep-Alive (CRLF)<br>Cache-Control:no-cache (CRLF)<br>(CRLF)         //è¯¥CRLFè¡¨ç¤ºæ¶ˆæ¯æŠ¥å¤´å·²ç»ç»“æŸï¼Œåœ¨æ­¤ä¹‹å‰ä¸ºæ¶ˆæ¯æŠ¥å¤´<br>user=jeffrey&amp;pwd=1234  //æ­¤è¡Œä»¥ä¸‹ä¸ºæäº¤çš„æ•°æ®</p><p>HEADæ–¹æ³•ä¸GETæ–¹æ³•å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œå¯¹äºHEADè¯·æ±‚çš„å›åº”éƒ¨åˆ†æ¥è¯´ï¼Œå®ƒçš„HTTPå¤´éƒ¨ä¸­åŒ…å«çš„ä¿¡æ¯ä¸é€šè¿‡GETè¯·æ±‚æ‰€å¾—åˆ°çš„ä¿¡æ¯æ˜¯ç›¸åŒçš„ã€‚åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¸å¿…ä¼ è¾“æ•´ä¸ªèµ„æºå†…å®¹ï¼Œå°±å¯ä»¥å¾—åˆ°Request-URIæ‰€æ ‡è¯†çš„èµ„æºçš„ä¿¡æ¯ã€‚è¯¥æ–¹æ³•å¸¸ç”¨äºæµ‹è¯•è¶…é“¾æ¥çš„æœ‰æ•ˆæ€§ï¼Œæ˜¯å¦å¯ä»¥è®¿é—®ï¼Œä»¥åŠæœ€è¿‘æ˜¯å¦æ›´æ–°ã€‚</p><h3 id="2ã€è¯·æ±‚æŠ¥å¤´åè¿°"><a href="#2ã€è¯·æ±‚æŠ¥å¤´åè¿°" class="headerlink" title="2ã€è¯·æ±‚æŠ¥å¤´åè¿°"></a>2ã€è¯·æ±‚æŠ¥å¤´åè¿°</h3><h3 id="3ã€è¯·æ±‚æ­£æ–‡-ç•¥"><a href="#3ã€è¯·æ±‚æ­£æ–‡-ç•¥" class="headerlink" title="3ã€è¯·æ±‚æ­£æ–‡(ç•¥)"></a>3ã€è¯·æ±‚æ­£æ–‡(ç•¥)</h3><h2 id="HTTPåè®®è¯¦è§£ä¹‹å“åº”ç¯‡"><a href="#HTTPåè®®è¯¦è§£ä¹‹å“åº”ç¯‡" class="headerlink" title="HTTPåè®®è¯¦è§£ä¹‹å“åº”ç¯‡"></a>HTTPåè®®è¯¦è§£ä¹‹å“åº”ç¯‡</h2><p>åœ¨æ¥æ”¶å’Œè§£é‡Šè¯·æ±‚æ¶ˆæ¯åï¼ŒæœåŠ¡å™¨è¿”å›ä¸€ä¸ªHTTPå“åº”æ¶ˆæ¯ã€‚<br>HTTPå“åº”ä¹Ÿæ˜¯ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šçŠ¶æ€è¡Œã€æ¶ˆæ¯æŠ¥å¤´ã€å“åº”æ­£æ–‡</p><h3 id="1-çŠ¶æ€è¡Œæ ¼å¼å¦‚ä¸‹ï¼š"><a href="#1-çŠ¶æ€è¡Œæ ¼å¼å¦‚ä¸‹ï¼š" class="headerlink" title="1.çŠ¶æ€è¡Œæ ¼å¼å¦‚ä¸‹ï¼š"></a>1.çŠ¶æ€è¡Œæ ¼å¼å¦‚ä¸‹ï¼š</h3><p>HTTP-Version Status-Code Reason-Phrase CRLF<br>å…¶ä¸­ï¼ŒHTTP-Versionè¡¨ç¤ºæœåŠ¡å™¨HTTPåè®®çš„ç‰ˆæœ¬ï¼›Status-Codeè¡¨ç¤ºæœåŠ¡å™¨å‘å›çš„å“åº”çŠ¶æ€ä»£ç ï¼›Reason-Phraseè¡¨ç¤ºçŠ¶æ€ä»£ç çš„æ–‡æœ¬æè¿°ã€‚</p><blockquote><p>çŠ¶æ€ä»£ç æœ‰ä¸‰ä½æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰äº†å“åº”çš„ç±»åˆ«ï¼Œä¸”æœ‰äº”ç§å¯èƒ½å–å€¼ï¼š<br>1xxï¼šæŒ‡ç¤ºä¿¡æ¯â€“è¡¨ç¤ºè¯·æ±‚å·²æ¥æ”¶ï¼Œç»§ç»­å¤„ç†<br>2xxï¼šæˆåŠŸâ€“è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ã€ç†è§£ã€æ¥å—<br>3xxï¼šé‡å®šå‘â€“è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ“ä½œ<br>4xxï¼šå®¢æˆ·ç«¯é”™è¯¯â€“è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®ç°<br>5xxï¼šæœåŠ¡å™¨ç«¯é”™è¯¯â€“æœåŠ¡å™¨æœªèƒ½å®ç°åˆæ³•çš„è¯·æ±‚</p></blockquote><blockquote><p><strong>å¸¸è§çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°</strong>ã€è¯´æ˜ï¼š<br>200 OK      //å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ<br>400 Bad Request  //å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£<br>401 Unauthorized //è¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’ŒWWW-AuthenticateæŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨<br>403 Forbidden  //æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡<br>404 Not Found  //è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œegï¼šè¾“å…¥äº†é”™è¯¯çš„URL<br>500 Internal Server Error //æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯<br>503 Server Unavailable  //æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸<br>egï¼šHTTP/1.1 200 OK ï¼ˆCRLFï¼‰</p></blockquote><h3 id="2-å“åº”æŠ¥å¤´åè¿°"><a href="#2-å“åº”æŠ¥å¤´åè¿°" class="headerlink" title="2.å“åº”æŠ¥å¤´åè¿°"></a>2.å“åº”æŠ¥å¤´åè¿°</h3><h3 id="3-å“åº”æ­£æ–‡å°±æ˜¯æœåŠ¡å™¨è¿”å›çš„èµ„æºçš„å†…å®¹"><a href="#3-å“åº”æ­£æ–‡å°±æ˜¯æœåŠ¡å™¨è¿”å›çš„èµ„æºçš„å†…å®¹" class="headerlink" title="3.å“åº”æ­£æ–‡å°±æ˜¯æœåŠ¡å™¨è¿”å›çš„èµ„æºçš„å†…å®¹"></a>3.å“åº”æ­£æ–‡å°±æ˜¯æœåŠ¡å™¨è¿”å›çš„èµ„æºçš„å†…å®¹</h3><h2 id="HTTPåè®®è¯¦è§£ä¹‹æ¶ˆæ¯æŠ¥å¤´ç¯‡"><a href="#HTTPåè®®è¯¦è§£ä¹‹æ¶ˆæ¯æŠ¥å¤´ç¯‡" class="headerlink" title="HTTPåè®®è¯¦è§£ä¹‹æ¶ˆæ¯æŠ¥å¤´ç¯‡"></a>HTTPåè®®è¯¦è§£ä¹‹æ¶ˆæ¯æŠ¥å¤´ç¯‡</h2><p> HTTPæ¶ˆæ¯ç”±å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„è¯·æ±‚å’ŒæœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯çš„å“åº”ç»„æˆã€‚è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯éƒ½æ˜¯ç”±å¼€å§‹è¡Œï¼ˆå¯¹äºè¯·æ±‚æ¶ˆæ¯ï¼Œå¼€å§‹è¡Œå°±æ˜¯è¯·æ±‚è¡Œï¼Œå¯¹äºå“åº”æ¶ˆæ¯ï¼Œå¼€å§‹è¡Œå°±æ˜¯çŠ¶æ€è¡Œï¼‰ï¼Œæ¶ˆæ¯æŠ¥å¤´ï¼ˆå¯é€‰ï¼‰ï¼Œç©ºè¡Œï¼ˆåªæœ‰CRLFçš„è¡Œï¼‰ï¼Œæ¶ˆæ¯æ­£æ–‡ï¼ˆå¯é€‰ï¼‰ç»„æˆã€‚</p><p>HTTPæ¶ˆæ¯æŠ¥å¤´åŒ…æ‹¬æ™®é€šæŠ¥å¤´ã€è¯·æ±‚æŠ¥å¤´ã€å“åº”æŠ¥å¤´ã€å®ä½“æŠ¥å¤´ã€‚<br>æ¯ä¸€ä¸ªæŠ¥å¤´åŸŸéƒ½æ˜¯ç”±åå­—+â€œï¼šâ€+ç©ºæ ¼+å€¼ ç»„æˆï¼Œæ¶ˆæ¯æŠ¥å¤´åŸŸçš„åå­—æ˜¯å¤§å°å†™æ— å…³çš„ã€‚</p><h3 id="æ™®é€šæŠ¥å¤´"><a href="#æ™®é€šæŠ¥å¤´" class="headerlink" title="æ™®é€šæŠ¥å¤´"></a>æ™®é€šæŠ¥å¤´</h3><p>åœ¨æ™®é€šæŠ¥å¤´ä¸­ï¼Œæœ‰å°‘æ•°æŠ¥å¤´åŸŸç”¨äºæ‰€æœ‰çš„è¯·æ±‚å’Œå“åº”æ¶ˆæ¯ï¼Œä½†å¹¶ä¸ç”¨äºè¢«ä¼ è¾“çš„å®ä½“ï¼Œåªç”¨äºä¼ è¾“çš„æ¶ˆæ¯ã€‚</p><p>egï¼š<br>Cache-Control   ç”¨äºæŒ‡å®šç¼“å­˜æŒ‡ä»¤ï¼Œç¼“å­˜æŒ‡ä»¤æ˜¯å•å‘çš„ï¼ˆå“åº”ä¸­å‡ºç°çš„ç¼“å­˜æŒ‡ä»¤åœ¨è¯·æ±‚ä¸­æœªå¿…ä¼šå‡ºç°ï¼‰ï¼Œä¸”æ˜¯ç‹¬ç«‹çš„ï¼ˆä¸€ä¸ªæ¶ˆæ¯çš„ç¼“å­˜æŒ‡ä»¤ä¸ä¼šå½±å“å¦ä¸€ä¸ªæ¶ˆæ¯å¤„ç†çš„ç¼“å­˜æœºåˆ¶ï¼‰ï¼ŒHTTP1.0ä½¿ç”¨çš„ç±»ä¼¼çš„æŠ¥å¤´åŸŸä¸ºPragmaã€‚<br>è¯·æ±‚æ—¶çš„ç¼“å­˜æŒ‡ä»¤åŒ…æ‹¬ï¼šno-cacheï¼ˆç”¨äºæŒ‡ç¤ºè¯·æ±‚æˆ–å“åº”æ¶ˆæ¯ä¸èƒ½ç¼“å­˜ï¼‰ã€no-storeã€max-ageã€max-staleã€min-freshã€only-if-cached;</p><p>å“åº”æ—¶çš„ç¼“å­˜æŒ‡ä»¤åŒ…æ‹¬ï¼š<strong>publicã€privateã€no-cacheã€no-storeã€no-transformã€must-revalidateã€proxy-revalidateã€max-ageã€s-maxage</strong>.</p><p>egï¼šä¸ºäº†æŒ‡ç¤ºIEæµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸è¦ç¼“å­˜é¡µé¢ï¼ŒæœåŠ¡å™¨ç«¯çš„JSPç¨‹åºå¯ä»¥ç¼–å†™å¦‚ä¸‹ï¼šresponse.sehHeader(â€œCache-Controlâ€,â€no-cacheâ€);<br>//response.setHeader(â€œPragmaâ€,â€no-cacheâ€);ä½œç”¨ç›¸å½“äºä¸Šè¿°ä»£ç ï¼Œé€šå¸¸ä¸¤è€…//åˆç”¨<br>è¿™å¥ä»£ç å°†åœ¨å‘é€çš„å“åº”æ¶ˆæ¯ä¸­è®¾ç½®æ™®é€šæŠ¥å¤´åŸŸï¼šCache-Control:no-cache</p><p>Dateæ™®é€šæŠ¥å¤´åŸŸè¡¨ç¤ºæ¶ˆæ¯äº§ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´</p><p>Connectionæ™®é€šæŠ¥å¤´åŸŸå…è®¸å‘é€æŒ‡å®šè¿æ¥çš„é€‰é¡¹ã€‚ä¾‹å¦‚æŒ‡å®šè¿æ¥æ˜¯è¿ç»­ï¼Œæˆ–è€…æŒ‡å®šâ€œcloseâ€é€‰é¡¹ï¼Œé€šçŸ¥æœåŠ¡å™¨ï¼Œåœ¨å“åº”å®Œæˆåï¼Œå…³é—­è¿æ¥</p><h3 id="è¯·æ±‚æŠ¥å¤´"><a href="#è¯·æ±‚æŠ¥å¤´" class="headerlink" title="è¯·æ±‚æŠ¥å¤´"></a>è¯·æ±‚æŠ¥å¤´</h3><p>è¯·æ±‚æŠ¥å¤´å…è®¸å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯ä¼ é€’è¯·æ±‚çš„é™„åŠ ä¿¡æ¯ä»¥åŠå®¢æˆ·ç«¯è‡ªèº«çš„ä¿¡æ¯ã€‚</p><blockquote><p>å¸¸ç”¨çš„è¯·æ±‚æŠ¥å¤´<br>1.Accept<br>Acceptè¯·æ±‚æŠ¥å¤´åŸŸç”¨äºæŒ‡å®šå®¢æˆ·ç«¯æ¥å—å“ªäº›ç±»å‹çš„ä¿¡æ¯ã€‚egï¼šAcceptï¼šimage/gifï¼Œè¡¨æ˜å®¢æˆ·ç«¯å¸Œæœ›æ¥å—GIFå›¾è±¡æ ¼å¼çš„èµ„æºï¼›Acceptï¼štext/htmlï¼Œè¡¨æ˜å®¢æˆ·ç«¯å¸Œæœ›æ¥å—htmlæ–‡æœ¬ã€‚<br>2.Accept-Charset<br>Accept-Charsetè¯·æ±‚æŠ¥å¤´åŸŸç”¨äºæŒ‡å®šå®¢æˆ·ç«¯æ¥å—çš„å­—ç¬¦é›†ã€‚egï¼šAccept-Charset:iso-8859-1,gb2312.å¦‚æœåœ¨è¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªåŸŸï¼Œç¼ºçœæ˜¯ä»»ä½•å­—ç¬¦é›†éƒ½å¯ä»¥æ¥å—ã€‚<br>3.Accept-Encoding<br>Accept-Encodingè¯·æ±‚æŠ¥å¤´åŸŸç±»ä¼¼äºAcceptï¼Œä½†æ˜¯å®ƒæ˜¯ç”¨äºæŒ‡å®šå¯æ¥å—çš„å†…å®¹ç¼–ç ã€‚egï¼šAccept-Encoding:gzip.deflate.å¦‚æœè¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªåŸŸæœåŠ¡å™¨å‡å®šå®¢æˆ·ç«¯å¯¹å„ç§å†…å®¹ç¼–ç éƒ½å¯ä»¥æ¥å—ã€‚<br>4.Accept-Language<br>Accept-Languageè¯·æ±‚æŠ¥å¤´åŸŸç±»ä¼¼äºAcceptï¼Œä½†æ˜¯å®ƒæ˜¯ç”¨äºæŒ‡å®šä¸€ç§è‡ªç„¶è¯­è¨€ã€‚egï¼šAccept-Language:zh-cn.å¦‚æœè¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªæŠ¥å¤´åŸŸï¼ŒæœåŠ¡å™¨å‡å®šå®¢æˆ·ç«¯å¯¹å„ç§è¯­è¨€éƒ½å¯ä»¥æ¥å—ã€‚<br>5.Authorization<br>Authorizationè¯·æ±‚æŠ¥å¤´åŸŸä¸»è¦ç”¨äºè¯æ˜å®¢æˆ·ç«¯æœ‰æƒæŸ¥çœ‹æŸä¸ªèµ„æºã€‚å½“æµè§ˆå™¨è®¿é—®ä¸€ä¸ªé¡µé¢æ—¶ï¼Œå¦‚æœæ”¶åˆ°æœåŠ¡å™¨çš„å“åº”ä»£ç ä¸º401ï¼ˆæœªæˆæƒï¼‰ï¼Œå¯ä»¥å‘é€ä¸€ä¸ªåŒ…å«Authorizationè¯·æ±‚æŠ¥å¤´åŸŸçš„è¯·æ±‚ï¼Œè¦æ±‚æœåŠ¡å™¨å¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚<br>    Hostï¼ˆå‘é€è¯·æ±‚æ—¶ï¼Œè¯¥æŠ¥å¤´åŸŸæ˜¯å¿…éœ€çš„ï¼‰<br>    Hostè¯·æ±‚æŠ¥å¤´åŸŸä¸»è¦ç”¨äºæŒ‡å®šè¢«è¯·æ±‚èµ„æºçš„Internetä¸»æœºå’Œç«¯å£å·ï¼Œå®ƒé€šå¸¸ä»HTTP URLä¸­æå–å‡ºæ¥çš„ï¼Œegï¼š<br>    æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼š<a href="http://www.guet.edu.cn/index.html" target="_blank" rel="noopener">http://www.guet.edu.cn/index.html</a><br>    æµè§ˆå™¨å‘é€çš„è¯·æ±‚æ¶ˆæ¯ä¸­ï¼Œå°±ä¼šåŒ…å«Hostè¯·æ±‚æŠ¥å¤´åŸŸï¼Œå¦‚ä¸‹ï¼š<br>    Hostï¼š<a href="http://www.guet.edu.cn" target="_blank" rel="noopener">www.guet.edu.cn</a><br>    æ­¤å¤„ä½¿ç”¨ç¼ºçœç«¯å£å·80ï¼Œè‹¥æŒ‡å®šäº†ç«¯å£å·ï¼Œåˆ™å˜æˆï¼šHostï¼š<a href="http://www.guet.edu.cn:æŒ‡å®šç«¯å£å·">www.guet.edu.cn:æŒ‡å®šç«¯å£å·</a><br>6.User-Agent<br>æˆ‘ä»¬ä¸Šç½‘ç™»é™†è®ºå›çš„æ—¶å€™ï¼Œå¾€å¾€ä¼šçœ‹åˆ°ä¸€äº›æ¬¢è¿ä¿¡æ¯ï¼Œå…¶ä¸­åˆ—å‡ºäº†ä½ çš„æ“ä½œç³»ç»Ÿçš„åç§°å’Œç‰ˆæœ¬ï¼Œä½ æ‰€ä½¿ç”¨çš„æµè§ˆå™¨çš„åç§°å’Œç‰ˆæœ¬ï¼Œè¿™å¾€å¾€è®©å¾ˆå¤šäººæ„Ÿåˆ°å¾ˆç¥å¥‡ï¼Œå®é™…ä¸Šï¼ŒæœåŠ¡å™¨åº”ç”¨ç¨‹åºå°±æ˜¯ä»User-Agentè¿™ä¸ªè¯·æ±‚æŠ¥å¤´åŸŸä¸­è·å–åˆ°è¿™äº›ä¿¡æ¯ã€‚User-Agentè¯·æ±‚æŠ¥å¤´åŸŸå…è®¸å®¢æˆ·ç«¯å°†å®ƒçš„æ“ä½œç³»ç»Ÿã€æµè§ˆå™¨å’Œå…¶å®ƒå±æ€§å‘Šè¯‰æœåŠ¡å™¨ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªæŠ¥å¤´åŸŸä¸æ˜¯å¿…éœ€çš„ï¼Œå¦‚æœæˆ‘ä»¬è‡ªå·±ç¼–å†™ä¸€ä¸ªæµè§ˆå™¨ï¼Œä¸ä½¿ç”¨User-Agentè¯·æ±‚æŠ¥å¤´åŸŸï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç«¯å°±æ— æ³•å¾—çŸ¥æˆ‘ä»¬çš„ä¿¡æ¯äº†ã€‚</p></blockquote><h3 id="å“åº”æŠ¥å¤´"><a href="#å“åº”æŠ¥å¤´" class="headerlink" title="å“åº”æŠ¥å¤´"></a>å“åº”æŠ¥å¤´</h3><p>å“åº”æŠ¥å¤´å…è®¸æœåŠ¡å™¨ä¼ é€’ä¸èƒ½æ”¾åœ¨çŠ¶æ€è¡Œä¸­çš„é™„åŠ å“åº”ä¿¡æ¯ï¼Œä»¥åŠå…³äºæœåŠ¡å™¨çš„ä¿¡æ¯å’Œå¯¹Request-URIæ‰€æ ‡è¯†çš„èµ„æºè¿›è¡Œä¸‹ä¸€æ­¥è®¿é—®çš„ä¿¡æ¯ã€‚</p><blockquote><p>å¸¸ç”¨çš„å“åº”æŠ¥å¤´<br>Location<br>Locationå“åº”æŠ¥å¤´åŸŸç”¨äºé‡å®šå‘æ¥å—è€…åˆ°ä¸€ä¸ªæ–°çš„ä½ç½®ã€‚Locationå“åº”æŠ¥å¤´åŸŸå¸¸ç”¨åœ¨æ›´æ¢åŸŸåçš„æ—¶å€™ã€‚<br>Server<br>Serverå“åº”æŠ¥å¤´åŸŸåŒ…å«äº†æœåŠ¡å™¨ç”¨æ¥å¤„ç†è¯·æ±‚çš„è½¯ä»¶ä¿¡æ¯ã€‚ä¸User-Agentè¯·æ±‚æŠ¥å¤´åŸŸæ˜¯ç›¸å¯¹åº”çš„ã€‚ä¸‹é¢æ˜¯<br>Serverå“åº”æŠ¥å¤´åŸŸçš„ä¸€ä¸ªä¾‹å­ï¼š<br>Serverï¼šApache-Coyote/1.1<br>WWW-Authenticate<br>WWW-Authenticateå“åº”æŠ¥å¤´åŸŸå¿…é¡»è¢«åŒ…å«åœ¨401ï¼ˆæœªæˆæƒçš„ï¼‰å“åº”æ¶ˆæ¯ä¸­ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°401å“åº”æ¶ˆæ¯æ—¶å€™ï¼Œå¹¶å‘é€AuthorizationæŠ¥å¤´åŸŸè¯·æ±‚æœåŠ¡å™¨å¯¹å…¶è¿›è¡ŒéªŒè¯æ—¶ï¼ŒæœåŠ¡ç«¯å“åº”æŠ¥å¤´å°±åŒ…å«è¯¥æŠ¥å¤´åŸŸã€‚<br>egï¼šWWW-Authenticate:Basic realm=â€Basic Auth Test!â€  //å¯ä»¥çœ‹å‡ºæœåŠ¡å™¨å¯¹è¯·æ±‚èµ„æºé‡‡ç”¨çš„æ˜¯åŸºæœ¬éªŒè¯æœºåˆ¶ã€‚</p></blockquote><h3 id="å®ä½“æŠ¥å¤´"><a href="#å®ä½“æŠ¥å¤´" class="headerlink" title="å®ä½“æŠ¥å¤´"></a>å®ä½“æŠ¥å¤´</h3><p>è¯·æ±‚å’Œå“åº”æ¶ˆæ¯éƒ½å¯ä»¥ä¼ é€ä¸€ä¸ªå®ä½“ã€‚ä¸€ä¸ªå®ä½“ç”±å®ä½“æŠ¥å¤´åŸŸå’Œå®ä½“æ­£æ–‡ç»„æˆï¼Œä½†å¹¶ä¸æ˜¯è¯´å®ä½“æŠ¥å¤´åŸŸå’Œå®ä½“æ­£æ–‡è¦åœ¨ä¸€èµ·å‘é€ï¼Œå¯ä»¥åªå‘é€å®ä½“æŠ¥å¤´åŸŸã€‚å®ä½“æŠ¥å¤´å®šä¹‰äº†å…³äºå®ä½“æ­£æ–‡ï¼ˆegï¼šæœ‰æ— å®ä½“æ­£æ–‡ï¼‰å’Œè¯·æ±‚æ‰€æ ‡è¯†çš„èµ„æºçš„å…ƒä¿¡æ¯ã€‚</p><blockquote><p>å¸¸ç”¨çš„å®ä½“æŠ¥å¤´<br>Content-Encoding<br>Content-Encodingå®ä½“æŠ¥å¤´åŸŸè¢«ç”¨ä½œåª’ä½“ç±»å‹çš„ä¿®é¥°ç¬¦ï¼Œå®ƒçš„å€¼æŒ‡ç¤ºäº†å·²ç»è¢«åº”ç”¨åˆ°å®ä½“æ­£æ–‡çš„é™„åŠ å†…å®¹çš„ç¼–ç ï¼Œå› è€Œè¦è·å¾—Content-TypeæŠ¥å¤´åŸŸä¸­æ‰€å¼•ç”¨çš„åª’ä½“ç±»å‹ï¼Œå¿…é¡»é‡‡ç”¨ç›¸åº”çš„è§£ç æœºåˆ¶ã€‚Content-Encodingè¿™æ ·ç”¨äºè®°å½•æ–‡æ¡£çš„å‹ç¼©æ–¹æ³•ï¼Œegï¼šContent-Encodingï¼šgzip<br>Content-Language<br>Content-Languageå®ä½“æŠ¥å¤´åŸŸæè¿°äº†èµ„æºæ‰€ç”¨çš„è‡ªç„¶è¯­è¨€ã€‚æ²¡æœ‰è®¾ç½®è¯¥åŸŸåˆ™è®¤ä¸ºå®ä½“å†…å®¹å°†æä¾›ç»™æ‰€æœ‰çš„è¯­è¨€é˜…è¯»<br>è€…ã€‚egï¼šContent-Language:da<br>Content-Length<br>Content-Lengthå®ä½“æŠ¥å¤´åŸŸç”¨äºæŒ‡æ˜å®ä½“æ­£æ–‡çš„é•¿åº¦ï¼Œä»¥å­—èŠ‚æ–¹å¼å­˜å‚¨çš„åè¿›åˆ¶æ•°å­—æ¥è¡¨ç¤ºã€‚<br>Content-Type<br>Content-Typeå®ä½“æŠ¥å¤´åŸŸç”¨è¯­æŒ‡æ˜å‘é€ç»™æ¥æ”¶è€…çš„å®ä½“æ­£æ–‡çš„åª’ä½“ç±»å‹ã€‚egï¼š<br>Content-Type:text/html;charset=ISO-8859-1<br>Content-Type:text/html;charset=GB2312<br>Last-Modified<br>Last-Modifiedå®ä½“æŠ¥å¤´åŸŸç”¨äºæŒ‡ç¤ºèµ„æºçš„æœ€åä¿®æ”¹æ—¥æœŸå’Œæ—¶é—´ã€‚<br>Expires<br>Expireså®ä½“æŠ¥å¤´åŸŸç»™å‡ºå“åº”è¿‡æœŸçš„æ—¥æœŸå’Œæ—¶é—´ã€‚ä¸ºäº†è®©ä»£ç†æœåŠ¡å™¨æˆ–æµè§ˆå™¨åœ¨ä¸€æ®µæ—¶é—´ä»¥åæ›´æ–°ç¼“å­˜ä¸­(å†æ¬¡è®¿é—®æ›¾è®¿é—®è¿‡çš„é¡µé¢æ—¶ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­åŠ è½½ï¼Œç¼©çŸ­å“åº”æ—¶é—´å’Œé™ä½æœåŠ¡å™¨è´Ÿè½½)çš„é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Expireså®ä½“æŠ¥å¤´åŸŸæŒ‡å®šé¡µé¢è¿‡æœŸçš„æ—¶é—´ã€‚egï¼šExpiresï¼šThuï¼Œ15 Sep 2006 16:23:12 GMT<br>HTTP1.1çš„å®¢æˆ·ç«¯å’Œç¼“å­˜å¿…é¡»å°†å…¶ä»–éæ³•çš„æ—¥æœŸæ ¼å¼ï¼ˆåŒ…æ‹¬0ï¼‰çœ‹ä½œå·²ç»è¿‡æœŸã€‚egï¼šä¸ºäº†è®©æµè§ˆå™¨ä¸è¦ç¼“å­˜é¡µé¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨Expireså®ä½“æŠ¥å¤´åŸŸï¼Œè®¾ç½®ä¸º0ï¼Œjspä¸­ç¨‹åºå¦‚ä¸‹ï¼šresponse.setDateHeader(â€œExpiresâ€,â€0â€);</p></blockquote><h2 id="HTTPåè®®ç›¸å…³æŠ€æœ¯è¡¥å……"><a href="#HTTPåè®®ç›¸å…³æŠ€æœ¯è¡¥å……" class="headerlink" title="HTTPåè®®ç›¸å…³æŠ€æœ¯è¡¥å……"></a>HTTPåè®®ç›¸å…³æŠ€æœ¯è¡¥å……</h2><h3 id="1ã€åŸºç¡€ï¼š"><a href="#1ã€åŸºç¡€ï¼š" class="headerlink" title="1ã€åŸºç¡€ï¼š"></a>1ã€åŸºç¡€ï¼š</h3><pre><code>é«˜å±‚åè®®æœ‰ï¼šæ–‡ä»¶ä¼ è¾“åè®®FTPã€ç”µå­é‚®ä»¶ä¼ è¾“åè®®SMTPã€åŸŸåç³»ç»ŸæœåŠ¡DNSã€ç½‘ç»œæ–°é—»ä¼ è¾“åè®®NNTPå’ŒHTTPåè®®ç­‰</code></pre><p>ä¸­ä»‹ç”±ä¸‰ç§ï¼šä»£ç†(Proxy)ã€ç½‘å…³(Gateway)å’Œé€šé“(Tunnel)ï¼Œä¸€ä¸ªä»£ç†æ ¹æ®URIçš„ç»å¯¹æ ¼å¼æ¥æ¥å—è¯·æ±‚ï¼Œé‡å†™å…¨éƒ¨æˆ–éƒ¨åˆ†æ¶ˆæ¯ï¼Œé€šè¿‡ URIçš„æ ‡è¯†æŠŠå·²æ ¼å¼åŒ–è¿‡çš„è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ã€‚ç½‘å…³æ˜¯ä¸€ä¸ªæ¥æ”¶ä»£ç†ï¼Œä½œä¸ºä¸€äº›å…¶å®ƒæœåŠ¡å™¨çš„ä¸Šå±‚ï¼Œå¹¶ä¸”å¦‚æœå¿…é¡»çš„è¯ï¼Œå¯ä»¥æŠŠè¯·æ±‚ç¿»è¯‘ç»™ä¸‹å±‚çš„æœåŠ¡å™¨åè®®ã€‚ä¸€ ä¸ªé€šé“ä½œä¸ºä¸æ”¹å˜æ¶ˆæ¯çš„ä¸¤ä¸ªè¿æ¥ä¹‹é—´çš„ä¸­ç»§ç‚¹ã€‚å½“é€šè®¯éœ€è¦é€šè¿‡ä¸€ä¸ªä¸­ä»‹(ä¾‹å¦‚ï¼šé˜²ç«å¢™ç­‰)æˆ–è€…æ˜¯ä¸­ä»‹ä¸èƒ½è¯†åˆ«æ¶ˆæ¯çš„å†…å®¹æ—¶ï¼Œé€šé“ç»å¸¸è¢«ä½¿ç”¨ã€‚<br>     ä»£ç†(Proxy)ï¼šä¸€ä¸ªä¸­é—´ç¨‹åºï¼Œå®ƒå¯ä»¥å……å½“ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥å……å½“ä¸€ä¸ªå®¢æˆ·æœºï¼Œä¸ºå…¶å®ƒå®¢æˆ·æœºå»ºç«‹è¯·æ±‚ã€‚è¯·æ±‚æ˜¯é€šè¿‡å¯èƒ½çš„ç¿»è¯‘åœ¨å†…éƒ¨æˆ–ç»è¿‡ä¼ é€’åˆ°å…¶å®ƒçš„ æœåŠ¡å™¨ä¸­ã€‚ä¸€ä¸ªä»£ç†åœ¨å‘é€è¯·æ±‚ä¿¡æ¯ä¹‹å‰ï¼Œå¿…é¡»è§£é‡Šå¹¶ä¸”å¦‚æœå¯èƒ½é‡å†™å®ƒã€‚ä»£ç†ç»å¸¸ä½œä¸ºé€šè¿‡é˜²ç«å¢™çš„å®¢æˆ·æœºç«¯çš„é—¨æˆ·ï¼Œä»£ç†è¿˜å¯ä»¥ä½œä¸ºä¸€ä¸ªå¸®åŠ©åº”ç”¨æ¥é€šè¿‡åè®®å¤„ ç†æ²¡æœ‰è¢«ç”¨æˆ·ä»£ç†å®Œæˆçš„è¯·æ±‚ã€‚<br>ç½‘å…³(Gateway)ï¼šä¸€ä¸ªä½œä¸ºå…¶å®ƒæœåŠ¡å™¨ä¸­é—´åª’ä»‹çš„æœåŠ¡å™¨ã€‚ä¸ä»£ç†ä¸åŒçš„æ˜¯ï¼Œç½‘å…³æ¥å—è¯·æ±‚å°±å¥½è±¡å¯¹è¢«è¯·æ±‚çš„èµ„æºæ¥è¯´å®ƒå°±æ˜¯æºæœåŠ¡å™¨ï¼›å‘å‡ºè¯·æ±‚çš„å®¢æˆ·æœºå¹¶æ²¡æœ‰æ„è¯†åˆ°å®ƒåœ¨åŒç½‘å…³æ‰“äº¤é“ã€‚<br>ç½‘å…³ç»å¸¸ä½œä¸ºé€šè¿‡é˜²ç«å¢™çš„æœåŠ¡å™¨ç«¯çš„é—¨æˆ·ï¼Œç½‘å…³è¿˜å¯ä»¥ä½œä¸ºä¸€ä¸ªåè®®ç¿»è¯‘å™¨ä»¥ä¾¿å­˜å–é‚£äº›å­˜å‚¨åœ¨éHTTPç³»ç»Ÿä¸­çš„èµ„æºã€‚<br>    é€šé“(Tunnel)ï¼šæ˜¯ä½œä¸ºä¸¤ä¸ªè¿æ¥ä¸­ç»§çš„ä¸­ä»‹ç¨‹åºã€‚ä¸€æ—¦æ¿€æ´»ï¼Œé€šé“ä¾¿è¢«è®¤ä¸ºä¸å±äºHTTPé€šè®¯ï¼Œå°½ç®¡é€šé“å¯èƒ½æ˜¯è¢«ä¸€ä¸ªHTTPè¯·æ±‚åˆå§‹åŒ–çš„ã€‚å½“è¢«ä¸­ç»§ çš„è¿æ¥ä¸¤ç«¯å…³é—­æ—¶ï¼Œé€šé“ä¾¿æ¶ˆå¤±ã€‚å½“ä¸€ä¸ªé—¨æˆ·(Portal)å¿…é¡»å­˜åœ¨æˆ–ä¸­ä»‹(Intermediary)ä¸èƒ½è§£é‡Šä¸­ç»§çš„é€šè®¯æ—¶é€šé“è¢«ç»å¸¸ä½¿ç”¨ã€‚</p><h3 id="2ã€åè®®åˆ†æçš„ä¼˜åŠ¿â€”HTTPåˆ†æå™¨æ£€æµ‹ç½‘ç»œæ”»å‡»"><a href="#2ã€åè®®åˆ†æçš„ä¼˜åŠ¿â€”HTTPåˆ†æå™¨æ£€æµ‹ç½‘ç»œæ”»å‡»" class="headerlink" title="2ã€åè®®åˆ†æçš„ä¼˜åŠ¿â€”HTTPåˆ†æå™¨æ£€æµ‹ç½‘ç»œæ”»å‡»"></a>2ã€åè®®åˆ†æçš„ä¼˜åŠ¿â€”HTTPåˆ†æå™¨æ£€æµ‹ç½‘ç»œæ”»å‡»</h3><p>ä»¥æ¨¡å—åŒ–çš„æ–¹å¼å¯¹é«˜å±‚åè®®è¿›è¡Œåˆ†æå¤„ç†ï¼Œå°†æ˜¯æœªæ¥å…¥ä¾µæ£€æµ‹çš„æ–¹å‘ã€‚<br>HTTPåŠå…¶ä»£ç†çš„å¸¸ç”¨ç«¯å£80ã€3128å’Œ8080åœ¨networkéƒ¨åˆ†ç”¨portæ ‡ç­¾è¿›è¡Œäº†è§„å®š</p><h3 id="3ã€HTTPåè®®Content-Lenthé™åˆ¶æ¼æ´å¯¼è‡´æ‹’ç»æœåŠ¡æ”»å‡»"><a href="#3ã€HTTPåè®®Content-Lenthé™åˆ¶æ¼æ´å¯¼è‡´æ‹’ç»æœåŠ¡æ”»å‡»" class="headerlink" title="3ã€HTTPåè®®Content Lenthé™åˆ¶æ¼æ´å¯¼è‡´æ‹’ç»æœåŠ¡æ”»å‡»"></a>3ã€HTTPåè®®Content Lenthé™åˆ¶æ¼æ´å¯¼è‡´æ‹’ç»æœåŠ¡æ”»å‡»</h3><p>ä½¿ç”¨POSTæ–¹æ³•æ—¶ï¼Œå¯ä»¥è®¾ç½®ContentLenthæ¥å®šä¹‰éœ€è¦ä¼ é€çš„æ•°æ®é•¿åº¦ï¼Œä¾‹å¦‚ContentLenth:999999999ï¼Œåœ¨ä¼ é€å®Œæˆå‰ï¼Œå†… å­˜ä¸ä¼šé‡Šæ”¾ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªç¼ºé™·ï¼Œè¿ç»­å‘WEBæœåŠ¡å™¨å‘é€åƒåœ¾æ•°æ®ç›´è‡³WEBæœåŠ¡å™¨å†…å­˜è€—å°½ã€‚è¿™ç§æ”»å‡»æ–¹æ³•åŸºæœ¬ä¸ä¼šç•™ä¸‹ç—•è¿¹ã€‚<br><a href="http://www.cnpaf.net/Class/HTTP/0532918532667330.html" target="_blank" rel="noopener">http://www.cnpaf.net/Class/HTTP/0532918532667330.html</a></p><h3 id="4ã€åˆ©ç”¨HTTPåè®®çš„ç‰¹æ€§è¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»çš„ä¸€äº›æ„æ€"><a href="#4ã€åˆ©ç”¨HTTPåè®®çš„ç‰¹æ€§è¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»çš„ä¸€äº›æ„æ€" class="headerlink" title="4ã€åˆ©ç”¨HTTPåè®®çš„ç‰¹æ€§è¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»çš„ä¸€äº›æ„æ€"></a>4ã€åˆ©ç”¨HTTPåè®®çš„ç‰¹æ€§è¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»çš„ä¸€äº›æ„æ€</h3><p>æœåŠ¡å™¨ç«¯å¿™äºå¤„ç†æ”»å‡»è€…ä¼ªé€ çš„TCPè¿æ¥è¯·æ±‚è€Œæ— æš‡ç†ç¬å®¢æˆ·çš„æ­£å¸¸è¯·æ±‚ï¼ˆæ¯•ç«Ÿå®¢æˆ·ç«¯çš„æ­£å¸¸è¯·æ±‚æ¯”ç‡éå¸¸ä¹‹å°ï¼‰ï¼Œæ­¤æ—¶ä»æ­£å¸¸å®¢æˆ·çš„è§’åº¦çœ‹æ¥ï¼ŒæœåŠ¡å™¨å¤±å»å“åº”ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬ç§°ä½œï¼šæœåŠ¡å™¨ç«¯å—åˆ°äº†SYNFloodæ”»å‡»ï¼ˆSYNæ´ªæ°´æ”»å‡»ï¼‰ã€‚<br>è€ŒSmurfã€TearDropç­‰æ˜¯åˆ©ç”¨ICMPæŠ¥æ–‡æ¥Floodå’ŒIPç¢ç‰‡æ”»å‡»çš„ã€‚æœ¬æ–‡ç”¨â€œæ­£å¸¸è¿æ¥â€çš„æ–¹æ³•æ¥äº§ç”Ÿæ‹’ç»æœåŠ¡æ”»å‡»ã€‚<br>19ç«¯å£åœ¨æ—©æœŸå·²ç»æœ‰äººç”¨æ¥åšChargenæ”»å‡»äº†ï¼Œå³Chargen_Denial_of_Serviceï¼Œä½†æ˜¯ï¼ä»–ä»¬ç”¨çš„æ–¹æ³•æ˜¯åœ¨ä¸¤å°Chargen æœåŠ¡å™¨ä¹‹é—´äº§ç”ŸUDPè¿æ¥ï¼Œè®©æœåŠ¡å™¨å¤„ç†è¿‡å¤šä¿¡æ¯è€ŒDOWNæ‰ï¼Œé‚£ä¹ˆï¼Œå¹²æ‰ä¸€å°WEBæœåŠ¡å™¨çš„æ¡ä»¶å°±å¿…é¡»æœ‰2ä¸ªï¼š1.æœ‰ChargenæœåŠ¡2.æœ‰HTTP æœåŠ¡<br>æ–¹æ³•ï¼šæ”»å‡»è€…ä¼ªé€ æºIPç»™Nå°Chargenå‘é€è¿æ¥è¯·æ±‚ï¼ˆConnectï¼‰ï¼ŒChargenæ¥æ”¶åˆ°è¿æ¥åå°±ä¼šè¿”å›æ¯ç§’72å­—èŠ‚çš„å­—ç¬¦æµï¼ˆå®é™…ä¸Šæ ¹æ®ç½‘ç»œå®é™…æƒ…å†µï¼Œè¿™ä¸ªé€Ÿåº¦æ›´å¿«ï¼‰ç»™æœåŠ¡å™¨ã€‚</p><h3 id="5ã€HttpæŒ‡çº¹è¯†åˆ«æŠ€æœ¯"><a href="#5ã€HttpæŒ‡çº¹è¯†åˆ«æŠ€æœ¯" class="headerlink" title="5ã€HttpæŒ‡çº¹è¯†åˆ«æŠ€æœ¯"></a>5ã€HttpæŒ‡çº¹è¯†åˆ«æŠ€æœ¯</h3><p>   HttpæŒ‡çº¹è¯†åˆ«çš„åŸç†å¤§è‡´ä¸Šä¹Ÿæ˜¯ç›¸åŒçš„ï¼šè®°å½•ä¸åŒæœåŠ¡å™¨å¯¹Httpåè®®æ‰§è¡Œä¸­çš„å¾®å°å·®åˆ«è¿›è¡Œè¯†åˆ«.HttpæŒ‡çº¹è¯†åˆ«æ¯”TCP/IPå †æ ˆæŒ‡çº¹è¯†åˆ«å¤æ‚è®¸ å¤š,ç†ç”±æ˜¯å®šåˆ¶HttpæœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ã€å¢åŠ æ’ä»¶æˆ–ç»„ä»¶ä½¿å¾—æ›´æ”¹Httpçš„å“åº”ä¿¡æ¯å˜çš„å¾ˆå®¹æ˜“,è¿™æ ·ä½¿å¾—è¯†åˆ«å˜çš„å›°éš¾ï¼›ç„¶è€Œå®šåˆ¶TCP/IPå †æ ˆçš„è¡Œä¸º éœ€è¦å¯¹æ ¸å¿ƒå±‚è¿›è¡Œä¿®æ”¹,æ‰€ä»¥å°±å®¹æ˜“è¯†åˆ«.<br>      è¦è®©æœåŠ¡å™¨è¿”å›ä¸åŒçš„Bannerä¿¡æ¯çš„è®¾ç½®æ˜¯å¾ˆç®€å•çš„,è±¡Apacheè¿™æ ·çš„å¼€æ”¾æºä»£ç çš„HttpæœåŠ¡å™¨,ç”¨æˆ·å¯ä»¥åœ¨æºä»£ç é‡Œä¿®æ”¹Bannerä¿¡æ¯,ç„¶ åé‡èµ·HttpæœåŠ¡å°±ç”Ÿæ•ˆäº†ï¼›å¯¹äºæ²¡æœ‰å…¬å¼€æºä»£ç çš„HttpæœåŠ¡å™¨æ¯”å¦‚å¾®è½¯çš„IISæˆ–è€…æ˜¯Netscape,å¯ä»¥åœ¨å­˜æ”¾Bannerä¿¡æ¯çš„Dllæ–‡ä»¶ä¸­ä¿® æ”¹,ç›¸å…³çš„æ–‡ç« æœ‰è®¨è®ºçš„,è¿™é‡Œä¸å†èµ˜è¿°,å½“ç„¶è¿™æ ·çš„ä¿®æ”¹çš„æ•ˆæœè¿˜æ˜¯ä¸é”™çš„.å¦å¤–ä¸€ç§æ¨¡ç³ŠBannerä¿¡æ¯çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ’ä»¶ã€‚</p><blockquote><p>å¸¸ç”¨æµ‹è¯•è¯·æ±‚ï¼š<br>1ï¼šHEAD/Http/1.0å‘é€åŸºæœ¬çš„Httpè¯·æ±‚<br>2ï¼šDELETE/Http/1.0å‘é€é‚£äº›ä¸è¢«å…è®¸çš„è¯·æ±‚,æ¯”å¦‚Deleteè¯·æ±‚<br>3ï¼šGET/Http/3.0å‘é€ä¸€ä¸ªéæ³•ç‰ˆæœ¬çš„Httpåè®®è¯·æ±‚<br>4ï¼šGET/JUNK/1.0å‘é€ä¸€ä¸ªä¸æ­£ç¡®è§„æ ¼çš„Httpåè®®è¯·æ±‚<br>HttpæŒ‡çº¹è¯†åˆ«å·¥å…·Httprint,å®ƒé€šè¿‡è¿ç”¨ç»Ÿè®¡å­¦åŸç†,ç»„åˆæ¨¡ç³Šçš„é€»è¾‘å­¦æŠ€æœ¯,èƒ½å¾ˆæœ‰æ•ˆçš„ç¡®å®šHttpæœåŠ¡å™¨çš„ç±»å‹.å®ƒå¯ä»¥è¢«ç”¨æ¥æ”¶é›†å’Œåˆ†æä¸åŒHttpæœåŠ¡å™¨äº§ç”Ÿçš„ç­¾åã€‚</p></blockquote><h3 id="6ã€å…¶ä»–ï¼šä¸ºäº†æé«˜ç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨æ—¶çš„æ€§èƒ½ï¼Œç°ä»£æµè§ˆå™¨è¿˜æ”¯æŒå¹¶å‘çš„è®¿é—®æ–¹å¼ï¼Œæµè§ˆä¸€ä¸ªç½‘é¡µæ—¶åŒæ—¶å»ºç«‹å¤šä¸ªè¿æ¥ï¼Œä»¥è¿…é€Ÿè·å¾—ä¸€ä¸ªç½‘é¡µä¸Šçš„å¤šä¸ªå›¾æ ‡ï¼Œè¿™æ ·èƒ½æ›´å¿«é€Ÿå®Œæˆæ•´ä¸ªç½‘é¡µçš„ä¼ è¾“ã€‚"><a href="#6ã€å…¶ä»–ï¼šä¸ºäº†æé«˜ç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨æ—¶çš„æ€§èƒ½ï¼Œç°ä»£æµè§ˆå™¨è¿˜æ”¯æŒå¹¶å‘çš„è®¿é—®æ–¹å¼ï¼Œæµè§ˆä¸€ä¸ªç½‘é¡µæ—¶åŒæ—¶å»ºç«‹å¤šä¸ªè¿æ¥ï¼Œä»¥è¿…é€Ÿè·å¾—ä¸€ä¸ªç½‘é¡µä¸Šçš„å¤šä¸ªå›¾æ ‡ï¼Œè¿™æ ·èƒ½æ›´å¿«é€Ÿå®Œæˆæ•´ä¸ªç½‘é¡µçš„ä¼ è¾“ã€‚" class="headerlink" title="6ã€å…¶ä»–ï¼šä¸ºäº†æé«˜ç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨æ—¶çš„æ€§èƒ½ï¼Œç°ä»£æµè§ˆå™¨è¿˜æ”¯æŒå¹¶å‘çš„è®¿é—®æ–¹å¼ï¼Œæµè§ˆä¸€ä¸ªç½‘é¡µæ—¶åŒæ—¶å»ºç«‹å¤šä¸ªè¿æ¥ï¼Œä»¥è¿…é€Ÿè·å¾—ä¸€ä¸ªç½‘é¡µä¸Šçš„å¤šä¸ªå›¾æ ‡ï¼Œè¿™æ ·èƒ½æ›´å¿«é€Ÿå®Œæˆæ•´ä¸ªç½‘é¡µçš„ä¼ è¾“ã€‚"></a>6ã€å…¶ä»–ï¼šä¸ºäº†æé«˜ç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨æ—¶çš„æ€§èƒ½ï¼Œç°ä»£æµè§ˆå™¨è¿˜æ”¯æŒå¹¶å‘çš„è®¿é—®æ–¹å¼ï¼Œæµè§ˆä¸€ä¸ªç½‘é¡µæ—¶åŒæ—¶å»ºç«‹å¤šä¸ªè¿æ¥ï¼Œä»¥è¿…é€Ÿè·å¾—ä¸€ä¸ªç½‘é¡µä¸Šçš„å¤šä¸ªå›¾æ ‡ï¼Œè¿™æ ·èƒ½æ›´å¿«é€Ÿå®Œæˆæ•´ä¸ªç½‘é¡µçš„ä¼ è¾“ã€‚</h3><p>HTTP1.1ä¸­æä¾›äº†è¿™ç§æŒç»­è¿æ¥çš„æ–¹å¼ï¼Œè€Œä¸‹ä¸€ä»£HTTPåè®®ï¼šHTTP-NGæ›´å¢åŠ äº†æœ‰å…³ä¼šè¯æ§åˆ¶ã€ä¸°å¯Œçš„å†…å®¹åå•†ç­‰æ–¹å¼çš„æ”¯æŒï¼Œæ¥æä¾›<br>æ›´é«˜æ•ˆç‡çš„è¿æ¥ã€‚</p><p><a href="https://blog.csdn.net/u013219814/article/details/56290792" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a>   </p>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Es6 æ ¸å¿ƒå†…å®¹ ä¸‹</title>
      <link href="/2018/03/30/Js/Es6-%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9-%E4%B8%8B/"/>
      <url>/2018/03/30/Js/Es6-%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9-%E4%B8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="import-export"><a href="#import-export" class="headerlink" title="import export"></a>import export</h2><p>è¿™ä¸¤ä¸ªå®¶ä¼™å¯¹åº”çš„å°±æ˜¯es6è‡ªå·±çš„<code>module</code>åŠŸèƒ½ã€‚</p><p>æˆ‘ä»¬ä¹‹å‰å†™çš„Javascriptä¸€ç›´éƒ½æ²¡æœ‰æ¨¡å—åŒ–çš„ä½“ç³»ï¼Œæ— æ³•å°†ä¸€ä¸ªåºå¤§çš„jså·¥ç¨‹æ‹†åˆ†æˆä¸€ä¸ªä¸ªåŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹ä½†ç›¸äº’ä¾èµ–çš„å°å·¥ç¨‹ï¼Œå†ç”¨ä¸€ç§ç®€å•çš„æ–¹æ³•æŠŠè¿™äº›å°å·¥ç¨‹è¿æ¥åœ¨ä¸€èµ·ã€‚</p><blockquote><p>è¿™æœ‰å¯èƒ½å¯¼è‡´ä¸¤ä¸ªé—®é¢˜ï¼š<br>ä¸€æ–¹é¢jsä»£ç å˜å¾—å¾ˆè‡ƒè‚¿ï¼Œéš¾ä»¥ç»´æŠ¤<br>å¦ä¸€æ–¹é¢æˆ‘ä»¬å¸¸å¸¸å¾—å¾ˆæ³¨æ„æ¯ä¸ªscriptæ ‡ç­¾åœ¨htmlä¸­çš„ä½ç½®ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸æœ‰ä¾èµ–å…³ç³»ï¼Œé¡ºåºé”™äº†å¯èƒ½å°±ä¼šå‡ºbug</p></blockquote><p>åœ¨es6ä¹‹å‰ä¸ºè§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¾—åˆ©ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„ä¸€äº›æ–¹æ¡ˆï¼Œä¸»è¦æœ‰ä¸¤ç§CommonJS(æœåŠ¡å™¨ç«¯)å’ŒAMDï¼ˆæµè§ˆå™¨ç«¯ï¼Œå¦‚require.jsï¼‰ã€‚</p><p>è€Œç°åœ¨æˆ‘ä»¬æœ‰äº†es6çš„moduleåŠŸèƒ½ï¼Œå®ƒå®ç°éå¸¸ç®€å•ï¼Œå¯ä»¥æˆä¸ºæœåŠ¡å™¨å’Œæµè§ˆå™¨é€šç”¨çš„æ¨¡å—è§£å†³æ–¹æ¡ˆã€‚</p><blockquote><p>ES6æ¨¡å—çš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯å°½é‡çš„é™æ€åŒ–ï¼Œä½¿å¾—ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠè¾“å…¥å’Œè¾“å‡ºçš„å˜é‡ã€‚CommonJSå’ŒAMDæ¨¡å—ï¼Œéƒ½åªèƒ½åœ¨è¿è¡Œæ—¶ç¡®å®šè¿™äº›ä¸œè¥¿ã€‚</p></blockquote><h3 id="ä¼ ç»Ÿå†™æ³•"><a href="#ä¼ ç»Ÿå†™æ³•" class="headerlink" title="ä¼ ç»Ÿå†™æ³•"></a>ä¼ ç»Ÿå†™æ³•</h3><p>é¦–å…ˆæˆ‘ä»¬å›é¡¾ä¸‹require.jsçš„å†™æ³•ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªjsæ–‡ä»¶: index.jså’Œcontent.js,ç°åœ¨æˆ‘ä»¬æƒ³è¦åœ¨index.jsä¸­ä½¿ç”¨content.jsè¿”å›çš„ç»“æœï¼Œæˆ‘ä»¬è¦æ€ä¹ˆåšå‘¢ï¼Ÿ<br>é¦–å…ˆå®šä¹‰ï¼š</p><pre><code class="javascript">//content.jsdefine(&#39;content.js&#39;, function(){    return &#39;A cat&#39;;})</code></pre><a id="more"></a><p>ç„¶årequireï¼š</p><pre><code class="javascript">//index.jsrequire([&#39;./content.js&#39;], function(animal){    console.log(animal);   //A cat})</code></pre><p>é‚£CommonJSæ˜¯æ€ä¹ˆå†™çš„å‘¢ï¼Ÿ</p><pre><code class="javascript">//index.jsvar animal = require(&#39;./content.js&#39;)//content.jsmodule.exports = &#39;A cat&#39;</code></pre><p>ES6çš„å†™æ³•</p><pre><code class="javascript">//index.jsimport animal from &#39;./content&#39;//content.jsexport default &#39;A cat&#39;</code></pre><h2 id="ES6-moduleçš„å…¶ä»–é«˜çº§ç”¨æ³•"><a href="#ES6-moduleçš„å…¶ä»–é«˜çº§ç”¨æ³•" class="headerlink" title="ES6 moduleçš„å…¶ä»–é«˜çº§ç”¨æ³•"></a>ES6 moduleçš„å…¶ä»–é«˜çº§ç”¨æ³•</h2><pre><code class="javascript">//content.jsexport default &#39;A cat&#39;    export function say(){    return &#39;Hello!&#39;}    export const type = &#39;dog&#39; </code></pre><p>ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œexportå‘½ä»¤é™¤äº†è¾“å‡ºå˜é‡ï¼Œè¿˜å¯ä»¥è¾“å‡ºå‡½æ•°ï¼Œç”šè‡³æ˜¯ç±»ï¼ˆreactçš„æ¨¡å—åŸºæœ¬éƒ½æ˜¯è¾“å‡ºç±»ï¼‰</p><pre><code class="javascript">//index.jsimport { say, type } from &#39;./content&#39;  let says = say()console.log(`The ${type} says ${says}`)  //The dog says Hello</code></pre><p>è¿™é‡Œè¾“å…¥çš„æ—¶å€™è¦æ³¨æ„ï¼šå¤§æ‹¬å·é‡Œé¢çš„å˜é‡åï¼Œå¿…é¡»ä¸è¢«å¯¼å…¥æ¨¡å—ï¼ˆcontent.jsï¼‰å¯¹å¤–æ¥å£çš„åç§°ç›¸åŒã€‚</p><p>å¦‚æœè¿˜å¸Œæœ›è¾“å…¥content.jsä¸­è¾“å‡ºçš„é»˜è®¤<code>(default)</code>, å¯ä»¥å†™åœ¨å¤§æ‹¬å·å¤–é¢ã€‚</p><pre><code class="javascript">//index.jsimport animal, { say, type } from &#39;./content&#39;  let says = say()console.log(`The ${type} says ${says} to ${animal}`)  //The dog says Hello to A cat</code></pre><h3 id="ä¿®æ”¹å˜é‡å"><a href="#ä¿®æ”¹å˜é‡å" class="headerlink" title="ä¿®æ”¹å˜é‡å"></a>ä¿®æ”¹å˜é‡å</h3><p>æ­¤æ—¶æˆ‘ä»¬ä¸å–œæ¬¢typeè¿™ä¸ªå˜é‡åï¼Œå› ä¸ºå®ƒæœ‰å¯èƒ½é‡åï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹å®ƒçš„å˜é‡åã€‚åœ¨es6ä¸­å¯ä»¥ç”¨aså®ç°ä¸€é”®æ¢åã€‚</p><pre><code class="javascript">//index.jsimport animal, { say, type as animalType } from &#39;./content&#39;  let says = say()console.log(`The ${animalType} says ${says} to ${animal}`)  //The dog says Hello to A cat</code></pre><h3 id="æ¨¡å—çš„æ•´ä½“åŠ è½½"><a href="#æ¨¡å—çš„æ•´ä½“åŠ è½½" class="headerlink" title="æ¨¡å—çš„æ•´ä½“åŠ è½½"></a>æ¨¡å—çš„æ•´ä½“åŠ è½½</h3><p>é™¤äº†æŒ‡å®šåŠ è½½æŸä¸ªè¾“å‡ºå€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ•´ä½“åŠ è½½ï¼Œå³ç”¨æ˜Ÿå·<code>ï¼ˆ*ï¼‰</code>æŒ‡å®šä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰è¾“å‡ºå€¼éƒ½åŠ è½½åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢ã€‚</p><pre><code class="javascript">//index.jsimport animal, * as content from &#39;./content&#39;  let says = content.say()console.log(`The ${content.type} says ${says} to ${animal}`)  //The dog says Hello to A cat</code></pre><p>é€šå¸¸æ˜Ÿå·*ç»“åˆasä¸€èµ·ä½¿ç”¨æ¯”è¾ƒåˆé€‚ã€‚</p><h2 id="ç»ˆæç§˜ç±"><a href="#ç»ˆæç§˜ç±" class="headerlink" title="ç»ˆæç§˜ç±"></a>ç»ˆæç§˜ç±</h2><p>è€ƒè™‘ä¸‹é¢çš„åœºæ™¯ï¼šä¸Šé¢çš„<code>content.js</code>ä¸€å…±è¾“å‡ºäº†ä¸‰ä¸ªå˜é‡ï¼ˆdefault, say, typeï¼‰,å‡å¦‚æˆ‘ä»¬çš„å®é™…é¡¹ç›®å½“ä¸­åªéœ€è¦ç”¨åˆ°typeè¿™ä¸€ä¸ªå˜é‡ï¼Œå…¶ä½™ä¸¤ä¸ªæˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦ã€‚æˆ‘ä»¬å¯ä»¥åªè¾“å…¥ä¸€ä¸ªå˜é‡ï¼š</p><pre><code class="javascript">import { type } from &#39;./content&#39; </code></pre><p>ç”±äºå…¶ä»–ä¸¤ä¸ªå˜é‡æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œæˆ‘ä»¬å¸Œæœ›ä»£ç æ‰“åŒ…çš„æ—¶å€™ä¹Ÿå¿½ç•¥å®ƒä»¬ï¼ŒæŠ›å¼ƒå®ƒä»¬ï¼Œè¿™æ ·åœ¨å¤§é¡¹ç›®ä¸­å¯ä»¥æ˜¾è‘—å‡å°‘æ–‡ä»¶çš„ä½“ç§¯ã€‚</p><p><a href="https://segmentfault.com/a/1190000004368132" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Es6 æ ¸å¿ƒå†…å®¹ä¸Š</title>
      <link href="/2018/03/30/Js/Es6-%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9-%E4%B8%8A/"/>
      <url>/2018/03/30/Js/Es6-%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9-%E4%B8%8A/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æˆ‘ä»¬æ­£å¼è®²è§£ES6è¯­æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£ä¸‹Babelã€‚<br><a href="https://babeljs.io/" target="_blank" rel="noopener">Babel</a></p><p>Babelæ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ES6è½¬ç å™¨ï¼Œå¯ä»¥å°†ES6ä»£ç è½¬ä¸ºES5ä»£ç ï¼Œä»è€Œåœ¨ç°æœ‰ç¯å¢ƒæ‰§è¡Œã€‚å¤§å®¶å¯ä»¥é€‰æ‹©è‡ªå·±ä¹ æƒ¯çš„å·¥å…·æ¥ä½¿ç”¨ä½¿ç”¨Babelï¼Œå…·ä½“è¿‡ç¨‹å¯ç›´æ¥åœ¨Babelå®˜ç½‘æŸ¥çœ‹ï¼š</p><h1 id="æœ€å¸¸ç”¨çš„ES6ç‰¹æ€§"><a href="#æœ€å¸¸ç”¨çš„ES6ç‰¹æ€§" class="headerlink" title="æœ€å¸¸ç”¨çš„ES6ç‰¹æ€§"></a>æœ€å¸¸ç”¨çš„ES6ç‰¹æ€§</h1><p><code>let, const, class, extends, super, arrow functions, template string, destructuring, default, restï¼Œarguments</code></p><p>è¿™äº›æ˜¯ES6æœ€å¸¸ç”¨çš„å‡ ä¸ªè¯­æ³•ï¼ŒåŸºæœ¬ä¸Šå­¦ä¼šå®ƒä»¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥èµ°éå¤©ä¸‹éƒ½ä¸æ€•å•¦ï¼æˆ‘ä¼šç”¨æœ€é€šä¿—æ˜“æ‡‚çš„è¯­è¨€å’Œä¾‹å­æ¥è®²è§£å®ƒä»¬ï¼Œä¿è¯ä¸€çœ‹å°±æ‡‚ï¼Œä¸€å­¦å°±ä¼šã€‚</p><h2 id="let-const"><a href="#let-const" class="headerlink" title="let ,const"></a>let ,const</h2><p>è¿™ä¸¤ä¸ªçš„ç”¨é€”ä¸varç±»ä¼¼ï¼Œéƒ½æ˜¯ç”¨æ¥å£°æ˜å˜é‡çš„ï¼Œä½†åœ¨å®é™…è¿ç”¨ä¸­ä»–ä¿©éƒ½æœ‰å„è‡ªçš„ç‰¹æ®Šç”¨é€”ã€‚<br>é¦–å…ˆæ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p><pre><code class="javascript">var name = &#39;zach&#39;while (true) {    var name = &#39;obama&#39;    console.log(name)  //obama    break}console.log(name)  //obama</code></pre><p>ä½¿ç”¨var ä¸¤æ¬¡è¾“å‡ºéƒ½æ˜¯obamaï¼Œè¿™æ˜¯å› ä¸ºES5åªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œè¿™å¸¦æ¥å¾ˆå¤šä¸åˆç†çš„åœºæ™¯ã€‚ç¬¬ä¸€ç§åœºæ™¯å°±æ˜¯ä½ ç°åœ¨çœ‹åˆ°çš„å†…å±‚å˜é‡è¦†ç›–å¤–å±‚å˜é‡ã€‚è€Œletåˆ™å®é™…ä¸Šä¸ºJavaScriptæ–°å¢äº†å—çº§ä½œç”¨åŸŸã€‚ç”¨å®ƒæ‰€å£°æ˜çš„å˜é‡ï¼Œåªåœ¨letå‘½ä»¤æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆã€‚</p><a id="more"></a><pre><code class="javascript">let name = &#39;zach&#39;while (true) {    let name = &#39;obama&#39;    console.log(name)  //obama    break}console.log(name)  //zach</code></pre><p>å¦å¤–ä¸€ä¸ªvarå¸¦æ¥çš„ä¸åˆç†åœºæ™¯å°±æ˜¯ç”¨æ¥è®¡æ•°çš„å¾ªç¯å˜é‡æ³„éœ²ä¸ºå…¨å±€å˜é‡ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><pre><code class="javascript">var a = [];for (var i = 0; i &lt; 10; i++) {  a[i] = function () {    console.log(i);  };}a[6](); // 10</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡iæ˜¯varå£°æ˜çš„ï¼Œåœ¨å…¨å±€èŒƒå›´å†…éƒ½æœ‰æ•ˆã€‚æ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯ï¼Œæ–°çš„iå€¼éƒ½ä¼šè¦†ç›–æ—§å€¼ï¼Œå¯¼è‡´æœ€åè¾“å‡ºçš„æ˜¯æœ€åä¸€è½®çš„içš„å€¼ã€‚è€Œä½¿ç”¨letåˆ™ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚</p><pre><code class="javascript">var a = [];for (let i = 0; i &lt; 10; i++) {  a[i] = function () {    console.log(i);  };}a[6](); // 6</code></pre><p>å†æ¥çœ‹ä¸€ä¸ªæ›´å¸¸è§çš„ä¾‹å­ï¼Œäº†è§£ä¸‹å¦‚æœä¸ç”¨ES6ï¼Œè€Œç”¨é—­åŒ…å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><pre><code class="javascript">var clickBoxs = document.querySelectorAll(&#39;.clickBox&#39;)for (var i = 0; i &lt; clickBoxs.length; i++){    clickBoxs[i].onclick = function(){        console.log(i)    }}</code></pre><p>æˆ‘ä»¬æœ¬æ¥å¸Œæœ›çš„æ˜¯ç‚¹å‡»ä¸åŒçš„clickBoxï¼Œæ˜¾ç¤ºä¸åŒçš„iï¼Œä½†äº‹å®æ˜¯æ— è®ºæˆ‘ä»¬ç‚¹å‡»å“ªä¸ªclickBoxï¼Œè¾“å‡ºçš„éƒ½æ˜¯5ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹ï¼Œå¦‚ä½•ç”¨é—­åŒ…æå®šå®ƒã€‚</p><pre><code class="javascript">function iteratorFactory(i){    var onclick = function(e){        console.log(i)    }    return onclick;}var clickBoxs = document.querySelectorAll(&#39;.clickBox&#39;)for (var i = 0; i &lt; clickBoxs.length; i++){    clickBoxs[i].onclick = iteratorFactory(i)}</code></pre><p>constä¹Ÿç”¨æ¥å£°æ˜å˜é‡ï¼Œä½†æ˜¯å£°æ˜çš„æ˜¯å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚</p><pre><code class="javascript">const PI = Math.PIPI = 23 //Module build failed: SyntaxError: /es6/app.js: &quot;PI&quot; is read-only</code></pre><p>å½“æˆ‘ä»¬å°è¯•å»æ”¹å˜ç”¨constå£°æ˜çš„å¸¸é‡æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šæŠ¥é”™ã€‚</p><h2 id="class-extends-super"><a href="#class-extends-super" class="headerlink" title="class, extends, super"></a>class, extends, super</h2><p>è¿™ä¸‰ä¸ªç‰¹æ€§æ¶‰åŠäº†ES5ä¸­æœ€ä»¤äººå¤´ç–¼çš„çš„å‡ ä¸ªéƒ¨åˆ†ï¼šåŸå‹ã€æ„é€ å‡½æ•°ï¼Œç»§æ‰¿â€¦ä½ è¿˜åœ¨ä¸ºå®ƒä»¬å¤æ‚éš¾æ‡‚çš„è¯­æ³•è€Œçƒ¦æ¼å—ï¼Ÿä½ è¿˜åœ¨ä¸ºæŒ‡é’ˆåˆ°åº•æŒ‡å‘å“ªé‡Œè€Œçº ç»“ä¸‡åˆ†å—ï¼Ÿ<br>ES6æä¾›äº†æ›´æ¥è¿‘ä¼ ç»Ÿè¯­è¨€çš„å†™æ³•ï¼Œå¼•å…¥äº†Classï¼ˆç±»ï¼‰è¿™ä¸ªæ¦‚å¿µã€‚æ–°çš„classå†™æ³•è®©å¯¹è±¡åŸå‹çš„å†™æ³•æ›´åŠ æ¸…æ™°ã€æ›´åƒé¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­æ³•ï¼Œä¹Ÿæ›´åŠ é€šä¿—æ˜“æ‡‚ã€‚</p><pre><code class="javascript">class Animal {    constructor(){        this.type = &#39;animal&#39;    }    says(say){        console.log(this.type + &#39;says&#39; + say)    }}let animal = new Animal()animal.says(&#39;hello&#39;) //animal says helloclass Cat extends Animal{    constructor(){        super()        this.type = &#39;cat&#39;    }}let cat  = new Cat();cat.says(&#39;hello&#39;)</code></pre><p>ä¸Šé¢ä»£ç é¦–å…ˆç”¨<code>class</code>å®šä¹‰äº†ä¸€ä¸ªâ€œç±»â€ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ª<code>constructor</code>æ–¹æ³•ï¼Œè¿™å°±æ˜¯æ„é€ æ–¹æ³•ï¼Œè€Œ<code>this</code>å…³é”®å­—åˆ™ä»£è¡¨å®ä¾‹å¯¹è±¡ã€‚ç®€å•åœ°è¯´ï¼Œ<code>constructor</code>å†…å®šä¹‰çš„æ–¹æ³•å’Œå±æ€§æ˜¯å®ä¾‹å¯¹è±¡è‡ªå·±çš„ï¼Œè€Œconstructorå¤–å®šä¹‰çš„æ–¹æ³•å’Œå±æ€§åˆ™æ˜¯æ‰€æœ‰å®ä¾‹å¯¹è±¡å¯ä»¥å…±äº«çš„ã€‚</p><p><code>Class</code>ä¹‹é—´å¯ä»¥é€šè¿‡<code>extends</code>å…³é”®å­—å®ç°ç»§æ‰¿ï¼Œè¿™æ¯”ES5çš„é€šè¿‡ä¿®æ”¹åŸå‹é“¾å®ç°ç»§æ‰¿ï¼Œè¦æ¸…æ™°å’Œæ–¹ä¾¿å¾ˆå¤šã€‚ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªCatç±»ï¼Œè¯¥ç±»é€šè¿‡<code>extends</code>å…³é”®å­—ï¼Œç»§æ‰¿äº†Animalç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚</p><p><code>super</code>å…³é”®å­—ï¼Œå®ƒæŒ‡ä»£çˆ¶ç±»çš„å®ä¾‹ï¼ˆå³çˆ¶ç±»çš„thiså¯¹è±¡ï¼‰ã€‚å­ç±»å¿…é¡»åœ¨<code>constructor</code>æ–¹æ³•ä¸­è°ƒç”¨<code>super</code>æ–¹æ³•ï¼Œå¦åˆ™æ–°å»ºå®ä¾‹æ—¶ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„thiså¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„thiså¯¹è±¡ï¼Œç„¶åå¯¹å…¶è¿›è¡ŒåŠ å·¥ã€‚å¦‚æœä¸è°ƒç”¨superæ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ°thiså¯¹è±¡ã€‚</p><font color = "red">ES6çš„ç»§æ‰¿æœºåˆ¶ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨superæ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹thisã€‚</font><h2 id="arrow-function-ç®­å¤´å‡½æ•°"><a href="#arrow-function-ç®­å¤´å‡½æ•°" class="headerlink" title="arrow function(ç®­å¤´å‡½æ•°)"></a>arrow function(ç®­å¤´å‡½æ•°)</h2><p>è¿™ä¸ªææ€•æ˜¯ES6æœ€æœ€å¸¸ç”¨çš„ä¸€ä¸ªæ–°ç‰¹æ€§äº†ï¼Œç”¨å®ƒæ¥å†™functionæ¯”åŸæ¥çš„å†™æ³•è¦ç®€æ´æ¸…æ™°å¾ˆå¤š:</p><pre><code class="javascript">function(i){ return i + 1; } //ES5(i) =&gt; i + 1 //ES6</code></pre><p>ç®€ç›´æ˜¯ç®€å•çš„ä¸åƒè¯å¯¹å§â€¦<br>å¦‚æœæ–¹ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œåˆ™éœ€è¦ç”¨{}æŠŠä»£ç åŒ…èµ·æ¥ï¼š</p><pre><code class="javascript">function(x, y) {     x++;    y--;    return x + y;}//es6(x, y) =&gt; {x++; y--; return x+y}</code></pre><p>é™¤äº†çœ‹ä¸Šå»æ›´ç®€æ´ä»¥å¤–ï¼Œarrow functionè¿˜æœ‰ä¸€é¡¹è¶…çº§æ— æ•Œçš„åŠŸèƒ½ï¼<br>é•¿æœŸä»¥æ¥ï¼ŒJavaScriptè¯­è¨€çš„thiså¯¹è±¡ä¸€ç›´æ˜¯ä¸€ä¸ªä»¤äººå¤´ç—›çš„é—®é¢˜ï¼Œåœ¨å¯¹è±¡æ–¹æ³•ä¸­ä½¿ç”¨thisï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚ä¾‹å¦‚ï¼š</p><pre><code class="javascript">class Animal {    constructor(){        this.type = &#39;animal&#39;    }    says(say){        setTimeout(function(){            console.log(this.type + &#39; says &#39; + say)        }, 1000)    }} var animal = new Animal() animal.says(&#39;hi&#39;)  //undefined says hi</code></pre><p>è¿è¡Œä¸Šé¢çš„ä»£ç ä¼šæŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºsetTimeoutä¸­çš„thisæŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡ã€‚æ‰€ä»¥ä¸ºäº†è®©å®ƒèƒ½å¤Ÿæ­£ç¡®çš„è¿è¡Œï¼Œä¼ ç»Ÿçš„è§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p><blockquote><p>ç¬¬ä¸€ç§æ˜¯å°†thisä¼ ç»™self,å†ç”¨selfæ¥æŒ‡ä»£this</p><pre><code class="javascript">   says(say){       var self = this;       setTimeout(function(){           console.log(self.type + &#39; says &#39; + say)       }, 1000)</code></pre></blockquote><blockquote><p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ç”¨bind(this),å³</p><pre><code class="javascript">   says(say){       setTimeout(function(){           console.log(this.type + &#39; says &#39; + say)       }.bind(this), 1000)</code></pre></blockquote><p>ä½†ç°åœ¨æˆ‘ä»¬æœ‰äº†ç®­å¤´å‡½æ•°ï¼Œå°±ä¸éœ€è¦è¿™ä¹ˆéº»çƒ¦äº†ï¼š</p><pre><code class="javascript">class Animal {    constructor(){        this.type = &#39;animal&#39;    }    says(say){        setTimeout( () =&gt; {            console.log(this.type + &#39; says &#39; + say)        }, 1000)    }} var animal = new Animal() animal.says(&#39;hi&#39;)  //animal says hi</code></pre><p>å½“æˆ‘ä»¬ä½¿ç”¨ç®­å¤´å‡½æ•°æ—¶ï¼Œå‡½æ•°ä½“å†…çš„thiså¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚<br>å¹¶ä¸æ˜¯å› ä¸ºç®­å¤´å‡½æ•°å†…éƒ¨æœ‰ç»‘å®šthisçš„æœºåˆ¶ï¼Œå®é™…åŸå› æ˜¯ç®­å¤´å‡½æ•°æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„thisï¼Œå®ƒçš„thisæ˜¯ç»§æ‰¿å¤–é¢çš„ï¼Œå› æ­¤å†…éƒ¨çš„thiså°±æ˜¯å¤–å±‚ä»£ç å—çš„thisã€‚</p><h2 id="template-string-å­—ç¬¦ä¸²æ¨¡æ¿"><a href="#template-string-å­—ç¬¦ä¸²æ¨¡æ¿" class="headerlink" title="template string(å­—ç¬¦ä¸²æ¨¡æ¿)"></a>template string(å­—ç¬¦ä¸²æ¨¡æ¿)</h2><p>è¿™ä¸ªä¸œè¥¿ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨ï¼Œå½“æˆ‘ä»¬è¦æ’å…¥å¤§æ®µçš„htmlå†…å®¹åˆ°æ–‡æ¡£ä¸­æ—¶ï¼Œä¼ ç»Ÿçš„å†™æ³•éå¸¸éº»çƒ¦ï¼Œæ‰€ä»¥ä¹‹å‰æˆ‘ä»¬é€šå¸¸ä¼šå¼•ç”¨ä¸€äº›æ¨¡æ¿å·¥å…·åº“ï¼Œæ¯”å¦‚mustacheç­‰ç­‰ã€‚</p><pre><code class="javascript">//es5$(&quot;#result&quot;).append(  &quot;There are &lt;b&gt;&quot; + basket.count + &quot;&lt;/b&gt; &quot; +  &quot;items in your basket, &quot; +  &quot;&lt;em&gt;&quot; + basket.onSale +  &quot;&lt;/em&gt; are on sale!&quot;);//es6$(&quot;#result&quot;).append(`  There are &lt;b&gt;${basket.count}&lt;/b&gt; items   in your basket, &lt;em&gt;${basket.onSale}&lt;/em&gt;  are on sale!`);</code></pre><p>ç”¨åå¼•å·<code>ï¼ˆ\ï¼‰</code>æ¥æ ‡è¯†èµ·å§‹ï¼Œç”¨${}`æ¥å¼•ç”¨å˜é‡ï¼Œè€Œä¸”æ‰€æœ‰çš„ç©ºæ ¼å’Œç¼©è¿›éƒ½ä¼šè¢«ä¿ç•™åœ¨è¾“å‡ºä¹‹ä¸­ï¼Œæ˜¯ä¸æ˜¯éå¸¸çˆ½ï¼Ÿï¼</p><p>React Routerä»ç¬¬1.0.3ç‰ˆå¼€å§‹ä¹Ÿä½¿ç”¨ES6è¯­æ³•äº†ï¼Œæ¯”å¦‚è¿™ä¸ªä¾‹å­ï¼š</p><pre><code class="javascript">&lt;Link to={`/taco/${taco.name}`}&gt;{taco.name}&lt;/Link&gt;</code></pre><h2 id="destructuring-è§£æ„èµ‹å€¼"><a href="#destructuring-è§£æ„èµ‹å€¼" class="headerlink" title="destructuring(è§£æ„èµ‹å€¼)"></a>destructuring(è§£æ„èµ‹å€¼)</h2><p>ES6å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ï¼ˆDestructuringï¼‰ã€‚</p><pre><code class="javascript">// es5let cat = &#39;ken&#39;let dog = &#39;lili&#39;let zoo = {cat: cat, dog: dog}console.log(zoo)  //Object {cat: &quot;ken&quot;, dog: &quot;lili&quot;}// es6let cat = &#39;ken&#39;let dog = &#39;lili&#39;let zoo = {cat, dog}console.log(zoo)  //Object {cat: &quot;ken&quot;, dog: &quot;lili&quot;}//åè¿‡æ¥å¯ä»¥è¿™æ ·å†™let dog = {type: &#39;animal&#39;, many: 2}let { type, many} = dogconsole.log(type, many)   //animal 2</code></pre><h2 id="default-rest"><a href="#default-rest" class="headerlink" title="default,rest"></a>default,rest</h2><p>defaultå¾ˆç®€å•ï¼Œæ„æ€å°±æ˜¯é»˜è®¤å€¼ã€‚å¤§å®¶å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œè°ƒç”¨<code>animal()</code>æ–¹æ³•æ—¶å¿˜äº†ä¼ å‚æ•°ï¼Œä¼ ç»Ÿçš„åšæ³•å°±æ˜¯åŠ ä¸Šè¿™ä¸€å¥<code>type = type || &#39;cat&#39;</code> æ¥æŒ‡å®šé»˜è®¤å€¼ã€‚</p><pre><code class="javascript">//es5function animal(type){    type = type || &#39;cat&#39;      console.log(type)}animal()//es6function animal(type = &#39;cat&#39;){    console.log(type)}animal()</code></pre><p>æœ€åä¸€ä¸ªrestè¯­æ³•ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥çœ‹ä¾‹å­ï¼š</p><pre><code class="javascript">function animals(...types){    console.log(types)}animals(&#39;cat&#39;, &#39;dog&#39;, &#39;fish&#39;) //[&quot;cat&quot;, &quot;dog&quot;, &quot;fish&quot;]</code></pre><p>å¦‚æœä¸ç”¨es6ä¸­çš„å±æ€§ï¼Œå¯ä»¥ç”¨ES5ä¸­çš„<code>argumnets</code></p><p><a href="https://segmentfault.com/a/1190000004365693" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodeå…¥é—¨</title>
      <link href="/2018/03/28/Node/Node%E5%85%A5%E9%97%A8/"/>
      <url>/2018/03/28/Node/Node%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯Node-js"><a href="#ä»€ä¹ˆæ˜¯Node-js" class="headerlink" title="ä»€ä¹ˆæ˜¯Node.js"></a>ä»€ä¹ˆæ˜¯Node.js</h1><p>æŒ‰ç…§ Node.jså®˜æ–¹ç½‘ç«™ä¸»é¡µ çš„è¯´æ³•:</p><blockquote><p>Node.jsÂ® is a JavaScript runtime built on Chromeâ€™s V8 JavaScript engine. Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient. Node.jsâ€™ package ecosystem, npm, is the largest ecosystem of open source libraries in the world.<br>ä»ä¸Šé¢è¿™æ®µè¯æ¥çœ‹ï¼š<br>1.Node.js ä¸æ˜¯ JavaScript åº”ç”¨ï¼Œä¸æ˜¯è¯­è¨€ï¼ˆJavaScript æ˜¯è¯­è¨€ï¼‰ï¼Œä¸æ˜¯åƒ Rails(Ruby)ã€ Laravel(PHP) æˆ– Django(Python) ä¸€æ ·çš„æ¡†æ¶ï¼Œä¹Ÿä¸æ˜¯åƒ Nginx ä¸€æ ·çš„ Web æœåŠ¡å™¨ã€‚Node.js æ˜¯ JavaScript è¿è¡Œæ—¶ç¯å¢ƒ</p></blockquote><p>2.æ„å»ºåœ¨ Chromeâ€™s V8 è¿™ä¸ªè‘—åçš„ JavaScript å¼•æ“ä¹‹ä¸Šï¼ŒChrome V8 å¼•æ“ä»¥ C/C++ ä¸ºä¸»ï¼Œç›¸å½“äºä½¿ç”¨JavaScript å†™æ³•ï¼Œè½¬æˆ C/C++ è°ƒç”¨ï¼Œå¤§å¤§çš„é™ä½äº†å­¦ä¹ æˆæœ¬</p><p>3.äº‹ä»¶é©±åŠ¨ï¼ˆevent-drivenï¼‰ï¼Œéé˜»å¡ I/O æ¨¡å‹ï¼ˆnon-blocking I/O modelï¼‰ï¼Œç®€å•ç‚¹è®²å°±æ˜¯æ¯ä¸ªå‡½æ•°éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œæœ€åç”± Libuv è¿™ä¸ª C/C++ ç¼–å†™çš„äº‹ä»¶å¾ªç¯å¤„ç†åº“æ¥å¤„ç†è¿™äº› I/O æ“ä½œï¼Œéšè—äº†éé˜»å¡ I/O çš„å…·ä½“ç»†èŠ‚ï¼Œç®€åŒ–å¹¶å‘ç¼–ç¨‹æ¨¡å‹ï¼Œè®©ä½ å¯ä»¥è½»æ¾çš„ç¼–å†™é«˜æ€§èƒ½çš„Webåº”ç”¨ï¼Œæ‰€ä»¥å®ƒæ˜¯è½»é‡ï¼ˆlightweightï¼‰ä¸”é«˜æ•ˆï¼ˆefficientï¼‰çš„</p><p>4.ä½¿ç”¨ npm ä½œä¸ºåŒ…ç®¡ç†å™¨ï¼Œç›®å‰ npm æ˜¯å¼€æºåº“é‡ŒåŒ…ç®¡ç†æœ€å¤§çš„ç”Ÿæ€ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œæˆªæ­¢åˆ°2017å¹´12æœˆï¼Œæ¨¡å—æ•°é‡è¶…è¿‡ 60 ä¸‡+</p><p>å¤§å¤šæ•°äººéƒ½è®¤ä¸º Node.js åªèƒ½å†™ç½‘ç«™åå°æˆ–è€…å‰ç«¯å·¥å…·ï¼Œè¿™å…¶å®æ˜¯ä¸å…¨é¢çš„ï¼ŒNode.jsçš„ç›®æ ‡æ˜¯è®©å¹¶å‘ç¼–ç¨‹æ›´ç®€å•ï¼Œä¸»è¦åº”ç”¨åœ¨ä»¥ç½‘ç»œç¼–ç¨‹ä¸ºä¸»çš„ I/O å¯†é›†å‹åº”ç”¨ã€‚å®ƒæ˜¯å¼€æºçš„ï¼Œè·¨å¹³å°ï¼Œå¹¶ä¸”é«˜æ•ˆï¼ˆå°¤å…¶æ˜¯I/Oå¤„ç†ï¼‰ï¼ŒåŒ…æ‹¬IBMã€Microsoftã€Yahooã€SAPã€PayPalã€æ²ƒå°”ç›åŠGoDaddyéƒ½æ˜¯ Node.js çš„ç”¨æˆ·ã€‚</p><a id="more"></a><h2 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h2><p>ä¸‹é¢æ˜¯ä¸€å¼  Node.js æ—©æœŸçš„æ¶æ„å›¾ï¼Œæ¥è‡ª Node.js ä¹‹çˆ¶ Ryan Dahl çš„æ¼”è®²ç¨¿ï¼Œåœ¨ä»Šå¤©ä¾ç„¶ä¸è¿‡æ—¶ï¼Œå®ƒç®€è¦çš„ä»‹ç»äº† Node.js æ˜¯åŸºäº Chrome V8å¼•æ“æ„å»ºçš„ï¼Œç”±äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰åˆ†å‘ I/O ä»»åŠ¡ï¼Œæœ€ç»ˆå·¥ä½œçº¿ç¨‹ï¼ˆWork Threadï¼‰å°†ä»»åŠ¡ä¸¢åˆ°çº¿ç¨‹æ± ï¼ˆThread Poolï¼‰é‡Œå»æ‰§è¡Œï¼Œè€Œäº‹ä»¶å¾ªç¯åªè¦ç­‰å¾…æ‰§è¡Œç»“æœå°±å¯ä»¥äº†ã€‚</p><p><img src="https://i5ting.github.io/How-to-learn-node-correctly/media/14912707129964/14912763353044.png" alt="node1"></p><blockquote><p>æ ¸å¿ƒæ¦‚å¿µ:<br>1.Chrome V8 æ˜¯ Google å‘å¸ƒçš„å¼€æº JavaScript å¼•æ“ï¼Œé‡‡ç”¨ C/C++ ç¼–å†™ï¼Œåœ¨ Google çš„ Chrome æµè§ˆå™¨ä¸­è¢«ä½¿ç”¨ã€‚Chrome V8 å¼•æ“å¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åµŒå…¥åˆ° C/C++ åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œã€‚<br>2.Event Loop äº‹ä»¶å¾ªç¯ï¼ˆç”± libuv æä¾›ï¼‰<br>3.Thread Pool çº¿ç¨‹æ± ï¼ˆç”± libuv æä¾›ï¼‰</p></blockquote><p>æ¢³ç†åå¯ä»¥è¿™æ ·ç†è§£ï¼š<br>1.Chrome V8 æ˜¯ JavaScript å¼•æ“<br>2.Node.js å†…ç½® Chrome V8 å¼•æ“ï¼Œæ‰€ä»¥å®ƒä½¿ç”¨çš„ JavaScript è¯­æ³•<br>3.JavaScript è¯­è¨€çš„ä¸€å¤§ç‰¹ç‚¹å°±æ˜¯å•çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªæ—¶é—´åªèƒ½åšä¸€ä»¶äº‹<br>4å•çº¿ç¨‹å°±æ„å‘³ç€ï¼Œæ‰€æœ‰ä»»åŠ¡éœ€è¦æ’é˜Ÿï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸï¼Œæ‰ä¼šæ‰§è¡Œåä¸€ä¸ªä»»åŠ¡ã€‚å¦‚æœå‰ä¸€ä¸ªä»»åŠ¡è€—æ—¶å¾ˆé•¿ï¼Œåä¸€ä¸ªä»»åŠ¡å°±ä¸å¾—ä¸ä¸€ç›´ç­‰ç€ã€‚<br>5.å¦‚æœæ’é˜Ÿæ˜¯å› ä¸ºè®¡ç®—é‡å¤§ï¼ŒCPU å¿™ä¸è¿‡æ¥ï¼Œå€’ä¹Ÿç®—äº†ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ CPU æ˜¯é—²ç€çš„ï¼Œå› ä¸º I/O å¾ˆæ…¢ï¼Œä¸å¾—ä¸ç­‰ç€ç»“æœå‡ºæ¥ï¼Œå†å¾€ä¸‹æ‰§è¡Œ<br>6.CPU å®Œå…¨å¯ä»¥ä¸ç®¡ I/O è®¾å¤‡ï¼ŒæŒ‚èµ·å¤„äºç­‰å¾…ä¸­çš„ä»»åŠ¡ï¼Œå…ˆè¿è¡Œæ’åœ¨åé¢çš„ä»»åŠ¡<br>7.å°†ç­‰å¾…ä¸­çš„ I/O ä»»åŠ¡æ”¾åˆ° Event Loop é‡Œ<br>8.ç”± Event Loop å°† I/O ä»»åŠ¡æ”¾åˆ°çº¿ç¨‹æ± é‡Œ<br>  åªè¦æœ‰èµ„æºï¼Œå°±å°½åŠ›æ‰§è¡Œ</p><h2 id="å­¦ä¹ -Node-js-çš„ä¸‰ä¸ªå¢ƒç•Œ"><a href="#å­¦ä¹ -Node-js-çš„ä¸‰ä¸ªå¢ƒç•Œ" class="headerlink" title="å­¦ä¹  Node.js çš„ä¸‰ä¸ªå¢ƒç•Œ"></a>å­¦ä¹  Node.js çš„ä¸‰ä¸ªå¢ƒç•Œ</h2><p>1.æ‰“æ—¥å¿— console.log<br>2.æ–­ç‚¹è°ƒè¯•ï¼šæ–­ç‚¹è°ƒè¯•ï¼šnode debugger æˆ–node inspector æˆ–vscode<br>3.æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆtdd | bddï¼‰</p><h2 id="å®‰è£…Node-jsç¯å¢ƒ"><a href="#å®‰è£…Node-jsç¯å¢ƒ" class="headerlink" title="å®‰è£…Node.jsç¯å¢ƒ"></a>å®‰è£…Node.jsç¯å¢ƒ</h2><p>3må®‰è£…æ³•</p><p>nvmï¼ˆnode version managerï¼‰ã€éœ€è¦ä½¿ç”¨npmå®‰è£…ï¼Œæ›¿ä»£å“æ˜¯yrmï¼ˆæ”¯æŒyarnï¼‰ã€‘<br>nrmï¼ˆnode registry managerï¼‰ã€éœ€è¦ä½¿ç”¨npmå®‰è£…ï¼Œæ›¿ä»£å“æ˜¯yrmï¼ˆæ”¯æŒyarnï¼‰ã€‘<br>npmï¼ˆnode packages managerï¼‰ã€å†…ç½®ï¼Œæ›¿ä»£å“æ˜¯næˆ–nvsï¼ˆå¯¹winä¹Ÿæ”¯æŒï¼‰ã€‘</p><h2 id="Node-jsåº”ç”¨åœºæ™¯"><a href="#Node-jsåº”ç”¨åœºæ™¯" class="headerlink" title="Node.jsåº”ç”¨åœºæ™¯"></a>Node.jsåº”ç”¨åœºæ™¯</h2><p>ã€ŠNode.js in actionã€‹ä¸€ä¹¦é‡Œè¯´ï¼ŒNode.js æ‰€é’ˆå¯¹çš„åº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªä¸“é—¨çš„ç®€ç§°ï¼š<strong>DIRT</strong>ã€‚å®ƒè¡¨ç¤ºæ•°æ®å¯†é›†å‹å®æ—¶ï¼ˆdata-intensive real-timeï¼‰ç¨‹åºã€‚å› ä¸º Node.js è‡ªèº«åœ¨ I/O ä¸Šéå¸¸è½»é‡ï¼Œå®ƒå–„äºå°†æ•°æ®ä»ä¸€ä¸ªç®¡é“æ··æ’æˆ–ä»£ç†åˆ°å¦ä¸€ä¸ªç®¡é“ä¸Šï¼Œè¿™èƒ½åœ¨å¤„ç†å¤§é‡è¯·æ±‚æ—¶æŒæœ‰å¾ˆå¤šå¼€æ”¾çš„è¿æ¥ï¼Œå¹¶ä¸”åªå ç”¨ä¸€å°éƒ¨åˆ†å†…å­˜ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯ä¿è¯å“åº”èƒ½åŠ›ï¼Œè·Ÿæµè§ˆå™¨ä¸€æ ·ã€‚</p><p>è¿™è¯ä¸å‡ï¼Œä½†åœ¨ä»Šå¤©æ¥çœ‹ï¼ŒDIRT è¿˜æ˜¯èŒƒå›´å°äº†ã€‚å…¶å® DIRT æœ¬è´¨ä¸Šè¯´çš„ I/O å¤„ç†çš„éƒ½ç®—ï¼Œä½†éšç€å¤§å‰ç«¯çš„å‘å±•ï¼ŒNode.js å·²ç»ä¸å†åªæ˜¯ I/O å¤„ç†ç›¸å…³ï¼Œè€Œæ˜¯æ›´åŠ çš„â€œNodeâ€ï¼</p><p>Node.js ä½¿ç”¨åœºæ™¯ä¸»è¦åˆ†ä¸º4å¤§ç±»<br><img src="https://i5ting.github.io/How-to-learn-node-correctly/media/14912707129964/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-05-17%2007.25.05.png" alt="node2"></p><p>1ï¼‰è·¨å¹³å°ï¼šè¦†ç›–ä½ èƒ½æƒ³åˆ°çš„é¢å‘ç”¨æˆ·çš„æ‰€æœ‰å¹³å°ï¼Œä¼ ç»Ÿçš„PC Webç«¯ï¼Œä»¥åŠPCå®¢æˆ·ç«¯ nw.js/electron ã€ç§»åŠ¨ç«¯ cordovaã€HTML5ã€react-nativeã€weexï¼Œç¡¬ä»¶ ruff.io ç­‰<br>2ï¼‰Webåº”ç”¨å¼€å‘ï¼šç½‘ç«™ã€Apiã€RPCæœåŠ¡ç­‰<br>3ï¼‰å‰ç«¯ï¼šä¸‰å¤§æ¡†æ¶ React \ Vue \ Angular è¾…åŠ©å¼€å‘ï¼Œä»¥åŠå·¥ç¨‹åŒ–æ¼”è¿›è¿‡ç¨‹ï¼ˆä½¿ç”¨Gulp /Webpack æ„å»º Web å¼€å‘å·¥å…·ï¼‰<br>4ï¼‰å·¥å…·ï¼šnpmä¸Šå„ç§å·¥å…·æ¨¡å—ï¼ŒåŒ…æ‹¬å„ç§å‰ç«¯é¢„ç¼–è¯‘ã€æ„å»ºå·¥å…· Grunt / Gulpã€è„šæ‰‹æ¶ï¼Œå‘½ä»¤è¡Œå·¥å…·ï¼Œå„ç§å¥‡æŠ€æ·«å·§ç­‰</p><table><thead><tr><th>åˆ†ç±»</th><th style="text-align:right">æè¿°</th><th style="text-align:center">ç›¸å…³æ¨¡å—</th></tr></thead><tbody><tr><td>ç½‘ç«™</td><td style="text-align:right">ç±»ä¼¼äº cnodejs.org è¿™æ ·ä¼ ç»Ÿçš„ç½‘ç«™</td><td style="text-align:center">Express / Koa</td></tr><tr><td>Api</td><td style="text-align:right">åŒæ—¶æä¾›ç»™ç§»åŠ¨ç«¯ï¼ŒPCï¼ŒH5 ç­‰å‰ç«¯ä½¿ç”¨çš„ HTTP Api æ¥å£</td><td style="text-align:center">Restify / HApi</td></tr><tr><td>Apiä»£ç†</td><td style="text-align:right">ä¸ºå‰ç«¯æä¾›çš„ï¼Œä¸»è¦å¯¹åç«¯Apiæ¥å£è¿›è¡Œå†å¤„ç†ï¼Œä»¥ä¾¿æ›´å¤šçš„é€‚åº”å‰ç«¯å¼€å‘</td><td style="text-align:center">Express / Koa</td></tr><tr><td>IMå³æ—¶èŠå¤©</td><td style="text-align:right">å®æ—¶åº”ç”¨ï¼Œå¾ˆå¤šæ˜¯åŸºäº WebSocketåè®®çš„</td><td style="text-align:center">Socket.io / sockjs</td></tr><tr><td>åå‘ä»£ç†</td><td style="text-align:right">æä¾›ç±»ä¼¼äº nginx åå‘ä»£ç†åŠŸèƒ½ï¼Œä½†å¯¹å‰ç«¯æ›´å‹å¥½</td><td style="text-align:center">anyproxy / node-http-proxy / hiproxy</td></tr><tr><td>å‰ç«¯æ„å»ºå·¥å…·</td><td style="text-align:right">è¾…åŠ©å‰ç«¯å¼€å‘ï¼Œå°¤å…¶æ˜¯å„ç§é¢„ç¼–è¯‘ï¼Œæ„å»ºç›¸å…³çš„å·¥å…·ï¼Œèƒ½å¤Ÿæå¤§çš„æé«˜å‰ç«¯å¼€å‘æ•ˆç‡</td><td style="text-align:center">Grunt / Gulp / Bower / Webpack / Fis3 / YKit</td></tr><tr><td>å‘½ä»¤è¡Œå·¥å…·</td><td style="text-align:right">ä½¿ç”¨å‘½ä»¤è¡Œæ˜¯éå¸¸é…·çš„æ–¹å¼ï¼Œå‰ç«¯å¼€å‘è‡ªå®šä¹‰äº†å¾ˆå¤šç›¸å…³å·¥å…·ï¼Œæ— è®ºæ˜¯shellå‘½ä»¤ï¼Œnodeè„šæœ¬ï¼Œè¿˜æ˜¯å„ç§è„šæ‰‹æ¶ç­‰ï¼Œå‡ ä¹æ¯ä¸ªå…¬å¸\å°ç»„éƒ½ä¼šè‡ªå·±çš„å‘½ä»¤è¡Œå·¥å…·é›†</td><td style="text-align:center">Cordova / Shell.js</td></tr><tr><td>æ“ä½œç³»ç»Ÿ</td><td style="text-align:right">æœ‰å®ç°ï¼Œä½†ä¼°è®¡ä¸å¤ªä¼šæœ‰äººç”¨</td><td style="text-align:center">NodeOS</td></tr><tr><td>è·¨å¹³å°æ‰“åŒ…å·¥å…·</td><td style="text-align:right">ä½¿ç”¨ Web å¼€å‘æŠ€æœ¯å¼€å‘PCå®¢æˆ·ç«¯æ˜¯ç›®å‰æœ€æµè¡Œçš„æ–¹å¼ï¼Œä¼šæœ‰æ›´å¤šå‰ç«¯å¼€å‘å·¥å…·æ˜¯é‡‡ç”¨è¿™ç§æ–¹å¼çš„</td><td style="text-align:center">PCç«¯çš„electronã€nw.jsï¼Œæ¯”å¦‚é’‰é’‰PCå®¢æˆ·ç«¯ã€å¾®ä¿¡å°ç¨‹åºIDEã€å¾®ä¿¡å®¢æˆ·ç«¯ï¼Œç§»åŠ¨çš„Cordovaï¼Œå³è€çš„Phonegapï¼Œè¿˜æœ‰æ›´åŠ æœ‰åçš„ä¸€ç«™å¼å¼€å‘æ¡†æ¶Ionicframework</td></tr><tr><td>P2P</td><td style="text-align:right">åŒºå—é“¾å¼€å‘ã€BTå®¢æˆ·ç«¯</td><td style="text-align:center">webtorrent / ipfs</td></tr><tr><td>ç¼–è¾‘å™¨</td><td style="text-align:right">Atom å’Œ VSCode éƒ½æ˜¯åŸºäº electron æ¨¡å—çš„</td><td style="text-align:center">electron</td></tr><tr><td>ç‰©è”ç½‘ä¸ç¡¬ä»¶</td><td style="text-align:right">ruff.ioå’Œå¾ˆå¤šç¡¬ä»¶éƒ½æ”¯æŒnode sdk</td><td style="text-align:center">ruff</td></tr></tbody></table><p>Node.js åº”ç”¨åœºæ™¯éå¸¸ä¸°å¯Œï¼Œæ¯”å¦‚ Node.js å¯ä»¥å¼€å‘æ“ä½œç³»ç»Ÿï¼Œä½†ä¸€èˆ¬æˆ‘éƒ½ä¸è®²çš„ï¼Œå°±ç®—è¯´äº†ä¹Ÿæ²¡å¤šå¤§æ„ä¹‰ï¼Œéš¾é“å¤§å®¶çœŸçš„ä¼šç”¨å—ï¼Ÿä¸€èˆ¬ï¼Œæˆ‘ä¹ æƒ¯å°† Node.js åº”ç”¨åœºæ™¯åˆ†ä¸º7ä¸ªéƒ¨åˆ†ã€‚</p><p>1ï¼‰åˆè¡·ï¼Œserverç«¯ï¼Œä¸æƒ³æˆäº†å‰ç«¯å¼€å‘çš„åŸºç¡€è®¾æ–½<br>2ï¼‰å‘½ä»¤è¡Œè¾…åŠ©å·¥å…·ï¼Œç”šè‡³å¯ä»¥æ˜¯è¿ç»´<br>3ï¼‰ç§»åŠ¨ç«¯ï¼šcordovaï¼Œpcç«¯ï¼šnw.jså’Œelectron<br>4ï¼‰ç»„ä»¶åŒ–ï¼Œæ„å»ºï¼Œä»£ç†<br>5ï¼‰æ¶æ„ï¼Œå‰åç«¯åˆ†ç¦»ã€api proxy<br>6ï¼‰æ€§èƒ½ä¼˜åŒ–ã€åçˆ¬è™«ä¸çˆ¬è™«<br>7) å…¨æ ˆæœ€ä¾¿æ·ä¹‹è·¯</p><h2 id="Nodeæ ¸å¿ƒï¼šå¼‚æ­¥æµç¨‹æ§åˆ¶"><a href="#Nodeæ ¸å¿ƒï¼šå¼‚æ­¥æµç¨‹æ§åˆ¶" class="headerlink" title="Nodeæ ¸å¿ƒï¼šå¼‚æ­¥æµç¨‹æ§åˆ¶"></a>Nodeæ ¸å¿ƒï¼šå¼‚æ­¥æµç¨‹æ§åˆ¶</h2><p>Node.jsæ˜¯ä¸ºå¼‚æ­¥è€Œç”Ÿçš„ï¼Œå®ƒè‡ªå·±æŠŠå¤æ‚çš„äº‹å„¿åšäº†ï¼ˆé«˜å¹¶å‘ï¼Œä½å»¶æ—¶ï¼‰ï¼Œäº¤ç»™ç”¨æˆ·çš„åªæ˜¯æœ‰ç‚¹éš¾ç”¨çš„Callbackå†™æ³•ã€‚ä¹Ÿæ­£æ˜¯å¦è¯šçš„å°†å¼‚æ­¥å›è°ƒæš´éœ²å‡ºæ¥ï¼Œæ‰æœ‰æ›´å¥½çš„æµç¨‹æ§åˆ¶æ–¹é¢çš„æ¼”è¿›ã€‚ä¹Ÿæ­£æ˜¯è¿™äº›æ¼”è¿›ï¼Œè®©Node.jsä»DIRTï¼ˆæ•°æ®æ•æ„Ÿå®æ—¶åº”ç”¨ï¼‰æ‰©å±•åˆ°æ›´å¤šçš„åº”ç”¨åœºæ™¯ï¼Œä»Šå¤©çš„Node.jså·²ç»ä¸åªæ˜¯èƒ½å†™åç«¯çš„JavaScriptï¼Œå·²ç»æ¶µç›–äº†æ‰€æœ‰æ¶‰åŠåˆ°å¼€å‘çš„å„ä¸ªæ–¹é¢ï¼Œè€ŒNodeå…¨æ ˆæ›´æ˜¯çƒ­é—¨ç§çš„çƒ­é—¨ã€‚</p><p>ç›´é¢é—®é¢˜æ‰èƒ½æœ‰æ›´å¥½çš„è§£å†³æ–¹å¼ï¼ŒNode.jsçš„å¼‚æ­¥æ˜¯æ•´ä¸ªå­¦ä¹ Node.jsè¿‡ç¨‹ä¸­é‡ä¸­ä¹‹é‡ã€‚</p><p><strong>1) å¼‚æ­¥æµç¨‹æ§åˆ¶å­¦ä¹ é‡ç‚¹</strong><br><strong>2ï¼‰Apiå†™æ³•ï¼šError-first Callback å’Œ EventEmitter</strong><br><strong>3ï¼‰ä¸­æµç ¥æŸ±ï¼šPromise</strong><br><strong>4ï¼‰ç»ˆæè§£å†³æ–¹æ¡ˆï¼šAsync/Await</strong></p><h2 id="å¼‚æ­¥æµç¨‹æ§åˆ¶å­¦ä¹ é‡ç‚¹"><a href="#å¼‚æ­¥æµç¨‹æ§åˆ¶å­¦ä¹ é‡ç‚¹" class="headerlink" title="å¼‚æ­¥æµç¨‹æ§åˆ¶å­¦ä¹ é‡ç‚¹"></a>å¼‚æ­¥æµç¨‹æ§åˆ¶å­¦ä¹ é‡ç‚¹</h2><p>æˆ‘æ•´ç†äº†ä¸€å¼ å›¾ï¼Œæ›´ç›´è§‚ä¸€äº›ã€‚ä»09å¹´åˆ°ç°åœ¨ï¼Œ8å¹´å¤šçš„æ—¶é—´é‡Œï¼Œæ•´ä¸ªNode.jsç¤¾åŒºåšäº†å¤§é‡å°è¯•ï¼Œå…¶ä¸­æ›²æŠ˜è¶³è¶³å¤Ÿå†™ä¸€æœ¬ä¹¦çš„äº†ã€‚å¤§å®¶å…ˆç®€å•äº†è§£ä¸€ä¸‹ã€‚</p><p><img src="https://i5ting.github.io/How-to-learn-node-correctly/media/14913280187332/Screen%20Shot%202017-04-05%20at%2008.43.08.png" alt="Node3"></p><p>çº¢è‰²ä»£è¡¨Promiseï¼Œæ˜¯ä½¿ç”¨æœ€å¤šçš„ï¼Œæ— è®ºasyncè¿˜æ˜¯generatoréƒ½å¯ç”¨<br>è“è‰²æ˜¯Generatorï¼Œè¿‡åº¦è´§<br>ç»¿è‰²æ˜¯Asyncå‡½æ•°ï¼Œè¶‹åŠ¿</p><p><em>ç»“è®º</em>ï¼šPromiseæ˜¯å¿…é¡»ä¼šçš„ï¼Œé‚£ä½ ä¸ºä»€ä¹ˆä¸é¡ºåŠ¿è€Œä¸ºå‘¢ï¼Ÿ</p><p><em>æ¨è</em>ï¼šä½¿ç”¨Asyncå‡½æ•° + Promiseç»„åˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p>å…¶å®ï¼Œä¸€èˆ¬ä½¿ç”¨æ˜¯ä¸éœ€è¦æŒæ¡ä¸Šå›¾ä¸­çš„æ‰€æœ‰æŠ€æœ¯çš„ã€‚å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œå…ˆå¤Ÿç”¨ï¼Œå†å»æ·±ç©¶ç»†èŠ‚ã€‚æ‰€ä»¥ï¼Œç²¾ç®€ä¸€ä¸‹ï¼Œåªäº†è§£3ä¸ªå°±è¶³å¤Ÿè¶³å¤Ÿç”¨äº†ã€‚<br><img src="https://i5ting.github.io/How-to-learn-node-correctly/media/14913280187332/Screen%20Shot%202017-04-05%20at%2008.43.34.png" alt="Node4"></p><p>ç»“è®º</p><p>1.Node.js SDKé‡Œcallbackå†™æ³•å¿…é¡»ä¼šçš„ã€‚<br>2.Node.jså­¦ä¹ é‡ç‚¹: Asyncå‡½æ•°ä¸Promise<br> 2.1ä¸­æµç ¥æŸ±ï¼šPromise<br> 2.2ç»ˆæè§£å†³æ–¹æ¡ˆï¼šAsync/Await</p><h2 id="Apiå†™æ³•ï¼šError-first-Callback-å’Œ-EventEmitter"><a href="#Apiå†™æ³•ï¼šError-first-Callback-å’Œ-EventEmitter" class="headerlink" title="Apiå†™æ³•ï¼šError-first Callback å’Œ EventEmitter"></a>Apiå†™æ³•ï¼šError-first Callback å’Œ EventEmitter</h2><h3 id="Error-first-Callback-å®šä¹‰é”™è¯¯ä¼˜å…ˆçš„å›è°ƒå†™æ³•åªéœ€è¦æ³¨æ„2æ¡è§„åˆ™å³å¯ï¼š"><a href="#Error-first-Callback-å®šä¹‰é”™è¯¯ä¼˜å…ˆçš„å›è°ƒå†™æ³•åªéœ€è¦æ³¨æ„2æ¡è§„åˆ™å³å¯ï¼š" class="headerlink" title="Error-first Callback å®šä¹‰é”™è¯¯ä¼˜å…ˆçš„å›è°ƒå†™æ³•åªéœ€è¦æ³¨æ„2æ¡è§„åˆ™å³å¯ï¼š"></a>Error-first Callback å®šä¹‰é”™è¯¯ä¼˜å…ˆçš„å›è°ƒå†™æ³•åªéœ€è¦æ³¨æ„2æ¡è§„åˆ™å³å¯ï¼š</h3><p>1.å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿”å›çš„errorå¯¹è±¡ï¼Œå¦‚æœerrorå‘ç”Ÿäº†ï¼Œå®ƒä¼šä½œä¸ºç¬¬ä¸€ä¸ªerrå‚æ•°è¿”å›ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä¸€èˆ¬åšæ³•æ˜¯è¿”å›nullã€‚<br>2.å›è°ƒå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°è¿”å›çš„æ˜¯ä»»ä½•æˆåŠŸå“åº”çš„ç»“æœæ•°æ®ã€‚å¦‚æœç»“æœæ­£å¸¸ï¼Œæ²¡æœ‰errorå‘ç”Ÿï¼Œerrä¼šè¢«è®¾ç½®ä¸ºnullï¼Œå¹¶åœ¨ç¬¬äºŒä¸ªå‚æ•°å°±å‡ºè¿”å›æˆåŠŸç»“æœæ•°æ®ã€‚</p><p>ä¸‹é¢è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è°ƒç”¨å‡½æ•°ç¤ºä¾‹ï¼ŒNode.js æ–‡æ¡£é‡Œæœ€å¸¸é‡‡ç”¨ä¸‹é¢è¿™æ ·çš„å›è°ƒæ–¹å¼ï¼š</p><pre><code class="javascript">    function(error,res){        //process the error and result    }</code></pre><p>è¿™é‡Œçš„ callback æŒ‡çš„æ˜¯å¸¦æœ‰2ä¸ªå‚æ•°çš„å‡½æ•°ï¼šâ€errâ€å’Œ â€œresâ€ã€‚è¯­ä¹‰ä¸Šè®²ï¼Œéç©ºçš„â€œerrâ€ç›¸å½“äºç¨‹åºå¼‚å¸¸ï¼›è€Œç©ºçš„â€œerrâ€ç›¸å½“äºå¯ä»¥æ­£å¸¸è¿”å›ç»“æœâ€œresâ€ï¼Œæ— ä»»ä½•å¼‚å¸¸ã€‚</p><h3 id="EventEmitter"><a href="#EventEmitter" class="headerlink" title="EventEmitter"></a>EventEmitter</h3><p>äº‹ä»¶æ¨¡å—æ˜¯ Node.js å†…ç½®çš„å¯¹è§‚å¯Ÿè€…æ¨¡å¼â€œå‘å¸ƒ/è®¢é˜…â€ï¼ˆpublish/subscribeï¼‰çš„å®ç°ï¼Œé€šè¿‡EventEmitterå±æ€§ï¼Œæä¾›äº†ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚è¯¥æ„é€ å‡½æ•°çš„å®ä¾‹å…·æœ‰ on æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥ç›‘å¬æŒ‡å®šäº‹ä»¶ï¼Œå¹¶è§¦å‘å›è°ƒå‡½æ•°ã€‚ä»»æ„å¯¹è±¡éƒ½å¯ä»¥å‘å¸ƒæŒ‡å®šäº‹ä»¶ï¼Œè¢« EventEmitter å®ä¾‹çš„ on æ–¹æ³•ç›‘å¬åˆ°ã€‚</p><p>åœ¨node 6ä¹‹åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨require(â€˜eventsâ€™)ç±»</p><pre><code class="javascript">var Emitter = require(&#39;events&#39;);var uilt = require(&#39;uilt&#39;);var myEmitter = function(){    util.inherits(MyEmitter, EventEmitter)    const myEmitter = new MyEmitter();    myEmitter.on(&#39;event&#39;, (a, b) =&gt; {    console.log(a, b, this);        // Prints: a b {}    });    myEmitter.emit(&#39;event&#39;, &#39;a&#39;, &#39;b&#39;);}</code></pre><p>å’Œjqueryã€vueé‡Œçš„Eventæ˜¯éå¸¸ç±»ä¼¼çš„ã€‚è€Œä¸”å‰ç«¯è‡ªå·±ä¹Ÿæœ‰EventEmitterã€‚</p><h3 id="å¦‚ä½•æ›´å¥½çš„æŸ¥Node-jsæ–‡æ¡£"><a href="#å¦‚ä½•æ›´å¥½çš„æŸ¥Node-jsæ–‡æ¡£" class="headerlink" title="å¦‚ä½•æ›´å¥½çš„æŸ¥Node.jsæ–‡æ¡£"></a>å¦‚ä½•æ›´å¥½çš„æŸ¥Node.jsæ–‡æ¡£</h3><p>APIæ˜¯åº”ç”¨ç¨‹åºæ¥å£Application Programming Interfaceçš„ç®€ç§°ã€‚ä»Node.jså¼‚æ­¥åŸç†ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ ¸å¿ƒåœ¨äº Node.js SDK ä¸­APIè°ƒç”¨ï¼Œç„¶åäº¤ç”±EventLoopï¼ˆLibuvï¼‰å»æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å®šè¦ç†Ÿæ‚‰Node.jsçš„APIæ“ä½œã€‚</p><p>Node.jsçš„APIéƒ½æ˜¯å¼‚æ­¥çš„ï¼ŒåŒæ­¥çš„å‡½æ•°æ˜¯å¥¢æ±‚ï¼Œè¦æŸ¥APIæ–‡æ¡£ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹æ…ç”¨ã€‚</p><p>ç¬”è€…æ¨èä½¿ç”¨ <font color = 'blue'>Dash</font> æˆ– <font color = 'blue'>Zeal</font> æŸ¥çœ‹ç¦»çº¿æ–‡æ¡£ï¼Œç»å¸¸æŸ¥çœ‹ç¦»çº¿æ–‡æ¡£ï¼Œå¯¹Apiç†è§£ä¼šæ·±å…¥å¾ˆå¤šï¼Œæ¯”IDEè¾…åŠ©è¦å¥½ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…ç¦»å¼€IDEå°±ä¸ä¼šå†™ä»£ç çš„çª˜å¢ƒã€‚</p><h2 id="ä¸­æµç ¥æŸ±ï¼šPromise"><a href="#ä¸­æµç ¥æŸ±ï¼šPromise" class="headerlink" title="ä¸­æµç ¥æŸ±ï¼šPromise"></a>ä¸­æµç ¥æŸ±ï¼šPromise</h2><p>Node.js å› ä¸ºé‡‡ç”¨äº†é”™è¯¯ä¼˜å…ˆçš„å›è°ƒé£æ ¼å†™æ³•ï¼Œå¯¼è‡´sdké‡Œå¯¼å‡ºéƒ½æ˜¯å›è°ƒå‡½æ•°ã€‚å¦‚æœç»„åˆè°ƒç”¨çš„è¯ï¼Œå°±ä¼šç‰¹åˆ«ç—›è‹¦ï¼Œç»å¸¸ä¼šå‡ºç°å›è°ƒé‡ŒåµŒå¥—å›è°ƒçš„é—®é¢˜ï¼Œå¤§å®¶éƒ½éå¸¸åŒçƒ¦è¿™ç§å†™æ³•ï¼Œç§°ä¹‹ä¸ºCallback Hellï¼Œå³å›è°ƒåœ°ç‹±ã€‚ä¸€ä¸ªç»å…¸çš„ä¾‹å­æ¥è‡ªè‘—åçš„Promiseæ¨¡å—qæ–‡æ¡£é‡Œã€‚</p><pre><code class="javascript">step1(function (value1) {    step2(value1, function(value2) {        step3(value2, function(value3) {            step4(value3, function(value4) {                // Do something with value4            });        });    });});</code></pre><p>è¿™é‡Œåªæ˜¯åš4æ­¥ï¼ŒåµŒå¥—äº†4å±‚å›è°ƒï¼Œå¦‚æœæ›´å¤šæ­¥éª¤å‘¢ï¼Ÿå¾ˆå¤šæ–°æ‰‹æµ…å°è¾„æ­¢ï¼Œåˆ°è¿™å„¿å°±æœ›è€Œå´æ­¥ï¼Œç²‰è½¬é»‘ã€‚è¿™æ˜æ˜¾ä¸å¤Ÿæˆç†Ÿï¼Œæœ€èµ·ç ä½ è¦çœ‹çœ‹å®ƒçš„åº”å¯¹è§£å†³æ–¹æ¡ˆå§ï¼</p><p>Node.js çº¦å®šæ‰€æœ‰Apiéƒ½é‡‡ç”¨é”™è¯¯ä¼˜å…ˆçš„å›è°ƒæ–¹å¼ï¼Œè¿™éƒ¨åˆ†åœºæ™¯éƒ½æ˜¯å¤§å®¶ç›´æ¥è°ƒç”¨æ¥å£ï¼Œæ— å¤ªå¤šå˜åŒ–ã€‚è€ŒPromiseæ˜¯å¯¹å›è°ƒåœ°ç‹±çš„æ€è€ƒï¼Œæˆ–è€…è¯´æ˜¯æ”¹è‰¯æ–¹æ¡ˆã€‚ç›®å‰ä½¿ç”¨éå¸¸æ™®éï¼Œå¯ä»¥è¯´æ˜¯åœ¨asyncå‡½æ•°æ™®åŠä¹‹å‰å”¯ä¸€ä¸€ä¸ªé€šç”¨æ€§è§„èŒƒï¼Œç”šè‡³ Node.js ç¤¾åŒºéƒ½åœ¨è€ƒè™‘ Promise åŒ–ï¼Œå¯è§å…¶å½±å“ä¹‹å¤§ã€‚</p><p>Promiseæ„å‘³ç€[è®¸æ„¿|æ‰¿è¯º]ä¸€ä¸ªè¿˜æ²¡æœ‰å®Œæˆçš„æ“ä½œï¼Œä½†åœ¨æœªæ¥ä¼šå®Œæˆçš„ã€‚ä¸Promiseæœ€ä¸»è¦çš„äº¤äº’æ–¹æ³•æ˜¯é€šè¿‡å°†å‡½æ•°ä¼ å…¥å®ƒçš„thenæ–¹æ³•ä»è€Œè·å–å¾—Promiseæœ€ç»ˆçš„å€¼æˆ–Promiseæœ€ç»ˆæœ€æ‹’ç»ï¼ˆrejectï¼‰çš„åŸå› ã€‚è¦ç‚¹æœ‰ä¸‰ä¸ªï¼š</p><p>é€’å½’ï¼Œæ¯ä¸ªå¼‚æ­¥æ“ä½œè¿”å›çš„éƒ½æ˜¯promiseå¯¹è±¡<br>çŠ¶æ€æœºï¼šä¸‰ç§çŠ¶æ€è½¬æ¢ï¼Œåªåœ¨promiseå¯¹è±¡å†…éƒ¨å¯ä»¥æ§åˆ¶ï¼Œå¤–éƒ¨ä¸èƒ½æ”¹å˜çŠ¶æ€<br>å…¨å±€å¼‚å¸¸å¤„ç†</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><pre><code class="javascript">var promise = new promise(function(resolve,reject){    // do a thing, possibly async, thenâ€¦    if (/* everything turned out fine */) {    resolve(&quot;Stuff worked!&quot;); //æˆåŠŸè¿”å›  }  else {    reject(Error(&quot;It broke&quot;));//å¤±è´¥è¿”å›  }})</code></pre><p>æ¯ä¸ªPromiseå®šä¹‰éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåœ¨æ„é€ å‡½æ•°é‡Œä¼ å…¥ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå‚æ•°æ˜¯resolveå’Œrejectï¼Œåˆ†åˆ«ä»£è¡¨æˆåŠŸå’Œå¤±è´¥æ—¶å€™çš„å¤„ç†ã€‚</p><h3 id="è°ƒç”¨"><a href="#è°ƒç”¨" class="headerlink" title="è°ƒç”¨"></a>è°ƒç”¨</h3><pre><code class="javascript">promise.then(function(text){    console.log(text)// Stuff worked!    return Promise.reject(new Error(&#39;æˆ‘æ˜¯æ•…æ„çš„&#39;))}).catch(function(err){    console.log(err)})</code></pre><p>å®ƒçš„ä¸»è¦äº¤äº’æ–¹å¼æ˜¯é€šè¿‡thenå‡½æ•°ï¼Œå¦‚æœPromiseæˆåŠŸæ‰§è¡Œresolveäº†ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå°†resolveçš„å€¼ä¼ ç»™æœ€è¿‘çš„thenå‡½æ•°ï¼Œä½œä¸ºå®ƒçš„thenå‡½æ•°çš„å‚æ•°ã€‚å¦‚æœå‡ºé”™rejectï¼Œé‚£å°±äº¤ç»™catchæ¥æ•è·å¼‚å¸¸å°±å¥½äº†ã€‚</p><p>Promise çš„æœ€å¤§ä¼˜åŠ¿æ˜¯æ ‡å‡†åŒ–ï¼Œå„ç±»å¼‚æ­¥å·¥å…·åº“éƒ½æŒ‰ç…§ç»Ÿä¸€è§„èŒƒå®ç°ï¼Œå³ä½¿æ˜¯asyncå‡½æ•°ä¹Ÿå¯ä»¥æ— ç¼é›†æˆã€‚æ‰€ä»¥ç”¨ Promise å°è£… API é€šç”¨æ€§å¼ºï¼Œç”¨èµ·æ¥ç®€å•ï¼Œå­¦ä¹ æˆæœ¬ä½ã€‚åœ¨asyncå‡½æ•°æ™®åŠä¹‹å‰ï¼Œç»å¤§éƒ¨åˆ†åº”ç”¨éƒ½æ˜¯é‡‡ç”¨Promiseæ¥åšå¼‚æ­¥æµç¨‹æ§åˆ¶çš„ï¼Œæ‰€ä»¥æŒæ¡Promiseæ˜¯Node.jså­¦ä¹ è¿‡ç¨‹ä¸­å¿…é¡»è¦æŒæ¡çš„é‡ä¸­ä¹‹é‡ã€‚</p><p><strong>Bluebird</strong>æ˜¯ Node.js ä¸–ç•Œé‡Œæ€§èƒ½æœ€å¥½çš„Promise/a+è§„èŒƒçš„å®ç°æ¨¡å—ï¼ŒApiéå¸¸é½å…¨ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œæ˜¯åŸç”ŸPromiseå¤–çš„ä¸äºŒé€‰æ‹©ã€‚</p><blockquote><p>å¥½å¤„å¦‚ä¸‹ï¼š<br>1.é¿å…Node.jså†…ç½®Promiseå®ç° é—®é¢˜ï¼Œä½¿ç”¨ä¸æ‰€æœ‰ç‰ˆæœ¬å…¼å®¹<br>2.é¿å…Node.js 4æ›¾ç»å‡ºç°çš„å†…å­˜æ³„éœ²é—®é¢˜<br>3.å†…ç½®æ›´å¤šæ‰©å±•ï¼Œtimeoutã€ promisifyAllç­‰ï¼Œå¯¹Promise/A+è§„èŒƒæä¾›</p></blockquote><p>æ¨èå­¦ä¹ èµ„æ–™</p><p>Node.jsæœ€æ–°æŠ€æœ¯æ ˆä¹‹Promiseç¯‡ <a href="https://cnodejs.org/topic/560dbc826a1ed28204a1e7de" target="_blank" rel="noopener">https://cnodejs.org/topic/560dbc826a1ed28204a1e7de</a><br>ç†è§£ Promise çš„å·¥ä½œåŸç† <a href="https://cnodejs.org/topic/569c8226adf526da2aeb23fd" target="_blank" rel="noopener">https://cnodejs.org/topic/569c8226adf526da2aeb23fd</a><br>Promise è¿·ä½ ä¹¦ <a href="http://liubin.github.io/promises-book/" target="_blank" rel="noopener">http://liubin.github.io/promises-book/</a></p><h2 id="ç»ˆæè§£å†³æ–¹æ¡ˆï¼šAsync-Await"><a href="#ç»ˆæè§£å†³æ–¹æ¡ˆï¼šAsync-Await" class="headerlink" title="ç»ˆæè§£å†³æ–¹æ¡ˆï¼šAsync/Await"></a>ç»ˆæè§£å†³æ–¹æ¡ˆï¼šAsync/Await</h2><p>Async/Awaitæ˜¯å¼‚æ­¥æ“ä½œçš„ç»ˆæè§£å†³æ–¹æ¡ˆï¼ŒKoa 2åœ¨node 7.6å‘å¸ƒä¹‹åï¼Œç«‹é©¬å‘å¸ƒäº†æ­£å¼ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ¨èä½¿ç”¨asyncå‡½æ•°æ¥ç¼–å†™Koaä¸­é—´ä»¶ã€‚</p><p>è¿™é‡Œç»™å‡ºä¸€æ®µKoa 2åº”ç”¨é‡Œçš„ä¸€æ®µä»£ç </p><pre><code class="javascript">exports.list = async (ctx, next) =&gt; {  try {    let students = await Student.getAllAsync();    await ctx.render(&#39;students/index&#39;, {      students : students    })  } catch (err) {    return ctx.api_error(err);  }};</code></pre><blockquote><p>å®ƒåšäº†3ä»¶äº‹å„¿</p></blockquote><p>1.é€šè¿‡await Student.getAllAsync();æ¥è·å–æ‰€æœ‰çš„studentsä¿¡æ¯ã€‚<br>2.é€šè¿‡await ctx.renderæ¸²æŸ“é¡µé¢<br>3.ç”±äºæ˜¯åŒæ­¥ä»£ç ï¼Œä½¿ç”¨try/catchåšçš„å¼‚å¸¸å¤„ç†</p><p>Asyncå‡½æ•°è¦ç‚¹å¦‚ä¸‹ï¼š</p><p>Asyncå‡½æ•°è¯­ä¹‰ä¸Šéå¸¸å¥½<br>Asyncä¸éœ€è¦æ‰§è¡Œå™¨ï¼Œå®ƒæœ¬èº«å…·å¤‡æ‰§è¡Œèƒ½åŠ›ï¼Œä¸åƒGeneratoréœ€è¦coæ¨¡å—<br>Asyncå‡½æ•°çš„å¼‚å¸¸å¤„ç†é‡‡ç”¨try/catchå’ŒPromiseçš„é”™è¯¯å¤„ç†ï¼Œéå¸¸å¼ºå¤§<br>Awaitæ¥Promiseï¼ŒPromiseè‡ªèº«å°±è¶³å¤Ÿåº”å¯¹æ‰€æœ‰æµç¨‹äº†ï¼ŒåŒ…æ‹¬asyncå‡½æ•°æ²¡æœ‰çº¯å¹¶è¡Œå¤„ç†æœºåˆ¶ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨Promiseé‡Œçš„allå’Œraceæ¥è¡¥é½<br>Awaité‡Šæ”¾Promiseçš„ç»„åˆèƒ½åŠ›ï¼Œå¤–åŠ coå’ŒPromiseçš„thenï¼Œå‡ ä¹æ²¡æœ‰ä¸æ”¯æŒçš„åœºæ™¯</p><h2 id="NodeJsæ¡†æ¶åˆ†ç±»"><a href="#NodeJsæ¡†æ¶åˆ†ç±»" class="headerlink" title="NodeJsæ¡†æ¶åˆ†ç±»"></a>NodeJsæ¡†æ¶åˆ†ç±»</h2><table><thead><tr><th>æ¡†æ¶åç§°</th><th style="text-align:right">ç‰¹æ€§</th><th style="text-align:center">ç‚¹è¯„</th></tr></thead><tbody><tr><td>Express</td><td style="text-align:right">ç®€å•ã€å®ç”¨ï¼Œè·¯ç”±ä¸­é—´ä»¶ç­‰äº”è„ä¿±å…¨</td><td style="text-align:center">æœ€è‘—åçš„Webæ¡†æ¶</td></tr><tr><td>Derby.js &amp;&amp; Meteor</td><td style="text-align:right">åŒæ„</td><td style="text-align:center">å‰åç«¯éƒ½æ”¾åˆ°ä¸€èµ·ï¼Œæ¨¡ç³Šäº†å¼€å‘ä¾¿æ·ï¼Œçœ‹ä¸Šå»æ›´ç®€å•ï¼Œå®é™…ä¸Šä¸Šå¯¹å¼€å‘æ¥è¯´è¦æ±‚æ›´é«˜</td></tr><tr><td>Sailsã€Total</td><td style="text-align:right">é¢å‘å…¶ä»–è¯­è¨€ï¼ŒRubyã€PHPç­‰</td><td style="text-align:center">å€Ÿé‰´ä¸šç•Œä¼˜ç§€å®ç°ï¼Œä¹Ÿæ˜¯ Node.js æˆç†Ÿçš„ä¸€ä¸ªæ ‡å¿—</td></tr><tr><td>MEAN.js</td><td style="text-align:right">é¢å‘æ¶æ„</td><td style="text-align:center">ç±»ä¼¼äºè„šæ‰‹æ¶ï¼ŒåˆæœŸæœ›åŒæ„ï¼Œç»“æœåªæ˜¯è¹­äº†çƒ­ç‚¹</td></tr><tr><td>Hapiå’ŒRestfy</td><td style="text-align:right">é¢å‘Api &amp;&amp; å¾®æœåŠ¡</td><td style="text-align:center">ç§»åŠ¨äº’è”ç½‘æ—¶ä»£Apiçš„ä½œç”¨è¢«æ”¾å¤§ï¼Œæ•…è€Œç‹¬ç«‹åˆ†ç±»ã€‚å°¤å…¶æ˜¯å¯¹äºå¾®æœåŠ¡å¼€å‘æ›´æ˜¯åˆ©å™¨</td></tr><tr><td>ThinkJS</td><td style="text-align:right">é¢å‘æ–°ç‰¹æ€§</td><td style="text-align:center">å€Ÿé‰´ThinkPHPï¼Œå¹¶æ…¢æ…¢èµ°å‡ºè‡ªå·±çš„ä¸€æ¡è·¯ï¼Œå¯¹äºAsyncå‡½æ•°ç­‰æ–°ç‰¹æ€§æ”¯æŒï¼Œæ— å‡ºå…¶å³ï¼Œæ–°ç‰ˆv3.0æ˜¯åŸºäºKoa</td><td>v2.0çš„ä½œä¸ºå†…æ ¸çš„</td></tr><tr><td>Ko</td><td style="text-align:right">ä¸“æ³¨äºå¼‚æ­¥æµç¨‹æ”¹è¿›</td><td style="text-align:center">ä¸‹ä¸€ä»£Webæ¡†æ¶</td></tr><tr><td>Egg</td><td style="text-align:right">åŸºäºKoaï¼Œåœ¨å¼€å‘ä¸Šæœ‰æå¤§ä¾¿åˆ©</td><td style="text-align:center">ä¼ä¸šçº§Webå¼€å‘æ¡†æ¶</td></tr></tbody></table><p><code>å¯¹äºæ¡†æ¶é€‰å‹</code></p><p>ä¸šåŠ¡åœºæ™¯ã€ç‰¹ç‚¹ï¼Œä¸å¿…ä¸ºäº†ä»€ä¹ˆè€Œä»€ä¹ˆï¼Œé¿å…æœ¬æœ«å€’ç½®<br>è‡ªèº«å›¢é˜Ÿèƒ½åŠ›ã€å–œå¥½ï¼Œæœ‰æ—¶å€™æŠ€æœ¯é€‰å‹å†³å®šå›¢é˜Ÿæ°›å›´çš„ï¼Œéœ€è¦å¹³è¡¡æ¿€è¿›ä¸ç¨³å®š<br>å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œæœ‰äººèƒ½å¤Ÿåšåˆ°æºç çº§å®šåˆ¶ã€‚Node.js å·²ç»æœ‰8å¹´å†å²ï¼Œä½†æ¨¡å—å®Œå–„ç¨‹åº¦è‰¯è ä¸é½ï¼Œå¦‚æœä¸æ…è¸©åˆ°ä¸€ä¸ªå‘é‡Œï¼Œéœ€è¦å›¢é˜Ÿåœ¨æ— å¤–åŠ›çš„æƒ…å†µèƒ½å¤Ÿæå®šï¼Œå¦åˆ™ä¼šå½±å“è¿›åº¦</p><p><code>Webç¼–ç¨‹æ ¸å¿ƒ</code></p><p>å¼‚æ­¥æµç¨‹æ§åˆ¶ï¼ˆå‰é¢è®²è¿‡äº†ï¼‰<br>åŸºæœ¬æ¡†æ¶ Koaæˆ–Expressï¼Œæ–°æ‰‹æ¨èExpressï¼Œæ¯•ç«Ÿèµ„æ–™å¤šï¼Œä¸Šæ‰‹æ›´å®¹æ˜“ã€‚å¦‚æœæœ‰ä¸€å®šç»éªŒï¼Œæ¨èKoaï¼Œå…¶å®è¿™äº›éƒ½æ˜¯ä¸ºäº†äº†è§£Webç¼–ç¨‹åŸç†ï¼Œå°¤å…¶æ˜¯ä¸­é—´ä»¶æœºåˆ¶ç†è§£ã€‚<br>æ•°æ®åº“ mongodbæˆ–mysqléƒ½è¡Œï¼Œmongooseå’ŒSequelizeã€bookshelfï¼ŒTypeOrmç­‰éƒ½éå¸¸ä¸é”™ã€‚å¯¹äºäº‹åŠ¡ï¼Œä¸æ˜¯Node.jsçš„é”…ï¼Œæ˜¯ä½ é€‰çš„æ•°æ®åº“çš„é—®é¢˜ã€‚å¦å¤–ä¸€äº›åé—¨ï¼Œæƒ³nodeè¿sqlserverç­‰ä¼°è®¡è¿˜ä¸æˆç†Ÿï¼Œæˆ‘æ˜¯ä¸ä¼šè¿™æ ·ç”¨çš„ã€‚<br>æ¨¡æ¿å¼•æ“ï¼Œ ejsï¼Œjadeï¼Œnunjucksã€‚ç†è§£åŸç†æœ€å¥½ã€‚å°¤å…¶æ˜¯extendï¼Œincludeç­‰é«˜çº§ç”¨æ³•ï¼Œç†è§£å¸ƒå±€ï¼Œå¤ç”¨çš„å¥½å¤„ã€‚å…¶å®å‰åç«¯æ€è·¯éƒ½æ˜¯ä¸€æ ·çš„</p><p>ä½œè€…:ç‹¼å”<br><a href="https://i5ting.github.io/How-to-learn-node-correctly/#1" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React æºç åˆ†æ 6 Reactåˆæˆäº‹ä»¶ç³»ç»Ÿ</title>
      <link href="/2018/03/27/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-6-React%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
      <url>/2018/03/27/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-6-React%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="Reactåˆæˆäº‹ä»¶ç‰¹ç‚¹"><a href="#Reactåˆæˆäº‹ä»¶ç‰¹ç‚¹" class="headerlink" title="Reactåˆæˆäº‹ä»¶ç‰¹ç‚¹"></a>Reactåˆæˆäº‹ä»¶ç‰¹ç‚¹</h1><p>Reactè‡ªå·±å®ç°äº†ä¸€å¥—é«˜æ•ˆçš„äº‹ä»¶æ³¨å†Œï¼Œå­˜å‚¨ï¼Œåˆ†å‘å’Œé‡ç”¨é€»è¾‘ï¼Œåœ¨DOMäº‹ä»¶ä½“ç³»åŸºç¡€ä¸Šåšäº†å¾ˆå¤§æ”¹è¿›ï¼Œå‡å°‘äº†å†…å­˜æ¶ˆè€—ï¼Œç®€åŒ–äº†äº‹ä»¶é€»è¾‘ï¼Œå¹¶æœ€å¤§åŒ–çš„è§£å†³äº†IEç­‰æµè§ˆå™¨çš„ä¸å…¼å®¹é—®é¢˜ã€‚ä¸DOMäº‹ä»¶ä½“ç³»ç›¸æ¯”ï¼Œå®ƒæœ‰å¦‚ä¸‹ç‰¹ç‚¹</p><blockquote><ul><li>1.Reactç»„ä»¶ä¸Šå£°æ˜çš„äº‹ä»¶æœ€ç»ˆç»‘å®šåˆ°äº†documentè¿™ä¸ªDOMèŠ‚ç‚¹ä¸Šï¼Œè€Œä¸æ˜¯Reactç»„ä»¶å¯¹åº”çš„DOMèŠ‚ç‚¹ã€‚æ•…åªæœ‰documentè¿™ä¸ªèŠ‚ç‚¹ä¸Šé¢æ‰ç»‘å®šäº†DOMåŸç”Ÿäº‹ä»¶ï¼Œå…¶ä»–èŠ‚ç‚¹æ²¡æœ‰ç»‘å®šäº‹ä»¶ã€‚è¿™æ ·ç®€åŒ–äº†DOMåŸç”Ÿäº‹ä»¶ï¼Œå‡å°‘äº†å†…å­˜å¼€é”€</li></ul></blockquote><blockquote><ul><li>2.Reactä»¥é˜Ÿåˆ—çš„æ–¹å¼ï¼Œä»è§¦å‘äº‹ä»¶çš„ç»„ä»¶å‘çˆ¶ç»„ä»¶å›æº¯ï¼Œè°ƒç”¨å®ƒä»¬åœ¨JSXä¸­å£°æ˜çš„callbackã€‚ä¹Ÿå°±æ˜¯Reactè‡ªèº«å®ç°äº†ä¸€å¥—äº‹ä»¶å†’æ³¡æœºåˆ¶ã€‚æˆ‘ä»¬æ²¡åŠæ³•ç”¨event.stopPropagation()æ¥åœæ­¢äº‹ä»¶ä¼ æ’­ï¼Œåº”è¯¥ä½¿ç”¨event.preventDefault()</li></ul></blockquote><blockquote><ul><li>3.Reactæœ‰ä¸€å¥—è‡ªå·±çš„åˆæˆäº‹ä»¶SyntheticEventï¼Œä¸åŒç±»å‹çš„äº‹ä»¶ä¼šæ„é€ ä¸åŒçš„SyntheticEvent</li></ul></blockquote><blockquote><ul><li>4.Reactä½¿ç”¨å¯¹è±¡æ± æ¥ç®¡ç†åˆæˆäº‹ä»¶å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯ï¼Œè¿™æ ·å‡å°‘äº†åƒåœ¾çš„ç”Ÿæˆå’Œæ–°å¯¹è±¡å†…å­˜çš„åˆ†é…ï¼Œå¤§å¤§æé«˜äº†æ€§èƒ½</li></ul></blockquote><p>é‚£ä¹ˆè¿™äº›ç‰¹æ€§æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Œä¸‹é¢å’Œå¤§å®¶ä¸€èµ·ä¸€æ¢ç©¶ç«Ÿã€‚</p><h1 id="Reactäº‹ä»¶ç³»ç»Ÿ"><a href="#Reactäº‹ä»¶ç³»ç»Ÿ" class="headerlink" title="Reactäº‹ä»¶ç³»ç»Ÿ"></a>Reactäº‹ä»¶ç³»ç»Ÿ</h1><p>å…ˆçœ‹Facebookç»™å‡ºçš„Reactäº‹ä»¶ç³»ç»Ÿæ¡†å›¾<br><img src="https://pic4.zhimg.com/80/v2-e1dc82ada4fbbf5c366558532a6f6fca_hd.jpg" alt="reactimg"></p><p>æµè§ˆå™¨äº‹ä»¶ï¼ˆå¦‚ç”¨æˆ·ç‚¹å‡»äº†æŸä¸ªbuttonï¼‰è§¦å‘åï¼ŒDOMå°†eventä¼ ç»™ReactEventListenerï¼Œå®ƒå°†äº‹ä»¶åˆ†å‘åˆ°å½“å‰ç»„ä»¶åŠä»¥ä¸Šçš„çˆ¶ç»„ä»¶ã€‚ç„¶åç”±ReactEventEmitterå¯¹æ¯ä¸ªç»„ä»¶è¿›è¡Œäº‹ä»¶çš„æ‰§è¡Œï¼Œå…ˆæ„é€ Reactåˆæˆäº‹ä»¶ï¼Œç„¶åä»¥queueçš„æ–¹å¼è°ƒç”¨JSXä¸­å£°æ˜çš„callbackè¿›è¡Œäº‹ä»¶å›è°ƒã€‚</p><p>æ¶‰åŠåˆ°çš„ä¸»è¦ç±»å¦‚ä¸‹</p><p><strong>ReactEventListene</strong>:è´Ÿè´£äº‹ä»¶æ³¨å†Œå’Œäº‹ä»¶åˆ†å‘ã€‚Reactå°†DOMäº‹ä»¶å…¨éƒ½æ³¨å†Œåˆ°documentè¿™ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨äº‹ä»¶æ³¨å†Œå°èŠ‚è¯¦ç»†è®²ã€‚äº‹ä»¶åˆ†å‘ä¸»è¦è°ƒç”¨dispatchEventè¿›è¡Œï¼Œä»äº‹ä»¶è§¦å‘ç»„ä»¶å¼€å§‹ï¼Œå‘çˆ¶å…ƒç´ éå†ã€‚æˆ‘ä»¬åœ¨äº‹ä»¶æ‰§è¡Œå°èŠ‚è¯¦ç»†è®²ã€‚</p><p><strong>ReactEventEmitter</strong>ï¼šè´Ÿè´£æ¯ä¸ªç»„ä»¶ä¸Šäº‹ä»¶çš„æ‰§è¡Œã€‚</p><p><strong>EventPluginHub</strong>ï¼šè´Ÿè´£äº‹ä»¶çš„å­˜å‚¨ï¼Œåˆæˆäº‹ä»¶ä»¥å¯¹è±¡æ± çš„æ–¹å¼å®ç°åˆ›å»ºå’Œé”€æ¯ï¼Œå¤§å¤§æé«˜äº†æ€§èƒ½ã€‚</p><p><strong>SimpleEventPluginç­‰plugin</strong>ï¼šæ ¹æ®ä¸åŒçš„äº‹ä»¶ç±»å‹ï¼Œæ„é€ ä¸åŒçš„åˆæˆäº‹ä»¶ã€‚å¦‚focuså¯¹åº”çš„Reactåˆæˆäº‹ä»¶ä¸ºSyntheticFocusEvent</p><a id="more"></a><h1 id="äº‹ä»¶æ³¨å†Œ"><a href="#äº‹ä»¶æ³¨å†Œ" class="headerlink" title="äº‹ä»¶æ³¨å†Œ"></a>äº‹ä»¶æ³¨å†Œ</h1><p>JSXä¸­å£°æ˜ä¸€ä¸ªReactäº‹ä»¶ååˆ†ç®€å•ï¼Œæ¯”å¦‚</p><pre><code class="javascript">render() {  return (    &lt;div onClick = {            (event) =&gt; {console.log(JSON.stringify(event))}        }     /&gt;  );}</code></pre><p>é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•è¢«æ³¨å†Œåˆ°Reactäº‹ä»¶ç³»ç»Ÿä¸­çš„å‘¢ï¼Ÿ</p><p>è¿˜æ˜¯å…ˆå¾—ä»ç»„ä»¶åˆ›å»ºå’Œæ›´æ–°çš„å…¥å£æ–¹æ³•mountComponentå’ŒupdateComponentè¯´èµ·ã€‚åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­ï¼Œéƒ½ä¼šè°ƒç”¨åˆ°_updateDOMPropertiesæ–¹æ³•ï¼Œå¯¹JSXä¸­å£°æ˜çš„ç»„ä»¶å±æ€§è¿›è¡Œå¤„ç†ã€‚æºç å¦‚ä¸‹</p><pre><code class="javascript">_updateDOMProperties: function (lastProps, nextProps, transaction) {    ... // å‰é¢ä»£ç å¤ªé•¿ï¼Œçœç•¥ä¸€éƒ¨åˆ†    else if (registrationNameModules.hasOwnProperty(propKey)) {        // å¦‚æœæ˜¯propsè¿™ä¸ªå¯¹è±¡ç›´æ¥å£°æ˜çš„å±æ€§ï¼Œè€Œä¸æ˜¯ä»åŸå‹é“¾ä¸­ç»§æ‰¿è€Œæ¥çš„ï¼Œåˆ™å¤„ç†å®ƒ        // nextPropè¡¨ç¤ºè¦åˆ›å»ºæˆ–è€…æ›´æ–°çš„å±æ€§ï¼Œè€ŒlastPropåˆ™è¡¨ç¤ºä¸Šä¸€æ¬¡çš„å±æ€§        // å¯¹äºmountComponentï¼ŒlastPropä¸ºnullã€‚updateComponentäºŒè€…éƒ½ä¸ä¸ºnullã€‚unmountComponentåˆ™nextPropä¸ºnull        if (nextProp) {          // mountComponentå’ŒupdateComponentä¸­ï¼ŒenqueuePutListeneræ³¨å†Œäº‹ä»¶          enqueuePutListener(this, propKey, nextProp, transaction);        } else if (lastProp) {          // unmountComponentä¸­ï¼Œåˆ é™¤æ³¨å†Œçš„listenerï¼Œé˜²æ­¢å†…å­˜æ³„æ¼          deleteListener(this, propKey);        }    }}</code></pre><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹enqueuePutListenerï¼Œå®ƒè´Ÿè´£æ³¨å†ŒJSXä¸­å£°æ˜çš„äº‹ä»¶ã€‚æºç å¦‚ä¸‹</p><pre><code class="javascript">// inst: React Componentå¯¹è±¡// registrationName: Reactåˆæˆäº‹ä»¶åï¼Œå¦‚onClick// listener: Reactäº‹ä»¶å›è°ƒæ–¹æ³•ï¼Œå¦‚onClick=callbackä¸­çš„callback// transaction: mountComponentæˆ–updateComponentæ‰€å¤„çš„äº‹åŠ¡æµä¸­ï¼ŒReactéƒ½æ˜¯åŸºäºäº‹åŠ¡æµçš„function enqueuePutListener(inst, registrationName, listener, transaction) {  if (transaction instanceof ReactServerRenderingTransaction) {    return;  }  var containerInfo = inst._hostContainerInfo;  var isDocumentFragment = containerInfo._node &amp;&amp; containerInfo._node.nodeType === DOC_FRAGMENT_TYPE;  // æ‰¾åˆ°document  var doc = isDocumentFragment ? containerInfo._node : containerInfo._ownerDocument;  // æ³¨å†Œäº‹ä»¶ï¼Œå°†äº‹ä»¶æ³¨å†Œåˆ°documentä¸Š  listenTo(registrationName, doc);  // å­˜å‚¨äº‹ä»¶,æ”¾å…¥äº‹åŠ¡é˜Ÿåˆ—ä¸­  transaction.getReactMountReady().enqueue(putListener, {    inst: inst,    registrationName: registrationName,    listener: listener  });}</code></pre><p>enqueuePutListenerä¸»è¦åšä¸¤ä»¶äº‹ï¼Œä¸€æ–¹é¢å°†äº‹ä»¶æ³¨å†Œåˆ°documentè¿™ä¸ªåŸç”ŸDOMä¸Šï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåªæœ‰documentè¿™ä¸ªèŠ‚ç‚¹æœ‰DOMäº‹ä»¶çš„åŸå› ï¼‰ï¼Œå¦ä¸€æ–¹é¢é‡‡ç”¨äº‹åŠ¡é˜Ÿåˆ—çš„æ–¹å¼è°ƒç”¨putListenerå°†æ³¨å†Œçš„äº‹ä»¶å­˜å‚¨èµ·æ¥ï¼Œä»¥ä¾›äº‹ä»¶è§¦å‘æ—¶å›è°ƒã€‚</p><p>æ³¨å†Œäº‹ä»¶çš„å…¥å£æ˜¯listenToæ–¹æ³•, å®ƒè§£å†³äº†ä¸åŒæµè§ˆå™¨é—´æ•è·å’Œå†’æ³¡ä¸å…¼å®¹çš„é—®é¢˜ã€‚äº‹ä»¶å›è°ƒæ–¹æ³•åœ¨bubbleé˜¶æ®µè¢«è§¦å‘ã€‚å¦‚æœæˆ‘ä»¬æƒ³è®©å®ƒåœ¨captureé˜¶æ®µè§¦å‘ï¼Œåˆ™éœ€è¦åœ¨äº‹ä»¶åä¸ŠåŠ ä¸Šcaptureã€‚æ¯”å¦‚onClickåœ¨bubbleé˜¶æ®µè§¦å‘ï¼Œè€ŒonCaptureClickåœ¨captureé˜¶æ®µè§¦å‘ã€‚listenToä»£ç è™½ç„¶æ¯”è¾ƒé•¿ï¼Œä½†é€»è¾‘å¾ˆç®€å•ï¼Œè°ƒç”¨trapCapturedEventå’ŒtrapBubbledEventæ¥æ³¨å†Œæ•è·å’Œå†’æ³¡äº‹ä»¶ã€‚trapCapturedEventå¤§å®¶å¯ä»¥è‡ªè¡Œåˆ†æï¼Œæˆ‘ä»¬ä»…åˆ†ætrapBubbledEventï¼Œå¦‚ä¸‹</p><pre><code class="javascript">trapBubbledEvent: function (topLevelType, handlerBaseName, element) {    if (!element) {      return null;    }    return EventListener.listen(      element,   // ç»‘å®šåˆ°çš„DOMç›®æ ‡,ä¹Ÿå°±æ˜¯document      handlerBaseName,   // eventType      ReactEventListener.dispatchEvent.bind(null, topLevelType));  // callback, documentä¸Šçš„åŸç”Ÿäº‹ä»¶è§¦å‘åå›è°ƒ  },  listen: function listen(target, eventType, callback) {    if (target.addEventListener) {      // å°†åŸç”Ÿäº‹ä»¶æ·»åŠ åˆ°targetè¿™ä¸ªdomä¸Š,ä¹Ÿå°±æ˜¯documentä¸Šã€‚      // è¿™å°±æ˜¯åªæœ‰documentè¿™ä¸ªDOMèŠ‚ç‚¹ä¸Šæœ‰åŸç”Ÿäº‹ä»¶çš„åŸå›       target.addEventListener(eventType, callback, false);      return {        // åˆ é™¤äº‹ä»¶,è¿™ä¸ªç”±Reactè‡ªå·±å›è°ƒ,ä¸éœ€è¦è°ƒç”¨è€…æ¥é”€æ¯ã€‚ä½†ä»…ä»…å¯¹äºReactåˆæˆäº‹ä»¶æ‰è¡Œ        remove: function remove() {          target.removeEventListener(eventType, callback, false);        }      };    } else if (target.attachEvent) {      // attachå’Œdetachçš„æ–¹å¼      target.attachEvent(&#39;on&#39; + eventType, callback);      return {        remove: function remove() {          target.detachEvent(&#39;on&#39; + eventType, callback);        }      };    }  },</code></pre><p>åœ¨listenæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ç»ˆäºå‘ç°äº†ç†Ÿæ‚‰çš„addEventListenerè¿™ä¸ªåŸç”Ÿäº‹ä»¶æ³¨å†Œæ–¹æ³•ã€‚åªæœ‰documentèŠ‚ç‚¹æ‰ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ•…ä»…ä»…åªæœ‰documentèŠ‚ç‚¹ä¸Šæ‰æœ‰DOMäº‹ä»¶ã€‚è¿™å¤§å¤§ç®€åŒ–äº†DOMäº‹ä»¶é€»è¾‘ï¼Œä¹ŸèŠ‚çº¦äº†å†…å­˜ã€‚</p><h1 id="äº‹ä»¶å­˜å‚¨"><a href="#äº‹ä»¶å­˜å‚¨" class="headerlink" title="äº‹ä»¶å­˜å‚¨"></a>äº‹ä»¶å­˜å‚¨</h1><p>äº‹ä»¶å­˜å‚¨ç”±EventPluginHubæ¥è´Ÿè´£ï¼Œå®ƒçš„å…¥å£åœ¨æˆ‘ä»¬ä¸Šé¢è®²åˆ°çš„enqueuePutListenerä¸­çš„putListeneræ–¹æ³•ï¼Œå¦‚ä¸‹</p><pre><code class="javascript">  /**   * EventPluginHubç”¨æ¥å­˜å‚¨Reactäº‹ä»¶, å°†listenerå­˜å‚¨åˆ°`listenerBank[registrationName][key]`   *   * @param {object} inst: äº‹ä»¶æº   * @param {string} listenerçš„åå­—,æ¯”å¦‚onClick   * @param {function} listenerçš„callback   */  //  putListener: function (inst, registrationName, listener) {    // ç”¨æ¥æ ‡è¯†æ³¨å†Œäº†äº‹ä»¶,æ¯”å¦‚onClickçš„Reactå¯¹è±¡ã€‚keyçš„æ ¼å¼ä¸º&#39;.nodeId&#39;, åªç”¨çŸ¥é“å®ƒå¯ä»¥æ ‡ç¤ºå“ªä¸ªReactå¯¹è±¡å°±å¯ä»¥äº†    var key = getDictionaryKey(inst);    var bankForRegistrationName = listenerBank[registrationName] || (listenerBank[registrationName] = {});    // å°†listeneräº‹ä»¶å›è°ƒæ–¹æ³•å­˜å…¥listenerBank[registrationName][key]ä¸­,æ¯”å¦‚listenerBank[&#39;onclick&#39;][nodeId]    // æ‰€æœ‰Reactç»„ä»¶å¯¹è±¡å®šä¹‰çš„æ‰€æœ‰Reactäº‹ä»¶éƒ½ä¼šå­˜å‚¨åœ¨listenerBankä¸­    bankForRegistrationName[key] = listener;    //onSelectå’ŒonClickæ³¨å†Œäº†ä¸¤ä¸ªäº‹ä»¶å›è°ƒæ’ä»¶, ç”¨äºwalkAroundæŸäº›æµè§ˆå™¨å…¼å®¹bug,ä¸ç”¨care    var PluginModule = EventPluginRegistry.registrationNameModules[registrationName];    if (PluginModule &amp;&amp; PluginModule.didPutListener) {      PluginModule.didPutListener(inst, registrationName, listener);    }  },var getDictionaryKey = function (inst) {  return &#39;.&#39; + inst._rootNodeID;};</code></pre><p>ç”±ä¸Šå¯è§ï¼Œäº‹ä»¶å­˜å‚¨åœ¨äº†listenerBankå¯¹è±¡ä¸­ï¼Œå®ƒæŒ‰ç…§äº‹ä»¶åå’ŒReactç»„ä»¶å¯¹è±¡è¿›è¡Œäº†äºŒç»´åˆ’åˆ†ï¼Œæ¯”å¦‚nodeIdç»„ä»¶ä¸Šæ³¨å†Œçš„onClickäº‹ä»¶æœ€åå­˜å‚¨åœ¨listenerBank.onclick[nodeId]ä¸­</p><h1 id="äº‹ä»¶æ‰§è¡Œ"><a href="#äº‹ä»¶æ‰§è¡Œ" class="headerlink" title="äº‹ä»¶æ‰§è¡Œ"></a>äº‹ä»¶æ‰§è¡Œ</h1><h2 id="äº‹ä»¶åˆ†å‘"><a href="#äº‹ä»¶åˆ†å‘" class="headerlink" title="äº‹ä»¶åˆ†å‘"></a>äº‹ä»¶åˆ†å‘</h2><p>å½“äº‹ä»¶è§¦å‘æ—¶ï¼Œdocumentä¸ŠaddEventListeneræ³¨å†Œçš„callbackä¼šè¢«å›è°ƒã€‚ä»å‰é¢äº‹ä»¶æ³¨å†Œéƒ¨åˆ†å‘ç°ï¼Œæ­¤æ—¶å›è°ƒå‡½æ•°ä¸ºReactEventListener.dispatchEventï¼Œå®ƒæ˜¯äº‹ä»¶åˆ†å‘çš„å…¥å£æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†åˆ†æ</p><p><img src="https://pic2.zhimg.com/80/v2-35d1c1174231dd45f3fda05516ed0239_hd.jpg" alt="react3"></p><pre><code class="javascript">// topLevelTypeï¼šå¸¦topçš„äº‹ä»¶åï¼Œå¦‚topClickã€‚ä¸ç”¨çº ç»“ä¸ºä»€ä¹ˆå¸¦ä¸€ä¸ªtopå­—æ®µï¼ŒçŸ¥é“å®ƒæ˜¯äº‹ä»¶åå°±OKäº†// nativeEvent: ç”¨æˆ·è§¦å‘clickç­‰äº‹ä»¶æ—¶ï¼Œæµè§ˆå™¨ä¼ é€’çš„åŸç”Ÿäº‹ä»¶dispatchEvent: function (topLevelType, nativeEvent) {    // disableäº†åˆ™ç›´æ¥ä¸å›è°ƒç›¸å…³æ–¹æ³•    if (!ReactEventListener._enabled) {      return;    }    var bookKeeping = TopLevelCallbackBookKeeping.getPooled(topLevelType, nativeEvent);    try {      // æ”¾å…¥æ‰¹å¤„ç†é˜Ÿåˆ—ä¸­,Reactäº‹ä»¶æµä¹Ÿæ˜¯ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼      ReactUpdates.batchedUpdates(handleTopLevelImpl, bookKeeping);    } finally {      TopLevelCallbackBookKeeping.release(bookKeeping);    }}</code></pre><p>å¯è§æˆ‘ä»¬ä»ç„¶ä½¿ç”¨æ‰¹å¤„ç†çš„æ–¹å¼è¿›è¡Œäº‹ä»¶åˆ†å‘ï¼ŒhandleTopLevelImplæ‰æ˜¯äº‹ä»¶åˆ†å‘çš„çœŸæ­£æ‰§è¡Œè€…ï¼Œå®ƒæ˜¯äº‹ä»¶åˆ†å‘çš„æ ¸å¿ƒï¼Œä½“ç°äº†Reactäº‹ä»¶åˆ†å‘çš„ç‰¹ç‚¹ï¼Œå¦‚ä¸‹</p><pre><code class="javascript">// documentè¿›è¡Œäº‹ä»¶åˆ†å‘,è¿™æ ·å…·ä½“çš„Reactç»„ä»¶æ‰èƒ½å¾—åˆ°å“åº”ã€‚å› ä¸ºDOMäº‹ä»¶æ˜¯ç»‘å®šåˆ°documentä¸Šçš„function handleTopLevelImpl(bookKeeping) {  // æ‰¾åˆ°äº‹ä»¶è§¦å‘çš„DOMå’ŒReact Component  var nativeEventTarget = getEventTarget(bookKeeping.nativeEvent);  var targetInst = ReactDOMComponentTree.getClosestInstanceFromNode(nativeEventTarget);  // æ‰§è¡Œäº‹ä»¶å›è°ƒå‰,å…ˆç”±å½“å‰ç»„ä»¶å‘ä¸Šéå†å®ƒçš„æ‰€æœ‰çˆ¶ç»„ä»¶ã€‚å¾—åˆ°ancestorsè¿™ä¸ªæ•°ç»„ã€‚  // å› ä¸ºäº‹ä»¶å›è°ƒä¸­å¯èƒ½ä¼šæ”¹å˜Virtual DOMç»“æ„,æ‰€ä»¥è¦å…ˆéå†å¥½ç»„ä»¶å±‚çº§  var ancestor = targetInst;  do {    bookKeeping.ancestors.push(ancestor);    ancestor = ancestor &amp;&amp; findParent(ancestor);  } while (ancestor);  // ä»å½“å‰ç»„ä»¶å‘çˆ¶ç»„ä»¶éå†,ä¾æ¬¡æ‰§è¡Œæ³¨å†Œçš„å›è°ƒæ–¹æ³•. æˆ‘ä»¬éå†æ„é€ ancestorsæ•°ç»„æ—¶,æ˜¯ä»å½“å‰ç»„ä»¶å‘çˆ¶ç»„ä»¶å›æº¯çš„,æ•…æ­¤å¤„äº‹ä»¶å›è°ƒä¹Ÿæ˜¯è¿™ä¸ªé¡ºåº  // è¿™ä¸ªé¡ºåºå°±æ˜¯å†’æ³¡çš„é¡ºåº,å¹¶ä¸”æˆ‘ä»¬å‘ç°ä¸èƒ½é€šè¿‡stopPropagationæ¥é˜»æ­¢&#39;å†’æ³¡&#39;ã€‚  for (var i = 0; i &lt; bookKeeping.ancestors.length; i++) {    targetInst = bookKeeping.ancestors[i];    ReactEventListener._handleTopLevel(bookKeeping.topLevelType, targetInst, bookKeeping.nativeEvent, getEventTarget(bookKeeping.nativeEvent));  }}</code></pre><p>ä»ä¸Šé¢çš„äº‹ä»¶åˆ†å‘ä¸­å¯è§ï¼ŒReactè‡ªèº«å®ç°äº†ä¸€å¥—å†’æ³¡æœºåˆ¶ã€‚ä»è§¦å‘äº‹ä»¶çš„å¯¹è±¡å¼€å§‹ï¼Œå‘çˆ¶å…ƒç´ å›æº¯ï¼Œä¾æ¬¡è°ƒç”¨å®ƒä»¬æ³¨å†Œçš„äº‹ä»¶callback</p><h2 id="äº‹ä»¶callback-è°ƒç”¨"><a href="#äº‹ä»¶callback-è°ƒç”¨" class="headerlink" title="äº‹ä»¶callback è°ƒç”¨"></a>äº‹ä»¶callback è°ƒç”¨</h2><p>äº‹ä»¶å¤„ç†ç”±_handleTopLevelå®Œæˆã€‚å®ƒå…¶å®æ˜¯è°ƒç”¨ReactBrowserEventEmitter.handleTopLevel() ï¼Œå¦‚ä¸‹</p><pre><code class="javascript">// Reactäº‹ä»¶è°ƒç”¨çš„å…¥å£ã€‚DOMäº‹ä»¶ç»‘å®šåœ¨äº†documentåŸç”Ÿå¯¹è±¡ä¸Š,æ¯æ¬¡äº‹ä»¶è§¦å‘,éƒ½ä¼šè°ƒç”¨åˆ°handleTopLevel  handleTopLevel: function (topLevelType, targetInst, nativeEvent, nativeEventTarget) {    // é‡‡ç”¨å¯¹è±¡æ± çš„æ–¹å¼æ„é€ å‡ºåˆæˆäº‹ä»¶ã€‚ä¸åŒçš„eventTypeçš„åˆæˆäº‹ä»¶å¯èƒ½ä¸åŒ    var events = EventPluginHub.extractEvents(topLevelType, targetInst, nativeEvent, nativeEventTarget);    // æ‰¹å¤„ç†é˜Ÿåˆ—ä¸­çš„events    runEventQueueInBatch(events);  }</code></pre><p>handleTopLevelæ–¹æ³•æ˜¯äº‹ä»¶callbackè°ƒç”¨çš„æ ¸å¿ƒã€‚å®ƒä¸»è¦åšä¸¤ä»¶äº‹æƒ…ï¼Œä¸€æ–¹é¢åˆ©ç”¨æµè§ˆå™¨å›ä¼ çš„åŸç”Ÿäº‹ä»¶æ„é€ å‡ºReactåˆæˆäº‹ä»¶ï¼Œå¦ä¸€æ–¹é¢é‡‡ç”¨é˜Ÿåˆ—çš„æ–¹å¼å¤„ç†eventsã€‚å…ˆçœ‹å¦‚ä½•æ„é€ åˆæˆäº‹ä»¶ã€‚</p><h3 id="æ„é€ åˆæˆäº‹ä»¶"><a href="#æ„é€ åˆæˆäº‹ä»¶" class="headerlink" title="æ„é€ åˆæˆäº‹ä»¶"></a>æ„é€ åˆæˆäº‹ä»¶</h3><pre><code class="javascript"> // æ„é€ åˆæˆäº‹ä»¶  extractEvents: function (topLevelType, targetInst, nativeEvent, nativeEventTarget) {    var events;    // EventPluginHubå¯ä»¥å­˜å‚¨Reactåˆæˆäº‹ä»¶çš„callback,ä¹Ÿå­˜å‚¨äº†ä¸€äº›plugin,è¿™äº›pluginåœ¨EventPluginHubåˆå§‹åŒ–æ—¶å°±æ³¨å†Œå°±æ¥äº†    var plugins = EventPluginRegistry.plugins;    for (var i = 0; i &lt; plugins.length; i++) {      var possiblePlugin = plugins[i];      if (possiblePlugin) {        // æ ¹æ®eventTypeæ„é€ ä¸åŒçš„åˆæˆäº‹ä»¶SyntheticEvent        var extractedEvents = possiblePlugin.extractEvents(topLevelType, targetInst, nativeEvent, nativeEventTarget);        if (extractedEvents) {          // å°†æ„é€ å¥½çš„åˆæˆäº‹ä»¶extractedEventsæ·»åŠ åˆ°eventsæ•°ç»„ä¸­,è¿™æ ·å°±ä¿å­˜äº†æ‰€æœ‰pluginæ„é€ çš„åˆæˆäº‹ä»¶          events = accumulateInto(events, extractedEvents);        }      }    }    return events;  },</code></pre><p>EventPluginRegistry.pluginsé»˜è®¤åŒ…å«äº”ç§pluginï¼Œä»–ä»¬æ˜¯åœ¨EventPluginHubåˆå§‹åŒ–é˜¶æ®µæ³¨å…¥è¿›å»çš„ï¼Œä¸”çœ‹ä»£ç </p><pre><code class="javascript">  // å°†eventPluginæ³¨å†Œåˆ°EventPluginHubä¸­  ReactInjection.EventPluginHub.injectEventPluginsByName({    SimpleEventPlugin: SimpleEventPlugin,    EnterLeaveEventPlugin: EnterLeaveEventPlugin,    ChangeEventPlugin: ChangeEventPlugin,    SelectEventPlugin: SelectEventPlugin,    BeforeInputEventPlugin: BeforeInputEventPlugin  });</code></pre><p>ä¸åŒçš„pluginé’ˆå¯¹ä¸åŒçš„äº‹ä»¶æœ‰ç‰¹æ®Šçš„å¤„ç†ï¼Œæ­¤å¤„æˆ‘ä»¬ä¸å±•å¼€è®²äº†ï¼Œä¸‹é¢ä»…åˆ†æSimpleEventPluginä¸­æ–¹æ³•å³å¯ã€‚</p><p>æˆ‘ä»¬å…ˆçœ‹SimpleEventPluginå¦‚ä½•æ„é€ å®ƒæ‰€å¯¹åº”çš„Reactåˆæˆäº‹ä»¶ã€‚</p><pre><code class="javascript">  // æ ¹æ®ä¸åŒäº‹ä»¶ç±»å‹,æ¯”å¦‚click,focusæ„é€ ä¸åŒçš„åˆæˆäº‹ä»¶SyntheticEvent, å¦‚SyntheticKeyboardEvent SyntheticFocusEventextractEvents: function (topLevelType, targetInst, nativeEvent, nativeEventTarget) {    var dispatchConfig = topLevelEventsToDispatchConfig[topLevelType];    if (!dispatchConfig) {      return null;    }    var EventConstructor;   // æ ¹æ®äº‹ä»¶ç±»å‹ï¼Œé‡‡ç”¨ä¸åŒçš„SyntheticEventæ¥æ„é€ ä¸åŒçš„åˆæˆäº‹ä»¶    switch (topLevelType) {      ... // çœç•¥ä¸€äº›äº‹ä»¶ï¼Œæˆ‘ä»¬ä»…ä»¥blurå’Œfocusä¸ºä¾‹      case &#39;topBlur&#39;:      case &#39;topFocus&#39;:        EventConstructor = SyntheticFocusEvent;        break;      ... // çœç•¥ä¸€äº›äº‹ä»¶    }    // ä»eventå¯¹è±¡æ± ä¸­å–å‡ºåˆæˆäº‹ä»¶å¯¹è±¡,åˆ©ç”¨å¯¹è±¡æ± æ€æƒ³,å¯ä»¥å¤§å¤§é™ä½å¯¹è±¡åˆ›å»ºå’Œé”€æ¯çš„æ—¶é—´,æé«˜æ€§èƒ½ã€‚è¿™æ˜¯Reactäº‹ä»¶ç³»ç»Ÿçš„ä¸€å¤§äº®ç‚¹    var event = EventConstructor.getPooled(dispatchConfig, targetInst, nativeEvent, nativeEventTarget);    EventPropagators.accumulateTwoPhaseDispatches(event);    return event;},</code></pre><p>è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°äº†eventå¯¹è±¡æ± è¿™ä¸ªé‡å¤§ç‰¹æ€§ï¼Œé‡‡ç”¨åˆæˆäº‹ä»¶å¯¹è±¡æ± çš„æ–¹å¼ï¼Œå¯ä»¥å¤§å¤§é™ä½é”€æ¯å’Œåˆ›å»ºåˆæˆäº‹ä»¶å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚</p><p>å¯¹è±¡åˆ›å»ºå¥½ä¹‹åï¼Œæˆ‘ä»¬è¿˜ä¼šå°†å®ƒæ·»åŠ åˆ°eventsè¿™ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå› ä¸ºäº‹ä»¶å›è°ƒçš„æ—¶å€™ä¼šç”¨åˆ°è¿™ä¸ªé˜Ÿåˆ—ã€‚æ·»åŠ åˆ°eventsä¸­ä½¿ç”¨çš„æ˜¯accumulateIntoæ–¹æ³•ã€‚å®ƒæ€è·¯æ¯”è¾ƒç®€å•ï¼Œå°†æ–°åˆ›å»ºçš„åˆæˆå¯¹è±¡çš„å¼•ç”¨æ·»åŠ åˆ°ä¹‹å‰åˆ›å»ºå¥½çš„eventsé˜Ÿåˆ—ä¸­å³å¯ï¼Œæºç å¦‚ä¸‹</p><pre><code class="javascript">function accumulateInto(current, next) {  if (current == null) {    return next;  }  // å°†nextæ·»åŠ åˆ°currentä¸­,è¿”å›ä¸€ä¸ªåŒ…å«ä»–ä»¬ä¸¤ä¸ªçš„æ–°æ•°ç»„  // å¦‚æœnextæ˜¯æ•°ç»„,currentä¸æ˜¯æ•°ç»„,é‡‡ç”¨pushæ–¹æ³•,å¦åˆ™é‡‡ç”¨concatæ–¹æ³•  // å¦‚æœnextä¸æ˜¯æ•°ç»„,åˆ™è¿”å›ä¸€ä¸ªcurrentå’Œnextæ„æˆçš„æ–°æ•°ç»„  if (Array.isArray(current)) {    if (Array.isArray(next)) {      current.push.apply(current, next);      return current;    }    current.push(next);    return current;  }  if (Array.isArray(next)) {    return [current].concat(next);  }  return [current, next];}</code></pre><h3 id="æ‰¹é‡å¤„ç†åˆæˆäº‹ä»¶"><a href="#æ‰¹é‡å¤„ç†åˆæˆäº‹ä»¶" class="headerlink" title="æ‰¹é‡å¤„ç†åˆæˆäº‹ä»¶"></a>æ‰¹é‡å¤„ç†åˆæˆäº‹ä»¶</h3><p>æˆ‘ä»¬ä¸Šé¢åˆ†æè¿‡äº†ï¼ŒReactä»¥é˜Ÿåˆ—çš„å½¢å¼å¤„ç†åˆæˆäº‹ä»¶ã€‚æ–¹æ³•å…¥å£ä¸ºrunEventQueueInBatchï¼Œå¦‚ä¸‹</p><pre><code class="javascript">  function runEventQueueInBatch(events) {      // å…ˆå°†eventsäº‹ä»¶æ”¾å…¥é˜Ÿåˆ—ä¸­      EventPluginHub.enqueueEvents(events);      // å†å¤„ç†é˜Ÿåˆ—ä¸­çš„äº‹ä»¶,åŒ…æ‹¬ä¹‹å‰æœªå¤„ç†å®Œçš„ã€‚å…ˆå…¥å…ˆå¤„ç†åŸåˆ™      EventPluginHub.processEventQueue(false);  }  /**   * syntheticEventæ”¾å…¥é˜Ÿåˆ—ä¸­,ç­‰åˆ°processEventQueueå†è·å¾—æ‰§è¡Œ   */  enqueueEvents: function (events) {    if (events) {      eventQueue = accumulateInto(eventQueue, events);    }  },  /**   * åˆ†å‘æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„Reactåˆæˆäº‹ä»¶ã€‚Reactäº‹ä»¶æ˜¯é‡‡ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ–¹å¼æ‰¹å¤„ç†çš„   *   * simulatedï¼šä¸ºtrueè¡¨ç¤ºReactæµ‹è¯•ä»£ç ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯false    */  processEventQueue: function (simulated) {    // å…ˆå°†eventQueueé‡ç½®ä¸ºç©º    var processingEventQueue = eventQueue;    eventQueue = null;    if (simulated) {      forEachAccumulated(processingEventQueue, executeDispatchesAndReleaseSimulated);    } else {      // éå†å¤„ç†é˜Ÿåˆ—ä¸­çš„äº‹ä»¶,      // å¦‚æœåªæœ‰ä¸€ä¸ªå…ƒç´ ,åˆ™ç›´æ¥executeDispatchesAndReleaseTopLevel(processingEventQueue)      // å¦åˆ™éå†é˜Ÿåˆ—ä¸­äº‹ä»¶,è°ƒç”¨executeDispatchesAndReleaseTopLevelå¤„ç†æ¯ä¸ªå…ƒç´       forEachAccumulated(processingEventQueue, executeDispatchesAndReleaseTopLevel);    }    // This would be a good time to rethrow if any of the event handlers threw.    ReactErrorUtils.rethrowCaughtError();  },</code></pre><p>åˆæˆäº‹ä»¶å¤„ç†ä¹Ÿåˆ†ä¸ºä¸¤æ­¥ï¼Œå…ˆå°†æˆ‘ä»¬è¦å¤„ç†çš„eventsé˜Ÿåˆ—æ”¾å…¥eventQueueä¸­ï¼Œå› ä¸ºä¹‹å‰å¯èƒ½å°±å­˜åœ¨è¿˜æ²¡å¤„ç†å®Œçš„åˆæˆäº‹ä»¶ã€‚ç„¶åå†æ‰§è¡ŒeventQueueä¸­çš„äº‹ä»¶ã€‚å¯è§ï¼Œå¦‚æœä¹‹å‰æœ‰äº‹ä»¶æœªå¤„ç†å®Œï¼Œè¿™é‡Œå°±åˆæœ‰å¾—åˆ°æ‰§è¡Œçš„æœºä¼šäº†ã€‚</p><p>äº‹ä»¶æ‰§è¡Œçš„å…¥å£æ–¹æ³•ä¸ºexecuteDispatchesAndReleaseTopLevelï¼Œå¦‚ä¸‹</p><pre><code class="javascript">var executeDispatchesAndReleaseTopLevel = function (e) {  return executeDispatchesAndRelease(e, false);};var executeDispatchesAndRelease = function (event, simulated) {  if (event) {    // è¿›è¡Œäº‹ä»¶åˆ†å‘,    EventPluginUtils.executeDispatchesInOrder(event, simulated);    if (!event.isPersistent()) {      // å¤„ç†å®Œ,åˆ™releaseæ‰eventå¯¹è±¡,é‡‡ç”¨å¯¹è±¡æ± æ–¹å¼,å‡å°‘GC      // Reactå¸®æˆ‘ä»¬å¤„ç†äº†åˆæˆäº‹ä»¶çš„å›æ”¶æœºåˆ¶ï¼Œä¸éœ€è¦æˆ‘ä»¬å…³å¿ƒã€‚ä½†è¦æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨äº†DOMåŸç”Ÿäº‹ä»¶ï¼Œåˆ™è¦è‡ªå·±å›æ”¶      event.constructor.release(event);    }  }};// äº‹ä»¶å¤„ç†çš„æ ¸å¿ƒfunction executeDispatchesInOrder(event, simulated) {  var dispatchListeners = event._dispatchListeners;  var dispatchInstances = event._dispatchInstances;  if (Array.isArray(dispatchListeners)) {    // å¦‚æœæœ‰å¤šä¸ªlistener,åˆ™éå†æ‰§è¡Œæ•°ç»„ä¸­event    for (var i = 0; i &lt; dispatchListeners.length; i++) {      // å¦‚æœisPropagationStoppedè®¾æˆtrueäº†,åˆ™åœæ­¢äº‹ä»¶ä¼ æ’­,é€€å‡ºå¾ªç¯ã€‚      if (event.isPropagationStopped()) {        break;      }      // æ‰§è¡Œeventçš„åˆ†å‘,ä»å½“å‰è§¦å‘äº‹ä»¶å…ƒç´ å‘çˆ¶å…ƒç´ éå†      // eventä¸ºæµè§ˆå™¨ä¸Šä¼ çš„åŸç”Ÿäº‹ä»¶      // dispatchListeners[i]ä¸ºJSXä¸­å£°æ˜çš„äº‹ä»¶callback      // dispatchInstances[i]ä¸ºå¯¹åº”çš„React Component       executeDispatch(event, simulated, dispatchListeners[i], dispatchInstances[i]);    }  } else if (dispatchListeners) {    // å¦‚æœåªæœ‰ä¸€ä¸ªlistener,åˆ™ç›´æ¥æ‰§è¡Œäº‹ä»¶åˆ†å‘    executeDispatch(event, simulated, dispatchListeners, dispatchInstances);  }  // å¤„ç†å®Œevent,é‡ç½®å˜é‡ã€‚å› ä¸ºä½¿ç”¨çš„å¯¹è±¡æ± ,æ•…å¿…é¡»é‡ç½®,è¿™æ ·æ‰èƒ½è¢«åˆ«äººå¤ç”¨  event._dispatchListeners = null;  event._dispatchInstances = null;}</code></pre><p>executeDispatchesInOrderä¼šå…ˆå¾—åˆ°eventå¯¹åº”çš„listenersé˜Ÿåˆ—ï¼Œç„¶åä»å½“å‰å…ƒç´ å‘çˆ¶å…ƒç´ éå†æ‰§è¡Œæ³¨å†Œçš„callbackã€‚ä¸”çœ‹executeDispatch</p><pre><code class="javascript">function executeDispatch(event, simulated, listener, inst) {  var type = event.type || &#39;unknown-event&#39;;  event.currentTarget = EventPluginUtils.getNodeFromInstance(inst);  if (simulated) {    // testä»£ç ä½¿ç”¨,æ”¯æŒtry-catch,å…¶ä»–å°±æ²¡å•¥åŒºåˆ«äº†    ReactErrorUtils.invokeGuardedCallbackWithCatch(type, listener, event);  } else {    // äº‹ä»¶åˆ†å‘,listenerä¸ºcallback,eventä¸ºå‚æ•°,ç±»ä¼¼listener(event)è¿™ä¸ªæ–¹æ³•è°ƒç”¨    // è¿™æ ·å°±å›è°ƒåˆ°äº†æˆ‘ä»¬åœ¨JSXä¸­æ³¨å†Œçš„callbackã€‚æ¯”å¦‚onClick={(event) =&gt; {console.log(1)}}    // è¿™æ ·åº”è¯¥å°±æ˜ç™½äº†callbackæ€ä¹ˆè¢«è°ƒç”¨çš„,ä»¥åŠeventå‚æ•°æ€ä¹ˆä¼ å…¥callbacké‡Œé¢çš„äº†    ReactErrorUtils.invokeGuardedCallback(type, listener, event);  }  event.currentTarget = null;}// é‡‡ç”¨func(a)çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ï¼Œ// æ•…ReactErrorUtils.invokeGuardedCallback(type, listener, event)æœ€ç»ˆè°ƒç”¨çš„æ˜¯listener(event)// eventå¯¹è±¡ä¸ºæµè§ˆå™¨ä¼ é€’çš„DOMåŸç”Ÿäº‹ä»¶å¯¹è±¡ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆReactåˆæˆäº‹ä»¶å›è°ƒä¸­èƒ½æ‹¿åˆ°åŸç”Ÿeventçš„åŸå› function invokeGuardedCallback(name, func, a) {  try {    func(a);  } catch (x) {    if (caughtError === null) {      caughtError = x;    }  }}</code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Reactäº‹ä»¶ç³»ç»Ÿè¿˜æ˜¯ç›¸å½“éº»çƒ¦çš„ï¼Œä¸»è¦åˆ†ä¸ºäº‹ä»¶æ³¨å†Œï¼Œäº‹ä»¶å­˜å‚¨å’Œäº‹ä»¶æ‰§è¡Œä¸‰å¤§éƒ¨åˆ†ã€‚äº†è§£äº†Reactäº‹ä»¶ç³»ç»Ÿæºç ï¼Œå°±èƒ½å¤Ÿè½»æ¾å›ç­”æˆ‘ä»¬æ–‡ç« å¼€å¤´æ‰€åˆ—å‡ºçš„Reactäº‹ä»¶å‡ å¤§ç‰¹ç‚¹äº†ã€‚</p><p><a href="https://yq.aliyun.com/articles/72421?spm=a2c4e.11153940.blogcont72750.23.2375fe1fR29Lpk" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Reactæºç åˆ†æ 5 ç»„ä»¶é€šä¿¡ï¼Œref,key,ReactDOM</title>
      <link href="/2018/03/27/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-5-%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%EF%BC%8Cref-key-ReactDOM/"/>
      <url>/2018/03/27/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-5-%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%EF%BC%8Cref-key-ReactDOM/</url>
      
        <content type="html"><![CDATA[<h1 id="ç»„ä»¶ä¹‹é—´é€šä¿¡"><a href="#ç»„ä»¶ä¹‹é—´é€šä¿¡" class="headerlink" title="ç»„ä»¶ä¹‹é—´é€šä¿¡"></a>ç»„ä»¶ä¹‹é—´é€šä¿¡</h1><h2 id="çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡"><a href="#çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡" class="headerlink" title="çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡"></a>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡</h2><p>Reactè§„å®šäº†æ˜ç¡®çš„å•å‘æ•°æ®æµï¼Œåˆ©ç”¨propså°†æ•°æ®ä»çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶ã€‚æ•…æˆ‘ä»¬å¯ä»¥åˆ©ç”¨propsï¼Œè®©çˆ¶ç»„ä»¶ç»™å­ç»„ä»¶é€šä¿¡ã€‚æ•…çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡è¿˜æ˜¯å¾ˆå®¹æ˜“å®ç°çš„ã€‚å¼•ç”³ä¸€ç‚¹ï¼Œçˆ¶ç»„ä»¶æ€ä¹ˆå‘å­™å­ç»„ä»¶é€šä¿¡å‘¢ï¼Ÿå¯ä»¥åˆ©ç”¨propsè¿›è¡Œå±‚å±‚ä¼ é€’ï¼Œä½¿ç”¨ES6çš„â€¦è¿ç®—ç¬¦å¯ä»¥ç”¨å¾ˆç®€æ´çš„æ–¹å¼æŠŠpropsä¼ é€’ç»™å­™å­ç»„ä»¶ã€‚è¿™é‡Œæˆ‘ä»¬å°±ä¸ä¸¾ä¾‹äº†ã€‚</p><p>è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒsetProps,replacePropsä¸¤ä¸ªAPIå·²ç»è¢«åºŸå¼ƒäº†ï¼ŒReactå»ºè®®æˆ‘ä»¬åœ¨é¡¶å±‚ä½¿ç”¨ReactDOM.reader()è¿›è¡Œpropsæ›´æ–°ã€‚</p><h2 id="å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡"><a href="#å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡" class="headerlink" title="å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡"></a>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡</h2><p>Reactæ•°æ®æµæ˜¯å•å‘çš„ï¼Œåªèƒ½ä»çˆ¶ç»„ä»¶ä¼ é€’åˆ°å­ç»„ä»¶ã€‚é‚£ä¹ˆå­ç»„ä»¶æ€ä¹ˆå‘çˆ¶ç»„ä»¶é€šä¿¡å‘¢ï¼Ÿå…¶å®ä»ç„¶å¯ä»¥åˆ©ç”¨propsã€‚çˆ¶ç»„ä»¶åˆ©ç”¨propsä¼ é€’æ–¹æ³•ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶å›è°ƒè¿™ä¸ªæ–¹æ³•çš„åŒæ—¶ï¼Œå°†æ•°æ®ä¼ é€’è¿›å»ï¼Œä½¿å¾—çˆ¶ç»„ä»¶çš„ç›¸å…³æ–¹æ³•å¾—åˆ°å›è°ƒï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æŠŠæ•°æ®ä»å­ç»„ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶äº†ã€‚çœ‹ä¸€ä¸ªä¾‹å­ã€‚</p><pre><code class="javascript">class Parent extends React.Component {  handleChildMsg(msg) {    // çˆ¶ç»„ä»¶å¤„ç†æ¶ˆæ¯    console.log(&quot;parent: &quot; + msg);  }  render() {    return (      &lt;div&gt;          &lt;Child transferMsg = {msg =&gt; this.handleChildMsg(msg)} /&gt;      &lt;/div&gt;    );  }}class Child extends React.Component {  componentDidMount() {    // å­ç»„ä»¶ä¸­è°ƒç”¨çˆ¶ç»„ä»¶çš„æ–¹æ³•ï¼Œå°†æ•°æ®ä»¥å‚æ•°çš„æ–¹å¼ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼Œè¿™æ ·çˆ¶ç»„ä»¶æ–¹æ³•å°±å¾—åˆ°å›è°ƒäº†ï¼Œä¹Ÿæ”¶åˆ°æ•°æ®äº†    this.props.transferMsg(&quot;child has mounted&quot;);  }  render() {    return (      &lt;div&gt;child&lt;/div&gt;    )  }}</code></pre><a id="more"></a><p>è¿™ä¸ªä¾‹å­åº”è¯¥å¾ˆæ¸…æ¥šäº†ï¼Œé€šè¿‡å›è°ƒçš„æ–¹å¼ï¼Œå¯ä»¥å°†æ•°æ®ä»å­ç»„ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶ã€‚å¼•ç”³ä¸€ä¸‹ï¼Œå­™å­ç»„ä»¶æ€ä¹ˆæŠŠæ•°æ®ä¼ é€’ç»™çˆ¶ç»„ä»¶å‘¢ï¼ŸåŒæ ·å¯ä»¥åˆ©ç”¨propså±‚å±‚å›è°ƒã€‚åˆ©ç”¨ES6çš„<strong>â€¦è¿ç®—ç¬¦</strong>ä¹Ÿå¯ä»¥ç”¨æ¯”è¾ƒç®€æ´çš„æ–¹å¼å®Œæˆpropså±‚å±‚å›è°ƒã€‚</p><h2 id="å…„å¼Ÿç»„ä»¶é€šä¿¡-å‘å¸ƒ-è®¢é˜…"><a href="#å…„å¼Ÿç»„ä»¶é€šä¿¡-å‘å¸ƒ-è®¢é˜…" class="headerlink" title="å…„å¼Ÿç»„ä»¶é€šä¿¡ - å‘å¸ƒ/è®¢é˜…"></a>å…„å¼Ÿç»„ä»¶é€šä¿¡ - å‘å¸ƒ/è®¢é˜…</h2><p>å…„å¼Ÿç»„ä»¶å¯ä»¥åˆ©ç”¨çˆ¶ç»„ä»¶è¿›è¡Œä¸­è½¬ï¼Œå°†æ•°æ®å…ˆç”±child1ä¼ ç»™parentï¼Œç„¶åparentä¼ ç»™child2. è¿™ä¸ªæ–¹æ³•æ˜¾ç„¶è€¦åˆæ¯”è¾ƒä¸¥é‡ï¼Œä¼ é€’æ¬¡æ•°è¿‡å¤šï¼Œå®¹æ˜“å¼•å‘çˆ¶ç»„ä»¶ä¸å¿…è¦çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œç”šè‡³å½±å“å…¶ä»–å­ç»„ä»¶ï¼Œæ•…å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨è¿™ä¸ªæ–¹å¼ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è§‚å¯Ÿè€…æ¨¡å¼é‡‡ç”¨å‘å¸ƒ/è®¢é˜…çš„æ–¹æ³•ï¼Œå¯ä»¥å°†æ¶ˆæ¯å‘é€è€…å’Œæ¥æ”¶è€…å®Œç¾è§£è€¦ã€‚Reactä¸­å¯ä»¥å¼•å…¥eventProxyæ¨¡å—ï¼Œåˆ©ç”¨eventProxy.trigger()æ–¹æ³•å‘å¸ƒæ¶ˆæ¯ï¼ŒeventProxy.on()æ–¹æ³•ç›‘å¬å¹¶æ¥æ”¶æ¶ˆæ¯ã€‚eventProxyæˆ‘ä»¬å°±ä¸å±•å¼€è®²äº†ã€‚ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­</p><pre><code class="javascript">import eventProxy from &#39;../eventProxy&#39;class Child1 extends React.Component {  componentDidMount() {    // å‘å¸ƒè€…ï¼Œå‘å‡ºæ¶ˆæ¯    eventProxy.trigger(&#39;msg&#39;, &#39;child1 has been mounted&#39;);  }  render() {    return (      &lt;div&gt;child1&lt;/div&gt;    );  }}class Child2 extends React.Component {  componentDidMount() {    // è®¢é˜…è€…ï¼Œç›‘å¬å¹¶æ¥æ”¶æ¶ˆæ¯    eventProxy.on(&#39;msg&#39;, (msg) =&gt; {console.log(&#39;msg: &#39; + msg)});  }  render() {    return (      &lt;div&gt;child2&lt;/div&gt;    );  } }</code></pre><h2 id="åµŒå¥—å±‚çº§æ·±ç»„ä»¶-context"><a href="#åµŒå¥—å±‚çº§æ·±ç»„ä»¶-context" class="headerlink" title="åµŒå¥—å±‚çº§æ·±ç»„ä»¶ - context"></a>åµŒå¥—å±‚çº§æ·±ç»„ä»¶ - context</h2><p>ç¥–çˆ¶ç»„ä»¶å’Œå­™å­ç»„ä»¶é€šä¿¡æ—¶ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™è¿˜æ˜¯è§‰å¾—é€šè¿‡propsæœ‰ç‚¹ç¹çäº†ã€‚æ­¤æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨contextå…¨å±€å˜é‡ã€‚</p><blockquote><p>ä½¿ç”¨æ–¹æ³•ï¼š<br>1.ç¥–çˆ¶ç»„ä»¶ä¸­å®šä¹‰getChildContext()æ–¹æ³•ï¼Œå°†è¦ä¼ é€’ç»™å­™å­çš„æ•°æ®æ”¾åœ¨å…¶ä¸­<br>2.ç¥–çˆ¶ç»„ä»¶ä¸­childContextTypesç”³æ˜è¦ä¼ é€’çš„æ•°æ®ç±»å‹<br>3.å­™å­ç»„ä»¶ä¸­contextTypesç”³æ˜å¯ä»¥æ¥æ”¶çš„æ•°æ®ç±»å‹<br>4.å­™å­ç»„ä»¶é€šè¿‡this.contextè®¿é—®ç¥–çˆ¶ä¼ é€’è¿›æ¥çš„æ•°æ®ã€‚</p></blockquote><p>é‡‡ç”¨å…¨å±€å˜é‡çš„æ–¹å¼ï¼Œå®¹æ˜“å¯¼è‡´æ•°æ®æ··ä¹±ï¼Œåˆ†ä¸æ¸…æ•°æ®æ˜¯ä»å“ªå„¿æ¥çš„ï¼Œä¸å®¹æ˜“æ§åˆ¶ã€‚å»ºè®®å°‘ç”¨è¿™ç§æ–¹å¼ã€‚</p><h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p>è¿˜å¯ä»¥åˆ©ç”¨Fluxå’ŒReduxæ¶æ„æ¥è¿›è¡Œç»„ä»¶é€šä¿¡ï¼Œè¿™ä¸ªæˆ‘ä»¬ä»¥åå†ä¸“é—¨è¯¦ç»†åˆ†æã€‚</p><h1 id="refs"><a href="#refs" class="headerlink" title="refs"></a>refs</h1><h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><p>æˆ‘ä»¬åœ¨getRender()è¿”å›çš„JSXä¸­ï¼Œå¯ä»¥åœ¨æ ‡ç­¾ä¸­åŠ å…¥refå±æ€§ï¼Œç„¶åé€šè¿‡refs.refå°±å¯ä»¥è®¿é—®åˆ°æˆ‘ä»¬çš„Componentäº†ï¼Œä¾‹å¦‚ã€‚</p><pre><code class="javascript">class Parent extends React.Component {  getRender() {    &lt;div&gt;      &lt;Child ref = &#39;child&#39; /&gt;    &lt;/div&gt;  }  componentDidMount() {    // é€šè¿‡refså¯ä»¥æ‹¿åˆ°å­å…ƒç´ ,ç„¶åå°±å¯ä»¥è®¿é—®åˆ°å­å…ƒç´ çš„æ–¹æ³•äº†    let child = this.refs.child;    child.test();  }}class Child extends React.Component {  test() {    console.log(&quot;child method called by ref&quot;);  }}</code></pre><h2 id="attachRef-å°†å­ç»„ä»¶å¼•ç”¨ä¿å­˜åˆ°çˆ¶ç»„ä»¶refså¯¹è±¡ä¸­"><a href="#attachRef-å°†å­ç»„ä»¶å¼•ç”¨ä¿å­˜åˆ°çˆ¶ç»„ä»¶refså¯¹è±¡ä¸­" class="headerlink" title="attachRef å°†å­ç»„ä»¶å¼•ç”¨ä¿å­˜åˆ°çˆ¶ç»„ä»¶refså¯¹è±¡ä¸­"></a>attachRef å°†å­ç»„ä»¶å¼•ç”¨ä¿å­˜åˆ°çˆ¶ç»„ä»¶refså¯¹è±¡ä¸­</h2><p>refsçš„ç”¨æ³•å¾ˆç®€å•ï¼Œåªéœ€è¦JSXä¸­å®šä¹‰å¥½refå±æ€§å³å¯ã€‚é‚£ä¹ˆé¦–å…ˆä¸€ä¸ªé—®é¢˜æ¥äº†ï¼Œrefsè¿™ä¸ªå¯¹è±¡åœ¨å“ªå„¿å®šä¹‰çš„å‘¢ï¼Ÿè¿˜è®°å¾—createClassæ–¹æ³•çš„constructorå§ï¼Œå®ƒé‡Œé¢ä¼šå®šä¹‰å¹¶åˆå§‹åŒ–refså¯¹è±¡ã€‚æºç å¦‚ä¸‹</p><pre><code class="javascript">createClass: function (spec) {    // è‡ªå®šä¹‰Reactç±»çš„æ„é€ æ–¹æ³•ï¼Œé€šè¿‡å®ƒåˆ›å»ºä¸€ä¸ªReact.Componentå¯¹è±¡    var Constructor = identity(function (props, context, updater) {      // Wire up auto-binding      if (this.__reactAutoBindPairs.length) {        bindAutoBindMethods(this);      }      this.props = props;      this.context = context;      // refsåˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºå¯¹è±¡      this.refs = emptyObject;      this.updater = updater || ReactNoopUpdateQueue;      // è°ƒç”¨getInitialStateåˆå§‹åŒ–state      this.state = null;      var initialState = this.getInitialState ? this.getInitialState() : null;      this.state = initialState;    });    ...}</code></pre><p>ä»ä¸Šé¢ä»£ç å¯è§ï¼Œæ¯æ¬¡åˆ›å»ºè‡ªå®šä¹‰ç»„ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆå§‹åŒ–ä¸€ä¸ªä¸ºç©ºçš„refså¯¹è±¡ã€‚é‚£ä¹ˆç¬¬äºŒä¸ªé—®é¢˜æ¥äº†ï¼Œrefå­—ç¬¦ä¸²æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å¼•ç”¨ï¼Œæ˜¯ä»€ä¹ˆæ—¶å€™åŠ å…¥åˆ°refså¯¹è±¡ä¸­çš„å‘¢ï¼Ÿç­”æ¡ˆå°±åœ¨ReactCompositeComponentçš„attachRefæ–¹æ³•ä¸­ï¼Œæºç å¦‚ä¸‹</p><pre><code class="javascript">  attachRef: function(ref, component) {    // getPublicInstanceè¿”å›æˆ‘ä»¬çš„çˆ¶ç»„ä»¶    var inst = this.getPublicInstance();    var publicComponentInstance = component.getPublicInstance();    var refs = inst.refs === emptyObject ? (inst.refs = {}) : inst.refs;    // å°†å­å…ƒç´ çš„å¼•ç”¨ï¼Œä»¥refå±æ€§ä¸ºkey,ä¿å­˜åˆ°çˆ¶å…ƒç´ çš„refså¯¹è±¡ä¸­    refs[ref] = publicComponentInstance;  },</code></pre><p>attachRefæ–¹æ³•åˆæ˜¯ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨çš„å‘¢ï¼Ÿæˆ‘ä»¬è¿™å„¿å°±ä¸æºç åˆ†æäº†ã€‚å¤§æ¦‚è¯´ä¸‹ï¼ŒmountComponentä¸­ï¼Œå¦‚æœelementçš„refå±æ€§ä¸ä¸ºç©ºï¼Œåˆ™ä¼šä»¥transactionäº‹åŠ¡çš„æ–¹å¼è°ƒç”¨attachRefsæ–¹æ³•ï¼Œè€ŒattachRefsæ–¹æ³•ä¸­åˆ™ä¼šè°ƒç”¨attachRefæ–¹æ³•ï¼Œå°†å­ç»„ä»¶çš„å¼•ç”¨ä¿å­˜åˆ°çˆ¶ç»„ä»¶çš„refså¯¹è±¡ä¸­ã€‚</p><h2 id="detachRef-ä»çˆ¶ç»„ä»¶refså¯¹è±¡ä¸­åˆ é™¤å­ç»„ä»¶å¼•ç”¨"><a href="#detachRef-ä»çˆ¶ç»„ä»¶refså¯¹è±¡ä¸­åˆ é™¤å­ç»„ä»¶å¼•ç”¨" class="headerlink" title="detachRef ä»çˆ¶ç»„ä»¶refså¯¹è±¡ä¸­åˆ é™¤å­ç»„ä»¶å¼•ç”¨"></a>detachRef ä»çˆ¶ç»„ä»¶refså¯¹è±¡ä¸­åˆ é™¤å­ç»„ä»¶å¼•ç”¨</h2><p>å¯¹å†…å­˜ç®¡ç†æœ‰äº›äº†è§£çš„åŒå­¦è‚¯å®šä¼šæœ‰ç–‘æƒ‘ï¼Œæ—¢ç„¶çˆ¶ç»„ä»¶çš„refsä¸­ä¿å­˜äº†å­ç»„ä»¶å¼•ç”¨ï¼Œé‚£ä¹ˆå½“å­ç»„ä»¶è¢«unmountComponentè€Œé”€æ¯æ—¶ï¼Œå­ç»„ä»¶çš„å¼•ç”¨ä»ç„¶ä¿å­˜åœ¨refså¯¹è±¡ä¸­ï¼Œå²‚ä¸æ˜¯ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼ŸReactå½“ç„¶ä¸ä¼šæœ‰è¿™ä¸ªbugäº†ï¼Œç§˜å¯†å°±åœ¨detachRefæ–¹æ³•ä¸­ï¼Œæºç å¦‚ä¸‹</p><pre><code class="javascript">  detachRef: function(ref) {    var refs = this.getPublicInstance().refs;    // ä»refså¯¹è±¡ä¸­åˆ é™¤keyä¸ºrefå­å…ƒç´ ,é˜²æ­¢å†…å­˜æ³„æ¼    delete refs[ref];  },</code></pre><p>ä»£ç å¾ˆç®€å•ï¼Œdeleteæ‰refå­—ç¬¦ä¸²æŒ‡å‘çš„æˆå‘˜å³å¯ã€‚è‡³äºdetachRefçš„è°ƒç”¨é“¾ï¼Œæˆ‘ä»¬è¿˜å¾—ä»unmountComponentæ–¹æ³•è¯´èµ·ã€‚unmountComponentä¼šè°ƒç”¨detachRefsæ–¹æ³•ï¼Œè€ŒdetachRefsä¸­åˆ™ä¼šè°ƒç”¨detachRefï¼Œä»è€Œå°†å­å…ƒç´ å¼•ç”¨ä»refsä¸­é‡Šæ”¾æ‰ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨unmountComponentæ—¶ï¼ŒReactè‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆäº†å­å…ƒç´ refåˆ é™¤ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</p><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>å½“æˆ‘ä»¬çš„å­ç»„ä»¶æ˜¯ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œæ¯”å¦‚ç±»ä¼¼äºAndroidä¸­çš„ListViewï¼Œä¸€ä¸ªåˆ—è¡¨ä¸­æœ‰å¾ˆå¤šæ ·å¼ä¸€è‡´çš„é¡¹ï¼Œæ­¤æ—¶ç»™æ¯ä¸ªé¡¹åŠ ä¸Škeyè¿™ä¸ªå±æ€§å°±å¾ˆæœ‰ä½œç”¨äº†ã€‚keyå¯ä»¥æ ‡ç¤ºå½“å‰é¡¹çš„å”¯ä¸€æ€§ã€‚</p><p>å¯¹äºæ•°ç»„ï¼Œå…¶å†…éƒ¨åŒ…å«é•¿åº¦ä¸ç¡®å®šçš„å­é¡¹ã€‚å½“ç»„ä»¶stateå˜åŒ–æ—¶ï¼Œéœ€è¦é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚é‚£ä¹ˆæœ‰ä¸ªé—®é¢˜æ¥äº†ï¼ŒReactæ˜¯æ›´æ–°ç»„ä»¶ï¼Œè¿˜æ˜¯å…ˆé”€æ¯å†æ–°å»ºç»„ä»¶å‘¢ã€‚keyå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚å¦‚æœå‰åä¸¤æ¬¡keyä¸å˜ï¼Œåˆ™åªéœ€è¦æ›´æ–°ï¼Œå¦åˆ™å…ˆé”€æ¯å†æ›´æ–°ã€‚</p><p>å¯¹äºå­é¡¹çš„keyï¼Œå¿…é¡»æ˜¯å”¯ä¸€ä¸é‡å¤çš„ã€‚å¹¶ä¸”å°½é‡ä¼ ä¸å˜çš„å±æ€§ï¼Œåƒä¸‡ä¸è¦ä¼ æ— æ„ä¹‰çš„indexæˆ–è€…éšæœºå€¼ã€‚è¿™æ ·æ‰èƒ½å°½é‡ä»¥æ›´æ–°çš„æ–¹å¼æ¥é‡æ–°æ¸²æŸ“ã€‚Reactæºç ä¸­åˆ¤æ–­æ›´æ–°æ–¹å¼çš„æºç å¦‚ä¸‹</p><pre><code class="javascript">function shouldUpdateReactComponent(prevElement, nextElement) {  // å‰åä¸¤æ¬¡ReactElementä¸­ä»»ä½•ä¸€ä¸ªä¸ºnullï¼Œåˆ™å¿…é¡»å¦ä¸€ä¸ªä¸ºnullæ‰è¿”å›trueã€‚è¿™ç§æƒ…å†µä¸€èˆ¬ä¸ä¼šç¢°åˆ°  var prevEmpty = prevElement === null || prevElement === false;  var nextEmpty = nextElement === null || nextElement === false;  if (prevEmpty || nextEmpty) {    return prevEmpty === nextEmpty;  }  var prevType = typeof prevElement;  var nextType = typeof nextElement;  // React DOM diffç®—æ³•  if (prevType === &#39;string&#39; || prevType === &#39;number&#39;) {    // å¦‚æœå‰åä¸¤æ¬¡ä¸ºæ•°å­—æˆ–è€…å­—ç¬¦,åˆ™è®¤ä¸ºåªéœ€è¦update(å¤„ç†æ–‡æœ¬å…ƒç´ )ï¼Œè¿”å›true    return (nextType === &#39;string&#39; || nextType === &#39;number&#39;);  } else {      // å¦‚æœå‰åä¸¤æ¬¡ä¸ºDOMå…ƒç´ æˆ–Reactå…ƒç´ ,åˆ™å¿…é¡»typeå’Œkeyä¸å˜(keyç”¨äºlistViewç­‰ç»„ä»¶,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰è®¾ç½®keyï¼Œæ•…åªéœ€typeç›¸åŒ)æ‰update,å¦åˆ™å…ˆunmountå†é‡æ–°mountã€‚è¿”å›false    return (      nextType === &#39;object&#39; &amp;&amp;      prevElement.type === nextElement.type &amp;&amp;      prevElement.key === nextElement.key    );  }}</code></pre><p>çœ‹åˆ°keyè¿™ä¸ªå±æ€§çš„é‡è¦æ€§äº†å§ã€‚å¯¹äºæ•°ç»„ç»„ä»¶ï¼Œæˆ‘ä»¬ä¸€å®šè¦åœ¨æ¯ä¸ªå­é¡¹ä¸Šè®¾ç½®ä¸€ä¸ªkeyï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜DOM diffçš„æ€§èƒ½ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆæ•°ç»„ç»„ä»¶ä¹‹å¤–çš„å…¶ä»–ç»„ä»¶ï¼Œä¸ç”¨è®¾ç½®keyå‘¢ï¼Ÿå› ä¸ºä»–ä»¬çš„typeæˆ–è€…åœ¨çˆ¶ç»„ä»¶ä¸­çš„ä½ç½®ä¸åŒï¼Œå®Œå…¨å¯ä»¥åŒºåˆ†å¼€ï¼Œæ‰€ä»¥ä¸éœ€è¦keyå°±å¯ä»¥å®Œå…¨ç¡®å®šæ˜¯å“ªä¸ªç»„ä»¶</p><h1 id="æ— çŠ¶æ€ç»„ä»¶"><a href="#æ— çŠ¶æ€ç»„ä»¶" class="headerlink" title="æ— çŠ¶æ€ç»„ä»¶"></a>æ— çŠ¶æ€ç»„ä»¶</h1><p>æ— çŠ¶æ€ç»„ä»¶å…¶å®æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼ å…¥propså³å¯ï¼Œæ²¡æœ‰stateï¼Œä¹Ÿæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ç»„ä»¶æœ¬èº«å¯¹åº”çš„å°±æ˜¯renderæ–¹æ³•ã€‚ä¾‹å­å¦‚ä¸‹</p><pre><code class="javascript">function Title({color = &#39;red&#39;, text = &#39;æ ‡é¢˜&#39;}) {  let style = {    &#39;color&#39;: color  }  return (    &lt;div style = {style}&gt;{text}&lt;/div&gt;  )}</code></pre><p>æ— çŠ¶æ€ç»„ä»¶ä¸ä¼šåˆ›å»ºå¯¹è±¡ï¼Œæ•…æ¯”è¾ƒçœå†…å­˜ã€‚æ²¡æœ‰å¤æ‚çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è°ƒç”¨ï¼Œæ•…æµç¨‹æ¯”è¾ƒç®€å•ã€‚æ²¡æœ‰stateï¼Œä¹Ÿä¸ä¼šé‡å¤æ¸²æŸ“ã€‚å®ƒæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°è€Œå·²ã€‚</p><p>å¯¹äºæ²¡æœ‰çŠ¶æ€å˜åŒ–çš„ç»„ä»¶ï¼ŒReactå»ºè®®æˆ‘ä»¬ä½¿ç”¨æ— çŠ¶æ€ç»„ä»¶ã€‚æ€»ä¹‹ï¼Œèƒ½ç”¨æ— çŠ¶æ€ç»„ä»¶çš„åœ°æ–¹ï¼Œå°±ç”¨æ— çŠ¶æ€ç»„ä»¶ã€‚</p><h1 id="react-DOM"><a href="#react-DOM" class="headerlink" title="react DOM"></a>react DOM</h1><p>Reacté€šè¿‡findDOMNode()å¯ä»¥æ‰¾åˆ°ç»„ä»¶å®ä¾‹å¯¹åº”çš„DOMèŠ‚ç‚¹ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åªèƒ½åœ¨render()ä¹‹åï¼Œä¹Ÿå°±æ˜¯componentDidMount()å’ŒcomponentDidUpdate()ä¸­è°ƒç”¨ã€‚å› ä¸ºåªæœ‰renderåï¼ŒDOMå¯¹è±¡æ‰ç”Ÿæˆäº†ã€‚</p><pre><code class="javascript">class example extends React.Component {  componentDidMount() {    // åªæœ‰renderåæ‰ç”Ÿæˆäº†DOM nodeï¼Œæ‰èƒ½è°ƒç”¨findDOMNode    let dom = ReactDOM.findDOMNode(this);  }}</code></pre><p>é‚£ä¸ºä»€ä¹ˆrenderåDOMæ‰ç”Ÿæˆå‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ä»æºç è§’åº¦æ¥åˆ†æã€‚Reactæºç åˆ†æ3 â€” Reactç»„ä»¶æ’å…¥DOMæµç¨‹ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“mountComponentè§£æå¾—åˆ°äº†markupï¼Œä¹Ÿå°±æ˜¯Reactç»„ä»¶å¯¹åº”çš„HTMLï¼Œä¼šç”±_mountImageIntoNodeæ–¹æ³•æ’å…¥åˆ°çœŸå®DOMä¸­ï¼Œæ•…è¿™ä¸ªäº‹åŠ¡ç»“æŸåï¼Œæ‰ç”Ÿæˆäº†çœŸæ­£çš„DOMã€‚æ•…è‚¯å®šåªæœ‰renderä¹‹åï¼Œæ‰æœ‰çœŸå®çš„DOMå¯ä»¥è¢«è®¿é—®ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆcomponentDidMount()èƒ½è®¿é—®DOMå‘¢ï¼Ÿå®ƒä¸æ˜¯ä¹Ÿåœ¨mountComponent()æ–¹æ³•æµç¨‹ä¸­å—ï¼Ÿè¿™æ˜¯å› ä¸ºReacté‡‡ç”¨å¼‚æ­¥äº‹åŠ¡çš„æ–¹å¼æ¥è°ƒç”¨componentDidMountçš„ï¼Œå®ƒæŠŠcomponentDidMountæ”¾åˆ°ä¸€ä¸ªäº‹åŠ¡é˜Ÿåˆ—ä¸­ï¼Œåªæœ‰å½“å‰mountComponentè¿™ä¸ªäº‹åŠ¡å¤„ç†å®Œäº†ï¼Œæ‰ä¼šå›è¿‡å¤´å»å¤„ç†componentDidMountï¼Œæ•…åœ¨componentDidMountä¸­å¯ä»¥æ‹¿åˆ°çœŸå®çš„DOMã€‚è¿™ä¸ªè®¾è®¡å¾—ç»™Reactç‚¹èµã€‚è¿™ä¸€ç‚¹å¯ä»¥ä»æºç æ¥åˆ†æã€‚</p><pre><code class="javascript">mountComponent: function (transaction, nativeParent, nativeContainerInfo, context) {    // çœç•¥ä¸€æ®µä»£ç     ...    if (inst.componentDidMount) {      // è°ƒç”¨componentDidMountï¼Œä»¥äº‹åŠ¡çš„å½¢å¼ã€‚æ”¾åˆ°queueä¸­ï¼Œå¼‚æ­¥çš„æ–¹å¼ï¼Œæœ‰é‚£ä¹ˆç‚¹Android MessageQueueçš„æ„Ÿè§‰      transaction.getReactMountReady().enqueue(inst.componentDidMount, inst);    }    return markup;},</code></pre><p>å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒReactä¸å»ºè®®æˆ‘ä»¬ç¢°åº•å±‚çš„DOMï¼Œå› ä¸ºReactæœ‰ä¸€å¥—æ€§èƒ½æ¯”è¾ƒé«˜çš„DOM diffæ–¹å¼æ¥æ›´æ–°çœŸå®DOMã€‚å¹¶ä¸”å®¹æ˜“å¯¼è‡´DOMå¼•ç”¨å¿˜è®°é‡Šæ”¾ç­‰å†…å­˜æ³„æ¼é—®é¢˜ã€‚ä¸€å¥è¯ï¼Œé™¤éä¸å¾—å·²ï¼Œä¸è¦ç¢°DOMã€‚</p><p><a href="https://yq.aliyun.com/articles/72750?spm=a2c4e.11153940.blogcont72329.29.51012a71kVn38v" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React æºç åˆ†æ 4 setStateæœºåˆ¶</title>
      <link href="/2018/03/27/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-4-setState%E6%9C%BA%E5%88%B6/"/>
      <url>/2018/03/27/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-4-setState%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>Reactä½œä¸ºä¸€é—¨å‰ç«¯æ¡†æ¶ï¼Œè™½ç„¶åªæ˜¯focusåœ¨MVVMä¸­çš„Viewéƒ¨åˆ†ï¼Œä½†è¿˜æ˜¯å®ç°äº†Viewå’Œmodelçš„ç»‘å®šã€‚ä¿®æ”¹æ•°æ®çš„åŒæ—¶ï¼Œå¯ä»¥å®ç°Viewçš„åˆ·æ–°ã€‚è¿™å¤§å¤§ç®€åŒ–äº†æˆ‘ä»¬çš„é€»è¾‘ï¼Œåªç”¨å…³å¿ƒæ•°æ®æµçš„å˜åŒ–ï¼ŒåŒæ—¶å‡å°‘äº†ä»£ç é‡ï¼Œä½¿å¾—åæœŸç»´æŠ¤ä¹Ÿæ›´åŠ æ–¹ä¾¿ã€‚è¿™ä¸ªç‰¹æ€§åˆ™è¦å½’åŠŸäºsetState()æ–¹æ³•ã€‚Reactä¸­åˆ©ç”¨é˜Ÿåˆ—æœºåˆ¶æ¥ç®¡ç†stateï¼Œé¿å…äº†å¾ˆå¤šé‡å¤çš„Viewåˆ·æ–°ã€‚ä¸‹é¢æˆ‘ä»¬æ¥ä»æºç è§’åº¦æ¢å¯»ä¸‹setStateæœºåˆ¶ã€‚</p><h1 id="setStateå’ŒreplaceState"><a href="#setStateå’ŒreplaceState" class="headerlink" title="setStateå’ŒreplaceState"></a>setStateå’ŒreplaceState</h1><p>æˆ‘ä»¬éƒ½çŸ¥é“setStateæ˜¯ä»¥ä¿®æ”¹å’Œæ–°å¢çš„æ–¹å¼æ”¹å˜stateçš„ï¼Œä¸ä¼šæ”¹å˜æ²¡æœ‰æ¶‰åŠåˆ°çš„stateã€‚è€ŒreplaceStateåˆ™ç”¨æ–°çš„stateå®Œå…¨æ›¿æ¢æ‰è€stateã€‚æ¯”å¦‚</p><pre><code class="javascript">this.state = {  title: &quot;example&quot;,  desc: &quot;this is an example for react&quot;};setState({  title: &quot;new example&quot;});console.log(&quot;setState: &quot; + JSON.stringify(this.state));    // 1 replaceState({  title: &quot;new example&quot;})console.log(&quot;replaceState: &quot; + JSON.stringify(this.state));    // 2</code></pre><p>æ‰“å°å¦‚ä¸‹:</p><pre><code class="javascript">setState: {&quot;title&quot;:&quot;new example&quot;,&quot;desc&quot;:&quot;this is an example for react&quot;}replaceState: {&quot;title&quot;:&quot;new example&quot;}</code></pre><a id="more"></a><p>å¯è§ï¼ŒsetStateä¸ä¼šå½±å“æ²¡æœ‰æ¶‰åŠåˆ°çš„stateï¼Œè€ŒreplaceStateåˆ™æ˜¯å®Œå®Œå…¨å…¨çš„æ›¿æ¢ã€‚ä¸‹é¢è®©æˆ‘ä»¬è¿›å…¥æºç æ¥æ¢å¯»ç©¶ç«Ÿå§ã€‚</p><h2 id="setState"><a href="#setState" class="headerlink" title="setState"></a>setState</h2><p>setStateæ–¹æ³•å…¥å£å¦‚ä¸‹</p><pre><code class="javascript">ReactComponent.prototype.setState = function (partialState, callback) {  // å°†setStateäº‹åŠ¡æ”¾å…¥é˜Ÿåˆ—ä¸­  this.updater.enqueueSetState(this, partialState);  if (callback) {    this.updater.enqueueCallback(this, callback, &#39;setState&#39;);  }};</code></pre><p>å–åä¸ºpartialStateï¼Œæœ‰éƒ¨åˆ†stateçš„å«ä¹‰ï¼Œå¯è§åªæ˜¯å½±å“æ¶‰åŠåˆ°çš„stateï¼Œä¸ä¼šä¼¤åŠæ— è¾œã€‚enqueueSetStateæ˜¯stateé˜Ÿåˆ—ç®¡ç†çš„å…¥å£æ–¹æ³•ï¼Œæ¯”è¾ƒé‡è¦ï¼Œæˆ‘ä»¬ä¹‹åå†æ¥ç€åˆ†æã€‚</p><h2 id="replaceState"><a href="#replaceState" class="headerlink" title="replaceState"></a>replaceState</h2><pre><code class="javascript">replaceState: function (newState, callback) {  this.updater.enqueueReplaceState(this, newState);  if (callback) {    this.updater.enqueueCallback(this, callback, &#39;replaceState&#39;);  }},</code></pre><p>replaceStateä¸­å–åä¸ºnewStateï¼Œæœ‰å®Œå…¨æ›¿æ¢çš„å«ä¹‰ã€‚åŒæ ·ä¹Ÿæ˜¯ä»¥é˜Ÿåˆ—çš„å½¢å¼æ¥ç®¡ç†çš„ã€‚</p><h1 id="equeueSetState"><a href="#equeueSetState" class="headerlink" title="equeueSetState"></a>equeueSetState</h1><pre><code class="javascript">enqueueSetState: function (publicInstance, partialState) {    // å…ˆè·å–ReactComponentç»„ä»¶å¯¹è±¡    var internalInstance = getInternalInstanceReadyForUpdate(publicInstance, &#39;setState&#39;);    if (!internalInstance) {      return;    }    // å¦‚æœ_pendingStateQueueä¸ºç©º,åˆ™åˆ›å»ºå®ƒã€‚å¯ä»¥å‘ç°é˜Ÿåˆ—æ˜¯æ•°ç»„å½¢å¼å®ç°çš„    var queue = internalInstance._pendingStateQueue || (internalInstance._pendingStateQueue = []);    queue.push(partialState);    // å°†è¦æ›´æ–°çš„ReactComponentæ”¾å…¥æ•°ç»„ä¸­    enqueueUpdate(internalInstance);}</code></pre><p>å…¶ä¸­getInternalInstanceReadyForUpdateæºç å¦‚ä¸‹ï¼Œè§£é‡Šéƒ½åœ¨ä»£ç æ³¨é‡Šä¸­</p><pre><code class="javascript">function getInternalInstanceReadyForUpdate(publicInstance, callerName) {  // ä»mapå–å‡ºReactComponentç»„ä»¶,è¿˜è®°å¾—mountComponentæ—¶æŠŠReactElementä½œä¸ºkeyï¼Œå°†ReactComponentå­˜å…¥äº†mapä¸­äº†å§ï¼ŒReactComponentæ˜¯Reactç»„ä»¶çš„æ ¸å¿ƒï¼ŒåŒ…å«å„ç§çŠ¶æ€ï¼Œæ•°æ®å’Œæ“ä½œæ–¹æ³•ã€‚è€ŒReactElementåˆ™ä»…ä»…æ˜¯ä¸€ä¸ªæ•°æ®ç±»ã€‚  var internalInstance = ReactInstanceMap.get(publicInstance);  if (!internalInstance) {    return null;  }  return internalInstance;}</code></pre><p>enqueueUpdateæºç å¦‚ä¸‹</p><pre><code class="javascript">function enqueueUpdate(component) {  ensureInjected();  // å¦‚æœä¸æ˜¯æ­£å¤„äºåˆ›å»ºæˆ–æ›´æ–°ç»„ä»¶é˜¶æ®µ,åˆ™å¤„ç†updateäº‹åŠ¡  if (!batchingStrategy.isBatchingUpdates) {    batchingStrategy.batchedUpdates(enqueueUpdate, component);    return;  }  // å¦‚æœæ­£åœ¨åˆ›å»ºæˆ–æ›´æ–°ç»„ä»¶,åˆ™æš‚ä¸”å…ˆä¸å¤„ç†update,åªæ˜¯å°†ç»„ä»¶æ”¾åœ¨dirtyComponentsæ•°ç»„ä¸­  dirtyComponents.push(component);}</code></pre><p>enqueueUpdateåŒ…å«äº†Reacté¿å…é‡å¤renderçš„é€»è¾‘ã€‚mountComponentå’ŒupdateComponentæ–¹æ³•åœ¨æ‰§è¡Œçš„æœ€å¼€å§‹ï¼Œä¼šè°ƒç”¨åˆ°batchedUpdatesè¿›è¡Œæ‰¹å¤„ç†æ›´æ–°ï¼Œæ­¤æ—¶ä¼šå°†isBatchingUpdatesè®¾ç½®ä¸ºtrueï¼Œä¹Ÿå°±æ˜¯å°†çŠ¶æ€æ ‡è®°ä¸ºç°åœ¨æ­£å¤„äºæ›´æ–°é˜¶æ®µäº†ã€‚ä¹‹åReactä»¥äº‹åŠ¡çš„æ–¹å¼å¤„ç†ç»„ä»¶updateï¼Œäº‹åŠ¡å¤„ç†å®Œåä¼šè°ƒç”¨wrapper.close(), è€ŒTRANSACTION_WRAPPERSä¸­åŒ…å«äº†RESET_BATCHED_UPDATESè¿™ä¸ªwrapperï¼Œæ•…æœ€ç»ˆä¼šè°ƒç”¨RESET_BATCHED_UPDATES.close(), å®ƒæœ€ç»ˆä¼šå°†isBatchingUpdatesè®¾ç½®ä¸ºfalseã€‚è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒéº»çƒ¦ï¼Œæƒ³æ›´æ¸…æ™°çš„äº†è§£çš„è¯ï¼Œå»ºè®®è‡ªè¡Œåˆ†ææºç ã€‚</p><p>æ•…getInitialStateï¼ŒcomponentWillMountï¼Œ renderï¼ŒcomponentWillUpdate ä¸­setStateéƒ½ä¸ä¼šå¼•èµ·updateComponentã€‚ä½†åœ¨componentDidMountå’ŒcomponentDidUpdateä¸­åˆ™ä¼šã€‚</p><pre><code class="javascript">batchedUpdates: function (callback, a, b, c, d, e) {  var alreadyBatchingUpdates = ReactDefaultBatchingStrategy.isBatchingUpdates;  // æ‰¹å¤„ç†æœ€å¼€å§‹æ—¶ï¼Œå°†isBatchingUpdatesè®¾ä¸ºtrueï¼Œè¡¨æ˜æ­£åœ¨æ›´æ–°  ReactDefaultBatchingStrategy.isBatchingUpdates = true;  // The code is written this way to avoid extra allocations  if (alreadyBatchingUpdates) {    callback(a, b, c, d, e);  } else {    // ä»¥äº‹åŠ¡çš„æ–¹å¼å¤„ç†updatesï¼Œåé¢è¯¦ç»†åˆ†ætransaction    transaction.perform(callback, null, a, b, c, d, e);  }}var RESET_BATCHED_UPDATES = {  initialize: emptyFunction,  close: function () {    // äº‹åŠ¡æ‰¹æ›´æ–°å¤„ç†ç»“æŸæ—¶ï¼Œå°†isBatchingUpdatesè®¾ä¸ºäº†false    ReactDefaultBatchingStrategy.isBatchingUpdates = false;  }};var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES];</code></pre><h1 id="äº‹åŠ¡transaction"><a href="#äº‹åŠ¡transaction" class="headerlink" title="äº‹åŠ¡transaction"></a>äº‹åŠ¡transaction</h1><p>äº‹åŠ¡é€šè¿‡wrapperè¿›è¡Œå°è£…ã€‚ä¸€ä¸ªwrapperåŒ…å«ä¸€å¯¹initializeå’Œcloseæ–¹æ³•ã€‚æ¯”å¦‚RESET_BATCHED_UPDATES</p><pre><code class="javascript">var RESET_BATCHED_UPDATES = {  // åˆå§‹åŒ–è°ƒç”¨  initialize: emptyFunction,  // äº‹åŠ¡æ‰§è¡Œå®Œæˆï¼Œcloseæ—¶è°ƒç”¨  close: function () {    ReactDefaultBatchingStrategy.isBatchingUpdates = false;  }};</code></pre><p>transcationè¢«åŒ…è£…åœ¨wrapperä¸­ï¼Œæ¯”å¦‚</p><pre><code class="javascript">var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES];</code></pre><p>transactionæ˜¯é€šè¿‡transaction.perform(callback, argsâ€¦)æ–¹æ³•è¿›å…¥çš„ï¼Œå®ƒä¼šå…ˆè°ƒç”¨æ³¨å†Œå¥½çš„wrapperä¸­çš„initializeæ–¹æ³•ï¼Œç„¶åæ‰§è¡Œperformæ–¹æ³•ä¸­çš„callbackï¼Œæœ€åå†æ‰§è¡Œcloseæ–¹æ³•ã€‚</p><p>ä¸‹é¢åˆ†ætransaction.perform(callback, argsâ€¦)</p><pre><code class="javascript">perform: function (method, scope, a, b, c, d, e, f) {    var errorThrown;    var ret;    try {      this._isInTransaction = true;      errorThrown = true;      // å…ˆè¿è¡Œæ‰€æœ‰wrapperä¸­çš„initializeæ–¹æ³•      this.initializeAll(0);      // å†æ‰§è¡Œperformæ–¹æ³•ä¼ å…¥çš„callback      ret = method.call(scope, a, b, c, d, e, f);      errorThrown = false;    } finally {      try {        if (errorThrown) {          // æœ€åè¿è¡Œwrapperä¸­çš„closeæ–¹æ³•          try {            this.closeAll(0);          } catch (err) {}        } else {          // æœ€åè¿è¡Œwrapperä¸­çš„closeæ–¹æ³•          this.closeAll(0);        }      } finally {        this._isInTransaction = false;      }    }    return ret;  },  initializeAll: function (startIndex) {    var transactionWrappers = this.transactionWrappers;    // éå†æ‰€æœ‰æ³¨å†Œçš„wrapper    for (var i = startIndex; i &lt; transactionWrappers.length; i++) {      var wrapper = transactionWrappers[i];      try {        this.wrapperInitData[i] = Transaction.OBSERVED_ERROR;        // è°ƒç”¨wrapperçš„initializeæ–¹æ³•        this.wrapperInitData[i] = wrapper.initialize ? wrapper.initialize.call(this) : null;      } finally {        if (this.wrapperInitData[i] === Transaction.OBSERVED_ERROR) {          try {            this.initializeAll(i + 1);          } catch (err) {}        }      }    }  },  closeAll: function (startIndex) {    var transactionWrappers = this.transactionWrappers;    // éå†æ‰€æœ‰wrapper    for (var i = startIndex; i &lt; transactionWrappers.length; i++) {      var wrapper = transactionWrappers[i];      var initData = this.wrapperInitData[i];      var errorThrown;      try {        errorThrown = true;        if (initData !== Transaction.OBSERVED_ERROR &amp;&amp; wrapper.close) {          // è°ƒç”¨wrapperçš„closeæ–¹æ³•ï¼Œå¦‚æœæœ‰çš„è¯          wrapper.close.call(this, initData);        }        errorThrown = false;      } finally {        if (errorThrown) {          try {            this.closeAll(i + 1);          } catch (e) {}        }      }    }    this.wrapperInitData.length = 0;</code></pre><h1 id="runBatchedUpdatesæ›´æ–°ç»„ä»¶"><a href="#runBatchedUpdatesæ›´æ–°ç»„ä»¶" class="headerlink" title="runBatchedUpdatesæ›´æ–°ç»„ä»¶"></a>runBatchedUpdatesæ›´æ–°ç»„ä»¶</h1><p>å‰é¢åˆ†æåˆ°enqueueUpdateä¸­è°ƒç”¨transaction.perform(callback, argsâ€¦)åï¼Œå°ä¼™ä¼´ä»¬è‚¯å®šä¼šå‘ç°ï¼Œcallbackè¿˜æ˜¯enqueueUpdateæ–¹æ³•å•Šï¼Œé‚£å²‚ä¸æ˜¯æ­»å¾ªç¯äº†ï¼Ÿä¸æ˜¯è¯´å¥½çš„setStateä¼šè°ƒç”¨updateComponentï¼Œä»è€Œè‡ªåŠ¨åˆ·æ–°Viewçš„å—ï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦å…ˆä»transactionäº‹åŠ¡è¯´èµ·ã€‚</p><p>æˆ‘ä»¬çš„wrapperä¸­æ³¨å†Œäº†ä¸¤ä¸ªwrapperï¼Œå¦‚ä¸‹</p><pre><code class="javascript">var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES];</code></pre><p>RESET_BATCHED_UPDATESç”¨æ¥ç®¡ç†isBatchingUpdatesçŠ¶æ€ï¼Œæˆ‘ä»¬å‰é¢åœ¨åˆ†æsetStateæ˜¯å¦ç«‹å³ç”Ÿæ•ˆæ—¶å·²ç»è®²è§£è¿‡äº†ã€‚é‚£FLUSH_BATCHED_UPDATESç”¨æ¥å¹²å˜›å‘¢ï¼Ÿ</p><pre><code class="javascript">var FLUSH_BATCHED_UPDATES = {  initialize: emptyFunction,  close: ReactUpdates.flushBatchedUpdates.bind(ReactUpdates)};var flushBatchedUpdates = function () {  // å¾ªç¯éå†å¤„ç†å®Œæ‰€æœ‰dirtyComponents  while (dirtyComponents.length || asapEnqueued) {    if (dirtyComponents.length) {      var transaction = ReactUpdatesFlushTransaction.getPooled();      // closeå‰æ‰§è¡Œå®ŒrunBatchedUpdatesæ–¹æ³•ï¼Œè¿™æ˜¯å…³é”®      transaction.perform(runBatchedUpdates, null, transaction);      ReactUpdatesFlushTransaction.release(transaction);    }    if (asapEnqueued) {      asapEnqueued = false;      var queue = asapCallbackQueue;      asapCallbackQueue = CallbackQueue.getPooled();      queue.notifyAll();      CallbackQueue.release(queue);    }  }};</code></pre><p>FLUSH_BATCHED_UPDATESä¼šåœ¨ä¸€ä¸ªtransactionçš„closeé˜¶æ®µè¿è¡ŒrunBatchedUpdatesï¼Œä»è€Œæ‰§è¡Œupdateã€‚</p><pre><code class="javascript">function runBatchedUpdates(transaction) {  var len = transaction.dirtyComponentsLength;  dirtyComponents.sort(mountOrderComparator);  for (var i = 0; i &lt; len; i++) {    // dirtyComponentsä¸­å–å‡ºä¸€ä¸ªcomponent    var component = dirtyComponents[i];    // å–å‡ºdirtyComponentä¸­çš„æœªæ‰§è¡Œçš„callback,ä¸‹é¢å°±å‡†å¤‡æ‰§è¡Œå®ƒäº†    var callbacks = component._pendingCallbacks;    component._pendingCallbacks = null;    var markerName;    if (ReactFeatureFlags.logTopLevelRenders) {      var namedComponent = component;      if (component._currentElement.props === component._renderedComponent._currentElement) {        namedComponent = component._renderedComponent;      }    }    // æ‰§è¡ŒupdateComponent    ReactReconciler.performUpdateIfNecessary(component, transaction.reconcileTransaction);    // æ‰§è¡ŒdirtyComponentä¸­ä¹‹å‰æœªæ‰§è¡Œçš„callback    if (callbacks) {      for (var j = 0; j &lt; callbacks.length; j++) {        transaction.callbackQueue.enqueue(callbacks[j], component.getPublicInstance());      }    }  }}</code></pre><p>runBatchedUpdateså¾ªç¯éå†dirtyComponentsæ•°ç»„ï¼Œä¸»è¦å¹²ä¸¤ä»¶äº‹ã€‚é¦–å…ˆæ‰§è¡ŒperformUpdateIfNecessaryæ¥åˆ·æ–°ç»„ä»¶çš„viewï¼Œç„¶åæ‰§è¡Œä¹‹å‰é˜»å¡çš„callbackã€‚ä¸‹é¢æ¥çœ‹performUpdateIfNecessaryã€‚</p><pre><code class="javascript">performUpdateIfNecessary: function (transaction) {    if (this._pendingElement != null) {      // receiveComponentä¼šæœ€ç»ˆè°ƒç”¨åˆ°updateComponentï¼Œä»è€Œåˆ·æ–°View      ReactReconciler.receiveComponent(this, this._pendingElement, transaction, this._context);    }    if (this._pendingStateQueue !== null || this._pendingForceUpdate) {      // æ‰§è¡ŒupdateComponentï¼Œä»è€Œåˆ·æ–°Viewã€‚è¿™ä¸ªæµç¨‹åœ¨Reactç”Ÿå‘½å‘¨æœŸä¸­è®²è§£è¿‡      this.updateComponent(transaction, this._currentElement, this._currentElement, this._context, this._context);    }  },</code></pre><p>æœ€åæƒŠå–œçš„çœ‹åˆ°äº†receiveComponentå’ŒupdateComponentå§ã€‚receiveComponentæœ€åä¼šè°ƒç”¨updateComponentï¼Œè€ŒupdateComponentä¸­ä¼šæ‰§è¡ŒReactç»„ä»¶å­˜åœ¨æœŸçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¦‚componentWillReceivePropsï¼Œ shouldComponentUpdateï¼Œ componentWillUpdateï¼Œrender, componentDidUpdateã€‚ ä»è€Œå®Œæˆç»„ä»¶æ›´æ–°çš„æ•´å¥—æµç¨‹ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>setStateæµç¨‹è¿˜æ˜¯å¾ˆå¤æ‚çš„ï¼Œè®¾è®¡ä¹Ÿå¾ˆç²¾å·§ï¼Œé¿å…äº†é‡å¤æ— è°“çš„åˆ·æ–°ç»„ä»¶ã€‚å®ƒçš„ä¸»è¦æµç¨‹å¦‚ä¸‹</p><blockquote><ul><li>enqueueSetStateå°†stateæ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œå¹¶è°ƒç”¨enqueueUpdateå¤„ç†è¦æ›´æ–°çš„Component</li><li>å¦‚æœç»„ä»¶å½“å‰æ­£å¤„äºupdateäº‹åŠ¡ä¸­ï¼Œåˆ™å…ˆå°†Componentå­˜å…¥dirtyComponentä¸­ã€‚å¦åˆ™è°ƒç”¨batchedUpdateså¤„ç†ã€‚</li><li>batchedUpdateså‘èµ·ä¸€æ¬¡transaction.perform()äº‹åŠ¡</li><li>å¼€å§‹æ‰§è¡Œäº‹åŠ¡åˆå§‹åŒ–ï¼Œè¿è¡Œï¼Œç»“æŸä¸‰ä¸ªé˜¶æ®µ<br>1.åˆå§‹åŒ–ï¼šäº‹åŠ¡åˆå§‹åŒ–é˜¶æ®µæ²¡æœ‰æ³¨å†Œæ–¹æ³•ï¼Œæ•…æ— æ–¹æ³•è¦æ‰§è¡Œ<br>2.è¿è¡Œï¼šæ‰§è¡ŒsetSateæ—¶ä¼ å…¥çš„callbackæ–¹æ³•ï¼Œä¸€èˆ¬ä¸ä¼šä¼ callbackå‚æ•°<br>3.ç»“æŸï¼šæ›´æ–°isBatchingUpdatesä¸ºfalseï¼Œå¹¶æ‰§è¡ŒFLUSH_BATCHED_UPDATESè¿™ä¸ªwrapperä¸­çš„closeæ–¹æ³•</li><li>FLUSH_BATCHED_UPDATESåœ¨closeé˜¶æ®µï¼Œä¼šå¾ªç¯éå†æ‰€æœ‰çš„dirtyComponentsï¼Œè°ƒç”¨updateComponentåˆ·æ–°ç»„ä»¶ï¼Œå¹¶æ‰§è¡Œå®ƒçš„pendingCallbacks, ä¹Ÿå°±æ˜¯setStateä¸­è®¾ç½®çš„callbackã€‚</li></ul></blockquote><p><a href="https://yq.aliyun.com/articles/72329?spm=a2c4e.11153940.blogcont72330.20.351d5033CZkYc1" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React æºç åˆ†æ 3 Reactç”Ÿå‘½å‘¨æœŸè¯¦è§£</title>
      <link href="/2018/03/26/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-3-React%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3/"/>
      <url>/2018/03/26/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-3-React%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="Reactç”Ÿå‘½å‘¨æœŸæµç¨‹"><a href="#Reactç”Ÿå‘½å‘¨æœŸæµç¨‹" class="headerlink" title="Reactç”Ÿå‘½å‘¨æœŸæµç¨‹"></a>Reactç”Ÿå‘½å‘¨æœŸæµç¨‹</h1><p><img src="http://img.colabug.com/2017/10/965595492cafc7b07b8340cdc9b4441d.png" alt="react"><br>è°ƒç”¨æµç¨‹å¯ä»¥å‚çœ‹ä¸Šå›¾ã€‚åˆ†ä¸ºå®ä¾‹åŒ–ï¼Œå­˜åœ¨æœŸå’Œé”€æ¯ä¸‰ä¸ªä¸åŒé˜¶æ®µã€‚ä»‹ç»ç”Ÿå‘½å‘¨æœŸæµç¨‹çš„æ–‡ç« å¾ˆå¤šï¼Œç›¸ä¿¡å¤§éƒ¨åˆ†åŒå­¦ä¹Ÿæœ‰æ‰€äº†è§£ï¼Œæˆ‘ä»¬å°±ä¸è¯¦ç»†åˆ†æäº†ã€‚å¾ˆå¤šåŒå­¦è‚¯å®šæœ‰ç–‘é—®ï¼Œè¿™äº›æ–¹æ³•åœ¨Reactå†…éƒ¨æ˜¯åœ¨å“ªäº›æ–¹æ³•ä¸­è¢«è°ƒç”¨çš„å‘¢ï¼Œä»–ä»¬è§¦å‘çš„æ—¶æœºåˆæ˜¯ä»€ä¹ˆæ—¶å€™å‘¢ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†åˆ†æã€‚</p><h1 id="å®ä¾‹åŒ–ç”Ÿå‘½å‘¨æœŸ"><a href="#å®ä¾‹åŒ–ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="å®ä¾‹åŒ–ç”Ÿå‘½å‘¨æœŸ"></a>å®ä¾‹åŒ–ç”Ÿå‘½å‘¨æœŸ</h1><h2 id="getDefaultProps"><a href="#getDefaultProps" class="headerlink" title="getDefaultProps"></a>getDefaultProps</h2><p>åœ¨React.creatClass()åˆå§‹åŒ–ç»„ä»¶ç±»æ—¶ï¼Œä¼šè°ƒç”¨getDefaultProps()ï¼Œå°†è¿”å›çš„é»˜è®¤å±æ€§æŒ‚è½½åˆ°defaultPropså˜é‡ä¸‹</p><p>è¿™é‡Œè¦æçš„ä¸€ç‚¹æ˜¯ï¼Œåˆå§‹åŒ–ç»„ä»¶ç±»åªè¿è¡Œä¸€æ¬¡ã€‚å¯ä»¥æŠŠå®ƒç®€å•ç±»æ¯”ä¸ºJavaä¸­çš„Classå¯¹è±¡ã€‚åˆå§‹åŒ–ç»„ä»¶ç±»å°±æ˜¯ClassLoaderåŠ è½½Classå¯¹è±¡çš„è¿‡ç¨‹ã€‚ç±»å¯¹è±¡çš„åˆå§‹åŒ–ä¸è¦é”™è¯¯ç†è§£æˆäº†å®ä¾‹å¯¹è±¡çš„åˆå§‹åŒ–ã€‚ä¸€ä¸ªReactç»„ä»¶ç±»å¯èƒ½ä¼šåœ¨JSXä¸­è¢«å¤šæ¬¡è°ƒç”¨ï¼Œäº§ç”Ÿå¤šä¸ªç»„ä»¶å¯¹è±¡ï¼Œä½†å®ƒåªæœ‰ä¸€ä¸ªç±»å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ç±»åŠ è½½ågetDefaultPropså°±ä¸ä¼šå†è°ƒç”¨äº†ã€‚</p><h2 id="getlnitialState"><a href="#getlnitialState" class="headerlink" title="getlnitialState"></a>getlnitialState</h2><p>è¿™ä¸ªæ–¹æ³•åœ¨åˆ›å»ºç»„ä»¶å®ä¾‹å¯¹è±¡çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œå…·ä½“ä»£ç ä½äºReact.creatClass()çš„Constructorå‡½æ•°ä¸­ã€‚</p><p>æ¯æ¬¡åˆ›å»ºReactå®ä¾‹å¯¹è±¡æ—¶ï¼Œå®ƒéƒ½ä¼šè¢«è°ƒç”¨ã€‚</p><h2 id="mountComponent"><a href="#mountComponent" class="headerlink" title="mountComponent"></a>mountComponent</h2><p>componentWillMountï¼Œrenderï¼ŒcomponentDidMountéƒ½æ˜¯åœ¨mountComponentä¸­è¢«è°ƒç”¨.å®ƒæ˜¯åœ¨æ¸²æŸ“æ–°çš„ReactComponentä¸­è¢«è°ƒç”¨çš„ã€‚è¾“å…¥ReactComponentï¼Œè¿”å›ç»„ä»¶å¯¹åº”çš„HTMLã€‚æŠŠè¿™ä¸ªHTMLæ’å…¥åˆ°DOMä¸­ï¼Œå°±å¯ä»¥ç”Ÿæˆç»„ä»¶å¯¹åº”çš„DOMå¯¹è±¡äº†ã€‚æ‰€ä»¥mountComponentå°¤å…¶å…³é”®ã€‚</p><p>å’ŒJavaä¸­çš„å¤šæ€ä¸€æ ·ï¼Œä¸åŒçš„Reactç»„ä»¶çš„mountComponentå®ç°éƒ½æœ‰æ‰€åŒºåˆ«ã€‚ä¸‹é¢æˆ‘ä»¬æ¥é‡ç‚¹åˆ†æReactè‡ªå®šä¹‰ç»„ä»¶ç±»ï¼Œä¹Ÿå°±æ˜¯ReactCompositeComponentçš„mountComponentã€‚</p><pre><code class="javascript"> mountComponent: function (transaction, nativeParent, nativeContainerInfo, context) {    this._context = context;    this._mountOrder = nextMountID++;    this._nativeParent = nativeParent;    this._nativeContainerInfo = nativeContainerInfo;    // åšpropTypesæ˜¯å¦åˆæ³•çš„åˆ¤æ–­ï¼Œè¿™ä¸ªåªåœ¨å¼€å‘é˜¶æ®µæœ‰ç”¨    var publicProps = this._processProps(this._currentElement.props);    var publicContext = this._processContext(context);    var Component = this._currentElement.type;    // åˆå§‹åŒ–å…¬å…±ç±»    var inst = this._constructComponent(publicProps, publicContext);    var renderedElement;    // instæˆ–è€…inst.renderä¸ºç©ºå¯¹åº”çš„æ˜¯statelessç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯æ— çŠ¶æ€ç»„ä»¶    // æ— çŠ¶æ€ç»„ä»¶æ²¡æœ‰å®ä¾‹å¯¹è±¡ï¼Œå®ƒæœ¬è´¨ä¸Šåªæ˜¯ä¸€ä¸ªè¿”å›JSXçš„å‡½æ•°è€Œå·²ã€‚æ˜¯ä¸€ç§è½»é‡çº§çš„Reactç»„ä»¶    if (!shouldConstruct(Component) &amp;&amp; (inst == null || inst.render == null)) {      renderedElement = inst;      warnIfInvalidElement(Component, renderedElement);      inst = new StatelessComponent(Component);    }    // è®¾ç½®å˜é‡    inst.props = publicProps;    inst.context = publicContext;    inst.refs = emptyObject;    inst.updater = ReactUpdateQueue;    this._instance = inst;    // å­˜å‚¨å®ä¾‹å¯¹è±¡çš„å¼•ç”¨åˆ°mapä¸­ï¼Œæ–¹ä¾¿ä»¥åæŸ¥æ‰¾    ReactInstanceMap.set(inst, this);    // åˆå§‹åŒ–stateï¼Œé˜Ÿåˆ—ç­‰    var initialState = inst.state;    if (initialState === undefined) {      inst.state = initialState = null;    }    this._pendingStateQueue = null;    this._pendingReplaceState = false;    this._pendingForceUpdate = false;    var markup;    if (inst.unstable_handleError) {      // æŒ‚è½½æ—¶å‡ºé”™ï¼Œè¿›è¡Œä¸€äº›é”™è¯¯å¤„ç†ï¼Œç„¶åperformInitialMountï¼Œåˆå§‹åŒ–æŒ‚è½½      markup = this.performInitialMountWithErrorHandling(renderedElement, nativeParent, nativeContainerInfo, transaction, context);    } else {      // åˆå§‹åŒ–æŒ‚è½½      markup = this.performInitialMount(renderedElement, nativeParent, nativeContainerInfo, transaction, context);    }    if (inst.componentDidMount) {      // è°ƒç”¨componentDidMountï¼Œä»¥äº‹åŠ¡çš„å½¢å¼      transaction.getReactMountReady().enqueue(inst.componentDidMount, inst);    }    return markup;  },</code></pre><a id="more"></a><p>mountComponentå…ˆåšå®ä¾‹å¯¹è±¡çš„props,stateç­‰åˆå§‹åŒ–ï¼Œç„¶åè°ƒç”¨performInitialMountåˆå§‹åŒ–æŒ‚è½½ï¼Œå®Œæˆåè°ƒç”¨componentDidMountã€‚è¿™ä¸ªè°ƒç”¨é“¾è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ã€‚ä¸‹é¢æˆ‘ä»¬é‡ç‚¹æ¥åˆ†æperformInitialMountWithErrorHandlingå’ŒperformInitialMount</p><pre><code class="javascript"> performInitialMountWithErrorHandling: function (renderedElement, nativeParent, nativeContainerInfo, transaction, context) {    var markup;    var checkpoint = transaction.checkpoint();    try {      // æ”¾åˆ°try-catchä¸­ï¼Œå¦‚æœæ²¡æœ‰å‡ºé”™åˆ™è°ƒç”¨performInitialMountåˆå§‹åŒ–æŒ‚è½½ã€‚å¯è§è¿™é‡Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯åšä¸€äº›é”™è¯¯å¤„ç†è€Œå·²      markup = this.performInitialMount(renderedElement, nativeParent, nativeContainerInfo, transaction, context);    } catch (e) {      // handleErrorï¼Œå¸è½½ç»„ä»¶ï¼Œç„¶åé‡æ–°performInitialMountåˆå§‹åŒ–æŒ‚è½½      transaction.rollback(checkpoint);      this._instance.unstable_handleError(e);      if (this._pendingStateQueue) {        this._instance.state = this._processPendingState(this._instance.props, this._instance.context);      }      checkpoint = transaction.checkpoint();      this._renderedComponent.unmountComponent(true);      transaction.rollback(checkpoint);      markup = this.performInitialMount(renderedElement, nativeParent, nativeContainerInfo, transaction, context);    }    return markup;  },</code></pre><p>å¯è§performInitialMountWithErrorHandlingåªæ˜¯å¤šäº†ä¸€å±‚é”™è¯¯å¤„ç†è€Œå·²ï¼Œå…³é”®è¿˜æ˜¯åœ¨performInitialMountä¸­ã€‚</p><pre><code class="javascript">performInitialMount: function (renderedElement, nativeParent, nativeContainerInfo, transaction, context) {    var inst = this._instance;    if (inst.componentWillMount) {      // renderå‰è°ƒç”¨componentWillMount      inst.componentWillMount();      // å°†stateæå‰åˆå¹¶ï¼Œæ•…åœ¨componentWillMountä¸­è°ƒç”¨setStateä¸ä¼šè§¦å‘é‡æ–°renderï¼Œè€Œæ˜¯åšä¸€æ¬¡stateåˆå¹¶ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯å‡å°‘ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“      if (this._pendingStateQueue) {        inst.state = this._processPendingState(inst.props, inst.context);      }    }    // å¦‚æœä¸æ˜¯statelessï¼Œå³æ— çŠ¶æ€ç»„ä»¶ï¼Œåˆ™è°ƒç”¨renderï¼Œè¿”å›ReactElement    if (renderedElement === undefined) {      renderedElement = this._renderValidatedComponent();    }    // å¾—åˆ°ç»„ä»¶ç±»å‹ï¼Œå¦‚ç©ºç»„ä»¶ReactNodeTypes.EMPTYï¼Œè‡ªå®šä¹‰Reactç»„ä»¶ReactNodeTypes.COMPOSITEï¼ŒDOMåŸç”Ÿç»„ä»¶ReactNodeTypes.NATIVE    this._renderedNodeType = ReactNodeTypes.getType(renderedElement);    // ç”±ReactElementç”ŸæˆReactComponentï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ä¹‹å‰è®²è§£è¿‡ã€‚æ ¹æ®ä¸åŒtypeåˆ›å»ºä¸åŒComponentå¯¹è±¡    // å‚è€ƒ http://blog.csdn.net/u013510838/article/details/55669769    this._renderedComponent = this._instantiateReactComponent(renderedElement);    // é€’å½’æ¸²æŸ“ï¼Œæ¸²æŸ“å­ç»„ä»¶    var markup = ReactReconciler.mountComponent(this._renderedComponent, transaction, nativeParent, nativeContainerInfo, this._processChildContext(context));    return markup;  },</code></pre><p>performInitialMountä¸­å…ˆè°ƒç”¨componentWillMount()ï¼Œå†å°†setState()äº§ç”Ÿçš„stateæ”¹å˜è¿›è¡Œstateåˆå¹¶ï¼Œç„¶åè°ƒç”¨_renderValidatedComponent()è¿”å›ReactElementï¼Œå®ƒä¼šè°ƒç”¨render()æ–¹æ³•ã€‚ç„¶åç”±ReactElementåˆ›å»ºReactComponentã€‚æœ€åè¿›è¡Œé€’å½’æ¸²æŸ“ã€‚ä¸‹é¢æ¥çœ‹renderValidatedComponent()</p><pre><code class="javascript">  _renderValidatedComponent: function () {    var renderedComponent;    ReactCurrentOwner.current = this;    try {      renderedComponent = this._renderValidatedComponentWithoutOwnerOrContext();    } finally {      ReactCurrentOwner.current = null;    }    !(    return renderedComponent;  },  _renderValidatedComponentWithoutOwnerOrContext: function () {    var inst = this._instance;    // è°ƒç”¨renderæ–¹æ³•ï¼Œå¾—åˆ°ReactElementã€‚JSXç»è¿‡babelè½¬è¯‘åå…¶å®å°±æ˜¯createElement()æ–¹æ³•ã€‚è¿™ä¸€ç‚¹åœ¨å‰é¢ä¹Ÿè®²è§£è¿‡    var renderedComponent = inst.render();    return renderedComponent;  },</code></pre><h1 id="å­˜åœ¨æœŸç”Ÿå‘½å‘¨æœŸ"><a href="#å­˜åœ¨æœŸç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="å­˜åœ¨æœŸç”Ÿå‘½å‘¨æœŸ"></a>å­˜åœ¨æœŸç”Ÿå‘½å‘¨æœŸ</h1><p>ç»„ä»¶å®ä¾‹å¯¹è±¡å·²ç»ç”Ÿæˆæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡setState()æ¥æ›´æ–°ç»„ä»¶ã€‚setStateæœºåˆ¶åé¢ä¼šæœ‰å•ç‹¬æ–‡ç« åˆ†æï¼Œç°åœ¨åªç”¨çŸ¥é“å®ƒä¼šè°ƒç”¨updateComponent()æ¥å®Œæˆæ›´æ–°å³å¯ã€‚ä¸‹é¢æ¥åˆ†æupdateComponent</p><pre><code class="javascript">updateComponent: function(transaction, prevParentElement, nextParentElement, prevUnmaskedContext, nextUnmaskedContext  ) {    var inst = this._instance;    var willReceive = false;    var nextContext;    var nextProps;    // contextå¯¹è±¡å¦‚æœæœ‰æ”¹åŠ¨,åˆ™æ£€æŸ¥propTypesç­‰,è¿™åœ¨å¼€å‘é˜¶æ®µå¯ä»¥æŠ¥é”™æé†’    if (this._context === nextUnmaskedContext) {      nextContext = inst.context;    } else {      nextContext = this._processContext(nextUnmaskedContext);      willReceive = true;    }    // å¦‚æœçˆ¶å…ƒç´ ç±»å‹ç›¸åŒ,åˆ™è·³è¿‡propTypesç±»å‹æ£€æŸ¥    if (prevParentElement === nextParentElement) {      nextProps = nextParentElement.props;    } else {      nextProps = this._processProps(nextParentElement.props);      willReceive = true;    }    // è°ƒç”¨componentWillReceiveProps,å¦‚æœé€šè¿‡setStateè¿›å…¥çš„updateComponentï¼Œåˆ™æ²¡æœ‰è¿™ä¸€æ­¥    if (willReceive &amp;&amp; inst.componentWillReceiveProps) {      inst.componentWillReceiveProps(nextProps, nextContext);    }    // æå‰åˆå¹¶state,componentWillReceivePropsä¸­è°ƒç”¨setStateä¸ä¼šé‡æ–°æ¸²æŸ“,åœ¨æ­¤å¤„åšåˆå¹¶å³å¯,å› ä¸ºåé¢ä¹Ÿæ˜¯è¦è°ƒç”¨renderçš„    // è¿™æ ·å¯ä»¥é¿å…æ²¡å¿…è¦çš„æ¸²æŸ“    var nextState = this._processPendingState(nextProps, nextContext);    // è°ƒç”¨shouldComponentUpdateç»™shouldUpdateèµ‹å€¼    // å¦‚æœé€šè¿‡forceUpdateè¿›å…¥çš„updateComponentï¼Œå³_pendingForceUpdateä¸ä¸ºç©ºï¼Œåˆ™ä¸ç”¨åˆ¤æ–­shouldComponentUpdate.    var shouldUpdate = true;    if (!this._pendingForceUpdate &amp;&amp; inst.shouldComponentUpdate) {      shouldUpdate = inst.shouldComponentUpdate(nextProps, nextState, nextContext);    }    // å¦‚æœshouldUpdateä¸ºtrue,åˆ™ä¼šæ‰§è¡Œæ¸²æŸ“,å¦åˆ™ä¸ä¼š    this._updateBatchNumber = null;    if (shouldUpdate) {      this._pendingForceUpdate = false;      // æ‰§è¡Œæ›´æ–°æ¸²æŸ“,åé¢è¯¦ç»†åˆ†æ      this._performComponentUpdate(        nextParentElement,        nextProps,        nextState,        nextContext,        transaction,        nextUnmaskedContext      );    } else {      // shouldUpdateä¸ºfalse,åˆ™ä¸ä¼šæ›´æ–°æ¸²æŸ“      this._currentElement = nextParentElement;      this._context = nextUnmaskedContext;      inst.props = nextProps;      inst.state = nextState;      inst.context = nextContext;    }},</code></pre><p>updateComponentä¸­ï¼Œå…ˆè°ƒç”¨componentWillReceivePropsï¼Œç„¶ååˆå¹¶setStateå¯¼è‡´çš„stateå˜åŒ–ã€‚ç„¶åè°ƒç”¨shouldComponentUpdateåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°æ¸²æŸ“ã€‚å¦‚æœéœ€è¦ï¼Œåˆ™è°ƒç”¨_performComponentUpdateæ‰§è¡Œæ¸²æŸ“æ›´æ–°ï¼Œä¸‹é¢æ¥ç€åˆ†æperformComponentUpdateã€‚</p><pre><code class="javascript">_performComponentUpdate: function(nextElement,nextProps,nextState,nextContext,transaction,                                     unmaskedContext  ) {    var inst = this._instance;    // åˆ¤æ–­æ˜¯å¦å·²ç»updateäº†    var hasComponentDidUpdate = Boolean(inst.componentDidUpdate);    var prevProps;    var prevState;    var prevContext;    if (hasComponentDidUpdate) {      prevProps = inst.props;      prevState = inst.state;      prevContext = inst.context;    }    // renderå‰è°ƒç”¨componentWillUpdate    if (inst.componentWillUpdate) {      inst.componentWillUpdate(nextProps, nextState, nextContext);    }    // state propsç­‰å±æ€§è®¾ç½®åˆ°å†…éƒ¨å˜é‡instä¸Š    this._currentElement = nextElement;    this._context = unmaskedContext;    inst.props = nextProps;    inst.state = nextState;    inst.context = nextContext;    // å†…éƒ¨ä¼šè°ƒç”¨renderæ–¹æ³•ï¼Œé‡æ–°è§£æReactElementå¹¶å¾—åˆ°HTML    this._updateRenderedComponent(transaction, unmaskedContext);    // renderåè°ƒç”¨componentDidUpdate    if (hasComponentDidUpdate) {      transaction.getReactMountReady().enqueue(        inst.componentDidUpdate.bind(inst, prevProps, prevState, prevContext),        inst      );    }},</code></pre><p>_performComponentUpdateä¼šè°ƒç”¨componentWillUpdateï¼Œç„¶ååœ¨è°ƒç”¨updateRenderedComponentè¿›è¡Œæ›´æ–°æ¸²æŸ“ï¼Œæœ€åè°ƒç”¨componentDidUpdateã€‚ä¸‹é¢æ¥çœ‹çœ‹updateRenderedComponentä¸­æ€ä¹ˆè°ƒç”¨renderæ–¹æ³•çš„ã€‚</p><pre><code class="javascript">_updateRenderedComponent: function(transaction, context) {    var prevComponentInstance = this._renderedComponent;    var prevRenderedElement = prevComponentInstance._currentElement;    // _renderValidatedComponentå†…éƒ¨ä¼šè°ƒç”¨render,å¾—åˆ°ReactElement    var nextRenderedElement = this._renderValidatedComponent();    // åˆ¤æ–­æ˜¯å¦åšDOM diffã€‚Reactä¸ºäº†ç®€åŒ–é€’å½’diff,è®¤ä¸ºç»„ä»¶å±‚çº§ä¸å˜,ä¸”typeå’Œkeyä¸å˜(keyç”¨äºlistViewç­‰ç»„ä»¶,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰è®¾ç½®type)æ‰update,å¦åˆ™å…ˆunmountå†é‡æ–°mount    if (shouldUpdateReactComponent(prevRenderedElement, nextRenderedElement)) {      // é€’å½’updateComponent,æ›´æ–°å­ç»„ä»¶çš„Virtual DOM      ReactReconciler.receiveComponent(prevComponentInstance, nextRenderedElement, transaction, this._processChildContext(context));    } else {      var oldNativeNode = ReactReconciler.getNativeNode(prevComponentInstance);      // ä¸åšDOM diff,åˆ™å…ˆå¸è½½æ‰,ç„¶åå†åŠ è½½ã€‚ä¹Ÿå°±æ˜¯å…ˆunMountComponent,å†mountComponent      ReactReconciler.unmountComponent(prevComponentInstance, false);      this._renderedNodeType = ReactNodeTypes.getType(nextRenderedElement);      // ç”±ReactElementåˆ›å»ºReactComponent      this._renderedComponent = this._instantiateReactComponent(nextRenderedElement);      // mountComponentæŒ‚è½½ç»„ä»¶,å¾—åˆ°ç»„ä»¶å¯¹åº”HTML      var nextMarkup = ReactReconciler.mountComponent(this._renderedComponent, transaction, this._nativeParent, this._nativeContainerInfo, this._processChildContext(context));      // å°†HTMLæ’å…¥DOMä¸­      this._replaceNodeWithMarkup(oldNativeNode, nextMarkup, prevComponentInstance);    }},_renderValidatedComponent: function() {    var renderedComponent;    ReactCurrentOwner.current = this;    try {      renderedComponent =        this._renderValidatedComponentWithoutOwnerOrContext();    } finally {      ReactCurrentOwner.current = null;    }    return renderedComponent;},_renderValidatedComponentWithoutOwnerOrContext: function() {    var inst = this._instance;    // çœ‹åˆ°renderæ–¹æ³•äº†æŠŠï¼Œåº”è¯¥æ”¾å¿ƒäº†æŠŠ~    var renderedComponent = inst.render();    return renderedComponent;},</code></pre><p>å’ŒmountComponentä¸­ä¸€æ ·ï¼ŒupdateComponentä¹Ÿæ˜¯ç”¨é€’å½’çš„æ–¹å¼å°†å„å­ç»„ä»¶è¿›è¡Œupdateçš„ã€‚è¿™é‡Œè¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯DOM diffã€‚DOM diffæ˜¯Reactä¸­æ¸²æŸ“åŠ é€Ÿçš„å…³é”®æ‰€åœ¨ï¼Œå®ƒä¼šå¸®æˆ‘ä»¬ç®—å‡ºvirtual DOMä¸­çœŸæ­£å˜åŒ–çš„éƒ¨åˆ†ï¼Œå¹¶å¯¹è¿™éƒ¨åˆ†è¿›è¡ŒåŸç”ŸDOMæ“ä½œã€‚ä¸ºäº†é¿å…å¾ªç¯é€’å½’å¯¹æ¯”èŠ‚ç‚¹çš„ä½æ•ˆç‡ï¼ŒReactä¸­åšäº†å‡è®¾ï¼Œå³åªå¯¹å±‚çº§ä¸å˜ï¼Œtypeä¸å˜ï¼Œkeyä¸å˜çš„ç»„ä»¶è¿›è¡ŒVirtual DOMæ›´æ–°ã€‚è¿™å…¶ä¸­çš„å…³é”®æ˜¯shouldUpdateReactComponentï¼Œä¸‹é¢åˆ†æ</p><pre><code class="javascript">function shouldUpdateReactComponent(prevElement, nextElement) {  var prevEmpty = prevElement === null || prevElement === false;  var nextEmpty = nextElement === null || nextElement === false;  if (prevEmpty || nextEmpty) {    return prevEmpty === nextEmpty;  }  var prevType = typeof prevElement;  var nextType = typeof nextElement;  // React DOM diffç®—æ³•  // å¦‚æœå‰åä¸¤æ¬¡ä¸ºæ•°å­—æˆ–è€…å­—ç¬¦,åˆ™è®¤ä¸ºåªéœ€è¦update(å¤„ç†æ–‡æœ¬å…ƒç´ )  // å¦‚æœå‰åä¸¤æ¬¡ä¸ºDOMå…ƒç´ æˆ–Reactå…ƒç´ ,åˆ™å¿…é¡»åœ¨åŒä¸€å±‚çº§å†…,ä¸”typeå’Œkeyä¸å˜(keyç”¨äºlistViewç­‰ç»„ä»¶,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰è®¾ç½®type)æ‰update,å¦åˆ™å…ˆunmountå†é‡æ–°mount  if (prevType === &#39;string&#39; || prevType === &#39;number&#39;) {    return (nextType === &#39;string&#39; || nextType === &#39;number&#39;);  } else {    return (      nextType === &#39;object&#39; &amp;&amp;      prevElement.type === nextElement.type &amp;&amp;      prevElement.key === nextElement.key    );  }}</code></pre><h1 id="é”€æ¯"><a href="#é”€æ¯" class="headerlink" title="é”€æ¯"></a>é”€æ¯</h1><p>å‰é¢æåˆ°è¿‡ï¼Œæ›´æ–°ç»„ä»¶æ—¶ï¼Œå¦‚æœä¸æ»¡è¶³DOM diffæ¡ä»¶ï¼Œä¼šå…ˆunmountComponent, ç„¶åå†mountComponentï¼Œä¸‹é¢æˆ‘ä»¬æ¥åˆ†æä¸‹unmountComponentæ—¶éƒ½å‘ç”Ÿäº†ä»€ä¹ˆäº‹ã€‚å’ŒmountComponentçš„å¤šæ€ä¸€æ ·ï¼Œä¸åŒtypeçš„ReactComponentä¹Ÿä¼šæœ‰ä¸åŒçš„unmountComponentè¡Œä¸ºã€‚æˆ‘ä»¬æ¥åˆ†æä¸‹Reactè‡ªå®šä¹‰ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯ReactCompositeComponentä¸­çš„unmountComponentã€‚</p><pre><code class="javascript"> unmountComponent: function(safely) {    if (!this._renderedComponent) {      return;    }    var inst = this._instance;    // è°ƒç”¨componentWillUnmount    if (inst.componentWillUnmount &amp;&amp; !inst._calledComponentWillUnmount) {      inst._calledComponentWillUnmount = true;      // å®‰å…¨æ¨¡å¼ä¸‹ï¼Œå°†componentWillUnmountåŒ…åœ¨try-catchä¸­ã€‚å¦åˆ™ç›´æ¥componentWillUnmount      if (safely) {        var name = this.getName() + &#39;.componentWillUnmount()&#39;;        ReactErrorUtils.invokeGuardedCallback(name, inst.componentWillUnmount.bind(inst));      } else {        inst.componentWillUnmount();      }    }    // é€’å½’è°ƒç”¨unMountComponentæ¥é”€æ¯å­ç»„ä»¶    if (this._renderedComponent) {      ReactReconciler.unmountComponent(this._renderedComponent, safely);      this._renderedNodeType = null;      this._renderedComponent = null;      this._instance = null;    }    // resetç­‰å¾…é˜Ÿåˆ—å’Œå…¶ä»–ç­‰å¾…çŠ¶æ€    this._pendingStateQueue = null;    this._pendingReplaceState = false;    this._pendingForceUpdate = false;    this._pendingCallbacks = null;    this._pendingElement = null;    // resetå†…éƒ¨å˜é‡,é˜²æ­¢å†…å­˜æ³„æ¼    this._context = null;    this._rootNodeID = null;    this._topLevelWrapper = null;    // å°†ç»„ä»¶ä»mapä¸­ç§»é™¤,è¿˜è®°å¾—æˆ‘ä»¬åœ¨mountComponentä¸­å°†å®ƒåŠ å…¥äº†mapä¸­çš„å§    ReactInstanceMap.remove(inst);  },</code></pre><blockquote><p>å¯è§ï¼ŒunmountComponentè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå®ƒå°±åšä¸‰ä»¶äº‹<br>1.è°ƒç”¨componentWillUnmount()<br>2.é€’å½’è°ƒç”¨unmountComponent(),é”€æ¯å­ç»„ä»¶<br>3.å°†å†…éƒ¨å˜é‡ç½®ç©ºï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</p></blockquote><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Reactè‡ªå®šä¹‰ç»„ä»¶åˆ›å»ºæœŸï¼Œå­˜åœ¨æœŸï¼Œé”€æ¯æœŸä¸‰ä¸ªé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸè°ƒç”¨ä¸Šé¢éƒ½è®²å®Œäº†ã€‚ä¸‰ä¸ªå…¥å£å‡½æ•°mountComponentï¼ŒupdateComponentï¼ŒunmountComponentå°¤å…¶å…³é”®ã€‚å¤§å®¶å¦‚æœæœ‰å…´è¶£ï¼Œè¿˜å¯ä»¥è‡ªè¡Œåˆ†æReactDOMEmptyComponentï¼ŒReactDOMComponentå’ŒReactDOMTextComponentçš„è¿™ä¸‰ä¸ªæ–¹æ³•ã€‚</p><p>æ·±å…¥å­¦ä¹ Reactç”Ÿå‘½å‘¨æœŸæºç å¯ä»¥å¸®æˆ‘ä»¬ç†æ¸…å„ä¸ªæ–¹æ³•çš„è°ƒç”¨é¡ºåºï¼Œæ˜ç™½å®ƒä»¬éƒ½æ˜¯ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨çš„ï¼Œå“ªäº›æ¡ä»¶ä¸‹æ‰ä¼šè¢«è°ƒç”¨ç­‰ç­‰ã€‚é˜…è¯»æºç è™½ç„¶æœ‰ç‚¹æ¯ç‡¥ï¼Œä½†èƒ½å¤Ÿå¤§å¤§åŠ æ·±å¯¹ä¸Šå±‚APIæ¥å£çš„ç†è§£ï¼Œå¹¶ä½“ä¼šè®¾è®¡è€…è®¾è®¡è¿™äº›APIçš„è‰¯è‹¦ç”¨å¿ƒã€‚</p><h1 id="Reactç»„ä»¶ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯´æ˜"><a href="#Reactç»„ä»¶ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯´æ˜" class="headerlink" title="Reactç»„ä»¶ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯´æ˜"></a><a href="http://react-china.org/t/react/1740" target="_blank" rel="noopener">Reactç»„ä»¶ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯´æ˜</a></h1><p>å®ä¾‹åŒ–<br>é¦–æ¬¡å®ä¾‹åŒ–</p><p>getDefaultProps<br>getInitialState<br>componentWillMount<br>render<br>componentDidMount<br>å®ä¾‹åŒ–å®Œæˆåçš„æ›´æ–°</p><p>getInitialState<br>componentWillMount<br>render<br>componentDidMount<br>å­˜åœ¨æœŸ<br>ç»„ä»¶å·²å­˜åœ¨æ—¶çš„çŠ¶æ€æ”¹å˜</p><p>componentWillReceiveProps<br>shouldComponentUpdate<br>componentWillUpdate<br>render<br>componentDidUpdate<br>é”€æ¯&amp;æ¸…ç†æœŸ<br>componentWillUnmount<br>è¯´æ˜<br>ç”Ÿå‘½å‘¨æœŸå…±æä¾›äº†10ä¸ªä¸åŒçš„APIã€‚</p><p>1.getDefaultProps<br>ä½œç”¨äºç»„ä»¶ç±»ï¼Œåªè°ƒç”¨ä¸€æ¬¡ï¼Œè¿”å›å¯¹è±¡ç”¨äºè®¾ç½®é»˜è®¤çš„propsï¼Œå¯¹äºå¼•ç”¨å€¼ï¼Œä¼šåœ¨å®ä¾‹ä¸­å…±äº«ã€‚</p><p>2.getInitialState<br>ä½œç”¨äºç»„ä»¶çš„å®ä¾‹ï¼Œåœ¨å®ä¾‹åˆ›å»ºæ—¶è°ƒç”¨ä¸€æ¬¡ï¼Œç”¨äºåˆå§‹åŒ–æ¯ä¸ªå®ä¾‹çš„stateï¼Œæ­¤æ—¶å¯ä»¥è®¿é—®this.propsã€‚</p><p>3.componentWillMount<br>åœ¨å®Œæˆé¦–æ¬¡æ¸²æŸ“ä¹‹å‰è°ƒç”¨ï¼Œæ­¤æ—¶ä»å¯ä»¥ä¿®æ”¹ç»„ä»¶çš„stateã€‚</p><p>4.render<br>å¿…é€‰çš„æ–¹æ³•ï¼Œåˆ›å»ºè™šæ‹ŸDOMï¼Œè¯¥æ–¹æ³•å…·æœ‰ç‰¹æ®Šçš„è§„åˆ™ï¼š</p><p>åªèƒ½é€šè¿‡this.propså’Œthis.stateè®¿é—®æ•°æ®<br>å¯ä»¥è¿”å›nullã€falseæˆ–ä»»ä½•Reactç»„ä»¶<br>åªèƒ½å‡ºç°ä¸€ä¸ªé¡¶çº§ç»„ä»¶ï¼ˆä¸èƒ½è¿”å›æ•°ç»„ï¼‰<br>ä¸èƒ½æ”¹å˜ç»„ä»¶çš„çŠ¶æ€<br>ä¸èƒ½ä¿®æ”¹DOMçš„è¾“å‡º<br>5.componentDidMount<br>çœŸå®çš„DOMè¢«æ¸²æŸ“å‡ºæ¥åè°ƒç”¨ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­å¯é€šè¿‡this.getDOMNode()è®¿é—®åˆ°çœŸå®çš„DOMå…ƒç´ ã€‚æ­¤æ—¶å·²å¯ä»¥ä½¿ç”¨å…¶ä»–ç±»åº“æ¥æ“ä½œè¿™ä¸ªDOMã€‚</p><p>åœ¨æœåŠ¡ç«¯ä¸­ï¼Œè¯¥æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ã€‚</p><p>6.componentWillReceiveProps<br>ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„propsæ—¶è°ƒç”¨ï¼Œå¹¶å°†å…¶ä½œä¸ºå‚æ•°nextPropsä½¿ç”¨ï¼Œæ­¤æ—¶å¯ä»¥æ›´æ”¹ç»„ä»¶propsåŠstateã€‚</p><pre><code>componentWillReceiveProps: function(nextProps) {    if (nextProps.bool) {        this.setState({            bool: true        });    }}</code></pre><p>7.shouldComponentUpdate<br>ç»„ä»¶æ˜¯å¦åº”å½“æ¸²æŸ“æ–°çš„propsæˆ–stateï¼Œè¿”å›falseè¡¨ç¤ºè·³è¿‡åç»­çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œé€šå¸¸ä¸éœ€è¦ä½¿ç”¨ä»¥é¿å…å‡ºç°bugã€‚åœ¨å‡ºç°åº”ç”¨çš„ç“¶é¢ˆæ—¶ï¼Œå¯é€šè¿‡è¯¥æ–¹æ³•è¿›è¡Œé€‚å½“çš„ä¼˜åŒ–ã€‚</p><p>åœ¨é¦–æ¬¡æ¸²æŸ“æœŸé—´æˆ–è€…è°ƒç”¨äº†forceUpdateæ–¹æ³•åï¼Œè¯¥æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨</p><p>8.componentWillUpdate<br>æ¥æ”¶åˆ°æ–°çš„propsæˆ–è€…stateåï¼Œè¿›è¡Œæ¸²æŸ“ä¹‹å‰è°ƒç”¨ï¼Œæ­¤æ—¶ä¸å…è®¸æ›´æ–°propsæˆ–stateã€‚</p><p>9.componentDidUpdate<br>å®Œæˆæ¸²æŸ“æ–°çš„propsæˆ–è€…stateåè°ƒç”¨ï¼Œæ­¤æ—¶å¯ä»¥è®¿é—®åˆ°æ–°çš„DOMå…ƒç´ ã€‚</p><p>10.componentWillUnmount<br>ç»„ä»¶è¢«ç§»é™¤ä¹‹å‰è¢«è°ƒç”¨ï¼Œå¯ä»¥ç”¨äºåšä¸€äº›æ¸…ç†å·¥ä½œï¼Œåœ¨componentDidMountæ–¹æ³•ä¸­æ·»åŠ çš„æ‰€æœ‰ä»»åŠ¡éƒ½éœ€è¦åœ¨è¯¥æ–¹æ³•ä¸­æ’¤é”€ï¼Œæ¯”å¦‚åˆ›å»ºçš„å®šæ—¶å™¨æˆ–æ·»åŠ çš„äº‹ä»¶ç›‘å¬å™¨ã€‚</p><p><a href="https://yq.aliyun.com/articles/72330?spm=a2c4e.11153940.blogcont72329.20.38732a71NEGBnM" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React æºç åˆ†æ 2 Reactç»„ä»¶æ’å…¥Domæµç¨‹</title>
      <link href="/2018/03/26/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-2-React%E6%8F%92%E5%85%A5Dom%E6%B5%81%E7%A8%8B/"/>
      <url>/2018/03/26/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-2-React%E6%8F%92%E5%85%A5Dom%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>Reactå¹¿å—å¥½è¯„çš„ä¸€ä¸ªé‡è¦åŸå› å°±æ˜¯ç»„ä»¶åŒ–å¼€å‘ï¼Œä¸€æ–¹é¢åˆ†æ¨¡å—çš„æ–¹å¼ä¾¿äºååŒå¼€å‘ï¼Œé™ä½è€¦åˆï¼ŒåæœŸç»´æŠ¤ä¹Ÿè½»æ¾ï¼›å¦ä¸€æ–¹é¢ä½¿å¾—ä¸€æ¬¡å¼€å‘ï¼Œå¤šå¤„å¤ç”¨æˆä¸ºç°å®ï¼Œç”šè‡³å¯ä»¥ç›´æ¥å¤ç”¨å¼€æºReactç»„ä»¶ã€‚å¼€å‘å®Œä¸€ä¸ªç»„ä»¶åï¼Œæˆ‘ä»¬éœ€è¦æ’å…¥DOMä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨å¦‚ä¸‹ä»£ç </p><pre><code class="javascript">ReactDOM.render(  &lt;h1&gt;Hello, world!&lt;/h1&gt;,  document.getElementById(&#39;example&#39;));</code></pre><p>ç»è¿‡babelè½¬ç åä¸º</p><pre><code class="javascript">ReactDOM.render(        React.createElement(          &#39;h1&#39;,   // type, DOMåŸç”Ÿç»„ä»¶çš„typeä¸ºstringï¼ŒReactè‡ªå®šä¹‰ç»„ä»¶typeä¸ºObject          null,   // configï¼Œä¼šè®¾ç½®åˆ°refï¼Œkeyï¼Œpropsä¸­          &#39;Hello, world!&#39;   // childrenï¼Œå­ç»„ä»¶.è¿™å„¿ä¸ºæ–‡æœ¬ç»„ä»¶        ),        document.getElementById(&#39;example&#39;))</code></pre><p>é‚£ä¹ˆReactåº•å±‚æ˜¯æ€ä¹ˆå°†ç»„ä»¶æ’å…¥DOMä¸­çš„å‘¢ã€‚æœ¬æ–‡æ¥è¯¦ç»†åˆ†æå®ƒçš„å‰å› åæœã€‚</p><h1 id="ReactMount-renderSubtreeIntoContainer"><a href="#ReactMount-renderSubtreeIntoContainer" class="headerlink" title="ReactMount._renderSubtreeIntoContainer()"></a>ReactMount._renderSubtreeIntoContainer()</h1><p>ReactDOM.render()å®é™…è°ƒç”¨ReactMount.render(),æ¥ç€è°ƒç”¨åˆ°ReactMount._renderSubtreeIntoContainer().</p><p>è¿™ä¸ªè°ƒç”¨é“¾æ¯”è¾ƒç®€å•ï¼Œä¸åˆ†æäº†ã€‚ä¸‹é¢é‡ç‚¹åˆ†æ_renderSubtreeIntoContainer(). æˆ‘ä»¬å»é™¤æ‰å¼€å‘è°ƒè¯•é˜¶æ®µçš„æŠ¥é”™ä»£ç ï¼ˆæ¯”å¦‚ â€œdevelopmentâ€ !== â€˜productionâ€™ï¼‰ã€‚</p><a id="more"></a><pre><code class="javascript">   /**   * å°†ReactElementæ’å…¥DOMä¸­ï¼Œå¹¶è¿”å›ReactElementå¯¹åº”çš„ReactComponentã€‚   * ReactElementæ˜¯Reactå…ƒç´ åœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºå½¢å¼ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ•°æ®ç±»ï¼ŒåŒ…å«typeï¼Œkeyï¼Œrefsï¼Œpropsç­‰æˆå‘˜å˜é‡   * ReactComponentæ˜¯Reactå…ƒç´ çš„æ“ä½œç±»ï¼ŒåŒ…å«mountComponent(), updateComponent()ç­‰å¾ˆå¤šæ“ä½œç»„ä»¶çš„æ–¹æ³•   *   * @param {parentComponent} çˆ¶ç»„ä»¶ï¼Œå¯¹äºç¬¬ä¸€æ¬¡æ¸²æŸ“ï¼Œä¸ºnull   * @param {nextElement} è¦æ’å…¥åˆ°DOMä¸­çš„ç»„ä»¶ï¼Œå¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„&lt;h1&gt;Hello, world!&lt;/h1&gt;ç»è¿‡babelè½¬è¯‘åçš„å…ƒç´    * @param {container} è¦æ’å…¥åˆ°çš„å®¹å™¨ï¼Œå¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„document.getElementById(&#39;example&#39;)è·å–çš„DOMå¯¹è±¡   * @param {callback} ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸ºnull   *   * @return {component}  è¿”å›ReactComponentï¼Œå¯¹äºReactDOM.render()è°ƒç”¨ï¼Œä¸ç”¨ç®¡è¿”å›å€¼ã€‚   */ _renderSubtreeIntoContainer: function (parentComponent, nextElement, container, callback) {    // åˆšå¼€å§‹ä¸€æ®µå¼€å‘é˜¶æ®µçš„æŠ¥é”™ä»£ç ï¼Œçœå»    ...    // åŒ…è£…ReactElementï¼Œå°†nextElementæŒ‚è½½åˆ°wrapperçš„propså±æ€§ä¸‹ï¼Œè¿™æ®µä»£ç ä¸æ˜¯å¾ˆå…³é”®    var nextWrappedElement = ReactElement(TopLevelWrapper, null, null, null, null, null, nextElement);    // è·å–è¦æ’å…¥åˆ°çš„å®¹å™¨çš„å‰ä¸€æ¬¡çš„ReactComponentï¼Œè¿™æ˜¯ä¸ºäº†åšDOM diff    // å¯¹äºReactDOM.render()è°ƒç”¨ï¼ŒprevComponentä¸ºnull    var prevComponent = getTopLevelWrapperInContainer(container);    if (prevComponent) {      // ä»prevComponentä¸­è·å–åˆ°prevElementè¿™ä¸ªæ•°æ®å¯¹è±¡ã€‚ä¸€å®šè¦ææ¸…æ¥šReactElementå’ŒReactComponentçš„ä½œç”¨ï¼Œä»–ä»¬å¾ˆå…³é”®      var prevWrappedElement = prevComponent._currentElement;      var prevElement = prevWrappedElement.props;      // DOM diffç²¾é«“ï¼ŒåŒä¸€å±‚çº§å†…ï¼Œtypeå’Œkeyä¸å˜æ—¶ï¼Œåªç”¨updateå°±è¡Œã€‚å¦åˆ™å…ˆunmountç»„ä»¶å†mountç»„ä»¶      // è¿™æ˜¯Reactä¸ºäº†é¿å…é€’å½’å¤ªæ·±ï¼Œè€Œåšçš„DOM diffå‰æå‡è®¾ã€‚å®ƒåªå¯¹åŒä¸€DOMå±‚çº§ï¼Œtypeç›¸åŒï¼Œkey(å¦‚æœæœ‰)ç›¸åŒçš„ç»„ä»¶åšDOM diffï¼Œå¦åˆ™ä¸ç”¨æ¯”è¾ƒï¼Œç›´æ¥å…ˆunmountå†mountã€‚è¿™ä¸ªå‡è®¾ä½¿å¾—diffç®—æ³•å¤æ‚åº¦ä»O(n^3)é™ä½ä¸ºO(n).      // shouldUpdateReactComponentæºç è¯·çœ‹åé¢çš„åˆ†æ      if (shouldUpdateReactComponent(prevElement, nextElement)) {        var publicInst = prevComponent._renderedComponent.getPublicInstance();        var updatedCallback = callback &amp;&amp; function () {          callback.call(publicInst);        };        // åªéœ€è¦updateï¼Œè°ƒç”¨_updateRootComponentï¼Œç„¶åç›´æ¥returnäº†        ReactMount._updateRootComponent(prevComponent, nextWrappedElement, container, updatedCallback);        return publicInst;      } else {        // ä¸åšupdateï¼Œç›´æ¥å…ˆå¸è½½å†æŒ‚è½½ã€‚å³unmountComponent,å†mountComponentã€‚mountComponentåœ¨åé¢ä»£ç ä¸­è¿›è¡Œ        ReactMount.unmountComponentAtNode(container);      }    }    var reactRootElement = getReactRootElementInContainer(container);    var containerHasReactMarkup = reactRootElement &amp;&amp; !!internalGetID(reactRootElement);    var containerHasNonRootReactChild = hasNonRootReactChild(container);    var shouldReuseMarkup = containerHasReactMarkup &amp;&amp; !prevComponent &amp;&amp; !containerHasNonRootReactChild;    // åˆå§‹åŒ–ï¼Œæ¸²æŸ“ç»„ä»¶ï¼Œç„¶åæ’å…¥åˆ°DOMä¸­ã€‚_renderNewRootComponentå¾ˆå…³é”®ï¼Œåé¢è¯¦ç»†åˆ†æ    var component = ReactMount._renderNewRootComponent(nextWrappedElement, container, shouldReuseMarkup, parentComponent != null ? parentComponent._reactInternalInstance._processChildContext(parentComponent._reactInternalInstance._context) : emptyObject)._renderedComponent.getPublicInstance();    // renderæ–¹æ³•ä¸­å¸¦å…¥çš„å›è°ƒï¼ŒReactDOM.render()è°ƒç”¨æ—¶ä¸€èˆ¬ä¸ä¼ å…¥    if (callback) {      callback.call(component);    }    return component;  },</code></pre><p>shouldUpdateReactComponent()æºç å¦‚ä¸‹ï¼š</p><pre><code class="javascript">function shouldUpdateReactComponent(prevElement, nextElement) {  // å‰åä¸¤æ¬¡ReactElementä¸­ä»»ä½•ä¸€ä¸ªä¸ºnullï¼Œåˆ™å¿…é¡»å¦ä¸€ä¸ªä¸ºnullæ‰è¿”å›trueã€‚è¿™ç§æƒ…å†µä¸€èˆ¬ä¸ä¼šç¢°åˆ°  var prevEmpty = prevElement === null || prevElement === false;  var nextEmpty = nextElement === null || nextElement === false;  if (prevEmpty || nextEmpty) {    return prevEmpty === nextEmpty;  }  var prevType = typeof prevElement;  var nextType = typeof nextElement;  // React DOM diffç®—æ³•  if (prevType === &#39;string&#39; || prevType === &#39;number&#39;) {    // å¦‚æœå‰åä¸¤æ¬¡ä¸ºæ•°å­—æˆ–è€…å­—ç¬¦,åˆ™è®¤ä¸ºåªéœ€è¦update(å¤„ç†æ–‡æœ¬å…ƒç´ )ï¼Œè¿”å›true    return (nextType === &#39;string&#39; || nextType === &#39;number&#39;);  } else {      // å¦‚æœå‰åä¸¤æ¬¡ä¸ºDOMå…ƒç´ æˆ–Reactå…ƒç´ ,åˆ™å¿…é¡»typeå’Œkeyä¸å˜(keyç”¨äºlistViewç­‰ç»„ä»¶,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰è®¾ç½®keyï¼Œæ•…åªéœ€typeç›¸åŒ)æ‰update,å¦åˆ™å…ˆunmountå†é‡æ–°mountã€‚è¿”å›false    return (      nextType === &#39;object&#39; &amp;&amp;      prevElement.type === nextElement.type &amp;&amp;      prevElement.key === nextElement.key    );  }}</code></pre><h1 id="ReactMount-renderNewRootComponent"><a href="#ReactMount-renderNewRootComponent" class="headerlink" title="ReactMount._renderNewRootComponent"></a>ReactMount._renderNewRootComponent</h1><pre><code class="javascript"> _renderNewRootComponent: function (nextElement, container, shouldReuseMarkup, context) {    ReactBrowserEventEmitter.ensureScrollValueMonitoring();    // åˆå§‹åŒ–ReactComponentï¼Œæ ¹æ®ReactElementä¸­ä¸åŒçš„typeå­—æ®µï¼Œåˆ›å»ºä¸åŒç±»å‹çš„ç»„ä»¶å¯¹è±¡ï¼Œå³ReactComponent    // å‰ä¸€ç¯‡æ–‡ç« ä¸­å·²ç»åˆ†æäº†ã€‚http://blog.csdn.net/u013510838/article/details/55669769    var componentInstance = instantiateReactComponent(nextElement);    // å¤„ç†batchedMountComponentIntoNodeæ–¹æ³•è°ƒç”¨ï¼Œå°†ReactComponentæ’å…¥DOMä¸­ï¼Œåé¢è¯¦ç»†åˆ†æ    ReactUpdates.batchedUpdates(batchedMountComponentIntoNode, componentInstance, container, shouldReuseMarkup, context);    var wrapperID = componentInstance._instance.rootID;    instancesByReactRootID[wrapperID] = componentInstance;    return componentInstance;  },</code></pre><p>batchedMountComponentIntoNodeä»¥transactionäº‹åŠ¡çš„å½¢å¼è°ƒç”¨mountComponentIntoNodeï¼Œæºç åˆ†æå¦‚ä¸‹ã€‚</p><pre><code class="javascript">function mountComponentIntoNode(wrapperInstance, container, transaction, shouldReuseMarkup, context) {  var markerName;  // ä¸€æ®µlogï¼Œå¯ä»¥ä¸ç®¡  if (ReactFeatureFlags.logTopLevelRenders) {    var wrappedElement = wrapperInstance._currentElement.props;    var type = wrappedElement.type;    markerName = &#39;React mount: &#39; + (typeof type === &#39;string&#39; ? type : type.displayName || type.name);    console.time(markerName);  }  // è°ƒç”¨å¯¹åº”ReactComponentä¸­çš„mountComponentæ–¹æ³•æ¥æ¸²æŸ“ç»„ä»¶ï¼Œè¿™ä¸ªæ˜¯Reactç”Ÿå‘½å‘¨æœŸçš„é‡è¦æ–¹æ³•ã€‚åé¢è¯¦ç»†åˆ†æã€‚  // mountComponentè¿”å›Reactç»„ä»¶è§£æçš„HTMLã€‚ä¸åŒçš„ReactComponentçš„mountComponentç­–ç•¥ä¸åŒï¼Œå¯ä»¥çœ‹åšå¤šæ€  // ä¸Šé¢çš„&lt;h1&gt;Hello, world!&lt;/h1&gt;, å¯¹åº”çš„æ˜¯ReactDOMTextComponentï¼Œæœ€ç»ˆè§£ææˆçš„HTMLä¸º  // &lt;h1 data-reactroot=&quot;&quot;&gt;Hello, world!&lt;/h1&gt;  var markup = ReactReconciler.mountComponent(wrapperInstance, transaction, null, ReactDOMContainerInfo(wrapperInstance, container), context);  if (markerName) {    console.timeEnd(markerName);  }  wrapperInstance._renderedComponent._topLevelWrapper = wrapperInstance;  // å°†è§£æå‡ºæ¥çš„HTMLæ’å…¥DOMä¸­  ReactMount._mountImageIntoNode(markup, container, wrapperInstance, shouldReuseMarkup, transaction);}</code></pre><p>_mountImageIntoNodeæºç å¦‚ä¸‹</p><pre><code class="javascript">_mountImageIntoNode: function (markup, container, instance, shouldReuseMarkup, transaction) {    // å¯¹äºReactDOM.render()è°ƒç”¨ï¼ŒshouldReuseMarkupä¸ºfalse    if (shouldReuseMarkup) {      ...    }    if (transaction.useCreateElement) {      // æ¸…ç©ºcontainerçš„å­èŠ‚ç‚¹ï¼Œè¿™ä¸ªåœ°æ–¹ä¸æ˜ç™½ä¸ºä»€ä¹ˆè¿™ä¹ˆåš      while (container.lastChild) {        container.removeChild(container.lastChild);      }      DOMLazyTree.insertTreeBefore(container, markup, null);    } else {      // å°†markupè¿™ä¸ªHTMLè®¾ç½®åˆ°containerè¿™ä¸ªDOMå…ƒç´ çš„innerHTMLå±æ€§ä¸Šï¼Œè¿™æ ·å°±æ’å…¥åˆ°äº†DOMä¸­äº†      setInnerHTML(container, markup);      // å°†instanceè¿™ä¸ªReactComponentæ¸²æŸ“åçš„å¯¹è±¡ï¼Œå³Virtual DOMï¼Œä¿å­˜åˆ°containerè¿™ä¸ªDOMå…ƒç´ çš„firstChildè¿™ä¸ªåŸç”ŸèŠ‚ç‚¹ä¸Šã€‚ç®€å•ç†è§£å°±æ˜¯å°†Virtual DOMä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜äº¤äº’æ•ˆç‡      ReactDOMComponentTree.precacheNode(instance, container.firstChild);    }  }</code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ReactDOM.render(ï¼‰æ˜¯æ¸²æŸ“Reactç»„ä»¶å¹¶æ’å…¥åˆ°DOMä¸­çš„å…¥å£æ–¹æ³•ï¼Œå®ƒçš„æ‰§è¡Œæµç¨‹å¤§æ¦‚ä¸º</p><p>1.React.createElement(),åˆ›å»ºReactElementå¯¹è±¡ã€‚ä»–çš„é‡è¦çš„æˆå‘˜å˜é‡æœ‰type,key,ref,propsã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šè°ƒç”¨getInitialState(), åˆå§‹åŒ–stateï¼Œåªåœ¨æŒ‚è½½çš„æ—¶å€™æ‰è°ƒç”¨ã€‚åé¢updateæ—¶ä¸å†è°ƒç”¨äº†ã€‚</p><p>2.instantiateReactComponent()ï¼Œæ ¹æ®ReactElementçš„typeåˆ†åˆ«åˆ›å»ºReactDOMComponentï¼Œ ReactCompositeComponentï¼ŒReactDOMTextComponentç­‰å¯¹è±¡</p><p>3.mountComponent(), è°ƒç”¨Reactç”Ÿå‘½å‘¨æœŸæ–¹æ³•è§£æç»„ä»¶ï¼Œå¾—åˆ°å®ƒçš„HTMLã€‚</p><p>4._mountImageIntoNode(), å°†HTMLæ’å…¥åˆ°DOMçˆ¶èŠ‚ç‚¹ä¸­ï¼Œé€šè¿‡è®¾ç½®DOMçˆ¶èŠ‚ç‚¹çš„innerHTMLå±æ€§ã€‚</p><p>5.ç¼“å­˜èŠ‚ç‚¹åœ¨Reactä¸­çš„å¯¹åº”å¯¹è±¡ï¼Œå³Virtual DOMã€‚</p><p>!()[]</p><p><a href="https://zhuanlan.zhihu.com/p/25882202" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React æºç åˆ†æ 1 ç»„ä»¶å’Œå¯¹è±¡çš„åˆ›å»ºï¼ˆcreateClassï¼ŒcreateElement)</title>
      <link href="/2018/03/25/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-1-%E7%BB%84%E4%BB%B6%E5%92%8C%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA%EF%BC%88createClass%EF%BC%8CcreateElement/"/>
      <url>/2018/03/25/React/React-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-1-%E7%BB%84%E4%BB%B6%E5%92%8C%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA%EF%BC%88createClass%EF%BC%8CcreateElement/</url>
      
        <content type="html"><![CDATA[<p>Reactå—å¤§å®¶æ¬¢è¿çš„ä¸€ä¸ªé‡è¦åŸå› å°±æ˜¯å¯ä»¥è‡ªå®šä¹‰ç»„ä»¶ã€‚è¿™æ ·çš„ä¸€æ–¹é¢å¯ä»¥å¤ç”¨å¼€å‘å¥½çš„ç»„ä»¶ï¼Œå®ç°ä¸€å¤„å¼€å‘ï¼Œå¤„å¤„è°ƒç”¨ï¼Œå¦å¤–ä¹Ÿèƒ½ä½¿ç”¨åˆ«äººå¼€å‘å¥½çš„ç»„ä»¶ï¼Œæé«˜å°è£…æ€§ã€‚å¦ä¸€æ–¹é¢ä½¿å¾—ä»£ç ç»“æ„å¾ˆæ¸…æ™°ï¼Œç»„ä»¶é—´è€¦åˆå‡å°‘ï¼Œæ–¹ä¾¿ç»´æŠ¤ã€‚ES5åˆ›å»ºç»„ä»¶æ—¶ï¼Œè°ƒç”¨React.createClass()å³å¯. ES6ä¸­ä½¿ç”¨class myComponent extends React.Component, å…¶å®å†…éƒ¨è¿˜æ˜¯è°ƒç”¨createClassåˆ›å»ºç»„ä»¶ã€‚</p><p>ç»„ä»¶åˆ›å»ºæˆ‘ä»¬å¯ä»¥ç®€å•ç±»æ¯”ä¸ºJavaä¸­ClassLoaderåŠ è½½classã€‚ä¸‹é¢æ¥åˆ†æä¸‹createClassçš„æºç ï¼Œæˆ‘ä»¬çœå»äº†å¼€å‘é˜¶æ®µé”™è¯¯æç¤ºçš„ç›¸å…³ä»£ç ï¼Œå¦‚propTypeçš„æ£€æŸ¥ã€‚ï¼ˆif (â€œdevelopmentâ€ !== â€˜productionâ€™) {}ä»£ç æ®µéƒ½ä¸è¿›è¡Œåˆ†æäº†ï¼Œè¿™äº›åªåœ¨å¼€å‘è°ƒè¯•é˜¶æ®µè°ƒç”¨ï¼‰</p><h1 id="ç»„ä»¶åˆ›å»º"><a href="#ç»„ä»¶åˆ›å»º" class="headerlink" title="ç»„ä»¶åˆ›å»º"></a>ç»„ä»¶åˆ›å»º</h1><pre><code class="javascript">createClass: function (spec) {    var Constructor = function (props, context, updater) {      // è§¦å‘è‡ªåŠ¨ç»‘å®š      if (this.__reactAutoBindPairs.length) {        bindAutoBindMethods(this);      }      // åˆå§‹åŒ–å‚æ•°      this.props = props;      this.context = context;      this.refs = emptyObject;  // æœ¬ç»„ä»¶å¯¹è±¡çš„å¼•ç”¨ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥è°ƒç”¨ç»„ä»¶çš„æ–¹æ³•      this.updater = updater || ReactNoopUpdateQueue;      // è°ƒç”¨getInitialState()æ¥åˆå§‹åŒ–stateå˜é‡      this.state = null;      var initialState = this.getInitialState ? this.getInitialState() : null;      this.state = initialState;    };    // ç»§æ‰¿çˆ¶ç±»    Constructor.prototype = new ReactClassComponent();    Constructor.prototype.constructor = Constructor;    Constructor.prototype.__reactAutoBindPairs = [];    injectedMixins.forEach(mixSpecIntoComponent.bind(null, Constructor));    mixSpecIntoComponent(Constructor, spec);    // è°ƒç”¨getDefaultPropsï¼Œå¹¶æŒ‚è½½åˆ°ç»„ä»¶ç±»ä¸Šã€‚defaultPropsæ˜¯ç±»å˜é‡ï¼Œä½¿ç”¨ES6å†™æ³•æ—¶æ›´æ¸…æ™°    if (Constructor.getDefaultProps) {      Constructor.defaultProps = Constructor.getDefaultProps();    }    // Reactä¸­æš´éœ²ç»™åº”ç”¨è°ƒç”¨çš„æ–¹æ³•ï¼Œå¦‚render componentWillMountã€‚    // å¦‚æœåº”ç”¨æœªè®¾ç½®ï¼Œåˆ™å°†ä»–ä»¬è®¾ä¸ºnull    for (var methodName in ReactClassInterface) {      if (!Constructor.prototype[methodName]) {        Constructor.prototype[methodName] = null;      }    }    return Constructor;  },</code></pre><a id="more"></a><blockquote><p>createClassä¸»è¦åšçš„äº‹æƒ…æœ‰<br>1.å®šä¹‰æ„é€ æ–¹æ³•Constructorï¼Œæ„é€ æ–¹æ³•ä¸­è¿›è¡Œpropsï¼Œrefsç­‰çš„åˆå§‹åŒ–ï¼Œå¹¶è°ƒç”¨getInitialStateæ¥åˆå§‹åŒ–state<br>2.è°ƒç”¨getDefaultPropsï¼Œå¹¶æ”¾åœ¨defaultPropsç±»å˜é‡ä¸Šã€‚è¿™ä¸ªå˜é‡ä¸å±äºæŸä¸ªå•ç‹¬çš„å¯¹è±¡ã€‚å¯ç†è§£ä¸ºstatic å˜é‡<br>3.å°†Reactä¸­æš´éœ²ç»™åº”ç”¨ï¼Œä½†åº”ç”¨ä¸­æ²¡æœ‰è®¾ç½®çš„æ–¹æ³•ï¼Œè®¾ç½®ä¸ºnullã€‚</p></blockquote><h1 id="å¯¹è±¡çš„åˆ›å»º"><a href="#å¯¹è±¡çš„åˆ›å»º" class="headerlink" title="å¯¹è±¡çš„åˆ›å»º"></a>å¯¹è±¡çš„åˆ›å»º</h1><p>JSXä¸­åˆ›å»ºReactå…ƒç´ æœ€ç»ˆä¼šè¢«babelè½¬è¯‘ä¸ºcreateElement(type, config, children), babelæ ¹æ®JSXä¸­æ ‡ç­¾çš„é¦–å­—æ¯æ¥åˆ¤æ–­æ˜¯åŸç”ŸDOMç»„ä»¶ï¼Œè¿˜æ˜¯è‡ªå®šä¹‰Reactç»„ä»¶ã€‚å¦‚æœé¦–å­—æ¯å¤§å†™ï¼Œåˆ™ä¸ºReactç»„ä»¶ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆES6ä¸­Reactç»„ä»¶ç±»åå¿…é¡»å¤§å†™çš„åŸå› ã€‚å¦‚ä¸‹é¢ä»£ç </p><pre><code class="javascript">&lt;div className=&quot;title&quot; ref=&quot;example&quot;&gt;    &lt;span&gt;123&lt;/span&gt;    // åŸç”ŸDOMç»„ä»¶ï¼Œé¦–å­—æ¯å°å†™    &lt;ErrorPage title=&#39;123456&#39; desc={[]}/&gt;    // è‡ªå®šä¹‰ç»„ä»¶ï¼Œé¦–å­—æ¯å¤§å†™&lt;/div&gt;</code></pre><p>è½¬è¯‘å®Œæˆå</p><pre><code class="javascript">React.createElement(        &#39;div&#39;,    // type,æ ‡ç­¾å,åŸç”ŸDOMå¯¹è±¡ä¸ºString        {            className: &#39;title&#39;,            ref: &#39;example&#39;        },   // configï¼Œå±æ€§        React.createElement(&#39;span&#39;, null, &#39;123&#39;),   // childrenï¼Œå­å…ƒç´         React.createElement(            // type,æ ‡ç­¾å,Reactè‡ªå®šä¹‰ç»„ä»¶çš„typeä¸ä¸ºString.            // _errorPage2.defaultä¸ºä»å…¶ä»–æ–‡ä»¶ä¸­å¼•å…¥çš„Reactç»„ä»¶            _errorPage2.default,                {                title: &#39;123456&#39;,                desc: []            }        )   // childrenï¼Œå­å…ƒç´ )</code></pre><p>ä¸‹é¢æ¥åˆ†æä¸‹createElementçš„æºç </p><pre><code class="javascript">ReactElement.createElement = function (type, config, children) {  var propName;  // åˆå§‹åŒ–å‚æ•°  var props = {};  var key = null;  var ref = null;  var self = null;  var source = null;  // ä»configä¸­æå–å‡ºå†…å®¹ï¼Œå¦‚ref key props  if (config != null) {    ref = config.ref === undefined ? null : config.ref;    key = config.key === undefined ? null : &#39;&#39; + config.key;    self = config.__self === undefined ? null : config.__self;    source = config.__source === undefined ? null : config.__source;    // æå–å‡ºconfigä¸­çš„propï¼Œæ”¾å…¥propså˜é‡ä¸­    for (propName in config) {      if (config.hasOwnProperty(propName) &amp;&amp; !RESERVED_PROPS.hasOwnProperty(propName)) {        props[propName] = config[propName];      }    }  }  // å¤„ç†childrenï¼ŒæŒ‚åˆ°propsçš„childrenå±æ€§ä¸‹  // å…¥å‚çš„å‰ä¸¤ä¸ªä¸ºtypeå’Œconfigï¼Œåé¢çš„å°±éƒ½æ˜¯childrenå‚æ•°äº†ã€‚æ•…éœ€è¦å‡2  var childrenLength = arguments.length - 2;  if (childrenLength === 1) {    // åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œç›´æ¥æŒ‚åˆ°childrenå±æ€§ä¸‹ï¼Œä¸æ˜¯arrayçš„æ–¹å¼    props.children = children;  } else if (childrenLength &gt; 1) {    // ä¸æ­¢ä¸€ä¸ªæ—¶ï¼Œæ”¾åˆ°arrayä¸­ï¼Œç„¶åå°†arrayæŒ‚åˆ°childrenå±æ€§ä¸‹    var childArray = Array(childrenLength);    for (var i = 0; i &lt; childrenLength; i++) {      childArray[i] = arguments[i + 2];    }    props.children = childArray;  }  // å–å‡ºç»„ä»¶ç±»ä¸­çš„é™æ€å˜é‡defaultPropsï¼Œå¹¶ç»™æœªåœ¨JSXä¸­è®¾ç½®å€¼çš„å±æ€§è®¾ç½®é»˜è®¤å€¼  if (type &amp;&amp; type.defaultProps) {    var defaultProps = type.defaultProps;    for (propName in defaultProps) {      if (props[propName] === undefined) {        props[propName] = defaultProps[propName];      }    }  }  // è¿”å›ä¸€ä¸ªReactElementå¯¹è±¡  return ReactElement(type, key, ref, self, source, ReactCurrentOwner.current, props);};</code></pre><p>ä¸‹é¢æ¥çœ‹ReactElementæºç </p><pre><code class="javascript">var ReactElement = function (type, key, ref, self, source, owner, props) {  var element = {    // This tag allow us to uniquely identify this as a React Element    $$typeof: REACT_ELEMENT_TYPE,    // ReactElementå¯¹è±¡ä¸Šçš„å››ä¸ªå˜é‡ï¼Œç‰¹åˆ«å…³é”®    type: type,    key: key,    ref: ref,    props: props,    // Record the component responsible for creating this element.    _owner: owner  };    return element;}</code></pre><p>å¯ä»¥çœ‹åˆ°ä»…ä»…æ˜¯ç»™ReactElementå¯¹è±¡å†…çš„æˆå‘˜å˜é‡èµ‹å€¼è€Œå·²ï¼Œä¸åœ¨èµ˜è¿°ã€‚</p><p>æµç¨‹å¦‚å¦‚ä¸‹</p><h1 id="ç»„ä»¶å¯¹è±¡åˆå§‹åŒ–"><a href="#ç»„ä»¶å¯¹è±¡åˆå§‹åŒ–" class="headerlink" title="ç»„ä»¶å¯¹è±¡åˆå§‹åŒ–"></a>ç»„ä»¶å¯¹è±¡åˆå§‹åŒ–</h1><p>åœ¨mountComponent()æŒ‚è½½ç»„ä»¶ä¸­ï¼Œä¼šè¿›è¡Œç»„ä»¶æ¸²æŸ“ï¼Œè°ƒç”¨åˆ°instantiateReactComponent()æ–¹æ³•ã€‚è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬åœ¨Reactç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­å†è¯¦ç»†è®²è¿°ï¼Œè¿™é‡Œæœ‰ä¸ªå¤§ä½“äº†è§£å³å¯ã€‚instantiateReactComponent()æ ¹æ®ReactElementä¸­ä¸åŒçš„typeå­—æ®µï¼Œåˆ›å»ºä¸åŒç±»å‹çš„ç»„ä»¶å¯¹è±¡ã€‚æºç å¦‚ä¸‹</p><pre><code class="javascript">// åˆå§‹åŒ–ç»„ä»¶å¯¹è±¡ï¼Œnodeæ˜¯ä¸€ä¸ªReactElementå¯¹è±¡ï¼Œæ˜¯èŠ‚ç‚¹å…ƒç´ åœ¨Reactä¸­çš„è¡¨ç¤ºfunction instantiateReactComponent(node) {  var instance;  var isEmpty = node === null || node === false;  if (isEmpty) {    // ç©ºå¯¹è±¡    instance = ReactEmptyComponent.create(instantiateReactComponent);  } else if (typeof node === &#39;object&#39;) {    // ç»„ä»¶å¯¹è±¡ï¼ŒåŒ…æ‹¬DOMåŸç”Ÿçš„å’ŒReactè‡ªå®šä¹‰ç»„ä»¶    var element = node;    // æ ¹æ®ReactElementä¸­çš„typeå­—æ®µåŒºåˆ†    if (typeof element.type === &#39;string&#39;) {      // typeä¸ºstringåˆ™è¡¨ç¤ºDOMåŸç”Ÿå¯¹è±¡ï¼Œæ¯”å¦‚div spanç­‰ã€‚å¯ä»¥å‚çœ‹ä¸Šé¢babelè½¬è¯‘çš„é‚£æ®µä»£ç       instance = ReactNativeComponent.createInternalComponent(element);    } else if (isInternalComponentType(element.type)) {      // ä¿ç•™ç»™ä»¥åç‰ˆæœ¬ä½¿ç”¨ï¼Œæ­¤å¤„æš‚æ—¶ä¸ä¼šæ¶‰åŠåˆ°      instance = new element.type(element);    } else {      // Reactè‡ªå®šä¹‰ç»„ä»¶      instance = new ReactCompositeComponentWrapper(element);    }  } else if (typeof node === &#39;string&#39; || typeof node === &#39;number&#39;) {    // å…ƒç´ æ˜¯ä¸€ä¸ªstringæ—¶ï¼Œå¯¹åº”çš„æ¯”å¦‚&lt;span&gt;123&lt;/span&gt; ä¸­çš„123    // æœ¬è´¨ä¸Šå®ƒä¸æ˜¯ä¸€ä¸ªReactElementï¼Œä½†ä¸ºäº†ç»Ÿä¸€ï¼Œä¹ŸæŒ‰ç…§åŒæ ·æµç¨‹å¤„ç†ï¼Œç§°ä¸ºReactDOMTextComponent    instance = ReactNativeComponent.createInstanceForText(node);  } else {    // æ— å¤„ç†  }  // åˆå§‹åŒ–å‚æ•°ï¼Œè¿™ä¸¤ä¸ªå‚æ•°æ˜¯DOM diffæ—¶ç”¨åˆ°çš„  instance._mountIndex = 0;  instance._mountImage = null;  return instance;}</code></pre><blockquote><p>æ•…æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å››ç§åˆ›å»ºç»„ä»¶å…ƒç´ çš„æ–¹å¼ï¼ŒåŒæ—¶å¯¹åº”å››ç§ReactElement<br>1.ReactEmptyComponent.create(), åˆ›å»ºç©ºå¯¹è±¡ReactDOMEmptyComponent<br>2.ReactNativeComponent.createInternalComponent(), åˆ›å»ºDOMåŸç”Ÿå¯¹è±¡ ReactDOMComponent<br>3.new ReactCompositeComponentWrapper(), åˆ›å»ºReactè‡ªå®šä¹‰å¯¹è±¡ReactCompositeComponent<br>4.ReactNativeComponent.createInstanceForText(), åˆ›å»ºæ–‡æœ¬å¯¹è±¡ ReactDOMTextComponent</p></blockquote><p>ä¸‹é¢åˆ†åˆ«åˆ†æè¿™å‡ ç§å¯¹è±¡ï¼Œå’Œåˆ›å»ºä»–ä»¬çš„è¿‡ç¨‹ã€‚</p><p><strong>ReactDOMEmptyComponent</strong><br>ç”±ReactEmptyComponent.create()åˆ›å»ºï¼Œæœ€ç»ˆç”ŸæˆReactDOMEmptyComponentå¯¹è±¡ï¼Œæºç å¦‚ä¸‹</p><pre><code class="javascript">var emptyComponentFactory;var ReactEmptyComponentInjection = {  injectEmptyComponentFactory: function (factory) {    emptyComponentFactory = factory;  }};var ReactEmptyComponent = {  create: function (instantiate) {    return emptyComponentFactory(instantiate);  }};ReactEmptyComponent.injection = ReactEmptyComponentInjection;ReactInjection.EmptyComponent.injectEmptyComponentFactory(function (instantiate) {  // å‰é¢æ¯”è¾ƒç»•ï¼Œå…³é”®å°±æ˜¯è¿™å¥è¯ï¼Œåˆ›å»ºReactDOMEmptyComponentå¯¹è±¡   return new ReactDOMEmptyComponent(instantiate);});// å„ç§nullï¼Œå°±ä¸åˆ†æäº†var ReactDOMEmptyComponent = function (instantiate) {  this._currentElement = null;  this._nativeNode = null;  this._nativeParent = null;  this._nativeContainerInfo = null;  this._domID = null;};</code></pre><p><strong>ReactDOMComponent</strong><br>ç”±ReactNativeComponent.createInternalComponent()åˆ›å»ºã€‚è¿™é‡Œæ³¨æ„åŸç”Ÿç»„ä»¶ä¸ä»£è¡¨æ˜¯DOMç»„ä»¶ï¼Œè€Œæ˜¯Reactå°è£…è¿‡çš„Virtual DOMå¯¹è±¡ã€‚Reactå¹¶ä¸ç›´æ¥æ“ä½œåŸç”ŸDOMã€‚</p><p>å¤§å®¶å¯ä»¥è‡ªå·±çœ‹ReactDOMComponentçš„æºç ã€‚é‡ç‚¹çœ‹ä¸‹ReactDOMComponent.Mixin</p><pre><code class="javascript">ReactDOMComponent.Mixin = {  mountComponent: function (transaction, nativeParent, nativeContainerInfo, context) {},  _createOpenTagMarkupAndPutListeners: function (transaction, props){},  _createContentMarkup: function (transaction, props, context) {},  _createInitialChildren: function (transaction, props, context, lazyTree) {}  receiveComponent: function (nextElement, transaction, context) {},  updateComponent: function (transaction, prevElement, nextElement, context) {},  _updateDOMProperties: function (lastProps, nextProps, transaction) {},  _updateDOMChildren: function (lastProps, nextProps, transaction, context) {},  getNativeNode: function () {},  unmountComponent: function (safely) {},  getPublicInstance: function () {}}</code></pre><p>å…¶ä¸­æš´éœ²ç»™å¤–éƒ¨çš„æ¯”è¾ƒå…³é”®çš„æ˜¯mountComponentï¼ŒreceiveComponenï¼Œ updateComponentï¼ŒunmountComponentã€‚ä»–ä»¬ä¼šå¼•å‘Reactç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„è°ƒç”¨ï¼Œä¸‹ä¸€èŠ‚å†è®²ã€‚</p><p><strong>ReactCompositeComponent</strong><br>ç”±new ReactCompositeComponentWrapper()åˆ›å»ºï¼Œé‡ç‚¹çœ‹ä¸‹ReactCompositeComponentMixin</p><pre><code class="javascript">var ReactCompositeComponentMixin = {  // newå¯¹åº”çš„æ–¹æ³•ï¼Œåˆ›å»ºReactCompositeComponentå¯¹è±¡  construct: function(element) {},  mountComponent,   // åˆå§‹æŒ‚è½½ç»„ä»¶æ—¶è¢«è°ƒç”¨ï¼Œä»…ä¸€æ¬¡  performInitialMountWithErrorHandling, // å’ŒperformInitialMountç›¸è¿‘ï¼Œåªæ˜¯å¤šäº†é”™è¯¯å¤„ç†  performInitialMount,  // æ‰§è¡ŒmountComponentçš„æ¸²æŸ“é˜¶æ®µï¼Œä¼šè°ƒç”¨åˆ°instantiateReactComponentï¼Œä»è€Œè¿›å…¥åˆå§‹åŒ–Reactç»„ä»¶çš„å…¥å£  getNativeNode,  unmountComponent, // å¸è½½ç»„ä»¶ï¼Œå†…å­˜é‡Šæ”¾ç­‰å·¥ä½œ  receiveComponent,  performUpdateIfNecessary,  updateComponent,  // setStateåè¢«è°ƒç”¨ï¼Œé‡æ–°æ¸²æŸ“ç»„ä»¶  attachRef,    // å°†refæŒ‡å‘ç»„ä»¶å¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å®ƒè°ƒç”¨å¯¹è±¡å†…çš„æ–¹æ³•äº†  detachRef,    // å°†ç»„ä»¶çš„å¼•ç”¨ä»å…¨å±€å¯¹è±¡refsä¸­åˆ æ‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸èƒ½åˆ©ç”¨refæ‰¾åˆ°ç»„ä»¶å¯¹è±¡äº†  instantiateReactComponentï¼Œ  // åˆå§‹åŒ–Reactç»„ä»¶çš„å…¥å£ï¼Œåœ¨mountComponentæ—¶çš„æ¸²æŸ“é˜¶æ®µä¼šè¢«è°ƒç”¨}</code></pre><p><strong>ReactDOMTextComponent</strong></p><p>ç”±ReactNativeComponent.createInstanceForText()åˆ›å»ºï¼Œæˆ‘ä»¬ä¹Ÿä¸ç»†ç»†åˆ†æäº†ï¼Œä¸»è¦å…¥å£ä»£ç å¦‚ä¸‹ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œåˆ†æã€‚</p><pre><code class="javascript">var ReactDOMTextComponent = function (text) {  this._currentElement = text;  this._stringText = &#39;&#39; + text;};_assign(ReactDOMTextComponent.prototype, {  mountComponent,  receiveComponent,  getNativeNode,  unmountComponent}</code></pre><p><a href="https://zhuanlan.zhihu.com/p/25881952" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javascriptå®ç”¨æŠ€å·§</title>
      <link href="/2018/03/23/Js/javascript%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
      <url>/2018/03/23/Js/javascript%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="æ›´çŸ­çš„æ•°ç»„å»é‡å†™æ³•"><a href="#æ›´çŸ­çš„æ•°ç»„å»é‡å†™æ³•" class="headerlink" title="æ›´çŸ­çš„æ•°ç»„å»é‡å†™æ³•"></a>æ›´çŸ­çš„æ•°ç»„å»é‡å†™æ³•</h1><pre><code class="javascript">[...new Set([2,&quot;12&quot;,2,12,1,2,1,6,12,13,6])]//[2, &quot;12&quot;, 12, 1, 6, 13]//es6çš„æ–°ç‰¹æ€§</code></pre><h1 id="å¯¹è±¡æ·±æµ…æ‹·è´"><a href="#å¯¹è±¡æ·±æµ…æ‹·è´" class="headerlink" title="å¯¹è±¡æ·±æµ…æ‹·è´"></a>å¯¹è±¡æ·±æµ…æ‹·è´</h1><p>1.æ·±æ‹·è´å’Œæµ…æ‹·è´åªé’ˆå¯¹åƒObject, Arrayè¿™æ ·çš„å¼•ç”¨ç±»å‹æ•°æ®ã€‚</p><p>2.æµ…æ‹·è´æ˜¯å¯¹å¯¹è±¡å¼•ç”¨åœ°å€è¿›è¡Œæ‹·è´ï¼Œå¹¶æ²¡æœ‰å¼€è¾Ÿæ–°çš„æ ˆï¼Œä¹Ÿå°±æ˜¯æ‹·è´åçš„ç»“æœæ˜¯ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨åœ°å€ï¼Œä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œåˆ™å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ä¹Ÿä¼šæ”¹å˜ã€‚</p><p>3.æ·±æ‹·è´åˆ™æ˜¯å¼€å¯ä¸€ä¸ªæ–°çš„æ ˆï¼Œä¸¤ä¸ªå¯¹è±¡å¯¹åº”ä¸¤ä¸ªä¸åŒçš„å¼•ç”¨åœ°å€ï¼Œä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œä¸ä¼šæ”¹å˜å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ã€‚</p><p>æµ…æ‹·è´</p><pre><code class="javascript">var myInfo={name:&#39;å®ˆå€™&#39;,sex:&#39;ç”·&#39;};var newInfo=myInfo;newInfo.sex=&#39;å¥³&#39;;console.log(myInfo)   //{name: &quot;å®ˆå€™&quot;, sex: &quot;å¥³&quot;}</code></pre><p>å‡-æ·±æ‹·è´<br>å‡-æ·±æ‹·è´è¿™ä¸ªæ˜¯è‡ªå·±éšæ€§å‘½åçš„ï¼Œå¤§å®¶çœ‹çœ‹å°±å¥½ï¼Œåˆ«å½“çœŸï¼</p><pre><code class="javascript">var myInfo={name:&#39;å®ˆå€™&#39;,sex:&#39;ç”·&#39;};var newInfo=Object.assign({},myInfo)newInfo.sex=&#39;å¥³&#39;;</code></pre><p>çœŸ-æ·±æ‹·è´<br>çœŸ-æ·±æ‹·è´è¿™ä¸ªæ˜¯è‡ªå·±éšæ€§å‘½åçš„ï¼Œå¤§å®¶çœ‹çœ‹å°±å¥½ï¼Œåˆ«å½“çœŸï¼<br><a id="more"></a><br>çœ‹ç€æ·±æµ…æ‹·è´ï¼ŒåŒºåˆ«å†™æ³•å¾ˆç®€å•ï¼Œä½†æ˜¯é‚£ä¸ªä¸Šé¢çš„æ·±æ‹·è´å†™æ³•æ˜¯æœ‰é—®é¢˜çš„ã€‚çœ‹ä¸‹é¢æ¡ˆä¾‹</p><pre><code class="javascript">var arr=[{a:1,b:2},{a:3,b:4}]var newArr=Object.assign([],arr)//æˆªæ–­æ•°ç»„newArr.length=1console.log(newArr)//[{a:1,b:2}]console.log(arr)//[{a:1,b:2},{a:3,b:4}]//æ“ä½œnewArrï¼Œè¿™é‡Œçœ‹ç€å¯¹arræ²¡å½±å“ï¼Œå®é™…ä¸Šå·²ç»æŒ–äº†ä¸€ä¸ªå‘ï¼Œä¸‹é¢å°±è·³è¿›å»newArr[0].a=123//ä¿®æ”¹newArr[0]è¿™ä¸ªå¯¹è±¡ï¼Œä¹Ÿæ˜¯å½±å“äº†arr[0]è¿™ä¸ªå¯¹è±¡console.log(arr[0])//{a: 123, b: 2}</code></pre><p>//åˆ©ç”¨é€’å½’æ¥å®ç°æ·±æ‹·è´ï¼Œå¦‚æœå¯¹è±¡å±æ€§çš„å€¼æ˜¯å¼•ç”¨ç±»å‹ï¼ˆArray,Objectï¼‰ï¼Œé‚£ä¹ˆå¯¹è¯¥å±æ€§è¿›è¡Œæ·±æ‹·è´ï¼Œç›´åˆ°éå†åˆ°å±æ€§çš„å€¼æ˜¯åŸºæœ¬ç±»å‹ä¸ºæ­¢ã€‚ </p><pre><code class="javascript">function deepClone(obj){      if(!obj&amp;&amp; typeof obj!== &#39;object&#39;){          return;      }      var newObj= obj.constructor === Array ? [] : {};      for(var key in obj){           if(obj[key]){                if(obj[key] &amp;&amp; typeof obj[key] === &#39;object&#39;){          newObj[key] = obj[key].constructor === Array ? [] : {};         //é€’å½’        newObj[key] = deepClone(obj[key]);                }else{                    newObj[key] = obj[key];               }           }      }      return newObj; }var arr=[{a:1,b:2},{a:3,b:4}]var newArr=deepClone(arr)console.log(arr[0])//{a:1,b:2}newArr[0].a=123console.log(arr[0])//{a:1,b:2}</code></pre><p>è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ç®€å•ç²—æš´æ³•ï¼Œæˆ‘ç°åœ¨åœ¨ç”¨çš„ä¸€ä¸ªæ–¹æ³•ï¼åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯å…ˆæŠŠå¯¹è±¡è½¬æˆå­—ç¬¦ä¸²ï¼Œå†æŠŠå­—ç¬¦ä¸²è½¬æˆå¯¹è±¡ï¼ä¹Ÿèƒ½å®ç°åŒæ ·æ•ˆæœ</p><pre><code class="javascript">var newArr2=JSON.parse(JSON.stringify(arr));console.log(arr[0])//{a:1,b:2}newArr2[0].a=123console.log(arr[0])//{a:1,b:2}ä¸Šé¢æ‰€è¯´çš„æµ…æ‹·è´ï¼ŒçœŸå‡æ·±æ‹·è´ï¼ˆè‡ªå·±éšæ€§å‘½åçš„ï¼‰ï¼Œè¿™å‡ ç§æƒ…å†µï¼Œåœ¨å¼€å‘ä¸Šéƒ½æœ‰å¯èƒ½è¦ç”¨åˆ°ï¼Œè‡³äºè¦ä½¿ç”¨å“ªä¸€ç§æ–¹å¼ï¼Œè§†æƒ…å†µè€Œå®šï¼</code></pre><h1 id="ä½¿ç”¨äº‹ä»¶å§”æ‰˜"><a href="#ä½¿ç”¨äº‹ä»¶å§”æ‰˜" class="headerlink" title="ä½¿ç”¨äº‹ä»¶å§”æ‰˜"></a>ä½¿ç”¨äº‹ä»¶å§”æ‰˜</h1><p>ä¸€ä¸ªç®€å•çš„éœ€æ±‚ï¼Œæ¯”å¦‚æƒ³ç»™ulä¸‹é¢çš„liåŠ ä¸Šç‚¹å‡»äº‹ä»¶ï¼Œç‚¹å‡»å“ªä¸ªliï¼Œå°±æ˜¾ç¤ºé‚£ä¸ªliçš„innerHTMLã€‚è¿™ä¸ªè²Œä¼¼å¾ˆç®€å•ï¼ä»£ç å¦‚ä¸‹ï¼</p><pre><code class="javascript">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;ul id=&quot;ul-test&quot;&gt;            &lt;li&gt;0&lt;/li&gt;            &lt;li&gt;1&lt;/li&gt;            &lt;li&gt;2&lt;/li&gt;            &lt;li&gt;3&lt;/li&gt;            &lt;li&gt;4&lt;/li&gt;            &lt;li&gt;5&lt;/li&gt;            &lt;li&gt;6&lt;/li&gt;            &lt;li&gt;7&lt;/li&gt;            &lt;li&gt;8&lt;/li&gt;            &lt;li&gt;9&lt;/li&gt;        &lt;/ul&gt;    &lt;/body&gt;    &lt;script type=&quot;text/javascript&quot;&gt;        var oUl=document.getElementById(&quot;ul-test&quot;);        var oLi=oUl.getElementsByTagName(&quot;li&quot;);        for(var i=0,len=oLi.length;i&lt;len;i++){            oLi[i].addEventListener(&quot;click&quot;,function(){                alert(this.innerHTML)            })        }    &lt;/script&gt;&lt;/html&gt;</code></pre><p>å¾ˆç®€å•ï¼Œè¿™æ ·å°±å®ç°äº†ï¼Œå®é™…ä¸Šè¿™é‡Œæœ‰å‘ï¼Œä¹Ÿå¾…ä¼˜åŒ–ï¼<br>1.forå¾ªç¯ï¼Œå¾ªç¯çš„æ˜¯liï¼Œ10ä¸ªliå°±å¾ªç¯10æ¬¡ï¼Œç»‘å®š10æ¬¡äº‹ä»¶ï¼Œ100ä¸ªå°±å¾ªç¯äº†100æ¬¡ï¼Œç»‘å®š100æ¬¡äº‹ä»¶ï¼<br>2.å¦‚æœliä¸æ˜¯æœ¬æ¥å°±åœ¨é¡µé¢ä¸Šçš„ï¼Œæ˜¯æœªæ¥å…ƒç´ ï¼Œæ˜¯é¡µé¢åŠ è½½äº†ï¼Œå†é€šè¿‡jsåŠ¨æ€åŠ è½½è¿›æ¥äº†ï¼Œä¸Šé¢çš„å†™æ³•æ˜¯æ— æ•ˆçš„ï¼Œç‚¹å‡»liæ˜¯æ²¡æœ‰ååº”çš„ï¼<br>æ‰€ä»¥å°±è€…éœ€è¦ç”¨äº‹ä»¶å§”æ‰˜ï¼ˆå³ä½¿ä¸è€ƒè™‘ä¸Šé¢çš„ç¬¬äºŒç§æƒ…å†µï¼Œä¹Ÿæ˜¯å»ºè®®ä½¿ç”¨äº‹ä»¶å§”æ‰˜ï¼‰ï¼ä»£ç å¦‚ä¸‹</p><pre><code class="javascript">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;ul id=&quot;ul-test&quot;&gt;            &lt;li&gt;0&lt;/li&gt;            &lt;li&gt;1&lt;/li&gt;            &lt;li&gt;2&lt;/li&gt;            &lt;li&gt;3&lt;/li&gt;            &lt;li&gt;4&lt;/li&gt;            &lt;li&gt;5&lt;/li&gt;            &lt;li&gt;6&lt;/li&gt;            &lt;li&gt;7&lt;/li&gt;            &lt;li&gt;8&lt;/li&gt;            &lt;li&gt;9&lt;/li&gt;        &lt;/ul&gt;    &lt;/body&gt;    &lt;script type=&quot;text/javascript&quot;&gt;        var oUl=document.getElementById(&quot;ul-test&quot;);        oUl.addEventListener(&quot;click&quot;,function(ev){            var ev=ev||window.event;            var target=ev.target||ev.srcElement;            //å¦‚æœç‚¹å‡»çš„æœ€åº•å±‚æ˜¯liå…ƒç´             if(target.tagName.toLowerCase()===&#39;li&#39;){                alert(target.innerHTML)            }        })    &lt;/script&gt;&lt;/html&gt;è¿™æ ·å†™ï¼Œå³ä½¿æ˜¯åŠ¨æ€æ·»åŠ è¿›æ¥çš„liç‚¹å‡»ä¹Ÿæœ‰ååº”ï¼Œè¿˜æœ‰ä¸€ä¸ªå°±æ˜¯ulåªæœ‰ä¸€ä¸ªï¼Œäº‹ä»¶ç»‘å®šåœ¨ulä¸Šï¼Œæ— è®ºliå¤šå°‘ä¸ªï¼Œéƒ½æ˜¯æ·»åŠ ä¸€æ¬¡äº‹ä»¶ï¼ä½†æ˜¯ä¹Ÿæ˜¯å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼Œå¦‚æœliä¸‹é¢è¿˜æœ‰å­å…ƒç´ ï¼Œé‚£ä¹ˆç‚¹å‡»çš„æ—¶å€™ï¼Œtargetå¯èƒ½ä¸æ˜¯liï¼Œè€Œæ˜¯é¼ æ ‡ç‚¹å‡»é‚£ä¸ªä½ç½®çš„æœ€åº•å±‚å…ƒç´ ï¼å¦‚ä¸‹å›¾ï¼Œå¦‚æœé¼ æ ‡ç‚¹å‡»ç™½è‰²åŒºåŸŸï¼Œé‚£ä¸ªtargetå°±æ˜¯bodyå…ƒç´ ,é¼ æ ‡ç‚¹å‡»ç»¿è‰²åŒºåŸŸtargetå°±æ˜¯divå…ƒç´ ï¼Œé¼ æ ‡ç‚¹å‡»è“è‰²åŒºåŸŸtargetå°±æ˜¯ulï¼Œç‚¹å‡»æ©™è‰²å°±æ˜¯liã€‚</code></pre><h1 id="ä½¿ç”¨å¯¹è±¡ä½œä¸ºå‡½æ•°å‚æ•°"><a href="#ä½¿ç”¨å¯¹è±¡ä½œä¸ºå‡½æ•°å‚æ•°" class="headerlink" title="ä½¿ç”¨å¯¹è±¡ä½œä¸ºå‡½æ•°å‚æ•°"></a>ä½¿ç”¨å¯¹è±¡ä½œä¸ºå‡½æ•°å‚æ•°</h1><p>å¤§å®¶è¯•æƒ³ä¸‹è¿™æ ·ä¸€ä¸ªå‡½æ•°â€“å‡½æ•°æ¥å—å‡ ä¸ªå‚æ•°ï¼Œä½†æ˜¯è¿™å‡ ä¸ªå‚æ•°éƒ½ä¸æ˜¯å¿…å¡«çš„ï¼Œå‡½æ•°è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿæ˜¯ä¸æ˜¯ä¸‹é¢è¿™æ ·</p><pre><code class="javascript">function personInfo(name,phone,card){    ...}//ä»¥ä¸Šå‡½æ•°ï¼Œå¯ä»¥ä»»æ„ä¼ å‚æ•°ã€‚æ¯”å¦‚æˆ‘æƒ³ä¼ cardç­‰äº1472586326ã€‚è¿™ä¸‹æ˜¯ä¸æ˜¯è¿™æ ·å†™personInfo(&#39;&#39;,&#39;&#39;,&#39;1472586326&#39;)</code></pre><p>æœ‰æ²¡æœ‰è§‰å¾—ä¸Šé¢å†™æ³•å¥‡æ€ªï¼Œä¸å¤ªä¼˜é›…ï¼Ÿä¸‹é¢è¿™é‡Œçœ‹ç€èˆ’æœä¸€ç‚¹ï¼</p><pre><code class="javascript">function personInfo(opt){    ...}personInfo({card:&#39;1472586326&#39;})</code></pre><p>å†æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°å¾ˆå¤šï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ</p><pre><code class="javascript">function test(arg1,arg2,arg3,arg4,arg5,arg6,arg7){    ...}</code></pre><p>å¯†é›†ææƒ§ç—‡å¤å‘æ²¡æœ‰å¤å‘ï¼Ÿä¸‹é¢è¿™æ ·çœ‹ç€ä¼šèˆ’æœä¸€ç‚¹ï¼</p><pre><code class="javascript">function personInfo(opt){    ...}</code></pre><p>æœ€åå†æƒ³ä¸€ä¸‹ï¼Œå¦‚æœéœ€æ±‚æ”¹äº†ï¼Œæ“ä½œå‡½æ•°ä¹Ÿè¦æ”¹ï¼å‡½æ•°ä¹Ÿè¦å¢åŠ ä¸€ä¸ªå‚æ•°ã€‚</p><pre><code class="javascript">//åŸæ¥å‡½æ•°function personInfo(name,phone,card){    ...}//ä¿®æ”¹åfunction personInfo(name,age,phone,card){    ...}</code></pre><p>è¿™æ ·å°±æ˜¯å‚æ•°ä¿®æ”¹ä¸€æ¬¡ï¼Œå‡½æ•°çš„å‚æ•°å°±è¦ä¿®æ”¹ä¸€æ¬¡ï¼å¦‚æœæ˜¯ç”¨å¯¹è±¡ï¼Œå°±ä¸ä¼šå‡ºç°è¿™æ ·é—®é¢˜ï¼</p><pre><code class="javascript">//ä¿®æ”¹å‰åéƒ½æ˜¯è¿™æ ·ï¼Œå˜å¾—æ˜¯å‡½æ•°çš„æ“ä½œå†…å®¹å’Œè°ƒç”¨æ—¶å€™çš„ä¼ å‚ï¼function personInfo(opt){    ...}</code></pre><p>çœ‹äº†ä¸Šé¢çš„å‡ ä¸ªæ —å­ï¼Œæ€»ç»“æ¥è¯´ï¼Œå°±æ˜¯å½“å‡½æ•°çš„å‚æ•°ä¸å›ºå®šçš„æ—¶å€™ï¼Œå‚æ•°å¤š(ä¸‰ä¸ªæˆ–è€…ä¸‰ä¸ªä»¥ä¸Š)çš„æ—¶å€™ï¼Œå»ºè®®ç”¨ä¸€ä¸ªå¯¹è±¡è®°å½•å‚æ•°ï¼Œè¿™æ ·ä¼šæ¯”è¾ƒæ–¹ä¾¿ï¼Œä¹Ÿä¸ºä»¥åå¦‚æœå‚æ•°è¦æ”¹ç•™äº†æ¡åè·¯ï¼</p><h1 id="ä½¿ç”¨pushå’Œapplyåˆå¹¶æ•°ç»„"><a href="#ä½¿ç”¨pushå’Œapplyåˆå¹¶æ•°ç»„" class="headerlink" title="ä½¿ç”¨pushå’Œapplyåˆå¹¶æ•°ç»„"></a>ä½¿ç”¨pushå’Œapplyåˆå¹¶æ•°ç»„</h1><p>åˆå¹¶æ•°ç»„è¿™ä¸ªå·²ç»æ˜¯è€ç”Ÿå¸¸è°ˆçš„è¯é¢˜äº†ï¼Œæ–¹æ³•ä¹Ÿæ˜¯å¤šç§å¤šæ ·ï¼</p><h2 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h2><pre><code class="javascript">var arr1=[1,2,3,4,5],arr2=[6,7,8,9,10];arr1=arr1.concat(arr2)console.log(arr1)//[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code></pre><p>concatä¼šä¸€ä¸ªå…¨æ–°çš„æ•°ç»„ï¼Œè¡¨ç¤ºarr1å’Œarr2ä¸¤ä¸ªæ•°ç»„çš„ç»„åˆï¼Œå¹¶è®©arr1å’Œarr2ä¸å˜ã€‚ç®€å•å§ï¼Ÿ<br>ä½†å¦‚æœarr1å’Œarr2çš„é•¿åº¦éƒ½å¾ˆé•¿ï¼Œé‚£å°±äº§ç”Ÿäº†ä¸€ä¸ªå¾ˆé•¿å¾ˆé•¿çš„æ•°ç»„ï¼Œå†…å­˜åˆè¢«å ç”¨äº†é‚£ä¹ˆå¤šã€‚ä½†æ˜¯æ•°ç»„é•¿åº¦æ²¡é™åˆ¶ï¼</p><h2 id="for"><a href="#for" class="headerlink" title="for"></a>for</h2><pre><code class="javascript">var arr1=[1,2,3,4,5],arr2=[6,7,8,9,10];for(var i=0,len=arr2.length;i&lt;len;i++){    arr1.push(arr2[i])}console.log(arr1)//[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code></pre><p>è¿™é‡Œæ˜¯å¾€arr1å¾ªç¯æ·»åŠ arr2çš„å…ƒç´ ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæƒ…å†µï¼Œarr1çš„é•¿åº¦è¿œå°äºarr2çš„é•¿åº¦ï¼Œæ˜¯ä¸æ˜¯å¾ªç¯arr1æ€§èƒ½æ›´å¥½ï¼Œå¾ªç¯æ¬¡æ•°æ›´å°‘ã€‚å¤„ç†è¿™ä¸ªå¾ˆç®€å•ï¼Œä½†æ˜¯ä¸‡ä¸€ä¸çŸ¥é“arr1å’Œarr2åˆ°åº•å“ªä¸ªé•¿åº¦æ›´å°‘å‘¢ï¼Ÿè€Œä¸”ï¼Œforå¾ªç¯ä¸å¤Ÿä¼˜é›…ï¼ï¼ˆå½“ç„¶ï¼Œè¿™ä¸ªå¯ä»¥ç”¨è¿­ä»£æ–¹æ³•æ¥æ›¿ä»£ï¼‰</p><h2 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h2><pre><code class="javascript">var arr1=[1,2,3,4,5],arr2=[6,7,8,9,10];arr1 = arr2.reduce((fcoll,item) =&gt; {     coll.push( item );     return coll; }, arr1 ); console.log(arr1)//[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code></pre><p>é€¼æ ¼é«˜äº†ä¸€ç‚¹ï¼Œè€Œä¸”ç”¨ES6çš„ç®­å¤´å‡½æ•°è¿˜å¯ä»¥å‡å°‘ä¸€äº›ä»£ç é‡ï¼Œä½†å®ƒä»ç„¶éœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå…ƒç´ éƒ½éœ€è¦è°ƒç”¨ä¸€æ¬¡ã€‚</p><h2 id="push-apply"><a href="#push-apply" class="headerlink" title="push.apply"></a>push.apply</h2><pre><code class="javascript">var arr1=[1,2,3,4,5],arr2=[6,7,8,9,10];arr1.push.apply(arr1,arr2);console.log(arr1)//[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code></pre><p>é€¼æ ¼çœ‹ç€é«˜ï¼Œä»£ç å°‘ï¼Œä¹Ÿä¸ä¼šäº§ç”Ÿæ–°çš„æ•°ç»„ï¼Œä¹Ÿä¸éš¾ç†è§£ï¼Œå°±æ˜¯è°ƒç”¨arr1.pushè¿™ä¸ªå‡½æ•°å®ä¾‹çš„applyæ–¹æ³•ï¼ŒåŒæ—¶æŠŠarr2å½“ä½œå‚æ•°ä¼ å…¥ï¼Œè¿™æ ·arr1.pushè¿™ä¸ªæ–¹æ³•å°±ä¼šéå†arr2æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ï¼Œè¾¾åˆ°åˆå¹¶çš„æ•ˆæœã€‚ç›¸å½“äºarr1.push.apply(arr1,[6,7,8,9,10]);ï¼Œæœ€åç›¸å½“äºarr1.push(6,7,8,9,10)ã€‚é—æ†¾çš„å°±æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•å¯¹æ•°ç»„é•¿åº¦æœ‰é™åˆ¶ï¼Œç½‘ä¸Šè¯´æ³•æ˜¯ä¸åŒæµè§ˆå™¨ï¼Œä¸åŒçš„é•¿åº¦é™åˆ¶ï¼Œä¸€èˆ¬ä¸è¶…è¿‡10ä¸‡ï¼</p><h1 id="toFixedä¿ç•™æ•´æ•°"><a href="#toFixedä¿ç•™æ•´æ•°" class="headerlink" title="toFixedä¿ç•™æ•´æ•°"></a>toFixedä¿ç•™æ•´æ•°</h1><p>åœ¨å¼€å‘ä¸Šï¼Œç»å¸¸ä¼šé‡åˆ°æœ€å¤šä¿ç•™å¤šå°‘ä½å°æ•°æˆ–è€…ç±»ä¼¼çš„é—®é¢˜ï¼Œé’ˆå¯¹è¿™ä¸ªï¼Œä½¿ç”¨toFixedå¯ä»¥å¾ˆç®€å•çš„è§£å†³é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæ•°æ®æ˜¯è¦å’Œåå°äº¤äº’çš„ï¼Œè€Œä¸”åå°å­˜å‚¨çš„æ•°æ®ä¸€èˆ¬æ˜¯ä¿å­˜æ•°å­—ç±»å‹ï¼Œè€Œä½¿ç”¨toFixedåç”Ÿæˆçš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸‹ï¼Œå°±éœ€è¦æŠŠtoFixedç”Ÿæˆçš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æˆæ•°å­—ç±»å‹ï¼Œè½¬å‘å¾ˆå¤šã€‚ä»Šå¤©æˆ‘è¯´ä¸€ä¸ªæœ€ç®€å•â€“+ã€‚ä»£ç å¦‚ä¸‹</p><pre><code class="javascript">var a=123.36896335.toFixed(2)console.log(a)//&#39;123.37&#39;a=+aconsole.log(a)//123.37</code></pre><p>PSï¼ša=a|0å’Œ~~aä¹Ÿå¯ä»¥å®ç°ï¼Œä½†æ˜¯ç”Ÿæˆçš„æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå¦‚ä¸‹</p><pre><code class="javascript">var a=123.36896335.toFixed(2)console.log(a)//&#39;123.37&#39;a=a|0  console.log(a)//123 //---------------------------------åˆ†å‰²çº¿var a=123.36896335.toFixed(2)console.log(a)//&#39;123.37&#39;a=~~a  console.log(a)//123   </code></pre><h1 id="å…¶å®ƒç±»å‹æ•°æ®è½¬å¸ƒå°”æ•°æ®"><a href="#å…¶å®ƒç±»å‹æ•°æ®è½¬å¸ƒå°”æ•°æ®" class="headerlink" title="å…¶å®ƒç±»å‹æ•°æ®è½¬å¸ƒå°”æ•°æ®"></a>å…¶å®ƒç±»å‹æ•°æ®è½¬å¸ƒå°”æ•°æ®</h1><p>ä¸‹é¢çš„è½¬æ¢ï¼Œå¤§å®¶ä¸€çœ‹å°±æ˜ç™½äº†ï¼Œä¸å¤šè¯´ã€‚</p><pre><code class="javascript">console.log(!!&#39;123&#39;)//true!!12//true!!-1//true!![]//true!!&#39;&#39;//false!!null//false</code></pre><h1 id="ç¼“å­˜å˜é‡"><a href="#ç¼“å­˜å˜é‡" class="headerlink" title="ç¼“å­˜å˜é‡"></a>ç¼“å­˜å˜é‡</h1><pre><code class="javascript">var arr=[1,2,3,4,5,6]for(var i=0,i&lt;arr.length;i++){    ...}//------------------------åˆ†å‰²çº¿var arr=[1,2,3,4,5,6]for(var i=0,len=arr.length;i&lt;len;i++){    ...}</code></pre><p>ç¬¬ä¸€æ®µå°±æ˜¯æ¯ä¸€æ¬¡å¾ªç¯çš„æ—¶å€™ï¼Œéƒ½è¦æŸ¥è¯¢ä¸€æ¬¡arr.lengthã€‚ç¬¬äºŒæ®µä»£ç å°±æ˜¯ç¼“å­˜äº†arr.lengthï¼Œæ¯æ¬¡å¯¹æ¯”lenå°±å¥½ï¼Œç†è®ºä¸Šæ˜¯ç¬¬äºŒæ®µä»£ç çš„å†™æ³•æ¯”è¾ƒå¥½ï¼Œæ€§èƒ½æ¯”è¾ƒé«˜ï¼ä½†æ˜¯éšç€æµè§ˆå™¨çš„å‘å±•ï¼Œè¿™ä¸ªç»†èŠ‚çš„æ€§èƒ½ä¸Šçš„å½±å“è²Œä¼¼è¿œè¿œå°äºé¢„æœŸï¼Œç°åœ¨è¿˜æ˜¯å»ºè®®ç¼“å­˜ï¼æˆ‘å†™äº†ä¸‹é¢çš„æµ‹è¯•ç”¨ä¾‹(è°·æ­Œæµè§ˆå™¨æµ‹è¯•)ï¼</p><h1 id="å…ƒç´ äº‹ä»¶"><a href="#å…ƒç´ äº‹ä»¶" class="headerlink" title="å…ƒç´ äº‹ä»¶"></a>å…ƒç´ äº‹ä»¶</h1><p>è¿™é‡Œæˆ‘ç”¨jqueryæ¥è®²è§£ï¼Œæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼ŒåŸç”Ÿjsä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼å¦‚ä¸‹ä»£ç </p><pre><code class="javascript">$(&#39;.div1&#39;).click(function(){   ...})//--------------------------åˆ†å‰²çº¿   var $div1=$(&#39;.div1&#39;);$div1.click(function(){   ...})</code></pre><p>ä¸Šé¢çš„ä»£ç ï¼Œæ”¹å˜çš„ä¹Ÿæ˜¯ç¼“å­˜äº†$(â€˜.div1â€™)ï¼Œä½†æ˜¯è¿™é‡Œå°±å»ºè®®æ˜¯ç¬¬äºŒç§å†™æ³•äº†ï¼Œå› ä¸ºç¬¬ä¸€ç§ç‚¹å‡»ä¸€æ¬¡å°±è¦æŸ¥è¯¢ä¸€æ¬¡.div1ï¼ŒDomçš„æ“ä½œè¿˜æ˜¯èƒ½å‡å°‘å°±å‡å°‘ï¼</p><h1 id="ä½¿ç”¨innerHTMLæ·»åŠ å…ƒç´ "><a href="#ä½¿ç”¨innerHTMLæ·»åŠ å…ƒç´ " class="headerlink" title="ä½¿ç”¨innerHTMLæ·»åŠ å…ƒç´ "></a>ä½¿ç”¨innerHTMLæ·»åŠ å…ƒç´ </h1><p>æ¯”å¦‚æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œå¾€ulé‡Œé¢æ·»åŠ 10ä¸ªliï¼Œä¸¤ç§æ–¹æ³•ï¼Œå¦‚ä¸‹ä»£ç </p><pre><code class="javascript">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;ul id=&quot;ul-test&quot;&gt;        &lt;/ul&gt;    &lt;/body&gt;    &lt;script type=&quot;text/javascript&quot;&gt;        var oUl=document.getElementById(&quot;ul-test&quot;);        //createElementæ–¹å¼        console.time();        for(var i=0;i&lt;10;i++){            var oLi=document.createElement(&#39;li&#39;);            oLi.innerHTML=i;            oUl.appendChild(oLi);        }        console.timeEnd();        //innerHTMLæ–¹å¼        console.time();        var _html=&#39;&#39;;        for(var i=0;i&lt;10;i++){            _html+=&#39;&lt;li&gt;&#39;+i+&#39;&lt;/li&gt;&#39;        }        oUl.innerHTML=_html;        console.timeEnd();    &lt;/script&gt;&lt;/html&gt;</code></pre><p>å¤§å®¶æŠŠä»£ç ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå‘ç°åŸºæœ¬æ˜¯ç¬¬äºŒç§æ–¹å¼æ›´å¿«ï¼Œç¬¬8ç‚¹ä¹Ÿè¯´äº†ï¼ŒDOMæ“ä½œèƒ½å°‘å°±å°‘ï¼ç¬¬ä¸€ç§è¦æ“ä½œ10æ¬¡DOMï¼Œç¬¬äºŒç§åªéœ€è¦æ“ä½œ1æ¬¡DOMã€‚è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯ï¼Œè¿™ä¸ªåªæ˜¯å¾ˆç®€å•çš„li,å¦‚æœæ˜¯ä¸‹é¢çš„åˆ—è¡¨å‘¢ï¼Ÿç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œå¾—createElementå¤šå°‘æ¬¡ï¼ŒinnerHTMLå¤šå°‘æ¬¡ï¼ŒappendChildå¤šå°‘æ¬¡ï¼Ÿä»£ç å¤šï¼Œå„ä¸ªèŠ‚ç‚¹çš„é€»è¾‘å’ŒåµŒå¥—å…³ç³»ä¹Ÿä¹±ï¼ç”¨ç¬¬äºŒç§æ–¹å¼å°±æ˜¯ä¸€ä¸ªæ‹¼æ¥å­—ç¬¦ä¸²çš„æ“ä½œï¼Œæ¯”ç¬¬ä¸€ç§æ–¹å¼å¥½å¤šäº†ï¼Œå¦‚æœç”¨es6çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå°±æ›´ç®€å•äº†ï¼</p><h1 id="å°†å‚æ•°è½¬æˆæ•°ç»„"><a href="#å°†å‚æ•°è½¬æˆæ•°ç»„" class="headerlink" title="å°†å‚æ•°è½¬æˆæ•°ç»„"></a>å°†å‚æ•°è½¬æˆæ•°ç»„</h1><p>å‡½æ•°é‡Œçš„argumentsï¼Œè™½ç„¶æ‹¥æœ‰lengthå±æ€§ï¼Œä½†æ˜¯argumentsä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ˜¯ä¸€ä¸ªç±»æ•°ç»„ï¼Œæ²¡æœ‰push,sliceç­‰æ–¹æ³•ã€‚æœ‰äº›æ—¶å€™ï¼Œéœ€è¦æŠŠargumentsè½¬æˆæ•°ç»„ï¼Œè½¬çš„æ–¹æ³•ä¹Ÿä¸æ­¢ä¸€ä¸ªï¼Œæ¨èçš„æ˜¯æ˜¯ä¸‹é¢çš„å†™æ³•ï¼</p><pre><code class="javascript">var _arguments=Array.prototype.slice.apply(arguments)</code></pre><h1 id="å‡½æ•°èŠ‚æµ"><a href="#å‡½æ•°èŠ‚æµ" class="headerlink" title="å‡½æ•°èŠ‚æµ"></a>å‡½æ•°èŠ‚æµ</h1><p>è¿™é‡Œæ‹¿ä¸€ä¸ªæ —å­è¯´ï¼Œæ¯”å¦‚mousemove,onscroll,onresizeè¿™äº›äº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼Œå¯èƒ½å·²ç»è§¦å‘äº†60æ¬¡äº‹ä»¶ï¼Œè¿™æ ·å¾ˆæ¶ˆè€—æ€§èƒ½ï¼Œè€Œä¸”å®é™…ä¸Šï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™ä¹ˆé¢‘ç¹çš„è§¦å‘ï¼Œåªè¦å¤§çº¦100æ¯«ç§’è§¦å‘ä¸€æ¬¡å°±å¥½ï¼é‚£ä¹ˆè¿™æ ·å°±éœ€è¦å‡½æ•°èŠ‚æµäº†ï¼</p><pre><code class="javascript"></code></pre><p><em>æ™®é€šå†™æ³•</em></p><pre><code class="javascript">var count = 0;function beginCount() {    count++;    console.log(count);}document.onmousemove = function () {   beginCount();};</code></pre><p><em>èŠ‚æµå†™æ³•</em></p><pre><code class="javascript">var count = 0;function beginCount() {    count++;    console.log(count);}function delayFn(method, thisArg) {    clearTimeout(method.props);    method.props = setTimeout(function () {        method.call(thisArg)    },100)}document.onmousemove = function () {    delayFn(beginCount)};</code></pre><p><em>ç¬¬äºŒç§èŠ‚æµæ–¹æ³•</em></p><pre><code class="javascript">function delayFn2 (fn, delay, mustDelay){     var timer = null;     var t_start;     return function(){         var context = this, args = arguments, t_cur = +new Date();         //å…ˆæ¸…ç†ä¸Šä¸€æ¬¡çš„è°ƒç”¨è§¦å‘ï¼ˆä¸Šä¸€æ¬¡è°ƒç”¨è§¦å‘äº‹ä»¶ä¸æ‰§è¡Œï¼‰         clearTimeout(timer);         //å¦‚æœä¸å­˜è§¦å‘æ—¶é—´ï¼Œé‚£ä¹ˆå½“å‰çš„æ—¶é—´å°±æ˜¯è§¦å‘æ—¶é—´         if(!t_start){             t_start = t_cur;         }         //å¦‚æœå½“å‰æ—¶é—´-è§¦å‘æ—¶é—´å¤§äºæœ€å¤§çš„é—´éš”æ—¶é—´ï¼ˆmustDelayï¼‰ï¼Œè§¦å‘ä¸€æ¬¡å‡½æ•°è¿è¡Œå‡½æ•°         if(t_cur - t_start &gt;= mustDelay){             fn.apply(context, args);             t_start = t_cur;         }         //å¦åˆ™å»¶è¿Ÿæ‰§è¡Œ         else {             timer = setTimeout(function(){                 fn.apply(context, args);             }, delay);         }     };}var count=0;function fn1(){    count++;    console.log(count)} //100mså†…è¿ç»­è§¦å‘çš„è°ƒç”¨ï¼Œåä¸€ä¸ªè°ƒç”¨ä¼šæŠŠå‰ä¸€ä¸ªè°ƒç”¨çš„ç­‰å¾…å¤„ç†æ‰ï¼Œä½†æ¯éš”200msè‡³å°‘æ‰§è¡Œä¸€æ¬¡document.onmousemove=delayFn2(fn1,100,200)</code></pre><p><a href="https://segmentfault.com/a/1190000011031658" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¿«åº”ç”¨å¿«é€Ÿå…¥é—¨</title>
      <link href="/2018/03/22/QuickApp/%E5%BF%AB%E5%BA%94%E7%94%A8%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
      <url>/2018/03/22/QuickApp/%E5%BF%AB%E5%BA%94%E7%94%A8%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="QuickApp"><a href="#QuickApp" class="headerlink" title="QuickApp"></a>QuickApp</h1><p>ä½œä¸ºä¸€ä¸ªå‰ç«¯å·¥ç¨‹å¸ˆï¼Œæ¯•ç«Ÿè¦é¡ºæµæŠ€æœ¯çš„å‘å±•ã€‚</p><p>3æœˆ20æ—¥ï¼Œå°ç±³ã€ä¸­å…´ã€åä¸ºã€é‡‘ç«‹ã€è”æƒ³ã€é­…æ—ã€åŠªæ¯”äºšã€OPPOã€vivoã€ä¸€åŠ ï¼Œå…±åå®¶æ‰‹æœºå‚å•†åœ¨åŒ—äº¬è”åˆå¬å¼€å¿«åº”ç”¨æ ‡å‡†å¯åŠ¨å‘å¸ƒä¼šï¼Œæ‰‹æœºå‚å•†ä¸ä¸­å›½ä¿¡æ¯é€šä¿¡ç ”ç©¶é™¢ã€ç”µä¿¡ç»ˆç«¯äº§ä¸šåä¼šã€ä¸­å›½è½¯ä»¶è¡Œä¸šåä¼šåŠæ•°ç™¾å®¶çŸ¥åç§»åŠ¨äº’è”ç½‘åº”ç”¨ä¼ä¸šå…±è¥„ç››ä¸¾ï¼Œå…±åŒè§è¯ç§»åŠ¨åº”ç”¨æ–°ç”Ÿæ€çš„åˆ°æ¥ã€‚</p><p>æ—¢ç„¶æ˜¯å›½å†…å‚å•†å‘å¸ƒçš„ï¼Œæ‰€ä»¥åªé’ˆå¯¹å®‰å“ç”¨æˆ·ã€‚</p><p>æ€ä¹ˆæ„Ÿè§‰éƒ½æ˜¯åœ¨å¯¹å¾®ä¿¡å°ç¨‹åºä¸€å®¶ç‹¬å¤§çš„åº”å¯¹ã€‚</p><p>åºŸè¯å°‘è¯´å¼€æ’¸å§ã€‚</p><p><em>å¿«åº”ç”¨å¼€å‘è€…æ–‡æ¡£</em> <a href="https://doc.quickapp.cn/" target="_blank" rel="noopener">https://doc.quickapp.cn/</a>   çœ‹äº†è¿™ä¸ªå°±æ˜¯è¡¨ç¤ºå…¥é—¨äº†</p><p><em>å¿«åº”ç”¨å¼€å‘è€…è®ºå›</em> <a href="http://bbs.quickapp.cn/" target="_blank" rel="noopener">http://bbs.quickapp.cn/</a></p><h2 id="æ­å»ºç¯å¢ƒ"><a href="#æ­å»ºç¯å¢ƒ" class="headerlink" title="æ­å»ºç¯å¢ƒ"></a>æ­å»ºç¯å¢ƒ</h2><h3 id="å®‰è£…nodejs"><a href="#å®‰è£…nodejs" class="headerlink" title="å®‰è£…nodejs"></a>å®‰è£…nodejs</h3><p>éœ€å®‰è£…<font color = "red">6.0ä»¥ä¸Šç‰ˆæœ¬</font>çš„nodejsï¼Œè¯·ä»NodeJSå®˜ç½‘ä¸‹è½½ï¼Œ<font color = "red">æ¨èv6.11.3 LTS</font></p><p><strong>æ³¨æ„: ä¸è¦ä½¿ç”¨8.0.*ç‰ˆæœ¬ï¼è¿™ä¸ªç‰ˆæœ¬å†…éƒ¨ZipStreamå®ç°ä¸node-archiveåŒ…ä¸å…¼å®¹ï¼Œä¼šå¼•èµ·æŠ¥é”™</strong></p><h3 id="å®‰è£…hap-toolkit-å¿«åº”ç”¨å‘½ä»¤"><a href="#å®‰è£…hap-toolkit-å¿«åº”ç”¨å‘½ä»¤" class="headerlink" title="å®‰è£…hap-toolkit (å¿«åº”ç”¨å‘½ä»¤)"></a>å®‰è£…hap-toolkit (å¿«åº”ç”¨å‘½ä»¤)</h3><pre><code class="javascript">npm install - g hap-toolkit</code></pre><a id="more"></a><p>åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œhap -Vä¼šè¾“å‡ºç‰ˆæœ¬ä¿¡æ¯è¡¨ç¤ºhap-toolkitå®‰è£…æˆåŠŸï¼Œå¦‚ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š</p><pre><code class="javascript">hap -V</code></pre><p>ç›®å‰ç‰ˆæœ¬æ˜¯0.0.26</p><h2 id="åˆ›å»ºæ–°çš„é¡¹ç›®"><a href="#åˆ›å»ºæ–°çš„é¡¹ç›®" class="headerlink" title="åˆ›å»ºæ–°çš„é¡¹ç›®"></a>åˆ›å»ºæ–°çš„é¡¹ç›®</h2><pre><code class="javascript">hap init &lt;ProjectName&gt;</code></pre><p>æˆåŠŸåå³æ˜¾ç¤ºé¡¹ç›®ç›®å½•ç»“æ„</p><pre><code class="html">â”œâ”€â”€ node_modules              npm åŒ…â”œâ”€â”€ sign                      rpkåŒ…ç­¾åæ¨¡å—â”‚   â””â”€â”€ debug                 è°ƒè¯•ç¯å¢ƒâ”‚       â”œâ”€â”€ certificate.pem   è¯ä¹¦æ–‡ä»¶â”‚       â””â”€â”€ private.pem       ç§é’¥æ–‡ä»¶â”œâ”€â”€ src                       é¡¹ç›®èµ„æºæ–‡ä»¶å¤¹â”‚   â”œâ”€â”€ Common                å…¬ç”¨çš„èµ„æºæ–‡ä»¶å’Œç»„ä»¶æ–‡ä»¶â”‚   â”‚   â””â”€â”€ logo.png          manifest.jsonä¸­é…ç½®çš„iconâ”‚   â”œâ”€â”€ Demo                  é¡µé¢ç›®å½•â”‚   |   â””â”€â”€ index.ux          é¡µé¢æ–‡ä»¶ï¼Œæ–‡ä»¶åä¸å¿…ä¸çˆ¶æ–‡ä»¶å¤¹ç›¸åŒâ”‚   â”œâ”€â”€ app.ux                APPæ–‡ä»¶ï¼ˆç”¨äºåŒ…æ‹¬å…¬ç”¨èµ„æºï¼‰â”‚   â””â”€â”€ manifest.json         é¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆå¦‚ï¼šåº”ç”¨æè¿°ã€æ¥å£ç”³æ˜ã€é¡µé¢è·¯ç”±ç­‰ï¼‰â””â”€â”€ package.json              å®šä¹‰é¡¹ç›®éœ€è¦çš„å„ç§æ¨¡å—åŠé…ç½®ä¿¡æ¯ï¼Œnpm installæ ¹æ®è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œè‡ªåŠ¨ä¸‹è½½æ‰€éœ€çš„è¿è¡Œå’Œå¼€å‘ç¯å¢ƒ</code></pre><h2 id="ç¼–è¯‘é¡¹ç›®"><a href="#ç¼–è¯‘é¡¹ç›®" class="headerlink" title="ç¼–è¯‘é¡¹ç›®"></a>ç¼–è¯‘é¡¹ç›®</h2><p>1.åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…ä¾èµ–åŒ…ï¼ˆwebpackï¼Œbabelç­‰ï¼‰</p><pre><code class="javascript">npm install</code></pre><ol start="2"><li>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œç¼–è¯‘æ‰“åŒ…ï¼Œç”ŸæˆrpkåŒ…<pre><code class="javascript">npm run build</code></pre></li></ol><blockquote><p>ç¼–è¯‘æ‰“åŒ…æˆåŠŸåï¼Œé¡¹ç›®æ ¹ç›®å½•ä¸‹ä¼šç”Ÿæˆæ–‡ä»¶å¤¹ï¼šbuildã€dist</p></blockquote><blockquote><ul><li>buildï¼šä¸´æ—¶äº§å‡ºï¼ŒåŒ…å«ç¼–è¯‘åçš„é¡µé¢jsï¼Œå›¾ç‰‡ç­‰</li><li>distï¼šæœ€ç»ˆäº§å‡ºï¼ŒåŒ…å«rpkæ–‡ä»¶ã€‚å…¶å®æ˜¯å°†buildç›®å½•ä¸‹çš„èµ„æºæ‰“åŒ…å‹ç¼©ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œåç¼€åä¸ºrpkï¼Œè¿™ä¸ªrpkæ–‡ä»¶å°±æ˜¯é¡¹ç›®ç¼–è¯‘åçš„æœ€ç»ˆäº§å‡º</li></ul></blockquote><p>3.è‡ªåŠ¨é‡æ–°ç¼–è¯‘</p><pre><code class="javascript">npm run watch</code></pre><font color = "red">æ³¨æ„ï¼šnpm run watchåè¿˜éœ€è¦å¦å¤–è¿è¡Œnpm run serveræ¥è¿è¡Œserveræ‰èƒ½å®ç°çƒ­æ›´æ–°</font><font color = "red"><br><strong>æ³¨æ„</strong>ï¼š<br><br>å¦‚æœæŠ¥é”™é‡åˆ°Cannot find module â€˜â€¦/webpack.config.jsâ€™ï¼Œè¯·é‡æ–°æ‰§è¡Œä¸€æ¬¡hap update â€“forceã€‚è¿™æ˜¯ç”±äºé«˜ç‰ˆæœ¬çš„npmåœ¨npm installæ—¶ï¼Œä¼šæ ¡éªŒå¹¶åˆ é™¤äº†node_modulesä¸‹éƒ¨åˆ†æ–‡ä»¶å¤¹ï¼Œå¯¼è‡´æŠ¥é”™ã€‚è€Œhap update â€“forceä¼šé‡æ–°å¤åˆ¶hap-toolkitæ–‡ä»¶å¤¹åˆ°node_modulesä¸­</font><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>éœ€è¦å®‰è£…ä¸¤ä¸ªAPPåº”ç”¨ç¨‹åº(å¿…é¡»ï¼éœ€è¦åœ¨çœŸæœºä¸Šè°ƒè¯•é¢„è§ˆ)</p><p><a href="https://statres.quickapp.cn/quickapp/quickapp/201803/file/201803200129552999556.apk" target="_blank" rel="noopener">å¿«åº”ç”¨è°ƒè¯•å™¨</a><br><a href="https://statres.quickapp.cn/quickapp/quickapp/201803/file/201803200130021102030.apk" target="_blank" rel="noopener">å¹³å°é¢„è§ˆç‰ˆ</a></p><h3 id="äºŒç»´ç é¢„è§ˆ"><a href="#äºŒç»´ç é¢„è§ˆ" class="headerlink" title="äºŒç»´ç é¢„è§ˆ"></a>äºŒç»´ç é¢„è§ˆ</h3><p>åœ¨ç»ˆç«¯è¾“å…¥,å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨</p><pre><code class="javascript">npm run server</code></pre><p>è‡ªå®šä¹‰ç«¯å£ï¼ˆå¦‚ï¼š8080ï¼‰</p><pre><code class="javascript">npm run server -- --port 8080</code></pre><p>åœ¨è°ƒè¯•å™¨APPé€‰æ‹©æ‰«æäºŒç»´ç ï¼›</p><p>å¦‚æœæç¤ºå®‰è£…å¤±è´¥ï¼Œå»ºè®®é‡æ–°èµ·ä¸€énpm run server é‡æ–°æ¥è¿‡ã€‚</p><h2 id="æœ¬åœ°å®‰è£…"><a href="#æœ¬åœ°å®‰è£…" class="headerlink" title="æœ¬åœ°å®‰è£…"></a>æœ¬åœ°å®‰è£…</h2><p>é€‰æ‹©distç›®å½•ä¸‹çš„.rpkæ–‡ä»¶ä¼ è¾“åˆ°æ‰‹æœº åœ¨è°ƒè¯•å™¨ä¸­é€‰æ‹©æ‰‹åŠ¨å®‰è£…æ‰¾åˆ°ä½ çš„.rpkå³å¯å®‰è£…<br>å‡ºç°äº†è¿™ä¸ªï¼Œä»£è¡¨ä½ å®‰è£…æˆåŠŸï¼Œè¿™å°±æ˜¯Demoæ•ˆæœ<br><img src="https://doc.quickapp.cn/tutorial/getting-started/hello-world.2.png" alt="qck"></p><p>åº”ç”¨ä¸Šä¼ æµç¨‹ <a href="http://bbs.quickapp.cn/posts/detail?id=249" target="_blank" rel="noopener">http://bbs.quickapp.cn/posts/detail?id=249</a></p><p>è´¦å·æ³¨å†Œæµç¨‹ <a href="http://bbs.quickapp.cn/posts/detail?id=248" target="_blank" rel="noopener">http://bbs.quickapp.cn/posts/detail?id=248</a></p>]]></content>
      
      
      <categories>
          
          <category> quickApp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> quickApp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ©ä½ ç†è§£Reacté«˜é˜¶ç»„ä»¶</title>
      <link href="/2018/03/21/React/%E5%8A%A9%E4%BD%A0%E7%90%86%E8%A7%A3React%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/"/>
      <url>/2018/03/21/React/%E5%8A%A9%E4%BD%A0%E7%90%86%E8%A7%A3React%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="é«˜é˜¶ç»„ä»¶"><a href="#é«˜é˜¶ç»„ä»¶" class="headerlink" title="é«˜é˜¶ç»„ä»¶"></a>é«˜é˜¶ç»„ä»¶</h1><p>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯reactä¸­å¯¹ç»„ä»¶é€»è¾‘è¿›è¡Œé‡ç”¨çš„é«˜çº§æŠ€æœ¯ã€‚ä½†é«˜é˜¶ç»„ä»¶æœ¬èº«å¹¶ä¸æ˜¯React APIã€‚å®ƒåªæ˜¯ä¸€ç§æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯ç”±reactè‡ªèº«çš„ç»„åˆæ€§è´¨å¿…ç„¶äº§ç”Ÿçš„ã€‚</p><p>å…·ä½“è€Œè¨€ï¼Œ<strong>é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶</strong></p><p>é«˜é˜¶ç»„ä»¶åœ¨Reactç¬¬ä¸‰æ–¹åº“ä¸­å¾ˆå¸¸è§ï¼Œæ¯”å¦‚Reduxçš„<a href="https://github.com/reactjs/react-redux/blob/master/docs/api.md#connectmapstatetoprops-mapdispatchtoprops-mergeprops-options" target="_blank" rel="noopener">connect</a>æ–¹æ³•å’ŒRelayçš„<a href="">createContainer</a>.</p><h2 id="ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰è§£å†³äº¤å‰é—®é¢˜"><a href="#ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰è§£å†³äº¤å‰é—®é¢˜" class="headerlink" title="ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰è§£å†³äº¤å‰é—®é¢˜"></a>ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰è§£å†³äº¤å‰é—®é¢˜</h2><h2 id="ä¸è¦æ”¹å˜åŸå§‹ç»„ä»¶ï¼Œä½¿ç”¨ç»„åˆ"><a href="#ä¸è¦æ”¹å˜åŸå§‹ç»„ä»¶ï¼Œä½¿ç”¨ç»„åˆ" class="headerlink" title="ä¸è¦æ”¹å˜åŸå§‹ç»„ä»¶ï¼Œä½¿ç”¨ç»„åˆ"></a>ä¸è¦æ”¹å˜åŸå§‹ç»„ä»¶ï¼Œä½¿ç”¨ç»„åˆ</h2><h2 id="çº¦å®šï¼šå°†ä¸ç›¸å…³çš„propså±æ€§ä¼ é€’ç»™åŒ…è£¹ç»„ä»¶"><a href="#çº¦å®šï¼šå°†ä¸ç›¸å…³çš„propså±æ€§ä¼ é€’ç»™åŒ…è£¹ç»„ä»¶" class="headerlink" title="çº¦å®šï¼šå°†ä¸ç›¸å…³çš„propså±æ€§ä¼ é€’ç»™åŒ…è£¹ç»„ä»¶"></a>çº¦å®šï¼šå°†ä¸ç›¸å…³çš„propså±æ€§ä¼ é€’ç»™åŒ…è£¹ç»„ä»¶</h2><h2 id="çº¦å®šï¼šæœ€å¤§åŒ–ä½¿ç”¨ç»„åˆ"><a href="#çº¦å®šï¼šæœ€å¤§åŒ–ä½¿ç”¨ç»„åˆ" class="headerlink" title="çº¦å®šï¼šæœ€å¤§åŒ–ä½¿ç”¨ç»„åˆ"></a>çº¦å®šï¼šæœ€å¤§åŒ–ä½¿ç”¨ç»„åˆ</h2><h2 id="çº¦å®šï¼šåŒ…è£…æ˜¾ç¤ºåå­—ä»¥ä¾¿äºè°ƒè¯•"><a href="#çº¦å®šï¼šåŒ…è£…æ˜¾ç¤ºåå­—ä»¥ä¾¿äºè°ƒè¯•" class="headerlink" title="çº¦å®šï¼šåŒ…è£…æ˜¾ç¤ºåå­—ä»¥ä¾¿äºè°ƒè¯•"></a>çº¦å®šï¼šåŒ…è£…æ˜¾ç¤ºåå­—ä»¥ä¾¿äºè°ƒè¯•</h2><a id="more"></a><h1 id="å‡½æ•°æ¨¡æ‹Ÿé«˜é˜¶ç»„ä»¶"><a href="#å‡½æ•°æ¨¡æ‹Ÿé«˜é˜¶ç»„ä»¶" class="headerlink" title="å‡½æ•°æ¨¡æ‹Ÿé«˜é˜¶ç»„ä»¶"></a>å‡½æ•°æ¨¡æ‹Ÿé«˜é˜¶ç»„ä»¶</h1><p>æˆ‘ä»¬é€šè¿‡æ™®é€šå‡½æ•°æ¥ç†è§£ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶å“¦~</p><p>1.æœ€æ™®é€šçš„æ–¹æ³•ï¼Œä¸€ä¸ªwelcomeï¼Œä¸€ä¸ªgoodbyeã€‚ä¸¤ä¸ªå‡½æ•°å…ˆä»localStorageè¯»å–äº†usernameï¼Œç„¶åå¯¹usernameåšäº†ä¸€äº›å¤„ç†ã€‚</p><pre><code class="javascript">    function welcome(){        let username = localStorage.getItem(&#39;username&#39;);        console.log(&#39;welcome &#39; + username);    }    function goodbey() {    let username = localStorage.getItem(&#39;username&#39;);    console.log(&#39;goodbey &#39; + username);    }    welcome();    goodbey();</code></pre><p>2.æˆ‘ä»¬å‘ç°ä¸¤ä¸ªå‡½æ•°æœ‰ä¸€å¥ä»£ç æ˜¯ä¸€æ ·çš„ï¼Œè¿™å«å†—ä½™å”‰ã€‚ä¸å¥½ä¸å¥½~ï¼ˆä½ å¯ä»¥æŠŠé‚£ä¸€å¥ä»£ç ç†è§£æˆå¹³æ—¶çš„ä¸€å¤§å †ä»£ç ï¼‰</p><p>æˆ‘ä»¬è¦å†™ä¸€ä¸ªä¸­é—´å‡½æ•°ï¼Œè¯»å–username,ä»–æ¥è´Ÿè´£æŠŠusernameä¼ é€’ç»™ä¸¤ä¸ªå‡½æ•°ã€‚</p><pre><code class="javascript">function welcome(username) {    console.log(&#39;welcome &#39; + username);}function goodbey(username) {    console.log(&#39;goodbey &#39; + username);}function wrapWithUsername(wrappedFunc) {    let newFunc = () =&gt; {        let username = localStorage.getItem(&#39;username&#39;);        wrappedFunc(username);    };    return newFunc;}welcome = wrapWithUsername(welcome);goodbey = wrapWithUsername(goodbey);welcome();goodbey();</code></pre><p>å¥½äº†ï¼Œæˆ‘ä»¬é‡Œé¢çš„wrapWithUsernameå‡½æ•°å°±æ˜¯ä¸€ä¸ªâ€œé«˜é˜¶å‡½æ•°â€ã€‚<br>ä»–åšäº†ä»€ä¹ˆï¼Ÿä»–å¸®æˆ‘ä»¬å¤„ç†äº†usernameï¼Œä¼ é€’ç»™ç›®æ ‡å‡½æ•°ã€‚æˆ‘ä»¬è°ƒç”¨æœ€ç»ˆçš„å‡½æ•°welcomeçš„æ—¶å€™ï¼Œæ ¹æœ¬ä¸ç”¨å…³å¿ƒusernameæ˜¯æ€ä¹ˆæ¥çš„ã€‚<br>æˆ‘ä»¬å¢åŠ ä¸ªç”¨æˆ·studyå‡½æ•°ã€‚</p><pre><code class="javascript"> function study(username){     console.log(&#39;study&#39; + username); } study = wrapWithUsername(study);study();</code></pre><p>è¿™é‡Œä½ æ˜¯ä¸æ˜¯ç†è§£äº†ä¸ºä»€ä¹ˆè¯´wrapWithUsernameæ˜¯é«˜é˜¶å‡½æ•°ï¼Ÿæˆ‘ä»¬åªéœ€è¦çŸ¥é“ï¼Œç”¨wrapWithUsernameåŒ…è£…æˆ‘ä»¬çš„studyå‡½æ•°åï¼Œstudyå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯usernameã€‚</p><p>æˆ‘ä»¬å†™å¹³æ—¶å†™ä»£ç çš„æ—¶å€™ï¼Œä¸ç”¨å…³å¿ƒwrapWithUsernameå†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><h1 id="é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„çº¯å‡½æ•°ã€‚"><a href="#é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„çº¯å‡½æ•°ã€‚" class="headerlink" title="é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„çº¯å‡½æ•°ã€‚"></a>é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„çº¯å‡½æ•°ã€‚</h1><p>æˆ‘ä»¬æŠŠä¸Šä¸€èŠ‚çš„å‡½æ•°ç»Ÿç»Ÿæ”¹æˆreactç»„ä»¶ã€‚</p><p>æœ€æ™®é€šçš„ç»„ä»¶å“¦ã€‚<br>welcomeå‡½æ•°è½¬ä¸ºreactç»„ä»¶ã€‚</p><pre><code class="javascript">import React, {Component} from &#39;react&#39;class Welcome extends Component {    constructor(props) {        super(props);        this.state = {            username: &#39;&#39;        }    }    componentWillMount() {        let username = localStorage.getItem(&#39;username&#39;);        this.setState({            username: username        })    }    render() {        return (            &lt;div&gt;welcome {this.state.username}&lt;/div&gt;        )    }}export default Welcome;</code></pre><p>2.goodbeyå‡½æ•°è½¬ä¸ºreactç»„ä»¶ã€‚</p><pre><code class="javascript">import React, {Component} from &#39;react&#39;class Goodbye extends Component {    constructor(props) {        super(props);        this.state = {            username: &#39;&#39;        }    }    componentWillMount() {        let username = localStorage.getItem(&#39;username&#39;);        this.setState({            username: username        })    }    render() {        return (            &lt;div&gt;goodbye {this.state.username}&lt;/div&gt;        )    }}export default Goodbye;</code></pre><p>3.ç°åœ¨ä½ æ˜¯ä¸æ˜¯æ›´èƒ½çœ‹åˆ°é—®é¢˜æ‰€åœ¨äº†ï¼Ÿä¸¤ä¸ªç»„ä»¶å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯é‡å¤çš„å”‰ã€‚<br>æŒ‰ç…§ä¸Šä¸€èŠ‚wrapWithUsernameå‡½æ•°çš„æ€è·¯ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸ªé«˜é˜¶ç»„ä»¶(é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶)ã€‚</p><pre><code class="javascript">import React, {Component} from &#39;react&#39;export default (WrappedComponent) =&gt; {    class NewComponent extends Component {        constructor() {            super();            this.state = {                username: &#39;&#39;            }        }        componentWillMount() {            let username = localStorage.getItem(&#39;username&#39;);            this.setState({                username: username            })        }        render() {            return &lt;WrappedComponent username={this.state.username}/&gt;        }    }    return NewComponent}</code></pre><p>è¿™æ ·æˆ‘ä»¬å°±èƒ½ç®€åŒ–Welcomeç»„ä»¶å’ŒGoodbyeç»„ä»¶ã€‚</p><pre><code class="javascript">//welcomeimport React, {Component} from &#39;react&#39;;import wrapWithUsername from &#39;wrapWithUsername&#39;;class Welcome extends Component {    render() {        return (            &lt;div&gt;welcome {this.props.username}&lt;/div&gt;        )    }}Welcome = wrapWithUsername(Welcome);export default Welcome;//goodbyeimport React, {Component} from &#39;react&#39;;import wrapWithUsername from &#39;wrapWithUsername&#39;;class Goodbye extends Component {    render() {        return (            &lt;div&gt;goodbye {this.props.username}&lt;/div&gt;        )    }}Goodbye = wrapWithUsername(Goodbye);export default Goodbye;</code></pre><p>çœ‹åˆ°æ²¡æœ‰ï¼Œé«˜é˜¶ç»„ä»¶å°±æ˜¯æŠŠusernameé€šè¿‡propsä¼ é€’ç»™ç›®æ ‡ç»„ä»¶äº†ã€‚ç›®æ ‡ç»„ä»¶åªç®¡ä»propsé‡Œé¢æ‹¿æ¥ç”¨å°±å¥½äº†ã€‚</p><p>åˆ°è¿™é‡Œä½ç½®ï¼Œé«˜é˜¶ç»„ä»¶å°±è®²å®Œäº†ã€‚ä½ å†è¿”å›å»ç†è§£ä¸‹å®šä¹‰ï¼Œæ˜¯ä¸æ˜¯è±ç„¶å¼€æœ—</p><blockquote><p>ä½ ç°åœ¨ç†è§£react-reduxçš„<em>connectå‡½æ•°</em>~<br>æŠŠreduxçš„stateå’Œactionåˆ›å»ºå‡½æ•°ï¼Œé€šè¿‡propsæ³¨å…¥ç»™äº†Componentã€‚<br>ä½ åœ¨ç›®æ ‡ç»„ä»¶Componenté‡Œé¢å¯ä»¥ç›´æ¥ç”¨this.propså»è°ƒç”¨redux stateå’Œactionåˆ›å»ºå‡½æ•°äº†ã€‚</p></blockquote><pre><code class="javascript">ConnectedComment = connect(mapStateToProps, mapDispatchToProps)(Component);</code></pre><p>ç›¸å½“äºè¿™æ ·</p><pre><code class="javascript">// connectæ˜¯ä¸€ä¸ªè¿”å›å‡½æ•°çš„å‡½æ•°ï¼ˆå°±æ˜¯ä¸ªé«˜é˜¶å‡½æ•°ï¼‰const enhance = connect(mapStateToProps, mapDispatchToProps);// è¿”å›çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œè¯¥é«˜é˜¶ç»„ä»¶è¿”å›ä¸€ä¸ªä¸Redux store// å…³è”èµ·æ¥çš„æ–°ç»„ä»¶const ConnectedComment = enhance(Component);</code></pre><p>antdçš„Formä¹Ÿæ˜¯ä¸€æ ·çš„</p><p>const WrappedNormalLoginForm = Form.create()(NormalLoginForm);</p><h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><h2 id="ä¸è¦å†renderå‡½æ•°ä¸­ä½¿ç”¨é«˜é˜¶ç»„ä»¶"><a href="#ä¸è¦å†renderå‡½æ•°ä¸­ä½¿ç”¨é«˜é˜¶ç»„ä»¶" class="headerlink" title="ä¸è¦å†renderå‡½æ•°ä¸­ä½¿ç”¨é«˜é˜¶ç»„ä»¶"></a>ä¸è¦å†renderå‡½æ•°ä¸­ä½¿ç”¨é«˜é˜¶ç»„ä»¶</h2><p>Reactä½¿ç”¨çš„å·®å¼‚ç®—æ³•ï¼ˆç§°ä¸ºåè°ƒï¼‰ä½¿ç”¨ç»„ä»¶æ ‡è¯†ç¡®å®šæ˜¯å¦æ›´æ–°ç°æœ‰çš„å­å¯¹è±¡æ ‘æˆ–ä¸¢æ‰ç°æœ‰çš„å­æ ‘å¹¶é‡æ–°æŒ‚è½½ã€‚å¦‚æœrenderå‡½æ•°è¿”å›çš„ç»„ä»¶å’Œä¹‹å‰renderå‡½æ•°è¿”å›çš„ç»„ä»¶æ˜¯ç›¸åŒçš„ï¼ŒReactå°±é€’å½’çš„æ¯”è¾ƒæ–°å­å¯¹è±¡æ ‘å’Œæ—§å­å¯¹è±¡æ ‘çš„å·®å¼‚ï¼Œå¹¶æ›´æ–°æ—§å­å¯¹è±¡æ ‘ã€‚å¦‚æœä»–ä»¬ä¸ç›¸ç­‰ï¼Œå°±ä¼šå®Œå…¨å¸è½½æ‰æ—§çš„ä¹‹å¯¹è±¡æ ‘ã€‚</p><h2 id="å¿…é¡»å°†é™æ€æ–¹æ³•åšæ‹·è´"><a href="#å¿…é¡»å°†é™æ€æ–¹æ³•åšæ‹·è´" class="headerlink" title="å¿…é¡»å°†é™æ€æ–¹æ³•åšæ‹·è´"></a>å¿…é¡»å°†é™æ€æ–¹æ³•åšæ‹·è´</h2><p>æœ‰æ—¶ï¼Œç»™ç»„ä»¶å®šä¹‰é™æ€æ–¹æ³•æ˜¯ååˆ†æœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼ŒRelayçš„å®¹å™¨å°±å¼€æ”¾äº†ä¸€ä¸ªé™æ€æ–¹æ³• getFragmentä¾¿äºç»„åˆGraphQLçš„ä»£ç ç‰‡æ®µã€‚</p><h2 id="Refså±æ€§ä¸èƒ½ä¼ é€’"><a href="#Refså±æ€§ä¸èƒ½ä¼ é€’" class="headerlink" title="Refså±æ€§ä¸èƒ½ä¼ é€’"></a>Refså±æ€§ä¸èƒ½ä¼ é€’</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œé«˜é˜¶ç»„ä»¶å¯ä»¥ä¼ é€’æ‰€æœ‰çš„propså±æ€§ç»™åŒ…è£¹çš„ç»„ä»¶ï¼Œä½†æ˜¯ä¸èƒ½ä¼ é€’refså¼•ç”¨ã€‚å› ä¸ºå¹¶ä¸æ˜¯åƒkeyä¸€æ ·ï¼Œrefsæ˜¯ä¸€ä¸ªä¼ªå±æ€§ï¼ŒReactå¯¹å®ƒè¿›è¡Œäº†ç‰¹æ®Šå¤„ç†ã€‚å¦‚æœä½ å‘ä¸€ä¸ªç”±é«˜é˜¶ç»„ä»¶åˆ›å»ºçš„ç»„ä»¶çš„å…ƒç´ æ·»åŠ refåº”ç”¨ï¼Œé‚£ä¹ˆrefæŒ‡å‘çš„æ˜¯æœ€å¤–å±‚å®¹å™¨ç»„ä»¶å®ä¾‹çš„ï¼Œè€Œä¸æ˜¯åŒ…è£¹ç»„ä»¶ã€‚</p><p><a href="https://github.com/brickspert/blog/issues/2" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯æ·±æµ·</title>
      <link href="/2018/03/20/Record/%E5%89%8D%E7%AB%AF%E6%B7%B1%E6%B5%B7/"/>
      <url>/2018/03/20/Record/%E5%89%8D%E7%AB%AF%E6%B7%B1%E6%B5%B7/</url>
      
        <content type="html"><![CDATA[<p>å‰ç«¯å·¥ç¨‹å¸ˆæ‰€éœ€çŸ¥è¯†</p><p><img src="https://sfault-image.b0.upaiyun.com/411/177/4111773335-57bfe7844eda6_articlex" alt="FT"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Record </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Reactçš„Diffç®—æ³•</title>
      <link href="/2018/03/20/React/React%E7%9A%84Diff%E7%AE%97%E6%B3%95/"/>
      <url>/2018/03/20/React/React%E7%9A%84Diff%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p><strong>React</strong> æ˜¯ Facebook å¼€å‘çš„æ„å»ºç”¨æˆ·ç•Œé¢çš„ç±»åº“.<br>å®ƒä»è®¾è®¡ä¹‹åˆå°±å°†æ€§èƒ½ä½œä¸ºé‡ç‚¹.<br>è¿™ç¯‡æ–‡ç« æˆ‘å±•ç¤º diff ç®—æ³•å’Œæ¸²æŸ“è¿‡ç¨‹æ€æ ·å·¥ä½œ, ä½ å¯ä»¥å€Ÿé‰´ä¼˜åŒ–è‡ªå·±çš„åº”ç”¨.</p><h1 id="Diff-ç®—æ³•"><a href="#Diff-ç®—æ³•" class="headerlink" title="Diff ç®—æ³•"></a>Diff ç®—æ³•</h1><p>åœ¨æ·±å…¥å®ç°çš„ç»†èŠ‚ä¹‹å‰, éœ€è¦äº†è§£ä¸€ä¸‹ React æ€æ ·å·¥ä½œçš„.</p><pre><code class="javascript">class MyComponent extends React.Component{    render() {        if (this.props.first) {            return &lt;div className=&quot;first&quot;&gt;&lt;span&gt;A Span&lt;/span&gt;&lt;/div&gt;;            } else {            return &lt;div className=&quot;second&quot;&gt;&lt;p&gt;A Paragraph&lt;/p&gt;&lt;/div&gt;;            }        }}</code></pre><p>ä»»ä½•æ—¶é—´, ä½ æè¿°çš„æ˜¯ä½ çš„ UI çœ‹èµ·æ¥æ˜¯ä»€ä¹ˆæ ·å­.<br>éœ€è¦ç‰¹åˆ«æ³¨æ„, render æ‰§è¡Œçš„ç»“æœå¾—åˆ°çš„ä¸æ˜¯çœŸæ­£çš„ DOM èŠ‚ç‚¹.<br>ç»“æœä»…ä»…æ˜¯è½»é‡çº§çš„ JavaScript å¯¹è±¡, æˆ‘ä»¬ç§°ä¹‹ä¸º <font color = 'blue'>virtual DOM</font>.</p><p>React è¦ä»è¿™ä¸ªè¡¨ç°å½¢å¼å½“ä¸­å°è¯•æ‰¾åˆ°å‰ä¸€ä¸ªæ¸²æŸ“ç»“æœåˆ°åä¸€ä¸ªçš„æœ€å°æ­¥æ•°.<br>æ¯”å¦‚, å½“æˆ‘ä»¬æŒ‚è½½äº† <font color = "red"> <MyComponent first={true} /> </font><br>, ç„¶åç”¨ <font color = "red"><MyComponent first={false} /></font> æ›¿æ¢, ç„¶ååˆå–æ¶ˆæŒ‚è½½,<br>è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹çš„ DOM çš„æŒ‡ä»¤æ˜¯è¿™æ ·çš„:</p><blockquote><p>ä»æ²¡æœ‰åˆ°ç¬¬ä¸€æ­¥<br>åˆ›å»ºèŠ‚ç‚¹: <div className="first"><span>A Span</span></div></p></blockquote><blockquote><p>ç¬¬ä¸€æ­¥åˆ°ç¬¬äºŒæ­¥<br>æ›¿æ¢å±æ€§: className=â€firstâ€ åˆ° className=â€secondâ€<br>æ›¿æ¢èŠ‚ç‚¹: <span>A Span</span> åˆ° <p>A Paragraph</p></p></blockquote><blockquote><p>ç¬¬äºŒæ­¥åˆ°æ²¡æœ‰<br>åˆ é™¤èŠ‚ç‚¹: <div className="second"><p>A Paragraph</p></div><br><a id="more"></a></p></blockquote><h2 id="æŒ‰ç…§å±‚çº§"><a href="#æŒ‰ç…§å±‚çº§" class="headerlink" title="æŒ‰ç…§å±‚çº§"></a>æŒ‰ç…§å±‚çº§</h2><p>æ‰¾åˆ°ä¸¤æ£µä»»æ„çš„æ ‘ä¹‹é—´æœ€å°çš„ä¿®æ”¹æ˜¯ä¸€ä¸ªå¤æ‚åº¦ä¸º O(n^3) çš„é—®é¢˜.<br>ä½ å¯ä»¥æƒ³è±¡, æˆ‘ä»¬çš„ä¾‹å­é‡Œè¿™ä¸æ˜¯å®¹æ˜“å¤„ç†çš„.<br>React ç”¨äº†ä¸€ç§ç®€å•ä½†æ˜¯å¼ºå¤§çš„æŠ€å·§, è¾¾åˆ°äº†æ¥è¿‘ O(n) çš„å¤æ‚åº¦.</p><p>React ä»…ä»…æ˜¯å°è¯•æŠŠæ ‘æŒ‰ç…§å±‚çº§åˆ†è§£. è¿™å½»åº•ç®€åŒ–äº†å¤æ‚åº¦,<br>è€Œä¸”ä¹Ÿä¸ä¼šå¤±å»å¾ˆå¤š, å› ä¸º Web åº”ç”¨å¾ˆå°‘æœ‰ component ç§»åŠ¨åˆ°æ ‘çš„å¦ä¸€ä¸ªå±‚çº§å».<br>å®ƒä»¬å¤§éƒ¨åˆ†åªæ˜¯åœ¨ç›¸é‚»çš„å­èŠ‚ç‚¹ä¹‹é—´ç§»åŠ¨.</p><p><img src="https://segmentfault.com/img/remote/1460000004844002" alt="diff1"></p><h2 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h2><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸ª component, ä¸€ä¸ªå¾ªç¯æ¸²æŸ“äº† 5 ä¸ª component,<br>éšååˆåœ¨åˆ—è¡¨ä¸­é—´æ’å…¥ä¸€ä¸ªæ–°çš„ component.<br>åªçŸ¥é“è¿™äº›ä¿¡æ¯, è¦å¼„æ¸…ä¸¤ä¸ª component çš„åˆ—è¡¨æ€ä¹ˆå¯¹åº”å¾ˆéš¾.</p><p>é»˜è®¤æƒ…å†µä¸‹, React ä¼šå°†å‰ä¸€ä¸ªåˆ—è¡¨ç¬¬ä¸€ä¸ª component å’Œåä¸€ä¸ªç¬¬ä¸€ä¸ªå…³è”èµ·æ¥, åé¢ä¹Ÿæ˜¯.<br>ä½ å¯ä»¥å†™ä¸€ä¸ª key å±æ€§å¸®åŠ© React æ¥å¤„ç†å®ƒä»¬ä¹‹é—´çš„å¯¹åº”å…³ç³».<br>å®é™…ä¸­, åœ¨å­å…ƒç´ ä¸­æ‰¾åˆ°å”¯ä¸€çš„ <font color = "red">key</font> é€šå¸¸å¾ˆå®¹æ˜“.</p><p><img src="https://segmentfault.com/img/remote/1460000004844003" alt="diff2"></p><h2 id="Components"><a href="#Components" class="headerlink" title="Components"></a>Components</h2><p>React app é€šå¸¸ç”±ç”¨æˆ·å®šä¹‰çš„ component ç»„åˆè€Œæˆ,<br>é€šå¸¸ç»“æœæ˜¯ä¸€ä¸ªä¸»è¦æ˜¯å¾ˆå¤š div ç»„æˆçš„æ ‘.<br>è¿™ä¸ªä¿¡æ¯ä¹Ÿè¢« React çš„ diff ç®—æ³•è€ƒè™‘è¿›å», React åªä¼šåŒ¹é…ç›¸åŒ class çš„ component.</p><p>æ¯”å¦‚, å¦‚æœæœ‰ä¸ª <Header> è¢« <ExampleBlock> æ›¿æ¢æ‰äº†,<br>React ä¼šåˆ é™¤æ‰ header å†åˆ›å»ºä¸€ä¸ª example block.<br>æˆ‘ä»¬ä¸éœ€è¦åŒ–å®è´µçš„æ—¶é—´å»åŒ¹é…ä¸¤ä¸ªä¸å¤§å¯èƒ½æœ‰ç›¸ä¼¼ä¹‹å¤„çš„ component.</p><p><img src="https://segmentfault.com/img/remote/1460000004844005" alt="diff3"></p><h1 id="äº‹ä»¶ä»£ç†"><a href="#äº‹ä»¶ä»£ç†" class="headerlink" title="äº‹ä»¶ä»£ç†"></a>äº‹ä»¶ä»£ç†</h1><p>å¾€ DOM èŠ‚ç‚¹ä¸Šç»‘äº‹ä»¶æ…¢å¾—äººå¿ƒç¢å•Š, è€Œä¸”å¾ˆè´¹å†…å­˜.</p><p>ä½œä¸ºæ›¿ä»£, React éƒ¨ç½²äº†ç§æµè¡ŒæŠ€æœ¯, å«åšâ€<font color = "red">äº‹ä»¶ä»£ç†</font>â€œ.<br>React èµ°å¾—æ›´è¿œ, é‡æ–°å®ç°äº†ä¸€éç¬¦åˆ W3C è§„èŒƒçš„äº‹ä»¶ç³»ç»Ÿ.<br>æ„å‘³ç€ IE8 äº‹ä»¶å¤„ç†çš„ bug æˆä¸ºè¿‡å»äº†, æ‰€æœ‰äº‹ä»¶åç§°è·¨æµè§ˆå™¨ä¿æŒä¸€è‡´.</p><p>è¿™é‡Œè§£é‡Šä¸€ä¸‹æ€ä¹ˆå®ç°çš„. </p><blockquote><p>äº‹ä»¶ listener è¢«ç»‘å®šåˆ°æ•´ä¸ªæ–‡æ¡£çš„æ ¹èŠ‚ç‚¹ä¸Š.<br>å½“äº‹ä»¶è¢«è§¦å‘, æµè§ˆå™¨ä¼šç»™å‡ºä¸€ä¸ªè§¦å‘çš„ç›®æ ‡çš„ DOM èŠ‚ç‚¹.<br>ä¸ºäº†åœ¨ DOM çš„å±‚çº§ä¼ æ’­äº‹ä»¶, React ä¸ä¼šè¿­ä»£ virtual DOM çš„å±‚çº§.<br>è€Œæ˜¯, æˆ‘ä»¬ä¾é æ¯ä¸ª React component å„è‡ªç‹¬ç«‹çš„ id æ¥ç¼–ç è¿™ä¸ªå±‚çº§.<br>æˆ‘ä»¬èƒ½é€šè¿‡ç®€å•çš„å­—ç¬¦ä¸²æ“ä½œæ¥è·å–æ‰€æœ‰çˆ¶çº§ component çš„çˆ¶çº§å†…å®¹.<br>æŠŠäº‹ä»¶ listener å­˜å‚¨åœ¨ hash map å½“ä¸­, æˆ‘ä»¬å‘ç°æ€§èƒ½æ¯”æ”¾åˆ° virtual DOM è¿˜è¦å¥½.</p></blockquote><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†, å½“ä¸€ä¸ªäº‹ä»¶å¹¿æ’­åˆ°æ•´ä¸ª virtual DOM æ—¶å‘ç”Ÿä»€ä¹ˆ.</p><pre><code class="javascript">// dispatchEvent(&#39;click&#39;, &#39;a.b.c&#39;, event)clickCaptureListeners[&#39;a&#39;](event);clickCaptureListeners[&#39;a.b&#39;](event);clickCaptureListeners[&#39;a.b.c&#39;](event);clickBubbleListeners[&#39;a.b.c&#39;](event);clickBubbleListeners[&#39;a.b&#39;](event);clickBubbleListeners[&#39;a&#39;](event);</code></pre><p>æµè§ˆå™¨ä¸ºæ¯ä¸ªäº‹ä»¶å’Œæ¯ä¸ª listener åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶å¯¹è±¡.<br>è¿™ä¸ªäº‹ä»¶å¯¹è±¡çš„å±æ€§å¾ˆä¸é”™, ä½ èƒ½è·å–åˆ°äº‹ä»¶çš„å¼•ç”¨, ç”šè‡³ä¿®æ”¹æ‰.<br>ç„¶è€Œè¿™ä¹Ÿæ„å‘³ç€é«˜é¢çš„å†…å­˜åˆ†é….<br>React åœ¨å¯åŠ¨æ—¶å°±ä¸ºé‚£äº›å¯¹è±¡åˆ†é…äº†ä¸€ä¸ªå†…å­˜æ± .<br>ä»»ä½•æ—¶å€™éœ€è¦ç”¨åˆ°äº‹ä»¶å¯¹è±¡, å°±å¯ä»¥ä»è¿™ä¸ªå†…å­˜æ± è¿›è¡Œå¤ç”¨.<br>è¿™ä¸€ç‚¹éå¸¸æ˜¾è‘—åœ°å‡è½»äº†åƒåœ¾å›æ”¶çš„è´Ÿæ‹….</p><h1 id="æ¸²æŸ“"><a href="#æ¸²æŸ“" class="headerlink" title="æ¸²æŸ“"></a>æ¸²æŸ“</h1><h2 id="åˆå¹¶æ“ä½œ"><a href="#åˆå¹¶æ“ä½œ" class="headerlink" title="åˆå¹¶æ“ä½œ"></a>åˆå¹¶æ“ä½œ</h2><p>ä½ è°ƒç”¨ component çš„ <font color = "red">setState</font> æ–¹æ³•çš„æ—¶å€™, React å°†å…¶æ ‡è®°ä¸º dirty.<br>åˆ°æ¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ç»“æŸ, React æ£€æŸ¥æ‰€æœ‰æ ‡è®° dirty çš„ component é‡æ–°ç»˜åˆ¶.</p><p>è¿™é‡Œçš„â€åˆå¹¶æ“ä½œâ€æ˜¯è¯´, åœ¨ä¸€ä¸ªäº‹ä»¶å¾ªç¯å½“ä¸­, DOM åªä¼šè¢«æ›´æ–°ä¸€æ¬¡.<br>è¿™ä¸ªç‰¹æ€§æ˜¯æ„å»ºé«˜æ€§èƒ½åº”ç”¨çš„å…³é”®, è€Œä¸”ç”¨é€šå¸¸çš„ JavaScript ä»£ç éš¾ä»¥å®ç°.<br>è€Œåœ¨ React åº”ç”¨é‡Œ, ä½ é»˜è®¤å°±èƒ½å®ç°.</p><p><img src="https://segmentfault.com/img/remote/1460000004851132" alt="diff4"></p><h2 id="å­æ ‘æ¸²æŸ“æ“ä½œ"><a href="#å­æ ‘æ¸²æŸ“æ“ä½œ" class="headerlink" title="å­æ ‘æ¸²æŸ“æ“ä½œ"></a>å­æ ‘æ¸²æŸ“æ“ä½œ</h2><p>è°ƒç”¨ <font color = "red">setState</font> æ–¹æ³•æ—¶, component ä¼šé‡æ–°æ„å»ºåŒ…æ‹¬å­èŠ‚ç‚¹çš„ virtual DOM.<br>å¦‚æœä½ åœ¨æ ¹èŠ‚ç‚¹è°ƒç”¨ <font color = "red">setState</font>, æ•´ä¸ª React çš„åº”ç”¨éƒ½ä¼šè¢«é‡æ–°æ¸²æŸ“.</p><p>æ‰€æœ‰çš„ component, å³ä¾¿æ²¡æœ‰æ›´æ–°, éƒ½ä¼šè°ƒç”¨ä»–ä»¬çš„ <strong>render</strong> æ–¹æ³•.<br>è¿™ä¸ªå¬èµ·æ¥å¯æ€•, æ€§èƒ½åƒæ˜¯å¾ˆä½, ä½†å®é™…ä¸Šæˆ‘ä»¬ä¸ä¼šè§¦ç¢°çœŸå®çš„ DOM, è¿è¡Œèµ·æ¥æ²¡é‚£æ ·çš„é—®é¢˜.</p><p>é¦–å…ˆ, æˆ‘ä»¬è®¨è®ºçš„æ˜¯å±•ç¤ºç”¨æˆ·ç•Œé¢. å› ä¸ºå±å¹•ç©ºé—´æœ‰é™, é€šå¸¸ä½ éœ€è¦ä¸€æ¬¡æ¸²æŸ“æˆç™¾ä¸Šåƒæ¡æŒ‡ä»¤.<br>JavaScript å¯¹äºèƒ½å¤„ç†çš„æ•´ä¸ªç•Œé¢, åœ¨ä¸šåŠ¡é€»è¾‘ä¸Šå·²ç»è¶³å¤Ÿå¿«äº†.</p><p>å¦ä¸€ç‚¹, åœ¨å†™ React ä»£ç æ—¶, æ¯å½“æœ‰æ•°æ®æ›´æ–°, ä½ ä¸æ˜¯éƒ½è°ƒç”¨æ ¹èŠ‚ç‚¹çš„ setState.<br>ä½ ä¼šåœ¨éœ€è¦æ¥æ”¶å¯¹åº”æ›´æ–°çš„ component ä¸Šè°ƒç”¨, æˆ–è€…åœ¨ä¸Šé¢çš„å‡ ä¸ª component.<br>ä½ å¾ˆå°‘è¦ä¸€ç›´åˆ°æ ¹èŠ‚ç‚¹ä¸Š. å°±æ˜¯è¯´ç•Œé¢æ›´æ–°åªå‡ºç°åœ¨ç”¨æˆ·äº§ç”Ÿäº¤äº’çš„å±€éƒ¨.</p><p><img src="https://segmentfault.com/img/remote/1460000004851134" alt="diff5"></p><h2 id="é€‰æ‹©æ€§å­æ ‘æ¸²æŸ“"><a href="#é€‰æ‹©æ€§å­æ ‘æ¸²æŸ“" class="headerlink" title="é€‰æ‹©æ€§å­æ ‘æ¸²æŸ“"></a>é€‰æ‹©æ€§å­æ ‘æ¸²æŸ“</h2><p>æœ€å, ä½ è¿˜æœ‰å¯èƒ½å»æ‰ä¸€äº›å­æ ‘çš„é‡æ–°æ¸²æŸ“.<br>å¦‚æœä½ åœ¨ component ä¸Šå®ç°ä»¥ä¸‹æ–¹æ³•çš„è¯:</p><pre><code class="javascript">boolean shouldComponentUpdate(object nextProps, object nextState)</code></pre><p>æ ¹æ® component çš„å‰ä¸€ä¸ªå’Œä¸‹ä¸€ä¸ª <font color = "red">props/state</font>,<br>ä½ å¯ä»¥å‘Šè¯‰ React è¿™ä¸ª component æ²¡æœ‰æ›´æ–°, ä¹Ÿä¸éœ€è¦é‡æ–°ç»˜åˆ¶.<br>å®ç°å¾—å¥½çš„è¯, å¯ä»¥å¸¦æ¥å·¨å¤§çš„æ€§èƒ½æå‡.</p><p>è¦ç”¨è¿™ä¸ªæ–¹æ³•, ä½ è¦èƒ½å¤Ÿå¯¹ JavaScript Object è¿›è¡Œæ¯”å¯¹.<br>è¿™ä»¶æœ‰å¾ˆå¤šç»†èŠ‚çš„å› ç´ , æ¯”å¦‚å¯¹æ¯”åº”è¯¥æ˜¯æ·±åº¦çš„è¿˜æ˜¯æµ…å±‚çš„,<br>å¦‚æœè¦æ·±çš„, æˆ‘ä»¬æ˜¯ç”¨ä¸å¯å˜æ•°æ®ç»“æ„, è¿˜æ˜¯è¿›è¡Œæ·±åº¦æ‹·è´â€¦</p><p>è€Œä¸”ä½ è¦æ³¨æ„, è¿™ä¸ªå‡½æ•°æ¯æ¬¡éƒ½ä¼šè¢«è°ƒç”¨, æ‰€ä»¥ä½ è¦ç¡®ä¿è¿è¡Œèµ·æ¥èŠ±çš„æ—¶é—´æ›´å°‘,<br>æ¯” React çš„åšæ³•æ—¶é—´å°‘, è¿˜æœ‰æ¯”è®¡ç®— component éœ€è¦çš„æ—¶é—´å°‘,<br>å³ä¾¿é‡æ–°ç»˜åˆ¶å¹¶ä¸æ˜¯å¿…è¦çš„.</p><p><img src="https://segmentfault.com/img/remote/1460000004851138" alt="diff6"></p><h1 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h1><p>å¸®åŠ© React å˜å¿«çš„æŠ€æœ¯å¹¶ä¸æ–°é¢–. é•¿ä¹…ä»¥æ¥, æˆ‘ä»¬åˆ°çŸ¥é“è§¦ç¢° DOM æ˜¯è´¹æ—¶çš„,<br>ä½ åº”è¯¥åˆå¹¶å¤„ç†è¯»å’Œå†™çš„æ“ä½œ, äº‹ä»¶ä»£ç†ä¼šæ›´å¿«â€¦</p><p>äººä»¬è¿˜æ˜¯ä¼šç»å¸¸è®¨è®ºä»–ä»¬, å› ä¸ºåœ¨å®é™…å½“ä¸­ç”¨ JavaScript è¿›è¡Œå®ç°å¾ˆæ˜¯æŒºéš¾çš„.<br>React çªå‡ºçš„ä¸€ä¸ªåŸå› æ˜¯è¿™äº›ä¼˜åŒ–é»˜è®¤å°±å¯åŠ¨äº†.<br>è¿™å°±è®©ä½ é¿å…æ‰ä¸å°å¿ƒæŠŠ app å†™å¾—å¾ˆæ…¢.</p><p>React æ¶ˆè€—æ€§èƒ½çš„æ¨¡å‹å¾ˆç®€å•, å¾ˆå¥½ç†è§£: æ¯æ¬¡è°ƒç”¨ setState ä¼šé‡æ–°è®¡ç®—æ•´ä¸ªå­æ ‘.<br>å¦‚æœä½ æƒ³è¦æé«˜æ€§èƒ½, å°½é‡å°‘è°ƒç”¨ setState,<br>è¿˜æœ‰ç”¨ shouldComponentUpdate å‡å°‘å¤§çš„å­æ ‘çš„é‡æ–°è®¡ç®—.</p><p>reactçš„ä¸€å¤§ç‰¹ç‚¹å°±æ˜¯è™šæ‹ŸDOMçš„diffç®—æ³•ï¼Œä¸‹å›¾ä¸ºdiffå®ç°æµç¨‹å›¾ã€‚<br><img src="https://segmentfault.com/img/bVuHXW" alt="diff7"><br>ä¼ ç»Ÿç®—æ³•çš„ç†è§£ç”»çš„æµç¨‹å›¾<br><img src="https://segmentfault.com/img/bVuGgm" alt="diff8"><br>React é€šè¿‡åˆ¶å®šå¤§èƒ†çš„ç­–ç•¥ï¼Œå°† O(n^3) å¤æ‚åº¦çš„é—®é¢˜è½¬æ¢æˆ O(n) å¤æ‚åº¦çš„é—®é¢˜ã€‚<br><img src="https://segmentfault.com/img/bVuH57" alt="diff9"></p><p>æ›´å¤šå…³äºReactæºç é“¾æ¥<br><a href="http://purplebamboo.github.io/2015/09/15/reactjs_source_analyze_part_one/" target="_blank" rel="noopener">reactæºç åˆ†æ</a><br><a href="https://zhuanlan.zhihu.com/p/20346379?refer=purerender" target="_blank" rel="noopener">reactæºç å‰–æï¼ˆè¿™ç¯‡æ–‡ç« å¯¹å›¾ä¸­ç§»ä½ç®—æ³•æœ‰è¯¦ç»†è§£é‡Šï¼‰</a><br><a href="https://grfia.dlsi.ua.es/ml/algorithms/references/editsurvey_bille.pdf" target="_blank" rel="noopener">è®ºæ–‡ç®—æ³•è¯¦è§£</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Html5</title>
      <link href="/2018/03/19/HTML5/Html5/"/>
      <url>/2018/03/19/HTML5/Html5/</url>
      
        <content type="html"><![CDATA[<h1 id="html5ç‰¹æ€§"><a href="#html5ç‰¹æ€§" class="headerlink" title="html5ç‰¹æ€§"></a>html5ç‰¹æ€§</h1><h2 id="ç”¨äºåª’ä»‹å›æ”¾çš„-video-å’Œ-audio-å…ƒç´ "><a href="#ç”¨äºåª’ä»‹å›æ”¾çš„-video-å’Œ-audio-å…ƒç´ " class="headerlink" title="ç”¨äºåª’ä»‹å›æ”¾çš„ video å’Œ audio å…ƒç´ "></a>ç”¨äºåª’ä»‹å›æ”¾çš„ video å’Œ audio å…ƒç´ </h2><h3 id="Video"><a href="#Video" class="headerlink" title="Video"></a>Video</h3><h4 id="æ”¯æŒçš„è§†é¢‘æ ¼å¼"><a href="#æ”¯æŒçš„è§†é¢‘æ ¼å¼" class="headerlink" title="æ”¯æŒçš„è§†é¢‘æ ¼å¼"></a>æ”¯æŒçš„è§†é¢‘æ ¼å¼</h4><p>Ogg = å¸¦æœ‰ Theora è§†é¢‘ç¼–ç å’Œ Vorbis éŸ³é¢‘ç¼–ç çš„ Ogg æ–‡ä»¶ï¼ˆ.oggï¼‰</p><p>MPEG4 = å¸¦æœ‰ H.264 è§†é¢‘ç¼–ç å’Œ AAC éŸ³é¢‘ç¼–ç çš„ MPEG 4 æ–‡ä»¶(.mp4)</p><p>WebM = å¸¦æœ‰ VP8 è§†é¢‘ç¼–ç å’Œ Vorbis éŸ³é¢‘ç¼–ç çš„ WebM æ–‡ä»¶(.mkv)</p><pre><code class="html">&lt;video src=&quot;movie.ogg&quot; controls=&quot;controls&quot;&gt;&lt;/video&gt;</code></pre><p><strong>controls</strong> å±æ€§ä¾›æ·»åŠ æ’­æ”¾ã€æš‚åœå’ŒéŸ³é‡æ§ä»¶ã€‚</p><p>åŒ…å«å®½åº¦å’Œé«˜åº¦å±æ€§ä¹Ÿæ˜¯ä¸é”™çš„ä¸»æ„ã€‚<br>å¦‚æœæœ‰ä¸æ”¯æŒvideoçš„æµè§ˆå™¨å™¨åˆ™ä½¿ç”¨ä¸‹é¢ä»£ç </p><pre><code class="html">&lt;video src=&quot;movie.ogg&quot; width=&quot;320&quot; height=&quot;240&quot; controls=&quot;controls&quot;&gt;Your browser does not support the video tag.&lt;/video&gt;</code></pre><p>video å…ƒç´ å…è®¸å¤šä¸ª source å…ƒç´ ã€‚source å…ƒç´ å¯ä»¥é“¾æ¥ä¸åŒçš„è§†é¢‘æ–‡ä»¶ã€‚æµè§ˆå™¨å°†ä½¿ç”¨ç¬¬ä¸€ä¸ªå¯è¯†åˆ«çš„æ ¼å¼ï¼š</p><pre><code class="html">&lt;video width=&quot;320&quot; height=&quot;240&quot; controls=&quot;controls&quot;&gt;  &lt;source src=&quot;movie.ogg&quot; type=&quot;video/ogg&quot;&gt;  &lt;source src=&quot;movie.mp4&quot; type=&quot;video/mp4&quot;&gt;  Your browser does not support the video tag.&lt;/video&gt;</code></pre><p>IE8ä¸æ”¯æŒvideoå…ƒç´ ï¼Œåœ¨ IE 9 ä¸­ï¼Œå°†æä¾›å¯¹ä½¿ç”¨ MPEG4 çš„ video å…ƒç´ çš„æ”¯æŒã€‚</p><h4 id="videoæ ‡ç­¾å±æ€§ï¼š"><a href="#videoæ ‡ç­¾å±æ€§ï¼š" class="headerlink" title="videoæ ‡ç­¾å±æ€§ï¼š"></a>videoæ ‡ç­¾å±æ€§ï¼š</h4><p>autoplay è‡ªåŠ¨æ’­æ”¾<br>controls æ˜¾ç¤ºæ§ä»¶<br>width è®¾ç½®æ’­æ”¾å™¨çš„å®½åº¦<br>height è®¾ç½®æ’­æ”¾å™¨é«˜åº¦<br>loop  å¦‚æœè®¾ç½®ä¸ºTrueåˆ™å¾ªç¯æ’­æ”¾<br>preload å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™è§†é¢‘åœ¨é¡µé¢åŠ è½½æ—¶è¿›è¡ŒåŠ è½½ï¼Œå¹¶é¢„å¤‡æ’­æ”¾ã€‚å¦‚æœä½¿ç”¨ â€œautoplayâ€ï¼Œåˆ™å¿½ç•¥è¯¥å±æ€§ã€‚<br>src è¦æ’­æ”¾çš„è§†é¢‘çš„ URL</p><h4 id="videoæ–¹æ³•ï¼Œå±æ€§åŠäº‹ä»¶ï¼š"><a href="#videoæ–¹æ³•ï¼Œå±æ€§åŠäº‹ä»¶ï¼š" class="headerlink" title="videoæ–¹æ³•ï¼Œå±æ€§åŠäº‹ä»¶ï¼š"></a>videoæ–¹æ³•ï¼Œå±æ€§åŠäº‹ä»¶ï¼š</h4><p>paly() è§†é¢‘æ’­æ”¾<br>pasue() è§†é¢‘æš‚åœ<br>load()  è§†é¢‘åŠ è½½</p><h3 id="audio"><a href="#audio" class="headerlink" title="audio"></a>audio</h3><h4 id="audioæ”¯æŒçš„éŸ³é¢‘æ ¼å¼"><a href="#audioæ”¯æŒçš„éŸ³é¢‘æ ¼å¼" class="headerlink" title="audioæ”¯æŒçš„éŸ³é¢‘æ ¼å¼"></a>audioæ”¯æŒçš„éŸ³é¢‘æ ¼å¼</h4><p>Ogg Vorbis ï¼ˆ.oggï¼‰<br>Mp3 (.mp3)<br>Wav (.wav)</p><h4 id="audioæ ‡ç­¾çš„å±æ€§"><a href="#audioæ ‡ç­¾çš„å±æ€§" class="headerlink" title="audioæ ‡ç­¾çš„å±æ€§"></a>audioæ ‡ç­¾çš„å±æ€§</h4><p>autoplay è‡ªåŠ¨æ’­æ”¾<br>controls éŸ³é¢‘æ§ä»¶<br>loop å¾ªç¯æ’­æ”¾<br>preload å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™è§†é¢‘åœ¨é¡µé¢åŠ è½½æ—¶è¿›è¡ŒåŠ è½½ï¼Œå¹¶é¢„å¤‡æ’­æ”¾ã€‚å¦‚æœä½¿ç”¨ â€œautoplayâ€ï¼Œåˆ™å¿½ç•¥è¯¥å±æ€§ã€‚<br>src è¦æ’­æ”¾çš„éŸ³é¢‘çš„ URL</p><h2 id="html5æ‹–æ”¾ï¼ˆdragå’Œdrop"><a href="#html5æ‹–æ”¾ï¼ˆdragå’Œdrop" class="headerlink" title="html5æ‹–æ”¾ï¼ˆdragå’Œdrop)"></a>html5æ‹–æ”¾ï¼ˆdragå’Œdrop)</h2><a id="more"></a><h3 id="æµè§ˆå™¨æ”¯æŒ"><a href="#æµè§ˆå™¨æ”¯æŒ" class="headerlink" title="æµè§ˆå™¨æ”¯æŒ"></a>æµè§ˆå™¨æ”¯æŒ</h3><p>Internet Explorer 9ã€Firefoxã€Opera 12ã€Chrome ä»¥åŠ Safari 5 æ”¯æŒæ‹–æ”¾ã€‚</p><p>æ³¨é‡Šï¼šåœ¨ Safari 5.1.2 ä¸­ä¸æ”¯æŒæ‹–æ”¾ã€‚</p><p>ä¸€ä¸ªç®€å•åœ°ä¾‹å­</p><pre><code class="html">&lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;head&gt;&lt;script type=&quot;text/javascript&quot;&gt;function allowDrop(ev){    ev.preventDefault();}function drag(ev){    ev.dataTransfer.setData(&quot;Text&quot;,ev.target.id);}function drop(ev){    ev.preventDefault();    var data=ev.dataTransfer.getData(&quot;Text&quot;);    ev.target.appendChild(document.getElementById(data));}&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id=&quot;div1&quot; ondrop=&quot;drop(event)&quot;ondragover=&quot;allowDrop(event)&quot;&gt;&lt;/div&gt;&lt;img id=&quot;drag1&quot; src=&quot;img_logo.gif&quot; draggable=&quot;true&quot;ondragstart=&quot;drag(event)&quot; width=&quot;336&quot; height=&quot;69&quot; /&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h3 id="è®¾ç½®å…ƒç´ ä¸ºå¯æ‹–æ”¾"><a href="#è®¾ç½®å…ƒç´ ä¸ºå¯æ‹–æ”¾" class="headerlink" title="è®¾ç½®å…ƒç´ ä¸ºå¯æ‹–æ”¾"></a>è®¾ç½®å…ƒç´ ä¸ºå¯æ‹–æ”¾</h3><p>é¦–å…ˆï¼Œä¸ºäº†ä½¿å…ƒç´ å¯æ‹–åŠ¨ï¼ŒæŠŠ draggable å±æ€§è®¾ç½®ä¸º true ï¼š</p><pre><code class="html">&lt;img draggable=&quot;true&quot; /&gt;</code></pre><h3 id="æ‹–åŠ¨ä»€ä¹ˆ-ondragstart-å’Œ-setData"><a href="#æ‹–åŠ¨ä»€ä¹ˆ-ondragstart-å’Œ-setData" class="headerlink" title="æ‹–åŠ¨ä»€ä¹ˆ - ondragstart å’Œ setData()"></a>æ‹–åŠ¨ä»€ä¹ˆ - ondragstart å’Œ setData()</h3><p>ç„¶åï¼Œè§„å®šå½“å…ƒç´ è¢«æ‹–åŠ¨æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚<br>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œondragstart å±æ€§è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œdrag(event)ï¼Œå®ƒè§„å®šäº†è¢«æ‹–åŠ¨çš„æ•°æ®ã€‚<br>dataTransfer.setData() æ–¹æ³•è®¾ç½®è¢«æ‹–æ•°æ®çš„æ•°æ®ç±»å‹å’Œå€¼ï¼š</p><pre><code class="js">function drag(ev){    ev.dataTransfer.setData(&quot;Text&quot;,ev.target.id);}</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•°æ®ç±»å‹æ˜¯ â€œTextâ€ï¼Œå€¼æ˜¯å¯æ‹–åŠ¨å…ƒç´ çš„ id (â€œdrag1â€)ã€‚</p><h3 id="æ”¾åˆ°ä½•å¤„-ondragover"><a href="#æ”¾åˆ°ä½•å¤„-ondragover" class="headerlink" title="æ”¾åˆ°ä½•å¤„ - ondragover"></a>æ”¾åˆ°ä½•å¤„ - ondragover</h3><p>ondragover äº‹ä»¶è§„å®šåœ¨ä½•å¤„æ”¾ç½®è¢«æ‹–åŠ¨çš„æ•°æ®ã€‚</p><p>é»˜è®¤åœ°ï¼Œæ— æ³•å°†æ•°æ®/å…ƒç´ æ”¾ç½®åˆ°å…¶ä»–å…ƒç´ ä¸­ã€‚å¦‚æœéœ€è¦è®¾ç½®å…è®¸æ”¾ç½®ï¼Œæˆ‘ä»¬å¿…é¡»é˜»æ­¢å¯¹å…ƒç´ çš„é»˜è®¤å¤„ç†æ–¹å¼ã€‚</p><p>è¿™è¦é€šè¿‡è°ƒç”¨ ondragover äº‹ä»¶çš„ event.preventDefault() æ–¹æ³•ï¼š</p><pre><code class="js">event.preventDefault()</code></pre><h3 id="è¿›è¡Œæ”¾ç½®-ondrop"><a href="#è¿›è¡Œæ”¾ç½®-ondrop" class="headerlink" title="è¿›è¡Œæ”¾ç½® - ondrop"></a>è¿›è¡Œæ”¾ç½® - ondrop</h3><p>å½“æ”¾ç½®è¢«æ‹–æ•°æ®æ—¶ï¼Œä¼šå‘ç”Ÿ drop äº‹ä»¶ã€‚</p><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œondrop å±æ€§è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œdrop(event)ï¼š</p><p>function drop(ev)<br>{<br>ev.preventDefault();<br>var data=ev.dataTransfer.getData(â€œTextâ€);<br>ev.target.appendChild(document.getElementById(data));<br>}</p><blockquote><p>ä»£ç è§£é‡Šï¼š<br>1.è°ƒç”¨ preventDefault() æ¥é¿å…æµè§ˆå™¨å¯¹æ•°æ®çš„é»˜è®¤å¤„ç†ï¼ˆdrop äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºæ˜¯ä»¥é“¾æ¥å½¢å¼æ‰“å¼€ï¼‰<br>2.é€šè¿‡ dataTransfer.getData(â€œTextâ€) æ–¹æ³•è·å¾—è¢«æ‹–çš„æ•°æ®ã€‚è¯¥æ–¹æ³•å°†è¿”å›åœ¨ setData() æ–¹æ³•ä¸­è®¾ç½®ä¸ºç›¸åŒç±»å‹çš„ä»»ä½•æ•°æ®ã€‚<br>3.è¢«æ‹–æ•°æ®æ˜¯è¢«æ‹–å…ƒç´ çš„ id (â€œdrag1â€)<br>4.æŠŠè¢«æ‹–å…ƒç´ è¿½åŠ åˆ°æ”¾ç½®å…ƒç´ ï¼ˆç›®æ ‡å…ƒç´ ï¼‰ä¸­</p></blockquote><h2 id="Canvas-ç”»å¸ƒ"><a href="#Canvas-ç”»å¸ƒ" class="headerlink" title="Canvas(ç”»å¸ƒ)"></a>Canvas(ç”»å¸ƒ)</h2><h3 id="ä»€ä¹ˆæ˜¯-Canvasï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Canvasï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Canvasï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Canvasï¼Ÿ</h3><p>HTML5 çš„ canvas å…ƒç´ ä½¿ç”¨ JavaScript åœ¨ç½‘é¡µä¸Šç»˜åˆ¶å›¾åƒã€‚</p><p>ç”»å¸ƒæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œæ‚¨å¯ä»¥æ§åˆ¶å…¶æ¯ä¸€åƒç´ ã€‚<br>canvas æ‹¥æœ‰å¤šç§ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒçš„æ–¹æ³•ã€‚</p><h3 id="åˆ›å»º-Canvas-å…ƒç´ "><a href="#åˆ›å»º-Canvas-å…ƒç´ " class="headerlink" title="åˆ›å»º Canvas å…ƒç´ "></a>åˆ›å»º Canvas å…ƒç´ </h3><p>å‘ HTML5 é¡µé¢æ·»åŠ  canvas å…ƒç´ ã€‚</p><p>è§„å®šå…ƒç´ çš„ idã€å®½åº¦å’Œé«˜åº¦ï¼š</p><pre><code class="html">&lt;canvas id=&quot;myCanvas&quot; width=&quot;200&quot; height=&quot;100&quot;&gt;&lt;/canvas&gt;</code></pre><h3 id="é€šè¿‡-JavaScript-æ¥ç»˜åˆ¶"><a href="#é€šè¿‡-JavaScript-æ¥ç»˜åˆ¶" class="headerlink" title="é€šè¿‡ JavaScript æ¥ç»˜åˆ¶"></a>é€šè¿‡ JavaScript æ¥ç»˜åˆ¶</h3><p>canvas å…ƒç´ æœ¬èº«æ˜¯æ²¡æœ‰ç»˜å›¾èƒ½åŠ›çš„ã€‚æ‰€æœ‰çš„ç»˜åˆ¶å·¥ä½œå¿…é¡»åœ¨ JavaScript å†…éƒ¨å®Œæˆï¼š</p><pre><code class="js">&lt;script type=&quot;text/javascript&quot;&gt;var c=document.getElementById(&quot;myCanvas&quot;);var cxt=c.getContext(&quot;2d&quot;);cxt.fillStyle=&quot;#FF0000&quot;;cxt.fillRect(0,0,150,75);&lt;/script&gt;</code></pre><p>JavaScript ä½¿ç”¨ id æ¥å¯»æ‰¾ canvas å…ƒç´ ï¼š</p><pre><code class="js">var c=document.getElementById(&quot;myCanvas&quot;);</code></pre><p>ç„¶åï¼Œåˆ›å»º context å¯¹è±¡ï¼š</p><pre><code class="js">var cxt=c.getContext(&quot;2d&quot;); getContext(&quot;2d&quot;) å¯¹è±¡æ˜¯å†…å»ºçš„ HTML5 å¯¹è±¡ï¼Œæ‹¥æœ‰å¤šç§ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒçš„æ–¹æ³•ã€‚</code></pre><p>ä¸‹é¢çš„ä¸¤è¡Œä»£ç ç»˜åˆ¶ä¸€ä¸ªçº¢è‰²çš„çŸ©å½¢ï¼š</p><pre><code class="js">cxt.fillStyle=&quot;#FF0000&quot;;cxt.fillRect(0,0,150,75); </code></pre><p>fillStyle æ–¹æ³•å°†å…¶æŸ“æˆçº¢è‰²ï¼ŒfillRect æ–¹æ³•è§„å®šäº†å½¢çŠ¶ã€ä½ç½®å’Œå°ºå¯¸ã€‚</p><h2 id="SVG"><a href="#SVG" class="headerlink" title="SVG"></a>SVG</h2><h3 id="ä»€ä¹ˆæ˜¯SVGï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯SVGï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯SVGï¼Ÿ"></a>ä»€ä¹ˆæ˜¯SVGï¼Ÿ</h3><p>SVG æŒ‡å¯ä¼¸ç¼©çŸ¢é‡å›¾å½¢ (Scalable Vector Graphics)<br>SVG ç”¨äºå®šä¹‰ç”¨äºç½‘ç»œçš„åŸºäºçŸ¢é‡çš„å›¾å½¢<br>SVG ä½¿ç”¨ XML æ ¼å¼å®šä¹‰å›¾å½¢<br>SVG å›¾åƒåœ¨æ”¾å¤§æˆ–æ”¹å˜å°ºå¯¸çš„æƒ…å†µä¸‹å…¶å›¾å½¢è´¨é‡ä¸ä¼šæœ‰æŸå¤±<br>SVG æ˜¯ä¸‡ç»´ç½‘è”ç›Ÿçš„æ ‡å‡†</p><h3 id="SVG-çš„ä¼˜åŠ¿"><a href="#SVG-çš„ä¼˜åŠ¿" class="headerlink" title="SVG çš„ä¼˜åŠ¿"></a>SVG çš„ä¼˜åŠ¿</h3><p>ä¸å…¶ä»–å›¾åƒæ ¼å¼ç›¸æ¯”ï¼ˆæ¯”å¦‚ JPEG å’Œ GIFï¼‰ï¼Œä½¿ç”¨ SVG çš„ä¼˜åŠ¿åœ¨äºï¼š</p><p>SVG å›¾åƒå¯é€šè¿‡æ–‡æœ¬ç¼–è¾‘å™¨æ¥åˆ›å»ºå’Œä¿®æ”¹<br>SVG å›¾åƒå¯è¢«æœç´¢ã€ç´¢å¼•ã€è„šæœ¬åŒ–æˆ–å‹ç¼©<br>SVG æ˜¯å¯ä¼¸ç¼©çš„<br>SVG å›¾åƒå¯åœ¨ä»»ä½•çš„åˆ†è¾¨ç‡ä¸‹è¢«é«˜è´¨é‡åœ°æ‰“å°<br>SVG å¯åœ¨å›¾åƒè´¨é‡ä¸ä¸‹é™çš„æƒ…å†µä¸‹è¢«æ”¾å¤§</p><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot; height=&quot;190&quot;&gt;  &lt;polygon points=&quot;100,10 40,180 190,60 10,60 160,180&quot;  style=&quot;fill:lime;stroke:purple;stroke-width:5;fill-rule:evenodd;&quot; /&gt;&lt;/svg&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h2 id="Canvas-ä¸-SVG-çš„æ¯”è¾ƒ"><a href="#Canvas-ä¸-SVG-çš„æ¯”è¾ƒ" class="headerlink" title="Canvas ä¸ SVG çš„æ¯”è¾ƒ"></a>Canvas ä¸ SVG çš„æ¯”è¾ƒ</h2><p>ä¸‹è¡¨åˆ—å‡ºäº† canvas ä¸ SVG ä¹‹é—´çš„ä¸€äº›ä¸åŒä¹‹å¤„ã€‚</p><blockquote><p>Canvas<br>    ä¾èµ–åˆ†è¾¨ç‡<br>    ä¸æ”¯æŒäº‹ä»¶å¤„ç†å™¨<br>    å¼±çš„æ–‡æœ¬æ¸²æŸ“èƒ½åŠ›<br>    èƒ½å¤Ÿä»¥ .png æˆ– .jpg æ ¼å¼ä¿å­˜ç»“æœå›¾åƒ<br>    æœ€é€‚åˆå›¾åƒå¯†é›†å‹çš„æ¸¸æˆï¼Œå…¶ä¸­çš„è®¸å¤šå¯¹è±¡ä¼šè¢«é¢‘ç¹é‡ç»˜</p></blockquote><blockquote><p>SVG<br>    ä¸ä¾èµ–åˆ†è¾¨ç‡<br>    æ”¯æŒäº‹ä»¶å¤„ç†å™¨<br>    æœ€é€‚åˆå¸¦æœ‰å¤§å‹æ¸²æŸ“åŒºåŸŸçš„åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚è°·æ­Œåœ°å›¾ï¼‰<br>    å¤æ‚åº¦é«˜ä¼šå‡æ…¢æ¸²æŸ“é€Ÿåº¦ï¼ˆä»»ä½•è¿‡åº¦ä½¿ç”¨ DOM çš„åº”ç”¨éƒ½ä¸å¿«ï¼‰<br>    ä¸é€‚åˆæ¸¸æˆåº”ç”¨</p></blockquote><h2 id="Html5åœ°ç†å®šä½"><a href="#Html5åœ°ç†å®šä½" class="headerlink" title="Html5åœ°ç†å®šä½"></a>Html5åœ°ç†å®šä½</h2><p>HTML5 Geolocation API ç”¨äºè·å¾—ç”¨æˆ·çš„åœ°ç†ä½ç½®ã€‚</p><p>é‰´äºè¯¥ç‰¹æ€§å¯èƒ½ä¾µçŠ¯ç”¨æˆ·çš„éšç§ï¼Œé™¤éç”¨æˆ·åŒæ„ï¼Œå¦åˆ™ç”¨æˆ·ä½ç½®ä¿¡æ¯æ˜¯ä¸å¯ç”¨çš„ã€‚</p><pre><code class="js">&lt;script&gt;var x=document.getElementById(&quot;demo&quot;);function getLocation()  {  if (navigator.geolocation)    {    navigator.geolocation.getCurrentPosition(showPosition);    }  else{x.innerHTML=&quot;Geolocation is not supported by this browser.&quot;;}  }function showPosition(position)  {  x.innerHTML=&quot;Latitude: &quot; + position.coords.latitude +  &quot;&lt;br /&gt;Longitude: &quot; + position.coords.longitude;  }&lt;/script&gt;</code></pre><blockquote><p>ä¸Šé¢ä»£ç è§£é‡Šï¼š<br>æ£€æµ‹æ˜¯å¦æ”¯æŒåœ°ç†å®šä½<br>å¦‚æœæ”¯æŒï¼Œåˆ™è¿è¡Œ getCurrentPosition() æ–¹æ³•ã€‚å¦‚æœä¸æ”¯æŒï¼Œåˆ™å‘ç”¨æˆ·æ˜¾ç¤ºä¸€æ®µæ¶ˆæ¯ã€‚<br>å¦‚æœgetCurrentPosition()è¿è¡ŒæˆåŠŸï¼Œåˆ™å‘å‚æ•°showPositionä¸­è§„å®šçš„å‡½æ•°è¿”å›ä¸€ä¸ªcoordinateså¯¹è±¡<br>showPosition() å‡½æ•°è·å¾—å¹¶æ˜¾ç¤ºç»åº¦å’Œçº¬åº¦</p></blockquote><p>å¤„ç†é”™è¯¯ï¼š</p><pre><code class="js">function showError(error)  {  switch(error.code)    {    case error.PERMISSION_DENIED:// ç”¨æˆ·ä¸å…è®¸åœ°ç†å®šä½      x.innerHTML=&quot;User denied the request for Geolocation.&quot;      break;    case error.POSITION_UNAVAILABLE://æ— æ³•è·å–å½“å‰ä½ç½®      x.innerHTML=&quot;Location information is unavailable.&quot;      break;    case error.TIMEOUT:// è¶…æ—¶å¤„ç†      x.innerHTML=&quot;The request to get user location timed out.&quot;      break;    case error.UNKNOWN_ERROR: // é”™è¯¯å¤„ç†      x.innerHTML=&quot;An unknown error occurred.&quot;      break;    }  }</code></pre><h2 id="HTML-5-Web-å­˜å‚¨"><a href="#HTML-5-Web-å­˜å‚¨" class="headerlink" title="HTML 5 Web å­˜å‚¨"></a>HTML 5 Web å­˜å‚¨</h2><p>HTML5 æä¾›äº†ä¸¤ç§åœ¨å®¢æˆ·ç«¯å­˜å‚¨æ•°æ®çš„æ–°æ–¹æ³•ï¼š</p><p>localStorage - æ²¡æœ‰æ—¶é—´é™åˆ¶çš„æ•°æ®å­˜å‚¨<br>sessionStorage - é’ˆå¯¹ä¸€ä¸ª session çš„æ•°æ®å­˜å‚¨</p><h3 id="localStorage-æ–¹æ³•"><a href="#localStorage-æ–¹æ³•" class="headerlink" title="localStorage æ–¹æ³•"></a>localStorage æ–¹æ³•</h3><p>localStorage æ–¹æ³•å­˜å‚¨çš„æ•°æ®æ²¡æœ‰æ—¶é—´é™åˆ¶ã€‚ç¬¬äºŒå¤©ã€ç¬¬äºŒå‘¨æˆ–ä¸‹ä¸€å¹´ä¹‹åï¼Œæ•°æ®ä¾ç„¶å¯ç”¨ã€‚</p><p>å¦‚ä½•åˆ›å»ºå’Œè®¿é—® localStorageï¼š</p><pre><code class="js">&lt;script type=&quot;text/javascript&quot;&gt;localStorage.lastname=&quot;Smith&quot;;document.write(localStorage.lastname);&lt;/script&gt;</code></pre><h3 id="sessionStorage-æ–¹æ³•"><a href="#sessionStorage-æ–¹æ³•" class="headerlink" title="sessionStorage æ–¹æ³•"></a>sessionStorage æ–¹æ³•</h3><p>sessionStorage æ–¹æ³•é’ˆå¯¹ä¸€ä¸ª session è¿›è¡Œæ•°æ®å­˜å‚¨ã€‚å½“ç”¨æˆ·å…³é—­æµè§ˆå™¨çª—å£åï¼Œæ•°æ®ä¼šè¢«åˆ é™¤ã€‚</p><p>å¦‚ä½•åˆ›å»ºå¹¶è®¿é—®ä¸€ä¸ª sessionStorageï¼š</p><pre><code class="js">&lt;script type=&quot;text/javascript&quot;&gt;sessionStorage.lastname=&quot;Smith&quot;;document.write(sessionStorage.lastname);&lt;/script&gt;</code></pre><h2 id="HTML-5-åº”ç”¨ç¨‹åºç¼“å­˜"><a href="#HTML-5-åº”ç”¨ç¨‹åºç¼“å­˜" class="headerlink" title="HTML 5 åº”ç”¨ç¨‹åºç¼“å­˜"></a>HTML 5 åº”ç”¨ç¨‹åºç¼“å­˜</h2><h3 id="ä»€ä¹ˆæ˜¯åº”ç”¨ç¨‹åºç¼“å­˜ï¼ˆApplication-Cacheï¼‰ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åº”ç”¨ç¨‹åºç¼“å­˜ï¼ˆApplication-Cacheï¼‰ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åº”ç”¨ç¨‹åºç¼“å­˜ï¼ˆApplication Cacheï¼‰ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åº”ç”¨ç¨‹åºç¼“å­˜ï¼ˆApplication Cacheï¼‰ï¼Ÿ</h3><p>HTML5 å¼•å…¥äº†åº”ç”¨ç¨‹åºç¼“å­˜ï¼Œè¿™æ„å‘³ç€ web åº”ç”¨å¯è¿›è¡Œç¼“å­˜ï¼Œå¹¶å¯åœ¨æ²¡æœ‰å› ç‰¹ç½‘è¿æ¥æ—¶è¿›è¡Œè®¿é—®ã€‚</p><blockquote><p>åº”ç”¨ç¨‹åºç¼“å­˜ä¸ºåº”ç”¨å¸¦æ¥ä¸‰ä¸ªä¼˜åŠ¿ï¼š</p></blockquote><p>ç¦»çº¿æµè§ˆ - ç”¨æˆ·å¯åœ¨åº”ç”¨ç¦»çº¿æ—¶ä½¿ç”¨å®ƒä»¬<br>é€Ÿåº¦ - å·²ç¼“å­˜èµ„æºåŠ è½½å¾—æ›´å¿«<br>å‡å°‘æœåŠ¡å™¨è´Ÿè½½ - æµè§ˆå™¨å°†åªä»æœåŠ¡å™¨ä¸‹è½½æ›´æ–°è¿‡æˆ–æ›´æ”¹è¿‡çš„èµ„æºã€‚</p><h3 id="Cache-Manifest-åŸºç¡€"><a href="#Cache-Manifest-åŸºç¡€" class="headerlink" title="Cache Manifest åŸºç¡€"></a>Cache Manifest åŸºç¡€</h3><p>å¦‚éœ€å¯ç”¨åº”ç”¨ç¨‹åºç¼“å­˜ï¼Œè¯·åœ¨æ–‡æ¡£çš„ <html> æ ‡ç­¾ä¸­åŒ…å« manifest å±æ€§ï¼š</p><pre><code class="html">&lt;!DOCTYPE HTML&gt;&lt;html manifest=&quot;demo.appcache&quot;&gt;...&lt;/html&gt;</code></pre><h3 id="Manifest-æ–‡ä»¶"><a href="#Manifest-æ–‡ä»¶" class="headerlink" title="Manifest æ–‡ä»¶"></a>Manifest æ–‡ä»¶</h3><p>manifest æ–‡ä»¶æ˜¯ç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒå‘ŠçŸ¥æµè§ˆå™¨è¢«ç¼“å­˜çš„å†…å®¹ï¼ˆä»¥åŠä¸ç¼“å­˜çš„å†…å®¹ï¼‰ã€‚</p><p>manifest æ–‡ä»¶å¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><p><em>CACHE MANIFEST</em> - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶å°†åœ¨é¦–æ¬¡ä¸‹è½½åè¿›è¡Œç¼“å­˜<br><em>NETWORK</em> - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶éœ€è¦ä¸æœåŠ¡å™¨çš„è¿æ¥ï¼Œä¸”ä¸ä¼šè¢«ç¼“å­˜<br><em>FALLBACK</em> - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶è§„å®šå½“é¡µé¢æ— æ³•è®¿é—®æ—¶çš„å›é€€é¡µé¢ï¼ˆæ¯”å¦‚ 404 é¡µé¢ï¼‰</p><h3 id="æ›´æ–°ç¼“å­˜"><a href="#æ›´æ–°ç¼“å­˜" class="headerlink" title="æ›´æ–°ç¼“å­˜"></a>æ›´æ–°ç¼“å­˜</h3><p>ä¸€æ—¦åº”ç”¨è¢«ç¼“å­˜ï¼Œå®ƒå°±ä¼šä¿æŒç¼“å­˜ç›´åˆ°å‘ç”Ÿä¸‹åˆ—æƒ…å†µï¼š</p><p>ç”¨æˆ·æ¸…ç©ºæµè§ˆå™¨ç¼“å­˜<br>manifest æ–‡ä»¶è¢«ä¿®æ”¹ï¼ˆå‚é˜…ä¸‹é¢çš„æç¤ºï¼‰<br>ç”±ç¨‹åºæ¥æ›´æ–°åº”ç”¨ç¼“å­˜</p><h3 id="å®ä¾‹-å®Œæ•´çš„-Manifest-æ–‡ä»¶"><a href="#å®ä¾‹-å®Œæ•´çš„-Manifest-æ–‡ä»¶" class="headerlink" title="å®ä¾‹ - å®Œæ•´çš„ Manifest æ–‡ä»¶"></a>å®ä¾‹ - å®Œæ•´çš„ Manifest æ–‡ä»¶</h3><p>CACHE MANIFEST</p><p> #2012-02-21 v1.0.0<br>/theme.css<br>/logo.gif<br>/main.js</p><p>NETWORK:<br>login.asp</p><p>FALLBACK:<br>/html5/ /404.html</p><p><font color = "red">é‡è¦çš„æç¤ºï¼š</font>ä»¥ â€œ#â€ å¼€å¤´çš„æ˜¯æ³¨é‡Šè¡Œï¼Œä½†ä¹Ÿå¯æ»¡è¶³å…¶ä»–ç”¨é€”ã€‚åº”ç”¨çš„ç¼“å­˜ä¼šåœ¨å…¶ manifest æ–‡ä»¶æ›´æ”¹æ—¶è¢«æ›´æ–°ã€‚å¦‚æœæ‚¨ç¼–è¾‘äº†ä¸€å¹…å›¾ç‰‡ï¼Œæˆ–è€…ä¿®æ”¹äº†ä¸€ä¸ª JavaScript å‡½æ•°ï¼Œè¿™äº›æ”¹å˜éƒ½ä¸ä¼šè¢«é‡æ–°ç¼“å­˜ã€‚æ›´æ–°æ³¨é‡Šè¡Œä¸­çš„æ—¥æœŸå’Œç‰ˆæœ¬å·æ˜¯ä¸€ç§ä½¿æµè§ˆå™¨é‡æ–°ç¼“å­˜æ–‡ä»¶çš„åŠæ³•ã€‚</p><p>æ³¨é‡Šï¼šæµè§ˆå™¨å¯¹ç¼“å­˜æ•°æ®çš„å®¹é‡é™åˆ¶å¯èƒ½ä¸å¤ªä¸€æ ·ï¼ˆæŸäº›æµè§ˆå™¨è®¾ç½®çš„é™åˆ¶æ˜¯æ¯ä¸ªç«™ç‚¹ 5MBï¼‰ã€‚</p><h2 id="HTML-5-Web-Workers"><a href="#HTML-5-Web-Workers" class="headerlink" title="HTML 5 Web Workers"></a>HTML 5 Web Workers</h2><p>ä»€ä¹ˆæ˜¯ Web Workerï¼Ÿ<br>å½“åœ¨ HTML é¡µé¢ä¸­æ‰§è¡Œè„šæœ¬æ—¶ï¼Œé¡µé¢çš„çŠ¶æ€æ˜¯ä¸å¯å“åº”çš„ï¼Œç›´åˆ°è„šæœ¬å·²å®Œæˆã€‚</p><p>web worker æ˜¯è¿è¡Œåœ¨åå°çš„ JavaScriptï¼Œç‹¬ç«‹äºå…¶ä»–è„šæœ¬ï¼Œä¸ä¼šå½±å“é¡µé¢çš„æ€§èƒ½ã€‚æ‚¨å¯ä»¥ç»§ç»­åšä»»ä½•æ„¿æ„åšçš„äº‹æƒ…ï¼šç‚¹å‡»ã€é€‰å–å†…å®¹ç­‰ç­‰ï¼Œè€Œæ­¤æ—¶ web worker åœ¨åå°è¿è¡Œã€‚</p><blockquote><p>Web Workers å’Œ DOM<br>ç”±äº web worker ä½äºå¤–éƒ¨æ–‡ä»¶ä¸­ï¼Œå®ƒä»¬æ— æ³•è®¿é—®ä¸‹ä¾‹ JavaScript å¯¹è±¡ï¼š<br>window å¯¹è±¡<br>document å¯¹è±¡<br>parent å¯¹è±¡</p></blockquote><h2 id="HTML-5-æœåŠ¡å™¨å‘é€äº‹ä»¶"><a href="#HTML-5-æœåŠ¡å™¨å‘é€äº‹ä»¶" class="headerlink" title="HTML 5 æœåŠ¡å™¨å‘é€äº‹ä»¶"></a>HTML 5 æœåŠ¡å™¨å‘é€äº‹ä»¶</h2><p>Server-Sent äº‹ä»¶ - å•å‘æ¶ˆæ¯ä¼ é€’<br>Server-Sent äº‹ä»¶æŒ‡çš„æ˜¯ç½‘é¡µè‡ªåŠ¨è·å–æ¥è‡ªæœåŠ¡å™¨çš„æ›´æ–°ã€‚</p><p>ä»¥å‰ä¹Ÿå¯èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œå‰ææ˜¯ç½‘é¡µä¸å¾—ä¸è¯¢é—®æ˜¯å¦æœ‰å¯ç”¨çš„æ›´æ–°ã€‚é€šè¿‡æœåŠ¡å™¨å‘é€äº‹ä»¶ï¼Œæ›´æ–°èƒ½å¤Ÿè‡ªåŠ¨åˆ°è¾¾ã€‚</p><p>ä¾‹å­ï¼šFacebook/Twitter æ›´æ–°ã€ä¼°ä»·æ›´æ–°ã€æ–°çš„åšæ–‡ã€èµ›äº‹ç»“æœç­‰</p><pre><code class="js">var source=new EventSource(&quot;demo_sse.php&quot;);source.onmessage=function(event)  {  document.getElementById(&quot;result&quot;).innerHTML+=event.data + &quot;&lt;br /&gt;&quot;;  };</code></pre><p>EventSource å¯¹è±¡<br>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ onmessage äº‹ä»¶æ¥è·å–æ¶ˆæ¯ã€‚ä¸è¿‡è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–äº‹ä»¶ï¼š</p><p>onopen    å½“é€šå¾€æœåŠ¡å™¨çš„è¿æ¥è¢«æ‰“å¼€<br>onmessage    å½“æ¥æ”¶åˆ°æ¶ˆæ¯<br>onerror    å½“é”™è¯¯å‘ç”Ÿ</p><h2 id="html5è¡¨å•"><a href="#html5è¡¨å•" class="headerlink" title="html5è¡¨å•"></a>html5è¡¨å•</h2><p>HTML5 æ–°çš„ Input ç±»å‹<br>HTML5 æ‹¥æœ‰å¤šä¸ªæ–°çš„è¡¨å•è¾“å…¥ç±»å‹ã€‚è¿™äº›æ–°ç‰¹æ€§æä¾›äº†æ›´å¥½çš„è¾“å…¥æ§åˆ¶å’ŒéªŒè¯ã€‚</p><p>æœ¬ç« å…¨é¢ä»‹ç»è¿™äº›æ–°çš„è¾“å…¥ç±»å‹ï¼š</p><p>email åœ¨æäº¤è¡¨å•æ—¶ï¼Œä¼šè‡ªåŠ¨éªŒè¯ email åŸŸçš„å€¼ã€‚<br>url åœ¨æäº¤è¡¨å•æ—¶ï¼Œä¼šè‡ªåŠ¨éªŒè¯ url åŸŸçš„å€¼ã€‚<br>number numberç±»å‹ç”¨äºåº”è¯¥åŒ…å«æ•°å€¼çš„è¾“å…¥åŸŸã€‚<br>range range ç±»å‹æ˜¾ç¤ºä¸ºæ»‘åŠ¨æ¡ã€‚<br>Date pickers (date, month, week, time, datetime, datetime-local) æ—¥æœŸé€‰æ‹©å™¨<br>search æœç´¢åŸŸï¼Œæ¯”å¦‚ç«™ç‚¹æœç´¢æˆ– Google æœç´¢ã€‚<br>color </p><h2 id="HTML5-è¡¨å•å…ƒç´ "><a href="#HTML5-è¡¨å•å…ƒç´ " class="headerlink" title="HTML5 è¡¨å•å…ƒç´ "></a>HTML5 è¡¨å•å…ƒç´ </h2><blockquote><p>HTML5 çš„æ–°çš„è¡¨å•å…ƒç´ ï¼š<br>datalist datalist å…ƒç´ è§„å®šè¾“å…¥åŸŸçš„é€‰é¡¹åˆ—è¡¨ã€‚<br><code>`</code>html<br>Webpage: <input type="url" list="url_list" name="link" /></p></blockquote><p><datalist id="url_list"></p><p><option label="W3School" value="http://www.W3School.com.cn" /></p><p><option label="Google" value="http://www.google.com" /></p><p><option label="Microsoft" value="http://www.microsoft.com" /><br></datalist><br><code>`</code><br>æç¤ºï¼šoption å…ƒç´ æ°¸è¿œéƒ½è¦è®¾ç½® value å±æ€§ã€‚</p><p>keygen keygen å…ƒç´ çš„ä½œç”¨æ˜¯æä¾›ä¸€ç§éªŒè¯ç”¨æˆ·çš„å¯é æ–¹æ³•ã€‚<br>output output å…ƒç´ ç”¨äºä¸åŒç±»å‹çš„è¾“å‡ºï¼Œæ¯”å¦‚è®¡ç®—æˆ–è„šæœ¬è¾“å‡ºï¼š</p><h2 id="HTML5-è¡¨å•å±æ€§"><a href="#HTML5-è¡¨å•å±æ€§" class="headerlink" title="HTML5 è¡¨å•å±æ€§"></a>HTML5 è¡¨å•å±æ€§</h2><h3 id="æ–°çš„-form-å±æ€§ï¼š"><a href="#æ–°çš„-form-å±æ€§ï¼š" class="headerlink" title="æ–°çš„ form å±æ€§ï¼š"></a>æ–°çš„ form å±æ€§ï¼š</h3><p>autocomplete autocomplete å±æ€§è§„å®š form æˆ– input åŸŸåº”è¯¥æ‹¥æœ‰è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ã€‚<br>novalidate</p><h3 id="æ–°çš„-input-å±æ€§ï¼š"><a href="#æ–°çš„-input-å±æ€§ï¼š" class="headerlink" title="æ–°çš„ input å±æ€§ï¼š"></a>æ–°çš„ input å±æ€§ï¼š</h3><p>autocomplete<br>autofocus autofocus å±æ€§è§„å®šåœ¨é¡µé¢åŠ è½½æ—¶ï¼ŒåŸŸè‡ªåŠ¨åœ°è·å¾—ç„¦ç‚¹ã€‚<br>form<br>form overrides (formaction, formenctype, formmethod, formnovalidate, formtarget) å…è®¸æ‚¨é‡å†™ form å…ƒç´ çš„æŸäº›å±æ€§è®¾å®š<br>height å’Œ width height å’Œ width å±æ€§è§„å®šç”¨äº image ç±»å‹çš„ input æ ‡ç­¾çš„å›¾åƒé«˜åº¦å’Œå®½åº¦ã€‚<br>list list å±æ€§è§„å®šè¾“å…¥åŸŸçš„ datalistã€‚datalist æ˜¯è¾“å…¥åŸŸçš„é€‰é¡¹åˆ—è¡¨ã€‚<br>min, max å’Œ step step å±æ€§ä¸ºè¾“å…¥åŸŸè§„å®šåˆæ³•çš„æ•°å­—é—´éš”<br>multiple multiple å±æ€§é€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„ <input> æ ‡ç­¾ï¼šemail å’Œ fileã€‚<br>pattern (regexp) pattern å±æ€§è§„å®šç”¨äºéªŒè¯ input åŸŸçš„æ¨¡å¼ï¼ˆpatternï¼‰ã€‚<br>placeholder å±æ€§æä¾›ä¸€ç§æç¤ºï¼ˆhintï¼‰ï¼Œæè¿°è¾“å…¥åŸŸæ‰€æœŸå¾…çš„å€¼ã€‚<br>required  å±æ€§è§„å®šå¿…é¡»åœ¨æäº¤ä¹‹å‰å¡«å†™è¾“å…¥åŸŸï¼ˆä¸èƒ½ä¸ºç©ºï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> HTML5 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20ä¸ªè¶…çº§å®ç”¨çš„cssä»£ç </title>
      <link href="/2018/03/18/CSS3/20%E4%B8%AA%E8%B6%85%E7%BA%A7%E5%AE%9E%E7%94%A8%E7%9A%84css%E4%BB%A3%E7%A0%81/"/>
      <url>/2018/03/18/CSS3/20%E4%B8%AA%E8%B6%85%E7%BA%A7%E5%AE%9E%E7%94%A8%E7%9A%84css%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.w3cplus.com/css/20-incredibly-useful-CSS-snippets-for-developers" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><p>å¤§å®¶éå¸¸çš„æ¸…æ¥šCSSæ˜¯æˆ‘ä»¬Webåˆ¶ä½œä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚HTMLæä¾›äº†Webåˆ¶ä½œçš„ç»“æ„ï¼Œä½†ä»–ä¸èƒ½è®©æˆ‘ä»¬å®ç°ç¾ä¸½çš„é¡µé¢åˆ¶ä½œï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦CSSçš„å¸®åŠ©ã€‚CSSè™½ç„¶èƒ½å¸®æˆ‘ä»¬å®Œå–„Webåˆ¶ä½œçš„æ•ˆæœï¼Œä½†å…¶åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸‹æ˜¯æœ‰ä¸å¯é¢„çŸ¥çš„æ•ˆæœï¼Œä¸ºäº†è®©ä½ çš„CSSèƒ½è§£å†³è¿™äº›ä¸ä¸€è‡´ä¸‹ï¼Œä»Šå¤©ç»™å¤§å®¶ä»‹ç»25ä¸ªCSSæŠ€å·§ä»£ç ï¼Œæˆ‘ç›¸ä¿¡è¿™äº›å¯¹ä½ è‚¯å®¶æœ‰å¾ˆå¤§çš„ä½œç”¨ã€‚</p><h2 id="ä½¿ç”¨text-indentæ¥éšè—æ–‡æœ¬"><a href="#ä½¿ç”¨text-indentæ¥éšè—æ–‡æœ¬" class="headerlink" title="ä½¿ç”¨text-indentæ¥éšè—æ–‡æœ¬"></a>ä½¿ç”¨text-indentæ¥éšè—æ–‡æœ¬</h2><p>è¿™ä¸ªå¸¸ç”¨åœ¨å›¾ç‰‡æ›¿æ¢æ–‡æœ¬ä¸­ï¼Œæœ€å¸¸è§çš„å°±æ˜¯ä½¿ç”¨ä½¿ç”¨å›¾ç‰‡æ¥æ›¿æ¢Logoï¼Œè¿™ä¸ªæ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œä½¿ç”¨â€œtext-indentâ€æˆ‘ä»¬å¯ä»¥è¾¾åˆ°å›¾ç‰‡æ›¿æ¢æ–‡æœ¬çš„æ•ˆæœï¼Œè€Œä¸”æ–¹ä¾¿æœç´¢å¼•æ“çš„ä¼˜åŒ–ï¼Œè¿˜èƒ½æ”¯æŒé˜…è¯»å™¨é˜…è¯»ç½‘é¡µå†…å®¹ï¼š</p><pre><code class="css">            h1 {                text-indent:-9999px;                margin:0 auto;                width:400px;                height:100px;                background:transparent url(&quot;images/logo.jpg&quot;) no-repeat scroll;            }</code></pre><h2 id="æ ¹æ®æ–‡ä»¶æ ¼å¼è®¾ç½®é“¾æ¥å›¾æ ‡"><a href="#æ ¹æ®æ–‡ä»¶æ ¼å¼è®¾ç½®é“¾æ¥å›¾æ ‡" class="headerlink" title="æ ¹æ®æ–‡ä»¶æ ¼å¼è®¾ç½®é“¾æ¥å›¾æ ‡"></a>æ ¹æ®æ–‡ä»¶æ ¼å¼è®¾ç½®é“¾æ¥å›¾æ ‡</h2><p>è¿™ä¸ªæŠ€å·§ä¸»è¦æ˜¯é’ˆå¯¹ç”¨æˆ·ä½“éªŒï¼Œè®©ç”¨æˆ·èƒ½å¾ˆæ¸…æ¥šç‚¹å‡»çš„é“¾æ¥æ˜¯æœ‰å…³äºä»€ä¹ˆæ–¹é¢çš„å†…å®¹ï¼Œæ¯”å¦‚è¯´ï¼Œç‚¹å‡»æŸä¸ªé“¾æ¥ä¼šåˆ°è·³åˆ°ç«™å¤–ã€‚æ¢å¥è¯è¯´ä½¿ç”¨å±æ€§é€‰æ‹©å™¨å™¨ï¼Œç»™ä¸åŒçš„é“¾æ¥è®¾ç½®ä¸åŒçš„å›¾æ ‡ï¼Œè®©ç”¨æˆ·å¾ˆè½»æ¾çš„æ˜ç™½ç›¸åº”çš„é“¾æ¥æ˜¯æœ‰å…³äºä»€ä¹ˆæ–¹é¢çš„å†…å®¹ï¼š</p><pre><code class="css">            a[href^=&quot;http:&quot;] {                    display:inline-block;                    padding-right:14px;                    background:transparent url(/Images/ExternalLink.gif) center right no-repeat;            }            a[href^=&quot;mailto:&quot;] {                    display:inline-block;                    padding-left:20px;                    line-height:18px;                    background:transparent url(/Images/MailTo.gif) center left no-repeat;            }            a[href$=&#39;.pdf&#39;] {                    display:inline-block;                    padding-left:20px;                    line-height:18px;                    background:transparent url(/Images/PDFIcon.gif) center left no-repeat;            }            a[href$=&#39;.swf&#39;], a[href$=&#39;.fla&#39;], a[href$=&#39;.swd&#39;] {                    display:inline-block;                    padding-left:20px;                    line-height:18px;                    background:transparent url(/Images/FlashIcon.gif) center left no-repeat;            }            a[href$=&#39;.xls&#39;], a[href$=&#39;.csv&#39;], a[href$=&#39;.xlt&#39;], a[href$=&#39;.xlw&#39;] {                    display:inline-block;                    padding-left:20px;                    line-height:18px;                    background:transparent url(/Images/ExcelIcon.gif) center left no-repeat;            }            a[href$=&#39;.ppt&#39;], a[href$=&#39;.pps&#39;] {                    display:inline-block;                    padding-left:20px;                    line-height:18px;                    background:transparent url(/Images/PowerPointIcon.gif) center left no-repeat;            }            a[href$=&#39;.doc&#39;], a[href$=&#39;.rtf&#39;], a[href$=&#39;.txt&#39;], a[href$=&#39;.wps&#39;] {                    display:inline-block;                    padding-left:20px;                    line-height:18px;                    background:transparent url(/Images/WordDocIcon.gif) center left no-repeat;            }            a[href$=&#39;.zip&#39;], a[href$=&#39;.gzip&#39;], a[href$=&#39;.rar&#39;] {                    display:inline-block;                    padding-left:20px;                    line-height:18px;                    background:transparent url(/Images/ZIPIcon.gif) center left no-repeat;            }</code></pre><h2 id="åœ¨IEæµè§ˆå™¨ä¸­åˆ é™¤textareaçš„æ»šåŠ¨æ¡"><a href="#åœ¨IEæµè§ˆå™¨ä¸­åˆ é™¤textareaçš„æ»šåŠ¨æ¡" class="headerlink" title="åœ¨IEæµè§ˆå™¨ä¸­åˆ é™¤textareaçš„æ»šåŠ¨æ¡"></a>åœ¨IEæµè§ˆå™¨ä¸­åˆ é™¤textareaçš„æ»šåŠ¨æ¡</h2><p>IEæµè§ˆå™¨ä¸­textareaé»˜è®¤å°±æœ‰æ»šåŠ¨æ¡å‡ºç°ï¼Œä¸ºäº†è¾¾åˆ°æ‰€æœ‰æµè§ˆå™¨é»˜è®¤ä¸‹ä¸€è‡´çš„æ•ˆæœï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç è®©ä»–è¾¾åˆ°ä¸€è‡´çš„æ•ˆæœï¼š</p><pre><code class="css">textarea{    overflow:auto;}</code></pre><h2 id="æ®µè½é¦–å­—ä¸‹æ²‰"><a href="#æ®µè½é¦–å­—ä¸‹æ²‰" class="headerlink" title="æ®µè½é¦–å­—ä¸‹æ²‰"></a>æ®µè½é¦–å­—ä¸‹æ²‰</h2><p>æœ‰æ‚å¿—æ’ç‰ˆä¸­æˆ‘ä»¬å¸¸çœ‹åˆ°ç¬¬ä¸€ä¸ªæ®µè½çš„é¦–å­—ä¸‹æ²‰çš„æ•ˆæœï¼Œå…¶å®è¿™ç§æ•ˆæœå®ç°æ˜¯ç›¸å½“çš„å®¹æ˜“ï¼š</p><pre><code class="css">    p:first-letter{        display:block;        margin:5px 0 0 5px;        float:left;        color:#FF3366;        font-size:60px;        font-family:Georgia;    }</code></pre><h2 id="æ‰€æœ‰æµè§ˆå™¨ä¸‹çš„CSSé€æ˜åº¦"><a href="#æ‰€æœ‰æµè§ˆå™¨ä¸‹çš„CSSé€æ˜åº¦" class="headerlink" title="æ‰€æœ‰æµè§ˆå™¨ä¸‹çš„CSSé€æ˜åº¦"></a>æ‰€æœ‰æµè§ˆå™¨ä¸‹çš„CSSé€æ˜åº¦</h2><pre><code class="css">    .transparent {        zoom: 1;        filter: alpha(opacity=50);        opacity: 0.5;    }</code></pre><p>ä½†æ˜¯ä½¿ç”¨opacityä¼šå½±å“å…¶åä»£å…ƒç´ çš„é€æ˜åº¦ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ï¼š</p><pre><code class="css">        .transparent {            /* Fallback for web browsers that doesn&#39;t support RGBa */            background: rgb(0, 0, 0);            /* RGBa with 0.6 opacity */            background: rgba(0, 0, 0, 0.6);            /* For IE 5.5 - 7*/            filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);            /* For IE 8*/            -ms-filter: &quot;progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)&quot;;        }</code></pre><h2 id="Reset-Css"><a href="#Reset-Css" class="headerlink" title="Reset Css"></a>Reset Css</h2><pre><code class="css">body,ul,ol,dl,dd,dir,h1,h2,h3,h4,h5,h6,p,pre,blockquote,hr,figure{      margin:0;      padding:0;      font-size: 100%;      vertical-align:baseline;        }        table {            border-collapse:collapse;            border-spacing:0;        }        article, aside, dialog, figure, footer, header, hgroup, nav, section {             display:block;        }        /*         * Corrects inline-block display not defined in IE6/7/8/9 &amp; FF3         */        audio,        canvas,        video {            display: inline-block;            *display: inline;            *zoom: 1;        }        /*         * Prevents modern browsers from displaying &#39;audio&#39; without controls         */        audio:not([controls]) {            display: none;        }        /*         * Addresses styling for &#39;hidden&#39; attribute not present in IE7/8/9, FF3, S4         * Known issue: no IE6 support         */        [hidden] {            display: none;        }</code></pre><h2 id="å›¾ç‰‡é¢„åŠ è½½"><a href="#å›¾ç‰‡é¢„åŠ è½½" class="headerlink" title="å›¾ç‰‡é¢„åŠ è½½"></a>å›¾ç‰‡é¢„åŠ è½½</h2><pre><code class="css">#preloader {            /* Images you want to preload*/            background-image: url(image1.jpg);            background-image: url(image2.jpg);            background-image: url(image3.jpg);            width: 0px;            height: 0px;            display: inline;        }</code></pre><h2 id="åŸºæœ¬çš„CSS-SpriteæŒ‰é’®"><a href="#åŸºæœ¬çš„CSS-SpriteæŒ‰é’®" class="headerlink" title="åŸºæœ¬çš„CSS SpriteæŒ‰é’®"></a>åŸºæœ¬çš„CSS SpriteæŒ‰é’®</h2><pre><code class="css">a {    display: block;    background: url(sprite.png) no-repeat;    height: 30px;    width: 250px;    }a:hover {    background-position: 0 -30px;}</code></pre><h2 id="Google-Font-API"><a href="#Google-Font-API" class="headerlink" title="Google Font API"></a>Google Font API</h2><pre><code class="css">&lt;head&gt;    Inconsolata:italic|Droid+Sans&quot;&lt;/head&gt;body {    font-family: &#39;Tangerine&#39;, &#39;Inconsolata&#39;, &#39;Droid Sans&#39;, serif; font-size: 48px;}</code></pre><h2 id="æµè§ˆå™¨çš„ä¸“ç”¨hack"><a href="#æµè§ˆå™¨çš„ä¸“ç”¨hack" class="headerlink" title="æµè§ˆå™¨çš„ä¸“ç”¨hack"></a>æµè§ˆå™¨çš„ä¸“ç”¨hack</h2><p>æµè§ˆå™¨çš„å…¼å®¹é—®é¢˜å‘æ¥éƒ½æ˜¯å¾ˆçƒ¦çš„äº‹æƒ…ï¼Œç‰¹åˆ«æ˜¯åœ¨IEä¸‹çš„å…¼å®¹é—®é¢˜ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬ä¸ºäº†è¾¾åˆ°ä¸€è‡´çš„æ•ˆæœï¼Œä¸å¾—ä¸ä½¿ç”¨æµè§ˆå™¨çš„å…¼å®¹ï¼š</p><pre><code class="css">        /* IE 6 */        * html .yourclass { }        /* IE 7 */        *+html .yourclass{ }        /* IE 7 and modern browsers */        html&gt;body .yourclass { }        /* Modern browsers (not IE 7) */        html&gt;/**/body .yourclass { }        /* Opera 9.27 and below */        html:first-child .yourclass { }        /* Safari */        html[xmlns*=&quot;&quot;] body:last-child .yourclass { }        /* Safari 3+, Chrome 1+, Opera 9+, Fx 3.5+ */        body:nth-of-type(1) .yourclass { }        /* Safari 3+, Chrome 1+, Opera 9+, Fx 3.5+ */        body:first-of-type .yourclass {  }        /* Safari 3+, Chrome 1+ */        @media screen and (-webkit-min-device-pixel-ratio:0) {         .yourclass  {  }        }</code></pre><h2 id="å›ºå®šé¡µè„š"><a href="#å›ºå®šé¡µè„š" class="headerlink" title="å›ºå®šé¡µè„š"></a>å›ºå®šé¡µè„š</h2><p>å›ºå®šé¡µè„šåœ¨å±å¹•çš„åº•éƒ¨ï¼Œåœ¨ç°ä»£æµè§ˆå™¨æ¥è¯´æ˜¯ä¸€ä»¶éå¸¸å®¹æ˜“çš„äº‹æƒ…ï¼Œä½†æ˜¯åœ¨IE6ä¸‹è¿˜æ˜¯éœ€è¦ç‰¹æ®Šçš„å¤„ç†ï¼š</p><pre><code class="css">        #footer {            position:fixed;            left:0px;            bottom:0px;            height:30px;            width:100%;            background:#999;        }        /* IE 6 */        * html #footer {            position:absolute;            top:expression((0-(footer.offsetHeight)+(document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body.clientHeight)+(ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop))+&#39;px&#39;);        }</code></pre><h2 id="ç¿»è½¬å›¾ç‰‡"><a href="#ç¿»è½¬å›¾ç‰‡" class="headerlink" title="ç¿»è½¬å›¾ç‰‡"></a>ç¿»è½¬å›¾ç‰‡</h2><p>ç¿»è½¬å›¾åƒéšç€CSS3çš„transformè¶Šæ¥è¶Šå®ç”¨ï¼Œä¸éœ€è¦é‡æ–°åŠ è½½å›¾ç‰‡ï¼Œå°±å¯ä»¥å®ç°ä¸€ä¸ªå›¾ç‰‡çš„æ—‹è½¬ã€‚å¸¸è§çš„æ˜¯ä¸€ä¸ªä¸‰è§’å‹æ•ˆæœï¼Œæˆ‘ä»¬æƒ³è®©ä»–åœ¨ä¸åŒçŠ¶æ€å±•ç¤ºä¸åŒçš„é£æ ¼ï¼š</p><pre><code class="css">    img.flip {        -moz-transform: scaleX(-1);        -o-transform: scaleX(-1);        -webkit-transform: scaleX(-1);        transform: scaleX(-1);        filter: FlipH;        -ms-filter: &quot;FlipH&quot;;    }</code></pre><h2 id="clearfix"><a href="#clearfix" class="headerlink" title="clearfix"></a>clearfix</h2><p>clearfixä¸»è¦æ˜¯ä½¿ç”¨ä»–æ¥æ¸…é™¤æµ®åŠ¨ï¼Œåªéœ€è¦æ·»åŠ è¿™ä¸ªç±»åæ— éœ€åŠ ä¸Šä»»ä½•HTMLæ ‡è®°ï¼Œå°±å¯ä»¥è¾¾åˆ°æ¸…é™¤æµ®åŠ¨çš„æ•ˆæœï¼š</p><pre><code class="css">        .clearfix:before,        .clearfix:after {            content: &quot; &quot;;            display:table;        }        .clearfix:after {            clear:both;            overflow:hidden;        }        .clearfix {             zoom: 1;        }</code></pre><h2 id="åœ†è§’"><a href="#åœ†è§’" class="headerlink" title="åœ†è§’"></a>åœ†è§’</h2><p>éšç€CSS3çš„å±æ€§çš„å‡ºç°ï¼Œæˆ‘ä»¬åˆ¶ä½œåœ†è§’æ•ˆæœå°±ä¸éœ€è¦åœ¨åƒä»¥å‰é‚£æ ·çš„è¾›è‹¦äº†ï¼Œå¯ä»¥ä½¿ç”¨CSS3çš„border-radiusæ¥å®ç°ï¼Œåªæ˜¯åœ¨IE-6-8ä¸‹æ— æ³•å®ç°ï¼Œæˆ‘ä»¬æ¥çœ‹ç°ä»£æµè§ˆå™¨ä¸‹å¦‚ä½•åˆ¶ä½œåœ†è§’ï¼š</p><pre><code class="css">        .round{            -moz-border-radius: 10px;            -webkit-border-radius: 10px;            -khtml-border-radius: 10px; /* for old Konqueror browsers */            border-radius: 10px; /* future proofing */        }</code></pre><h2 id="important"><a href="#important" class="headerlink" title="!important"></a>!important</h2><p>!importantæœ‰æ—¶å¯ä»¥å¸®æˆ‘ä»¬åšå¾ˆå¤šäº‹ï¼Œä»–å¯ä»¥è¦†ç›–ä»»ä½•ç›¸åŒçš„æ ·å¼ï¼Œæ¢å¥è¯è¯´ä»–å¯ä»¥æ”¹ä¸ºæ ·å¼çš„æƒé‡ï¼š</p><pre><code class="css">        p{            font-size:20px !important;        }</code></pre><h2 id="font-face"><a href="#font-face" class="headerlink" title="@font-face"></a>@font-face</h2><p>@font-faceä¹Ÿæ˜¯CSS3çš„å±æ€§ä¹‹ä¸€ï¼Œä»–èƒ½åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸‹è¿è¡Œã€‚æœ€å¤§çš„ä½œç”¨å°±æ˜¯è®©ç”¨æˆ·æ²¡æœ‰å­—ä½“çš„æµè§ˆä¸‹ä¹Ÿèƒ½æ”¯æŒç½‘é¡µå­—ä½“ï¼Œå…·ä½“ä½¿ç”¨ï¼š</p><pre><code class="css">        @font-face {            font-family: &#39;Graublau Web&#39;;            src: url(&#39;GraublauWeb.eot&#39;);            src: local(&#39;â˜º&#39;),                url(&#39;GraublauWeb.woff&#39;) format(&#39;woff&#39;), url(&#39;GraublauWeb.ttf&#39;) format(&#39;truetype&#39;);        }        h2 {            font-family:&#39;Graublau Web&#39;;        }</code></pre><h2 id="é¡µé¢æ°´å¹³å±…ä¸­"><a href="#é¡µé¢æ°´å¹³å±…ä¸­" class="headerlink" title="é¡µé¢æ°´å¹³å±…ä¸­"></a>é¡µé¢æ°´å¹³å±…ä¸­</h2><p>å¦‚ä½•ä½¿ä¸€ä¸ªç½‘ç«™çš„é¡µé¢æ°´å¹³å±…ä¸­æ˜¾ç¤ºï¼Œæˆ‘æƒ³è¿™ä¸ªä¸ç”¨æˆ‘è¯´å¤§å®¶ä¹ŸçŸ¥é“ï¼Œå› ä¸ºå¤§å®¶è‚¯å®šä½¿ç”¨è¿‡å¤šæ¬¡äº†ã€‚</p><pre><code class="css">        .wrapper {            width:960px;            margin:0 auto;        }</code></pre><h2 id="æœ€å°é«˜åº¦min-height"><a href="#æœ€å°é«˜åº¦min-height" class="headerlink" title="æœ€å°é«˜åº¦min-height"></a>æœ€å°é«˜åº¦min-height</h2><p>åœ¨IE6æµè§ˆå™¨ä¸‹æ˜¯ä¸æ”¯æŒæœ€å°é«˜åº¦è¿™ä¸ªå±æ€§çš„ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ ·çš„ä»£ç æ¥å¤„ç†ï¼š</p><pre><code class="css">        .box {            min-height:500px;            height:auto !important;            height:500px;        }</code></pre><h2 id="å‚ç›´å±…ä¸­"><a href="#å‚ç›´å±…ä¸­" class="headerlink" title="å‚ç›´å±…ä¸­"></a>å‚ç›´å±…ä¸­</h2><p>æ°´å¹³å±…ä¸­å¤„ç†èµ·æ¥ç›¸å½“çš„ç®€å•çš„ï¼Œä½†æ˜¯å‚ç›´å±…ä¸­å¤„ç†èµ·æ¥è¿˜æ˜¯ç›¸å½“çš„çƒ¦ï¼Œç‰¹åˆ«æ˜¯è¦å…¼å®¹IEçš„æµè§ˆå™¨æƒ…å†µä¸‹ï¼š</p><pre><code class="css">        div {            height: 100px;            line-height: 100px;            white-space: nowrap;        }        img { vertical-align: middle; }        .for_ie6 { display: inline-block; }        .for_ie6 { display: inline; }</code></pre><h2 id="selection"><a href="#selection" class="headerlink" title="::selection"></a>::selection</h2><p>æœ‰å¾ˆå¤šæœ‹å‹è‚¯å®šä¸çŸ¥é“è¿™ä¸ªå±æ€§çš„ä½œç”¨ã€‚å®ƒå¯ä»¥æ”¹å˜é€‰æ‹©çš„æ–‡æœ¬çš„èƒŒæ™¯è‰²å’Œå‰æ™¯è‰²ï¼Œçªå‡ºä½ çš„æµè§ˆå™¨ä¸­çš„é€‰æ‹©æ–‡æœ¬æ•ˆæœï¼š</p><pre><code class="css">        ::selection {            color: #000000;            background-color: #FF0000;        }        ::-moz-selection {            color: #000000;            background: #FF0000;        }</code></pre>]]></content>
      
      
      <categories>
          
          <category> Css3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Css3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯é¢è¯•é¢˜ï¼ˆå«äººäº‹æ–¹é¢ï¼‰</title>
      <link href="/2018/03/13/Interview/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E5%90%AB%E4%BA%BA%E4%BA%8B%E6%96%B9%E9%9D%A2%EF%BC%89/"/>
      <url>/2018/03/13/Interview/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E5%90%AB%E4%BA%BA%E4%BA%8B%E6%96%B9%E9%9D%A2%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰ç«¯æ–¹é¢"><a href="#å‰ç«¯æ–¹é¢" class="headerlink" title="å‰ç«¯æ–¹é¢"></a>å‰ç«¯æ–¹é¢</h2><h3 id="1-éšè—htmlå…ƒç´ çš„ä¸¤ç§æ–¹å¼ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-éšè—htmlå…ƒç´ çš„ä¸¤ç§æ–¹å¼ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.éšè—htmlå…ƒç´ çš„ä¸¤ç§æ–¹å¼ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.éšè—htmlå…ƒç´ çš„ä¸¤ç§æ–¹å¼ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ã€display: noneã€‘ï¼šéšè—å…ƒç´ åŠå…ƒç´ å†…çš„æ‰€æœ‰å†…å®¹ï¼Œå¹¶ä¸”è¯¥å…ƒç´ çš„ä½ç½®ã€å®½é«˜ç­‰å…¶ä»–å±æ€§å€¼ä¸€å¹¶â€œæ¶ˆå¤±â€ï¼›<br>ã€visibility: hiddenã€‘ï¼šéšè—å…ƒç´ åŠå…ƒç´ å†…çš„æ‰€æœ‰å†…å®¹ï¼Œä½†æ˜¯è¯¥å…ƒç´ çš„ä½ç½®ã€å®½é«˜ç­‰å±æ€§å€¼ä»ç„¶è¿˜åœ¨ã€‚ </p><h3 id="2-eachå’Œ-selector-each-çš„åŒºåˆ«ï¼Ÿ"><a href="#2-eachå’Œ-selector-each-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="2.$.eachå’Œ$(selector).each()çš„åŒºåˆ«ï¼Ÿ"></a>2.$.eachå’Œ$(selector).each()çš„åŒºåˆ«ï¼Ÿ</h3><p>  $.eachå’Œ$(selector).each()ä¸åŒï¼Œåè€…ä¸“ç”¨äºjQueryå¯¹è±¡çš„éå†ï¼Œå‰è€…å¯ç”¨äºéå†ä»»ä½•é›†åˆï¼ˆæ— è®ºæ˜¯æ•°ç»„è¿˜æ˜¯å¯¹è±¡ï¼‰ï¼Œå¦‚æœæ˜¯æ•°ç»„ï¼Œå›è°ƒå‡½æ•°æ¯æ¬¡ä¼ å…¥æ•°ç»„çš„ç´¢å¼•å€¼å’Œå¯¹åº”å€¼ï¼ˆå€¼äº¦å¯ä»¥é€šè¿‡thiså…³é”®å­—è·å–ï¼Œä½†JavaScriptæ€»ä¼šåŒ…è£…thiså€¼ä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œæ–¹æ³•ä¼šè¿”å›è¢«éå†å¯¹è±¡çš„ç¬¬ä¸€å‚æ•°ã€‚</p><h3 id="3-ajaxçš„å¿…è¦å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ-Successå’Œcompleteé‚£ä¸ªå…ˆæ‰§è¡Œï¼Ÿ"><a href="#3-ajaxçš„å¿…è¦å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ-Successå’Œcompleteé‚£ä¸ªå…ˆæ‰§è¡Œï¼Ÿ" class="headerlink" title="3.$.ajaxçš„å¿…è¦å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ   Successå’Œcompleteé‚£ä¸ªå…ˆæ‰§è¡Œï¼Ÿ"></a>3.$.ajaxçš„å¿…è¦å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ   Successå’Œcompleteé‚£ä¸ªå…ˆæ‰§è¡Œï¼Ÿ</h3><p>  Function) success - å½“è¯·æ±‚æˆåŠŸæ—¶è°ƒç”¨çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šå¾—åˆ°ä¸€ä¸ªå‚æ•°ï¼šä»æœåŠ¡å™¨è¿”å›çš„æ•°æ®ï¼ˆæ ¹æ®â€œdataTypeâ€è¿›è¡Œäº†æ ¼å¼åŒ–ï¼‰ã€‚<br>  Function) complete - å½“è¯·æ±‚å®Œæˆæ—¶è°ƒç”¨çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šå¾—åˆ°ä¸¤ä¸ªå‚æ•°ï¼šXMLHttpRequestå¯¹è±¡å’Œä¸€ä¸ªæè¿°è¯·æ±‚æˆåŠŸçš„ç±»å‹çš„å­—ç¬¦ä¸²ã€‚<br>    jqueryä¸­å„ä¸ªäº‹ä»¶æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š<br>    1.ajaxStart(å…¨å±€äº‹ä»¶)<br>    2.beforeSend<br>    3.ajaxSend(å…¨å±€äº‹ä»¶)<br>    4.success<br>    5.ajaxSuccess(å…¨å±€äº‹ä»¶)<br>    6.error<br>    7.ajaxError (å…¨å±€äº‹ä»¶)<br>    8.complete<br>    9.ajaxComplete(å…¨å±€äº‹ä»¶)<br>    10.ajaxStop(å…¨å±€äº‹ä»¶)</p><h3 id="4-åˆ—ä¸¾æµè§ˆå™¨å¯¹è±¡æ¨¡å‹BOMé‡Œå¸¸ç”¨çš„4ä¸ªå¯¹è±¡ï¼Œå¹¶åˆ—ä¸¾windowå¯¹è±¡çš„å¸¸ç”¨æ–¹æ³•è‡³å°‘5ä¸ªã€‚"><a href="#4-åˆ—ä¸¾æµè§ˆå™¨å¯¹è±¡æ¨¡å‹BOMé‡Œå¸¸ç”¨çš„4ä¸ªå¯¹è±¡ï¼Œå¹¶åˆ—ä¸¾windowå¯¹è±¡çš„å¸¸ç”¨æ–¹æ³•è‡³å°‘5ä¸ªã€‚" class="headerlink" title="4.åˆ—ä¸¾æµè§ˆå™¨å¯¹è±¡æ¨¡å‹BOMé‡Œå¸¸ç”¨çš„4ä¸ªå¯¹è±¡ï¼Œå¹¶åˆ—ä¸¾windowå¯¹è±¡çš„å¸¸ç”¨æ–¹æ³•è‡³å°‘5ä¸ªã€‚"></a>4.åˆ—ä¸¾æµè§ˆå™¨å¯¹è±¡æ¨¡å‹BOMé‡Œå¸¸ç”¨çš„4ä¸ªå¯¹è±¡ï¼Œå¹¶åˆ—ä¸¾windowå¯¹è±¡çš„å¸¸ç”¨æ–¹æ³•è‡³å°‘5ä¸ªã€‚</h3><pre><code>Window  document  location  screen  history  navigatoræ–¹æ³•ï¼šAlert()  confirm()  prompt()  open()  close()  </code></pre><h3 id="5-ç®€è¿°åˆ—ä¸¾æ–‡æ¡£å¯¹è±¡æ¨¡å‹DOMé‡Œdocumentçš„å¸¸ç”¨çš„æŸ¥è¯¢è®¿é—®èŠ‚ç‚¹çš„æ–¹æ³•å¹¶åšç®€å•è¯´æ˜ã€‚"><a href="#5-ç®€è¿°åˆ—ä¸¾æ–‡æ¡£å¯¹è±¡æ¨¡å‹DOMé‡Œdocumentçš„å¸¸ç”¨çš„æŸ¥è¯¢è®¿é—®èŠ‚ç‚¹çš„æ–¹æ³•å¹¶åšç®€å•è¯´æ˜ã€‚" class="headerlink" title="5.ç®€è¿°åˆ—ä¸¾æ–‡æ¡£å¯¹è±¡æ¨¡å‹DOMé‡Œdocumentçš„å¸¸ç”¨çš„æŸ¥è¯¢è®¿é—®èŠ‚ç‚¹çš„æ–¹æ³•å¹¶åšç®€å•è¯´æ˜ã€‚"></a>5.ç®€è¿°åˆ—ä¸¾æ–‡æ¡£å¯¹è±¡æ¨¡å‹DOMé‡Œdocumentçš„å¸¸ç”¨çš„æŸ¥è¯¢è®¿é—®èŠ‚ç‚¹çš„æ–¹æ³•å¹¶åšç®€å•è¯´æ˜ã€‚</h3><p>1.é€šè¿‡ID,ä½¿ç”¨ getElementById() è·å¾—æ ‡ç­¾èŠ‚ç‚¹</p><p>2.é€šè¿‡æ ‡ç­¾çš„åç§°,ä½¿ç”¨getElementsByTagName() è·å¾—å…ƒç´ èŠ‚ç‚¹æˆ–æ ‡ç­¾èŠ‚ç‚¹<br>  æ³¨æ„ï¼šä»¥ä¸Šçš„æŸ¥æ‰¾æ–¹å¼éƒ½ä¼šå¿½ç•¥æ–‡æ¡£çš„ç»“æ„</p><p>3.é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹çš„ parentNodeã€firstChild ä»¥åŠ lastChild å±æ€§</p><p>4.èŠ‚ç‚¹åç§°nodeName<br>  a)å¦‚æœèŠ‚ç‚¹æ˜¯æ ‡ç­¾ï¼ŒnodeNameæ˜¯æ ‡ç­¾åç§°<br>  b)å¦‚æœèŠ‚ç‚¹æ˜¯å±æ€§ï¼ŒnodeNameæ˜¯å±æ€§åç§°<br>  c)å¦‚æœèŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼ŒnodeNameæ˜¯#text<br>  d)å¦‚æœèŠ‚ç‚¹æ˜¯æ–‡æ¡£ï¼ŒnodeNameæ˜¯#document</p><p>5.èŠ‚ç‚¹å€¼nodeValue<br>6.èŠ‚ç‚¹ç±»å‹nodeType<br><a id="more"></a></p><h3 id="6-Ajaxçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼ˆè‡³å°‘å„3ä¸ªï¼‰ï¼ŸåŒæ­¥å¼‚æ­¥çš„åŒºåˆ«ï¼Ÿ"><a href="#6-Ajaxçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼ˆè‡³å°‘å„3ä¸ªï¼‰ï¼ŸåŒæ­¥å¼‚æ­¥çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="6.Ajaxçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼ˆè‡³å°‘å„3ä¸ªï¼‰ï¼ŸåŒæ­¥å¼‚æ­¥çš„åŒºåˆ«ï¼Ÿ"></a>6.Ajaxçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼ˆè‡³å°‘å„3ä¸ªï¼‰ï¼ŸåŒæ­¥å¼‚æ­¥çš„åŒºåˆ«ï¼Ÿ</h3><ul><li>ajaxçš„ä¼˜ç‚¹</li></ul><p>1.å¼‚æ­¥çš„ä¸æœåŠ¡å™¨é€šä¿¡<br>2.æ— åˆ·æ–°æ›´æ–°æ•°æ®<br>3.åŸºäºæ ‡å‡†å¹¿æ³›æ”¯æŒ<br>4.å‰åç«¯è´Ÿè½½å¹³è¡¡<br>5.ç•Œé¢ä¸åº”ç”¨åˆ†ç¦»</p><ul><li>ajaxçš„ç¼ºç‚¹</li></ul><p>1.AJAXå¹²æ‰äº†Backå’ŒHistoryåŠŸèƒ½ï¼Œå³å¯¹æµè§ˆå™¨æœºåˆ¶çš„ç ´åã€‚<br>2.AJAXçš„å®‰å…¨é—®é¢˜ã€‚<br>3.å¯¹æœç´¢å¼•æ“æ”¯æŒè¾ƒå¼±ã€‚<br>4.ç ´åç¨‹åºçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚<br>5.è¿èƒŒURLå’Œèµ„æºå®šä½çš„åˆè¡·ã€‚<br>6.AJAXä¸èƒ½å¾ˆå¥½æ”¯æŒç§»åŠ¨è®¾å¤‡ã€‚<br>7.å®¢æˆ·ç«¯è¿‡è‚¥ï¼Œå¤ªå¤šå®¢æˆ·ç«¯ä»£ç é€ æˆå¼€å‘ä¸Šçš„æˆæœ¬ã€‚</p><p>åŒæ­¥ä¸å¼‚æ­¥çš„åŒºåˆ«</p><p>1ã€åŒæ­¥<br>å‘é€æ–¹å‘å‡ºæ•°æ®åï¼Œç­‰æ¥æ”¶æ–¹å‘å›å“åº”ä»¥åæ‰å‘ä¸‹ä¸€ä¸ªæ•°æ®åŒ…çš„é€šè®¯æ–¹å¼ã€‚</p><p>ä¾‹å¦‚ï¼šç”¨æˆ·å¡«å†™æ‰€æœ‰ä¿¡æ¯åï¼Œæäº¤ç»™æœåŠ¡å™¨ï¼Œç­‰å¾…æœåŠ¡å™¨çš„å›åº”ï¼ˆæ£€éªŒæ•°æ®ï¼‰ï¼Œæ˜¯ä¸€æ¬¡æ€§çš„ã€‚ä¿¡æ¯é”™è¯¯åˆè¦é‡æ–°å¡«å†™ï¼</p><p>2ã€å¼‚æ­¥<br>æ˜¯æŒ‡ï¼šå‘é€æ–¹å‘å‡ºæ•°æ®åï¼Œä¸ç­‰æ¥æ”¶æ–¹å‘å›å“åº”ï¼Œæ¥ç€å‘é€ä¸‹ä¸ªæ•°æ®åŒ…çš„é€šè®¯æ–¹å¼ã€‚</p><p>ä¾‹å¦‚ï¼šå½“ç”¨æˆ·å¡«å†™å®Œä¸€æ¡ä¿¡æ¯åï¼Œè¯¥ä¿¡æ¯ä¼šè‡ªåŠ¨å‘æœåŠ¡å™¨æäº¤ï¼Œç„¶åæœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·ä¾ç„¶åœ¨å¡«å†™è¡¨æ ¼çš„ä¿¡æ¯ï¼Œå³å‘æœåŠ¡å™¨è¯·æ±‚å¤šæ¬¡ï¼ŒèŠ‚çœäº†ç”¨æˆ·çš„æ—¶é—´ï¼Œæé«˜äº†ç”¨æˆ·çš„ä½“éªŒã€‚</p><p>3ã€åŒºåˆ«ï¼š</p><p>åŒæ­¥è¯·æ±‚æ¯”ç€å¼‚æ­¥è¯·æ±‚å°‘äº†ä¸ªXMLhttpRequestå¯¹è±¡ã€‚åœ¨ç”¨æˆ·ä½“éªŒæ–¹é¢ï¼Œå¼‚æ­¥çš„ç”¨æˆ·ä½“éªŒæ›´å¥½ä¸€äº›ã€‚</p><h3 id="7-å‰ç«¯å¼€å‘çš„ä¼˜åŒ–é—®é¢˜ã€‚"><a href="#7-å‰ç«¯å¼€å‘çš„ä¼˜åŒ–é—®é¢˜ã€‚" class="headerlink" title="7.å‰ç«¯å¼€å‘çš„ä¼˜åŒ–é—®é¢˜ã€‚"></a>7.å‰ç«¯å¼€å‘çš„ä¼˜åŒ–é—®é¢˜ã€‚</h3><p>ï¼ˆ1ï¼‰ å‡å°‘httpè¯·æ±‚æ¬¡æ•°ï¼šcss spirit,data uri<br>ï¼ˆ2ï¼‰ JSï¼ŒCSSæºç å‹ç¼©<br>ï¼ˆ3ï¼‰ å‰ç«¯æ¨¡æ¿ JS+æ•°æ®ï¼Œå‡å°‘ç”±äºHTMLæ ‡ç­¾å¯¼è‡´çš„å¸¦å®½æµªè´¹ï¼Œå‰ç«¯ç”¨å˜é‡ä¿å­˜AJAXè¯·æ±‚ç»“æœï¼Œæ¯æ¬¡æ“ä½œæœ¬åœ°å˜é‡ï¼Œä¸ç”¨è¯·æ±‚ï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•°<br>ï¼ˆ4ï¼‰ ç”¨innerHTMLä»£æ›¿DOMæ“ä½œï¼Œå‡å°‘DOMæ“ä½œæ¬¡æ•°ï¼Œä¼˜åŒ–javascriptæ€§èƒ½<br>ï¼ˆ5ï¼‰ ç”¨setTimeoutæ¥é¿å…é¡µé¢å¤±å»å“åº”<br>ï¼ˆ6ï¼‰ ç”¨hash-tableæ¥ä¼˜åŒ–æŸ¥æ‰¾<br>ï¼ˆ7ï¼‰ å½“éœ€è¦è®¾ç½®çš„æ ·å¼å¾ˆå¤šæ—¶è®¾ç½®classNameè€Œä¸æ˜¯ç›´æ¥æ“ä½œstyle<br>ï¼ˆ8ï¼‰ å°‘ç”¨å…¨å±€å˜é‡<br>ï¼ˆ9ï¼‰ ç¼“å­˜DOMèŠ‚ç‚¹æŸ¥æ‰¾çš„ç»“æœ<br>ï¼ˆ10ï¼‰ é¿å…ä½¿ç”¨CSS Expression<br>ï¼ˆ11ï¼‰ å›¾ç‰‡é¢„è½½<br>ï¼ˆ12ï¼‰ é¿å…åœ¨é¡µé¢çš„ä¸»ä½“å¸ƒå±€ä¸­ä½¿ç”¨tableï¼Œtableè¦ç­‰å…¶ä¸­çš„å†…å®¹å®Œå…¨ä¸‹è½½ä¹‹åæ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œæ˜¾ç¤ºæ¯”div+csså¸ƒå±€æ…¢</p><h3 id="8-ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ"><a href="#8-ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ" class="headerlink" title="8.ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ"></a>8.ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ</h3><p>ç®€è¨€ä¹‹ï¼Œé—­åŒ…æ˜¯ç”±å‡½æ•°å¼•ç”¨å…¶å‘¨è¾¹çŠ¶æ€ï¼ˆ<strong>è¯æ³•ç¯å¢ƒ</strong>ï¼‰ç»‘åœ¨ä¸€èµ·å½¢æˆçš„ï¼ˆå°è£…ï¼‰ç»„åˆç»“æ„ã€‚åœ¨ JavaScript ä¸­ï¼Œé—­åŒ…åœ¨æ¯ä¸ªå‡½æ•°è¢«åˆ›å»ºæ—¶å½¢æˆã€‚</p><p>è¿™æ˜¯åŸºæœ¬åŸç†ï¼Œä½†ä¸ºä»€ä¹ˆæˆ‘ä»¬å…³å¿ƒè¿™äº›ï¼Ÿå®é™…ä¸Šï¼Œç”±äºé—­åŒ…ä¸å®ƒçš„è¯æ³•ç¯å¢ƒç»‘åœ¨ä¸€èµ·ï¼Œå› æ­¤ <strong>é—­åŒ…è®©æˆ‘ä»¬èƒ½å¤Ÿä»ä¸€ä¸ªå‡½æ•°å†…éƒ¨è®¿é—®å…¶å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸ</strong>ã€‚</p><p>è¦ä½¿ç”¨é—­åŒ…ï¼Œåªéœ€è¦ç®€å•åœ°å°†ä¸€ä¸ªå‡½æ•°å®šä¹‰åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨ï¼Œå¹¶å°†å®ƒæš´éœ²å‡ºæ¥ã€‚è¦æš´éœ²ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥å°†å®ƒè¿”å›æˆ–è€…ä¼ ç»™å…¶ä»–å‡½æ•°ã€‚</p><p><strong>å†…éƒ¨å‡½æ•°å°†èƒ½å¤Ÿè®¿é—®åˆ°å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡</strong>ï¼Œå³ä½¿å¤–éƒ¨å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚</p><p>é—­åŒ…çš„ç”¨é€”ä¹‹ä¸€æ˜¯å®ç°å¯¹è±¡çš„ç§æœ‰æ•°æ®ã€‚</p><h3 id="9-Doctypeä½œç”¨ï¼Ÿæ ‡å‡†æ¨¡å¼å’Œå…¼å®¹æ¨¡å¼å„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#9-Doctypeä½œç”¨ï¼Ÿæ ‡å‡†æ¨¡å¼å’Œå…¼å®¹æ¨¡å¼å„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="9.Doctypeä½œç”¨ï¼Ÿæ ‡å‡†æ¨¡å¼å’Œå…¼å®¹æ¨¡å¼å„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>9.Doctypeä½œç”¨ï¼Ÿæ ‡å‡†æ¨¡å¼å’Œå…¼å®¹æ¨¡å¼å„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>DOCTYPEæ˜¯document type(æ–‡æ¡£ç±»å‹)çš„ç®€å†™,ç”¨æ¥å‘Šè¯‰æµè§ˆå™¨çš„è§£æå™¨ä½¿ç”¨å“ªç§HTMLæˆ–XHTMLè§„èŒƒè§£æé¡µé¢ã€‚DOCTYPEä¸å­˜åœ¨æˆ–æ ¼å¼ä¸æ­£ç¡®ä¼šå¯¼è‡´æ–‡æ¡£ä»¥å…¼å®¹æ¨¡å¼å‘ˆç°ã€‚</p><p>ä¸ºä»€ä¹ˆHTML5åªè¦å†™&lt;!DOCTYPE HTML&gt;</p><p>HTML 4.01 åŸºäº SGMLï¼Œéœ€è¦å¯¹ DTD è¿›è¡Œå¼•ç”¨ï¼Œæ‰èƒ½å‘ŠçŸ¥æµè§ˆå™¨æ–‡æ¡£æ‰€ä½¿ç”¨çš„æ–‡æ¡£ç±»å‹ ã€‚<br>HTML 5 ä¸åŸºäº SGMLï¼Œå› æ­¤ä¸éœ€è¦å¯¹ DTD è¿›è¡Œå¼•ç”¨ï¼Œä½†æ˜¯éœ€è¦ doctype æ¥è§„èŒƒæµè§ˆå™¨çš„è¡Œä¸ºã€‚<br>SGMLæ˜¯æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€,ç®€å•çš„è¯´ï¼Œå°±æ˜¯æ¯”HTML,XMLæ›´è€çš„æ ‡å‡†ï¼Œè¿™ä¸¤è€…éƒ½æ˜¯ç”±SGMLå‘å±•è€Œæ¥çš„ã€‚ä½†æ˜¯ï¼ŒHTML5ä¸æ˜¯çš„ã€‚</p><ul><li><p>æ ‡å‡†æ¨¡å¼ä¸å…¼å®¹æ¨¡å¼ï¼ˆæ€ªå¼‚æ¨¡å¼ï¼‰å„æœ‰ä»€ä¹ˆåŒºåˆ«?</p><p>Standardsï¼ˆæ ‡å‡†ï¼‰æ¨¡å¼ï¼ˆä¹Ÿå°±æ˜¯ä¸¥æ ¼å‘ˆç°æ¨¡å¼ï¼‰ç”¨äºå‘ˆç°éµå¾ªæœ€æ–°æ ‡å‡†çš„ç½‘é¡µï¼Œè€ŒQuirksï¼ˆå…¼å®¹ï¼‰æ¨¡å¼ï¼ˆä¹Ÿå°±æ˜¯æ¾æ•£å‘ˆç°æ¨¡å¼æˆ–è€…æ€ªå¼‚æ¨¡å¼ï¼‰ç”¨äºå‘ˆç°ä¸ºä¼ ç»Ÿæµè§ˆå™¨è€Œè®¾è®¡çš„ç½‘é¡µã€‚</p></li></ul><p>æ ‡å‡†æ¨¡å¼çš„æ’ç‰ˆ å’ŒJSè¿ä½œæ¨¡å¼éƒ½æ˜¯ä»¥è¯¥æµè§ˆå™¨æ”¯æŒçš„æœ€é«˜æ ‡å‡†è¿è¡Œã€‚<br>å…¼å®¹æ¨¡å¼ä¸­ï¼Œé¡µé¢ä»¥å®½æ¾çš„å‘åå…¼å®¹çš„æ–¹å¼æ˜¾ç¤º,æ¨¡æ‹Ÿè€å¼æµè§ˆå™¨çš„è¡Œä¸ºä»¥é˜²æ­¢ç«™ç‚¹æ— æ³•å·¥ä½œã€‚ç®€å•è¯´å°±æ˜¯å°½å¯èƒ½çš„æ˜¾ç¤ºèƒ½æ˜¾ç¤ºçš„ä¸œè¥¿ç»™ç”¨æˆ·çœ‹ã€‚</p><p>å…·ä½“åŒºåˆ«ï¼š<br>1.ç›’æ¨¡å‹<br>  åœ¨ä¸¥æ ¼æ¨¡å¼ä¸­ ï¼šwidthæ˜¯å†…å®¹å®½åº¦ ï¼Œå…ƒç´ çœŸæ­£çš„å®½åº¦ = width;<br>  åœ¨å…¼å®¹æ¨¡å¼ä¸­ ï¼šwidthåˆ™æ˜¯=width+padding+border</p><p>2.å…¼å®¹æ¨¡å¼ä¸‹å¯è®¾ç½®ç™¾åˆ†æ¯”çš„é«˜åº¦å’Œè¡Œå†…å…ƒç´ çš„é«˜å®½<br>    åœ¨Standardsæ¨¡å¼ä¸‹ï¼Œç»™spanç­‰è¡Œå†…å…ƒç´ è®¾ç½®wdithå’Œheightéƒ½ä¸ä¼šç”Ÿæ•ˆï¼Œè€Œåœ¨å…¼å®¹æ¨¡å¼ä¸‹ï¼Œåˆ™ä¼šç”Ÿæ•ˆã€‚<br>    åœ¨standardsæ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªå…ƒç´ çš„é«˜åº¦æ˜¯ç”±å…¶åŒ…å«çš„å†…å®¹æ¥å†³å®šçš„ï¼Œå¦‚æœçˆ¶å…ƒç´ æ²¡æœ‰è®¾ç½®é«˜åº¦ï¼Œå­å…ƒç´ è®¾ç½®ä¸€ä¸ªç™¾åˆ†æ¯”çš„é«˜åº¦æ˜¯æ— æ•ˆçš„ã€‚</p><p>3.ç”¨margin:0 autoè®¾ç½®æ°´å¹³å±…ä¸­åœ¨IEä¸‹ä¼šå¤±æ•ˆ<br>    ä½¿ç”¨margin:0 autoåœ¨standardsæ¨¡å¼ä¸‹å¯ä»¥ä½¿å…ƒç´ æ°´å¹³å±…ä¸­ï¼Œä½†åœ¨å…¼å®¹æ¨¡å¼ä¸‹å´ä¼šå¤±æ•ˆï¼ˆç”¨text-alignå±æ€§è§£å†³ï¼‰<br>    body{text-align:center};#content{text-align:left}</p><p>4.å…¼å®¹æ¨¡å¼ä¸‹Tableä¸­çš„å­—ä½“å±æ€§ä¸èƒ½ç»§æ‰¿ä¸Šå±‚çš„è®¾ç½®ï¼Œwhite-space:preä¼šå¤±æ•ˆï¼Œè®¾ç½®å›¾ç‰‡çš„paddingä¼šå¤±æ•ˆ</p><h3 id="10-å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æœ‰å“ªäº›ï¼Ÿ"><a href="#10-å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="10.å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æœ‰å“ªäº›ï¼Ÿ"></a>10.å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æœ‰å“ªäº›ï¼Ÿ</h3><p>Trident-IEæµè§ˆå™¨å†…æ ¸<br>Gecko-ç«ç‹æµè§ˆå™¨å†…æ ¸Mozilla<br>Blink(Webkitçš„åˆ†æ”¯)-è°·æ­Œæµè§ˆå™¨å†…æ ¸<br>Prestoï¼Œç°ä¸ºBlink-Operaæµè§ˆå™¨å†…æ ¸</p><h3 id="11-HTML5çš„æ–°ç‰¹æ€§ï¼Ÿ"><a href="#11-HTML5çš„æ–°ç‰¹æ€§ï¼Ÿ" class="headerlink" title="11.HTML5çš„æ–°ç‰¹æ€§ï¼Ÿ"></a>11.HTML5çš„æ–°ç‰¹æ€§ï¼Ÿ</h3><p>1.è¯­æ„ç‰¹æ€§,æ·»åŠ <code>&lt;header&gt;&lt;header/&gt;&lt;nav&gt;&lt;nav</code>&gt;ç­‰æ ‡ç­¾<br>2.å¤šåª’ä½“ï¼Œ ç”¨äºåª’ä»‹å›æ”¾çš„ video å’Œ audio å…ƒç´ <br>3.å›¾åƒæ•ˆæœï¼Œç”¨äºç»˜ç”»çš„ canvas å…ƒç´ ï¼Œsvgå…ƒç´ ç­‰<br>4.ç¦»çº¿ &amp; å­˜å‚¨,å¯¹æœ¬åœ°ç¦»çº¿å­˜å‚¨çš„æ›´å¥½çš„æ”¯æŒ,local Store,Cookiesç­‰<br>5.è®¾å¤‡å…¼å®¹ç‰¹æ€§ ï¼ŒHTML5æä¾›äº†å‰æ‰€æœªæœ‰çš„æ•°æ®ä¸åº”ç”¨æ¥å…¥å¼€æ”¾æ¥å£ã€‚ä½¿å¤–éƒ¨åº”ç”¨å¯ä»¥ç›´æ¥ä¸æµè§ˆå™¨å†…éƒ¨çš„æ•°æ®ç›´æ¥ç›¸è¿ï¼Œ<br>6.è¿æ¥ç‰¹æ€§ï¼Œæ›´æœ‰æ•ˆçš„è¿æ¥å·¥ä½œæ•ˆç‡ï¼Œä½¿å¾—åŸºäºé¡µé¢çš„å®æ—¶èŠå¤©ï¼Œæ›´å¿«é€Ÿçš„ç½‘é¡µæ¸¸æˆä½“éªŒï¼Œæ›´ä¼˜åŒ–çš„åœ¨çº¿äº¤æµå¾—åˆ°äº†å®ç°ã€‚HTML5æ‹¥æœ‰æ›´æœ‰æ•ˆçš„æœåŠ¡å™¨æ¨é€æŠ€æœ¯ï¼ŒServer-Sent Eventå’ŒWebSocketså°±æ˜¯å…¶ä¸­çš„ä¸¤ä¸ªç‰¹æ€§ï¼Œè¿™ä¸¤ä¸ªç‰¹æ€§èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å®ç°æœåŠ¡å™¨å°†æ•°æ®â€œæ¨é€â€åˆ°å®¢æˆ·ç«¯çš„åŠŸèƒ½<br>7.æ€§èƒ½ä¸é›†æˆç‰¹æ€§ï¼ŒHTML5ä¼šé€šè¿‡XMLHttpRequest2ç­‰æŠ€æœ¯ï¼Œå¸®åŠ©æ‚¨çš„Webåº”ç”¨å’Œç½‘ç«™åœ¨å¤šæ ·åŒ–çš„ç¯å¢ƒä¸­æ›´å¿«é€Ÿçš„å·¥ä½œ</p><h3 id="12-å¦‚ä½•å¤„ç†HTML5æ–°æ ‡ç­¾çš„æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Ÿ"><a href="#12-å¦‚ä½•å¤„ç†HTML5æ–°æ ‡ç­¾çš„æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Ÿ" class="headerlink" title="12.å¦‚ä½•å¤„ç†HTML5æ–°æ ‡ç­¾çš„æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Ÿ"></a>12.å¦‚ä½•å¤„ç†HTML5æ–°æ ‡ç­¾çš„æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Ÿ</h3><p>document.createElementï¼ˆâ€˜æ–°æ ‡ç­¾â€™ï¼‰; / /æ–°å¢åˆ›å»ºæ–°æ ‡ç­¾<br>å†è€…è¿˜æœ‰ä¸€ç§åŠæ³•å°±æ˜¯ç”¨æ¡†æ¶çš„æ–¹æ³•ï¼Œç”¨åˆ°æ¡ä»¶æ³¨é‡ŠåŠ JSä»£ç å®ç°</p><pre><code class="html">&lt;!--[if lt IE 9]&gt;&lt;script&gt; src=&quot;http://html5shim.googlecode.com/svn/trunk/html5.js&quot;&lt;/script&gt;&lt;![endif]--&gt;</code></pre><p>ç›´æ¥åŠ å…¥è¿™ä¸€å¥ä»£ç å°±å¯å®ç°å…¼å®¹é—®é¢˜ï¼Œå…³äºæ¡ä»¶æ³¨æ„ä¸­çš„</p><pre><code class="html">&lt;!--if lt IE9&gt;</code></pre><h3 id="13-å¦‚ä½•åŒºåˆ†HTMLå’ŒHTML5ï¼Ÿ"><a href="#13-å¦‚ä½•åŒºåˆ†HTMLå’ŒHTML5ï¼Ÿ" class="headerlink" title="13.å¦‚ä½•åŒºåˆ†HTMLå’ŒHTML5ï¼Ÿ"></a>13.å¦‚ä½•åŒºåˆ†HTMLå’ŒHTML5ï¼Ÿ</h3><p>1.åœ¨æ–‡æ¡£ç±»å‹å£°æ˜ä¸Š</p><p>html:</p><pre><code class="html">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</code></pre><p>HTML5:</p><pre><code class="html">&lt;!DOCTYPE html&gt;</code></pre><p>ç”±è¿™ä¸¤è€…å¯¹æ¯”å¯è§ï¼šåœ¨æ–‡æ¡£å£°æ˜ä¸Šï¼Œhtmlæœ‰å¾ˆé•¿çš„ä¸€æ®µä»£ç ï¼Œå¹¶ä¸”å¾ˆéš¾è®°ä½è¿™æ®µä»£ç ï¼Œæƒ³å¿…å¾ˆå¤šäººéƒ½æ˜¯é å·¥å…·ç›´æ¥ç”Ÿæˆçš„å§ï¼Ÿè€Œhtml5å´æ˜¯ä¸åŒï¼Œåªæœ‰ç®€ç®€å•å•çš„å£°æ˜ï¼Œè¿™ä¹Ÿæ–¹ä¾¿äººä»¬çš„è®°å¿†ï¼Œæ›´åŠ ç²¾ç®€ã€‚</p><p>2.åœ¨ç»“æ„è¯­ä¹‰ä¸Š</p><p>html4.0ï¼šæ²¡æœ‰ä½“ç°ç»“æ„è¯­ä¹‰åŒ–çš„æ ‡ç­¾ï¼Œæˆ‘ä»¬é€šå¸¸éƒ½æ˜¯è¿™æ ·æ¥å‘½åçš„</p><pre><code class="html">&lt;divid=&quot;header&quot;&gt;&lt;/div&gt;</code></pre><p>è¿™æ ·è¡¨ç¤ºç½‘ç«™çš„å¤´éƒ¨ã€‚</p><p>html5ï¼šåœ¨è¯­ä¹‰ä¸Šå´æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ã€‚æä¾›äº†ä¸€äº›æ–°çš„html5æ ‡ç­¾ï¼Œæ¯”å¦‚:</p><pre><code class="html">&lt;header&gt; ã€&lt;nav&gt;ã€&lt;article&gt;ã€&lt;aside&gt;ã€&lt;footer&gt;..</code></pre><p>3.å¼ºå¤§çš„HTML5çš„æ–°åŠŸèƒ½</p><p>ï¼ˆ1ï¼‰å¼ºå¤§çš„ç»˜å›¾åŠŸèƒ½<br>ï¼ˆ2ï¼‰æ–°å¢è§†é¢‘æ ‡ç­¾ </p><h3 id="14-æè¿°cookieï¼ŒsessionStorageå’ŒlocalStorageçš„åŒºåˆ«ï¼Ÿ"><a href="#14-æè¿°cookieï¼ŒsessionStorageå’ŒlocalStorageçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="14.æè¿°cookieï¼ŒsessionStorageå’ŒlocalStorageçš„åŒºåˆ«ï¼Ÿ"></a>14.æè¿°cookieï¼ŒsessionStorageå’ŒlocalStorageçš„åŒºåˆ«ï¼Ÿ</h3><p>ä¸‰è€…çš„å¼‚åŒ</p><p>ç‰¹æ€§    Cookie    localStorage    sessionStorage<br>æ•°æ®çš„ç”Ÿå‘½æœŸ    ä¸€èˆ¬ç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå¯è®¾ç½®å¤±æ•ˆæ—¶é—´ã€‚å¦‚æœåœ¨æµè§ˆå™¨ç«¯ç”ŸæˆCookieï¼Œé»˜è®¤æ˜¯å…³é—­æµè§ˆå™¨åå¤±æ•ˆ    é™¤éè¢«æ¸…é™¤ï¼Œå¦åˆ™æ°¸ä¹…ä¿å­˜    ä»…åœ¨å½“å‰ä¼šè¯ä¸‹æœ‰æ•ˆï¼Œå…³é—­é¡µé¢æˆ–æµè§ˆå™¨åè¢«æ¸…é™¤<br>å­˜æ”¾æ•°æ®å¤§å°    4Kå·¦å³    ä¸€èˆ¬ä¸º5MB<br>ä¸æœåŠ¡å™¨ç«¯é€šä¿¡    æ¯æ¬¡éƒ½ä¼šæºå¸¦åœ¨HTTPå¤´ä¸­ï¼Œå¦‚æœä½¿ç”¨cookieä¿å­˜è¿‡å¤šæ•°æ®ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜    ä»…åœ¨å®¢æˆ·ç«¯ï¼ˆå³æµè§ˆå™¨ï¼‰ä¸­ä¿å­˜ï¼Œä¸å‚ä¸å’ŒæœåŠ¡å™¨çš„é€šä¿¡<br>æ˜“ç”¨æ€§    éœ€è¦ç¨‹åºå‘˜è‡ªå·±å°è£…ï¼Œæºç”Ÿçš„Cookieæ¥å£ä¸å‹å¥½    æºç”Ÿæ¥å£å¯ä»¥æ¥å—ï¼Œäº¦å¯å†æ¬¡å°è£…æ¥å¯¹Objectå’ŒArrayæœ‰æ›´å¥½çš„æ”¯æŒ</p><h3 id="15-å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡ï¼Ÿ"><a href="#15-å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡ï¼Ÿ" class="headerlink" title="15.å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡ï¼Ÿ"></a>15.å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡ï¼Ÿ</h3><p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿæ•°æ®å­˜å‚¨çš„çŸ¥è¯†ï¼Œæ•°æ®å­˜å‚¨æœ‰æœ¬åœ°å’ŒæœåŠ¡å™¨å­˜å‚¨ä¸¤ç§æ–¹å¼ã€‚è¿™é‡Œä¸»è¦è®²è§£ç”¨æœ¬åœ°å­˜å‚¨æ–¹å¼è§£å†³ã€‚å³è°ƒç”¨ localStorageã€Cookieç­‰æœ¬åœ°å­˜å‚¨æ–¹å¼ã€‚</p><p>ç¬¬ä¸€ç§â€”â€”è°ƒç”¨localStorage<br>ç¬¬äºŒç§â€”â€”è°ƒç”¨cookie+setInterval()</p><h3 id="16-Strongå’Œemçš„å¼‚åŒï¼Ÿ"><a href="#16-Strongå’Œemçš„å¼‚åŒï¼Ÿ" class="headerlink" title="16.Strongå’Œemçš„å¼‚åŒï¼Ÿ"></a>16.Strongå’Œemçš„å¼‚åŒï¼Ÿ</h3><p>åœ¨æµè§ˆå™¨ä¸­ï¼Œ<code>&lt;em&gt;</code> é»˜è®¤ç”¨æ–œä½“è¡¨ç¤ºï¼Œ<code>&lt;strong&gt;</code> ç”¨ç²—ä½“è¡¨ç¤ºã€‚ä»æ ·å¼è¡¨ç°ä¸Šï¼Œ<code>&lt;strong&gt;</code> æ›´åŠ çªå‡ºï¼Œæ›´å®¹æ˜“å¸å¼•çœ¼å…‰ã€‚æ˜¾ç„¶ï¼Œè¿™ç§è§†è§‰ä¸Šçš„å·®å¼‚è®¾è®¡æ˜¯æœ‰ç›®çš„çš„ã€‚</p><p>em è¡¨ç¤ºå†…å®¹çš„ç€é‡ç‚¹ï¼ˆstress emphasisï¼‰ï¼Œæ”¾ç½®çš„ä½ç½®ä¼šæ”¹å˜æ‰€åœ¨å¥å­çš„å«ä¹‰ã€‚<br>strong è¡¨ç¤ºå†…å®¹çš„é‡è¦æ€§ï¼ˆstrong importanceï¼‰ï¼Œå¼ºè°ƒå¥å­çš„é‡è¦æ€§è€Œä¸ä¼šæ”¹å˜æ‰€åœ¨å¥å­çš„è¯­æ„ã€‚</p><h3 id="17-ç®€è¿°srcå’Œhrefçš„åŒºåˆ«ï¼Ÿ"><a href="#17-ç®€è¿°srcå’Œhrefçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="17.ç®€è¿°srcå’Œhrefçš„åŒºåˆ«ï¼Ÿ"></a>17.ç®€è¿°srcå’Œhrefçš„åŒºåˆ«ï¼Ÿ</h3><p>href æ—¶æŒ‡å‘ç½‘ç»œèµ„æºæ‰€åœ¨ä½ç½®ï¼Œå»ºç«‹å’Œå½“å‰å…ƒç´ ï¼ˆé”šç‚¹ï¼‰æˆ–å½“å‰æ–‡æ¡£ï¼ˆé“¾æ¥ï¼‰ä¹‹é—´çš„é“¾æ¥ï¼Œç”¨äºè¶…é“¾æ¥ã€‚<br>src æ—¶æŒ‡å‘å¤–éƒ¨çš„èµ„æºä½ç½®ï¼ŒæŒ‡å‘çš„å†…å®¹å°†ä¼šåµŒå…¥åˆ°æ–‡æ¡£ä¸­å½“å‰æ ‡ç­¾æ‰€åœ¨ä½ç½®ï¼›åœ¨è¯·æ±‚ src èµ„æºæ—¶ä¼šå°†å…¶æŒ‡å‘çš„èµ„æºä¸‹è½½å¹¶åº”ç”¨åˆ°æ–‡æ¡£å†…ï¼Œä¾‹å¦‚ js è„šæœ¬ï¼Œimg å›¾ç‰‡å’Œ frame ç­‰å…ƒç´ ã€‚<strong> å½“æµè§ˆå™¨è§£æåˆ°è¯¥å…ƒç´ æ—¶ï¼Œä¼šæš‚åœå…¶ä»–èµ„æºçš„ä¸‹è½½å’Œå¤„ç†ï¼Œç›´åˆ°å°†è¯¥èµ„æºåŠ è½½ã€ç¼–è¯‘ã€æ‰§è¡Œå®Œæ¯• </strong>ï¼Œå›¾ç‰‡å’Œæ¡†æ¶ç­‰å…ƒç´ ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œç±»ä¼¼äºå°†æ‰€æŒ‡å‘èµ„æºåµŒå…¥å½“å‰æ ‡ç­¾å†…ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå°† js è„šæœ¬æ”¾åœ¨åº•éƒ¨è€Œä¸æ˜¯å¤´éƒ¨ã€‚</p><h3 id="18-Cssé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€æ ·å®šä¹‰çš„ï¼Ÿ"><a href="#18-Cssé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€æ ·å®šä¹‰çš„ï¼Ÿ" class="headerlink" title="18.Cssé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€æ ·å®šä¹‰çš„ï¼Ÿ"></a>18.Cssé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€æ ·å®šä¹‰çš„ï¼Ÿ</h3><p>å…³äºä¼˜å…ˆçº§çš„è§„å®šï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯ç»™ä¸åŒçš„é€‰æ‹©å™¨åˆ†é…æƒå€¼ï¼š</p><ul><li>idé€‰æ‹©å™¨ä¼˜å…ˆçº§å¾ˆé«˜ï¼Œæƒå€¼ä¸º100</li><li>classã€å±æ€§å’Œä¼ªç±»é€‰æ‹©å™¨çš„æƒå€¼ä¸º10</li><li>æ ‡ç­¾é€‰æ‹©å™¨æƒå€¼ä¸º1</li><li>åœ¨æ¯”è¾ƒæ ·å¼çš„ä¼˜å…ˆçº§æ—¶ï¼Œåªéœ€ç»Ÿè®¡é€‰æ‹©ç¬¦ä¸­çš„idã€classå’Œæ ‡ç­¾åçš„ä¸ªæ•°ï¼Œç„¶åæŠŠç›¸åº”çš„æƒå€¼ç›¸åŠ å³å¯ï¼Œæœ€åæ ¹æ®ç»“æœæ’å‡ºä¼˜å…ˆçº§</li><li>æƒå€¼è¾ƒå¤§çš„ä¼˜å…ˆçº§è¶Šé«˜</li><li>æƒå€¼ç›¸åŒçš„ï¼Œåå®šä¹‰çš„ä¼˜å…ˆçº§è¾ƒé«˜</li><li>æ ·å¼å€¼å«æœ‰<code>!important</code>ï¼Œä¼˜å…ˆçº§æœ€é«˜</li></ul><h3 id="19-è¶…é“¾æ¥è®¿é—®è¿‡åhoveræ ·å¼å°±ä¸å‡ºç°çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"><a href="#19-è¶…é“¾æ¥è®¿é—®è¿‡åhoveræ ·å¼å°±ä¸å‡ºç°çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="19.è¶…é“¾æ¥è®¿é—®è¿‡åhoveræ ·å¼å°±ä¸å‡ºç°çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"></a>19.è¶…é“¾æ¥è®¿é—®è¿‡åhoveræ ·å¼å°±ä¸å‡ºç°çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</h3><p>è¢«ç‚¹å‡»è®¿é—®è¿‡çš„è¶…é“¾æ¥æ ·å¼ä¸åœ¨å…·æœ‰hoverå’Œactiveäº†è§£å†³æ–¹æ³•æ˜¯æ”¹å˜CSSå±æ€§çš„æ’åˆ—é¡ºåº: L-V-H-Aï¼ˆlink,visited,hover,activeï¼‰</p><h3 id="20-è¡Œå†…æ ·å¼å’Œå—çº§å…ƒç´ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#20-è¡Œå†…æ ·å¼å’Œå—çº§å…ƒç´ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="20.è¡Œå†…æ ·å¼å’Œå—çº§å…ƒç´ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>20.è¡Œå†…æ ·å¼å’Œå—çº§å…ƒç´ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å—çº§å…ƒç´ ä¼šç‹¬å ä¸€è¡Œ,é»˜è®¤æƒ…å†µä¸‹,å…¶å®½åº¦è‡ªåŠ¨å¡«æ»¡å…¶çˆ¶å…ƒç´ å®½åº¦.<br>è¡Œå†…å…ƒç´ ä¸ä¼šç‹¬å ä¸€è¡Œ,ç›¸é‚»çš„è¡Œå†…å…ƒç´ ä¼šæ’åˆ—åœ¨åŒä¸€è¡Œé‡Œ,ç›´åˆ°ä¸€è¡Œæ’ä¸ä¸‹,æ‰ä¼šæ¢è¡Œ,å…¶å®½åº¦éšå…ƒç´ çš„å†…å®¹è€Œå˜åŒ–.<br>å—çº§å…ƒç´ å¯ä»¥è®¾ç½®width,heightå±æ€§.è¡Œå†…å…ƒç´ è®¾ç½®width,heightå±æ€§æ— æ•ˆ.</p><h3 id="20-è¡Œå†…å…ƒç´ å¯ä»¥çš„paddingå’Œmarginå¯è®¾ç½®ä¹ˆï¼Ÿ"><a href="#20-è¡Œå†…å…ƒç´ å¯ä»¥çš„paddingå’Œmarginå¯è®¾ç½®ä¹ˆï¼Ÿ" class="headerlink" title="20.è¡Œå†…å…ƒç´ å¯ä»¥çš„paddingå’Œmarginå¯è®¾ç½®ä¹ˆï¼Ÿ"></a>20.è¡Œå†…å…ƒç´ å¯ä»¥çš„paddingå’Œmarginå¯è®¾ç½®ä¹ˆï¼Ÿ</h3><p>åªèƒ½è®¾ç½®å·¦å³çš„paddingå’Œmarginã€‚</p><h3 id="21-Cssä¸­å¯ä»¥è®©æ–‡å­—åœ¨å‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±æ€§æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#21-Cssä¸­å¯ä»¥è®©æ–‡å­—åœ¨å‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±æ€§æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="21.Cssä¸­å¯ä»¥è®©æ–‡å­—åœ¨å‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±æ€§æ˜¯ä»€ä¹ˆï¼Ÿ"></a>21.Cssä¸­å¯ä»¥è®©æ–‡å­—åœ¨å‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</h3><pre><code class="css">text-align: center;vertical-align: middle;</code></pre><h3 id="22-Pxå’Œem-remçš„åŒºåˆ«ï¼Ÿ"><a href="#22-Pxå’Œem-remçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="22.Pxå’Œem,remçš„åŒºåˆ«ï¼Ÿ"></a>22.Pxå’Œem,remçš„åŒºåˆ«ï¼Ÿ</h3><p>pxåƒç´ ï¼ˆPixelï¼‰ã€‚ç›¸å¯¹é•¿åº¦å•ä½ã€‚åƒç´ pxæ˜¯ç›¸å¯¹äºæ˜¾ç¤ºå™¨å±å¹•åˆ†è¾¨ç‡è€Œè¨€çš„ã€‚(å¼•è‡ªCSS2.0æ‰‹å†Œ)</p><p>emæ˜¯ç›¸å¯¹é•¿åº¦å•ä½ã€‚ç›¸å¯¹äºå½“å‰å¯¹è±¡å†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸ã€‚å¦‚å½“å‰å¯¹è¡Œå†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸æœªè¢«äººä¸ºè®¾ç½®ï¼Œåˆ™ç›¸å¯¹äºæµè§ˆå™¨çš„é»˜è®¤å­—ä½“å°ºå¯¸ã€‚(å¼•è‡ªCSS2.0æ‰‹å†Œ)</p><p>EMç‰¹ç‚¹ </p><ol><li>emçš„å€¼å¹¶ä¸æ˜¯å›ºå®šçš„ï¼›</li><li>emä¼šç»§æ‰¿çˆ¶çº§å…ƒç´ çš„å­—ä½“å¤§å°ã€‚</li></ol><p>æ‰€ä»¥æˆ‘ä»¬åœ¨å†™CSSçš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š</p><ol><li><p>bodyé€‰æ‹©å™¨ä¸­å£°æ˜Font-size=62.5%ï¼›</p></li><li><p>å°†ä½ çš„åŸæ¥çš„pxæ•°å€¼é™¤ä»¥10ï¼Œç„¶åæ¢ä¸Šemä½œä¸ºå•ä½ï¼›</p></li><li><p>é‡æ–°è®¡ç®—é‚£äº›è¢«æ”¾å¤§çš„å­—ä½“çš„emæ•°å€¼ã€‚é¿å…å­—ä½“å¤§å°çš„é‡å¤å£°æ˜ã€‚</p></li></ol><p>remæ˜¯CSS3æ–°å¢çš„ä¸€ä¸ªç›¸å¯¹å•ä½ï¼ˆroot emï¼Œæ ¹emï¼‰ï¼Œè¿™ä¸ªå•ä½å¼•èµ·äº†å¹¿æ³›å…³æ³¨ã€‚è¿™ä¸ªå•ä½ä¸emæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p>åŒºåˆ«åœ¨äºä½¿ç”¨remä¸ºå…ƒç´ è®¾å®šå­—ä½“å¤§å°æ—¶ï¼Œä»ç„¶æ˜¯ç›¸å¯¹å¤§å°ï¼Œä½†ç›¸å¯¹çš„åªæ˜¯HTMLæ ¹å…ƒç´ ã€‚è¿™ä¸ªå•ä½å¯è°“é›†ç›¸å¯¹å¤§å°å’Œç»å¯¹å¤§å°çš„ä¼˜ç‚¹äºä¸€èº«ï¼Œé€šè¿‡å®ƒæ—¢å¯ä»¥åšåˆ°åªä¿®æ”¹æ ¹å…ƒç´ å°±æˆæ¯”ä¾‹åœ°è°ƒæ•´æ‰€æœ‰å­—ä½“å¤§å°ï¼Œåˆå¯ä»¥é¿å…å­—ä½“å¤§å°é€å±‚å¤åˆçš„è¿é”ååº”</p><h3 id="23-è¯´å‡ºä½ ç†Ÿæ‚‰çš„ä¸¤ä¸ªcssé¢„å¤„ç†å™¨çš„åŒºåˆ«ï¼ŸSassä¸less"><a href="#23-è¯´å‡ºä½ ç†Ÿæ‚‰çš„ä¸¤ä¸ªcssé¢„å¤„ç†å™¨çš„åŒºåˆ«ï¼ŸSassä¸less" class="headerlink" title="23.è¯´å‡ºä½ ç†Ÿæ‚‰çš„ä¸¤ä¸ªcssé¢„å¤„ç†å™¨çš„åŒºåˆ«ï¼ŸSassä¸less"></a>23.è¯´å‡ºä½ ç†Ÿæ‚‰çš„ä¸¤ä¸ªcssé¢„å¤„ç†å™¨çš„åŒºåˆ«ï¼ŸSassä¸less</h3><p>ä¸‹é¢ä»ç‰¹æ€§ä¸Šæ¯”è¾ƒä¸‰è€…å¼‚åŒï¼š<br>1.å˜é‡ï¼š</p><p>Sasså£°æ˜å˜é‡å¿…é¡»æ˜¯ã€$ã€å¼€å¤´ï¼Œåé¢ç´§è·Ÿå˜é‡åå’Œå˜é‡å€¼ï¼Œè€Œä¸”å˜é‡åå’Œå˜é‡å€¼éœ€è¦ä½¿ç”¨å†’å·ï¼šåˆ†éš”å¼€ã€‚<br>Less å£°æ˜å˜é‡ç”¨ã€@ã€å¼€å¤´ï¼Œå…¶ä½™ç­‰åŒ Sassã€‚<br>Stylus ä¸­å£°æ˜å˜é‡æ²¡æœ‰ä»»ä½•é™å®šï¼Œç»“å°¾çš„åˆ†å·å¯æœ‰å¯æ— ï¼Œä½†å˜é‡åå’Œå˜é‡å€¼ä¹‹é—´å¿…é¡»è¦æœ‰ã€ç­‰å·ã€ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç”¨â€œ@â€ç¬¦å·æ¥å£°æ˜å˜é‡ï¼ŒStylusä¼šè¿›è¡Œç¼–è¯‘ï¼Œä½†ä¸ä¼šèµ‹å€¼ç»™å˜é‡ã€‚å°±æ˜¯è¯´ï¼ŒStylus ä¸è¦ä½¿ç”¨ã€@ã€å£°æ˜å˜é‡ã€‚Stylus è°ƒç”¨å˜é‡çš„æ–¹æ³•å’ŒLessã€Sasså®Œå…¨ç›¸åŒã€‚<br>2.ä½œç”¨åŸŸï¼š</p><p>css é¢„ç¼–è¯‘å™¨æŠŠå˜é‡èµ‹äºˆä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨ç”Ÿå‘½å‘¨æœŸã€‚å°±åƒ js ä¸€æ ·ï¼Œå®ƒä¼šå…ˆä»å±€éƒ¨ä½œç”¨åŸŸæŸ¥æ‰¾å˜é‡ï¼Œä¾æ¬¡å‘ä¸Šçº§ä½œç”¨åŸŸæŸ¥æ‰¾ã€‚</p><p>Sassï¼šä¸‰è€…æœ€å·®ï¼Œä¸å­˜åœ¨å…¨å±€å˜é‡çš„æ¦‚å¿µã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ Sass ä¸­å®šä¹‰äº†ç›¸åŒåå­—çš„å˜é‡æ—¶ä½ å°±è¦å°å¿ƒè›‹ç–¼äº†ã€‚<br>Lessï¼šæˆ‘è®¤ä¸ºè·Ÿ JS ä¸€æ ·ï¼Œé€çº§æŸ¥æ‰¾ï¼Œå‘ä¸Šå†’æ³¡ã€‚<br>Stylusï¼šå®Œå…¨ç­‰åŒ Lessã€‚Stylus å’Œ Sass åˆ™æ›´å€¾å‘äºæŒ‡ä»¤å¼ã€‚</p><p>3.åµŒå¥—ï¼š</p><p>ååˆ†çœŸè¯šçš„è¯´ï¼Œä¸‰ç§ css é¢„ç¼–è¯‘å™¨çš„ã€Œé€‰æ‹©å™¨åµŒå¥—ã€åœ¨ä½¿ç”¨ä¸Šæ¥è¯´æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘æ²¡å‘ç°ï¼‰ã€‚Sass é™¤äº†å¸¸è§„çš„é‡‡ç”¨ã€&amp;ã€æ›¿ä»£çˆ¶çº§é€‰æ‹©å™¨ä¹‹å¤–ï¼Œè¿˜æä¾›äº†ã€Œå¥‡è‘©çš„å±æ€§åµŒå¥—ã€ï¼š</p><pre><code class="css">/*style.sass*/.footer {  font: {    family:  å¾®è½¯é›…é»‘;    size: 5rem;    weight: bolder;  }}</code></pre><p>4.ç»§æ‰¿ï¼š</p><p>css å±æ€§çš„ç»§æ‰¿æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œå¥½æ¶ˆæ¯æ˜¯ä¸‰ç§é¢„ç¼–è¯‘å™¨éƒ½å¯¹æ­¤åšå‡ºäº†æ”¹å–„ã€‚</p><p>Sasså’ŒStylusçš„ç»§æ‰¿éå¸¸åƒï¼Œèƒ½æŠŠä¸€ä¸ªé€‰æ‹©å™¨çš„æ‰€æœ‰æ ·å¼ç»§æ‰¿åˆ°å¦ä¸€ä¸ªé€‰æ‹©å™¨ä¸Šã€‚ä½¿ç”¨ã€@extendã€å¼€å§‹ï¼Œåé¢æ¥è¢«ç»§æ‰¿çš„é€‰æ‹©å™¨ã€‚</p><pre><code class="css">.shit {  margin: 10px 5px;  padding: 2px;}p {  @extend .shit;/*ç»§æ‰¿.block*/  border: 1px solid #aaa;}ul,li {  @extend .shit; /*ç»§æ‰¿.block*/  color: #aaa;}</code></pre><p>å°†è¢«ç¼–è¯‘æˆæ ‡å‡† cssï¼š</p><pre><code class="css">.shit,p,ul,ol {  margin: 10px 5px;  padding:2px;}p {  border: 1px solid #aaa}ul,li {  color:#aaa;}</code></pre><p>Less ç»§æ‰¿ï¼šä¸å‰ä¸¤è€…ç»§æ‰¿æ–¹å¼æœ‰æ‰€åŒºåˆ«ï¼Œå®ƒä¸æ˜¯åœ¨é€‰æ‹©å™¨ä¸Šç»§æ‰¿ï¼Œè€Œæ˜¯å°†Mixinsä¸­çš„æ ·å¼åµŒå¥—åˆ°æ¯ä¸ªé€‰æ‹©å™¨é‡Œé¢ã€‚ç„¶è€Œè¿™æ ·ä¼šå¸¦æ¥ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼šæ¯ä¸ªé€‰æ‹©å™¨ä¸­ä¼šå‡ºç°é‡å¤çš„æ ·å¼ã€‚</p><p>5.å¯¼å…¥@Importï¼š</p><p>CSSä¸­ï¼Œä¸å»ºè®®ç”¨@importå¯¼å…¥cssï¼Œå› ä¸ºä¼šå¢åŠ httpè¯·æ±‚ã€‚ä½† CSS é¢„å¤„ç†å™¨ä¸­çš„å¯¼å…¥å’ŒCSSçš„æœ‰hheå¾ˆå¤§åŒºåˆ«ï¼Œå®ƒæ˜¯å°†ä¸åŒ css æ˜¯åœ¨è¯­ä¹‰ä¸Šå¯¼å…¥ï¼Œæœ€ç»ˆç¼–è¯‘ç»“æœä¼šç”Ÿæˆä¸€ä¸ªCSSæ–‡ä»¶ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸åŒæ–‡ä»¶ç›¸äº’å¼•å…¥çš„æ—¶å€™ï¼Œå‡ºç°ç›¸åŒå˜é‡åæ—¶å¯èƒ½ä¼šå¼•èµ·é”™è¯¯ã€‚æ‰€ä»¥æˆ‘çš„å»ºè®®æ˜¯å•ç‹¬æœ‰ä¸€ä¸ª var.sass/less/styl æ–‡ä»¶æ¥è®°å½•æ‰€æœ‰ä½ å®šä¹‰çš„å˜é‡ã€‚</p><p>Less ä¸º@Import æ‰©å±•äº†è¯­æ³•ï¼Œè€Œ Sass å’Œ Stylus å¹¶æ²¡æœ‰ã€‚å…·ä½“æ‰©å±•çš„ import è¯­æ³•è¯·è§ï¼šLess çš„ Import æ‰©å±•</p><h3 id="24-â€œuser-strictâ€æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#24-â€œuser-strictâ€æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="24.â€œuser strictâ€æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>24.â€œuser strictâ€æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p>ã€€ã€€- æ¶ˆé™¤Javascriptè¯­æ³•çš„ä¸€äº›ä¸åˆç†ã€ä¸ä¸¥è°¨ä¹‹å¤„ï¼Œå‡å°‘ä¸€äº›æ€ªå¼‚è¡Œä¸º;</p><p>ã€€ã€€- æ¶ˆé™¤ä»£ç è¿è¡Œçš„ä¸€äº›ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç è¿è¡Œçš„å®‰å…¨ï¼›</p><p>ã€€ã€€- æé«˜ç¼–è¯‘å™¨æ•ˆç‡ï¼Œå¢åŠ è¿è¡Œé€Ÿåº¦ï¼›</p><p>ã€€ã€€- ä¸ºæœªæ¥æ–°ç‰ˆæœ¬çš„Javascriptåšå¥½é“ºå«ã€‚</p><h3 id="25-JavaScriptå¦‚ä½•å®ç°ç»§æ‰¿ï¼Ÿ"><a href="#25-JavaScriptå¦‚ä½•å®ç°ç»§æ‰¿ï¼Ÿ" class="headerlink" title="25.JavaScriptå¦‚ä½•å®ç°ç»§æ‰¿ï¼Ÿ"></a>25.JavaScriptå¦‚ä½•å®ç°ç»§æ‰¿ï¼Ÿ</h3><p><a href="http://www.cnblogs.com/humin/p/4556820.html" target="_blank" rel="noopener">ç»§æ‰¿</a></p><h3 id="26-å¯¹thisæŒ‡é’ˆçš„ç†è§£ï¼Œå¯ä»¥åˆ—ä¸¾å‡ ç§æƒ…å†µï¼Ÿ"><a href="#26-å¯¹thisæŒ‡é’ˆçš„ç†è§£ï¼Œå¯ä»¥åˆ—ä¸¾å‡ ç§æƒ…å†µï¼Ÿ" class="headerlink" title="26.å¯¹thisæŒ‡é’ˆçš„ç†è§£ï¼Œå¯ä»¥åˆ—ä¸¾å‡ ç§æƒ…å†µï¼Ÿ"></a>26.å¯¹thisæŒ‡é’ˆçš„ç†è§£ï¼Œå¯ä»¥åˆ—ä¸¾å‡ ç§æƒ…å†µï¼Ÿ</h3><p>thisæŒ‡çš„æ˜¯ï¼šè°ƒç”¨å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ã€‚</p><p>a. çº¯ç²¹çš„å‡½æ•°è°ƒç”¨ï¼Œå±äºå…¨å±€æ€§è°ƒç”¨ï¼Œå› æ­¤thiså°±ä»£è¡¨å…¨å±€å¯¹è±¡Globalã€‚</p><p>b. ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ï¼Œè¿™æ—¶thiså°±æŒ‡è¿™ä¸ªä¸Šçº§å¯¹è±¡ã€‚</p><p>c. ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨ï¼Œå°±æ˜¯é€šè¿‡è¿™ä¸ªå‡½æ•°newä¸€ä¸ªæ–°å¯¹è±¡ï¼ˆobjectï¼‰ã€‚è¿™æ—¶ï¼Œthiså°±æŒ‡è¿™ä¸ªæ–°å¯¹è±¡ã€‚</p><p>d. applyä¸callçš„è°ƒç”¨ï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯æ”¹å˜å‡½æ•°çš„è°ƒç”¨å¯¹è±¡ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å°±è¡¨ç¤ºæ”¹å˜åçš„è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„å¯¹è±¡ã€‚</p><h3 id="27-Mvvmæ¡†æ¶å’Œmvcæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#27-Mvvmæ¡†æ¶å’Œmvcæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="27.Mvvmæ¡†æ¶å’Œmvcæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>27.Mvvmæ¡†æ¶å’Œmvcæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h3><p>åœ¨MVCé‡Œï¼ŒViewæ˜¯å¯ä»¥ç›´æ¥è®¿é—®Modelçš„ï¼ä»è€Œï¼ŒViewé‡Œä¼šåŒ…å«Modelä¿¡æ¯ï¼Œä¸å¯é¿å…çš„è¿˜è¦åŒ…æ‹¬ä¸€äº›ä¸šåŠ¡é€»è¾‘ã€‚ MVCæ¨¡å‹å…³æ³¨çš„æ˜¯Modelçš„ä¸å˜ï¼Œæ‰€ä»¥ï¼Œåœ¨MVCæ¨¡å‹é‡Œï¼ŒModelä¸ä¾èµ–äºViewï¼Œä½†æ˜¯ Viewæ˜¯ä¾èµ–äºModelçš„ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå› ä¸ºæœ‰ä¸€äº›ä¸šåŠ¡é€»è¾‘åœ¨Viewé‡Œå®ç°äº†ï¼Œå¯¼è‡´è¦æ›´æ”¹Viewä¹Ÿæ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œè‡³å°‘é‚£äº›ä¸šåŠ¡é€»è¾‘æ˜¯æ— æ³•é‡ç”¨çš„ã€‚<br>MVVMåœ¨æ¦‚å¿µä¸Šæ˜¯çœŸæ­£å°†é¡µé¢ä¸æ•°æ®é€»è¾‘åˆ†ç¦»çš„æ¨¡å¼ï¼Œå®ƒæŠŠæ•°æ®ç»‘å®šå·¥ä½œæ”¾åˆ°ä¸€ä¸ªJSé‡Œå»å®ç°ï¼Œè€Œè¿™ä¸ªJSæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯å®Œæˆæ•°æ®çš„ç»‘å®šï¼Œå³æŠŠmodelç»‘å®šåˆ°UIçš„å…ƒç´ ä¸Šã€‚<br>æœ‰äººåšè¿‡æµ‹è¯•ï¼šä½¿ç”¨Angularï¼ˆMVVMï¼‰ä»£æ›¿Backboneï¼ˆMVCï¼‰æ¥å¼€å‘ï¼Œä»£ç å¯ä»¥å‡å°‘ä¸€åŠã€‚<br>æ­¤å¤–ï¼ŒMVVMå¦ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼ŒåŒå‘ç»‘å®šã€‚å®ƒæ›´æ–¹ä¾¿ä½ åŒæ—¶ç»´æŠ¤é¡µé¢ä¸Šéƒ½ä¾èµ–äºæŸä¸ªå­—æ®µçš„Nä¸ªåŒºåŸŸï¼Œè€Œä¸ç”¨æ‰‹åŠ¨æ›´æ–°å®ƒä»¬ã€‚</p><h3 id="28-å¦‚ä½•è·å–JavaScriptå˜é‡çš„ç±»å‹ï¼Ÿ"><a href="#28-å¦‚ä½•è·å–JavaScriptå˜é‡çš„ç±»å‹ï¼Ÿ" class="headerlink" title="28.å¦‚ä½•è·å–JavaScriptå˜é‡çš„ç±»å‹ï¼Ÿ"></a>28.å¦‚ä½•è·å–JavaScriptå˜é‡çš„ç±»å‹ï¼Ÿ</h3><p>1ã€typeof<br>typeof æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œå…¶å³ä¾§è·Ÿä¸€ä¸ªä¸€å…ƒè¡¨è¾¾å¼ï¼Œå¹¶è¿”å›è¿™ä¸ªè¡¨è¾¾å¼çš„æ•°æ®ç±»å‹ã€‚è¿”å›çš„ç»“æœç”¨è¯¥ç±»å‹çš„å­—ç¬¦ä¸²(å…¨å°å†™å­—æ¯)å½¢å¼è¡¨ç¤ºï¼ŒåŒ…æ‹¬ä»¥ä¸‹ 7 ç§ï¼šnumberã€booleanã€symbolã€stringã€objectã€undefinedã€function ç­‰ã€‚</p><p>2ã€instanceof<br>instanceof æ˜¯ç”¨æ¥åˆ¤æ–­ A æ˜¯å¦ä¸º B çš„å®ä¾‹ï¼Œè¡¨è¾¾å¼ä¸ºï¼šA instanceof Bï¼Œå¦‚æœ A æ˜¯ B çš„å®ä¾‹ï¼Œåˆ™è¿”å› true,å¦åˆ™è¿”å› falseã€‚ åœ¨è¿™é‡Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼šinstanceof æ£€æµ‹çš„æ˜¯åŸå‹ï¼Œæˆ‘ä»¬ç”¨ä¸€æ®µä¼ªä»£ç æ¥æ¨¡æ‹Ÿå…¶å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼š</p><pre><code class="js">instanceof (A,B) = {    var L = A.__proto__;    var R = B.prototype;    if(L === R) {        // Açš„å†…éƒ¨å±æ€§ __proto__ æŒ‡å‘ B çš„åŸå‹å¯¹è±¡        return true;    }    return false;}</code></pre><p>3ã€constructor<br>å½“ä¸€ä¸ªå‡½æ•° Fè¢«å®šä¹‰æ—¶ï¼ŒJSå¼•æ“ä¼šä¸ºFæ·»åŠ  prototype åŸå‹ï¼Œç„¶åå†åœ¨ prototypeä¸Šæ·»åŠ ä¸€ä¸ª constructor å±æ€§ï¼Œå¹¶è®©å…¶æŒ‡å‘ F çš„å¼•ç”¨ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://images2015.cnblogs.com/blog/849589/201705/849589-20170508125250566-1896556617.png" alt="constructor"></p><p>å¯ä»¥çœ‹å‡ºï¼ŒF åˆ©ç”¨åŸå‹å¯¹è±¡ä¸Šçš„ constructor å¼•ç”¨äº†è‡ªèº«ï¼Œå½“ F ä½œä¸ºæ„é€ å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒåŸå‹ä¸Šçš„ constructor å°±è¢«é—ä¼ åˆ°äº†æ–°åˆ›å»ºçš„å¯¹è±¡ä¸Šï¼Œ ä»åŸå‹é“¾è§’åº¦è®²ï¼Œæ„é€ å‡½æ•° F å°±æ˜¯æ–°å¯¹è±¡çš„ç±»å‹ã€‚è¿™æ ·åšçš„æ„ä¹‰æ˜¯ï¼Œè®©æ–°å¯¹è±¡åœ¨è¯ç”Ÿä»¥åï¼Œå°±å…·æœ‰å¯è¿½æº¯çš„æ•°æ®ç±»å‹ã€‚</p><blockquote><ol><li>null å’Œ undefined æ˜¯æ— æ•ˆçš„å¯¹è±¡ï¼Œå› æ­¤æ˜¯ä¸ä¼šæœ‰ constructor å­˜åœ¨çš„ï¼Œè¿™ä¸¤ç§ç±»å‹çš„æ•°æ®éœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼æ¥åˆ¤æ–­ã€‚</li><li>å‡½æ•°çš„ constructor æ˜¯ä¸ç¨³å®šçš„ï¼Œè¿™ä¸ªä¸»è¦ä½“ç°åœ¨è‡ªå®šä¹‰å¯¹è±¡ä¸Šï¼Œå½“å¼€å‘è€…é‡å†™ prototype åï¼ŒåŸæœ‰çš„ constructor å¼•ç”¨ä¼šä¸¢å¤±ï¼Œconstructor ä¼šé»˜è®¤ä¸º Object</li></ol></blockquote><p>4ã€toString<br>toString() æ˜¯ Object çš„åŸå‹æ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ï¼Œé»˜è®¤è¿”å›å½“å‰å¯¹è±¡çš„ [[Class]] ã€‚è¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å±æ€§ï¼Œå…¶æ ¼å¼ä¸º [object Xxx] ï¼Œå…¶ä¸­ Xxx å°±æ˜¯å¯¹è±¡çš„ç±»å‹ã€‚</p><p>å¯¹äº Object å¯¹è±¡ï¼Œç›´æ¥è°ƒç”¨ toString()  å°±èƒ½è¿”å› [object Object] ã€‚è€Œå¯¹äºå…¶ä»–å¯¹è±¡ï¼Œåˆ™éœ€è¦é€šè¿‡ call / apply æ¥è°ƒç”¨æ‰èƒ½è¿”å›æ­£ç¡®çš„ç±»å‹ä¿¡æ¯ã€‚</p><h3 id="29-JavaScriptå¦‚ä½•æ¨¡æ‹Ÿå—çº§ä½œç”¨åŸŸï¼Ÿ"><a href="#29-JavaScriptå¦‚ä½•æ¨¡æ‹Ÿå—çº§ä½œç”¨åŸŸï¼Ÿ" class="headerlink" title="29.JavaScriptå¦‚ä½•æ¨¡æ‹Ÿå—çº§ä½œç”¨åŸŸï¼Ÿ"></a>29.JavaScriptå¦‚ä½•æ¨¡æ‹Ÿå—çº§ä½œç”¨åŸŸï¼Ÿ</h3><p>ç”¨åŒ¿åçš„å‡½æ•°è¡¨è¾¾å¼ç«‹å³æ‰§è¡Œ çš„æ–¹å¼æ¥ æ¨¡ä»¿å—çº§ä½œç”¨åŸŸ </p><pre><code class="js">(function() { // è¿™é‡Œæ˜¯å—çº§ä½œç”¨åŸŸ })(); </code></pre><p>è¿™æ ·å°±æ˜¯ç§æœ‰ä½œç”¨åŸŸï¼Œåœ¨åŒ¿åå‡½æ•°ä¸­å®šä¹‰çš„ç§æœ‰å˜é‡ï¼Œéƒ½ä¼šåœ¨æ‰§è¡Œç»“æŸæ—¶è¢«é”€æ¯ã€‚åœ¨ä¸€ä¸ªç”±å¾ˆå¤šå¼€å‘äººå‘˜å…±åŒå‚ä¸çš„å¤§å‹åº”ç”¨ç¨‹åºä¸­ï¼Œè¿‡å¤šçš„å…¨å±€å˜é‡å’Œå‡½æ•°å¾ˆå®¹æ˜“å¯¼è‡´å‘½åå†²çªã€‚è€Œé€šè¿‡åˆ›å»ºç§æœ‰ä½œç”¨åŸŸï¼Œæ¯ä¸ªå¼€å‘äººå‘˜æ—¢å¯ä»¥ä½¿ç”¨è‡ªå·±çš„å˜é‡ï¼Œåˆä¸å¿…æ‹…å¿ƒæä¹±å…¨å±€ä½œç”¨åŸŸã€‚ </p><h3 id="30-JavaScriptå¦‚ä½•æ¨¡æ‹Ÿç§æœ‰å˜é‡ï¼Ÿ"><a href="#30-JavaScriptå¦‚ä½•æ¨¡æ‹Ÿç§æœ‰å˜é‡ï¼Ÿ" class="headerlink" title="30.JavaScriptå¦‚ä½•æ¨¡æ‹Ÿç§æœ‰å˜é‡ï¼Ÿ"></a>30.JavaScriptå¦‚ä½•æ¨¡æ‹Ÿç§æœ‰å˜é‡ï¼Ÿ</h3><p><strong>åŸºäºé—­åŒ…çš„å®ç°æ–¹å¼</strong><br>å¦å¤–ä¸€ç§æ¯”è¾ƒæ™®éçš„æ–¹å¼æ˜¯åˆ©ç”¨JavaScriptçš„é—­åŒ…ç‰¹æ€§ã€‚æ„é€ å‡½æ•°å†…å®šä¹‰å±€éƒ¨å˜é‡å’Œç‰¹æƒå‡½æ•°ï¼Œå…¶å®ä¾‹åªèƒ½é€šè¿‡ç‰¹æƒå‡½æ•°è®¿é—®æ­¤å˜é‡ï¼Œå¦‚ä¸‹ï¼š</p><pre><code class="js">function Person(name){  var _name = name;  this.getName = function(){    return _name;  }}</code></pre><pre><code class="js">var person = new Person(&#39;Joe&#39;);</code></pre><p>è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å®ç°äº†ç§æœ‰å±æ€§çš„éšè—ï¼ŒPerson çš„å®ä¾‹å¹¶ä¸èƒ½ç›´æ¥è®¿é—®_nameå±æ€§ï¼Œåªèƒ½é€šè¿‡ç‰¹æƒå‡½æ•°getNameè·å–ï¼š</p><pre><code class="js">alert(person._name); // undefinedalert(person.getName()); //&#39;Joe&#39;</code></pre><p>ä½¿ç”¨é—­åŒ…å’Œç‰¹æƒå‡½æ•°å®ç°ç§æœ‰å±æ€§çš„å®šä¹‰å’Œè®¿é—®æ˜¯å¾ˆå¤šå¼€å‘è€…é‡‡ç”¨çš„æ–¹å¼ï¼ŒDouglas Crockfordä¹Ÿæ›¾åœ¨åšå®¢ä¸­æåˆ°è¿‡è¿™ç§æ–¹å¼ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨ä¸€äº›ç¼ºé™·ï¼š</p><p><strong>ç§æœ‰å˜é‡å’Œç‰¹æƒå‡½æ•°åªèƒ½åœ¨æ„é€ å‡½æ•°ä¸­åˆ›å»ºã€‚é€šå¸¸æ¥è®²ï¼Œæ„é€ å‡½æ•°çš„åŠŸèƒ½åªè´Ÿè´£åˆ›å»ºæ–°å¯¹è±¡ï¼Œæ–¹æ³•åº”è¯¥å…±äº«äºprototypeä¸Šã€‚ç‰¹æƒå‡½æ•°æœ¬è´¨ä¸Šæ˜¯å­˜åœ¨äºæ¯ä¸ªå®ä¾‹ä¸­çš„ï¼Œè€Œä¸æ˜¯prototypeä¸Šï¼Œå¢åŠ äº†èµ„æºå ç”¨</strong>ã€‚</p><h3 id="31-Callï¼ˆï¼‰å’Œapplyï¼ˆï¼‰çš„åŒºåˆ«ï¼Ÿ"><a href="#31-Callï¼ˆï¼‰å’Œapplyï¼ˆï¼‰çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="31.Callï¼ˆï¼‰å’Œapplyï¼ˆï¼‰çš„åŒºåˆ«ï¼Ÿ"></a>31.Callï¼ˆï¼‰å’Œapplyï¼ˆï¼‰çš„åŒºåˆ«ï¼Ÿ</h3><p>call å’Œ apply å°±æ˜¯ä¸ºäº†æ”¹å˜å‡½æ•°ä½“å†…éƒ¨ this çš„æŒ‡å‘ã€‚</p><p>åŒºåˆ«æ˜¯ä»ç¬¬äºŒä¸ªå‚æ•°èµ·ï¼Œcall éœ€è¦æŠŠå‚æ•°æŒ‰é¡ºåºä¼ é€’è¿›å»ï¼Œè€Œ apply åˆ™æ˜¯æŠŠå‚æ•°æ”¾åœ¨æ•°ç»„é‡Œã€‚</p><p>å½“å‚æ•°æ˜ç¡®æ—¶ç”¨callä¸applyéƒ½è¡Œ, å½“å‚æ•°ä¸æ˜ç¡®æ—¶å¯ç”¨applyç»™åˆarguments</p><h3 id="32-getå’Œpostçš„åŒºåˆ«ï¼Ÿ"><a href="#32-getå’Œpostçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="32.getå’Œpostçš„åŒºåˆ«ï¼Ÿ"></a>32.getå’Œpostçš„åŒºåˆ«ï¼Ÿ</h3><p>GETåé€€æŒ‰é’®/åˆ·æ–°æ— å®³ï¼ŒPOSTæ•°æ®ä¼šè¢«é‡æ–°æäº¤ï¼ˆæµè§ˆå™¨åº”è¯¥å‘ŠçŸ¥ç”¨æˆ·æ•°æ®ä¼šè¢«é‡æ–°æäº¤ï¼‰ã€‚GETä¹¦ç­¾å¯æ”¶è—ï¼ŒPOSTä¸ºä¹¦ç­¾ä¸å¯æ”¶è—ã€‚GETèƒ½è¢«ç¼“å­˜ï¼ŒPOSTä¸èƒ½ç¼“å­˜ ã€‚GETç¼–ç ç±»å‹application/x-www-form-urlï¼ŒPOSTç¼–ç ç±»å‹encodedapplication/x-www-form-urlencoded æˆ– multipart/form-dataã€‚ä¸ºäºŒè¿›åˆ¶æ•°æ®ä½¿ç”¨å¤šé‡ç¼–ç ã€‚GETå†å²å‚æ•°ä¿ç•™åœ¨æµè§ˆå™¨å†å²ä¸­ã€‚POSTå‚æ•°ä¸ä¼šä¿å­˜åœ¨æµè§ˆå™¨å†å²ä¸­ã€‚GETå¯¹æ•°æ®é•¿åº¦æœ‰é™åˆ¶ï¼Œå½“å‘é€æ•°æ®æ—¶ï¼ŒGET æ–¹æ³•å‘ URL æ·»åŠ æ•°æ®ï¼›URL çš„é•¿åº¦æ˜¯å—é™åˆ¶çš„ï¼ˆURL çš„æœ€å¤§é•¿åº¦æ˜¯ 2048 ä¸ªå­—ç¬¦ï¼‰ã€‚POSTæ— é™åˆ¶ã€‚GETåªå…è®¸ ASCII å­—ç¬¦ã€‚POSTæ²¡æœ‰é™åˆ¶ã€‚ä¹Ÿå…è®¸äºŒè¿›åˆ¶æ•°æ®ã€‚ä¸ POST ç›¸æ¯”ï¼ŒGET çš„å®‰å…¨æ€§è¾ƒå·®ï¼Œå› ä¸ºæ‰€å‘é€çš„æ•°æ®æ˜¯ URL çš„ä¸€éƒ¨åˆ†ã€‚åœ¨å‘é€å¯†ç æˆ–å…¶ä»–æ•æ„Ÿä¿¡æ¯æ—¶ç»ä¸è¦ä½¿ç”¨ GET ï¼POST æ¯” GET æ›´å®‰å…¨ï¼Œå› ä¸ºå‚æ•°ä¸ä¼šè¢«ä¿å­˜åœ¨æµè§ˆå™¨å†å²æˆ– web æœåŠ¡å™¨æ—¥å¿—ä¸­ã€‚GETçš„æ•°æ®åœ¨ URL ä¸­å¯¹æ‰€æœ‰äººéƒ½æ˜¯å¯è§çš„ã€‚POSTçš„æ•°æ®ä¸ä¼šæ˜¾ç¤ºåœ¨ URL ä¸­ã€‚</p><h3 id="33-æè¿°ä¸‹æ ‡å‡†ç›’æ¨¡å‹ï¼Ÿ"><a href="#33-æè¿°ä¸‹æ ‡å‡†ç›’æ¨¡å‹ï¼Ÿ" class="headerlink" title="33.æè¿°ä¸‹æ ‡å‡†ç›’æ¨¡å‹ï¼Ÿ"></a>33.æè¿°ä¸‹æ ‡å‡†ç›’æ¨¡å‹ï¼Ÿ</h3><ul><li>content-boxï¼ˆæ ‡å‡†ç›’æ¨¡å‹ï¼‰</li></ul><p>width = å†…å®¹çš„å®½åº¦</p><p>height = å†…å®¹çš„é«˜åº¦</p><ul><li>border-boxï¼ˆæ€ªå¼‚ç›’æ¨¡å‹ï¼‰</li></ul><p>width = border + padding + å†…å®¹çš„å®½åº¦</p><p>height = border + padding + å†…å®¹çš„é«˜åº¦</p><h3 id="34-Css3æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ"><a href="#34-Css3æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ" class="headerlink" title="34.Css3æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ"></a>34.Css3æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ</h3><ol><li>CSS3å®ç°åœ†è§’ï¼ˆborder-radiusï¼‰ï¼Œé˜´å½±ï¼ˆbox-shadowï¼‰ï¼Œ</li><li>å¯¹æ–‡å­—åŠ ç‰¹æ•ˆï¼ˆtext-shadowã€ï¼‰ï¼Œçº¿æ€§æ¸å˜ï¼ˆgradientï¼‰ï¼Œæ—‹è½¬ï¼ˆtransformï¼‰</li><li>transform:rotate(9deg) scale(0.85,0.90) translate(0px,-30px) skew(-9deg,0deg);// æ—‹è½¬,ç¼©æ”¾,å®šä½,å€¾æ–œ</li><li>å¢åŠ äº†æ›´å¤šçš„CSSé€‰æ‹©å™¨  å¤šèƒŒæ™¯ rgba </li><li>åœ¨CSS3ä¸­å”¯ä¸€å¼•å…¥çš„ä¼ªå…ƒç´ æ˜¯ ::selection.</li><li>åª’ä½“æŸ¥è¯¢ï¼Œå¤šæ å¸ƒå±€</li><li>border-image</li></ol><h3 id="35-æ–‡æ¡£æµ"><a href="#35-æ–‡æ¡£æµ" class="headerlink" title="35.æ–‡æ¡£æµ"></a>35.æ–‡æ¡£æµ</h3><p>å°†çª—ä½“è‡ªä¸Šè€Œä¸‹åˆ†æˆä¸€è¡Œè¡Œ, å¹¶åœ¨æ¯è¡Œä¸­æŒ‰ä»å·¦è‡³å³çš„é¡ºåºæ’æ”¾å…ƒç´ ,å³ä¸ºæ–‡æ¡£æµ.(è‡ªå·±çš„ç†è§£æ˜¯ä»å¤´åˆ°å°¾æŒ‰ç…§æ–‡æ¡£çš„é¡ºåºï¼Œè¯¥åœ¨ä»€ä¹ˆä½ç½®å°±åœ¨ä»€ä¹ˆä½ç½®ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§ä¸Šé¢çš„æ„æ€ç†è§£ï¼Œè‡ªä¸Šè€Œä¸‹ï¼Œè‡ªå·¦åˆ°å³çš„é¡ºåº)ã€‚æ–‡æ¡£æµæ˜¯æ–‡æ¡£ä¸­å¯æ˜¾ç¤ºå¯¹è±¡ åœ¨æ’åˆ—æ—¶æ‰€å ç”¨çš„ä½ç½®ã€‚</p><h3 id="36-åœ¨ç§»åŠ¨ç«¯ä¸pcç«¯åšé¡¹ç›®æœ‰ä»€ä¹ˆåŒºåˆ«-Onäº‹ä»¶çš„ä¸åŒ-ï¼›å…ˆè¯´å¸ƒå±€æ–¹é¢ï¼š"><a href="#36-åœ¨ç§»åŠ¨ç«¯ä¸pcç«¯åšé¡¹ç›®æœ‰ä»€ä¹ˆåŒºåˆ«-Onäº‹ä»¶çš„ä¸åŒ-ï¼›å…ˆè¯´å¸ƒå±€æ–¹é¢ï¼š" class="headerlink" title="36.åœ¨ç§»åŠ¨ç«¯ä¸pcç«¯åšé¡¹ç›®æœ‰ä»€ä¹ˆåŒºåˆ«?Onäº‹ä»¶çš„ä¸åŒ ï¼›å…ˆè¯´å¸ƒå±€æ–¹é¢ï¼š"></a>36.åœ¨ç§»åŠ¨ç«¯ä¸pcç«¯åšé¡¹ç›®æœ‰ä»€ä¹ˆåŒºåˆ«?Onäº‹ä»¶çš„ä¸åŒ ï¼›å…ˆè¯´å¸ƒå±€æ–¹é¢ï¼š</h3><ol><li>jsäº‹ä»¶ä¸åŒï¼šclickäº‹ä»¶åœ¨ç§»åŠ¨ç«¯ååº”æœ‰300mså»¶è¿Ÿï¼Œç‚¹å‡»ååº”æ…¢è¿˜ä¼šå‡ºç°ç‚¹é€çš„bugã€‚åº”å°è¯•ä½¿ç”¨touchäº‹ä»¶ï¼Œæˆ–è€…ä½¿ç”¨fastclick.jsåº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨zeptojsä¸­çš„tapäº‹ä»¶ã€‚</li><li>è°ƒè¯•é¡µé¢ï¼šä½¿ç”¨chromeçš„æ¨¡æ‹Ÿç§»åŠ¨ç«¯å·¥å…·ï¼Œæœ‰æ—¶è¿˜è¦ä½¿ç”¨erudaã€weinreçœŸæœºè°ƒè¯•å·¥å…·ã€‚å¾®ä¿¡å¼€å‘æˆ–è€…å°ç¨‹åºè¯·é€‰æ‹©å¾®ä¿¡å¼€å‘è€…å·¥å…·ã€‚</li><li>éœ€è¦è®¾ç½®viewportï¼šåœ¨headeré‡Œä½¿ç”¨<code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, user-scalable=no&quot;&gt;</code>æ¥æ§åˆ¶å±å¹•å…¨å±æ˜¾ç¤ºï¼Œä¸”ä¸èƒ½è¢«ç¼©æ”¾ã€‚</li><li>å­—ä½“è§„åˆ™ï¼špcç«¯ä½¿ç”¨çš„pxåœ¨ç§»åŠ¨å±å¹•ä¸Šä¸èƒ½å¾ˆå¥½çš„é€‚åº”å¤šåˆ†è¾¨ç‡ï¼Œç§»åŠ¨ç«¯æ”¹ç”¨remå­—ä½“å•ä½ã€‚ä»¤ <code>html{ font-size:62.5%; }</code>ï¼Œåˆ™1rem=10pxã€‚ç„¶åä½¿ç”¨css3çš„åª’ä½“æŸ¥è¯¢æ§åˆ¶ä¸åŒåˆ†è¾¨ç‡ä¸‹htmlæ˜¾ç¤ºçš„å€æ•°ã€‚</li><li>æœ€å°ç‚¹å‡»åŒºåŸŸ44pxï¼šç§»åŠ¨ç«¯æ˜¯æœ‰æœ€å°ç‚¹å‡»è¯†åˆ«åŒºçš„ï¼Œå…ƒç´ å¤§å°ä½äºè¿™ä¸ªå€¼æ—¶è¢«ç‚¹å‡»æ˜¯ä¸ä¼šè§¦å‘clickäº‹ä»¶çš„ã€‚ </li><li>å¯ä»¥è°ƒç”¨ç¡¬ä»¶åŠŸèƒ½ï¼šå¯ä»¥é€šè¿‡è®¾ç½®aæ ‡ç­¾hrefç±»å‹æ¥å®ç°æ‹¨æ‰“ç”µè¯ã€å‘é€çŸ­ä¿¡å’Œé‚®ä»¶ç­‰åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡<code>&lt;input type=&quot;file&quot;&gt;</code>çš„accept å±æ€§ï¼Œè°ƒç”¨æœ¬åœ°å›¾ç‰‡æˆ–æ‹ç…§ã€‚è¿˜å¯ä»¥ä½¿ç”¨html5çš„è¿åŠ¨ä¼ æ„Ÿå™¨æ•°æ®äº‹ä»¶å®ç°å¾®ä¿¡æ‘‡ä¸€æ‘‡åŠŸèƒ½ã€‚</li></ol><h3 id="37-ä»€ä¹ˆé¢å‘å¯¹è±¡"><a href="#37-ä»€ä¹ˆé¢å‘å¯¹è±¡" class="headerlink" title="37.ä»€ä¹ˆé¢å‘å¯¹è±¡"></a>37.ä»€ä¹ˆé¢å‘å¯¹è±¡</h3><p>é¢å‘å¯¹è±¡çš„ä¸‰ä¸ªåŸºæœ¬ç‰¹å¾æ˜¯ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€‚</p><h3 id="38-Html5æœ‰å“ªäº›æ ‡ç­¾ï¼š"><a href="#38-Html5æœ‰å“ªäº›æ ‡ç­¾ï¼š" class="headerlink" title="38.Html5æœ‰å“ªäº›æ ‡ç­¾ï¼š"></a>38.Html5æœ‰å“ªäº›æ ‡ç­¾ï¼š</h3><p>headerã€footerã€sectionã€navã€audioã€canvas</p><h3 id="37-ä¸€ä¸ªé¡µé¢ä»è¾“å…¥URLåˆ°é¡µé¢åŠ è½½æ˜¾ç¤ºå®Œæˆï¼Œè¿™ä¸ªè¿‡ç¨‹éƒ½å‘ç”Ÿä»€ä¹ˆ"><a href="#37-ä¸€ä¸ªé¡µé¢ä»è¾“å…¥URLåˆ°é¡µé¢åŠ è½½æ˜¾ç¤ºå®Œæˆï¼Œè¿™ä¸ªè¿‡ç¨‹éƒ½å‘ç”Ÿä»€ä¹ˆ" class="headerlink" title="37.ä¸€ä¸ªé¡µé¢ä»è¾“å…¥URLåˆ°é¡µé¢åŠ è½½æ˜¾ç¤ºå®Œæˆï¼Œè¿™ä¸ªè¿‡ç¨‹éƒ½å‘ç”Ÿä»€ä¹ˆ"></a>37.ä¸€ä¸ªé¡µé¢ä»è¾“å…¥URLåˆ°é¡µé¢åŠ è½½æ˜¾ç¤ºå®Œæˆï¼Œè¿™ä¸ªè¿‡ç¨‹éƒ½å‘ç”Ÿä»€ä¹ˆ</h3><p>1ã€é¦–å…ˆï¼Œåœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥url<br>2ã€æµè§ˆå™¨å…ˆæŸ¥çœ‹æµè§ˆå™¨ç¼“å­˜-ç³»ç»Ÿç¼“å­˜-è·¯ç”±å™¨ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜ä¸­æœ‰ï¼Œä¼šç›´æ¥åœ¨å±å¹•ä¸­æ˜¾ç¤ºé¡µé¢å†…å®¹ã€‚è‹¥æ²¡æœ‰ï¼Œåˆ™è·³åˆ°ç¬¬ä¸‰æ­¥æ“ä½œã€‚<br>3ã€åœ¨å‘é€httpè¯·æ±‚å‰ï¼Œéœ€è¦åŸŸåè§£æ(DNSè§£æ)ï¼Œè§£æè·å–ç›¸åº”çš„IPåœ°å€ã€‚<br>4ã€æµè§ˆå™¨å‘æœåŠ¡å™¨å‘èµ·tcpè¿æ¥ï¼Œä¸æµè§ˆå™¨å»ºç«‹tcpä¸‰æ¬¡æ¡æ‰‹ã€‚<br>5ã€æ¡æ‰‹æˆåŠŸåï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€httpè¯·æ±‚ï¼Œè¯·æ±‚æ•°æ®åŒ…ã€‚<br>6ã€æœåŠ¡å™¨å¤„ç†æ”¶åˆ°çš„è¯·æ±‚ï¼Œå°†æ•°æ®è¿”å›è‡³æµè§ˆå™¨<br>7ã€æµè§ˆå™¨æ”¶åˆ°HTTPå“åº”<br>8ã€è¯»å–é¡µé¢å†…å®¹ï¼Œæµè§ˆå™¨æ¸²æŸ“ï¼Œè§£æhtmlæºç <br>9ã€ç”ŸæˆDomæ ‘ã€è§£æcssæ ·å¼ã€jsäº¤äº’<br>10ã€å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤äº’<br>11ã€ajaxæŸ¥è¯¢</p>]]></content>
      
      
      <categories>
          
          <category> Interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Interview </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jsé¢è¯•é¢˜æ±‡æ€»</title>
      <link href="/2018/03/12/Interview/js%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB/"/>
      <url>/2018/03/12/Interview/js%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿé—­åŒ…çš„ç”¨å¤„ã€‚"><a href="#é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿé—­åŒ…çš„ç”¨å¤„ã€‚" class="headerlink" title="é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿé—­åŒ…çš„ç”¨å¤„ã€‚"></a>é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿé—­åŒ…çš„ç”¨å¤„ã€‚</h2><p> é—­åŒ…æ˜¯å†…éƒ¨å‡½æ•°å¯¹å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸçš„å¼•ç”¨ã€‚è€Œåœ¨å‡½æ•°å¤–éƒ¨å¼•ç”¨å‡½æ•°å†…éƒ¨å˜é‡ï¼Œå¯ä»¥é€šè¿‡é—­åŒ…å®ç°ã€‚é—­åŒ…çš„ç”¨å¤„å¾€å¾€æ˜¯åœ¨æ¨¡å—å°è£…çš„æ—¶å€™ã€‚å¯ä»¥å°†æ¨¡å—å†…éƒ¨å…¬æœ‰éƒ¨åˆ†æš´éœ²å‡ºæ¥ã€‚(é—­åŒ…æ˜¯åŸºç¡€æ€§çš„é—®é¢˜ï¼Œè¿™é‡Œåªæ˜¯ç®€è¦çš„é˜è¿°äº†ä¸€ä¸‹å®ƒçš„æ¦‚å¿µ) <a href="http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html" target="_blank" rel="noopener">é—­åŒ…è¯¦è§£(é˜®ä¸€å³°)</a></p><h2 id="åŸå‹ä»¥åŠåŸå‹é“¾"><a href="#åŸå‹ä»¥åŠåŸå‹é“¾" class="headerlink" title="åŸå‹ä»¥åŠåŸå‹é“¾"></a>åŸå‹ä»¥åŠåŸå‹é“¾</h2><p>jsä¸å¸¸ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¸ä¸€æ ·ï¼Œä»–æ˜¯é åŸå‹ç»§æ‰¿çš„ï¼Œå¹¶ä¸æ˜¯ç±»ã€‚ä½¿ç”¨é€ é›¶ä»¶çš„æ–¹å¼è¿›è¡Œç±»æ¯”ï¼Œé€šè¿‡ç±»ç»§æ‰¿çš„æ–¹å¼å°±æ˜¯é€šè¿‡ä¸€ä¸ªæ¨¡å‹ç›’é“¸ä»¶ï¼Œè€ŒåŸå‹çš„æ–¹å¼ï¼Œåˆ™æ˜¯ä»å¦ä¸€ä¸ªé›¶ä»¶å…‹éš†ä¸€ä»½ï¼Œåœ¨è¿™åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ã€‚è€Œé‚£ä»½è¢«å…‹éš†çš„é›¶ä»¶å°±æ˜¯åŸå‹ <a href="https://segmentfault.com/a/1190000000662547" target="_blank" rel="noopener">åŸå‹åŠåŸå‹é“¾è¯¦è§£</a>ã€‚åŸå‹é“¾å°±æ˜¯å®ƒä»¬ä¹‹é—´äº§ç”Ÿçš„è”ç³»ï¼Œå¾€å¾€å¯ä»¥é€šè¿‡ç”»å›¾æ¥é˜è¿°ï¼š<br><img src="https://camo.githubusercontent.com/2e0aa05f5710b00399841b284e41de3f5c866a0b/687474703a2f2f6f6966737635696a692e626b742e636c6f7564646e2e636f6d2f70726f746f747970652e706e67" alt="protype"></p><h2 id="åƒåœ¾å›æ”¶æœºåˆ¶å’Œå†…å­˜æ³„æ¼"><a href="#åƒåœ¾å›æ”¶æœºåˆ¶å’Œå†…å­˜æ³„æ¼" class="headerlink" title="åƒåœ¾å›æ”¶æœºåˆ¶å’Œå†…å­˜æ³„æ¼"></a>åƒåœ¾å›æ”¶æœºåˆ¶å’Œå†…å­˜æ³„æ¼</h2><p>jså¼•æ“æœ‰è‡ªå·±çš„ä¸€å¥—åƒåœ¾å›æ”¶çš„æœºåˆ¶ï¼Œä¸»è¦çš„å›æ”¶æœºåˆ¶æœ‰ä¸¤ç§æ ‡è®°æ¸…é™¤å’Œå¾ªç¯å¼•ç”¨ã€‚æ ‡è®°æ¸…é™¤ï¼Œå³æ˜¯åœ¨å±€éƒ¨å˜é‡åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æ‰“ä¸Šæ ‡è®°ï¼Œä¸€æ—¦ç¦»å¼€äº†æ‰§è¡Œç¯å¢ƒï¼Œæ ‡è®°å°†ä¼šè¢«æ¸…é™¤ï¼Œè¿™æ˜¯åƒåœ¾å›æ”¶å™¨å°†ä¼šçŸ¥é“ï¼Œè¯¥å˜é‡å·²ç»ä¸ä½¿ç”¨ï¼Œå¯å›æ”¶ã€‚è€Œå¾ªç¯å¼•ç”¨æ˜¯åœ¨è¾ƒæ—©ç‰ˆæœ¬çš„IEæµè§ˆå™¨ä¸­è¢«ä½¿ç”¨ï¼Œå³åˆå§‹åŒ–çš„å˜é‡å¼•ç”¨æ•°ä¸º0ï¼Œä¸€æ—¦è¢«èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œå¼•ç”¨å°±åŠ 1ï¼›è€Œå¦ä¸€ä¸ªå˜é‡ä¸€æ—¦è¢«èµ‹äºˆå…¶ä»–å€¼ï¼Œåˆ™è¯¥å€¼çš„å¼•ç”¨æ•°å‡ä¸€ã€‚åƒåœ¾å›æ”¶å™¨ä¼šå»åˆ¤æ–­è¯¥å˜é‡çš„å¼•ç”¨æ•°æ˜¯å¦ä¸º0ï¼Œä¸º0ï¼Œåˆ™ä¼šè¢«å›æ”¶æ‰ã€‚è¿™ä¸ªæœºåˆ¶ä¼šå­˜åœ¨å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œå³ä¸¤ä¸ªå˜é‡ç›¸äº’å¼•ç”¨ã€‚<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Memory_Management" target="_blank" rel="noopener">åƒåœ¾å›æ”¶</a></p><p>å†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚å¯ä»¥ç½—åˆ—ä¸ºï¼š</p><a id="more"></a><p>æ— æ„è¯†çš„å˜é‡ä½¿ç”¨</p><pre><code class="javascript">function func(){   i = 2;}</code></pre><p>è¿™ç§æ–¹å¼åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯ä¸ç”Ÿæ•ˆçš„ã€‚</p><ol start="2"><li>é—­åŒ…å¯¼è‡´çš„é—®é¢˜</li></ol><p>å…¶å®ï¼Œé—­åŒ…å¯¼è‡´çš„å†…å­˜æ³„æ¼ä¸»è¦æ˜¯åœ¨IEå¼•ç”¨domå…ƒç´ çš„æ—¶å€™ã€‚IEä¸­çš„éƒ¨åˆ†domå…ƒç´ å¹¶éåŸç”Ÿçš„ï¼Œè€Œæ˜¯COMã€‚è¿™æ—¶ä½¿ç”¨ï¼Œå¾€å¾€ä¼šå¯¼è‡´å¾ªç¯å¼•ç”¨ï¼Œè€Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚è¿˜æœ‰å°±æ˜¯æ— æ„è¯†çš„ä½¿ç”¨é—­åŒ…å¯¼è‡´çš„é—®é¢˜ã€‚1. åœ¨å‡½æ•°å†…éƒ¨æ·»åŠ æ—¶é—´æ—¶ï¼Œä¼šé€ æˆdomå…ƒç´ çš„å¼•ç”¨ï¼Œè€Œå¯¼è‡´å†…å­˜æ³„æ¼ï¼›2. åœ¨åˆ é™¤domæ—¶ï¼Œåœ¨ä¹‹å‰ä¸å°å¿ƒæ·»åŠ äº†äº‹ä»¶ç­‰æƒ…å†µ<a href="http://www.cnblogs.com/sprying/archive/2013/05/31/3109517.html" target="_blank" rel="noopener">å†…å­˜æ³„æ¼</a></p><h2 id="æŸ¯é‡ŒåŒ–"><a href="#æŸ¯é‡ŒåŒ–" class="headerlink" title="æŸ¯é‡ŒåŒ–"></a>æŸ¯é‡ŒåŒ–</h2><p>jsçš„æŸ¯é‡ŒåŒ–å°±æ˜¯å°†å‡½æ•°çš„éƒ¨åˆ†å‚æ•°åˆ†æˆå¤šæ¬¡è¿›è¡Œè°ƒç”¨ã€‚ä¾‹å­ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzAwNjI5MTYyMw==&amp;mid=2651494750&amp;idx=1&amp;sn=ccc6108723a246099acec6b523eefa54&amp;chksm=80f19096b7861980c6ad788321c68b805e189ce59e828c6439597a1ea250a2762b5de53afe94&amp;scene=38#wechat_redirect" target="_blank" rel="noopener">æŸ¯é‡ŒåŒ–</a></p><h2 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h2><p>é¢è¯•ä¹‹ä¸­ä¸»è¦ä¼šé—®ä½ ä½•ä¸ºå¼‚æ­¥ï¼Ÿå…¶å®ï¼Œjsæ˜¯ä¸€é—¨å•çº¿ç¨‹çš„è¯­è¨€ï¼Œæ­£å¸¸çš„æ–¹å¼æ˜¯æ•´ä¸ªç¨‹åºæŒ‰ç…§é¡ºåºä¸€æ­¥ä¸€æ­¥çš„æ‰§è¡Œä¸‹å»ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„åŒæ­¥æ¨¡å¼ï¼Œä½†æ˜¯å¾€å¾€jsä¸­ä¼šæœ‰è®¸å¤šçš„ä»»åŠ¡è€—æ—¶æ¯”è¾ƒé•¿(æ¯”å¦‚è¯´ajaxè¯·æ±‚)ç­‰ï¼Œå¦‚æœæŒ‰ç…§åŒæ­¥çš„æ–¹å¼ï¼Œå¾€å¾€ä¼šå¯¼è‡´æµè§ˆå™¨çš„æ— å“åº”ã€‚è¿™æ—¶ï¼Œå°±éœ€è¦é€šè¿‡å¼‚æ­¥çš„å½¢å¼ã€‚å¼‚æ­¥æ¨¡å¼ï¼šjsçš„ä»»åŠ¡å¾€å¾€å…·å¤‡ä¸€ä¸ªæˆ–å¤šä¸ªå›è°ƒå‡½æ•°ï¼Œåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œåä¸€ä¸ªä»»åŠ¡æ— éœ€å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œè¿”å›ç»“æœï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œï¼Œä¹‹åå‰ä¸€ä¸ªä»»åŠ¡å¯ä»¥è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œå°†ç»“æœè¿”å›å›æ¥ã€‚<a href="http://www.ruanyifeng.com/blog/2012/12/asynchronous%EF%BC%BFjavascript.html" target="_blank" rel="noopener">å¼‚æ­¥</a></p><h2 id="setTimeoutå’ŒsetIntervalçš„åŒºåˆ«ï¼Œä»¥åŠsetTimeoutçš„åŸç†ï¼ŒsetIntervalä¼šé€ æˆä»€ä¹ˆé—®é¢˜"><a href="#setTimeoutå’ŒsetIntervalçš„åŒºåˆ«ï¼Œä»¥åŠsetTimeoutçš„åŸç†ï¼ŒsetIntervalä¼šé€ æˆä»€ä¹ˆé—®é¢˜" class="headerlink" title="setTimeoutå’ŒsetIntervalçš„åŒºåˆ«ï¼Œä»¥åŠsetTimeoutçš„åŸç†ï¼ŒsetIntervalä¼šé€ æˆä»€ä¹ˆé—®é¢˜"></a>setTimeoutå’ŒsetIntervalçš„åŒºåˆ«ï¼Œä»¥åŠsetTimeoutçš„åŸç†ï¼ŒsetIntervalä¼šé€ æˆä»€ä¹ˆé—®é¢˜</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥åº”è¯¥äº†è§£ä¸€ä¸‹setTimeoutçš„åŸç†ã€‚æµè§ˆå™¨æ˜¯ä¸€ä¸ªäº‹ä»¶ä¸ºä¸»ä½“çš„äº‹ç‰©ã€‚æ€»æ˜¯æœ‰ä¸€ä¸ªé˜Ÿåˆ—åœ¨ä¸åœçš„å¾ªç¯ã€‚å½“ä½¿ç”¨setTimeoutæ—¶ï¼Œæµè§ˆå™¨ä¼šåˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œç„¶åå°†å‡½æ•°ä¸­çš„å›è°ƒå‡½æ•°æ”¾å…¥handleé˜Ÿåˆ—é‡Œé¢ã€‚ç„¶åæµè§ˆå™¨ä¼šä¸åœçš„å¾ªç¯æ•´ä¸ªhandleï¼Œä¸€æ—¦handleä¸­çš„å†…å®¹æ»¡è¶³æ¡ä»¶ï¼Œå°±ä¼šè°ƒç”¨å…¶ä¸­çš„å›è°ƒå‡½æ•°ã€‚setTimeoutçš„æ»¡è¶³æ¡ä»¶å°±æ˜¯å®ƒåé¢çš„è®¾ç½®çš„æ—¶é—´å·®ã€‚</p><p>setTimeoutå’ŒsetIntervalä¹‹é—´çš„åŒºåˆ«ä¸»è¦æ˜¯setTimeoutæ˜¯ä¸€ä¸ªå»¶è¿Ÿå‡½æ•°ï¼Œåªæ‰§è¡Œä¸€æ¬¡ï¼Œè€ŒsetIntervalä¼šé—´éš”ä¸€å®šçš„æ—¶é—´åå¤çš„æ‰§è¡Œã€‚<a href="http://www.cnblogs.com/tugenhua0707/p/4083475.html" target="_blank" rel="noopener">setTimeoutå’ŒsetIntervalçš„åŒºåˆ«</a></p><p>setIntervalçš„åŸç†ï¼Œå…¶å®ä¸ä¹‹å‰çš„setTimeoutçš„åŸç†æœ‰ç‚¹ç±»ä¼¼ã€‚åªæ˜¯åœ¨æ¯ä¸ªEvent Loopä¹‹åï¼Œéƒ½ä¼šå»æ£€æµ‹æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶çš„è¯ï¼Œå°±æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå¦‚æœä¸æ»¡è¶³ï¼Œæ”¾å…¥ä¸‹ä¸€è½®çš„event loopä¸­ã€‚ä¸»è¦çš„é—®é¢˜å°±æ˜¯ï¼Œå¦‚æœä¸€ä¸ªsetIntervalä¸­çš„å›è°ƒå‡½æ•°ä¸èƒ½å¤Ÿè¢«æ‰§è¡Œï¼Œä¼šå¼•èµ·ç³»ç»Ÿé˜»å¡çš„é—®é¢˜ï¼Œä¹‹åçš„æ‰€æœ‰çš„å®šæ—¶å™¨éƒ½ä¼šç§¯ç´¯èµ·æ¥ï¼Œä¹‹åå°±ä¼šç›´æ¥æ‰§è¡Œï¼Œæ²¡æœ‰æ—¶é—´é—´éš”ã€‚<a href="https://jeffjade.com/2016/01/10/2016-01-10-javaScript-setInterval/" target="_blank" rel="noopener">setIntervalæœºåˆ¶</a></p><pre><code class="javascript">function interval(func, wait){    var interv = function(){         func.call(null);         setTimeout(interv, wait);   };   setTimeout(interv, wait);}interval(() =&gt; {    console.log(1);}, 1000);      //1 1 1</code></pre><h2 id="postmessageå’Œiframeæ€ä¹ˆç»“åˆä½¿ç”¨"><a href="#postmessageå’Œiframeæ€ä¹ˆç»“åˆä½¿ç”¨" class="headerlink" title="postmessageå’Œiframeæ€ä¹ˆç»“åˆä½¿ç”¨"></a>postmessageå’Œiframeæ€ä¹ˆç»“åˆä½¿ç”¨</h2><p>postmessageæ˜¯html5æ–°å‡ºçš„ä¸€ä¸ªAPIï¼Œå¯ä»¥è§£å†³å¤šçª—å£ã€é¡µé¢ä¸æ–°æ ‡ç­¾ã€çª—å£å’Œiframeä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡çš„è·¨åŸŸé—®é¢˜ã€‚ä½¿ç”¨æ–¹æ³•å°±æ˜¯postmessage(data, origin)ï¼Œå…¶ä¸­dataæŒ‡çš„å°±æ˜¯éœ€è¦ä¼ é€’çš„æ•°æ®ï¼ŒoriginæŒ‡çš„æ˜¯å…·ä½“çš„æ•°æ®æºåœ°å€(åŒ…æ‹¬åè®®+åŸŸå+ç«¯å£)ã€‚ç„¶åwindowå¯¹messageäº‹ä»¶è¿›è¡Œç›‘å¬ã€‚<a href="http://www.cnblogs.com/dolphinX/p/3464056.html" target="_blank" rel="noopener">postMessageè§£å†³è·¨åŸŸ</a></p><h2 id="jsæ¨¡æ¿å¼•æ“"><a href="#jsæ¨¡æ¿å¼•æ“" class="headerlink" title="jsæ¨¡æ¿å¼•æ“"></a>jsæ¨¡æ¿å¼•æ“</h2><p>jsæ¨¡ç‰ˆå¼•æ“ï¼Œå…¶å®å°±æ˜¯é¢„å¤„ç†å™¨ï¼Œå°†ä¸€äº›å­—ç¬¦ä¸²å»åŒ¹é…æ•°æ®ï¼Œç„¶åå°†æ•°æ®æ’å…¥åˆ°å›ºå®šçš„htmlæ¨¡ç‰ˆä¹‹ä¸­ã€‚jsçš„æ¨¡ç‰ˆå¼•æ“ä¸»è¦æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å»è¿‡æ»¤ä¸€äº›å­—ç¬¦ä¸²ï¼Œç„¶åå°†é‡Œé¢çš„æ¯ä¸ªè¯­å¥ç‰‡æ®µéƒ½æ”¾åˆ°å›ºå®šçš„æ•°ç»„ä¹‹ä¸­ï¼Œç„¶ååœ¨å¯¹æ•°ç»„è¿›è¡Œè§£æï¼Œä¹‹åæ‹¼æˆä¸€ä¸ªå›ºå®šçš„jsä»£ç ï¼Œå°†å†…å®¹è¿”å›å‡ºæ¥ã€‚è‘—åçš„æ¨¡ç‰ˆå¼•æ“<a href="http://ejs.co/" target="_blank" rel="noopener">ejs</a>ã€‚<a href="http://www.cnblogs.com/hustskyking/p/principle-of-javascript-template.html" target="_blank" rel="noopener">jsæ¨¡ç‰ˆå¼•æ“åŸç†è§£æ</a></p><h2 id="WebSocketï¼Ÿé•¿è½®è¯¢å’ŒçŸ­è½®è¯¢"><a href="#WebSocketï¼Ÿé•¿è½®è¯¢å’ŒçŸ­è½®è¯¢" class="headerlink" title="WebSocketï¼Ÿé•¿è½®è¯¢å’ŒçŸ­è½®è¯¢"></a>WebSocketï¼Ÿé•¿è½®è¯¢å’ŒçŸ­è½®è¯¢</h2><p>webSocketæ˜¯ä¸€ç§ç½‘ç»œé€šä¿¡åè®®ï¼ŒåŸºäºTCP/IPçš„å¦ä¸€ç§é€šä¿¡åè®®(è¿˜æœ‰ä¸€ç§æ˜¯httpåè®®)ã€‚å®ƒä¸httpçš„ä¸»è¦åŒºåˆ«å°±æ˜¯ï¼Œhttpæ˜¯å•å‘é€šä¿¡çš„ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä½†æ˜¯ï¼ŒæœåŠ¡ç«¯å¦‚æœæœ‰æ¶ˆæ¯ï¼Œæ— æ³•å‘å®¢æˆ·ç«¯æ¨é€ã€‚åœ¨æ²¡æœ‰websockä¹‹å‰ï¼Œéƒ½æ˜¯é€šè¿‡httpå®šæœŸå‘é€è¯·æ±‚çš„æ–¹å¼â€”â€”è½®è¯¢ã€‚è½®è¯¢çš„æ•ˆç‡æ˜¯ç›¸å¯¹è¾ƒä½çš„ã€‚<a href="http://javascript.ruanyifeng.com/htmlapi/websocket.html" target="_blank" rel="noopener">websockåè®®</a></p><p>ä¹‹åçš„é•¿è½®è¯¢å’ŒçŸ­è½®è¯¢å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜è¿˜å¾—æ›´å®é™…çš„åœºæ™¯ç›¸ç»“åˆèµ·æ¥ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨å†™ç”µå•†ç½‘ç«™çš„æ—¶å€™ï¼Œå•†å“çš„åº“å­˜æ˜¯å®æ—¶å˜åŒ–çš„ï¼Œè¿™æ—¶ï¼Œä½ è¦å’ŒæœåŠ¡å™¨åŒæ­¥è¿™ä¸ªå˜åŒ–ï¼Œæ‰èƒ½å¤Ÿä½¿å¾—ä¿¡æ¯æ­£ç¡®ã€‚é‚£ä¹ˆï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æˆ‘ä»¬å†™ä¸€ä¸ªajaxè¯·æ±‚ï¼Œä¸æ–­çš„å»ç»™æœåŠ¡å™¨è¯·æ±‚ï¼ŒåŒæ­¥è¿™ä¸ªæ•°æ®ã€‚è€ŒæœåŠ¡å™¨æ¯æ¬¡æ¥æ”¶åˆ°è¯·æ±‚å°±è¿”å›ä¸€æ¬¡ä¿¡æ¯ã€‚è¿™å°±æ˜¯æ‰€è°“çš„çŸ­è½®è¯¢ï¼Œè¿™ç§æ–¹å¼å…¶å®éå¸¸çš„æ¶ˆè€—æœåŠ¡å™¨çš„èµ„æºï¼Œè¯•æƒ³æœåŠ¡å™¨æ¯æ¬¡æ¥æ”¶åˆ°è¯·æ±‚å°±è¦å»æŸ¥è¯¢æ•°æ®åº“ï¼Œè·å–ä¿¡æ¯ï¼Œè€Œå¾€å¾€åº“å­˜æ˜¯æ²¡æœ‰è¿™ä¹ˆå¿«æ”¹å˜çš„ã€‚é‚£ä¹ˆï¼Œæˆ–è®¸é•¿è½®è¯¢å¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªajaxè¯·æ±‚ï¼ŒåŒæ—¶ç»™è¿™ä¸ªè¯·æ±‚è®¾ç½®è¶…æ—¶æœºåˆ¶ï¼Œä¸€æ—¦è¶…æ—¶ä¹‹åï¼Œå†æ¬¡é‡æ–°å‘é€ã€‚è€ŒæœåŠ¡å™¨æ¯æ¬¡æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ï¼Œåªéœ€è¦å°†ä¹‹æŒ‚èµ·ï¼Œç­‰æ£€æµ‹åˆ°åº“å­˜å˜åŒ–æ—¶ï¼Œåœ¨å“åº”è¿™ä¸ªè¯·æ±‚ï¼Œè¿™æ ·å°±æœ‰æ•ˆçš„é™ä½äº†è½®è¯¢çš„æ¬¡æ•°ã€‚åŒæ ·çš„é—®é¢˜ï¼ŒæœåŠ¡å™¨çš„èµ„æºè¿˜æ˜¯ä¼šæœ‰æ‰€æŸè€—ï¼Œæ¯•ç«Ÿä¸€ä¸ªè¯·æ±‚ç›¸å½“äºä¸€ä¸ªçº¿ç¨‹ã€‚å¯¹äºå¤§å‹çš„ç”µå•†ç½‘ç«™æ¥è¯´ï¼Œè¿™ä¸æ˜¯ä¸€ç§å¥½çš„è§£å†³æ–¹å¼ã€‚<a href="http://web.jobbole.com/85541/" target="_blank" rel="noopener">é•¿è½®è¯¢ã€çŸ­è½®è¯¢ã€é•¿é“¾æ¥ã€çŸ­é“¾æ¥</a></p><h2 id="cookieã€LocalStorage-å’Œ-SessionStorage-çš„æ¦‚å¿µä»¥åŠå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«"><a href="#cookieã€LocalStorage-å’Œ-SessionStorage-çš„æ¦‚å¿µä»¥åŠå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="cookieã€LocalStorage å’Œ SessionStorage çš„æ¦‚å¿µä»¥åŠå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«"></a>cookieã€LocalStorage å’Œ SessionStorage çš„æ¦‚å¿µä»¥åŠå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«</h2><p>é¦–å…ˆï¼Œcookieæ˜¯æˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„ï¼Œæ˜¯æµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´æ•°æ®ä¼ é€’çš„æ–¹å¼ï¼Œä¹‹å‰é€šå¸¸ä¹Ÿä¼šç”¨æ¥åšä¸€äº›æ•°æ®çš„ç¼“å­˜ï¼Œä¾‹å¦‚ï¼šç”¨æˆ·çš„ç”¨æˆ·åç­‰ã€‚ä½†æ˜¯cookieåœ¨åšæ•°æ®ç¼“å­˜çš„æ—¶å€™å¾€å¾€æœ‰ç¼ºç‚¹ï¼š</p><p>cookieæ•°æ®æœ€å¤šåªèƒ½ç¼“å­˜4kbï¼Œå¤§äº4kbçš„cookieä¼šè¢«æµè§ˆå™¨é»˜è®¤å¼ƒç”¨<br>cookieåœ¨åšæ•°æ®ç¼“å­˜æ—¶ï¼Œå¾€å¾€ä¼šå°†æ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼Œä½†æ˜¯ï¼Œæœ‰çš„æ—¶å€™è¿™äº›æ•°æ®å¹¶ä¸éœ€è¦å‘é€ç»™æœåŠ¡å™¨<br>cookieåœ¨æ¯ä¸ªåŸŸä¸­çš„æ•°é‡æ˜¯æœ‰é™çš„ï¼Œå¾€å¾€è¶…è¿‡ä¸€å®šæ•°é‡ï¼Œé‚£ä¹ˆä¹‹å‰çš„cookieå°†è¢«æŠ›å¼ƒ<br>html5æ–°ç‰¹æ€§ä¸­å°±å¸¦æ¥äº†ç›¸åº”çš„å®¢æˆ·ç«¯storageï¼Œå°±æ˜¯localStorageå’ŒsessionStorageã€‚localStorageæ˜¯æœ¬åœ°å­˜å‚¨ï¼Œæ•°æ®ä¸ä¼šå‘é€ç»™æœåŠ¡å™¨ï¼ŒåŒæ—¶å®ƒçš„ç¼“å­˜å¤§å°å¤§çº¦åœ¨5Må·¦å³ï¼Œæ•°æ®æ˜¯æ°¸ä¹…å­˜å‚¨çš„ï¼Œé™¤éæ‰‹åŠ¨åˆ é™¤ã€‚sessionStorageåˆ™æ˜¯ä¼šè¯å­˜å‚¨ï¼Œå¤§éƒ¨åˆ†çš„ç‰¹æ€§å’ŒlocalStorageä¸€æ ·ï¼Œä½†æ˜¯ï¼ŒsessionStorageä¸­çš„å†…å®¹ä¼šåœ¨æµè§ˆå™¨æˆ–è€…é¡µé¢å…³é—­ä¹‹åè¢«æ¸…é™¤æ‰ã€‚<a href="http://harttle.land/2015/08/16/localstorage-sessionstorage-cookie.html" target="_blank" rel="noopener">cookieã€LocalStorageå’ŒSessionStorage</a></p><h2 id="æµè§ˆå™¨äº‹ä»¶ä»£ç†çš„åŸç†"><a href="#æµè§ˆå™¨äº‹ä»¶ä»£ç†çš„åŸç†" class="headerlink" title="æµè§ˆå™¨äº‹ä»¶ä»£ç†çš„åŸç†"></a>æµè§ˆå™¨äº‹ä»¶ä»£ç†çš„åŸç†</h2><p>å…¶å®ï¼Œäº‹ä»¶ä»£ç†å’Œäº‹ä»¶å§”æ‰˜æ˜¯åŒä¸€ä¸ªæ¦‚å¿µã€‚ä¸¾ä¸ªä¾‹å­è¯´æ˜æˆ–è®¸ä¼šæ›´åŠ å½¢è±¡ã€‚åœºæ™¯æ˜¯ï¼šDOMç»“æ„ä¸ºä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œä½ éœ€è¦åœ¨ç‚¹å‡»æ¯ä¸ªliæ ‡ç­¾æ—¶ï¼Œåœ¨æ§åˆ¶å°è¾“å‡ºå®ƒçš„å†…å®¹ã€‚è¿™æ—¶ï¼Œä½ æˆ–è®¸ä¼šåœ¨æ¯ä¸ªliä¸Šé¢æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç„¶åè¾“å‡ºæ¯ä¸ªliçš„å†…å®¹ã€‚ä½†æ˜¯ï¼Œå¾€å¾€è¿™æ ·å­åšï¼Œä¼šä½¿å¾—æ•´ä¸ªåº”ç”¨çš„æ€§èƒ½é™ä½ï¼Œè€Œä¸”ä½¿å¾—æ·»åŠ è¿‡ç¨‹ç¹çï¼Œä¸çµæ´»ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨äº‹ä»¶ä»£ç†çš„æ–¹å¼ï¼Œåœ¨æ•´ä¸ªåˆ—è¡¨çš„ulä¸Šé¢å»æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç„¶ååœ¨å†…éƒ¨ä½¿ç”¨target(çœŸå®ç‚¹å‡»å…ƒç´ )æ¥ä½¿å…¶è¾“å‡ºå®ƒçš„å†…å®¹ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åªå†™ä¸€ä¸ªäº‹ä»¶ï¼Œè€Œå®Œæˆå¤šä¸ªliä¹‹é—´çš„å†…å®¹è¾“å‡ºã€‚äº‹ä»¶ä»£ç†çš„åŸç†æ˜¯ä½¿ç”¨äº†äº‹ä»¶å†’æ³¡çš„ç‰¹æ€§ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æœ‰äº›äº‹ä»¶æ²¡æœ‰å†’æ³¡æœºåˆ¶ï¼Œå¦‚focusï¼Œblursç­‰ï¼Œå°±ä¸èƒ½ä½¿ç”¨äº‹ä»¶ä»£ç†ï¼Œè¿˜æœ‰äº›ç±»ä¼¼äºmouseoverç­‰äº‹ä»¶ï¼Œä¼šå¯¼è‡´å®æ—¶çš„è§¦å‘ï¼Œä¹Ÿä¸å®œä½¿ç”¨äº‹ä»¶ä»£ç†<a href="http://le0zh.github.io/2016/06/04/event-delegate-in-javascript/" target="_blank" rel="noopener">äº‹ä»¶ä»£ç†</a></p><h2 id="å‰ç«¯å®‰å…¨-XSSï¼ŒCSRF-ï¼Ÿé¿å…æ–¹æ³•ï¼Ÿ"><a href="#å‰ç«¯å®‰å…¨-XSSï¼ŒCSRF-ï¼Ÿé¿å…æ–¹æ³•ï¼Ÿ" class="headerlink" title="å‰ç«¯å®‰å…¨ XSSï¼ŒCSRF ï¼Ÿé¿å…æ–¹æ³•ï¼Ÿ"></a>å‰ç«¯å®‰å…¨ XSSï¼ŒCSRF ï¼Ÿé¿å…æ–¹æ³•ï¼Ÿ</h2><p>XSSï¼Œè¢«ç§°ä¸ºè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ç§åå°„å‹ã€å­˜å‚¨å‹å’ŒDOMå‹ã€‚åå°„å‹ä¸»è¦æ˜¯ä¸€äº›æ¶æ„é“¾æ¥çš„å‘é€ï¼Œå­˜å‚¨å‹ä¸»è¦å‡ºç°åœ¨è¯„è®ºç­‰ï¼Œå¯ä»¥æ’å…¥åˆ°æœåŠ¡å™¨æ•°æ®åº“ä¸­ï¼Œè¿™ç§æ”»å‡»æ¯”è¾ƒæŒä¹…ï¼›DOMå‹éå¸¸çš„å°‘è§ã€‚XSSä¸»è¦æ˜¯ç›—å–ç”¨æˆ·çš„cookieç­‰æ•°æ®ã€‚CSRFï¼Œè¢«ç§°ä¸ºè·¨ç«™ä¼ªé€ è¯·æ±‚æ”»å‡»ï¼Œä¸»è¦ä¸xssç›¸ç»“åˆ<a href="http://www.freebuf.com/articles/web/39234.html" target="_blank" rel="noopener">XSSå’ŒCSRF</a></p><h2 id="å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•"><a href="#å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•" class="headerlink" title="å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•"></a>å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•</h2><h2 id="åŒæºå’Œè·¨åŸŸ"><a href="#åŒæºå’Œè·¨åŸŸ" class="headerlink" title="åŒæºå’Œè·¨åŸŸ"></a>åŒæºå’Œè·¨åŸŸ</h2><h2 id="é¢å‘å¯¹è±¡å’Œç»§æ‰¿"><a href="#é¢å‘å¯¹è±¡å’Œç»§æ‰¿" class="headerlink" title="é¢å‘å¯¹è±¡å’Œç»§æ‰¿"></a>é¢å‘å¯¹è±¡å’Œç»§æ‰¿</h2><h2 id="object-createçš„å®ç°åŸç†"><a href="#object-createçš„å®ç°åŸç†" class="headerlink" title="object.createçš„å®ç°åŸç†"></a>object.createçš„å®ç°åŸç†</h2><h2 id="objectçš„æ·±æ‹·è´å’Œæµ…æ‹·è´"><a href="#objectçš„æ·±æ‹·è´å’Œæµ…æ‹·è´" class="headerlink" title="objectçš„æ·±æ‹·è´å’Œæµ…æ‹·è´"></a>objectçš„æ·±æ‹·è´å’Œæµ…æ‹·è´</h2><h2 id="é¢å‘åˆ‡é¢ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹"><a href="#é¢å‘åˆ‡é¢ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="é¢å‘åˆ‡é¢ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹"></a>é¢å‘åˆ‡é¢ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹</h2><p><a href="https://github.com/laizimo/zimo-article/issues/15" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a></p>]]></content>
      
      
      <categories>
          
          <category> Interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Interview </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</title>
      <link href="/2018/03/11/%E6%80%A7%E8%83%BD/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
      <url>/2018/03/11/%E6%80%A7%E8%83%BD/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>å‰ç«¯ä¼˜åŒ–çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</p><ol><li>ä»ç”¨æˆ·è§’åº¦è€Œè¨€ï¼Œä¼˜åŒ–èƒ½å¤Ÿè®©é¡µé¢åŠ è½½å¾—æ›´å¿«ã€å¯¹ç”¨æˆ·çš„æ“ä½œå“åº”å¾—æ›´åŠæ—¶ï¼Œèƒ½å¤Ÿç»™ç”¨æˆ·æä¾›æ›´ä¸ºå‹å¥½çš„ä½“éªŒã€‚ã€€ã€€</li><li>ä»æœåŠ¡å•†è§’åº¦è€Œè¨€ï¼Œä¼˜åŒ–èƒ½å¤Ÿå‡å°‘é¡µé¢è¯·æ±‚æ•°ã€æˆ–è€…å‡å°è¯·æ±‚æ‰€å å¸¦å®½ï¼Œèƒ½å¤ŸèŠ‚çœå¯è§‚çš„èµ„æºã€‚ã€€ã€€</li></ol><p>æ€»ä¹‹ï¼Œæ°å½“çš„ä¼˜åŒ–ä¸ä»…èƒ½å¤Ÿæ”¹å–„ç«™ç‚¹çš„ç”¨æˆ·ä½“éªŒå¹¶ä¸”èƒ½å¤ŸèŠ‚çœç›¸å½“çš„èµ„æºåˆ©ç”¨ã€‚</p><hr><h2 id="é¡µé¢çº§ä¼˜åŒ–"><a href="#é¡µé¢çº§ä¼˜åŒ–" class="headerlink" title="é¡µé¢çº§ä¼˜åŒ–"></a>é¡µé¢çº§ä¼˜åŒ–</h2><h3 id="å‡å°‘httpè¯·æ±‚"><a href="#å‡å°‘httpè¯·æ±‚" class="headerlink" title="å‡å°‘httpè¯·æ±‚"></a>å‡å°‘httpè¯·æ±‚</h3><p><strong>å‡å°‘httpè¯·æ±‚æ•°çš„ä¸»è¦é€”å¾„åŒ…æ‹¬ï¼š</strong></p><blockquote><ul><li>(1). ä»è®¾è®¡å®ç°å±‚é¢ç®€åŒ–é¡µé¢<br>ã€€ã€€ å¦‚æœä½ çš„é¡µé¢åƒç™¾åº¦é¦–é¡µä¸€æ ·ç®€å•ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„è§„åˆ™åŸºæœ¬ä¸Šéƒ½ç”¨ä¸ç€äº†ã€‚ä¿æŒé¡µé¢ç®€æ´ã€å‡å°‘èµ„æºçš„ä½¿ç”¨æ—¶æœ€ç›´æ¥çš„ã€‚å¦‚æœä¸æ˜¯è¿™æ ·ï¼Œä½ çš„é¡µé¢éœ€è¦åä¸½çš„çš®è‚¤ï¼Œåˆ™ç»§ç»­é˜…è¯»ä¸‹é¢çš„å†…å®¹ã€‚</li></ul></blockquote><blockquote><ul><li>(2). åˆç†è®¾ç½® HTTPç¼“å­˜ã€€ã€€<br>  ç¼“å­˜çš„åŠ›é‡æ˜¯å¼ºå¤§çš„ï¼Œæ°å½“çš„ç¼“å­˜è®¾ç½®å¯ä»¥å¤§å¤§çš„å‡å°‘ HTTPè¯·æ±‚ã€‚ä»¥æœ‰å•Šé¦–é¡µä¸ºä¾‹ï¼Œå½“æµè§ˆå™¨æ²¡æœ‰ç¼“å­˜çš„æ—¶å€™è®¿é—®ä¸€å…±ä¼šå‘å‡º 78ä¸ªè¯·æ±‚ï¼Œå…± 600å¤š Kæ•°æ® (å¦‚å›¾ 1.1)ï¼Œè€Œå½“ç¬¬äºŒæ¬¡è®¿é—®å³æµè§ˆå™¨å·²ç¼“å­˜ä¹‹åè®¿é—®åˆ™ä»…æœ‰ 10ä¸ªè¯·æ±‚ï¼Œå…± 20å¤š Kæ•°æ® (å¦‚å›¾ 1.2)ã€‚ (è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœç›´æ¥ F5åˆ·æ–°é¡µé¢çš„è¯æ•ˆæœæ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™ç§æƒ…å†µä¸‹è¯·æ±‚æ•°è¿˜æ˜¯ä¸€æ ·ï¼Œä¸è¿‡è¢«ç¼“å­˜èµ„æºçš„è¯·æ±‚æœåŠ¡å™¨æ˜¯ 304å“åº”ï¼Œåªæœ‰ Headeræ²¡æœ‰Body ï¼Œå¯ä»¥èŠ‚çœå¸¦å®½ )</li></ul></blockquote><blockquote><ul><li>(3). èµ„æºåˆå¹¶ä¸å‹ç¼©<br>ã€€ã€€ å¦‚æœå¯ä»¥çš„è¯ï¼Œå°½å¯èƒ½çš„å°†å¤–éƒ¨çš„è„šæœ¬ã€æ ·å¼è¿›è¡Œåˆå¹¶ï¼Œå¤šä¸ªåˆä¸ºä¸€ä¸ªã€‚å¦å¤–ï¼Œ CSSã€ Javascriptã€Image éƒ½å¯ä»¥ç”¨ç›¸åº”çš„å·¥å…·è¿›è¡Œå‹ç¼©ï¼Œå‹ç¼©åå¾€å¾€èƒ½çœä¸‹ä¸å°‘ç©ºé—´ã€‚</li></ul></blockquote><blockquote><ul><li>(4). CSS Sprites<br>ã€€ã€€ åˆå¹¶ CSSå›¾ç‰‡ï¼Œå‡å°‘è¯·æ±‚æ•°çš„åˆä¸€ä¸ªå¥½åŠæ³•ã€‚ </li></ul></blockquote><blockquote><ul><li>(5). Inline Imagesã€€ã€€<br>  ä½¿ç”¨ data: URL schemeçš„æ–¹å¼å°†å›¾ç‰‡åµŒå…¥åˆ°é¡µé¢æˆ– CSSä¸­ï¼Œå¦‚æœä¸è€ƒè™‘èµ„æºç®¡ç†ä¸Šçš„é—®é¢˜çš„è¯ï¼Œä¸å¤±ä¸ºä¸€ä¸ªå¥½åŠæ³•ã€‚å¦‚æœæ˜¯åµŒå…¥é¡µé¢çš„è¯æ¢æ¥çš„æ˜¯å¢å¤§äº†é¡µé¢çš„ä½“ç§¯ï¼Œè€Œä¸”æ— æ³•åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ã€‚ä½¿ç”¨åœ¨ CSSä¸­çš„å›¾ç‰‡åˆ™æ›´ä¸ºç†æƒ³ä¸€äº›ã€‚</li></ul></blockquote><blockquote><ul><li>(6). Lazy Load Imagesï¼ˆè‡ªå·±å¯¹è¿™ä¸€å—çš„å†…å®¹è¿˜æ˜¯ä¸äº†è§£ï¼‰<br>  è¿™æ¡ç­–ç•¥å®é™…ä¸Šå¹¶ä¸ä¸€å®šèƒ½å‡å°‘ HTTPè¯·æ±‚æ•°ï¼Œä½†æ˜¯å´èƒ½åœ¨æŸäº›æ¡ä»¶ä¸‹æˆ–è€…é¡µé¢åˆšåŠ è½½æ—¶å‡å°‘ HTTPè¯·æ±‚æ•°ã€‚å¯¹äºå›¾ç‰‡è€Œè¨€ï¼Œåœ¨é¡µé¢åˆšåŠ è½½çš„æ—¶å€™å¯ä»¥åªåŠ è½½ç¬¬ä¸€å±ï¼Œå½“ç”¨æˆ·ç»§ç»­å¾€åæ»šå±çš„æ—¶å€™æ‰åŠ è½½åç»­çš„å›¾ç‰‡ã€‚è¿™æ ·ä¸€æ¥ï¼Œå‡å¦‚ç”¨æˆ·åªå¯¹ç¬¬ä¸€å±çš„å†…å®¹æ„Ÿå…´è¶£æ—¶ï¼Œé‚£å‰©ä½™çš„å›¾ç‰‡è¯·æ±‚å°±éƒ½èŠ‚çœäº†ã€‚ æœ‰å•Šé¦–é¡µ æ›¾ç»çš„åšæ³•æ˜¯åœ¨åŠ è½½çš„æ—¶å€™æŠŠç¬¬ä¸€å±ä¹‹åçš„å›¾ç‰‡åœ°å€ç¼“å­˜åœ¨ Textareaæ ‡ç­¾ä¸­ï¼Œå¾…ç”¨æˆ·å¾€ä¸‹æ»šå±çš„æ—¶å€™æ‰ â€œæƒ°æ€§â€ åŠ è½½ã€‚</li></ul></blockquote><a id="more"></a><h3 id="å°†å¤–éƒ¨è„šæœ¬ç½®åº•ï¼ˆå°†è„šæœ¬å†…å®¹åœ¨é¡µé¢ä¿¡æ¯å†…å®¹åŠ è½½åå†åŠ è½½ï¼‰"><a href="#å°†å¤–éƒ¨è„šæœ¬ç½®åº•ï¼ˆå°†è„šæœ¬å†…å®¹åœ¨é¡µé¢ä¿¡æ¯å†…å®¹åŠ è½½åå†åŠ è½½ï¼‰" class="headerlink" title="å°†å¤–éƒ¨è„šæœ¬ç½®åº•ï¼ˆå°†è„šæœ¬å†…å®¹åœ¨é¡µé¢ä¿¡æ¯å†…å®¹åŠ è½½åå†åŠ è½½ï¼‰"></a>å°†å¤–éƒ¨è„šæœ¬ç½®åº•ï¼ˆå°†è„šæœ¬å†…å®¹åœ¨é¡µé¢ä¿¡æ¯å†…å®¹åŠ è½½åå†åŠ è½½ï¼‰</h3><p>å¦‚æœå°†è„šæœ¬æ”¾åœ¨æ¯”è¾ƒé å‰çš„ä½ç½®ï¼Œåˆ™ä¼šå½±å“æ•´ä¸ªé¡µé¢çš„åŠ è½½é€Ÿåº¦ä»è€Œå½±å“ç”¨æˆ·ä½“éªŒã€‚è§£å†³è¿™ä¸€é—®é¢˜çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œåœ¨ è¿™é‡Œæœ‰æ¯”è¾ƒè¯¦ç»†çš„ä»‹ç» (è¿™é‡Œæ˜¯è¯‘æ–‡å’Œ æ›´è¯¦ç»†çš„ä¾‹å­ )ï¼Œè€Œæœ€ç®€å•å¯ä¾èµ–çš„æ–¹æ³•å°±æ˜¯å°†è„šæœ¬å°½å¯èƒ½çš„å¾€åæŒªï¼Œå‡å°‘å¯¹å¹¶å‘ä¸‹è½½çš„å½±å“ã€‚</p><h3 id="å¼‚æ­¥æ‰§è¡Œ-inlineè„šæœ¬-å…¶å®åŸç†å’Œä¸Šé¢æ˜¯ä¸€æ ·ï¼Œä¿è¯è„šæœ¬åœ¨é¡µé¢å†…å®¹åé¢åŠ è½½ã€‚"><a href="#å¼‚æ­¥æ‰§è¡Œ-inlineè„šæœ¬-å…¶å®åŸç†å’Œä¸Šé¢æ˜¯ä¸€æ ·ï¼Œä¿è¯è„šæœ¬åœ¨é¡µé¢å†…å®¹åé¢åŠ è½½ã€‚" class="headerlink" title="å¼‚æ­¥æ‰§è¡Œ inlineè„šæœ¬(å…¶å®åŸç†å’Œä¸Šé¢æ˜¯ä¸€æ ·ï¼Œä¿è¯è„šæœ¬åœ¨é¡µé¢å†…å®¹åé¢åŠ è½½ã€‚)"></a>å¼‚æ­¥æ‰§è¡Œ inlineè„šæœ¬(å…¶å®åŸç†å’Œä¸Šé¢æ˜¯ä¸€æ ·ï¼Œä¿è¯è„šæœ¬åœ¨é¡µé¢å†…å®¹åé¢åŠ è½½ã€‚)</h3><h3 id="Lazy-Load-Javascriptï¼ˆåªæœ‰åœ¨éœ€è¦åŠ è½½çš„æ—¶å€™åŠ è½½ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹å¹¶ä¸åŠ è½½ä¿¡æ¯å†…å®¹ã€‚ï¼‰"><a href="#Lazy-Load-Javascriptï¼ˆåªæœ‰åœ¨éœ€è¦åŠ è½½çš„æ—¶å€™åŠ è½½ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹å¹¶ä¸åŠ è½½ä¿¡æ¯å†…å®¹ã€‚ï¼‰" class="headerlink" title="Lazy Load Javascriptï¼ˆåªæœ‰åœ¨éœ€è¦åŠ è½½çš„æ—¶å€™åŠ è½½ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹å¹¶ä¸åŠ è½½ä¿¡æ¯å†…å®¹ã€‚ï¼‰"></a>Lazy Load Javascriptï¼ˆåªæœ‰åœ¨éœ€è¦åŠ è½½çš„æ—¶å€™åŠ è½½ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹å¹¶ä¸åŠ è½½ä¿¡æ¯å†…å®¹ã€‚ï¼‰</h3><h3 id="å°†-CSSæ”¾åœ¨-HEADä¸­"><a href="#å°†-CSSæ”¾åœ¨-HEADä¸­" class="headerlink" title="å°† CSSæ”¾åœ¨ HEADä¸­"></a>å°† CSSæ”¾åœ¨ HEADä¸­</h3><pre><code>å¦‚æœå°† CSSæ”¾åœ¨å…¶ä»–åœ°æ–¹æ¯”å¦‚ BODYä¸­ï¼Œåˆ™æµè§ˆå™¨æœ‰å¯èƒ½è¿˜æœªä¸‹è½½å’Œè§£æåˆ° CSSå°±å·²ç»å¼€å§‹æ¸²æŸ“é¡µé¢äº†ï¼Œè¿™å°±å¯¼è‡´é¡µé¢ç”±æ—  CSSçŠ¶æ€è·³è½¬åˆ° CSSçŠ¶æ€ï¼Œç”¨æˆ·ä½“éªŒæ¯”è¾ƒç³Ÿç³•ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæœ‰äº›æµè§ˆå™¨ä¼šåœ¨ CSSä¸‹è½½å®Œæˆåæ‰å¼€å§‹æ¸²æŸ“é¡µé¢ï¼Œå¦‚æœ CSSæ”¾åœ¨é ä¸‹çš„ä½ç½®åˆ™ä¼šå¯¼è‡´æµè§ˆå™¨å°†æ¸²æŸ“æ—¶é—´æ¨è¿Ÿã€‚</code></pre><h3 id="å¼‚æ­¥è¯·æ±‚-Callbackï¼ˆå°±æ˜¯å°†ä¸€äº›è¡Œä¸ºæ ·å¼æå–å‡ºæ¥ï¼Œæ…¢æ…¢çš„åŠ è½½ä¿¡æ¯çš„å†…å®¹ï¼‰"><a href="#å¼‚æ­¥è¯·æ±‚-Callbackï¼ˆå°±æ˜¯å°†ä¸€äº›è¡Œä¸ºæ ·å¼æå–å‡ºæ¥ï¼Œæ…¢æ…¢çš„åŠ è½½ä¿¡æ¯çš„å†…å®¹ï¼‰" class="headerlink" title="å¼‚æ­¥è¯·æ±‚ Callbackï¼ˆå°±æ˜¯å°†ä¸€äº›è¡Œä¸ºæ ·å¼æå–å‡ºæ¥ï¼Œæ…¢æ…¢çš„åŠ è½½ä¿¡æ¯çš„å†…å®¹ï¼‰"></a>å¼‚æ­¥è¯·æ±‚ Callbackï¼ˆå°±æ˜¯å°†ä¸€äº›è¡Œä¸ºæ ·å¼æå–å‡ºæ¥ï¼Œæ…¢æ…¢çš„åŠ è½½ä¿¡æ¯çš„å†…å®¹ï¼‰</h3><h3 id="å‡å°‘ä¸å¿…è¦çš„-HTTPè·³è½¬"><a href="#å‡å°‘ä¸å¿…è¦çš„-HTTPè·³è½¬" class="headerlink" title="å‡å°‘ä¸å¿…è¦çš„ HTTPè·³è½¬"></a>å‡å°‘ä¸å¿…è¦çš„ HTTPè·³è½¬</h3><pre><code>å¯¹äºä»¥ç›®å½•å½¢å¼è®¿é—®çš„ HTTPé“¾æ¥ï¼Œå¾ˆå¤šäººéƒ½ä¼šå¿½ç•¥é“¾æ¥æœ€åæ˜¯å¦å¸¦ â€™/&#39;ï¼Œå‡å¦‚ä½ çš„æœåŠ¡å™¨å¯¹æ­¤æ˜¯åŒºåˆ«å¯¹å¾…çš„è¯ï¼Œé‚£ä¹ˆä½ ä¹Ÿéœ€è¦æ³¨æ„ï¼Œè¿™å…¶ä¸­å¾ˆå¯èƒ½éšè—äº† 301è·³è½¬ï¼Œå¢åŠ äº†å¤šä½™è¯·æ±‚ã€‚å…·ä½“å‚è§ä¸‹å›¾ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªé“¾æ¥æ˜¯ä»¥æ—  â€™/&#39;ç»“å°¾çš„æ–¹å¼è®¿é—®çš„ï¼Œäºæ˜¯æœåŠ¡å™¨æœ‰äº†ä¸€æ¬¡è·³è½¬</code></pre><h3 id="é¿å…é‡å¤çš„èµ„æºè¯·æ±‚"><a href="#é¿å…é‡å¤çš„èµ„æºè¯·æ±‚" class="headerlink" title="é¿å…é‡å¤çš„èµ„æºè¯·æ±‚"></a>é¿å…é‡å¤çš„èµ„æºè¯·æ±‚</h3><pre><code>è¿™ç§æƒ…å†µä¸»è¦æ˜¯ç”±äºç–å¿½æˆ–é¡µé¢ç”±å¤šä¸ªæ¨¡å—æ‹¼æ¥è€Œæˆï¼Œç„¶åæ¯ä¸ªæ¨¡å—ä¸­è¯·æ±‚äº†åŒæ ·çš„èµ„æºæ—¶ï¼Œä¼šå¯¼è‡´èµ„æºçš„é‡å¤è¯·æ±‚</code></pre><h2 id="ä»£ç çº§ä¼˜åŒ–"><a href="#ä»£ç çº§ä¼˜åŒ–" class="headerlink" title="ä»£ç çº§ä¼˜åŒ–"></a>ä»£ç çº§ä¼˜åŒ–</h2><h3 id="Javascript"><a href="#Javascript" class="headerlink" title="Javascript"></a>Javascript</h3><h4 id="DOM"><a href="#DOM" class="headerlink" title="DOMã€€ã€€"></a>DOMã€€ã€€</h4><p>DOMæ“ä½œåº”è¯¥æ˜¯è„šæœ¬ä¸­æœ€è€—æ€§èƒ½çš„ä¸€ç±»æ“ä½œï¼Œä¾‹å¦‚å¢åŠ ã€ä¿®æ”¹ã€åˆ é™¤ DOMå…ƒç´ æˆ–è€…å¯¹ DOMé›†åˆè¿›è¡Œæ“ä½œã€‚<br>å¦‚æœè„šæœ¬ä¸­åŒ…å«äº†å¤§é‡çš„ DOMæ“ä½œåˆ™éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼šã€€ã€€</p><h5 id="HTML-Collectionï¼ˆHTMLæ”¶é›†å™¨ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„å†…å®¹ä¿¡æ¯ï¼‰"><a href="#HTML-Collectionï¼ˆHTMLæ”¶é›†å™¨ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„å†…å®¹ä¿¡æ¯ï¼‰" class="headerlink" title="HTML Collectionï¼ˆHTMLæ”¶é›†å™¨ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„å†…å®¹ä¿¡æ¯ï¼‰ã€€"></a>HTML Collectionï¼ˆHTMLæ”¶é›†å™¨ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„å†…å®¹ä¿¡æ¯ï¼‰ã€€</h5><p>ã€€ åœ¨è„šæœ¬ä¸­ document.imagesã€document.forms ã€getElementsByTagName()è¿”å›çš„éƒ½æ˜¯ HTMLCollectionç±»å‹çš„é›†åˆï¼Œåœ¨å¹³æ—¶ä½¿ç”¨çš„æ—¶å€™å¤§å¤šå°†å®ƒä½œä¸ºæ•°ç»„æ¥ä½¿ç”¨ï¼Œå› ä¸ºå®ƒæœ‰ lengthå±æ€§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç´¢å¼•è®¿é—®æ¯ä¸€ä¸ªå…ƒç´ ã€‚ä¸è¿‡åœ¨è®¿é—®æ€§èƒ½ä¸Šåˆ™æ¯”æ•°ç»„è¦å·®å¾ˆå¤šï¼ŒåŸå› æ˜¯è¿™ä¸ªé›†åˆå¹¶ä¸æ˜¯ä¸€ä¸ªé™æ€çš„ç»“æœï¼Œå®ƒè¡¨ç¤ºçš„ä»…ä»…æ˜¯ä¸€ä¸ªç‰¹å®šçš„æŸ¥è¯¢ï¼Œæ¯æ¬¡è®¿é—®è¯¥é›†åˆæ—¶éƒ½ä¼šé‡æ–°æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ä»è€Œæ›´æ–°æŸ¥è¯¢ç»“æœã€‚æ‰€è°“çš„ â€œè®¿é—®é›†åˆâ€ åŒ…æ‹¬è¯»å–é›†åˆçš„ lengthå±æ€§ã€è®¿é—®é›†åˆä¸­çš„å…ƒç´ ã€‚<br>ã€€ã€€<br>å› æ­¤ï¼Œå½“ä½ éœ€è¦éå† HTML Collectionçš„æ—¶å€™ï¼Œå°½é‡å°†å®ƒè½¬ä¸ºæ•°ç»„åå†è®¿é—®ï¼Œä»¥æé«˜æ€§èƒ½ã€‚å³ä½¿ä¸è½¬æ¢ä¸ºæ•°ç»„ï¼Œä¹Ÿè¯·å°½å¯èƒ½å°‘çš„è®¿é—®å®ƒï¼Œä¾‹å¦‚åœ¨éå†çš„æ—¶å€™å¯ä»¥å°† lengthå±æ€§ã€æˆå‘˜ä¿å­˜åˆ°å±€éƒ¨å˜é‡åå†ä½¿ç”¨å±€éƒ¨å˜é‡ã€‚ã€€</p><p>ã€€</p><h5 id="reflow-å›æµ-å’Œ-repaint-é‡ç»˜"><a href="#reflow-å›æµ-å’Œ-repaint-é‡ç»˜" class="headerlink" title="reflow(å›æµ)å’Œ repaint(é‡ç»˜)"></a>reflow(å›æµ)å’Œ repaint(é‡ç»˜)</h5><p>ç®€è¦ï¼šæ•´ä¸ªåœ¨æµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼ˆé¡µé¢åˆå§‹åŒ–ï¼Œç”¨æˆ·è¡Œä¸ºæ”¹å˜ç•Œé¢æ ·å¼ï¼ŒåŠ¨ç”»æ”¹å˜ç•Œé¢æ ·å¼ç­‰ï¼‰reflow(å›æµ)å’Œrepaint(é‡ç»˜) ä¼šå¤§å¤§å½±å“webæ€§èƒ½ï¼Œå°¤å…¶æ˜¯æ‰‹æœºé¡µé¢ã€‚å› æ­¤æˆ‘ä»¬åœ¨é¡µé¢è®¾è®¡çš„æ—¶å€™è¦å°½é‡å‡å°‘reflowå’Œrepaintã€‚</p><p><strong>ä»€ä¹ˆæ˜¯reflowå’Œrepain</strong></p><font color = "blue">reflowï¼šä¾‹å¦‚æŸä¸ªå­å…ƒç´ æ ·å¼å‘ç”Ÿæ”¹å˜ï¼Œç›´æ¥å½±å“åˆ°äº†å…¶çˆ¶å…ƒç´ ä»¥åŠå¾€ä¸Šè¿½æº¯å¾ˆå¤šç¥–å…ˆå…ƒç´ ï¼ˆåŒ…æ‹¬å…„å¼Ÿå…ƒç´ ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™æµè§ˆå™¨è¦é‡æ–°å»æ¸²æŸ“è¿™ä¸ªå­å…ƒç´ ç›¸å…³è”çš„æ‰€æœ‰å…ƒç´ çš„è¿‡ç¨‹ç§°ä¸ºå›æµã€‚</font><font color = "blue">reflowï¼šå‡ ä¹æ˜¯æ— æ³•é¿å…çš„ã€‚ç°åœ¨ç•Œé¢ä¸Šæµè¡Œçš„ä¸€äº›æ•ˆæœï¼Œæ¯”å¦‚æ ‘çŠ¶ç›®å½•çš„æŠ˜å ã€å±•å¼€ï¼ˆå®è´¨ä¸Šæ˜¯å…ƒç´ çš„æ˜¾ ç¤ºä¸éšè—ï¼‰ç­‰ï¼Œéƒ½å°†å¼•èµ·æµè§ˆå™¨çš„ reflowã€‚é¼ æ ‡æ»‘è¿‡ã€ç‚¹å‡»â€¦â€¦åªè¦è¿™äº›è¡Œä¸ºå¼•èµ·äº†é¡µé¢ä¸ŠæŸäº›å…ƒç´ çš„å ä½é¢ç§¯ã€å®šä½æ–¹å¼ã€è¾¹è·ç­‰å±æ€§çš„å˜åŒ–ï¼Œéƒ½ä¼šå¼•èµ·å®ƒå†…éƒ¨ã€å‘¨å›´ç”šè‡³æ•´ä¸ªé¡µé¢çš„é‡æ–°æ¸² æŸ“ã€‚é€šå¸¸æˆ‘ä»¬éƒ½æ— æ³•é¢„ä¼°æµè§ˆå™¨åˆ°åº•ä¼š reflow å“ªä¸€éƒ¨åˆ†çš„ä»£ç ï¼Œå®ƒä»¬éƒ½å½¼æ­¤ç›¸äº’å½±å“ç€ã€‚</font><font color = "blue">repaintï¼šå¦‚æœåªæ˜¯æ”¹å˜æŸä¸ªå…ƒç´ çš„èƒŒæ™¯è‰²ã€æ–‡ å­—é¢œè‰²ã€è¾¹æ¡†é¢œè‰²ç­‰ç­‰ä¸å½±å“å®ƒå‘¨å›´æˆ–å†…éƒ¨å¸ƒå±€çš„å±æ€§ï¼Œå°†åªä¼šå¼•èµ·æµè§ˆå™¨ repaintï¼ˆé‡ç»˜ï¼‰ã€‚repaint çš„é€Ÿåº¦æ˜æ˜¾å¿«äº reflow</font><p>ä¸‹é¢æƒ…å†µä¼šå¯¼è‡´<font color = "red">reflow</font>å‘ç”Ÿ</p><blockquote><ul><li>1ï¼šæ”¹å˜çª—å£å¤§å°</li></ul></blockquote><blockquote><ul><li>2ï¼šæ”¹å˜æ–‡å­—å¤§å°</li></ul></blockquote><blockquote><ul><li>3ï¼šå†…å®¹çš„æ”¹å˜ï¼Œå¦‚ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­æ•²å­—</li></ul></blockquote><blockquote><ul><li>4ï¼šæ¿€æ´»ä¼ªç±»ï¼Œå¦‚:hover</li></ul></blockquote><blockquote><ul><li>5ï¼šæ“ä½œclasså±æ€§</li></ul></blockquote><blockquote><ul><li>6ï¼šè„šæœ¬æ“ä½œDOM</li></ul></blockquote><blockquote><ul><li>7ï¼šè®¡ç®—offsetWidthå’ŒoffsetHeight</li></ul></blockquote><blockquote><ul><li>8ï¼šè®¾ç½®styleå±æ€§</li></ul></blockquote><p><strong>é‚£ä¹ˆä¸ºäº†å‡å°‘å›æµè¦æ³¨æ„å“ªäº›æ–¹å¼å‘¢</strong>ï¼Ÿ</p><blockquote><ul><li>1ï¼šä¸è¦é€šè¿‡çˆ¶çº§æ¥æ”¹å˜å­å…ƒç´ æ ·å¼ï¼Œæœ€å¥½ç›´æ¥æ”¹å˜å­å…ƒç´ æ ·å¼ï¼Œæ”¹å˜å­å…ƒç´ æ ·å¼å°½å¯èƒ½ä¸è¦å½±å“çˆ¶å…ƒç´ å’Œå…„å¼Ÿå…ƒç´ çš„å¤§å°å’Œå°ºå¯¸</li></ul></blockquote><blockquote><ul><li>2ï¼šå°½é‡é€šè¿‡classæ¥è®¾è®¡å…ƒç´ æ ·å¼ï¼Œåˆ‡å¿Œç”¨style</li></ul></blockquote><blockquote><ul><li>3ï¼šå®ç°å…ƒç´ çš„åŠ¨ç”»ï¼Œå¯¹äºç»å¸¸è¦è¿›è¡Œå›æµçš„ç»„ä»¶ï¼Œè¦æŠ½ç¦»å‡ºæ¥ï¼Œå®ƒçš„positionå±æ€§åº”å½“è®¾ä¸ºfixedæˆ–absolute</li></ul></blockquote><blockquote><ul><li>4ï¼šæƒè¡¡é€Ÿåº¦çš„å¹³æ»‘ã€‚æ¯”å¦‚å®ç°ä¸€ä¸ªåŠ¨ç”»ï¼Œä»¥1ä¸ªåƒç´ ä¸ºå•ä½ç§»åŠ¨è¿™æ ·æœ€å¹³æ»‘ï¼Œä½†reflowå°±ä¼šè¿‡äºé¢‘ç¹ï¼ŒCPUå¾ˆå¿«å°±ä¼šè¢«å®Œå…¨å ç”¨ã€‚å¦‚æœä»¥3ä¸ªåƒç´ ä¸ºå•ä½ç§»åŠ¨å°±ä¼šå¥½å¾ˆå¤šã€‚</li></ul></blockquote><blockquote><ul><li>5ï¼šä¸è¦ç”¨tableså¸ƒå±€çš„å¦ä¸€ä¸ªåŸå› å°±æ˜¯tablesä¸­æŸä¸ªå…ƒç´ ä¸€æ—¦è§¦å‘reflowå°±ä¼šå¯¼è‡´tableé‡Œæ‰€æœ‰çš„å…¶å®ƒå…ƒç´ reflowã€‚åœ¨é€‚åˆç”¨tableçš„åœºåˆï¼Œå¯ä»¥è®¾ç½®table-layoutä¸ºautoæˆ–fixedï¼Œ</li></ul></blockquote><blockquote><ul><li>6ï¼šè¿™æ ·å¯ä»¥è®©tableä¸€è¡Œä¸€è¡Œçš„æ¸²æŸ“ï¼Œè¿™ç§åšæ³•ä¹Ÿæ˜¯ä¸ºäº†é™åˆ¶reflowçš„å½±å“èŒƒå›´ã€‚</li></ul></blockquote><blockquote><ul><li>7ï¼šcssé‡Œä¸è¦æœ‰è¡¨è¾¾å¼expression</li></ul></blockquote><blockquote><ul><li>8ï¼šå‡å°‘ä¸å¿…è¦çš„ DOM å±‚çº§ï¼ˆDOM depthï¼‰ã€‚æ”¹å˜ DOM æ ‘ä¸­çš„ä¸€çº§ä¼šå¯¼è‡´æ‰€æœ‰å±‚çº§çš„æ”¹å˜ï¼Œä¸Šè‡³æ ¹éƒ¨ï¼Œä¸‹è‡³è¢«æ”¹å˜èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ã€‚è¿™å¯¼è‡´å¤§é‡æ—¶é—´è€—è´¹åœ¨æ‰§è¡Œ reflow ä¸Šé¢ã€‚</li></ul></blockquote><blockquote><ul><li>9ï¼šé¿å…ä¸å¿…è¦çš„å¤æ‚çš„ CSS é€‰æ‹©å™¨ï¼Œå°¤å…¶æ˜¯åä»£é€‰æ‹©å™¨ï¼ˆdescendant selectorsï¼‰ï¼Œå› ä¸ºä¸ºäº†åŒ¹é…é€‰æ‹©å™¨å°†è€—è´¹æ›´å¤šçš„ CPUã€‚</li></ul></blockquote><blockquote><ul><li>10: å°½é‡ä¸è¦è¿‡å¤šçš„é¢‘ç¹çš„å»å¢åŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤å…ƒç´ ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šé¢‘ç¹çš„å¯¼è‡´é¡µé¢reflowï¼Œå¯ä»¥å…ˆæŠŠè¯¥domèŠ‚ç‚¹æŠ½ç¦»åˆ°å†…å­˜ä¸­è¿›è¡Œå¤æ‚çš„æ“ä½œç„¶åå†displayåˆ°é¡µé¢ä¸Šã€‚</li></ul></blockquote><blockquote><ul><li>11ï¼šè¯·æ±‚å¦‚ä¸‹å€¼offsetTop, offsetLeft, offsetWidth, offsetHeightï¼ŒscrollTop/Left/Width/Heightï¼ŒclientTop/Left/Width/Heightï¼Œæµè§ˆå™¨ä¼šå‘ç”Ÿreflowï¼Œå»ºè®®å°†ä»–ä»¬åˆå¹¶åˆ°ä¸€èµ·æ“ä½œï¼Œå¯ä»¥å‡å°‘å›æµçš„æ¬¡æ•°ã€‚</li></ul></blockquote><p>å¦‚æœæˆ‘ä»¬è¦ç»å¸¸å»è·å–å’Œæ“ä½œè¿™äº›å€¼ï¼Œåˆ™å¯ä»¥å…ˆå°†è¿™äº›å€¼ç¼“å­˜èµ·æ¥ä¾‹å¦‚ï¼š</p><pre><code class="javascript">var windowHeight = window.innerHeight;//reflowfor(i=0;i&lt;10;i++){ã€€ã€€$body.height(windowHeight++);ã€€ã€€ä¸€ç³»åˆ—å…³äºwindowHeightçš„æ“ä½œ.......}</code></pre><p>(2). æ…ç”¨ with<br>with(obj){ p = 1}; ä»£ç å—çš„è¡Œä¸ºå®é™…ä¸Šæ˜¯ä¿®æ”¹äº†ä»£ç å—ä¸­çš„ æ‰§è¡Œç¯å¢ƒ ï¼Œå°†objæ”¾åœ¨äº†å…¶ä½œç”¨åŸŸé“¾çš„æœ€å‰ç«¯ï¼Œåœ¨ withä»£ç å—ä¸­è®¿é—®éå±€éƒ¨å˜é‡æ˜¯éƒ½æ˜¯å…ˆä» objä¸Šå¼€å§‹æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰å†ä¾æ¬¡æŒ‰ä½œç”¨åŸŸé“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œå› æ­¤ä½¿ç”¨ withç›¸å½“äºå¢åŠ äº†ä½œç”¨åŸŸé“¾é•¿åº¦ã€‚è€Œæ¯æ¬¡æŸ¥æ‰¾ä½œç”¨åŸŸé“¾éƒ½æ˜¯è¦æ¶ˆè€—æ—¶é—´çš„ï¼Œè¿‡é•¿çš„ä½œç”¨åŸŸé“¾ä¼šå¯¼è‡´æŸ¥æ‰¾æ€§èƒ½ä¸‹é™ã€‚ã€€<br>ã€€<br>å› æ­¤ï¼Œé™¤éä½ èƒ½è‚¯å®šåœ¨ withä»£ç ä¸­åªè®¿é—® objä¸­çš„å±æ€§ï¼Œå¦åˆ™æ…ç”¨ withï¼Œæ›¿ä»£çš„å¯ä»¥ä½¿ç”¨å±€éƒ¨å˜é‡ç¼“å­˜éœ€è¦è®¿é—®çš„å±æ€§ã€‚<br>ã€€ã€€<br>(3). é¿å…ä½¿ç”¨ evalå’Œ Functionã€€ã€€<br>æ¯æ¬¡ eval æˆ– Function æ„é€ å‡½æ•°ä½œç”¨äºå­—ç¬¦ä¸²è¡¨ç¤ºçš„æºä»£ç æ—¶ï¼Œè„šæœ¬å¼•æ“éƒ½éœ€è¦å°†æºä»£ç è½¬æ¢æˆå¯æ‰§è¡Œä»£ç ã€‚è¿™æ˜¯å¾ˆæ¶ˆè€—èµ„æºçš„æ“ä½œ â€”â€” é€šå¸¸æ¯”ç®€å•çš„å‡½æ•°è°ƒç”¨æ…¢ 100å€ä»¥ä¸Šã€‚ã€€<br>ã€€<br>eval å‡½æ•°æ•ˆç‡ç‰¹åˆ«ä½ï¼Œç”±äºäº‹å…ˆæ— æ³•çŸ¥æ™“ä¼ ç»™ eval çš„å­—ç¬¦ä¸²ä¸­çš„å†…å®¹ï¼Œevalåœ¨å…¶ä¸Šä¸‹æ–‡ä¸­è§£é‡Šè¦å¤„ç†çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯è¯´ç¼–è¯‘å™¨æ— æ³•ä¼˜åŒ–ä¸Šä¸‹æ–‡ï¼Œå› æ­¤åªèƒ½æœ‰æµè§ˆå™¨åœ¨è¿è¡Œæ—¶è§£é‡Šä»£ç ã€‚è¿™å¯¹æ€§èƒ½å½±å“å¾ˆå¤§ã€‚ã€€ã€€</p><p>Function æ„é€ å‡½æ•°æ¯” evalç•¥å¥½ï¼Œå› ä¸ºä½¿ç”¨æ­¤ä»£ç ä¸ä¼šå½±å“å‘¨å›´ä»£ç  ;ä½†å…¶é€Ÿåº¦ä»å¾ˆæ…¢ã€‚ã€€ã€€æ­¤å¤–ï¼Œä½¿ç”¨ evalå’Œ Functionä¹Ÿä¸åˆ©äºJavascript å‹ç¼©å·¥å…·æ‰§è¡Œå‹ç¼©ã€‚ã€€ã€€</p><p>(4). å‡å°‘ä½œç”¨åŸŸé“¾æŸ¥æ‰¾ï¼ˆè¿™æ–¹é¢è®¾è®¡åˆ°ä¸€äº›å†…å®¹çš„ç›¸å…³é—®é¢˜ï¼‰ã€€ã€€<br>å‰æ–‡è°ˆåˆ°äº†ä½œç”¨åŸŸé“¾æŸ¥æ‰¾é—®é¢˜ï¼Œè¿™ä¸€ç‚¹åœ¨å¾ªç¯ä¸­æ˜¯å°¤å…¶éœ€è¦æ³¨æ„çš„é—®é¢˜ã€‚å¦‚æœåœ¨å¾ªç¯ä¸­éœ€è¦è®¿é—®éæœ¬ä½œç”¨åŸŸä¸‹çš„å˜é‡æ—¶è¯·åœ¨éå†ä¹‹å‰ç”¨å±€éƒ¨å˜é‡ç¼“å­˜è¯¥å˜é‡ï¼Œå¹¶åœ¨éå†ç»“æŸåå†é‡å†™é‚£ä¸ªå˜é‡ï¼Œè¿™ä¸€ç‚¹å¯¹å…¨å±€å˜é‡å°¤å…¶é‡è¦ï¼Œå› ä¸ºå…¨å±€å˜é‡å¤„äºä½œç”¨åŸŸé“¾çš„æœ€é¡¶ç«¯ï¼Œè®¿é—®æ—¶çš„æŸ¥æ‰¾æ¬¡æ•°æ˜¯æœ€å¤šçš„ã€‚</p><p><strong>ä½æ•ˆç‡çš„å†™æ³•ï¼š</strong></p><pre><code class="javascript">// å…¨å±€å˜é‡ var globalVar = 1; function myCallback(info){        for( var i = 100000; i--;){                //æ¯æ¬¡è®¿é—® globalVar éƒ½éœ€è¦æŸ¥æ‰¾åˆ°ä½œç”¨åŸŸé“¾æœ€é¡¶ç«¯ï¼Œæœ¬ä¾‹ä¸­éœ€è¦è®¿é—® 100000 æ¬¡           globalVar += i;    }    } ã€€ã€€</code></pre><p><strong>æ›´é«˜æ•ˆçš„å†™æ³•ï¼š</strong></p><pre><code class="javascript">// å…¨å±€å˜é‡ var globalVar = 1; function myCallback(info){        //å±€éƒ¨å˜é‡ç¼“å­˜å…¨å±€å˜é‡      var localVar = globalVar;      for( var i = 100000; i--;){             //è®¿é—®å±€éƒ¨å˜é‡æ˜¯æœ€å¿«çš„                localVar += i;           }            //æœ¬ä¾‹ä¸­åªéœ€è¦è®¿é—® 2æ¬¡å…¨å±€å˜é‡åœ¨å‡½æ•°ä¸­åªéœ€è¦å°† globalVarä¸­å†…å®¹çš„å€¼èµ‹ç»™localVar ä¸­åŒº          globalVar = localVar;     }ã€€ã€€</code></pre><p>æ­¤å¤–ï¼Œè¦å‡å°‘ä½œç”¨åŸŸé“¾æŸ¥æ‰¾è¿˜åº”è¯¥å‡å°‘é—­åŒ…çš„ä½¿ç”¨ã€‚</p><p>(5). æ•°æ®è®¿é—®ã€€<br>ã€€Javascriptä¸­çš„æ•°æ®è®¿é—®åŒ…æ‹¬ç›´æ¥é‡ (å­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼ )ã€å˜é‡ã€å¯¹è±¡å±æ€§ä»¥åŠæ•°ç»„ï¼Œå…¶ä¸­å¯¹ç›´æ¥é‡å’Œå±€éƒ¨å˜é‡çš„è®¿é—®æ˜¯æœ€å¿«çš„ï¼Œå¯¹å¯¹è±¡å±æ€§ä»¥åŠæ•°ç»„çš„è®¿é—®éœ€è¦æ›´å¤§çš„å¼€é”€ã€‚å½“å‡ºç°ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œå»ºè®®å°†æ•°æ®æ”¾å…¥å±€éƒ¨å˜é‡ï¼š<br>ã€€ã€€<br>a. å¯¹ä»»ä½•å¯¹è±¡å±æ€§çš„è®¿é—®è¶…è¿‡ 1æ¬¡ã€€ã€€<br>b. å¯¹ä»»ä½•æ•°ç»„æˆå‘˜çš„è®¿é—®æ¬¡æ•°è¶…è¿‡ 1æ¬¡ã€€</p><p>å¦å¤–ï¼Œè¿˜åº”å½“å°½å¯èƒ½çš„å‡å°‘å¯¹å¯¹è±¡ä»¥åŠæ•°ç»„æ·±åº¦æŸ¥æ‰¾ã€‚</p><p>(6). å­—ç¬¦ä¸²æ‹¼æ¥ã€€ã€€<br>åœ¨ Javascriptä¸­ä½¿ç”¨â€+â€ å·æ¥æ‹¼æ¥å­—ç¬¦ä¸²æ•ˆç‡æ˜¯æ¯”è¾ƒä½çš„ï¼Œå› ä¸ºæ¯æ¬¡è¿è¡Œéƒ½ä¼šå¼€è¾Ÿæ–°çš„å†…å­˜å¹¶ç”Ÿæˆæ–°çš„å­—ç¬¦ä¸²å˜é‡ï¼Œç„¶åå°†æ‹¼æ¥ç»“æœèµ‹å€¼ç»™æ–°å˜é‡ã€‚ä¸ä¹‹ç›¸æ¯”æ›´ä¸ºé«˜æ•ˆçš„åšæ³•æ˜¯ä½¿ç”¨æ•°ç»„çš„ joinæ–¹æ³•ï¼Œå³å°†éœ€è¦æ‹¼æ¥çš„å­—ç¬¦ä¸²æ”¾åœ¨æ•°ç»„ä¸­æœ€åè°ƒç”¨å…¶ joinæ–¹æ³•å¾—åˆ°ç»“æœã€‚</p><p>ä¸è¿‡ç”±äºä½¿ç”¨æ•°ç»„ä¹Ÿæœ‰ä¸€å®šçš„å¼€é”€ï¼Œå› æ­¤å½“éœ€è¦æ‹¼æ¥çš„å­—ç¬¦ä¸²è¾ƒå¤šçš„æ—¶å€™å¯ä»¥è€ƒè™‘ç”¨æ­¤æ–¹æ³•ã€‚</p><h3 id="CSSé€‰æ‹©ç¬¦"><a href="#CSSé€‰æ‹©ç¬¦" class="headerlink" title="CSSé€‰æ‹©ç¬¦"></a>CSSé€‰æ‹©ç¬¦</h3><p>åœ¨å¤§å¤šæ•°äººçš„è§‚å¿µä¸­ï¼Œéƒ½è§‰å¾—æµè§ˆå™¨å¯¹ CSSé€‰æ‹©ç¬¦çš„è§£æå¼ä»å·¦å¾€å³è¿›è¡Œçš„ï¼Œä¾‹å¦‚#toc A { color: #444; }ã€€ã€€è¿™æ ·ä¸€ä¸ªé€‰æ‹©ç¬¦ï¼Œå¦‚æœæ˜¯ä»å³å¾€å·¦è§£æåˆ™æ•ˆç‡ä¼šå¾ˆé«˜ï¼Œå› ä¸ºç¬¬ä¸€ä¸ª IDé€‰æ‹©åŸºæœ¬ä¸Šå°±æŠŠæŸ¥æ‰¾çš„èŒƒå›´é™å®šäº†ï¼Œä½†å®é™…ä¸Šæµè§ˆå™¨å¯¹é€‰æ‹©ç¬¦çš„è§£ææ˜¯ä»å³å¾€å·¦è¿›è¡Œçš„ã€‚å¦‚ä¸Šé¢çš„é€‰æ‹©ç¬¦ï¼Œæµè§ˆå™¨å¿…é¡»éå†æŸ¥æ‰¾æ¯ä¸€ä¸ª Aæ ‡ç­¾çš„ç¥–å…ˆèŠ‚ç‚¹ï¼Œæ•ˆç‡å¹¶ä¸åƒä¹‹å‰æƒ³è±¡çš„é‚£æ ·é«˜ã€‚æ ¹æ®æµè§ˆå™¨çš„è¿™ä¸€è¡Œä¸ºç‰¹ç‚¹ï¼Œåœ¨å†™é€‰æ‹©ç¬¦çš„æ—¶å€™éœ€è¦æ³¨æ„å¾ˆå¤šäº‹é¡¹</p><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><p>å¯¹ HTMLæœ¬èº«çš„ä¼˜åŒ–ç°å¦‚ä»Šä¹Ÿè¶Šæ¥è¶Šå¤šçš„å—äººå…³æ³¨äº†ï¼Œè¯¦æƒ…å¯ä»¥å‚è§è¿™ç¯‡<a href="https://www.cnblogs.com/zhangyongl/p/6154981.html" target="_blank" rel="noopener">æ€»ç»“æ€§æ–‡ç« </a></p><h3 id="Imageå‹ç¼©"><a href="#Imageå‹ç¼©" class="headerlink" title="Imageå‹ç¼©"></a>Imageå‹ç¼©</h3><p><a href="https://tinypng.com/" target="_blank" rel="noopener">ä¸€ä¸ªéå¸¸å®ç”¨çš„Imageå‹ç¼©çš„ç½‘ç«™</a></p><p>å›¾ç‰‡å‹ç¼©æ˜¯ä¸ªæŠ€æœ¯æ´»ï¼Œä¸è¿‡ç°å¦‚ä»Šè¿™æ–¹é¢çš„å·¥å…·ä¹Ÿéå¸¸å¤šï¼Œå‹ç¼©ä¹‹åå¾€å¾€èƒ½å¸¦æ¥ä¸é”™çš„æ•ˆæœï¼Œå…·ä½“çš„å‹ç¼©åŸç†ä»¥åŠæ–¹æ³•åœ¨ã€Š Even Faster Web Sitesã€‹ç¬¬10 ç« æœ‰å¾ˆè¯¦ç»†çš„ä»‹ç»ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹çœ‹ã€‚ </p><p>ã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾æŒ‡å—ã€‹æå‡ºçš„è§„åˆ™</p><p>è§„åˆ™1â€”â€”-å‡å°‘HTTPè¯·æ±‚</p><p>è§„åˆ™2â€”â€”-ä½¿ç”¨å†…å®¹å‘å¸ƒç½‘ç»œ</p><p>è§„åˆ™3â€”â€”-æ·»åŠ Expireså¤´æ§åˆ¶ç¼“å­˜</p><p>è§„åˆ™4â€”â€”-å‹ç¼©ç»„ä»¶</p><p>è§„åˆ™5â€”â€”-å°†æ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨</p><p>è§„åˆ™6â€”â€”-å°†è„šæ­¥æ”¾åœ¨åº•éƒ¨</p><p>è§„åˆ™7â€”â€”-é¿å…cssè¡¨è¾¾å¼</p><p>è§„åˆ™8â€”â€”-ä½¿ç”¨å¤–éƒ¨javaScriptå’ŒCSS</p><p>è§„åˆ™9â€”â€”-å‡å°‘DNSæŸ¥æ‰¾</p><p>è§„åˆ™10â€”â€”-ç²¾ç®€javaScript</p><p>è§„åˆ™11â€”â€”-é¿å…é‡å®šå‘</p><p>è§„åˆ™12â€”â€”-åˆ é™¤é‡å¤è„šæ­¥</p><p>è§„åˆ™13â€”â€”-é…ç½®ETag</p><p>è§„åˆ™14â€”â€”-ä½¿Ajaxå¯ç¼“å­˜</p>]]></content>
      
      
      <categories>
          
          <category> æ€§èƒ½ä¼˜åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€§èƒ½ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ajaxå·²æ­»ï¼ŒFetchæ°¸ç”Ÿ</title>
      <link href="/2018/03/10/study/Ajax%E5%B7%B2%E6%AD%BB%EF%BC%8CFetch%E6%B0%B8%E7%94%9F/"/>
      <url>/2018/03/10/study/Ajax%E5%B7%B2%E6%AD%BB%EF%BC%8CFetch%E6%B0%B8%E7%94%9F/</url>
      
        <content type="html"><![CDATA[<p>ç”±äº Fetch API æ˜¯åŸºäº Promise è®¾è®¡ï¼Œæœ‰å¿…è¦å…ˆå­¦ä¹ ä¸€ä¸‹ <em>Promise</em>ï¼Œæ¨èé˜…è¯» <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener">MDN Promise æ•™ç¨‹</a>ã€‚æ—§æµè§ˆå™¨ä¸æ”¯æŒ Promiseï¼Œéœ€è¦ä½¿ç”¨ polyfill <a href="https://github.com/stefanpenner/es6-promise" target="_blank" rel="noopener">es6-promise</a> ã€‚</p><hr><p>æœ¬æ–‡ä¸æ˜¯ Fetch API ç§‘æ™®è´´ï¼Œå…¶å®æ˜¯è®²å¼‚æ­¥å¤„ç†å’Œ Promise çš„ã€‚Fetch API å¾ˆç®€å•ï¼Œçœ‹æ–‡æ¡£å¾ˆå¿«å°±å­¦ä¼šäº†ã€‚æ¨è <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WindowOrWorkerGlobalScope/fetch" target="_blank" rel="noopener">MDN Fetch æ•™ç¨‹</a> å’Œ <a href="https://fetch.spec.whatwg.org/" target="_blank" rel="noopener">ä¸‡èƒ½çš„WHATWG Fetch è§„èŒƒ</a></p><h2 id="Why-Fetch"><a href="#Why-Fetch" class="headerlink" title="Why Fetch"></a>Why Fetch</h2><p>XMLHttpRequest æ˜¯ä¸€ä¸ªè®¾è®¡ç²—ç³™çš„ APIï¼Œä¸ç¬¦åˆå…³æ³¨åˆ†ç¦»ï¼ˆSeparation of Concernsï¼‰çš„åŸåˆ™ï¼Œé…ç½®å’Œè°ƒç”¨æ–¹å¼éå¸¸æ··ä¹±ï¼Œè€Œä¸”åŸºäºäº‹ä»¶çš„å¼‚æ­¥æ¨¡å‹å†™èµ·æ¥ä¹Ÿæ²¡æœ‰ç°ä»£çš„ Promiseï¼Œgenerator/yieldï¼Œasync/await å‹å¥½ã€‚</p><a id="more"></a><p>Fetch çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³ XHR çš„é—®é¢˜ï¼Œæ‹¿ä¾‹å­è¯´æ˜ï¼š</p><p>ä½¿ç”¨ XHR å‘é€ä¸€ä¸ª json è¯·æ±‚ä¸€èˆ¬æ˜¯è¿™æ ·ï¼š</p><pre><code class="javascript">var xhr = new XMLHttpRequest();xhr.open(&#39;GET&#39;, url);xhr.responseType = &#39;json&#39;;xhr.onload = function() {  console.log(xhr.response);};xhr.onerror = function() {  console.log(&quot;Oops, error&quot;);};xhr.send();</code></pre><p>ä½¿ç”¨ Fetch åï¼Œé¡¿æ—¶çœ‹èµ·æ¥å¥½ä¸€ç‚¹</p><pre><code class="javascript">fetch(url).then(function(response) {  return response.json();}).then(function(data) {  console.log(data);}).catch(function(e) {  console.log(&quot;Oops, error&quot;);});</code></pre><p>ä½¿ç”¨ ES6 çš„ ç®­å¤´å‡½æ•° åï¼š</p><pre><code class="javascript">fetch(url).then(response =&gt; response.json())  .then(data =&gt; console.log(data))  .catch(e =&gt; console.log(&quot;Oops, error&quot;, e))</code></pre><p>ç°åœ¨çœ‹èµ·æ¥å¥½å¾ˆå¤šäº†ï¼Œä½†è¿™ç§ Promise çš„å†™æ³•è¿˜æ˜¯æœ‰ Callback çš„å½±å­ï¼Œè€Œä¸” promise ä½¿ç”¨ catch æ–¹æ³•æ¥è¿›è¡Œé”™è¯¯å¤„ç†çš„æ–¹å¼æœ‰ç‚¹å¥‡æ€ªã€‚ä¸ç”¨æ€¥ï¼Œä¸‹é¢ä½¿ç”¨ async/await æ¥åšæœ€ç»ˆä¼˜åŒ–</p><blockquote><p>æ³¨ï¼šasync/await æ˜¯éå¸¸æ–°çš„ APIï¼Œå±äº ES7ï¼Œç›®å‰å°šåœ¨ Stage 1(æè®®) é˜¶æ®µï¼Œè¿™æ˜¯å®ƒçš„<a href="https://github.com/tc39/ecmascript-asyncawait" target="_blank" rel="noopener">å®Œæ•´è§„èŒƒ</a>ã€‚ä½¿ç”¨ <font color = "blue">Babel</font> å¼€å¯ <font color = "blue">runtime</font> æ¨¡å¼åå¯ä»¥æŠŠ async/await æ— ç—›ç¼–è¯‘æˆ ES5 ä»£ç ã€‚ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ <font color = "blue">regenerator</font> æ¥ç¼–è¯‘åˆ° ES5ã€‚</p></blockquote><pre><code class="javascript">try {  let response = await fetch(url);  let data = await response.json();  console.log(data);} catch(e) {  console.log(&quot;Oops, error&quot;, e);}// æ³¨ï¼šè¿™æ®µä»£ç å¦‚æœæƒ³è¿è¡Œï¼Œå¤–é¢éœ€è¦åŒ…ä¸€ä¸ª async function</code></pre><p>duang~~ çš„ä¸€å£°ï¼Œä½¿ç”¨ await åï¼Œå†™å¼‚æ­¥ä»£ç å°±åƒå†™åŒæ­¥ä»£ç ä¸€æ ·çˆ½ã€‚await åé¢å¯ä»¥è·Ÿ Promise å¯¹è±¡ï¼Œè¡¨ç¤ºç­‰å¾… Promise resolve() æ‰ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œå¦‚æœ Promise è¢« reject() æˆ–æŠ›å‡ºå¼‚å¸¸åˆ™ä¼šè¢«å¤–é¢çš„ tryâ€¦catch æ•è·ã€‚</p><p><font color = "red">Promiseï¼Œgenerator/yieldï¼Œawait/async</font> éƒ½æ˜¯ç°åœ¨å’Œæœªæ¥ JS è§£å†³å¼‚æ­¥çš„æ ‡å‡†åšæ³•ï¼Œå¯ä»¥å®Œç¾æ­é…ä½¿ç”¨ã€‚è¿™ä¹Ÿæ˜¯ä½¿ç”¨æ ‡å‡† Promise ä¸€å¤§å¥½å¤„ã€‚æœ€è¿‘ä¹ŸæŠŠé¡¹ç›®ä¸­ä½¿ç”¨ç¬¬ä¸‰æ–¹ Promise åº“çš„ä»£ç å…¨éƒ¨è½¬æˆæ ‡å‡† Promiseï¼Œä¸ºä»¥åå…¨é¢ä½¿ç”¨ async/await åšå‡†å¤‡ã€‚</p><p>å¦å¤–ï¼ŒFetch ä¹Ÿå¾ˆé€‚åˆåšç°åœ¨æµè¡Œçš„åŒæ„åº”ç”¨ï¼Œæœ‰äººåŸºäº Fetch çš„è¯­æ³•ï¼Œåœ¨ Node ç«¯åŸºäº http åº“å®ç°äº† <a href="https://github.com/bitinn/node-fetch" target="_blank" rel="noopener">node-fetch</a>ï¼Œåˆæœ‰äººå°è£…äº†ç”¨äºåŒæ„åº”ç”¨çš„ <a href="https://github.com/matthew-andrews/isomorphic-fetch" target="_blank" rel="noopener">isomorphic-fetch</a>ã€‚</p><blockquote><p>æ³¨ï¼šåŒæ„(isomorphic/universal)å°±æ˜¯ä½¿å‰åç«¯è¿è¡ŒåŒä¸€å¥—ä»£ç çš„æ„æ€ï¼Œåç«¯ä¸€èˆ¬æ˜¯æŒ‡ NodeJS ç¯å¢ƒã€‚</p></blockquote><p>æ€»ç»“ä¸€ä¸‹ï¼ŒFetch ä¼˜ç‚¹ä¸»è¦æœ‰ï¼š</p><blockquote><ul><li>è¯­æ³•ç®€æ´ï¼Œæ›´åŠ è¯­ä¹‰åŒ–</li><li>åŸºäºæ ‡å‡† Promise å®ç°ï¼Œæ”¯æŒ async/await</li><li>åŒæ„æ–¹ä¾¿ï¼Œä½¿ç”¨ <a href="https://github.com/matthew-andrews/isomorphic-fetch" target="_blank" rel="noopener">isomorphic-fetch</a></li></ul></blockquote><h2 id="Fetch-å¯ç”¨æ–¹æ³•"><a href="#Fetch-å¯ç”¨æ–¹æ³•" class="headerlink" title="Fetch å¯ç”¨æ–¹æ³•"></a>Fetch å¯ç”¨æ–¹æ³•</h2><p>å…ˆçœ‹ä¸€ä¸‹ Fetch åŸç”Ÿæ”¯æŒç‡ï¼š<br><img src="https://cloud.githubusercontent.com/assets/948896/10188421/c6e19fc8-6791-11e5-8ac2-bfede76df6b4.png" alt="fetch"></p><p>åŸç”Ÿæ”¯æŒç‡å¹¶ä¸é«˜ï¼Œå¹¸è¿çš„æ˜¯ï¼Œå¼•å…¥ä¸‹é¢è¿™äº› polyfill åå¯ä»¥å®Œç¾æ”¯æŒ IE8+ ï¼š</p><blockquote><ul><li>ç”±äº IE8 æ˜¯ ES3ï¼Œéœ€è¦å¼•å…¥ ES5 çš„ polyfill: <a href="https://github.com/es-shims/es5-shim" target="_blank" rel="noopener">es5-shim,es5-sham</a></li><li>å¼•å…¥ Promise çš„ polyfill: <a href="https://github.com/stefanpenner/es6-promise" target="_blank" rel="noopener">es6-promise</a></li><li>å¼•å…¥ fetch æ¢æµ‹åº“ï¼š<a href="https://github.com/camsong/fetch-detector" target="_blank" rel="noopener">fetch-detector</a></li><li>å¼•å…¥ fetch çš„ polyfill: <a href="https://github.com/camsong/fetch-ie8" target="_blank" rel="noopener">fetch-ie8</a></li><li>å¯é€‰ï¼šå¦‚æœä½ è¿˜ä½¿ç”¨äº† jsonpï¼Œå¼•å…¥ <a href="https://github.com/camsong/fetch-jsonp" target="_blank" rel="noopener">fetch-jsonp</a></li><li>å¯é€‰ï¼šå¼€å¯ Babel çš„ runtime æ¨¡å¼ï¼Œç°åœ¨å°±ä½¿ç”¨ async/await</li></ul></blockquote><p>Fetch polyfill çš„åŸºæœ¬åŸç†æ˜¯æ¢æµ‹æ˜¯å¦å­˜åœ¨ window.fetch æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰åˆ™ç”¨ XHR å®ç°ã€‚è¿™ä¹Ÿæ˜¯ <a href="https://github.com/github/fetch" target="_blank" rel="noopener">github/fetch</a> çš„åšæ³•ï¼Œä½†æ˜¯æœ‰äº›æµè§ˆå™¨ï¼ˆChrome 45ï¼‰åŸç”Ÿæ”¯æŒ Fetchï¼Œä½†å“åº”ä¸­æœ‰ä¸­æ–‡æ—¶ä¼šä¹±ç ï¼Œè€å¤–åˆä¸å¤ªå…³å¿ƒè¿™ç§é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±æ‰å°è£…äº† fetch-detector å’Œ fetch-ie8 åªåœ¨æµè§ˆå™¨ç¨³å®šæ”¯æŒ Fetch æƒ…å†µä¸‹æ‰ä½¿ç”¨åŸç”Ÿ Fetchã€‚è¿™äº›åº“ç°åœ¨ <strong>æ¯å¤©æœ‰å‡ åƒä¸‡ä¸ªè¯·æ±‚éƒ½åœ¨ä½¿ç”¨ï¼Œç»å¯¹é è°±ï¼</strong></p><p>ç»ˆäºï¼Œå¼•ç”¨äº†è¿™ä¸€å † polyfill åï¼Œå¯ä»¥æ„‰å¿«åœ°ä½¿ç”¨ Fetch äº†ã€‚ä½†è¦å°å¿ƒï¼Œä¸‹é¢æœ‰å‘ï¼š</p><h2 id="Fetch-å¸¸è§å‘"><a href="#Fetch-å¸¸è§å‘" class="headerlink" title="Fetch å¸¸è§å‘"></a>Fetch å¸¸è§å‘</h2><blockquote><ul><li>Fetch è¯·æ±‚é»˜è®¤æ˜¯ä¸å¸¦ cookie çš„ï¼Œéœ€è¦è®¾ç½® fetch(url, {credentials: â€˜includeâ€™})</li><li>æœåŠ¡å™¨è¿”å› 400ï¼Œ500 é”™è¯¯ç æ—¶å¹¶ä¸ä¼š rejectï¼Œåªæœ‰ç½‘ç»œé”™è¯¯è¿™äº›å¯¼è‡´è¯·æ±‚ä¸èƒ½å®Œæˆæ—¶ï¼Œfetch æ‰ä¼šè¢« rejectã€‚</li></ul></blockquote><p>ç«Ÿç„¶æ²¡æœ‰æåˆ° IEï¼Œè¿™å®åœ¨å¤ªä¸ç§‘å­¦äº†ï¼Œç°åœ¨æ¥è¯¦ç»†è¯´ä¸‹ IE</p><h2 id="IE-ä½¿ç”¨ç­–ç•¥"><a href="#IE-ä½¿ç”¨ç­–ç•¥" class="headerlink" title="IE ä½¿ç”¨ç­–ç•¥"></a>IE ä½¿ç”¨ç­–ç•¥</h2><p>æ‰€æœ‰ç‰ˆæœ¬çš„ IE å‡ä¸æ”¯æŒåŸç”Ÿ Fetchï¼Œfetch-ie8 ä¼šè‡ªåŠ¨ä½¿ç”¨ XHR åš polyfillã€‚ä½†åœ¨è·¨åŸŸæ—¶æœ‰ä¸ªé—®é¢˜éœ€è¦å¤„ç†ã€‚</p><p>IE8, 9 çš„ XHR ä¸æ”¯æŒ CORS è·¨åŸŸï¼Œè™½ç„¶æä¾› XDomainRequestï¼Œä½†è¿™ä¸ªä¸œè¥¿å°±æ˜¯ç©å…·ï¼Œä¸æ”¯æŒä¼  Cookieï¼å¦‚æœæ¥å£éœ€è¦æƒé™éªŒè¯ï¼Œè¿˜æ˜¯ä¹–ä¹–åœ°ä½¿ç”¨ jsonp å§ï¼Œæ¨èä½¿ç”¨ <a href="https://github.com/camsong/fetch-jsonp" target="_blank" rel="noopener">fetch-jsonp</a>ã€‚å¦‚æœæœ‰é—®é¢˜ç›´æ¥æ issueï¼Œæˆ‘ä¼šç¬¬ä¸€æ—¶é—´è§£å†³ã€‚</p><h2 id="Fetch-å’Œæ ‡å‡†-Promise-çš„ä¸è¶³"><a href="#Fetch-å’Œæ ‡å‡†-Promise-çš„ä¸è¶³" class="headerlink" title="Fetch å’Œæ ‡å‡† Promise çš„ä¸è¶³"></a>Fetch å’Œæ ‡å‡† Promise çš„ä¸è¶³</h2><p>ç”±äº Fetch æ˜¯å…¸å‹çš„å¼‚æ­¥åœºæ™¯ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†é‡åˆ°çš„é—®é¢˜ä¸æ˜¯ Fetch çš„ï¼Œå…¶å®æ˜¯ Promise çš„ã€‚ES6 çš„ Promise æ˜¯åŸºäº<font color = "blue"> Promises/A+ æ ‡å‡† </font>ï¼Œä¸ºäº†ä¿æŒ ç®€å•ç®€æ´ ï¼Œåªæä¾›æç®€çš„å‡ ä¸ª APIã€‚å¦‚æœä½ ç”¨è¿‡ä¸€äº›ç‰› X çš„å¼‚æ­¥åº“ï¼Œå¦‚ jQuery(ä¸è¦ç¬‘) ã€Q.js æˆ–è€… RSVP.jsï¼Œå¯èƒ½ä¼šæ„Ÿè§‰ Promise åŠŸèƒ½å¤ªå°‘äº†ã€‚</p><h3 id="æ²¡æœ‰-Deferred"><a href="#æ²¡æœ‰-Deferred" class="headerlink" title="æ²¡æœ‰ Deferred"></a>æ²¡æœ‰ Deferred</h3><p>Deferred å¯ä»¥åœ¨åˆ›å»º Promise æ—¶å¯ä»¥å‡å°‘ä¸€å±‚åµŒå¥—ï¼Œè¿˜æœ‰å°±æ˜¯è·¨æ–¹æ³•ä½¿ç”¨æ—¶å¾ˆæ–¹ä¾¿ã€‚<br>ECMAScript 11 å¹´å°±æœ‰è¿‡ Deferred ææ¡ˆï¼Œä½†åæ¥æ²¡è¢«æ¥å—ã€‚å…¶å®ç”¨ Promise ä¸åˆ°åè¡Œä»£ç å°±èƒ½å®ç° Deferredï¼šes6-deferredã€‚ç°åœ¨æœ‰äº† async/awaitï¼Œgenerator/yield åï¼Œdeferred å°±æ²¡æœ‰ä½¿ç”¨ä»·å€¼äº†ã€‚</p><h3 id="æ²¡æœ‰è·å–çŠ¶æ€æ–¹æ³•ï¼šisRejectedï¼ŒisResolved"><a href="#æ²¡æœ‰è·å–çŠ¶æ€æ–¹æ³•ï¼šisRejectedï¼ŒisResolved" class="headerlink" title="æ²¡æœ‰è·å–çŠ¶æ€æ–¹æ³•ï¼šisRejectedï¼ŒisResolved"></a>æ²¡æœ‰è·å–çŠ¶æ€æ–¹æ³•ï¼šisRejectedï¼ŒisResolved</h3><p>æ ‡å‡† Promise æ²¡æœ‰æä¾›è·å–å½“å‰çŠ¶æ€ rejected æˆ–è€… resolved çš„æ–¹æ³•ã€‚åªå…è®¸å¤–éƒ¨ä¼ å…¥æˆåŠŸæˆ–å¤±è´¥åçš„å›è°ƒã€‚æˆ‘è®¤ä¸ºè¿™å…¶å®æ˜¯ä¼˜ç‚¹ï¼Œè¿™æ˜¯ä¸€ç§å£°æ˜å¼çš„æ¥å£ï¼Œæ›´ç®€å•ã€‚</p><h3 id="ç¼ºå°‘å…¶å®ƒä¸€äº›æ–¹æ³•ï¼šalwaysï¼Œprogressï¼Œfinally"><a href="#ç¼ºå°‘å…¶å®ƒä¸€äº›æ–¹æ³•ï¼šalwaysï¼Œprogressï¼Œfinally" class="headerlink" title="ç¼ºå°‘å…¶å®ƒä¸€äº›æ–¹æ³•ï¼šalwaysï¼Œprogressï¼Œfinally"></a>ç¼ºå°‘å…¶å®ƒä¸€äº›æ–¹æ³•ï¼šalwaysï¼Œprogressï¼Œfinally</h3><p>always å¯ä»¥é€šè¿‡åœ¨ then å’Œ catch é‡Œé‡å¤è°ƒç”¨æ–¹æ³•å®ç°ã€‚finally ä¹Ÿç±»ä¼¼ã€‚progress è¿™ç§è¿›åº¦é€šçŸ¥çš„åŠŸèƒ½è¿˜æ²¡æœ‰ç”¨è¿‡ï¼Œæš‚ä¸çŸ¥é“å¦‚ä½•æ›¿ä»£ã€‚</p><h3 id="ä¸èƒ½ä¸­æ–­ï¼Œæ²¡æœ‰-abortã€terminateã€onTimeout-æˆ–-cancel-æ–¹æ³•"><a href="#ä¸èƒ½ä¸­æ–­ï¼Œæ²¡æœ‰-abortã€terminateã€onTimeout-æˆ–-cancel-æ–¹æ³•" class="headerlink" title="ä¸èƒ½ä¸­æ–­ï¼Œæ²¡æœ‰ abortã€terminateã€onTimeout æˆ– cancel æ–¹æ³•"></a>ä¸èƒ½ä¸­æ–­ï¼Œæ²¡æœ‰ abortã€terminateã€onTimeout æˆ– cancel æ–¹æ³•</h3><p>Fetch å’Œ Promise ä¸€æ ·ï¼Œä¸€æ—¦å‘èµ·ï¼Œä¸èƒ½ä¸­æ–­ï¼Œä¹Ÿä¸ä¼šè¶…æ—¶ï¼Œåªèƒ½ç­‰å¾…è¢« resolve æˆ– rejectã€‚å¹¸è¿çš„æ˜¯ï¼Œwhatwg ç›®å‰æ­£åœ¨å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ whatwg/fetch#27</p><p>ç›¸å…³èµ„æº<br><a href="https://fetch.spec.whatwg.org/" target="_blank" rel="noopener">WHATWG Fetch è§„èŒƒ</a><br><a href="http://bubkoo.com/2015/05/08/introduction-to-fetch/" target="_blank" rel="noopener">Fetch API</a><br><a href="http://www.ruanyifeng.com/blog/2015/05/async.html" target="_blank" rel="noopener">é˜®ä¸€å³°async</a></p><p><a href="https://github.com/camsong/blog/issues/2" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Fetch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gitåˆ†å¸ƒå¼ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿä½¿ç”¨</title>
      <link href="/2018/03/09/Tools/Git%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8/"/>
      <url>/2018/03/09/Tools/Git%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>#å¿«é€Ÿå¼€å§‹</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="windowså®‰è£…"><a href="#windowså®‰è£…" class="headerlink" title="windowså®‰è£…"></a>windowså®‰è£…</h3><p>åœ¨Windowsä¸Šä½¿ç”¨Gitï¼Œå¯ä»¥ä»Gitå®˜ç½‘ç›´æ¥<a href="https://gitforwindows.org/" target="_blank" rel="noopener">ä¸‹è½½å®‰è£…ç¨‹åº</a>ï¼Œï¼ˆç½‘é€Ÿæ…¢çš„åŒå­¦è¯·ç§»æ­¥å›½å†…é•œåƒï¼‰ï¼Œç„¶åæŒ‰é»˜è®¤é€‰é¡¹å®‰è£…å³å¯ã€‚</p><p>å®‰è£…å®Œæˆåï¼Œåœ¨å¼€å§‹èœå•é‡Œæ‰¾åˆ°â€œGitâ€-&gt;â€œGit Bashâ€ï¼Œè¹¦å‡ºä¸€ä¸ªç±»ä¼¼å‘½ä»¤è¡Œçª—å£çš„ä¸œè¥¿ï¼Œå°±è¯´æ˜Gitå®‰è£…æˆåŠŸï¼<br>å®‰è£…å®Œæˆåï¼Œè¿˜éœ€è¦æœ€åä¸€æ­¥è®¾ç½®ï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥ï¼š</p><pre><code class="javascript">$ git config --global user.name &quot;Your Name&quot;$ git config --global user.email &quot;email@example.com&quot;</code></pre><h3 id="macå®‰è£…"><a href="#macå®‰è£…" class="headerlink" title="macå®‰è£…"></a>macå®‰è£…</h3><p>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨Macåšå¼€å‘ï¼Œæœ‰ä¸¤ç§å®‰è£…Gitçš„æ–¹æ³•ã€‚</p><p>ä¸€æ˜¯å®‰è£…homebrewï¼Œç„¶åé€šè¿‡homebrewå®‰è£…Gitï¼Œå…·ä½“æ–¹æ³•è¯·å‚è€ƒhomebrewçš„æ–‡æ¡£ï¼š<a href="http://brew.sh/ã€‚" target="_blank" rel="noopener">http://brew.sh/ã€‚</a></p><p>ç¬¬äºŒç§æ–¹æ³•æ›´ç®€å•ï¼Œä¹Ÿæ˜¯æ¨èçš„æ–¹æ³•ï¼Œå°±æ˜¯ç›´æ¥ä»AppStoreå®‰è£…Xcodeï¼ŒXcodeé›†æˆäº†Gitï¼Œä¸è¿‡é»˜è®¤æ²¡æœ‰å®‰è£…ï¼Œä½ éœ€è¦è¿è¡ŒXcodeï¼Œé€‰æ‹©èœå•â€œXcodeâ€-&gt;â€œPreferencesâ€ï¼Œåœ¨å¼¹å‡ºçª—å£ä¸­æ‰¾åˆ°â€œDownloadsâ€ï¼Œé€‰æ‹©â€œCommand Line Toolsâ€ï¼Œç‚¹â€œInstallâ€å°±å¯ä»¥å®Œæˆå®‰è£…äº†ã€‚</p><a id="more"></a><h2 id="æ–°å»ºæœ¬åœ°ä»“åº“"><a href="#æ–°å»ºæœ¬åœ°ä»“åº“" class="headerlink" title="æ–°å»ºæœ¬åœ°ä»“åº“"></a>æ–°å»ºæœ¬åœ°ä»“åº“</h2><p>ä½¿ç”¨Gitå‰ï¼Œéœ€è¦å…ˆå»ºç«‹ä¸€ä¸ªä»“åº“(repository)ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•ä½œä¸ºGitä»“åº“æˆ–åˆ›å»ºä¸€ä¸ªç©ºç›®å½•ã€‚</p><p>ä½¿ç”¨æ‚¨å½“å‰ç›®å½•ä½œä¸ºGitä»“åº“ï¼Œæˆ‘ä»¬åªéœ€ä½¿å®ƒåˆå§‹åŒ–ã€‚</p><pre><code class="javascript">git init  XXX</code></pre><h2 id="æ·»åŠ æ–°æ–‡ä»¶"><a href="#æ·»åŠ æ–°æ–‡ä»¶" class="headerlink" title="æ·»åŠ æ–°æ–‡ä»¶"></a>æ·»åŠ æ–°æ–‡ä»¶</h2><p>æˆ‘ä»¬æœ‰ä¸€ä¸ªä»“åº“ï¼Œä½†ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œå¯ä»¥ä½¿ç”¨addå‘½ä»¤æ·»åŠ æ–‡ä»¶ã€‚</p><pre><code class="javascript">git add filename</code></pre><p>å¯ä»¥ä½¿ç”¨addâ€¦ ç»§ç»­æ·»åŠ ä»»åŠ¡æ–‡ä»¶ã€‚</p><h2 id="æäº¤ç‰ˆæœ¬"><a href="#æäº¤ç‰ˆæœ¬" class="headerlink" title="æäº¤ç‰ˆæœ¬"></a>æäº¤ç‰ˆæœ¬</h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»æ·»åŠ äº†è¿™äº›æ–‡ä»¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¬èƒ½å¤ŸçœŸæ­£è¢«ä¿å­˜åœ¨Gitä»“åº“ã€‚</p><p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å®ƒä»¬æäº¤åˆ°ä»“åº“ã€‚</p><pre><code class="javascript">git commit -m &quot;Adding files&quot;</code></pre><p>å¦‚æœæ‚¨ä¸ä½¿ç”¨-mï¼Œä¼šå‡ºç°ç¼–è¾‘å™¨æ¥è®©ä½ å†™è‡ªå·±çš„æ³¨é‡Šä¿¡æ¯ã€‚</p><p>å½“æˆ‘ä»¬ä¿®æ”¹äº†å¾ˆå¤šæ–‡ä»¶ï¼Œè€Œä¸æƒ³æ¯ä¸€ä¸ªéƒ½addï¼Œæƒ³commitè‡ªåŠ¨æ¥æäº¤æœ¬åœ°ä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨-aæ ‡è¯†ã€‚</p><pre><code class="javascript">git commit -a -m &quot;Changed some files&quot;</code></pre><p>git commit å‘½ä»¤çš„-aé€‰é¡¹å¯å°†<strong>æ‰€æœ‰è¢«ä¿®æ”¹æˆ–è€…å·²åˆ é™¤çš„ä¸”å·²ç»è¢«gitç®¡ç†çš„æ–‡æ¡£</strong>æäº¤åˆ°ä»“åº“ä¸­ã€‚</p><font color = "red">åƒä¸‡æ³¨æ„ï¼Œ-aä¸ä¼šé€ æˆæ–°æ–‡ä»¶è¢«æäº¤ï¼Œåªèƒ½ä¿®æ”¹</font><h2 id="å‘å¸ƒç‰ˆæœ¬"><a href="#å‘å¸ƒç‰ˆæœ¬" class="headerlink" title="å‘å¸ƒç‰ˆæœ¬"></a>å‘å¸ƒç‰ˆæœ¬</h2><p>æˆ‘ä»¬å…ˆä»æœåŠ¡å™¨å…‹éš†ä¸€ä¸ªåº“å¹¶ä¸Šä¼ ã€‚</p><pre><code class="javascript">git clone ssh://example.com/~/www/project.git</code></pre><p>ç°åœ¨æˆ‘ä»¬ä¿®æ”¹ä¹‹åå¯ä»¥è¿›è¡Œæ¨é€åˆ°æœåŠ¡å™¨ã€‚</p><pre><code class="javascript">git push ssh://example.com/~/www/project.git</code></pre><h2 id="å–å›æ›´æ–°"><a href="#å–å›æ›´æ–°" class="headerlink" title="å–å›æ›´æ–°"></a>å–å›æ›´æ–°</h2><p>å¦‚æœæ‚¨å·²ç»æŒ‰ä¸Šé¢çš„è¿›è¡Œpushï¼Œä¸‹é¢å‘½ä»¤è¡¨ç¤ºï¼Œå½“å‰åˆ†æ”¯è‡ªåŠ¨ä¸å”¯ä¸€ä¸€ä¸ªè¿½è¸ªåˆ†æ”¯è¿›è¡Œåˆå¹¶ã€‚</p><pre><code class="javascript">git pull</code></pre><p>ä»éé»˜è®¤ä½ç½®æ›´æ–°åˆ°æŒ‡å®šçš„urlã€‚</p><pre><code class="javascript">git pull http://git.example.com/project.git</code></pre><h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><p>å¦‚ä½•ä½ æƒ³ä»èµ„æºåº“ä¸­åˆ é™¤æ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨rmã€‚</p><pre><code class="javascript">git rm file</code></pre><h2 id="åˆ†å¸ƒä¸åˆå¹¶"><a href="#åˆ†å¸ƒä¸åˆå¹¶" class="headerlink" title="åˆ†å¸ƒä¸åˆå¹¶"></a>åˆ†å¸ƒä¸åˆå¹¶</h2><p>åˆ†æ”¯åœ¨æœ¬åœ°å®Œæˆï¼Œé€Ÿåº¦å¿«ã€‚è¦åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯ï¼Œæˆ‘ä»¬ä½¿ç”¨branchå‘½ä»¤ã€‚</p><pre><code class="javascript">git branch test</code></pre><p>branchå‘½ä»¤ä¸ä¼šå°†æˆ‘ä»¬å¸¦å…¥åˆ†æ”¯ï¼Œåªæ˜¯åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ã€‚æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨checkoutå‘½ä»¤æ¥æ›´æ”¹åˆ†æ”¯ã€‚</p><pre><code class="javascript">git checkout test</code></pre><p>ç¬¬ä¸€ä¸ªåˆ†æ”¯ï¼Œæˆ–ä¸»åˆ†æ”¯ï¼Œè¢«ç§°ä¸ºâ€masterâ€ã€‚</p><pre><code class="javascript">git checkout master</code></pre><p>å¯¹å…¶ä»–åˆ†æ”¯çš„æ›´æ”¹ä¸ä¼šåæ˜ åœ¨ä¸»åˆ†æ”¯ä¸Šã€‚å¦‚æœæƒ³å°†æ›´æ”¹æäº¤åˆ°ä¸»åˆ†æ”¯ï¼Œåˆ™éœ€åˆ‡æ¢å›masteråˆ†æ”¯ï¼Œç„¶åä½¿ç”¨åˆå¹¶ã€‚</p><pre><code class="javascript">git checkout mastergit merge test</code></pre><p>å¦‚æœæ‚¨æƒ³åˆ é™¤åˆ†æ”¯ï¼Œæˆ‘ä»¬ä½¿ç”¨-dæ ‡è¯†ã€‚</p><pre><code class="javascript">git branch -d test</code></pre>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React-routerå­¦ä¹ </title>
      <link href="/2018/03/08/React/React-router/React-router%E5%AD%A6%E4%B9%A0/"/>
      <url>/2018/03/08/React/React-router/React-router%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="React-router-APIæ¥å£"><a href="#React-router-APIæ¥å£" class="headerlink" title="React-router APIæ¥å£"></a>React-router APIæ¥å£</h1><p><a href="https://reacttraining.com/react-router/web/example/basic" target="_blank" rel="noopener">demo åœ°å€</a></p><h2 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h2><h3 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h3><p>React Router çš„é‡è¦ç»„ä»¶ã€‚å®ƒèƒ½ä¿æŒ UI å’Œ URL çš„åŒæ­¥ã€‚</p><h4 id="Props-children-required"><a href="#Props-children-required" class="headerlink" title="Props children(required)"></a><strong>Props</strong> <em>children(required)</em></h4><p>ä¸€ä¸ªæˆ–å¤šä¸ªçš„ Route æˆ– PlainRouteã€‚å½“ history æ”¹å˜æ—¶ï¼Œ <code>&lt;Router&gt;</code> ä¼šåŒ¹é…å‡º Route çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶ä¸”æ¸²æŸ“è¿™ä¸ªåˆ†æ”¯ä¸­é…ç½®çš„ç»„ä»¶ï¼Œæ¸²æŸ“æ—¶ä¿æŒçˆ¶ route ç»„ä»¶åµŒå¥—å­ route ç»„ä»¶ã€‚</p><h5 id="routes"><a href="#routes" class="headerlink" title="routes"></a><strong>routes</strong></h5><p>children çš„åˆ«åã€‚</p><h5 id="history"><a href="#history" class="headerlink" title="history"></a><strong>history</strong></h5><p>Router ç›‘å¬çš„ history å¯¹è±¡ï¼Œç”± history åŒ…æä¾›ã€‚<br>å…³äºhistoryçš„äº”ä¸ªå‡½æ•°</p><blockquote><ul><li>createElement(Component, props)</li></ul></blockquote><p>å½“ route å‡†å¤‡æ¸²æŸ“ route ç»„ä»¶çš„ä¸€ä¸ªåˆ†æ”¯æ—¶ï¼Œå°±ä¼šç”¨è¿™ä¸ªå‡½æ•°æ¥åˆ›å»º elementã€‚å½“ä½ ä½¿ç”¨æŸç§å½¢å¼çš„æ•°æ®è¿›è¡ŒæŠ½è±¡æ—¶ï¼Œä½ å¯ä»¥æƒ³è¦è·å–åˆ›å»º element çš„æ§åˆ¶æƒï¼Œä¾‹å¦‚åœ¨è¿™é‡Œè®¾ç½®ç»„ä»¶ç›‘å¬ store çš„å˜åŒ–ï¼Œæˆ–è€…ä½¿ç”¨ props ä¸ºæ¯ä¸ªç»„ä»¶ä¼ å…¥ä¸€äº›åº”ç”¨æ¨¡å—ã€‚</p><blockquote><ul><li>stringifyQuery(queryObject)</li></ul></blockquote><p>ä¸€ä¸ªç”¨äºæŠŠ Link æˆ–è°ƒç”¨ transitionTo å‡½æ•°çš„å¯¹è±¡è½¬åŒ–æˆ URL query å­—ç¬¦ä¸²çš„å‡½æ•°ã€‚</p><blockquote><ul><li>parseQueryString(queryString)</li></ul></blockquote><p>ä¸€ä¸ªç”¨äºæŠŠ query å­—ç¬¦ä¸²è½¬åŒ–æˆå¯¹è±¡ï¼Œå¹¶ä¼ é€’ç»™ route ç»„ä»¶ props çš„å‡½æ•°ã€‚</p><blockquote><ul><li>onError(error)</li></ul></blockquote><p>å½“è·¯ç”±åŒ¹é…åˆ°æ—¶ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ï¼Œæ­¤æ—¶ä½ å°±å¯ä»¥æ•è·å’Œå¤„ç†è¿™äº›é”™è¯¯ã€‚é€šå¸¸ï¼Œå®ƒä»¬ä¼šæ¥è‡ªé‚£äº›å¼‚æ­¥çš„ç‰¹æ€§ï¼Œå¦‚ route.getComponentsï¼Œroute.getIndexRouteï¼Œå’Œ route.getChildRoutesã€‚</p><blockquote><ul><li>onUpdate()</li></ul></blockquote><p>å½“ URL æ”¹å˜æ—¶ï¼Œéœ€è¦æ›´æ–°è·¯ç”±çš„ state æ—¶ä¼šè¢«è°ƒç”¨ã€‚</p><h3 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h3><p>å…è®¸ç”¨æˆ·æµè§ˆåº”ç”¨çš„ä¸»è¦æ–¹å¼ã€‚<code>&lt;Link&gt;</code> ä»¥é€‚å½“çš„ href å»æ¸²æŸ“ä¸€ä¸ªå¯è®¿é—®çš„é”šæ ‡ç­¾ã€‚</p><p><code>&lt;Link&gt;</code> å¯ä»¥çŸ¥é“å“ªä¸ª route çš„é“¾æ¥æ˜¯æ¿€æ´»çŠ¶æ€çš„ï¼Œå¹¶å¯ä»¥è‡ªåŠ¨ä¸ºè¯¥é“¾æ¥æ·»åŠ  activeClassName æˆ– activeStyleã€‚</p><a id="more"></a><h4 id="Props"><a href="#Props" class="headerlink" title="Props"></a><strong>Props</strong></h4><h5 id="to"><a href="#to" class="headerlink" title="to"></a><em>to</em></h5><p>è·³è½¬é“¾æ¥çš„è·¯å¾„ï¼Œå¦‚ /users/123ã€‚</p><h5 id="query"><a href="#query" class="headerlink" title="query"></a><em>query</em></h5><p>å·²ç»è½¬åŒ–æˆå­—ç¬¦ä¸²çš„é”®å€¼å¯¹çš„å¯¹è±¡ã€‚</p><h5 id="hash"><a href="#hash" class="headerlink" title="hash"></a><em>hash</em></h5><p>URL çš„ hash å€¼ï¼Œå¦‚ #a-hashã€‚<br><code>&lt;font color = &quot;red&quot;&gt;</code>æ³¨æ„ï¼šReact Router ç›®å‰è¿˜ä¸èƒ½ç®¡ç†æ»šåŠ¨æ¡çš„ä½ç½®ï¼Œå¹¶ä¸”ä¸ä¼šè‡ªåŠ¨æ»šåŠ¨åˆ° hash å¯¹åº”çš„å…ƒç´ ä¸Šã€‚å¦‚æœéœ€è¦ç®¡ç†æ»šåŠ¨æ¡ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://github.com/taion/scroll-behavior" target="_blank" rel="noopener">scroll-behavior</a> è¿™ä¸ªåº“ã€‚<br><code>&lt;/font&gt;</code></p><h5 id="state"><a href="#state" class="headerlink" title="state"></a><em>state</em></h5><p>ä¿å­˜åœ¨ location ä¸­çš„ state</p><h5 id="activeClassName"><a href="#activeClassName" class="headerlink" title="activeClassName"></a><em>activeClassName</em></h5><p>å½“æŸä¸ª route æ˜¯æ¿€æ´»çŠ¶æ€æ—¶ï¼Œ<code>&lt;Link&gt;</code> å¯ä»¥æ¥æ”¶ä¼ å…¥çš„ classNameã€‚å¤±æ´»çŠ¶æ€ä¸‹æ˜¯é»˜è®¤çš„ classã€‚</p><h5 id="activeStyle"><a href="#activeStyle" class="headerlink" title="activeStyle"></a><em>activeStyle</em></h5><p>å½“æŸä¸ª route æ˜¯æ¿€æ´»çŠ¶æ€æ—¶ï¼Œå¯ä»¥å°†æ ·å¼æ·»åŠ åˆ°é“¾æ¥å…ƒç´ ä¸Šã€‚</p><h5 id="onClick-e"><a href="#onClick-e" class="headerlink" title="onClick(e)"></a><em>onClick(e)</em></h5><p>è‡ªå®šä¹‰ç‚¹å‡»äº‹ä»¶çš„å¤„ç†æ–¹æ³•ã€‚å¦‚å¤„ç† <code>&lt;a&gt;</code> æ ‡ç­¾ä¸€æ · - è°ƒç”¨ <strong>e.preventDefault()</strong>æ¥é˜²æ­¢è¿‡åº¦çš„ç‚¹å‡»ï¼ŒåŒæ—¶ <strong>e.stopPropagation()</strong>å¯ä»¥é˜»æ­¢å†’æ³¡çš„äº‹ä»¶ã€‚</p><h5 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a><em>å…¶ä»–</em></h5><p>ä½ ä¹Ÿå¯ä»¥åœ¨ <code>&lt;a&gt;</code> æ ‡ç­¾ä¸Šä¼ å…¥ä¸€äº›ä½ æƒ³è¦çš„ propsï¼Œå¦‚ titleï¼Œidï¼ŒclassName ç­‰ç­‰ã€‚</p><h5 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a><strong>ç¤ºä¾‹</strong></h5><p>å¦‚ <code>&lt;Route path=&quot;/users/:userId&quot; /&gt;</code> è¿™æ ·çš„ routeï¼š</p><pre><code class="html">&lt;Link to={`/users/${user.id}`} activeClassName=&quot;active&quot;&gt;{user.name}&lt;/Link&gt;// å˜æˆå®ƒä»¬å…¶ä¸­ä¸€ä¸ªä¾èµ–åœ¨ History ä¸Šï¼Œå½“è¿™ä¸ª route æ˜¯// æ¿€æ´»çŠ¶æ€çš„&lt;a href=&quot;/users/123&quot; class=&quot;active&quot;&gt;Michael&lt;/a&gt;&lt;a href=&quot;#/users/123&quot;&gt;Michael&lt;/a&gt;// ä¿®æ”¹ activeClassName&lt;Link to={`/users/${user.id}`} activeClassName=&quot;current&quot;&gt;{user.name}&lt;/Link&gt;// å½“é“¾æ¥æ¿€æ´»æ—¶ï¼Œä¿®æ”¹å®ƒçš„æ ·å¼&lt;Link to=&quot;/users&quot; style={{color: 'white'}} activeStyle={{color: 'red'}}&gt;Users&lt;/Link&gt;</code></pre><h3 id="IndexLink"><a href="#IndexLink" class="headerlink" title="IndexLink"></a>IndexLink</h3><p>å¦‚æœé“¾æ¥åˆ°æ ¹è·¯ç”±/ï¼Œä¸è¦ä½¿ç”¨Linkç»„ä»¶ï¼Œè€Œè¦ä½¿ç”¨IndexLinkç»„ä»¶ã€‚</p><p>è¿™æ˜¯å› ä¸ºå¯¹äºæ ¹è·¯ç”±æ¥è¯´ï¼ŒactiveStyleå’ŒactiveClassNameä¼šå¤±æ•ˆï¼Œæˆ–è€…è¯´æ€»æ˜¯ç”Ÿæ•ˆï¼Œå› ä¸º/ä¼šåŒ¹é…ä»»ä½•å­è·¯ç”±ã€‚è€ŒIndexLinkç»„ä»¶ä¼šä½¿ç”¨è·¯å¾„çš„ç²¾ç¡®åŒ¹é…ã€‚</p><pre><code class="html">&lt;IndexLink to=&quot;/&quot; activeClassName=&quot;active&quot;&gt;  Home&lt;/IndexLink&gt;</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ ¹è·¯ç”±åªä¼šåœ¨ç²¾ç¡®åŒ¹é…æ—¶ï¼Œæ‰å…·æœ‰activeClassNameã€‚</p><p>å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨Linkç»„ä»¶çš„onlyActiveOnIndexå±æ€§ï¼Œä¹Ÿèƒ½è¾¾åˆ°åŒæ ·æ•ˆæœã€‚</p><pre><code class="html">&lt;Link to=&quot;/&quot; activeClassName=&quot;active&quot; onlyActiveOnIndex={true}&gt;  Home&lt;/Link&gt;</code></pre><h3 id="RoutingContext"><a href="#RoutingContext" class="headerlink" title="RoutingContext"></a>RoutingContext</h3><p>åœ¨ context ä¸­ç»™å®šè·¯ç”±çš„ stateã€è®¾ç½® history å¯¹è±¡å’Œå½“å‰çš„ locationï¼Œ<code>&lt;RoutingContext&gt;</code> å°±ä¼šå»æ¸²æŸ“ç»„ä»¶æ ‘ã€‚</p><h2 id="ç»„ä»¶é…ç½®"><a href="#ç»„ä»¶é…ç½®" class="headerlink" title="ç»„ä»¶é…ç½®"></a>ç»„ä»¶é…ç½®</h2><h3 id="route"><a href="#route" class="headerlink" title="route"></a>route</h3><p>Route æ˜¯ç”¨äºå£°æ˜è·¯ç”±æ˜ å°„åˆ°åº”ç”¨ç¨‹åºçš„ç»„ä»¶å±‚ã€‚</p><h4 id="Props-1"><a href="#Props-1" class="headerlink" title="Props"></a><strong>Props</strong></h4><h5 id="path"><a href="#path" class="headerlink" title="path"></a><em>path</em></h5><p>URL ä¸­çš„è·¯å¾„ã€‚</p><p>å®ƒä¼šç»„åˆçˆ¶ route çš„è·¯å¾„ï¼Œé™¤éå®ƒæ˜¯ä» / å¼€å§‹çš„ï¼Œ å°†å®ƒå˜æˆä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚</p><p>æ³¨æ„ï¼šåœ¨åŠ¨æ€è·¯ç”±ä¸­ï¼Œç»å¯¹è·¯å¾„å¯èƒ½ä¸é€‚ç”¨äº route é…ç½®ä¸­ã€‚</p><p>å¦‚æœå®ƒæ˜¯ undefinedï¼Œè·¯ç”±ä¼šå»åŒ¹é…å­ routeã€‚</p><p><em>component</em><br>å½“åŒ¹é…åˆ° URL æ—¶ï¼Œå•ä¸ªçš„ç»„ä»¶ä¼šè¢«æ¸²æŸ“ã€‚å®ƒå¯ä»¥ è¢«çˆ¶ route ç»„ä»¶çš„ this.props.children æ¸²æŸ“ã€‚</p><pre><code class="javascript">const routes = (  &lt;Route component={App}&gt;    &lt;Route path=&quot;groups&quot; component={Groups}/&gt;    &lt;Route path=&quot;users&quot; component={Users}/&gt;  &lt;/Route&gt;)class App extends React.Component {  render () {    return (      &lt;div&gt;        {/* è¿™ä¼šæ˜¯ &lt;Users&gt; æˆ– &lt;Groups&gt; */}        {this.props.children}      &lt;/div&gt;    )  }}</code></pre><h5 id="components"><a href="#components" class="headerlink" title="components"></a><em>components</em></h5><p>Route å¯ä»¥å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªå·²å‘½åçš„ç»„ä»¶ï¼Œå½“è·¯å¾„åŒ¹é…åˆ° URL æ—¶ï¼Œ å®ƒä»¬ä½œä¸º name:component å¯¹çš„ä¸€ä¸ªå¯¹è±¡å»æ¸²æŸ“ã€‚å®ƒä»¬å¯ä»¥è¢« çˆ¶ route ç»„ä»¶çš„ <code>this.props[name]</code>æ¸²æŸ“ã€‚</p><pre><code class="javascript">// æƒ³æƒ³è·¯ç”±å¤–éƒ¨çš„ context â€” å¦‚æœä½ å¯æ‹”æ’// `render` çš„éƒ¨åˆ†ï¼Œä½ å¯èƒ½éœ€è¦è¿™ä¹ˆåšï¼š// &lt;App main={&lt;Users /&gt;} sidebar={&lt;UsersSidebar /&gt;} /&gt;const routes = (  &lt;Route component={App}&gt;    &lt;Route path=&quot;groups&quot; components={{main: Groups, sidebar: GroupsSidebar}}/&gt;    &lt;Route path=&quot;users&quot; components={{main: Users, sidebar: UsersSidebar}}&gt;      &lt;Route path=&quot;users/:userId&quot; component={Profile}/&gt;    &lt;/Route&gt;  &lt;/Route&gt;)class App extends React.Component {  render () {    const { main, sidebar } = this.props    return (      &lt;div&gt;        &lt;div className=&quot;Main&quot;&gt;          {main}        &lt;/div&gt;        &lt;div className=&quot;Sidebar&quot;&gt;          {sidebar}        &lt;/div&gt;      &lt;/div&gt;    )  }}class Users extends React.Component {  render () {    return (      &lt;div&gt;        {/* å½“è·¯å¾„æ˜¯ &quot;/users/123&quot; æ˜¯ `children` ä¼šæ˜¯ &lt;Profile&gt; */}        {/* UsersSidebar ä¹Ÿå¯ä»¥è·å–ä½œä¸º this.props.children çš„ &lt;Profile&gt; ï¼Œ            æ‰€ä»¥è¿™æœ‰ç‚¹å¥‡æ€ªï¼Œä½†ä½ å¯ä»¥å†³å®šå“ªä¸€ä¸ªå¯ä»¥            ç»§ç»­è¿™ç§åµŒå¥— */}        {this.props.children}      &lt;/div&gt;    )  }}</code></pre><h5 id="getComponent-location-callback"><a href="#getComponent-location-callback" class="headerlink" title="getComponent(location, callback)"></a><em>getComponent(location, callback)</em></h5><p>ä¸ component ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¼‚æ­¥çš„ï¼Œå¯¹äº code-splitting å¾ˆæœ‰ç”¨ã€‚</p><p><strong>callback signature</strong><br><code>cb(err, component)</code></p><pre><code class="javascript">&lt;Route path=&quot;courses/:courseId&quot; getComponent={(location, cb) =&gt; {  // åšä¸€äº›å¼‚æ­¥æ“ä½œå»æŸ¥æ‰¾ç»„ä»¶  cb(null, Course)}}/&gt;</code></pre><h5 id="getComponents-location-callback"><a href="#getComponents-location-callback" class="headerlink" title="getComponents(location, callback)"></a><em>getComponents(location, callback)</em></h5><p>ä¸ component ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¼‚æ­¥çš„ï¼Œå¯¹äº code-splitting å¾ˆæœ‰ç”¨ã€‚</p><p><strong>callback signature</strong><br><code>cb(err, components)</code></p><pre><code class="javascript">&lt;Route path=&quot;courses/:courseId&quot; getComponent={(location, cb) =&gt; {  // åšä¸€äº›å¼‚æ­¥æ“ä½œå»æŸ¥æ‰¾ç»„ä»¶  cb(null, {sidebar: CourseSidebar, content: Course})}}/&gt;</code></pre><h5 id="children"><a href="#children" class="headerlink" title="children"></a><em>children</em></h5><p>Route å¯ä»¥è¢«åµŒå¥—ï¼Œthis.props.children åŒ…å«äº†ä»å­ route ç»„ä»¶åˆ›å»ºçš„å…ƒç´ ã€‚ç”±äºè¿™æ˜¯è·¯ç”±è®¾è®¡ä¸­éå¸¸é‡è¦çš„éƒ¨åˆ†ï¼Œè¯·å‚è€ƒ Route é…ç½®ã€‚</p><p>ä¸¤ä¸ªè·¯ç”±é’©å­ï¼š<br><code>&lt;font color = &quot;red&quot;&gt;onEnter(nextState, replaceState, callback?)&lt;/font&gt;</code></p><p>å½“ route å³å°†è¿›å…¥æ—¶è°ƒç”¨ã€‚å®ƒæä¾›äº†ä¸‹ä¸€ä¸ªè·¯ç”±çš„ stateï¼Œä¸€ä¸ªå‡½æ•°é‡å®šå‘åˆ°å¦ä¸€ä¸ªè·¯å¾„ã€‚this ä¼šè§¦å‘é’©å­å»åˆ›å»º route å®ä¾‹ã€‚<br>å½“ callback ä½œä¸ºå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥æ—¶ï¼Œè¿™ä¸ªé’©å­å°†æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå¹¶ä¸”è·³è½¬ä¼šé˜»å¡ç›´åˆ° callback è¢«è°ƒç”¨ã€‚</p><p><code>&lt;font color = &quot;red&quot;&gt;onLeave()&lt;/font&gt;</code><br>å½“ route å³å°†é€€å‡ºæ—¶è°ƒç”¨ã€‚</p><h3 id="PlainRoute"><a href="#PlainRoute" class="headerlink" title="PlainRoute"></a>PlainRoute</h3><p>route å®šä¹‰çš„ä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ã€‚ Router æŠŠ JSX çš„ <code>&lt;Route&gt;</code> è½¬åŒ–åˆ°è¿™ä¸ªå¯¹è±¡ä¸­ï¼Œå¦‚æœä½ å–œæ¬¢ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒä»¬ã€‚ æ‰€æœ‰çš„ props éƒ½å’Œ <code>&lt;Route&gt;</code> çš„ props ä¸€æ ·ï¼Œé™¤äº†é‚£äº›åˆ—åœ¨è¿™é‡Œçš„ã€‚</p><h4 id="props"><a href="#props" class="headerlink" title="props"></a><strong>props</strong></h4><h5 id="childRoutes"><a href="#childRoutes" class="headerlink" title="childRoutes"></a><em>childRoutes</em></h5><p>å­ route çš„ä¸€ä¸ªæ•°ç»„ï¼Œä¸åœ¨ JSX route é…ç½®ä¸­çš„ children ä¸€æ ·ã€‚</p><p><code>&lt;font color = &quot;red&quot;&gt;getChildRoutes(location, callback)&lt;/font&gt;</code></p><p>ä¸ childRoutes ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”å¯ä»¥æ¥æ”¶ locationã€‚å¯¹äº code-splitting å’ŒåŠ¨æ€è·¯ç”±åŒ¹é…å¾ˆæœ‰ç”¨ï¼ˆç»™å®šä¸€äº› state æˆ– session æ•°æ®ä¼šè¿”å›ä¸åŒçš„å­ routeï¼‰ã€‚</p><p><em>callback signature</em><br>cb(err, routesArray)</p><pre><code class="javascript">let myRoute = {  path: &#39;course/:courseId&#39;,  childRoutes: [    announcementsRoute,    gradesRoute,    assignmentsRoute  ]}// å¼‚æ­¥çš„å­ routelet myRoute = {  path: &#39;course/:courseId&#39;,  getChildRoutes(location, cb) {    // åšä¸€äº›å¼‚æ­¥æ“ä½œå»æŸ¥æ‰¾å­ route    cb(null, [ announcementsRoute, gradesRoute, assignmentsRoute ])  }}// å¯ä»¥æ ¹æ®ä¸€äº› state// è·³è½¬åˆ°ä¾èµ–çš„å­ route&lt;Link to=&quot;/picture/123&quot; state={{ fromDashboard: true }}/&gt;let myRoute = {  path: &#39;picture/:id&#39;,  getChildRoutes(location, cb) {    let { state } = location    if (state &amp;&amp; state.fromDashboard) {      cb(null, [dashboardPictureRoute])    } else {      cb(null, [pictureRoute])    }  }}</code></pre><h5 id="indexRoute"><a href="#indexRoute" class="headerlink" title="indexRoute"></a><em>indexRoute</em></h5><p>index routeã€‚è¿™ä¸åœ¨ä½¿ç”¨ JSX route é…ç½®æ—¶æŒ‡å®šä¸€ä¸ª <IndexRoute> å­é›†ä¸€æ ·ã€‚</p><p><code>&lt;font color = &quot;red&quot;&gt;getIndexRoute(location, callback)&lt;/font&gt;</code><br>ä¸ indexRoute ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”å¯ä»¥æ¥æ”¶ locationã€‚ä¸ getChildRoutes ä¸€æ ·ï¼Œå¯¹äº code-splitting å’ŒåŠ¨æ€è·¯ç”±åŒ¹é…å¾ˆæœ‰ç”¨</p><p><em>callback signature</em><br>cb(err, route)</p><pre><code class="javascript">// ä¾‹å¦‚ï¼šlet myIndexRoute = {  component: MyIndex}let myRoute = {  path: &#39;courses&#39;,  indexRoute: myIndexRoute}// å¼‚æ­¥çš„ index routelet myRoute = {  path: &#39;courses&#39;,  getIndexRoute(location, cb) {    // åšä¸€äº›å¼‚æ­¥æ“ä½œ    cb(null, myIndexRoute)  }}</code></pre><h3 id="Redirect"><a href="#Redirect" class="headerlink" title="Redirect"></a>Redirect</h3><p>åœ¨åº”ç”¨ä¸­ <code>&lt;Redirect&gt;</code> å¯ä»¥è®¾ç½®é‡å®šå‘åˆ°å…¶ä»– route è€Œä¸æ”¹å˜æ—§çš„ URLã€‚</p><h4 id="Props-2"><a href="#Props-2" class="headerlink" title="Props"></a><strong>Props</strong></h4><h5 id="from"><a href="#from" class="headerlink" title="from"></a>from</h5><p>ä½ æƒ³ç”±å“ªä¸ªè·¯å¾„è¿›è¡Œé‡å®šå‘ï¼ŒåŒ…æ‹¬åŠ¨æ€æ®µã€‚</p><h5 id="to-1"><a href="#to-1" class="headerlink" title="to"></a>to</h5><p>ä½ æƒ³é‡å®šå‘çš„è·¯å¾„ã€‚</p><h5 id="query-1"><a href="#query-1" class="headerlink" title="query"></a>query</h5><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œquery çš„å‚æ•°åªä¼šç»è¿‡ï¼Œä½†å¦‚æœä½ éœ€è¦ä½ å¯ä»¥æŒ‡å®šå®ƒä»¬ã€‚</p><pre><code class="javascript">// æˆ‘ä»¬éœ€è¦ä» `/profile/123` æ”¹å˜åˆ° `/about/123`// å¹¶ä¸”ç”± `/get-in-touch` é‡å®šå‘åˆ° `/contact`&lt;Route component={App}&gt;  &lt;Route path=&quot;about/:userId&quot; component={UserProfile}/&gt;  {/* /profile/123 -&gt; /about/123 */}  &lt;Redirect from=&quot;profile/:userId&quot; to=&quot;about/:userId&quot; /&gt;&lt;/Route&gt;</code></pre><p>æ³¨æ„ï¼Œåœ¨ route å±‚ <code>&lt;Redirect&gt;</code> å¯ä»¥è¢«æ”¾åœ¨ä»»ä½•åœ°æ–¹ï¼Œå°½ç®¡<font color= "blue">æ­£å¸¸çš„ä¼˜å…ˆ</font> è§„åˆ™ä»é€‚ç”¨ã€‚å¦‚æœä½ å–œæ¬¢å°†ä¸‹ä¸€ä¸ªé‡å®šå‘åˆ°å®ƒå„è‡ªçš„ route ä¸Šï¼Œfrom çš„è·¯å¾„ä¼šåŒ¹é…åˆ°ä¸€ä¸ªä¸ path ä¸€æ ·çš„æ­£å¸¸è·¯å¾„ã€‚</p><pre><code class="javascript">&lt;Route path=&quot;course/:courseId&quot;&gt;  &lt;Route path=&quot;dashboard&quot; /&gt;  {/* /course/123/home -&gt; /course/123/dashboard */}  &lt;Redirect from=&quot;home&quot; to=&quot;dashboard&quot; /&gt;&lt;/Route&gt;</code></pre><h3 id="IndexRoute"><a href="#IndexRoute" class="headerlink" title="IndexRoute"></a>IndexRoute</h3><p>å½“ç”¨æˆ·åœ¨çˆ¶ route çš„ URL æ—¶ï¼Œ Index Routes å…è®¸ä½ ä¸ºçˆ¶ route æä¾›ä¸€ä¸ªé»˜è®¤çš„ â€œchildâ€ï¼Œ å¹¶ä¸”ä¸ºä½¿<code>&lt;IndexLink&gt;</code> èƒ½ç”¨æä¾›äº†çº¦å®š</p><p>####Props<br>ä¸ Route çš„ props ä¸€æ ·ï¼Œé™¤äº† pathã€‚</p><h3 id="IndexRedirect"><a href="#IndexRedirect" class="headerlink" title="IndexRedirect"></a>IndexRedirect</h3><p>Index Redirects å…è®¸ä½ ä»ä¸€ä¸ªçˆ¶ route çš„ URL é‡å®šå‘åˆ°å…¶ä»– routeã€‚ å®ƒä»¬è¢«ç”¨äºå…è®¸å­ route ä½œä¸ºçˆ¶ route çš„é»˜è®¤ routeï¼Œ åŒæ—¶ä¿æŒç€ä¸åŒçš„ URLã€‚</p><h4 id="Props-3"><a href="#Props-3" class="headerlink" title="Props"></a>Props</h4><p>ä¸ <strong>Redirect</strong> çš„ props ä¸€æ ·ï¼Œé™¤äº† fromã€‚</p><h2 id="Route-Components"><a href="#Route-Components" class="headerlink" title="Route Components"></a>Route Components</h2><p>å½“ route åŒ¹é…åˆ° URL æ—¶ä¼šæ¸²æŸ“ä¸€ä¸ª route çš„ç»„ä»¶ã€‚è·¯ç”±ä¼šåœ¨æ¸²æŸ“æ—¶å°†ä»¥ä¸‹å±æ€§æ³¨å…¥ç»„ä»¶ä¸­ï¼š</p><h4 id="history-1"><a href="#history-1" class="headerlink" title="history"></a>history</h4><p>Router çš„ history historyã€‚<br>å¯¹äºè·³è½¬å¾ˆæœ‰ç”¨çš„ this.props.history.pushState(state, path, query)</p><h4 id="location"><a href="#location" class="headerlink" title="location"></a>location</h4><p>å½“å‰çš„ locationã€‚</p><h4 id="params"><a href="#params" class="headerlink" title="params"></a>params</h4><p>URL çš„åŠ¨æ€æ®µã€‚</p><h4 id="route-1"><a href="#route-1" class="headerlink" title="route"></a>route</h4><p>æ¸²æŸ“ç»„ä»¶çš„ routeã€‚</p><h4 id="routeParams"><a href="#routeParams" class="headerlink" title="routeParams"></a>routeParams</h4><p>this.props.params æ˜¯ç›´æ¥åœ¨ç»„ä»¶ä¸­æŒ‡å®š route çš„ä¸€ä¸ªå­é›†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ route çš„è·¯å¾„æ˜¯ <code>users/:userId</code> è€Œ URL æ˜¯ <code>/users/123/portfolios/345</code>ï¼Œé‚£ä¹ˆ <code>this.props.routeParams ä¼šæ˜¯ {userId: &#39;123&#39;}</code>ï¼Œå¹¶ä¸” <code>this.props.params</code> ä¼šæ˜¯ <code>{userId: &#39;123&#39;, portfolioId: 345}</code>ã€‚</p><h4 id="children-1"><a href="#children-1" class="headerlink" title="children"></a>children</h4><p>åŒ¹é…åˆ°å­ route çš„å…ƒç´ å°†è¢«æ¸²æŸ“ã€‚å¦‚æœ route æœ‰å·²å‘½åçš„ç»„ä»¶ï¼Œé‚£ä¹ˆæ­¤å±æ€§ä¼šæ˜¯ undefinedï¼Œå¹¶ä¸”å¯ç”¨çš„ç»„ä»¶ä¼šè¢«ç›´æ¥æ›¿æ¢åˆ° this.props ä¸Šã€‚</p><h4 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><pre><code class="javascript">render((  &lt;Router&gt;    &lt;Route path=&quot;/&quot; component={App}&gt;      &lt;Route path=&quot;groups&quot; component={Groups} /&gt;      &lt;Route path=&quot;users&quot; component={Users} /&gt;    &lt;/Route&gt;  &lt;/Router&gt;), node)class App extends React.Component {  render() {    return (      &lt;div&gt;        {/* è¿™å¯èƒ½æ˜¯ &lt;Users&gt; æˆ– &lt;Groups&gt; */}        {this.props.children}      &lt;/div&gt;    )  }}</code></pre><h3 id="å·²å‘½åçš„ç»„ä»¶"><a href="#å·²å‘½åçš„ç»„ä»¶" class="headerlink" title="å·²å‘½åçš„ç»„ä»¶"></a>å·²å‘½åçš„ç»„ä»¶</h3><p>å½“ä¸€ä¸ª <code>route</code> æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå·²å‘½åçš„ç»„ä»¶æ—¶ï¼Œå…¶å­å…ƒç´ çš„å¯ç”¨æ€§æ˜¯é€šè¿‡ <code>this.props</code> å‘½åçš„ã€‚å› æ­¤ <code>this.props.children</code> å°†ä¼šæ˜¯ undefinedã€‚é‚£ä¹ˆæ‰€æœ‰çš„ <code>route</code> ç»„ä»¶éƒ½å¯ä»¥å‚ä¸åµŒå¥—ã€‚</p><h4 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><pre><code class="js">// æ³¨é‡Šé‡Œçš„å†…å®¹æœ‰æ•ˆï¼Œä¸ºäº†è§£å†³åšå®¢æ‰“åŒ…æœªçŸ¥é”™è¯¯/*render((  &lt;Router&gt;    &lt;Route path=&quot;/&quot; component={App}&gt;      &lt;Route path=&quot;groups&quot; components={{main: Groups, sidebar: GroupsSidebar}} /&gt;      &lt;Route path=&quot;users&quot; components={{main: Users, sidebar: UsersSidebar}}&gt;        &lt;Route path=&quot;users/:userId&quot; component={Profile} /&gt;      &lt;/Route&gt;    &lt;/Route&gt;  &lt;/Router&gt;), node)class App extends React.Component {  render() {    // åœ¨çˆ¶ route ä¸­ï¼Œè¢«åŒ¹é…çš„å­ route å˜æˆ props    return (      &lt;div&gt;        &lt;div className=&quot;Main&quot;&gt;          {// è¿™å¯èƒ½æ˜¯ &lt;Groups&gt; æˆ– &lt;Users&gt;}          {this.props.main}        &lt;/div&gt;        &lt;div className=&quot;Sidebar&quot;&gt;          {// è¿™å¯èƒ½æ˜¯ &lt;GroupsSidebar&gt; æˆ– &lt;UsersSidebar&gt;}          {this.props.sidebar}        &lt;/div&gt;      &lt;/div&gt;    )  }}class Users extends React.Component {  render() {    return (      &lt;div&gt;        {// å¦‚æœåœ¨ &quot;/users/123&quot; è·¯å¾„ä¸Šè¿™ä¼šæ˜¯ &lt;Profile&gt; }        {// UsersSidebar ä¹Ÿä¼šè·å–åˆ°ä½œä¸º this.props.children çš„ &lt;Profile&gt; ã€‚            ä½ å¯ä»¥æŠŠå®ƒæ”¾è¿™æ¸²æŸ“ }        {this.props.children}      &lt;/div&gt;    )  }}*/</code></pre><h2 id="Mixins"><a href="#Mixins" class="headerlink" title="Mixins"></a>Mixins</h2><h3 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h3><p>åœ¨ç»„ä»¶ä¸­æ·»åŠ ä¸€ä¸ªé’©å­ï¼Œå½“è·¯ç”±è¦ä» route ç»„ä»¶çš„é…ç½®ä¸­è·³è½¬å‡ºæ¥æ—¶è¢«è°ƒç”¨ï¼Œå¹¶ä¸”æœ‰æœºä¼šå»å–æ¶ˆè¿™æ¬¡è·³è½¬ã€‚ä¸»è¦ç”¨äºè¡¨å•çš„éƒ¨åˆ†å¡«å†™ã€‚</p><p>åœ¨å¸¸è§„çš„è·³è½¬ä¸­ï¼Œ <em>routerWillLeave</em> ä¼šæ¥æ”¶åˆ°ä¸€ä¸ªå•ä¸€çš„å‚æ•°ï¼šæˆ‘ä»¬æ­£è¦è·³è½¬çš„ locationã€‚å»å–æ¶ˆæ­¤æ¬¡è·³è½¬ï¼Œè¿”å› falseã€‚</p><p>æç¤ºç”¨æˆ·ç¡®è®¤ï¼Œè¿”å›ä¸€ä¸ªæç¤ºä¿¡æ¯ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€‚åœ¨ web æµè§ˆå™¨ beforeunload äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œ<em>routerWillLeave</em> ä¸ä¼šæ¥æ”¶åˆ°ä¸€ä¸ª location çš„å¯¹è±¡ï¼ˆå‡è®¾ä½ æ­£åœ¨ä½¿ç”¨ useBeforeUnload history çš„å¢å¼ºæ–¹æ³•ï¼‰ã€‚åœ¨æ­¤ä¹‹ä¸Šï¼Œæˆ‘ä»¬æ˜¯ä¸å¯èƒ½çŸ¥é“è¦è·³è½¬çš„ locationï¼Œå› æ­¤ <em>outerWillLeave</em> å¿…é¡»åœ¨ç”¨æˆ·å…³é—­æ ‡ç­¾ä¹‹å‰è¿”å›ä¸€ä¸ªæç¤ºä¿¡æ¯ã€‚</p><h4 id="ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"><a href="#ç”Ÿå‘½å‘¨æœŸæ–¹æ³•" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"></a>ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</h4><font color = "red">routerWillLeave(nextLocation)</font><p>å½“è·¯ç”±å°è¯•ä»ä¸€ä¸ª route è·³è½¬åˆ°å¦ä¸€ä¸ªå¹¶ä¸”æ¸²æŸ“è¿™ä¸ªç»„ä»¶æ—¶è¢«è°ƒç”¨ã€‚</p><p><strong>arguments</strong></p><blockquote><ul><li>nextLocation - ä¸‹ä¸€ä¸ª location</li></ul></blockquote><h3 id="History-Mixins"><a href="#History-Mixins" class="headerlink" title="History Mixins"></a>History Mixins</h3><p>åœ¨ç»„ä»¶ä¸­æ·»åŠ è·¯ç”±çš„ history å¯¹è±¡ã€‚<br>å¸¸ç”¨çš„ history æœ‰ä¸‰ç§å½¢å¼ï¼Œ ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ React Router å®ç°è‡ªå®šä¹‰çš„ historyã€‚</p><blockquote><ul><li>browserHistory(Browser history æ˜¯ä½¿ç”¨ React Router çš„åº”ç”¨æ¨èçš„ historyã€‚å®ƒä½¿ç”¨æµè§ˆå™¨ä¸­çš„ History API ç”¨äºå¤„ç† URLï¼Œåˆ›å»ºä¸€ä¸ªåƒexample.com/some/pathè¿™æ ·çœŸå®çš„ URL ã€‚)</li></ul></blockquote><blockquote><ul><li>hashHistory(è·¯ç”±å°†é€šè¿‡URLçš„hashéƒ¨åˆ†ï¼ˆ#ï¼‰åˆ‡æ¢ï¼ŒURLçš„å½¢å¼ç±»ä¼¼example.com/#/some/path)</li></ul></blockquote><blockquote><ul><li>createMemoryHistory(ä¸»è¦ç”¨äºæœåŠ¡å™¨æ¸²æŸ“ã€‚å®ƒåˆ›å»ºä¸€ä¸ªå†…å­˜ä¸­çš„historyå¯¹è±¡ï¼Œä¸ä¸æµè§ˆå™¨URLäº’åŠ¨ã€‚)</li></ul></blockquote><p>ä½ å¯ä»¥ä» React Router ä¸­å¼•å…¥å®ƒä»¬ï¼š</p><pre><code class="javascript">// JavaScript æ¨¡å—å¯¼å…¥ï¼ˆè¯‘è€…æ³¨ï¼šES6 å½¢å¼ï¼‰import { browserHistory } from &#39;react-router&#39;</code></pre><p>ç„¶åå°†å®ƒä»¬ä¼ é€’ç»™<Router>:</p><pre><code class="javascript">render(  &lt;Router history={browserHistory} routes={routes} /&gt;,  document.getElementById(&#39;app&#39;))</code></pre><p><strong>å®ç°ç¤ºä¾‹</strong></p><pre><code class="javascript">import React from &#39;react&#39;import { render } from &#39;react-dom&#39;import { browserHistory, Router, Route, IndexRoute } from &#39;react-router&#39;import App from &#39;../components/App&#39;import Home from &#39;../components/Home&#39;import About from &#39;../components/About&#39;import Features from &#39;../components/Features&#39;render(  &lt;Router history={browserHistory}&gt;    &lt;Route path=&#39;/&#39; component={App}&gt;      &lt;IndexRoute component={Home} /&gt;      &lt;Route path=&#39;about&#39; component={About} /&gt;      &lt;Route path=&#39;features&#39; component={Features} /&gt;    &lt;/Route&gt;  &lt;/Router&gt;,  document.getElementById(&#39;app&#39;))</code></pre><p><strong>æ³¨æ„</strong>ï¼šä½ çš„ route components ä¸éœ€è¦è¿™ä¸ª mixinï¼Œå®ƒåœ¨ this.props.history ä¸­å·²ç»æ˜¯å¯ç”¨çš„äº†ã€‚è¿™æ˜¯ä¸ºäº†ç»„ä»¶æ›´æ·±æ¬¡çš„æ¸²æŸ“æ ‘ä¸­éœ€è¦è®¿é—®è·¯ç”±çš„ history å¯¹è±¡ã€‚</p><h4 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h4><h5 id="pushState-state-pathname-query"><a href="#pushState-state-pathname-query" class="headerlink" title="pushState(state, pathname, query)"></a>pushState(state, pathname, query)</h5><p>è·³è½¬è‡³ä¸€ä¸ªæ–°çš„ URLã€‚</p><p><strong>arguments</strong></p><blockquote><ul><li>state - location çš„ stateã€‚</li><li>pathname - æ²¡æœ‰ query å®Œæ•´çš„ URLã€‚<br>*query - é€šè¿‡è·¯ç”±å­—ç¬¦ä¸²åŒ–çš„ä¸€ä¸ªå¯¹è±¡ã€‚</li></ul></blockquote><h5 id="replaceState-state-pathname-query"><a href="#replaceState-state-pathname-query" class="headerlink" title="replaceState(state, pathname, query)"></a>replaceState(state, pathname, query)</h5><p>åœ¨ä¸å½±å“ history é•¿åº¦çš„æƒ…å†µä¸‹ï¼ˆå¦‚ä¸€ä¸ªé‡å®šå‘ï¼‰ï¼Œç”¨æ–°çš„ URL æ›¿æ¢å½“å‰è¿™ä¸ªã€‚</p><p><strong>å‚æ•°</strong></p><blockquote><ul><li>state - location çš„ stateã€‚</li><li>pathname - æ²¡æœ‰ query å®Œæ•´çš„ URLã€‚</li><li>query - é€šè¿‡è·¯ç”±å­—ç¬¦ä¸²åŒ–çš„ä¸€ä¸ªå¯¹è±¡ã€‚</li></ul></blockquote><h5 id="go-n"><a href="#go-n" class="headerlink" title="go(n)"></a>go(n)</h5><p>åœ¨ history ä¸­åé€€ã€‚</p><h5 id="goForward"><a href="#goForward" class="headerlink" title="goForward()"></a>goForward()</h5><p>åœ¨ history ä¸­å‰è¿›ã€‚</p><h5 id="createPath-pathname-query"><a href="#createPath-pathname-query" class="headerlink" title="createPath(pathname, query)"></a>createPath(pathname, query)</h5><p>ä½¿ç”¨è·¯ç”±é…ç½®ï¼Œå°† query å­—ç¬¦ä¸²åŒ–åŠ åˆ°è·¯å¾„åä¸­ã€‚</p><h5 id="createHref-pathname-query"><a href="#createHref-pathname-query" class="headerlink" title="createHref(pathname, query)"></a>createHref(pathname, query)</h5><p>ä½¿ç”¨è·¯ç”±é…ç½®ï¼Œåˆ›å»ºä¸€ä¸ª URLã€‚ä¾‹å¦‚ï¼Œå®ƒä¼šåœ¨ pathname çš„å‰é¢åŠ ä¸Š #/ ç»™ hash historyã€‚</p><h5 id="isActive-pathname-query-indexOnly"><a href="#isActive-pathname-query-indexOnly" class="headerlink" title="isActive(pathname, query, indexOnly)"></a>isActive(pathname, query, indexOnly)</h5><p>æ ¹æ®å½“å‰è·¯å¾„æ˜¯å¦æ¿€æ´»è¿”å› true æˆ– falseã€‚é€šè¿‡ pathname åŒ¹é…åˆ° route åˆ†æ”¯ä¸‹çš„æ¯ä¸ª route å°†ä¼šæ˜¯ trueï¼ˆå­ route æ˜¯æ¿€æ´»çš„æƒ…å†µä¸‹ï¼Œçˆ¶ route ä¹Ÿæ˜¯æ¿€æ´»çš„ï¼‰ï¼Œé™¤é indexOnly å·²ç»æŒ‡å®šäº†ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒåªä¼šåŒ¹é…åˆ°å…·ä½“çš„è·¯å¾„ã€‚<br><strong>å‚æ•°</strong></p><blockquote><ul><li>pathname - æ²¡æœ‰ query å®Œæ•´çš„ URLã€‚</li><li>query - å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé‚£ä¼šæ˜¯ä¸€ä¸ªåŒ…å«é”®å€¼å¯¹çš„å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨å½“å‰çš„ query ä¸­æ˜¯æ¿€æ´»çŠ¶æ€çš„ - åœ¨å½“å‰çš„ query ä¸­æ˜ç¡®æ˜¯ undefined çš„å€¼ä¼šä¸¢å¤±ç›¸åº”çš„é”®æˆ– undefined<br>*indexOnly - ä¸€ä¸ª booleanï¼ˆé»˜è®¤ï¼šfalseï¼‰ã€‚</li></ul></blockquote><h5 id="ç¤ºä¾‹-3"><a href="#ç¤ºä¾‹-3" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h5><pre><code class="javascript">import { History } from &#39;react-router&#39;React.createClass({  mixins: [ History ],  render() {    return (      &lt;div&gt;        &lt;div onClick={() =&gt; this.history.pushState(null, &#39;/foo&#39;)}&gt;Go to foo&lt;/div&gt;        &lt;div onClick={() =&gt; this.history.replaceState(null, &#39;bar&#39;)}&gt;Go to bar without creating a new history entry&lt;/div&gt;        &lt;div onClick={() =&gt; this.history.goBack()}&gt;Go back&lt;/div&gt;     &lt;/div&gt;   ) }})</code></pre><p>åœ¨åº”ç”¨ä¸­å°‘æ•°ç»„ä»¶ç”±äº History mixin çš„ç¼˜æ•…è€Œç”¨å¾—ä¸çˆ½ï¼Œæ­¤æ—¶æœ‰ä»¥ä¸‹å‡ ä¸ªé€‰é¡¹ï¼š</p><blockquote><ul><li>è®© this.props.history é€šè¿‡ route ç»„ä»¶åˆ°è¾¾éœ€è¦å®ƒçš„ç»„ä»¶ä¸­ã€‚</li><li>ä½¿ç”¨ context</li></ul></blockquote><pre><code class="javascript">import { PropTypes } from &#39;react-router&#39;class MyComponent extends React.Component {  doStuff() {    this.context.history.pushState(null, &#39;/some/path&#39;)  }}MyComponent.contextTypes = { history: PropTypes.history }</code></pre><blockquote><ul><li>ç¡®ä¿ä½ çš„ history æ˜¯ä¸€ä¸ª module</li><li>åˆ›å»ºä¸€ä¸ªé«˜é˜¶çš„ç»„ä»¶ï¼Œæˆ‘ä»¬å¯èƒ½ç”¨å®ƒæ¥ç»“æŸè·³è½¬å’Œé˜»æ­¢ historyï¼Œåªæ˜¯æ²¡æœ‰æ—¶é—´å»æ€è€ƒæ‰€æœ‰çš„æ–¹æ³•ã€‚</li></ul></blockquote><pre><code class="javascript">function connectHistory(Component) {  return React.createClass({    mixins: [ History ],    render() {      return &lt;Component {...this.props} history={this.history} /&gt;    }  })}// å…¶ä»–æ–‡ä»¶import connectHistory from &#39;./connectHistory&#39;class MyComponent extends React.Component {  doStuff() {    this.props.history.pushState(null, &#39;/some/where&#39;)  }}export default connectHistory(MyComponent)</code></pre><h3 id="RouteContext-Mixins"><a href="#RouteContext-Mixins" class="headerlink" title="RouteContext Mixins"></a>RouteContext Mixins</h3><p>RouteContext mixin æä¾›äº†ä¸€ä¸ªå°† route ç»„ä»¶è®¾ç½®åˆ° context ä¸­çš„ä¾¿æ·æ–¹æ³•ã€‚è¿™å¯¹äº route æ¸²æŸ“å…ƒç´ å¹¶ä¸”å¸Œæœ›ç”¨ ç”Ÿå‘½å‘¨æœŸ mixin æ¥é˜»æ­¢è·³è½¬æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><p>ç®€å•åœ°å°† this.context.route æ·»åŠ åˆ°ç»„ä»¶ä¸­ã€‚</p><h2 id="è¡¨å•å¤„ç†"><a href="#è¡¨å•å¤„ç†" class="headerlink" title="è¡¨å•å¤„ç†"></a>è¡¨å•å¤„ç†</h2><p>Linkç»„ä»¶ç”¨äºæ­£å¸¸çš„ç”¨æˆ·ç‚¹å‡»è·³è½¬ï¼Œä½†æ˜¯æœ‰æ—¶è¿˜éœ€è¦è¡¨å•è·³è½¬ã€ç‚¹å‡»æŒ‰é’®è·³è½¬ç­‰æ“ä½œã€‚è¿™äº›æƒ…å†µæ€ä¹ˆè·ŸReact Routerå¯¹æ¥å‘¢ï¼Ÿ</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªè¡¨å•ã€‚</p><pre><code class="javascript">&lt;form onSubmit={this.handleSubmit}&gt;  &lt;input type=&quot;text&quot; placeholder=&quot;userName&quot;/&gt;  &lt;input type=&quot;text&quot; placeholder=&quot;repo&quot;/&gt;  &lt;button type=&quot;submit&quot;&gt;Go&lt;/button&gt;&lt;/form&gt;</code></pre><p><strong>ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨browserHistory.push</strong></p><pre><code class="javascript">import { browserHistory } from &#39;react-router&#39;// ...  handleSubmit(event) {    event.preventDefault()    const userName = event.target.elements[0].value    const repo = event.target.elements[1].value    const path = `/repos/${userName}/${repo}`    browserHistory.push(path)  },</code></pre><p><strong>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨contextå¯¹è±¡ã€‚</strong></p><pre><code class="javascript">export default React.createClass({  // ask for `router` from context  contextTypes: {    router: React.PropTypes.object  },  handleSubmit(event) {    // ...    this.context.router.push(path)  },})</code></pre><h2 id="Utilities"><a href="#Utilities" class="headerlink" title="Utilities"></a>Utilities</h2><h3 id="useRoutes-createHistory"><a href="#useRoutes-createHistory" class="headerlink" title="useRoutes(createHistory)"></a>useRoutes(createHistory)</h3><p>è¿”å›ä¸€ä¸ªæ–°çš„ createHistory å‡½æ•°ï¼Œå®ƒå¯ä»¥ç”¨æ¥åˆ›å»ºè¯»å– route çš„ history å¯¹è±¡ã€‚</p><blockquote><ul><li>listen((error, nextState) =&gt; {})</li><li>listenBeforeLeavingRoute(route, (nextLocation) =&gt; {})</li><li>(location, (error, redirectLocation, nextState) =&gt; {})</li><li>isActive(pathname, query, indexOnly=false)</li></ul></blockquote><h3 id="matchmatch-location-cb"><a href="#matchmatch-location-cb" class="headerlink" title="matchmatch(location, cb)"></a>matchmatch(location, cb)</h3><p>è¿™ä¸ªå‡½æ•°è¢«ç”¨äºæœåŠ¡ç«¯æ¸²æŸ“ã€‚å®ƒåœ¨æ¸²æŸ“ä¹‹å‰ä¼šåŒ¹é…ä¸€ç»„ route åˆ°ä¸€ä¸ª locationï¼Œå¹¶ä¸”åœ¨å®Œæˆæ—¶è°ƒç”¨ <em>callback(error, redirectLocation, renderProps)</em>ã€‚</p><p>ä¼ ç»™å›è°ƒå‡½æ•°å» match çš„ä¸‰ä¸ªå‚æ•°å¦‚ä¸‹ï¼š</p><blockquote><ul><li>errorï¼šå¦‚æœæŠ¥é”™æ—¶ä¼šå‡ºç°ä¸€ä¸ª Javascript çš„ Error å¯¹è±¡ï¼Œå¦åˆ™æ˜¯ undefinedã€‚</li><li>redirectLocationï¼šå¦‚æœ route é‡å®šå‘æ—¶ä¼šæœ‰ä¸€ä¸ª Location å¯¹è±¡ï¼Œå¦åˆ™æ˜¯ undefinedã€‚</li><li>renderPropsï¼šå½“åŒ¹é…åˆ° route æ—¶ props åº”è¯¥é€šè¿‡è·¯ç”±çš„ contextï¼Œå¦åˆ™æ˜¯ undefinedã€‚</li></ul></blockquote><p>å¦‚æœè¿™ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯ undefinedï¼Œè¿™å°±æ„å‘³ç€åœ¨ç»™å®šçš„ location ä¸­æ²¡æœ‰ route è¢«åŒ¹é…åˆ°ã€‚</p><p><code>&lt;font color = &quot;red&quot;r&gt;æ³¨æ„ï¼šä½ å¯èƒ½ä¸æƒ³åœ¨æµè§ˆå™¨ä¸­ç”¨å®ƒï¼Œé™¤éä½ åšçš„æ˜¯å¼‚æ­¥ route çš„æœåŠ¡ç«¯æ¸²æŸ“ã€‚&lt;/font&gt;</code></p><h3 id="createRoutes-routes"><a href="#createRoutes-routes" class="headerlink" title="createRoutes(routes)"></a>createRoutes(routes)</h3><p>åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªä»ç»™å®šå¯¹è±¡ route çš„æ•°ç»„ï¼Œå®ƒå¯èƒ½æ˜¯ JSX çš„ routeï¼Œä¸€ä¸ªæ™®é€šå¯¹è±¡çš„ routeï¼Œæˆ–æ˜¯å…¶ä»–çš„æ•°ç»„ã€‚</p><h5 id="params-1"><a href="#params-1" class="headerlink" title="params"></a>params</h5><p><em>routes</em><br>ä¸€ä¸ªæˆ–å¤šä¸ªçš„ Route æˆ– PlainRouteã€‚</p><p><strong>æ›´å¤šèµ„æº</strong><br><a href="https://react-guide.github.io/react-router-cn/" target="_blank" rel="noopener">react-routerä¸­æ–‡æ–‡æ¡£</a><br><a href="http://www.ruanyifeng.com/blog/2016/05/react_router.html" target="_blank" rel="noopener">é˜®ä¸€å³°React-router</a></p>]]></content>
      
      
      <categories>
          
          <category> React-router </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React-router </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½ è¿˜åœ¨ç”¨forå¾ªç¯å¤§æ³•å—ï¼Ÿ</title>
      <link href="/2018/03/07/Js/%E4%BD%A0%E8%BF%98%E5%9C%A8%E7%94%A8for%E5%BE%AA%E7%8E%AF%E5%A4%A7%E6%B3%95%E5%90%97%EF%BC%9F/"/>
      <url>/2018/03/07/Js/%E4%BD%A0%E8%BF%98%E5%9C%A8%E7%94%A8for%E5%BE%AA%E7%8E%AF%E5%A4%A7%E6%B3%95%E5%90%97%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<p>æ–‡ç« ä¸»è¦ä»‹ç»äº†æ•°ç»„Array.prototypeæ–¹æ³•çš„ä½¿ç”¨ï¼Œéœ€è¦çš„æœ‹å‹å¯ä»¥å‚è€ƒä¸‹ï¼Œå¦‚æœä½ æ˜¯å¤§ç¥ï¼Œè¯·ç›´æ¥æ— è§†ã€‚</p><blockquote><p><font color = "blue">åœ¨ES5ä¸­ï¼Œä¸€å…±æœ‰9ä¸ªArrayæ–¹æ³• <a href="http://kangax.github.io/compat-table/es5/" target="_blank" rel="noopener">http://kangax.github.io/compat-table/es5/</a></p></blockquote><p>  Array.prototype.indexOf<br>  Array.prototype.lastIndexOf<br>  Array.prototype.every<br>  Array.prototype.some<br>  Array.prototype.forEach<br>  Array.prototype.map<br>  Array.prototype.filter<br>  Array.prototype.reduce<br>  Array.prototype.reduceRight<br></font></p><p>åœ¨ES6å³å°†æ™®åŠçš„æ—¶ä»£ï¼Œæˆ‘ç›¸ä¿¡è¿™äº›æ–¹æ³•å¯¹FEå¼€å‘è€…æ˜¯éå¸¸å®ç”¨çš„å¿…å¤‡æŠ€èƒ½ï¼Œæ¥ä¸‹æ¥æˆ‘å°†é€šè¿‡å®ä¾‹å¸®å¤§å®¶æ›¿æ¢forå¾ªç¯å¤§æ³•ï¼Œæ›´é«˜æ•ˆçš„æ¥æ“ä½œæ•°ç»„ã€‚</p><h2 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf"></a>indexOf</h2><p>indexOf()æ–¹æ³•è¿”å›åœ¨è¯¥æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„å…ƒç´ ä½ç½®ï¼Œå¦‚æœå®ƒä¸å­˜åœ¨åˆ™è¿”å›-1ã€‚</p><p><strong>ä½¿ç”¨forï¼š</strong></p><pre><code class="javascript">ar arr = [&#39;apple&#39;,&#39;orange&#39;,&#39;pear&#39;],    found = false;for(var i= 0, l = arr.length; i&lt; l; i++){    if(arr[i] === &#39;orange&#39;){        found = true;    }}console.log(&quot;found:&quot;,found);</code></pre><p><strong>ä½¿ç”¨indexOfï¼š</strong></p><pre><code class="javascript">var arr = [&#39;apple&#39;,&#39;orange&#39;,&#39;pear&#39;];  console.log(&quot;found:&quot;, arr.indexOf(&quot;orange&quot;) != -1);</code></pre><a id="more"></a><h2 id="lastindexOf"><a href="#lastindexOf" class="headerlink" title="lastindexOf"></a>lastindexOf</h2><p>astIndexOf() æ–¹æ³•è¿”å›åœ¨è¯¥æ•°ç»„ä¸­æœ€åä¸€ä¸ªæ‰¾åˆ°çš„å…ƒç´ ä½ç½®ï¼Œå’Œ indexofç›¸åã€‚</p><h2 id="every"><a href="#every" class="headerlink" title="every()"></a>every()</h2><p>every()å¯æ˜¯æ£€æµ‹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹æ˜¯å¦ç¬¦åˆæ¡ä»¶</p><p><strong>ä½¿ç”¨forï¼š</strong></p><pre><code class="javascript">/* * æ˜¯å¦å…¨éƒ¨å¤§äº0*/var ary = [12,23,24,42,1];var result = function(){  for (var i = 0; i &lt; ary.length; i++) {    if(ary[i] &lt; 0){       return false;    }  }  return true; //éœ€å…¨éƒ¨æ»¡è¶³}console.log(result()) //å…¨éƒ¨æ»¡è¶³,è¿”å›true</code></pre><p><strong>ä½¿ç”¨everyï¼š</strong></p><pre><code class="javascript">var ary = [12,23,24,42,1];var result = ary.every(function(item, index){  return item &gt; 0})console.log(result)</code></pre><h2 id="some"><a href="#some" class="headerlink" title="some()"></a>some()</h2><p>some()å¯ä»¥æ£€æµ‹æ•°ç»„ä¸­æ˜¯å¦æœ‰æŸä¸€é¡¹ç¬¦åˆæ¡ä»¶</p><p><strong>ä½¿ç”¨for</strong></p><pre><code class="javascript">/* * æ˜¯å¦å­˜åœ¨å°äº0çš„é¡¹*/var ary = [12,23,-24,42,1];var result = function(){  for (var i = 0; i &lt; ary.length; i++) {    if(ary[i] &lt; 0){       return true;    }  }  return false; //åªéœ€æ»¡è¶³ä¸€ä¸ª}console.log(result())  //æœ‰ä¸€é¡¹å°äº0ï¼Œè¿”å›true</code></pre><p><strong>ä½¿ç”¨some</strong></p><pre><code class="javascript">var ary = [12,23,-24,42,1];var result = ary.some(function(item, index){  return item &lt; 0})console.log(result)</code></pre><h2 id="forEach"><a href="#forEach" class="headerlink" title="forEach()"></a>forEach()</h2><p>forEachä¸ºæ¯ä¸ªå…ƒç´ æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•</p><p><strong>ä½¿ç”¨forï¼š</strong></p><pre><code class="javascript">var arr = [1,2,3,4,5,6,7,8];for(var i= 0, l = arr.length; i&lt; l; i++){console.log(arr[i]);}</code></pre><p><strong>ä½¿ç”¨forEach()ï¼š</strong></p><pre><code class="javascript">var arr = [1,2,3,4,5,6,7,8];arr.forEach(function(item,index){console.log(item);});</code></pre><p>forEachæ˜¯ç”¨æ¥æ›¿æ¢forå¾ªç¯çš„</p><h2 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h2><p>map()å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œä¸€å®šæ“ä½œï¼ˆæ˜ å°„ï¼‰åï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œ </p><p><strong>ä½¿ç”¨forï¼š</strong></p><pre><code class="javascript">var oldArr = [{first_name:&quot;Colin&quot;,last_name:&quot;Toh&quot;},{first_name:&quot;Addy&quot;,last_name:&quot;Osmani&quot;},{first_name:&quot;Yehuda&quot;,last_name:&quot;Katz&quot;}];function getNewArr(){  var newArr = [];  for(var i= 0, l = oldArr.length; i&lt; l; i++){    var item = oldArr[i];    item.full_name = [item.first_name,item.last_name].join(&quot; &quot;);    newArr[i] = item;  }  return newArr;}console.log(getNewArr());</code></pre><p><strong>ä½¿ç”¨mapï¼š</strong></p><pre><code class="javascript">var oldArr = [{first_name:&quot;Colin&quot;,last_name:&quot;Toh&quot;},{first_name:&quot;Addy&quot;,last_name:&quot;Osmani&quot;},{first_name:&quot;Yehuda&quot;,last_name:&quot;Katz&quot;}];function getNewArr(){  return oldArr.map(function(item,index){    item.full_name = [item.first_name,item.last_name].join(&quot; &quot;);    return item;  });}console.log(getNewArr());</code></pre><p>map()æ˜¯å¤„ç†æœåŠ¡å™¨è¿”å›æ•°æ®æ—¶æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å‡½æ•°ã€‚</p><p><strong>forEach ä¸mapçš„åŒºåˆ«ï¼š</strong></p><p><font color='red'>è¯­æ³•ï¼š</font>forEachå’Œmapéƒ½æ”¯æŒ2ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯å›è°ƒå‡½æ•°ï¼ˆitem,index,listï¼‰å’Œä¸Šä¸‹æ–‡ï¼›</p><p><strong>forEachï¼š</strong>ç”¨æ¥éå†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ï¼›è¿™ä¸ªæ–¹æ³•æ‰§è¡Œæ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼Œå¯¹åŸæ¥æ•°ç»„ä¹Ÿæ²¡æœ‰å½±å“ï¼›æ•°ç»„ä¸­æœ‰å‡ é¡¹ï¼Œé‚£ä¹ˆä¼ é€’è¿›å»çš„åŒ¿åå›è°ƒå‡½æ•°å°±éœ€è¦æ‰§è¡Œå‡ æ¬¡ï¼›æ¯ä¸€æ¬¡æ‰§è¡ŒåŒ¿åå‡½æ•°çš„æ—¶å€™ï¼Œè¿˜ç»™å…¶ä¼ é€’äº†ä¸‰ä¸ªå‚æ•°å€¼ï¼šæ•°ç»„ä¸­çš„å½“å‰é¡¹item,å½“å‰é¡¹çš„ç´¢å¼•index,åŸå§‹æ•°ç»„listï¼›<strong>ç†è®ºä¸Šè¿™ä¸ªæ–¹æ³•æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼Œä»…ä»…æ˜¯éå†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ï¼Œä¸å¯¹åŸæ¥æ•°ç»„è¿›è¡Œä¿®æ”¹ï¼›ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è‡ªå·±</strong><font color = "red">é€šè¿‡æ•°ç»„çš„ç´¢å¼•æ¥ä¿®æ”¹åŸæ¥çš„æ•°ç»„</font>ï¼›</p><p>forEachæ–¹æ³•ä¸­çš„thisæ˜¯ary,åŒ¿åå›è°ƒå‡½æ•°ä¸­çš„thisé»˜è®¤æ˜¯windowï¼›</p><pre><code class="javascript">var ary = [12,23,24,42,1];var res = ary.forEach(function (item,index,input) {  input[index] = item*10;})console.log(res);//--&gt;undefined;console.log(ary);//--&gt;ä¼šå¯¹åŸæ¥çš„æ•°ç»„äº§ç”Ÿæ”¹å˜ï¼›</code></pre><p><strong>mapï¼š</strong> å’ŒforEachéå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯ç”¨æ¥éå†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹å€¼çš„ï¼Œç”¨æ¥éå†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ï¼›</p><p><font color = "red">åŒºåˆ«ï¼š</font><strong>mapçš„å›è°ƒå‡½æ•°ä¸­æ”¯æŒreturnè¿”å›å€¼ï¼›returnçš„æ˜¯å•¥ï¼Œç›¸å½“äºæŠŠæ•°ç»„ä¸­çš„è¿™ä¸€é¡¹å˜ä¸ºå•¥ï¼ˆ<font color ="red">å¹¶ä¸å½±å“åŸæ¥çš„æ•°ç»„</font>ï¼Œåªæ˜¯ç›¸å½“äºæŠŠåŸæ•°ç»„å…‹éš†ä¸€ä»½ï¼ŒæŠŠå…‹éš†çš„è¿™ä¸€ä»½çš„æ•°ç»„ä¸­çš„å¯¹åº”é¡¹æ”¹å˜äº†</strong>ï¼‰ï¼›</p><p>ä¸ç®¡æ˜¯forEachè¿˜æ˜¯map éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ„æ€æ˜¯æŠŠåŒ¿åå›è°ƒå‡½æ•°ä¸­çš„thisè¿›è¡Œä¿®æ”¹ã€‚</p><pre><code class="javascript">var ary = [12,23,24,42,1];var res = ary.map(function (item,index,input) {  return item*10;})console.log(res);//--&gt;[120,230,240,420,10];console.log(ary);//--&gt;[12,23,24,42,1]ï¼›</code></pre><h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><p>è¯¥filter()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ¹é…è¿‡æ»¤æ¡ä»¶çš„æ•°ç»„ã€‚<br><strong>ä½¿ç”¨forï¼š</strong></p><pre><code class="javascript">var arr = [  {&quot;name&quot;:&quot;apple&quot;, &quot;count&quot;: 2},  {&quot;name&quot;:&quot;orange&quot;, &quot;count&quot;: 5},  {&quot;name&quot;:&quot;pear&quot;, &quot;count&quot;: 3},  {&quot;name&quot;:&quot;orange&quot;, &quot;count&quot;: 16},];var newArr = [];for(var i= 0, l = arr.length; i&lt; l; i++){  if(arr[i].name === &quot;orange&quot; ){    newArr.push(arr[i]);  }}console.log(&quot;Filter results:&quot;,newArr);</code></pre><p><strong>ä½¿ç”¨ filter()ï¼š</strong></p><pre><code class="javascript">var arr = [  {&quot;name&quot;:&quot;apple&quot;, &quot;count&quot;: 2},  {&quot;name&quot;:&quot;orange&quot;, &quot;count&quot;: 5},  {&quot;name&quot;:&quot;pear&quot;, &quot;count&quot;: 3},  {&quot;name&quot;:&quot;orange&quot;, &quot;count&quot;: 16},];var newArr = arr.filter(function(item){  return item.name === &quot;orange&quot;;});console.log(&quot;Filter results:&quot;,newArr);</code></pre><h2 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a>reduce()</h2><p>reduce()å¯ä»¥å®ç°ä¸€ä¸ªç´¯åŠ å™¨çš„åŠŸèƒ½ï¼Œå°†æ•°ç»„çš„æ¯ä¸ªå€¼ï¼ˆä»å·¦åˆ°å³ï¼‰å°†å…¶é™ä½åˆ°ä¸€ä¸ªå€¼ã€‚ è¯´å®è¯åˆšå¼€å§‹ç†è§£è¿™å¥è¯æœ‰ç‚¹éš¾åº¦ï¼Œå®ƒå¤ªæŠ½è±¡äº†ã€‚ </p><p>åœºæ™¯ï¼š ç»Ÿè®¡ä¸€ä¸ªæ•°ç»„ä¸­æœ‰å¤šå°‘ä¸ªä¸é‡å¤çš„å•è¯<br><strong>ä½¿ç”¨forï¼š</strong></p><pre><code class="javascript">var arr = [&quot;apple&quot;,&quot;orange&quot;,&quot;apple&quot;,&quot;orange&quot;,&quot;pear&quot;,&quot;orange&quot;];function getWordCnt(){  var obj = {};  for(var i= 0, l = arr.length; i&lt; l; i++){    var item = arr[i];    obj[item] = (obj[item] +1 ) || 1;  }  return obj;}console.log(getWordCnt());</code></pre><blockquote><ul><li>è®©æˆ‘å…ˆè§£é‡Šä¸€ä¸‹æˆ‘è‡ªå·±å¯¹reduceçš„ç†è§£ã€‚reduce(callback, initialValue)ä¼šä¼ å…¥ä¸¤ä¸ªå˜é‡ã€‚å›è°ƒå‡½æ•°(callback)å’Œåˆå§‹å€¼(initialValue)ã€‚å‡è®¾å‡½æ•°å®ƒæœ‰ä¸ªä¼ å…¥å‚æ•°ï¼Œprevå’Œnext,indexå’Œarrayã€‚prevå’Œnextä½ æ˜¯å¿…é¡»è¦äº†è§£çš„ã€‚ä¸€èˆ¬æ¥è®²prevæ˜¯ä»æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹çš„ï¼Œnextæ˜¯ç¬¬äºŒä¸ªå…ƒç´ ã€‚ä½†æ˜¯å½“ä½ ä¼ å…¥åˆå§‹å€¼(initialValue)åï¼Œç¬¬ä¸€ä¸ªprevå°†æ˜¯initivalValueï¼Œnextå°†æ˜¯æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li></ul></blockquote><pre><code class="javascript">/* * äºŒè€…çš„åŒºåˆ«ï¼Œåœ¨consoleä¸­è¿è¡Œä¸€ä¸‹å³å¯çŸ¥æ™“*/var arr = [&quot;apple&quot;,&quot;orange&quot;];function noPassValue(){  return arr.reduce(function(prev,next){    console.log(&quot;prev:&quot;,prev);    console.log(&quot;next:&quot;,next);    return prev + &quot; &quot; +next;  });}function passValue(){  return arr.reduce(function(prev,next){    console.log(&quot;prev:&quot;,prev);    console.log(&quot;next:&quot;,next);    prev[next] = 1;    return prev;  },{});}console.log(&quot;No Additional parameter:&quot;,noPassValue());console.log(&quot;----------------&quot;);console.log(&quot;With {} as an additional parameter:&quot;,passValue());</code></pre><h2 id="reduceRight"><a href="#reduceRight" class="headerlink" title="reduceRight()"></a>reduceRight()</h2><p> reduceRightçš„è¯­æ³•ä»¥åŠå›è°ƒå‡½æ•°çš„è§„åˆ™å’Œreduceæ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«å°±æ˜¯åœ¨ä¸reduceæ˜¯å‡åºï¼Œå³è§’æ ‡ä»0å¼€å§‹ï¼Œè€ŒreduceRightæ˜¯é™åºï¼Œå³è§’æ ‡ä»arr.length-1å¼€å§‹ã€‚</p><p>æ–¹æ³•å¯åº”ç”¨äºå­—ç¬¦ä¸²ã€‚</p><pre><code class="javascript">/* * ä½¿ç”¨æ­¤æ–¹æ³•åè½¬å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦*/var word = &quot;retupmoc&quot;;function AppendToArray(previousValue, currentValue) {  return previousValue + currentValue;}var result = [].reduceRight.call(word, AppendToArray, &quot;the &quot;);console.log(result); // the computer</code></pre><h2 id="isArray"><a href="#isArray" class="headerlink" title="isArray()"></a>isArray()</h2><p>isArray()æ˜¯Arrayå¯¹è±¡çš„ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯æ•°ç»„</p><pre><code class="javascript">var ary1 = [];var res1 = Array.isArray(ary1);  // Output: trueconsole.log(res1)var ary2 = new Array();var res2 = Array.isArray(ary2);  // Output: trueconsole.log(res2)var ary3 = [1, 2, 3];var res3 = Array.isArray(ary3);  // Output: trueconsole.log(res3)var ary4 = new Date();var res4 = Array.isArray(ary4);  // Output: falseconsole.log(res4)</code></pre><p><a href="https://shimo.im/doc/VXqv2bxTlOUiJJqO/" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flexå’Œgridå¸ƒå±€</title>
      <link href="/2018/03/06/CSS3/flex%E5%92%8Cgrid%E5%B8%83%E5%B1%80/"/>
      <url>/2018/03/06/CSS3/flex%E5%92%8Cgrid%E5%B8%83%E5%B1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="ç½‘é¡µå¸ƒå±€ï¼ˆlayoutï¼‰æ˜¯-CSS-çš„ä¸€ä¸ªé‡ç‚¹åº”ç”¨ã€‚"><a href="#ç½‘é¡µå¸ƒå±€ï¼ˆlayoutï¼‰æ˜¯-CSS-çš„ä¸€ä¸ªé‡ç‚¹åº”ç”¨ã€‚" class="headerlink" title="ç½‘é¡µå¸ƒå±€ï¼ˆlayoutï¼‰æ˜¯ CSS çš„ä¸€ä¸ªé‡ç‚¹åº”ç”¨ã€‚"></a>ç½‘é¡µå¸ƒå±€ï¼ˆlayoutï¼‰æ˜¯ CSS çš„ä¸€ä¸ªé‡ç‚¹åº”ç”¨ã€‚</h1><p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071001.gif" alt="layout"></p><p>å¸ƒå±€çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆï¼ŒåŸºäºç›’çŠ¶æ¨¡å‹ï¼Œä¾èµ– display å±æ€§ + positionå±æ€§ + floatå±æ€§ã€‚å®ƒå¯¹äºé‚£äº›ç‰¹æ®Šå¸ƒå±€éå¸¸ä¸æ–¹ä¾¿ï¼Œæ¯”å¦‚ï¼Œå‚ç›´å±…ä¸­å°±ä¸å®¹æ˜“å®ç°ã€‚</p><h2 id="Flex-å¸ƒå±€"><a href="#Flex-å¸ƒå±€" class="headerlink" title="Flex å¸ƒå±€"></a>Flex å¸ƒå±€</h2><p>2009å¹´ï¼ŒW3C æå‡ºäº†ä¸€ç§æ–°çš„æ–¹æ¡ˆâ€”-Flex å¸ƒå±€ï¼Œå¯ä»¥ç®€ä¾¿ã€å®Œæ•´ã€å“åº”å¼åœ°å®ç°å„ç§é¡µé¢å¸ƒå±€ã€‚ç›®å‰ï¼Œå®ƒå·²ç»å¾—åˆ°äº†æ‰€æœ‰æµè§ˆå™¨çš„æ”¯æŒï¼Œè¿™æ„å‘³ç€ï¼Œç°åœ¨å°±èƒ½å¾ˆå®‰å…¨åœ°ä½¿ç”¨è¿™é¡¹åŠŸèƒ½ã€‚</p><p><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a><br><a href="http://static.vgee.cn/static/index.html" target="_blank" rel="noopener">Demoåœ°å€</a></p><h3 id="å®¹å™¨å±æ€§"><a href="#å®¹å™¨å±æ€§" class="headerlink" title="å®¹å™¨å±æ€§"></a>å®¹å™¨å±æ€§</h3><h4 id="flex-directionå±æ€§"><a href="#flex-directionå±æ€§" class="headerlink" title="flex-directionå±æ€§"></a>flex-directionå±æ€§</h4><p>flex-directionå±æ€§å†³å®šä¸»è½´çš„æ–¹å‘ï¼ˆå³é¡¹ç›®çš„æ’åˆ—æ–¹å‘ï¼‰ã€‚</p><pre><code class="javascript">.box{    flex-direction: row | row-reverse | column | column-reverse}</code></pre><blockquote><p>rowï¼ˆé»˜è®¤å€¼ï¼‰ï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ã€‚<br> row-reverseï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯ã€‚<br> columnï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ã€‚<br> column-reverseï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ã€‚</p></blockquote><p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071005.png" alt="flex1"></p><h4 id="flex-wrapå±æ€§"><a href="#flex-wrapå±æ€§" class="headerlink" title="flex-wrapå±æ€§"></a>flex-wrapå±æ€§</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé¡¹ç›®éƒ½æ’åœ¨ä¸€æ¡çº¿ï¼ˆåˆç§°â€è½´çº¿â€ï¼‰ä¸Šã€‚flex-wrapå±æ€§å®šä¹‰ï¼Œå¦‚æœä¸€æ¡è½´çº¿æ’ä¸ä¸‹ï¼Œå¦‚ä½•æ¢è¡Œã€‚</p><pre><code class="javascript">.box{  flex-wrap: nowrap | wrap | wrap-reverse;}</code></pre><a id="more"></a><p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071006.png" alt="flex2"></p><blockquote><p>nowrapï¼ˆé»˜è®¤ï¼‰ï¼šä¸æ¢è¡Œã€‚<br>wrapï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹ã€‚<br>wrap-reverseï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹ã€‚</p></blockquote><h4 id="flex-flowå±æ€§"><a href="#flex-flowå±æ€§" class="headerlink" title="flex-flowå±æ€§"></a>flex-flowå±æ€§</h4><p><font color = "red">flex-flowå±æ€§</font>æ˜¯flex-directionå±æ€§å’Œflex-wrapå±æ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸ºrow nowrapã€‚</p><pre><code class="javascript">.box {  flex-flow: &lt;flex-direction&gt; || &lt;flex-wrap&gt;;}</code></pre><h4 id="justify-contentå±æ€§"><a href="#justify-contentå±æ€§" class="headerlink" title="justify-contentå±æ€§"></a>justify-contentå±æ€§</h4><p><font color = "red">justify-contentå±æ€§</font>å®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ã€‚</p><pre><code class="javascript">.box {  justify-content: flex-start | flex-end | center | space-between | space-around;}</code></pre><blockquote><p>flex-startï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå·¦å¯¹é½<br>flex-endï¼šå³å¯¹é½<br>centerï¼š å±…ä¸­<br>space-betweenï¼šä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰ã€‚<br>space-aroundï¼šæ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚</p></blockquote><h4 id="align-itemså±æ€§"><a href="#align-itemså±æ€§" class="headerlink" title="align-itemså±æ€§"></a>align-itemså±æ€§</h4><p><font color = "red">align-itemså±æ€§</font>å®šä¹‰é¡¹ç›®åœ¨äº¤å‰è½´ä¸Šå¦‚ä½•å¯¹é½</p><pre><code class="javascript">.box {  align-items: flex-start | flex-end | center | baseline | stretch;}</code></pre><blockquote><p>flex-startï¼šäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚<br>flex-endï¼šäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚<br>centerï¼šäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚<br>baseline: é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚<br>stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå¦‚æœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚</p></blockquote><h4 id="align-centetå±æ€§"><a href="#align-centetå±æ€§" class="headerlink" title="align-centetå±æ€§"></a>align-centetå±æ€§</h4><p><font color = "red">align-contentå±æ€§</font>å®šä¹‰äº†å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼ã€‚å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿ï¼Œè¯¥å±æ€§ä¸èµ·ä½œç”¨ã€‚</p><pre><code class="javascript">.box {  align-content: flex-start | flex-end | center | space-between | space-around | stretch;}</code></pre><blockquote><p>flex-startï¼šä¸äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚<br>flex-endï¼šä¸äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚<br>centerï¼šä¸äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚<br>space-betweenï¼šä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚<br>space-aroundï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚<br>stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šè½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´ã€‚</p></blockquote><h3 id="é¡¹ç›®å±æ€§"><a href="#é¡¹ç›®å±æ€§" class="headerlink" title="é¡¹ç›®å±æ€§"></a>é¡¹ç›®å±æ€§</h3><p>ä»¥ä¸‹è®¾ç½®åœ¨é¡¹ç›®ä¸Šã€‚</p><h4 id="orderå±æ€§"><a href="#orderå±æ€§" class="headerlink" title="orderå±æ€§"></a>orderå±æ€§</h4><p><font color = "red">orderå±æ€§</font>å®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œæ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º0ã€‚</p><pre><code class="javascript">.item {  order: &lt;integer&gt;;}</code></pre><h4 id="flex-growå±æ€§"><a href="#flex-growå±æ€§" class="headerlink" title="flex-growå±æ€§"></a>flex-growå±æ€§</h4><p><font color = "red">flex-growå±æ€§</font>å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ã€‚</p><pre><code class="javascript">.item {  flex-grow: &lt;number&gt;; /* default 0 */}</code></pre><p>å¦‚æœæ‰€æœ‰é¡¹ç›®çš„<strong>flex-grow</strong>å±æ€§éƒ½ä¸º1ï¼Œåˆ™å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„<strong>flex-grow</strong>å±æ€§ä¸º2ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€ã€‚</p><h4 id="flex-shrinkå±æ€§"><a href="#flex-shrinkå±æ€§" class="headerlink" title="flex-shrinkå±æ€§"></a>flex-shrinkå±æ€§</h4><p><font color = "red">flex-shrinkå±æ€§</font>å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚</p><pre><code class="javascript">.item {  flex-shrink: &lt;number&gt;; /* default 1 */}</code></pre><p>å¦‚æœæ‰€æœ‰é¡¹ç›®çš„<strong>flex-shrink</strong>å±æ€§éƒ½ä¸º1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„flex-shrinkå±æ€§ä¸º0ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚</p><p><font color = "red">è´Ÿå€¼å¯¹è¯¥å±æ€§æ— æ•ˆ</font>ã€‚</p><h4 id="flex-basiså±æ€§"><a href="#flex-basiså±æ€§" class="headerlink" title="flex-basiså±æ€§"></a>flex-basiså±æ€§</h4><p><font color = "red">flex-basiså±æ€§</font>å®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰ï¼Œé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ï¼ˆmain sizeï¼‰ã€‚æµè§ˆå™¨æ ¹æ®è¿™ä¸ªå±æ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ã€‚å®ƒçš„é»˜è®¤å€¼ä¸ºautoï¼Œå³é¡¹ç›®çš„æœ¬æ¥å¤§å°ã€‚</p><pre><code class="javascript">.item {  flex-basis: &lt;length&gt; | auto; /* default auto */}</code></pre><p>å®ƒå¯ä»¥è®¾ä¸ºè·Ÿ<em>width</em>æˆ–<em>height</em>å±æ€§ä¸€æ ·çš„å€¼ï¼ˆæ¯”å¦‚350pxï¼‰ï¼Œåˆ™é¡¹ç›®å°†å æ®å›ºå®šç©ºé—´ã€‚</p><h4 id="flexå±æ€§"><a href="#flexå±æ€§" class="headerlink" title="flexå±æ€§"></a>flexå±æ€§</h4><p>flexå±æ€§æ˜¯<em>flex-grow,</em> <em>flex-shrink</em> å’Œ <em>flex-basis</em>çš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º0 1 autoã€‚åä¸¤ä¸ªå±æ€§å¯é€‰ã€‚</p><pre><code class="javascript">.item {  flex: none | [ &lt;&#39;flex-grow&#39;&gt; &lt;&#39;flex-shrink&#39;&gt;? || &lt;&#39;flex-basis&#39;&gt; ]}</code></pre><p>è¯¥å±æ€§æœ‰ä¸¤ä¸ªå¿«æ·å€¼ï¼š<strong>auto (1 1 auto)</strong> å’Œ <strong>none (0 0 auto)</strong>ã€‚</p><p>å»ºè®®ä¼˜å…ˆä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œè€Œä¸æ˜¯å•ç‹¬å†™ä¸‰ä¸ªåˆ†ç¦»çš„å±æ€§ï¼Œå› ä¸ºæµè§ˆå™¨ä¼šæ¨ç®—ç›¸å…³å€¼ã€‚</p><h4 id="align-selfå±æ€§"><a href="#align-selfå±æ€§" class="headerlink" title="align-selfå±æ€§"></a>align-selfå±æ€§</h4><p><font color = "red">align-selfå±æ€§</font>å…è®¸å•ä¸ªé¡¹ç›®æœ‰ä¸å…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›–<font color = "red">align-itemså±æ€§</font>ã€‚é»˜è®¤å€¼ä¸º<font color = "red">auto</font>ï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„<font color = "red">align-itemså±æ€§</font>ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºstretch</p><pre><code class="javascript">.item {  align-self: auto | flex-start | flex-end | center | baseline | stretch;}</code></pre><p>è¯¥å±æ€§å¯èƒ½å–6ä¸ªå€¼ï¼Œé™¤äº†autoï¼Œå…¶ä»–éƒ½ä¸align-itemså±æ€§å®Œå…¨ä¸€è‡´ã€‚</p><h2 id="Gridå¸ƒå±€"><a href="#Gridå¸ƒå±€" class="headerlink" title="Gridå¸ƒå±€"></a>Gridå¸ƒå±€</h2><p><a href="http://www.css88.com/archives/8510" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><p>Grid å¸ƒå±€æ˜¯ç½‘ç«™è®¾è®¡çš„åŸºç¡€ï¼ŒCSS Grid æ˜¯åˆ›å»ºç½‘æ ¼å¸ƒå±€æœ€å¼ºå¤§å’Œæœ€ç®€å•çš„å·¥å…·ã€‚</p><p>CSS Grid ä»Šå¹´ä¹Ÿè·å¾—äº†ä¸»æµæµè§ˆå™¨ï¼ˆSafariï¼ŒChromeï¼ŒFirefoxï¼ŒEdgeï¼‰çš„åŸç”Ÿæ”¯æŒï¼Œæ‰€ä»¥æˆ‘ç›¸ä¿¡æ‰€æœ‰çš„å‰ç«¯å¼€å‘äººå‘˜éƒ½å¿…é¡»åœ¨ä¸ä¹…çš„å°†æ¥å­¦ä¹ è¿™é¡¹æŠ€æœ¯ã€‚</p><p>CSS Grid(ç½‘æ ¼) å¸ƒå±€ï¼ˆåˆç§°ä¸º â€œGrid(ç½‘æ ¼)â€ ï¼‰ï¼Œæ˜¯ä¸€ä¸ªäºŒç»´çš„åŸºäºç½‘æ ¼çš„å¸ƒå±€ç³»ç»Ÿå®ƒçš„ç›®æ ‡æ˜¯å®Œå…¨æ”¹å˜æˆ‘ä»¬åŸºäºç½‘æ ¼çš„ç”¨æˆ·ç•Œé¢çš„å¸ƒå±€æ–¹å¼ã€‚CSS ä¸€ç›´ç”¨æ¥å¸ƒå±€æˆ‘ä»¬çš„ç½‘é¡µï¼Œä½†ä¸€ç›´ä»¥æ¥éƒ½å­˜åœ¨è¿™æ ·æˆ–é‚£æ ·çš„é—®é¢˜ã€‚ä¸€å¼€å§‹æˆ‘ä»¬ç”¨è¡¨æ ¼ï¼ˆtableï¼‰ï¼Œç„¶åæ˜¯æµ®åŠ¨ï¼ˆfloatï¼‰ï¼Œå†æ˜¯å®šä½ï¼ˆpostionï¼‰å’Œå†…åµŒå—ï¼ˆinline-blockï¼‰ï¼Œä½†æ˜¯æ‰€æœ‰è¿™äº›æ–¹æ³•æœ¬è´¨ä¸Šéƒ½æ˜¯åªæ˜¯ hack è€Œå·²ï¼Œå¹¶ä¸”é—æ¼äº†å¾ˆå¤šé‡è¦çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚å‚ç›´å±…ä¸­ï¼‰ã€‚Flexbox çš„å‡ºç°å¾ˆå¤§ç¨‹åº¦ä¸Šæ”¹å–„äº†æˆ‘ä»¬çš„å¸ƒå±€æ–¹å¼ï¼Œä½†å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†è§£å†³æ›´ç®€å•çš„ä¸€ç»´å¸ƒå±€ï¼Œè€Œä¸æ˜¯å¤æ‚çš„äºŒç»´å¸ƒå±€ï¼ˆå®é™…ä¸Š Flexbox å’Œ Grid èƒ½ç»“åˆåœ¨ä¸€èµ·å·¥ä½œï¼Œè€Œä¸”é…åˆå¾—éå¸¸å¥½ï¼‰ã€‚Grid(ç½‘æ ¼) å¸ƒå±€æ˜¯ç¬¬ä¸€ä¸ªä¸“é—¨ä¸ºè§£å†³å¸ƒå±€é—®é¢˜è€Œåˆ›å»ºçš„ CSS æ¨¡å—ï¼Œæˆ‘ä»¬ç»ˆäºä¸éœ€è¦æƒ³å°½åŠæ³•hack é¡µé¢å¸ƒå±€æ ·å¼äº†ã€‚</p><h3 id="ç½‘æ ¼å®¹å™¨-Grid-Container"><a href="#ç½‘æ ¼å®¹å™¨-Grid-Container" class="headerlink" title="ç½‘æ ¼å®¹å™¨(Grid Container)"></a>ç½‘æ ¼å®¹å™¨(Grid Container)</h3><p>åº”ç”¨ display: grid çš„å…ƒç´ ã€‚è¿™æ˜¯æ‰€æœ‰ç½‘æ ¼é¡¹ï¼ˆGrid Itemsï¼‰çš„ç›´æ¥çˆ¶çº§å…ƒç´ ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œcontainer å°±æ˜¯ ç½‘æ ¼å®¹å™¨(Grid Container)ã€‚</p><pre><code class="html">&lt;div class=&quot;container&quot;&gt;  &lt;div class=&quot;item item-1&quot;&gt;&lt;/div&gt;  &lt;div class=&quot;item item-2&quot;&gt;&lt;/div&gt;  &lt;div class=&quot;item item-3&quot;&gt;&lt;/div&gt;&lt;/div&gt;</code></pre><h4 id="display"><a href="#display" class="headerlink" title="display"></a>display</h4><blockquote><p>grid ï¼šç”Ÿæˆä¸€ä¸ªå—çº§ç½‘æ ¼<br>inline-grid ï¼šç”Ÿæˆä¸€ä¸ªå†…è”ç½‘æ ¼<br>subgrid ï¼šå¦‚æœä½ çš„ç½‘æ ¼å®¹å™¨æœ¬èº«æ˜¯å¦ä¸€ä¸ªç½‘æ ¼çš„ç½‘æ ¼é¡¹ï¼ˆå³åµŒå¥—ç½‘æ ¼ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå±æ€§æ¥è¡¨ç¤º<br>  ä½ å¸Œæœ›å®ƒçš„è¡Œ/åˆ—çš„å¤§å°ç»§æ‰¿è‡ªå®ƒçš„çˆ¶çº§ç½‘æ ¼å®¹å™¨ï¼Œè€Œä¸æ˜¯è‡ªå·±æŒ‡å®šçš„ã€‚</p></blockquote><p>å¦‚æœä½ æƒ³è¦è®¾ç½®ä¸ºç½‘æ ¼å®¹å™¨å…ƒç´ æœ¬èº«å·²ç»æ˜¯ç½‘æ ¼é¡¹ï¼ˆåµŒå¥—ç½‘æ ¼å¸ƒå±€ï¼‰ï¼Œç”¨è¿™ä¸ªå±æ€§æŒ‡æ˜è¿™ä¸ªå®¹å™¨å†…éƒ¨çš„ç½‘æ ¼é¡¹çš„è¡Œåˆ—å°ºå¯¸ç›´æ¥ç»§æ‰¿å…¶çˆ¶çº§çš„ç½‘æ ¼å®¹å™¨å±æ€§ã€‚</p><pre><code class="css">.container {    display: grid | inline-grid | subgrid;}</code></pre><p>æ³¨æ„ï¼šåœ¨<em>ç½‘æ ¼å®¹å™¨(Grid Container) ä¸Šä½¿ç”¨columnï¼Œfloatï¼Œclearï¼Œ vertical-align</em>ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœã€‚</p><h4 id="grid-template-columns-grid-template-rows"><a href="#grid-template-columns-grid-template-rows" class="headerlink" title="grid-template-columns / grid-template-rows"></a>grid-template-columns / grid-template-rows</h4><p>ä½¿ç”¨ç©ºæ ¼åˆ†éš”çš„å€¼åˆ—è¡¨ï¼Œç”¨æ¥å®šä¹‰ç½‘æ ¼çš„åˆ—å’Œè¡Œã€‚è¿™äº›å€¼è¡¨ç¤º ç½‘æ ¼è½¨é“(Grid Track) å¤§å°ï¼Œå®ƒä»¬ä¹‹é—´çš„ç©ºæ ¼è¡¨ç¤ºç½‘æ ¼çº¿ã€‚</p><blockquote><p>å€¼ï¼š<br>â€“ <track-size>ï¼š å¯ä»¥æ˜¯é•¿åº¦å€¼ï¼Œç™¾åˆ†æ¯”ï¼Œæˆ–è€…ç­‰ä»½ç½‘æ ¼å®¹å™¨ä¸­å¯ç”¨ç©ºé—´ï¼ˆä½¿ç”¨ fr å•ä½ï¼‰<br>â€“ <line-name>ï¼šä½ å¯ä»¥é€‰æ‹©çš„ä»»æ„åç§°</p></blockquote><pre><code class="css">.container {    grid-template-columns: &lt;track-size&gt; ... | &lt;line-name&gt; &lt;track-size&gt; ...;    grid-template-rows: &lt;track-size&gt; ... | &lt;line-name&gt; &lt;track-size&gt; ...;}</code></pre><p><strong>ç¤ºä¾‹ï¼š</strong><br><img src="https://www.html.cn/newimg88/2018/12/template-columns-rows-01.svg" alt="grid3"></p><pre><code class="css">.container{    grid-template-columns: 40px 50px auto 50px 40px;    grid-template-rows: 25% 100px auto;}</code></pre><p>ä½†æ˜¯ä½ å¯ä»¥æ˜ç¡®çš„æŒ‡å®šç½‘æ ¼çº¿(Grid Line)åç§°ï¼Œå³ <line-name> å€¼ã€‚è¯·æ³¨æ„ç½‘æ ¼çº¿åç§°çš„æ‹¬å·è¯­æ³•ï¼š</p><pre><code class="css">.container {    grid-template-columns: [first] 40px [line2] 50px [line3] auto [col4-start] 50px [five] 40px [end];    grid-template-rows: [row1-start] 25% [row1-end] 100px [third-line] auto [last-line];}</code></pre><p>è¯·æ³¨æ„ï¼Œä¸€æ¡ç½‘æ ¼çº¿(Grid Line)å¯ä»¥æœ‰å¤šä¸ªåç§°ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œçš„ç¬¬äºŒæ¡ è¡Œç½‘æ ¼çº¿(row grid lines) å°†æœ‰ä¸¤ä¸ªåå­—ï¼šrow1-end å’Œrow2-start ï¼š</p><pre><code class="css">.container{    grid-template-rows: [row1-start] 25% [row1-end row2-start] 25% [row2-end];}</code></pre><p>å¦‚æœä½ çš„å®šä¹‰åŒ…å«å¤šä¸ªé‡å¤å€¼ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ repeat() è¡¨ç¤ºæ³•æ¥ç®€åŒ–å®šä¹‰ï¼š</p><pre><code class="css">.container {    grid-template-columns: repeat(3, 20px [col-start]) 5%;}//ç­‰ä»·äº.container {    grid-template-columns: 20px [col-start] 20px [col-start] 20px [col-start] 5%;}</code></pre><p>fr å•å…ƒå…è®¸ä½ ç”¨ç­‰åˆ†ç½‘æ ¼å®¹å™¨å‰©ä½™å¯ç”¨ç©ºé—´æ¥è®¾ç½® ç½‘æ ¼è½¨é“(Grid Track) çš„å¤§å° ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç ä¼šå°†æ¯ä¸ªç½‘æ ¼é¡¹è®¾ç½®ä¸ºç½‘æ ¼å®¹å™¨å®½åº¦çš„ä¸‰åˆ†ä¹‹ä¸€ï¼š</p><pre><code class="css">.container {    grid-template-columns: 1fr 1fr 1fr;}</code></pre><p>å‰©ä½™å¯ç”¨ç©ºé—´æ˜¯é™¤å»æ‰€æœ‰éçµæ´»ç½‘æ ¼é¡¹ä¹‹åè®¡ç®—å¾—åˆ°çš„ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯ç”¨ç©ºé—´æ€»é‡å‡å» 50px åï¼Œå†ç»™ fr å•å…ƒçš„å€¼3ç­‰åˆ†ï¼š</p><pre><code class="css">.container {    grid-template-columns: 1fr 50px 1fr 1fr;}</code></pre><h4 id="grid-template-areas"><a href="#grid-template-areas" class="headerlink" title="grid-template-areas"></a>grid-template-areas</h4><p>é€šè¿‡å¼•ç”¨ grid-area å±æ€§æŒ‡å®šçš„ ç½‘æ ¼åŒºåŸŸ(Grid Area) åç§°æ¥å®šä¹‰ç½‘æ ¼æ¨¡æ¿ã€‚é‡å¤ç½‘æ ¼åŒºåŸŸçš„åç§°å¯¼è‡´å†…å®¹è·¨è¶Šè¿™äº›å•å…ƒæ ¼ã€‚ä¸€ä¸ªç‚¹å·ï¼ˆ.ï¼‰ä»£è¡¨ä¸€ä¸ªç©ºçš„ç½‘æ ¼å•å…ƒã€‚è¿™ä¸ªè¯­æ³•æœ¬èº«å¯è§†ä½œç½‘æ ¼çš„å¯è§†åŒ–ç»“æ„ã€‚</p><blockquote><p><grid-area-name>ï¼šç”±ç½‘æ ¼é¡¹çš„ grid-area æŒ‡å®šçš„ç½‘æ ¼åŒºåŸŸåç§°<br>.ï¼ˆç‚¹å·ï¼‰ ï¼šä»£è¡¨ä¸€ä¸ªç©ºçš„ç½‘æ ¼å•å…ƒ<br>noneï¼šä¸å®šä¹‰ç½‘æ ¼åŒºåŸŸ</p></blockquote><pre><code class="css">.container {  grid-template-areas:     &quot; | . | none | ...&quot;    &quot;...&quot;;}</code></pre><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="css">.item-a {  grid-area: header;}.item-b {  grid-area: main;}.item-c {  grid-area: sidebar;}.item-d {  grid-area: footer;}.container {  grid-template-columns: 50px 50px 50px 50px;  grid-template-rows: auto;  grid-template-areas:     &quot;header header header header&quot;    &quot;main main . sidebar&quot;    &quot;footer footer footer footer&quot;;}</code></pre><p>ä¸Šé¢çš„ä»£ç å°†åˆ›å»ºä¸€ä¸ª 4 åˆ— 3 è¡Œçš„ç½‘æ ¼ã€‚æ•´ä¸ªé¡¶è¡Œå°†ç”± header åŒºåŸŸ ç»„æˆã€‚ä¸­é—´ä¸€æ’å°†ç”±ä¸¤ä¸ª main åŒºåŸŸï¼Œä¸€ä¸ªæ˜¯ç©ºå•å…ƒæ ¼ï¼Œä¸€ä¸ª sidebar åŒºåŸŸç»„æˆã€‚æœ€åä¸€è¡Œå…¨æ˜¯ footer åŒºåŸŸç»„æˆã€‚<br><img src="https://www.html.cn/newimg88/2018/12/dddgrid-template-areas.svg" alt="grid4"></p><p>ä½ å¯ä»¥ä½¿ç”¨ä»»æ„æ•°é‡çš„ç›¸é‚»çš„ <font color="red">ç‚¹.</font> æ¥å£°æ˜å•ä¸ªç©ºå•å…ƒæ ¼ã€‚ åªè¦è¿™äº›ç‚¹.ä¹‹é—´æ²¡æœ‰ç©ºéš™éš”å¼€ï¼Œä»–ä»¬å°±è¡¨ç¤ºä¸€ä¸ªå•ä¸€çš„å•å…ƒæ ¼ã€‚</p><h4 id="grid-template"><a href="#grid-template" class="headerlink" title="grid-template"></a>grid-template</h4><p>ç”¨äºå®šä¹‰ <strong>grid-template-rows</strong>ï¼Œ<strong>grid-template-columns</strong> ï¼Œ<strong>grid-template-areas</strong> ç¼©å†™ (shorthand) å±æ€§ã€‚</p><blockquote><p>noneï¼šå°†æ‰€æœ‰ä¸‰ä¸ªå±æ€§è®¾ç½®ä¸ºå…¶åˆå§‹å€¼<br>subgridï¼šå°†grid-template-rowsï¼Œgrid-template-columns çš„å€¼è®¾ä¸º  subgridï¼Œgrid-template-areasè®¾ä¸ºåˆå§‹å€¼</p></blockquote><p><grid-template-rows> / <grid-template-columns>ï¼šå°† grid-template-columns å’Œ  grid-template-rows è®¾ç½®ä¸ºç›¸åº”åœ°ç‰¹å®šçš„å€¼ï¼Œå¹¶ä¸”è®¾ç½®grid-template-areasä¸ºnone</p><pre><code class="css">.container {  grid-template: none | subgrid | &lt;grid-template-rows&gt; / &lt;grid-template-columns&gt;;}</code></pre><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="css">.container {  grid-template:    [row1-start] &quot;header header header&quot; 25px [row1-end]    [row2-start] &quot;footer footer footer&quot; 25px [row2-end]    / auto 50px auto;}//ç­‰ä»·äº.container {  grid-template-rows: [row1-start] 25px [row1-end row2-start] 25px [row2-end];  grid-template-columns: auto 50px auto;  grid-template-areas:     &quot;header header header&quot;     &quot;footer footer footer&quot;;}</code></pre><p>ç”±äº <font color= "blue">grid-template </font>ä¸ä¼šé‡ç½® éšå¼ ç½‘æ ¼å±æ€§ï¼ˆgrid-auto-columnsï¼Œ grid-auto-rowsï¼Œ å’Œ  grid-auto-flowï¼‰ï¼Œ<br>è¿™å¯èƒ½æ˜¯ä½ æƒ³åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åšçš„ï¼Œå»ºè®®ä½¿ç”¨<em>grid å±æ€§</em> è€Œä¸æ˜¯<em>grid-template</em>ã€‚</p><h4 id="grid-column-gap-grid-row-gap"><a href="#grid-column-gap-grid-row-gap" class="headerlink" title="grid-column-gap / grid-row-gap"></a>grid-column-gap / grid-row-gap</h4><p>æŒ‡å®šç½‘æ ¼çº¿(grid lines)çš„å¤§å°ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡ä¸ºè®¾ç½®åˆ—/è¡Œä¹‹é—´é—´è·çš„å®½åº¦ã€‚</p><blockquote><p><line-size> ï¼šé•¿åº¦å€¼</p></blockquote><pre><code class="css">.container {  grid-column-gap: &lt;line-size&gt;;  grid-row-gap: &lt;line-size&gt;;}</code></pre><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="css">.container {  grid-template-columns: 100px 50px 100px;  grid-template-rows: 80px auto 80px;   grid-column-gap: 10px;  grid-row-gap: 15px;}</code></pre><p><img src="https://www.html.cn/newimg88/2018/12/dddgrid-gap.svg" alt="grid5"><br>åªèƒ½åœ¨ åˆ—/è¡Œ ä¹‹é—´åˆ›å»ºé—´è·ï¼Œç½‘æ ¼å¤–éƒ¨è¾¹ç¼˜ä¸ä¼šæœ‰è¿™ä¸ªé—´è·ã€‚</p><h4 id="grid-gap"><a href="#grid-gap" class="headerlink" title="grid-gap"></a>grid-gap</h4><p><font color= "blue">grid-column-gap</font> å’Œ <font color= "blue">grid-row-gap</font>çš„ç¼©å†™è¯­æ³•</p><blockquote><p><grid-row-gap> <grid-column-gap>ï¼šé•¿åº¦å€¼</p></blockquote><pre><code class="css">.container {  grid-gap: &lt;grid-row-gap&gt; &lt;grid-column-gap&gt;;}</code></pre><p><strong>ç¤ºä¾‹:</strong><br>å¦‚æœgrid-row-gapæ²¡æœ‰å®šä¹‰ï¼Œé‚£ä¹ˆå°±ä¼šè¢«è®¾ç½®ä¸ºç­‰åŒäº grid-column-gap çš„å€¼ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç æ˜¯ç­‰ä»·çš„ï¼š</p><pre><code class="css">.container{  grid-template-columns: 100px 50px 100px;  grid-template-rows: 80px auto 80px;   grid-gap: 10px 15px;}//ç­‰ä»·äº.container{  /* è®¾ç½® [`grid-column-gap`](http://www.css88.com/archives/8510#prop-grid-column-row-gap) å’Œ [`grid-row-gap`](http://www.css88.com/archives/8510#prop-grid-column-row-gap) */    grid-column-gap: 10px;  grid-column-gap: 10px;   /* ç­‰ä»·äº */    grid-gap: 10px 10px;  /* ç­‰ä»·äº */    grid-gap: 10px;}</code></pre><h4 id="justify-items"><a href="#justify-items" class="headerlink" title="justify-items"></a>justify-items</h4><p>æ²¿ç€ è¡Œè½´çº¿(row axis) å¯¹é½ ç½‘æ ¼é¡¹(grid items) å†…çš„å†…å®¹ï¼ˆç›¸åçš„å±æ€§æ˜¯ align-items æ²¿ç€åˆ—è½´çº¿å¯¹é½ï¼‰ã€‚è¯¥å€¼é€‚ç”¨äºå®¹å™¨å†…çš„æ‰€æœ‰ç½‘æ ¼é¡¹ã€‚</p><blockquote><p>startï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸ(grid area)çš„å·¦ä¾§<br>endï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„å³ä¾§<br>centerï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„ä¸­é—´ï¼ˆæ°´å¹³å±…ä¸­ï¼‰<br>stretchï¼šå¡«æ»¡ç½‘æ ¼åŒºåŸŸå®½åº¦ï¼ˆé»˜è®¤å€¼ï¼‰</p></blockquote><pre><code class="css">.container {    justify-items: start | end | center | stretch;}</code></pre><h4 id="align-items"><a href="#align-items" class="headerlink" title="align-items"></a>align-items</h4><p>æ²¿ç€ åˆ—è½´çº¿(column axis) å¯¹é½ ç½‘æ ¼é¡¹(grid items) å†…çš„å†…å®¹ï¼ˆç›¸åçš„å±æ€§æ˜¯ justify-items æ²¿ç€è¡Œè½´çº¿å¯¹é½ï¼‰ã€‚è¯¥å€¼é€‚ç”¨äºå®¹å™¨å†…çš„æ‰€æœ‰ç½‘æ ¼é¡¹ã€‚</p><blockquote><p>startï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸ(grid area)çš„é¡¶éƒ¨<br>endï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„åº•éƒ¨<br>centerï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„ä¸­é—´ï¼ˆå‚ç›´å±…ä¸­ï¼‰<br>stretchï¼šå¡«æ»¡ç½‘æ ¼åŒºåŸŸé«˜åº¦ï¼ˆé»˜è®¤å€¼ï¼‰</p></blockquote><pre><code class="css">.container {  align-items: start | end | center | stretch;}</code></pre><h4 id="justify-content"><a href="#justify-content" class="headerlink" title="justify-content"></a>justify-content</h4><p>æœ‰æ—¶ï¼Œä½ çš„ç½‘æ ¼åˆè®¡å¤§å°å¯èƒ½å°äºå…¶ ç½‘æ ¼å®¹å™¨(grid container) å¤§å°ã€‚ å¦‚æœä½ çš„æ‰€æœ‰ ç½‘æ ¼é¡¹(grid items) éƒ½ä½¿ç”¨åƒ px è¿™æ ·çš„éçµæ´»å•ä½è®¾ç½®å¤§å°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥è®¾ç½®ç½‘æ ¼å®¹å™¨å†…çš„ç½‘æ ¼çš„å¯¹é½æ–¹å¼ã€‚ æ­¤å±æ€§æ²¿ç€ è¡Œè½´çº¿(row axis) å¯¹é½ç½‘æ ¼ï¼ˆç›¸åçš„å±æ€§æ˜¯ align-content ï¼Œæ²¿ç€åˆ—è½´çº¿å¯¹é½ç½‘æ ¼ï¼‰ã€‚</p><blockquote><p>startï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨(grid container) çš„å·¦è¾¹<br>endï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨ çš„å³è¾¹<br>centerï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨ çš„ä¸­é—´ï¼ˆæ°´å¹³å±…ä¸­ï¼‰<br>stretchï¼šè°ƒæ•´ ç½‘æ ¼é¡¹(grid items) çš„å®½åº¦ï¼Œå…è®¸è¯¥ç½‘æ ¼å¡«å……æ»¡æ•´ä¸ª ç½‘æ ¼å®¹å™¨ çš„å®½åº¦<br>space-aroundï¼šåœ¨æ¯ä¸ªç½‘æ ¼é¡¹ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œå·¦å³ä¸¤ç«¯æ”¾ç½®ä¸€åŠçš„ç©ºé—´<br>space-betweenï¼šåœ¨æ¯ä¸ªç½‘æ ¼é¡¹ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œå·¦å³ä¸¤ç«¯æ²¡æœ‰ç©ºé—´<br>space-evenlyï¼šåœ¨æ¯ä¸ªæ …æ ¼é¡¹ç›®ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œå·¦å³ä¸¤ç«¯æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´</p></blockquote><pre><code class="css">.container {  justify-content: start | end | center | stretch | space-around | space-between | space-evenly;    }</code></pre><h4 id="align-content"><a href="#align-content" class="headerlink" title="align-content"></a>align-content</h4><p>æœ‰æ—¶ï¼Œä½ çš„ç½‘æ ¼åˆè®¡å¤§å°å¯èƒ½å°äºå…¶ ç½‘æ ¼å®¹å™¨(grid container) å¤§å°ã€‚ å¦‚æœä½ çš„æ‰€æœ‰ ç½‘æ ¼é¡¹(grid items) éƒ½ä½¿ç”¨åƒ px è¿™æ ·çš„éçµæ´»å•ä½è®¾ç½®å¤§å°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥è®¾ç½®ç½‘æ ¼å®¹å™¨å†…çš„ç½‘æ ¼çš„å¯¹é½æ–¹å¼ã€‚ æ­¤å±æ€§æ²¿ç€ åˆ—è½´çº¿(column axis) å¯¹é½ç½‘æ ¼ï¼ˆç›¸åçš„å±æ€§æ˜¯ justify-content ï¼Œæ²¿ç€è¡Œè½´çº¿å¯¹é½ç½‘æ ¼ï¼‰ã€‚</p><blockquote><p>startï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨(grid container) çš„é¡¶éƒ¨<br>endï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨ çš„åº•éƒ¨<br>centerï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨ çš„ä¸­é—´ï¼ˆå‚ç›´å±…ä¸­ï¼‰<br>stretchï¼šè°ƒæ•´ ç½‘æ ¼é¡¹(grid items) çš„é«˜åº¦ï¼Œå…è®¸è¯¥ç½‘æ ¼å¡«å……æ»¡æ•´ä¸ª ç½‘æ ¼å®¹å™¨ çš„é«˜åº¦<br>space-aroundï¼šåœ¨æ¯ä¸ªç½‘æ ¼é¡¹ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œä¸Šä¸‹ä¸¤ç«¯æ”¾ç½®ä¸€åŠçš„ç©ºé—´<br>space-betweenï¼šåœ¨æ¯ä¸ªç½‘æ ¼é¡¹ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œä¸Šä¸‹ä¸¤ç«¯æ²¡æœ‰ç©ºé—´<br>space-evenlyï¼šåœ¨æ¯ä¸ªæ …æ ¼é¡¹ç›®ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œä¸Šä¸‹ä¸¤ç«¯æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´</p></blockquote><pre><code class="css">.container {  align-content: start | end | center | stretch | space-around | space-between | space-evenly;  }</code></pre><h4 id="grid-auto-columns-grid-auto-rows"><a href="#grid-auto-columns-grid-auto-rows" class="headerlink" title="grid-auto-columns / grid-auto-rows"></a>grid-auto-columns / grid-auto-rows</h4><p>æŒ‡å®šä»»ä½•è‡ªåŠ¨ç”Ÿæˆçš„ç½‘æ ¼è½¨é“(grid tracks)ï¼ˆåˆåéšå¼ç½‘æ ¼è½¨é“ï¼‰çš„å¤§å°ã€‚åœ¨ä½ æ˜ç¡®å®šä½çš„è¡Œæˆ–åˆ—ï¼ˆé€šè¿‡  grid-template-rows / grid-template-columnsï¼‰ï¼Œè¶…å‡ºå®šä¹‰çš„ç½‘æ ¼èŒƒå›´æ—¶ï¼Œéšå¼ç½‘æ ¼è½¨é“è¢«åˆ›å»ºäº†ã€‚</p><blockquote><p><track-size>ï¼šå¯ä»¥æ˜¯é•¿åº¦å€¼ï¼Œç™¾åˆ†æ¯”ï¼Œæˆ–è€…ç­‰ä»½ç½‘æ ¼å®¹å™¨ä¸­å¯ç”¨ç©ºé—´ï¼ˆä½¿ç”¨ fr å•ä½ï¼‰</p></blockquote><pre><code class="css">.container {  grid-auto-columns: &lt;track-size&gt; ...;  grid-auto-rows: &lt;track-size&gt; ...;}</code></pre><p>ä¸ºäº†è¯´æ˜å¦‚ä½•åˆ›å»ºéšå¼ç½‘æ ¼è½¨é“ï¼Œè¯·è€ƒè™‘ä¸€ä¸‹ä»¥ä¸‹çš„ä»£ç ï¼š</p><pre><code class="css">.container {  grid-template-columns: 60px 60px;  grid-template-rows: 90px 90px}</code></pre><p><img src="https://www.html.cn/newimg88/2018/12/grid-auto-columns-rows-01.svg" alt="grid7"></p><p>ä½†ç°åœ¨æƒ³è±¡ä¸€ä¸‹ï¼Œä½ ä½¿ç”¨ grid-column å’Œ grid-row æ¥å®šä½ä½ çš„ç½‘æ ¼é¡¹ï¼ˆgrid itemsï¼‰ï¼Œåƒè¿™æ ·ï¼š</p><pre><code class="css">.item-a {  grid-column: 1 / 2;  grid-row: 2 / 3;}.item-b {  grid-column: 5 / 6;  grid-row: 2 / 3;}</code></pre><p><img src="https://www.html.cn/newimg88/2018/12/grid-auto-columns-rows-01.svg" alt="grid8"></p><p>å› ä¸ºæˆ‘ä»¬å¼•ç”¨çš„ç½‘æ ¼çº¿ä¸å­˜åœ¨ï¼Œæ‰€ä»¥åˆ›å»ºå®½åº¦ä¸º 0 çš„éšå¼ç½‘æ ¼è½¨é“ä»¥å¡«è¡¥ç©ºç¼ºã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨  grid-auto-columns å’Œ grid-auto-rows æ¥æŒ‡å®šè¿™äº›éšå¼è½¨é“çš„å¤§å°ï¼š</p><pre><code class="css">.container {  grid-auto-columns: 60px;}</code></pre><p><img src="https://www.html.cn/newimg88/2018/12/grid-auto-columns-rows-01.svg" alt="grid9"></p><h4 id="grid-auto-flow"><a href="#grid-auto-flow" class="headerlink" title="grid-auto-flow"></a>grid-auto-flow</h4><p>å¦‚æœä½ æœ‰ä¸€äº›æ²¡æœ‰æ˜ç¡®æ”¾ç½®åœ¨ç½‘æ ¼ä¸Šçš„ç½‘æ ¼é¡¹(grid items)ï¼Œè‡ªåŠ¨æ”¾ç½®ç®—æ³• ä¼šè‡ªåŠ¨æ”¾ç½®è¿™äº›ç½‘æ ¼é¡¹ã€‚è¯¥å±æ€§æ§åˆ¶è‡ªåŠ¨å¸ƒå±€ç®—æ³•å¦‚ä½•å·¥ä½œã€‚</p><blockquote><p>rowï¼šå‘Šè¯‰è‡ªåŠ¨å¸ƒå±€ç®—æ³•ä¾æ¬¡å¡«å……æ¯è¡Œï¼Œæ ¹æ®éœ€è¦æ·»åŠ æ–°è¡Œ<br>columnï¼šå‘Šè¯‰è‡ªåŠ¨å¸ƒå±€ç®—æ³•ä¾æ¬¡å¡«å…¥æ¯åˆ—ï¼Œæ ¹æ®éœ€è¦æ·»åŠ æ–°åˆ—<br>denseï¼šå‘Šè¯‰è‡ªåŠ¨å¸ƒå±€ç®—æ³•åœ¨ç¨åå‡ºç°è¾ƒå°çš„ç½‘æ ¼é¡¹æ—¶ï¼Œå°è¯•å¡«å……ç½‘æ ¼ä¸­è¾ƒæ—©çš„ç©ºç¼º</p></blockquote><pre><code class="css">.container {  grid-auto-flow: row | column | row dense | column dense}</code></pre><h4 id="grid"><a href="#grid" class="headerlink" title="grid"></a>grid</h4><p>åœ¨ä¸€ä¸ªå£°æ˜ä¸­è®¾ç½®æ‰€æœ‰ä»¥ä¸‹å±æ€§çš„ç®€å†™ï¼š grid-template-rows, grid-template-columns,  grid-template-areas, grid-auto-rows, grid-auto-columns, å’Œ grid-auto-flow ã€‚å®ƒè¿˜å°†grid-column-gap å’Œ grid-column-gapè®¾ç½®ä¸ºåˆå§‹å€¼ï¼Œå³ä½¿å®ƒä»¬ä¸å¯ä»¥é€šè¿‡gridå±æ€§æ˜¾å¼åœ°è®¾ç½®ã€‚</p><blockquote><p>noneï¼šå°†æ‰€æœ‰å­å±æ€§è®¾ç½®ä¸ºå…¶åˆå§‹å€¼</p></blockquote><p><grid-template-rows> / <grid-template-columns>ï¼šå°† grid-template-rows å’Œ  grid-template-columns åˆ†åˆ«è®¾ç½®ä¸ºæŒ‡å®šå€¼ï¼Œå°†æ‰€æœ‰å…¶ä»–å­å±æ€§è®¾ç½®ä¸ºå…¶åˆå§‹å€¼</p><p><grid-auto-flow> [<grid-auto-rows> [ / <grid-auto-columns>] ] ï¼šåˆ†åˆ«æ¥å—æ‰€æœ‰ä¸  grid-auto-flow ï¼Œgrid-auto-rows å’Œ grid-auto-columns ç›¸åŒçš„å€¼ã€‚å¦‚æœçœç•¥äº†  grid-auto-columns ï¼Œå®ƒè¢«è®¾ç½®ä¸ºç”± grid-auto-rows æŒ‡å®šçš„å€¼ã€‚å¦‚æœä¸¤è€…éƒ½è¢«çœç•¥ï¼Œä»–ä»¬å°±ä¼šè¢«è®¾ç½®ä¸ºåˆå§‹å€¼</p><pre><code class="css">.container {    grid: none | &lt;grid-template-rows&gt; / &lt;grid-template-columns&gt; | &lt;grid-auto-flow&gt; [&lt;grid-auto-rows&gt; [/ &lt;grid-auto-columns&gt;]];}</code></pre><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="css">.container {  grid: 200px auto / 1fr auto 1fr;}//ç­‰ä»·äº.container {  grid-template-rows: 200px auto;  grid-template-columns: 1fr auto 1fr;  grid-template-areas: none;}.container {  grid: column 1fr / auto;}//ç­‰ä»·äº.container {  grid-auto-flow: column;  grid-auto-rows: 1fr;  grid-auto-columns: auto;}</code></pre><p>å®ƒä¹Ÿæ¥å—ä¸€ä¸ªæ›´å¤æ‚ä½†ç›¸å½“æ–¹ä¾¿çš„è¯­æ³•æ¥ä¸€æ¬¡è®¾ç½®æ‰€æœ‰å†…å®¹ã€‚æ‚¨å¯ä»¥  grid-template-areasï¼Œgrid-template-rowså’Œgrid-template-columnsï¼Œå¹¶æ‰€æœ‰å…¶ä»–çš„å­å±æ€§éƒ½è¢«è®¾ç½®ä¸ºå®ƒä»¬çš„åˆå§‹å€¼ã€‚è¿™ä¹ˆåšå¯ä»¥åœ¨å®ƒä»¬ç½‘æ ¼åŒºåŸŸå†…ç›¸åº”åœ°æŒ‡å®šç½‘æ ¼çº¿åå­—å’Œç½‘æ ¼è½¨é“çš„å¤§å°ã€‚ç”¨æœ€ç®€å•çš„ä¾‹å­æ¥æè¿°ï¼š</p><pre><code class="css">.container {  grid: [row1-start] &quot;header header header&quot; 1fr [row1-end]        [row2-start] &quot;footer footer footer&quot; 25px [row2-end]        / auto 50px auto;}//ç­‰ä»·äº.container {  grid-template-areas:     &quot;header header header&quot;    &quot;footer footer footer&quot;;  grid-template-rows: [row1-start] 1fr [row1-end row2-start] 25px [row2-end];  grid-template-columns: auto 50px auto;    }</code></pre><h3 id="ç½‘æ ¼é¡¹-Grid-Item"><a href="#ç½‘æ ¼é¡¹-Grid-Item" class="headerlink" title="ç½‘æ ¼é¡¹(Grid Item)"></a>ç½‘æ ¼é¡¹(Grid Item)</h3><p>ç½‘æ ¼å®¹å™¨ï¼ˆGrid Containerï¼‰çš„å­å…ƒç´ ï¼ˆä¾‹å¦‚ç›´æ¥å­å…ƒç´ ï¼‰ã€‚è¿™é‡Œ item å…ƒç´ å°±æ˜¯ç½‘æ ¼é¡¹(Grid Item)ï¼Œä½†æ˜¯ sub-item ä¸æ˜¯ã€‚</p><pre><code class="html">&lt;div class=&quot;container&quot;&gt;  &lt;div class=&quot;item&quot;&gt;&lt;/div&gt;   &lt;div class=&quot;item&quot;&gt;    &lt;p class=&quot;sub-item&quot;&gt;&lt;/p&gt;  &lt;/div&gt;  &lt;div class=&quot;item&quot;&gt;&lt;/div&gt;&lt;/div&gt;</code></pre><h4 id="grid-column-start-grid-column-end-grid-row-start-grid-row-end"><a href="#grid-column-start-grid-column-end-grid-row-start-grid-row-end" class="headerlink" title="grid-column-start / grid-column-end / grid-row-start / grid-row-end"></a>grid-column-start / grid-column-end / grid-row-start / grid-row-end</h4><p>é€šè¿‡æŒ‡å®š ç½‘æ ¼çº¿(grid lines) æ¥ç¡®å®šç½‘æ ¼å†… ç½‘æ ¼é¡¹(grid item) çš„ä½ç½®ã€‚ grid-column-start /  grid-row-start æ˜¯ç½‘æ ¼é¡¹ç›®å¼€å§‹çš„ç½‘æ ¼çº¿ï¼Œgrid-column-end / grid-row-end æ˜¯ç½‘æ ¼é¡¹ç»“æŸçš„ç½‘æ ¼çº¿ã€‚</p><blockquote><p><line> ï¼šå¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—å¼•ç”¨ä¸€ä¸ªç¼–å·çš„ç½‘æ ¼çº¿ï¼Œæˆ–è€…ä¸€ä¸ªåå­—æ¥å¼•ç”¨ä¸€ä¸ªå‘½åçš„ç½‘æ ¼çº¿<br>span <number> ï¼šè¯¥ç½‘æ ¼é¡¹å°†è·¨è¶Šæ‰€æä¾›çš„ç½‘æ ¼è½¨é“æ•°é‡<br>span <name> ï¼šè¯¥ç½‘æ ¼é¡¹å°†è·¨è¶Šåˆ°å®ƒä¸æä¾›çš„åç§°ä½ç½®<br>auto ï¼šè¡¨ç¤ºè‡ªåŠ¨æ”¾ç½®ï¼Œè‡ªåŠ¨è·¨åº¦ï¼Œé»˜è®¤ä¼šæ‰©å±•ä¸€ä¸ªç½‘æ ¼è½¨é“çš„å®½åº¦æˆ–è€…é«˜åº¦</p></blockquote><pre><code class="css">.item {    grid-column-start: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto    grid-column-end: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto    grid-row-start: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto    grid-row-end: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto}</code></pre><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="css">.item-a {    grid-column-start: 2;    grid-column-end: five;    grid-row-start: row1-start;    grid-row-end: 3;}</code></pre><p><img src="https://www.html.cn/newimg88/2018/12/grid-column-row-start-end-01.svg" alt="grid10"></p><pre><code class="css">.item-b {    grid-column-start: 1;    grid-column-end: span col4-start;    grid-row-start: 2;    grid-row-end: span 2;}</code></pre><p><img src="https://www.html.cn/newimg88/2018/12/grid-column-row-start-end-02.svg" alt="grid11"><br>å¦‚æœæ²¡æœ‰å£°æ˜æŒ‡å®š grid-column-end / grid-row-endï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥ç½‘æ ¼é¡¹å°†å æ®1ä¸ªè½¨é“ã€‚</p><p>é¡¹ç›®å¯ä»¥ç›¸äº’é‡å ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ z-index æ¥æ§åˆ¶å®ƒä»¬çš„é‡å é¡ºåºã€‚</p><h4 id="grid-column-grid-row"><a href="#grid-column-grid-row" class="headerlink" title="grid-column / grid-row"></a>grid-column / grid-row</h4><p>åˆ†åˆ«ä¸º grid-column-start + grid-column-end å’Œ grid-row-start + grid-row-end çš„ç¼©å†™å½¢å¼ã€‚</p><blockquote><p><start-line> / <end-line>ï¼šæ¯ä¸ªç½‘æ ¼é¡¹éƒ½æ¥å—æ‰€æœ‰ç›¸åŒçš„å€¼ï¼Œä½œä¸ºæ™®é€šä¹¦å†™çš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬è·¨åº¦</p></blockquote><pre><code class="css">.item {    grid-column: &lt;start-line&gt; / &lt;end-line&gt; | &lt;start-line&gt; / span &lt;value&gt;;    grid-row: &lt;start-line&gt; / &lt;end-line&gt; | &lt;start-line&gt; / span &lt;value&gt;;}</code></pre><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="css">.item-c {    grid-column: 3 / span 2;    grid-row: third-line / 4;}</code></pre><p><img src="https://www.html.cn/newimg88/2018/12/grid-column-row.svg" alt="grid12"><br>å¦‚æœæ²¡æœ‰å£°æ˜åˆ†éš”çº¿ç»“æŸä½ç½®ï¼Œåˆ™è¯¥ç½‘æ ¼é¡¹é»˜è®¤å æ® 1 ä¸ªç½‘æ ¼è½¨é“ã€‚</p><h4 id="grid-area"><a href="#grid-area" class="headerlink" title="grid-area"></a>grid-area</h4><p>ä¸ºç½‘æ ¼é¡¹æä¾›ä¸€ä¸ªåç§°ï¼Œä»¥ä¾¿å¯ä»¥ è¢«ä½¿ç”¨ç½‘æ ¼å®¹å™¨ grid-template-areas å±æ€§åˆ›å»ºçš„æ¨¡æ¿è¿›è¡Œå¼•ç”¨ã€‚ å¦å¤–ï¼Œè¿™ä¸ªå±æ€§å¯ä»¥ç”¨ä½œgrid-row-start + grid-column-start + grid-row-end +  grid-column-end çš„ç¼©å†™ã€‚</p><blockquote><p><name>ï¼šä½ æ‰€é€‰çš„åç§°</p></blockquote><p><row-start> / <column-start> / <row-end> / <column-end>ï¼šæ•°å­—æˆ–åˆ†éš”çº¿åç§°</p><pre><code class="css">.item {    grid-area: &lt;name&gt; | &lt;row-start&gt; / &lt;column-start&gt; / &lt;row-end&gt; / &lt;column-end&gt;;}</code></pre><h4 id="justify-self"><a href="#justify-self" class="headerlink" title="justify-self"></a>justify-self</h4><p>æ²¿ç€ è¡Œè½´çº¿(row axis) å¯¹é½ ç½‘æ ¼é¡¹ å†…çš„å†…å®¹ï¼ˆ ç›¸åçš„å±æ€§æ˜¯ align-self ï¼Œæ²¿ç€åˆ—è½´çº¿(column axis)å¯¹é½ï¼‰ã€‚æ­¤å€¼é€‚ç”¨äºå•ä¸ªç½‘æ ¼é¡¹å†…çš„å†…å®¹ã€‚</p><blockquote><p>startï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„å·¦ä¾§<br>endï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„å³ä¾§<br>centerï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„ä¸­é—´ï¼ˆæ°´å¹³å±…ä¸­ï¼‰<br>stretchï¼šå¡«å……æ•´ä¸ªç½‘æ ¼åŒºåŸŸçš„å®½åº¦ï¼ˆè¿™æ˜¯é»˜è®¤å€¼ï¼‰</p></blockquote><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="css">.item-a {    justify-self: start;}</code></pre><h4 id="align-self"><a href="#align-self" class="headerlink" title="align-self"></a>align-self</h4><p>æ²¿ç€ åˆ—è½´çº¿(column axis) å¯¹é½ ç½‘æ ¼é¡¹ å†…çš„å†…å®¹ï¼ˆ ç›¸åçš„å±æ€§æ˜¯ justify-self ï¼Œæ²¿ç€ è¡Œè½´çº¿(row axis) å¯¹é½ï¼‰ã€‚æ­¤å€¼é€‚ç”¨äºå•ä¸ªç½‘æ ¼é¡¹å†…çš„å†…å®¹ã€‚</p><blockquote><p>startï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„é¡¶éƒ¨<br>endï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„åº•éƒ¨<br>centerï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„ä¸­é—´ï¼ˆå‚ç›´å±…ä¸­ï¼‰<br>stretchï¼šå¡«å……æ•´ä¸ªç½‘æ ¼åŒºåŸŸçš„é«˜åº¦ï¼ˆè¿™æ˜¯é»˜è®¤å€¼ï¼‰</p><pre><code class="css">.item{  align-self: start | end | center | stretch;}</code></pre></blockquote><p>è¦ä¸ºç½‘æ ¼ä¸­çš„æ‰€æœ‰ç½‘æ ¼é¡¹è®¾ç½® åˆ—è½´çº¿(column axis) ä¸Šçš„å¯¹é½æ–¹å¼ï¼Œä¹Ÿå¯ä»¥åœ¨ ç½‘æ ¼å®¹å™¨ ä¸Šè®¾ç½®  align-items å±æ€§ã€‚</p><h3 id="ç½‘æ ¼çº¿-Grid-Line"><a href="#ç½‘æ ¼çº¿-Grid-Line" class="headerlink" title="ç½‘æ ¼çº¿(Grid Line)"></a>ç½‘æ ¼çº¿(Grid Line)</h3><p>æ„æˆç½‘æ ¼ç»“æ„çš„åˆ†ç•Œçº¿ã€‚å®ƒä»¬æ—¢å¯ä»¥æ˜¯å‚ç›´çš„ï¼ˆâ€œåˆ—ç½‘æ ¼çº¿(column grid lines)â€ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯æ°´å¹³çš„ï¼ˆâ€œè¡Œç½‘æ ¼çº¿(row grid lines)â€ï¼‰ï¼Œå¹¶ä½äºè¡Œæˆ–åˆ—çš„ä»»ä¸€ä¾§ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œçš„é»„çº¿å°±æ˜¯ä¸€æ¡åˆ—ç½‘æ ¼çº¿ã€‚<br><img src="https://www.html.cn/newimg88/2018/12/terms-grid-line.svg" alt="grid2"></p><h3 id="ç½‘æ ¼è½¨é“-Grid-Track"><a href="#ç½‘æ ¼è½¨é“-Grid-Track" class="headerlink" title="ç½‘æ ¼è½¨é“(Grid Track)"></a>ç½‘æ ¼è½¨é“(Grid Track)</h3><p>ä¸¤æ¡ç›¸é‚»ç½‘æ ¼çº¿ä¹‹é—´çš„ç©ºé—´ã€‚ä½ å¯ä»¥æŠŠå®ƒä»¬æƒ³è±¡æˆç½‘æ ¼çš„åˆ—æˆ–è¡Œã€‚ä¸‹å›¾æ˜¯ç¬¬äºŒæ¡å’Œç¬¬ä¸‰æ¡ è¡Œç½‘æ ¼çº¿ ä¹‹é—´çš„ ç½‘æ ¼è½¨é“(Grid Track)ã€‚<br><img src="https://www.html.cn/newimg88/2018/12/terms-grid-track.svg" alt="grid3"></p><h3 id="ç½‘æ ¼å•å…ƒæ ¼-Grid-Cell"><a href="#ç½‘æ ¼å•å…ƒæ ¼-Grid-Cell" class="headerlink" title="ç½‘æ ¼å•å…ƒæ ¼(Grid Cell)"></a>ç½‘æ ¼å•å…ƒæ ¼(Grid Cell)</h3><p>ä¸¤ä¸ªç›¸é‚»çš„è¡Œå’Œä¸¤ä¸ªç›¸é‚»çš„åˆ—ç½‘æ ¼çº¿ä¹‹é—´çš„ç©ºé—´ã€‚è¿™æ˜¯ Grid(ç½‘æ ¼) ç³»ç»Ÿçš„ä¸€ä¸ªâ€œå•å…ƒâ€ã€‚ä¸‹å›¾æ˜¯ç¬¬1è‡³ç¬¬2æ¡ è¡Œç½‘æ ¼çº¿ å’Œç¬¬2è‡³ç¬¬3æ¡ åˆ—ç½‘æ ¼çº¿ äº¤æ±‡æ„æˆçš„ ç½‘æ ¼å•å…ƒæ ¼(Grid Cell)ã€‚<br><img src="https://www.html.cn/newimg88/2018/12/terms-grid-track.svg" alt="grid4"></p><h3 id="ç½‘æ ¼åŒºåŸŸ-Grid-Area"><a href="#ç½‘æ ¼åŒºåŸŸ-Grid-Area" class="headerlink" title="ç½‘æ ¼åŒºåŸŸ(Grid Area)"></a>ç½‘æ ¼åŒºåŸŸ(Grid Area)</h3><p>4æ¡ç½‘æ ¼çº¿åŒ…å›´çš„æ€»ç©ºé—´ã€‚ä¸€ä¸ª ç½‘æ ¼åŒºåŸŸ(Grid Area) å¯ä»¥ç”±ä»»æ„æ•°é‡çš„ ç½‘æ ¼å•å…ƒæ ¼(Grid Cell) ç»„æˆã€‚ä¸‹å›¾æ˜¯ è¡Œç½‘æ ¼çº¿1å’Œ3ï¼Œä»¥åŠåˆ—ç½‘æ ¼çº¿1å’Œ3 ä¹‹é—´çš„ç½‘æ ¼åŒºåŸŸã€‚<br><img src="https://www.html.cn/newimg88/2018/12/terms-grid-area.svg" alt="grid5"></p><p>æ›´å¤šå…³äº CSS Grid å¸ƒå±€çš„ä¼˜ç§€æ–‡ç« <br><a href="http://www.css88.com/archives/8506" target="_blank" rel="noopener">5åˆ†é’Ÿå­¦ä¼š CSS Grid å¸ƒå±€</a><br><a href="http://www.css88.com/archives/8510" target="_blank" rel="noopener">CSS Grid å¸ƒå±€å®Œå…¨æŒ‡å—(å›¾è§£ Grid è¯¦ç»†æ•™ç¨‹)</a><br><a href="http://www.css88.com/archives/8512" target="_blank" rel="noopener">å¦‚ä½•ä½¿ç”¨ CSS Grid å¿«é€Ÿè€Œåˆçµæ´»çš„å¸ƒå±€</a></p>]]></content>
      
      
      <categories>
          
          <category> Css3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Css3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çœ‹æ¼«ç”»ï¼Œå­¦ä¹ Redux</title>
      <link href="/2018/03/05/React/Redux/%E7%9C%8B%E6%BC%AB%E7%94%BB%EF%BC%8C%E5%AD%A6%E4%B9%A0Redux/"/>
      <url>/2018/03/05/React/Redux/%E7%9C%8B%E6%BC%AB%E7%94%BB%EF%BC%8C%E5%AD%A6%E4%B9%A0Redux/</url>
      
        <content type="html"><![CDATA[<p>React åªæ˜¯ DOM çš„ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå¹¶ä¸æ˜¯ Web åº”ç”¨çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå®ƒæ²¡æ¶‰åŠã€‚</p><ul><li>ä»£ç ç»“æ„</li><li>ç»„ä»¶ä¹‹é—´çš„é€šä¿¡</li></ul><p>å¯¹äºå¤§å‹çš„å¤æ‚åº”ç”¨æ¥è¯´ï¼Œè¿™ä¸¤æ–¹é¢æ°æ°æ˜¯æœ€å…³é”®çš„ã€‚å› æ­¤ï¼Œåªç”¨ React æ²¡æ³•å†™å¤§å‹åº”ç”¨ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ2014å¹´ Facebook æå‡ºäº†<a href="http://www.ruanyifeng.com/blog/2016/01/flux.html" target="_blank" rel="noopener">Flux</a>æ¶æ„çš„æ¦‚å¿µï¼Œå¼•å‘äº†å¾ˆå¤šçš„å®ç°ã€‚2015å¹´ï¼ŒRedux å‡ºç°ï¼Œå°† Flux ä¸å‡½æ•°å¼ç¼–ç¨‹ç»“åˆä¸€èµ·ï¼Œå¾ˆçŸ­æ—¶é—´å†…å°±æˆä¸ºäº†æœ€çƒ­é—¨çš„å‰ç«¯æ¶æ„ã€‚</p><p>Redux çš„è®¾è®¡æ€æƒ³å¾ˆç®€å•ï¼Œå°±ä¸¤å¥è¯ã€‚</p><p><em>ï¼ˆ1ï¼‰<font color="red">Web åº”ç”¨æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œè§†å›¾ä¸çŠ¶æ€æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚</font> </em></p><p><em>ï¼ˆ2ï¼‰<font color="red">æ‰€æœ‰çš„çŠ¶æ€ï¼Œä¿å­˜åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ã€‚</font> </em></p><p>Flux æ¶æ„å·²ç„¶è®©äººè§‰å¾—æœ‰äº›è¿·æƒ‘ï¼Œè€Œæ¯” Flux æ›´è®©äººæ‘¸ä¸ç€å¤´è„‘çš„æ˜¯ Flux ä¸ Redux çš„åŒºåˆ«ã€‚Redux æ˜¯ä¸€ä¸ªåŸºäº Flux æ€æƒ³çš„æ–°æ¶æ„æ–¹å¼ï¼Œæœ¬æ–‡å°†æ¢è®¨å®ƒä»¬çš„åŒºåˆ«ã€‚</p><hr><h2 id="ä¸ºä»€ä¹ˆè¦æ”¹å˜-Fluxï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦æ”¹å˜-Fluxï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æ”¹å˜ Fluxï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦æ”¹å˜ Fluxï¼Ÿ</h2><p>Redux è§£å†³çš„é—®é¢˜å’Œ Flux ä¸€æ ·ï¼Œä½† Redux èƒ½åšçš„è¿˜æœ‰æ›´å¤šã€‚<br><a id="more"></a><br>å’Œ Flux ä¸€æ ·ï¼ŒRedux è®©åº”ç”¨çš„çŠ¶æ€å˜åŒ–å˜å¾—æ›´åŠ å¯é¢„æµ‹ã€‚å¦‚æœä½ æƒ³æ”¹å˜åº”ç”¨çš„çŠ¶æ€ï¼Œå°±å¿…é¡» dispatch ä¸€ä¸ª actionã€‚ä½ æ²¡æœ‰åŠæ³•ç›´æ¥æ”¹å˜åº”ç”¨çš„çŠ¶æ€ï¼Œå› ä¸ºä¿å­˜è¿™äº›çŠ¶æ€çš„ä¸œè¥¿ï¼ˆç§°ä¸º storeï¼‰åªæœ‰ getter è€Œæ²¡æœ‰ setterã€‚å¯¹äº Flux å’Œ Redux æ¥è¯´ï¼Œè¿™äº›æ¦‚å¿µéƒ½æ˜¯ç›¸ä¼¼çš„ã€‚</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆè¦æ–°è®¾è®¡ä¸€ç§æ¶æ„å‘¢ï¼ŸRedux çš„åˆ›é€ è€… Dan Abramov å‘ç°äº†æ”¹è¿› Flux æ¶æ„çš„å¯èƒ½ã€‚ä»–æƒ³è¦ä¸€ä¸ªæ›´å¥½çš„å¼€å‘è€…å·¥å…·æ¥è°ƒè¯• Flux åº”ç”¨ã€‚ä»–å‘ç°å¦‚æœç¨å¾®å¯¹ Flux æ¶æ„è¿›è¡Œä¸€äº›è°ƒæ•´ï¼Œå°±å¯ä»¥å¼€å‘å‡ºä¸€æ¬¾æ›´å¥½ç”¨çš„å¼€å‘è€…å·¥å…·ï¼ŒåŒæ—¶ä¾ç„¶èƒ½äº«å— Flux æ¶æ„å¸¦ç»™ä½ çš„å¯é¢„æµ‹æ€§ã€‚</p><p>ç¡®åˆ‡çš„è¯´ï¼Œä»–æƒ³è¦çš„å¼€å‘è€…å·¥å…·åŒ…å«äº†ä»£ç çƒ­æ›¿æ¢ï¼ˆhot reloadï¼‰å’Œæ—¶é—´æ—…è¡Œï¼ˆtime travelï¼‰åŠŸèƒ½ã€‚ç„¶è€Œè¦æƒ³åœ¨ Flux æ¶æ„ä¸Šå®ç°è¿™äº›åŠŸèƒ½ï¼Œç¡®å®æœ‰äº›éº»çƒ¦ã€‚</p><h3 id="é—®é¢˜1ï¼šstore-çš„ä»£ç æ— æ³•è¢«çƒ­æ›¿æ¢ï¼Œé™¤éæ¸…ç©ºå½“å‰çš„çŠ¶æ€"><a href="#é—®é¢˜1ï¼šstore-çš„ä»£ç æ— æ³•è¢«çƒ­æ›¿æ¢ï¼Œé™¤éæ¸…ç©ºå½“å‰çš„çŠ¶æ€" class="headerlink" title="é—®é¢˜1ï¼šstore çš„ä»£ç æ— æ³•è¢«çƒ­æ›¿æ¢ï¼Œé™¤éæ¸…ç©ºå½“å‰çš„çŠ¶æ€"></a>é—®é¢˜1ï¼šstore çš„ä»£ç æ— æ³•è¢«çƒ­æ›¿æ¢ï¼Œé™¤éæ¸…ç©ºå½“å‰çš„çŠ¶æ€</h3><p>åœ¨ Flux ä¸­ï¼Œstore åŒ…å«äº†ä¸¤æ ·ä¸œè¥¿ï¼š</p><blockquote><p>æ”¹å˜çŠ¶æ€çš„é€»è¾‘<br>  å½“å‰çš„çŠ¶æ€</p></blockquote><p>åœ¨ä¸€ä¸ª store ä¸­åŒæ—¶ä¿å­˜è¿™ä¸¤æ ·ä¸œè¥¿å°†ä¼šå¯¼è‡´ä»£ç çƒ­æ›¿æ¢åŠŸèƒ½å‡ºç°é—®é¢˜ã€‚å½“ä½ çƒ­æ›¿æ¢æ‰ store çš„ä»£ç æƒ³è¦çœ‹çœ‹æ–°çš„çŠ¶æ€æ”¹å˜é€»è¾‘æ˜¯å¦ç”Ÿæ•ˆæ—¶ï¼Œä½ å°±ä¸¢å¤±äº† store ä¸­ä¿å­˜çš„å½“å‰çŠ¶æ€ã€‚æ­¤å¤–ï¼Œä½ è¿˜æŠŠ store ä¸ Flux æ¶æ„ä¸­å…¶å®ƒç»„ä»¶äº§ç”Ÿå…³ç³»çš„äº‹ä»¶ç³»ç»Ÿæä¹±äº†ã€‚</p><p><img src="https://camo.githubusercontent.com/6de7496b7a2cd09a391e2e35ab05b9163c9cca7d/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a4c36364b397543516a6a486d704177542d61394335512e706e67" alt="redux-img-1"></p><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><p>å°†è¿™ä¸¤æ ·ä¸œè¥¿åˆ†å¼€å¤„ç†ã€‚è®©ä¸€ä¸ªå¯¹è±¡æ¥ä¿å­˜çŠ¶æ€ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨çƒ­æ›¿æ¢ä»£ç çš„æ—¶å€™ä¸ä¼šå—åˆ°å½±å“ã€‚è®©å¦ä¸€ä¸ªå¯¹è±¡åŒ…å«æ‰€æœ‰æ”¹å˜çŠ¶æ€çš„é€»è¾‘ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥è¢«çƒ­æ›¿æ¢å› ä¸ºå®ƒä¸ç”¨å…³å¿ƒä»»ä½•ä¿å­˜çŠ¶æ€ç›¸å…³çš„äº‹æƒ…ã€‚</p><p><img src="https://camo.githubusercontent.com/c56fe4af77a013cc07809e18255936dfe7d25c56/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a6e42734743576d4a54522d5a6a3761586549453879672e706e67" alt="redux-img-2"></p><h3 id="é—®é¢˜2ï¼šæ¯æ¬¡è§¦å‘-action-æ—¶çŠ¶æ€å¯¹è±¡éƒ½è¢«ç›´æ¥æ”¹å†™äº†"><a href="#é—®é¢˜2ï¼šæ¯æ¬¡è§¦å‘-action-æ—¶çŠ¶æ€å¯¹è±¡éƒ½è¢«ç›´æ¥æ”¹å†™äº†" class="headerlink" title="é—®é¢˜2ï¼šæ¯æ¬¡è§¦å‘ action æ—¶çŠ¶æ€å¯¹è±¡éƒ½è¢«ç›´æ¥æ”¹å†™äº†"></a>é—®é¢˜2ï¼šæ¯æ¬¡è§¦å‘ action æ—¶çŠ¶æ€å¯¹è±¡éƒ½è¢«ç›´æ¥æ”¹å†™äº†</h3><p>æ—¶é—´æ—…è¡Œè°ƒè¯•æ³•çš„ç‰¹æ€§æ˜¯ï¼šä½ èƒ½æŒæ¡çŠ¶æ€å¯¹è±¡çš„æ¯ä¸€æ¬¡å˜åŒ–ï¼Œè¿™æ ·çš„è¯ï¼Œä½ å°±èƒ½è½»æ¾çš„è·³å›åˆ°è¿™ä¸ªå¯¹è±¡ä¹‹å‰çš„æŸä¸ªçŠ¶æ€ï¼ˆæƒ³è±¡ä¸€ä¸ªæ’¤é”€åŠŸèƒ½ï¼‰ã€‚</p><p>è¦å®ç°è¿™æ ·çš„åŠŸèƒ½ï¼Œæ¯æ¬¡çŠ¶æ€æ”¹å˜ä¹‹åï¼Œä½ éƒ½éœ€è¦æŠŠæ—§çš„çŠ¶æ€ä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ã€‚ä½†æ˜¯ç”±äº JavaScript çš„å¯¹è±¡å¼•ç”¨ç‰¹æ€§ï¼Œç®€å•çš„æŠŠä¸€ä¸ªå¯¹è±¡æ”¾è¿›æ•°ç»„ä¸­å¹¶ä¸èƒ½å®ç°æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½ã€‚è¿™æ ·åšä¸èƒ½åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼ˆsnapshotï¼‰ï¼Œè€Œåªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚</p><p>æ‰€ä»¥è¦æƒ³å®ç°æ—¶é—´æ—…è¡Œç‰¹æ€§ï¼Œæ¯ä¸€ä¸ªçŠ¶æ€æ”¹å˜çš„ç‰ˆæœ¬éƒ½éœ€è¦ä¿å­˜åœ¨ä¸åŒçš„ JavaScript å¯¹è±¡ä¸­ï¼Œè¿™æ ·ä½ æ‰ä¸ä¼šä¸å°å¿ƒæ”¹å˜äº†æŸä¸ªå†å²ç‰ˆæœ¬çš„çŠ¶æ€ã€‚</p><p><img src="https://camo.githubusercontent.com/f86631450bf5c015d8f378fafd932e12e74596b7/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a347a4f4476357667764b736936547337546968736f412e706e67" alt="redux-img-3"></p><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><p>å½“ä¸€ä¸ª action éœ€è¦ store å“åº”æ—¶ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹ store ä¸­çš„çŠ¶æ€ï¼Œè€Œæ˜¯å°†çŠ¶æ€æ‹·è´ä¸€ä»½å¹¶åœ¨è¿™ä»½æ‹·è´çš„çŠ¶æ€ä¸Šåšå‡ºä¿®æ”¹ã€‚</p><p><img src="https://camo.githubusercontent.com/f41ce7a53d59f43f6bf9318590a500f6892d6d6d/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a774c52685a307774493064754c73696764784c3143412e706e67" alt="redux-img-4"></p><h3 id="é—®é¢˜3ï¼šæ²¡æœ‰åˆé€‚çš„ä½ç½®å¼•å…¥ç¬¬ä¸‰æ–¹æ’ä»¶"><a href="#é—®é¢˜3ï¼šæ²¡æœ‰åˆé€‚çš„ä½ç½®å¼•å…¥ç¬¬ä¸‰æ–¹æ’ä»¶" class="headerlink" title="é—®é¢˜3ï¼šæ²¡æœ‰åˆé€‚çš„ä½ç½®å¼•å…¥ç¬¬ä¸‰æ–¹æ’ä»¶"></a>é—®é¢˜3ï¼šæ²¡æœ‰åˆé€‚çš„ä½ç½®å¼•å…¥ç¬¬ä¸‰æ–¹æ’ä»¶</h3><p>å½“ä½ åœ¨å†™ä¸€äº›è°ƒè¯•æ€§å·¥å…·æ—¶ï¼Œä½ å¸Œæœ›å®ƒä»¬èƒ½å¤Ÿæ›´åŠ é€šç”¨ã€‚ä¸€ä¸ªä½¿ç”¨è¯¥å·¥å…·çš„ç”¨æˆ·åº”è¯¥å¯ä»¥ç›´æ¥å¼•å…¥è¿™ä¸ªå·¥å…·è€Œä¸éœ€è¦åšé¢å¤–çš„åŒ…è£…æˆ–æ¡¥æ¥ã€‚</p><p>è¦å®ç°è¿™æ ·çš„ç‰¹æ€§ï¼ŒFlux æ¶æ„éœ€è¦ä¸€ä¸ªæ‰©å±•ç‚¹ã€‚</p><p>ä¸€ä¸ªç®€å•çš„ä¾‹å­å°±æ˜¯æ—¥å¿—ã€‚æ¯”å¦‚è¯´ä½ å¸Œæœ› console.log() æ¯ä¸€ä¸ªè§¦å‘çš„ action åŒæ—¶ console.log() è¿™ä¸ª action è¢«å“åº”å®Œæˆåçš„çŠ¶æ€ã€‚åœ¨ Flux ä¸­ï¼Œä½ åªèƒ½è®¢é˜…ï¼ˆsubscribeï¼‰ dispatcher çš„æ›´æ–°å’Œæ¯ä¸€ä¸ª store çš„å˜åŠ¨ã€‚ä½†æ˜¯è¿™æ ·å°±ä¾µå…¥äº†ä¸šåŠ¡ä»£ç ï¼Œè¿™æ ·çš„æ—¥å¿—åŠŸèƒ½ä¸æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ’ä»¶èƒ½å¤Ÿè½»æ˜“å®ç°çš„ã€‚</p><p><img src="https://camo.githubusercontent.com/bbb508730d3e3c634dd1c054934d3b802d715bc2/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a4d473733367a47744c4d4262536b68777534443363412e706e67" alt="redux-img-5"></p><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><p>å°†è¿™ä¸ªæ¶æ„çš„éƒ¨åˆ†åŠŸèƒ½åŒ…è£…è¿›å…¶ä»–çš„å¯¹è±¡ä¸­å°†ä½¿å¾—æˆ‘ä»¬çš„éœ€æ±‚å˜å¾—æ›´å®¹æ˜“å®ç°ã€‚è¿™äº›ã€Œå…¶ä»–å¯¹è±¡ã€åœ¨æ¶æ„åŸæœ‰çš„åŠŸèƒ½åŸºç¡€ä¹‹ä¸Šæ·»åŠ äº†è‡ªå·±çš„åŠŸèƒ½ã€‚ä½ å¯ä»¥æŠŠè¿™ç§æ‰©å±•ç‚¹çœ‹åšæ˜¯ä¸€ä¸ªå¢å¼ºå™¨ï¼ˆenhancersï¼‰æˆ–è€…é«˜é˜¶å¯¹è±¡ï¼ˆhigher order objectsï¼‰ï¼Œäº¦æˆ–è€…ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰ã€‚</p><p>æ­¤å¤–ï¼Œä½¿ç”¨ä¸€ä¸ªæ ‘å½¢ç»“æ„æ¥ç»„ç»‡æ‰€æœ‰æ”¹å˜çŠ¶æ€çš„é€»è¾‘ï¼Œè¿™æ ·å½“çŠ¶æ€å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ store åªä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶æ¥é€šçŸ¥è§†å›¾å±‚ï¼ˆviewï¼‰ï¼Œè€Œè¿™ä¸€ä¸ªäº‹ä»¶ä¼šè¢«æ•´æ£µæ ‘ä¸­çš„æ‰€æœ‰é€»è¾‘å¤„ç†ï¼ˆè¯‘è€…æ³¨ï¼šã€Œå¤„ç†ã€ä¸ä»£è¡¨ä¸€å®šä¼šæ”¹å˜çŠ¶æ€ï¼Œè¿™äº›æ”¹å˜çŠ¶æ€çš„é€»è¾‘æœ¬è´¨ä¸Šæ˜¯å‡½æ•°ï¼Œå‡½æ•°å†…éƒ¨ä¼šæ ¹æ® action çš„ç±»å‹ç­‰æ¥ç¡®å®šæ˜¯å¦å¯¹çŠ¶æ€è¿›è¡Œæ”¹å˜ï¼‰ã€‚</p><p><img src="https://camo.githubusercontent.com/ae8d5c840e44a7e05b29f10539896e8eaa09726a/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a354a615a5363334a736e39504a5937646145445644412e706e67" alt="redux-img-6"></p><blockquote><p>æ³¨æ„ï¼šå°±ä¸Šè¿°è¿™äº›é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆæ¥è¯´ï¼Œæˆ‘ä¸»è¦åœ¨å…³æ³¨å¼€å‘è€…å·¥å…·è¿™ä¸€ä½¿ç”¨åœºæ™¯ã€‚å®é™…ä¸Šï¼Œå¯¹ Flux åšå‡ºçš„è¿™äº›æ”¹å˜åœ¨å…¶ä»–åœºæ™¯ä¸­ä¹Ÿéå¸¸æœ‰å¸®åŠ©ã€‚åœ¨ä¸Šè¿°ä¸‰ç‚¹ä¹‹å¤–ï¼ŒFlux å’Œ Redux è¿˜æœ‰æ›´å¤šçš„ä¸åŒç‚¹ã€‚æ¯”å¦‚ï¼Œç›¸æ¯”äº Fluxï¼ŒRedux ç²¾ç®€äº†æ•´ä¸ªæ¶æ„çš„å†—ä½™ä»£ç ï¼Œå¹¶ä¸”å¤ç”¨ store çš„é€»è¾‘å˜å¾—æ›´åŠ ç®€å•ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª <a href="https://stackoverflow.com/questions/32461229/why-use-redux-over-facebook-flux/32920459#32920459" target="_blank" rel="noopener">Redux ä¼˜ç‚¹çš„åˆ—è¡¨</a>å¯ä¾›å‚è€ƒã€‚</p></blockquote><p>é‚£ä¹ˆè®©æˆ‘ä»¬æ¥çœ‹çœ‹ Redux æ˜¯æ€ä¹ˆè®©è¿™äº›ç‰¹æ€§å˜ä¸ºç°å®çš„ã€‚</p><h2 id="æ–°çš„è§’è‰²"><a href="#æ–°çš„è§’è‰²" class="headerlink" title="æ–°çš„è§’è‰²"></a>æ–°çš„è§’è‰²</h2><p>ä» Flux æ¼”è¿›åˆ° Reduxï¼Œæ•´ä¸ªæ¶æ„ä¸­çš„è§’è‰²å‘ç”Ÿäº†äº›è®¸çš„å˜åŒ–ã€‚</p><h3 id="Action-creators"><a href="#Action-creators" class="headerlink" title="Action creators"></a>Action creators</h3><p><img src="https://camo.githubusercontent.com/8da1995413187f344a236796df578e1d09fe9a1d/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313230302f312a556c6a727268345a37556955776b38416a554f3950412e706e67" alt="redux-img-7"><br>Redux ä¿ç•™äº† Flux ä¸­ action creator çš„æ¦‚å¿µã€‚æ¯å½“ä½ æƒ³è¦æ”¹å˜åº”ç”¨ä¸­çš„çŠ¶æ€æ—¶ï¼Œä½ å°±è¦ dispatch ä¸€ä¸ª actionï¼Œè¿™ä¹Ÿæ˜¯å”¯ä¸€æ”¹å˜çŠ¶æ€çš„æ–¹æ³•ã€‚</p><p>å°±åƒæˆ‘åœ¨è¿™ç¯‡å…³äº Flux çš„æ–‡ç« ä¸­æåˆ°çš„ä¸€æ ·ï¼Œæˆ‘æŠŠ action creator çœ‹åšæ˜¯ä¸€ä¸ªæŠ¥åŠ¡å‘˜ï¼ˆè´Ÿè´£å‘ç”µæŠ¥çš„äººï¼Œtelegraph operatorï¼‰ï¼Œä½ æ‰¾åˆ° action creator å‘Šè¯‰ä»–ä½ å¤§è‡´ä¸Šæƒ³è¦ä¼ è¾¾ä»€ä¹ˆä¿¡æ¯ï¼Œaction creator åˆ™ä¼šæŠŠè¿™äº›ä¿¡æ¯æ ¼å¼åŒ–ä¸ºä¸€ç§æ ‡å‡†çš„æ ¼å¼ï¼Œä»¥ä¾¿ç³»ç»Ÿä¸­çš„å…¶ä»–éƒ¨åˆ†èƒ½å¤Ÿç†è§£ã€‚</p><p>ä¸ Flux ä¸åŒçš„æ˜¯ï¼ŒRedux ä¸­çš„ action creator ä¸ä¼šç›´æ¥æŠŠ action å‘é€ç»™ dispatcherï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–å¥½çš„ JavaScript å¯¹è±¡ã€‚</p><h3 id="The-store"><a href="#The-store" class="headerlink" title="The store"></a>The store</h3><p>æˆ‘æŠŠ Flux ä¸­çš„ store æè¿°ä¸ºä¸€ç§è¿‡åº¦æ§åˆ¶çš„å®˜åƒšæœºåˆ¶ã€‚ä¸èƒ½ç®€å•ç›´æ¥çš„ä¿®æ”¹çŠ¶æ€ï¼Œè€Œæ˜¯è¦æ±‚æ‰€æœ‰çš„çŠ¶æ€æ”¹å˜éƒ½å¿…é¡»ç”± store äº²è‡ªäº§ç”Ÿï¼Œè¿˜å¿…é¡»è¦ç»å† action åˆ†å‘é‚£ç§å¥—è·¯ã€‚åœ¨ Redux ä¸­ï¼Œstore ä¾ç„¶æ˜¯è¿™ä¹ˆçš„å……æ»¡æ§åˆ¶æ¬²å’Œå®˜åƒšä¸»ä¹‰ï¼Œä½†æ˜¯åˆæœ‰äº›ä¸ä¸€æ ·ã€‚</p><p><img src="https://camo.githubusercontent.com/f28fbec52ba810806df9a4fbb497e936515fc506/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313230302f312a477a74633754487a787a4f674a6d47764a39354951412e706e67" alt="redux-img-8"></p><p>åœ¨ Flux ä¸­ï¼Œä½ å¯ä»¥æ‹¥æœ‰å¤šä¸ª storeï¼Œæ¯ä¸€ä¸ª store éƒ½æœ‰è‡ªå·±çš„ç»Ÿæ²»æƒã€‚æ¯ä¸ª store éƒ½ä¿å­˜ç€è‡ªå·±å¯¹åº”çš„é‚£éƒ¨åˆ†çŠ¶æ€ï¼Œä»¥åŠæ‰€æœ‰ä¿®æ”¹è¿™äº›çŠ¶æ€çš„é€»è¾‘ã€‚</p><p>è€Œ Redux ä¸­çš„ store æ›´å–œæ¬¢å°†æƒåŠ›ä¸‹æ”¾ï¼Œè€Œä¸”ä¸å¾—ä¸è¿™ä¹ˆåšã€‚å› ä¸ºåœ¨ Redux ä¸­ï¼Œä½ åªèƒ½æœ‰ä¸€ä¸ª storeâ€¦â€¦æ‰€ä»¥å¦‚æœä½ æ‰“ç®—åƒ Flux é‚£æ · store å®Œå…¨ç‹¬ç«‹å¤„ç†è‡ªå·±çš„äº‹æƒ…ï¼Œé‚£ä¹ˆ Redux ä¸­çš„ store å°†å˜å¾—å·¥ä½œé‡å·¨å¤§ã€‚</p><p>å› æ­¤ï¼ŒRedux ä¸­çš„ store é¦–å…ˆä¼šä¿å­˜æ•´ä¸ªåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ï¼Œç„¶åå°†åˆ¤æ–­å“ªä¸€éƒ¨åˆ†çŠ¶æ€éœ€è¦æ”¹å˜çš„ä»»åŠ¡åˆ†é…ä¸‹å»ã€‚è€Œä»¥æ ¹ reducerï¼ˆroot reducerï¼‰ä¸ºé¦–çš„ reducer ä»¬å°†ä¼šæ‰¿æ‹…è¿™ä¸ªä»»åŠ¡ã€‚</p><p>ä½ å¯èƒ½å‘ç°è¿™é‡Œå¥½åƒæ²¡æœ‰ dispatcher ä»€ä¹ˆäº‹ï¼Œçœ‹èµ·æ¥æœ‰ç‚¹è¶Šæƒï¼Œä½† store å·²ç»å®Œå…¨æ¥ç®¡äº† dispatch ç›¸å…³çš„å·¥ä½œã€‚</p><h3 id="The-reducers"><a href="#The-reducers" class="headerlink" title="The reducers"></a>The reducers</h3><p>å½“ store éœ€è¦çŸ¥é“ä¸€ä¸ª action è§¦å‘åçŠ¶æ€éœ€è¦æ€ä¹ˆæ”¹å˜æ—¶ï¼Œä»–ä¼šå»è¯¢é—® reducerã€‚æ ¹ reducer ä¼šæ ¹æ®çŠ¶æ€å¯¹è±¡çš„é”®ï¼ˆkeyï¼‰å°†æ•´ä¸ªçŠ¶æ€æ ‘è¿›è¡Œæ‹†åˆ†ï¼Œç„¶åå°†æ‹†åˆ†åçš„æ¯ä¸€å—å­çŠ¶æ€ä¼ åˆ°çŸ¥é“è¯¥æ€ä¹ˆå“åº”çš„å­ reducer é‚£é‡Œè¿›è¡Œå¤„ç†ã€‚<br><img src="https://camo.githubusercontent.com/dec23aa9ceed12be5d715504cf28e290c0b423cc/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313230302f312a566f63795f36476c395062466c43494a7345397233412e706e67" alt="redux-img-9"></p><p>æˆ‘æŠŠ reducers çœ‹åšæ˜¯æœ‰ç‚¹æ ¼å¤–çƒ­è¡·å¤å°çš„ç™½é¢†ã€‚ä»–ä»¬ä¸å¸Œæœ›æŠŠä»»ä½•äº‹æç ¸ï¼Œå› æ­¤ä»–ä»¬ä¸ä¼šä¿®æ”¹ä»»ä½•ä¼ é€’ç»™ä»–ä»¬çš„æ–‡ä»¶ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œä»–ä»¬ä¼šå¯¹è¿™äº›æ–‡ä»¶è¿›è¡Œå¤å°ï¼Œç„¶ååœ¨å¤å°ä»¶ä¸Šè¿›è¡Œä¿®æ”¹ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šå½“ç„¶ï¼Œå½“è¿™äº›ä¿®æ”¹åçš„å¤å°ä»¶å®šç¨¿åï¼Œä»–ä»¬ä¹Ÿä¸ä¼šå†å»ä¿®æ”¹è¿™äº›å¤å°ä»¶ã€‚ï¼‰</p><p>è¿™æ˜¯ Redux çš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€ã€‚ä¸ç›´æ¥ä¿®æ”¹æ•´ä¸ªåº”ç”¨çš„çŠ¶æ€æ ‘ï¼Œè€Œæ˜¯å°†çŠ¶æ€æ ‘çš„æ¯ä¸€éƒ¨åˆ†è¿›è¡Œæ‹·è´å¹¶ä¿®æ”¹æ‹·è´åçš„éƒ¨åˆ†ï¼Œç„¶åå°†è¿™äº›éƒ¨åˆ†é‡æ–°ç»„åˆæˆä¸€é¢—æ–°çš„çŠ¶æ€æ ‘ã€‚</p><p>å­ reducers ä¼šæŠŠä»–ä»¬åˆ›å»ºçš„å‰¯æœ¬ä¼ å›ç»™æ ¹ reducerï¼Œè€Œæ ¹ reducer ä¼šæŠŠè¿™äº›å‰¯æœ¬ç»„åˆèµ·æ¥å½¢æˆä¸€é¢—æ–°çš„çŠ¶æ€æ ‘ã€‚æœ€åæ ¹ reducer å°†æ–°çš„çŠ¶æ€æ ‘ä¼ å›ç»™ storeï¼Œstore å†å°†æ–°çš„çŠ¶æ€æ ‘è®¾ä¸ºæœ€ç»ˆçš„çŠ¶æ€ã€‚</p><p>å¦‚æœä½ æœ‰ä¸€ä¸ªå°å‹åº”ç”¨ï¼Œä½ å¯èƒ½åªæœ‰ä¸€ä¸ª reducer å¯¹æ•´ä¸ªçŠ¶æ€æ ‘è¿›è¡Œæ‹·è´å¹¶ä½œå‡ºä¿®æ”¹ã€‚åˆæˆ–è€…ä½ æœ‰ä¸€ä¸ªè¶…å¤§çš„åº”ç”¨ï¼Œä½ å¯èƒ½ä¼šæœ‰è‹¥å¹²ä¸ª reducers å¯¹æ•´ä¸ªçŠ¶æ€æ ‘è¿›è¡Œä¿®æ”¹ã€‚è¿™ä¹Ÿæ˜¯ Flux å’Œ Redux çš„å¦ä¸€å¤„åŒºåˆ«ã€‚åœ¨ Flux ä¸­ï¼Œstore å¹¶ä¸éœ€è¦ä¸å…¶ä»– store äº§ç”Ÿå…³è”ï¼Œè€Œä¸” store çš„ç»“æ„æ˜¯æ‰å¹³çš„ã€‚è€Œåœ¨ Redux ä¸­ï¼Œreducers æ˜¯æœ‰å±‚çº§ç»“æ„çš„ã€‚è¿™ç§å±‚çº§ç»“æ„å¯ä»¥æœ‰è‹¥å¹²å±‚ï¼Œå°±åƒç»„ä»¶çš„å±‚çº§ç»“æ„é‚£æ ·ã€‚</p><h3 id="The-views-æ™ºèƒ½ç»„ä»¶ï¼ˆsmart-componentsï¼‰å’Œæœ¨å¶ç»„ä»¶-dumb-components"><a href="#The-views-æ™ºèƒ½ç»„ä»¶ï¼ˆsmart-componentsï¼‰å’Œæœ¨å¶ç»„ä»¶-dumb-components" class="headerlink" title="The views: æ™ºèƒ½ç»„ä»¶ï¼ˆsmart componentsï¼‰å’Œæœ¨å¶ç»„ä»¶(dumb components)"></a>The views: æ™ºèƒ½ç»„ä»¶ï¼ˆsmart componentsï¼‰å’Œæœ¨å¶ç»„ä»¶(dumb components)</h3><p>Flux æ‹¥æœ‰æ§åˆ¶å‹è§†å›¾ï¼ˆcontroller viewsï¼‰ å’Œå¸¸è§„å‹è§†å›¾ï¼ˆregular viewsï¼‰ã€‚æ§åˆ¶å‹è§†å›¾å°±åƒæ˜¯ä¸€ä¸ªç»ç†ä¸€æ ·ï¼Œç®¡ç†ç€ store å’Œå­è§†å›¾ï¼ˆchild viewsï¼‰ä¹‹é—´çš„é€šä¿¡ã€‚<br><img src="https://camo.githubusercontent.com/47a677ab402c5ebe20828858ae6d95c5cb60b73a/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313230302f312a5467436b46636a6c4439537853724d765658334472412e706e67" alt="redux-img-10"></p><p>åœ¨ Redux ä¸­ï¼Œä¹Ÿæœ‰ä¸€ä¸ªç±»ä¼¼çš„æ¦‚å¿µï¼š<font color="red">æ™ºèƒ½ç»„ä»¶å’Œæœ¨å¶ç»„ä»¶</font>ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šåœ¨æœ€æ–°çš„ Redux æ–‡æ¡£ä¸­ï¼Œå®ƒä»¬åˆ†åˆ«å«åšå®¹å™¨å‹ç»„ä»¶ Container component å’Œå±•ç¤ºå‹ç»„ä»¶ Presentational componentï¼‰æ™ºèƒ½ç»„ä»¶çš„èŒè´£å°±åƒç»ç†ä¸€æ ·ï¼Œä½†æ˜¯æ¯”èµ· Flux ä¸­çš„è§’è‰²ï¼ŒRedux å¯¹ç»ç†çš„èŒè´£æœ‰æ›´å¤šçš„å®šä¹‰ï¼š</p><p>æ™ºèƒ½ç»„ä»¶è´Ÿè´£æ‰€æœ‰çš„ actionã€‚å¦‚æœæ™ºèƒ½ç»„ä»¶é‡ŒåŒ…å«çš„ä¸€ä¸ªæœ¨å¶ç»„ä»¶éœ€è¦è§¦å‘ä¸€ä¸ª actionï¼Œæ™ºèƒ½ç»„ä»¶ä¼šé€šè¿‡ props ä¼ ç»™ä¸€ä¸ª function ç»™æœ¨å¶ç»„ä»¶ï¼Œè€Œæœ¨å¶ç»„ä»¶å¯ä»¥æŠŠè¿™ä¸ª function å½“åšä¸€ä¸ªå›è°ƒã€‚<br>æ™ºèƒ½ç»„ä»¶ä¸èƒ½å®šä¹‰ CSS æ ·å¼ã€‚<br>æ™ºèƒ½ç»„ä»¶å‡ ä¹ä¸ä¼šäº§ç”Ÿè‡ªå·±çš„ DOM èŠ‚ç‚¹ï¼Œä»–çš„å·¥ä½œæ˜¯ç»„ç»‡è‹¥å¹²çš„æœ¨å¶ç»„ä»¶ï¼Œç”±æœ¨å¶ç»„ä»¶æ¥ç”Ÿæˆæœ€ç»ˆçš„ DOM èŠ‚ç‚¹ã€‚<br>æœ¨å¶ç»„ä»¶ä¸ä¼šç›´æ¥ä¾èµ– action çš„è§¦å‘ï¼Œå› ä¸ºæ‰€æœ‰çš„ action éƒ½ä¼šå½“åš props ä¼ ä¸‹æ¥ã€‚è¿™æ„å‘³ç€æœ¨å¶ç»„ä»¶å¯ä»¥è¢«ä»»ä½•ä¸€ä¸ªé€»è¾‘ä¸åŒçš„ App æ‹¿å»ä½¿ç”¨ã€‚åŒæ—¶æœ¨å¶ç»„ä»¶ä¹Ÿéœ€è¦æœ‰ä¸€å®šçš„æ ·å¼æ¥è®©è‡ªå·±å˜å¾—å¥½çœ‹ä¸€äº›ï¼ˆå½“ç„¶ä½ å¯ä»¥è®©æœ¨å¶ç»„ä»¶æ¥å—æŸäº› props ä½œä¸ºè®¾ç½®æ ·å¼çš„å˜é‡ï¼‰ã€‚</p><h3 id="è§†å›¾å±‚ç»‘å®š"><a href="#è§†å›¾å±‚ç»‘å®š" class="headerlink" title="è§†å›¾å±‚ç»‘å®š"></a>è§†å›¾å±‚ç»‘å®š</h3><p><img src="https://camo.githubusercontent.com/95e3000085989bb3065f1d47990d5f48914c5313/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313230302f312a4431526356724d5632727036414839686b35785a38672e706e67" alt="redux-img-11"></p><p>è¦æŠŠ store ç»‘å®šåˆ°è§†å›¾ä¸Šï¼ŒRedux éœ€è¦ä¸€ç‚¹å¸®åŠ©ã€‚å¦‚æœä½ åœ¨ä½¿ç”¨ Reactï¼Œé‚£ä¹ˆä½ éœ€è¦ä½¿ç”¨ <font color="red">react-redux</font>ã€‚</p><p>è§†å›¾ç»‘å®šå·¥ä½œæœ‰ç‚¹åƒä¸ºç»„ä»¶æ ‘æœåŠ¡çš„ IT éƒ¨é—¨ã€‚IT éƒ¨é—¨ç¡®ä¿æ‰€æœ‰çš„ç»„ä»¶éƒ½æ­£ç¡®çš„ç»‘å®šåˆ° store ä¸Šï¼Œå¹¶å¤„ç†å„ç§æŠ€æœ¯ä¸Šçš„ç»†èŠ‚ï¼Œä»¥ç¡®ä¿ä½™ä¸‹å±‚çº§çš„ç»„ä»¶å¯¹ç»‘å®šç›¸å…³çš„æ“ä½œæ¯«æ— æ„ŸçŸ¥ã€‚</p><p>è§†å›¾å±‚ç»‘å®šå¼•å…¥äº†ä¸‰ä¸ªæ¦‚å¿µï¼š</p><blockquote><p><Provider> ç»„ä»¶ï¼š è¿™ä¸ªç»„ä»¶éœ€è¦åŒ…è£¹åœ¨æ•´ä¸ªç»„ä»¶æ ‘çš„æœ€å¤–å±‚ã€‚è¿™ä¸ªç»„ä»¶è®©æ ¹ç»„ä»¶çš„æ‰€æœ‰å­å­™ç»„ä»¶èƒ½å¤Ÿè½»æ¾çš„ä½¿ç”¨ connect() æ–¹æ³•ç»‘å®š storeã€‚<br>connect()ï¼šè¿™æ˜¯ react-redux æä¾›çš„ä¸€ä¸ªæ–¹æ³•ã€‚å¦‚æœä¸€ä¸ªç»„ä»¶æƒ³è¦å“åº”çŠ¶æ€çš„å˜åŒ–ï¼Œå°±æŠŠè‡ªå·±ä½œä¸ºå‚æ•°ä¼ ç»™ connect() çš„ç»“æœï¼ˆè¯‘è€…æ³¨ï¼šconnect() è¿”å›çš„ä¾ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰ï¼Œconnect() æ–¹æ³•ä¼šå¤„ç†ä¸ store ç»‘å®šçš„ç»†èŠ‚ï¼Œå¹¶é€šè¿‡ selector ç¡®å®šè¯¥ç»‘å®š store ä¸­å“ªä¸€éƒ¨åˆ†çš„æ•°æ®ã€‚<br>selectorï¼šè¿™æ˜¯ä½ è‡ªå·±ç¼–å†™çš„ä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å£°æ˜äº†ä½ çš„ç»„ä»¶éœ€è¦æ•´ä¸ª store ä¸­çš„å“ªä¸€éƒ¨åˆ†æ•°æ®ä½œä¸ºè‡ªå·±çš„ propsã€‚</p></blockquote><h3 id="æ ¹ç»„ä»¶"><a href="#æ ¹ç»„ä»¶" class="headerlink" title="æ ¹ç»„ä»¶"></a>æ ¹ç»„ä»¶</h3><p><img src="https://camo.githubusercontent.com/6a5e8da8d98687a377c8e7b29c7d14d32c81048e/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313230302f312a4a585065694e502d697436302d51594b622d703265512e706e67" alt="redux-img-12"><br>æ‰€æœ‰çš„ React åº”ç”¨éƒ½å­˜åœ¨ä¸€ä¸ªæ ¹ç»„ä»¶ï¼ˆroot componentï¼‰ã€‚ä»–å…¶å®å°±æ˜¯æ•´ä¸ªç»„ä»¶æ ‘æœ€å¤–å±‚çš„é‚£ä¸ªç»„ä»¶ï¼Œä½†æ˜¯åœ¨ Redux ä¸­ï¼Œæ ¹ç»„ä»¶è¿˜è¦æ‰¿æ‹…é¢å¤–çš„ä»»åŠ¡ã€‚</p><p>æ ¹ç»„ä»¶æ‰¿æ‹…çš„è§’è‰²æœ‰ç‚¹åƒä¼ä¸šä¸­çš„é«˜ç®¡ï¼Œä»–å°†æ•´ä¸ªå›¢é˜Ÿæ•´åˆåˆ°ä¸€èµ·æ¥å®ŒæˆæŸé¡¹ä»»åŠ¡ã€‚ä»–ä¼šåˆ›å»º storeï¼Œå¹¶å‘Šè¯‰ store ä½¿ç”¨å“ªäº› reducersï¼Œå¹¶æœ€ç»ˆå®Œæˆè§†å›¾å±‚çš„ç»‘å®šã€‚</p><p>å½“å®Œæˆæ•´ä¸ªåº”ç”¨çš„åˆå§‹åŒ–å·¥ä½œåï¼Œæ ¹ç»„ä»¶çš„å°±ä¸å†æ’æ‰‹æ•´ä¸ªåº”ç”¨çš„è¿è¡Œè¿‡ç¨‹äº†ã€‚æ¯ä¸€æ¬¡é‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰éƒ½æ²¡æœ‰æ ¹ç»„ä»¶ä»€ä¹ˆäº‹ï¼Œè¿™äº›æ´»å„¿éƒ½ç”±æ ¹ç»„ä»¶ä¸‹é¢çš„å­ç»„ä»¶å®Œæˆï¼Œå½“ç„¶ä¹Ÿå°‘ä¸äº†è§†å›¾å±‚ç»‘å®šçš„åŠŸåŠ³ã€‚</p><h2 id="Redux-å®Œæˆçš„è¿è¡Œæµç¨‹"><a href="#Redux-å®Œæˆçš„è¿è¡Œæµç¨‹" class="headerlink" title="Redux å®Œæˆçš„è¿è¡Œæµç¨‹"></a>Redux å®Œæˆçš„è¿è¡Œæµç¨‹</h2><p>è®©æˆ‘ä»¬çœ‹çœ‹ä¸Šè¿°å„ä¸ªéƒ¨åˆ†æ˜¯æ€æ ·ç»„åˆæˆä¸€ä¸ªå¯ä»¥è¿è¡Œçš„åº”ç”¨çš„ã€‚</p><h3 id="é…ç½®ç¯èŠ‚"><a href="#é…ç½®ç¯èŠ‚" class="headerlink" title="é…ç½®ç¯èŠ‚"></a>é…ç½®ç¯èŠ‚</h3><p>åº”ç”¨ä¸­çš„ä¸åŒéƒ¨åˆ†éœ€è¦åœ¨é…ç½®ç¯èŠ‚ä¸­æ•´åˆåˆ°ä¸€èµ·ã€‚</p><blockquote><p><strong>å‡†å¤‡å¥½ store</strong> æ ¹ç»„ä»¶ä¼šåˆ›å»º storeï¼Œå¹¶é€šè¿‡ createStore(reducer) æ–¹æ³•å‘Šè¯‰ store è¯¥ä½¿ç”¨å“ªä¸ªæ ¹ reducerã€‚ä¸æ­¤åŒæ—¶ï¼Œæ ¹ reducer ä¹Ÿé€šè¿‡ combineReducers() æ–¹æ³•ç»„å»ºäº†ä¸€åªå‘è‡ªå·±æ±‡æŠ¥çš„ reducer å›¢é˜Ÿã€‚</p></blockquote><p><img src="https://camo.githubusercontent.com/7e1ba50705e323adfa3d041418f619b856597396/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a385f665533312d6a4e516e513064702d77706c6d35772e706e67" alt="redux-img-13"></p><blockquote><p><strong>è®¾ç½® store å’Œç»„ä»¶ä¹‹é—´çš„é€šä¿¡</strong> æ ¹ç»„ä»¶å°†å®ƒæ‰€æœ‰çš„å­ç»„ä»¶åŒ…è£¹åœ¨ <Provider> ç»„ä»¶ä¸­ï¼Œå¹¶å»ºç«‹äº† Provider ä¸ store ä¹‹é—´çš„è”ç³»ã€‚</p></blockquote><p>Provider æœ¬è´¨ä¸Šåˆ›å»ºäº†ä¸€ä¸ªç”¨äºæ›´æ–°è§†å›¾ç»„ä»¶çš„ç½‘ç»œã€‚é‚£äº›æ™ºèƒ½ç»„ä»¶é€šè¿‡ connect() æ–¹æ³•è¿å…¥è¿™ä¸ªç½‘ç»œï¼Œä»¥æ­¤ç¡®ä¿ä»–ä»¬èƒ½å¤Ÿè·å–åˆ°çŠ¶æ€çš„æ›´æ–°ã€‚</p><p><img src="https://camo.githubusercontent.com/f83563c5057dc1aa1e7a25732d2abe198d587103/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a4e594d7574514c573854634567624f38564e657148412e706e67" alt="redux-img-14"></p><blockquote><p><strong>å‡†å¤‡å¥½ action callback</strong> ä¸ºäº†è®©æœ¨å¶ç»„ä»¶æ›´å¥½çš„å¤„ç† actionï¼Œæ™ºèƒ½ç»„ä»¶å¯ä»¥ç”¨ bindActionCreators() æ–¹æ³•æ¥åˆ›å»º action callbackã€‚è¿™æ ·åšä¹‹åï¼Œæ™ºèƒ½ç»„ä»¶å°±èƒ½ç»™æœ¨å¶ç»„ä»¶ä¼ å…¥ä¸€ä¸ªå›è°ƒï¼ˆcallbackï¼‰ã€‚å¯¹åº”çš„ action ä¼šåœ¨æœ¨å¶ç»„ä»¶è°ƒç”¨è¿™ä¸ªå›è°ƒæ—¶è¢«è‡ªåŠ¨ dispatchã€‚ï¼ˆè¯‘è€…æ³¨ï¼šä½¿ç”¨ bindActionCreators() ä½¿å¾—æœ¨å¶ç»„ä»¶æ— éœ€å…³å¿ƒ action çš„ type ç­‰ä¿¡æ¯ï¼Œåªç”¨è°ƒç”¨ props ä¸­çš„æŸä¸ªæ–¹æ³•ä¼ å…¥éœ€è¦çš„å‚æ•°ä½œä¸º action çš„ payload å³å¯ï¼‰</p></blockquote><p><img src="https://camo.githubusercontent.com/53630fd5a1d93636347dbfa6c73946992ba3a30d/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a61566f4433674764644b55793356437877796c7468512e706e67" alt="redux-img-15"></p><h3 id="æ•°æ®æµ"><a href="#æ•°æ®æµ" class="headerlink" title="æ•°æ®æµ"></a>æ•°æ®æµ</h3><p>ç°åœ¨æˆ‘ä»¬çš„åº”ç”¨å·²ç»é…ç½®å®Œæˆï¼Œç”¨æˆ·å¯ä»¥å¼€å§‹æ“ä½œäº†ã€‚è®©æˆ‘ä»¬è§¦å‘ä¸€ä¸ª actionï¼Œçœ‹çœ‹æ•°æ®æ˜¯æ€æ ·æµåŠ¨çš„ã€‚</p><p><img src="https://camo.githubusercontent.com/bae37967eb63e79ff7adaa575be4aa23e0e4c2ba/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a474e447337535935336c456870376d58385632356c772e706e67" alt="redux-img-16"></p><p>(1) è§†å›¾å‘å‡ºäº†ä¸€ä¸ª actionï¼Œaction creator å°†è¿™ä¸ª action æ ¼å¼åŒ–å¹¶è¿”å›<br><img src="https://camo.githubusercontent.com/8d6473306f2b880a6000f737e15f8715b754b995/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a7034456b57455f3875705a39375a304961704b4463512e706e67" alt="redux-img-17"></p><p>(2) è¿™ä¸ª action è¦ä¹ˆè¢«è‡ªåŠ¨ dispatchï¼ˆå¦‚æœæˆ‘ä»¬åœ¨é…ç½®é˜¶æ®µä½¿ç”¨äº† bindActionCreators()ï¼‰ï¼Œè¦ä¹ˆç”±è§†å›¾å±‚æ‰‹åŠ¨ dispatchã€‚<br><img src="https://camo.githubusercontent.com/0c6c16ed880307bdd765261663f129a9943b5077/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a7a6d467033626d447137623642766c6f38496e6561672e706e67" alt="redux-img-18"></p><p>(3) store æ¥å—åˆ°è¿™ä¸ª action åï¼Œå°†å½“å‰çš„çŠ¶æ€æ ‘å’Œè¿™ä¸ª action ä¼ ç»™æ ¹ reducerã€‚<br><img src="https://camo.githubusercontent.com/da19548a8e70a461d0acb9478b96eda6c9dab1a6/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a7a7273536f41417966347071544d48694136503857772e706e67" alt="redux-img-19"></p><p>(4) æ ¹ reducer å°†æ•´ä¸ªçŠ¶æ€æ ‘åˆ‡åˆ†æˆä¸€ä¸ªä¸ªå°å—ï¼Œç„¶åå°†æŸä¸€ä¸ªå°å—åˆ†å‘ç»™çŸ¥é“æ€ä¹ˆå¤„ç†è¿™éƒ¨åˆ†å†…å®¹çš„å­ reducerã€‚<br><img src="https://camo.githubusercontent.com/0c83b852e5b369952f7c309dc1e79ab9460517f4/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a2d535f64596536426f514267775352704637487269772e706e67" alt="redux-img-20"></p><p>(5) å­ reducer å°†ä¼ å…¥çš„ä¸€å°å—çŠ¶æ€æ ‘è¿›è¡Œæ‹·è´ï¼Œç„¶ååœ¨å‰¯æœ¬ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œå¹¶æœ€ç»ˆå°†ä¿®æ”¹åçš„å‰¯æœ¬è¿”å›æ ¹ reducerã€‚<br><img src="https://camo.githubusercontent.com/5475fd281a7dfd8f542afedb8d5a61f2790fff99/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a5f522d72474e664b7232587532466c584e5a4e504a672e706e67" alt="redux-img-21"></p><p>(6) å½“æ‰€æœ‰çš„å­ reducer è¿”å›ä»–ä»¬ä¿®æ”¹çš„å‰¯æœ¬ä¹‹åï¼Œæ ¹ reducer å°†è¿™äº›éƒ¨åˆ†å†æ¬¡ç»„åˆèµ·æ¥å½¢æˆä¸€é¢—æ–°çš„çŠ¶æ€æ ‘ã€‚ç„¶åæ ¹ reducer å°†è¿™ä¸ªæ–°çš„çŠ¶æ€æ ‘äº¤è¿˜ç»™ storeï¼Œstore å†æŠŠè‡ªå·±çš„çŠ¶æ€ç½®ä¸ºè¿™ä¸ªæœ€æ–°çš„çŠ¶æ€æ ‘ã€‚<br><img src="https://camo.githubusercontent.com/113b778ffbfef33d3f0e47cd339085c897dc9cb3/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a62554d656b4938516c45664678534243755675496b772e706e67" alt="redux-img-22"></p><p>(7) store å‘Šè¯‰è§†å›¾å±‚ç»‘å®šï¼šã€ŒçŠ¶æ€æ›´æ–°å•¦ã€<br><img src="https://camo.githubusercontent.com/5cc81069fe6420579f965f76c2d8090dbd41b49b/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a7836764276556c464a6b744a71747935366a723051512e706e67" alt="redux-img-23"></p><p>(8) è§†å›¾å±‚ç»‘å®šè®© store æŠŠæ›´æ–°çš„çŠ¶æ€ä¼ è¿‡æ¥<br><img src="https://camo.githubusercontent.com/2aba7ead74724ca04cd042dea40e94841a86de11/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a714761747a6e563451756a75784765343959665835412e706e67" alt="redux-img-24"></p><p>(9) è§†å›¾å±‚ç»‘å®šè§¦å‘äº†ä¸€ä¸ªé‡æ–°æ¸²æŸ“çš„æ“ä½œï¼ˆre-renderï¼‰<br><img src="https://camo.githubusercontent.com/2487145c781995bd8f204a861f211727c5aa908f/68747470733a2f2f64323632696c623531686c7478302e636c6f756466726f6e742e6e65742f6d61782f313630302f312a4a65326d6f77386d6a594c6e6758726547476c4945672e706e67" alt="redux-img-25"></p><p>è¿™å°±æ˜¯æˆ‘æ‰€ç†è§£çš„ Reduxï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p><p>æ›´å¤šèµ„æº<br><a href="https://redux.js.org/" target="_blank" rel="noopener">Redux å®˜æ–¹æ–‡æ¡£</a><br><a href="http://cn.redux.js.org/" target="_blank" rel="noopener">Redux å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a><br><a href="https://medium.com/@dan_abramov/the-evolution-of-flux-frameworks-6c16ad26bb31" target="_blank" rel="noopener">The Evolution of Flux Frameworks</a><br><a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0" target="_blank" rel="noopener">Smart and Dumb Components</a><br><a href="https://stackoverflow.com/questions/32461229/why-use-redux-over-facebook-flux/32920459#32920459" target="_blank" rel="noopener">The upsides of using Redux</a><br><a href="https://stackoverflow.com/questions/32021763/what-could-be-the-downsides-of-using-redux-instead-of-flux/32916602#32916602" target="_blank" rel="noopener">The downsides of using Redux</a><br><a href="https://www.zhihu.com/question/38591713/answer/77634014" target="_blank" rel="noopener">å¦‚ä½•è¯„ä»·æ•°æ®æµç®¡ç†æ¶æ„ Redux?</a></p><p><a href="https://github.com/jasonslyvia/a-cartoon-intro-to-redux-cn" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Redux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-nativeå­¦ä¹ èµ„æºå¤§æ±‡èš</title>
      <link href="/2018/03/04/react-native/react-native%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E5%A4%A7%E6%B1%87%E8%81%9A/"/>
      <url>/2018/03/04/react-native/react-native%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E5%A4%A7%E6%B1%87%E8%81%9A/</url>
      
        <content type="html"><![CDATA[<h1 id="React-Native-å­¦ä¹ èµ„æº"><a href="#React-Native-å­¦ä¹ èµ„æº" class="headerlink" title="React Native å­¦ä¹ èµ„æº"></a>React Native å­¦ä¹ èµ„æº</h1><blockquote><p>React Nativeç€åŠ›äºæé«˜å¤šå¹³å°å¼€å‘çš„å¼€å‘æ•ˆç‡ â€”â€” ä»…éœ€å­¦ä¹ ä¸€æ¬¡ï¼Œç¼–å†™ä»»ä½•å¹³å°ã€‚(<font color="blue">Learn once, write anywhere</font>)ã€‚</p></blockquote><hr><p>æœ¬æ–‡æ±‡é›†äº†React-Nativeå„ç±»å­¦ä¹ èµ„æºï¼Œæ–¹ä¾¿å¤§å®¶å­¦ä¹ ï¼ŒåŒæ—¶è¿˜æœ‰ [Awesome React Nativeç³»åˆ—]ï¼Œè¯·æ”¶ä¸‹ï¼(<br>    <a href="https://github.com/jondot/awesome-react-native)ã€‚" target="_blank" rel="noopener">https://github.com/jondot/awesome-react-native)ã€‚</a></p><h2 id="æ•™ç¨‹"><a href="#æ•™ç¨‹" class="headerlink" title="æ•™ç¨‹"></a>æ•™ç¨‹</h2><p>æ„å»º Facebook F8 2016 App / React Native å¼€å‘æŒ‡å— <a href="http://f8-app.liaohuqiu.net/" target="_blank" rel="noopener">http://f8-app.liaohuqiu.net/</a></p><p>React-Nativeå…¥é—¨æŒ‡å— <a href="https://github.com/vczero/react-native-lesson" target="_blank" rel="noopener">https://github.com/vczero/react-native-lesson</a></p><p>30å¤©å­¦ä¹ React Nativeæ•™ç¨‹ <a href="https://github.com/fangwei716/30-days-of-react-native" target="_blank" rel="noopener">https://github.com/fangwei716/30-days-of-react-native</a></p><p>React-Nativeè§†é¢‘æ•™ç¨‹(éƒ¨åˆ†å…è´¹) <a href="https://egghead.io/technologies/react" target="_blank" rel="noopener">https://egghead.io/technologies/react</a></p><p>React Native å¼€å‘åŸ¹è®­è§†é¢‘æ•™ç¨‹ï¼ˆä¸­æ–‡|å…è´¹ï¼‰ <a href="https://www.gitbook.com/book/unbug/react-native-training/details" target="_blank" rel="noopener">https://www.gitbook.com/book/unbug/react-native-training/details</a></p><p>react-native å®˜æ–¹apiæ–‡æ¡£ <a href="http://facebook.github.io/react-native/docs/getting-started.html" target="_blank" rel="noopener">http://facebook.github.io/react-native/docs/getting-started.html</a></p><p>react-nativeä¸­æ–‡æ–‡æ¡£(æå®¢å­¦é™¢) <a href="http://wiki.jikexueyuan.com/project/react-native/" target="_blank" rel="noopener">http://wiki.jikexueyuan.com/project/react-native/</a></p><p>react-nativeä¸­æ–‡æ–‡æ¡£(react nativeä¸­æ–‡ç½‘ï¼Œäººå·¥ç¿»è¯‘ï¼Œå®˜ç½‘å®Œå…¨åŒæ­¥) <a href="http://react-native.cn/docs/getting-started.html" target="_blank" rel="noopener">http://react-native.cn/docs/getting-started.html</a></p><p>react-nativeç¬¬ä¸€è¯¾ <a href="http://html-js.com/article/2783" target="_blank" rel="noopener">http://html-js.com/article/2783</a></p><p>æ·±å…¥æµ…å‡º React Nativeï¼šä½¿ç”¨ JavaScript æ„å»ºåŸç”Ÿåº”ç”¨ <a href="http://zhuanlan.zhihu.com/FrontendMagazine/19996445" target="_blank" rel="noopener">http://zhuanlan.zhihu.com/FrontendMagazine/19996445</a></p><p>React Nativeé€šä¿¡æœºåˆ¶è¯¦è§£ <a href="http://blog.cnbang.net/tech/2698/" target="_blank" rel="noopener">http://blog.cnbang.net/tech/2698/</a></p><p>React Nativeå¸ƒå±€ç¯‡ <a href="https://segmentfault.com/a/1190000002658374" target="_blank" rel="noopener">https://segmentfault.com/a/1190000002658374</a></p><p>React Native åŸºç¡€ç»ƒä¹ æŒ‡åŒ—ï¼ˆä¸€ï¼‰ <a href="https://segmentfault.com/a/1190000002645929" target="_blank" rel="noopener">https://segmentfault.com/a/1190000002645929</a><br><a id="more"></a><br>React Native åŸºç¡€ç»ƒä¹ æŒ‡åŒ—ï¼ˆäºŒï¼‰ <a href="https://segmentfault.com/a/1190000002647733" target="_blank" rel="noopener">https://segmentfault.com/a/1190000002647733</a></p><p>Diary of Building an iOS App with React Native <a href="http://herman.asia/building-a-flashcard-app-with-react-native" target="_blank" rel="noopener">http://herman.asia/building-a-flashcard-app-with-react-native</a></p><p>React Native For Beginners â€“ The Next Big Thing? <a href="https://devdactic.com/react-native-for-beginners/" target="_blank" rel="noopener">https://devdactic.com/react-native-for-beginners/</a></p><p>How To Implement A Tab Bar With React Native <a href="https://devdactic.com/react-native-tab-bar/" target="_blank" rel="noopener">https://devdactic.com/react-native-tab-bar/</a></p><p>tcomb-form-nativeä½¿ç”¨è§†é¢‘æ•™ç¨‹(éœ€ç¿»å¢™) <a href="https://react.rocks/example/tcomb-form-native" target="_blank" rel="noopener">https://react.rocks/example/tcomb-form-native</a></p><p>React Nativeåˆ†äº«è®°å½• <a href="https://segmentfault.com/a/1190000002678782" target="_blank" rel="noopener">https://segmentfault.com/a/1190000002678782</a></p><p>React Nativeæ„å»ºæœ¬åœ°è§†å›¾ç»„ä»¶ <a href="https://www.dobest.me/article/11" target="_blank" rel="noopener">https://www.dobest.me/article/11</a></p><p>react-native-android-lession(å®‰å“ç³»åˆ—æ•™ç¨‹) <a href="https://github.com/yipengmu/react-native-android-lession" target="_blank" rel="noopener">https://github.com/yipengmu/react-native-android-lession</a></p><p>React Nativeæ¨¡å—æ¡¥æ¥è¯¦è§£ <a href="https://www.dobest.me/article/14" target="_blank" rel="noopener">https://www.dobest.me/article/14</a></p><p>React Native: é…ç½®å’Œèµ·æ­¥ <a href="http://www.liaohuqiu.net/cn/posts/react-native-1/" target="_blank" rel="noopener">http://www.liaohuqiu.net/cn/posts/react-native-1/</a></p><p>React Native: Android çš„æ‰“åŒ… <a href="http://www.liaohuqiu.net/cn/posts/react-native-android-package/" target="_blank" rel="noopener">http://www.liaohuqiu.net/cn/posts/react-native-android-package/</a></p><p>ReactNativeä¹‹åŸç”Ÿæ¨¡å—å¼€å‘å¹¶å‘å¸ƒâ€”â€”iOSç¯‡ <a href="http://www.liuchungui.com/blog/2016/05/02/reactnativezhi-yuan-sheng-mo-kuai-kai-fa-bing-fa-bu-iospian/" target="_blank" rel="noopener">http://www.liuchungui.com/blog/2016/05/02/reactnativezhi-yuan-sheng-mo-kuai-kai-fa-bing-fa-bu-iospian/</a></p><p>ReactNativeä¹‹åŸç”Ÿæ¨¡å—å¼€å‘å¹¶å‘å¸ƒâ€”â€”androidç¯‡ <a href="http://www.liuchungui.com/blog/2016/05/08/reactnativezhi-yuan-sheng-mo-kuai-kai-fa-bing-fa-bu-androidpian/" target="_blank" rel="noopener">http://www.liuchungui.com/blog/2016/05/08/reactnativezhi-yuan-sheng-mo-kuai-kai-fa-bing-fa-bu-androidpian/</a></p><p>react-nativeçš„ç¬¬ä¸€è¯¾ <a href="https://github.com/coderyi/blog/blob/master/articles/2016/0122_react-native_first_lesson.md" target="_blank" rel="noopener">https://github.com/coderyi/blog/blob/master/articles/2016/0122_react-native_first_lesson.md</a></p><p>React-Nativeä¸“é¢˜ç³»åˆ—æ–‡ç«  <a href="http://www.lcode.org/react-native/" target="_blank" rel="noopener">http://www.lcode.org/react-native/</a></p><p>react native redux FeInn ä»0åˆ°1è®©ä½ å­¦ä¼šæ­å»ºä¸€ä¸ªAPP <a href="https://github.com/febobo/react-native-redux-FeInn" target="_blank" rel="noopener">https://github.com/febobo/react-native-redux-FeInn</a></p><h2 id="react-js"><a href="#react-js" class="headerlink" title="react.js"></a>react.js</h2><p>react.jsä¸­æ–‡æ–‡æ¡£ <a href="http://reactjs.cn/" target="_blank" rel="noopener">http://reactjs.cn/</a></p><p>react.jså…¥é—¨æ•™ç¨‹(gitbook) <a href="https://hulufei.gitbooks.io/react-tutorial/content/introduction.html" target="_blank" rel="noopener">https://hulufei.gitbooks.io/react-tutorial/content/introduction.html</a></p><p>react.jså¿«é€Ÿå…¥é—¨æ•™ç¨‹ - é˜®ä¸€å³° <a href="http://www.ruanyifeng.com/blog/2015/03/react.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2015/03/react.html</a></p><p>react.jsè§†é¢‘æ•™ç¨‹ <a href="http://react-china.org/t/reactjs/584" target="_blank" rel="noopener">http://react-china.org/t/reactjs/584</a></p><p>React Nativeä¹‹Reacté€Ÿå­¦æ•™ç¨‹<a href="https://github.com/crazycodeboy/RNStudyNotes/tree/master/React%20Native%E4%B9%8BReact%E9%80%9F%E5%AD%A6%E6%95%99%E7%A8%8B" target="_blank" rel="noopener">https://github.com/crazycodeboy/RNStudyNotes/tree/master/React%20Native%E4%B9%8BReact%E9%80%9F%E5%AD%A6%E6%95%99%E7%A8%8B</a></p><h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2><p>æ·±å…¥æµ…å‡ºES6ï¼ˆä¸€ï¼‰ï¼šES6æ˜¯ä»€ä¹ˆ <a href="http://www.infoq.com/cn/articles/es6-in-depth-an-introduction" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-an-introduction</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆäºŒï¼‰ï¼šè¿­ä»£å™¨å’Œfor-ofå¾ªç¯ <a href="http://www.infoq.com/cn/articles/es6-in-depth-iterators-and-the-for-of-loop" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-iterators-and-the-for-of-loop</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆä¸‰ï¼‰ï¼šç”Ÿæˆå™¨ Generators <a href="http://www.infoq.com/cn/articles/es6-in-depth-generators" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-generators</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆå››ï¼‰ï¼šæ¨¡æ¿å­—ç¬¦ä¸² <a href="http://www.infoq.com/cn/articles/es6-in-depth-template-string" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-template-string</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆäº”ï¼‰ï¼šä¸å®šå‚æ•°å’Œé»˜è®¤å‚æ•° <a href="http://www.infoq.com/cn/articles/es6-in-depth-rest-parameters-and-defaults" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-rest-parameters-and-defaults</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆå…­ï¼‰ï¼šè§£æ„Destructuring <a href="http://www.infoq.com/cn/articles/es6-in-depth-destructuring" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-destructuring</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆä¸ƒï¼‰ï¼šç®­å¤´å‡½æ•°Arrow Functions <a href="http://www.infoq.com/cn/articles/es6-in-depth-arrow-functions" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-arrow-functions</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆå…«ï¼‰ï¼šSymbols <a href="http://www.infoq.com/cn/articles/es6-in-depth-symbols" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-symbols</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆä¹ï¼‰ï¼šå­¦ä¹ Babelå’ŒBroccoliï¼Œé©¬ä¸Šå°±ç”¨ES6 <a href="http://www.infoq.com/cn/articles/es6-in-depth-babel-and-broccoli" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-babel-and-broccoli</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆåï¼‰ï¼šé›†åˆ <a href="http://www.infoq.com/cn/articles/es6-in-depth-collections" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-collections</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆåä¸€ï¼‰ï¼šç”Ÿæˆå™¨Generatorsï¼Œç»­ç¯‡ <a href="http://www.infoq.com/cn/articles/es6-in-depth-generators-continued" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-generators-continued</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆåäºŒï¼‰ï¼šä»£ç†Proxies <a href="http://www.infoq.com/cn/articles/es6-in-depth-proxies-and-reflect/" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-proxies-and-reflect/</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆåä¸‰ï¼‰ï¼šç±»Class <a href="http://www.infoq.com/cn/articles/es6-in-depth-classes" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-classes</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆåå››ï¼‰ï¼šletå’Œconst <a href="http://www.infoq.com/cn/articles/es6-in-depth-let-and-const" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-let-and-const</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆåäº”ï¼‰ï¼šå­ç±»Subclassing <a href="http://www.infoq.com/cn/articles/es6-in-depth-subclassing" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-subclassing</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆåå…­ï¼‰ï¼šæ¨¡å—Modules <a href="http://www.infoq.com/cn/articles/es6-in-depth-modules" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-modules</a></p><p>æ·±å…¥æµ…å‡ºES6ï¼ˆåä¸ƒï¼‰ï¼šå±•æœ›æœªæ¥ <a href="http://www.infoq.com/cn/articles/es6-in-depth-the-future" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/es6-in-depth-the-future</a></p><h2 id="ç³»åˆ—æ•™ç¨‹"><a href="#ç³»åˆ—æ•™ç¨‹" class="headerlink" title="ç³»åˆ—æ•™ç¨‹"></a>ç³»åˆ—æ•™ç¨‹</h2><p>æ·±å…¥æµ…å‡ºReactï¼ˆä¸€ï¼‰ï¼šReactçš„è®¾è®¡å“²å­¦ - ç®€å•ä¹‹ç¾ <a href="http://www.infoq.com/cn/articles/react-art-of-simplity" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/react-art-of-simplity</a></p><p>æ·±å…¥æµ…å‡ºReactï¼ˆäºŒï¼‰ï¼šReactå¼€å‘ç¥å™¨Webpack <a href="http://www.infoq.com/cn/articles/react-and-webpack" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/react-and-webpack</a></p><p>æ·±å…¥æµ…å‡ºReactï¼ˆä¸‰ï¼‰ï¼šç†è§£JSXå’Œç»„ä»¶ <a href="http://www.infoq.com/cn/articles/react-jsx-and-component" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/react-jsx-and-component</a></p><p>æ·±å…¥æµ…å‡ºReactï¼ˆå››ï¼‰ï¼šè™šæ‹ŸDOM Diffç®—æ³•è§£æ <a href="http://www.infoq.com/cn/articles/react-dom-diff" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/react-dom-diff</a></p><p>æ·±å…¥æµ…å‡ºReactï¼ˆäº”ï¼‰ï¼šä½¿ç”¨Fluxæ­å»ºReactåº”ç”¨ç¨‹åºæ¶æ„ <a href="http://www.infoq.com/cn/articles/react-flux" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/react-flux</a></p><p>react-webpack-cookbookä¸­æ–‡ç‰ˆ <a href="http://fakefish.github.io/react-webpack-cookbook/" target="_blank" rel="noopener">http://fakefish.github.io/react-webpack-cookbook/</a></p><p>Flex å¸ƒå±€è¯­æ³•æ•™ç¨‹ <a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html</a></p><p>React åˆæ¢ <a href="http://www.alloyteam.com/2015/04/react-explore/" target="_blank" rel="noopener">http://www.alloyteam.com/2015/04/react-explore/</a></p><p>Reactè™šæ‹ŸDOMæµ…æ <a href="http://www.alloyteam.com/2015/10/react-virtual-analysis-of-the-dom/" target="_blank" rel="noopener">http://www.alloyteam.com/2015/10/react-virtual-analysis-of-the-dom/</a></p><p>reactç»„ä»¶é—´é€šä¿¡ <a href="http://www.alloyteam.com/2015/07/react-zu-jian-jian-tong-xin/" target="_blank" rel="noopener">http://www.alloyteam.com/2015/07/react-zu-jian-jian-tong-xin/</a></p><p>React æ•°æ®æµç®¡ç†æ¶æ„ä¹‹ Redux ä»‹ç» <a href="http://www.alloyteam.com/2015/09/react-redux/" target="_blank" rel="noopener">http://www.alloyteam.com/2015/09/react-redux/</a></p><p>ReactæœåŠ¡å™¨ç«¯æ¸²æŸ“å®è·µå°ç»“ <a href="http://www.alloyteam.com/2015/10/8783/" target="_blank" rel="noopener">http://www.alloyteam.com/2015/10/8783/</a></p><p>React Native Android è¸©å‘ä¹‹æ—… <a href="http://www.alloyteam.com/2015/10/react-native-android-steps-on-tour/" target="_blank" rel="noopener">http://www.alloyteam.com/2015/10/react-native-android-steps-on-tour/</a></p><p>React Native ä¹‹ JSBridge <a href="http://www.alloyteam.com/2015/05/react-native-zhi-jsbridge/" target="_blank" rel="noopener">http://www.alloyteam.com/2015/05/react-native-zhi-jsbridge/</a></p><p>React Native ç ”ç©¶ä¸å®è·µæ•™ç¨‹ <a href="https://github.com/crazycodeboy/RNStudyNotes" target="_blank" rel="noopener">https://github.com/crazycodeboy/RNStudyNotes</a></p><h2 id="React-Nativeæ¢ç´¢ç³»åˆ—æ•™ç¨‹"><a href="#React-Nativeæ¢ç´¢ç³»åˆ—æ•™ç¨‹" class="headerlink" title="React Nativeæ¢ç´¢ç³»åˆ—æ•™ç¨‹"></a>React Nativeæ¢ç´¢ç³»åˆ—æ•™ç¨‹</h2><p>React Nativeæ¢ç´¢ï¼ˆä¸€ï¼‰ï¼šèƒŒæ™¯ã€è§„åˆ’å’Œé£é™© <a href="http://www.infoq.com/cn/articles/react-native-overview" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/react-native-overview</a></p><p>React Nativeæ¢ç´¢ï¼ˆäºŒï¼‰ï¼šå¸ƒå±€ç¯‡ <a href="http://www.infoq.com/cn/articles/react-native-layout" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/react-native-layout</a></p><p>React Nativeæ¢ç´¢ï¼ˆä¸‰ï¼‰ï¼šä¸ react-web çš„èåˆ <a href="http://www.infoq.com/cn/articles/react-native-web" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/react-native-web</a></p><h2 id="å¼€æºAPP"><a href="#å¼€æºAPP" class="headerlink" title="å¼€æºAPP"></a>å¼€æºAPP</h2><p>ç ”ç©¶æºç ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­¦ä¹ æ–¹å¼</p><p>å®˜æ–¹æ¼”ç¤ºApp <a href="https://github.com/facebook/react-native/tree/master/Examples" target="_blank" rel="noopener">https://github.com/facebook/react-native/tree/master/Examples</a></p><p>Facebook F8 App <a href="https://github.com/fbsamples/f8app" target="_blank" rel="noopener">https://github.com/fbsamples/f8app</a></p><p>GitHub Popular(ä¸€ä¸ªç”¨æ¥æŸ¥çœ‹GitHubæœ€å—æ¬¢è¿ä¸æœ€çƒ­é¡¹ç›®çš„App)å·²ä¸Šæ¶<a href="https://github.com/crazycodeboy/GitHubPopular" target="_blank" rel="noopener">https://github.com/crazycodeboy/GitHubPopular</a></p><p>å¥‡èˆå‘¨åˆŠ iOS ç‰ˆï¼ˆä¸Šæ¶åº”ç”¨ï¼‰ <a href="https://github.com/fakefish/Weekly75" target="_blank" rel="noopener">https://github.com/fakefish/Weekly75</a></p><p>react-native-dribbble-app <a href="https://github.com/catalinmiron/react-native-dribbble-app" target="_blank" rel="noopener">https://github.com/catalinmiron/react-native-dribbble-app</a></p><p>Gank.ioå®¢æˆ·ç«¯ <a href="https://github.com/Bob1993/React-Native-Gank" target="_blank" rel="noopener">https://github.com/Bob1993/React-Native-Gank</a></p><p>Mdccå®¢æˆ·ç«¯(ä¼˜è´¨) <a href="https://github.com/Bob1993/mdcc-client" target="_blank" rel="noopener">https://github.com/Bob1993/mdcc-client</a></p><p>Leanote for iOS(äº‘ç¬”è®°) <a href="https://github.com/leanote/leanote-ios-rn" target="_blank" rel="noopener">https://github.com/leanote/leanote-ios-rn</a></p><p>ReactNativeRubyChina <a href="https://github.com/henter/ReactNativeRubyChina" target="_blank" rel="noopener">https://github.com/henter/ReactNativeRubyChina</a></p><p>HackerNews-React-Native <a href="https://github.com/iSimar/HackerNews-React-Native" target="_blank" rel="noopener">https://github.com/iSimar/HackerNews-React-Native</a></p><p>React-Nativeæ–°é—»å®¢æˆ·ç«¯ <a href="https://github.com/tabalt/ReactNativeNews" target="_blank" rel="noopener">https://github.com/tabalt/ReactNativeNews</a></p><p>newswatch(æ–°é—»å®¢æˆ·ç«¯) <a href="https://github.com/bradoyler/newswatch-react-native" target="_blank" rel="noopener">https://github.com/bradoyler/newswatch-react-native</a></p><p>buyscreen(è´­ä¹°é¡µé¢) <a href="https://github.com/appintheair/react-native-buyscreen" target="_blank" rel="noopener">https://github.com/appintheair/react-native-buyscreen</a></p><p>V2EXå®¢æˆ·ç«¯ <a href="https://github.com/samuel1112/v2er" target="_blank" rel="noopener">https://github.com/samuel1112/v2er</a></p><p>react-native-todo <a href="https://github.com/joemaddalone/react-native-todo" target="_blank" rel="noopener">https://github.com/joemaddalone/react-native-todo</a></p><p>react-native-beer <a href="https://github.com/muratsu/react-native-beer" target="_blank" rel="noopener">https://github.com/muratsu/react-native-beer</a></p><p>react-native-stars <a href="https://github.com/86/react-native-stars" target="_blank" rel="noopener">https://github.com/86/react-native-stars</a></p><p>æ¨¡ä»¿å¤©çŒ«é¦–é¡µçš„app <a href="https://github.com/hugohua/react-native-demo" target="_blank" rel="noopener">https://github.com/hugohua/react-native-demo</a></p><p>ReactNativeChess <a href="https://github.com/csarsam/ReactNativeChess" target="_blank" rel="noopener">https://github.com/csarsam/ReactNativeChess</a></p><p>react native ç¼–å†™çš„éŸ³ä¹è½¯ä»¶ <a href="https://github.com/Johnqing/miumiu" target="_blank" rel="noopener">https://github.com/Johnqing/miumiu</a></p><p>react-native-pokedex <a href="https://github.com/ababol/react-native-pokedex" target="_blank" rel="noopener">https://github.com/ababol/react-native-pokedex</a></p><p>CNode-React-Native <a href="https://github.com/SFantasy/CNode-React-Native" target="_blank" rel="noopener">https://github.com/SFantasy/CNode-React-Native</a></p><p>8tracksç”µå°å®¢æˆ·ç«¯ <a href="https://github.com/voronianski/EightTracksReactNative" target="_blank" rel="noopener">https://github.com/voronianski/EightTracksReactNative</a></p><p>React-Nativeå®ç°çš„è®¡ç®—å™¨ <a href="https://github.com/yoxisem544/Calculator-using-React-Native" target="_blank" rel="noopener">https://github.com/yoxisem544/Calculator-using-React-Native</a></p><p>æˆ¿äº§æœç´¢app <a href="https://github.com/jawee/react-native-PropertyFinder" target="_blank" rel="noopener">https://github.com/jawee/react-native-PropertyFinder</a></p><p>çŸ¥ä¹ä¸“æ app <a href="https://github.com/LeezQ/react-native-zhihu-app" target="_blank" rel="noopener">https://github.com/LeezQ/react-native-zhihu-app</a></p><p>ForeignExchangeApp <a href="https://github.com/peralmq/ForeignExchangeApp" target="_blank" rel="noopener">https://github.com/peralmq/ForeignExchangeApp</a></p><p>Segmentfault å®¢æˆ·ç«¯ <a href="https://github.com/fakefish/sf-react-native" target="_blank" rel="noopener">https://github.com/fakefish/sf-react-native</a></p><p>ç³—äº‹ç™¾ç§‘app <a href="https://github.com/stormhouse/QiuShiReactNative" target="_blank" rel="noopener">https://github.com/stormhouse/QiuShiReactNative</a></p><p>å­¢å­ç¤¾åŒºapp <a href="https://github.com/Hi-Rube/baoz-ReactNative" target="_blank" rel="noopener">https://github.com/Hi-Rube/baoz-ReactNative</a></p><p>æ·±JS app <a href="https://github.com/fraserxu/shenjs" target="_blank" rel="noopener">https://github.com/fraserxu/shenjs</a></p><p>Den - æˆ¿å±‹é”€å”®app* <a href="https://github.com/asamiller/den" target="_blank" rel="noopener">https://github.com/asamiller/den</a></p><p>Noder-cnodejså®¢æˆ·ç«¯ <a href="https://github.com/soliury/noder-react-native" target="_blank" rel="noopener">https://github.com/soliury/noder-react-native</a></p><p>çŸ¥ä¹æ—¥æŠ¥Androidç‰ˆ <a href="https://github.com/race604/ZhiHuDaily-React-Native" target="_blank" rel="noopener">https://github.com/race604/ZhiHuDaily-React-Native</a></p><p>ziliun-react-native <a href="https://github.com/sonnylazuardi/ziliun-react-native" target="_blank" rel="noopener">https://github.com/sonnylazuardi/ziliun-react-native</a></p><p>react-native-weather-app <a href="https://github.com/shevawen/react-native-weather-app" target="_blank" rel="noopener">https://github.com/shevawen/react-native-weather-app</a></p><p>React Native Sample App(Navigation,Flux) <a href="https://github.com/taskrabbit/ReactNativeSampleApp" target="_blank" rel="noopener">https://github.com/taskrabbit/ReactNativeSampleApp</a></p><p>TesterHomeç¤¾åŒºapp <a href="https://github.com/qddegtya/A-ReactNative-TesterHome" target="_blank" rel="noopener">https://github.com/qddegtya/A-ReactNative-TesterHome</a></p><p>Finance - è‚¡ç¥¨æŠ¥ä»·app <a href="https://github.com/7kfpun/FinanceReactNative" target="_blank" rel="noopener">https://github.com/7kfpun/FinanceReactNative</a></p><p>shopping - è´­ç‰©app <a href="https://github.com/bigsui/shopping-react-native" target="_blank" rel="noopener">https://github.com/bigsui/shopping-react-native</a></p><p>zhuiyuan - è¿½æºcms app <a href="https://github.com/kazaff/ZhuiYuanDemo" target="_blank" rel="noopener">https://github.com/kazaff/ZhuiYuanDemo</a></p><p>uestc-bbs-react-native - UESTCæ¸…æ°´æ²³ç•”RNå®¢æˆ·ç«¯(with Redux) <a href="https://github.com/just4fun/uestc-bbs-react-native" target="_blank" rel="noopener">https://github.com/just4fun/uestc-bbs-react-native</a></p><p>react-native-nw-react-calculator(iOS/Androidã€Webã€æ¡Œé¢å¤šç«¯) <a href="https://github.com/benoitvallon/react-native-nw-react-calculator" target="_blank" rel="noopener">https://github.com/benoitvallon/react-native-nw-react-calculator</a></p><p>react-native-nba-app <a href="https://github.com/wwayne/react-native-nba-app" target="_blank" rel="noopener">https://github.com/wwayne/react-native-nba-app</a></p><p>å¼€æºä¸­å›½çš„Git@OSCå®¢æˆ·ç«¯ <a href="http://git.oschina.net/rplees/react-native-gitosc" target="_blank" rel="noopener">http://git.oschina.net/rplees/react-native-gitosc</a></p><p>rn_bycloud å¸®ç€›å¾‹å¸ˆç«¯app <a href="https://github.com/liuchungui/rn_bycloud" target="_blank" rel="noopener">https://github.com/liuchungui/rn_bycloud</a></p><p>ReactNativeRollingExamples <a href="https://github.com/joggerplus/ReactNativeRollingExamples" target="_blank" rel="noopener">https://github.com/joggerplus/ReactNativeRollingExamples</a></p><p>Reading App Write In React-Nativeï¼ˆStudying and Programing <a href="https://github.com/attentiveness/reading" target="_blank" rel="noopener">https://github.com/attentiveness/reading</a></p><p>æ•°ç‹¬ - é‡æ‹¾çº¯ç²¹æ•°ç‹¬çš„ä¹è¶£ <a href="https://github.com/nihgwu/react-native-sudoku" target="_blank" rel="noopener">https://github.com/nihgwu/react-native-sudoku</a></p><p>Shop-React-Native <a href="https://github.com/EleTeam/Shop-React-Native" target="_blank" rel="noopener">https://github.com/EleTeam/Shop-React-Native</a></p><p>æ˜é‡‘å®¢æˆ·ç«¯ <a href="https://github.com/wangdicoder/JueJinClient" target="_blank" rel="noopener">https://github.com/wangdicoder/JueJinClient</a></p><p>cnblogs å®¢æˆ·ç«¯ <a href="https://github.com/togayther/react-native-cnblogs" target="_blank" rel="noopener">https://github.com/togayther/react-native-cnblogs</a></p><h2 id="å›¾ä¹¦"><a href="#å›¾ä¹¦" class="headerlink" title="å›¾ä¹¦"></a>å›¾ä¹¦</h2><p>ã€ŠReact Nativeå…¥é—¨ä¸å®æˆ˜ã€‹ <a href="http://item.jd.com/11844102.html" target="_blank" rel="noopener">http://item.jd.com/11844102.html</a></p><p>ã€ŠReact Nativeå¼€å‘æŒ‡å—ã€‹ <a href="http://www.ituring.com.cn/book/1846" target="_blank" rel="noopener">http://www.ituring.com.cn/book/1846</a></p><p>ã€ŠReact Nativeè·¨å¹³å°ç§»åŠ¨åº”ç”¨å¼€å‘ã€‹ <a href="http://item.jd.com/10372998311.html" target="_blank" rel="noopener">http://item.jd.com/10372998311.html</a></p><p>ã€ŠReact Nativeï¼šç”¨JavaScriptå¼€å‘ç§»åŠ¨åº”ç”¨ã€‹ <a href="http://item.jd.com/11785195.html" target="_blank" rel="noopener">http://item.jd.com/11785195.html</a></p><h2 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h2><p>React-nativeç»„ä»¶åº“ï¼ˆæ¯”è¾ƒå…¨çš„ç»„ä»¶åº“ï¼‰ <a href="https://js.coach/" target="_blank" rel="noopener">https://js.coach/</a></p><p>React Native Modules <a href="http://reactnativemodules.com/" target="_blank" rel="noopener">http://reactnativemodules.com/</a></p><p>æœ€ä½³è½®æ’­ç±»ç»„ä»¶ <a href="https://github.com/leecade/react-native-swiper" target="_blank" rel="noopener">https://github.com/leecade/react-native-swiper</a></p><p>react-native-simple-router <a href="https://github.com/react-native-simple-router-community/react-native-simple-router" target="_blank" rel="noopener">https://github.com/react-native-simple-router-community/react-native-simple-router</a></p><p>react-native-router-flux <a href="https://github.com/aksonov/react-native-router-flux" target="_blank" rel="noopener">https://github.com/aksonov/react-native-router-flux</a></p><p>ä¸‹æ‹‰åˆ·æ–°ç»„ä»¶ <a href="https://github.com/jsdf/react-native-refreshable-listview" target="_blank" rel="noopener">https://github.com/jsdf/react-native-refreshable-listview</a></p><p>æ¨¡æ€æ¡† <a href="https://github.com/brentvatne/react-native-modal" target="_blank" rel="noopener">https://github.com/brentvatne/react-native-modal</a></p><p>react-native-navbar <a href="https://github.com/react-native-fellowship/react-native-navbar" target="_blank" rel="noopener">https://github.com/react-native-fellowship/react-native-navbar</a></p><p>æ»šåŠ¨è½®æ’­ç»„ä»¶ <a href="https://github.com/appintheair/react-native-looped-carousel" target="_blank" rel="noopener">https://github.com/appintheair/react-native-looped-carousel</a></p><p>HTMLæ˜¾ç¤ºç»„ä»¶ <a href="https://github.com/jsdf/react-native-htmlview" target="_blank" rel="noopener">https://github.com/jsdf/react-native-htmlview</a></p><p>Material React Native (MRN) - Material Designç»„ä»¶åº“ <a href="https://github.com/binggg/mrn" target="_blank" rel="noopener">https://github.com/binggg/mrn</a></p><p>react-native-gitfeed - GitHubå®¢æˆ·ç«¯(iOS/Android) <a href="https://github.com/xiekw2010/react-native-gitfeed" target="_blank" rel="noopener">https://github.com/xiekw2010/react-native-gitfeed</a></p><p>React-Native-Elements - React Nativeæ ·å¼ç»„ä»¶åº“ <a href="https://github.com/react-native-community/React-Native-Elements" target="_blank" rel="noopener">https://github.com/react-native-community/React-Native-Elements</a></p><p>Shoutem UI - React Nativeæ ·å¼ç»„ä»¶åº“ <a href="https://github.com/shoutem/ui" target="_blank" rel="noopener">https://github.com/shoutem/ui</a></p><h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><p>react-native-snippets(ä»£ç æç¤º) <a href="https://github.com/Shrugs/react-native-snippets" target="_blank" rel="noopener">https://github.com/Shrugs/react-native-snippets</a></p><p>react-native-babel(ä½¿ç”¨ES6+) <a href="https://github.com/roman01la/react-native-babel" target="_blank" rel="noopener">https://github.com/roman01la/react-native-babel</a></p><p>sqlite for react-native <a href="https://github.com/almost/react-native-sqlite" target="_blank" rel="noopener">https://github.com/almost/react-native-sqlite</a></p><p>gulp-react-native-css(å°±åƒå†™cssä¸€æ ·å†™React Style) <a href="https://github.com/soliury/gulp-react-native-css" target="_blank" rel="noopener">https://github.com/soliury/gulp-react-native-css</a></p><p>rnpm(React Native Package Manager) <a href="https://github.com/rnpm/rnpm" target="_blank" rel="noopener">https://github.com/rnpm/rnpm</a></p><p>Pepperoni - React Nativeé¡¹ç›®åˆå§‹åŒ–å¥—ä»¶ <a href="https://github.com/futurice/pepperoni-app-kit" target="_blank" rel="noopener">https://github.com/futurice/pepperoni-app-kit</a></p><p>Deco IDE - React Native IDE <a href="https://www.decosoftware.com/" target="_blank" rel="noopener">https://www.decosoftware.com/</a></p><p>ignite - React Native CLIé¡¹ç›®ç”Ÿæˆå™¨ <a href="https://github.com/infinitered/ignite" target="_blank" rel="noopener">https://github.com/infinitered/ignite</a></p><h2 id="èµ„æºç½‘ç«™"><a href="#èµ„æºç½‘ç«™" class="headerlink" title="èµ„æºç½‘ç«™"></a>èµ„æºç½‘ç«™</h2><p>React-nativeå®˜ç½‘ <a href="http://facebook.github.io/react-native/" target="_blank" rel="noopener">http://facebook.github.io/react-native/</a></p><p>React-Chinaç¤¾åŒº <a href="http://react-china.org/" target="_blank" rel="noopener">http://react-china.org/</a></p><p>React Nativeä¸­æ–‡ç¤¾åŒº <a href="http://bbs.react-native.cn/" target="_blank" rel="noopener">http://bbs.react-native.cn/</a></p><p>React-nativeç»„ä»¶åº“ï¼ˆæ¯”è¾ƒå…¨çš„ç»„ä»¶åº“ï¼‰ <a href="http://react.parts/" target="_blank" rel="noopener">http://react.parts/</a></p><p>React Native Modules <a href="http://reactnativemodules.com/" target="_blank" rel="noopener">http://reactnativemodules.com/</a></p><p>Use React Native èµ„è®¯ç«™(ä½¿ç”¨æŠ€å·§åŠæ–°é—») <a href="http://www.reactnative.com/" target="_blank" rel="noopener">http://www.reactnative.com/</a></p><p>11æ¬¾React Nativeå¼€æºç§»åŠ¨ UI ç»„ä»¶ <a href="http://www.oschina.net/news/61214/11-react-native-ui-components" target="_blank" rel="noopener">http://www.oschina.net/news/61214/11-react-native-ui-components</a></p><p>ç¨€åœŸæ˜é‡‘çš„ React æ ‡ç­¾ <a href="http://gold.xitu.io/#/tag/React.js" target="_blank" rel="noopener">http://gold.xitu.io/#/tag/React.js</a> <a href="http://gold.xitu.io/#/tag/React%20Native" target="_blank" rel="noopener">http://gold.xitu.io/#/tag/React%20Native</a></p><h2 id="ä¸šç•Œè®¨è®º"><a href="#ä¸šç•Œè®¨è®º" class="headerlink" title="ä¸šç•Œè®¨è®º"></a>ä¸šç•Œè®¨è®º</h2><p>è·¨å¹³å°å¼€å‘æ—¶ä»£çš„ (å†æ¬¡) åˆ°æ¥ï¼Ÿï¼ˆ Xamarinï¼ŒNativeScript å’Œ React Native å¯¹æ¯”ï¼‰ <a href="http://onevcat.com/2015/03/cross-platform/" target="_blank" rel="noopener">http://onevcat.com/2015/03/cross-platform/</a></p><p>è°ˆè°ˆ React Native - å”å·§ <a href="http://blog.devtang.com/blog/2015/02/01/talk-about-react-native/" target="_blank" rel="noopener">http://blog.devtang.com/blog/2015/02/01/talk-about-react-native/</a></p><p>å¦‚ä½•è¯„ä»·React-Native? <a href="https://www.zhihu.com/question/27852694/answer/43990708" target="_blank" rel="noopener">https://www.zhihu.com/question/27852694/answer/43990708</a></p><p>React Nativeæ¦‚è¿°ï¼šèƒŒæ™¯ã€è§„åˆ’å’Œé£é™© <a href="http://div.io/topic/938" target="_blank" rel="noopener">http://div.io/topic/938</a></p><p>Nativeä¸Webçš„èåˆ - Qconä¸­React-Nativeæ¼”è®² <a href="http://www.infoq.com/cn/presentations/the-fusion-of-native-and-web" target="_blank" rel="noopener">http://www.infoq.com/cn/presentations/the-fusion-of-native-and-web</a></p><p>ä½¿ç”¨React Nativeä¸€å¹´åçš„æ„Ÿå—<a href="http://www.dobest.me/blog/2016/06/12/%E4%BD%BF%E7%94%A8React%20Native%E4%B8%80%E5%B9%B4%E5%90%8E%E7%9A%84%E6%84%9F%E5%8F%97/" target="_blank" rel="noopener">http://www.dobest.me/blog/2016/06/12/%E4%BD%BF%E7%94%A8React%20Native%E4%B8%80%E5%B9%B4%E5%90%8E%E7%9A%84%E6%84%9F%E5%8F%97/</a></p><p>Weex &amp; ReactNative &amp; JSPatchå¤§å¯¹æ¯” <a href="http://awhisper.github.io/2016/07/22/Weex-ReactNative-JSPatch/" target="_blank" rel="noopener">http://awhisper.github.io/2016/07/22/Weex-ReactNative-JSPatch/</a></p><p>weex&amp;ReactNativeå¯¹æ¯” <a href="https://zhuanlan.zhihu.com/p/21677103" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/21677103</a></p><p><a href="https://www.jianshu.com/p/ab8a29687d45" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> react-native </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ react.jsæ¯”ä½ æƒ³è±¡çš„ç®€å•</title>
      <link href="/2018/03/03/React/%E5%AD%A6%E4%B9%A0react-js%E6%AF%94%E4%BD%A0%E6%83%B3%E8%B1%A1%E7%9A%84%E7%AE%80%E5%8D%95/"/>
      <url>/2018/03/03/React/%E5%AD%A6%E4%B9%A0react-js%E6%AF%94%E4%BD%A0%E6%83%B3%E8%B1%A1%E7%9A%84%E7%AE%80%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<p><a href="https://juejin.im/post/599156cc6fb9a03c3a25db08" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><hr><h1 id="å­¦ä¹ -React-js-æ¯”ä½ æƒ³è±¡çš„è¦ç®€å•"><a href="#å­¦ä¹ -React-js-æ¯”ä½ æƒ³è±¡çš„è¦ç®€å•" class="headerlink" title="å­¦ä¹  React.js æ¯”ä½ æƒ³è±¡çš„è¦ç®€å•"></a>å­¦ä¹  React.js æ¯”ä½ æƒ³è±¡çš„è¦ç®€å•</h1><p><img src="https://user-gold-cdn.xitu.io/2017/8/14/88e06ce88c09c77c1504b772f5801686?imageView2/1/w/1304/h/734/q/85/format/webp/interlace/1" alt="react"></p><h2 id="React-å…¨éƒ¨éƒ½æ˜¯ç»„ä»¶åŒ–çš„"><a href="#React-å…¨éƒ¨éƒ½æ˜¯ç»„ä»¶åŒ–çš„" class="headerlink" title="React å…¨éƒ¨éƒ½æ˜¯ç»„ä»¶åŒ–çš„"></a>React å…¨éƒ¨éƒ½æ˜¯ç»„ä»¶åŒ–çš„</h2><p>React æ˜¯å›´ç»•å¯é‡ç”¨ç»„ä»¶çš„æ¦‚å¿µè®¾è®¡çš„ã€‚ä½ å®šä¹‰å°ç»„ä»¶å¹¶å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·å½¢æˆæ›´å¤§çš„ç»„ä»¶ã€‚</p><p>æ— è®ºå¤§å°ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½æ˜¯å¯é‡ç”¨çš„ï¼Œç”šè‡³åœ¨ä¸åŒçš„é¡¹ç›®ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><p>React ç»„ä»¶æœ€ç®€å•çš„å½¢å¼ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ JavaScript å‡½æ•°ï¼š</p><pre><code class="javascript">function Button (props) {  // è¿™é‡Œè¿”å›ä¸€ä¸ª DOM å…ƒç´ ï¼Œä¾‹å¦‚ï¼š  return &lt;button type=&quot;submit&quot;&gt;{props.label}&lt;/button&gt;;}// å°†æŒ‰é’®ç»„ä»¶å‘ˆç°ç»™æµè§ˆå™¨ReactDOM.render(&lt;Button label=&quot;Save&quot; /&gt;, mountNode)</code></pre><p>ä¾‹ 1ï¼šç¼–è¾‘ä¸Šé¢çš„ä»£ç å¹¶æŒ‰ Ctrl+Enter é”®æ‰§è¡Œï¼ˆè¯‘è€…æ³¨ï¼šè¯‘æ–‡æš‚æ—¶æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œè¯·è®¿é—®åŸæ–‡ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œä¸‹åŒï¼‰</p><blockquote><p>æ‹¬å·ä¸­çš„ button æ ‡ç­¾å°†ç¨åè§£é‡Šã€‚ç°åœ¨ä¸è¦æ‹…å¿ƒå®ƒä»¬ã€‚ReactDOM ä¹Ÿå°†ç¨åè§£é‡Šï¼Œä½†å¦‚æœä½ æƒ³æµ‹è¯•è¿™ä¸ªä¾‹å­å’Œæ‰€æœ‰æ¥ä¸‹æ¥çš„ä¾‹å­ï¼Œä¸Šè¿° render å‡½æ•°æ˜¯å¿…é¡»çš„ã€‚ï¼ˆReact å°†è¦æ¥ç®¡å’Œæ§åˆ¶çš„æ˜¯ ReactDOM.render çš„ç¬¬ 2 ä¸ªå‚æ•°å³ç›®æ ‡ DOM å…ƒç´ ï¼‰ã€‚åœ¨ jsComplete REPL ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„å˜é‡ mountNodeã€‚</p></blockquote><p>ä¾‹ 1 çš„æ³¨æ„äº‹é¡¹ï¼š</p><blockquote><ul><li>ç»„ä»¶åç§°é¦–å­—æ¯å¤§å†™ï¼ŒButtonã€‚å¿…é¡»è¦è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ä»¬å°†å¤„ç† HTML å…ƒç´ å’Œ React å…ƒç´ çš„æ··åˆã€‚å°å†™åç§°æ˜¯ä¸º HTML å…ƒç´ ä¿ç•™çš„ã€‚äº‹å®ä¸Šï¼Œå°† React ç»„ä»¶å‘½åä¸º â€œbuttonâ€ ç„¶åä½ å°±ä¼šå‘ç° ReactDOM ä¼šå¿½ç•¥è¿™ä¸ªå‡½æ•°ï¼Œä»…ä»…æ˜¯å°†å…¶ä½œä¸ºä¸€ä¸ªæ™®é€šçš„ç©º HTML æŒ‰é’®æ¥æ¸²æŸ“ã€‚</li></ul></blockquote><blockquote><ul><li>æ¯ä¸ªç»„ä»¶éƒ½æ¥æ”¶ä¸€ä¸ªå±æ€§åˆ—è¡¨ï¼Œå°±åƒ HTML å…ƒç´ ä¸€æ ·ã€‚åœ¨ React ä¸­ï¼Œè¿™ä¸ªåˆ—è¡¨è¢«ç§°ä¸ºå±æ€§ã€‚è™½ç„¶ä½ å¯ä»¥å°†ä¸€ä¸ªå‡½æ•°éšæ„å‘½åã€‚</li></ul></blockquote><blockquote><ul><li>åœ¨ä¸Šé¢ Button å‡½æ•°ç»„ä»¶çš„è¿”å›è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å¥‡æ€ªåœ°å†™äº†æ®µçœ‹ä¸Šå»åƒ HTML çš„ä»£ç ã€‚è¿™å®é™…ä¸Šæ—¢ä¸æ˜¯ JavaScript ä¹Ÿä¸æ˜¯ HTMLï¼Œè€å®è¯´ï¼Œè¿™ç”šè‡³ä¸æ˜¯ React.jsã€‚ç„¶è€Œå®ƒéå¸¸æµè¡Œï¼Œä»¥è‡³äºæˆä¸º React åº”ç”¨ç¨‹åºä¸­çš„é»˜è®¤å€¼ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ JSXï¼Œè¿™æ˜¯ä¸€ä¸ªJavaScript çš„æ‰©å±•ã€‚JSX ä¹Ÿæ˜¯ä¸€ä¸ªæŠ˜ä¸­æ–¹æ¡ˆï¼ç»§ç»­å°è¯•å¹¶åœ¨ä¸Šé¢çš„å‡½æ•°ä¸­è¿”å›å…¶ä»– HTML å…ƒç´ ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•è¢«æ”¯æŒçš„ï¼ˆä¾‹å¦‚ï¼Œè¿”å›ä¸€ä¸ªæ–‡æœ¬è¾“å…¥å…ƒç´ ï¼‰ã€‚</li></ul></blockquote><a id="more"></a><h2 id="JSX-è¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#JSX-è¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="JSX è¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Ÿ"></a>JSX è¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>ä¸Šé¢çš„ä¾‹ 1 å¯ä»¥ç”¨æ²¡æœ‰ JSX çš„çº¯ React.js ç¼–å†™ï¼Œå¦‚ä¸‹ï¼š</p><pre><code class="javascript">function Button (props) {  return React.createElement(    &quot;button&quot;,    { type: &quot;submit&quot; },    props.label  );}// è¦ä½¿ç”¨ Buttonï¼Œä½ å¯ä»¥è¿™ä¹ˆåšReactDOM.render(  React.createElement(Button, { label: &quot;Save&quot; }),  mountNode);</code></pre><p>ä¾‹ 2ï¼šä¸ä½¿ç”¨ JSX ç¼–å†™ React ç»„ä»¶</p><p>åœ¨ React é¡¶çº§ API ä¸­ï¼ŒcreateElement å‡½æ•°æ˜¯ä¸»å‡½æ•°ã€‚è¿™æ˜¯ä½ éœ€è¦å­¦ä¹ çš„ 7 ä¸ª API ä¸­çš„ 1 ä¸ªã€‚React çš„ API å°±æ˜¯è¿™ä¹ˆå°ã€‚</p><p>å°±åƒ DOM è‡ªèº«æœ‰ä¸€ä¸ª document.createElement å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªç”±æ ‡ç­¾åæŒ‡å®šçš„å…ƒç´ ä¸€æ ·ï¼ŒReact çš„ createElement å‡½æ•°æ˜¯ä¸€ä¸ªé«˜çº§å‡½æ•°ï¼Œæœ‰å’Œ document.createElement åŒæ ·çš„åŠŸèƒ½ï¼Œä½†å®ƒä¹Ÿå¯ä»¥ç”¨äºåˆ›å»ºä¸€ä¸ªè¡¨ç¤º React ç»„ä»¶çš„å…ƒç´ ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢ä¾‹ 2 ä¸­çš„æŒ‰é’®ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯åè€…ã€‚</p><p>ä¸åƒ document.createElementï¼ŒReact çš„ createElement åœ¨æ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°åï¼Œæ¥æ”¶ä¸€ä¸ªåŠ¨æ€å‚æ•°ï¼Œå®ƒè¡¨ç¤ºæ‰€åˆ›å»ºå…ƒç´ çš„å­å…ƒç´ ã€‚æ‰€ä»¥ createElement å®é™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ ‘ã€‚</p><p>è¿™é‡Œå°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªä¾‹å­ï¼š</p><pre><code class="javascript">const InputForm = React.createElement(  &quot;form&quot;,  { target: &quot;_blank&quot;, action: &quot;https://google.com/search&quot; },  React.createElement(&quot;div&quot;, null, &quot;Enter input and click Search&quot;),  React.createElement(&quot;input&quot;, { className: &quot;big-input&quot; }),  React.createElement(Button, { label: &quot;Search&quot; }));// InputForm ä½¿ç”¨ Button ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿™æ ·åšï¼šfunction Button (props) {  return React.createElement(    &quot;button&quot;,    { type: &quot;submit&quot; },    props.label  );}// ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ .render æ–¹æ³•ç›´æ¥ä½¿ç”¨ InputFormReactDOM.render(InputForm, mountNode);</code></pre><p>ä¾‹ 3ï¼šReact åˆ›å»ºå…ƒç´ çš„ API<br>ä¸Šé¢ä¾‹å­ä¸­çš„ä¸€äº›äº‹æƒ…å€¼å¾—æ³¨æ„ï¼š</p><blockquote><ul><li>InputForm ä¸æ˜¯ä¸€ä¸ª React ç»„ä»¶ï¼›å®ƒä»…ä»…æ˜¯ä¸€ä¸ª React å…ƒç´ ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ ReactDOM.render ä¸­ç›´æ¥ä½¿ç”¨å®ƒå¹¶ä¸”å¯ä»¥åœ¨è°ƒç”¨æ—¶ä¸ä½¿ç”¨ <InputForm /> çš„åŸå› ã€‚</li></ul></blockquote><blockquote><ul><li>React.createElement å‡½æ•°åœ¨å‰ä¸¤ä¸ªå‚æ•°åæ¥æ”¶äº†å¤šä¸ªå‚æ•°ã€‚ä»ç¬¬3ä¸ªå‚æ•°å¼€å§‹çš„å‚æ•°åˆ—è¡¨æ„æˆäº†åˆ›å»ºå…ƒç´ çš„å­é¡¹åˆ—è¡¨ã€‚</li></ul></blockquote><blockquote><ul><li>æˆ‘ä»¬å¯ä»¥åµŒå¥— React.createElement è°ƒç”¨ï¼Œå› ä¸ºå®ƒæ˜¯ JavaScriptã€‚</li></ul></blockquote><blockquote><ul><li>å½“è¿™ä¸ªå…ƒç´ ä¸éœ€è¦å±æ€§æ—¶ï¼Œ<font color="red">React.createElement </font>çš„ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä¸ºç©ºæˆ–è€…æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ã€‚</li></ul></blockquote><blockquote><ul><li>æˆ‘ä»¬å¯ä»¥åœ¨ React ç»„ä»¶ä¸­æ··åˆ HTML å…ƒç´ ã€‚ä½ å¯ä»¥å°† HTML å…ƒç´ ä½œä¸ºå†…ç½®çš„ React ç»„ä»¶ã€‚</li></ul></blockquote><blockquote><ul><li>React çš„ API è¯•å›¾å’Œ DOM API ä¸€æ ·ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨ input å…ƒç´ ä¸­ä½¿ç”¨ className ä»£æ›¿ class çš„åŸå› ã€‚æˆ‘ä»¬éƒ½å¸Œæœ›å¦‚æœ </li></ul></blockquote><blockquote><ul><li>React çš„ API æˆä¸º DOM API æœ¬èº«çš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºï¼Œä½ çŸ¥é“ï¼Œå®ƒè¦å¥½å¾—å¤šã€‚</li></ul></blockquote><p>ä¸Šè¿°çš„ä»£ç æ˜¯å½“ä½ å¼•å…¥ React åº“çš„æ—¶å€™æµè§ˆå™¨æ˜¯æ€æ ·ç†è§£çš„ã€‚æµè§ˆå™¨ä¸ä¼šå¤„ç†ä»»ä½• JSX ä¸šåŠ¡ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ›´å–œæ¬¢çœ‹åˆ°å’Œä½¿ç”¨ HTMLï¼Œè€Œä¸æ˜¯é‚£äº› createElement è°ƒç”¨ï¼ˆæƒ³è±¡ä¸€ä¸‹åªä½¿ç”¨ document.createElement æ„å»ºä¸€ä¸ªç½‘ç«™ï¼ï¼‰ã€‚è¿™å°±æ˜¯ JSX å­˜åœ¨çš„åŸå› ã€‚å–ä»£ä¸Šè¿°è°ƒç”¨ React.createElement çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªéå¸¸ç®€å•ç±»ä¼¼äº HTML çš„è¯­æ³•ï¼š</p><pre><code class="javascript">const InputForm =  &lt;form target=&quot;_blank&quot; action=&quot;https://google.com/search&quot;&gt;    &lt;div&gt;Enter input and click Search&lt;/div&gt;    &lt;input className=&quot;big-input&quot; name=&quot;q&quot; /&gt;    &lt;Button label=&quot;Search&quot; /&gt;  &lt;/form&gt;;// InputForm â€œä»ç„¶â€ä½¿ç”¨ Button ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦è¿™æ ·ã€‚// JXS æˆ–è€…æ™®é€šçš„è¡¨å•éƒ½ä¼šè¿™æ ·åšfunction Button (props) {  // è¿™é‡Œè¿”å›ä¸€ä¸ª DOM å…ƒç´ ã€‚ä¾‹å¦‚ï¼š  return &lt;button type=&quot;submit&quot;&gt;{props.label}&lt;/button&gt;;}// ç„¶åæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ .render ä½¿ç”¨ InputFormReactDOM.render(InputForm, mountNode);</code></pre><p>ä¾‹ 4ï¼šä¸ºä»€ä¹ˆåœ¨ React ä¸­ JSX å—æ¬¢è¿ï¼ˆå’Œä¾‹ 3 ç›¸æ¯”ï¼‰<br>æ³¨æ„ä¸Šé¢çš„å‡ ä»¶äº‹ï¼š</p><blockquote><ul><li>è¿™ä¸æ˜¯ HTML ä»£ç ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨ className ä»£æ›¿ classã€‚</li><li>æˆ‘ä»¬ä»åœ¨è€ƒè™‘æ€æ ·è®©ä¸Šè¿°çš„ JavaScript çœ‹èµ·æ¥åƒæ˜¯ HTMLã€‚çœ‹ä¸€ä¸‹æˆ‘åœ¨æœ€åæ˜¯æ€æ ·æ·»åŠ çš„ã€‚</li></ul></blockquote><p>æˆ‘ä»¬åœ¨ä¸Šé¢ï¼ˆä¾‹ 4ï¼‰ä¸­å†™çš„å°±æ˜¯ JSXã€‚ç„¶è€Œï¼Œæˆ‘ä»¬è¦å°†ç¼–è¯‘åçš„ç‰ˆæœ¬ï¼ˆä¾‹ 3ï¼‰ç»™æµè§ˆå™¨ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªé¢„å¤„ç†å™¨å°† JSX ç‰ˆæœ¬è½¬æ¢ä¸º React.createElement ç‰ˆæœ¬ã€‚<br>è¿™å°±æ˜¯ JSXã€‚è¿™æ˜¯ä¸€ç§æŠ˜ä¸­çš„æ–¹æ¡ˆï¼Œå…è®¸æˆ‘ä»¬ç”¨ç±»ä¼¼ HTML çš„è¯­æ³•æ¥ç¼–å†™æˆ‘ä»¬çš„ React ç»„ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ã€‚</p><blockquote><p>â€œFluxâ€ åœ¨å¤´éƒ¨ä½œä¸ºéŸµè„šæ¥ä½¿ç”¨ï¼Œä½†å®ƒä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„ åº”ç”¨æ¶æ„ï¼Œç”± Facebook æ¨å¹¿ã€‚æœ€å‡ºåçš„æ˜¯ Reduxï¼ŒFlux å’Œ React éå¸¸åˆé€‚ã€‚</p></blockquote><p>JSXï¼Œå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¸ä»…ä»…é€‚ç”¨äº Reactã€‚</p><h2 id="ä½ å¯ä»¥åœ¨-JavaScript-çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨-JSX"><a href="#ä½ å¯ä»¥åœ¨-JavaScript-çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨-JSX" class="headerlink" title="ä½ å¯ä»¥åœ¨ JavaScript çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ JSX"></a>ä½ å¯ä»¥åœ¨ JavaScript çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ JSX</h2><p>åœ¨ JSX ä¸­ï¼Œä½ å¯ä»¥åœ¨ä¸€å¯¹èŠ±æ‹¬å·å†…ä½¿ç”¨ä»»ä½• JavaScript è¡¨è¾¾å¼ã€‚</p><pre><code class="javascript">const RandomValue = () =&gt;  &lt;div&gt;    { Math.floor(Math.random() * 100) }  &lt;/div&gt;;// ä½¿ç”¨ï¼šReactDOM.render(&lt;RandomValue /&gt;, mountNode);</code></pre><p>ä¾‹ 5ï¼šåœ¨ JSX ä¸­ä½¿ç”¨ JavaScript è¡¨è¾¾å¼</p><p>ä»»ä½• JavaScript è¡¨è¾¾å¼å¯ä»¥ç›´æ¥æ”¾åœ¨èŠ±æ‹¬å·ä¸­ã€‚è¿™ç›¸å½“äºåœ¨ JavaScript ä¸­æ’å…¥ ${} æ¨¡æ¿ã€‚</p><p>è¿™æ˜¯ JSX å†…å”¯ä¸€çš„çº¦æŸï¼šåªæœ‰è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œä½ ä¸èƒ½ä½¿ç”¨ if è¯­å¥ï¼Œä½†ä¸‰å…ƒè¡¨è¾¾å¼æ˜¯å¯ä»¥çš„ã€‚</p><p>JavaScript å˜é‡ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼Œæ‰€ä»¥å½“ç»„ä»¶æ¥å—å±æ€§åˆ—è¡¨æ—¶ï¼ˆä¸åŒ…æ‹¬ RandomValue ç»„ä»¶ï¼Œprops æ˜¯å¯é€‰æ‹©çš„ï¼‰ï¼Œä½ å¯ä»¥åœ¨èŠ±æ‹¬å·é‡Œä½¿ç”¨è¿™äº›å±æ€§ã€‚æˆ‘ä»¬åœ¨ä¸Šè¿°ï¼ˆä¾‹ 1ï¼‰çš„ Button ç»„ä»¶æ˜¯è¿™æ ·ä½¿ç”¨çš„ã€‚</p><p>JavaScript å¯¹è±¡ä¹Ÿæ˜¯è¡¨è¾¾å¼ã€‚æœ‰äº›æ—¶å€™æˆ‘ä»¬åœ¨èŠ±æ‹¬å·ä¸­ä½¿ç”¨ JavaScript å¯¹è±¡ï¼Œè¿™çœ‹èµ·æ¥åƒæ˜¯ä½¿ç”¨äº†ä¸¤ä¸ªèŠ±æ‹¬å·ï¼Œä½†æ˜¯åœ¨èŠ±æ‹¬å·ä¸­ç¡®å®åªæœ‰ä¸€ä¸ªå¯¹è±¡ã€‚å…¶ä¸­ä¸€ä¸ªç”¨ä¾‹å°±æ˜¯å°† CSS æ ·å¼å¯¹è±¡ä¼ é€’ç»™å“åº”ä¸­çš„ç‰¹æ®Šæ ·å¼å±æ€§ï¼š</p><pre><code class="javascript">const ErrorDisplay = ({message}) =&gt;  &lt;div style={ { color: &#39;red&#39;, backgroundColor: &#39;yellow&#39; } }&gt;    {message}  &lt;/div&gt;;// ä½¿ç”¨ReactDOM.render(  &lt;ErrorDisplay    message=&quot;These aren&#39;t the droids you&#39;re looking for&quot;  /&gt;,  mountNode);</code></pre><p>ä¾‹ 6ï¼šä¸€ä¸ªå¯¹è±¡ä¼ é€’ç‰¹æ®Šçš„ React æ ·å¼å‚æ•°<br>æ³¨æ„æˆ‘è§£æ„çš„åªæ˜¯åœ¨å±æ€§å‚æ•°ä¹‹å¤–çš„ä¿¡æ¯ã€‚è¿™åªæ˜¯ JavaScriptã€‚è¿˜è¦æ³¨æ„ä¸Šé¢çš„æ ·å¼å±æ€§æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ï¼ˆåŒæ ·ï¼Œå®ƒä¸æ˜¯ HTMLï¼Œå®ƒæ›´æ¥è¿‘ DOM APIï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ä½œä¸ºæ ·å¼å±æ€§çš„å€¼å¹¶ä¸”è¿™ä¸ªå¯¹è±¡å®šä¹‰æ ·å¼å°±åƒæˆ‘ä»¬ä½¿ç”¨ JavaScript </p><p>ä½ å¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨ React å…ƒç´ ã€‚å› ä¸ºè¿™ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆè®°ä½ï¼Œä¸€ä¸ª React å…ƒç´ åªæ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼‰ï¼š</p><pre><code class="javascript">const MaybeError = ({errorMessage}) =&gt;  &lt;div&gt;    {errorMessage &amp;&amp; &lt;ErrorDisplay message={errorMessage} /&gt;}  &lt;/div&gt;;// MaybeError ç»„ä»¶ä½¿ç”¨ ErrorDisplay ç»„ä»¶const ErrorDisplay = ({message}) =&gt;  &lt;div style={ { color: &#39;red&#39;, backgroundColor: &#39;yellow&#39; } }&gt;    {message}  &lt;/div&gt;;// ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ MaybeError ç»„ä»¶ï¼šReactDOM.render(  &lt;MaybeError    errorMessage={Math.random() &gt; 0.5 ? &#39;Not good&#39; : &#39;&#39;}  /&gt;,  mountNode);</code></pre><p>ä¾‹ 7ï¼šä¸€ä¸ª React å…ƒç´ æ˜¯ä¸€ä¸ªå¯ä»¥é€šè¿‡ {} ä½¿ç”¨çš„è¡¨è¾¾å¼</p><p>ä¸Šè¿° MaybeError ç»„ä»¶åªä¼šåœ¨æœ‰ errorMessage ä¼ å…¥æˆ–è€…å¦å¤–æœ‰ä¸€ä¸ªç©ºçš„ div æ‰ä¼šæ˜¾ç¤º ErrorDisplay ç»„ä»¶ã€‚React è®¤ä¸º {true}ã€ {false}{undefined} å’Œ {null} æ˜¯æœ‰æ•ˆå…ƒç´ ï¼Œä¸å‘ˆç°ä»»ä½•å†…å®¹ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨æ‰€æœ‰çš„ JavaScript çš„é›†åˆæ–¹æ³•ï¼ˆmapã€reduce ã€filterã€ concat ç­‰ï¼‰ã€‚å› ä¸ºä»–ä»¬è¿”å›çš„ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼š</p><pre><code class="javascript">const Doubler = ({value=[1, 2, 3]}) =&gt;  &lt;div&gt;    {value.map(e =&gt; e * 2)}  &lt;/div&gt;;// ä½¿ç”¨ä¸‹é¢å†…å®¹ ReactDOM.render(&lt;Doubler /&gt;, mountNode);</code></pre><p>ä¾‹ 8ï¼šåœ¨ {} ä¸­ä½¿ç”¨æ•°ç»„</p><p>è¯·æ³¨æ„æˆ‘æ˜¯å¦‚ä½•ç»™å‡ºä¸Šè¿° value å±æ€§çš„é»˜è®¤å€¼çš„ï¼Œå› ä¸ºè¿™å…¨éƒ¨éƒ½åªæ˜¯ JavaScriptã€‚æ³¨æ„æˆ‘åªæ˜¯åœ¨ div ä¸­è¾“å‡ºä¸€ä¸ªæ•°ç»„è¡¨è¾¾å¼ã€‚React æ˜¯å®Œå…¨å¯ä»¥çš„ã€‚å®ƒåªä¼šåœ¨æ–‡æœ¬èŠ‚ç‚¹ä¸­æ”¾ç½®æ¯ä¸€ä¸ªåŠ å€çš„å€¼ã€‚</p><h2 id="ä½ å¯ä»¥ä½¿ç”¨-JavaScript-ç±»å†™-React-ç»„ä»¶"><a href="#ä½ å¯ä»¥ä½¿ç”¨-JavaScript-ç±»å†™-React-ç»„ä»¶" class="headerlink" title="ä½ å¯ä»¥ä½¿ç”¨ JavaScript ç±»å†™ React ç»„ä»¶"></a>ä½ å¯ä»¥ä½¿ç”¨ JavaScript ç±»å†™ React ç»„ä»¶</h2><p>ç®€å•çš„å‡½æ•°ç»„ä»¶éå¸¸é€‚åˆç®€å•çš„éœ€æ±‚ï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦çš„æ›´å¤šã€‚React ä¹Ÿæ”¯æŒé€šè¿‡ä½¿ç”¨ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes" target="_blank" rel="noopener">JavaScript ç±»</a>æ¥åˆ›å»ºç»„ä»¶ã€‚è¿™é‡Œ Button ç»„ä»¶ï¼ˆåœ¨ä¾‹ 1 ä¸­ï¼‰å°±æ˜¯ä½¿ç”¨ç±»çš„è¯­æ³•ç¼–å†™çš„ã€‚</p><pre><code class="javascript">class Button extends React.Component {  render() {    return &lt;button&gt;{this.props.label}&lt;/button&gt;;  }}// ä½¿ç”¨ï¼ˆç›¸åŒçš„è¯­æ³•ï¼‰ReactDOM.render(&lt;Button label=&quot;Save&quot; /&gt;, mountNode);</code></pre><p>ä¾‹ 9ï¼šä½¿ç”¨ JavaScript ç±»åˆ›å»ºç»„ä»¶</p><p>ç±»çš„è¯­æ³•æ˜¯éå¸¸ç®€å•çš„ï¼šå®šä¹‰ä¸€ä¸ªæ‰©å±•çš„ React.Component ç±»ï¼ˆå¦ä¸€ä¸ªä½ éœ€è¦å­¦ä¹ çš„ React çš„é¡¶çº§ APIï¼‰ã€‚è¯¥ç±»å®šä¹‰äº†ä¸€ä¸ªå•ä¸€çš„å®ä¾‹å‡½æ•° â€”â€” render()ï¼Œå¹¶ä½¿å‡½æ•°è¿”å›è™šæ‹Ÿ DOM å¯¹è±¡ã€‚æ¯ä¸€æ¬¡æˆ‘ä»¬ä½¿ç”¨åŸºäºç±»çš„ Button ç»„ä»¶ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ <Button ... />ï¼‰,React å°†ä»è¿™ä¸ªåŸºäºç±»çš„ç»„ä»¶ä¸­å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¹¶åœ¨ DOM æ ‘ä¸­ä½¿ç”¨è¯¥å¯¹è±¡ã€‚</p><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨ this.props.label æ¸²æŸ“è¾“å‡ºçš„åŸå› ï¼Œå› ä¸ºæ¯ä¸€ä¸ªç»„ä»¶éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç§°ä¸º props çš„ å®ä¾‹ å±æ€§ï¼Œè¿™è®©æ‰€æœ‰çš„å€¼ä¼ é€’ç»™è¯¥ç»„ä»¶æ—¶è¢«å®ä¾‹åŒ–ã€‚</p><p>ç”±äºæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸ç»„ä»¶çš„å•ä¸ªä½¿ç”¨ç›¸å…³è”çš„å®ä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è‡ªå·±çš„æ„æ„¿å®šåˆ¶è¯¥å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨å¸¸è§„ JavaScript æ„é€ å‡½æ•°æ¥æ„é€ å®ƒï¼š</p><pre><code class="javascript">class Button extends React.Component {  constructor(props) {    super(props);    this.id = Date.now();  }  render() {    return &lt;button id={this.id}&gt;{this.props.label}&lt;/button&gt;;  }}// ä½¿ç”¨ReactDOM.render(&lt;Button label=&quot;Save&quot; /&gt;, mountNode);</code></pre><p>ä¾‹ 10ï¼šè‡ªå®šä¹‰ç»„ä»¶å®ä¾‹<br>æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ç±»çš„åŸå‹å¹¶ä¸”åœ¨ä»»ä½•æˆ‘ä»¬å¸Œæœ›çš„åœ°æ–¹ä½¿ç”¨ï¼ŒåŒ…æ‹¬åœ¨è¿”å›çš„ JSX è¾“å‡ºçš„å†…éƒ¨ï¼š</p><pre><code class="javascript">class Button extends React.Component {  clickCounter = 0;  handleClick = () =&gt; {    console.log(`Clicked: ${++this.clickCounter}`);  };  render() {    return (      &lt;button id={this.id} onClick={this.handleClick}&gt;        {this.props.label}      &lt;/button&gt;    );  }}// ä½¿ç”¨ReactDOM.render(&lt;Button label=&quot;Save&quot; /&gt;, mountNode);</code></pre><p>ä¾‹ 11ï¼šä½¿ç”¨ç±»çš„å±æ€§ï¼ˆé€šè¿‡å•å‡»ä¿å­˜æŒ‰é’®è¿›è¡Œæµ‹è¯•ï¼‰</p><p>æ³¨æ„ä¸Šè¿°ä¾‹ 11 ä¸­çš„å‡ ä»¶äº‹æƒ…<br>handleClick å‡½æ•°ä½¿ç”¨ JavaScript æ–°æå‡ºçš„ <a href="https://github.com/tc39/proposal-class-fields" target="_blank" rel="noopener">class-field syntax</a> è¯­æ³•ã€‚è¿™ä»ç„¶æ˜¯ stage-2ï¼Œä½†æ˜¯è¿™æ˜¯è®¿é—®ç»„ä»¶å®‰è£…å®ä¾‹ï¼ˆæ„Ÿè°¢ç®­å¤´å‡½æ•°ï¼‰æœ€å¥½çš„é€‰æ‹©ï¼ˆå› ä¸ºå¾ˆå¤šåŸå› ï¼‰ã€‚ç„¶è€Œï¼Œä½ éœ€è¦ä½¿ç”¨ç±»ä¼¼ Babel çš„ç¼–è¯‘å™¨è§£ç ä¸º stage-2ï¼ˆæˆ–è€…ä»…ä»…æ˜¯ç±»å­—æ®µè¯­æ³•ï¼‰æ¥è®©ä¸Šè¿°ä»£ç å·¥ä½œã€‚ jsComplete REPL æœ‰é¢„ç¼–è¯‘åŠŸèƒ½ã€‚</p><pre><code class="javascript">// é”™è¯¯ï¼šonClick={this.handleClick()}// æ­£ç¡®ï¼šonClick={this.handleClick}</code></pre><h2 id="React-ä¸­çš„äº‹ä»¶ï¼šä¸¤ä¸ªé‡è¦çš„åŒºåˆ«"><a href="#React-ä¸­çš„äº‹ä»¶ï¼šä¸¤ä¸ªé‡è¦çš„åŒºåˆ«" class="headerlink" title="React ä¸­çš„äº‹ä»¶ï¼šä¸¤ä¸ªé‡è¦çš„åŒºåˆ«"></a>React ä¸­çš„äº‹ä»¶ï¼šä¸¤ä¸ªé‡è¦çš„åŒºåˆ«</h2><p>å½“å¤„ç† React å…ƒç´ ä¸­çš„äº‹ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸ DOM API çš„å¤„ç†æ–¹å¼æœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„åŒºåˆ«ï¼š</p><blockquote><ul><li>æ‰€æœ‰ React å…ƒç´ å±æ€§ï¼ˆåŒ…æ‹¬äº‹ä»¶ï¼‰éƒ½ä½¿ç”¨ camelCase å‘½åï¼Œè€Œä¸æ˜¯ lowercaseã€‚ä¾‹å¦‚æ˜¯ onClick è€Œä¸æ˜¯ onclickã€‚</li><li>æˆ‘ä»¬å°†å®é™…çš„ JavaScript å‡½æ•°å¼•ç”¨ä¼ é€’ç»™äº‹ä»¶å¤„ç†ç¨‹åºï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚æ˜¯ onClick={handleClick} è€Œä¸æ˜¯ onClick=â€handleClickâ€ã€‚</li></ul></blockquote><p>React ç”¨è‡ªå·±çš„å¯¹è±¡åŒ…è£… DOM å¯¹è±¡äº‹ä»¶ä»¥ä¼˜åŒ–äº‹ä»¶å¤„ç†çš„æ€§èƒ½ï¼Œä½†æ˜¯åœ¨äº‹ä»¶å¤„ç†ç¨‹åºå†…éƒ¨ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥è®¿é—® DOM å¯¹è±¡ä¸Šæ‰€æœ‰å¯ä»¥è®¿é—®çš„æ–¹æ³•ã€‚React å°†ç»è¿‡åŒ…è£…çš„äº‹ä»¶å¯¹è±¡ä¼ é€’ç»™æ¯ä¸ªè°ƒç”¨å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†é˜²æ­¢è¡¨å•æäº¤é»˜è®¤æäº¤æ“ä½œï¼Œä½ å¯ä»¥è¿™æ ·åš</p><pre><code class="javascript">class Form extends React.Component {  handleSubmit = (event) =&gt; {    event.preventDefault();    console.log(&#39;Form submitted&#39;);  };  render() {    return (      &lt;form onSubmit={this.handleSubmit}&gt;        &lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;      &lt;/form&gt;    );  }}// ä½¿ç”¨ReactDOM.render(&lt;Form /&gt;, mountNode);</code></pre><p>ä¾‹ 12ï¼šä½¿ç”¨åŒ…è£…è¿‡çš„å¯¹è±¡</p><h2 id="æ¯ä¸€ä¸ª-React-ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬-1-éƒ¨åˆ†"><a href="#æ¯ä¸€ä¸ª-React-ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬-1-éƒ¨åˆ†" class="headerlink" title="æ¯ä¸€ä¸ª React ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬ 1 éƒ¨åˆ†"></a>æ¯ä¸€ä¸ª React ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬ 1 éƒ¨åˆ†</h2><p>ä»¥ä¸‹ä»…é€‚ç”¨äºç±»ç»„ä»¶ï¼ˆæ‰©å±• React.Componentï¼‰ã€‚å‡½æ•°ç»„ä»¶æœ‰ä¸€ä¸ªç¨å¾®ä¸åŒçš„æ•…äº‹ã€‚</p><h3 id="é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ¨¡æ¿æ¥åˆ›å»ºç»„ä»¶ä¸­çš„å…ƒç´ ã€‚"><a href="#é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ¨¡æ¿æ¥åˆ›å»ºç»„ä»¶ä¸­çš„å…ƒç´ ã€‚" class="headerlink" title="é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ¨¡æ¿æ¥åˆ›å»ºç»„ä»¶ä¸­çš„å…ƒç´ ã€‚"></a>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ¨¡æ¿æ¥åˆ›å»ºç»„ä»¶ä¸­çš„å…ƒç´ ã€‚</h3><h3 id="ç„¶åï¼Œæˆ‘ä»¬åœ¨æŸå¤„ä½¿ç”¨-Reactã€‚ä¾‹å¦‚ï¼Œåœ¨-render-å†…éƒ¨è°ƒç”¨å…¶ä»–çš„ç»„ä»¶ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨-ReactDOM-renderã€‚"><a href="#ç„¶åï¼Œæˆ‘ä»¬åœ¨æŸå¤„ä½¿ç”¨-Reactã€‚ä¾‹å¦‚ï¼Œåœ¨-render-å†…éƒ¨è°ƒç”¨å…¶ä»–çš„ç»„ä»¶ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨-ReactDOM-renderã€‚" class="headerlink" title="ç„¶åï¼Œæˆ‘ä»¬åœ¨æŸå¤„ä½¿ç”¨ Reactã€‚ä¾‹å¦‚ï¼Œåœ¨ render å†…éƒ¨è°ƒç”¨å…¶ä»–çš„ç»„ä»¶ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ ReactDOM.renderã€‚"></a>ç„¶åï¼Œæˆ‘ä»¬åœ¨æŸå¤„ä½¿ç”¨ Reactã€‚ä¾‹å¦‚ï¼Œåœ¨ render å†…éƒ¨è°ƒç”¨å…¶ä»–çš„ç»„ä»¶ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ ReactDOM.renderã€‚</h3><h3 id="ç„¶åï¼ŒReact-å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ç„¶åç»™å®ƒè®¾ç½®-props-ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡-this-props-è®¿é—®ã€‚è¿™äº›å±æ€§éƒ½æ˜¯æˆ‘ä»¬åœ¨ç¬¬-2-æ­¥ä¼ å…¥çš„ã€‚"><a href="#ç„¶åï¼ŒReact-å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ç„¶åç»™å®ƒè®¾ç½®-props-ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡-this-props-è®¿é—®ã€‚è¿™äº›å±æ€§éƒ½æ˜¯æˆ‘ä»¬åœ¨ç¬¬-2-æ­¥ä¼ å…¥çš„ã€‚" class="headerlink" title="ç„¶åï¼ŒReact å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ç„¶åç»™å®ƒè®¾ç½® props ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ this.props è®¿é—®ã€‚è¿™äº›å±æ€§éƒ½æ˜¯æˆ‘ä»¬åœ¨ç¬¬ 2 æ­¥ä¼ å…¥çš„ã€‚"></a>ç„¶åï¼ŒReact å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ç„¶åç»™å®ƒè®¾ç½® props ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ this.props è®¿é—®ã€‚è¿™äº›å±æ€§éƒ½æ˜¯æˆ‘ä»¬åœ¨ç¬¬ 2 æ­¥ä¼ å…¥çš„ã€‚</h3><h3 id="å› ä¸ºè¿™äº›å…¨éƒ¨éƒ½æ˜¯-JavaScriptï¼Œconstructor-æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ï¼ˆå¦‚æœå®šä¹‰çš„è¯ï¼‰ã€‚è¿™æ˜¯æˆ‘ä»¬ç§°ä¹‹ä¸ºçš„ç¬¬ä¸€ä¸ªï¼šç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚"><a href="#å› ä¸ºè¿™äº›å…¨éƒ¨éƒ½æ˜¯-JavaScriptï¼Œconstructor-æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ï¼ˆå¦‚æœå®šä¹‰çš„è¯ï¼‰ã€‚è¿™æ˜¯æˆ‘ä»¬ç§°ä¹‹ä¸ºçš„ç¬¬ä¸€ä¸ªï¼šç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚" class="headerlink" title="å› ä¸ºè¿™äº›å…¨éƒ¨éƒ½æ˜¯ JavaScriptï¼Œconstructor æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ï¼ˆå¦‚æœå®šä¹‰çš„è¯ï¼‰ã€‚è¿™æ˜¯æˆ‘ä»¬ç§°ä¹‹ä¸ºçš„ç¬¬ä¸€ä¸ªï¼šç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚"></a>å› ä¸ºè¿™äº›å…¨éƒ¨éƒ½æ˜¯ JavaScriptï¼Œconstructor æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ï¼ˆå¦‚æœå®šä¹‰çš„è¯ï¼‰ã€‚è¿™æ˜¯æˆ‘ä»¬ç§°ä¹‹ä¸ºçš„ç¬¬ä¸€ä¸ªï¼šç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚</h3><h3 id="æ¥ä¸‹æ¥-React-è®¡ç®—æ¸²æŸ“ä¹‹åçš„è¾“å‡ºæ–¹æ³•ï¼ˆè™šæ‹Ÿ-DOM-èŠ‚ç‚¹ï¼‰ã€‚"><a href="#æ¥ä¸‹æ¥-React-è®¡ç®—æ¸²æŸ“ä¹‹åçš„è¾“å‡ºæ–¹æ³•ï¼ˆè™šæ‹Ÿ-DOM-èŠ‚ç‚¹ï¼‰ã€‚" class="headerlink" title="æ¥ä¸‹æ¥ React è®¡ç®—æ¸²æŸ“ä¹‹åçš„è¾“å‡ºæ–¹æ³•ï¼ˆè™šæ‹Ÿ DOM èŠ‚ç‚¹ï¼‰ã€‚"></a>æ¥ä¸‹æ¥ React è®¡ç®—æ¸²æŸ“ä¹‹åçš„è¾“å‡ºæ–¹æ³•ï¼ˆè™šæ‹Ÿ DOM èŠ‚ç‚¹ï¼‰ã€‚</h3><h3 id="å› ä¸ºè¿™æ˜¯-React-ç¬¬ä¸€æ¬¡æ¸²æŸ“å…ƒç´ ï¼ŒReact-å°†ä¼šä¸æµè§ˆå™¨è¿é€šï¼ˆä»£è¡¨æˆ‘ä»¬ä½¿ç”¨-DOM-APIï¼‰æ¥æ˜¾ç¤ºå…ƒç´ ã€‚è¿™æ•´ä¸ªè¿‡ç¨‹ç§°ä¸º-mountingã€‚"><a href="#å› ä¸ºè¿™æ˜¯-React-ç¬¬ä¸€æ¬¡æ¸²æŸ“å…ƒç´ ï¼ŒReact-å°†ä¼šä¸æµè§ˆå™¨è¿é€šï¼ˆä»£è¡¨æˆ‘ä»¬ä½¿ç”¨-DOM-APIï¼‰æ¥æ˜¾ç¤ºå…ƒç´ ã€‚è¿™æ•´ä¸ªè¿‡ç¨‹ç§°ä¸º-mountingã€‚" class="headerlink" title="å› ä¸ºè¿™æ˜¯ React ç¬¬ä¸€æ¬¡æ¸²æŸ“å…ƒç´ ï¼ŒReact å°†ä¼šä¸æµè§ˆå™¨è¿é€šï¼ˆä»£è¡¨æˆ‘ä»¬ä½¿ç”¨ DOM APIï¼‰æ¥æ˜¾ç¤ºå…ƒç´ ã€‚è¿™æ•´ä¸ªè¿‡ç¨‹ç§°ä¸º mountingã€‚"></a>å› ä¸ºè¿™æ˜¯ React ç¬¬ä¸€æ¬¡æ¸²æŸ“å…ƒç´ ï¼ŒReact å°†ä¼šä¸æµè§ˆå™¨è¿é€šï¼ˆä»£è¡¨æˆ‘ä»¬ä½¿ç”¨ DOM APIï¼‰æ¥æ˜¾ç¤ºå…ƒç´ ã€‚è¿™æ•´ä¸ªè¿‡ç¨‹ç§°ä¸º mountingã€‚</h3><h3 id="æ¥ä¸‹æ¥-React-è°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œç§°ä¸º-componentDidMountã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ï¼šåœ¨-DOM-ä¸Šåšä¸€äº›æˆ‘ä»¬ç°åœ¨çŸ¥é“çš„åœ¨æµè§ˆå™¨ä¸­å­˜åœ¨çš„ä¸œè¥¿ã€‚åœ¨æ­¤ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„-DOM-éƒ½æ˜¯è™šæ‹Ÿçš„ã€‚"><a href="#æ¥ä¸‹æ¥-React-è°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œç§°ä¸º-componentDidMountã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ï¼šåœ¨-DOM-ä¸Šåšä¸€äº›æˆ‘ä»¬ç°åœ¨çŸ¥é“çš„åœ¨æµè§ˆå™¨ä¸­å­˜åœ¨çš„ä¸œè¥¿ã€‚åœ¨æ­¤ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„-DOM-éƒ½æ˜¯è™šæ‹Ÿçš„ã€‚" class="headerlink" title="æ¥ä¸‹æ¥ React è°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œç§°ä¸º componentDidMountã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ï¼šåœ¨ DOM ä¸Šåšä¸€äº›æˆ‘ä»¬ç°åœ¨çŸ¥é“çš„åœ¨æµè§ˆå™¨ä¸­å­˜åœ¨çš„ä¸œè¥¿ã€‚åœ¨æ­¤ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ DOM éƒ½æ˜¯è™šæ‹Ÿçš„ã€‚"></a>æ¥ä¸‹æ¥ React è°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œç§°ä¸º componentDidMountã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ï¼šåœ¨ DOM ä¸Šåšä¸€äº›æˆ‘ä»¬ç°åœ¨çŸ¥é“çš„åœ¨æµè§ˆå™¨ä¸­å­˜åœ¨çš„ä¸œè¥¿ã€‚åœ¨æ­¤ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ DOM éƒ½æ˜¯è™šæ‹Ÿçš„ã€‚</h3><h3 id="ä¸€äº›ç»„ä»¶çš„æ•…äº‹åˆ°æ­¤ç»“æŸï¼Œå…¶ä»–ç»„ä»¶å¾—åˆ°å¸è½½æµè§ˆå™¨-DOM-ä¸­çš„å„ç§åŸå› ã€‚åœ¨åä¸€ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œä¼šè°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼ŒcomponentWillUnmountã€‚"><a href="#ä¸€äº›ç»„ä»¶çš„æ•…äº‹åˆ°æ­¤ç»“æŸï¼Œå…¶ä»–ç»„ä»¶å¾—åˆ°å¸è½½æµè§ˆå™¨-DOM-ä¸­çš„å„ç§åŸå› ã€‚åœ¨åä¸€ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œä¼šè°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼ŒcomponentWillUnmountã€‚" class="headerlink" title="ä¸€äº›ç»„ä»¶çš„æ•…äº‹åˆ°æ­¤ç»“æŸï¼Œå…¶ä»–ç»„ä»¶å¾—åˆ°å¸è½½æµè§ˆå™¨ DOM ä¸­çš„å„ç§åŸå› ã€‚åœ¨åä¸€ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œä¼šè°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼ŒcomponentWillUnmountã€‚"></a>ä¸€äº›ç»„ä»¶çš„æ•…äº‹åˆ°æ­¤ç»“æŸï¼Œå…¶ä»–ç»„ä»¶å¾—åˆ°å¸è½½æµè§ˆå™¨ DOM ä¸­çš„å„ç§åŸå› ã€‚åœ¨åä¸€ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œä¼šè°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼ŒcomponentWillUnmountã€‚</h3><h3 id="ä»»ä½•-mounted-çš„å…ƒç´ çš„çŠ¶æ€éƒ½å¯èƒ½ä¼šæ”¹å˜ã€‚è¯¥å…ƒç´ çš„çˆ¶çº§å¯èƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œmounted-çš„å…ƒç´ éƒ½å¯èƒ½æ¥æ”¶åˆ°ä¸åŒçš„å±æ€§é›†ã€‚React-çš„é­”åŠ›å°±æ˜¯è¿™å„¿ï¼Œæˆ‘ä»¬å®é™…ä¸Šéœ€è¦çš„æ­£æ˜¯-React-çš„è¿™ä¸€ç‚¹ï¼åœ¨è¿™ä¸€ç‚¹ä¹‹å‰ï¼Œè¯´å®è¯ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦-Reactã€‚"><a href="#ä»»ä½•-mounted-çš„å…ƒç´ çš„çŠ¶æ€éƒ½å¯èƒ½ä¼šæ”¹å˜ã€‚è¯¥å…ƒç´ çš„çˆ¶çº§å¯èƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œmounted-çš„å…ƒç´ éƒ½å¯èƒ½æ¥æ”¶åˆ°ä¸åŒçš„å±æ€§é›†ã€‚React-çš„é­”åŠ›å°±æ˜¯è¿™å„¿ï¼Œæˆ‘ä»¬å®é™…ä¸Šéœ€è¦çš„æ­£æ˜¯-React-çš„è¿™ä¸€ç‚¹ï¼åœ¨è¿™ä¸€ç‚¹ä¹‹å‰ï¼Œè¯´å®è¯ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦-Reactã€‚" class="headerlink" title="ä»»ä½• mounted çš„å…ƒç´ çš„çŠ¶æ€éƒ½å¯èƒ½ä¼šæ”¹å˜ã€‚è¯¥å…ƒç´ çš„çˆ¶çº§å¯èƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œmounted çš„å…ƒç´ éƒ½å¯èƒ½æ¥æ”¶åˆ°ä¸åŒçš„å±æ€§é›†ã€‚React çš„é­”åŠ›å°±æ˜¯è¿™å„¿ï¼Œæˆ‘ä»¬å®é™…ä¸Šéœ€è¦çš„æ­£æ˜¯ React çš„è¿™ä¸€ç‚¹ï¼åœ¨è¿™ä¸€ç‚¹ä¹‹å‰ï¼Œè¯´å®è¯ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ Reactã€‚"></a>ä»»ä½• mounted çš„å…ƒç´ çš„çŠ¶æ€éƒ½å¯èƒ½ä¼šæ”¹å˜ã€‚è¯¥å…ƒç´ çš„çˆ¶çº§å¯èƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œmounted çš„å…ƒç´ éƒ½å¯èƒ½æ¥æ”¶åˆ°ä¸åŒçš„å±æ€§é›†ã€‚React çš„é­”åŠ›å°±æ˜¯è¿™å„¿ï¼Œæˆ‘ä»¬å®é™…ä¸Šéœ€è¦çš„æ­£æ˜¯ React çš„è¿™ä¸€ç‚¹ï¼åœ¨è¿™ä¸€ç‚¹ä¹‹å‰ï¼Œè¯´å®è¯ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ Reactã€‚</h3><h3 id="ç»„ä»·çš„æ•…äº‹è¿˜åœ¨ç»§ç»­ï¼Œä½†æ˜¯åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£æˆ‘æ‰€è¯´çš„è¿™ç§çŠ¶æ€ã€‚"><a href="#ç»„ä»·çš„æ•…äº‹è¿˜åœ¨ç»§ç»­ï¼Œä½†æ˜¯åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£æˆ‘æ‰€è¯´çš„è¿™ç§çŠ¶æ€ã€‚" class="headerlink" title="ç»„ä»·çš„æ•…äº‹è¿˜åœ¨ç»§ç»­ï¼Œä½†æ˜¯åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£æˆ‘æ‰€è¯´çš„è¿™ç§çŠ¶æ€ã€‚"></a>ç»„ä»·çš„æ•…äº‹è¿˜åœ¨ç»§ç»­ï¼Œä½†æ˜¯åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£æˆ‘æ‰€è¯´çš„è¿™ç§çŠ¶æ€ã€‚</h3><h2 id="React-ç»„ä»¶å¯ä»¥å…·æœ‰ç§æœ‰çŠ¶æ€"><a href="#React-ç»„ä»¶å¯ä»¥å…·æœ‰ç§æœ‰çŠ¶æ€" class="headerlink" title="React ç»„ä»¶å¯ä»¥å…·æœ‰ç§æœ‰çŠ¶æ€"></a>React ç»„ä»¶å¯ä»¥å…·æœ‰ç§æœ‰çŠ¶æ€</h2><p>ä»¥ä¸‹åªé€‚ç”¨äºç±»ç»„ä»¶ã€‚æˆ‘æœ‰æ²¡æœ‰æåˆ°æœ‰äººå«è¡¨è±¡è€Œå·²çš„éƒ¨ä»¶ dumbï¼Ÿ</p><p>çŠ¶æ€ç±»æ˜¯ä»»ä½• React ç±»ç»„ä»¶ä¸­çš„ä¸€ä¸ªç‰¹æ®Šå­—æ®µã€‚React æ£€æµ‹æ¯ä¸€ä¸ªç»„ä»¶çŠ¶æ€çš„å˜åŒ–ï¼Œä½†æ˜¯ä¸ºäº† React æ›´åŠ æœ‰æ•ˆï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡ React çš„å¦ä¸€ä¸ª API æ”¹å˜çŠ¶æ€å­—æ®µï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦å­¦ä¹ çš„å¦ä¸€ä¸ª API â€”â€” <strong>this.setState</strong>ï¼š</p><pre><code class="javascript">class CounterButton extends React.Component {  state = {    clickCounter: 0,    currentTimestamp: new Date(),  };  handleClick = () =&gt; {    this.setState((prevState) =&gt; {     return { clickCounter: prevState.clickCounter + 1 };    });  };  componentDidMount() {   setInterval(() =&gt; {     this.setState({ currentTimestamp: new Date() })    }, 1000);  }  render() {    return (      &lt;div&gt;        &lt;button onClick={this.handleClick}&gt;Click&lt;/button&gt;        &lt;p&gt;Clicked: {this.state.clickCounter}&lt;/p&gt;        &lt;p&gt;Time: {this.state.currentTimestamp.toLocaleString()}&lt;/p&gt;      &lt;/div&gt;    );  }}// ä½¿ç”¨ReactDOM.render(&lt;CounterButton /&gt;, mountNode);</code></pre><p>ä¾‹ 13ï¼šsetState çš„ API<br>è¿™å¯èƒ½æ˜¯æœ€é‡è¦çš„ä¸€ä¸ªä¾‹å­å› ä¸ºè¿™å°†æ˜¯ä½ å®Œå…¨ç†è§£ React åŸºç¡€çŸ¥è¯†çš„æ–¹å¼ã€‚è¿™ä¸ªä¾‹å­ä¹‹åï¼Œè¿˜æœ‰ä¸€äº›å°äº‹æƒ…éœ€è¦å­¦ä¹ ï¼Œä½†ä»é‚£æ—¶èµ·ä¸»è¦æ˜¯ä½ å’Œä½ çš„ JavaScript æŠ€èƒ½ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¾‹ 13ï¼Œä»ç±»å¼€å§‹ï¼Œæ€»å…±æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ä¸€ä¸ªåˆå§‹åŒ–çš„æœ‰åˆå§‹å€¼ä¸º 0 çš„ clickCounter å¯¹è±¡å’Œä¸€ä¸ªä» new Date() å¼€å§‹çš„ currentTimestampã€‚</p><p>å¦ä¸€ä¸ªç±»æ˜¯ handleClick å‡½æ•°ï¼Œåœ¨æ¸²æŸ“æ–¹æ³•ä¸­æˆ‘ä»¬ç»™æŒ‰é’®å…ƒç´ ä¼ å…¥ onClick äº‹ä»¶ã€‚é€šè¿‡ä½¿ç”¨ setState çš„ handleClick æ–¹æ³•ä¿®æ”¹äº†ç»„ä»¶çš„å®ä¾‹çŠ¶æ€ã€‚è¦æ³¨æ„åˆ°è¿™ä¸€ç‚¹ã€‚</p><p>å¦ä¸€ä¸ªæˆ‘ä»¬ä¿®æ”¹çŠ¶æ€çš„åœ°æ–¹æ˜¯åœ¨ä¸€ä¸ªå†…éƒ¨çš„å®šæ—¶å™¨ï¼Œå¼€å§‹åœ¨å†…éƒ¨çš„ componentDidMount ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚å®ƒæ¯ç§’é’Ÿè°ƒç”¨ä¸€æ¬¡å¹¶ä¸”æ‰§è¡Œå¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨ this.setStateã€‚<br>åœ¨æ¸²æŸ“æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å…·æœ‰æ­£å¸¸è¯»è¯­æ³•çš„çŠ¶æ€ä¸Šçš„ä¸¤ä¸ªå±æ€§ï¼ˆæ²¡æœ‰ä¸“é—¨çš„ APIï¼‰ã€‚<br>ç°åœ¨ï¼Œæ³¨æ„æˆ‘ä»¬æ›´æ–°çŠ¶æ€ä½¿ç”¨ä¸¤ç§ä¸åŒçš„æ–¹å¼ï¼š </p><p>1.é€šè¿‡ä¼ å…¥ä¸€ä¸ªå‡½æ•°ç„¶åè¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚æˆ‘ä»¬åœ¨ handleClick å‡½æ•°å†…éƒ¨è¿™æ ·åšã€‚<br>2.é€šè¿‡ä¼ å…¥ä¸€ä¸ªæ­£åˆ™å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨åœ¨åŒºé—´å›è°ƒä¸­è¿™æ ·åšã€‚</p><p>è¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½†æ˜¯å½“ä½ åŒæ—¶è¯»å†™çŠ¶æ€æ—¶ï¼Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯é¦–é€‰çš„ï¼ˆæˆ‘ä»¬è¿™æ ·åšï¼‰ã€‚åœ¨åŒºé—´å›è°ƒä¸­ï¼Œæˆ‘ä»¬åªå‘çŠ¶æ€å†™å…¥è€Œä¸è¯»å®ƒã€‚å½“æœ‰é—®é¢˜æ—¶ï¼Œæ€»æ˜¯ä½¿ç”¨ç¬¬ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°è¯­æ³•ã€‚ä¼´éšç€ç«äº‰æ¡ä»¶è¿™æ›´å®‰å…¨ï¼Œå› ä¸º setstate å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ã€‚<br>æˆ‘ä»¬åº”è¯¥æ€æ ·æ›´æ–°çŠ¶æ€å‘¢ï¼Ÿæˆ‘ä»¬è¿”å›ä¸€ä¸ªæœ‰æˆ‘ä»¬æƒ³è¦æ›´æ–°çš„çš„å€¼çš„å¯¹è±¡ã€‚æ³¨æ„ï¼Œåœ¨è°ƒç”¨ setState æ—¶ï¼Œæˆ‘ä»¬å…¨éƒ¨éƒ½ä»çŠ¶æ€ä¸­ä¼ å…¥ä¸€ä¸ªå±æ€§æˆ–è€…å…¨éƒ½ä¸ã€‚è¿™å®Œå…¨æ˜¯å¯ä»¥çš„å› ä¸º setState å®é™…ä¸Š åˆå¹¶ äº†ä½ é€šè¿‡å®ƒï¼ˆè¿”å›å€¼çš„å‡½æ•°å‚æ•°ï¼‰ä¸ç°æœ‰çš„çŠ¶æ€ï¼Œæ‰€ä»¥ï¼Œæ²¡æœ‰æŒ‡å®šä¸€ä¸ªå±æ€§åœ¨è°ƒç”¨ setState æ—¶æ„å‘³ç€æˆ‘ä»¬ä¸å¸Œæœ›æ”¹å˜å±æ€§ï¼ˆä½†ä¸åˆ é™¤å®ƒï¼‰ã€‚<br><img src="https://user-gold-cdn.xitu.io/2017/8/14/3508772844b644f46f547ab3ba75e6a3?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="REACT"></p><h2 id="React-å°†è¦ååº”"><a href="#React-å°†è¦ååº”" class="headerlink" title="React å°†è¦ååº”"></a>React å°†è¦ååº”</h2><p>React çš„åå­—æ˜¯ä»çŠ¶æ€æ”¹å˜çš„<strong>ååº”</strong>ä¸­å¾—æ¥çš„ï¼ˆè™½ç„¶æ²¡æœ‰ååº”ï¼Œä½†ä¹Ÿæ˜¯åœ¨ä¸€ä¸ªæ—¶é—´è¡¨ä¸­ï¼‰ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç¬‘è¯ï¼ŒReact åº”è¯¥è¢«å‘½åä¸ºScheduleï¼</p><p>ç„¶è€Œï¼Œå½“ä»»ä½•ç»„ä»¶çš„çŠ¶æ€è¢«æ›´æ–°æ—¶ï¼Œæˆ‘ä»¬ç”¨è‚‰çœ¼è§‚å¯Ÿåˆ°çš„æ˜¯å¯¹è¯¥æ›´æ–°çš„ååº”ï¼Œå¹¶è‡ªåŠ¨åæ˜ äº†æµè§ˆå™¨ DOM ä¸­çš„æ›´æ–°ï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰ã€‚<br>å°†æ¸²æŸ“å‡½æ•°çš„è¾“å…¥è§†ä¸ºä¸¤ç§ï¼š</p><p>1.é€šè¿‡çˆ¶å…ƒç´ ä¼ å…¥çš„å±æ€§<br>2.ä»¥åŠå¯ä»¥éšæ—¶æ›´æ–°çš„å†…éƒ¨ç§æœ‰çŠ¶æ€</p><p>å½“æ¸²æŸ“å‡½æ•°çš„è¾“å…¥æ”¹å˜æ—¶ï¼Œè¾“å‡ºå¯èƒ½ä¹Ÿä¼šæ”¹å˜ã€‚<br>React ä¿å­˜äº†æ¸²æŸ“çš„å†å²è®°å½•ï¼Œå½“å®ƒçœ‹åˆ°ä¸€ä¸ªæ¸²æŸ“ä¸å‰ä¸€ä¸ªä¸åŒæ—¶ï¼Œå®ƒå°†è®¡ç®—å®ƒä»¬ä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶å°†å…¶æœ‰æ•ˆåœ°è½¬æ¢ä¸ºåœ¨ DOM ä¸­æ‰§è¡Œçš„å®é™… DOM æ“ä½œã€‚</p><h2 id="React-æ˜¯ä½ çš„ä»£ç "><a href="#React-æ˜¯ä½ çš„ä»£ç " class="headerlink" title="React æ˜¯ä½ çš„ä»£ç "></a>React æ˜¯ä½ çš„ä»£ç </h2><p>æ‚¨å¯ä»¥å°† React çœ‹ä½œæ˜¯æˆ‘ä»¬ç”¨æ¥ä¸æµè§ˆå™¨é€šä¿¡çš„ä»£ç†ã€‚ä»¥ä¸Šé¢çš„å½“å‰æ—¶é—´æˆ³æ˜¾ç¤ºä¸ºä¾‹ã€‚å–ä»£æ¯ä¸€ç§’æˆ‘ä»¬éƒ½éœ€è¦æ‰‹åŠ¨å»æµè§ˆå™¨è°ƒç”¨ DOM API æ“ä½œæ¥æŸ¥æ‰¾å’Œæ›´æ–° <strong>p#timestamp</strong> å…ƒç´ ï¼Œæˆ‘ä»¬ä»…ä»…æ”¹å˜ç»„ä»¶çš„çŠ¶æ€å±æ€§ï¼ŒReact åšçš„å·¥ä½œä»£è¡¨æˆ‘ä»¬ä¸æµè§ˆå™¨çš„é€šä¿¡ã€‚æˆ‘ç›¸ä¿¡è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ React è¿™ä¹ˆå—æ¬¢è¿çš„çœŸæ­£åŸå› ï¼›æˆ‘ä»¬åªæ˜¯ä¸å–œæ¬¢å’Œæµè§ˆå™¨å…ˆç”Ÿè°ˆè¯ï¼ˆä»¥åŠå®ƒæ‰€è¯´çš„ DOM è¯­è¨€çš„å¾ˆå¤šæ–¹è¨€ï¼‰ï¼Œå¹¶ä¸” React è‡ªæ„¿ä¼ é€’ç»™æˆ‘ä»¬ï¼Œå…è´¹çš„ï¼</p><h2 id="æ¯ä¸€ä¸ª-React-ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬-2-éƒ¨åˆ†"><a href="#æ¯ä¸€ä¸ª-React-ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬-2-éƒ¨åˆ†" class="headerlink" title="æ¯ä¸€ä¸ª React ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬ 2 éƒ¨åˆ†"></a>æ¯ä¸€ä¸ª React ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬ 2 éƒ¨åˆ†</h2><blockquote><ul><li>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä¸€ä¸ªç»„ä»¶çš„çŠ¶æ€ï¼Œå½“è¯¥çŠ¶æ€å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹å…³äºè¿™ä¸ªè¿‡ç¨‹çš„æœ€åå‡ ä¸ªæ¦‚å¿µã€‚</li><li>å½“ç»„ä»¶çš„çŠ¶æ€è¢«æ›´æ–°æ—¶ï¼Œæˆ–è€…å®ƒçš„çˆ¶è¿›ç¨‹å†³å®šæ›´æ”¹å®ƒä¼ é€’ç»™ç»„ä»¶çš„å±æ€§æ—¶ï¼Œç»„ä»¶å¯èƒ½éœ€è¦é‡æ–°æ¸²æŸ“ã€‚</li><li>å¦‚æœåè€…å‘ç”Ÿï¼ŒReact ä¼šè°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼šcomponentWillReceivePropsã€‚</li><li>å¦‚æœçŠ¶æ€å¯¹è±¡æˆ–ä¼ é€’çš„å±æ€§æ”¹å˜äº†ï¼ŒReact æœ‰ä¸€ä¸ªé‡è¦çš„å†³å®šè¦åšï¼šç»„ä»¶æ˜¯å¦åº”è¯¥åœ¨ DOM ä¸­æ›´æ–°ï¼Ÿè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒè°ƒç”¨å¦ä¸€ä¸ªé‡è¦çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³• shouldComponentUpdate çš„åŸå›  ã€‚æ­¤æ–¹æ³•æ˜¯ä¸€ä¸ªå®é™…é—®é¢˜ï¼Œå› æ­¤ï¼Œå¦‚æœéœ€è¦è‡ªè¡Œå®šåˆ¶æˆ–ä¼˜åŒ–æ¸²æŸ“è¿‡ç¨‹ï¼Œåˆ™å¿…é¡»é€šè¿‡è¿”å› true æˆ– false æ¥å›ç­”è¿™ä¸ªé—®é¢˜ã€‚</li><li>å¦‚æœæ²¡æœ‰è‡ªå®šä¹‰ shouldComponentUpdateï¼ŒReact çš„é»˜è®¤äº‹ä»¶åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½èƒ½å¤„ç†çš„å¾ˆå¥½ã€‚</li><li>é¦–å…ˆï¼Œè¿™ä¸ªæ—¶å€™ä¼šè°ƒç”¨å¦ä¸€ç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼šcomponentWillUpdateã€‚ç„¶åï¼ŒReact å°†è®¡ç®—æ–°æ¸²æŸ“è¿‡çš„è¾“å‡ºï¼Œå¹¶å°†å…¶ä¸æœ€åæ¸²æŸ“çš„è¾“å‡ºè¿›è¡Œå¯¹æ¯”ã€‚</li><li>å¦‚æœæ¸²æŸ“è¿‡çš„è¾“å‡ºå’Œä¹‹å‰çš„ç›¸åŒï¼ŒReact ä¸è¿›è¡Œå¤„ç†ï¼ˆä¸éœ€è¦å’Œæµè§ˆå™¨å…ˆç”Ÿå¯¹è¯ï¼‰ã€‚</li><li>å¦‚æœæœ‰ä¸åŒçš„åœ°æ–¹ï¼ŒReact å°†ä¸åŒä¼ è¾¾ç»™æµè§ˆå™¨ï¼Œåƒæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„é‚£æ ·ã€‚</li><li>åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œä¸€æ—¦ä¸€ä¸ªæ›´æ–°ç¨‹åºå‘ç”Ÿäº†ï¼Œæ— è®ºä»¥ä½•ç§æ–¹å¼ï¼ˆå³ä½¿æœ‰ç›¸åŒçš„è¾“å‡ºï¼‰ï¼ŒReact ä¼šè°ƒç”¨æœ€åçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼šcomponentDidUpdateã€‚</li></ul></blockquote><p>ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ˜¯é€ƒç”Ÿèˆ±å£ã€‚å¦‚æœä½ æ²¡æœ‰åšä»€ä¹ˆç‰¹åˆ«çš„äº‹æƒ…ï¼Œä½ å¯ä»¥åœ¨æ²¡æœ‰å®ƒä»¬çš„æƒ…å†µä¸‹åˆ›å»ºå®Œæ•´çš„åº”ç”¨ç¨‹åºã€‚å®ƒä»¬éå¸¸æ–¹ä¾¿åœ°åˆ†æåº”ç”¨ç¨‹åºä¸­æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œå¹¶è¿›ä¸€æ­¥ä¼˜åŒ– React æ›´æ–°çš„æ€§èƒ½ã€‚</p><p>ä¿¡ä¸ä¿¡ç”±ä½ ï¼Œé€šè¿‡ä¸Šé¢æ‰€å­¦çš„çŸ¥è¯†ï¼ˆæˆ–éƒ¨åˆ†çŸ¥è¯†ï¼‰ï¼Œä½ å¯ä»¥å¼€å§‹åˆ›å»ºä¸€äº›æœ‰è¶£çš„ React åº”ç”¨ç¨‹åºã€‚å¦‚æœä½ æ¸´æœ›æ›´å¤šï¼Œçœ‹çœ‹æˆ‘çš„ Pluralsight çš„ <a href="https://www.pluralsight.com/courses/react-js-getting-started?aid=701j0000001heIoAAI&amp;promo=&amp;oid=&amp;utm_source=google&amp;utm_medium=ppc&amp;utm_campaign=US_Dynamic&amp;utm_content=&amp;utm_term=&amp;gclid=CNOAj_2-j9UCFUpNfgod4V0Fdg" target="_blank" rel="noopener">React.js å…¥é—¨è¯¾ç¨‹</a>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5åˆ†é’Ÿä¸Šæ‰‹TypeScript</title>
      <link href="/2018/03/02/Ts/5%E5%88%86%E9%92%9F%E4%B8%8A%E6%89%8BTypeScript/"/>
      <url>/2018/03/02/Ts/5%E5%88%86%E9%92%9F%E4%B8%8A%E6%89%8BTypeScript/</url>
      
        <content type="html"><![CDATA[<h1 id="è®©æˆ‘ä»¬ä½¿ç”¨TypeScriptæ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„Webåº”ç”¨ã€‚"><a href="#è®©æˆ‘ä»¬ä½¿ç”¨TypeScriptæ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„Webåº”ç”¨ã€‚" class="headerlink" title="è®©æˆ‘ä»¬ä½¿ç”¨TypeScriptæ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„Webåº”ç”¨ã€‚"></a>è®©æˆ‘ä»¬ä½¿ç”¨TypeScriptæ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„Webåº”ç”¨ã€‚</h1><h2 id="å®‰è£…TypeScript"><a href="#å®‰è£…TypeScript" class="headerlink" title="å®‰è£…TypeScript"></a>å®‰è£…TypeScript</h2><p>æœ‰ä¸¤ç§ä¸»è¦çš„æ–¹å¼æ¥è·å–TypeScriptå·¥å…·ï¼š</p><blockquote><ul><li>é€šè¿‡npmï¼ˆNode.jsåŒ…ç®¡ç†å™¨ï¼‰</li><li>å®‰è£…Visual Studioçš„TypeScriptæ’ä»¶</li></ul></blockquote><p>Visual Studio 2017å’ŒVisual Studio 2015 Update 3é»˜è®¤åŒ…å«äº†TypeScriptã€‚ å¦‚æœä½ çš„Visual Studioè¿˜æ²¡æœ‰å®‰è£…TypeScriptï¼Œä½ å¯ä»¥<a href="https://www.tslang.cn/#download-links" target="_blank" rel="noopener">ä¸‹è½½</a>å®ƒã€‚</p><p>é’ˆå¯¹ä½¿ç”¨npmçš„ç”¨æˆ·ï¼š</p><pre><code class="javascript">npm install -g typescript</code></pre><h2 id="æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªTypeScriptæ–‡ä»¶"><a href="#æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªTypeScriptæ–‡ä»¶" class="headerlink" title="æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªTypeScriptæ–‡ä»¶"></a>æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªTypeScriptæ–‡ä»¶</h2><p>åœ¨ç¼–è¾‘å™¨ï¼Œå°†ä¸‹é¢çš„ä»£ç è¾“å…¥åˆ°greeter.tsæ–‡ä»¶é‡Œï¼š</p><pre><code class="javascript">function greeter(person) {    return &quot;Hello, &quot; + person;}let user = &quot;Jane User&quot;;document.body.innerHTML = greeter(user);</code></pre><a id="more"></a><h2 id="ç¼–è¯‘ä»£ç "><a href="#ç¼–è¯‘ä»£ç " class="headerlink" title="ç¼–è¯‘ä»£ç "></a>ç¼–è¯‘ä»£ç </h2><p>æˆ‘ä»¬ä½¿ç”¨äº†<strong>.ts</strong>æ‰©å±•åï¼Œä½†æ˜¯è¿™æ®µä»£ç ä»…ä»…æ˜¯JavaScriptè€Œå·²ã€‚ ä½ å¯ä»¥ç›´æ¥ä»ç°æœ‰çš„JavaScriptåº”ç”¨é‡Œå¤åˆ¶/ç²˜è´´è¿™æ®µä»£ç ã€‚</p><p>åœ¨å‘½ä»¤è¡Œä¸Šï¼Œè¿è¡ŒTypeScriptç¼–è¯‘å™¨ï¼š</p><pre><code class="javascript">tsc greeter.ts</code></pre><p>è¾“å‡ºç»“æœä¸ºä¸€ä¸ª<strong>greeter.js</strong>æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†å’Œè¾“å…¥æ–‡ä»¶ä¸­ç›¸åŒçš„JavsScriptä»£ç ã€‚ ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œè¿™ä¸ªä½¿ç”¨TypeScriptå†™çš„JavaScriptåº”ç”¨äº†ï¼<br>æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹<strong>TypeScript</strong>å·¥å…·å¸¦æ¥çš„é«˜çº§åŠŸèƒ½ã€‚ ç»™ <strong>person</strong>å‡½æ•°çš„å‚æ•°æ·»åŠ : <strong>string</strong>ç±»å‹æ³¨è§£ï¼Œå¦‚ä¸‹ï¼š</p><pre><code class="javascript">function greeter(person: string) {    return &quot;Hello, &quot; + person;}let user = &quot;Jane User&quot;;document.body.innerHTML = greeter(user);</code></pre><h2 id="ç±»å‹æ³¨è§£"><a href="#ç±»å‹æ³¨è§£" class="headerlink" title="ç±»å‹æ³¨è§£"></a>ç±»å‹æ³¨è§£</h2><p>TypeScripté‡Œçš„ç±»å‹æ³¨è§£æ˜¯ä¸€ç§è½»é‡çº§çš„ä¸ºå‡½æ•°æˆ–å˜é‡æ·»åŠ çº¦æŸçš„æ–¹å¼ã€‚ åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å¸Œæœ› greeterå‡½æ•°æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ã€‚ ç„¶åå°è¯•æŠŠ <strong>greeter</strong>çš„è°ƒç”¨æ”¹æˆä¼ å…¥ä¸€ä¸ªæ•°ç»„:</p><pre><code class="javascript">function greeter(person: string) {    return &quot;Hello, &quot; + person;}let user = [0, 1, 2];document.body.innerHTML = greeter(user);</code></pre><p>é‡æ–°ç¼–è¯‘ï¼Œä½ ä¼šçœ‹åˆ°äº§ç”Ÿäº†ä¸€ä¸ªé”™è¯¯ã€‚</p><pre><code class="javascript">greeter.ts(7,26): error TS2345: Argument of type &#39;number[]&#39; is not assignable to parameter of type &#39;string&#39;.</code></pre><p>ç±»ä¼¼åœ°ï¼Œå°è¯•åˆ é™¤<strong>greeter</strong>è°ƒç”¨çš„æ‰€æœ‰å‚æ•°ã€‚ TypeScriptä¼šå‘Šè¯‰ä½ ä½¿ç”¨äº†éæœŸæœ›ä¸ªæ•°çš„å‚æ•°è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ã€‚ åœ¨è¿™ä¸¤ç§æƒ…å†µä¸­ï¼ŒTypeScriptæä¾›äº†é™æ€çš„ä»£ç åˆ†æï¼Œå®ƒå¯ä»¥åˆ†æä»£ç ç»“æ„å’Œæä¾›çš„ç±»å‹æ³¨è§£ã€‚</p><p>è¦æ³¨æ„çš„æ˜¯å°½ç®¡æœ‰é”™è¯¯ï¼Œ<strong>greeter.js</strong>æ–‡ä»¶è¿˜æ˜¯è¢«åˆ›å»ºäº†ã€‚ å°±ç®—ä½ çš„ä»£ç é‡Œæœ‰é”™è¯¯ï¼Œä½ ä»ç„¶å¯ä»¥ä½¿ç”¨TypeScriptã€‚ä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTypeScriptä¼šè­¦å‘Šä½ ä»£ç å¯èƒ½ä¸ä¼šæŒ‰é¢„æœŸæ‰§è¡Œ</p><h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><p>è®©æˆ‘ä»¬å¼€å‘è¿™ä¸ªç¤ºä¾‹åº”ç”¨ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æ¥å£æ¥æè¿°ä¸€ä¸ªæ‹¥æœ‰<strong>firstName</strong>å’Œ<strong>lastName</strong>å­—æ®µçš„å¯¹è±¡ã€‚ åœ¨TypeScripté‡Œï¼Œåªåœ¨ä¸¤ä¸ªç±»å‹å†…éƒ¨çš„ç»“æ„å…¼å®¹é‚£ä¹ˆè¿™ä¸¤ä¸ªç±»å‹å°±æ˜¯å…¼å®¹çš„ã€‚ è¿™å°±å…è®¸æˆ‘ä»¬åœ¨å®ç°æ¥å£æ—¶å€™åªè¦ä¿è¯åŒ…å«äº†æ¥å£è¦æ±‚çš„ç»“æ„å°±å¯ä»¥ï¼Œè€Œä¸å¿…æ˜ç¡®åœ°ä½¿ç”¨ implementsè¯­å¥ã€‚</p><pre><code class="javascript">interface Person {    firstName: string;    lastName: string;}function greeter(person: Person) {    return &quot;Hello, &quot; + person.firstName + &quot; &quot; + person.lastName;}let user = { firstName: &quot;Jane&quot;, lastName: &quot;User&quot; };document.body.innerHTML = greeter(user);</code></pre><h2 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h2><p>æœ€åï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ç±»æ¥æ”¹å†™è¿™ä¸ªä¾‹å­ã€‚ TypeScriptæ”¯æŒJavaScriptçš„æ–°ç‰¹æ€§ï¼Œæ¯”å¦‚æ”¯æŒåŸºäºç±»çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚</p><p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<strong>Student</strong>ç±»ï¼Œå®ƒå¸¦æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°å’Œä¸€äº›å…¬å…±å­—æ®µã€‚ æ³¨æ„ç±»å’Œæ¥å£å¯ä»¥ä¸€èµ·å…±ä½œï¼Œç¨‹åºå‘˜å¯ä»¥è‡ªè¡Œå†³å®šæŠ½è±¡çš„çº§åˆ«ã€‚</p><p>è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ„é€ å‡½æ•°çš„å‚æ•°ä¸Šä½¿ç”¨<strong>public</strong>ç­‰åŒäºåˆ›å»ºäº†åŒåçš„æˆå‘˜å˜é‡ã€‚</p><pre><code class="javascript">class Student {    fullName: string;    constructor(public firstName, public middleInitial, public lastName) {        this.fullName = firstName + &quot; &quot; + middleInitial + &quot; &quot; + lastName;    }}interface Person {    firstName: string;    lastName: string;}function greeter(person : Person) {    return &quot;Hello, &quot; + person.firstName + &quot; &quot; + person.lastName;}let user = new Student(&quot;Jane&quot;, &quot;M.&quot;, &quot;User&quot;);document.body.innerHTML = greeter(user);</code></pre><p>é‡æ–°è¿è¡Œ<strong>tsc greeter.ts</strong>ï¼Œä½ ä¼šçœ‹åˆ°ç”Ÿæˆçš„JavaScriptä»£ç å’ŒåŸå…ˆçš„ä¸€æ ·ã€‚ TypeScripté‡Œçš„ç±»åªæ˜¯JavaScripté‡Œå¸¸ç”¨çš„åŸºäºåŸå‹é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ç®€å†™ã€‚</p><h2 id="è¿è¡ŒTypeScript-Webåº”ç”¨"><a href="#è¿è¡ŒTypeScript-Webåº”ç”¨" class="headerlink" title="è¿è¡ŒTypeScript Webåº”ç”¨"></a>è¿è¡ŒTypeScript Webåº”ç”¨</h2><p>åœ¨<strong>greeter.html</strong>é‡Œè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><pre><code class="javascript">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;&lt;title&gt;TypeScript Greeter&lt;/title&gt;&lt;/head&gt;    &lt;body&gt;        &lt;script src=&quot;greeter.js&quot;&gt;&lt;/script&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p>åœ¨æµè§ˆå™¨é‡Œæ‰“å¼€greeter.htmlè¿è¡Œè¿™ä¸ªåº”ç”¨ï¼<br>å¯é€‰åœ°ï¼šåœ¨Visual Studioé‡Œæ‰“å¼€<strong>greeter.ts</strong>æˆ–è€…æŠŠä»£ç å¤åˆ¶åˆ°TypeScript playgroundã€‚ å°†é¼ æ ‡æ‚¬åœåœ¨æ ‡è¯†ç¬¦ä¸ŠæŸ¥çœ‹å®ƒä»¬çš„ç±»å‹ã€‚ æ³¨æ„åœ¨æŸäº›æƒ…å†µä¸‹å®ƒä»¬çš„ç±»å‹å¯ä»¥è¢«è‡ªåŠ¨åœ°æ¨æ–­å‡ºæ¥ã€‚ é‡æ–°è¾“å…¥ä¸€ä¸‹æœ€åä¸€è¡Œä»£ç ï¼Œçœ‹ä¸€ä¸‹è‡ªåŠ¨è¡¥å…¨åˆ—è¡¨å’Œå‚æ•°åˆ—è¡¨ï¼Œå®ƒä»¬ä¼šæ ¹æ®DOMå…ƒç´ ç±»å‹è€Œå˜åŒ–ã€‚ å°†å…‰æ ‡æ”¾åœ¨ greeterå‡½æ•°ä¸Šï¼Œç‚¹å‡»F12å¯ä»¥è·Ÿè¸ªåˆ°å®ƒçš„å®šä¹‰ã€‚ è¿˜æœ‰ä¸€ç‚¹ï¼Œä½ å¯ä»¥å³é”®ç‚¹å‡»æ ‡è¯†ï¼Œä½¿ç”¨é‡æ„åŠŸèƒ½æ¥é‡å‘½åã€‚</p><p>è¿™äº›ç±»å‹ä¿¡æ¯ä»¥åŠå·¥å…·å¯ä»¥å¾ˆå¥½çš„å’ŒJavaScriptä¸€èµ·å·¥ä½œã€‚</p><p><a href="https://www.tslang.cn/docs/handbook/typescript-in-5-minutes.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-nativeä½¿ç”¨è¿‡ç¨‹ä¸­çš„æŠ¥é”™ï¼ˆæŒç»­æ›´æ–°ä¸­ï¼‰</title>
      <link href="/2018/03/01/react-native/react-native%E4%BD%BF%E7%94%A8%E8%BF%87%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%8A%A5%E9%94%99%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89/"/>
      <url>/2018/03/01/react-native/react-native%E4%BD%BF%E7%94%A8%E8%BF%87%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%8A%A5%E9%94%99%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="ReactNative-é‡åˆ°çš„æŠ¥é”™"><a href="#ReactNative-é‡åˆ°çš„æŠ¥é”™" class="headerlink" title="ReactNative é‡åˆ°çš„æŠ¥é”™"></a>ReactNative é‡åˆ°çš„æŠ¥é”™</h1><h2 id="react-native-çŸ¢é‡åº“-react-native-vector-iconsçš„æŠ¥é”™è§£å†³"><a href="#react-native-çŸ¢é‡åº“-react-native-vector-iconsçš„æŠ¥é”™è§£å†³" class="headerlink" title="react-native çŸ¢é‡åº“ react-native-vector-iconsçš„æŠ¥é”™è§£å†³"></a>react-native çŸ¢é‡åº“ react-native-vector-iconsçš„æŠ¥é”™è§£å†³</h2><p><img src="http://img.blog.csdn.net/20180206155016745?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzc0ODEwODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="imgerror"><br>è§£å†³æ–¹æ³•ï¼šå°†é¡¹ç›®ç›®å½•ä¸‹ node_modules/react-native/local-cli/core/<strong>fixtures</strong>/files/package.jsonåˆ é™¤<br><a id="more"></a><br>å¦‚æœè¿˜å‡ºç°è¿™ä¸ªé”™è¯¯<br><img src="http://img.blog.csdn.net/20180206155244544?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzc0ODEwODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="imgerror1"></p><p>è§£å†³æ–¹æ¡ˆï¼šåˆ é™¤é‡æ–°å®‰è£…react-native-vector-icons å®‰è£…å®Œæˆåæ‰§è¡Œ<br> react-native link ç»§ç»­ä¿®æ”¹é—®é¢˜1çš„é”™è¯¯</p><h2 id="unRecognized-font-family-â€˜XXXXXâ€™"><a href="#unRecognized-font-family-â€˜XXXXXâ€™" class="headerlink" title="unRecognized font family â€˜XXXXXâ€™"></a>unRecognized font family â€˜XXXXXâ€™</h2><p>è§£å†³æ–¹æ¡ˆï¼š<br><img src="http://img.blog.csdn.net/20180206155743569?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzc0ODEwODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="imgerror2"></p><h2 id="react-nativeå¼€å‘è¸©å‘ä¹‹-iosä¸Šreact-native-vector-icons-çš„errorï¼šunRecognized-font-family-â€˜FontAwesomeâ€™"><a href="#react-nativeå¼€å‘è¸©å‘ä¹‹-iosä¸Šreact-native-vector-icons-çš„errorï¼šunRecognized-font-family-â€˜FontAwesomeâ€™" class="headerlink" title="react-nativeå¼€å‘è¸©å‘ä¹‹ iosä¸Šreact-native-vector-icons çš„errorï¼šunRecognized font family â€˜FontAwesomeâ€™"></a>react-nativeå¼€å‘è¸©å‘ä¹‹ iosä¸Šreact-native-vector-icons çš„errorï¼šunRecognized font family â€˜FontAwesomeâ€™</h2><p><img src="http://img.blog.csdn.net/20170405222455738?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamlhbmdjczUyMA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="imgerror3"><br>æ¥ä¸‹æ¥è§£é‡Šä¸€ä¸‹ï¼Œé¦–å…ˆçœ‹ç¬¬ä¸€æ­¥ï¼šæŠŠnode_modules/react-native-vector-iconsä¸‹çš„fontsæ–‡ä»¶æ·»åŠ åˆ°å·¥ç¨‹ä¸­ï¼Œè¿™æ—¶å€™å¾€å¾€å¿½ç•¥äº†ä¸€ä¸ªé‡ç‚¹ï¼Œåé¢é‚£ä¸€å¥</p><pre><code class="javascript">Make sure your app is checked under â€œAdd to targetsâ€ and that â€œCreate groupsâ€ is checked if you add the whole folder</code></pre><p>è¿™ä¸€å¥å¾ˆå…³é”®ï¼Œæ„æ€æ˜¯ç¡®è®¤å¿…é¡»è¦ç¡®è®¤æ˜¯Add to targetså’ŒCreate groupsï¼Œä¸€å¼€å§‹æˆ‘æ˜¯ç›´æ¥å³é”®æŠŠfontsç›®å½•addåˆ°å·¥ç¨‹çš„ï¼Œæ ¹æœ¬æ²¡çœ‹åˆ°è¿™ä¸¤ä¸ªç©æ„ï¼Œç»“æœå°±æ˜¯å¤±è´¥ï¼Œæœ‰ç‚¹å¥‡æ€ªï¼Œåæ¥æˆ‘ä»”ç»†çœ‹äº†ä¸€ä¸‹è¿™ä¸ªæ­¥éª¤æè¿°ï¼Œ</p><pre><code class="javascript">drag the folder Fonts to your project in Xcode</code></pre><h2 id="ReactNative-IosæŠ¥å‡º-â€˜React-RCTBundleURLProvider-hâ€™-file-not-foundé”™è¯¯"><a href="#ReactNative-IosæŠ¥å‡º-â€˜React-RCTBundleURLProvider-hâ€™-file-not-foundé”™è¯¯" class="headerlink" title="ReactNative IosæŠ¥å‡º â€˜React/RCTBundleURLProvider.hâ€™ file not foundé”™è¯¯"></a>ReactNative IosæŠ¥å‡º â€˜React/RCTBundleURLProvider.hâ€™ file not foundé”™è¯¯</h2><p>æˆ‘åœ¨åˆ›å»ºreact-nativeé¡¹ç›®æ—¶  npmäº†ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“  ç»“æœä¸€æ‰“å¼€ xcode ç«Ÿç„¶æŠ¥é”™ React/RCTBundleURLProvider.hâ€™ file not foundï¼›</p><p>ç„¶å æˆ‘è¯•äº†å„ç§ç½‘ä¸Šçš„æ–¹æ³•è¯•äº†ä¸€éï¼Œ è¿˜æ˜¯ä¸è¡Œ</p><p>å°±åœ¨æˆ‘è¦æ”¾å¼ƒçš„æ—¶å€™ ï¼Œçªç„¶æƒ³åˆ°æŠŠç½‘ä¸Šçš„æ–¹æ³• ç»“åˆä¸€ä¸‹ è¯•è¯•ï¼Œç»“æœå¥½äº†ã€‚</p><p>ä»¥ä¸‹å°±æ˜¯æˆ‘çš„è§£å†³æ–¹æ³•</p><blockquote><p>1.æ‰“å¼€Macé‡Œé¢çš„ç»ˆç«¯ï¼Œè¿›å…¥é¡¹ç›®æ‰€åœ¨çš„æ–‡ä»¶å¤¹ç›®å½•ï¼›<br>2.æŠŠé¡¹ç›®é‡Œé¢çš„ node_modules æ–‡ä»¶å¤¹åˆ é™¤æ‰ï¼Œç„¶åæ‰§è¡Œ npm install å‘½ä»¤<br>3.npm installå®‰è£…å®Œæˆåï¼Œ æ‰§è¡Œreact-native upgradeå‘½ä»¤<br>4.npm start<br>5.æ‰“å¼€xcode (å¦‚æœè¿˜æŠ¥é”™)<br>6.å·¦ä¾§ç‚¹å‡»è·Ÿé¡¹ç›®ç›®å½• -&gt; é€‰æ‹©å³ä¾§ Build Settings -&gt; é€‰æ‹© All &amp; Combined -&gt; æœç´¢æ¡†è¾“å…¥ Always Search User Paths -&gt; å°† Always Search User Paths è®¾ç½®ä¸º Yes -&gt; Clean -&gt; Build<br><img src="https://img.hacpai.com/file/2017/6/5951e4a8885d4c37a63a0a275f893c99-image.png" alt="imgerror4"></p></blockquote><h2 id="RN-SectionList-é‡åˆ°-missing-keys-for-items-make-sure-to-specify-a-key-property-on-each-item-çš„-é—®é¢˜è§£å†³"><a href="#RN-SectionList-é‡åˆ°-missing-keys-for-items-make-sure-to-specify-a-key-property-on-each-item-çš„-é—®é¢˜è§£å†³" class="headerlink" title="RN SectionList é‡åˆ° missing keys for items, make sure to specify a key property on each item çš„ é—®é¢˜è§£å†³"></a>RN SectionList é‡åˆ° missing keys for items, make sure to specify a key property on each item çš„ é—®é¢˜è§£å†³</h2><p><img src="http://img.blog.csdn.net/20180107172034312?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzc0ODEwODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="imgerror5"><br>å®ƒè­¦å‘Šæˆ‘ä»¬æ¯ä¸ªitem è¦æœ‰ä¸åŒçš„key</p><p>é»˜è®¤æƒ…å†µä¸‹æ¯è¡Œéƒ½éœ€è¦æä¾›ä¸€ä¸ªä¸é‡å¤çš„keyå±æ€§ã€‚ä½ ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªkeyExtractorå‡½æ•°æ¥ç”Ÿæˆkeyã€‚<br>æŠŠè¿™ä¸ªå±æ€§æ·»åŠ åˆ°<br> <SectionList/> é‡Œé¢</p><pre><code class="javascript">       keyExtractor = {this._extraUniqueKey}            _extraUniqueKey(item ,index){        eturn &quot;index&quot;+index+item;        }     </code></pre><p>è¿™æ˜¯æ¯ä¸ªitemè¦è®¾ç½®key, åŒæ ·æ¯ä¸ªå­æ§ä»¶ä¹Ÿä¸èƒ½æ”¾è¿‡ï¼Œ ä¸€å®šè¦è®¾ç½®å®ƒçš„keyï¼Œ è¦ä¸ç„¶è¿™ä¸ªå±é»„è‰²ä¸€ç›´ä¼´ç€ä½  å¤šçƒ¦~~</p><h2 id="react-native-è¿è¡Œæ—¶ï¼Œå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š"><a href="#react-native-è¿è¡Œæ—¶ï¼Œå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š" class="headerlink" title="react-native è¿è¡Œæ—¶ï¼Œå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š"></a>react-native è¿è¡Œæ—¶ï¼Œå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š</h2><p><img src="https://upload-images.jianshu.io/upload_images/5227057-07eba5a0ae5b9f0c.png" alt="imgerror6"><br>é¦–å…ˆè¯•è¯•react-native start æˆ– npm start çœ‹çœ‹æ˜¯å¦æŠ¥é”™ï¼Œå¦‚æœæŠ¥é”™å‡ºç°ERROR:Metro Bundler canâ€™t listen on port 8081</p><p>åˆ™æ˜¯8081ç«¯å£å·è¢«å ç”¨</p><p>è§£å†³æ–¹æ¡ˆï¼šæ‰§è¡Œsudo lsof -i :8081  kill -9 è¿›ç¨‹å·</p><p><img src="https://upload-images.jianshu.io/upload_images/5227057-e66a166a6e956daa.png" alt="imgerrot7"></p><h2 id="æ›´å¤šReactNativeé—®é¢˜æ€»ç»“é›†åˆï¼Œè¯·ç§»æ­¥å¤§ä½¬é“¾æ¥"><a href="#æ›´å¤šReactNativeé—®é¢˜æ€»ç»“é›†åˆï¼Œè¯·ç§»æ­¥å¤§ä½¬é“¾æ¥" class="headerlink" title="æ›´å¤šReactNativeé—®é¢˜æ€»ç»“é›†åˆï¼Œè¯·ç§»æ­¥å¤§ä½¬é“¾æ¥"></a>æ›´å¤šReactNativeé—®é¢˜æ€»ç»“é›†åˆï¼Œè¯·ç§»æ­¥å¤§ä½¬é“¾æ¥</h2><p><a href="https://www.jianshu.com/p/98c8f2a970eb" target="_blank" rel="noopener">react-native é—®é¢˜</a></p>]]></content>
      
      
      <categories>
          
          <category> react-native </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>reactå¼€å‘ç¯å¢ƒæ­å»º</title>
      <link href="/2018/02/28/React/react%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2018/02/28/React/react%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½¿ç”¨creat-react-appæ­å»ºåŸºäºwebpackçš„reactå¼€å‘ç¯å¢ƒ"><a href="#ä½¿ç”¨creat-react-appæ­å»ºåŸºäºwebpackçš„reactå¼€å‘ç¯å¢ƒ" class="headerlink" title="ä½¿ç”¨creat-react-appæ­å»ºåŸºäºwebpackçš„reactå¼€å‘ç¯å¢ƒ"></a>ä½¿ç”¨creat-react-appæ­å»ºåŸºäºwebpackçš„reactå¼€å‘ç¯å¢ƒ</h1><hr><p><a href="https://github.com/facebook/create-react-app" target="_blank" rel="noopener">facebookå®˜æ–¹æ–‡æ¡£</a><br><strong>Quick Start</strong>:</p><pre><code class="javascript">npm install -g create-react-app       //å®‰è£…create-react-appï¼Œyarnå‘½ä»¤(éœ€è¦å®‰è£…yarn) yarn add create-react-appcreate-react-app myapp  //ä½¿ç”¨å‘½ä»¤åˆ›å»ºreactåº”ç”¨ myappä¸ºæ–‡ä»¶åç§°cd myapp     //è¿›å…¥æ–‡ä»¶ç›®å½•npm start //yarn start  å¯åŠ¨åº”ç”¨npm test or yarn test //æµ‹è¯•npm run build or yarn build //æ‰“åŒ…ç¼–è¯‘</code></pre><p>ä¸Šè¿°å‘½ä»¤å³å¯å¿«é€Ÿåˆ›å»ºreactå¼€å‘ç¯å¢ƒ</p><p>æ‰“å¼€<a href="http://localhost:3000/" target="_blank" rel="noopener">http://localhost:3000/</a> æŸ¥çœ‹<br><a id="more"></a></p><h2 id="ç¯å¢ƒé…ç½®ä»‹ç»ï¼š"><a href="#ç¯å¢ƒé…ç½®ä»‹ç»ï¼š" class="headerlink" title="ç¯å¢ƒé…ç½®ä»‹ç»ï¼š"></a>ç¯å¢ƒé…ç½®ä»‹ç»ï¼š</h2><h3 id="é¡¹ç›®ç»“æ„ï¼š"><a href="#é¡¹ç›®ç»“æ„ï¼š" class="headerlink" title="é¡¹ç›®ç»“æ„ï¼š"></a>é¡¹ç›®ç»“æ„ï¼š</h3><p>ç”Ÿæˆé¡¹ç›®åï¼Œè„šæ‰‹æ¶ä¸ºäº†â€œä¼˜é›…â€â€¦ â€¦éšè—äº†æ‰€æœ‰çš„webpackç›¸å…³çš„é…ç½®æ–‡ä»¶ï¼Œæ­¤æ—¶æŸ¥çœ‹myappæ–‡ä»¶å¤¹ç›®å½•ï¼Œä¼šå‘ç°æ‰¾ä¸åˆ°ä»»ä½•webpacké…ç½®æ–‡ä»¶ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><pre><code class="javascript">npm run eject</code></pre><p>å†æŸ¥çœ‹myapp æ–‡ä»¶å¤¹ï¼Œå¯ä»¥çœ‹åˆ°å®Œæ•´çš„é¡¹ç›®ç»“æ„ï¼š</p><pre><code class="javascript">myapp/    node_modules/    package.json    .gitignore    config/        paths.js        polyfills        env.js        webpack.config.dev.js        webpack.config.prod.js    public/        index.html   / å…¥å£htmlæ–‡ä»¶ /    scripts        **build.js**        **start.js**        test.js    src/        App.js        index.js    / ä¸»å…¥å£æ–‡ä»¶ /</code></pre><p>åŠ ç²—æ–‡ä»¶ä¸ºä¸»è¦é…ç½®æ–‡ä»¶ã€‚</p><p>äºŒã€é¡¹ç›®é…ç½®ä»‹ç»<br>æ­¤å¤„éœ€è¦æœ‰npmã€webpackçš„åŸºç¡€çŸ¥è¯†ï¼Œå……ç”µä¼ é€é—¨ï¼š<a href="http://www.jianshu.com/p/42e11515c10f" target="_blank" rel="noopener">webpackå­¦ä¹ æ•™ç¨‹</a></p><p>æŸ¥çœ‹package.jsonæ–‡ä»¶çš„scriptsï¼Œ</p><pre><code class="javascript">&quot;scripts&quot;: {    &quot;start&quot;: &quot;node scripts/start.js&quot;,    &quot;build&quot;: &quot;node scripts/build.js&quot;,    &quot;test&quot;: &quot;node scripts/test.js --env=jsdom&quot;},</code></pre><p>å¯çŸ¥ï¼Œè¿è¡Œæ—¶æ˜¯ç›´æ¥æ‰§è¡Œscriptsæ–‡ä»¶ç›®å½•ä¸‹çš„jsæ–‡ä»¶ã€‚<br>å…¶ä¸­<strong>start.js</strong>ä¸ºå¼€å‘ç¯å¢ƒï¼Œ<strong>build.js</strong>ä¸ºæ‰“åŒ…è„šæœ¬ã€‚</p><h3 id="å¼€å‘ç¯å¢ƒï¼Œä»£ç†è¯·æ±‚"><a href="#å¼€å‘ç¯å¢ƒï¼Œä»£ç†è¯·æ±‚" class="headerlink" title="å¼€å‘ç¯å¢ƒï¼Œä»£ç†è¯·æ±‚"></a>å¼€å‘ç¯å¢ƒï¼Œä»£ç†è¯·æ±‚</h3><p>æŸ¥çœ‹<strong>start.js</strong>, FacebookåŸºæœ¬ä¸ºæ¯é¡¹é…ç½®éƒ½å†™äº†è¯¦å°½çš„æ³¨é‡Šï¼Œ<br><strong>start.js</strong>è„šæœ¬å¯åŠ¨äº†dev-server, è¿™é‡Œéœ€è¦äº†è§£çš„æ˜¯</p><pre><code class="javascript">function addMiddleware(devServer){    ... ...    è¿™ä¸ªå‡½æ•°è°ƒç”¨http-proxy-middlewareæ¨¡å—ï¼Œå°†ä»£ç†è¯·æ±‚ï¼Œä»£ç†åœ°å€åœ¨package.jsonä¸­æ·»åŠ }</code></pre><p>åœ¨package.jsonä¸­æ·»åŠ å­—æ®µproxyï¼Œå¼€å‘ç¯å¢ƒä¸‹dev-serverå°†ä¼šè‡ªåŠ¨è½¬å‘è¯·æ±‚ï¼š</p><pre><code class="javascript">&quot;proxy&quot;: &quot;http://aaa.bbb.com&quot;</code></pre><h3 id="SASSã€LESSç­‰CSSé¢„å¤„ç†å™¨é…ç½®"><a href="#SASSã€LESSç­‰CSSé¢„å¤„ç†å™¨é…ç½®" class="headerlink" title="SASSã€LESSç­‰CSSé¢„å¤„ç†å™¨é…ç½®"></a>SASSã€LESSç­‰CSSé¢„å¤„ç†å™¨é…ç½®</h3><p>Facebookå®˜æ–¹åœ¨create-react-appå‡çº§åˆ°æŸä¸€ç‰ˆæœ¬ï¼Œçªç„¶ä¸¢æ‰äº†é»˜è®¤å¯¹sassã€lessç­‰é¢„å¤„ç†å™¨çš„æ”¯æŒï¼Œå®˜æ–¹æ–‡æ¡£è¯´æ˜</p><p>äºæ˜¯ï¼Œåªèƒ½è‡ªå·±åŠ¨æ‰‹ï¼Œåœ¨configç›®å½•ä¸‹ï¼Œ<strong>webpack.config.dev.js</strong> å’Œ <strong>webpack.config.prod.js</strong>æ–‡ä»¶ï¼Œæ²¡æœ‰æŠ½å‡º loaderã€postcssä¹‹ç±»ä¸€èˆ¬å…±ç”¨çš„é…ç½®ï¼Œäºæ˜¯ï¼Œåœ¨ä¸¤ä¸ªæ–‡ä»¶å¤¹éƒ½è¦ä¸€èµ·é…ç½®ï¼Œä¹Ÿå¯ä»¥æŠ½å‡ºå…±ç”¨éƒ¨åˆ†ï¼Œä»¥ä¾¿ç»´æŠ¤ã€‚</p><p>è¿™é‡Œä»¥<strong>webpack.config.dev.js</strong>ä¸¾ä¾‹ï¼Œ<strong>webpack.config.prod.js</strong>ä¸€æ ·é…ç½®å³å¯ï¼š</p><p>SASS-loaderï¼š<br>1ã€å‘½ä»¤è¡Œï¼Œåœ¨å½“å‰ç›®å½•æ‰§è¡Œï¼š</p><pre><code class="javascript">npm install --save node-sass-chokidar //or yarn add node-sass-chokidar</code></pre><p>ç„¶ååœ¨package.jsonä¿®æ”¹ä¸º</p><pre><code class="javascript">&quot;scripts&quot;: {   &quot;build-css&quot;: &quot;node-sass-chokidar src/ -o src/&quot;,   &quot;watch-css&quot;: &quot;npm run build-css &amp;&amp; node-sass-chokidar src/ -o src/ --watch --recursive&quot;,     &quot;start&quot;: &quot;react-scripts start&quot;,     &quot;build&quot;: &quot;react-scripts build&quot;,     &quot;test&quot;: &quot;react-scripts test --env=jsdom&quot;,</code></pre><p>æŠŠindex.cssæ”¹ä¸ºindex.scss æ‰§è¡Œ </p><pre><code class="javascript">npm run watch-css</code></pre><p>å°±å¯ä»¥å‘ç°sassæ–‡ä»¶è¢«ç¼–è¯‘æˆäº†cssæ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„cssæ–‡ä»¶æ‰€ä»¥å¼•ç”¨çš„éƒ¨åˆ†ä¸ä½œä¿®æ”¹ï¼‰</p><p>å¦‚æœä½ å‘ç°åœ¨æ‰§è¡Œ<strong>watch-css</strong> å‘½ä»¤æ—¶ ä¸èƒ½åŒæ—¶æ‰§è¡Œnpm start,å¯ä»¥é‡‡ç”¨å¦å¤–ä¸€ç§æ–¹å¼ï¼š</p><pre><code class="javascript">npm install --save npm-run-all //yarn add npm-run-allï¼ˆ è¿™æ˜¯watch-csså’Œbuild-cssçš„åˆé›†ï¼‰</code></pre><p>åŒæ ·ä¿®æ”¹package.jsonä¸­çš„</p><pre><code class="javascript"> &quot;scripts&quot;: {    &quot;build-css&quot;: &quot;node-sass-chokidar src/ -o src/&quot;,    &quot;watch-css&quot;: &quot;npm run build-css &amp;&amp; node-sass-chokidar src/ -o src/ --watch --recursive&quot;,    &quot;start-js&quot;: &quot;node scripts/start.js&quot;,    &quot;start&quot;: &quot;npm-run-all -p watch-css start-js&quot;,    &quot;build-js&quot;: &quot;node scripts/build.js&quot;,    &quot;build&quot;: &quot;npm-run-all build-css build-js&quot;,    &quot;test&quot;: &quot;node scripts/test.js --env=jsdom&quot;  },</code></pre><p>è¿™æ ·å°±å¯ä»¥åªéœ€æ‰§è¡Œnpm start ç¼–è¾‘æŸ¥çœ‹äº†</p><p>2ã€æ‰¾åˆ°webpack.config.dev.jsæ–‡ä»¶ä¸­ loadersä¸­çš„ç¬¬ä¸€é¡¹excludeï¼ˆå€¼ä¸ºæ•°ç»„ï¼‰ï¼Œæ’é™¤scssæ–‡ä»¶ï¼Œå¦åˆ™å°†è¢«â€™url-loaderâ€™æ•è·ã€‚</p><pre><code class="javascript">{exclude: [    /\.html$/,    /\.(js|jsx)(\?.*)?$/,    /\.css$/,    /\.json$/,    /\.svg$/,    /\.scss$/     //....æ–°å¢é¡¹!]</code></pre><p>3ã€loadersæ–°å¢ä¸€é¡¹ï¼š</p><pre><code class="javascript">{    test: /\.scss$/,    loader: &#39;style!css!postcss!sass?outputStyle=expanded&#39;},</code></pre><p>è‡³æ­¤ï¼ŒSASSæ–‡ä»¶å°±å¯ä»¥æ­£å¸¸æ‰“åŒ…äº†ï¼ˆæ­¤å¤„é’ˆå¯¹SCSSæ–‡ä»¶ï¼Œå¦‚ç”¨åˆ°SASSï¼Œå¯å°†SCSSçš„æ­£åˆ™ä¿®æ”¹ä¸‹ï¼‰ï¼ŒLESSæ–‡ä»¶ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚</p><h2 id="ä½¿ç”¨and-mobile-UIå·¥å…·-å¯ä»¥å¿«é€Ÿå¼€å‘reactåº”ç”¨"><a href="#ä½¿ç”¨and-mobile-UIå·¥å…·-å¯ä»¥å¿«é€Ÿå¼€å‘reactåº”ç”¨" class="headerlink" title="ä½¿ç”¨and-mobile UIå·¥å…· å¯ä»¥å¿«é€Ÿå¼€å‘reactåº”ç”¨"></a>ä½¿ç”¨and-mobile UIå·¥å…· å¯ä»¥å¿«é€Ÿå¼€å‘reactåº”ç”¨</h2><p><a href="https://mobile.ant.design/index-cn" target="_blank" rel="noopener">and-mobileå…¥å£</a></p><h3 id="antd-mobileçš„å¼•å…¥åŠé…ç½®"><a href="#antd-mobileçš„å¼•å…¥åŠé…ç½®" class="headerlink" title="antd-mobileçš„å¼•å…¥åŠé…ç½®"></a>antd-mobileçš„å¼•å…¥åŠé…ç½®</h3><p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼š</p><pre><code class="javascript">npm install antd-mobile --save</code></pre><p><strong>æŒ‰éœ€å¼•å…¥</strong></p><p>ä¸ºå‡å°‘æ‰“åŒ…åä½“ç§¯ä»¥åŠæ–¹ä¾¿ä¹¦å†™ï¼Œå¯ç”¨babel-plugin-importæ’ä»¶ï¼Œé…ç½®åå¼•å…¥æ¨¡å—å¯å¦‚ä¸‹ï¼š</p><pre><code class="javascript">import {Picker} from &#39;antd-mobile&#39;;</code></pre><p>è‡ªåŠ¨å¼•å…¥CSSå’ŒJSï¼Œæ— éœ€å†å¼•å…¥æ•´ä¸ªantd-mobileçš„æ•´ä¸ªCSSæ–‡ä»¶</p><p>ä½¿ç”¨å¦‚ä¸‹ï¼š</p><pre><code class="javascript">npm install babel-plugin-import --save-dev</code></pre><p>å®‰è£…å®Œæ¯•åï¼Œåœ¨æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶ï¼Œå‘½å: .babelrc.js</p><pre><code class="javascript">{  &quot;presets&quot;: [    &quot;es2015&quot;,    &quot;react&quot;  ],  &quot;plugins&quot;: [    [      &quot;import&quot;,        {          &quot;libraryName&quot;: &quot;antd-mobile&quot;,          &quot;style&quot;: &quot;css&quot;        }      ]    ]}</code></pre><p>åœ¨æ–‡ä»¶å†…è¾“å…¥ä»¥ä¸Šå†…å®¹ï¼Œä¸ºbabelçš„é…ç½®ã€‚</p><p>ç„¶åï¼ï¼ï¼æœ€é‡è¦çš„ä¸€æ­¥ï¼Œ<strong>æŠŠpackage.jsonä¸­çš„babelé…ç½®ç»™åˆ æ‰ï¼Œå°¤å…¶æ˜¯ï¼šreact-appï¼ï¼ï¼</strong></p><p>webpack.config.dev.jså’Œwebpack.config.prod.jsä¸­ï¼Œéƒ½éœ€è¦ä¸ºresolveçš„extensionsæ–°å¢ä¸€é¡¹â€™<strong>.web.js</strong>â€˜</p><p>antd-mobileçš„webç‰ˆçš„æ–‡ä»¶åç¼€ä¸º.web.js â€¦</p><h2 id="åŸºäºcreate-react-appçš„æ‰“åŒ…åæ–‡ä»¶æ ¹è·¯å¾„ä¿®æ”¹"><a href="#åŸºäºcreate-react-appçš„æ‰“åŒ…åæ–‡ä»¶æ ¹è·¯å¾„ä¿®æ”¹" class="headerlink" title="åŸºäºcreate-react-appçš„æ‰“åŒ…åæ–‡ä»¶æ ¹è·¯å¾„ä¿®æ”¹"></a>åŸºäºcreate-react-appçš„æ‰“åŒ…åæ–‡ä»¶æ ¹è·¯å¾„ä¿®æ”¹</h2><p>æ‰¾åˆ°react-scriptæ¨¡å—æ–‡ä»¶å¤¹configä¸‹é¢  paths.js æˆ–<br>node_modules\react-scripts\config\ paths.js<br>45è¡Œåˆ° 49è¡Œ</p><pre><code class="javascript">function getServedPath(appPackageJson) {  const publicUrl = getPublicUrl(appPackageJson);  const servedUrl =    envPublicUrl || (publicUrl ? url.parse(publicUrl).pathname : &#39;./&#39;); // é…ç½®æ–‡ä»¶è·Ÿè·¯å¾„&#39;/&#39;å‰é¢åŠ .  return ensureSlash(servedUrl, true);}</code></pre><h2 id="reactæ®µä½æ’è¡Œè¦æ±‚çŸ¥ä¹å¤§ç¥æ€»ç»“"><a href="#reactæ®µä½æ’è¡Œè¦æ±‚çŸ¥ä¹å¤§ç¥æ€»ç»“" class="headerlink" title="reactæ®µä½æ’è¡Œè¦æ±‚çŸ¥ä¹å¤§ç¥æ€»ç»“"></a>reactæ®µä½æ’è¡Œè¦æ±‚<a href="https://www.zhihu.com/people/mo-ran-biao-82/activities" target="_blank" rel="noopener">çŸ¥ä¹å¤§ç¥æ€»ç»“</a></h2><h3 id="å€”å¼ºé’é“œ"><a href="#å€”å¼ºé’é“œ" class="headerlink" title="å€”å¼ºé’é“œ"></a>å€”å¼ºé’é“œ</h3><p>åˆå…¥å³¡è°·çš„åˆå§‹æ®µä½ï¼Œé»˜è®¤å¬å”¤å¸ˆå·²ç»æœ‰äº†ES6ï¼Œnodejsçš„åŸºç¡€ä½¿ç”¨create-react-appå»ºç«‹Reactå¼€å‘ç¯å¢ƒå­¦ä¹ Reactä¸–ç•Œé‡Œçš„åŸºæœ¬ç©æ³•ï¼Œä¾‹å¦‚ç»„ä»¶åŒ–ï¼ŒJSXï¼Œäº‹ä»¶ç›‘å¬ï¼Œå†…éƒ¨stateï¼Œç»„ä»¶çš„propsã€ç”Ÿå‘½å‘¨æœŸå‡½æ•°ç­‰è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»Reacté’é“œå‡ç™½é“¶éœ€è¦çš„åŸºç¡€çŸ¥è¯†ï¼Œçœ‹å®Œä½ å°±ç™½é“¶å•¦</p><h3 id="ç§©åºç™½é“¶"><a href="#ç§©åºç™½é“¶" class="headerlink" title="ç§©åºç™½é“¶"></a>ç§©åºç™½é“¶</h3><p>åˆ°äº†ç™½é“¶æ®µä½ï¼ŒåŸºæœ¬éƒ½æ˜¯æœ‰äº†åŸºæœ¬çš„æ“ä½œï¼Œä¸ä¼šå‡ºç°å‘†èŒçš„ç«™åœ¨åœ°æ–¹å¡”ä¸‹è¢«æ‰“æ­»çš„æƒ…å†µäº†æˆ‘ä»¬éœ€è¦ä¹°ä¸€ä¸ªçš®è‚¤æ¥æå‡é¡µé¢ç¾è§‚å¹¶ä¸”å¤šåŠ ç»ƒä¹ å­¦ä¹ ä½¿ç”¨èš‚èšé‡‘æœant-designçš„ä½¿ç”¨</p><h3 id="è£è€€é»„é‡‘"><a href="#è£è€€é»„é‡‘" class="headerlink" title="è£è€€é»„é‡‘"></a>è£è€€é»„é‡‘</h3><p>åˆ°äº†è¿™ä¸ªé˜¶æ®µï¼Œå¬å”¤å¸ˆå¯¹Reactæœ‰äº†åŸºæœ¬çš„è®¤è¯†ï¼Œæƒ³è¿›ä¸€æ­¥çš„æå‡æ®µä½ï¼Œæˆ‘ä»¬éœ€è¦æé«˜è‡ªå·±çš„å¤§å±€è§‚å­¦ä¹ ä½¿ç”¨React-Router4æ¥è®©æˆ‘ä»¬æœ‰å¤šé¢ä½œæˆ˜èƒ½åŠ›å­¦ä¼šä½¿ç”¨BrowserRouterï¼ŒRouterï¼ŒLinkç­‰ç»„ä»¶å­¦ä¼šä½¿ç”¨Reduxå’Œé˜Ÿå‹é…åˆï¼Œä¿®ç‚¼å¤§å±€è§‚äº†è§£å•é¡¹æ•°æ®æµå¼€å‘æ¨¡å¼å’ŒReduxçš„å„ç§æ¦‚å¿µ,å¦‚dispatch,action,reducersä½¿ç”¨react-reduxæ›´å¥½çš„å’ŒReduxé…åˆæœ‰å¤§å±€è§‚æ„è¯†ï¼Œä¸Šé“‚é‡‘ä¹Ÿæ˜¯å¾ˆ easy äº†</p><h3 id="å°Šè´µé“‚é‡‘"><a href="#å°Šè´µé“‚é‡‘" class="headerlink" title="å°Šè´µé“‚é‡‘"></a>å°Šè´µé“‚é‡‘</h3><p>å¾ˆå¤šå¬å”¤å¸ˆå¡åœ¨é“‚é‡‘ä¸Šä¸å»ï¼Œå› ä¸ºé“‚é‡‘æƒ³ä¸Šé’»çŸ³ï¼Œéœ€è¦äº†è§£æ›´å¤šçš„ç»†èŠ‚å’ŒåŸç†ReactåŸç†å‰–æå¯¹è‡ªå·±æŠ€èƒ½çš„åŸç†æœ‰æ·±åˆ»çš„äº†è§£ï¼Œä¸Šé’»çŸ³å¿…å¤‡</p><h3 id="æ°¸æ’é’»çŸ³"><a href="#æ°¸æ’é’»çŸ³" class="headerlink" title="æ°¸æ’é’»çŸ³"></a>æ°¸æ’é’»çŸ³</h3><p>é’»çŸ³æ®µä½å¼€å§‹äº†å¾å…†æ¨¡å¼ï¼Œå¬å”¤å¸ˆçš„æŠ€èƒ½æ± è¦è¶³å¤Ÿæ·±æ‰èƒ½æ›´è¿›ä¸€æ­¥ï¼Œå¯¹è‡ªå·±æ“…é•¿æŠ€èƒ½çš„ç†è§£ä¹Ÿè¦æ›´æ·±åˆ»Reduxä¸­é—´ä»¶æœºåˆ¶ï¼Œå®ç°è‡ªå·±çš„ä¸­é—´ä»¶å¸¸è§çš„React æ€§èƒ½ä¼˜åŒ–æ–¹å¼æœåŠ¡ç«¯æ¸²æŸ“Reduxä¹‹å¤–å…¶ä»–çš„æ•°æ®è§£å†³æ–¹æ¡ˆå¦‚mobxï¼Œdva</p><h3 id="è‡³å°Šæ˜Ÿè€€"><a href="#è‡³å°Šæ˜Ÿè€€" class="headerlink" title="è‡³å°Šæ˜Ÿè€€"></a>è‡³å°Šæ˜Ÿè€€</h3><p>è¿™ä¸ªæ®µä½å·²ç»æ˜¯ç‹¬å½“ä¸€é¢çš„å¼ºè€…äº†ï¼Œç›®æ ‡ä»…é™äº React è¿™ä¸ªåº“å¾ˆéš¾æ›´è¿‘ä¸€å±‚ï¼Œéœ€è¦äº†è§£æ›´åº•å±‚çš„åŸç†ReduxåŸç†å‰–æ+å®ç°è‡ªå·±çš„ReduxReact-Router+å®ç°è‡ªå·±çš„React-RouterWebppackå·¥ä½œæœºåˆ¶å’ŒåŸç†å‰–æBabelå·¥ä½œæœºåˆ¶å’ŒåŸç†å‰–æ</p><h3 id="æœ€å¼ºç‹è€…"><a href="#æœ€å¼ºç‹è€…" class="headerlink" title="æœ€å¼ºç‹è€…"></a>æœ€å¼ºç‹è€…</h3><p>è¾¾åˆ°æœ€å¼ºç‹è€…å·²ç»æ˜¯é¡¶å°–å¬å”¤å¸ˆï¼Œåœ¨æ•´ä¸ª React å³¡è°·éƒ½æ˜¯é¼é¼å¤§åçš„å­˜åœ¨ï¼Œå¬è¯´ä¸Šé¢è¿˜æœ‰ä¼ è¯´ä¸­çš„<strong>è£è€€ç‹è€…</strong>çš„æ®µä½ï¼Œæˆ‘è¿™è¾ˆå­æ˜¯è¾¾ä¸åˆ°äº†ï¼Œä¹Ÿæ²¡æ³•æ•™ä½ ä»¬äº†ï¼Œå›§è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘åªæ¨èã€Šç¨‹åºå‘˜å¥åº·æŒ‡å—ã€‹ä¸€æœ¬ä¹¦ï¼Œä¿æŒèº«å¿ƒå¥åº·ï¼Œæˆä¸ºè£è€€ç‹è€…æ˜¯æ—©æ™šçš„äº‹<br><a href="https://www.jianshu.com/p/5e6c620ff4d6" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptå¥‡æŠ€æ·«å·§44æ‹›</title>
      <link href="/2018/02/27/Js/JavaScript%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A745%E6%8B%9B/"/>
      <url>/2018/02/27/Js/JavaScript%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A745%E6%8B%9B/</url>
      
        <content type="html"><![CDATA[<p><a href="http://chensd.com/2015-01/45-useful-javascript-tips-tricks-and-best-practices.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><hr><h1 id="é¦–æ¬¡ä¸ºå˜é‡èµ‹å€¼æ—¶åŠ¡å¿…ä½¿ç”¨varå…³é”®å­—"><a href="#é¦–æ¬¡ä¸ºå˜é‡èµ‹å€¼æ—¶åŠ¡å¿…ä½¿ç”¨varå…³é”®å­—" class="headerlink" title="é¦–æ¬¡ä¸ºå˜é‡èµ‹å€¼æ—¶åŠ¡å¿…ä½¿ç”¨varå…³é”®å­—"></a>é¦–æ¬¡ä¸ºå˜é‡èµ‹å€¼æ—¶åŠ¡å¿…ä½¿ç”¨varå…³é”®å­—</h1><p>å˜é‡æ²¡æœ‰å£°æ˜è€Œç›´æ¥èµ‹å€¼å¾—è¯ï¼Œé»˜è®¤ä¼šä½œä¸ºä¸€ä¸ªæ–°çš„å…¨å±€å˜é‡ï¼Œè¦å°½é‡é¿å…ä½¿ç”¨å…¨å±€å˜é‡ã€‚</p><h1 id="ä½¿ç”¨-å–ä»£"><a href="#ä½¿ç”¨-å–ä»£" class="headerlink" title="ä½¿ç”¨===å–ä»£=="></a>ä½¿ç”¨<strong>===</strong>å–ä»£<strong>==</strong></h1><p>==å’Œ!=æ“ä½œç¬¦ä¼šåœ¨éœ€è¦çš„æƒ…å†µä¸‹è‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹ã€‚ä½†===å’Œ!==ä¸ä¼šï¼Œå®ƒä»¬ä¼šåŒæ—¶æ¯”è¾ƒå€¼å’Œæ•°æ®ç±»å‹ï¼Œè¿™ä¹Ÿä½¿å¾—å®ƒä»¬è¦æ¯”==å’Œ!=å¿«ã€‚</p><pre><code class="javascript">[10] === 10    // is false[10]  == 10    // is true&#39;10&#39; == 10     // is true&#39;10&#39; === 10    // is false []   == 0     // is true [] ===  0     // is false &#39;&#39; == false   // is true but true == &quot;a&quot; is false &#39;&#39; === false  // is false</code></pre><h1 id="underfinedã€nullã€0ã€falseã€NaNã€ç©ºå­—ç¬¦ä¸²çš„é€»è¾‘ç»“æœå‡ä¸ºfalse"><a href="#underfinedã€nullã€0ã€falseã€NaNã€ç©ºå­—ç¬¦ä¸²çš„é€»è¾‘ç»“æœå‡ä¸ºfalse" class="headerlink" title="underfinedã€nullã€0ã€falseã€NaNã€ç©ºå­—ç¬¦ä¸²çš„é€»è¾‘ç»“æœå‡ä¸ºfalse"></a>underfinedã€nullã€0ã€falseã€NaNã€ç©ºå­—ç¬¦ä¸²çš„é€»è¾‘ç»“æœå‡ä¸ºfalse</h1><h1 id="è¡Œå°¾ä½¿ç”¨åˆ†å·"><a href="#è¡Œå°¾ä½¿ç”¨åˆ†å·" class="headerlink" title="è¡Œå°¾ä½¿ç”¨åˆ†å·"></a>è¡Œå°¾ä½¿ç”¨åˆ†å·</h1><p>å®è·µä¸­æœ€å¥½è¿˜æ˜¯ä½¿ç”¨åˆ†å·ï¼Œå¿˜äº†å†™ä¹Ÿæ²¡äº‹ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹JavaScriptè§£é‡Šå™¨éƒ½ä¼šè‡ªåŠ¨æ·»åŠ ã€‚å¯¹äºä¸ºä½•è¦ä½¿ç”¨åˆ†å·ï¼Œå¯å‚è€ƒæ–‡ç« <a href="https://davidwalsh.name/javascript-semicolons" target="_blank" rel="noopener">JavaScriptä¸­å…³äºåˆ†å·çš„çœŸç›¸</a><br><a id="more"></a></p><h1 id="ä½¿ç”¨å¯¹è±¡æ„é€ å™¨"><a href="#ä½¿ç”¨å¯¹è±¡æ„é€ å™¨" class="headerlink" title="ä½¿ç”¨å¯¹è±¡æ„é€ å™¨"></a>ä½¿ç”¨å¯¹è±¡æ„é€ å™¨</h1><pre><code class="javascript">function Person(firstName, lastName){    this.firstName =  firstName;    this.lastName = lastName;}var Saad = new Person(&quot;Saad&quot;, &quot;Mousliki&quot;);</code></pre><h1 id="å°å¿ƒä½¿ç”¨typeofã€instanceofå’Œcontructor"><a href="#å°å¿ƒä½¿ç”¨typeofã€instanceofå’Œcontructor" class="headerlink" title="å°å¿ƒä½¿ç”¨typeofã€instanceofå’Œcontructor"></a>å°å¿ƒä½¿ç”¨typeofã€instanceofå’Œcontructor</h1><blockquote><ul><li>typeofï¼šJavaScriptä¸€å…ƒæ“ä½œç¬¦ï¼Œç”¨äºä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›å˜é‡çš„åŸå§‹ç±»å‹ï¼Œæ³¨æ„ï¼Œtypeof nullä¹Ÿä¼šè¿”å›objectï¼Œå¤§å¤šæ•°çš„å¯¹è±¡ç±»å‹ï¼ˆæ•°ç»„Arrayã€æ—¶é—´Dateç­‰ï¼‰ä¹Ÿä¼šè¿”å›object</li><li>contructorï¼šå†…éƒ¨åŸå‹å±æ€§ï¼Œå¯ä»¥é€šè¿‡ä»£ç é‡å†™</li><li>instanceofï¼šJavaScriptæ“ä½œç¬¦ï¼Œä¼šåœ¨åŸå‹é“¾ä¸­çš„æ„é€ å™¨ä¸­æœç´¢ï¼Œæ‰¾åˆ°åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</li></ul></blockquote><pre><code class="javascript">var arr = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;];typeof arr;   // è¿”å› &quot;object&quot; arr instanceof Array // truearr.constructor();  //[]</code></pre><h1 id="ä½¿ç”¨è‡ªè°ƒç”¨å‡½æ•°"><a href="#ä½¿ç”¨è‡ªè°ƒç”¨å‡½æ•°" class="headerlink" title="ä½¿ç”¨è‡ªè°ƒç”¨å‡½æ•°"></a>ä½¿ç”¨è‡ªè°ƒç”¨å‡½æ•°</h1><p>å‡½æ•°åœ¨åˆ›å»ºä¹‹åç›´æ¥è‡ªåŠ¨æ‰§è¡Œï¼Œé€šå¸¸ç§°ä¹‹ä¸ºè‡ªè°ƒç”¨åŒ¿åå‡½æ•°ï¼ˆSelf-Invoked Anonymous Functionï¼‰æˆ–ç›´æ¥è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼ˆImmediately Invoked Function Expression ï¼‰ã€‚æ ¼å¼å¦‚ä¸‹ï¼š</p><pre><code class="javascript">(function(){    // ç½®äºæ­¤å¤„çš„ä»£ç å°†è‡ªåŠ¨æ‰§è¡Œ})(); (function(a,b){    var result = a+b;    return result;})(10,20)</code></pre><h1 id="ä»æ•°ç»„ä¸­éšæœºè·å–æˆå‘˜"><a href="#ä»æ•°ç»„ä¸­éšæœºè·å–æˆå‘˜" class="headerlink" title="ä»æ•°ç»„ä¸­éšæœºè·å–æˆå‘˜"></a>ä»æ•°ç»„ä¸­éšæœºè·å–æˆå‘˜</h1><pre><code class="javascript">var items = [12, 548 , &#39;a&#39; , 2 , 5478 , &#39;foo&#39; , 8852, , &#39;Doe&#39; , 2145 , 119];var  randomItem = items[Math.floor(Math.random() * items.length)];console.log(randomItem);</code></pre><h1 id="è·å–æŒ‡å®šèŒƒå›´å†…çš„éšæœºæ•°"><a href="#è·å–æŒ‡å®šèŒƒå›´å†…çš„éšæœºæ•°" class="headerlink" title="è·å–æŒ‡å®šèŒƒå›´å†…çš„éšæœºæ•°"></a>è·å–æŒ‡å®šèŒƒå›´å†…çš„éšæœºæ•°</h1><p>è¿™ä¸ªåŠŸèƒ½åœ¨ç”Ÿæˆæµ‹è¯•ç”¨çš„å‡æ•°æ®æ—¶ç‰¹åˆ«æœ‰æ•°ï¼Œæ¯”å¦‚ä»‹ä¸æŒ‡å®šèŒƒå›´å†…çš„å·¥èµ„æ•°ã€‚</p><pre><code class="javascript">var x = Math.floor(Math.random() * (max - min + 1)) + min;</code></pre><h1 id="ç”Ÿæˆä»0åˆ°æŒ‡å®šå€¼çš„æ•°å­—æ•°ç»„"><a href="#ç”Ÿæˆä»0åˆ°æŒ‡å®šå€¼çš„æ•°å­—æ•°ç»„" class="headerlink" title="ç”Ÿæˆä»0åˆ°æŒ‡å®šå€¼çš„æ•°å­—æ•°ç»„"></a>ç”Ÿæˆä»0åˆ°æŒ‡å®šå€¼çš„æ•°å­—æ•°ç»„</h1><pre><code class="javascript">var numbersArray = [] , max = 100;for( var i=1; numbersArray.push(i++) &lt; max;);  // numbers = [1,2,3 ... 100]</code></pre><h1 id="ç”Ÿæˆéšæœºçš„å­—æ¯æ•°å­—å­—ç¬¦ä¸²"><a href="#ç”Ÿæˆéšæœºçš„å­—æ¯æ•°å­—å­—ç¬¦ä¸²" class="headerlink" title="ç”Ÿæˆéšæœºçš„å­—æ¯æ•°å­—å­—ç¬¦ä¸²"></a>ç”Ÿæˆéšæœºçš„å­—æ¯æ•°å­—å­—ç¬¦ä¸²</h1><pre><code class="javascript">function generateRandomAlphaNum(len) {    var rdmString = &quot;&quot;;    for( ; rdmString.length &lt; len; rdmString  += Math.random().toString(36).substr(2));    return  rdmString.substr(0, len);}</code></pre><h1 id="æ‰“ä¹±æ•°å­—æ•°ç»„çš„é¡ºåº"><a href="#æ‰“ä¹±æ•°å­—æ•°ç»„çš„é¡ºåº" class="headerlink" title="æ‰“ä¹±æ•°å­—æ•°ç»„çš„é¡ºåº"></a>æ‰“ä¹±æ•°å­—æ•°ç»„çš„é¡ºåº</h1><pre><code class="javascript">var numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411];numbers = numbers.sort(function(){ return Math.random() - 0.5});/* numbers æ•°ç»„å°†ç±»ä¼¼äº [120, 5, 228, -215, 400, 458, -85411, 122205]  */</code></pre><p>è¿™é‡Œä½¿ç”¨äº†JavaScriptå†…ç½®çš„æ•°ç»„æ’åºå‡½æ•°ï¼Œæ›´å¥½çš„åŠæ³•æ˜¯ç”¨ä¸“é—¨çš„ä»£ç æ¥å®ç°ï¼ˆå¦‚Fisher-Yatesç®—æ³•</p><h1 id="å­—ç¬¦ä¸²å»ç©ºæ ¼"><a href="#å­—ç¬¦ä¸²å»ç©ºæ ¼" class="headerlink" title="å­—ç¬¦ä¸²å»ç©ºæ ¼"></a>å­—ç¬¦ä¸²å»ç©ºæ ¼</h1><p>Javaã€C#å’ŒPHPç­‰è¯­è¨€éƒ½å®ç°äº†ä¸“é—¨çš„å­—ç¬¦ä¸²å»ç©ºæ ¼å‡½æ•°ï¼Œä½†JavaScriptä¸­æ˜¯æ²¡æœ‰çš„ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç æ¥ä¸ºStringå¯¹è±¡å‡½æ•°ä¸€ä¸ª<strong>trimå‡½æ•°</strong>ï¼š</p><pre><code class="javascript">String.prototype.trim = function(){return this.replace(/^\s+|\s+$/g, &quot;&quot;);};</code></pre><p>æ–°çš„JavaScriptå¼•æ“å·²ç»æœ‰äº†trim()çš„åŸç”Ÿå®ç°</p><h1 id="æ•°ç»„ä¹‹é—´è¿½åŠ "><a href="#æ•°ç»„ä¹‹é—´è¿½åŠ " class="headerlink" title="æ•°ç»„ä¹‹é—´è¿½åŠ "></a>æ•°ç»„ä¹‹é—´è¿½åŠ </h1><pre><code class="javascript">var array1 = [12 , &quot;foo&quot; , {name &quot;Joe&quot;} , -2458];var array2 = [&quot;Doe&quot; , 555 , 100];Array.prototype.push.apply(array1, array2);/* array1 å€¼ä¸º  [12 , &quot;foo&quot; , {name &quot;Joe&quot;} , -2458 , &quot;Doe&quot; , 555 , 100] */</code></pre><h1 id="å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„"><a href="#å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„" class="headerlink" title="å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„"></a>å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„</h1><pre><code class="javascript">var argArray = Array.prototype.slice.call(arguments);</code></pre><h1 id="éªŒè¯æ˜¯å¦æ˜¯æ•°å­—"><a href="#éªŒè¯æ˜¯å¦æ˜¯æ•°å­—" class="headerlink" title="éªŒè¯æ˜¯å¦æ˜¯æ•°å­—"></a>éªŒè¯æ˜¯å¦æ˜¯æ•°å­—</h1><pre><code class="javascript">function isNumber(n){    return !isNaN(parseFloat(n)) &amp;&amp; isFinite(n);}</code></pre><h1 id="éªŒè¯æ˜¯å¦æ˜¯æ•°ç»„"><a href="#éªŒè¯æ˜¯å¦æ˜¯æ•°ç»„" class="headerlink" title="éªŒè¯æ˜¯å¦æ˜¯æ•°ç»„"></a>éªŒè¯æ˜¯å¦æ˜¯æ•°ç»„</h1><pre><code class="javascript">function isArray(obj){    return Object.prototype.toString.call(obj) === &#39;[object Array]&#39; ;}</code></pre><p>ä½†å¦‚æœtoString()æ–¹æ³•è¢«é‡å†™è¿‡å¾—è¯ï¼Œå°±è¡Œä¸é€šäº†ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š</p><pre><code class="javascript">Array.isArray(obj); // its a new Array method</code></pre><p>å¦‚æœåœ¨æµè§ˆå™¨ä¸­æ²¡æœ‰ä½¿ç”¨frameï¼Œè¿˜å¯ä»¥ç”¨instanceofï¼Œä½†å¦‚æœä¸Šä¸‹æ–‡å¤ªå¤æ‚ï¼Œä¹Ÿæœ‰å¯èƒ½å‡ºé”™ã€‚</p><pre><code class="javascript">var myFrame = document.createElement(&#39;iframe&#39;);document.body.appendChild(myFrame);var myArray = window.frames[window.frames.length-1].Array;var arr = new myArray(a,b,10); // [a,b,10]  // myArray çš„æ„é€ å™¨å·²ç»ä¸¢å¤±ï¼Œinstanceof çš„ç»“æœå°†ä¸æ­£å¸¸// æ„é€ å™¨æ˜¯ä¸èƒ½è·¨ frame å…±äº«çš„arr instanceof Array; // false</code></pre><h1 id="è·å–æ•°ç»„ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼"><a href="#è·å–æ•°ç»„ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼" class="headerlink" title="è·å–æ•°ç»„ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼"></a>è·å–æ•°ç»„ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼</h1><pre><code class="javascript">var  numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411]; var maxInNumbers = Math.max.apply(Math, numbers); var minInNumbers = Math.min.apply(Math, numbers);</code></pre><h1 id="æ¸…ç©ºæ•°ç»„"><a href="#æ¸…ç©ºæ•°ç»„" class="headerlink" title="æ¸…ç©ºæ•°ç»„"></a>æ¸…ç©ºæ•°ç»„</h1><pre><code class="javascript">var myArray = [12 , 222 , 1000 ];  myArray.length = 0; // myArray will be equal to [].</code></pre><h1 id="ä¸è¦ç›´æ¥ä»æ•°ç»„ä¸­deleteæˆ–removeå…ƒç´ "><a href="#ä¸è¦ç›´æ¥ä»æ•°ç»„ä¸­deleteæˆ–removeå…ƒç´ " class="headerlink" title="ä¸è¦ç›´æ¥ä»æ•°ç»„ä¸­deleteæˆ–removeå…ƒç´ "></a>ä¸è¦ç›´æ¥ä»æ•°ç»„ä¸­deleteæˆ–removeå…ƒç´ </h1><p>å¦‚æœå¯¹æ•°ç»„å…ƒç´ ç›´æ¥ä½¿ç”¨deleteï¼Œå…¶å®å¹¶æ²¡æœ‰åˆ é™¤ï¼Œåªæ˜¯å°†å…ƒç´ ç½®ä¸ºäº†undefinedã€‚æ•°ç»„å…ƒç´ åˆ é™¤åº”ä½¿ç”¨spliceã€‚</p><p>åˆ‡å¿Œï¼š</p><pre><code class="javascript">var items = [12, 548 ,&#39;a&#39; , 2 , 5478 , &#39;foo&#39; , 8852, , &#39;Doe&#39; ,2154 , 119 ]; items.length; // return 11 delete items[3]; // return true items.length; // return 11 /* items ç»“æœä¸º [12, 548, &quot;a&quot;, undefined Ã— 1, 5478, &quot;foo&quot;, 8852, undefined Ã— 1, &quot;Doe&quot;, 2154, 119] */</code></pre><p>è€Œåº”ï¼š</p><pre><code class="javascript">var items = [12, 548 ,&#39;a&#39; , 2 , 5478 , &#39;foo&#39; , 8852, , &#39;Doe&#39; ,2154 , 119 ]; items.length; // return 11 items.splice(3,1) ; items.length; // return 10 /* items ç»“æœä¸º [12, 548, &quot;a&quot;, 5478, &quot;foo&quot;, 8852, undefined Ã— 1, &quot;Doe&quot;, 2154, 119]åˆ é™¤å¯¹è±¡çš„å±æ€§æ—¶å¯ä»¥ä½¿ç”¨deleteã€‚</code></pre><h1 id="ä½¿ç”¨lengthå±æ€§æˆªæ–­æ•°ç»„"><a href="#ä½¿ç”¨lengthå±æ€§æˆªæ–­æ•°ç»„" class="headerlink" title="ä½¿ç”¨lengthå±æ€§æˆªæ–­æ•°ç»„"></a>ä½¿ç”¨lengthå±æ€§æˆªæ–­æ•°ç»„</h1><p>å‰é¢çš„ä¾‹å­ä¸­ç”¨lengthå±æ€§æ¸…ç©ºæ•°ç»„ï¼ŒåŒæ ·è¿˜å¯ç”¨å®ƒæ¥æˆªæ–­æ•°ç»„</p><pre><code class="javascript">var myArray = [12 , 222 , 1000 , 124 , 98 , 10 ];  myArray.length = 4; // myArray will be equal to [12 , 222 , 1000 , 124].</code></pre><p>ä¸æ­¤åŒæ—¶ï¼Œå¦‚æœæŠŠlengthå±æ€§å˜å¤§ï¼Œæ•°ç»„çš„é•¿åº¦å€¼å˜ä¼šå¢åŠ ï¼Œä¼šä½¿ç”¨undefinedæ¥ä½œä¸ºæ–°çš„å…ƒç´ å¡«å……ã€‚lengthæ˜¯ä¸€ä¸ªå¯å†™çš„å±æ€§ã€‚</p><pre><code class="javascript">myArray.length = 10; // the new array length is 10 myArray[myArray.length - 1] ; // undefined</code></pre><h1 id="åœ¨æ¡ä»¶ä¸­ä½¿ç”¨é€»è¾‘ä¸æˆ–"><a href="#åœ¨æ¡ä»¶ä¸­ä½¿ç”¨é€»è¾‘ä¸æˆ–" class="headerlink" title="åœ¨æ¡ä»¶ä¸­ä½¿ç”¨é€»è¾‘ä¸æˆ–"></a>åœ¨æ¡ä»¶ä¸­ä½¿ç”¨é€»è¾‘ä¸æˆ–</h1><pre><code class="javascript">var foo = 10;  foo == 10 &amp;&amp; doSomething(); // is the same thing as if (foo == 10) doSomething(); foo == 5 || doSomething(); // is the same thing as if (foo != 5) doSomething();</code></pre><p>é€»è¾‘æˆ–è¿˜å¯ç”¨æ¥è®¾ç½®é»˜è®¤å€¼ï¼Œæ¯”å¦‚å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚</p><pre><code class="javascript">function doSomething(arg1){     arg1 = arg1 || 10; // arg1 will have 10 as a default value if itâ€™s not already set}</code></pre><h1 id="ä½¿å¾—map-å‡½æ•°æ–¹æ³•å¯¹æ•°æ®å¾ªç¯"><a href="#ä½¿å¾—map-å‡½æ•°æ–¹æ³•å¯¹æ•°æ®å¾ªç¯" class="headerlink" title="ä½¿å¾—map()å‡½æ•°æ–¹æ³•å¯¹æ•°æ®å¾ªç¯"></a>ä½¿å¾—map()å‡½æ•°æ–¹æ³•å¯¹æ•°æ®å¾ªç¯</h1><pre><code class="javascript">var squares = [1,2,3,4].map(function (val) {      return val * val;  }); // squares will be equal to [1, 4, 9, 16]</code></pre><h1 id="ä¿ç•™æŒ‡å®šå°æ•°ä½æ•°"><a href="#ä¿ç•™æŒ‡å®šå°æ•°ä½æ•°" class="headerlink" title="ä¿ç•™æŒ‡å®šå°æ•°ä½æ•°"></a>ä¿ç•™æŒ‡å®šå°æ•°ä½æ•°</h1><pre><code class="javascript">var num =2.443242342;num = num.toFixed(4);  // num will be equal to 2.4432</code></pre><p>æ³¨æ„ï¼ŒtoFixec()è¿”å›çš„æ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ˜¯æ•°å­—ã€‚</p><h1 id="æµ®ç‚¹è®¡ç®—çš„é—®é¢˜"><a href="#æµ®ç‚¹è®¡ç®—çš„é—®é¢˜" class="headerlink" title="æµ®ç‚¹è®¡ç®—çš„é—®é¢˜"></a>æµ®ç‚¹è®¡ç®—çš„é—®é¢˜</h1><pre><code class="javascript">0.1 + 0.2 === 0.3 // is false 9007199254740992 + 1 // is equal to 90071992547409929007199254740992 + 2 // is equal to 9007199254740994</code></pre><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸º0.1+0.2ç­‰äº0.30000000000000004ã€‚JavaScriptçš„æ•°å­—éƒ½éµå¾ªIEEE 754æ ‡å‡†æ„å»ºï¼Œåœ¨å†…éƒ¨éƒ½æ˜¯64ä½æµ®ç‚¹å°æ•°è¡¨ç¤ºï¼Œå…·ä½“å¯ä»¥å‚è§<a href="http://www.2ality.com/2012/04/number-encoding.html" target="_blank" rel="noopener">JavaScriptä¸­çš„æ•°å­—æ˜¯å¦‚ä½•ç¼–ç çš„</a>.</p><p>å¯ä»¥é€šè¿‡ä½¿ç”¨<strong>toFixed()</strong>å’Œ<strong>toPrecision()</strong>æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p><h1 id="é€šè¿‡for-inå¾ªç¯æ£€æŸ¥å¯¹è±¡çš„å±æ€§"><a href="#é€šè¿‡for-inå¾ªç¯æ£€æŸ¥å¯¹è±¡çš„å±æ€§" class="headerlink" title="é€šè¿‡for-inå¾ªç¯æ£€æŸ¥å¯¹è±¡çš„å±æ€§"></a>é€šè¿‡for-inå¾ªç¯æ£€æŸ¥å¯¹è±¡çš„å±æ€§</h1><p>ä¸‹é¢è¿™æ ·çš„ç”¨æ³•ï¼Œå¯ä»¥é˜²æ­¢è¿­ä»£çš„æ—¶å€™è¿›å…¥åˆ°å¯¹è±¡çš„åŸå‹å±æ€§ä¸­ã€‚</p><pre><code class="javascript">for (var name in object) {      if (object.hasOwnProperty(name)) {         // do something with name    }  }</code></pre><h1 id="é€—å·æ“ä½œç¬¦"><a href="#é€—å·æ“ä½œç¬¦" class="headerlink" title="é€—å·æ“ä½œç¬¦"></a>é€—å·æ“ä½œç¬¦</h1><pre><code class="javascript">var a = 0; var b = ( a++, 99 ); console.log(a);  // a will be equal to 1 console.log(b);  // b is equal to 99</code></pre><h1 id="ä¸´æ—¶å­˜å‚¨ç”¨äºè®¡ç®—å’ŒæŸ¥è¯¢çš„å˜é‡"><a href="#ä¸´æ—¶å­˜å‚¨ç”¨äºè®¡ç®—å’ŒæŸ¥è¯¢çš„å˜é‡" class="headerlink" title="ä¸´æ—¶å­˜å‚¨ç”¨äºè®¡ç®—å’ŒæŸ¥è¯¢çš„å˜é‡"></a>ä¸´æ—¶å­˜å‚¨ç”¨äºè®¡ç®—å’ŒæŸ¥è¯¢çš„å˜é‡</h1><p>åœ¨jQueryé€‰æ‹©å™¨ä¸­ï¼Œå¯ä»¥ä¸´æ—¶å­˜å‚¨æ•´ä¸ªDOMå…ƒç´ </p><pre><code class="javascript">var navright = document.querySelector(&#39;#right&#39;); var navleft = document.querySelector(&#39;#left&#39;); var navup = document.querySelector(&#39;#up&#39;); var navdown = document.querySelector(&#39;#down&#39;);</code></pre><h1 id="æå‰æ£€æŸ¥ä¼ å…¥-isFinite-çš„å‚æ•°"><a href="#æå‰æ£€æŸ¥ä¼ å…¥-isFinite-çš„å‚æ•°" class="headerlink" title="æå‰æ£€æŸ¥ä¼ å…¥ isFinite() çš„å‚æ•°"></a>æå‰æ£€æŸ¥ä¼ å…¥ isFinite() çš„å‚æ•°</h1><pre><code class="javascript">isFinite(0/0) ; // falseisFinite(&quot;foo&quot;); // falseisFinite(&quot;10&quot;); // trueisFinite(10);   // trueisFinite(undefined);  // falseisFinite();   // falseisFinite(null);  // trueï¼Œè¿™ç‚¹å½“ç‰¹åˆ«æ³¨æ„</code></pre><h1 id="é¿å…åœ¨æ•°ç»„ä¸­ä½¿ç”¨è´Ÿæ•°åšç´¢å¼•"><a href="#é¿å…åœ¨æ•°ç»„ä¸­ä½¿ç”¨è´Ÿæ•°åšç´¢å¼•" class="headerlink" title="é¿å…åœ¨æ•°ç»„ä¸­ä½¿ç”¨è´Ÿæ•°åšç´¢å¼•"></a>é¿å…åœ¨æ•°ç»„ä¸­ä½¿ç”¨è´Ÿæ•°åšç´¢å¼•</h1><pre><code class="javascript">var numbersArray = [1,2,3,4,5];var from = numbersArray.indexOf(&quot;foo&quot;) ;  // from is equal to -1numbersArray.splice(from,2);    // will return [5]</code></pre><p>æ³¨æ„ä¼ ç»™spliceçš„ç´¢å¼•å‚æ•°ä¸è¦æ˜¯è´Ÿæ•°ï¼Œå½“æ˜¯è´Ÿæ•°æ—¶ï¼Œä¼šä»æ•°ç»„ç»“å°¾å¤„åˆ é™¤å…ƒç´ ã€‚</p><h1 id="ç”¨JSONæ¥åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#ç”¨JSONæ¥åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="ç”¨JSONæ¥åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>ç”¨JSONæ¥åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h1><pre><code class="javascript">var person = {name :&#39;Saad&#39;, age : 26, department : {ID : 15, name : &quot;R&amp;D&quot;} };var stringFromPerson = JSON.stringify(person);/* stringFromPerson ç»“æœä¸º &quot;{&quot;name&quot;:&quot;Saad&quot;,&quot;age&quot;:26,&quot;department&quot;:{&quot;ID&quot;:15,&quot;name&quot;:&quot;R&amp;D&quot;}}&quot;   */var personFromString = JSON.parse(stringFromPerson);/* personFromString çš„å€¼ä¸ person å¯¹è±¡ç›¸åŒ  */</code></pre><h1 id="ä¸è¦ä½¿ç”¨eval-æˆ–è€…å‡½æ•°æ„é€ å™¨"><a href="#ä¸è¦ä½¿ç”¨eval-æˆ–è€…å‡½æ•°æ„é€ å™¨" class="headerlink" title="ä¸è¦ä½¿ç”¨eval()æˆ–è€…å‡½æ•°æ„é€ å™¨"></a>ä¸è¦ä½¿ç”¨eval()æˆ–è€…å‡½æ•°æ„é€ å™¨</h1><p>eval()å’Œå‡½æ•°æ„é€ å™¨ï¼ˆFunction consturctorï¼‰çš„å¼€é”€è¾ƒå¤§ï¼Œæ¯æ¬¡è°ƒç”¨ï¼ŒJavaScriptå¼•æ“éƒ½è¦å°†æºä»£ç è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„ä»£ç ã€‚</p><pre><code class="javascript">var func1 = new Function(functionCode);var func2 = eval(functionCode);</code></pre><h1 id="é¿å…ä½¿ç”¨with"><a href="#é¿å…ä½¿ç”¨with" class="headerlink" title="é¿å…ä½¿ç”¨with()"></a>é¿å…ä½¿ç”¨with()</h1><p>ä½¿ç”¨with()å¯ä»¥æŠŠå˜é‡åŠ å…¥åˆ°å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå› æ­¤ï¼Œå¦‚æœæœ‰å…¶å®ƒçš„åŒåå˜é‡ï¼Œä¸€æ¥å®¹æ˜“æ··æ·†ï¼ŒäºŒæ¥å€¼ä¹Ÿä¼šè¢«è¦†ç›–</p><h1 id="ä¸è¦å¯¹æ•°ç»„ä½¿ç”¨for-in"><a href="#ä¸è¦å¯¹æ•°ç»„ä½¿ç”¨for-in" class="headerlink" title="ä¸è¦å¯¹æ•°ç»„ä½¿ç”¨for-in"></a>ä¸è¦å¯¹æ•°ç»„ä½¿ç”¨for-in</h1><p>é¿å…ï¼š</p><pre><code class="javascript">var sum = 0;  for (var i in arrayNumbers) {      sum += arrayNumbers[i];  }</code></pre><p>è€Œæ˜¯:</p><pre><code class="javascript">var sum = 0;  for (var i = 0, len = arrayNumbers.length; i &lt; len; i++) {      sum += arrayNumbers[i];  }</code></pre><p>å¦å¤–ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œiå’Œlenä¸¤ä¸ªå˜é‡æ˜¯åœ¨forå¾ªç¯çš„ç¬¬ä¸€ä¸ªå£°æ˜ä¸­ï¼ŒäºŒè€…åªä¼šåˆå§‹åŒ–ä¸€æ¬¡ï¼Œè¿™è¦æ¯”ä¸‹é¢è¿™ç§å†™æ³•å¿«ï¼š</p><pre><code class="javascript">for (var i = 0; i &lt; arrayNumbers.length; i++)</code></pre><h1 id="ä¼ ç»™setInterval-å’ŒsetTimeout-æ—¶ä½¿ç”¨å‡½æ•°è€Œä¸æ˜¯å­—ç¬¦ä¸²"><a href="#ä¼ ç»™setInterval-å’ŒsetTimeout-æ—¶ä½¿ç”¨å‡½æ•°è€Œä¸æ˜¯å­—ç¬¦ä¸²" class="headerlink" title="ä¼ ç»™setInterval()å’ŒsetTimeout()æ—¶ä½¿ç”¨å‡½æ•°è€Œä¸æ˜¯å­—ç¬¦ä¸²"></a>ä¼ ç»™setInterval()å’ŒsetTimeout()æ—¶ä½¿ç”¨å‡½æ•°è€Œä¸æ˜¯å­—ç¬¦ä¸²</h1><p>å¦‚æœä¼ ç»™setTimeout()å’ŒsetInterval()ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»–ä»¬å°†ä¼šç”¨ç±»ä¼¼äºevalæ–¹å¼è¿›è¡Œè½¬æ¢ï¼Œè¿™è‚¯å®šä¼šè¦æ…¢äº›ï¼Œå› æ­¤ä¸è¦ä½¿ç”¨ï¼š</p><pre><code class="javascript">setInterval(&#39;doSomethingPeriodically()&#39;, 1000);  setTimeout(&#39;doSomethingAfterFiveSeconds()&#39;, 5000);</code></pre><p>è€Œæ˜¯ç”¨ï¼š</p><pre><code class="javascript">setInterval(doSomethingPeriodically, 1000);  setTimeout(doSomethingAfterFiveSeconds, 5000);</code></pre><h1 id="ä½¿ç”¨switch-caseä»£æ›¿ä¸€å¤§å çš„if-else"><a href="#ä½¿ç”¨switch-caseä»£æ›¿ä¸€å¤§å çš„if-else" class="headerlink" title="ä½¿ç”¨switch/caseä»£æ›¿ä¸€å¤§å çš„if/else"></a>ä½¿ç”¨switch/caseä»£æ›¿ä¸€å¤§å çš„if/else</h1><p>å½“åˆ¤æ–­æœ‰è¶…è¿‡ä¸¤ä¸ªåˆ†æ”¯çš„æ—¶å€™ä½¿ç”¨switch/caseè¦æ›´å¿«ä¸€äº›ï¼Œè€Œä¸”ä¹Ÿæ›´ä¼˜é›…ï¼Œæ›´åˆ©äºä»£ç çš„ç»„ç»‡ï¼Œå½“ç„¶ï¼Œå¦‚æœæœ‰è¶…è¿‡10ä¸ªåˆ†æ”¯ï¼Œå°±ä¸è¦ä½¿ç”¨switch/caseäº†ã€‚</p><h1 id="åœ¨switch-caseä¸­ä½¿ç”¨æ•°å­—åŒºé—´"><a href="#åœ¨switch-caseä¸­ä½¿ç”¨æ•°å­—åŒºé—´" class="headerlink" title="åœ¨switch/caseä¸­ä½¿ç”¨æ•°å­—åŒºé—´"></a>åœ¨switch/caseä¸­ä½¿ç”¨æ•°å­—åŒºé—´</h1><p>å…¶å®ï¼Œswitch/caseä¸­çš„caseæ¡ä»¶ï¼Œè¿˜å¯ä»¥è¿™æ ·å†™ï¼š</p><pre><code class="javascript">function getCategory(age) {      var category = &quot;&quot;;      switch (true) {          case isNaN(age):              category = &quot;not an age&quot;;              break;          case (age &gt;= 50):              category = &quot;Old&quot;;              break;          case (age &lt;= 20):              category = &quot;Baby&quot;;              break;          default:              category = &quot;Young&quot;;              break;      };      return category;  }  getCategory(5);  // å°†è¿”å› &quot;Baby&quot;</code></pre><h1 id="ä½¿ç”¨å¯¹è±¡ä½œä¸ºå¯¹è±¡çš„åŸå‹"><a href="#ä½¿ç”¨å¯¹è±¡ä½œä¸ºå¯¹è±¡çš„åŸå‹" class="headerlink" title="ä½¿ç”¨å¯¹è±¡ä½œä¸ºå¯¹è±¡çš„åŸå‹"></a>ä½¿ç”¨å¯¹è±¡ä½œä¸ºå¯¹è±¡çš„åŸå‹</h1><p>ä¸‹é¢è¿™æ ·ï¼Œä¾¿å¯ä»¥ç»™å®šå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œæ¥åˆ›å»ºä»¥æ­¤ä¸ºåŸå‹çš„æ–°å¯¹è±¡ï¼š</p><pre><code class="javascript">function clone(object) {      function OneShotConstructor(){};     OneShotConstructor.prototype = object;      return new OneShotConstructor(); } clone(Array).prototype ;  // []</code></pre><h1 id="HTMLå­—æ®µè½¬æ¢å‡½æ•°"><a href="#HTMLå­—æ®µè½¬æ¢å‡½æ•°" class="headerlink" title="HTMLå­—æ®µè½¬æ¢å‡½æ•°"></a>HTMLå­—æ®µè½¬æ¢å‡½æ•°</h1><pre><code class="javascript">function escapeHTML(text) {      var replacements= {&quot;&lt;&quot;: &quot;&amp;lt;&quot;, &quot;&gt;&quot;: &quot;&amp;gt;&quot;,&quot;&amp;&quot;: &quot;&amp;amp;&quot;, &quot;\&quot;&quot;: &quot;&amp;quot;&quot;};                          return text.replace(/[&lt;&gt;&amp;&quot;]/g, function(character) {          return replacements[character];      }); }</code></pre><h1 id="ä¸è¦åœ¨å¾ªç¯å†…éƒ¨ä½¿ç”¨try-catch-finally"><a href="#ä¸è¦åœ¨å¾ªç¯å†…éƒ¨ä½¿ç”¨try-catch-finally" class="headerlink" title="ä¸è¦åœ¨å¾ªç¯å†…éƒ¨ä½¿ç”¨try-catch-finally"></a>ä¸è¦åœ¨å¾ªç¯å†…éƒ¨ä½¿ç”¨try-catch-finally</h1><p>try-catch-finallyä¸­catchéƒ¨åˆ†åœ¨æ‰§è¡Œæ—¶ä¼šå°†å¼‚å¸¸èµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªå˜é‡ä¼šè¢«æ„å»ºæˆä¸€ä¸ªè¿è¡Œæ—¶ä½œç”¨åŸŸå†…çš„æ–°çš„å˜é‡ã€‚<br>åˆ‡å¿Œï¼š</p><pre><code class="javascript">var object = [&#39;foo&#39;, &#39;bar&#39;], i;  for (i = 0, len = object.length; i &lt;len; i++) {      try {          // do something that throws an exception     }      catch (e) {           // handle exception      } }</code></pre><p>è€Œåº”è¯¥ï¼š</p><pre><code class="javascript">var object = [&#39;foo&#39;, &#39;bar&#39;], i;  try {     for (i = 0, len = object.length; i &lt;len; i++) {          // do something that throws an exception     } } catch (e) {       // handle exception  }</code></pre><h1 id="ä½¿ç”¨XMLHttpRequestsæ—¶æ³¨æ„è®¾ç½®è¶…æ—¶"><a href="#ä½¿ç”¨XMLHttpRequestsæ—¶æ³¨æ„è®¾ç½®è¶…æ—¶" class="headerlink" title="ä½¿ç”¨XMLHttpRequestsæ—¶æ³¨æ„è®¾ç½®è¶…æ—¶"></a>ä½¿ç”¨XMLHttpRequestsæ—¶æ³¨æ„è®¾ç½®è¶…æ—¶</h1><p>XMLHttpRequestsåœ¨æ‰§è¡Œæ—¶ï¼Œå½“é•¿æ—¶é—´æ²¡æœ‰å“åº”ï¼ˆå¦‚å‡ºç°ç½‘ç»œé—®é¢˜ç­‰ï¼‰æ—¶ï¼Œåº”è¯¥ä¸­æ­¢æ‰è¿æ¥ï¼Œå¯ä»¥é€šè¿‡setTimeout()æ¥å®Œæˆè¿™ä¸ªå·¥ä½œï¼š</p><pre><code class="javascript">var xhr = new XMLHttpRequest (); xhr.onreadystatechange = function () {      if (this.readyState == 4) {          clearTimeout(timeout);          // do something with response data     }  }  var timeout = setTimeout( function () {      xhr.abort(); // call error callback  }, 60*1000 /* timeout after a minute */ ); xhr.open(&#39;GET&#39;, url, true);  xhr.send();</code></pre><p>åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸è¦åŒæ—¶å‘èµ·å¤šä¸ªXMLHttpRequestsè¯·æ±‚ã€‚</p><h1 id="å¤„ç†WebSocketçš„è¶…æ—¶"><a href="#å¤„ç†WebSocketçš„è¶…æ—¶" class="headerlink" title="å¤„ç†WebSocketçš„è¶…æ—¶"></a>å¤„ç†WebSocketçš„è¶…æ—¶</h1><p>é€šå¸¸æƒ…å†µä¸‹ï¼ŒWebSocketè¿æ¥åˆ›å»ºåï¼Œå¦‚æœ30ç§’å†…æ²¡æœ‰ä»»ä½•æ´»åŠ¨ï¼ŒæœåŠ¡å™¨ç«¯ä¼šå¯¹è¿æ¥è¿›è¡Œè¶…æ—¶å¤„ç†ï¼Œé˜²ç«å¢™ä¹Ÿå¯ä»¥å¯¹å•ä½å‘¨æœŸæ²¡æœ‰æ´»åŠ¨çš„è¿æ¥è¿›è¡Œè¶…æ—¶å¤„ç†ã€‚</p><p>ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œå¯ä»¥æ¯éš”ä¸€å®šæ—¶é—´ï¼Œå¾€æœåŠ¡å™¨å‘é€ä¸€æ¡ç©ºçš„æ¶ˆæ¯ã€‚å¯ä»¥é€šè¿‡ä¸‹é¢è¿™ä¸¤ä¸ªå‡½æ•°æ¥å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œä¸€ä¸ªç”¨äºä½¿è¿æ¥ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œå¦ä¸€ä¸ªä¸“é—¨ç”¨äºç»“æŸè¿™ä¸ªçŠ¶æ€ã€‚</p><pre><code class="javascript">var timerID = 0; function keepAlive() {     var timeout = 15000;      if (webSocket.readyState == webSocket.OPEN) {          webSocket.send(&#39;&#39;);      }      timerId = setTimeout(keepAlive, timeout);  }  function cancelKeepAlive() {      if (timerId) {          cancelTimeout(timerId);      }  }</code></pre><p>keepAlive()å‡½æ•°å¯ä»¥æ”¾åœ¨WebSocketè¿æ¥çš„onOpen()æ–¹æ³•çš„æœ€åé¢ï¼ŒcancelKeepAlive()æ”¾åœ¨onClose()æ–¹æ³•çš„æœ€æœ«å°¾</p><h1 id="æ—¶é—´æ³¨æ„åŸå§‹æ“ä½œç¬¦æ¯”å‡½æ•°è°ƒç”¨å¿«ï¼Œä½¿ç”¨VanillaJS"><a href="#æ—¶é—´æ³¨æ„åŸå§‹æ“ä½œç¬¦æ¯”å‡½æ•°è°ƒç”¨å¿«ï¼Œä½¿ç”¨VanillaJS" class="headerlink" title="æ—¶é—´æ³¨æ„åŸå§‹æ“ä½œç¬¦æ¯”å‡½æ•°è°ƒç”¨å¿«ï¼Œä½¿ç”¨VanillaJS"></a>æ—¶é—´æ³¨æ„<a href="https://dev.opera.com/articles/efficient-javascript/?page=2#primitiveoperator" target="_blank" rel="noopener">åŸå§‹æ“ä½œç¬¦æ¯”å‡½æ•°è°ƒç”¨å¿«</a>ï¼Œä½¿ç”¨<a href="http://vanilla-js.com/" target="_blank" rel="noopener">VanillaJS</a></h1><p>æ¯”å¦‚ï¼Œä¸€èˆ¬ä¸è¦è¿™æ ·ï¼š</p><pre><code class="javascript">var min = Math.min(a,b); A.push(v);</code></pre><p>å¯ä»¥è¿™æ ·æ¥ä»£æ›¿ï¼š</p><pre><code class="javascript">var min = a &lt; b ? a : b; A[A.length] = v;</code></pre><h1 id="å¼€å‘æ—¶æ³¨æ„ä»£ç ç»“æ„ï¼Œä¸Šçº¿å‰æ£€æŸ¥å¹¶å‹ç¼©JavaScriptä»£ç "><a href="#å¼€å‘æ—¶æ³¨æ„ä»£ç ç»“æ„ï¼Œä¸Šçº¿å‰æ£€æŸ¥å¹¶å‹ç¼©JavaScriptä»£ç " class="headerlink" title="å¼€å‘æ—¶æ³¨æ„ä»£ç ç»“æ„ï¼Œä¸Šçº¿å‰æ£€æŸ¥å¹¶å‹ç¼©JavaScriptä»£ç "></a>å¼€å‘æ—¶æ³¨æ„ä»£ç ç»“æ„ï¼Œä¸Šçº¿å‰æ£€æŸ¥å¹¶å‹ç¼©JavaScriptä»£ç </h1><p>å¯ä»¥ä½¿ç”¨JSLintæˆ–JSMinç­‰å·¥å…·æ¥æ£€æŸ¥å¹¶å‹ç¼©ä»£ç ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10ä¸ªæœ€ä½³ES6ç‰¹æ€§</title>
      <link href="/2018/02/26/Js/10%E4%B8%AA%E6%9C%80%E4%BD%B3ES6%E7%89%B9%E6%80%A7/"/>
      <url>/2018/02/26/Js/10%E4%B8%AA%E6%9C%80%E4%BD%B3ES6%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="10ä¸ªæœ€ä½³ES6ç‰¹æ€§"><a href="#10ä¸ªæœ€ä½³ES6ç‰¹æ€§" class="headerlink" title="10ä¸ªæœ€ä½³ES6ç‰¹æ€§"></a>10ä¸ªæœ€ä½³ES6ç‰¹æ€§</h1><p><a href="https://segmentfault.com/a/1190000010907053" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><p>ES6ï¼Œæ­£å¼åç§°æ˜¯ECMAScript2015ï¼Œä½†æ˜¯ES6è¿™ä¸ªåç§°æ›´åŠ ç®€æ´ã€‚ES6å·²ç»ä¸å†æ˜¯JavaScriptæœ€æ–°çš„æ ‡å‡†ï¼Œä½†æ˜¯å®ƒå·²ç»å¹¿æ³›ç”¨äºç¼–ç¨‹å®è·µä¸­ã€‚å¦‚æœä½ è¿˜æ²¡ç”¨è¿‡ES6ï¼Œç°åœ¨è¿˜ä¸ç®—å¤ªæ™šâ€¦</p><h2 id="å‡½æ•°å‚æ•°é»˜è®¤å€¼"><a href="#å‡½æ•°å‚æ•°é»˜è®¤å€¼" class="headerlink" title="å‡½æ•°å‚æ•°é»˜è®¤å€¼"></a>å‡½æ•°å‚æ•°é»˜è®¤å€¼</h2><p><strong>ä¸ä½¿ç”¨ES6</strong><br>ä¸ºå‡½æ•°è®¾ç½®é»˜è®¤å€¼</p><pre><code class="javascript">function foo(height, color){    var height = height || 50;    var color = color || &#39;red&#39;;    //...}</code></pre><p>è¿™æ ·å†™ä¸€èˆ¬æ²¡é—®é¢˜ï¼Œä½†æ˜¯ï¼Œå½“å‚æ•°çš„å¸ƒå°”å€¼ä¸ºfalseæ—¶ï¼Œæ˜¯ä¼šå‡ºäº‹æƒ…çš„ï¼æ¯”å¦‚ï¼Œæˆ‘ä»¬è¿™æ ·è°ƒç”¨fooå‡½æ•°ï¼š</p><a id="more"></a><pre><code class="javascript">foo(0, &quot;&quot;, &quot;&quot;)</code></pre><p>å› ä¸º0çš„å¸ƒå°”å€¼ä¸ºfalseï¼Œè¿™æ ·heightçš„å–å€¼å°†æ˜¯50ã€‚åŒç†colorçš„å–å€¼ä¸ºâ€™redâ€™ã€‚<br><strong>ä½¿ç”¨ES6</strong></p><pre><code class="javascript">function foo(height = 50, color = &#39;red&#39;){    // ...}</code></pre><h2 id="æ¨¡æ¿å­—ç¬¦ä¸²"><a href="#æ¨¡æ¿å­—ç¬¦ä¸²" class="headerlink" title="æ¨¡æ¿å­—ç¬¦ä¸²"></a>æ¨¡æ¿å­—ç¬¦ä¸²</h2><p><strong>ä¸ä½¿ç”¨ES6</strong><br>ä½¿ç”¨+å·å°†å˜é‡æ‹¼æ¥æˆå­—ç¬¦ä¸²</p><pre><code class="javascript">var name = &#39;Your name is &#39; + first + &#39; &#39; + last + &#39;.&#39;</code></pre><p><strong>ä½¿ç”¨ES6</strong><br>å°†å˜é‡æ”¾åˆ°<strong><code></code></strong>æ‹¬å·ä¸­</p><pre><code class="javascript">var name = `Your name is ${first} ${last}.`</code></pre><p>ES6çš„å†™æ³•æ›´åŠ ç®€æ´ã€ç›´è§‚ã€‚</p><h2 id="å¤šè¡Œå­—ç¬¦ä¸²"><a href="#å¤šè¡Œå­—ç¬¦ä¸²" class="headerlink" title="å¤šè¡Œå­—ç¬¦ä¸²"></a>å¤šè¡Œå­—ç¬¦ä¸²</h2><p><strong>ä¸ä½¿ç”¨ES6</strong><br>ä½¿ç”¨â€ntâ€å°†å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥èµ·æ¥ï¼š</p><pre><code class="javascript">var roadPoem = &#39;Then took the other, as just as fair,\n\t&#39;    + &#39;And having perhaps the better claim\n\t&#39;    + &#39;Because it was grassy and wanted wear,\n\t&#39;    + &#39;Though as for that the passing there\n\t&#39;    + &#39;Had worn them really about the same,\n\t&#39;</code></pre><p><strong>ä½¿ç”¨ES6</strong><br>å°†å¤šè¡Œå­—ç¬¦ä¸²æ”¾åœ¨åå¼•å·<code></code>ä¹‹é—´å°±å¥½äº†ï¼š</p><pre><code class="javascript">var roadPoem = `Then took the other, as just as fair,    And having perhaps the better claim    Because it was grassy and wanted wear,    Though as for that the passing there    Had worn them really about the same,`</code></pre><h2 id="è§£æ„èµ‹å€¼"><a href="#è§£æ„èµ‹å€¼" class="headerlink" title="è§£æ„èµ‹å€¼"></a>è§£æ„èµ‹å€¼</h2><p><strong>ä¸ä½¿ç”¨ES6</strong><br>å½“éœ€è¦è·å–æŸä¸ªå¯¹è±¡çš„å±æ€§å€¼æ—¶ï¼Œéœ€è¦å•ç‹¬è·å–ï¼š</p><pre><code class="javascript">var data = $(&#39;body&#39;).data(); // dataæœ‰houseå’Œmouseå±æ€§var house = data.house;var mouse = data.mouse;</code></pre><p><strong>ä½¿ç”¨ES6</strong><br>ä¸€æ¬¡æ€§è·å–å¯¹è±¡çš„å­å±æ€§ï¼š</p><pre><code class="javascript">var { house, mouse} = $(&#39;body&#39;).data()</code></pre><p>å¯¹äºæ•°ç»„ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼š</p><pre><code class="javascript">var [col1, col2] = $(&#39;.column&#39;)ï¼›</code></pre><h2 id="å¯¹è±¡å±æ€§ç®€å†™"><a href="#å¯¹è±¡å±æ€§ç®€å†™" class="headerlink" title="å¯¹è±¡å±æ€§ç®€å†™"></a>å¯¹è±¡å±æ€§ç®€å†™</h2><p><strong>ä¸ä½¿ç”¨ES6</strong><br>å¯¹è±¡ä¸­å¿…é¡»åŒ…å«å±æ€§å’Œå€¼ï¼Œæ˜¾å¾—éå¸¸å¤šä½™ï¼š</p><pre><code class="javascript">var bar = &#39;bar&#39;;var foo = function (){    // ...}var baz = {  bar: bar,  foo: foo};</code></pre><p><strong>ä½¿ç”¨ES6</strong><br>å¯¹è±¡ä¸­ç›´æ¥å†™å˜é‡ï¼Œéå¸¸ç®€å•ï¼š</p><pre><code class="javascript">var bar = &#39;bar&#39;;var foo = function(){// ...}var baz = {bar,foo}</code></pre><h2 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h2><p><strong>ä¸ä½¿ç”¨ES6</strong><br>æ™®é€šå‡½æ•°ä½“å†…çš„thisï¼ŒæŒ‡å‘è°ƒç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚</p><pre><code class="javascript">function foo(){    console.log(this.id);}var id = 1;foo(); // è¾“å‡º1foo.call({ id: 2 }); // è¾“å‡º2</code></pre><p><strong>ä½¿ç”¨ES6</strong><br>ç®­å¤´å‡½æ•°ä½“å†…çš„thisï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯è°ƒç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚</p><pre><code class="javascript">var foo = () =&gt; {  console.log(this.id);}var id = 1;foo(); // è¾“å‡º1foo.call({ id: 2 }); // è¾“å‡º1</code></pre><h2 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h2><p><strong>ä¸ä½¿ç”¨ES6</strong><br>åµŒå¥—ä¸¤ä¸ªsetTimeoutå›è°ƒå‡½æ•°ï¼š</p><pre><code class="javascript">setTimeout(function(){    console.log(&#39;Hello&#39;); // 1ç§’åè¾“å‡º&quot;Hello&quot;    setTimeout(function()    {        console.log(&#39;Fundebug&#39;); // 2ç§’åè¾“å‡º&quot;Fundebug&quot;    }, 1000);}, 1000);</code></pre><p><strong>ä½¿ç”¨ES6</strong><br>ä½¿ç”¨ä¸¤ä¸ªthenæ˜¯å¼‚æ­¥ç¼–ç¨‹ä¸²è¡ŒåŒ–ï¼Œé¿å…äº†å›è°ƒåœ°ç‹±ï¼š</p><pre><code class="javascript">var wait1000 = new Promise(function(resolve, reject){    setTimeout(resolve, 1000);});wait1000    .then(function()    {        console.log(&quot;Hello&quot;); // 1ç§’åè¾“å‡º&quot;Hello&quot;        return wait1000;    })    .then(function()    {        console.log(&quot;Fundebug&quot;); // 2ç§’åè¾“å‡º&quot;Fundebug&quot;    });</code></pre><h2 id="letä¸const"><a href="#letä¸const" class="headerlink" title="letä¸const"></a>letä¸const</h2><p><strong>ä½¿ç”¨Var</strong><br><strong>var</strong>å®šä¹‰çš„å˜é‡æœªå‡½æ•°çº§ä½œç”¨åŸŸï¼š</p><pre><code class="javascript">{  var a = 10;}console.log(a); // è¾“å‡º10</code></pre><p><strong>ä½¿ç”¨letä¸const</strong><br>letå®šä¹‰çš„å˜é‡ä¸ºå—çº§ä½œç”¨åŸŸï¼Œå› æ­¤ä¼šæŠ¥é”™ï¼š(å¦‚æœä½ å¸Œæœ›å®æ—¶ç›‘æ§JavaScriptåº”ç”¨çš„é”™è¯¯ï¼Œæ¬¢è¿å…è´¹ä½¿ç”¨Fundebug)</p><pre><code class="javascript">{  let a = 10;}console.log(a); // æŠ¥é”™â€œReferenceError: a is not definedâ€</code></pre><p>constä¸letä¸€æ ·ï¼Œä¹Ÿæ˜¯å—çº§ä½œç”¨åŸŸã€‚constæ˜¯ç”¨æ¥å®šä¹‰å¸¸é‡</p><h2 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h2><p><strong>ä¸ä½¿ç”¨ES6</strong><br>ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ï¼š</p><pre><code class="javascript">function Point(x, y){    this.x = x;    this.y = y;    this.add = function()    {        return this.x + this.y;    };}var p = new Point(1, 2);console.log(p.add()); // è¾“å‡º3</code></pre><p><strong>ä½¿ç”¨ES6</strong><br>ä½¿ç”¨<strong>Class</strong>å®šä¹‰ç±»ï¼Œæ›´åŠ è§„èŒƒï¼Œä¸”ä½ èƒ½å¤Ÿç»§æ‰¿ï¼š</p><pre><code class="javascript">class Point{    constructor(x, y)    {        this.x = x;        this.y = y;    }    add()    {        return this.x + this.y;    }}var p = new Point(1, 2);console.log(p.add()); // è¾“å‡º3</code></pre><h2 id="æ¨¡å—åŒ–"><a href="#æ¨¡å—åŒ–" class="headerlink" title="æ¨¡å—åŒ–"></a>æ¨¡å—åŒ–</h2><p>JavaScriptä¸€ç›´æ²¡æœ‰å®˜æ–¹çš„æ¨¡å—åŒ–è§£å†³æ–¹æ¡ˆï¼Œå¼€å‘è€…åœ¨å®è·µä¸­ä¸»è¦é‡‡ç”¨CommonJSå’ŒAMDè§„èŒƒã€‚è€ŒES6åˆ¶å®šäº†æ¨¡å—(Module)åŠŸèƒ½ã€‚</p><p><strong>ä¸ä½¿ç”¨ES6</strong><br>Node.jsé‡‡ç”¨<strong>CommenJS</strong>è§„èŒƒå®ç°äº†æ¨¡å—åŒ–ï¼Œè€Œå‰ç«¯ä¹Ÿå¯ä»¥é‡‡ç”¨ï¼Œåªæ˜¯åœ¨éƒ¨ç½²æ—¶éœ€è¦ä½¿ç”¨<strong>Browserify</strong>ç­‰å·¥å…·æ‰“åŒ…ã€‚è¿™é‡Œä¸å¦¨ä»‹ç»ä¸€ä¸‹<strong>CommenJS</strong>è§„èŒƒã€‚</p><p>module.jsä¸­ä½¿ç”¨module.exportså¯¼å‡ºportå˜é‡å’ŒgetAccountså‡½æ•°ï¼š</p><pre><code class="javascript">module.exports = {  port: 3000,  getAccounts: function() {    ...  }}main.jsä¸­ä½¿ç”¨requireå¯¼å…¥module.jsï¼švar service = require(&#39;module.js&#39;)console.log(service.port) // è¾“å‡º3000</code></pre><p><strong>ä½¿ç”¨ES6</strong><br>ES6ä¸­ä½¿ç”¨exportä¸importå…³é”®è¯å®ç°æ¨¡å—åŒ–ã€‚</p><p>module.jsä¸­ä½¿ç”¨exportå¯¼å‡ºportå˜é‡å’ŒgetAccountså‡½æ•°ï¼š</p><pre><code class="javascript">export var port = 3000export function getAccounts(url) {  ...}</code></pre><p>main.jsä¸­ä½¿ç”¨importå¯¼å…¥module.jsï¼Œå¯ä»¥æŒ‡å®šéœ€è¦å¯¼å…¥çš„å˜é‡ï¼š</p><pre><code class="javascript">import {port, getAccounts} from &#39;module&#39;console.log(port) // è¾“å‡º3000</code></pre><p>ä¹Ÿå¯ä»¥å°†å…¨éƒ¨å˜é‡å¯¼å…¥ï¼š</p><pre><code class="javascript">import * as service from &#39;module&#39;console.log(service.port) // 3000</code></pre>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React æŠ€æœ¯æ ˆ</title>
      <link href="/2018/02/25/React/React-%E6%8A%80%E6%9C%AF%E6%A0%88/"/>
      <url>/2018/02/25/React/React-%E6%8A%80%E6%9C%AF%E6%A0%88/</url>
      
        <content type="html"><![CDATA[<h1 id="React-æŠ€æœ¯æ ˆç³»åˆ—"><a href="#React-æŠ€æœ¯æ ˆç³»åˆ—" class="headerlink" title="React æŠ€æœ¯æ ˆç³»åˆ—"></a>React æŠ€æœ¯æ ˆç³»åˆ—</h1><p><a href="http://www.ruanyifeng.com/blog/2016/09/react-technology-stack.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><blockquote><ul><li><a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener">ES6æ•™ç¨‹</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/01/babel.html" target="_blank" rel="noopener">Bableæ•™ç¨‹</a></li><li><a href="http://www.ruanyifeng.com/blog/2015/03/react.html" target="_blank" rel="noopener">Reactæ•™ç¨‹</a>   <a href="https://github.com/ruanyf/react-demos" target="_blank" rel="noopener">ç¤ºä¾‹</a></li><li><a href="https://github.com/ruanyf/webpack-demos" target="_blank" rel="noopener">Webpack</a></li><li><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="noopener">Flexæ•™ç¨‹</a>  <a href="http://www.ruanyifeng.com/blog/2015/07/flex-examples.html" target="_blank" rel="noopener">ç¤ºä¾‹</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/06/css_modules.html" target="_blank" rel="noopener">Css Modules</a>  <a href="https://github.com/ruanyf/css-modules-demos" target="_blank" rel="noopener">ç¤ºä¾‹</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/05/react_router.html" target="_blank" rel="noopener">React-router</a> <a href="https://github.com/reactjs/react-router-tutorial/tree/master/lessons" target="_blank" rel="noopener">ç¤ºä¾‹</a></li><li>[Flux æ¶æ„] <a href="http://www.ruanyifeng.com/blog/2016/01/flux.html" target="_blank" rel="noopener">ç¤ºä¾‹</a> <a href="https://github.com/ruanyf/extremely-simple-flux-demo" target="_blank" rel="noopener">ç¤ºä¾‹</a></li><li>Reduxæ¶æ„  <a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_one_basic_usages.html" target="_blank" rel="noopener">æ•™ç¨‹ä¸€</a>  <a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_two_async_operations.html" target="_blank" rel="noopener">æ•™ç¨‹äºŒ</a>  <a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_three_react-redux.html" target="_blank" rel="noopener">æ•™ç¨‹ä¸‰</a></li><li><a href="http://www.ruanyifeng.com/blog/2015/12/a-mocha-tutorial-of-examples.html" target="_blank" rel="noopener">Mochaæµ‹è¯•æ¡†æ¶ æ•™ç¨‹</a>   <a href="https://github.com/ruanyf/mocha-demos" target="_blank" rel="noopener">ç¤ºä¾‹</a></li><li><a href="http://www.ruanyifeng.com/blog/2015/06/istanbul.html" target="_blank" rel="noopener">Istanbul è¦†ç›–ç‡æ¡†æ¶æ•™ç¨‹</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/02/react-testing-tutorial.html" target="_blank" rel="noopener">React å•å…ƒæµ‹è¯•æ•™ç¨‹</a>  <a href="https://github.com/ruanyf/react-testing-demo" target="_blank" rel="noopener">ç¤ºä¾‹</a></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gulpé…ç½®åŠä½¿ç”¨</title>
      <link href="/2018/02/24/Tools/gulp%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8/"/>
      <url>/2018/02/24/Tools/gulp%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="gulp-å…¥é—¨æŒ‡å—"><a href="#gulp-å…¥é—¨æŒ‡å—" class="headerlink" title="gulp å…¥é—¨æŒ‡å—"></a>gulp å…¥é—¨æŒ‡å—</h1><h2 id="1-å…¨å±€å®‰è£…-gulpï¼š"><a href="#1-å…¨å±€å®‰è£…-gulpï¼š" class="headerlink" title="1.å…¨å±€å®‰è£… gulpï¼š"></a>1.å…¨å±€å®‰è£… gulpï¼š</h2><pre><code class="javascript">$ npm install --global gulp</code></pre><h2 id="2-ä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰å®‰è£…ï¼š"><a href="#2-ä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰å®‰è£…ï¼š" class="headerlink" title="2.ä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰å®‰è£…ï¼š"></a>2.ä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰å®‰è£…ï¼š</h2><pre><code class="javascript">$ npm install --save-dev gulp</code></pre><h2 id="3-åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º-gulpfile-js-çš„æ–‡ä»¶ï¼š"><a href="#3-åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º-gulpfile-js-çš„æ–‡ä»¶ï¼š" class="headerlink" title="3. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º gulpfile.js çš„æ–‡ä»¶ï¼š"></a>3. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º gulpfile.js çš„æ–‡ä»¶ï¼š</h2><pre><code class="javascript">var gulp = require(&#39;gulp&#39;);gulp.task(&#39;default&#39;, function() {  // å°†ä½ çš„é»˜è®¤çš„ä»»åŠ¡ä»£ç æ”¾åœ¨è¿™});</code></pre><h2 id="4-è¿è¡Œ-gulpï¼š"><a href="#4-è¿è¡Œ-gulpï¼š" class="headerlink" title="4. è¿è¡Œ gulpï¼š"></a>4. è¿è¡Œ gulpï¼š</h2><pre><code class="javascript">$ gulp</code></pre><a id="more"></a><p><strong>äº”ä¸ªgulpå‘½ä»¤</strong>:</p><blockquote><p>gulp.task(name[, deps], fn) å®šä¹‰ä»»åŠ¡  nameï¼šä»»åŠ¡åç§° depsï¼šä¾èµ–ä»»åŠ¡åç§° fnï¼šå›è°ƒå‡½æ•°<br>gulp.run(tasksâ€¦)ï¼šå°½å¯èƒ½å¤šçš„å¹¶è¡Œè¿è¡Œå¤šä¸ªtask<br>gulp.watch(glob, fn)ï¼šå½“globå†…å®¹å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰§è¡Œfn<br>gulp.src(glob)ï¼šç½®éœ€è¦å¤„ç†çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯ä»¥æ˜¯å¤šä¸ªæ–‡ä»¶ä»¥æ•°ç»„çš„å½¢å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯æ­£åˆ™<br>gulp.dest(path[, options])ï¼šè®¾ç½®ç”Ÿæˆæ–‡ä»¶çš„è·¯å¾„</p></blockquote><h2 id="package-jsonæ–‡ä»¶"><a href="#package-jsonæ–‡ä»¶" class="headerlink" title="package.jsonæ–‡ä»¶"></a><strong>package.jsonæ–‡ä»¶</strong></h2><pre><code class="json">{  &quot;name&quot;: &quot;yunbaodan&quot;,  &quot;version&quot;: &quot;1.0.0&quot;,  &quot;description&quot;: &quot;2.0å‡çº§&quot;,  &quot;main&quot;: &quot;gulpfile.js&quot;,  &quot;scripts&quot;: {    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;  },  &quot;author&quot;: &quot;zhang&quot;,  &quot;license&quot;: &quot;ISC&quot;,  &quot;devDependencies&quot;: {    &quot;del&quot;: &quot;^3.0.0&quot;,    &quot;gulp&quot;: &quot;^3.9.1&quot;,    &quot;gulp-autoprefixer&quot;: &quot;^4.0.0&quot;,    &quot;gulp-cache&quot;: &quot;^1.0.1&quot;,    &quot;gulp-clean&quot;: &quot;^0.3.2&quot;,    &quot;gulp-concat&quot;: &quot;^2.6.1&quot;,    &quot;gulp-gh-pages&quot;: &quot;^0.5.4&quot;,    &quot;gulp-htmlmin&quot;: &quot;^3.0.0&quot;,    &quot;gulp-imagemin&quot;: &quot;^4.0.0&quot;,    &quot;gulp-jshint&quot;: &quot;^2.0.4&quot;,    &quot;gulp-less&quot;: &quot;^3.3.2&quot;,    &quot;gulp-livereload&quot;: &quot;^3.8.1&quot;,    &quot;gulp-minify-css&quot;: &quot;^1.2.4&quot;,    &quot;gulp-notify&quot;: &quot;^3.0.0&quot;,    &quot;gulp-postcss&quot;: &quot;^7.0.0&quot;,    &quot;gulp-rename&quot;: &quot;^1.2.2&quot;,    &quot;gulp-ruby-sass&quot;: &quot;^2.1.1&quot;,    &quot;gulp-file-include&quot;: &quot;^2.0.0&quot;,    &quot;gulp-sass&quot;: &quot;^3.1.0&quot;,    &quot;gulp-uglify&quot;: &quot;^3.0.0&quot;,    &quot;gulp-webserver&quot;: &quot;^0.9.1&quot;,    &quot;jshint&quot;: &quot;^2.9.5&quot;,    &quot;postcss-px-to-viewport&quot;: &quot;^0.0.3&quot;,    &quot;postcss-write-svg&quot;: &quot;jonathantneal/postcss-write-svg&quot;  }}</code></pre><h2 id="gulpfile-js-é…ç½®"><a href="#gulpfile-js-é…ç½®" class="headerlink" title="gulpfile.js é…ç½®"></a>gulpfile.js é…ç½®</h2><pre><code class="javascript">/** * Created by mac on 2017/11/9. *///å¯¼å…¥å·¥å…·åŒ… require(&#39;node_modulesé‡Œå¯¹åº”æ¨¡å—&#39;)var gulp = require(&#39;gulp&#39;),    postcss = require(&#39;gulp-postcss&#39;),    pxtoviewport = require(&#39;postcss-px-to-viewport&#39;),//å°†pxå•ä½æ¢ä½vwå•ä½    sass = require(&#39;gulp-sass&#39;),// CSSé¢„å¤„ç†/Sassç¼–è¯‘    autoprefixer = require(&#39;gulp-autoprefixer&#39;),//æ·»åŠ å‰ç¼€    minifycss = require(&#39;gulp-minify-css&#39;),//æ·»åŠ csså‹ç¼©æ–‡ä»¶    jshint = require(&#39;gulp-jshint&#39;),//jsä»£ç æ ¡æ­£    uglify = require(&#39;gulp-uglify&#39;),//jsä»£ç å‹ç¼©    imagemin = require(&#39;gulp-imagemin&#39;),//å›¾ç‰‡å‹ç¼©    rename = require(&#39;gulp-rename&#39;),//é‡å‘½å    clean = require(&#39;gulp-clean&#39;),//æ¸…é™¤åŸæ¥æ–‡ä»¶    concat = require(&#39;gulp-concat&#39;),//åˆå¹¶æ–‡ä»¶    notify = require(&#39;gulp-notify&#39;),//å¤„ç†æŠ¥é”™    cache = require(&#39;gulp-cache&#39;),//æ–‡ä»¶å¯¹æ¯”    livereload = require(&#39;gulp-livereload&#39;),//ç›‘å¬æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œæµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°    webserver = require(&#39;gulp-webserver&#39;),//å¼€å¯æœåŠ¡å™¨    ghPages = require(&#39;gulp-gh-pages&#39;),//README.mdç¼–è¯‘æˆhtml    htmlmin = require(&#39;gulp-htmlmin&#39;),//htmlå‹ç¼©    fileinclude  = require(&#39;gulp-file-include&#39;);//htmlæ¨¡æ¿å¼•æ“// æ ·å¼gulp.task(&#39;styles&#39;, function() {    var processors = [        pxtoviewport({            viewportWidth: 375,            viewportUnit: &#39;vw&#39;        })    ];    return gulp.src(&#39;src/styles/*.scss&#39;)        .pipe(sass({ style: &#39;expanded&#39;, }))        .pipe(autoprefixer(&#39;last 2 version&#39;, &#39;safari 5&#39;, &#39;ie 8&#39;, &#39;ie 9&#39;, &#39;opera 12.1&#39;, &#39;ios 6&#39;, &#39;android 4&#39;))        .pipe(gulp.dest(&#39;dist/styles&#39;))        .pipe(rename({ suffix: &#39;.min&#39; }))        .pipe(minifycss())        .pipe(gulp.dest(&#39;dist/styles&#39;))        .pipe(notify({ message: &#39;Styles task complete&#39; }))        .pipe(postcss(processors))        .pipe(gulp.dest(&#39;dist/styles&#39;))        .pipe(            postcss([                require(&#39;postcss-write-svg&#39;)({ /* options */ })            ])        ).pipe(            gulp.dest(&#39;dist/styles&#39;)        );});// jsgulp.task(&#39;scripts&#39;, function() {    return gulp.src(&#39;src/scripts/*.js&#39;)        .pipe(jshint.reporter(&#39;default&#39;))//æ£€æµ‹jsä»£ç é”™è¯¯        .on(&#39;error&#39;, function (err) {            console.error(&#39;Error!&#39;, err.message); // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯        })        .pipe(rename({ suffix: &#39;.min&#39; }))// é‡å‘½å        .pipe(uglify())        .pipe(gulp.dest(&#39;dist/scripts&#39;))        .pipe(notify({ message: &#39;Scripts task complete&#39; }));});// å›¾ç‰‡gulp.task(&#39;images&#39;, function() {    return gulp.src(&#39;src/images/*&#39;)        .pipe(cache(imagemin({ optimizationLevel: 3, progressive: true, interlaced: true })))        // .pipe(imagemin({        //     progressive: true, // æ— æŸå‹ç¼©JPGå›¾ç‰‡        //     svgoPlugins: [{removeViewBox: false}], // ä¸è¦ç§»é™¤svgçš„viewboxå±æ€§        //     use: [pngquant()] // æ·±åº¦å‹ç¼©PNG        // }))        .pipe(gulp.dest(&#39;dist/images&#39;))        .pipe(notify({ message: &#39;Images task complete&#39; }));});//htmlgulp.task(&#39;html&#39;,function () {    return gulp.src(&#39;./*.html&#39;)        .pipe(gulp.dest(&#39;./&#39;))        .pipe(notify({ message: &#39;html task complete&#39; }));});gulp.task(&#39;fileinclude&#39;, function() {   return gulp.src(&#39;./*.html&#39;)        .pipe(fileinclude({            prefix: &#39;@@&#39;,            basepath: &#39;@file&#39;        }))        .pipe(gulp.dest(&#39;dist&#39;));});// æ¸…ç†gulp.task(&#39;clean&#39;, function() {    return gulp.src([&#39;dist/styles&#39;, &#39;dist/scripts&#39;, &#39;dist/images&#39;], {read: false})        .pipe(clean());});//è‡ªåŠ¨åˆ·æ–°gulp.task(&#39;webserver&#39;,[&#39;fileinclude&#39;],function () {    return gulp.src( &#39;dist/&#39; ) // æœåŠ¡å™¨ç›®å½•ï¼ˆ./ä»£è¡¨æ ¹ç›®å½•ï¼‰        .pipe(webserver({ // è¿è¡Œgulp-webserver            livereload: true, // å¯ç”¨LiveReload            open: true // æœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨æ‰“å¼€ç½‘é¡µ        }));});// é¢„è®¾ä»»åŠ¡åŠç›‘å¬gulp.task(&#39;default&#39;, [&#39;webserver&#39;], function() {    gulp.run(&#39;styles&#39;, &#39;scripts&#39;, &#39;images&#39;);    // çœ‹å®ˆæ‰€æœ‰.scssæ¡£    gulp.watch(&#39;src/styles/*.scss&#39;, [&#39;styles&#39;]);    // çœ‹å®ˆæ‰€æœ‰.jsæ¡£    gulp.watch(&#39;src/scripts/*.js&#39;, [&#39;scripts&#39;]);    // çœ‹å®ˆæ‰€æœ‰å›¾ç‰‡æ¡£    gulp.watch(&#39;src/images/*.*&#39;, [&#39;images&#39;]);    //ç›‘å¬æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰htmlæ–‡ä»¶    gulp.watch( &#39;*.html&#39;, [&#39;html&#39;]); // ç›‘å¬æ ¹ç›®å½•ä¸‹æ‰€æœ‰.htmlæ–‡ä»¶});gulp.task(&#39;deploy&#39;, function() {    return gulp.src(&#39;./dist/**/*&#39;)        .pipe(ghPages());});gulp.task(&#39;testhtmlmin&#39;,function () {    var options = {        removeComments:true,        collapseWhitespace:true,        collapseBooleanAttributes:true,        removeEmptyAttributes:true,        removeScriptTypeAttributes:true,        removeStyleLinkTypeAttributes:true,        minifyJs:true,        minifyCss:true    }    gulp.src(&#39;lemonhotel/*.html&#39;)        .pipe(htmlmin(options))        .pipe(gulp.dest(&#39;html/build&#39;))});</code></pre>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gulp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åªæœ‰20è¡ŒJavascriptä»£ç ï¼æ‰‹æŠŠæ‰‹æ•™ä½ å†™ä¸€ä¸ªé¡µé¢æ¨¡æ¿å¼•æ“</title>
      <link href="/2018/02/24/Js/%E5%8F%AA%E6%9C%8920%E8%A1%8CJavascript%E4%BB%A3%E7%A0%81%EF%BC%81%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%86%99%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/"/>
      <url>/2018/02/24/Js/%E5%8F%AA%E6%9C%8920%E8%A1%8CJavascript%E4%BB%A3%E7%A0%81%EF%BC%81%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%86%99%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/</url>
      
        <content type="html"><![CDATA[<p><a href="http://blog.jobbole.com/56689/" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><pre><code class="javascript">var TemplateEngine = function(html, options) {    var re = /&lt;%([^%&gt;]+)?%&gt;/g, reExp = /(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g, code = &#39;var r=[];\n&#39;, cursor = 0; //æ­£åˆ™æ•è·æ‰€æœ‰ä»¥&lt;%å¼€å¤´ï¼Œä»¥%&gt;ç»“å°¾çš„ç‰‡æ®µ    var add = function(line, js) {        js? (code += line.match(reExp) ? line + &#39;\n&#39; : &#39;r.push(&#39; + line + &#39;);\n&#39;) :            (code += line != &#39;&#39; ? &#39;r.push(&quot;&#39; + line.replace(/&quot;/g, &#39;\\&quot;&#39;) + &#39;&quot;);\n&#39; : &#39;&#39;);        return add;    }//ä½¿ç”¨æ¡ä»¶åˆ¤æ–­å’Œå¾ªç¯,å¤æ‚é€»è¾‘    while(match = re.exec(html)) {        add(html.slice(cursor, match.index))(match[1], true);        cursor = match.index + match[0].length;    }    add(html.substr(cursor, html.length - cursor));    code += &#39;return r.join(&quot;&quot;);&#39;;//æŠŠæ‰€æœ‰çš„å­—ç¬¦ä¸²æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œï¼Œåœ¨ç¨‹åºçš„æœ€åæŠŠå®ƒä»¬æ‹¼æ¥èµ·æ¥ã€‚    return new Function(code.replace(/[\r\t\n]/g, &#39;&#39;)).apply(options);//æŠŠåŸæœ¬è¿”å›æ¨¡æ¿å­—ç¬¦ä¸²çš„è¯­å¥æ›¿æ¢æˆå¦‚ä¸‹çš„å†…å®¹}</code></pre>]]></content>
      
      
      <categories>
          
          <category> Js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åHTML5æ—¶ä»£</title>
      <link href="/2018/02/23/HTML5/%E5%90%8EHTML5%E6%97%B6%E4%BB%A3/"/>
      <url>/2018/02/23/HTML5/%E5%90%8EHTML5%E6%97%B6%E4%BB%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="HTML5-Device-API"><a href="#HTML5-Device-API" class="headerlink" title="HTML5 Device API"></a>HTML5 Device API</h1><p><a href="http://tgideas.qq.com/webplat/info/news_version3/804/7104/7106/m5723/201506/354489.shtml" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h2 id="è®©éŸ³ä¹éšå¿ƒè€ŒåŠ¨-éŸ³é¢‘å¤„ç†-Web-audio-API"><a href="#è®©éŸ³ä¹éšå¿ƒè€ŒåŠ¨-éŸ³é¢‘å¤„ç†-Web-audio-API" class="headerlink" title="è®©éŸ³ä¹éšå¿ƒè€ŒåŠ¨ - éŸ³é¢‘å¤„ç† Web audio API"></a>è®©éŸ³ä¹éšå¿ƒè€ŒåŠ¨ - éŸ³é¢‘å¤„ç† Web audio API</h2><p>Audioå¯¹è±¡æä¾›çš„åªæ˜¯éŸ³é¢‘æ–‡ä»¶çš„æ’­æ”¾ï¼Œè€ŒWeb Audioåˆ™æ˜¯ç»™äº†å¼€å‘è€…å¯¹éŸ³é¢‘æ•°æ®è¿›è¡Œåˆ†æã€å¤„ç†çš„èƒ½åŠ›ï¼Œæ¯”å¦‚æ··éŸ³ã€è¿‡æ»¤ã€‚</p><blockquote><p>ç³»ç»Ÿè¦æ±‚ :<br>ios6+ã€android chromeã€android firefox</p></blockquote><p><strong>æ ¸å¿ƒä»£ç </strong> :</p><pre><code class="javascript">var context = new webkitAudioContext();var source = context.createBufferSource();   // åˆ›å»ºä¸€ä¸ªå£°éŸ³æºsource.buffer = buffer;   // å‘Šè¯‰è¯¥æºæ’­æ”¾ä½•ç‰© createBufferSourcesource.connect(context.destination);   // å°†è¯¥æºä¸ç¡¬ä»¶ç›¸è¿source.start(0); //æ’­æ”¾</code></pre><a id="more"></a><p>æŠ€æœ¯åˆ†æ :</p><p>å½“æˆ‘ä»¬åŠ è½½å®ŒéŸ³é¢‘æ•°æ®åï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå…¨å±€çš„AudioContextå¯¹è±¡æ¥å¯¹éŸ³é¢‘è¿›è¡Œå¤„ç†ï¼ŒAudioContextå¯ä»¥åˆ›å»ºå„ç§ä¸åŒåŠŸèƒ½ç±»å‹çš„éŸ³é¢‘èŠ‚ç‚¹AudioNode</p><h3 id="1-æºèŠ‚ç‚¹ï¼ˆsource-nodeï¼‰"><a href="#1-æºèŠ‚ç‚¹ï¼ˆsource-nodeï¼‰" class="headerlink" title="1.æºèŠ‚ç‚¹ï¼ˆsource nodeï¼‰"></a>1.æºèŠ‚ç‚¹ï¼ˆsource nodeï¼‰</h3><h4 id="1-audioæ ‡ç­¾"><a href="#1-audioæ ‡ç­¾" class="headerlink" title="1.audioæ ‡ç­¾"></a>1.audioæ ‡ç­¾</h4><pre><code class="javascript">var sound, audio = new Audio();audio.addEventListener(&#39;canplay&#39;, function() { sound = context.createMediaElementSource(audio); sound.connect(context.destination);});audio.src = &#39;/audio.mp3&#39;;</code></pre><h4 id="2-XMLHttpRequest"><a href="#2-XMLHttpRequest" class="headerlink" title="2.XMLHttpRequest"></a>2.XMLHttpRequest</h4><pre><code class="javascript">var sound, context = createAudioContext();var audioURl = &#39;/audio.mp3&#39;; // éŸ³é¢‘æ–‡ä»¶URLvar xhr = new XMLHttpRequest();xhr.open(&#39;GET&#39;, audioURL, true);xhr.responseType = &#39;arraybuffer&#39;; xhr.onload = function() { context.decodeAudioData(request.response, function (buffer) { source = context.createBufferSource(); source.buffer = buffer; source.connect(context.destination); }}xhr.send();</code></pre><h3 id="2-åˆ†æèŠ‚ç‚¹ï¼ˆanalyser-nodeï¼‰"><a href="#2-åˆ†æèŠ‚ç‚¹ï¼ˆanalyser-nodeï¼‰" class="headerlink" title="2.åˆ†æèŠ‚ç‚¹ï¼ˆanalyser nodeï¼‰"></a>2.åˆ†æèŠ‚ç‚¹ï¼ˆanalyser nodeï¼‰</h3><pre><code class="javascript">var audioCtx = new (window.AudioContext || window.webkitAudioContext)();var analyser = audioCtx.createAnalyser();analyser.fftSize = 2048;var bufferLength = analyser.frequencyBinCount;var dataArray = new Uint8Array(bufferLength);analyser.getByteTimeDomainData(dataArray);function draw() { drawVisual = requestAnimationFrame(draw); analyser.getByteTimeDomainData(dataArray); // å°†dataArrayæ•°æ®ä»¥canvasæ–¹å¼æ¸²æŸ“å‡ºæ¥};draw();</code></pre><h3 id="3-å¤„ç†èŠ‚ç‚¹ï¼ˆgain-nodeã€panner-nodeã€wave-shaper-nodeã€delay-nodeã€convolver-nodeç­‰ï¼‰"><a href="#3-å¤„ç†èŠ‚ç‚¹ï¼ˆgain-nodeã€panner-nodeã€wave-shaper-nodeã€delay-nodeã€convolver-nodeç­‰ï¼‰" class="headerlink" title="3.å¤„ç†èŠ‚ç‚¹ï¼ˆgain nodeã€panner nodeã€wave shaper nodeã€delay nodeã€convolver nodeç­‰ï¼‰"></a>3.å¤„ç†èŠ‚ç‚¹ï¼ˆgain nodeã€panner nodeã€wave shaper nodeã€delay nodeã€convolver nodeç­‰ï¼‰</h3><p>ä¸åŒçš„å¤„ç†èŠ‚ç‚¹æœ‰ä¸åŒçš„ä½œç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨BiquadFilterNodeè°ƒæ•´éŸ³è‰²ï¼ˆå¤§é‡æ»¤æ³¢å™¨ï¼‰ã€ä½¿ç”¨ChannelSplitterNodeåˆ†å‰²å·¦å³å£°é“ã€ä½¿ç”¨GainNodeè°ƒæ•´å¢ç›Šå€¼å®ç°éŸ³ä¹æ·¡å…¥æ·¡å‡ºç­‰ç­‰ã€‚éœ€è¦äº†è§£æ›´å¤šçš„éŸ³é¢‘èŠ‚ç‚¹å¯èƒ½å‚è€ƒï¼š<br><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API</a></p><h3 id="4-ç›®çš„èŠ‚ç‚¹ï¼ˆdestination-nodeï¼‰"><a href="#4-ç›®çš„èŠ‚ç‚¹ï¼ˆdestination-nodeï¼‰" class="headerlink" title="4.ç›®çš„èŠ‚ç‚¹ï¼ˆdestination nodeï¼‰"></a>4.ç›®çš„èŠ‚ç‚¹ï¼ˆdestination nodeï¼‰</h3><p>æ‰€æœ‰è¢«æ¸²æŸ“éŸ³é¢‘æµåˆ°è¾¾çš„æœ€ç»ˆåœ°ç‚¹</p><h2 id="æ•æ‰ç”¨æˆ·æ‘„åƒå¤´-åª’ä½“æµ-Media-Capture"><a href="#æ•æ‰ç”¨æˆ·æ‘„åƒå¤´-åª’ä½“æµ-Media-Capture" class="headerlink" title="æ•æ‰ç”¨æˆ·æ‘„åƒå¤´ - åª’ä½“æµ Media Capture"></a>æ•æ‰ç”¨æˆ·æ‘„åƒå¤´ - åª’ä½“æµ Media Capture</h2><p>é€šè¿‡getUserMediaæ•æ‰ç”¨æˆ·æ‘„åƒå¤´è·å–è§†é¢‘æµå’Œé€šè¿‡éº¦å…‹é£è·å–ç”¨æˆ·å£°éŸ³ã€‚</p><blockquote><p>ç³»ç»Ÿè¦æ±‚ :<br>android chromeã€android firefox</p></blockquote><p><strong>æ ¸å¿ƒä»£ç </strong> :</p><h3 id="1ã€æ‘„åƒå¤´æ•æ‰"><a href="#1ã€æ‘„åƒå¤´æ•æ‰" class="headerlink" title="1ã€æ‘„åƒå¤´æ•æ‰"></a>1ã€æ‘„åƒå¤´æ•æ‰</h3><pre><code class="javascript">navigator.webkitGetUserMedia ({video: true}, function(stream) { video.src = window.URL.createObjectURL(stream); localMediaStream = stream;}, function(e){})</code></pre><h3 id="2ã€ä»è§†é¢‘æµä¸­æ‹ç…§"><a href="#2ã€ä»è§†é¢‘æµä¸­æ‹ç…§" class="headerlink" title="2ã€ä»è§†é¢‘æµä¸­æ‹ç…§"></a>2ã€ä»è§†é¢‘æµä¸­æ‹ç…§</h3><pre><code class="javascript">btnCapture.addEventListener(&#39;touchend&#39;, function(){    if (localMediaStream) {        canvas.setAttribute(&#39;width&#39;, video.videoWidth);        canvas.setAttribute(&#39;height&#39;, video.videoHeight);        ctx.drawImage(video, 0, 0);    }}, false);</code></pre><h3 id="3ã€ç”¨æˆ·å£°éŸ³å½•åˆ¶"><a href="#3ã€ç”¨æˆ·å£°éŸ³å½•åˆ¶" class="headerlink" title="3ã€ç”¨æˆ·å£°éŸ³å½•åˆ¶"></a>3ã€ç”¨æˆ·å£°éŸ³å½•åˆ¶</h3><pre><code class="javascript">navigator.getUserMedia({audio:true}, function(e) {    context = new audioContext();    audioInput = context.createMediaStreamSource(e);        volume = context.createGain();    recorder = context.createScriptProcessor(2048, 2, 2);    recorder.onaudioprocess = function(e){        recordingLength += 2048;        recorder.connect (context.destination);     }    }, function(error){});</code></pre><h3 id="4ã€ä¿å­˜ç”¨æˆ·å½•åˆ¶çš„å£°éŸ³"><a href="#4ã€ä¿å­˜ç”¨æˆ·å½•åˆ¶çš„å£°éŸ³" class="headerlink" title="4ã€ä¿å­˜ç”¨æˆ·å½•åˆ¶çš„å£°éŸ³"></a>4ã€ä¿å­˜ç”¨æˆ·å½•åˆ¶çš„å£°éŸ³</h3><pre><code class="javascript">var buffer = new ArrayBuffer(44 + interleaved.length * 2);var view = new DataView(buffer);fileReader.readAsDataURL(blob); // android chrome audioä¸æ”¯æŒblobâ€¦ audio.src = event.target.result;</code></pre><h2 id="ä½ æ˜¯é€—é€¼ï¼Ÿ-è¯­éŸ³è¯†åˆ«-Web-Speech-API"><a href="#ä½ æ˜¯é€—é€¼ï¼Ÿ-è¯­éŸ³è¯†åˆ«-Web-Speech-API" class="headerlink" title="ä½ æ˜¯é€—é€¼ï¼Ÿ - è¯­éŸ³è¯†åˆ« Web Speech API"></a>ä½ æ˜¯é€—é€¼ï¼Ÿ - è¯­éŸ³è¯†åˆ« Web Speech API</h2><p>å°†æ–‡æœ¬è½¬æ¢æˆè¯­éŸ³ï¼›å°†è¯­éŸ³è¯†åˆ«ä¸ºæ–‡æœ¬ã€‚</p><blockquote><p>ç³»ç»Ÿè¦æ±‚ :<br>ios7+ï¼Œandroid chromeï¼Œandroid firefox</p></blockquote><p><strong>æ ¸å¿ƒä»£ç </strong> :</p><h3 id="1ã€æ–‡æœ¬è½¬æ¢æˆè¯­éŸ³ï¼Œä½¿ç”¨SpeechSynthesisUtteranceå¯¹è±¡"><a href="#1ã€æ–‡æœ¬è½¬æ¢æˆè¯­éŸ³ï¼Œä½¿ç”¨SpeechSynthesisUtteranceå¯¹è±¡" class="headerlink" title="1ã€æ–‡æœ¬è½¬æ¢æˆè¯­éŸ³ï¼Œä½¿ç”¨SpeechSynthesisUtteranceå¯¹è±¡."></a>1ã€æ–‡æœ¬è½¬æ¢æˆè¯­éŸ³ï¼Œä½¿ç”¨SpeechSynthesisUtteranceå¯¹è±¡.</h3><pre><code class="javascript">var msg = new SpeechSynthesisUtterance();var voices = window.speechSynthesis.getVoices();msg.volume = 1; // 0 to 1msg.text = â€˜è¯†åˆ«çš„æ–‡æœ¬å†…å®¹â€™;msg.lang = &#39;en-US&#39;;speechSynthesis.speak(msg);</code></pre><h3 id="2ã€è¯­éŸ³è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œä½¿ç”¨SpeechRecognitionå¯¹è±¡"><a href="#2ã€è¯­éŸ³è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œä½¿ç”¨SpeechRecognitionå¯¹è±¡" class="headerlink" title="2ã€è¯­éŸ³è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œä½¿ç”¨SpeechRecognitionå¯¹è±¡."></a>2ã€è¯­éŸ³è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œä½¿ç”¨SpeechRecognitionå¯¹è±¡.</h3><pre><code class="javascript">var newRecognition = new webkitSpeechRecognition();newRecognition.onresult = function(event){    var interim_transcript = &#39;&#39;;     for (var i = event.resultIndex; i &lt; event.results.length; ++i) {        final_transcript += event.results[i][0].transcript;    }};</code></pre><p>æµ‹è¯•ç»“è®ºï¼š<br>Androidæ”¯æŒä¸ç¨³å®šï¼›è¯­éŸ³è¯†åˆ«æµ‹è¯•å¤±è´¥ï¼ˆæš‚ä¸”è®¤ä¸ºæ˜¯æŸäº›å†…ç½®æ¥å£è¢«å¢™æ‰€è‡´ï¼‰ã€‚</p><h2 id="è®©æˆ‘å°½æƒ…å‘µæŠ¤ä½ -è®¾å¤‡ç”µé‡-Battery-API"><a href="#è®©æˆ‘å°½æƒ…å‘µæŠ¤ä½ -è®¾å¤‡ç”µé‡-Battery-API" class="headerlink" title="è®©æˆ‘å°½æƒ…å‘µæŠ¤ä½  - è®¾å¤‡ç”µé‡ Battery API"></a>è®©æˆ‘å°½æƒ…å‘µæŠ¤ä½  - è®¾å¤‡ç”µé‡ Battery API</h2><p>æŸ¥è¯¢ç”¨æˆ·è®¾å¤‡ç”µé‡åŠæ˜¯å¦æ­£åœ¨å……ç”µã€‚</p><blockquote><p>ç³»ç»Ÿè¦æ±‚ :<br>android firefox</p></blockquote><p><strong>æ ¸å¿ƒä»£ç </strong> ï¼š</p><pre><code class="javascript">var battery = navigator.battery || navigator.webkitBattery || navigator.mozBattery || navigator.msBattery;var str = &#39;&#39;;if (battery) { str += &#39;&lt;p&gt;ä½ çš„æµè§ˆå™¨æ”¯æŒHTML5 Battery API&lt;/p&gt;&#39;; if(battery.charging) { str += &#39;&lt;p&gt;ä½ çš„è®¾å¤‡æ­£åœ¨å……ç”µ&lt;/p&gt;&#39;;} else { str += &#39;&lt;p&gt;ä½ çš„è®¾å¤‡æœªå¤„äºå……ç”µçŠ¶æ€&lt;/p&gt;&#39;;} str += &#39;&lt;p&gt;ä½ çš„è®¾å¤‡å‰©ä½™&#39;+ parseInt(battery.level*100)+&#39;%çš„ç”µé‡&lt;/p&gt;&#39;;} else { str += &#39;&lt;p&gt;ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒHTML5 Battery API&lt;/p&gt;&#39;;}</code></pre><p>æµ‹è¯•ç»“è®º ï¼š<br>1ã€QQæµè§ˆå™¨ä¸UCæµè§ˆå™¨æ”¯æŒè¯¥æ¥å£ï¼Œä½†æœªæ­£ç¡®æ˜¾ç¤ºè®¾å¤‡ç”µæ± ä¿¡æ¯ï¼›<br>2ã€caniuseæ˜¾ç¤ºandroid chrome42æ”¯æŒè¯¥æ¥å£ï¼Œå®æµ‹ä¸æ”¯æŒã€‚</p><h2 id="è·å–ç”¨æˆ·ä½ç½®-åœ°ç†ä½ç½®-Geolocation-API"><a href="#è·å–ç”¨æˆ·ä½ç½®-åœ°ç†ä½ç½®-Geolocation-API" class="headerlink" title="è·å–ç”¨æˆ·ä½ç½® - åœ°ç†ä½ç½® Geolocation API"></a>è·å–ç”¨æˆ·ä½ç½® - åœ°ç†ä½ç½® Geolocation API</h2><p>Geolocation APIç”¨äºå°†ç”¨æˆ·å½“å‰åœ°ç†ä½ç½®ä¿¡æ¯å…±äº«ç»™ä¿¡ä»»çš„ç«™ç‚¹ï¼Œç›®å‰ä¸»æµç§»åŠ¨è®¾å¤‡éƒ½èƒ½å¤Ÿæ”¯æŒã€‚</p><blockquote><p>ç³»ç»Ÿè¦æ±‚ :<br>ios6+ã€android2.3+</p></blockquote><p><strong>æ ¸å¿ƒä»£ç </strong>ï¼š</p><pre><code class="javascript">var domInfo = $(&quot;#info&quot;);// è·å–ä½ç½®åæ ‡if (navigator.geolocation) {    navigator.geolocation.getCurrentPosition(showPosition,showError);}else{    domInfo.innerHTML=&quot;æŠ±æ­‰ï¼Œä½ çš„æµè§ˆå™¨ä¸æ”¯æŒåœ°ç†å®šä½ï¼&quot;;}// ä½¿ç”¨è…¾è®¯åœ°å›¾æ˜¾ç¤ºä½ç½®function showPosition(position) {    var lat=position.coords.latitude;    var lon=position.coords.longitude;    mapholder = $(&#39;#mapholder&#39;)    mapholder.style.height=&#39;250px&#39;;    mapholder.style.width = document.documentElement.clientWidth + &#39;px&#39;;    var center = new soso.maps.LatLng(lat, lon);    var map = new soso.maps.Map(mapholder,{        center: center,        zoomLevel: 13    });    var geolocation = new soso.maps.Geolocation();    var marker = null;    geolocation.position({}, function(results, status) {        console.log(results);        var city = $(&quot;#info&quot;);        if (status == soso.maps.GeolocationStatus.OK) {            map.setCenter(results.latLng);            domInfo.innerHTML = &#39;ä½ å½“å‰æ‰€åœ¨åŸå¸‚: &#39; + results.name;        if (marker != null) {            marker.setMap(null);        }        // è®¾ç½®æ ‡è®°        marker = new soso.maps.Marker({            map: map,            position:results.latLng        });        } else {            alert(&quot;æ£€ç´¢æ²¡æœ‰ç»“æœï¼ŒåŸå› : &quot; + status);        }    });}</code></pre><p>æµ‹è¯•ç»“è®ºï¼š</p><p>1ã€Geolocation APIçš„ä½ç½®ä¿¡æ¯æ¥æºåŒ…æ‹¬GPSã€IPåœ°å€ã€RFIDã€WIFIå’Œè“ç‰™çš„MACåœ°å€ã€ä»¥åŠGSM/CDMSçš„IDç­‰ç­‰ã€‚è§„èŒƒä¸­æ²¡æœ‰è§„å®šä½¿ç”¨è¿™äº›è®¾å¤‡çš„å…ˆåé¡ºåºã€‚<br>2ã€åˆæµ‹3gç¯å¢ƒä¸‹æ¯”wifiç¯å¢ƒç†å®šä½æ›´å‡†ç¡®ï¼›<br>3ã€æµ‹è¯•ä¸‰æ˜Ÿ GT-S6358(android2.3) geolocationå­˜åœ¨ï¼Œä½†æ˜¾ç¤ºä½ç½®ä¿¡æ¯ä¸å¯ç”¨POSITION_UNAVAILABLEã€‚</p><h2 id="æŠŠç”¨æˆ·æ§åœ¨æ‰‹å¿ƒ-ç¯å¢ƒå…‰-Ambient-Light-API"><a href="#æŠŠç”¨æˆ·æ§åœ¨æ‰‹å¿ƒ-ç¯å¢ƒå…‰-Ambient-Light-API" class="headerlink" title="æŠŠç”¨æˆ·æ§åœ¨æ‰‹å¿ƒ - ç¯å¢ƒå…‰ Ambient Light API"></a>æŠŠç”¨æˆ·æ§åœ¨æ‰‹å¿ƒ - ç¯å¢ƒå…‰ Ambient Light API</h2><p>Ambient Light APIå®šä¹‰äº†ä¸€äº›äº‹ä»¶ï¼Œè¿™äº›æ—¶é—´å¯ä»¥æä¾›æºäºå‘¨å›´å…‰äº®ç¨‹åº¦çš„ä¿¡æ¯ï¼Œè¿™é€šå¸¸æ˜¯ç”±è®¾å¤‡çš„å…‰æ„Ÿåº”å™¨æ¥æµ‹é‡çš„ã€‚è®¾å¤‡çš„å…‰æ„Ÿåº”å™¨ä¼šæå–å‡ºè¾‰åº¦ä¿¡æ¯ã€‚</p><blockquote><p>ç³»ç»Ÿè¦æ±‚ :<br>android firefox</p></blockquote><p><strong>æ ¸å¿ƒä»£ç </strong>ï¼š<br>è¿™æ®µä»£ç å®ç°æ„Ÿåº”ç”¨å‰å½“å‰ç¯å¢ƒå…‰å¼ºåº¦ï¼Œè°ƒæ•´ç½‘é¡µèƒŒæ™¯å’Œæ–‡å­—é¢œè‰²ã€‚</p><pre><code class="javascript">var domInfo = $(&#39;#info&#39;);if (!(&#39;ondevicelight&#39; in window)) {    domInfo.innerHTML = &#39;ä½ çš„è®¾å¤‡ä¸æ”¯æŒç¯å¢ƒå…‰Ambient Light API&#39;;} else {    var lightValue = document.getElementById(&#39;dl-value&#39;);    window.addEventListener(&#39;devicelight&#39;, function(event) {        domInfo.innerHTML = &#39;å½“å‰ç¯å¢ƒå…‰çº¿å¼ºåº¦ä¸ºï¼š&#39; + Math.round(event.value) + &#39;lux&#39;;        var backgroundColor = &#39;rgba(0,0,0,&#39;+(1-event.value/100) +&#39;)&#39;;        document.body.style.backgroundColor = backgroundColor;        if(event.value &lt; 50) {            document.body.style.color = &#39;#fff&#39;        } else {            document.body.style.color = &#39;#000&#39;        }    });}</code></pre><h2 id="é™€èºä»ª-Deviceorientation"><a href="#é™€èºä»ª-Deviceorientation" class="headerlink" title="é™€èºä»ª Deviceorientation"></a>é™€èºä»ª Deviceorientation</h2><p>è£…é€¼è¯´æ³•ï¼šè®¾å¤‡ç§»åŠ¨ä¼ æ„Ÿå™¨ã€‚</p><p>é€šä¿—è¯´æ³•ï¼šæ£€æµ‹è®¾å¤‡è¿åŠ¨åŠè¿åŠ¨çŠ¶å†µï¼Œå¯ä»¥é€šè¿‡è¯¥æ¥å£è·å–åˆ°è®¾å¤‡è¿åŠ¨çš„æ–¹å‘å’Œé€Ÿåº¦ç­‰ç›¸å…³ä¿¡æ¯</p><p><strong>æ ¸å¿ƒä»£ç </strong> :<br>è¿™è´§å…¶å®å°±æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œç®€å•åœ°é€šè¿‡äº‹ä»¶ç›‘å¬å°±å¯ä»¥è·å–åˆ°ç›¸å…³çš„è®¾å¤‡è¿åŠ¨ä¿¡æ¯</p><pre><code class="javascript">window.addEventListener(&quot;devicemotion&quot;, function(event) {}, false);</code></pre><p>æœ€ç®€å•çš„è®¾å¤‡è¿åŠ¨ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥è®¤ä¸ºæ˜¯å‰åã€å·¦å³ã€ä¸Šä¸‹è¿™ä¹ˆ6ä¸ªæ–¹å‘ä¸Šçš„ï¼Œè£…æ¢æˆ3Dç¯å¢ƒä¸­æ¥è®²çš„è¯ï¼Œå°±æ˜¯åœ¨xã€yå’Œzè½´ä¸Šè¿åŠ¨ï¼Œè¿™ä¸‰ä¸ªè½´ä¸Šçš„ä¿¡æ¯ï¼Œéƒ½åŒ…å«åœ¨äº†eventå¯¹è±¡ä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è·å¾—</p><pre><code class="javascript">window.addEventListener(&quot;devicemotion&quot;, function(event) {    var eventacceleration = event.acceleration;    document.querySelector(&#39;#devicemotion&#39;).innerHTML = &quot;acceleration:&lt;br&gt;&quot;+    eventacceleration.x+&quot;&lt;br&gt;&quot;+    eventacceleration.y+&quot;&lt;br&gt;&quot;+    eventacceleration.z}, false);</code></pre><p>ä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆæ‰‹æœºèººåœ¨æ¡Œé¢ä¸Šï¼Œä¸Šé¢çš„æ•°å­—è¿˜åœ¨ä¸åœåœ°æŠ–åŠ¨ï¼Œå’±ä»¬æ–‡åŒ–äººåº”è¯¥éƒ½çŸ¥é“ä»€ä¹ˆå«ç›¸å¯¹é™æ­¢ã€‚ä¸Šé¢çš„ä¸‰ä¸ªä¸æ–­å˜åŒ–çš„æ•°å­—ï¼Œå°±æ˜¯ä½ è®¾å¤‡çš„è¿åŠ¨æ•°æ®äº†ã€‚å¦‚æœä½ åœ¨æƒŠè®¶ä¸ºä»€ä¹ˆæˆ‘éƒ½å·²ç»ç§»åŠ¨è¿‡æ‰‹æœºï¼Œä¸ºä»€ä¹ˆä¸Šé¢çš„æ•°å­—è²Œä¼¼ä¹Ÿæ²¡ä»€ä¹ˆå¤§çš„å˜åŒ–~é‚£ä¹ˆæˆ‘ä¼šå‘Šè¯‰ä½ è¯´ï¼šæœ‰æœ¬äº‹ä½ çš„çœ¼ç›è·Ÿç€ä½ çš„æ‰‹æœºä¸€æ ·å¿«é€Ÿç§»åŠ¨å•Šï¼Œè¿åŠ¨è¿‡ç¨‹ä¸­ä½ å°±èƒ½å‘ç°è¿™ä¸ªå€¼çš„å˜åŒ–äº†ã€‚æ²¡æœ‰è¿™ä¸ªæœ¬äº‹å§ï¼~è‡ªå·±å°è¯•ä¿®æ”¹ä¸‹é‚£ä¸ªdemoã€‚æŠŠè¿åŠ¨ä¸­å€¼çš„å˜åŒ–éƒ½è®°å½•ä¸‹æ¥çœ‹çœ‹ã€‚ã€‚ã€‚ï¼ˆPSï¼šåæ­£æˆ‘ä¸å¼„ã€‚ï¼‰</p><p>è¿˜æœ‰ä¸€ç§æ¯”è¾ƒç†æƒ³çš„è®¾å¤‡è¿åŠ¨æ–¹å¼å°±æ˜¯ä¸äº§ç”Ÿä½ç§»ï¼Œåªæ˜¯å¿«é€Ÿçš„æ—‹è½¬æ‰‹æœºã€‚è¿™ä¸ªæ—‹è½¬çš„ä¿¡æ¯åŒæ ·ä¹Ÿè¢«åé¦ˆåœ¨äº†eventå¯¹è±¡ä¸­</p><pre><code class="javascript">window.addEventListener(&quot;devicemotion&quot;, function(event) {    eventrotationRate = event.rotationRate;    document.querySelector(&#39;#devicemotion&#39;).innerHTML = &#39;rotationRate:&lt;br&gt;&#39;+    eventrotationRate.alpha+&#39;&lt;br&gt;&#39;+    eventrotationRate.beta+&quot;&lt;br&gt;&quot;+    eventrotationRate.gamma}, false);</code></pre><p>å¯èƒ½æœ‰çš„ç«¥é‹ä¼šè§‰å¾—~æœ‰äº†è¿™ä¸ªæ—‹è½¬åº”è¯¥å°±èƒ½å®ç°ä¸€äº›æ‰‹æœºå·¦å³æ—‹è½¬äº§ç”Ÿè§†å·®çš„æ•ˆæœäº†ï¼Œå…¶å®æ˜¯ä¸è¡Œçš„~å› ä¸ºè¿™è´§å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œè®¾å¤‡åœæ­¢åï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºä»–çš„å€¼å½’0~ã€‚çœŸæ­£æƒ³è¦å®ç°æ‰‹æœºæ—‹è½¬è§†å·®ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„å°±æ˜¯å¦å¤–ä¸€ä¸ªeventçš„å±æ€§accelerationIncludingGravityã€‚ä»å­—é¢ä¸Šç†è§£è¿™ä¸ªå±æ€§å°±æ˜¯é‡åŠ›åŠ é€Ÿåº¦ã€‚</p><pre><code class="javascript">window.addEventListener(&quot;devicemotion&quot;, function(event) {    eventaccelerationIncludingGravity = event.accelerationIncludingGravity;    document.querySelector(&#39;#devicemotion&#39;).innerHTML = &quot;accelerationIncludingGravity:&lt;br&gt;&quot;+    eventaccelerationIncludingGravity.x+&quot;&lt;br&gt;&quot;+    eventaccelerationIncludingGravity.y+&quot;&lt;br&gt;&quot;+    eventaccelerationIncludingGravity.z}, false);</code></pre><p>å…¶å®ï¼Œdevicemotionè¿˜æœ‰ä¸€ä¸ªå¥½åŸºå‹ï¼Œè¿™é‡Œä¹Ÿæ¨èç»™å¤§å®¶çœ‹ä¸€çœ¼å§ï¼š</p><p><strong>deviceorientation</strong><br>è¿™ä¸ªäº‹ä»¶å’Œdevicemotionçš„ä½¿ç”¨æ–¹æ³•åŸºæœ¬ä¸€è‡´</p><pre><code class="javascript">window.addEventListener(&quot;deviceorientation&quot;, function(event) {    document.querySelector(&#39;#deviceorientation&#39;).innerHTML =     event.alpha+&#39;&lt;br&gt;&#39;+    event.beta+&quot;&lt;br&gt;&quot;+    event.gamma+&#39;&lt;br&gt;&#39;;}, false);</code></pre><p>æœ‰å‰é¢devicemotionå¥½åŸºå‹çš„å¸®å¿™ï¼Œä¼¼ä¹èƒ½åšçš„ä¸œè¥¿åˆå¯ä»¥æ›´å¤šä¸€ç‚¹äº†ã€‚å’±ä»¬å‰é¢è²Œä¼¼æåŠè¿‡&ldquo;å–å‰æ‘‡ä¸€æ‘‡&rdquo;ã€‚æ‘‡å®Œä¹‹åï¼Œè‡ªç„¶æ˜¯è¦æ‰“å¼€ç“¶ç›–ç—›é¥®ä¸€ç•ªäº†ï¼Œç»“åˆæ—‹è½¬åŠ é€Ÿåº¦ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥å°è¯•äº›ä¸€ä¸ªæ‹§ç“¶ç›–æ¯”èµ›çš„æ¸¸æˆäº†ï¼Ÿæ€•é•¿èƒ–ï¼Ÿè¦ä¸ï¼Œæ‹§ä¸ªèºä¸é’‰ä¹Ÿè¡Œã€‚</p><h2 id="Websocket"><a href="#Websocket" class="headerlink" title="Websocket"></a>Websocket</h2><p>æµè§ˆå™¨ä¸æœåŠ¡å™¨å…¨åŒå·¥é€šä¿¡(full-duplex)ã€‚</p><p><strong>æ ¸å¿ƒä»£ç </strong> ï¼š</p><pre><code class="javascript">var ws = new WebSocket(&#39;ws://127.0.0.1:8808/&#39;);//å»ºç«‹æœåŠ¡å™¨è¿æ¥ws.onopen = function(){    systemInfo.innerHTML = &#39;&lt;p&gt;å’ŒwebsocketæœåŠ¡å™¨è¿æ¥æˆåŠŸ&lt;/p&gt;&#39;;}//æ¥æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„æ•°æ®ws.onmessage = function(e){    systemInfo.innerHTML += &#39;&lt;p&gt;&#39;+e.data+&#39;&lt;/p&gt;&#39;;}//æ–­å¼€æœåŠ¡å™¨è¿æ¥ws.onclose = function(){    systemInfo.innerHTML += &#39;&lt;p&gt;WebSocketæœåŠ¡å™¨è¿æ¥å…³é—­&lt;/p&gt;&#39;;}//wså‘ç”Ÿé”™è¯¯ws.onerror = function(e){    console.log(e);    systemInfo.innerHTML += &#39;&lt;p&gt;WebSocketå‘ç”Ÿé”™è¯¯&lt;/p&gt;&#39;;}</code></pre><p> æˆ‘ä»¬å¯ä»¥é€šè¿‡äº‹ä»¶çš„ç›‘å¬ï¼Œå»å®æ—¶è·å–åˆ°ç½‘ç»œçŠ¶æ€çš„å˜åŒ–</p><pre><code class="javascript">window.addEventListener(&#39;offline&#39;, function(e) {alert(&#39;offline&#39;);})window.addEventListener(&#39;online&#39;, function(e) {alert(&#39;online&#39;);})</code></pre><h2 id="NFC"><a href="#NFC" class="headerlink" title="NFC"></a>NFC</h2><p>è¿‘åœºé€šä¿¡/è¿‘è·ç¦»æ— çº¿é€šä¿¡æŠ€æœ¯ã€‚</p><p>å…¶å®è¯´å®åœ¨çš„ï¼Œè¿™ä¸ªåŠŸèƒ½æˆ‘å¹¶æ²¡æœ‰åœ¨æˆ‘çš„é¡µé¢é‡Œé¢è°ƒè¯•å‡ºæ¥ã€‚ä¸»è¦çš„ä¸€ä¸ªåŸå› æ˜¯~è¿™è´§ç›®å‰åªæ˜¯åœ¨firefox osç³»ç»Ÿé‡Œé¢çš„firefoxæµè§ˆå™¨é‡Œé¢å®ç°äº†ï¼Œæ‰‹å¤´ä¸Šæ²¡è¿™è®¾å¤‡ã€‚ä¸è¿‡ä»ä»–ä»¬å®˜ç½‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘å¤§æ¦‚åœ°å¯ä»¥æ„Ÿå—å¾—åˆ°è¿™è´§çš„å¥½ç”¨ï¼Œæœ‰å…´è¶£çš„åŒå­¦è‡ªè¡Œå‰å¾€å­¦ä¹ ï¼š[<a href="https://developer.mozilla.org/en-US/docs/Web/API/NFC_API/Using_the_NFC_API]https://developer.mozilla.org/en-US/docs/Web/API/NFC_API/Using_the_NFC_API" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/API/NFC_API/Using_the_NFC_API]https://developer.mozilla.org/en-US/docs/Web/API/NFC_API/Using_the_NFC_API</a>.</p><h2 id="éœ‡åŠ¨-Vibration-API"><a href="#éœ‡åŠ¨-Vibration-API" class="headerlink" title="éœ‡åŠ¨ - Vibration API"></a>éœ‡åŠ¨ - Vibration API</h2><p>è®¾å¤‡éœ‡åŠ¨</p><p><strong>æ ¸å¿ƒä»£ç </strong> :</p><pre><code class="javascript">navigator.vibrate = navigator.vibrate ||  navigator.webkitVibrate ||                                 navigator.mozVibrate || navigator.msVibrate;navigator.vibrate(value);navigator.vibrate(0);</code></pre><p>vibrateçš„å‚æ•°ä¸ºéœ‡åŠ¨çš„æ—¶é—´ï¼Œ</p><p>å¦‚æœå€¼ä¸º0ï¼Œè¯´æ˜åœæ­¢éœ‡åŠ¨</p><p>å€¼ä¸ºä¸€ä¸ªæ•°ç»„çš„è¯ï¼Œå¥‡æ•°é¡¹è¡¨ç¤ºçš„æ˜¯éœ‡åŠ¨æ—¶é—´ï¼Œå¶æ•°é¡¹è¡¨ç¤ºçš„ä¸ºé—´éš”æ—¶é—´ã€‚</p><p>æ¯”å¦‚ï¼švibrate(1000,1000,2000)  å°±æ˜¯è¡¨ç¤ºéœ‡åŠ¨1ç§’ä¹‹åæš‚åœ1ç§’ï¼Œå†éœ‡åŠ¨2ç§’</p><h2 id="ç½‘ç»œç¯å¢ƒ-Connection-API"><a href="#ç½‘ç»œç¯å¢ƒ-Connection-API" class="headerlink" title="ç½‘ç»œç¯å¢ƒ Connection API"></a>ç½‘ç»œç¯å¢ƒ Connection API</h2>]]></content>
      
      
      <categories>
          
          <category> HTML5 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-native UIç»„ä»¶</title>
      <link href="/2018/02/11/react-native/react-native%20Components/"/>
      <url>/2018/02/11/react-native/react-native%20Components/</url>
      
        <content type="html"><![CDATA[<h1 id="React-native-Components-è‡ªå·±ç†è§£"><a href="#React-native-Components-è‡ªå·±ç†è§£" class="headerlink" title="React-native Components(è‡ªå·±ç†è§£)"></a>React-native Components(è‡ªå·±ç†è§£)</h1><p><a href="http://facebook.github.io/react-native/" target="_blank" rel="noopener">react-native å®˜ç½‘</a><br><a href="https://reactnative.cn/docs/0.51/getting-started.html" target="_blank" rel="noopener">react-native ä¸­æ–‡å®˜ç½‘</a></p><a id="more"></a><p><strong>1.ActivityIndicator</strong> æ˜¾ç¤ºä¸€ä¸ªåœ†å½¢çš„loadingæç¤ºç¬¦å·ã€‚<br><strong>2.Button</strong> æŒ‰é’®<br><strong>3.DataPickerIOS</strong>  iosæ—¥æœŸé€‰æ‹©ç»„ä»¶<br><strong>4.DrawerLayoutAndriod</strong>   andriodæŠ½å±‰å¯¼èˆª<br><strong>5.FlatList</strong>  é«˜æ€§èƒ½ç®€å•åˆ—è¡¨ç»„ä»¶<br><strong>6.Image</strong> å›¾ç‰‡ç»„ä»¶<br><strong>7.KeybordAvoiding View</strong> æ‰‹æœºä¸Šå¼¹å‡ºçš„é”®ç›˜å¸¸å¸¸ä¼šæŒ¡ä½å½“å‰çš„è§†å›¾ã€‚æœ¬ç»„ä»¶å¯ä»¥è‡ªåŠ¨æ ¹æ®é”®ç›˜çš„ä½ç½®ï¼Œè°ƒæ•´è‡ªèº«çš„positionæˆ–åº•éƒ¨çš„paddingï¼Œä»¥é¿å…è¢«é®æŒ¡<br><strong>8.ListView</strong> æ­¤ç»„ä»¶å·²è¿‡æœŸ è¯·ç”¨selection æˆ– FlatLIst æ›¿æ¢<br><strong>9.MaskedViewIOS</strong> é®ç½©æ¸²æŸ“å­è§†å›¾ï¼ˆæ·»åŠ ç‚«é…·çš„èƒŒæ™¯ï¼‰<br><strong>10.Modal</strong>  Modalç»„ä»¶å¯ä»¥ç”¨æ¥è¦†ç›–åŒ…å«React Nativeæ ¹è§†å›¾çš„åŸç”Ÿè§†å›¾ (å¯ç”¨ä½œå¼¹æ¡†é®ç½©)<br><strong>11.NavigatorIOS</strong>   IOS å¯¼èˆªè®¾ç½®<br><strong>12.Picker</strong> æ¸²æŸ“åŸç”Ÿçš„é€‰æ‹©å™¨ï¼ˆç±»ä¼¼æ»šåŠ¨åœ°å€é€‰æ‹©ï¼‰<br><strong>13.PickerIOS</strong> IOSé€‰æ‹©å™¨<br><strong>14.ProgressBarAndroid</strong>  å®‰å“loadingå›¾æ ‡<br><strong>15.ProgressViewIOS</strong>  IOSè¿›åº¦æ¡<br><strong>16.RefreshControl</strong>  è¿™ä¸€ç»„ä»¶å¯ä»¥ç”¨åœ¨ScrollViewæˆ–ListViewå†…éƒ¨ï¼Œä¸ºå…¶æ·»åŠ ä¸‹æ‹‰åˆ·æ–°çš„åŠŸèƒ½ã€‚å½“ScrollViewå¤„äºç«–ç›´æ–¹å‘çš„èµ·ç‚¹ä½ç½®ï¼ˆscrollY: 0ï¼‰ï¼Œæ­¤æ—¶ä¸‹æ‹‰ä¼šè§¦å‘ä¸€ä¸ªonRefreshäº‹ä»¶ã€‚<br><strong>17.ScrollView</strong> æ»šåŠ¨è§†å›¾åˆ—è¡¨<br><strong>18.sectionList</strong> åˆ†ç»„åˆ—è¡¨(ä¾‹å¦‚ç”µè¯æœ¬çš„åˆ—è¡¨)<br><strong>19.SegmentedControlIOS</strong>  IOSåˆ†æ®µé€‰æ‹©å™¨<br><strong>20.Slider</strong> ç”¨äºé€‰æ‹©ä¸€ä¸ªèŒƒå›´å€¼çš„ç»„ä»¶ã€‚ï¼ˆä¾‹å¦‚é€‰æ‹©éŸ³é‡çš„barï¼‰<br><strong>21.SnapshotViewIOS</strong>  IOSæˆªå›¾<br><strong>22.StatusBar</strong>  ç”¨äºæ§åˆ¶åº”ç”¨çŠ¶æ€æ çš„ç»„ä»¶ã€‚<br><strong>23.Switch</strong>  å¼€å…³æŒ‰é’®<br><strong>24.TabBarIOS</strong>  å¸¦IOSæˆ–Androidåç¼€çš„ç»„ä»¶(åº•éƒ¨å¯¼èˆªåŠ)<br><strong>25.TabBarIOS.Item</strong>    ï¼ˆåº•éƒ¨å¯¼èˆªçš„æ–°æ¶ˆæ¯é€šçŸ¥æ•°é‡ï¼‰<br><strong>26.Text</strong>  æ–‡æœ¬æ ‡ç­¾<br><strong>27.TextInput</strong> æ–‡æœ¬è¾“å…¥æ¡†<br><strong>28.ToolbarAndroid</strong>  ä¸€ä¸ªToolbarå¯ä»¥æ˜¾ç¤ºä¸€ä¸ªå¾½æ ‡ï¼Œä¸€ä¸ªå¯¼èˆªå›¾æ ‡ï¼ˆè­¬å¦‚æ±‰å ¡å½¢çŠ¶çš„èœå•æŒ‰é’®ï¼‰ï¼Œä¸€ä¸ªæ ‡é¢˜ä¸å‰¯æ ‡é¢˜ï¼Œä»¥åŠä¸€ä¸ªåŠŸèƒ½åˆ—è¡¨ã€‚<br><strong>29.TouchableHighlight</strong>  æœ¬ç»„ä»¶ç”¨äºå°è£…è§†å›¾ï¼Œä½¿å…¶å¯ä»¥æ­£ç¡®å“åº”è§¦æ‘¸æ“ä½œã€‚å½“æŒ‰ä¸‹çš„æ—¶å€™ï¼Œå°è£…çš„è§†å›¾çš„ä¸é€æ˜åº¦ä¼šé™ä½ï¼ŒåŒæ—¶ä¼šæœ‰ä¸€ä¸ªåº•å±‚çš„é¢œè‰²é€è¿‡è€Œè¢«ç”¨æˆ·çœ‹åˆ°ï¼Œä½¿å¾—è§†å›¾å˜æš—æˆ–å˜äº®ã€‚<br><strong>30.TouchableWithoutFeedback</strong> å“åº”ç”¨æˆ·çš„ç‚¹å‡»äº‹ä»¶ï¼Œå¦‚æœä½ æƒ³åœ¨å¤„ç†ç‚¹å‡»äº‹ä»¶çš„åŒæ—¶ä¸æ˜¾ç¤ºä»»ä½•è§†è§‰åé¦ˆï¼Œä½¿ç”¨å®ƒæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚<br><strong>31. TouchableOpacity</strong> ç›¸æ¯”TouchableHighlightåœ¨æŒ‰ä¸‹å»ä¼šä½¿èƒŒæ™¯å˜æš—çš„æ•ˆæœï¼ŒTouchableOpacityä¼šåœ¨ç”¨æˆ·æ‰‹æŒ‡æŒ‰ä¸‹æ—¶é™ä½æŒ‰é’®çš„é€æ˜åº¦ï¼Œè€Œä¸ä¼šæ”¹å˜èƒŒæ™¯çš„é¢œè‰²<br><strong>32.TouchableNativeFeedback</strong> å®ƒä¼šåœ¨ç”¨æˆ·æ‰‹æŒ‡æŒ‰ä¸‹æ—¶å½¢æˆç±»ä¼¼æ°´æ³¢çº¹çš„è§†è§‰æ•ˆæœã€‚æ³¨æ„ï¼Œæ­¤ç»„ä»¶åªæ”¯æŒAndroidã€‚<br><strong>33.View</strong> å‘ˆç°çš„è§†å›¾<br><strong>34.ViewPagerAndroid</strong>   ä¸€ä¸ªå…è®¸åœ¨å­è§†å›¾ä¹‹é—´å·¦å³ç¿»é¡µçš„å®¹å™¨ã€‚æ¯ä¸€ä¸ªViewPagerAndroidçš„å­å®¹å™¨ä¼šè¢«è§†ä½œä¸€ä¸ªå•ç‹¬çš„é¡µï¼Œå¹¶ä¸”ä¼šè¢«æ‹‰ä¼¸å¡«æ»¡ViewPagerAndroidã€‚ï¼ˆæ³¨æ„æ‰€æœ‰çš„å­è§†å›¾éƒ½å¿…é¡»æ˜¯çº¯Viewï¼‰<br><strong>35.VirtualizedList</strong>    FlatList and SectionList çš„åº•å±‚å®ç°ã€‚ é€šè¿‡ç»´æŠ¤ä¸€ä¸ªæœ‰é™çš„æ¸²æŸ“çª—å£ï¼ˆå…¶ä¸­åŒ…å«å¯è§çš„å…ƒç´ ï¼‰ï¼Œå¹¶å°†æ¸²æŸ“çª—å£ä¹‹å¤–çš„å…ƒç´ å…¨éƒ¨ç”¨åˆé€‚çš„å®šé•¿ç©ºç™½ç©ºé—´ä»£æ›¿çš„æ–¹å¼ï¼Œæå¤§çš„æ”¹å–„äº†å†…å­˜æ¶ˆè€—ä»¥åŠåœ¨æœ‰å¤§é‡æ•°æ®æƒ…å†µä¸‹çš„ä½¿ç”¨æ€§èƒ½ã€‚<br><strong>36.WebView</strong>  ç”¨äºåŒ…è£¹htmlçš„æ ‡ç­¾  ï¼ˆ1.ç½‘å€ 2.å¼•ç”¨è·¯å¾„ 3.ç›´æ¥å†™htmlï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> react-native </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React-native API</title>
      <link href="/2018/02/11/react-native/React-native-API/"/>
      <url>/2018/02/11/react-native/React-native-API/</url>
      
        <content type="html"><![CDATA[<h1 id="React-native-API-è‡ªå·±ç†è§£"><a href="#React-native-API-è‡ªå·±ç†è§£" class="headerlink" title="React-native API(è‡ªå·±ç†è§£)"></a>React-native API(è‡ªå·±ç†è§£)</h1><p>æœ€è¿‘åœ¨å­¦ä¹ <strong>react-native</strong>,è€Œä¸”é‡æ–°åˆ©ç”¨hexo æ„å»ºäº†è‡ªå·±çš„ä¸»é¡µã€‚ ä¹‹å‰ä¹Ÿåœ¨csdn,ç®€ä¹¦ä¹Ÿå†™è¿‡åšå®¢ï¼Œæ‰“ç®—åˆ©ç”¨ç©ºé—²æ—¶é—´æŠŠåšå®¢è¿ç§»è¿›æ¥ã€‚</p><h2 id="è¿›å…¥ä¸»é¢˜å§ã€‚"><a href="#è¿›å…¥ä¸»é¢˜å§ã€‚" class="headerlink" title="è¿›å…¥ä¸»é¢˜å§ã€‚"></a>è¿›å…¥ä¸»é¢˜å§ã€‚</h2><p><a href="http://facebook.github.io/react-native/" target="_blank" rel="noopener">react-native å®˜ç½‘</a><br><a href="https://reactnative.cn/docs/0.51/getting-started.html" target="_blank" rel="noopener">react-native ä¸­æ–‡å®˜ç½‘</a></p><a id="more"></a><blockquote><ul><li><strong>1.AccessibilityInfo</strong> æ— éšœç¢åŠŸèƒ½ ç»™æ®‹éšœäººå£«ä½¿ç”¨</li><li><strong>2.ActionSheetIOS</strong>  IOSåº•éƒ¨å¼¹å‡ºé€‰æ‹©æ¡† ï¼ˆåˆ†äº«ï¼Œé€‰æ‹©ï¼‰</li><li><strong>3.Alert</strong> è°ƒç”¨æ‰‹æœºåŸç”Ÿå¼¹æ¡†</li><li><strong>4.AlertIOS</strong>  å¯åŠ¨ä¸€ä¸ªæç¤ºå¯¹è¯æ¡†ï¼ŒåŒ…å«å¯¹åº”çš„æ ‡é¢˜å’Œä¿¡æ¯ã€‚</li><li><strong>5.Animated</strong> Animatedåº“ä½¿å¾—å¼€å‘è€…å¯ä»¥éå¸¸å®¹æ˜“åœ°å®ç°å„ç§å„æ ·çš„åŠ¨ç”»å’Œäº¤äº’æ–¹å¼ï¼Œå¹¶ä¸”å…·å¤‡æé«˜çš„æ€§èƒ½</li><li><strong>6.AppRegistry</strong>   AppRegistryæ˜¯JSè¿è¡Œæ‰€æœ‰React Nativeåº”ç”¨çš„å…¥å£ã€‚</li><li><strong>7.AppState</strong>  AppStateèƒ½å‘Šè¯‰ä½ åº”ç”¨å½“å‰æ˜¯åœ¨å‰å°è¿˜æ˜¯åœ¨åå°ï¼Œå¹¶ä¸”èƒ½åœ¨çŠ¶æ€å˜åŒ–çš„æ—¶å€™é€šçŸ¥ä½ ã€‚<br>AppStateé€šå¸¸åœ¨å¤„ç†æ¨é€é€šçŸ¥çš„æ—¶å€™ç”¨æ¥å†³å®šå†…å®¹å’Œå¯¹åº”çš„è¡Œä¸ºã€‚</li><li><strong>8.AsyncStorage</strong>  AsyncStorageæ˜¯ä¸€ä¸ªç®€å•çš„ã€å¼‚æ­¥çš„ã€æŒä¹…åŒ–çš„Key-Valueå­˜å‚¨ç³»ç»Ÿï¼Œå®ƒå¯¹äºAppæ¥è¯´æ˜¯å…¨å±€æ€§çš„ã€‚å®ƒç”¨æ¥ä»£æ›¿LocalStorageã€‚(react-native-storageæ¨¡å—ï¼Œæä¾›äº†è¾ƒå¤šä¾¿åˆ©åŠŸèƒ½ã€‚)</li><li><strong>9.BackHandler</strong>   ç›‘å¬è®¾å¤‡ä¸Šçš„åé€€æŒ‰é’®äº‹ä»¶ã€‚(ä»…é™å®‰å“)</li><li><strong>10.CameraRoll</strong>  CameraRollæ¨¡å—æä¾›äº†è®¿é—®æœ¬åœ°ç›¸å†Œçš„åŠŸèƒ½</li><li><strong>11.Clipboard</strong>  Clipboardç»„ä»¶å¯ä»¥åœ¨iOSå’ŒAndroidçš„å‰ªè´´æ¿ä¸­è¯»å†™å†…å®¹ã€‚</li><li><strong>12.DatePickerAndroid</strong>  ä¸€ä¸ªæ ‡å‡†çš„Androidæ—¥æœŸé€‰æ‹©å™¨çš„å¯¹è¯æ¡†ã€‚</li><li><strong>13.Dimensions</strong>  ç”¨äºè·å–è®¾å¤‡å±å¹•çš„å®½é«˜ã€‚</li><li><strong>14.Easing</strong>   ç”¨äºåŠ¨ç”»å¹…åº¦</li><li><strong>15.Geolocation</strong> è¯·æ±‚è®¿é—®åœ°ç†ä½ç½®çš„æƒé™</li><li><strong>16.ImageEditor</strong>  æ ¹æ®æŒ‡å®šçš„URIå‚æ•°å‰ªè£å¯¹åº”çš„å›¾ç‰‡</li><li><strong>17.ImagePickerIOS</strong> ä¸€ä¸ªè·å–å›¾ç‰‡çš„ APIï¼ˆé¡»ç™¾åº¦è¯¦æƒ…ï¼‰</li><li><strong>18.ImageStore</strong>  å›¾ç‰‡ç¼“å­˜åº“</li><li><strong>19.Image Style Props</strong>  å¯è®¾ç½®å›¾ç‰‡çš„å±æ€§æ ·å¼</li><li><strong>20.InteractionManager</strong> æå‡ç”¨æˆ·ä½“éªŒå’Œäº¤äº’æ•ˆæœçš„æ¨¡å—InteractionMnager(äº¤äº’ç®¡ç†å™¨) ä½¿ç”¨InteractionManagerå¯ä»¥è®©ä¸€äº›è€—æ—¶çš„ä»»åŠ¡åœ¨äº¤äº’æ“ä½œæˆ–è€…åŠ¨ç”»å®Œæˆä¹‹åè¿›è¡Œæ‰§è¡Œï¼Œè¿™æ ·ä½¿ç”¨å¯ä»¥ä¿è¯æˆ‘ä»¬çš„JavaScriptçš„åŠ¨ç”»æ•ˆæœå¯ä»¥å¹³æ»‘æµç•…çš„æ‰§è¡Œã€‚å¯ä»¥å¤§å¤§æå‡ç”¨æˆ·ä½“éªŒã€‚ï¼ˆç™¾åº¦è¯¦æƒ…ï¼‰</li><li><strong>21.Keyboard</strong>  Keyboardç»„ä»¶å¯ä»¥ç”¨æ¥æ§åˆ¶é”®ç›˜ç›¸å…³çš„äº‹ä»¶ã€‚</li><li><strong>22.LayoutAnimation</strong>  å½“å¸ƒå±€å˜åŒ–æ—¶ï¼Œè‡ªåŠ¨å°†è§†å›¾è¿åŠ¨åˆ°å®ƒä»¬æ–°çš„ä½ç½®ä¸Šã€‚</li><li><strong>23.Layout Props</strong>  å¯ä»¥è®¾ç½®çš„åŠ¨ç”»æ ·å¼å‚æ•°</li><li><strong>24.Linking</strong>  ç›´æ¥æ‰“å¼€ç½‘å€ï¼Œç”µè¯ï¼ŒçŸ­ä¿¡çš„é“¾æ¥ã€‚Linkingæ¨¡å—ç»™æˆ‘ä»¬æä¾›äº†Androidå’ŒiOSåŒå¹³å°é€šç”¨çš„æ¥å£è¿›è¡Œå¤„ç†Appè¿›å…¥å’Œä¼ å‡ºçš„é“¾æ¥ã€‚(ç™¾åº¦è¯¦æƒ…)</li><li><strong>25.ListViewDataSource</strong>  ä¸ºListViewç»„ä»¶æä¾›é«˜æ€§èƒ½çš„æ•°æ®å¤„ç†å’Œè®¿é—®</li><li><strong>26.NativeMethodsMixin</strong>  NativeMethodsMixinæä¾›äº†ä¸€äº›ç”¨äºç›´æ¥è®¿é—®åº•å±‚åŸç”Ÿç»„ä»¶çš„æ–¹æ³•</li><li><strong>27.NetInfo</strong>   æ¨¡å—å¯ä»¥è·çŸ¥è®¾å¤‡è”ç½‘æˆ–ç¦»çº¿çš„çŠ¶æ€ä¿¡æ¯ã€‚</li><li><strong>28.PanResponder</strong>  å¯ä»¥å°†å¤šç‚¹è§¦æ‘¸æ“ä½œåè°ƒæˆä¸€ä¸ªæ‰‹åŠ¿ã€‚å®ƒä½¿å¾—ä¸€ä¸ªå•ç‚¹è§¦æ‘¸å¯ä»¥æ¥å—æ›´å¤šçš„è§¦æ‘¸æ“ä½œï¼Œä¹Ÿå¯ä»¥ç”¨äºè¯†åˆ«ç®€å•çš„å¤šç‚¹è§¦æ‘¸æ‰‹åŠ¿ã€‚(ç™¾åº¦è¯¦æƒ…)</li><li><strong>29.PermissionsAndroid</strong>  Permissionsæƒé™é€‚é…</li><li><strong>30.PixelRatio</strong>  æ ¹æ®åƒç´ å¯†åº¦è·å–æŒ‡å®šå¤§å°çš„å›¾ç‰‡</li><li><strong>31.PushNotificationIOS</strong>  æœ¬æ¨¡å—å¸®åŠ©ä½ å¤„ç†åº”ç”¨çš„æ¨é€é€šçŸ¥ï¼ŒåŒ…æ‹¬æƒé™æ§åˆ¶ä»¥åŠåº”ç”¨å›¾æ ‡ä¸Šçš„è§’æ ‡æ•°ï¼ˆæœªè¯»æ¶ˆæ¯æ•°ï¼‰ã€‚ï¼ˆæŸ¥çœ‹ApIæˆ–ç™¾åº¦è¯¦æƒ…ï¼‰</li><li><strong>32.Settings</strong>  è®¾ç½® ï¼ˆè·å–ï¼Œè®¾ç½®ï¼Œç›‘å¬ï¼Œæ¸…é™¤keyå€¼ï¼‰</li><li><strong>33.Shadow Props</strong>  è®¾ç½®é˜´å½±æ ·å¼å‚æ•°</li><li><strong>34.Share</strong> æ‰“å¼€ä¸€ä¸ªå¯¹è¯æ¡†æ¥å…±äº«æ–‡æœ¬å†…å®¹ã€‚</li><li><strong>35.StatusBarIOS</strong> ç”¨äºæ§åˆ¶åº”ç”¨çŠ¶æ€æ çš„ç»„ä»¶ã€‚</li><li><strong>36.StyleSheet</strong> è®¾ç½®æ ·å¼çš„å±æ€§</li><li><strong>37.Systrace</strong>  å†…å­˜ä¼˜åŒ–</li><li><strong>38.Text Style Props</strong>  æ–‡æœ¬æ ·å¼å‚æ•°</li><li><strong>39.TimePickerAndroid</strong>  å®‰å“æ—¥æœŸé€‰æ‹©</li><li><strong>40.ToastAndroid</strong>  ç”¨äºåœ¨Androidè®¾å¤‡ä¸Šæ˜¾ç¤ºä¸€ä¸ªæ‚¬æµ®çš„æç¤ºä¿¡æ¯</li><li><strong>41.Transforms</strong>  åŠ¨ç”»æ ·å¼å‚æ•°</li><li><strong>42.Vibration</strong> ç”¨äºæ§åˆ¶è®¾å¤‡éœ‡åŠ¨</li><li><strong>43.VibrationIOS</strong>  IOSç‰ˆç”¨äºæ§åˆ¶è®¾å¤‡éœ‡åŠ¨</li><li><strong>44.View Style Props</strong>  è®¾ç½®è§†å›¾æ ·å¼å‚æ•°ä»</li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> react-native </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
