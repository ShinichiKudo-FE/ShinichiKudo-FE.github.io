<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„ç®­å¤´å‡½æ•°]]></title>
    <url>%2F2020%2F03%2F15%2FJs%2F%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%2F</url>
    <content type="text"><![CDATA[ç®€è¨€ES6çš„ç®­å¤´å‡½æ•°ï¼Œæˆ‘ä»¬ä¼šåœ¨å·¥ä½œä¸­ç»å¸¸çŸ¥é“ï¼Œä½†æ˜¯ä½ çŸ¥é“ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œä»€ä¹ˆæ—¶å€™ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°å—ï¼Ÿ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ ä¸ºå•¥å¤§å¤šæ•°æƒ…å†µéƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ ä½œç”¨åŸŸå®‰å…¨æ€§:å½“ç®­å¤´å‡½æ•°è¢«ä¸€è‡´ä½¿ç”¨æ—¶ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½ä¿è¯ä½¿ç”¨ä¸Žæ ¹å¯¹è±¡ç›¸åŒçš„thisã€‚å¦‚æžœä¸€ä¸ªæ ‡å‡†å‡½æ•°å›žè°ƒä¸Žä¸€å †ç®­å¤´å‡½æ•°æ··åˆåœ¨ä¸€èµ·ï¼Œé‚£ä¹ˆä½œç”¨åŸŸå°±æœ‰å¯èƒ½å˜å¾—æ··ä¹±ã€‚ ç´§å‡‘æ€§:ç®­å¤´å‡½æ•°æ›´å®¹æ˜“è¯»å†™ã€‚ æ¸…æ™°åº¦:ä½¿ç”¨ç®­å¤´å‡½æ•°å¯æ˜Žç¡®çŸ¥é“å½“å‰ this æŒ‡å‘ å…¶å®ƒæƒ…å†µä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚ ä»€ä¹ˆæ—¶å€™ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Ÿå®šä¹‰å¯¹è±¡æ–¹æ³•å®šä¹‰å­—é¢é‡çš„æ–¹æ³•123456789101112const calculator = &#123; array: [1, 2, 3], sum: () =&gt; &#123; console.log(this === window); // =&gt; true return this.array.reduce((result, item) =&gt; result + item); &#125;&#125;;console.log(this === window); // =&gt; true// Throws "TypeError: Cannot read property 'reduce' of undefined"calculator.sum(); calculator.sum ä½¿ç”¨ç®­å¤´å‡½æ•°æ¥å®šä¹‰ï¼Œä½†æ˜¯è°ƒç”¨çš„æ—¶å€™ä¼šæŠ›å‡º TypeErrorï¼Œå› ä¸ºè¿è¡Œæ—¶ this.array æ˜¯æœªå®šä¹‰çš„ï¼Œè°ƒç”¨ calculator.sum çš„æ—¶å€™ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡é‡Œé¢çš„ this ä»ç„¶æŒ‡å‘çš„æ˜¯ windowï¼ŒåŽŸå› æ˜¯ç®­å¤´å‡½æ•°æŠŠå‡½æ•°ä¸Šä¸‹æ–‡ç»‘å®šåˆ°äº† window ä¸Šï¼Œthis.array ç­‰ä»·äºŽ window.arrayï¼Œæ˜¾ç„¶åŽè€…æ˜¯æœªå®šä¹‰çš„ã€‚ è§£å†³çš„åŠžæ³•æ˜¯ï¼Œä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼æˆ–è€…æ–¹æ³•ç®€å†™ï¼ˆES6 ä¸­å·²ç»æ”¯æŒï¼‰æ¥å®šä¹‰æ–¹æ³•ï¼Œè¿™æ ·èƒ½ç¡®ä¿ this æ˜¯åœ¨è¿è¡Œæ—¶æ˜¯ç”±åŒ…å«å®ƒçš„ä¸Šä¸‹æ–‡å†³å®šçš„ï¼Œ 12345678const calculator = &#123; array: [1, 2, 3], sum() &#123; console.log(this === calculator); // =&gt; true return this.array.reduce((result, item) =&gt; result + item); &#125;&#125;;calculator.sum(); // =&gt; 6 å®šä¹‰åŽŸåž‹æ–¹æ³•åŒæ ·çš„è§„åˆ™é€‚ç”¨äºŽåŽŸåž‹æ–¹æ³•ï¼ˆprototype methodï¼‰çš„å®šä¹‰ï¼Œä½¿ç”¨ç®­å¤´å‡½æ•°ä¼šå¯¼è‡´è¿è¡Œæ—¶çš„æ‰§è¡Œä¸Šä¸‹æ–‡é”™è¯¯ 1234567891011function Cat(name) &#123; this.name = name;&#125;Cat.prototype.sayCatName = () =&gt; &#123; console.log(this === window); // =&gt; true return this.name;&#125;;const cat = new Cat('Mew');cat.sayCatName(); // =&gt; undefined è§£å†³æ–¹æ³•:ä½¿ç”¨ä¼ ç»Ÿçš„å‡½æ•°è¡¨è¾¾å¼å°±èƒ½è§£å†³é—®é¢˜ å®šä¹‰äº‹ä»¶å›žè°ƒå‡½æ•°12345const button = document.getElementById('myButton');button.addEventListener('click', () =&gt; &#123; console.log(this === window); // =&gt; true this.innerHTML = 'Clicked button';&#125;); åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸‹å®šä¹‰çš„ç®­å¤´å‡½æ•°æ‰§è¡Œæ—¶ this ä¼šæŒ‡å‘ windowï¼Œå½“å•å‡»äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæµè§ˆå™¨ä¼šå°è¯•ç”¨ button ä½œä¸ºä¸Šä¸‹æ–‡æ¥æ‰§è¡Œäº‹ä»¶å›žè°ƒå‡½æ•°ï¼Œä½†æ˜¯ç®­å¤´å‡½æ•°é¢„å®šä¹‰çš„ä¸Šä¸‹æ–‡æ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„ï¼Œè¿™æ · this.innerHTML å°±ç­‰ä»·äºŽ window.innerHTMLï¼Œè€ŒåŽè€…æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ã€‚ è§£å†³æ–¹æ³•:ä½¿ç”¨ä¼ ç»Ÿçš„å‡½æ•°è¡¨è¾¾å¼å°±èƒ½è§£å†³é—®é¢˜ å®šä¹‰æž„é€ å‡½æ•°æž„é€ å‡½æ•°ä¸­çš„ this æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå½“æ‰§è¡Œ new Car() çš„æ—¶å€™ï¼Œæž„é€ å‡½æ•° Car çš„ä¸Šä¸‹æ–‡å°±æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ this instanceof Car === trueã€‚æ˜¾ç„¶ï¼Œç®­å¤´å‡½æ•°æ˜¯ä¸èƒ½ç”¨æ¥åšæž„é€ å‡½æ•°ï¼Œ å®žé™…ä¸Š JS ä¼šç¦æ­¢ä½ è¿™ä¹ˆåšï¼Œå¦‚æžœä½ è¿™ä¹ˆåšäº†ï¼Œå®ƒå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ 12345const Message = (text) =&gt; &#123; this.text = text;&#125;;// Throws "TypeError: Message is not a constructor"const helloMessage = new Message('Hello World!'); è¿½æ±‚è¿‡çŸ­çš„ä»£ç åœ¨ä»£ç å¯è¯»æ€§æ–¹é¢ï¼Œæœ€çŸ­çš„ä»£ç å¯èƒ½å¹¶ä¸æ€»æ˜¯æœ€å¥½çš„ã€‚ä¸€å®šç¨‹åº¦ä¸Šï¼ŒåŽ‹ç¼©äº†å¤ªå¤šé€»è¾‘çš„ç®€çŸ­ä»£ç ï¼Œé˜…è¯»èµ·æ¥å°±æ²¡æœ‰é‚£ä¹ˆç›´è§‚ï¼Œ 1234const multiply = (a, b) =&gt; b === undefined ? b =&gt; a * b : a * b;const double = multiply(2);double(3); // =&gt; 6multiply(2, 3); // =&gt; 6 multiply å‡½æ•°ä¼šè¿”å›žä¸¤ä¸ªæ•°å­—çš„ä¹˜ç§¯æˆ–è€…è¿”å›žä¸€ä¸ªå¯ä»¥ç»§ç»­è°ƒç”¨çš„å›ºå®šäº†ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ã€‚ä»£ç çœ‹èµ·æ¥å¾ˆç®€çŸ­ï¼Œä½†å¤§å¤šæ•°äººç¬¬ä¸€çœ¼çœ‹ä¸ŠåŽ»å¯èƒ½æ— æ³•ç«‹å³æžæ¸…æ¥šå®ƒå¹²äº†ä»€ä¹ˆï¼Œæ€Žä¹ˆè®©è¿™æ®µä»£ç å¯è¯»æ€§æ›´é«˜å‘¢ï¼Ÿæœ‰å¾ˆå¤šåŠžæ³•ï¼Œå¯ä»¥åœ¨ç®­å¤´å‡½æ•°ä¸­åŠ ä¸Šæ‹¬å·ã€æ¡ä»¶åˆ¤æ–­ã€è¿”å›žè¯­å¥ï¼Œæˆ–è€… 123456789101112function multiply(a, b) &#123; if (b === undefined) &#123; return function (b) &#123; return a * b; &#125; &#125; return a * b;&#125;const double = multiply(2);double(3); // =&gt; 6multiply(2, 3); // =&gt; 6]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„ JSON.stringify() çš„å¨åŠ›]]></title>
    <url>%2F2019%2F12%2F12%2FJs%2F%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84-JSON-stringify-%E7%9A%84%E5%A8%81%E5%8A%9B%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ é€šè¿‡éœ€æ±‚å­¦ä¹ JSON.stringify()é¦–å…ˆæˆ‘ä»¬åœ¨å¼€å‘çš„è¿‡ç¨‹å½“ä¸­é‡åˆ°è¿™æ ·ä¸€ä¸ªå¤„ç†æ•°æ®çš„éœ€æ±‚ 123456const todayILearn = &#123; _id: 1, content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼', created_at: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)', updated_at: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)'&#125; æˆ‘ä»¬éœ€è¦å°†ä¸Šé¢è¿™ä¸ªå¯¹è±¡å¤„ç†æˆä¸‹é¢è¿™ä¸ªå¯¹è±¡ 123456const todayILearn = &#123; id: 1, content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼', createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)', updatedAt: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)'&#125; ä¹Ÿå°±æ˜¯åœ¨ä¸æ”¹å˜å±žæ€§çš„å€¼çš„å‰æä¸‹ï¼Œå°†å¯¹è±¡å±žæ€§ä¿®æ”¹ä¸€ä¸‹ã€‚ æŠŠ_id æ”¹æˆ idï¼ŒæŠŠ updated_at æ”¹æˆ updatedAtï¼ŒæŠŠ created_at æ”¹æˆ createdAtã€‚æˆ‘ä»¬çŽ°åœ¨é€šè¿‡è¿™ä¸ªå°å°çš„éœ€æ±‚æ¥è§è¯†ä¸€ä¸‹ JSON.stringify() çš„å¼ºå¤§å§ã€‚ é¦–å…ˆè¦è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘ä»¬æœ‰å¾ˆå¤šç§è§£å†³æ–¹å¼ï¼Œæˆ‘ä»¬å…ˆæä¾›ä¸¤ç§ä¸ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼š æ–¹æ¡ˆä¸€ï¼šä¸€æ¬¡éåŽ†+å¤šå£°æ˜Žä¸€ä¸ªå˜é‡ 123456789101112131415// å¤šä¸€ä¸ªå˜é‡å­˜å‚¨const todayILearnTemp = &#123;&#125;;for (const [key, value] of Object.entries(todayILearn)) &#123; if (key === "_id") todayILearnTemp["id"] = value; else if (key === "created_at") todayILearnTemp["createdAt"] = value; else if (key === "updatedAt") todayILearnTemp["updatedAt"] = value; else todayILearnTemp[key] = value;&#125;console.log(todayILearnTemp);// ç»“æžœï¼š// &#123; id: 1,// content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',// createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',// updated_at: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)' // &#125; æ–¹æ¡ˆä¸€å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥å®žçŽ°ã€‚ä½†æ˜¯å¤šå£°æ˜Žäº†ä¸€ä¸ªå˜é‡åˆåŠ ä¸Šä¸€å±‚å¾ªçŽ¯å¹¶ä¸”è¿˜æœ‰å¾ˆå¤šçš„ if else è¯­å¥ï¼Œæ€Žä¹ˆéƒ½æ˜¾å¾—ä¸å¤ªä¼˜é›…ã€‚ æ–¹æ¡ˆäºŒï¼šæš´åŠ› delete å±žæ€§å’Œå¢žåŠ å±žæ€§ 123456789101112131415// æžè‡´çš„æš´åŠ›ç¾Žå­¦todayILearn.id = todayILearn._id;todayILearn.createdAt = todayILearn.created_at;todayILearn.updatedAt = todayILearn.updated_at;delete todayILearn._id;delete todayILearn.created_at;delete todayILearn.updated_at;console.log(todayILearn);// å¤ªæš´åŠ›ðŸ˜¢//&#123; // content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',// id: 1,// createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',// updatedAt: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)' //&#125; ç›´æŽ¥ delete æš´åŠ›è§£å†³å¤ªç²—é²äº†ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå±žæ€§çš„é¡ºåºå˜äº†ã€‚ æ–¹æ¡ˆä¸‰ï¼šåºåˆ—åŒ–+ replace ç¾Žå­¦å…¸èŒƒ 1234567891011121314151617const mapObj = &#123; _id: "id", created_at: "createdAt", updated_at: "updatedAt"&#125;;JSON.parse( JSON.stringify(todayILearn).replace( /_id|created_at|updated_at/gi, matched =&gt; mapObj[matched]) )// &#123; // id: 1,// content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',// createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',// updatedAt: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)' // &#125; JSON.stringify() ä¹å¤§ç‰¹æ€§JSON.stringify()ç¬¬ä¸€å¤§ç‰¹æ€§å¯¹äºŽ undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä¸‰ä¸ªç‰¹æ®Šçš„å€¼åˆ†åˆ«ä½œä¸ºå¯¹è±¡å±žæ€§çš„å€¼ã€æ•°ç»„å…ƒç´ ã€å•ç‹¬çš„å€¼æ—¶ JSON.stringify()å°†è¿”å›žä¸åŒçš„ç»“æžœã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹çŸ¥è¯†ç‚¹ï¼Œçœ‹ä¸€é“éžå¸¸ç®€å•çš„é¢è¯•é¢˜ç›®ï¼šè¯·é—®ä¸‹é¢ä»£ç ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ 1234567891011const data = &#123; a: "aaa", b: undefined, c: Symbol("dd"), fn: function() &#123; return true; &#125;&#125;;JSON.stringify(data); // è¾“å‡ºï¼šï¼Ÿ// "&#123;"a":"aaa"&#125;" å¾ˆç®€å•è¿™é“é¢˜ç›®é¢è¯•å®˜ä¸»è¦è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹æ˜¯ï¼š undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä½œä¸ºå¯¹è±¡å±žæ€§å€¼æ—¶ JSON.stringify() å°†è·³è¿‡ï¼ˆå¿½ç•¥ï¼‰å¯¹å®ƒä»¬è¿›è¡Œåºåˆ—åŒ– é¢è¯•å®˜è¿½é—®ï¼šå‡è®¾ undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol å€¼ä½œä¸ºæ•°ç»„å…ƒç´ ä¼šæ˜¯æ€Žæ ·å‘¢ï¼Ÿ 12345JSON.stringify(["aaa", undefined, function aa() &#123; return true &#125;, Symbol('dd')]) // è¾“å‡ºï¼šï¼Ÿ// "["aaa",null,null,null]" çŸ¥è¯†ç‚¹æ˜¯ï¼š undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä½œä¸ºæ•°ç»„å…ƒç´ å€¼æ—¶ï¼ŒJSON.stringify() ä¼šå°†å®ƒä»¬åºåˆ—åŒ–ä¸º null æˆ‘ä»¬ç¨å¾®å†åŠ¨ä¸‹è„‘ç­‹ï¼Œå¦‚æžœå•ç‹¬åºåˆ—åŒ–è¿™äº›å€¼ä¼šæ˜¯ä»€ä¹ˆæ ·çš„ç»“æžœå‘¢ï¼Ÿ 123456JSON.stringify(function a ()&#123;console.log('a')&#125;)// undefinedJSON.stringify(undefined)// undefinedJSON.stringify(Symbol('dd'))// undefined å•ç‹¬è½¬æ¢çš„ç»“æžœå°±æ˜¯ï¼š undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol è¢« JSON.stringify() ä½œä¸ºå•ç‹¬çš„å€¼è¿›è¡Œåºåˆ—åŒ–æ—¶éƒ½ä¼šè¿”å›ž undefined JSON.stringify() ç¬¬ä¸€å¤§ç‰¹æ€§æ€»ç»“undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä½œä¸ºå¯¹è±¡å±žæ€§å€¼æ—¶ JSON.stringify() å¯¹è·³è¿‡ï¼ˆå¿½ç•¥ï¼‰å®ƒä»¬è¿›è¡Œåºåˆ—åŒ–undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä½œä¸ºæ•°ç»„å…ƒç´ å€¼æ—¶ï¼ŒJSON.stringify() å°†ä¼šå°†å®ƒä»¬åºåˆ—åŒ–ä¸º nullundefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol è¢« JSON.stringify() ä½œä¸ºå•ç‹¬çš„å€¼è¿›è¡Œåºåˆ—åŒ–æ—¶ï¼Œéƒ½ä¼šè¿”å›ž undefined JSON.stringify() ç¬¬äºŒå¤§ç‰¹æ€§éžæ•°ç»„å¯¹è±¡çš„å±žæ€§ä¸èƒ½ä¿è¯ä»¥ç‰¹å®šçš„é¡ºåºå‡ºçŽ°åœ¨åºåˆ—åŒ–åŽçš„å­—ç¬¦ä¸²ä¸­ã€‚ 1234567891011121314151617const data = &#123; a: "aaa", b: undefined, c: Symbol("dd"), fn: function() &#123; return true; &#125;, d: "ddd"&#125;;JSON.stringify(data); // è¾“å‡ºï¼šï¼Ÿ// "&#123;"a":"aaa","d":"ddd"&#125;"JSON.stringify(["aaa", undefined, function aa() &#123; return true &#125;, Symbol('dd'),"eee"]) // è¾“å‡ºï¼šï¼Ÿ// "["aaa",null,null,null,"eee"]" æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬ä¸€ç‰¹æ€§æ‰€è¯´ï¼ŒJSON.stringify() åºåˆ—åŒ–æ—¶ä¼šå¿½ç•¥ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯åºåˆ—åŒ–åŽçš„å­—ç¬¦ä¸²è¿˜æ˜¯ä»¥ç‰¹å®šçš„é¡ºåºå‡ºçŽ°ï¼ˆæ•°ç»„é™¤å¤–ï¼‰ã€‚ JSON.stringify() ç¬¬ä¸‰å¤§ç‰¹æ€§ è½¬æ¢å€¼å¦‚æžœæœ‰ toJSON() å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›žä»€ä¹ˆå€¼ï¼Œåºåˆ—åŒ–ç»“æžœå°±æ˜¯ä»€ä¹ˆå€¼ï¼Œå¹¶ä¸”å¿½ç•¥å…¶ä»–å±žæ€§çš„å€¼ã€‚ 1234567JSON.stringify(&#123; say: "hello JSON.stringify", toJSON: function() &#123; return "today i learn"; &#125; &#125;)// "today i learn" JSON.stringify()ç¬¬å››å¤§ç‰¹æ€§JSON.stringify() å°†ä¼šæ­£å¸¸åºåˆ—åŒ– Date çš„å€¼ã€‚ 12JSON.stringify(&#123; now: new Date() &#125;);// "&#123;"now":"2019-12-08T07:42:11.973Z"&#125;" å®žé™…ä¸Š Date å¯¹è±¡è‡ªå·±éƒ¨ç½²äº† toJSON() æ–¹æ³•ï¼ˆåŒDate.toISOString()ï¼‰ï¼Œå› æ­¤ Date å¯¹è±¡ä¼šè¢«å½“åšå­—ç¬¦ä¸²å¤„ç†ã€‚ JSON.stringify() ç¬¬äº”å¤§ç‰¹æ€§NaN å’Œ Infinity æ ¼å¼çš„æ•°å€¼åŠ null éƒ½ä¼šè¢«å½“åš nullã€‚ 123456JSON.stringify(NaN)// "null"JSON.stringify(null)// "null"JSON.stringify(Infinity)// "null" JSON.stringify() ç¬¬å…­å¤§ç‰¹æ€§å¸ƒå°”å€¼ã€æ•°å­—ã€å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„åŽŸå§‹å€¼ã€‚ 12JSON.stringify([new Number(1), new String("false"), new Boolean(false)]);// "[1,"false",false]" JSON.stringify() ç¬¬ä¸ƒå¤§ç‰¹æ€§å…³äºŽå¯¹è±¡å±žæ€§çš„æ˜¯å¦å¯æžšä¸¾ï¼š å…¶ä»–ç±»åž‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ Map/Set/WeakMap/WeakSetï¼Œä»…ä¼šåºåˆ—åŒ–å¯æžšä¸¾çš„å±žæ€§ã€‚ 1234567891011// ä¸å¯æžšä¸¾çš„å±žæ€§é»˜è®¤ä¼šè¢«å¿½ç•¥ï¼šJSON.stringify( Object.create( null, &#123; x: &#123; value: 'json', enumerable: false &#125;, y: &#123; value: 'stringify', enumerable: true &#125; &#125; ));// "&#123;"y":"stringify"&#125;" JSON.stringify() ç¬¬å…«å¤§ç‰¹æ€§æˆ‘ä»¬éƒ½çŸ¥é“å®žçŽ°æ·±æ‹·è´æœ€ç®€å•ç²—æš´çš„æ–¹å¼å°±æ˜¯åºåˆ—åŒ–ï¼šJSON.parse(JSON.stringify())ï¼Œè¿™ä¸ªæ–¹å¼å®žçŽ°æ·±æ‹·è´ä¼šå› ä¸ºåºåˆ—åŒ–çš„è¯¸å¤šç‰¹æ€§ä»Žè€Œå¯¼è‡´è¯¸å¤šçš„å‘ç‚¹ï¼šæ¯”å¦‚çŽ°åœ¨æˆ‘ä»¬è¦è¯´çš„å¾ªçŽ¯å¼•ç”¨é—®é¢˜ã€‚ 12345678910111213141516171819202122232425// å¯¹åŒ…å«å¾ªçŽ¯å¼•ç”¨çš„å¯¹è±¡ï¼ˆå¯¹è±¡ä¹‹é—´ç›¸äº’å¼•ç”¨ï¼Œå½¢æˆæ— é™å¾ªçŽ¯ï¼‰æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚ const obj = &#123; name: "loopObj"&#125;;const loopObj = &#123; obj&#125;;// å¯¹è±¡ä¹‹é—´å½¢æˆå¾ªçŽ¯å¼•ç”¨ï¼Œå½¢æˆé—­çŽ¯obj.loopObj = loopObj;// å°è£…ä¸€ä¸ªæ·±æ‹·è´çš„å‡½æ•°function deepClone(obj) &#123; return JSON.parse(JSON.stringify(obj));&#125;// æ‰§è¡Œæ·±æ‹·è´ï¼ŒæŠ›å‡ºé”™è¯¯deepClone(obj)/** VM44:9 Uncaught TypeError: Converting circular structure to JSON --&gt; starting at object with constructor 'Object' | property 'loopObj' -&gt; object with constructor 'Object' --- property 'obj' closes the circle at JSON.stringify (&lt;anonymous&gt;) at deepClone (&lt;anonymous&gt;:9:26) at &lt;anonymous&gt;:11:13 */ å¯¹åŒ…å«å¾ªçŽ¯å¼•ç”¨çš„å¯¹è±¡ï¼ˆå¯¹è±¡ä¹‹é—´ç›¸äº’å¼•ç”¨ï¼Œå½¢æˆæ— é™å¾ªçŽ¯ï¼‰æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚ è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆç”¨åºåˆ—åŒ–åŽ»å®žçŽ°æ·±æ‹·è´æ—¶ï¼Œé‡åˆ°å¾ªçŽ¯å¼•ç”¨çš„å¯¹è±¡ä¼šæŠ›å‡ºé”™è¯¯çš„åŽŸå›  JSON.stringify() ç¬¬ä¹å¤§ç‰¹æ€§æ‰€æœ‰ä»¥ symbol ä¸ºå±žæ€§é”®çš„å±žæ€§éƒ½ä¼šè¢«å®Œå…¨å¿½ç•¥æŽ‰ï¼Œå³ä¾¿ replacer å‚æ•°ä¸­å¼ºåˆ¶æŒ‡å®šåŒ…å«äº†å®ƒä»¬ã€‚ 1234567JSON.stringify(&#123; [Symbol.for("json")]: "stringify" &#125;, function(k, v) &#123; if (typeof k === "symbol") &#123; return v; &#125; &#125;)// undefined replacer æ˜¯ JSON.stringify() çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ¯”è¾ƒå°‘ç”¨åˆ°ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šå¿˜è®° JSON.stringify() ç¬¬äºŒä¸ªã€ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œåœºæ™¯ä¸å¤šï¼Œä½†æ˜¯ç”¨çš„å¥½çš„è¯ä¼šéžå¸¸æ–¹ä¾¿ï¼Œå…³äºŽ JSON.stringify() ç¬¬ä¹å¤§ç‰¹æ€§çš„ä¾‹å­ä¸­å¯¹ replacer å‚æ•°ä¸æ˜Žç™½çš„åŒå­¦å…ˆåˆ«æ€¥ï¼Œå…¶å®žå¾ˆç®€å•ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±ä¼šåœ¨ä¸‹é¢çš„å­¦ä¹ ä¸­å¼„æ‡‚ã€‚ ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°JSON.stringify() ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•° å¼ºå¤§çš„ç¬¬äºŒä¸ªå‚æ•°ï¼šä½œä¸ºå‡½æ•°æ—¶ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œé”®ï¼ˆkeyï¼‰å’Œå€¼ï¼ˆvalueï¼‰ï¼Œå‡½æ•°ç±»ä¼¼å°±æ˜¯æ•°ç»„æ–¹æ³• mapã€filter ç­‰æ–¹æ³•çš„å›žè°ƒå‡½æ•°ï¼Œå¯¹æ¯ä¸€ä¸ªå±žæ€§å€¼éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡è¯¥å‡½æ•°ï¼ˆæœŸé—´æˆ‘ä»¬è¿˜ç®€å•å®žçŽ°è¿‡ä¸€ä¸ª map å‡½æ•°ï¼‰ã€‚å¦‚æžœ replacer æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å€¼ä»£è¡¨å°†è¢«åºåˆ—åŒ–æˆ JSON å­—ç¬¦ä¸²çš„å±žæ€§åã€‚ åŽä¸½çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šå¦‚æžœæ˜¯ä¸€ä¸ªæ•°å­—, åˆ™åœ¨å­—ç¬¦ä¸²åŒ–æ—¶æ¯ä¸€çº§åˆ«ä¼šæ¯”ä¸Šä¸€çº§åˆ«ç¼©è¿›å¤šè¿™ä¸ªæ•°å­—å€¼çš„ç©ºæ ¼ï¼ˆæœ€å¤š10ä¸ªç©ºæ ¼ï¼‰ï¼› å¦‚æžœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™æ¯ä¸€çº§åˆ«ä¼šæ¯”ä¸Šä¸€çº§åˆ«å¤šç¼©è¿›è¯¥å­—ç¬¦ä¸²ï¼ˆæˆ–è¯¥å­—ç¬¦ä¸²çš„å‰10ä¸ªå­—ç¬¦ï¼‰ã€‚]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨vueé«˜é˜¶ç»„ä»¶]]></title>
    <url>%2F2019%2F11%2F25%2FVue%2F%E4%BD%BF%E7%94%A8vue%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[å‰æ–‡é«˜é˜¶ç»„ä»¶(HOC)æ˜¯ä¸€ç§æž¶æž„æ¨¡å¼ï¼Œåœ¨ React ä¸­éžå¸¸å¸¸è§ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨ Vue ä¸­ä½¿ç”¨ã€‚å®ƒå¯ä»¥è¢«æè¿°ä¸ºä¸€ç§åœ¨ç»„ä»¶ä¹‹é—´å…±äº«å…¬å…±åŠŸèƒ½è€Œä¸éœ€è¦é‡å¤ä»£ç çš„æ–¹æ³•ã€‚HOC çš„ç›®çš„æ˜¯å¢žå¼ºç»„ä»¶çš„åŠŸèƒ½ã€‚å®ƒå…è®¸åœ¨é¡¹ç›®ä¸­å®žçŽ°å¯é‡ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ åªè¦ä½ å‘ä¸€ä¸ªæ–¹æ³•ä¼ å…¥ç»„ä»¶ï¼Œç„¶åŽè¿”å›žä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œè¿™å°±æ˜¯ä¸€ä¸ª HOCã€‚ é«˜é˜¶ç»„ä»¶åœ¨ä»¥ä¸‹æ–¹é¢éžå¸¸æœ‰ç”¨: 1.æ“ä½œå±žæ€§ã€‚ 2.æ“ä½œæ•°æ®å’Œæ•°æ®æŠ½è±¡ã€‚ 3.ä»£ç é‡ç”¨ é¢„å¤‡çŸ¥è¯†åœ¨æˆ‘ä»¬å¼€å§‹æ•™ç¨‹ä¹‹å‰ï¼Œéœ€è¦äº†è§£ä»¥ä¸‹å‡ ç‚¹ï¼š ä½¿ç”¨ Vue æ¡†æž¶çš„ç»éªŒã€‚çŸ¥é“å¦‚ä½•ä½¿ç”¨ vue-cli è®¾ç½®åº”ç”¨ç¨‹åºã€‚JavaScript å’Œ Vue çš„åŸºæœ¬çŸ¥è¯†Node (8)npm (5.2.0) Vue ä¸­çš„é«˜é˜¶ç»„ä»¶æ¨¡å¼è™½ç„¶é«˜é˜¶ç»„ä»¶é€šå¸¸ä¸Ž React ç›¸å…³è”ï¼Œä½†æ˜¯ä¸º Vue ç»„ä»¶åˆ›å»ºé«˜é˜¶ç»„ä»¶æ˜¯å¾ˆæœ‰å¯èƒ½çš„ã€‚åœ¨ Vue ä¸­åˆ›å»ºé«˜é˜¶ç»„ä»¶çš„æ¨¡å¼å¦‚ä¸‹æ‰€ç¤ºã€‚ 123456789101112// hoccomponent.jsimport Vue from "vue"import ComponentExample from '@/components/ComponentExample.vue'const HoComponent = (component) =&gt; &#123; return Vue.component('withSubscription', &#123; render(createElement) &#123; return createElement(component) &#125; &#125;&#125;const HoComponentEnhanced = HoComponent(ComponentExample); å¦‚ä¸Šé¢çš„ä»£ç å—æ‰€ç¤ºï¼ŒHoComponent å‡½æ•°æŽ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°ç»„ä»¶æ¥æ¸²æŸ“ä¼ è¿›æ¥çš„ç»„ä»¶ã€‚ ä¸€ä¸ªç®€å•çš„ HOC ç¤ºä¾‹åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸ªä½¿ç”¨é«˜é˜¶ç»„ä»¶çš„ç¤ºä¾‹ã€‚åœ¨ä»‹ç»é«˜é˜¶ç»„ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬å°†äº†è§£åœ¨æ²¡æœ‰é«˜é˜¶ç»„ä»¶çš„æƒ…å†µä¸‹ï¼Œå½“å‰çš„ä»£ç åº“æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œç„¶åŽäº†è§£å¦‚ä½•è¿›è¡ŒæŠ½è±¡ã€‚ https://codesandbox.io/embed/llvq04nx4l æ­£å¦‚ä¸Šé¢çš„ CodeSandbox æ‰€ç¤ºï¼Œè¯¥åº”ç”¨ç¨‹åºä¼šæ˜¾ç¤ºä¸€ä¸ªçº¸ä¸šå…¬å¸åŠå…¶å‡€èµ„äº§çš„åˆ—è¡¨ï¼Œä»¥åŠã€ŠåŠžå…¬å®¤ã€‹(ç¾Žå›½)ä¸­çš„äººç‰©åŠå…¶èŽ·å¥–æƒ…å†µã€‚ æˆ‘ä»¬èŽ·å¾—åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰æ•°æ®æ¥æºåªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯mockData.jsæ–‡ä»¶ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778// src/components/mockData.jsconst staff = [ &#123; name: "Michael Scott", id: 0, awards: 2 &#125;, &#123; name: "Toby Flenderson", id: 1, awards: 0 &#125;, &#123; name: "Dwight K. Schrute", id: 2, awards: 10 &#125;, &#123; name: "Jim Halpert", id: 3, awards: 1 &#125;, &#123; name: "Andy Bernard", id: 4, awards: 0 &#125;, &#123; name: "Phyllis Vance", id: 5, awards: 0 &#125;, &#123; name: "Stanley Hudson", id: 6, awards: 0 &#125;];const paperCompanies = [ &#123; id: 0, name: "Staples", net: 10000000 &#125;, &#123; id: 1, name: "Dundler Mufflin", net: 5000000 &#125;, &#123; id: 2, name: "Michael Scott Paper Company", net: 300000 &#125;, &#123; id: 3, name: "Prince Family Paper", net: 30000 &#125;];export default &#123; getStaff() &#123; return staff; &#125;, getCompanies() &#123; return paperCompanies; &#125;, increaseAward(id) &#123; staff[id].awards++; &#125;, decreaseAward(id) &#123; staff[id].awards--; &#125;, setNetWorth(id) &#123; paperCompanies[id].net = Math.random() * (5000000 - 50000) + 50000; &#125;&#125;; åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæœ‰å‡ ä¸ª const å˜é‡ä¿å­˜äº†å…¬å¸å’Œå‘˜å·¥åˆ—è¡¨çš„ä¿¡æ¯ã€‚æˆ‘ä»¬ä¹Ÿå¯¼å‡ºäº†ä¸€äº›å‡½æ•°ï¼Œ å®žçŽ°ä»¥ä¸‹åŠŸèƒ½ï¼šè¿”å›žå‘˜å·¥åˆ—è¡¨è¿”å›žå…¬å¸åˆ—è¡¨å¢žåŠ å’Œå‡å°‘å¯¹ç‰¹å®šå‘˜å·¥çš„å¥–åŠ±ï¼Œæœ€åŽæœ€åŽï¼Œè®¾å®šå…¬å¸çš„å‡€å€¼ æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ Staff.vue å’Œ Companies.vue ç»„ä»¶ã€‚ 12345678910111213141516171819202122232425262728293031// src/components/Staff.vue&lt;template&gt; &lt;main&gt; &lt;h3&gt;Staff List&lt;/h3&gt; &lt;div v-for="(staff, i) in staffList" :key="i"&gt; &#123;&#123; staff.name &#125;&#125;: &#123;&#123; staff.awards &#125;&#125; Salesman of the year Award ðŸŽ‰ &lt;button @click="increaseAwards(staff.id);"&gt;+&lt;/button&gt; &lt;button @click="decreaseAwards(staff.id);"&gt;-&lt;/button&gt; &lt;/div&gt; &lt;/main&gt;&lt;/template&gt;&lt;script&gt; import mockData from "./mockData.js"; export default &#123; data() &#123; return &#123; staffList: mockData.getStaff() &#125;; &#125;, methods: &#123; increaseAwards(id) &#123; mockData.increaseAward(id); this.staffList = mockData.getStaff(); &#125;, decreaseAwards(id) &#123; mockData.decreaseAward(id); this.staffList = mockData.getStaff(); &#125; &#125; &#125;;&lt;/script&gt; åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæ•°æ®å®žä¾‹å˜é‡staffListè¢«èµ‹å€¼ä¸ºå‡½æ•°mockData.getStaff()è¿”å›žçš„å†…å®¹ã€‚æˆ‘ä»¬ä¹Ÿæœ‰increaseAwardså’ŒdecreaseAwardså‡½æ•°ï¼Œåˆ†åˆ«è°ƒç”¨mockData.increaseAward å’Œ mockData.decreaseAwardã€‚ä¼ é€’ç»™è¿™äº›å‡½æ•°çš„id æ˜¯ä»Žæ¸²æŸ“çš„æ¨¡æ¿ä¸­èŽ·å¾—çš„ã€‚ 123456789101112131415161718192021222324252627// src/components/Companies.vue&lt;template&gt; &lt;main&gt; &lt;h3&gt;Paper Companies&lt;/h3&gt; &lt;div v-for="(companies, i) in companies" :key="i"&gt; &#123;&#123; companies.name &#125;&#125; - $&#123;&#123; companies.net &#125;&#125;&lt;button @click="setWorth(companies.id);"&gt;Set Company Value&lt;/button&gt; &lt;/div&gt; &lt;/main&gt;&lt;/template&gt;&lt;script&gt; import mockData from "./mockData.js"; export default &#123; data() &#123; return &#123; companies: mockData.getCompanies() &#125;; &#125;, methods: &#123; setWorth(id) &#123; mockData.setNetWorth(id); this.companies = mockData.getCompanies(); &#125; &#125; &#125;;&lt;/script&gt; åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæ•°æ®å®žä¾‹å˜é‡companies è¢«èµ‹å€¼ä¸ºå‡½æ•°mockData.getCompanies()çš„è¿”å›žå†…å®¹ã€‚æˆ‘ä»¬è¿˜æœ‰setWorthå‡½æ•°ï¼Œå®ƒé€šè¿‡å°†å…¬å¸çš„ id ä¼ é€’ç»™mockData.setNetWorthæ¥è®¾ç½®ä¸€ä¸ªéšæœºå€¼ä½œä¸ºå‡€å€¼ã€‚ä¼ é€’ç»™å‡½æ•°çš„idæ˜¯ä»Žæ¸²æŸ“çš„æ¨¡æ¿ä¸­èŽ·å¾—çš„ã€‚ çŽ°åœ¨æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†è¿™ä¸¤ä¸ªç»„ä»¶æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬å¯ä»¥ æ‰¾å‡ºå®ƒä»¬ä¹‹é—´çš„å…±åŒç‚¹ï¼Œå¹¶å°†å…¶æŠ½è±¡å¦‚ä¸‹ï¼š ä»Žæ•°æ®æºèŽ·å–æ•°æ® (mockData.js)onClick å‡½æ•° æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å°†ä¸Šé¢çš„æ“ä½œæ”¾åˆ°é«˜é˜¶ç»„ä»¶ä¸­ï¼Œä»¥é¿å…ä»£ç é‡å¤å¹¶ç¡®ä¿å¯é‡ç”¨æ€§ã€‚ HoComponent å‡½æ•°æŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªç»„ä»¶å’ŒfetchDataã€‚fetchDataæ–¹æ³•ç”¨äºŽç¡®å®šè¦åœ¨è¡¨ç¤ºç»„ä»¶ä¸­æ˜¾ç¤ºä»€ä¹ˆã€‚è¿™æ„å‘³ç€æ— è®ºåœ¨å“ªé‡Œä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œä½œä¸ºfetchData ä¼ é€’çš„å‡½æ•°éƒ½å°†è¢«ç”¨æ¥ä»ŽmockData ä¸­èŽ·å–æ•°æ®ã€‚ ç„¶åŽå°†æ•°æ®å®žä¾‹returnedData è®¾ç½®ä¸ºfetchDataçš„å†…å®¹ï¼Œç„¶åŽä½œä¸ºprops ä¼ é€’ç»™åœ¨é«˜é˜¶ç»„ä»¶ä¸­åˆ›å»ºçš„æ–°ç»„ä»¶ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹æ–°åˆ›å»ºçš„é«˜é˜¶ç»„ä»¶å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚æˆ‘ä»¬éœ€è¦ç¼–è¾‘Staff.vue å’ŒCompanies.vueã€‚ 12345678910111213141516// src/components/Staff.vue&lt;template&gt; &lt;main&gt; &lt;h3&gt;Staff List&lt;/h3&gt; &lt;div v-for="(staff, i) in returnedData" :key="i"&gt; &#123;&#123; staff.name &#125;&#125;: &#123;&#123; staff.awards &#125;&#125; Salesman of the year Award ðŸŽ‰ &lt;button @click="increaseAwards(staff.id);"&gt;+&lt;/button&gt; &lt;button @click="decreaseAwards(staff.id);"&gt;-&lt;/button&gt; &lt;/div&gt; &lt;/main&gt;&lt;/template&gt;&lt;script&gt; export default &#123; props: ["returnedData"] &#125;;&lt;/script&gt; 123456789101112131415// src/components/Companies.vue&lt;template&gt; &lt;main&gt; &lt;h3&gt;Paper Companies&lt;/h3&gt; &lt;div v-for="(companies, i) in returnedData" :key="i"&gt; &#123;&#123; companies.name &#125;&#125; - $&#123;&#123; companies.net &#125;&#125;&lt;button @click="setWorth(companies.id);"&gt;Set Company Value&lt;/button&gt; &lt;/div&gt; &lt;/main&gt;&lt;/template&gt;&lt;script&gt; export default &#123; props: ["returnedData"] &#125;;&lt;/script&gt; æ­£å¦‚ä½ åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­çœ‹åˆ°çš„ï¼Œå¯¹äºŽè¿™ä¸¤ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬åŽ»æŽ‰äº†å‡½æ•°å’Œæ•°æ®å®žä¾‹å˜é‡ï¼Œæ˜¾ç¤ºå†…å®¹æ‰€éœ€çš„æ‰€æœ‰æ•°æ®çŽ°åœ¨éƒ½å°†ä»Žè¿™äº›propsä¸­èŽ·å¾—ã€‚å¯¹äºŽåˆ æŽ‰çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°†å¾ˆå¿«ä¼šè®²åˆ°ã€‚ åœ¨ App.vue ç»„ä»¶ä¸­ï¼Œç”¨ä»¥ä¸‹ä»£ç ç¼–è¾‘script æ ‡ç­¾ä¸­çš„çŽ°æœ‰å†…å®¹ï¼š 123456789101112131415161718192021222324// src/App.vue&lt;script&gt; // import the Companies component import Companies from "./components/Companies"; // import the Staff component import Staff from "./components/Staff"; // import the higher order component import HoComponent from "./components/HoComponent.js"; // Create a const variable which contains the Companies component wrapped in the higher order component const CompaniesComponent = HoComponent(Companies, mockData =&gt; mockData.getCompanies() ); // Create a const variable which contains the Staff component wrapped in the higher order component const StaffComponent = HoComponent(Staff, mockData =&gt; mockData.getStaff()); export default &#123; name: "App", components: &#123; CompaniesComponent, StaffComponent &#125; &#125;;&lt;/script&gt; åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼ŒHoComponentç”¨äºŽåŒ…è£… Staff å’Œ Companies ç»„ä»¶ã€‚ æ¯ä¸ªç»„ä»¶ä½œä¸ºHoComponent çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¿”å›žå¦ä¸€ä¸ªå‡½æ•°ï¼ŒæŒ‡å®šåº”è¯¥ä»ŽmockDataèŽ·å–ä»€ä¹ˆæ•°æ®ã€‚è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„é«˜é˜¶ç»„ä»¶(HoComponent.js)ä¸­çš„fetchData å‡½æ•°ã€‚ å¦‚æžœä½ çŽ°åœ¨åˆ·æ–°åº”ç”¨ç¨‹åºï¼Œä½ åº”è¯¥ä»ç„¶å¯ä»¥çœ‹åˆ°æ¥è‡ªmockData æ–‡ä»¶çš„æ•°æ®åƒå¾€å¸¸ä¸€æ ·å‘ˆçŽ°ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œè¿™äº›æŒ‰é’®æ— æ³•å·¥ä½œï¼Œå› ä¸ºå®ƒä»¬è¿˜æ²¡æœ‰ç»‘å®šåˆ°ä»»ä½•å‡½æ•°ã€‚è®©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051// src/App.vue&lt;template&gt; &lt;div id="app"&gt; &lt;CompaniesComponent @click="onEventHappen" /&gt; &lt;StaffComponent @click="onEventHappen" /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; // import the Companies component import Companies from "./components/Companies"; // import the Staff component import Staff from "./components/Staff"; // import the higher order component import HoComponent from "./components/HoComponent.js"; // import the source data from mockData only to be used for event handlers import sourceData from "./components/mockData.js"; // Create a const variable which contains the Companies component wrapped in the higher order component const CompaniesComponent = HoComponent(Companies, mockData =&gt; mockData.getCompanies() ); // Create a const variable which contains the Staff component wrapped in the higher order component const StaffComponent = HoComponent(Staff, mockData =&gt; mockData.getStaff()); export default &#123; name: "App", components: &#123; CompaniesComponent, StaffComponent &#125;, methods: &#123; onEventHappen(value) &#123; // set the variable setFunction to the name of the function that was passed iin the value emitted from child component i.e. if value.name is 'increaseAward', setFunction is set to increaseAward() let setFunction = sourceData[value.name]; // call the corresponding function with the id passed as an argument. setFunction(value.id); &#125; &#125; &#125;;&lt;/script&gt;&lt;style&gt;#app &#123; font-family: "Avenir", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-align: center; color: #2c3e50; margin-top: 60px;&#125;&lt;/style&gt; åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæˆ‘ä»¬åœ¨App.vueç»„ä»¶ä¸­æ·»åŠ äº†ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚ vueçš„ç»„ä»¶ã€‚æ¯å½“Staff.vue æˆ–Companies.vue ç»„ä»¶è¢«ç‚¹å‡»æ—¶ï¼ŒonEventHappen æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ã€‚ åœ¨onEventHappenæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°†å˜é‡setFunction è®¾ç½®ä¸ºä»Žå­ç»„ä»¶å‘å‡ºçš„å€¼ä¸­ä¼ é€’çš„å‡½æ•°åï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœvalue.nameæ˜¯â€™increaseAwardâ€™ï¼Œé‚£ä¹ˆsetFunctionè®¾ç½®ä¸ºincreaseAward()ã€‚setFunction å°†ä»¥idä½œä¸ºå‚æ•°æ‰§è¡Œã€‚ æœ€åŽï¼Œä¸ºäº†å°†äº‹ä»¶ç›‘å¬å™¨ä¼ é€’ç»™å°è£…åœ¨é«˜é˜¶ç»„ä»¶ä¸­çš„ç»„ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ HoComponent.jsæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢è¿™è¡Œä»£ç ã€‚ 1234props: &#123;returnedData: this.returnedData&#125;,on: &#123; ...this.$listeners &#125; vue-hocæˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨vue-hocåº“æ¥å¸®åŠ©åˆ›å»ºé«˜é˜¶ç»„ä»¶ã€‚vue-hocå¸®åŠ©ä½ è½»æ¾åœ°åˆ›å»ºé«˜é˜¶ç»„ä»¶ï¼Œä½ è¦åšçš„å°±æ˜¯ä¼ é€’åŸºæœ¬ç»„ä»¶ã€åº”ç”¨äºŽHOCçš„ä¸€ç³»åˆ—ç»„ä»¶é€‰é¡¹å’Œåœ¨æ¸²æŸ“é˜¶æ®µä¼ é€’ç»™ç»„ä»¶çš„æ•°æ®å±žæ€§ã€‚vue-hoc å¯ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼š npm install --save vue-hoc å¤åˆ¶ä»£ç vue-hocæ’ä»¶æœ‰ä¸€äº›ä¾‹å­å¯ä»¥è®©ä½ å¼€å§‹åˆ›å»ºæ›´é«˜é˜¶çš„ç»„ä»¶ï¼Œä½ å¯ä»¥æŸ¥çœ‹è¿™é‡Œ.]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€å¼ å›¾ç†æ¸… Vue 3.0 çš„å“åº”å¼ç³»ç»Ÿ]]></title>
    <url>%2F2019%2F10%2F29%2FVue%2F%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%90%86%E6%B8%85-Vue-3-0-%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F%2F</url>
    <content type="text"><![CDATA[è½¬è‡ª ä½œè€…ï¼šJrainé“¾æŽ¥ ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­Vue 3.0 çš„å“åº”å¼ç³»ç»Ÿæ˜¯ç‹¬ç«‹çš„æ¨¡å—ï¼Œå¯ä»¥å®Œå…¨è„±ç¦» Vue è€Œä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ clone äº†æºç ä¸‹æ¥ä»¥åŽï¼Œå¯ä»¥ç›´æŽ¥åœ¨ packages/reactivity æ¨¡å—ä¸‹è°ƒè¯•ã€‚ 1.åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ yarn dev reactivityï¼Œç„¶åŽè¿›å…¥ packages/reactivity ç›®å½•æ‰¾åˆ°äº§å‡ºçš„ dist/reactivity.global.js æ–‡ä»¶ã€‚2.æ–°å»ºä¸€ä¸ª index.htmlï¼Œå†™å…¥å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415&lt;script src="./dist/reactivity.global.js"&gt;&lt;/script&gt;&lt;script&gt;const &#123; reactive, effect &#125; = VueObserverconst origin = &#123; count: 0&#125;const state = reactive(origin)const fn = () =&gt; &#123; const count = state.count console.log(`set count to $&#123;count&#125;`)&#125;effect(fn)&lt;/script&gt; åœ¨æµè§ˆå™¨æ‰“å¼€è¯¥æ–‡ä»¶ï¼ŒäºŽæŽ§åˆ¶å°æ‰§è¡Œ state.count++ï¼Œä¾¿å¯çœ‹åˆ°è¾“å‡º set count to 1ã€‚ åœ¨ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ reactive() å‡½æ•°æŠŠ origin å¯¹è±¡è½¬åŒ–æˆäº†Proxy å¯¹è±¡ stateï¼›ä½¿ç”¨ effect() å‡½æ•°æŠŠ fn() ä½œä¸ºå“åº”å¼å›žè°ƒã€‚å½“ state.count å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¾¿è§¦å‘äº† fn()ã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬å°†ä»¥è¿™ä¸ªä¾‹å­ç»“åˆä¸Šæ–‡çš„æµç¨‹å›¾ï¼Œæ¥è®²è§£è¿™å¥—å“åº”å¼ç³»ç»Ÿæ˜¯æ€Žä¹ˆè¿è¡Œçš„ã€‚ åˆå§‹åŒ–é˜¶æ®µ åœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œä¸»è¦åšäº†ä¸¤ä»¶äº‹ã€‚ 1.æŠŠ origin å¯¹è±¡è½¬åŒ–æˆå“åº”å¼çš„ Proxy å¯¹è±¡ stateã€‚2.æŠŠå‡½æ•° fn() ä½œä¸ºä¸€ä¸ªå“åº”å¼çš„ effect å‡½æ•°ã€‚ å¤§å®¶éƒ½çŸ¥é“ï¼ŒVue 3.0 ä½¿ç”¨äº† Proxy æ¥ä»£æ›¿ä¹‹å‰çš„ Object.defineProperty()ï¼Œæ”¹å†™äº†å¯¹è±¡çš„ getter/setterï¼Œå®Œæˆä¾èµ–æ”¶é›†å’Œå“åº”è§¦å‘ã€‚ä½†æ˜¯åœ¨è¿™ä¸€é˜¶æ®µä¸­ï¼Œæˆ‘ä»¬æš‚æ—¶å…ˆä¸ç®¡å®ƒæ˜¯å¦‚ä½•æ”¹å†™å¯¹è±¡çš„ getter/setter çš„ï¼Œè¿™ä¸ªåœ¨åŽç»­çš„â€ä¾èµ–æ”¶é›†é˜¶æ®µâ€œä¼šè¯¦ç»†è¯´æ˜Žã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™éƒ¨åˆ†çš„å†…å®¹æµ“ç¼©æˆä¸€ä¸ªåªæœ‰ä¸¤è¡Œä»£ç çš„ reactive() å‡½æ•°ï¼š 1234export default reactive (target)&#123; const observed = new Proxy(target,handler); return observed;&#125; å½“ä¸€ä¸ªæ™®é€šçš„å‡½æ•° fn() è¢« effect() åŒ…è£¹ä¹‹åŽï¼Œå°±ä¼šå˜æˆä¸€ä¸ªå“åº”å¼çš„ effect å‡½æ•°ï¼Œè€Œ fn() ä¹Ÿä¼šè¢«ç«‹å³æ‰§è¡Œä¸€æ¬¡ã€‚ ç”±äºŽåœ¨ fn() é‡Œé¢æœ‰å¼•ç”¨åˆ° Proxy å¯¹è±¡çš„å±žæ€§ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥ä¼šè§¦å‘å¯¹è±¡çš„ getterï¼Œä»Žè€Œå¯åŠ¨ä¾èµ–æ”¶é›†ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸ª effect å‡½æ•°ä¹Ÿä¼šè¢«åŽ‹å…¥ä¸€ä¸ªåä¸ºâ€activeReactiveEffectStackâ€œï¼ˆæ­¤å¤„ä¸º effectStackï¼‰çš„æ ˆä¸­ï¼Œä¾›åŽç»­ä¾èµ–æ”¶é›†çš„æ—¶å€™ä½¿ç”¨ã€‚ 123456789101112131415161718192021222324export function effect (fn) &#123; // æž„é€ ä¸€ä¸ª effect const effect = function effect(...args) &#123; return run(effect, fn, args) &#125; // ç«‹å³æ‰§è¡Œä¸€æ¬¡ effect() return effect&#125;export function run(effect, fn, args) &#123; if (effectStack.indexOf(effect) === -1) &#123; try &#123; // å¾€æ± å­é‡Œæ”¾å…¥å½“å‰ effect effectStack.push(effect) // ç«‹å³æ‰§è¡Œä¸€é fn() // fn() æ‰§è¡Œè¿‡ç¨‹ä¼šå®Œæˆä¾èµ–æ”¶é›†ï¼Œä¼šç”¨åˆ° effect return fn(...args) &#125; finally &#123; // å®Œæˆä¾èµ–æ”¶é›†åŽä»Žæ± å­ä¸­æ‰”æŽ‰è¿™ä¸ª effect effectStack.pop() &#125; &#125;&#125; è‡³æ­¤ï¼Œåˆå§‹åŒ–é˜¶æ®µå·²ç»å®Œæˆã€‚æŽ¥ä¸‹æ¥å°±æ˜¯æ•´ä¸ªç³»ç»Ÿæœ€å…³é”®çš„ä¸€æ­¥â€”â€”ä¾èµ–æ”¶é›†é˜¶æ®µã€‚ ä¾èµ–æ”¶é›†é˜¶æ®µè¿™ä¸ªé˜¶æ®µçš„è§¦å‘æ—¶æœºï¼Œå°±æ˜¯åœ¨ effect è¢«ç«‹å³æ‰§è¡Œï¼Œå…¶å†…éƒ¨çš„ fn() è§¦å‘äº† Proxy å¯¹è±¡çš„ getter çš„æ—¶å€™ã€‚ç®€å•æ¥è¯´ï¼Œåªè¦æ‰§è¡Œåˆ°ç±»ä¼¼ state.count çš„è¯­å¥ï¼Œå°±ä¼šè§¦å‘ state çš„ getterã€‚ ä¾èµ–æ”¶é›†é˜¶æ®µæœ€é‡è¦çš„ç›®çš„ï¼Œå°±æ˜¯å»ºç«‹ä¸€ä»½â€ä¾èµ–æ”¶é›†è¡¨â€œï¼Œä¹Ÿå°±æ˜¯å›¾ç¤ºçš„â€targetMapâ€œã€‚targetMap æ˜¯ä¸€ä¸ª WeakMapï¼Œå…¶ key å€¼æ˜¯å½“å‰çš„ Proxy å¯¹è±¡ stateä»£ç†å‰çš„å¯¹è±¡originï¼Œè€Œ value åˆ™æ˜¯è¯¥å¯¹è±¡æ‰€å¯¹åº”çš„ depsMapã€‚ depsMap æ˜¯ä¸€ä¸ª Mapï¼Œkey å€¼ä¸ºè§¦å‘ getter æ—¶çš„å±žæ€§å€¼ï¼ˆæ­¤å¤„ä¸º countï¼‰ï¼Œè€Œ value åˆ™æ˜¯è§¦å‘è¿‡è¯¥å±žæ€§å€¼æ‰€å¯¹åº”çš„å„ä¸ª effectã€‚ è¿˜æ˜¯æœ‰ç‚¹ç»•ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å†ä¸¾ä¸ªä¾‹å­ã€‚å‡è®¾æœ‰ä¸ª Proxy å¯¹è±¡å’Œ effect å¦‚ä¸‹ï¼š 12345678910111213141516const state = reactive(&#123; count: 0, age: 18&#125;)const effect1 = effect(() =&gt; &#123; console.log('effect1: ' + state.count)&#125;)const effect2 = effect(() =&gt; &#123; console.log('effect2: ' + state.age)&#125;)const effect3 = effect(() =&gt; &#123; console.log('effect3: ' + state.count, state.age)&#125;) è¿™æ ·ï¼Œ{ target -&gt; key -&gt; dep } çš„å¯¹åº”å…³ç³»å°±å»ºç«‹èµ·æ¥äº†ï¼Œä¾èµ–æ”¶é›†ä¹Ÿå°±å®Œæˆäº† 123456789101112131415161718export function track (target, operationType, key) &#123; const effect = effectStack[effectStack.length - 1] if (effect) &#123; let depsMap = targetMap.get(target) if (depsMap === void 0) &#123; targetMap.set(target, (depsMap = new Map())) &#125; let dep = depsMap.get(key) if (dep === void 0) &#123; depsMap.set(key, (dep = new Set())) &#125; if (!dep.has(effect)) &#123; dep.add(effect) &#125; &#125;&#125; å¼„æ˜Žç™½ä¾èµ–æ”¶é›†è¡¨ targetMap æ˜¯éžå¸¸é‡è¦çš„ï¼Œå› ä¸ºè¿™æ˜¯æ•´ä¸ªå“åº”å¼ç³»ç»Ÿæ ¸å¿ƒä¸­çš„æ ¸å¿ƒã€‚ å“åº”é˜¶æ®µå›žé¡¾ä¸Šä¸€ç« èŠ‚çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª { count: 0, age: 18 } çš„ Proxyï¼Œå¹¶æž„é€ äº†ä¸‰ä¸ª effectã€‚åœ¨æŽ§åˆ¶å°ä¸Šçœ‹çœ‹æ•ˆæžœï¼š å½“ä¿®æ”¹å¯¹è±¡çš„æŸä¸ªå±žæ€§å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº”çš„ setterã€‚ setter é‡Œé¢çš„ trigger() å‡½æ•°ä¼šä»Žä¾èµ–æ”¶é›†è¡¨é‡Œæ‰¾åˆ°å½“å‰å±žæ€§å¯¹åº”çš„å„ä¸ª depï¼Œç„¶åŽæŠŠå®ƒä»¬æŽ¨å…¥åˆ° effects å’Œ computedEffectsï¼ˆè®¡ç®—å±žæ€§ï¼‰ é˜Ÿåˆ—ä¸­ï¼Œæœ€åŽé€šè¿‡ scheduleRun() æŒ¨ä¸ªæ‰§è¡Œé‡Œé¢çš„ effectã€‚ ç”±äºŽå·²ç»å»ºç«‹äº†ä¾èµ–æ”¶é›†è¡¨ï¼Œæ‰€ä»¥è¦æ‰¾åˆ°å±žæ€§æ‰€å¯¹åº”çš„ dep ä¹Ÿå°±è½»è€Œæ˜“ä¸¾äº† 12345678910111213141516171819export function trigger (target, operationType, key) &#123; // å–å¾—å¯¹åº”çš„ depsMap const depsMap = targetMap.get(target) if (depsMap === void 0) &#123; return &#125; // å–å¾—å¯¹åº”çš„å„ä¸ª dep const effects = new Set() if (key !== void 0) &#123; const dep = depsMap.get(key) dep &amp;&amp; dep.forEach(effect =&gt; &#123; effects.add(effect) &#125;) &#125; // ç®€åŒ–ç‰ˆ scheduleRunï¼ŒæŒ¨ä¸ªæ‰§è¡Œ effect effects.forEach(effect =&gt; &#123; effect() &#125;)&#125; è‡³æ­¤ï¼Œå“åº”å¼é˜¶æ®µå®Œæˆã€‚]]></content>
      <categories>
        <category>Vue3.x</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£Node.jsä¸­çš„è¿›ç¨‹ä¸Žçº¿ç¨‹]]></title>
    <url>%2F2019%2F09%2F30%2FNode%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Node-js%E4%B8%AD%E7%9A%84%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ å‰è¨€è¿›ç¨‹ä¸Žçº¿ç¨‹æ˜¯ä¸€ä¸ªç¨‹åºå‘˜çš„å¿…çŸ¥æ¦‚å¿µï¼Œé¢è¯•ç»å¸¸è¢«é—®åŠï¼Œä½†æ˜¯ä¸€äº›æ–‡ç« å†…å®¹åªæ˜¯è®²è®²ç†è®ºçŸ¥è¯†ï¼Œå¯èƒ½ä¸€äº›å°ä¼™ä¼´å¹¶æ²¡æœ‰çœŸçš„ç†è§£ï¼Œåœ¨å®žé™…å¼€å‘ä¸­åº”ç”¨ä¹Ÿæ¯”è¾ƒå°‘ã€‚æœ¬ç¯‡æ–‡ç« é™¤äº†ä»‹ç»æ¦‚å¿µï¼Œé€šè¿‡Node.js çš„è§’åº¦è®²è§£è¿›ç¨‹ä¸Žçº¿ç¨‹ï¼Œå¹¶ä¸”è®²è§£ä¸€äº›åœ¨é¡¹ç›®ä¸­çš„å®žæˆ˜çš„åº”ç”¨ï¼Œè®©ä½ ä¸ä»…èƒ½è¿Žæˆ˜é¢è¯•å®˜è¿˜å¯ä»¥åœ¨å®žæˆ˜ä¸­å®Œç¾Žåº”ç”¨ æ–‡ç« å¯¼è§ˆ é¢è¯•ä¼šé—® Node.jsæ˜¯å•çº¿ç¨‹å—ï¼Ÿ Node.js åšè€—æ—¶çš„è®¡ç®—æ—¶å€™ï¼Œå¦‚ä½•é¿å…é˜»å¡žï¼Ÿ Node.jså¦‚ä½•å®žçŽ°å¤šè¿›ç¨‹çš„å¼€å¯å’Œå…³é—­ï¼Ÿ Node.jså¯ä»¥åˆ›å»ºçº¿ç¨‹å—ï¼Ÿ ä½ ä»¬å¼€å‘è¿‡ç¨‹ä¸­å¦‚ä½•å®žçŽ°è¿›ç¨‹å®ˆæŠ¤çš„ï¼Ÿ é™¤äº†ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œä½ ä»¬è‡ªå·±æ˜¯å¦å°è£…è¿‡ä¸€ä¸ªå¤šè¿›ç¨‹æž¶æž„? è¿›ç¨‹è¿›ç¨‹Processæ˜¯è®¡ç®—æœºä¸­çš„ç¨‹åºå…³äºŽæŸæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œæ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿç»“æž„çš„åŸºç¡€ï¼Œè¿›ç¨‹æ˜¯çº¿ç¨‹çš„å®¹å™¨ï¼ˆæ¥è‡ªç™¾ç§‘ï¼‰ã€‚è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ã€‚æˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªæœåŠ¡ã€è¿è¡Œä¸€ä¸ªå®žä¾‹ï¼Œå°±æ˜¯å¼€ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ï¼Œä¾‹å¦‚ Java é‡Œçš„ JVM æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼ŒNode.js é‡Œé€šè¿‡ node app.js å¼€å¯ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ï¼Œå¤šè¿›ç¨‹å°±æ˜¯è¿›ç¨‹çš„å¤åˆ¶ï¼ˆforkï¼‰ï¼Œfork å‡ºæ¥çš„æ¯ä¸ªè¿›ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„ç‹¬ç«‹ç©ºé—´åœ°å€ã€æ•°æ®æ ˆï¼Œä¸€ä¸ªè¿›ç¨‹æ— æ³•è®¿é—®å¦å¤–ä¸€ä¸ªè¿›ç¨‹é‡Œå®šä¹‰çš„å˜é‡ã€æ•°æ®ç»“æž„ï¼Œåªæœ‰å»ºç«‹äº† IPC é€šä¿¡ï¼Œè¿›ç¨‹ä¹‹é—´æ‰å¯æ•°æ®å…±äº«ã€‚ Node.jså¼€å¯æœåŠ¡è¿›ç¨‹ä¾‹å­ 1234567const http = require('http');const server = http.createServer();server.listen(3000,()=&gt;&#123; process.title='ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—æµ‹è¯•è¿›ç¨‹'; console.log('è¿›ç¨‹id',process.pid)&#125;) è¿è¡Œä¸Šé¢ä»£ç åŽï¼Œä»¥ä¸‹ä¸º Mac ç³»ç»Ÿè‡ªå¸¦çš„ç›‘æŽ§å·¥å…· â€œæ´»åŠ¨ç›‘è§†å™¨â€ æ‰€å±•ç¤ºçš„æ•ˆæžœï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšå¼€å¯çš„ Nodejs è¿›ç¨‹ 7663 çº¿ç¨‹çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œé¦–å…ˆæˆ‘ä»¬è¦æ¸…æ¥šçº¿ç¨‹æ˜¯éš¶å±žäºŽè¿›ç¨‹çš„ï¼Œè¢«åŒ…å«äºŽè¿›ç¨‹ä¹‹ä¸­ã€‚ä¸€ä¸ªçº¿ç¨‹åªèƒ½éš¶å±žäºŽä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯ä¸€ä¸ªè¿›ç¨‹æ˜¯å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹çš„ã€‚ å•çº¿ç¨‹å•çº¿ç¨‹å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹åªå¼€ä¸€ä¸ªçº¿ç¨‹ Javascript å°±æ˜¯å±žäºŽå•çº¿ç¨‹ï¼Œç¨‹åºé¡ºåºæ‰§è¡Œ(è¿™é‡Œæš‚ä¸”ä¸æJSå¼‚æ­¥)ï¼Œå¯ä»¥æƒ³è±¡ä¸€ä¸‹é˜Ÿåˆ—ï¼Œå‰é¢ä¸€ä¸ªæ‰§è¡Œå®Œä¹‹åŽï¼ŒåŽé¢æ‰å¯ä»¥æ‰§è¡Œï¼Œå½“ä½ åœ¨ä½¿ç”¨å•çº¿ç¨‹è¯­è¨€ç¼–ç æ—¶åˆ‡å‹¿æœ‰è¿‡å¤šè€—æ—¶çš„åŒæ­¥æ“ä½œï¼Œå¦åˆ™çº¿ç¨‹ä¼šé€ æˆé˜»å¡žï¼Œå¯¼è‡´åŽç»­å“åº”æ— æ³•å¤„ç†ã€‚ä½ å¦‚æžœé‡‡ç”¨ Javascript è¿›è¡Œç¼–ç æ—¶å€™ï¼Œè¯·å°½å¯èƒ½çš„åˆ©ç”¨Javascriptå¼‚æ­¥æ“ä½œçš„ç‰¹æ€§ã€‚ ç»å…¸è®¡ç®—è€—æ—¶é€ æˆçº¿ç¨‹é˜»å¡žçš„ä¾‹å­ 123456789101112131415161718192021222324const http = require('http');const longComputation = () =&gt; &#123; let sum = 0; for (let i = 0; i &lt; 1e10; i++) &#123; sum += i; &#125;; return sum;&#125;;const server = http.createServer();server.on('request', (req, res) =&gt; &#123; if (req.url === '/compute') &#123; console.info('è®¡ç®—å¼€å§‹',new Date()); const sum = longComputation(); console.info('è®¡ç®—ç»“æŸ',new Date()); return res.end(`Sum is $&#123;sum&#125;`); &#125; else &#123; res.end('Ok') &#125;&#125;);server.listen(3000);//æ‰“å°ç»“æžœ//è®¡ç®—å¼€å§‹ 2019-07-28T07:08:49.849Z//è®¡ç®—ç»“æŸ 2019-07-28T07:09:04.522Z æŸ¥çœ‹æ‰“å°ç»“æžœï¼Œå½“æˆ‘ä»¬è°ƒç”¨127.0.0.1:3000/computeçš„æ—¶å€™ï¼Œå¦‚æžœæƒ³è¦è°ƒç”¨å…¶ä»–çš„è·¯ç”±åœ°å€æ¯”å¦‚127.0.0.1/å¤§çº¦éœ€è¦15ç§’æ—¶é—´ï¼Œä¹Ÿå¯ä»¥è¯´ä¸€ä¸ªç”¨æˆ·è¯·æ±‚å®Œç¬¬ä¸€ä¸ªcomputeæŽ¥å£åŽéœ€è¦ç­‰å¾…15ç§’ï¼Œè¿™å¯¹äºŽç”¨æˆ·æ¥è¯´æ˜¯æžå…¶ä¸å‹å¥½çš„ã€‚ä¸‹æ–‡æˆ‘ä¼šé€šè¿‡åˆ›å»ºå¤šè¿›ç¨‹çš„æ–¹å¼child_process.fork å’Œcluster æ¥è§£å†³è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ å•çº¿ç¨‹çš„ä¸€äº›è¯´æ˜Ž Node.js è™½ç„¶æ˜¯å•çº¿ç¨‹æ¨¡åž‹ï¼Œä½†æ˜¯å…¶åŸºäºŽäº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥éžé˜»å¡žæ¨¡å¼ï¼Œå¯ä»¥åº”ç”¨äºŽé«˜å¹¶å‘åœºæ™¯ï¼Œé¿å…äº†çº¿ç¨‹åˆ›å»ºã€çº¿ç¨‹ä¹‹é—´ä¸Šä¸‹æ–‡åˆ‡æ¢æ‰€äº§ç”Ÿçš„èµ„æºå¼€é”€ã€‚ å½“ä½ çš„é¡¹ç›®ä¸­éœ€è¦æœ‰å¤§é‡è®¡ç®—ï¼ŒCPU è€—æ—¶çš„æ“ä½œæ—¶å€™ï¼Œè¦æ³¨æ„è€ƒè™‘å¼€å¯å¤šè¿›ç¨‹æ¥å®Œæˆäº†ã€‚ Node.js å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé”™è¯¯ä¼šå¼•èµ·æ•´ä¸ªåº”ç”¨é€€å‡ºï¼Œåº”ç”¨çš„å¥å£®æ€§å€¼å¾—è€ƒéªŒï¼Œå°¤å…¶æ˜¯é”™è¯¯çš„å¼‚å¸¸æŠ›å‡ºï¼Œä»¥åŠè¿›ç¨‹å®ˆæŠ¤æ˜¯å¿…é¡»è¦åšçš„ã€‚ å•çº¿ç¨‹æ— æ³•åˆ©ç”¨å¤šæ ¸CPUï¼Œä½†æ˜¯åŽæ¥Node.js æä¾›çš„APIä»¥åŠä¸€äº›ç¬¬ä¸‰æ–¹å·¥å…·ç›¸åº”éƒ½å¾—åˆ°äº†è§£å†³ï¼Œæ–‡ç« åŽé¢éƒ½ä¼šè®²åˆ°ã€‚ Node.js ä¸­çš„è¿›ç¨‹ä¸Žçº¿ç¨‹Node.js æ˜¯ Javascript åœ¨æœåŠ¡ç«¯çš„è¿è¡ŒçŽ¯å¢ƒï¼Œæž„å»ºåœ¨ chrome çš„ V8 å¼•æ“Žä¹‹ä¸Šï¼ŒåŸºäºŽäº‹ä»¶é©±åŠ¨ã€éžé˜»å¡žI/Oæ¨¡åž‹ï¼Œå……åˆ†åˆ©ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„å¼‚æ­¥ I/O è¿›è¡Œå¤šä»»åŠ¡çš„æ‰§è¡Œï¼Œé€‚åˆäºŽ I/O å¯†é›†åž‹çš„åº”ç”¨åœºæ™¯ï¼Œå› ä¸ºå¼‚æ­¥ï¼Œç¨‹åºæ— éœ€é˜»å¡žç­‰å¾…ç»“æžœè¿”å›žï¼Œè€Œæ˜¯åŸºäºŽå›žè°ƒé€šçŸ¥çš„æœºåˆ¶ï¼ŒåŽŸæœ¬åŒæ­¥æ¨¡å¼ç­‰å¾…çš„æ—¶é—´ï¼Œåˆ™å¯ä»¥ç”¨æ¥å¤„ç†å…¶å®ƒä»»åŠ¡ ç§‘æ™®ï¼šåœ¨ Web æœåŠ¡å™¨æ–¹é¢ï¼Œè‘—åçš„ Nginx ä¹Ÿæ˜¯é‡‡ç”¨æ­¤æ¨¡å¼ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰ï¼Œé¿å…äº†å¤šçº¿ç¨‹çš„çº¿ç¨‹åˆ›å»ºã€çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼ŒNginx é‡‡ç”¨ C è¯­è¨€è¿›è¡Œç¼–å†™ï¼Œä¸»è¦ç”¨æ¥åšé«˜æ€§èƒ½çš„ Web æœåŠ¡å™¨ï¼Œä¸é€‚åˆåšä¸šåŠ¡ã€‚ Webä¸šåŠ¡å¼€å‘ä¸­ï¼Œå¦‚æžœä½ æœ‰é«˜å¹¶å‘åº”ç”¨åœºæ™¯é‚£ä¹ˆ Node.js ä¼šæ˜¯ä½ ä¸é”™çš„é€‰æ‹©ã€‚ åœ¨å•æ ¸ CPU ç³»ç»Ÿä¹‹ä¸Šæˆ‘ä»¬é‡‡ç”¨ å•è¿›ç¨‹ + å•çº¿ç¨‹ çš„æ¨¡å¼æ¥å¼€å‘ã€‚åœ¨å¤šæ ¸ CPU ç³»ç»Ÿä¹‹ä¸Šï¼Œå¯ä»¥é€šè¿‡ child_process.fork å¼€å¯å¤šä¸ªè¿›ç¨‹ï¼ˆNode.js åœ¨ v0.8 ç‰ˆæœ¬ä¹‹åŽæ–°å¢žäº†Cluster æ¥å®žçŽ°å¤šè¿›ç¨‹æž¶æž„ï¼‰ ï¼Œå³ å¤šè¿›ç¨‹ + å•çº¿ç¨‹ æ¨¡å¼ã€‚æ³¨æ„ï¼šå¼€å¯å¤šè¿›ç¨‹ä¸æ˜¯ä¸ºäº†è§£å†³é«˜å¹¶å‘ï¼Œä¸»è¦æ˜¯è§£å†³äº†å•è¿›ç¨‹æ¨¡å¼ä¸‹ Node.js CPU åˆ©ç”¨çŽ‡ä¸è¶³çš„æƒ…å†µï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸ CPU çš„æ€§èƒ½ã€‚ Node.js ä¸­çš„è¿›ç¨‹process æ¨¡å—Node.js ä¸­çš„è¿›ç¨‹ Process æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæ— éœ€ require ç›´æŽ¥ä½¿ç”¨ï¼Œç»™æˆ‘ä»¬æä¾›äº†å½“å‰è¿›ç¨‹ä¸­çš„ç›¸å…³ä¿¡æ¯ã€‚å®˜æ–¹æ–‡æ¡£æä¾›äº†è¯¦ç»†çš„è¯´æ˜Žï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥äº²è‡ªå®žè·µä¸‹ Process æ–‡æ¡£ã€‚ process.envï¼šçŽ¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚é€šè¿‡ process.env.NODE_ENV èŽ·å–ä¸åŒçŽ¯å¢ƒé¡¹ç›®é…ç½®ä¿¡æ¯ process.nextTickï¼šè¿™ä¸ªåœ¨è°ˆåŠ Event Loop æ—¶ç»å¸¸ä¸ºä¼šæåˆ° process.pidï¼šèŽ·å–å½“å‰è¿›ç¨‹id process.ppidï¼šå½“å‰è¿›ç¨‹å¯¹åº”çš„çˆ¶è¿›ç¨‹ process.cwd()ï¼šèŽ·å–å½“å‰è¿›ç¨‹å·¥ä½œç›®å½•ï¼Œ process.platformï¼šèŽ·å–å½“å‰è¿›ç¨‹è¿è¡Œçš„æ“ä½œç³»ç»Ÿå¹³å° process.uptime()ï¼šå½“å‰è¿›ç¨‹å·²è¿è¡Œæ—¶é—´ï¼Œä¾‹å¦‚ï¼špm2 å®ˆæŠ¤è¿›ç¨‹çš„ uptime å€¼ è¿›ç¨‹äº‹ä»¶ï¼šprocess.on(â€˜uncaughtExceptionâ€™, cb) æ•èŽ·å¼‚å¸¸ä¿¡æ¯ã€process.on(â€˜exitâ€™, cbï¼‰è¿›ç¨‹æŽ¨å‡ºç›‘å¬ ä¸‰ä¸ªæ ‡å‡†æµï¼šprocess.stdout æ ‡å‡†è¾“å‡ºã€process.stdin æ ‡å‡†è¾“å…¥ã€process.stderr æ ‡å‡†é”™è¯¯è¾“å‡º process.title æŒ‡å®šè¿›ç¨‹åç§°ï¼Œæœ‰çš„æ—¶å€™éœ€è¦ç»™è¿›ç¨‹æŒ‡å®šä¸€ä¸ªåç§° ä»¥ä¸Šä»…åˆ—ä¸¾äº†éƒ¨åˆ†å¸¸ç”¨åˆ°åŠŸèƒ½ç‚¹ï¼Œé™¤äº† Process ä¹‹å¤– Node.js è¿˜æä¾›äº† child_process æ¨¡å—ç”¨æ¥å¯¹å­è¿›ç¨‹è¿›è¡Œæ“ä½œï¼Œåœ¨ä¸‹æ–‡ Nodejsè¿›ç¨‹åˆ›å»ºä¼šç»§ç»­è®²è¿°ã€‚ Node.js è¿›ç¨‹åˆ›å»ºè¿›ç¨‹åˆ›å»ºæœ‰å¤šç§æ–¹å¼ï¼Œæœ¬ç¯‡æ–‡ç« ä»¥child_processæ¨¡å—å’Œclusteræ¨¡å—è¿›è¡Œè®²è§£ã€‚ child_processæ¨¡å—child_process æ˜¯ Node.js çš„å†…ç½®æ¨¡å—ï¼Œå®˜ç½‘åœ°å€ï¼š child_process å®˜ç½‘åœ°å€ï¼šnodejs.cn/api/child_pâ€¦ å‡ ä¸ªå¸¸ç”¨å‡½æ•°ï¼š å››ç§æ–¹å¼ child_process.spawn()ï¼šé€‚ç”¨äºŽè¿”å›žå¤§é‡æ•°æ®ï¼Œä¾‹å¦‚å›¾åƒå¤„ç†ï¼ŒäºŒè¿›åˆ¶æ•°æ®å¤„ç†ã€‚ child_process.exec()ï¼šé€‚ç”¨äºŽå°é‡æ•°æ®ï¼ŒmaxBuffer é»˜è®¤å€¼ä¸º 200 * 1024 è¶…å‡ºè¿™ä¸ªé»˜è®¤å€¼å°†ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œæ•°æ®é‡è¿‡å¤§å¯é‡‡ç”¨ spawnã€‚ child_process.execFile()ï¼šç±»ä¼¼ child_process.exec()ï¼ŒåŒºåˆ«æ˜¯ä¸èƒ½é€šè¿‡ shell æ¥æ‰§è¡Œï¼Œä¸æ”¯æŒåƒ I/O é‡å®šå‘å’Œæ–‡ä»¶æŸ¥æ‰¾è¿™æ ·çš„è¡Œä¸º child_process.fork()ï¼š è¡ç”Ÿæ–°çš„è¿›ç¨‹ï¼Œè¿›ç¨‹ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ V8 å®žä¾‹ã€å†…å­˜ï¼Œç³»ç»Ÿèµ„æºæ˜¯æœ‰é™çš„ï¼Œä¸å»ºè®®è¡ç”Ÿå¤ªå¤šçš„å­è¿›ç¨‹å‡ºæ¥ï¼Œé€šé•¿æ ¹æ®ç³»ç»Ÿ CPU æ ¸å¿ƒæ•°è®¾ç½®ã€‚ CPU æ ¸å¿ƒæ•°è¿™é‡Œç‰¹åˆ«è¯´æ˜Žä¸‹ï¼Œfork ç¡®å®žå¯ä»¥å¼€å¯å¤šä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯å¹¶ä¸å»ºè®®è¡ç”Ÿå‡ºæ¥å¤ªå¤šçš„è¿›ç¨‹ï¼Œcpuæ ¸å¿ƒæ•°çš„èŽ·å–æ–¹å¼const cpus = require(&#39;os&#39;).cpus();,è¿™é‡Œ cpus è¿”å›žä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼ŒåŒ…å«æ‰€å®‰è£…çš„æ¯ä¸ª CPU/å†…æ ¸çš„ä¿¡æ¯ï¼ŒäºŒè€…æ€»å’Œçš„æ•°ç»„å“¦ã€‚å‡è®¾ä¸»æœºè£…æœ‰ä¸¤ä¸ªcpuï¼Œæ¯ä¸ªcpuæœ‰4ä¸ªæ ¸ï¼Œé‚£ä¹ˆæ€»æ ¸æ•°å°±æ˜¯8ã€‚ forkå¼€å¯å­è¿›ç¨‹ Demo forkå¼€å¯å­è¿›ç¨‹è§£å†³æ–‡ç« èµ·åˆçš„è®¡ç®—è€—æ—¶é€ æˆçº¿ç¨‹é˜»å¡žã€‚ åœ¨è¿›è¡Œ compute è®¡ç®—æ—¶åˆ›å»ºå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹è®¡ç®—å®Œæˆé€šè¿‡ send æ–¹æ³•å°†ç»“æžœå‘é€ç»™ä¸»è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹é€šè¿‡ message ç›‘å¬åˆ°ä¿¡æ¯åŽå¤„ç†å¹¶é€€å‡ºã€‚ fork_app.js 1234567891011121314151617181920212223242526const http = require('http');const fork = require('child_process').fork;const server = http.createServer((req, res) =&gt; &#123; if(req.url == '/compute')&#123; const compute = fork('./fork_compute.js'); compute.send('å¼€å¯ä¸€ä¸ªæ–°çš„å­è¿›ç¨‹'); // å½“ä¸€ä¸ªå­è¿›ç¨‹ä½¿ç”¨ process.send() å‘é€æ¶ˆæ¯æ—¶ä¼šè§¦å‘ 'message' äº‹ä»¶ compute.on('message', sum =&gt; &#123; res.end(`Sum is $&#123;sum&#125;`); compute.kill(); &#125;); // å­è¿›ç¨‹ç›‘å¬åˆ°ä¸€äº›é”™è¯¯æ¶ˆæ¯é€€å‡º compute.on('close', (code, signal) =&gt; &#123; console.log(`æ”¶åˆ°closeäº‹ä»¶ï¼Œå­è¿›ç¨‹æ”¶åˆ°ä¿¡å· $&#123;signal&#125; è€Œç»ˆæ­¢ï¼Œé€€å‡ºç  $&#123;code&#125;`); compute.kill(); &#125;) &#125;else&#123; res.end(`ok`); &#125;&#125;);server.listen(3000, 127.0.0.1, () =&gt; &#123; console.log(`server started at http://$&#123;127.0.0.1&#125;:$&#123;3000&#125;`);&#125;); fork_compute.js é’ˆå¯¹æ–‡åˆéœ€è¦è¿›è¡Œè®¡ç®—çš„çš„ä¾‹å­æˆ‘ä»¬åˆ›å»ºå­è¿›ç¨‹æ‹†åˆ†å‡ºæ¥å•ç‹¬è¿›è¡Œè¿ç®—ã€‚ 123456789101112131415161718192021const computation = () =&gt; &#123; let sum = 0; console.info('è®¡ç®—å¼€å§‹'); console.time('è®¡ç®—è€—æ—¶'); for (let i = 0; i &lt; 1e10; i++) &#123; sum += i &#125;; console.info('è®¡ç®—ç»“æŸ'); console.timeEnd('è®¡ç®—è€—æ—¶'); return sum;&#125;;process.on('message', msg =&gt; &#123; console.log(msg, 'process.pid', process.pid); // å­è¿›ç¨‹id const sum = computation(); // å¦‚æžœNode.jsè¿›ç¨‹æ˜¯é€šè¿‡è¿›ç¨‹é—´é€šä¿¡äº§ç”Ÿçš„ï¼Œé‚£ä¹ˆï¼Œprocess.send()æ–¹æ³•å¯ä»¥ç”¨æ¥ç»™çˆ¶è¿›ç¨‹å‘é€æ¶ˆæ¯ process.send(sum);&#125;) clusteræ¨¡å—cluster å¼€å¯å­è¿›ç¨‹Demo 123456789101112131415161718192021const http = require('http');const numCPUs = require('os').cpus().length;const cluster = require('cluster');if(cluster.isMaster)&#123; console.log('Master proces id is',process.pid); // fork workers for(let i= 0;i&lt;numCPUs;i++)&#123; cluster.fork(); &#125; cluster.on('exit',function(worker,code,signal)&#123; console.log('worker process died,id',worker.process.pid) &#125;)&#125;else&#123; // Workerå¯ä»¥å…±äº«åŒä¸€ä¸ªTCPè¿žæŽ¥ // è¿™é‡Œæ˜¯ä¸€ä¸ªhttpæœåŠ¡å™¨ http.createServer(function(req,res)&#123; res.writeHead(200); res.end('hello word'); &#125;).listen(8000);&#125; clusteråŽŸç†åˆ†æž clusteræ¨¡å—è°ƒç”¨forkæ–¹æ³•æ¥åˆ›å»ºå­è¿›ç¨‹ï¼Œè¯¥æ–¹æ³•ä¸Žchild_processä¸­çš„forkæ˜¯åŒä¸€ä¸ªæ–¹æ³•ã€‚ clusteræ¨¡å—é‡‡ç”¨çš„æ˜¯ç»å…¸çš„ä¸»ä»Žæ¨¡åž‹ï¼ŒClusterä¼šåˆ›å»ºä¸€ä¸ªmasterï¼Œç„¶åŽæ ¹æ®ä½ æŒ‡å®šçš„æ•°é‡å¤åˆ¶å‡ºå¤šä¸ªå­è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨cluster.isMasterå±žæ€§åˆ¤æ–­å½“å‰è¿›ç¨‹æ˜¯masterè¿˜æ˜¯worker(å·¥ä½œè¿›ç¨‹)ã€‚ç”±masterè¿›ç¨‹æ¥ç®¡ç†æ‰€æœ‰çš„å­è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹ä¸è´Ÿè´£å…·ä½“çš„ä»»åŠ¡å¤„ç†ï¼Œä¸»è¦å·¥ä½œæ˜¯è´Ÿè´£è°ƒåº¦å’Œç®¡ç†ã€‚ clusteræ¨¡å—ä½¿ç”¨å†…ç½®çš„è´Ÿè½½å‡è¡¡æ¥æ›´å¥½åœ°å¤„ç†çº¿ç¨‹ä¹‹é—´çš„åŽ‹åŠ›ï¼Œè¯¥è´Ÿè½½å‡è¡¡ä½¿ç”¨äº†Round-robinç®—æ³•ï¼ˆä¹Ÿè¢«ç§°ä¹‹ä¸ºå¾ªçŽ¯ç®—æ³•ï¼‰ã€‚å½“ä½¿ç”¨Round-robinè°ƒåº¦ç­–ç•¥æ—¶ï¼Œmaster accepts()æ‰€æœ‰ä¼ å…¥çš„è¿žæŽ¥è¯·æ±‚ï¼Œç„¶åŽå°†ç›¸åº”çš„TCPè¯·æ±‚å¤„ç†å‘é€ç»™é€‰ä¸­çš„å·¥ä½œè¿›ç¨‹ï¼ˆè¯¥æ–¹å¼ä»ç„¶é€šè¿‡IPCæ¥è¿›è¡Œé€šä¿¡ï¼‰ã€‚ å¼€å¯å¤šè¿›ç¨‹æ—¶å€™ç«¯å£ç–‘é—®è®²è§£ï¼šå¦‚æžœå¤šä¸ªNodeè¿›ç¨‹ç›‘å¬åŒä¸€ä¸ªç«¯å£æ—¶ä¼šå‡ºçŽ° Error:listen EADDRIUNSçš„é”™è¯¯ï¼Œè€Œclusteræ¨¡å—ä¸ºä»€ä¹ˆå¯ä»¥è®©å¤šä¸ªå­è¿›ç¨‹ç›‘å¬åŒä¸€ä¸ªç«¯å£å‘¢?åŽŸå› æ˜¯masterè¿›ç¨‹å†…éƒ¨å¯åŠ¨äº†ä¸€ä¸ªTCPæœåŠ¡å™¨ï¼Œè€ŒçœŸæ­£ç›‘å¬ç«¯å£çš„åªæœ‰è¿™ä¸ªæœåŠ¡å™¨ï¼Œå½“æ¥è‡ªå‰ç«¯çš„è¯·æ±‚è§¦å‘æœåŠ¡å™¨çš„connectionäº‹ä»¶åŽï¼Œmasterä¼šå°†å¯¹åº”çš„socketå…·æŸ„å‘é€ç»™å­è¿›ç¨‹ã€‚ child_process æ¨¡å—ä¸Žcluster æ¨¡å—æ€»ç»“æ— è®ºæ˜¯ child_process æ¨¡å—è¿˜æ˜¯ cluster æ¨¡å—ï¼Œä¸ºäº†è§£å†³ Node.js å®žä¾‹å•çº¿ç¨‹è¿è¡Œï¼Œæ— æ³•åˆ©ç”¨å¤šæ ¸ CPU çš„é—®é¢˜è€Œå‡ºçŽ°çš„ã€‚æ ¸å¿ƒå°±æ˜¯çˆ¶è¿›ç¨‹ï¼ˆå³ master è¿›ç¨‹ï¼‰è´Ÿè´£ç›‘å¬ç«¯å£ï¼ŒæŽ¥æ”¶åˆ°æ–°çš„è¯·æ±‚åŽå°†å…¶åˆ†å‘ç»™ä¸‹é¢çš„ worker è¿›ç¨‹ã€‚ clusteræ¨¡å—çš„ä¸€ä¸ªå¼Šç«¯ï¼š clusterå†…éƒ¨éšæ—¶çš„æž„å»ºTCPæœåŠ¡å™¨çš„æ–¹å¼æ¥è¯´å¯¹ä½¿ç”¨è€…ç¡®å®žç®€å•å’Œé€æ˜Žäº†å¾ˆå¤šï¼Œä½†æ˜¯è¿™ç§æ–¹å¼æ— æ³•åƒä½¿ç”¨child_processé‚£æ ·çµæ´»ï¼Œå› ä¸ºä¸€ç›´ä¸»è¿›ç¨‹åªèƒ½ç®¡ç†ä¸€ç»„ç›¸åŒçš„å·¥ä½œè¿›ç¨‹ï¼Œè€Œè‡ªè¡Œé€šè¿‡child_processæ¥åˆ›å»ºå·¥ä½œè¿›ç¨‹ï¼Œä¸€ä¸ªä¸»è¿›ç¨‹å¯ä»¥æŽ§åˆ¶å¤šç»„è¿›ç¨‹ã€‚åŽŸå› æ˜¯child_processæ“ä½œå­è¿›ç¨‹æ—¶ï¼Œå¯ä»¥éšå¼çš„åˆ›å»ºå¤šä¸ªTCPæœåŠ¡å™¨ï¼Œå¯¹æ¯”ä¸Šé¢çš„ä¸¤å¹…å›¾åº”è¯¥èƒ½ç†è§£æˆ‘è¯´çš„å†…å®¹ã€‚ Node.jsè¿›ç¨‹é€šä¿¡åŽŸç†å‰é¢è®²è§£çš„æ— è®ºæ˜¯child_processæ¨¡å—ï¼Œè¿˜æ˜¯clusteræ¨¡å—ï¼Œéƒ½éœ€è¦ä¸»è¿›ç¨‹å’Œå·¥ä½œè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚é€šè¿‡fork()æˆ–è€…å…¶ä»–APIï¼Œåˆ›å»ºäº†å­è¿›ç¨‹ä¹‹åŽï¼Œä¸ºäº†å®žçŽ°çˆ¶å­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œçˆ¶å­è¿›ç¨‹ä¹‹é—´æ‰èƒ½é€šè¿‡messageå’Œsend()ä¼ é€’ä¿¡æ¯ã€‚ IPCè¿™ä¸ªè¯æˆ‘æƒ³å¤§å®¶å¹¶ä¸é™Œç”Ÿï¼Œä¸ç®¡é‚£ä¸€å¼ å¼€å‘è¯­è¨€åªè¦æåˆ°è¿›ç¨‹é€šä¿¡ï¼Œéƒ½ä¼šæåˆ°å®ƒã€‚IPCçš„å…¨ç§°æ˜¯Inter-Process Communication,å³è¿›ç¨‹é—´é€šä¿¡ã€‚å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†è®©ä¸åŒçš„è¿›ç¨‹èƒ½å¤Ÿäº’ç›¸è®¿é—®èµ„æºå¹¶è¿›è¡Œåè°ƒå·¥ä½œã€‚å®žçŽ°è¿›ç¨‹é—´é€šä¿¡çš„æŠ€æœ¯æœ‰å¾ˆå¤šï¼Œå¦‚å‘½åç®¡é“ï¼ŒåŒ¿åç®¡é“ï¼Œsocketï¼Œä¿¡å·é‡ï¼Œå…±äº«å†…å­˜ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰ã€‚Nodeä¸­å®žçŽ°IPCé€šé“æ˜¯ä¾èµ–äºŽlibuvã€‚windowsä¸‹ç”±å‘½åç®¡é“(name pipe)å®žçŽ°ï¼Œ*nixç³»ç»Ÿåˆ™é‡‡ç”¨Unix Domain Socketå®žçŽ°ã€‚è¡¨çŽ°åœ¨åº”ç”¨å±‚ä¸Šçš„è¿›ç¨‹é—´é€šä¿¡åªæœ‰ç®€å•çš„messageäº‹ä»¶å’Œsend()æ–¹æ³•ï¼ŒæŽ¥å£ååˆ†ç®€æ´å’Œæ¶ˆæ¯åŒ–ã€‚ IPCåˆ›å»ºå’Œå®žçŽ°ç¤ºæ„å›¾ IPCé€šä¿¡ç®¡é“æ˜¯å¦‚ä½•åˆ›å»ºçš„ çˆ¶è¿›ç¨‹åœ¨å®žé™…åˆ›å»ºå­è¿›ç¨‹ä¹‹å‰ï¼Œä¼šåˆ›å»ºIPCé€šé“å¹¶ç›‘å¬å®ƒï¼Œç„¶åŽæ‰çœŸæ­£çš„åˆ›å»ºå‡ºå­è¿›ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿä¼šé€šè¿‡çŽ¯å¢ƒå˜é‡ï¼ˆNODE_CHANNEL_FDï¼‰å‘Šè¯‰å­è¿›ç¨‹è¿™ä¸ªIPCé€šé“çš„æ–‡ä»¶æè¿°ç¬¦ã€‚å­è¿›ç¨‹åœ¨å¯åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®æ–‡ä»¶æè¿°ç¬¦åŽ»è¿žæŽ¥è¿™ä¸ªå·²å­˜åœ¨çš„IPCé€šé“ï¼Œä»Žè€Œå®Œæˆçˆ¶å­è¿›ç¨‹ä¹‹é—´çš„è¿žæŽ¥ Node.jså¥æŸ„ä¼ é€’è®²å¥æŸ„ä¹‹å‰ï¼Œå…ˆæƒ³ä¸€ä¸ªé—®é¢˜ï¼Œsendå¥æŸ„å‘é€çš„æ—¶å€™ï¼ŒçœŸçš„æ˜¯å°†æœåŠ¡å™¨å¯¹è±¡å‘é€ç»™äº†å­è¿›ç¨‹ï¼Ÿ å­è¿›ç¨‹å¯¹è±¡send()æ–¹æ³•å¯ä»¥å‘é€çš„å¥æŸ„ç±»åž‹net.Socket TCPå¥—æŽ¥å­—net.Server TCPæœåŠ¡å™¨ï¼Œä»»æ„å»ºç«‹åœ¨TCPæœåŠ¡ä¸Šçš„åº”ç”¨å±‚æœåŠ¡éƒ½å¯ä»¥äº«å—å®ƒå¸¦æ¥çš„å¥½å¤„net.Native C++å±‚é¢çš„TCPå¥—æŽ¥å­—æˆ–IPCç®¡é“dgram.Socket UDPå¥—æŽ¥å­—dgram.Native C++å±‚é¢çš„UDPå¥—æŽ¥å­— sendå¥æŸ„å‘é€åŽŸç†åˆ†æžç»“åˆå¥æŸ„çš„å‘é€ä¸Žè¿˜åŽŸç¤ºæ„å›¾æ›´å®¹æ˜“ç†è§£ã€‚ send()æ–¹æ³•åœ¨å°†æ¶ˆæ¯å‘é€åˆ°IPCç®¡é“å‰ï¼Œå®žé™…å°†æ¶ˆæ¯ç»„è£…æˆäº†ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªå‚æ•°æ˜¯hadlerï¼Œå¦ä¸€ä¸ªæ˜¯messageã€‚messageå‚æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š 12345&#123; cmd:'NODE_HANDLE', type:'net.Server', msg:message&#125; å‘é€åˆ°IPCç®¡é“ä¸­çš„å®žé™…ä¸Šæ˜¯æˆ‘ä»¬è¦å‘é€çš„å¥æŸ„æ–‡ä»¶æè¿°ç¬¦ã€‚è¿™ä¸ªmessageå¯¹è±¡åœ¨å†™å…¥åˆ°IPCç®¡é“æ—¶ï¼Œä¹Ÿä¼šé€šè¿‡JSON.stringfy()è¿›è¡Œåºåˆ—åŒ–ã€‚æ‰€ä»¥æœ€ç»ˆå‘é€åˆ°IPCé€šé“ä¸­çš„ä¿¡æ¯éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œsend()æ–¹æ³•èƒ½å‘é€æ¶ˆæ¯å’Œå¥æŸ„å¹¶ä¸æ„å‘³ç€å®ƒèƒ½å‘é€ä»»ä½•å¯¹è±¡ã€‚ è¿žæŽ¥äº†IPCé€šé“çš„å­çº¿ç¨‹å¯ä»¥è¯»å–çˆ¶è¿›ç¨‹å‘æ¥çš„æ¶ˆæ¯ï¼Œå°†å­—ç¬¦ä¸²é€šè¿‡JSON.parse()è§£æžè¿˜åŽŸä¸ºå¯¹è±¡åŽï¼Œæ‰è§¦å‘messageäº‹ä»¶å°†æ¶ˆæ¯ä¼ é€’ç»™åº”ç”¨å±‚ä½¿ç”¨ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯å¯¹è±¡è¿˜è¦è¢«è¿›è¡Œè¿‡æ»¤å¤„ç†ï¼Œmessage.cmdçš„å€¼å¦‚æžœä»¥NODE_ä¸ºå‰ç¼€ï¼Œå®ƒå°†å“åº”ä¸€ä¸ªå†…éƒ¨äº‹ä»¶internalMessageï¼Œå¦‚æžœmessage.cmdå€¼ä¸ºNODE_HANDLE,å®ƒå°†å–å‡ºmessage.typeå€¼å’Œå¾—åˆ°çš„æ–‡ä»¶æè¿°ç¬¦ä¸€èµ·è¿˜åŽŸå‡ºä¸€ä¸ªå¯¹åº”çš„å¯¹è±¡ã€‚ ä»¥å‘é€çš„TCPæœåŠ¡å™¨å¥æŸ„ä¸ºä¾‹ï¼Œå­è¿›ç¨‹æ”¶åˆ°æ¶ˆæ¯åŽçš„è¿˜åŽŸè¿‡ç¨‹ä»£ç å¦‚ä¸‹: 12345678function(message,handle,emit)&#123; var self = this; var server = new net.Server(); server.listen(handler,function()&#123; emit(server); &#125;);&#125; æ€»ç»“å¤šè¿›ç¨‹ vs å¤šçº¿ç¨‹ å±žæ€§å¤šè¿›ç¨‹å¤šçº¿ç¨‹æ¯”è¾ƒ æ•°æ®æ•°æ®å…±äº«å¤æ‚ï¼Œéœ€è¦ç”¨IPCï¼›æ•°æ®æ˜¯åˆ†å¼€çš„ï¼ŒåŒæ­¥ç®€å•å› ä¸ºå…±äº«è¿›ç¨‹æ•°æ®ï¼Œæ•°æ®å…±äº«ç®€å•ï¼ŒåŒæ­¥å¤æ‚å„æœ‰åƒç§‹ CPUã€å†…å­˜å ç”¨å†…å­˜å¤šï¼Œåˆ‡æ¢å¤æ‚ï¼ŒCPUåˆ©ç”¨çŽ‡ä½Žå ç”¨å†…å­˜å°‘ï¼Œåˆ‡æ¢ç®€å•ï¼ŒCPUåˆ©ç”¨çŽ‡é«˜å¤šçº¿ç¨‹æ›´å¥½ é”€æ¯ã€åˆ‡æ¢åˆ›å»ºé”€æ¯ã€åˆ‡æ¢å¤æ‚ï¼Œé€Ÿåº¦æ…¢åˆ›å»ºé”€æ¯ã€åˆ‡æ¢ç®€å•ï¼Œé€Ÿåº¦å¾ˆå¿«å¤šçº¿ç¨‹æ›´å¥½ codingç¼–ç ç®€å•ã€è°ƒè¯•æ–¹ä¾¿ç¼–ç ã€è°ƒè¯•å¤æ‚ç¼–ç ã€è°ƒè¯•å¤æ‚ å¯é æ€§è¿›ç¨‹ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¼šç›¸äº’å½±å“çº¿ç¨‹åŒå‘¼å¸å…±å‘½è¿å¤šè¿›ç¨‹æ›´å¥½ åˆ†å¸ƒå¼å¯ç”¨äºŽå¤šæœºå¤šæ ¸åˆ†å¸ƒå¼ï¼Œæ˜“äºŽæ‰©å±•åªèƒ½ç”¨äºŽå¤šæ ¸åˆ†å¸ƒå¼å¤šè¿›ç¨‹æ›´å¥½]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨17é“é¢˜ä¸­ç†è§£javascriptçš„ç±»åž‹è½¬æ¢]]></title>
    <url>%2F2019%2F08%2F08%2FJs%2F%E5%9C%A817%E9%81%93%E9%A2%98%E4%B8%AD%E7%90%86%E8%A7%A3javascript%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ ç±»åž‹è½¬æ¢æ˜¯å°†å€¼ä»Žä¸€ç§ç±»åž‹è½¬æ¢ä¸ºå¦ä¸€ç§ç±»åž‹çš„è¿‡ç¨‹ï¼ˆæ¯”å¦‚å­—ç¬¦ä¸²è½¬æ•°å­—ï¼Œå¯¹è±¡è½¬å¸ƒå°”å€¼ç­‰ï¼‰ã€‚ä»»ä½•ç±»åž‹ä¸è®ºæ˜¯åŽŸå§‹ç±»åž‹è¿˜æ˜¯å¯¹è±¡ç±»åž‹éƒ½å¯ä»¥è¿›è¡Œç±»åž‹è½¬æ¢ï¼ŒJavaScript çš„åŽŸå§‹ç±»åž‹æœ‰ï¼šnumber, string, boolean, null, undefined, Symbolã€‚ 1234567891011121314151617true + false12 / "6""number" + 15 + 315 + 3 + "number"[1] &gt; null"foo" + + "bar""true" == truefalse == "false"null == ""!!"false" == !!"true"["x"] == "x"[] + null + 1[1,2,3] == [1,2,3]&#123;&#125; + [] + &#123;&#125; + [1]! + [] + [] + ![]new Date(0) - 0new Date(0) + 0 ç±»ä¼¼äºŽä¸Šé¢çš„è¿™äº›é—®é¢˜å¤§æ¦‚çŽ‡ä¹Ÿä¼šåœ¨ JS é¢è¯•ä¸­è¢«é—®åˆ°, æ‰€ä»¥ç»§ç»­å¾€ä¸‹è¯»ã€‚ éšå¼è½¬æ¢VSæ˜¾ç¤ºè½¬æ¢ç±»åž‹è½¬æ¢å¯ä»¥åˆ†ä¸ºéšå¼ç±»åž‹è½¬æ¢å’Œæ˜¾å¼ç±»åž‹è½¬æ¢ã€‚ å½“å¼€å‘äººå‘˜é€šè¿‡ç¼–å†™é€‚å½“çš„ä»£ç (å¦‚Number(value))ç”¨äºŽåœ¨ç±»åž‹ä¹‹é—´è¿›è¡Œè½¬æ¢æ—¶ï¼Œå°±ç§°ä¸ºæ˜¾å¼ç±»åž‹å¼ºåˆ¶è½¬æ¢(æˆ–å¼ºåˆ¶ç±»åž‹è½¬æ¢)ã€‚ ç„¶è€Œ JavaScript æ˜¯å¼±ç±»åž‹è¯­è¨€ï¼Œåœ¨æŸäº›æ“ä½œä¸‹ï¼Œå€¼å¯ä»¥åœ¨ä¸¤ç§ç±»åž‹ä¹‹é—´è‡ªåŠ¨çš„è½¬æ¢ï¼Œè¿™å«åšéšå¼ç±»åž‹è½¬æ¢ã€‚åœ¨å¯¹ä¸åŒç±»åž‹çš„å€¼ä½¿ç”¨è¿ç®—ç¬¦æ—¶é€šå¸¸ä¼šå‘ç”Ÿéšå¼ç±»åž‹è½¬æ¢ã€‚æ¯”å¦‚ 1 == null, 2 / â€œ5â€, null + new Date()ã€‚å½“å€¼è¢« if è¯­å¥åŒ…è£¹æ—¶ä¹Ÿæœ‰å¯èƒ½å‘ç”Ÿï¼Œæ¯”å¦‚ if(value) {} ä¼šå°† value è½¬æ¢ä¸º booleanç±»åž‹ã€‚ ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰ä¸ä¼šè§¦å‘ç±»åž‹éšå¼è½¬æ¢ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ç”¨æ¥æ¯”è¾ƒå€¼å’Œç±»åž‹æ˜¯å¦éƒ½ç›¸ç­‰ã€‚ éšå¼ç±»åž‹è½¬æ¢æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œä½¿ç”¨å®ƒè™½ç„¶å¯ä»¥å†™æ›´å°‘çš„ä»£ç ä½†æœ‰æ—¶å€™ä¼šå‡ºçŽ°éš¾ä»¥è¢«å‘çŽ°çš„bugã€‚ ä¸‰ç§ç±»åž‹è½¬æ¢æˆ‘ä»¬éœ€è¦çŸ¥é“çš„ç¬¬ä¸€ä¸ªè§„åˆ™æ˜¯ï¼šåœ¨ JS ä¸­åªæœ‰ 3 ç§ç±»åž‹çš„è½¬æ¢ to string to boolean to number ç¬¬äºŒï¼Œç±»åž‹è½¬æ¢çš„é€»è¾‘åœ¨åŽŸå§‹ç±»åž‹å’Œå¯¹è±¡ç±»åž‹ä¸Šæ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯ä»–ä»¬éƒ½åªä¼šè½¬æ¢æˆä¸Šé¢ 3 ç§ç±»åž‹ä¹‹ä¸€ã€‚ æˆ‘ä»¬é¦–å…ˆåˆ†æžä¸€ä¸‹åŽŸå§‹ç±»åž‹è½¬æ¢ã€‚ String ç±»åž‹è½¬æ¢String() æ–¹æ³•å¯ä»¥ç”¨æ¥æ˜¾å¼å°†å€¼è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œéšå¼è½¬æ¢é€šå¸¸åœ¨æœ‰ + è¿ç®—ç¬¦å¹¶ä¸”æœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯ string ç±»åž‹æ—¶è¢«è§¦å‘ï¼Œå¦‚ï¼š 123String(123) // æ˜¾å¼ç±»åž‹è½¬æ¢123 + '' // éšå¼ç±»åž‹è½¬æ¢ æ‰€æœ‰åŽŸå§‹ç±»åž‹è½¬ String ç±»åž‹ 12345String(123) // '123'String(-12.3) // '-12.3'String(null) // 'null'String(undefined) // 'undefined'String(true) // 'true' Symbol ç±»åž‹è½¬ String ç±»åž‹æ˜¯æ¯”è¾ƒä¸¥æ ¼çš„ï¼Œå®ƒåªèƒ½è¢«æ˜¾å¼çš„è½¬æ¢ 123String(Symbol('symbol')) // 'Symbol(symbol)''' + Symbol('symbol') // TypeError is thrown Boolean ç±»åž‹è½¬æ¢Boolean() æ–¹æ³•å¯ä»¥ç”¨æ¥æ˜¾å¼å°†å€¼è½¬æ¢æˆ boolean åž‹ã€‚ éšå¼ç±»åž‹è½¬æ¢é€šå¸¸åœ¨é€»è¾‘åˆ¤æ–­æˆ–è€…æœ‰é€»è¾‘è¿ç®—ç¬¦æ—¶è¢«è§¦å‘ï¼ˆ|| &amp;&amp; !ï¼‰ã€‚ 1234Boolean(2) // æ˜¾ç¤ºç±»åž‹è½¬æ¢if(2) &#123;&#125; // é€»è¾‘åˆ¤æ–­è§¦å‘éšå¼ç±»åž‹è½¬æ¢!!2 // é€»è¾‘è¿ç®—ç¬¦è§¦å‘éšå¼ç±»åž‹è½¬æ¢2 || 'hello' // é€»è¾‘è¿ç®—ç¬¦è§¦å‘éšå¼ç±»åž‹è½¬æ¢ æ³¨æ„: é€»è¾‘è¿ç®—ç¬¦ï¼ˆæ¯”å¦‚ || å’Œ &amp;&amp;ï¼‰æ˜¯åœ¨å†…éƒ¨åšäº† boolean ç±»åž‹è½¬æ¢ï¼Œä½†å®žé™…ä¸Šè¿”å›žçš„æ˜¯åŽŸå§‹æ“ä½œæ•°çš„å€¼ï¼Œå³ä½¿ä»–ä»¬éƒ½ä¸æ˜¯ boolean ç±»åž‹ã€‚ 123// è¿”å›ž number ç±»åž‹ 123ï¼Œè€Œä¸æ˜¯ boolean åž‹ true// 'hello' å’Œ '123' ä»ç„¶åœ¨å†…éƒ¨ä¼šè½¬æ¢æˆ boolean åž‹æ¥è®¡ç®—è¡¨è¾¾å¼let x = 'hello' &amp;&amp; 123 // x === 123 boolean ç±»åž‹è½¬æ¢åªä¼šæœ‰ true æˆ–è€… false ä¸¤ç§ç»“æžœã€‚ 1234567Boolean('') // falseBoolean(0) // false Boolean(-0) // falseBoolean(NaN) // falseBoolean(null) // falseBoolean(undefined) // falseBoolean(false) // false ä»»ä½•ä¸åœ¨ä¸Šé¢åˆ—è¡¨ä¸­çš„å€¼éƒ½ä¼šè½¬æ¢ä¸º true, åŒ…æ‹¬ object, function, Array, Date ç­‰ï¼ŒSymbol ç±»åž‹æ˜¯çœŸå€¼ï¼Œç©ºå¯¹è±¡å’Œç©ºæ•°ç»„ä¹Ÿæ˜¯çœŸå€¼ã€‚ 12345Boolean(&#123;&#125;) // trueBoolean([]) // trueBoolean(Symbol()) // true!!Symbol() // trueBoolean(function() &#123;&#125;) // true Number ç±»åž‹è½¬æ¢å’Œ Boolean()ã€String() æ–¹æ³•ä¸€æ ·ï¼Œ Number() æ–¹æ³•å¯ä»¥ç”¨æ¥æ˜¾å¼å°†å€¼è½¬æ¢æˆ number ç±»åž‹ã€‚number çš„éšå¼ç±»åž‹è½¬æ¢æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨ä¸‹é¢å¤šç§æƒ…å†µä¸‹è¢«è§¦å‘ã€‚ æ¯”è¾ƒæ“ä½œï¼ˆ&gt;, &lt;, &lt;=, &gt;=ï¼‰ æŒ‰ä½æ“ä½œï¼ˆ| &amp; ^ ~ï¼‰ ç®—æ•°æ“ä½œï¼ˆ- + * / %ï¼‰ï¼Œ æ³¨æ„ï¼Œå½“ + æ“ä½œå­˜åœ¨ä»»æ„çš„æ“ä½œæ•°æ˜¯ string ç±»åž‹æ—¶ï¼Œä¸ä¼šè§¦å‘ number ç±»åž‹çš„éšå¼è½¬æ¢ ä¸€ å…ƒ + æ“ä½œ éžä¸¥æ ¼ç›¸ç­‰æ“ä½œï¼ˆ== æˆ–è€… != ï¼‰ï¼Œæ³¨æ„ï¼Œ== æ“ä½œä¸¤ä¸ªæ“ä½œæ•°éƒ½æ˜¯ string ç±»åž‹æ—¶ï¼Œä¸ä¼šå‘ç”Ÿ number ç±»åž‹çš„éšå¼è½¬æ¢ 123456Number('123') // æ˜¾ç¤ºç±»åž‹è½¬æ¢+ '123' // éšå¼ç±»åž‹è½¬æ¢123 != "456" // éšå¼ç±»åž‹è½¬æ¢4 &gt; "5" // éšå¼ç±»åž‹è½¬æ¢5 / null // éšå¼ç±»åž‹è½¬æ¢true | 0 // éšå¼ç±»åž‹è½¬æ¢ æŽ¥ä¸‹æ¥çœ‹ä¸€ä¸‹åŽŸå§‹ç±»åž‹æ˜¾ç¤ºè½¬æ¢ number ç±»åž‹ä¼šå‘ç”Ÿä»€ä¹ˆ 123456789Number(null) // 0Number(undefined) // NaNNumber(true) // 1Number(false) // 0Number(" 12 ") // 12Number("-12.34") // -12.34Number("\n") // 0Number(" 12s ") // NaNNumber(123) // 123 å½“å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—æ—¶ï¼Œå¼•æ“Žé¦–å…ˆåˆ é™¤å‰å°¾ç©ºæ ¼ã€\nã€\t å­—ç¬¦ï¼Œå¦‚æžœè¢«ä¿®å‰ªçš„å­—ç¬¦ä¸²ä¸æˆä¸ºä¸€ä¸ªæœ‰æ•ˆçš„æ•°å­—ï¼Œåˆ™è¿”å›ž NaNã€‚å¦‚æžœå­—ç¬¦ä¸²ä¸ºç©ºï¼Œåˆ™è¿”å›ž 0ã€‚ Number() æ–¹æ³•å¯¹äºŽ null å’Œ undefined çš„å¤„ç†æ˜¯ä¸åŒçš„ï¼Œ null ä¼šè½¬æ¢ä¸º 0, undefined ä¼šè½¬æ¢ä¸º NaN ä¸ç®¡æ˜¯æ˜¾å¼è¿˜æ˜¯éšå¼è½¬æ¢éƒ½ä¸èƒ½å°† Symbol ç±»åž‹è½¬ä¸º number ç±»åž‹ï¼Œå½“è¯•å›¾è¿™æ ·æ“ä½œæ—¶ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚ 12Number(Symbol('my symbol')) // TypeError is thrown+Symbol('123') // TypeError is thrown è¿™é‡Œæœ‰ 2 ä¸ªç‰¹æ®Šçš„è§„åˆ™éœ€è¦è®°ä½ï¼š å½“å°† == åº”ç”¨äºŽ null æˆ– undefined æ—¶ï¼Œä¸ä¼šå‘ç”Ÿæ•°å€¼è½¬æ¢ã€‚null åªç­‰äºŽ null æˆ– undefinedï¼Œä¸ç­‰äºŽå…¶ä»–ä»»ä½•å€¼ã€‚ 12345null == 0 // false, null is not converted to 0null == null // trueundefined == undefined // truenull == undefined // trueundefined == 0 // false NaN ä¸ç­‰äºŽä»»ä½•å€¼ï¼ŒåŒ…æ‹¬å®ƒè‡ªå·± 123NaN === NaN // falseif(value !== value) &#123; console.log('the value is NaN') &#125; object ç±»åž‹è½¬æ¢åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»æ·±å…¥äº†è§£äº†åŽŸå§‹ç±»åž‹çš„è½¬æ¢ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ object ç±»åž‹çš„è½¬æ¢ã€‚ å½“æ¶‰åŠåˆ°å¯¹è±¡çš„æ“ä½œæ¯”å¦‚ï¼š[1] + [2,3]ï¼Œå¼•æ“Žé¦–å…ˆä¼šå°è¯•å°† object ç±»åž‹è½¬ä¸ºåŽŸå§‹ç±»åž‹ï¼Œç„¶åŽåœ¨å°†åŽŸå§‹ç±»åž‹è½¬ä¸ºæœ€ç»ˆéœ€è¦çš„ç±»åž‹ï¼Œè€Œä¸”ä»ç„¶åªæœ‰ 3 ç§ç±»åž‹çš„è½¬æ¢ï¼šnumber, string, boolean æœ€ç®€å•çš„æƒ…å†µæ˜¯ boolean ç±»åž‹çš„è½¬æ¢ï¼Œä»»ä½•éžåŽŸå§‹ç±»åž‹æ€»æ˜¯ä¼šè½¬æ¢æˆ true,æ— è®ºå¯¹è±¡æˆ–æ•°ç»„æ˜¯å¦ä¸ºç©ºã€‚ å¯¹è±¡é€šè¿‡å†…éƒ¨ [[ToPrimitive]] æ–¹æ³•è½¬æ¢ä¸ºåŽŸå§‹ç±»åž‹ï¼Œè¯¥æ–¹æ³•è´Ÿè´£æ•°å­—å’Œå­—ç¬¦ä¸²è½¬æ¢ã€‚ [[ToPrimitive]] æ–¹æ³•æŽ¥å—ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªè¾“å…¥å€¼å’Œä¸€ä¸ªéœ€è¦è½¬æ¢çš„ç±»åž‹ï¼ˆNumer or Stringï¼‰number å’Œ stringçš„è½¬æ¢éƒ½ä½¿ç”¨äº†å¯¹è±¡çš„ä¸¤ä¸ªæ–¹æ³•ï¼š valueOf å’Œ toStringã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½åœ¨ Object.prototype ä¸Šè¢«å£°æ˜Žï¼Œå› æ­¤å¯ç”¨äºŽä»»ä½•æ´¾ç”Ÿç±»ï¼Œæ¯”å¦‚ Date, Arrayç­‰ã€‚ é€šå¸¸ä¸Š [[ToPrimitive]] ç®—æ³•å¦‚ä¸‹ï¼š å¦‚æžœè¾“å…¥çš„å€¼å·²ç»æ˜¯åŽŸå§‹ç±»åž‹ï¼Œç›´æŽ¥è¿”å›žè¿™ä¸ªå€¼ã€‚ è¾“å…¥çš„å€¼è°ƒç”¨ toString() æ–¹æ³•ï¼Œå¦‚æžœç»“æžœæ˜¯åŽŸå§‹ç±»åž‹ï¼Œåˆ™è¿”å›žã€‚ è¾“å…¥çš„å€¼è°ƒç”¨ valueOf() æ–¹æ³•ï¼Œå¦‚æžœç»“æžœæ˜¯åŽŸå§‹ç±»åž‹ï¼Œåˆ™è¿”å›žã€‚ å¦‚æžœä¸Šé¢ 3 ä¸ªæ­¥éª¤ä¹‹åŽï¼Œè½¬æ¢åŽçš„å€¼ä»ç„¶ä¸æ˜¯åŽŸå§‹ç±»åž‹ï¼Œåˆ™æŠ›å‡º TypeError é”™è¯¯ã€‚ number ç±»åž‹çš„è½¬æ¢é¦–å…ˆä¼šè°ƒç”¨ valueOf() æ–¹æ³•ï¼Œå¦‚æžœä¸æ˜¯åŽŸå§‹å€¼åœ¨è°ƒç”¨ toString() æ–¹æ³•ã€‚ string ç±»åž‹çš„è½¬æ¢åˆ™ç›¸åã€‚ å¤§å¤šæ•° JS å†…ç½®å¯¹è±¡ç±»åž‹çš„ valueOf() è¿”å›žè¿™ä¸ªå¯¹è±¡æœ¬èº«ï¼Œå…¶ç»“æžœç»å¸¸è¢«å¿½ç•¥ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªåŽŸå§‹ç±»åž‹ã€‚æ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹å½“ object éœ€è¦è½¬æ¢æˆ number æˆ– string ç±»åž‹æ—¶æœ€ç»ˆéƒ½è°ƒç”¨äº† toString() æ–¹æ³•ã€‚ å½“è¿ç®—ç¬¦ä¸åŒæ—¶ï¼Œ[[ToPrimitive]] æ–¹æ³•æŽ¥å—çš„è½¬æ¢ç±»åž‹å‚æ•°ä¹Ÿä¸ç›¸åŒã€‚å½“å­˜åœ¨ == æˆ–è€… + è¿ç®—ç¬¦æ—¶ä¸€èˆ¬ä¼šå…ˆè§¦å‘ number ç±»åž‹çš„è½¬æ¢å†è§¦å‘ string ç±»åž‹è½¬æ¢ã€‚ åœ¨ JS ä¸­ä½ å¯ä»¥é€šè¿‡é‡å†™å¯¹è±¡çš„ toString å’Œ valueOf æ–¹æ³•æ¥ä¿®æ”¹å¯¹è±¡åˆ°åŽŸå§‹ç±»åž‹è½¬æ¢çš„é€»è¾‘ã€‚ ç­”æ¡ˆè§£æž12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758true + false // 1 // '+' è¿ç®—ç¬¦ä¼šè§¦å‘ number ç±»åž‹è½¬æ¢å¯¹äºŽ true å’Œ false12 / "6" // 2 //ç®—æ•°è¿ç®—ç¬¦ä¼šæŠŠå­—ç¬¦ä¸² â€˜6â€™ è½¬ä¸º number ç±»åž‹"number" + 15 + 3 // 'number153'// '+' è¿ç®—ç¬¦æŒ‰ä»Žå·¦åˆ°å³çš„é¡ºåºçš„æ‰§è¡Œï¼Œæ‰€ä»¥ä¼˜å…ˆæ‰§è¡Œ â€œnumberâ€ + 15, æŠŠ 15 è½¬ä¸º string ç±»åž‹ï¼Œå¾—åˆ° â€œnumber15â€ ç„¶åŽåŒç†æ‰§è¡Œ â€œnumber15â€ + 315 + 3 + "number" // "18number"// 15 + 3 å…ˆæ‰§è¡Œï¼Œè¿ç®—ç¬¦ä¸¤è¾¹éƒ½æ˜¯ number ç±»åž‹ ï¼Œä¸ç”¨è½¬æ¢ï¼Œç„¶åŽæ‰§è¡Œ 18 + â€œnumberâ€ æœ€ç»ˆå¾—åˆ° â€œ18numberâ€[1] &gt; null // true// ==&gt; '1' &gt; 0// ==&gt; 1 &gt; 0// ==&gt; true// æ¯”è¾ƒè¿ç®—ç¬¦ &gt; æ‰§è¡Œ number ç±»åž‹éšå¼è½¬æ¢ã€‚"foo" + + "bar" // "fooNaN"// ==&gt; "foo" + (+"bar")// ==&gt; "foo" + NaN// ==&gt; "fooNaN"// ä¸€å…ƒ + è¿ç®—ç¬¦æ¯”äºŒå…ƒ + è¿ç®—ç¬¦å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚æ‰€ä»¥ + barè¡¨è¾¾å¼å…ˆæ±‚å€¼ã€‚ä¸€å…ƒåŠ å·æ‰§è¡Œå­—ç¬¦ä¸²â€œbarâ€ çš„ number ç±»åž‹è½¬æ¢ã€‚å› ä¸ºå­—ç¬¦ä¸²ä¸ä»£è¡¨ä¸€ä¸ªæœ‰æ•ˆçš„æ•°å­—ï¼Œæ‰€ä»¥ç»“æžœæ˜¯NaNã€‚åœ¨ç¬¬äºŒæ­¥ä¸­ï¼Œè®¡ç®—è¡¨è¾¾å¼'foo' + NaNã€‚"true" == true // falsefalse == "false" // false// == è¿ç®—ç¬¦æ‰§è¡Œ number ç±»åž‹è½¬æ¢ï¼Œ'true' è½¬æ¢ä¸º NaNï¼Œ boolean ç±»åž‹ true è½¬æ¢ä¸º 1null == "" // false// null ä¸ç­‰äºŽä»»ä½•å€¼é™¤äº† null å’Œ undefined!!"false" == !!"true" // true// !! è¿ç®—ç¬¦å°†å­—ç¬¦ä¸² 'true' å’Œ 'false' è½¬ä¸º boolean ç±»åž‹ true, å› ä¸ºä¸æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œç„¶åŽä¸¤è¾¹éƒ½æ˜¯ boolean åž‹ä¸åœ¨æ‰§è¡Œéšå¼è½¬æ¢æ“ä½œã€‚["x"] == "x" // true// == è¿ç®—ç¬¦å¯¹æ•°ç»„ç±»åž‹æ‰§è¡Œ number è½¬æ¢ï¼Œå…ˆè°ƒç”¨å¯¹è±¡çš„ valueOf() æ–¹æ³•ï¼Œç»“æžœæ˜¯æ•°ç»„æœ¬èº«ï¼Œä¸æ˜¯åŽŸå§‹ç±»åž‹å€¼ï¼Œæ‰€ä»¥æ‰§è¡Œå¯¹è±¡çš„ toString() æ–¹æ³•ï¼Œå¾—åˆ°å­—ç¬¦ä¸² 'x'[] + null + 1 // 'null1'// '+' è¿ç®—ç¬¦æ‰§è¡Œ number ç±»åž‹è½¬æ¢ï¼Œå…ˆè°ƒç”¨å¯¹è±¡çš„ valueOf() æ–¹æ³•ï¼Œç»“æžœæ˜¯æ•°ç»„æœ¬èº«ï¼Œä¸æ˜¯åŽŸå§‹ç±»åž‹å€¼ï¼Œæ‰€ä»¥æ‰§è¡Œå¯¹è±¡çš„ toString() æ–¹æ³•ï¼Œå¾—åˆ°å­—ç¬¦ä¸² ''ï¼Œ æŽ¥ä¸‹æ¥æ‰§è¡Œè¡¨è¾¾å¼ '' + null + 1ã€‚[1,2,3] == [1,2,3] // false// å½“è¿ç®—ç¬¦ä¸¤è¾¹ç±»åž‹ç›¸åŒæ—¶ï¼Œä¸ä¼šæ‰§è¡Œç±»åž‹è½¬æ¢ï¼Œä¸¤ä¸ªæ•°ç»„çš„å†…å­˜åœ°å€ä¸ä¸€æ ·ï¼Œæ‰€ä»¥è¿”å›ž false0 || "0" &amp;&amp; &#123;&#125; // &#123;&#125;// é€»è¾‘è¿ç®—ç¬¦ || å’Œ &amp;&amp; å°†å€¼è½¬ä¸º boolean åž‹ï¼Œä½†æ˜¯ä¼šè¿”å›žåŽŸå§‹å€¼ï¼ˆä¸æ˜¯ booleanï¼‰ã€‚&#123;&#125; + [] + &#123;&#125; + [1] // '0[object Object]1'// æ‰€æœ‰çš„æ“ä½œæ•°éƒ½ä¸æ˜¯åŽŸå§‹ç±»åž‹ï¼Œæ‰€ä»¥ä¼šæŒ‰ç…§ä»Žå·¦åˆ°å³çš„é¡ºåºæ‰§è¡Œ number ç±»åž‹çš„éšå¼è½¬æ¢ï¼Œ object å’Œ array ç±»åž‹çš„ valueOf() æ–¹æ³•è¿”å›žå®ƒä»¬æœ¬èº«ï¼Œæ‰€ä»¥ç›´æŽ¥å¿½ç•¥ï¼Œæ‰§è¡Œ toString() æ–¹æ³•ã€‚ è¿™é‡Œçš„æŠ€å·§æ˜¯ï¼Œç¬¬ä¸€ä¸ª &#123;&#125; ä¸è¢«è§†ä¸º objectï¼Œè€Œæ˜¯å—å£°æ˜Žè¯­å¥ï¼Œå› æ­¤å®ƒè¢«å¿½ç•¥ã€‚è®¡ç®—ä»Ž +[] è¡¨è¾¾å¼å¼€å§‹ï¼Œè¯¥è¡¨è¾¾å¼é€šè¿‡toString()æ–¹æ³•è½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œç„¶åŽè½¬æ¢ä¸º0ã€‚! + [] + [] + ![] // 'truefalse'// ä¸€å…ƒè¿ç®—ç¬¦ä¼˜å…ˆæ‰§è¡Œï¼Œ+[] è½¬ä¸º number ç±»åž‹ 0ï¼Œ![] è½¬ä¸º boolean åž‹ falseã€‚new Date(0) - 0 // 0// '-' è¿ç®—ç¬¦æ‰§è¡Œ number ç±»åž‹éšå¼è½¬æ¢å¯¹äºŽ Date åž‹çš„å€¼ï¼ŒDate.valueOf() è¿”å›žåˆ°æ¯«ç§’çš„æ—¶é—´æˆ³ã€‚new Date(0) + 0 //"Thu Jan 01 1970 08:00:00 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)0"// +' è¿ç®—ç¬¦è§¦å‘é»˜è®¤è½¬æ¢ï¼Œå› æ­¤ä½¿ç”¨ toString() æ–¹æ³•ï¼Œè€Œä¸æ˜¯ valueOf()ã€‚]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptå¼‚æ­¥ç¼–ç¨‹å›žè°ƒåœ°ç‹±çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ]]></title>
    <url>%2F2019%2F08%2F01%2FJs%2FJavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1%E7%9A%84%E4%B8%80%E4%BA%9B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ å¼‚æ­¥ç¼–ç¨‹åœ¨JavaScriptä¸­éžå¸¸é‡è¦ã€‚è¿‡å¤šçš„å¼‚æ­¥ç¼–ç¨‹ä¹Ÿå¸¦äº†å›žè°ƒåµŒå¥—çš„é—®é¢˜ï¼Œæœ¬æ–‡ä¼šæä¾›ä¸€äº›è§£å†³â€œå›žè°ƒåœ°ç‹±â€çš„æ–¹æ³•ã€‚ 123456setTimeout(function()&#123; console.log("å»¶æ—¶è§¦å‘")&#125;,2000)fs.readFile('./samp.txt','utf-8',function(res,error)&#123; console.log(res);&#125;) ä¸Šé¢å°±æ˜¯å…¸åž‹çš„å›žè°ƒå‡½æ•°ï¼Œä¸è®ºæ˜¯åœ¨æµè§ˆå™¨ä¸­ï¼Œè¿˜æ˜¯åœ¨nodeä¸­ï¼ŒJavaScriptæœ¬èº«æ˜¯å•çº¿ç¨‹ï¼Œå› æ­¤ï¼Œä¸ºäº†åº”å¯¹ä¸€äº›å•çº¿ç¨‹å¸¦æ¥çš„é—®é¢˜ï¼Œå¼‚æ­¥ç¼–ç¨‹æˆä¸ºäº†JavaScriptä¸­éžå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚ ä¸è®ºæ˜¯æµè§ˆå™¨ä¸­æœ€ä¸ºå¸¸è§çš„ajaxã€äº‹ä»¶ç›‘å¬ï¼Œè¿˜æ˜¯nodeä¸­æ–‡ä»¶è¯»å–ã€ç½‘ç»œç¼–ç¨‹ã€æ•°æ®åº“ç­‰æ“ä½œï¼Œéƒ½ç¦»ä¸å¼€å¼‚æ­¥ç¼–ç¨‹ã€‚åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œè®¸å¤šæ“ä½œéƒ½ä¼šæ”¾åœ¨å›žè°ƒå‡½æ•°ï¼ˆcallbackï¼‰ä¸­ã€‚åŒæ­¥ä¸Žå¼‚æ­¥çš„æ··æ‚ã€è¿‡å¤šçš„å›žè°ƒåµŒå¥—éƒ½ä¼šä½¿å¾—ä»£ç å˜å¾—éš¾ä»¥ç†è§£ä¸Žç»´æŠ¤ï¼Œè¿™ä¹Ÿæ˜¯å¸¸å—äººè¯Ÿç—…çš„åœ°æ–¹ã€‚ å…ˆçœ‹ä¸‹é¢è¿™æ®µä»£ç  12345678fs.readFile('./sample.txt', 'utf-8', (err, content) =&gt; &#123; let keyword = content.substring(0, 5); db.find(`select * from sample where kw = $&#123;keyword&#125;`, (err, res) =&gt; &#123; get(`/sampleget?count=$&#123;res.length&#125;`, data =&gt; &#123; console.log(data); &#125;); &#125;);&#125;); é¦–å…ˆæˆ‘ä»¬è¯»å–çš„ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å…³é”®å­—keywordï¼Œç„¶åŽæ ¹æ®è¯¥keywordè¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ï¼Œæœ€åŽä¾æ®æŸ¥è¯¢ç»“æžœè¯·æ±‚æ•°æ®ã€‚ æ–‡ä»¶è¯»å–ï¼šfs.readFile æ•°æ®åº“æŸ¥è¯¢ï¼šdb.find httpè¯·æ±‚ï¼šget å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ²¡å¢žåŠ ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚ï¼Œå°±ä¼šå¤šæ·»åŠ ä¸€å±‚å›žè°ƒå‡½æ•°çš„åµŒå¥—ï¼Œè¿™æ®µä»£ç ä¸­ä¸‰ä¸ªå¼‚æ­¥å‡½æ•°çš„åµŒå¥—å·²ç»å¼€å§‹ä½¿ä¸€æ®µæœ¬å¯ä»¥è¯­è¨€æ˜Žç¡®çš„ä»£ç ç¼–ç¨‹ä¸æ˜“é˜…è¯»ä¸Žç»´æŠ¤äº†ã€‚ æŠ½è±¡å‡ºæ¥è¿™ç§ä»£ç ä¼šå˜æˆä¸‹é¢è¿™æ ·ï¼š 123456789asyncFunc1(opt, (...args1) =&gt; &#123; asyncFunc2(opt, (...args2) =&gt; &#123; asyncFunc3(opt, (...args3) =&gt; &#123; asyncFunc4(opt, (...args4) =&gt; &#123; // some operation &#125;); &#125;); &#125;);&#125;); å·¦ä¾§æ˜Žæ˜¾å‡ºçŽ°äº†ä¸€ä¸ªä¸‰è§’å½¢çš„ç¼©è¿›åŒºåŸŸï¼Œè¿‡å¤šçš„å›žè°ƒä¹Ÿå°±è®©æˆ‘ä»¬é™·å…¥â€œå›žè°ƒåœ°ç‹±â€ã€‚æŽ¥ä¸‹æ¥ä¼šä»‹ç»ä¸€äº›æ–¹æ³•æ¥è§„é¿å›žè°ƒåœ°ç‹±ã€‚ ä¸€ã€æ‹†è§£functionå›žè°ƒåµŒå¥—æ‰€å¸¦æ¥çš„ä¸€ä¸ªé‡è¦é—®é¢˜å°±æ˜¯ä»£ç ä¸æ˜“é˜…è¯»ä¸Žç»´æŠ¤ã€‚å› ä¸ºæ™®éæ¥è¯´ï¼Œè¿‡å¤šçš„ç¼©è¿›ï¼ˆåµŒå¥—ï¼‰ä¼šæžå¤§çš„å½±å“ä»£ç çš„å¯è¯»æ€§ã€‚åŸºäºŽè¿™ä¸€ç‚¹ï¼Œå¯ä»¥è¿›è¡Œä¸€ä¸ªæœ€ç®€å•çš„ä¼˜åŒ–â€”â€”å°†å„æ­¥æ‹†è§£ä¸ºå•ä¸ªçš„function 1234567891011121314151617181920function getData(count) &#123; get(`/sampleget?count=$&#123;count&#125;`, data =&gt; &#123; console.log(data); &#125;);&#125;function queryDB(kw) &#123; db.find(`select * from sample where kw = $&#123;kw&#125;`, (err, res) =&gt; &#123; getData(res.length); &#125;);&#125;function readFile(filepath) &#123; fs.readFile(filepath, 'utf-8', (err, content) =&gt; &#123; let keyword = content.substring(0, 5); queryDB(keyword); &#125;);&#125;readFile('./sample.txt'); å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä¸Šé¢çš„æ”¹å†™æ–¹å¼ï¼Œä»£ç æ¸…æ™°äº†è®¸å¤šã€‚è¯¥æ–¹æ³•éžå¸¸ç®€å•ï¼Œå…·æœ‰ä¸€å®šçš„æ•ˆæžœï¼Œä½†æ˜¯ç¼ºå°‘é€šç”¨æ€§ã€‚ äºŒã€äº‹ä»¶å‘å¸ƒ/ç›‘å¬æ¨¡å¼å¦‚æžœåœ¨æµè§ˆå™¨ä¸­å†™è¿‡äº‹ä»¶ç›‘å¬addEventListenerï¼Œé‚£ä¹ˆä½ å¯¹è¿™ç§äº‹ä»¶å‘å¸ƒ/ç›‘å¬çš„æ¨¡å¼ä¸€å®šä¸é™Œç”Ÿã€‚ å€Ÿé‰´è¿™ç§æ€æƒ³ï¼Œä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥ç›‘å¬æŸä¸€äº‹ä»¶ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè¿›è¡Œç›¸åº”å›žè°ƒæ“ä½œï¼›å¦ä¸€æ–¹é¢ï¼Œå½“æŸäº›æ“ä½œå®ŒæˆåŽï¼Œé€šè¿‡å‘å¸ƒäº‹ä»¶è§¦å‘å›žè°ƒã€‚è¿™æ ·å°±å¯ä»¥å°†åŽŸæœ¬æ†ç»‘åœ¨ä¸€èµ·çš„ä»£ç è§£è€¦ã€‚12345678910111213141516171819const events = require('events');const eventEmitter = new events.EventEmitter();eventEmitter.on('db', (err, kw) =&gt; &#123; db.find(`select * from sample where kw = $&#123;kw&#125;`, (err, res) =&gt; &#123; eventEmitter('get', res.length); &#125;);&#125;);eventEmitter.on('get', (err, count) =&gt; &#123; get(`/sampleget?count=$&#123;count&#125;`, data =&gt; &#123; console.log(data); &#125;);&#125;);fs.readFile('./sample.txt', 'utf-8', (err, content) =&gt; &#123; let keyword = content.substring(0, 5); eventEmitter. emit('db', keyword);&#125;); ä½¿ç”¨è¿™ç§æ¨¡å¼çš„å®žçŽ°éœ€è¦ä¸€ä¸ªäº‹ä»¶å‘å¸ƒ/ç›‘å¬çš„åº“ã€‚ä¸Šé¢ä»£ç ä¸­ä½¿ç”¨nodeåŽŸç”Ÿçš„eventsæ¨¡å—ï¼Œå½“ç„¶ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ å–œæ¬¢çš„åº“ã€‚ ä¸‰ã€PromisePromiseæ˜¯ä¸€ç§å¼‚æ­¥è§£å†³æ–¹æ¡ˆï¼Œæœ€æ—©ç”±ç¤¾åŒºæå‡ºå¹¶å®žçŽ°ï¼ŒåŽæ¥å†™è¿›äº†es6è§„èŒƒã€‚ ç›®å‰ä¸€äº›ä¸»æµçš„æµè§ˆå™¨å·²ç»åŽŸç”Ÿå®žçŽ°äº†Promiseçš„APIï¼Œå¯ä»¥åœ¨Can I useé‡ŒæŸ¥çœ‹æµè§ˆå™¨çš„æ”¯æŒæƒ…å†µã€‚å½“ç„¶ï¼Œå¦‚æžœæƒ³è¦åšæµè§ˆå™¨çš„å…¼å®¹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€äº›Promiseçš„å®žçŽ°åº“ï¼Œä¾‹å¦‚bluebirdã€ Qç­‰ã€‚ä¸‹é¢ä»¥bluebirdä¸ºä¾‹ï¼š é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†å¼‚æ­¥æ–¹æ³•æ”¹å†™ä¸ºPromiseï¼Œå¯¹äºŽç¬¦åˆnodeè§„èŒƒçš„å›žè°ƒå‡½æ•°ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯Errorï¼‰ï¼Œå¯ä»¥ä½¿ç”¨bluebirdçš„promisifyæ–¹æ³•ã€‚è¯¥æ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªæ ‡å‡†çš„å¼‚æ­¥æ–¹æ³•å¹¶è¿”å›žä¸€ä¸ªPromiseå¯¹è±¡ã€‚ 123const bluebird = require('bluebird');const fs = require("fs");const readFile = bluebird.promisify(fs.readFile); è¿™æ ·ï¼ŒreadFileå°±å˜æˆäº†ä¸€ä¸ªPromiseå¯¹è±¡ã€‚ ä½†æ˜¯ï¼Œæœ‰çš„å¼‚æ­¥æ–¹æ³•æ— æ³•è¿›è¡Œè½¬æ¢ï¼Œæˆ–è€…æˆ‘ä»¬éœ€è¦ä½¿ç”¨åŽŸç”ŸPromiseï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è¿›è¡Œä¸€äº›æ”¹é€ ã€‚ä¸‹é¢æä¾›ä¸€ç§æ”¹é€ çš„æ–¹æ³•ã€‚ ä»¥fs.readFileä¸ºä¾‹ï¼Œå€ŸåŠ©åŽŸç”ŸPromiseæ¥æ”¹é€ è¯¥æ–¹æ³•ï¼š 12345678910111213141516171819202122const readFile = function (filepath) &#123; let resolve, reject; let promise = new Promise((_resolve, _reject) =&gt; &#123; resolve = _resolve; reject = _reject; &#125;); let deferred = &#123; resolve, reject, promise &#125;; fs.readFile(filepath, 'utf-8', function (err, ...args) &#123; if (err) &#123; deferred.reject(err); &#125; else &#123; deferred.resolve(...args); &#125; &#125;); return deferred.promise;&#125; æˆ‘ä»¬åœ¨æ–¹æ³•ä¸­åˆ›å»ºäº†ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå¹¶åœ¨å¼‚æ­¥å›žè°ƒä¸­æ ¹æ®ä¸åŒçš„æƒ…å†µä½¿ç”¨rejectä¸Žresolveæ¥æ”¹å˜Promiseå¯¹è±¡çš„çŠ¶æ€ã€‚è¯¥æ–¹æ³•è¿”å›žè¿™ä¸ªPromiseå¯¹è±¡ã€‚å…¶ä»–çš„ä¸€äº›å¼‚æ­¥æ–¹æ³•ä¹Ÿå¯ä»¥å‚ç…§è¿™ç§æ–¹å¼è¿›è¡Œæ”¹é€ ã€‚ å‡è®¾é€šè¿‡æ”¹é€ ï¼ŒreadFileã€queryDBä¸ŽgetDataæ–¹æ³•å‡ä¼šè¿”å›žä¸€ä¸ªPromiseå¯¹è±¡ã€‚ä»£ç å°±å˜ä¸ºäº†: 12345678910readFile('./sample.txt').then(content =&gt; &#123; let keyword = content.substring(0, 5); return queryDB(keyword);&#125;).then(res =&gt; &#123; return getData(res.length);&#125;).then(data =&gt; &#123; console.log(data);&#125;).catch(err =&gt; &#123; console.warn(err);&#125;); å¯ä»¥çœ‹åˆ°ï¼Œä¹‹å‰çš„åµŒå¥—æ“ä½œç¼–ç¨‹äº†é€šè¿‡thenè¿žæŽ¥çš„é“¾å¼æ“ä½œã€‚ä»£ç çš„æ•´æ´åº¦ä¸Šæœ‰äº†ä¸€ä¸ªè¾ƒå¤§çš„æé«˜ã€‚ å››ã€generatorgeneratoræ˜¯es6ä¸­çš„ä¸€ä¸ªæ–°çš„è¯­æ³•ã€‚åœ¨functionå…³é”®å­—åŽæ·»åŠ *å³å¯å°†å‡½æ•°å˜ä¸ºgeneratorã€‚ 12345const gen = function* () &#123; yield 1; yield 2; return 3;&#125; æ‰§è¡Œgeneratorå°†ä¼šè¿”å›žä¸€ä¸ªéåŽ†å™¨å¯¹è±¡ï¼Œç”¨äºŽéåŽ†generatorå†…éƒ¨çš„çŠ¶æ€ 12345let g = gen();g.next(); // &#123; value: 1, done: false &#125;g.next(); // &#123; value: 2, done: false &#125;g.next(); // &#123; value: 3, done: true &#125;g.next(); // &#123; value: undefined, done: true &#125; å¯ä»¥çœ‹åˆ°ï¼Œgeneratorå‡½æ•°æœ‰ä¸€ä¸ªæœ€å¤§çš„ç‰¹ç‚¹ï¼Œå¯ä»¥åœ¨å†…éƒ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­äº¤å‡ºç¨‹åºçš„æŽ§åˆ¶æƒï¼Œyieldç›¸å½“äºŽèµ·åˆ°äº†ä¸€ä¸ªæš‚åœçš„ä½œç”¨ï¼›è€Œå½“ä¸€å®šæƒ…å†µä¸‹ï¼Œå¤–éƒ¨åˆå°†æŽ§åˆ¶æƒå†ç§»äº¤å›žæ¥ã€‚ æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç”¨generatoræ¥å°è£…ä»£ç ï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡å¤„ä½¿ç”¨yieldå…³é”®è¯ï¼Œæ­¤æ—¶generatorä¼šå°†ç¨‹åºæ‰§è¡Œæƒäº¤ç»™å…¶ä»–ä»£ç ï¼Œè€Œåœ¨å¼‚æ­¥ä»»åŠ¡å®ŒæˆåŽï¼Œè°ƒç”¨nextæ–¹æ³•æ¥æ¢å¤yieldä¸‹æ–¹ä»£ç çš„æ‰§è¡Œã€‚ä»¥readFileä¸ºä¾‹ï¼Œå¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š 12345678910111213// æˆ‘ä»¬çš„ä¸»ä»»åŠ¡â€”â€”æ˜¾ç¤ºå…³é”®å­—// ä½¿ç”¨yieldæš‚æ—¶ä¸­æ–­ä¸‹æ–¹ä»£ç æ‰§è¡Œ// yieldåŽé¢ä¸ºpromiseå¯¹è±¡const showKeyword = function* (filepath) &#123; console.log('å¼€å§‹è¯»å–'); let keyword = yield readFile(filepath); console.log(`å…³é”®å­—ä¸º$&#123;filepath&#125;`);&#125;// generatorçš„æµç¨‹æŽ§åˆ¶let gen = showKeyword();let res = gen.next();res.value.then(res =&gt; gen.next(res)); åœ¨ä¸»ä»»åŠ¡éƒ¨åˆ†ï¼ŒåŽŸæœ¬readFileå¼‚æ­¥çš„éƒ¨åˆ†å˜æˆäº†ç±»ä¼¼åŒæ­¥çš„å†™æ³•ï¼Œä»£ç å˜å¾—éžå¸¸æ¸…æ™°ã€‚è€Œåœ¨ä¸‹åŠéƒ¨åˆ†ï¼Œåˆ™æ˜¯å¯¹äºŽä»€ä¹ˆæ—¶å€™éœ€è¦ç§»äº¤å›žæŽ§åˆ¶æƒç»™generatorçš„æµç¨‹æŽ§åˆ¶ã€‚ ç„¶è€Œï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æŽ§åˆ¶generatorçš„æµç¨‹ï¼Œå¦‚æžœèƒ½å¤Ÿè‡ªåŠ¨æ‰§è¡Œgeneratorâ€”â€”åœ¨éœ€è¦çš„æ—¶å€™è‡ªåŠ¨ç§»äº¤æŽ§åˆ¶æƒï¼Œé‚£ä¹ˆä¼šæ›´åŠ å…·æœ‰å®žç”¨æ€§ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ co è¿™ä¸ªåº“ã€‚å®ƒå¯ä»¥æ˜¯çœåŽ»æˆ‘ä»¬å¯¹äºŽgeneratoræµç¨‹æŽ§åˆ¶çš„ä»£ç  123456789101112const co = reuqire('co');// æˆ‘ä»¬çš„ä¸»ä»»åŠ¡â€”â€”æ˜¾ç¤ºå…³é”®å­—// ä½¿ç”¨yieldæš‚æ—¶ä¸­æ–­ä¸‹æ–¹ä»£ç æ‰§è¡Œ// yieldåŽé¢ä¸ºpromiseå¯¹è±¡const showKeyword = function* (filepath) &#123; console.log('å¼€å§‹è¯»å–'); let keyword = yield readFile(filepath); console.log(`å…³é”®å­—ä¸º$&#123;filepath&#125;`);&#125;// ä½¿ç”¨coco(showKeyword); å…¶ä¸­ï¼Œyeildå…³é”®å­—åŽé¢éœ€è¦æ˜¯functio, promise, generator, arrayæˆ–objectã€‚å¯ä»¥æ”¹å†™æ–‡ç« ä¸€å¼€å§‹çš„ä¾‹å­ï¼š 12345678910const co = reuqire('co');const task = function* (filepath) &#123; let keyword = yield readFile(filepath); let count = yield queryDB(keyword); let data = yield getData(res.length); console.log(data);&#125;);co(task, './sample.txt'); äº”ã€async/await å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„æ–¹æ³•è™½ç„¶éƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†å¼‚æ­¥ç¼–ç¨‹ä¸­å›žè°ƒå¸¦æ¥çš„é—®é¢˜ã€‚ç„¶è€Œ functionæ‹†åˆ†çš„æ–¹å¼å…¶å®žä»…ä»…åªæ˜¯æ‹†åˆ†ä»£ç å—ï¼Œæ—¶å¸¸ä¼šä¸åˆ©äºŽåŽç»­ç»´æŠ¤ï¼› äº‹ä»¶å‘å¸ƒ/ç›‘å¬æ–¹å¼æ¨¡ç³Šäº†å¼‚æ­¥æ–¹æ³•ä¹‹é—´çš„æµç¨‹å…³ç³»ï¼› Promiseè™½ç„¶ä½¿å¾—å¤šä¸ªåµŒå¥—çš„å¼‚æ­¥è°ƒç”¨èƒ½å¤Ÿé€šè¿‡é“¾å¼çš„APIè¿›è¡Œæ“ä½œï¼Œä½†æ˜¯è¿‡å¤šçš„thenä¹Ÿå¢žåŠ äº†ä»£ç çš„å†—ä½™ï¼Œä¹Ÿå¯¹é˜…è¯»ä»£ç ä¸­å„é˜¶æ®µçš„å¼‚æ­¥ä»»åŠ¡äº§ç”Ÿäº†ä¸€å®šå¹²æ‰°ï¼› é€šè¿‡generatorè™½ç„¶èƒ½æä¾›è¾ƒå¥½çš„è¯­æ³•ç»“æž„ï¼Œä½†æ˜¯æ¯•ç«Ÿgeneratorä¸Žyieldçš„è¯­å¢ƒç”¨åœ¨è¿™é‡Œå¤šå°‘è¿˜æœ‰äº›ä¸å¤ªè´´åˆ‡ã€‚ å› æ­¤ï¼Œè¿™é‡Œå†ä»‹ç»ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå°±æ˜¯es7ä¸­çš„async/awaitã€‚ ç®€å•ä»‹ç»ä¸€ä¸‹async/awaitã€‚åŸºæœ¬ä¸Šï¼Œä»»ä½•ä¸€ä¸ªå‡½æ•°éƒ½å¯ä»¥æˆä¸ºasyncå‡½æ•°ï¼Œä»¥ä¸‹éƒ½æ˜¯åˆæ³•çš„ä¹¦å†™å½¢å¼ï¼š 123async function foo () &#123;&#125;;const foo = async function () &#123;&#125;;const foo = async () =&gt; &#123;&#125;; åœ¨asyncå‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨awaitè¯­å¥ã€‚awaitåŽä¸€èˆ¬æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ã€‚ 12345async function foo () &#123; console.log('å¼€å§‹'); let res = await post(data); console.log(`postå·²å®Œæˆï¼Œç»“æžœä¸ºï¼š$&#123;res&#125;`);&#125;; å½“ä¸Šé¢çš„å‡½æ•°æ‰§è¡Œåˆ°awaitæ—¶ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œå‡½æ•°æŒ‚èµ·ï¼Œç­‰å¾…awaitåŽçš„Promiseè¿”å›žï¼Œå†æ‰§è¡Œä¸‹é¢çš„è¯­å¥ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™æ®µå¼‚æ­¥æ“ä½œçš„ä»£ç ï¼Œçœ‹èµ·æ¥å°±åƒæ˜¯â€œåŒæ­¥æ“ä½œâ€ã€‚è¿™å°±å¤§å¤§æ–¹ä¾¿äº†å¼‚æ­¥ä»£ç çš„ç¼–å†™ä¸Žé˜…è¯»ã€‚ä¸‹é¢æ”¹å†™æˆ‘ä»¬çš„ä¾‹å­ã€‚ 12345678const printData = async function (filepath) &#123; let keyword = await readFile(filepath); let count = await queryDB(keyword); let data = await getData(res.length); console.log(data);&#125;);printData('./sample.txt'); å¯ä»¥çœ‹åˆ°ï¼Œä»£ç ç®€æ´æ¸…æ™°ï¼Œå¼‚æ­¥ä»£ç ä¹Ÿå…·æœ‰äº†â€œåŒæ­¥â€ä»£ç çš„ç»“æž„ã€‚ æ³¨æ„ï¼Œå…¶ä¸­readFileã€queryDBä¸ŽgetDataæ–¹æ³•éƒ½éœ€è¦è¿”å›žä¸€ä¸ªPromiseå¯¹è±¡ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨ç¬¬ä¸‰éƒ¨åˆ†Promiseé‡Œæä¾›çš„æ–¹å¼è¿›è¡Œæ”¹å†™ã€‚ åŽè®°å¼‚æ­¥ç¼–ç¨‹ä½œä¸ºJavaScriptä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå…·æœ‰éžå¸¸é‡è¦çš„ä½ç½®ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬é¿å…åŒæ­¥ä»£ç å¸¦æ¥çš„çº¿ç¨‹é˜»å¡žçš„åŒæ—¶ï¼Œä¹Ÿä¸ºç¼–ç ä¸Žé˜…è¯»å¸¦æ¥äº†ä¸€å®šçš„å›°éš¾ã€‚è¿‡å¤šçš„å›žè°ƒåµŒå¥—å¾ˆå®¹æ˜“ä¼šè®©æˆ‘ä»¬é™·å…¥â€œå›žè°ƒåœ°ç‹±â€ä¸­ï¼Œä½¿ä»£ç å˜æˆä¸€å›¢ä¹±éº»ã€‚ä¸ºäº†è§£å†³â€œå›žè°ƒåœ°ç‹±â€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–‡ä¸­æ‰€è¿°çš„è¿™äº”ç§å¸¸ç”¨æ–¹æ³•ï¼š functionæ‹†è§£ äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼ Promise Generator async / await ç†è§£å„ç±»æ–¹æ³•çš„åŽŸç†ä¸Žå®žçŽ°æ–¹å¼ï¼Œäº†è§£å…¶ä¸­åˆ©å¼Šï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½å¾—è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹ã€‚]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Webpack Freestyle ä¹‹ Long Term Cache(webpack å®žçŽ°æŒä¹…æ€§ç¼“å­˜)]]></title>
    <url>%2F2019%2F07%2F31%2FTools%2FWebpack-Freestyle-%E4%B9%8B-Long-Term-Cache-webpack-%E5%AE%9E%E7%8E%B0%E6%8C%81%E4%B9%85%E6%80%A7%E7%BC%93%E5%AD%98%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ How Browser Cache Worksé¦–å…ˆï¼Œæˆ‘ä»¬è¦æžæ¸…æ¥šæµè§ˆå™¨ç¼“å­˜æ˜¯æ€Žä¹ˆå·¥ä½œçš„ã€‚ é‚£ä¹ˆï¼Œå°±è®©æˆ‘ç”»ä¸€å¼ å›¾æ¥å‘Šè¯‰å¤§å®¶å§ï¼Œå˜»å˜»ã€‚ æµè§ˆå™¨: æˆ‘éœ€è¦ foo.js æœåŠ¡å™¨: è®©æˆ‘æ‰¾æ‰¾ã€‚æ‰¾åˆ°äº†ï¼Œç»™ä½ ï¼Œç¼“å­˜æœ‰æ•ˆæœŸä¸º 1 å¹´ã€‚ æµè§ˆå™¨: å¥½ï¼Œæˆ‘æŠŠä»–ç¼“å­˜åˆ°ç£ç›˜é‡Œã€‚ è¿‡äº† 2 å¤©ï¼Œ æµè§ˆå™¨: æˆ‘éœ€è¦ foo.js ï¼Œåœ¨ç¼“å­˜é‡Œæ‰¾åˆ°äº†ã€‚ç¼“å­˜è¿˜æœ‰æ•ˆï¼Œé‚£ç›´æŽ¥è¯»ç¼“å­˜ã€‚ç”¨æˆ·ï¼šå“‡å¡žï¼Œè¿™ç½‘é¡µç§’å¼€å•Šã€‚ åˆè¿‡äº† 2 å¤©ï¼Œfoo.js çš„ä»£ç æ›´æ–°äº†ã€‚ï¼ˆå†…å®¹ä»Ž Hello world å˜æˆäº† Goodbye world ï¼‰ æµè§ˆå™¨ï¼šæˆ‘éœ€è¦ foo.js ï¼Œåœ¨ç¼“å­˜é‡Œæ‰¾åˆ°äº†ã€‚ç¼“å­˜è¿˜æœ‰æ•ˆï¼Œé‚£ç›´æŽ¥è¯»ç¼“å­˜ã€‚äº§å“ç»ç†ï¼šï¼Ÿï¼Ÿï¼Ÿè¿™é¡µé¢æ€Žä¹ˆè·Ÿä»¥å‰ä¸€æ ·å•Šï¼Ÿ å¾ˆå°´å°¬ã€‚foo.js æ˜Žæ˜Žæ›´æ–°äº†ï¼Œä½†æ˜¯æµè§ˆå™¨è¿˜æ˜¯è¯»å–åœ¨ç¼“å­˜ä¸­æ—§çš„ foo.js ï¼ŒåŽŸå› æ˜¯æˆ‘ä»¬ç”¨äº†ç¼“å­˜ï¼Œä¸ç”¨ç¼“å­˜å°±æ²¡è¿™äº‹å„¿äº†ã€‚? è§£å†³åŠžæ³•å˜›ï¼Œå½“ç„¶æœ‰çš„ã€‚æ¯”å¦‚æ¯æ¬¡åˆ©ç”¨ç¼“å­˜ä¹‹å‰ï¼Œå…ˆå‘æœåŠ¡å™¨ç¡®è®¤æ–‡ä»¶æ˜¯å¦æœ‰æ›´æ–°ï¼Œæœ‰æ›´æ–°åˆ™ä½¿ç”¨æ–°çš„å¦åˆ™è¯»ç¼“å­˜ã€‚è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯æŠŠç¼“å­˜ç ´åæŽ‰ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¦è¯´çš„*Cache Busting Technique* Cache Busting Techniqueå› ä¸º foo.js çš„ä»£ç å˜åŒ–äº†ï¼Œä½†æ˜¯ä»–çš„ç¼“å­˜è¿˜æ²¡å¤±æ•ˆï¼Œæ­¤æ—¶æµè§ˆå™¨è¿˜æ˜¯ä¼šè¯»å–ä»¥å‰çš„ç¼“å­˜äº†çš„ foo.js ï¼Œå¹¶ä¸ä¼šåŽ»æœåŠ¡å™¨ä¸‹è½½æœ€æ–°çš„ã€‚è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæ€Žä¹ˆåŠžå‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦ç ´åç¼“å­˜ï¼ˆ Cache Busting ï¼‰ã€‚ ç ´åç¼“å­˜å¹¶ä¸æ˜¯ç¦æ­¢ç¼“å­˜ï¼Œè€Œæ˜¯æ¢ä¸€ç§æ–¹å¼è®©ç¼“å­˜å¤±æ•ˆã€‚æ¯”å¦‚ï¼š 1.ä¿®æ”¹æ–‡ä»¶çš„åå­—ï¼šfoo.js -&gt; foo.v2.js2.ä¿®æ”¹æ–‡ä»¶çš„è·¯å¾„ï¼š/static/foo.js -&gt; /static/v2/foo.js3.åŠ  query string : foo.js -&gt; foo.js?v=qwer æˆ‘ä»¬ä¸‹é¢å°†é‡‡ç”¨ç¬¬ä¸€ç§æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹æ–‡ä»¶çš„åå­—ã€‚æˆ‘ä»¬æŠŠæ›´æ–°åŽçš„ foo.js çš„æ–‡ä»¶åæ”¹æˆ foo.v2.js ã€‚è¿™æ ·ï¼Œæµè§ˆå™¨å°±ä¸ä¼šåŽ»è¯»å–ç¼“å­˜é‡Œçš„æ—§çš„ foo.js ï¼Œè€Œæ˜¯å‘æœåŠ¡è¯·è¯·æ±‚ foo.v2.js ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é‚£ä¹ˆï¼Œå‡è®¾æˆ‘ä»¬çŽ°åœ¨æœ‰å¾ˆå¤šå¾ˆå¤šçš„é™æ€æ–‡ä»¶ï¼Œç„¶åŽæ¯æ¬¡éœ€è¦æ›´æ–°å¾ˆå¤šå¾ˆå¤šçš„æ–‡ä»¶ï¼Œé‚£æ˜¯ä¸æ˜¯è¦æ‰‹åŠ¨åœ°ä¸€ä¸ªä¸€ä¸ªåœ°ä¿®æ”¹æ–‡ä»¶çš„åå­—å‘¢ï¼Ÿæˆ‘ä»¬çš„ç†æƒ³å½“ç„¶æ˜¯ï¼šå“ªä¸ªæ–‡ä»¶æ›´æ–°äº†ï¼Œå°±è‡ªåŠ¨åœ°ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶åã€‚ å¦å¤–ï¼Œå¦‚æžœæˆ‘ä»¬æ‰“åŒ…å‡ºæ¥çš„é™æ€æ–‡ä»¶åªæœ‰ä¸€ä¸ªå•ç‹¬çš„ JavaScript æ–‡ä»¶ app.js ï¼Œé‚£ä¹ˆæ¯æ¬¡æ”¹åŠ¨ä¸€ç‚¹ä»£ç ï¼Œapp.js çš„æ–‡ä»¶åè‚¯å®šéƒ½ä¼šå˜ã€‚ä½†å®žé™…ä¸Šï¼Œæˆ‘åªæ”¹åŠ¨äº†æŸä¸ªæ¨¡å—çš„ä»£ç ï¼ˆå…¶ä»–æ¨¡å—å¹¶æ²¡æœ‰ä¿®æ”¹ï¼‰ï¼Œå°±ç ´åäº†å…¶ä»–æ¨¡å—çš„ç¼“å­˜ï¼Œè¿™æ˜¾ç„¶æ²¡æœ‰å……åˆ†åˆ©ç”¨åˆ°ç¼“å­˜å•Šã€‚æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼šå“ªä¸ªæ¨¡å—æ›´æ–°äº†ç ´åä»–çš„ç¼“å­˜ï¼Œæ²¡æ›´æ–°çš„æ¨¡å—ç»§ç»­åˆ©ç”¨ç¼“å­˜ã€‚ è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ° webpack çš„ code splittingï¼ˆå¦‚æžœè¿˜ä¸ä¼šçš„è¯ï¼Œå¯ä»¥é˜…è¯» Webpack å¤§æ³•ä¹‹ Code Splitting ï¼‰ã€‚æŠŠæ•´ä¸ª App åˆ†æˆä¸€ä¸ªä¸ª chunk ï¼Œç„¶åŽå“ªä¸ª chunk å‘ç”Ÿæ”¹å˜ï¼Œæˆ‘å°±ç ´åä»–çš„ç¼“å­˜ï¼›æ²¡æœ‰æ›´æ–°çš„ chunk ï¼Œåˆ™ç»§ç»­åˆ©ç”¨ç¼“å­˜ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±æŠŠç¼“å­˜çš„ä½œç”¨å‘æŒ¥åˆ°æ·‹æ¼“å°½è‡´ï½ž æ‰€ä»¥ï¼Œcode splitting çš„ä½œç”¨é™¤äº†â€å‡å°‘æ–‡ä»¶å¤§å°â€ä¹‹å¤–ï¼Œè¿˜èƒ½æ›´å……åˆ†åœ°åˆ©ç”¨ç¼“å­˜ã€‚æ‰€ä»¥ï¼Œä¸‹é¢å°±è®©æˆ‘ä»¬ç”¨ webpack æ¥å®žçŽ°æŒä¹…æ€§ç¼“å­˜å§ã€‚ Webpack &amp; Cachingé¦–å…ˆï¼ŒæŠŠæˆ‘ä»¬çš„ demo é¡¹ç›®ï¼ˆå·²ç»å®žçŽ°äº† code splitting ï¼‰ä¸‹è½½å¹¶å®‰è£…å¥½ä¾èµ–ã€‚ æŽ¥ç€ï¼Œä¿®æ”¹ webpack é…ç½®æ–‡ä»¶ï¼Œç»™æˆ‘ä»¬æ‰“åŒ…åŽçš„é™æ€æ–‡ä»¶ç”Ÿæˆéšæœºçš„å”¯ä¸€çš„åå­—ã€‚ï¼ˆ changed files ï¼‰ 123456789// webpack.config.jsmodule.exports = &#123; output: &#123; //... filename: '[name].[chunkhash:8].js', chunkFilename: '[name].[chunkhash:8].chunk.js', //... &#125;,&#125; æˆ‘ä»¬ä½¿ç”¨äº† [chunkhash] è¿™ä¸ªå ä½ç¬¦ï¼Œå¹¶ä¸”ä¸ºäº†æ›´å¥½åœ°åˆ†è¾¨å’Œå±•ç¤º demo ï¼Œæˆ‘ä»¬æˆªå–äº†ä»–çš„å‰ 8 ä¸ªå­—ç¬¦ [chunkhash:8]ï¼Œä½†æ˜¯åœ¨å®žé™…ç”Ÿäº§ä¸­æˆ‘ä»¬ä¸è¦é‚£ä¹ˆåšï¼ å¥½å’¯ï¼ŒçŽ°åœ¨æ¥çœ‹çœ‹æˆ‘ä»¬çš„æ‰“åŒ…åŽçš„æ–‡ä»¶ï¼š 1234567 Asset Size Chunk Namescommon-in-lazy.fa79d198.chunk.js 11.6 kB common-in-lazy used-twice.c2c4927c.chunk.js 17.1 kB used-twice Photos.28d663ec.chunk.js 8.57 kB Photos Emoji.d3ea8991.chunk.js 1.15 kB Emoji app.724a238a.js 2.53 kB app vendor.05be8f94.js 104 kB vendor é‚£ä¹ˆï¼ŒçŽ°åœ¨æˆ‘ä»¬æ¥ä¿®æ”¹ä¸€ä¸‹ App.vue ï¼Œæ·»åŠ ä¸ª &lt;footer&gt; æ ‡ç­¾ï¼ˆ changed files ï¼‰ : 123456&lt;template&gt;&lt;div id="app"&gt; &lt;!-- old codes --&gt; &lt;footer&gt; A Footer &lt;/footer&gt;&lt;/div&gt;&lt;/template&gt; æ­¤æ—¶çš„æ‰“åŒ…å˜æˆäº†ï¼š 1234567 Asset Size Chunk Namescommon-in-lazy.fa79d198.chunk.js 11.6 kB common-in-lazy used-twice.c2c4927c.chunk.js 17.1 kB used-twice Photos.28d663ec.chunk.js 8.57 kB Photos Emoji.d3ea8991.chunk.js 1.15 kB Emoji app.fdc2eedb.js 2.57 kB app vendor.b611a5da.js 104 kB vendor æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬çš„ app chunk çš„ hash ä»Ž 724a238a å˜æˆäº† fdc2eedb ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰€å¸Œæœ›çœ‹åˆ°çš„ä¸œè¥¿ã€‚ä½†æ˜¯ï¼Œä¸Žæ­¤åŒæ—¶ vendor chunk çš„ hash ä¹Ÿå˜äº†ï¼ˆ05be8f94 -&gt; b611a5daï¼‰ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä¿®æ”¹ vendor chunk çš„ä»£ç ï¼Œä¸ºä»€ä¹ˆä»–çš„ hash ä¹Ÿå˜äº†å‘¢ï¼Ÿ? åŽŸå› æ˜¯ vendor chunk é‡Œé¢åŒ…å«äº† webpack çš„ runtime ä»£ç ï¼ˆç”¨æ¥è§£æžå’ŒåŠ è½½æ¨¡å—ä¹‹ç±»çš„è¿è¡Œæ—¶ä»£ç ï¼‰ï¼š è§£å†³åŠžæ³•å°±æ˜¯æŠŠ webpack çš„ runtime ä»£ç æå–å‡ºæ¥ï¼ˆ changed files ï¼‰ï¼š 123new webpack.optimize.CommonsChunkPlugin(&#123; name: ['manifast'] &#125;), æŠŠä¹‹å‰ App.vue æ›´æ–°äº†çš„ä»£ç æš‚æ—¶åŽ»æŽ‰ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æ·»åŠ çš„ &lt;footer&gt; æ ‡ç­¾åŽ»æŽ‰ï¼š æŽ¥ç€æŒ‰ç…§ä¹‹å‰çš„ï¼Œä¿®æ”¹ App.vue ï¼Œæ·»åŠ  `` æ ‡ç­¾ï¼ˆ changed files ï¼‰ï¼š 123456&lt;template&gt;&lt;div id="app"&gt; &lt;!-- old codes --&gt; &lt;footer&gt; A Footer &lt;/footer&gt;&lt;/div&gt;&lt;/template&gt; è€Œæ­¤æ—¶çš„æ‰“åŒ…ï¼š 12345678 Asset Size Chunk Namescommon-in-lazy.fa79d198.chunk.js 11.6 kB common-in-lazy used-twice.c2c4927c.chunk.js 17.1 kB used-twice Photos.28d663ec.chunk.js 8.57 kB Photos Emoji.d3ea8991.chunk.js 1.15 kB Emoji app.fdc2eedb.js 2.57 kB app vendor.3b70f9d8.js 103 kB vendor manifast.1442e3f3.js 1.54 kB manifast å¾ˆå¼€å¿ƒï¼Œæ­¤æ—¶åªæœ‰ app.js å’Œ manifast.js è¿™ 2 ä¸ª chunk çš„æ–‡ä»¶åçš„ hash å‘ç”Ÿäº†æ”¹å˜ï¼Œvendor.js chunk å’Œå…¶ä»– chunk éƒ½æ²¡å˜ï¼Œèˆ’æœã€‚ ä½†æ˜¯ï¼Œå‡å¦‚æˆ‘ä»¬ç»™ App.vue éšä¾¿å¼•å…¥ä¸€ä¸ªæ¨¡å—çš„è¯ï¼Œæ¯”å¦‚ï¼ˆ changed files ï¼‰ï¼š 1234&lt;script&gt;//...import noop from './shared/utils.js'&lt;/script&gt; è€Œæ­¤æ—¶çš„æ‰“åŒ…ï¼š 12345678 Asset Size Chunk Namescommon-in-lazy.30b1e9b6.chunk.js 11.6 kB common-in-lazy used-twice.9eccbe5a.chunk.js 17.1 kB used-twice Photos.6096611c.chunk.js 8.57 kB Photos Emoji.6208da60.chunk.js 1.15 kB Emoji app.4675a374.js 2.61 kB app vendor.8b538297.js 103 kB vendor manifast.25580296.js 1.54 kB manifast å§æ§½å±…ç„¶æ‰€æœ‰ chunk çš„ hash éƒ½å‘ç”Ÿäº†æ”¹å˜ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ åŽŸå› æ˜¯åœ¨ webpack é‡Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰ä¸€ä¸ª module id ï¼Œmodule id æ˜¯è¯¥æ¨¡å—åœ¨æ¨¡å—ä¾èµ–å…³ç³»å›¾é‡ŒæŒ‰é¡ºåºåˆ†é…çš„åºå·ï¼Œå¦‚æžœè¿™ä¸ª module id å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆä»–çš„ chunkhash ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚ï¼ˆä¸ç¡®å®šè¿™é‡Œæ˜¯å¦æ­£ç¡®ï¼Œå¸Œæœ›å¤§ä½¬æŒ‡å‡ºé”™è¯¯ï¼‰ æ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸€ç§æ–°çš„æ–¹å¼æ¥è®¡ç®— module id ã€‚ HashedModuleIdsPlugin è¿™ä¸ªæ’ä»¶ï¼Œä»–æ˜¯æ ¹æ®æ¨¡å—æ‰€åœ¨è·¯å¾„æ¥æ˜ å°„å…¶ module id ï¼Œè¿™æ ·å°±ç®—å¼•å…¥äº†æ–°çš„æ¨¡å—ï¼Œä¹Ÿä¸ä¼šå½±å“ module id çš„å€¼ï¼Œåªè¦æ¨¡å—çš„è·¯å¾„ä¸æ”¹å˜çš„è¯ã€‚ ä¿®æ”¹æˆ‘ä»¬çš„ webpack é…ç½®ã€‚å¹¶ä¸”ï¼ŒåŽ»æŽ‰ä¸Šé¢ App.vue å¼•å…¥çš„ noop æ¨¡å—ã€‚ï¼ˆ changed files ï¼‰ 123456// webpack.config.jsplugins: [ new webpack.HashedModuleIdsPlugin(), // ...], å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰ app chunk å’Œ manifast chunk çš„ hash å‘ç”Ÿäº†æ”¹å˜ï¼Œå…¶ä»– chunk ä¸å˜æ‰€ä»¥ä»–ä»¬çš„ç¼“å­˜å°±æ²¡è¢«ç ´åã€‚ æ€»ç»“ç”¨ webpack å®žçŽ° long term cache ï¼š ç”Ÿæˆç¨³å®šçš„ hash æ–‡ä»¶å æå– webpack çš„ runtime ä»£ç  code splitting è¿˜æœ‰ä¸€äº›ä¸œè¥¿æˆ‘ä»¬æ˜¯æ²¡è®²åˆ°çš„ï¼Œæ¯”å¦‚ CSS çš„ cache ï¼Œå†…è” manifast chunk ç­‰ç­‰ï¼Œå°±ç•™ç»™å¤§å®¶åŽ»æŽ¢ç´¢å’¯ã€‚ æœ€åŽéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwebpack æ˜¯å…è®¸å…¶ä»– plugin æ¥ä¿®æ”¹ chunkhash çš„ï¼Œå¦‚æžœä»–ä»¬ä¸èƒ½æ­£ç¡®åœ°å¤„ç†çš„è¯ï¼Œé‚£ä¹ˆï¼Œå‡è®¾ä½ æ›´æ–°äº†ä»£ç ï¼Œä½†æ˜¯å¯¹åº”çš„ chunkhash æ²¡å˜ï¼Œå¹¶ä¸”æ­¤æ—¶ç¼“å­˜è¿˜æ²¡å¤±æ•ˆï¼Œå°±ä¼šå¯¼è‡´çº¿ä¸Šçš„ä»£ç è¿˜æ˜¯æ—§çš„ï¼Œç”¨æˆ·çœ‹åˆ°çš„è¿˜æ˜¯ä»¥å‰çš„é¡µé¢ã€‚å› æ­¤ï¼Œä¸€å®šè¦ç‰¹åˆ«æ³¨æ„ chunkhash åˆ°åº•æ­£ä¸æ­£ç¡®ï¼ï¼ å¸Œæœ›æœ¬æ–‡å¯ä»¥å¸®åŠ©åˆ°å¤§å®¶ï¼Œè¿™æ ·æˆ‘ä¼šå¾ˆå¼€å¿ƒçš„ã€‚( )]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€šè¿‡ä¸€ä¸ªé—®é¢˜å­¦ä¹ map,filter,reduceè¯­æ³•]]></title>
    <url>%2F2019%2F07%2F24%2FJs%2F%E9%80%9A%E8%BF%87%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98%E5%AD%A6%E4%B9%A0map-filter-reduce%E8%AF%AD%E6%B3%95%2F</url>
    <content type="text"><![CDATA[æ¯”å¦‚ä¸€ä¸ªä»Ž1-10çš„ç®€å•çš„æ•°ç»„ï¼Œéœ€è¦ä»Žä¸­å–å¥‡æ•°ï¼Œä½ ä¼šæ€Žä¹ˆåšï¼Ÿè¿™ä¸ªé—®é¢˜ä¸éš¾ï¼Œæœ‰çš„å°‘ä¾ å¯èƒ½ä¼šä½¿ç”¨forå¾ªçŽ¯æ¥è¿‡æ»¤å‡ºå¶æ•°ï¼ŒæŸäº›å°‘ä¾ å¯èƒ½ä¼šä½¿ç”¨whileå¾ªçŽ¯ï¼Œåˆæˆ–æ˜¯ä½¿ç”¨æ•°ç»„è‡ªå¸¦çš„filteræ–¹æ³•ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆä¸è€ƒè™‘ä½¿ç”¨forå’Œwhileè¿™äº›è¿­ä»£æ–¹æ³•ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨æ•°ç»„è‡ªå¸¦çš„filteræ–¹æ³•ï¼Œå¦‚æžœä½¿ç”¨filteræ–¹æ³•çš„è¯ï¼Œ 12345const nums = [1,2,3,4,5,6,7,8,9,10];// è¿‡æ»¤å‡ºæ‰€æœ‰å¥‡æ•°nums.filter(num =&gt; num % 2 !== 0);console.log(nums); è¿˜æ˜¯æŒºç®€å•çš„å¯¹å§ï¼Ÿ ç›¸ä¿¡å¤§éƒ¨åˆ†å°‘ä¾ éƒ½èƒ½å¾ˆè½»æ¾å®Œæˆã€‚ åœ¨filterå‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ num % 2 !== 0 æ¥åˆ¤æ–­ æ˜¯å¦æ˜¯ä¸€ä¸ªå¥‡æ•°ï¼Œå¦‚æžœæ˜¯ä¸€ä¸ªå¥‡æ•°ï¼Œå°±è¿‡æ»¤å‡ºæ¥ã€‚ åœ¨è¿™é‡Œï¼Œæœ‰çš„å°‘ä¾ å¯èƒ½å°±ä¼šæƒ³åˆ°ï¼Œå¦‚æžœæŠŠè¿™ä¸ªåˆ¤æ–­è¿‡ç¨‹å•ç‹¬åˆ†æˆä¸€ä¸ªå‡½æ•°ï¼Œä¼šæ–¹ä¾¿ä¸€äº›ï¼Œä¹Ÿæ–¹ä¾¿ä»¥åŽçš„ä¿®æ”¹æ‰©å±•ã€‚ æ¯”å¦‚å•ç‹¬å†™ä¸€ä¸ªisOddå‡½æ•° 1const isOdd = num =&gt; num % 2 !== 0; ç„¶åŽåœ¨filteré‡Œé¢ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œæ˜¯å§ï¼Ÿ 1234567const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;// è¿‡æ»¤å‡ºæ‰€æœ‰å¥‡æ•°const odd = nums.filter(isOdd);console.log(odd); å¦‚æžœè¦æŠŠnumsé‡Œé¢çš„æ•°å­—ç¿»å€ï¼Œç”¨mapå‡½æ•°ï¼Œåˆè¯¥æ€Žä¹ˆåšå‘¢ï¼Ÿèªæ˜Žçš„å°‘ä¾ è¿™æ¬¡è‚¯å®šä¸€ä¸‹å°±æ˜Žç™½äº†ï¼š 1234const nums = [1,2,3,4,5,6,7,8,9,10];const double = num =&gt; num *2;const doubleNumbers = nums.map(double);console.log(doubleNumbers); ä»Žnumsé‡Œé¢è¿‡æ»¤å‡ºæ‰€æœ‰å¥‡æ•°ï¼Œå¹¶ç¿»å€è¿™äº›å¥‡æ•°ã€‚è¿™ä¸ªé—®é¢˜ä¹Ÿä¸éš¾æ˜¯å§ï¼Ÿ è®©æˆ‘çŒœä¸€ä¸‹ï¼Œä¸€äº›å°‘ä¾ åº”è¯¥ä¼šå†™æˆä¸‹é¢è¿™æ ·ï¼š 12345678const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const doubleNums = nums.filter(isOdd).map(double);console.log(doubleNums); å¦‚æžœæˆ‘ä»¬è¿˜æƒ³ç»§ç»­ç®—å‡ºæ‰€æœ‰å¥‡æ•°ç¿»å€åŽçš„å’Œçš„è¯123456789const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const add = (sum,num) =&gt; sum += num;const doubleNums = nums.filter(isOdd).map(double).reduce(add,0);console.log(doubleNums); å—¯ï¼Œä¸€ä¸ªä¸²ä¸€ä¸ªçœ‹èµ·æ¥å¾ˆé…·æ˜¯å§ï¼Ÿ æœ€åŽçš„ç»“æžœä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚ è¿™æ ·ä¸²èµ·æ¥çš„åŽæžœå°±æ˜¯ï¼Œæˆ‘ä»¬ä¼šéåŽ†3æ¬¡æ•°ç»„ï¼Œfilterçš„æ—¶å€™éåŽ†ä¸€æ¬¡ï¼Œmapçš„æ—¶å€™éåŽ†ä¸€æ¬¡ï¼Œreduceçš„æ—¶å€™å†éåŽ†ä¸€æ¬¡ã€‚ çŽ°åœ¨æ•°ç»„åªæœ‰10ä¸ªæ•°å­—ï¼Œå½±å“è¿˜ä¸å¤§ï¼Œä½†æ˜¯å¦‚æžœæ˜¯å¾ˆå¤§çš„æ•°ç»„ï¼Œæ¯”å¦‚100ä¸‡ä¸ªæ•°å­—ï¼ŒéåŽ†3éçš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šå¤šè®¿é—®150ä¸‡æ¬¡ï¼Œ æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æžœè®©ä½ è‡ªå·±ä»Žä¸­é—´å–å‡ºæ‰€æœ‰å¥‡æ•°ï¼Œç¿»å€ï¼Œå¹¶æ±‚å’Œï¼Œä½ ä¼šè§‰å¾—æ€Žä¹ˆåšç®€å•ä¸€äº›å‘¢ï¼Ÿ æ˜¯ä¸æ˜¯è§‰å¾—ä¸‹é¢è¿™æ ·æ‰æ¯”è¾ƒæ­£å¸¸ï¼Ÿ é¦–å…ˆï¼Œä»Žç¬¬ä¸€ä¸ªæ•°å­—å¼€å§‹ï¼Œå¦‚æžœå®ƒæ˜¯å¥‡æ•°ï¼Œå°±æ‹¿å‡ºæ¥ï¼Œç¿»å€ï¼Œç„¶åŽæ‰¾ä¸ªåœ°æ–¹æ”¾èµ·æ¥ æŽ¥ç€ï¼Œç»§ç»­çœ‹ç¬¬äºŒä¸ªæ•°å­—ï¼Œå¦‚æžœæ˜¯å¶æ•°ï¼Œå°±è·³è¿‡ï¼Œå¦‚æžœæ˜¯å¥‡æ•°ï¼Œå°±æ‹¿å‡ºæ¥ï¼Œç¿»å€ï¼Œç„¶åŽå’Œå¼€å§‹çš„ç¿»å€åŽçš„å¥‡æ•°åŠ èµ·æ¥ï¼Œæ‰¾ä¸ªåœ°æ–¹æ”¾èµ·æ¥ã€‚ æŽ¥ç€çœ‹ç¬¬ä¸‰ä¸ªæ•°å­—ï¼Œä»¥æ­¤ç±»æŽ¨ï¼Œåªè¦æ˜¯å¥‡æ•°ï¼Œå°±ç¿»å€ï¼Œç„¶åŽå’Œä¹‹å‰çš„ç»“æžœåŠ èµ·æ¥ã€‚ ç›´åˆ°æˆ‘ä»¬æ‰¾å¯»åˆ°æœ€åŽä¸€ä¸ªæ•°å­—ï¼Œå°±å¯ä»¥ç®—å‡ºæœ€ç»ˆç»“æžœäº†ï¼Œ å¦‚æžœä½¿ç”¨è¿­ä»£çš„è¯ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·: 1234567891011121314151617const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const add = (sum,num) =&gt; sum += num;// ä¿å­˜æœ€ç»ˆç»“æžœlet result = 0;for (let i =0; i&lt; nums.length; i++)&#123; if(nums[i]%2 != 0)&#123; result = result + nums[i]*2; &#125;&#125;console.log(result); // 50 æ²¡é”™ï¼Œé€šå¸¸è¿™æ ·æ‰æ˜¯æ­£å¸¸çš„æ“ä½œã€‚ ä½†æ˜¯ï¼Œ è¿™æ ·çš„ä»£ç ä¸å¤ªæ–¹ä¾¿ï¼Œ å°‘ä¾ ä½ è‚¯å®šä¹Ÿä¸æƒ³æ¯æ¬¡éƒ½å†™è¿™ä¹ˆä¸€å¤§å †forå¾ªçŽ¯è¯­å¥å§ï¼Ÿ æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè¯•ç€ç»§ç»­ä¼˜åŒ–ä¸€ä¸‹ã€‚ æˆ‘ä»¬é¦–å…ˆè¯•ç€ç”¨ä¸€ä¸ªå«åšmagic(é­”æ³•)çš„å‡½æ•°æŠŠè¿™äº›æ­¥éª¤åŒ…è£¹èµ·æ¥: 1234567891011121314const nums = [1,2,3,4,5,6,7,8,9,10];const magic = array =&gt; &#123; const length = array.length, let i = 0; let sum = 0; for(i, i &lt; length; i++)&#123; if(array[i] % 2 !== 0)&#123; sum = sum + array[i]*2; &#125; &#125; return sum;&#125;console.log(magic(nums)); // 50 çŽ°åœ¨çœ‹èµ·æ¥å¥½å¤šäº†ï¼Œä¸è¿‡ï¼Œmagicå†…éƒ¨çš„æ“ä½œçœ‹èµ·æ¥ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œ å…¶ä»–å°‘ä¾ çœ‹è§äº†å¯èƒ½å¾ˆéš¾ä¸€çœ¼å°±æ˜Žç™½magicå‡½æ•°åœ¨åšä»€ä¹ˆ, æˆ‘ä»¬å¯ä»¥è¯•ç€æŠŠé‡Œé¢çš„ä¸€äº›æ­¥éª¤åˆ†æˆæ›´å°çš„å‡½æ•°: 1234567891011121314151617const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const add = (sum,num) =&gt; sum += num;const magic = array =&gt; &#123; const length = array.length, let i = 0; let sum = 0; for(i, i &lt; length; i++)&#123; if(isOdd(array[i]))&#123; sum = add(sum,double(array[i])); &#125; &#125; return sum;&#125;console.log(magic(nums)); // 50 çŽ°åœ¨æ¯”è¾ƒç®€æ´ä¹Ÿæ¯”è¾ƒæ¸…æ™°äº†ï¼Œä¸è¿‡ï¼Œå‡å¦‚æˆ‘ä»¬çŽ°åœ¨è¦è®¡ç®—æ˜¯å¶æ•°è€Œä¸æ˜¯å¥‡æ•°æ€Žä¹ˆåŠžå‘¢ï¼Ÿ æˆ–è€…å¦‚æžœæ›´å¤æ‚äº›ï¼Œå¦‚æžœæ˜¯å¶æ•°ï¼Œå°±åè¿‡æ¥ï¼Œé™¤ä»¥äºŒï¼Œç„¶åŽæ±‚å’Œï¼Œåˆè¯¥æ€Žä¹ˆåŠžå‘¢ï¼Ÿ éš¾é“æˆ‘ä»¬åˆè¦å¤åˆ¶ä¸€æ¬¡magicå‡½æ•°ï¼Œç„¶åŽæ”¹åŠ¨forå¾ªçŽ¯é‡Œé¢çš„é€»è¾‘å—ï¼Ÿ ä¹Ÿè®¸ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠforå¾ªçŽ¯å†…éƒ¨çš„é€»è¾‘å•ç‹¬æå–æˆä¸€ä¸ªå¤–éƒ¨å‡½æ•°ï¼ 1234567891011121314151617181920212223const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const isEvent = num =&gt; !isOdd(num)const double = num =&gt; num *2;const part = num =&gt; num /2;const add = (sum,num) =&gt; sum += num;const magic = (array,fn,sum) =&gt; &#123; const length = array.length, let i = 0; for(i, i &lt; length; i++)&#123; sum = magicFriends(sum,array[i]) &#125; return sum;&#125;function magicFriends(sum,num)&#123; if(isOdd(num))&#123; sum = add(sum,double(num)); &#125; return sum ;&#125;console.log(magic(nums,magicFriends,0)); // 50 æŽ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»ï¼é¦–å…ˆï¼Œæˆ‘ä»¬ç»™ä»£ç é‡Œé¢éƒ¨åˆ†å‡½æ•°å’Œå‚æ•°æ”¹ä¸€ä¸‹åå­—: 1234567891011121314151617181920212223const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const isEvent = num =&gt; !isOdd(num)const double = num =&gt; num *2;const part = num =&gt; num /2;const add = (sum,num) =&gt; sum += num;const reduce = (array,reducer,result) =&gt; &#123; const length = array.length, let i = 0; for(i, i &lt; length; i++)&#123; result = reducer(sum,array[i]) &#125; return result;&#125;consot magicFriends = (sum,num) =&gt;&#123; if(isOdd(num))&#123; sum = add(sum,double(num)); &#125; return sum ;&#125;console.log(reduce(nums,magicFriends,0)); // 50 æ˜¯ä¸æ˜¯æœ‰ç‚¹çœ¼ç†Ÿäº†ï¼Ÿ æŽ¥ç€ï¼Œæˆ‘ä»¬æ¢æˆæ•°ç»„è‡ªå¸¦çš„reduceå‡½æ•°: 1234567891011121314const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const isEvent = num =&gt; !isOdd(num)const double = num =&gt; num *2;const part = num =&gt; num /2;const add = (sum,num) =&gt; sum += num;consot magicFriends = (sum,num) =&gt;&#123; if(isOdd(num))&#123; sum = add(sum,double(num)); &#125; return sum ;&#125;console.log(nums.reduce(magicFriends,0)); // 50 æœ€åŽå›žåˆ°æˆ‘ä»¬ä¸Šé¢çš„é—®é¢˜:1234567const nums = [1,2,3,4,5,6,7,8,9,10];const isOdd = num =&gt; num % 2 !== 0;const double = num =&gt; num *2;const add = (sum,num) =&gt; sum += num;const result = nums.reduces((sum,num)=&gt; isOdd(num) ? add(sum,dobule(num) : sum,0));console.log(result); // 50 è¿™æ¬¡æˆ‘ä»¬ç”¨reduceåªéåŽ†äº†ä¸€æ¬¡æ•°ç»„å°±å®Œæˆäº†ä¹‹å‰çš„æ“ä½œï¼ çŽ°åœ¨çŸ¥é“ä¸ºä»€ä¹ˆä¹‹å‰è¦æŠŠreduceå«åšmagic(é­”æ³•)äº†å§ï¼]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•ä½¿ç”¨ vue + typescript ç¼–å†™é¡µé¢(1)]]></title>
    <url>%2F2019%2F07%2F15%2FTs%2F%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-vue-typescript-%E7%BC%96%E5%86%99%E9%A1%B5%E9%9D%A2-1%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ èµ·æ­¥ä½¿ç”¨ vue-cli åˆ›å»ºé¡¹ç›® vue create demo ï¼Œdemoå°±æ˜¯åˆ›å»ºé¡¹ç›®çš„åç§°æç¤ºé€‰æ‹©é¢„è®¾ï¼Œé€‰æ‹© Manually select features å›žè½¦ç¡®è®¤é€‰æ‹©typescript vuex router babel css pre-processorsï¼Œä¸ä½¿ç”¨linterï¼Œä¸é€‰å•å…ƒæµ‹è¯•æœ‰éœ€è¦å¦è¯´å›žè½¦åŽæŒ‰ç…§éœ€è¦é€‰æ‹©åˆé€‚çš„é€‰é¡¹é€‰æ‹©å®Œæ¯•åŽå›žè½¦ç­‰å¾…èµ„æºå‡†å¤‡ ç¼–ç å¼€å§‹ç†Ÿæ‚‰å‡ ä¸ªvueçš„è£…é¥°å™¨ vue-property-decorator ä»¥ä¸‹çš„è£…é¥°å™¨çš„åŠŸèƒ½å’ŒåŽŸjsç¼–å†™çš„åŠŸèƒ½ç›¸åŒ/ç›¸ä¼¼ï¼Œå¯ä»¥å‚ç…§å®˜æ–¹æ–‡æ¡£ç±»æ¯”è§£è¯»ã€‚ 1import &#123; Vue, Component, Inject, Provide, Prop, Model, Watch, Emit, Mixins &#125; from 'vue-property-decorator' 1. Vue å®žé™…ä¸Šå°±æ˜¯ Vue æœ¬èº«,ç»§æ‰¿vueç›¸å…³å±žæ€§å’Œå‡½æ•°1class MyComponent extends Vue &#123; &#125; 2. @Component å£°æ˜Žæˆä¸€ä¸ªvueçš„ç»„ä»¶å®žä¾‹ï¼Œå¦‚æžœä¸ä½¿ç”¨ï¼Œåˆ™ä¸èƒ½å¾—åˆ°ä¸€ä¸ªvueç»„ä»¶ç¬¬ä¸€ç§æ–¹å¼ï¼Œä¸éœ€è¦å®šä¹‰é¢å¤–å†…å®¹: 12@Componentclass MyComponent extends Vue &#123; &#125; ç¬¬äºŒç§æ–¹å¼ï¼Œå®šä¹‰ç›¸å…³å†…å®¹: 1234567891011121314151617@Component(&#123; /* è¿™é‡Œå’Œjsç‰ˆæœ¬ç¼–å†™çš„ vue ç»„ä»¶å†…å®¹ç›¸åŒï¼Œ * å‡¡æ˜¯ä¸èƒ½åœ¨tsé‡Œé¢å®Œæˆçš„éƒ½å¯ä»¥åœ¨è¿™é‡Œå®Œæˆ * æœ€ç»ˆä¼šè¢«åˆå¹¶åˆ°ä¸€ä¸ªå®žä¾‹ä¸­ã€‚ * åœ¨è¿™é‡Œå®šä¹‰çš„å†…å®¹ï¼Œä¸ä¼šè¢«è¯­æ³•å™¨èŽ·å–åˆ°ï¼Œå› æ­¤å¿…é¡»è¦åŒæ­¥åœ¨classä¸­å£°æ˜Ž */ data()&#123; return &#123; myname:"",age:18 &#125; &#125;&#125;)class MyComponent extends Vue &#123; private myname:string; mounted()&#123; this.myname; this.age;// è¯­æ³•å™¨æŠ¥é”™ï¼Œå½“å‰ç±»æ‰¾ä¸åˆ°ageå±žæ€§ &#125;&#125; 3.@Provide å‘ä»»æ„å±‚çº§çš„å­ç»„ä»¶æä¾›å¯è®¿é—®çš„å±žæ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±žæ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°12345@Componentclass ParentComponent extends Vue &#123; @Provide() private info!:string; @Provide("next") private infoNext!:string;&#125; 4. @Inject èŽ·å–çˆ¶çº§ç”±Provideæä¾›çš„å±žæ€§ï¼Œé»˜è®¤ä¸ºå½“å‰å±žæ€§çš„åç§°ï¼Œå¯ä»¥æŒ‡å®šåç§°ï¼Œå¤šä¸ªçˆ¶çº§æä¾›ç›¸åŒåç§°å±žæ€§æ—¶ï¼ŒèŽ·å–æœ€è¿‘çˆ¶çº§çš„åç§°å±žæ€§12345@Componentclass MyComponent extends Vue &#123; @Inject() private info!:string; @Inject("next") private infoNext!:string;&#125; 5. @Prop ç”±æ ‡ç­¾å±žæ€§æ³¨å…¥ï¼ŒèŽ·å–å¯¹åº”æ ‡ç­¾å±žæ€§ä¸Šå€¼,å¯é…ç½®å…·ä½“propå†…å®¹ï¼Œå‚ç…§jsç‰ˆæœ¬propså†…å®¹12345@Componentclass MyComponent extends Vue &#123; @Prop() age!:number; @Prop(&#123;default:1&#125;) sex!:number;&#125; 123456789101112&lt;template&gt; &lt;MyComponent :age="16" /&gt;&lt;/template&gt;&lt;script lang="ts"&gt; import MyComponent from './MyComponent.vue';@Component(&#123; components:&#123; MyComponent &#125;&#125;)class PComponent extends Vue &#123; &#125;&lt;/script&gt; 6. @Model æ˜¯v-modelçš„è£…é¥°å™¨ï¼Œå½“è‡ªå®šä¹‰ç»„ä»¶æƒ³ä½¿ç”¨v-modelæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œé…åˆemitå¯ä»¥åŒå‘ä¼ é€’å±žæ€§å€¼12345678910111213&lt;template&gt; &lt;input type="checkbox" :checked="checked" @change="changed"/&gt;&lt;/template&gt;&lt;script lang="ts"&gt;@Componentclass MyComponent extends Vue &#123; @Model("change") checked!:number; changed(event:any)&#123; /* è¿™é‡Œæ˜¯å·æ‡’å†™çš„anyï¼Œåœ¨å®žé™…é¡¹ç›®ä¸­éœ€è¦é¿å… */ this.$emit("change",event.target.value) &#125;&#125;&lt;/script&gt; 1234567891011121314&lt;template&gt; &lt;MyComponent :age="16" v-model="mycheck" /&gt;&lt;/template&gt;&lt;script lang="ts"&gt; import MyComponent from './MyComponent.vue';@Component(&#123; components:&#123; MyComponent &#125;&#125;)class PComponent extends Vue &#123; private mycheck:boolean = false;&#125;&lt;/script&gt; 7. @Watch è§‚å¯ŸæŸä¸ªå±žæ€§æ›´æ–°12345678@Componentclass MyComponent extends Vue &#123; @Prop() age!:number; @Watch("age") ageChange(newVal:number,oldVal:number)&#123; /*ageå±žæ€§æ›´æ–°æ—¶ï¼Œå¤„ç†ç›¸å…³å†…å®¹*/ &#125;&#125; 8. @Emit this.$emit çš„è£…é¥°å™¨,å¦‚æžœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œé»˜è®¤ä½¿ç”¨å‡½æ•°åç§°ã€‚æœ‰è¿”å›žå€¼æ—¶ï¼Œä½¿ç”¨è¿”å›žå€¼ï¼Œæ²¡æœ‰åˆ™ä½¿ç”¨12345678910111213@Componentclass MyComponent extends Vue &#123; private myname = ""; @Emit() ageChangeA()&#123; /* ä»…å‘é€ this.$emit('ageChangeA') */ &#125; @Emit() ageChangeB(age:number)&#123; /* å‘é€ age this.$emit('ageChangeB',age) */ &#125; @Emit() ageChangeC(age:number)&#123; return 1 /* this.$emit('ageChangeC',1) å‘é€return ç»“æžœ*/ &#125;&#125; 9. Mixins12345678// MyMixin.ts@Componentexport default class MyMixin extends Vue &#123; /* å¦‚æžœä½¿ç”¨private ä¿®é¥°ï¼Œåˆ™ä¸¤ä¸ªç›¸åŒçš„ ç§æœ‰å±žæ€§æ··å…¥æ—¶ï¼Œä¼šäº§ç”Ÿå†²çª */ protected myname = "å¼ ä¸‰"; created()&#123; /* æ··å…¥å¯¹è±¡æœ‰è‡ªå·±çš„ ç”Ÿå‘½å‘¨æœŸå‡½æ•°*/ &#125; getMyName()&#123; console.log("å¼ ä¸‰æ··å…¥") &#125;&#125; 12345678// OtherMixin.ts@Componentexport default class OtherMixin extends Vue &#123; /* å¦‚æžœä½¿ç”¨private ä¿®é¥°ï¼Œåˆ™ä¸¤ä¸ªç›¸åŒçš„ ç§æœ‰å±žæ€§æ··å…¥æ—¶ï¼Œä¼šäº§ç”Ÿå†²çª */ protected myname = "æŽå››"; created()&#123; /* æ··å…¥å¯¹è±¡æœ‰è‡ªå·±çš„ ç”Ÿå‘½å‘¨æœŸå‡½æ•°*/ &#125; getMyName()&#123; console.log("æŽå››æ··å…¥") &#125;&#125; 1234567@Componentclass MyComponent extends Mixins(MyMixin,OtherMixin) &#123; private myname = ""; /* æ··å…¥å¯¹è±¡å·²ç»å®šä¹‰ï¼Œè¿™é‡Œäº§ç”Ÿå±žæ€§å†²çª */ mounted()&#123; this.getMyName() // æŽå››æ··å…¥ &#125;&#125; å¯¹äºŽcomputedï¼Œä½¿ç”¨ get æ›¿ä»£1234567@Componentclass MyComponent extends Vue &#123; private myname = ""; /* æ··å…¥å¯¹è±¡å·²ç»å®šä¹‰ï¼Œè¿™é‡Œäº§ç”Ÿå±žæ€§å†²çª */ get upperName()&#123; return "A" + this.myname &#125;&#125; è£…é¥°å™¨å¯ä»¥å‚ç…§ vue-property-decorator æ²¡æœ‰filters,æ²¡æœ‰æŒ‡ä»¤ç›¸å…³è£…é¥°å™¨ï¼Œæœ‰éœ€è¦å¯ä»¥åœ¨@Componenté‡Œé¢è¡¥å……ï¼Œæˆ–è€…å¯ä»¥ç›´æŽ¥å®šä¹‰å‡½æ•°è°ƒç”¨è®¡ç®—è¿”å›žå€¼ åœ¨classé‡Œå®šä¹‰çš„å±žæ€§å³dataå±žæ€§ï¼Œéœ€è¦èµ‹å€¼åˆå§‹å€¼ã€‚ typescript æ··ç”¨jså½“æˆ‘ä»¬å¼•ç”¨äº†ä¸€ä¸ªjsç¼–å†™çš„æ¨¡å—æ—¶ä¼šæŠ¥é”™ï¼Œè¿™æ—¶å€™ï¼Œå¦‚æžœä¸åœ¨å¼•å…¥çš„indexæ–‡ä»¶é‡Œé¢æ·»åŠ .d.tsæè¿°æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¨¡å—å°±æ²¡æ³•åœ¨è¯­ä¹‰ä¸Šä¸€è‡´é€šè¿‡. é€šç”¨å…¼å®¹æ€§è§£å†³æ–¹æ¡ˆå¦‚æžœè¿™ä¸ªæ¨¡å—æ˜¯ç”±npmä¸‹è½½çš„ï¼Œå¹¶ä¸”æœ‰@typesç‰ˆæœ¬ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨npm install @types/xxä¸‹è½½ å¯æƒœ,å¤§éƒ¨åˆ†éƒ½æ˜¯æ²¡æœ‰ç¼–å†™å£°æ˜Žæ–‡ä»¶çš„.ä½†æ˜¯åˆéœ€è¦ä½¿ç”¨åˆ°è¿™ä¸ªæ¨¡å—æ—¶,åº”è¯¥æ€Žä¹ˆåš. è‡ªå®šä¹‰æè¿°æ–‡ä»¶ åœ¨é¡¹ç›®çš„ã€æ ¹ç›®å½•ã€‘ä¸‹å®šä¹‰ã€æ¨¡å—ç›¸åŒçš„åç§°ã€‘çš„æè¿°æ–‡ä»¶A.d.ts,åœ¨æè¿°æ–‡ä»¶å†…ç¼–å†™æ¨¡å—å£°æ˜Žæè¿° 12// A.d.tsdeclare module '*'; è¿™æ ·å±žäºŽä¸€åŠ³æ°¸é€¸çš„æè¿°,ä½†æ˜¯æ— æ³•æè¿°åˆ°å…·ä½“æ¨¡å—å†…å®¹,å› æ­¤è¿™ç§æ–¹å¼ä»…ä»…å¼•å…¥çš„ç»„ä»¶æ²¡æœ‰ä»»ä½•æ“ä½œæ—¶,æ¯”å¦‚å¼•å…¥çš„æ˜¯ç¬¬ä¸‰æ–¹å¼€å‘çš„vueç»„ä»¶,å¯ä»¥ç”¨è¿™ç§æ–¹å¼å·æ‡’. è¯¦ç»†æè¿°æ–‡ä»¶ 1234// A.d.tsdeclare module "A" &#123; // æ·»åŠ å…·ä½“çš„æè¿°å†…å®¹&#125;; å¯ä»¥ä»Žè¿™é‡ŒæŸ¥è¯¢åˆ°@typeåŒ…æŸ¥è¯¢ï¼Œå·²ç»è¢«ç¼–å†™çš„æ–‡ä»¶å£°æ˜Žå¯ä»¥ç›´æŽ¥ä¸‹è½½]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Ts</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TypeScript çš„å¥½å¤„éƒ½æœ‰å•¥ï¼Ÿå’Œ JavaScript çš„åŒºåˆ«åœ¨å“ªï¼Ÿ]]></title>
    <url>%2F2019%2F07%2F04%2FTs%2FTypeScript-%E7%9A%84%E5%A5%BD%E5%A4%84%E9%83%BD%E6%9C%89%E5%95%A5%EF%BC%9F%E5%92%8C-JavaScript-%E7%9A%84%E5%8C%BA%E5%88%AB%E5%9C%A8%E5%93%AA%EF%BC%9F%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ åœ¨æˆ‘çœ‹æ¥ TypeScript ç›¸å¯¹äºŽ JavaScript ï¼Œé™¤äº†é™æ€ç±»åž‹å¤–æ²¡å¸¦æ¥ä»»ä½•ä¸œè¥¿ã€‚ æ—¢ç„¶å¦‚æ­¤ é™æ€ç±»åž‹æœ‰ä»€ä¹ˆå¥½å¤„é™æ€ç±»åž‹çš„å¥½å¤„åˆ°å¤„éƒ½æœ‰è¯´ï¼Œè¿™é‡Œå°±ä¸è¯´å¾—å¤ªè¯¦ç»†äº†ï¼Œéšä¾¿åˆ—ä¸€ç‚¹ã€‚ æœç»æ‰‹è¯¯å¯¼è‡´çš„å˜é‡åé”™è¯¯ è‡ªåŠ¨å®Œæˆ é‡æž„æ”¯æŒ ç±»åž‹å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå……å½“æ–‡æ¡£ é™æ€ç±»åž‹è§£æ”¾è„‘å®¹é‡ï¼Œè‡ªåŠ¨å®Œæˆè®©æˆ‘ä¸éœ€è¦è®°å¿†å“ªä¸ªå˜é‡é‡Œæœ‰å“ªäº›å±žæ€§ï¼Œä¹Ÿä¸éœ€è¦è®°å®Œæ•´çš„å˜é‡åã€‚ å‡½æ•°ä¸Šçš„ç±»åž‹çº¦æŸå¤–åŠ å°½é‡ä¸»åŠ¨å†™çº¯å‡½æ•°è®©æˆ‘åœ¨å†™å‡½æ•°å®žçŽ°çš„æ—¶å€™ä¸éœ€è¦å…³æ³¨å‡½æ•°ä¹‹å¤–çš„ä»»ä½•ä¸œè¥¿ï¼Œæ³¨æ„åŠ›èšç„¦åœ¨å½“å‰å‡½æ•°ã€‚ å½“ç„¶ï¼Œä¹Ÿä¸åªæœ‰å¥½å¤„ã€‚ é™æ€ç±»åž‹æœ‰ä»€ä¹ˆä¸è¶³ ç±»åž‹æ ‡æ³¨éº»çƒ¦ã€‚ çŽ°é˜¶æ®µå¤§éƒ¨åˆ†é™æ€ç±»åž‹è¯­è¨€çš„ç±»åž‹ç³»ç»Ÿè¿˜ä¸å¤Ÿå¼ºã€‚ eval å’Œ new Function() è¿™ç§éªšæ“ä½œç±»åž‹ç³»ç»Ÿç®¡ä¸åˆ°ã€‚ éœ€è¦ç¼–è¯‘ï¼Œç±»åž‹æ£€æŸ¥ä¼šå¢žåŠ ç¼–è¯‘æ—¶é•¿ï¼Œè¯­æ³•å’Œç±»åž‹ç³»ç»Ÿå¤æ‚çš„è¯æ—¶é—´ç‰¹åˆ«ç‰¹åˆ«é•¿ï¼Œæ¯”å¦‚ scalaã€‚ æ ‡æ³¨éº»çƒ¦çš„é—®é¢˜æ— æ³•æ ¹ç»ï¼Œä½†æ˜¯ç±»åž‹æŽ¨å¯¼èƒ½è§£å†³å¤§éƒ¨åˆ†çš„ç±»åž‹æ ‡æ³¨é—®é¢˜ã€‚ ç±»åž‹ç³»ç»Ÿä¸å¤Ÿå¼ºçš„é—®é¢˜ä¼šéšç€æ—¶é—´æ…¢æ…¢å˜å¥½ã€‚ ç¼–è¯‘çš„é—®é¢˜åœ¨ ts å¯èƒ½ä¹Ÿå¹¶ä¸ç®—é—®é¢˜ï¼Œts çš„ç±»åž‹æ£€æŸ¥å¹¶ä¸å½±å“ ts ç¼–è¯‘æˆ jsã€‚ ä¹Ÿå°±æ˜¯è¯´å°±ç®—ç±»åž‹æ£€æŸ¥ä¸é€šè¿‡ ts ä¹Ÿèƒ½è·‘èµ·æ¥ã€‚æ‰€ä»¥å¯¹ ts æ¥è¯´ç±»åž‹æ£€æŸ¥å¯ä»¥ä»Žç¼–è¯‘ä¸­æå–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„ç¼–è¯‘å’Œç±»åž‹æ£€æŸ¥ä¸¤éƒ¨åˆ†ã€‚ å…ˆç¼–è¯‘è¾“å‡ºï¼Œå†åšç±»åž‹æ£€æŸ¥ï¼Œç¼–è¯‘çš„éƒ¨åˆ†ç›¸å½“äºŽ babel è¿™ç§å·¥å…·åšçš„äº‹ã€‚ ç±»åž‹æ£€æŸ¥ä¹Ÿå¯ä»¥å•ç‹¬è¿è¡Œã€‚ é‚£ä¹ˆï¼Œ TypeScript çš„ç±»åž‹ç³»ç»Ÿæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ å›¾çµå®Œå¤‡ã€‚ï¼ˆè™½ç„¶ä¸å¤ªæ¸…æ¥šè¿™æ„å‘³ç€ä»€ä¹ˆï¼‰ æ¸è¿›çš„ç±»åž‹ç³»ç»Ÿï¼Œæ‰€æœ‰ç±»åž‹æ ‡æ³¨éƒ½æ˜¯å¯é€‰çš„ï¼Œæ—¢æ˜¯å¤©ä½¿åˆæ˜¯æ¶é­”çš„ any ç±»åž‹ã€‚ï¼ˆè¢« Haskell å¤§ç‰› Colliot ç§°ä¸º ts ç±»åž‹ç³»ç»Ÿçš„æ¼æ´žï¼‰ æ”¯æŒå±€éƒ¨ç±»åž‹æŽ¨å¯¼ã€‚ ä¸°å¯Œçš„ç±»åž‹å±‚é¢çš„è®¡ç®—ï¼Œå¦‚ index types, mapped types, conditional types ç­‰ç­‰ã€‚ æ”¯æŒé¸­å­ç±»åž‹ã€‚ï¼ˆæˆ–å«ç»“æž„å­ç±»åž‹ï¼Ÿï¼‰ åƒ js æ”¯æŒå¯¹è±¡å­—é¢é‡ä¸€æ ·æ”¯æŒæ–¹ä¾¿çš„å¯¹è±¡å­—é¢ç±»åž‹ï¼ˆobject literal typeï¼‰ï¼Œå­—ç¬¦ä¸²å’Œæ•°å­—è¿˜æœ‰å¸ƒå°”å€¼å­—é¢ç±»åž‹ã€‚ ç©ºå®‰å…¨ã€‚ åŸºäºŽæŽ§åˆ¶æµçš„ç±»åž‹åˆ†æž è¿˜æœ‰è®¸å¤šæˆ‘è§‰å¾—æ¯”è¾ƒå¹³å¸¸çš„ç‚¹å°±æ²¡æœ‰åˆ—å‡ºæ¥ï¼Œæ¯”å¦‚æ”¯æŒç±»åž‹åˆ«åï¼Œæ³›åž‹ï¼Œåå˜é€†å˜åŒå˜ç­‰ç­‰ã€‚ ts æ˜¯ä¸€é—¨éžå¸¸éžå¸¸éžå¸¸å·¥ç¨‹çš„è¯­è¨€ï¼Œå¾ˆå¼ºå¤§ï¼Œä½†æ˜¯å¯èƒ½å’Œä¼˜é›…æ²¾ä¸ä¸ŠåŠç‚¹å…³ç³»ã€‚ å¯é€‰çš„ç±»åž‹æ ‡æ³¨æ­é…ç±»åž‹æŽ¨å¯¼ï¼Œè®© ts çš„ç±»åž‹ç³»ç»Ÿæ›´åƒæ˜¯å·¥å…·ï¼Œè€Œä¸æ˜¯æž·é”ã€‚å¥½çš„äº§å“æ˜¯ç”¨å®Œå³èµ°çš„ã€‚ æœ‰æ—¶å€™ï¼Œç¨å¾®å¼€ä¸ªæ´žï¼Œèƒ½è®©äº‹æƒ…å˜ç®€å•å¾ˆå¤šã€‚æ¯”å¦‚ anyã€‚ é¸­å­ç±»åž‹åŠ ä¸Šä¸Šé¢æåˆ°çš„ç‰¹æ€§å¯ä»¥è®©ä½ ä¾æ—§æ„Ÿè§‰å’Œ js ä¸€æ ·ï¼Œåƒå¤§æµ·é‡Œçš„é±¼ä¸€æ ·è‡ªç”±ã€‚ Null References: The Billion Dollar Mistake ï¼Œè€Œ js é‡Œæœ‰ä¸¤ä¸ª nullï¼ˆnull å’Œ undefinedï¼‰ï¼Œè™½ç„¶å‰ç«¯é€šå¸¸ä¸ä¼šé€ æˆéžå¸¸ä¸¥é‡çš„æŸå¤±ï¼Œä½†æ˜¯ js ä¹Ÿæ…¢æ…¢è¢«åº”ç”¨åˆ°ä¸ä»…ä»…æ˜¯å‰ç«¯çš„è®¸å¤šåœ°æ–¹äº†ã€‚ ts è¿™ä¹ˆå¥½ï¼Œ æ€Žä¹ˆå­¦ TypeScriptï¼Ÿæˆä¹Ÿæ¸è¿›ï¼Œè´¥ä¹Ÿæ¸è¿›ï¼Œæœ‰éƒ¨åˆ†äººé€šè¿‡å¯é€‰çš„ç±»åž‹æ ‡æ³¨ï¼Œä¸€æ­¥ä¸€æ­¥æ— ç—›åœ°è¿‡æ¸¡åˆ°å­¦ä¼š tsã€‚ è€Œå¦ä¸€éƒ¨åˆ†äººçŽ©äº†ä¸€ä¼šå„¿ï¼Œå‘çŽ°å’Œå†™ js å¹¶æ²¡æœ‰ä¸€ä¸ç‚¹åŒºåˆ«ï¼Œè€Œä¸”è¿˜ç¦»å¼€äº†ç†Ÿæ‚‰çš„çŽ¯å¢ƒï¼Œå°±æ”¾å¼ƒäº†ã€‚ ts å¹¶ä¸ä¼šå¼ºè¿«ä½ ä½¿ç”¨ç±»åž‹ï¼Œæ‰€ä»¥å°±éœ€è¦æ›´å¼ºçš„åŠ¨åŠ›æ¥æŽ¨åŠ¨è‡ªå·±å­¦ä¹ ã€‚ å¦‚æžœèº«è¾¹æœ‰ä¼š ts çš„æœ‹å‹çš„è¯ï¼Œå¯¹å­¦ä¹  ts ä¼šæ¯”è¾ƒæœ‰å¸®åŠ©ã€‚ å¤šè®©ä¼š ts çš„æœ‹å‹çœ‹è‡ªå·±çš„ä»£ç ï¼Œæ”¹è‰¯è‡ªå·±çš„å†™æ³•ã€‚å¤šå†™ï¼Œå¾ˆå®¹æ˜“å°±èƒ½å­¦ä¼šã€‚ å¦‚æžœèº«è¾¹æ²¡æœ‰ä¼š ts çš„äººï¼Œå…¶å®žæˆ‘æ›´å»ºè®®å…ˆç”¨ JSDocã€‚ ä½¿ç”¨ vscode æˆ–è€… webstorm çš„æ—¶å€™ç›´æŽ¥å†™ JSDoc å°±è¡Œäº†ï¼Œvsc æˆ– webstorm ä¼šä¾é  ts æ¥æä¾›ç±»åž‹æŽ¨å¯¼å’Œè‡ªåŠ¨å®Œæˆã€‚ è¿™æ ·å¯ä»¥åœ¨å·¥ä½œæˆ–è‡ªå·±å†™ä¸œè¥¿çš„æ—¶å€™æ…¢æ…¢ä¹ æƒ¯å¹¶ä¸”ä¸»åŠ¨åŽ»ä½¿ç”¨ç±»åž‹æ ‡æ³¨ã€‚ åœ¨ä½¿ç”¨ä¸€æ®µæ—¶é—´åŽæ„Ÿè§‰ JSDoc å·²ç»ä¸å¤Ÿç”¨äº†ï¼Œæ»¡è¶³ä¸äº†è‡ªå·±çš„éœ€æ±‚äº†ï¼Œå†å¼€å§‹ä½¿ç”¨ tsã€‚ åŒæ—¶ä¹Ÿè¦å¤šä¸»åŠ¨åŽ»äº†è§£å’Œå­¦ä¹ ä¸€äº› ts çš„ä»£ç ï¼Œä¸ç„¶çš„è¯ï¼Œä¸çŸ¥é“ ts æœ‰å¤šå¥½ï¼Œè‡ªç„¶å°±ä¸ä¼šè§‰å¾— JSDoc ä¸å¤Ÿç”¨ã€‚]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Ts</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vueä¸­ä¸å¸¸ç”¨çš„APIçš„ä½¿ç”¨æ–¹æ³•æ€»ç»“]]></title>
    <url>%2F2019%2F06%2F13%2FVue%2Fvue%E4%B8%AD%E4%B8%8D%E5%B8%B8%E7%94%A8%E7%9A%84API%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[errorHandlerå®˜ç½‘ä»‹ç»åŠä½¿ç”¨ï¼š æŒ‡å®šç»„ä»¶çš„æ¸²æŸ“å’Œè§‚å¯ŸæœŸé—´æœªæ•èŽ·é”™è¯¯çš„å¤„ç†å‡½æ•°ã€‚è¿™ä¸ªå¤„ç†å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå¯èŽ·å–é”™è¯¯ä¿¡æ¯å’Œ Vue å®žä¾‹ 1234567Vue.config.errorHandler = function (err, vm, info) &#123; //å¤„ç†é”™è¯¯ä¿¡æ¯, è¿›è¡Œé”™è¯¯ä¸ŠæŠ¥ //erré”™è¯¯å¯¹è±¡ //vm Vueå®žä¾‹ //`info` æ˜¯ Vue ç‰¹å®šçš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚é”™è¯¯æ‰€åœ¨çš„ç”Ÿå‘½å‘¨æœŸé’©å­ //åªåœ¨ 2.2.0+ å¯ç”¨&#125; Vue.observable( object )è¿™ä¸ªç›¸å½“äºŽä¸€ä¸ªç®€å•çš„storeç®¡ç†ï¼Œåœ¨ä¸ç”¨vuexçš„æƒ…å†µä¸‹ï¼Œä¸åŒç»„ä»¶ä¹‹é—´é€šä¿¡å¯ä»¥ç”¨Vue.observeable å®˜ç½‘ä»‹ç»ï¼š è®©ä¸€ä¸ªå¯¹è±¡å¯å“åº”ã€‚Vue å†…éƒ¨ä¼šç”¨å®ƒæ¥å¤„ç† data å‡½æ•°è¿”å›žçš„å¯¹è±¡ã€‚ è¿”å›žçš„å¯¹è±¡å¯ä»¥ç›´æŽ¥ç”¨äºŽæ¸²æŸ“å‡½æ•°å’Œè®¡ç®—å±žæ€§å†…ï¼Œå¹¶ä¸”ä¼šåœ¨å‘ç”Ÿæ”¹å˜æ—¶è§¦å‘ç›¸åº”çš„æ›´æ–°ã€‚ä¹Ÿå¯ä»¥ä½œä¸ºæœ€å°åŒ–çš„è·¨ç»„ä»¶çŠ¶æ€å­˜å‚¨å™¨ï¼Œç”¨äºŽç®€å•çš„åœºæ™¯ï¼š ä½¿ç”¨ï¼š åœ¨store.jsä¸­ 1234567impor vue from 'vue';export const store = vue.observable(&#123;count:0&#125;);export const mutation = &#123; setCount(count)&#123; store.count = count; &#125;&#125; åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;template&gt; &lt;div class="hello"&gt; &lt;p @click="setCount(testCount + 1)"&gt;+&lt;/p&gt; &lt;p @click="setCount(testCount - 1)"&gt;-&lt;/p&gt; &lt;test /&gt; &lt;p&gt;&#123;&#123;testCount&#125;&#125;&lt;/p&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import test from './test'import &#123; store, mutation&#125; from '@/store'export default &#123; name: 'HelloWorld', data () &#123; return &#123; msg: 'Welcome to Your Vue.js App' &#125; &#125;, components: &#123; test &#125;, methods: &#123; setCount: mutation.setCount &#125;, computed: &#123; testCount()&#123; return store.count &#125; &#125;&#125;&lt;/script&gt;&lt;!-- Add "scoped" attribute to limit CSS to this component only --&gt;&lt;style scoped&gt;h1, h2 &#123; font-weight: normal;&#125;ul &#123; list-style-type: none; padding: 0;&#125;li &#123; display: inline-block; margin: 0 10px;&#125;a &#123; color: #42b983;&#125;&lt;/style&gt; test ç»„ä»¶ 12345678910111213141516&lt;template&gt; &lt;div&gt;test&#123;&#123;testCount&#125;&#125;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;import &#123; store &#125; from '@/store';export default &#123; computed: &#123; testCount()&#123; return store.count &#125; &#125;&#125;&lt;/script&gt;&lt;style scoped&gt;&lt;/style&gt; errorCaptured(2.5.0æ–°å¢žçš„ç”Ÿå‘½å‘¨æœŸé’©å­)å®˜ç½‘ä»‹ç»ï¼š å½“æ•èŽ·ä¸€ä¸ªæ¥è‡ªå­å­™ç»„ä»¶çš„é”™è¯¯æ—¶è¢«è°ƒç”¨ã€‚æ­¤é’©å­ä¼šæ”¶åˆ°ä¸‰ä¸ªå‚æ•°ï¼šé”™è¯¯å¯¹è±¡ã€å‘ç”Ÿé”™è¯¯çš„ç»„ä»¶å®žä¾‹ä»¥åŠä¸€ä¸ªåŒ…å«é”™è¯¯æ¥æºä¿¡æ¯çš„å­—ç¬¦ä¸²ã€‚æ­¤é’©å­å¯ä»¥è¿”å›ž false ä»¥é˜»æ­¢è¯¥é”™è¯¯ç»§ç»­å‘ä¸Šä¼ æ’­ã€‚ ä¸Žerrorhandlerçš„ä¸åŒä¹‹å¤„ï¼š errorCaptured å’Œ errorHandler çš„è§¦å‘æ—¶æœºéƒ½æ˜¯ç›¸åŒçš„ï¼Œä¸åŒçš„æ˜¯ errorCaptured å‘ç”Ÿåœ¨å‰ï¼Œä¸”å¦‚æžœæŸä¸ªç»„ä»¶çš„ errorCaptured æ–¹æ³•è¿”å›žäº† falseï¼Œé‚£ä¹ˆè¿™ä¸ªå¼‚å¸¸ä¿¡æ¯ä¸ä¼šå†å‘ä¸Šå†’æ³¡ä¹Ÿä¸ä¼šå†è°ƒç”¨ errorHandler æ–¹æ³• parentå®˜ç½‘ä»‹ç»ï¼š æŒ‡å®šå·²åˆ›å»ºçš„å®žä¾‹ä¹‹çˆ¶å®žä¾‹ï¼Œåœ¨ä¸¤è€…ä¹‹é—´å»ºç«‹çˆ¶å­å…³ç³»ã€‚å­å®žä¾‹å¯ä»¥ç”¨ this.$parent è®¿é—®çˆ¶å®žä¾‹ï¼Œå­å®žä¾‹è¢«æŽ¨å…¥çˆ¶å®žä¾‹çš„ $children æ•°ç»„ä¸­ã€‚ æ³¨æ„:èŠ‚åˆ¶åœ°ä½¿ç”¨ $parent å’Œ $children - å®ƒä»¬çš„ä¸»è¦ç›®çš„æ˜¯ä½œä¸ºè®¿é—®ç»„ä»¶çš„åº”æ€¥æ–¹æ³•ã€‚æ›´æŽ¨èç”¨ props å’Œ events å®žçŽ°çˆ¶å­ç»„ä»¶é€šä¿¡ ä½¿ç”¨: 1this.$parent.xxx() //ç›´æŽ¥åœ¨å­ç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶ä¸­æ–¹æ³• mixinå®˜ç½‘ä»‹ç»ï¼š mixins é€‰é¡¹æŽ¥å—ä¸€ä¸ªæ··å…¥å¯¹è±¡çš„æ•°ç»„ã€‚è¿™äº›æ··å…¥å®žä¾‹å¯¹è±¡å¯ä»¥åƒæ­£å¸¸çš„å®žä¾‹å¯¹è±¡ä¸€æ ·åŒ…å«é€‰é¡¹ï¼Œä»–ä»¬å°†åœ¨ Vue.extend() é‡Œæœ€ç»ˆé€‰æ‹©ä½¿ç”¨ç›¸åŒçš„é€‰é¡¹åˆå¹¶é€»è¾‘åˆå¹¶ã€‚ä¸¾ä¾‹ï¼šå¦‚æžœä½ çš„æ··å…¥åŒ…å«ä¸€ä¸ªé’©å­è€Œåˆ›å»ºç»„ä»¶æœ¬èº«ä¹Ÿæœ‰ä¸€ä¸ªï¼Œä¸¤ä¸ªå‡½æ•°å°†è¢«è°ƒç”¨ã€‚ mixinså°±æ˜¯å®šä¹‰ä¸€éƒ¨åˆ†å…¬å…±çš„æ–¹æ³•æˆ–è€…è®¡ç®—å±žæ€§,ç„¶åŽæ··å…¥åˆ°å„ä¸ªç»„ä»¶ä¸­ä½¿ç”¨,æ–¹ä¾¿ç®¡ç†ä¸Žç»Ÿä¸€ä¿®æ”¹ 1ã€åœ¨assetsæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªjsæ–‡ä»¶ 1234567891011// åˆ›å»ºä¸€ä¸ªéœ€è¦æ··å…¥çš„å¯¹è±¡ export const mixinTest1 = &#123; created() &#123; this.hello(); &#125;, methods: &#123; hello() &#123; console.log('mixinTest1'); &#125; &#125;&#125;; 2ã€åœ¨ç»„ä»¶ä¸­ä½¿ç”¨åˆšåˆšåˆ›å»ºçš„æ··å…¥ 12345678910import &#123;mixinTest1&#125; from './../assets/js/mixin';export default &#123; mixins:[mixinTest1], name: 'hello', data () &#123; return &#123; msg: 'Welcome to Your Vue.js App' &#125; &#125;&#125; 3ã€å¦‚æžœç»„ä»¶ä¸­å®šä¹‰çš„æ–¹æ³•ä¸Žæ··å…¥å¯¹è±¡ä¸­çš„æ–¹æ³•/å±žæ€§ä¸€æ ·,ç»„ä»¶ä¸­çš„ä¼˜å…ˆçº§å¤§äºŽæ··å…¥å¯¹è±¡ä¸­çš„(æ–¹æ³•ä¼šè°ƒç”¨å¤šæ¬¡) 4ã€æ··å…¥å¯¹è±¡ä¸­å¯ä»¥å®šä¹‰æŠ½è±¡æ–¹æ³•,ä½¿ç”¨æ··å…¥çš„ç»„ä»¶å¿…é¡»é‡å†™è¯¥æ–¹æ³• 1234567...methods: &#123; handlePlaylist() &#123; throw new Error('component must implement handlePlaylist method') &#125;&#125;... provide / injectå®˜ç½‘ä»‹ç»ï¼š è¿™å¯¹é€‰é¡¹éœ€è¦ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å…è®¸ä¸€ä¸ªç¥–å…ˆç»„ä»¶å‘å…¶æ‰€æœ‰å­å­™åŽä»£æ³¨å…¥ä¸€ä¸ªä¾èµ–ï¼Œä¸è®ºç»„ä»¶å±‚æ¬¡æœ‰å¤šæ·±ï¼Œå¹¶åœ¨èµ·ä¸Šä¸‹æ¸¸å…³ç³»æˆç«‹çš„æ—¶é—´é‡Œå§‹ç»ˆç”Ÿæ•ˆã€‚å¦‚æžœä½ ç†Ÿæ‚‰ Reactï¼Œè¿™ä¸Ž React çš„ä¸Šä¸‹æ–‡ç‰¹æ€§å¾ˆç›¸ä¼¼ã€‚ provide é€‰é¡¹åº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è¿”å›žä¸€ä¸ªå¯¹è±¡çš„å‡½æ•°ã€‚è¯¥å¯¹è±¡åŒ…å«å¯æ³¨å…¥å…¶å­å­™çš„å±žæ€§ã€‚åœ¨è¯¥å¯¹è±¡ä¸­ä½ å¯ä»¥ä½¿ç”¨ ES2015 Symbols ä½œä¸º keyï¼Œä½†æ˜¯åªåœ¨åŽŸç”Ÿæ”¯æŒ Symbol å’Œ Reflect.ownKeys çš„çŽ¯å¢ƒä¸‹å¯å·¥ä½œã€‚ inject é€‰é¡¹åº”è¯¥æ˜¯ï¼š ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæˆ–ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„ key æ˜¯æœ¬åœ°çš„ç»‘å®šåï¼Œvalue æ˜¯ï¼šåœ¨å¯ç”¨çš„æ³¨å…¥å†…å®¹ä¸­æœç´¢ç”¨çš„ key (å­—ç¬¦ä¸²æˆ– Symbol)ï¼Œæˆ–ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„ï¼šfrom å±žæ€§æ˜¯åœ¨å¯ç”¨çš„æ³¨å…¥å†…å®¹ä¸­æœç´¢ç”¨çš„ key (å­—ç¬¦ä¸²æˆ– Symbol)default å±žæ€§æ˜¯é™çº§æƒ…å†µä¸‹ä½¿ç”¨çš„ value æ³¨æ„ï¼šprovide å’Œ inject ä¸»è¦ä¸ºé«˜é˜¶æ’ä»¶/ç»„ä»¶åº“æä¾›ç”¨ä¾‹ã€‚å¹¶ä¸æŽ¨èç›´æŽ¥ç”¨äºŽåº”ç”¨ç¨‹åºä»£ç ä¸­ã€‚ æˆ‘ä¹‹å‰ä½¿ç”¨åˆ°provide / injectæ˜¯æ¨¡æ‹Ÿé¡µé¢æ•°æ®å›žåˆ°åˆå§‹çŠ¶æ€ï¼Œç›¸å½“äºŽåˆ·æ–°å½“å‰é¡µé¢ï¼Œä½†æ˜¯ç›´æŽ¥åˆ·æ–°å½“å‰é¡µé¢ä¼šæœ‰å‡ ç§’çš„ç©ºç™½æœŸï¼Œä½“éªŒä¸å¥½ï¼Œæ‰€ä»¥ç”¨åˆ°äº†provide / inject ä½¿ç”¨æ–¹æ³•ï¼š 1.ä¿®æ”¹App.vueä»£ç å¦‚ä¸‹å›¾æ‰€ç¤º 12345678910111213141516171819202122232425262728&lt;template&gt; &lt;div id="app"&gt; &lt;router-view v-if="isRouterActive"/&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; export default&#123; name: 'App', provide:&#123; retrun&#123; reload:this.reload &#125; &#125;, data()&#123; return&#123; isRouterActive: true &#125; &#125;, methods:&#123; reload()&#123; this.isRouterActive = false; this.$nextTick(()=&gt;&#123; this.isRouterActive = true; &#125;) &#125; &#125; &#125;&lt;/script&gt; é€šè¿‡å£°æ˜Žreloadæ–¹æ³•ï¼ŒæŽ§åˆ¶isRouterAliceå±žæ€§true or false æ¥æŽ§åˆ¶router-viewçš„æ˜¾ç¤ºæˆ–éšè—ï¼Œä»Žè€ŒæŽ§åˆ¶é¡µé¢çš„å†æ¬¡åŠ è½½ 2.åœ¨éœ€è¦å½“å‰é¡µé¢åˆ·æ–°çš„é¡µé¢ä¸­æ³¨å…¥App.vueç»„ä»¶æä¾›ï¼ˆprovideï¼‰çš„ reload ä¾èµ–ï¼Œç„¶åŽç›´æŽ¥ç”¨this.reloadæ¥è°ƒç”¨å°±è¡Œ 12345678910111213export defalut&#123; inject:['reload'], data()&#123; return&#123; &#125; &#125;, methods:&#123; reloadPage()&#123; this.reload(); &#125; &#125;&#125; keep-aliveå®˜ç½‘ä»‹ç»ï¼š &lt;keep-alive&gt; åŒ…è£¹åŠ¨æ€ç»„ä»¶æ—¶ï¼Œä¼šç¼“å­˜ä¸æ´»åŠ¨çš„ç»„ä»¶å®žä¾‹ï¼Œè€Œä¸æ˜¯é”€æ¯å®ƒä»¬ã€‚å’Œ &lt;transition&gt; ç›¸ä¼¼ï¼Œ&lt;keep-alive&gt; æ˜¯ä¸€ä¸ªæŠ½è±¡ç»„ä»¶ï¼šå®ƒè‡ªèº«ä¸ä¼šæ¸²æŸ“ä¸€ä¸ª DOM å…ƒç´ ï¼Œä¹Ÿä¸ä¼šå‡ºçŽ°åœ¨çˆ¶ç»„ä»¶é“¾ä¸­ã€‚ å½“ç»„ä»¶åœ¨ &lt;keep-alive&gt; å†…è¢«åˆ‡æ¢ï¼Œå®ƒçš„ activated å’Œ deactivated è¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°å°†ä¼šè¢«å¯¹åº”æ‰§è¡Œã€‚]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TypeScript é«˜çº§æŠ€å·§]]></title>
    <url>%2F2019%2F06%2F12%2FTs%2FTypeScript-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ å‰è¨€ç”¨äº†ä¸€æ®µæ—¶é—´çš„ typescript ä¹‹åŽï¼Œæ·±æ„Ÿä¸­å¤§åž‹é¡¹ç›®ä¸­ typescript çš„å¿…è¦æ€§ï¼Œå®ƒèƒ½å¤Ÿæå‰åœ¨ç¼–è¯‘æœŸé¿å…è®¸å¤š bugï¼Œå¦‚å¾ˆæ¶å¿ƒçš„æ‹¼å†™é—®é¢˜ã€‚è€Œè¶Šæ¥è¶Šå¤šçš„ package ä¹Ÿå¼€å§‹ä½¿ç”¨ tsï¼Œå­¦ä¹  ts å·²æ˜¯åŠ¿åœ¨å¿…è¡Œã€‚ 01 keyofkeyof ä¸Ž Object.keys ç•¥æœ‰ç›¸ä¼¼ï¼Œåªä¸è¿‡ keyof å– interface çš„é”®ã€‚ 1234567interface Point &#123; x: number; y: number;&#125;// type keys = "x" | "y"type keys = keyof Point; å‡è®¾æœ‰ä¸€ä¸ª object å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ typescript å®žçŽ°ä¸€ä¸ª get å‡½æ•°æ¥èŽ·å–å®ƒçš„å±žæ€§å€¼ 12345678const data = &#123; a: 3, hello: 'world'&#125;function get(o: object, name: string) &#123; return o[name]&#125; æˆ‘ä»¬åˆšå¼€å§‹å¯èƒ½ä¼šè¿™ä¹ˆå†™ï¼Œä¸è¿‡å®ƒæœ‰å¾ˆå¤šç¼ºç‚¹1.æ— æ³•ç¡®è®¤è¿”å›žç±»åž‹ï¼šè¿™å°†æŸå¤± ts æœ€å¤§çš„ç±»åž‹æ ¡éªŒåŠŸèƒ½2.æ— æ³•å¯¹ key åšçº¦æŸï¼šå¯èƒ½ä¼šçŠ¯æ‹¼å†™é”™è¯¯çš„é—®é¢˜ è¿™æ—¶å¯ä»¥ä½¿ç”¨ keyof æ¥åŠ å¼º get å‡½æ•°çš„ç±»åž‹åŠŸèƒ½ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥çœ‹çœ‹ _.get çš„ type æ ‡è®°ä»¥åŠå®žçŽ° 123function get&lt;T extends object, K extends keyof T&gt;(o: T, name: K): T[K] &#123; return o[name]&#125; 02 Partial &amp; Pickæ—¢ç„¶äº†è§£äº† keyofï¼Œå¯ä»¥ä½¿ç”¨å®ƒå¯¹å±žæ€§åšä¸€äº›æ‰©å±•ï¼Œ å¦‚å®žçŽ° Partial å’Œ Pickï¼ŒPick ä¸€èˆ¬ç”¨åœ¨ _.pick ä¸­ 12345678910111213141516171819type Partial&lt;T&gt; = &#123; [P in keyof T]?: T[P];&#125;;type Pick&lt;T, K extends keyof T&gt; = &#123; [P in K]: T[P];&#125;;interface User &#123; id: number; age: number; name: string;&#125;;// ç›¸å½“äºŽ: type PartialUser = &#123; id?: number; age?: number; name?: string; &#125;type PartialUser = Partial&lt;User&gt;// ç›¸å½“äºŽ: type PickUser = &#123; id: number; age: number; &#125;type PickUser = Pick&lt;User, "id" | "age"&gt; 03 Condition Typeç±»ä¼¼äºŽ js ä¸­çš„ ?: è¿ç®—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ‰©å±•ä¸€äº›åŸºæœ¬ç±»åž‹ 12345678T extends U ? X : Ytype isTrue&lt;T&gt; = T extends true ? true : false// ç›¸å½“äºŽ type t = falsetype t = isTrue&lt;number&gt;// ç›¸å½“äºŽ type t = falsetype t1 = isTrue&lt;false&gt; 04 never &amp; Exclude &amp; Omitå®˜æ–¹æ–‡æ¡£å¯¹ never çš„æè¿°å¦‚ä¸‹ the never type represents the type of values that never occur. ç»“åˆ never ä¸Ž conditional type å¯ä»¥æŽ¨å‡ºå¾ˆå¤šæœ‰æ„æ€è€Œä¸”å®žç”¨çš„ç±»åž‹ï¼Œæ¯”å¦‚ Omit 1234type Exclude&lt;T, U&gt; = T extends U ? never : T;// ç›¸å½“äºŽ: type A = 'a'type A = Exclude&lt;'x' | 'a', 'x' | 'y' | 'z'&gt; ç»“åˆ Exclude å¯ä»¥æŽ¨å‡º Omit çš„å†™æ³• 12345678910type Omit&lt;T, K extends keyof any&gt; = Pick&lt;T, Exclude&lt;keyof T, K&gt;&gt;;interface User &#123; id: number; age: number; name: string;&#125;;// ç›¸å½“äºŽ: type PickUser = &#123; age: number; name: string; &#125;type OmitUser = Omit&lt;User, "id"&gt; 05 typeofé¡¾åæ€ä¹‰ï¼Œtypeof ä»£è¡¨å–æŸä¸ªå€¼çš„ typeï¼Œå¯ä»¥ä»Žä»¥ä¸‹ç¤ºä¾‹æ¥å±•ç¤ºä»–ä»¬çš„ç”¨æ³• 1234const a: number = 3// ç›¸å½“äºŽ: const b: number = 4const b: typeof a = 4 åœ¨ä¸€ä¸ªå…¸åž‹çš„æœåŠ¡ç«¯é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æŠŠä¸€äº›å·¥å…·å¡žåˆ° context ä¸­ï¼Œå¦‚configï¼Œloggerï¼Œdb models, utils ç­‰ï¼Œæ­¤æ—¶å°±ä½¿ç”¨åˆ° typeofã€‚ 1234567891011121314import logger from './logger'import utils from './utils'interface Context extends KoaContect &#123; logger: typeof logger, utils: typeof utils&#125;app.use((ctx: Context) =&gt; &#123; ctx.logger.info('hello, world') // ä¼šæŠ¥é”™ï¼Œå› ä¸º logger.ts ä¸­æ²¡æœ‰æš´éœ²æ­¤æ–¹æ³•ï¼Œå¯ä»¥æœ€å¤§é™åº¦çš„é¿å…æ‹¼å†™é”™è¯¯ ctx.loger.info('hello, world')&#125;) 06 isåœ¨æ­¤ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸ª koa çš„é”™è¯¯å¤„ç†æµç¨‹ï¼Œä»¥ä¸‹æ˜¯å¯¹ error è¿›è¡Œé›†ä¸­å¤„ç†ï¼Œå¹¶ä¸”æ ‡è¯† code çš„è¿‡ç¨‹ 123456789101112131415app.use(async (ctx, next) =&gt; &#123; try &#123; await next(); &#125; catch (err) &#123; let code = 'BAD_REQUEST' if (err.isAxiosError) &#123; code = `Axios-$&#123;err.code&#125;` &#125; else if (err instanceof Sequelize.BaseError) &#123; &#125; ctx.body = &#123; code &#125; &#125;&#125;) åœ¨ err.code å¤„ï¼Œä¼šç¼–è¯‘å‡ºé”™ï¼Œæç¤º Property â€˜codeâ€™ does not exist on type â€˜Errorâ€™.ts(2339)ã€‚ æ­¤æ—¶å¯ä»¥ä½¿ç”¨ as AxiosError æˆ–è€… as any æ¥é¿å…æŠ¥é”™ï¼Œä¸è¿‡å¼ºåˆ¶ç±»åž‹è½¬æ¢ä¹Ÿä¸å¤Ÿå‹å¥½ 123if ((err as AxiosError).isAxiosError) &#123; code = `Axios-$&#123;(err as AxiosError).code&#125;`&#125; æ­¤æ—¶å¯ä»¥ä½¿ç”¨ is æ¥åˆ¤å®šå€¼çš„ç±»åž‹ 1234567function isAxiosError (error: any): error is AxiosError &#123; return error.isAxiosError&#125;if (isAxiosError(err)) &#123; code = `Axios-$&#123;err.code&#125;`&#125; åœ¨ GraphQL çš„æºç ä¸­ï¼Œæœ‰å¾ˆå¤šè¯¸å¦‚æ­¤ç±»çš„ç”¨æ³•ï¼Œç”¨ä»¥æ ‡è¯†ç±»åž‹ 1234567export function isType(type: any): type is GraphQLType;export function isScalarType(type: any): type is GraphQLScalarType;export function isObjectType(type: any): type is GraphQLObjectType;export function isInterfaceType(type: any): type is GraphQLInterfaceType; 07 interface &amp; typeinterface ä¸Ž type çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿå¯ä»¥å‚è€ƒä»¥ä¸‹ stackoverflow çš„é—®é¢˜ https://stackoverflow.com/questions/37233735/typescript-interfaces-vs-types ä¸€èˆ¬æ¥è¯´ï¼Œ1interfaceä¸Žtype` åŒºåˆ«å¾ˆå°ï¼Œæ¯”å¦‚ä»¥ä¸‹ä¸¤ç§å†™æ³•å·®ä¸å¤š 123456789interface A &#123; a: number; b: number;&#125;;type B &#123; a: number; b: number;&#125; å…¶ä¸­ interface å¯ä»¥å¦‚ä¸‹åˆå¹¶å¤šä¸ªï¼Œè€Œ type åªèƒ½ä½¿ç”¨ &amp; ç±»è¿›è¡Œè¿žæŽ¥ã€‚ 123456789101112interface A &#123; a: number;&#125;interface A &#123; b: number;&#125;const a: A = &#123; a: 3, b: 4&#125; 08 Dictionary &amp; Manyè¿™å‡ ä¸ªè¯­æ³•ç³–æ˜¯ä»Ž lodash çš„ types æºç ä¸­å­¦åˆ°çš„ï¼Œå¹³æ—¶å·¥ä½œä¸­çš„ä½¿ç”¨é¢‘çŽ‡è¿˜æŒºé«˜ã€‚ 123456789101112interface Dictionary&lt;T&gt; &#123; [index: string]: T;&#125;;interface NumericDictionary&lt;T&gt; &#123; [index: number]: T;&#125;;const data:Dictionary&lt;number&gt; = &#123; a: 3, b: 4&#125; 09 ä½¿ç”¨ const enum ç»´æŠ¤å¸¸é‡è¡¨ç›¸æ¯”ä½¿ç”¨å­—é¢é‡å¯¹è±¡ç»´æŠ¤å¸¸é‡ï¼Œconst enum å¯ä»¥æä¾›æ›´å®‰å…¨çš„ç±»åž‹æ£€æŸ¥ 123456// ä½¿ç”¨ object ç»´æŠ¤å¸¸é‡const enum TODO_STATUS &#123; TODO = 'TODO', DONE = 'DONE', DOING = 'DOING'&#125; 12345678910// ä½¿ç”¨ const enum ä¼ŸåŽå¸¸é‡const enum TODO_STATUS &#123; TODO = 'TODO', DONE = 'DONE', DOING = 'DOING'&#125;function todos (status: TODO_STATUS): Todo[];todos(TODO_STATUS.TODO) 10 VS Code Tips &amp; Typescript Commandä½¿ç”¨ VS Code æœ‰æ—¶ä¼šå‡ºçŽ°ï¼Œä½¿ç”¨ tsc ç¼–è¯‘æ—¶äº§ç”Ÿçš„é—®é¢˜ä¸Ž vs code æç¤ºçš„é—®é¢˜ä¸ä¸€è‡´ æ‰¾åˆ°é¡¹ç›®å³ä¸‹è§’çš„ Typescript å­—æ ·ï¼Œå³ä¾§æ˜¾ç¤ºå®ƒçš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥ç‚¹å‡»é€‰æ‹© Use Workspace Versionï¼Œå®ƒè¡¨ç¤ºä¸Žé¡¹ç›®ä¾èµ–çš„ typescript ç‰ˆæœ¬ä¸€ç›´ã€‚ æˆ–è€…ç¼–è¾‘ .vs-code/settings.json 123&#123; "typescript.tsdk": "node_modules/typescript/lib"&#125; 11 Typescript Roadmapæœ€åŽä¸€æ¡ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ¡ï¼Œç¿»é˜… Roadmapï¼Œäº†è§£ ts çš„ä¸€äº›æ–°çš„ç‰¹æ€§ä¸Ž bug ä¿®å¤æƒ…å†µã€‚ Typescript Roadmap]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Ts</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (åå››) --Nodeé¡¹ç›®-å•†å“åˆ—è¡¨]]></title>
    <url>%2F2019%2F05%2F25%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E5%8D%81%E5%9B%9B)%20--Node%E9%A1%B9%E7%9B%AE-%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8%2F</url>
    <content type="text"><![CDATA[Node.jsé¡¹ç›®ä»‹ç»åˆ©ç”¨å­¦åˆ°çš„çŸ¥è¯†ï¼Œå®žçŽ°ä¸€ä¸ªç®€å•ä½†å®žç”¨çš„å°é¡¹ç›®å¦‚ä¸‹ï¼š è¿™æ˜¯ä¸€ä¸ªå•†å“åˆ—è¡¨ï¼Œå…·æœ‰å±•ç¤ºå•†å“ä¿¡æ¯ï¼Œæ·»åŠ å•†å“ï¼Œåˆ é™¤å•†å“çš„åŠŸèƒ½ã€‚ é¡¹ç›®çš„æ–‡ä»¶å¤¹ç»“æž„â”œâ”€â”€ package.jsonâ”œâ”€â”€ server.js # æœåŠ¡å™¨ä»£ç â”œâ”€â”€ config # é¡¹ç›®é…ç½®æ–‡ä»¶å¤¹â”‚ â”œâ”€â”€ config.dev.js # å¼€å‘çŽ¯å¢ƒé…ç½®â”‚ â”œâ”€â”€ config.prod.js # ç”Ÿäº§çŽ¯å¢ƒé…ç½®â”‚ â”œâ”€â”€ index.js # å¯¼å‡ºå½“å‰æ‰€å¤„çŽ¯å¢ƒåŠé…ç½®â”œâ”€â”€ libs # é¡¹ç›®å·¥å…·æ–‡ä»¶å¤¹â”‚ â”œâ”€â”€ database.js # è¿žæŽ¥æ•°æ®åº“â”‚ â”œâ”€â”€ http.js # æœåŠ¡å™¨é…ç½®â”‚ â”œâ”€â”€ router.js # å¤„ç†è·¯ç”±â”œâ”€â”€ router # é¡¹ç›®è·¯ç”±é…ç½®æ–‡ä»¶å¤¹â”‚ â”œâ”€â”€ index.js # è¿žæŽ¥æ•°æ®åº“â”‚ â”œâ”€â”€ list.js # èŽ·å–å•†å“åˆ—è¡¨æŽ¥å£é…ç½®â”‚ â”œâ”€â”€ add.js # å¢žåŠ å•†å“æŽ¥å£é…ç½®â”‚ â”œâ”€â”€ del.js # åˆ é™¤å•†å“æŽ¥å£é…ç½®â”œâ”€â”€ static # é™æ€èµ„æºæ–‡ä»¶å¤¹â”‚ â”œâ”€â”€ index.html # å‰ç«¯HTMLé¡µé¢â”‚ â”œâ”€â”€ js # å‰ç«¯JavaScriptæ–‡ä»¶å¤¹â”‚ â”œâ”€â”€ css # å‰ç«¯CSSæ–‡ä»¶å¤¹â”‚ â”œâ”€â”€ fonts # å‰ç«¯å­—ä½“æ–‡ä»¶å¤¹â”‚ â”œâ”€â”€ upload # å‰ç«¯ä¸Šä¼ æ–‡ä»¶å¤¹ åˆ¤æ–­å½“å‰æ‰€å¤„çŽ¯å¢ƒé€šå¸¸é¡¹ç›®åœ¨å¼€å‘çŽ¯å¢ƒå’Œç”Ÿäº§çŽ¯å¢ƒè¦é‡‡ç”¨ä¸åŒçš„ï¼ŒæœåŠ¡å™¨ã€è´¦å·ã€åŸŸåã€ç«¯å£ç­‰é…ç½®ï¼Œå¦‚æžœç”¨äººå·¥è¿›è¡Œåˆ‡æ¢æ“ä½œéº»çƒ¦ä¸”å®¹æ˜“å‡ºé”™ï¼Œå› æ­¤é€šå¸¸ä½¿ç”¨çŽ¯å¢ƒå˜é‡è¿›è¡Œåˆ¤æ–­ã€‚ é¦–å…ˆå¼•å…¥processæ¨¡å—const process=require(&#39;process&#39;)ï¼Œè¯¥æ¨¡å—æä¾›äº†å½“å‰Node.jsè¿›ç¨‹çš„ä¿¡æ¯ã€‚ 1.å¯ä»¥é€šè¿‡process.envçŽ¯å¢ƒå˜é‡èŽ·å–å¼€å‘çŽ¯å¢ƒå’Œç”Ÿäº§çŽ¯å¢ƒç³»ç»Ÿç­‰å‚æ•°å·®å¼‚ï¼Œå¦‚å¼€å‘çŽ¯å¢ƒè¿è¡Œåœ¨Windowsç³»ç»Ÿä¸Šï¼Œè€Œç”Ÿäº§çŽ¯å¢ƒè¿è¡Œåœ¨Linuxç³»ç»Ÿï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨process.env.OS === &#39;Windows_NT&#39;åˆ¤æ–­å½“å‰æ‰€å¤„çš„æ˜¯å¦å¼€å‘çŽ¯å¢ƒã€‚ 1const mode = process.env.OS === 'Windows_NT' ? 'env' : 'prod' 2.ä¹Ÿå¯ä»¥é€šè¿‡package.jsonä¸­é…ç½®çš„å¯åŠ¨å‘½ä»¤åˆ¤æ–­å¤„äºŽå¼€å‘è¿˜æ˜¯ç”Ÿäº§çŽ¯å¢ƒï¼Œå¦‚å¼€å‘çŽ¯å¢ƒå‘½ä»¤npm start --devå’Œç”Ÿäº§çŽ¯å¢ƒå‘½ä»¤npm run build --buildã€‚ 1const mode = process.argv[2] === '--dev' ? 'env' : 'prod' åˆå§‹åŒ–å¼€å‘å’Œç”Ÿäº§çŽ¯å¢ƒé…ç½®åœ¨/config/index.jsä¸­ï¼Œåˆ¤æ–­æ‰€å¤„çš„çŽ¯å¢ƒï¼Œå¹¶å°†ç›¸åº”çŽ¯å¢ƒçš„æ ‡è¯†å’Œå‚æ•°ä½œä¸ºæ¨¡å—å¯¼å‡ºã€‚å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç›´æŽ¥å¼•ç”¨ç›¸åº”çš„é…ç½®ä½¿ç”¨ã€‚ 123456789101112const process = require('process')// å¯ä»¥é€šè¿‡å¼€å‘çŽ¯å¢ƒå’Œç”Ÿäº§çŽ¯å¢ƒç³»ç»Ÿç­‰å‚æ•°å·®å¼‚ï¼Œåˆ¤æ–­å¤„äºŽå“ªä¸ªçŽ¯å¢ƒã€‚// const mode = process.env.OS === 'Windows_NT' ? 'env' : 'prod'// ä¹Ÿå¯ä»¥é€šè¿‡package.jsonä¸­é…ç½®çš„å¯åŠ¨å‘½ä»¤åˆ¤æ–­å¤„äºŽå¼€å‘è¿˜æ˜¯ç”Ÿäº§çŽ¯å¢ƒã€‚const mode = process.argv[2] === '--dev' ? 'env' : 'prod'module.exports = &#123; mode, // å½“å‰æ‰€å¤„çŽ¯å¢ƒ ...(mode === 'env' ? require('./config.dev') : require('./config.prod')) // å½“å‰çŽ¯å¢ƒçš„é…ç½®&#125; 1.ä»¥å¼€å‘çŽ¯å¢ƒä¸ºä¾‹ï¼Œéœ€è¦ä½¿ç”¨çš„é…ç½®ä¸ºæœåŠ¡å™¨åŸŸåã€ç«¯å£å·ã€è´¦å·ã€å¯†ç ã€æ•°æ®åº“åï¼Œä»¥åŠHTTPç«¯å£ã€é™æ€æ–‡ä»¶ç»å¯¹è·¯å¾„ã€ä¸Šä¼ æ–‡ä»¶ä¿å­˜ç»å¯¹è·¯å¾„ï¼Œå¦‚ä¸‹ï¼š 123456789101112131415module.exports = &#123; // æ•°æ®åº“é…ç½® DB_HOST: 'localhost', DB_PORT: 3306, DB_USER: 'root', DB_PASS: '', DB_NAME: 'test', // HTTPç«¯å£ HTTP_PORT: 8080, // é™æ€æ–‡ä»¶ç»å¯¹è·¯å¾„ HTTP_ROOT: path.resolve(__dirname, '../static/'), // ä¸Šä¼ æ–‡ä»¶ä¿å­˜ç»å¯¹è·¯å¾„ HTTP_UPLOAD: path.resolve(__dirname, '../static/upload')&#125; è¿žæŽ¥æ•°æ®åº“åœ¨libæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºdatabase.jsï¼Œç”¨äºŽè¿žæŽ¥æ•°æ®åº“ã€‚ 123456789101112131415161718192021222324252627// å¼•å…¥mysqlå’Œco-mysqlï¼Œç”¨äºŽè¿žæŽ¥æ•°æ®åº“const mysql = require('mysql')const coMysql = require('co-mysql')// å¼•å…¥æ•°æ®åº“é…ç½®const &#123; DB_HOST, DB_PORT, DB_USER, DB_PASS, DB_NAME&#125; = require('../config')// 1. åˆ›å»ºæœåŠ¡å™¨è¿žæŽ¥æ± const pool = mysql.createPool(&#123; host: DB_HOST, port: DB_PORT, user: DB_USER, password: DB_PASS, database: DB_NAME&#125;)// 2. ä½¿ç”¨co-mysqlåŒ…è£…è¿žæŽ¥æ± ï¼Œå°†è¿žæŽ¥è½¬æ¢ä¸ºAsync/Awaitå¼‚æ­¥æ–¹å¼const connection = coMysql(pool)// 3. ä½œä¸ºæ¨¡å—å¯¼å‡ºä½¿ç”¨module.exports = connection åˆ›å»ºæ•°æ®åº“è¿žæŽ¥åŽï¼Œå¯ä»¥åœ¨server.jsä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿žæŽ¥ï¼Œå¹¶æŸ¥çœ‹item_tableè¡¨çš„æ•°æ® 1234567const connection = require('./lib/database');(async () =&gt; &#123; // æŸ¥è¯¢item_tableè¡¨ä¸­çš„æ•°æ® const response = await connection.query(`SELECT * FROM item_table`) console.log(response)&#125;)() è‹¥æ­£å¸¸è¿žæŽ¥ï¼Œå³å¯æ‰“å°æ•°æ®å¦‚ä¸‹ï¼š 12[ RowDataPacket &#123; ID: 1, title: 'è¿åŠ¨æœ', price: 299, count: 998 &#125; ]ice: 199, count: 999 &#125;, RowDataPacket &#123; ID: 2, title: 'è¿åŠ¨è£¤', price: 299, count: 998 &#125; ] åˆ›å»ºè·¯ç”±åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯è¦é€šè¿‡if elseè¯­å¥æ¥åˆ¤æ–­è¯·æ±‚çš„æŽ¥å£è·¯å¾„ï¼Œå¹¶è¿›è¡Œç›¸åº”æ“ä½œã€‚ è¿™æ ·ä¼šæžå¤§åœ°é™ä½Žå¼€å‘æ•ˆçŽ‡ï¼Œä¹Ÿä¸åˆ©äºŽåŽæœŸä»£ç ç»´æŠ¤ã€‚ å› æ­¤ï¼Œé€šå¸¸çš„å¼€å‘ä¸­ï¼Œéƒ½ä¼šä½¿ç”¨è·¯ç”±å¯¹ä¸åŒçš„æŽ¥å£è¿›è¡Œæ“ä½œã€‚ çŽ°åœ¨æˆ‘ä»¬å°±æ¥è‡ªå·±å®žçŽ°ä¸€ä¸ªç®€å•çš„è·¯ç”±ï¼š 1.å…ˆåˆ›å»ºä¸€ä¸ªrouterå¯¹è±¡ï¼Œç”¨äºŽå­˜å‚¨è·¯ç”±è¡¨ã€‚å…¶ä¸­æœ‰2ä¸ªå±žæ€§ï¼Œåˆ†åˆ«ä¸ºgetã€postï¼Œåˆ†åˆ«ç”¨äºŽå­˜å‚¨ç›¸åº”getã€postè¯·æ±‚åœ°å€çš„å›žè°ƒæ–¹æ³• 1234567891011// åˆ›å»ºè·¯ç”±è¡¨let router = &#123; // å­˜å‚¨getè¯·æ±‚çš„è·¯ç”± get: &#123; &#125;, // å­˜å‚¨postè¯·æ±‚çš„è·¯ç”± post: &#123; &#125;&#125; 2. åˆ›å»ºä¸€ä¸ªaddRouteræ–¹æ³•ï¼Œç”¨äºŽæ·»åŠ è·¯ç”±é…ç½®ï¼Œå‚æ•°methodä¸ºè¯·æ±‚æ–¹æ³•ï¼Œurlä¸ºè¯·æ±‚åœ°å€ï¼Œcallbackä¸ºå¤„ç†è¯¥è¯·æ±‚çš„å›žè°ƒå‡½æ•°ã€‚ 123456789// æ·»åŠ è·¯ç”±çš„æ–¹æ³•ï¼Œmethodä¸ºè¯·æ±‚æ–¹æ³•ï¼Œurlä¸ºè¯·æ±‚åœ°å€ï¼Œcallbackä¸ºå¤„ç†è¯¥è¯·æ±‚çš„å›žè°ƒå‡½æ•°function addRouter(method, url, callback) &#123; // ä¸ºä¾¿äºŽå¤„ç†ï¼Œå°†methodå’Œurlç»Ÿä¸€è½¬æ¢æˆå°å†™ method = method.toLowerCase() url = url.toLowerCase() // å°†å¤„ç†è¯·æ±‚çš„å›žè°ƒå‡½æ•°ï¼ŒæŒ‰æ–¹æ³•åå’Œåœ°å€å‚¨å­˜åˆ°è·¯ç”±è¡¨ä¸­ router[method][url] = callback&#125; 3. åˆ›å»ºä¸€ä¸ªfindRouteræ–¹æ³•ï¼Œç”¨äºŽæŸ¥æ‰¾ç›¸åº”è·¯ç”±çš„å›žè°ƒå‡½æ•°ã€‚å‚æ•°methodä¸ºè¯·æ±‚æ–¹æ³•ï¼Œurlä¸ºè¯·æ±‚åœ°å€ï¼Œè¿”å›žå¤„ç†è·¯ç”±çš„å›žè°ƒå‡½æ•°ã€‚ 123456789101112// æŸ¥æ‰¾å¤„ç†è¯·æ±‚çš„å›žè°ƒå‡½æ•°çš„æ–¹æ³•ï¼Œmethodä¸ºè¯·æ±‚æ–¹æ³•ï¼Œurlä¸ºè¯·æ±‚åœ°å€ï¼Œè¿”å›žå¤„ç†è·¯ç”±çš„å›žè°ƒå‡½æ•°function findRouter(method, url) &#123; // ä¸ºä¾¿äºŽå¤„ç†ï¼Œå°†methodå’Œurlç»Ÿä¸€è½¬æ¢æˆå°å†™ method = method.toLowerCase() url = url.toLowerCase() // æ‰¾åˆ°è·¯ç”±å¯¹åº”çš„å›žè°ƒå‡½æ•°ï¼Œä¸å­˜åœ¨åˆ™é»˜è®¤è¿”å›žnull const callback = router[method][url] || null // å°†å›žè°ƒå‡½æ•°è¿”å›ž return callback&#125; 4. å°†è·¯ç”±é…ç½®ä½œä¸ºæ¨¡å—å¯¼å‡º 12345// å°†æ·»åŠ è·¯ç”±å’ŒæŸ¥æ‰¾è·¯ç”±æ–¹æ³•å¯¼å‡ºmodule.exports = &#123; addRouter, findRouter&#125; åˆ›å»ºæœåŠ¡å™¨åœ¨å®žçŽ°äº†è·¯ç”±ä¹‹åŽï¼Œå°±å¯ä»¥ä»¥æ­¤ä¸ºåŸºç¡€å®žçŽ°æœåŠ¡å™¨äº†ã€‚ å®žçŽ°æœåŠ¡å™¨åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š 1.å¼•å…¥æ‰€éœ€Node.jsæ¨¡å—ã€æœåŠ¡å™¨é…ç½®ã€è·¯ç”±æ¨¡å—2.å°è£…ç»Ÿä¸€å¤„ç†è¯·æ±‚æ•°æ®çš„æ–¹æ³•3.æŽ¥æ”¶åˆ°çš„è¯·æ±‚åˆ†ä¸ºPOSTè¯·æ±‚ã€GETè¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç†4.POSTè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç†5.GETè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€è¯»å–æ–‡ä»¶è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç† æŽ¥ä¸‹æ¥ï¼ŒæŒ‰æ­¥éª¤å®žçŽ°æ¯éƒ¨åˆ†ä»£ç ã€‚ 1. å¼•å…¥æ‰€éœ€Node.jsæ¨¡å—ã€æœåŠ¡å™¨é…ç½®ã€è·¯ç”±æ¨¡å— 1234567891011121314151617181920212223242526// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—const http = require('http')const url = require('url')const querystring = require('querystring')const zlib = require('zlib')const fs = require('fs')const &#123; Form &#125; = require('multiparty')// å¼•å…¥æœåŠ¡å™¨é…ç½®const &#123; HTTP_PORT, HTTP_ROOT, HTTP_UPLOAD&#125; = require('../config')// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•const &#123; findRouter &#125; = require('./router')const server = http.createServer((req, res) =&gt; &#123; // æœåŠ¡å™¨ä»£ç &#125;)// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at $&#123;HTTP_PORT&#125;`) 2. å°è£…ç»Ÿä¸€å¤„ç†è¯·æ±‚æ•°æ®çš„æ–¹æ³• è¦å¤„ç†æ‰€æœ‰è¯·æ±‚æŽ¥å£ï¼Œéœ€è¦çš„å‚æ•°ä¸ºmethodï¼ˆè¯·æ±‚æ–¹æ³•ï¼‰ã€pathnameï¼ˆè¯·æ±‚æŽ¥å£è·¯å¾„ï¼‰ã€queryï¼ˆqueryæ•°æ®ï¼‰ã€postï¼ˆpostæ•°æ®ï¼‰ã€filesï¼ˆæ–‡ä»¶æ•°æ®ï¼‰ã€‚ é¦–å…ˆï¼Œæ ¹æ®methodï¼ˆè¯·æ±‚æ–¹æ³•ï¼‰ã€pathnameï¼ˆè¯·æ±‚æŽ¥å£è·¯å¾„ï¼‰ï¼ŒèŽ·å–åœ¨è·¯ç”±é…ç½®æ—¶ï¼Œå·²ç»é…ç½®å¥½çš„ç›¸åº”æŽ¥å£çš„å›žè°ƒå‡½æ•°ã€‚å…¶æ¬¡ï¼Œè‹¥å›žè°ƒå‡½æ•°å­˜åœ¨ï¼Œåˆ™ç›´æŽ¥å°†å‚æ•°ä¼ å…¥å›žè°ƒå‡½æ•°å¤„ç†ã€‚æœ€åŽï¼Œè‹¥å›žè°ƒå‡½æ•°ä¸å­˜åœ¨ï¼Œåˆ™é»˜è®¤ä¸ºè¯·æ±‚ä¸€ä¸ªé™æ€æ–‡ä»¶ï¼Œå³å¯å°†æ–‡ä»¶è¯»å–ä¹‹åŽå‘é€ç»™å‰ç«¯ã€‚ 123456789101112131415161718192021222324252627282930313233343536// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—...// å¼•å…¥æœåŠ¡å™¨é…ç½®...// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•...const server = http.createServer((req, res) =&gt; &#123; // é€šè¿‡è·¯ç”±å¤„ç†è¯·æ±‚æ•°æ®çš„å…¬å…±æ–¹æ³• async function processData(method, pathname, query, post, files) &#123; const callback = findRouter(method, pathname) // èŽ·å–å¤„ç†è¯·æ±‚çš„å›žè°ƒå‡½æ•° // è‹¥å›žè°ƒå‡½æ•°å­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºè·¯ç”±æœ‰é…ç½®ç›¸åº”çš„æ•°æ®å¤„ç†ï¼Œå³è¯¥è¯·æ±‚ä¸æ˜¯èŽ·å–é™æ€æ–‡ä»¶ã€‚ if (callback) &#123; try &#123; // æ ¹æ®è·¯ç”±å¤„ç†æŽ¥å£æ•°æ® await callback(res, query, post, files) &#125; catch (error) &#123; // å‡ºçŽ°é”™è¯¯çš„å¤„ç† res.writeHead(500) res.write('Internal Server Error') res.end() &#125; &#125; else &#123; // è‹¥å›žè°ƒå‡½æ•°ä¸å­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºè¯¥è¯·æ±‚ä¸ºè¯·æ±‚ä¸€ä¸ªé™æ€æ–‡ä»¶ï¼Œå¦‚htmlã€cssã€jsç­‰ ... &#125; &#125;&#125;)// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at $&#123;HTTP_PORT&#125;`) 3. æŽ¥æ”¶åˆ°çš„è¯·æ±‚åˆ†ä¸ºPOSTè¯·æ±‚ã€GETè¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç† æ ¹æ®è¯·æ±‚çš„methodï¼Œå°†è¯·æ±‚åˆ†ä¸ºPOSTè¯·æ±‚ã€GETè¯·æ±‚ã€‚ è‹¥ä¸ºPOSTè¯·æ±‚ï¼Œåˆ™éœ€è¦è¿›ä¸€æ­¥åˆ¤æ–­æ˜¯æ™®é€šæ•°æ®è¯·æ±‚ï¼Œè¿˜æ˜¯æ–‡ä»¶è¯·æ±‚ï¼Œå¹¶åˆ†åˆ«è¿›è¡Œå¤„ç†ã€‚ è€ŒGETè¯·æ±‚ï¼Œåªéœ€è¦å°†æ•°æ®ä¼ å…¥processDataæ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œåœ¨processDataæ–¹æ³•ä¸­ï¼ŒåŒºåˆ†GETè¯·æ±‚èŽ·å–æ•°æ®ï¼Œè¿˜æ˜¯èŽ·å–é™æ€æ–‡ä»¶ã€‚ 12345678910111213141516171819202122232425262728293031323334353637// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—...// å¼•å…¥æœåŠ¡å™¨é…ç½®...// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•...const server = http.createServer((req, res) =&gt; &#123; // è§£æžè¯·æ±‚æ•°æ® // èŽ·å–è¯·æ±‚è·¯å¾„åŠqueryæ•°æ® const method = req.method const &#123; pathname, query &#125; = url.parse(req.url, true) // å¤„ç†POSTè¯·æ±‚ if (method === 'POST') &#123; // POSTè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç† ... &#125; else &#123; // å¤„ç†GETè¯·æ±‚ // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯GETè¯·æ±‚ï¼Œåªæœ‰queryæ•°æ® processData(method, url, query, &#123;&#125;, &#123;&#125;) &#125; // é€šè¿‡è·¯ç”±å¤„ç†è¯·æ±‚æ•°æ®çš„å…¬å…±æ–¹æ³• async function processData(method, pathname, query, post, files) &#123; ... &#125;&#125;)// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at $&#123;HTTP_PORT&#125;`) 4. POSTè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç† åˆ¤æ–­è¯·æ±‚å¤´çš„content-typeä¸ºapplication/x-www-form-urlencodedæ—¶ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚åªæ˜¯å•çº¯ä¼ è¾“æ•°æ®ï¼Œå¯ä»¥ç›´æŽ¥å½“åšå­—ç¬¦ä¸²å¤„ç†ã€‚è‹¥è¯·æ±‚å¤´çš„content-typeä¸å¯¹ï¼Œåˆ™è¡¨ç¤ºè¯¥è¯·æ±‚æ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Œå¯ä»¥ç”¨multipartyè¿›è¡Œå¤„ç†ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—...// å¼•å…¥æœåŠ¡å™¨é…ç½®...// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•...const server = http.createServer((req, res) =&gt; &#123; // è§£æžè¯·æ±‚æ•°æ® // èŽ·å–è¯·æ±‚è·¯å¾„åŠqueryæ•°æ® const method = req.method const &#123; pathname, query &#125; = url.parse(req.url, true) // å¤„ç†POSTè¯·æ±‚ if (method === 'POST') &#123; // æ ¹æ®è¯·æ±‚å¤´çš„content-typeå±žæ€§å€¼ï¼ŒåŒºåˆ†æ˜¯æ™®é€šPOSTè¯·æ±‚ï¼Œè¿˜æ˜¯æ–‡ä»¶è¯·æ±‚ã€‚ // content-typeä¸ºapplication/x-www-form-urlencodedæ—¶ï¼Œè¡¨ç¤ºæ˜¯æ™®é€šPOSTè¯·æ±‚ // æ™®é€šPOSTè¯·æ±‚ç›´æŽ¥è¿›è¡Œå¤„ç†ï¼Œæ–‡ä»¶è¯·æ±‚ä½¿ç”¨multipartyå¤„ç† if (req.headers['content-type'].startsWith('application/x-www-form-urlencoded')) &#123; // æ™®é€šPOSTè¯·æ±‚ let arr = [] // å­˜å‚¨Bufferæ•°æ® // æŽ¥æ”¶æ•°æ® req.on('data', (buffer) =&gt; &#123; arr.push(buffer) &#125;) // æ•°æ®æŽ¥æ”¶å®Œæˆ req.on('end', () =&gt; &#123; const data = Buffer.concat(arr) // åˆå¹¶æŽ¥æ”¶åˆ°çš„æ•°æ® const post = querystring.parse(data.toString()) // å°†æŽ¥æ”¶åˆ°çš„æ•°æ®è½¬æ¢ä¸ºJSON // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯æ™®é€šPOSTè¯·æ±‚ï¼Œä¸å­˜åœ¨æ–‡ä»¶æ•°æ® processData(method, pathname, query, post, &#123;&#125;) &#125;) &#125; else &#123; // æ–‡ä»¶POSTè¯·æ±‚ const form = new Form(&#123; uploadDir: HTTP_UPLOAD // æŒ‡å®šæ–‡ä»¶å­˜å‚¨ç›®å½• &#125;) // å¤„ç†è¯·æ±‚æ•°æ® form.parse(req) let post = &#123;&#125; // å­˜å‚¨æ•°æ®å‚æ•° let files = &#123;&#125; // å­˜å‚¨æ–‡ä»¶æ•°æ® // é€šè¿‡fieldäº‹ä»¶å¤„ç†æ™®é€šæ•°æ® form.on('field', (name, value) =&gt; &#123; post[name] = value &#125;) // é€šè¿‡fileæ—¶é—´å¤„ç†æ–‡ä»¶æ•°æ® form.on('file', (name, file) =&gt; &#123; files[name] = file &#125;) // å¤„ç†é”™è¯¯ form.on('error', (error) =&gt; &#123; console.error(error) &#125;) // æ•°æ®ä¼ è¾“å®Œæˆæ—¶ï¼Œè§¦å‘closeäº‹ä»¶ form.on('close', () =&gt; &#123; // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯POSTæ–‡ä»¶è¯·æ±‚ï¼Œqueryã€postã€filesæ•°æ®éƒ½å­˜åœ¨ processData(method, pathname, query, post, files) &#125;) &#125; &#125; else &#123; // å¤„ç†GETè¯·æ±‚ // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯GETè¯·æ±‚ï¼Œåªæœ‰queryæ•°æ® processData(method, url, query, &#123;&#125;, &#123;&#125;) &#125; // é€šè¿‡è·¯ç”±å¤„ç†è¯·æ±‚æ•°æ®çš„å…¬å…±æ–¹æ³• async function processData(method, pathname, query, post, files) &#123; ... &#125;&#125;)// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at $&#123;HTTP_PORT&#125;`) 5. GETè¯·æ±‚åˆ†ä¸ºæ•°æ®è¯·æ±‚ã€è¯»å–æ–‡ä»¶è¯·æ±‚ï¼ŒåŒºåˆ†å¹¶è¿›è¡Œå¤„ç† GETè¯·æ±‚å¯ä»¥ç›´æŽ¥ç”¨processDataæ–¹æ³•ç»Ÿä¸€å¤„ç†ï¼Œè‹¥è·¯ç”±ä¸­æœªé…ç½®å¤„ç†æ•°æ®çš„æ–¹æ³•ï¼Œåˆ™è¡¨ç¤ºè¯¥è¯·æ±‚ä¸ºèŽ·å–é™æ€æ–‡ä»¶ï¼Œéœ€è¦è¿›è¡Œå•ç‹¬å¤„ç†ï¼Œå¦åˆ™åªéœ€è¦è°ƒç”¨è·¯ç”±é…ç½®çš„å›žè°ƒå‡½æ•°å¤„ç†å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879// å¼•å…¥åˆ›å»ºæœåŠ¡å™¨æ‰€éœ€çš„æ¨¡å—...// å¼•å…¥æœåŠ¡å™¨é…ç½®...// å¼•å…¥è·¯ç”±æ¨¡å—çš„æŸ¥æ‰¾è·¯ç”±æ–¹æ³•...const server = http.createServer((req, res) =&gt; &#123; // è§£æžè¯·æ±‚æ•°æ® // èŽ·å–è¯·æ±‚è·¯å¾„åŠqueryæ•°æ® const method = req.method const &#123; pathname, query &#125; = url.parse(req.url, true) // å¤„ç†POSTè¯·æ±‚ if (method === 'POST') &#123; ... &#125; else &#123; // å¤„ç†GETè¯·æ±‚ // é€šè¿‡è·¯ç”±å¤„ç†æ•°æ®ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯GETè¯·æ±‚ï¼Œåªæœ‰queryæ•°æ® processData(method, url, query, &#123;&#125;, &#123;&#125;) &#125; // é€šè¿‡è·¯ç”±å¤„ç†è¯·æ±‚æ•°æ®çš„å…¬å…±æ–¹æ³• async function processData(method, pathname, query, post, files) &#123; const callback = findRouter(method, pathname) // èŽ·å–å¤„ç†è¯·æ±‚çš„å›žè°ƒå‡½æ•° // è‹¥å›žè°ƒå‡½æ•°å­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºè·¯ç”±æœ‰é…ç½®ç›¸åº”çš„æ•°æ®å¤„ç†ï¼Œå³è¯¥è¯·æ±‚ä¸æ˜¯èŽ·å–é™æ€æ–‡ä»¶ã€‚ if (callback) &#123; try &#123; // æ ¹æ®è·¯ç”±å¤„ç†æŽ¥å£æ•°æ® await callback(res, query, post, files) &#125; catch (error) &#123; // å‡ºçŽ°é”™è¯¯çš„å¤„ç† res.writeHead(500) res.write('Internal Server Error') res.end() &#125; &#125; else &#123; // è‹¥å›žè°ƒå‡½æ•°ä¸å­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºè¯¥è¯·æ±‚ä¸ºè¯·æ±‚ä¸€ä¸ªé™æ€æ–‡ä»¶ï¼Œå¦‚htmlã€cssã€jsç­‰ const filePath = HTTP_ROOT + pathname // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ fs.stat(filePath, (error, stat) =&gt; &#123; if (error) &#123; // å‡ºçŽ°é”™è¯¯è¡¨ç¤ºæ–‡ä»¶ä¸å­˜åœ¨ res.writeHead(404) res.write('Not Found') res.end() &#125; else &#123; // æ–‡ä»¶å­˜åœ¨åˆ™è¿›è¡Œè¯»å– // åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚ const readStream = fs.createReadStream(filePath) // åˆ›å»ºä¸€ä¸ªGzipå¯¹è±¡ï¼Œç”¨äºŽå°†æ–‡ä»¶åŽ‹ç¼©æˆ const gz = zlib.createGzip() // å‘æµè§ˆå™¨å‘é€ç»è¿‡gzipåŽ‹ç¼©çš„æ–‡ä»¶ï¼Œè®¾ç½®å“åº”å¤´ï¼Œå¦åˆ™æµè§ˆå™¨æ— æ³•è¯†åˆ«ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œä¸‹è½½ã€‚ res.setHeader('content-encoding', 'gzip') // å°†è¯»å–çš„å†…å®¹ï¼Œé€šè¿‡gzipåŽ‹ç¼©ä¹‹åŽï¼Œåœ¨é€šè¿‡ç®¡é“æŽ¨é€åˆ°resä¸­ï¼Œç”±äºŽresç»§æ‰¿è‡ªStreamæµï¼Œå› æ­¤ä¹Ÿå¯ä»¥æŽ¥æ”¶ç®¡é“çš„æŽ¨é€ã€‚ readStream.pipe(gz).pipe(res) readStream.on('error', (error) =&gt; &#123; console.error(error) &#125;) &#125; &#125;) &#125; &#125;&#125;)// ç›‘å¬é…ç½®çš„ç«¯å£server.listen(HTTP_PORT)// æ‰“å°åˆ›å»ºæœåŠ¡å™¨æˆåŠŸä¿¡æ¯console.log(`Server started at $&#123;HTTP_PORT&#125;`) æµ‹è¯•æœåŠ¡å™¨åœ¨server.jsä¸­å¼•å…¥å°è£…çš„httpæ¨¡å—ï¼š 1const http = require('./lib/http') å†ä½¿ç”¨node server.jså¯åŠ¨æœåŠ¡å™¨ï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®http://localhost:8080/index.htmlï¼Œçœ‹åˆ°htmlé¡µé¢ æ·»åŠ å„æŽ¥å£è·¯ç”±é…ç½®èŽ·å–å•†å“åˆ—è¡¨è·¯ç”±å›žè°ƒå‡½æ•° æŸ¥è¯¢item_tableè¡¨ä¸­çš„å•†å“æ•°æ®åŽï¼Œè¿”å›žç»™å‰å°ï¼Œå¹¶å°†å›žè°ƒå‡½æ•°ä½œä¸ºæ¨¡å—å¯¼å‡ºã€‚ 1234567891011121314151617181920const connection = require('../lib/database')module.exports = async (res, query, post, files) =&gt; &#123; try &#123; // æŸ¥è¯¢å•†å“åˆ—è¡¨ const data = await connection.query(`SELECT * FROM item_table`) res.writeJson(&#123; error: 0, // errorä¸º0åˆ™è¡¨ç¤ºæŽ¥å£æ­£å¸¸ data // æŸ¥è¯¢åˆ°çš„å•†å“åˆ—è¡¨æ•°æ® &#125;) &#125; catch (error) &#123; console.error(error) res.writeJson(&#123; error: 1, // errorä¸º1åˆ™è¡¨ç¤ºæŽ¥å£å‡ºé”™ msg: 'æ•°æ®åº“å‡ºé”™' // æŽ¥å£çš„é”™è¯¯ä¿¡æ¯ &#125;) &#125; res.end()&#125; æ·»åŠ å•†å“è·¯ç”±å›žè°ƒå‡½æ•°åº”ç¦æ­¢queryè¯­å¥ä½¿ç”¨å¦‚ä¸‹å†™æ³•ï¼Œå®¹æ˜“é€ æˆæ³¨å…¥æ”»å‡»ã€‚connection.query(INSERT INTO item_table (title, price, count) VALUES(&#39;${title}, ${price} ${count}&#39;))æ­¤æ—¶è‹¥ç”¨æˆ·ä¼ å…¥å‚æ•°å¦‚ä¸‹ï¼š http://localhost:8080/add?title=a&#39;)%3B%20DELETE%20FROM%20item_table%3B%20SELECT%20(1&amp;price=19.8&amp;count=200 å°±ä¼šè®©æœåŠ¡å™¨æ‰§è¡Œä¸€ä¸ªè¿™æ ·çš„è¯­å¥ï¼š 1INSERT INTO item_table (title, price, count) VALUES('a'); DELETE FROM item_table; SELECT ('1', 19.8, 200) å…¶æ„ä¹‰ä¸ºï¼š 1.æ’å…¥ä¸€ä¸ªè™šå‡æ•°æ®2.åˆ é™¤item_tableè¡¨ä¸­æ‰€æœ‰æ•°æ®3.è¿”å›žä¸€ä¸ªè™šå‡æ•°æ® è¿™æ ·å°±ä¼šå¯¼è‡´item_tableè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®è¢«åˆ é™¤ã€‚ ä¸ºé˜²æ­¢æ³¨å…¥æ”»å‡»ï¼Œå¯ä»¥ä½¿ç”¨å ä½ç¬¦?ä»£æ›¿éœ€è¦æ’å…¥æ•°æ®åº“çš„å‚æ•°ï¼Œç¬¬äºŒä¸ªæ•°ç»„å‚æ•°ä¸­çš„3ä¸ªå€¼ä¼šæŒ‰é¡ºåºå¡«å……å ä½ç¬¦ï¼Œè¯¥æ–¹æ³•å¯ä»¥é¿å…å¤§éƒ¨åˆ†æ³¨å…¥æ”»å‡»ï¼Œå¦‚ä¸‹ï¼š 1await connection.query(`INSERT INTO item_table (title, price, count) VALUES(?,?,?)`, [title, price, count]) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546const connection = require('../lib/database')module.exports = async (res, query, post, files) =&gt; &#123; let &#123; title, price, count &#125; = post // åˆ¤æ–­æ˜¯å¦æœ‰ä¼ å‚ if (!title || !price || !count) &#123; res.writeJson(&#123; error: 1, msg: 'å‚æ•°ä¸åˆæ³•' &#125;) &#125; else &#123; // å°†ä»·æ ¼å’Œæ•°é‡è½¬ä¸ºæ•°å­— price = Number(price) count = Number(count) // åˆ¤æ–­ä»·æ ¼å’Œæ•°é‡æ˜¯å¦éžæ•°å­— if (isNaN(price) || isNaN(count)) &#123; res.writeJson(&#123; error: 1, msg: 'å‚æ•°ä¸åˆæ³•' &#125;) &#125; else &#123; try &#123; // ä½¿ç”¨å ä½ç¬¦?ä»£æ›¿éœ€è¦æ’å…¥æ•°æ®åº“çš„å‚æ•°ï¼Œç¬¬äºŒä¸ªæ•°ç»„å‚æ•°ä¸­çš„3ä¸ªå€¼ä¼šæŒ‰é¡ºåºå¡«å……å ä½ç¬¦ï¼Œè¯¥æ–¹æ³•å¯ä»¥é¿å…å¤§éƒ¨åˆ†æ³¨å…¥æ”»å‡»ã€‚ await connection.query(`INSERT INTO item_table (title, price, count) VALUES(?,?,?)`, [title, price, count]) res.writeJson(&#123; error: 0, msg: 'æ·»åŠ å•†å“æˆåŠŸ' &#125;) &#125; catch (error) &#123; console.error(error) res.writeJson(&#123; error: 1, msg: 'æ•°æ®åº“å†…éƒ¨é”™è¯¯' &#125;) &#125; &#125; &#125; res.end()&#125; åˆ é™¤å•†å“è·¯ç”±å›žè°ƒå‡½æ•°1234567891011121314151617181920const connection = require('../lib/database')module.exports = async (res, query, post, files) =&gt; &#123; const ID = query.id if (!ID) &#123; res.writeJson(&#123; error: 1, msg: 'å‚æ•°ä¸åˆæ³•' &#125;) &#125; else &#123; await connection.query(`DELETE FROM item_table WHERE ID=$&#123;ID&#125;`) res.writeJson(&#123; error: 0, msg: 'åˆ é™¤æˆåŠŸ' &#125;) &#125; res.end()&#125; æ·»åŠ å„æŽ¥å£è·¯ç”±é…ç½®åœ¨/router/index.jsä¸­ï¼Œå¼•ç”¨å„ä¸ªæŽ¥å£çš„é…ç½®ï¼Œå¹¶ç”¨addRouteræ–¹æ³•æ·»åŠ åˆ°è·¯ç”±è¡¨ä¸­ï¼Œå³å¯åœ¨æŽ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼ŒæŸ¥æ‰¾è·¯ç”±å¹¶è¿›è¡Œå¤„ç†ã€‚ 123456789101112const &#123; addRouter&#125; = require('../lib/router')// æ·»åŠ èŽ·å–å•†å“åˆ—è¡¨æŽ¥å£addRouter('get', '/list', require('./list'))// æ·»åŠ å•†å“æŽ¥å£addRouter('post', '/add', require('./add'))// åˆ é™¤å•†å“æŽ¥å£addRouter('get', '/del', require('./del')) åœ¨ä¸»æ¨¡å—ä¸­å¼•ç”¨è·¯ç”±åœ¨/server.jsä¸­ï¼Œå¼•ç”¨routeræ¨¡å—ï¼Œå°±å¯ä»¥å®Œæˆæ•´ä¸ªæœåŠ¡ç«¯çš„é…ç½®ã€‚ 123const connection = require('./lib/database')const http = require('./lib/http')const router = require('./router') å®Œæˆå‰ç«¯åŠŸèƒ½åœ¨/static/index.htmlä¸­ï¼Œä½¿ç”¨jqueryä¸ºå‰ç«¯é¡µé¢å®žçŽ°å¦‚ä¸‹åŠŸèƒ½ï¼š 1.æ˜¾ç¤ºå•†å“åˆ—è¡¨2.æ·»åŠ éšæœºåç§°ã€ä»·æ ¼ã€åº“å­˜çš„å•†å“3.åˆ é™¤å¯¹åº”å•†å“ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455// æŸ¥è¯¢å•†å“åˆ—è¡¨çš„æ–¹æ³•function getList() &#123; $.ajax(&#123; url: '/list', dataType: 'json' &#125;).then(res =&gt; &#123; let html = `` res.data.forEach((item, index) =&gt; &#123; html += ( ` &lt;tr&gt; &lt;td&gt;$&#123;item.title&#125;&lt;/td&gt; &lt;td&gt;ï¿¥$&#123;item.price&#125;&lt;/td&gt; &lt;td&gt;$&#123;item.count&#125;&lt;/td&gt; &lt;td&gt; &lt;a data-id="$&#123;item.ID&#125;" href="#" class="glyphicon glyphicon-trash"&gt;åˆ é™¤&lt;/a&gt; &lt;/td&gt; &lt;/tr&gt; ` ) &#125;) $('tbody').html(html) &#125;);&#125; getList()// ç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œéšæœºæ·»åŠ ä¸€ä¸ªå•†å“$('#addBtn').on('click', function () &#123; $.ajax(&#123; url: '/add', method: 'post', data: &#123; title: `test$&#123;Math.floor(Math.random() * 100)&#125;`, price: Math.floor(Math.random() * 100), count: Math.floor(Math.random() * 100) &#125; &#125;) .then((response) =&gt; &#123; getList() &#125;)&#125;)// ç‚¹å‡»åˆ é™¤æŒ‰é’®$('tbody').on('click', 'a', function () &#123; $.ajax(&#123; url: '/del', data: &#123; id: $(this).attr('data-id') &#125; &#125;) .then((response) =&gt; &#123; getList() &#125;)&#125;)]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (åä¸‰) --Streamæµ]]></title>
    <url>%2F2019%2F05%2F06%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E5%8D%81%E4%B8%89)%20--Stream%E6%B5%81%2F</url>
    <content type="text"><![CDATA[File Systemçš„é—®é¢˜æˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨File Systemæ¨¡å—å¯¹æ–‡ä»¶è¿›è¡Œè¯»å–ï¼Œå¦‚ä¸‹ï¼š 12345678fs.readFile('./test.txt', (error, buffer) =&gt; &#123; if (error) &#123; console.error(error) &#125; else &#123; // è¯»å–æ–‡ä»¶æˆåŠŸ res.write(buffer) &#125;&#125;) è¿™æ ·æ“ä½œç®€å•æœ‰æ•ˆï¼Œä½†è¿™ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼š 1.å ç”¨å†…å­˜ä½¿ç”¨fsè¯»å–æ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€æ¬¡æ€§å°†æ–‡ä»¶çš„æ‰€æœ‰å†…å®¹è¯»å–åˆ°å†…å­˜ä¸­ï¼Œå†ä¸€æ¬¡æ€§å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œå› æ­¤ä¼šå ç”¨å¤§é‡å†…å­˜ã€‚ 2.èµ„æºä½¿ç”¨æ•ˆçŽ‡ä½Žä»Žç£ç›˜è¯»å–æ–‡ä»¶æœŸé—´ï¼Œç£ç›˜å¤„äºŽå¿™ç¢ŒçŠ¶æ€ï¼Œè€Œç½‘ç»œå¤„äºŽç©ºé—²çŠ¶æ€ã€‚ç£ç›˜è¯»å–å®ŒæˆåŽï¼Œå¼€å§‹å‘é€æ–‡ä»¶æ—¶ï¼Œæƒ…å†µæ­£ç›¸åï¼Œç½‘ç»œå¤„äºŽå¿™ç¢ŒçŠ¶æ€ï¼Œæ­¤æ—¶ç£ç›˜å´å¤„äºŽç©ºé—²çŠ¶æ€ Streamæµç›¸æ¯”File Systemï¼ŒStreamæµè¯»å–æ–‡ä»¶æ˜¯è¯»ä¸€ä»½ï¼Œå‘ä¸€ä»½ï¼ŒStreamæµçš„å†™å…¥æ“ä½œä¹Ÿæœ‰åŒæ ·ç‰¹ç‚¹ï¼Œå› æ­¤å¯ä»¥è§£å†³File Systemåœ¨ä¸Šé¢æåˆ°çš„2ä¸ªé—®é¢˜ã€‚ æŽ¥ä¸‹æ¥å®žçŽ°ä¸€ä¸ªç®€å•çš„æµï¼Œå°†1.txtæ–‡ä»¶çš„å†…å®¹å†™å…¥åˆ°2.txtä¸­ï¼š 1234567891011121314151617181920const fs = require('fs')// åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚const readStream = fs.createReadStream('./1.txt')// åˆ›å»ºä¸€ä¸ªå¯å†™æµã€‚const writeStream = fs.createWriteStream('./2.txt')// å°†å¯è¯»æµè¯»å–çš„æ•°æ®ï¼Œé€šè¿‡ç®¡é“pipeæŽ¨é€åˆ°å†™å…¥æµä¸­ï¼Œå³å¯å°†1.txtçš„å†…å®¹ï¼Œå†™å…¥åˆ°2.txtä¸­ã€‚readStream.pipe(writeStream)// è¯»å–å‡ºçŽ°é”™è¯¯æ—¶ä¼šè§¦å‘erroräº‹ä»¶ã€‚readStream.on('error', (error) =&gt; &#123; console.error(error)&#125;)// å†™å…¥å®Œæˆæ—¶ï¼Œè§¦å‘finishäº‹ä»¶ã€‚writeStream.on('finish', () =&gt; &#123; console.log('finish')&#125;) ä½¿ç”¨ZlibåŽ‹ç¼©æ–‡ä»¶å¯ä»¥ä½¿ç”¨Zlibæ¨¡å—ï¼Œé…åˆStreamæµï¼Œå®žçŽ°æ–‡ä»¶åŽ‹ç¼©åŠŸèƒ½ï¼Œå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526const fs = require('fs')// å¼•å…¥zlibæ¨¡å—ï¼Œç”¨äºŽå®žçŽ°åŽ‹ç¼©åŠŸèƒ½const zlib = require('zlib')// åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚const readStream = fs.createReadStream('./google.jpg')// åˆ›å»ºä¸€ä¸ªå¯å†™æµã€‚const writeStream = fs.createWriteStream('./google.jpg.gz')// åˆ›å»ºä¸€ä¸ªGzipå¯¹è±¡ï¼Œç”¨äºŽå°†æ–‡ä»¶åŽ‹ç¼©æˆ.gzæ–‡ä»¶const gzip = zlib.createGzip()// å°†å¯è¯»æµè¯»å–çš„æ•°æ®ï¼Œå…ˆé€šè¿‡ç®¡é“pipeæŽ¨é€åˆ°gzipä¸­ï¼Œå†æŽ¨é€åˆ°å†™å…¥æµä¸­ã€‚// ä¹Ÿå°±æ˜¯å…ˆå°†å¯è¯»æµçš„æ•°æ®åŽ‹ç¼©ï¼Œå†æŽ¨é€åˆ°å¯å†™æµä¸­ã€‚readStream.pipe(gzip).pipe(writeStream)// è¯»å–å‡ºçŽ°é”™è¯¯æ—¶ä¼šè§¦å‘erroräº‹ä»¶ã€‚readStream.on('error', (error) =&gt; &#123; console.error(error)&#125;)// å†™å…¥å®Œæˆæ—¶ï¼Œè§¦å‘finishäº‹ä»¶ã€‚writeStream.on('finish', () =&gt; &#123; console.log('finish')&#125;) ä½¿ç”¨æµä¼ è¾“æ–‡ä»¶åˆ°å‰å°å­¦ä¹ äº†æµï¼Œæˆ‘ä»¬å°±å¯ä»¥æ›´åŠ é«˜æ•ˆåœ°å°†æ–‡ä»¶ä¼ è¾“åˆ°å‰å°ï¼š 1234567891011121314151617181920212223242526272829const http = require('http')const zlib = require('zlib')const url = require('url')const fs = require('fs')const server = http.createServer((req, res) =&gt; &#123; const &#123; pathname &#125; = url.parse(req.url, true)// åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚ const readStream = fs.createReadStream(`./$&#123;pathname&#125;`) // åˆ›å»ºä¸€ä¸ªGzipå¯¹è±¡ï¼Œç”¨äºŽå°†æ–‡ä»¶åŽ‹ç¼©æˆ.gzæ–‡ä»¶ const gzip = zlib.createGzip() // å°†è¯»å–çš„å†…å®¹ï¼Œåœ¨é€šè¿‡ç®¡é“æŽ¨é€åˆ°resä¸­ï¼Œè¯¥æ–¹æ³•ä¸ç»è¿‡åŽ‹ç¼© readStream.pipe(res) // å¤„ç†å¯è¯»æµæŠ¥é”™ï¼Œé˜²æ­¢è¯·æ±‚ä¸å­˜åœ¨çš„æ–‡ä»¶ readStream.on('error', (error) =&gt; &#123; console.error(error); res.writeHead(404) res.write('Not Found') res.end() &#125;)&#125;)server.listen(8080) ä½†å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œè™½ç„¶å®žçŽ°äº†ä½¿ç”¨æµä¼ è¾“æ–‡ä»¶ï¼Œä½†å¹¶æ²¡æœ‰ç”¨åˆ°gzipåŽ‹ç¼©ï¼Œåœ¨ä¼ è¾“æ—¶è¿˜æ˜¯æ›´å¤šåœ°æ¶ˆè€—ç½‘ç»œèµ„æºï¼ŒæŽ¥ä¸‹æ¥å¯ä»¥å¼•å…¥gzipåŽ‹ç¼©ã€‚ æ–‡ä»¶ç»è¿‡gzipåŽ‹ç¼©åŽä¼ è¾“åˆ°å‰å°ä½†æ­¤æ—¶å¦‚æžœåªæ˜¯ç®€å•çš„ç”¨readStream.pipe(gzip).pipe(res)ä¼ è¾“æ–‡ä»¶ï¼Œæµè§ˆå™¨åœ¨è®¿é—®æ—¶æ— æ³•ç›´æŽ¥æ‰“å¼€ï¼Œè€Œæ˜¯ä¼šè§¦å‘æ–‡ä»¶ä¸‹è½½ã€‚è¿™æ˜¯å› ä¸ºæœªè®¾ç½®è¯·æ±‚å¤´å±žæ€§content-encodingçš„å€¼ï¼Œå¯¼è‡´æµè§ˆå™¨æ— æ³•è¯†åˆ«ç”¨gzipåŽ‹ç¼©è¿‡çš„æ–‡ä»¶ï¼Œè¿™å°±éœ€è¦ä¿®æ”¹è¯·æ±‚å¤´res.setHeader(&#39;content-encoding&#39;, &#39;gzip&#39;)ï¼Œè®©æµè§ˆå™¨å¯ä»¥è¯†åˆ«ã€‚ è¿™æ ·æµè§ˆå™¨å°±å¯ä»¥æ­£å¸¸æ‰“å¼€æ–‡ä»¶äº†ï¼Œä½†è‹¥æµè§ˆå™¨è®¿é—®çš„æ˜¯ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œæµè§ˆå™¨ä¼šæŠ¥é”™â€œæ— æ³•è®¿é—®æ­¤ç½‘ç«™â€ï¼Œè¿™æ˜¯å› ä¸ºè¯·æ±‚å¤´å±žæ€§content-encodingå·²è¢«è®¾ç½®ä¸ºgzipï¼Œä½†æœåŠ¡ç«¯ä¼ ç»™æµè§ˆå™¨çš„æ˜¯Not Foundå­—ç¬¦ä¸²ï¼Œæµè§ˆå™¨æ— æ³•è¯†åˆ«ã€‚ æ­¤æ—¶å¯ä»¥ä½¿ç”¨fs.statæ–¹æ³•ï¼Œå…ˆæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™è¿”å›žNot Foundï¼Œè‹¥å­˜åœ¨åˆ™ç»§ç»­ä¼ è¾“ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546const http = require('http')const zlib = require('zlib')const url = require('url')const fs = require('fs')const server = http.createServer((req, res) =&gt; &#123; const &#123; pathname &#125; = url.parse(req.url, true) // æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ const filepath = `./$&#123;pathname&#125;` // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ fs.stat(filepath, (error, stat) =&gt; &#123; if (error) &#123; console.error(error); res.setHeader('content-encoding', 'identity') res.writeHead(404) res.write('Not Found') res.end() &#125; else &#123; // åˆ›å»ºä¸€ä¸ªå¯è¯»æµã€‚ const readStream = fs.createReadStream(filepath) // åˆ›å»ºä¸€ä¸ªGzipå¯¹è±¡ï¼Œç”¨äºŽå°†æ–‡ä»¶åŽ‹ç¼©æˆ.gzæ–‡ä»¶ const gzip = zlib.createGzip() // å‘æµè§ˆå™¨å‘é€ç»è¿‡gzipåŽ‹ç¼©çš„æ–‡ä»¶ï¼Œè®¾ç½®å“åº”å¤´ï¼Œå¦åˆ™æµè§ˆå™¨æ— æ³•è¯†åˆ«ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œä¸‹è½½ã€‚ res.setHeader('content-encoding', 'gzip') // å°†è¯»å–çš„å†…å®¹ï¼Œé€šè¿‡gzipåŽ‹ç¼©ä¹‹åŽï¼Œåœ¨é€šè¿‡ç®¡é“æŽ¨é€åˆ°resä¸­ï¼Œç”±äºŽresç»§æ‰¿è‡ªStreamæµï¼Œå› æ­¤ä¹Ÿå¯ä»¥æŽ¥æ”¶ç®¡é“çš„æŽ¨é€ã€‚ readStream.pipe(gzip).pipe(res) // å¤„ç†å¯è¯»æµæŠ¥é”™ï¼Œé˜²æ­¢æ–‡ä»¶ä¸­é€”è¢«åˆ é™¤æˆ–å‡ºé”™ï¼Œå¯¼è‡´æŠ¥é”™ã€‚ readStream.on('error', (error) =&gt; &#123; console.error(error); res.setHeader('content-encoding', 'identity') res.writeHead(404) res.write('Not Found') res.end() &#125;) &#125; &#125;)&#125;)server.listen(8080) å¯åŠ¨å™¨å¸¸ç”¨çš„å¯åŠ¨å™¨æœ‰foreverã€pm2ç­‰ï¼Œå®ƒä»¬ä¸»è¦ç”¨åœ¨é¡¹ç›®éƒ¨ç½²é˜¶æ®µ 1.ä½¿åº”ç”¨ä¸é—´æ–­è¿è¡Œï¼Œå¦‚æžœä¸ä½¿ç”¨å¯åŠ¨å™¨ï¼Œå‘½ä»¤è¡Œçª—å£ä¸€æ—¦å…³é—­ï¼Œæˆ–è€…å‡ºçŽ°æŠ¥é”™ï¼Œåº”ç”¨å°±ä¼šåœæ­¢è¿è¡Œï¼Œå¯åŠ¨å™¨ä¼šå¸®åŠ©åº”ç”¨è‡ªåŠ¨é‡å¯ã€‚2.è‹¥å‡ºçŽ°æœåŠ¡å™¨é‡å¯ï¼Œå¯åŠ¨å™¨ä¼šè‡ªåŠ¨å¯åŠ¨åº”ç”¨ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ“ä½œã€‚ å¸¸ç”¨çš„å¯åŠ¨å™¨æœ‰foreverã€pm2ç­‰ï¼ŒæŽ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹foreverçš„ä½¿ç”¨ã€‚ foreverforeveræ–‡æ¡£å¯å‚è€ƒï¼šgithub.com/foreverjs/fâ€¦ ä½¿ç”¨foreverå¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼š å®‰è£…foreverï¼šnpm install forever -g åœ¨å‘½ä»¤è¡Œè¿è¡Œforever start server.jsï¼Œæ›¿ä»£node server.jså‘½ä»¤ã€‚ å‘½ä»¤è¡Œçª—å£æç¤ºinfo: Forever processing file: server.jsï¼Œè¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼Œæ­¤æ—¶å¦‚æžœå°†çª—å£å…³é—­ï¼Œåº”ç”¨ç…§æ ·å¯ä»¥è®¿é—®ã€‚ å¦‚æžœéœ€è¦å…³é—­æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œforever stop server.jsã€‚è¿˜æœ‰ä¸€ä¸ªå‘½ä»¤æ˜¯forever stopallï¼Œåœæ­¢å…¨éƒ¨åœ¨è¿è¡Œçš„ä»»åŠ¡ï¼Œä½†ä½¿ç”¨è¦æ…Žé‡ã€‚ foreverå¯åŠ¨æ—¶ï¼Œè¿˜å¯ä»¥æ·»åŠ ä¸€äº›é…ç½®ï¼Œä¾‹å¦‚forever start xxx.js -l c:/xxx.log -e c:/xxx_err.log -aï¼Œforever start xxx.jsè¡¨ç¤ºå¯åŠ¨xxx.jsã€‚ -l c:/xxx.logè¡¨ç¤ºå°†logä¿¡æ¯è¾“å‡ºåˆ°c:/xxx.logæ–‡ä»¶ã€‚-e c:/xxx_err.logè¡¨ç¤ºå°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°c:/xxx_err.logæ–‡ä»¶ã€‚-a è¡¨ç¤ºæ–°çš„æ—¥å¿—æ·»åŠ åˆ°æ—§æ—¥å¿—ä¹‹åŽï¼Œå³ä¿ç•™æ—§æ—¥å¿—ã€‚]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (åäºŒ) --ä½¿ç”¨async/awaitå¼‚æ­¥æ“ä½œæ•°æ®åº“]]></title>
    <url>%2F2019%2F04%2F29%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E5%8D%81%E4%BA%8C)%20--%E4%BD%BF%E7%94%A8async-await%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%2F</url>
    <content type="text"><![CDATA[ä¸Šä¸€ç¯‡ä½¿ç”¨Node.jsæ“ä½œæ•°æ®åº“ï¼Œè™½ç„¶èƒ½å®žçŽ°åŠŸèƒ½ï¼Œä½†æ˜¯å¼‚æ­¥æ“ä½œéœ€è¦ä¸æ–­å†™å›žè°ƒå‡½æ•°ï¼Œä»£ç ä¸¥é‡å†—ä½™ï¼Œè€Œä¸”é˜…è¯»å›°éš¾ã€‚ å¯ä»¥ä½¿ç”¨co-mysqlï¼Œå°†queryæ–¹æ³•è¯¥å†™ä¸ºè¿”å›žä¸€ä¸ªPromiseï¼Œå°±å¯ä»¥ä½¿ç”¨async/awaitè¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚ æˆ‘ä»¬å¯ä»¥å‚è€ƒä¸€ä¸‹å®ƒçš„æºç ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å®žçŽ°å°†å›žè°ƒå‡½æ•°è½¬æ¢ä¸º 1234567891011121314151617181920212223242526272829303132333435363738394041424344module.exports = wrapper;var slice = [].slice;// è¯¥æ¨¡å—å¯¼å‡ºä¸ºä¸€ä¸ªåŒ…è£…å‡½æ•°ï¼Œè¿è¡Œå®ƒçš„è¿”å›žå€¼æ˜¯ä¸€ä¸ªå¸¦æœ‰queryæ–¹æ³•çš„å¯¹è±¡ã€‚function wrapper(client) &#123; // clientå³ä¸ºmysql.createPoolæˆ–mysql.createConnectionæ–¹æ³•åˆ›å»ºçš„è¿žæŽ¥å¯¹è±¡ã€‚ var query = client.query; var o = &#123;&#125;; o.query = function () &#123; // æå–è°ƒç”¨queryæ–¹æ³•æ—¶ï¼Œä¼ å…¥çš„æ‰€æœ‰å‚æ•°ï¼Œå°†å…¶å­˜å…¥ä¸€ä¸ªæ•°ç»„ã€‚ var args = slice.call(arguments); // åˆ›å»ºä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå®ƒå°†ä½œä¸ºo.queryçš„è¿”å›žå€¼ï¼Œè®©å…¶æ”¯æŒasync/awaitæ–¹å¼è°ƒç”¨ã€‚ var p = new Promise(function (resolve, reject) &#123; // ä¸ºargså¢žåŠ ä¸€ä¸ªå›žè°ƒå‡½æ•°ï¼Œå®ƒå°†ä½œä¸ºclient.queryæ–¹æ³•çš„å›žè°ƒå‡½æ•°è¿è¡Œï¼Œå®ƒæŽ¥æ”¶åˆ°ç»“æžœæ—¶ï¼Œå°†è¿›è¡Œåˆ¤æ–­è¿è¡Œrejectè¿˜æ˜¯resolve args.push(function (err, rows) &#123; if (err) &#123; reject(err); &#125; else &#123; resolve(rows); &#125; &#125;); // ç”¨applyæ–¹æ³•ï¼Œå°†o.queryæŽ¥æ”¶åˆ°çš„å‚æ•°éƒ½ä¼ ç»™client.queryï¼Œå®ƒå¯ä»¥ç­‰åŒäºŽ /* client.query(args[0], function(err, rows) &#123; if (err) &#123; reject(err); &#125; else &#123; resolve(rows); &#125; &#125;) */ query.apply(client, args); &#125;); return p; &#125;; return o;&#125; äºŽæ˜¯ä¸Šä¸€ç¯‡çš„ä»£ç å¯ä»¥è¿›è¡Œå¦‚ä¸‹ä¼˜åŒ–ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165const http = require('http')const url = require('url')const fs = require('fs')const mysql = require('mysql')const coMysql = require('co-mysql')// 1. è¿žæŽ¥æœåŠ¡å™¨const pool = mysql.createPool(&#123; connectionLimit: 10, // å»ºç«‹çš„è¿žæŽ¥æ•°é‡ï¼Œé»˜è®¤ä¸º10ä¸ª host: 'localhost', // åœ°å€ port: 3306, // ç«¯å£ï¼Œä¸ä¼ åˆ™é»˜è®¤3306 user: 'root', // ç™»å½•å password: '', // å¯†ç  database: 'test' // è¿žæŽ¥çš„æ•°æ®åº“&#125;)const connection = coMysql(pool)/* const username = 'lily'const password = '888888'// å‘æ•°æ®åº“ä¸­æ’å…¥æ•°æ®connection.query(`INSERT INTO user_table (username, password) VALUES ('$&#123;username&#125;', '$&#123;password&#125;')`, (err, data) =&gt; &#123; if (err) &#123; console.error(err) &#125; else &#123; console.log(data) &#125;&#125;)// æŸ¥è¯¢user_tableè¡¨çš„æ•°æ®connection.query(`SELECT * FROM User_table`, (err, data) =&gt; &#123; if (err) &#123; console.error(err) &#125; else &#123; console.log(data) &#125;&#125;) */// more// 2. ä¸ŽHTTPæ¨¡å—é…åˆä½¿ç”¨const server = http.createServer(async (req, res) =&gt; &#123; const &#123; pathname, query &#125; = url.parse(req.url, true) if (pathname === '/reg') &#123; // èŽ·å–getè¯·æ±‚æ•°æ® const &#123; username, password &#125; = query // æ ¡éªŒå‚æ•°æ˜¯å¦æ­£ç¡® if (!username || !password) &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'ç”¨æˆ·åæˆ–å¯†ç ä¸å¯ä¸ºç©º' &#125;)) res.end() &#125; else if (username.length &gt; 32) &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'ç”¨æˆ·åçš„é•¿åº¦ä¸å¯è¶…è¿‡32ä½' &#125;)) res.end() &#125; else if (password.length &gt; 32) &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'å¯†ç çš„é•¿åº¦ä¸å¯è¶…è¿‡32ä½' &#125;)) res.end() &#125; else &#123; // æ ¡éªŒé€šè¿‡ï¼Œå¼€å§‹æ³¨å†Œæµç¨‹ try &#123; // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨ const data = await connection.query(`SELECT ID FROM User_table WHERE username='$&#123;username&#125;'`) if (data.length) &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'æ­¤ç”¨æˆ·åå·²è¢«å ç”¨' &#125;)) &#125; else &#123; // å°†ç”¨æˆ·åå’Œå¯†ç æ’å…¥æ•°æ®åº“ await connection.query(`INSERT INTO userddd_table (username, password) VALUES('$&#123;username&#125;', '$&#123;password&#125;')`) res.write(JSON.stringify(&#123; error: 0, msg: 'æ³¨å†ŒæˆåŠŸ' &#125;)) &#125; &#125; catch (error) &#123; console.error(error) res.writeHead(500) &#125; res.end() &#125; &#125; else if (pathname === '/login') &#123; let arr = [] req.on('data', (buffer) =&gt; &#123; // èŽ·å–POSTè¯·æ±‚çš„Bufferæ•°æ® arr.push(buffer) &#125;) req.on('end', async () =&gt; &#123; // å°†Bufferæ•°æ®åˆå¹¶ let buffer = Buffer.concat(arr) // å¤„ç†æŽ¥æ”¶åˆ°çš„POSTæ•°æ® const post = JSON.parse(buffer.toString()) // èŽ·å–postè¯·æ±‚æ•°æ® const &#123; username, password &#125; = post try &#123; // æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ const data = await connection.query(`SELECT username, password FROM User_table WHERE username='$&#123;username&#125;'`) if (!data.length) &#123; // ç”¨æˆ·ä¸å­˜åœ¨ res.write(JSON.stringify(&#123; error: 1, msg: 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯' &#125;)) &#125; else if (data[0].password !== password) &#123; // å¯†ç ä¸æ­£ç¡® res.write(JSON.stringify(&#123; error: 1, msg: 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯' &#125;)) &#125; else &#123; res.write(JSON.stringify(&#123; error: 0, msg: 'ç™»å½•æˆåŠŸ' &#125;)) &#125; &#125; catch (error) &#123; console.error(error) res.writeHead(500) &#125; res.end() &#125;) &#125; else &#123; // è‹¥è¯·æ±‚ä¸ä¸ºæŽ¥å£ï¼Œåˆ™é»˜è®¤ä¸ºè¯·æ±‚æ–‡ä»¶ if (pathname !== '/favicon.ico') &#123; fs.readFile(`.$&#123;pathname&#125;`, (err, buffer) =&gt; &#123; if (err) &#123; res.writeHead(404) &#125; else &#123; res.write(buffer) &#125; res.end() &#125;) &#125; else &#123; res.writeHead(404) res.end() &#125; &#125;&#125;)server.listen(8080)]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (åä¸€) --ä½¿ç”¨Nodejsæ“ä½œæ•°æ®åº“]]></title>
    <url>%2F2019%2F04%2F21%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E5%8D%81%E4%B8%80%EF%BC%89--%E4%BD%BF%E7%94%A8Nodejs%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%2F</url>
    <content type="text"><![CDATA[Nodejsæ“ä½œæ•°æ®åº“Nodejsæ“ä½œæ•°æ®åº“éœ€è¦ç”¨åˆ°mysqlæ¨¡å—ï¼Œé€šè¿‡npm i mysql -Dè¿›è¡Œå®‰è£…ã€‚ ä¹‹åŽå¯ä»¥é€šè¿‡mysql.createConnectionæ–¹æ³•æ–°å»ºä¸€ä¸ªæ•°æ®åº“è¿žæŽ¥ï¼Œéœ€è¦ä¼ å…¥çš„å‚æ•°æœ‰åœ°å€ã€ç«¯å£ã€ç™»å½•åã€å¯†ç ï¼Œä»¥åŠéœ€è¦è¿žæŽ¥çš„æ•°æ®åº“ã€‚ mysql.createConnectionä¼šè¿”å›žä¸€ä¸ªconnectionå¯¹è±¡ï¼Œå¯ä½¿ç”¨connection.queryæ–¹æ³•ï¼Œä¼ å…¥SQLè¯­å¥ï¼Œå¯¹æ•°æ®åº“è¿›è¡Œç›¸åº”æ“ä½œã€‚ 12345678910111213141516171819202122232425262728293031const mysql = require('mysql')// 1. è¿žæŽ¥æœåŠ¡å™¨const connection = mysql.createConnection(&#123; host: 'localhost', // åœ°å€ port: 3306, // ç«¯å£ï¼Œä¸ä¼ åˆ™é»˜è®¤3306 user: 'root', // ç™»å½•å password: '', // å¯†ç  database: 'test' // è¿žæŽ¥çš„æ•°æ®åº“&#125;)const username = 'zzz'const password = '888888'// å‘æ•°æ®åº“ä¸­æ’å…¥æ•°æ®connection.query(`INSERT INTO user_table (username, password) VALUES ('$&#123;username&#125;', '$&#123;password&#125;')`, (err, data) =&gt; &#123; if (err) &#123; console.error(err) &#125; else &#123; console.log(data) &#125;&#125;)// æŸ¥è¯¢user_tableè¡¨çš„æ•°æ®db.query(`SELECT * FROM User_table`, (err, data) =&gt; &#123; if (err) &#123; console.error(err) &#125; else &#123; console.log(data) &#125;&#125;) INSERTè¯­å¥çš„æ‰“å°çš„æ˜¯æ’å…¥ç»“æžœï¼š 123456789OkPacket &#123; fieldCount: 0, affectedRows: 1, insertId: 8, // è¿”å›žäº†å½“å‰æ’å…¥è¯­å¥çš„idï¼Œå¯ä»¥ç”¨æ¥å‘ŠçŸ¥å‰ç«¯æ’å…¥æ•°æ®çš„id serverStatus: 2, warningCount: 0, message: '', protocol41: true, changedRows: 0 &#125; SELECTè¯­å¥çš„æ‰“å°ç»“æžœä¸ºæŸ¥è¯¢åˆ°çš„æ‰€æœ‰æ•°æ®ï¼š 123[ RowDataPacket &#123; ID: 1, username: 'lee', password: '123456' &#125;, RowDataPacket &#123; ID: 3, username: 'chen', password: '654321' &#125;, RowDataPacket &#123; ID: 8, username: 'zzz', password: '888888' &#125; ] ä½†mysql.createConnectionæ–¹æ³•æœ‰ä¸€ä¸ªç¼ºé™·ï¼Œå°±æ˜¯å®ƒä¸€æ¬¡åªèƒ½åˆ›å»ºä¸€ä¸ªè¿žæŽ¥ï¼Œä¸€æ—¦æœ‰å¤šä¸ªç”¨æˆ·åŒæ—¶è¯·æ±‚ï¼Œå°±ä¼šé€ æˆè¯·æ±‚æŽ’é˜Ÿç­‰å¾…ã€‚ å› æ­¤ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå¯ä»¥æ”¹ç”¨mysql.createPoolæ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªè¿žæŽ¥æ± ï¼Œå®ƒå¯ä»¥åˆ›å»ºnä¸ªä¸ŽæœåŠ¡å™¨ä¹‹é—´çš„è¿žæŽ¥ï¼Œéœ€è¦ä½¿ç”¨æ—¶ï¼Œå¯ä»¥è‡ªåŠ¨ä»Žä¸­é€‰å–ä¸€ä¸ªç©ºé—²çš„è¿žæŽ¥ä½¿ç”¨ã€‚ 12345678const connection = mysql.createPool(&#123; connectionLimit: 10, // å»ºç«‹çš„è¿žæŽ¥æ•°é‡ï¼Œé»˜è®¤ä¸º10ä¸ª host: 'localhost', // åœ°å€ port: 3306, // ç«¯å£ï¼Œä¸ä¼ åˆ™é»˜è®¤3306 user: 'root', // ç™»å½•å password: '', // å¯†ç  database: 'test' // è¿žæŽ¥çš„æ•°æ®åº“&#125;) ä¸ŽHTTPæ¨¡å—é…åˆå®žçŽ°æŽ¥å£å®Œæˆäº†åŸºæœ¬æ“ä½œåŽï¼Œå°±å¯ä»¥å®žçŽ°ä¸€ä¸ªå®Œæ•´çš„æ³¨å†Œã€ç™»å½•æµç¨‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144const http = require('http')const url = require('url')const fs = require('fs')const mysql = require('mysql')// 1. è¿žæŽ¥æœåŠ¡å™¨const connection = mysql.createPool(&#123; connectionLimit: 10, // å»ºç«‹çš„è¿žæŽ¥æ•°é‡ï¼Œé»˜è®¤ä¸º10ä¸ª host: 'localhost', // åœ°å€ port: 3306, // ç«¯å£ï¼Œä¸ä¼ åˆ™é»˜è®¤3306 user: 'root', // ç™»å½•å password: '', // å¯†ç  database: 'test' // è¿žæŽ¥çš„æ•°æ®åº“&#125;)// 2. ä¸ŽHTTPæ¨¡å—é…åˆä½¿ç”¨const server = http.createServer((req, res) =&gt; &#123; const &#123; pathname, query &#125; = url.parse(req.url, true) if (pathname === '/reg') &#123; // èŽ·å–getè¯·æ±‚æ•°æ® const &#123; username, password &#125; = query // æ ¡éªŒå‚æ•°æ˜¯å¦æ­£ç¡® if (!username || !password) &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'ç”¨æˆ·åæˆ–å¯†ç ä¸å¯ä¸ºç©º' &#125;)) res.end() &#125; else if (username.length &gt; 32) &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'ç”¨æˆ·åçš„é•¿åº¦ä¸å¯è¶…è¿‡32ä½' &#125;)) res.end() &#125; else if (password.length &gt; 32) &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'å¯†ç çš„é•¿åº¦ä¸å¯è¶…è¿‡32ä½' &#125;)) &#125; else &#123; // æ ¡éªŒé€šè¿‡ï¼Œå¼€å§‹æ³¨å†Œæµç¨‹ // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨ connection.query(`SELECT ID FROM User_table WHERE username='$&#123;username&#125;'`, (err, data) =&gt; &#123; if (err) &#123; res.writeHead(500) res.end() &#125; else &#123; if (data.length) &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'æ­¤ç”¨æˆ·åå·²è¢«å ç”¨' &#125;)) res.end() &#125; else &#123; // å°†ç”¨æˆ·åå’Œå¯†ç æ’å…¥æ•°æ®åº“ connection.query(`INSERT INTO user_table (username, password) VALUES('$&#123;username&#125;', '$&#123;password&#125;')`, (err, data) =&gt; &#123; if (err) &#123; res.writeHead(500) res.end() &#125; else &#123; res.write(JSON.stringify(&#123; error: 0, msg: 'æ³¨å†ŒæˆåŠŸ' &#125;)) res.end() &#125; &#125;) &#125; &#125; &#125;) &#125; &#125; else if (pathname === '/login') &#123; let arr = [] req.on('data', (buffer) =&gt; &#123; // èŽ·å–POSTè¯·æ±‚çš„Bufferæ•°æ® arr.push(buffer) &#125;) req.on('end', () =&gt; &#123; // å°†Bufferæ•°æ®åˆå¹¶ let buffer = Buffer.concat(arr) // å¤„ç†æŽ¥æ”¶åˆ°çš„POSTæ•°æ® const post = JSON.parse(buffer.toString()) // èŽ·å–postè¯·æ±‚æ•°æ® const &#123; username, password &#125; = post // æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ connection.query(`SELECT username, password FROM User_table WHERE username='$&#123;username&#125;'`, (err, data) =&gt; &#123; if (err) &#123; console.error(err) &#125; else &#123; if (!data.length) &#123; // ç”¨æˆ·ä¸å­˜åœ¨ res.write(JSON.stringify(&#123; error: 1, msg: 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯' &#125;)) res.end() &#125; else if (data[0].password !== password) &#123; // å¯†ç ä¸æ­£ç¡® res.write(JSON.stringify(&#123; error: 1, msg: 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯' &#125;)) res.end() &#125; else &#123; res.write(JSON.stringify(&#123; error: 0, msg: 'ç™»å½•æˆåŠŸ' &#125;)) res.end() &#125; &#125; &#125;) &#125;) &#125; else &#123; // è‹¥è¯·æ±‚ä¸ä¸ºæŽ¥å£ï¼Œåˆ™é»˜è®¤ä¸ºè¯·æ±‚æ–‡ä»¶ fs.readFile(`.$&#123;pathname&#125;`, (err, buffer) =&gt; &#123; if (err) &#123; res.writeHead(404) res.write(buffer) &#125; else &#123; res.write(buffer) &#125; res.end() &#125;) &#125;&#125;)server.listen(8080)]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (å) --æ•°æ®åº“å…¥é—¨]]></title>
    <url>%2F2019%2F04%2F21%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E5%8D%81)%20--%E6%95%B0%E6%8D%AE%E5%BA%93%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[æ•°æ®åº“çš„åˆ†ç±»1.æ–‡ä»¶æ•°æ®åº“ å®ƒçš„ä¼˜ç‚¹æ˜¯ï¼šæ•°æ®ä¿å­˜åœ¨å•ä¸€æ–‡ä»¶ä¸­ï¼Œå› æ­¤éƒ¨ç½²ååˆ†æ–¹ä¾¿ï¼Œå¸¸ç”¨æ¥åµŒå…¥åˆ°APPä¸­ä¿å­˜æ•°æ®ï¼Œä»¥åŠæ‰‹æœºä¸­çš„çŸ­ä¿¡ã€é€šè¯è®°å½•ç­‰ã€‚ å¸¸ç”¨çš„æœ‰SQLiteã€Accessç­‰ã€‚ 2.å…³ç³»åž‹æ•°æ®åº“ å…³ç³»åž‹æ•°æ®åº“çš„åŠŸèƒ½å¼ºå¤§ï¼Œé€‚ç”¨åœºæ™¯ä¸°å¯Œï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ•°æ®ä¹‹é—´äº’ç›¸æ˜¯å…³è”çš„ã€‚ æ¯”å¦‚æ·˜å®ï¼Œä¸€ä¸ªç”¨æˆ·ä¸‹æœ‰ä¸ªäººä¿¡æ¯ã€è®¢å•ä¿¡æ¯ã€èŠå¤©è®°å½•ç­‰ï¼Œå¯ä»¥åˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒè¡¨ä¸­ï¼Œé€šè¿‡ç”¨æˆ·IDç›¸äº’å…³è”èµ·æ¥ã€‚ä½†å®ƒçš„æ€§èƒ½ä¸æ˜¯æœ€å¼ºçš„ã€‚ å¸¸ç”¨æœ‰SQLã€‚ 3.åˆ†å¸ƒå¼æ•°æ®åº“ å®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥å®‰è£…åœ¨å¤šå°æœºå™¨ä¸Šï¼Œå¯ä»¥å°†æŸ¥è¯¢ç­‰æ“ä½œåˆ†æ•£å¼€ï¼Œåˆç†åˆ©ç”¨æœåŠ¡å™¨èµ„æºã€‚ è¿˜å¯ä»¥å°†æ•°æ®è®¾ç½®å¤šä¸ªå¤‡ä»½ï¼Œä¸€æ—¦å…¶ä¸­ä¸€å°æœåŠ¡å™¨å¼‚å¸¸ï¼Œå¯ä»¥ç”±å…¶ä»–æœåŠ¡å™¨åŒæ­¥æ•°æ®ã€‚ å¸¸ç”¨çš„æœ‰MongoDBã€‚ 4.NoSQL å®ƒåªèƒ½æ”¯æŒç®€å•æŸ¥è¯¢ï¼Œä½†æ€§èƒ½å¼ºäºŽå…³ç³»åž‹æ•°æ®åº“ï¼Œå¸¸ç”¨æ¥åšæŽ¥å£ã€æ•°æ®ç¼“å­˜ç­‰ã€‚ å¸¸ç”¨çš„æœ‰MongoDBã€Memcachedã€Redisç­‰ã€‚ SQLè¯­å¥ç»“æž„åŒ–æŸ¥è¯¢è¯­è¨€(Structured Query Language)ç®€ç§°SQLï¼Œå®ƒä¸»è¦ç”¨æ¥å­˜å–ã€æŸ¥è¯¢ã€æ›´æ–°å’Œç®¡ç†å…³ç³»æ•°æ®åº“ç³»ç»Ÿã€‚ SQL åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šæ•°æ®å®šä¹‰è¯­è¨€ (DDL)å’Œæ•°æ®æ“ä½œè¯­è¨€ (DML) ã€‚ DDLè¯­å¥CREATE DATABASE - åˆ›å»ºæ–°æ•°æ®åº“ALTER DATABASE - ä¿®æ”¹æ•°æ®åº“CREATE TABLE - åˆ›å»ºæ–°è¡¨ALTER TABLE - å˜æ›´ï¼ˆæ”¹å˜ï¼‰æ•°æ®åº“è¡¨DROP TABLE - åˆ é™¤è¡¨CREATE INDEX - åˆ›å»ºç´¢å¼•ï¼ˆæœç´¢é”®ï¼‰DROP INDEX - åˆ é™¤ç´¢å¼• DDMè¯­å¥æ•°æ®æ“ä½œè¯­è¨€ (DML) æ˜¯æœ€å¸¸ç”¨çš„æ“ä½œï¼Œå³å¢žåˆ æ”¹æŸ¥ï¼Œå®ƒåŒ…æ‹¬å¦‚ä¸‹éƒ¨åˆ†ï¼š 1.å¢žINSERT INTO - å‘æ•°æ®åº“è¡¨ä¸­æ’å…¥æ•°æ®INSERT INTO &lt;è¡¨&gt; (å­—æ®µ, â€¦) VALUES(å€¼, â€¦);INSERT INTO user_table (username, password) VALUES(â€˜leeâ€™, â€˜123456â€™);åœ¨user_tableè¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®ã€‚ 2.åˆ DELETE - ä»Žæ•°æ®åº“è¡¨ä¸­åˆ é™¤æ•°æ®DELETE FROM &lt;è¡¨&gt; WHERE æ¡ä»¶;DELETE FROM user_table WHERE ID=2;åˆ é™¤user_tableè¡¨ä¸­IDä¸º2çš„é¡¹ç›®ã€‚ 3.æ”¹UPDATE - æ›´æ–°æ•°æ®åº“è¡¨ä¸­çš„æ•°æ®UPDATE &lt;è¡¨&gt; SET å­—æ®µ=æ–°å€¼,å­—æ®µ=æ–°å€¼,â€¦ WHERE æ¡ä»¶;UPDATE user_table SET password=â€™888888â€™, username=â€™chenâ€™ WHERE ID=1;å°†user_tableè¡¨ä¸­IDä¸º1çš„ç”¨æˆ·åå’Œå¯†ç æ›´æ–°ã€‚ 4.æŸ¥SELECT - ä»Žæ•°æ®åº“è¡¨ä¸­èŽ·å–æ•°æ®SELECT å­—æ®µåˆ—è¡¨ FROM &lt;è¡¨&gt; WHERE æ¡ä»¶ ORDER BY å­—æ®µ LIMIT 30,30;SELECT ID FROM user_table WHERE username=â€˜leeâ€™ ORDER BY ID ASC LIMIT 0,10;æŸ¥è¯¢user_tableè¡¨ä¸­usernameä¸ºleeçš„ç”¨æˆ·çš„IDï¼Œå–0~10ä¸ªï¼ŒæŒ‰å‡åºæŽ’åˆ—ã€‚ æ•°æ®åº“ç´¢å¼•æ•°æ®åº“çš„ç´¢å¼•éœ€è¦ä½œç”¨æ˜¯æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œå¦å¤–è¿˜å¯ä»¥å¯¹æ•°æ®è¿›è¡Œé™åˆ¶ï¼Œå¦‚é™åˆ¶ä¸ºâ€œå”¯ä¸€â€ã€‚ ç´¢å¼•çš„ç±»åž‹æœ‰å››ç§ï¼Œå¦‚ä¸‹ï¼š 1.ä¸»é”® å…·æœ‰â€œå”¯ä¸€â€å’Œâ€œç´¢å¼•â€çš„åŒé‡ä¼˜ç‚¹ã€‚ 2.å”¯ä¸€ å®šä¹‰å­—æ®µä¸ºå”¯ä¸€ï¼Œå³ä¸å¯é‡å¤ã€‚ 3.ç´¢å¼• ä¼˜ç‚¹ï¼šæé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œç›¸å½“äºŽä¹¦çš„ç›®å½•ã€‚ ç¼ºç‚¹ï¼šé™ä½Žå¢žã€åˆ ã€æ”¹çš„æ€§èƒ½ï¼Œå› ä¸ºè¿™äº›æ“ä½œå¯èƒ½ä¼šè§¦å‘æ•°æ®åº“æ•´ç†ã€é‡å»ºç´¢å¼•ã€‚å¦å¤–ï¼Œç´¢å¼•ä¹Ÿä¼šå ç”¨ç£ç›˜ç©ºé—´ã€‚ 4.å…¨æ–‡ç´¢å¼• é€‚åˆæ–‡æœ¬æœç´¢ï¼Œå¸¸ç”¨åœ¨æœç´¢å¼•æ“Žä¸­ã€‚]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (ä¹)--Websocket]]></title>
    <url>%2F2019%2F04%2F20%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E4%B9%9D)%20--Websocket%2F</url>
    <content type="text"><![CDATA[WebSocketçš„ä¼˜åŠ¿1.æ€§èƒ½é«˜ã€‚ æ ¹æ®æµ‹è¯•çŽ¯å¢ƒæ•°æ®çš„ä¸åŒï¼Œå¤§çº¦ä¼šæ¯”æ™®é€šAjaxè¯·æ±‚é«˜2-10å€ã€‚ HTTPæ˜¯æ–‡æœ¬åè®®ï¼Œæ•°æ®é‡æ¯”è¾ƒå¤§ã€‚ è€ŒWebSocketæ˜¯åŸºäºŽäºŒè¿›åˆ¶çš„åè®®ï¼Œåœ¨å»ºç«‹è¿žæŽ¥æ—¶ç”¨çš„è™½ç„¶æ˜¯æ–‡æœ¬æ•°æ®ï¼Œä½†ä¹‹åŽä¼ è¾“çš„éƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œå› æ­¤æ€§èƒ½æ¯”Ajaxè¯·æ±‚é«˜ã€‚ 2.åŒå‘é€šä¿¡ã€‚ å¦‚æžœæ˜¯æ™®é€šAjaxè¯·æ±‚ï¼Œéœ€è¦å®žæ—¶èŽ·å–æ•°æ®ï¼Œåªèƒ½ç”¨è®¡æ—¶å™¨å®šæ—¶å‘é€è¯·æ±‚ï¼Œè¿™æ ·ä¼šæµªè´¹æœåŠ¡å™¨èµ„æºå’Œæµé‡ã€‚ è€Œé€šè¿‡WebSocketï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å‰ç«¯å‘é€ä¿¡æ¯ã€‚ 3.å®‰å…¨æ€§é«˜ ç”±äºŽWebSocketå‡ºçŽ°è¾ƒæ™šï¼Œç›¸æ¯”HTTPåè®®ï¼Œåœ¨å®‰å…¨æ€§ä¸Šè€ƒè™‘çš„æ›´åŠ å……åˆ†ã€‚ æŽ¥ä¸‹æ¥ï¼Œå°è¯•ç”¨Socket.ioå»ºç«‹ä¸€ä¸ªåŸºäºŽWebSocketçš„åŒå‘é€šä¿¡ã€‚ Socket.ioSocket.ioæ˜¯åœ¨ä½¿ç”¨WebSocketæ—¶çš„ä¸€ä¸ªå¸¸ç”¨åº“ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ¤æ–­åœ¨æ”¯æŒWebSocketçš„æµè§ˆå™¨ä¸­ä½¿ç”¨WebSocketï¼Œåœ¨å…¶ä»–æµè§ˆå™¨ä¸­ï¼Œä¼šä½¿ç”¨å¦‚flashç­‰æ–¹å¼å®Œæˆé€šä¿¡ã€‚ 1.æ“ä½œç®€å•2.å…¼å®¹ä½Žç«¯æµè§ˆå™¨ï¼Œå¦‚IE63.è‡ªåŠ¨è¿›è¡Œæ•°æ®è§£æž4.è‡ªåŠ¨é‡è¿ž è‹¥å‡ºçŽ°è¿žæŽ¥æ–­å¼€çš„æƒ…å†µï¼ŒWebSocketä¼šè¿›è¡Œè‡ªåŠ¨é‡è¿žã€‚ ä½¿ç”¨Socket.ioå»ºç«‹ä¸€ä¸ªWebSocketåº”ç”¨1234567891011121314151617181920212223242526272829const http = require('http')const io = require('socket.io')// 1. å»ºç«‹HTTPæœåŠ¡å™¨ã€‚const server = http.createServer((req, res) =&gt; &#123;&#125;)server.listen(8080)// 2. å»ºç«‹WebSocketï¼Œè®©socket.ioç›‘å¬HTTPæœåŠ¡å™¨ï¼Œä¸€æ—¦å‘çŽ°æ˜¯WebSocketè¯·æ±‚ï¼Œåˆ™ä¼šè‡ªåŠ¨è¿›è¡Œå¤„ç†ã€‚const ws = io.listen(server)// å»ºç«‹è¿žæŽ¥å®ŒæˆåŽï¼Œè§¦å‘connectionäº‹ä»¶ã€‚// è¯¥äº‹ä»¶ä¼šè¿”å›žä¸€ä¸ªsocketå¯¹è±¡ï¼ˆhttps://socket.io/docs/server-api/#Socketï¼‰ï¼Œå¯ä»¥åˆ©ç”¨socketå¯¹è±¡è¿›è¡Œå‘é€ã€æŽ¥æ”¶æ•°æ®æ“ä½œã€‚ws.on('connection', (socket) =&gt; &#123; // æ ¹æ®äº‹ä»¶åï¼Œå‘å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œæ•°æ®æ•°é‡ä¸é™ã€‚ socket.emit('msg', 'æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ç¬¬ä¸€æ¡', 'æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ç¬¬äºŒæ¡') // æ ¹æ®äº‹ä»¶åæŽ¥æ”¶å®¢æˆ·ç«¯è¿”å›žçš„æ•°æ® socket.on('msg', (...msgs) =&gt; &#123; console.log(msgs) &#125;) // ä½¿ç”¨è®¡æ—¶å™¨å‘å®¢æˆ·ç«¯å‘é€æ•°æ® setInterval(() =&gt; &#123; socket.emit('timer', new Date().getTime()) &#125;, 500);&#125;) 12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;!-- å¼•ç”¨Socket.ioçš„å®¢æˆ·ç«¯jsæ–‡ä»¶ï¼Œç”±äºŽSocket.ioå·²åœ¨æœåŠ¡ç«¯ç›‘å¬äº†HTTPæœåŠ¡å™¨çš„è¯·æ±‚ï¼Œä¸€æ—¦æ”¶åˆ°å¯¹è¯¥æ–‡ä»¶çš„è¯·æ±‚ï¼Œåˆ™ä¼šè‡ªåŠ¨è¿”å›žè¯¥æ–‡ä»¶ï¼Œä¸éœ€è¦å¼€å‘äººå‘˜é…ç½®ã€‚ --&gt; &lt;!-- è¯¥æ–‡ä»¶åœ¨æœåŠ¡ç«¯çš„ä½ç½®ä¸º/node_modules/socket.io/node_modules/socket.io-client/dist/socket.io.js --&gt; &lt;script src="http://localhost:8080/socket.io/socket.io.js"&gt;&lt;/script&gt; &lt;script&gt; // ä¸ŽæœåŠ¡å™¨å»ºç«‹WebSocketè¿žæŽ¥ï¼Œè¯¥è¿žæŽ¥ä¸ºwsåè®®ï¼Œsocket.ioä¸éœ€è¦æ‹…å¿ƒè·¨åŸŸé—®é¢˜ã€‚ const socket = io.connect('ws://localhost:8080/') // æ ¹æ®äº‹ä»¶åï¼Œå‘æœåŠ¡ç«¯å‘é€æ•°æ®ï¼Œæ•°æ®æ•°é‡ä¸é™ã€‚ socket.emit('msg', 'å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®ç¬¬ä¸€æ¡', 'å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®ç¬¬äºŒæ¡') // æ ¹æ®äº‹ä»¶åæŽ¥æ”¶æœåŠ¡ç«¯è¿”å›žçš„æ•°æ® socket.on('msg', (...msgs) =&gt; &#123; console.log(msgs) &#125;) // æŽ¥æ”¶æœåŠ¡ç«¯é€šè¿‡è®¡æ—¶å™¨å‘é€æ¥çš„æ•°æ® socket.on('timer', (time) =&gt; &#123; console.log(time) &#125;) &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç”¨æµè§ˆå™¨æ‰“å¼€index.htmlï¼Œå³å¯åœ¨æŽ§åˆ¶å°çœ‹åˆ°æ‰“å°çš„æ¶ˆæ¯ã€‚ åŽŸç”Ÿå®žçŽ°WebSocketåº”ç”¨ä¸Šé¢ä½¿ç”¨äº†Socket.ioå®žçŽ°WebSocketï¼Œä¹Ÿæ˜¯å¼€å‘ä¸­å¸¸ç”¨çš„æ–¹å¼ã€‚ ä½†è¿™æ ·ä¸åˆ©äºŽäº†è§£å…¶åŽŸç†ï¼Œè¿™é‡Œä½¿ç”¨Nodejsçš„Netæ¨¡å—å’ŒWebç«¯çš„WebSocket APIå®žçŽ°WebSocketæœåŠ¡å™¨ã€‚ æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªNetæœåŠ¡å™¨123456789// å¼•å…¥netæ¨¡å—const net = require('net')// ä½¿ç”¨netæ¨¡å—åˆ›å»ºæœåŠ¡å™¨ï¼Œè¿”å›žçš„æ˜¯ä¸€ä¸ªåŽŸå§‹çš„socketå¯¹è±¡ï¼Œä¸ŽSocket.ioçš„socketå¯¹è±¡ä¸åŒã€‚const server = net.createServer((socket) =&gt; &#123; &#125;)server.listen(8080) Webç«¯åˆ›å»ºä¸€ä¸ªWebSocketé“¾æŽ¥åˆ›å»ºä¸€ä¸ªWebSocketè¿žæŽ¥ï¼Œæ­¤æ—¶æŽ§åˆ¶å°çš„Networkæ¨¡å—å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¤„äºŽpendingçŠ¶æ€çš„HTTPè¿žæŽ¥ã€‚ è¿™ä¸ªè¿žæŽ¥æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œä¸Žæ™®é€šHTTPè¯·æ±‚çš„è¯·æ±‚ä½ å¤´ç›¸æ¯”ï¼Œå¢žåŠ äº†ä»¥ä¸‹å†…å®¹ï¼š Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits // æ‰©å±•ä¿¡æ¯ Sec-WebSocket-Key: O3PKSb95qaSB7/+XfaTg7Q== // å‘é€ä¸€ä¸ªKeyåˆ°æœåŠ¡ç«¯ï¼Œç”¨äºŽæ ¡éªŒæœåŠ¡ç«¯æ˜¯å¦æ”¯æŒWebSocket Sec-WebSocket-Version: 13 // WebSocketç‰ˆæœ¬ Upgrade: websocket // å‘ŠçŸ¥æœåŠ¡å™¨é€šä¿¡åè®®å°†ä¼šå‡çº§åˆ°WebSocketè‹¥æœåŠ¡å™¨æ”¯æŒåˆ™ç»§ç»­ä¸‹ä¸€æ­¥ 1const ws = new WebSocket('ws://localhost:8080/') æœåŠ¡ç«¯ä½¿ç”¨socket.onceï¼Œè§¦å‘ä¸€æ¬¡dataäº‹ä»¶å¤„ç†HTTPè¯·æ±‚å¤´æ•°æ®12345socket.once('data', (buffer) =&gt; &#123; // æŽ¥æ”¶åˆ°HTTPè¯·æ±‚å¤´æ•°æ® const str = buffer.toString() console.log(str)&#125;) æ‰“å°ç»“æžœå¦‚ä¸‹: 123456789101112131415GET / HTTP/1.1Host: localhost:8080Connection: UpgradePragma: no-cacheCache-Control: no-cacheUpgrade: websocketOrigin: file://Sec-WebSocket-Version: 13User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/72.0.3626.121 Safari/537.36Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: _ga=GA1.1.1892261700.1545540050; _gid=GA1.1.774798563.1552221410; io=7X0VY8jhwRTdRHBfAAABSec-WebSocket-Key: JStOineTIKaQskxefzer7Q==Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits å°†å›žè½¦ç¬¦è½¬æ¢ä¸º\r\næ˜¾ç¤ºï¼Œç»“æžœå¦‚ä¸‹ï¼š 1GET / HTTP/1.1\r\nHost: localhost:8080\r\nConnection: Upgrade\r\nPragma: no-cache\r\nCache-Control: no-cache\r\nUpgrade: websocket\r\nOrigin: file://\r\nSec-WebSocket-Version: 13\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36\r\nAccept-Encoding: gzip, deflate, br\r\nAccept-Language: zh-CN,zh;q=0.9\r\nCookie: _ga=GA1.1.1892261700.1545540050; _gid=GA1.1.774798563.1552221410; io=7X0VY8jhwRTdRHBfAAAB\r\nSec-WebSocket-Key: dRB1xDJ/vV+IAGnG7TscNQ==\r\nSec-WebSocket-Extensions: permessage-deflate; client_max_window_bits\r\n\r\n å°†è¯·æ±‚å¤´å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡åˆ›å»ºä¸€ä¸ªparseHeaderæ–¹æ³•å¤„ç†è¯·æ±‚å¤´ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142function parseHeader(str) &#123; // å°†è¯·æ±‚å¤´æ•°æ®æŒ‰å›žè½¦ç¬¦åˆ‡å‰²ä¸ºæ•°ç»„ï¼Œå¾—åˆ°æ¯ä¸€è¡Œæ•°æ® let arr = str.split('\r\n').filter(item =&gt; item) // ç¬¬ä¸€è¡Œæ•°æ®ä¸ºGET / HTTP/1.1ï¼Œå¯ä»¥ä¸¢å¼ƒã€‚ arr.shift() console.log(arr) /* å¤„ç†ç»“æžœä¸ºï¼š [ 'Host: localhost:8080', 'Connection: Upgrade', 'Pragma: no-cache', 'Cache-Control: no-cache', 'Upgrade: websocket', 'Origin: file://', 'Sec-WebSocket-Version: 13', 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36', 'Accept-Encoding: gzip, deflate, br', 'Accept-Language: zh-CN,zh;q=0.9', 'Cookie: _ga=GA1.1.1892261700.1545540050; _gid=GA1.1.774798563.1552221410; io=7X0VY8jhwRTdRHBfAAAB', 'Sec-WebSocket-Key: jqxd7P0Xx9TGkdMfogptRw==', 'Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits' ] */ let headers = &#123;&#125; // å­˜å‚¨æœ€ç»ˆå¤„ç†çš„æ•°æ® arr.forEach((item) =&gt; &#123; // éœ€è¦ç”¨":"å°†æ•°ç»„åˆ‡å‰²æˆkeyå’Œvalue let [name, value] = item.split(':') // åŽ»é™¤æ— ç”¨çš„ç©ºæ ¼ï¼Œå°†å±žæ€§åè½¬ä¸ºå°å†™ name = name.replace(/^\s|\s+$/g, '').toLowerCase() value = value.replace(/^\s|\s+$/g, '') // èŽ·å–æ‰€æœ‰çš„è¯·æ±‚å¤´å±žæ€§ headers[name] = value &#125;) return headers&#125; æ‰“å°ç»“æžœå¦‚ä¸‹: 123456789101112131415&#123; host: 'localhost', connection: 'Upgrade', pragma: 'no-cache', 'cache-control': 'no-cache', upgrade: 'websocket', origin: 'file', 'sec-websocket-version': '13', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36', 'accept-encoding': 'gzip, deflate, br', 'accept-language': 'zh-CN,zh;q=0.9', cookie: '_ga=GA1.1.1892261700.1545540050; _gid=GA1.1.585339125.1552405260', 'sec-websocket-key': 'TipyPZNW+KNvV3fePNpriw==', 'sec-websocket-extensions': 'permessage-deflate; client_max_window_bits' &#125; æ ¹æ®è¯·æ±‚å¤´å‚æ•°ï¼Œåˆ¤æ–­æ˜¯å¦WebSocketè¯·æ±‚æ ¹æ®headers[&#39;upgrade&#39;] !== &#39;websocket&#39;ï¼Œåˆ¤æ–­è¯¥HTTPè¿žæŽ¥æ˜¯å¦å¯å‡çº§ä¸ºWebSocketï¼Œè‹¥å¯ä»¥å‡çº§ï¼Œè¡¨ç¤ºä¸ºWebSocketè¯·æ±‚ã€‚æ ¹æ®headers[&#39;sec-websocket-version&#39;] !== &#39;13&#39;ï¼Œåˆ¤æ–­WebSocketçš„ç‰ˆæœ¬æ˜¯å¦ä¸º13ï¼Œä»¥å…å› ä¸ºç‰ˆæœ¬ä¸åŒå‡ºçŽ°å…¼å®¹é—®é¢˜ã€‚ 12345678910111213141516171819202122socket.once('data', (buffer) =&gt; &#123; // æŽ¥æ”¶åˆ°HTTPè¯·æ±‚å¤´æ•°æ® const str = buffer.toString() console.log(str) // 4. å°†è¯·æ±‚å¤´æ•°æ®è½¬ä¸ºå¯¹è±¡ const headers = parseHeader(str) console.log(headers) // 5. åˆ¤æ–­è¯·æ±‚æ˜¯å¦ä¸ºWebSocketè¿žæŽ¥ if (headers['upgrade'] !== 'websocket') &#123; // è‹¥å½“å‰è¯·æ±‚ä¸æ˜¯WebSocketè¿žæŽ¥ï¼Œåˆ™å…³é—­è¿žæŽ¥ console.log('éžWebSocketè¿žæŽ¥') socket.end() &#125; else if (headers['sec-websocket-version'] !== '13') &#123; // åˆ¤æ–­WebSocketç‰ˆæœ¬æ˜¯å¦ä¸º13ï¼Œé˜²æ­¢æ˜¯å…¶ä»–ç‰ˆæœ¬ï¼Œé€ æˆå…¼å®¹é”™è¯¯ console.log('WebSocketç‰ˆæœ¬é”™è¯¯') socket.end() &#125; else &#123; // è¯·æ±‚ä¸ºWebSocketè¿žæŽ¥æ—¶ï¼Œè¿›ä¸€æ­¥å¤„ç† &#125;&#125;) æ ¡éªŒSec-WebSocket-Keyï¼Œå®Œæˆè¿žæŽ¥æ ¹æ®åè®®è§„å®šçš„æ–¹å¼ï¼Œå‘å‰ç«¯è¿”å›žä¸€ä¸ªè¯·æ±‚å¤´ï¼Œå®Œæˆå»ºç«‹WebSocketè¿žæŽ¥çš„è¿‡ç¨‹ã€‚ è‹¥å®¢æˆ·ç«¯æ ¡éªŒç»“æžœæ­£ç¡®ï¼Œåœ¨æŽ§åˆ¶å°çš„Networkæ¨¡å—å¯ä»¥çœ‹åˆ°HTTPè¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º101 Switching Protocolsï¼ŒåŒæ—¶å®¢æˆ·ç«¯çš„ws.onopenäº‹ä»¶è¢«è§¦å‘ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940socket.once('data', (buffer) =&gt; &#123; // æŽ¥æ”¶åˆ°HTTPè¯·æ±‚å¤´æ•°æ® const str = buffer.toString() console.log(str) // 4. å°†è¯·æ±‚å¤´æ•°æ®è½¬ä¸ºå¯¹è±¡ const headers = parseHeader(str) console.log(headers) // 5. åˆ¤æ–­è¯·æ±‚æ˜¯å¦ä¸ºWebSocketè¿žæŽ¥ if (headers['upgrade'] !== 'websocket') &#123; // è‹¥å½“å‰è¯·æ±‚ä¸æ˜¯WebSocketè¿žæŽ¥ï¼Œåˆ™å…³é—­è¿žæŽ¥ console.log('éžWebSocketè¿žæŽ¥') socket.end() &#125; else if (headers['sec-websocket-version'] !== '13') &#123; // åˆ¤æ–­WebSocketç‰ˆæœ¬æ˜¯å¦ä¸º13ï¼Œé˜²æ­¢æ˜¯å…¶ä»–ç‰ˆæœ¬ï¼Œé€ æˆå…¼å®¹é”™è¯¯ console.log('WebSocketç‰ˆæœ¬é”™è¯¯') socket.end() &#125; else &#123; // 6. æ ¡éªŒSec-WebSocket-Keyï¼Œå®Œæˆè¿žæŽ¥ /* åè®®ä¸­è§„å®šçš„æ ¡éªŒç”¨GUIDï¼Œå¯å‚è€ƒå¦‚ä¸‹é“¾æŽ¥ï¼š https://tools.ietf.org/html/rfc6455#section-5.5.2 https://stackoverflow.com/questions/13456017/what-does-258eafa5-e914-47da-95ca-c5ab0dc85b11-means-in-websocket-protocol */ const GUID = '258EAFA5-E914-47DA-95CA-C5AB0DC85B11' const key = headers['sec-websocket-key'] const hash = crypto.createHash('sha1') // åˆ›å»ºä¸€ä¸ªç­¾åç®—æ³•ä¸ºsha1çš„å“ˆå¸Œå¯¹è±¡ hash.update(`$&#123;key&#125;$&#123;GUID&#125;`) // å°†keyå’ŒGUIDè¿žæŽ¥åŽï¼Œæ›´æ–°åˆ°hash const result = hash.digest('base64') // ç”Ÿæˆbase64å­—ç¬¦ä¸² const header = `HTTP/1.1 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-Websocket-Accept: $&#123;result&#125;\r\n\r\n` // ç”Ÿæˆä¾›å‰ç«¯æ ¡éªŒç”¨çš„è¯·æ±‚å¤´ socket.write(header) // è¿”å›žHTTPå¤´ï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯æ ¡éªŒç»“æžœï¼ŒHTTPçŠ¶æ€ç 101è¡¨ç¤ºåˆ‡æ¢åè®®ï¼šhttps://httpstatuses.com/101ã€‚ // è‹¥å®¢æˆ·ç«¯æ ¡éªŒç»“æžœæ­£ç¡®ï¼Œåœ¨æŽ§åˆ¶å°çš„Networkæ¨¡å—å¯ä»¥çœ‹åˆ°HTTPè¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º101 Switching Protocolsï¼ŒåŒæ—¶å®¢æˆ·ç«¯çš„ws.onopenäº‹ä»¶è¢«è§¦å‘ã€‚ console.log(header) // å¤„ç†èŠå¤©æ•°æ® &#125; &#125;) å»ºç«‹è¿žæŽ¥åŽï¼Œé€šè¿‡dataäº‹ä»¶æŽ¥æ”¶å®¢æˆ·ç«¯çš„æ•°æ®å¹¶å¤„ç†è¿žæŽ¥å¼€å§‹åŽï¼Œå¯ä»¥åœ¨æŽ§åˆ¶å°çš„Networkæ¨¡å—çœ‹åˆ°ï¼Œè¯¥è¿žæŽ¥ä¼šä¸€ç›´ä¿ç•™åœ¨pendingçŠ¶æ€ï¼Œç›´åˆ°è¿žæŽ¥æ–­å¼€ã€‚ æ­¤æ—¶å¯ä»¥é€šè¿‡dataäº‹ä»¶å¤„ç†å®¢æˆ·ç«¯çš„æ•°æ®ï¼Œä½†æ­¤æ—¶åŒæ–¹é€šä¿¡çš„æ•°æ®ä¸ºäºŒè¿›åˆ¶ï¼Œéœ€è¦æŒ‰ç…§å…¶æ ¼å¼è¿›è¡Œå¤„ç†åŽæ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚ æ ¼å¼å¦‚ä¸‹ï¼š å¤„ç†æ”¶åˆ°çš„æ•°æ®ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142function decodeWsFrame(data) &#123; let start = 0; let frame = &#123; isFinal: (data[start] &amp; 0x80) === 0x80, opcode: data[start++] &amp; 0xF, masked: (data[start] &amp; 0x80) === 0x80, payloadLen: data[start++] &amp; 0x7F, maskingKey: '', payloadData: null &#125;; if (frame.payloadLen === 126) &#123; frame.payloadLen = (data[start++] &lt;&lt; 8) + data[start++]; &#125; else if (frame.payloadLen === 127) &#123; frame.payloadLen = 0; for (let i = 7; i &gt;= 0; --i) &#123; frame.payloadLen += (data[start++] &lt;&lt; (i * 8)); &#125; &#125; if (frame.payloadLen) &#123; if (frame.masked) &#123; const maskingKey = [ data[start++], data[start++], data[start++], data[start++] ]; frame.maskingKey = maskingKey; frame.payloadData = data .slice(start, start + frame.payloadLen) .map((byte, idx) =&gt; byte ^ maskingKey[idx % 4]); &#125; else &#123; frame.payloadData = data.slice(start, start + frame.payloadLen); &#125; &#125; console.dir(frame) return frame;&#125; å¤„ç†å‘å‡ºçš„æ•°æ®ï¼š 123456789101112131415161718192021222324252627function encodeWsFrame(data) &#123; const isFinal = data.isFinal !== undefined ? data.isFinal : true, opcode = data.opcode !== undefined ? data.opcode : 1, payloadData = data.payloadData ? Buffer.from(data.payloadData) : null, payloadLen = payloadData ? payloadData.length : 0; let frame = []; if (isFinal) frame.push((1 &lt;&lt; 7) + opcode); else frame.push(opcode); if (payloadLen &lt; 126) &#123; frame.push(payloadLen); &#125; else if (payloadLen &lt; 65536) &#123; frame.push(126, payloadLen &gt;&gt; 8, payloadLen &amp; 0xFF); &#125; else &#123; frame.push(127); for (let i = 7; i &gt;= 0; --i) &#123; frame.push((payloadLen &amp; (0xFF &lt;&lt; (i * 8))) &gt;&gt; (i * 8)); &#125; &#125; frame = payloadData ? Buffer.concat([Buffer.from(frame), payloadData]) : Buffer.from(frame); console.dir(decodeWsFrame(frame)); return frame;&#125; å¯¹èŠå¤©æ•°æ®è¿›è¡Œå¤„ç†ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253socket.once('data', (buffer) =&gt; &#123; // æŽ¥æ”¶åˆ°HTTPè¯·æ±‚å¤´æ•°æ® const str = buffer.toString() console.log(str) // 4. å°†è¯·æ±‚å¤´æ•°æ®è½¬ä¸ºå¯¹è±¡ const headers = parseHeader(str) console.log(headers) // 5. åˆ¤æ–­è¯·æ±‚æ˜¯å¦ä¸ºWebSocketè¿žæŽ¥ if (headers['upgrade'] !== 'websocket') &#123; // è‹¥å½“å‰è¯·æ±‚ä¸æ˜¯WebSocketè¿žæŽ¥ï¼Œåˆ™å…³é—­è¿žæŽ¥ console.log('éžWebSocketè¿žæŽ¥') socket.end() &#125; else if (headers['sec-websocket-version'] !== '13') &#123; // åˆ¤æ–­WebSocketç‰ˆæœ¬æ˜¯å¦ä¸º13ï¼Œé˜²æ­¢æ˜¯å…¶ä»–ç‰ˆæœ¬ï¼Œé€ æˆå…¼å®¹é”™è¯¯ console.log('WebSocketç‰ˆæœ¬é”™è¯¯') socket.end() &#125; else &#123; // 6. æ ¡éªŒSec-WebSocket-Keyï¼Œå®Œæˆè¿žæŽ¥ /* åè®®ä¸­è§„å®šçš„æ ¡éªŒç”¨GUIDï¼Œå¯å‚è€ƒå¦‚ä¸‹é“¾æŽ¥ï¼š https://tools.ietf.org/html/rfc6455#section-5.5.2 https://stackoverflow.com/questions/13456017/what-does-258eafa5-e914-47da-95ca-c5ab0dc85b11-means-in-websocket-protocol */ const GUID = '258EAFA5-E914-47DA-95CA-C5AB0DC85B11' const key = headers['sec-websocket-key'] const hash = crypto.createHash('sha1') // åˆ›å»ºä¸€ä¸ªç­¾åç®—æ³•ä¸ºsha1çš„å“ˆå¸Œå¯¹è±¡ hash.update(`$&#123;key&#125;$&#123;GUID&#125;`) // å°†keyå’ŒGUIDè¿žæŽ¥åŽï¼Œæ›´æ–°åˆ°hash const result = hash.digest('base64') // ç”Ÿæˆbase64å­—ç¬¦ä¸² const header = `HTTP/1.1 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-Websocket-Accept: $&#123;result&#125;\r\n\r\n` // ç”Ÿæˆä¾›å‰ç«¯æ ¡éªŒç”¨çš„è¯·æ±‚å¤´ socket.write(header) // è¿”å›žHTTPå¤´ï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯æ ¡éªŒç»“æžœï¼ŒHTTPçŠ¶æ€ç 101è¡¨ç¤ºåˆ‡æ¢åè®®ï¼šhttps://httpstatuses.com/101ã€‚ // è‹¥å®¢æˆ·ç«¯æ ¡éªŒç»“æžœæ­£ç¡®ï¼Œåœ¨æŽ§åˆ¶å°çš„Networkæ¨¡å—å¯ä»¥çœ‹åˆ°HTTPè¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º101 Switching Protocolsï¼ŒåŒæ—¶å®¢æˆ·ç«¯çš„ws.onopenäº‹ä»¶è¢«è§¦å‘ã€‚ console.log(header) // 7. å»ºç«‹è¿žæŽ¥åŽï¼Œé€šè¿‡dataäº‹ä»¶æŽ¥æ”¶å®¢æˆ·ç«¯çš„æ•°æ®å¹¶å¤„ç† socket.on('data', (buffer) =&gt; &#123; const data = decodeWsFrame(buffer) console.log(data) console.log(data.payloadData &amp;&amp; data.payloadData.toString()) // opcodeä¸º8ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯å‘èµ·äº†æ–­å¼€è¿žæŽ¥ if (data.opcode === 8) &#123; socket.end() // ä¸Žå®¢æˆ·ç«¯æ–­å¼€è¿žæŽ¥ &#125; else &#123; // æŽ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®æ—¶çš„å¤„ç†ï¼Œæ­¤å¤„é»˜è®¤ä¸ºè¿”å›žæŽ¥æ”¶åˆ°çš„æ•°æ®ã€‚ socket.write(encodeWsFrame(&#123; payloadData: `æœåŠ¡ç«¯æŽ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¸ºï¼š$&#123;data.payloadData ? data.payloadData.toString() : ''&#125;` &#125;)) &#125; &#125;) &#125; &#125;) è¿™æ ·ï¼Œä¸€ä¸ªç®€å•çš„åŸºäºŽWebSocketçš„èŠå¤©åº”ç”¨å°±åˆ›å»ºå®Œæˆäº†ï¼Œåœ¨å¯åŠ¨æœåŠ¡å™¨åŽï¼Œå¯ä»¥æ‰“å¼€index.htmlçœ‹åˆ°æ•ˆæžœã€‚]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (å…«)--Ajaxè·¨åŸŸ]]></title>
    <url>%2F2019%2F04%2F20%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E5%85%AB)%20--Ajax%E8%B7%A8%E5%9F%9F%2F</url>
    <content type="text"><![CDATA[Ajaxè·¨åŸŸé—®é¢˜çš„äº§ç”ŸåŽŸå› Ajaxè¯·æ±‚æ— æ³•è·¨åŸŸï¼Œåœ¨å‰ç«¯å¼€å‘ä¸­æ˜¯ä¸ªå¸¸è§é—®é¢˜ï¼Œå®ƒçš„äº§ç”ŸåŽŸå› æ˜¯ï¼Œåœ¨æµè§ˆå™¨æŽ¥æ”¶æœåŠ¡ç«¯è¿”å›žæ•°æ®æ—¶ï¼Œä¼šæ£€æŸ¥è¯¥æ•°æ®æ˜¯å¦å’Œå½“å‰å‘èµ·è¯·æ±‚çš„ç½‘å€åœ¨åŒä¸€åŸŸåä¸‹ã€‚è‹¥ä¸æ˜¯ï¼Œåˆ™ä¼šä¸¢å¼ƒè¯¥æ•°æ®ï¼Œå¹¶è¿”å›žä¸€ä¸ªè·¨åŸŸé”™è¯¯ã€‚ åœ¨Ajaxè¯·æ±‚ä¸­ï¼Œéµå¾ªå¦‚ä¸‹æµç¨‹ï¼šç½‘é¡µæäº¤ä¸€ä¸ªAjaxè¯·æ±‚åˆ°æµè§ˆå™¨ï¼Œæµè§ˆå™¨å°†è¯·æ±‚å‘è‡³æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æŽ¥æ”¶åˆ°è¯·æ±‚åŽï¼Œè¿”å›žå“åº”æ•°æ®ç»™æµè§ˆå™¨ï¼ˆæœåŠ¡å™¨é€šå¸¸ä¸ä¼šå¯¹åŸŸåè¿›è¡ŒåŒºåˆ†ï¼‰ï¼Œæµè§ˆå™¨æŽ¥æ”¶åˆ°å“åº”æ•°æ®æ—¶ï¼Œæ£€æµ‹è¿”å›žæ•°æ®çš„åŸŸåæ˜¯å¦å’Œå½“å‰é¡µé¢åŸŸåç›¸åŒï¼Œè‹¥ç›¸åŒåˆ™å°†æ•°æ®è¿”å›žç»™ç½‘é¡µï¼Œä¸åŒåˆ™ä¸¢å¼ƒæ•°æ®ã€‚ Ajaxè·¨åŸŸçš„å¤„ç†æ–¹æ³•æ—¢ç„¶è·¨åŸŸé—®é¢˜çš„äº§ç”ŸåŽŸå› åœ¨äºŽæµè§ˆå™¨çš„é™åˆ¶ï¼Œé‚£ä¹ˆç½‘é¡µç«¯åœ¨è¯·æ±‚æ—¶æ— æ³•ä¸»åŠ¨è§„é¿ï¼Œæ­¤æ—¶å°±éœ€è¦æœåŠ¡ç«¯è¿›è¡Œå¤„ç†ã€‚ æœåŠ¡ç«¯åªéœ€è¦åœ¨å“åº”Ajaxè¯·æ±‚æ—¶ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŠ å…¥ä¸€ä¸ªAccess-Control-Allow-Originå±žæ€§ï¼Œå¹¶è®¾ç½®ä¸º*ï¼ˆè¡¨ç¤ºå…¨éƒ¨åŸŸåï¼‰æˆ–è€…å½“å‰åŸŸåå°±å¯ä»¥è®©æµè§ˆå™¨ä¸å†è¿›è¡Œé™åˆ¶. 12345678910const http = require('http')const server = http.createServer((req, res) =&gt; &#123; console.log(req.headers.origin) res.setHeader('Access-Control-Allow-Origin', '*') res.write(`&#123;"resultCode": "0000", "msg": "success"&#125;`) res.end()&#125;)server.listen(8080) å½“ç„¶åœ¨å®žé™…é¡¹ç›®ä¸­ï¼Œä¸å¯ä»¥ç®€å•åœ°è®¾ç½®res.setHeader(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;)ï¼Œè€Œæ˜¯è¦é€šè¿‡req.headers.originåˆ¤æ–­å‘èµ·è¯·æ±‚çš„åŸŸåæ˜¯å¦åˆæ³•ï¼Œå†è®¾ç½®Access-Control-Allow-Originå±žæ€§ï¼Œä»¥å…å‡ºçŽ°å®‰å…¨é—®é¢˜ã€‚]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (ä¸ƒ) --POSTæ–‡ä»¶ä¸Šä¼ ]]></title>
    <url>%2F2019%2F04%2F04%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E4%B8%83)%20--POST%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2F</url>
    <content type="text"><![CDATA[ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ä¾‹å­å¤„ç†æ–‡ä»¶ä¸Šä¼ æ•°æ®ï¼Œä¹Ÿæ˜¯å‰åŽç«¯äº¤äº’ä¸­é‡è¦çš„åŠŸèƒ½ï¼Œå®ƒçš„å¤„ç†æ–¹å¼ä¸Žæ•°æ®ä¸åŒã€‚ æŽ¥ä¸‹æ¥ï¼Œé€šè¿‡ä¸€ä¸ªä¾‹å­æŸ¥çœ‹æœåŠ¡ç«¯æŽ¥æ”¶åˆ°çš„æ–‡ä»¶ä¸Šä¼ æ•°æ®ã€‚ é¦–å…ˆï¼Œåœ¨post_file.htmlä¸­ï¼Œæ–°å»ºä¸€ä¸ªç”¨ä¸Žä¸Šä¼ æ–‡ä»¶çš„è¡¨å•ï¼š formçš„å±žæ€§enctype=&quot;multipart/form-data&quot;ä»£è¡¨è¡¨å•ä¸Šä¼ çš„æ˜¯æ–‡ä»¶ã€‚ enctypeçš„é»˜è®¤å€¼ä¸ºenctype=&quot;application/x-www-form-urlencoded&quot;è¡¨ç¤ºä¸Šä¼ çš„æ˜¯æ•°æ®ç±»åž‹ï¼Œæ­¤æ—¶æœåŠ¡ç«¯æŽ¥æ”¶åˆ°çš„æ•°æ®ä¸ºâ€œusername=lee&amp;password=123456&amp;file=upload.txtâ€ã€‚ 123456&lt;form action="http://localhost:8080/upload" method="POST" enctype="multipart/form-data"&gt; ç”¨æˆ·ï¼š&lt;input type="text" name="username" value="lee"&gt;&lt;br/&gt; å¯†ç ï¼š&lt;input type="password" name="password" value="123456"&gt;&lt;br/&gt; &lt;input type="file" name="file" id=""&gt;&lt;br/&gt; &lt;input type="submit" value="æäº¤"&gt;&lt;/form&gt; å…¶æ¬¡ï¼Œåœ¨server.jsä¸­ï¼ŒæŸ¥çœ‹æŽ¥æ”¶åˆ°çš„è¡¨å•æäº¤æ•°æ®ï¼š 1234567891011121314151617const http = require('http')const server = http.createServer((req, res) =&gt; &#123; let arr = [] req.on('data', (buffer) =&gt; &#123; arr.push(buffer) &#125;) req.on('end', () =&gt; &#123; let buffer = Buffer.concat(arr) console.log(buffer.toString()) &#125;)&#125;)server.listen(8080) æœ€åŽï¼Œåœ¨è¡¨å•ä¸­ä¸Šä¼ /lesson16/upload.txtæ–‡ä»¶ï¼Œå¹¶æŸ¥çœ‹æ‰“å°å‡ºçš„ç»“æžœï¼š 12345678910111213------WebKitFormBoundaryL5AGcit70yhKB92YContent-Disposition: form-data; name="username"lee------WebKitFormBoundaryL5AGcit70yhKB92YContent-Disposition: form-data; name="password"123456Content-Disposition: form-data; name="file"; filename="upload.txt"Content-Type: text/plainupload------WebKitFormBoundaryL5AGcit70yhKB92Y-- æ–‡ä»¶ä¸Šä¼ æ•°æ®åˆ†æžé€šè¿‡åˆ†æžä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼ŒæœåŠ¡ç«¯æŽ¥æ”¶åˆ°çš„æ•°æ®ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š .è¡¨å•ä¸Šä¼ çš„æ•°æ®ï¼Œè¢«åˆ†éš”ç¬¦â€œ------WebKitFormBoundaryL5AGcit70yhKB92Yâ€éš”å¼€ï¼Œåˆ†éš”ç¬¦åœ¨æ¯æ¬¡ä¸Šä¼ æ—¶éƒ½ä¸åŒã€‚åˆ†éš”ç¬¦æ•°æ®å¯ä»¥ä»Žreq.headers[â€˜content-typeâ€™]ä¸­èŽ·å–ï¼Œå¦‚ï¼šconst boundary = â€˜â€“â€™ + req.headers[â€˜content-typeâ€™].split(â€˜; â€˜)[1].split(â€˜=â€™)[1]`ã€‚ 2.å‰ä¸¤æ®µæ•°æ®ä¸­ï¼Œåˆ†åˆ«å¯ä»¥èŽ·å–åˆ°è¡¨å•ä¸Šä¼ çš„å­—æ®µåname=â€usernameâ€ï¼Œä»¥åŠæ•°æ®â€œleeâ€ã€‚ 3.ç¬¬ä¸‰æ®µæ•°æ®ä¸­ï¼Œå¤šäº†ä¸€ä¸ªå­—æ®µfilename=â€upload.txtâ€ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æ–‡ä»¶çš„åŽŸå§‹åç§°ã€‚ä»¥åŠå¯ä»¥èŽ·å–åˆ°æ–‡ä»¶ç±»åž‹â€œContent-Type: text/plainâ€ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚æœ€åŽæ˜¯æ–‡ä»¶çš„å†…å®¹â€œuploadâ€ã€‚ ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œæ–‡ä»¶ä¸Šä¼ æ•°æ®è™½ç„¶æœ‰äº›ä¹±ï¼Œä½†è¿˜æ˜¯æœ‰è§„å¾‹çš„ï¼Œé‚£ä¹ˆå¤„ç†æ€è·¯å°±æ˜¯æŒ‰ç…§è§„å¾‹ï¼Œå°†æ•°æ®åˆ‡å‰²ä¹‹åŽï¼Œå–å‡ºå…¶ä¸­æœ‰ç”¨çš„éƒ¨åˆ†ã€‚ æ–‡ä»¶ä¸Šä¼ æ•°æ®ç®€åŒ–å…ˆå›žé¡¾ä¸€ä¸‹ä¸Šé¢çš„æ•°æ®ï¼Œå¹¶å°†å›žè½¦ç¬¦æ ‡è®°å‡ºæ¥ï¼š 12345678910111213------WebKitFormBoundaryL5AGcit70yhKB92Y\r\nContent-Disposition: form-data; name="username"\r\n\r\nlee\r\n------WebKitFormBoundaryL5AGcit70yhKB92Y\r\nContent-Disposition: form-data; name="password"\r\n\r\n123456\r\nContent-Disposition: form-data; name="file"; filename="upload.txt"\r\nContent-Type: text/plain\r\n\r\nupload\r\n------WebKitFormBoundaryL5AGcit70yhKB92Y-- å¯ä»¥çœ‹å‡ºï¼Œæ¯æ®µæ•°æ®çš„ç»“æž„å…¶å®žæ˜¯è¿™æ ·çš„ï¼š 1------WebKitFormBoundaryL5AGcit70yhKB92Y\r\nContent-Disposition: form-data; name="username"\r\n\r\nlee\r\ å°†æ¯æ®µä¸Šä¼ æ•°æ®ç®€åŒ–å¦‚ä¸‹ï¼š 1&lt;åˆ†éš”ç¬¦&gt;\r\nå­—æ®µå¤´\r\n\r\nå†…å®¹\r\n ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä¸ªè¡¨å•çš„æ•°æ®ï¼Œå°±æ˜¯æŒ‰ç…§è¿™æ ·çš„æ•°æ®æ ¼å¼ç»„è£…è€Œæˆã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¡¨å•æ•°æ®çš„ç»“å°¾ä¸å†æ˜¯\r\nï¼Œè€Œæ˜¯â€œâ€“â€ã€‚ æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†æ­¥éª¤1.ç”¨&lt;åˆ†éš”ç¬¦&gt;åˆ‡åˆ†æ•°æ®ï¼š 2.åˆ é™¤æ•°ç»„å¤´å°¾æ•°æ®ï¼š 3.å°†æ¯ä¸€é¡¹æ•°æ®å¤´å°¾çš„çš„\r\nåˆ é™¤ï¼š 4.å°†æ¯ä¸€é¡¹æ•°æ®ä¸­é—´çš„\r\n\r\nåˆ é™¤ï¼Œå¾—åˆ°æœ€ç»ˆç»“æžœï¼š Bufferçš„æ•°æ®å¤„ç†ç”±äºŽæ–‡ä»¶éƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä¸èƒ½ç›´æŽ¥å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²åŽå†è¿›è¡Œå¤„ç†ï¼Œå¦åˆ™æ•°æ®ä¼šå‡ºé”™ï¼Œå› æ­¤è¦é€šè¿‡Bufferæ¨¡å—è¿›è¡Œæ•°æ®å¤„ç†æ“ä½œã€‚ Bufferæ¨¡å—æä¾›äº†indexOfæ–¹æ³•èŽ·å–Bufferæ•°æ®ä¸­ï¼Œå…¶å‚æ•°æ‰€åœ¨ä½ç½®çš„indexå€¼ã€‚ Bufferæ¨¡å—æä¾›äº†sliceæ–¹æ³•ï¼Œå¯é€šè¿‡indexå€¼åˆ‡åˆ†Bufferæ•°æ®ã€‚ 123456let buffer = Buffer.from('lee\r\nchen\r\ntest')const index = buffer.indexOf('\r\n')console.log(index)console.log(buffer.slice(0, index).toString()) å¯ä»¥çœ‹åˆ°æ‰“å°ç»“æžœåˆ†åˆ«ä¸º3å’Œâ€leeâ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°äº†â€\r\nâ€æ‰€åœ¨çš„indexä¸º3ï¼Œä¹‹åŽä»ŽBufferæ•°æ®çš„indexä¸º0çš„ä½ç½®ï¼Œåˆ‡å‰²åˆ°indexä¸º3çš„ä½ç½®ï¼Œå¾—åˆ°äº†æ­£ç¡®çš„ç»“æžœã€‚ ç”±æ­¤ï¼Œå¯ä»¥å°è£…ä¸€ä¸ªä¸“é—¨ç”¨äºŽåˆ‡å‰²Bufferæ•°æ®çš„æ–¹æ³•ï¼š 123456789101112module.exports = function bufferSplit(buffer, separator) &#123; let result = []; let index = 0; while ((index = buffer.indexOf(separator)) != -1) &#123; result.push(buffer.slice(0, index)); buffer = buffer.slice(index + separator.length); &#125; result.push(buffer); return result;&#125; æœ‰äº†bufferSplitæ–¹æ³•ï¼Œå°±å¯ä»¥æ­£å¼å¼€å§‹å¤„ç†æ•°æ®äº†ã€‚ æ–‡ä»¶ä¸Šä¼ æ•°æ®å¤„ç†æ ¹æ®ä¸Šé¢çš„æ€è·¯ï¼Œå°±å¯ä»¥å®žçŽ°ä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768const http = require('http')const fs = require('fs')const bufferSplit = require('./bufferSplit')const server = http.createServer((req, res) =&gt; &#123; const boundary = `--$&#123;req.headers['content-type'].split('; ')[1].split('=')[1]&#125;` // èŽ·å–åˆ†éš”ç¬¦ let arr = [] req.on('data', (buffer) =&gt; &#123; arr.push(buffer) &#125;) req.on('end', () =&gt; &#123; const buffer = Buffer.concat(arr) console.log(buffer.toString()) // 1. ç”¨&lt;åˆ†éš”ç¬¦&gt;åˆ‡åˆ†æ•°æ® let result = bufferSplit(buffer, boundary) console.log(result.map(item =&gt; item.toString())) // 2. åˆ é™¤æ•°ç»„å¤´å°¾æ•°æ® result.pop() result.shift() console.log(result.map(item =&gt; item.toString())) // 3. å°†æ¯ä¸€é¡¹æ•°æ®å¤´å°¾çš„çš„\r\nåˆ é™¤ result = result.map(item =&gt; item.slice(2, item.length - 2)) console.log(result.map(item =&gt; item.toString())) // 4. å°†æ¯ä¸€é¡¹æ•°æ®ä¸­é—´çš„\r\n\r\nåˆ é™¤ï¼Œå¾—åˆ°æœ€ç»ˆç»“æžœ result.forEach(item =&gt; &#123; console.log(bufferSplit(item, '\r\n\r\n').map(item =&gt; item.toString())) let [info, data] = bufferSplit(item, '\r\n\r\n') // æ•°æ®ä¸­å«æœ‰æ–‡ä»¶ä¿¡æ¯ï¼Œä¿æŒä¸ºBufferç±»åž‹ info = info.toString() // infoä¸ºå­—æ®µä¿¡æ¯ï¼Œè¿™æ˜¯å­—ç¬¦ä¸²ç±»åž‹æ•°æ®ï¼Œç›´æŽ¥è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè‹¥ä¸ºæ–‡ä»¶ä¿¡æ¯ï¼Œåˆ™æ•°æ®ä¸­å«æœ‰ä¸€ä¸ªå›žè½¦ç¬¦\r\nï¼Œå¯ä»¥æ®æ­¤åˆ¤æ–­æ•°æ®ä¸ºæ–‡ä»¶è¿˜æ˜¯ä¸ºæ™®é€šæ•°æ®ã€‚ if (info.indexOf('\r\n') &gt;= 0) &#123; // è‹¥ä¸ºæ–‡ä»¶ä¿¡æ¯ï¼Œåˆ™å°†Bufferè½¬ä¸ºæ–‡ä»¶ä¿å­˜ // èŽ·å–å­—æ®µå let infoResult = info.split('\r\n')[0].split('; ') let name = infoResult[1].split('=')[1] name = name.substring(1, name.length - 1) // èŽ·å–æ–‡ä»¶å let filename = infoResult[2].split('=')[1] filename = filename.substring(1, filename.length - 1) console.log(name) console.log(filename) // å°†æ–‡ä»¶å­˜å‚¨åˆ°æœåŠ¡å™¨ fs.writeFile(`./upload/$&#123;filename&#125;`, data, err =&gt; &#123; if (err) &#123; console.log(err) &#125; else &#123; console.log('æ–‡ä»¶ä¸Šä¼ æˆåŠŸ') &#125; &#125;) &#125; else &#123; // è‹¥ä¸ºæ•°æ®ï¼Œåˆ™ç›´æŽ¥èŽ·å–å­—æ®µåç§°å’Œå€¼ let name = info.split('; ')[1].split('=')[1] name = name.substring(1, name.length - 1) const value = data.toString() console.log(name, value) &#125; &#125;) &#125;)&#125;)server.listen(8080) multipartyæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥å®ŒæˆPOSTè¯·æ±‚çš„å¤„ç†ï¼Œå¦‚multipartyã€‚ multiparty demoé€šè¿‡å¦‚ä¸‹ä¾‹å­ï¼Œå¯ä»¥æµ‹è¯•ä¸€ä¸‹multipartyçš„åŠŸèƒ½ã€‚ å®ƒä¼šåœ¨fieldäº‹ä»¶ä¸­ï¼Œå°†æ•°æ®ä¿¡æ¯çš„å­—æ®µåå’Œå€¼è¿”å›žã€‚åœ¨fileäº‹ä»¶ä¸­ï¼Œå°†æ–‡ä»¶çš„å­—æ®µåå’Œä¿¡æ¯è¿”å›žã€‚ ä¸Šä¼ æˆåŠŸåŽï¼Œä¼šåœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹åˆ›å»ºä¸€ä¸ªä¸Šä¼ çš„æ–‡ä»¶ï¼Œå¹¶ä¼šå°†æ–‡ä»¶é‡å‘½åï¼ˆå¦‚ï¼šIqUHkFe0u2h2TsiBztjKxoBR.jpgï¼‰ï¼Œä»¥é˜²æ­¢é‡åã€‚ è‹¥ä¸Šä¼ å‡ºçŽ°å¤±è´¥ï¼Œå·²ä¿å­˜çš„æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ é™¤ã€‚ closeäº‹ä»¶è¡¨ç¤ºè¡¨å•æ•°æ®å…¨éƒ¨è§£æžå®Œæˆï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­å¤„ç†å·²ç»æŽ¥æ”¶åˆ°çš„ä¿¡æ¯ã€‚ 123456789101112131415161718192021222324const http = require('http')const multiparty = require('multiparty')const server = http.createServer((req, res) =&gt; &#123; const form = new multiparty.Form(&#123; uploadDir: './upload' // æŒ‡å®šæ–‡ä»¶å­˜å‚¨ç›®å½• &#125;) form.parse(req) // å°†è¯·æ±‚å‚æ•°ä¼ å…¥ï¼Œmultipartyä¼šè¿›è¡Œç›¸åº”å¤„ç† form.on('field', (name, value) =&gt; &#123; // æŽ¥æ”¶åˆ°æ•°æ®å‚æ•°æ—¶ï¼Œè§¦å‘fieldäº‹ä»¶ console.log(name, value) &#125;) form.on('file', (name, file, ...rest) =&gt; &#123; // æŽ¥æ”¶åˆ°æ–‡ä»¶å‚æ•°æ—¶ï¼Œè§¦å‘fileäº‹ä»¶ console.log(name, file) &#125;) form.on('close', () =&gt; &#123; // è¡¨å•æ•°æ®è§£æžå®Œæˆï¼Œè§¦å‘closeäº‹ä»¶ console.log('è¡¨å•æ•°æ®è§£æžå®Œæˆ') &#125;)&#125;)server.listen(8080)]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (å…­) --åŸºæœ¬æ¨¡å—]]></title>
    <url>%2F2019%2F04%2F01%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E5%85%AD)%20--%E5%9F%BA%E6%9C%AC%E6%A8%A1%E5%9D%97%2F</url>
    <content type="text"><![CDATA[assert (æ–­è¨€)assertï¼ˆæ–­è¨€ï¼‰é€šå¸¸ç”¨æ¥å¯¹ä»£ç è¿›è¡Œæ ¡éªŒï¼Œè‹¥å‡ºé”™åˆ™é˜»æ­¢ç¨‹åºè¿è¡Œï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ ç”¨æ³•12345const assert = require('assert')assert(2 &gt; 1, '2 &gt; 1')assert(1 &gt; 2, '1 &gt; 2') ä»£ç åœ¨è¿è¡Œåˆ°assert(2 &gt; 1, â€˜2 &gt; 1â€™)æ—¶ï¼Œç”±äºŽ2 &gt; 1ä¸ºtrueï¼Œæ­¤æ—¶ä¸ä¼šæŠ›å‡ºé”™è¯¯ã€‚ è€Œè¿è¡Œåˆ°assert(1 &gt; 2, â€˜1 &gt; 2â€™)æ—¶ï¼Œç”±äºŽ1 &gt; 2ä¸ºfalseï¼Œæ­¤æ—¶ä¼šæŠ›å‡ºé”™è¯¯å¦‚ä¸‹ï¼š 12345678910AssertionError [ERR_ASSERTION]: 1 &gt; 2 at Object.&lt;anonymous&gt; (C:\projects\nodejs-tutorial\lesson11\assert.js:5:1) at Module._compile (internal/modules/cjs/loader.js:734:30) at Object.Module._extensions..js (internal/modules/cjs/loader.js:745:10) at Module.load (internal/modules/cjs/loader.js:626:32) at tryModuleLoad (internal/modules/cjs/loader.js:566:12) at Function.Module._load (internal/modules/cjs/loader.js:558:3) at Function.Module.runMain (internal/modules/cjs/loader.js:797:12) at executeUserCode (internal/bootstrap/node.js:526:15) at startMainThreadExecution (internal/bootstrap/node.js:439:3) ä½¿ç”¨æ–¹å¼é€šå¸¸å¯ä»¥åœ¨ä¸€ä¸ªæ¨¡å—æˆ–å‡½æ•°çš„æ¯ä¸ªé˜¶æ®µä½¿ç”¨assertï¼Œæˆ–è€…åœ¨å¯¹å‡½æ•°ä¼ å‚è¿›è¡Œassertæ ¡éªŒï¼Œä»¥ä¿è¯ä»£ç è¿è¡Œçš„æ­£ç¡®æ€§ã€‚ assert.deepStrictEqualassert.deepStrictEqual(actual, expected[, message])ç”¨äºŽå¯¹actual å‚æ•°å’Œ expectedçš„æ·±åº¦æ¯”è¾ƒï¼Œå³ä¸ä»…æ ¡éªŒå®ƒä»¬æ˜¯å¦ç›¸ç­‰ï¼ŒåŒæ—¶ä¹Ÿè¦æ ¡éªŒå®ƒä»¬çš„æˆå‘˜ä¹‹é—´æ˜¯å¦ç›¸ç­‰ã€‚ assert.deepStrictEqualåœ¨æ ¡éªŒå¯¹è±¡æˆ–æ•°ç»„æ—¶æ¯”è¾ƒæœ‰ç”¨ã€‚ assert.deepStrictEqualçš„æ¯”è¾ƒç›¸å½“äºŽ===ï¼Œä¹Ÿå°±æ˜¯ä¸ä»…æ˜¯å€¼ç›¸ç­‰ï¼Œå€¼çš„ç±»åž‹ä¹Ÿè¦ç›¸ç­‰ã€‚ assert.deepStrictEqualçš„ç”¨æ³•1.ä½¿ç”¨assert.deepStrictEqualæ¯”è¾ƒå¯¹è±¡ï¼š 1234567891011121314151617181920212223242526272829const assert = require('assert')const obj1 = &#123; a: 1, b: 2, children: &#123; c: 3 &#125;&#125;const obj2 = &#123; a: 1, b: 2, children: &#123; c: 3 &#125;&#125;const obj3 = &#123; a: 1, b: 2, children: &#123; c: '3' &#125;&#125;assert.deepStrictEqual(obj1, obj2, 'obj1 !== obj2')assert.deepStrictEqual(obj1, obj3, 'obj1 !== obj3') ä»£ç ä¼šæŠ›å‡ºé”™è¯¯ï¼šobj1 !== obj3ã€‚ 2.ä½¿ç”¨assert.deepStrictEqualæ¯”è¾ƒæ•°ç»„ 1234567891011121314151617181920212223242526272829const assert = require('assert')const arr1 = [&#123; a: 1, b: 2, children: [&#123; c: 3 &#125;]&#125;]const arr2 = [&#123; a: 1, b: 2, children: [&#123; c: 3 &#125;]&#125;]const arr3 = [&#123; a: 1, b: 2, children: [&#123; c: '3' &#125;]&#125;]assert.deepStrictEqual(arr1, arr2, 'arr1 !== arr2')assert.deepStrictEqual(arr1, arr3, 'arr1 !== arr3') path(è·¯å¾„)pathæ¨¡å—ä¸»è¦ç”¨æ¥å¯¹æ–‡ä»¶è·¯å¾„è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚æå–è·¯å¾„ã€åŽç¼€ï¼Œæ‹¼æŽ¥è·¯å¾„ç­‰ã€‚ ä½¿ç”¨12345678910const path = require('path')const str = '/root/a/b/1.txt'console.log(path.dirname(str)) // èŽ·å–æ–‡ä»¶ç›®å½•ï¼š/root/a/bconsole.log(path.basename(str)) // èŽ·å–æ–‡ä»¶åï¼š1.txtconsole.log(path.extname(str)) // èŽ·å–æ–‡ä»¶åŽç¼€ï¼š.txtconsole.log(path.resolve(str, '../c', 'build', 'strict')) // å°†è·¯å¾„è§£æžä¸ºç»å¯¹è·¯å¾„ï¼šC:\root\a\b\c\build\strictconsole.log(path.resolve(str, '../c', 'build', 'strict', '../..', 'assets')) // å°†è·¯å¾„è§£æžä¸ºç»å¯¹è·¯å¾„ï¼šC:\root\a\b\c\assetsconsole.log(path.resolve(__dirname, 'build')) // å°†è·¯å¾„è§£æžä¸ºç»å¯¹è·¯å¾„ï¼šC:\projects\nodejs-tutorial\lesson12\build å€¼å¾—ä¸€æçš„æ˜¯path.resolveæ–¹æ³•ï¼Œå®ƒå¯ä»¥æŽ¥æ”¶ä»»æ„ä¸ªå‚æ•°ï¼Œç„¶åŽæ ¹æ®æ¯ä¸ªè·¯å¾„å‚æ•°ä¹‹é—´çš„å…³ç³»ï¼Œå°†è·¯å¾„æœ€ç»ˆè§£æžä¸ºä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ __dirnameæŒ‡çš„æ˜¯å½“å‰æ¨¡å—æ‰€åœ¨çš„ç»å¯¹è·¯å¾„åç§°ï¼Œå®ƒçš„å€¼ä¼šè‡ªåŠ¨æ ¹æ®å½“å‰çš„ç»å¯¹è·¯å¾„å˜åŒ–ï¼Œç­‰åŒäºŽpath.dirname(__filename)çš„ç»“æžœã€‚ URLæ¨¡å—url.parseURLæ¨¡å—ç”¨äºŽå¯¹URLçš„è§£æžï¼Œå¸¸ç”¨çš„æ˜¯url.parseæ–¹æ³•ã€‚ å‡è®¾æœ‰ä¸€ä¸ªurlä¸ºhttps://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4ï¼Œå¯ä»¥ç”¨url.parseæ–¹æ³•è¿›è¡Œè§£æžã€‚ 12345const url = require('url')const str = 'https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4'console.log(url.parse(str)) æ‰“å°ç»“æžœå¦‚ä¸‹ï¼š 12345678910111213Url &#123; protocol: 'https:', slashes: true, auth: null, host: 'www.google.com:8080', port: '8080', hostname: 'www.google.com', hash: null, search: '?x=1&amp;y=2&amp;y=3&amp;y=4', query: 'x=1&amp;y=2&amp;y=3&amp;y=4', pathname: '/a/b', path: '/a/b?x=1&amp;y=2&amp;y=3&amp;y=4', href: 'https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4' &#125; å¯ä»¥çœ‹åˆ°urlçš„ä¿¡æ¯å¦‚ç«¯å£å·ã€åŸŸåã€queryå‚æ•°ç­‰éƒ½è¢«è§£æžå‡ºæ¥äº†ã€‚ å¦‚æžœéœ€è¦å°†queryå‚æ•°è½¬ä¸ºå¯¹è±¡ï¼Œåˆ™å¯ä»¥ä¸ºurl.parseå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ trueï¼Œå¦‚console.log(url.parse(str, true))ï¼Œæ‰“å°ç»“æžœå¦‚ä¸‹ï¼š 12345678910111213Url &#123; protocol: 'https:', slashes: true, auth: null, host: 'www.google.com:8080', port: '8080', hostname: 'www.google.com', hash: null, search: '?x=1&amp;y=2&amp;y=3&amp;y=4', query: [Object: null prototype] &#123; x: '1', y: [ '2', '3', '4' ] &#125;, pathname: '/a/b', path: '/a/b?x=1&amp;y=2&amp;y=3&amp;y=4', href: 'https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4' &#125; åŒæ—¶å¯ä»¥çœ‹åˆ°y=2&amp;y=3&amp;y=4å‚æ•°è¢«è§£æžä¸ºäº†y: [ â€˜2â€™, â€˜3â€™, â€˜4â€™ ]ã€‚ new URL()é™¤äº†ç”¨url.parseæ–¹æ³•è§£æžurlï¼Œè¿˜å¯ä»¥é€šè¿‡æž„é€ å‡½æ•°URLï¼Œåˆ›å»ºä¸€ä¸ªå®žä¾‹ï¼Œå…¶ä¸­å¸¦æœ‰è§£æžåŽçš„æ•°æ®ã€‚ å®žä¾‹æœ‰ä¸€ä¸ªtoStringæ–¹æ³•ï¼Œå¯ä»¥å°†å®žä¾‹è§£æžä¸ºå­—ç¬¦ä¸²urlã€‚ 12345const &#123; URL &#125; = require('url')const urlObj = new URL(str)console.log(urlObj)console.log(urlObj.toString()) 12345678910111213141516URL &#123; href: 'https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4', origin: 'https://www.google.com:8080', protocol: 'https:', username: '', password: '', host: 'www.google.com:8080', hostname: 'www.google.com', port: '8080', pathname: '/a/b', search: '?x=1&amp;y=2&amp;y=3&amp;y=4', searchParams: URLSearchParams &#123; 'x' =&gt; '1', 'y' =&gt; '2', 'y' =&gt; '3', 'y' =&gt; '4' &#125;, hash: '' &#125; https://www.google.com:8080/a/b?x=1&amp;y=2&amp;y=3&amp;y=4 // toStringæ–¹æ³•è§£æžå‡ºçš„url querystringæ¨¡å—querystringç”¨æ¥å¯¹urlä¸­çš„queryå­—ç¬¦ä¸²è¿›è¡Œè§£æžï¼Œå¸¸ç”¨çš„æ–¹æ³•æœ‰querystring.parseå’Œquerystring.stringifyã€‚ querystring.parsequerystring.parseæ–¹æ³•ç”¨äºŽè§£æžURL æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚ 1234const querystring = require('querystring')console.log(querystring.parse('foo=bar&amp;abc=xyz&amp;abc=123'))//&#123; foo: 'bar', abc: [ 'xyz', '123' ] &#125; querystring.stringifyquerystring.stringifyç”¨äºŽå°†å¯¹è±¡è½¬æ¢ä¸ºURLæŸ¥è¯¢å­—ç¬¦ä¸²ã€‚ 123console.log(querystring.stringify(&#123; foo: 'bar', baz: ['qux', 'quux'], corge: '' &#125;))// foo=bar&amp;baz=qux&amp;baz=quux&amp;corge= netæ¨¡å—net æ¨¡å—ç”¨äºŽåˆ›å»ºåŸºäºŽæµçš„ TCP æˆ– IPC çš„æœåŠ¡å™¨ï¼ˆnet.createServer()ï¼‰ä¸Žå®¢æˆ·ç«¯ï¼ˆnet.createConnection()ï¼‰ã€‚ netæ¨¡å—æ˜¯ä¸“é—¨ç”¨äºŽç½‘ç»œé€šä¿¡çš„æ¨¡å—ï¼Œè‹¥å½“å‰çš„æ•°æ®äº¤äº’ä¸é€šè¿‡HTTPåè®®ï¼Œå°±å¯ä»¥ä½¿ç”¨netæ¨¡å—ï¼Œå¦‚WebSocketã€‚ HTTPåè®®æœ¬è´¨ä¸Šæ˜¯ä»¥æ–‡æœ¬å½¢å¼ä¼ è¾“æ•°æ®ï¼Œå®ƒçš„ä¼ è¾“æ•°æ®é‡è¾ƒå¤§ï¼Œè€Œä¸”å®ƒçš„ä¼ è¾“éœ€è¦äºŒè¿›åˆ¶å’Œæ–‡æœ¬ä¹‹é—´è¿›è¡Œè½¬æ¢å’Œè§£æžã€‚ åœ¨nodejsä¸­ï¼ŒHTTPæ¨¡å—æ˜¯ç»§æ‰¿è‡ªnetæ¨¡å—çš„ã€‚ OSIå‚è€ƒæ¨¡åž‹OSIï¼ˆOpen System Interconnectï¼‰ï¼Œå³å¼€æ”¾å¼ç³»ç»Ÿäº’è”ã€‚ å®ƒæ˜¯ISOï¼ˆå›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼‰ç»„ç»‡åœ¨1985å¹´ç ”ç©¶çš„ç½‘ç»œäº’è”æ¨¡åž‹ã€‚è¯¥ä½“ç³»ç»“æž„æ ‡å‡†å®šä¹‰äº†ç½‘ç»œäº’è”çš„ä¸ƒå±‚æ¡†æž¶ï¼ˆç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚å’Œåº”ç”¨å±‚ï¼‰ï¼Œå³OSIå¼€æ”¾ç³»ç»Ÿäº’è¿žå‚è€ƒæ¨¡åž‹ã€‚åœ¨è¿™ä¸€æ¡†æž¶ä¸‹è¿›ä¸€æ­¥è¯¦ç»†è§„å®šäº†æ¯ä¸€å±‚çš„åŠŸèƒ½ï¼Œä»¥å®žçŽ°å¼€æ”¾ç³»ç»ŸçŽ¯å¢ƒä¸­çš„äº’è¿žæ€§ã€äº’æ“ä½œæ€§å’Œåº”ç”¨çš„å¯ç§»æ¤æ€§ã€‚ OSIå‚è€ƒæ¨¡åž‹åˆ†å±‚OSIå‚è€ƒæ¨¡åž‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸ƒå±‚ï¼š ç‰©ç†å±‚ â†’ æ•°æ®é“¾è·¯å±‚ â†’ ç½‘ç»œå±‚ï¼ˆIPåè®®ï¼‰ â†’ ä¼ è¾“å±‚ï¼ˆTCPå±‚ï¼‰ â†’ ä¼šè¯å±‚ â†’ è¡¨çŽ°å±‚ â†’ åº”ç”¨å±‚ï¼ˆHTTPåè®®ç­‰ï¼‰ OSIå‚è€ƒæ¨¡åž‹è¯¦ç»†ä»‹ç»å¦‚ä¸‹ï¼š ç¬¬1å±‚ç‰©ç†å±‚ï¼šå¤„äºŽOSIå‚è€ƒæ¨¡åž‹çš„æœ€åº•å±‚ã€‚ç‰©ç†å±‚çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨ç‰©ç†ä¼ è¾“ä»‹è´¨ä¸ºæ•°æ®é“¾è·¯å±‚æä¾›ç‰©ç†è¿žæŽ¥ï¼Œä»¥ä¾¿é€æ˜Žçš„ä¼ é€æ¯”ç‰¹æµã€‚å¸¸ç”¨è®¾å¤‡æœ‰ï¼ˆå„ç§ç‰©ç†è®¾å¤‡ï¼‰ç½‘å¡ã€é›†çº¿å™¨ã€ä¸­ç»§å™¨ã€è°ƒåˆ¶è§£è°ƒå™¨ã€ç½‘çº¿ã€åŒç»žçº¿ã€åŒè½´ç”µç¼†ã€‚ ç¬¬2å±‚æ•°æ®é“¾è·¯å±‚ï¼šåœ¨æ­¤å±‚å°†æ•°æ®åˆ†å¸§ï¼Œå¹¶å¤„ç†æµæŽ§åˆ¶ã€‚å±è”½ç‰©ç†å±‚ï¼Œä¸ºç½‘ç»œå±‚æä¾›ä¸€ä¸ªæ•°æ®é“¾è·¯çš„è¿žæŽ¥ï¼Œåœ¨ä¸€æ¡æœ‰å¯èƒ½å‡ºå·®é”™çš„ç‰©ç†è¿žæŽ¥ä¸Šï¼Œè¿›è¡Œå‡ ä¹Žæ— å·®é”™çš„æ•°æ®ä¼ è¾“ï¼ˆå·®é”™æŽ§åˆ¶ï¼‰ã€‚æœ¬å±‚æŒ‡å®šæ‹“æ‰‘ç»“æž„å¹¶æä¾›ç¡¬ä»¶å¯»å€ã€‚å¸¸ç”¨è®¾å¤‡æœ‰ç½‘æ¡¥ã€äº¤æ¢æœºï¼› ç¬¬3å±‚ç½‘ç»œå±‚ï¼šæœ¬å±‚é€šè¿‡å¯»å€æ¥å»ºç«‹ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¿žæŽ¥ï¼Œä¸ºæºç«¯çš„è¿è¾“å±‚é€æ¥çš„åˆ†ç»„ï¼Œé€‰æ‹©åˆé€‚çš„è·¯ç”±å’Œäº¤æ¢èŠ‚ç‚¹ï¼Œæ­£ç¡®æ— è¯¯åœ°æŒ‰ç…§åœ°å€ä¼ é€ç»™ç›®çš„ç«¯çš„è¿è¾“å±‚ã€‚å®ƒåŒ…æ‹¬é€šè¿‡äº’è¿žç½‘ç»œæ¥è·¯ç”±å’Œä¸­ç»§æ•°æ® ï¼›é™¤äº†é€‰æ‹©è·¯ç”±ä¹‹å¤–ï¼Œç½‘ç»œå±‚è¿˜è´Ÿè´£å»ºç«‹å’Œç»´æŠ¤è¿žæŽ¥ï¼ŒæŽ§åˆ¶ç½‘ç»œä¸Šçš„æ‹¥å¡žä»¥åŠåœ¨å¿…è¦çš„æ—¶å€™ç”Ÿæˆè®¡è´¹ä¿¡æ¯ã€‚ ç¬¬4å±‚ä¼ è¾“å±‚ï¼šâ€”å¸¸è§„æ•°æ®é€’é€ï¼é¢å‘è¿žæŽ¥æˆ–æ— è¿žæŽ¥ã€‚ä¸ºä¼šè¯å±‚ç”¨æˆ·æä¾›ä¸€ä¸ªç«¯åˆ°ç«¯çš„å¯é ã€é€æ˜Žå’Œä¼˜åŒ–çš„æ•°æ®ä¼ è¾“æœåŠ¡æœºåˆ¶ã€‚åŒ…æ‹¬å…¨åŒå·¥æˆ–åŠåŒå·¥ã€æµæŽ§åˆ¶å’Œé”™è¯¯æ¢å¤æœåŠ¡ï¼›ä¼ è¾“å±‚æŠŠæ¶ˆæ¯åˆ†æˆè‹¥å¹²ä¸ªåˆ†ç»„ï¼Œå¹¶åœ¨æŽ¥æ”¶ç«¯å¯¹å®ƒä»¬è¿›è¡Œé‡ç»„ã€‚ä¸åŒçš„åˆ†ç»„å¯ä»¥é€šè¿‡ä¸åŒçš„è¿žæŽ¥ä¼ é€åˆ°ä¸»æœºã€‚è¿™æ ·æ—¢èƒ½èŽ·å¾—è¾ƒé«˜çš„å¸¦å®½ï¼Œåˆä¸å½±å“ä¼šè¯å±‚ã€‚åœ¨å»ºç«‹è¿žæŽ¥æ—¶ä¼ è¾“å±‚å¯ä»¥è¯·æ±‚æœåŠ¡è´¨é‡ï¼Œè¯¥æœåŠ¡è´¨é‡æŒ‡å®šå¯æŽ¥å—çš„è¯¯ç çŽ‡ã€å»¶è¿Ÿé‡ã€å®‰å…¨æ€§ç­‰å‚æ•°ï¼Œè¿˜å¯ä»¥å®žçŽ°åŸºäºŽç«¯åˆ°ç«¯çš„æµé‡æŽ§åˆ¶åŠŸèƒ½ã€‚ ç¬¬5å±‚ä¼šè¯å±‚ï¼šåœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´å»ºç«‹ç«¯è¿žæŽ¥ã€‚ä¸ºç«¯ç³»ç»Ÿçš„åº”ç”¨ç¨‹åºä¹‹é—´æä¾›äº†å¯¹è¯æŽ§åˆ¶æœºåˆ¶ã€‚æ­¤æœåŠ¡åŒ…æ‹¬å»ºç«‹è¿žæŽ¥æ˜¯ä»¥å…¨åŒå·¥è¿˜æ˜¯ä»¥åŠåŒå·¥çš„æ–¹å¼è¿›è¡Œè®¾ç½®ï¼Œå°½ç®¡å¯ä»¥åœ¨å±‚4ä¸­å¤„ç†åŒå·¥æ–¹å¼ ï¼›ä¼šè¯å±‚ç®¡ç†ç™»å…¥å’Œæ³¨é”€è¿‡ç¨‹ã€‚å®ƒå…·ä½“ç®¡ç†ä¸¤ä¸ªç”¨æˆ·å’Œè¿›ç¨‹ä¹‹é—´çš„å¯¹è¯ã€‚å¦‚æžœåœ¨æŸä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªç”¨æˆ·æ‰§è¡Œä¸€é¡¹ç‰¹å®šçš„æ“ä½œï¼Œä¼šè¯å±‚åè®®å°±ä¼šç®¡ç†è¿™äº›æ“ä½œï¼Œå¦‚é˜»æ­¢ä¸¤ä¸ªç”¨æˆ·åŒæ—¶æ›´æ–°æ•°æ®åº“ä¸­çš„åŒä¸€ç»„æ•°æ®ã€‚ ç¬¬6å±‚è¡¨ç¤ºå±‚ï¼šä¸»è¦ç”¨äºŽå¤„ç†ä¸¤ä¸ªé€šä¿¡ç³»ç»Ÿä¸­äº¤æ¢ä¿¡æ¯çš„è¡¨ç¤ºæ–¹å¼ã€‚ä¸ºä¸Šå±‚ç”¨æˆ·è§£å†³ç”¨æˆ·ä¿¡æ¯çš„è¯­æ³•é—®é¢˜ã€‚å®ƒåŒ…æ‹¬æ•°æ®æ ¼å¼äº¤æ¢ã€æ•°æ®åŠ å¯†ä¸Žè§£å¯†ã€æ•°æ®åŽ‹ç¼©ä¸Žç»ˆç«¯ç±»åž‹çš„è½¬æ¢ã€‚ ç¬¬7å±‚åº”ç”¨å±‚ï¼šOSIä¸­çš„æœ€é«˜å±‚ã€‚ä¸ºç‰¹å®šç±»åž‹çš„ç½‘ç»œåº”ç”¨æä¾›äº†è®¿é—®OSIçŽ¯å¢ƒçš„æ‰‹æ®µã€‚åº”ç”¨å±‚ç¡®å®šè¿›ç¨‹ä¹‹é—´é€šä¿¡çš„æ€§è´¨ï¼Œä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€è¦ã€‚åº”ç”¨å±‚ä¸ä»…è¦æä¾›åº”ç”¨è¿›ç¨‹æ‰€éœ€è¦çš„ä¿¡æ¯äº¤æ¢å’Œè¿œç¨‹æ“ä½œï¼Œè€Œä¸”è¿˜è¦ä½œä¸ºåº”ç”¨è¿›ç¨‹çš„ç”¨æˆ·ä»£ç†ï¼Œæ¥å®Œæˆä¸€äº›ä¸ºè¿›è¡Œä¿¡æ¯äº¤æ¢æ‰€å¿…éœ€çš„åŠŸèƒ½ã€‚å®ƒåŒ…æ‹¬ï¼šæ–‡ä»¶ä¼ é€è®¿é—®å’Œç®¡ç†FTAMã€è™šæ‹Ÿç»ˆç«¯VTã€äº‹åŠ¡å¤„ç†TPã€è¿œç¨‹æ•°æ®åº“è®¿é—®RDAã€åˆ¶é€ æŠ¥æ–‡è§„èŒƒMMSã€ç›®å½•æœåŠ¡DSç­‰åè®®ï¼›åº”ç”¨å±‚èƒ½ä¸Žåº”ç”¨ç¨‹åºç•Œé¢æ²Ÿé€šï¼Œä»¥è¾¾åˆ°å±•ç¤ºç»™ç”¨æˆ·çš„ç›®çš„ã€‚ åœ¨æ­¤å¸¸è§çš„åè®®æœ‰:HTTPï¼ŒHTTPSï¼ŒFTPï¼ŒTELNETï¼ŒSSHï¼ŒSMTPï¼ŒPOP3ç­‰ã€‚ OSIå‚è€ƒæ¨¡åž‹å„å±‚åŠŸèƒ½(1)ç‰©ç†å±‚(Physical Layer)ç‰©ç†å±‚æ˜¯OSIå‚è€ƒæ¨¡åž‹çš„æœ€ä½Žå±‚ï¼Œå®ƒåˆ©ç”¨ä¼ è¾“ä»‹è´¨ä¸ºæ•°æ®é“¾è·¯å±‚æä¾›ç‰©ç†è¿žæŽ¥ã€‚å®ƒä¸»è¦å…³å¿ƒçš„æ˜¯é€šè¿‡ç‰©ç†é“¾è·¯ä»Žä¸€ä¸ªèŠ‚ç‚¹å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ä¼ é€æ¯”ç‰¹æµï¼Œç‰©ç†é“¾è·¯å¯èƒ½æ˜¯é“œçº¿ã€å«æ˜Ÿã€å¾®æ³¢æˆ–å…¶ä»–çš„é€šè®¯åª’ä»‹ã€‚å®ƒå…³å¿ƒçš„é—®é¢˜æœ‰ï¼šå¤šå°‘ä¼ç”µåŽ‹ä»£è¡¨1ï¼Ÿå¤šå°‘ä¼ç”µåŽ‹ä»£è¡¨0ï¼Ÿæ—¶é’Ÿé€ŸçŽ‡æ˜¯å¤šå°‘ï¼Ÿé‡‡ç”¨å…¨åŒå·¥è¿˜æ˜¯åŠåŒå·¥ä¼ è¾“ï¼Ÿæ€»çš„æ¥è¯´ç‰©ç†å±‚å…³å¿ƒçš„æ˜¯é“¾è·¯çš„æœºæ¢°ã€ç”µæ°”ã€åŠŸèƒ½å’Œè§„ç¨‹ç‰¹æ€§ã€‚ (2)æ•°æ®é“¾è·¯å±‚(Data Link Layer)æ•°æ®é“¾è·¯å±‚æ˜¯ä¸ºç½‘ç»œå±‚æä¾›æœåŠ¡çš„ï¼Œè§£å†³ä¸¤ä¸ªç›¸é‚»ç»“ç‚¹ä¹‹é—´çš„é€šä¿¡é—®é¢˜ï¼Œä¼ é€çš„åè®®æ•°æ®å•å…ƒç§°ä¸ºæ•°æ®å¸§ã€‚æ•°æ®å¸§ä¸­åŒ…å«ç‰©ç†åœ°å€ï¼ˆåˆç§°MACåœ°å€ï¼‰ã€æŽ§åˆ¶ç ã€æ•°æ®åŠæ ¡éªŒç ç­‰ä¿¡æ¯ã€‚è¯¥å±‚çš„ä¸»è¦ä½œç”¨æ˜¯é€šè¿‡æ ¡éªŒã€ç¡®è®¤å’Œåé¦ˆé‡å‘ç­‰æ‰‹æ®µï¼Œå°†ä¸å¯é çš„ç‰©ç†é“¾è·¯è½¬æ¢æˆå¯¹ç½‘ç»œå±‚æ¥è¯´æ— å·®é”™çš„æ•°æ®é“¾è·¯ã€‚æ­¤å¤–ï¼Œæ•°æ®é“¾è·¯å±‚è¿˜è¦åè°ƒæ”¶å‘åŒæ–¹çš„æ•°æ®ä¼ è¾“é€ŸçŽ‡ï¼Œå³è¿›è¡Œæµé‡æŽ§åˆ¶ï¼Œä»¥é˜²æ­¢æŽ¥æ”¶æ–¹å› æ¥ä¸åŠå¤„ç†å‘é€æ–¹æ¥çš„é«˜é€Ÿæ•°æ®è€Œå¯¼è‡´ç¼“å†²å™¨æº¢å‡ºåŠçº¿è·¯é˜»å¡žã€‚ (3)ç½‘ç»œå±‚(Network Layer)ç½‘ç»œå±‚æ˜¯ä¸ºä¼ è¾“å±‚æä¾›æœåŠ¡çš„ï¼Œä¼ é€çš„åè®®æ•°æ®å•å…ƒç§°ä¸ºæ•°æ®åŒ…æˆ–åˆ†ç»„ã€‚è¯¥å±‚çš„ä¸»è¦ä½œç”¨æ˜¯è§£å†³å¦‚ä½•ä½¿æ•°æ®åŒ…é€šè¿‡å„ç»“ç‚¹ä¼ é€çš„é—®é¢˜ï¼Œå³é€šè¿‡è·¯å¾„é€‰æ‹©ç®—æ³•ï¼ˆè·¯ç”±ï¼‰å°†æ•°æ®åŒ…é€åˆ°ç›®çš„åœ°ã€‚å¦å¤–ï¼Œä¸ºé¿å…é€šä¿¡å­ç½‘ä¸­å‡ºçŽ°è¿‡å¤šçš„æ•°æ®åŒ…è€Œé€ æˆç½‘ç»œé˜»å¡žï¼Œéœ€è¦å¯¹æµå…¥çš„æ•°æ®åŒ…æ•°é‡è¿›è¡ŒæŽ§åˆ¶ï¼ˆæ‹¥å¡žæŽ§åˆ¶ï¼‰ã€‚å½“æ•°æ®åŒ…è¦è·¨è¶Šå¤šä¸ªé€šä¿¡å­ç½‘æ‰èƒ½åˆ°è¾¾ç›®çš„åœ°æ—¶ï¼Œè¿˜è¦è§£å†³ç½‘é™…äº’è¿žçš„é—®é¢˜ã€‚ (4)ä¼ è¾“å±‚(Transport Layer)ä¼ è¾“å±‚çš„ä½œç”¨æ˜¯ä¸ºä¸Šå±‚åè®®æä¾›ç«¯åˆ°ç«¯çš„å¯é å’Œé€æ˜Žçš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ŒåŒ…æ‹¬å¤„ç†å·®é”™æŽ§åˆ¶å’Œæµé‡æŽ§åˆ¶ç­‰é—®é¢˜ã€‚è¯¥å±‚å‘é«˜å±‚å±è”½äº†ä¸‹å±‚æ•°æ®é€šä¿¡çš„ç»†èŠ‚ï¼Œä½¿é«˜å±‚ç”¨æˆ·çœ‹åˆ°çš„åªæ˜¯åœ¨ä¸¤ä¸ªä¼ è¾“å®žä½“é—´çš„ä¸€æ¡ä¸»æœºåˆ°ä¸»æœºçš„ã€å¯ç”±ç”¨æˆ·æŽ§åˆ¶å’Œè®¾å®šçš„ã€å¯é çš„æ•°æ®é€šè·¯ã€‚ä¼ è¾“å±‚ä¼ é€çš„åè®®æ•°æ®å•å…ƒç§°ä¸ºæ®µæˆ–æŠ¥æ–‡ã€‚ (5)ä¼šè¯å±‚(Session Layer)ä¼šè¯å±‚ä¸»è¦åŠŸèƒ½æ˜¯ç®¡ç†å’Œåè°ƒä¸åŒä¸»æœºä¸Šå„ç§è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼ˆå¯¹è¯ï¼‰ï¼Œå³è´Ÿè´£å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¼šè¯ã€‚ä¼šè¯å±‚å¾—åçš„åŽŸå› æ˜¯å®ƒå¾ˆç±»ä¼¼äºŽä¸¤ä¸ªå®žä½“é—´çš„ä¼šè¯æ¦‚å¿µã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªäº¤äº’çš„ç”¨æˆ·ä¼šè¯ä»¥ç™»å½•åˆ°è®¡ç®—æœºå¼€å§‹ï¼Œä»¥æ³¨é”€ç»“æŸã€‚ (6)è¡¨ç¤ºå±‚(Presentation Layer)è¡¨ç¤ºå±‚å¤„ç†æµç»ç»“ç‚¹çš„æ•°æ®ç¼–ç çš„è¡¨ç¤ºæ–¹å¼é—®é¢˜ï¼Œä»¥ä¿è¯ä¸€ä¸ªç³»ç»Ÿåº”ç”¨å±‚å‘å‡ºçš„ä¿¡æ¯å¯è¢«å¦ä¸€ç³»ç»Ÿçš„åº”ç”¨å±‚è¯»å‡ºã€‚å¦‚æžœå¿…è¦ï¼Œè¯¥å±‚å¯æä¾›ä¸€ç§æ ‡å‡†è¡¨ç¤ºå½¢å¼ï¼Œç”¨äºŽå°†è®¡ç®—æœºå†…éƒ¨çš„å¤šç§æ•°æ®è¡¨ç¤ºæ ¼å¼è½¬æ¢æˆç½‘ç»œé€šä¿¡ä¸­é‡‡ç”¨çš„æ ‡å‡†è¡¨ç¤ºå½¢å¼ã€‚æ•°æ®åŽ‹ç¼©å’ŒåŠ å¯†ä¹Ÿæ˜¯è¡¨ç¤ºå±‚å¯æä¾›çš„è½¬æ¢åŠŸèƒ½ä¹‹ä¸€ã€‚ (7)åº”ç”¨å±‚(Application Layer)åº”ç”¨å±‚æ˜¯OSIå‚è€ƒæ¨¡åž‹çš„æœ€é«˜å±‚ï¼Œæ˜¯ç”¨æˆ·ä¸Žç½‘ç»œçš„æŽ¥å£ã€‚è¯¥å±‚é€šè¿‡åº”ç”¨ç¨‹åºæ¥å®Œæˆç½‘ç»œç”¨æˆ·çš„åº”ç”¨éœ€æ±‚ï¼Œå¦‚æ–‡ä»¶ä¼ è¾“ã€æ”¶å‘ç”µå­é‚®ä»¶ç­‰ã€‚ TCPTCPå®Œæˆäº†OSIå‚è€ƒæ¨¡åž‹ä¸­çš„ç¬¬å››å±‚ä¼ è¾“å±‚çš„åŠŸèƒ½ï¼Œnetæ¨¡å—ç®€å•æ¥è¯´å°±æ˜¯TCPåè®®çš„nodeå®žçŽ°ã€‚ TCPï¼ˆTransmission Control Protocol ä¼ è¾“æŽ§åˆ¶åè®®ï¼‰æ˜¯ä¸€ç§é¢å‘è¿žæŽ¥çš„ã€å¯é çš„ã€åŸºäºŽå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ï¼Œç”±IETFçš„RFC 793å®šä¹‰ã€‚ å½“åº”ç”¨å±‚å‘TCPå±‚å‘é€ç”¨äºŽç½‘é—´ä¼ è¾“çš„ã€ç”¨8ä½å­—èŠ‚è¡¨ç¤ºçš„æ•°æ®æµï¼ŒTCPåˆ™æŠŠæ•°æ®æµåˆ†å‰²æˆé€‚å½“é•¿åº¦çš„æŠ¥æ–‡æ®µï¼Œæœ€å¤§ä¼ è¾“æ®µå¤§å°ï¼ˆMSSï¼‰é€šå¸¸å—è¯¥è®¡ç®—æœºè¿žæŽ¥çš„ç½‘ç»œçš„æ•°æ®é“¾è·¯å±‚çš„æœ€å¤§ä¼ é€å•å…ƒï¼ˆMTUï¼‰é™åˆ¶ã€‚ä¹‹åŽTCPæŠŠæ•°æ®åŒ…ä¼ ç»™IPå±‚ï¼Œç”±å®ƒæ¥é€šè¿‡ç½‘ç»œå°†åŒ…ä¼ é€ç»™æŽ¥æ”¶ç«¯å®žä½“çš„TCPå±‚ã€‚TCPä¸ºäº†ä¿è¯æŠ¥æ–‡ä¼ è¾“çš„å¯é  [1] ï¼Œå°±ç»™æ¯ä¸ªåŒ…ä¸€ä¸ªåºå·ï¼ŒåŒæ—¶åºå·ä¹Ÿä¿è¯äº†ä¼ é€åˆ°æŽ¥æ”¶ç«¯å®žä½“çš„åŒ…çš„æŒ‰åºæŽ¥æ”¶ã€‚ç„¶åŽæŽ¥æ”¶ç«¯å®žä½“å¯¹å·²æˆåŠŸæ”¶åˆ°çš„å­—èŠ‚å‘å›žä¸€ä¸ªç›¸åº”çš„ç¡®è®¤(ACK)ï¼›å¦‚æžœå‘é€ç«¯å®žä½“åœ¨åˆç†çš„å¾€è¿”æ—¶å»¶(RTT)å†…æœªæ”¶åˆ°ç¡®è®¤ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ•°æ®ï¼ˆå‡è®¾ä¸¢å¤±äº†ï¼‰å°†ä¼šè¢«é‡ä¼ ã€‚TCPçš„å¯é æ€§è™½ç„¶å¾ˆå¥½ï¼Œä½†å®ƒä¹Ÿå› æ­¤ç‰ºç‰²äº†æ•ˆçŽ‡ï¼Œå®ƒæ¯”è¾ƒé€‚åˆäºŽä¼ è¾“æ–‡ä»¶ç­‰åœºæ™¯ã€‚å¦‚æžœåœ¨å¯¹å¯é æ€§è¦æ±‚ä¸é«˜ï¼Œä½†å¯¹æ•ˆçŽ‡è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ï¼Œå¦‚è§†é¢‘ç›´æ’­ç­‰ï¼Œå°±å¯ä»¥ä½¿ç”¨UDPã€‚ UDPUDP æ˜¯User Datagram Protocolçš„ç®€ç§°ï¼Œ ä¸­æ–‡åæ˜¯ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œæ˜¯OSIï¼ˆOpen System Interconnectionï¼Œå¼€æ”¾å¼ç³»ç»Ÿäº’è”ï¼‰ å‚è€ƒæ¨¡åž‹ä¸­ä¸€ç§æ— è¿žæŽ¥çš„ä¼ è¾“å±‚åè®®ï¼Œæä¾›é¢å‘äº‹åŠ¡çš„ç®€å•ä¸å¯é ä¿¡æ¯ä¼ é€æœåŠ¡ï¼ŒIETF RFC 768æ˜¯UDPçš„æ­£å¼è§„èŒƒã€‚UDPåœ¨IPæŠ¥æ–‡çš„åè®®å·æ˜¯17ã€‚ UDPæŠ¥æ–‡æ²¡æœ‰å¯é æ€§ä¿è¯ã€é¡ºåºä¿è¯å’Œæµé‡æŽ§åˆ¶å­—æ®µç­‰ï¼Œå¯é æ€§è¾ƒå·®ã€‚ä½†æ˜¯æ­£å› ä¸ºUDPåè®®çš„æŽ§åˆ¶é€‰é¡¹è¾ƒå°‘ï¼Œåœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­å»¶è¿Ÿå°ã€æ•°æ®ä¼ è¾“æ•ˆçŽ‡é«˜ï¼Œé€‚åˆå¯¹å¯é æ€§è¦æ±‚ä¸é«˜çš„åº”ç”¨ç¨‹åºï¼Œå¦‚éŸ³é¢‘ã€è§†é¢‘å’Œæ™®é€šæ•°æ®åœ¨ä¼ é€æ—¶ä½¿ç”¨UDPè¾ƒå¤šï¼Œæˆ–è€…å¯ä»¥ä¿éšœå¯é æ€§çš„åº”ç”¨ç¨‹åºï¼Œå¦‚DNSã€TFTPã€SNMPç­‰ã€‚ Nodejsä¹Ÿæä¾›äº†UDP/Datagramæ¨¡å—ï¼Œå¯ä»¥åœ¨éœ€è¦ä½¿ç”¨UDPæ—¶è°ƒç”¨ã€‚]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vueä¸­axiosè¯·æ±‚çš„å°è£…]]></title>
    <url>%2F2019%2F03%2F29%2FVue%2Fvue%E4%B8%ADaxios%E8%AF%B7%E6%B1%82%E7%9A%84%E5%B0%81%E8%A3%85%2F</url>
    <content type="text"><![CDATA[å‰è¨€Axios æ˜¯ä¸€ä¸ªåŸºäºŽ promise çš„ HTTP åº“ï¼Œå¯ä»¥ç”¨åœ¨æµè§ˆå™¨å’Œ node.js ä¸­, ä¹Ÿæ˜¯vueå®˜æ–¹æŽ¨èä½¿ç”¨çš„httpåº“ï¼›å°è£…axiosï¼Œä¸€æ–¹é¢ä¸ºäº†ä»¥åŽç»´æŠ¤æ–¹ä¾¿ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œè‡ªå®šä¹‰å¤„ç†ï¼Œä¸å¤šBB,å¼€æž è®¾ç½®æŽ¥å£è¯·æ±‚å‰ç¼€ä¸€èˆ¬æˆ‘ä»¬å¼€å‘éƒ½ä¼šæœ‰å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§çŽ¯å¢ƒï¼Œå‰ç¼€éœ€è¦åŠ ä»¥åŒºåˆ†ï¼Œæˆ‘ä»¬åˆ©ç”¨nodeçŽ¯å¢ƒå˜é‡æ¥ä½œåˆ¤æ–­ 12345if(process.env.NODE_ENV === "development")&#123; axios.default.baseURL = "XXXX"&#125;else if(process.env.NODE_ENV === "production")&#123; axios.default.baseURL = "XXXX"&#125; åœ¨localhostè°ƒè¯•æ—¶ï¼Œç›´æŽ¥ç”¨å¼€å‘åœ°å€ä¸€èˆ¬éƒ½ä¼šæœ‰è·¨åŸŸçš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦vue.config.jsé…ç½®ä»£ç† 12345678910111213module.exports = &#123; devServer: &#123; proxy: &#123; '/proxyApi': &#123; target: 'http://dev.xxx.com', changeOrigin: true, pathRewrite: &#123; '/proxyApi': '' &#125; &#125; &#125; &#125;&#125; è¿™æ ·å°±æˆåŠŸæŠŠ/proxyApi æŒ‡å‘äº† XXXXï¼Œé‡å¯æœåŠ¡ æ‹¦æˆªå™¨æŽ¥ç€è®¾ç½®è¶…æ—¶æ—¶é—´å’Œè¯·æ±‚å¤´ä¿¡æ¯ 123axios.defaults.timeout = 10000// è¯·æ±‚å¤´ä¿¡æ¯æ˜¯ä¸ºpostè¯·æ±‚è®¾ç½®axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded;charset=UTF-8' axioså¾ˆå¥½ç”¨ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯å®ƒçš„æ‹¦æˆªå™¨ååˆ†å¼ºå¤§ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸ºè¯·æ±‚å’Œå“åº”è®¾ç½®æ‹¦æˆªå™¨ï¼Œæ¯”å¦‚è¯·æ±‚æ‹¦æˆªå™¨å¯ä»¥åœ¨æ¯ä¸ªè¯·æ±‚é‡ŒåŠ ä¸Štokenï¼Œåšäº†ç»Ÿä¸€å¤„ç†åŽç»´æŠ¤èµ·æ¥ä¹Ÿæ–¹ä¾¿ï¼Œå“åº”æ‹¦æˆªå™¨å¯ä»¥åœ¨æŽ¥æ”¶åˆ°å“åº”åŽå…ˆåšä¸€å±‚æ“ä½œï¼Œå¦‚æ ¹æ®çŠ¶æ€ç åˆ¤æ–­ç™»å½•çŠ¶æ€ã€æŽˆæƒã€‚ 12345678910111213141516171819202122232425262728293031323334// è¯·æ±‚æ‹¦æˆªå™¨axios.interceptors.request.use( config =&gt; &#123; // æ¯æ¬¡å‘é€è¯·æ±‚ä¹‹å‰åˆ¤æ–­æ˜¯å¦å­˜åœ¨token // å¦‚æžœå­˜åœ¨ï¼Œåˆ™ç»Ÿä¸€åœ¨httpè¯·æ±‚çš„headeréƒ½åŠ ä¸Štokenï¼Œè¿™æ ·åŽå°æ ¹æ®tokenåˆ¤æ–­ä½ çš„ç™»å½•æƒ…å†µï¼Œæ­¤å¤„tokenä¸€èˆ¬æ˜¯ç”¨æˆ·å®Œæˆç™»å½•åŽå‚¨å­˜åˆ°localstorageé‡Œçš„ token &amp;&amp; (config.headers.Authorization = token) return config &#125;, error =&gt; &#123; return Promise.error(error) &#125;)// å“åº”æ‹¦æˆªå™¨axios.interceptors.response.use(response =&gt; &#123; // å¦‚æžœè¿”å›žçš„çŠ¶æ€ç ä¸º200ï¼Œè¯´æ˜ŽæŽ¥å£è¯·æ±‚æˆåŠŸï¼Œå¯ä»¥æ­£å¸¸æ‹¿åˆ°æ•°æ® // å¦åˆ™çš„è¯æŠ›å‡ºé”™è¯¯ if (response.status === 200) &#123; if (response.data.code === 511) &#123; // æœªæŽˆæƒè°ƒå–æŽˆæƒæŽ¥å£ &#125; else if (response.data.code === 510) &#123; // æœªç™»å½•è·³è½¬ç™»å½•é¡µ &#125; else &#123; return Promise.resolve(response) &#125; &#125; else &#123; return Promise.reject(response) &#125;&#125;, error =&gt; &#123; // æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå¯¹å¼‚å¸¸çŠ¶æ€ä½œç»Ÿä¸€å¤„ç† if (error.response.status) &#123; // å¤„ç†è¯·æ±‚å¤±è´¥çš„æƒ…å†µ // å¯¹ä¸åŒè¿”å›žç å¯¹ç›¸åº”å¤„ç† return Promise.reject(error.response) &#125;&#125;) get postçš„å°è£…httpGet: ä¸€ä¸ªå‚æ•°æ˜¯è¯·æ±‚çš„url,ä¸€ä¸ªå°±æºå¸¦çš„è¯·æ±‚å‚æ•°ï¼Œè¿”å›žpromiseå¯¹è±¡ 123456789101112131415// get è¯·æ±‚export function httpGet(&#123; url, params = &#123;&#125;&#125;) &#123; return new Promise((resolve, reject) =&gt; &#123; axios.get(url, &#123; params &#125;).then((res) =&gt; &#123; resolve(res.data) &#125;).catch(err =&gt; &#123; reject(err) &#125;) &#125;)&#125; httpPost: åŽŸç†å’Œgetå·®ä¸å¤šï¼Œéœ€è¦æ³¨æ„ï¼Œè¿™é‡Œå¤šäº†ä¸ªdataå‚æ•°ï¼Œpostè¯·æ±‚æäº¤å‰éœ€è¦å¯¹å®ƒè¿›è¡Œåºåˆ—å·æ“ä½œï¼Œè¿™é‡Œæ˜¯é€šè¿‡transformRequeståšå¤„ç†ï¼›å¦å¤–ä¸¤ä¸ªå‚æ•°url,paramså’Œgetè¯·æ±‚çš„ä¸€æ ·ï¼› 123456789101112131415161718192021222324252627// postè¯·æ±‚export function httpPost(&#123; url, data = &#123;&#125;, params = &#123;&#125;&#125;) &#123; return new Promise((resolve, reject) =&gt; &#123; axios(&#123; url, method: 'post', transformRequest: [function (data) &#123; let ret = '' for (let it in data) &#123; ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&amp;' &#125; return ret &#125;], // å‘é€çš„æ•°æ® data, // urlå‚æ•° params &#125;).then(res =&gt; &#123; resolve(res.data) &#125;) &#125;)&#125; å¦‚ä½•ä½¿ç”¨æˆ‘æŠŠæ‰€æœ‰çš„æŽ¥å£è°ƒç”¨éƒ½åœ¨api.jsæ–‡ä»¶ä¸­ å…ˆå¼•å…¥å°è£…å¥½çš„æ–¹æ³•ï¼Œå†åœ¨è¦è°ƒç”¨çš„æŽ¥å£é‡æ–°å°è£…æˆä¸€ä¸ªæ–¹æ³•æš´éœ²å‡ºåŽ» 12import &#123; httpGet, httpPost &#125; from './http'export const getorglist = (params = &#123;&#125;) =&gt; httpGet(&#123; url: 'apps/api/org/list', params &#125;) åœ¨é¡µé¢ä¸­å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š 123456// .vueimport &#123; getorglist &#125; from '@/assets/js/api'getorglist(&#123; id: 200 &#125;).then(res =&gt; &#123; console.log(res)&#125;) è¿™æ ·å¯ä»¥æŠŠapiç»Ÿä¸€ç®¡ç†èµ·æ¥ï¼Œä»¥åŽç»´æŠ¤ä¿®æ”¹åªéœ€è¦åœ¨api.jsæ–‡ä»¶æ“ä½œå³å¯ å®Œæ•´ä»£ç http.js1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889// http.jsimport axios from 'axios'// çŽ¯å¢ƒçš„åˆ‡æ¢if (process.env.NODE_ENV === 'development') &#123; axios.defaults.baseURL = '/proxyApi'&#125; else if (process.env.NODE_ENV === 'production') &#123; axios.defaults.baseURL = 'http://prod.xxx.com'&#125;// è¯·æ±‚æ‹¦æˆªå™¨axios.interceptors.request.use( config =&gt; &#123; token &amp;&amp; (config.headers.Authorization = token) return config &#125;, error =&gt; &#123; return Promise.error(error) &#125;)axios.defaults.timeout = 10000axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded;charset=UTF-8'// å“åº”æ‹¦æˆªå™¨axios.interceptors.response.use(response =&gt; &#123; if (response.status === 200) &#123; if (response.data.code === 511) &#123; // æœªæŽˆæƒè°ƒå–æŽˆæƒæŽ¥å£ &#125; else if (response.data.code === 510) &#123; // æœªç™»å½•è·³è½¬ç™»å½•é¡µ &#125; else &#123; return Promise.resolve(response) &#125; &#125; else &#123; return Promise.reject(response) &#125;&#125;, error =&gt; &#123; // æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå¯¹å¼‚å¸¸çŠ¶æ€ä½œç»Ÿä¸€å¤„ç† if (error.response.status) &#123; // å¤„ç†è¯·æ±‚å¤±è´¥çš„æƒ…å†µ // å¯¹ä¸åŒè¿”å›žç å¯¹ç›¸åº”å¤„ç† return Promise.reject(error.response) &#125;&#125;)// get è¯·æ±‚export function httpGet(&#123; url, params = &#123;&#125;&#125;) &#123; return new Promise((resolve, reject) =&gt; &#123; axios.get(url, &#123; params &#125;).then((res) =&gt; &#123; resolve(res.data) &#125;).catch(err =&gt; &#123; reject(err) &#125;) &#125;)&#125;// postè¯·æ±‚export function httpPost(&#123; url, data = &#123;&#125;, params = &#123;&#125;&#125;) &#123; return new Promise((resolve, reject) =&gt; &#123; axios(&#123; url, method: 'post', transformRequest: [function (data) &#123; let ret = '' for (let it in data) &#123; ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&amp;' &#125; return ret &#125;], // å‘é€çš„æ•°æ® data, // urlå‚æ•° params &#125;).then(res =&gt; &#123; resolve(res.data) &#125;) &#125;)&#125; api.js12345678910// api.jsimport &#123; httpGet, httpPost &#125; from './http'export const getorglist = (params = &#123;&#125;) =&gt; httpGet(&#123; url: 'apps/api/org/list', params &#125;)export const save = (data) =&gt; &#123; return httpPost(&#123; url: 'apps/wechat/api/save_member', data &#125;)&#125; vue12345678910111213// .vue&lt;script&gt;import &#123; getorglist &#125; from '@/assets/js/api'export default &#123; name: 'upload-card', data() &#123;&#125;, mounted() &#123; getorglist(&#123; id: 200 &#125;).then(res =&gt; &#123; // console.log(res) &#125;) &#125;,&#125;&lt;/script&gt;]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•åœ¨ Web å…³é—­é¡µé¢æ—¶å‘é€ Ajax è¯·æ±‚]]></title>
    <url>%2F2019%2F03%2F28%2FAjax%2F%E5%A6%82%E4%BD%95%E5%9C%A8-Web-%E5%85%B3%E9%97%AD%E9%A1%B5%E9%9D%A2%E6%97%B6%E5%8F%91%E9%80%81-Ajax-%E8%AF%B7%E6%B1%82%2F</url>
    <content type="text"><![CDATA[å‰è¨€æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨ç”¨æˆ·ç¦»å¼€é¡µé¢çš„æ—¶å€™ï¼Œåšä¸€äº›ä¸ŠæŠ¥æ¥è®°å½•ç”¨æˆ·è¡Œä¸ºã€‚åˆæˆ–è€…æ˜¯å‘é€æœåŠ¡å™¨ajaxè¯·æ±‚ï¼Œé€šçŸ¥æœåŠ¡å™¨ç”¨æˆ·å·²ç»ç¦»å¼€ï¼Œæ¯”å¦‚ç›´æ’­é—´å†…çš„é€€æˆ¿æ“ä½œã€‚ æœ¬æ–‡ä¸»è¦åˆ†ä¸¤éƒ¨åˆ†æ¥è®²è§£æ€Žä¹ˆå®Œæˆé€€å‡ºè¡Œä¸ºçš„ä¸ŠæŠ¥ã€‚ äº‹ä»¶ç›‘å¬æµè§ˆå™¨æœ‰ä¸¤ä¸ªäº‹ä»¶å¯ä»¥ç”¨æ¥ç›‘å¬é¡µé¢å…³é—­ï¼Œbeforeunloadå’Œunloadã€‚beforeunloadæ˜¯åœ¨æ–‡æ¡£å’Œèµ„æºå°†è¦å…³é—­çš„æ—¶å€™è°ƒç”¨çš„ï¼Œ è¿™æ—¶å€™æ–‡æ¡£è¿˜æ˜¯å¯è§çš„ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªå…³é—­çš„äº‹ä»¶è¿˜æ˜¯å¯ä»¥å–æ¶ˆçš„ã€‚æ¯”å¦‚ä¸‹é¢è¿™ç§å†™æ³•å°±ä¼šè®©ç”¨æˆ·å¯¼è‡´åœ¨åˆ·æ–°æˆ–è€…å…³é—­é¡µé¢æ—¶å€™ï¼Œæœ‰ä¸ªå¼¹çª—æé†’ç”¨æˆ·æ˜¯å¦å…³é—­ã€‚ window.addEventListener(&quot;beforeunload&quot;, function (event) { // Cancel the event as stated by the standard. event.preventDefault(); // Chrome requires returnValue to be set. event.returnValue = &#39;&#39;; }); unloadåˆ™æ˜¯åœ¨é¡µé¢å·²ç»æ­£åœ¨è¢«å¸è½½æ—¶å‘ç”Ÿï¼Œæ­¤æ—¶æ–‡æ¡£æ‰€å¤„çš„çŠ¶æ€æ˜¯ï¼š1.æ‰€æœ‰èµ„æºä»å­˜åœ¨ï¼ˆå›¾ç‰‡ï¼Œiframeç­‰ï¼‰ï¼›2.å¯¹äºŽç”¨æˆ·æ‰€æœ‰èµ„æºä¸å¯è§ï¼›3.ç•Œé¢äº¤äº’æ— æ•ˆï¼ˆwindow.open, alert, confirm ç­‰ï¼‰ï¼›4.é”™è¯¯ä¸ä¼šåœæ­¢å¸è½½æ–‡æ¡£çš„è¿‡ç¨‹ã€‚ åŸºäºŽä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•å°±å¯ä»¥å®žçŽ°å¯¹é¡µé¢å…³é—­çš„äº‹ä»¶ç›‘å¬äº†ï¼Œä¸ºäº†ç¨³å¦¥ï¼Œå¯ä»¥ä¸¤ä¸ªäº‹ä»¶éƒ½ç›‘å¬ã€‚ç„¶åŽå¯¹ç›‘å¬å‡½æ•°åšå¤„ç†ï¼Œè®©å…³é—­äº‹ä»¶åªè°ƒç”¨ä¸€æ¬¡ã€‚ è¯·æ±‚å‘é€æœ‰äº†ä¸Šé¢çš„ç›‘å¬ï¼Œäº‹æƒ…åªå®Œæˆäº†ä¸€åŠï¼Œå¦‚æžœæˆ‘ä»¬åœ¨ç›‘å¬ä¸­ç›´æŽ¥å‘é€ajaxè¯·æ±‚ï¼Œå°±ä¼šå‘çŽ°è¯·æ±‚è¢«æµè§ˆå™¨abortäº†ï¼Œæ— æ³•å‘é€å‡ºåŽ»ã€‚åœ¨é¡µé¢å¸è½½çš„æ—¶å€™ï¼Œæµè§ˆå™¨å¹¶ä¸èƒ½ä¿è¯å¼‚æ­¥çš„è¯·æ±‚èƒ½å¤ŸæˆåŠŸå‘å‡ºåŽ»ã€‚ æˆ‘ä»¬æœ‰å‡ ç§æ–¹å¼å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š æ–¹æ¡ˆ1: å‘é€åŒæ­¥çš„ajaxè¯·æ±‚var oAjax = new XMLHttpRequest(); oAjax.open(&#39;POST&#39;, url + &#39;/user/register&#39;, false);//falseè¡¨ç¤ºåŒæ­¥è¯·æ±‚ oAjax.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;); oAjax.onreadystatechange = function() { if (oAjax.readyState == 4 &amp;&amp; oAjax.status == 200) { var data = JSON.parse(oAjax.responseText); } else { console.log(oAjax); } }; oAjax.send(&#39;a=1&amp;b=2&#39;); è¿™ç§æ–¹å¼è™½ç„¶æœ‰æ•ˆï¼Œä½†æ˜¯ç”¨æˆ·éœ€è¦ç­‰å¾…è¯·æ±‚ç»“æŸæ‰å¯ä»¥å…³é—­é¡µé¢ã€‚å¯¹ç”¨æˆ·çš„ä½“éªŒä¸å¥½ã€‚ å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œå¹¶ä¸”åœ¨æœåŠ¡ç«¯å¿½ç•¥ajaxçš„abortè™½ç„¶å¼‚æ­¥è¯·æ±‚ä¼šè¢«æµè§ˆå™¨abortï¼Œä½†æ˜¯å¦‚æžœæœåŠ¡ç«¯å¯ä»¥å¿½ç•¥abortï¼Œä»ç„¶æ­£å¸¸æ‰§è¡Œï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚æ¯”å¦‚PHPæœ‰ignore_user_abortå‡½æ•°å¯ä»¥å¿½ç•¥abortã€‚è¿™æ ·éœ€è¦æ”¹é€ åŽå°ï¼Œä¸€èˆ¬ä¸å¤ªå¯è¡Œ.. æ–¹æ¡ˆ3ï¼šä½¿ç”¨navigator.sendBeaconå‘é€å¼‚æ­¥è¯·æ±‚æ ¹æ®MDNçš„ä»‹ç»ï¼š è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºŽæ»¡è¶³ ç»Ÿè®¡å’Œè¯Šæ–­ä»£ç  çš„éœ€è¦ï¼Œè¿™äº›ä»£ç é€šå¸¸å°è¯•åœ¨å¸è½½ï¼ˆunloadï¼‰æ–‡æ¡£ä¹‹å‰å‘webæœåŠ¡å™¨å‘é€æ•°æ®ã€‚è¿‡æ—©çš„å‘é€æ•°æ®å¯èƒ½å¯¼è‡´é”™è¿‡æ”¶é›†æ•°æ®çš„æœºä¼šã€‚ç„¶è€Œï¼Œ å¯¹äºŽå¼€å‘è€…æ¥è¯´ä¿è¯åœ¨æ–‡æ¡£å¸è½½æœŸé—´å‘é€æ•°æ®ä¸€ç›´æ˜¯ä¸€ä¸ªå›°éš¾ã€‚å› ä¸ºç”¨æˆ·ä»£ç†é€šå¸¸ä¼šå¿½ç•¥åœ¨å¸è½½äº‹ä»¶å¤„ç†å™¨ä¸­äº§ç”Ÿçš„å¼‚æ­¥ XMLHttpRequest ã€‚ navigator.sendBeacon(url [, data]); sendBeaconæ”¯æŒå‘é€çš„dataå¯ä»¥æ˜¯ArrayBufferView, Blob, DOMString, æˆ–è€… FormData ç±»åž‹çš„æ•°æ®ã€‚ ä¸‹é¢æ˜¯å‡ ç§ä½¿ç”¨sendBeaconå‘é€è¯·æ±‚çš„æ–¹å¼ï¼Œå¯ä»¥ä¿®æ”¹headerå’Œå†…å®¹çš„æ ¼å¼ï¼Œå› ä¸ºä¸€èˆ¬å’ŒæœåŠ¡å™¨çš„é€šä¿¡æ–¹å¼éƒ½æ˜¯å›ºå®šçš„ï¼Œå¦‚æžœä¿®æ”¹äº†headeræˆ–è€…å†…å®¹ï¼ŒæœåŠ¡å™¨å°±æ— æ³•æ­£å¸¸è¯†åˆ«å‡ºæ¥äº†ã€‚ ï¼ˆ1ï¼‰ä½¿ç”¨Blobæ¥å‘é€ ä½¿ç”¨blobå‘é€çš„å¥½å¤„æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰å†…å®¹çš„æ ¼å¼å’Œheaderã€‚æ¯”å¦‚ä¸‹é¢è¿™ç§è®¾ç½®æ–¹å¼ï¼Œå°±æ˜¯å¯ä»¥è®¾ç½®content-typeä¸ºapplication/x-www-form-urlencodedã€‚ blob = new Blob([`room_id=123`], {type : &#39;application/x-www-form-urlencoded&#39;}); navigator.sendBeacon(&quot;/cgi-bin/leave_room&quot;, blob); ï¼ˆ2ï¼‰ä½¿ç”¨FormDataå¯¹è±¡ï¼Œä½†æ˜¯è¿™æ—¶content-typeä¼šè¢«è®¾ç½®æˆ&quot;multipart/form-data&quot;ã€‚ var fd = new FormData(); fd.append(&#39;room_id&#39;, 123); navigator.sendBeacon(&quot;/cgi-bin/leave_room&quot;, fd); ï¼ˆ3ï¼‰æ•°æ®ä¹Ÿå¯ä»¥ä½¿ç”¨URLSearchParams å¯¹è±¡ï¼Œcontent-typeä¼šè¢«è®¾ç½®æˆâ€text/plain;charset=UTF-8â€ ã€‚ var params = new URLSearchParams({ room_id: 123 }) navigator.sendBeacon(&quot;/cgi-bin/leave_room&quot;, params); é€šè¿‡å°è¯•ï¼Œå¯ä»¥å‘çŽ°ä½¿ç”¨blobå‘é€æ¯”è¾ƒæ–¹ä¾¿ï¼Œå†…å®¹çš„è®¾ç½®ä¹Ÿæ¯”è¾ƒçµæ´»ï¼Œå¦‚æžœå‘é€çš„æ¶ˆæ¯æŠ“åŒ…åŽå‘çŽ°åŽå°æ²¡æœ‰è¯†åˆ«å‡ºæ¥ï¼Œå¯ä»¥å°è¯•ä¿®æ”¹å†…å®¹çš„stringæˆ–è€…headerï¼Œæ¥æ‰¾åˆ°åˆé€‚çš„æ–¹å¼å‘é€è¯·æ±‚ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Ajax</category>
      </categories>
      <tags>
        <tag>Ajax</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€Œä»Žæºç ä¸­å­¦ä¹ ã€é¢è¯•å®˜éƒ½ä¸çŸ¥é“çš„Vueé¢˜ç›®ç­”æ¡ˆ]]></title>
    <url>%2F2019%2F03%2F27%2FVue%2F%E3%80%8C%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%AD%E5%AD%A6%E4%B9%A0%E3%80%8D%E9%9D%A2%E8%AF%95%E5%AE%98%E9%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Vue%E9%A2%98%E7%9B%AE%E7%AD%94%E6%A1%88%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ å‰è¨€å½“å›žç­”é¢è¯•å®˜é—®åŠçš„Vueé—®é¢˜ï¼Œæˆ‘ä»¬é™¤äº†ç…§æœ¬å®£ç§‘çš„å›žç­”å¤–ï¼Œå…¶å®žè¿˜å¯ä»¥æ ¹æ®å°‘é‡çš„æºç æ¥ç§€ä¸€æŠŠï¼Œæ¥ä½“çŽ°å‡ºä½ å¯¹Vueçš„æ·±åº¦äº†è§£ã€‚ â€œnew Vue() åšäº†ä»€ä¹ˆï¼Ÿâ€newå…³é”®å­—ä»£è¡¨å®žä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡, è€ŒVueå®žé™…ä¸Šæ˜¯ä¸€ä¸ªç±», æºç ä½ç½®æ˜¯/src/core/instance/index.jsã€‚ 12345678function Vue (options) &#123; if (process.env.NODE_ENV !== 'production' &amp;&amp; !(this instanceof Vue) ) &#123; warn('Vue is a constructor and should be called with the `new` keyword') &#125; this._init(options)&#125; æŽ¥ç€æˆ‘ä»¬è·³è½¬è¿½è¸ªè‡³this._init()ï¼Œå³Vue.prototype._init,ä½äºŽsrc\core\instance\init.jsåœ¨_init()æ–¹æ³•çš„å†…éƒ¨æœ‰ä¸€ç³»åˆ— init* çš„æ–¹æ³• 123456789101112131415161718192021222324Vue.prototype._init = function (options?: Object) &#123; const vm: Component = this // ...å¿½ç•¥ï¼Œä»Žç¬¬45è¡Œçœ‹èµ· if (process.env.NODE_ENV !== 'production') &#123; initProxy(vm) &#125; else &#123; vm._renderProxy = vm &#125; // expose real self vm._self = vm initLifecycle(vm) initEvents(vm) initRender(vm) callHook(vm, 'beforeCreate') initInjections(vm) // resolve injections before data/props initState(vm) initProvide(vm) // resolve provide after data/props callHook(vm, 'created') // ...å¿½ç•¥ if (vm.$options.el) &#123; vm.$mount(vm.$options.el) &#125; &#125;&#125; è¿™é‡Œæˆ‘ä»¬å™è¿°ä¸€ä¸‹ initProxyï¼Œä½œç”¨åŸŸä»£ç†ï¼Œæ‹¦æˆªç»„ä»¶å†…è®¿é—®å…¶å®ƒç»„ä»¶çš„æ•°æ®ã€‚ initLifecycle, å»ºç«‹çˆ¶å­ç»„ä»¶å…³ç³»ï¼Œåœ¨å½“å‰å®žä¾‹ä¸Šæ·»åŠ ä¸€äº›å±žæ€§å’Œç”Ÿå‘½å‘¨æœŸæ ‡è¯†ã€‚å¦‚ï¼š$childrenã€$refsã€_isMountedç­‰ã€‚ initEventsï¼Œç”¨æ¥å­˜æ”¾é™¤@hook:ç”Ÿå‘½å‘¨æœŸé’©å­åç§°=â€ç»‘å®šçš„å‡½æ•°â€äº‹ä»¶çš„å¯¹è±¡ã€‚å¦‚ï¼š$onã€$emitç­‰ã€‚ initRenderï¼Œç”¨äºŽåˆå§‹åŒ–$slotsã€$attrsã€$listeners initInjectionsï¼Œåˆå§‹åŒ–injectï¼Œä¸€èˆ¬ç”¨äºŽæ›´æ·±å±‚æ¬¡çš„ç»„ä»¶é€šä¿¡ï¼Œç›¸å½“äºŽåŠ å¼ºç‰ˆçš„propsã€‚ç”¨äºŽç»„ä»¶åº“å¼€å‘è¾ƒå¤šã€‚ åªè¦åœ¨ä¸Šä¸€å±‚çº§çš„å£°æ˜Žçš„provideï¼Œé‚£ä¹ˆä¸‹ä¸€å±‚çº§æ— è®ºå¤šæ·±éƒ½èƒ½å¤Ÿé€šè¿‡injectæ¥è®¿é—®åˆ°provideçš„æ•°æ®ã€‚è¿™ä¹ˆåšä¹Ÿæ˜¯æœ‰æ˜Žæ˜¾çš„ç¼ºç‚¹ï¼šåœ¨ä»»æ„å±‚çº§éƒ½èƒ½è®¿é—®ï¼Œå¯¼è‡´æ•°æ®è¿½è¸ªæ¯”è¾ƒå›°éš¾ï¼Œä¸çŸ¥é“æ˜¯å“ªä¸€ä¸ªå±‚çº§å£°æ˜Žäº†è¿™ä¸ªæˆ–è€…ä¸çŸ¥é“å“ªä¸€å±‚çº§æˆ–è‹¥å¹²ä¸ªå±‚çº§ä½¿ç”¨ã€‚ initStateï¼Œæ˜¯å¾ˆå¤šé€‰é¡¹åˆå§‹åŒ–çš„æ±‡æ€»ï¼ŒåŒ…æ‹¬ï¼špropsã€methodsã€dataã€computed å’Œ watch ç­‰ã€‚ initProvideï¼Œåˆå§‹åŒ–provideã€‚ vm.$mountï¼ŒæŒ‚è½½å®žä¾‹ã€‚ â€œä»€ä¹ˆé˜¶æ®µæ‰èƒ½è®¿é—®DOMï¼Ÿâ€è¿™ä¸ªå›žç­”å¯ä»¥ä»ŽbeforeCreateä»¥åŠ createdçš„è°ƒç”¨æ—¶æœºè°ˆèµ·ï¼Œæˆ‘ä»¬æ ¹æ®ä¸Šé¢çš„æ¦‚è¿°ï¼Œæ¥ç®€åŒ–ä¸‹ä»£ç : 123456callHook(vm, 'beforeCreate')// åˆå§‹åŒ– inject// åˆå§‹åŒ– propsã€methodsã€dataã€computed å’Œ watch// åˆå§‹åŒ– providecallHook(vm, 'created')// æŒ‚è½½å®žä¾‹ vm.$mount(vm.$options.el) æ‰€ä»¥å½“é¢è¯•å®˜é—®ä½ ï¼š beforeCreateä»¥åŠ created è°ƒç”¨æ—¶ï¼Œå“ªäº›æ•°æ®èƒ½ç”¨ä¸Žå¦ï¼Ÿ ä»€ä¹ˆé˜¶æ®µæ‰èƒ½è®¿é—®DOMï¼Ÿ ä¸ºä»€ä¹ˆcreatedä¹‹åŽæ‰æŒ‚è½½å®žä¾‹ï¼Ÿ â€œè°ˆè°ˆä½ å¯¹Vueçš„ç”Ÿå‘½å‘¨æœŸçš„ç†è§£â€å¸¸è§„å›žç­”è¿™é‡Œå°±ä¸è¯´äº†ï¼Œæ¥ç¨å¾®æ·±å…¥ç‚¹çš„ï¼š 1.created/mounted/updated/destroyedï¼Œä»¥åŠå¯¹åº”çš„beforeé’©å­ã€‚åˆ†åˆ«æ˜¯åˆ›å»º=&gt;æŒ‚è½½=&gt;æ›´æ–°=&gt;é”€æ¯ã€‚ 2.Vueæºç ä¸­å®šä¹‰äº†ä¸€ä¸ªmergeHookå‡½æ•°æ¥éåŽ†ä¸€ä¸ªå¸¸é‡æ•°ç»„LIFECYCLE_HOOKSï¼Œè¯¥æ•°ç»„å®žé™…ä¸Šæ˜¯ç”±ä¸Žç”Ÿå‘½å‘¨æœŸé’©å­åŒåçš„å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„ã€‚ 12345678910111213141516// v2.6.10 æœ€æ–°ç‰ˆvar LIFECYCLE_HOOKS = [ 'beforeCreate', 'created', 'beforeMount', 'mounted', 'beforeUpdate', 'updated', 'beforeDestroy', 'destroyed', 'activated', 'deactivated', 'errorCaptured', // v2.6+ 'serverPrefetch']; äºŽæ˜¯ï¼Œä½ å¯ä»¥ç­”å¤šactivated &amp; deactivatedï¼ˆkeep-alive ç»„ä»¶æ¿€æ´»/åœç”¨ï¼‰ã€errorCapturedï¼ˆv2.5 ä»¥ä¸Šç‰ˆæœ¬æœ‰çš„ä¸€ä¸ªé’©å­ï¼Œç”¨äºŽå¤„ç†é”™è¯¯ï¼‰è¿™ä¸‰ä¸ªã€‚ æ–°ç”Ÿå‘½å‘¨æœŸé’©å­ï¼šserverPrefetchæ˜¯ä»€ä¹ˆï¼Ÿå¯ä»¥çœ‹åˆ°ï¼ŒserverPrefetchå‰èº«æ˜¯ssrPrefetchã€‚é¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯ç”¨æ¥å¤„ç†ssrçš„ã€‚å…è®¸æˆ‘ä»¬åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­â€œç­‰å¾…â€å¼‚æ­¥æ•°æ®ã€‚å¯åœ¨ä»»ä½•ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œè€Œä¸ä»…ä»…æ˜¯è·¯ç”±ç»„ä»¶ã€‚ 1234567891011121314151617181920212223242526272829&lt;!-- Item.vue --&gt;&lt;template&gt; &lt;div v-if="item"&gt;&#123;&#123; item.title &#125;&#125;&lt;/div&gt; &lt;div v-else&gt;...&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; computed: &#123; item () &#123; return this.$store.state.items[this.$route.params.id] &#125; &#125;, serverPrefetch () &#123; return this.fetchItem() &#125;, mounted () &#123; if (!this.item) &#123; this.fetchItem() &#125; &#125;, methods: &#123; fetchItem () &#123; // return the Promise from the action return this.$store.dispatch('fetchItem', this.$route.params.id) &#125; &#125;&#125;&lt;/script&gt; ç»å¤§å¤šæ•°çš„é¢è¯•å®˜éƒ½ä¸ä¼šåŽ»å…³æ³¨v2.6+ ä»¥åŽçš„ä»£ç è®°å½•å’Œå˜æ›´ã€‚è¿™é‡Œå¦‚æžœä½ è¯´å‡ºè¿™ä¸ªv2.6.10çš„å˜åŒ–ï¼Œå•§å•§â€¦é¢è¯•å®˜è‚¯å®šæ›´åŠ æ¬£èµä½ ã€‚ ç”Ÿå‘½å‘¨æœŸé’©å­çš„åˆå¹¶ç­–ç•¥æ‹¿callHook(vm, &#39;created&#39;)è®²ï¼Œå…ˆåˆ¤æ–­ç»„ä»¶çš„é€‰é¡¹ä¸­æœ‰æ— å¯¹åº”åå­—çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå†åˆ¤æ–­æ˜¯å¦æœ‰ parentVal(vm)ã€‚è‹¥å­˜åœ¨parentVal(vm)ä¸”éƒ½æœ‰å¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œåˆ™ä¼šå°†ä¸¤è€…concatä¸ºä¸€ä¸ªæ•°ç»„(parentVal.concat(childVal))ã€‚æ‰€ä»¥ï¼Œç”Ÿå‘½å‘¨æœŸé’©å­å…¶å®žæ˜¯å¯ä»¥å†™æˆæ•°ç»„ã€‚å¦‚ï¼š 12345678910created: [function () &#123; console.log('first')&#125;,function () &#123; console.log('second')&#125;,function () &#123; console.log('third')&#125;] é’©å­å‡½æ•°å°†æŒ‰é¡ºåºæ‰§è¡Œ Vue-router è·¯ç”±æ¨¡å¼æœ‰å‡ ç§ï¼Ÿâ€ä¸‰ç§ &quot;hash&quot; | &quot;history&quot; | &quot;abstract&quot;ï¼Œä¸€èˆ¬äººåªçŸ¥é“ä¸¤ç§&quot;hash&quot; | &quot;history&quot;ã€‚ 123456789101112131415switch (mode) &#123; case 'history': this.history = new HTML5History(this, options.base) break case 'hash': this.history = new HashHistory(this, options.base, this.fallback) break case 'abstract': this.history = new AbstractHistory(this, options.base) break default: if (process.env.NODE_ENV !== 'production') &#123; assert(false, `invalid mode: $&#123;mode&#125;`) &#125;&#125; # modeç±»åž‹: stringé»˜è®¤å€¼: &quot;hash&quot; (æµè§ˆå™¨çŽ¯å¢ƒ) | &quot;abstract&quot; (Node.js çŽ¯å¢ƒ)å¯é€‰å€¼: &quot;hash&quot; | &quot;history&quot; | &quot;abstract&quot;é…ç½®è·¯ç”±æ¨¡å¼: hash: ä½¿ç”¨ URL hash å€¼æ¥ä½œè·¯ç”±ã€‚æ”¯æŒæ‰€æœ‰æµè§ˆå™¨ï¼ŒåŒ…æ‹¬ä¸æ”¯æŒ HTML5 History Api çš„æµè§ˆå™¨ã€‚history: ä¾èµ– HTML5 History API å’ŒæœåŠ¡å™¨é…ç½®ã€‚æŸ¥çœ‹ HTML5 History æ¨¡å¼ã€‚abstract: æ”¯æŒæ‰€æœ‰ JavaScript è¿è¡ŒçŽ¯å¢ƒï¼Œå¦‚ Node.js æœåŠ¡å™¨ç«¯ã€‚å¦‚æžœå‘çŽ°æ²¡æœ‰æµè§ˆå™¨çš„ APIï¼Œè·¯ç”±ä¼šè‡ªåŠ¨å¼ºåˆ¶è¿›å…¥è¿™ä¸ªæ¨¡å¼. â€œè°ˆè°ˆä½ å¯¹keep-aliveçš„äº†è§£ï¼Ÿâ€å…ˆè´´ä¸€ä¸ªå¸¸è§„å›žç­”ï¼š keep-aliveæ˜¯ Vue å†…ç½®çš„ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥ä½¿è¢«åŒ…å«çš„ç»„ä»¶ä¿ç•™çŠ¶æ€ï¼Œæˆ–é¿å…é‡æ–°æ¸²æŸ“ã€‚åœ¨vue 2.1.0 ç‰ˆæœ¬ä¹‹åŽï¼Œkeep-aliveæ–°åŠ å…¥äº†ä¸¤ä¸ªå±žæ€§: include(åŒ…å«çš„ç»„ä»¶ç¼“å­˜) ä¸Ž exclude(æŽ’é™¤çš„ç»„ä»¶ä¸ç¼“å­˜ï¼Œä¼˜å…ˆçº§å¤§äºŽinclude) ã€‚ ç„¶åŽä½ å¯ä»¥å¼€å§‹éªšäº†ï¼š 1.&lt;keep-alive&gt;æ˜¯ Vue æºç ä¸­å®žçŽ°çš„ä¸€ä¸ªå…¨å±€æŠ½è±¡ç»„ä»¶ï¼Œé€šè¿‡è‡ªå®šä¹‰ render å‡½æ•°å¹¶ä¸”åˆ©ç”¨äº†æ’æ§½æ¥å®žçŽ°æ•°æ®ç¼“å­˜å’Œæ›´æ–°ã€‚å®ƒçš„å®šä¹‰åœ¨src/core/components/keep-alive.js ä¸­ï¼š 12345export default &#123; name: 'keep-alive', abstract: true, ...&#125; 2.æ‰€æœ‰çš„æŠ½è±¡ç»„ä»¶æ˜¯é€šè¿‡å®šä¹‰abstracté€‰é¡¹æ¥å£°æ˜Žçš„ã€‚æŠ½è±¡ç»„ä»¶ä¸æ¸²æŸ“çœŸå®žDOMï¼Œä¸”ä¸ä¼šå‡ºçŽ°åœ¨çˆ¶å­å…³ç³»çš„è·¯å¾„ä¸Šï¼ˆinitLifecycleä¼šå¿½ç•¥æŠ½è±¡ç»„ä»¶ï¼‰ï¼Œç›¸å…³ä»£ç ç‰‡æ®µï¼š 12345678if (parent &amp;&amp; !options.abstract) &#123; // abstract å³ `ptions.abstract` // while å¾ªçŽ¯æŸ¥æ‰¾ç¬¬ä¸€ä¸ªéžæŠ½è±¡çš„çˆ¶ç»„ä»¶ while (parent.$options.abstract &amp;&amp; parent.$parent) &#123; parent = parent.$parent &#125; parent.$children.push(vm)&#125; äº†è§£Vue2.6+æ–°å…¨å±€APIï¼šVue.observable()å—ï¼Ÿâ€Vue2.6+æ–°çš„å…¨å±€APIæ˜¯Vue.observable(),å®ƒçš„ä½¿ç”¨æ–¹å¼ 12345678910111213141516import vue from vue;const state = Vue.observable (&#123; counter: 0,&#125;);export default &#123; render () &#123; return ( &lt;div&gt; &#123;state.counter&#125; &lt;button v-on:click=&#123;() =&gt; &#123;state.counter ++; &#125;&#125;&gt; Increment counter &lt;/ button&gt; &lt;/ div&gt; ); &#125;,&#125;; è€Œå®ƒå®šä¹‰åœ¨/src/core/global-api/index.jsç¬¬48è¡Œï¼š 1234567import &#123; observe &#125; from 'core/observer/index'// ...// 2.6 explicit observable APIVue.observable = &lt;T&gt;(obj: T): T =&gt; &#123;observe(obj)return obj&#125; å†çœ‹çœ‹å®ƒimportçš„observeï¼Œæœ€è¿‘ä¸€æ¬¡æäº¤åœ¨12/1/2018 æ ¸å¿ƒå°±æ˜¯æš´éœ²å‡ºobserve(obj)è§‚æµ‹åŽçš„æ•°æ®ï¼Œä»£ç å•¥éƒ½æ²¡æ”¹]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (äº”) --Node.jsçš„æ¨¡å—åŒ–]]></title>
    <url>%2F2019%2F03%2F26%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E4%BA%94)%20--Node-js%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96%2F</url>
    <content type="text"><![CDATA[Nodejså®šä¹‰æ¨¡å—Nodejsçš„æ¨¡å—åŒ–ç”±äºŽå‡ºçŽ°çš„è¾ƒæ—©ï¼Œå› æ­¤å®ƒéµå¾ªçš„æ˜¯CommonJSè§„èŒƒï¼Œè€ŒéžES6çš„æ¨¡å—åŒ–ã€‚ åœ¨Nodejsçš„æ¨¡å—åŒ–ä¸­ï¼Œæœ€å¸¸ç”¨åˆ°çš„æœ‰moduleå¯¹è±¡ã€exportså¯¹è±¡ã€requireæ–¹æ³•ã€‚ å…¶ä¸­moduleå’Œexportsç”¨äºŽè¾“å‡ºæ¨¡å—ï¼Œrequireç”¨äºŽå¼•ç”¨æ¨¡å—ã€‚ ä¸€ä¸ªç®€å•çš„æ¨¡å—ä¾‹å­å…ˆæ–°å»ºä¸€ä¸ªmodule1.jsæ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234module.exports.a = 1module.exports.b = 2let c = 3 åœ¨require.jsä¸­ï¼Œå¼•å…¥æ¨¡å—å¹¶æ‰“å°ï¼š 123const module1 = require('./module1')console.log(module1) å¯ä»¥çœ‹åˆ°æ‰“å°ç»“æžœï¼š{ a: 1, b: 2 }ã€‚ è¿™æ®µä»£ç çš„å«ä¹‰å¦‚ä¸‹ï¼š 1.module1.jså¯¹å¤–è¾“å‡ºäº†module.exportsï¼Œmodule.exportsä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå«æœ‰aå’Œbå±žæ€§ã€‚ 2.module1.jsä¸­è™½ç„¶å®šä¹‰äº†å˜é‡cï¼Œä½†å®ƒåªåœ¨module1.jsè¿™ä¸ªæ¨¡å—ä¸­å­˜åœ¨ï¼Œä»Žå¤–éƒ¨æ— æ³•è®¿é—®ã€‚ 3.åœ¨require.jsä¸­å¼•ç”¨module1.jsï¼Œå¿…é¡»ä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚ 4.è‹¥å¼•ç”¨æ—¶ä¸å¸¦è·¯å¾„ï¼Œè€Œæ˜¯ç›´æŽ¥ä½¿ç”¨æ¨¡å—åç§°ï¼Œåˆ™ä¼šé»˜è®¤å¼•ç”¨é¡¹ç›®ç›®å½•ä¸‹çš„node_modulesæ–‡ä»¶å¤¹ä¸‹çš„æ¨¡å—ï¼Œå¦‚ï¼š 123const module2 = require('module2')console.log(module2) // &#123; a: 1, b: 2 &#125; è‹¥æ­¤æ—¶é¡¹ç›®ç›®å½•ä¸‹çš„node_modulesæ–‡ä»¶å¤¹ä¸‹å­˜åœ¨module2.jsæ–‡ä»¶ï¼Œåˆ™ä¼šå¼•ç”¨è¯¥æ–‡ä»¶ã€‚ è‹¥ä¸å­˜åœ¨ï¼Œåˆ™ä¼šæŸ¥æ‰¾ç³»ç»Ÿçš„node_modulesæ–‡ä»¶å¤¹ä¸‹ï¼Œå³å…¨å±€å®‰è£…çš„æ¨¡å—ï¼Œæ˜¯å¦å­˜åœ¨module2ã€‚ è‹¥è¿˜ä¸å­˜åœ¨è¯¥æ¨¡å—ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚ é€šè¿‡requireå¯¼å…¥çš„æ¨¡å—ï¼Œå¯ä»¥è¢«ä»»æ„å‘½åï¼Œå› æ­¤å†™æˆconst a = require(â€˜module2â€™)ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ module.exportsä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­çš„æ¨¡å—å¯¼å‡ºï¼Œè¿˜å¯ä»¥çœç•¥moduleï¼Œç›´æŽ¥å†™æˆexports.a = 1; exports.b = 1; â€¦ã€‚ ä½†ç›´æŽ¥ä½¿ç”¨exportså¯¼å‡ºï¼Œä¹Ÿä»…æ”¯æŒè¿™ç§å†™æ³•ï¼Œè‹¥å†™æˆï¼š 1234exports = &#123; a: 1, b: 2&#125; åœ¨å¼•ç”¨æ¨¡å—æ—¶ï¼Œåªèƒ½æŽ¥æ”¶åˆ°{}ï¼Œä¹Ÿå°±æ˜¯è¯´exportsåªæ”¯æŒexports.a = 1;è¿™æ ·çš„è¯­æ³•ã€‚ å¦‚æžœè¦å°†æ•´ä¸ªæ¨¡å—ç›´æŽ¥å®šä¹‰ä¸ºä¸€ä¸ªå¯¹è±¡ã€å‡½æ•°ã€å˜é‡ã€ç±»ï¼Œåˆ™éœ€è¦ä½¿ç”¨module.exports = 123ã€‚ 1234567891011121314151617181920212223242526module.exports = &#123; a: 1, b: 2&#125;module.exports = 123module.exports = &#123; a: 1, b: 2, c: 3&#125;module.exports = function () &#123; console.log('test')&#125;module.exports = class &#123; constructor(name) &#123; this.name = name &#125; show() &#123; console.log(`Show $&#123;this.name&#125;`) &#125;&#125; module.exportså¯ä»¥è®©æ¨¡å—è¢«èµ‹å€¼æˆä»»æ„ç±»åž‹ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯æ­¤æ—¶module.exportsç±»ä¼¼äºŽä¸€ä¸ªæ¨¡å—å†…çš„å…¨å±€å˜é‡ã€‚ å¯¹å®ƒçš„é‡å¤èµ‹å€¼ï¼Œåªæœ‰æœ€åŽçš„å€¼æœ‰æ•ˆï¼Œä¹‹å‰çš„å€¼ä¼šç›´æŽ¥è¢«è¦†ç›–ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œmodule3.jsæ¨¡å—æœ€ç»ˆå¯¼å‡ºä¸ºä¸€ä¸ªç±»ã€‚ å› æ­¤ï¼Œé€šå¸¸æŽ¨èä½¿ç”¨module.exportsï¼Œå¯ä»¥é¿å…å‡ºé”™ã€‚]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (å››) --å¤„ç†æŽ¥æ”¶åˆ°çš„POSTæ•°æ®]]></title>
    <url>%2F2019%2F03%2F25%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E5%9B%9B)%20--%E5%A4%84%E7%90%86%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84POST%E6%95%B0%E6%8D%AE%2F</url>
    <content type="text"><![CDATA[POSTæ•°æ®é‡é€šå¸¸è¾ƒå¤§ï¼Œé€šå¸¸ä¸ä¼šä¸€æ¬¡æ€§ä»Žå®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡ç«¯ï¼Œå…·ä½“æ¯æ¬¡å‘é€çš„å¤§å°ç”±åè®®ï¼Œä»¥åŠå®¢æˆ·ç«¯ä¸ŽæœåŠ¡ç«¯ä¹‹é—´çš„åå•†å†³å®šã€‚ å› æ­¤ï¼ŒNodejsåœ¨å¤„ç†POSTæ•°æ®æ—¶ï¼Œéœ€è¦é€šè¿‡requestå¯¹è±¡çš„dataäº‹ä»¶ï¼ŒèŽ·å–æ¯æ¬¡ä¼ è¾“çš„æ•°æ®ï¼Œå¹¶åœ¨endäº‹ä»¶è°ƒç”¨æ—¶ï¼Œå¤„ç†æ‰€æœ‰èŽ·å–çš„æ•°æ®ã€‚ requestå¯¹è±¡æ˜¯ä¸€ä¸ªhttp.IncomingMessage ç±»ï¼Œè€Œå®ƒå®žçŽ°äº†å¯è¯»æµæŽ¥å£ï¼Œå› æ­¤å…·æœ‰äº†å¯è¯»æµçš„dataã€endç­‰äº‹ä»¶ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œdataäº‹ä»¶ä¸­ä¼ å…¥çš„å‚æ•°æ˜¯Bufferï¼ŒBufferåªæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶çš„æ•°æ®ï¼Œå®ƒæœ‰å¯èƒ½åªæ˜¯ä¸€æ®µå­—ç¬¦ä¸²æ•°æ®ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥å¤„ç†Bufferæ•°æ®çš„æ—¶å€™è¦æ³¨æ„è¿™ä¸€ç‚¹ã€‚ 123456789101112131415161718192021const http = require('http')const querystring = require('querystring')const server = http.createServer((req, res) =&gt; &#123; let bufferArray = [] // ç”¨äºŽå­˜å‚¨dataäº‹ä»¶èŽ·å–çš„Bufferæ•°æ®ã€‚ req.on('data', (buffer) =&gt; &#123; bufferArray.push(buffer) // å°†Bufferæ•°æ®å­˜å‚¨åœ¨æ•°ç»„ä¸­ã€‚ &#125;) req.on('end', () =&gt; &#123; // Buffer ç±»æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä½¿ç”¨æ—¶æ— éœ€ require('buffer').Bufferã€‚ // Buffer.concatæ–¹æ³•ç”¨äºŽåˆå¹¶Bufferæ•°ç»„ã€‚ const buffer = Buffer.concat(bufferArray) // å·²çŸ¥Bufferæ•°æ®åªæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™å¯ä»¥ç›´æŽ¥ç”¨toStringå°†å…¶è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚ const post = querystring.parse(buffer.toString()) console.log(post) &#125;)&#125;)server.listen(8080) åŒæ—¶å¤„ç†GET/POSTè¯·æ±‚é€šå¸¸åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒåŒä¸€å°æœåŠ¡å™¨éœ€è¦æŽ¥æ”¶å¤šç§ç±»åž‹çš„è¯·æ±‚ï¼Œå¹¶åŒºåˆ†ä¸åŒæŽ¥å£ï¼Œå‘å®¢æˆ·ç«¯è¿”å›žæ•°æ®ã€‚ æœ€å¸¸ç”¨çš„æ–¹å¼ï¼Œå°±æ˜¯å¯¹è¯·æ±‚çš„æ–¹æ³•ã€urlè¿›è¡ŒåŒºåˆ†åˆ¤æ–­ï¼ŒèŽ·å–åˆ°æ¯ä¸ªè¯·æ±‚çš„æ•°æ®åŽï¼Œç»Ÿä¸€ç”±ä¸€ä¸ªå›žè°ƒå‡½æ•°è¿›è¡Œå¤„ç†ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647const http = require('http')const url = require('url')const querystring = require('querystring')const server = http.createServer((req, res) =&gt; &#123; // å®šä¹‰å…¬å…±å˜é‡ï¼Œå­˜å‚¨è¯·æ±‚æ–¹æ³•ã€è·¯å¾„ã€æ•°æ® const method = req.method let path = '' let get = &#123;&#125; let post = &#123;&#125; // åˆ¤æ–­è¯·æ±‚æ–¹æ³•ä¸ºGETè¿˜æ˜¯POSTï¼ŒåŒºåˆ†å¤„ç†æ•°æ® if (method === 'GET') &#123; // ä½¿ç”¨url.parseè§£æžgetæ•°æ® const &#123; pathname, query &#125; = url.parse(req.url, true) path = pathname get = query complete() &#125; else if (method === 'POST') &#123; path = req.url let arr = [] req.on('data', (buffer) =&gt; &#123; // èŽ·å–POSTè¯·æ±‚çš„Bufferæ•°æ® arr.push(buffer) &#125;) req.on('end', () =&gt; &#123; // å°†Bufferæ•°æ®åˆå¹¶ let buffer = Buffer.concat(arr) // å¤„ç†æŽ¥æ”¶åˆ°çš„POSTæ•°æ® post = querystring.parse(buffer.toString()) complete() &#125;) &#125; // åœ¨å›žè°ƒå‡½æ•°ä¸­ç»Ÿä¸€å¤„ç†è§£æžåŽçš„æ•°æ® function complete() &#123; console.log(method, path, get, post) &#125;&#125;)server.listen(8080) å®žçŽ°ä¸€ä¸ªå¸¦æŽ¥å£è¯·æ±‚çš„ç®€å•æœåŠ¡å™¨è™½ç„¶å½“å‰è¿˜æœªæ¶‰åŠåˆ°æ•°æ®åº“çš„çŸ¥è¯†ï¼Œä½†å·²ç»å¯ä»¥é€šè¿‡æ–‡ä»¶è¯»å†™ï¼Œå®žçŽ°ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨ï¼Œéœ€æ±‚å¦‚ä¸‹ï¼š ç”¨æˆ·é€šè¿‡GETæ–¹æ³•è¯·æ±‚/regæŽ¥å£ï¼Œå®žçŽ°æ³¨å†Œæµç¨‹ã€‚ ç”¨æˆ·é€šè¿‡POSTæ–¹æ³•è¯·æ±‚/loginæŽ¥å£ï¼Œå®žçŽ°ç™»å½•æµç¨‹ã€‚ éžæŽ¥å£è¯·æ±‚åˆ™ç›´æŽ¥è¿”å›žç›¸åº”æ–‡ä»¶ã€‚ å®žçŽ°æ€è·¯ æ–°å»ºusers.jsonæ–‡ä»¶ï¼Œç”¨äºŽå­˜æ”¾ç”¨æˆ·åˆ—è¡¨æ•°æ®ã€‚ æ–°å»ºindex.htmlæ–‡ä»¶ï¼Œå®žçŽ°è¡¨å•åŠæ³¨å†Œã€ç™»å½•çš„å‰ç«¯è¯·æ±‚åŠŸèƒ½ã€‚ æœåŠ¡ç«¯åˆ¤æ–­è¯·æ±‚è·¯å¾„ï¼Œå†³å®šæ˜¯å‰ç«¯æ˜¯é€šè¿‡æŽ¥å£æ ¡éªŒç”¨æˆ·æ•°æ®ï¼Œè¿˜æ˜¯è¯·æ±‚HTMLæ–‡ä»¶ã€‚ è‹¥æ˜¯æŽ¥å£è¯·æ±‚ï¼Œåˆ™é€šè¿‡ç”¨æˆ·åˆ—è¡¨åˆ¤æ–­ç”¨æˆ·çŠ¶æ€ï¼Œå®žçŽ°æ³¨å†Œå’Œç™»å½•æµç¨‹ã€‚ ä»£ç åŠç¤ºä¾‹html1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; ç”¨æˆ·ï¼š&lt;input type="text" name="username" id="username"&gt;&lt;br/&gt; å¯†ç ï¼š&lt;input type="text" name="password" id="password"&gt;&lt;br/&gt; &lt;input type="button" value="æ³¨å†Œ" id="reg"&gt; &lt;input type="button" value="ç™»å½•" id="login"&gt; &lt;script&gt; // æ³¨å†Œ document.querySelector('#reg').addEventListener('click', async function () &#123; const response = await fetch(`/reg?username=$&#123;document.querySelector('#username').value&#125;&amp;password=$&#123;document.querySelector('#password').value&#125;`) const result = await response.json() console.log(result) alert(result.msg) &#125;) // ç™»å½• document.querySelector('#login').addEventListener('click', async function () &#123; const response = await fetch(`/login`, &#123; method: 'POST', body: JSON.stringify(&#123; username: document.querySelector('#username').value, password: document.querySelector('#password').value &#125;) &#125;) const result = await response.json() console.log(result) alert(result.msg) &#125;) &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; server.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148const http = require('http')const url = require('url')const fs = require('fs')const querystring = require('querystring')const server = http.createServer((req, res) =&gt; &#123; // å®šä¹‰å…¬å…±å˜é‡ï¼Œå­˜å‚¨è¯·æ±‚æ–¹æ³•ã€è·¯å¾„ã€æ•°æ® const method = req.method let path = '' let get = &#123;&#125; let post = &#123;&#125; // åˆ¤æ–­è¯·æ±‚æ–¹æ³•ä¸ºGETè¿˜æ˜¯POSTï¼ŒåŒºåˆ†å¤„ç†æ•°æ® if (method === 'GET') &#123; // ä½¿ç”¨url.parseè§£æžgetæ•°æ® const &#123; pathname, query &#125; = url.parse(req.url, true) path = pathname get = query complete() &#125; else if (method === 'POST') &#123; path = req.url let arr = [] req.on('data', (buffer) =&gt; &#123; // èŽ·å–POSTè¯·æ±‚çš„Bufferæ•°æ® arr.push(buffer) &#125;) req.on('end', () =&gt; &#123; // å°†Bufferæ•°æ®åˆå¹¶ let buffer = Buffer.concat(arr) // å¤„ç†æŽ¥æ”¶åˆ°çš„POSTæ•°æ® post = JSON.parse(buffer.toString()) complete() &#125;) &#125; // åœ¨å›žè°ƒå‡½æ•°ä¸­ç»Ÿä¸€å¤„ç†è§£æžåŽçš„æ•°æ® function complete() &#123; try &#123; if (path === '/reg') &#123; // èŽ·å–getè¯·æ±‚æ•°æ® const &#123; username, password &#125; = get // è¯»å–user.jsonæ–‡ä»¶ fs.readFile('./users.json', (error, data) =&gt; &#123; if (error) &#123; res.writeHead(404) &#125; else &#123; // è¯»å–ç”¨æˆ·æ•°æ® const users = JSON.parse(data.toString()) const usernameIndex = users.findIndex((item) =&gt; &#123; return username === item.username &#125;) // åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ if (usernameIndex &gt;= 0) &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'æ­¤ç”¨æˆ·åå·²å­˜åœ¨' &#125;)) res.end() &#125; else &#123; // ç”¨æˆ·åä¸å­˜åœ¨åˆ™åœ¨ç”¨æˆ·åˆ—è¡¨ä¸­å¢žåŠ ä¸€ä¸ªç”¨æˆ· users.push(&#123; username, password &#125;) // å°†æ–°çš„ç”¨æˆ·åˆ—è¡¨ä¿å­˜åˆ°user.jsonæ–‡ä»¶ä¸­ fs.writeFile('./users.json', JSON.stringify(users), (error) =&gt; &#123; if (error) &#123; res.writeHead(404) &#125; else &#123; res.write(JSON.stringify(&#123; error: 0, msg: 'æ³¨å†ŒæˆåŠŸ' &#125;)) &#125; res.end() &#125;) &#125; &#125; &#125;) &#125; else if (path === '/login') &#123; const &#123; username, password &#125; = post // è¯»å–users.json fs.readFile('./users.json', (error, data) =&gt; &#123; if (error) &#123; res.writeHead(404) &#125; else &#123; // èŽ·å–useråˆ—è¡¨æ•°æ® const users = JSON.parse(data.toString()) const usernameIndex = users.findIndex((item) =&gt; &#123; return username === item.username &#125;) if (usernameIndex &gt;= 0) &#123; // ç”¨æˆ·åå­˜åœ¨ï¼Œåˆ™æ ¡éªŒå¯†ç æ˜¯å¦æ­£ç¡® if (users[usernameIndex].password === password) &#123; res.write(JSON.stringify(&#123; error: 0, msg: 'ç™»å½•æˆåŠŸ' &#125;)) &#125; else &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'å¯†ç é”™è¯¯' &#125;)) &#125; &#125; else &#123; res.write(JSON.stringify(&#123; error: 1, msg: 'è¯¥ç”¨æˆ·ä¸å­˜åœ¨' &#125;)) &#125; &#125; res.end() &#125;) &#125; else &#123; // è‹¥ä¸æ˜¯æ³¨å†Œæˆ–ç™»å½•æŽ¥å£ï¼Œåˆ™ç›´æŽ¥è¿”å›žç›¸åº”æ–‡ä»¶ fs.readFile(`.$&#123;path&#125;`, (error, data) =&gt; &#123; if (error) &#123; res.writeHead(404) &#125; else &#123; res.write(data) &#125; res.end() &#125;) &#125; &#125; catch (error) &#123; console.error(error); &#125; &#125;&#125;)server.listen(8080)]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (ä¸‰) --å¤„ç†æŽ¥æ”¶åˆ°çš„GETæ•°æ®]]></title>
    <url>%2F2019%2F03%2F19%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E4%B8%89)%20--%E5%A4%84%E7%90%86%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84GET%E6%95%B0%E6%8D%AE%2F</url>
    <content type="text"><![CDATA[å¸¸ç”¨è¯·æ±‚æ–¹å¼GETå’ŒPOSTæ˜¯æœ€å¸¸ç”¨çš„HTTPè¯·æ±‚æ–¹æ³•ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰DELETEã€HEADã€OPTIONSã€PUTã€TRACEç­‰ï¼Œä½†éƒ½å¾ˆå°‘ç”¨åˆ°ã€‚ GET POST ä¸»è¦ç”¨äºŽèŽ·å–æ•°æ® ä¸»è¦ç”¨äºŽå‘é€æ•°æ® æ•°æ®æ”¾åœ¨HTTPè¯·æ±‚Headerä¸­ï¼Œé€šè¿‡URLè¿›è¡Œä¼ è¾“ï¼Œå®¹é‡&lt;=32k æ•°æ®æ”¾åœ¨HTTPè¯·æ±‚bodyä¸­,å®¹é‡å¤§ï¼Œé€šå¸¸ä¸Šé™2G å¤„ç†Getæ•°æ®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Nodejsè‡ªå¸¦çš„urlå’Œquerystringæ¨¡å—å¤„ç†æŽ¥æ”¶åˆ°çš„GETæ•°æ®ã€‚ é¦–å…ˆæ–°å»ºä¸€ä¸ªå¸¦formè¡¨å•çš„HTMLæ–‡ä»¶ï¼Œè®²è¾“å…¥çš„æ•°æ®æäº¤åˆ°æœåŠ¡å™¨åœ°å€ï¼š 12345&lt;form action="http://localhost:8080/login" method="get"&gt; ç”¨æˆ·ï¼š&lt;input type="text" name="username"&gt;&lt;br/&gt; å¯†ç ï¼š&lt;input type="text" name="password"&gt;&lt;br/&gt; &lt;input type="submit" value="æäº¤"&gt;&lt;/form&gt; æœåŠ¡ç«¯åœ¨æŽ¥æ”¶åˆ°è¯·æ±‚æ•°æ®æ—¶ï¼Œå¯ä»¥æœ‰3ç§æ–¹å¼å¤„ç†æ•°æ®ï¼š å°†è¯·æ±‚æ•°æ®ä¸­çš„req.urlè¿›è¡Œå­—ç¬¦ä¸²åˆ‡å‰²ï¼Œå†ç”¨querystringæ¨¡å—èŽ·å–æ•°æ®ã€‚ 123const [ pathname, queryStr ] = req.url.split('?')const query = querystring.parse(queryStr)console.log(pathname, query) ç”¨URLæž„é€ å‡½æ•°å®žä¾‹åŒ–ä¸€ä¸ªurlå¯¹è±¡ï¼Œä»Žä¸­èŽ·å–åˆ°pathnameå’Œsearchå€¼ï¼Œå†ç”¨querystringæ¨¡å—è§£æžsearchæ•°æ® 1234const url = new URL(`http://localhost:8080$&#123;req.url&#125;`)const &#123; pathname, search &#125; = urlconst query = querystring.parse(search.substring(1, url.search.length))console.log(pathname, query) ä½¿ç”¨urlæ¨¡å—çš„parseæ–¹æ³•ï¼Œç›´æŽ¥è§£æžå‡ºæ•°æ®ã€‚ 123// parseæ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°è‹¥ä¼ trueï¼Œåˆ™ä¼šç›´æŽ¥å°†è§£æžå‡ºçš„queryå€¼è½¬ä¸ºå¯¹è±¡å½¢å¼ï¼Œå¦åˆ™å®ƒåªæ˜¯å­—ç¬¦ä¸²å½¢å¼const &#123; pathname, query &#125; = url.parse(req.url, true)console.log(pathname, query)]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (äºŒ) --ä½¿ç”¨httpå’Œfsæ¨¡å—å®žçŽ°ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨]]></title>
    <url>%2F2019%2F03%2F19%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E4%BA%8C)%20--%E4%BD%BF%E7%94%A8http%E5%92%8Cfs%E6%A8%A1%E5%9D%97%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%2F</url>
    <content type="text"><![CDATA[å‡†å¤‡1.åˆ›å»ºä¸€ä¸ªwwwç›®å½•ï¼Œå­˜å‚¨é™æ€æ–‡ä»¶1.htmlã€1.jpgã€‚ * htmlæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; ç½‘é¡µå†…å®¹ &lt;img src="/1.jpg" alt=""&gt;&lt;/body&gt;&lt;/html&gt; é¢„æœŸå®žçŽ°çš„ç»“æžœä¸ºï¼š a. åœ¨æµè§ˆå™¨è®¿é—®http://localhost:8080/1.htmlã€‚ b. è¯»å–åˆ°www/1.htmlï¼Œç”±HTMLæ–‡ä»¶å‘èµ·å¯¹www/1.jpgçš„è¯·æ±‚ã€‚ c. ç½‘é¡µä¸­æ˜¾ç¤ºHTMLå†…å®¹å’Œå›¾ç‰‡ã€‚ ä½¿ç”¨Nodejså®žçŽ°æœåŠ¡ç«¯ä»£ç ï¼š 1234567891011121314151617const http = require('http')const fs = require('fs')const server = http.createServer((request, response) =&gt; &#123; console.log(request.url) // åœ¨requestå¯¹è±¡ä¸­ï¼Œå¯ä»¥èŽ·å–è¯·æ±‚çš„URLï¼Œé€šè¿‡URLåˆ¤æ–­è¯·æ±‚çš„èµ„æºã€‚ fs.readFile(`./www$&#123;request.url&#125;`, (error, buffer) =&gt; &#123; // æ ¹æ®URLæŸ¥æ‰¾è¯»å–ç›¸åº”çš„æ–‡ä»¶ã€‚ if (error) &#123; // è‹¥è¯»å–é”™è¯¯ï¼Œåˆ™å‘å‰ç«¯è¿”å›ž404çŠ¶æ€ç ï¼Œä»¥åŠå†…å®¹Not Foundã€‚ response.writeHead(404) response.write('Not Found') &#125; else &#123; // è‹¥è¯»å–æˆåŠŸï¼Œåˆ™å‘å‰ç«¯è¿”å›žè¯»å–åˆ°çš„æ–‡ä»¶ã€‚ response.write(buffer) &#125; response.end() // å…³é—­è¿žæŽ¥ã€‚ &#125;)&#125;)server.listen(8080) æœåŠ¡å™¨éœ€è¦å…·å¤‡çš„åŸºæœ¬åŠŸèƒ½1.å“åº”è¯·æ±‚ å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œå¯ä»¥æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åšå‡ºå›žåº”ï¼Œå¦‚è¿”å›žé™æ€æ–‡ä»¶ã€‚2 æ•°æ®äº¤äº’ å®šä¹‰æŽ¥å£ï¼Œå®¢æˆ·ç«¯æ ¹æ®æŽ¥å£ï¼Œä¸ŽæœåŠ¡ç«¯è¿›è¡Œæ•°æ®äº¤äº’ã€‚ ä¾‹å¦‚åœ¨ä¸€ä¸ªè´­ç‰©æµç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯è¯·æ±‚å•†å“æ•°æ®ï¼Œå±•çŽ°ç»™å®¢æˆ·ï¼Œå®¢æˆ·åœ¨è´­ä¹°æ—¶ï¼Œå®¢æˆ·ç«¯å°†è´­ä¹°çš„å•†å“ä¿¡æ¯å‘é€ç»™æœåŠ¡ç«¯å¤„ç†ã€‚ æ•°æ®åº“3.å¯¹æ•°æ®åº“ä¸­å­˜å‚¨çš„æ•°æ®è¿›è¡Œè¯»å†™æ“ä½œã€‚]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå­¦ä¹ (ä¸€) --NodeJsç®€ä»‹]]></title>
    <url>%2F2019%2F03%2F18%2FNode%2FNode%E5%AD%A6%E4%B9%A0(%E4%B8%80)%20--NodeJs%E7%AE%80%E4%BB%8B%2F</url>
    <content type="text"><![CDATA[NodeJsç®€ä»‹ ç®€å•çš„è¯´Node.jså°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„Javascript Node.jsæ˜¯ä¸€ä¸ªåŸºäºŽChromeV8å¼•æ“Žçš„Javascriptçš„æ‰§è¡ŒçŽ¯å¢ƒ Node.jsä½¿ç”¨äº†ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ï¼Œéžé˜»å¡žå¼I/Oçš„æ¨¡åž‹ï¼Œä½¿å…¶è½»é‡æœ‰é«˜æ•ˆ NodeJsçš„åº”ç”¨çŽ¯å¢ƒç”±äºŽNodejsç›®å‰è¿˜ä¸å¤Ÿæˆç†Ÿï¼Œå› æ­¤ä¸€èˆ¬ä¸ä¼šç”¨ä½œç‹¬ç«‹å¼€å‘ï¼Œå®ƒçš„ä¸»è¦ç”¨é€”å¦‚ä¸‹ ä¸­é—´å±‚é€šå¸¸åœ¨å¼€å‘åº”ç”¨æ—¶ï¼Œå‡ºäºŽå®‰å…¨è€ƒè™‘ï¼ŒåŽç«¯çš„ä¸»æœåŠ¡å™¨éƒ½ä¸ä¼šç›´æŽ¥æš´éœ²ç»™å®¢æˆ·ç«¯ï¼Œä¸¤ç«¯ä¹‹é—´é€šå¸¸éœ€è¦æœ‰ä¸€ä¸ªä¸­é—´å±‚è¿›è¡Œé€šä¿¡ã€‚ è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå¦‚æžœä¸­é—´å±‚å‡ºçŽ°é—®é¢˜ï¼Œä¸ä¼šå½±å“åŽç«¯çš„ä¸»æœåŠ¡å™¨ã€‚å¦å¤–ï¼Œä¸­é—´å±‚å¯ä»¥åšç¼“å­˜ï¼Œæˆ–è€…å®žçŽ°ä¸€äº›ä¸šåŠ¡é€»è¾‘ï¼Œèµ·åˆ°é™ä½Žä¸»æœåŠ¡å™¨å¤æ‚åº¦ï¼Œæé«˜æ€§èƒ½çš„ä½œç”¨ã€‚ ä¸­é—´å±‚ä¹Ÿå¯ä»¥åƒCDNä¸€æ ·åœ¨å„å¤„éƒ¨ç½²ï¼Œä»¥æé«˜ç”¨æˆ·çš„è®¿é—®æ•ˆçŽ‡ã€‚ å°åž‹æœåŠ¡å¯ä»¥å®žçŽ°ä¸€äº›å°åž‹åº”ç”¨ï¼Œæˆ–æŸä¸ªåŠŸèƒ½æ¨¡å—ã€‚ å·¥å…·ç±»å·¥å…·ç±» Nodejså¯ä»¥ç”¨æ¥å¼€å‘ä¸€äº›å®žç”¨å·¥å…·ï¼Œå¦‚Webpackã€Gulpç­‰ç­‰ã€‚ Nodejsçš„ä¼˜åŠ¿ Nodejsçš„è¯­æ³•ä¸Žå‰å°JavaScriptç›¸åŒï¼Œå› æ­¤ä¾¿äºŽå‰ç«¯å¼€å‘å…¥æ‰‹ æ€§èƒ½é«˜ åˆ©äºŽä¸Žå‰ç«¯ä»£ç ç»“åˆï¼Œä¾‹å¦‚åœ¨åšåŒæ ·ä¸€ä¸ªæ•°æ®æ ¡éªŒæ—¶ï¼Œå‰åŽå°ä»£ç å¯ä»¥å…±ç”¨ï¼Œä¸éœ€è¦å•ç‹¬å¼€å‘ã€‚ Nodejsçš„å¸è½½å½“éœ€è¦å‡çº§Nodejsæ—¶ï¼Œå»ºè®®å…ˆå®Œå…¨å¸è½½æ—§ç‰ˆæœ¬ï¼Œç‰¹åˆ«æ˜¯å…¨å±€å·²ä¸‹è½½çš„ä¾èµ–ï¼Œå¦åˆ™æœ‰å°æ¦‚çŽ‡ä¼šå‡ºçŽ°æ›´æ–°ç‰ˆæœ¬åŽï¼Œæ–°å®‰è£…ä¾èµ–æ—¶æŠ¥é”™ã€‚ å®Œæ•´å¸è½½æ­¥éª¤ï¼šé€šè¿‡ç³»ç»Ÿè‡ªå¸¦å¸è½½å·¥å…·ï¼Œå¸è½½Nodejsï¼Œä¹‹åŽæœ€å¥½å°†Nodejså®‰è£…ç›®å½•æ•´ä¸ªåˆ é™¤ã€‚æ‰‹åŠ¨åˆ é™¤å®‰è£…ç›®å½•ï¼Œå¦‚C:\Program Files\nodejsç›®å½•ä¸‹çš„node_modulesæ–‡ä»¶å¤¹ã€‚æ‰¾åˆ°ç”¨æˆ·ç›®å½•ï¼Œå¦‚C:\Users\ä½ çš„ç”¨æˆ·åï¼Œå…¶ä¸­å¦‚æžœæœ‰node_modulesæ–‡ä»¶å¤¹ï¼Œåˆ™ä¸€èµ·åˆ é™¤ã€‚ å¯åŠ¨ä¸€ä¸ªNodejsæœåŠ¡å™¨æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªserver.jsæ–‡ä»¶ï¼Œåœ¨å‘½ä»¤è¡Œé€šè¿‡node server.jså‘½ä»¤ï¼Œå°±å¯ä»¥è¿è¡Œä¸€ä¸ªæœåŠ¡å™¨ï¼Œåœ¨æµè§ˆå™¨è®¿é—®ä¸­è®¿é—®http://127.0.0.1:3000/ï¼Œå°±å¯ä»¥çœ‹åˆ°Hello Worldã€‚ 12345678910111213141516171819202122// å¼•å…¥Nodejsè‡ªå¸¦çš„httpæ¨¡å—const http = require('http');// å¼•å…¥Nodejsè‡ªå¸¦çš„child_processæ¨¡å—const childProcess = require('child_process');const hostname = '127.0.0.1'; // æœ¬æœºåœ°å€const port = 3000; // ç«¯å£// åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨const server = http.createServer((req, res) =&gt; &#123; res.statusCode = 200; // è®¾ç½®å“åº”çŠ¶æ€ç  res.setHeader('Content-Type', 'text/plain'); // è®¾ç½®å“åº”å¤´ res.end('Hello World\n'); // å‘å‰å°è¾“å‡ºå†…å®¹&#125;);// å¼€å¯ç›‘å¬server.listen(port, hostname, () =&gt; &#123; // åœ¨å‘½ä»¤è¡Œæ‰“å°è¿è¡Œç»“æžœ console.log(`Server running at http://$&#123;hostname&#125;:$&#123;port&#125;/`); // ä½¿ç”¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€åœ°å€ childProcess.exec(`start http://$&#123;hostname&#125;:$&#123;port&#125;/`);&#125;); response.writeæˆ‘ä»¬ä½¿ç”¨äº†http.createServeråˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œåœ¨å®ƒçš„å›žè°ƒå‡½æ•°ä¸­ï¼Œä¼šä¼ å…¥2ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸ºrequestï¼ˆè¯·æ±‚å¯¹è±¡ï¼‰å’Œresponseï¼ˆå“åº”å¯¹è±¡ï¼‰ã€‚ é€šå¸¸ä½¿ç”¨response.writeæ–¹æ³•å‘å‰ç«¯è¿”å›žæ•°æ®ï¼Œè¯¥æ–¹æ³•å¯è°ƒç”¨å¤šæ¬¡ï¼Œè¿”å›žçš„æ•°æ®ä¼šè¢«æ‹¼æŽ¥åˆ°ä¸€èµ·ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»è°ƒç”¨response.endæ–¹æ³•ç»“æŸè¯·æ±‚ï¼Œå¦åˆ™å‰ç«¯ä¼šä¸€ç›´å¤„äºŽç­‰å¾…çŠ¶æ€ï¼Œresponse.endæ–¹æ³•ä¹Ÿå¯ä»¥ç”¨æ¥å‘å‰ç«¯è¿”å›žæ•°æ®ã€‚ 123456const server = http.createServer((request, response) =&gt; &#123; response.write('a') response.write('b') response.write('c') response.end('d')&#125;) File SystemFile Systemæ˜¯Nodejsä¸­ç”¨æ¥æ“ä½œæ–‡ä»¶çš„åº“ï¼Œå¯ä»¥é€šè¿‡const fs = require(&#39;fs&#39;)å¼•ç”¨ã€‚ å¸¸ç”¨çš„æ–¹æ³•æœ‰å¼‚æ­¥æ–‡ä»¶è¯»å–fs.readFileã€å¼‚æ­¥æ–‡ä»¶å†™å…¥fs.writeFileã€åŒæ­¥æ–‡ä»¶è¯»å–fs.readFileSyncã€åŒæ­¥æ–‡ä»¶å†™å…¥fs.writeFileSyncã€‚ç”±äºŽåŒæ­¥æ“ä½œå¯èƒ½ä¼šé€ æˆé˜»å¡žï¼Œé€šå¸¸å»ºè®®ä½¿ç”¨å¼‚æ­¥æ“ä½œé¿å…è¯¥é—®é¢˜ã€‚ fs.writeFilefs.writeFileå¯å‘æ–‡ä»¶å†™å…¥ä¿¡æ¯ï¼Œè‹¥æ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºã€‚ 1234567fs.writeFile('./test.txt', 'test', (error) =&gt; &#123; if (error) &#123; console.log('æ–‡ä»¶å†™å…¥å¤±è´¥', error) &#125; else &#123; console.log('æ–‡ä»¶å†™å…¥æˆåŠŸ') &#125;&#125;) fs.writeFileçš„ä¸»è¦å‚æ•°ï¼š ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå†™å…¥çš„æ–‡ä»¶è·¯å¾„ç¬¬äºŒä¸ªå‚æ•°ä¸ºå†™å…¥å†…å®¹ï¼ˆå¯ä¸º&lt;string&gt; | | | ï¼‰ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºå›žè°ƒå‡½æ•°ï¼Œä¼ å…¥æ•°æ®ä¸ºerrorå¯¹è±¡ï¼Œå…¶ä¸ºnullæ—¶è¡¨ç¤ºæˆåŠŸã€‚ fs.readFilefs.readFileç”¨æ¥è¯»å–æ–‡ä»¶ã€‚ 123456789fs.readFile('./test.txt', (error, data) =&gt; &#123; if (error) &#123; console.log('æ–‡ä»¶è¯»å–å¤±è´¥', error) &#125; else &#123; // æ­¤å¤„å› ç¡®å®šè¯»å–åˆ°çš„æ•°æ®æ˜¯å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æŽ¥ç”¨toStringæ–¹æ³•å°†Bufferè½¬ä¸ºå­—ç¬¦ä¸²ã€‚ // è‹¥æ˜¯éœ€è¦ä¼ è¾“ç»™æµè§ˆå™¨å¯ä»¥ç›´æŽ¥ç”¨Bufferï¼Œæœºå™¨ä¹‹é—´é€šä¿¡æ˜¯ç›´æŽ¥ç”¨Bufferæ•°æ®ã€‚ console.log('æ–‡ä»¶è¯»å–æˆåŠŸ', data.toString()) &#125;&#125;) fs.readFileä¸»è¦å‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¯»å–çš„æ–‡ä»¶è·¯å¾„ç¬¬äºŒä¸ªå‚æ•°ä¸ºå›žè°ƒå‡½æ•°ã€‚å›žè°ƒå‡½æ•°ä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºerrorå¯¹è±¡ï¼Œå…¶ä¸ºnullæ—¶è¡¨ç¤ºæˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºæ•°æ®ï¼Œå¯ä¸º&lt;string&gt; | &lt;Buffer&gt;ã€‚]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ES2019çš„æ–°åŠŸèƒ½]]></title>
    <url>%2F2019%2F03%2F16%2FJs%2FES2019%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD%2F</url>
    <content type="text"><![CDATA[å‰è¨€ECMAScript æ¯å¹´éƒ½ä¼šå‘å¸ƒä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œå…¶ä¸­çš„ææ¡ˆæ˜¯å·²ç»æ­£å¼é€šè¿‡çš„ï¼Œå¹¶åˆ†å‘ç»™å¼€å‘è€…å’Œç”¨æˆ·ã€‚æœ¬æ–‡å°†è®¨è®ºè¯¥è¯­è¨€çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä»¥åŠå®ƒåˆå…·æœ‰äº†ä»€ä¹ˆæ–°åŠŸèƒ½ã€‚ ES10/ES2019 åœ¨æœ¬æ¬¡æ›´æ–°ä¸­æœ‰å¾ˆå¤§çš„æ”¹è¿›ã€‚å®ƒå¼•å…¥äº†ä¸€äº›æ–°çš„å‡½æ•°å’Œæ–¹æ³•ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿç¼–å†™æ›´å°‘çš„ä»£ç ï¼Œå¹¶æé«˜å·¥ä½œæ•ˆçŽ‡ã€‚ flat()flat() æ˜¯ä¸€ç§ç”¨äºŽæ‰å¹³æ•°ç»„çš„æ–¹æ³•ã€‚åœ¨æŸäº›æ—¶å€™ï¼Œæ•°ç»„çš„å…ƒç´ è¿˜æ˜¯æ•°ç»„ï¼Œè¿™äº›ç±»åž‹çš„æ•°ç»„ç§°ä¸ºåµŒå¥—æ•°ç»„ã€‚ è¦å–æ¶ˆæ•°ç»„çš„åµŒå¥—ï¼ˆæ‰å¹³å®ƒä»¬ï¼‰ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ä½¿ç”¨é€’å½’ã€‚çŽ°åœ¨å¼•å…¥flat()ï¼Œå¯ä»¥ç”¨ä¸€è¡Œä»£ç å®Œæˆã€‚ ä¸€ä¸ªè¢«å±•å¹³çš„æ•°ç»„æ˜¯ä¸€ä¸ªæ·±åº¦ä¸º 0 çš„æ•°ç»„ï¼Œflat() æŽ¥å—ä¸€ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä»£è¡¨æ·±åº¦çš„æ•°å­—ã€‚æ·±åº¦æŒ‡çš„æ˜¯æ•°ç»„å†…åµŒå¥—çš„æ•°é‡ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­å¯ä»¥å¸®ä½ ç†è§£åµŒå¥—å’Œæ·±åº¦ã€‚ 12var arr = [1,2,3,[4,5,6,[7,8,9,[1,2,3]]]];console.log(arr.flat(3)); // [1,2,3,4,5,6,7,8,9,1,2,3] é€šå¸¸åœ¨ JavaScript ä¸­ï¼Œæ•°ç»„çš„æ·±åº¦å¯ä»¥ä¸ºæ— ç©·å¤§ï¼Œæˆ–è€…ç›´åˆ°å†…å­˜ä¸è¶³ä¸ºæ­¢ã€‚å‡è®¾ä¸€ä¸ªæ•°ç»„çš„åµŒå¥—æ·±åº¦ä¸º3ï¼Œå¹¶ä¸”æˆ‘ä»¬ä»…å°†å…¶å±•å¹³åˆ°æ·±åº¦ 2ï¼Œé‚£ä¹ˆä¸»æ•°ç»„ä¸­ä»ç„¶ä¼šå­˜åœ¨ä¸€ä¸ªåµŒå¥—æ•°ç»„ã€‚ flatMap()flatMap() ç”¨äºŽå±•å¹³åµŒå¥—æ•°ç»„å¹¶æ ¹æ®ç»™å‡ºçš„åƒ map() è¿™æ ·çš„å‡½æ•°æ›´æ”¹å€¼ã€‚æ­¤å‡½æ•°ä½œç”¨äºŽæ•°ç»„å¹¶ç”¨ä¸€ä¸ªå›žè°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚å›žè°ƒå‡½æ•°ç”¨äºŽæŒ‡ç¤ºæ•°ç»„åº”è¯¥æ€Žæ ·è¢«å±•å¹³ã€‚å®ƒå°±åƒ map ä¸€æ ·å·¥ä½œï¼Œæ­¤å¤–ä¹Ÿä½¿å®ƒå˜å¾—æ‰å¹³ã€‚å¦‚æžœä½ æƒ³äº†è§£æœ‰å…³ map çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹å…³äºŽthisçš„æ–‡ç« ã€‚ flatMap()`` å¯ç”¨äºŽå±•å¹³æ·±åº¦ä¸º1çš„æ•°ç»„ï¼Œå®ƒåœ¨å†…éƒ¨è°ƒç”¨ map å‡½æ•°ï¼ŒåŽè·Ÿç€å‚æ•°æ·±åº¦ä¸º1çš„ flat å‡½æ•°. 1var array = arr.flatMap((callback(currentValue))); è¿”å›žå€¼ å¸¦æœ‰æ“çºµå€¼çš„æ‰å¹³æ•°ç»„ï¼Œç”±æä¾›ç»™å®ƒçš„å›žè°ƒå‡½æ•°æä¾›ã€‚å°±åƒä¸€ä¸ªmapä¸€æ ·ã€‚ map() + flat() =&gt; flatmap() 123var arr = [1,2,3,4];console.log(arr.map(x=&gt;[x*2])); // [2],[4],[6],[8]console.log(arr.flatMap(x=&gt;[x*2])); //[2,4,6,8] åœ¨æ­¤ä¾‹ä¸­ï¼Œæˆ‘ä»¬é€ä¸ªæ˜¾ç¤º map å’Œ flatMap ä»¥æ˜¾ç¤ºä¸¤ä¸ªå‡½æ•°ä¹‹é—´çš„å·®å¼‚ã€‚ map() è¿”å›žåµŒå¥—æ•°ç»„ï¼Œè€ŒflatMap() çš„è¾“å‡ºé™¤äº†æ•°ç»„çš„å±•å¹³å¤–ï¼Œè¿˜ä¸Ž map çš„ç»“æž„ç›¸åŒã€‚ Object.fromEntries()å¦ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„å‡½æ•° Object.fromEntries ç”¨äºŽæ ¹æ®æä¾›çš„é”®å€¼å¯¹ç”Ÿæˆå¯¹è±¡ã€‚å®ƒæŽ¥å—ä¸€ä¸ªé”®å€¼å¯¹åˆ—è¡¨ï¼Œå¹¶è¿”å›žä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„å±žæ€§ç”±å‚æ•° entries66n ç»™å‡ºã€‚å®ƒçš„ä½œç”¨ä¸Ž Object.entries()ç›¸å å‚æ•°æŽ¥å—ä»»ä½•å¯è¿­ä»£çš„å¯¹è±¡ï¼Œå³æ•°ç»„ã€‚ è¿”å›žå€¼è¿”å›žæœ‰ç»™å®šé”®å€¼å¯¹çš„å¯¹è±¡ã€‚ 1234567const entries = new Map([ ['apple','orange'], ['grapes','peach']]);const obj = Object.formEntries(entries);console.log(obj);// &#123;apple:"orange",grapes:"peach"&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“å‘ fromEntries() å‡½æ•°æä¾›äº†ä¸€ä¸ªmapï¼ˆå°†å€¼æˆå¯¹å­˜å‚¨ï¼‰æ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å¯¹åº”çš„é”®å€¼å¯¹å’Œ map ä¸­ä¸€æ ·ã€‚ trimStart()trimStart() æ–¹æ³•åˆ é™¤å­—ç¬¦ä¸²å¼€å¤´çš„ç©ºæ ¼ã€‚ trimLeft() æ˜¯æ­¤æ–¹æ³•çš„åˆ«åã€‚ 123var message = ' Hello World';console.log(message);// ' Hello World'console.log(message.trimStart());//'Hello World' trimEnd()trimEnd() æ–¹æ³•åˆ é™¤å­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼ã€‚ trimRight() æ˜¯æ­¤æ–¹æ³•çš„åˆ«åã€‚ 123var message = 'Hello World ';console.log(message);// ' Hello World'console.log(message.trimEnd());//'Hello World' ä¿®æ”¹ catch ç»‘å®šåœ¨ ES10 ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡è¯­æ³•ä¸º catch å­å¥ç»‘å®šå¼‚å¸¸å˜é‡ï¼Œæ— è®ºæ˜¯å¦æœ‰å¿…è¦ã€‚å¾ˆå¤šæ—¶å€™ catch å—æ˜¯å¤šä½™çš„ã€‚ ES10 ææ¡ˆä½¿æˆ‘ä»¬èƒ½å¤Ÿç®€å•çš„æŠŠå˜é‡çœç•¥æŽ‰ã€‚ ç¤ºä¾‹ 12345678function isValid(ison)&#123; try&#123; JSON.parse(json); return true; &#125;catch &#123; return false; &#125;&#125; åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æ²¡æœ‰ä¸º catch æä¾›å˜é‡ã€‚ ç¬¦å·æè¿°å½“æˆ‘ä»¬åœ¨ JS ä¸­åˆ›å»ºä¸€ä¸ª Symbol æ—¶ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªåœ¨ä»¥åŽç”¨äºŽè°ƒè¯•çš„æè¿°ã€‚å¾—åˆ°è¿™ä¸ªæè¿°çš„è¿‡ç¨‹æœ‰ç‚¹æ— èŠï¼Œå¿…é¡»å†æ¬¡é‡æ–°æž„é€  Symbolï¼Œå¹¶åœ¨ toString() æ–¹æ³•çš„å¸®åŠ©ä¸‹æ‰èƒ½è®¿é—®æè¿°ã€‚ ES10æ·»åŠ äº†ä¸€ä¸ªæ–°çš„åä¸º description çš„åªè¯»å±žæ€§ï¼Œå®ƒè¿”å›ž Symbol çš„æè¿°ã€‚ ç¤ºä¾‹ 123const symbol = Symbol("this is a symbol");console.log(symbol.toString()); // Symbol(My Symbol);console.log(symbol.destription); // My Symbol å¯ä»¥çœ‹åˆ°ä½¿ç”¨ Symbol çš„.description å±žæ€§èƒ½å¤Ÿç›´æŽ¥èŽ·å–æè¿°ã€‚]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ€Žä¹ˆæé«˜ä»£ç è´¨é‡ï¼Ÿ-æ¥è‡ªGoogleçš„ç ”å‘ç»éªŒæ€»ç»“]]></title>
    <url>%2F2019%2F03%2F14%2F%E6%9D%82%E6%96%87%2F%E6%80%8E%E4%B9%88%E6%8F%90%E9%AB%98%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%EF%BC%9F-%E6%9D%A5%E8%87%AAGoogle%E7%9A%84%E7%A0%94%E5%8F%91%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ ä½ çš„å›¢é˜Ÿæœ‰æ²¡æœ‰è¿‡è¿™æ ·çš„ç»åŽ†ï¼šå¼€å‘æ•ˆçŽ‡ä½Žï¼Œæ‹›äº†å¾ˆå¤šäººï¼Œå¤©å¤©åŠ ç­ï¼Œå‡ºæ´»å´ä¸å¤šï¼Œçº¿ä¸Šbugé¢‘å‘ï¼Œé¢†å¯¼å‘é£™ï¼Œä¸­å±‚æŸæ‰‹æ— ç­–ï¼Œå·¥ç¨‹å¸ˆæŠ±æ€¨ä¸æ–­ï¼ŒæŸ¥æ‰¾bugå›°éš¾ã€‚å…¶å®žè¿™äº›éƒ½æ˜¯ä»£ç è´¨é‡å·®æƒ¹çš„ç¥¸ã€‚ä»£ç è´¨é‡æ˜¯ç ”å‘è´¨é‡ç®¡ç†çš„æ ¹æœ¬ï¼Œå®ƒå†³å®šäº†æ•´ä¸ªå¼€å‘å›¢é˜Ÿçš„å¼€å‘æ•ˆçŽ‡ï¼Œé¡¹ç›®è´¨é‡ï¼Œå…¶ä»–ç›‘æŽ§ï¼Œå‘Šè­¦ï¼Œæ—¥å¿—ç­‰æ‰‹æ®µéƒ½åªèƒ½æ˜¯äº‹åŽè¡¥å¿ã€‚æœ¬æ–‡å°±å¦‚ä½•ä¿è¯ä»£ç è´¨é‡æ€»ç»“äº†ä¸€äº›ç»éªŒå’Œæ–¹æ³•ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚ ä»£ç è´¨é‡æœ¬èº«å¹¶æ²¡æœ‰ä¸€ä¸ªç‰¹åˆ«æ˜Žç¡®çš„é‡åŒ–æŒ‡æ ‡ï¼Œè€Œä¸”æ ¹æ®å…¬å¸å‘å±•çš„ä¸åŒé˜¶æ®µï¼Œå›¢é˜Ÿè§„æ¨¡çš„å¤§å°ä¸åŒï¼Œé¡¹ç›®æ€§è´¨çš„ä¸åŒç­‰ï¼Œå¯¹ä»£ç è´¨é‡çš„è¦æ±‚ä¹Ÿä¸å°½ç›¸åŒï¼Žä¸è¿‡å¦‚æžœé¡¹ç›®ä¸­å‡ºçŽ°ä»¥ä¸‹æƒ…å†µæ—¶å€™ï¼Œå°±è¯´æ˜Žä»£ç è´¨é‡è¦å€¼å¾—é‡è§†äº†ï¼Ž æ·»åŠ æˆ–ä¿®æ”¹ä¸€ä¸ªç®€å•åŠŸèƒ½æ—¶ï¼Œæ¶‰åŠè¦ä¿®æ”¹çš„åœ°æ–¹ç‰¹åˆ«å¤šï¼Œè€Œä¸”å¾ˆåˆ†æ•£ï¼› ä»£ç ä¸å¯å¤ç”¨ï¼šç›¸ä¼¼çš„åŠŸèƒ½æ— æ³•å¤ç”¨ä»£ç ï¼Œè¦é‡æ–°å¼€å‘ï¼› çº¿ä¸Šbugé¢‘å‘ï¼ŒæŽ’é”™å›°éš¾ï¼Œä¿®å¤éš¾åº¦å¤§ï¼Œæ—¶é—´é•¿ï¼› æœ‰å¾ˆå¤šå¥‡æ€ªçš„ä»£ç ï¼Œä»£ç è¯»ä¸æ‡‚ï¼Œæ–°äººæ— æ³•å¾ˆå¿«äº†è§£ä»£ç ï¼› ä»£ç ä¸­å‘ç‰¹åˆ«å¤šï¼Œä¸æ•¢å¤§åŠ¨ï¼Œä¸€ä¸å°å¿ƒå°±è¸©å‘ï¼› ä»¥ä¸Šè¿™äº›é—®é¢˜ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ä»£ç è´¨é‡ä¸é«˜å¯¼è‡´çš„ï¼ŒåŒ…æ‹¬ ä»£ç æ— æ³¨é‡Šï¼Œæ— æ–‡æ¡£ï¼Œå‘½åå·®ï¼Œé¡¹ç›®å±‚æ¬¡ç»“æž„å·®ï¼Œè°ƒç”¨å…³ç³»æ··ä¹±ï¼Œåˆ°å¤„hardcodeï¼Œä¸´æ—¶è§£å†³æ–¹æ¡ˆç­‰ç­‰ã€‚æ€Žä¹ˆæ‰èƒ½æ—¶åˆ»ä¿è¯ä»£ç çš„é«˜è´¨é‡ï¼Œé¿å…ä»¥ä¸Šé—®é¢˜å‘ç”Ÿï¼Ÿå½“ç„¶å›¢é˜Ÿçš„æŠ€æœ¯ç´ è´¨å¾ˆé‡è¦ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›æ–¹æ³•å¯å¾ªçš„ å¹æ¯›æ±‚ç–µèˆ¬åœ°æ‰§è¡Œç¼–ç è§„èŒƒä¸¥æ ¼æ‰§è¡Œä»£ç ç¼–å†™è§„èŒƒï¼Œå¯ä»¥ä½¿ä¸€ä¸ªé¡¹ç›®ä¹ƒè‡³ä¸€ä¸ªå…¬å¸çš„ä»£ç å…·æœ‰å®Œå…¨ç»Ÿä¸€çš„é£Žæ ¼ï¼Œå°±åƒåŒä¸€ä¸ªäººç¼–å†™çš„ä¸€æ ·ï¼Œè€Œä¸”å‘½åè‰¯å¥½çš„å˜é‡ï¼Œå‡½æ•°ï¼Œç±»å’Œæ³¨é‡Šï¼Œä¹Ÿæ— ç–‘å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ï¼Žå…·ä½“è½å®žåˆ°æ‰§è¡Œå±‚é¢ï¼Œå¯ä»¥å‚ç…§Googleçš„ç¼–ç è§„èŒƒæˆ–è€…javaå®˜æ–¹çš„ç¼–ç è§„èŒƒï¼Œç½‘ä¸Šå¯ä»¥æ‰¾åˆ°ï¼Œå…³é”®æ˜¯è¦ä¸¥æ ¼éµå®ˆï¼Œå¹¶ä¸”åœ¨code reviewæ—¶ï¼Œä¸¥æ ¼è¦æ±‚ï¼Œæ²¡æœ‰æŒ‰ç…§è§„èŒƒçš„ä¸€å®šè¦æŒ‡å‡ºå¹¶ä¸”è¦æ±‚ä¿®æ”¹ï¼Ž å®žé™…æƒ…å†µå¾€å¾€æ˜¯è™½ç„¶å¤§å®¶éƒ½çŸ¥é“ä¼˜ç§€çš„ä»£ç è§„èŒƒæ˜¯æ€Žæ ·çš„ï¼Œä½†åœ¨å…·ä½“å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå´æ‰§è¡Œçš„å·®å¼ºäººæ„ï¼Œå¾ˆå¤šæƒ…å†µæ˜¯è®¤è¯†ä¸Šä¸å¤Ÿé‡è§†ï¼Œè§‰å¾—ä¸€ä¸ªå˜é‡æˆ–è€…å‡½æ•°çš„å‘½åæˆå“ªæ ·å…³ç³»ä¸å¤§ï¼Œæ‰€ä»¥ä¸å¤ŸæŽ¨æ•²ï¼Œæ³¨é‡Šå¾ˆå¤šä¹Ÿéƒ½ä¸å†™ï¼Œcode reviewçš„æ—¶å€™å¤§å®¶ä¹Ÿéƒ½äº‹ä¸å…³å·±å¿ƒæ€ï¼Œæˆ–è€…è§‰å¾—æ²¡å¿…è¦å¤ªæŠ ç»†èŠ‚ï¼Œå¯¼è‡´æ…¢æ…¢çš„æ•´ä¸ªcode baseå˜å¾—è¶Šæ¥è¶Šå·®ï¼Žæ‰€ä»¥è¿™é‡Œè¿˜æ˜¯è¦å¼ºè°ƒä¸€ä¸‹ï¼Œç»†èŠ‚å†³å®šæˆè´¥ï¼Œæé«˜å›¢é˜Ÿå¯¹ä»£ç è§„èŒƒçš„è®¤åŒåŠå…¶ä¸¥æ ¼çš„æ‰§è¡Œæ˜¯å…³é”®ï¼Ž ç¼–å†™é«˜è´¨é‡çš„å•å…ƒæµ‹è¯•å•å…ƒæµ‹è¯•æ˜¯æœ€å®¹æ˜“æ‰§è¡Œï¼Œä¸”å¯¹æé«˜ä»£ç è´¨é‡è§æ•ˆæœ€å¿«çš„æ–¹æ³•ä¹‹ä¸€è¿˜ã€‚ä½†è¿˜æ˜¯æœ‰å¾ˆå¤šå…¬å¸å¯¹å•å…ƒæµ‹è¯•é‡è§†ä¸å¤Ÿï¼ŒåŒ…æ‹¬ä¸€äº›å¤§çš„äº’è”ç½‘å…¬å¸ï¼Œä¸å†™æˆ–è€…éšä¾¿å†™å†™ æœ‰äº›å·¥ç¨‹å¸ˆè§‰å¾—æœ‰æµ‹è¯•å›¢é˜Ÿå°±å¤Ÿäº†ï¼Œå†å†™å•å…ƒæµ‹è¯•å°±æ˜¯æµªè´¹æ—¶é—´ã€‚å…¶å®žæµ‹è¯•å›¢é˜Ÿçš„æµ‹è¯•å’Œå•å…ƒæµ‹è¯•æ˜¯åœ¨ä¸åŒå±‚é¢ä¸Šçš„ï¼Œæµ‹è¯•å›¢é˜Ÿçš„æµ‹è¯•ä¸€èˆ¬æ˜¯é»‘ç›’æµ‹è¯•ï¼Œç³»ç»Ÿå±‚é¢çš„é›†æˆæµ‹è¯•ï¼Œå¯¹äºŽå¤æ‚ç³»ç»Ÿæ¥è¯´ï¼Œç»„åˆçˆ†ç‚¸ï¼Œæµ‹è¯•å›¢é˜Ÿæ— æ³•ç©·ä¸¾æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ã€‚å•å…ƒæµ‹è¯•æ˜¯ä»£ç å±‚é¢çš„æµ‹è¯•ï¼Œä¸€èˆ¬æ˜¯é’ˆå¯¹ç±»çš„æµ‹è¯•ã€‚æ—¢ç„¶æ— æ³•ä»Žç³»ç»Ÿçš„æ•´ä½“ä¸Šä¿è¯100%ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œé‚£å•å…ƒæµ‹è¯•èµ·ç èƒ½ä¿è¯æˆ‘ä»¬ä»£ç åœ¨ç»†ç²’åº¦ä¸Šè¿è¡Œç¬¦åˆé¢„æœŸã€‚ æœ‰äº›å·¥ç¨‹å¸ˆè®¤ä¸ºå¼€å‘ä»»åŠ¡é‡æ²¡æ—¶é—´å†™ã€‚è¿™ä¸ªè¿˜æ˜¯æ²¡æœ‰è¶³å¤Ÿé‡è§†å•å…ƒæµ‹è¯•ï¼Œè§‰å¾—æ˜¯å¯æœ‰å¯æ— çš„éƒ¨åˆ†ï¼Œæ‰ä¼šæœ‰è¿™æ ·çš„æƒ³æ³•ã€‚å†™å¥½å•å…ƒæµ‹è¯•ï¼ŒèŠ‚çœå¾ˆå¤šè§£å†³çº¿ä¸Šbugçš„æ—¶é—´ï¼Œå¼€å‘æ—¶é—´åè€Œæ›´å……è¶³äº†ã€‚ è¿˜æœ‰å¾ˆå¤šå·¥ç¨‹å¸ˆè™½ç„¶åœ¨å†™å•å…ƒæµ‹è¯•ï¼Œä½†åªå¯¹æ­£å¸¸æµç¨‹åšæµ‹è¯•ã€‚ä»£ç ä¸­çš„bugå¤šæ•°æ˜¯å†™ä»£ç æ—¶å¼‚å¸¸æƒ…å†µæ²¡æœ‰è€ƒè™‘å…¨é¢å¯¼è‡´çš„ï¼Œæ­£å¸¸æµç¨‹ä¸€èˆ¬ä¸ä¼šå‡ºé—®é¢˜ã€‚å•å…ƒæµ‹è¯•çš„ä½œç”¨å°±åœ¨äºŽæµ‹è¯•å„ç§å¼‚å¸¸æƒ…å†µä¸‹ä»£ç çš„è¿è¡Œæ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œæ‰€ä»¥åªå¯¹æ­£å¸¸æµç¨‹æµ‹è¯•æ— æ³•å‘æŒ¥å•å…ƒæµ‹è¯•çœŸæ­£çš„ä½œç”¨ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå•å…ƒæµ‹è¯•ä»£ç é‡è¦æ¯”è¦æµ‹è¯•çš„ä»£ç å¤šï¼Œä¸€èˆ¬æ˜¯1-2å€çš„æ ·å­ï¼Œå†™å•å…ƒæµ‹è¯•æœ¬èº«æ²¡æœ‰å¤ªå¤šçš„æŠ€æœ¯æŒ‘æˆ˜ï¼Œä¸»è¦çœ‹å·¥ç¨‹å¸ˆé€»è¾‘æ˜¯å¦ç¼œå¯†ï¼Œèƒ½å¤Ÿè€ƒè™‘å„ç§å¼‚å¸¸æƒ…å†µï¼Œå†™èµ·æ¥æ¯”è¾ƒæž¯ç‡¥ï¼Œæ‰€ä»¥å†™é«˜è´¨é‡çš„å•å…ƒæµ‹è¯•çš„ä¸€æ–¹é¢è¦é å·¥ç¨‹å¸ˆçš„è€å¿ƒæ‰§è¡Œï¼Œå¦ä¸€æ–¹é¢è¦é å›¢é˜Ÿçš„ä¸¥æ ¼è¦æ±‚ã€‚å½“ç„¶è¿™äº›éƒ½æ˜¯å»ºç«‹åœ¨å¯¹å•å…ƒæµ‹è¯•é‡è¦æ€§çš„è®¤åŒä¹‹ä¸Šã€‚ ä¸æµäºŽå½¢å¼çš„Code Reviewå¦‚æžœè¯´å•å…ƒæµ‹è¯•å¾ˆå¤šå·¥ç¨‹å¸ˆä¸æ€Žä¹ˆé‡è§†ï¼Œé‚£code reviewå°±æ˜¯ä¸æ€Žä¹ˆæŽ¥å—ï¼Žè·Ÿå¾ˆå¤šå¤§åž‹äº’è”ç½‘å…¬å¸çš„äººèŠè¿‡ï¼Œå¯¹code reviewéƒ½ä¸æ€Žä¹ˆè®¤å¯ï¼Œå¤§éƒ¨åˆ†ååº”éƒ½æ˜¯ï¼Œè¿™çŽ©æ„ä¸å¯èƒ½å¾ˆå¥½çš„æ‰§è¡Œï¼Œæµªè´¹æ—¶é—´ï¼Œæ˜¯çš„ï¼Œcode reviewåšçš„å†æµç•…ï¼Œä¹Ÿæ˜¯è¦èŠ±æ—¶é—´çš„ï¼Œå…³é”®åœ¨äºŽæˆ‘ä»¬æ˜¯æ„¿æ„èŠ±2å¤©å†™ä»£ç èŠ±5å¤©ä¿®bug,è¿˜æ˜¯æ„¿æ„èŠ±ï¼“å¤©å†™ä»£ç èŠ±åŠå¤©ä¿®bug. å…¶å®žï¼Œcode reviewçš„å¥½å¤„ä¸ä»…ä»…æ˜¯èƒ½å¤Ÿå¤§å¤§æé«˜ä»£ç è´¨é‡ï¼Œå‡å°‘ä»£ç bugï¼Œä½ æƒ³æƒ³å¦‚æžœæˆ‘ä»¬æ²¡æœ‰code reviewï¼Œå¹³æ—¶å†™çš„ä»£ç â€œå·å·â€å°±commitäº†ï¼Œéš¾å…æœ‰äººä¸è‡ªå¾‹ï¼Œæœ‰äº†code reviewï¼Œç›´æ’­ä»£ç ï¼Œæ›å…‰dirty codeï¼Œå¤§å®¶å°±ä¼šæ›´è®¤çœŸäº›ï¼Žå…¶æ¬¡æ¥è®²ï¼Œcode reviewä¹Ÿæ˜¯ä¸€ç§æœ‰æ•ˆæŠ€æœ¯ä¼ å¸®å¸¦çš„é€”å¾„ï¼Œæ¯æ¬¡code reviewéƒ½æ˜¯ä¸€æ¬¡æ¡ˆä¾‹çš„å‰–æžï¼Œå¯ä»¥å¸®åŠ©åˆçº§çš„å·¥ç¨‹å¸ˆåŸ¹å…»ç¼–ç è§„èŒƒï¼Œæé«˜ç¼–ç è´¨é‡ï¼Œè®¾è®¡èƒ½åŠ›ç”šè‡³äºŽæž¶æž„èƒ½åŠ›ï¼Œåè¿‡æ¥ï¼Œreviewåˆ«äººå†™çš„å¥½çš„ä»£ç ï¼Œå¯¹è‡ªå·±ä¹Ÿæ˜¯ä¸€ç§å­¦ä¹ å’Œæé«˜ é™¤æ­¤ä¹‹å¤–ï¼Œä¸¥æ ¼çš„code reviewä¸ä»…èƒ½ä¿è¯ä»£ç çš„è´¨é‡ï¼Œè¿˜èƒ½å½¢æˆè‰¯å¥½çš„æŠ€æœ¯æ°›å›´ã€‚ å¼€å‘æœªåŠ¨æ–‡æ¡£å…ˆè¡Œç¼–å†™æŠ€æœ¯æ–‡æ¡£å¯¹å¤§éƒ¨åˆ†å·¥ç¨‹å¸ˆæ¥è¯´éƒ½æ˜¯æŒºåæ„Ÿçš„äº‹æƒ…ã€‚ä¸€èˆ¬æ¥è®²åœ¨å¼€å‘æŸä¸ªç³»ç»Ÿæˆ–è€…é‡è¦æ¨¡å—æˆ–è€…åŠŸèƒ½ä¹‹å‰éœ€è¦å…ˆå†™æŠ€æœ¯æ–‡æ¡£ï¼Œç„¶åŽå‘é€ç»™åŒç»„æˆ–è€…ç›¸å…³åŒäº‹å®¡æŸ¥ï¼Œåœ¨å®¡æŸ¥æ²¡æœ‰é—®é¢˜çš„æƒ…å†µä¸‹å†å¼€å‘ï¼Œè¿™æ ·èƒ½å¤Ÿäº‹å…ˆè¾¾æˆå…±è¯†ï¼Œå¼€å‘å‡ºæ¥çš„ä¸œè¥¿ä¸è‡³äºŽèµ°æ ·ï¼Œè€Œä¸”å½“å¼€å‘å®Œæˆä¹‹åŽè¿›è¡Œcode reviewçš„é˜¶æ®µï¼Œä»£ç å®¡æŸ¥è€…é€šè¿‡é˜…è¯»å¼€å‘æ–‡æ¡£ä¹Ÿå¯ä»¥å¿«é€Ÿçš„ç†è§£ä»£ç ï¼Ž é™¤æ­¤ä¹‹å¤–ï¼Œæ–‡æ¡£å¯¹äºŽå›¢é˜Ÿå’Œå…¬å¸æ¥è®²éƒ½æ˜¯é‡è¦çš„è´¢å¯Œï¼Œå¯¹äºŽæ–°äººåŠ å…¥å…¬å¸ç†Ÿæ‚‰ä»£ç ï¼Œäº§å“ï¼Œå¯¹äºŽä»»åŠ¡çš„äº¤æŽ¥ç­‰ç­‰éƒ½å¾ˆæœ‰å¸®åŠ©ï¼Œè€Œä¸”ä½œä¸ºä¸€ä¸ªè§„èŒƒåŒ–çš„æŠ€æœ¯å›¢é˜Ÿï¼ŒæŠ€æœ¯æ–‡æ¡£æ˜¯ä¸€ç§æ‘’å¼ƒä½œåŠå¼å¼€å‘å’Œä¸ªäººè‹±é›„ä¸»ä¹‰çš„æœ‰æ•ˆæ–¹æ³•ï¼Œæ˜¯ä¿è¯å›¢é˜Ÿæœ‰æ•ˆåä½œçš„é€”å¾„ï¼Ž ä¸è¿‡ï¼Œæœ‰å¾ˆå¤šå·¥ç¨‹å¸ˆæå‡ºè¯´ä¸ä¼šå†™æŠ€æœ¯æ–‡æ¡£ï¼Œä¸çŸ¥é“å†™ä»€ä¹ˆï¼Œå¸Œæœ›ç»™ä¸€ä¸ªæ¨¡æ¿æˆ–è€…ç›®å½•ï¼Žæˆ‘ä¹‹å‰æ›¾ç»æƒ³è¿‡æ˜¯å¦å¯ä»¥ç»™å‡ºä¸€ä¸ªå›ºå®šçš„æ¨¡æ¿ï¼Œä½†æœ€åŽè¿˜æ˜¯æ”¾å¼ƒäº†ï¼Œæ¯”è¾ƒéš¾ï¼Œéš¾ç‚¹åœ¨äºŽï¼Œæ¯ä¸ªé¡¹ç›®ä¾§é‡ç‚¹éƒ½ä¸ä¸€æ ·ä¸å®¹æ˜“æ€»ç»“ï¼Œå¦‚æžœç¡¬è¦ç»™å‡ºä¸€ä¸ªå¾ˆå®½æ³›çš„ç›®å½•ï¼Œä¸å…·æœ‰æŒ‡å¯¼æ€§ä¹Ÿæ²¡æœ‰æ„ä¹‰ï¼Žå¤§ä½“ä¸Šæ¥è®²ï¼Œæ–‡æ¡£çš„å†…å®¹ä¸»è¦æ˜¯å°†åšçš„ä¸œè¥¿è®²æ¸…æ¥šï¼ŒåŒ…æ‹¬å‡ºé—®é¢˜èƒŒæ™¯ï¼Œè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œå¤–éƒ¨æ€Žä¹ˆç”¨æˆ–è°ƒç”¨ï¼Œå†…éƒ¨å¦‚ä½•å®žçŽ°ï¼Œå¤§çš„æž¶æž„ï¼Œå…³é”®åŠŸèƒ½å’Œç®—æ³•ç­‰ï¼Œä»¥åŠä¸€äº›éžåŠŸèƒ½æ€§çš„è€ƒè™‘ã€‚ æŒç»­é‡æž„ï¼Œé‡æž„ï¼Œé‡æž„ä¸ªäººæ¯”è¾ƒåå¯¹å¹³æ—¶ä¸æ³¨é‡ä»£ç è´¨é‡ï¼Œå †ç Œçƒ‚ä»£ç ï¼Œå®žåœ¨ç»´æŠ¤ä¸äº†äº†å°±å¤§åˆ€é˜”æ–§çš„é‡æž„ç”šè‡³é‡å†™ã€‚æœ‰æ—¶å€™é¡¹ç›®ä»£ç å¤ªå¤šäº†ï¼Œé‡æž„å¾ˆéš¾åšåˆ°å½»åº•ï¼Œæœ€åŽåˆæžå‡ºæ¥ä¸€ä¸ªå››ä¸åƒçš„æ€ªç‰©ï¼Œæ›´éº»çƒ¦äº†ï¼ ä¼˜ç§€çš„ä»£ç æˆ–æž¶æž„ä¸æ˜¯ä¸€å¼€å§‹å°±èƒ½å®Œå…¨è®¾è®¡å¥½çš„ï¼Œå°±åƒä¼˜ç§€çš„å…¬å¸æˆ–äº§å“ä¹Ÿéƒ½æ˜¯è¿­ä»£å‡ºæ¥çš„ä¸€æ ·çš„ï¼Œæˆ‘ä»¬æ— æ³•100%é‡è§æœªæ¥çš„éœ€æ±‚ï¼Œä¹Ÿæ²¡æœ‰è¶³å¤Ÿçš„ç²¾åŠ›ï¼Œæ—¶é—´ï¼Œèµ„æºä¸ºé¥è¿œçš„æœªæ¥ä¹°å•ï¼Œæ‰€ä»¥éšç€ç³»ç»Ÿçš„æ¼”è¿›ï¼Œé‡æž„ä»£ç ä¹Ÿæ˜¯ä¸å¯é¿å…çš„ï¼Œè™½ç„¶ä¸Šé¢è¯´äº†ä¸æ”¯æŒå¤§åˆ€é˜”æ–§æŽ¨åˆ°é‡æ¥å¼çš„å¤§é‡æž„ï¼Œä½†æŒç»­çš„å°é‡æž„è¿˜æ˜¯æ¯”è¾ƒæŽ¨å´‡çš„ï¼Œä¹Ÿæ˜¯æ—¶åˆ»ä¿è¯ä»£ç è´¨é‡é˜²æ­¢ä»£ç è…åŒ–æœ‰æ•ˆæ‰‹æ®µï¼Žç®€å•ä¸€å¥è¯å°±æ˜¯ä¸è¦ç­‰åˆ°é—®é¢˜å †å¾—å¤ªå¤šäº†å†é‡‡å–é‡æž„ï¼Œè¦æ—¶åˆ»æœ‰äººå¯¹ä»£ç æ•´ä½“è´Ÿè´£ä»»ï¼Œå¹³æ—¶æ²¡äº‹å°±æ”¹æ”¹ä»£ç ï¼Œè€Œä¸è¦è§‰å¾—é‡æž„ä»£ç å°±æ˜¯æµªè´¹æ—¶é—´ï¼Œä¸åŠ¡æ­£ä¸šï¼ ç‰¹åˆ«æ˜¯ä¸€äº›ä¸šåŠ¡å¼€å‘å›¢é˜Ÿï¼Œæœ‰æ—¶å€™ä¸ºäº†å¿«é€Ÿå®Œæˆä¸€ä¸ªäº§å“æˆ–è€…ä¸šåŠ¡åŠŸèƒ½ï¼Œåªè¿½æ±‚é€Ÿåº¦ï¼Œåˆ°å¤„hard codeï¼Œåœ¨å®Œå…¨ä¸è€ƒè™‘éžåŠŸèƒ½æ€§éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œå †ç Œä¸€äº›çƒ‚ä»£ç ï¼Œè¿™ç§æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒå¸¸è§çš„ã€‚ä¸è¿‡æ²¡å…³ç³»ï¼Œç­‰æœ‰æ—¶é—´ä¸€å®šè¦è®°ç€é‡æž„ï¼Œä¸ç„¶çƒ‚ä»£ç è¶Šå †è¶Šå¤šï¼Œæ€»æœ‰ä¸€å¤©ä¼šæ²¡äººèƒ½ç»´æŠ¤ã€‚ é¡¹ç›®ä¸Žå›¢é˜Ÿâ€å¾®æœåŠ¡åŒ–â€åªæœ‰å°é¡¹ç›®æ˜¯å¯ä»¥ç»´æŠ¤çš„ï¼Œå¤§é¡¹ç›®æ˜¯æ— æ³•ç»´æŠ¤çš„ï¼Žå›¢é˜Ÿäººæ¯”è¾ƒå°‘çš„æ—¶å€™ï¼Œåå‡ ä¸ªäººçš„æ ·å­ï¼Œä»£ç é‡ä¹Ÿä¸å¤šï¼Œä¸è¶…è¿‡10ä¸‡è¡Œï¼Œæ€Žä¹ˆå¼€å‘ï¼Œæ€Žä¹ˆç®¡ç†éƒ½æ²¡é—®é¢˜ï¼Œå¤§å®¶äº’ç›¸éƒ½äº†è§£å½¼æ­¤åšçš„ä¸œè¥¿ï¼Œä»£ç è´¨é‡å¤ªå·®äº†ï¼Œå¤§ä¸äº†é‡å†™ä¸€éï¼Žä½†å¦‚æžœæ˜¯ä¸€ä¸ªæžå…¶åºžå¤§çš„é¡¹ç›®ï¼Œå‡ åä¸‡è¡Œä»£ç ï¼Œå‡ åä¸ªå¼€å‘ç»´æŠ¤ï¼Œé‚£åŸºæœ¬ä¸Šæ²¡äººèƒ½å¯¹ä»£ç è´Ÿè´£äº†ï¼Ž æ‰€ä»¥å½“é¡¹ç›®å¤ªå¤§äº†ä¹‹åŽï¼Œå°±éœ€è¦å¯¹ä»£ç å’Œå›¢é˜Ÿè¿›è¡Œæ‹†åˆ†ï¼Œæ¨¡å—åŒ–ï¼Œå¤§å›¢é˜Ÿæ‹†æˆå‡ ä¸ªå°å›¢é˜Ÿï¼Œå¤§é¡¹ç›®æ‹†æˆå‡ ä¸ªå°é¡¹ç›®ï¼Œè¿™æ ·æ¯ä¸ªå›¢é˜Ÿæ¯ä¸ªé¡¹ç›®çš„ä»£ç éƒ½ä¸è‡³äºŽå¾ˆå¤šï¼Œä¹Ÿä¸è‡³äºŽå‡ºçŽ°ä»£ç è´¨é‡å¤ªå·®æ— æ³•ç»´æŠ¤çš„æƒ…å†µï¼Œå…¶å®žå¾ˆå¤šæŠ€æœ¯ä¹Ÿéƒ½ä½“çŽ°äº†è¿™ç§æ€æƒ³ï¼Œæ¯”å¦‚å¤§åˆ°soa, å¾®æœåŠ¡ï¼Œå°åˆ°jar, .soç­‰libæ¨¡å—å¼€å‘ï¼ŒClassç±»çš„å°è£…ï¼Œéƒ½æ˜¯ä¸€ç§æ‹†åˆ†çš„æ€æƒ³ï¼Ž é‡è§†ä»£ç å…³æ³¨ç»†èŠ‚ä»¥ä¸Šå…¶ä»–çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯æ²»æ ‡ä¸æ²»æœ¬ï¼Œæ‰¾åˆ°å¯¹çš„äººç”¨å¥½å¯¹çš„äººï¼Œæ‰“é€ ä¼˜ç§€çš„æŠ€æœ¯æ–‡åŒ–ï¼Œæ‰æ˜¯èƒ½ä¸€ç›´å“è¶Šçš„æ ¹æœ¬ã€‚æœ‰å¾ˆå¤šå·¥ç¨‹å¸ˆæ¯”è¾ƒçƒ­è¡·äºŽå­¦ä¹ æž¶æž„ï¼Œå·¥å…·ï¼Œæ¡†æž¶å±‚é¢çš„ä¸œè¥¿ï¼Œè§è¿‡å¾ˆå¤šå·¥ç¨‹å¸ˆï¼Œè¿˜æ²¡å†™ä¸‰äº”å¹´ä»£ç å°±è½¬åšæž¶æž„å¸ˆï¼Œä¸å†™ä»£ç äº†ï¼Œåˆ°å¤„å¿½æ‚ ï¼Œå¾ˆä¸å¥½ï¼Œäº’è”ç½‘ä¿¡æ¯å¦‚æ­¤é€æ˜Žï¼Œä¸åŒçš„äººåŽ»åšåŒä¸€ä¸ªé¡¹ç›®ï¼Œå…¶å®žæœ€åŽè®¾è®¡å‡ºæ¥çš„æž¶æž„,åŠŸèƒ½å¤§çº¦éƒ½å·®ä¸å¤šï¼Œæœ€åŽå¤§å®¶éƒ½èƒ½æŠŠè¿™ä¸ªç³»ç»Ÿå®žçŽ°ï¼Œä½†æœ‰äº›äººåšå‡ºæ¥çš„ç³»ç»Ÿï¼Œbugå¾ˆå¤šï¼Œæ€§èƒ½å¾ˆå·®ï¼Œæ‰©å±•æ€§ä¹Ÿä¸å¥½ï¼Œæœ€å¤šèƒ½å«ä¸ªPOCã€‚ é«˜æ‰‹ä¹‹é—´çš„ç«žäº‰è¿˜æ˜¯åœ¨äºŽç»†èŠ‚ï¼Œä¸€ä¸ªç®—æ³•å¤Ÿä¸å¤Ÿä¼˜åŒ–ï¼Œæ•°æ®å­˜å–çš„æ•ˆçŽ‡é«˜ä¸é«˜ï¼Œå†…å­˜æ˜¯å¦å¤ŸèŠ‚çœç­‰ç­‰ï¼Œè¿™æ˜¯ç´¯ç§¯èµ·æ¥å†³å®šäº†ä¸€ä¸ªç³»ç»Ÿæ˜¯ä¸æ˜¯å¤Ÿä¼˜ç§€ã€‚ å›½å†…å·¥ç¨‹å¸ˆæ™®éæ·±åº¦ä¸å¤Ÿï¼Œåšå‡ å¹´æŠ€æœ¯å°±è½¬ç®¡ç†æˆ–è€…çº¯æž¶æž„è®¾è®¡ä¸å†™ä»£ç äº†ï¼Œè€Œå›½å¤–ä¸ä¸€æ ·ï¼Œå¤§é¾„ç å†œå¾ˆå¤šï¼Œæ‰€ä»¥å›½å¤–çš„ä¼˜ç§€å¼€æºé¡¹ç›®æ¯”è¾ƒå¤šï¼Œè€Œå›½å†…å¾ˆå°‘ å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ä»£ç ä¸­çš„å¾ˆå¤šä½Žçº§è´¨é‡é—®é¢˜ä¸éœ€è¦äººå·¥åŽ»å®¡æŸ¥ï¼Œjavaå¼€å‘æœ‰å¾ˆå¤šçŽ°æˆçš„å·¥å…·å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼šcheckstyleï¼Œfindbugs, pmd, jacaco, sonarç­‰ã€‚ Checkstyle,findbugs,pmdæ˜¯é™æ€ä»£ç åˆ†æžå·¥å…·ï¼Œé€šè¿‡åˆ†æžæºä»£ç æˆ–è€…å­—èŠ‚ç ï¼Œæ‰¾å‡ºä»£ç çš„ç¼ºé™·ï¼Œæ¯”å¦‚å‚æ•°ä¸åŒ¹é…ï¼Œæœ‰æ­§ä¹‰çš„åµŒå¥—è¯­å¥ï¼Œé”™è¯¯çš„é€’å½’ï¼Œéžæ³•è®¡ç®—ï¼Œå¯èƒ½å‡ºçŽ°çš„ç©ºæŒ‡é’ˆå¼•ç”¨ç­‰ç­‰ã€‚ä¸‰è€…éƒ½å¯ä»¥é›†æˆåˆ°gradleç­‰æž„å»ºå·¥å…·ä¸­ã€‚ Jacocoæ˜¯ä¸€ç§å•å…ƒæµ‹è¯•è¦†ç›–çŽ‡ç»Ÿè®¡å·¥å…·ï¼Œä¹Ÿå¯ä»¥é›†æˆåˆ°gradleç­‰æž„å»ºå·¥å…·ä¸­ï¼Œå¯ä»¥ç”Ÿæˆæ¼‚äº®çš„æµ‹è¯•è¦†ç›–çŽ‡ç»Ÿè®¡æŠ¥è¡¨ï¼ŒåŒæ—¶Eclipseæä¾›äº†æ’ä»¶å¯ä»¥EclEmmaå¯ä»¥ç›´è§‚çš„åœ¨IDEä¸­æŸ¥çœ‹å•å…ƒæµ‹è¯•çš„è¦†ç›–æƒ…å†µã€‚ Sonar Sonar æ˜¯ä¸€ä¸ªç”¨äºŽä»£ç è´¨é‡ç®¡ç†çš„å¹³å°ã€‚å¯ä»¥åœ¨ä¸€ä¸ªç»Ÿä¸€çš„å¹³å°ä¸Šæ˜¾ç¤ºç®¡ç†é™æ€åˆ†æžï¼Œå•å…ƒæµ‹è¯•è¦†ç›–çŽ‡ç­‰è´¨é‡æŠ¥å‘Šã€‚ æœ€åŽï¼Œæ€»ç»“ä»¥ä¸Šæ‰€æœ‰çš„è¿™äº›æ–¹æ³•è®ºåº”è¯¥éƒ½æ²¡å•¥æ–°å¥‡çš„ï¼Œä¹Ÿæ²¡æœ‰è‘µèŠ±å®å…¸ä¼¼çš„æ€æ‰‹é”ï¼Œè¯´å‡ºæ¥æ„Ÿè§‰éƒ½å¾ˆç®€å•çš„ï¼ŒçŽ°åœ¨äº’è”ç½‘è¿™ä¹ˆå‘è¾¾ï¼Œä¿¡æ¯éƒ½å¾ˆé€æ˜Žï¼Œæ‰€ä»¥å¤§æ–¹å‘å¤§å®¶éƒ½çŸ¥é“ï¼Œå…·ä½“çš„ç­–ç•¥å’Œæž¶æž„å„å®¶ä¹Ÿéƒ½å·®ä¸å¤šï¼Œæœ€åŽè°åšçš„å¥½ï¼Œå…³é”®åœ¨äºŽæ‰§è¡Œå’Œç»†èŠ‚ï¼Œç»å¸¸å¬åˆ°æœ‰äººè¯´æˆ‘ä»¬åšäº†å•å…ƒæµ‹è¯•å•Šï¼Œæˆ‘ä»¬åšäº†æ€§èƒ½æµ‹è¯•ï¼Œå¯æœ€åŽè¿˜æ˜¯ä¸€å †æ€§èƒ½é—®é¢˜ä¸€å †bugï¼Œé‚£å°±è¦åŽ»è€ƒè™‘ä¸€ä¸‹åˆ°åº•åšçš„å¤Ÿä¸å¤Ÿå¥½ï¼Œæ˜¯å¦åšåˆ°äº†å…·ä½“é—®é¢˜å…·ä½“åˆ†æžï¼Œä¸ç”Ÿæ¬ç¡¬å¥—ï¼Œä»Žå†³ç­–åˆ°æ‰§è¡Œå†åˆ°è€ƒæ ¸æ˜¯å¦å½¢æˆäº†é—­çŽ¯ï¼Œå¾ˆå¤šæ—¶å€™åªæ˜¯ç©ºå–Šå£å·ï¼Œå£å·å–Šå¾—100åˆ†ï¼Œè½å®žåˆ°æ‰§è¡Œåªèƒ½å¾—ï¼•0åˆ†ï¼Œæœ€åŽåˆå®Œå…¨æ²¡è€ƒæ ¸ï¼Œå¥½åå¤§å®¶ä¹Ÿéƒ½ä¸çŸ¥ï¼Œåˆ‡è®°æ•äºŽè¨€è€Œè®·äºŽè¡Œ]]></content>
      <categories>
        <category>æ‚æ–‡</category>
      </categories>
      <tags>
        <tag>æ‚æ–‡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ES6 Classä¸­çš„constructoræ–¹æ³•å’Œsuperçš„ä½œç”¨]]></title>
    <url>%2F2019%2F03%2F12%2FJs%2FES6-Class%E4%B8%AD%E7%9A%84constructor%E6%96%B9%E6%B3%95%E5%92%8Csuper%E7%9A%84%E4%BD%9C%E7%94%A8%2F</url>
    <content type="text"><![CDATA[å‰è¨€é¦–å…ˆï¼ŒES6 çš„ class å±žäºŽä¸€ç§â€œè¯­æ³•ç³–â€ï¼Œæ‰€ä»¥åªæ˜¯å†™æ³•æ›´åŠ ä¼˜é›…ï¼Œæ›´åŠ åƒé¢å¯¹å¯¹è±¡çš„ç¼–ç¨‹ï¼Œå…¶æ€æƒ³å’Œ ES5 æ˜¯ä¸€è‡´çš„ã€‚ construcot12345678function Point(x, y) &#123; this.x = x; this.y = y;&#125;Point.prototype.toString = function() &#123; return '(' + this.x + ',' + this.y + ')';&#125; ç­‰åŒäºŽ 12345678910class Point &#123; constructor(x, y) &#123; this.x = x; this.y = y; &#125; toString() &#123; return '(' + this.x + ',' + this.y + ')'; &#125;&#125; å…¶ä¸­ constructor æ–¹æ³•æ˜¯ç±»çš„æž„é€ å‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªé»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡ new å‘½ä»¤åˆ›å»ºå¯¹è±¡å®žä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚ä¸€ä¸ªç±»å¿…é¡»æœ‰ constructor æ–¹æ³•ï¼Œå¦‚æžœæ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä¸€ä¸ªé»˜è®¤çš„ constructor æ–¹æ³•ä¼šè¢«é»˜è®¤æ·»åŠ ã€‚æ‰€ä»¥å³ä½¿ä½ æ²¡æœ‰æ·»åŠ æž„é€ å‡½æ•°ï¼Œä¹Ÿæ˜¯ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„æž„é€ å‡½æ•°çš„ã€‚ä¸€èˆ¬ constructor æ–¹æ³•è¿”å›žå®žä¾‹å¯¹è±¡ this ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æŒ‡å®š constructor æ–¹æ³•è¿”å›žä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼Œè®©è¿”å›žçš„å®žä¾‹å¯¹è±¡ä¸æ˜¯è¯¥ç±»çš„å®žä¾‹ã€‚ superä¸‹é¢å¥½å¥½åˆ†æžä¸€ä¸‹ super å…³é”®å­—çš„ä½œç”¨ï¼š super è¿™ä¸ªå…³é”®å­—ï¼Œæ—¢å¯ä»¥å½“åšå‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“åšå¯¹è±¡ä½¿ç”¨ã€‚è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå®ƒçš„ç”¨æ³•å®Œå…¨ä¸ç”¨ã€‚ 1.å½“å‡½æ•°ä½¿ç”¨ 123456class A &#123;&#125;class B extends A &#123; constructor() &#123; super(); // ES6 è¦æ±‚ï¼Œå­ç±»çš„æž„é€ å‡½æ•°å¿…é¡»æ‰§è¡Œä¸€æ¬¡ super å‡½æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ &#125;&#125; æ³¨ï¼šåœ¨ constructor ä¸­å¿…é¡»è°ƒç”¨ super æ–¹æ³•ï¼Œå› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„ this å¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„ this å¯¹è±¡ï¼Œç„¶åŽå¯¹å…¶è¿›è¡ŒåŠ å·¥,è€Œ super å°±ä»£è¡¨äº†çˆ¶ç±»çš„æž„é€ å‡½æ•°ã€‚super è™½ç„¶ä»£è¡¨äº†çˆ¶ç±» A çš„æž„é€ å‡½æ•°ï¼Œä½†æ˜¯è¿”å›žçš„æ˜¯å­ç±» B çš„å®žä¾‹ï¼Œå³ super å†…éƒ¨çš„ this æŒ‡çš„æ˜¯ Bï¼Œå› æ­¤ super() åœ¨è¿™é‡Œç›¸å½“äºŽ props)``ã€‚12345678910111213141516```jsclass A &#123; constructor() &#123; console.log(new.target.name); // new.target æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•° &#125;&#125;class B extends A &#123; constructor() &#123; super(); &#125;&#125;new A(); // Anew B(); // B å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ super() æ‰§è¡Œæ—¶ï¼Œå®ƒæŒ‡å‘çš„æ˜¯ å­ç±» B çš„æž„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯çˆ¶ç±» A çš„æž„é€ å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œsuper() å†…éƒ¨çš„ this æŒ‡å‘çš„æ˜¯ Bã€‚ 2.å½“å¯¹è±¡ä½¿ç”¨ åœ¨æ™®é€šæ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŽŸåž‹å¯¹è±¡ï¼›åœ¨é™æ€æ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»ã€‚ 1234567891011121314class A &#123; c() &#123; return 2; &#125;&#125;class B extends A &#123; constructor() &#123; super(); console.log(super.c()); // 2 &#125;&#125;let b = new B(); ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±» B å½“ä¸­çš„ super.c()ï¼Œå°±æ˜¯å°† super å½“ä½œä¸€ä¸ªå¯¹è±¡ä½¿ç”¨ã€‚è¿™æ—¶ï¼Œsuper åœ¨æ™®é€šæ–¹æ³•ä¹‹ä¸­ï¼ŒæŒ‡å‘ A.prototypeï¼Œæ‰€ä»¥ super.c() å°±ç›¸å½“äºŽ A.prototype.c()ã€‚ é€šè¿‡ super è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œsuper ä¼šç»‘å®šå­ç±»çš„ thisã€‚ 123456789101112131415161718192021class A &#123; constructor() &#123; this.x = 1; &#125; s() &#123; console.log(this.x); &#125;&#125;class B extends A &#123; constructor() &#123; super(); this.x = 2; &#125; m() &#123; super.s(); &#125;&#125;let b = new B();b.m(); // 2 ä¸Šé¢ä»£ç ä¸­ï¼Œsuper.s() è™½ç„¶è°ƒç”¨çš„æ˜¯ A.prototytpe.s()ï¼Œä½†æ˜¯ A.prototytpe.s()ä¼šç»‘å®šå­ç±» B çš„ thisï¼Œå¯¼è‡´è¾“å‡ºçš„æ˜¯ 2ï¼Œè€Œä¸æ˜¯ 1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®žé™…ä¸Šæ‰§è¡Œçš„æ˜¯ super.s.call(this)ã€‚ç”±äºŽç»‘å®šå­ç±»çš„ thisï¼Œæ‰€ä»¥å¦‚æžœé€šè¿‡ super å¯¹æŸä¸ªå±žæ€§èµ‹å€¼ï¼Œè¿™æ—¶ super å°±æ˜¯ thisï¼Œèµ‹å€¼çš„å±žæ€§ä¼šå˜æˆå­ç±»å®žä¾‹çš„å±žæ€§ã€‚ ç”±äºŽç»‘å®šå­ç±»çš„ thisï¼Œæ‰€ä»¥å¦‚æžœé€šè¿‡ super å¯¹æŸä¸ªå±žæ€§èµ‹å€¼ï¼Œè¿™æ—¶ super å°±æ˜¯ thisï¼Œèµ‹å€¼çš„å±žæ€§ä¼šå˜æˆå­ç±»å®žä¾‹çš„å±žæ€§ã€‚ 1234567891011121314151617class A &#123; constructor() &#123; this.x = 1; &#125;&#125;class B extends A &#123; constructor() &#123; super(); this.x = 2; super.x = 3; console.log(super.x); // undefined console.log(this.x); // 3 &#125;&#125;let b = new B(); ä¸Šé¢ä»£ç ä¸­ï¼Œsuper.x èµ‹å€¼ä¸º 3ï¼Œè¿™æ—¶ç­‰åŒäºŽå¯¹ this.x èµ‹å€¼ä¸º 3ã€‚è€Œå½“è¯»å– super.x çš„æ—¶å€™ï¼Œè°ƒç”¨çš„æ˜¯ A.prototype.xï¼Œä½†å¹¶æ²¡æœ‰ x æ–¹æ³•ï¼Œæ‰€ä»¥è¿”å›ž undefinedã€‚æ³¨æ„ï¼Œä½¿ç”¨ super çš„æ—¶å€™ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®šæ˜¯ä½œä¸ºå‡½æ•°ï¼Œè¿˜æ˜¯ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ 1234567class A &#123;&#125;class B extends A &#123; constructor() &#123; super(); console.log(super); // æŠ¥é”™ &#125;&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œconsole.log(super); çš„å½“ä¸­çš„ superï¼Œæ— æ³•çœ‹å‡ºæ˜¯ä½œä¸ºå‡½æ•°ä½¿ç”¨ï¼Œè¿˜æ˜¯ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œæ‰€ä»¥ JavaScript å¼•æ“Žè§£æžä»£ç çš„æ—¶å€™å°±ä¼šæŠ¥é”™ã€‚è¿™æ˜¯ï¼Œå¦‚æžœèƒ½æ¸…æ™°çš„è¡¨æ˜Ž super çš„æ•°æ®ç±»åž‹ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚ æœ€åŽï¼Œç”±äºŽå¯¹è±¡æ€»æ˜¯ç»§æ‰¿å…¶ä»–å¯¹è±¡çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä»»æ„ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½¿ç”¨ super å…³é”®å­—ã€‚ ç»“è¯­ï¼šES6 çš„ class æ¯•ç«Ÿæ˜¯ä¸€ä¸ªâ€œè¯­æ³•ç³–â€ï¼Œæ‰€ä»¥åªè¦ç†è§£äº† JavaScript ä¸­å¯¹è±¡çš„æ¦‚å¿µå’Œé¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œclass å°±ä¸éš¾ç†è§£å•¦]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[30 Seconds of ES6 ï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2019%2F01%2F27%2FJs%2F30-Seconds-of-ES6-%EF%BC%88%E4%B8%80%EF%BC%89%2F</url>
    <content type="text"><![CDATA[é¡¹ç›®èƒŒæ™¯ç®€ä»‹30 seconds of code æ˜¯ä¸€ä¸ªéžå¸¸ä¼˜è´¨ç²¾é€‰çš„ JavaScript é¡¹ç›® ï¼Œæ€»ç»“äº†å¤§é‡çš„ä½¿ç”¨ ES6 è¯­æ³•å®žçŽ°çš„ä»£ç å—ï¼Œé¡¹ç›®çš„è®¾è®¡ç›®æ ‡å°±æ˜¯æ›´ç®€æ´ï¼Œæ›´é«˜æ•ˆï¼Œæ›´å¿«é€Ÿçš„å®žçŽ°åŸºç¡€ä»£ç æ¨¡å—ï¼Œç¢Žç‰‡åŒ–å­¦ä¹ å®žç”¨å¹²è´§ï¼Œ 30 ç§’æŽŒæ¡ä¸€ä¸ªé«˜è´¨é‡ ES6 ä»£ç å— ã€‚ å­¦ä¹ åˆè¡·å­¦ä¹  ES6 åŸºç¡€çŸ¥è¯†ï¼Œæå‡ç¨‹åºç®—æ³•èƒ½åŠ›ï¼›å­¦ä¹  JavaScript åŸºç¡€ä»Ž API å¼€å§‹ã€‚æ¯ç¯‡ç²¾é€‰ 5 æ®µä¼˜ç§€ä»£ç å—ï¼Œå’Œ 5 ä¸ªä»¥ä¸Š API ï¼Œä¸ºå‰ç«¯å¤§å…¨æ ˆæ‰“ä¸‹åšå®žæ ¹åŸºï¼ å­¦ä¹ æ–¹æ³•è®¤çœŸè§£è¯»è‹±æ–‡ç‰ˆ 30 seconds of code çš„æ¯ä¸ª ES6 ä»£ç å—ï¼Œå¹¶æŠŠå…¶ä¸­çš„ API é‡ç‚¹åˆ†æžã€‚è®¤è¯†æ–°å•è¯ï¼Œæå‡è‹±è¯­æ°´å¹³ï¼Œç›®æ ‡å¯ä»¥è½»æ¾ç¿»é˜…è‹±æ–‡ç‰ˆä¸“ä¸šä¹¦ï¼Œå…¨é¢æå‡å‰ç«¯æŠ€æœ¯è½¯å®žåŠ›ã€‚ Adapter é€‚é…å™¨ aryåˆ›å»ºä¸€ä¸ªæŽ¥å—æœ€å¤š n ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¿½ç•¥ä»»ä½•å…¶ä»–å‚æ•°ã€‚ä½¿ç”¨ Array.prototype.sliceï¼ˆ0ï¼Œnï¼‰ æ–¹æ³•å’Œ spread æ‰©å±•è¿ç®—ç¬¦ ï¼ˆâ€¦ï¼‰ è°ƒç”¨æä¾›çš„å‡½æ•° fn ï¼ˆæœ€å¤š n ä¸ªå‚æ•°ï¼‰ã€‚ 123const ary = (fn , n) =&gt; (...args) =&gt; fn(...args.slice(0, n));const firstTwoMax = ary(Math.max, 2);console.log([[2, 6, 'a'], [8, 4, 6], [10]].map(x =&gt; firstTwoMax(...x)));//[6, 8, 10] MDN è§£æž Array.prototype.slice() æ¡ˆä¾‹è¯¥ slice() æ–¹æ³•è¿”å›žä¸€ä¸ªé˜µåˆ—çš„ä¸€éƒ¨åˆ†çš„ä¸€ä¸ªæµ…æ‹·è´ï¼Œåˆ°é€‰è‡ªæ–°çš„æ•°ç»„å¯¹è±¡ begin åˆ° end ( end ä¸åŒ…æ‹¬)ã€‚åŽŸå§‹æ•°ç»„ä¸ä¼šè¢«ä¿®æ”¹ã€‚ 123var animals = ['ant', 'bison', 'camel', 'duck', 'elephant'];console.log(animals.slice(2,4));//['camel', 'duck']console.log(animals);// ["ant", "bison", "camel", "duck", "elephant"] MDN è§£æž Math.max() æ¡ˆä¾‹è¯¥ Math.max() å‡½æ•°è¿”å›žé›¶ä¸ªæˆ–å¤šä¸ªæ•°å­—ä¸­çš„æœ€å¤§å€¼ã€‚ console.log(Math.max(-10, 20)); //20 Array æ•°ç»„ allå¦‚æžœæä¾›çš„è°“è¯å‡½æ•°å¯¹é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½è¿”å›ž true ï¼Œåˆ™è¿”å›ž trueï¼Œå¦åˆ™è¿”å›ž false ã€‚ä½¿ç”¨ Array.prototype.everyï¼ˆï¼‰ æµ‹è¯•é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦åŸºäºŽ fn è¿”å›ž true ã€‚çœç•¥ç¬¬äºŒä¸ªå‚æ•° fn ï¼Œå°†å¸ƒå°”å€¼ç”¨ä½œé»˜è®¤å€¼ã€‚ 1234const all = (arr, fn = Boolean) =&gt; arr.every(fn);console.log(all);console.log(all([4, 2, 3], x =&gt; x &gt;1));//trueconsole.log(all([1, 2, 3]));//true MDN è§£æž Array.prototype.every() æ¡ˆä¾‹è¯¥ every() æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½é€šè¿‡äº†ç”±æä¾›çš„å‡½æ•°å®žçŽ°çš„æµ‹è¯•ã€‚å¯¹äºŽç©ºæ•°ç»„ï¼Œä»»ä½•æƒ…å†µä¸‹è°ƒç”¨è¯¥æ–¹æ³•éƒ½ä¼šè¿”å›ž trueã€‚ 123console.log([12, 5, 8, 130, 44].every(x =&gt; x &gt;= 10));//falseconsole.log([12, 54, 18, 130, 44].every(x =&gt; x &gt;=10));//trueconsole.log([].every(x =&gt; x));//true Array æ•°ç»„ allEqualæ£€æŸ¥æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦ç›¸ç­‰ã€‚ä½¿ç”¨ Array.prototype.everyï¼ˆï¼‰ æ£€æŸ¥æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦ä¸Žç¬¬ä¸€ä¸ªå…ƒç´ ç›¸åŒã€‚ 123const allEqual = arr =&gt; arr.every( val =&gt; val === arr[0]);console.log(allEqual([1, 2, 3, 4, 5, 6]));//falseconsole.log(allEqual([1, 1, 1, 1]));//true Array æ•°ç»„ anyå¦‚æžœæä¾›çš„è°“è¯å‡½æ•°å¯¹é›†åˆä¸­çš„è‡³å°‘ä¸€ä¸ªå…ƒç´ è¿”å›ž true ï¼Œåˆ™è¿”å›ž true ï¼Œå¦åˆ™è¿”å›ž false ã€‚ä½¿ç”¨ Array.prototype.someï¼ˆï¼‰ æµ‹è¯•é›†åˆä¸­çš„ä»»ä½•å…ƒç´ æ˜¯å¦åŸºäºŽ fn è¿”å›ž true ã€‚çœç•¥ç¬¬äºŒä¸ªå‚æ•° fn ï¼Œå°†å¸ƒå°”å€¼ç”¨ä½œé»˜è®¤å€¼ã€‚ 123const any = (arr, fn = Boolean) =&gt; arr.some(fn);+console.log(any([0, 1, 2, 0], x =&gt; x &gt;=2));//trueconsole.log(any([0, 0, 1, 0]));//true MDN è§£æž Array.prototype.some() æ¡ˆä¾‹è¯¥ some () æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ é€šè¿‡äº†ç”±æä¾›çš„å‡½æ•°å®žçŽ°çš„æµ‹è¯•ã€‚æ­¤æ–¹æ³•è¿”å›ž false æ”¾åœ¨ç©ºæ•°ç»„ä¸Šçš„ä»»ä½•æ¡ä»¶ã€‚ 12console.log([2, 5, 8, 1, 4].some(x =&gt; x &gt; 10));//falseconsole.log([12, 5, 8 ,1 , 4].some( x =&gt; x &gt;10));//true Array æ•°ç»„ arrayToCSVå°†äºŒç»´æ•°ç»„è½¬æ¢ä¸ºé€—å·åˆ†éš”å€¼ï¼ˆ csv ï¼‰å­—ç¬¦ä¸²ã€‚ä½¿ç”¨ Array.prototype.map () å’Œ Array.prototype.joinï¼ˆdelimiterï¼‰ å°†ä¸€ç»´æ•°ç»„ç»„åˆæˆå­—ç¬¦ä¸²ã€‚ä½¿ç”¨ Array.prototype.joinï¼ˆâ€™\nâ€™ï¼‰ ï¼ˆ ï¼Œæ¢è¡Œç¬¦å·ï¼‰ä¸¤ä¸ªç»„åˆçš„å…¨è¡Œåˆ° CSV æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæ¯æŽ’åˆ†æ¡å’Œä¸€ä¸ªæ¢è¡Œç¬¦ã€‚åœ¨ç¬¬äºŒ omit å‚æ•°delimiter ï¼Œä½¿ç”¨ delimiterï¼ˆé»˜è®¤ï¼‰ã€‚ 123456789const arrayToCSV = (arr, delimiter = ',') =&gt; arr.map( v =&gt; v.map( x =&gt; `"$&#123;x&#125;"`).join(delimiter)).join('\n');console.log(arrayToCSV([['a', 'b'], ['c', 'd']]));//"a","b" //"c","d"console.log(arrayToCSV([['a', 'b'],['c', 'd']],';'));//"a","b" //"c","d" MDN è§£æž Array.prototype.map() æ¡ˆä¾‹è¯¥ map() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æžœæ˜¯åœ¨è°ƒç”¨æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä¸Šè°ƒç”¨æä¾›çš„å‡½æ•°ã€‚ 1234var array1 = [1, 4, 9 ,16];const map1 = array1.map(x =&gt; x * 2);console.log(map1);// [2, 8, 18, 32]console.log(array1);//[1, 4, 9, 16] MDN è§£æž Array.prototype.join() æ¡ˆä¾‹è¯¥ join() æ–¹æ³•é€šè¿‡è¿žæŽ¥æ•°ç»„ï¼ˆæˆ–ç±»æ•°ç»„å¯¹è±¡ï¼‰ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆç”±é€—å·æˆ–æŒ‡å®šçš„åˆ†éš”ç¬¦å­—ç¬¦ä¸²åˆ†éš”ï¼‰æ¥åˆ›å»ºå¹¶è¿”å›žæ–°å­—ç¬¦ä¸²ã€‚å¦‚æžœæ•°ç»„åªæœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œé‚£ä¹ˆå°†è¿”å›žè¯¥é¡¹ç›®è€Œä¸ä½¿ç”¨åˆ†éš”ç¬¦ã€‚å¦‚æžœå…ƒç´ æ˜¯ undefined æˆ– null ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²ã€‚123var elements = ['Fire', 'Wind', 'Rain'];console.log(console.log(elements.join('-')));//Fire-Wind-Rain]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Es6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue ç»„ä»¶ä¹‹é—´çš„é€šä¿¡]]></title>
    <url>%2F2019%2F01%2F20%2FVue%2Fvue-%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯Vueç»„ä»¶ï¼Ÿç»„ä»¶ (Component) æ˜¯ Vue.js æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ã€‚ç»„ä»¶å¯ä»¥æ‰©å±• HTML å…ƒç´ ï¼Œå°è£…å¯é‡ç”¨çš„ä»£ç ã€‚åœ¨è¾ƒé«˜å±‚é¢ä¸Šï¼Œç»„ä»¶æ˜¯è‡ªå®šä¹‰å…ƒç´ ï¼ŒVue.js çš„ç¼–è¯‘å™¨ä¸ºå®ƒæ·»åŠ ç‰¹æ®ŠåŠŸèƒ½ã€‚åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œç»„ä»¶ä¹Ÿå¯ä»¥æ˜¯åŽŸç”Ÿ HTML å…ƒç´ çš„å½¢å¼ï¼Œä»¥ is ç‰¹æ€§æ‰©å±•ã€‚ Vueç»„ä»¶é—´é€šä¿¡å¸¸è§ä½¿ç”¨åœºæ™¯å¯ä»¥åˆ†ä¸ºä¸‰ç±»: çˆ¶å­ç»„ä»¶é€šä¿¡: props; $parent / $children; provide / inject ; ref ; $attrs / $listenerså…„å¼Ÿç»„ä»¶é€šä¿¡: eventBus ; vuexè·¨çº§é€šä¿¡: eventBusï¼›Vuexï¼›provide / inject ã€$attrs / $listeners çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡ æ–¹æ³•ä¸€ï¼šprops ä½¿ç”¨propsï¼Œçˆ¶ç»„ä»¶å¯ä»¥ä½¿ç”¨propså‘å­ç»„ä»¶ä¼ é€’æ•°æ®ã€‚ çˆ¶ç»„ä»¶vueæ¨¡æ¿father.vue 12345678910111213141516171819&lt;template&gt; &lt;child :msg="message"&gt;&lt;/child&gt;&lt;/template&gt;&lt;script&gt;import child from './child.vue';export default &#123; components: &#123; child &#125;, data () &#123; return &#123; message: 'father message'; &#125; &#125;&#125;&lt;/script&gt; å­ç»„ä»¶vueæ¨¡æ¿child.vue 1234567891011121314&lt;template&gt; &lt;div&gt;&#123;&#123;msg&#125;&#125;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; props: &#123; msg: &#123; type: String, required: true &#125; &#125;&#125;&lt;/script&gt; æ–¹æ³•äºŒ ä½¿ç”¨$children ä½¿ç”¨$childrenå¯ä»¥åœ¨çˆ¶ç»„ä»¶ä¸­è®¿é—®å­ç»„ä»¶ã€‚ å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡ æ–¹æ³•ä¸€:ä½¿ç”¨vueäº‹ä»¶çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’äº‹ä»¶æ–¹æ³•ï¼Œå­ç»„ä»¶é€šè¿‡$emitè§¦å‘äº‹ä»¶ï¼Œå›žè°ƒç»™çˆ¶ç»„ä»¶ã€‚ çˆ¶ç»„ä»¶vueæ¨¡æ¿father.vue 12345678910111213141516171819&lt;template&gt; &lt;child @msgFunc="func"&gt;&lt;/child&gt;&lt;/template&gt;&lt;script&gt;import child from './child.vue';export default &#123; components: &#123; child &#125;, methods: &#123; func (msg) &#123; console.log(msg); &#125; &#125;&#125;&lt;/script&gt; å­ç»„ä»¶vueæ¨¡æ¿child.vue 1234567891011121314151617181920&lt;template&gt; &lt;button @click="handleClick"&gt;ç‚¹æˆ‘&lt;/button&gt;&lt;/template&gt;&lt;script&gt;export default &#123; props: &#123; msg: &#123; type: String, required: true &#125; &#125;, methods () &#123; handleClick () &#123; //........ this.$emit('msgFunc'); &#125; &#125;&#125;&lt;/script&gt; æ–¹æ³•äºŒï¼š é€šè¿‡ä¿®æ”¹çˆ¶ç»„ä»¶ä¼ é€’çš„propsæ¥ä¿®æ”¹çˆ¶ç»„ä»¶æ•°æ® è¿™ç§æ–¹æ³•åªèƒ½åœ¨çˆ¶ç»„ä»¶ä¼ é€’ä¸€ä¸ªå¼•ç”¨å˜é‡æ—¶å¯ä»¥ä½¿ç”¨ï¼Œå­—é¢å˜é‡æ— æ³•è¾¾åˆ°ç›¸åº”æ•ˆæžœã€‚å› ä¸ºå¼•ç”¨å˜é‡æœ€ç»ˆæ— è®ºæ˜¯çˆ¶ç»„ä»¶ä¸­çš„æ•°æ®è¿˜æ˜¯å­ç»„ä»¶å¾—åˆ°çš„propsä¸­çš„æ•°æ®éƒ½æ˜¯æŒ‡å‘åŒä¸€å—å†…å­˜åœ°å€ï¼Œæ‰€ä»¥ä¿®æ”¹äº†å­ç»„ä»¶ä¸­propsçš„æ•°æ®å³ä¿®æ”¹äº†çˆ¶ç»„ä»¶çš„æ•°æ®ã€‚ ä½†æ˜¯å¹¶ä¸æŽ¨èè¿™ä¹ˆåšï¼Œå¹¶ä¸å»ºè®®ç›´æŽ¥ä¿®æ”¹propsçš„å€¼ï¼Œå¦‚æžœæ•°æ®æ˜¯ç”¨äºŽæ˜¾ç¤ºä¿®æ”¹çš„ï¼Œåœ¨å®žé™…å¼€å‘ä¸­æˆ‘ç»å¸¸ä¼šå°†å…¶æ”¾å…¥dataä¸­ï¼Œåœ¨éœ€è¦å›žä¼ ç»™çˆ¶ç»„ä»¶çš„æ—¶å€™å†ç”¨äº‹ä»¶å›žä¼ æ•°æ®ã€‚è¿™æ ·åšä¿æŒäº†ç»„ä»¶ç‹¬ç«‹ä»¥åŠè§£è€¦ï¼Œä¸ä¼šå› ä¸ºä½¿ç”¨åŒä¸€ä»½æ•°æ®è€Œå¯¼è‡´æ•°æ®æµå¼‚å¸¸æ··ä¹±ï¼Œåªé€šè¿‡ç‰¹å®šçš„æŽ¥å£ä¼ é€’æ•°æ®æ¥è¾¾åˆ°ä¿®æ”¹æ•°æ®çš„ç›®çš„ï¼Œè€Œå†…éƒ¨æ•°æ®çŠ¶æ€ç”±ä¸“é—¨çš„dataè´Ÿè´£ç®¡ç†ã€‚ æ–¹æ³•ä¸‰ï¼šä½¿ç”¨$parent ä½¿ç”¨$parentå¯ä»¥è®¿é—®çˆ¶ç»„ä»¶çš„æ•°æ®ã€‚ éžçˆ¶å­ç»„ä»¶ã€å…„å¼Ÿç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’éžçˆ¶å­ç»„ä»¶é€šä¿¡ï¼ŒVueå®˜æ–¹æŽ¨èä½¿ç”¨ä¸€ä¸ªVueå®žä¾‹ä½œä¸ºä¸­å¤®äº‹ä»¶æ€»çº¿ã€‚ Vueå†…éƒ¨æœ‰ä¸€ä¸ªäº‹ä»¶æœºåˆ¶ï¼Œå¯ä»¥å‚è€ƒæºç ã€‚ $onæ–¹æ³•ç”¨æ¥ç›‘å¬ä¸€ä¸ªäº‹ä»¶ã€‚ $emitç”¨æ¥è§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚ 12345678910/*æ–°å»ºä¸€ä¸ªVueå®žä¾‹ä½œä¸ºä¸­å¤®äº‹ä»¶æ€»å«Œ*/let event = new Vue();/*ç›‘å¬äº‹ä»¶*/event.$on('eventName', (val) =&gt; &#123; //......do something&#125;);/*è§¦å‘äº‹ä»¶*/event.$emit('eventName', 'this is a message.'); å¤šå±‚çº§çˆ¶å­ç»„ä»¶é€šä¿¡ï¼šåœ¨Vue1.0ä¸­å®žçŽ°äº†$broadcastä¸Ž$dispatchä¸¤ä¸ªæ–¹æ³•ç”¨æ¥å‘å­ç»„ä»¶ï¼ˆæˆ–çˆ¶ç»„ä»¶ï¼‰å¹¿æ’­ï¼ˆæˆ–æ´¾å‘ï¼‰ï¼Œå½“å­ç»„ä»¶ï¼ˆæˆ–çˆ¶ç»„ä»¶ï¼‰ä¸Šç›‘å¬äº†äº‹ä»¶å¹¶è¿”å›žtrueçš„æ—¶å€™ä¼šå‘çˆ·å­™çº§ç»„ä»¶ç»§ç»­å¹¿æ’­ï¼ˆæˆ–æ´¾å‘ï¼‰äº‹ä»¶ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•åœ¨Vue2.0é‡Œé¢å·²ç»è¢«ç§»é™¤äº†ã€‚ ä¹‹å‰åœ¨å­¦ä¹ é¥¿äº†ä¹ˆçš„å¼€æºç»„ä»¶åº“elementçš„æ—¶å€™å‘çŽ°ä»–ä»¬é‡æ–°å®žçŽ°äº†broadcastä»¥åŠdispatchçš„æ–¹æ³•ï¼Œä»¥mixinçš„æ–¹å¼å¼•å…¥ï¼Œå…·ä½“å¯ä»¥å‚è€ƒã€Šè¯´è¯´elementç»„ä»¶åº“broadcastä¸Ždispatchã€‹ã€‚ä½†æ˜¯è·ŸVue1.0çš„ä¸¤ä¸ªæ–¹æ³•å®žçŽ°æœ‰ç•¥å¾®çš„ä¸åŒã€‚è¿™ä¸¤ä¸ªæ–¹æ³•å®žçŽ°äº†å‘å­å­™ç»„ä»¶äº‹ä»¶å¹¿æ’­ä»¥åŠå‘å¤šå±‚çº§çˆ¶ç»„ä»¶äº‹ä»¶æ´¾å‘çš„åŠŸèƒ½ã€‚ä½†æ˜¯å¹¶éžå¹¿ä¹‰ä¸Šçš„äº‹ä»¶å¹¿æ’­ï¼Œå®ƒéœ€è¦æŒ‡å®šä¸€ä¸ªcommentNameè¿›è¡Œå‘æŒ‡å®šç»„ä»¶åç»„ä»¶å®šå‘å¹¿æ’­ï¼ˆæ´¾å‘ï¼‰äº‹ä»¶ã€‚ å…¶å®žè¿™ä¸¤ä¸ªæ–¹æ³•å†…éƒ¨å®žçŽ°è¿˜æ˜¯ç”¨åˆ°çš„è¿˜æ˜¯$parentä»¥åŠ$childrenï¼Œç”¨ä»¥éåŽ†å­èŠ‚ç‚¹æˆ–æ˜¯é€çº§å‘ä¸ŠæŸ¥è¯¢çˆ¶èŠ‚ç‚¹ï¼Œè®¿é—®åˆ°æŒ‡å®šç»„ä»¶åçš„æ—¶å€™ï¼Œè°ƒç”¨$emitè§¦å‘æŒ‡å®šäº‹ä»¶ã€‚ å¤æ‚çš„å•é¡µåº”ç”¨æ•°æ®ç®¡ç†å½“åº”ç”¨è¶³å¤Ÿå¤æ‚æƒ…å†µä¸‹ï¼Œè¯·ä½¿ç”¨vuexè¿›è¡Œæ•°æ®ç®¡ç†ã€‚]]></content>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[keep-aliveç»„ä»¶çš„ä½¿ç”¨åŠå…¶å®žçŽ°åŽŸç†]]></title>
    <url>%2F2019%2F01%2F13%2FVue%2Fkeep-alive%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%85%B6%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[keep-alivekeep-aliveæ˜¯Vue.jsçš„ä¸€ä¸ªå†…ç½®ç»„ä»¶ã€‚å®ƒèƒ½å¤Ÿä¸æ´»åŠ¨çš„ç»„ä»¶å®žä¾‹ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯ç›´æŽ¥å°†å…¶é”€æ¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç»„ä»¶ï¼Œä¸ä¼šè¢«æ¸²æŸ“åˆ°çœŸå®žDOMä¸­ï¼Œä¹Ÿä¸ä¼šå‡ºçŽ°åœ¨çˆ¶ç»„ä»¶é“¾ä¸­ã€‚ å®ƒæä¾›äº†includeä¸Žexcludeä¸¤ä¸ªå±žæ€§ï¼Œå…è®¸ç»„ä»¶æœ‰æ¡ä»¶åœ°è¿›è¡Œç¼“å­˜ã€‚ å…·ä½“å†…å®¹å¯ä»¥å‚è€ƒå®˜ç½‘ã€‚ ç”¨æ³•123&lt;keep-alive&gt; &lt;component&gt;&lt;/component&gt;&lt;/keep-alive&gt; è¿™é‡Œçš„componentç»„ä»¶ä¼šè¢«ç¼“å­˜èµ·æ¥ã€‚ ä¸¾ä¸ªæ —å­ 12345&lt;keep-alive&gt; &lt;coma v-if="test"&gt;&lt;/coma&gt; &lt;comb v-else&gt;&lt;/comb&gt;&lt;keep-alive/&gt;&lt;button @click="test=handleClick"&gt;è¯·ç‚¹å‡»&lt;/button&gt; 123456789101112export default &#123; data () &#123; return &#123; test: true &#125; &#125;, methods: &#123; handleClick () &#123; this.test = !this.test; &#125; &#125;&#125; åœ¨ç‚¹å‡»buttonæ—¶å€™ï¼Œcomaä¸Žcombä¸¤ä¸ªç»„ä»¶ä¼šå‘ç”Ÿåˆ‡æ¢ï¼Œä½†æ˜¯è¿™æ—¶å€™è¿™ä¸¤ä¸ªç»„ä»¶çš„çŠ¶æ€ä¼šè¢«ç¼“å­˜èµ·æ¥ï¼Œæ¯”å¦‚è¯´comaä¸Žcombç»„ä»¶ä¸­éƒ½æœ‰ä¸€ä¸ªinputæ ‡ç­¾ï¼Œé‚£ä¹ˆinputæ ‡ç­¾ä¸­çš„å†…å®¹ä¸ä¼šå› ä¸ºç»„ä»¶çš„åˆ‡æ¢è€Œæ¶ˆå¤±ã€‚ propskeep-aliveç»„ä»¶æä¾›äº†includeä¸Žexcludeä¸¤ä¸ªå±žæ€§æ¥å…è®¸ç»„ä»¶æœ‰æ¡ä»¶åœ°è¿›è¡Œç¼“å­˜ï¼ŒäºŒè€…éƒ½å¯ä»¥ç”¨é€—å·åˆ†éš”å­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼æˆ–ä¸€ä¸ªæ•°ç»„æ¥è¡¨ç¤ºã€‚ 123&lt;keep-alive include="a"&gt; &lt;component&gt;&lt;/component&gt;&lt;/keep-alive&gt; 12345å°†ç¼“å­˜nameä¸ºaçš„ç»„ä»¶ã€‚&lt;keep-alive exclude="a"&gt; &lt;component&gt;&lt;/component&gt;&lt;/keep-alive&gt; nameä¸ºaçš„ç»„ä»¶å°†ä¸ä¼šè¢«ç¼“å­˜ã€‚ ç”Ÿå‘½é’©å­keep-aliveæä¾›äº†ä¸¤ä¸ªç”Ÿå‘½é’©å­ï¼Œåˆ†åˆ«æ˜¯activatedä¸Ždeactivatedã€‚ å› ä¸ºkeep-aliveä¼šå°†ç»„ä»¶ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸ä¼šé”€æ¯ä»¥åŠé‡æ–°åˆ›å»ºï¼Œæ‰€ä»¥ä¸ä¼šé‡æ–°è°ƒç”¨ç»„ä»¶çš„createdç­‰æ–¹æ³•ï¼Œéœ€è¦ç”¨activatedä¸Ždeactivatedè¿™ä¸¤ä¸ªç”Ÿå‘½é’©å­æ¥å¾—çŸ¥å½“å‰ç»„ä»¶æ˜¯å¦å¤„äºŽæ´»åŠ¨çŠ¶æ€ã€‚ æ·±å…¥keep-aliveç»„ä»¶å®žçŽ°è¯´å®Œäº†keep-aliveç»„ä»¶çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬ä»Žæºç è§’åº¦çœ‹ä¸€ä¸‹keep-aliveç»„ä»¶ç©¶ç«Ÿæ˜¯å¦‚ä½•å®žçŽ°ç»„ä»¶çš„ç¼“å­˜çš„å‘¢ï¼Ÿ createdä¸Ždestroyedé’©å­createdé’©å­ä¼šåˆ›å»ºä¸€ä¸ªcacheå¯¹è±¡ï¼Œç”¨æ¥ä½œä¸ºç¼“å­˜å®¹å™¨ï¼Œä¿å­˜vnodeèŠ‚ç‚¹ã€‚ 1234created () &#123; /* ç¼“å­˜å¯¹è±¡ */ this.cache = Object.create(null)&#125;, destroyedé’©å­åˆ™åœ¨ç»„ä»¶è¢«é”€æ¯çš„æ—¶å€™æ¸…é™¤cacheç¼“å­˜ä¸­çš„æ‰€æœ‰ç»„ä»¶å®žä¾‹ã€‚ 123456/* destroyedé’©å­ä¸­é”€æ¯æ‰€æœ‰cacheä¸­çš„ç»„ä»¶å®žä¾‹ */destroyed () &#123; for (const key in this.cache) &#123; pruneCacheEntry(this.cache[key]) &#125;&#125;, renderæŽ¥ä¸‹æ¥æ˜¯renderå‡½æ•°ã€‚ 1234567891011121314151617181920212223242526272829303132render () &#123; /* å¾—åˆ°slotæ’æ§½ä¸­çš„ç¬¬ä¸€ä¸ªç»„ä»¶ */ const vnode: VNode = getFirstComponentChild(this.$slots.default) const componentOptions: ?VNodeComponentOptions = vnode &amp;&amp; vnode.componentOptions if (componentOptions) &#123; // check pattern /* èŽ·å–ç»„ä»¶åç§°ï¼Œä¼˜å…ˆèŽ·å–ç»„ä»¶çš„nameå­—æ®µï¼Œå¦åˆ™æ˜¯ç»„ä»¶çš„tag */ const name: ?string = getComponentName(componentOptions) /* nameä¸åœ¨inlcudeä¸­æˆ–è€…åœ¨exludeä¸­åˆ™ç›´æŽ¥è¿”å›žvnodeï¼ˆæ²¡æœ‰å–ç¼“å­˜ï¼‰ */ if (name &amp;&amp; ( (this.include &amp;&amp; !matches(this.include, name)) || (this.exclude &amp;&amp; matches(this.exclude, name)) )) &#123; return vnode &#125; const key: ?string = vnode.key == null // same constructor may get registered as different local components // so cid alone is not enough (#3269) ? componentOptions.Ctor.cid + (componentOptions.tag ? `::$&#123;componentOptions.tag&#125;` : '') : vnode.key /* å¦‚æžœå·²ç»åšè¿‡ç¼“å­˜äº†åˆ™ç›´æŽ¥ä»Žç¼“å­˜ä¸­èŽ·å–ç»„ä»¶å®žä¾‹ç»™vnodeï¼Œè¿˜æœªç¼“å­˜è¿‡åˆ™è¿›è¡Œç¼“å­˜ */ if (this.cache[key]) &#123; vnode.componentInstance = this.cache[key].componentInstance &#125; else &#123; this.cache[key] = vnode &#125; /* keepAliveæ ‡è®°ä½ */ vnode.data.keepAlive = true &#125; return vnode&#125; é¦–å…ˆé€šè¿‡getFirstComponentChildèŽ·å–ç¬¬ä¸€ä¸ªå­ç»„ä»¶ï¼ŒèŽ·å–è¯¥ç»„ä»¶çš„nameï¼ˆå­˜åœ¨ç»„ä»¶ååˆ™ç›´æŽ¥ä½¿ç”¨ç»„ä»¶åï¼Œå¦åˆ™ä¼šä½¿ç”¨tagï¼‰ã€‚æŽ¥ä¸‹æ¥ä¼šå°†è¿™ä¸ªnameé€šè¿‡includeä¸Žexcludeå±žæ€§è¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…ä¸æˆåŠŸï¼ˆè¯´æ˜Žä¸éœ€è¦è¿›è¡Œç¼“å­˜ï¼‰åˆ™ä¸è¿›è¡Œä»»ä½•æ“ä½œç›´æŽ¥è¿”å›žvnodeï¼Œvnodeæ˜¯ä¸€ä¸ªVNodeç±»åž‹çš„å¯¹è±¡ï¼Œä¸äº†è§£VNodeçš„åŒå­¦å¯ä»¥å‚è€ƒç¬”è€…çš„å¦ä¸€ç¯‡æ–‡ç« ã€ŠVNodeèŠ‚ç‚¹ã€‹ . 123456789101112/* æ£€æµ‹nameæ˜¯å¦åŒ¹é… */function matches (pattern: string | RegExp, name: string): boolean &#123; if (typeof pattern === 'string') &#123; /* å­—ç¬¦ä¸²æƒ…å†µï¼Œå¦‚a,b,c */ return pattern.split(',').indexOf(name) &gt; -1 &#125; else if (isRegExp(pattern)) &#123; /* æ­£åˆ™ */ return pattern.test(name) &#125; /* istanbul ignore next */ return false&#125; æ£€æµ‹includeä¸Žexcludeå±žæ€§åŒ¹é…çš„å‡½æ•°å¾ˆç®€å•ï¼Œincludeä¸Žexcludeå±žæ€§æ”¯æŒå­—ç¬¦ä¸²å¦‚â€a,b,câ€è¿™æ ·ç»„ä»¶åä»¥é€—å·éš”å¼€çš„æƒ…å†µä»¥åŠæ­£åˆ™è¡¨è¾¾å¼ã€‚matchesé€šè¿‡è¿™ä¸¤ç§æ–¹å¼åˆ†åˆ«æ£€æµ‹æ˜¯å¦åŒ¹é…å½“å‰ç»„ä»¶ã€‚ 12345if (this.cache[key]) &#123; vnode.componentInstance = this.cache[key].componentInstance&#125; else &#123; this.cache[key] = vnode&#125; æŽ¥ä¸‹æ¥çš„äº‹æƒ…å¾ˆç®€å•ï¼Œæ ¹æ®keyåœ¨this.cacheä¸­æŸ¥æ‰¾ï¼Œå¦‚æžœå­˜åœ¨åˆ™è¯´æ˜Žä¹‹å‰å·²ç»ç¼“å­˜è¿‡äº†ï¼Œç›´æŽ¥å°†ç¼“å­˜çš„vnodeçš„componentInstanceï¼ˆç»„ä»¶å®žä¾‹ï¼‰è¦†ç›–åˆ°ç›®å‰çš„vnodeä¸Šé¢ã€‚å¦åˆ™å°†vnodeå­˜å‚¨åœ¨cacheä¸­ã€‚ æœ€åŽè¿”å›žvnodeï¼ˆæœ‰ç¼“å­˜æ—¶è¯¥vnodeçš„componentInstanceå·²ç»è¢«æ›¿æ¢æˆç¼“å­˜ä¸­çš„äº†ï¼‰ã€‚ watchç”¨watchæ¥ç›‘å¬pruneCacheä¸ŽpruneCacheè¿™ä¸¤ä¸ªå±žæ€§çš„æ”¹å˜ï¼Œåœ¨æ”¹å˜çš„æ—¶å€™ä¿®æ”¹cacheç¼“å­˜ä¸­çš„ç¼“å­˜æ•°æ®ã€‚ 123456789watch: &#123; /* ç›‘è§†includeä»¥åŠexcludeï¼Œåœ¨è¢«ä¿®æ”¹çš„æ—¶å€™å¯¹cacheè¿›è¡Œä¿®æ­£ */ include (val: string | RegExp) &#123; pruneCache(this.cache, this._vnode, name =&gt; matches(val, name)) &#125;, exclude (val: string | RegExp) &#123; pruneCache(this.cache, this._vnode, name =&gt; !matches(val, name)) &#125;&#125;, æ¥çœ‹ä¸€ä¸‹pruneCacheçš„å®žçŽ°ã€‚ 123456789101112131415161718192021222324/* ä¿®æ­£cache */function pruneCache (cache: VNodeCache, current: VNode, filter: Function) &#123; for (const key in cache) &#123; /* å–å‡ºcacheä¸­çš„vnode */ const cachedNode: ?VNode = cache[key] if (cachedNode) &#123; const name: ?string = getComponentName(cachedNode.componentOptions) /* nameä¸ç¬¦åˆfilteræ¡ä»¶çš„ï¼ŒåŒæ—¶ä¸æ˜¯ç›®å‰æ¸²æŸ“çš„vnodeæ—¶ï¼Œé”€æ¯vnodeå¯¹åº”çš„ç»„ä»¶å®žä¾‹ï¼ˆVueå®žä¾‹ï¼‰ï¼Œå¹¶ä»Žcacheä¸­ç§»é™¤ */ if (name &amp;&amp; !filter(name)) &#123; if (cachedNode !== current) &#123; pruneCacheEntry(cachedNode) &#125; cache[key] = null &#125; &#125; &#125;&#125; /* é”€æ¯vnodeå¯¹åº”çš„ç»„ä»¶å®žä¾‹ï¼ˆVueå®žä¾‹ï¼‰ */function pruneCacheEntry (vnode: ?VNode) &#123; if (vnode) &#123; vnode.componentInstance.$destroy() &#125;&#125; éåŽ†cacheä¸­çš„æ‰€æœ‰é¡¹ï¼Œå¦‚æžœä¸ç¬¦åˆfilteræŒ‡å®šçš„è§„åˆ™çš„è¯ï¼Œåˆ™ä¼šæ‰§è¡ŒpruneCacheEntryã€‚pruneCacheEntryåˆ™ä¼šè°ƒç”¨ç»„ä»¶å®žä¾‹çš„$destroyæ–¹æ³•æ¥å°†ç»„ä»¶é”€æ¯ã€‚ æœ€åŽVue.jså†…éƒ¨å°†DOMèŠ‚ç‚¹æŠ½è±¡æˆäº†ä¸€ä¸ªä¸ªçš„VNodeèŠ‚ç‚¹ï¼Œkeep-aliveç»„ä»¶çš„ç¼“å­˜ä¹Ÿæ˜¯åŸºäºŽVNodeèŠ‚ç‚¹çš„è€Œä¸æ˜¯ç›´æŽ¥å­˜å‚¨DOMç»“æž„ã€‚å®ƒå°†æ»¡è¶³æ¡ä»¶ï¼ˆpruneCacheä¸ŽpruneCacheï¼‰çš„ç»„ä»¶åœ¨cacheå¯¹è±¡ä¸­ç¼“å­˜èµ·æ¥ï¼Œåœ¨éœ€è¦é‡æ–°æ¸²æŸ“çš„æ—¶å€™å†å°†vnodeèŠ‚ç‚¹ä»Žcacheå¯¹è±¡ä¸­å–å‡ºå¹¶æ¸²æŸ“ã€‚]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vuexæºç è§£æž]]></title>
    <url>%2F2019%2F01%2F06%2FVue%2FVuex%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%2F</url>
    <content type="text"><![CDATA[å‰è¨€æˆ‘ä»¬åœ¨ä½¿ç”¨Vue.jså¼€å‘å¤æ‚çš„åº”ç”¨æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°å¤šä¸ªç»„ä»¶å…±äº«åŒä¸€ä¸ªçŠ¶æ€ï¼Œäº¦æˆ–æ˜¯å¤šä¸ªç»„ä»¶ä¼šåŽ»æ›´æ–°åŒä¸€ä¸ªçŠ¶æ€ï¼Œåœ¨åº”ç”¨ä»£ç é‡è¾ƒå°‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç»„ä»¶é—´é€šä¿¡åŽ»ç»´æŠ¤ä¿®æ”¹æ•°æ®ï¼Œæˆ–è€…æ˜¯é€šè¿‡äº‹ä»¶æ€»çº¿æ¥è¿›è¡Œæ•°æ®çš„ä¼ é€’ä»¥åŠä¿®æ”¹ã€‚ä½†æ˜¯å½“åº”ç”¨é€æ¸åºžå¤§ä»¥åŽï¼Œä»£ç å°±ä¼šå˜å¾—éš¾ä»¥ç»´æŠ¤ï¼Œä»Žçˆ¶ç»„ä»¶å¼€å§‹é€šè¿‡propä¼ é€’å¤šå±‚åµŒå¥—çš„æ•°æ®ç”±äºŽå±‚çº§è¿‡æ·±è€Œæ˜¾å¾—å¼‚å¸¸è„†å¼±ï¼Œè€Œäº‹ä»¶æ€»çº¿ä¹Ÿä¼šå› ä¸ºç»„ä»¶çš„å¢žå¤šã€ä»£ç é‡çš„å¢žå¤§è€Œæ˜¾å¾—äº¤äº’é”™ç»¼å¤æ‚ï¼Œéš¾ä»¥æ‹æ¸…å…¶ä¸­çš„ä¼ é€’å…³ç³»ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½å°†æ•°æ®å±‚ä¸Žç»„ä»¶å±‚æŠ½ç¦»å¼€æ¥å‘¢ï¼ŸæŠŠæ•°æ®å±‚æ”¾åˆ°å…¨å±€å½¢æˆä¸€ä¸ªå•ä¸€çš„Storeï¼Œç»„ä»¶å±‚å˜å¾—æ›´è–„ï¼Œä¸“é—¨ç”¨æ¥è¿›è¡Œæ•°æ®çš„å±•ç¤ºåŠæ“ä½œã€‚æ‰€æœ‰æ•°æ®çš„å˜æ›´éƒ½éœ€è¦ç»è¿‡å…¨å±€çš„Storeæ¥è¿›è¡Œï¼Œå½¢æˆä¸€ä¸ªå•å‘æ•°æ®æµï¼Œä½¿æ•°æ®å˜åŒ–å˜å¾—â€œå¯é¢„æµ‹â€ã€‚ Vuexæ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºVue.jsæ¡†æž¶è®¾è®¡çš„ã€ç”¨äºŽå¯¹Vue.jsåº”ç”¨ç¨‹åºè¿›è¡ŒçŠ¶æ€ç®¡ç†çš„åº“ï¼Œå®ƒå€Ÿé‰´äº†Fluxã€reduxçš„åŸºæœ¬æ€æƒ³ï¼Œå°†å…±äº«çš„æ•°æ®æŠ½ç¦»åˆ°å…¨å±€ï¼Œä»¥ä¸€ä¸ªå•ä¾‹å­˜æ”¾ï¼ŒåŒæ—¶åˆ©ç”¨Vue.jsçš„å“åº”å¼æœºåˆ¶æ¥è¿›è¡Œé«˜æ•ˆçš„çŠ¶æ€ç®¡ç†ä¸Žæ›´æ–°ã€‚æ­£æ˜¯å› ä¸ºVuexä½¿ç”¨äº†Vue.jså†…éƒ¨çš„â€œå“åº”å¼æœºåˆ¶â€ï¼Œæ‰€ä»¥Vuexæ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºVue.jsè®¾è®¡å¹¶ä¸Žä¹‹é«˜åº¦å¥‘åˆçš„æ¡†æž¶ï¼ˆä¼˜ç‚¹æ˜¯æ›´åŠ ç®€æ´é«˜æ•ˆï¼Œç¼ºç‚¹æ˜¯åªèƒ½è·ŸVue.jsæ­é…ä½¿ç”¨ï¼‰ã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•åŠAPIå¯ä»¥å‚è€ƒVuexçš„å®˜ç½‘ã€‚ Vuexå®žçŽ°äº†ä¸€ä¸ªå•å‘æ•°æ®æµï¼Œåœ¨å…¨å±€æ‹¥æœ‰ä¸€ä¸ªStateå­˜æ”¾æ•°æ®ï¼Œæ‰€æœ‰ä¿®æ”¹Stateçš„æ“ä½œå¿…é¡»é€šè¿‡Mutationè¿›è¡Œï¼ŒMutationçš„åŒæ—¶æä¾›äº†è®¢é˜…è€…æ¨¡å¼ä¾›å¤–éƒ¨æ’ä»¶è°ƒç”¨èŽ·å–Stateæ•°æ®çš„æ›´æ–°ã€‚æ‰€æœ‰å¼‚æ­¥æŽ¥å£éœ€è¦èµ°Actionï¼Œå¸¸è§äºŽè°ƒç”¨åŽç«¯æŽ¥å£å¼‚æ­¥èŽ·å–æ›´æ–°æ•°æ®ï¼Œè€ŒActionä¹Ÿæ˜¯æ— æ³•ç›´æŽ¥ä¿®æ”¹Stateçš„ï¼Œè¿˜æ˜¯éœ€è¦é€šè¿‡Mutationæ¥ä¿®æ”¹Stateçš„æ•°æ®ã€‚æœ€åŽï¼Œæ ¹æ®Stateçš„å˜åŒ–ï¼Œæ¸²æŸ“åˆ°è§†å›¾ä¸Šã€‚Vuexè¿è¡Œä¾èµ–Vueå†…éƒ¨æ•°æ®åŒå‘ç»‘å®šæœºåˆ¶ï¼Œéœ€è¦newä¸€ä¸ªVueå¯¹è±¡æ¥å®žçŽ°â€œå“åº”å¼åŒ–â€ï¼Œæ‰€ä»¥Vuexæ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºVue.jsè®¾è®¡çš„çŠ¶æ€ç®¡ç†åº“ã€‚ å®‰è£…ä½¿ç”¨è¿‡Vuexçš„æœ‹å‹ä¸€å®šçŸ¥é“ï¼ŒVuexçš„å®‰è£…ååˆ†ç®€å•ï¼Œåªéœ€è¦æä¾›ä¸€ä¸ªstoreï¼Œç„¶åŽæ‰§è¡Œä¸‹é¢ä¸¤å¥ä»£ç å³å®Œæˆçš„Vuexçš„å¼•å…¥ã€‚ 1234567Vue.use(Vuex);/*å°†storeæ”¾å…¥Vueåˆ›å»ºæ—¶çš„optionä¸­*/new Vue(&#123; el: '#app', store&#125;); é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒVuexæ˜¯æ€Žæ ·æŠŠstoreæ³¨å…¥åˆ°Vueå®žä¾‹ä¸­åŽ»çš„å‘¢ï¼Ÿ Vue.jsæä¾›äº†Vue.useæ–¹æ³•ç”¨æ¥ç»™Vue.jså®‰è£…æ’ä»¶ï¼Œå†…éƒ¨é€šè¿‡è°ƒç”¨æ’ä»¶çš„installæ–¹æ³•(å½“æ’ä»¶æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™)æ¥è¿›è¡Œæ’ä»¶çš„å®‰è£…ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Vuexçš„installå®žçŽ°ã€‚ 12345678910111213141516/*æš´éœ²ç»™å¤–éƒ¨çš„æ’ä»¶installæ–¹æ³•ï¼Œä¾›Vue.useè°ƒç”¨å®‰è£…æ’ä»¶*/export function install (_Vue) &#123; if (Vue) &#123; /*é¿å…é‡å¤å®‰è£…ï¼ˆVue.useå†…éƒ¨ä¹Ÿä¼šæ£€æµ‹ä¸€æ¬¡æ˜¯å¦é‡å¤å®‰è£…åŒä¸€ä¸ªæ’ä»¶ï¼‰*/ if (process.env.NODE_ENV !== 'production') &#123; console.error( '[vuex] already installed. Vue.use(Vuex) should be called only once.' ) &#125; return &#125; /*ä¿å­˜Vueï¼ŒåŒæ—¶ç”¨äºŽæ£€æµ‹æ˜¯å¦é‡å¤å®‰è£…*/ Vue = _Vue /*å°†vuexInitæ··æ·†è¿›Vueçš„beforeCreate(Vue2.0)æˆ–_initæ–¹æ³•(Vue1.0)*/ applyMixin(Vue)&#125; è¿™æ®µinstallä»£ç åšäº†ä¸¤ä»¶äº‹æƒ…ï¼Œä¸€ä»¶æ˜¯é˜²æ­¢Vuexè¢«é‡å¤å®‰è£…ï¼Œå¦ä¸€ä»¶æ˜¯æ‰§è¡ŒapplyMixinï¼Œç›®çš„æ˜¯æ‰§è¡ŒvuexInitæ–¹æ³•åˆå§‹åŒ–Vuexã€‚Vuexé’ˆå¯¹Vue1.0ä¸Ž2.0åˆ†åˆ«è¿›è¡Œäº†ä¸åŒçš„å¤„ç†ï¼Œå¦‚æžœæ˜¯Vue1.0ï¼ŒVuexä¼šå°†vuexInitæ–¹æ³•æ”¾å…¥Vueçš„_initæ–¹æ³•ä¸­ï¼Œè€Œå¯¹äºŽVue2.0ï¼Œåˆ™ä¼šå°†vuexinitæ··æ·†è¿›Vueçš„beforeCreacteé’©å­ä¸­ã€‚æ¥çœ‹ä¸€ä¸‹vuexInitçš„ä»£ç ã€‚ 1234567891011121314/*Vuexçš„inité’©å­ï¼Œä¼šå­˜å…¥æ¯ä¸€ä¸ªVueå®žä¾‹ç­‰é’©å­åˆ—è¡¨*/ function vuexInit () &#123; const options = this.$options // store injection if (options.store) &#123; /*å­˜åœ¨storeå…¶å®žä»£è¡¨çš„å°±æ˜¯RootèŠ‚ç‚¹ï¼Œç›´æŽ¥æ‰§è¡Œstoreï¼ˆfunctionæ—¶ï¼‰æˆ–è€…ä½¿ç”¨storeï¼ˆéžfunctionï¼‰*/ this.$store = typeof options.store === 'function' ? options.store() : options.store &#125; else if (options.parent &amp;&amp; options.parent.$store) &#123; /*å­ç»„ä»¶ç›´æŽ¥ä»Žçˆ¶ç»„ä»¶ä¸­èŽ·å–$storeï¼Œè¿™æ ·å°±ä¿è¯äº†æ‰€æœ‰ç»„ä»¶éƒ½å…¬ç”¨äº†å…¨å±€çš„åŒä¸€ä»½store*/ this.$store = options.parent.$store &#125; &#125; vuexInitä¼šå°è¯•ä»Žoptionsä¸­èŽ·å–storeï¼Œå¦‚æžœå½“å‰ç»„ä»¶æ˜¯æ ¹ç»„ä»¶ï¼ˆRootèŠ‚ç‚¹ï¼‰ï¼Œåˆ™optionsä¸­ä¼šå­˜åœ¨storeï¼Œç›´æŽ¥èŽ·å–èµ‹å€¼ç»™$storeå³å¯ã€‚å¦‚æžœå½“å‰ç»„ä»¶éžæ ¹ç»„ä»¶ï¼Œåˆ™é€šè¿‡optionsä¸­çš„parentèŽ·å–çˆ¶ç»„ä»¶çš„$storeå¼•ç”¨ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ‰€æœ‰çš„ç»„ä»¶éƒ½èŽ·å–åˆ°äº†åŒä¸€ä»½å†…å­˜åœ°å€çš„Storeå®žä¾‹ï¼ŒäºŽæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸€ä¸ªç»„ä»¶ä¸­é€šè¿‡this.$storeæ„‰å¿«åœ°è®¿é—®å…¨å±€çš„Storeå®žä¾‹äº†ã€‚ é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯Storeå®žä¾‹ï¼Ÿ Storeæˆ‘ä»¬ä¼ å…¥åˆ°æ ¹ç»„ä»¶åˆ°storeï¼Œå°±æ˜¯Storeå®žä¾‹ï¼Œç”¨Vuexæä¾›åˆ°Storeæ–¹æ³•æž„é€ ã€‚ 1234567export default new Vuex.Store(&#123; strict: true, modules: &#123; moduleA, moduleB &#125;&#125;); æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Storeçš„å®žçŽ°ã€‚é¦–å…ˆæ˜¯æž„é€ å‡½æ•°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687constructor (options = &#123;&#125;) &#123; // Auto install if it is not done yet and `window` has `Vue`. // To allow users to avoid auto-installation in some cases, // this code should be placed here. See #731 /* åœ¨æµè§ˆå™¨çŽ¯å¢ƒä¸‹ï¼Œå¦‚æžœæ’ä»¶è¿˜æœªå®‰è£…ï¼ˆ!Vueå³åˆ¤æ–­æ˜¯å¦æœªå®‰è£…ï¼‰ï¼Œåˆ™å®ƒä¼šè‡ªåŠ¨å®‰è£…ã€‚ å®ƒå…è®¸ç”¨æˆ·åœ¨æŸäº›æƒ…å†µä¸‹é¿å…è‡ªåŠ¨å®‰è£…ã€‚ */ if (!Vue &amp;&amp; typeof window !== 'undefined' &amp;&amp; window.Vue) &#123; install(window.Vue) &#125; if (process.env.NODE_ENV !== 'production') &#123; assert(Vue, `must call Vue.use(Vuex) before creating a store instance.`) assert(typeof Promise !== 'undefined', `vuex requires a Promise polyfill in this browser.`) assert(this instanceof Store, `Store must be called with the new operator.`) &#125; const &#123; /*ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«åº”ç”¨åœ¨ store ä¸Šçš„æ’ä»¶æ–¹æ³•ã€‚è¿™äº›æ’ä»¶ç›´æŽ¥æŽ¥æ”¶ store ä½œä¸ºå”¯ä¸€å‚æ•°ï¼Œå¯ä»¥ç›‘å¬ mutationï¼ˆç”¨äºŽå¤–éƒ¨åœ°æ•°æ®æŒä¹…åŒ–ã€è®°å½•æˆ–è°ƒè¯•ï¼‰æˆ–è€…æäº¤ mutation ï¼ˆç”¨äºŽå†…éƒ¨æ•°æ®ï¼Œä¾‹å¦‚ websocket æˆ– æŸäº›è§‚å¯Ÿè€…ï¼‰*/ plugins = [], /*ä½¿ Vuex store è¿›å…¥ä¸¥æ ¼æ¨¡å¼ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä»»ä½• mutation å¤„ç†å‡½æ•°ä»¥å¤–ä¿®æ”¹ Vuex state éƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚*/ strict = false &#125; = options /*ä»Žoptionä¸­å–å‡ºstateï¼Œå¦‚æžœstateæ˜¯functionåˆ™æ‰§è¡Œï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå¯¹è±¡*/ let &#123; state = &#123;&#125; &#125; = options if (typeof state === 'function') &#123; state = state() &#125; // store internal state /* ç”¨æ¥åˆ¤æ–­ä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯å¦æ˜¯ç”¨mutationä¿®æ”¹stateçš„ */ this._committing = false /* å­˜æ”¾action */ this._actions = Object.create(null) /* å­˜æ”¾mutation */ this._mutations = Object.create(null) /* å­˜æ”¾getter */ this._wrappedGetters = Object.create(null) /* moduleæ”¶é›†å™¨ */ this._modules = new ModuleCollection(options) /* æ ¹æ®namespaceå­˜æ”¾module */ this._modulesNamespaceMap = Object.create(null) /* å­˜æ”¾è®¢é˜…è€… */ this._subscribers = [] /* ç”¨ä»¥å®žçŽ°Watchçš„Vueå®žä¾‹ */ this._watcherVM = new Vue() // bind commit and dispatch to self /*å°†dispatchä¸Žcommitè°ƒç”¨çš„thisç»‘å®šä¸ºstoreå¯¹è±¡æœ¬èº«ï¼Œå¦åˆ™åœ¨ç»„ä»¶å†…éƒ¨this.dispatchæ—¶çš„thisä¼šæŒ‡å‘ç»„ä»¶çš„vm*/ const store = this const &#123; dispatch, commit &#125; = this /* ä¸ºdispatchä¸Žcommitç»‘å®šthisï¼ˆStoreå®žä¾‹æœ¬èº«ï¼‰ */ this.dispatch = function boundDispatch (type, payload) &#123; return dispatch.call(store, type, payload) &#125; this.commit = function boundCommit (type, payload, options) &#123; return commit.call(store, type, payload, options) &#125; // strict mode /*ä¸¥æ ¼æ¨¡å¼(ä½¿ Vuex store è¿›å…¥ä¸¥æ ¼æ¨¡å¼ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä»»ä½• mutation å¤„ç†å‡½æ•°ä»¥å¤–ä¿®æ”¹ Vuex state éƒ½ä¼šæŠ›å‡ºé”™è¯¯)*/ this.strict = strict // init root module. // this also recursively registers all sub-modules // and collects all module getters inside this._wrappedGetters /*åˆå§‹åŒ–æ ¹moduleï¼Œè¿™ä¹ŸåŒæ—¶é€’å½’æ³¨å†Œäº†æ‰€æœ‰å­modleï¼Œæ”¶é›†æ‰€æœ‰moduleçš„getteråˆ°_wrappedGettersä¸­åŽ»ï¼Œthis._modules.rootä»£è¡¨æ ¹moduleæ‰ç‹¬æœ‰ä¿å­˜çš„Moduleå¯¹è±¡*/ installModule(this, state, [], this._modules.root) // initialize the store vm, which is responsible for the reactivity // (also registers _wrappedGetters as computed properties) /* é€šè¿‡vmé‡è®¾storeï¼Œæ–°å»ºVueå¯¹è±¡ä½¿ç”¨Vueå†…éƒ¨çš„å“åº”å¼å®žçŽ°æ³¨å†Œstateä»¥åŠcomputed */ resetStoreVM(this, state) // apply plugins /* è°ƒç”¨æ’ä»¶ */ plugins.forEach(plugin =&gt; plugin(this)) /* devtoolæ’ä»¶ */ if (Vue.config.devtools) &#123; devtoolPlugin(this) &#125; &#125; Storeçš„æž„é€ ç±»é™¤äº†åˆå§‹åŒ–ä¸€äº›å†…éƒ¨å˜é‡ä»¥å¤–ï¼Œä¸»è¦æ‰§è¡Œäº†installModuleï¼ˆåˆå§‹åŒ–moduleï¼‰ä»¥åŠresetStoreVMï¼ˆé€šè¿‡VMä½¿storeâ€œå“åº”å¼â€ï¼‰ã€‚ installModuleinstallModuleçš„ä½œç”¨ä¸»è¦æ˜¯ç”¨ä¸ºmoduleåŠ ä¸Šnamespaceåå­—ç©ºé—´ï¼ˆå¦‚æžœæœ‰ï¼‰åŽï¼Œæ³¨å†Œmutationã€actionä»¥åŠgetterï¼ŒåŒæ—¶é€’å½’å®‰è£…æ‰€æœ‰å­moduleã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/*åˆå§‹åŒ–module*/function installModule (store, rootState, path, module, hot) &#123; /* æ˜¯å¦æ˜¯æ ¹module */ const isRoot = !path.length /* èŽ·å–moduleçš„namespace */ const namespace = store._modules.getNamespace(path) // register in namespace map /* å¦‚æžœæœ‰namespaceåˆ™åœ¨_modulesNamespaceMapä¸­æ³¨å†Œ */ if (module.namespaced) &#123; store._modulesNamespaceMap[namespace] = module &#125; // set state if (!isRoot &amp;&amp; !hot) &#123; /* èŽ·å–çˆ¶çº§çš„state */ const parentState = getNestedState(rootState, path.slice(0, -1)) /* moduleçš„name */ const moduleName = path[path.length - 1] store.`_withCommit`(() =&gt; &#123; /* å°†å­moduleè®¾ç½®ç§°å“åº”å¼çš„ */ Vue.set(parentState, moduleName, module.state) &#125;) &#125; const local = module.context = makeLocalContext(store, namespace, path) /* éåŽ†æ³¨å†Œmutation */ module.forEachMutation((mutation, key) =&gt; &#123; const namespacedType = namespace + key registerMutation(store, namespacedType, mutation, local) &#125;) /* éåŽ†æ³¨å†Œaction */ module.forEachAction((action, key) =&gt; &#123; const namespacedType = namespace + key registerAction(store, namespacedType, action, local) &#125;) /* éåŽ†æ³¨å†Œgetter */ module.forEachGetter((getter, key) =&gt; &#123; const namespacedType = namespace + key registerGetter(store, namespacedType, getter, local) &#125;) /* é€’å½’å®‰è£…mudule */ module.forEachChild((child, key) =&gt; &#123; installModule(store, rootState, path.concat(key), child, hot) &#125;)&#125; resetStoreVMåœ¨è¯´resetStoreVMä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªå°demoã€‚ 12345678910111213141516171819202122let globalData = &#123; d: 'hello world'&#125;;new Vue(&#123; data () &#123; return &#123; $$state: &#123; globalData &#125; &#125; &#125;&#125;);/* modify */setTimeout(() =&gt; &#123; globalData.d = 'hi~';&#125;, 1000);Vue.prototype.globalData = globalData;/* ä»»æ„æ¨¡æ¿ä¸­ */&lt;div&gt;&#123;&#123;globalData.d&#125;&#125;&lt;/div&gt; ä¸Šè¿°ä»£ç åœ¨å…¨å±€æœ‰ä¸€ä¸ªglobalDataï¼Œå®ƒè¢«ä¼ å…¥ä¸€ä¸ªVueå¯¹è±¡çš„dataä¸­ï¼Œä¹‹åŽåœ¨ä»»æ„Vueæ¨¡æ¿ä¸­å¯¹è¯¥å˜é‡è¿›è¡Œå±•ç¤ºï¼Œå› ä¸ºæ­¤æ—¶globalDataå·²ç»åœ¨Vueçš„prototypeä¸Šäº†æ‰€ä»¥ç›´æŽ¥é€šè¿‡this.prototypeè®¿é—®ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¨¡æ¿ä¸­çš„ã€‚æ­¤æ—¶ï¼ŒsetTimeoutåœ¨1sä¹‹åŽå°†globalData.dè¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬å‘çŽ°æ¨¡æ¿ä¸­çš„globalData.då‘ç”Ÿäº†å˜åŒ–ã€‚å…¶å®žä¸Šè¿°éƒ¨åˆ†å°±æ˜¯Vuexä¾èµ–Vueæ ¸å¿ƒå®žçŽ°æ•°æ®çš„â€œå“åº”å¼åŒ–â€ã€‚ æŽ¥ç€æ¥çœ‹ä»£ç ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/* é€šè¿‡vmé‡è®¾storeï¼Œæ–°å»ºVueå¯¹è±¡ä½¿ç”¨Vueå†…éƒ¨çš„å“åº”å¼å®žçŽ°æ³¨å†Œstateä»¥åŠcomputed */function resetStoreVM (store, state, hot) &#123; /* å­˜æ”¾ä¹‹å‰çš„vmå¯¹è±¡ */ const oldVm = store._vm // bind store public getters store.getters = &#123;&#125; const wrappedGetters = store._wrappedGetters const computed = &#123;&#125; /* é€šè¿‡Object.definePropertyä¸ºæ¯ä¸€ä¸ªgetteræ–¹æ³•è®¾ç½®getæ–¹æ³•ï¼Œæ¯”å¦‚èŽ·å–this.$store.getters.testçš„æ—¶å€™èŽ·å–çš„æ˜¯store._vm.testï¼Œä¹Ÿå°±æ˜¯Vueå¯¹è±¡çš„computedå±žæ€§ */ forEachValue(wrappedGetters, (fn, key) =&gt; &#123; // use computed to leverage its lazy-caching mechanism computed[key] = () =&gt; fn(store) Object.defineProperty(store.getters, key, &#123; get: () =&gt; store._vm[key], enumerable: true // for local getters &#125;) &#125;) // use a Vue instance to store the state tree // suppress warnings just in case the user has added // some funky global mixins const silent = Vue.config.silent /* Vue.config.silentæš‚æ—¶è®¾ç½®ä¸ºtrueçš„ç›®çš„æ˜¯åœ¨newä¸€ä¸ªVueå®žä¾‹çš„è¿‡ç¨‹ä¸­ä¸ä¼šæŠ¥å‡ºä¸€åˆ‡è­¦å‘Š */ Vue.config.silent = true /* è¿™é‡Œnewäº†ä¸€ä¸ªVueå¯¹è±¡ï¼Œè¿ç”¨Vueå†…éƒ¨çš„å“åº”å¼å®žçŽ°æ³¨å†Œstateä»¥åŠcomputed*/ store._vm = new Vue(&#123; data: &#123; $$state: state &#125;, computed &#125;) Vue.config.silent = silent // enable strict mode for new vm /* ä½¿èƒ½ä¸¥æ ¼æ¨¡å¼ï¼Œä¿è¯ä¿®æ”¹storeåªèƒ½é€šè¿‡mutation */ if (store.strict) &#123; enableStrictMode(store) &#125; if (oldVm) &#123; /* è§£é™¤æ—§vmçš„stateçš„å¼•ç”¨ï¼Œä»¥åŠé”€æ¯æ—§çš„Vueå¯¹è±¡ */ if (hot) &#123; // dispatch changes in all subscribed watchers // to force getter re-evaluation for hot reloading. store._withCommit(() =&gt; &#123; oldVm._data.$$state = null &#125;) &#125; Vue.nextTick(() =&gt; oldVm.$destroy()) &#125;&#125; resetStoreVMé¦–å…ˆä¼šéåŽ†wrappedGettersï¼Œä½¿ç”¨Object.definePropertyæ–¹æ³•ä¸ºæ¯ä¸€ä¸ªgetterç»‘å®šä¸Šgetæ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç»„ä»¶é‡Œè®¿é—®this.$store.getter.testå°±ç­‰åŒäºŽè®¿é—®store._vm.testã€‚ 12345678forEachValue(wrappedGetters, (fn, key) =&gt; &#123; // use computed to leverage its lazy-caching mechanism computed[key] = () =&gt; fn(store) Object.defineProperty(store.getters, key, &#123; get: () =&gt; store._vm[key], enumerable: true // for local getters &#125;)&#125;) ä¹‹åŽVuexé‡‡ç”¨äº†newä¸€ä¸ªVueå¯¹è±¡æ¥å®žçŽ°æ•°æ®çš„â€œå“åº”å¼åŒ–â€ï¼Œè¿ç”¨Vue.jså†…éƒ¨æä¾›çš„æ•°æ®åŒå‘ç»‘å®šåŠŸèƒ½æ¥å®žçŽ°storeçš„æ•°æ®ä¸Žè§†å›¾çš„åŒæ­¥æ›´æ–°ã€‚ 123456store._vm = new Vue(&#123; data: &#123; $$state: state &#125;, computed&#125;) è¿™æ—¶å€™æˆ‘ä»¬è®¿é—®store._vm.testä¹Ÿå°±è®¿é—®äº†Vueå®žä¾‹ä¸­çš„å±žæ€§ã€‚ è¿™ä¸¤æ­¥æ‰§è¡Œå®Œä»¥åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡this.$store.getter.testè®¿é—®vmä¸­çš„testå±žæ€§äº†ã€‚ ä¸¥æ ¼æ¨¡å¼Vuexçš„Storeæž„é€ ç±»çš„optionæœ‰ä¸€ä¸ªstrictçš„å‚æ•°ï¼Œå¯ä»¥æŽ§åˆ¶Vuexæ‰§è¡Œä¸¥æ ¼æ¨¡å¼ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä¿®æ”¹stateçš„æ“ä½œå¿…é¡»é€šè¿‡mutationå®žçŽ°ï¼Œå¦åˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚ 123456789/* ä½¿èƒ½ä¸¥æ ¼æ¨¡å¼ */function enableStrictMode (store) &#123; store._vm.$watch(function () &#123; return this._data.$$state &#125;, () =&gt; &#123; if (process.env.NODE_ENV !== 'production') &#123; /* æ£€æµ‹storeä¸­çš„_committingçš„å€¼ï¼Œå¦‚æžœæ˜¯trueä»£è¡¨ä¸æ˜¯é€šè¿‡mutationçš„æ–¹æ³•ä¿®æ”¹çš„ */ assert(store._committing, `Do not mutate vuex store state outside mutation handlers.`) &#125; &#125;, &#123; deep: true, sync: true &#125;)&#125; é¦–å…ˆï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒVuexä¼šåˆ©ç”¨vmçš„$watchæ–¹æ³•æ¥è§‚å¯Ÿ$$stateï¼Œä¹Ÿå°±æ˜¯Storeçš„stateï¼Œåœ¨å®ƒè¢«ä¿®æ”¹çš„æ—¶å€™è¿›å…¥å›žè°ƒã€‚æˆ‘ä»¬å‘çŽ°ï¼Œå›žè°ƒä¸­åªæœ‰ä¸€å¥è¯ï¼Œç”¨assertæ–­è¨€æ¥æ£€æµ‹store._committingï¼Œå½“store._committingä¸ºfalseçš„æ—¶å€™ä¼šè§¦å‘æ–­è¨€ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚ æˆ‘ä»¬å‘çŽ°ï¼ŒStoreçš„commitæ–¹æ³•ä¸­ï¼Œæ‰§è¡Œmutationçš„è¯­å¥æ˜¯è¿™æ ·çš„ã€‚ 12345this._withCommit(() =&gt; &#123; entry.forEach(function commitIterator (handler) &#123; handler(payload) &#125;)&#125;) å†æ¥çœ‹çœ‹_withCommitçš„å®žçŽ°ã€‚ 1234567_withCommit (fn) &#123; /* è°ƒç”¨withCommitä¿®æ”¹stateçš„å€¼æ—¶ä¼šå°†storeçš„committingå€¼ç½®ä¸ºtrueï¼Œå†…éƒ¨ä¼šæœ‰æ–­è¨€æ£€æŸ¥è¯¥å€¼ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹åªå…è®¸ä½¿ç”¨mutationæ¥ä¿®æ”¹storeä¸­çš„å€¼ï¼Œè€Œä¸å…è®¸ç›´æŽ¥ä¿®æ”¹storeçš„æ•°å€¼ */ const committing = this._committing this._committing = true fn() this._committing = committing&#125; æˆ‘ä»¬å‘çŽ°ï¼Œé€šè¿‡commitï¼ˆmutationï¼‰ä¿®æ”¹stateæ•°æ®çš„æ—¶å€™ï¼Œä¼šå†è°ƒç”¨mutationæ–¹æ³•ä¹‹å‰å°†committingç½®ä¸ºtrueï¼ŒæŽ¥ä¸‹æ¥å†é€šè¿‡mutationå‡½æ•°ä¿®æ”¹stateä¸­çš„æ•°æ®ï¼Œè¿™æ—¶å€™è§¦å‘$watchä¸­çš„å›žè°ƒæ–­è¨€committingæ˜¯ä¸ä¼šæŠ›å‡ºå¼‚å¸¸çš„ï¼ˆæ­¤æ—¶committingä¸ºtrueï¼‰ã€‚è€Œå½“æˆ‘ä»¬ç›´æŽ¥ä¿®æ”¹stateçš„æ•°æ®æ—¶ï¼Œè§¦å‘$watchçš„å›žè°ƒæ‰§è¡Œæ–­è¨€ï¼Œè¿™æ—¶committingä¸ºfalseï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è¿™å°±æ˜¯Vuexçš„ä¸¥æ ¼æ¨¡å¼çš„å®žçŽ°ã€‚ æŽ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹Storeæä¾›çš„ä¸€äº›APIã€‚ commitï¼ˆmutationï¼‰1234567891011121314151617181920212223242526272829303132333435363738/* è°ƒç”¨mutationçš„commitæ–¹æ³• */commit (_type, _payload, _options) &#123; // check object-style commit /* æ ¡éªŒå‚æ•° */ const &#123; type, payload, options &#125; = unifyObjectStyle(_type, _payload, _options) const mutation = &#123; type, payload &#125; /* å–å‡ºtypeå¯¹åº”çš„mutationçš„æ–¹æ³• */ const entry = this._mutations[type] if (!entry) &#123; if (process.env.NODE_ENV !== 'production') &#123; console.error(`[vuex] unknown mutation type: $&#123;type&#125;`) &#125; return &#125; /* æ‰§è¡Œmutationä¸­çš„æ‰€æœ‰æ–¹æ³• */ this._withCommit(() =&gt; &#123; entry.forEach(function commitIterator (handler) &#123; handler(payload) &#125;) &#125;) /* é€šçŸ¥æ‰€æœ‰è®¢é˜…è€… */ this._subscribers.forEach(sub =&gt; sub(mutation, this.state)) if ( process.env.NODE_ENV !== 'production' &amp;&amp; options &amp;&amp; options.silent ) &#123; console.warn( `[vuex] mutation type: $&#123;type&#125;. Silent option has been removed. ` + 'Use the filter functionality in the vue-devtools' ) &#125;&#125; commitæ–¹æ³•ä¼šæ ¹æ®typeæ‰¾åˆ°å¹¶è°ƒç”¨_mutationsä¸­çš„æ‰€æœ‰typeå¯¹åº”çš„mutationæ–¹æ³•ï¼Œæ‰€ä»¥å½“æ²¡æœ‰namespaceçš„æ—¶å€™ï¼Œcommitæ–¹æ³•ä¼šè§¦å‘æ‰€æœ‰moduleä¸­çš„mutationæ–¹æ³•ã€‚å†æ‰§è¡Œå®Œæ‰€æœ‰çš„mutationä¹‹åŽä¼šæ‰§è¡Œ_subscribersä¸­çš„æ‰€æœ‰è®¢é˜…è€…ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹_subscribersæ˜¯ä»€ä¹ˆã€‚ Storeç»™å¤–éƒ¨æä¾›äº†ä¸€ä¸ªsubscribeæ–¹æ³•ï¼Œç”¨ä»¥æ³¨å†Œä¸€ä¸ªè®¢é˜…å‡½æ•°ï¼Œä¼špushåˆ°Storeå®žä¾‹çš„_subscribersä¸­ï¼ŒåŒæ—¶è¿”å›žä¸€ä¸ªä»Ž_subscribersä¸­æ³¨é”€è¯¥è®¢é˜…è€…çš„æ–¹æ³•ã€‚ 12345678910111213/* æ³¨å†Œä¸€ä¸ªè®¢é˜…å‡½æ•°ï¼Œè¿”å›žå–æ¶ˆè®¢é˜…çš„å‡½æ•° */subscribe (fn) &#123; const subs = this._subscribers if (subs.indexOf(fn) &lt; 0) &#123; subs.push(fn) &#125; return () =&gt; &#123; const i = subs.indexOf(fn) if (i &gt; -1) &#123; subs.splice(i, 1) &#125; &#125;&#125; åœ¨commitç»“æŸä»¥åŽåˆ™ä¼šè°ƒç”¨è¿™äº›_subscribersä¸­çš„è®¢é˜…è€…ï¼Œè¿™ä¸ªè®¢é˜…è€…æ¨¡å¼æä¾›ç»™å¤–éƒ¨ä¸€ä¸ªç›‘è§†stateå˜åŒ–çš„å¯èƒ½ã€‚stateé€šè¿‡mutationæ”¹å˜æ—¶ï¼Œå¯ä»¥æœ‰æ•ˆè¡¥èŽ·è¿™äº›å˜åŒ–ã€‚ dispatchï¼ˆactionï¼‰æ¥çœ‹ä¸€ä¸‹dispatchçš„å®žçŽ°ã€‚ 12345678910111213141516171819202122/* è°ƒç”¨actionçš„dispatchæ–¹æ³• */dispatch (_type, _payload) &#123; // check object-style dispatch const &#123; type, payload &#125; = unifyObjectStyle(_type, _payload) /* actionsä¸­å–å‡ºtypeå¯¹åº”çš„ation */ const entry = this._actions[type] if (!entry) &#123; if (process.env.NODE_ENV !== 'production') &#123; console.error(`[vuex] unknown action type: $&#123;type&#125;`) &#125; return &#125; /* æ˜¯æ•°ç»„åˆ™åŒ…è£…Promiseå½¢æˆä¸€ä¸ªæ–°çš„Promiseï¼Œåªæœ‰ä¸€ä¸ªåˆ™ç›´æŽ¥è¿”å›žç¬¬0ä¸ª */ return entry.length &gt; 1 ? Promise.all(entry.map(handler =&gt; handler(payload))) : entry[0](payload)&#125; ä»¥åŠregisterActionæ—¶å€™åšçš„äº‹æƒ…ã€‚ 1234567891011121314151617181920212223242526272829/* éåŽ†æ³¨å†Œaction */function registerAction (store, type, handler, local) &#123; /* å–å‡ºtypeå¯¹åº”çš„action */ const entry = store._actions[type] || (store._actions[type] = []) entry.push(function wrappedActionHandler (payload, cb) &#123; let res = handler.call(store, &#123; dispatch: local.dispatch, commit: local.commit, getters: local.getters, state: local.state, rootGetters: store.getters, rootState: store.state &#125;, payload, cb) /* åˆ¤æ–­æ˜¯å¦æ˜¯Promise */ if (!isPromise(res)) &#123; /* ä¸æ˜¯Promiseå¯¹è±¡çš„æ—¶å€™è½¬åŒ–ç§°Promiseå¯¹è±¡ */ res = Promise.resolve(res) &#125; if (store._devtoolHook) &#123; /* å­˜åœ¨devtoolæ’ä»¶çš„æ—¶å€™è§¦å‘vuexçš„errorç»™devtool */ return res.catch(err =&gt; &#123; store._devtoolHook.emit('vuex:error', err) throw err &#125;) &#125; else &#123; return res &#125; &#125;)&#125; å› ä¸ºregisterActionçš„æ—¶å€™å°†pushè¿›_actionsçš„actionè¿›è¡Œäº†ä¸€å±‚å°è£…ï¼ˆwrappedActionHandlerï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿›è¡Œdispatchçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸­èŽ·å–stateã€commitç­‰æ–¹æ³•ã€‚ä¹‹åŽï¼Œæ‰§è¡Œç»“æžœresä¼šè¢«è¿›è¡Œåˆ¤æ–­æ˜¯å¦æ˜¯Promiseï¼Œä¸æ˜¯åˆ™ä¼šè¿›è¡Œä¸€å±‚å°è£…ï¼Œå°†å…¶è½¬åŒ–æˆPromiseå¯¹è±¡ã€‚dispatchæ—¶åˆ™ä»Ž_actionsä¸­å–å‡ºï¼Œåªæœ‰ä¸€ä¸ªçš„æ—¶å€™ç›´æŽ¥è¿”å›žï¼Œå¦åˆ™ç”¨Promise.allå¤„ç†å†è¿”å›žã€‚ watch1234567/* è§‚å¯Ÿä¸€ä¸ªgetteræ–¹æ³• */watch (getter, cb, options) &#123; if (process.env.NODE_ENV !== 'production') &#123; assert(typeof getter === 'function', `store.watch only accepts a function.`) &#125; return this._watcherVM.$watch(() =&gt; getter(this.state, this.getters), cb, options)&#125; ç†Ÿæ‚‰Vueçš„æœ‹å‹åº”è¯¥å¾ˆç†Ÿæ‚‰watchè¿™ä¸ªæ–¹æ³•ã€‚è¿™é‡Œé‡‡ç”¨äº†æ¯”è¾ƒå·§å¦™çš„è®¾è®¡ï¼Œ_watcherVMæ˜¯ä¸€ä¸ªVueçš„å®žä¾‹ï¼Œæ‰€ä»¥watchå°±å¯ä»¥ç›´æŽ¥é‡‡ç”¨äº†Vueå†…éƒ¨çš„watchç‰¹æ€§æä¾›äº†ä¸€ç§è§‚å¯Ÿæ•°æ®getterå˜åŠ¨çš„æ–¹æ³•ã€‚ registerModule123456789101112131415161718/* æ³¨å†Œä¸€ä¸ªåŠ¨æ€moduleï¼Œå½“ä¸šåŠ¡è¿›è¡Œå¼‚æ­¥åŠ è½½çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¯¥æŽ¥å£è¿›è¡Œæ³¨å†ŒåŠ¨æ€module */registerModule (path, rawModule) &#123; /* è½¬åŒ–ç§°Array */ if (typeof path === 'string') path = [path] if (process.env.NODE_ENV !== 'production') &#123; assert(Array.isArray(path), `module path must be a string or an Array.`) assert(path.length &gt; 0, 'cannot register the root module by using registerModule.') &#125; /*æ³¨å†Œ*/ this._modules.register(path, rawModule) /*åˆå§‹åŒ–module*/ installModule(this, this.state, path, this._modules.get(path)) // reset store to update getters... /* é€šè¿‡vmé‡è®¾storeï¼Œæ–°å»ºVueå¯¹è±¡ä½¿ç”¨Vueå†…éƒ¨çš„å“åº”å¼å®žçŽ°æ³¨å†Œstateä»¥åŠcomputed */ resetStoreVM(this, this.state)&#125; registerModuleç”¨ä»¥æ³¨å†Œä¸€ä¸ªåŠ¨æ€æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯åœ¨storeåˆ›å»ºä»¥åŽå†æ³¨å†Œæ¨¡å—çš„æ—¶å€™ç”¨è¯¥æŽ¥å£ã€‚å†…éƒ¨å®žçŽ°å®žé™…ä¸Šä¹Ÿåªæœ‰installModuleä¸ŽresetStoreVMä¸¤ä¸ªæ­¥éª¤ï¼Œå‰é¢å·²ç»è®²è¿‡ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ unregisterModule1234567891011121314151617181920 /* æ³¨é”€ä¸€ä¸ªåŠ¨æ€module */unregisterModule (path) &#123; /* è½¬åŒ–ç§°Array */ if (typeof path === 'string') path = [path] if (process.env.NODE_ENV !== 'production') &#123; assert(Array.isArray(path), `module path must be a string or an Array.`) &#125; /*æ³¨é”€*/ this._modules.unregister(path) this._withCommit(() =&gt; &#123; /* èŽ·å–çˆ¶çº§çš„state */ const parentState = getNestedState(this.state, path.slice(0, -1)) /* ä»Žçˆ¶çº§ä¸­åˆ é™¤ */ Vue.delete(parentState, path[path.length - 1]) &#125;) /* é‡åˆ¶store */ resetStore(this)&#125; åŒæ ·ï¼Œä¸ŽregisterModuleå¯¹åº”çš„æ–¹æ³•unregisterModuleï¼ŒåŠ¨æ€æ³¨é”€æ¨¡å—ã€‚å®žçŽ°æ–¹æ³•æ˜¯å…ˆä»Žstateä¸­åˆ é™¤æ¨¡å—ï¼Œç„¶åŽç”¨resetStoreæ¥é‡åˆ¶storeã€‚ resetStore123456789101112/* é‡åˆ¶store */function resetStore (store, hot) &#123; store._actions = Object.create(null) store._mutations = Object.create(null) store._wrappedGetters = Object.create(null) store._modulesNamespaceMap = Object.create(null) const state = store.state // init all modules installModule(store, state, [], store._modules.root, true) // reset vm resetStoreVM(store, state, hot)&#125; è¿™é‡Œçš„resetStoreå…¶å®žä¹Ÿå°±æ˜¯å°†storeä¸­çš„_actionsç­‰è¿›è¡Œåˆå§‹åŒ–ä»¥åŽï¼Œé‡æ–°æ‰§è¡ŒinstallModuleä¸ŽresetStoreVMæ¥åˆå§‹åŒ–moduleä»¥åŠç”¨Vueç‰¹æ€§ä½¿å…¶â€œå“åº”å¼åŒ–â€ï¼Œè¿™è·Ÿæž„é€ å‡½æ•°ä¸­çš„æ˜¯ä¸€è‡´çš„ã€‚ æ’ä»¶Vueæä¾›äº†ä¸€ä¸ªéžå¸¸å¥½ç”¨çš„æ’ä»¶Vue.js devtools 12345678910111213141516171819202122232425/* ä»Žwindowå¯¹è±¡çš„__VUE_DEVTOOLS_GLOBAL_HOOK__ä¸­èŽ·å–devtoolæ’ä»¶ */const devtoolHook = typeof window !== 'undefined' &amp;&amp; window.__VUE_DEVTOOLS_GLOBAL_HOOK__export default function devtoolPlugin (store) &#123; if (!devtoolHook) return /* devtollæ’ä»¶å®žä¾‹å­˜å‚¨åœ¨storeçš„_devtoolHookä¸Š */ store._devtoolHook = devtoolHook /* å‡ºå‘vuexçš„åˆå§‹åŒ–äº‹ä»¶ï¼Œå¹¶å°†storeçš„å¼•ç”¨åœ°å€ä¼ ç»™deltoolæ’ä»¶ï¼Œä½¿æ’ä»¶èŽ·å–storeçš„å®žä¾‹ */ devtoolHook.emit('vuex:init', store) /* ç›‘å¬travel-to-stateäº‹ä»¶ */ devtoolHook.on('vuex:travel-to-state', targetState =&gt; &#123; /* é‡åˆ¶state */ store.replaceState(targetState) &#125;) /* è®¢é˜…storeçš„å˜åŒ– */ store.subscribe((mutation, state) =&gt; &#123; devtoolHook.emit('vuex:mutation', mutation, state) &#125;)&#125; å¦‚æžœå·²ç»å®‰è£…äº†è¯¥æ’ä»¶ï¼Œåˆ™ä¼šåœ¨windowså¯¹è±¡ä¸Šæš´éœ²ä¸€ä¸ªVUE_DEVTOOLS_GLOBAL_HOOKã€‚devtoolHookç”¨åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šè§¦å‘â€œvuex:initâ€äº‹ä»¶é€šçŸ¥æ’ä»¶ï¼Œç„¶åŽé€šè¿‡onæ–¹æ³•ç›‘å¬â€œvuex:travel-to-stateâ€äº‹ä»¶æ¥é‡ç½®stateã€‚æœ€åŽé€šè¿‡Storeçš„subscribeæ–¹æ³•æ¥æ·»åŠ ä¸€ä¸ªè®¢é˜…è€…ï¼Œåœ¨è§¦å‘commitæ–¹æ³•ä¿®æ”¹mutationæ•°æ®ä»¥åŽï¼Œè¯¥è®¢é˜…è€…ä¼šè¢«é€šçŸ¥ï¼Œä»Žè€Œè§¦å‘â€œvuex:mutationâ€äº‹ä»¶ã€‚ æœ€åŽVuexæ˜¯ä¸€ä¸ªéžå¸¸ä¼˜ç§€çš„åº“ï¼Œä»£ç é‡ä¸å¤šä¸”ç»“æž„æ¸…æ™°ï¼Œéžå¸¸é€‚åˆç ”ç©¶å­¦ä¹ å…¶å†…éƒ¨å®žçŽ°ã€‚æœ€è¿‘çš„ä¸€ç³»åˆ—æºç é˜…è¯»ä¹Ÿä½¿æˆ‘è‡ªå·±å—ç›ŠåŒªæµ…ï¼Œå†™è¿™ç¯‡æ–‡ç« ä¹Ÿå¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°æ›´å¤šæƒ³è¦å­¦ä¹ æŽ¢ç´¢Vuexå†…éƒ¨å®žçŽ°åŽŸç†çš„åŒå­¦ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vuex</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vue.jså¼‚æ­¥æ›´æ–°DOMç­–ç•¥åŠnextTick]]></title>
    <url>%2F2019%2F01%2F01%2FVue%2FVue-js%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0DOM%E7%AD%96%E7%95%A5%E5%8F%8AnextTick%2F</url>
    <content type="text"><![CDATA[æ“ä½œDOMåœ¨ä½¿ç”¨vue.jsçš„æ—¶å€™ï¼Œæœ‰æ—¶å€™å› ä¸ºä¸€äº›ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯ï¼Œä¸å¾—ä¸åŽ»æ“ä½œDOMï¼Œæ¯”å¦‚è¿™æ ·ï¼š 123456&lt;template&gt; &lt;div&gt; &lt;div ref="test"&gt;&#123;&#123;test&#125;&#125;&lt;/div&gt; &lt;button @click="handleClick"&gt;tet&lt;/button&gt; &lt;/div&gt;&lt;/template&gt; 12345678910111213export default &#123; data () &#123; return &#123; test: 'begin' &#125;; &#125;, methods () &#123; handleClick () &#123; this.test = 'end'; console.log(this.$refs.test.innerText);//æ‰“å°â€œbeginâ€ &#125; &#125;&#125; æ‰“å°çš„ç»“æžœæ˜¯beginï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬æ˜Žæ˜Žå·²ç»å°†testè®¾ç½®æˆäº†â€œendâ€ï¼ŒèŽ·å–çœŸå®žDOMèŠ‚ç‚¹çš„innerTextå´æ²¡æœ‰å¾—åˆ°æˆ‘ä»¬é¢„æœŸä¸­çš„â€œendâ€ï¼Œè€Œæ˜¯å¾—åˆ°ä¹‹å‰çš„å€¼â€œbeginâ€å‘¢ï¼Ÿ Watcheré˜Ÿåˆ—å¸¦ç€ç–‘é—®ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†Vue.jsæºç çš„Watchå®žçŽ°ã€‚å½“æŸä¸ªå“åº”å¼æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå®ƒçš„setterå‡½æ•°ä¼šé€šçŸ¥é—­åŒ…ä¸­çš„Depï¼ŒDepåˆ™ä¼šè°ƒç”¨å®ƒç®¡ç†çš„æ‰€æœ‰Watchå¯¹è±¡ã€‚è§¦å‘Watchå¯¹è±¡çš„updateå®žçŽ°ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹updateçš„å®žçŽ°ã€‚ 123456789101112update () &#123; /* istanbul ignore else */ if (this.lazy) &#123; this.dirty = true &#125; else if (this.sync) &#123; /*åŒæ­¥åˆ™æ‰§è¡Œrunç›´æŽ¥æ¸²æŸ“è§†å›¾*/ this.run() &#125; else &#123; /*å¼‚æ­¥æŽ¨é€åˆ°è§‚å¯Ÿè€…é˜Ÿåˆ—ä¸­ï¼Œä¸‹ä¸€ä¸ªtickæ—¶è°ƒç”¨ã€‚*/ queueWatcher(this) &#125;&#125; æˆ‘ä»¬å‘çŽ°Vue.jsé»˜è®¤æ˜¯ä½¿ç”¨å¼‚æ­¥æ‰§è¡ŒDOMæ›´æ–°ã€‚ å½“å¼‚æ­¥æ‰§è¡Œupdateçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨queueWatcherå‡½æ•°ã€‚ 1234567891011121314151617181920212223242526//å°†ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡pushè¿›è§‚å¯Ÿè€…é˜Ÿåˆ—ï¼Œåœ¨é˜Ÿåˆ—ä¸­å·²ç»å­˜åœ¨ç›¸åŒçš„idåˆ™è¯¥è§‚å¯Ÿè€…å¯¹è±¡å°†è¢«è·³è¿‡ï¼Œé™¤éžå®ƒæ˜¯åœ¨é˜Ÿåˆ—è¢«åˆ·æ–°æ—¶æŽ¨é€*/export function queueWatcher (watcher: Watcher) &#123; /*èŽ·å–watcherçš„id*/ const id = watcher.id /*æ£€éªŒidæ˜¯å¦å­˜åœ¨ï¼Œå·²ç»å­˜åœ¨åˆ™ç›´æŽ¥è·³è¿‡ï¼Œä¸å­˜åœ¨åˆ™æ ‡è®°å“ˆå¸Œè¡¨hasï¼Œç”¨äºŽä¸‹æ¬¡æ£€éªŒ*/ if (has[id] == null) &#123; has[id] = true if (!flushing) &#123; /*å¦‚æžœæ²¡æœ‰flushæŽ‰ï¼Œç›´æŽ¥pushåˆ°é˜Ÿåˆ—ä¸­å³å¯*/ queue.push(watcher) &#125; else &#123; // if already flushing, splice the watcher based on its id // if already past its id, it will be run next immediately. let i = queue.length - 1 while (i &gt;= 0 &amp;&amp; queue[i].id &gt; watcher.id) &#123; i-- &#125; queue.splice(Math.max(i, index) + 1, 0, watcher) &#125; // queue the flush if (!waiting) &#123; waiting = true nextTick(flushSchedulerQueue) &#125; &#125;&#125; æŸ¥çœ‹queueWatcherçš„æºç æˆ‘ä»¬å‘çŽ°ï¼ŒWatchå¯¹è±¡å¹¶ä¸æ˜¯ç«‹å³æ›´æ–°è§†å›¾ï¼Œè€Œæ˜¯è¢«pushè¿›äº†ä¸€ä¸ªé˜Ÿåˆ—queueï¼Œæ­¤æ—¶çŠ¶æ€å¤„äºŽwaitingçš„çŠ¶æ€ï¼Œè¿™æ—¶å€™ä¼šç»§ç»­ä¼šæœ‰Watchå¯¹è±¡è¢«pushè¿›è¿™ä¸ªé˜Ÿåˆ—queueï¼Œç­‰åˆ°ä¸‹ä¸€ä¸ªtickè¿è¡Œæ—¶ï¼Œè¿™äº›Watchå¯¹è±¡æ‰ä¼šè¢«éåŽ†å–å‡ºï¼Œæ›´æ–°è§†å›¾ã€‚åŒæ—¶ï¼Œidé‡å¤çš„Watcherä¸ä¼šè¢«å¤šæ¬¡åŠ å…¥åˆ°queueä¸­åŽ»ï¼Œå› ä¸ºåœ¨æœ€ç»ˆæ¸²æŸ“æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å…³å¿ƒæ•°æ®çš„æœ€ç»ˆç»“æžœã€‚ é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯ä¸‹ä¸€ä¸ªtickï¼Ÿ nextTickvue.jsæä¾›äº†ä¸€ä¸ªnextTickå‡½æ•°ï¼Œå…¶å®žä¹Ÿå°±æ˜¯ä¸Šé¢è°ƒç”¨çš„nextTickã€‚ nextTickçš„å®žçŽ°æ¯”è¾ƒç®€å•ï¼Œæ‰§è¡Œçš„ç›®çš„æ˜¯åœ¨microtaskæˆ–è€…taskä¸­æŽ¨å…¥ä¸€ä¸ªfuntionï¼Œåœ¨å½“å‰æ ˆæ‰§è¡Œå®Œæ¯•ï¼ˆä¹Ÿè¡Œè¿˜ä¼šæœ‰ä¸€äº›æŽ’åœ¨å‰é¢çš„éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼‰ä»¥åŽæ‰§è¡ŒnextTickä¼ å…¥çš„funtionï¼Œçœ‹ä¸€ä¸‹æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112/** * Defer a task to execute it asynchronously. */ /* å»¶è¿Ÿä¸€ä¸ªä»»åŠ¡ä½¿å…¶å¼‚æ­¥æ‰§è¡Œï¼Œåœ¨ä¸‹ä¸€ä¸ªtickæ—¶æ‰§è¡Œï¼Œä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè¿”å›žä¸€ä¸ªfunction è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯åœ¨taskæˆ–è€…microtaskä¸­æŽ¨å…¥ä¸€ä¸ªtimerFuncï¼Œåœ¨å½“å‰è°ƒç”¨æ ˆæ‰§è¡Œå®Œä»¥åŽä»¥æ­¤æ‰§è¡Œç›´åˆ°æ‰§è¡Œåˆ°timerFunc ç›®çš„æ˜¯å»¶è¿Ÿåˆ°å½“å‰è°ƒç”¨æ ˆæ‰§è¡Œå®Œä»¥åŽæ‰§è¡Œ*/export const nextTick = (function () &#123; /*å­˜æ”¾å¼‚æ­¥æ‰§è¡Œçš„å›žè°ƒ*/ const callbacks = [] /*ä¸€ä¸ªæ ‡è®°ä½ï¼Œå¦‚æžœå·²ç»æœ‰timerFuncè¢«æŽ¨é€åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­åŽ»åˆ™ä¸éœ€è¦é‡å¤æŽ¨é€*/ let pending = false /*ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘å‡½æ•°å°†è¢«æŽ¨é€åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰åˆ°ä¸»çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œæ—¶ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„timerFuncè¢«è°ƒç”¨*/ let timerFunc /*ä¸‹ä¸€ä¸ªtickæ—¶çš„å›žè°ƒ*/ function nextTickHandler () &#123; /*ä¸€ä¸ªæ ‡è®°ä½ï¼Œæ ‡è®°ç­‰å¾…çŠ¶æ€ï¼ˆå³å‡½æ•°å·²ç»è¢«æŽ¨å…¥ä»»åŠ¡é˜Ÿåˆ—æˆ–è€…ä¸»çº¿ç¨‹ï¼Œå·²ç»åœ¨ç­‰å¾…å½“å‰æ ˆæ‰§è¡Œå®Œæ¯•åŽ»æ‰§è¡Œï¼‰ï¼Œè¿™æ ·å°±ä¸éœ€è¦åœ¨pushå¤šä¸ªå›žè°ƒåˆ°callbacksæ—¶å°†timerFuncå¤šæ¬¡æŽ¨å…¥ä»»åŠ¡é˜Ÿåˆ—æˆ–è€…ä¸»çº¿ç¨‹*/ pending = false /*æ‰§è¡Œæ‰€æœ‰callback*/ const copies = callbacks.slice(0) callbacks.length = 0 for (let i = 0; i &lt; copies.length; i++) &#123; copies[i]() &#125; &#125; // the nextTick behavior leverages the microtask queue, which can be accessed // via either native Promise.then or MutationObserver. // MutationObserver has wider support, however it is seriously bugged in // UIWebView in iOS &gt;= 9.3.3 when triggered in touch event handlers. It // completely stops working after triggering a few times... so, if native // Promise is available, we will use it: /* istanbul ignore if */ /* è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼Œä¸€å…±æœ‰Promiseã€MutationObserverä»¥åŠsetTimeoutä¸‰ç§å°è¯•å¾—åˆ°timerFuncçš„æ–¹æ³• ä¼˜å…ˆä½¿ç”¨Promiseï¼Œåœ¨Promiseä¸å­˜åœ¨çš„æƒ…å†µä¸‹ä½¿ç”¨MutationObserverï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šåœ¨microtaskä¸­æ‰§è¡Œï¼Œä¼šæ¯”setTimeoutæ›´æ—©æ‰§è¡Œï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨ã€‚ å¦‚æžœä¸Šè¿°ä¸¤ç§æ–¹æ³•éƒ½ä¸æ”¯æŒçš„çŽ¯å¢ƒåˆ™ä¼šä½¿ç”¨setTimeoutï¼Œåœ¨taskå°¾éƒ¨æŽ¨å…¥è¿™ä¸ªå‡½æ•°ï¼Œç­‰å¾…è°ƒç”¨æ‰§è¡Œã€‚ å‚è€ƒï¼šhttps://www.zhihu.com/question/55364497 */ if (typeof Promise !== 'undefined' &amp;&amp; isNative(Promise)) &#123; /*ä½¿ç”¨Promise*/ var p = Promise.resolve() var logError = err =&gt; &#123; console.error(err) &#125; timerFunc = () =&gt; &#123; p.then(nextTickHandler).catch(logError) // in problematic UIWebViews, Promise.then doesn't completely break, but // it can get stuck in a weird state where callbacks are pushed into the // microtask queue but the queue isn't being flushed, until the browser // needs to do some other work, e.g. handle a timer. Therefore we can // "force" the microtask queue to be flushed by adding an empty timer. if (isIOS) setTimeout(noop) &#125; &#125; else if (typeof MutationObserver !== 'undefined' &amp;&amp; ( isNative(MutationObserver) || // PhantomJS and iOS 7.x MutationObserver.toString() === '[object MutationObserverConstructor]' )) &#123; // use MutationObserver where native Promise is not available, // e.g. PhantomJS IE11, iOS7, Android 4.4 /*æ–°å»ºä¸€ä¸ªtextNodeçš„DOMå¯¹è±¡ï¼Œç”¨MutationObserverç»‘å®šè¯¥DOMå¹¶æŒ‡å®šå›žè°ƒå‡½æ•°ï¼Œåœ¨DOMå˜åŒ–çš„æ—¶å€™åˆ™ä¼šè§¦å‘å›žè°ƒ,è¯¥å›žè°ƒä¼šè¿›å…¥ä¸»çº¿ç¨‹ï¼ˆæ¯”ä»»åŠ¡é˜Ÿåˆ—ä¼˜å…ˆæ‰§è¡Œï¼‰ï¼Œå³textNode.data = String(counter)æ—¶ä¾¿ä¼šè§¦å‘å›žè°ƒ*/ var counter = 1 var observer = new MutationObserver(nextTickHandler) var textNode = document.createTextNode(String(counter)) observer.observe(textNode, &#123; characterData: true &#125;) timerFunc = () =&gt; &#123; counter = (counter + 1) % 2 textNode.data = String(counter) &#125; &#125; else &#123; // fallback to setTimeout /* istanbul ignore next */ /*ä½¿ç”¨setTimeoutå°†å›žè°ƒæŽ¨å…¥ä»»åŠ¡é˜Ÿåˆ—å°¾éƒ¨*/ timerFunc = () =&gt; &#123; setTimeout(nextTickHandler, 0) &#125; &#125; /* æŽ¨é€åˆ°é˜Ÿåˆ—ä¸­ä¸‹ä¸€ä¸ªtickæ—¶æ‰§è¡Œ cb å›žè°ƒå‡½æ•° ctx ä¸Šä¸‹æ–‡ */ return function queueNextTick (cb?: Function, ctx?: Object) &#123; let _resolve /*cbå­˜åˆ°callbacksä¸­*/ callbacks.push(() =&gt; &#123; if (cb) &#123; try &#123; cb.call(ctx) &#125; catch (e) &#123; handleError(e, ctx, 'nextTick') &#125; &#125; else if (_resolve) &#123; _resolve(ctx) &#125; &#125;) if (!pending) &#123; pending = true timerFunc() &#125; if (!cb &amp;&amp; typeof Promise !== 'undefined') &#123; return new Promise((resolve, reject) =&gt; &#123; _resolve = resolve &#125;) &#125; &#125;&#125;)() å®ƒæ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°,è¿”å›žä¸€ä¸ªqueueNextTickæŽ¥å£ã€‚ ä¼ å…¥çš„cbä¼šè¢«pushè¿›callbacksä¸­å­˜æ”¾èµ·æ¥ï¼Œç„¶åŽæ‰§è¡ŒtimerFuncï¼ˆpendingæ˜¯ä¸€ä¸ªçŠ¶æ€æ ‡è®°ï¼Œä¿è¯timerFuncåœ¨ä¸‹ä¸€ä¸ªtickä¹‹å‰åªæ‰§è¡Œä¸€æ¬¡ï¼‰ã€‚ timerFuncæ˜¯ä»€ä¹ˆï¼Ÿ çœ‹äº†æºç å‘çŽ°timerFuncä¼šæ£€æµ‹å½“å‰çŽ¯å¢ƒè€Œä¸åŒå®žçŽ°ï¼Œå…¶å®žå°±æ˜¯æŒ‰ç…§Promiseï¼ŒMutationObserverï¼ŒsetTimeoutä¼˜å…ˆçº§ï¼Œå“ªä¸ªå­˜åœ¨ä½¿ç”¨å“ªä¸ªï¼Œæœ€ä¸æµŽçš„çŽ¯å¢ƒä¸‹ä½¿ç”¨setTimeoutã€‚ è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼Œä¸€å…±æœ‰Promiseã€MutationObserverä»¥åŠsetTimeoutä¸‰ç§å°è¯•å¾—åˆ°timerFuncçš„æ–¹æ³•ã€‚ ä¼˜å…ˆä½¿ç”¨Promiseï¼Œåœ¨Promiseä¸å­˜åœ¨çš„æƒ…å†µä¸‹ä½¿ç”¨MutationObserverï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•çš„å›žè°ƒå‡½æ•°éƒ½ä¼šåœ¨microtaskä¸­æ‰§è¡Œï¼Œå®ƒä»¬ä¼šæ¯”setTimeoutæ›´æ—©æ‰§è¡Œï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨ã€‚ å¦‚æžœä¸Šè¿°ä¸¤ç§æ–¹æ³•éƒ½ä¸æ”¯æŒçš„çŽ¯å¢ƒåˆ™ä¼šä½¿ç”¨setTimeoutï¼Œåœ¨taskå°¾éƒ¨æŽ¨å…¥è¿™ä¸ªå‡½æ•°ï¼Œç­‰å¾…è°ƒç”¨æ‰§è¡Œã€‚ ä¸ºä»€ä¹ˆè¦ä¼˜å…ˆä½¿ç”¨microtaskï¼Ÿæˆ‘åœ¨é¡¾è½¶çµåœ¨çŸ¥ä¹Žçš„å›žç­”ä¸­å­¦ä¹ åˆ°ï¼š JS çš„ event loop æ‰§è¡Œæ—¶ä¼šåŒºåˆ† task å’Œ microtaskï¼Œå¼•æ“Žåœ¨æ¯ä¸ª task æ‰§è¡Œå®Œæ¯•ï¼Œä»Žé˜Ÿåˆ—ä¸­å–ä¸‹ä¸€ä¸ª task æ¥æ‰§è¡Œä¹‹å‰ï¼Œä¼šå…ˆæ‰§è¡Œå®Œæ‰€æœ‰ microtask é˜Ÿåˆ—ä¸­çš„ microtaskã€‚setTimeout å›žè°ƒä¼šè¢«åˆ†é…åˆ°ä¸€ä¸ªæ–°çš„ task ä¸­æ‰§è¡Œï¼Œè€Œ Promise çš„ resolverã€MutationObserver çš„å›žè°ƒéƒ½ä¼šè¢«å®‰æŽ’åˆ°ä¸€ä¸ªæ–°çš„ microtask ä¸­æ‰§è¡Œï¼Œä¼šæ¯” setTimeout äº§ç”Ÿçš„ task å…ˆæ‰§è¡Œã€‚è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ microtaskï¼Œä¼˜å…ˆä½¿ç”¨ Promiseï¼Œå¦‚æžœæµè§ˆå™¨ä¸æ”¯æŒï¼Œå†å°è¯• MutationObserverã€‚å®žåœ¨ä¸è¡Œï¼Œåªèƒ½ç”¨ setTimeout åˆ›å»º task äº†ã€‚ä¸ºå•¥è¦ç”¨ microtaskï¼Ÿæ ¹æ® HTML Standardï¼Œåœ¨æ¯ä¸ª task è¿è¡Œå®Œä»¥åŽï¼ŒUI éƒ½ä¼šé‡æ¸²æŸ“ï¼Œé‚£ä¹ˆåœ¨ microtask ä¸­å°±å®Œæˆæ•°æ®æ›´æ–°ï¼Œå½“å‰ task ç»“æŸå°±å¯ä»¥å¾—åˆ°æœ€æ–°çš„ UI äº†ã€‚åä¹‹å¦‚æžœæ–°å»ºä¸€ä¸ª task æ¥åšæ•°æ®æ›´æ–°ï¼Œé‚£ä¹ˆæ¸²æŸ“å°±ä¼šè¿›è¡Œä¸¤æ¬¡ã€‚å‚è€ƒé¡¾è½¶çµçŸ¥ä¹Žçš„å›žç­”ï¼š[https://www.zhihu.com/question/55364497/answer/144215284] é¦–å…ˆæ˜¯Promiseï¼Œ(Promise.resolve()).then()å¯ä»¥åœ¨microtaskä¸­åŠ å…¥å®ƒçš„å›žè°ƒï¼Œ MutationObserveræ–°å»ºä¸€ä¸ªtextNodeçš„DOMå¯¹è±¡ï¼Œç”¨MutationObserverç»‘å®šè¯¥DOMå¹¶æŒ‡å®šå›žè°ƒå‡½æ•°ï¼Œåœ¨DOMå˜åŒ–çš„æ—¶å€™åˆ™ä¼šè§¦å‘å›žè°ƒ,è¯¥å›žè°ƒä¼šè¿›å…¥microtaskï¼Œå³textNode.data = String(counter)æ—¶ä¾¿ä¼šåŠ å…¥è¯¥å›žè°ƒã€‚ setTimeoutæ˜¯æœ€åŽçš„ä¸€ç§å¤‡é€‰æ–¹æ¡ˆï¼Œå®ƒä¼šå°†å›žè°ƒå‡½æ•°åŠ å…¥taskä¸­ï¼Œç­‰åˆ°æ‰§è¡Œã€‚ ç»¼ä¸Šï¼ŒnextTickçš„ç›®çš„å°±æ˜¯äº§ç”Ÿä¸€ä¸ªå›žè°ƒå‡½æ•°åŠ å…¥taskæˆ–è€…microtaskä¸­ï¼Œå½“å‰æ ˆæ‰§è¡Œå®Œä»¥åŽï¼ˆå¯èƒ½ä¸­é—´è¿˜æœ‰åˆ«çš„æŽ’åœ¨å‰é¢çš„å‡½æ•°ï¼‰è°ƒç”¨è¯¥å›žè°ƒå‡½æ•°ï¼Œèµ·åˆ°äº†å¼‚æ­¥è§¦å‘ï¼ˆå³ä¸‹ä¸€ä¸ªtickæ—¶è§¦å‘ï¼‰çš„ç›®çš„ã€‚ flushSchedulerQueue1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283/*Github:https://github.com/answershuto*//** * Flush both queues and run the watchers. */ /*nextTickçš„å›žè°ƒå‡½æ•°ï¼Œåœ¨ä¸‹ä¸€ä¸ªtickæ—¶flushæŽ‰ä¸¤ä¸ªé˜Ÿåˆ—åŒæ—¶è¿è¡Œwatchers*/function flushSchedulerQueue () &#123; flushing = true let watcher, id // Sort queue before flush. // This ensures that: // 1. Components are updated from parent to child. (because parent is always // created before the child) // 2. A component's user watchers are run before its render watcher (because // user watchers are created before the render watcher) // 3. If a component is destroyed during a parent component's watcher run, // its watchers can be skipped. /* ç»™queueæŽ’åºï¼Œè¿™æ ·åšå¯ä»¥ä¿è¯ï¼š 1.ç»„ä»¶æ›´æ–°çš„é¡ºåºæ˜¯ä»Žçˆ¶ç»„ä»¶åˆ°å­ç»„ä»¶çš„é¡ºåºï¼Œå› ä¸ºçˆ¶ç»„ä»¶æ€»æ˜¯æ¯”å­ç»„ä»¶å…ˆåˆ›å»ºã€‚ 2.ä¸€ä¸ªç»„ä»¶çš„user watchersæ¯”render watcherå…ˆè¿è¡Œï¼Œå› ä¸ºuser watcherså¾€å¾€æ¯”render watcheræ›´æ—©åˆ›å»º 3.å¦‚æžœä¸€ä¸ªç»„ä»¶åœ¨çˆ¶ç»„ä»¶watcherè¿è¡ŒæœŸé—´è¢«é”€æ¯ï¼Œå®ƒçš„watcheræ‰§è¡Œå°†è¢«è·³è¿‡ã€‚ */ queue.sort((a, b) =&gt; a.id - b.id) // do not cache length because more watchers might be pushed // as we run existing watchers /*è¿™é‡Œä¸ç”¨index = queue.length;index &gt; 0; index--çš„æ–¹å¼å†™æ˜¯å› ä¸ºä¸è¦å°†lengthè¿›è¡Œç¼“å­˜ï¼Œå› ä¸ºåœ¨æ‰§è¡Œå¤„ç†çŽ°æœ‰watcherå¯¹è±¡æœŸé—´ï¼Œæ›´å¤šçš„watcherå¯¹è±¡å¯èƒ½ä¼šè¢«pushè¿›queue*/ for (index = 0; index &lt; queue.length; index++) &#123; watcher = queue[index] id = watcher.id /*å°†hasçš„æ ‡è®°åˆ é™¤*/ has[id] = null /*æ‰§è¡Œwatcher*/ watcher.run() // in dev build, check and stop circular updates. /* åœ¨æµ‹è¯•çŽ¯å¢ƒä¸­ï¼Œæ£€æµ‹watchæ˜¯å¦åœ¨æ­»å¾ªçŽ¯ä¸­ æ¯”å¦‚è¿™æ ·ä¸€ç§æƒ…å†µ watch: &#123; test () &#123; this.test++; &#125; &#125; æŒç»­æ‰§è¡Œäº†ä¸€ç™¾æ¬¡watchä»£è¡¨å¯èƒ½å­˜åœ¨æ­»å¾ªçŽ¯ */ if (process.env.NODE_ENV !== 'production' &amp;&amp; has[id] != null) &#123; circular[id] = (circular[id] || 0) + 1 if (circular[id] &gt; MAX_UPDATE_COUNT) &#123; warn( 'You may have an infinite update loop ' + ( watcher.user ? `in watcher with expression "$&#123;watcher.expression&#125;"` : `in a component render function.` ), watcher.vm ) break &#125; &#125; &#125; // keep copies of post queues before resetting state /**/ /*å¾—åˆ°é˜Ÿåˆ—çš„æ‹·è´*/ const activatedQueue = activatedChildren.slice() const updatedQueue = queue.slice() /*é‡ç½®è°ƒåº¦è€…çš„çŠ¶æ€*/ resetSchedulerState() // call component updated and activated hooks /*ä½¿å­ç»„ä»¶çŠ¶æ€éƒ½æ”¹ç¼–æˆactiveåŒæ—¶è°ƒç”¨activatedé’©å­*/ callActivatedHooks(activatedQueue) /*è°ƒç”¨updatedé’©å­*/ callUpdateHooks(updatedQueue) // devtool hook /* istanbul ignore if */ if (devtools &amp;&amp; config.devtools) &#123; devtools.emit('flush') &#125;&#125; flushSchedulerQueueæ˜¯ä¸‹ä¸€ä¸ªtickæ—¶çš„å›žè°ƒå‡½æ•°ï¼Œä¸»è¦ç›®çš„æ˜¯æ‰§è¡ŒWatcherçš„runå‡½æ•°ï¼Œç”¨æ¥æ›´æ–°è§†å›¾ ä¸ºä»€ä¹ˆè¦å¼‚æ­¥æ›´æ–°è§†å›¾æ¥çœ‹ä¸€ä¸‹ä¸‹é¢è¿™ä¸€æ®µä»£ç  12345&lt;template&gt; &lt;div&gt; &lt;div&gt;&#123;&#123;test&#125;&#125;&lt;/div&gt; &lt;/div&gt;&lt;/template&gt; 123456789101112export default &#123; data () &#123; return &#123; test: 0 &#125;; &#125;, mounted () &#123; for(let i = 0; i &lt; 1000; i++) &#123; this.test++; &#125; &#125;&#125; çŽ°åœ¨æœ‰è¿™æ ·çš„ä¸€ç§æƒ…å†µï¼Œmountedçš„æ—¶å€™testçš„å€¼ä¼šè¢«++å¾ªçŽ¯æ‰§è¡Œ1000æ¬¡ã€‚ æ¯æ¬¡++æ—¶ï¼Œéƒ½ä¼šæ ¹æ®å“åº”å¼è§¦å‘setter-&gt;Dep-&gt;Watcher-&gt;update-&gt;patchã€‚ å¦‚æžœè¿™æ—¶å€™æ²¡æœ‰å¼‚æ­¥æ›´æ–°è§†å›¾ï¼Œé‚£ä¹ˆæ¯æ¬¡++éƒ½ä¼šç›´æŽ¥æ“ä½œDOMæ›´æ–°è§†å›¾ï¼Œè¿™æ˜¯éžå¸¸æ¶ˆè€—æ€§èƒ½çš„ã€‚ æ‰€ä»¥Vue.jså®žçŽ°äº†ä¸€ä¸ªqueueé˜Ÿåˆ—ï¼Œåœ¨ä¸‹ä¸€ä¸ªtickçš„æ—¶å€™ä¼šç»Ÿä¸€æ‰§è¡Œqueueä¸­Watcherçš„runã€‚åŒæ—¶ï¼Œæ‹¥æœ‰ç›¸åŒidçš„Watcherä¸ä¼šè¢«é‡å¤åŠ å…¥åˆ°è¯¥queueä¸­åŽ»ï¼Œæ‰€ä»¥ä¸ä¼šæ‰§è¡Œ1000æ¬¡Watcherçš„runã€‚æœ€ç»ˆæ›´æ–°è§†å›¾åªä¼šç›´æŽ¥å°†testå¯¹åº”çš„DOMçš„0å˜æˆ1000ã€‚ ä¿è¯æ›´æ–°è§†å›¾æ“ä½œDOMçš„åŠ¨ä½œæ˜¯åœ¨å½“å‰æ ˆæ‰§è¡Œå®Œä»¥åŽä¸‹ä¸€ä¸ªtickçš„æ—¶å€™è°ƒç”¨ï¼Œå¤§å¤§ä¼˜åŒ–äº†æ€§èƒ½ã€‚ è®¿é—®çœŸå®žDOMèŠ‚ç‚¹æ›´æ–°åŽçš„æ•°æ®æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ä¿®æ”¹dataä¸­çš„æ•°æ®åŽè®¿é—®çœŸå®žçš„DOMèŠ‚ç‚¹æ›´æ–°åŽçš„æ•°æ®ï¼Œåªéœ€è¦è¿™æ ·ï¼Œæˆ‘ä»¬æŠŠæ–‡ç« ç¬¬ä¸€ä¸ªä¾‹å­è¿›è¡Œä¿®æ”¹ã€‚ 123456&lt;template&gt; &lt;div&gt; &lt;div ref="test"&gt;&#123;&#123;test&#125;&#125;&lt;/div&gt; &lt;button @click="handleClick"&gt;tet&lt;/button&gt; &lt;/div&gt;&lt;/template&gt; 12345678910111213141516export default &#123; data () &#123; return &#123; test: 'begin' &#125;; &#125;, methods () &#123; handleClick () &#123; this.test = 'end'; this.$nextTick(() =&gt; &#123; console.log(this.$refs.test.innerText);//æ‰“å°"end" &#125;); console.log(this.$refs.test.innerText);//æ‰“å°â€œbeginâ€ &#125; &#125;&#125; ä½¿ç”¨Vue.jsçš„global APIçš„$nextTickæ–¹æ³•ï¼Œå³å¯åœ¨å›žè°ƒä¸­èŽ·å–å·²ç»æ›´æ–°å¥½çš„DOMå®žä¾‹äº†ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vueäº‹ä»¶API]]></title>
    <url>%2F2018%2F12%2F16%2FVue%2FVue%E4%BA%8B%E4%BB%B6API%2F</url>
    <content type="text"><![CDATA[Vueäº‹ä»¶APIä¼—æ‰€å‘¨çŸ¥ï¼ŒVue.jsä¸ºæˆ‘ä»¬æä¾›äº†å››ä¸ªäº‹ä»¶APIï¼Œåˆ†åˆ«æ˜¯$onï¼Œ$onceï¼Œ$offï¼Œ$emitã€‚ åˆå§‹åŒ–äº‹ä»¶åˆå§‹åŒ–äº‹ä»¶åœ¨vmä¸Šåˆ›å»ºä¸€ä¸ª_eventså¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾äº‹ä»¶ã€‚_eventsçš„å†…å®¹å¦‚ä¸‹ï¼š 123&#123; eventName: [func1, func2, func3]&#125; å­˜æ”¾äº‹ä»¶åä»¥åŠå¯¹åº”æ‰§è¡Œæ–¹æ³•ã€‚ 12345678910111213/*åˆå§‹åŒ–äº‹ä»¶*/export function initEvents (vm: Component) &#123; /*åœ¨vmä¸Šåˆ›å»ºä¸€ä¸ª_eventså¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾äº‹ä»¶ã€‚*/ vm._events = Object.create(null) /*è¿™ä¸ªboolæ ‡å¿—ä½æ¥è¡¨æ˜Žæ˜¯å¦å­˜åœ¨é’©å­ï¼Œè€Œä¸éœ€è¦é€šè¿‡å“ˆå¸Œè¡¨çš„æ–¹æ³•æ¥æŸ¥æ‰¾æ˜¯å¦æœ‰é’©å­ï¼Œè¿™æ ·åšå¯ä»¥å‡å°‘ä¸å¿…è¦çš„å¼€é”€ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚*/ vm._hasHookEvent = false // init parent attached events /*åˆå§‹åŒ–çˆ¶ç»„ä»¶attachçš„äº‹ä»¶*/ const listeners = vm.$options._parentListeners if (listeners) &#123; updateComponentListeners(vm, listeners) &#125;&#125; $on$onæ–¹æ³•ç”¨æ¥åœ¨vmå®žä¾‹ä¸Šç›‘å¬ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œè¯¥äº‹ä»¶å¯ç”¨$emitè§¦å‘ã€‚ 12345678910111213141516171819Vue.prototype.$on = function (event: string | Array&lt;string&gt;, fn: Function): Component &#123; const vm: Component = this /*å¦‚æžœæ˜¯æ•°ç»„çš„æ—¶å€™ï¼Œåˆ™é€’å½’$onï¼Œä¸ºæ¯ä¸€ä¸ªæˆå‘˜éƒ½ç»‘å®šä¸Šæ–¹æ³•*/ if (Array.isArray(event)) &#123; for (let i = 0, l = event.length; i &lt; l; i++) &#123; this.$on(event[i], fn) &#125; &#125; else &#123; (vm._events[event] || (vm._events[event] = [])).push(fn) // optimize hook:event cost by using a boolean flag marked at registration // instead of a hash lookup /*è¿™é‡Œåœ¨æ³¨å†Œäº‹ä»¶çš„æ—¶å€™æ ‡è®°boolå€¼ä¹Ÿå°±æ˜¯ä¸ªæ ‡å¿—ä½æ¥è¡¨æ˜Žå­˜åœ¨é’©å­ï¼Œè€Œä¸éœ€è¦é€šè¿‡å“ˆå¸Œè¡¨çš„æ–¹æ³•æ¥æŸ¥æ‰¾æ˜¯å¦æœ‰é’©å­ï¼Œè¿™æ ·åšå¯ä»¥å‡å°‘ä¸å¿…è¦çš„å¼€é”€ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚*/ if (hookRE.test(event)) &#123; vm._hasHookEvent = true &#125; &#125; return vm&#125; $once$onceç›‘å¬ä¸€ä¸ªåªèƒ½è§¦å‘ä¸€æ¬¡çš„äº‹ä»¶ï¼Œåœ¨è§¦å‘ä»¥åŽä¼šè‡ªåŠ¨ç§»é™¤è¯¥äº‹ä»¶ã€‚ 123456789101112Vue.prototype.$once = function (event: string, fn: Function): Component &#123; const vm: Component = this function on () &#123; /*åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™å°†è¯¥äº‹ä»¶é”€æ¯*/ vm.$off(event, on) /*æ‰§è¡Œæ³¨å†Œçš„æ–¹æ³•*/ fn.apply(vm, arguments) &#125; on.fn = fn vm.$on(event, on) return vm &#125; $off$offç”¨æ¥ç§»é™¤è‡ªå®šä¹‰äº‹ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041Vue.prototype.$off = function (event?: string | Array&lt;string&gt;, fn?: Function): Component &#123; const vm: Component = this // all /*å¦‚æžœä¸ä¼ å‚æ•°åˆ™æ³¨é”€æ‰€æœ‰äº‹ä»¶*/ if (!arguments.length) &#123; vm._events = Object.create(null) return vm &#125; // array of events /*å¦‚æžœeventæ˜¯æ•°ç»„åˆ™é€’å½’æ³¨é”€äº‹ä»¶*/ if (Array.isArray(event)) &#123; for (let i = 0, l = event.length; i &lt; l; i++) &#123; this.$off(event[i], fn) &#125; return vm &#125; // specific event const cbs = vm._events[event] /*Github:https://github.com/answershuto*/ /*æœ¬èº«ä¸å­˜åœ¨è¯¥äº‹ä»¶åˆ™ç›´æŽ¥è¿”å›ž*/ if (!cbs) &#123; return vm &#125; /*å¦‚æžœåªä¼ äº†eventå‚æ•°åˆ™æ³¨é”€è¯¥eventæ–¹æ³•ä¸‹çš„æ‰€æœ‰æ–¹æ³•*/ if (arguments.length === 1) &#123; vm._events[event] = null return vm &#125; // specific handler /*éåŽ†å¯»æ‰¾å¯¹åº”æ–¹æ³•å¹¶åˆ é™¤*/ let cb let i = cbs.length while (i--) &#123; cb = cbs[i] if (cb === fn || cb.fn === fn) &#123; cbs.splice(i, 1) break &#125; &#125; return vm &#125; $emit$emitç”¨æ¥è§¦å‘æŒ‡å®šçš„è‡ªå®šä¹‰äº‹ä»¶ã€‚ 1234567891011121314151617181920212223242526Vue.prototype.$emit = function (event: string): Component &#123; const vm: Component = this if (process.env.NODE_ENV !== 'production') &#123; const lowerCaseEvent = event.toLowerCase() if (lowerCaseEvent !== event &amp;&amp; vm._events[lowerCaseEvent]) &#123; tip( `Event "$&#123;lowerCaseEvent&#125;" is emitted in component ` + `$&#123;formatComponentName(vm)&#125; but the handler is registered for "$&#123;event&#125;". ` + `Note that HTML attributes are case-insensitive and you cannot use ` + `v-on to listen to camelCase events when using in-DOM templates. ` + `You should probably use "$&#123;hyphenate(event)&#125;" instead of "$&#123;event&#125;".` ) &#125; &#125; let cbs = vm._events[event] if (cbs) &#123; /*å°†ç±»æ•°ç»„çš„å¯¹è±¡è½¬æ¢æˆæ•°ç»„*/ cbs = cbs.length &gt; 1 ? toArray(cbs) : cbs const args = toArray(arguments, 1) /*éåŽ†æ‰§è¡Œ*/ for (let i = 0, l = cbs.length; i &lt; l; i++) &#123; cbs[i].apply(vm, args) &#125; &#125; return vm &#125;]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vueæºç ä¹‹ä»Žæºç è§’åº¦å†çœ‹æ•°æ®ç»‘å®š]]></title>
    <url>%2F2018%2F12%2F09%2FVue%2Fvue%E6%BA%90%E7%A0%81%E4%B9%8B%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%86%8D%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ å‰æ–‡å‰é¢å·²ç»è®²è¿‡Vueæ•°æ®ç»‘å®šçš„åŽŸç†äº†ï¼ŒçŽ°åœ¨ä»Žæºç æ¥çœ‹ä¸€ä¸‹æ•°æ®ç»‘å®šåœ¨Vueä¸­æ˜¯å¦‚ä½•å®žçŽ°çš„ã€‚ é¦–å…ˆçœ‹ä¸€ä¸‹Vue.jså®˜ç½‘ä»‹ç»å“åº”å¼åŽŸç†çš„è¿™å¼ å›¾ã€‚ è¿™å¼ å›¾æ¯”è¾ƒæ¸…æ™°åœ°å±•ç¤ºäº†æ•´ä¸ªæµç¨‹ï¼Œé¦–å…ˆé€šè¿‡ä¸€æ¬¡æ¸²æŸ“æ“ä½œè§¦å‘Dataçš„getterï¼ˆè¿™é‡Œä¿è¯åªæœ‰è§†å›¾ä¸­éœ€è¦è¢«ç”¨åˆ°çš„dataæ‰ä¼šè§¦å‘getterï¼‰è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œè¿™æ—¶å€™å…¶å®žWatcherä¸Ždataå¯ä»¥çœ‹æˆä¸€ç§è¢«ç»‘å®šçš„çŠ¶æ€ï¼ˆå®žé™…ä¸Šæ˜¯dataçš„é—­åŒ…ä¸­æœ‰ä¸€ä¸ªDepsè®¢é˜…è€…ï¼Œåœ¨ä¿®æ”¹çš„æ—¶å€™ä¼šé€šçŸ¥æ‰€æœ‰çš„Watcherè§‚å¯Ÿè€…ï¼‰ï¼Œåœ¨dataå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ä¼šè§¦å‘å®ƒçš„setterï¼Œsetteré€šçŸ¥Watcherï¼ŒWatcherè¿›è¡Œå›žè°ƒé€šçŸ¥ç»„ä»¶é‡æ–°æ¸²æŸ“çš„å‡½æ•°ï¼Œä¹‹åŽæ ¹æ®diffç®—æ³•æ¥å†³å®šæ˜¯å¦å‘ç”Ÿè§†å›¾çš„æ›´æ–°ã€‚ Vueåœ¨åˆå§‹åŒ–ç»„ä»¶æ•°æ®æ—¶ï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸçš„beforeCreateä¸Žcreatedé’©å­å‡½æ•°ä¹‹é—´å®žçŽ°äº†å¯¹dataã€propsã€computedã€methodsã€eventsä»¥åŠwatchçš„å¤„ç†ã€‚ initDataè¿™é‡Œæ¥è®²ä¸€ä¸‹initDataï¼Œå¯ä»¥å‚è€ƒæºç instanceä¸‹çš„state.jsæ–‡ä»¶ï¼Œä¸‹é¢æ‰€æœ‰çš„ä¸­æ–‡æ³¨é‡Šéƒ½æ˜¯æˆ‘åŠ çš„ï¼Œè‹±æ–‡æ³¨é‡Šæ˜¯å°¤å¤§åŠ çš„ï¼Œè¯·ä¸è¦å¿½ç•¥è‹±æ–‡æ³¨é‡Šï¼Œè‹±æ–‡æ³¨é‡Šéƒ½è®²åˆ°äº†æ¯”è¾ƒå…³é”®æˆ–è€…æ™¦æ¶©éš¾æ‡‚çš„ç‚¹ã€‚ åŠ æ³¨é‡Šç‰ˆçš„vueæºç ä¹Ÿå¯ä»¥ç›´æŽ¥é€šè¿‡ä¼ é€é—¨æŸ¥çœ‹ï¼Œè¿™äº›æ˜¯æˆ‘åœ¨é˜…è¯»Vueæºç è¿‡ç¨‹ä¸­åŠ çš„æ³¨é‡Šï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚ initDataä¸»è¦æ˜¯åˆå§‹åŒ–dataä¸­çš„æ•°æ®ï¼Œå°†æ•°æ®è¿›è¡ŒObserverï¼Œç›‘å¬æ•°æ®çš„å˜åŒ–ï¼Œå…¶ä»–çš„ç›‘è§†åŽŸç†ä¸€è‡´ï¼Œè¿™é‡Œä»¥dataä¸ºä¾‹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445function initData (vm: Component) &#123; /*å¾—åˆ°dataæ•°æ®*/ let data = vm.$options.data data = vm._data = typeof data === 'function' ? getData(data, vm) : data || &#123;&#125; /*åˆ¤æ–­æ˜¯å¦æ˜¯å¯¹è±¡*/ if (!isPlainObject(data)) &#123; data = &#123;&#125; process.env.NODE_ENV !== 'production' &amp;&amp; warn( 'data functions should return an object:\n' + 'https://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function', vm ) &#125; // proxy data on instance /*éåŽ†dataå¯¹è±¡*/ const keys = Object.keys(data) const props = vm.$options.props let i = keys.length //éåŽ†dataä¸­çš„æ•°æ® while (i--) &#123; /*ä¿è¯dataä¸­çš„keyä¸ä¸Žpropsä¸­çš„keyé‡å¤ï¼Œpropsä¼˜å…ˆï¼Œå¦‚æžœæœ‰å†²çªä¼šäº§ç”Ÿwarning*/ if (props &amp;&amp; hasOwn(props, keys[i])) &#123; process.env.NODE_ENV !== 'production' &amp;&amp; warn( `The data property "$&#123;keys[i]&#125;" is already declared as a prop. ` + `Use prop default value instead.`, vm ) &#125; else if (!isReserved(keys[i])) &#123; /*åˆ¤æ–­æ˜¯å¦æ˜¯ä¿ç•™å­—æ®µ*/ /*è¿™é‡Œæ˜¯æˆ‘ä»¬å‰é¢è®²è¿‡çš„ä»£ç†ï¼Œå°†dataä¸Šé¢çš„å±žæ€§ä»£ç†åˆ°äº†vmå®žä¾‹ä¸Š*/ proxy(vm, `_data`, keys[i]) &#125; &#125; /*Github:https://github.com/answershuto*/ // observe data /*ä»Žè¿™é‡Œå¼€å§‹æˆ‘ä»¬è¦observeäº†ï¼Œå¼€å§‹å¯¹æ•°æ®è¿›è¡Œç»‘å®šï¼Œè¿™é‡Œæœ‰å°¤å¤§å¤§çš„æ³¨é‡ŠasRootDataï¼Œè¿™æ­¥ä½œä¸ºæ ¹æ•°æ®ï¼Œä¸‹é¢ä¼šè¿›è¡Œé€’å½’observeè¿›è¡Œå¯¹æ·±å±‚å¯¹è±¡çš„ç»‘å®šã€‚*/ observe(data, true /* asRootData */)&#125; å…¶å®žè¿™æ®µä»£ç ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼Œä¸€æ˜¯å°†_dataä¸Šé¢çš„æ•°æ®ä»£ç†åˆ°vmä¸Šï¼Œå¦ä¸€ä»¶äº‹é€šè¿‡observeå°†æ‰€æœ‰æ•°æ®å˜æˆobservableã€‚ proxyæŽ¥ä¸‹æ¥çœ‹ä¸€ä¸‹proxyä»£ç†ã€‚ 12345678910/*æ·»åŠ ä»£ç†*/export function proxy (target: Object, sourceKey: string, key: string) &#123; sharedPropertyDefinition.get = function proxyGetter () &#123; return this[sourceKey][key] &#125; sharedPropertyDefinition.set = function proxySetter (val) &#123; this[sourceKey][key] = val &#125; Object.defineProperty(target, key, sharedPropertyDefinition)&#125; è¿™é‡Œæ¯”è¾ƒå¥½ç†è§£ï¼Œé€šè¿‡proxyå‡½æ•°å°†dataä¸Šé¢çš„æ•°æ®ä»£ç†åˆ°vmä¸Šï¼Œè¿™æ ·å°±å¯ä»¥ç”¨app.textä»£æ›¿app._data.textäº†ã€‚ observeæŽ¥ä¸‹æ¥æ˜¯observeï¼Œè¿™ä¸ªå‡½æ•°å®šä¹‰åœ¨coreæ–‡ä»¶ä¸‹observerçš„index.jsæ–‡ä»¶ä¸­ã€‚ 123456789101112131415161718192021222324252627282930313233343536/** * Attempt to create an observer instance for a value, * returns the new observer if successfully observed, * or the existing observer if the value already has one. */ /* å°è¯•åˆ›å»ºä¸€ä¸ªObserverå®žä¾‹ï¼ˆ__ob__ï¼‰ï¼Œå¦‚æžœæˆåŠŸåˆ›å»ºObserverå®žä¾‹åˆ™è¿”å›žæ–°çš„Observerå®žä¾‹ï¼Œå¦‚æžœå·²æœ‰Observerå®žä¾‹åˆ™è¿”å›žçŽ°æœ‰çš„Observerå®žä¾‹ã€‚ */export function observe (value: any, asRootData: ?boolean): Observer | void &#123; /*åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªå¯¹è±¡*/ if (!isObject(value)) &#123; return &#125; let ob: Observer | void /*è¿™é‡Œç”¨__ob__è¿™ä¸ªå±žæ€§æ¥åˆ¤æ–­æ˜¯å¦å·²ç»æœ‰Observerå®žä¾‹ï¼Œå¦‚æžœæ²¡æœ‰Observerå®žä¾‹åˆ™ä¼šæ–°å»ºä¸€ä¸ªObserverå®žä¾‹å¹¶èµ‹å€¼ç»™__ob__è¿™ä¸ªå±žæ€§ï¼Œå¦‚æžœå·²æœ‰Observerå®žä¾‹åˆ™ç›´æŽ¥è¿”å›žè¯¥Observerå®žä¾‹*/ if (hasOwn(value, '__ob__') &amp;&amp; value.__ob__ instanceof Observer) &#123; ob = value.__ob__ &#125; else if ( /*è¿™é‡Œçš„åˆ¤æ–­æ˜¯ä¸ºäº†ç¡®ä¿valueæ˜¯å•çº¯çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å‡½æ•°æˆ–è€…æ˜¯Regexpç­‰æƒ…å†µã€‚*/ observerState.shouldConvert &amp;&amp; !isServerRendering() &amp;&amp; (Array.isArray(value) || isPlainObject(value)) &amp;&amp; Object.isExtensible(value) &amp;&amp; !value._isVue ) &#123; ob = new Observer(value) &#125; if (asRootData &amp;&amp; ob) &#123; /*å¦‚æžœæ˜¯æ ¹æ•°æ®åˆ™è®¡æ•°ï¼ŒåŽé¢Observerä¸­çš„observeçš„asRootDataéžtrue*/ ob.vmCount++ &#125; return ob&#125; Vueçš„å“åº”å¼æ•°æ®éƒ½ä¼šæœ‰ä¸€ä¸ªobçš„å±žæ€§ä½œä¸ºæ ‡è®°ï¼Œé‡Œé¢å­˜æ”¾äº†è¯¥å±žæ€§çš„è§‚å¯Ÿå™¨ï¼Œä¹Ÿå°±æ˜¯Observerçš„å®žä¾‹ï¼Œé˜²æ­¢é‡å¤ç»‘å®šã€‚ ObserveræŽ¥ä¸‹æ¥çœ‹ä¸€ä¸‹æ–°å»ºçš„Observerã€‚Observerçš„ä½œç”¨å°±æ˜¯éåŽ†å¯¹è±¡çš„æ‰€æœ‰å±žæ€§å°†å…¶è¿›è¡ŒåŒå‘ç»‘å®šã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465/** * Observer class that are attached to each observed * object. Once attached, the observer converts target * object's property keys into getter/setters that * collect dependencies and dispatches updates. */export class &#123; value: any; dep: Dep; vmCount: number; // number of vms that has this object as root $data constructor (value: any) &#123; this.value = value this.dep = new Dep() this.vmCount = 0 /* å°†Observerå®žä¾‹ç»‘å®šåˆ°dataçš„__ob__å±žæ€§ä¸Šé¢åŽ»ï¼Œä¹‹å‰è¯´è¿‡observeçš„æ—¶å€™ä¼šå…ˆæ£€æµ‹æ˜¯å¦å·²ç»æœ‰__ob__å¯¹è±¡å­˜æ”¾Observerå®žä¾‹äº†ï¼Œdefæ–¹æ³•å®šä¹‰å¯ä»¥å‚è€ƒhttps://github.com/vuejs/vue/blob/dev/src/core/util/lang.js#L16 */ def(value, '__ob__', this) if (Array.isArray(value)) &#123; /* å¦‚æžœæ˜¯æ•°ç»„ï¼Œå°†ä¿®æ”¹åŽå¯ä»¥æˆªèŽ·å“åº”çš„æ•°ç»„æ–¹æ³•æ›¿æ¢æŽ‰è¯¥æ•°ç»„çš„åŽŸåž‹ä¸­çš„åŽŸç”Ÿæ–¹æ³•ï¼Œè¾¾åˆ°ç›‘å¬æ•°ç»„æ•°æ®å˜åŒ–å“åº”çš„æ•ˆæžœã€‚ è¿™é‡Œå¦‚æžœå½“å‰æµè§ˆå™¨æ”¯æŒ__proto__å±žæ€§ï¼Œåˆ™ç›´æŽ¥è¦†ç›–å½“å‰æ•°ç»„å¯¹è±¡åŽŸåž‹ä¸Šçš„åŽŸç”Ÿæ•°ç»„æ–¹æ³•ï¼Œå¦‚æžœä¸æ”¯æŒè¯¥å±žæ€§ï¼Œåˆ™ç›´æŽ¥è¦†ç›–æ•°ç»„å¯¹è±¡çš„åŽŸåž‹ã€‚ */ const augment = hasProto ? protoAugment /*ç›´æŽ¥è¦†ç›–åŽŸåž‹çš„æ–¹æ³•æ¥ä¿®æ”¹ç›®æ ‡å¯¹è±¡*/ : copyAugment /*å®šä¹‰ï¼ˆè¦†ç›–ï¼‰ç›®æ ‡å¯¹è±¡æˆ–æ•°ç»„çš„æŸä¸€ä¸ªæ–¹æ³•*/ augment(value, arrayMethods, arrayKeys) /*Github:https://github.com/answershuto*/ /*å¦‚æžœæ˜¯æ•°ç»„åˆ™éœ€è¦éåŽ†æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜è¿›è¡Œobserve*/ this.observeArray(value) &#125; else &#123; /*å¦‚æžœæ˜¯å¯¹è±¡åˆ™ç›´æŽ¥walkè¿›è¡Œç»‘å®š*/ this.walk(value) &#125; &#125; /** * Walk through each property and convert them into * getter/setters. This method should only be called when * value type is Object. */ walk (obj: Object) &#123; const keys = Object.keys(obj) /*walkæ–¹æ³•ä¼šéåŽ†å¯¹è±¡çš„æ¯ä¸€ä¸ªå±žæ€§è¿›è¡ŒdefineReactiveç»‘å®š*/ for (let i = 0; i &lt; keys.length; i++) &#123; defineReactive(obj, keys[i], obj[keys[i]]) &#125; &#125; /** * Observe a list of Array items. */ observeArray (items: Array&lt;any&gt;) &#123; /*æ•°ç»„éœ€è¦ä¾¿åˆ©æ¯ä¸€ä¸ªæˆå‘˜è¿›è¡Œobserve*/ for (let i = 0, l = items.length; i &lt; l; i++) &#123; observe(items[i]) &#125; &#125;&#125; Observerä¸ºæ•°æ®åŠ ä¸Šå“åº”å¼å±žæ€§è¿›è¡ŒåŒå‘ç»‘å®šã€‚å¦‚æžœæ˜¯å¯¹è±¡åˆ™è¿›è¡Œæ·±åº¦éåŽ†ï¼Œä¸ºæ¯ä¸€ä¸ªå­å¯¹è±¡éƒ½ç»‘å®šä¸Šæ–¹æ³•ï¼Œå¦‚æžœæ˜¯æ•°ç»„åˆ™ä¸ºæ¯ä¸€ä¸ªæˆå‘˜éƒ½ç»‘å®šä¸Šæ–¹æ³•ã€‚ å¦‚æžœæ˜¯ä¿®æ”¹ä¸€ä¸ªæ•°ç»„çš„æˆå‘˜ï¼Œè¯¥æˆå‘˜æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£åªéœ€è¦é€’å½’å¯¹æ•°ç»„çš„æˆå‘˜è¿›è¡ŒåŒå‘ç»‘å®šå³å¯ã€‚ä½†è¿™æ—¶å€™å‡ºçŽ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œï¼Ÿå¦‚æžœæˆ‘ä»¬è¿›è¡Œpopã€pushç­‰æ“ä½œçš„æ—¶å€™ï¼Œpushè¿›åŽ»çš„å¯¹è±¡æ ¹æœ¬æ²¡æœ‰è¿›è¡Œè¿‡åŒå‘ç»‘å®šï¼Œæ›´åˆ«è¯´popäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç›‘å¬æ•°ç»„çš„è¿™äº›å˜åŒ–å‘¢ï¼Ÿ Vue.jsæä¾›çš„æ–¹æ³•æ˜¯é‡å†™pushã€popã€shiftã€unshiftã€spliceã€sortã€reverseè¿™ä¸ƒä¸ªæ•°ç»„æ–¹æ³•ã€‚ä¿®æ”¹æ•°ç»„åŽŸåž‹æ–¹æ³•çš„ä»£ç å¯ä»¥å‚è€ƒobserver/array.jsä»¥åŠobserver/index.jsã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950export class Observer &#123; value: any; dep: Dep; vmCount: number; // number of vms that has this object as root $data constructor (value: any) &#123; //....... if (Array.isArray(value)) &#123; /* å¦‚æžœæ˜¯æ•°ç»„ï¼Œå°†ä¿®æ”¹åŽå¯ä»¥æˆªèŽ·å“åº”çš„æ•°ç»„æ–¹æ³•æ›¿æ¢æŽ‰è¯¥æ•°ç»„çš„åŽŸåž‹ä¸­çš„åŽŸç”Ÿæ–¹æ³•ï¼Œè¾¾åˆ°ç›‘å¬æ•°ç»„æ•°æ®å˜åŒ–å“åº”çš„æ•ˆæžœã€‚ è¿™é‡Œå¦‚æžœå½“å‰æµè§ˆå™¨æ”¯æŒ__proto__å±žæ€§ï¼Œåˆ™ç›´æŽ¥è¦†ç›–å½“å‰æ•°ç»„å¯¹è±¡åŽŸåž‹ä¸Šçš„åŽŸç”Ÿæ•°ç»„æ–¹æ³•ï¼Œå¦‚æžœä¸æ”¯æŒè¯¥å±žæ€§ï¼Œåˆ™ç›´æŽ¥è¦†ç›–æ•°ç»„å¯¹è±¡çš„åŽŸåž‹ã€‚ */ const augment = hasProto ? protoAugment /*ç›´æŽ¥è¦†ç›–åŽŸåž‹çš„æ–¹æ³•æ¥ä¿®æ”¹ç›®æ ‡å¯¹è±¡*/ : copyAugment /*å®šä¹‰ï¼ˆè¦†ç›–ï¼‰ç›®æ ‡å¯¹è±¡æˆ–æ•°ç»„çš„æŸä¸€ä¸ªæ–¹æ³•*/ augment(value, arrayMethods, arrayKeys) /*å¦‚æžœæ˜¯æ•°ç»„åˆ™éœ€è¦éåŽ†æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜è¿›è¡Œobserve*/ this.observeArray(value) &#125; else &#123; /*å¦‚æžœæ˜¯å¯¹è±¡åˆ™ç›´æŽ¥walkè¿›è¡Œç»‘å®š*/ this.walk(value) &#125; &#125;&#125;/** * Augment an target Object or Array by intercepting * the prototype chain using __proto__ */ /*ç›´æŽ¥è¦†ç›–åŽŸåž‹çš„æ–¹æ³•æ¥ä¿®æ”¹ç›®æ ‡å¯¹è±¡æˆ–æ•°ç»„*/function protoAugment (target, src: Object) &#123; /* eslint-disable no-proto */ target.__proto__ = src /* eslint-enable no-proto */&#125;/** * Augment an target Object or Array by defining * hidden properties. *//* istanbul ignore next *//*å®šä¹‰ï¼ˆè¦†ç›–ï¼‰ç›®æ ‡å¯¹è±¡æˆ–æ•°ç»„çš„æŸä¸€ä¸ªæ–¹æ³•*/function copyAugment (target: Object, src: Object, keys: Array&lt;string&gt;) &#123; for (let i = 0, l = keys.length; i &lt; l; i++) &#123; const key = keys[i] def(target, key, src[key]) &#125;&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162/* * not type checking this file because flow doesn't play well with * dynamically accessing methods on Array prototype */import &#123; def &#125; from '../util/index'/*å–å¾—åŽŸç”Ÿæ•°ç»„çš„åŽŸåž‹*/const arrayProto = Array.prototype/*åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„å¯¹è±¡ï¼Œä¿®æ”¹è¯¥å¯¹è±¡ä¸Šçš„æ•°ç»„çš„ä¸ƒä¸ªæ–¹æ³•ï¼Œé˜²æ­¢æ±¡æŸ“åŽŸç”Ÿæ•°ç»„æ–¹æ³•*/export const arrayMethods = Object.create(arrayProto)/** * Intercept mutating methods and emit events */ /*è¿™é‡Œé‡å†™äº†æ•°ç»„çš„è¿™äº›æ–¹æ³•ï¼Œåœ¨ä¿è¯ä¸æ±¡æŸ“åŽŸç”Ÿæ•°ç»„åŽŸåž‹çš„æƒ…å†µä¸‹é‡å†™æ•°ç»„çš„è¿™äº›æ–¹æ³•ï¼ŒæˆªèŽ·æ•°ç»„çš„æˆå‘˜å‘ç”Ÿçš„å˜åŒ–ï¼Œæ‰§è¡ŒåŽŸç”Ÿæ•°ç»„æ“ä½œçš„åŒæ—¶depé€šçŸ¥å…³è”çš„æ‰€æœ‰è§‚å¯Ÿè€…è¿›è¡Œå“åº”å¼å¤„ç†*/;[ 'push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse'].forEach(function (method) &#123; // cache original method /*å°†æ•°ç»„çš„åŽŸç”Ÿæ–¹æ³•ç¼“å­˜èµ·æ¥ï¼ŒåŽé¢è¦è°ƒç”¨*/ const original = arrayProto[method] def(arrayMethods, method, function mutator () &#123; // avoid leaking arguments: // http://jsperf.com/closure-with-arguments let i = arguments.length const args = new Array(i) while (i--) &#123; args[i] = arguments[i] &#125; /*è°ƒç”¨åŽŸç”Ÿçš„æ•°ç»„æ–¹æ³•*/ const result = original.apply(this, args) /*æ•°ç»„æ–°æ’å…¥çš„å…ƒç´ éœ€è¦é‡æ–°è¿›è¡Œobserveæ‰èƒ½å“åº”å¼*/ const ob = this.__ob__ let inserted switch (method) &#123; case 'push': inserted = args break case 'unshift': inserted = args break case 'splice': inserted = args.slice(2) break &#125; if (inserted) ob.observeArray(inserted) // notify change /*depé€šçŸ¥æ‰€æœ‰æ³¨å†Œçš„è§‚å¯Ÿè€…è¿›è¡Œå“åº”å¼å¤„ç†*/ ob.dep.notify() return result &#125;)&#125;) ä»Žæ•°ç»„çš„åŽŸåž‹æ–°å»ºä¸€ä¸ªObject.create(arrayProto)å¯¹è±¡ï¼Œé€šè¿‡ä¿®æ”¹æ­¤åŽŸåž‹å¯ä»¥ä¿è¯åŽŸç”Ÿæ•°ç»„æ–¹æ³•ä¸è¢«æ±¡æŸ“ã€‚å¦‚æžœå½“å‰æµè§ˆå™¨æ”¯æŒ__proto__è¿™ä¸ªå±žæ€§çš„è¯å°±å¯ä»¥ç›´æŽ¥è¦†ç›–è¯¥å±žæ€§åˆ™ä½¿æ•°ç»„å¯¹è±¡å…·æœ‰äº†é‡å†™åŽçš„æ•°ç»„æ–¹æ³•ã€‚å¦‚æžœæ²¡æœ‰è¯¥å±žæ€§çš„æµè§ˆå™¨ï¼Œåˆ™å¿…é¡»é€šè¿‡éåŽ†defæ‰€æœ‰éœ€è¦é‡å†™çš„æ•°ç»„æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•æ•ˆçŽ‡è¾ƒä½Žï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨ç¬¬ä¸€ç§ã€‚ åœ¨ä¿è¯ä¸æ±¡æŸ“ä¸è¦†ç›–æ•°ç»„åŽŸç”Ÿæ–¹æ³•æ·»åŠ ç›‘å¬ï¼Œä¸»è¦åšäº†ä¸¤ä¸ªæ“ä½œï¼Œç¬¬ä¸€æ˜¯é€šçŸ¥æ‰€æœ‰æ³¨å†Œçš„è§‚å¯Ÿè€…è¿›è¡Œå“åº”å¼å¤„ç†ï¼Œç¬¬äºŒæ˜¯å¦‚æžœæ˜¯æ·»åŠ æˆå‘˜çš„æ“ä½œï¼Œéœ€è¦å¯¹æ–°æˆå‘˜è¿›è¡Œobserveã€‚ ä½†æ˜¯ä¿®æ”¹äº†æ•°ç»„çš„åŽŸç”Ÿæ–¹æ³•ä»¥åŽæˆ‘ä»¬è¿˜æ˜¯æ²¡æ³•åƒåŽŸç”Ÿæ•°ç»„ä¸€æ ·ç›´æŽ¥é€šè¿‡æ•°ç»„çš„ä¸‹æ ‡æˆ–è€…è®¾ç½®lengthæ¥ä¿®æ”¹æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡Vue.setä»¥åŠspliceæ–¹æ³•ã€‚ WatcherWatcheræ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ã€‚ä¾èµ–æ”¶é›†ä»¥åŽWatcherå¯¹è±¡ä¼šè¢«ä¿å­˜åœ¨Depsä¸­ï¼Œæ•°æ®å˜åŠ¨çš„æ—¶å€™ä¼šç”±Depsé€šçŸ¥Watcherå®žä¾‹ï¼Œç„¶åŽç”±Watcherå®žä¾‹å›žè°ƒcbè¿›è¡Œè§†å›¾çš„æ›´æ–° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249export default class Watcher &#123; vm: Component; expression: string; cb: Function; id: number; deep: boolean; user: boolean; lazy: boolean; sync: boolean; dirty: boolean; active: boolean; deps: Array&lt;Dep&gt;; newDeps: Array&lt;Dep&gt;; depIds: ISet; newDepIds: ISet; getter: Function; value: any; constructor ( vm: Component, expOrFn: string | Function, cb: Function, options?: Object ) &#123; this.vm = vm /*_watcherså­˜æ”¾è®¢é˜…è€…å®žä¾‹*/ vm._watchers.push(this) // options if (options) &#123; this.deep = !!options.deep this.user = !!options.user this.lazy = !!options.lazy this.sync = !!options.sync &#125; else &#123; this.deep = this.user = this.lazy = this.sync = false &#125; this.cb = cb this.id = ++uid // uid for batching this.active = true this.dirty = this.lazy // for lazy watchers this.deps = [] this.newDeps = [] this.depIds = new Set() this.newDepIds = new Set() this.expression = process.env.NODE_ENV !== 'production' ? expOrFn.toString() : '' // parse expression for getter /*æŠŠè¡¨è¾¾å¼expOrFnè§£æžæˆgetter*/ if (typeof expOrFn === 'function') &#123; this.getter = expOrFn &#125; else &#123; this.getter = parsePath(expOrFn) if (!this.getter) &#123; this.getter = function () &#123;&#125; process.env.NODE_ENV !== 'production' &amp;&amp; warn( `Failed watching path: "$&#123;expOrFn&#125;" ` + 'Watcher only accepts simple dot-delimited paths. ' + 'For full control, use a function instead.', vm ) &#125; &#125; this.value = this.lazy ? undefined : this.get() &#125; /** * Evaluate the getter, and re-collect dependencies. */ /*èŽ·å¾—getterçš„å€¼å¹¶ä¸”é‡æ–°è¿›è¡Œä¾èµ–æ”¶é›†*/ get () &#123; /*å°†è‡ªèº«watcherè§‚å¯Ÿè€…å®žä¾‹è®¾ç½®ç»™Dep.targetï¼Œç”¨ä»¥ä¾èµ–æ”¶é›†ã€‚*/ pushTarget(this) let value const vm = this.vm /* æ‰§è¡Œäº†getteræ“ä½œï¼Œçœ‹ä¼¼æ‰§è¡Œäº†æ¸²æŸ“æ“ä½œï¼Œå…¶å®žæ˜¯æ‰§è¡Œäº†ä¾èµ–æ”¶é›†ã€‚ åœ¨å°†Dep.targetè®¾ç½®ä¸ºè‡ªç”Ÿè§‚å¯Ÿè€…å®žä¾‹ä»¥åŽï¼Œæ‰§è¡Œgetteræ“ä½œã€‚ è­¬å¦‚è¯´çŽ°åœ¨çš„çš„dataä¸­å¯èƒ½æœ‰aã€bã€cä¸‰ä¸ªæ•°æ®ï¼Œgetteræ¸²æŸ“éœ€è¦ä¾èµ–aè·Ÿcï¼Œ é‚£ä¹ˆåœ¨æ‰§è¡Œgetterçš„æ—¶å€™å°±ä¼šè§¦å‘aè·Ÿcä¸¤ä¸ªæ•°æ®çš„getterå‡½æ•°ï¼Œ åœ¨getterå‡½æ•°ä¸­å³å¯åˆ¤æ–­Dep.targetæ˜¯å¦å­˜åœ¨ç„¶åŽå®Œæˆä¾èµ–æ”¶é›†ï¼Œ å°†è¯¥è§‚å¯Ÿè€…å¯¹è±¡æ”¾å…¥é—­åŒ…ä¸­çš„Depçš„subsä¸­åŽ»ã€‚ */ if (this.user) &#123; try &#123; value = this.getter.call(vm, vm) &#125; catch (e) &#123; handleError(e, vm, `getter for watcher "$&#123;this.expression&#125;"`) &#125; &#125; else &#123; value = this.getter.call(vm, vm) &#125; // "touch" every property so they are all tracked as // dependencies for deep watching /*å¦‚æžœå­˜åœ¨deepï¼Œåˆ™è§¦å‘æ¯ä¸ªæ·±å±‚å¯¹è±¡çš„ä¾èµ–ï¼Œè¿½è¸ªå…¶å˜åŒ–*/ if (this.deep) &#123; /*é€’å½’æ¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œè§¦å‘å®ƒä»¬çš„getterï¼Œä½¿å¾—å¯¹è±¡æˆ–æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜éƒ½è¢«ä¾èµ–æ”¶é›†ï¼Œå½¢æˆä¸€ä¸ªâ€œæ·±ï¼ˆdeepï¼‰â€ä¾èµ–å…³ç³»*/ traverse(value) &#125; /*å°†è§‚å¯Ÿè€…å®žä¾‹ä»Žtargetæ ˆä¸­å–å‡ºå¹¶è®¾ç½®ç»™Dep.target*/ popTarget() this.cleanupDeps() return value &#125; /** * Add a dependency to this directive. */ /*æ·»åŠ ä¸€ä¸ªä¾èµ–å…³ç³»åˆ°Depsé›†åˆä¸­*/ addDep (dep: Dep) &#123; const id = dep.id if (!this.newDepIds.has(id)) &#123; this.newDepIds.add(id) this.newDeps.push(dep) if (!this.depIds.has(id)) &#123; dep.addSub(this) &#125; &#125; &#125; /** * Clean up for dependency collection. */ /*æ¸…ç†ä¾èµ–æ”¶é›†*/ cleanupDeps () &#123; /*ç§»é™¤æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡*/ let i = this.deps.length while (i--) &#123; const dep = this.deps[i] if (!this.newDepIds.has(dep.id)) &#123; dep.removeSub(this) &#125; &#125; let tmp = this.depIds this.depIds = this.newDepIds this.newDepIds = tmp this.newDepIds.clear() tmp = this.deps this.deps = this.newDeps this.newDeps = tmp this.newDeps.length = 0 &#125; /** * Subscriber interface. * Will be called when a dependency changes. */ /* è°ƒåº¦è€…æŽ¥å£ï¼Œå½“ä¾èµ–å‘ç”Ÿæ”¹å˜çš„æ—¶å€™è¿›è¡Œå›žè°ƒã€‚ */ update () &#123; /* istanbul ignore else */ if (this.lazy) &#123; this.dirty = true &#125; else if (this.sync) &#123; /*åŒæ­¥åˆ™æ‰§è¡Œrunç›´æŽ¥æ¸²æŸ“è§†å›¾*/ this.run() &#125; else &#123; /*å¼‚æ­¥æŽ¨é€åˆ°è§‚å¯Ÿè€…é˜Ÿåˆ—ä¸­ï¼Œç”±è°ƒåº¦è€…è°ƒç”¨ã€‚*/ queueWatcher(this) &#125; &#125; /** * Scheduler job interface. * Will be called by the scheduler. */ /* è°ƒåº¦è€…å·¥ä½œæŽ¥å£ï¼Œå°†è¢«è°ƒåº¦è€…å›žè°ƒã€‚ */ run () &#123; if (this.active) &#123; const value = this.get() if ( value !== this.value || // Deep watchers and watchers on Object/Arrays should fire even // when the value is the same, because the value may // have mutated. /* å³ä¾¿å€¼ç›¸åŒï¼Œæ‹¥æœ‰Deepå±žæ€§çš„è§‚å¯Ÿè€…ä»¥åŠåœ¨å¯¹è±¡ï¼æ•°ç»„ä¸Šçš„è§‚å¯Ÿè€…åº”è¯¥è¢«è§¦å‘æ›´æ–°ï¼Œå› ä¸ºå®ƒä»¬çš„å€¼å¯èƒ½å‘ç”Ÿæ”¹å˜ã€‚ */ isObject(value) || this.deep ) &#123; // set new value const oldValue = this.value /*è®¾ç½®æ–°çš„å€¼*/ this.value = value /*è§¦å‘å›žè°ƒæ¸²æŸ“è§†å›¾*/ if (this.user) &#123; try &#123; this.cb.call(this.vm, value, oldValue) &#125; catch (e) &#123; handleError(e, this.vm, `callback for watcher "$&#123;this.expression&#125;"`) &#125; &#125; else &#123; this.cb.call(this.vm, value, oldValue) &#125; &#125; &#125; &#125; /** * Evaluate the value of the watcher. * This only gets called for lazy watchers. */ /*èŽ·å–è§‚å¯Ÿè€…çš„å€¼*/ evaluate () &#123; this.value = this.get() this.dirty = false &#125; /** * Depend on all deps collected by this watcher. */ /*æ”¶é›†è¯¥watcherçš„æ‰€æœ‰depsä¾èµ–*/ depend () &#123; let i = this.deps.length while (i--) &#123; this.deps[i].depend() &#125; &#125; /** * Remove self from all dependencies' subscriber list. */ /*å°†è‡ªèº«ä»Žæ‰€æœ‰ä¾èµ–æ”¶é›†è®¢é˜…åˆ—è¡¨åˆ é™¤*/ teardown () &#123; if (this.active) &#123; // remove self from vm's watcher list // this is a somewhat expensive operation so we skip it // if the vm is being destroyed. /*ä»Žvmå®žä¾‹çš„è§‚å¯Ÿè€…åˆ—è¡¨ä¸­å°†è‡ªèº«ç§»é™¤ï¼Œç”±äºŽè¯¥æ“ä½œæ¯”è¾ƒè€—è´¹èµ„æºï¼Œæ‰€ä»¥å¦‚æžœvmå®žä¾‹æ­£åœ¨è¢«é”€æ¯åˆ™è·³è¿‡è¯¥æ­¥éª¤ã€‚*/ if (!this.vm._isBeingDestroyed) &#123; remove(this.vm._watchers, this) &#125; let i = this.deps.length while (i--) &#123; this.deps[i].removeSub(this) &#125; this.active = false &#125; &#125;&#125; Depæ¥çœ‹çœ‹Depç±»ã€‚å…¶å®žDepå°±æ˜¯ä¸€ä¸ªå‘å¸ƒè€…ï¼Œå¯ä»¥è®¢é˜…å¤šä¸ªè§‚å¯Ÿè€…ï¼Œä¾èµ–æ”¶é›†ä¹‹åŽDepsä¸­ä¼šå­˜åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªWatcherå¯¹è±¡ï¼Œåœ¨æ•°æ®å˜æ›´çš„æ—¶å€™é€šçŸ¥æ‰€æœ‰çš„Watcherã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546/** * A dep is an observable that can have multiple * directives subscribing to it. */export default class Dep &#123; static target: ?Watcher; id: number; subs: Array&lt;Watcher&gt;; constructor () &#123; this.id = uid++ this.subs = [] &#125; /*æ·»åŠ ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡*/ addSub (sub: Watcher) &#123; this.subs.push(sub) &#125; /*ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡*/ removeSub (sub: Watcher) &#123; remove(this.subs, sub) &#125; /*ä¾èµ–æ”¶é›†ï¼Œå½“å­˜åœ¨Dep.targetçš„æ—¶å€™æ·»åŠ è§‚å¯Ÿè€…å¯¹è±¡*/ depend () &#123; if (Dep.target) &#123; Dep.target.addDep(this) &#125; &#125; /*é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…*/ notify () &#123; // stabilize the subscriber list first const subs = this.subs.slice() for (let i = 0, l = subs.length; i &lt; l; i++) &#123; subs[i].update() &#125; &#125;&#125;// the current target watcher being evaluated.// this is globally unique because there could be only one// watcher being evaluated at any time.Dep.target = null/*ä¾èµ–æ”¶é›†å®Œéœ€è¦å°†Dep.targetè®¾ä¸ºnullï¼Œé˜²æ­¢åŽé¢é‡å¤æ·»åŠ ä¾èµ–ã€‚*/ defineReactiveæŽ¥ä¸‹æ¥æ˜¯defineReactiveã€‚defineReactiveçš„ä½œç”¨æ˜¯é€šè¿‡Object.definePropertyä¸ºæ•°æ®å®šä¹‰ä¸Šgetter\setteræ–¹æ³•ï¼Œè¿›è¡Œä¾èµ–æ”¶é›†åŽé—­åŒ…ä¸­çš„Depsä¼šå­˜æ”¾Watcherå¯¹è±¡ã€‚è§¦å‘setteræ”¹å˜æ•°æ®çš„æ—¶å€™ä¼šé€šçŸ¥Depsè®¢é˜…è€…é€šçŸ¥æ‰€æœ‰çš„Watcherè§‚å¯Ÿè€…å¯¹è±¡è¿›è¡Œè¯•å›¾çš„æ›´æ–°ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576/** * Define a reactive property on an Object. */export function defineReactive ( obj: Object, key: string, val: any, customSetter?: Function) &#123; /*åœ¨é—­åŒ…ä¸­å®šä¹‰ä¸€ä¸ªdepå¯¹è±¡*/ const dep = new Dep() const property = Object.getOwnPropertyDescriptor(obj, key) if (property &amp;&amp; property.configurable === false) &#123; return &#125; /*å¦‚æžœä¹‹å‰è¯¥å¯¹è±¡å·²ç»é¢„è®¾äº†getterä»¥åŠsetterå‡½æ•°åˆ™å°†å…¶å–å‡ºæ¥ï¼Œæ–°å®šä¹‰çš„getter/setterä¸­ä¼šå°†å…¶æ‰§è¡Œï¼Œä¿è¯ä¸ä¼šè¦†ç›–ä¹‹å‰å·²ç»å®šä¹‰çš„getter/setterã€‚*/ // cater for pre-defined getter/setters const getter = property &amp;&amp; property.get const setter = property &amp;&amp; property.set /*å¯¹è±¡çš„å­å¯¹è±¡é€’å½’è¿›è¡Œobserveå¹¶è¿”å›žå­èŠ‚ç‚¹çš„Observerå¯¹è±¡*/ let childOb = observe(val) Object.defineProperty(obj, key, &#123; enumerable: true, configurable: true, get: function reactiveGetter () &#123; /*å¦‚æžœåŽŸæœ¬å¯¹è±¡æ‹¥æœ‰getteræ–¹æ³•åˆ™æ‰§è¡Œ*/ const value = getter ? getter.call(obj) : val if (Dep.target) &#123; /*è¿›è¡Œä¾èµ–æ”¶é›†*/ dep.depend() if (childOb) &#123; /*å­å¯¹è±¡è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå…¶å®žå°±æ˜¯å°†åŒä¸€ä¸ªwatcherè§‚å¯Ÿè€…å®žä¾‹æ”¾è¿›äº†ä¸¤ä¸ªdependä¸­ï¼Œä¸€ä¸ªæ˜¯æ­£åœ¨æœ¬èº«é—­åŒ…ä¸­çš„dependï¼Œå¦ä¸€ä¸ªæ˜¯å­å…ƒç´ çš„depend*/ childOb.dep.depend() &#125; if (Array.isArray(value)) &#123; /*æ˜¯æ•°ç»„åˆ™éœ€è¦å¯¹æ¯ä¸€ä¸ªæˆå‘˜éƒ½è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå¦‚æžœæ•°ç»„çš„æˆå‘˜è¿˜æ˜¯æ•°ç»„ï¼Œåˆ™é€’å½’ã€‚*/ dependArray(value) &#125; &#125; return value &#125;, set: function reactiveSetter (newVal) &#123; /*é€šè¿‡getteræ–¹æ³•èŽ·å–å½“å‰å€¼ï¼Œä¸Žæ–°å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸€è‡´åˆ™ä¸éœ€è¦æ‰§è¡Œä¸‹é¢çš„æ“ä½œ*/ const value = getter ? getter.call(obj) : val /* eslint-disable no-self-compare */ if (newVal === value || (newVal !== newVal &amp;&amp; value !== value)) &#123; return &#125; /* eslint-enable no-self-compare */ if (process.env.NODE_ENV !== 'production' &amp;&amp; customSetter) &#123; customSetter() &#125; if (setter) &#123; /*å¦‚æžœåŽŸæœ¬å¯¹è±¡æ‹¥æœ‰setteræ–¹æ³•åˆ™æ‰§è¡Œsetter*/ setter.call(obj, newVal) &#125; else &#123; val = newVal &#125; /*æ–°çš„å€¼éœ€è¦é‡æ–°è¿›è¡Œobserveï¼Œä¿è¯æ•°æ®å“åº”å¼*/ childOb = observe(newVal) /*depå¯¹è±¡é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…*/ dep.notify() &#125; &#125;)&#125;]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vuæºç ä¹‹ä¾èµ–æ”¶é›†]]></title>
    <url>%2F2018%2F12%2F02%2FVue%2FVu%E6%BA%90%E7%A0%81%E4%B9%8B%E4%BE%9D%E8%B5%96%E6%94%B6%E9%9B%86%2F</url>
    <content type="text"><![CDATA[ä¸ºä»€ä¹ˆè¦ä¾èµ–æ”¶é›†ï¼Ÿå…ˆçœ‹è¿™æ®µä»£ç  123456789101112new Vue(&#123; template: `&lt;div&gt; &lt;span&gt;text1:&lt;/span&gt; &#123;&#123;text1&#125;&#125; &lt;span&gt;text2:&lt;/span&gt; &#123;&#123;text2&#125;&#125; &lt;div&gt;`, data: &#123; text1: 'text1', text2: 'text2', text3: 'text3' &#125;&#125;); æŒ‰ç…§ä¹‹å‰ã€Šå“åº”å¼åŽŸç†ã€‹ä¸­çš„æ–¹æ³•ç»‘å®šåˆ™ä¼šå‡ºçŽ°ä¸€ä¸ªé—®é¢˜â€”â€”text3åœ¨å®žé™…æ¨¡æ¿ä¸­å¹¶æ²¡æœ‰è¢«ç”¨åˆ°ï¼Œç„¶è€Œå½“text3çš„æ•°æ®è¢«ä¿®æ”¹çš„æ—¶å€™ï¼ˆthis.text3 = â€˜testâ€™ï¼‰çš„æ—¶å€™ï¼ŒåŒæ ·ä¼šè§¦å‘text3çš„setterå¯¼è‡´é‡æ–°æ‰§è¡Œæ¸²æŸ“ï¼Œè¿™æ˜¾ç„¶ä¸æ­£ç¡®ã€‚ å…ˆè¯´è¯´Depå½“å¯¹dataä¸Šçš„å¯¹è±¡è¿›è¡Œä¿®æ”¹å€¼çš„æ—¶å€™ä¼šè§¦å‘å®ƒçš„setterï¼Œé‚£ä¹ˆå–å€¼çš„æ—¶å€™è‡ªç„¶å°±ä¼šè§¦å‘getteräº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦åœ¨æœ€å¼€å§‹è¿›è¡Œä¸€æ¬¡renderï¼Œé‚£ä¹ˆæ‰€æœ‰è¢«æ¸²æŸ“æ‰€ä¾èµ–çš„dataä¸­çš„æ•°æ®å°±ä¼šè¢«getteræ”¶é›†åˆ°Depçš„subsä¸­åŽ»ã€‚åœ¨å¯¹dataä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹çš„æ—¶å€™setteråªä¼šè§¦å‘Depçš„subsçš„å‡½æ•°ã€‚ å®šä¹‰ä¸€ä¸ªä¾èµ–æ”¶é›†ç±»Depã€‚ 12345678910111213141516171819202122232425262728class Dep &#123; constructor () &#123; this.subs = []; &#125; addSub (sub: Watcher) &#123; this.subs.push(sub) &#125; removeSub (sub: Watcher) &#123; remove(this.subs, sub) &#125; /*Github:https://github.com/answershuto*/ notify () &#123; // stabilize the subscriber list first const subs = this.subs.slice() for (let i = 0, l = subs.length; i &lt; l; i++) &#123; subs[i].update() &#125; &#125;&#125;function remove (arr, item) &#123; if (arr.length) &#123; const index = arr.indexOf(item) if (index &gt; -1) &#123; return arr.splice(index, 1) &#125;&#125; Watcherè®¢é˜…è€…ï¼Œå½“ä¾èµ–æ”¶é›†çš„æ—¶å€™ä¼šaddSubåˆ°subä¸­ï¼Œåœ¨ä¿®æ”¹dataä¸­æ•°æ®çš„æ—¶å€™ä¼šè§¦å‘depå¯¹è±¡çš„notifyï¼Œé€šçŸ¥æ‰€æœ‰Watcherå¯¹è±¡åŽ»ä¿®æ”¹å¯¹åº”è§†å›¾ã€‚ 12345678910111213141516class Watcher &#123; constructor (vm, expOrFn, cb, options) &#123; this.cb = cb; this.vm = vm; /*åœ¨è¿™é‡Œå°†è§‚å¯Ÿè€…æœ¬èº«èµ‹å€¼ç»™å…¨å±€çš„targetï¼Œåªæœ‰è¢«targetæ ‡è®°è¿‡çš„æ‰ä¼šè¿›è¡Œä¾èµ–æ”¶é›†*/ Dep.target = this; /*Github:https://github.com/answershuto*/ /*è§¦å‘æ¸²æŸ“æ“ä½œè¿›è¡Œä¾èµ–æ”¶é›†*/ this.cb.call(this.vm); &#125; update () &#123; this.cb.call(this.vm); &#125;&#125; å¼€å§‹ä¾èµ–æ”¶é›†1234567891011121314151617181920212223242526272829class Vue &#123; constructor(options) &#123; this._data = options.data; observer(this._data, options.render); let watcher = new Watcher(this, ); &#125;&#125;function defineReactive (obj, key, val, cb) &#123; /*åœ¨é—­åŒ…å†…å­˜å‚¨ä¸€ä¸ªDepå¯¹è±¡*/ const dep = new Dep(); Object.defineProperty(obj, key, &#123; enumerable: true, configurable: true, get: ()=&gt;&#123; if (Dep.target) &#123; /*Watcherå¯¹è±¡å­˜åœ¨å…¨å±€çš„Dep.targetä¸­*/ dep.addSub(Dep.target); &#125; &#125;, set:newVal=&gt; &#123; /*åªæœ‰ä¹‹å‰addSubä¸­çš„å‡½æ•°æ‰ä¼šè§¦å‘*/ dep.notify(); &#125; &#125;)&#125;Dep.target = null; å°†è§‚å¯Ÿè€…Watcherå®žä¾‹èµ‹å€¼ç»™å…¨å±€çš„Dep.targetï¼Œç„¶åŽè§¦å‘renderæ“ä½œåªæœ‰è¢«Dep.targetæ ‡è®°è¿‡çš„æ‰ä¼šè¿›è¡Œä¾èµ–æ”¶é›†ã€‚æœ‰Dep.targetçš„å¯¹è±¡ä¼šå°†Watcherçš„å®žä¾‹pushåˆ°subsä¸­ï¼Œåœ¨å¯¹è±¡è¢«ä¿®æ”¹å‡ºå‘setteræ“ä½œçš„æ—¶å€™depä¼šè°ƒç”¨subsä¸­çš„Watcherå®žä¾‹çš„updateæ–¹æ³•è¿›è¡Œæ¸²æŸ“ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue æºç åˆ†æžä¹‹å“åº”å¼åŽŸç†]]></title>
    <url>%2F2018%2F11%2F25%2FVue%2Fvue-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ å…³äºŽVue.jsVue.jsæ˜¯ä¸€æ¬¾MVVMæ¡†æž¶ï¼Œä¸Šæ‰‹å¿«é€Ÿç®€å•æ˜“ç”¨ï¼Œé€šè¿‡å“åº”å¼åœ¨ä¿®æ”¹æ•°æ®çš„æ—¶å€™æ›´æ–°è§†å›¾ã€‚Vue.jsçš„å“åº”å¼åŽŸç†ä¾èµ–äºŽObject.definePropertyï¼Œå°¤å¤§å¤§åœ¨Vue.jsæ–‡æ¡£ä¸­å°±å·²ç»æåˆ°è¿‡ï¼Œè¿™ä¹Ÿæ˜¯Vue.jsä¸æ”¯æŒIE8 ä»¥åŠæ›´ä½Žç‰ˆæœ¬æµè§ˆå™¨çš„åŽŸå› ã€‚Vueé€šè¿‡è®¾å®šå¯¹è±¡å±žæ€§çš„ setter/getter æ–¹æ³•æ¥ç›‘å¬æ•°æ®çš„å˜åŒ–ï¼Œé€šè¿‡getterè¿›è¡Œä¾èµ–æ”¶é›†ï¼Œè€Œæ¯ä¸ªsetteræ–¹æ³•å°±æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œåœ¨æ•°æ®å˜æ›´çš„æ—¶å€™é€šçŸ¥è®¢é˜…è€…æ›´æ–°è§†å›¾ã€‚ å°†æ•°æ®dataå˜æˆå¯è§‚å¯Ÿï¼ˆobservableï¼‰çš„é‚£ä¹ˆVueæ˜¯å¦‚ä½•å°†æ‰€æœ‰dataä¸‹é¢çš„æ‰€æœ‰å±žæ€§å˜æˆå¯è§‚å¯Ÿçš„ï¼ˆobservableï¼‰å‘¢ï¼Ÿ 12345678910111213141516171819202122232425262728293031323334353637function observable(value,cb)&#123; Object.keys(value).forEach((key)=&gt; defineReactive(value, key, value[key] , cb));&#125;function defineReactive (obj, key, val, cb) &#123; Object.defineProperty(obj, key, &#123; enumerable: true, configurable: true, get: ()=&gt;&#123; /*....ä¾èµ–æ”¶é›†ç­‰....*/ /*Github:https://github.com/answershuto*/ return val &#125;, set:newVal=&gt; &#123; val = newVal; cb();/*è®¢é˜…è€…æ”¶åˆ°æ¶ˆæ¯çš„å›žè°ƒ*/ &#125; &#125;)&#125;class Vue()&#123; constructor(options)&#123; this._data = options.data; observe(this._data, options.render) &#125;&#125;let app = new Vue(&#123; el: '#app', data: &#123; text: 'text', text2: 'text2' &#125;, render()&#123; console.log("render"); &#125;&#125;) ä¸ºäº†ä¾¿äºŽç†è§£ï¼Œé¦–å…ˆè€ƒè™‘ä¸€ç§æœ€ç®€å•çš„æƒ…å†µï¼Œä¸è€ƒè™‘æ•°ç»„ç­‰æƒ…å†µï¼Œä»£ç å¦‚ä¸Šæ‰€ç¤ºã€‚åœ¨initDataä¸­ä¼šè°ƒç”¨observeè¿™ä¸ªå‡½æ•°å°†Vueçš„æ•°æ®è®¾ç½®æˆobservableçš„ã€‚å½“_dataæ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™å°±ä¼šè§¦å‘setï¼Œå¯¹è®¢é˜…è€…è¿›è¡Œå›žè°ƒï¼ˆåœ¨è¿™é‡Œæ˜¯renderï¼‰ã€‚ é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œéœ€è¦å¯¹app._data.textæ“ä½œæ‰ä¼šè§¦å‘setã€‚ä¸ºäº†å·æ‡’ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹ä¾¿çš„æ–¹æ³•é€šè¿‡app.textç›´æŽ¥è®¾ç½®å°±èƒ½è§¦å‘setå¯¹è§†å›¾è¿›è¡Œé‡ç»˜ã€‚é‚£ä¹ˆå°±éœ€è¦ç”¨åˆ°ä»£ç†ã€‚ ä»£ç†æˆ‘ä»¬å¯ä»¥åœ¨Vueçš„æž„é€ å‡½æ•°constructorä¸­ä¸ºdataæ‰§è¡Œä¸€ä¸ªä»£ç†proxyã€‚è¿™æ ·æˆ‘ä»¬å°±æŠŠdataä¸Šé¢çš„å±žæ€§ä»£ç†åˆ°äº†vmå®žä¾‹ä¸Šã€‚ 123456789101112131415161718_proxy.call(this, options.data);/*æž„é€ å‡½æ•°ä¸­*//*ä»£ç†*/function _proxy (data) &#123; const that = this; Object.keys(data).forEach(key =&gt; &#123; Object.defineProperty(that, key, &#123; configurable: true, enumerable: true, get: function proxyGetter () &#123; return that._data[key]; &#125;, set: function proxySetter (val) &#123; that._data[key] = val; &#125; &#125;) &#125;);&#125; æˆ‘ä»¬å¯ä»¥ä½¿ç”¨app.textä»£æ›¿app._data.textäº†ã€‚]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScript å¤æ‚åˆ¤æ–­çš„æ›´ä¼˜é›…å†™æ³•]]></title>
    <url>%2F2018%2F11%2F18%2FJs%2FJavaScript-%E5%A4%8D%E6%9D%82%E5%88%A4%E6%96%AD%E7%9A%84%E6%9B%B4%E4%BC%98%E9%9B%85%E5%86%99%E6%B3%95%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ å‰è¨€æˆ‘ä»¬ç¼–å†™jsä»£ç æ—¶ç»å¸¸é‡åˆ°å¤æ‚é€»è¾‘åˆ¤æ–­çš„æƒ…å†µï¼Œé€šå¸¸å¤§å®¶å¯ä»¥ç”¨if/elseæˆ–è€…switchæ¥å®žçŽ°å¤šä¸ªæ¡ä»¶åˆ¤æ–­ï¼Œä½†è¿™æ ·ä¼šæœ‰ä¸ªé—®é¢˜ï¼Œéšç€é€»è¾‘å¤æ‚åº¦çš„å¢žåŠ ï¼Œä»£ç ä¸­çš„if/else/switchä¼šå˜å¾—è¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œè¶Šæ¥è¶Šçœ‹ä¸æ‡‚ï¼Œé‚£ä¹ˆå¦‚ä½•æ›´ä¼˜é›…çš„å†™åˆ¤æ–­é€»è¾‘ï¼Œæœ¬æ–‡å¸¦ä½ è¯•ä¸€ä¸‹ã€‚ ä¸¾ä¸ªä¾‹å­12345678910111213141516171819202122232425/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param &#123;number&#125; status æ´»åŠ¨çŠ¶æ€ï¼š1 å¼€å›¢è¿›è¡Œä¸­ 2 å¼€å›¢å¤±è´¥ 3 å•†å“å”®ç½„ 4 å¼€å›¢æˆåŠŸ 5 ç³»ç»Ÿå–æ¶ˆ */const onButtonClick = (status)=&gt;&#123; if(status == 1)&#123; sendLog('processing') jumpTo('IndexPage') &#125;else if(status == 2)&#123; sendLog('fail') jumpTo('FailPage') &#125;else if(status == 3)&#123; sendLog('fail') jumpTo('FailPage') &#125;else if(status == 4)&#123; sendLog('success') jumpTo('SuccessPage') &#125;else if(status == 5)&#123; sendLog('cancel') jumpTo('CancelPage') &#125;else &#123; sendLog('other') jumpTo('Index') &#125;&#125; é€šè¿‡ä»£ç å¯ä»¥çœ‹åˆ°è¿™ä¸ªæŒ‰é’®çš„ç‚¹å‡»é€»è¾‘ï¼šæ ¹æ®ä¸åŒæ´»åŠ¨çŠ¶æ€åšä¸¤ä»¶äº‹æƒ…ï¼Œå‘é€æ—¥å¿—åŸ‹ç‚¹å’Œè·³è½¬åˆ°å¯¹åº”é¡µé¢ï¼Œå¤§å®¶å¯ä»¥å¾ˆè½»æ˜“çš„æå‡ºè¿™æ®µä»£ç çš„æ”¹å†™æ–¹æ¡ˆï¼Œswitchå‡ºåœºï¼š 1234567891011121314151617181920212223242526272829/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param &#123;number&#125; status æ´»åŠ¨çŠ¶æ€ï¼š1 å¼€å›¢è¿›è¡Œä¸­ 2 å¼€å›¢å¤±è´¥ 3 å•†å“å”®ç½„ 4 å¼€å›¢æˆåŠŸ 5 ç³»ç»Ÿå–æ¶ˆ */const onButtonClick = (status)=&gt;&#123; switch (status)&#123; case 1: sendLog('processing') jumpTo('IndexPage') break case 2: case 3: sendLog('fail') jumpTo('FailPage') break case 4: sendLog('success') jumpTo('SuccessPage') break case 5: sendLog('cancel') jumpTo('CancelPage') break default: sendLog('other') jumpTo('Index') break &#125;&#125; å—¯ï¼Œè¿™æ ·çœ‹èµ·æ¥æ¯”if/elseæ¸…æ™°å¤šäº†ï¼Œç»†å¿ƒçš„åŒå­¦ä¹Ÿå‘çŽ°äº†å°æŠ€å·§ï¼Œcase 2å’Œcase 3é€»è¾‘ä¸€æ ·çš„æ—¶å€™ï¼Œå¯ä»¥çœåŽ»æ‰§è¡Œè¯­å¥å’Œbreakï¼Œåˆ™case 2çš„æƒ…å†µè‡ªåŠ¨æ‰§è¡Œcase 3çš„é€»è¾‘ã€‚ è¿™æ—¶æœ‰åŒå­¦ä¼šè¯´ï¼Œè¿˜æœ‰æ›´ç®€å•çš„å†™æ³•ï¼šï¼ˆè¡¨é©±åŠ¨ç¼–ç¨‹ï¼‰ 12345678910111213141516171819const actions = &#123; '1': ['processing','IndexPage'], '2': ['fail','FailPage'], '3': ['fail','FailPage'], '4': ['success','SuccessPage'], '5': ['cancel','CancelPage'], 'default': ['other','Index'],&#125;/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param &#123;number&#125; status æ´»åŠ¨çŠ¶æ€ï¼š1å¼€å›¢è¿›è¡Œä¸­ 2å¼€å›¢å¤±è´¥ 3 å•†å“å”®ç½„ 4 å¼€å›¢æˆåŠŸ 5 ç³»ç»Ÿå–æ¶ˆ */const onButtonClick = (status)=&gt;&#123; let action = actions[status] || actions['default'], logName = action[0], pageName = action[1] sendLog(logName) jumpTo(pageName)&#125; ä¸Šé¢ä»£ç ç¡®å®žçœ‹èµ·æ¥æ›´æ¸…çˆ½äº†ï¼Œè¿™ç§æ–¹æ³•çš„èªæ˜Žä¹‹å¤„åœ¨äºŽï¼šå°†åˆ¤æ–­æ¡ä»¶ä½œä¸ºå¯¹è±¡çš„å±žæ€§åï¼Œå°†å¤„ç†é€»è¾‘ä½œä¸ºå¯¹è±¡çš„å±žæ€§å€¼ï¼Œåœ¨æŒ‰é’®ç‚¹å‡»çš„æ—¶å€™ï¼Œé€šè¿‡å¯¹è±¡å±žæ€§æŸ¥æ‰¾çš„æ–¹å¼æ¥è¿›è¡Œé€»è¾‘åˆ¤æ–­ï¼Œè¿™ç§å†™æ³•ç‰¹åˆ«é€‚åˆä¸€å…ƒæ¡ä»¶åˆ¤æ–­çš„æƒ…å†µã€‚ æ˜¯ä¸æ˜¯è¿˜æœ‰å…¶ä»–å†™æ³•å‘¢ï¼Ÿ 1234567891011121314151617const actions = new Map([ [1, ['processing','IndexPage']], [2, ['fail','FailPage']], [3, ['fail','FailPage']], [4, ['success','SuccessPage']], [5, ['cancel','CancelPage']], ['default', ['other','Index']]])/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param &#123;number&#125; status æ´»åŠ¨çŠ¶æ€ï¼š1 å¼€å›¢è¿›è¡Œä¸­ 2 å¼€å›¢å¤±è´¥ 3 å•†å“å”®ç½„ 4 å¼€å›¢æˆåŠŸ 5 ç³»ç»Ÿå–æ¶ˆ */const onButtonClick = (status)=&gt;&#123; let action = actions.get(status) || actions.get('default') sendLog(action[0]) jumpTo(action[1])&#125; è¿™æ ·å†™ç”¨åˆ°äº†es6é‡Œçš„Mapå¯¹è±¡ï¼Œæ˜¯ä¸æ˜¯æ›´çˆ½äº†ï¼ŸMapå¯¹è±¡å’ŒObjectå¯¹è±¡æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ ä¸€ä¸ªå¯¹è±¡é€šå¸¸éƒ½æœ‰è‡ªå·±çš„åŽŸåž‹ï¼Œæ‰€ä»¥ä¸€ä¸ªå¯¹è±¡æ€»æœ‰ä¸€ä¸ªâ€prototypeâ€é”®ã€‚ä¸€ä¸ªå¯¹è±¡çš„é”®åªèƒ½æ˜¯å­—ç¬¦ä¸²æˆ–è€…Symbolsï¼Œä½†ä¸€ä¸ªMapçš„é”®å¯ä»¥æ˜¯ä»»æ„å€¼ã€‚ä½ å¯ä»¥é€šè¿‡sizeå±žæ€§å¾ˆå®¹æ˜“åœ°å¾—åˆ°ä¸€ä¸ªMapçš„é”®å€¼å¯¹ä¸ªæ•°ï¼Œè€Œå¯¹è±¡çš„é”®å€¼å¯¹ä¸ªæ•°åªèƒ½æ‰‹åŠ¨ç¡®è®¤ã€‚ æˆ‘ä»¬éœ€è¦æŠŠé—®é¢˜å‡çº§ä¸€ä¸‹ï¼Œä»¥å‰æŒ‰é’®ç‚¹å‡»æ—¶å€™åªéœ€è¦åˆ¤æ–­statusï¼ŒçŽ°åœ¨è¿˜éœ€è¦åˆ¤æ–­ç”¨æˆ·çš„èº«ä»½ï¼š 123456789101112131415161718192021222324252627282930313233343536/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param &#123;number&#125; status æ´»åŠ¨çŠ¶æ€ï¼š1å¼€å›¢è¿›è¡Œä¸­ 2å¼€å›¢å¤±è´¥ 3 å¼€å›¢æˆåŠŸ 4 å•†å“å”®ç½„ 5 æœ‰åº“å­˜æœªå¼€å›¢ * @param &#123;string&#125; identity èº«ä»½æ ‡è¯†ï¼šguestå®¢æ€ masterä¸»æ€ */const onButtonClick = (status,identity)=&gt;&#123; if(identity == 'guest')&#123; if(status == 1)&#123; //do sth &#125;else if(status == 2)&#123; //do sth &#125;else if(status == 3)&#123; //do sth &#125;else if(status == 4)&#123; //do sth &#125;else if(status == 5)&#123; //do sth &#125;else &#123; //do sth &#125; &#125;else if(identity == 'master') &#123; if(status == 1)&#123; //do sth &#125;else if(status == 2)&#123; //do sth &#125;else if(status == 3)&#123; //do sth &#125;else if(status == 4)&#123; //do sth &#125;else if(status == 5)&#123; //do sth &#125;else &#123; //do sth &#125; &#125;&#125; åŽŸè°…æˆ‘ä¸å†™æ¯ä¸ªåˆ¤æ–­é‡Œçš„å…·ä½“é€»è¾‘äº†ï¼Œå› ä¸ºä»£ç å¤ªå†—é•¿äº†ã€‚åŽŸè°…æˆ‘åˆç”¨äº†if/elseï¼Œå› ä¸ºæˆ‘çœ‹åˆ°å¾ˆå¤šäººä¾ç„¶åœ¨ç”¨if/elseå†™è¿™ç§å¤§æ®µçš„é€»è¾‘åˆ¤æ–­ã€‚ä»Žä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ä½ çš„é€»è¾‘å‡çº§ä¸ºäºŒå…ƒåˆ¤æ–­æ—¶ï¼Œä½ çš„åˆ¤æ–­é‡ä¼šåŠ å€ï¼Œä½ çš„ä»£ç é‡ä¹Ÿä¼šåŠ å€ï¼Œè¿™æ—¶æ€Žä¹ˆå†™æ›´æ¸…çˆ½å‘¢ï¼Ÿ 1234567891011121314151617181920212223const actions = new Map([ ['guest_1', ()=&gt;&#123;/*do sth*/&#125;], ['guest_2', ()=&gt;&#123;/*do sth*/&#125;], ['guest_3', ()=&gt;&#123;/*do sth*/&#125;], ['guest_4', ()=&gt;&#123;/*do sth*/&#125;], ['guest_5', ()=&gt;&#123;/*do sth*/&#125;], ['master_1', ()=&gt;&#123;/*do sth*/&#125;], ['master_2', ()=&gt;&#123;/*do sth*/&#125;], ['master_3', ()=&gt;&#123;/*do sth*/&#125;], ['master_4', ()=&gt;&#123;/*do sth*/&#125;], ['master_5', ()=&gt;&#123;/*do sth*/&#125;], ['default', ()=&gt;&#123;/*do sth*/&#125;],])/** * æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * @param &#123;string&#125; identity èº«ä»½æ ‡è¯†ï¼šguestå®¢æ€ masterä¸»æ€ * @param &#123;number&#125; status æ´»åŠ¨çŠ¶æ€ï¼š1 å¼€å›¢è¿›è¡Œä¸­ 2 å¼€å›¢å¤±è´¥ 3 å¼€å›¢æˆåŠŸ 4 å•†å“å”®ç½„ 5 æœ‰åº“å­˜æœªå¼€å›¢ */const onButtonClick = (identity,status)=&gt;&#123; let action = actions.get(`$&#123;identity&#125;_$&#123;status&#125;`) || actions.get('default') action.call(this)&#125; ä¸Šè¿°ä»£ç æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šæŠŠä¸¤ä¸ªæ¡ä»¶æ‹¼æŽ¥æˆå­—ç¬¦ä¸²ï¼Œå¹¶é€šè¿‡ä»¥æ¡ä»¶æ‹¼æŽ¥å­—ç¬¦ä¸²ä½œä¸ºé”®ï¼Œä»¥å¤„ç†å‡½æ•°ä½œä¸ºå€¼çš„Mapå¯¹è±¡è¿›è¡ŒæŸ¥æ‰¾å¹¶æ‰§è¡Œï¼Œè¿™ç§å†™æ³•åœ¨å¤šå…ƒæ¡ä»¶åˆ¤æ–­æ—¶å€™å°¤å…¶å¥½ç”¨ã€‚ å½“ç„¶ä¸Šè¿°ä»£ç å¦‚æžœç”¨Objectå¯¹è±¡æ¥å®žçŽ°ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼š 12345678910const actions = &#123; 'guest_1':()=&gt;&#123;/*do sth*/&#125;, 'guest_2':()=&gt;&#123;/*do sth*/&#125;, //....&#125;const onButtonClick = (identity,status)=&gt;&#123; let action = actions[`$&#123;identity&#125;_$&#123;status&#125;`] || actions['default'] action.call(this)&#125; å¦‚æžœæœ‰äº›åŒå­¦è§‰å¾—æŠŠæŸ¥è¯¢æ¡ä»¶æ‹¼æˆå­—ç¬¦ä¸²æœ‰ç‚¹åˆ«æ‰­ï¼Œé‚£è¿˜æœ‰ä¸€ç§æ–¹æ¡ˆï¼Œå°±æ˜¯ç”¨Mapå¯¹è±¡ï¼Œä»¥Objectå¯¹è±¡ä½œä¸ºkeyï¼š 12345678910const actions = new Map([ [&#123;identity:'guest',status:1&#125;,()=&gt;&#123;/*do sth*/&#125;], [&#123;identity:'guest',status:2&#125;,()=&gt;&#123;/*do sth*/&#125;], //...])const onButtonClick = (identity,status)=&gt;&#123; let action = [...actions].filter(([key,value])=&gt;(key.identity == identity &amp;&amp; key.status == status)) action.forEach(([key,value])=&gt;value.call(this))&#125; æ˜¯ä¸æ˜¯åˆé«˜çº§äº†ä¸€ç‚¹ç‚¹ï¼Ÿ è¿™é‡Œä¹Ÿçœ‹å‡ºæ¥Mapä¸ŽObjectçš„åŒºåˆ«ï¼ŒMapå¯ä»¥ç”¨ä»»ä½•ç±»åž‹çš„æ•°æ®ä½œä¸ºkeyã€‚ æˆ‘ä»¬çŽ°åœ¨å†å°†éš¾åº¦å‡çº§ä¸€ç‚¹ç‚¹ï¼Œå‡å¦‚guestæƒ…å†µä¸‹ï¼Œstatus1-4çš„å¤„ç†é€»è¾‘éƒ½ä¸€æ ·æ€Žä¹ˆåŠžï¼Œæœ€å·®çš„æƒ…å†µæ˜¯è¿™æ ·ï¼š 12345678const actions = new Map([ [&#123;identity:'guest',status:1&#125;,()=&gt;&#123;/* functionA */&#125;], [&#123;identity:'guest',status:2&#125;,()=&gt;&#123;/* functionA */&#125;], [&#123;identity:'guest',status:3&#125;,()=&gt;&#123;/* functionA */&#125;], [&#123;identity:'guest',status:4&#125;,()=&gt;&#123;/* functionA */&#125;], [&#123;identity:'guest',status:5&#125;,()=&gt;&#123;/* functionB */&#125;], //...]) å¥½ä¸€ç‚¹çš„å†™æ³•æ˜¯å°†å¤„ç†é€»è¾‘å‡½æ•°è¿›è¡Œç¼“å­˜ï¼š 1234567891011121314151617const actions = ()=&gt;&#123; const functionA = ()=&gt;&#123;/*do sth*/&#125; const functionB = ()=&gt;&#123;/*do sth*/&#125; return new Map([ [&#123;identity:'guest',status:1&#125;,functionA], [&#123;identity:'guest',status:2&#125;,functionA], [&#123;identity:'guest',status:3&#125;,functionA], [&#123;identity:'guest',status:4&#125;,functionA], [&#123;identity:'guest',status:5&#125;,functionB], //... ])&#125;const onButtonClick = (identity,status)=&gt;&#123; let action = [...actions()].filter(([key,value])=&gt;(key.identity == identity &amp;&amp; key.status == status)) action.forEach(([key,value])=&gt;value.call(this))&#125; è¿™æ ·å†™å·²ç»èƒ½æ»¡è¶³æ—¥å¸¸éœ€æ±‚äº†ï¼Œä½†è®¤çœŸä¸€ç‚¹è®²ï¼Œä¸Šé¢é‡å†™äº†4æ¬¡functionAè¿˜æ˜¯æœ‰ç‚¹ä¸çˆ½ï¼Œå‡å¦‚åˆ¤æ–­æ¡ä»¶å˜å¾—ç‰¹åˆ«å¤æ‚ï¼Œæ¯”å¦‚identityæœ‰3ç§çŠ¶æ€ï¼Œstatusæœ‰10ç§çŠ¶æ€ï¼Œé‚£ä½ éœ€è¦å®šä¹‰30æ¡å¤„ç†é€»è¾‘ï¼Œè€Œå¾€å¾€è¿™äº›é€»è¾‘é‡Œé¢å¾ˆå¤šéƒ½æ˜¯ç›¸åŒçš„ï¼Œè¿™ä¼¼ä¹Žä¹Ÿæ˜¯ç¬”è€…ä¸æƒ³æŽ¥å—çš„ï¼Œé‚£å¯ä»¥è¿™æ ·å®žçŽ°: 1234567891011121314const actions = ()=&gt;&#123; const functionA = ()=&gt;&#123;/*do sth*/&#125; const functionB = ()=&gt;&#123;/*do sth*/&#125; return new Map([ [/^guest_[1-4]$/,functionA], [/^guest_5$/,functionB], //... ])&#125;const onButtonClick = (identity,status)=&gt;&#123; let action = [...actions()].filter(([key,value])=&gt;(key.test(`$&#123;identity&#125;_$&#123;status&#125;`))) action.forEach(([key,value])=&gt;value.call(this))&#125; è¿™é‡ŒMapçš„ä¼˜åŠ¿æ›´åŠ å‡¸æ˜¾ï¼Œå¯ä»¥ç”¨æ­£åˆ™ç±»åž‹ä½œä¸ºkeyäº†ï¼Œè¿™æ ·å°±æœ‰äº†æ— é™å¯èƒ½ï¼Œå‡å¦‚éœ€æ±‚å˜æˆï¼Œå‡¡æ˜¯guestæƒ…å†µéƒ½è¦å‘é€ä¸€ä¸ªæ—¥å¿—åŸ‹ç‚¹ï¼Œä¸åŒstatusæƒ…å†µä¹Ÿéœ€è¦å•ç‹¬çš„é€»è¾‘å¤„ç†ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™: 12345678910111213141516const actions = ()=&gt;&#123; const functionA = ()=&gt;&#123;/*do sth*/&#125; const functionB = ()=&gt;&#123;/*do sth*/&#125; const functionC = ()=&gt;&#123;/*send log*/&#125; return new Map([ [/^guest_[1-4]$/,functionA], [/^guest_5$/,functionB], [/^guest_.*$/,functionC], //... ])&#125;const onButtonClick = (identity,status)=&gt;&#123; let action = [...actions()].filter(([key,value])=&gt;(key.test(`$&#123;identity&#125;_$&#123;status&#125;`))) action.forEach(([key,value])=&gt;value.call(this))&#125; ä¹Ÿå°±æ˜¯è¯´åˆ©ç”¨æ•°ç»„å¾ªçŽ¯çš„ç‰¹æ€§ï¼Œç¬¦åˆæ­£åˆ™æ¡ä»¶çš„é€»è¾‘éƒ½ä¼šè¢«æ‰§è¡Œï¼Œé‚£å°±å¯ä»¥åŒæ—¶æ‰§è¡Œå…¬å…±é€»è¾‘å’Œå•ç‹¬é€»è¾‘ï¼Œå› ä¸ºæ­£åˆ™çš„å­˜åœ¨ï¼Œä½ å¯ä»¥æ‰“å¼€æƒ³è±¡åŠ›è§£é”æ›´å¤šçš„çŽ©æ³•ï¼Œæœ¬æ–‡å°±ä¸èµ˜è¿°äº†ã€‚ æ€»ç»“æœ¬æ–‡å·²ç»æ•™ä½ äº†8ç§é€»è¾‘åˆ¤æ–­å†™æ³•ï¼ŒåŒ…æ‹¬ï¼š if/else switch ä¸€å…ƒåˆ¤æ–­æ—¶ï¼šå­˜åˆ°Objecté‡Œ ä¸€å…ƒåˆ¤æ–­æ—¶ï¼šå­˜åˆ°Mapé‡Œ å¤šå…ƒåˆ¤æ–­æ—¶ï¼šå°†conditionæ‹¼æŽ¥æˆå­—ç¬¦ä¸²å­˜åˆ°Objecté‡Œ å¤šå…ƒåˆ¤æ–­æ—¶ï¼šå°†conditionæ‹¼æŽ¥æˆå­—ç¬¦ä¸²å­˜åˆ°Mapé‡Œ å¤šå…ƒåˆ¤æ–­æ—¶ï¼šå°†conditionå­˜ä¸ºObjectå­˜åˆ°Mapé‡Œ å¤šå…ƒåˆ¤æ–­æ—¶ï¼šå°†conditionå†™ä½œæ­£åˆ™å­˜åˆ°Mapé‡Œ è‡³æ­¤ï¼Œæœ¬æ–‡ä¹Ÿå°†å‘Šä¸€æ®µè½ï¼Œæ„¿ä½ æœªæ¥çš„äººç”Ÿé‡Œï¼Œä¸åªæ˜¯æœ‰if/else/switchã€‚]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[websocketé€šä¿¡äº†è§£]]></title>
    <url>%2F2018%2F11%2F04%2FHTTP%2Fwebsocket%E9%80%9A%E4%BF%A1%E4%BA%86%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[websocketwebsocketæ˜¯HTML5å‡ºçš„åè®®ï¼Œä»–æ˜¯ä¸€ä¸ªæŒä¹…åŒ–çš„åè®®ã€‚ websocketæ˜¯ä»€ä¹ˆæ ·çš„åè®®ï¼Œæœ‰ä»€ä¹ˆä¸Žä¼˜ç‚¹ï¼Ÿé¦–å…ˆwebsocketæ˜¯ä¸€ä¸ªæŒä¹…åŒ–çš„åè®®ï¼Œåœ¨HTTPä¸­ä¸€ä¸ªrequeståªèƒ½æœ‰ä¸€ä¸ªresponse,è€Œä¸”è¿™ä¸ªresponseä¹Ÿæ˜¯è¢«åŠ¨çš„ï¼Œä¸èƒ½ä¸»åŠ¨å‘èµ·ã€‚ ä¸‹é¢æ˜¯ç”¨websocketè¯·æ±‚çš„headerå¤´ 1234567891011GET /chat HTTP/1.1Host: server.example.com//å‘ŠçŸ¥æœåŠ¡å™¨æ˜¯ä½¿ç”¨websocketçš„åè®®Upgrade: websocket Connection: UpgradeSec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw== //æ˜¯ä¸€ä¸ªBase64 encodeçš„å€¼ï¼Œè¿™ä¸ªæ˜¯æµè§ˆå™¨éšæœºç”Ÿæˆçš„ï¼ŒéªŒè¯æœåŠ¡å™¨Sec-WebSocket-Protocol: chat, superchat // æ˜¯ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å­—ç¬¦ä¸²ï¼Œç”¨æ¥åŒºåˆ†åŒURLä¸‹ï¼Œä¸åŒçš„æœåŠ¡æ‰€éœ€è¦çš„åè®®Sec-WebSocket-Version: 13 // æ˜¯å‘Šè¯‰æœåŠ¡å™¨æ‰€ä½¿ç”¨çš„Websocket Draftï¼ˆåè®®ç‰ˆæœ¬ï¼‰Origin: http://example.com ä¸‹é¢æ˜¯æœåŠ¡å™¨çš„è¿”å›žå¤´ 12345HTTP/1.1 101 Switching ProtocolsUpgrade: websocketConnection: UpgradeSec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk=Sec-WebSocket-Protocol: chat ä¸‹é¢æ˜¯HTTPå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå·²ç»åˆ‡æ¢åè®®äº† 12Upgrade: websocketConnection: Upgrade ## websocketçš„ä½œç”¨ ajaxè½®è¯¢çš„åŽŸç†å¾ˆç®€å•ï¼Œæ¯éš”å‡ ç§’å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œè¯¢é—®æœåŠ¡å™¨æ˜¯å¦æœ‰ä¿¡æ¯ã€‚ http long pollçš„åŽŸç†ä¸Žajaxè½®è¯¢å·®ä¸å¤šï¼Œä¸è¿‡ é‡‡ç”¨çš„æ˜¯é˜»å¡žæ¨¡åž‹ï¼ˆä¸€ç›´æ‰“ç”µè¯ï¼Œæ²¡æ”¶åˆ°å°±ä¸æŒ‚ç”µè¯ï¼‰ è¿™ä¸¤è€…å…±åŒçš„åœ°æ–¹éƒ½æ˜¯åœ¨ä¸æ–­åœ°å»ºç«‹HTTPè¿žæŽ¥ï¼Œç­‰å¾…æœåŠ¡ç«¯å¤„ç†ï¼Œä¸Šé¢è¿™ä¸¤ç§éƒ½æ˜¯éžå¸¸æ¶ˆè€—èµ„æºçš„ã€‚å¯ä»¥ä½“çŽ°å‡ºHTTPçš„å¦å¤–ä¸€ä¸ªç‰¹ç‚¹ï¼šè¢«åŠ¨æ€§ å…¶å®žæˆ‘ä»¬æ‰€ç”¨çš„ç¨‹åºæ˜¯è¦ç»è¿‡ä¸¤å±‚ä»£ç†çš„ï¼Œå³HTTPåè®®åœ¨Nginxç­‰æœåŠ¡å™¨çš„è§£æžä¸‹ï¼Œç„¶åŽå†ä¼ é€ç»™ç›¸åº”çš„Handlerï¼ˆPHPç­‰ï¼‰æ¥å¤„ç†ã€‚ç®€å•åœ°è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªéžå¸¸å¿«é€Ÿçš„æŽ¥çº¿å‘˜ï¼ˆNginxï¼‰ï¼Œä»–è´Ÿè´£æŠŠé—®é¢˜è½¬äº¤ç»™ç›¸åº”çš„å®¢æœï¼ˆHandlerï¼‰ã€‚ Websocket åªéœ€è¦ä¸€æ¬¡HTTPæ¡æ‰‹ï¼Œæ‰€ä»¥è¯´æ•´ä¸ªé€šè®¯è¿‡ç¨‹æ˜¯å»ºç«‹åœ¨ä¸€æ¬¡è¿žæŽ¥/çŠ¶æ€ä¸­ï¼Œä¹Ÿå°±é¿å…äº†HTTPçš„éžçŠ¶æ€æ€§ï¼ŒæœåŠ¡ç«¯ä¼šä¸€ç›´çŸ¥é“ä½ çš„ä¿¡æ¯ï¼Œç›´åˆ°ä½ å…³é—­è¯·æ±‚ï¼Œè¿™æ ·å°±è§£å†³äº†æŽ¥çº¿å‘˜è¦åå¤è§£æžHTTPåè®®ï¼Œè¿˜è¦æŸ¥çœ‹identity infoçš„ä¿¡æ¯ã€‚]]></content>
      <categories>
        <category>HTTP</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[call stack]]></title>
    <url>%2F2018%2F11%2F04%2FJs%2Fcall-stack%2F</url>
    <content type="text"><![CDATA[Call Stack(è°ƒç”¨å †æ ˆ)MDN(è§£é‡Šcall Stack) A call stack is a mechanism for an interpreter (like the JavaScript interpreter in a web browser) to keep track of its place in a script that calls multiple functions â€” what function is currently being run, what functions are called from within that function and should be called next, etc.(è°ƒç”¨å †æ ˆæ˜¯ä¸€ç§æœºåˆ¶ï¼Œç”¨äºŽè§£é‡Šå™¨ï¼ˆå¦‚Webæµè§ˆå™¨ä¸­çš„JavaScriptè§£é‡Šå™¨ï¼‰è·Ÿè¸ªå…¶åœ¨è°ƒç”¨å¤šä¸ªå‡½æ•°çš„è„šæœ¬ä¸­çš„ä½ç½®â€”â€”å½“å‰æ­£åœ¨è¿è¡Œä»€ä¹ˆå‡½æ•°ã€åœ¨è¯¥å‡½æ•°ä¸­è°ƒç”¨ä»€ä¹ˆå‡½æ•°ä»¥åŠæŽ¥ä¸‹æ¥åº”è¯¥è°ƒç”¨ä»€ä¹ˆå‡½æ•°ï¼Œç­‰ç­‰ã€‚) When a script calls a function, the interpreter adds it to the call stack and then starts carrying out the function. Any functions that are called by that function are added to the call stack further up, and run where their calls are reached. When the current function is finished, the interpreter takes it off the stack and resumes execution where it left off in the last code listing. If the stack takes up more space than it had assigned to it, it results in a â€œstack overflowâ€ error. è°ƒç”¨æ ˆè°ƒç”¨æ ˆæ˜¯ä¸€ç§æ•°æ®ç»“æž„ã€‚ä»–è®°å½•äº†æˆ‘ä»¬åœ¨ç¨‹åºä¸­çš„ä½ç½®ï¼›å¦‚æžœæˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä»–å°±ä¼šå°†è¿™ä¸ªå‡½æ•°æŽ¨å…¥æ ˆé¡¶ï¼Œå½“æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°åŽï¼Œå°±ä¼šä»Žæ ˆé¡¶å¼¹å‡ºï¼Œè¿™å°±æ˜¯è°ƒç”¨æ ˆæ‰€åšçš„äº‹æƒ…ï¼› 12345678function multiply(x,y)&#123; return x * y;&#125;function printSquare(x)&#123; var s = multiply(x,x); console.log(s)&#125;printSquare(5); æ¯ä¸€ä¸ªè¿›å…¥è°ƒç”¨æ ˆçš„ç§°ä¸ºè°ƒç”¨å¸§ã€‚â€œå †æ ˆæº¢å‡ºâ€ï¼Œå½“ä½ è¾¾åˆ°è°ƒç”¨æ ˆçš„æœ€å¤§çš„å¤§å°çš„æ—¶å€™å°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼›è€Œä¸”è¿™ç›¸å½“å®¹æ˜“å‘ç”Ÿï¼Œç‰¹åˆ«æ˜¯åœ¨ä½ å†™é€’å½’çš„æ—¶å€™å´æ²¡æœ‰å…¨æ–¹ä½çš„æµ‹è¯•å®ƒã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š 12345function foo()&#123; foo();&#125;foo() ä»€ä¹ˆæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡å°±æ˜¯è¯„ä¼°å’Œæ‰§è¡ŒJavaScriptä»£ç çŽ¯å¢ƒçš„æŠ½è±¡æ¦‚å¿µã€‚æ¯å½“JavaScriptä»£ç åœ¨è¿è¡Œæ—¶ï¼Œä»–éƒ½æ˜¯åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­è¿è¡Œçš„ï¼› æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç±»åž‹ å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ è¿™æ˜¯é»˜è®¤æˆ–è€…è¯´åŸºç¡€çš„ä¸Šä¸‹æ–‡ï¼Œä»»ä½•ä¸åœ¨å‡½æ•°å†…éƒ¨çš„ä»£ç éƒ½åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­ã€‚å®ƒä¼šæ‰§è¡Œä¸¤ä»¶äº‹ï¼šåˆ›å»ºä¸€ä¸ªå…¨å±€çš„ window å¯¹è±¡ï¼ˆæµè§ˆå™¨çš„æƒ…å†µä¸‹ï¼‰ï¼Œå¹¶ä¸”è®¾ç½® this çš„å€¼ç­‰äºŽè¿™ä¸ªå…¨å±€å¯¹è±¡ã€‚ä¸€ä¸ªç¨‹åºä¸­åªä¼šæœ‰ä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ æ¯å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶, éƒ½ä¼šä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸Šä¸‹æ–‡ã€‚æ¯ä¸ªå‡½æ•°éƒ½æœ‰å®ƒè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä¸è¿‡æ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶åˆ›å»ºçš„ã€‚å‡½æ•°ä¸Šä¸‹æ–‡å¯ä»¥æœ‰ä»»æ„å¤šä¸ªã€‚æ¯å½“ä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«åˆ›å»ºï¼Œå®ƒä¼šæŒ‰å®šä¹‰çš„é¡ºåºï¼ˆå°†åœ¨åŽæ–‡è®¨è®ºï¼‰æ‰§è¡Œä¸€ç³»åˆ—æ­¥éª¤ evalå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ æ‰§è¡Œåœ¨ eval å‡½æ•°å†…éƒ¨çš„ä»£ç ä¹Ÿä¼šæœ‰å®ƒå±žäºŽè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä½†ç”±äºŽ JavaScript å¼€å‘è€…å¹¶ä¸ç»å¸¸ä½¿ç”¨ evalï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä¸ä¼šè®¨è®ºå®ƒ æ‰§è¡Œæ ˆæ‰§è¡Œæ ˆï¼Œä¹Ÿå°±æ˜¯åœ¨å…¶å®ƒç¼–ç¨‹è¯­è¨€ä¸­æ‰€è¯´çš„â€œè°ƒç”¨æ ˆâ€ï¼Œæ˜¯ä¸€ç§æ‹¥æœ‰ LIFOï¼ˆåŽè¿›å…ˆå‡ºï¼‰æ•°æ®ç»“æž„çš„æ ˆï¼Œè¢«ç”¨æ¥å­˜å‚¨ä»£ç è¿è¡Œæ—¶åˆ›å»ºçš„æ‰€æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚å½“ JavaScript å¼•æ“Žç¬¬ä¸€æ¬¡é‡åˆ°ä½ çš„è„šæœ¬æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€çš„æ‰§è¡Œä¸Šä¸‹æ–‡å¹¶ä¸”åŽ‹å…¥å½“å‰æ‰§è¡Œæ ˆã€‚æ¯å½“å¼•æ“Žé‡åˆ°ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œå®ƒä¼šä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å¹¶åŽ‹å…¥æ ˆçš„é¡¶éƒ¨ã€‚å¼•æ“Žä¼šæ‰§è¡Œé‚£äº›æ‰§è¡Œä¸Šä¸‹æ–‡ä½äºŽæ ˆé¡¶çš„å‡½æ•°ã€‚å½“è¯¥å‡½æ•°æ‰§è¡Œç»“æŸæ—¶ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡ä»Žæ ˆä¸­å¼¹å‡ºï¼ŒæŽ§åˆ¶æµç¨‹åˆ°è¾¾å½“å‰æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸Šä¸‹æ–‡ã€‚ æ€Žä¹ˆåˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Ÿ åœ¨ JavaScript ä»£ç æ‰§è¡Œå‰ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡å°†ç»åŽ†åˆ›å»ºé˜¶æ®µã€‚åœ¨åˆ›å»ºé˜¶æ®µä¼šå‘ç”Ÿä¸‰ä»¶äº‹ï¼š 1.this å€¼çš„å†³å®šï¼Œå³æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„ This ç»‘å®šã€‚2.åˆ›å»ºè¯æ³•çŽ¯å¢ƒç»„ä»¶ã€‚3.åˆ›å»ºå˜é‡çŽ¯å¢ƒç»„ä»¶ã€‚]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆå­¦è€…å¯èƒ½ä¸çŸ¥é“çš„vueæŠ€å·§]]></title>
    <url>%2F2018%2F10%2F21%2FVue%2F%E5%88%9D%E5%AD%A6%E8%80%85%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84vue%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[æŠ€å·§/å‘ç‚¹setTimeout/ setInterval åœºæ™¯ä¸€ ï¼šthisæŒ‡å‘æ”¹å˜æ— æ³•ç”¨thisè®¿é—®vueå®žä¾‹ 123456mounted()&#123; setTimeout( function () &#123; //setIntervalåŒç† console.log(this); //æ­¤æ—¶thisæŒ‡å‘Windowå¯¹è±¡ &#125;ï¼Œ1000) ;&#125; è§£å†³æ–¹æ³• :ä½¿ç”¨ç®­å¤´å‡½æ•°æˆ–è€…ç¼“å­˜this 123456789 //ç®­å¤´å‡½æ•°è®¿é—®thiså®žä¾‹å› ä¸ºç®­å¤´å‡½æ•°æœ¬èº«æ²¡æœ‰ç»‘å®šthis setTimeout(() =&gt; &#123; console. log(this);&#125;, 500) ; //ä½¿ç”¨å˜é‡è®¿é—®thiså®žä¾‹let self=this; &#125;,1000); setTimeout (function () &#123; console. log(self);//ä½¿ç”¨selfå˜é‡è®¿é—®thiså®žä¾‹ &#125;, 1000) ;â€‹ setIntervalè·¯ç”±è·³è½¬ç»§ç»­è¿è¡Œå¹¶æ²¡æœ‰é”€æ¯ åœºæ™¯ä¸€ :æ¯”å¦‚ä¸€äº›å¼¹å¹•ï¼Œèµ°é©¬ç¯æ–‡å­—ï¼Œè¿™ç±»éœ€è¦å®šæ—¶è°ƒç”¨çš„ï¼Œè·¯ç”±è·³è½¬ä¹‹åŽï¼Œå› ä¸ºç»„ä»¶å·²ç»é”€æ¯äº†ï¼Œä½†æ˜¯setlntervalè¿˜æ²¡æœ‰é”€æ¯ï¼Œè¿˜åœ¨ç»§ç»­åŽå°è°ƒç”¨ï¼ŒæŽ§åˆ¶å°ä¼šä¸æ–­æŠ¥é”™ï¼Œå¦‚æžœè¿ç®—é‡å¤§çš„è¯ï¼Œæ— æ³•åŠæ—¶æ¸…é™¤ï¼Œä¼šå¯¼è‡´ä¸¥é‡çš„é¡µé¢å¡é¡¿ã€‚ è§£å†³æ–¹æ³• :åœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸbeforeDestroyåœæ­¢setInterval 12345678910created() &#123; this.intervalid = setInterval(() =&gt; &#123; this.layerError = ""; this.Timer = null; &#125;, 100000); &#125;beforeDestroy( )&#123; //æˆ‘é€šå¸¸æ˜¯æŠŠsetInterval( )å®šæ—¶å™¨èµ‹å€¼ç»™thiså®žä¾‹ï¼Œç„¶åŽå°±å¯ä»¥åƒä¸‹é¢è¿™ä¹ˆæš‚åœã€‚ clearInterval(this.intervalid);&#125; Vueè·¯ç”±æ‹¦æˆªæµè§ˆå™¨åŽé€€å®žçŽ°è‰ç¨¿ä¿å­˜ç±»ä¼¼éœ€æ±‚ åœºæ™¯ä¸€ :ä¸ºäº†é˜²æ­¢ç”¨æˆ·çªç„¶ç¦»å¼€ï¼Œæ²¡æœ‰ä¿å­˜å·²è¾“å…¥çš„ä¿¡æ¯ è§£å†³æ–¹æ³• : 12345678910â€‹ //åœ¨è·¯ç”±ç»„ä»¶ä¸­:mounted()&#123;&#125;ï¼Œ beforeRouteLeave (to, from, next) &#123; if(ç”¨æˆ·å·²ç»è¾“å…¥ä¿¡æ¯)&#123; //å‡ºçŽ°å¼¹çª—æé†’ä¿å­˜è‰ç¨¿ï¼Œæˆ–è€…è‡ªåŠ¨åŽå°ä¸ºå…¶ä¿å­˜ &#125;else&#123; next(true);//ç”¨æˆ·ç¦»å¼€ &#125; &#125;â€‹ è‡ªå®šä¹‰ç»„ä»¶æ·»åŠ clickç­‰äº‹ä»¶ä¸ç”Ÿæ•ˆ åœºæ™¯ä¸€ :ä¸€äº›è‡ªå®šä¹‰ç»„ä»¶ï¼Œéœ€è¦é¢å¤–æ·»åŠ ä¸€äº›äº‹ä»¶æ¥å®žçŽ°ä¸€äº›ç‰¹å®šéœ€æ±‚ 123456789101112&lt;template&gt; &lt;el-progress type="circle" :percentage=â€œ0" @click=â€œstopProgressâ€&gt;&lt;/elprogress&gt;&lt;/template&gt;&lt;script&gt; export default &#123; methods:&#123; stopProgress() &#123; console.log('åœæ­¢') &#125; &#125; &#125;&lt;/script&gt; è§£å†³æ–¹æ³•:ä½¿ç”¨.nativeä¿®é¥°ç¬¦ 123456789101112&lt;template&gt; &lt;el-progress type="circle" :percentage=â€œ0" @click.native=â€œstopProgressâ€&gt;&lt;/el-progress&gt;&lt;/template&gt;&lt;script&gt; export default &#123; methods:&#123; stopProgress() &#123; console.log('åœæ­¢') &#125; &#125; &#125;&lt;/script&gt; æ‰‹åŠ¨æ“æŽ§è‡ªå®šä¹‰ç»„ä»¶ åœºæ™¯ä¸€ :ä¸€äº›è‡ªå®šä¹‰ç»„ä»¶ï¼Œéœ€è¦åŽ»èŽ·å–ç»„ä»¶å¯¹è±¡è¿›è¡Œä¸€äº›å…¶ä»–çš„Domæ“ä½œ è§£å†³æ–¹æ³• :ä½¿ç”¨refå±žæ€§æš´éœ²ç»„ä»¶èŽ·å–å¥æŸ„ 12345678â€‹ &lt;template&gt; &lt;el-progress type="circle" :percentage="O" ref="progress"&gt;&lt;/el-progress&gt;&lt;/template&gt; &lt;script&gt; this.$refs.progress //ç»„ä»¶å¯¹è±¡å®žä¾‹ï¼Œ å¯ä»¥æ‰‹åŠ¨è°ƒç”¨ç»„ä»¶çš„å†…ç½®æ–¹æ³•å’Œå±žæ€§ this.$refs.progress.$el //ç»„ä»¶ å¯¹è±¡çš„æœ€å¤–å±‚domå…ƒç´  &lt;/script&gt;â€‹ æ·±åº¦ä½œç”¨é€‰æ‹©å™¨ åœºæ™¯ä¸€ : scopedçš„æ ·å¼ï¼Œå¸Œæœ›å½±å“åˆ°å­ç»„ä»¶çš„é»˜è®¤æ ·å¼ åœ¨æ ·å¼ä¸­è®¾ç½®å®Œscopedåœ¨æµè§ˆå™¨è§£æžä¸ºå¦‚ä¸‹å›¾è¿™æ ·ï¼Œaæ˜¯ä¸ªdivï¼Œa divé‡Œé¢åŒ…å«ä¸€ä¸ªç»„ä»¶é‡Œé¢è§£æžå®Œäº†divçš„æ ·å¼åå­—ä¸ºbï¼Œæƒ³åœ¨çˆ¶ç»„ä»¶å½±å“åˆ°å­ç»„ä»¶çš„é»˜è®¤æ ·å¼ã€‚ è§£å†³æ–¹æ³•ï¼š 12345678â€‹ &lt;style scoped&gt; .a &gt;&gt;&gt; .b &#123; /* ... */ &#125; &lt;/style&gt; //æœ‰äº›åƒSassä¹‹ç±»çš„é¢„å¤„ç†å™¨æ— æ³•æ­£ç¡®è§£æž&gt;&gt;&gt;ã€‚è¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥ä½¿ç”¨/deep/æ“ä½œç¬¦å–è€Œä»£ä¹‹- - - -è¿™æ˜¯ä¸€ä¸ª&gt;&gt;&gt;çš„åˆ«åï¼ŒåŒæ ·å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ &lt;style scoped lang=â€œscssâ€&gt; .a /deep/ .b &#123; /* ... */ &#125; &lt;/style&gt; Vueæ•°ç»„/å¯¹è±¡æ›´æ–°è§†å›¾ä¸æ›´æ–° åœºæ™¯ä¸€ :å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¹ æƒ¯äºŽè¿™æ ·æ“ä½œæ•°ç»„å’Œå¯¹è±¡ 12345678910111213141516171819â€‹ data() &#123; return &#123; arr: [1,2,3], obj:&#123; a: 1, b: 2 &#125; &#125;; &#125;,â€‹ // æ•°ç»„æ›´æ–°è§†å›¾ä¸æ›´æ–° this.arr[0] = 'OBKoro1'; this.arr.length = 1; console.log(arr);// ['OBKoro1']; // æ•°æ®æ›´æ–°ï¼Œå¯¹è±¡è§†å›¾ä¸æ›´æ–° this.obj.c = 'OBKoro1'; delete this.obj.a; console.log(obj); // &#123;b:2,c:'OBKoro1'&#125; è§£å†³æ–¹æ³• ï¼š this. $set(ä½ è¦æ”¹å˜çš„æ•°ç»„/å¯¹è±¡ï¼Œä½ è¦æ”¹å˜çš„ä½ç½®/key,ä½ è¦æ”¹æˆä»€ä¹ˆvalue) æ•°ç»„åŽŸç”Ÿæ–¹æ³•è§¦å‘è§†å›¾æ›´æ–°ï¼ˆ vueå®˜ç½‘å¯æŸ¥ï¼‰: æ•´ä½“æ›¿æ¢æ•°ç»„/å¯¹è±¡ Vue Filtersè¿‡æ»¤å™¨çš„ä½¿ç”¨ åœºæ™¯ä¸€ :å¸¸è§çš„æ•°æ®æ–‡æœ¬çš„æ ¼å¼åŒ– 12345678910111213141516171819202122 // åœ¨åŒèŠ±æ‹¬å·ä¸­ &lt;div&gt;&#123;&#123; message | DateFormat &#125;&#125;&lt;/div&gt; //å±•ç¤ºæ­£ç¡®æ—¶é—´ // åœ¨'v-bind'ä¸­ &lt;div v-bind:id="rawId | formatId"&gt;&lt;/div&gt;â€‹// Demo:ä¸€ä¸ªæ—¥æœŸè¿‡æ»¤å™¨è¿”å›žyyyy- MM-ddhh:mm:ssçš„æ ·å¼// å¼•å…¥ä¸€ä¸ªæå‰å†™å¥½æ—¥æœŸæ ¼å¼åŒ–çš„js import dayjs from 'dayjs'; export default &#123; data() &#123; return &#123; //æ—¶é—´æ¯«ç§’ message:18324798324789 &#125; &#125;, filters: &#123; //ä¼ å…¥è¿›è¡Œæ—¥æœŸæ ¼å¼åŒ– DateFormat(value) &#123; return dayjs(value).format(â€œYYYY-MM-DD HH:mm:ss") &#125; &#125; &#125; Vueæ·±åº¦watchä¸Žwatchç«‹å³è§¦å‘å›žè°ƒ åœºæ™¯ä¸€ :åœ¨watché‡Œé¢ç›‘æµ‹å¯¹è±¡é‡Œé¢å¯¹åº”çš„å€¼æ˜¯ç›‘æµ‹ä¸åˆ°çš„ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•ã€‚ é€‰é¡¹: deep åœ¨é€‰é¡¹å‚æ•°ä¸­æŒ‡å®šdeep:true,å¯ä»¥ç›‘å¬å¯¹è±¡ä¸­å­å±žæ€§çš„å˜åŒ–ã€‚ é€‰é¡¹: immediate åœ¨é€‰é¡¹å‚æ•°ä¸­æŒ‡å®šimmediate:true,å°†ç«‹å³ä»¥è¡¨è¾¾å¼çš„å½“å‰å€¼è§¦å‘å›žè°ƒï¼Œä¹Ÿå°±æ˜¯é»˜è®¤è§¦å‘ä¸€æ¬¡ã€‚ 1234567891011121314watch: &#123; obj: &#123; handler(val, oldVal) &#123; console.log('å±žæ€§å˜åŒ–è§¦å‘è¿™ä¸ªå›žè°ƒ',val, oldVal); &#125;, deep: true // ç›‘æµ‹è¿™ä¸ªå¯¹è±¡ä¸­æ¯ä¸€ä¸ªå±žæ€§çš„å˜åŒ– &#125;, step: &#123; // å±žæ€§ //watch handler(val, oldVal) &#123; console.log("é»˜è®¤è§¦å‘ä¸€æ¬¡", val, oldVal); &#125;, immediate: true // é»˜è®¤è§¦å‘ä¸€æ¬¡ &#125;&#125;]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSSå¯¹æ¯” JavaScriptåŠ¨ç”»]]></title>
    <url>%2F2018%2F08%2F26%2F%E6%9D%82%E6%96%87%2FCSS%E5%AF%B9%E6%AF%94-JavaScript%E5%8A%A8%E7%94%BB%2F</url>
    <content type="text"><![CDATA[å‰è¨€åœ¨ç½‘é¡µä¸Šåˆ›å»ºåŠ¨ç”»æœ‰ä¸¤ç§ä¸»è¦æ–¹æ³•ï¼šä½¿ç”¨ CSS å’Œä½¿ç”¨ JavaScriptã€‚æ‚¨é€‰æ‹©å“ªç§æ–¹æ³•å®žé™…ä¸Šå–å†³äºŽé¡¹ç›®çš„å…¶ä»–ä¾èµ–å…³ç³»ï¼Œä»¥åŠæ‚¨å°è¯•å®žçŽ°ä»€ä¹ˆç±»åž‹çš„æ•ˆæžœã€‚ TL;DR ä½¿ç”¨ CSS åŠ¨ç”»æ¥å®žçŽ°è¾ƒç®€å•çš„â€œä¸€æ¬¡æ€§â€è½¬æ¢ï¼Œä¾‹å¦‚åˆ‡æ¢ UI å…ƒç´ çŠ¶æ€ã€‚ å½“æ‚¨éœ€è¦é«˜çº§æ•ˆæžœï¼ˆä¾‹å¦‚å¼¹è·³ã€åœæ­¢ã€æš‚åœã€å€’é€€æˆ–å‡é€Ÿï¼‰æ—¶ï¼Œè¯·ä½¿ç”¨ JavaScript åŠ¨ç”»ã€‚ å¦‚æžœé€‰æ‹©ä½¿ç”¨ JavaScript æ¥ç¼–å†™åŠ¨ç”»ï¼Œå¯é€‰ç”¨ Web Animations API æˆ–ç”¨èµ·æ¥é¡ºæ‰‹çš„çŽ°ä»£æ¡†æž¶ã€‚ å¤§å¤šæ•°åŸºæœ¬åŠ¨ç”»å¯ä»¥ä½¿ç”¨ CSS æˆ– JavaScript æ¥åˆ›å»ºï¼Œä½†å·¥ä½œé‡å’Œæ—¶é—´å°†æœ‰æ‰€ä¸åŒï¼ˆå¦è¯·å‚è€ƒ CSS å¯¹æ¯” JavaScript çš„æ€§èƒ½ï¼‰ã€‚æ¯ä¸€ç§æ–¹æ³•éƒ½æœ‰å…¶ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œä½†ä»¥ä¸‹å†…å®¹æ˜¯å¾ˆå¥½çš„æŒ‡å¯¼åŽŸåˆ™ï¼š å½“æ‚¨ä¸º UI å…ƒç´ é‡‡ç”¨è¾ƒå°çš„ç‹¬ç«‹çŠ¶æ€æ—¶ï¼Œä½¿ç”¨ CSSã€‚ CSS å˜æ¢å’ŒåŠ¨ç”»éžå¸¸é€‚åˆäºŽä»Žä¾§é¢å¼•å…¥å¯¼èˆªèœå•ï¼Œæˆ–æ˜¾ç¤ºå·¥å…·æç¤ºã€‚æœ€åŽï¼Œå¯ä»¥ä½¿ç”¨ JavaScript æ¥æŽ§åˆ¶çŠ¶æ€ï¼Œä½†åŠ¨ç”»æœ¬èº«æ˜¯é‡‡ç”¨ CSSã€‚ åœ¨éœ€è¦å¯¹åŠ¨ç”»è¿›è¡Œå¤§é‡æŽ§åˆ¶æ—¶ï¼Œä½¿ç”¨ JavaScriptã€‚ Web Animations API æ˜¯ä¸€ä¸ªåŸºäºŽæ ‡å‡†çš„æ–¹*æ³•ï¼ŒçŽ°å·²åœ¨ Chrome å’Œ Opera ä¸­æä¾›ã€‚è¯¥æ–¹æ³•å¯æä¾›å®žé™…å¯¹è±¡ï¼Œéžå¸¸é€‚åˆå¤æ‚çš„å¯¹è±¡å¯¼å‘åž‹åº”ç”¨ã€‚åœ¨éœ€è¦åœæ­¢ã€æš‚åœã€å‡é€Ÿæˆ–å€’é€€æ—¶ï¼ŒJavaScript ä¹Ÿéžå¸¸æœ‰ç”¨ã€‚ å¦‚æžœæ‚¨éœ€è¦æ‰‹åŠ¨åè°ƒæ•´ä¸ªåœºæ™¯ï¼Œå¯ç›´æŽ¥ä½¿ç”¨ requestAnimationFrameã€‚è¿™å±žäºŽé«˜çº§ JavaScript æ–¹æ³•ï¼Œä½†å¦‚æžœæ‚¨æž„å»ºæ¸¸æˆæˆ–ç»˜åˆ¶åˆ° HTML ç”»å¸ƒï¼Œåˆ™è¯¥æ–¹æ³•éžå¸¸æœ‰ç”¨ã€‚ æˆ–è€…ï¼Œå¦‚æžœæ‚¨å·²ä½¿ç”¨åŒ…æ‹¬åŠ¨ç”»åŠŸèƒ½çš„ JavaScript æ¡†æž¶ï¼Œæ¯”å¦‚é€šè¿‡ jQuery çš„ .animate() æ–¹æ³•æˆ– GreenSock çš„ TweenMaxï¼Œåˆ™å¯èƒ½å‘çŽ°ç»§ç»­ä½¿ç”¨è¯¥æ–¹æ³•å®žçŽ°åŠ¨ç”»åœ¨æ€»ä½“ä¸Šæ›´æ–¹ä¾¿ã€‚ ä½¿ç”¨ CSS ç¼–å†™åŠ¨ç”»ä½¿ç”¨ CSS ç¼–å†™åŠ¨ç”»æ˜¯ä½¿å†…å®¹åœ¨å±å¹•ä¸Šç§»åŠ¨çš„æœ€ç®€å•æ–¹å¼ã€‚æ­¤æ–¹æ³•è¢«ç§°ä¸ºå£°æ˜Žå¼ï¼Œå› ä¸ºæ‚¨å¯ä»¥æŒ‡å®šæ‚¨æƒ³è¦çš„ç»“æžœã€‚ ä»¥ä¸‹æ˜¯ä¸€äº› CSS ä»£ç ï¼Œè®©ä¸€ä¸ªå…ƒç´ åŒæ—¶åœ¨ X è½´å’Œ Y è½´ä¸Šç§»åŠ¨ 100pxã€‚å…¶å®žçŽ°æ–¹æ³•æ˜¯ä½¿ç”¨ CSS å˜æ¢ï¼Œç”¨æ—¶è®¾ç½®ä¸º 500 æ¯«ç§’ã€‚å½“æ·»åŠ äº† move ç±»æ—¶ï¼Œtransform å€¼è¢«æ”¹å˜å¹¶ä¸”å˜æ¢å¼€å§‹ã€‚ 123456789101112.box &#123; -webkit-transform: translate(0, 0); -webkit-transition: -webkit-transform 500ms; transform: translate(0, 0); transition: transform 500ms;&#125;.box.move &#123; -webkit-transform: translate(100px, 100px); transform: translate(100px, 100px);&#125; é™¤äº†å˜æ¢çš„æŒç»­æ—¶é—´ä¹‹å¤–ï¼Œè¿˜æœ‰é’ˆå¯¹ç¼“åŠ¨çš„é€‰é¡¹ï¼Œç¼“åŠ¨åŸºæœ¬ä¸Šæ˜¯åŠ¨ç”»è¡¨çŽ°çš„æ–¹å¼ å¦‚æžœåœ¨ä¸Šè¿°ä»£ç æ®µä¸­ï¼Œæ‚¨åˆ›å»ºå•ç‹¬çš„ CSS ç±»æ¥ç®¡ç†åŠ¨ç”»ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ JavaScript æ¥æ‰“å¼€å’Œå…³é—­æ¯ä¸ªåŠ¨ç”»ï¼š 1box.classList.add('move')ï¼› æ­¤æ“ä½œå°†ç»™æ‚¨çš„åº”ç”¨å¸¦æ¥è‰¯å¥½çš„å¹³è¡¡ã€‚æ‚¨å¯ä»¥ä¾§é‡äºŽä½¿ç”¨ JavaScript æ¥ç®¡ç†çŠ¶æ€ï¼Œåªéœ€åœ¨ç›®æ ‡å…ƒç´ ä¸Šè®¾ç½®ç›¸åº”çš„ç±»ï¼Œè®©æµè§ˆå™¨åŽ»å¤„ç†åŠ¨ç”»ã€‚å¦‚æžœæ‚¨æŒ‰ç…§è¿™ç§æ–¹æ³•ï¼Œåˆ™å¯ä»¥ä¾¦å¬å…ƒç´ çš„ transitionend äº‹ä»¶ï¼Œä½†å‰ææ˜¯æ‚¨èƒ½å¤Ÿæ”¾å¼ƒå¯¹ Internet Explorer è¾ƒæ—§ç‰ˆæœ¬çš„æ”¯æŒï¼›IE 10 æ˜¯æ”¯æŒè¿™äº›äº‹ä»¶çš„é¦–ä¸ªç‰ˆæœ¬ã€‚æ‰€æœ‰å…¶ä»–æµè§ˆå™¨å‡å·²æ”¯æŒæ­¤äº‹ä»¶æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚ ä¾¦å¬å˜æ¢ç»“æŸæ‰€éœ€çš„ JavaScript å¦‚ä¸‹æ‰€ç¤ºï¼š 123456var box = document.querySelector('.box');box.addEventListener('transitionend', onTransitionEnd, false);function onTransitionEnd() &#123; // Handle the transition finishing.&#125; é™¤äº†ä½¿ç”¨ CSS å˜æ¢ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ CSS åŠ¨ç”»ï¼Œè¿™å…è®¸æ‚¨å¯¹å•ä¸ªåŠ¨ç”»å…³é”®å¸§ã€æŒç»­æ—¶é—´å’Œè¿­ä»£è¿›è¡Œæ›´å¤šæŽ§åˆ¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä¸Žå˜æ¢ç›¸åŒçš„æ–¹å¼ä¸ºæ–¹æ¡†è®¾ç½®åŠ¨ç”»ï¼Œä½†æ˜¯è®¾ç½®åŠ¨ç”»æ—¶æ²¡æœ‰ä»»ä½•ç”¨æˆ·äº¤äº’ï¼ˆä¾‹å¦‚ç‚¹å‡»ï¼‰ï¼Œè€Œæ˜¯é‡‡ç”¨æ— é™é‡å¤ã€‚è¿˜å¯ä»¥åŒæ—¶æ›´æ”¹å¤šä¸ªå±žæ€§ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142/** * This is a simplified version without * vendor prefixes.With them included * (which you will need), things get far * more verbose! */.box &#123; /* Choose the animation */ animation-name: movingBox; /* The animationâ€™s duration */ animation-duration: 1300ms; /* The number of times we want the animation to run */ animation-iteration-count: infinite; /* Causes the animation to reverse on every odd iteration */ animation-direction: alternate;&#125;@keyframes movingBox &#123; 0% &#123; transform: translate(0, 0); opacity: 0.3; &#125; 25% &#123; opacity: 0.9; &#125; 50% &#123; transform: translate(100px, 100px); opacity: 0.2; &#125; 100% &#123; transform: translate(30px, 30px); opacity: 0.8; &#125;&#125; å€ŸåŠ© CSS åŠ¨ç”»ï¼Œå¯ç‹¬ç«‹äºŽç›®æ ‡å…ƒç´ æ¥å®šä¹‰åŠ¨ç”»æœ¬èº«ï¼Œå¹¶ä¸”ä½¿ç”¨ animation-name å±žæ€§æ¥é€‰æ‹©æ‰€éœ€çš„åŠ¨ç”»ã€‚ CSS åŠ¨ç”»åœ¨æŸç§ç¨‹åº¦ä¸Šä»é‡‡ç”¨ä¾›åº”å•†å‰ç¼€ï¼Œåœ¨ Safariã€Safari Mobile å’Œ Android æµè§ˆå™¨ä¸­ä½¿ç”¨-webkit-ã€‚Chromeã€Operaã€Internet Explorer å’Œ Firefox å‡ä¸é‡‡ç”¨å‰ç¼€ã€‚è®¸å¤šå·¥å…·å¯å¸®åŠ©æ‚¨åˆ›å»ºæ‰€éœ€çš„ CSS å‰ç¼€ç‰ˆæœ¬ï¼Œä½¿æ‚¨èƒ½å¤Ÿåœ¨æºæ–‡ä»¶ä¸­ç¼–å†™æ— å‰ç¼€çš„ç‰ˆæœ¬ã€‚ ä½¿ç”¨ JavaScript å’Œ Web Animations API ç¼–å†™åŠ¨ç”»æ¯”è¾ƒè€Œè¨€ï¼Œä½¿ç”¨ JavaScript åˆ›å»ºåŠ¨ç”»æ¯”ç¼–å†™ CSS å˜æ¢æˆ–åŠ¨ç”»æ›´å¤æ‚ï¼Œä½†å®ƒä¸€èˆ¬å¯ä¸ºå¼€å‘è€…æä¾›æ›´å¤šåŠŸèƒ½ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Web Animations API ç»™ç‰¹å®šçš„ CSS å±žæ€§è®¾ç½®åŠ¨ç”»ï¼Œæˆ–æž„å»ºå¯ç»„åˆçš„æ•ˆæžœå¯¹è±¡ã€‚ JavaScript åŠ¨ç”»æ˜¯å‘½ä»¤å¼ï¼Œå› ä¸ºæ‚¨å°†å®ƒä»¬ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†åµŒå…¥ä»£ç ä¸­ã€‚æ‚¨è¿˜å¯ä»¥å°†å®ƒä»¬å°è£…åœ¨å…¶ä»–å¯¹è±¡å†…ã€‚ä»¥ä¸‹æ˜¯åœ¨é‡æ–°åˆ›å»ºæˆ‘ä»¬ä¹‹å‰æ‰€è®¨è®ºçš„ CSS å˜æ¢æ—¶éœ€è¦ç¼–å†™çš„ JavaScriptï¼š 12345678var target = document.querySelector('.box');var player = target.animate([ &#123;transform: 'translate(0)'&#125;, &#123;transform: 'translate(100px, 100px)'&#125;], 500);player.addEventListener('finish', function() &#123; target.style.transform = 'translate(100px, 100px)';&#125;); é»˜è®¤æƒ…å†µä¸‹ï¼ŒWeb Animations ä»…ä¿®æ”¹å…ƒç´ çš„å‘ˆçŽ°å½¢å¼ã€‚å¦‚æžœæ‚¨æƒ³è®©æ‚¨çš„å¯¹è±¡ä¿æŒåœ¨å®ƒå·²ç§»åŠ¨åˆ°çš„ä½ç½®ï¼Œåˆ™åº”åœ¨åŠ¨ç”»å®Œæˆæ—¶ï¼ŒæŒ‰ç…§æˆ‘ä»¬çš„ç¤ºä¾‹ä¿®æ”¹å…¶åº•å±‚æ ·å¼ã€‚ Web Animations API æ˜¯æ¥è‡ª W3C çš„æ–°æ ‡å‡†ï¼Œåœ¨ Chrome å’Œ Opera ä¸­å—åŽŸç”Ÿæ”¯æŒï¼Œä¸”æ­£åœ¨è¿›è¡Œé’ˆå¯¹ Firefox çš„å¼€å‘ã€‚å¯¹äºŽå…¶ä»–çš„çŽ°ä»£æµè§ˆå™¨ï¼Œæä¾› polyfillã€‚ ä½¿ç”¨ JavaScript åŠ¨ç”»ï¼Œæ‚¨å¯ä»¥å®Œå…¨æŽ§åˆ¶å…ƒç´ åœ¨æ¯ä¸ªæ­¥éª¤çš„æ ·å¼ã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥åœ¨æ‚¨è®¤ä¸ºåˆé€‚æ—¶å‡æ…¢åŠ¨ç”»ã€æš‚åœåŠ¨ç”»ã€åœæ­¢åŠ¨ç”»ã€å€’é€€åŠ¨ç”»å’Œæ“çºµå…ƒç´ ã€‚å¦‚æžœæ‚¨æ­£åœ¨æž„å»ºå¤æ‚çš„å¯¹è±¡å¯¼å‘åž‹åº”ç”¨ï¼Œåˆ™æ­¤æ–¹æ³•ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºæ‚¨å¯ä»¥æ­£ç¡®å°è£…æ‚¨çš„è¡Œä¸ºã€‚]]></content>
      <categories>
        <category>æ‚æ–‡</category>
      </categories>
      <tags>
        <tag>æ‚æ–‡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ Redux-Saga ç®¡ç† React åº”ç”¨ä¸­çš„å¼‚æ­¥ action ï¼ˆä¸Šï¼‰]]></title>
    <url>%2F2018%2F08%2F21%2FReact%2FReact-saga%2F%E4%BD%BF%E7%94%A8-Redux-Saga-%E7%AE%A1%E7%90%86-React-%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E5%BC%82%E6%AD%A5-action-%EF%BC%88%E4%B8%8A%EF%BC%89%2F</url>
    <content type="text"><![CDATA[å‰è¨€å¯ä»¥ç”¨Donâ€™t call me, Iâ€™ll call youè¿™å¥è¯æ¥æ¯”å–»react-sagaã€‚ Generators å…ˆè¡Œï¼ä¸ºäº†ç†è§£ Sagasï¼Œæˆ‘ä»¬é¦–å…ˆè¦ç†è§£ä»€ä¹ˆæ˜¯ Generatorã€‚ä¸‹é¢æ˜¯ MDN å¯¹ Generator çš„æè¿°ï¼š Generator æ˜¯åœ¨æ‰§è¡Œæ—¶èƒ½æš‚åœï¼ŒåŽé¢åˆèƒ½ä»Žæš‚åœå¤„ç»§ç»­æ‰§è¡Œçš„å‡½æ•°ã€‚å®ƒçš„ä¸Šä¸‹æ–‡ä¼šåœ¨ç»§ç»­æ‰§è¡Œæ—¶ä¿å­˜ã€‚ ä½ å¯ä»¥æŠŠ Generator ç†è§£æˆä¸€ç§éåŽ†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ï¼Œï¼ˆè¯‘æ³¨ï¼šGenerator æ‰§è¡ŒåŽè¿”å›žçš„éåŽ†å™¨å¯¹è±¡ï¼‰æä¾›ä¸€ä¸ª next æ–¹æ³•ã€‚æ‰§è¡Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¿”å›žä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œæˆ–è€…è¿”å›žéåŽ†ç»“æŸçš„çŠ¶æ€ã€‚è¿™å°±éœ€è¦ Generator èƒ½å¤Ÿç»´æŠ¤å†…éƒ¨çŠ¶æ€ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ Generator ç¤ºä¾‹ï¼Œå®ƒç”Ÿæˆçš„éåŽ†å™¨å¯¹è±¡ä¼šè¿”å›žå‡ ä¸ªå­—ç¬¦ä¸²ï¼š 12345678910function * helloWorld()&#123; yield hello; yield world; return helloWorld;&#125;var f = helloWorld();f.next() // &#123;value:'hello',done:false&#125;f.next() // &#123;value:'world',done:false&#125;f.next() // &#123;value:'helloWorld',done:true&#125; next æ–¹æ³•çš„è¿”å›žå€¼ç»“æž„éžå¸¸ç®€å• â€” åªè¦æˆ‘ä»¬é€šè¿‡ yield/return è¿”å›žå€¼ï¼Œè¿™ä¸ªè¿”å›žå€¼å°±æ˜¯ value å±žæ€§çš„å€¼ã€‚å¦‚æžœæˆ‘ä»¬æ²¡æœ‰è¿”å›žå€¼ï¼Œvalue å±žæ€§çš„å€¼å°±æ˜¯ undefinedï¼Œdone å±žæ€§çš„å€¼å°±æ˜¯ trueã€‚è¿˜æœ‰ä¸€ç‚¹å€¼çš„æ³¨æ„çš„æ˜¯ï¼Œæ‰§è¡Œ helloWorld åŽï¼Œå‡½æ•°ä¼šåœ¨è°ƒç”¨ yield çš„åœ°æ–¹åœä¸‹æ¥ã€‚å½“æˆ‘ä»¬è°ƒç”¨ next æ–¹æ³•åŽï¼Œå‡½æ•°ä¼šç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª yieldã€‚å¦‚æžœæˆ‘ä»¬è°ƒç”¨äº† return è¯­å¥æˆ–è€…å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œdone å±žæ€§å°±ä¼šä¸ºçœŸã€‚ å¦‚æžœçŠ¶æ€åºåˆ—çš„é•¿åº¦ä¸ç¡®å®šæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥å†™ï¼š 123456var results = generator.next();while(!results.done)&#123; console.log(results.value); results = generator.next();&#125;console.log(results.value); ä»€ä¹ˆæ˜¯ Sagasï¼ŸSagas æ˜¯é€šè¿‡ Generator å‡½æ•°æ¥åˆ›å»ºçš„ã€‚å®˜æ–¹æ–‡æ¡£ çš„è§£é‡Šå¦‚ä¸‹ï¼š Saga å°±åƒåº”ç”¨ä¸­çš„ä¸€ä¸ªç‹¬ç«‹çº¿ç¨‹ï¼Œå®Œå…¨è´Ÿè´£ç®¡ç†å¼‚æ­¥ actionã€‚ ä½ å¯ä»¥æŠŠ Saga æƒ³è±¡æˆä¸€ä¸ªä»¥æœ€å¿«é€Ÿåº¦ä¸æ–­åœ°è°ƒç”¨ next æ–¹æ³•å¹¶å°è¯•èŽ·å–æ‰€æœ‰ yield è¡¨è¾¾å¼å€¼çš„çº¿ç¨‹ã€‚ä½ å¯èƒ½ä¼šé—®è¿™å’Œ React æœ‰ä»€ä¹ˆå…³ç³»ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒï¼Œæ‰€ä»¥é¦–å…ˆæ¥çœ‹çœ‹å¦‚ä½•åœ¨ React &amp; Redux åº”ç”¨ä½¿ç”¨ Sagaï¼šåœ¨ React &amp; Redux åº”ç”¨ä¸­ï¼Œä¸€ä¸ªå¸¸è§çš„ç”¨æ³•ä»Žè°ƒç”¨ä¸€ä¸ª action å¼€å§‹ã€‚è¢«åˆ†é…ç”¨æ¥å¤„ç†è¿™ä¸ª action çš„ reducer ä¼šä½¿ç”¨æ–°çš„ state æ›´æ–° storeï¼ŒéšåŽè§†å›¾å°±ä¼šè¢«æ›´æ–°æ¸²æŸ“ã€‚ å¦‚æžœä¸€ä¸ª Saga è¢«åˆ†é…ç”¨æ¥å¤„ç†è¿™ä¸ª action â€” è¿™ä¸ª action é€šå¸¸å°±æ˜¯ä¸ªå¼‚æ­¥ actionï¼ˆæ¯”å¦‚ä¸€ä¸ªå¯¹æœåŠ¡ç«¯çš„è¯·æ±‚ï¼‰ï¼Œä¸€æ—¦è¿™ä¸ª action å®ŒæˆåŽï¼ŒSaga ä¼šè°ƒç”¨å¦ä¸€ä¸ª action è®© reducer è¿›è¡Œå¤„ç†ã€‚ å¸¸è§ç”¨ä¾‹æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå¸¸è§æµç¨‹æ¥è¯´æ˜Žï¼šç”¨æˆ·ä¸Žé¡µé¢è¿›è¡Œäº¤äº’ï¼Œè¿™ä¸ªäº¤äº’åŠ¨ä½œä¼šè§¦å‘ä¸€ä¸ªä»ŽæœåŠ¡ç«¯è¯·æ±‚æ•°æ®çš„åŠ¨ä½œ(æ­¤æ—¶é¡µé¢æ˜¾ç¤º loading æç¤º)ï¼Œæœ€ç»ˆæˆ‘ä»¬ç”¨è¯·æ±‚å›žæ¥çš„æ•°æ®åŽ»æ¸²æŸ“é¡µé¢çš„å†…å®¹ã€‚è®©æˆ‘ä»¬ä¸ºæ¯æ­¥åˆ›å»ºä¸€ä¸ª actionï¼Œç„¶åŽç”¨ Redux-Saga å®žçŽ°ä¸€ä¸ªç®€åŒ–çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼š 123456// saga.jsimport &#123; take &#125; from 'redux-saga/effects'function* mySaga()&#123; yield take(USER_INTERACTED_WITH_UI_ACTION);&#125; è¿™ä¸ª Saga çš„å‡½æ•°åå«åš mySagaã€‚å®ƒè°ƒç”¨äº† Redux-Saga effect çš„ take æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šé˜»å¡ž Saga çš„æ‰§è¡Œï¼Œç›´åˆ°æœ‰äººè°ƒç”¨äº†ä½œä¸ºå‚æ•°çš„é‚£ä¸ª actionï¼ŒSaga çš„æ‰§è¡Œä¹Ÿä¼šç»“æŸï¼Œå°±åƒæˆ‘ä»¬å‰é¢çœ‹åˆ°çš„ Generator ä¸€æ ·ï¼ˆdone å˜ä¸º trueï¼‰ã€‚ çŽ°åœ¨æˆ‘ä»¬è¦è®©é¡µé¢å±•ç¤º loading æç¤ºæ¥å“åº”è¿™ä¸ª actionã€‚å¯ä»¥é€šè¿‡ put æ–¹æ³•è°ƒç”¨å¦ä¸€ä¸ª actionï¼Œç„¶åŽåˆ†é… reducer æ¥å¤„ç†ï¼Œä»Žè€Œå®Œæˆä¸Šè¿°åŠŸèƒ½ã€‚å¦‚ä¸‹ï¼š 1234567891011121314// saga.jsimport &#123; take, put &#125; from 'redux-saga/effects'function* mySaga()&#123; yield take(USER_INTERACTED_WITH_UI_ACTION); yield put(SHOW_LOADING_ACTION, &#123;isLoading: true&#125;);&#125;// reducer.js...case SHOW_LOADING_ACTION: (state, isLoading) =&gt; &#123; return Object.assign(&#123;&#125;, state, &#123;showLoading: isLoading&#125;);&#125;... ä¸‹ä¸€æ­¥æ˜¯è°ƒç”¨ call æ–¹æ³•ï¼Œå®ƒæŽ¥æ”¶ä¸€ä¸ªå‡½æ•°å’Œä¸€ç»„å‚æ•°ï¼Œä½¿ç”¨è¿™äº›å‚æ•°æ¥æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬ç»™ call æ–¹æ³•ä¼ é€’ä¸€ä¸ªè¯·æ±‚æœåŠ¡ç«¯å¹¶è¿”å›žä¸€ä¸ª Promise çš„ GET å‡½æ•°ï¼Œå®ƒä¼šä¿å­˜è¯·æ±‚ç»“æžœï¼š 12345678910111213141516// saga.jsimport &#123; take, put, call &#125; from 'redux-saga/effects'function* mySaga()&#123; yield take(USER_INTERACTED_WITH_UI_ACTION); yield put(SHOW_LOADING_ACTION, &#123;isLoading: true&#125;); const data = yield call(GET, 'https://my.server.com/getdata'); yield put(SHOW_DATA_ACTION, &#123;data: data&#125;);&#125;// reducer.js...case SHOW_DATA_ACTION: (state, data) =&gt; &#123; return Object.assign(&#123;&#125;, state, &#123;data: data, showLoading: false&#125;;&#125;... é€šè¿‡è°ƒç”¨ SHOW_DATA_ACTION æ¥ç”¨æŽ¥æ”¶çš„æ•°æ®æ›´æ–°é¡µé¢ã€‚ åˆšåˆšå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿåº”ç”¨å¯åŠ¨åŽï¼Œæ‰€æœ‰çš„ Sagas éƒ½ä¼šè¢«æ‰§è¡Œï¼Œä½ å¯ä»¥è®¤ä¸ºä¸€ç›´åœ¨è°ƒç”¨ next æ–¹æ³•ç›´åˆ°ç»“æŸã€‚take æ–¹æ³•ç±»ä¼¼äºŽçº¿ç¨‹æŒ‚èµ·çš„ä½œç”¨ï¼Œä¸€æ—¦è°ƒç”¨äº†USER_INTERACTED_WITH_UI_ACTIONï¼Œçº¿ç¨‹å°±ä¼šæ¢å¤æ‰§è¡Œã€‚ ç„¶åŽï¼Œæˆ‘ä»¬ç»§ç»­è°ƒç”¨ SHOW_LOADING_ACTIONï¼Œreducer ä¼šå¤„ç†è¿™ä¸ª actionã€‚ç”±äºŽ Saga è¿˜åœ¨ç»§ç»­è¿è¡Œï¼Œcall æ–¹æ³•ä¼šå‘èµ·å¯¹æœåŠ¡ç«¯çš„è¯·æ±‚ï¼ŒSaga ä¼šåœ¨å†æ¬¡æŒ‚èµ·ï¼Œç›´åˆ°è¯·æ±‚ç»“æŸã€‚ æ¯æ¬¡éƒ½ä½¿ç”¨åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒSaga åªå¤„ç†äº†ä¸€ä¸ªç”¨æˆ·äº¤äº’çš„ actionï¼Œå› ä¸ºæˆ‘ä»¬ç”¨ put æ–¹æ³•æ‰§è¡Œäº† SHOW_DATA_ACTION è¿™ä¸ª actionï¼Œç„¶åŽåŽé¢å°±æ²¡æœ‰ yield äº†ï¼ˆdone å°±æ˜¯ true äº†å¯¹å§ï¼Ÿï¼‰ã€‚å¦‚æžœæˆ‘ä»¬å¸Œæœ›åœ¨æ¯æ¬¡è°ƒç”¨ USER_INTERACTED_WITH_UI_ACTION è¿™ä¸ª action çš„æ—¶å€™ï¼Œéƒ½ä¼šæ‰§è¡Œè¿™ä¸€ç³»åˆ—çš„ actionsï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ while(true) è¯­å¥æ¥åŒ…è£¹ Saga å†…éƒ¨çš„é€»è¾‘ä»£ç ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021// saga.jsimport &#123; take, put, call &#125; from 'redux-saga/effects'1. function* mySaga()&#123;2. while (true)&#123;3. yield take(USER_INTERACTED_WITH_UI_ACTION);4. yield put(SHOW_LOADING_ACTION, &#123;isLoading: true&#125;);5. const data = yield call(GET, 'https://my.server.com/getdata');6. yield put(SHOW_DATA_ACTION, &#123;data: data&#125;);7. &#125;8. &#125;// reducer.js...case SHOW_LOADING_ACTION: (state, isLoading) =&gt; &#123; return Object.assign(&#123;&#125;, state, &#123;showLoading: isLoading&#125;);&#125;,case SHOW_DATA_ACTION: (state, data) =&gt; &#123; return Object.assign(&#123;&#125;, state, &#123;data: data, showLoading: false&#125;;&#125;... è¿™ä¸ªæ— é™å¾ªçŽ¯ä¸ä¼šé€ æˆå †æ ˆæº¢å‡ºï¼Œä¹Ÿä¸ä¼šä½¿ä½ çš„åº”ç”¨å´©æºƒï¼å› ä¸º take æ–¹æ³•å°±åƒçº¿ç¨‹æŒ‚èµ·ä¸€æ ·ï¼ŒmySaga æ‰§è¡ŒåŽä¼šä¸€ç›´ä¿æŒ pending çŠ¶æ€ï¼Œç›´åˆ°é‚£ä¸ª action è¢«è§¦å‘ã€‚ä¸‹æ¬¡é‡æ–°è¿›å…¥å¾ªçŽ¯åŽï¼Œä¹Ÿä¼šé‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚ è®©æˆ‘ä»¬ä¸€æ­¥æ­¥åœ°çœ‹ä¸€ä¸‹ä¸Šé¢çš„è¿‡ç¨‹ï¼š 1.åº”ç”¨å¯åŠ¨ï¼Œæ‰§è¡Œæ‰€æœ‰ Sagasã€‚2.mySaga è¿è¡Œï¼Œè¿›å…¥ while(true) å¾ªçŽ¯ï¼Œåœ¨ç¬¬ 3 è¡ŒæŒ‚èµ·ã€‚3.USER_INTERACTED_WITH_UI_ACTION è¿™ä¸ª action è¢«è§¦å‘ã€‚4.Saga çš„çº¿ç¨‹æ¿€æ´»ï¼Œæ‰§è¡Œç¬¬ 4 è¡Œï¼Œè§¦å‘ SHOW_LOADING_ACTION è¿™ä¸ª actionï¼Œç„¶åŽåˆ†é…çš„ reducer è¿›è¡Œå¤„ç†ï¼ˆreducer å¤„ç†åŽï¼Œé¡µé¢å°±ä¼šæ˜¾ç¤º loading æç¤ºï¼‰ã€‚5.å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼ˆç¬¬ 5 è¡Œï¼‰ï¼Œç„¶åŽä¼šå†æ¬¡æŒ‚èµ·ï¼Œç›´åˆ°è¯·æ±‚çš„ Promise å˜ä¸º resolvedï¼Œè¯·æ±‚ç»“æžœçš„æ•°æ®ä¼šèµ‹å€¼ç»™ data å˜é‡ã€‚6.SHOW_DATA_ACTION æŽ¥æ”¶ data ä½œä¸ºå‚æ•°è¢«è§¦å‘ï¼Œç„¶åŽ reducer å°±å¯ä»¥ä½¿ç”¨è¿™äº›æ•°æ®æ¥æ›´æ–°é¡µé¢ã€‚å†æ¬¡è¿›å…¥å¾ªçŽ¯ï¼Œå›žåˆ°ç¬¬ 2 æ­¥ã€‚ æŽ¥ä¸‹æ¥åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Redux-Saga ç›¸å…³çš„åŸºæœ¬æ¦‚å¿µï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ React åº”ç”¨ä¸­ä½¿ç”¨å®ƒã€‚ä¸‹ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šå±•ç¤ºåœ¨å®žé™…åº”ç”¨ä¸­ä½¿ç”¨å®ƒèŽ·å¾—çš„ä»·å€¼ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React-saga</category>
      </categories>
      <tags>
        <tag>React-saga</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javascriptå¼‚æ­¥ç¼–ç¨‹(generatorå’Œasync)]]></title>
    <url>%2F2018%2F08%2F20%2FJs%2FJavascript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%EF%BC%88generator%E5%92%8Casync%EF%BC%89%2F</url>
    <content type="text"><![CDATA[å‰è¨€ä»ŽPromiseå¼€å§‹ï¼ŒJavaScriptå°±åœ¨å¼•å…¥æ–°åŠŸèƒ½ï¼Œæ¥å¸®åŠ©æ›´ç®€å•çš„æ–¹æ³•æ¥å¤„ç†å¼‚æ­¥ç¼–ç¨‹ï¼Œå¸®åŠ©æˆ‘ä»¬è¿œç¦»å›žè°ƒåœ°ç‹±ã€‚Promiseæ˜¯ä¸‹è¾¹è¦è®²çš„Generator/yieldä¸Žasync/awaitçš„åŸºç¡€ï¼Œå¸Œæœ›ä½ å·²ç»æå‰äº†è§£äº†å®ƒã€‚ åœ¨å¤§æ¦‚ES6çš„æ—¶ä»£ï¼ŒæŽ¨å‡ºäº†Generator/yieldä¸¤ä¸ªå…³é”®å­—ï¼Œä½¿ç”¨Generatorå¯ä»¥å¾ˆæ–¹ä¾¿çš„å¸®åŠ©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå¤„ç†Promiseçš„è§£é‡Šå™¨ã€‚ ç„¶åŽï¼Œåœ¨ES7å·¦å³ï¼Œæˆ‘ä»¬åˆå¾—åˆ°äº†async/awaitè¿™æ ·çš„è¯­æ³•ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä»¥æŽ¥è¿‘ç¼–å†™åŒæ­¥ä»£ç çš„æ–¹å¼æ¥ç¼–å†™å¼‚æ­¥ä»£ç ï¼ˆæ— éœ€ä½¿ç”¨.then()æˆ–è€…å›žè°ƒå‡½æ•°ï¼‰ã€‚ ä¸¤è€…éƒ½èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¾ˆæ–¹ä¾¿çš„è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹ï¼Œä½†åŒæ ·ï¼Œè¿™ä¸¤è€…ä¹‹é—´ä¹Ÿæ˜¯æœ‰ä¸å°‘åŒºåˆ«çš„ã€‚ generatorGeneratoræ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥åœ¨å‡½æ•°å†…éƒ¨é€šè¿‡yieldè¿”å›žä¸€ä¸ªå€¼ï¼ˆæ­¤æ—¶ï¼ŒGeneratorå‡½æ•°çš„æ‰§è¡Œä¼šæš‚å®šï¼Œç›´åˆ°ä¸‹æ¬¡è§¦å‘.next()ï¼‰åˆ›å»ºä¸€ä¸ªGeneratorå‡½æ•°çš„æ–¹æ³•æ˜¯åœ¨functionå…³é”®å­—åŽæ·»åŠ *æ ‡è¯†ã€‚ åœ¨è°ƒç”¨ä¸€ä¸ªGeneratorå‡½æ•°åŽï¼Œå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼Œå‡½æ•°ä¼šè¿”å›žä¸€ä¸ªGeneratorå¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨å¯¹è±¡çš„nextå‡½æ•°ï¼Œå¯ä»¥èŽ·å¾—yield/returnçš„è¿”å›žå€¼ã€‚æ— è®ºæ˜¯è§¦å‘äº†yieldè¿˜æ˜¯returnï¼Œnext()å‡½æ•°æ€»ä¼šè¿”å›žä¸€ä¸ªå¸¦æœ‰valueå’Œdoneå±žæ€§çš„å¯¹è±¡ã€‚ valueä¸ºè¿”å›žå€¼ï¼Œdoneåˆ™æ˜¯ä¸€ä¸ªBooleanå¯¹è±¡ï¼Œç”¨æ¥æ ‡è¯†Generatoræ˜¯å¦è¿˜èƒ½ç»§ç»­æä¾›è¿”å›žå€¼ã€‚ PS: generator()å‡½æ•°çš„æ‰§è¡Œæ˜¯æƒ°æ€§çš„ï¼ŒyieldåŽçš„ä»£ç åªåœ¨è§¦å‘next()åŽæ‰§è¡Œ 123456789101112function * oddGenerator () &#123; yield 1 yield 3 return 5&#125;let iterator = oddGenerator()let first = iterator.next() // &#123; value: 1, done: false &#125;let second = iterator.next() // &#123; value: 3, done: false &#125;let third = iterator.next() // &#123; value: 5, done: true &#125; next()çš„å‚æ•°ä¼ é€’æˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨next()çš„æ—¶å€™ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥åœ¨ä¸Šæ¬¡yieldå‰æŽ¥æ”¶åˆ°è¿™ä¸ªå‚æ•°ï¼š 123456789101112function * outputGenerator () &#123; let ret1 = yield 1 console.log(`got ret1: $&#123;ret1&#125;`) let ret2 = yield 2 console.log(`got ret2: $&#123;ret2&#125;`)&#125;let iterator = outputGenerator()iterator.next(1)iterator.next(2) // got ret1: 2iterator.next(3) // got ret2: 3 ç¬¬ä¸€çœ¼çœ‹ä¸ŠåŽ»å¯èƒ½ä¼šæœ‰äº›è¯¡å¼‚ï¼Œä¸ºä»€ä¹ˆç¬¬ä¸€æ¡logæ˜¯åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨nextæ—¶æ‰è¿›è¡Œè¾“å‡ºçš„ è¿™å°±åˆè¦è¯´åˆ°ä¸Šè¾¹çš„Generatorçš„å®žçŽ°äº†ï¼Œä¸Šè¾¹è¯´åˆ°äº†ï¼Œyieldä¸Žreturnéƒ½æ˜¯ç”¨æ¥è¿”å›žå€¼çš„è¯­æ³•ã€‚å‡½æ•°åœ¨æ‰§è¡Œæ—¶é‡åˆ°è¿™ä¸¤ä¸ªå…³é”®å­—åŽå°±ä¼šæš‚åœæ‰§è¡Œï¼Œç­‰å¾…ä¸‹æ¬¡æ¿€æ´»ã€‚ ç„¶åŽlet ret1 = yield 1ï¼Œè¿™æ˜¯ä¸€ä¸ªèµ‹å€¼è¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šå…ˆæ‰§è¡Œ=å³è¾¹çš„éƒ¨åˆ†ï¼Œåœ¨=å³è¾¹æ‰§è¡Œçš„è¿‡ç¨‹ä¸­é‡åˆ°äº†yieldå…³é”®å­—ï¼Œå‡½æ•°ä¹Ÿå°±åœ¨æ­¤å¤„æš‚åœäº†ï¼Œåœ¨ä¸‹æ¬¡è§¦å‘next()æ—¶æ‰è¢«æ¿€æ´»ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬ç»§ç»­è¿›è¡Œä¸Šæ¬¡æœªå®Œæˆçš„èµ‹å€¼è¯­å¥let ret1 = XXXï¼Œå¹¶åœ¨å†æ¬¡é‡åˆ°yieldæ—¶æš‚åœã€‚ è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆç¬¬äºŒæ¬¡è°ƒç”¨next()çš„å‚æ•°ä¼šè¢«ç¬¬ä¸€æ¬¡yieldèµ‹å€¼çš„å˜é‡æŽ¥æ”¶åˆ° ç”¨ä½œè¿­ä»£å™¨ä½¿ç”¨å› ä¸ºGeneratorå¯¹è±¡æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ç”¨äºŽfor...ofå¾ªçŽ¯ï¼š ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œç”¨ä½œè¿­ä»£å™¨ä¸­çš„ä½¿ç”¨ï¼Œåˆ™åªä¼šä½œç”¨äºŽyield,returnçš„è¿”å›žå€¼ä¸è®¡å…¥è¿­ä»£ 1234567891011121314function * oddGenerator () &#123; yield 1 yield 3 yield 5 return 'won\'t be iterate'&#125;for (let value of oddGenerator()) &#123; console.log(value)&#125;// &gt; 1// &gt; 3// &gt; 5 Generatorå‡½æ•°å†…éƒ¨çš„Generatoré™¤äº†yieldè¯­æ³•ä»¥å¤–ï¼Œå…¶å®žè¿˜æœ‰ä¸€ä¸ªyield*è¯­æ³•ï¼Œå¯ä»¥ç²—ç•¥çš„ç†è§£ä¸ºæ˜¯ Generatorå‡½æ•°ç‰ˆçš„[â€¦]ç”¨æ¥å±•å¼€Generatorè¿­ä»£å™¨çš„ã€‚ 123456789101112131415161718192021function * gen1 () &#123; yield 1 yield* gen2() yield 5&#125;function * gen2 () &#123; yield 2 yield 3 yield 4 return 'won\'t be iterate'&#125;for (let value of gen1()) &#123; console.log(value)&#125;// &gt; 1// &gt; 2// &gt; 3// &gt; 4// &gt; 5 æ¨¡æ‹Ÿå®žçŽ°Promiseæ‰§è¡Œå™¨ç„¶åŽæˆ‘ä»¬ç»“åˆç€Promiseï¼Œæ¥å®žçŽ°ä¸€ä¸ªç®€æ˜“çš„æ‰§è¡Œå™¨ã€‚ æœ€å—æ¬¢è¿Žçš„ç±»ä¼¼çš„åº“æ˜¯ï¼š co 123456789101112131415161718192021222324252627282930313233function run (gen) &#123; gen = gen() return next(gen.next()) function next (&#123;done, value&#125;) &#123; return new Promise(resolve =&gt; &#123; if (done) &#123; // finish resolve(value) &#125; else &#123; // not yet value.then(data =&gt; &#123; next(gen.next(data)).then(resolve) &#125;) &#125; &#125;) &#125;&#125;function getRandom () &#123; return new Promise(resolve =&gt; &#123; setTimeout(_ =&gt; resolve(Math.random() * 10 | 0), 1000) &#125;)&#125;function * main () &#123; let num1 = yield getRandom() let num2 = yield getRandom() return num1 + num2&#125;run(main).then(data =&gt; &#123; console.log(`got data: $&#123;data&#125;`);&#125;) ä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨çš„æ¨¡æ‹Ÿï¼ˆä»…ä½œä¸¾ä¾‹è¯´æ˜Žï¼‰ åœ¨ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çº¦å®šyieldåŽè¾¹çš„å¿…ç„¶æ˜¯ä¸€ä¸ªPromiseå‡½æ•°æˆ‘ä»¬åªçœ‹main()å‡½æ•°çš„ä»£ç ï¼Œä½¿ç”¨Generatorç¡®å®žèƒ½å¤Ÿè®©æˆ‘ä»¬è®©è¿‘ä¼¼åŒæ­¥çš„æ–¹å¼æ¥ç¼–å†™å¼‚æ­¥ä»£ç ä½†æ˜¯ï¼Œè¿™æ ·å†™å°±æ„å‘³ç€æˆ‘ä»¬å¿…é¡»æœ‰ä¸€ä¸ªå¤–éƒ¨å‡½æ•°è´Ÿè´£å¸®æˆ‘ä»¬æ‰§è¡Œmain()å‡½æ•°è¿™ä¸ªGeneratorï¼Œå¹¶å¤„ç†å…¶ä¸­ç”Ÿæˆçš„Promiseï¼Œç„¶åŽåœ¨thenå›žè°ƒä¸­å°†ç»“æžœè¿”å›žåˆ°Generatorå‡½æ•°ï¼Œä»¥ä¾¿å¯ä»¥æ‰§è¡Œä¸‹è¾¹çš„ä»£ç ã€‚ asyncæˆ‘ä»¬ç”¨ä½œasync/awiaté‡å†™ä¸Šé¢generatorçš„ä¾‹å­ï¼š 12345678910111213function getRandom () &#123; return new Promise(resolve =&gt; &#123; setTimeout(_ =&gt; resolve(Math.random() * 10 | 0), 1000) &#125;)&#125;async function main () &#123; let num1 = await getRandom() let num2 = await getRandom() return num1 + num2&#125;console.log(`got data: $&#123;await main()&#125;`) è¿™æ ·çœ‹ä¸ŠåŽ»ï¼Œå¥½åƒæˆ‘ä»¬ä»ŽGenerator/yieldæ¢åˆ°async/awaitåªéœ€è¦æŠŠ*éƒ½æ”¹ä¸ºasyncï¼Œyieldéƒ½æ”¹ä¸ºawaitå°±å¯ä»¥äº†ã€‚ æ‰€ä»¥å¾ˆå¤šäººéƒ½ç›´æŽ¥æ‹¿Generator/yieldæ¥è§£é‡Šasync/awaitçš„è¡Œä¸ºï¼Œä½†è¿™ä¼šå¸¦æ¥å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ï¼š Generatoræœ‰å…¶ä»–çš„ç”¨é€”ï¼Œè€Œä¸ä»…ä»…æ˜¯ç”¨æ¥å¸®åŠ©ä½ å¤„ç†Promise è¿™æ ·çš„è§£é‡Šè®©é‚£äº›ä¸ç†Ÿæ‚‰è¿™ä¸¤è€…çš„äººç†è§£èµ·æ¥æ›´å›°éš¾ï¼ˆå› ä¸ºä½ è¿˜è¦åŽ»è§£é‡Šé‚£äº›ç±»ä¼¼coçš„åº“ï¼‰ async/awaitæ˜¯ å¤„ç†Promiseçš„ä¸€ä¸ªæžå…¶æ–¹ä¾¿çš„æ–¹æ³•ï¼Œä½†å¦‚æžœä½¿ç”¨ä¸å½“çš„è¯ï¼Œä¹Ÿä¼šé€ æˆä¸€äº›ä»¤äººå¤´ç–¼çš„é—®é¢˜ Asyncå‡½æ•°å§‹ç»ˆè¿”å›žä¸€ä¸ªPromiseä¸€ä¸ªasyncå‡½æ•°ï¼Œæ— è®ºä½ return 1æˆ–è€…throw new Error()ã€‚åœ¨è°ƒç”¨æ–¹æ¥è®²ï¼ŒæŽ¥æ”¶åˆ°çš„å§‹ç»ˆæ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼š 123456789async function throwError () &#123; throw new Error()&#125;async function returnNumber () &#123; return 1&#125;console.log(returnNumber() instanceof Promise) // trueconsole.log(throwError() instanceof Promise) // true ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºå‡½æ•°æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œä½ éƒ½è¦æŒ‰ç…§Promiseçš„æ–¹å¼æ¥å¤„ç†å®ƒã€‚ Awaitæ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„ï¼Œå¹¶ä¸èƒ½å¹¶è¡Œæ‰§è¡ŒJavaScriptæ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™å°±æ„å‘³ç€awaitä¸€åªèƒ½ä¸€æ¬¡å¤„ç†ä¸€ä¸ªï¼Œå¦‚æžœä½ æœ‰å¤šä¸ªPromiseéœ€è¦å¤„ç†ï¼Œåˆ™å°±æ„å‘³ç€ï¼Œä½ è¦ç­‰åˆ°å‰ä¸€ä¸ªPromiseå¤„ç†å®Œæˆæ‰èƒ½è¿›è¡Œä¸‹ä¸€ä¸ªçš„å¤„ç†ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå¦‚æžœæˆ‘ä»¬åŒæ—¶å‘é€å¤§é‡çš„è¯·æ±‚ï¼Œè¿™æ ·å¤„ç†å°±ä¼šéžå¸¸æ…¢ï¼Œone by oneï¼š 1234const bannerImages = [];async function getImageInfo()&#123; return bannerImages.map(async banner =&gt; await getImageInfo(banner));&#125; å°±åƒè¿™æ ·çš„å››ä¸ªå®šæ—¶å™¨ï¼Œæˆ‘ä»¬éœ€è¦ç­‰å¾…4sæ‰èƒ½æ‰§è¡Œå®Œæ¯•ï¼š 123456789101112131415function delay () &#123; return new Promise(resolve =&gt; setTimeout(resolve, 1000))&#125;let tasks = [1, 2, 3, 4]async function runner (tasks) &#123; for (let task of tasks) &#123; await delay() &#125;&#125;console.time('runner')await runner(tasks)console.timeEnd('runner') åƒè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Promise.all()è¿›è¡Œå¦‚ä¸‹ä¼˜åŒ–ï¼š 1234567891011121314function delay () &#123; return new Promise(resolve =&gt; setTimeout(resolve, 1000))&#125;let tasks = [1, 2, 3, 4]async function runner (tasks) &#123; tasks = tasks.map(delay) await Promise.all(tasks)&#125;console.time('runner')await runner(tasks)console.timeEnd('runner') è‰æ¡ˆä¸­æåˆ°è¿‡await*ï¼Œä½†çŽ°åœ¨è²Œä¼¼è¿˜ä¸æ˜¯æ ‡å‡†ï¼Œæ‰€ä»¥è¿˜æ˜¯é‡‡ç”¨Promise.allåŒ…è£¹ä¸€å±‚çš„æ–¹æ³•æ¥å®žçŽ° æˆ‘ä»¬çŸ¥é“ï¼ŒPromiseå¯¹è±¡åœ¨åˆ›å»ºæ—¶å°±ä¼šæ‰§è¡Œå‡½æ•°å†…éƒ¨çš„ä»£ç ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨mapåˆ›å»ºè¿™ä¸ªæ•°ç»„æ—¶ï¼Œæ‰€æœ‰çš„Promiseä»£ç éƒ½ä¼šæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šåŒæ—¶å‘å‡ºåŽ»ï¼Œç„¶åŽæˆ‘ä»¬é€šè¿‡await Promise.allæ¥ç›‘å¬æ‰€æœ‰Promiseçš„å“åº”ã€‚ ç»“è®ºGeneratorä¸Žasync functionéƒ½æ˜¯è¿”å›žä¸€ä¸ªç‰¹å®šç±»åž‹çš„å¯¹è±¡ï¼š Generator: ä¸€ä¸ªç±»ä¼¼{ value: XXX, done: true }è¿™æ ·ç»“æž„çš„ObjectAsync: å§‹ç»ˆè¿”å›žä¸€ä¸ªPromiseï¼Œä½¿ç”¨awaitæˆ–è€….then()æ¥èŽ·å–è¿”å›žå€¼Generatoræ˜¯å±žäºŽç”Ÿæˆå™¨ï¼Œä¸€ç§ç‰¹æ®Šçš„è¿­ä»£å™¨ï¼Œç”¨æ¥è§£å†³å¼‚æ­¥å›žè°ƒé—®é¢˜æ„Ÿè§‰æœ‰äº›ä¸åŠ¡æ­£ä¸šäº†ã€‚ã€‚ è€Œasyncåˆ™æ˜¯ä¸ºäº†æ›´ç®€æ´çš„ä½¿ç”¨Promiseè€Œæå‡ºçš„è¯­æ³•ï¼Œç›¸æ¯”Generator + coè¿™ç§çš„å®žçŽ°æ–¹å¼ï¼Œæ›´ä¸ºä¸“æ³¨ï¼Œç”Ÿæ¥å°±æ˜¯ä¸ºäº†å¤„ç†å¼‚æ­¥ç¼–ç¨‹ã€‚ çŽ°åœ¨å·²ç»æ˜¯2018å¹´äº†ï¼Œasyncä¹Ÿæ˜¯ç”¨äº†å¥½ä¹…ï¼Œå°±è®©GeneratoråŽ»åšä»–è¯¥åšçš„äº‹æƒ…å§ã€‚ã€‚]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æˆ‘å¯¹React v16.4ç”Ÿå‘½å‘¨æœŸçš„ç†è§£]]></title>
    <url>%2F2018%2F08%2F13%2FReact%2F%E6%88%91%E5%AF%B9React-v16-4%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%9A%84%E7%90%86%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[react v16.3ç”Ÿå‘½å‘¨æœŸ react v16.4ç”Ÿå‘½å‘¨æœŸ React v16è¦åºŸé™¤çš„ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•° componentWillMount componentWillReceiveProps componentWillUpdate æ³¨ï¼šç›®å‰åœ¨16ç‰ˆæœ¬ä¸­componentWillMountï¼ŒcomponentWillReceivePropsï¼ŒcomponentWillUpdateå¹¶æœªå®Œå…¨åˆ é™¤è¿™ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè€Œä¸”æ–°å¢žäº†UNSAFE_componentWillMountï¼ŒUNSAFE_componentWillReceivePropsï¼ŒUNSAFE_componentWillUpdateä¸‰ä¸ªå‡½æ•°ï¼Œå®˜æ–¹è®¡åˆ’åœ¨17ç‰ˆæœ¬å®Œå…¨åˆ é™¤è¿™ä¸‰ä¸ªå‡½æ•°ï¼Œåªä¿ç•™UNSAVE_å‰ç¼€çš„ä¸‰ä¸ªå‡½æ•°ï¼Œç›®çš„æ˜¯ä¸ºäº†å‘ä¸‹å…¼å®¹ï¼Œä½†æ˜¯å¯¹äºŽå¼€å‘è€…è€Œè¨€åº”è¯¥å°½é‡é¿å…ä½¿ç”¨ä»–ä»¬ï¼Œè€Œæ˜¯ä½¿ç”¨æ–°å¢žçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ›¿ä»£å®ƒä»¬ å–è€Œä»£ä¹‹çš„ç”Ÿå‘½å‘¨æœŸ static getDerivedStateFromProps getSnapshotBeforeUpdate æˆ‘ä»¬å°†Reactçš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œç„¶åŽè¯¦ç»†è®²è§£æ¯ä¸ªé˜¶æ®µå…·ä½“è°ƒç”¨äº†ä»€ä¹ˆå‡½æ•°ï¼Œè¿™ä¸‰ä¸ªé˜¶æ®µæ˜¯ï¼š æŒ‚è½½é˜¶æ®µ æ›´æ–°é˜¶æ®µ å¸è½½é˜¶æ®µ æŒ‚è½½é˜¶æ®µ æŒ‚è½½é˜¶æ®µï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºç»„ä»¶çš„åˆå§‹åŒ–é˜¶æ®µï¼Œå°±æ˜¯å°†æˆ‘ä»¬çš„ç»„ä»¶æ’å…¥åˆ°DOMä¸­ï¼Œåªä¼šå‘ç”Ÿä¸€æ¬¡ è¿™ä¸ªé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°è°ƒç”¨å¦‚ä¸‹ constructor getDerviedStateFromProps componentWillMount/UNSAVE_componentWillMount render componentDidMount constructorç»„ä»¶æž„é€ å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œ å¦‚æžœæ²¡æœ‰æ˜¾ç¤ºå®šä¹‰å®ƒï¼Œæˆ‘ä»¬ä¼šæ‹¥æœ‰ä¸€ä¸ªé»˜è®¤çš„æž„é€ å‡½æ•° å¦‚æžœæ˜¾ç¤ºå®šä¹‰äº†æž„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æž„é€ å‡½æ•°ç¬¬ä¸€è¡Œæ‰§è¡Œsuper(props)ï¼Œå¦åˆ™æˆ‘ä»¬æ— æ³•åœ¨æž„é€ å‡½æ•°é‡Œæ‹¿åˆ°thiså¯¹è±¡ï¼Œè¿™äº›éƒ½å±žäºŽES6çš„çŸ¥è¯† åœ¨æž„é€ å‡½æ•°é‡Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåšä¸¤ä»¶äº‹ï¼š åˆå§‹åŒ–stateå¯¹è±¡ ç»™è‡ªå®šä¹‰æ–¹æ³•ç»‘å®šthis 123456789101112class App extends React.Component&#123; constructor(props)&#123; super(props); this.state = &#123; select, height: 'atuo', externalClass, externalClassText &#125; this.handleClick = this.handleClick.bind(this); &#125;&#125; ç¦æ­¢åœ¨æž„é€ å‡½æ•°ä¸­è°ƒç”¨setStateï¼Œå¯ä»¥ç›´æŽ¥ç»™stateè®¾ç½®åˆå§‹å€¼ getDerivedStateFromPropsstatic getDerivedStateFromProps(nextProps,prevState) ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢ä½¿ç”¨thisï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°propså’Œstateï¼Œåˆ†åˆ«æŒ‡æŽ¥æ”¶åˆ°çš„æ–°å‚æ•°å’Œå½“å‰çš„stateå¯¹è±¡ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›žä¸€ä¸ªå¯¹è±¡ç”¨æ¥æ›´æ–°å½“å‰çš„stateå¯¹è±¡ï¼Œå¦‚æžœä¸éœ€è¦æ›´æ–°å¯ä»¥è¿”å›žnull è¯¥å‡½æ•°ä¼šåœ¨æŒ‚è½½æ—¶ï¼ŒæŽ¥æ”¶åˆ°æ–°çš„propsï¼Œè°ƒç”¨äº†setStateå’ŒforceUpdateæ—¶è¢«è°ƒç”¨ åœ¨React v16.3æ—¶åªæœ‰åœ¨æŒ‚è½½æ—¶å’ŒæŽ¥æ”¶åˆ°æ–°çš„propsè¢«è°ƒç”¨ï¼Œæ®è¯´è¿™æ˜¯å®˜æ–¹çš„å¤±è¯¯ï¼ŒåŽæ¥ä¿®å¤äº† è¿™ä¸ªæ–¹æ³•å°±æ˜¯ä¸ºäº†å–ä»£ä¹‹å‰çš„componentWillMountã€componentWillReceivePropså’ŒcomponentWillUpdate å½“æˆ‘ä»¬æŽ¥æ”¶åˆ°æ–°çš„å±žæ€§æƒ³åŽ»ä¿®æ”¹æˆ‘ä»¬stateï¼Œå¯ä»¥ä½¿ç”¨getDerivedStateFromProps 12345678910111213141516class ExampleComponent extends React.Component &#123; state = &#123; isScrollingDown: false, lastRow: null &#125; static getDerivedStateFromProps(nextProps,prevState)&#123; if(nextProps.currentRow !== prevState.lastRow)&#123; return &#123; isScrollingDown: nextProps.currentRow &gt; prevState.lastRow, lastRow: nextProps.currentRow &#125; &#125; return null; &#125;&#125; componentWillMount/UNSAFE_componentWillMountåœ¨16ç‰ˆæœ¬è¿™ä¸¤ä¸ªæ–¹æ³•å¹¶å­˜ï¼Œä½†æ˜¯åœ¨17ç‰ˆæœ¬ä¸­componentWillMountè¢«åˆ é™¤ï¼Œåªä¿ç•™UNSAFE_componentWillMountï¼Œç›®çš„æ˜¯ä¸ºäº†åšå‘ä¸‹å…¼å®¹ï¼Œå¯¹äºŽæ–°çš„åº”ç”¨ï¼Œç”¨getDerivedStateFromPropsä»£æ›¿å®ƒä»¬ç”±äºŽcomponentWillMount/ UNSAFE_componentWillMountæ˜¯åœ¨renderä¹‹å‰è°ƒç”¨ï¼Œæ‰€ä»¥å°±ç®—åœ¨è¿™ä¸ªæ–¹æ³•ä¸­è°ƒç”¨setStateä¹Ÿä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰ renderrenderæ–¹æ³•æ˜¯reactä¸­æœ€æ ¸å¿ƒçš„æ–¹æ³•ï¼Œä¸€ä¸ªç»„ä»¶ä¸­å¿…é¡»è¦è¿™ä¸ªæ–¹æ³•ï¼š è¿”å›žçš„ç±»åž‹æœ‰ä»¥ä¸‹å‡ ç§ åŽŸç”ŸDOMï¼Œå¦‚div Fragmentï¼ˆç‰‡æ®µï¼‰ Reactç»„ä»¶ Portalsï¼ˆæ’æ§½ï¼‰ å­—ç¬¦ä¸²å’Œæ•°å­—ï¼Œè¢«æ¸²æŸ“æˆtextèŠ‚ç‚¹ Booleanå’Œnullï¼Œä¸ä¼šæ¸²æŸ“ä»»ä½•ä¸œè¥¿ å…³äºŽFragmentå’ŒPortalsæ˜¯React16æ–°å¢žçš„ï¼Œå¦‚æžœå¤§å®¶ä¸æ¸…æ¥šå¯ä»¥åŽ»é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼Œåœ¨è¿™é‡Œå°±ä¸å±•å¼€äº† renderå‡½æ•°æ˜¯çº¯å‡½æ•°ï¼Œé‡Œé¢åªåšä¸€ä»¶äº‹ï¼Œå°±æ˜¯è¿”å›žéœ€è¦æ¸²æŸ“çš„ä¸œè¥¿ï¼Œä¸åº”è¯¥åŒ…å«å…¶å®ƒçš„ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æ•°æ®è¯·æ±‚ï¼Œå¯¹äºŽè¿™äº›ä¸šåŠ¡é€»è¾‘è¯·ç§»åˆ°componentDidMountå’ŒcomponentDidUpdateä¸­ componentDidMountç»„ä»¶å¸è½½ä¹‹åŽè°ƒç”¨ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥èŽ·å–åˆ°DOMèŠ‚ç‚¹å¹¶æ“ä½œï¼Œæ¯”å¦‚å¯¹canvasï¼Œsvgçš„æ“ä½œï¼ŒæœåŠ¡å™¨è¯·æ±‚ï¼Œè®¢é˜…éƒ½å¯ä»¥å†™åœ¨è¿™ä¸ªé‡Œé¢ï¼Œä½†æ˜¯è®°å¾—åœ¨componentWillUnmountä¸­å–æ¶ˆè®¢é˜… 1234567891011121314151617181920212223242526272829303132componentDidMount() &#123; const &#123; progressCanvas, progressSVG &#125; = this const canvas = progressCanvas.current const ctx = canvas.getContext('2d') canvas.width = canvas.getBoundingClientRect().width canvas.height = canvas.getBoundingClientRect().height const svg = progressSVG.current const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect') rect.setAttribute('x', 0) rect.setAttribute('y', 0) rect.setAttribute('width', 0) rect.setAttribute('height', svg.getBoundingClientRect().height) rect.setAttribute('style', 'fill:red') const animate = document.createElementNS('http://www.w3.org/2000/svg', 'animate') animate.setAttribute('attributeName', 'width') animate.setAttribute('from', 0) animate.setAttribute('to', svg.getBoundingClientRect().width) animate.setAttribute('begin', '0ms') animate.setAttribute('dur', '1684ms') animate.setAttribute('repeatCount', 'indefinite') animate.setAttribute('calcMode', 'linear') rect.appendChild(animate) svg.appendChild(rect) svg.pauseAnimations() this.canvas = canvas this.svg = svg this.ctx = ctx &#125; åœ¨componentDidMountä¸­è°ƒç”¨setStateä¼šè§¦å‘ä¸€æ¬¡é¢å¤–çš„æ¸²æŸ“ï¼Œå¤šè°ƒç”¨äº†ä¸€æ¬¡renderå‡½æ•°ï¼Œä½†æ˜¯ç”¨æˆ·å¯¹æ­¤æ²¡æœ‰æ„ŸçŸ¥ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨æµè§ˆå™¨åˆ·æ–°å±å¹•å‰æ‰§è¡Œçš„ï¼Œä½†æ˜¯æˆ‘ä»¬åº”è¯¥åœ¨å¼€å‘ä¸­é¿å…å®ƒï¼Œå› ä¸ºå®ƒä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨constructorä¸­åˆå§‹åŒ–æˆ‘ä»¬çš„stateå¯¹è±¡ï¼Œè€Œä¸åº”è¯¥åœ¨componentDidMountè°ƒç”¨stateæ–¹æ³• æ›´æ–°é˜¶æ®µæ›´æ–°é˜¶æ®µï¼Œå½“ç»„ä»¶çš„propsæ”¹å˜äº†ï¼Œæˆ–ç»„ä»¶å†…éƒ¨è°ƒç”¨äº†setStateæˆ–è€…forceUpdateå‘ç”Ÿï¼Œä¼šå‘ç”Ÿå¤šæ¬¡ è¿™ä¸ªé˜¶æ®µç”Ÿå‘½å‘¨æœŸå‡½æ•°å¦‚ä¸‹ï¼š componentWillReceiveProps/UNSAFE_componentWillReceiveProps getRerviedStateFromProps shouldComponentUpdate componentWillUpdate/UNSAFE_componentWillUpdate render getSnapshotBeforeUpdate componentDidUpdate componentWillReceiveProps/UNSAFE_componentWillReceivePropscomponentWillReceiveProps(nextProps, prevState)UNSAFE_componentWillReceiveProps(nextProps, prevState) åœ¨16ç‰ˆæœ¬è¿™ä¸¤ä¸ªæ–¹æ³•å¹¶å­˜ï¼Œä½†æ˜¯åœ¨17ç‰ˆæœ¬ä¸­componentWillReceivePropsè¢«åˆ é™¤ï¼ŒUNSAFE_componentWillReceivePropsï¼Œç›®çš„æ˜¯ä¸ºäº†åšå‘ä¸‹å…¼å®¹ï¼Œå¯¹äºŽæ–°çš„åº”ç”¨ï¼Œç”¨getDerivedStateFromPropsä»£æ›¿å®ƒä»¬ æ³¨æ„ï¼Œå½“æˆ‘ä»¬çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ—¶å€™ï¼Œä¹Ÿä¼šå¯¼è‡´æˆ‘ä»¬çš„å­ç»„ä»¶è°ƒç”¨componentWillReceiveProps/UNSAFE_componentWillReceivePropsï¼Œå³ä½¿æˆ‘ä»¬çš„å±žæ€§å’Œä¹‹å‰çš„ä¸€æ ·ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢åŽ»è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æžœå‰åŽå±žæ€§ä¸ä¸€è‡´æ‰åŽ»è°ƒç”¨setState åœ¨è£…è½½é˜¶æ®µè¿™ä¸¤ä¸ªå‡½æ•°ä¸ä¼šè¢«è§¦å‘ï¼Œåœ¨ç»„ä»¶å†…éƒ¨è°ƒç”¨äº†setStateå’ŒforceUpdateä¹Ÿä¸ä¼šè§¦å‘è¿™ä¸¤ä¸ªå‡½æ•° `getDerivedStateFromPropsè¿™ä¸ªæ–¹æ³•åœ¨è£…è½½é˜¶æ®µå·²ç»è®²è¿‡äº†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œè®°ä½åœ¨æ›´æ–°é˜¶æ®µï¼Œæ— è®ºæˆ‘ä»¬æŽ¥æ”¶åˆ°æ–°çš„å±žæ€§ï¼Œè°ƒç”¨äº†setStateè¿˜æ˜¯è°ƒç”¨äº†forceUpdateï¼Œè¿™ä¸ªæ–¹æ³•éƒ½ä¼šè¢«è°ƒç”¨ shouldComponentUpdateshouldComponentUpdate(nextProps,nextState) æœ‰ä¸¤ä¸ªå‚æ•°nextPropså’ŒnextStateï¼Œè¡¨ç¤ºæ–°çš„å±žæ€§å’Œå˜åŒ–ä¹‹åŽçš„stateï¼Œè¿”å›žä¸€ä¸ªå¸ƒå°”å€¼ï¼Œtrueè¡¨ç¤ºä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œfalseè¡¨ç¤ºä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œé»˜è®¤è¿”å›žtrue æ³¨æ„å½“æˆ‘ä»¬è°ƒç”¨forceUpdateå¹¶ä¸ä¼šè§¦å‘æ­¤æ–¹æ³• å› ä¸ºé»˜è®¤æ˜¯è¿”å›žtrueï¼Œä¹Ÿå°±æ˜¯åªè¦æŽ¥æ”¶åˆ°æ–°çš„å±žæ€§å’Œè°ƒç”¨äº†setStateéƒ½ä¼šè§¦å‘é‡æ–°çš„æ¸²æŸ“ï¼Œè¿™ä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†this.propsä¸ŽnextPropsä»¥åŠthis.stateä¸ŽnextStateè¿›è¡Œæ¯”è¾ƒæ¥å†³å®šæ˜¯å¦è¿”å›žfalseï¼Œæ¥å‡å°‘é‡æ–°æ¸²æŸ“ ä½†æ˜¯å®˜æ–¹æå€¡æˆ‘ä»¬ä½¿ç”¨PureComponentæ¥å‡å°‘é‡æ–°æ¸²æŸ“çš„æ¬¡æ•°è€Œä¸æ˜¯æ‰‹å·¥ç¼–å†™shouldComponentUpdateä»£ç ï¼Œå…·ä½“è¯¥æ€Žä¹ˆé€‰æ‹©ï¼Œå…¨å‡­å¼€å‘è€…è‡ªå·±é€‰æ‹© åœ¨æœªæ¥çš„ç‰ˆæœ¬ï¼ŒshouldComponentUpdateè¿”å›žfalseï¼Œä»ç„¶å¯èƒ½å¯¼è‡´ç»„ä»¶é‡æ–°çš„æ¸²æŸ“ï¼Œè¿™æ˜¯å®˜æ–¹è‡ªå·±è¯´çš„ Currently, if shouldComponentUpdate() returns false, then UNSAFE_componentWillUpdate(), render(), and componentDidUpdate() will not be invoked. In the future React may treat shouldComponentUpdate() as a hint rather than a strict directive, and returning false may still result in a re-rendering of the component. componentWillUpdate/UNSAFE_componentWillUpdatecomponentWillUpdate(nextProps, nextState)UNSAFE_componentWillUpdate(nextProps, nextState) åœ¨16ç‰ˆæœ¬è¿™ä¸¤ä¸ªæ–¹æ³•å¹¶å­˜ï¼Œä½†æ˜¯åœ¨17ç‰ˆæœ¬ä¸­componentWillUpdateè¢«åˆ é™¤ï¼ŒUNSAFE_componentWillUpdateï¼Œç›®çš„æ˜¯ä¸ºäº†åšå‘ä¸‹å…¼å®¹ åœ¨è¿™ä¸ªæ–¹æ³•é‡Œï¼Œä½ ä¸èƒ½è°ƒç”¨setStateï¼Œå› ä¸ºèƒ½èµ°åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œè¯´æ˜ŽshouldComponentUpdateè¿”å›žtrueï¼Œæ­¤æ—¶ä¸‹ä¸€ä¸ªstateçŠ¶æ€å·²ç»è¢«ç¡®å®šï¼Œé©¬ä¸Šå°±è¦æ‰§è¡Œrenderé‡æ–°æ¸²æŸ“äº†ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ•´ä¸ªç”Ÿå‘½å‘¨æœŸæ··ä¹±ï¼Œåœ¨è¿™é‡Œä¹Ÿä¸èƒ½è¯·æ±‚ä¸€äº›ç½‘ç»œæ•°æ®ï¼Œå› ä¸ºåœ¨å¼‚æ­¥æ¸²æŸ“ä¸­ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç½‘ç»œè¯·æ±‚å¤šæ¬¡ï¼Œå¼•èµ·ä¸€äº›æ€§èƒ½é—®é¢˜ å¦‚æžœä½ åœ¨è¿™ä¸ªæ–¹æ³•é‡Œä¿å­˜äº†æ»šåŠ¨ä½ç½®ï¼Œä¹Ÿæ˜¯ä¸å‡†ç¡®çš„ï¼Œè¿˜æ˜¯å› ä¸ºå¼‚æ­¥æ¸²æŸ“çš„é—®é¢˜ï¼Œå¦‚æžœä½ éžè¦èŽ·å–æ»šåŠ¨ä½ç½®çš„è¯ï¼Œè¯·åœ¨getSnapshotBeforeUpdateè°ƒç”¨ `renderæ›´æ–°é˜¶æ®µä¹Ÿä¼šè§¦å‘ï¼Œè£…è½½é˜¶æ®µå·²ç»è®²è¿‡äº†ï¼Œä¸å†èµ˜è¿° getSnapshotBeforeUpdategetSnapshotBeforeUpdate(prevProps, prevState) è¿™ä¸ªæ–¹æ³•åœ¨renderä¹‹åŽï¼ŒcomponentDidUpdateä¹‹å‰è°ƒç”¨ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°prevPropså’ŒprevStateï¼Œè¡¨ç¤ºä¹‹å‰çš„å±žæ€§å’Œä¹‹å‰çš„stateï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªè¿”å›žå€¼ï¼Œä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ ç»™componentDidUpdateï¼Œå¦‚æžœä½ ä¸æƒ³è¦è¿”å›žå€¼ï¼Œè¯·è¿”å›žnullï¼Œä¸å†™çš„è¯æŽ§åˆ¶å°ä¼šæœ‰è­¦å‘Š è¿˜æœ‰è¿™ä¸ªæ–¹æ³•ä¸€å®šè¦å’ŒcomponentDidUpdateä¸€èµ·ä½¿ç”¨ï¼Œå¦åˆ™æŽ§åˆ¶å°ä¹Ÿä¼šæœ‰è­¦å‘Š å‰é¢è¯´è¿‡è¿™ä¸ªæ–¹æ³•æ—¶ç”¨æ¥ä»£æ›¿componentWillUpdate/UNSAVE_componentWillUpdateï¼Œä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜Žä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132class ScrollingList extends React.Component &#123; constructor(props) &#123; super(props); this.listRef = React.createRef(); &#125; getSnapshotBeforeUpdate(prevProps, prevState) &#123; // Are we adding new items to the list? // Capture the scroll position so we can adjust scroll later. if (prevProps.list.length &lt; this.props.list.length) &#123; const list = this.listRef.current; return list.scrollHeight - list.scrollTop; &#125; return null; &#125; componentDidUpdate(prevProps, prevState, snapshot) &#123; // If we have a snapshot value, we've just added new items. // Adjust scroll so these new items don't push the old ones out of view. // (snapshot here is the value returned from getSnapshotBeforeUpdate) if (snapshot !== null) &#123; const list = this.listRef.current; list.scrollTop = list.scrollHeight - snapshot; &#125; &#125; render() &#123; return ( &lt;div ref=&#123;this.listRef&#125;&gt;&#123;/* ...contents... */&#125;&lt;/div&gt; ); &#125;&#125; componentDidUpdatecomponentDidUpdate(prevProps, prevState, snapshot) è¯¥æ–¹æ³•åœ¨getSnapshotBeforeUpdateæ–¹æ³•ä¹‹åŽè¢«è°ƒç”¨ï¼Œæœ‰ä¸‰ä¸ªå‚æ•°prevPropsï¼ŒprevStateï¼Œsnapshotï¼Œè¡¨ç¤ºä¹‹å‰çš„propsï¼Œä¹‹å‰çš„stateï¼Œå’Œsnapshotã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯getSnapshotBeforeUpdateè¿”å›žçš„ å¸è½½é˜¶æ®µå¸è½½é˜¶æ®µï¼Œå½“æˆ‘ä»¬çš„ç»„ä»¶è¢«å¸è½½æˆ–è€…é”€æ¯äº† è¿™ä¸ªé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°åªæœ‰ä¸€ä¸ª componentWillUnmount componentWillUnmountå½“æˆ‘ä»¬çš„ç»„ä»¶è¢«å¸è½½æˆ–è€…é”€æ¯äº†å°±ä¼šè°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°é‡ŒåŽ»æ¸…é™¤ä¸€äº›å®šæ—¶å™¨ï¼Œå–æ¶ˆç½‘ç»œè¯·æ±‚ï¼Œæ¸…ç†æ— æ•ˆçš„DOMå…ƒç´ ç­‰åžƒåœ¾æ¸…ç†å·¥ä½œ æ³¨æ„ä¸è¦åœ¨è¿™ä¸ªå‡½æ•°é‡ŒåŽ»è°ƒç”¨setStateï¼Œå› ä¸ºç»„ä»¶ä¸ä¼šé‡æ–°æ¸²æŸ“äº† åŽŸæ–‡é“¾æŽ¥]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯å¸¸è§ç®—æ³•Jså®žçŽ°]]></title>
    <url>%2F2018%2F08%2F10%2FHTTP%2F%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95Js%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[å¿«é€ŸæŽ’åº1var arr = [2,53,53.2,1,1223,5,2,675,967,2,1231,9344,3855,1]; å†’æ³¡æŽ’åºåŽŸç†ï¼šæ¯”è¾ƒç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ ï¼Œæ¯”è¾ƒå¤§çš„æ”¾ç½®å³ç«¯ 12345678910111213141516function bubbleSort(arr)&#123; var i = j =0 for(var i = 1;i &lt; arr.length;i++)&#123; for(var j = 0;j &lt;= arr.length - i;j++)&#123; var temp = 0 if(arr[j] &gt; arr[j+1])&#123; temp = arr[j]; arr[j] = arr[j+1]; arr[j+1] = temp; &#125; &#125; &#125;&#125;// bubbleSort(arr);// console.log(arr) å¿«æŽ’åŽŸç†ï¼šæ ¹æ®åŸºæ•°å°†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†çš„æ•°æ®è¦æ¯”å¦ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°ï¼Œç„¶åŽè¿›è¡Œé€’å½’è°ƒç”¨ï¼Œç›´åˆ°æœ€åŽä¸€ä¸ªå…ƒç´  123456789101112131415161718192021222324252627282930function quickSort(arr)&#123; if (arr.length &lt;= 1) &#123; return arr; &#125; var pivotIndex = Math.floor(arr.length / 2) ; var pivot = arr.splice(pivotIndex, 1)[0]; var left = []; var right = []; for (var i = 0; i &lt; arr.length; i++)&#123; if (arr[i] &lt; pivot) &#123; left.push(arr[i]); &#125; else &#123; right.push(arr[i]); &#125; &#125; return quickSort(left).concat([pivot], quickSort(right));&#125;// console.log(quickSort(arr)); æ’å…¥æŽ’åºåŽŸç†1ï¼‰ ä»Žç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æŽ’åº 2ï¼‰ å–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æŽ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»ŽåŽå‘å‰æ‰«æ 3ï¼‰ å¦‚æžœè¯¥å…ƒç´ ï¼ˆå·²æŽ’åºï¼‰å¤§äºŽæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½® 4ï¼‰ é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æŽ’åºçš„å…ƒç´ å°äºŽæˆ–è€…ç­‰äºŽæ–°å…ƒç´ çš„ä½ç½® 5ï¼‰å°†æ–°å…ƒç´ æ’å…¥åˆ°ä¸‹ä¸€ä½ç½®ä¸­ 6ï¼‰ é‡å¤æ­¥éª¤2 12345678910111213141516171819202122function insertSort(arr)&#123;// å‡è®¾ç¬¬0ä¸ªå…ƒç´ å¼€å§‹æ˜¯æœ‰åºæŽ’åºï¼Œç¬¬1ä¸ªå…ƒç´ ä¹‹åŽæ˜¯æ— åºæŽ’åº// æ‰€ä»¥ä»Žç¬¬1ä¸ªå…ƒç´ å°†æ— éœ€æ•°åˆ—çš„å…ƒç´ æ’å…¥æœ‰åºæ•°åˆ—ä¸­for(var i = 1; i &lt; arr.length; i++)&#123; // å‡åº if(arr[i] &lt; arr[i - 1])&#123; // å–å‡ºæ— åºæ•°ç»„ä¸­å¼Ÿiä¸ªå…ƒç´ ä½œä¸ºè¢«æ’å…¥å…ƒç´  var guard = arr[i]; // è®°ä½æœ‰åºæ•°åˆ—çš„æœ€åŽä¸€ä¸ªå…ƒç´ ä½ç½®ï¼Œå¹¶å°†æ•°åˆ—ä½ç½®æ‰©å¤§ä¸€ä¸ª var j = i - 1; arr[i] = arr[j]; // æ¯”å¤§å°æ‰¾åˆ°è¢«æ’å…¥å…ƒç´ çš„ä½ç½® while (j &gt;= 0 &amp;&amp; guard &lt; arr[j]) &#123; arr[j + 1] = arr[j]; j--; &#125; arr[j + 1] = guard; // æ’å…¥ &#125;&#125;&#125;insertSort(arr);console.log(arr) äºŒåˆ†æŸ¥æ‰¾åŽŸç†äºŒåˆ†æŸ¥æ‰¾ï¼Œä¹Ÿä¸ºæŠ˜åŠæŸ¥æ‰¾ã€‚é¦–å…ˆè¦æ‰¾åˆ°ä¸€ä¸ªä¸­é—´å€¼ï¼Œé€šè¿‡ä¸Žä¸­é—´å€¼æ¯”è¾ƒï¼Œå¤§çš„æ”¾åˆï¼Œå°çš„æ”¾åœ¨å·¦è¾¹ã€‚å†åœ¨ä¸¤è¾¹ä¸­å¯»æ‰¾ä¸­é—´å€¼ï¼ŒæŒç»­ä»¥ä¸Šæ“ä½œï¼Œç›´åˆ°æ‰¾åˆ°æ‰€åœ¨ä½ç½®ä¸ºæ­¢ã€‚ 123456789101112131415161718192021function binarySort(left,right)&#123; var result = [], il = 0, ir = 0; while (il &lt; left.length &amp;&amp; ir &lt; right.length) &#123; if (left[il] &lt; right[ir]) &#123; result.push(left[il++]); &#125; else &#123; result.push(right[ir++]); &#125; &#125; while(left[il])&#123; result.push(left[il++]); &#125; while(right[ir])&#123; result.push(right[ir++]); &#125; return result;&#125;console.log(binarySort(arr,1))]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”¨canvasåŽ‹ç¼©ä¸Šä¼ çš„å›¾ç‰‡]]></title>
    <url>%2F2018%2F08%2F07%2FJs%2F%E7%94%A8canvas%E5%8E%8B%E7%BC%A9%E4%B8%8A%E4%BC%A0%E7%9A%84%E5%9B%BE%E7%89%87%2F</url>
    <content type="text"><![CDATA[å‰è¨€çŽ°åœ¨æ‘„åƒå¤´å·²ç»æ˜¯æ‰‹æœºçš„æ ‡é…äº†ï¼Œç§»åŠ¨ç½‘ç«™ä¹Ÿåšå¾—è¶Šæ¥è¶ŠåƒAPPã€‚ç„¶è€Œæ‹ç…§ä¸Šä¼ è¿™ä»¶äº‹æƒ…çš„ä½“éªŒä¼¼ä¹Žä»ç„¶ä¸å¦‚APPï¼Œä¸»è¦åŽŸå› æ˜¯çŽ°åœ¨æ‰‹æœºæ‹æ‘„çš„ç…§ç‰‡å¤ªå¤§ï¼Œä¸Šä¼ éžå¸¸æ¶ˆè€—æµé‡ä¹Ÿéžå¸¸è€—æ—¶ã€‚APPéƒ½ä¼šåœ¨ä¸Šä¼ å‰ç¼©å°è¦ä¸Šä¼ çš„ç…§ç‰‡å°ºå¯¸ï¼Œä»¥æœŸæ›´èŠ‚çœæµé‡å’Œæ—¶é—´ã€‚åœ¨HTML5æ—¶ä»£ï¼Œåˆ©ç”¨æ–‡ä»¶APIå’ŒCanvasæŠ€æœ¯ï¼ŒWebä¸Šä¹Ÿå¯ä»¥åšåˆ°å›¾ç‰‡åŽ‹ç¼©ä¸Šä¼ ã€‚ è¿‡æ»¤æ–‡ä»¶ç±»åž‹é¦–å…ˆæˆ‘ä»¬å¸Œæœ›ç”¨æˆ·èƒ½ç›´æŽ¥é€‰æ‹©æ‰‹æœºç…§ç‰‡ï¼Œè€Œä¸æ˜¯åœ¨å„ç§ç±»åž‹çš„æ–‡ä»¶ä¸­é€‰æ‹©ã€‚åªéœ€è¦åœ¨inputæ ‡ç­¾ä¸­åŠ å…¥acceptå±žæ€§å°±å¯ä»¥å®žçŽ°è¿™ä¸€ç‚¹ï¼š 12345&lt;div id="preview"&gt;&lt;/div&gt;&lt;form&gt; &lt;input type="file" accept="image/*"&gt; &lt;input type="submit"&gt;&lt;form&gt; åœ¨Android4ä»¥ä¸Šï¼ŒiOS7ä»¥ä¸Šè®¾å¤‡å®žæµ‹ï¼Œå½“ç”¨æˆ·ç‚¹å‡»è¿™ä¸ªæ–‡ä»¶é€‰æ‹©å™¨çš„æ—¶å€™ï¼Œæ‰‹æœºä¼šè‡ªåŠ¨è°ƒå‡ºå›¾ç‰‡åº“ï¼Œå¹¶å¸¦æœ‰æ‹ç…§é€‰æ‹©ã€‚ è¯»æ–‡ä»¶ç”Ÿæˆé¢„è§ˆç”¨æˆ·é€‰æ‹©äº†å›¾ç‰‡ä¹‹åŽï¼Œéœ€è¦è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¯»å‡ºçš„å†…å®¹å¯ä¾›ç”Ÿæˆé¢„è§ˆå›¾ï¼Œä¹Ÿå¯ä»¥ä¾›åŽé¢åŽ‹ç¼©ä½¿ç”¨ã€‚ä½¿ç”¨HTML5çš„FileReader APIå¯ä»¥è¾¾æˆè¿™ä¸€ç›®çš„ã€‚ 12345678910111213var file = document.querySeletor("[type=file]");file.addEventListener('change',function(e)&#123; for(var i = 0,f; f &lt; e.target.file[i]; i++)&#123; if(f.type.indexOf('image') != 0) continue; var render = new FileReader(); render.onload = function(e)&#123; var img = document.createElement('img'); img.src = e.targte.result; document.getElementById('preview').appendChild(img); &#125; render.readAsDataURL(f) &#125;&#125;,false) å¦‚æžœä¸éœ€è¦é¢„è§ˆå›¾ï¼Œå¯ä»¥ä¸æŠŠimgå¯¹è±¡æ·»åŠ åˆ°DOMä¸Šã€‚ åŽ‹ç¼©åˆ©ç”¨Canvasæ¸²æŸ“ä¸Šä¸‹æ–‡çš„drawImageæŽ¥å£ï¼Œå¯ä»¥æŠŠä¸€å¼ å›¾ç‰‡ç»˜åˆ¶åˆ°Canvasä¸Šï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¯ä»¥é‡æ–°å®šä¹‰å›¾ç‰‡å°ºå¯¸ï¼Œç„¶åŽå†ç”¨Canvasçš„toDataURLæŽ¥å£å¯ä»¥ç”Ÿæˆå‡ºåŽ‹ç¼©åŽçš„å›¾ç‰‡ã€‚ 1234567891011var images = document.querySeletorAll('#preview img');var iWidth = 400,iHeight = 300;var compressedImages = [];[].forEach.call(images,function(image)&#123; var canvas = document.createElement('canvas'); canvas.width = iWidth; canvas.height = iHeight; canvas.getContent('2d').drawImage(image); var compressed = canvas.toDataURL("imgae/jepg",0.7); compressedImages.push(compressed);&#125;) ä¸Šä¼ ä¸Šé¢ä¸€æ­¥éª¤ç”Ÿæˆçš„åŽ‹ç¼©åŽå›¾ç‰‡æ˜¯Data URLå½¢å¼çš„ï¼Œä¸Šä¼ å‰éœ€è¦æŠŠå¼€å¤´éƒ¨åˆ†çš„data:image/jpeg;base64,æˆªæŽ‰æ‰æ˜¯å›¾ç‰‡çš„Base64ç¼–ç å½¢å¼ã€‚ å¯ä»¥ç›´æŽ¥æŠŠBase64çš„å­—ç¬¦ä¸²ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åŽç”±æœåŠ¡ç«¯è§£ç ä¸ºJPGå›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥åœ¨å‰ç«¯è§£ç ä¸Šä¼ ã€‚å¦‚æžœè¦åœ¨å‰ç«¯è§£ç å¹¶ä»¥æ–‡ä»¶æ–¹å¼ä¸Šä¼ ï¼Œå…ˆè¦ç”¨atobå‡½æ•°æŠŠBase64è§£å¼€ï¼Œç„¶åŽè½¬æ¢ä¸ºArrayBufferï¼Œå†ç”¨å®ƒåˆ›å»ºä¸€ä¸ªBlobå¯¹è±¡ã€‚æ–‡ä»¶æ–¹å¼ä¸Šä¼ éœ€è¦ç”¨multipart/form-dataæ ¼å¼ï¼Œå¯ä»¥åˆ©ç”¨FormDataå¯¹è±¡ç»„è£…ç”Ÿæˆå¥½çš„Blobå¯¹è±¡æ¥å®žçŽ°ã€‚ 12345678910111213141516171819202122232425262728function b64toBlob(b64Data,contentType,sliceSize)&#123; contentType = contentType || ''; sliceSize = sliceSize || 512; var byteCharacters = atob(b64Data); var byteData = []; for(var offset = 0; offset &lt; byteCharacters.length; offset += sliceSize)&#123; var slice = byteCharacters.slice(offset, offset + sliceSize); var byteNumbers = new Array(slice.length); for (var i = 0; i &lt; slice.length; i++) &#123; byteNumbers[i] = slice.charCodeAt(i); &#125; var byteArray = new Uint8Array(byteNumbers); byteArrays.push(byteArray); &#125; var blob = new Blob(byteArray,&#123;type:content&#125;) return blob;&#125;var fileBlob = b64toBlob(compressed.substr(23),'images/jepg');var formData = new FormData();formData.append('file',fileBlob);var xhr = new XMLHttpRequest();xhr.open('POST','upload.php');xhr.send(formData); å®‰å…¨æœ€åŽï¼Œè¯·ä¸è¦å¿˜è®°åœ¨æœåŠ¡ç«¯å¯¹ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶æ•°æ®è¿›è¡Œåˆæ³•æ€§æ£€æŸ¥ï¼Œæ¯•ç«Ÿé»‘å®¢ä¹Ÿå¯èƒ½ç”¨éžæµè§ˆå™¨ä¸Šä¼ åžƒåœ¾æ–‡ä»¶æˆ–è€…æ¶æ„è„šæœ¬ã€‚ Demo]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¸­çš„â€œthisâ€æ˜¯ä»€ä¹ˆï¼Ÿ]]></title>
    <url>%2F2018%2F08%2F05%2FJs%2FJavaScript%E4%B8%AD%E7%9A%84%E2%80%9Cthis%E2%80%9D%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡ï¼šWhat is â€œthisâ€ in JavaScript? å‰è¨€å¦‚æžœä½ æ›¾ä½¿ç”¨JavaScriptåº“åšè¿‡å¼€å‘ï¼Œé‚£ä¹ˆä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ä¸€ä¸ªåä¸º thisçš„ç‰¹å®šå…³é”®å­—ã€‚è™½ç„¶ thisåœ¨JavaScriptä¸­éžå¸¸å¸¸è§ï¼Œä½†æ˜¯å®Œå…¨ç†è§£thiså…³é”®å­—çš„åŽŸç†ä»¥åŠåœ¨ä»£ç ä¸­å¦‚ä½•ä½¿ç”¨å¯¹ç›¸å½“ä¸€éƒ¨åˆ†çš„å¼€å‘è€…æ¥è¯´ç€å®žä¸æ˜“ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å¸®ä½ æ·±å…¥ç†è§£ thisåŠå…¶å·¥ä½œæœºåˆ¶ã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£… Nodeã€‚ç„¶åŽï¼Œæ‰“å¼€å‘½ä»¤è¡Œç»ˆç«¯å¹¶è¿è¡Œ node å‘½ä»¤ã€‚ å…¨å±€çŽ¯å¢ƒä¸­çš„â€œthisâ€thisçš„å·¥ä½œæœºåˆ¶ç†è§£èµ·æ¥å¹¶ä¸æ˜¯å¾ˆå®¹æ˜“ã€‚æˆ‘ä»¬é€šè¿‡å°† thisç½®äºŽä¸åŒçŽ¯å¢ƒä¸‹ï¼Œåˆ†åˆ«æ¥ç†è§£ thisæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹ globalçŽ¯å¢ƒã€‚ åœ¨å…¨å±€çŽ¯å¢ƒä¸­ï¼Œ thisç›¸å½“äºŽå…¨å±€å¯¹è±¡ globalã€‚ 12this === global;true; ä½†è¿™åªåœ¨ nodeä¸­æ‰æœ‰æ•ˆã€‚å¦‚æžœæˆ‘ä»¬å°†ç›¸åŒçš„ä»£ç æ”¾åœ¨jsæ–‡ä»¶ä¸­è¿è¡Œï¼Œå¾—åˆ°çš„è¾“å‡ºä¸ºfalseã€‚ å¦‚æžœæƒ³æµ‹è¯•æ•ˆæžœï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º index.jsçš„æ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹ä»£ç ï¼š 1console.log(this === global); ç„¶åŽä½¿ç”¨ nodeå‘½ä»¤è¿è¡Œæ­¤æ–‡ä»¶ï¼š 12$ node index.jsfalse åŽŸå› æ˜¯åœ¨JavaScriptæ–‡ä»¶ä¸­ï¼Œ thisç­‰åŒäºŽ module.exportsè€Œä¸æ˜¯ global ã€‚ å‡½æ•°ä¸­çš„â€œthisâ€å‡½æ•°ä¸­çš„ thiså€¼é€šå¸¸æ˜¯ç”±å‡½æ•°çš„è°ƒç”¨æ–¹æ¥å®šä¹‰ã€‚å› æ­¤ï¼Œæ¯æ¬¡æ‰§è¡Œå‡½æ•°ï¼Œå‡½æ•°å†…çš„ thiså€¼å¯èƒ½éƒ½ä¸ä¸€æ ·ã€‚ åœ¨ index.jsæ–‡ä»¶ä¸­ï¼Œç¼–å†™ä¸€ä¸ªéžå¸¸ç®€å•çš„å‡½æ•°ï¼Œæ¥æ£€æŸ¥ thisæ˜¯å¦ç­‰äºŽglobalå¯¹è±¡ã€‚ 1234function rajat() &#123; console.log(this === global)&#125;rajat() å¦‚æžœæˆ‘ä»¬ä½¿ç”¨ nodeè¿è¡Œæ­¤ä»£ç ï¼Œå¾—åˆ°çš„è¾“å‡ºä¸º true ã€‚å¦‚æžœåœ¨æ–‡ä»¶çš„é¡¶éƒ¨æ·»åŠ  â€œuse strictâ€ï¼Œå¹¶å†æ¬¡è¿è¡Œå®ƒï¼Œå°†ä¼šå¾—åˆ°ä¸€ä¸ª falseè¾“å‡ºï¼Œå› ä¸ºçŽ°åœ¨çš„ thiså€¼ä¸º undefined ã€‚ä¸ºäº†è¿›ä¸€æ­¥è§£é‡Šè¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥å®šä¹‰è¶…çº§è‹±é›„çš„çœŸå®žå§“åå’Œè‹±é›„åå­— 123456function Hero(heroName, realName) &#123; this.realName = realName; this.heroName = heroName;&#125;const superman= Hero("Superman", "Clark Kent");console.log(superman); è¯·æ³¨æ„ï¼Œè¿™ä¸ªå‡½æ•°å¹¶ä¸æ˜¯ä»¥ä¸¥æ ¼æ¨¡å¼ç¼–å†™çš„ã€‚ nodeè¿è¡Œæ­¤ä»£ç ï¼Œå¹¶ä¸ä¼šå¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„â€œSupermanâ€å’Œâ€œClark Kentâ€ï¼Œä½†å®ƒåªä¼šç»™æˆ‘ä»¬ä¸€ä¸ª undefined ã€‚ èƒŒåŽçš„åŽŸå› æ˜¯ï¼Œç”±äºŽå‡½æ•°ä¸æ˜¯ä»¥ä¸¥æ ¼æ¨¡å¼ç¼–å†™çš„ï¼Œ thisæŒ‡å‘globalå¯¹è±¡ã€‚å¦‚æžœåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹è¿è¡Œæ­¤ä»£ç ï¼Œæˆ‘ä»¬ä¼šæ”¶åˆ°æŠ¥é”™ï¼Œå› ä¸ºJavaScriptä¸å…è®¸å°†å±žæ€§ realNameå’Œ heroNameèµ‹ç»™ undefined ã€‚å…¶å®žè¿™æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œå› ä¸ºå®ƒé˜»æ­¢æˆ‘ä»¬åˆ›å»ºå…¨å±€å˜é‡ã€‚ å¦å¤–ï¼Œä»¥å¤§å†™å½¢å¼ä¹¦å†™å‡½æ•°åæ„å‘³ç€æˆ‘ä»¬éœ€è¦å°†å®ƒè§†ä¸ºæž„é€ å‡½æ•°ï¼Œä½¿ç”¨ newè¿ç®—ç¬¦æ¥è°ƒç”¨ã€‚ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢ä¸Šé¢ä»£ç æ®µçš„æœ€åŽä¸¤è¡Œ 12onst superman = new Hero("Superman", "Clark Kent");console.log(superman); å†æ¬¡è¿è¡Œ node index.jså‘½ä»¤ï¼ŒçŽ°åœ¨ä¼šå¾—åˆ°ä½ é¢„æœŸçš„è¾“å‡ºã€‚ æž„é€ å‡½æ•°ä¸­çš„â€œthisâ€JavaScriptæ²¡æœ‰ç‰¹å®šçš„æž„é€ å‡½æ•°ã€‚æˆ‘ä»¬æ‰€èƒ½åšçš„å°±æ˜¯ä½¿ç”¨ newè¿ç®—ç¬¦å°†å‡½æ•°è°ƒç”¨è½¬æ¢ä¸ºæž„é€ å‡½æ•°è°ƒç”¨ï¼Œå¦‚ä¸Šä¸€èŠ‚æ‰€ç¤ºã€‚æž„é€ å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡å¹¶å°†å…¶è®¾ç½®ä¸ºå‡½æ•°çš„ thiså‚æ•°ã€‚æž„é€ å‡½æ•°ä¼šéšå¼çš„è¿”å›žè¿™ä¸ªå¯¹è±¡ï¼Œé™¤éžæˆ‘ä»¬æ˜Žç¡®çš„è¿”å›žäº†å¦å¤–ä¸€ä¸ªå¯¹è±¡ã€‚åœ¨ heroå‡½æ•°å†…éƒ¨æ·»åŠ ä¸‹é¢çš„ returnè¯­å¥ï¼š 1234return &#123; heroName: "Batman", realName: "Bruce Wayne",&#125;; å¦‚æžœæˆ‘ä»¬å†æ¬¡è¿è¡Œ nodeå‘½ä»¤ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° ä¸Šé¢çš„ returnè¯­å¥è¦†ç›–äº†æž„é€ å‡½æ•°è°ƒç”¨ã€‚ returnè¯­å¥ä¸ä¼šè¦†ç›–æž„é€ å‡½æ•°è°ƒç”¨çš„å”¯ä¸€æƒ…å½¢æ˜¯ï¼Œreturnè¯­å¥è¿”å›žçš„ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹è±¡å°†åŒ…å«åŽŸå§‹å€¼ã€‚ æ–¹æ³•ä¸­çš„â€œthisâ€å½“å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œ thisæŒ‡å‘çš„æ˜¯è¯¥å¯¹è±¡ï¼Œä¹Ÿç§°ä¸ºå‡½æ•°è°ƒç”¨çš„æŽ¥æ”¶å™¨(receiver)ã€‚å‡è®¾ heroå¯¹è±¡æœ‰ä¸€ä¸ª dialogueæ–¹æ³• ï¼Œé‚£ä¹ˆ dialogueä¸­çš„ thiså€¼æŒ‡å‘ heroæœ¬èº«ã€‚æ­¤æ—¶çš„ heroä¹Ÿè¢«ç§°ä¸º dialogueæ–¹æ³•è°ƒç”¨çš„æŽ¥æ”¶è€…ã€‚ 1234567const hero = &#123; heroName: "Batman", dialogue() &#123; console.log(`I am $&#123;this.heroName&#125;!`); &#125;&#125;;hero.dialogue(); è¿™ä¸ªä¾‹å­éžå¸¸ç®€å•ï¼Œä½†åœ¨å®žé™…æƒ…å†µä¸­ï¼Œæˆ‘ä»¬çš„æ–¹æ³•å¾ˆéš¾è·Ÿè¸ªæŽ¥æ”¶å™¨ã€‚åœ¨ index.jsçš„æœ«å°¾æ·»åŠ ä»¥ä¸‹ä»£ç æ®µã€‚ 12const saying = hero.dialogue;saying(); å¦‚æžœæˆ‘å°† dialogueçš„å¼•ç”¨å­˜å‚¨åœ¨å¦ä¸€ä¸ªå˜é‡ä¸­ï¼Œå¹¶å°†è¯¥å˜é‡ä½œä¸ºå‡½æ•°è°ƒç”¨ã€‚ nodeè¿è¡Œä»£ç  ï¼Œ thiså°†è¿”å›ž undefined ï¼Œå› ä¸ºè¯¥æ–¹æ³•å·²ç»ä¸¢å¤±äº†æŽ¥æ”¶å™¨ã€‚ thisæ­¤æ—¶æŒ‡å‘ global ï¼Œè€Œä¸æ˜¯ hero ã€‚ å½“æˆ‘ä»¬å°†ä¸€ä¸ªæ–¹æ³•ä½œä¸ºå›žè°ƒä¼ é€’ç»™å¦ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œé€šå¸¸ä¼šä¸¢å¤±æŽ¥æ”¶å™¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ åŒ…è£…å‡½æ•°æˆ–ä½¿ç”¨ bindæ–¹æ³•å°† thisä¸Žç‰¹å®šå¯¹è±¡ç»‘å®šæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ call() å’Œ apply()è™½ç„¶å‡½æ•°çš„ thiså€¼æ˜¯éšå¼è®¾ç½®çš„ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨å‡½æ•°æ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨ call()å’Œ apply()æ˜Žç¡®è®¾ç½® thiså‚æ•°ã€‚ æˆ‘ä»¬é‡æž„ä¸€ä¸‹å‰é¢ç« èŠ‚çš„ä»£ç ç‰‡æ®µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123456function dialogue () &#123; console.log (`I am $&#123;this.heroName&#125;`);&#125;const hero = &#123; heroName: 'Batman',&#125;; å¦‚æžœè¦å°† heroå¯¹è±¡ä½œä¸º dialogueå‡½æ•°çš„æŽ¥æ”¶å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨ call()æˆ– apply() ï¼š 123dialogue.call(hero)// ordialogue.apply(hero) å¦‚æžœä½ æ˜¯åœ¨éžä¸¥æ ¼æ¨¡å¼ä¸‹ä½¿ç”¨ callæˆ– apply ï¼ŒJavaScriptå¼•æ“Žä¼šå¿½ç•¥ä¼ é€’ç»™ callæˆ– applyçš„ nullæˆ– undefined ï¼ˆè¯‘è€…æ³¨ï¼šè¢«æ›¿æ¢ä¸ºglobalï¼‰ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå»ºè®®å§‹ç»ˆä»¥ä¸¥æ ¼æ¨¡å¼ç¼–å†™ä»£ç çš„åŽŸå› ä¹‹ä¸€ã€‚ bind()å½“æˆ‘ä»¬å°†ä¸€ä¸ªæ–¹æ³•ä½œä¸ºå›žè°ƒå‡½æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæ€»æ˜¯å­˜åœ¨ä¸¢å¤±æ–¹æ³•çš„åŽŸæœ‰æŽ¥æ”¶å™¨çš„é£Žé™©ï¼Œä½¿å¾— thiså‚æ•°æŒ‡å‘å…¨å±€å¯¹è±¡ã€‚ bind()æ–¹æ³•å¯ä»¥å°† thiså‚æ•°å›ºå®šçš„ç»‘å®šåˆ°ä¸€ä¸ªå€¼ä¸Šã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼Œ bindä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ dialogueå‡½æ•°ï¼Œå¹¶å°† thiså€¼è®¾ç½®ä¸º hero ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šbind()æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ï¼Œç§°ä¸ºç»‘å®šå‡½æ•°-bound function-BFï¼Œå½“è°ƒç”¨è¿™ä¸ªç»‘å®šå‡½æ•°æ—¶ï¼Œç»‘å®šå‡½æ•°ä¼šä»¥åˆ›å»ºå®ƒæ—¶ä¼ å…¥ bind()æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸º thisï¼Œä¼ å…¥ bind()æ–¹æ³•çš„ç¬¬äºŒä¸ªä»¥åŠä»¥åŽçš„å‚æ•°åŠ ä¸Šç»‘å®šå‡½æ•°è¿è¡Œæ—¶æœ¬èº«çš„å‚æ•°æŒ‰ç…§é¡ºåºä½œä¸ºåŽŸå‡½æ•°çš„å‚æ•°æ¥è°ƒç”¨åŽŸå‡½æ•°ã€‚ï¼‰ 1234567const hero = &#123; heroName: "Batman", dialogue() &#123; console.log(`I am $&#123;this.heroName&#125;`); &#125;&#125;;setTimeOut(hero.dialogue.bind(hero), 1000); è¿™æ ·çš„è¯ï¼Œå³ä½¿ä½¿ç”¨ callæˆ– applyæ–¹æ³•ä¹Ÿæ— æ³•æ”¹å˜ thisçš„å€¼ ã€‚ ç®­å¤´å‡½æ•°ä¸­çš„â€œthisâ€ç®­å¤´å‡½æ•°å†…çš„ thisä¸Žå…¶ä»–ç±»åž‹çš„JavaScriptå‡½æ•°æœ‰å¾ˆå¤§çš„ä¸åŒã€‚An arrow function uses the this value from its enclosing execution context, since it does have one of its own. ç®­å¤´å‡½æ•°ä¼šæ°¸ä¹…åœ°æ•èŽ· thiså€¼ï¼Œé˜»æ­¢ applyæˆ– callåŽç»­æ›´æ”¹å®ƒã€‚ ä¸ºäº†è§£é‡Šç®­å¤´å‡½æ•°ä¸­çš„ thisæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼š 12345const batman = this;const bruce = () =&gt; &#123; console.log(this === batman);&#125;;bruce(); // true è¿™é‡Œï¼Œæˆ‘ä»¬å°† thiså€¼å­˜å‚¨åœ¨å˜é‡ä¸­ï¼Œç„¶åŽå°†è¯¥å€¼ä¸Žç®­å¤´å‡½æ•°å†…çš„ thiså€¼è¿›è¡Œæ¯”è¾ƒã€‚åœ¨ç»ˆç«¯ä¸­è¿è¡Œ node index.jsï¼Œè¾“å‡ºåº”è¯¥ä¸º true ã€‚ ç®­å¤´å‡½æ•°å†…çš„ thiså€¼æ— æ³•æ˜Žç¡®è®¾ç½®ã€‚æ­¤å¤–ï¼Œä½¿ç”¨ call ã€ applyæˆ– bindç­‰æ–¹æ³•ç»™ thisä¼ å€¼ï¼Œç®­å¤´å‡½æ•°ä¼šå¿½ç•¥ã€‚ç®­å¤´å‡½æ•°å¼•ç”¨çš„æ˜¯ç®­å¤´å‡½æ•°åœ¨åˆ›å»ºæ—¶è®¾ç½®çš„ thiså€¼ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰thisç»‘å®šï¼Œå¿…é¡»é€šè¿‡æŸ¥æ‰¾ä½œç”¨åŸŸé“¾æ¥å†³å®šå®ƒçš„å€¼ï¼Œå¦‚æžœç®­å¤´å‡½æ•°è¢«éžç®­å¤´å‡½æ•°åŒ…è£¹ï¼Œé‚£ä¹ˆthiså€¼ç”±å¤–å›´æœ€è¿‘ä¸€å±‚éžç®­å¤´å‡½æ•°å†³å®šï¼Œå¦åˆ™ä¸ºundefinedã€‚ï¼‰ ç®­å¤´å‡½æ•°ä¹Ÿä¸èƒ½ç”¨ä½œæž„é€ å‡½æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½åœ¨ç®­å¤´å‡½æ•°å†…ç»™ thisè®¾ç½®å±žæ€§ã€‚ é‚£ä¹ˆç®­å¤´å‡½æ•°å¯¹ this å¯ä»¥åšä»€ä¹ˆå‘¢ï¼Ÿ ç®­å¤´å‡½æ•° å¯ä»¥ä½¿æˆ‘ä»¬åœ¨å›žè°ƒå‡½æ•°ä¸­è®¿é—®this ã€‚é€šè¿‡ä¸‹é¢çš„ counterå¯¹è±¡æ¥çœ‹çœ‹å¦‚ä½•åšåˆ°çš„ï¼š 123456789const counter = &#123; count: 0, increase() &#123; setInterval(function() &#123; console.log(++this.count); &#125;, 1000); &#125;&#125;counter.increase(); ä½¿ç”¨ node index.jsè¿è¡Œæ­¤ä»£ç ï¼Œåªä¼šå¾—åˆ°ä¸€ä¸ª NaNçš„åˆ—è¡¨ã€‚è¿™æ˜¯å› ä¸º this.countå·²ç»ä¸æ˜¯æŒ‡å‘ counterå¯¹è±¡äº†ã€‚å®ƒå®žé™…ä¸ŠæŒ‡å‘çš„ä¸º globalå¯¹è±¡ã€‚ å¦‚æžœæƒ³è®©è®¡æ•°å™¨æ­£å¸¸å·¥ä½œï¼Œå¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°é‡å†™å®ƒã€‚ å›žè°ƒå‡½æ•°ä½¿ç”¨ thisä¸Ž increaseæ–¹æ³•ç»‘å®šï¼Œ counterçŽ°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚ æ³¨æ„ ï¼šä¸è¦å°† ++this.count å†™æˆ this.count + 1ã€‚åŽè€…åªä¼šå¢žåŠ countçš„å€¼ä¸€æ¬¡ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šè¿”å›žç›¸åŒçš„å€¼ã€‚ Classä¸­çš„â€œthisâ€ç±»æ˜¯JavaScriptåº”ç”¨ç¨‹åºä¸­æœ€é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ç±»ä¸­çš„thisæœ‰ä½•ä¸åŒã€‚ ç±»é€šå¸¸åŒ…å«ä¸€ä¸ª constructor ï¼Œ thiså¯ä»¥æŒ‡å‘ä»»ä½•æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚ ä¸è¿‡åœ¨ä½œä¸ºæ–¹æ³•æ—¶ï¼Œå¦‚æžœè¯¥æ–¹æ³•ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨ï¼Œ thisä¹Ÿå¯ä»¥æŒ‡å‘ä»»ä½•å…¶ä»–å€¼ã€‚ä¸Žæ–¹æ³•ä¸€æ ·ï¼Œç±»ä¹Ÿå¯èƒ½å¤±åŽ»å¯¹æŽ¥æ”¶å™¨çš„è·Ÿè¸ªã€‚ æˆ‘ä»¬å°†ä¹‹å‰åˆ›å»ºçš„ Heroå‡½æ•°æ”¹é€ ä¸ºç±»ã€‚è¯¥ç±»åŒ…å«ä¸€ä¸ªæž„é€ å‡½æ•°å’Œä¸€ä¸ª dialogue()æ–¹æ³•ã€‚æœ€åŽï¼Œåˆ›å»ºä¸€ä¸ªç±»çš„å®žä¾‹å¹¶è°ƒç”¨ dialogueæ–¹æ³•ã€‚ 12345678910class Hero &#123; constructor(heroName) &#123; this.heroName = heroName; &#125; dialogue() &#123; console.log(`I am $&#123;this.heroName&#125;`) &#125;&#125;const batman = new Hero("Batman");batman.dialogue(); æž„é€ å‡½æ•°é‡Œçš„ thisæŒ‡å‘æ–°åˆ›å»ºçš„ ç±»å®žä¾‹ã€‚å½“æˆ‘ä»¬è°ƒç”¨ batman.dialogue()æ—¶ï¼Œ dialogue()ä½œä¸ºæ–¹æ³•è¢«è°ƒç”¨ï¼Œ batmanæ˜¯å®ƒçš„æŽ¥æ”¶å™¨ã€‚ ä½†æ˜¯å¦‚æžœæˆ‘ä»¬å°† dialogue()æ–¹æ³•çš„å¼•ç”¨å­˜å‚¨èµ·æ¥ï¼Œå¹¶ç¨åŽå°†å…¶ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼Œæˆ‘ä»¬ä¼šä¸¢å¤±è¯¥æ–¹æ³•çš„æŽ¥æ”¶å™¨ï¼Œæ­¤æ—¶ thiså‚æ•°æŒ‡å‘ undefined 12const say = batman.dialogue;say(); å‡ºçŽ°é”™è¯¯çš„åŽŸå› æ˜¯JavaScript ç±»æ˜¯éšå¼çš„è¿è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹çš„ã€‚æˆ‘ä»¬æ˜¯åœ¨æ²¡æœ‰ä»»ä½•è‡ªåŠ¨ç»‘å®šçš„æƒ…å†µä¸‹è°ƒç”¨ say()å‡½æ•°çš„ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä½¿ç”¨ bind()å°† dialogue()å‡½æ•°ä¸Ž batmanç»‘å®šåœ¨ä¸€èµ·ã€‚ 12const say = batman.dialogue.bind(batman);say(); æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ æž„é€ å‡½æ•°æ–¹æ³•ä¸­åšè¿™ä¸ªç»‘å®šã€‚ æ€»ç»“æˆ‘ä»¬éœ€è¦åœ¨JavaScriptä¸­ä½¿ç”¨ this ï¼Œå°±åƒæˆ‘ä»¬éœ€è¦åœ¨è‹±è¯­ä¸­ä½¿ç”¨ä»£è¯ä¸€æ ·ã€‚ä»¥è¿™ä¸¤å¥è¯ä¸ºä¾‹ï¼š Rajat loves DC Comics. Rajat also loves Marvel movies. æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£è¯å°†è¿™ä¸¤ä¸ªå¥å­ç»„åˆåœ¨ä¸€èµ·ï¼Œæ‰€ä»¥è¿™ä¸¤å¥è¯çŽ°åœ¨æˆäº†ï¼š Rajat loves DC Comics, and he also loves Marvel Comics è¿™ä¸ªç®€çŸ­çš„è¯­æ³•è¯¾å®Œç¾Žåœ°è§£é‡Šäº† thisåœ¨JavaScriptä¸­çš„é‡è¦æ€§ã€‚å°±åƒä»£è¯ heå°†ä¸¤ä¸ªå¥å­è¿žæŽ¥åœ¨ä¸€èµ·ä¸€æ ·ï¼Œ thiså¯ä»¥ä½œä¸ºå†æ¬¡å¼•ç”¨ç›¸åŒå†…å®¹çš„æ·å¾„ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>This</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¼–å†™ä¸€ä¸ªplugin]]></title>
    <url>%2F2018%2F08%2F03%2FTools%2F%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAplugin%2F</url>
    <content type="text"><![CDATA[å‰è¨€Webpack é€šè¿‡ Plugin æœºåˆ¶è®©å…¶æ›´åŠ çµæ´»ï¼Œä»¥é€‚åº”å„ç§åº”ç”¨åœºæ™¯ã€‚ åœ¨ Webpack è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æžœã€‚ æœ€åŸºç¡€çš„ Pluginä¸€ä¸ªæœ€åŸºç¡€çš„ Plugin çš„ä»£ç æ˜¯è¿™æ ·çš„ï¼š 1234567891011121314class BasicPlugin&#123; // åœ¨æž„é€ å‡½æ•°ä¸­èŽ·å–ç”¨æˆ·ç»™è¯¥æ’ä»¶ä¼ å…¥çš„é…ç½® construcor(options)&#123; &#125; apply(compiler)&#123; // Webpack ä¼šè°ƒç”¨ BasicPlugin å®žä¾‹çš„ apply æ–¹æ³•ç»™æ’ä»¶å®žä¾‹ä¼ å…¥ compiler å¯¹è±¡ compiler.plugin('compilatio',function(compilatio)&#123; &#125;) &#125;&#125;// å¯¼å‡º Pluginmodule.exports = BasicPlugin; åœ¨ä½¿ç”¨è¿™ä¸ª Plugin æ—¶ï¼Œç›¸å…³é…ç½®ä»£ç å¦‚ä¸‹ï¼š 123456const BasicPlugin = require('./BasicPlugin.js');module.export = &#123; plugins:[ new BasicPlugin(options), ]&#125; pluginå·¥ä½œåŽŸç†Webpack å¯åŠ¨åŽï¼Œåœ¨è¯»å–é…ç½®çš„è¿‡ç¨‹ä¸­ä¼šå…ˆæ‰§è¡Œ new BasicPlugin(options) åˆå§‹åŒ–ä¸€ä¸ª BasicPlugin èŽ·å¾—å…¶å®žä¾‹ã€‚ åœ¨åˆå§‹åŒ– compiler å¯¹è±¡åŽï¼Œå†è°ƒç”¨ basicPlugin.apply(compiler) ç»™æ’ä»¶å®žä¾‹ä¼ å…¥ compiler å¯¹è±¡ã€‚ æ’ä»¶å®žä¾‹åœ¨èŽ·å–åˆ° compiler å¯¹è±¡åŽï¼Œå°±å¯ä»¥é€šè¿‡ compiler.plugin(äº‹ä»¶åç§°, å›žè°ƒå‡½æ•°) ç›‘å¬åˆ° Webpack å¹¿æ’­å‡ºæ¥çš„äº‹ä»¶ã€‚ å¹¶ä¸”å¯ä»¥é€šè¿‡ compiler å¯¹è±¡åŽ»æ“ä½œ Webpackã€‚ é€šè¿‡ä»¥ä¸Šæœ€ç®€å•çš„ Plugin ç›¸ä¿¡ä½ å¤§æ¦‚æ˜Žç™½äº† Plugin çš„å·¥ä½œåŽŸç†ï¼Œä½†å®žé™…å¼€å‘ä¸­è¿˜æœ‰å¾ˆå¤šç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œä¸‹é¢æ¥è¯¦ç»†ä»‹ç»ã€‚ åœ¨å¼€å‘ Plugin æ—¶æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå¯¹è±¡å°±æ˜¯ Compiler å’Œ Compilationï¼Œå®ƒä»¬æ˜¯ Plugin å’Œ Webpack ä¹‹é—´çš„æ¡¥æ¢ã€‚ Compiler å’Œ Compilation çš„å«ä¹‰å¦‚ä¸‹ï¼š Compiler å¯¹è±¡åŒ…å«äº† Webpack çŽ¯å¢ƒæ‰€æœ‰çš„çš„é…ç½®ä¿¡æ¯ï¼ŒåŒ…å« optionsï¼Œloadersï¼Œplugins è¿™äº›ä¿¡æ¯ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨ Webpack å¯åŠ¨æ—¶å€™è¢«å®žä¾‹åŒ–ï¼Œå®ƒæ˜¯å…¨å±€å”¯ä¸€çš„ï¼Œå¯ä»¥ç®€å•åœ°æŠŠå®ƒç†è§£ä¸º Webpack å®žä¾‹ï¼› Compilation å¯¹è±¡åŒ…å«äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ç­‰ã€‚å½“ Webpack ä»¥å¼€å‘æ¨¡å¼è¿è¡Œæ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å˜åŒ–ï¼Œä¸€æ¬¡æ–°çš„ Compilation å°†è¢«åˆ›å»ºã€‚Compilation å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šäº‹ä»¶å›žè°ƒä¾›æ’ä»¶åšæ‰©å±•ã€‚é€šè¿‡ Compilation ä¹Ÿèƒ½è¯»å–åˆ° Compiler å¯¹è±¡ã€‚ Compiler å’Œ Compilation çš„åŒºåˆ«åœ¨äºŽï¼šCompiler ä»£è¡¨äº†æ•´ä¸ª Webpack ä»Žå¯åŠ¨åˆ°å…³é—­çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€Œ Compilation åªæ˜¯ä»£è¡¨äº†ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚ äº‹ä»¶æµWebpack å°±åƒä¸€æ¡ç”Ÿäº§çº¿ï¼Œè¦ç»è¿‡ä¸€ç³»åˆ—å¤„ç†æµç¨‹åŽæ‰èƒ½å°†æºæ–‡ä»¶è½¬æ¢æˆè¾“å‡ºç»“æžœã€‚ è¿™æ¡ç”Ÿäº§çº¿ä¸Šçš„æ¯ä¸ªå¤„ç†æµç¨‹çš„èŒè´£éƒ½æ˜¯å•ä¸€çš„ï¼Œå¤šä¸ªæµç¨‹ä¹‹é—´æœ‰å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œåªæœ‰å®Œæˆå½“å‰å¤„ç†åŽæ‰èƒ½äº¤ç»™ä¸‹ä¸€ä¸ªæµç¨‹åŽ»å¤„ç†ã€‚ æ’ä»¶å°±åƒæ˜¯ä¸€ä¸ªæ’å…¥åˆ°ç”Ÿäº§çº¿ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ç‰¹å®šçš„æ—¶æœºå¯¹ç”Ÿäº§çº¿ä¸Šçš„èµ„æºåšå¤„ç†ã€‚ Webpack é€šè¿‡ Tapable æ¥ç»„ç»‡è¿™æ¡å¤æ‚çš„ç”Ÿäº§çº¿ã€‚ Webpack åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šå¹¿æ’­äº‹ä»¶ï¼Œæ’ä»¶åªéœ€è¦ç›‘å¬å®ƒæ‰€å…³å¿ƒçš„äº‹ä»¶ï¼Œå°±èƒ½åŠ å…¥åˆ°è¿™æ¡ç”Ÿäº§çº¿ä¸­ï¼ŒåŽ»æ”¹å˜ç”Ÿäº§çº¿çš„è¿ä½œã€‚ Webpack çš„äº‹ä»¶æµæœºåˆ¶ä¿è¯äº†æ’ä»¶çš„æœ‰åºæ€§ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿæ‰©å±•æ€§å¾ˆå¥½ã€‚ Webpack çš„äº‹ä»¶æµæœºåˆ¶åº”ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå’Œ Node.js ä¸­çš„ EventEmitter éžå¸¸ç›¸ä¼¼ã€‚ Compiler å’Œ Compilation éƒ½ç»§æ‰¿è‡ª Tapableï¼Œå¯ä»¥ç›´æŽ¥åœ¨ Compiler å’Œ Compilation å¯¹è±¡ä¸Šå¹¿æ’­å’Œç›‘å¬äº‹ä»¶ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011121314/*** å¹¿æ’­å‡ºäº‹ä»¶* event-name ä¸ºäº‹ä»¶åç§°ï¼Œæ³¨æ„ä¸è¦å’ŒçŽ°æœ‰çš„äº‹ä»¶é‡å* params ä¸ºé™„å¸¦çš„å‚æ•°*/compiler.apply('event-name',params);/*** ç›‘å¬åç§°ä¸º event-name çš„äº‹ä»¶ï¼Œå½“ event-name äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œã€‚* åŒæ—¶å‡½æ•°ä¸­çš„ params å‚æ•°ä¸ºå¹¿æ’­äº‹ä»¶æ—¶é™„å¸¦çš„å‚æ•°ã€‚*/compiler.plugin('event-name',function(params) &#123;&#125;); åŒç†ï¼Œcompilation.apply å’Œ compilation.plugin ä½¿ç”¨æ–¹æ³•å’Œä¸Šé¢ä¸€è‡´ã€‚ åœ¨å¼€å‘æ’ä»¶æ—¶ï¼Œä½ å¯èƒ½ä¼šä¸çŸ¥é“è¯¥å¦‚ä½•ä¸‹æ‰‹ï¼Œå› ä¸ºä½ ä¸çŸ¥é“è¯¥ç›‘å¬å“ªä¸ªäº‹ä»¶æ‰èƒ½å®Œæˆä»»åŠ¡ã€‚ åœ¨å¼€å‘æ’ä»¶æ—¶ï¼Œè¿˜éœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ï¼š åªè¦èƒ½æ‹¿åˆ° Compiler æˆ– Compilation å¯¹è±¡ï¼Œå°±èƒ½å¹¿æ’­å‡ºæ–°çš„äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨æ–°å¼€å‘çš„æ’ä»¶ä¸­ä¹Ÿèƒ½å¹¿æ’­å‡ºäº‹ä»¶ï¼Œç»™å…¶å®ƒæ’ä»¶ç›‘å¬ä½¿ç”¨ã€‚ ä¼ ç»™æ¯ä¸ªæ’ä»¶çš„ Compiler å’Œ Compilation å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªå¼•ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªæ’ä»¶ä¸­ä¿®æ”¹äº† Compiler æˆ– Compilation å¯¹è±¡ä¸Šçš„å±žæ€§ï¼Œä¼šå½±å“åˆ°åŽé¢çš„æ’ä»¶ã€‚ æœ‰äº›äº‹ä»¶æ˜¯å¼‚æ­¥çš„ï¼Œè¿™äº›å¼‚æ­¥çš„äº‹ä»¶ä¼šé™„å¸¦ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå›žè°ƒå‡½æ•°ï¼Œåœ¨æ’ä»¶å¤„ç†å®Œä»»åŠ¡æ—¶éœ€è¦è°ƒç”¨å›žè°ƒå‡½æ•°é€šçŸ¥ Webpackï¼Œæ‰ä¼šè¿›å…¥ä¸‹ä¸€å¤„ç†æµç¨‹ã€‚ä¾‹å¦‚ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748 compiler.plugin('emit',function(compilation, callback) &#123; // æ”¯æŒå¤„ç†é€»è¾‘ // å¤„ç†å®Œæ¯•åŽæ‰§è¡Œ callback ä»¥é€šçŸ¥ Webpack // å¦‚æžœä¸æ‰§è¡Œ callbackï¼Œè¿è¡Œæµç¨‹å°†ä¼šä¸€ç›´å¡åœ¨è¿™ä¸å¾€ä¸‹æ‰§è¡Œ callback(); &#125;);``` ## å¸¸ç”¨ API### è¯»å–è¾“å‡ºèµ„æºã€ä»£ç å—ã€æ¨¡å—åŠå…¶ä¾èµ–æœ‰äº›æ’ä»¶å¯èƒ½éœ€è¦è¯»å– Webpack çš„å¤„ç†ç»“æžœï¼Œä¾‹å¦‚è¾“å‡ºèµ„æºã€ä»£ç å—ã€æ¨¡å—åŠå…¶ä¾èµ–ï¼Œä»¥ä¾¿åšä¸‹ä¸€æ­¥å¤„ç†ã€‚åœ¨ emit äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä»£è¡¨æºæ–‡ä»¶çš„è½¬æ¢å’Œç»„è£…å·²ç»å®Œæˆï¼Œåœ¨è¿™é‡Œå¯ä»¥è¯»å–åˆ°æœ€ç»ˆå°†è¾“å‡ºçš„èµ„æºã€ä»£ç å—ã€æ¨¡å—åŠå…¶ä¾èµ–ï¼Œå¹¶ä¸”å¯ä»¥ä¿®æ”¹è¾“å‡ºèµ„æºçš„å†…å®¹ã€‚ æ’ä»¶ä»£ç å¦‚ä¸‹ï¼š```jsclass Plugin &#123; apply(compiler) &#123; compiler.plugin('emit', function (compilation, callback) &#123; // compilation.chunks å­˜æ”¾æ‰€æœ‰ä»£ç å—ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ compilation.chunks.forEach(function (chunk) &#123; // chunk ä»£è¡¨ä¸€ä¸ªä»£ç å— // ä»£ç å—ç”±å¤šä¸ªæ¨¡å—ç»„æˆï¼Œé€šè¿‡ chunk.forEachModule èƒ½è¯»å–ç»„æˆä»£ç å—çš„æ¯ä¸ªæ¨¡å— chunk.forEachModule(function (module) &#123; // module ä»£è¡¨ä¸€ä¸ªæ¨¡å— // module.fileDependencies å­˜æ”¾å½“å‰æ¨¡å—çš„æ‰€æœ‰ä¾èµ–çš„æ–‡ä»¶è·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ module.fileDependencies.forEach(function (filepath) &#123; &#125;); &#125;); // Webpack ä¼šæ ¹æ® Chunk åŽ»ç”Ÿæˆè¾“å‡ºçš„æ–‡ä»¶èµ„æºï¼Œæ¯ä¸ª Chunk éƒ½å¯¹åº”ä¸€ä¸ªåŠå…¶ä»¥ä¸Šçš„è¾“å‡ºæ–‡ä»¶ // ä¾‹å¦‚åœ¨ Chunk ä¸­åŒ…å«äº† CSS æ¨¡å—å¹¶ä¸”ä½¿ç”¨äº† ExtractTextPlugin æ—¶ï¼Œ // è¯¥ Chunk å°±ä¼šç”Ÿæˆ .js å’Œ .css ä¸¤ä¸ªæ–‡ä»¶ chunk.files.forEach(function (filename) &#123; // compilation.assets å­˜æ”¾å½“å‰æ‰€æœ‰å³å°†è¾“å‡ºçš„èµ„æº // è°ƒç”¨ä¸€ä¸ªè¾“å‡ºèµ„æºçš„ source() æ–¹æ³•èƒ½èŽ·å–åˆ°è¾“å‡ºèµ„æºçš„å†…å®¹ let source = compilation.assets[filename].source(); &#125;); &#125;); // è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶ï¼Œè¦è®°å¾—è°ƒç”¨ callback é€šçŸ¥ Webpack æœ¬æ¬¡äº‹ä»¶ç›‘å¬å¤„ç†ç»“æŸã€‚ // å¦‚æžœå¿˜è®°äº†è°ƒç”¨ callbackï¼ŒWebpack å°†ä¸€ç›´å¡åœ¨è¿™é‡Œè€Œä¸ä¼šå¾€åŽæ‰§è¡Œã€‚ callback(); &#125;) &#125;&#125; ç›‘å¬æ–‡ä»¶çš„å˜åŒ–åœ¨å¼€å‘æ’ä»¶æ—¶ç»å¸¸éœ€è¦çŸ¥é“æ˜¯å“ªä¸ªæ–‡ä»¶å‘ç”Ÿå˜åŒ–å¯¼è‡´äº†æ–°çš„ Compilationï¼Œä¸ºæ­¤å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š 12345678910// å½“ä¾èµ–çš„æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ä¼šè§¦å‘ watch-run äº‹ä»¶compiler.plugin('watch-run', (watching, callback) =&gt; &#123; // èŽ·å–å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶åˆ—è¡¨ const changedFiles = watching.compiler.watchFileSystem.watcher.mtimes; // changedFiles æ ¼å¼ä¸ºé”®å€¼å¯¹ï¼Œé”®ä¸ºå‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶è·¯å¾„ã€‚ if (changedFiles[filePath] !== undefined) &#123; // filePath å¯¹åº”çš„æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ– &#125; callback();&#125;); é»˜è®¤æƒ…å†µä¸‹ Webpack åªä¼šç›‘è§†å…¥å£å’Œå…¶ä¾èµ–çš„æ¨¡å—æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹é¡¹ç›®å¯èƒ½éœ€è¦å¼•å…¥æ–°çš„æ–‡ä»¶ï¼Œä¾‹å¦‚å¼•å…¥ä¸€ä¸ª HTML æ–‡ä»¶ã€‚ ç”±äºŽ JavaScript æ–‡ä»¶ä¸ä¼šåŽ»å¯¼å…¥ HTML æ–‡ä»¶ï¼ŒWebpack å°±ä¸ä¼šç›‘å¬ HTML æ–‡ä»¶çš„å˜åŒ–ï¼Œç¼–è¾‘ HTML æ–‡ä»¶æ—¶å°±ä¸ä¼šé‡æ–°è§¦å‘æ–°çš„ Compilationã€‚ ä¸ºäº†ç›‘å¬ HTML æ–‡ä»¶çš„å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ HTML æ–‡ä»¶åŠ å…¥åˆ°ä¾èµ–åˆ—è¡¨ä¸­ï¼Œä¸ºæ­¤å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š 12345compiler.plugin('after-compile', (compilation, callback) =&gt; &#123; // æŠŠ HTML æ–‡ä»¶æ·»åŠ åˆ°æ–‡ä»¶ä¾èµ–åˆ—è¡¨ï¼Œå¥½è®© Webpack åŽ»ç›‘å¬ HTML æ¨¡å—æ–‡ä»¶ï¼Œåœ¨ HTML æ¨¡ç‰ˆæ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°å¯åŠ¨ä¸€æ¬¡ç¼–è¯‘ compilation.fileDependencies.push(filePath); callback();&#125;) ä¿®æ”¹è¾“å‡ºèµ„æºæœ‰äº›åœºæ™¯ä¸‹æ’ä»¶éœ€è¦ä¿®æ”¹ã€å¢žåŠ ã€åˆ é™¤è¾“å‡ºçš„èµ„æºï¼Œè¦åšåˆ°è¿™ç‚¹éœ€è¦ç›‘å¬ emit äº‹ä»¶ï¼Œå› ä¸ºå‘ç”Ÿ emit äº‹ä»¶æ—¶æ‰€æœ‰æ¨¡å—çš„è½¬æ¢å’Œä»£ç å—å¯¹åº”çš„æ–‡ä»¶å·²ç»ç”Ÿæˆå¥½ï¼Œ éœ€è¦è¾“å‡ºçš„èµ„æºå³å°†è¾“å‡ºï¼Œå› æ­¤ emit äº‹ä»¶æ˜¯ä¿®æ”¹ Webpack è¾“å‡ºèµ„æºçš„æœ€åŽæ—¶æœºã€‚ æ‰€æœ‰éœ€è¦è¾“å‡ºçš„èµ„æºä¼šå­˜æ”¾åœ¨ compilation.assets ä¸­ï¼Œcompilation.assets æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œé”®ä¸ºéœ€è¦è¾“å‡ºçš„æ–‡ä»¶åç§°ï¼Œå€¼ä¸ºæ–‡ä»¶å¯¹åº”çš„å†…å®¹ã€‚ è®¾ç½® compilation.assets çš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415compiler.plugin('emit', (compilation, callback) =&gt; &#123; // è®¾ç½®åç§°ä¸º fileName çš„è¾“å‡ºèµ„æº compilation.assets[fileName] = &#123; // è¿”å›žæ–‡ä»¶å†…å®¹ source: () =&gt; &#123; // fileContent æ—¢å¯ä»¥æ˜¯ä»£è¡¨æ–‡æœ¬æ–‡ä»¶çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»£è¡¨äºŒè¿›åˆ¶æ–‡ä»¶çš„ Buffer return fileContent; &#125;, // è¿”å›žæ–‡ä»¶å¤§å° size: () =&gt; &#123; return Buffer.byteLength(fileContent, 'utf8'); &#125; &#125;; callback();&#125;); è¯»å– compilation.assets çš„ä»£ç å¦‚ä¸‹ï¼š 123456789compiler.plugin('emit', (compilation, callback) =&gt; &#123; // è¯»å–åç§°ä¸º fileName çš„è¾“å‡ºèµ„æº const asset = compilation.assets[fileName]; // èŽ·å–è¾“å‡ºèµ„æºçš„å†…å®¹ asset.source(); // èŽ·å–è¾“å‡ºèµ„æºçš„æ–‡ä»¶å¤§å° asset.size(); callback();&#125;); åˆ¤æ–­ Webpack ä½¿ç”¨äº†å“ªäº›æ’ä»¶åœ¨å¼€å‘ä¸€ä¸ªæ’ä»¶æ—¶å¯èƒ½éœ€è¦æ ¹æ®å½“å‰é…ç½®æ˜¯å¦ä½¿ç”¨äº†å…¶å®ƒæŸä¸ªæ’ä»¶è€Œåšä¸‹ä¸€æ­¥å†³å®šï¼Œå› æ­¤éœ€è¦è¯»å– Webpack å½“å‰çš„æ’ä»¶é…ç½®æƒ…å†µã€‚ ä»¥åˆ¤æ–­å½“å‰æ˜¯å¦ä½¿ç”¨äº† ExtractTextPlugin ä¸ºä¾‹ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š 12345678// åˆ¤æ–­å½“å‰é…ç½®ä½¿ç”¨ä½¿ç”¨äº† ExtractTextPluginï¼Œ// compiler å‚æ•°å³ä¸º Webpack åœ¨ apply(compiler) ä¸­ä¼ å…¥çš„å‚æ•°function hasExtractTextPlugin(compiler) &#123; // å½“å‰é…ç½®æ‰€æœ‰ä½¿ç”¨çš„æ’ä»¶åˆ—è¡¨ const plugins = compiler.options.plugins; // åŽ» plugins ä¸­å¯»æ‰¾æœ‰æ²¡æœ‰ ExtractTextPlugin çš„å®žä¾‹ return plugins.find(plugin=&gt;plugin.__proto__.constructor === ExtractTextPlugin) != null;&#125; å®žæˆ˜ä¸‹é¢æˆ‘ä»¬ä¸¾ä¸€ä¸ªå®žé™…çš„ä¾‹å­ï¼Œå¸¦ä½ ä¸€æ­¥æ­¥åŽ»å®žçŽ°ä¸€ä¸ªæ’ä»¶ã€‚ è¯¥æ’ä»¶çš„åç§°å–åå« EndWebpackPluginï¼Œä½œç”¨æ˜¯åœ¨ Webpack å³å°†é€€å‡ºæ—¶å†é™„åŠ ä¸€äº›é¢å¤–çš„æ“ä½œï¼Œä¾‹å¦‚åœ¨ Webpack æˆåŠŸç¼–è¯‘å’Œè¾“å‡ºäº†æ–‡ä»¶åŽæ‰§è¡Œå‘å¸ƒæ“ä½œæŠŠè¾“å‡ºçš„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚ åŒæ—¶è¯¥æ’ä»¶è¿˜èƒ½åŒºåˆ† Webpack æž„å»ºæ˜¯å¦æ‰§è¡ŒæˆåŠŸã€‚ä½¿ç”¨è¯¥æ’ä»¶æ—¶æ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011module.exports = &#123; plugins:[ // åœ¨åˆå§‹åŒ– EndWebpackPlugin æ—¶ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯åœ¨æˆåŠŸæ—¶çš„å›žè°ƒå‡½æ•°å’Œå¤±è´¥æ—¶çš„å›žè°ƒå‡½æ•°ï¼› new EndWebpackPlugin(() =&gt; &#123; // Webpack æž„å»ºæˆåŠŸï¼Œå¹¶ä¸”æ–‡ä»¶è¾“å‡ºäº†åŽä¼šæ‰§è¡Œåˆ°è¿™é‡Œï¼Œåœ¨è¿™é‡Œå¯ä»¥åšå‘å¸ƒæ–‡ä»¶æ“ä½œ &#125;, (err) =&gt; &#123; // Webpack æž„å»ºå¤±è´¥ï¼Œerr æ˜¯å¯¼è‡´é”™è¯¯çš„åŽŸå›  console.error(err); &#125;) ]&#125; è¦å®žçŽ°è¯¥æ’ä»¶ï¼Œéœ€è¦å€ŸåŠ©ä¸¤ä¸ªäº‹ä»¶ï¼š doneï¼šåœ¨æˆåŠŸæž„å»ºå¹¶ä¸”è¾“å‡ºäº†æ–‡ä»¶åŽï¼ŒWebpack å³å°†é€€å‡ºæ—¶å‘ç”Ÿï¼› failedï¼šåœ¨æž„å»ºå‡ºçŽ°å¼‚å¸¸å¯¼è‡´æž„å»ºå¤±è´¥ï¼ŒWebpack å³å°†é€€å‡ºæ—¶å‘ç”Ÿï¼› å®žçŽ°è¯¥æ’ä»¶éžå¸¸ç®€å•ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021class EndWebpackPlugin &#123; constructor(doneCallback, failCallback) &#123; // å­˜ä¸‹åœ¨æž„é€ å‡½æ•°ä¸­ä¼ å…¥çš„å›žè°ƒå‡½æ•° this.doneCallback = doneCallback; this.failCallback = failCallback; &#125; apply(compiler) &#123; compiler.plugin('done', (stats) =&gt; &#123; // åœ¨ done äº‹ä»¶ä¸­å›žè°ƒ doneCallback this.doneCallback(stats); &#125;); compiler.plugin('failed', (err) =&gt; &#123; // åœ¨ failed äº‹ä»¶ä¸­å›žè°ƒ failCallback this.failCallback(err); &#125;); &#125;&#125;// å¯¼å‡ºæ’ä»¶module.exports = EndWebpackPlugin; ä»Žå¼€å‘è¿™ä¸ªæ’ä»¶å¯ä»¥çœ‹å‡ºï¼Œæ‰¾åˆ°åˆé€‚çš„äº‹ä»¶ç‚¹åŽ»å®ŒæˆåŠŸèƒ½åœ¨å¼€å‘æ’ä»¶æ—¶æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚ åœ¨ 5-1å·¥ä½œåŽŸç†æ¦‚æ‹¬ ä¸­è¯¦ç»†ä»‹ç»è¿‡ Webpack åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¹¿æ’­å‡ºå¸¸ç”¨äº‹ä»¶ï¼Œä½ å¯ä»¥ä»Žä¸­æ‰¾åˆ°ä½ éœ€è¦çš„äº‹ä»¶ã€‚]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¼–å†™ä¸€ä¸ªloader]]></title>
    <url>%2F2018%2F08%2F03%2FTools%2F%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAloader%2F</url>
    <content type="text"><![CDATA[å‰è¨€Loader å°±åƒæ˜¯ä¸€ä¸ªç¿»è¯‘å‘˜ï¼Œèƒ½æŠŠæºæ–‡ä»¶ç»è¿‡è½¬åŒ–åŽè¾“å‡ºæ–°çš„ç»“æžœï¼Œå¹¶ä¸”ä¸€ä¸ªæ–‡ä»¶è¿˜å¯ä»¥é“¾å¼çš„ç»è¿‡å¤šä¸ªç¿»è¯‘å‘˜ç¿»è¯‘ã€‚ ä»¥å¤„ç† SCSS æ–‡ä»¶ä¸ºä¾‹ï¼š SCSS æºä»£ç ä¼šå…ˆäº¤ç»™ sass-loader æŠŠ SCSS è½¬æ¢æˆ CSSï¼›æŠŠ sass-loader è¾“å‡ºçš„ CSS äº¤ç»™ css-loader å¤„ç†ï¼Œæ‰¾å‡º CSS ä¸­ä¾èµ–çš„èµ„æºã€åŽ‹ç¼© CSS ç­‰ï¼›æŠŠ css-loader è¾“å‡ºçš„ CSS äº¤ç»™ style-loader å¤„ç†ï¼Œè½¬æ¢æˆé€šè¿‡è„šæœ¬åŠ è½½çš„ JavaScript ä»£ç ï¼› 12345678910111213141516171819module.exports = &#123; module:&#123; rules:[ // å¢žåŠ å¯¹ SCSS æ–‡ä»¶çš„æ”¯æŒ test: /\.scss/, // SCSS æ–‡ä»¶çš„å¤„ç†é¡ºåºä¸ºå…ˆ sass-loader å† css-loader å† style-loader use:[ 'style.loader', &#123; loader:'css-loader', options:&#123; minimize:true, &#125; &#125;, 'scss-loader' ], ] &#125;&#125; Loader çš„èŒè´£ç”±ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼šä¸€ä¸ª Loader çš„èŒè´£æ˜¯å•ä¸€çš„ï¼Œåªéœ€è¦å®Œæˆä¸€ç§è½¬æ¢ã€‚ å¦‚æžœä¸€ä¸ªæºæ–‡ä»¶éœ€è¦ç»åŽ†å¤šæ­¥è½¬æ¢æ‰èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œå°±é€šè¿‡å¤šä¸ª Loader åŽ»è½¬æ¢ã€‚ åœ¨è°ƒç”¨å¤šä¸ª Loader åŽ»è½¬æ¢ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ¯ä¸ª Loader ä¼šé“¾å¼çš„é¡ºåºæ‰§è¡Œï¼Œ ç¬¬ä¸€ä¸ª Loader å°†ä¼šæ‹¿åˆ°éœ€å¤„ç†çš„åŽŸå†…å®¹ï¼Œä¸Šä¸€ä¸ª Loader å¤„ç†åŽçš„ç»“æžœä¼šä¼ ç»™ä¸‹ä¸€ä¸ªæŽ¥ç€å¤„ç†ï¼Œæœ€åŽçš„ Loader å°†å¤„ç†åŽçš„æœ€ç»ˆç»“æžœè¿”å›žç»™ Webpackã€‚ æ‰€ä»¥ï¼Œåœ¨ä½ å¼€å‘ä¸€ä¸ª Loader æ—¶ï¼Œè¯· ä¿æŒå…¶èŒè´£çš„å•ä¸€æ€§ï¼Œä½ åªéœ€ å…³å¿ƒè¾“å…¥å’Œè¾“å‡ºã€‚ç”±äºŽ Webpack æ˜¯è¿è¡Œåœ¨ Node.js ä¹‹ä¸Šçš„ï¼Œä¸€ä¸ª Loader å…¶å®žå°±æ˜¯ä¸€ä¸ª Node.js æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—éœ€è¦å¯¼å‡ºä¸€ä¸ªå‡½æ•°ã€‚ è¿™ä¸ªå¯¼å‡ºçš„å‡½æ•°çš„å·¥ä½œå°±æ˜¯èŽ·å¾—å¤„ç†å‰çš„åŽŸå†…å®¹ï¼Œå¯¹åŽŸå†…å®¹æ‰§è¡Œå¤„ç†åŽï¼Œè¿”å›žå¤„ç†åŽçš„å†…å®¹ã€‚ ä¸€ä¸ªç®€å•çš„loaderæºç  12345module.exports = function(source)&#123; // source ä¸º compiler ä¼ é€’ç»™ Loader çš„ä¸€ä¸ªæ–‡ä»¶çš„åŽŸå†…å®¹ // è¯¥å‡½æ•°éœ€è¦è¿”å›žå¤„ç†åŽçš„å†…å®¹ï¼Œè¿™é‡Œç®€å•èµ·è§ï¼Œç›´æŽ¥æŠŠåŽŸå†…å®¹è¿”å›žäº†ï¼Œç›¸å½“äºŽè¯¥ Loader æ²¡æœ‰åšä»»ä½•è½¬æ¢ return source;&#125; ç”±äºŽ Loader è¿è¡Œåœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥è°ƒç”¨ä»»ä½• Node.js è‡ªå¸¦çš„ APIï¼Œæˆ–è€…å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—è¿›è¡Œè°ƒç”¨ï¼š 1234const sass = require('node-sass');module.exports = function(source) &#123; return sass(source);&#125;; Loader è¿›é˜¶ä»¥ä¸Šåªæ˜¯ä¸ªæœ€ç®€å•çš„ Loaderï¼ŒWebpack è¿˜æä¾›ä¸€äº› API ä¾› Loader è°ƒç”¨ï¼Œä¸‹é¢æ¥ä¸€ä¸€ä»‹ç»ã€‚ èŽ·å¾— Loader çš„ options**åœ¨æœ€ä¸Šé¢å¤„ç† SCSS æ–‡ä»¶çš„ Webpack é…ç½®ä¸­ï¼Œç»™ css-loader ä¼ äº† options å‚æ•°ï¼Œä»¥æŽ§åˆ¶ css-loaderã€‚ å¦‚ä½•åœ¨è‡ªå·±ç¼–å†™çš„ Loader ä¸­èŽ·å–åˆ°ç”¨æˆ·ä¼ å…¥çš„ options å‘¢ï¼Ÿéœ€è¦è¿™æ ·åšï¼š 123456const loaderUtils = require('loader-utils');module.exports = function(source) &#123; // èŽ·å–åˆ°ç”¨æˆ·ç»™å½“å‰ Loader ä¼ å…¥çš„ options const options = loaderUtils.getOptions(this); return source;&#125;; è¿”å›žå…¶å®ƒç»“æžœä¸Šé¢çš„ Loader éƒ½åªæ˜¯è¿”å›žäº†åŽŸå†…å®¹è½¬æ¢åŽçš„å†…å®¹ï¼Œä½†æœ‰äº›åœºæ™¯ä¸‹è¿˜éœ€è¦è¿”å›žé™¤äº†å†…å®¹ä¹‹å¤–çš„ä¸œè¥¿ã€‚ ä¾‹å¦‚ä»¥ç”¨ babel-loader è½¬æ¢ ES6 ä»£ç ä¸ºä¾‹ï¼Œå®ƒè¿˜éœ€è¦è¾“å‡ºè½¬æ¢åŽçš„ ES5 ä»£ç å¯¹åº”çš„ Source Mapï¼Œä»¥æ–¹ä¾¿è°ƒè¯•æºç ã€‚ ä¸ºäº†æŠŠ Source Map ä¹Ÿä¸€èµ·éšç€ ES5 ä»£ç è¿”å›žç»™ Webpackï¼Œå¯ä»¥è¿™æ ·å†™ï¼š 1234567module.exports = function(source) &#123; // é€šè¿‡ this.callback å‘Šè¯‰ Webpack è¿”å›žçš„ç»“æžœ this.callback(null, source, sourceMaps); // å½“ä½ ä½¿ç”¨ this.callback è¿”å›žå†…å®¹æ—¶ï¼Œè¯¥ Loader å¿…é¡»è¿”å›ž undefinedï¼Œ // ä»¥è®© Webpack çŸ¥é“è¯¥ Loader è¿”å›žçš„ç»“æžœåœ¨ this.callback ä¸­ï¼Œè€Œä¸æ˜¯ return ä¸­ return;&#125;; å…¶ä¸­çš„ this.callback æ˜¯ Webpack ç»™ Loader æ³¨å…¥çš„ APIï¼Œä»¥æ–¹ä¾¿ Loader å’Œ Webpack ä¹‹é—´é€šä¿¡ã€‚ this.callback çš„è¯¦ç»†ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011this.callback( // å½“æ— æ³•è½¬æ¢åŽŸå†…å®¹æ—¶ï¼Œç»™ Webpack è¿”å›žä¸€ä¸ª Error err: Error | null, // åŽŸå†…å®¹è½¬æ¢åŽçš„å†…å®¹ content: string | Buffer, // ç”¨äºŽæŠŠè½¬æ¢åŽçš„å†…å®¹å¾—å‡ºåŽŸå†…å®¹çš„ Source Mapï¼Œæ–¹ä¾¿è°ƒè¯• sourceMap?: SourceMap, // å¦‚æžœæœ¬æ¬¡è½¬æ¢ä¸ºåŽŸå†…å®¹ç”Ÿæˆäº† AST è¯­æ³•æ ‘ï¼Œå¯ä»¥æŠŠè¿™ä¸ª AST è¿”å›žï¼Œ // ä»¥æ–¹ä¾¿ä¹‹åŽéœ€è¦ AST çš„ Loader å¤ç”¨è¯¥ ASTï¼Œä»¥é¿å…é‡å¤ç”Ÿæˆ ASTï¼Œæå‡æ€§èƒ½ abstractSyntaxTree?: AST); Source Map çš„ç”Ÿæˆå¾ˆè€—æ—¶ï¼Œé€šå¸¸åœ¨å¼€å‘çŽ¯å¢ƒä¸‹æ‰ä¼šç”Ÿæˆ Source Mapï¼Œå…¶å®ƒçŽ¯å¢ƒä¸‹ä¸ç”¨ç”Ÿæˆï¼Œä»¥åŠ é€Ÿæž„å»ºã€‚ ä¸ºæ­¤ Webpack ä¸º Loader æä¾›äº† this.sourceMap API åŽ»å‘Šè¯‰ Loader å½“å‰æž„å»ºçŽ¯å¢ƒä¸‹ç”¨æˆ·æ˜¯å¦éœ€è¦ Source Mapã€‚ å¦‚æžœä½ ç¼–å†™çš„ Loader ä¼šç”Ÿæˆ Source Mapï¼Œè¯·è€ƒè™‘åˆ°è¿™ç‚¹ã€‚ åŒæ­¥ä¸Žå¼‚æ­¥Loader æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¹‹åˆ†ï¼Œä¸Šé¢ä»‹ç»çš„ Loader éƒ½æ˜¯åŒæ­¥çš„ Loaderï¼Œå› ä¸ºå®ƒä»¬çš„è½¬æ¢æµç¨‹éƒ½æ˜¯åŒæ­¥çš„ï¼Œè½¬æ¢å®ŒæˆåŽå†è¿”å›žç»“æžœã€‚ ä½†åœ¨æœ‰äº›åœºæ™¯ä¸‹è½¬æ¢çš„æ­¥éª¤åªèƒ½æ˜¯å¼‚æ­¥å®Œæˆçš„ï¼Œä¾‹å¦‚ä½ éœ€è¦é€šè¿‡ç½‘ç»œè¯·æ±‚æ‰èƒ½å¾—å‡ºç»“æžœï¼Œå¦‚æžœé‡‡ç”¨åŒæ­¥çš„æ–¹å¼ç½‘ç»œè¯·æ±‚å°±ä¼šé˜»å¡žæ•´ä¸ªæž„å»ºï¼Œå¯¼è‡´æž„å»ºéžå¸¸ç¼“æ…¢ã€‚ åœ¨è½¬æ¢æ­¥éª¤æ˜¯å¼‚æ­¥æ—¶ï¼Œä½ å¯ä»¥è¿™æ ·ï¼š 12345678module.exports = function(source) &#123; // å‘Šè¯‰ Webpack æœ¬æ¬¡è½¬æ¢æ˜¯å¼‚æ­¥çš„ï¼ŒLoader ä¼šåœ¨ callback ä¸­å›žè°ƒç»“æžœ var callback = this.async(); someAsyncOperation(source, function(err, result, sourceMaps, ast) &#123; // é€šè¿‡ callback è¿”å›žå¼‚æ­¥æ‰§è¡ŒåŽçš„ç»“æžœ callback(err, result, sourceMaps, ast); &#125;);&#125;; å¤„ç†äºŒè¿›åˆ¶æ•°æ®åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼ŒWebpack ä¼ ç»™ Loader çš„åŽŸå†…å®¹éƒ½æ˜¯ UTF-8 æ ¼å¼ç¼–ç çš„å­—ç¬¦ä¸²ã€‚ ä½†æœ‰äº›åœºæ™¯ä¸‹ Loader ä¸æ˜¯å¤„ç†æ–‡æœ¬æ–‡ä»¶ï¼Œè€Œæ˜¯å¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¾‹å¦‚ file-loaderï¼Œå°±éœ€è¦ Webpack ç»™ Loader ä¼ å…¥äºŒè¿›åˆ¶æ ¼å¼çš„æ•°æ®ã€‚ ä¸ºæ­¤ï¼Œä½ éœ€è¦è¿™æ ·ç¼–å†™ Loaderï¼š 123456789module.exports = function(source) &#123; // åœ¨ exports.raw === true æ—¶ï¼ŒWebpack ä¼ ç»™ Loader çš„ source æ˜¯ Buffer ç±»åž‹çš„ source instanceof Buffer === true; // Loader è¿”å›žçš„ç±»åž‹ä¹Ÿå¯ä»¥æ˜¯ Buffer ç±»åž‹çš„ // åœ¨ exports.raw !== true æ—¶ï¼ŒLoader ä¹Ÿå¯ä»¥è¿”å›ž Buffer ç±»åž‹çš„ç»“æžœ return source;&#125;;// é€šè¿‡ exports.raw å±žæ€§å‘Šè¯‰ Webpack è¯¥ Loader æ˜¯å¦éœ€è¦äºŒè¿›åˆ¶æ•°æ®module.exports.raw = true; ç¼“å­˜åŠ é€Ÿåœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œæœ‰äº›è½¬æ¢æ“ä½œéœ€è¦å¤§é‡è®¡ç®—éžå¸¸è€—æ—¶ï¼Œå¦‚æžœæ¯æ¬¡æž„å»ºéƒ½é‡æ–°æ‰§è¡Œé‡å¤çš„è½¬æ¢æ“ä½œï¼Œæž„å»ºå°†ä¼šå˜å¾—éžå¸¸ç¼“æ…¢ã€‚ ä¸ºæ­¤ï¼ŒWebpack ä¼šé»˜è®¤ç¼“å­˜æ‰€æœ‰ Loader çš„å¤„ç†ç»“æžœï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨éœ€è¦è¢«å¤„ç†çš„æ–‡ä»¶æˆ–è€…å…¶ä¾èµ–çš„æ–‡ä»¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ æ˜¯ä¸ä¼šé‡æ–°è°ƒç”¨å¯¹åº”çš„ Loader åŽ»æ‰§è¡Œè½¬æ¢æ“ä½œçš„ã€‚ å¦‚æžœä½ æƒ³è®© Webpack ä¸ç¼“å­˜è¯¥ Loader çš„å¤„ç†ç»“æžœï¼Œå¯ä»¥è¿™æ ·ï¼š 12345module.exports = function(source) &#123; // å…³é—­è¯¥ Loader çš„ç¼“å­˜åŠŸèƒ½ this.cacheable(false); return source;&#125;; å…¶å®ƒ Loader APIé™¤äº†ä»¥ä¸Šæåˆ°çš„åœ¨ Loader ä¸­èƒ½è°ƒç”¨çš„ Webpack API å¤–ï¼Œè¿˜å­˜åœ¨ä»¥ä¸‹å¸¸ç”¨ APIï¼š this.contextï¼šå½“å‰å¤„ç†æ–‡ä»¶çš„æ‰€åœ¨ç›®å½•ï¼Œå‡å¦‚å½“å‰ Loader å¤„ç†çš„æ–‡ä»¶æ˜¯ /src/main.jsï¼Œåˆ™ this.context å°±ç­‰äºŽ /srcã€‚ this.resourceï¼šå½“å‰å¤„ç†æ–‡ä»¶çš„å®Œæ•´è¯·æ±‚è·¯å¾„ï¼ŒåŒ…æ‹¬ querystringï¼Œä¾‹å¦‚ /src/main.js?name=1ã€‚ this.resourcePathï¼šå½“å‰å¤„ç†æ–‡ä»¶çš„è·¯å¾„ï¼Œä¾‹å¦‚ /src/main.jsã€‚ this.resourceQueryï¼šå½“å‰å¤„ç†æ–‡ä»¶çš„ querystringã€‚ this.targetï¼šç­‰äºŽ Webpack é…ç½®ä¸­çš„ Targetï¼Œè¯¦æƒ…è§ 2-7å…¶å®ƒé…ç½®é¡¹-Targetã€‚ this.loadModuleï¼šå½“ Loader åœ¨å¤„ç†ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå¦‚æžœä¾èµ–å…¶å®ƒæ–‡ä»¶çš„å¤„ç†ç»“æžœæ‰èƒ½å¾—å‡ºå½“å‰æ–‡ä»¶çš„ç»“æžœæ—¶ï¼Œ å°±å¯ä»¥é€šè¿‡ this.loadModule(request: string, callback: function(err, source, sourceMap, module)) åŽ»èŽ·å¾— request å¯¹åº”æ–‡ä»¶çš„å¤„ç†ç»“æžœã€‚ this.resolveï¼šåƒ require è¯­å¥ä¸€æ ·èŽ·å¾—æŒ‡å®šæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œä½¿ç”¨æ–¹æ³•ä¸º resolve(context: string, &gt; * request: string, callback: function(err, result: string))ã€‚ this.addDependencyï¼šç»™å½“å‰å¤„ç†æ–‡ä»¶æ·»åŠ å…¶ä¾èµ–çš„æ–‡ä»¶ï¼Œä»¥ä¾¿å†å…¶ä¾èµ–çš„æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé‡æ–°è°ƒç”¨ Loader å¤„ç†è¯¥æ–‡ä»¶ã€‚ä½¿ç”¨æ–¹æ³•ä¸º addDependency(file: string)ã€‚ this.addContextDependencyï¼šå’Œ addDependency ç±»ä¼¼ï¼Œä½† addContextDependency æ˜¯æŠŠæ•´ä¸ªç›®å½•åŠ å…¥åˆ°å½“å‰æ­£åœ¨å¤„ç†æ–‡ä»¶çš„ä¾èµ–ä¸­ã€‚ä½¿ç”¨æ–¹æ³•ä¸º addContextDependency(directory: string)ã€‚ this.clearDependenciesï¼šæ¸…é™¤å½“å‰æ­£åœ¨å¤„ç†æ–‡ä»¶çš„æ‰€æœ‰ä¾èµ–ï¼Œä½¿ç”¨æ–¹æ³•ä¸º clearDependencies()ã€‚ this.emitFileï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨æ–¹æ³•ä¸º emitFile(name: string, content: Buffer|string, sourceMap: {â€¦})ã€‚ åŠ è½½æœ¬åœ° Loaderåœ¨å¼€å‘ Loader çš„è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†æµ‹è¯•ç¼–å†™çš„ Loader æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œï¼Œéœ€è¦æŠŠå®ƒé…ç½®åˆ° Webpack ä¸­åŽï¼Œæ‰å¯èƒ½ä¼šè°ƒç”¨è¯¥ Loaderã€‚ åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œä½¿ç”¨çš„ Loader éƒ½æ˜¯é€šè¿‡ Npm å®‰è£…çš„ï¼Œè¦ä½¿ç”¨ Loader æ—¶ä¼šç›´æŽ¥ä½¿ç”¨ Loader çš„åç§°ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910module.exports = &#123; module: &#123; rules: [ &#123; test: /\.css/, use: ['style-loader'], &#125;, ] &#125;,&#125;; å¦‚æžœè¿˜é‡‡å–ä»¥ä¸Šçš„æ–¹æ³•åŽ»ä½¿ç”¨æœ¬åœ°å¼€å‘çš„ Loader å°†ä¼šå¾ˆéº»çƒ¦ï¼Œå› ä¸ºä½ éœ€è¦ç¡®ä¿ç¼–å†™çš„ Loader çš„æºç æ˜¯åœ¨ node_modules ç›®å½•ä¸‹ã€‚ ä¸ºæ­¤ä½ éœ€è¦å…ˆæŠŠç¼–å†™çš„ Loader å‘å¸ƒåˆ° Npm ä»“åº“åŽå†å®‰è£…åˆ°æœ¬åœ°é¡¹ç›®ä½¿ç”¨ã€‚ Npm linkNpm link ä¸“é—¨ç”¨äºŽå¼€å‘å’Œè°ƒè¯•æœ¬åœ° Npm æ¨¡å—ï¼Œèƒ½åšåˆ°åœ¨ä¸å‘å¸ƒæ¨¡å—çš„æƒ…å†µä¸‹ï¼ŒæŠŠæœ¬åœ°çš„ä¸€ä¸ªæ­£åœ¨å¼€å‘çš„æ¨¡å—çš„æºç é“¾æŽ¥åˆ°é¡¹ç›®çš„ node_modules ç›®å½•ä¸‹ï¼Œè®©é¡¹ç›®å¯ä»¥ç›´æŽ¥ä½¿ç”¨æœ¬åœ°çš„ Npm æ¨¡å—ã€‚ ç”±äºŽæ˜¯é€šè¿‡è½¯é“¾æŽ¥çš„æ–¹å¼å®žçŽ°çš„ï¼Œç¼–è¾‘äº†æœ¬åœ°çš„ Npm æ¨¡å—ä»£ç ï¼Œåœ¨é¡¹ç›®ä¸­ä¹Ÿèƒ½ä½¿ç”¨åˆ°ç¼–è¾‘åŽçš„ä»£ç ã€‚ å®Œæˆ Npm link çš„æ­¥éª¤å¦‚ä¸‹ï¼š ç¡®ä¿æ­£åœ¨å¼€å‘çš„æœ¬åœ° Npm æ¨¡å—ï¼ˆä¹Ÿå°±æ˜¯æ­£åœ¨å¼€å‘çš„ Loaderï¼‰çš„ package.json å·²ç»æ­£ç¡®é…ç½®å¥½ï¼›åœ¨æœ¬åœ° Npm æ¨¡å—æ ¹ç›®å½•ä¸‹æ‰§è¡Œ npm linkï¼ŒæŠŠæœ¬åœ°æ¨¡å—æ³¨å†Œåˆ°å…¨å±€ï¼›åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ npm link loader-nameï¼ŒæŠŠç¬¬2æ­¥æ³¨å†Œåˆ°å…¨å±€çš„æœ¬åœ° Npm æ¨¡å—é“¾æŽ¥åˆ°é¡¹ç›®çš„ node_moduels ä¸‹ï¼Œå…¶ä¸­çš„ loader-name æ˜¯æŒ‡åœ¨ç¬¬1æ­¥ä¸­çš„ package.json æ–‡ä»¶ä¸­é…ç½®çš„æ¨¡å—åç§°ã€‚é“¾æŽ¥å¥½ Loader åˆ°é¡¹ç›®åŽä½ å°±å¯ä»¥åƒä½¿ç”¨ä¸€ä¸ªçœŸæ­£çš„ Npm æ¨¡å—ä¸€æ ·ä½¿ç”¨æœ¬åœ°çš„ Loader äº†ã€‚ ResolveLoaderæ›¾ä»‹ç»è¿‡ ResolveLoader ç”¨äºŽé…ç½® Webpack å¦‚ä½•å¯»æ‰¾ Loaderã€‚ é»˜è®¤æƒ…å†µä¸‹åªä¼šåŽ» node_modules ç›®å½•ä¸‹å¯»æ‰¾ï¼Œä¸ºäº†è®© Webpack åŠ è½½æ”¾åœ¨æœ¬åœ°é¡¹ç›®ä¸­çš„ Loader éœ€è¦ä¿®æ”¹ resolveLoader.modulesã€‚ å‡å¦‚æœ¬åœ°çš„ Loader åœ¨é¡¹ç›®ç›®å½•ä¸­çš„ ./loaders/loader-name ä¸­ï¼Œåˆ™éœ€è¦å¦‚ä¸‹é…ç½®ï¼š 123456module.exports = &#123; resolveLoader:&#123; // åŽ»å“ªäº›ç›®å½•ä¸‹å¯»æ‰¾ Loaderï¼Œæœ‰å…ˆåŽé¡ºåºä¹‹åˆ† modules: ['node_modules','./loaders/'], &#125;&#125; åŠ ä¸Šä»¥ä¸Šé…ç½®åŽï¼Œ Webpack ä¼šå…ˆåŽ» node_modules é¡¹ç›®ä¸‹å¯»æ‰¾ Loaderï¼Œå¦‚æžœæ‰¾ä¸åˆ°ï¼Œä¼šå†åŽ» ./loaders/ ç›®å½•ä¸‹å¯»æ‰¾ã€‚ å®žæˆ˜ä¸Šé¢è®²äº†è®¸å¤šç†è®ºï¼ŒæŽ¥ä¸‹æ¥ä»Žå®žé™…å‡ºå‘ï¼Œæ¥ç¼–å†™ä¸€ä¸ªè§£å†³å®žé™…é—®é¢˜çš„ Loaderã€‚ è¯¥ Loader åå«comment-require-loaderï¼Œä½œç”¨æ˜¯æŠŠ JavaScript ä»£ç ä¸­çš„æ³¨é‡Šè¯­æ³• // @require &#39;../style/index.css&#39; è½¬æ¢æˆ require(&#39;../style/index.css&#39;); è¯¥ Loader çš„ä½¿ç”¨åœºæ™¯æ˜¯åŽ»æ­£ç¡®åŠ è½½é’ˆå¯¹ Fis3ç¼–å†™çš„ JavaScriptï¼Œè¿™äº› JavaScript ä¸­å­˜åœ¨é€šè¿‡æ³¨é‡Šçš„æ–¹å¼åŠ è½½ä¾èµ–çš„ CSS æ–‡ä»¶ã€‚ è¯¥ Loader çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 123456789101112module.exports = &#123; module: &#123; rules: [ &#123; test: /\.js$/, use: ['comment-require-loader'], // é’ˆå¯¹é‡‡ç”¨äº† fis3 CSS å¯¼å…¥è¯­æ³•çš„ JavaScript æ–‡ä»¶é€šè¿‡ comment-require-loader åŽ»è½¬æ¢ include: [path.resolve(__dirname, 'node_modules/imui')] &#125; ] &#125;&#125;; è¯¥ Loader çš„å®žçŽ°éžå¸¸ç®€å•ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š 12345678function replace(source) &#123; // ä½¿ç”¨æ­£åˆ™æŠŠ // @require '../style/index.css' è½¬æ¢æˆ require('../style/index.css'); return source.replace(/(\/\/ *@require) +(('|").+('|")).*/, 'require($2);');&#125;module.exports = function (content) &#123; return replace(content);&#125;;]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpackåŽŸç†åŠå®žçŽ°]]></title>
    <url>%2F2018%2F08%2F03%2F%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0%2Fwebpack%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[å·¥ä½œåŽŸç†æ¦‚æ‹¬Webpack ä»¥å…¶ä½¿ç”¨ç®€å•è‘—ç§°ï¼Œåœ¨ä½¿ç”¨å®ƒçš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨è€…åªéœ€æŠŠå®ƒå½“ä½œä¸€ä¸ªé»‘ç›’ï¼Œéœ€è¦å…³å¿ƒçš„åªæœ‰å®ƒæš´éœ²å‡ºæ¥çš„é…ç½®ã€‚ æœ¬èŠ‚å°†å¸¦ä½ èµ°è¿›è¿™ä¸ªé»‘ç›’ï¼Œçœ‹çœ‹ Webpack æ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚ åŸºæœ¬æ¦‚å¿µ åœ¨äº†è§£ Webpack åŽŸç†å‰ï¼Œéœ€è¦æŽŒæ¡ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œä»¥æ–¹ä¾¿åŽé¢çš„ç†è§£ï¼š entry: å…¥å£ï¼ŒWebpack æ‰§è¡Œæž„å»ºçš„ç¬¬ä¸€æ­¥å°†ä»Ž Entry å¼€å§‹ï¼Œå¯æŠ½è±¡æˆè¾“å…¥ã€‚ module: æ¨¡å—ï¼Œåœ¨ Webpack é‡Œä¸€åˆ‡çš†æ¨¡å—ï¼Œä¸€ä¸ªæ¨¡å—å¯¹åº”ç€ä¸€ä¸ªæ–‡ä»¶ã€‚Webpack ä¼šä»Žé…ç½®çš„ Entry å¼€å§‹é€’å½’æ‰¾å‡ºæ‰€æœ‰ä¾èµ–çš„æ¨¡å—ã€‚ chunk: ä»£ç å—ï¼Œä¸€ä¸ª Chunk ç”±å¤šä¸ªæ¨¡å—ç»„åˆè€Œæˆï¼Œç”¨äºŽä»£ç åˆå¹¶ä¸Žåˆ†å‰²ã€‚ loader: æ¨¡å—è½¬æ¢å™¨ï¼Œç”¨äºŽæŠŠæ¨¡å—åŽŸå†…å®¹æŒ‰ç…§éœ€æ±‚è½¬æ¢æˆæ–°å†…å®¹ã€‚ plugins: æ‰©å±•æ’ä»¶ï¼Œåœ¨ Webpack æž„å»ºæµç¨‹ä¸­çš„ç‰¹å®šæ—¶æœºä¼šå¹¿æ’­å‡ºå¯¹åº”çš„äº‹ä»¶ï¼Œæ’ä»¶å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶çš„å‘ç”Ÿï¼Œåœ¨ç‰¹å®šæ—¶æœºåšå¯¹åº”çš„äº‹æƒ…ã€‚ æµç¨‹æ¦‚æ‹¬ Webpack çš„è¿è¡Œæµç¨‹æ˜¯ä¸€ä¸ªä¸²è¡Œçš„è¿‡ç¨‹ï¼Œä»Žå¯åŠ¨åˆ°ç»“æŸä¼šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š 1.åˆå§‹åŒ–å‚æ•°ï¼šä»Žé…ç½®æ–‡ä»¶å’Œ Shell è¯­å¥ä¸­è¯»å–ä¸Žåˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°ï¼›2.å¼€å§‹ç¼–è¯‘ï¼šç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å¯¹è±¡ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶ï¼Œæ‰§è¡Œå¯¹è±¡çš„ run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘ï¼›3.ç¡®å®šå…¥å£ï¼šæ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰çš„å…¥å£æ–‡ä»¶ï¼›4.ç¼–è¯‘æ¨¡å—ï¼šä»Žå…¥å£æ–‡ä»¶å‡ºå‘ï¼Œè°ƒç”¨æ‰€æœ‰é…ç½®çš„ Loader å¯¹æ¨¡å—è¿›è¡Œç¿»è¯‘ï¼Œå†æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç†ï¼›5.å®Œæˆæ¨¡å—ç¼–è¯‘ï¼šåœ¨ç»è¿‡ç¬¬4æ­¥ä½¿ç”¨ Loader ç¿»è¯‘å®Œæ‰€æœ‰æ¨¡å—åŽï¼Œå¾—åˆ°äº†æ¯ä¸ªæ¨¡å—è¢«ç¿»è¯‘åŽçš„æœ€ç»ˆå†…å®¹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼›6.è¾“å‡ºèµ„æºï¼šæ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„ Chunkï¼Œå†æŠŠæ¯ä¸ª Chunk è½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åŽæœºä¼šï¼›7.è¾“å‡ºå®Œæˆï¼šåœ¨ç¡®å®šå¥½è¾“å‡ºå†…å®¹åŽï¼Œæ ¹æ®é…ç½®ç¡®å®šè¾“å‡ºçš„è·¯å¾„å’Œæ–‡ä»¶åï¼ŒæŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿã€‚ åœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­ï¼ŒWebpack ä¼šåœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹å¹¿æ’­å‡ºç‰¹å®šçš„äº‹ä»¶ï¼Œæ’ä»¶åœ¨ç›‘å¬åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶åŽä¼šæ‰§è¡Œç‰¹å®šçš„é€»è¾‘ï¼Œå¹¶ä¸”æ’ä»¶å¯ä»¥è°ƒç”¨ Webpack æä¾›çš„ API æ”¹å˜ Webpack çš„è¿è¡Œç»“æžœ æµç¨‹ç»†èŠ‚ Webpack çš„æž„å»ºæµç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰å¤§é˜¶æ®µï¼š 1.åˆå§‹åŒ–ï¼šå¯åŠ¨æž„å»ºï¼Œè¯»å–ä¸Žåˆå¹¶é…ç½®å‚æ•°ï¼ŒåŠ è½½ Pluginï¼Œå®žä¾‹åŒ– Compilerã€‚2.ç¼–è¯‘ï¼šä»Ž Entry å‘å‡ºï¼Œé’ˆå¯¹æ¯ä¸ª Module ä¸²è¡Œè°ƒç”¨å¯¹åº”çš„ Loader åŽ»ç¿»è¯‘æ–‡ä»¶å†…å®¹ï¼Œå†æ‰¾åˆ°è¯¥ Module ä¾èµ–çš„ Moduleï¼Œé€’å½’åœ°è¿›è¡Œç¼–è¯‘å¤„ç†ã€‚3.è¾“å‡ºï¼šå¯¹ç¼–è¯‘åŽçš„ Module ç»„åˆæˆ Chunkï¼ŒæŠŠ Chunk è½¬æ¢æˆæ–‡ä»¶ï¼Œè¾“å‡ºåˆ°æ–‡ä»¶ç³»ç»Ÿã€‚ å¦‚æžœåªæ‰§è¡Œä¸€æ¬¡æž„å»ºï¼Œä»¥ä¸Šé˜¶æ®µå°†ä¼šæŒ‰ç…§é¡ºåºå„æ‰§è¡Œä¸€æ¬¡ã€‚ä½†åœ¨å¼€å¯ç›‘å¬æ¨¡å¼ä¸‹ï¼Œæµç¨‹å°†å˜ä¸ºå¦‚ä¸‹ï¼š åœ¨æ¯ä¸ªå¤§é˜¶æ®µä¸­åˆä¼šå‘ç”Ÿå¾ˆå¤šäº‹ä»¶ï¼ŒWebpack ä¼šæŠŠè¿™äº›äº‹ä»¶å¹¿æ’­å‡ºæ¥ä¾›ç»™ Plugin ä½¿ç”¨ï¼Œä¸‹é¢æ¥ä¸€ä¸€ä»‹ç»ã€‚ åˆå§‹åŒ–é˜¶æ®µ äº‹ä»¶å è§£é‡Š åˆå§‹åŒ–å‚æ•° ä»Žé…ç½®æ–‡ä»¶å’Œ Shell è¯­å¥ä¸­è¯»å–ä¸Žåˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°ã€‚ è¿™ä¸ªè¿‡ç¨‹ä¸­è¿˜ä¼šæ‰§è¡Œé…ç½®æ–‡ä»¶ä¸­çš„æ’ä»¶å®žä¾‹åŒ–è¯­å¥ new Plugin()ã€‚ å®žä¾‹åŒ– Compilerç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å®žä¾‹ï¼ŒCompiler è´Ÿè´£æ–‡ä»¶ç›‘å¬å’Œå¯åŠ¨ç¼–è¯‘ã€‚Compiler å®žä¾‹ä¸­åŒ…å«äº†å®Œæ•´çš„ Webpack é…ç½®ï¼Œå…¨å±€åªæœ‰ä¸€ä¸ª Compiler å®žä¾‹ã€‚ åŠ è½½æ’ä»¶ ä¾æ¬¡è°ƒç”¨æ’ä»¶çš„ apply æ–¹æ³•ï¼Œè®©æ’ä»¶å¯ä»¥ç›‘å¬åŽç»­çš„æ‰€æœ‰äº‹ä»¶èŠ‚ç‚¹ã€‚åŒæ—¶ç»™æ’ä»¶ä¼ å…¥ compiler å®žä¾‹çš„å¼•ç”¨ï¼Œä»¥æ–¹ä¾¿æ’ä»¶é€šè¿‡ compiler è°ƒç”¨ Webpack æä¾›çš„ APIã€‚ environment å¼€å§‹åº”ç”¨ Node.js é£Žæ ¼çš„æ–‡ä»¶ç³»ç»Ÿåˆ° compiler å¯¹è±¡ï¼Œä»¥æ–¹ä¾¿åŽç»­çš„æ–‡ä»¶å¯»æ‰¾å’Œè¯»å–ã€‚ entry-option è¯»å–é…ç½®çš„ Entrysï¼Œä¸ºæ¯ä¸ª Entry å®žä¾‹åŒ–ä¸€ä¸ªå¯¹åº”çš„ EntryPluginï¼Œä¸ºåŽé¢è¯¥ Entry çš„é€’å½’è§£æžå·¥ä½œåšå‡†å¤‡ã€‚ after-plugins è°ƒç”¨å®Œæ‰€æœ‰å†…ç½®çš„å’Œé…ç½®çš„æ’ä»¶çš„ apply æ–¹æ³•ã€‚ after-resolvers æ ¹æ®é…ç½®åˆå§‹åŒ–å®Œ resolverï¼Œresolver è´Ÿè´£åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­å¯»æ‰¾æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ã€‚ ç¼–è¯‘é˜¶æ®µ äº‹ä»¶å è§£é‡Š run å¯åŠ¨ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚ watch-run å’Œ run ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºŽå®ƒæ˜¯åœ¨ç›‘å¬æ¨¡å¼ä¸‹å¯åŠ¨çš„ç¼–è¯‘ï¼Œåœ¨è¿™ä¸ªäº‹ä»¶ä¸­å¯ä»¥èŽ·å–åˆ°æ˜¯å“ªäº›æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–å¯¼è‡´é‡æ–°å¯åŠ¨ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚ compile è¯¥äº‹ä»¶æ˜¯ä¸ºäº†å‘Šè¯‰æ’ä»¶ä¸€æ¬¡æ–°çš„ç¼–è¯‘å°†è¦å¯åŠ¨ï¼ŒåŒæ—¶ä¼šç»™æ’ä»¶å¸¦ä¸Š compiler å¯¹è±¡ã€‚ compilation å½“ Webpack ä»¥å¼€å‘æ¨¡å¼è¿è¡Œæ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°æ–‡ä»¶å˜åŒ–ï¼Œä¸€æ¬¡æ–°çš„ Compilation å°†è¢«åˆ›å»ºã€‚ä¸€ä¸ª Compilation å¯¹è±¡åŒ…å«äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ç­‰ã€‚Compilation å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šäº‹ä»¶å›žè°ƒä¾›æ’ä»¶åšæ‰©å±•ã€‚ make ä¸€ä¸ªæ–°çš„ Compilation åˆ›å»ºå®Œæ¯•ï¼Œå³å°†ä»Ž Entry å¼€å§‹è¯»å–æ–‡ä»¶ï¼Œæ ¹æ®æ–‡ä»¶ç±»åž‹å’Œé…ç½®çš„ Loader å¯¹æ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘å®ŒåŽå†æ‰¾å‡ºè¯¥æ–‡ä»¶ä¾èµ–çš„æ–‡ä»¶ï¼Œé€’å½’çš„ç¼–è¯‘å’Œè§£æžã€‚ after-compile ä¸€æ¬¡ Compilation æ‰§è¡Œå®Œæˆã€‚ invalid å½“é‡åˆ°æ–‡ä»¶ä¸å­˜åœ¨ã€æ–‡ä»¶ç¼–è¯‘é”™è¯¯ç­‰å¼‚å¸¸æ—¶ä¼šè§¦å‘è¯¥äº‹ä»¶ï¼Œè¯¥äº‹ä»¶ä¸ä¼šå¯¼è‡´ Webpack é€€å‡ºã€‚ åœ¨ç¼–è¯‘é˜¶æ®µä¸­ï¼Œæœ€é‡è¦çš„è¦æ•° compilation äº‹ä»¶äº†ï¼Œå› ä¸ºåœ¨ compilation é˜¶æ®µè°ƒç”¨äº† Loader å®Œæˆäº†æ¯ä¸ªæ¨¡å—çš„è½¬æ¢æ“ä½œï¼Œåœ¨ compilation é˜¶æ®µåˆåŒ…æ‹¬å¾ˆå¤šå°çš„äº‹ä»¶ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š äº‹ä»¶å è§£é‡Š build-module ä½¿ç”¨å¯¹åº”çš„ Loader åŽ»è½¬æ¢ä¸€ä¸ªæ¨¡å—ã€‚ normal-module-loader åœ¨ç”¨ Loader å¯¹ä¸€ä¸ªæ¨¡å—è½¬æ¢å®ŒåŽï¼Œä½¿ç”¨ acorn è§£æžè½¬æ¢åŽçš„å†…å®¹ï¼Œè¾“å‡ºå¯¹åº”çš„æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œä»¥æ–¹ä¾¿ Webpack åŽé¢å¯¹ä»£ç çš„åˆ†æžã€‚ program ä»Žé…ç½®çš„å…¥å£æ¨¡å—å¼€å§‹ï¼Œåˆ†æžå…¶ ASTï¼Œå½“é‡åˆ° require ç­‰å¯¼å…¥å…¶å®ƒæ¨¡å—è¯­å¥æ—¶ï¼Œä¾¿å°†å…¶åŠ å…¥åˆ°ä¾èµ–çš„æ¨¡å—åˆ—è¡¨ï¼ŒåŒæ—¶å¯¹æ–°æ‰¾å‡ºçš„ä¾èµ–æ¨¡å—é€’å½’åˆ†æžï¼Œæœ€ç»ˆæžæ¸…æ‰€æœ‰æ¨¡å—çš„ä¾èµ–å…³ç³»ã€‚ seal æ‰€æœ‰æ¨¡å—åŠå…¶ä¾èµ–çš„æ¨¡å—éƒ½é€šè¿‡ Loader è½¬æ¢å®ŒæˆåŽï¼Œæ ¹æ®ä¾èµ–å…³ç³»å¼€å§‹ç”Ÿæˆ Chunkã€‚ è¾“å‡ºé˜¶æ®µ äº‹ä»¶å è§£é‡Š should-emit æ‰€æœ‰éœ€è¦è¾“å‡ºçš„æ–‡ä»¶å·²ç»ç”Ÿæˆå¥½ï¼Œè¯¢é—®æ’ä»¶å“ªäº›æ–‡ä»¶éœ€è¦è¾“å‡ºï¼Œå“ªäº›ä¸éœ€è¦ã€‚ emit ç¡®å®šå¥½è¦è¾“å‡ºå“ªäº›æ–‡ä»¶åŽï¼Œæ‰§è¡Œæ–‡ä»¶è¾“å‡ºï¼Œå¯ä»¥åœ¨è¿™é‡ŒèŽ·å–å’Œä¿®æ”¹è¾“å‡ºå†…å®¹ã€‚ after-emit æ–‡ä»¶è¾“å‡ºå®Œæ¯•ã€‚ done æˆåŠŸå®Œæˆä¸€æ¬¡å®Œæˆçš„ç¼–è¯‘å’Œè¾“å‡ºæµç¨‹ã€‚ failed å¦‚æžœåœ¨ç¼–è¯‘å’Œè¾“å‡ºæµç¨‹ä¸­é‡åˆ°å¼‚å¸¸å¯¼è‡´ Webpack é€€å‡ºæ—¶ï¼Œå°±ä¼šç›´æŽ¥è·³è½¬åˆ°æœ¬æ­¥éª¤ï¼Œæ’ä»¶å¯ä»¥åœ¨æœ¬äº‹ä»¶ä¸­èŽ·å–åˆ°å…·ä½“çš„é”™è¯¯åŽŸå› ã€‚ åœ¨è¾“å‡ºé˜¶æ®µå·²ç»å¾—åˆ°äº†å„ä¸ªæ¨¡å—ç»è¿‡è½¬æ¢åŽçš„ç»“æžœå’Œå…¶ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”æŠŠç›¸å…³æ¨¡å—ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªä¸ª Chunkã€‚ åœ¨è¾“å‡ºé˜¶æ®µä¼šæ ¹æ® Chunk çš„ç±»åž‹ï¼Œä½¿ç”¨å¯¹åº”çš„æ¨¡ç‰ˆç”Ÿæˆæœ€ç»ˆè¦è¦è¾“å‡ºçš„æ–‡ä»¶å†…å®¹ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>åŽŸç†åŠå®žçŽ°</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ Intersection Observer å®žçŽ°å›¾ç‰‡å»¶è¿ŸåŠ è½½]]></title>
    <url>%2F2018%2F08%2F01%2FHTTP%2F%E4%BD%BF%E7%94%A8-Intersection-Observer-%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%2F</url>
    <content type="text"><![CDATA[å»¶è¿ŸåŠ è½½æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Ÿå»¶è¿ŸåŠ è½½å›¾ç‰‡çš„ç›®çš„åœ¨äºŽï¼Œåœ¨å‘å‡ºå¯¹åº”çš„ç½‘ç»œè¯·æ±‚ä¹‹å‰ä½ è¦ä¸€ç›´ç­‰åˆ°ç”¨æˆ·æ»šåŠ¨é¡µé¢è®©å›¾ç‰‡è¿›å…¥å¯è§åŒºåŸŸã€‚å¦‚æžœä½ çš„ç½‘é¡µåŒ…æ‹¬äº†å¤šå¼ å›¾ç‰‡ï¼Œä½†ä½ åªåœ¨æ¯å¼ å›¾ç‰‡æ»šåŠ¨åˆ°è§†åŒºæ—¶æ‰åŠ è½½ï¼Œä½ å°†æœ€ç»ˆä¼šèŠ‚çœå¸¦å®½å¹¶ç¡®ä¿ä½ çš„ç½‘é¡µåŠ è½½çš„æ›´å¿«ã€‚ ä¸ºäº†è®©ä½ åœ¨å®žé™…ä¸­äº†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬æƒ³è±¡ä¸‹é¢è¿™ä¸ªé¡µé¢ï¼Œä»–æœ‰ä¸‰å¼ å›¾ç‰‡ã€‚ å¦‚æžœç”¨æˆ·è®¿é—®é¡µé¢æ—¶ä»…çœ‹åˆ°äº†ç¬¬ä¸€å¼ å›¾ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³åŠ è½½ç½‘é¡µåº•éƒ¨çš„æ¯”è¨å›¾ç‰‡ï¼Œé™¤éžç”¨æˆ·å‘ä¸‹æ»šåŠ¨ç›´åˆ°å›¾ç‰‡çœŸæ­£è¿›å…¥è§†åŒºã€‚å¦‚æžœæˆ‘ä»¬å»¶è¿ŸåŠ è½½å›¾ç‰‡ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·åªåœ¨ä»–ä»¬éœ€è¦æ—¶ä¸‹è½½ä»–ä»¬éœ€è¦çš„ä¸œè¥¿ï¼Œè¿™è®©ä½ çš„ç½‘é¡µæ›´åŠ ç²¾ç®€ã€‚ å¯¹äºŽæ›´æœ‰ç»éªŒçš„å¼€å‘è€…ï¼Œä½ ä¹Ÿè®¸å¾ˆç†Ÿæ‚‰å»¶è¿ŸåŠ è½½å›¾ç‰‡ï¼Œæ¯•ç«Ÿè¿™ä¸ªæ¦‚å¿µå·²ç»æœ‰äº†ä¸€æ®µæ—¶é—´ã€‚é‚£ä¹ˆæœ‰ä»€ä¹ˆæ–°ä¸œè¥¿å‘¢ï¼Ÿï¼çŽ°åœ¨æœ‰å¾ˆå¤šå»¶è¿ŸåŠ è½½åº“å¯ä»¥å®Œæˆè¿™é¡¹å·¥ä½œ. é—®é¢˜åœ¨äºŽï¼Œå‡ ä¹Žæ‰€æœ‰è¿™äº›åº“éƒ½æ˜¯åˆ©ç”¨æ»šåŠ¨äº‹ä»¶æˆ–è€…ä½¿ç”¨å®šæ—¶å™¨æ¥æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨è§†åŒºå†…ã€‚è¿™ä¸ªæ–¹æ³•çš„é—®é¢˜æ˜¯å®ƒå¼ºåˆ¶æµè§ˆå™¨é‡æ–°å¸ƒå±€æ•´ä¸ªé¡µé¢ï¼Œè€Œä¸”åœ¨ç‰¹å®šæ¡ä»¶ä¸‹ä¼šå¯¼è‡´ä½ çš„ç½‘ç«™å¡é¡¿ï¼ˆjankï¼‰ã€‚æˆ‘ä»¬å¯ä»¥åšçš„æ›´å¥½ï¼ æ•‘æ˜Ÿ Intersection Observerï¼è¿™å°±æ˜¯ Intersection Observer çš„ç”¨æ­¦ä¹‹åœ°ã€‚Intersection Observer å†…ç½®äºŽå¤§å¤šæ•°çŽ°ä»£æµè§ˆå™¨ï¼Œå¯ä»¥è®©ä½ çŸ¥é“ä¸€ä¸ªè¢«è§‚å¯Ÿå…ƒç´ ä½•æ—¶è¿›å…¥æˆ–ç¦»å¼€äº†æµè§ˆå™¨è§†å£ã€‚è¿™ä½¿å¾—å®ƒå¾ˆç†æƒ³ï¼Œå› ä¸ºå®ƒå¯ä»¥å¼‚æ­¥ä¼ è¾“æ•°æ®ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“ä¸»çº¿ç¨‹ï¼Œè¿™è®©å®ƒæˆä¸ºä¸€ä¸ªæä¾›åé¦ˆçš„æœ‰æ•ˆæ‰‹æ®µã€‚ åœ¨ Paul çš„ç¤ºä¾‹ä¸­ï¼Œå®ƒå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Intersection Observer æ¥å®žçŽ°å½“å›¾ç‰‡è¿›å…¥è§†å£æ—¶å»¶è¿ŸåŠ è½½ã€‚æˆ‘ä½¿ç”¨äº†ä»–çš„åˆå§‹ä»£ç ï¼Œå¹¶ç¨ä½œä¿®æ”¹è®©å®ƒæ›´å®¹æ˜“ç†è§£ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è¿‡ä¸€é Intersection Observer çš„åŸºç¡€çŸ¥è¯†å¹¶å‘ä½ å±•ç¤ºä½ è¯¥å¦‚ä½•ç”¨ä¸€ä¸ªè¶…çº§é«˜æ•ˆçš„æ–¹æ³•æ¥å»¶è¿ŸåŠ è½½å›¾ç‰‡ã€‚ å…¥é—¨æƒ³è±¡ä¸€ä¸ªæœ‰ä¸‰å¼ å›¾ç‰‡çš„åŸºæœ¬çš„ HTML é¡µé¢ï¼Œå°±åƒä¸Šé¢é‚£ä¸ªä¸€æ ·ï¼Œåœ¨è¿™ä¸ªç½‘é¡µä¸Šï¼Œä½ å°†æœ‰å¦‚ä¸‹ä»£ç çš„å›¾ç‰‡å…ƒç´ ï¼š 1&lt;img class="js-lazy-image" data-src="burger.png"&gt; ä½ ä¹Ÿè®¸æ³¨æ„åˆ°ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå›¾ç‰‡æ–‡ä»¶æ²¡æœ‰ src å±žæ€§ä¹ˆã€‚è¿™æ˜¯å› ä¸ºå®ƒä½¿ç”¨äº†ç§°ä¸º data-src çš„ data å±žæ€§æ¥æŒ‡å‘å›¾ç‰‡æºã€‚æˆ‘ä»¬å°†ä½¿ç”¨è¿™æ¥åŠ è½½å›¾ç‰‡ï¼Œå½“å®ƒä»¬è¿›å…¥è§†å£æ—¶ã€‚ä½ ä¹Ÿè®¸è¿˜æ³¨æ„åˆ°å›¾ç‰‡å…ƒç´ è¿˜æœ‰ä¸€ä¸ªç§°ä¸º js-lazy-image çš„ class â€”â€” æˆ‘ä»¬å°†å¾ˆå¿«åœ¨ JavaScript ä»£ç ä¸­ç”¨å®ƒæ¥ç¡®å®šæˆ‘ä»¬æƒ³å»¶è¿ŸåŠ è½½çš„å…ƒç´ ã€‚ æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå»¶è¿ŸåŠ è½½é¡µé¢ä¸­å›¾ç‰‡çš„ä»£ç ã€‚åœ¨æˆ‘ä»¬çš„ JavaScript æ–‡ä»¶ä¸­ï¼ˆéœ€è¦åœ¨é¡µé¢ä¸­å¼•ç”¨ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ Intersection Observerã€‚ ä¸Šé¢çš„ç¤ºä¾‹ä¸­çœ‹èµ·æ¥åƒæ˜¯ä¸€å †ä»£ç ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥åˆ†è§£ã€‚é¦–å…ˆï¼Œæˆ‘é€‰æ‹©äº†é¡µé¢ä¸­æ‰€æœ‰åŒ…å« js-lazy-image ç±»çš„å›¾ç‰‡ã€‚ç„¶åŽæˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ IntersectionObserverï¼Œå¹¶ç”¨å®ƒæ¥è§‚å¯Ÿæ‰€æœ‰æˆ‘ä»¬å·²ç»é€‰æ‹©çš„å¸¦æœ‰ js-lazy-image ç±»çš„å›¾ç‰‡ã€‚ä½¿ç”¨ IntersectionObserver çš„é»˜è®¤é€‰é¡¹ï¼Œä½ çš„å›žè°ƒä¼šåœ¨å…ƒç´ éƒ¨åˆ†è¿›å…¥è§†åŒºå’Œå®Œå…¨ç¦»å¼€è§†å£æ—¶è¢«è°ƒç”¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä¼šä¼ é€’ä¸€äº›é¢å¤–çš„é…ç½®é€‰é¡¹ç»™ IntersectionObserverã€‚ä½¿ç”¨ rootMargin å…è®¸ä½ æŒ‡å®šæ ¹å…ƒç´ çš„ margin å€¼ï¼Œè®©ä½ å¯ä»¥æ‰©å±•æˆ–è€…ç¼©å‡ intersections çš„ä½¿ç”¨åŒºåŸŸã€‚æˆ‘ä»¬æƒ³ç¡®ä¿å¦‚æžœå›¾ç‰‡è¿›å…¥äº† Y è½´çš„ 50px å†…ï¼Œæˆ‘ä»¬å°†å¼€å§‹ä¸‹è½½ã€‚ çŽ°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ª Intersection Observer å¹¶ä¸”æ­£åœ¨è§‚å¯Ÿé¡µé¢ä¸Šçš„å›¾ç‰‡ï¼Œæˆ‘ä»¬çŽ°åœ¨æ¥äº†è§£ intersection äº‹ä»¶ï¼Œå®ƒå°†åœ¨å…ƒç´ è¿›å…¥è§†åŒºæ—¶è§¦å‘ã€‚ åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ¯å½“æˆ‘ä»¬æ­£åœ¨è§‚å¯Ÿçš„å…ƒç´ è¿›å…¥åˆ°ç”¨æˆ·è§†å£å†…ï¼ŒonIntersection å‡½æ•°å°†è¢«è§¦å‘ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾ªçŽ¯æˆ‘ä»¬æ‰€è§‚å¯Ÿçš„å›¾ç‰‡å¹¶ç¡®å®šå“ªä¸€ä¸ªåœ¨è§†å£ä¸­ã€‚å¦‚æžœå½“å‰å…ƒç´ å¤„åœ¨äº¤å‰æ¯”ä¾‹ï¼ˆintersection ratioï¼‰ä¹‹ä¸­ï¼Œæˆ‘ä»¬å°±çŸ¥é“è¿™å›¾ç‰‡åœ¨ç”¨æˆ·è§†å£ä¹‹ä¸­å¹¶ä¸”æˆ‘ä»¬å¯ä»¥åŠ è½½å®ƒäº†ã€‚ä¸€æ—¦å›¾ç‰‡åŠ è½½å®Œæ¯•ï¼Œæˆ‘ä»¬ä¸åœ¨éœ€è¦è§‚å¯Ÿå®ƒï¼Œä½¿ç”¨ unobserve() å°†å®ƒä»Ž Intersection Observer çš„è§‚å¯Ÿåˆ—è¡¨ä¸­ç§»é™¤ã€‚ å°±æ˜¯è¿™æ ·ï¼ä¸€æ—¦ç”¨æˆ·æ»šåŠ¨å¹¶ä¸”å›¾ç‰‡è¿›å…¥è§†åŒºï¼Œå¯¹åº”çš„å›¾ç‰‡å°†è¢«åŠ è½½ã€‚è¿™ä¸ªä»£ç æœ€æ£’çš„åœ°æ–¹åœ¨äºŽ Intersection Observer æ¯” Barry White æ›´åŠ æµç•…ã€‚ æµè§ˆå™¨æ”¯æŒFirefoxã€Chrome å’Œ Opera æ”¯æŒï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½æ¶ˆæ¯ã€‚ ç„¶è€Œï¼Œä¸ºäº†ç¡®ä¿æˆ‘ä»¬çš„ä»£ç ä¸ä¼šåœ¨ä¸æ”¯æŒå®ƒçš„æµè§ˆå™¨ä¸­é€ æˆç ´åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‰¹æ€§æ£€æµ‹æ¥ç¡®å®šæˆ‘ä»¬åº”è¯¥å¦‚ä½•æ¥åŠ è½½å›¾ç‰‡ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„ä»£ç ã€‚ åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥äº† IntersectionObserver æ˜¯å¦åœ¨å½“å‰æµè§ˆå™¨ä¸­å¯ç”¨ï¼Œå¦‚æžœä¸å¯ç”¨æˆ‘ä»¬å°±ç«‹å³åŠ è½½è¿™äº›å›¾ç‰‡ï¼Œå¦åˆ™ä½¿ç”¨æˆ‘ä»¬çš„é»˜è®¤è¡Œä¸ºã€‚ å¦‚æžœä½ çœŸçš„å–œæ¬¢ Intersection Observer API çš„æ˜“ç”¨æ€§å¹¶æƒ³ä½¿ç”¨ polyfill æ¥æ›¿ä»£ã€‚WICG åˆ›å»ºäº†ä¸€ä¸ªæ”¾åœ¨äº†ä»–ä»¬çš„ Github ä»“åº“ã€‚å”¯ä¸€çš„ç¼ºç‚¹æ˜¯ä½ æ— æ³•èŽ·å–åˆ°åŽŸç”Ÿå®žçŽ°ç»™ä½ å¸¦æ¥çš„æ€§èƒ½ä¼˜åŠ¿ã€‚ ä½ ç”šè‡³å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼Œåƒ Robin Osborne å»ºè®®çš„é‚£æ ·ï¼Œä¸ºä¸å¯ç”¨ JavaScript çš„ç”¨æˆ·æ·»åŠ æ”¯æŒã€‚ æ€»ç»“åœ¨è¿™ç¯‡æ–‡ç« æ±‡æ€»ï¼Œæˆ‘ä»¬ä½¿ç”¨ Intersection Observer æ¥å»¶è¿ŸåŠ è½½å›¾ç‰‡ï¼Œä½†ä½ å¯ä»¥ç”¨å®ƒæ¥åšçš„æ›´å¤šã€‚å®ƒå¯ä»¥ç”¨äºŽåˆ¤æ–­æŸäººæ˜¯å¦æ­£åœ¨æŸ¥çœ‹å¹¿å‘Šï¼Œæˆ–è€…ç”šè‡³æ˜¯ iFrame ä¸­çš„å…ƒç´ æ˜¯å¦åœ¨è§†åŒºä¸­ã€‚æ˜“äºŽç†è§£çš„ API ä½¿å®ƒèŽ·å¾—äº†æ›´å¤šçš„å¯èƒ½æ€§ã€‚ å¦‚æžœä½ æƒ³å­¦ä¹ æ›´å¤šå…³äºŽ Intersection Observer çš„ä¿¡æ¯ï¼Œæˆ‘æŽ¨èé˜…è¯» Google Developers ç½‘ç«™ä¸Š è¿™ç¯‡å†…å®¹ä¸°å¯Œçš„æ–‡ç« ã€‚æˆ‘ä¹Ÿå¼ºçƒˆæŽ¨èè§‚çœ‹ Youtube ä¸Š Paul Lewis çš„è§†é¢‘ç³»åˆ—ï¼Œå®ƒåŒ…å«äº†è®¸å¤šå¾ˆæ£’çš„æŠ€å·§ï¼Œä½ ç»å¯¹ä¼šå­¦åˆ°äº›ä¸œè¥¿ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>æ‡’åŠ è½½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[fetchä½¿ç”¨çš„å¸¸è§é—®é¢˜åŠè§£å†³åŠžæ³•]]></title>
    <url>%2F2018%2F07%2F27%2Fstudy%2Ffetch%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%2F</url>
    <content type="text"><![CDATA[å‰è¨€è¯´é“fetchå°±ä¸å¾—ä¸æXMLHttpRequestäº†ï¼ŒXHRåœ¨å‘é€webè¯·æ±‚æ—¶éœ€è¦å¼€å‘è€…é…ç½®ç›¸å…³è¯·æ±‚ä¿¡æ¯å’ŒæˆåŠŸåŽçš„å›žè°ƒï¼Œå°½ç®¡å¼€å‘è€…åªå…³å¿ƒè¯·æ±‚æˆåŠŸåŽçš„ä¸šåŠ¡å¤„ç†ï¼Œä½†æ˜¯ä¹Ÿè¦é…ç½®å…¶ä»–ç¹çå†…å®¹ï¼Œå¯¼è‡´é…ç½®å’Œè°ƒç”¨æ¯”è¾ƒæ··ä¹±ï¼Œä¹Ÿä¸ç¬¦åˆå…³æ³¨åˆ†ç¦»çš„åŽŸåˆ™ï¼›fetchçš„å‡ºçŽ°æ­£æ˜¯ä¸ºäº†è§£å†³XHRå­˜åœ¨çš„è¿™äº›é—®é¢˜ã€‚ä¾‹å¦‚ä¸‹é¢ä»£ç ï¼š 1234567fetch(url).then(function(response)&#123; return response.json();&#125;).then(function(data)&#123; console.log(data)&#125;).catch(function(e)&#123; console.log("Oops,error")&#125;) ä¸Šé¢è¿™æ®µä»£ç è®©å¼€å‘è€…åªå…³æ³¨è¯·æ±‚æˆåŠŸåŽçš„ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œå…¶ä»–çš„ä¸ç”¨å…³å¿ƒï¼Œç›¸å½“ç®€å•ï¼›ä¹Ÿæ¯”è¾ƒç¬¦åˆçŽ°ä»£Promiseå½¢å¼ï¼Œæ¯”è¾ƒå‹å¥½ã€‚ fetchæ˜¯åŸºäºŽPromiseè®¾è®¡çš„ï¼Œä»Žä¸Šé¢ä»£ç ä¹Ÿèƒ½çœ‹å¾—å‡ºæ¥ï¼Œè¿™å°±è¦æ±‚fetchè¦é…åˆPromiseä¸€èµ·ä½¿ç”¨ã€‚æ­£æ˜¯è¿™ç§è®¾è®¡ï¼Œfetchæ‰€å¸¦æ¥çš„ä¼˜ç‚¹æ­£å¦‚ã€ä¼ ç»Ÿ Ajax å·²æ­»ï¼ŒFetch æ°¸ç”Ÿæ€»ç»“ã€‘çš„ä¸€æ ·ï¼š è¯­æ³•ç®€å•ï¼Œæ›´åŠ è¯­ä¹‰åŒ– åŸºäºŽæ ‡å‡†çš„Promiseå®žçŽ°ï¼Œæ”¯æŒasync/await ä½¿ç”¨isomorphic-fetchå¯ä»¥æ–¹ä¾¿åŒæž„ ä¸è¿‡è¯è¯´å›žæ¥ï¼Œfetchè™½ç„¶æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œä½†æ˜¯ä½¿ç”¨fetchæ¥è¿›è¡Œé¡¹ç›®å¼€å‘æ—¶ï¼Œä¹Ÿæ˜¯æœ‰ä¸€äº›å¸¸è§é—®é¢˜çš„ï¼Œä¸‹é¢å°±æ¥è¯´è¯´fetchä½¿ç”¨çš„å¸¸è§é—®é¢˜ã€‚ fetchå…¼å®¹æ€§fetchæ˜¯ç›¸å¯¹è¾ƒæ–°çš„æŠ€æœ¯ï¼Œå½“ç„¶å°±ä¼šå­˜åœ¨æµè§ˆå™¨å…¼å®¹æ€§çš„é—®é¢˜ï¼Œå€Ÿç”¨ä¸Šé¢åº”ç”¨æ–‡ç« çš„ä¸€å¹…å›¾åŠ ä»¥è¯´æ˜Žfetchåœ¨å„ç§æµè§ˆå™¨çš„åŽŸç”Ÿæ”¯æŒæƒ…å†µï¼š ä»Žä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œåœ¨å„ä¸ªæµè§ˆå™¨ä½Žç‰ˆæœ¬çš„æƒ…å†µä¸‹éƒ½æ˜¯ä¸è¢«æ”¯æŒçš„ã€‚ é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­é€šç”¨fetchå‘¢ï¼Œå½“ç„¶å°±è¦è€ƒè™‘fetchçš„polyfilläº†ã€‚ä¸Šé¢è¯´è¿‡ï¼Œfetchæ˜¯åŸºäºŽPromiseæ¥å®žçŽ°çš„ï¼Œæ‰€ä»¥åœ¨ä½Žç‰ˆæœ¬æµè§ˆå™¨ä¸­Promiseå¯èƒ½ä¹Ÿæœªè¢«åŽŸç”Ÿæ”¯æŒï¼Œæ‰€ä»¥è¿˜éœ€è¦Promiseçš„polyfillï¼›å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®žçŽ°fetchçš„polyfilléœ€è¦æ¶‰åŠåˆ°çš„ï¼š promiseçš„polyfillï¼Œä¾‹å¦‚es6-promiseã€babel-polyfillæä¾›çš„promiseå®žçŽ°ã€‚ fetchçš„polyfillå®žçŽ°ï¼Œä¾‹å¦‚isomorphic-fetchå’Œwhatwg-fetch è¿™æ ·æ˜¯å¦å°±å¯ä»¥å®‰å…¨çš„ä½¿ç”¨fetchæ¥è¿›è¡Œå‰åŽç«¯é€šä¿¡äº†ï¼Ÿä¸Šé¢è¯´äº†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯è¿™æ ·ï¼Œä½†æ˜¯IE8/9åˆ™æ¯”è¾ƒç‰¹æ®Šï¼šIE8å®ƒä½¿ç”¨çš„æ˜¯ES3ï¼Œè€ŒIE9åˆ™å¯¹ES5éƒ¨åˆ†æ”¯æŒã€‚è¿™ç§æƒ…å†µä¸‹è¿˜éœ€è¦ES5çš„polyfill es5-shimæ”¯æŒäº†ã€‚ ä¸Šè¿°æœ‰å…³promiseçš„polyfillå®žçŽ°ï¼Œéœ€è¦è¯´æ˜Žçš„æ˜¯ï¼š babel-runtimeæ˜¯ä¸èƒ½ä½œä¸ºPromiseçš„polyfillçš„å®žçŽ°çš„ï¼Œå¦åˆ™åœ¨IE8/9ä¸‹ä½¿ç”¨fetchä¼šæŠ¥Promiseæœªå®šä¹‰ã€‚ä¸ºä»€ä¹ˆï¼Ÿæˆ‘æƒ³å¤§å®¶çŒœåˆ°äº†ï¼Œå› ä¸ºbabel-runtimeå®žçŽ°çš„polyfillæ˜¯å±€éƒ¨å®žçŽ°è€Œä¸æ˜¯å…¨å±€å®žçŽ°ï¼Œfetchåº•å±‚å®žçŽ°ç”¨åˆ°Promiseå°±æ˜¯ä»Žå…¨å±€ä¸­åŽ»å–çš„ï¼Œæ‹¿ä¸åˆ°è¿™æŠ¥ä¸Šè¿°é”™è¯¯ã€‚ å¦å¤–ï¼Œé¡ºä¾¿è¡¥å……ä¸€ä¸‹fetchçš„polyfillå®žçŽ°æ€è·¯æ˜¯ï¼š é¦–å…ˆåˆ¤æ–­æµè§ˆå™¨æ˜¯å¦åŽŸç”Ÿæ”¯æŒfetchï¼Œå¦åˆ™ç»“åˆPromiseä½¿ç”¨XMLHttpRequestçš„æ–¹å¼æ¥å®žçŽ°ï¼›è¿™æ­£æ˜¯whatwg-fetchçš„å®žçŽ°æ€è·¯ï¼Œè€ŒåŒæž„åº”ç”¨ä¸­ä½¿ç”¨çš„isomorphic-fetchï¼Œå…¶å®¢æˆ·ç«¯fetchçš„å®žçŽ°æ˜¯ç›´æŽ¥require whatwg-fetchæ¥å®žçŽ°çš„ã€‚ fetché»˜è®¤ä¸æºå¸¦cookiefetchå‘é€è¯·æ±‚é»˜è®¤æ˜¯ä¸å‘é€cookieçš„ï¼Œä¸ç®¡æ˜¯åŒåŸŸè¿˜æ˜¯è·¨åŸŸï¼›é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œå¯¹äºŽé‚£äº›éœ€è¦æƒé™éªŒè¯çš„è¯·æ±‚å°±å¯èƒ½æ— æ³•æ­£å¸¸èŽ·å–æ•°æ®ï¼Œè¿™æ—¶å¯ä»¥é…ç½®å…¶credentialsé¡¹ï¼Œå…¶æœ‰3ä¸ªå€¼ï¼š omit: é»˜è®¤å€¼ï¼Œå¿½ç•¥cookieçš„å‘é€ same-origin: è¡¨ç¤ºcookieåªèƒ½åŒåŸŸå‘é€ï¼Œä¸èƒ½è·¨åŸŸå‘é€ include: cookieæ—¢å¯ä»¥åŒåŸŸå‘é€ï¼Œä¹Ÿå¯ä»¥è·¨åŸŸå‘é€ credentialsæ‰€è¡¨è¾¾çš„å«ä¹‰ï¼Œå…¶å®žä¸ŽXHR2ä¸­çš„withCredentialså±žæ€§ç±»ä¼¼ï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦æºå¸¦cookieï¼›å…·ä½“å¯ä»¥å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„è·¨åŸŸèµ„æºå…±äº« CORS è¯¦è§£ä¸­withCredentialsä¸€èŠ‚çš„ä»‹ç»ï¼› è¿™æ ·ï¼Œè‹¥è¦fetchè¯·æ±‚æºå¸¦cookieä¿¡æ¯ï¼Œåªéœ€è®¾ç½®ä¸€ä¸‹credentialsé€‰é¡¹å³å¯ï¼Œä¾‹å¦‚ 1fetch(url, &#123;credentials: 'include'&#125;); å¦å¤–è¡¥å……ä¸€ç‚¹ï¼š fetché»˜è®¤å¯¹æœåŠ¡ç«¯é€šè¿‡Set-Cookieå¤´è®¾ç½®çš„cookieä¹Ÿä¼šå¿½ç•¥ï¼Œè‹¥æƒ³é€‰æ‹©æŽ¥å—æ¥è‡ªæœåŠ¡ç«¯çš„cookieä¿¡æ¯ï¼Œä¹Ÿå¿…é¡»è¦é…ç½®credentialsé€‰é¡¹ï¼› fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šrejectä¸»è¦æ˜¯ç”±fetchè¿”å›žpromiseå¯¼è‡´çš„ï¼Œå› ä¸ºfetchè¿”å›žçš„promiseåœ¨æŸäº›é”™è¯¯çš„httpçŠ¶æ€ä¸‹å¦‚ 400ã€500ç­‰ä¸ä¼šrejectï¼Œç›¸åå®ƒä¼šè¢«resolveï¼›åªæœ‰ç½‘ç»œé”™è¯¯ä¼šå¯¼è‡´è¯·æ±‚ä¸èƒ½å®Œæˆæ—¶ï¼Œfetch æ‰ä¼šè¢« rejectï¼›æ‰€ä»¥ä¸€èˆ¬ä¼šå¯¹fetchè¯·æ±‚åšä¸€å±‚å°è£…ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š 12345678910111213141516171819function checkStatus(response) &#123; if (response.status &gt;= 200 &amp;&amp; response.status &lt; 300) &#123; return response; &#125; const error = new Error(response.statusText); error.response = response; throw error;&#125;function parseJSON(response) &#123; return response.json();&#125;export default function request(url, options) &#123; let opt = options||&#123;&#125;; return fetch(url, &#123;credentials: 'include', ...opt&#125;) .then(checkStatus) .then(parseJSON) .then((data) =&gt; ( data )) .catch((err) =&gt; ( err ));&#125; fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†ç”¨è¿‡fetchçš„éƒ½çŸ¥é“ï¼Œfetchä¸åƒå¤§å¤šæ•°ajaxåº“é‚£æ ·å¯¹è¯·æ±‚è®¾ç½®è¶…æ—¶timeoutï¼Œå®ƒæ²¡æœ‰æœ‰å…³è¯·æ±‚è¶…æ—¶çš„featureï¼Œè¿™ä¸€ç‚¹æ¯”è¾ƒè›‹ç–¼ã€‚æ‰€ä»¥åœ¨fetchæ ‡å‡†æ·»åŠ è¶…æ—¶featureä¹‹å‰ï¼Œéƒ½éœ€è¦polyfillè¯¥ç‰¹æ€§ã€‚ å®žé™…ä¸Šï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯abort(), timeoutå¯ä»¥é€šè¿‡timeout+abortæ–¹å¼æ¥å®žçŽ°ï¼Œèµ·åˆ°çœŸæ­£è¶…æ—¶ä¸¢å¼ƒå½“å‰çš„è¯·æ±‚ã€‚ è€Œåœ¨ç›®å‰çš„fetchæŒ‡å¯¼è§„èŒƒä¸­ï¼Œfetchå¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“å®žä¾‹ï¼Œè€Œåªæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼›å…¶è¿”å›žçš„promiseå®žä¾‹æ ¹æ®PromiseæŒ‡å¯¼è§„èŒƒæ ‡å‡†æ˜¯ä¸èƒ½abortçš„ï¼Œä¹Ÿä¸èƒ½æ‰‹åŠ¨æ”¹å˜promiseå®žä¾‹çš„çŠ¶æ€ï¼Œåªèƒ½ç”±å†…éƒ¨æ¥æ ¹æ®è¯·æ±‚ç»“æžœæ¥æ”¹å˜promiseçš„çŠ¶æ€ã€‚ æ—¢ç„¶ä¸èƒ½æ‰‹åŠ¨æŽ§åˆ¶fetchæ–¹æ³•æ‰§è¡ŒåŽè¿”å›žçš„promiseå®žä¾‹çŠ¶æ€ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯ä»¥æ‰‹åŠ¨æŽ§åˆ¶çŠ¶æ€çš„æ–°Promiseå®žä¾‹å‘¢ã€‚æ‰€ä»¥ï¼š å®žçŽ°fetchçš„timeoutåŠŸèƒ½ï¼Œå…¶æ€æƒ³å°±æ˜¯æ–°åˆ›å»ºä¸€ä¸ªå¯ä»¥æ‰‹åŠ¨æŽ§åˆ¶promiseçŠ¶æ€çš„å®žä¾‹ï¼Œæ ¹æ®ä¸åŒæƒ…å†µæ¥å¯¹æ–°promiseå®žä¾‹è¿›è¡Œresolveæˆ–è€…rejectï¼Œä»Žè€Œè¾¾åˆ°å®žçŽ°timeoutçš„åŠŸèƒ½ï¼› ç›®å‰å¯ä»¥æœ‰ä¸¤ç§ä¸åŒçš„è§£å†³æ–¹æ³•ï¼š ç¬¬ä¸€ç§ï¼šå•çº¯setTimeoutæ–¹å¼ 123456789101112131415161718var oldFetchfn = fetch; //æ‹¦æˆªåŽŸå§‹çš„fetchæ–¹æ³•window.fetch = function(input, opts)&#123;//å®šä¹‰æ–°çš„fetchæ–¹æ³•ï¼Œå°è£…åŽŸæœ‰çš„fetchæ–¹æ³• return new Promise(function(resolve, reject)&#123; var timeoutId = setTimeout(function()&#123; reject(new Error("fetch timeout")) &#125;, opts.timeout); oldFetchfn(input, opts).then( res=&gt;&#123; clearTimeout(timeoutId); resolve(res) &#125;, err=&gt;&#123; clearTimeout(timeoutId); reject(err) &#125; ) &#125;)&#125; ä¸Šé¢æ–¹æ³•å¯ä»¥æ¨¡æ‹Ÿxhrçš„abort()åŠŸèƒ½ 1234567891011var oldFetch = fetch;window.fetch = function(input, opts)&#123; return new promise(function(resolve,reject)&#123; var abort_promise = function()&#123; reject(new Error("fetch abort")); &#125; var p = oldFetchfn(input, opts).then(resolve, reject); p.abort = abort_promise; return p; &#125;)&#125; æ–¹æ³•äºŒï¼šåˆ©ç”¨Promise.raceæ–¹æ³• Promise.raceæ–¹æ³•æŽ¥å—ä¸€ä¸ªpromiseå®žä¾‹æ•°ç»„å‚æ•°ï¼Œè¡¨ç¤ºå¤šä¸ªpromiseå®žä¾‹ä¸­ä»»ä½•ä¸€ä¸ªæœ€å…ˆæ”¹å˜çŠ¶æ€ï¼Œé‚£ä¹ˆraceæ–¹æ³•è¿”å›žçš„promiseå®žä¾‹çŠ¶æ€å°±è·Ÿç€æ”¹å˜ï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™é‡Œã€‚ 12345678910var oldFetchfn = fetch; //æ‹¦æˆªåŽŸå§‹çš„fetchæ–¹æ³•window.fetch = function(input, opts)&#123;//å®šä¹‰æ–°çš„fetchæ–¹æ³•ï¼Œå°è£…åŽŸæœ‰çš„fetchæ–¹æ³• var fetchPromise = oldFetchfn(input, opts); var timeoutPromise = new Promise(function(resolve, reject)&#123; setTimeout(()=&gt;&#123; reject(new Error("fetch timeout")) &#125;, opts.timeout) &#125;); retrun Promise.race([fetchPromise, timeoutPromise])&#125; æœ€åŽï¼Œå¯¹fetchçš„timeoutçš„ä¸Šè¿°å®žçŽ°æ–¹å¼è¡¥å……å‡ ç‚¹ï¼š timeoutä¸æ˜¯è¯·æ±‚è¿žæŽ¥è¶…æ—¶çš„å«ä¹‰ï¼Œå®ƒè¡¨ç¤ºè¯·æ±‚çš„responseæ—¶é—´ï¼ŒåŒ…æ‹¬è¯·æ±‚çš„è¿žæŽ¥ã€æœåŠ¡å™¨å¤„ç†åŠæœåŠ¡å™¨å“åº”å›žæ¥çš„æ—¶é—´ï¼› fetchçš„timeoutå³ä½¿è¶…æ—¶å‘ç”Ÿäº†ï¼Œæœ¬æ¬¡è¯·æ±‚ä¹Ÿä¸ä¼šè¢«abortä¸¢å¼ƒæŽ‰ï¼Œå®ƒåœ¨åŽå°ä»ç„¶ä¼šå‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œåªæ˜¯æœ¬æ¬¡è¯·æ±‚çš„å“åº”å†…å®¹è¢«ä¸¢å¼ƒè€Œå·²ï¼› fetchä¸æ”¯æŒjsonpfetchæ˜¯ä¸ŽæœåŠ¡å™¨ç«¯è¿›è¡Œå¼‚æ­¥äº¤äº’çš„ï¼Œè€ŒJSONPæ˜¯ å¤–é“¾ä¸€ä¸ªjavascriptèµ„æºï¼Œå¹¶ä¸æ˜¯çœŸæ­£ajaxï¼Œæ‰€ä»¥fetchä¸ŽJSONPæ²¡æœ‰ä»€ä¹ˆç›´æŽ¥å…³è”ï¼Œå½“ç„¶è‡³å°‘ç›®å‰æ˜¯ä¸æ”¯æŒJSONPçš„ã€‚ è¿™é‡Œæˆ‘ä»¬æŠŠJSONPä¸Žfetchå…³è”åœ¨ä¸€èµ·æœ‰ç‚¹å·®å¼ºäººæ„ï¼Œfetchåªæ˜¯ä¸€ä¸ªajaxåº“ï¼Œæˆ‘ä»¬ä¸å¯èƒ½ä½¿fetchæ”¯æŒJSONPï¼›åªæ˜¯æˆ‘ä»¬è¦å®žçŽ°ä¸€ä¸ªJSONPï¼Œåªä¸è¿‡è¿™ä¸ªJSONPçš„å®žçŽ°è¦ä¸Žfetchçš„å®žçŽ°ç±»ä¼¼ï¼Œå³åŸºäºŽPromiseæ¥å®žçŽ°ä¸€ä¸ªJSONPï¼›è€Œå…¶å¤–åœ¨è¡¨çŽ°ç»™äººæ„Ÿè§‰æ˜¯fetchæ”¯æŒJSONPä¸€æ ·ï¼› ç›®å‰æ¯”è¾ƒæˆç†Ÿçš„å¼€æºJSONPå®žçŽ°fetch-jsonpç»™æˆ‘ä»¬æä¾›äº†è§£å†³æ–¹æ¡ˆï¼Œæƒ³äº†è§£å¯ä»¥è‡ªè¡Œå‰å¾€ã€‚ä¸è¿‡å†æ¬¡æƒ³å” å¨ä¸€ä¸‹å…¶JSONPçš„å®žçŽ°æ­¥éª¤ï¼Œå› ä¸ºåœ¨æœ¬äººé¢è¯•çš„å‰ç«¯å€™é€‰äººä¸­å¤§éƒ¨åˆ†äººå¯¹JSONPçš„å®žçŽ°è¯­ç„‰ä¸è¯¦ï¼› ä½¿ç”¨å®ƒéžå¸¸ç®€å•ï¼Œé¦–å…ˆéœ€è¦ç”¨npmå®‰è£…fetch-jsonp 1npm install fetch-jsonp --save-dev ç„¶åŽåœ¨åƒä¸‹é¢ä¸€æ ·ä½¿ç”¨ï¼š 123456789fetchJsonp(fetchJsonp('/users.jsonp', &#123; timeout: 3000, jsonpCallback: 'custom_callback' &#125;) .then(function(response) &#123; return response.json() &#125;).catch(function(ex) &#123; console.log('parsing failed', ex) &#125;) fetchä¸æ”¯æŒprogressäº‹ä»¶XHRæ˜¯åŽŸç”Ÿæ”¯æŒprogressäº‹ä»¶çš„ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç è¿™æ ·ï¼š 1234567891011121314var xhr = new XMLHttpRequest()xhr.open('POST', '/uploads')xhr.onload = function() &#123;&#125;xhr.onerror = function() &#123;&#125;function updateProgress (event) &#123; if (event.lengthComputable) &#123; var percent = Math.round((event.loaded / event.total) * 100) console.log(percent) &#125;xhr.upload.onprogress =updateProgress; //ä¸Šä¼ çš„progressäº‹ä»¶xhr.onprogress = updateProgress; //ä¸‹è½½çš„progressäº‹ä»¶&#125;xhr.send(); ä½†æ˜¯fetchæ˜¯ä¸æ”¯æŒæœ‰å…³progressäº‹ä»¶çš„ï¼›ä¸è¿‡å¯å–œçš„æ˜¯ï¼Œæ ¹æ®fetchçš„æŒ‡å¯¼è§„èŒƒæ ‡å‡†ï¼Œå…¶å†…éƒ¨è®¾è®¡å®žçŽ°äº†Requestå’ŒResponseç±»ï¼›å…¶ä¸­Responseå°è£…ä¸€äº›æ–¹æ³•å’Œå±žæ€§ï¼Œé€šè¿‡Responseå®žä¾‹å¯ä»¥è®¿é—®è¿™äº›æ–¹æ³•å’Œå±žæ€§ï¼Œä¾‹å¦‚response.json()ã€response.bodyç­‰ç­‰ï¼› å€¼å¾—å…³æ³¨çš„åœ°æ–¹æ˜¯ï¼Œresponse.bodyæ˜¯ä¸€ä¸ªå¯è¯»å­—èŠ‚æµå¯¹è±¡ï¼Œå…¶å®žçŽ°äº†ä¸€ä¸ªgetRender()æ–¹æ³•ï¼Œå…¶å…·ä½“ä½œç”¨æ˜¯ï¼š getRender()æ–¹æ³•ç”¨äºŽè¯»å–å“åº”çš„åŽŸå§‹å­—èŠ‚æµï¼Œè¯¥å­—èŠ‚æµæ˜¯å¯ä»¥å¾ªçŽ¯è¯»å–çš„ï¼Œç›´è‡³bodyå†…å®¹ä¼ è¾“å®Œæˆï¼› å› æ­¤ï¼Œåˆ©ç”¨åˆ°è¿™ç‚¹å¯ä»¥æ¨¡æ‹Ÿå‡ºfetchçš„progress,ä»£ç å®žçŽ°å¦‚ä¸‹ 12345678910111213141516171819202122232425// fetch() returns a promise that resolves once headers have been receivedfetch(url).then(response =&gt; &#123; // response.body is a readable stream. // Calling getReader() gives us exclusive access to the stream's content var reader = response.body.getReader(); var bytesReceived = 0; // read() returns a promise that resolves when a value has been received reader.read().then(function processResult(result) &#123; // Result objects contain two properties: // done - true if the stream has already given you all its data. // value - some data. Always undefined when done is true. if (result.done) &#123; console.log("Fetch complete"); return; &#125; // result.value for fetch streams is a Uint8Array bytesReceived += result.value.length; console.log('Received', bytesReceived, 'bytes of data so far'); // Read some more, and call this function again return reader.read().then(processResult); &#125;);&#125;); å¦å¤–ï¼Œgithubä¸Šä¹Ÿæœ‰ä½¿ç”¨Promise+XHRç»“åˆçš„æ–¹å¼å®žçŽ°ç±»fetchçš„progressæ•ˆæžœ(å½“ç„¶è¿™è·Ÿfetchå®Œå…¨ä¸æ­è¾¹ï¼‰å¯ä»¥å‚è€ƒè¿™é‡Œï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920function fetchProgress(url, opts=&#123;&#125;, onProgress)&#123; return new Promise(funciton(resolve, reject)&#123; var xhr = new XMLHttpRequest(); xhr.open(opts.method || 'get', url); for(var key in opts.headers || &#123;&#125;)&#123; xhr.setRequestHeader(key, opts.headers[key]); &#125; xhr.onload = e =&gt; resolve(e.target.responseText) xhr.onerror = reject; if (xhr.upload &amp;&amp; onProgress)&#123; xhr.upload.onprogress = onProgress; //ä¸Šä¼  &#125; if ('onprogerss' in xhr &amp;&amp; onProgress)&#123; xhr.onprogress = onProgress; //ä¸‹è½½ &#125; xhr.send(opts.body) &#125;)&#125;fetchProgress('/upload').then(console.log) fetchè·¨åŸŸé—®é¢˜æ—¢ç„¶æ˜¯ajaxåº“ï¼Œå°±ä¸å¯é¿å…ä¸Žè·¨åŸŸæ‰¯ä¸Šå…³ç³»ï¼›XHR2æ˜¯æ”¯æŒè·¨åŸŸè¯·æ±‚çš„ï¼Œåªä¸è¿‡è¦æ»¡è¶³æµè§ˆå™¨ç«¯æ”¯æŒCORSï¼ŒæœåŠ¡å™¨é€šè¿‡Access-Control-Allow-Originæ¥å…è®¸æŒ‡å®šçš„æºè¿›è¡Œè·¨åŸŸï¼Œä»…æ­¤ä¸€ç§æ–¹å¼ã€‚ ä¸ŽXHR2ä¸€æ ·ï¼Œfetchä¹Ÿæ˜¯æ”¯æŒè·¨åŸŸè¯·æ±‚çš„ï¼Œåªä¸è¿‡å…¶è·¨åŸŸè¯·æ±‚åšæ³•ä¸ŽXHR2ä¸€æ ·ï¼Œéœ€è¦å®¢æˆ·ç«¯ä¸ŽæœåŠ¡ç«¯æ”¯æŒï¼›å¦å¤–ï¼Œfetchè¿˜æ”¯æŒä¸€ç§è·¨åŸŸï¼Œä¸éœ€è¦æœåŠ¡å™¨æ”¯æŒçš„å½¢å¼ï¼Œå…·ä½“å¯ä»¥é€šè¿‡å…¶modeçš„é…ç½®é¡¹æ¥è¯´æ˜Žã€‚ fetchçš„modeé…ç½®é¡¹æœ‰3ä¸ªå€¼ï¼Œå¦‚ä¸‹ï¼š same-originï¼šè¯¥æ¨¡å¼æ˜¯ä¸å…è®¸è·¨åŸŸçš„ï¼Œå®ƒéœ€è¦éµå®ˆåŒæºç­–ç•¥ï¼Œå¦åˆ™æµè§ˆå™¨ä¼šè¿”å›žä¸€ä¸ªerrorå‘ŠçŸ¥ä¸èƒ½è·¨åŸŸï¼›å…¶å¯¹åº”çš„response typeä¸ºbasicã€‚ cors: è¯¥æ¨¡å¼æ”¯æŒè·¨åŸŸè¯·æ±‚ï¼Œé¡¾åæ€ä¹‰å®ƒæ˜¯ä»¥CORSçš„å½¢å¼è·¨åŸŸï¼›å½“ç„¶è¯¥æ¨¡å¼ä¹Ÿå¯ä»¥åŒåŸŸè¯·æ±‚ä¸éœ€è¦åŽç«¯é¢å¤–çš„CORSæ”¯æŒï¼›å…¶å¯¹åº”çš„response typeä¸ºcorsã€‚ no-cors: è¯¥æ¨¡å¼ç”¨äºŽè·¨åŸŸè¯·æ±‚ä½†æ˜¯æœåŠ¡å™¨ä¸å¸¦CORSå“åº”å¤´ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡ç«¯ä¸æ”¯æŒCORSï¼›è¿™ä¹Ÿæ˜¯fetchçš„ç‰¹æ®Šè·¨åŸŸè¯·æ±‚æ–¹å¼ï¼›å…¶å¯¹åº”çš„response typeä¸ºopaqueã€‚ é’ˆå¯¹è·¨åŸŸè¯·æ±‚ï¼Œcorsæ¨¡å¼æ˜¯å¸¸è§è·¨åŸŸè¯·æ±‚å®žçŽ°ï¼Œä½†æ˜¯fetchè‡ªå¸¦çš„no-corsè·¨åŸŸè¯·æ±‚æ¨¡å¼åˆ™è¾ƒä¸ºé™Œç”Ÿï¼Œè¯¥æ¨¡å¼æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜Žæ˜¾çš„ç‰¹ç‚¹ï¼š è¯¥æ¨¡å¼å…è®¸æµè§ˆå™¨å‘é€æœ¬æ¬¡è·¨åŸŸè¯·æ±‚ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®å“åº”è¿”å›žçš„å†…å®¹ï¼Œè¿™ä¹Ÿæ˜¯å…¶response typeä¸ºopaqueé€æ˜Žçš„åŽŸå› ã€‚ è¿™ä¸Ž&lt;img/&gt;å‘é€çš„è¯·æ±‚ç±»ä¼¼ï¼Œåªæ˜¯è¯¥æ¨¡å¼ä¸èƒ½è®¿é—®å“åº”çš„å†…å®¹ä¿¡æ¯ï¼›ä½†æ˜¯å®ƒå¯ä»¥è¢«å…¶ä»–APIsè¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚ServiceWorkerã€‚å¦å¤–ï¼Œè¯¥æ¨¡å¼è¿”å›žçš„repsonseå¯ä»¥åœ¨Cache APIä¸­è¢«å­˜å‚¨èµ·æ¥ä»¥ä¾¿åŽç»­çš„å¯¹å®ƒçš„ä½¿ç”¨ï¼Œè¿™ç‚¹å¯¹scriptã€csså’Œå›¾ç‰‡çš„CDNèµ„æºæ˜¯éžå¸¸åˆé€‚çš„ï¼Œå› ä¸ºè¿™äº›èµ„æºå“åº”å¤´ä¸­éƒ½æ²¡æœ‰CORSå¤´ã€‚ æ€»çš„æ¥è¯´ï¼Œfetchçš„è·¨åŸŸè¯·æ±‚æ˜¯ä½¿ç”¨CORSæ–¹å¼ï¼Œéœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡ç«¯çš„æ”¯æŒã€‚]]></content>
      <tags>
        <tag>Fetch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptæ¨¡å—åŒ– --- Commonjsã€AMDã€CMDã€ES6 modules]]></title>
    <url>%2F2018%2F07%2F25%2Fstudy%2FJavaScript%E6%A8%A1%E5%9D%97%E5%8C%96-Commonjs%E3%80%81AMD%E3%80%81CMD%E3%80%81ES6-modules%2F</url>
    <content type="text"><![CDATA[å‰è¨€éšç€å‰ç«¯jsä»£ç å¤æ‚åº¦çš„æé«˜ï¼ŒJavaScriptæ¨¡å—åŒ–è¿™ä¸ªæ¦‚å¿µä¾¿è¢«æå‡ºæ¥ï¼Œå‰ç«¯ç¤¾åŒºä¹Ÿä¸æ–­åœ°å®žçŽ°å‰ç«¯æ¨¡å—åŒ–ï¼Œç›´åˆ°es6å¯¹å…¶è¿›è¡Œäº†è§„èŒƒï¼Œä¸‹é¢å°±ä»‹ç»JavaScriptæ¨¡å—åŒ–ã€‚ JavaScriptæ¨¡å—åŒ–æ˜¯å¦‚ä½•ä¸€æ­¥ä¸€æ­¥åœ°å‘å±•èµ·æ¥çš„ï¼Œå¹¶ä¸”ä¹Ÿä¼šä¸»è¦å¯¹è¿™äº›æ¨¡å—åŒ–æ–¹å¼åšä¸€ä¸ªç®€å•çš„æ¯”è¾ƒã€‚ ç¬¬ä¸€é˜¶æ®µï¼šæ— æ¨¡å—åŒ–JavaScriptæœ€åˆçš„ä½œç”¨ä»…ä»…æ˜¯éªŒè¯è¡¨å•ï¼ŒåŽæ¥ä¼šæ·»åŠ ä¸€äº›åŠ¨ç”»ï¼Œä½†æ˜¯è¿™äº›jsä»£ç å¾ˆå¤šåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å°±å¯ä»¥å®Œæˆäº†ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨htmlæ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªscriptæ ‡ç­¾ã€‚ åŽæ¥ï¼Œéšç€å‰ç«¯å¤æ‚åº¦æé«˜ï¼Œä¸ºäº†èƒ½å¤Ÿæé«˜é¡¹ç›®ä»£ç çš„å¯è¯»æ€§ã€å¯æ‰©å±•æ€§ç­‰ï¼Œæˆ‘ä»¬çš„jsæ–‡ä»¶é€æ¸å¤šäº†èµ·æ¥ï¼Œä¸å†æ˜¯ä¸€ä¸ªjsæ–‡ä»¶å°±å¯ä»¥è§£å†³çš„äº†ï¼Œè€Œæ˜¯æŠŠæ¯ä¸€ä¸ªjsæ–‡ä»¶å½“åšä¸€ä¸ªæ¨¡å—ã€‚é‚£ä¹ˆï¼Œè¿™æ—¶çš„jså¼•å…¥æ–¹å¼æ˜¯æ€Žæ ·çš„å‘¢ï¼Ÿå¤§æ¦‚æ˜¯ä¸‹é¢è¿™æ ·ï¼š 123456&lt;script src="jquery.js"&gt;&lt;/script&gt; &lt;script src="jquery_scroller.js"&gt;&lt;/script&gt;&lt;script src="main.js"&gt;&lt;/script&gt;&lt;script src="other1.js"&gt;&lt;/script&gt; &lt;script src="other2.js"&gt;&lt;/script&gt;&lt;script src="other3.js"&gt;&lt;/script&gt; å³ç®€å•çš„å°†æ‰€æœ‰çš„jsæ–‡ä»¶ç»Ÿç»Ÿæ”¾åœ¨ä¸€èµ·ã€‚ä½†æ˜¯è¿™äº›æ–‡ä»¶çš„é¡ºåºè¿˜ä¸èƒ½å‡ºé”™ï¼Œæ¯”å¦‚jqueryéœ€è¦å…ˆå¼•å…¥ï¼Œæ‰èƒ½å¼•å…¥jqueryæ’ä»¶ï¼Œæ‰èƒ½åœ¨å…¶ä»–çš„æ–‡ä»¶ä¸­ä½¿ç”¨jqueryã€‚ ä¼˜ç‚¹ ç›¸æ¯”äºŽä½¿ç”¨ä¸€ä¸ªjsæ–‡ä»¶ï¼Œè¿™ç§å¤šä¸ªjsæ–‡ä»¶å®žçŽ°æœ€ç®€å•çš„æ¨¡å—åŒ–çš„æ€æƒ³æ˜¯è¿›æ­¥çš„ ç¼ºç‚¹ æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸã€‚ å› ä¸ºæ¯ä¸€ä¸ªæ¨¡å—éƒ½æ˜¯æš´éœ²åœ¨å…¨å±€çš„ï¼Œç®€å•çš„ä½¿ç”¨ï¼Œä¼šå¯¼è‡´å…¨å±€å˜é‡å‘½åå†²çªï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½åç©ºé—´çš„æ–¹å¼æ¥è§£å†³ã€‚å¯¹äºŽå¤§åž‹é¡¹ç›®ï¼Œå„ç§jså¾ˆå¤šï¼Œå¼€å‘äººå‘˜å¿…é¡»æ‰‹åŠ¨è§£å†³æ¨¡å—å’Œä»£ç åº“çš„ä¾èµ–å…³ç³»ï¼ŒåŽæœŸç»´æŠ¤æˆæœ¬è¾ƒé«˜ã€‚ä¾èµ–å…³ç³»ä¸æ˜Žæ˜¾ï¼Œä¸åˆ©äºŽç»´æŠ¤ã€‚ æ¯”å¦‚main.jséœ€è¦ä½¿ç”¨jqueryï¼Œä½†æ˜¯ï¼Œä»Žä¸Šé¢çš„æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ˜¯çœ‹ä¸å‡ºæ¥çš„ï¼Œå¦‚æžœjqueryå¿˜è®°äº†ï¼Œé‚£ä¹ˆå°±ä¼šæŠ¥é”™ã€‚ ç¬¬äºŒé˜¶æ®µï¼š CommonJSè§„èŒƒCommonJSå°±æ˜¯ä¸€ä¸ªJavaScriptæ¨¡å—åŒ–çš„è§„èŒƒï¼Œè¯¥è§„èŒƒæœ€åˆæ˜¯ç”¨åœ¨æœåŠ¡å™¨ç«¯çš„nodeçš„ï¼Œå‰ç«¯çš„webpackä¹Ÿæ˜¯å¯¹CommonJSåŽŸç”Ÿæ”¯æŒçš„ã€‚ æ ¹æ®è¿™ä¸ªè§„èŒƒï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå…¶å†…éƒ¨å®šä¹‰çš„å˜é‡æ˜¯å±žäºŽè¿™ä¸ªæ¨¡å—çš„ï¼Œä¸ä¼šå¯¹å¤–æš´éœ²ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šæ±¡æŸ“å…¨å±€å˜é‡ã€‚ CommonJSçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯é€šè¿‡ require æ–¹æ³•æ¥åŒæ­¥åŠ è½½æ‰€è¦ä¾èµ–çš„å…¶ä»–æ¨¡å—ï¼Œç„¶åŽé€šè¿‡ exports æˆ–è€… module.exports æ¥å¯¼å‡ºéœ€è¦æš´éœ²çš„æŽ¥å£ã€‚å¦‚ä¸‹æ‰€ç¤º 12// a.jsvar x = 5; var addX = function (value) &#123; return value + x; &#125;; module.exports.x = x; module.exports.addX = addX; è¿™é‡Œçš„a.jså°±æ˜¯ä¸€ä¸ªCommonJSè§„èŒƒçš„æ¨¡å—äº†ã€‚ è¿™é‡Œçš„moduleå°±ä»£è¡¨äº†è¿™ä¸ªæ¨¡å—ï¼Œmoduleçš„exportså±žæ€§å°±æ˜¯å¯¹å¤–æš´éœ²çš„æŽ¥å£ï¼Œå¯ä»¥å¯¹å¤–å¯¼å‡ºå¤–éƒ¨å¯ä»¥è®¿é—®çš„å˜é‡ï¼Œæ¯”å¦‚è¿™é‡Œçš„xå’ŒaddXã€‚ exports æ˜¯å¯¹ module.exports çš„å¼•ç”¨ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåœ¨ä¸€ä¸ªæ¨¡å—çš„é¡¶éƒ¨æœ‰è¿™å¥ä»£ç ï¼š 1export = export.Module; æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æŽ¥ç»™exportsèµ‹å€¼ï¼Œæ¯”å¦‚numberã€functionç­‰ã€‚ ç„¶åŽæˆ‘ä»¬å°±å¯ä»¥åœ¨å…¶ä»–æ¨¡å—ä¸­å¼•å…¥è¿™ä¸ªæ¨¡å—ä½¿ç”¨äº†ï¼š 123var a = require('./a.js'); console.log(example.x); // 5 console.log(example.addX(1)); // 6 è¿™é‡Œçš„requireå°±ä¼šèŽ·å–åˆ°a.jsæ‰€æš´éœ²çš„module.exportså˜é‡ï¼Œç„¶åŽå°±å¯ä»¥ä½¿ç”¨å…¶æš´éœ²çš„xå’ŒaddXäº†ã€‚ ä¼˜ç‚¹ï¼š CommonJSè§„èŒƒåœ¨æœåŠ¡å™¨ç«¯çŽ‡å…ˆå®Œæˆäº†JavaScriptçš„æ¨¡å—åŒ–ï¼Œè§£å†³äº†ä¾èµ–ã€å…¨å±€å˜é‡æ±¡æŸ“çš„é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯jsè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¿…è¦æ¡ä»¶ã€‚ ç¼ºç‚¹ï¼š æ­¤æ–‡ä¸»è¦æ˜¯æµè§ˆå™¨ç«¯jsçš„æ¨¡å—åŒ–ï¼Œ ç”±äºŽ CommonJS æ˜¯åŒæ­¥åŠ è½½æ¨¡å—çš„ï¼Œåœ¨æœåŠ¡å™¨ç«¯ï¼Œæ–‡ä»¶éƒ½æ˜¯ä¿å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œæ‰€ä»¥åŒæ­¥åŠ è½½æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¯¹äºŽæµè§ˆå™¨ç«¯ï¼Œéœ€è¦å°†æ–‡ä»¶ä»ŽæœåŠ¡å™¨ç«¯è¯·æ±‚è¿‡æ¥ï¼Œé‚£ä¹ˆåŒæ­¥åŠ è½½å°±ä¸é€‚ç”¨äº†ï¼Œæ‰€ä»¥ï¼ŒCommonJSæ˜¯ä¸é€‚ç”¨äºŽæµè§ˆå™¨ç«¯çš„ã€‚ ç¬¬ä¸‰é˜¶æ®µï¼š AMDè§„èŒƒä¹‹å‰æåˆ°: CommonJSè§„èŒƒåŠ è½½æ¨¡å—æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰åŠ è½½å®Œæˆï¼Œæ‰èƒ½æ‰§è¡ŒåŽé¢çš„æ“ä½œã€‚AMDè§„èŒƒåˆ™æ˜¯éžåŒæ­¥åŠ è½½æ¨¡å—ï¼Œå…è®¸æŒ‡å®šå›žè°ƒå‡½æ•°ã€‚ç”±äºŽNode.jsä¸»è¦ç”¨äºŽæœåŠ¡å™¨ç¼–ç¨‹ï¼Œæ¨¡å—æ–‡ä»¶ä¸€èˆ¬éƒ½å·²ç»å­˜åœ¨äºŽæœ¬åœ°ç¡¬ç›˜ï¼Œæ‰€ä»¥åŠ è½½èµ·æ¥æ¯”è¾ƒå¿«ï¼Œä¸ç”¨è€ƒè™‘éžåŒæ­¥åŠ è½½çš„æ–¹å¼ï¼Œæ‰€ä»¥CommonJSè§„èŒƒæ¯”è¾ƒé€‚ç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æžœæ˜¯æµè§ˆå™¨çŽ¯å¢ƒï¼Œè¦ä»ŽæœåŠ¡å™¨ç«¯åŠ è½½æ¨¡å—ï¼Œè¿™æ—¶å°±å¿…é¡»é‡‡ç”¨éžåŒæ­¥æ¨¡å¼ï¼Œå› æ­¤æµè§ˆå™¨ç«¯ä¸€èˆ¬é‡‡ç”¨AMDè§„èŒƒã€‚è€ŒAMDè§„èŒƒçš„å®žçŽ°ï¼Œå°±æ˜¯å¤§åé¼Žé¼Žçš„require.jsäº† AMDæ ‡å‡†ä¸­ï¼Œå®šä¹‰äº†ä¸‹é¢ä¸¤ä¸ªAPIï¼š 1231.require([module], callback)2.define(id, [depends], callback) å³é€šè¿‡defineæ¥å®šä¹‰ä¸€ä¸ªæ¨¡å—ï¼Œç„¶åŽä½¿ç”¨requireæ¥åŠ è½½ä¸€ä¸ªæ¨¡å—ã€‚ å¹¶ä¸”ï¼Œrequireè¿˜æ”¯æŒCommonJSçš„æ¨¡å—å¯¼å‡ºæ–¹å¼ã€‚ å®šä¹‰alertæ¨¡å—ï¼š 123456789101112131415161718192021define(function () &#123; var alertName = function (str) &#123; alert("I am " + str); &#125; var alertAge = function (num) &#123; alert("I am " + num + " years old"); &#125; return &#123; alertName: alertName, alertAge: alertAge &#125;; &#125;);``` å¼•å…¥æ¨¡å—ï¼š```jsrequire(['alert'], function (alert) &#123; alert.alertName('JohnZhu'); alert.alertAge(21);&#125;); ä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨require.jsçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»è¦ æå‰åŠ è½½æ‰€æœ‰çš„ä¾èµ–ï¼Œç„¶åŽæ‰å¯ä»¥ä½¿ç”¨ï¼Œè€Œä¸æ˜¯éœ€è¦ä½¿ç”¨æ—¶å†åŠ è½½ã€‚ ä¼˜ç‚¹ï¼š é€‚åˆåœ¨æµè§ˆå™¨çŽ¯å¢ƒä¸­å¼‚æ­¥åŠ è½½æ¨¡å—ã€‚å¯ä»¥å¹¶è¡ŒåŠ è½½å¤šä¸ªæ¨¡å—ã€‚ ç¼ºç‚¹ï¼š æé«˜äº†å¼€å‘æˆæœ¬ï¼Œå¹¶ä¸”ä¸èƒ½æŒ‰éœ€åŠ è½½ï¼Œè€Œæ˜¯å¿…é¡»æå‰åŠ è½½æ‰€æœ‰çš„ä¾èµ–ã€‚ ç¬¬å››é˜¶æ®µï¼šCMDè§„èŒƒCMDè§„èŒƒæ˜¯é˜¿é‡Œçš„çŽ‰ä¼¯æå‡ºæ¥çš„ï¼Œå®žçŽ°jsåº“ä¸ºsea.jsã€‚ å®ƒå’Œrequirejséžå¸¸ç±»ä¼¼ï¼Œå³ä¸€ä¸ªjsæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œä½†æ˜¯CMDçš„åŠ è½½æ–¹å¼æ›´åŠ ä¼˜ç§€ï¼Œæ˜¯é€šè¿‡æŒ‰éœ€åŠ è½½çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯å¿…é¡»åœ¨æ¨¡å—å¼€å§‹å°±åŠ è½½æ‰€æœ‰çš„ä¾èµ–ã€‚å¦‚ä¸‹ï¼š 123456define(function(require, exports, module) &#123; var $ = require('jquery'); var Spinning = require('./spinning'); exports.doSomething = ... module.exports = ...&#125;) ä¼˜ç‚¹ï¼š åŒæ ·å®žçŽ°äº†æµè§ˆå™¨ç«¯çš„æ¨¡å—åŒ–åŠ è½½ã€‚å¯ä»¥æŒ‰éœ€åŠ è½½ï¼Œä¾èµ–å°±è¿‘ã€‚ ç¼ºç‚¹ï¼š ä¾èµ–SPMæ‰“åŒ…ï¼Œæ¨¡å—çš„åŠ è½½é€»è¾‘åé‡ã€‚ å…¶å®žï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡º AMDå’ŒCMDçš„åŒºåˆ«äº†ï¼Œå‰è€…æ˜¯å¯¹äºŽä¾èµ–çš„æ¨¡å—æå‰æ‰§è¡Œï¼Œè€ŒåŽè€…æ˜¯å»¶è¿Ÿæ‰§è¡Œã€‚ å‰è€…æŽ¨å´‡ä¾èµ–å‰ç½®ï¼Œè€ŒåŽè€…æŽ¨å´‡ä¾èµ–å°±è¿‘ï¼Œå³åªåœ¨éœ€è¦ç”¨åˆ°æŸä¸ªæ¨¡å—çš„æ—¶å€™å†requireã€‚ å¦‚ä¸‹ï¼š 123456789101112131415161718// AMD define(['./a', './b'], function(a, b) &#123; // ä¾èµ–å¿…é¡»ä¸€å¼€å§‹å°±å†™å¥½ a.doSomething() // æ­¤å¤„ç•¥åŽ» 100 è¡Œ b.doSomething() //...&#125;);// CMDdefine(function(require, exports, module) &#123; var a = require('./a') a.doSomething() //æ­¤å¤„ç•¥åŽ»100è¡Œ varb=require('./b') //ä¾èµ–å¯ä»¥å°±è¿‘ä¹¦å†™ b.doSomething() //...&#125;); ç¬¬äº”é˜¶æ®µï¼š ES6æ¨¡å—åŒ–ä¹‹å‰çš„å‡ ç§æ¨¡å—åŒ–æ–¹æ¡ˆéƒ½æ˜¯å‰ç«¯ç¤¾åŒºè‡ªå·±å®žçŽ°çš„ï¼Œåªæ˜¯å¾—åˆ°äº†å¤§å®¶çš„è®¤å¯å’Œå¹¿æ³›ä½¿ç”¨ï¼Œè€ŒES6çš„æ¨¡å—åŒ–æ–¹æ¡ˆæ˜¯çœŸæ­£çš„è§„èŒƒã€‚ åœ¨ES6ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ import å…³é”®å­—å¼•å…¥æ¨¡å—ï¼Œé€šè¿‡ export å…³é”®å­—å¯¼å‡ºæ¨¡å—ï¼ŒåŠŸèƒ½è¾ƒä¹‹äºŽå‰å‡ ä¸ªæ–¹æ¡ˆæ›´ä¸ºå¼ºå¤§ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æ‰€æŽ¨å´‡çš„. ä½†æ˜¯ç”±äºŽES6ç›®å‰æ— æ³•åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡babelå°†ä¸è¢«æ”¯æŒçš„importç¼–è¯‘ä¸ºå½“å‰å—åˆ°å¹¿æ³›æ”¯æŒçš„ requireã€‚ è™½ç„¶ç›®å‰importå’Œrequireçš„åŒºåˆ«ä¸å¤§ï¼Œä½†æ˜¯è¿˜æ˜¯æŽ¨èä½¿ç”¨ä½¿ç”¨es6ï¼Œå› ä¸ºæœªæ¥es6å¿…å®šæ˜¯ä¸»æµï¼Œå¯¹äºŽä»£ç çš„è¿ç§»æˆæœ¬è¿˜æ˜¯éžå¸¸å®¹æ˜“çš„ã€‚ å¦‚ï¼š 12345678910import store from '../store/index'import &#123;mapState, mapMutations, mapActions&#125; from 'vuex'import axios from '../assets/js/request'import util from '../utils/js/util.js'export default &#123; created () &#123; this.getClassify(); this.RESET_VALUE(); console.log('created' ,new Date().getTime());&#125; ç¬¬å…­é˜¶æ®µï¼š UMDé€šè¿‡ä¸€å±‚è‡ªæ‰§è¡Œå‡½æ•°æ¥å…¼å®¹å„ç§æ¨¡å—åŒ–è§„èŒƒçš„å†™æ³•ï¼Œå…¼å®¹ AMD / CMD / CommonJS ç­‰æ¨¡å—åŒ–è§„èŒƒï¼Œè´´ä¸Šä»£ç èƒœè¿‡åƒè¨€ä¸‡è¯­ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ ES Module ç”±äºŽä¼šå¯¹é™æ€ä»£ç è¿›è¡Œåˆ†æžï¼Œæ•…è¿™ç§è¿è¡Œæ—¶çš„æ–¹æ¡ˆæ— æ³•ä½¿ç”¨ï¼Œæ­¤æ—¶é€šè¿‡ CommonJS è¿›è¡Œå…¼å®¹ï¼› 123456789101112131415(function (global, factory) &#123; if (typeof exports === 'object') &#123; module.exports = factory(); &#125; else if (typeof define === 'function' &amp;&amp; define.amd) &#123; define(factory); &#125; else &#123; this.eventUtil = factory(); &#125;&#125;)(this, function (exports) &#123; â€‹ // Define Module Object.defineProperty(exports, "__esModule", &#123; value: true &#125;); exports.default = 42;&#125;); æž„å»ºå·¥å…·ä¸­çš„å®žçŽ°ä¸ºäº†æ¨¡å—åŒ–åœ¨æµè§ˆå™¨ä¸­å®žçŽ°ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸€äº›æ¨¡å—åŒ–æ‰“åŒ…å·¥å…·è¿›è¡Œæ‰“åŒ…(ä»¥webpackä¸ºä¾‹)ï¼Œå®šä¹‰äº†é¡¹ç›®å…¥å£ä¹‹åŽï¼Œä¼šå…ˆå¿«é€Ÿåœ°è¿›è¡Œä¾èµ–çš„åˆ†æžï¼Œç„¶åŽå°†æ‰€æœ‰ä¾èµ–çš„æ¨¡å—è½¬æ¢æˆæµè§ˆå™¨å…¼å®¹çš„å¯¹åº”æ¨¡å—åŒ–è§„èŒƒçš„å®žçŽ°ï¼› æ¨¡å—åŒ–çš„åŸºç¡€ä»Žä¸Šé¢çš„ä»‹ç»ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¯¹å…¶è§„èŒƒå’Œå®žçŽ°æœ‰äº†ä¸€å®šçš„äº†è§£ï¼›åœ¨æµè§ˆå™¨ä¸­ï¼Œè¦å®žçŽ° CommonJS è§„èŒƒï¼Œåªéœ€è¦å®žçŽ° module / exports / require / global è¿™å‡ ä¸ªå±žæ€§ï¼Œç”±äºŽæµè§ˆå™¨ä¸­æ˜¯æ— æ³•è®¿é—®æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œå› æ­¤ require è¿‡ç¨‹ä¸­çš„æ–‡ä»¶å®šä½éœ€è¦æ”¹é€ ä¸ºåŠ è½½å¯¹åº”çš„ JS ç‰‡æ®µï¼ˆwebpack é‡‡ç”¨çš„æ–¹å¼ä¸ºé€šè¿‡å‡½æ•°ä¼ å‚å®žçŽ°ä¾èµ–çš„å¼•å…¥ï¼‰ã€‚ ä¸‹é¢ä¸ºwebpackæ‰“åŒ…å‡ºæ¥çš„ä»£ç å¿«ç…§å¦‚ä¸‹ï¼š 1234567891011121314151617(function (modules) &#123; // The module cache var installedModules = &#123;&#125;; // The require function function __webpack_require__(moduleId) &#123;&#125; return __webpack_require__(0); // ---&gt; 0&#125;)(&#123; 0: function (module, exports, __webpack_require__) &#123; // Define module A var moduleB = __webpack_require__(1); // ---&gt; 1 &#125;, 1: function (module, exports, __webpack_require__) &#123; // Define module B exports = &#123;&#125;; // ---&gt; 2 &#125;&#125;); å®žé™…ä¸Šï¼ŒES Module çš„å¤„ç†åŒ CommonJS ç›¸å·®æ— å‡ ï¼Œåªæ˜¯åœ¨å®šä¹‰æ¨¡å—å’Œå¼•å…¥æ¨¡å—æ—¶ä¼šåŽ»å¤„ç† __esModule æ ‡è¯†ï¼Œä»Žè€Œå…¼å®¹å…¶åœ¨è¯­æ³•ä¸Šçš„å·®å¼‚ã€‚ å¼‚æ­¥å’Œæ‰©å±•1ã€æµè§ˆå™¨çŽ¯å¢ƒä¸‹ï¼Œç½‘ç»œèµ„æºå—åˆ°è¾ƒå¤§çš„é™åˆ¶ï¼Œå› æ­¤æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å¦‚æžœä½“ç§¯å·¨å¤§ï¼Œå¯¹é¡µé¢æ€§èƒ½çš„æŸè€—æžå¤§ï¼Œå› æ­¤éœ€è¦å¯¹æž„å»ºçš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œæ‹†åˆ†ï¼ŒåŒæ—¶æ¨¡å—ä¹Ÿéœ€è¦æ”¯æŒåŠ¨æ€åŠ è½½ï¼› webpack æä¾›äº†ä¸¤ä¸ªæ–¹æ³• require.ensure() å’Œ import() ï¼ˆæŽ¨èä½¿ç”¨ï¼‰è¿›è¡Œæ¨¡å—çš„åŠ¨æ€åŠ è½½ï¼Œè‡³äºŽå…¶ä¸­çš„åŽŸç†ï¼Œè·Ÿä¸Šé¢æåŠçš„ AMD &amp; CMD æ‰€è§ç•¥åŒï¼Œimport() æ‰§è¡ŒåŽè¿”å›žä¸€ä¸ª Promise å¯¹è±¡ï¼Œå…¶ä¸­æ‰€åšçš„å·¥ä½œæ— éžä¹Ÿæ˜¯åŠ¨æ€æ–°å¢ž script æ ‡ç­¾ï¼Œç„¶åŽé€šè¿‡ onload / onerror äº‹ä»¶è¿›ä¸€æ­¥å¤„ç†ã€‚ 2ã€ç”±äºŽ require å‡½æ•°æ˜¯å®Œå…¨è‡ªå®šä¹‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¨¡å—åŒ–ä¸­å®žçŽ°æ›´å¤šçš„ç‰¹æ€§ï¼Œæ¯”å¦‚é€šè¿‡ä¿®æ”¹ require.resolve æˆ– Module._extensions æ‰©å±•æ”¯æŒçš„æ–‡ä»¶ç±»åž‹ï¼Œä½¿å¾— css / .jsx / .vue / å›¾ç‰‡ç­‰æ–‡ä»¶ä¹Ÿèƒ½ä¸ºæ¨¡å—åŒ–æ‰€ä½¿ç”¨ï¼› é™„å½•ä¸€ï¼šç‰¹æ€§ä¸€è§ˆè¡¨ æ¨¡å—åŒ–è§„èŒƒ åŠ è½½æ–¹å¼ åŠ è½½æ—¶æœº è¿è¡ŒçŽ¯å¢ƒ å¤‡æ³¨ AMD å¼‚æ­¥ è¿è¡Œæ—¶ æµè§ˆå™¨ CMD å¼‚æ­¥ è¿è¡Œæ—¶ æµè§ˆå™¨ CommonJS åŒæ­¥/å¼‚æ­¥ è¿è¡Œæ—¶ æµè§ˆå™¨/node ES Module åŒæ­¥/å¼‚æ­¥ ç¼–è¯‘é˜¶æ®µ æµè§ˆå™¨/node]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>æ¨¡å—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£BFC,IFC,GFCå’ŒFFC]]></title>
    <url>%2F2018%2F07%2F23%2FCSS3%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3BFC-IFC-GFC%E5%92%8CFFC%2F</url>
    <content type="text"><![CDATA[å‰è¨€BFC,IFC,IFC,FFFæ˜¯ä»€ä¹ˆï¼Œä¸»è¦è§£å†³çš„ä»€ä¹ˆé—®é¢˜ï¼Œå“ªäº›å…ƒç´ ä¼šç”ŸæˆBFCï¼Ÿæœ¬æ–‡ä¸»è¦é’ˆå¯¹è¿™å‡ ä¸ªé—®é¢˜æ¥äº†è§£ã€‚åœ¨è§£é‡Šä¹‹å‰ï¼Œéœ€è¦å…ˆä»‹ç» Boxã€Formatting Contextçš„æ¦‚å¿µã€‚ Box: CSSå¸ƒå±€çš„åŸºæœ¬å•ä½ Box æ˜¯ CSS å¸ƒå±€çš„å¯¹è±¡å’ŒåŸºæœ¬å•ä½ï¼Œ ç›´è§‚ç‚¹æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªé¡µé¢æ˜¯ç”±å¾ˆå¤šä¸ª Box ç»„æˆçš„ã€‚å…ƒç´ çš„ç±»åž‹å’Œ display å±žæ€§ï¼Œå†³å®šäº†è¿™ä¸ª Box çš„ç±»åž‹ã€‚ ä¸åŒç±»åž‹çš„ Boxï¼Œ ä¼šå‚ä¸Žä¸åŒçš„ Formatting Contextï¼ˆä¸€ä¸ªå†³å®šå¦‚ä½•æ¸²æŸ“æ–‡æ¡£çš„å®¹å™¨ï¼‰ï¼Œå› æ­¤Boxå†…çš„å…ƒç´ ä¼šä»¥ä¸åŒçš„æ–¹å¼æ¸²æŸ“ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æœ‰å“ªäº›ç›’å­ï¼š block-level box:display å±žæ€§ä¸º block, list-item, table çš„å…ƒç´ ï¼Œä¼šç”Ÿæˆ block-level boxã€‚å¹¶ä¸”å‚ä¸Ž block fomatting contextï¼› inline-level box:display å±žæ€§ä¸º inline, inline-block, inline-table çš„å…ƒç´ ï¼Œä¼šç”Ÿæˆ inline-level boxã€‚å¹¶ä¸”å‚ä¸Ž inline formatting contextï¼› run-in box: display å±žæ€§ä¸ºflex,grid å¦‚æžœ run-in box åŒ…å« block boxï¼Œé‚£ä¹ˆè¿™ä¸ª run-in box ä¹Ÿæˆä¸º block box å¦‚æžœç´§è·Ÿåœ¨ run-in box ä¹‹åŽçš„å…„å¼ŸèŠ‚ç‚¹æ˜¯ block boxï¼Œé‚£ä¹ˆè¿™ä¸ª run-in box å°±ä¼šåšä¸ºæ­¤ block box é‡Œçš„ inline boxï¼Œrun-in box ä¸èƒ½è¿›å…¥å·²ç»ä¸€ä¸ªå·²ç»ä»¥ run-in box å¼€å¤´çš„å—å†…ï¼Œä¹Ÿä¸èƒ½è¿›å…¥æœ¬èº«å°±æ˜¯ display:run-in; çš„å—å†… å¦åˆ™ï¼Œrun-in box æˆä¸º block box Formatting contextormatting context æ˜¯ W3C CSS2.1 è§„èŒƒä¸­çš„ä¸€ä¸ªæ¦‚å¿µã€‚å®ƒæ˜¯é¡µé¢ä¸­çš„ä¸€å—æ¸²æŸ“åŒºåŸŸï¼Œå¹¶ä¸”æœ‰ä¸€å¥—æ¸²æŸ“è§„åˆ™ï¼Œå®ƒå†³å®šäº†å…¶å­å…ƒç´ å°†å¦‚ä½•å®šä½ï¼Œä»¥åŠå’Œå…¶ä»–å…ƒç´ çš„å…³ç³»å’Œç›¸äº’ä½œç”¨ã€‚æœ€å¸¸è§çš„ Formatting context æœ‰ Block fomatting context (ç®€ç§°BFC)å’Œ Inline formatting context (ç®€ç§°IFC)ã€‚ BFCBFC(Block formatting context)ç›´è¯‘ä¸ºâ€å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡â€ã€‚å®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œåªæœ‰Block-level boxå‚ä¸Žï¼Œ å®ƒè§„å®šäº†å†…éƒ¨çš„Block-level Boxå¦‚ä½•å¸ƒå±€ï¼Œå¹¶ä¸”ä¸Žè¿™ä¸ªåŒºåŸŸå¤–éƒ¨æ¯«ä¸ç›¸å¹²ã€‚ BFCå¸ƒå±€è§„åˆ™ï¼š å†…éƒ¨çš„Boxä¼šåœ¨åž‚ç›´æ–¹å‘ï¼Œä¸€ä¸ªæŽ¥ä¸€ä¸ªåœ°æ”¾ç½®ã€‚ Boxåž‚ç›´æ–¹å‘çš„è·ç¦»ç”±marginå†³å®šã€‚å±žäºŽåŒä¸€ä¸ªBFCçš„ä¸¤ä¸ªç›¸é‚»Boxçš„marginä¼šå‘ç”Ÿé‡å  æ¯ä¸ªå…ƒç´ çš„margin boxçš„å·¦è¾¹ï¼Œ ä¸ŽåŒ…å«å—border boxçš„å·¦è¾¹ç›¸æŽ¥è§¦(å¯¹äºŽä»Žå·¦å¾€å³çš„æ ¼å¼åŒ–ï¼Œå¦åˆ™ç›¸å)ã€‚å³ä½¿å­˜åœ¨æµ®åŠ¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ BFCçš„åŒºåŸŸä¸ä¼šä¸Žfloat boxé‡å ã€‚ BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚åä¹‹ä¹Ÿå¦‚æ­¤ã€‚ è®¡ç®—BFCçš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿå‚ä¸Žè®¡ç®— å“ªäº›å…ƒç´ ä¼šç”ŸæˆBFC æ ¹å…ƒç´  floatå±žæ€§ä¸ä¸ºnone positionä¸ºabsoluteæˆ–fixed displayä¸ºinline-block, table-cell, table-caption, flex, inline-flex overflowä¸ä¸ºvisible BFCçš„ä½œç”¨åŠåŽŸç† è‡ªé€‚åº”ä¸¤æ å¸ƒå±€ æˆ‘ä»¬å¯ä»¥é€šè¿‡é€šè¿‡è§¦å‘mainç”ŸæˆBFCï¼Œ æ¥å®žçŽ°è‡ªé€‚åº”ä¸¤æ å¸ƒå±€ã€‚ 123.main &#123; overflow: hidden;&#125; æ¸…é™¤å†…éƒ¨æµ®åŠ¨ ä¸ºè¾¾åˆ°æ¸…é™¤å†…éƒ¨æµ®åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥è§¦å‘parç”ŸæˆBFCï¼Œé‚£ä¹ˆparåœ¨è®¡ç®—é«˜åº¦æ—¶ï¼Œparå†…éƒ¨çš„æµ®åŠ¨å…ƒç´ childä¹Ÿä¼šå‚ä¸Žè®¡ç®—ã€‚ 123.par &#123; overflow: hidden;&#125; é˜²æ­¢åž‚ç›´ margin é‡å  æˆ‘ä»¬å¯ä»¥åœ¨på¤–é¢åŒ…è£¹ä¸€å±‚å®¹å™¨ï¼Œå¹¶è§¦å‘è¯¥å®¹å™¨ç”Ÿæˆä¸€ä¸ªBFCã€‚é‚£ä¹ˆä¸¤ä¸ªPä¾¿ä¸å±žäºŽåŒä¸€ä¸ªBFCï¼Œå°±ä¸ä¼šå‘ç”Ÿmarginé‡å äº†ã€‚ 12345678910111213141516171819&lt;style&gt; .wrap &#123; overflow: hidden; &#125; p &#123; color: #f55; background: #fcc; width: 200px; line-height: 100px; text-align:center; margin: 100px; &#125;&lt;/style&gt;&lt;body&gt; &lt;p&gt;Haha&lt;/p&gt; &lt;div class="wrap"&gt; &lt;p&gt;Hehe&lt;/p&gt; &lt;/div&gt;&lt;/body&gt; å› ä¸ºBFCå†…éƒ¨çš„å…ƒç´ å’Œå¤–éƒ¨çš„å…ƒç´ ç»å¯¹ä¸ä¼šäº’ç›¸å½±å“ï¼Œå› æ­¤ï¼Œ å½“BFCå¤–éƒ¨å­˜åœ¨æµ®åŠ¨æ—¶ï¼Œå®ƒä¸åº”è¯¥å½±å“BFCå†…éƒ¨Boxçš„å¸ƒå±€ï¼ŒBFCä¼šé€šè¿‡å˜çª„ï¼Œè€Œä¸ä¸Žæµ®åŠ¨æœ‰é‡å ã€‚åŒæ ·çš„ï¼Œå½“BFCå†…éƒ¨æœ‰æµ®åŠ¨æ—¶ï¼Œä¸ºäº†ä¸å½±å“å¤–éƒ¨å…ƒç´ çš„å¸ƒå±€ï¼ŒBFCè®¡ç®—é«˜åº¦æ—¶ä¼šåŒ…æ‹¬æµ®åŠ¨çš„é«˜åº¦ã€‚é¿å…marginé‡å ä¹Ÿæ˜¯è¿™æ ·çš„ä¸€ä¸ªé“ç†ã€‚ IFCIFC(Inline-Formatting-Contexts)å³å†…è”æ ¼å¼åŒ–ä¸Šä¸‹æ–‡å¸ƒå±€ã€‚ä¸€èˆ¬éƒ½æ˜¯è¡Œå†…å…ƒç´ æ¯”å¦‚ï¼šinput a img span ä»¥åŠdisplay å±žæ€§å€¼ä¸ºinline-blockçš„å…ƒç´ ã€‚ è¡Œå†…å…ƒç´ æœ‰å“ªäº›ç‰¹ç‚¹å‘¢ã€‚ï¼Ÿå¦‚ä¸‹åˆ—ä¸¾ï¼š æ°´å¹³æ–¹å‘æ ¹æ®directionä¾æ¬¡å¸ƒå±€ã€‚ ä¸ä¼šåœ¨å…ƒç´ å‰åŽæ¢è¡Œã€‚ å—white-spaceå±žæ€§çš„å½±å“ã€‚ margin/padding åœ¨ç«–ç›´æ–¹å‘æ— æ•ˆï¼Œæ°´å¹³æ–¹å‘æœ‰æ•ˆçš„ã€‚ white/height å¯¹éžæ›¿æ¢è¡Œå†…å…ƒç´ æ— æ•ˆï¼Œå®½åº¦ç”±å…ƒç´ å†…å®¹å†³å®šã€‚ éžæ›¿æ¢è¡Œå†…å…ƒç´ çš„è¡Œæ¡†é«˜ç”±line-heightå†³å®šè€Œæ›¿æ¢è¡Œå†…å…ƒç´ çš„è¡Œæ¡†é«˜åˆ™æ˜¯ç”±heightï¼Œpaddingï¼Œborderï¼Œmarginå†³å®š æµ®åŠ¨æˆ–è€…ç»å¯¹å®šä½ä¼šè½¬åŒ–ä¸ºblock vertical-alignå±žæ€§ç”Ÿæ•ˆ IFCçš„å¸ƒå±€è§„åˆ™å¦‚ä¸‹ï¼š æ¡†ä¼šä»ŽåŒ…å«å—çš„é¡¶éƒ¨å¼€å§‹ï¼Œç„¶åŽä¸€ä¸ªæŽ¥ä¸€ä¸ªçš„æŽ’åˆ—ã€‚ åœ¨æ”¾ç½®è¿™äº›æ¡†çš„æ—¶å€™ï¼Œä»–ä»¬åœ¨æ°´å¹³æ–¹å‘ä¸Šçš„å¤–è¾¹è·ï¼Œè¾¹æ¡†å’Œå†…è¾¹è·æ‰€å çš„ç©ºé—´éƒ½ä¼šè¢«è€ƒè™‘åœ¨å†…ï¼ˆè¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªä¸€ä¸ªçš„æ¡†ï¼‰ã€‚ç„¶è€Œåœ¨åž‚ç›´æ–¹å‘ä¸Šï¼Œè¿™äº›æ¡†å¯èƒ½ä¼šä»¥ä¸åŒçš„æ–¹å¼æ¥å¯¹é½ï¼Œæ¯”å¦‚ä»–ä»¬å¯ä»¥é¡¶éƒ¨å¯¹é½ï¼Œæˆ–è€…åº•éƒ¨å¯¹é½ä¹Ÿæœ‰å¯èƒ½æŒ‰ç…§æ–‡æœ¬çš„åŸºçº¿å¯¹é½ã€‚è€ŒæŠŠè¿™ä¸€è¡Œä¸Šçš„æ¡†éƒ½åŒ…å«è¿›åŽ»çš„ä¸€ä¸ªå¤§æ¡†æˆ‘ä»¬ç§°ä¹‹ä¸ºæ”¹è¡Œçš„è¡Œæ¡†ã€‚æ°´å¹³çš„padding,border,marginæœ‰æ•ˆï¼Œç«–ç›´æ–¹å‘åˆ™æ— æ•ˆã€‚ä¸èƒ½æŒ‡å®šæ¡†é«˜ã€‚ è¡Œå®½çš„å®½åº¦ç”±åŒ…å«å—å’Œå­˜åœ¨çš„æµ®åŠ¨å†³å®šçš„ã€‚è¡Œæ¡†çš„é«˜åº¦è‡³å°‘ä¼šé«˜åˆ°è¶³ä»¥åŒ…å«ä»–å†…éƒ¨çš„æ‰€æœ‰æ¡†ã€‚ å½“ä¸€è¡Œä¸Šçš„è¡Œçº§æ€»å®½åº¦ï¼ˆæŸä¸€ä¸ªå°æ¡†çš„å®½åº¦æˆ–è€…è‹¥å¹²ä¸ªå°æ¡†çš„æ€»å®½åº¦ï¼‰å°äºŽè¡Œå®½çš„æ—¶å€™ï¼Œä»–ä»¬åœ¨è¡Œå®½å†…çš„æ°´å¹³æ–¹å‘ä¸Šçš„æŽ’å¸ƒç”±text-alignå†³å®šã€‚ å½“ä¸€ä¸ªè¡Œå†…æ¡†çš„å®½åº¦è¶…è¿‡äº†è¯¥è¡Œçš„è¡Œå®½çš„æ—¶å€™ï¼Œå°±ä¼šè¢«åˆ†æˆå‡ ä¸ªæ¡†ã€‚(ex.æ–‡å­—æ¢è¡Œçš„æ—¶å€™ å­—éƒ½ä¸åœ¨åŒä¸€è¡Œäº†ï¼Œé‚£æ¢è¡Œçš„æ—¶å€™è‡ªç„¶å°±ä¼šå¤šä¸€ä»½æ¡†ï¼Œè‡ªç„¶ä¹Ÿå°±å¤šäº†ä¸€ä»½è¡Œå®½)ä½†æ˜¯å¦‚æžœè®¾ç½®è¿™ä¸ªæ¡†å°±ä¸èƒ½è¢«åˆ†å‰²çš„è¯ï¼ˆæ¯”å¦‚ï¼Œæ–‡å­—å¼ºåˆ¶ä¸ç»™æ¢è¡Œwhite-spaceè®¾ç½®ä¸ºnowrapï¼‰é‚£ä¹ˆè¿™æ—¶å€™è¯¥è¡Œå†…æ¡†å°±ä¼šæº¢å‡ºè¯¥è¡Œçš„è¡Œå®½ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹è¡Œå®½çš„å·¦è¾¹ç´§è´´åœ¨ä»–çš„åŒ…å«å—çš„å·¦è¾¹ï¼ŒåŒæ ·ä»–çš„å³è¾¹ä¹Ÿæ˜¯ç´§è´´åœ¨å…¶åŒ…å«å—çš„å³è¾¹ã€‚ä½†æ˜¯ä¹Ÿä¸ä¸€å®šï¼Œæ¯”å¦‚å‡ºçŽ°æµ®åŠ¨çš„è¯ï¼Œæµ®åŠ¨å…ƒç´ å¯èƒ½ä¼šæ’åœ¨åŒ…å«å—å’Œè¡Œæ¡†ä¹‹é—´ã€‚æ‰€ä»¥ä¸€èˆ¬åœ¨åŒä¸€ä¸ªIFCä¸­è¡Œæ¡†é€šå¸¸æœ‰ç›¸åŒçš„å®½åº¦ï¼ˆåŒ…å«å¿«çš„å®½åº¦ï¼‰ä½†æ˜¯æŸä¸€è¡Œçš„è¡Œå®½çš„å®½åº¦ä¹Ÿå¯èƒ½å—æµ®åŠ¨å…ƒç´ å½±å“ï¼Œå‡å°‘äº†æ°´å¹³å¯ç”¨çš„å®½åº¦äº†ã€‚åœ¨åŒä¸€ä¸ªIFCä¸­ï¼Œè¡Œæ¡†çš„é«˜åº¦é€šå¸¸æ˜¯å˜åŒ–çš„ï¼Œä¸ä¸€å®šçš„ï¼Œæ¯”å¦‚æŸä¸€è¡Œçš„æŸä¸ªæ¡†æ˜¯ä¸ªå¾ˆé«˜çš„å›¾ç‰‡ï¼Œè€Œæ”¹è¡Œæ¡†ä¸­å…¶ä»–æ¡†åªæ˜¯æ–‡å­—ã€‚ è®¡ç®—è¡Œæ¡†å†…å„ä¸ªæ¡†çš„é«˜åº¦ï¼Œå¯¹äºŽéžæ›¿æ¢å…ƒç´ å°±æ˜¯èµ·line-height,è€Œå¯¹äºŽæ›¿æ¢å…ƒç´ å°±æ˜¯è¾¹ç•Œæ¡†çš„é«˜åº¦äº†ã€‚ è¡Œæ¡†çš„é«˜æ˜¯æœ€é¡¶ç«¯æ¡†çš„é¡¶è¾¹åˆ°æœ€åº•ç«¯æ¡†çš„åº•è¾¹çš„è·ç¦»ã€‚ è¡¥å……ï¼šåŒ…å«å—çš„æ¦‚å¿µï¼šç®€å•è¯´å°±æ˜¯å®šä½å‚è€ƒæ¡†æˆ–è€…å®šä½åæ ‡å‚è€ƒç³»ï¼Œå…ƒç´ ä¸€æ—¦å®šä¹‰äº†å®šä½æ˜¾ç¤ºï¼ˆç›¸å¯¹ã€ç»å¯¹ã€å›ºå®šï¼‰éƒ½å…·æœ‰åŒ…å«å—æ€§è´¨ï¼Œå®ƒæ‰€åŒ…å«çš„å®šä½å…ƒç´ éƒ½å°†ä»¥è¯¥åŒ…å«å—ä¸ºåæ ‡ç³»è¿›è¡Œå®šä½å’Œè°ƒæ•´ã€‚æ˜¯è§†è§‰æ ¼å¼åŒ–æ¨¡åž‹çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå®ƒä¸Žæ¡†æ¨¡åž‹ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªçŸ©å½¢ï¼Œè€Œè¿™ä¸ªçŸ©å½¢çš„ä½œç”¨æ˜¯ä¸ºå®ƒé‡Œé¢åŒ…å«çš„å…ƒç´ æä¾›ä¸€ä¸ªå‚è€ƒï¼Œå…ƒç´ çš„å°ºå¯¸å’Œä½ç½®çš„è®¡ç®—å¾€å¾€æ˜¯ç”±è¯¥å…ƒç´ æ‰€åœ¨çš„åŒ…å«å—å†³å®šçš„ã€‚ FFCå¼¹æ€§å¸ƒå±€(FFC-Flex Formattig-Contexts è‡ªé€‚åº”æ ¼å¼åŒ–ä¸Šä¸‹æ–‡)ç”³æ˜Ž display:flex; æˆ–è€…display:inline-flex(è¡Œå†…å¼¹æ€§å¸ƒå±€) è¿™ä¸ªå¸ƒå±€æ˜¯æˆ‘æœ€çˆ±çš„å¸ƒå±€ä¹‹ä¸€äº†ï¼Œå› ä¸ºä»–å¯ä»¥éžå¸¸è½»æ¾çš„å®žçŽ°å…ƒç´ çš„ä¸Šä¸‹å±…ä¸­ï¼Œå·¦å³å±…ä¸­ï¼›åªéœ€è¦justify-content:centerï¼ˆå·¦å³å±…ä¸­ï¼‰align-items:center;(ä¸Šä¸‹å±…ä¸­)å°±okäº†.ç”³æ˜Žflexä¹‹åŽè¿™ä¸ªå…ƒç´ å°±ä¼šæˆä¸ºä¸€ä¸ªflexå®¹å™¨ï¼Œè€Œä»–çš„å­å…ƒç´ å°±ä¼šè‡ªåŠ¨æˆä¸ºè¿™ä¸ªå®¹å™¨çš„æˆå‘˜ï¼Œç®€ç§°ä¸ºé¡¹ç›®ã€‚è€Œå…¶ä¸­åˆä¼šæœ‰ä¸¤ä¸ªè½´çº¿ï¼ˆç±»ä¼¼äºŽç¬›å¡å°”åæ ‡ç³»çš„ä¸¤ä¸ªè½´å§ï¼‰æ¨ªçš„ç§°ä¹‹ä¸ºä¸»è½´ï¼Œç«–ç€çš„ç§°ä¹‹ä¸ºäº¤å‰è½´ï¼Œå®¹å™¨æ˜¯ä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œä»–å¯¹è‡ªå·±å†…éƒ¨çš„é¡¹ç›®æœ‰ç€è‡ªå·±çš„ä¸€å¥—æ¸²æŸ“è§„åˆ™ï¼Œä¸å—å®¹å™¨å¤–éƒ¨çš„å½±å“ï¼ŒåŒæ ·çš„ï¼Œå®¹å™¨å†…éƒ¨çš„è§„åˆ™ä¹Ÿä¸ä¼šå½±å“å¤–é¢ã€‚ å®¹å™¨å±žæ€§ï¼šå…­ä¸ªå±žæ€§åˆ†åˆ«ä¸ºï¼šflex-direction,flex-wrap,flex-flow,justify-content,align-items,align-content é¡¹ç›®å±žæ€§ï¼šå…­ä¸ªå±žæ€§åˆ†åˆ«ä¸ºï¼šorderï¼Œflex-growï¼Œflex-shrinkï¼Œflex-basisï¼Œflexï¼Œalign-self GFCGFCï¼ˆGrid Formatting Contextsï¼‰æ …æ ¼æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ å½“ä¸ºä¸€ä¸ªå…ƒç´ è®¾ç½®displayå€¼ä¸ºgridçš„æ—¶å€™ï¼Œæ­¤å…ƒç´ å°†ä¼šèŽ·å¾—ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ç½‘æ ¼å®¹å™¨ï¼ˆgrid containerï¼‰ä¸Šå®šä¹‰ç½‘æ ¼å®šä¹‰è¡Œï¼ˆgrid definition rowsï¼‰å’Œç½‘æ ¼å®šä¹‰åˆ—ï¼ˆgrid definition columnsï¼‰å±žæ€§å„åœ¨ç½‘æ ¼é¡¹ç›®ï¼ˆgrid itemï¼‰ä¸Šå®šä¹‰ç½‘æ ¼è¡Œï¼ˆgrid rowï¼‰å’Œç½‘æ ¼åˆ—ï¼ˆgrid columnsï¼‰ä¸ºæ¯ä¸€ä¸ªç½‘æ ¼é¡¹ç›®ï¼ˆgrid itemï¼‰å®šä¹‰ä½ç½®å’Œç©ºé—´ã€‚ é‚£ä¹ˆGFCæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œå’Œtableåˆæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿé¦–å…ˆåŒæ ·æ˜¯ä¸€ä¸ªäºŒç»´çš„è¡¨æ ¼ï¼Œä½†GridLayoutä¼šæœ‰æ›´åŠ ä¸°å¯Œçš„å±žæ€§æ¥æŽ§åˆ¶è¡Œåˆ—ï¼ŒæŽ§åˆ¶å¯¹é½ä»¥åŠæ›´ä¸ºç²¾ç»†çš„æ¸²æŸ“è¯­ä¹‰å’ŒæŽ§åˆ¶ã€‚]]></content>
      <categories>
        <category>Css3</category>
      </categories>
      <tags>
        <tag>Css</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ çœŸçš„äº†è§£setStateå—ï¼Ÿ]]></title>
    <url>%2F2018%2F07%2F19%2FReact%2F%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BA%86%E8%A7%A3setState%E5%90%97%EF%BC%9F%2F</url>
    <content type="text"><![CDATA[å‰è¨€çœ‹ä¹‹å‰ï¼Œä¸ºäº†æ–¹ä¾¿ç†è§£å’Œç®€åŒ–æµç¨‹ï¼Œæˆ‘ä»¬é»˜è®¤reactå†…éƒ¨ä»£ç æ‰§è¡Œåˆ° performWorkã€performWorkOnRootã€performSyncWorkã€performAsyncWork è¿™å››ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå°±æ˜¯reactåŽ»updateæ›´æ–°å¹¶ä¸”ä½œç”¨åˆ°UIä¸Šã€‚ åˆæˆäº‹ä»¶ä¸­çš„setStateé¦–å…ˆå¾—äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯åˆæˆäº‹ä»¶ï¼Œreactä¸ºäº†è§£å†³è·¨å¹³å°ï¼Œå…¼å®¹æ€§é—®é¢˜ï¼Œè‡ªå·±å°è£…äº†ä¸€å¥—äº‹ä»¶æœºåˆ¶ï¼Œä»£ç†äº†åŽŸç”Ÿçš„äº‹ä»¶ï¼Œåƒåœ¨jsxä¸­å¸¸è§çš„onClickã€onChangeè¿™äº›éƒ½æ˜¯åˆæˆäº‹ä»¶ã€‚ 12345678910111213141516class App extends Component &#123; state = &#123; val: 0 &#125; increment = () =&gt; &#123; this.setState(&#123; val: this.state.val + 1 &#125;) console.log(this.state.val) // è¾“å‡ºçš„æ˜¯æ›´æ–°å‰çš„val --&gt; 0 &#125; render() &#123; return ( &lt;div onClick=&#123;this.increment&#125;&gt; &#123;`Counter is: $&#123;this.state.val&#125;`&#125; &lt;/div&gt; ) &#125;&#125; åˆæˆäº‹ä»¶ä¸­çš„setStateå†™æ³•æ¯”è¾ƒå¸¸è§ï¼Œç‚¹å‡»äº‹ä»¶é‡ŒåŽ»æ”¹å˜ this.state.val çš„çŠ¶æ€å€¼ï¼Œåœ¨ increment äº‹ä»¶ä¸­æ‰“ä¸ªæ–­ç‚¹å¯ä»¥çœ‹åˆ°è°ƒç”¨æ ˆï¼Œè¿™é‡Œæˆ‘è´´ä¸€å¼ è‡ªå·±ç”»çš„æµç¨‹å›¾ï¼š ä»Ž dispatchInteractiveEvent åˆ° callCallBack ä¸ºæ­¢ï¼Œéƒ½æ˜¯å¯¹åˆæˆäº‹ä»¶çš„å¤„ç†å’Œæ‰§è¡Œï¼Œä»Ž setState åˆ° requestWork æ˜¯è°ƒç”¨ this.setState çš„é€»è¾‘ï¼Œè¿™è¾¹ä¸»è¦çœ‹ä¸‹ requestWork è¿™ä¸ªå‡½æ•°ï¼ˆä»Ž dispatchEvent åˆ° requestWork çš„è°ƒç”¨æ ˆæ˜¯å±žäºŽ interactiveUpdates$1 çš„ stry ä»£ç å—ï¼Œä¸‹æ–‡ä¼šæåˆ°ï¼‰ã€‚ 12345678910111213141516171819202122232425262728function requestWork(root, expirationTime) &#123; addRootToSchedule(root, expirationTime); if (isRendering) &#123; // Prevent reentrancy. Remaining work will be scheduled at the end of // the currently rendering batch. return; &#125; if (isBatchingUpdates) &#123; // Flush work at the end of the batch. if (isUnbatchingUpdates) &#123; // ...unless we're inside unbatchedUpdates, in which case we should // flush it now. nextFlushedRoot = root; nextFlushedExpirationTime = Sync; performWorkOnRoot(root, Sync, false); &#125; return; &#125; // TODO: Get rid of Sync and use current time? if (expirationTime === Sync) &#123; performSyncWork(); &#125; else &#123; scheduleCallbackWithExpiration(expirationTime); &#125;&#125; åœ¨ requestWork ä¸­æœ‰ä¸‰ä¸ªifåˆ†æ”¯ï¼Œä¸‰ä¸ªåˆ†æ”¯ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³• performWorkOnRoot å’Œ performSyncWork ï¼Œå°±æ˜¯æˆ‘ä»¬é»˜è®¤çš„updateå‡½æ•°ï¼Œä½†æ˜¯åœ¨åˆæˆäº‹ä»¶ä¸­ï¼Œèµ°çš„æ˜¯ç¬¬äºŒä¸ªifåˆ†æ”¯ï¼Œç¬¬äºŒä¸ªåˆ†æ”¯ä¸­æœ‰ä¸¤ä¸ªæ ‡è¯† isBatchingUpdates å’Œ isUnbatchingUpdates ä¸¤ä¸ªåˆå§‹å€¼éƒ½ä¸º false ï¼Œä½†æ˜¯åœ¨ interactiveUpdates$1 ä¸­ä¼šæŠŠ isBatchingUpdates è®¾ä¸º true ï¼Œä¸‹é¢å°±æ˜¯ interactiveUpdates$1 çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627function interactiveUpdates$1(fn, a, b) &#123; if (isBatchingInteractiveUpdates) &#123; return fn(a, b); &#125; // If there are any pending interactive updates, synchronously flush them. // This needs to happen before we read any handlers, because the effect of // the previous event may influence which handlers are called during // this event. if (!isBatchingUpdates &amp;&amp; !isRendering &amp;&amp; lowestPendingInteractiveExpirationTime !== NoWork) &#123; // Synchronously flush pending interactive updates. performWork(lowestPendingInteractiveExpirationTime, false, null); lowestPendingInteractiveExpirationTime = NoWork; &#125; var previousIsBatchingInteractiveUpdates = isBatchingInteractiveUpdates; var previousIsBatchingUpdates = isBatchingUpdates; isBatchingInteractiveUpdates = true; isBatchingUpdates = true; // æŠŠrequestWorkä¸­çš„isBatchingUpdatesæ ‡è¯†æ”¹ä¸ºtrue try &#123; return fn(a, b); &#125; finally &#123; isBatchingInteractiveUpdates = previousIsBatchingInteractiveUpdates; isBatchingUpdates = previousIsBatchingUpdates; if (!isBatchingUpdates &amp;&amp; !isRendering) &#123; performSyncWork(); &#125; &#125;&#125; åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æŠŠ isBatchingUpdates è®¾ä¸ºäº† true ,å¯¼è‡´åœ¨ requestWork æ–¹æ³•ä¸­ï¼Œ isBatchingUpdates ä¸º true ï¼Œä½†æ˜¯ isUnbatchingUpdates æ˜¯ false ï¼Œè€Œè¢«ç›´æŽ¥returnäº†ã€‚ é‚£returnå®Œçš„é€»è¾‘å›žåˆ°å“ªé‡Œå‘¢ï¼Œæœ€ç»ˆæ­£æ˜¯å›žåˆ°äº† interactiveUpdates è¿™ä¸ªæ–¹æ³•ï¼Œä»”ç»†çœ‹ä¸€çœ¼ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢æœ‰ä¸ª try finallyè¯­æ³•ï¼Œå‰ç«¯åŒå­¦è¿™ä¸ªå…¶å®žæ˜¯ç”¨çš„æ¯”è¾ƒå°‘çš„ï¼Œç®€å•çš„è¯´å°±æ˜¯ä¼šå…ˆæ‰§è¡Œ try ä»£ç å—ä¸­çš„è¯­å¥ï¼Œç„¶åŽå†æ‰§è¡Œ finally ä¸­çš„ä»£ç ï¼Œè€Œ fn(a, b) æ˜¯åœ¨tryä»£ç å—ä¸­ï¼Œåˆšæ‰è¯´åˆ°åœ¨ requestWork ä¸­è¢«returnæŽ‰çš„ä¹Ÿå°±æ˜¯è¿™ä¸ªfnï¼ˆä¸Šæ–‡æåˆ°çš„ ä»ŽdispatchEvent åˆ° requestWork çš„ä¸€æ•´ä¸ªè°ƒç”¨æ ˆï¼‰ã€‚ æ‰€ä»¥å½“ä½ åœ¨ increment ä¸­è°ƒç”¨ setState ä¹‹åŽåŽ»console.logçš„æ—¶å€™ï¼Œæ˜¯å±žäºŽ try ä»£ç å—ä¸­çš„æ‰§è¡Œï¼Œä½†æ˜¯ç”±äºŽæ˜¯åˆæˆäº‹ä»¶ï¼Œtryä»£ç å—æ‰§è¡Œå®Œstateå¹¶æ²¡æœ‰æ›´æ–°ï¼Œæ‰€ä»¥ä½ è¾“å…¥çš„ç»“æžœæ˜¯æ›´æ–°å‰çš„ state å€¼ï¼Œè¿™å°±å¯¼è‡´äº†æ‰€è°“çš„â€å¼‚æ­¥â€ï¼Œä½†æ˜¯å½“ä½ çš„tryä»£ç å—æ‰§è¡Œå®Œçš„æ—¶å€™ï¼ˆä¹Ÿå°±æ˜¯ä½ çš„incrementåˆæˆäº‹ä»¶ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™ä¼šåŽ»æ‰§è¡Œ finally é‡Œçš„ä»£ç ï¼Œåœ¨ finally ä¸­æ‰§è¡Œäº† performSyncWork æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™æ‰ä¼šåŽ»æ›´æ–°ä½ çš„ state å¹¶ä¸”æ¸²æŸ“åˆ°UIä¸Šã€‚ ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„setState12345678910111213141516class App extends Component &#123; state = &#123; val: 0 &#125; componentDidMount() &#123; this.setState(&#123; val: this.state.val + 1 &#125;) console.log(this.state.val) // è¾“å‡ºçš„è¿˜æ˜¯æ›´æ–°å‰çš„å€¼ --&gt; 0 &#125; render() &#123; return ( &lt;div&gt; &#123;`Counter is: $&#123;this.state.val&#125;`&#125; &lt;/div&gt; ) &#125;&#125; é’©å­å‡½æ•°ä¸­setStateçš„è°ƒç”¨æ ˆï¼š å…¶å®žè¿˜æ˜¯å’Œåˆæˆäº‹ä»¶ä¸€æ ·ï¼Œå½“ componentDidmount æ‰§è¡Œçš„æ—¶å€™ï¼Œreactå†…éƒ¨å¹¶æ²¡æœ‰æ›´æ–°ï¼Œæ‰§è¡Œå®ŒcomponentDidmount åŽæ‰åŽ» commitUpdateQueue æ›´æ–°ã€‚è¿™å°±å¯¼è‡´ä½ åœ¨ componentDidmount ä¸­ setState å®ŒåŽ»console.logæ‹¿çš„ç»“æžœè¿˜æ˜¯æ›´æ–°å‰çš„å€¼ã€‚ åŽŸç”Ÿäº‹ä»¶ä¸­çš„setState123456789101112131415161718192021class App extends Component &#123; state = &#123; val: 0 &#125; changeValue = () =&gt; &#123; this.setState(&#123; val: this.state.val + 1 &#125;) console.log(this.state.val) // è¾“å‡ºçš„æ˜¯æ›´æ–°åŽçš„å€¼ --&gt; 1 &#125; componentDidMount() &#123; document.body.addEventListener('click', this.changeValue, false) &#125; render() &#123; return ( &lt;div&gt; &#123;`Counter is: $&#123;this.state.val&#125;`&#125; &lt;/div&gt; ) &#125;&#125; åŽŸç”Ÿäº‹ä»¶æ˜¯æŒ‡éžreactåˆæˆäº‹ä»¶ï¼ŒåŽŸç”Ÿè‡ªå¸¦çš„äº‹ä»¶ç›‘å¬ addEventListener ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç”¨åŽŸç”Ÿjsã€jqç›´æŽ¥ document.querySelector().onclick è¿™ç§ç»‘å®šäº‹ä»¶çš„å½¢å¼éƒ½å±žäºŽåŽŸç”Ÿäº‹ä»¶ã€‚ åŽŸç”Ÿäº‹ä»¶çš„è°ƒç”¨æ ˆå°±æ¯”è¾ƒç®€å•äº†ï¼Œå› ä¸ºæ²¡æœ‰èµ°åˆæˆäº‹ä»¶çš„é‚£ä¸€å¤§å †ï¼Œç›´æŽ¥è§¦å‘clickäº‹ä»¶ï¼Œåˆ° requestWork ,åœ¨requestWorké‡Œç”±äºŽ expirationTime === Sync çš„åŽŸå› ï¼Œç›´æŽ¥èµ°äº† performSyncWork åŽ»æ›´æ–°ï¼Œå¹¶ä¸åƒåˆæˆäº‹ä»¶æˆ–é’©å­å‡½æ•°ä¸­è¢«returnï¼Œæ‰€ä»¥å½“ä½ åœ¨åŽŸç”Ÿäº‹ä»¶ä¸­setStateåŽï¼Œèƒ½åŒæ­¥æ‹¿åˆ°æ›´æ–°åŽçš„stateå€¼ã€‚ setTimeoutä¸­çš„setState12345678910111213141516171819class App extends Component &#123; state = &#123; val: 0 &#125; componentDidMount() &#123; setTimeout(_ =&gt; &#123; this.setState(&#123; val: this.state.val + 1 &#125;) console.log(this.state.val) // è¾“å‡ºæ›´æ–°åŽçš„å€¼ --&gt; 1 &#125;, 0) &#125; render() &#123; return ( &lt;div&gt; &#123;`Counter is: $&#123;this.state.val&#125;`&#125; &lt;/div&gt; ) &#125;&#125; åœ¨ setTimeout ä¸­åŽ» setState å¹¶ä¸ç®—æ˜¯ä¸€ä¸ªå•ç‹¬çš„åœºæ™¯ï¼Œå®ƒæ˜¯éšç€ä½ å¤–å±‚åŽ»å†³å®šçš„ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨åˆæˆäº‹ä»¶ä¸­ setTimeout ï¼Œå¯ä»¥åœ¨é’©å­å‡½æ•°ä¸­ setTimeout ï¼Œä¹Ÿå¯ä»¥åœ¨åŽŸç”Ÿäº‹ä»¶setTimeoutï¼Œä½†æ˜¯ä¸ç®¡æ˜¯å“ªä¸ªåœºæ™¯ä¸‹ï¼ŒåŸºäºŽ event loopçš„æ¨¡åž‹ä¸‹ï¼Œ setTimeout ä¸­é‡ŒåŽ» setState æ€»èƒ½æ‹¿åˆ°æœ€æ–°çš„stateå€¼ã€‚ ä¸¾ä¸ªæ —å­ï¼Œæ¯”å¦‚ä¹‹å‰çš„åˆæˆäº‹ä»¶ï¼Œç”±äºŽä½ æ˜¯ setTimeout(_ =&gt; { this.setState()}, 0) æ˜¯åœ¨ try ä»£ç å—ä¸­,å½“ä½  try ä»£ç å—æ‰§è¡Œåˆ° setTimeout çš„æ—¶å€™ï¼ŒæŠŠå®ƒä¸¢åˆ°åˆ—é˜Ÿé‡Œï¼Œå¹¶æ²¡æœ‰åŽ»æ‰§è¡Œï¼Œè€Œæ˜¯å…ˆæ‰§è¡Œçš„ finally ä»£ç å—ï¼Œç­‰ finally æ‰§è¡Œå®Œäº†ï¼Œ isBatchingUpdates åˆå˜ä¸ºäº† false ï¼Œå¯¼è‡´æœ€åŽåŽ»æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„ setState æ—¶å€™ï¼Œ requestWork èµ°çš„æ˜¯å’ŒåŽŸç”Ÿäº‹ä»¶ä¸€æ ·çš„ expirationTime === Sync ifåˆ†æ”¯ï¼Œæ‰€ä»¥è¡¨çŽ°å°±ä¼šå’ŒåŽŸç”Ÿäº‹ä»¶ä¸€æ ·ï¼Œå¯ä»¥åŒæ­¥æ‹¿åˆ°æœ€æ–°çš„stateå€¼ã€‚ setStateä¸­çš„æ‰¹é‡æ›´æ–°123456789101112131415161718class App extends Component &#123; state = &#123; val: 0 &#125; batchUpdates = () =&gt; &#123; this.setState(&#123; val: this.state.val + 1 &#125;) this.setState(&#123; val: this.state.val + 1 &#125;) this.setState(&#123; val: this.state.val + 1 &#125;) &#125; render() &#123; return ( &lt;div onClick=&#123;this.batchUpdates&#125;&gt; &#123;`Counter is $&#123;this.state.val&#125;`&#125; // 1 &lt;/div&gt; ) &#125;&#125; ä¸Šé¢çš„ç»“æžœæœ€ç»ˆæ˜¯1ï¼Œåœ¨ setState çš„æ—¶å€™reactå†…éƒ¨ä¼šåˆ›å»ºä¸€ä¸ª updateQueue ï¼Œé€šè¿‡ firstUpdate ã€ lastUpdate ã€ lastUpdate.next åŽ»ç»´æŠ¤ä¸€ä¸ªæ›´æ–°çš„é˜Ÿåˆ—ï¼Œåœ¨æœ€ç»ˆçš„ performWork ä¸­ï¼Œç›¸åŒçš„keyä¼šè¢«è¦†ç›–ï¼Œåªä¼šå¯¹æœ€åŽä¸€æ¬¡çš„ setState è¿›è¡Œæ›´æ–°ï¼Œä¸‹é¢æ˜¯éƒ¨åˆ†å®žçŽ°ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031function createUpdateQueue(baseState) &#123; var queue = &#123; expirationTime: NoWork, baseState: baseState, firstUpdate: null, lastUpdate: null, firstCapturedUpdate: null, lastCapturedUpdate: null, firstEffect: null, lastEffect: null, firstCapturedEffect: null, lastCapturedEffect: null &#125;; return queue;&#125;function appendUpdateToQueue(queue, update, expirationTime) &#123; // Append the update to the end of the list. if (queue.lastUpdate === null) &#123; // Queue is empty queue.firstUpdate = queue.lastUpdate = update; &#125; else &#123; queue.lastUpdate.next = update; queue.lastUpdate = update; &#125; if (queue.expirationTime === NoWork || queue.expirationTime &gt; expirationTime) &#123; // The incoming update has the earliest expiration of any update in the // queue. Update the queue's expiration time. queue.expirationTime = expirationTime; &#125;&#125; çœ‹ä¸ªðŸŒ° 1234567891011121314151617181920212223class App extends React.Component &#123; state = &#123; val: 0 &#125; componentDidMount() &#123; this.setState(&#123; val: this.state.val + 1 &#125;) console.log(this.state.val) this.setState(&#123; val: this.state.val + 1 &#125;) console.log(this.state.val) setTimeout(_ =&gt; &#123; this.setState(&#123; val: this.state.val + 1 &#125;) console.log(this.state.val); this.setState(&#123; val: this.state.val + 1 &#125;) console.log(this.state.val) &#125;, 0) &#125; render() &#123; return &lt;div&gt;&#123;this.state.val&#125;&lt;/div&gt; &#125;&#125; ç»“åˆä¸Šé¢åˆ†æžçš„ï¼Œé’©å­å‡½æ•°ä¸­çš„ setState æ— æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åŽçš„å€¼ï¼Œæ‰€ä»¥å‰ä¸¤æ¬¡éƒ½æ˜¯è¾“å‡º0ï¼Œå½“æ‰§è¡Œåˆ° setTimeout é‡Œçš„æ—¶å€™ï¼Œå‰é¢ä¸¤ä¸ªstateçš„å€¼å·²ç»è¢«æ›´æ–°ï¼Œç”±äºŽ setState æ‰¹é‡æ›´æ–°çš„ç­–ç•¥ï¼Œ this.state.val åªå¯¹æœ€åŽä¸€æ¬¡çš„ç”Ÿæ•ˆï¼Œä¸º1ï¼Œè€Œåœ¨ setTimmout ä¸­ setState æ˜¯å¯ä»¥åŒæ­¥æ‹¿åˆ°æ›´æ–°ç»“æžœï¼Œæ‰€ä»¥ setTimeout ä¸­çš„ä¸¤æ¬¡è¾“å‡º2ï¼Œ3ï¼Œæœ€ç»ˆç»“æžœå°±ä¸º 0, 0, 2, 3 ã€‚ æ€»ç»“ setState åªåœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ˜¯â€œå¼‚æ­¥â€çš„ï¼Œåœ¨åŽŸç”Ÿäº‹ä»¶å’Œ setTimeout ä¸­éƒ½æ˜¯åŒæ­¥çš„ã€‚ setStateçš„â€œå¼‚æ­¥â€å¹¶ä¸æ˜¯è¯´å†…éƒ¨ç”±å¼‚æ­¥ä»£ç å®žçŽ°ï¼Œå…¶å®žæœ¬èº«æ‰§è¡Œçš„è¿‡ç¨‹å’Œä»£ç éƒ½æ˜¯åŒæ­¥çš„ï¼Œåªæ˜¯åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°çš„è°ƒç”¨é¡ºåºåœ¨æ›´æ–°ä¹‹å‰ï¼Œå¯¼è‡´åœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ²¡æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åŽçš„å€¼ï¼Œå½¢å¼äº†æ‰€è°“çš„â€œå¼‚æ­¥â€ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡ç¬¬äºŒä¸ªå‚æ•° setState(partialState, callback) ä¸­çš„callbackæ‹¿åˆ°æ›´æ–°åŽçš„ç»“æžœã€‚ setState çš„æ‰¹é‡æ›´æ–°ä¼˜åŒ–ä¹Ÿæ˜¯å»ºç«‹åœ¨â€œå¼‚æ­¥â€ï¼ˆåˆæˆäº‹ä»¶ã€é’©å­å‡½æ•°ï¼‰ä¹‹ä¸Šçš„ï¼Œåœ¨åŽŸç”Ÿäº‹ä»¶å’ŒsetTimeout ä¸­ä¸ä¼šæ‰¹é‡æ›´æ–°ï¼Œåœ¨â€œå¼‚æ­¥â€ä¸­å¦‚æžœå¯¹åŒä¸€ä¸ªå€¼è¿›è¡Œå¤šæ¬¡ setState ï¼Œ setState çš„æ‰¹é‡æ›´æ–°ç­–ç•¥ä¼šå¯¹å…¶è¿›è¡Œè¦†ç›–ï¼Œå–æœ€åŽä¸€æ¬¡çš„æ‰§è¡Œï¼Œå¦‚æžœæ˜¯åŒæ—¶ setState å¤šä¸ªä¸åŒçš„å€¼ï¼Œåœ¨æ›´æ–°æ—¶ä¼šå¯¹å…¶è¿›è¡Œåˆå¹¶æ‰¹é‡æ›´æ–°ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ajax Fetch Axiosä¹‹é—´çš„è¯¦ç»†åŒºåˆ«ä»¥åŠä¼˜ç¼ºç‚¹]]></title>
    <url>%2F2018%2F07%2F18%2Fstudy%2FAjax-Fetch-Axios%E4%B9%8B%E9%97%B4%E7%9A%84%E8%AF%A6%E7%BB%86%E5%8C%BA%E5%88%AB%E4%BB%A5%E5%8F%8A%E4%BC%98%E7%BC%BA%E7%82%B9%2F</url>
    <content type="text"><![CDATA[å°†jQueryçš„ajaxã€axioså’Œfetchåšä¸ªç®€å•çš„æ¯”è¾ƒï¼Œæ‰€è°“ä»è€…è§ä»æ™ºè€…è§æ™ºï¼Œæœ€ç»ˆä½¿ç”¨å“ªä¸ªè¿˜æ˜¯è‡ªè¡Œæ–Ÿé…Œ jQuery ajax12345678$.ajax(&#123; type: 'POST', url: url, data: data, dataType: dataType, success: function () &#123;&#125;, error: function () &#123;&#125;&#125;) ä¼˜ç¼ºç‚¹ï¼š æœ¬èº«æ˜¯é’ˆå¯¹mvcæ¨¡å¼çš„ç¼–ç¨‹ï¼Œä¸ç¬¦åˆçŽ°åœ¨mvvmçš„æµªæ½® åŸºäºŽåŽŸç”Ÿçš„XHRå¼€å‘ï¼ŒXHRæœ¬èº«çš„æž¶æž„ä¸æ¸…æ™°ï¼Œå·²ç»æœ‰äº†fetchçš„æ›¿ä»£æ–¹æ¡ˆ JQueryæ•´ä¸ªé¡¹ç›®å¤ªå¤§ï¼Œå•çº¯ä½¿ç”¨ajaxå´è¦å¼•å…¥æ•´ä¸ªJQueryéžå¸¸çš„ä¸åˆç†ï¼ˆé‡‡å–ä¸ªæ€§åŒ–æ‰“åŒ…çš„æ–¹æ¡ˆåˆä¸èƒ½äº«å—CDNæœåŠ¡ï¼‰ å°½ç®¡JQueryå¯¹æˆ‘ä»¬å‰ç«¯çš„å¼€å‘å·¥ä½œæ›¾æœ‰ç€ï¼ˆçŽ°åœ¨ä¹Ÿä»ç„¶æœ‰ç€ï¼‰æ·±è¿œçš„å½±å“ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°éšç€VUEï¼ŒREACTæ–°ä¸€ä»£æ¡†æž¶çš„å…´èµ·ï¼Œä»¥åŠESè§„èŒƒçš„å®Œå–„ï¼Œæ›´å¤šAPIçš„æ›´æ–°ï¼ŒJQueryè¿™ç§å¤§è€Œå…¨çš„JSåº“ï¼Œæœªæ¥çš„è·¯ä¼šè¶Šèµ°è¶Šçª„ã€‚ axiosaxiosä¸­æ–‡æ–‡æ¡£ 1234567891011axios(&#123; method: 'POST', url: '' data:&#123; name:'zhang' &#125;&#125;).then(function (response)&#123; console.log(response)&#125;).then(function (error)&#123; console.log(error)&#125;) Vue2.0ä¹‹åŽï¼Œå°¤é›¨æºªæŽ¨èå¤§å®¶ç”¨axiosæ›¿æ¢JQuery ajaxï¼Œæƒ³å¿…è®©Axiosè¿›å…¥äº†å¾ˆå¤šäººçš„ç›®å…‰ä¸­ã€‚Axiosæœ¬è´¨ä¸Šä¹Ÿæ˜¯å¯¹åŽŸç”ŸXHRçš„å°è£…ï¼Œåªä¸è¿‡å®ƒæ˜¯Promiseçš„å®žçŽ°ç‰ˆæœ¬ï¼Œç¬¦åˆæœ€æ–°çš„ESè§„èŒƒï¼Œä»Žå®ƒçš„å®˜ç½‘ä¸Šå¯ä»¥çœ‹åˆ°å®ƒæœ‰ä»¥ä¸‹å‡ æ¡ç‰¹æ€§ï¼š ä¼˜ç¼ºç‚¹ï¼š ä»Ž node.js åˆ›å»º http è¯·æ±‚ æ”¯æŒ Promise API å®¢æˆ·ç«¯æ”¯æŒé˜²æ­¢CSRF æä¾›äº†ä¸€äº›å¹¶å‘è¯·æ±‚çš„æŽ¥å£ï¼ˆé‡è¦ï¼Œæ–¹ä¾¿äº†å¾ˆå¤šçš„æ“ä½œ è¿™ä¸ªæ”¯æŒé˜²æ­¢CSRFå…¶å®žæŒºå¥½çŽ©çš„ï¼Œæ˜¯æ€Žä¹ˆåšåˆ°çš„å‘¢ï¼Œå°±æ˜¯è®©ä½ çš„æ¯ä¸ªè¯·æ±‚éƒ½å¸¦ä¸€ä¸ªä»Žcookieä¸­æ‹¿åˆ°çš„key, æ ¹æ®æµè§ˆå™¨åŒæºç­–ç•¥ï¼Œå‡å†’çš„ç½‘ç«™æ˜¯æ‹¿ä¸åˆ°ä½ cookieä¸­å¾—keyçš„ï¼Œè¿™æ ·ï¼ŒåŽå°å°±å¯ä»¥è½»æ¾è¾¨åˆ«å‡ºè¿™ä¸ªè¯·æ±‚æ˜¯å¦æ˜¯ç”¨æˆ·åœ¨å‡å†’ç½‘ç«™ä¸Šçš„è¯¯å¯¼è¾“å…¥ï¼Œä»Žè€Œé‡‡å–æ­£ç¡®çš„ç­–ç•¥ã€‚ Axiosæ—¢æä¾›äº†å¹¶å‘çš„å°è£…ï¼Œä¹Ÿæ²¡æœ‰ä¸‹æ–‡ä¼šæåˆ°çš„fetchçš„å„ç§é—®é¢˜ï¼Œè€Œä¸”ä½“ç§¯ä¹Ÿè¾ƒå°ï¼Œå½“ä¹‹æ— æ„§çŽ°åœ¨æœ€åº”è¯¥é€‰ç”¨çš„è¯·æ±‚çš„æ–¹å¼ã€‚ fetchfetchå·ç§°æ˜¯AJAXçš„æ›¿ä»£å“ï¼Œå®ƒçš„å¥½å¤„åœ¨ã€Šä¼ ç»Ÿ Ajax å·²æ­»ï¼ŒFetch æ°¸ç”Ÿã€‹ä¸­æåˆ°æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š ç¬¦åˆå…³æ³¨åˆ†ç¦»ï¼Œæ²¡æœ‰å°†è¾“å…¥ã€è¾“å‡ºå’Œç”¨äº‹ä»¶æ¥è·Ÿè¸ªçš„çŠ¶æ€æ··æ‚åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œæ›´å¥½æ›´æ–¹ä¾¿çš„å†™æ³•ï¼Œè¯¸å¦‚ï¼š 1234567try&#123; let response = await fetch(url); let data = response.json(); console.log(data);&#125;catch (e)&#123; console.log("Oops, error", e);&#125; ä¼˜ç¼ºç‚¹ï¼š ç¬¦åˆå…³æ³¨åˆ†ç¦»ï¼Œæ²¡æœ‰å°†è¾“å…¥ã€è¾“å‡ºå’Œç”¨äº‹ä»¶æ¥è·Ÿè¸ªçš„çŠ¶æ€æ··æ‚åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œ æ›´å¥½æ›´æ–¹ä¾¿çš„å†™æ³• æ›´åŠ åº•å±‚ï¼Œæä¾›çš„APIä¸°å¯Œï¼ˆrequest, responseï¼‰ è„±ç¦»äº†XHRï¼Œæ˜¯ESè§„èŒƒé‡Œæ–°çš„å®žçŽ°æ–¹å¼ 1ï¼‰fetchtchåªå¯¹ç½‘ç»œè¯·æ±‚æŠ¥é”™ï¼Œå¯¹400ï¼Œ500éƒ½å½“åšæˆåŠŸçš„è¯·æ±‚ï¼Œéœ€è¦å°è£…åŽ»å¤„ç†2ï¼‰fetché»˜è®¤ä¸ä¼šå¸¦cookieï¼Œéœ€è¦æ·»åŠ é…ç½®é¡¹3ï¼‰fetchä¸æ”¯æŒabortï¼Œä¸æ”¯æŒè¶…æ—¶æŽ§åˆ¶ï¼Œä½¿ç”¨setTimeoutåŠPromise.rejectçš„å®žçŽ°çš„è¶…æ—¶æŽ§åˆ¶å¹¶ä¸èƒ½é˜»æ­¢è¯·æ±‚è¿‡ç¨‹ç»§ç»­åœ¨åŽå°è¿è¡Œï¼Œé€ æˆäº†é‡çš„æµªè´¹4ï¼‰fetchæ²¡æœ‰åŠžæ³•åŽŸç”Ÿç›‘æµ‹è¯·æ±‚çš„è¿›åº¦ï¼Œè€ŒXHRå¯ä»¥ PS: fetchçš„å…·ä½“é—®é¢˜å¤§å®¶å¯ä»¥å‚è€ƒï¼šã€Šfetchæ²¡æœ‰ä½ æƒ³è±¡çš„é‚£ä¹ˆç¾Žã€‹ã€Šfetchä½¿ç”¨çš„å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ³•ã€‹ çœ‹åˆ°è¿™é‡Œï¼Œä½ å¿ƒé‡Œä¸€å®šæœ‰ä¸ªç–‘é—®ï¼Œè¿™é¬¼ä¸œè¥¿å°±æ˜¯ä¸ªåŠæ‹‰å­å·¥ç¨‹å˜›ï¼Œæˆ‘è¿˜æ˜¯å›žåŽ»ç”¨Jqueryæˆ–è€…Axiosç®—äº†â€”â€”å…¶å®žæˆ‘å°±æ˜¯è¿™ä¹ˆæ‰“ç®—çš„ã€‚ä½†æ˜¯ï¼Œå¿…é¡»è¦æå‡ºçš„æ˜¯ï¼Œæˆ‘å‘çŽ°fetchåœ¨å‰ç«¯çš„åº”ç”¨ä¸Šæœ‰ä¸€é¡¹xhræ€Žä¹ˆä¹Ÿæ¯”ä¸ä¸Šçš„èƒ½åŠ›ï¼šè·¨åŸŸçš„å¤„ç†ã€‚ æˆ‘ä»¬éƒ½çŸ¥é“å› ä¸ºåŒæºç­–ç•¥çš„é—®é¢˜ï¼Œæµè§ˆå™¨çš„è¯·æ±‚æ˜¯å¯èƒ½éšä¾¿è·¨åŸŸçš„â€”â€”ä¸€å®šè¦æœ‰è·¨åŸŸå¤´æˆ–è€…å€ŸåŠ©JSONPï¼Œä½†æ˜¯ï¼Œfetchä¸­å¯ä»¥è®¾ç½®modeä¸ºâ€no-corsâ€ï¼ˆä¸è·¨åŸŸï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345fetch('/users.json', &#123; method: 'post', mode: 'no-cors', data: &#123;&#125;&#125;).then(function() &#123; /* handle response */ &#125;); ä¸ºä»€ä¹ˆè¦ç”¨axios axios æ˜¯ä¸€ä¸ªåŸºäºŽPromise ç”¨äºŽæµè§ˆå™¨å’Œ nodejs çš„ HTTP å®¢æˆ·ç«¯ï¼Œå®ƒæœ¬èº«å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š ä»Žæµè§ˆå™¨ä¸­åˆ›å»º XMLHttpRequest ä»Ž node.js å‘å‡º http è¯·æ±‚ æ”¯æŒ Promise API æ‹¦æˆªè¯·æ±‚å’Œå“åº” è½¬æ¢è¯·æ±‚å’Œå“åº”æ•°æ® å–æ¶ˆè¯·æ±‚ è‡ªåŠ¨è½¬æ¢JSONæ•°æ® å®¢æˆ·ç«¯æ”¯æŒé˜²æ­¢CSRF/XSRF]]></content>
      <tags>
        <tag>Ajax</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€šè¿‡ç¤ºä¾‹æ¥å­¦ä¹ ES2016, 2017, 2018çš„æ–°ç‰¹æ€§]]></title>
    <url>%2F2018%2F07%2F17%2FJs%2F%E9%80%9A%E8%BF%87%E7%A4%BA%E4%BE%8B%E6%9D%A5%E5%AD%A6%E4%B9%A0ES2016-2017-2018%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7%2F</url>
    <content type="text"><![CDATA[å‰è¨€æœ¬æ–‡ä¼šè¾…ä»¥æœ‰ç”¨çš„ä¾‹å­æ¥è®²è¿°TC39ä¸­çš„18ä¸ªç‰¹æ€§ï¼Œå®ƒä»¬åˆ†åˆ«åœ¨ES2016, ES2017å’ŒES2018ä¸­åŠ å…¥ã€‚é‰´äºŽæœ¬æ–‡å†…å®¹å¾ˆé•¿ï¼Œæˆ‘ä»¬å°†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†æ¥ä»‹ç»ï¼Œæ­¤ä¸ºç¬¬ä¸€éƒ¨åˆ†ã€‚ ES6Array.prototype.includesincludesæ˜¯ä¸€ä¸ªArrayä¸Šå¾ˆæœ‰ç”¨çš„å‡½æ•°ï¼Œç”¨äºŽå¿«é€ŸæŸ¥æ‰¾æ•°ç»„ä¸­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ ã€‚(åŒ…æ‹¬NaNï¼Œæ‰€ä»¥å’ŒindexOfä¸ä¸€æ ·)ã€‚ æŒ‡æ•°å‡½æ•°çš„ä¸­ç¼€å½¢å¼åŠ /å‡æ³•æˆ‘ä»¬é€šå¸¸éƒ½æ˜¯ç”¨å…¶ä¸­ç¼€å½¢å¼ï¼Œç›´è§‚æ˜“æ‡‚ã€‚åœ¨ECMAScript2016ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨**æ¥æ›¿ä»£Math.powã€‚ ES7Object.values()Object.values()å‡½æ•°å’ŒObject.keys()å¾ˆç›¸ä¼¼ï¼Œå®ƒè¿”å›žä¸€ä¸ªå¯¹è±¡ä¸­è‡ªå·±å±žæ€§çš„æ‰€æœ‰å€¼(é€šè¿‡åŽŸåž‹é“¾ç»§æ‰¿çš„ä¸ç®—)ã€‚ Object.entries()Object.entries()å’ŒObject.keysç›¸å…³ï¼Œä¸è¿‡entries()å‡½æ•°ä¼šå°†keyå’Œvalueä»¥æ•°ç»„çš„å½¢å¼éƒ½è¿”å›žã€‚è¿™æ ·ï¼Œä½¿ç”¨å¾ªçŽ¯æˆ–åˆ™å°†å¯¹è±¡è½¬ä¸ºMapå°±å¾ˆæ–¹ä¾¿äº†ã€‚ å­—ç¬¦ä¸²è¿½åŠ æä¾›äº†ä¸¤ä¸ªå­—ç¬¦ä¸²è¿½åŠ çš„æ–¹æ³•String.prototype.padStartå’ŒString.prototype.padEndï¼Œæ–¹ä¾¿æˆ‘ä»¬å°†ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿½åŠ åˆ°æŸä¸ªå­—ç¬¦ä¸²çš„å¤´å°¾ã€‚ 12345'someString'.padStart(numberOfCharcters [,stringForPadding]);'5'.padStart(10) // ' 5''5'.padStart(10, '=*') //'=*=*=*=*=5''5'.padEnd(10) // '5 ''5'.padEnd(10, '=*') //'5=*=*=*=*=' è¿™ä¸ªå¯¹äºŽæ ¼å¼åŒ–è¾“å‡ºå¾ˆæœ‰ç”¨ï¼ padStartä¾‹å­æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸åŒé•¿åº¦å…ƒç´ çš„æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥å¾€å‰é¢è¿½åŠ 0æ¥ä½¿å¾—ä»–ä»¬æ‰“å°çš„é•¿åº¦éƒ½ä¸º10ã€‚ padEndä¾‹å­ 1234567891011121314const cars = &#123; 'ðŸš™BMW': '10', 'ðŸš˜Tesla': '5', 'ðŸš–Lamborghini': '0'&#125;Object.entries(cars).map(([name, count]) =&gt; &#123; //padEnd appends ' -' until the name becomes 20 characters //padStart prepends '0' until the count becomes 3 characters. console.log(`$&#123;name.padEnd(20, ' -')&#125; Count: $&#123;count.padStart(3, '0')&#125;`)&#125;);//Prints..// ðŸš™BMW - - - - - - - Count: 010// ðŸš˜Tesla - - - - - - Count: 005// ðŸš–Lamborghini - - - Count: 000 ä½¿ç”¨padStartå’ŒpadEndæ¥æ ¼å¼åŒ–Emojiså’Œå…¶ä»–å®½å­—ç¬¦Emojiså’Œå®½å­—ç¬¦ä½¿ç”¨å¤šä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œå› æ­¤å¯èƒ½ä½¿ç”¨padStartå’ŒpadEndçš„ç»“æžœå¹¶éžå¦‚ä½ æ‰€æ„¿ã€‚ æ¯”å¦‚ï¼šæˆ‘ä»¬è¿½åŠ â¤ï¸åˆ°heartå‰é¢ï¼š 12//ä½ ä¼šå‘çŽ°ä¸ä»…æ²¡æœ‰5ä¸ªæ¡ƒå¿ƒï¼Œæœ‰ä¸€ä¸ªæ¡ƒå¿ƒè¿˜å¾ˆå¥‡æ€ªã€‚'heart'.padStart(10, "â¤ï¸"); // prints.. 'â¤ï¸â¤ï¸â¤heart' è¿™æ˜¯å› ä¸ºâ¤ï¸å æœ‰2ä¸ªå­—èŠ‚(â€˜\u2764\uFE0Fâ€™)ï¼Œè€Œheartæœ¬èº«æœ‰5ä¸ªå­—èŠ‚ï¼Œå› æ­¤åªæœ‰5ä¸ªå­—èŠ‚çš„ä½™åœ°ã€‚æ‰€ä»¥åªæ˜¯è¿½åŠ äº†2ä¸ªåŠçš„æ¡ƒå¿ƒã€‚æœ€åŽè¿½åŠ çš„â€™\u2764â€™ä¼šæ˜¾ç¤ºä¸ºå°é»‘æ¡ƒå¿ƒã€‚ Object.getOwnPropertyDescriptorsè¯¥å‡½æ•°è¿”å›žä¸€ä¸ªå¯¹è±¡æ‰€æœ‰çš„å±žæ€§ï¼Œç”šè‡³åŒ…æ‹¬get/setå‡½æ•°ã€‚ES2017åŠ å…¥è¿™ä¸ªå‡½æ•°çš„ä¸»è¦åŠ¨æœºåœ¨äºŽæ–¹ä¾¿å°†ä¸€ä¸ªå¯¹è±¡æ·±åº¦æ‹·è´ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶å¯ä»¥å°†getter/setteræ‹·è´ã€‚å’ŒObject.assignä¸åŒã€‚ Object.assignå°†ä¸€ä¸ªå¯¹è±¡é™¤äº†getter/setterä»¥å¤–çš„éƒ½æ·±åº¦æ‹·è´äº†ã€‚ å°†åŽŸå¯¹è±¡Caræ‹·è´åˆ°ElectricCarï¼Œä½ å°±ä¼šå‘çŽ°Object.getOwnPropertyDescriptorsæ‹·è´äº† getterå’Œsetterï¼Œè€ŒObject.assignæ²¡æœ‰ã€‚ å…è®¸åœ¨å‡½æ•°å‚æ•°æœ€åŽæ·»åŠ é€—å·è¿™æ˜¯ä¸€ä¸ªå¾ˆå°çš„æ”¹åŠ¨ï¼Œæ–¹ä¾¿gitç®—æ³•æ›´åŠ æ–¹ä¾¿åŒºåˆ†ä»£ç èŒè´£ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªè¯¦ç»†çš„ä¾‹å­æ¥ç†è§£ï¼š å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥åœ¨æœ€åŽæ·»åŠ é€—å·ã€‚ Async/Awaitè¿„ä»Šä¸ºæ­¢ï¼Œæˆ‘ä»‹ç»çš„ç‰¹æ€§ä¸­æœ€æœ‰ç”¨çš„å°±å±žè¿™ä¸ªåŠŸèƒ½äº†ã€‚Asyncå‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ‘†è„±â€œå›žè°ƒåœ°ç‹±â€ï¼Œå¹¶ä¸”æ•´ä¸ªä»£ç ä¼šæ›´åŠ ç®€æ´ã€‚ asyncå…³é”®å­—å‘Šè¯‰JavaScriptç¼–è¯‘å™¨å¯¹äºŽæ ‡å®šçš„å‡½æ•°è¦åŒºåˆ«å¯¹å¾…ã€‚å½“ç¼–è¯‘å™¨é‡åˆ°awaitå‡½æ•°çš„æ—¶å€™ä¼šæš‚åœã€‚å®ƒä¼šç­‰åˆ°awaitæ ‡å®šçš„å‡½æ•°è¿”å›žçš„promiseã€‚è¯¥promiseè¦ä¹ˆå¾—åˆ°ç»“æžœã€è¦ä¹ˆrejectã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼ŒgetAmountå‡½æ•°è°ƒç”¨getUserå’ŒgetBankBalanceä¸¤ä¸ªå¼‚æ­¥å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç”¨promiseæ¥å®žçŽ°å®ƒï¼Œä¸è¿‡ç”¨async awaitæ›´åŠ ç®€æ´ã€‚ asyncå‡½æ•°è¿”å›žPromiseå¦‚æžœä½ æƒ³èŽ·å–ä¸€ä¸ªasyncå‡½æ•°çš„ç»“æžœï¼Œä½ éœ€è¦ä½¿ç”¨Promiseçš„thenè¯­æ³•ã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³ç”¨console.logæ¥æ‰“å°doubleAndAddçš„ç»“æžœï¼Œå¯ä»¥ä½¿ç”¨thenè¯­æ³•ï¼Œå°†console.logå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ å¹¶è¡Œå¤„ç†åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ˜¾ç¤ºåœ°è°ƒç”¨äº†awaitä¸¤æ¬¡ï¼Œå› ä¸ºæ¯æ¬¡éƒ½ç­‰å¾…äº†1ç§’é’Ÿï¼Œå› æ­¤æ€»è®¡ä¸¤ç§’é’Ÿã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Promise.allå‡½æ•°æ¥è®©ä»–ä»¬å¹¶è¡Œå¤„ç†ã€‚ async/awaitçš„é”™è¯¯å¤„ç†æœ‰å¾ˆå¤šæ–¹æ³•æ¥å¤„ç†é”™è¯¯ã€‚ æ–¹æ³•1ï¼šåœ¨å‡½æ•°ä¸­ä½¿ç”¨try-catch æ–¹æ³•2ï¼šcatchæ¯ä¸€ä¸ªawaitè¡¨è¾¾å¼ å› ä¸ºæ¯ä¸€ä¸ªawaitè¡¨è¾¾å¼éƒ½ä¼šè¿”å›žPromiseï¼Œä½ å¯ä»¥å¯¹ä¸€ä¸ªè¿›è¡Œcatchæ“ä½œã€‚ æ–¹æ³•3ï¼šcatchæ•´ä¸ªasync-awaitå‡½æ•° åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€Šå›¾è§£HTTPå­¦ä¹ ã€‹ç¬”è®°]]></title>
    <url>%2F2018%2F07%2F13%2FHTTP%2F%E3%80%8A%E5%9B%BE%E8%A7%A3HTTP%E5%AD%A6%E4%B9%A0%E3%80%8B%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[ä»Žä¸€é“é¢˜å¼•å‘çš„æ€è€ƒä»Žè¾“å…¥ç½‘é¡µåˆ°å‘ˆçŽ°ç½‘é¡µé¡µé¢è¿™ä¸€è¿‡ç¨‹ç»åŽ†äº†ä»€ä¹ˆï¼Ÿ HTTPçš„è¯žç”Ÿåœ¨æ·±å…¥äº†è§£HTTPä¹‹å‰ï¼Œå…ˆä»‹ç»HTTPè¯žç”Ÿçš„èƒŒæ™¯ã€‚cernçš„timbernersLee æå‡ºä¸€ç§èƒ½è®©è¿œéš”ä¸¤åœ°çš„ç ”ç©¶è€…ä»¬å…±äº«çŸ¥è¯†ç‚¹çš„è®¾æƒ³ã€‚ ç½‘ç»œåŸºç¡€ TCP/IPé€šå¸¸ä½¿ç”¨çš„ç½‘ç»œï¼ˆåŒ…æ‹¬äº’è”ç½‘ï¼‰æ˜¯åœ¨TCP/IPåè®®æ—çš„åŸºç¡€ä¸Šè¿ä½œçš„ã€‚è€ŒHTTPå±žäºŽå®ƒå†…éƒ¨çš„ä¸€ä¸ªå­é›†ã€‚ TCP/IPåè®®æ—æŒ‰å±‚æ¬¡åˆ†ä¸ºä»¥ä¸‹4å±‚ åº”ç”¨å±‚ åº”ç”¨å±‚å†³å®šäº†å‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡æ—¶é€šä¿¡çš„æ´»åŠ¨ã€‚ TCP/IPåè®®æ—é¢„å­˜äº†å„ç±»é€šç”¨çš„åº”ç”¨æœåŠ¡ï¼Œæ¯”å¦‚ï¼ŒFTP(file transfer protocol,æ–‡ä»¶ä¼ è¾“åè®®)å’ŒDNS(Domain Name system)åŸŸåç³»ç»ŸæœåŠ¡å°±æ˜¯å…¶ä¸­ä¸¤ç±»ã€‚ HTTPåè®®ä¹Ÿå¤„äºŽè¯¥å±‚ã€‚ ä¼ è¾“å±‚ ä¼ è¾“å±‚å¯¹ä¸Šå±‚åº”ç”¨å±‚ï¼Œæä¾›å¤„äºŽç½‘ç»œè¿žæŽ¥ä¸­çš„ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚ åœ¨ä¼ è¾“å±‚ä¸­æœ‰ä¸¤ä¸ªæ€§è´¨ä¸åŒçš„åè®®ï¼šTCPï¼ˆä¼ è¾“æŽ§åˆ¶åè®®ï¼‰å’ŒUDPï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ ç½‘ç»œå±‚ï¼ˆåˆåç½‘ç»œäº’è”å±‚ï¼‰ ç½‘ç»œå±‚ç”¨æ¥å¤„ç†åœ¨ç½‘ç»œä¸ŠæµåŠ¨çš„æ•°æ®åŒ…ã€‚ä¸Žå¯¹æ–¹è®¡ç®—æœºä¹‹é—´é€šè¿‡å¤šå°è®¡ç®—æœºæˆ–ç½‘ç»œè®¾å¤‡è¿›è¡Œä¼ è¾“æ—¶ï¼Œç½‘ç»œå±‚æ‰€èµ·çš„ä½œç”¨å°±æ˜¯åœ¨ä¼—å¤šçš„é€‰é¡¹å†…é€‰æ‹©ä¸€æ¡ä¼ è¾“è·¯çº¿ã€‚ æ•°æ®é“¾è·¯å±‚ï¼ˆåˆåç½‘ç»œæŽ¥å£å±‚ï¼‰ ç”¨æ¥å¤„ç†è¿žæŽ¥ç½‘ç»œçš„ç¡¬ä»¶éƒ¨åˆ†ã€‚åŒ…æ‹¬æŽ§åˆ¶æ“ä½œç³»ç»Ÿï¼Œç¡¬ä»¶çš„è®¾å¤‡é©±åŠ¨ï¼ŒNIC(ç½‘ç»œé€‚é…å™¨ï¼Œå³ç½‘å¡)ï¼ŒåŠå…‰çº¤ç­‰ç‰©ç†å¯è§éƒ¨åˆ†ï¼Œ åˆ©ç”¨TCP/IPåè®®æ—è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œä¼šé€šè¿‡åˆ†å±‚é¡ºåºä¸Žå¯¹æ–¹è¿›è¡Œé€šä¿¡ã€‚å‘é€ç«¯ä»Žåº”ç”¨å±‚å¾€ä¸‹èµ°ï¼ŒæŽ¥æ”¶ç«¯åˆ™å¾€åº”ç”¨å±‚å¾€ä¸‹èµ°ã€‚å‘é€ç«¯æ¯é€šè¿‡ä¸€å±‚åˆ™å¢žåŠ é¦–éƒ¨ï¼ŒæŽ¥æ”¶ç«¯æ¯é€šè¿‡ä¸€å±‚åˆ™åˆ é™¤é¦–éƒ¨ã€‚ TCPä½äºŽä¼ è¾“å±‚ï¼Œæä¾›å¯é çš„å­—èŠ‚æµæœåŠ¡ è´Ÿè´£åŸŸåè§£æžçš„DNSæœåŠ¡DNSå’ŒHTTPåè®®ä»¥ä¸€æ ·ä½äºŽåº”ç”¨çš„åè®®ã€‚å®ƒæä¾›åŸŸååˆ°IPåœ°å€ä¹‹é—´çš„è§£æžæœåŠ¡ URIå’ŒURLä¸ŽURIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰ç›¸æ¯”ï¼Œæˆ‘ä»¬æ›´ç†Ÿæ‚‰URLï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰ã€‚URIç”¨å­—ç¬¦ä¸²æ ‡è¯†æŸä¸€äº’è”ç½‘èµ„æºï¼Œè€ŒURLè¡¨ç¤ºèµ„æºçš„åœ°ç‚¹ã€‚å¯è§URLæ˜¯URIçš„å­é›†ã€‚ ç®€å•çš„HTTPåè®®è¯·æ±‚è®¿é—®æ–‡æœ¬æˆ–å›¾åƒèµ„æºç­‰çš„ä¸€ç«¯ç§°ä¸ºå®¢æˆ·ç«¯ï¼Œè€Œæä¾›èµ„æºå“åº”çš„ä¸€ç«¯ç§°ä¸ºæœåŠ¡ç«¯ è¯·æ±‚æŠ¥æ–‡ç”± è¯·æ±‚æ–¹æ³•ï¼Œè¯·æ±‚URIï¼Œåè®®ç‰ˆæœ¬ï¼Œå¯é€‰è¯·æ±‚é¦–éƒ¨å­—æ®µå’Œå†…å®¹å®žä½“æž„æˆçš„ã€‚ å“åº”æŠ¥æ–‡ç”±åè®®ç‰ˆæœ¬ï¼ŒçŠ¶æ€ç ï¼ˆè¡¨ç¤ºè¯·æ±‚æˆåŠŸæˆ–å¤±è´¥çš„æ•°å­—ä»£ç ï¼‰ï¼Œç”¨ä»¥è§£é‡ŠçŠ¶æ€ç çš„åŽŸå› çŸ­è¯­ï¼Œå¯é€‰çš„å“åº”é¦–éƒ¨å­—æ®µä»¥åŠå®žä½“ä¸»ä½“æž„æˆã€‚ HTTPæ˜¯ä¸ä¿å­˜çŠ¶æ€çš„åè®®ï¼ˆå³æ— çŠ¶æ€åè®®ï¼‰HTTPåè®®è‡ªèº«ä¸å¯¹è¯·æ±‚å’Œå“åº”ä¹‹é—´çš„é€šä¿¡çŠ¶æ€è¿›è¡Œä¿å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨HTTPè¿™ä¸ªçº§åˆ«ï¼Œåè®®å¯¹äºŽå‘é€è¿‡çš„è¯·æ±‚æˆ–å“åº”éƒ½ä¸åšæŒä¹…åŒ–å¤„ç†ã€‚ è¿™æ ·æ˜¯ä¸ºäº†æ›´å¿«åœ°å¤„ç†å¤§é‡äº‹åŠ¡ï¼Œç¡®ä¿åè®®çš„å¯ä¼¸ç¼©æ€§ï¼Œè€Œç‰¹æ„æŠŠHTTPåè®®è®¾è®¡æˆå¦‚æ­¤ç®€å•çš„ã€‚ ä¸ºäº†è§£å†³è¿™ç§æ— çŠ¶æ€çš„é—®é¢˜ï¼ŒäºŽæ˜¯å¼•å…¥äº†cookieæŠ€æœ¯ã€‚æœ‰äº†cookieå†ç”¨HTTPåè®®é€šä¿¡ï¼Œå°±å¯ä»¥ç®¡ç†çŠ¶æ€äº†ã€‚ å‘ŠçŸ¥æœåŠ¡å™¨æ„å›¾çš„HTTPæ–¹æ³• GET èŽ·å–èµ„æº POST ä¼ è¾“å®žä½“ä¸»ä½“ PUT ä¼ è¾“æ–‡ä»¶ HEAD èŽ·å–æŠ¥æ–‡å¤´éƒ¨ DELETE åˆ é™¤æ–‡ä»¶ OPTIONS è¯¢é—®æ”¯æŒçš„æ–¹æ³• TRACE è¿½è¸ªè·¯å¾„ CONNECT è¦æ±‚ç”¨éš§é“åè®®è¿žæŽ¥ä»£ç† å› ä¸ºPUT å’Œ DELETEæ–¹æ³•ä¸€æ ·ä¸å¸¦éªŒè¯æœºåˆ¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥å­˜åœ¨å®‰å…¨æ€§ã€‚ä¸å¸¸ç”¨ æŒä¹…è¿žæŽ¥èŠ‚çœé€šä¿¡é‡HTTPåè®®çš„åˆå§‹ç‰ˆæœ¬ä¸­ï¼Œæ¯è¿›è¡Œä¸€æ¬¡HTTPé€šä¿¡å°±è¦æ–­å¼€ä¸€æ¬¡TCPé“¾æŽ¥ï¼Œå¦‚æžœè¦è¯·æ±‚ä¸€ä¸ªåŒ…å«å¾ˆå¤šå›¾ç‰‡èµ„æºçš„ç½‘ç«™ï¼Œä¼šè¿›è¡Œå¾ˆå¤šæ¬¡TCPçš„è¿žæŽ¥å’Œä¸­æ–­ï¼Œå¢žåŠ é€šä¿¡é‡çš„å¼€é”€ã€‚ ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒHTTP/1.1å’Œä¸€éƒ¨åˆ†HTTP/1.0æƒ³å‡ºäº†æŒä¹…è¿žæŽ¥ï¼ˆä¹Ÿæˆä¸ºHTTP keep-aliveï¼‰ ç®¡é“åŒ–æŒä¹…è¿žæŽ¥ä½¿å¾—å¤šæ•°è¯·æ±‚ä»¥ç®¡é“åŒ–ï¼ˆpipeliningï¼‰æ–¹å¼å‘é€æˆä¸ºå¯èƒ½ã€‚ä»Žå‰å‘é€è¯·æ±‚åŽéœ€è¦ç­‰å¾…å¹¶æ”¶åˆ°å“åº”ã€‚ç®¡é“åŒ–æŠ€æœ¯çš„å‡ºçŽ°è§£å†³äº†ä¸ç”¨ç­‰å¾…å“åº”äº¦å¯ç›´æŽ¥å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚ ç®¡é“åŒ–æŠ€æœ¯è¦æ¯”æŒä¹…è¿žæŽ¥è¿˜è¦å¿«ã€‚ ä½¿ç”¨cookieçš„çŠ¶æ€ç®¡ç†cookieæŠ€æœ¯é€šè¿‡åœ¨è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å†™å…¥cookieä¿¡æ¯æ¥æŽ§åˆ¶å®¢æˆ·ç«¯çš„çŠ¶æ€ã€‚ cookieä¼šæ ¹æ®ä»ŽæœåŠ¡å™¨ç«¯å‘é€çš„å“åº”æŠ¥æ–‡å†…çš„ä¸€ä¸ªå«åšSet-Cookieçš„é¦–éƒ¨å­—æ®µä¿¡æ¯ï¼Œé€šçŸ¥å®¢æˆ·ç«¯ä¿å­˜Cookieã€‚å½“ä¸‹æ¬¡å®¢æˆ·ç«¯åœ¨å¾€è¯¥æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­åŠ å…¥cookieå€¼åŽå‘é€å‡ºåŽ» HTTPæŠ¥æ–‡å†…çš„HTTPä¿¡æ¯HTTPæŠ¥æ–‡å¤§è‡´å¯åˆ†ä¸ºæŠ¥æ–‡é¦–éƒ¨å’ŒæŠ¥æ–‡ä¸»ä½“ä¸¤å—ã€‚ æŠ¥æ–‡ä¸»ä½“å’Œå®žä½“ä¸»ä½“çš„å·®å¼‚ æŠ¥æ–‡ï¼ˆmessageï¼‰æ˜¯HTTPé€šä¿¡çš„åŸºæœ¬å•ä½ã€‚ç”±8ä½ç»„å­—èŠ‚æµç»„æˆï¼Œé€šè¿‡HTTPé€šä¿¡ä¼ è¾“ã€‚ å®žä½“ï¼ˆentityï¼‰ä½œä¸ºè¯·æ±‚æˆ–å“åº”çš„æœ‰æ•ˆè½½è·æ•°æ®è¢«ä¼ è¾“ï¼Œå…¶å†…å®¹ç”±å®žä½“é¦–éƒ¨å’Œå®žä½“ä¸»ä½“ç»„æˆã€‚ é€šå¸¸ï¼ŒæŠ¥æ–‡ä¸»ä½“ç­‰äºŽå®žä½“ä¸»ä½“ï¼Œåªæœ‰å½“ä¼ è¾“è¿‡ç¨‹ä¸­è¿›è¡Œç¼–ç æ“ä½œæ—¶ï¼Œå®žä½“ä¸»ä½“çš„å†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œæ‰å¯¼è‡´å®ƒå’ŒæŠ¥æ–‡ä¸»ä½“äº§ç”Ÿå·®å¼‚ã€‚ åŽ‹ç¼©ä¼ è¾“çš„å†…å®¹ç¼–ç  å¸¸è§çš„å†…å®¹ç¼–ç æœ‰ä»¥ä¸‹å‡ ç§ gzipï¼ˆGNU zipï¼‰ compressï¼ˆUNIXç³»ç»Ÿçš„æ ‡å‡†åŽ‹ç¼©ï¼‰ deflateï¼ˆzlibï¼‰ identityï¼ˆä¸è¿›è¡Œç¼–ç ï¼‰ åˆ†å‰²å‘é€çš„åˆ†å—ä¼ è¾“ç¼–ç  è¿™ç§æŠŠå®žä½“ä¸»ä½“åˆ†å—çš„åŠŸèƒ½ç§°ä¸ºåˆ†å—ä¼ è¾“ç¼–ç  åˆ†å—ä¼ è¾“ç¼–ç ä¼šå°†å®žä½“ä¸»ä½“åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼ˆå—ï¼‰ã€‚æ¯ä¸€å—éƒ½ä¼šç”¨åå…­è¿›åˆ¶æ¥æ ‡è®°å—çš„å¤§å°ï¼Œè€Œå®žä½“ä¸»ä½“çš„æœ€åŽä¸€å—ä¼šä½¿ç”¨â€œ0ï¼ˆCR+LFï¼‰â€æ¥æ ‡è®°ã€‚ å‘é€å¤šç§æ•°æ®çš„å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆ å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆåŒ…å«çš„å¯¹è±¡å¦‚ä¸‹ multipart/form-data åœ¨webè¡¨å•æ–‡ä»¶ä¸Šä¼ æ—¶ä½¿ç”¨ multipart/byteranges çŠ¶æ€ç 206å“åº”æŠ¥æ–‡åŒ…å«äº†å¤šä¸ªèŒƒå›´çš„å†…å®¹æ—¶ä½¿ç”¨ èŽ·å–éƒ¨åˆ†å†…å®¹çš„èŒƒå›´è¯·æ±‚ è¦å®žçŽ°è¯¥åŠŸèƒ½éœ€è¦æŒ‡å®šä¸‹è½½çš„å®žä½“èŒƒå›´ï¼Œåƒè¿™æ ·ï¼ŒæŒ‡å®šèŒƒå›´å‘é€çš„è¯·æ±‚å«åšèŒƒå›´è¯·æ±‚ã€‚ å†…å®¹åå•†è¿”å›žæœ€åˆé€‚çš„å†…å®¹ å†…å®¹åå•†æœºåˆ¶æ˜¯æŒ‡å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å°±å“åº”çš„èµ„æºå†…å®¹è¿›è¡Œäº¤æ¶‰ï¼Œç„¶åŽæä¾›ç»™å®¢æˆ·ç«¯æœ€ä¸ºé€‚åˆçš„èµ„æºã€‚å†…å®¹åå•†ä¼šä»¥å“åº”èµ„æºçš„è¯­è¨€ï¼Œå­—ç¬¦é›†ï¼Œç¼–ç æ–¹å¼ç­‰ä½œä¸ºåˆ¤æ–­çš„åŸºå‡†ã€‚ åŒ…å«åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­çš„æŸäº›é¦–éƒ¨å­—æ®µå°±æ˜¯åˆ¤æ–­çš„åŸºå‡†ã€‚ Accept Accept-Charset Accept-Encoding Accept-Language Content-Language å†…å®¹åå•†æŠ€æœ¯æœ‰ä»¥ä¸‹3ä¸­ç±»åž‹ æœåŠ¡å™¨é©±åŠ¨åå•† å®¢æˆ·ç«¯é©±åŠ¨åå•† é€æ˜Žåå•† è¿”å›žç»“æžœçš„HTTPçŠ¶æ€ç 2XX æˆåŠŸ200 ok è¡¨ç¤ºä»Žå®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åœ¨æœåŠ¡å™¨ç«¯å·²è¢«æ­£å¸¸å¤„ç† 204 No Content è¯·æ±‚å¤„ç†æˆåŠŸï¼Œä½†æ²¡æœ‰èµ„æºå¯è¿”å›ž 206 partial content è¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ è€ŒæœåŠ¡å™¨æˆåŠŸæ‰§è¡Œäº†è¿™éƒ¨åˆ†çš„getè¯·æ±‚ 3XX é‡å®šå‘301 moved permanentlyæ°¸ä¹…æ€§é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²è¢«åˆ†é…äº†æ–°çš„URIï¼Œä»¥åŽåº”ä½¿ç”¨èµ„æºçŽ°åœ¨æ‰€æŒ‡çš„URIã€‚ 302 Foundä¸´æ—¶é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²è¢«åˆ†é…äº†æ–°çš„URIï¼Œå¸Œæœ›ç”¨æˆ·ï¼ˆæœ¬æ¬¡ï¼‰èƒ½ä½¿ç”¨æ–°çš„URIè®¿é—®ã€‚ 303 see otherä¸´æ—¶é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ªURIï¼Œåº”ä½¿ç”¨getæ–¹æ³•å®šå‘èŽ·å–è¯·æ±‚çš„èµ„æºã€‚ 304 Not Modified è¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€é™„å¸¦æ¡ä»¶çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨å…è®¸è¯·æ±‚è®¿é—®èµ„æºã€‚ 307 Temporary Redirectä¸´æ—¶é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç ä¸Ž302 Foundæœ‰ç€ç›¸åŒçš„å«ä¹‰ã€‚ 4XX å®¢æˆ·ç«¯é”™è¯¯400 Bad Requestè¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚æŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚ 401 Unauthorizedè¯¥çŠ¶æ€ç è¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰HTTPè®¤è¯çš„è®¤è¯ä¿¡æ¯ã€‚ 403 Forbiddenè¯¥çŠ¶æ€ç è¡¨æ˜Žå¯¹è¯·æ±‚çš„èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»äº† 404 Not Foundè¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºæ— æ³•å†æœåŠ¡å™¨ä¸Šæ‰¾åˆ° 5XX æœåŠ¡å™¨é”™è¯¯500 Internal Server Error è¯¥çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ã€‚ä¹Ÿå¯èƒ½æ˜¯webåº”ç”¨å­˜åœ¨çš„bugæˆ–æŸäº›ä¸´æ—¶çš„æ•…éšœã€‚ 503 Service Unavailable è¯¥çŠ¶æ€ç è¡¨æ˜ŽæœåŠ¡å™¨æš‚æ—¶å¤„äºŽè¶…è´Ÿè½½æˆ–æ­£åœ¨åœæœºç»´æŠ¤ï¼ŒçŽ°åœ¨æ— æ³•å¤„ç†è¯·æ±‚ã€‚ ä¸ŽHTTPåä½œçš„webæœåŠ¡å™¨HTTP/1.1å…è®¸ä¸€å°HTTPæœåŠ¡å™¨æ­å»ºå¤šä¸ªwebç«™ç‚¹ã€‚å³ä½¿ç‰©ç†å±‚é¢åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä½†åªè¦ä½¿ç”¨è™šæ‹Ÿä¸»æœºçš„åŠŸèƒ½ï¼Œåˆ™å¯ä»¥å‡è±¡å·²å…·æœ‰å¤šå°æœåŠ¡å™¨ã€‚ åœ¨ç›¸åŒçš„IPåœ°å€ä¸‹ï¼Œç”±äºŽè™šæ‹Ÿä¸»æœºå¯ä»¥å¯„å­˜å¤šä¸ªä¸åŒçš„ä¸»æœºåå’ŒåŸŸåçš„webç½‘ç«™ï¼Œå› æ­¤åœ¨å‘é€HTTPè¯·æ±‚æ—¶ï¼Œå¿…é¡»åœ¨hosté¦–éƒ¨å†…å®Œæ•´æŒ‡å®šä¸»æœºåæˆ–åŸŸåçš„URI é€šä¿¡æ•°æ®è½¬å‘ç¨‹åº:ä»£ç†ã€ç½‘å…³ã€éš§é“è¿™äº›åº”ç”¨ç¨‹åºå’ŒæœåŠ¡å™¨å¯ä»¥å°†è¯·æ±‚è½¬å‘ç»™é€šä¿¡çº¿è·¯ä¸Šçš„ä¸‹ä¸€ç«™æœåŠ¡å™¨ï¼Œå¹¶ä¸”èƒ½æŽ¥æ”¶ä»Žé‚£å°æœåŠ¡å™¨å‘é€çš„å“åº”å†è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚ ä»£ç†ä»£ç†æ˜¯ä¸€ç§æœ‰è½¬å‘åŠŸèƒ½çš„åº”ç”¨ç¨‹åºï¼Œä»–æ‰®æ¼”äº†ä½äºŽæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯â€œä¸­é—´äººâ€çš„è§’è‰²ï¼ŒæŽ¥æ”¶æœ‰å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å¹¶è½¬å‘ç»™æœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹ŸæŽ¥å—æœåŠ¡å™¨è¿”å›žçš„å“åº”å¹¶è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚ æ¯ä¸€æ¬¡é€šè¿‡ä»£ç†æœåŠ¡å™¨è½¬å‘ç»™è¯·æ±‚æˆ–å“åº”æ—¶ï¼Œä¹Ÿä¼šå†™å…¥Viaé¦–éƒ¨ä¿¡æ¯ï¼Œç”¨æ¥æ ‡è®°ç»è¿‡çš„ä¸»æœºä¿¡æ¯ã€‚ ä½¿ç”¨ä»£ç†çš„ç†ç”±æœ‰ï¼Œåˆ©ç”¨ç¼“å­˜æŠ€æœ¯å‡å°‘ç½‘ç»œå®½å¸¦çš„æµé‡ï¼Œç»„ç»‡å†…éƒ¨é’ˆå¯¹ç‰¹å®šç½‘ç«™çš„è®¿é—®æŽ§åˆ¶ï¼Œä»¥èŽ·å–è®¿é—®æ—¥å¿—ä¸ºä¸»è¦ç›®çš„ï¼Œç­‰ç­‰ã€‚ ä»£ç†æœ‰å¤šç§ä½¿ç”¨æ–¹æ³•ï¼ŒæŒ‰ä¸¤ç§åŸºå‡†åˆ†ç±»ï¼Œä¸€ç§æ˜¯å¦ä½¿ç”¨ç¼“å­˜æŠ€æœ¯ï¼Œå¦ä¸€ç§æ˜¯å¦ä¼šä¿®æ”¹æŠ¥æ–‡ã€‚ ç½‘å…³ç½‘å…³æ˜¯è½¬å‘å…¶ä»–æœåŠ¡å™¨é€šä¿¡æ•°æ®çš„æœåŠ¡å™¨ï¼ŒæŽ¥æ”¶ä»Žå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚æ—¶ï¼Œå®ƒå°±åƒè‡ªå·±æ‹¥æœ‰èµ„æºçš„æºæœåŠ¡å™¨ä¸€æ ·å¯¹è¯·æ±‚å¤„ç†ã€‚ ç½‘å…³çš„å·¥ä½œæœºåˆ¶å’Œä»£ç†ååˆ†ç›¸ä¼¼ï¼Œè€Œç½‘å…³èƒ½ä½¿é€šä¿¡çº¿è·¯ä¸Šçš„æœåŠ¡å™¨æä¾›éžHTTPåè®®æœåŠ¡ã€‚åˆ©ç”¨ç½‘å…³å¯ä»¥æé«˜é€šä¿¡çš„å®‰å…¨æ€§ï¼Œå› ä¸ºå¯ä»¥åœ¨å®¢æˆ·ç«¯ä¸Žç½‘å…³ä¹‹é—´çš„é€šä¿¡çº¿è·¯ä¸ŠåŠ å¯†ä»¥ç¡®ä¿è¿žæŽ¥çš„å®‰å…¨ã€‚ éš§é“éš§é“æ˜¯åœ¨ç›¸éš”æ·±è¿œçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸¤è€…ä¹‹é—´è¿›è¡Œä¸­è½¬ï¼Œå¹¶ä¿æŒåŒæ–¹é€šä¿¡è¿žæŽ¥çš„åº”ç”¨ç¨‹åºã€‚ éš§é“çš„ç›®çš„æ˜¯ç¡®ä¿å®¢æˆ·ç«¯èƒ½ä¸ŽæœåŠ¡å™¨è¿›è¡Œå®‰å…¨çš„é€šä¿¡ã€‚ ä¿å­˜èµ„æºçš„ç¼“å­˜ç¼“å­˜æ˜¯æŒ‡ä»£ç†æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æœ¬åœ°ç£ç›˜å†…ä¿å­˜çš„èµ„æºå‰¯æœ¬ï¼Œåˆ©ç”¨ç¼“å­˜å¯å‡å°‘å¯¹æºæœåŠ¡å™¨çš„è®¿é—®ï¼Œå› æ­¤ä¹Ÿå°±èŠ‚çœäº†é€šä¿¡æµé‡å’Œé€šä¿¡æ—¶é—´ã€‚ å³ä½¿å­˜åœ¨ç¼“å­˜ï¼Œä¹Ÿä¼šå› ä¸ºå®¢æˆ·ç«¯çš„è¦æ±‚ï¼Œç¼“å­˜çš„æœ‰æ•ˆæœŸç­‰å› ç´ ï¼Œå‘æºæœåŠ¡å™¨ç¡®è®¤èµ„æºçš„æœ‰æ•ˆæ€§ã€‚è‹¥åˆ¤æ–­ç¼“å­˜å¤±è´¥ï¼Œç¼“å­˜æœåŠ¡å™¨å°†ä¼šå†æ¬¡ä»ŽæºæœåŠ¡å™¨ä¸ŠèŽ·å–â€œæ–°â€èµ„æºã€‚ HTTPé¦–éƒ¨HTTPåè®®çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å¿…å®šåŒ…å«HTTPé¦–éƒ¨ HTTPæŠ¥æ–‡é¦–éƒ¨HTTPè¯·æ±‚æŠ¥æ–‡ç”±æ–¹æ³•ï¼ŒURIï¼ŒHTTPç‰ˆæœ¬ï¼ŒHTTPé¦–éƒ¨å­—æ®µç­‰éƒ¨åˆ†æž„æˆ HTTPå“åº”æŠ¥æ–‡ç”±HTTPç‰ˆæœ¬ï¼ŒçŠ¶æ€ç ï¼ˆæ•°å­—å’ŒåŽŸå› çŸ­è¯­ï¼‰HTTPé¦–éƒ¨å­—æ®µç­‰3éƒ¨åˆ†æž„æˆã€‚ HTTPé¦–éƒ¨å­—æ®µHTTPé¦–éƒ¨å­—æ®µæ˜¯ç”±å­—æ®µåå’Œå­—æ®µå€¼æž„æˆçš„ï¼Œä¸­é—´ç”¨å†’å·â€œï¼šâ€åˆ†å‰²ï¼› é¦–éƒ¨å­—æ®µå:å­—æ®µå€¼å¦‚Content-Type: text/html HTTPé¦–éƒ¨å­—æ®µæ ¹æ®å®žé™…ç”¨é€”è¢«åˆ†ä¸ºä»¥ä¸‹4ä¸­ç±»åž‹ã€‚ é€šç”¨é¦–éƒ¨å­—æ®µ è¯·æ±‚é¦–éƒ¨å­—æ®µ å“åº”é¦–éƒ¨å­—æ®µ å®žä½“é¦–éƒ¨å­—æ®µ HTTPé¦–éƒ¨å­—æ®µå°†å®šä¹‰æˆç¼“å­˜ä»£ç†å’Œéžç¼“å­˜ä»£ç†çš„è¡Œä¸ºï¼Œåˆ†ä¸º2ç§ç±»åž‹ ç«¯åˆ°ç«¯é¦–éƒ¨ï¼ˆEnd-to-end Headerï¼‰ é€è·³é¦–éƒ¨ï¼ˆHop-by-hop headerï¼‰ ä¸‹é¢åˆ—ä¸¾äº†HTTP/1.1ä¸­çš„é€è·³é¦–éƒ¨å­—æ®µã€‚é™¤äº†è¿™8ä¸ªé¦–éƒ¨å­—æ®µä¹‹å¤–ï¼Œå…¶ä»–æ‰€æœ‰å­—æ®µéƒ½å±žäºŽç«¯åˆ°ç«¯é¦–éƒ¨å­—æ®µã€‚ Connection Keep-Alive Proxy-Authenticate Proxy-Authorization Trailer TE Transfer-Encoding Upgrade HTTP/1.1é€šç”¨é¦–éƒ¨å­—æ®µcache-controlé€šè¿‡æŒ‡å®šé¦–éƒ¨å­—æ®µcache-controlçš„æŒ‡ä»¤ï¼Œå°±èƒ½æ“ä½œç¼“å­˜çš„å·¥ä½œæœºåˆ¶ connectionconnectioné¦–éƒ¨å­—æ®µå…·æœ‰å¦‚ä¸‹ä¸¤ä¸ªä½œç”¨ æŽ§åˆ¶ä¸å†è½¬å‘ç»™ä»£ç†çš„é¦–éƒ¨å­—æ®µ ç®¡ç†æŒä¹…è¿žæŽ¥ Dateé¦–éƒ¨å­—æ®µDateè¡¨æ˜Žåˆ›å»ºHTTPæŠ¥æ–‡çš„æ—¥æœŸå’Œæ—¶é—´ Pragmapragmaæ˜¯HTTP/1.1ä¹‹å‰çš„ç‰ˆæœ¬åŽ†å²é—ç•™å­—æ®µï¼Œä»…ä½œä¸ºä¸ŽHTTP/1.0çš„å‘åŽå…¼å®¹è€Œå®šä¹‰ Tralieré¦–éƒ¨å­—æ®µä¼šäº‹å…ˆè¯´æ˜Žåœ¨æŠ¥æ–‡ä¸»ä½“åŽè®°å½•äº†å“ªäº›é¦–éƒ¨å­—æ®µã€‚ Transfer-Encodingè§„å®šäº†ä¼ è¾“æŠ¥æ–‡ä¸»ä½“é‡‡ç”¨çš„ç¼–ç æ–¹å¼ Upgradeç”¨äºŽæ£€æµ‹HTTPåè®®åŠå…¶ä»–åè®®æ˜¯å¦å¯ä½¿ç”¨æ›´é«˜çš„ç‰ˆæœ¬è¿›è¡Œé€šä¿¡ï¼Œå…¶å‚æ•°å€¼å¯ä»¥ç”¨æ¥æŒ‡å®šä¸€ä¸ªå®Œå…¨ä¸åŒçš„é€šä¿¡åè®® Viaä¸ºäº†è¿½è¸ªå®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¹‹é—´çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡çš„ä¼ è¾“è·¯å¾„ Waringé€šå¸¸ä¼šå‘ŠçŸ¥ç”¨æˆ·ä¸€äº›ä¸Žç¼“å­˜ç›¸å…³çš„é—®é¢˜çš„è­¦å‘Š ç¡®ä¿Webå®‰å…¨çš„HTTPSåœ¨HTTPåè®®ä¸­æœ‰å¯èƒ½å­˜åœ¨ä¿¡æ¯çªƒå¬æˆ–èº«ä»½ä¼ªè£…ç­‰å®‰å…¨é—®é¢˜ï¼Œä½¿ç”¨HTTPSé€šä¿¡æœºåˆ¶å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¿™äº›é—®é¢˜ã€‚ HTTPçš„ç¼ºç‚¹HTTPä¸»è¦ç”±ä»¥ä¸‹ä¸è¶³ï¼š é€šä¿¡é£Ÿç”¨æ˜Žæ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½è¢«çªƒå¬ ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡ä¼ªè£… æ— æ³•è¯æ˜ŽæŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥æœ‰å¯èƒ½å·²é­ç¯¡æ”¹ è¿™äº›é—®é¢˜ä¸ä»…åœ¨HTTPä¸Šå‡ºçŽ°ï¼Œå…¶ä»–æœªåŠ å¯†çš„åè®®ä¸­ä¹Ÿä¼šå­˜åœ¨è¿™ç±»é—®é¢˜ã€‚ é€šè¿‡å’ŒSSLï¼ˆsecure socket layer å®‰å…¨å¥—æŽ¥å±‚ï¼‰æˆ–TSLï¼ˆå®‰å…¨å±‚ä¼ è¾“åè®®ï¼‰çš„ç»„åˆä½¿ç”¨åŠ å¯†HTTPçš„é€šä¿¡å†…å®¹ã€‚ HTTP+åŠ å¯†+è®¤è¯+å®Œæ•´æ€§ä¿æŠ¤ = HTTPSæˆ‘ä»¬æŠŠæ·»åŠ äº†åŠ å¯†æ–¹å¼åŠè®¤è¯æœºåˆ¶çš„HTTPç§°ä¸ºHTTPSï¼ˆHTTP Secureï¼‰ HTTPSæ˜¯èº«æŠ«SSLå¤–å£³çš„HTTPSSLé‡‡ç”¨ä¸€ç§ä½³ä½œå…¬å¼€å¯†é’¥åŠ å¯†ï¼ˆpublic-key cryptographyï¼‰çš„åŠ å¯†å¤„ç†æ–¹å¼ è¿™ç§åŠ å¯†æ–¹æ³•ä¸­åŠ å¯†ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œè€Œå¯†é’¥å´æ˜¯ä¿å¯†çš„ã€‚ HTTPSé‡‡ç”¨æ··åˆåŠ å¯†æœºåˆ¶HTTPSé‡‡ç”¨å…±äº«å¯†é’¥åŠ å¯†å’Œå…¬å¼€å¯†é’¥åŠ å¯†ä¸¤è€…å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚ è¯æ˜Žå…¬å¼€å¯†é’¥æ­£ç¡®æ€§çš„è¯ä¹¦ HTTPSçš„å®‰å…¨é€šä¿¡æœºåˆ¶ ä¸ºä»€ä¹ˆä¸ä¸€ç›´ä½¿ç”¨HTTPS åŽŸå› æœ‰ï¼Œå› ä¸ºä¸Žçº¯æ–‡æœ¬é€šä¿¡ç›¸æ¯”ï¼ŒåŠ å¯†é€šä¿¡ä¼šæ¶ˆè€—æ›´å¤šçš„CPUåŠå†…å­˜èµ„æºã€‚å› æ­¤ï¼Œå¦‚æžœæ˜¯éžæ•æ„Ÿä¿¡æ¯åˆ™ä½¿ç”¨HTTPé€šä¿¡ã€‚åªæœ‰åœ¨åŒ…å«ä¸ªäººä¿¡æ¯ç­‰æ•æ„Ÿæ•°æ®æ—¶ï¼Œæ‰ä¼šåˆ©ç”¨HTTPSåŠ å¯†é€šä¿¡ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œæƒ³è¦èŠ‚çº¦è´­ä¹°è¯ä¹¦çš„å¼€é”€ä¹Ÿæ˜¯åŽŸå› ä¹‹ä¸€ã€‚ ç¡®å®šè®¿é—®ç”¨æˆ·èº«ä»½çš„è®¤è¯ä¸ºäº†è®¤è¯ä½¿ç”¨è€…çš„ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯æŒ‡ä»¥ä¸‹è¿™äº›ï¼š å¯†ç ï¼ˆåªæœ‰æœ¬äººæ‰ä¼šçŸ¥é“çš„å­—ç¬¦ä¸²ä¿¡æ¯ï¼‰ åŠ¨æ€ä»¤ç‰Œï¼šä»…é™æœ¬äººæŒæœ‰çš„è®¾å¤‡å†…æ˜¾ç¤ºä¸€æ¬¡æ€§å¯†ç  æ•°å­—è¯ä¹¦ï¼šä»…é™æœ¬äººï¼ˆç»ˆç«¯ï¼‰æŒæœ‰çš„ä¿¡æ¯ ç”Ÿç‰©è®¤è¯ï¼šæŒ‡çº¹å’Œè™¹è†œç­‰æœ¬äººçš„ç”Ÿç†ä¿¡æ¯ ICå¡ç­‰ï¼šä»…é™æœ¬äººæŒæœ‰çš„ä¿¡æ¯ HTTPä½¿ç”¨çš„è®¤è¯æ–¹å¼ HTTP/1.1ä½¿ç”¨çš„è®¤è¯æ–¹å¼å¦‚ä¸‹ BASICè®¤è¯ï¼ˆåŸºæœ¬è®¤è¯ï¼‰ DIGESTè®¤è¯ï¼ˆæ‘˜è¦è®¤è¯ï¼‰ SSLå®¢æˆ·ç«¯è®¤è¯ FormBaseè®¤è¯ï¼ˆåŸºäºŽè¡¨å•è®¤è¯ï¼‰ ä¸ºå‡è½»è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰é€ æˆçš„æŸå¤±ï¼Œå»ºè®®äº‹å…ˆåœ¨Cookieå†…åŠ ä¸Šhttponlyå±žæ€§ åŸºäºŽHTTPçš„åŠŸèƒ½è¿½åŠ åè®®æ¶ˆé™¤HTTPç“¶é¢ˆçš„SPDYè‹¥æƒ³åœ¨çŽ°æœ‰çš„Webå®žçŽ°æ‰€éœ€çš„åŠŸèƒ½ï¼Œä»¥ä¸‹è¿™äº›HTTPæ ‡å‡†å°±ä¼šæˆä¸ºç“¶é¢ˆ ä¸€æ¡è¿žæŽ¥ä¸Šåªèƒ½å‘é€ä¸€æ¡è¯·æ±‚ è¯·æ±‚åªèƒ½ä»Žå®¢æˆ·ç«¯å¼€å§‹ã€‚å®¢æˆ·ç«¯ä¸å¯ä»¥æŽ¥æ”¶é™¤å“åº”ä»¥å¤–çš„æŒ‡ä»¤ã€‚ è¯·æ±‚/å“åº”é¦–éƒ¨æœªç»åŽ‹ç¼©å°±å‘é€ã€‚é¦–éƒ¨ä¿¡æ¯è¶Šå¤šå»¶è¿Ÿè¶Šå¤§ å‘é€å†—é•¿çš„é¦–éƒ¨ã€‚æ¯æ¬¡äº’ç›¸å‘é€ç›¸åŒçš„é¦–éƒ¨é€ æˆçš„æµªè´¹è¾ƒå¤š å¯çƒ­è®®é€‰æ‹©æ•°æ®åŽ‹ç¼©æ ¼å¼ã€‚éžå¼ºåˆ¶åŽ‹ç¼©å‘é€ã€‚ Ajaxçš„è§£å†³æ–¹æ³• Ajaxæ˜¯ä¸€ç§javascriptå’ŒDOMçš„æ“ä½œï¼Œä»¥è¾¾åˆ°å±€éƒ¨webé¡µé¢æ›¿æ¢åŠ è½½çš„å¼‚æ­¥é€šä¿¡æ‰‹æ®µã€‚è€Œåˆ©ç”¨Ajaxå®žæ—¶åœ°ä»ŽæœåŠ¡å™¨èŽ·å–å†…å®¹ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´å¤§é‡è¯·æ±‚äº§ç”Ÿã€‚ Cometçš„è§£å†³æ–¹æ³• ä¸€æ—¦æœåŠ¡å™¨ç«¯æœ‰å†…å®¹æ›´æ–°äº†ï¼Œcometä¸ä¼šè®©è¯·æ±‚ç­‰å¾…ï¼Œè€Œæ˜¯ç›´æŽ¥ç»™å®¢æˆ·ç«¯è¿”å›žå“åº”ã€‚è¿™æ˜¯ä¸€ç§é€šè¿‡å»¶è¿Ÿåº”ç­”ï¼Œæ¨¡æ‹Ÿå®žçŽ°æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯æŽ¨é€ï¼ˆServer Pushï¼‰çš„åŠŸèƒ½ã€‚ å†…å®¹ä¸Šè™½ç„¶å¯ä»¥åšåˆ°å®žæ—¶æ›´æ–°ï¼Œä½†ä¸ºäº†ä¿ç•™å“åº”ï¼Œä¸€æ¬¡è¿žæŽ¥çš„æŒç»­æ—¶é—´ä¹Ÿå˜é•¿äº†ã€‚æœŸé—´ï¼Œä¸ºäº†ç»´æŒè¿žæŽ¥ä¼šæ¶ˆè€—æ›´å¤šçš„èµ„æºã€‚ SPDYçš„è®¾è®¡ä¸ŽåŠŸèƒ½ SPDYä»¥ä¼šè¯å±‚çš„å½¢å¼åŠ å…¥ï¼ŒæŽ§åˆ¶å¯¹æ•°æ®çš„æµåŠ¨ï¼Œä½†è¿˜æ˜¯é‡‡ç”¨HTTPå»ºç«‹é€šä¿¡è¿žæŽ¥ã€‚ ä½¿ç”¨SPDYåŽï¼ŒHTTPåè®®é¢å¤–èŽ·å¾—ä»¥ä¸‹åŠŸèƒ½ï¼š å¤šè·¯å¤ç”¨æµ é€šè¿‡å•ä¸€çš„TCPè¿žæŽ¥ï¼Œå¯ä»¥æ— é™åˆ¶å¤„ç†å¤šä¸ªHTTPè¯·æ±‚ã€‚ èµ‹äºˆè¯·æ±‚ä¼˜å…ˆçº§ åŽ‹ç¼©HTTPé¦–éƒ¨ æŽ¨é€åŠŸèƒ½ æœåŠ¡å™¨æç¤ºåŠŸèƒ½ ä½¿ç”¨æµè§ˆå™¨è¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„WebSocketä¸€æ—¦webæœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯ä¹‹é—´å»ºç«‹websocketåè®®çš„é€šä¿¡è¿žæŽ¥ï¼Œä¹‹åŽæ‰€æœ‰çš„é€šä¿¡éƒ½ä¾é è¿™ä¸ªä¸“ç”¨åè®®è¿›è¡Œã€‚é€šä¿¡è¿‡ç¨‹ä¸­å¯äº’ç›¸å‘é€JSONï¼ŒXMLï¼ŒHTMLæˆ–å›¾ç‰‡ç­‰ä»»æ„æ ¼å¼çš„æ•°æ® WebSocketåè®®çš„ç‰¹ç‚¹ æŽ¨é€åŠŸèƒ½ å‡å°‘é€šä¿¡é‡ ä¸ºäº†å®žçŽ°Websocketï¼Œåœ¨HTTPè¿žæŽ¥å»ºç«‹ä¹‹åŽï¼Œéœ€è¦å®Œæˆä¸€æ¬¡â€œæ¡æ‰‹â€çš„æ­¥éª¤ æœŸç›¼å·²ä¹…çš„HTTP/2.0HTTP/2.0çš„ç‰¹ç‚¹ SPDY HTTP Speed + Mobility Network-Friendly HTTP Upgrade HTTP/2.0 çš„7é¡¹æŠ€æœ¯åŠè®¨è®º åŽ‹ç¼© å¤šè·¯å¤ç”¨ TSLä¹‰åŠ¡åŒ– åå•† å®¢æˆ·ç«¯æ‹‰æ‹½/æœåŠ¡å™¨æŽ¨é€ æµé‡æŽ§åˆ¶ websocket WebæœåŠ¡å™¨ç®¡ç†æ–‡ä»¶çš„WebDAVWebDAVï¼ˆåŸºäºŽä¸‡ç»´ç½‘çš„åˆ†å¸ƒå¼åˆ›ä½œå’Œç‰ˆæœ¬æŽ§åˆ¶ï¼‰ æ˜¯ä¸€ä¸ªå¯å¯¹WebæœåŠ¡å™¨ä¸Šçš„å†…å®¹ç›´æŽ¥è¿›è¡Œæ–‡ä»¶å¤åˆ¶ï¼Œç¼–è¾‘ç­‰æ“ä½œçš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚ é™¤äº†åˆ›å»ºã€åˆ é™¤ç­‰åŸºæœ¬åŠŸèƒ½å¤–ï¼Œä»–è¿˜å…·å¤‡æ–‡ä»¶åˆ›å»ºè€…ç®¡ç†ï¼Œæ–‡ä»¶ç¼–è¾‘è¿‡ç¨‹ä¸­ç¦æ­¢å…¶ä»–ç”¨æˆ·å†…å®¹è¦†ç›–çš„åŠ é”åŠŸèƒ½ï¼Œä»¥åŠå¯¹æ–‡ä»¶å†…å®¹ä¿®æ”¹çš„ç‰ˆæœ¬æŽ§åˆ¶åŠŸèƒ½ã€‚ æž„å»ºWebå†…å®¹çš„æŠ€æœ¯HTMLCSSJAVASCRIPT ä¸ŽWebæœåŠ¡å™¨åŠç¨‹åºåä½œçš„CGI CGIï¼ˆé€šç”¨ç½‘å…³æŽ¥å£ï¼‰æ˜¯æŒ‡WebæœåŠ¡å™¨åœ¨æŽ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚åŽè½¬å‘ç»™ç¨‹åºçš„ä¸€ç»„æœºåˆ¶ã€‚åœ¨CGIçš„ä½œç”¨ä¸‹ï¼Œç¨‹åºä¼šå¯¹è¯·æ±‚å†…å®¹åšå‡ºç›¸åº”çš„åŠ¨ä½œã€‚ é’ˆå¯¹webçš„æ”»å‡»æŠ€æœ¯å¯¹Webåº”ç”¨çš„æ”»å‡»æ¨¡å¼æœ‰ä»¥ä¸‹ä¸¤ç§ ä¸»åŠ¨æ”»å‡» å…·æœ‰ä»£è¡¨æ€§çš„æ”»å‡»æ˜¯SQLæ³¨å…¥æ”»å‡»å’ŒOSå‘½ä»¤æ³¨å…¥æ”»å‡» è¢«åŠ¨æ”»å‡» å…·æœ‰ä»£è¡¨æ€§çš„æ”»å‡»æ˜¯è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œè·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ (CORS) å®žæ–½webåº”ç”¨çš„å®‰å…¨å¯¹ç­–å¯å¤§è‡´åˆ†ä¸ºä»¥ä¸‹ä¸¤éƒ¨åˆ†ã€‚ å®¢æˆ·ç«¯çš„éªŒè¯ webåº”ç”¨ç«¯ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰çš„éªŒè¯ è¾“å…¥å€¼éªŒè¯ è¾“å‡ºå€¼è½¬ä¹‰]]></content>
      <categories>
        <category>HTTP</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»Žè¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ]]></title>
    <url>%2F2018%2F07%2F10%2FHTTP%2F%E4%BB%8E%E8%BE%93%E5%85%A5url%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%E5%88%B0%E5%BA%95%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%2F</url>
    <content type="text"><![CDATA[å‰è¨€åˆšå¼€å§‹å†™è¿™ç¯‡æ–‡ç« è¿˜æ˜¯æŒºçº ç»“çš„ï¼Œå› ä¸ºç½‘ä¸Šæœç´¢â€œä»Žè¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆâ€ï¼Œä½ å¯ä»¥æœåˆ°ä¸€å¤§å †çš„èµ„æ–™ã€‚è€Œä¸”é¢è¯•è¿™é“é¢˜åŸºæœ¬æ˜¯å¿…è€ƒé¢˜ï¼ŒäºŒæœˆä»½é¢è¯•çš„æ—¶å€™ï¼Œè™½ç„¶çŸ¥é“è¿™ä¸ªè¿‡ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä¸è¿‡å½“é¢è¯•å®˜ä¸€æ­¥æ­¥è¿½é—®ä¸‹åŽ»çš„ï¼Œå¾ˆå¤šç»†èŠ‚å°±ä¸å¤ªæ¸…æ¥šäº†ã€‚ æœ€è¿‘åˆšå¥½ä¹Ÿåœ¨çœ‹httpåè®®ç›¸å…³çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æƒ³å¯¹è¿™ä¸ªè¯é¢˜æ¥ä¸ªæ·±å…¥çš„æ€»ç»“ï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯ é€šè¿‡è¾“å…¥urlä¹‹åŽå‘ç”Ÿçš„äº‹æƒ…æ¥åšçŸ¥è¯†çš„æ€»ç»“å’Œæ‰©å±•ã€‚æ‰€ä»¥æ–‡ç« å¯èƒ½ä¼šå¾ˆæ‚ã€‚ æ€»çš„è¿‡ç¨‹å¤§æ¦‚å¦‚ä¸‹: è¾“å…¥åœ°å€å½“æˆ‘ä»¬å¼€å§‹åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ç½‘å€çš„æ—¶å€™ï¼Œæµè§ˆå™¨å…¶å®žå°±å·²ç»åœ¨æ™ºèƒ½çš„åŒ¹é…å¯èƒ½å¾— url äº†ï¼Œä»–ä¼šä»ŽåŽ†å²è®°å½•ï¼Œä¹¦ç­¾ç­‰åœ°æ–¹ï¼Œæ‰¾åˆ°å·²ç»è¾“å…¥çš„å­—ç¬¦ä¸²å¯èƒ½å¯¹åº”çš„ urlï¼Œç„¶åŽç»™å‡ºæ™ºèƒ½æç¤ºï¼Œè®©ä½ å¯ä»¥è¡¥å…¨urlåœ°å€ã€‚å¯¹äºŽ googleçš„chrome çš„æµè§ˆå™¨ï¼Œä»–ç”šè‡³ä¼šç›´æŽ¥ä»Žç¼“å­˜ä¸­æŠŠç½‘é¡µå±•ç¤ºå‡ºæ¥ï¼Œå°±æ˜¯è¯´ï¼Œä½ è¿˜æ²¡æœ‰æŒ‰ä¸‹ enterï¼Œé¡µé¢å°±å‡ºæ¥äº†ã€‚ æµè§ˆå™¨æŸ¥æ‰¾åŸŸåçš„ipåœ°å€ 1ã€è¯·æ±‚ä¸€æ—¦å‘èµ·ï¼Œæµè§ˆå™¨é¦–å…ˆè¦åšçš„äº‹æƒ…å°±æ˜¯è§£æžè¿™ä¸ªåŸŸåï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæµè§ˆå™¨ä¼šé¦–å…ˆæŸ¥çœ‹æœ¬åœ°ç¡¬ç›˜çš„ hosts æ–‡ä»¶ï¼Œçœ‹çœ‹å…¶ä¸­æœ‰æ²¡æœ‰å’Œè¿™ä¸ªåŸŸåå¯¹åº”çš„è§„åˆ™ï¼Œå¦‚æžœæœ‰çš„è¯å°±ç›´æŽ¥ä½¿ç”¨ hosts æ–‡ä»¶é‡Œé¢çš„ ip åœ°å€ã€‚ 2ã€å¦‚æžœåœ¨æœ¬åœ°çš„ hosts æ–‡ä»¶æ²¡æœ‰èƒ½å¤Ÿæ‰¾åˆ°å¯¹åº”çš„ ip åœ°å€ï¼Œæµè§ˆå™¨ä¼šå‘å‡ºä¸€ä¸ª DNSè¯·æ±‚åˆ°æœ¬åœ°DNSæœåŠ¡å™¨ ã€‚æœ¬åœ°DNSæœåŠ¡å™¨ä¸€èˆ¬éƒ½æ˜¯ä½ çš„ç½‘ç»œæŽ¥å…¥æœåŠ¡å™¨å•†æä¾›ï¼Œæ¯”å¦‚ä¸­å›½ç”µä¿¡ï¼Œä¸­å›½ç§»åŠ¨ã€‚ 3ã€æŸ¥è¯¢ä½ è¾“å…¥çš„ç½‘å€çš„DNSè¯·æ±‚åˆ°è¾¾æœ¬åœ°DNSæœåŠ¡å™¨ä¹‹åŽï¼Œæœ¬åœ°DNSæœåŠ¡å™¨ä¼šé¦–å…ˆæŸ¥è¯¢å®ƒçš„ç¼“å­˜è®°å½•ï¼Œå¦‚æžœç¼“å­˜ä¸­æœ‰æ­¤æ¡è®°å½•ï¼Œå°±å¯ä»¥ç›´æŽ¥è¿”å›žç»“æžœï¼Œæ­¤è¿‡ç¨‹æ˜¯é€’å½’çš„æ–¹å¼è¿›è¡ŒæŸ¥è¯¢ã€‚å¦‚æžœæ²¡æœ‰ï¼Œæœ¬åœ°DNSæœåŠ¡å™¨è¿˜è¦å‘DNSæ ¹æœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ã€‚ 4ã€æ ¹DNSæœåŠ¡å™¨æ²¡æœ‰è®°å½•å…·ä½“çš„åŸŸåå’ŒIPåœ°å€çš„å¯¹åº”å…³ç³»ï¼Œè€Œæ˜¯å‘Šè¯‰æœ¬åœ°DNSæœåŠ¡å™¨ï¼Œä½ å¯ä»¥åˆ°åŸŸæœåŠ¡å™¨ä¸ŠåŽ»ç»§ç»­æŸ¥è¯¢ï¼Œå¹¶ç»™å‡ºåŸŸæœåŠ¡å™¨çš„åœ°å€ã€‚è¿™ç§è¿‡ç¨‹æ˜¯è¿­ä»£çš„è¿‡ç¨‹ã€‚ 5ã€æœ¬åœ°DNSæœåŠ¡å™¨ç»§ç»­å‘åŸŸæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¯·æ±‚çš„å¯¹è±¡æ˜¯.comåŸŸæœåŠ¡å™¨ã€‚.comåŸŸæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ä¹‹åŽï¼Œä¹Ÿä¸ä¼šç›´æŽ¥è¿”å›žåŸŸåå’ŒIPåœ°å€çš„å¯¹åº”å…³ç³»ï¼Œè€Œæ˜¯å‘Šè¯‰æœ¬åœ°DNSæœåŠ¡å™¨ï¼Œä½ çš„åŸŸåçš„è§£æžæœåŠ¡å™¨çš„åœ°å€ã€‚ 6ã€æœ€åŽï¼Œæœ¬åœ°DNSæœåŠ¡å™¨å‘åŸŸåçš„è§£æžæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œè¿™æ—¶å°±èƒ½æ”¶åˆ°ä¸€ä¸ªåŸŸåå’ŒIPåœ°å€å¯¹åº”å…³ç³»ï¼Œæœ¬åœ°DNSæœåŠ¡å™¨ä¸ä»…è¦æŠŠIPåœ°å€è¿”å›žç»™ç”¨æˆ·ç”µè„‘ï¼Œè¿˜è¦æŠŠè¿™ä¸ªå¯¹åº”å…³ç³»ä¿å­˜åœ¨ç¼“å­˜ä¸­ï¼Œä»¥å¤‡ä¸‹æ¬¡åˆ«çš„ç”¨æˆ·æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥ç›´æŽ¥è¿”å›žç»“æžœï¼ŒåŠ å¿«ç½‘ç»œè®¿é—®ã€‚ ä¸‹é¢ä¸€å›¾å®Œç¾Žè§£é‡Šäº†ä¸Šé¢æ‰€è¿° çŸ¥è¯†æ‰©å±•ï¼šä»€ä¹ˆæ˜¯DNSDNSï¼ˆDomain Name Systemï¼ŒåŸŸåç³»ç»Ÿï¼‰ï¼Œå› ç‰¹ç½‘ä¸Šä½œä¸ºåŸŸåå’ŒIPåœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œèƒ½å¤Ÿä½¿ç”¨æˆ·æ›´æ–¹ä¾¿çš„è®¿é—®äº’è”ç½‘ï¼Œè€Œä¸ç”¨åŽ»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æŽ¥è¯»å–çš„IPæ•°ä¸²ã€‚é€šè¿‡ä¸»æœºåï¼Œæœ€ç»ˆå¾—åˆ°è¯¥ä¸»æœºåå¯¹åº”çš„IPåœ°å€çš„è¿‡ç¨‹å«åšåŸŸåè§£æžï¼ˆæˆ–ä¸»æœºåè§£æžï¼‰ã€‚ é€šä¿—çš„è®²ï¼Œæˆ‘ä»¬æ›´ä¹ æƒ¯äºŽè®°ä½ä¸€ä¸ªç½‘ç«™çš„åå­—ï¼Œæ¯”å¦‚www.baidu.com,è€Œä¸æ˜¯è®°ä½å®ƒçš„ipåœ°å€ï¼Œæ¯”å¦‚ï¼š167.23.10.2ã€‚è€Œè®¡ç®—æœºæ›´æ“…é•¿è®°ä½ç½‘ç«™çš„ipåœ°å€ï¼Œè€Œä¸æ˜¯åƒwww.baidu.comç­‰é“¾æŽ¥ã€‚å› ä¸ºï¼ŒDNSå°±ç›¸å½“äºŽä¸€ä¸ªç”µè¯æœ¬ï¼Œæ¯”å¦‚ä½ è¦æ‰¾www.baidu.comè¿™ä¸ªåŸŸåï¼Œé‚£æˆ‘ç¿»ä¸€ç¿»æˆ‘çš„ç”µè¯æœ¬ï¼Œæˆ‘å°±çŸ¥é“ï¼Œå“¦ï¼Œå®ƒçš„ç”µè¯ï¼ˆipï¼‰æ˜¯167.23.10.2ã€‚ DNSæŸ¥è¯¢çš„ä¸¤ç§æ–¹å¼ï¼šé€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢1ã€é€’å½’è§£æž å½“å±€éƒ¨DNSæœåŠ¡å™¨è‡ªå·±ä¸èƒ½å›žç­”å®¢æˆ·æœºçš„DNSæŸ¥è¯¢æ—¶ï¼Œå®ƒå°±éœ€è¦å‘å…¶ä»–DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ã€‚æ­¤æ—¶æœ‰ä¸¤ç§æ–¹å¼ï¼Œå¦‚å›¾æ‰€ç¤ºçš„æ˜¯é€’å½’æ–¹å¼ã€‚å±€éƒ¨DNSæœåŠ¡å™¨è‡ªå·±è´Ÿè´£å‘å…¶ä»–DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œä¸€èˆ¬æ˜¯å…ˆå‘è¯¥åŸŸåçš„æ ¹åŸŸæœåŠ¡å™¨æŸ¥è¯¢ï¼Œå†ç”±æ ¹åŸŸåæœåŠ¡å™¨ä¸€çº§çº§å‘ä¸‹æŸ¥è¯¢ã€‚æœ€åŽå¾—åˆ°çš„æŸ¥è¯¢ç»“æžœè¿”å›žç»™å±€éƒ¨DNSæœåŠ¡å™¨ï¼Œå†ç”±å±€éƒ¨DNSæœåŠ¡å™¨è¿”å›žç»™å®¢æˆ·ç«¯ã€‚ 2ã€è¿­ä»£è§£æž å½“å±€éƒ¨DNSæœåŠ¡å™¨è‡ªå·±ä¸èƒ½å›žç­”å®¢æˆ·æœºçš„DNSæŸ¥è¯¢æ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿­ä»£æŸ¥è¯¢çš„æ–¹å¼è¿›è¡Œè§£æžï¼Œå¦‚å›¾æ‰€ç¤ºã€‚å±€éƒ¨DNSæœåŠ¡å™¨ä¸æ˜¯è‡ªå·±å‘å…¶ä»–DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œæ˜¯æŠŠèƒ½è§£æžè¯¥åŸŸåçš„å…¶ä»–DNSæœåŠ¡å™¨çš„IPåœ°å€è¿”å›žç»™å®¢æˆ·ç«¯DNSç¨‹åºï¼Œå®¢æˆ·ç«¯DNSç¨‹åºå†ç»§ç»­å‘è¿™äº›DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œç›´åˆ°å¾—åˆ°æŸ¥è¯¢ç»“æžœä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿­ä»£è§£æžåªæ˜¯å¸®ä½ æ‰¾åˆ°ç›¸å…³çš„æœåŠ¡å™¨è€Œå·²ï¼Œè€Œä¸ä¼šå¸®ä½ åŽ»æŸ¥ã€‚æ¯”å¦‚è¯´ï¼šbaidu.comçš„æœåŠ¡å™¨ipåœ°å€åœ¨192.168.4.5è¿™é‡Œï¼Œä½ è‡ªå·±åŽ»æŸ¥å§ï¼Œæœ¬äººæ¯”è¾ƒå¿™ï¼Œåªèƒ½å¸®ä½ åˆ°è¿™é‡Œäº†ã€‚ 3ã€DNSåŸŸåç§°ç©ºé—´çš„ç»„ç»‡æ–¹å¼ æˆ‘ä»¬åœ¨å‰é¢æœ‰è¯´åˆ°æ ¹DNSæœåŠ¡å™¨ï¼ŒåŸŸDNSæœåŠ¡å™¨ï¼Œè¿™äº›éƒ½æ˜¯DNSåŸŸåç§°ç©ºé—´çš„ç»„ç»‡æ–¹å¼ã€‚æŒ‰å…¶åŠŸèƒ½å‘½åç©ºé—´ä¸­ç”¨æ¥æè¿° DNS åŸŸåç§°çš„äº”ä¸ªç±»åˆ«çš„ä»‹ç»è¯¦è§ä¸‹è¡¨ä¸­ï¼Œä»¥åŠä¸Žæ¯ä¸ªåç§°ç±»åž‹çš„ç¤ºä¾‹ 4ã€DNSè´Ÿè½½å‡è¡¡ å½“ä¸€ä¸ªç½‘ç«™æœ‰è¶³å¤Ÿå¤šçš„ç”¨æˆ·çš„æ—¶å€™ï¼Œå‡å¦‚æ¯æ¬¡è¯·æ±‚çš„èµ„æºéƒ½ä½äºŽåŒä¸€å°æœºå™¨ä¸Šé¢ï¼Œé‚£ä¹ˆè¿™å°æœºå™¨éšæ—¶å¯èƒ½ä¼šè¹¦æŽ‰ã€‚å¤„ç†åŠžæ³•å°±æ˜¯ç”¨DNSè´Ÿè½½å‡è¡¡æŠ€æœ¯ï¼Œå®ƒçš„åŽŸç†æ˜¯åœ¨DNSæœåŠ¡å™¨ä¸­ä¸ºåŒä¸€ä¸ªä¸»æœºåé…ç½®å¤šä¸ªIPåœ°å€,åœ¨åº”ç­”DNSæŸ¥è¯¢æ—¶,DNSæœåŠ¡å™¨å¯¹æ¯ä¸ªæŸ¥è¯¢å°†ä»¥DNSæ–‡ä»¶ä¸­ä¸»æœºè®°å½•çš„IPåœ°å€æŒ‰é¡ºåºè¿”å›žä¸åŒçš„è§£æžç»“æžœ,å°†å®¢æˆ·ç«¯çš„è®¿é—®å¼•å¯¼åˆ°ä¸åŒçš„æœºå™¨ä¸ŠåŽ»,ä½¿å¾—ä¸åŒçš„å®¢æˆ·ç«¯è®¿é—®ä¸åŒçš„æœåŠ¡å™¨,ä»Žè€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ï½¡ä¾‹å¦‚å¯ä»¥æ ¹æ®æ¯å°æœºå™¨çš„è´Ÿè½½é‡ï¼Œè¯¥æœºå™¨ç¦»ç”¨æˆ·åœ°ç†ä½ç½®çš„è·ç¦»ç­‰ç­‰ã€‚ æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚æ‹¿åˆ°åŸŸåå¯¹åº”çš„IPåœ°å€ä¹‹åŽï¼Œæµè§ˆå™¨ä¼šä»¥ä¸€ä¸ªéšæœºç«¯å£ï¼ˆ1024&lt;ç«¯å£&lt;65535ï¼‰å‘æœåŠ¡å™¨çš„WEBç¨‹åºï¼ˆå¸¸ç”¨çš„æœ‰httpd,nginxç­‰ï¼‰80ç«¯å£å‘èµ·TCPçš„è¿žæŽ¥è¯·æ±‚ã€‚è¿™ä¸ªè¿žæŽ¥è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ç«¯åŽï¼ˆè¿™ä¸­é—´é€šè¿‡å„ç§è·¯ç”±è®¾å¤‡ï¼Œå±€åŸŸç½‘å†…é™¤å¤–ï¼‰ï¼Œè¿›å…¥åˆ°ç½‘å¡ï¼Œç„¶åŽæ˜¯è¿›å…¥åˆ°å†…æ ¸çš„TCP/IPåè®®æ ˆï¼ˆç”¨äºŽè¯†åˆ«è¯¥è¿žæŽ¥è¯·æ±‚ï¼Œè§£å°åŒ…ï¼Œä¸€å±‚ä¸€å±‚çš„å‰¥å¼€ï¼‰ï¼Œè¿˜æœ‰å¯èƒ½è¦ç»è¿‡Netfilteré˜²ç«å¢™ï¼ˆå±žäºŽå†…æ ¸çš„æ¨¡å—ï¼‰çš„è¿‡æ»¤ï¼Œæœ€ç»ˆåˆ°è¾¾WEBç¨‹åºï¼Œæœ€ç»ˆå»ºç«‹äº†TCP/IPçš„è¿žæŽ¥ã€‚ å»ºç«‹äº†TCPè¿žæŽ¥ä¹‹åŽï¼Œå‘èµ·ä¸€ä¸ªhttpè¯·æ±‚ã€‚ä¸€ä¸ªå…¸åž‹çš„ http request header ä¸€èˆ¬éœ€è¦åŒ…æ‹¬è¯·æ±‚çš„æ–¹æ³•ï¼Œä¾‹å¦‚ GET æˆ–è€… POST ç­‰ï¼Œä¸å¸¸ç”¨çš„è¿˜æœ‰ PUT å’Œ DELETE ã€HEADã€OPTIONä»¥åŠ TRACE æ–¹æ³•ï¼Œä¸€èˆ¬çš„æµè§ˆå™¨åªèƒ½å‘èµ· GET æˆ–è€… POST è¯·æ±‚ã€‚ å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·httpè¯·æ±‚çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€äº›è¯·æ±‚ä¿¡æ¯ï¼Œè¯·æ±‚ä¿¡æ¯åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š è¯·æ±‚æ–¹æ³•URIåè®®/ç‰ˆæœ¬ è¯·æ±‚å¤´(Request Header) è¯·æ±‚æ­£æ–‡ï¼š ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„HTTPè¯·æ±‚ä¾‹å­ï¼š 123456789GET/sample.jspHTTP/1.1Accept:image/gif.image/jpeg,*/*Accept-Language:zh-cnConnection:Keep-AliveHost:localhostUser-Agent:Mozila/4.0(compatible;MSIE5.01;Window NT5.0)Accept-Encoding:gzip,deflateusername=jinqiao&amp;password=1234 æ³¨æ„ï¼šæœ€åŽä¸€ä¸ªè¯·æ±‚å¤´ä¹‹åŽæ˜¯ä¸€ä¸ªç©ºè¡Œï¼Œå‘é€å›žè½¦ç¬¦å’Œæ¢è¡Œç¬¦ï¼Œé€šçŸ¥æœåŠ¡å™¨ä»¥ä¸‹ä¸å†æœ‰è¯·æ±‚å¤´ã€‚ ï¼ˆ1ï¼‰è¯·æ±‚çš„ç¬¬ä¸€è¡Œæ˜¯â€œæ–¹æ³•URLè®®/ç‰ˆæœ¬â€ï¼šGET/sample.jsp HTTP/1.1 ï¼ˆ2ï¼‰è¯·æ±‚å¤´(Request Header) è¯·æ±‚å¤´åŒ…å«è®¸å¤šæœ‰å…³çš„å®¢æˆ·ç«¯çŽ¯å¢ƒå’Œè¯·æ±‚æ­£æ–‡çš„æœ‰ç”¨ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œè¯·æ±‚å¤´å¯ä»¥å£°æ˜Žæµè§ˆå™¨æ‰€ç”¨çš„è¯­è¨€ï¼Œè¯·æ±‚æ­£æ–‡çš„é•¿åº¦ç­‰ã€‚ ï¼ˆ3ï¼‰è¯·æ±‚æ­£æ–‡ è¯·æ±‚å¤´å’Œè¯·æ±‚æ­£æ–‡ä¹‹é—´æ˜¯ä¸€ä¸ªç©ºè¡Œï¼Œè¿™ä¸ªè¡Œéžå¸¸é‡è¦ï¼Œå®ƒè¡¨ç¤ºè¯·æ±‚å¤´å·²ç»ç»“æŸï¼ŒæŽ¥ä¸‹æ¥çš„æ˜¯è¯·æ±‚æ­£æ–‡ã€‚è¯·æ±‚æ­£æ–‡ä¸­å¯ä»¥åŒ…å«å®¢æˆ·æäº¤çš„æŸ¥è¯¢å­—ç¬¦ä¸²ä¿¡æ¯ï¼šusername=jinqiao&amp;password=1234 çŸ¥è¯†æ‰©å±•TCPçš„ä¸‰æ¬¡æ¡æ‰‹ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯Aå°†æ ‡å¿—ä½SYNç½®ä¸º1,éšæœºäº§ç”Ÿä¸€ä¸ªå€¼ä¸ºseq=Jï¼ˆJçš„å–å€¼èŒƒå›´ä¸º=1234567ï¼‰çš„æ•°æ®åŒ…åˆ°æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯Aè¿›å…¥SYN_SENTçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯Bç¡®è®¤ï¼› ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯Bæ”¶åˆ°æ•°æ®åŒ…åŽç”±æ ‡å¿—ä½SYN=1çŸ¥é“å®¢æˆ·ç«¯Aè¯·æ±‚å»ºç«‹è¿žæŽ¥ï¼ŒæœåŠ¡ç«¯Bå°†æ ‡å¿—ä½SYNå’ŒACKéƒ½ç½®ä¸º1ï¼Œack=J+1ï¼Œéšæœºäº§ç”Ÿä¸€ä¸ªå€¼seq=Kï¼Œå¹¶å°†è¯¥æ•°æ®åŒ…å‘é€ç»™å®¢æˆ·ç«¯Aä»¥ç¡®è®¤è¿žæŽ¥è¯·æ±‚ï¼ŒæœåŠ¡ç«¯Bè¿›å…¥SYN_RCVDçŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯Aæ”¶åˆ°ç¡®è®¤åŽï¼Œæ£€æŸ¥ackæ˜¯å¦ä¸ºJ+1ï¼ŒACKæ˜¯å¦ä¸º1ï¼Œå¦‚æžœæ­£ç¡®åˆ™å°†æ ‡å¿—ä½ACKç½®ä¸º1ï¼Œack=K+1ï¼Œå¹¶å°†è¯¥æ•°æ®åŒ…å‘é€ç»™æœåŠ¡ç«¯Bï¼ŒæœåŠ¡ç«¯Bæ£€æŸ¥ackæ˜¯å¦ä¸ºK+1ï¼ŒACKæ˜¯å¦ä¸º1ï¼Œå¦‚æžœæ­£ç¡®åˆ™è¿žæŽ¥å»ºç«‹æˆåŠŸï¼Œå®¢æˆ·ç«¯Aå’ŒæœåŠ¡ç«¯Bè¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼ŒéšåŽå®¢æˆ·ç«¯Aä¸ŽæœåŠ¡ç«¯Bä¹‹é—´å¯ä»¥å¼€å§‹ä¼ è¾“æ•°æ®äº†ã€‚ å¦‚å›¾æ‰€ç¤º ä¸ºä»€éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿã€Šè®¡ç®—æœºç½‘ç»œã€‹ç¬¬å››ç‰ˆä¸­è®²â€œä¸‰æ¬¡æ¡æ‰‹â€çš„ç›®çš„æ˜¯ â€œä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿žæŽ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯â€ ä¹¦ä¸­çš„ä¾‹å­æ˜¯è¿™æ ·çš„ï¼Œâ€œå·²å¤±æ•ˆçš„è¿žæŽ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€çš„äº§ç”Ÿåœ¨è¿™æ ·ä¸€ç§æƒ…å†µä¸‹ï¼šclientå‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿žæŽ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»žç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿žæŽ¥é‡Šæ”¾ä»¥åŽçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾serverã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½†serveræ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿žæŽ¥è¯·æ±‚æŠ¥æ–‡æ®µåŽï¼Œå°±è¯¯è®¤ä¸ºæ˜¯clientå†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿žæŽ¥è¯·æ±‚ã€‚äºŽæ˜¯å°±å‘clientå‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿žæŽ¥ã€‚ å‡è®¾ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦serverå‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿žæŽ¥å°±å»ºç«‹äº†ã€‚ç”±äºŽçŽ°åœ¨clientå¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿žæŽ¥çš„è¯·æ±‚ï¼Œå› æ­¤ä¸ä¼šç†ç¬serverçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘serverå‘é€æ•°æ®ã€‚ä½†serverå´ä»¥ä¸ºæ–°çš„è¿è¾“è¿žæŽ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸€ç›´ç­‰å¾…clientå‘æ¥æ•°æ®ã€‚è¿™æ ·ï¼Œserverçš„å¾ˆå¤šèµ„æºå°±ç™½ç™½æµªè´¹æŽ‰äº†ã€‚ é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€çš„åŠžæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°çŽ°è±¡å‘ç”Ÿã€‚ä¾‹å¦‚åˆšæ‰é‚£ç§æƒ…å†µï¼Œclientä¸ä¼šå‘serverçš„ç¡®è®¤å‘å‡ºç¡®è®¤ã€‚serverç”±äºŽæ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±çŸ¥é“clientå¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¿žæŽ¥ã€‚â€ã€‚ä¸»è¦ç›®çš„ é˜²æ­¢serverç«¯ä¸€ç›´ç­‰å¾…ï¼Œæµªè´¹èµ„æºã€‚ TCPå››æ¬¡æŒ¥æ‰‹ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šClientå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­Clientåˆ°Serverçš„æ•°æ®ä¼ é€ï¼ŒClientè¿›å…¥FIN_WAIT_1çŠ¶æ€ã€‚ ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šServeræ”¶åˆ°FINåŽï¼Œå‘é€ä¸€ä¸ªACKç»™Clientï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼ˆä¸ŽSYNç›¸åŒï¼Œä¸€ä¸ªFINå ç”¨ä¸€ä¸ªåºå·ï¼‰ï¼ŒServerè¿›å…¥CLOSE_WAITçŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šServerå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­Serveråˆ°Clientçš„æ•°æ®ä¼ é€ï¼ŒServerè¿›å…¥LAST_ACKçŠ¶æ€ã€‚ ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šClientæ”¶åˆ°FINåŽï¼ŒClientè¿›å…¥TIME_WAITçŠ¶æ€ï¼ŒæŽ¥ç€å‘é€ä¸€ä¸ªACKç»™Serverï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼ŒServerè¿›å…¥CLOSEDçŠ¶æ€ï¼Œå®Œæˆå››æ¬¡æŒ¥æ‰‹ã€‚ å¦‚å›¾æ‰€ç¤º: ä¸ºä»€ä¹ˆå»ºç«‹è¿žæŽ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œå…³é—­è¿žæŽ¥å´æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºæœåŠ¡ç«¯åœ¨LISTENçŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°å»ºç«‹è¿žæŽ¥è¯·æ±‚çš„SYNæŠ¥æ–‡åŽï¼ŒæŠŠACKå’ŒSYNæ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡é‡Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚è€Œå…³é—­è¿žæŽ¥æ—¶ï¼Œå½“æ”¶åˆ°å¯¹æ–¹çš„FINæŠ¥æ–‡æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå¯¹æ–¹ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æŽ¥æ”¶æ•°æ®ï¼Œå·±æ–¹ä¹Ÿæœªå¿…å…¨éƒ¨æ•°æ®éƒ½å‘é€ç»™å¯¹æ–¹äº†ï¼Œæ‰€ä»¥å·±æ–¹å¯ä»¥ç«‹å³closeï¼Œä¹Ÿå¯ä»¥å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹åŽï¼Œå†å‘é€FINæŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºåŒæ„çŽ°åœ¨å…³é—­è¿žæŽ¥ï¼Œå› æ­¤ï¼Œå·±æ–¹ACKå’ŒFINä¸€èˆ¬éƒ½ä¼šåˆ†å¼€å‘é€ã€‚ æµè§ˆå™¨çš„æ°¸ä¹…é‡å®šå‘å“åº”æœåŠ¡å™¨ç»™æµè§ˆå™¨å“åº”ä¸€ä¸ª301æ°¸ä¹…é‡å®šå‘å“åº”ï¼Œè¿™æ ·æµè§ˆå™¨å°±ä¼šè®¿é—®â€œhttp://www.google.com/â€ è€Œéžâ€œhttp://google.com/â€ã€‚ ä¸ºä»€ä¹ˆæœåŠ¡å™¨ä¸€å®šè¦é‡å®šå‘è€Œä¸æ˜¯ç›´æŽ¥å‘é€ç”¨æˆ·æƒ³çœ‹çš„ç½‘é¡µå†…å®¹å‘¢ï¼Ÿå…¶ä¸­ä¸€ä¸ªåŽŸå› è·Ÿæœç´¢å¼•æ“ŽæŽ’åæœ‰å…³ã€‚å¦‚æžœä¸€ä¸ªé¡µé¢æœ‰ä¸¤ä¸ªåœ°å€ï¼Œå°±åƒhttp://www.yy.com/å’Œhttp://yy.com/ï¼Œæœç´¢å¼•æ“Žä¼šè®¤ä¸ºå®ƒä»¬æ˜¯ä¸¤ä¸ªç½‘ç«™ï¼Œç»“æžœé€ æˆæ¯ä¸ªæœç´¢é“¾æŽ¥éƒ½å‡å°‘ä»Žè€Œé™ä½ŽæŽ’åã€‚è€Œæœç´¢å¼•æ“ŽçŸ¥é“301æ°¸ä¹…é‡å®šå‘æ˜¯ä»€ä¹ˆæ„æ€ï¼Œè¿™æ ·å°±ä¼šæŠŠè®¿é—®å¸¦wwwçš„å’Œä¸å¸¦wwwçš„åœ°å€å½’åˆ°åŒä¸€ä¸ªç½‘ç«™æŽ’åä¸‹ã€‚è¿˜æœ‰å°±æ˜¯ç”¨ä¸åŒçš„åœ°å€ä¼šé€ æˆç¼“å­˜å‹å¥½æ€§å˜å·®ï¼Œå½“ä¸€ä¸ªé¡µé¢æœ‰å¥½å‡ ä¸ªåå­—æ—¶ï¼Œå®ƒå¯èƒ½ä¼šåœ¨ç¼“å­˜é‡Œå‡ºçŽ°å¥½å‡ æ¬¡ã€‚ çŸ¥è¯†æ‰©å±•301å’Œ302çš„åŒºåˆ«ã€‚301å’Œ302çŠ¶æ€ç éƒ½è¡¨ç¤ºé‡å®šå‘ï¼Œå°±æ˜¯è¯´æµè§ˆå™¨åœ¨æ‹¿åˆ°æœåŠ¡å™¨è¿”å›žçš„è¿™ä¸ªçŠ¶æ€ç åŽä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„URLåœ°å€ï¼Œè¿™ä¸ªåœ°å€å¯ä»¥ä»Žå“åº”çš„Locationé¦–éƒ¨ä¸­èŽ·å–ï¼ˆç”¨æˆ·çœ‹åˆ°çš„æ•ˆæžœå°±æ˜¯ä»–è¾“å…¥çš„åœ°å€Açž¬é—´å˜æˆäº†å¦ä¸€ä¸ªåœ°å€Bï¼‰â€”â€”è¿™æ˜¯å®ƒä»¬çš„å…±åŒç‚¹ã€‚ ä»–ä»¬çš„ä¸åŒåœ¨äºŽã€‚301è¡¨ç¤ºæ—§åœ°å€Açš„èµ„æºå·²ç»è¢«æ°¸ä¹…åœ°ç§»é™¤äº†ï¼ˆè¿™ä¸ªèµ„æºä¸å¯è®¿é—®äº†ï¼‰ï¼Œæœç´¢å¼•æ“Žåœ¨æŠ“å–æ–°å†…å®¹çš„åŒæ—¶ä¹Ÿå°†æ—§çš„ç½‘å€äº¤æ¢ä¸ºé‡å®šå‘ä¹‹åŽçš„ç½‘å€ï¼› 302è¡¨ç¤º æ—§åœ°å€Açš„èµ„æºè¿˜åœ¨ï¼ˆä»ç„¶å¯ä»¥è®¿é—®ï¼‰ï¼Œè¿™ä¸ªé‡å®šå‘åªæ˜¯ä¸´æ—¶åœ°ä»Žæ—§åœ°å€Aè·³è½¬åˆ°åœ°å€Bï¼Œæœç´¢å¼•æ“Žä¼šæŠ“å–æ–°çš„å†…å®¹è€Œä¿å­˜æ—§çš„ç½‘å€ã€‚ SEO302å¥½äºŽ301 é‡å®šå‘åŽŸå› ï¼šï¼ˆ1ï¼‰ç½‘ç«™è°ƒæ•´ï¼ˆå¦‚æ”¹å˜ç½‘é¡µç›®å½•ç»“æž„ï¼‰ï¼› ï¼ˆ2ï¼‰ç½‘é¡µè¢«ç§»åˆ°ä¸€ä¸ªæ–°åœ°å€ï¼› ï¼ˆ3ï¼‰ç½‘é¡µæ‰©å±•åæ”¹å˜(å¦‚åº”ç”¨éœ€è¦æŠŠ.phpæ”¹æˆ.Htmlæˆ–.shtml)ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æžœä¸åšé‡å®šå‘ï¼Œåˆ™ç”¨æˆ·æ”¶è—å¤¹æˆ–æœç´¢å¼•æ“Žæ•°æ®åº“ä¸­æ—§åœ°å€åªèƒ½è®©è®¿é—®å®¢æˆ·å¾—åˆ°ä¸€ä¸ª404é¡µé¢é”™è¯¯ä¿¡æ¯ï¼Œè®¿é—®æµé‡ç™½ç™½ä¸§å¤±ï¼›å†è€…æŸäº›æ³¨å†Œäº†å¤šä¸ªåŸŸåçš„ç½‘ç«™ï¼Œä¹Ÿéœ€è¦é€šè¿‡é‡å®šå‘è®©è®¿é—®è¿™äº›åŸŸåçš„ç”¨æˆ·è‡ªåŠ¨è·³è½¬åˆ°ä¸»ç«™ç‚¹ç­‰ã€‚ ä»€ä¹ˆæ—¶å€™è¿›è¡Œ301æˆ–è€…302è·³è½¬å‘¢ï¼Ÿå½“ä¸€ä¸ªç½‘ç«™æˆ–è€…ç½‘é¡µ24â€”48å°æ—¶å†…ä¸´æ—¶ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„ä½ç½®ï¼Œè¿™æ—¶å€™å°±è¦è¿›è¡Œ302è·³è½¬ï¼Œè€Œä½¿ç”¨301è·³è½¬çš„åœºæ™¯å°±æ˜¯ä¹‹å‰çš„ç½‘ç«™å› ä¸ºæŸç§åŽŸå› éœ€è¦ç§»é™¤æŽ‰ï¼Œç„¶åŽè¦åˆ°æ–°çš„åœ°å€è®¿é—®ï¼Œæ˜¯æ°¸ä¹…æ€§çš„ã€‚ æ¸…æ™°æ˜Žç¡®è€Œè¨€ï¼šä½¿ç”¨301è·³è½¬çš„å¤§æ¦‚åœºæ™¯å¦‚ä¸‹ï¼š 1ã€åŸŸååˆ°æœŸä¸æƒ³ç»­è´¹ï¼ˆæˆ–è€…å‘çŽ°äº†æ›´é€‚åˆç½‘ç«™çš„åŸŸåï¼‰ï¼Œæƒ³æ¢ä¸ªåŸŸåã€‚ 2ã€åœ¨æœç´¢å¼•æ“Žçš„æœç´¢ç»“æžœä¸­å‡ºçŽ°äº†ä¸å¸¦wwwçš„åŸŸåï¼Œè€Œå¸¦wwwçš„åŸŸåå´æ²¡æœ‰æ”¶å½•ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨301é‡å®šå‘æ¥å‘Šè¯‰æœç´¢å¼•æ“Žæˆ‘ä»¬ç›®æ ‡çš„åŸŸåæ˜¯å“ªä¸€ä¸ªã€‚ 3ã€ç©ºé—´æœåŠ¡å™¨ä¸ç¨³å®šï¼Œæ¢ç©ºé—´çš„æ—¶å€™ã€‚ æµè§ˆå™¨è·Ÿè¸ªé‡å®šå‘åœ°å€çŽ°åœ¨æµè§ˆå™¨çŸ¥é“äº† â€œhttp://www.google.com/â€œæ‰æ˜¯è¦è®¿é—®çš„æ­£ç¡®åœ°å€ï¼Œæ‰€ä»¥å®ƒä¼šå‘é€å¦ä¸€ä¸ªhttpè¯·æ±‚ã€‚è¿™é‡Œæ²¡æœ‰å•¥å¥½è¯´çš„ æœåŠ¡å™¨å¤„ç†è¯·æ±‚ç»è¿‡å‰é¢çš„é‡é‡æ­¥éª¤ï¼Œæˆ‘ä»¬ç»ˆäºŽå°†æˆ‘ä»¬çš„httpè¯·æ±‚å‘é€åˆ°äº†æœåŠ¡å™¨è¿™é‡Œï¼Œå…¶å®žå‰é¢çš„é‡å®šå‘å·²ç»æ˜¯åˆ°è¾¾æœåŠ¡å™¨äº†ï¼Œé‚£ä¹ˆï¼ŒæœåŠ¡å™¨æ˜¯å¦‚ä½•å¤„ç†æˆ‘ä»¬çš„è¯·æ±‚çš„å‘¢ï¼Ÿ åŽç«¯ä»Žåœ¨å›ºå®šçš„ç«¯å£æŽ¥æ”¶åˆ°TCPæŠ¥æ–‡å¼€å§‹ï¼Œå®ƒä¼šå¯¹TCPè¿žæŽ¥è¿›è¡Œå¤„ç†ï¼Œå¯¹HTTPåè®®è¿›è¡Œè§£æžï¼Œå¹¶æŒ‰ç…§æŠ¥æ–‡æ ¼å¼è¿›ä¸€æ­¥å°è£…æˆHTTP Requestå¯¹è±¡ï¼Œä¾›ä¸Šå±‚ä½¿ç”¨ã€‚ ä¸€äº›å¤§ä¸€ç‚¹çš„ç½‘ç«™ä¼šå°†ä½ çš„è¯·æ±‚åˆ°åå‘ä»£ç†æœåŠ¡å™¨ä¸­ï¼Œå› ä¸ºå½“ç½‘ç«™è®¿é—®é‡éžå¸¸å¤§ï¼Œç½‘ç«™è¶Šæ¥è¶Šæ…¢ï¼Œä¸€å°æœåŠ¡å™¨å·²ç»ä¸å¤Ÿç”¨äº†ã€‚äºŽæ˜¯å°†åŒä¸€ä¸ªåº”ç”¨éƒ¨ç½²åœ¨å¤šå°æœåŠ¡å™¨ä¸Šï¼Œå°†å¤§é‡ç”¨æˆ·çš„è¯·æ±‚åˆ†é…ç»™å¤šå°æœºå™¨å¤„ç†ã€‚æ­¤æ—¶ï¼Œå®¢æˆ·ç«¯ä¸æ˜¯ç›´æŽ¥é€šè¿‡HTTPåè®®è®¿é—®æŸç½‘ç«™åº”ç”¨æœåŠ¡å™¨ï¼Œè€Œæ˜¯å…ˆè¯·æ±‚åˆ°Nginxï¼ŒNginxå†è¯·æ±‚åº”ç”¨æœåŠ¡å™¨ï¼Œç„¶åŽå°†ç»“æžœè¿”å›žç»™å®¢æˆ·ç«¯ï¼Œè¿™é‡ŒNginxçš„ä½œç”¨æ˜¯åå‘ä»£ç†æœåŠ¡å™¨ã€‚åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªå¥½å¤„ï¼Œå…¶ä¸­ä¸€å°æœåŠ¡å™¨ä¸‡ä¸€æŒ‚äº†ï¼Œåªè¦è¿˜æœ‰å…¶ä»–æœåŠ¡å™¨æ­£å¸¸è¿è¡Œï¼Œå°±ä¸ä¼šå½±å“ç”¨æˆ·ä½¿ç”¨ã€‚ å¦‚å›¾æ‰€ç¤º é€šè¿‡Nginxçš„åå‘ä»£ç†ï¼Œæˆ‘ä»¬åˆ°è¾¾äº†webæœåŠ¡å™¨ï¼ŒæœåŠ¡ç«¯è„šæœ¬å¤„ç†æˆ‘ä»¬çš„è¯·æ±‚ï¼Œè®¿é—®æˆ‘ä»¬çš„æ•°æ®åº“ï¼ŒèŽ·å–éœ€è¦èŽ·å–çš„å†…å®¹ç­‰ç­‰ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¶‰åŠå¾ˆå¤šåŽç«¯è„šæœ¬çš„å¤æ‚æ“ä½œã€‚ç”±äºŽå¯¹è¿™ä¸€å—ä¸ç†Ÿï¼Œæ‰€ä»¥è¿™ä¸€å—åªèƒ½ä»‹ç»è¿™ä¹ˆå¤šäº†ã€‚ æ‰©å±•é˜…è¯»ï¼šä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿå®¢æˆ·ç«¯æœ¬æ¥å¯ä»¥ç›´æŽ¥é€šè¿‡HTTPåè®®è®¿é—®æŸç½‘ç«™åº”ç”¨æœåŠ¡å™¨ï¼Œç½‘ç«™ç®¡ç†å‘˜å¯ä»¥åœ¨ä¸­é—´åŠ ä¸Šä¸€ä¸ªNginxï¼Œå®¢æˆ·ç«¯è¯·æ±‚Nginxï¼ŒNginxè¯·æ±‚åº”ç”¨æœåŠ¡å™¨ï¼Œç„¶åŽå°†ç»“æžœè¿”å›žç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶Nginxå°±æ˜¯åå‘ä»£ç†æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨è¿”å›žä¸€ä¸ªHTTPå“åº”ç»è¿‡å‰é¢çš„6ä¸ªæ­¥éª¤ï¼ŒæœåŠ¡å™¨æ”¶åˆ°äº†æˆ‘ä»¬çš„è¯·æ±‚ï¼Œä¹Ÿå¤„ç†æˆ‘ä»¬çš„è¯·æ±‚ï¼Œåˆ°è¿™ä¸€æ­¥ï¼Œå®ƒä¼šæŠŠå®ƒçš„å¤„ç†ç»“æžœè¿”å›žï¼Œä¹Ÿå°±æ˜¯è¿”å›žä¸€ä¸ªHTPPå“åº”ã€‚HTTPå“åº”ä¸ŽHTTPè¯·æ±‚ç›¸ä¼¼ï¼Œ HTTPå“åº”ä¹Ÿç”±3ä¸ªéƒ¨åˆ†æž„æˆï¼Œåˆ†åˆ«æ˜¯ï¼š çŠ¶æ€è¡Œ å“åº”å¤´(Response Header) å“åº”æ­£æ–‡ 12345678910111213HTTP/1.1 200 OKDate: Sat, 31 Dec 2005 23:59:59 GMTContent-Type: text/html;charset=ISO-8859-1Content-Length: 122ï¼œhtmlï¼žï¼œheadï¼žï¼œtitleï¼žhttpï¼œ/titleï¼žï¼œ/headï¼žï¼œbodyï¼žï¼œ!-- body goes here --ï¼žï¼œ/bodyï¼žï¼œ/htmlï¼ž çŠ¶æ€è¡Œï¼š çŠ¶æ€è¡Œç”±åè®®ç‰ˆæœ¬ã€æ•°å­—å½¢å¼çš„çŠ¶æ€ä»£ç ã€åŠç›¸åº”çš„çŠ¶æ€æè¿°ï¼Œå„å…ƒç´ ä¹‹é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚æ ¼å¼: HTTP-Version Status-Code Reason-Phrase CRLF ä¾‹å¦‚: HTTP/1.1 200 OK \r\n â€“ åè®®ç‰ˆæœ¬ï¼šæ˜¯ç”¨http1.0è¿˜æ˜¯å…¶ä»–ç‰ˆæœ¬ â€“ çŠ¶æ€æè¿°ï¼šçŠ¶æ€æè¿°ç»™å‡ºäº†å…³äºŽçŠ¶æ€ä»£ç çš„ç®€çŸ­çš„æ–‡å­—æè¿°ã€‚æ¯”å¦‚çŠ¶æ€ä»£ç ä¸º200æ—¶çš„æè¿°ä¸º ok â€“ çŠ¶æ€ä»£ç ï¼šçŠ¶æ€ä»£ç ç”±ä¸‰ä½æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰äº†å“åº”çš„ç±»åˆ«ï¼Œä¸”æœ‰äº”ç§å¯èƒ½å–å€¼ã€‚å¦‚ä¸‹ 1xxï¼šä¿¡æ¯æ€§çŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å·²æŽ¥æ”¶äº†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå®¢æˆ·ç«¯å¯ç»§ç»­å‘é€è¯·æ±‚ã€‚ 100 Continue 101 Switching Protocols 2xxï¼šæˆåŠŸçŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å·²æˆåŠŸæŽ¥æ”¶åˆ°è¯·æ±‚å¹¶è¿›è¡Œå¤„ç†ã€‚ 200 OK è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ 204 No Content æˆåŠŸï¼Œä½†ä¸è¿”å›žä»»ä½•å®žä½“çš„ä¸»ä½“éƒ¨åˆ† 206 Partial Content æˆåŠŸæ‰§è¡Œäº†ä¸€ä¸ªèŒƒå›´ï¼ˆRangeï¼‰è¯·æ±‚ 3xxï¼šé‡å®šå‘çŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¦æ±‚å®¢æˆ·ç«¯é‡å®šå‘ã€‚ 301 Moved Permanently æ°¸ä¹…æ€§é‡å®šå‘ï¼Œå“åº”æŠ¥æ–‡çš„Locationé¦–éƒ¨åº”è¯¥æœ‰è¯¥èµ„æºçš„æ–°URL 302 Found ä¸´æ—¶æ€§é‡å®šå‘ï¼Œå“åº”æŠ¥æ–‡çš„Locationé¦–éƒ¨ç»™å‡ºçš„URLç”¨æ¥ä¸´æ—¶å®šä½èµ„æº 303 See Other è¯·æ±‚çš„èµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ªURIï¼Œå®¢æˆ·ç«¯åº”ä½¿ç”¨GETæ–¹æ³•å®šå‘èŽ·å–è¯·æ±‚çš„èµ„æº 304 Not Modified æœåŠ¡å™¨å†…å®¹æ²¡æœ‰æ›´æ–°ï¼Œå¯ä»¥ç›´æŽ¥è¯»å–æµè§ˆå™¨ç¼“å­˜ 307 Temporary Redirect ä¸´æ—¶é‡å®šå‘ã€‚ä¸Ž302 Foundå«ä¹‰ä¸€æ ·ã€‚302ç¦æ­¢POSTå˜æ¢ä¸ºGETï¼Œä½†å®žé™…ä½¿ç”¨æ—¶å¹¶ä¸ä¸€å®šï¼Œ307åˆ™æ›´å¤šæµè§ˆå™¨å¯èƒ½ä¼šéµå¾ªè¿™ä¸€æ ‡å‡†ï¼Œä½†ä¹Ÿä¾èµ–äºŽæµè§ˆå™¨å…·ä½“å®žçŽ° 4xxï¼šå®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯çš„è¯·æ±‚æœ‰éžæ³•å†…å®¹ã€‚ 400 Bad Request è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£ 401 Unauthonzed è¡¨ç¤ºè¯·æ±‚æœªç»æŽˆæƒï¼Œè¯¥çŠ¶æ€ä»£ç å¿…é¡»ä¸Ž WWW-Authenticate æŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨ 403 Forbidden è¡¨ç¤ºæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡ï¼Œé€šå¸¸ä¼šåœ¨å“åº”æ­£æ–‡ä¸­ç»™å‡ºä¸æä¾›æœåŠ¡çš„åŽŸå›  404 Not Found è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ï¼Œä¾‹å¦‚ï¼Œè¾“å…¥äº†é”™è¯¯çš„URL 5xxï¼šæœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨æœªèƒ½æ­£å¸¸å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚è€Œå‡ºçŽ°æ„å¤–é”™è¯¯ã€‚ 500 Internel Server Error è¡¨ç¤ºæœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯ï¼Œå¯¼è‡´æ— æ³•å®Œæˆå®¢æˆ·ç«¯çš„è¯·æ±‚ 503 Service Unavailable è¡¨ç¤ºæœåŠ¡å™¨å½“å‰ä¸èƒ½å¤Ÿå¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œåœ¨ä¸€æ®µæ—¶é—´ä¹‹åŽï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šæ¢å¤æ­£å¸¸ å“åº”å¤´ï¼š å“åº”å¤´éƒ¨ï¼šç”±å…³é”®å­—/å€¼å¯¹ç»„æˆï¼Œæ¯è¡Œä¸€å¯¹ï¼Œå…³é”®å­—å’Œå€¼ç”¨è‹±æ–‡å†’å·â€:â€åˆ†éš”ï¼Œå…¸åž‹çš„å“åº”å¤´æœ‰ï¼š å“åº”æ­£æ–‡ åŒ…å«ç€æˆ‘ä»¬éœ€è¦çš„ä¸€äº›å…·ä½“ä¿¡æ¯ï¼Œæ¯”å¦‚cookieï¼Œhtml,imageï¼ŒåŽç«¯è¿”å›žçš„è¯·æ±‚æ•°æ®ç­‰ç­‰ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå“åº”æ­£æ–‡å’Œå“åº”å¤´ä¹‹é—´æœ‰ä¸€è¡Œç©ºæ ¼ï¼Œè¡¨ç¤ºå“åº”å¤´çš„ä¿¡æ¯åˆ°ç©ºæ ¼ä¸ºæ­¢ï¼Œä¸‹å›¾æ˜¯fiddleræŠ“åˆ°çš„è¯·æ±‚æ­£æ–‡ï¼Œçº¢è‰²æ¡†ä¸­çš„ï¼šå“åº”æ­£æ–‡ï¼š æµè§ˆå™¨æ˜¾ç¤ºHTMLåœ¨æµè§ˆå™¨æ²¡æœ‰å®Œæ•´æŽ¥å—å…¨éƒ¨HTMLæ–‡æ¡£æ—¶ï¼Œå®ƒå°±å·²ç»å¼€å§‹æ˜¾ç¤ºè¿™ä¸ªé¡µé¢äº†ï¼Œæµè§ˆå™¨æ˜¯å¦‚ä½•æŠŠé¡µé¢å‘ˆçŽ°åœ¨å±å¹•ä¸Šçš„å‘¢ï¼Ÿä¸åŒæµè§ˆå™¨å¯èƒ½è§£æžçš„è¿‡ç¨‹ä¸å¤ªä¸€æ ·ï¼Œè¿™é‡Œæˆ‘ä»¬åªä»‹ç»webkitçš„æ¸²æŸ“è¿‡ç¨‹ï¼Œä¸‹å›¾å¯¹åº”çš„å°±æ˜¯WebKitæ¸²æŸ“çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬ï¼š è§£æžhtmlä»¥æž„å»ºdomæ ‘ -&gt; æž„å»ºrenderæ ‘ -&gt; å¸ƒå±€renderæ ‘ -&gt; ç»˜åˆ¶renderæ ‘ æµè§ˆå™¨åœ¨è§£æžhtmlæ–‡ä»¶æ—¶ï¼Œä¼šè‡ªä¸Šè€Œä¸‹åŠ è½½ï¼Œå¹¶åœ¨åŠ è½½è¿‡ç¨‹ä¸­è¿›è¡Œè§£æžæ¸²æŸ“ã€‚åœ¨è§£æžè¿‡ç¨‹ä¸­ï¼Œå¦‚æžœé‡åˆ°è¯·æ±‚å¤–éƒ¨èµ„æºæ—¶ï¼Œå¦‚å›¾ç‰‡ã€å¤–é“¾çš„CSSã€iconfontç­‰ï¼Œè¯·æ±‚è¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸ä¼šå½±å“htmlæ–‡æ¡£è¿›è¡ŒåŠ è½½ã€‚ è§£æžè¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨é¦–å…ˆä¼šè§£æžHTMLæ–‡ä»¶æž„å»ºDOMæ ‘ï¼Œç„¶åŽè§£æžCSSæ–‡ä»¶æž„å»ºæ¸²æŸ“æ ‘ï¼Œç­‰åˆ°æ¸²æŸ“æ ‘æž„å»ºå®ŒæˆåŽï¼Œæµè§ˆå™¨å¼€å§‹å¸ƒå±€æ¸²æŸ“æ ‘å¹¶å°†å…¶ç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæ¶‰åŠåˆ°ä¸¤ä¸ªæ¦‚å¿µ: reflow(å›žæµ)å’Œrepain(é‡ç»˜)ã€‚ DOMèŠ‚ç‚¹ä¸­çš„å„ä¸ªå…ƒç´ éƒ½æ˜¯ä»¥ç›’æ¨¡åž‹çš„å½¢å¼å­˜åœ¨ï¼Œè¿™äº›éƒ½éœ€è¦æµè§ˆå™¨åŽ»è®¡ç®—å…¶ä½ç½®å’Œå¤§å°ç­‰ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºrelow;å½“ç›’æ¨¡åž‹çš„ä½ç½®,å¤§å°ä»¥åŠå…¶ä»–å±žæ€§ï¼Œå¦‚é¢œè‰²,å­—ä½“,ç­‰ç¡®å®šä¸‹æ¥ä¹‹åŽï¼Œæµè§ˆå™¨ä¾¿å¼€å§‹ç»˜åˆ¶å†…å®¹ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºrepainã€‚ é¡µé¢åœ¨é¦–æ¬¡åŠ è½½æ—¶å¿…ç„¶ä¼šç»åŽ†reflowå’Œrepainã€‚reflowå’Œrepainè¿‡ç¨‹æ˜¯éžå¸¸æ¶ˆè€—æ€§èƒ½çš„ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼Œå®ƒä¼šç ´åç”¨æˆ·ä½“éªŒï¼Œæœ‰æ—¶ä¼šé€ æˆé¡µé¢å¡é¡¿ã€‚æ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½å¯èƒ½å°‘çš„å‡å°‘reflowå’Œrepainã€‚ å½“æ–‡æ¡£åŠ è½½è¿‡ç¨‹ä¸­é‡åˆ°jsæ–‡ä»¶ï¼Œhtmlæ–‡æ¡£ä¼šæŒ‚èµ·æ¸²æŸ“ï¼ˆåŠ è½½è§£æžæ¸²æŸ“åŒæ­¥ï¼‰çš„çº¿ç¨‹sï¼Œä¸ä»…è¦ç­‰å¾…æ–‡æ¡£ä¸­jsæ–‡ä»¶åŠ è½½å®Œæ¯•ï¼Œè¿˜è¦ç­‰å¾…è§£æžæ‰§è¡Œå®Œæ¯•ï¼Œæ‰å¯ä»¥æ¢å¤htmlæ–‡æ¡£çš„æ¸²æŸ“çº¿ç¨‹ã€‚å› ä¸ºJSæœ‰å¯èƒ½ä¼šä¿®æ”¹DOMï¼Œæœ€ä¸ºç»å…¸çš„document.writeï¼Œè¿™æ„å‘³ç€ï¼Œåœ¨JSæ‰§è¡Œå®Œæˆå‰ï¼ŒåŽç»­æ‰€æœ‰èµ„æºçš„ä¸‹è½½å¯èƒ½æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œè¿™æ˜¯jsé˜»å¡žåŽç»­èµ„æºä¸‹è½½çš„æ ¹æœ¬åŽŸå› ã€‚æ‰€ä»¥æˆ‘æ˜Žå¹³æ—¶çš„ä»£ç ä¸­ï¼Œjsæ˜¯æ”¾åœ¨htmlæ–‡æ¡£æœ«å°¾çš„ã€‚ JSçš„è§£æžæ˜¯ç”±æµè§ˆå™¨ä¸­çš„JSè§£æžå¼•æ“Žå®Œæˆçš„ï¼Œæ¯”å¦‚è°·æ­Œçš„æ˜¯V8ã€‚JSæ˜¯å•çº¿ç¨‹è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨åŒä¸€ä¸ªæ—¶é—´å†…åªèƒ½åšä¸€ä»¶äº‹ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½éœ€è¦æŽ’é˜Ÿï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸï¼ŒåŽä¸€ä¸ªä»»åŠ¡æ‰èƒ½å¼€å§‹ã€‚ä½†æ˜¯åˆå­˜åœ¨æŸäº›ä»»åŠ¡æ¯”è¾ƒè€—æ—¶ï¼Œå¦‚IOè¯»å†™ç­‰ï¼Œæ‰€ä»¥éœ€è¦ä¸€ç§æœºåˆ¶å¯ä»¥å…ˆæ‰§è¡ŒæŽ’åœ¨åŽé¢çš„ä»»åŠ¡ï¼Œè¿™å°±æ˜¯ï¼šåŒæ­¥ä»»åŠ¡(synchronous)å’Œå¼‚æ­¥ä»»åŠ¡(asynchronous)ã€‚ JSçš„æ‰§è¡Œæœºåˆ¶å°±å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªä¸»çº¿ç¨‹åŠ ä¸Šä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—(task queue)ã€‚åŒæ­¥ä»»åŠ¡å°±æ˜¯æ”¾åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¼‚æ­¥ä»»åŠ¡æ˜¯æ”¾åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚æ‰€æœ‰çš„åŒæ­¥ä»»åŠ¡åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆ;å¼‚æ­¥ä»»åŠ¡æœ‰äº†è¿è¡Œç»“æžœå°±ä¼šåœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­æ”¾ç½®ä¸€ä¸ªäº‹ä»¶ï¼›è„šæœ¬è¿è¡Œæ—¶å…ˆä¾æ¬¡è¿è¡Œæ‰§è¡Œæ ˆï¼Œç„¶åŽä¼šä»Žä»»åŠ¡é˜Ÿåˆ—é‡Œæå–äº‹ä»¶ï¼Œè¿è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸æ–­é‡å¤çš„ï¼Œæ‰€ä»¥åˆå«åšäº‹ä»¶å¾ªçŽ¯(Event loop)ã€‚ æµè§ˆå™¨å‘é€è¯·æ±‚åµŒå…¥HTMLä¸­çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ï¼Œcss,jsç­‰ï¼‰å…¶å®žè¿™ä¸ªæ­¥éª¤å¯ä»¥å¹¶åˆ—åœ¨æ­¥éª¤8ä¸­ï¼Œåœ¨æµè§ˆå™¨æ˜¾ç¤ºHTMLæ—¶ï¼Œå®ƒä¼šæ³¨æ„åˆ°éœ€è¦èŽ·å–å…¶ä»–åœ°å€å†…å®¹çš„æ ‡ç­¾ã€‚è¿™æ—¶ï¼Œæµè§ˆå™¨ä¼šå‘é€ä¸€ä¸ªèŽ·å–è¯·æ±‚æ¥é‡æ–°èŽ·å¾—è¿™äº›æ–‡ä»¶ã€‚æ¯”å¦‚æˆ‘è¦èŽ·å–å¤–å›¾ç‰‡ï¼ŒCSSï¼ŒJSæ–‡ä»¶ç­‰ï¼Œç±»ä¼¼äºŽä¸‹é¢çš„é“¾æŽ¥ï¼š å›¾ç‰‡ï¼šhttp://static.ak.fbcdn.net/rsrc.php/z12E0/hash/8q2anwu7.gif CSSå¼æ ·è¡¨ï¼šhttp://static.ak.fbcdn.net/rsrc.php/z448Z/hash/2plh8s4n.css JavaScript æ–‡ä»¶ï¼šhttp://static.ak.fbcdn.net/rsrc.php/zEMOA/hash/c8yzb6ub.js è¿™äº›åœ°å€éƒ½è¦ç»åŽ†ä¸€ä¸ªå’ŒHTMLè¯»å–ç±»ä¼¼çš„è¿‡ç¨‹ã€‚æ‰€ä»¥æµè§ˆå™¨ä¼šåœ¨DNSä¸­æŸ¥æ‰¾è¿™äº›åŸŸåï¼Œå‘é€è¯·æ±‚ï¼Œé‡å®šå‘ç­‰ç­‰â€¦ ä¸åƒåŠ¨æ€é¡µé¢ï¼Œé™æ€æ–‡ä»¶ä¼šå…è®¸æµè§ˆå™¨å¯¹å…¶è¿›è¡Œç¼“å­˜ã€‚æœ‰çš„æ–‡ä»¶å¯èƒ½ä¼šä¸éœ€è¦ä¸ŽæœåŠ¡å™¨é€šè®¯ï¼Œè€Œä»Žç¼“å­˜ä¸­ç›´æŽ¥è¯»å–ï¼Œæˆ–è€…å¯ä»¥æ”¾åˆ°CDNä¸­\ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>HTTP</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å°é—­äº†å†…å¿ƒå´åŒ…å®¹äº†å¤©ä¸‹ï¼Œé—­åŒ…ä½ å¹¶ä¸å­¤ç‹¬]]></title>
    <url>%2F2018%2F07%2F06%2FJs%2F%E5%B0%81%E9%97%AD%E4%BA%86%E5%86%85%E5%BF%83%E5%8D%B4%E5%8C%85%E5%AE%B9%E4%BA%86%E5%A4%A9%E4%B8%8B%EF%BC%8C%E9%97%AD%E5%8C%85%E4%BD%A0%E5%B9%B6%E4%B8%8D%E5%AD%A4%E7%8B%AC%2F</url>
    <content type="text"><![CDATA[å‰è¨€æœ¬æ–‡ä¹‹æ‰€ä»¥ä¼šå†™è¿™ç§è€ç”Ÿå¸¸è°ˆçš„æ–‡ç« ï¼Œæ˜¯ä¸ºäº†æŽ¥ä¸‹æ¥çš„è®¾è®¡æ¨¡å¼åšé“ºåž«ã€‚æ—¢ç„¶å·²ç»æç¬”äº†ï¼Œå°±æ‰“ç®—ä¸æ”¹äº†ï¼Œç»§ç»­å†™ä¸‹åŽ»ï¼Œç›¸ä¿¡ä¹Ÿä¸€å®šæœ‰å¾ˆå¤šäººå¯¹é—­åŒ…è¿™æ ·çš„æ¦‚å¿µæœ‰äº›æ¨¡ç³Šï¼Œé‚£å°±çž§ä¸€çž§ã€çœ‹ä¸€çœ‹ æ¯•ç«Ÿé—­åŒ…å’Œé«˜é˜¶å‡½æ•°è¿™ä¸¤ç§æ¦‚å¿µï¼Œåœ¨å¼€å‘ä¸­æ˜¯éžå¸¸æœ‰åˆ†é‡çš„ã€‚å¥½å¤„å¤šå¤šï¼Œå¦™å¤„å¤šå¤šï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸å†å…œåœˆå­äº†ï¼Œç›´æŽ¥å¼€å§‹ä»Šå¤©çš„ä¸»é¢˜ï¼Œé—­åŒ…&amp;é«˜é˜¶å‡½æ•° å˜é‡ä½œç”¨åŸŸé¦–å…ˆå˜é‡ä½œç”¨åŸŸåˆ†ä¸ºä¸¤ç±»ï¼šå…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸï¼Œè¿™ä¸ªæ²¡è¯è¯´å¤§å®¶éƒ½æ‡‚ã€‚æˆ‘ä»¬å¸¸è¯´çš„å˜é‡ä½œç”¨åŸŸå…¶å®žä¹Ÿä¸»è¦æ˜¯åœ¨å‡½æ•°ä¸­å£°æ˜Žçš„ä½œç”¨åŸŸ åœ¨å‡½æ•°ä¸­å£°æ˜Žå˜é‡æ—¶æ²¡æœ‰varå…³é”®å­—ï¼Œå°±ä»£è¡¨æ˜¯ å…¨å±€å˜é‡ åœ¨å‡½æ•°ä¸­å£°æ˜Žå˜é‡å¸¦æœ‰varå…³é”®å­—çš„å³æ˜¯ å±€éƒ¨å˜é‡ï¼Œå±€éƒ¨å˜é‡åªèƒ½&lt;åœ¨å‡½æ•°å†…æ‰èƒ½è®¿é—®åˆ°&gt; 123456function fn() &#123; var a = 110; // aä¸ºå±€éƒ¨å˜é‡ console.log(a); // 110&#125;fn();console.log(a); // a is not defined å¤–éƒ¨è®¿é—®ä¸åˆ°å†…éƒ¨çš„å˜é‡ ä¸Šé¢ä»£ç å±•ç¤ºäº†åœ¨å‡½æ•°ä¸­å£°æ˜Žçš„å±€éƒ¨å˜é‡aåœ¨å‡½æ•°å¤–éƒ¨ç¡®å®žæ— æ³•æ‹¿åˆ°ã€‚å°æ ·å„¿çš„è¿˜æŒºåš£å¼ ï¼Œå¯¹äºŽè¿Žéš¾è€Œä¸Šçš„coderæ¥è¯´ï¼Œè¿˜ä¸ä¿¡æ‹¿ä¸ä¸‹aäº† å‡½æ•°å¯ä»¥åˆ›é€ å‡½æ•°ä½œç”¨åŸŸï¼Œåœ¨å‡½æ•°ä½œç”¨åŸŸä¸­å¦‚æžœè¦æŸ¥æ‰¾ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œå¦‚æžœåœ¨è¯¥å‡½æ•°å†…æ²¡æœ‰å£°æ˜Žè¿™ä¸ªå˜é‡ï¼Œå°±ä¼šå‘è¯¥å‡½æ•°çš„å¤–å±‚ç»§ç»­æŸ¥æ‰¾ï¼Œä¸€ç›´æŸ¥åˆ°å…¨å±€å˜é‡ä¸ºæ­¢ æ‰€ä»¥å˜é‡çš„æŸ¥æ‰¾æ˜¯ç”±å†…è€Œå¤–çš„ï¼Œè¿™ä¹Ÿå½¢æˆäº†æ‰€è°“çš„ä½œç”¨åŸŸé“¾ 123456789101112var a = 7;function outer() &#123; var b = 9; function inner() &#123; var c = 8; alert(b); alert(a); &#125; inner(); alert(c); // c is not defined&#125;outer(); // è°ƒç”¨å‡½æ•° åˆ©ç”¨ä½œç”¨åŸŸé“¾ï¼Œæˆ‘ä»¬è¯•ç€åŽ»æ‹¿åˆ°aï¼Œæ”¹é€ ä¸€ä¸‹ fnå‡½æ•° 123456789function fn() &#123; var a = 110; // aä¸ºå±€éƒ¨å˜é‡ return function() &#123; console.log(a); &#125; console.log(a); // 110&#125;var fn2 = fn();fn2(); // 110 å¦‚æ­¤è¿™èˆ¬ï¼Œè¿™èˆ¬å¦‚æ­¤ï¼Œè½»è€Œæ˜“ä¸¾ï¼Œå°caseçš„äº‹ï¼Œå°±å¯ä»¥ä»Žå¤–é¢è®¿é—®åˆ°å±€éƒ¨å˜é‡aäº† é‚£ä¹ˆåˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å‘çŽ°äº†é—­åŒ…çš„å…¶ä¸­ä¸€ä¸ªæ„ä¹‰ï¼šé—­åŒ…å°±æ˜¯èƒ½å¤Ÿè¯»å–å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„å‡½æ•°ï¼Œå—¯ï¼Œæ²¡æ¯›ç—…ï¼Œç»§ç»­å¾€ä¸‹çœ‹ å˜é‡å£°æ˜Žå‘¨æœŸ åœ¨è§£å†³äº†ä¸Šé¢å¦‚ä½•æ‹¿åˆ°å°æ ·å„¿açš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¸å¦¨å†æŠŠå˜é‡ç”Ÿå‘½å‘¨æœŸè¿™ä¸ªæ¦‚å¿µå…ˆç®€å•åœ°è¿‡ä¸€éã€‚ å¯¹äºŽå…¨å±€å˜é‡æ¥è¯´ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸè‡ªç„¶æ˜¯æ°¸ä¹…çš„(forever)ï¼Œé™¤éžæˆ‘ä»¬ä¸é«˜å…´ï¼Œä¸»åŠ¨å¹²æŽ‰å®ƒï¼ŒæŠ¥é”€å®ƒã€‚ è€Œå¯¹äºŽåœ¨å‡½æ•°ä¸­é€šè¿‡varå£°æ˜Žçš„å±€éƒ¨å˜é‡æ¥è¯´ï¼Œå°±æ²¡é‚£ä¹ˆå¹¸è¿äº†ï¼Œå½“å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œå±€éƒ¨å˜é‡ä»¬å°±å¤±åŽ»äº†ä»·å€¼ï¼Œå°±è¢«åžƒåœ¾å›žæ”¶æœºåˆ¶ç»™å½“æˆåžƒåœ¾å¤„ç†æŽ‰äº† æ¯”å¦‚åƒä¸‹é¢è¿™æ ·çš„ä»£ç å°±å¾ˆå¯æ€œ 12345function fn() &#123; var a = 123; // fnæ‰§è¡Œå®Œæ¯•åŽï¼Œå˜é‡aå°±å°†è¢«é”€æ¯äº† console.log(a);&#125;fn(); è™½ç„¶ä»¥ä¸Šåžƒåœ¾å›žæ”¶çš„è¿‡ç¨‹æˆ‘ä»¬æ— æ³•äº²çœ¼çœ‹è§ï¼Œä½†æ˜¯å¬è€…ä¼¤å¿ƒé—»è€…æµæ³ªå•Šã€‚å¯ä¸å¯ä»¥ä¸è¦å¦‚æ­¤æ®‹å¿ï¼Œæˆ‘æ„¿å€¾å…¶æ‰€æœ‰ï¼Œæ¢ä½ ä¸‰ç”Ÿä¸‰ä¸–ã€‚ æ‚²ä¼¤çš„åˆ°æ¥ï¼Œæˆ‘ä»¬æ— æ³•æ‹’ç»ï¼Œé‚£å°±è®©æˆ‘ä»¬æƒ³åŠžæ³•åŽ»æ”¹å˜è¿™ä¸€åˆ‡ã€‚çŽ°åœ¨å†è®©æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™æ®µä»£ç ï¼š 1234567891011function add() &#123; var a = 1; return function() &#123; a++; console.log(a); &#125;&#125;var fn = add();fn(); // 2fn(); // 3fn(); // 4 è¿™æ®µä»£ç æœ€ç¥žå¥‡çš„åœ°æ–¹å°±æ˜¯ï¼Œå½“addå‡½æ•°æ‰§è¡Œå®ŒåŽï¼Œå±€éƒ¨å˜é‡aå¹¶æ²¡æœ‰è¢«é”€æ¯ï¼Œè€Œæ˜¯ä¾ç„¶å­˜åœ¨ï¼Œè¿™å…¶ä¸­åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬æ…¢æ…¢åˆ†æžä¸€ä¸‹ï¼š å½“fn = add()æ—¶ï¼Œfnè¿”å›žäº†ä¸€ä¸ªå‡½æ•°çš„å¼•ç”¨ï¼Œè¿™ä¸ªå‡½æ•°é‡Œæœ‰å±€éƒ¨å˜é‡a æ—¢ç„¶è¿™ä¸ªå±€éƒ¨å˜é‡è¿˜èƒ½è¢«å¤–éƒ¨è®¿é—®fn()ï¼Œå°±æ²¡æœ‰å¿…è¦æŠŠå®ƒç»™é”€æ¯äº†ï¼ŒäºŽæ˜¯å°±ä¿ç•™äº†ä¸‹æ¥ é—­åŒ…æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œå¯ä»¥å®Œæˆå¾ˆå¤šå·¥ä½œï¼Œå…¶ä¸­å°±åŒ…æ‹¬ä¸€é“ç½‘ä¸Šå¸¸è€ƒçš„ç»å…¸é¢˜ç›® 1234567891011121314&lt;ul&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt;&lt;/ul&gt;&lt;script&gt; var aLi = document.getElementsByTagName('li'); for (var i = 0; i &lt; aLi.length; i++) &#123; aLi[i].onclick = function() &#123; console.log(i); // ? &#125;; &#125;&lt;/script&gt; è¿‡è¿™é“é¢˜çš„è§‚ä¼—è¯·ä¸¾æ‰‹ï¼Œç¡®å®žè¿™é“é¢˜çš„ç›®çš„å°±æ˜¯ä¸ºäº†è€ƒå¯¹é—­åŒ…çš„ç†è§£ã€‚ä¸Šé¢çš„ç­”æ¡ˆæ— è®ºæ€Žä¹ˆç‚¹ç»“æžœéƒ½æ˜¯4ã€‚ è¿™æ˜¯å› ä¸ºlièŠ‚ç‚¹çš„onclickäº‹ä»¶å±žäºŽå¼‚æ­¥çš„ï¼Œåœ¨clickè¢«è§¦å‘çš„æ—¶å€™ï¼Œforå¾ªçŽ¯ä»¥è¿…é›·ä¸åŠæŽ©è€³ç›—é“ƒçš„é€Ÿåº¦å°±æ‰§è¡Œå®Œæ¯•äº†ï¼Œæ­¤æ—¶å˜é‡içš„å€¼å·²ç»æ˜¯4äº† å› æ­¤åœ¨liçš„clickäº‹ä»¶å‡½æ•°é¡ºç€ä½œç”¨åŸŸé“¾ä»Žå†…å‘å¤–å¼€å§‹æ‰¾içš„æ—¶å€™ï¼Œå‘çŽ°içš„å€¼å·²ç»å…¨æ˜¯4äº† è§£å†³æ–¹æ³•å°±éœ€è¦é€šè¿‡é—­åŒ…ï¼ŒæŠŠæ¯æ¬¡å¾ªçŽ¯çš„iå€¼éƒ½å­˜ä¸‹æ¥ã€‚ç„¶åŽå½“clickäº‹ä»¶ç»§ç»­é¡ºç€ä½œç”¨åŸŸé“¾æŸ¥æ‰¾çš„æ—¶å€™ï¼Œä¼šå…ˆæ‰¾åˆ°è¢«å­˜ä¸‹æ¥çš„iï¼Œè¿™æ ·æ¯ä¸€ä¸ªliç‚¹å‡»éƒ½å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„iå€¼äº† 12345678910 &lt;script&gt; var aLi = document.getElementsByTagName('li'); for (var i = 0; i &lt; aLi.length; i++) &#123; (function(n) &#123; // nä¸ºå¯¹åº”çš„ç´¢å¼•å€¼ aLi[i].onclick = function() &#123; console.log(n); // 0, 1, 2, 3 &#125;; &#125;)(i); // è¿™é‡Œiæ¯å¾ªçŽ¯ä¸€æ¬¡éƒ½å­˜ä¸€ä¸‹ï¼Œç„¶åŽæŠŠ0,1,2,3ä¼ ç»™ä¸Šé¢çš„å½¢å‚n &#125;&lt;/script&gt; å…¶ä»–ä½œç”¨é—­åŒ…åº”ç”¨éžå¸¸å¹¿æ³›ï¼Œæˆ‘ä»¬è¿™é‡Œå°±è¯´ä¸€ä¸‹å¤§å®¶ç†ŸçŸ¥çš„ï¼Œæ¯”å¦‚å¯ä»¥ å°è£…ç§æœ‰å˜é‡ï¼Œå¯ä»¥æŠŠä¸€äº›ä¸éœ€è¦æš´éœ²åœ¨å…¨å±€çš„å˜é‡å°è£…æˆç§æœ‰å˜é‡ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢é€ æˆå˜é‡çš„å…¨å±€æ±¡æŸ“ 1234567891011121314var sum = (function() &#123; var cache = &#123;&#125;; // å°†cacheæ”¾å…¥å‡½æ•°å†…éƒ¨ï¼Œé¿å…è¢«å…¶ä»–åœ°æ–¹ä¿®æ”¹ return function() &#123; var args = Array.prototype.join.call(arguments, ','); if (args in cache) &#123; return cache[args]; &#125; var a = 0; for (var i = 0; i &lt; arguments.length; i++) &#123; a += arguments[i]; &#125; return cache[args] = a; &#125;&#125;)(); é™¤æ­¤ä¹‹å¤–ç›¸ä¿¡å¾ˆå¤šäººéƒ½è§è¿‡ä¸€äº›åº“å¦‚jQuery,underscoreä»–ä»¬çš„æœ€å¤–å±‚éƒ½æ˜¯ç±»ä¼¼å¦‚ä¸‹æ ·å­çš„ä»£ç  12345678(function(win, undefined) &#123; var a = 1; var obj = &#123;&#125;; obj.fn = function() &#123;&#125;; // æœ€åŽæŠŠæƒ³è¦æš´éœ²å‡ºåŽ»çš„å†…å®¹å¯ä»¥æŒ‚è½½åˆ°windowä¸Š win.obj = obj;&#125;)(window); æ˜¯çš„ï¼Œæ²¡é”™ï¼Œåˆ©ç”¨é—­åŒ…ä¹Ÿå¯ä»¥åšåˆ°æ¨¡å—åŒ–ã€‚å¦å¤–è¿˜å¯ä»¥å°†å˜é‡çš„ä½¿ç”¨å»¶é•¿ï¼Œå†æ¥çœ‹ä¸€ä¸ªä¾‹å­ 12345678910var monitor = (function() &#123; var imgs = []; return function(src)&#123; var img = new Image(); imgs.push(img); img.src = src; &#125;&#125;)();monitor('http://dd.com/srp.gif'); ä¸Šé¢çš„ä»£ç æ˜¯ç”¨äºŽæ‰“ç‚¹è¿›è¡Œç»Ÿè®¡æ•°æ®çš„æƒ…å½¢ï¼Œåœ¨ä¹‹å‰çš„ä¸€äº›æµè§ˆå™¨ä¸­ï¼Œä¼šå‡ºçŽ°æ‰“ç‚¹ä¸¢å¤±çš„æƒ…å†µï¼Œå› ä¸ºimgæ˜¯å‡½æ•°å†…çš„å±€éƒ¨å˜é‡ï¼Œå½“å‡½æ•°æ‰§è¡Œå®ŒåŽimgå°±è¢«é”€æ¯äº†ï¼Œè€Œæ­¤æ—¶å¯èƒ½httpè¯·æ±‚è¿˜æ²¡æœ‰å‘å‡ºã€‚ æ‰€ä»¥é‡åˆ°è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼ŒæŠŠimgå˜é‡ç”¨é—­åŒ…å°è£…èµ·æ¥ï¼Œå°±å¯ä»¥è§£å†³äº† å†…å­˜ç®¡ç†å¾ˆå¤šäººéƒ½å¬è¿‡ä¸€ä¸ªç‰ˆæœ¬ï¼Œå°±æ˜¯é—­åŒ…ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Œæ‰€ä»¥è¦å°½é‡å‡å°‘é—­åŒ…çš„ä½¿ç”¨ Just nowå°±æ¥ä¸ºé—­åŒ…æ¥æ­£åï¼Œä¸æ˜¯ä½ æƒ³è±¡é‚£æ ·çš„ï¼š å±€éƒ¨å˜é‡æœ¬æ¥åº”è¯¥éšç€å‡½æ•°çš„æ‰§è¡Œå®Œæ¯•è¢«é”€æ¯ï¼Œä½†å¦‚æžœå±€éƒ¨å˜é‡è¢«å°è£…åœ¨é—­åŒ…å½¢æˆçš„çŽ¯å¢ƒä¸­ï¼Œé‚£è¿™ä¸ªå±€éƒ¨å˜é‡å°±ä¸€ç›´èƒ½å­˜åœ¨ã€‚ä»Žæˆ‘ä»¬ä¸Šé¢å®žè·µå¾—å‡ºçš„ç»“æžœæ¥çœ‹ï¼Œè¿™è¯è¯´çš„æ²¡æ¯›ç—… Butä¹‹æ‰€ä»¥ä½¿ç”¨é—­åŒ…æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦æŠŠä¸€äº›å˜é‡å­˜èµ·æ¥æ–¹ä¾¿ä»¥åŽä½¿ç”¨ï¼Œè¿™å’Œæ”¾åˆ°å…¨å±€ä¸‹ï¼Œå¯¹å†…å­˜çš„å½±å“æ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸ç®—æ˜¯å†…å­˜æ³„æ¼ã€‚å¦‚æžœåœ¨å°†æ¥æƒ³å›žæ”¶è¿™äº›å˜é‡ï¼Œç›´æŽ¥æŠŠå˜é‡è®¾ä¸ºnullå³å¯äº† è¿˜æœ‰å°±æ˜¯åœ¨ä½¿ç”¨é—­åŒ…çš„åŒæ—¶æ¯”è¾ƒå®¹æ˜“å½¢æˆå¾ªçŽ¯å¼•ç”¨ï¼Œå¦‚æžœé—­åŒ…çš„ä½œç”¨åŸŸé“¾ä¸­ä¿å­˜ç€ä¸€äº›DOMèŠ‚ç‚¹ï¼Œæ­¤æ—¶å°±æœ‰å¯èƒ½é€ æˆå†…å­˜æ³„æ¼ã€‚ä½†è¿™æœ¬èº«å¹¶éžé—­åŒ…çš„é—®é¢˜ï¼Œä¹Ÿå¹¶éžjsçš„é—®é¢˜ è¦æ€ªå°±æ€ªè€ç‰ˆæœ¬çš„IEåŒå¿—å§ï¼Œå®ƒå†…éƒ¨å®žçŽ°çš„åžƒåœ¾å›žæ”¶æœºåˆ¶é‡‡ç”¨çš„æ˜¯å¼•ç”¨è®¡æ•°ç­–ç•¥ã€‚åœ¨è€åŒå¿—IEä¸­ï¼Œå¦‚æžœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å½¢æˆäº†å¾ªçŽ¯å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡éƒ½ä¸èƒ½è¢«å›žæ”¶ï¼Œä½†å¾ªçŽ¯å¼•ç”¨é€ æˆçš„å†…å­˜æ³„æ¼å…¶æœ¬è´¨ä¹Ÿä¸æ˜¯é—­åŒ…çš„é”™ åŒæ ·è¦è§£å†³å¾ªçŽ¯å¼•ç”¨ä»£ç†çš„å†…å­˜æ³„æ¼é—®é¢˜ï¼Œåªéœ€æŠŠå¾ªçŽ¯å¼•ç”¨ä¸­çš„å˜é‡è®¾ä¸ºnullå°±å¥½ ä¸Šé¢å°±æ˜¯æˆ‘ä»¬æ›¿é—­åŒ…çš„æ­£åï¼Œé—­åŒ…ä¹Ÿä¸å®¹æ˜“ï¼Œè¢«äººç”¨è¿˜ä¸è®¨å¥½ã€‚å®ƒæ˜Žç™½ï¼Œä¸æ˜¯å®ƒçš„é”…ï¼Œå®ƒæ˜¯ä¸éœ€è¦èƒŒçš„ï¼ è¿™ä¸æ˜¯ç»ˆç‚¹è™½ç„¶ä¸æ˜¯ç»ˆç‚¹ï¼Œä½†è¿˜æ˜¯è¦æžä¸ªæ€»ç»“æ€§å‘ç‚Žçš„ï¼Œä¸ç„¶æ€Žä¹ˆå¯¹å¾—èµ·æ‰æ¡ƒä½“å…„ é—­åŒ…ï¼š æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè¯»å–å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„å‡½æ•°ï¼Œå®žè´¨ä¸Šæ˜¯å˜é‡çš„è§£æžè¿‡ç¨‹(ç”±å†…è€Œå¤–) å¯ä»¥ç”¨æ¥å°è£…ç§æœ‰å˜é‡ï¼Œå®žçŽ°æ¨¡å—åŒ– å¯ä»¥ä¿å­˜å˜é‡åˆ°å†…å­˜ä¸­ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>é—­åŒ…</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ éœ€è¦äº†è§£çš„23ç§javascriptè®¾è®¡æ¨¡å¼]]></title>
    <url>%2F2018%2F07%2F02%2FJs%2F%E4%BD%A0%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%8423%E7%A7%8Djavascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ä¸ºä»€ä¹ˆè¦å­¦ä¹ è®¾è®¡æ¨¡å¼ï¼Ÿåœ¨è®¸å¤šè®¿è°ˆä¸­ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°å¾ˆå¤šé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„æŽ¥å£ï¼ŒæŠ½è±¡ç±»ï¼Œä»£ç†å’Œä»¥åŠå…¶ä»–ä¸Žè®¾è®¡æ¨¡å¼ç›¸å…³çš„é—®é¢˜ã€‚ ä¸€æ—¦äº†è§£äº†è®¾è®¡æ¨¡å¼ï¼Œå®ƒä¼šè®©ä½ è½»æ¾åº”å¯¹ä»»ä½•è®¿è°ˆï¼Œå¹¶å¯ä»¥åœ¨ä½ çš„é¡¹ç›®ä¸­åº”ç”¨è¿™äº›ç‰¹æ€§ã€‚åœ¨åº”ç”¨ç¨‹åºä¸­å®žçŽ°è®¾è®¡æ¨¡å¼å·²ç»å¾—åˆ°éªŒè¯å’Œæµ‹è¯•ã€‚ ä¸ºäº†ä½¿åº”ç”¨ç¨‹åºå…·æœ‰å¯æ‰©å±•æ€§ï¼Œå¯é æ€§å’Œæ˜“ç»´æŠ¤æ€§ï¼Œåº”è¯¥ç¼–å†™ç¬¦åˆè®¾è®¡æ¨¡å¼çš„ä»£ç ã€‚ ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ è®¾è®¡æ¨¡å¼æ˜¯æˆ‘ä»¬æ¯å¤©ç¼–ç¨‹é‡åˆ°çš„å¯é‡ç”¨è§£å†³æ–¹æ¡ˆã€‚ è®¾è®¡æ¨¡å¼ä¸»è¦æ˜¯ä¸ºäº†è§£å†³å¯¹è±¡çš„ç”Ÿæˆå’Œæ•´åˆé—®é¢˜ã€‚ æ¢å¥è¯è¯´ï¼Œè®¾è®¡æ¨¡å¼å¯ä»¥ä½œä¸ºå¯åº”ç”¨äºŽçŽ°å®žä¸–ç•Œç¼–ç¨‹é—®é¢˜çš„æ¨¡æ¿ã€‚ è®¾è®¡æ¨¡å¼çš„å‘å±•åŽ†å²è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µæ˜¯ç”±å››äººå¸®ï¼ˆã€Šè®¾è®¡æ¨¡å¼ï¼ˆå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ï¼‰ã€‹çš„å››ä½ä½œè€…ï¼‰æå‡ºã€‚ å››äººå¸®æŠŠè¿™æœ¬ä¹¦åˆ†æˆä¸¤éƒ¨åˆ†ï¼š ç¬¬ä¸€éƒ¨åˆ†è§£é‡Šé¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹ã€‚ ç¬¬äºŒéƒ¨åˆ†æ˜¯å…³äºŽ 23 ä¸ªç»å…¸è®¾è®¡æ¨¡å¼çš„æ¼”å˜ã€‚ è‡ªæå‡ºè®¾è®¡æ¨¡å¼æ¦‚å¿µåŽï¼Œå››äººå¸®è®¾è®¡æ¨¡å¼åœ¨è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚ è®¾è®¡æ¨¡å¼åˆ†ç±»æ ¹æ®å®žé™…åº”ç”¨ä¸­é‡åˆ°çš„ä¸åŒé—®é¢˜ï¼Œå››äººå¸®å°†è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰ç§ç±»åž‹ã€‚ åˆ›å»ºåž‹æ¨¡å¼ ç»“æž„åž‹æ¨¡å¼ è¡Œä¸ºåž‹æ¨¡å¼ æŽ¥ä¸‹æ¥å°†æ¦‚è¿°å±žäºŽè¿™ä¸‰ç§ç±»åž‹çš„ 23 ç§è®¾è®¡æ¨¡å¼çš„ä¸»è¦æ¦‚å¿µã€‚ åˆ›å»ºåž‹æ¨¡å¼è¿™ç±»æ¨¡å¼ç”¨äºŽå¯¹è±¡çš„ç”Ÿæˆå’Œç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ã€‚ åˆ›å»ºæ¨¡å¼å¯ä»¥å†³å®šç”Ÿæˆå“ªäº›å¯¹è±¡ï¼Œæé«˜äº†ç¨‹åºçš„çµæ´»æ€§ï¼Œæ¨¡å¼å¦‚ä¸‹ï¼š æŠ½è±¡å·¥åŽ‚æ¨¡å¼ ç”Ÿæˆå™¨æ¨¡å¼ å·¥åŽ‚æ–¹æ³•æ¨¡å¼ å•ä¾‹æ¨¡å¼ åŽŸåž‹æ¨¡å¼ JavaScript æŠ½è±¡å·¥åŽ‚æ¨¡å¼ æŠ½è±¡å·¥åŽ‚æ¨¡å¼ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ å®ƒå°±åƒä¸€ä¸ªå·¥åŽ‚ï¼Œä½†ä¸€åˆ‡è¢«å°é”èµ·æ¥ï¼š æä¾›å¯¹è±¡çš„æ–¹æ³• æž„å»ºå¯¹è±¡çš„å·¥åŽ‚ æœ€ç»ˆçš„å¯¹è±¡ æœ€ç»ˆå¯¹è±¡åŒ…å«ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„å¯¹è±¡ ç­–ç•¥æ¨¡å¼åªæ˜¯ä½¿ç”¨ç»„åˆçš„æ–¹å¼ï¼Œæ¢å¥è¯è¯´ï¼Œå®ƒçš„ç±»å­—æ®µå®žé™…ä¸Šæ˜¯å¯¹è±¡æœ¬èº«ã€‚ æŠ½è±¡å·¥åŽ‚æ¨¡å¼çš„ç”¨å¤„ï¼Ÿ æŠ½è±¡å·¥åŽ‚æ¨¡å¼å¯ä»¥åˆ›å»ºç±»ç°‡ç±»çš„å¯¹è±¡ï¼Œè€Œä¸éœ€è¦æŒ‡å®šå…·ä½“çš„ç±»ï¼Œè¿™ä½¿å¾—æŠ½è±¡å·¥åŽ‚å¾ˆçµæ´»ã€‚ é€šè¿‡æŠ½è±¡å·¥åŽ‚æ¨¡å¼å¯ä»¥å¯¹ä»»ä½•ç±»ç°‡å¯¹è±¡è¿›è¡Œå»ºæ¨¡å¹¶é€šè¿‡ç»Ÿä¸€çš„æŽ¥å£ä¾›å¤–éƒ¨å¯¹è±¡ä½¿ç”¨ã€‚ æŠ½è±¡å·¥åŽ‚å”¯ä¸€ä¸å¥½çš„åœ°æ–¹æ˜¯å®ƒå¯èƒ½å˜å¾—éžå¸¸å¤æ‚ JavaScript çš„ç”Ÿæˆå™¨æ¨¡å¼ï¼ˆBuilder æ¨¡å¼ï¼‰ Builder æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿ Builder æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºŽåˆ›å»ºç”±å…¶ä»–å¯¹è±¡ç»„åˆæž„æˆçš„å¯¹è±¡çš„æ¨¡å¼ã€‚åˆ›å»ºéƒ¨ä»¶çš„æ–¹æ³•åº”è¯¥ç‹¬ç«‹äºŽä¸»å¯¹è±¡ã€‚å¦å¤–ï¼Œä¸ºäº†ä»Žä¸šåŠ¡æ–¹éšè—éƒ¨ä»¶çš„åˆ›å»ºç»†èŠ‚ï¼Œä¸¤è€…æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ åœ¨ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼æ—¶ï¼Œç”Ÿæˆå™¨çŸ¥é“æ‰€æœ‰çš„ç»†èŠ‚ï¼Œä¸”åˆ›å»ºç»†èŠ‚å®Œå…¨å¯¹å…¶ä»–ç›¸å…³ç±»å±è”½ã€‚ JavaScript å·¥åŽ‚æ–¹æ³•æ¨¡å¼ ä»€ä¹ˆæ˜¯å·¥åŽ‚æ–¹æ³•æ¨¡å¼ï¼Ÿ æ ¹æ®å®šä¹‰ï¼Œåªè¦æƒ³ä¸€ä¸ªæ–¹æ³•è¿”å›žå…¬å…±è¶…ç±»çš„å‡ ä¸ªå¯èƒ½çš„ç±»ä¸­çš„ä¸€ä¸ªï¼Œå°±å¯ä»¥ä½¿ç”¨å·¥åŽ‚æ¨¡å¼ã€‚ å‡è®¾æˆ‘æƒ³éšæœºå‘å±å¹•ä¸Šå°„å‡»æ•Œäººã€‚é‚£ä¹ˆå¦‚æžœæ‰€æœ‰ä¸œè¥¿éƒ½ç¡¬ç¼–ç å¥½äº†ï¼Œå¹¶ä¸”ä¸çŸ¥é“æ•Œäººçš„å…·ä½“ç±»åž‹ä¼šè®©å¤„ç†å˜å¾—å¾ˆå›°éš¾ã€‚ ä½†æ˜¯ï¼Œå‡è®¾æˆ‘åˆ›å»ºäº†ä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œæ¯ä¸ªå¯èƒ½çš„æ•Œäººç±»éƒ½ç”±ä¸€ä¸ªæ•°å­—ä»£æ›¿ï¼Œå¹¶å¯ä»¥ç”±è¯¥éšæœºæ•°ç”Ÿæˆå™¨è¿”å›žã€‚ ç„¶åŽå¯ä»¥å°†è¿™ä¸ªæ•°å­—å‘é€ç»™å·¥åŽ‚å¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥è¿”å›žä¸€ä¸ªåŠ¨æ€åˆ›å»ºçš„æ•Œäººã€‚ æ‰€ä»¥ï¼ŒMOL çš„ä¸»è¦æ¦‚å¿µéžå¸¸é‡è¦ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶é€‰æ‹©ç±»ï¼Œè¿™å°±æ˜¯å·¥åŽ‚æ¨¡å¼èƒ½å¤Ÿæä¾›çš„ã€‚ ä½•æ—¶ä½¿ç”¨å·¥åŽ‚æ¨¡å¼ å½“ä¸çŸ¥é“éœ€è¦ä½•ç§ç±»åž‹çš„å¯¹è±¡æ—¶å¯ä»¥ä½¿ç”¨å·¥åŽ‚æ–¹æ³•æ¨¡å¼ã€‚ ä½†æ˜¯ï¼Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œç¡®ä¿æ‰€æœ‰æ½œåœ¨çš„ç±»éƒ½å…·æœ‰ç›¸åŒçš„å­ç±»å±‚æ¬¡ç»“æž„ï¼Œè¿™æ„å‘³ç€åœ¨ç»§æ‰¿è·¯å¾„ä¸Šæœ‰ç›¸åŒçš„çˆ¶ç±»ã€‚ å¯ä»¥ä½¿ç”¨å·¥åŽ‚æ¨¡å¼æ¥é›†ä¸­ç±»åˆ«é€‰æ‹©çš„ä»£ç ã€‚æˆ–æ˜¯ä¸å¸Œæœ›ç”¨æˆ·çŸ¥é“æ¯ä¸€ä¸ªå¯èƒ½çš„å­ç±»æ—¶ã€‚ JavaScript å•ä¾‹æ¨¡å¼ ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ å½“æƒ³è¦é¿å…å®žä¾‹åŒ–å¤šä¸ªå¯¹è±¡æ—¶ä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚å•ä¾‹ä½¿å¾—åªèƒ½ä»Žç±»å®žä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ã€‚ çŽ°åœ¨ä½ å¯èƒ½ä¼šé—®è‡ªå·±ï¼Œæˆ‘ä»€ä¹ˆæ—¶å€™ä¼šæƒ³è¦è¿™æ ·åšï¼Ÿ å…¶å®žï¼Œæœ‰å¾ˆå¤šåœºæ™¯ã€‚ æˆ‘ä»¬å·²ç»æ¼”ç¤ºè¿‡æ‹¼å­—æ¸¸æˆé‡Œä½¿ç”¨ä¸€ä¸ªç±»å®¹çº³æ‰€æœ‰å¯èƒ½çš„å­—æ¯ï¼Œå¹¶ä¸”æ‹¼å­—æ¸¸æˆæ˜¯ä¸€æ¬¾éžå¸¸å¸¸è§çš„æ£‹ç›˜æ¸¸æˆï¼Œè¿™é‡Œä½¿ç”¨å•ä¾‹æ¨¡å¼æ˜¯å¾ˆæ˜Žæ™ºçš„é€‰æ‹©ã€‚ è¿™ä¸ªå•ä¾‹ç±»åŒ…å«æ‰€æœ‰å¯èƒ½çš„æ‹¼å­—æ¸¸æˆå­—æ¯ï¼Œä»¥ä¾¿çŽ©å®¶å¯ä»¥ä½¿ç”¨è¿™ä¸ªå•ä¾‹ç±»å–å¾—æ‰€æœ‰å­—æ¯ï¼Œä¸åŒçŽ©å®¶å¯ä»¥åŒæ—¶è¯·æ±‚èŽ·å–ã€‚ å•ä¾‹ä½¿å¾—æ¯ä¸ªçŽ©å®¶éƒ½å…±äº«ç›¸åŒçš„å­—æ¯åˆ—è¡¨ï¼Œæ¯ä¸ªçŽ©å®¶å¯ä»¥æ ¹æ®è¿™ä¸ªå­—æ¯åˆ—è¡¨æ¥æ‹¼æŽ¥è‡ªå·±çš„å•è¯ã€‚ Javascript åŽŸåž‹æ¨¡å¼ ä»€ä¹ˆæ˜¯åŽŸåž‹æ¨¡å¼ï¼Ÿ å½“æƒ³è¦é€šè¿‡å…‹éš†æˆ–æ‹·è´å¯¹è±¡æ¥ç”Ÿæˆå¯¹è±¡æ—¶ï¼Œè¿™å°±æ˜¯åŽŸåž‹æ¨¡å¼ã€‚ é€šè¿‡åŽŸåž‹æ¨¡å¼å¯ä»¥åœ¨è¿è¡Œæ—¶æ·»åŠ å·²çŸ¥çˆ¶ç±»çš„å­ç±»å®žä¾‹ã€‚ å½“æœ‰è®¸å¤šç±»åªåœ¨è¿è¡Œæ—¶éœ€è¦ä½¿ç”¨æ—¶å¯ä»¥ä½¿ç”¨åŽŸåž‹æ¨¡å¼ã€‚åŽŸåž‹æ¨¡å¼çš„å¥½å¤„ä¹‹ä¸€æ˜¯å‡å°‘äº†åˆ›å»ºå¤šä¸ªå­ç±»ã€‚ ç»“æž„åž‹æ¨¡å¼ è¿™ç±»æ¨¡å¼æè¿°äº†å‘çŽ°æœ‰å¯¹è±¡æ·»åŠ åŠŸèƒ½çš„ä¸åŒæ–¹å¼ç®€å•åœ°è¯´ï¼Œè¿™ä¸ªæ¨¡å¼ç€é‡äºŽè§£è€¦å¯¹è±¡çš„æŽ¥å£å®žçŽ°æ¨¡å¼å¦‚ä¸‹ï¼š é€‚é…å™¨æ¨¡å¼ æ¡¥æŽ¥æ¨¡å¼ ç»„åˆæ¨¡å¼ è£…é¥°è€…æ¨¡å¼ å¤–è§‚æ¨¡å¼ äº«å…ƒæ¨¡å¼ ä»£ç†æ¨¡å¼ JavaScript é€‚é…å™¨è®¾è®¡æ¨¡å¼ é€‚é…å™¨æ¨¡å¼çš„ä½œç”¨ é€‚é…å™¨è®¾è®¡æ¨¡å¼å…è®¸ä½¿ç”¨ä¸¤ä¸ªå®Œå…¨ä¸å…¼å®¹çš„æŽ¥å£ä¸€èµ·å·¥ä½œï¼Œæ­£å¦‚å…¶åå­—ä¸€æ ·ï¼Œé€‚é…ä¸åŒæŽ¥å£ã€‚ å‡è®¾ä½ å¢™ä¸Šçš„æ’åº§åªæœ‰ä¸¤åº§æ’å¤´ï¼Œä½†æ˜¯ä½ æƒ³è¿žæŽ¥ä¸€ä¸ªä¸‰åº§çš„æ’å¤´ï¼Œè¿™æ—¶å°±éœ€è¦é€‚é…å™¨äº†ã€‚ å½“å®¢æˆ·æœŸæœ›ä½¿ç”¨ç›®æ ‡æŽ¥å£æ˜¯ä¸¤åº§æ’å¤´ï¼Œä½†æ˜¯ä½ åªæœ‰ä¸‰åº§æ’å¤´ï¼Œè¿™å°±æ˜¯é€‚é…å™¨å°†è¦æ‰§è¡Œçš„æ“ä½œ æŠŠä¸‰åº§è½¬æ¢æˆä¸¤åº§ã€‚ é€‚é…å™¨æ¨¡å¼å…è®¸ä½¿ç”¨ä»»ä½•çŽ°æœ‰æŽ¥å£é€‚é…ä¸ºç›®æ ‡æŽ¥å£ã€‚ ä»Žå¦ä¸€ä¸ªè§’åº¦çœ‹ä»»ä½•ç±»éƒ½å¯ä»¥ååŒå·¥ä½œåªè¦é€‚é…å™¨è§£å†³äº†æ‰€æœ‰ç±»éƒ½å¿…é¡»å®žçŽ°ç›¸åŒæŽ¥å£çš„é—®é¢˜ã€‚ Javascript æ¡¥æŽ¥æ¨¡å¼ ä»€ä¹ˆæ˜¯æ¡¥æŽ¥æ¨¡å¼ å®˜æ–¹å®šä¹‰æ˜¯å°†æŠ½è±¡ä¸Žå…¶å®žçŽ°åˆ†ç¦»å¼€æ¥ï¼Œå› æ­¤ä¸¤è€…å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚ è¯¥æ¨¡å¼ç”¨äºŽå°†æŠ½è±¡ä¸Žå…¶å®žçŽ°åˆ†å¼€ï¼Œä»¥ä¾¿ä¸¤è€…éƒ½å¯ä»¥ç‹¬ç«‹ä¿®æ”¹ã€‚è¯¥æ¨¡å¼åŒ…å«ä¸€ä¸ªç”¨äºŽæ¡¥æŽ¥æŠ½è±¡ç±»å’Œå®žçŽ°ç±»çš„æŽ¥å£ã€‚é€šè¿‡æ¡¥æŽ¥æ¨¡å¼ï¼Œä¸¤ç§ç±»åž‹éƒ½å¯ä»¥ä¿®æ”¹è€Œä¸ä¼šç›¸äº’å½±å“ã€‚ æ¡¥æŽ¥æ¨¡å¼å®žçŽ°æŒ‡å— å½“æƒ³è¦é¿å…æŠ½è±¡ä¸Žå…¶å®žçŽ°ä¹‹é—´çš„æ°¸ä¹…ç»‘å®šæ—¶å¯ä»¥ä½¿ç”¨æ¡¥æŽ¥æ¨¡å¼ã€‚ æŠ½è±¡å’Œå®ƒä»¬çš„å®žçŽ°éƒ½åº”è¯¥å¯ä»¥é€šè¿‡å­ç±»è¿›è¡Œæ‰©å±•ã€‚å½“æŠ½è±¡çš„å®žçŽ°æœ‰å˜åŒ–æ—¶ä¸åº”è¯¥å½±å“åˆ°è°ƒç”¨æ–¹ï¼ŒåŠè°ƒç”¨æ–¹ä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚ å½“éœ€è¦åœ¨å¤šä¸ªå¯¹è±¡ä¹‹é—´å…±äº«ä¸€ä¸ªå®žçŽ°æ—¶ï¼Œå¯ä»¥é€‰æ‹©è¿™ç§æ¨¡å¼ã€‚ æœ€åŽæˆ‘ä»¬å¸Œæœ›å®Œå…¨å¯¹è°ƒç”¨æ–¹éšè—æŠ½è±¡çš„å®žçŽ°ã€‚ JavaScript ç»„åˆæ¨¡å¼ç»„åˆæ¨¡å¼ä»Žå®šä¹‰ä¸Šçœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œä¸€æ—¦ç”¨èµ·æ¥å°±ä¼šæ„Ÿè§‰å¾ˆåˆç†ã€‚ å®ƒå…è®¸ç»Ÿä¸€å¤„ç†å•ä¸ªå¯¹è±¡å’Œå¯¹è±¡ç»„åˆï¼Œè¿™æ˜¯ç»„åˆè®¾è®¡æ¨¡å¼çš„å…¸åž‹å®šä¹‰ã€‚ ç»„åˆæ¨¡å¼å¯ä»¥è¡¨ç¤ºä¸ºéƒ¨åˆ† - æ•´ä½“çš„å±‚æ¬¡ç»“æž„ã€‚è¯¥ç»“æž„çš„ç»„ä»¶åˆå¯ä»¥åˆ’åˆ†ä¸ºæ›´å°çš„ç»„ä»¶ã€‚ ä¸€ä¸ªæ›´åˆä¹Žé€»è¾‘çš„å®šä¹‰æ˜¯ç»„åˆè®¾è®¡æ¨¡å¼æ˜¯ç”¨æ¥ç»“æž„åŒ–æ•°æ®æˆ–å•ç‹¬è¡¨ç¤ºæ•´ä¸ªå¯¹è±¡çš„æ¯ä¸ªéƒ¨åˆ†çš„äº’ç›¸æ“ä½œã€‚ JavaScript è£…é¥°æ¨¡å¼ ä»€ä¹ˆæ˜¯è£…é¥°æ¨¡å¼ï¼Ÿ åŠ¨æ€çš„ä¸ºä¸€ä¸ªå¯¹è±¡é™„åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œè£…é¥°æ¨¡å¼å¯ä»¥ä¸é€šè¿‡ç»§æ‰¿æ¥å®žçŽ°åŠŸèƒ½æ‰©å±•ã€‚ è¿™ç§æ¨¡å¼å±žäºŽç»“æž„è®¾è®¡æ¨¡å¼ç±»åˆ«ï¼Œä¹Ÿè¢«ç§°ä¸ºåŒ…è£…æ¨¡å¼ï¼Œè£…é¥°è®¾è®¡æ¨¡å¼è§£å†³äº†åœ¨ä¸æ”¹å˜å¯¹è±¡çŽ°æœ‰ç»“æž„çš„æƒ…å†µä¸‹æ·»åŠ é™„åŠ åŠŸèƒ½çš„é—®é¢˜ã€‚ å¦å¤–ï¼Œè¯¥æ¨¡å¼åˆ›å»ºäº†ä¸€ä¸ªè£…é¥°å™¨ç±»ï¼Œå®ƒåŒ…è£…åŽŸå§‹ç±»å¹¶åœ¨è¿è¡Œæ—¶å‘å¯¹è±¡æ·»åŠ æ–°çš„è¡Œä¸ºæˆ–æ“ä½œã€‚ è£…é¥°æ¨¡å¼çš„å®žçŽ°æŒ‡å— å½“é€‰æ‹©è¿™ç§æ¨¡å¼æ—¶ï¼Œéœ€è¦åŠ¨æ€åœ°å‘å•ä¸ªå¯¹è±¡æ·»åŠ æ–°çš„åŠŸèƒ½ï¼Œå¹¶ä¸”è€Œä¸ä¼šå½±å“å…¶ä»–å¯¹è±¡ã€‚ ä¾‹å¦‚ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œä¸ºåŽŸæœ‰ä»£ç æ·»åŠ æ–°çš„åŠŸèƒ½å¯èƒ½ä¼šå¾ˆå›°éš¾ï¼Œç”¨ä¿®é¥°å™¨ä¿®æ”¹ä»£ç ä¼šæ›´å®¹æ˜“äº›ã€‚ é€šè¿‡ç»§æ‰¿æ¥å®žçŽ°åŠŸèƒ½æ‰©å±•ä¼šäº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œå¹¶ä¸”æœ‰å¯èƒ½è¿™äº›å­ç±»è¿˜ä¸è¶³ä»¥è¦†ç›–æ‰€æœ‰éœ€è¦æ‰©å±•çš„åŠŸèƒ½ã€‚ å½“æ— æ³•æŸ¥çœ‹ç±»å®šä¹‰æˆ–æ— æ³•ç»§æ‰¿æ—¶ï¼Œéœ€è¦é€‰æ‹©è£…é¥°æ¨¡å¼ã€‚ ä¾‹å¦‚ï¼Œå°½ç®¡ç±»è¢«å°è£…èµ·æ¥æ— æ³•ä¿®æ”¹ï¼Œé€šè¿‡è£…é¥°æ¨¡å¼ä»ç„¶å¯ä»¥è¿›è¡Œæ‰©å±•ï¼Œå¹¶ä¸”ï¼Œæˆ‘ç›¸ä¿¡ä½ è‚¯å®šä¹Ÿé‡åˆ°è¿‡æ— æ³•é€šè¿‡ç»§æ‰¿æ¥å®žçŽ°åŠŸèƒ½æ‰©å±•çš„æƒ…å†µï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œé€‰æ‹©è£…é¥°æ¨¡å¼ã€‚ Javascript å¤–è§‚æ¨¡å¼ ä»€ä¹ˆæ˜¯å¤–è§‚æ¨¡å¼ï¼Ÿ ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æŽ¥å£æä¾›ç»Ÿä¸€æŽ¥å£ã€‚å¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªæ›´é«˜å±‚æ¬¡çš„æŽ¥å£ï¼Œä½¿å­ç³»ç»Ÿæ›´æ˜“äºŽä½¿ç”¨ã€‚æœ¯è¯­å¤–è§‚æ¥è‡ªæ³•è¯­ faÃ§adeï¼Œæ„æ€æ˜¯æ­£é¢æˆ–è„¸ã€‚ ç®€å•æ¥è¯´æ˜¯å¤–è§‚æ¨¡å¼éšè—äº†å­ç³»ç»Ÿçš„å®žçŽ°å¤æ‚æ€§ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç®€æ´çš„æŽ¥å£ã€‚è¯¥æŽ¥å£è´Ÿè´£è°ƒç”¨çŽ°æœ‰å­ç³»ç»Ÿçš„åŠŸèƒ½ å¤–è§‚æ¨¡å¼å®žçŽ°æŒ‡å— å½“æˆ‘ä»¬æƒ³ä¸ºå­ç³»ç»Ÿæä¾›ä¸€ä¸ªç®€å•çš„æŽ¥å£æ—¶éœ€è¦ä½¿ç”¨å¤–è§‚æ¨¡å¼ã€‚éšç€å­ç³»ç»Ÿçš„å‘å±•ï¼Œå­ç³»ç»Ÿå¾€å¾€ä¼šå˜å¾—æ›´åŠ å¤æ‚ã€‚ å½“æˆ‘ä»¬åœ¨åº”ç”¨ä¸€äº›æ¨¡å¼æ—¶ï¼Œå¤§å¤šæ•°æ¨¡å¼ä¼šå¯¼è‡´æ›´å¤šçš„ç±»åˆ›å»ºå‡ºæ¥ï¼Œè¿™ä½¿å¾—å­ç³»ç»Ÿå¯ç”¨æ€§æ›´å¥½ï¼Œæ›´å®¹æ˜“è‡ªå®šä¹‰éœ€è¦çš„åŠŸèƒ½ï¼Œä½†å¯¹äºŽä¸å¤ªéœ€è¦è‡ªå®šä¹‰çš„ä¸šåŠ¡æ–¹è€Œè¨€ï¼Œå®ƒä¹Ÿå˜å¾—æ›´åŠ å›°éš¾ã€‚ å¤–è§‚æ¨¡å¼å°†å­ç³»ç»ŸåŒ…è£…æˆä¸€ä¸ªç®€å•é»˜è®¤çš„æŽ¥å£ï¼Œè¶³ä»¥åº”ä»˜å¤§å¤šæ•°æƒ…å†µçš„ä½¿ç”¨ã€‚ å¦å¤–ï¼Œå½“ä¸šåŠ¡æ–¹å’Œå­ç³»ç»Ÿçš„å®žçŽ°å­˜åœ¨è¿‡å¤šä¾èµ–æ—¶ä¹Ÿå¯ä»¥é€‰æ‹©å¤–è§‚æ¨¡å¼ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤–è§‚æ¨¡å¼å°†å­ç³»ç»Ÿä»Žä¸šåŠ¡æ–¹å’Œå…¶ä»–å­ç³»ç»Ÿä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä»Žè€Œæé«˜å­ç³»ç»Ÿçš„ç‹¬ç«‹æ€§å’Œå¯ç§»æ¤æ€§ã€‚ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¦‚æžœå­ç³»ç»Ÿè¿‡äºŽè€¦åˆï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å¤–è§‚æ¨¡å¼æä¾›çš„æŽ¥å£æ¥ç®€åŒ–å­ç³»ç»Ÿä¹‹é—´çš„ä¾èµ–ã€‚ JavaScript äº«å…ƒæ¨¡å¼å½“éœ€è¦åˆ›å»ºå¤§é‡ç›¸ä¼¼å¯¹è±¡æ—¶éœ€è¦ä½¿ç”¨äº«å…ƒæ¨¡å¼ï¼Œè¿™é‡Œçš„å¤§é‡æ˜¯ä¸Šä¸‡çš„é‡çº§è€Œä¸æ˜¯å¹³æ—¶æŽ¥è§¦çš„ä¸Šç™¾ã€‚ äº«å…ƒæ¨¡å¼é€šè¿‡ å…±äº«å¯¹è±¡çš„ç›¸ä¼¼éƒ¨åˆ†ï¼Œé¿å…é‡å¤åˆ›å»ºï¼Œæ¥è¾¾åˆ°å‡å°å†…å­˜çš„ä½¿ç”¨ã€‚ JavaScript ä»£ç†æ¨¡å¼ ä»€ä¹ˆæ˜¯ä»£ç†è®¾è®¡æ¨¡å¼ï¼Ÿ ä»£ç†æ˜¯ä¸€ä¸ª å°†è¢«ç”¨æ¥é™åˆ¶è®¿é—®å¦ä¸€ä¸ªç±»çš„ç±»ã€‚ è¿™å¯èƒ½æ˜¯å‡ºäºŽå®‰å…¨çš„è€ƒè™‘ï¼Œé€šè¿‡ä»£ç†æ¥å†³å®šéœ€è¦ä»£ç†çš„å¯¹è±¡å“ªäº›æ–¹æ³•æ˜¯å¯ç”¨çš„ã€‚ è¡Œä¸ºåž‹æ¨¡å¼è¿™ç±»æ¨¡å¼æè¿°äº†å¯¹è±¡å¦‚ä½•ç›¸äº’ä½œç”¨ï¼Œæ¨¡å¼å¦‚ä¸‹ï¼š è´£ä»»é“¾æ¨¡å¼ å‘½ä»¤æ¨¡å¼ è§£é‡Šå™¨æ¨¡å¼ è¿­ä»£å™¨æ¨¡å¼ ä¸­ä»‹è€…æ¨¡å¼ å¤‡å¿˜å½•æ¨¡å¼ è§‚å¯Ÿè€…æ¨¡å¼ çŠ¶æ€æ¨¡å¼ ç­–ç•¥æ¨¡å¼ æ¨¡æ¿æ–¹æ³•æ¨¡å¼ è®¿é—®è€…æ¨¡å¼ JavaScript è´£ä»»é“¾æ¨¡å¼è´£ä»»é“¾æ¨¡å¼æœ‰ä¸€ç»„å¯¹è±¡ï¼ŒæœŸæœ›å®ƒä»¬ä¹‹é—´èƒ½å¤Ÿè§£å†³é—®é¢˜ï¼Œå¦‚æžœç¬¬ä¸€ä¸ªå¯¹è±¡æ— æ³•è§£å†³å®ƒï¼Œåˆ™å°†æ•°æ®ä¼ é€’ç»™è´£ä»»é“¾ä¸­çš„ä¸‹ä¸€ä¸ªæ•°æ®ã€‚ é€šè¿‡å¤šä¸ªæŽ¥æ”¶è€…å¯¹è±¡æ¥å¤„ç†è¯·æ±‚ï¼Œé¿å…å°†è¯·æ±‚çš„å‘é€è€…è€¦åˆåˆ°å…¶æŽ¥æ”¶è€…ã€‚å°†æŽ¥æ”¶å¯¹è±¡ä¸²è”èµ·æ¥ï¼Œä¼ é€’è¯·æ±‚ç›´åˆ°è¢«å…¶ä¸­ä¸€ä¸ªå¤„ç†æŽ‰ã€‚ è´£ä»»é“¾æ¨¡å¼ä¸º è¯·æ±‚åˆ›å»ºä¸€ç³»åˆ—æŽ¥æ”¶è€…å¯¹è±¡ã€‚ åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œé€šå¸¸æ¯ä¸ªæŽ¥æ”¶å™¨éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæŽ¥æ”¶å™¨çš„å¼•ç”¨ã€‚ å¦‚æžœä¸€ä¸ªæŽ¥æ”¶è€…ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œåˆ™å®ƒå°†è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæŽ¥å—è€…ã€‚ JavaScript å‘½ä»¤æ¨¡å¼ ä»€ä¹ˆæ˜¯å‘½ä»¤æ¨¡å¼ï¼Ÿ å‘½ä»¤è®¾è®¡æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œå…¶å¯¹è±¡ç”¨äºŽè¡¨ç¤ºå’Œå°è£…ç¨åŽè°ƒç”¨æŸä¸ªæ–¹æ³•æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯åŒ…æ‹¬æ–¹æ³•åç§°ï¼Œæ‹¥æœ‰æ–¹æ³•çš„å¯¹è±¡å’Œæ–¹æ³•å‚æ•°çš„å€¼ã€‚ åŸºæœ¬ä¸Šï¼Œå®ƒå…è®¸ä½ åšçš„æ˜¯å­˜å‚¨ä»£ç æ¸…å•ï¼Œåœ¨ç¨åŽæˆ–å¤šæ¬¡æ‰§è¡Œï¼Œå¹¶ä¸”é€šå¸¸ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯ä»¥æ’¤é”€å‘½ä»¤ã€‚ å½“è¿™äº›å°è£…çš„å¯¹è±¡è°ƒç”¨ execute() æ–¹æ³•ï¼Œä¸šåŠ¡æ–¹æˆ–ç¨‹åºä¼šæ‰§è¡ŒæŒ‡å®šå‘½ä»¤æˆ–ä¸€æ®µä»£ç ã€‚ ç„¶åŽï¼Œè°ƒç”¨è€…å¯¹è±¡åœ¨è°ƒç”¨æ—¶ä¼šä¼ é€’å‘½ä»¤ç»™å‘½ä»¤æŽ¥æ”¶è€…ï¼Œå‘½ä»¤æŽ¥æ”¶è€…æ‹¥æœ‰å®žé™…æƒ³è¦æ‰§è¡Œçš„ä»£ç ï¼Œä¸€æ—¦ä»Žè°ƒç”¨è€…æŽ¥æ”¶åˆ°å‘½ä»¤å°±ç«‹é©¬æ‰§è¡Œã€‚ ä¾‹å¦‚æœ‰ä¸ªâ€TurnTVOnâ€çš„å‘½ä»¤å¯¹è±¡ï¼Œç„¶åŽä¸€ä¸ªâ€œDeviceButtonâ€çš„å¯¹è±¡ï¼Œä¸€æ—¦â€DeviceButtonâ€å¯¹è±¡è¢«è°ƒç”¨å°±ä¼šå‘é€â€TurnTVOnâ€å‘½ä»¤ã€‚æ‰€æœ‰è¿™äº›ä¹‹é—´çš„æŽ¥å£å¯ä»¥ä½¿ç”¨å¤šæ€ï¼Œæ‰€ä»¥æ— è®ºä½•æ—¶è°ƒç”¨ TurnTVOnï¼Œè¯¥æ–¹æ³•å°†ç”±å‘½ä»¤æŽ¥æ”¶è€…æ‰§è¡Œã€‚ JavaScript è§£é‡Šå™¨æ¨¡å¼ ä»€ä¹ˆæ˜¯è§£é‡Šå™¨æ¨¡å¼ è§£é‡Šå™¨æ¨¡å¼å¾ˆå®¹æ˜“è¢«å¿½ç•¥ï¼Œå¹¶ä¸”ç½‘ä¸Šå¾ˆå°‘æœ‰ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚ ä½†æ˜¯ï¼Œå¦‚æžœä¸Ž JavaScript åå°„æŠ€æœ¯ç»“åˆä½¿ç”¨ï¼Œä¼šå˜å¾—éžå¸¸æœ‰ç”¨ã€‚å®ƒç”¨äºŽå°†æ•°æ®çš„ä¸€ç§è¡¨ç¤ºè½¬æ¢ä¸ºå¦ä¸€ç§è¡¨ç¤ºã€‚ JavaScript è¿­ä»£å™¨æ¨¡å¼ ä»€ä¹ˆæ˜¯è¿­ä»£å™¨æ¨¡å¼ï¼Ÿ è¿­ä»£å™¨æ¨¡å¼æä¾›ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼æ¥è®¿é—®ä¸åŒç±»åž‹çš„å¯¹è±¡é›†åˆã€‚ ä¾‹å¦‚ï¼ŒArrayï¼ŒArrayList å’Œ HashTableï¼Œè¿™ä¸‰ä¸ªé›†åˆåŒ…å«ç›¸åŒç±»åž‹çš„å¯¹è±¡ï¼Œé€šè¿‡è¿­ä»£å™¨å¯ä»¥å–åˆ°é›†åˆé‡Œçš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶åšç›¸åŒçš„å¤„ç†ã€‚ è¿­ä»£å™¨æ¨¡å¼åšçš„æ˜¯æä¾›ç»Ÿä¸€çš„æ–¹å¼æ¥å¾ªçŽ¯éåŽ†è¿™äº›ä¸åŒç±»åž‹çš„é›†åˆã€‚ JavaScript ä¸­ä»‹è€…è®¡æ¨¡å¼ ä»€ä¹ˆæ˜¯ä¸­ä»‹è€…æ¨¡å¼ï¼Ÿ ç”¨äºŽå¤„ç†ç›¸å…³å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ã€‚æ‰€æœ‰é€šä¿¡ç”±ä¸­ä»‹è€…å®Œæˆï¼Œé€šä¿¡åŒæ–¹ä¸éœ€è¦äº†è§£å¯¹æ–¹çš„ä»»ä½•ä¿¡æ¯ã€‚ æ›´ä¸¥æ ¼çš„å®šä¹‰æ˜¯ï¼Œä¸­ä»‹è€…æ¨¡å¼å…è®¸é€šè¿‡å°è£…ä¸åŒå¯¹è±¡ä¹‹é—´ç›¸äº’ä½œç”¨å’Œç›¸äº’é€šä¿¡çš„æ–¹å¼æ¥å®žçŽ°æ¾è€¦åˆï¼Œå¹¶ä¸”ä¸­ä»‹è€…æ¨¡å¼å…è®¸æ¯ä¸ªå¯¹è±¡çš„è¡Œä¸ºå½¼æ­¤ç‹¬ç«‹åœ°å˜åŒ–ã€‚ Javascript å¤‡å¿˜å½•æ¨¡å¼ ä»€ä¹ˆæ˜¯å¤‡å¿˜å½•æ¨¡å¼ï¼Ÿ ç”¨äºŽå­˜å‚¨å¯¹è±¡ä»¥å‰çŠ¶æ€çš„æ¨¡å¼ï¼Œé¦–å…ˆï¼Œå¤‡å¿˜å½•æ¨¡å¼éœ€è¦ä¸€ä¸ªå¤‡å¿˜å½•å¯¹è±¡ç”¨äºŽå­˜å‚¨å¯¹è±¡çš„ä¸åŒçŠ¶æ€ï¼Œä¸åŒçš„çŠ¶æ€åŠä¸€äº›å­—æ®µæ‹¥æœ‰ä¸åŒçš„å€¼ã€‚ ç„¶åŽï¼Œç”¨äºŽä»Žå½“å‰ç›®æ ‡å¤‡å¿˜å½•å¯¹è±¡è¯»å†™å€¼çš„åˆå§‹å¯¹è±¡ï¼Œåˆ›å»ºæ–°çš„å¤‡å¿˜å½•å¯¹è±¡å¹¶èµ‹å€¼ç»™å½“å‰å¤‡å¿˜å½•å¯¹è±¡ã€‚ æœ€åŽï¼Œå†…éƒ¨æ˜¯ä¸€ä¸ª ArrayList å¯¹è±¡ç”¨äºŽæŒæœ‰ä¹‹å‰æ‰€æœ‰çš„å¤‡å¿˜å½•å¯¹è±¡ï¼Œè¯¥ ArrayList å¯¹è±¡åŒæ—¶ç”¨äºŽå­˜å‚¨å’Œæ£€ç´¢å¤‡å¿˜å½•å¯¹è±¡ Javascript è§‚å¯Ÿè€…æ¨¡å¼ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿ å½“å¦ä¸€ä¸ªå¯¹è±¡æ›´æ”¹æ—¶éœ€è¦å…¶ä»–å¯¹è±¡æŽ¥æ”¶æ›´æ–°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¯¹è±¡æˆ–å‘å¸ƒè€…ä»£è¡¨è‚¡ç¥¨å¸‚åœºä¸­çš„æ•°åƒä¸ªè‚¡ç¥¨ï¼Œå½“éœ€è¦å°†æ›´æ–°å‘é€ç»™å¤šä¸ªè®¢é˜…è€…æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥å®Œæˆã€‚ è§‚å¯Ÿè€…æ¨¡å¼çš„å¥½å¤„ æ¾è€¦åˆã€‚ å¯¹è±¡æˆ–å‘å¸ƒè€…å®Œå…¨ä¸ç”¨çŸ¥é“è§‚å¯Ÿè€…æˆ–è®¢é˜…è€…çš„å­˜åœ¨ï¼Œæˆ‘æŠŠè¿™åˆ†ä¸ºä¸¤ç§ä¸åŒçš„æ¦‚å¿µï¼Œå› ä¸ºæˆ‘è§‰å¾—å‘å¸ƒ - è®¢é˜…æ›´æœ‰æ„ä¹‰ï¼Œä½† OLP çš„åŸºæœ¬æœ¯è¯­ä½¿ç”¨çš„æ˜¯å¯¹è±¡ - è§‚å¯Ÿè€…ã€‚ åå¤„ è§‚å¯Ÿè€…æ¨¡å¼å”¯ä¸€çš„ç¼ºç‚¹æ˜¯å¯¹è±¡æˆ–å‘å¸ƒè€…å¯èƒ½å‘é€å¯¹è§‚å¯Ÿè€…ï¼Œè®¢é˜…è€…æ— å…³ç´§è¦çš„æ›´æ–°ã€‚ JavaScript çŠ¶æ€æ¨¡å¼ ä»€ä¹ˆæ˜¯çŠ¶æ€æ¨¡å¼ï¼Ÿ å®ƒå…è®¸å¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å…¶è¡Œä¸ºï¼Œè¿™æ ·è®©å¯¹è±¡çœ‹èµ·æ¥æ”¹å˜äº†å®ƒæ‰€å±žçš„ç±»ã€‚ çŠ¶æ€æ¨¡å¼ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š é¦–å…ˆï¼Œå°†æ‹¥æœ‰æ‰€è°“çš„â€œä¸Šä¸‹æ–‡â€æˆ–â€œè´¦æˆ·â€ï¼Œå®ƒå°†è¦åšçš„æ˜¯ç»´æŠ¤ä¸€ä¸ªå°†å®šä¹‰å½“å‰çŠ¶æ€çš„ ConcreteState å­ç±»çš„å®žä¾‹ã€‚ ç„¶åŽï¼Œæ‹¥æœ‰â€œçŠ¶æ€â€ï¼Œè¯¥çŠ¶æ€å®šä¹‰äº†ä¸€ä¸ªç”¨äºŽå°è£…ä¸Žä¸Šä¸‹æ–‡ç‰¹å®šçŠ¶æ€å…³è”çš„è¡Œä¸ºæŽ¥å£ã€‚ æœ€åŽæ˜¯å…·ä½“çš„çŠ¶æ€ï¼Œæ¯ä¸ªå­ç±»å°†å®žçŽ°ä¸Žä¸Šä¸‹æ–‡çŠ¶æ€ç›¸å…³çš„è¡Œä¸º Javascript ç­–ç•¥æ¨¡å¼ ä½•æ—¶ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Ÿ å¦‚æžœè¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œè¯¥ç±»å°†å…·æœ‰ä¸Žåˆ—è¡¨ä¸­çš„æ‰€æœ‰å…¶ä»–è¡Œä¸ºç›¸ä¼¼çš„è¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼ã€‚ ä¾‹å¦‚ï¼Œæœ‰çš„åŠ¨ç‰©å¯ä»¥é£žï¼Œæœ‰çš„åŠ¨ç‰©ä¸èƒ½é£žï¼Œè¿™é‡Œçš„ç›¸ä¼¼è¡Œä¸ºå°±æ˜¯é£žè¡Œï¼Œä¸è®ºè¯¥åŠ¨ç‰©æ˜¯å¦èƒ½é£žè¡Œã€‚ å¯ä»¥ä»Žä»¥ä¸‹ç±»ä¸­é€‰æ‹©ç±»å¯¹è±¡ï¼š 1.ä¸ä¼šé£žè¡Œ2.ç”¨ç¿…è†€é£žç¿”3.é£žå¾—å¿« é€šè¿‡ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€çš„åˆ›å»ºå…¨æ–°çš„ä¸åŒç±»åž‹çš„é£žè¡Œç±»åŠ¨ç‰©ã€‚ å½“éœ€è¦åŠ¨æ€å†³å®šéœ€è¦ä½¿ç”¨çš„è¡Œä¸ºæ—¶å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼ã€‚ ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„å…¶ä»–å¥½å¤„ å®ƒé€šå¸¸ä¼šå‡å°‘å¾ˆé•¿çš„æ¡ä»¶åˆ—è¡¨ï¼Œæ‰€ä»¥å¦‚æžœä½ çœ‹åˆ°ä½¿ç”¨è®¸å¤šä¸åŒç±»åž‹çš„æ¡ä»¶æ—¶ï¼Œç­–ç•¥æ¨¡å¼ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚å½“ç„¶ï¼Œè¿˜é¿å…äº†é‡å¤çš„ä»£ç ã€‚ ç­–ç•¥æ¨¡å¼å¯ä»¥é˜²æ­¢å…¶ä»–ç±»çš„å˜åŒ–å½±å“åˆ°å½“å‰ç±»ã€‚ä¹Ÿå¯ä»¥å‘ä¸šåŠ¡æ–¹éšè—å¤æ‚å’Œæ•æ„Ÿä»£ç ã€‚ åå¤„ï¼šç­–ç•¥æ¨¡å¼ä¼šå¢žåŠ å¯¹è±¡å’Œç±»çš„æ•°é‡ã€‚ JavaScript æ¨¡æ¿æ–¹æ³•æ¨¡å¼ ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Ÿ ç”¨äºŽåˆ›å»ºä¸€ç»„æ‰§è¡Œç±»ä¼¼æ–¹æ³•çš„å­ç±»ã€‚ è¦å®žçŽ°å®ƒï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå°†åŒ…å«ä¸€ä¸ªåä¸ºæ¨¡æ¿æ–¹æ³•çš„æ–¹æ³•ã€‚ åˆ›å»ºåŒ…å«ç§°ä¸ºæ¨¡æ¿æ–¹æ³•çš„æŠ½è±¡ç±»ï¼Œå¹¶ä¸”æ¨¡æ¿æ–¹æ³•åŒ…å«æ¯ä¸ªå­ç±»å¯¹è±¡å°†è°ƒç”¨çš„ä¸€ç³»åˆ—æ–¹æ³•è°ƒç”¨ã€‚åœ¨æŸäº›æƒ…å†µä¸‹å­ç±»ä¹Ÿä¼šé‡è½½ä¸€äº›ä¸åˆé€‚çš„æ–¹æ³•è°ƒç”¨ã€‚ Javascript è®¿é—®è€…æ¨¡å¼ ä»€ä¹ˆæ˜¯è®¿é—®è€…æ¨¡å¼ è®¿é—®è€…æ¨¡å¼å…è®¸å°†æ–¹æ³•æ·»åŠ åˆ°ä¸åŒç±»åž‹çš„ç±»ä¸­ - ä½†å®ƒä»¬ä¸å¿…æ˜¯ä¸åŒçš„ç±»åž‹ - åªä¼šè®©å¤æ‚åº¦æœ‰æ‰€å¢žåŠ ï¼Œå¹¶ä¸ä¼šå¯¹ç±»æœ‰å¤ªå¤šä¿®æ”¹ã€‚ è¿™å¯ä»¥æ ¹æ®æ‰€ä½¿ç”¨çš„ç±»åˆ¶ä½œå®Œå…¨ä¸åŒçš„æ–¹æ³•ã€‚ ä¹Ÿå¯ä»¥è¯´è®¿é—®è€…æ¨¡å¼å¯ä»¥ä¸ºçŽ°æœ‰ç±»åˆ›å»ºå¤–éƒ¨ç±»æ¥è¿›è¡Œæ‰©å±•ä»¥é¿å…å¯¹åŽŸæœ‰ç±»åšä¿®æ”¹ã€‚ æ³¨æ„ï¼šæŽŒæ¡æŠ½è±¡ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼Œå°è£…ï¼ŒæŽ¥å£ï¼Œç±»å’ŒæŠ½è±¡ç±»ç­‰é¢å‘å¯¹è±¡æ¦‚å¿µçš„åŸºæœ¬çŸ¥è¯†å¯¹äºŽæ›´å¥½åœ°ç†è§£è®¾è®¡æ¨¡å¼éžå¸¸é‡è¦ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Airbnb React/JSX ç¼–ç è§„èŒƒ]]></title>
    <url>%2F2018%2F06%2F28%2Fstudy%2FAirbnb-React-JSX-%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%2F</url>
    <content type="text"><![CDATA[å‰è¨€ç®—æ˜¯æœ€åˆç†çš„React/JSXç¼–ç è§„èŒƒä¹‹ä¸€äº† æ­¤ç¼–ç è§„èŒƒä¸»è¦åŸºäºŽç›®å‰æµè¡Œçš„JavaScriptæ ‡å‡†ï¼Œå°½ç®¡æŸäº›å…¶ä»–çº¦å®š(å¦‚async/awaitï¼Œé™æ€classå±žæ€§)å¯èƒ½åœ¨ä¸åŒçš„é¡¹ç›®ä¸­è¢«å¼•å…¥æˆ–è€…è¢«ç¦ç”¨ã€‚ç›®å‰çš„çŠ¶æ€æ˜¯ä»»ä½•stage-3ä¹‹å‰çš„è§„èŒƒéƒ½ä¸åŒ…æ‹¬ä¹Ÿä¸æŽ¨èä½¿ç”¨ã€‚ Basic Rules åŸºæœ¬è§„èŒƒæ¯ä¸ªæ–‡ä»¶åªå†™ä¸€ä¸ªæ¨¡å—.ä½†æ˜¯å¤šä¸ªæ— çŠ¶æ€æ¨¡å—å¯ä»¥æ”¾åœ¨å•ä¸ªæ–‡ä»¶ä¸­. eslint: react/no-multi-comp.æŽ¨èä½¿ç”¨JSXè¯­æ³•.ä¸è¦ä½¿ç”¨ React.createElementï¼Œé™¤éžä»Žä¸€ä¸ªéžJSXçš„æ–‡ä»¶ä¸­åˆå§‹åŒ–ä½ çš„app. åˆ›å»ºæ¨¡å—class vs React.createClass vs stateless å¦‚æžœä½ çš„æ¨¡å—æœ‰å†…éƒ¨çŠ¶æ€æˆ–è€…æ˜¯refs, æŽ¨èä½¿ç”¨ class extends React.Component è€Œä¸æ˜¯ React.createClass. eslint: 1234567891011121314const Listing = React.createClass(&#123; // ... render() &#123; return &lt;div&gt;&#123;this.state.hello&#125;&lt;/div&gt;; &#125;&#125;);// goodclass Listing extends React.Component &#123; // ... render() &#123; return &lt;div&gt;&#123;this.state.hello&#125;&lt;/div&gt;; &#125;&#125; å¦‚æžœä½ çš„æ¨¡å—æ²¡æœ‰çŠ¶æ€æˆ–æ˜¯æ²¡æœ‰å¼•ç”¨refsï¼Œ æŽ¨èä½¿ç”¨æ™®é€šå‡½æ•°ï¼ˆéžç®­å¤´å‡½æ•°ï¼‰è€Œä¸æ˜¯ç±»: 12345678910111213141516// badclass Listing extends React.Component &#123; render() &#123; return &lt;div&gt;&#123;this.props.hello&#125;&lt;/div&gt;; &#125;&#125;// bad (relying on function name inference is discouraged)const Listing = (&#123; hello &#125;) =&gt; ( &lt;div&gt;&#123;hello&#125;&lt;/div&gt;);// goodfunction Listing(&#123; hello &#125;) &#123; return &lt;div&gt;&#123;hello&#125;&lt;/div&gt;;&#125; Mixinsä¸è¦ä½¿ç”¨Mixins Naming å‘½å æ‰©å±•åï¼šReactæ¨¡å—ä½¿ç”¨.jsxæ‰©å±•åã€‚ æ–‡ä»¶åï¼šæ–‡ä»¶åä½¿ç”¨å¸•æ–¯å¡å‘½åã€‚å¦‚ï¼ŒReservationCard.jsxã€‚ å¼•ç”¨å‘½å: Reactæ¨¡å—åä½¿ç”¨å¸•æ–¯å¡å‘½åï¼Œå®žä¾‹ä½¿ç”¨éª†é©¼å¼å‘½å. eslint: react/jsx-pascal-case 1234567891011// badimport reservationCard from './ReservationCard';// goodimport ReservationCard from './ReservationCard';// badconst ReservationItem = &lt;ReservationCard /&gt;;// goodconst reservationItem = &lt;ReservationCard /&gt;; æ¨¡å—å‘½å: æ¨¡å—ä½¿ç”¨å½“å‰æ–‡ä»¶åä¸€æ ·çš„åç§°. æ¯”å¦‚ ReservationCard.jsx åº”è¯¥åŒ…å«åä¸º ReservationCardçš„æ¨¡å—. ä½†æ˜¯ï¼Œå¦‚æžœæ•´ä¸ªæ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œä½¿ç”¨ index.jsä½œä¸ºå…¥å£æ–‡ä»¶ï¼Œç„¶åŽç›´æŽ¥ä½¿ç”¨ index.js æˆ–è€…æ–‡ä»¶å¤¹åä½œä¸ºæ¨¡å—çš„åç§°: 12345678// badimport Footer from './Footer/Footer';// badimport Footer from './Footer/index';// goodimport Footer from './Footer'; é«˜é˜¶æ¨¡å—å‘½å: å¯¹äºŽç”Ÿæˆä¸€ä¸ªæ–°çš„æ¨¡å—ï¼Œå…¶ä¸­çš„æ¨¡å—å displayName åº”è¯¥ä¸ºé«˜é˜¶æ¨¡å—åå’Œä¼ å…¥æ¨¡å—åçš„ç»„åˆ. ä¾‹å¦‚, é«˜é˜¶æ¨¡å— withFoo(), å½“ä¼ å…¥ä¸€ä¸ª Bar æ¨¡å—çš„æ—¶å€™ï¼Œ ç”Ÿæˆçš„æ¨¡å—å displayName åº”è¯¥ä¸º withFoo(Bar). ä¸ºä»€ä¹ˆï¼Ÿä¸€ä¸ªæ¨¡å—çš„ displayName å¯èƒ½ä¼šåœ¨å¼€å‘è€…å·¥å…·æˆ–è€…é”™è¯¯ä¿¡æ¯ä¸­ä½¿ç”¨åˆ°ï¼Œå› æ­¤æœ‰ä¸€ä¸ªèƒ½æ¸…æ¥šçš„è¡¨è¾¾è¿™å±‚å…³ç³»çš„å€¼èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£æ¨¡å—å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæ›´å¥½çš„Debug. 1234567891011121314151617181920// badexport default function withFoo(WrappedComponent) &#123; return function WithFoo(props) &#123; return &lt;WrappedComponent &#123;...props&#125; foo /&gt;; &#125;&#125;// goodexport default function withFoo(WrappedComponent) &#123; function WithFoo(props) &#123; return &lt;WrappedComponent &#123;...props&#125; foo /&gt;; &#125; const wrappedComponentName = WrappedComponent.displayName || WrappedComponent.name || 'Component'; WithFoo.displayName = `withFoo($&#123;wrappedComponentName&#125;)`; return WithFoo;&#125; å±žæ€§å‘½å: é¿å…ä½¿ç”¨DOMç›¸å…³çš„å±žæ€§æ¥ç”¨ä½œå…¶ä»–çš„ç”¨é€”ã€‚ ä¸ºä»€ä¹ˆï¼Ÿå¯¹äºŽstyle å’Œ classNameè¿™æ ·çš„å±žæ€§åï¼Œæˆ‘ä»¬éƒ½ä¼šé»˜è®¤å®ƒä»¬ä»£è¡¨ä¸€äº›ç‰¹æ®Šçš„å«ä¹‰ï¼Œå¦‚å…ƒç´ çš„æ ·å¼ï¼ŒCSS classçš„åç§°ã€‚åœ¨ä½ çš„åº”ç”¨ä¸­ä½¿ç”¨è¿™äº›å±žæ€§æ¥è¡¨ç¤ºå…¶ä»–çš„å«ä¹‰ä¼šä½¿ä½ çš„ä»£ç æ›´éš¾é˜…è¯»ï¼Œæ›´éš¾ç»´æŠ¤ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¼•èµ·bugã€‚ 12345// bad&lt;MyComponent style="fancy" /&gt;// good&lt;MyComponent variant="fancy" /&gt; Declaration å£°æ˜Žæ¨¡å— ä¸è¦ä½¿ç”¨ displayName æ¥å‘½åReactæ¨¡å—ï¼Œè€Œæ˜¯ä½¿ç”¨å¼•ç”¨æ¥å‘½åæ¨¡å—ï¼Œ å¦‚ class åç§°. 123456789// badexport default React.createClass(&#123; displayName: 'ReservationCard', // stuff goes here&#125;);// goodexport default class ReservationCard extends React.Component &#123;&#125; Alignment ä»£ç å¯¹é½éµå¾ªä»¥ä¸‹çš„JSXè¯­æ³•ç¼©è¿›/æ ¼å¼. 1234567891011121314151617181920// bad&lt;Foo superLongParam="bar" anotherSuperLongParam="baz" /&gt;// good, æœ‰å¤šè¡Œå±žæ€§çš„è¯, æ–°å»ºä¸€è¡Œå…³é—­æ ‡ç­¾&lt;Foo superLongParam="bar" anotherSuperLongParam="baz"/&gt;// è‹¥èƒ½åœ¨ä¸€è¡Œä¸­æ˜¾ç¤º, ç›´æŽ¥å†™æˆä¸€è¡Œ&lt;Foo bar="bar" /&gt;// å­å…ƒç´ æŒ‰ç…§å¸¸è§„æ–¹å¼ç¼©è¿›&lt;Foo superLongParam="bar" anotherSuperLongParam="baz"&gt; &lt;Quux /&gt;&lt;/Foo&gt; Quotes å•å¼•å·è¿˜æ˜¯åŒå¼•å· å¯¹äºŽJSXå±žæ€§å€¼æ€»æ˜¯ä½¿ç”¨åŒå¼•å·(â€œ), å…¶ä»–å‡ä½¿ç”¨å•å¼•å·(â€˜). eslint: jsx-quotes ä¸ºä»€ä¹ˆ? HTMLå±žæ€§ä¹Ÿæ˜¯ç”¨åŒå¼•å·, å› æ­¤JSXçš„å±žæ€§ä¹Ÿéµå¾ªæ­¤çº¦å®š. 1234567891011// bad&lt;Foo bar='bar' /&gt;// good&lt;Foo bar="bar" /&gt;// bad&lt;Foo style=&#123;&#123; left: "20px" &#125;&#125; /&gt;// good&lt;Foo style=&#123;&#123; left: '20px' &#125;&#125; /&gt; Spacing ç©ºæ ¼ æ€»æ˜¯åœ¨è‡ªåŠ¨å…³é—­çš„æ ‡ç­¾å‰åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¹Ÿä¸éœ€è¦æ¢è¡Œ. 123456789101112// bad&lt;Foo/&gt;// very bad&lt;Foo /&gt;// bad&lt;Foo /&gt;// good&lt;Foo /&gt; ä¸è¦åœ¨JSX {} å¼•ç”¨æ‹¬å·é‡Œä¸¤è¾¹åŠ ç©ºæ ¼ 12345// bad&lt;Foo bar=&#123; baz &#125; /&gt;// good&lt;Foo bar=&#123;baz&#125; /&gt; Props å±žæ€§ JSXå±žæ€§åä½¿ç”¨éª†é©¼å¼é£Žæ ¼camelCase. 1234567891011// bad&lt;Foo UserName="hello" phone_number=&#123;12345678&#125;/&gt;// good&lt;Foo userName="hello" phoneNumber=&#123;12345678&#125;/&gt; å¦‚æžœå±žæ€§å€¼ä¸º true, å¯ä»¥ç›´æŽ¥çœç•¥. 123456789101112// bad&lt;Foo hidden=&#123;true&#125;/&gt;// good&lt;Foo hidden/&gt;// good&lt;Foo hidden /&gt; &lt;img&gt; æ ‡ç­¾æ€»æ˜¯æ·»åŠ  alt å±žæ€§. å¦‚æžœå›¾ç‰‡ä»¥presentation(æ„Ÿè§‰æ˜¯ä»¥ç±»ä¼¼PPTæ–¹å¼æ˜¾ç¤º?)æ–¹å¼æ˜¾ç¤ºï¼Œalt å¯ä¸ºç©º, æˆ–è€…&lt;img&gt; è¦åŒ…å«role=â€presentationâ€. 1234567891011// bad&lt;img src="hello.jpg" /&gt;// good&lt;img src="hello.jpg" alt="Me waving hello" /&gt;// good&lt;img src="hello.jpg" alt="" /&gt;// good&lt;img src="hello.jpg" role="presentation" /&gt; ä¸è¦åœ¨ alt å€¼é‡Œä½¿ç”¨å¦‚ â€œimageâ€, â€œphotoâ€, or â€œpictureâ€åŒ…æ‹¬å›¾ç‰‡å«ä¹‰è¿™æ ·çš„è¯ï¼Œ ä¸­æ–‡ä¹Ÿä¸€æ ·. ä¸ºä»€ä¹ˆ? å±å¹•åŠ©è¯»å™¨å·²ç»æŠŠ img æ ‡ç­¾æ ‡æ³¨ä¸ºå›¾ç‰‡äº†, æ‰€ä»¥æ²¡æœ‰å¿…è¦å†åœ¨ alt é‡Œè¯´æ˜Žäº†. 12345// bad&lt;img src="hello.jpg" alt="Picture of me waving hello" /&gt;// good&lt;img src="hello.jpg" alt="Me waving hello" /&gt; ä½¿ç”¨æœ‰æ•ˆæ­£ç¡®çš„ aria roleå±žæ€§å€¼ ARIA roles. 12345678// bad - not an ARIA role&lt;div role="datepicker" /&gt;// bad - abstract ARIA role&lt;div role="range" /&gt;// good&lt;div role="button" /&gt; ä¸è¦åœ¨æ ‡ç­¾ä¸Šä½¿ç”¨ accessKey å±žæ€§. ä¸ºä»€ä¹ˆ? å±å¹•åŠ©è¯»å™¨åœ¨é”®ç›˜å¿«æ·é”®ä¸Žé”®ç›˜å‘½ä»¤æ—¶é€ æˆçš„ä¸ç»Ÿä¸€æ€§ä¼šå¯¼è‡´é˜…è¯»æ€§æ›´åŠ å¤æ‚. 12345// bad&lt;div accessKey="h" /&gt;// good&lt;div /&gt; é¿å…ä½¿ç”¨æ•°ç»„çš„indexæ¥ä½œä¸ºå±žæ€§keyçš„å€¼ï¼ŒæŽ¨èä½¿ç”¨å”¯ä¸€ID. 123456789101112131415// bad&#123;todos.map((todo, index) =&gt; &lt;Todo &#123;...todo&#125; key=&#123;index&#125; /&gt;)&#125;// good&#123;todos.map(todo =&gt; ( &lt;Todo &#123;...todo&#125; key=&#123;todo.id&#125; /&gt;))&#125; å¯¹äºŽæ‰€æœ‰éžå¿…é¡»çš„å±žæ€§ï¼Œæ€»æ˜¯æ‰‹åŠ¨åŽ»å®šä¹‰defaultPropså±žæ€§. ä¸ºä»€ä¹ˆ? propTypes å¯ä»¥ä½œä¸ºæ¨¡å—çš„æ–‡æ¡£è¯´æ˜Ž, å¹¶ä¸”å£°æ˜Ž defaultProps çš„è¯æ„å‘³ç€é˜…è¯»ä»£ç çš„äººä¸éœ€è¦åŽ»å‡è®¾ä¸€äº›é»˜è®¤å€¼ã€‚æ›´é‡è¦çš„æ˜¯, æ˜¾ç¤ºçš„å£°æ˜Žé»˜è®¤å±žæ€§å¯ä»¥è®©ä½ çš„æ¨¡å—è·³è¿‡å±žæ€§ç±»åž‹çš„æ£€æŸ¥. 1234567891011121314151617181920212223// badfunction SFC(&#123; foo, bar, children &#125;) &#123; return &lt;div&gt;&#123;foo&#125;&#123;bar&#125;&#123;children&#125;&lt;/div&gt;;&#125;SFC.propTypes = &#123; foo: PropTypes.number.isRequired, bar: PropTypes.string, children: PropTypes.node,&#125;;// goodfunction SFC(&#123; foo, bar, children &#125;) &#123; return &lt;div&gt;&#123;foo&#125;&#123;bar&#125;&#123;children&#125;&lt;/div&gt;;&#125;SFC.propTypes = &#123; foo: PropTypes.number.isRequired, bar: PropTypes.string, children: PropTypes.node,&#125;;SFC.defaultProps = &#123; bar: '', children: null,&#125;; å°½å¯èƒ½å°‘åœ°ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ ä¸ºä»€ä¹ˆ? é™¤éžä½ å¾ˆæƒ³ä¼ é€’ä¸€äº›ä¸å¿…è¦çš„å±žæ€§ ä¾‹å¤–æƒ…å†µ: ä½¿ç”¨äº†å˜é‡æå‡çš„é«˜é˜¶ç»„ä»¶ 123456789101112function HOC(WrappedComponent) &#123; return class Proxy extends React.Component &#123; Proxy.propTypes = &#123; text: PropTypes.string, isLoading: PropTypes.bool &#125;; render() &#123; return &lt;WrappedComponent &#123;...this.props&#125; /&gt; &#125; &#125;&#125; åªæœ‰åœ¨æ¸…æ¥šæ˜Žç™½æ‰©å±•å¯¹è±¡æ—¶æ‰ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ã€‚è¿™éžå¸¸æœ‰ç”¨å°¤å…¶æ˜¯åœ¨ä½¿ç”¨Mochaæµ‹è¯•ç»„ä»¶çš„æ—¶å€™ã€‚ 12345678export default function Foo &#123; const props = &#123; text: '', isPublished: false &#125; return (&lt;div &#123;...props&#125; /&gt;);&#125; ç‰¹åˆ«æé†’ï¼šå°½å¯èƒ½åœ°ç­›é€‰å‡ºä¸å¿…è¦çš„å±žæ€§ã€‚åŒæ—¶ï¼Œä½¿ç”¨prop-types-exactæ¥é¢„é˜²é—®é¢˜å‡ºçŽ°ã€‚ 1234567891011 //goodrender() &#123; const &#123; irrelevantProp, ...relevantProps &#125; = this.props; return &lt;WrappedComponent &#123;...relevantProps&#125; /&gt;&#125;//badrender() &#123; const &#123; irrelevantProp, ...relevantProps &#125; = this.props; return &lt;WrappedComponent &#123;...this.props&#125; /&gt;&#125; Refsæ€»æ˜¯åœ¨Refsé‡Œä½¿ç”¨å›žè°ƒå‡½æ•°. 123456789// bad&lt;Foo ref="myRef"/&gt;// good&lt;Foo ref=&#123;(ref) =&gt; &#123; this.myRef = ref; &#125;&#125;/&gt; Parentheses æ‹¬å· å°†å¤šè¡Œçš„JSXæ ‡ç­¾å†™åœ¨()é‡Œ 123456789101112131415161718192021// badrender() &#123; return &lt;MyComponent className="long body" foo="bar"&gt; &lt;MyChild /&gt; &lt;/MyComponent&gt;;&#125;// goodrender() &#123; return ( &lt;MyComponent className="long body" foo="bar"&gt; &lt;MyChild /&gt; &lt;/MyComponent&gt; );&#125;// good, å•è¡Œå¯ä»¥ä¸éœ€è¦render() &#123; const body = &lt;div&gt;hello&lt;/div&gt;; return &lt;MyComponent&gt;&#123;body&#125;&lt;/MyComponent&gt;;&#125; Tags æ ‡ç­¾ æ²¡æœ‰å­å…ƒç´ æ ‡ç­¾æ€»æ˜¯è‡ªå·±é—­åˆ 12345// bad&lt;foo className="stuff"&gt;&lt;/foo&gt;//good&lt;foo className="stuff"/&gt; å¦‚æžœæ¨¡å—æœ‰å¤šè¡Œçš„å±žæ€§ï¼Œ å…³é—­æ ‡ç­¾æ—¶æ–°å»ºä¸€è¡Œ. 12345678910// bad&lt;Foo bar="bar" baz="baz" /&gt;// good&lt;Foo bar="bar" baz="baz"/&gt; Methodså‡½æ•° ä½¿ç”¨ç®­å¤´å‡½æ•°æ¥èŽ·å–æœ¬åœ°å˜é‡. 123456789101112function ItemList(props) &#123; return ( &lt;ul&gt; &#123;props.items.map((item, index) =&gt; ( &lt;Item key=&#123;item.key&#125; onClick=&#123;() =&gt; doSomethingWith(item.name, index)&#125; /&gt; ))&#125; &lt;/ul&gt; );&#125; å½“åœ¨ render() é‡Œä½¿ç”¨äº‹ä»¶å¤„ç†æ–¹æ³•æ—¶ï¼Œæå‰åœ¨æž„é€ å‡½æ•°é‡ŒæŠŠ this ç»‘å®šä¸ŠåŽ». ä¸ºä»€ä¹ˆ? åœ¨æ¯æ¬¡ render è¿‡ç¨‹ä¸­ï¼Œ å†è°ƒç”¨ bind éƒ½ä¼šæ–°å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæµªè´¹èµ„æº. 123456789101112131415161718192021222324252627// badclass extends React.Component &#123; onClickDiv() &#123; // do stuff &#125; render() &#123; return &lt;div onClick=&#123;this.onClickDiv.bind(this)&#125; /&gt;; &#125;&#125;// goodclass extends React.Component &#123; constructor(props) &#123; super(props); this.onClickDiv = this.onClickDiv.bind(this); &#125; onClickDiv() &#123; // do stuff &#125; render() &#123; return &lt;div onClick=&#123;this.onClickDiv&#125; /&gt;; &#125;&#125; åœ¨Reactæ¨¡å—ä¸­ï¼Œä¸è¦ç»™æ‰€è°“çš„ç§æœ‰å‡½æ•°æ·»åŠ  _ å‰ç¼€ï¼Œæœ¬è´¨ä¸Šå®ƒå¹¶ä¸æ˜¯ç§æœ‰çš„. ä¸ºä»€ä¹ˆï¼Ÿ_ ä¸‹åˆ’çº¿å‰ç¼€åœ¨æŸäº›è¯­è¨€ä¸­é€šå¸¸è¢«ç”¨æ¥è¡¨ç¤ºç§æœ‰å˜é‡æˆ–è€…å‡½æ•°ã€‚ä½†æ˜¯ä¸åƒå…¶ä»–çš„ä¸€äº›è¯­è¨€ï¼Œåœ¨JSä¸­æ²¡æœ‰åŽŸç”Ÿæ”¯æŒæ‰€è°“çš„ç§æœ‰å˜é‡ï¼Œæ‰€æœ‰çš„å˜é‡å‡½æ•°éƒ½æ˜¯å…±æœ‰çš„ã€‚å°½ç®¡ä½ çš„æ„å›¾æ˜¯ä½¿å®ƒç§æœ‰åŒ–ï¼Œåœ¨ä¹‹å‰åŠ ä¸Šä¸‹åˆ’çº¿å¹¶ä¸ä¼šä½¿è¿™äº›å˜é‡ç§æœ‰åŒ–ï¼Œå¹¶ä¸”æ‰€æœ‰çš„å±žæ€§ï¼ˆåŒ…æ‹¬æœ‰ä¸‹åˆ’çº¿å‰ç¼€åŠæ²¡æœ‰å‰ç¼€çš„ï¼‰éƒ½åº”è¯¥è¢«è§†ä¸ºæ˜¯å…±æœ‰çš„ã€‚äº†è§£æ›´å¤šè¯¦æƒ…è¯·æŸ¥çœ‹Issue #1024, å’Œ #490 ã€‚ 1234567891011121314151617// badReact.createClass(&#123; _onClickSubmit() &#123; // do stuff &#125;, // other stuff&#125;);// goodclass extends React.Component &#123; onClickSubmit() &#123; // do stuff &#125; // other stuff&#125; åœ¨ render æ–¹æ³•ä¸­æ€»æ˜¯ç¡®ä¿ return è¿”å›žå€¼. 123456789// badrender() &#123; (&lt;div /&gt;);&#125;// goodrender() &#123; return (&lt;div /&gt;);&#125; Ordering React æ¨¡å—ç”Ÿå‘½å‘¨æœŸ class extends React.Component çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°: 1.å¯é€‰çš„ static æ–¹æ³•2.constructor æž„é€ å‡½æ•°3.getChildContext èŽ·å–å­å…ƒç´ å†…å®¹4.componentWillMount æ¨¡å—æ¸²æŸ“å‰5.componentDidMount æ¨¡å—æ¸²æŸ“åŽ6.componentWillReceiveProps æ¨¡å—å°†æŽ¥å—æ–°çš„æ•°æ®7.shouldComponentUpdate åˆ¤æ–­æ¨¡å—éœ€ä¸éœ€è¦é‡æ–°æ¸²æŸ“8.componentWillUpdate ä¸Šé¢çš„æ–¹æ³•è¿”å›ž trueï¼Œ æ¨¡å—å°†é‡æ–°æ¸²æŸ“9.componentDidUpdate æ¨¡å—æ¸²æŸ“ç»“æŸ10.componentWillUnmount æ¨¡å—å°†ä»ŽDOMä¸­æ¸…é™¤, åšä¸€äº›æ¸…ç†ä»»åŠ¡11.ç‚¹å‡»å›žè°ƒæˆ–è€…äº‹ä»¶å¤„ç†å™¨ å¦‚ onClickSubmit() æˆ– onChangeDescription()12.render é‡Œçš„ getter æ–¹æ³• å¦‚ getSelectReason() æˆ– getFooterContent()13.å¯é€‰çš„ render æ–¹æ³• å¦‚ renderNavigation() æˆ– renderProfilePicture()14.render render() æ–¹æ³• å¦‚ä½•å®šä¹‰ propTypes, defaultProps, contextTypes, ç­‰ç­‰å…¶ä»–å±žæ€§â€¦ 123456789101112131415161718192021222324252627import React from 'react';import PropTypes from 'prop-types';const propTypes = &#123; id: PropTypes.number.isRequired, url: PropTypes.string.isRequired, text: PropTypes.string,&#125;;const defaultProps = &#123; text: 'Hello World',&#125;;class Link extends React.Component &#123; static methodsAreOk() &#123; return true; &#125; render() &#123; return &lt;a href=&#123;this.props.url&#125; data-id=&#123;this.props.id&#125;&gt;&#123;this.props.text&#125;&lt;/a&gt;; &#125;&#125;Link.propTypes = propTypes;Link.defaultProps = defaultProps;export default Link; React.createClass çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä¸Žä½¿ç”¨classç¨æœ‰ä¸åŒ: 1.displayName è®¾å®šæ¨¡å—åç§°2.propTypes è®¾ç½®å±žæ€§çš„ç±»åž‹3.contextTypes è®¾ç½®ä¸Šä¸‹æ–‡ç±»åž‹4.childContextTypes è®¾ç½®å­å…ƒç´ ä¸Šä¸‹æ–‡ç±»åž‹5.mixins æ·»åŠ ä¸€äº›mixins6.statics7.defaultProps è®¾ç½®é»˜è®¤çš„å±žæ€§å€¼8.getDefaultProps èŽ·å–é»˜è®¤å±žæ€§å€¼9.getInitialState æˆ–è€…åˆå§‹çŠ¶æ€10.getChildContext11.componentWillMount12.componentDidMount13.componentWillReceiveProps14.shouldComponentUpdate15.componentWillUpdate16.componentDidUpdate17.componentWillUnmount18.clickHandlers or eventHandlers like onClickSubmit() or onChangeDescription()19.getter methods for render like getSelectReason() or getFooterContent()20.Optional render methods like renderNavigation() or renderProfilePicture()21.render isMounted ä¸ºä»€ä¹ˆ? isMounted åäººç±»è®¾è®¡æ¨¡å¼:(), åœ¨ ES6 classes ä¸­æ— æ³•ä½¿ç”¨ï¼Œ å®˜æ–¹å°†åœ¨æœªæ¥çš„ç‰ˆæœ¬é‡Œåˆ é™¤æ­¤æ–¹æ³•. æ›´å¤šç¼–ç è§„èŒƒjavascriptvue åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>ç¼–ç é£Žæ ¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯è·¯ç”±å®žçŽ°ä¸Žreact-routeræºç åˆ†æž]]></title>
    <url>%2F2018%2F06%2F21%2Fstudy%2F%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0%E4%B8%8Ereact-router%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[å‰è¨€åœ¨å•é¡µåº”ç”¨ä¸Šï¼Œå‰ç«¯è·¯ç”±å¹¶ä¸é™Œç”Ÿã€‚å¾ˆå¤šå‰ç«¯æ¡†æž¶ä¹Ÿä¼šæœ‰ç‹¬ç«‹å¼€å‘æˆ–æŽ¨èé…å¥—ä½¿ç”¨çš„è·¯ç”±ç³»ç»Ÿã€‚é‚£ä¹ˆï¼Œå½“æˆ‘ä»¬åœ¨è°ˆå‰ç«¯è·¯ç”±çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥è°ˆäº›ä»€ä¹ˆï¼Ÿæœ¬æ–‡å°†ç®€è¦åˆ†æžå¹¶å®žçŽ°ä¸€ä¸ªçš„å‰ç«¯è·¯ç”±ï¼Œå¹¶å¯¹ react-router è¿›è¡Œåˆ†æžã€‚ ä¸€ä¸ªæžç®€å‰ç«¯è·¯ç”±å®žçŽ°è°ˆä¸€ä¸‹å‰ç«¯è·¯ç”±çš„ç®€è¦åŽŸç†ï¼Œä»¥hashå½¢å¼ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨History APIåšå¤„ç†ï¼‰ä¸ºä¾‹ï¼Œå½“urlçš„hashå‘ç”Ÿå˜åŒ–æ—¶ï¼Œè§¦å‘hashchangeæ³¨å†Œçš„å›žè°ƒï¼Œåœ¨å›žè°ƒä¸­è¿›è¡Œä¸åŒçš„æ“ä½œï¼Œå±•ç¤ºä¸åŒçš„é¡µé¢ã€‚ç›´æŽ¥çœ‹ä»£ç æ¯”è¾ƒç›´è§‚ã€‚ 1234567891011121314151617181920function Router()&#123; this.routes = &#123;&#125;; this.currentUrl = '';&#125;// å­˜å‚¨è·¯ç”±æ›´æ–°æ—¶çš„å›žè°ƒåˆ°å›žè°ƒæ•°ç»„routesä¸­ï¼Œå›žè°ƒå‡½æ•°å°†è´Ÿè´£å¯¹é¡µé¢çš„æ›´æ–°Router.prototype.route = function(path,callback) &#123; this.routes[path] = callback || function()&#123;&#125;;&#125;// è·¯ç”±æ‰§è¡Œå½“å‰urlå¯¹åº”çš„å›žè°ƒå‡½æ•°ï¼Œæ›´æ–°é¡µé¢Router.prototype.refresh = function()&#123; this.currentUrl = location.hash.slice(1) || '/'; this.routes[this.currentUrl]()&#125;// è·¯ç”±ç›‘å¬Router.prototype.init = function()&#123; window.addEventListener('load',this.refresh.bind(this),false); window.addEventListener('hashChange',this.refresh.bind(this),false);&#125;window.Router = new Router();window.Router.init(); ä¸Šé¢è·¯ç”±ç³»ç»ŸRouterå¯¹è±¡å®žçŽ°ï¼Œä¸»è¦æä¾›ä¸‰ä¸ªæ–¹æ³• route å­˜å‚¨è·¯ç”±æ›´æ–°æ—¶çš„å›žè°ƒåˆ°å›žè°ƒæ•°ç»„routesä¸­ï¼Œå›žè°ƒå‡½æ•°å°†è´Ÿè´£å¯¹é¡µé¢çš„æ›´æ–° refresh æ‰§è¡Œå½“å‰urlå¯¹åº”çš„å›žè°ƒå‡½æ•°ï¼Œæ›´æ–°é¡µé¢ init ç›‘å¬æµè§ˆå™¨ url hash æ›´æ–°äº‹ä»¶ Routerè°ƒç”¨æ–¹æ³•ä»¥åŠå‘ˆçŽ°æ•ˆæžœå¦‚ä¸‹ï¼Œç‚¹å‡»å¯¹åº”çš„urlï¼ŒèƒŒæ™¯è‰²å‘ç”Ÿä¸åŒçš„å˜åŒ– 12345&lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;turn white&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#/blue"&gt;turn bule&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#/green"&gt;&lt;/a&gt;turn green&lt;/li&gt;&lt;ul&gt; 12345678910111213141516var content = document.quserSelecotor('body');// change page anythingfunction changebBgColor(color)&#123; content.style.backgroundColor = color;&#125;Router('/',function()&#123; changeBgColor('white');&#125;)Router('/blue',function()&#123; changeBgColor('blue');&#125;)Router('/green',function()&#123; changeBgColor('green');&#125;) ä»¥ä¸Šä¸ºä¸€ä¸ªå‰ç«¯è·¯ç”±çš„ç®€å•å®žçŽ°ï¼Œè™½ç„¶ç®€å•ï¼Œä½†å®žé™…ä¸Šå¾ˆå¤šè·¯ç”±ç³»ç»Ÿçš„æ ¹åŸºéƒ½ç«‹äºŽæ­¤ï¼Œå…¶ä»–è·¯ç”±ç³»ç»Ÿä¸»è¦æ˜¯å¯¹è‡ªèº«ä½¿ç”¨çš„æ¡†æž¶æœºåˆ¶çš„è¿›è¡Œé…å¥—åŠä¼˜åŒ–ï¼Œå¦‚ä¸Ž react é…å¥—çš„ react-routerã€‚ react-router åˆ†æžreact-router ä¸Ž history ç»“åˆå½¢å¼react-routeræ˜¯åŸºäºŽhistoryæ¨¡å—æä¾›çš„apiè¿›è¡Œå¼€å‘çš„ï¼Œç»“åˆçš„å½¢å¼æœ¬æ–‡è®°ä¸ºåŒ…è£…å½¢å¼ã€‚æ‰€ä»¥åœ¨å¼€å§‹å¯¹å…¶åˆ†æžä¹‹å‰ï¼Œå…ˆä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜Žå¦‚ä½•è¿›è¡Œå¯¹è±¡çš„åŒ…è£…ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142//åŽŸå¯¹è±¡var historyModule = &#123; listener: [], listen: function(listener)&#123; this.listener.push(listener); console.log('historyModule listen'); &#125;, updateLocation: funcion()&#123; this.listener.forEach(function(listener)&#123; listener('new location'); &#125;) &#125;&#125;//Routerå°†ç”¨historyModuleå¯¹è±¡å°†å…¶åŒ…è£…var Router = &#123; source:&#123;&#125;, init: function(source)&#123; this.source = source; &#125;, listen: function(listener)&#123; return this.source.listen(function(location)&#123; console.log('Router listen tirgger'); listener(location); &#125;) &#125;&#125;//å°†historyModuleæ³¨å…¥åˆ°Routerä¸­Router.init(historyModule);//Router æ³¨å†Œç›‘å¬Router.listen(function(location)&#123; console.log(loaction + '-&gt; router setstate');&#125;)// historyModule è§¦å‘å›žè°ƒhistoryModule.updateLocation() è¿”å›žï¼š å¯çœ‹åˆ° historyModule ä¸­å«æœ‰æœºåˆ¶ï¼šhistoryModule.updateLocation() -&gt; listener( )ï¼ŒRouter é€šè¿‡å¯¹å…¶è¿›è¡ŒåŒ…è£…å¼€å‘ï¼Œé’ˆå¯¹ historyModule çš„æœºåˆ¶å¯¹ Router ä¹Ÿèµ·åˆ°äº†ä½œç”¨ï¼Œå³historyModule.updateLocation() å°†è§¦å‘ Router.listen ä¸­çš„å›žè°ƒå‡½æ•° ã€‚ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç è¿™ç§åŒ…è£…å½¢å¼èƒ½å¤Ÿå……åˆ†åˆ©ç”¨åŽŸå¯¹è±¡ï¼ˆhistoryModule ï¼‰çš„å†…éƒ¨æœºåˆ¶ï¼Œå‡å°‘å¼€å‘æˆæœ¬ï¼Œä¹Ÿæ›´å¥½çš„åˆ†ç¦»åŒ…è£…å‡½æ•°ï¼ˆRouterï¼‰çš„é€»è¾‘ï¼Œå‡å°‘å¯¹åŽŸå¯¹è±¡çš„å½±å“ã€‚ react-router ä½¿ç”¨æ–¹å¼react-router ä»¥ react component çš„ç»„ä»¶æ–¹å¼æä¾› APIï¼Œ åŒ…å« Routerï¼ŒRouteï¼ŒRedirectï¼ŒLink ç­‰ç­‰ï¼Œè¿™æ ·èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ react component æä¾›çš„ç”Ÿå‘½å‘¨æœŸç‰¹æ€§ï¼ŒåŒæ—¶ä¹Ÿè®©å®šä¹‰è·¯ç”±è·Ÿå†™ react component è¾¾åˆ°ç»Ÿä¸€ï¼Œå¦‚ä¸‹ 1234567891011render((&lt;Router history=&#123;browserHistory&#125;&gt; &lt;Route path="/" component=&#123;App&#125;&gt; &lt;Route path="about" component=&#123;About&#125;/&gt; &lt;Route path="users" component=&#123;Users&#125;&gt; &lt;Route path="/user/:userId" component=&#123;User&#125;/&gt; &lt;/Route&gt; &lt;Route path="*" component=&#123;NoMatch&#125;/&gt; &lt;/Route&gt;&lt;/Router&gt;), document.body) å°±è¿™æ ·ï¼Œå£°æ˜Žäº†ä¸€ä»½å«æœ‰ path to component çš„å„ä¸ªæ˜ å°„çš„è·¯ç”±è¡¨ã€‚ react-router è¿˜æä¾›çš„ Link ç»„ä»¶ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œä½œä¸ºæä¾›æ›´æ–° url çš„é€”å¾„ï¼Œè§¦å‘ Link åŽæœ€ç»ˆå°†é€šè¿‡å¦‚ä¸Šé¢å®šä¹‰çš„è·¯ç”±è¡¨è¿›è¡ŒåŒ¹é…ï¼Œå¹¶æ‹¿åˆ°å¯¹åº”çš„ component åŠ state è¿›è¡Œ render æ¸²æŸ“é¡µé¢ã€‚ 1&lt;Link to=&#123;`/user/89757`&#125;&gt;'joey'&lt;/Link&gt; è¿™é‡Œä¸ç»†è®² react-router çš„ä½¿ç”¨ï¼Œè¯¦æƒ…å¯è§ï¼šhttps://github.com/reactjs/react-router ä»Žç‚¹å‡» Link åˆ° render å¯¹åº” component ï¼Œè·¯ç”±ä¸­å‘ç”Ÿäº†ä»€ä¹ˆä¸ºä½•èƒ½å¤Ÿè§¦å‘ render component ï¼Ÿä¸»è¦æ˜¯å› ä¸ºè§¦å‘äº† react setState çš„æ–¹æ³•ä»Žè€Œèƒ½å¤Ÿè§¦å‘ render componentã€‚ ä»Žé¡¶å±‚ç»„ä»¶ Router å‡ºå‘ï¼ˆä¸‹é¢ä»£ç ä»Ž react-router/Router ä¸­æ‘˜å–ï¼‰ï¼Œå¯çœ‹åˆ° Router åœ¨ react component ç”Ÿå‘½å‘¨æœŸä¹‹ç»„ä»¶è¢«æŒ‚è½½å‰ componentWillMount ä¸­ä½¿ç”¨ this.history.listen åŽ»æ³¨å†Œäº† url æ›´æ–°çš„å›žè°ƒå‡½æ•°ã€‚å›žè°ƒå‡½æ•°å°†åœ¨ url æ›´æ–°æ—¶è§¦å‘ï¼Œå›žè°ƒä¸­çš„ setState èµ·åˆ° render äº†æ–°çš„ component çš„ä½œç”¨ã€‚ 12345678910111213React.prototype.componentWillMount = function componentWillMount()&#123; var createHistory = this.props.history; this.history = _useRoutes2['default'](createHistory)(&#123; routes: _RouteUtils.createRoutes(routes || children), parseQueryString: parseQueryString, stringifyQuery: stringifyQuery &#125;); this._unlisten = this.history.listen(function (error, state) &#123; _this.setState(state, _this.props.onUpdate); &#125;);&#125; ä¸Šé¢çš„ _useRoutes2 å¯¹ history æ“ä½œä¾¿æ˜¯å¯¹å…¶åšä¸€å±‚åŒ…è£…ï¼Œæ‰€ä»¥è°ƒç”¨çš„ this.history å®žé™…ä¸ºåŒ…è£…ä»¥åŽçš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å«æœ‰ _useRoutes2 ä¸­çš„ listen æ–¹æ³•ï¼Œå¦‚ä¸‹ 12345678function listen(listener)&#123; rerurn listen(function(location)&#123; // .. çœç•¥å…¶ä»– match(location, function (error, redirectLocation, nextState) &#123; listener(null, nextState); &#125;); &#125;)&#125; å¯çœ‹åˆ°ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ† ä½¿ç”¨äº† history æ¨¡å—çš„ listen æ³¨å†Œäº†ä¸€ä¸ªå«æœ‰ setState çš„å›žè°ƒå‡½æ•°ï¼ˆè¿™æ ·å°±èƒ½ä½¿ç”¨ history æ¨¡å—ä¸­çš„æœºåˆ¶ï¼‰ å›žè°ƒä¸­çš„ match æ–¹æ³•ä¸º react-router æ‰€ç‰¹æœ‰ï¼Œmatch å‡½æ•°æ ¹æ®å½“å‰ location ä»¥åŠå‰é¢å†™çš„ Route è·¯ç”±è¡¨åŒ¹é…å‡ºå¯¹åº”çš„è·¯ç”±å­é›†å¾—åˆ°æ–°çš„è·¯ç”±çŠ¶æ€å€¼ stateï¼Œå…·ä½“å®žçŽ°å¯è§ react-router/matchRoutes ï¼Œå†æ ¹æ® state å¾—åˆ°å¯¹åº”çš„ component ï¼Œæœ€ç»ˆæ‰§è¡Œäº† match ä¸­çš„å›žè°ƒ listener(null, nextState) ï¼Œå³æ‰§è¡Œäº† Router ä¸­çš„ç›‘å¬å›žè°ƒï¼ˆsetStateï¼‰ï¼Œä»Žè€Œæ›´æ–°äº†å±•ç¤ºã€‚ ä»¥ä¸Šï¼Œä¸ºèµ·å§‹æ³¨å†Œçš„ç›‘å¬ï¼ŒåŠå›žè°ƒçš„ä½œç”¨ã€‚ å¦‚ä½•è§¦å‘ç›‘å¬çš„å›žè°ƒå‡½æ•°çš„æ‰§è¡Œï¼Ÿè¿™é‡Œè¿˜å¾—ä»Žå¦‚ä½•æ›´æ–° url è¯´èµ·ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œurl æ›´æ–°ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šç®€å•çš„ hash æ›´æ–°æˆ–ä½¿ç”¨ history api è¿›è¡Œåœ°å€æ›´æ–°ã€‚ åœ¨ react-router ä¸­ï¼Œå…¶æä¾›äº† Link ç»„ä»¶ï¼Œè¯¥ç»„ä»¶èƒ½åœ¨ render ä¸­ä½¿ç”¨ï¼Œæœ€ç»ˆä¼šè¡¨çŽ°ä¸º a æ ‡ç­¾ï¼Œå¹¶å°† Link ä¸­çš„å„ä¸ªå‚æ•°ç»„åˆæ”¾å®ƒçš„ href å±žæ€§ä¸­ã€‚å¯ä»¥ä»Ž react-router/ Link ä¸­çœ‹åˆ°ï¼Œå¯¹è¯¥ç»„ä»¶çš„ç‚¹å‡»äº‹ä»¶è¿›è¡Œäº†é˜»æ­¢äº†æµè§ˆå™¨çš„é»˜è®¤è·³è½¬è¡Œä¸ºï¼Œè€Œæ”¹ç”¨ history æ¨¡å—çš„ pushState æ–¹æ³•åŽ»è§¦å‘ url æ›´æ–°ã€‚ 1234567891011121314151617Link.prototype.render = function render() &#123; // .. çœç•¥å…¶ä»– props.onClick = function (e) &#123; return _this.handleClick(e); &#125;; if (history) &#123; // .. çœç•¥å…¶ä»– props.href = history.createHref(to, query); &#125; return _react2['default'].createElement('a', props);&#125;;Link.prototype.handleClick = function handleClick(event) &#123; // .. çœç•¥å…¶ä»– event.preventDefault(); this.context.history.pushState(this.props.state, this.props.to, this.props.query);&#125;; å¯¹ history æ¨¡å—çš„ pushState æ–¹æ³•å¯¹ url çš„æ›´æ–°å½¢å¼ï¼ŒåŒæ ·åˆ†ä¸ºä¸¤ç§ï¼Œåˆ†åˆ«åœ¨ history/createBrowserHistory åŠ history/createHashHistory å„è‡ªçš„ finishTransition ä¸­ï¼Œå¦‚ history/createBrowserHistory ä¸­ä½¿ç”¨çš„æ˜¯ window.history.replaceState(historyState, null, path);è€Œ history/createHashHistory åˆ™ä½¿ç”¨ window.location.hash = urlï¼Œè°ƒç”¨å“ªä¸ªæ˜¯æ ¹æ®æˆ‘ä»¬ä¸€å¼€å§‹åˆ›å»º history çš„æ–¹å¼ã€‚ æ›´æ–° url çš„æ˜¾ç¤ºæ˜¯ä¸€éƒ¨åˆ†ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æ ¹æ® url åŽ»æ›´æ–°å±•ç¤ºï¼Œä¹Ÿå°±æ˜¯è§¦å‘å‰é¢çš„ç›‘å¬ã€‚è¿™æ˜¯åœ¨å‰é¢ finishTransition æ›´æ–° url ä¹‹åŽå®žçŽ°çš„ï¼Œè°ƒç”¨çš„æ˜¯ history/createHistory ä¸­çš„ updateLocation æ–¹æ³•ï¼ŒchangeListeners ä¸­ä¸º history/createHistory ä¸­çš„ listen ä¸­æ‰€æ·»åŠ çš„ï¼Œå¦‚ä¸‹ 1234567891011function updateLocation(newLocation) &#123; // ç¤ºæ„ä»£ç  location = newLocation; changeListeners.forEach(function (listener) &#123; listener(location); &#125;);&#125;function listen(listener) &#123; // ç¤ºæ„ä»£ç  changeListeners.push(listener);&#125; æ€»ç»“ å¯ä»¥å°†ä»¥ä¸Š react-router çš„æ•´ä¸ªåŒ…è£…é—­çŽ¯æ€»ç»“ä¸º å›žè°ƒå‡½æ•°ï¼šå«æœ‰èƒ½å¤Ÿæ›´æ–° react UI çš„ react setState æ–¹æ³•ã€‚ æ³¨å†Œå›žè°ƒï¼šåœ¨ Router componentWillMount ä¸­ä½¿ç”¨ history.listen æ³¨å†Œçš„å›žè°ƒå‡½æ•°ï¼Œæœ€ç»ˆæ”¾åœ¨ history æ¨¡å—çš„ å›žè°ƒå‡½æ•°æ•°ç»„ changeListeners ä¸­ã€‚ è§¦å‘å›žè°ƒï¼šLink ç‚¹å‡»è§¦å‘ history ä¸­å›žè°ƒå‡½æ•°æ•°ç»„ changeListeners çš„æ‰§è¡Œï¼Œä»Žè€Œè§¦å‘åŽŸæ¥ listen ä¸­çš„ setState æ–¹æ³•ï¼Œæ›´æ–°äº†é¡µé¢ è‡³äºŽå‰è¿›ä¸ŽåŽé€€çš„å®žçŽ°ï¼Œæ˜¯é€šè¿‡ç›‘å¬ popstate ä»¥åŠ hashchange çš„äº‹ä»¶ï¼Œå½“å‰è¿›æˆ–åŽé€€ url æ›´æ–°æ—¶ï¼Œè§¦å‘è¿™ä¸¤ä¸ªäº‹ä»¶çš„å›žè°ƒå‡½æ•°ï¼Œå›žè°ƒçš„æ‰§è¡Œæ–¹å¼ Link å¤§è‡´ç›¸åŒï¼Œæœ€ç»ˆåŒæ ·æ›´æ–°äº† UI ï¼Œè¿™é‡Œå°±ä¸å†è¯´æ˜Žã€‚ react-router ä¸»è¦æ˜¯åˆ©ç”¨åº•å±‚ history æ¨¡å—çš„æœºåˆ¶ï¼Œé€šè¿‡ç»“åˆ react çš„æž¶æž„æœºåˆ¶åšä¸€å±‚åŒ…è£…ï¼Œå®žé™…è‡ªèº«çš„å†…å®¹å¹¶ä¸å¤šï¼Œä½†å…¶åŒ…è£…çš„æ€æƒ³ç¬”è€…è®¤ä¸ºå¾ˆå€¼å¾—å­¦ä¹ ï¼Œæœ‰å…´è¶£çš„å»ºè®®é˜…è¯»ä¸‹æºç ï¼Œç›¸ä¿¡ä¼šæœ‰å…¶ä»–æ”¶èŽ·ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <tags>
        <tag>è·¯ç”±</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç§»åŠ¨ç«¯å¸¸è§Bugæ±‡æ€»]]></title>
    <url>%2F2018%2F06%2F08%2FMobile%2F%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%B8%B8%E8%A7%81Bug%E6%B1%87%E6%80%BB%2F</url>
    <content type="text"><![CDATA[å‰è¨€æœ¬æ–‡æ˜¯æ‘˜å½•æ•´ç†äº†ç§»åŠ¨ç«¯å¸¸è§çš„ä¸€äº›bugä»¥åŠè§£å†³æ–¹æ¡ˆ ç‚¹å‡»æ ·å¼é—ªçƒQ: å½“ä½ ç‚¹å‡»ä¸€ä¸ªé“¾æŽ¥æˆ–è€…é€šè¿‡Javascriptå®šä¹‰çš„å¯ç‚¹å‡»å…ƒç´ çš„æ—¶å€™ï¼Œå®ƒå°±ä¼šå‡ºçŽ°ä¸€ä¸ªåŠé€æ˜Žçš„ç°è‰²èƒŒæ™¯ã€‚ A:æ ¹æœ¬åŽŸå› æ˜¯-webkit-tap-highlight-colorï¼Œè¿™ä¸ªå±žæ€§æ˜¯ç”¨äºŽè®¾å®šå…ƒç´ åœ¨ç§»åŠ¨è®¾å¤‡ï¼ˆå¦‚Adnroidã€iOSï¼‰ä¸Šè¢«è§¦å‘ç‚¹å‡»äº‹ä»¶æ—¶ï¼Œå“åº”çš„èƒŒæ™¯æ¡†çš„é¢œè‰²ã€‚å»ºè®®å†™åœ¨æ ·å¼åˆå§‹åŒ–ä¸­ä»¥é¿å…æ‰€ä»¥é—®é¢˜ï¼šdiv,input(selector) {-webkit-tap-highlight-color: rgba(0,0,0,0);}å¦å¤–å‡ºçŽ°è“è‰²è¾¹æ¡†ï¼šoutline:noneï¼› 123-webkit-tap-highlight-color : rgba (255, 255, 255, 0) ;// i.e . Nexus5/Chrome and Kindle Fire HD 7 ''-webkit-tap-highlight-color : transparent ; å±è”½ç”¨æˆ·é€‰æ‹©Q: ç¦æ­¢ç”¨æˆ·é€‰æ‹©é¡µé¢ä¸­çš„æ–‡å­—æˆ–è€…å›¾ç‰‡ A:ä»£ç å¦‚ä¸‹ 123456-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none; ç§»åŠ¨ç«¯å¦‚ä½•æ¸…é™¤è¾“å…¥æ¡†å†…é˜´å½±Q: åœ¨iOSä¸Šï¼Œè¾“å…¥æ¡†é»˜è®¤æœ‰å†…éƒ¨é˜´å½±ï¼Œä½†æ— æ³•ä½¿ç”¨ box-shadow æ¥æ¸…é™¤ï¼Œå¦‚æžœä¸éœ€è¦é˜´å½±ï¼Œå¯ä»¥è¿™æ ·å…³é—­ï¼š A:ä»£ç å¦‚ä¸‹ 1-webkit-appearance: none; ç¦æ­¢æ–‡æœ¬ç¼©æ”¾Q: ç¦æ­¢æ–‡æœ¬ç¼©æ”¾ A:ä»£ç å¦‚ä¸‹ 1-webkit-text-size-adjust: 100%; å¦‚ä½•ç¦æ­¢ä¿å­˜æˆ–æ‹·è´å›¾åƒQ: å¦‚ä½•ç¦æ­¢ä¿å­˜æˆ–æ‹·è´å›¾åƒ A:ä»£ç å¦‚ä¸‹ 12img&#123;-webkit-touch-callout: none;&#125; è§£å†³å­—ä½“åœ¨ç§»åŠ¨ç«¯æ¯”ä¾‹ç¼©å°åŽå‡ºçŽ°é”¯é½¿çš„é—®é¢˜Q: è§£å†³å­—ä½“åœ¨ç§»åŠ¨ç«¯æ¯”ä¾‹ç¼©å°åŽå‡ºçŽ°é”¯é½¿çš„é—®é¢˜ A:ä»£ç å¦‚ä¸‹ 1-webkit-font-smoothing: antialiased; è®¾ç½®inputé‡Œé¢placeholderå­—ä½“çš„å¤§å°Q: è®¾ç½®inputé‡Œé¢placeholderå­—ä½“çš„å¤§å° A:ä»£ç å¦‚ä¸‹ 1::-webkit-input-placeholder&#123; font-size:10pt;&#125; audioå…ƒç´ å’Œvideoå…ƒç´ åœ¨ioså’Œandriodä¸­æ— æ³•è‡ªåŠ¨æ’­æ”¾Q: audioå…ƒç´ å’Œvideoå…ƒç´ åœ¨ioså’Œandriodä¸­æ— æ³•è‡ªåŠ¨æ’­æ”¾ A:ä»£ç å¦‚ä¸‹,è§¦å±åŠæ’­æ”¾ 123$('html').on('touchstart',function()&#123;audio.play()&#125;) æ‰‹æœºæ‹ç…§å’Œä¸Šä¼ å›¾ç‰‡Q: é’ˆå¯¹fileç±»åž‹å¢žåŠ ä¸åŒçš„acceptå­—æ®µ A:ä»£ç å¦‚ä¸‹ 12345&lt;input type="file"&gt;çš„accept å±žæ€§&lt;!-- é€‰æ‹©ç…§ç‰‡ --&gt;&lt;input type=file accept="image/*"&gt;&lt;!-- é€‰æ‹©è§†é¢‘ --&gt;&lt;input type=file accept="video/*"&gt; è¾“å…¥æ¡†è‡ªåŠ¨å¡«å……é¢œè‰²Q: é’ˆå¯¹inputæ ‡ç­¾å·²ç»è¾“å…¥è¿‡çš„ï¼Œä¼šé’ˆå¯¹æ›¾ç»è¾“å…¥çš„å†…å®¹å¡«å……é»„è‰²èƒŒæ™¯ï¼Œè¿™æ˜¯webkitå†…æ ¸è‡ªåŠ¨æ·»åŠ çš„ï¼Œå¯¹åº”çš„å±žæ€§æ˜¯autocomplete,é»˜è®¤æ˜¯on,å¦å¯¹åº”çš„æ ·å¼æ˜¯input:-webkit-autofill ä¸”æ˜¯ä¸å¯æ›´æ”¹çš„ã€‚ A:æ–¹æ¡ˆå¦‚ä¸‹ 1 è®¾ç½®æ ‡ç­¾çš„autocomplete=â€offâ€,äº²æµ‹æ— æ•ˆå¯èƒ½ 2 è®¾ç½®ç›’å­çš„å†…é˜´å½±ä¸ºä½ å¸¸æ€çš„é¢œè‰²ï¼ˆä¸‹é¢ä»¥ç™½è‰²ä¸ºä¾‹ï¼‰ 12box-shadow:0 0 0 1000px #fff inset ;-webkit-box-shadow: 0 0 0px 1000px #fff inset; å¼€å¯ç¡¬ä»¶åŠ é€ŸQ: ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ A:ä»£ç å¦‚ä¸‹ 1234-webkit-transform: translate3d(0, 0, 0);-moz-transform: translate3d(0, 0, 0);-ms-transform: translate3d(0, 0, 0);transform: translate3d(0, 0, 0); ç”¨æˆ·è®¾ç½®å­—å·æ”¾å¤§æˆ–è€…ç¼©å°å¯¼è‡´é¡µé¢å¸ƒå±€é”™è¯¯123456body &#123; -webkit-text-size-adjust: 100% !important; text-size-adjust: 100% !important; -moz-text-size-adjust: 100% !important; &#125; ç§»åŠ¨ç«¯åŽ»é™¤typeä¸ºnumberçš„ç®­å¤´1234input::-webkit-outer-spin-button,input::-webkit-inner-spin-button&#123; -webkit-appearance: none !important; margin: 0; &#125; å®žçŽ°æ¨ªå±ç«–å±çš„æ–¹æ¡ˆcss ç”¨ css3åª’ä½“æŸ¥è¯¢ï¼Œç¼ºç‚¹æ˜¯å®½åº¦å’Œé«˜åº¦ä¸å¥½æŽ§åˆ¶123456789101112131415161718192021@media screen and (orientation: portrait) &#123; .main &#123; -webkit-transform:rotate(-90deg); -moz-transform: rotate(-90deg); -ms-transform: rotate(-90deg); transform: rotate(-90deg); width: 100vh; height: 100vh; /*åŽ»æŽ‰overflow å¾®ä¿¡æ˜¾ç¤ºæ­£å¸¸ï¼Œä½†æ˜¯æµè§ˆå™¨æœ‰é—®é¢˜ï¼Œç«–å±æ—¶å¼ºåˆ¶æ¨ªå±ç¼©å°*/ overflow: hidden; &#125;&#125;@media screen and (orientation: landscape) &#123; .main &#123; -webkit-transform:rotate(0); -moz-transform: rotate(0); -ms-transform: rotate(0); transform: rotate(0) &#125;&#125; js åˆ¤æ–­å±å¹•çš„æ–¹å‘æˆ–è€…resizeäº‹ä»¶123456789101112131415161718192021222324var evt = "onorientationchange" in window ? "orientationchange" : "resize"; window.addEventListener(evt, function() &#123; var width = document.documentElement.clientWidth; var height = document.documentElement.clientHeight; $print = $('#print'); if( width &gt; height )&#123; $print.width(width); $print.height(height); $print.css('top', 0 ); $print.css('left', 0 ); $print.css('transform' , 'none'); $print.css('transform-origin' , '50% 50%'); &#125; else&#123; $print.width(height); $print.height(width); $print.css('top', (height-width)/2 ); $print.css('left', 0-(height-width)/2 ); $print.css('transform' , 'rotate(90deg)'); $print.css('transform-origin' , '50% 50%'); &#125; &#125;, false); åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Bug</category>
      </categories>
      <tags>
        <tag>Mobile</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ•™ç§‘ä¹¦å¼çš„æ­£åˆ™åŒ¹é…]]></title>
    <url>%2F2018%2F06%2F03%2Fstudy%2F%E6%95%99%E7%A7%91%E4%B9%A6%E5%BC%8F%E7%9A%84%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%2F</url>
    <content type="text"><![CDATA[å‰è¨€ æ­£åˆ™åœ¨jsä¸­æ˜¯ä¸€ç±»æ¯”è¾ƒç‰¹æ®Šçš„å¯¹è±¡ï¼Œå®ƒå¯ä»¥åŒ¹é…å„ä¸ªåœºæ™¯éœ€è¦çš„æ ¼å¼éªŒè¯ï¼Œä¾‹å¦‚é‚®ç®±ã€æ‰‹æœºå·ã€ç”¨æˆ·ç™»å½•åã€å¯†ç ç­‰ç­‰ï¼Œä¼¼ä¹Žæ— å¤„ä¸åœ¨ï¼Œåœ¨å¸¸è§çš„å­—ç¬¦ä¸²æ£€ç´¢æˆ–æ›¿æ¢ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸€ç§æ¨¡å¼è¡¨ç¤ºæ£€ç´¢æˆ–æ›¿æ¢çš„è§„åˆ™ï¼Œæ¥åŒ¹é…ä¸€ç³»åˆ—ç¬¦åˆæŸä¸ªå¥æ³•è§„åˆ™çš„å­—ç¬¦ä¸²ã€‚ ä»¥ä¸‹æ˜¯æ­£åˆ™çš„è¾ƒä¸ºå®˜æ–¹çš„è§£é‡Šï¼š æ­£åˆ™è¡¨è¾¾å¼æ˜¯ç”¨äºŽåŒ¹é…å­—ç¬¦ä¸²ä¸­å­—ç¬¦ç»„åˆçš„æ¨¡å¼ã€‚åœ¨ JavaScriptä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯¹è±¡ã€‚è¿™äº›æ¨¡å¼è¢«ç”¨äºŽ RegExp çš„ exec å’Œ test æ–¹æ³•, ä»¥åŠ String çš„ matchã€replaceã€search å’Œ split æ–¹æ³•ã€‚ åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼ˆä»¥ä¸‹æœ‰ä¸¤ç§æ–¹å¼æ¥å‚è€ƒï¼‰ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æž„é€ å‡½æ•°ï¼ˆnew çš„æ–¹å¼æ¥åˆ›å»º)12345let regex = new RegExp("a")let regex = new RegExp("^[a-zA-Z]",'g') ; //å½“ä½¿ç”¨å¼•å·æ—¶ä¸å¿…å†åŠ åæ–œæ â€™ï¼â€™let regex = new RegExp(/^[a-zA-Z]/,'gi'); //å½“æœ‰æ–œæ æ—¶å°± ä¸ç”¨å†åŠ å¼•å· åˆ›å»ºå­—é¢é‡ï¼ˆç”±ä¸¤ä¸ªæ–œæ â€™ï¼ï¼â€™åŒ…è£¹éœ€è¦åŒ¹é…çš„å†…å®¹)123let regex = /ab/ ;let regex=/^[a-zA-Z]/ ; è¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥æ¥åˆ›å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä½†æ˜¯ç›¸å¯¹æ¥è¯´ç¬¬äºŒç§æ–¹å¼æ›´åŠ å¸¸ç”¨ä¸€äº›ã€‚ æ­£åˆ™è¡¨è¾¾å¼çš„å‚æ•°ï¼Œå†™åœ¨//åŽé¢ï¼Œå¯æ··åˆä½¿ç”¨ g å…¨å±€åŒ¹é…;æ‰¾åˆ°æ‰€æœ‰åŒ¹é…ï¼Œè€Œä¸æ˜¯åœ¨ç¬¬ä¸€ä¸ªåŒ¹é…åŽåœæ­¢ i åŒ¹é…å…¨éƒ¨å¤§å°å†™ m å¤šè¡Œ; å°†å¼€å§‹å’Œç»“æŸå­—ç¬¦ï¼ˆ^å’Œ$ï¼‰è§†ä¸ºåœ¨å¤šè¡Œä¸Šå·¥ä½œï¼ˆä¹Ÿå°±æ˜¯ï¼Œåˆ†åˆ«åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å§‹å’Œç»“æŸï¼ˆç”± \n æˆ– \r åˆ†å‰²ï¼‰ï¼Œè€Œä¸åªæ˜¯åªåŒ¹é…æ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸²çš„æœ€å¼€å§‹å’Œæœ€æœ«å°¾å¤„ã€‚ s ä¸Žmç›¸åï¼Œå•è¡ŒåŒ¹é… let regex=/^[a-zA-Z]/gim ; æ­£åˆ™ä¸­å¸¸ç”¨æ–¹æ³•ä»¥åŠå­—ç¬¦ä¸²ä¸­ä¸Žæ­£åˆ™ç›¸å…³çš„æ–¹æ³•test()æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„å€¼æ˜¯å¦åŒ¹é…ç»™å‡ºçš„æ­£åˆ™è§„åˆ™,è¿”å›žå¸ƒå°”å€¼ trueæˆ–falseã€‚æ£€ç´¢â€abâ€æ˜¯å¦åŒ¹é…å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼ /../ï¼Œæ­£ç¡®è¿”å›žtrueï¼Œä¸åŒ¹é…è¿”å›žfalse 1/../.test("ab"); // true exec()æ–¹æ³•æ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå€¼ï¼Œå¦‚æžœæ‰¾åˆ°åŒ¹é…çš„æ–‡æœ¬ï¼Œåˆ™è¿”å›žä¸€ä¸ªç»“æžœçš„æ•°ç»„ï¼Œåä¹‹è¿”å›žnullæ£€ç´¢æ­£åˆ™è¡¨è¾¾å¼/abc/æ˜¯å¦æœ‰åœ¨å­—ç¬¦ä¸²ä¸­defaabcæœ‰åŒ¹é…åˆ°ï¼Œè¿”å›žåŒ¹é…åˆ°å†…å®¹ï¼Œç´¢å¼•å€¼ï¼Œä»¥åŠæ£€ç´¢çš„å­—ç¬¦ä¸² 1234/abc/.exec("defaabc") // ["abc", index: 4, input: "defaabc"]// æ£€ç´¢/qqq/æ˜¯å¦åœ¨abcdefaabcä¸­åŒ¹é…åˆ°ï¼Œè¿”å›ž null/qqq/.exec("abcdefaabc") // null compile()æ–¹æ³•ç”¨äºŽæ”¹å˜æ­£åˆ™åŒ¹é…å†…å®¹å°†/abc/çš„åŒ¹é…å†…å®¹æ”¹æˆåŽé¢çš„å­—ç¬¦ä¸²çš„å†…å®¹ 1/abc/.compile('defâ€™) // /def/ split()å°†å­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„å°†å­—ç¬¦ä¸²abcdä»¥/b/ä¸­çš„båˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„ 1"abcd".split(/b/); // ["a", "cd"] replace()æ–¹æ³•ç”¨äºŽåœ¨å­—ç¬¦ä¸²ä¸­ç”¨ä¸€äº›å­—ç¬¦æ›¿æ¢å¦ä¸€äº›å­—ç¬¦æˆ–è€…æ›¿æ¢ä¸€ä¸ªä¸Žæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­—ç¬¦ä¸²12345678//ç”¨æ­£åˆ™å†…å®¹/\d\d\d/åŽ»åŒ¹é…å­—ç¬¦ä¸²12345abcdeï¼Œå°†åŒ¹é…çš„å†…å®¹æ›¿æ¢æˆ*ï¼Œå¹¶è¿”å›žæ›¿æ¢å®Œæˆçš„å­—ç¬¦ä¸²'12345abcde'.replace(/\d\d\d/g,'*'); // "*45abcde"// åŽ»æŽ‰å­—ç¬¦ä¸²çš„å¼•å·ï¼Œå…¨å±€æ£€ç´¢'ï¼Œæ›¿æ¢æˆ''ç©º'12345abcde'.replace(/'/g,''); //12345abcde// åŽ»æŽ‰å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„ç©ºæ ¼ï¼Œtab,æ¢é¡µç¬¦ï¼Œæ¢è¡Œç¬¦' 12 345ab cd e '.replace(/\s/g,''); // "12345abcde" search() ç”¨äºŽæ£€ç´¢å­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²æˆ–ä¸Žæ­£åˆ™è¡¨è¾¾å¼ç›¸åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œè¿”å›žåŒ¹é…çš„å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®çš„ç´¢å¼•ï¼Œåä¹‹è¿”å›ž-11234567'abcdedfasdfs'.search(/d/); // 3// å³ä½¿æ˜¯å…¨å±€åŒ¹é…ï¼Œä¹Ÿåªä¼šåŒ¹é…åˆ°ç¬¬ä¸€ä¸ªçš„ä½ç½®'abcdedfasdfs'.search(/d/g); // 3// å¦‚æžœæ²¡æœ‰åŒ¹é…åˆ°ï¼Œè¿”å›ž-1'abcdedfasdfs'.search(/o/g); // -1 match()æ–¹æ³•å¯åœ¨å­—ç¬¦ä¸²å†…æ£€ç´¢æŒ‡å®šçš„å€¼ï¼Œæˆ–æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…12// æ£€ç´¢æŒ‡å®šçš„å€¼ï¼Œå¹¶è¿”å›ž,b+æŒ‡å¤šä¸ª"aabbbbccbbaab".match(/b+/g); // ["bbbb", "bb", "b"] æ­£åˆ™è§„åˆ™ï¼ˆå¸¸ç”¨)å­—ç¬¦ç±»è§„åˆ™ èŒƒå›´ç¬¦å·åŒ¹é…è§„åˆ™ åˆ†ç»„åŒ¹é…è§„åˆ™ é‡å¤åŒ¹é…è§„åˆ™ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>RegExp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ–°ä¸€ä»£çš„å‰ç«¯å­˜å‚¨æ–¹æ¡ˆ--indexedDB]]></title>
    <url>%2F2018%2F05%2F27%2Fstudy%2F%E6%96%B0%E4%B8%80%E4%BB%A3%E7%9A%84%E5%89%8D%E7%AB%AF%E5%AD%98%E5%82%A8%E6%96%B9%E6%A1%88-indexedDB%2F</url>
    <content type="text"><![CDATA[å‰ç«¯å­˜å‚¨ æˆ‘ä»¬éƒ½çŸ¥é“åœ¨å‰ç«¯å¼€å‘å½“ä¸­,æœ‰æ—¶ä¼šå› ä¸ºæŸäº›éœ€æ±‚,è¦å°†ä¸€äº›æ•°æ®å­˜å‚¨åœ¨å‰ç«¯æœ¬åœ°å½“ä¸­.æ¯”å¦‚è¯´:ä¸ºäº†ä¼˜åŒ–æ€§èƒ½,å°†ä¸€äº›å¸¸ç”¨çš„æ•°æ®å­˜åœ¨æœ¬åœ°,è¿™æ ·ä»¥åŽéœ€è¦çš„æ—¶å€™ç›´æŽ¥ä»Žæœ¬åœ°æ‹¿,ä¸éœ€è¦å†å‘åŽç«¯è¿›è¡Œè¯·æ±‚.è¿˜æœ‰å°±æ˜¯ä¸ºäº†é˜²æ­¢CSRFæ”»å‡»,åŽç«¯ç»™å‰ç«¯ä¸€ä¸ªtoken,å‰ç«¯å°±éœ€è¦å°†è¿™ä¸ªtokenå­˜åœ¨æœ¬åœ°.ä¹‹åŽæ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦å¸¦ä¸Šè¿™ä¸ªtoken.ç­‰ç­‰ä¸ä¸€è€Œè¶³. è€Œè¿™äº›éœ€æ±‚å°±ä¸æ²¹é¿å…çš„é€ å°±ä¸€ä¸ªå‰ç«¯çš„å‘å±•æ–¹å‘â€“å‰ç«¯å­˜å‚¨ åœ¨å‰ç«¯çš„â€™ä¸Šå¤æ—¶ä»£â€™é‡Œ,æˆ‘ä»¬å‰ç«¯æƒ³è¦å­˜å‚¨æ•°æ®,åªæœ‰ä¸€ç§æ–¹å¼,é‚£å°±æ˜¯Cookie.ä½†æ˜¯Cookieè™½ç„¶å¯ä»¥åšå‰ç«¯å­˜å‚¨æ–¹æ¡ˆ,ä½†æ˜¯å´ä¹Ÿæœ‰ç€å¾ˆå¤šå±€é™æ€§.é¦–å…ˆå®ƒçš„å­˜å‚¨ç©ºé—´å¤§å°åªæœ‰4K,å…¶æ¬¡å®ƒçš„å­˜å‚¨æœ‰æ•ˆæ—¶é—´æœ‰é™åˆ¶,ç„¶åŽå­˜åœ¨Cookieä¸­çš„æ•°æ®,åœ¨ä½ æ¯æ¬¡è¿›è¡Œè¯·æ±‚çš„æ—¶å€™éƒ½ä¼šå°†å®ƒå¸¦ä¸Š.ä½¿å¾—æ¯æ¬¡çš„è¯·æ±‚æ•°æ®éƒ½ä¼šæ— æ„ä¹‰çš„å¢žå¤§. æœ€åŽ,ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€ç‚¹.Cookieè®¾è®¡ä¹‹åˆå°±ä¸æ˜¯å°±æ˜¯è®©æˆ‘ä»¬å‰ç«¯å­˜æ•°æ®ç”¨çš„.å®ƒåªæ˜¯ä¸ºäº†è®©ç½‘ç«™éªŒè¯ç”¨æˆ·èº«ä»½ç”¨çš„.è‡³äºŽCookieçš„æœ¬åœ°å­˜å‚¨åŠŸèƒ½åªæ˜¯å®ƒçš„ä¸€ä¸ªæ‰‹æ®µè€Œå·².å…³äºŽè¿™ç‚¹ä½ ä»¬å¯ä»¥çœ‹ä¸‹æˆ‘çš„å¦å¤–ä¸€ç¯‡æ–‡ç« â€”åœ¨HTML5çš„æ—¶ä»£,é‡æ–°è®¤è¯†Cookie ç»¼ä¸Šæ‰€è¿°,ä½¿ç”¨Cookieä½œä¸ºå‰ç«¯å­˜å‚¨æœ‰è¿™è®¸å¤šç¼ºç‚¹,æ‰€ä»¥ç»è¿‡å‰ç«¯ç¤¾åŒºçš„ä¸æ–­åŠªåŠ›,åœ¨HTML5ä¸­æœ‰äº†çœŸæ­£çš„å‰ç«¯å­˜å‚¨æ–¹æ¡ˆWeb Storage.å®ƒåˆ†ä¸ºä¸¤ç§,ä¸€ç§æ˜¯æ°¸ä¹…å­˜å‚¨çš„localStorage,ä¸€ç§æ˜¯ä¼šè¯æœŸé—´å­˜å‚¨çš„sessionStorage.å¯¹æ¯”Cookie,Web Storageçš„ä¼˜åŠ¿å¾ˆæ˜Žæ˜¾: å­˜å‚¨ç©ºé—´æ›´å¤§,æœ‰5Må¤§å° åœ¨æµè§ˆå™¨å‘é€è¯·æ±‚æ˜¯ä¸ä¼šå¸¦ä¸Šweb Storageé‡Œçš„æ•°æ® æ›´åŠ å‹å¥½çš„API å¯ä»¥åšæ°¸ä¹…å­˜å‚¨(localStorage). è¿™ä¸€åˆ‡çœ‹èµ·æ¥å¾ˆå®Œç¾Ž,ä½†æ˜¯éšç€å‰ç«¯çš„ä¸æ–­å‘å±•,web Storageä¹Ÿæœ‰äº†ä¸€äº›ä¸å¤ªåˆé€‚çš„åœ°æ–¹: éšç€webåº”ç”¨ç¨‹åºçš„ä¸æ–­å‘å±•,5Mçš„å­˜å‚¨å¤§å°å¯¹äºŽä¸€äº›å¤§åž‹çš„webåº”ç”¨ç¨‹åºæ¥è¯´æœ‰äº›ä¸å¤Ÿ web Storageåªèƒ½å­˜å‚¨stringç±»åž‹çš„æ•°æ®.å¯¹äºŽObjectç±»åž‹çš„æ•°æ®åªèƒ½å…ˆç”¨JSON.stringify()è½¬æ¢ä¸€ä¸‹åœ¨å­˜å‚¨. åŸºäºŽä¸Šè¿°åŽŸå› ,å‰ç«¯ç¤¾åŒºåˆæå‡ºäº†æµè§ˆå™¨æ•°æ®åº“å­˜å‚¨è¿™ä¸ªæ¦‚å¿µ.è€ŒWeb SQL Databaseå’ŒindexedDB(ç´¢å¼•æ•°æ®åº“)æ˜¯å¯¹è¿™ä¸ªæ¦‚å¿µçš„å®žçŽ°.å…¶ä¸­Web SQL Databaseåœ¨ç›®å‰æ¥è¯´åŸºæœ¬å·²ç»è¢«æ”¾å¼ƒ.æ‰€ä»¥ç›®å‰ä¸»æµçš„æµè§ˆå™¨æ•°æ®åº“çš„å®žçŽ°å°±æ˜¯indexedDB(ç´¢å¼•æ•°æ®åº“).ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦ä»‹ç»çš„ æ–°ä¸€ä»£çš„å‰ç«¯å­˜å‚¨æ–¹æ¡ˆâ€“indexedDB ä»€ä¹ˆæ˜¯indexedDBindexedDBçš„ä»‹ç» IndexedDB æ˜¯ä¸€ç§ä½¿ç”¨æµè§ˆå™¨å­˜å‚¨å¤§é‡æ•°æ®çš„æ–¹æ³•.å®ƒåˆ›é€ çš„æ•°æ®å¯ä»¥è¢«æŸ¥è¯¢ï¼Œå¹¶ä¸”å¯ä»¥ç¦»çº¿ä½¿ç”¨. IndexedDBå¯¹äºŽé‚£äº›éœ€è¦å­˜å‚¨å¤§é‡æ•°æ®ï¼Œæˆ–è€…æ˜¯éœ€è¦ç¦»çº¿ä½¿ç”¨çš„ç¨‹åºæ˜¯éžå¸¸æœ‰æ•ˆçš„è§£å†³æ–¹æ³•. â€” MDN indexedDBçš„æ¦‚å¿µ ä½¿ç”¨IndexedDBï¼Œä½ å¯ä»¥å­˜å‚¨æˆ–è€…èŽ·å–æ•°æ®ï¼Œä½¿ç”¨ä¸€ä¸ªkeyç´¢å¼•çš„ã€‚ ä½ å¯ä»¥åœ¨äº‹åŠ¡(transaction)ä¸­å®Œæˆå¯¹æ•°æ®çš„ä¿®æ”¹ã€‚å’Œå¤§å¤šæ•°webå­˜å‚¨è§£å†³æ–¹æ¡ˆç›¸åŒï¼ŒindexedDBä¹Ÿéµä»ŽåŒæºåè®®(same-origin policy). æ‰€ä»¥ä½ åªèƒ½è®¿é—®åŒåŸŸä¸­å­˜å‚¨çš„æ•°æ®ï¼Œè€Œä¸èƒ½è®¿é—®å…¶ä»–åŸŸçš„ã€‚APIåŒ…å«å¼‚æ­¥(asynchronous) API å’ŒåŒæ­¥(synchronous)APIä¸¤ç§ã€‚ å¼‚æ­¥APIé€‚åˆå¤§å¤šæ•°æƒ…å†µ, åŒæ­¥APIå¿…é¡»åŒ WebWorkersä¸€åŒä½¿ç”¨. ç›®å‰ï¼Œæ²¡æœ‰ä¸»æµæµè§ˆå™¨æ”¯æŒåŒæ­¥APIã€‚ å³ä½¿åŒæ­¥APIè¢«æ”¯æŒäº†ï¼Œä½ ä¹Ÿä¼šåœ¨å¤§å¤šæ•°çš„æƒ…å†µä½¿ç”¨å¼‚æ­¥APIã€‚IndexedDB æ˜¯ WebSQL æ•°æ®åº“çš„å–ä»£å“, W3Cç»„ç»‡åœ¨2010å¹´11æœˆ18æ—¥åºŸå¼ƒäº†webSql. IndexedDB å’ŒWebSQLçš„ä¸åŒç‚¹åœ¨äºŽWebSQL æ˜¯å…³ç³»åž‹æ•°æ®åº“ï¼ˆå¤æ‚ï¼‰IndexedDB æ˜¯key-valueåž‹æ•°æ®åº“ï¼ˆç®€å•å¥½ä½¿ï¼‰. ä¸Šé¢æ˜¯MDNä¸Šå¯¹äºŽIndexedDBçš„ä»‹ç».å…¶ç®€å•è€Œè¨€,indexedDBå°±æ˜¯ä¸€ä¸ªåŸºäºŽäº‹åŠ¡æ“ä½œçš„key-valueåž‹æ•°å‰ç«¯æ•°æ®åº“.å…¶APIå¤§å¤šæ˜¯å¼‚æ­¥çš„ indexedDBçš„ä½¿ç”¨åˆ›å»ºä¸€ä¸ªindexedDBæ•°æ®åº“12345678const request = indexedDB.open('myDatabase',1);request.addEventListener('success', e =&gt; &#123; console.log("è¿žæŽ¥æ•°æ®åº“æˆåŠŸ");&#125;);request.addEventListener('error', e =&gt; &#123; console.log("è¿žæŽ¥æ•°æ®åº“å¤±è´¥");&#125;); åœ¨ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬ä½¿ç”¨indexedDB.open()åˆ›å»ºä¸€ä¸ªindexedDBæ•°æ®åº“.open()æ–¹æ³•æŽ¥å—å¯ä»¥æŽ¥å—ä¸¤ä¸ªå‚æ•°. ç¬¬ä¸€ä¸ªæ˜¯æ•°æ®åº“å,ç¬¬äºŒä¸ªæ˜¯æ•°æ®åº“çš„ç‰ˆæœ¬å·.åŒæ—¶è¿”å›žä¸€ä¸ªIDBOpenDBRequestå¯¹è±¡ç”¨äºŽæ“ä½œæ•°æ®åº“.å…¶ä¸­å¯¹äºŽopen()çš„ç¬¬ä¸€ä¸ªå‚æ•°æ•°æ®åº“å,open()ä¼šå…ˆåŽ»æŸ¥æ‰¾æœ¬åœ°æ˜¯å¦å·²æœ‰è¿™ä¸ªæ•°æ®åº“,å¦‚æžœæœ‰åˆ™ç›´æŽ¥å°†è¿™ä¸ªæ•°æ®åº“è¿”å›ž,å¦‚æžœæ²¡æœ‰,åˆ™å…ˆåˆ›å»ºè¿™ä¸ªæ•°æ®åº“,å†è¿”å›ž.å¯¹äºŽç¬¬äºŒä¸ªå‚æ•°ç‰ˆæœ¬å·,åˆ™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°,å¦‚æžœä¸ä¼ ,é»˜è®¤ä¸º1.ä½†å¦‚æžœä¼ å…¥å°±å¿…é¡»æ˜¯ä¸€ä¸ªæ•´æ•°. åœ¨é€šè¿‡å¯¹indexedDB.open()æ–¹æ³•æ‹¿åˆ°ä¸€ä¸ªæ•°æ®åº“å¯¹è±¡IDBOpenDBRequestæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›‘å¬è¿™ä¸ªå¯¹è±¡çš„successäº‹ä»¶å’Œerroräº‹ä»¶æ¥æ‰§è¡Œç›¸åº”çš„æ“ä½œ. åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“å†æœ‰äº†ä¸€ä¸ªæ•°æ®åº“ä¹‹åŽ,æˆ‘ä»¬èŽ·å–å°±æƒ³è¦åŽ»å­˜å‚¨æ•°æ®äº†,ä½†æ˜¯å•åªæœ‰æ•°æ®åº“è¿˜ä¸å¤Ÿ,æˆ‘ä»¬è¿˜éœ€è¦æœ‰å¯¹è±¡ä»“åº“(object store).å¯¹è±¡ä»“åº“(object store)æ˜¯indexedDBæ•°æ®åº“çš„åŸºç¡€,å…¶ç±»ä¼¼äºŽMySQLä¸­è¡¨çš„æ¦‚å¿µ. è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä»“åº“å¿…é¡»åœ¨upgradeneededäº‹ä»¶ä¸­,è€Œupgradeneededäº‹ä»¶åªä¼šåœ¨ç‰ˆæœ¬å·æ›´æ–°çš„æ—¶å€™è§¦å‘.è¿™æ˜¯å› ä¸ºindexedDB APIä¸­ä¸å…è®¸æ•°æ®åº“ä¸­çš„æ•°æ®ä»“åº“åœ¨åŒä¸€ç‰ˆæœ¬ä¸­å‘ç”Ÿå˜åŒ– 1234567const request = indexedDB.open('myDatabase',2);request.addEventListener('upgradeneeded',e =&gt; &#123; const db = e.target.result; const store = db.createObjectStore('User',&#123;keyPath: 'userId',autoIncrement: false&#125;); console.log('åˆ›å»ºå¯¹è±¡ä»“åº“æˆåŠŸ');&#125;) åœ¨ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬ç›‘å¬upgradeneededäº‹ä»¶,å¹¶åœ¨è¿™ä¸ªäº‹ä»¶è§¦å‘æ—¶ä½¿ç”¨createObjectStore()æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ä»“åº“. createObjectStore()æ–¹æ³•æŽ¥å—ä¸¤ä¸ªå‚æ•°,ç¬¬ä¸€ä¸ªæ˜¯å¯¹è±¡ä»“åº“çš„åå­—,åœ¨åŒä¸€æ•°æ®åº“ä¸­,ä»“åº“åä¸èƒ½é‡å¤.ç¬¬äºŒä¸ªæ˜¯å¯é€‰å‚æ•°.ç”¨äºŽæŒ‡å®šæ•°æ®çš„ä¸»é”®,ä»¥åŠæ˜¯å¦è‡ªå¢žä¸»é”®. åˆ›å»ºäº‹åŠ¡ OKçŽ°åœ¨æˆ‘ä»¬æœ‰äº†æ•°æ®åº“å’Œå¯¹è±¡ä»“åº“äº†,æˆ‘ä»¬æ˜¯å¦å°±å¯ä»¥å­˜å‚¨æ•°æ®äº†äº†.å¾ˆæŠ±æ­‰,è¿˜æ˜¯ä¸è¡Œ.æˆ‘ä»¬è¿˜å·®æœ€åŽä¸€æ ·ä¸œè¥¿â€”-äº‹åŠ¡. ä»€ä¹ˆæ˜¯äº‹åŠ¡ ä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡é€šå¸¸åŒ…å«äº†ä¸€ä¸ªåºåˆ—çš„å¯¹æ•°æ®åº“çš„è¯»/å†™æ“ä½œã€‚å®ƒçš„å­˜åœ¨åŒ…å«æœ‰ä»¥ä¸‹ä¸¤ä¸ªç›®çš„ ä¸ºæ•°æ®åº“æ“ä½œåºåˆ—æä¾›äº†ä¸€ä¸ªä»Žå¤±è´¥ä¸­æ¢å¤åˆ°æ­£å¸¸çŠ¶æ€çš„æ–¹æ³•ï¼ŒåŒæ—¶æä¾›äº†æ•°æ®åº“å³ä½¿åœ¨å¼‚å¸¸çŠ¶æ€ä¸‹ä»èƒ½ä¿æŒä¸€è‡´æ€§çš„æ–¹æ³•ã€‚ å½“å¤šä¸ªåº”ç”¨ç¨‹åºåœ¨å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œå¯ä»¥åœ¨è¿™äº›åº”ç”¨ç¨‹åºä¹‹é—´æä¾›ä¸€ä¸ªéš”ç¦»æ–¹æ³•ï¼Œä»¥é˜²æ­¢å½¼æ­¤çš„æ“ä½œäº’ç›¸å¹²æ‰°ã€‚ å¹¶éžä»»æ„çš„å¯¹æ•°æ®åº“çš„æ“ä½œåºåˆ—éƒ½æ˜¯æ•°æ®åº“äº‹åŠ¡ã€‚æ•°æ®åº“äº‹åŠ¡æ‹¥æœ‰ä»¥ä¸‹å››ä¸ªç‰¹æ€§ï¼Œä¹ æƒ¯ä¸Šè¢«ç§°ä¹‹ä¸ºACIDç‰¹æ€§ã€‚ åŽŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œï¼ŒåŒ…å«åœ¨å…¶ä¸­çš„å¯¹æ•°æ®åº“çš„æ“ä½œè¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡åº”ç¡®ä¿æ•°æ®åº“çš„çŠ¶æ€ä»Žä¸€ä¸ªä¸€è‡´çŠ¶æ€è½¬å˜ä¸ºå¦ä¸€ä¸ªä¸€è‡´çŠ¶æ€ã€‚ä¸€è‡´çŠ¶æ€çš„å«ä¹‰æ˜¯æ•°æ®åº“ä¸­çš„æ•°æ®åº”æ»¡è¶³å®Œæ•´æ€§çº¦æŸ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šå¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸åº”å½±å“å…¶ä»–äº‹åŠ¡çš„æ‰§è¡Œ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šå·²è¢«æäº¤çš„äº‹åŠ¡å¯¹æ•°æ®åº“çš„ä¿®æ”¹åº”è¯¥æ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ ä¸Šé¢æ˜¯ç»´åŸºç™¾ç§‘ä¸Šå¯¹æ•°æ®åº“äº‹åŠ¡çš„è§£é‡Š.ç®€å•æ¥è¯´äº‹åŠ¡å°±æ˜¯ç”¨æ¥ä¿è¯æ•°æ®åº“æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸ,è¦ä¹ˆå…¨éƒ¨å¤±è´¥çš„ä¸€ä¸ªé™åˆ¶.æ¯”å¦‚,åœ¨ä¿®æ”¹å¤šæ¡æ•°æ®æ—¶,å‰é¢å‡ æ¡å·²ç»æˆåŠŸäº†.,åœ¨ä¸­é—´çš„æŸä¸€æ¡æ˜¯å¤±è´¥äº†.é‚£ä¹ˆåœ¨è¿™æ—¶,å¦‚æžœæ˜¯åŸºäºŽäº‹åŠ¡çš„æ•°æ®åº“æ“ä½œ,é‚£ä¹ˆè¿™æ—¶æ•°æ®åº“å°±åº”è¯¥é‡ç½®å‰é¢æ•°æ®çš„ä¿®æ”¹,æ”¾å¼ƒåŽé¢çš„æ•°æ®ä¿®æ”¹.ç›´æŽ¥è¿”å›žé”™è¯¯,ä¸€æ¡æ•°æ®ä¹Ÿä¸ä¿®æ”¹. 1234567const request = indexedDB.open('myDatabase', 3);request.addEventListener('success', e =&gt; &#123; const db = e.target.result; const tx = db.transaction('Users','readwrite');&#125;); ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬ä½¿ç”¨transaction()æ¥åˆ›å»ºä¸€ä¸ªäº‹åŠ¡. transaction()æŽ¥å—ä¸¤ä¸ªå‚æ•°,ç¬¬ä¸€ä¸ªæ˜¯ä½ è¦æ“ä½œçš„å¯¹è±¡ä»“åº“åç§°,ç¬¬äºŒä¸ªæ˜¯ä½ åˆ›å»ºçš„äº‹åŠ¡æ¨¡å¼.ä¼ å…¥ readonlyæ—¶åªèƒ½å¯¹å¯¹è±¡ä»“åº“è¿›è¡Œè¯»æ“ä½œ,æ— æ³•å†™æ“ä½œ.å¯ä»¥ä¼ å…¥readwriteè¿›è¡Œè¯»å†™æ“ä½œ. æ“ä½œæ•°æ® å¥½äº†çŽ°åœ¨æœ‰äº†æ•°æ®åº“,å¯¹è±¡ä»“åº“,äº‹åŠ¡ä¹‹åŽæˆ‘ä»¬ç»ˆäºŽå¯ä»¥å­˜å‚¨æ•°æ®äº†. add() : å¢žåŠ æ•°æ®ã€‚æŽ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä¸ºéœ€è¦ä¿å­˜åˆ°å¯¹è±¡ä»“åº“ä¸­çš„å¯¹è±¡ã€‚ put() : å¢žåŠ æˆ–ä¿®æ”¹æ•°æ®ã€‚æŽ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä¸ºéœ€è¦ä¿å­˜åˆ°å¯¹è±¡ä»“åº“ä¸­çš„å¯¹è±¡ã€‚ get() : èŽ·å–æ•°æ®ã€‚æŽ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä¸ºéœ€è¦èŽ·å–æ•°æ®çš„ä¸»é”®å€¼ã€‚ delete() : åˆ é™¤æ•°æ®ã€‚æŽ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä¸ºéœ€è¦èŽ·å–æ•°æ®çš„ä¸»é”®å€¼ã€‚ add å’Œ put çš„ä½œç”¨ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºŽ put ä¿å­˜æ•°æ®æ—¶ï¼Œå¦‚æžœè¯¥æ•°æ®çš„ä¸»é”®åœ¨æ•°æ®åº“ä¸­å·²ç»æœ‰ç›¸åŒä¸»é”®çš„æ—¶å€™ï¼Œåˆ™ä¼šä¿®æ”¹æ•°æ®åº“ä¸­å¯¹åº”ä¸»é”®çš„å¯¹è±¡ï¼Œè€Œä½¿ç”¨ add ä¿å­˜æ•°æ®ï¼Œå¦‚æžœè¯¥ä¸»é”®å·²ç»å­˜åœ¨ï¼Œåˆ™ä¿å­˜å¤±è´¥ã€‚ æ·»åŠ æ•°æ®12345678910111213141516171819202122232425262728293031const request = indexedDB.open('myDatabase', 3);request.addEventListener('success', e =&gt; &#123; const db = e.target.result; const tx = db.transaction('Users','readwrite'); const store = tx.objectStore('Users'); // ä¿å­˜æ•°æ® const reqAdd = store.add(&#123;'userId': 1, 'userName': 'æŽç™½', 'age': 24&#125;); reqAdd.addEventListener('success', e =&gt; &#123; console.log('ä¿å­˜æˆåŠŸ') &#125;) // èŽ·å–æ•°æ® const reqGet = store.get(1); reqGet.addEventListener('success', e =&gt; &#123; console.log(this.result.userName); // æŽç™½ &#125;) //åˆ é™¤æ•°æ® const reqDelete = store.delete(1); reqDelete.addEventListener('success', e =&gt; &#123; console.log('åˆ é™¤æ•°æ®æˆåŠŸ'); // æŽç™½ &#125;)&#125;); ä½¿ç”¨æ¸¸æ ‡ åœ¨ä¸Šé¢å½“ä¸­æˆ‘ä»¬ä½¿ç”¨get()æ–¹æ³•ä¼ å…¥ä¸€ä¸ªä¸»é”®æ¥èŽ·å–æ•°æ®,ä½†æ˜¯è¿™æ ·åªèƒ½å¤ŸèŽ·å–åˆ°ä¸€æ¡æ•°æ®.å¦‚æžœæˆ‘ä»¬æƒ³è¦èŽ·å–å¤šæ¡æ•°æ®äº†æ€Žä¹ˆåŠž.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¸¸æ ‡,æ¥èŽ·å–ä¸€ä¸ªåŒºé—´å†…çš„æ•°æ®. è¦ä½¿ç”¨æ¸¸æ ‡,æˆ‘ä»¬éœ€è¦ä½¿ç”¨å¯¹è±¡ä»“åº“ä¸Šçš„openCursor()æ–¹æ³•åˆ›å»ºå¸æ‰“å¼€.openCursor()æ–¹æ³•æŽ¥å—ä¸¤ä¸ªå‚æ•°. openCursor(range?: IDBKeyRange | number | string | Date | IDBArrayKey, direction?: IDBCursorDirection): IDBRequest; ç¬¬ä¸€ä¸ªæ˜¯èŒƒå›´,èŒƒå›´å¯ä»¥æ˜¯ä¸€ä¸ªIDBKeyRangeå¯¹è±¡.ç”¨ä»¥ä¸‹æ–¹å¼åˆ›å»º. 1234567891011121314// boundRange è¡¨ç¤ºä¸»é”®å€¼ä»Ž1åˆ°10(åŒ…å«1å’Œ10)çš„é›†åˆã€‚// å¦‚æžœç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºtrueï¼Œåˆ™è¡¨ç¤ºä¸åŒ…å«æœ€å°é”®å€¼1ï¼Œå¦‚æžœç¬¬å››å‚æ•°ä¸ºtrueï¼Œåˆ™è¡¨ç¤ºä¸åŒ…å«æœ€å¤§é”®å€¼10ï¼Œé»˜è®¤éƒ½ä¸ºfalsevar boundRange = IDBKeyRange.bound(1, 10, false, false);// onlyRange è¡¨ç¤ºç”±ä¸€ä¸ªä¸»é”®å€¼çš„é›†åˆã€‚only() å‚æ•°åˆ™ä¸ºä¸»é”®å€¼ï¼Œæ•´æ•°ç±»åž‹ã€‚var onlyRange = IDBKeyRange.only(1);// lowerRaneg è¡¨ç¤ºå¤§äºŽç­‰äºŽ1çš„ä¸»é”®å€¼çš„é›†åˆã€‚// ç¬¬äºŒä¸ªå‚æ•°å¯é€‰ï¼Œä¸ºtrueåˆ™è¡¨ç¤ºä¸åŒ…å«æœ€å°ä¸»é”®1ï¼Œfalseåˆ™åŒ…å«ï¼Œé»˜è®¤ä¸ºfalsevar lowerRange = IDBKeyRange.lowerBound(1, false);// upperRange è¡¨ç¤ºå°äºŽç­‰äºŽ10çš„ä¸»é”®å€¼çš„é›†åˆã€‚// ç¬¬äºŒä¸ªå‚æ•°å¯é€‰ï¼Œä¸ºtrueåˆ™è¡¨ç¤ºä¸åŒ…å«æœ€å¤§ä¸»é”®10ï¼Œfalseåˆ™åŒ…å«ï¼Œé»˜è®¤ä¸ºfalsevar upperRange = IDBKeyRange.upperBound(10, false); ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–¹å‘.ä¸»è¦æœ‰ä¸€ä¸‹å‡ ç§ 1234next : æ¸¸æ ‡ä¸­çš„æ•°æ®æŒ‰ä¸»é”®å€¼å‡åºæŽ’åˆ—ï¼Œä¸»é”®å€¼ç›¸ç­‰çš„æ•°æ®éƒ½è¢«è¯»å–nextunique : æ¸¸æ ‡ä¸­çš„æ•°æ®æŒ‰ä¸»é”®å€¼å‡åºæŽ’åˆ—ï¼Œä¸»é”®å€¼ç›¸ç­‰åªè¯»å–ç¬¬ä¸€æ¡æ•°æ®prev : æ¸¸æ ‡ä¸­çš„æ•°æ®æŒ‰ä¸»é”®å€¼é™åºæŽ’åˆ—ï¼Œä¸»é”®å€¼ç›¸ç­‰çš„æ•°æ®éƒ½è¢«è¯»å–prevunique : æ¸¸æ ‡ä¸­çš„æ•°æ®æŒ‰ä¸»é”®å€¼é™åºæŽ’åˆ—ï¼Œä¸»é”®å€¼ç›¸ç­‰åªè¯»å–ç¬¬ä¸€æ¡æ•°æ® ä¸‹é¢è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ 1234567891011121314151617181920212223const request = indexedDB.open('myDatabase', 4);request.addEventListener('success', e =&gt; &#123; const db = e.target.result; const tx = db.transaction('Users','readwrite'); const store = tx.objectStore('Users'); const range = IDBKeyRange.bound(1,10); const req = store.openCursor(range, 'next'); req.addEventListener('success', e =&gt; &#123; const cursor = this.result; if(cursor)&#123; console.log(cursor.value.userName); cursor.continue(); &#125;else&#123; console.log('æ£€ç´¢ç»“æŸ'); &#125; &#125;)&#125;); åœ¨ä¸Šé¢çš„ä»£ç ä¸­å¦‚æžœæ£€ç´¢åˆ°ç¬¦åˆæ¡ä»¶çš„æ•°æ®æ—¶,æˆ‘ä»¬å¯ä»¥: ä½¿ç”¨cursor.valueæ‹¿åˆ°æ•°æ®.ä½¿ç”¨cursor.updata()æ›´æ–°æ•°æ®.ä½¿ç”¨cursor.delete()åˆ é™¤æ•°æ®.ä½¿ç”¨cursor.continue()è¯»å–ä¸‹ä¸€æ¡æ•°æ®. ç´¢å¼• åœ¨ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬èŽ·å–æ•°æ®éƒ½æ˜¯ç”¨çš„ä¸»é”®.ä½†æ˜¯,åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸çŸ¥é“æˆ‘ä»¬éœ€è¦æ•°æ®çš„ä¸»é”®æ˜¯ä»€ä¹ˆ,æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªå¤§æ¦‚çš„æ¡ä»¶.æ¯”å¦‚è¯´å¹´é¾„å¤§äºŽ20å²çš„ç”¨æˆ·.è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°ç´¢å¼•.ä»¥ä¾¿æœ‰æ¡ä»¶çš„æŸ¥æ‰¾. åˆ›å»ºç´¢å¼• æˆ‘ä»¬ä½¿ç”¨å¯¹è±¡ä»“åº“çš„createIndex()æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªç´¢å¼•. createIndex(name: string, keyPath: string | string[], optionalParameters?: IDBIndexParameters): IDBIndex; createIndex()æ–¹æ³•æŽ¥æ”¶ä¸‰ä¸ªå‚æ•°: ç¬¬ä¸€ä¸ªå‚æ•°nameæ˜¯ç´¢å¼•å,ä¸èƒ½é‡å¤. ç¬¬äºŒä¸ªå‚æ•°keyPathæ˜¯ä½ è¦åœ¨å­˜å‚¨å¯¹è±¡ä¸Šçš„é‚£ä¸ªå±žæ€§ä¸Šå»ºç«‹ç´¢å¼•,å¯ä»¥æ˜¯ä¸€ä¸ªå•ä¸ªçš„keyå€¼,ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«keyå€¼é›†åˆçš„æ•°ç»„. ç¬¬ä¸‰ä¸ªå‚æ•°optionalParametersæ˜¯ä¸€ä¸ªå¯é€‰çš„å¯¹è±¡å‚æ•°{unique, multiEntry} 1.unique: ç”¨æ¥æŒ‡å®šç´¢å¼•å€¼æ˜¯å¦å¯ä»¥é‡å¤,ä¸ºtrueä»£è¡¨ä¸èƒ½ç›¸åŒ,ä¸ºfalseæ—¶ä»£è¡¨å¯ä»¥ç›¸åŒ2.multiEntry: å½“ç¬¬äºŒä¸ªå‚æ•°keyPathä¸ºä¸€ä¸ªæ•°ç»„æ—¶.å¦‚æžœmultiEntryæ˜¯true,åˆ™ä¼šä»¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å»ºç«‹ä¸€æ¡ç´¢å¼•.å¦‚æžœæ˜¯false,åˆ™ä»¥æ•´ä¸ªæ•°ç»„ä¸ºkeyPathå€¼,æ·»åŠ ä¸€æ¡ç´¢å¼•. 1234567const request = indexedDB.open('myDatabase', 5);request.addEventListener('upgradeneeded', e =&gt; &#123; const db = e.target.result; const store = db.createObjectStore('Users', &#123;keyPath: 'userId', autoIncrement: false&#125;); const idx = store.createIndex('ageIndex','age',&#123;unique: false&#125;)&#125;); è¿™æ ·æˆ‘ä»¬å°±åˆ›å»ºäº†ä¸€æ¡ç´¢å¼•. ä½¿ç”¨ç´¢å¼• è¿™åœ¨åˆ›å»ºäº†ä¸€æ¡ç´¢å¼•ä¹‹åŽæˆ‘ä»¬å°±å¯ä»¥æ¥ä½¿ç”¨å®ƒäº†.æˆ‘ä»¬ä½¿ç”¨å¯¹è±¡ä»“åº“ä¸Šçš„indexæ–¹æ³•,é€šè¿‡ä¼ å…¥ä¸€ä¸ªç´¢å¼•å.æ¥æ‹¿åˆ°ä¸€ä¸ªç´¢å¼•å¯¹è±¡. 1const index = store.index('ageIndex'); ç„¶åŽæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªç´¢å¼•äº†.æ¯”å¦‚è¯´æˆ‘ä»¬è¦æ‹¿åˆ°å¹´é¾„åœ¨20å²ä»¥ä¸Šçš„æ•°æ®,å‡åºæŽ’åˆ—. 1234567891011121314151617181920212223const request = indexedDB.open('myDatabase', 4);request.addEventListener('success', e =&gt; &#123; const db = e.target.result; const tx = db.transaction('Users','readwrite'); const store = tx.objectStore('Users'); const index = store.index('ageIndex'); const req = index.openCursor(IDBKeyRange.lowerBound(20), 'next');//20å²ä»¥ä¸Šçš„æ•°æ®,å‡åºæŽ’åˆ— req.addEventListener('success', e =&gt; &#123; const cursor = e.target.result; if(cursor)&#123; console.log(cursor.value.age); cursor.continue(); &#125;else&#123; console.log('æ£€ç´¢ç»“æŸ'); &#125; &#125;)&#125;); indexedDBçš„å…¼å®¹æ€§ åŽŸæ–‡åœ°å€]]></content>
      <tags>
        <tag>indexedDB</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Tokenï¼šæœåŠ¡ç«¯èº«ä»½éªŒè¯çš„æµè¡Œæ–¹æ¡ˆ]]></title>
    <url>%2F2018%2F05%2F23%2Fstudy%2FToken%EF%BC%9A%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E6%B5%81%E8%A1%8C%E6%96%B9%E6%A1%88%2F</url>
    <content type="text"><![CDATA[èº«ä»½è®¤è¯æœåŠ¡ç«¯æä¾›èµ„æºç»™å®¢æˆ·ç«¯ï¼Œä½†æ˜¯æŸäº›èµ„æºæ˜¯æœ‰æ¡ä»¶çš„ã€‚æ‰€ä»¥æœåŠ¡ç«¯è¦èƒ½å¤Ÿè¯†åˆ«è¯·æ±‚è€…çš„èº«ä»½ï¼Œç„¶åŽå†åˆ¤æ–­æ‰€è¯·æ±‚çš„èµ„æºæ˜¯å¦å¯ä»¥ç»™è¯·æ±‚è€…ã€‚ tokenæ˜¯ä¸€ç§èº«ä»½éªŒè¯çš„æœºåˆ¶ï¼Œåˆå§‹æ—¶ç”¨æˆ·æäº¤è´¦å·æ•°æ®ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯é‡‡ç”¨ä¸€å®šçš„ç­–ç•¥ç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆtokenï¼‰ï¼Œtokenå­—ç¬¦ä¸²ä¸­åŒ…å«äº†å°‘é‡çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶ä¸”æœ‰ä¸€å®šçš„æœŸé™ã€‚æœåŠ¡ç«¯ä¼šæŠŠtokenå­—ç¬¦ä¸²ä¼ ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¿å­˜tokenå­—ç¬¦ä¸²ï¼Œå¹¶åœ¨æŽ¥ä¸‹æ¥çš„è¯·æ±‚ä¸­å¸¦ä¸Šè¿™ä¸ªå­—ç¬¦ä¸²ã€‚ å®ƒçš„å·¥ä½œæµç¨‹å¤§æ¦‚æ˜¯è¿™æ · Tokenæœºåˆ¶ åœ¨è¿™æ ·çš„æµç¨‹ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸‹é¢å‡ ä¸ªé—®é¢˜ï¼š å¦‚ä½•æ ¹æ®tokenèŽ·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Ÿ ç¡®ä¿è¯†åˆ«ä¼ªé€ çš„tokenï¼Ÿ è¿™é‡Œæ˜¯æŒ‡tokenä¸æ˜¯ç»è¿‡æœåŠ¡ç«¯æ¥ç”Ÿæˆçš„ã€‚ å¦‚ä½•åº”ä»˜å†’å……çš„æƒ…å†µï¼Ÿ éžæ³•å®¢æˆ·ç«¯æ‹¦æˆªäº†åˆæ³•å®¢æˆ·ç«¯çš„tokenï¼Œç„¶åŽä½¿ç”¨è¿™ä¸ªtokenå‘æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œå†’å……åˆæ³•å®¢æˆ·ç«¯ã€‚ ç”¨æˆ·åŒ¹é…æœåŠ¡ç«¯åœ¨ç”Ÿæˆtokenæ—¶ï¼ŒåŠ å…¥å°‘é‡çš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ¯”å¦‚ç”¨æˆ·çš„idã€‚æœåŠ¡ç«¯æŽ¥æ”¶åˆ°tokenä¹‹åŽï¼Œå¯ä»¥è§£æžå‡ºè¿™äº›æ•°æ®ï¼Œä»Žè€Œå°†tokenå’Œç”¨æˆ·å…³è”äº†èµ·æ¥ã€‚ é˜²ä¼ªé€ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå»ºè®®æ”¾å…¥tokençš„æ•°æ®æ˜¯ä¸æ•æ„Ÿçš„æ•°æ®ï¼Œè¿™æ ·åªè¦æœåŠ¡ç«¯ä½¿ç”¨ç§é’¥å¯¹æ•°æ®ç”Ÿæˆç­¾åï¼Œç„¶åŽå’Œæ•°æ®æ‹¼æŽ¥èµ·æ¥ï¼Œä½œä¸ºtokençš„ä¸€éƒ¨åˆ†å³å¯ã€‚æ¯”å¦‚JWTï¼Œå‚è€ƒJSON Web Token - åœ¨Webåº”ç”¨é—´å®‰å…¨åœ°ä¼ é€’ä¿¡æ¯ã€‚ åœ¨æˆ‘çŸ¥é“JWTä¹‹å‰ï¼Œæˆ‘å…ˆäº†è§£çš„æ˜¯å¦ä¸€ç§æ¨¡å¼ã€‚åŸºäºŽåŠ å¯†çš„ç®—æ³•ï¼Œå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼ŒæŠŠåŠ å¯†çš„ç»“æžœä½œä¸ºtokenï¼ˆhttp://blog.leapoahead.com/2015/09/06/understanding-jwt/ï¼‰ã€‚ æœ¬æ–‡ä¸»è¦è®¨è®ºåŽä¸€ç§æ¨¡å¼ã€‚ é˜²å†’å……åŠ å¹²æ‰°ç æœåŠ¡ç«¯åœ¨ç”Ÿæˆtokenæ—¶ï¼Œä½¿ç”¨äº†å®¢æˆ·ç«¯çš„UAä½œä¸ºå¹²æ‰°ç å¯¹æ•°æ®åŠ å¯†ï¼Œå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚æ—¶ï¼Œä¼šåŒæ—¶ä¼ å…¥tokenã€UAï¼ŒæœåŠ¡ç«¯ä½¿ç”¨UAå¯¹tokenè§£å¯†ï¼Œä»Žè€ŒéªŒè¯ç”¨æˆ·çš„èº«ä»½ã€‚å¦‚æžœåªæ˜¯æŠŠtokenæ‹·è´åˆ°å¦ä¸€ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ï¼Œä¸åŒçš„UAä¼šå¯¼è‡´åœ¨æœåŠ¡ç«¯è§£æžtokenå¤±è´¥ï¼Œä»Žè€Œå®žçŽ°äº†ä¸€å®šç¨‹åº¦çš„é˜²å†’å……ã€‚ä½†æ˜¯æ”»å‡»è€…å¦‚æžœçŒœåˆ°æœåŠ¡ç«¯ä½¿ç”¨UAä½œä¸ºåŠ å¯†é’¥ï¼Œä»–å¯ä»¥ä¿®æ”¹è‡ªå·±çš„UAã€‚ æœ‰æ•ˆæœŸç»™tokenåŠ ä¸Šæœ‰æ•ˆæœŸï¼Œå³ä½¿è¢«å†’å……ä¹Ÿåªæ˜¯åœ¨ä¸€å®šçš„æ—¶é—´æ®µå†…æœ‰æ•ˆã€‚è¿™ä¸æ˜¯å®Œç¾Žçš„é˜²å¾¡æŽªæ–½ï¼Œåªæ˜¯å°½é‡å‡å°‘æŸå¤±ã€‚ æœåŠ¡ç«¯åœ¨ç”Ÿæˆtokenæ—¶ï¼ŒåŠ å…¥æœ‰æ•ˆæœŸã€‚æ¯æ¬¡æœåŠ¡ç«¯æŽ¥æ”¶åˆ°è¯·æ±‚ï¼Œè§£æžtokenä¹‹åŽï¼Œåˆ¤æ–­æ˜¯å¦å·²è¿‡æœŸï¼Œå¦‚æžœè¿‡æœŸå°±æ‹’ç»æœåŠ¡ã€‚ tokenåˆ·æ–°å¦‚æžœtokenè¿‡æœŸäº†ï¼Œå®¢æˆ·ç«¯åº”è¯¥å¯¹tokenç»­æœŸæˆ–è€…é‡æ–°ç”Ÿæˆtokenã€‚ è¿™å–å†³äºŽtokençš„è¿‡æœŸæœºåˆ¶ã€‚æœåŠ¡å™¨ç¼“å­˜tokenåŠå¯¹åº”çš„è¿‡æœŸæ—¶é—´è¿™ä¸ªæ—¶å€™å°±å¯ä»¥é‡‡ç”¨ç»­æœŸçš„æ–¹å¼ï¼ŒæœåŠ¡å™¨æ›´æ–°è¿‡æœŸæ—¶é—´ï¼Œtokenå†æ¬¡æœ‰æ•ˆã€‚tokenä¸­å«æœ‰è¿‡æœŸæ—¶é—´è¿™ä¸ªæ—¶å€™éœ€è¦é‡æ–°ç”Ÿæˆtokenã€‚ åœ¨tokenç»­æœŸæˆ–è€…é‡æ–°ç”Ÿæˆtokençš„æ—¶å€™ï¼Œéœ€è¦é¢å¤–åŠ å…¥æ•°æ®æ¥éªŒè¯èº«ä»½ã€‚å› ä¸ºtokenå·²ç»è¿‡æœŸäº†ï¼Œå³tokenå·²ç»ä¸èƒ½ç”¨æ¥éªŒè¯ç”¨æˆ·çš„èº«ä»½äº†ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è¯·æ±‚ç”¨æˆ·é‡æ–°è¾“å…¥è´¦å·å’Œå¯†ç ï¼Œä½†æ˜¯ç”¨æˆ·ä½“éªŒç¨å·®ã€‚ å¦ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨æ‘˜è¦ã€‚æœåŠ¡ç«¯ç”Ÿæˆtokenï¼ŒåŒæ—¶ç”Ÿæˆtokençš„æ‘˜è¦ï¼Œç„¶åŽä¸€èµ·è¿”å›žç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯ä¿å­˜æ‘˜è¦ï¼Œä¸€èˆ¬è¯·æ±‚åªéœ€è¦ç”¨åˆ°tokenï¼Œåœ¨åˆ·æ–°tokenæ—¶ï¼Œæ‰éœ€è¦ç”¨åˆ°æ‘˜è¦ã€‚æœåŠ¡ç«¯éªŒè¯æ‘˜è¦ï¼Œæ¥éªŒè¯ç”¨æˆ·çš„èº«ä»½ã€‚å› ä¸ºæ‘˜è¦ä¸ä¼šé¢‘ç¹çš„åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¼ è¾“ï¼Œæ‰€ä»¥è¢«æˆªå–çš„æ¦‚çŽ‡è¾ƒå°ã€‚ Tokenå·¥ä½œæµç¨‹ç”Ÿæˆtokenä¸€èˆ¬åœ¨ç™»å½•çš„æ—¶å€™ç”Ÿæˆtokenã€‚Tokenç®¡ç†è€…è´Ÿè´£æ ¹æ®ç”¨æˆ·çš„æ•°æ®ç”Ÿæˆtokenå’Œæ‘˜è¦ï¼Œæ‘˜è¦ç”¨æ¥ç»™APPç«¯åˆ·æ–°tokenç”¨ï¼Œç±»ä¼¼äºŽå¾®ä¿¡ç™»å½•ä¸­çš„refresh_tokenã€‚ ç”Ÿæˆtokençš„è¿‡ç¨‹ä¸­ï¼Œuaçš„å……ä½œå¹²æ‰°ç ã€‚æ²¡æœ‰ç›¸åŒçš„uaï¼Œå°±æ— æ³•è§£æžç”Ÿæˆçš„tokenå­—ç¬¦ä¸²ã€‚å¦‚æžœå®¢æˆ·ç«¯æ˜¯æ··åˆå¼€å‘çš„æ¨¡å¼ï¼Œç”Ÿæˆtokenå’Œä½¿ç”¨tokençš„ä»£ç†å¯èƒ½ä¸åŒï¼ˆæ¯”å¦‚ä¸€ä¸ªæ˜¯h5ï¼Œä¸€ä¸ªæ˜¯åŽŸç”Ÿï¼‰ï¼Œuaå°±ä¼šä¸åŒï¼Œtokenå°±æ— æ³•æˆåŠŸçš„ä½¿ç”¨ã€‚å¯ä»¥é€‰æ‹©å…¶ä»–çš„å®¢æˆ·ç«¯æ•°æ®ä½œä¸ºå¹²æ‰°ç ï¼Œ æ³¨æ„è€ƒè™‘ä¸‹é¢çš„é—®é¢˜ï¼š ä¸åŒçš„å®¢æˆ·ç«¯ï¼Œå¹²æ‰°ç åº”è¯¥ä¸åŒ å¹²æ‰°ç çš„å¾ˆå¤§ä¸€ä¸ªä½œç”¨æ˜¯é˜²å†’å……ï¼Œå¦‚æžœé€‰æ‹©çš„å……å½“å¹²æ‰°ç çš„å®¢æˆ·ç«¯æ•°æ®æ²¡æœ‰åŒºåˆ†æ€§ï¼Œå°±è¾¾ä¸åˆ°æ•ˆæžœã€‚é€‰æ‹©å……å½“å¹²æ‰°ç çš„æ•°æ®ï¼Œåœ¨å“ªäº›æƒ…å†µä¸‹ä¼šå˜åŒ–ï¼Ÿè¿™äº›æƒ…å†µæ˜¯å¦åˆç†ï¼Ÿ æ¯”å¦‚å¹²æ‰°ç æ•°æ®ä¸­å«æœ‰appçš„ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆappç‰ˆæœ¬å‡çº§å°±ä¼šå¯¼è‡´å¹²æ‰°ç å˜åŒ–ã€‚æœåŠ¡ç«¯æ ¹æ®æ–°çš„å¹²æ‰°ç ï¼Œæ— æ³•è§£æžæ—§çš„tokenï¼Œæ­¤æ—¶ç”¨æˆ·å¿…é¡»é‡æ–°ç™»å½•ã€‚è¿™ç§æƒ…å†µæ˜¯åˆç†çš„å—ï¼Ÿå¦‚æžœä¸åˆç†ï¼Œå¹²æ‰°ç ä¸­å°±ä¸åº”è¯¥å«æœ‰appçš„ç‰ˆæœ¬å·ã€‚ æ‹¦æˆªéªŒè¯å®¢æˆ·ç«¯çš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½å¿…é¡»æºå¸¦tokenã€uaï¼Œæ‹¦æˆªå™¨ä¼šå¯¹æ•æ„Ÿèµ„æºçš„è®¿é—®è¿›è¡Œæ‹¦æˆªï¼Œç„¶åŽæ ¹æ®uaè§£æžtokenï¼Œè§£æžä¸æˆåŠŸï¼Œè¡¨ç¤ºtokenå’Œuaä¸åŒ¹é…ã€‚è§£æžæˆåŠŸä¹‹åŽï¼Œåˆ¤æ–­tokenæ˜¯å¦å·²è¿‡æœŸï¼Œå¦‚æžœæ˜¯ï¼Œæ‹’ç»æœåŠ¡ã€‚æ‰€æœ‰éƒ½okçš„æƒ…å†µä¸‹ï¼Œæ‹¦æˆªå™¨æ”¾è¡Œï¼Œè¯·æ±‚ä¼ è¾¾åˆ°ä¸šåŠ¡æœåŠ¡è€…ã€‚ Tokenåˆ·æ–°å½“tokenè¿‡æœŸï¼Œç”¨æˆ·éœ€è¦åˆ·æ–°tokenã€‚åˆ·æ–°tokenæœ¬è´¨ä¸Šæ˜¯è¿™æ ·çš„ï¼š å®¢æˆ·ç«¯éœ€è¦æŠŠtokenã€æ‘˜è¦ã€uaéƒ½ä¼ ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å¯¹tokené‡æ–°ç”Ÿæˆæ‘˜è¦ï¼Œé€šè¿‡åˆ¤æ–­ä¸¤ä¸ªæ‘˜è¦æ˜¯å¦ç›¸åŒæ¥éªŒè¯è¿™æ¬¡è¯·æ±‚åˆ·æ–°tokençš„å®¢æˆ·ç«¯ï¼Œæ˜¯ä¸æ˜¯ä¸Šæ¬¡è¯·æ±‚ç”Ÿæˆtokençš„å®¢æˆ·ç«¯ã€‚éªŒè¯é€šè¿‡ï¼ŒæœåŠ¡ç«¯éœ€è¦ä½¿ç”¨ç”¨æˆ·æ•°æ®é‡æ–°ç”Ÿæˆtokenï¼Œç”¨æˆ·æ•°æ®åˆ™æ¥è‡ªç”¨uaè§£æžtokençš„ç»“æžœã€‚ HTML&amp;JSç­‰å‰ç«¯çŸ¥è¯†ç³»åˆ—ä¹‹Ajax postè¯·æ±‚å¸¦æœ‰tokenå‘Djangoè¯·æ±‚æˆ‘ä»¬ åœ¨æ¯æ¿ä¸Šå†™å…¥è¿™æ®µä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;script type="text/javascript"&gt; // ä¸ªäººå®šä¹‰å¤§å‡½æ•°ï¼Œä¸æ˜¯é‡ç‚¹ï¼Œå¯ä»¥å¿½ç•¥ $(document).ready(function()&#123; get_sys_load(); var csrftoken = getCookie('csrftoken'); var active_node = $("#mainnav-menu a[href='&#123;&#123; request.path &#125;&#125;']"); active_node.parent().addClass("active-link"); if (active_node.parent().parent().hasClass("collapse"))&#123; active_node.parent().parent().addClass("in"); &#125; &#125;);//end doc ready // ä¸ªäººå®šä¹‰å¤§å‡½æ•°ï¼Œä¸æ˜¯é‡ç‚¹ï¼Œå¯ä»¥å¿½ç•¥ function get_sys_load()&#123; $.ajax(&#123; url: "&#123;% url 'get_server_host_status' %&#125;", type: "GET", dataType: "json", success: function(callback)&#123; for( i in callback)&#123; console.log(i,callback[i]); $('#'+ i +'_display').text(callback[i]); $('#'+ i +'_width').text(callback[i]); $('#'+ i +'_attr').css('width',callback[i]+'%') &#125;// end for &#125;,// end sucess func error: function(callback)&#123; alert(callback) &#125;// end error func &#125;) &#125; // è¿™ä¸ªæ‰æ˜¯é‡ç‚¹çš„ä»£ç ï¼Œå¿…é¡»å†™ function getCookie(name) &#123; var cookieValue = null; if (document.cookie &amp;&amp; document.cookie !== '') &#123; var cookies = document.cookie.split(';'); for (var i = 0; i &lt; cookies.length; i++) &#123; var cookie = jQuery.trim(cookies[i]); // Does this cookie string begin with the name we want? if (cookie.substring(0, name.length + 1) === (name + '=')) &#123; cookieValue = decodeURIComponent(cookie.substring(name.length + 1)); break; &#125; &#125; &#125; return cookieValue; &#125; // è¿™ä¸ªæ‰æ˜¯é‡ç‚¹çš„ä»£ç ï¼Œå¿…é¡»å†™ function csrfSafeMethod(method) &#123; // these HTTP methods do not require CSRF protection return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method)); &#125; $.ajaxSetup(&#123; beforeSend: function(xhr, settings) &#123; if (!csrfSafeMethod(settings.type) &amp;&amp; !this.crossDomain) &#123; xhr.setRequestHeader("X-CSRFToken", csrftoken); &#125; &#125; &#125;); &lt;/script&gt; &#123;% block bottom-js %&#125; &#123;% endblock %&#125; æˆ‘ä»¬åœ¨å­æ¿ä¸Šè°ƒç”¨è¿™ç«¯jsä»£ç ï¼Œè°ƒç”¨çš„å‰ææ˜¯å­æ¿çš„htmlé¡µé¢å¿…é¡»åµŒå¥—äº†è¿™ä¸ª csrf_token, ä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738htmlé¡µé¢çš„ä»£ç ï¼š==================&lt;span&gt;&#123;% csrf_token %&#125;&lt;/span&gt;========================JQueryä»£ç  =======&#123;% block bottom-js %&#125;&lt;script&gt; function run_cmd()&#123; var csrftoken = getCookie('csrftoken'); // è°ƒç”¨èŽ·å–tokençš„æ–¹æ³•æ¥èŽ·å–tokenï¼ŒgetCookieæ˜¯å‰é¢å®šä¹‰å¥½çš„å‡½æ•°ã€‚ var input_cmd = $('textarea').val(); $.ajax(&#123; url:"&#123;% url 'put_cmd' %&#125;", type:'POST', dataType:'json', token: csrftoken, // æŠŠtokenå¡žå…¥å¤´éƒ¨ data:&#123;'host_id':$('#host_id').text(),'minion_name':$('#minion_id').text(),'cmd':input_cmd&#125;, success: function(callback)&#123; console.log(callback) &#125;, // end success error: function (callback) &#123; console.log(callback); $('code').append(callback) &#125; &#125;) &#125; function show_result(content)&#123; &#125;&lt;/script&gt;&#123;% endblock %&#125; æ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨æäº¤postè¯·æ±‚ï¼Œå°±èƒ½å¤Ÿæ­£å¸¸æäº¤äº†ï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘çš„ä¿¡æ¯ï¼šajax tokenã€‚ ç™»å½•åŽä¿å­˜tokenåˆ°cookieä¸­12345678910111213141516171819// 1.å¼•å…¥ç›¸åº”JS &lt;script src="web/js/jquery-1.9.1.min.js"&gt;&lt;/script&gt; &lt;script src="web/js/jquery.cookie.js"&gt;&lt;/script&gt;// 2.ä¿å­˜cookie $.cookie("åç§°","å€¼") //$.cookie('cookieName', 'cookieValue'); $.cookie("åç§°","å€¼",&#123;expires:å¤±æ•ˆæ—¶é—´&#125;)// 3.èŽ·å–cookie $.cookie("åç§°") //$.cookie('cookieName');// 4.åˆ é™¤cookie $.cookie("åç§°",null) Tokenæœºåˆ¶ç›¸æ¯”Cookieæœºåˆ¶çš„ä¼˜ç‚¹ æ”¯æŒè·¨åŸŸè®¿é—®:cookieæ˜¯ä¸å…è®¸è·¨åŸŸè®¿é—®çš„ï¼Œè¿™ä¸€ç‚¹å¯¹tokenæœºåˆ¶æ˜¯ä¸å­˜åœ¨çš„ï¼Œå‰ææ˜¯ä¼ è¾“çš„ç”¨æˆ·è®¤è¯ä¿¡æ¯é€šè¿‡HTTPå¤´ä¼ è¾“. æ— çŠ¶æ€(ä¹Ÿç§°ï¼šæœåŠ¡ç«¯å¯æ‰©å±•è¡Œ):Tokenæœºåˆ¶åœ¨æœåŠ¡ç«¯ä¸éœ€è¦å­˜å‚¨sessionä¿¡æ¯ï¼Œå› ä¸ºToken è‡ªèº«åŒ…å«äº†æ‰€æœ‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼Œåªéœ€è¦åœ¨å®¢æˆ·ç«¯çš„cookieæˆ–æœ¬åœ°ä»‹è´¨å­˜å‚¨çŠ¶æ€ä¿¡æ¯. æ›´é€‚ç”¨äºŽcdn: å¯ä»¥é€šè¿‡å†…å®¹åˆ†å‘ç½‘ç»œè¯·æ±‚ä½ æœåŠ¡ç«¯çš„æ‰€æœ‰èµ„æ–™ï¼ˆå¦‚ï¼šjavascriptï¼ŒHTML,å›¾ç‰‡ç­‰ï¼‰ï¼Œè€Œä½ çš„æœåŠ¡ç«¯åªè¦æä¾›APIå³å¯ åŽ»è€¦: ä¸éœ€è¦ç»‘å®šåˆ°ä¸€ä¸ªç‰¹å®šçš„èº«ä»½éªŒè¯æ–¹æ¡ˆã€‚Tokenå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç”Ÿæˆï¼Œåªè¦åœ¨ä½ çš„APIè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä½ å¯ä»¥è¿›è¡ŒTokenç”Ÿæˆè°ƒç”¨å³å¯. æ›´é€‚ç”¨äºŽç§»åŠ¨åº”ç”¨: å½“ä½ çš„å®¢æˆ·ç«¯æ˜¯ä¸€ä¸ªåŽŸç”Ÿå¹³å°ï¼ˆiOS, Androidï¼ŒWindows 8ç­‰ï¼‰æ—¶ï¼ŒCookieæ˜¯ä¸è¢«æ”¯æŒçš„ï¼ˆä½ éœ€è¦é€šè¿‡Cookieå®¹å™¨è¿›è¡Œå¤„ç†ï¼‰ï¼Œè¿™æ—¶é‡‡ç”¨Tokenè®¤è¯æœºåˆ¶å°±ä¼šç®€å•å¾—å¤šã€‚ CSRF:å› ä¸ºä¸å†ä¾èµ–äºŽCookieï¼Œæ‰€ä»¥ä½ å°±ä¸éœ€è¦è€ƒè™‘å¯¹CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰çš„é˜²èŒƒã€‚ æ€§èƒ½: ä¸€æ¬¡ç½‘ç»œå¾€è¿”æ—¶é—´ï¼ˆé€šè¿‡æ•°æ®åº“æŸ¥è¯¢sessionä¿¡æ¯ï¼‰æ€»æ¯”åšä¸€æ¬¡HMACSHA256è®¡ç®— çš„TokenéªŒè¯å’Œè§£æžè¦è´¹æ—¶å¾—å¤š.ä¸éœ€è¦ä¸ºç™»å½•é¡µé¢åšç‰¹æ®Šå¤„ç†: å¦‚æžœä½ ä½¿ç”¨Protractor åšåŠŸèƒ½æµ‹è¯•çš„æ—¶å€™ï¼Œä¸å†éœ€è¦ä¸ºç™»å½•é¡µé¢åšç‰¹æ®Šå¤„ç†. åŸºäºŽæ ‡å‡†åŒ–:ä½ çš„APIå¯ä»¥é‡‡ç”¨æ ‡å‡†åŒ–çš„ JSON Web Token (JWT). è¿™ä¸ªæ ‡å‡†å·²ç»å­˜åœ¨å¤šä¸ªåŽç«¯åº“ï¼ˆ.NET, Ruby, Java,Python, PHPï¼‰å’Œå¤šå®¶å…¬å¸çš„æ”¯æŒï¼ˆå¦‚ï¼šFirebase,Google, Microsoftï¼‰.]]></content>
      <tags>
        <tag>Token</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[promiseçš„åŽŸç†]]></title>
    <url>%2F2018%2F05%2F21%2F%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0%2Fpromise%E7%9A%84%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[å‰è¨€å…ˆä¸Šä¸€å›¾! æœ¬æ–‡çš„promiseæºç æ˜¯æŒ‰ç…§Promise/A+è§„èŒƒæ¥ç¼–å†™çš„ï¼ˆä¸æƒ³çœ‹è‹±æ–‡ç‰ˆçš„ç§»æ­¥Promise/A+è§„èŒƒä¸­æ–‡ç¿»è¯‘ï¼‰ å¼•å­ä¸ºäº†è®©å¤§å®¶æ›´å®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬ä»Žä¸€ä¸ªåœºæ™¯å¼€å§‹è®²è§£ï¼Œè®©å¤§å®¶ä¸€æ­¥ä¸€æ­¥è·Ÿç€æ€è·¯æ€è€ƒï¼Œç›¸ä¿¡ä½ ä¸€å®šä¼šæ›´å®¹æ˜“çœ‹æ‡‚ã€‚ è€ƒè™‘ä¸‹é¢ä¸€ç§èŽ·å–ç”¨æˆ·idçš„è¯·æ±‚å¤„ç† 1234567891011function getUrlId() &#123; return new Promise(function(resolve) &#123; //å¼‚æ­¥è¯·æ±‚ http.get(url,function(results) &#123; resolve(results.id); &#125;) &#125;)&#125;getUrlId().then(function(id)&#123; //ä¸€äº›å¤„ç†&#125;) getUserIdæ–¹æ³•è¿”å›žä¸€ä¸ªpromiseï¼Œå¯ä»¥é€šè¿‡å®ƒçš„thenæ–¹æ³•æ³¨å†Œ(æ³¨æ„æ³¨å†Œè¿™ä¸ªè¯)åœ¨promiseå¼‚æ­¥æ“ä½œæˆåŠŸæ—¶æ‰§è¡Œçš„å›žè°ƒã€‚è¿™ç§æ‰§è¡Œæ–¹å¼ï¼Œä½¿å¾—å¼‚æ­¥è°ƒç”¨å˜å¾—ååˆ†é¡ºæ‰‹ã€‚ åŽŸç†å‰–æžé‚£ä¹ˆç±»ä¼¼è¿™ç§åŠŸèƒ½çš„Promiseæ€Žä¹ˆå®žçŽ°å‘¢ï¼Ÿå…¶å®žæŒ‰ç…§ä¸Šé¢ä¸€å¥è¯ï¼Œå®žçŽ°ä¸€ä¸ªæœ€åŸºç¡€çš„é›å½¢è¿˜æ˜¯å¾ˆeasyçš„ã€‚ æžç®€promiseé›å½¢12345678910111213141516function Promise(fn) &#123; var value = null, callbacks = []; //callbacksä¸ºæ•°ç»„ï¼Œå› ä¸ºå¯èƒ½åŒæ—¶æœ‰å¾ˆå¤šä¸ªå›žè°ƒ this.then = function (onFulfilled) &#123; callbacks.push(onFulfilled); &#125;; function resolve(value) &#123; callbacks.forEach(function (callback) &#123; callback(value); &#125;); &#125; fn(resolve);&#125; ä¸Šè¿°ä»£ç å¾ˆç®€å•ï¼Œå¤§è‡´çš„é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š è°ƒç”¨thenæ–¹æ³•ï¼Œå°†æƒ³è¦åœ¨Promiseå¼‚æ­¥æ“ä½œæˆåŠŸæ—¶æ‰§è¡Œçš„å›žè°ƒæ”¾å…¥callbacksé˜Ÿåˆ—ï¼Œå…¶å®žä¹Ÿå°±æ˜¯æ³¨å†Œå›žè°ƒå‡½æ•°ï¼Œå¯ä»¥å‘è§‚å¯Ÿè€…æ¨¡å¼æ–¹å‘æ€è€ƒï¼› åˆ›å»ºPromiseå®žä¾‹æ—¶ä¼ å…¥çš„å‡½æ•°ä¼šè¢«èµ‹äºˆä¸€ä¸ªå‡½æ•°ç±»åž‹çš„å‚æ•°ï¼Œå³resolveï¼Œå®ƒæŽ¥æ”¶ä¸€ä¸ªå‚æ•°valueï¼Œä»£è¡¨å¼‚æ­¥æ“ä½œè¿”å›žçš„ç»“æžœï¼Œå½“ä¸€æ­¥æ“ä½œæ‰§è¡ŒæˆåŠŸåŽï¼Œç”¨æˆ·ä¼šè°ƒç”¨resolveæ–¹æ³•ï¼Œè¿™æ—¶å€™å…¶å®žçœŸæ­£æ‰§è¡Œçš„æ“ä½œæ˜¯å°†callbacksé˜Ÿåˆ—ä¸­çš„å›žè°ƒä¸€ä¸€æ‰§è¡Œï¼› å¯ä»¥ç»“åˆä¾‹1ä¸­çš„ä»£ç æ¥çœ‹ï¼Œé¦–å…ˆnew Promiseæ—¶ï¼Œä¼ ç»™promiseçš„å‡½æ•°å‘é€å¼‚æ­¥è¯·æ±‚ï¼ŒæŽ¥ç€è°ƒç”¨promiseå¯¹è±¡çš„thenå±žæ€§ï¼Œæ³¨å†Œè¯·æ±‚æˆåŠŸçš„å›žè°ƒå‡½æ•°ï¼Œç„¶åŽå½“å¼‚æ­¥è¯·æ±‚å‘é€æˆåŠŸæ—¶ï¼Œè°ƒç”¨resolve(results.id)æ–¹æ³•, è¯¥æ–¹æ³•æ‰§è¡Œthenæ–¹æ³•æ³¨å†Œçš„å›žè°ƒæ•°ç»„ã€‚ ç›¸ä¿¡ä»”ç»†çš„äººåº”è¯¥å¯ä»¥çœ‹å‡ºæ¥ï¼Œthenæ–¹æ³•åº”è¯¥èƒ½å¤Ÿé“¾å¼è°ƒç”¨ï¼Œä½†æ˜¯ä¸Šé¢çš„æœ€åŸºç¡€ç®€å•çš„ç‰ˆæœ¬æ˜¾ç„¶æ— æ³•æ”¯æŒé“¾å¼è°ƒç”¨ã€‚æƒ³è®©thenæ–¹æ³•æ”¯æŒé“¾å¼è°ƒç”¨ï¼Œå…¶å®žä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼š 1234this.then = function (onFulfilled) &#123; callbacks.push(onFulfilled); return this;&#125;; see?åªè¦ç®€å•ä¸€å¥è¯å°±å¯ä»¥å®žçŽ°ç±»ä¼¼ä¸‹é¢çš„é“¾å¼è°ƒç”¨ï¼š 123456// ä¾‹2getUserId().then(function (id) &#123; // ä¸€äº›å¤„ç†&#125;).then(function (id) &#123; // ä¸€äº›å¤„ç†&#125;); åŠ å…¥å»¶æ—¶æœºåˆ¶ç»†å¿ƒçš„åŒå­¦åº”è¯¥å‘çŽ°ï¼Œä¸Šè¿°ä»£ç å¯èƒ½è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æžœåœ¨thenæ–¹æ³•æ³¨å†Œå›žè°ƒä¹‹å‰ï¼Œresolveå‡½æ•°å°±æ‰§è¡Œäº†ï¼Œæ€Žä¹ˆåŠžï¼Ÿæ¯”å¦‚promiseå†…éƒ¨çš„å‡½æ•°æ˜¯åŒæ­¥å‡½æ•°ï¼š 123456789// ä¾‹3function getUserId() &#123; return new Promise(function (resolve) &#123; resolve(9876); &#125;);&#125;getUserId().then(function (id) &#123; // ä¸€äº›å¤„ç†&#125;); è¿™æ˜¾ç„¶æ˜¯ä¸å…è®¸çš„ï¼ŒPromises/A+è§„èŒƒæ˜Žç¡®è¦æ±‚å›žè°ƒéœ€è¦é€šè¿‡å¼‚æ­¥æ–¹å¼æ‰§è¡Œï¼Œç”¨ä»¥ä¿è¯ä¸€è‡´å¯é çš„æ‰§è¡Œé¡ºåºã€‚å› æ­¤æˆ‘ä»¬è¦åŠ å…¥ä¸€äº›å¤„ç†ï¼Œä¿è¯åœ¨resolveæ‰§è¡Œä¹‹å‰ï¼Œthenæ–¹æ³•å·²ç»æ³¨å†Œå®Œæ‰€æœ‰çš„å›žè°ƒã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·æ”¹é€ ä¸‹resolveå‡½æ•°: 1234567function resolve(value) &#123; setTimeout(function() &#123; callbacks.forEach(function (callback) &#123; callback(value); &#125;); &#125;, 0)&#125; ä¸Šè¿°ä»£ç çš„æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡setTimeoutæœºåˆ¶ï¼Œå°†resolveä¸­æ‰§è¡Œå›žè°ƒçš„é€»è¾‘æ”¾ç½®åˆ°JSä»»åŠ¡é˜Ÿåˆ—æœ«å°¾ï¼Œä»¥ä¿è¯åœ¨resolveæ‰§è¡Œæ—¶ï¼Œthenæ–¹æ³•çš„å›žè°ƒå‡½æ•°å·²ç»æ³¨å†Œå®Œæˆ. ä½†æ˜¯ï¼Œè¿™æ ·å¥½åƒè¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç»†æƒ³ä¸€ä¸‹ï¼šå¦‚æžœPromiseå¼‚æ­¥æ“ä½œå·²ç»æˆåŠŸï¼Œè¿™æ—¶ï¼Œåœ¨å¼‚æ­¥æ“ä½œæˆåŠŸä¹‹å‰æ³¨å†Œçš„å›žè°ƒéƒ½ä¼šæ‰§è¡Œï¼Œä½†æ˜¯åœ¨Promiseå¼‚æ­¥æ“ä½œæˆåŠŸè¿™ä¹‹åŽè°ƒç”¨çš„thenæ³¨å†Œçš„å›žè°ƒå°±å†ä¹Ÿä¸ä¼šæ‰§è¡Œäº†ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ åŠ å…¥çŠ¶æ€æ©ï¼Œä¸ºäº†è§£å†³ä¸Šä¸€èŠ‚æŠ›å‡ºçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»åŠ å…¥çŠ¶æ€æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å¤§å®¶ç†ŸçŸ¥çš„pendingã€fulfilledã€rejectedã€‚ Promises/A+è§„èŒƒä¸­çš„2.1Promise Statesä¸­æ˜Žç¡®è§„å®šäº†ï¼Œpendingå¯ä»¥è½¬åŒ–ä¸ºfulfilledæˆ–rejectedå¹¶ä¸”åªèƒ½è½¬åŒ–ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æžœpendingè½¬åŒ–åˆ°fulfilledçŠ¶æ€ï¼Œé‚£ä¹ˆå°±ä¸èƒ½å†è½¬åŒ–åˆ°rejectedã€‚å¹¶ä¸”fulfilledå’ŒrejectedçŠ¶æ€åªèƒ½ç”±pendingè½¬åŒ–è€Œæ¥ï¼Œä¸¤è€…ä¹‹é—´ä¸èƒ½äº’ç›¸è½¬æ¢ã€‚ä¸€å›¾èƒœåƒè¨€ æ”¹è¿›åŽçš„ä»£ç æ˜¯è¿™æ ·çš„ï¼š 1234567891011121314151617181920212223242526function Promise(fn) &#123; var state = 'pending', value = null, callbacks = []; this.then = function (onFulfilled) &#123; if (state === 'pending') &#123; callbacks.push(onFulfilled); return this; &#125; onFulfilled(value); return this; &#125;; function resolve(newValue) &#123; value = newValue; state = 'fulfilled'; setTimeout(function () &#123; callbacks.forEach(function (callback) &#123; callback(value); &#125;); &#125;, 0); &#125; fn(resolve);&#125; ä¸Šè¿°ä»£ç çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼šresolveæ‰§è¡Œæ—¶ï¼Œä¼šå°†çŠ¶æ€è®¾ç½®ä¸ºfulfilledï¼Œåœ¨æ­¤ä¹‹åŽè°ƒç”¨thenæ·»åŠ çš„æ–°å›žè°ƒï¼Œéƒ½ä¼šç«‹å³æ‰§è¡Œã€‚ è¿™é‡Œæ²¡æœ‰ä»»ä½•åœ°æ–¹å°†stateè®¾ä¸ºrejectedï¼Œä¸ºäº†è®©å¤§å®¶èšç„¦åœ¨æ ¸å¿ƒä»£ç ä¸Šï¼Œè¿™ä¸ªé—®é¢˜åŽé¢ä¼šæœ‰ä¸€å°èŠ‚ä¸“é—¨åŠ å…¥ã€‚ é“¾å¼Promiseé‚£ä¹ˆè¿™é‡Œé—®é¢˜åˆæ¥äº†ï¼Œå¦‚æžœç”¨æˆ·å†thenå‡½æ•°é‡Œé¢æ³¨å†Œçš„ä»ç„¶æ˜¯ä¸€ä¸ªPromiseï¼Œè¯¥å¦‚ä½•è§£å†³ï¼Ÿæ¯”å¦‚ä¸‹é¢çš„ä¾‹4ï¼š 1234567891011121314// ä¾‹4getUserId() .then(getUserJobById) .then(function (job) &#123; // å¯¹jobçš„å¤„ç† &#125;);function getUserJobById(id) &#123; return new Promise(function (resolve) &#123; http.get(baseUrl + id, function(job) &#123; resolve(job); &#125;); &#125;);&#125; è¿™ç§åœºæ™¯ç›¸ä¿¡ç”¨è¿‡promiseçš„äººéƒ½çŸ¥é“ä¼šæœ‰å¾ˆå¤šï¼Œé‚£ä¹ˆç±»ä¼¼è¿™ç§å°±æ˜¯æ‰€è°“çš„é“¾å¼Promiseã€‚ é“¾å¼Promiseæ˜¯æŒ‡åœ¨å½“å‰promiseè¾¾åˆ°fulfilledçŠ¶æ€åŽï¼Œå³å¼€å§‹è¿›è¡Œä¸‹ä¸€ä¸ªpromiseï¼ˆåŽé‚»promiseï¼‰ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è¡”æŽ¥å½“å‰promiseå’ŒåŽé‚»promiseå‘¢ï¼Ÿï¼ˆè¿™æ˜¯è¿™é‡Œçš„éš¾ç‚¹ï¼‰ã€‚ å…¶å®žä¹Ÿä¸æ˜¯è¾£ä¹ˆéš¾ï¼Œåªè¦åœ¨thenæ–¹æ³•é‡Œé¢returnä¸€ä¸ªpromiseå°±å¥½å•¦ã€‚Promises/A+è§„èŒƒä¸­çš„2.2.7å°±æ˜¯è¿™ä¹ˆè¯´å“’(å¾®ç¬‘è„¸)~ ä¸‹é¢æ¥çœ‹çœ‹è¿™æ®µæš—è—çŽ„æœºçš„thenæ–¹æ³•å’Œresolveæ–¹æ³•æ”¹é€ ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647function Promise(fn) &#123; var state = 'pending', value = null, callbacks = []; this.then = function (onFulfilled) &#123; return new Promise(function (resolve) &#123; handle(&#123; onFulfilled: onFulfilled || null, resolve: resolve &#125;); &#125;); &#125;; function handle(callback) &#123; if (state === 'pending') &#123; callbacks.push(callback); return; &#125; //å¦‚æžœthenä¸­æ²¡æœ‰ä¼ é€’ä»»ä½•ä¸œè¥¿ if(!callback.onFulfilled) &#123; callback.resolve(value); return; &#125; var ret = callback.onFulfilled(value); callback.resolve(ret); &#125; function resolve(newValue) &#123; if (newValue &amp;&amp; (typeof newValue === 'object' || typeof newValue === 'function')) &#123; var then = newValue.then; if (typeof then === 'function') &#123; then.call(newValue, resolve); return; &#125; &#125; state = 'fulfilled'; value = newValue; setTimeout(function () &#123; callbacks.forEach(function (callback) &#123; handle(callback); &#125;); &#125;, 0); &#125; fn(resolve);&#125; æˆ‘ä»¬ç»“åˆä¾‹4çš„ä»£ç ï¼Œåˆ†æžä¸‹ä¸Šé¢çš„ä»£ç é€»è¾‘ï¼Œä¸ºäº†æ–¹ä¾¿é˜…è¯»ï¼Œæˆ‘æŠŠä¾‹4çš„ä»£ç è´´åœ¨è¿™é‡Œï¼š 1234567891011121314// ä¾‹4getUserId() .then(getUserJobById) .then(function (job) &#123; // å¯¹jobçš„å¤„ç† &#125;);function getUserJobById(id) &#123; return new Promise(function (resolve) &#123; http.get(baseUrl + id, function(job) &#123; resolve(job); &#125;); &#125;);&#125; thenæ–¹æ³•ä¸­ï¼Œåˆ›å»ºå¹¶è¿”å›žäº†æ–°çš„Promiseå®žä¾‹ï¼Œè¿™æ˜¯ä¸²è¡ŒPromiseçš„åŸºç¡€ï¼Œå¹¶ä¸”æ”¯æŒé“¾å¼è°ƒç”¨ã€‚ handleæ–¹æ³•æ˜¯promiseå†…éƒ¨çš„æ–¹æ³•ã€‚thenæ–¹æ³•ä¼ å…¥çš„å½¢å‚onFulfilledä»¥åŠåˆ›å»ºæ–°Promiseå®žä¾‹æ—¶ä¼ å…¥çš„resolveå‡è¢«pushåˆ°å½“å‰promiseçš„callbacksé˜Ÿåˆ—ä¸­ï¼Œè¿™æ˜¯è¡”æŽ¥å½“å‰promiseå’ŒåŽé‚»promiseçš„å…³é”®æ‰€åœ¨ï¼ˆè¿™é‡Œä¸€å®šè¦å¥½å¥½çš„åˆ†æžä¸‹handleçš„ä½œç”¨ï¼‰ã€‚ getUserIdç”Ÿæˆçš„promiseï¼ˆç®€ç§°getUserId promiseï¼‰å¼‚æ­¥æ“ä½œæˆåŠŸï¼Œæ‰§è¡Œå…¶å†…éƒ¨æ–¹æ³•resolveï¼Œä¼ å…¥çš„å‚æ•°æ­£æ˜¯å¼‚æ­¥æ“ä½œçš„ç»“æžœid è°ƒç”¨handleæ–¹æ³•å¤„ç†callbacksé˜Ÿåˆ—ä¸­çš„å›žè°ƒï¼šgetUserJobByIdæ–¹æ³•ï¼Œç”Ÿæˆæ–°çš„promiseï¼ˆgetUserJobById promiseï¼‰ æ‰§è¡Œä¹‹å‰ç”±getUserId promiseçš„thenæ–¹æ³•ç”Ÿæˆçš„æ–°promise(ç§°ä¸ºbridge promise)çš„resolveæ–¹æ³•ï¼Œä¼ å…¥å‚æ•°ä¸ºgetUserJobById promiseã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šå°†è¯¥resolveæ–¹æ³•ä¼ å…¥getUserJobById promiseçš„thenæ–¹æ³•ä¸­ï¼Œå¹¶ç›´æŽ¥è¿”å›žã€‚ åœ¨getUserJobById promiseå¼‚æ­¥æ“ä½œæˆåŠŸæ—¶ï¼Œæ‰§è¡Œå…¶callbacksä¸­çš„å›žè°ƒï¼šgetUserId bridge promiseä¸­çš„resolveæ–¹æ³• æœ€åŽæ‰§è¡ŒgetUserId bridge promiseçš„åŽé‚»promiseçš„callbacksä¸­çš„å›žè°ƒã€‚ å¤±è´¥å¤„ç†åœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶ï¼Œæ ‡è®°å…¶çŠ¶æ€ä¸ºrejectedï¼Œå¹¶æ‰§è¡Œæ³¨å†Œçš„å¤±è´¥å›žè°ƒ: 123456789101112131415161718//ä¾‹5function getUserId() &#123; return new Promise(function(resolve) &#123; //å¼‚æ­¥è¯·æ±‚ http.get(url, function(error, results) &#123; if (error) &#123; reject(error); &#125; resolve(results.id) &#125;) &#125;)&#125;getUserId().then(function(id) &#123; //ä¸€äº›å¤„ç†&#125;, function(error) &#123; console.log(error)&#125;) æœ‰äº†ä¹‹å‰å¤„ç†fulfilledçŠ¶æ€çš„ç»éªŒï¼Œæ”¯æŒé”™è¯¯å¤„ç†å˜å¾—å¾ˆå®¹æ˜“,åªéœ€è¦åœ¨æ³¨å†Œå›žè°ƒã€å¤„ç†çŠ¶æ€å˜æ›´ä¸Šéƒ½è¦åŠ å…¥æ–°çš„é€»è¾‘ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162function Promise(fn) &#123; var state = 'pending', value = null, callbacks = []; this.then = function (onFulfilled, onRejected) &#123; return new Promise(function (resolve, reject) &#123; handle(&#123; onFulfilled: onFulfilled || null, onRejected: onRejected || null, resolve: resolve, reject: reject &#125;); &#125;); &#125;; function handle(callback) &#123; if (state === 'pending') &#123; callbacks.push(callback); return; &#125; var cb = state === 'fulfilled' ? callback.onFulfilled : callback.onRejected, ret; if (cb === null) &#123; cb = state === 'fulfilled' ? callback.resolve : callback.reject; cb(value); return; &#125; ret = cb(value); callback.resolve(ret); &#125; function resolve(newValue) &#123; if (newValue &amp;&amp; (typeof newValue === 'object' || typeof newValue === 'function')) &#123; var then = newValue.then; if (typeof then === 'function') &#123; then.call(newValue, resolve, reject); return; &#125; &#125; state = 'fulfilled'; value = newValue; execute(); &#125; function reject(reason) &#123; state = 'rejected'; value = reason; execute(); &#125; function execute() &#123; setTimeout(function () &#123; callbacks.forEach(function (callback) &#123; handle(callback); &#125;); &#125;, 0); &#125; fn(resolve, reject);&#125; ä¸Šè¿°ä»£ç å¢žåŠ äº†æ–°çš„rejectæ–¹æ³•ï¼Œä¾›å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼ŒåŒæ—¶æŠ½å‡ºäº†resolveå’Œrejectå…±ç”¨çš„éƒ¨åˆ†ï¼Œå½¢æˆexecuteæ–¹æ³•ã€‚ é”™è¯¯å†’æ³¡æ˜¯ä¸Šè¿°ä»£ç å·²ç»æ”¯æŒï¼Œä¸”éžå¸¸å®žç”¨çš„ä¸€ä¸ªç‰¹æ€§ã€‚åœ¨handleä¸­å‘çŽ°æ²¡æœ‰æŒ‡å®šå¼‚æ­¥æ“ä½œå¤±è´¥çš„å›žè°ƒæ—¶ï¼Œä¼šç›´æŽ¥å°†bridge promise(thenå‡½æ•°è¿”å›žçš„promiseï¼ŒåŽåŒ)è®¾ä¸ºrejectedçŠ¶æ€ï¼Œå¦‚æ­¤è¾¾æˆæ‰§è¡ŒåŽç»­å¤±è´¥å›žè°ƒçš„æ•ˆæžœã€‚è¿™æœ‰åˆ©äºŽç®€åŒ–ä¸²è¡ŒPromiseçš„å¤±è´¥å¤„ç†æˆæœ¬ï¼Œå› ä¸ºä¸€ç»„å¼‚æ­¥æ“ä½œå¾€å¾€ä¼šå¯¹åº”ä¸€ä¸ªå®žé™…åŠŸèƒ½ï¼Œå¤±è´¥å¤„ç†æ–¹æ³•é€šå¸¸æ˜¯ä¸€è‡´çš„ï¼š 123456789//ä¾‹6getUserId() .then(getUserJobById) .then(function (job) &#123; // å¤„ç†job &#125;, function (error) &#123; // getUserIdæˆ–è€…getUerJobByIdæ—¶å‡ºçŽ°çš„é”™è¯¯ console.log(error); &#125;); å¼‚å¸¸å¤„ç†ç»†å¿ƒçš„åŒå­¦ä¼šæƒ³åˆ°ï¼šå¦‚æžœåœ¨æ‰§è¡ŒæˆåŠŸå›žè°ƒã€å¤±è´¥å›žè°ƒæ—¶ä»£ç å‡ºé”™æ€Žä¹ˆåŠžï¼Ÿå¯¹äºŽè¿™ç±»å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨try-catchæ•èŽ·é”™è¯¯ï¼Œå¹¶å°†bridge promiseè®¾ä¸ºrejectedçŠ¶æ€ã€‚handleæ–¹æ³•æ”¹é€ å¦‚ä¸‹ï¼š 1234567891011121314151617181920function handle(callback) &#123; if (state === 'pending') &#123; callbacks.push(callback); return; &#125; var cb = state === 'fulfilled' ? callback.onFulfilled : callback.onRejected, ret; if (cb === null) &#123; cb = state === 'fulfilled' ? callback.resolve : callback.reject; cb(value); return; &#125; try &#123; ret = cb(value); callback.resolve(ret); &#125; catch (e) &#123; callback.reject(e); &#125;&#125; å¦‚æžœåœ¨å¼‚æ­¥æ“ä½œä¸­ï¼Œå¤šæ¬¡æ‰§è¡Œresolveæˆ–è€…rejectä¼šé‡å¤å¤„ç†åŽç»­å›žè°ƒï¼Œå¯ä»¥é€šè¿‡å†…ç½®ä¸€ä¸ªæ ‡å¿—ä½è§£å†³ã€‚ æ€»ç»“åˆšå¼€å§‹çœ‹promiseæºç çš„æ—¶å€™æ€»ä¸èƒ½å¾ˆå¥½çš„ç†è§£thenå’Œresolveå‡½æ•°çš„è¿è¡Œæœºç†ï¼Œä½†æ˜¯å¦‚æžœä½ é™ä¸‹å¿ƒæ¥ï¼Œåè¿‡æ¥æ ¹æ®æ‰§è¡Œpromiseæ—¶çš„é€»è¾‘æ¥æŽ¨æ¼”ï¼Œå°±ä¸éš¾ç†è§£äº†ã€‚è¿™é‡Œä¸€å®šè¦æ³¨æ„çš„ç‚¹æ˜¯ï¼špromiseé‡Œé¢çš„thenå‡½æ•°ä»…ä»…æ˜¯æ³¨å†Œäº†åŽç»­éœ€è¦æ‰§è¡Œçš„ä»£ç ï¼ŒçœŸæ­£çš„æ‰§è¡Œæ˜¯åœ¨resolveæ–¹æ³•é‡Œé¢æ‰§è¡Œçš„ï¼Œç†æ¸…äº†è¿™å±‚ï¼Œå†æ¥åˆ†æžæºç ä¼šçœåŠ›çš„å¤šã€‚ çŽ°åœ¨å›žé¡¾ä¸‹Promiseçš„å®žçŽ°è¿‡ç¨‹ï¼Œå…¶ä¸»è¦ä½¿ç”¨äº†è®¾è®¡æ¨¡å¼ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼š é€šè¿‡Promise.prototype.thenå’ŒPromise.prototype.catchæ–¹æ³•å°†è§‚å¯Ÿè€…æ–¹æ³•æ³¨å†Œåˆ°è¢«è§‚å¯Ÿè€…Promiseå¯¹è±¡ä¸­ï¼ŒåŒæ—¶è¿”å›žä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ï¼Œä»¥ä¾¿å¯ä»¥é“¾å¼è°ƒç”¨ã€‚ è¢«è§‚å¯Ÿè€…ç®¡ç†å†…éƒ¨pendingã€fulfilledå’Œrejectedçš„çŠ¶æ€è½¬å˜ï¼ŒåŒæ—¶é€šè¿‡æž„é€ å‡½æ•°ä¸­ä¼ é€’çš„resolveå’Œrejectæ–¹æ³•ä»¥ä¸»åŠ¨è§¦å‘çŠ¶æ€è½¬å˜å’Œé€šçŸ¥è§‚å¯Ÿè€…ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>åŽŸç†ä¸Žå®žçŽ°</category>
      </categories>
      <tags>
        <tag>Promise</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…«æ®µä»£ç å½»åº•æŽŒæ¡ Promise]]></title>
    <url>%2F2018%2F05%2F20%2FJs%2F%E5%85%AB%E6%AE%B5%E4%BB%A3%E7%A0%81%E5%BD%BB%E5%BA%95%E6%8E%8C%E6%8F%A1-Promise%2F</url>
    <content type="text"><![CDATA[PromisePromiseçš„ç«‹å³æ‰§è¡Œæ€§1234567891011//1var p = new Promise(function(resolve, reject)&#123; console.log("create a promise"); resolve("success");&#125;);//2console.log("after new Promise");//3p.then(function(value)&#123; console.log(value);&#125;); æŽ§åˆ¶å°è¾“å‡ºï¼š 123"create a promise""after new Promise""success" Promiseå¯¹è±¡è¡¨ç¤ºæœªæ¥æŸä¸ªå°†è¦å‘ç”Ÿçš„äº‹ä»¶ï¼Œä½†åœ¨åˆ›å»ºï¼ˆnewï¼‰Promiseæ—¶ï¼Œä½œä¸ºPromiseå‚æ•°ä¼ å…¥çš„å‡½æ•°æ˜¯ä¼šè¢«ç«‹å³æ‰§è¡Œçš„ï¼Œåªæ˜¯å…¶ä¸­æ‰§è¡Œçš„ä»£ç å¯ä»¥æ˜¯å¼‚æ­¥ä»£ç ã€‚æœ‰äº›åŒå­¦ä¼šè®¤ä¸ºï¼Œå½“Promiseå¯¹è±¡è°ƒç”¨thenæ–¹æ³•æ—¶ï¼ŒPromiseæŽ¥æ”¶çš„å‡½æ•°æ‰ä¼šæ‰§è¡Œï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚å› æ­¤ï¼Œä»£ç ä¸­â€create a promiseâ€å…ˆäºŽâ€after new Promiseâ€è¾“å‡ºã€‚ Promise ä¸‰ç§çŠ¶æ€123456789101112131415161718192021222324252627282930313233var p1 = new Promise(function(resolve,reject)&#123; resolve(1);&#125;);var p2 = new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(2); &#125;, 500);&#125;);var p3 = new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; reject(3); &#125;, 500);&#125;);console.log(p1);console.log(p2);console.log(p3);setTimeout(function()&#123; console.log(p2);&#125;, 1000);setTimeout(function()&#123; console.log(p3);&#125;, 1000);p1.then(function(value)&#123; console.log(value);&#125;);p2.then(function(value)&#123; console.log(value);&#125;);p3.catch(function(err)&#123; console.log(err);&#125;); æŽ§åˆ¶å°è¾“å‡ºï¼š 12345678Promise &#123;[[PromiseStatus]]: "resolved", [[PromiseValue]]: 1&#125;Promise &#123;[[PromiseStatus]]: "pending", [[PromiseValue]]: undefined&#125;Promise &#123;[[PromiseStatus]]: "pending", [[PromiseValue]]: undefined&#125;123Promise &#123;[[PromiseStatus]]: "resolved", [[PromiseValue]]: 2&#125;Promise &#123;[[PromiseStatus]]: "rejected", [[PromiseValue]]: 3&#125; Promiseçš„å†…éƒ¨å®žçŽ°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºã€‚Promiseæœ‰ä¸‰ç§çŠ¶æ€ï¼špendingï¼Œresolvedï¼Œrejectedã€‚å½“Promiseåˆšåˆ›å»ºå®Œæˆæ—¶ï¼Œå¤„äºŽpendingçŠ¶æ€ï¼›å½“Promiseä¸­çš„å‡½æ•°å‚æ•°æ‰§è¡Œäº†resolveåŽï¼ŒPromiseç”±pendingçŠ¶æ€å˜æˆresolvedçŠ¶æ€ï¼›å¦‚æžœåœ¨Promiseçš„å‡½æ•°å‚æ•°ä¸­æ‰§è¡Œçš„ä¸æ˜¯resolveæ–¹æ³•ï¼Œè€Œæ˜¯rejectæ–¹æ³•ï¼Œé‚£ä¹ˆPromiseä¼šç”±pendingçŠ¶æ€å˜æˆrejectedçŠ¶æ€ã€‚ p2ã€p3åˆšåˆ›å»ºå®Œæˆæ—¶ï¼ŒæŽ§åˆ¶å°è¾“å‡ºçš„è¿™ä¸¤å°Promiseéƒ½å¤„äºŽpendingçŠ¶æ€ï¼Œä½†ä¸ºä»€ä¹ˆp1æ˜¯resolvedçŠ¶æ€å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºp1çš„å‡½æ•°å‚æ•°ä¸­æ‰§è¡Œçš„æ˜¯ä¸€æ®µåŒæ­¥ä»£ç ï¼ŒPromiseåˆšåˆ›å»ºå®Œæˆï¼Œresolveæ–¹æ³•å°±å·²ç»è¢«è°ƒç”¨äº†ï¼Œå› è€Œç´§è·Ÿç€çš„è¾“å‡ºæ˜¾ç¤ºp1æ˜¯resolvedçŠ¶æ€ã€‚æˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªsetTimeoutå‡½æ•°ï¼Œå»¶è¿Ÿ1såŽå†æ¬¡è¾“å‡ºp2ã€p3çš„çŠ¶æ€ï¼Œæ­¤æ—¶p2ã€p3å·²ç»æ‰§è¡Œå®Œæˆï¼ŒçŠ¶æ€åˆ†åˆ«å˜æˆresolvedå’Œrejectedã€‚ Promise çŠ¶æ€çš„ä¸å¯é€†æ€§1234567891011121314151617var p1 = new Promise(function(resolve, reject)&#123; resolve("success1"); resolve("success2");&#125;);var p2 = new Promise(function(resolve, reject)&#123; resolve("success"); reject("reject");&#125;);p1.then(function(value)&#123; console.log(value);&#125;);p2.then(function(value)&#123; console.log(value);&#125;); æŽ§åˆ¶å°è¾“å‡ºï¼š 12"success1""success" PromiseçŠ¶æ€çš„ä¸€æ—¦å˜æˆresolvedæˆ–rejectedæ—¶ï¼ŒPromiseçš„çŠ¶æ€å’Œå€¼å°±å›ºå®šä¸‹æ¥äº†ï¼Œä¸è®ºä½ åŽç»­å†æ€Žä¹ˆè°ƒç”¨resolveæˆ–rejectæ–¹æ³•ï¼Œéƒ½ä¸èƒ½æ”¹å˜å®ƒçš„çŠ¶æ€å’Œå€¼ã€‚å› æ­¤ï¼Œp1ä¸­resolve(&quot;success2&quot;)å¹¶ä¸èƒ½å°†p1çš„å€¼æ›´æ”¹ä¸ºsuccess2ï¼Œp2ä¸­reject(&quot;reject&quot;)ä¹Ÿä¸èƒ½å°†p2çš„çŠ¶æ€ç”±resolvedæ”¹å˜ä¸ºrejected. é“¾å¼è°ƒç”¨12345678910111213141516171819var p = new Promise(function(resolve, reject)&#123; resolve(1);&#125;);p.then(function(value)&#123; //ç¬¬ä¸€ä¸ªthen console.log(value); return value*2;&#125;).then(function(value)&#123; //ç¬¬äºŒä¸ªthen console.log(value);&#125;).then(function(value)&#123; //ç¬¬ä¸‰ä¸ªthen console.log(value); return Promise.resolve('resolve');&#125;).then(function(value)&#123; //ç¬¬å››ä¸ªthen console.log(value); return Promise.reject('reject');&#125;).then(function(value)&#123; //ç¬¬äº”ä¸ªthen console.log('resolve: '+ value);&#125;, function(err)&#123; console.log('reject: ' + err);&#125;) æŽ§åˆ¶å°è¾“å‡ºï¼š 1234512undefined"resolve""reject: reject" Promiseå¯¹è±¡çš„thenæ–¹æ³•è¿”å›žä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥é€šè¿‡é“¾å¼è°ƒç”¨thenæ–¹æ³•ã€‚thenæ–¹æ³•æŽ¥æ”¶ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Promiseæ‰§è¡ŒæˆåŠŸæ—¶çš„å›žè°ƒï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯Promiseæ‰§è¡Œå¤±è´¥æ—¶çš„å›žè°ƒã€‚ ä¸¤ä¸ªå‡½æ•°åªä¼šæœ‰ä¸€ä¸ªè¢«è°ƒç”¨ï¼Œå‡½æ•°çš„è¿”å›žå€¼å°†è¢«ç”¨ä½œåˆ›å»ºthenè¿”å›žçš„Promiseå¯¹è±¡ã€‚è¿™ä¸¤ä¸ªå‚æ•°çš„è¿”å›žå€¼å¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ç§æƒ…å†µä¸­çš„ä¸€ç§ï¼š return ä¸€ä¸ªåŒæ­¥çš„å€¼ ï¼Œæˆ–è€… undefinedï¼ˆå½“æ²¡æœ‰è¿”å›žä¸€ä¸ªæœ‰æ•ˆå€¼æ—¶ï¼Œé»˜è®¤è¿”å›žundefinedï¼‰ï¼Œthenæ–¹æ³•å°†è¿”å›žä¸€ä¸ªresolvedçŠ¶æ€çš„Promiseå¯¹è±¡ï¼ŒPromiseå¯¹è±¡çš„å€¼å°±æ˜¯è¿™ä¸ªè¿”å›žå€¼ã€‚ return å¦ä¸€ä¸ª Promiseï¼Œthenæ–¹æ³•å°†æ ¹æ®è¿™ä¸ªPromiseçš„çŠ¶æ€å’Œå€¼åˆ›å»ºä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡è¿”å›žã€‚ throw ä¸€ä¸ªåŒæ­¥å¼‚å¸¸ï¼Œthenæ–¹æ³•å°†è¿”å›žä¸€ä¸ªrejectedçŠ¶æ€çš„Promise, å€¼æ˜¯è¯¥å¼‚å¸¸ã€‚ æ ¹æ®ä»¥ä¸Šåˆ†æžï¼Œä»£ç ä¸­ç¬¬ä¸€ä¸ªthenä¼šè¿”å›žä¸€ä¸ªå€¼ä¸º2ï¼ˆ1*2ï¼‰ï¼ŒçŠ¶æ€ä¸ºresolvedçš„Promiseå¯¹è±¡ï¼ŒäºŽæ˜¯ç¬¬äºŒä¸ªthenè¾“å‡ºçš„å€¼æ˜¯2ã€‚ç¬¬äºŒä¸ªthenä¸­æ²¡æœ‰è¿”å›žå€¼ï¼Œå› æ­¤å°†è¿”å›žé»˜è®¤çš„undefinedï¼ŒäºŽæ˜¯åœ¨ç¬¬ä¸‰ä¸ªthenä¸­è¾“å‡ºundefinedã€‚ç¬¬ä¸‰ä¸ªthenå’Œç¬¬å››ä¸ªthenä¸­åˆ†åˆ«è¿”å›žä¸€ä¸ªçŠ¶æ€æ˜¯resolvedçš„Promiseå’Œä¸€ä¸ªçŠ¶æ€æ˜¯rejectedçš„Promiseï¼Œä¾æ¬¡ç”±ç¬¬å››ä¸ªthenä¸­æˆåŠŸçš„å›žè°ƒå‡½æ•°å’Œç¬¬äº”ä¸ªthenä¸­å¤±è´¥çš„å›žè°ƒå‡½æ•°å¤„ç†ã€‚ Promise then() å›žè°ƒå¼‚æ­¥æ€§12345678910var p = new Promise(function(resolve, reject)&#123; resolve("success");&#125;);p.then(function(value)&#123; console.log(value);&#125;);console.log("which one is called first ?"); æŽ§åˆ¶å°è¾“å‡ºï¼š 12"which one is called first ?""success" PromiseæŽ¥æ”¶çš„å‡½æ•°å‚æ•°æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œä½†thenæ–¹æ³•ä¸­çš„å›žè°ƒå‡½æ•°æ‰§è¡Œåˆ™æ˜¯å¼‚æ­¥çš„ï¼Œå› æ­¤ï¼Œâ€successâ€ä¼šåœ¨åŽé¢è¾“å‡ºã€‚ Promise ä¸­çš„å¼‚å¸¸1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950var p1 = new Promise( function(resolve,reject)&#123; foo.bar(); resolve( 1 );&#125;);p1.then( function(value)&#123; console.log('p1 then value: ' + value); &#125;, function(err)&#123; console.log('p1 then err: ' + err); &#125;).then( function(value)&#123; console.log('p1 then then value: '+value); &#125;, function(err)&#123; console.log('p1 then then err: ' + err); &#125;);// P2var p2 = new Promise(function(resolve,reject)&#123; resolve( 2 );&#125;);p2.then( function(value)&#123; console.log('p2 then value: ' + value); foo.bar(); &#125;, function(err)&#123; console.log('p2 then err: ' + err); &#125;).then( function(value)&#123; console.log('p2 then then value: ' + value); &#125;, function(err)&#123; console.log('p2 then then err: ' + err); return 1; &#125;).then( function(value)&#123; console.log('p2 then then then value: ' + value); &#125;, function(err)&#123; console.log('p2 then then then err: ' + err); &#125;); æŽ§åˆ¶å°è¾“å‡ºï¼š 12345p1 then err: ReferenceError: foo is not definedp2 then value: 2p1 then then value: undefinedp2 then then err: ReferenceError: foo is not definedp2 then then then value: 1 Promiseä¸­çš„å¼‚å¸¸ç”±thenå‚æ•°ä¸­ç¬¬äºŒä¸ªå›žè°ƒå‡½æ•°ï¼ˆPromiseæ‰§è¡Œå¤±è´¥çš„å›žè°ƒï¼‰å¤„ç†ï¼Œå¼‚å¸¸ä¿¡æ¯å°†ä½œä¸ºPromiseçš„å€¼ã€‚å¼‚å¸¸ä¸€æ—¦å¾—åˆ°å¤„ç†ï¼Œthenè¿”å›žçš„åŽç»­Promiseå¯¹è±¡å°†æ¢å¤æ­£å¸¸ï¼Œå¹¶ä¼šè¢«Promiseæ‰§è¡ŒæˆåŠŸçš„å›žè°ƒå‡½æ•°å¤„ç†ã€‚å¦å¤–ï¼Œéœ€è¦æ³¨æ„p1ã€p2 å¤šçº§thençš„å›žè°ƒå‡½æ•°æ˜¯äº¤æ›¿æ‰§è¡Œçš„ ï¼Œè¿™æ­£æ˜¯ç”±Promise thenå›žè°ƒçš„å¼‚æ­¥æ€§å†³å®šçš„ã€‚ Promise.resolve()12345678910111213141516171819202122232425var p1 = Promise.resolve( 1 );var p2 = Promise.resolve( p1 );var p3 = new Promise(function(resolve, reject)&#123; resolve(1);&#125;);var p4 = new Promise(function(resolve, reject)&#123; resolve(p1);&#125;);console.log(p1 === p2);console.log(p1 === p3);console.log(p1 === p4);console.log(p3 === p4);p4.then(function(value)&#123; console.log('p4=' + value);&#125;);p2.then(function(value)&#123; console.log('p2=' + value);&#125;)p1.then(function(value)&#123; console.log('p1=' + value);&#125;) æŽ§åˆ¶å°è¾“å‡ºï¼š 1234567truefalsefalsefalsep2=1p1=1p4=1 Promise.resolve(...)å¯ä»¥æŽ¥æ”¶ä¸€ä¸ªå€¼æˆ–è€…æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ä½œä¸ºå‚æ•°ã€‚å½“å‚æ•°æ˜¯æ™®é€šå€¼æ—¶ï¼Œå®ƒè¿”å›žä¸€ä¸ªresolvedçŠ¶æ€çš„Promiseå¯¹è±¡ï¼Œå¯¹è±¡çš„å€¼å°±æ˜¯è¿™ä¸ªå‚æ•°ï¼›å½“å‚æ•°æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡æ—¶ï¼Œå®ƒç›´æŽ¥è¿”å›žè¿™ä¸ªPromiseå‚æ•°ã€‚å› æ­¤ï¼Œp1 === p2ã€‚ä½†é€šè¿‡newçš„æ–¹å¼åˆ›å»ºçš„Promiseå¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå› æ­¤åŽé¢çš„ä¸‰ä¸ªæ¯”è¾ƒç»“æžœéƒ½æ˜¯falseã€‚å¦å¤–ï¼Œä¸ºä»€ä¹ˆp4çš„thenæœ€å…ˆè°ƒç”¨ï¼Œä½†åœ¨æŽ§åˆ¶å°ä¸Šæ˜¯æœ€åŽè¾“å‡ºç»“æžœçš„å‘¢ï¼Ÿå› ä¸ºp4çš„resolveä¸­æŽ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡p1ï¼Œresolveä¼šå¯¹p1â€æ‹†ç®±â€œï¼ŒèŽ·å–p1çš„çŠ¶æ€å’Œå€¼ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œå¯å‚è€ƒä¸‹ä¸€èŠ‚ã€‚ resolve vs reject1234567891011121314151617181920212223242526272829303132333435363738var p1 = new Promise(function(resolve, reject)&#123; resolve(Promise.resolve('resolve'));&#125;);var p2 = new Promise(function(resolve, reject)&#123; resolve(Promise.reject('reject'));&#125;);var p3 = new Promise(function(resolve, reject)&#123; reject(Promise.resolve('resolve'));&#125;);p1.then( function fulfilled(value)&#123; console.log('fulfilled: ' + value); &#125;, function rejected(err)&#123; console.log('rejected: ' + err); &#125;);p2.then( function fulfilled(value)&#123; console.log('fulfilled: ' + value); &#125;, function rejected(err)&#123; console.log('rejected: ' + err); &#125;);p3.then( function fulfilled(value)&#123; console.log('fulfilled: ' + value); &#125;, function rejected(err)&#123; console.log('rejected: ' + err); &#125;); æŽ§åˆ¶å°è¾“å‡ºï¼š 123p3 rejected: [object Promise]p1 fulfilled: resolvep2 rejected: reject Promiseå›žè°ƒå‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°resolveï¼Œä¼šå¯¹Promiseæ‰§è¡Œâ€æ‹†ç®±â€åŠ¨ä½œã€‚å³å½“resolveçš„å‚æ•°æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡æ—¶ï¼Œresolveä¼šâ€æ‹†ç®±â€èŽ·å–è¿™ä¸ªPromiseå¯¹è±¡çš„çŠ¶æ€å’Œå€¼ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ã€‚p1â€æ‹†ç®±â€åŽï¼ŒèŽ·å–åˆ°Promiseå¯¹è±¡çš„çŠ¶æ€æ˜¯resolvedï¼Œå› æ­¤fulfilledå›žè°ƒè¢«æ‰§è¡Œï¼›p2â€æ‹†ç®±â€åŽï¼ŒèŽ·å–åˆ°Promiseå¯¹è±¡çš„çŠ¶æ€æ˜¯rejectedï¼Œå› æ­¤rejectedå›žè°ƒè¢«æ‰§è¡Œã€‚ä½†Promiseå›žè°ƒå‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°rejectä¸å…·å¤‡â€æ‹†ç®±â€œçš„èƒ½åŠ›ï¼Œrejectçš„å‚æ•°ä¼šç›´æŽ¥ä¼ é€’ç»™thenæ–¹æ³•ä¸­çš„rejectedå›žè°ƒã€‚å› æ­¤ï¼Œå³ä½¿p3 rejectæŽ¥æ”¶äº†ä¸€ä¸ªresolvedçŠ¶æ€çš„Promiseï¼Œthenæ–¹æ³•ä¸­è¢«è°ƒç”¨çš„ä¾ç„¶æ˜¯rejectedï¼Œå¹¶ä¸”å‚æ•°å°±æ˜¯rejectæŽ¥æ”¶åˆ°çš„Promiseå¯¹è±¡ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Promise</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç²¾è¯» React é«˜é˜¶ç»„ä»¶]]></title>
    <url>%2F2018%2F05%2F19%2FReact%2F%E7%B2%BE%E8%AF%BB-React-%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[å¼•è¨€é«˜é˜¶ç»„ä»¶ï¼ˆ higher-order component ï¼ŒHOC ï¼‰æ˜¯ React ä¸­å¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§è¿›é˜¶æŠ€å·§ã€‚å®ƒæœ¬èº«å¹¶ä¸æ˜¯ React çš„ APIï¼Œè€Œæ˜¯ä¸€ç§ React ç»„ä»¶çš„è®¾è®¡ç†å¿µï¼Œä¼—å¤šçš„ React åº“å·²ç»è¯æ˜Žäº†å®ƒçš„ä»·å€¼ï¼Œä¾‹å¦‚è€³ç†Ÿèƒ½è¯¦çš„ react-reduxã€‚ é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µå…¶å®žå¹¶ä¸éš¾ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡ç±»æ¯”é«˜é˜¶å‡½æ•°è¿…é€ŸæŽŒæ¡ã€‚é«˜é˜¶å‡½æ•°æ˜¯æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥åˆ°å‡½æ•°ä¸­å¹¶è¿”å›žä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚è¿™é‡Œæˆ‘ä»¬æŠŠå‡½æ•°æ›¿æ¢ä¸ºç»„ä»¶ï¼Œå°±æ˜¯é«˜é˜¶ç»„ä»¶äº†ã€‚ 1const EnhancedComponent = higherOrderComponent(WrappedComponent); å½“ç„¶äº†è§£é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µåªæ˜¯ä¸‡é‡Œé•¿å¾ç¬¬ä¸€æ­¥ï¼Œç²¾è¯»æ–‡ç« åœ¨é˜è¿°å…¶æ¦‚å¿µä¸Žå®žçŽ°å¤–ï¼Œä¹Ÿå¼ºè°ƒäº†å…¶é‡è¦æ€§ä¸Žå±€é™æ€§ï¼Œä»¥åŠä¸Žå…¶ä»–æ–¹æ¡ˆçš„æ¯”è¾ƒï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥é¢†ç•¥å§ã€‚ å†…å®¹æ¦‚è¦é«˜é˜¶ç»„ä»¶å¸¸è§æœ‰ä¸¤ç§å®žçŽ°æ–¹å¼ï¼Œä¸€ç§æ˜¯ Props Proxyï¼Œå®ƒèƒ½å¤Ÿå¯¹ WrappedComponent çš„ props è¿›è¡Œæ“ä½œï¼Œæå– WrappedComponent state ä»¥åŠä½¿ç”¨å…¶ä»–å…ƒç´ æ¥åŒ…è£¹ WrappedComponentã€‚Props Proxy ä½œä¸ºä¸€å±‚ä»£ç†ï¼Œå…·æœ‰éš”ç¦»çš„ä½œç”¨ï¼Œå› æ­¤ä¼ å…¥ WrappedComponent çš„ ref å°†æ— æ³•è®¿é—®åˆ°å…¶æœ¬èº«ï¼Œéœ€è¦åœ¨ Props Proxy å†…å®Œæˆä¸­è½¬ï¼Œå…·ä½“å¯å‚è€ƒä»¥ä¸‹ä»£ç ï¼Œreact-redux ä¹Ÿæ˜¯è¿™æ ·å®žçŽ°çš„ã€‚æ­¤å¤–å„ä¸ª Props Proxy çš„é»˜è®¤åç§°æ˜¯ç›¸åŒçš„ï¼Œéœ€è¦æ ¹æ® WrappedComponent æ¥è¿›è¡Œä¸åŒå‘½åã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243function ppHOC(WrappedComponent) &#123; return class PP extends React.Component &#123; // å®žçŽ° HOC ä¸åŒçš„å‘½å static displayName = `HOC($&#123;WrappedComponent.displayName&#125;)`; getWrappedInstance() &#123; return this.wrappedInstance; &#125; // å®žçŽ° ref çš„è®¿é—® setWrappedInstance(ref) &#123; this.wrappedInstance = ref; &#125; render() &#123; return &lt;WrappedComponent &#123; ...this.props, ref: this.setWrappedInstance.bind(this), &#125; /&gt; &#125; &#125;&#125;@ppHOCclass Example extends React.Component &#123; static displayName = 'Example'; handleClick() &#123; ... &#125; ...&#125;class App extends React.Component &#123; handleClick() &#123; this.refs.example.getWrappedInstance().handleClick(); &#125; render() &#123; return ( &lt;div&gt; &lt;button onClick=&#123;this.handleClick.bind(this)&#125;&gt;æŒ‰é’®&lt;/button&gt; &lt;Example ref="example" /&gt; &lt;/div&gt; ); &#125;&#125; å¦ä¸€ç§æ˜¯ Inheritance Inversionï¼ŒHOC ç±»ç»§æ‰¿äº† WrappedComponentï¼Œæ„å‘³ç€å¯ä»¥è®¿é—®åˆ° WrappedComponent çš„ stateã€propsã€ç”Ÿå‘½å‘¨æœŸå’Œ render ç­‰æ–¹æ³•ã€‚å¦‚æžœåœ¨ HOC ä¸­å®šä¹‰äº†ä¸Ž WrappedComponent åŒåæ–¹æ³•ï¼Œå°†ä¼šå‘ç”Ÿè¦†ç›–ï¼Œå°±å¿…é¡»æ‰‹åŠ¨é€šè¿‡ super è¿›è¡Œè°ƒç”¨äº†ã€‚é€šè¿‡å®Œå…¨æ“ä½œ WrappedComponent çš„ render æ–¹æ³•è¿”å›žçš„å…ƒç´ æ ‘ï¼Œå¯ä»¥çœŸæ­£å®žçŽ°æ¸²æŸ“åŠ«æŒã€‚è¿™ç§æ–¹æ¡ˆä¾ç„¶æ˜¯ç»§æ‰¿çš„æ€æƒ³ï¼Œå¯¹äºŽ WrappedComponent ä¹Ÿæœ‰è¾ƒå¼ºçš„ä¾µå…¥æ€§ï¼Œå› æ­¤å¹¶ä¸å¸¸è§ã€‚ 123456789101112131415function ppHOC(WrappedComponent) &#123; return class ExampleEnhance extends WrappedComponent &#123; ... componentDidMount() &#123; super.componentDidMount(); &#125; componentWillUnmount() &#123; super.componentWillUnmount(); &#125; render() &#123; ... return super.render(); &#125; &#125;&#125; ç²¾è¯»HOC çš„é€‚ç”¨èŒƒå›´å¯¹æ¯” HOC èŒƒå¼ compose(render)(state) ä¸Žçˆ¶ç»„ä»¶ï¼ˆParent Componentï¼‰çš„èŒƒå¼ render(render(state))ï¼Œå¦‚æžœå®Œå…¨åˆ©ç”¨ HOC æ¥å®žçŽ° React çš„ implementï¼Œå°†æ“ä½œä¸Ž view åˆ†ç¦»ï¼Œä¹Ÿæœªå°ä¸å¯ï¼Œä½†å´ä¸ä¼˜é›…ã€‚HOC æœ¬è´¨ä¸Šæ˜¯ç»Ÿä¸€åŠŸèƒ½æŠ½è±¡ï¼Œå¼ºè°ƒé€»è¾‘ä¸Ž UI åˆ†ç¦»ã€‚ä½†åœ¨å®žé™…å¼€å‘ä¸­ï¼Œå‰ç«¯æ— æ³•é€ƒç¦» DOM ï¼Œè€Œé€»è¾‘ä¸Ž DOM çš„ç›¸å…³æ€§ä¸»è¦å‘ˆçŽ° 3 ç§å…³è”å½¢å¼ï¼š ä¸Ž DOM ç›¸å…³ï¼Œå»ºè®®ä½¿ç”¨çˆ¶ç»„ä»¶ï¼Œç±»ä¼¼äºŽåŽŸç”Ÿ HTML ç¼–å†™ ä¸Ž DOM ä¸ç›¸å…³ï¼Œå¦‚æ ¡éªŒã€æƒé™ã€è¯·æ±‚å‘é€ã€æ•°æ®è½¬æ¢è¿™ç±»ï¼Œé€šè¿‡æ•°æ®å˜åŒ–é—´æŽ¥æŽ§åˆ¶ DOMï¼Œå¯ä»¥ä½¿ç”¨ HOC æŠ½è±¡ äº¤å‰çš„éƒ¨åˆ†ï¼ŒDOM ç›¸å…³ï¼Œä½†å¯ä»¥åšåˆ°å®Œå…¨å†…èšï¼Œå³è¿™äº› DOM ä¸ä¼šå’Œå¤–éƒ¨æœ‰å…³è”ï¼Œå‡å¯ DOM çš„æ¸²æŸ“é€‚åˆä½¿ç”¨çˆ¶ç»„ä»¶ï¼Œè¿™æ˜¯ React JSX åŽŸç”Ÿæ”¯æŒçš„æ–¹å¼ï¼Œæ¸…æ™°æ˜“æ‡‚ã€‚æœ€å¥½æ˜¯èƒ½å°è£…æˆæœ¨å¶ç»„ä»¶ï¼ˆDumb Componentï¼‰ã€‚HOC é€‚åˆåš DOM ä¸ç›¸å…³åˆæ˜¯å¤šä¸ªç»„ä»¶å…±æ€§çš„æ“ä½œã€‚å¦‚ Form ä¸­ï¼Œvalidator æ ¡éªŒæ“ä½œå°±æ˜¯çº¯æ•°æ®æ“ä½œçš„ï¼Œæ”¾åˆ°äº† HOC ä¸­ã€‚ä½† validator ä¿¡æ¯æ²¡æœ‰æ”¾åˆ° HOC ä¸­ã€‚ä½†å¦‚æžœèƒ½æŠŠ Error ä¿¡æ¯å±•ç¤ºè¿™äº›é€»è¾‘èƒ½å¤Ÿå®Œå…¨éš”ç¦»ï¼Œä¹Ÿå¯ä»¥æ”¾åˆ° HOC ä¸­ï¼ˆå¯ç»“åˆä¸‹ä¸€å°èŠ‚ Form å…·ä½“å®žè·µè¯¦ç»†äº†è§£ï¼‰ã€‚ æ•°æ®è¯·æ±‚æ˜¯å¦ä¸€ç±» DOM ä¸ç›¸å…³çš„åœºæ™¯ï¼Œreact-refetch çš„å®žçŽ°å°±æ˜¯ä½¿ç”¨äº† HOCï¼Œåšåˆ°äº†é«˜æ•ˆå’Œä¼˜é›… 1234connect(props =&gt; (&#123; usersFetch: `/users?status=$&#123;props.status&#125;&amp;page=$&#123;props.page&#125;`, userStatsFetch: &#123; url: `/users/stats`, force: true &#125;&#125;))(UsersList) HOC çš„å…·ä½“å®žè·µHOC åœ¨çœŸå®žåœºæ™¯ä¸‹çš„è¿è¡Œéžå¸¸å¤šï¼Œä¹‹å‰ç¬”è€…åœ¨ åŸºäºŽDecoratorçš„ç»„ä»¶æ‰©å±•å®žè·µ ä¸€æ–‡ä¸­ä¹Ÿæè¿‡ä½¿ç”¨é«˜é˜¶ç»„ä»¶å°†æ›´ç»†ç²’åº¦çš„ç»„ä»¶ç»„åˆæˆ Selector ä¸Ž Searchã€‚ç»“åˆç²¾è¯»æ–‡ç« ï¼Œè¿™æ¬¡è®©æˆ‘ä»¬é€šè¿‡ Form ç»„ä»¶çš„æŠ½è±¡æ¥è¡¨çŽ° HOC å…·æœ‰çš„è‰¯å¥½æ‰©å±•æœºåˆ¶ã€‚ Form ä¸­ä¼šåŒ…å«å„ç§ä¸åŒçš„ç»„ä»¶ï¼Œå¸¸è§çš„æœ‰ Inputã€Selectorã€Checkbox ç­‰ç­‰ï¼Œä¹Ÿä¼šæœ‰æ ¹æ®ä¸šåŠ¡éœ€æ±‚åŠ å…¥çš„è‡ªå®šä¹‰ç»„ä»¶ã€‚Form çµæ´»å¤šå˜ï¼Œä»ŽåŠŸèƒ½ä¸Šçœ‹ï¼Œè¡¨å•æ ¡éªŒå¯èƒ½ä¸ºå•ç»„ä»¶å€¼æ ¡éªŒï¼Œä¹Ÿå¯èƒ½ä¸ºå…¨è¡¨å•å€¼æ ¡éªŒï¼Œå¯èƒ½ä¸ºå¸¸è§„æ£€éªŒï¼Œæ¯”å¦‚ï¼šéžç©ºã€è¾“å…¥é™åˆ¶ï¼Œä¹Ÿå¯èƒ½éœ€è¦ä¸ŽæœåŠ¡ç«¯é…åˆï¼Œç”šè‡³éœ€è¦æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è¿›è¡Œå®šåˆ¶ã€‚ä»Ž UI ä¸Šçœ‹ï¼Œæ£€éªŒç»“æžœæ˜¾ç¤ºçš„ä½ç½®ï¼Œå¯èƒ½åœ¨ç»„ä»¶ä¸‹æ–¹ï¼Œä¹Ÿå¯èƒ½æ˜¯åœ¨ç»„ä»¶å³ä¾§ã€‚ ç›´æŽ¥è£¸å†™ Formï¼Œæ— ç–‘æ˜¯æœºæ¢°è€Œåˆé‡å¤çš„ã€‚å°† Form ä¸­ç»„ä»¶çš„ value ç»è¿‡ validatorï¼ŒæŠŠ valueï¼Œvalidator äº§ç”Ÿçš„ error ä¿¡æ¯å‚¨å­˜åˆ° state æˆ– redux store ä¸­ï¼Œç„¶åŽåœ¨ view å±‚å®Œæˆæ˜¾ç¤ºã€‚è¿™æ¡è·¯å¤§å®¶éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¯ä»¥è¿›è¡Œå¤ç”¨ï¼Œåªæ˜¯æˆ‘ä»¬é¢å¯¹çš„æ˜¯ä¸åŒçš„ç»„ä»¶ï¼Œä¸åŒçš„ validatorï¼Œä¸åŒçš„ view è€Œå·²ã€‚å¯¹äºŽ Form è€Œè¨€ï¼Œæ—¢è¦æ»¡è¶³é€šç”¨ï¼Œåˆè¦æ»¡è¶³éƒ¨åˆ†ä¸ªæ€§åŒ–çš„éœ€æ±‚ï¼Œä»¥å¾€å•çº¯çš„é…ç½®åŒ–åªä¼šè®©ä½¿ç”¨æ„ˆåŠ ç¹çï¼Œæˆ‘ä»¬æ‰€éœ€è¦æŠ½è±¡çš„æ˜¯ Form åŠŸèƒ½è€Œéž UIï¼Œå› æ­¤é€šè¿‡ HOC é’ˆå¯¹ Form çš„åŠŸèƒ½è¿›è¡Œæå–å°±æˆä¸ºäº†å¿…ç„¶ã€‚ è‡³äºŽ HOC åœ¨ Form ä¸Šçš„å…·ä½“å®žçŽ°ï¼Œé¦–å…ˆå°†è¡¨å•ä¸­çš„ç»„ä»¶ï¼ˆInputã€Selectorâ€¦ï¼‰ä¸Žç›¸åº” validator ä¸Žç»„ä»¶å€¼å›žè°ƒå‡½æ•°åï¼ˆtriggerï¼‰ä¼ å…¥ Decoratorï¼Œå°† validator ä¸Ž trigger ç›¸ç»‘å®šã€‚Decorator å®Œæˆäº†å„ç§ä¸åŒç»„ä»¶ä¸Ž Form å†…ç½® Store é—´ value çš„ä¼ é€’ã€æ ¡éªŒåŠŸèƒ½çš„æŠ½è±¡ï¼Œå³ç²¾è¯»æ–‡ç« ä¸­æåˆ° Props Proxy æ–¹å¼çš„å…¶ä¸­ä¸¤ç§ä½œç”¨ï¼šæå–state ä¸Ž æ“ä½œprops 12345678910111213141516171819202122232425262728function formFactoryFactory(&#123; validator, trigger = 'onChange', ...&#125;) &#123; return FormFactory(WrappedComponent) &#123; return class Decorator extends React.Component &#123; getBind(trigger, validator) &#123; ... &#125; render() &#123; const newProps = &#123; ...this.props, [trigger]: this.getBind(trigger, validator), ... &#125; return &lt;WrappedComponent &#123;...newProps&#125; /&gt; &#125; &#125; &#125;&#125;// è°ƒç”¨formFactoryFactory(&#123; validator: (value) =&gt; &#123; return value !== ''; &#125;&#125;)(&lt;Input placeholder="è¯·è¾“å…¥..." /&gt;) å½“ç„¶ä¸ºäº†è€ƒè™‘ä¸ªæ€§åŒ–éœ€æ±‚ï¼ŒForm Store ä¹Ÿå‘å¤–æš´éœ²å¾ˆå¤š APIï¼Œå¯ä»¥ç›´æŽ¥èŽ·å–å’Œä¿®æ”¹ valueã€error çš„å€¼ã€‚çŽ°åœ¨æˆ‘ä»¬éœ€è¦å¯¹ä¸€ä¸ªè¡¨å•çš„æ‰€æœ‰å€¼æäº¤åˆ°åŽç«¯è¿›è¡Œæ ¡éªŒï¼Œæ ¹æ®åŽç«¯è¿”å›žï¼Œåˆ†åˆ«åˆ—å‡ºå„é¡¹çš„æ ¡éªŒé”™è¯¯ä¿¡æ¯ï¼Œå°±éœ€è¦å€ŸåŠ©ç›¸åº”é¡¹çš„ setError åŽ»å®Œæˆäº†ã€‚ è¿™é‡Œä¸»è¦å‚è€ƒäº† rc-form çš„å®žçŽ°æ–¹å¼ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥é˜…è¯»å…¶æºç ã€‚ 12345678910111213141516171819202122232425import &#123; createForm &#125; from 'rc-form';class Form extends React.Component &#123; submit = () =&gt; &#123; this.props.form.validateFields((error, value) =&gt; &#123; console.log(error, value); &#125;); &#125; render() &#123; const &#123; getFieldError, getFieldDecorator &#125; = this.props.form; const errors = getFieldError('required'); return ( &lt;div&gt; &#123;getFieldDecorator('required', &#123; rules: [&#123; required: true &#125;], &#125;)(&lt;Input /&gt;)&#125; &#123;errors ? errors.join(',') : null&#125; &lt;button onClick=&#123;this.submit&#125;&gt;submit&lt;/button&gt; &lt;/div&gt; ); &#125;&#125;export createForm()(Form); æ€»ç»“React å§‹ç»ˆå¼ºè°ƒç»„åˆä¼˜äºŽç»§æ‰¿çš„ç†å¿µï¼ŒæœŸæœ›é€šè¿‡å¤ç”¨å°ç»„ä»¶æ¥æž„å»ºå¤§ç»„ä»¶ä½¿å¾—å¼€å‘å˜å¾—ç®€å•è€Œåˆé«˜æ•ˆï¼Œä¸Žä¼ ç»Ÿé¢å‘å¯¹è±¡æ€æƒ³æ˜¯æˆªç„¶ä¸åŒçš„ã€‚é«˜é˜¶å‡½æ•°ï¼ˆHOCï¼‰çš„å‡ºçŽ°æ›¿ä»£äº†åŽŸæœ‰ Mixin ä¾µå…¥å¼çš„æ–¹æ¡ˆï¼Œå¯¹æ¯”éšå¼çš„ Mixin æˆ–æ˜¯ç»§æ‰¿ï¼ŒHOC èƒ½å¤Ÿåœ¨ Devtools ä¸­æ˜¾ç¤ºå‡ºæ¥ï¼Œæ»¡è¶³æŠ½è±¡ä¹‹ä½™ï¼Œä¹Ÿæ–¹ä¾¿äº†å¼€å‘ä¸Žæµ‹è¯•ã€‚å½“ç„¶ï¼Œä¸å¯è¿‡åº¦æŠ½è±¡æ˜¯æˆ‘ä»¬å§‹ç»ˆè¦ç§‰æŒçš„åŽŸåˆ™ã€‚å¸Œæœ›è¯»è€…é€šè¿‡æœ¬æ¬¡é˜…è¯»ä¸Žè®¨è®ºï¼Œèƒ½ç»“åˆè‡ªå·±å…·ä½“çš„ä¸šåŠ¡å¼€å‘åœºæ™¯ï¼ŒèŽ·å¾—ä¸€äº›å¯å‘ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¾è¯´ES Modules]]></title>
    <url>%2F2018%2F05%2F17%2FJs%2F%E5%9B%BE%E8%AF%B4ES-Modules%2F</url>
    <content type="text"><![CDATA[å‰è¨€åŽŸæ–‡ï¼šES modules: A cartoon deep-dive, Lin Clark ES modulesï¼ˆESMï¼‰ æ˜¯ JavaScript å®˜æ–¹çš„æ ‡å‡†åŒ–æ¨¡å—ç³»ç»Ÿã€‚ç„¶è€Œï¼Œå®ƒåœ¨æ ‡å‡†åŒ–çš„é“è·¯ä¸Šå·²ç»èŠ±è´¹äº†è¿‘ 10 å¹´çš„æ—¶é—´ã€‚ å¯å–œçš„æ˜¯ï¼Œæ ‡å‡†åŒ–ä¹‹è·¯é©¬ä¸Šå°±è¦å®Œæˆäº†ã€‚ç­‰åˆ° 2018 å¹´ 5 æœˆ Firefox 60 å‘å¸ƒä¹‹åŽï¼Œæ‰€æœ‰çš„ä¸»æµæµè§ˆå™¨å°±éƒ½æ”¯æŒ ESM äº†ã€‚åŒæ—¶ï¼ŒNode æ¨¡å—å·¥ä½œå°ç»„ä¹Ÿæ­£åœ¨ä¸º Node.js æ·»åŠ  ESM æ”¯æŒã€‚ä¸º WebAssembly æä¾› ESM é›†æˆçš„å·¥ä½œä¹Ÿæ­£åœ¨å¦‚ç«å¦‚è¼çš„è¿›è¡Œã€‚ è®¸å¤š JS å¼€å‘è€…éƒ½çŸ¥é“ï¼Œå¯¹ ESM çš„è®¨è®ºä»Žå¼€å§‹è‡³ä»Šä¸€ç›´éƒ½æ²¡åœè¿‡ã€‚ä½†æ˜¯å¾ˆå°‘æœ‰äººçœŸæ­£ç†è§£ ESM çš„å·¥ä½œåŽŸç†ã€‚ ä»Šå¤©ï¼Œè®©æˆ‘ä»¬æ¥æ¢³ç†æ¢³ç† ESM åˆ°åº•è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠå®ƒè·Ÿå…¶ä»–æ¨¡å—ç³»ç»Ÿä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ ä¸ºä»€ä¹ˆè¦æ¨¡å—åŒ–è¯´åˆ° JS ç¼–ç¨‹ï¼Œå…¶å®žè¯´çš„å°±æ˜¯å¦‚ä½•ç®¡ç†å˜é‡ã€‚ç¼–ç¨‹çš„è¿‡ç¨‹éƒ½æ˜¯å…³äºŽå¦‚ä½•ç»™å˜é‡èµ‹å€¼ï¼Œè¦ä¹ˆç›´æŽ¥èµ‹å€¼ç»™å˜é‡ï¼Œè¦ä¹ˆæ˜¯æŠŠä¸¤ä¸ªå˜é‡ç»“åˆèµ·æ¥ç„¶åŽå†æŠŠç»“æžœèµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ã€‚ å› ä¸ºå¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯å…³äºŽæ”¹å˜å˜é‡çš„ï¼Œæ‰€ä»¥å¦‚ä½•ç»„ç»‡è¿™äº›å˜é‡å°±ç›´æŽ¥å½±å“äº†ç¼–ç è´¨é‡ï¼Œä»¥åŠç»´æŠ¤å®ƒä»¬çš„æˆæœ¬ã€‚ å¦‚æžœä»£ç ä¸­ä»…æœ‰å°‘é‡çš„å˜é‡ï¼Œé‚£ä¹ˆç»„ç»‡èµ·æ¥å…¶å®žæ˜¯å¾ˆç®€å•çš„ã€‚JS æœ¬èº«å°±æä¾›äº†ä¸€ç§æ–¹å¼å¸®ä½ ç»„ç»‡å˜é‡ï¼Œç§°ä¸ºå‡½æ•°ä½œç”¨åŸŸã€‚å› ä¸ºå‡½æ•°ä½œç”¨åŸŸçš„ç¼˜æ•…ï¼Œä¸€ä¸ªå‡½æ•°æ— æ³•è®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä¸­å®šä¹‰çš„å˜é‡ã€‚ è¿™ç§æ–¹å¼æ˜¯å¾ˆæœ‰æ•ˆçš„ã€‚å®ƒä½¿å¾—æˆ‘ä»¬åœ¨å†™ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œåªéœ€è¦è€ƒè™‘å½“å‰å‡½æ•°ï¼Œè€Œä¸å¿…æ‹…å¿ƒå…¶å®ƒå‡½æ•°å¯èƒ½ä¼šæ”¹å˜å½“å‰å‡½æ•°çš„å˜é‡ã€‚ä¸è¿‡ï¼Œå®ƒä¹Ÿæœ‰ä¸å¥½çš„åœ°æ–¹ã€‚å®ƒä¼šè®©æˆ‘ä»¬å¾ˆéš¾åœ¨ä¸åŒå‡½æ•°ä¹‹é—´å…±äº«å˜é‡ã€‚ å¦‚æžœæˆ‘ä»¬æƒ³è·Ÿå½“å‰å‡½æ•°ä»¥å¤–çš„å‡½æ•°å…±äº«å˜é‡è¦æ€Žä¹ˆåŠžå‘¢ï¼Ÿä¸€ç§é€šç”¨çš„åšæ³•æ˜¯æŠŠè¦å…±äº«çš„å˜é‡æå‡åˆ°ä¸Šä¸€å±‚ä½œç”¨åŸŸï¼Œæ¯”å¦‚å…¨å±€ä½œç”¨åŸŸã€‚ åœ¨ jQuery æ—¶ä»£è¿™ç§æå‡åšæ³•ç›¸å½“æ™®éã€‚åœ¨æˆ‘ä»¬åŠ è½½ä»»ä½• jQuery æ’ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿ jQuery å·²ç»å­˜åœ¨äºŽå…¨å±€ä½œç”¨åŸŸã€‚ è¿™ç§åšæ³•ä¹Ÿç¡®å®žè¡Œä¹‹æœ‰æ•ˆï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†ä»¤äººçƒ¦æ¼çš„å½±å“ã€‚ é¦–å…ˆï¼Œæ‰€æœ‰çš„ scriptå¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºæŽ’åˆ—ï¼Œå¼€å‘è€…å¿…é¡»éžå¸¸è°¨æ…Žåœ°ç¡®ä¿æ²¡æœ‰ä»»ä½•ä¸€ä¸ªè„šæœ¬æŽ’åˆ—é”™è¯¯ã€‚ å¦‚æžœæŽ’åˆ—é”™äº†ï¼Œé‚£ä¹ˆåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œåº”ç”¨å°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚å½“å‡½æ•°åœ¨å…¨å±€ä½œç”¨åŸŸå¯»æ‰¾ jQuery å˜é‡æ—¶ï¼Œå¦‚æžœæ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šæŠ›å‡ºå¼‚å¸¸é”™è¯¯ï¼Œå¹¶ä¸”åœæ­¢ç»§ç»­è¿è¡Œã€‚ è¿™åŒæ—¶ä¹Ÿä½¿å¾—ä»£ç çš„åŽæœŸç»´æŠ¤å˜å¾—å›°éš¾ã€‚å®ƒä¼šä½¿å¾—ç§»é™¤æ—§ä»£ç æˆ–è€…è„šæœ¬æ ‡ç­¾å˜å¾—å……æ»¡ä¸ç¡®å®šæ€§ã€‚ä½ æ ¹æœ¬ä¸çŸ¥é“ç§»é™¤å®ƒä¼šå¸¦æ¥ä»€ä¹ˆå½±å“ã€‚ä»£ç ä¹‹é—´çš„ä¾èµ–æ˜¯ä¸é€æ˜Žçš„ã€‚ä»»ä½•å‡½æ•°éƒ½å¯èƒ½ä¾èµ–å…¨å±€ä½œç”¨åŸŸä¸­çš„ä»»ä½•å˜é‡ï¼Œä»¥è‡³äºŽä½ ä¹Ÿä¸çŸ¥é“å“ªä¸ªå‡½æ•°ä¾èµ–å“ªä¸ªè„šæœ¬ã€‚ æ¨¡å—åŒ–çš„ä½œç”¨ æ¨¡å—åŒ–ä¸ºä½ æä¾›äº†ä¸€ç§æ›´å¥½çš„æ–¹å¼æ¥ç»„ç»‡å˜é‡å’Œå‡½æ•°ã€‚ä½ å¯ä»¥æŠŠç›¸å…³çš„å˜é‡å’Œå‡½æ•°æ”¾åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªæ¨¡å—ã€‚ è¿™ç§ç»„ç»‡æ–¹å¼ä¼šæŠŠå‡½æ•°å’Œå˜é‡æ”¾åœ¨æ¨¡å—ä½œç”¨åŸŸä¸­ã€‚æ¨¡å—ä¸­çš„å‡½æ•°å¯ä»¥é€šè¿‡æ¨¡å—ä½œç”¨åŸŸæ¥å…±äº«å˜é‡ã€‚ ä¸è¿‡ï¼Œä¸Žå‡½æ•°ä½œç”¨åŸŸä¸åŒçš„æ˜¯ï¼Œæ¨¡å—ä½œç”¨åŸŸè¿˜æä¾›äº†ä¸€ç§æš´éœ²å˜é‡ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨çš„æ–¹å¼ã€‚æ¨¡å—å¯ä»¥æ˜Žç¡®åœ°æŒ‡å®šå“ªäº›å˜é‡ã€ç±»æˆ–å‡½æ•°å¯¹å¤–æš´éœ²ã€‚ å¯¹å¤–æš´éœ²çš„è¿‡ç¨‹ç§°ä¸ºå¯¼å‡ºã€‚ä¸€æ—¦å¯¼å‡ºï¼Œå…¶ä»–æ¨¡å—å°±å¯ä»¥æ˜Žç¡®åœ°å£°ç§°å®ƒä»¬ä¾èµ–è¿™äº›å¯¼å‡ºçš„å˜é‡ã€ç±»æˆ–è€…å‡½æ•°ã€‚ å› ä¸ºè¿™æ˜¯ä¸€ç§æ˜Žç¡®çš„å…³ç³»ï¼Œæ‰€ä»¥ä½ å¯ä»¥å¾ˆç®€å•åœ°è¾¨åˆ«å“ªäº›ä»£ç èƒ½ç§»é™¤ï¼Œå“ªäº›ä¸èƒ½ç§»é™¤ã€‚ æ‹¥æœ‰äº†åœ¨æ¨¡å—ä¹‹é—´å¯¼å‡ºå’Œå¯¼å…¥å˜é‡çš„èƒ½åŠ›ä¹‹åŽï¼Œä½ å°±å¯ä»¥æŠŠä»£ç åˆ†å‰²æˆæ›´å°çš„ã€å¯ä»¥ç‹¬ç«‹è¿è¡Œåœ°ä»£ç å—äº†ã€‚ç„¶åŽï¼Œä½ å°±å¯ä»¥åƒæ­ä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼ŒåŸºäºŽè¿™äº›ä»£ç å—ï¼Œåˆ›å»ºæ‰€æœ‰ä¸åŒç±»åž‹çš„åº”ç”¨ã€‚ ç”±äºŽæ¨¡å—åŒ–æ˜¯éžå¸¸æœ‰ç”¨çš„ï¼Œæ‰€ä»¥åŽ†å²ä¸Šæ›¾ç»å¤šæ¬¡å°è¯•ä¸º JS æ·»åŠ æ¨¡å—åŒ–çš„åŠŸèƒ½ã€‚ä¸è¿‡æˆªæ­¢åˆ°ç›®å‰ï¼ŒçœŸæ­£å¾—åˆ°å¹¿æ³›ä½¿ç”¨çš„åªæœ‰ä¸¤ä¸ªæ¨¡å—ç³»ç»Ÿã€‚ä¸€ä¸ªæ˜¯ Node.js ä½¿ç”¨çš„ CommonJS ï¼ˆCJSï¼‰ï¼›å¦ä¸€ä¸ªæ˜¯ JS è§„èŒƒçš„æ–°æ¨¡å—ç³»ç»Ÿ EcmaScript modulesï¼ˆESMï¼‰ï¼ŒNode.js ä¹Ÿæ­£åœ¨æ·»åŠ å¯¹ ESM çš„æ”¯æŒã€‚ ä¸‹é¢å°±è®©æˆ‘ä»¬æ¥æ·±å…¥ç†è§£ä¸‹è¿™ä¸ªæ–°çš„æ¨¡å—ç³»ç»Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ ESM åŽŸç†å½“ä½ åœ¨ä½¿ç”¨æ¨¡å—è¿›è¡Œå¼€å‘æ—¶ï¼Œå…¶å®žæ˜¯åœ¨æž„å»ºä¸€å¼ ä¾èµ–å…³ç³»å›¾ã€‚ä¸åŒæ¨¡å—ä¹‹é—´çš„è¿žçº¿å°±ä»£è¡¨äº†ä»£ç ä¸­çš„å¯¼å…¥è¯­å¥ã€‚ æ­£æ˜¯è¿™äº›å¯¼å…¥è¯­å¥å‘Šè¯‰æµè§ˆå™¨æˆ–è€… Node è¯¥åŽ»åŠ è½½å“ªäº›ä»£ç ã€‚æˆ‘ä»¬è¦åšçš„æ˜¯ä¸ºä¾èµ–å…³ç³»å›¾æŒ‡å®šä¸€ä¸ªå…¥å£æ–‡ä»¶ã€‚ä»Žè¿™ä¸ªå…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæµè§ˆå™¨æˆ–è€… Node å°±ä¼šé¡ºç€å¯¼å…¥è¯­å¥æ‰¾å‡ºæ‰€ä¾èµ–çš„å…¶ä»–ä»£ç æ–‡ä»¶ã€‚ ä½†æ˜¯å‘¢ï¼Œæµè§ˆå™¨å¹¶ä¸èƒ½ç›´æŽ¥ä½¿ç”¨è¿™äº›ä»£ç æ–‡ä»¶ã€‚å®ƒéœ€è¦è§£æžæ‰€æœ‰çš„æ–‡ä»¶ï¼Œå¹¶æŠŠå®ƒä»¬å˜æˆä¸€ç§ç§°ä¸ºæ¨¡å—è®°å½•ï¼ˆModule Recordï¼‰çš„æ•°æ®ç»“æž„ã€‚åªæœ‰è¿™æ ·ï¼Œå®ƒæ‰çŸ¥é“ä»£ç æ–‡ä»¶ä¸­åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚ è§£æžä¹‹åŽï¼Œè¿˜éœ€è¦æŠŠæ¨¡å—è®°å½•å˜æˆä¸€ä¸ªæ¨¡å—å®žä¾‹ã€‚æ¨¡å—å®žä¾‹ä¼šæŠŠä»£ç å’ŒçŠ¶æ€ç»“åˆèµ·æ¥ã€‚ æ‰€è°“ä»£ç ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ç»„æŒ‡ä»¤é›†åˆã€‚å®ƒå°±åƒæ˜¯åˆ¶ä½œæŸæ ·ä¸œè¥¿çš„é…æ–¹ï¼ŒæŒ‡å¯¼ä½ è¯¥å¦‚ä½•åˆ¶ä½œã€‚ä½†æ˜¯å®ƒæœ¬èº«å¹¶ä¸èƒ½è®©ä½ å®Œæˆåˆ¶ä½œã€‚ä½ è¿˜éœ€è¦ä¸€äº›åŽŸæ–™ï¼Œè¿™æ ·æ‰å¯ä»¥æŒ‰ç…§è¿™äº›æŒ‡ä»¤å®Œæˆåˆ¶ä½œã€‚ æ‰€è°“çŠ¶æ€ï¼Œå®ƒå°±æ˜¯åŽŸæ–™ã€‚å…·ä½“ç‚¹ï¼ŒçŠ¶æ€æ˜¯å˜é‡åœ¨ä»»ä½•æ—¶å€™çš„çœŸå®žå€¼ã€‚å½“ç„¶ï¼Œå˜é‡å®žé™…ä¸Šå°±æ˜¯å†…å­˜åœ°å€çš„åˆ«åï¼Œå†…å­˜æ‰æ˜¯æ­£åœ¨å­˜å‚¨å€¼çš„åœ°æ–¹ã€‚ æ‰€ä»¥ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæ¨¡å—å®žä¾‹ä¸­ä»£ç å’ŒçŠ¶æ€çš„ç»“åˆï¼Œå°±æ˜¯æŒ‡ä»¤é›†å’Œå˜é‡å€¼çš„ç»“åˆã€‚ å¯¹äºŽæ¨¡å—è€Œè¨€ï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯æ¨¡å—å®žä¾‹ã€‚æ¨¡å—åŠ è½½ä¼šä»Žå…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæœ€ç»ˆç”Ÿæˆå®Œæ•´çš„æ¨¡å—å®žä¾‹å…³ç³»å›¾ã€‚ å¯¹äºŽ ESM ï¼Œè¿™ä¸ªè¿‡ç¨‹åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š æž„å»ºï¼šæŸ¥æ‰¾ï¼Œä¸‹è½½ï¼Œç„¶åŽæŠŠæ‰€æœ‰æ–‡ä»¶è§£æžæˆæ¨¡å—è®°å½•ã€‚ å®žä¾‹åŒ–ï¼šä¸ºæ‰€æœ‰æ¨¡å—åˆ†é…å†…å­˜ç©ºé—´ï¼ˆæ­¤åˆ»è¿˜æ²¡æœ‰å¡«å……å€¼ï¼‰ï¼Œç„¶åŽä¾ç…§å¯¼å‡ºã€å¯¼å…¥è¯­å¥æŠŠæ¨¡å—æŒ‡å‘å¯¹åº”çš„å†…å­˜åœ°å€ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºé“¾æŽ¥ï¼ˆLinkingï¼‰ã€‚ è¿è¡Œï¼šè¿è¡Œä»£ç ï¼Œä»Žè€ŒæŠŠå†…å­˜ç©ºé—´å¡«å……ä¸ºçœŸå®žå€¼ã€‚ å¤§å®¶éƒ½è¯´ ESM æ˜¯å¼‚æ­¥çš„ã€‚å› ä¸ºå®ƒæŠŠæ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºäº†ä¸‰ä¸ªä¸åŒçš„é˜¶æ®µï¼šåŠ è½½ã€å®žä¾‹åŒ–å’Œè¿è¡Œï¼Œå¹¶ä¸”è¿™ä¸‰ä¸ªé˜¶æ®µæ˜¯å¯ä»¥ç‹¬ç«‹è¿›è¡Œçš„ã€‚ è¿™æ„å‘³ç€ï¼ŒESM è§„èŒƒç¡®å®žå¼•å…¥äº†ä¸€ç§å¼‚æ­¥æ–¹å¼ï¼Œä¸”è¿™ç§å¼‚æ­¥æ–¹å¼åœ¨ CJS ä¸­æ˜¯æ²¡æœ‰çš„ã€‚åŽé¢æˆ‘ä»¬ä¼šè¯¦ç»†è¯´åˆ°ä¸ºä»€ä¹ˆï¼Œç„¶è€Œåœ¨ CJS ä¸­ï¼Œä¸€ä¸ªæ¨¡å—åŠå…¶ä¾èµ–çš„åŠ è½½ã€å®žä¾‹åŒ–å’Œè¿è¡Œæ˜¯ä¸€èµ·é¡ºåºæ‰§è¡Œçš„ï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•é—´æ–­ã€‚ ä¸è¿‡ï¼Œè¿™ä¸‰ä¸ªé˜¶æ®µæœ¬èº«æ˜¯æ²¡å¿…è¦å¼‚æ­¥åŒ–ã€‚å®ƒä»¬å¯ä»¥åŒæ­¥æ‰§è¡Œï¼Œè¿™å–å†³äºŽå®ƒæ˜¯ç”±è°æ¥åŠ è½½çš„ã€‚å› ä¸º ESM æ ‡å‡†å¹¶æ²¡æœ‰æ˜Žç¡®è§„èŒƒæ‰€æœ‰ç›¸å…³å†…å®¹ã€‚å®žé™…ä¸Šï¼Œè¿™äº›å·¥ä½œåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå¹¶ä¸”åˆ†åˆ«æ˜¯ç”±ä¸åŒçš„æ ‡å‡†æ‰€è§„èŒƒçš„ã€‚ å…¶ä¸­ï¼ŒESM æ ‡å‡† è§„èŒƒäº†å¦‚ä½•æŠŠæ–‡ä»¶è§£æžä¸ºæ¨¡å—è®°å½•ï¼Œå¦‚ä½•å®žä¾‹åŒ–å’Œå¦‚ä½•è¿è¡Œæ¨¡å—ã€‚ä½†æ˜¯å®ƒæ²¡æœ‰è§„èŒƒå¦‚ä½•èŽ·å–æ–‡ä»¶ã€‚ æ–‡ä»¶æ˜¯ç”±åŠ è½½å™¨æ¥æå–çš„ï¼Œè€ŒåŠ è½½å™¨ç”±å¦ä¸€ä¸ªä¸åŒçš„æ ‡å‡†æ‰€è§„èŒƒã€‚å¯¹äºŽæµè§ˆå™¨æ¥è¯´ï¼Œè¿™ä¸ªæ ‡å‡†å°±æ˜¯HTMLã€‚ä½†æ˜¯ä½ è¿˜å¯ä»¥æ ¹æ®æ‰€ä½¿ç”¨çš„å¹³å°ä½¿ç”¨ä¸åŒçš„åŠ è½½å™¨ã€‚ åŠ è½½å™¨ä¹ŸåŒæ—¶æŽ§åˆ¶ç€å¦‚ä½•åŠ è½½æ¨¡å—ã€‚å®ƒä¼šè°ƒç”¨ ESM çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ ParseModuleã€Module.Instantiate å’Œ Module.Evaluate ã€‚å®ƒå°±åƒæ˜¯æŽ§åˆ¶ç€ JS å¼•æ“Žçš„æœ¨å¶ã€‚ ä¸‹é¢æˆ‘ä»¬å°†æ›´åŠ è¯¦ç»†åœ°è¯´æ˜Žæ¯ä¸€æ­¥ã€‚ æž„å»º å¯¹äºŽæ¯ä¸ªæ¨¡å—ï¼Œåœ¨æž„å»ºé˜¶æ®µä¼šåšä¸‰ä¸ªå¤„ç†ï¼š ç¡®å®šè¦ä»Žå“ªé‡Œä¸‹è½½åŒ…å«è¯¥æ¨¡å—çš„æ–‡ä»¶ï¼Œä¹Ÿç§°ä¸ºæ¨¡å—å®šä½ï¼ˆModule Resolutionï¼‰ æå–æ–‡ä»¶ï¼Œé€šè¿‡ä»Ž URL ä¸‹è½½æˆ–è€…ä»Žæ–‡ä»¶ç³»ç»ŸåŠ è½½ è§£æžæ–‡ä»¶ä¸ºæ¨¡å—è®°å½• ä¸‹è½½æ¨¡å—åŠ è½½å™¨è´Ÿè´£å®šä½æ–‡ä»¶å¹¶ä¸”æå–ã€‚é¦–å…ˆï¼Œå®ƒéœ€è¦æ‰¾åˆ°å…¥å£æ–‡ä»¶ã€‚åœ¨ HTML ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ &lt;script&gt; æ ‡ç­¾æ¥å‘Šè¯‰åŠ è½½å™¨ã€‚ ä½†æ˜¯ï¼ŒåŠ è½½å™¨è¦å¦‚ä½•å®šä½ main.js ç›´æŽ¥ä¾èµ–çš„æ¨¡å—å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å¯¼å…¥è¯­å¥å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å¯¼å…¥è¯­å¥ä¸­æœ‰ä¸€éƒ¨åˆ†ç§°ä¸ºæ¨¡å—å®šä½ç¬¦ï¼ˆModule Specifierï¼‰ï¼Œå®ƒä¼šå‘Šè¯‰åŠ è½½å™¨åŽ»å“ªå®šä½æ¨¡å—ã€‚ å¯¹äºŽæ¨¡å—å®šä½ç¬¦ï¼Œæœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼šå®ƒä»¬åœ¨æµè§ˆå™¨å’Œ Node ä¸­ä¼šæœ‰ä¸åŒçš„å¤„ç†ã€‚æ¯ä¸ªå¹³å°éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—æ–¹å¼æ¥è§£æžæ¨¡å—å®šä½ç¬¦ã€‚è¿™äº›æ–¹å¼ç§°ä¸ºæ¨¡å—å®šä½ç®—æ³•ï¼Œä¸åŒçš„å¹³å°ä¼šä½¿ç”¨ä¸åŒçš„æ¨¡å—å®šä½ç®—æ³•ã€‚å½“å‰ï¼Œä¸€äº›åœ¨ Node ä¸­èƒ½å·¥ä½œæ¨¡å—å®šä½ç¬¦å¹¶ä¸èƒ½åœ¨æµè§ˆå™¨ä¸­å·¥ä½œï¼Œä½†æ˜¯å·²ç»æœ‰ä¸€é¡¹å·¥ä½œæ­£åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ åœ¨è¿™ä¸ªé—®é¢˜è¢«è§£å†³ä¹‹å‰ï¼Œæµè§ˆå™¨åªæŽ¥å— URL ä½œä¸ºæ¨¡å—å®šä½ç¬¦ã€‚å®ƒä»¬ä¼šä»Ž URL åŠ è½½æ¨¡å—æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ˜¯åœ¨æ•´ä¸ªå…³ç³»å›¾ä¸ŠåŒæ—¶å‘ç”Ÿçš„ã€‚å› ä¸ºåœ¨è§£æžå®Œè¿™ä¸ªæ¨¡å—ä¹‹å‰ï¼Œä½ æ ¹æœ¬ä¸çŸ¥é“å®ƒä¾èµ–å“ªäº›æ¨¡å—ã€‚è€Œä¸”åœ¨å®ƒä¸‹è½½å®Œæˆä¹‹å‰ï¼Œä½ ä¹Ÿæ— æ³•è§£æžå®ƒã€‚ è¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬å¿…é¡»ä¸€å±‚å±‚éåŽ†ä¾èµ–æ ‘ï¼Œå…ˆè§£æžæ–‡ä»¶ï¼Œç„¶åŽæ‰¾å‡ºä¾èµ–ï¼Œæœ€åŽåˆå®šä½å¹¶åŠ è½½è¿™äº›ä¾èµ–ï¼Œå¦‚æ­¤å¾€å¤ã€‚ å¦‚æžœä¸»çº¿ç¨‹æ­£åœ¨ç­‰å¾…è¿™äº›æ¨¡å—æ–‡ä»¶ä¸‹è½½å®Œæˆï¼Œè®¸å¤šå…¶ä»–ä»»åŠ¡å°†ä¼šå †ç§¯åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œé€ æˆé˜»å¡žã€‚è¿™æ˜¯å› ä¸ºåœ¨æµè§ˆå™¨ä¸­ï¼Œä¸‹è½½ä¼šè€—è´¹å¤§é‡çš„æ—¶é—´ã€‚ è€Œé˜»å¡žä¸»çº¿ç¨‹ä¼šä½¿å¾—åº”ç”¨å˜å¾—å¡é¡¿ï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚è¿™æ˜¯ ESM æ ‡å‡†æŠŠç®—æ³•åˆ†æˆå¤šä¸ªé˜¶æ®µçš„åŽŸå› ä¹‹ä¸€ã€‚å°†æž„å»ºåˆ’åˆ†ä¸ºä¸€ä¸ªç‹¬ç«‹é˜¶æ®µåŽï¼Œæµè§ˆå™¨å¯ä»¥åœ¨è¿›å…¥åŒæ­¥çš„å®žä¾‹åŒ–è¿‡ç¨‹ä¹‹å‰ä¸‹è½½æ–‡ä»¶ç„¶åŽç†è§£æ¨¡å—å…³ç³»å›¾ã€‚ ESM å’Œ CJS ä¹‹é—´æœ€ä¸»è¦çš„åŒºåˆ«ä¹‹ä¸€å°±æ˜¯ï¼ŒESM æŠŠç®—æ³•åŒ–ä¸ºä¸ºå¤šä¸ªé˜¶æ®µã€‚ CJS ä½¿ç”¨ä¸åŒçš„ç®—æ³•æ˜¯å› ä¸ºå®ƒä»Žæ–‡ä»¶ç³»ç»ŸåŠ è½½æ–‡ä»¶ï¼Œè¿™è€—è´¹çš„æ—¶é—´è¿œè¿œå°äºŽä»Žç½‘ç»œä¸Šä¸‹è½½ã€‚å› æ­¤ Node åœ¨åŠ è½½æ–‡ä»¶çš„æ—¶å€™å¯ä»¥é˜»å¡žä¸»çº¿ç¨‹ï¼Œè€Œä¸é€ æˆå¤ªå¤§å½±å“ã€‚è€Œä¸”æ—¢ç„¶æ–‡ä»¶å·²ç»åŠ è½½å®Œæˆäº†ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥ç›´æŽ¥è¿›è¡Œå®žä¾‹åŒ–å’Œè¿è¡Œã€‚æ‰€ä»¥åœ¨ CJS ä¸­å®žä¾‹åŒ–å’Œè¿è¡Œå¹¶ä¸æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„é˜¶æ®µã€‚ è¿™ä¹Ÿæ„å‘³ç€ï¼Œä½ å¯ä»¥åœ¨è¿”å›žæ¨¡å—å®žä¾‹ä¹‹å‰ï¼Œé¡ºç€æ•´é¢—ä¾èµ–æ ‘åŽ»é€ä¸€åŠ è½½ã€å®žä¾‹åŒ–å’Œè¿è¡Œæ¯ä¸€ä¸ªä¾èµ–ã€‚ CJS çš„æ–¹å¼å¯¹ ESM ä¹Ÿæœ‰ä¸€äº›å¯å‘ï¼Œè¿™ä¸ªåŽé¢ä¼šè§£é‡Šã€‚å…¶ä¸­ä¸€ä¸ªå°±æ˜¯ï¼Œåœ¨ Node çš„ CJS ä¸­ï¼Œä½ å¯ä»¥åœ¨æ¨¡å—å®šä½ç¬¦ä¸­ä½¿ç”¨å˜é‡ã€‚å› ä¸ºå·²ç»æ‰§è¡Œäº† require ä¹‹å‰çš„ä»£ç ï¼Œæ‰€ä»¥æ¨¡å—å®šä½ç¬¦ä¸­çš„å˜é‡æ­¤åˆ»æ˜¯æœ‰å€¼çš„ï¼Œè¿™æ ·å°±å¯ä»¥è¿›è¡Œæ¨¡å—å®šä½çš„å¤„ç†äº†ã€‚ ä½†æ˜¯å¯¹äºŽ ESMï¼Œåœ¨è¿è¡Œä»»ä½•ä»£ç ä¹‹å‰ï¼Œä½ é¦–å…ˆéœ€è¦å»ºç«‹æ•´ä¸ªæ¨¡å—ä¾èµ–çš„å…³ç³»å›¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå»ºç«‹å…³ç³»å›¾æ—¶å˜é‡æ˜¯è¿˜æ²¡æœ‰å€¼çš„ï¼Œå› ä¸ºä»£ç éƒ½è¿˜æ²¡è¿è¡Œã€‚ ä¸è¿‡å‘¢ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ç¡®å®žéœ€è¦åœ¨æ¨¡å—å®šä½ç¬¦ä¸­ä½¿ç”¨å˜é‡ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®å½“å‰çš„çŠ¶å†µåŠ è½½ä¸åŒçš„ä¾èµ–ã€‚ ä¸ºäº†åœ¨ ESM ä¸­å®žçŽ°è¿™ç§æ–¹å¼ï¼Œäººä»¬å·²ç»æå‡ºäº†ä¸€ä¸ªåŠ¨æ€å¯¼å…¥ææ¡ˆã€‚è¯¥ææ¡ˆå…è®¸ä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼ import(\${path}/foo.js)çš„å¯¼å…¥è¯­å¥ã€‚ è¿™ç§æ–¹å¼å®žé™…ä¸Šæ˜¯æŠŠä½¿ç”¨ import() åŠ è½½çš„æ–‡ä»¶å½“æˆäº†ä¸€ä¸ªå…¥å£æ–‡ä»¶ã€‚åŠ¨æ€å¯¼å…¥çš„æ¨¡å—ä¼šå¼€å¯ä¸€ä¸ªå…¨æ–°çš„ç‹¬ç«‹ä¾èµ–å…³ç³»æ ‘ã€‚ ä¸è¿‡æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤æ£µä¾èµ–å…³ç³»æ ‘å…±æœ‰çš„æ¨¡å—ä¼šå…±äº«åŒä¸€ä¸ªæ¨¡å—å®žä¾‹ã€‚è¿™æ˜¯å› ä¸ºåŠ è½½å™¨ä¼šç¼“å­˜æ¨¡å—å®žä¾‹ã€‚åœ¨ç‰¹å®šçš„å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œæ¯ä¸ªæ¨¡å—åªä¼šæœ‰ä¸€ä¸ªä¸Žä¹‹å¯¹åº”çš„æ¨¡å—å®žä¾‹ã€‚ è¿™ç§æ–¹å¼æœ‰åŠ©äºŽæé«˜ JS å¼•æ“Žçš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¨¡å—æ–‡ä»¶åªä¼šè¢«ä¸‹è½½ä¸€æ¬¡ï¼Œå³ä½¿æœ‰å¤šä¸ªæ¨¡å—ä¾èµ–å®ƒã€‚è¿™ä¹Ÿæ˜¯ç¼“å­˜æ¨¡å—çš„åŽŸå› ä¹‹ä¸€ï¼ŒåŽé¢è¯´åˆ°è¿è¡Œçš„æ—¶å€™ä¼šä»‹ç»å¦ä¸€ä¸ªåŽŸå› ã€‚ åŠ è½½å™¨ä½¿ç”¨æ¨¡å—æ˜ å°„ï¼ˆModule Mapï¼‰æ¥ç®¡ç†ç¼“å­˜ã€‚æ¯ä¸ªå…¨å±€ä½œç”¨åŸŸéƒ½åœ¨ä¸€ä¸ªå•ç‹¬çš„æ¨¡å—æ˜ å°„ä¸­è·Ÿè¸ªå…¶æ¨¡å—ã€‚ å½“åŠ è½½å™¨è¦ä»Žä¸€ä¸ª URL åŠ è½½æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šæŠŠ URL è®°å½•åˆ°æ¨¡å—æ˜ å°„ä¸­ï¼Œå¹¶æŠŠå®ƒæ ‡è®°ä¸ºæ­£åœ¨ä¸‹è½½çš„æ–‡ä»¶ã€‚ç„¶åŽå®ƒä¼šå‘å‡ºè¿™ä¸ªæ–‡ä»¶è¯·æ±‚å¹¶ç»§ç»­å¼€å§‹èŽ·å–ä¸‹ä¸€ä¸ªæ–‡ä»¶ã€‚ å½“å…¶ä»–æ¨¡å—ä¹Ÿä¾èµ–è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼ŸåŠ è½½å™¨ä¼šæŸ¥æ‰¾æ¨¡å—æ˜ å°„ä¸­çš„æ¯ä¸€ä¸ª URL ã€‚å¦‚æžœå‘çŽ° URL çš„çŠ¶æ€ä¸ºæ­£åœ¨ä¸‹è½½ï¼Œåˆ™ä¼šè·³è¿‡è¯¥ URL ï¼Œç„¶åŽå¼€å§‹ä¸‹ä¸€ä¸ªä¾èµ–çš„å¤„ç†ã€‚ ä¸è¿‡ï¼Œæ¨¡å—æ˜ å°„çš„ä½œç”¨å¹¶ä¸ä»…ä»…æ˜¯è®°å½•å“ªäº›æ–‡ä»¶å·²ç»ä¸‹è½½ã€‚ä¸‹é¢æˆ‘ä»¬å°†ä¼šçœ‹åˆ°ï¼Œæ¨¡å—æ˜ å°„ä¹Ÿå¯ä»¥ä½œä¸ºæ¨¡å—çš„ç¼“å­˜ã€‚ è§£æžæ¨¡å—è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†æ¨¡å—æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒè§£æžä¸ºæ¨¡å—è®°å½•ã€‚è¿™æœ‰åŠ©äºŽæµè§ˆå™¨ç†è§£æ¨¡å—çš„ä¸åŒéƒ¨åˆ†ã€‚ ä¸€æ—¦æ¨¡å—è®°å½•åˆ›å»ºå®Œæˆï¼Œå®ƒå°±ä¼šè¢«è®°å½•åœ¨æ¨¡å—æ˜ å°„ä¸­ã€‚æ‰€ä»¥ï¼ŒåŽç»­ä»»ä½•æ—¶å€™å†æ¬¡è¯·æ±‚è¿™ä¸ªæ¨¡å—æ—¶ï¼ŒåŠ è½½å™¨å°±å¯ä»¥ç›´æŽ¥ä»Žæ¨¡å—æ˜ å°„ä¸­èŽ·å–è¯¥æ¨¡å—ã€‚ è§£æžè¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªçœ‹ä¼¼å¾®ä¸è¶³é“çš„ç»†èŠ‚ï¼Œä½†æ˜¯å®žé™…é€ æˆçš„å½±å“å´å¾ˆå¤§ã€‚é‚£å°±æ˜¯æ‰€æœ‰çš„æ¨¡å—éƒ½æŒ‰ç…§ä¸¥æ ¼æ¨¡å¼æ¥è§£æžçš„ã€‚ä¹Ÿè¿˜æœ‰å…¶ä»–çš„å°ç»†èŠ‚ï¼Œæ¯”å¦‚ï¼Œå…³é”®å­— await åœ¨æ¨¡å—çš„æœ€é¡¶å±‚æ˜¯ä¿ç•™å­—ï¼Œ this çš„å€¼ä¸º undefindedã€‚ è¿™ç§ä¸åŒçš„è§£æžæ–¹å¼ç§°ä¸ºè§£æžç›®æ ‡ï¼ˆParse Goalï¼‰ã€‚å¦‚æžœæŒ‰ç…§ä¸åŒçš„è§£æžç›®æ ‡æ¥è§£æžç›¸åŒçš„æ–‡ä»¶ï¼Œä¼šå¾—åˆ°ä¸åŒçš„ç»“æžœã€‚å› æ­¤ï¼Œåœ¨è§£æžæ–‡ä»¶ä¹‹å‰ï¼Œå¿…é¡»æ¸…æ¥šåœ°çŸ¥é“æ‰€è§£æžçš„æ–‡ä»¶ç±»åž‹æ˜¯ä»€ä¹ˆï¼Œä¸ç®¡å®ƒæ˜¯ä¸æ˜¯ä¸€ä¸ªæ¨¡å—æ–‡ä»¶ã€‚ åœ¨æµè§ˆå™¨ä¸­ï¼ŒçŸ¥é“æ–‡ä»¶ç±»åž‹æ˜¯å¾ˆç®€å•çš„ã€‚åªéœ€è¦åœ¨ &lt;script&gt; è„šæœ¬ä¸­æ·»åŠ  type=â€moduleâ€ å±žæ€§å³å¯ã€‚è¿™å‘Šè¯‰æµè§ˆå™¨è¿™ä¸ªæ–‡ä»¶éœ€è¦è¢«è§£æžä¸ºä¸€ä¸ªæ¨¡å—ã€‚è€Œä¸”ï¼Œå› ä¸ºåªæœ‰æ¨¡å—æ‰èƒ½è¢«å¯¼å…¥ï¼Œæ‰€ä»¥æµè§ˆå™¨ä»¥æ­¤æŽ¨æµ‹æ‰€æœ‰çš„å¯¼å…¥ä¹Ÿéƒ½æ˜¯æ¨¡å—æ–‡ä»¶ã€‚ ä¸è¿‡åœ¨ Node ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸ä½¿ç”¨ HTML æ ‡ç­¾ï¼Œæ‰€ä»¥ä¹Ÿæ²¡åŠžæ³•é€šè¿‡ type å±žæ€§æ¥è¾¨åˆ«ã€‚ç¤¾åŒºæå‡ºä¸€ç§è§£å†³åŠžæ³•æ˜¯ä½¿ç”¨ .mjs æ‹“å±•åã€‚ä½¿ç”¨è¯¥æ‹“å±•åä¼šå‘Šè¯‰ Node è¯´â€œè¿™æ˜¯ä¸ªæ¨¡å—æ–‡ä»¶â€ã€‚ä½ ä¼šçœ‹åˆ°å¤§å®¶æ­£åœ¨è®¨è®ºæŠŠè¿™ä¸ªä½œä¸ºè§£æžç›®æ ‡ã€‚ä¸è¿‡è®¨è®ºä»åœ¨ç»§ç»­ï¼Œæ‰€ä»¥ç›®å‰ä»ä¸æ˜Žç¡® Node ç¤¾åŒºæœ€ç»ˆä¼šé‡‡ç”¨å“ªç§æ–¹å¼ã€‚ æ— è®ºæœ€ç»ˆä½¿ç”¨å“ªç§æ–¹å¼ï¼ŒåŠ è½½å™¨éƒ½ä¼šå†³å®šæ˜¯å¦æŠŠä¸€ä¸ªæ–‡ä»¶ä½œä¸ºæ¨¡å—æ¥è§£æžã€‚å¦‚æžœæ˜¯æ¨¡å—ï¼Œè€Œä¸”åŒ…å«å¯¼å…¥è¯­å¥ï¼Œé‚£å®ƒä¼šé‡æ–°å¼€å§‹å¤„ç†ç›´è‡³æ‰€æœ‰çš„æ–‡ä»¶éƒ½å·²æå–å’Œè§£æžã€‚ åˆ°è¿™é‡Œï¼Œæž„å»ºé˜¶æ®µå·®ä¸å¤šå°±å®Œæˆäº†ã€‚åœ¨åŠ è½½è¿‡ç¨‹å¤„ç†å®ŒæˆåŽï¼Œä½ å·²ç»ä»Žæœ€å¼€å§‹åªæœ‰ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œåˆ°çŽ°åœ¨å¾—åˆ°äº†ä¸€å †æ¨¡å—è®°å½•ã€‚ ä¸‹ä¸€æ­¥ä¼šå®žä¾‹åŒ–è¿™äº›æ¨¡å—å¹¶ä¸”æŠŠæ‰€æœ‰çš„å®žä¾‹é“¾æŽ¥èµ·æ¥ã€‚ å®žä¾‹åŒ–æ­£å¦‚å‰æ–‡æ‰€è¿°ï¼Œä¸€ä¸ªæ¨¡å—å®žä¾‹ç»“åˆäº†ä»£ç å’ŒçŠ¶æ€ã€‚çŠ¶æ€å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥å®žä¾‹åŒ–çš„è¿‡ç¨‹å°±æ˜¯æŠŠæ‰€æœ‰å€¼å†™å…¥å†…å­˜çš„è¿‡ç¨‹ã€‚ é¦–å…ˆï¼ŒJS å¼•æ“Žä¼šåˆ›å»ºä¸€ä¸ªÂ·æ¨¡å—çŽ¯å¢ƒè®°å½•ï¼ˆModule Environment Recordï¼‰Â·ã€‚å®ƒç®¡ç†ç€æ¨¡å—è®°å½•çš„æ‰€æœ‰å˜é‡ã€‚ç„¶åŽï¼Œå¼•æ“Žä¼šæ‰¾å‡ºå¤šæœ‰å¯¼å‡ºåœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚æ¨¡å—çŽ¯å¢ƒè®°å½•ä¼šè·Ÿè¸ªæ¯ä¸ªå¯¼å‡ºå¯¹åº”äºŽå“ªä¸ªå†…å­˜åœ°å€ã€‚ è¿™äº›å†…å­˜åœ°å€æ­¤æ—¶è¿˜æ²¡æœ‰å€¼ï¼Œåªæœ‰ç­‰åˆ°è¿è¡ŒåŽå®ƒä»¬æ‰ä¼šè¢«å¡«å……ä¸Šå®žé™…å€¼ã€‚æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œæ‰€æœ‰å¯¼å‡ºçš„å‡½æ•°å£°æ˜Žéƒ½åœ¨è¿™ä¸ªé˜¶æ®µåˆå§‹åŒ–ï¼Œè¿™ä¼šä½¿å¾—åŽé¢çš„è¿è¡Œé˜¶æ®µå˜å¾—æ›´åŠ ç®€å•ã€‚ ä¸ºäº†å®žä¾‹åŒ–æ¨¡å—å…³ç³»å›¾ï¼Œå¼•æ“Žä¼šé‡‡ç”¨æ·±åº¦ä¼˜å…ˆçš„åŽåºéåŽ†æ–¹å¼ã€‚å³ï¼Œå®ƒä¼šé¡ºç€å…³ç³»å›¾åˆ°è¾¾æœ€åº•ç«¯æ²¡æœ‰ä»»ä½•ä¾èµ–çš„æ¨¡å—ï¼Œç„¶åŽè®¾ç½®å®ƒä»¬çš„å¯¼å‡ºã€‚ æœ€ç»ˆï¼Œå¼•æ“Žä¼šæŠŠæ¨¡å—ä¸‹çš„æ‰€æœ‰ä¾èµ–å¯¼å‡ºé“¾æŽ¥åˆ°å½“å‰æ¨¡å—ã€‚ç„¶åŽå›žåˆ°ä¸Šä¸€å±‚æŠŠæ¨¡å—çš„å¯¼å…¥é“¾æŽ¥èµ·æ¥ã€‚ è¿™ä¸ªè¿‡ç¨‹è·Ÿ CJS æ˜¯ä¸åŒçš„ã€‚åœ¨ CJS ä¸­ï¼Œæ•´ä¸ªå¯¼å‡ºå¯¹è±¡åœ¨å¯¼å‡ºæ—¶éƒ½æ˜¯å€¼æ‹·è´ã€‚å³ï¼Œæ‰€æœ‰çš„å¯¼å‡ºå€¼éƒ½æ˜¯æ‹·è´å€¼ï¼Œè€Œä¸æ˜¯å¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æžœå¯¼å‡ºæ¨¡å—å†…å¯¼å‡ºçš„å€¼æ”¹å˜äº†ï¼Œå¯¼å…¥æ¨¡å—ä¸­å¯¼å…¥çš„å€¼ä¹Ÿä¸ä¼šæ”¹å˜ã€‚ ç›¸åï¼ŒESM åˆ™ä½¿ç”¨ç§°ä¸ºå®žæ—¶ç»‘å®šï¼ˆLive Bindingï¼‰çš„æ–¹å¼ã€‚å¯¼å‡ºå’Œå¯¼å…¥çš„æ¨¡å—éƒ½æŒ‡å‘ç›¸åŒçš„å†…å­˜åœ°å€ï¼ˆå³å€¼å¼•ç”¨ï¼‰ã€‚æ‰€ä»¥ï¼Œå½“å¯¼å‡ºæ¨¡å—å†…å¯¼å‡ºçš„å€¼æ”¹å˜åŽï¼Œå¯¼å…¥æ¨¡å—ä¸­çš„å€¼ä¹Ÿå®žæ—¶æ”¹å˜äº†ã€‚ æ¨¡å—å¯¼å‡ºçš„å€¼åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥èƒ½å‘ç”Ÿæ”¹å˜ï¼Œä½†æ˜¯å¯¼å…¥æ¨¡å—å´ä¸èƒ½æ”¹å˜å®ƒæ‰€å¯¼å…¥çš„å€¼ï¼Œå› ä¸ºå®ƒæ˜¯åªè¯»çš„ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æžœä¸€ä¸ªæ¨¡å—å¯¼å…¥äº†ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå®ƒåªèƒ½æ”¹å˜è¯¥å¯¹è±¡çš„å±žæ€§ï¼Œè€Œä¸èƒ½æ”¹å˜å¯¹è±¡æœ¬èº«ã€‚ ESM é‡‡ç”¨è¿™ç§å®žæ—¶ç»‘å®šçš„åŽŸå› æ˜¯ï¼Œå¼•æ“Žå¯ä»¥åœ¨ä¸è¿è¡Œä»»ä½•æ¨¡å—ä»£ç çš„æƒ…å†µä¸‹å®Œæˆé“¾æŽ¥ã€‚åŽé¢ä¼šè§£é‡Šåˆ°ï¼Œè¿™å¯¹è§£å†³è¿è¡Œé˜¶æ®µçš„å¾ªçŽ¯ä¾èµ–é—®é¢˜ä¹Ÿæ˜¯æœ‰å¸®åŠ©çš„ã€‚ å®žä¾‹åŒ–é˜¶æ®µå®ŒæˆåŽï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ‰€æœ‰æ¨¡å—å®žä¾‹ï¼Œä»¥åŠå·²å®Œæˆé“¾æŽ¥çš„å¯¼å…¥ã€å¯¼å‡ºå€¼ã€‚ çŽ°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹è¿è¡Œä»£ç å¹¶ä¸”å¾€å†…å­˜ç©ºé—´å†…å¡«å……å€¼äº†ã€‚ è¿è¡Œæœ€åŽä¸€æ­¥æ˜¯å¾€å·²ç”³è¯·å¥½çš„å†…å­˜ç©ºé—´ä¸­å¡«å…¥çœŸå®žå€¼ã€‚JS å¼•æ“Žé€šè¿‡è¿è¡Œé¡¶å±‚ä»£ç ï¼ˆå‡½æ•°å¤–çš„ä»£ç ï¼‰æ¥å®Œæˆå¡«å……ã€‚ é™¤äº†å¡«å……å€¼ä»¥å¤–ï¼Œè¿è¡Œä»£ç ä¹Ÿä¼šå¼•å‘ä¸€äº›å‰¯ä½œç”¨ï¼ˆSide Effectï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¨¡å—å¯èƒ½ä¼šå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚ å› ä¸ºè¿™äº›æ½œåœ¨å‰¯ä½œç”¨çš„å­˜åœ¨ï¼Œæ‰€ä»¥æ¨¡å—ä»£ç åªèƒ½è¿è¡Œä¸€æ¬¡ã€‚å‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œå®žä¾‹åŒ–é˜¶æ®µä¸­å‘ç”Ÿçš„é“¾æŽ¥å¯ä»¥å¤šæ¬¡è¿›è¡Œï¼Œå¹¶ä¸”æ¯æ¬¡çš„ç»“æžœéƒ½ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œå¦‚æžœè¿è¡Œé˜¶æ®µè¿›è¡Œå¤šæ¬¡çš„è¯ï¼Œåˆ™å¯èƒ½ä¼šæ¯æ¬¡éƒ½å¾—åˆ°ä¸ä¸€æ ·çš„ç»“æžœã€‚ è¿™æ­£æ˜¯ä¸ºä»€ä¹ˆä¼šä½¿ç”¨æ¨¡å—æ˜ å°„çš„åŽŸå› ä¹‹ä¸€ã€‚æ¨¡å—æ˜ å°„ä¼šä»¥ URL ä¸ºç´¢å¼•æ¥ç¼“å­˜æ¨¡å—ï¼Œä»¥ç¡®ä¿æ¯ä¸ªæ¨¡å—åªæœ‰ä¸€ä¸ªæ¨¡å—è®°å½•ã€‚è¿™ä¿è¯äº†æ¯ä¸ªæ¨¡å—åªä¼šè¿è¡Œä¸€æ¬¡ã€‚è·Ÿå®žä¾‹åŒ–ä¸€æ ·ï¼Œè¿è¡Œé˜¶æ®µä¹Ÿé‡‡ç”¨æ·±åº¦ä¼˜å…ˆçš„åŽåºéåŽ†æ–¹å¼ã€‚ é‚£å¯¹äºŽå‰é¢è°ˆåˆ°çš„å¾ªçŽ¯ä¾èµ–ä¼šæ€Žä¹ˆå¤„ç†å‘¢ï¼Ÿ å¾ªçŽ¯ä¾èµ–ä¼šä½¿å¾—ä¾èµ–å…³ç³»å›¾ä¸­å‡ºçŽ°ä¸€ä¸ªä¾èµ–çŽ¯ï¼Œå³ä½ ä¾èµ–æˆ‘ï¼Œæˆ‘ä¹Ÿä¾èµ–ä½ ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™ä¸ªçŽ¯ä¼šéžå¸¸å¤§ã€‚ä¸è¿‡ï¼Œä¸ºäº†è§£é‡Šå¥½è¿™ä¸ªé—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸¾ä¾‹ä¸€ä¸ªç®€å•çš„å¾ªçŽ¯ä¾èµ–ã€‚ é¦–å…ˆæ¥çœ‹ä¸‹è¿™ç§æƒ…å†µåœ¨ CJS ä¸­ä¼šå‘ç”Ÿä»€ä¹ˆã€‚æœ€å¼€å§‹æ—¶ï¼Œmain æ¨¡å—ä¼šè¿è¡Œ requireè¯­å¥ã€‚ç´§æŽ¥ç€ï¼Œä¼šåŽ»åŠ è½½ counter æ¨¡å—ã€‚ counter æ¨¡å—ä¼šè¯•å›¾åŽ»è®¿é—®å¯¼å‡ºå¯¹è±¡çš„ message ã€‚ä¸è¿‡ï¼Œç”±äºŽ main æ¨¡å—ä¸­è¿˜æ²¡è¿è¡Œåˆ° message å¤„ï¼Œæ‰€ä»¥æ­¤æ—¶å¾—åˆ°çš„ message ä¸º undefinedã€‚JS å¼•æ“Žä¼šä¸ºæœ¬åœ°å˜é‡åˆ†é…ç©ºé—´å¹¶æŠŠå€¼è®¾ä¸º undefined ã€‚ è¿è¡Œé˜¶æ®µç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ° counter æ¨¡å—é¡¶å±‚ä»£ç çš„æœ«å°¾å¤„ã€‚æˆ‘ä»¬æƒ³çŸ¥é“ï¼Œå½“ counter æ¨¡å—è¿è¡Œç»“æŸåŽï¼Œmessage æ˜¯å¦ä¼šå¾—åˆ°çœŸå®žå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªè¶…æ—¶å®šæ—¶å™¨ã€‚ä¹‹åŽè¿è¡Œé˜¶æ®µä¾¿è¿”å›žåˆ° main.js ä¸­ã€‚ è¿™æ—¶ï¼Œmessage å°†ä¼šè¢«åˆå§‹åŒ–å¹¶æ·»åŠ åˆ°å†…å­˜ä¸­ã€‚ä½†æ˜¯è¿™ä¸ª message ä¸Ž counter æ¨¡å—ä¸­çš„ message ä¹‹é—´å¹¶æ²¡æœ‰ä»»ä½•å…³è”å…³ç³»ï¼Œæ‰€ä»¥ counter æ¨¡å—ä¸­çš„ message ä»ç„¶ä¸º undefinedã€‚ å¦‚æžœå¯¼å‡ºå€¼é‡‡ç”¨çš„æ˜¯å®žæ—¶ç»‘å®šæ–¹å¼ï¼Œé‚£ä¹ˆ counter æ¨¡å—æœ€ç»ˆä¼šå¾—åˆ°çœŸå®žçš„ message å€¼ã€‚å½“è¶…æ—¶å®šæ—¶å™¨å¼€å§‹è®¡æ—¶æ—¶ï¼Œmain.js çš„è¿è¡Œå°±å·²ç»å®Œæˆå¹¶è®¾ç½®äº† message å€¼ã€‚ æ”¯æŒå¾ªçŽ¯ä¾èµ–æ˜¯ ESM è®¾è®¡ä¹‹åˆå°±è€ƒè™‘åˆ°çš„ä¸€å¤§åŽŸå› ã€‚ä¹Ÿæ­£æ˜¯è¿™ç§åˆ†æ®µè®¾è®¡ä½¿å…¶æˆä¸ºå¯èƒ½ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MVC,MPC,MVVMå›¾ç¤º]]></title>
    <url>%2F2018%2F05%2F05%2F%E6%9D%82%E6%96%87%2FMVC-MPC-MVVM%E5%9B%BE%E7%A4%BA%2F</url>
    <content type="text"><![CDATA[MVC,MPC,MVVMåŒºåˆ«MVCï¼ˆModel-View-Controllerï¼‰æ˜¯æœ€å¸¸è§çš„è½¯ä»¶æž¶æž„ä¹‹ä¸€ï¼Œä¸šç•Œæœ‰ç€å¹¿æ³›åº”ç”¨ã€‚å®ƒæœ¬èº«å¾ˆå®¹æ˜“ç†è§£ï¼Œä½†æ˜¯è¦è®²æ¸…æ¥šï¼Œå®ƒä¸Žè¡ç”Ÿçš„ MVP å’Œ MVVM æž¶æž„çš„åŒºåˆ«å°±ä¸å®¹æ˜“äº†ã€‚ MVCMVCæ¨¡å¼çš„æ„æ€æ˜¯ï¼Œè½¯ä»¶å¯ä»¥åˆ†æˆä¸‰ä¸ªéƒ¨åˆ† M(Model) æ•°æ®ä¿å­˜â€”å°†æ–°çš„æ•°æ®å‘é€åˆ° Viewï¼Œç”¨æˆ·å¾—åˆ°åé¦ˆ V(View) ç”¨æˆ·ç•Œé¢â€”View ä¼ é€æŒ‡ä»¤åˆ° Controller C(Controller) ä¸šåŠ¡é€»è¾‘â€”å®Œæˆä¸šåŠ¡é€»è¾‘åŽï¼Œè¦æ±‚ Model æ”¹å˜çŠ¶æ€ æ‰€æœ‰é€šä¿¡éƒ½æ˜¯å•å‘çš„ã€‚ äº’åŠ¨æ¨¡å¼ æŽ¥å—ç”¨æˆ·æŒ‡ä»¤æ—¶ï¼ŒMVC å¯ä»¥åˆ†æˆä¸¤ç§æ–¹å¼ã€‚ä¸€ç§æ˜¯é€šè¿‡ View æŽ¥å—æŒ‡ä»¤ï¼Œä¼ é€’ç»™ Controllerã€‚ å¦ä¸€ç§æ˜¯ç›´æŽ¥é€šè¿‡controlleræŽ¥å—æŒ‡ä»¤ã€‚ å®žä¾‹ï¼šBackboneå®žé™…é¡¹ç›®å¾€å¾€é‡‡ç”¨æ›´çµæ´»çš„æ–¹å¼ï¼Œä»¥ Backbone.js ä¸ºä¾‹ã€‚ ç”¨æˆ·å¯ä»¥å‘ View å‘é€æŒ‡ä»¤ï¼ˆDOM äº‹ä»¶ï¼‰ï¼Œå†ç”± View ç›´æŽ¥è¦æ±‚ Model æ”¹å˜çŠ¶æ€ã€‚ ç”¨æˆ·ä¹Ÿå¯ä»¥ç›´æŽ¥å‘ Controller å‘é€æŒ‡ä»¤ï¼ˆæ”¹å˜ URL è§¦å‘ hashChange äº‹ä»¶ï¼‰ï¼Œå†ç”± Controller å‘é€ç»™ Viewã€‚ Controller éžå¸¸è–„ï¼Œåªèµ·åˆ°è·¯ç”±çš„ä½œç”¨ï¼Œè€Œ View éžå¸¸åŽšï¼Œä¸šåŠ¡é€»è¾‘éƒ½éƒ¨ç½²åœ¨ Viewã€‚æ‰€ä»¥ï¼ŒBackbone ç´¢æ€§å–æ¶ˆäº† Controllerï¼Œåªä¿ç•™ä¸€ä¸ª Routerï¼ˆè·¯ç”±å™¨ï¼‰ã€‚ MVPMVPæ¨¡å¼æ˜¯å°†controllerå˜ä¸ºäº†presenterï¼ŒåŒæ—¶æ”¹å˜äº†é€šä¿¡çš„æ–¹å‘ å„éƒ¨åˆ†ä¹‹é—´çš„é€šä¿¡ï¼Œéƒ½æ˜¯åŒå‘çš„ã€‚ View ä¸Ž Model ä¸å‘ç”Ÿè”ç³»ï¼Œéƒ½é€šè¿‡ Presenter ä¼ é€’ã€‚ View éžå¸¸è–„ï¼Œä¸éƒ¨ç½²ä»»ä½•ä¸šåŠ¡é€»è¾‘ï¼Œç§°ä¸ºâ€è¢«åŠ¨è§†å›¾â€ï¼ˆPassive Viewï¼‰ï¼Œå³æ²¡æœ‰ä»»ä½•ä¸»åŠ¨æ€§ï¼Œè€Œ Presenteréžå¸¸åŽšï¼Œæ‰€æœ‰é€»è¾‘éƒ½éƒ¨ç½²åœ¨é‚£é‡Œã€‚ MVVMMVVM æ¨¡å¼å°† Presenter æ”¹åä¸º ViewModelï¼ŒåŸºæœ¬ä¸Šä¸Ž MVP æ¨¡å¼å®Œå…¨ä¸€è‡´ã€‚ å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œå®ƒé‡‡ç”¨åŒå‘ç»‘å®šï¼ˆdata-bindingï¼‰ï¼šViewçš„å˜åŠ¨ï¼Œè‡ªåŠ¨åæ˜ åœ¨ ViewModelï¼Œåä¹‹äº¦ç„¶ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>æ‚æ–‡</category>
      </categories>
      <tags>
        <tag>æ‚æ–‡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AjaxåŽŸç†ä¸Žå®žçŽ°]]></title>
    <url>%2F2018%2F05%2F04%2F%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0%2FAjax%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿°AJAXå…¨ç§°ä¸ºâ€œAsynchronous JavaScript and XMLâ€ï¼ˆå¼‚æ­¥JavaScriptå’ŒXMLï¼‰ï¼Œæ˜¯ä¸€ç§åˆ›å»ºäº¤äº’å¼ç½‘é¡µåº”ç”¨çš„ç½‘é¡µå¼€å‘æŠ€æœ¯ã€‚ åŽŸç†ä¸Žå®žçŽ° åŽŸç†ï¼šAjaxçš„åŽŸç†ç®€å•æ¥è¯´é€šè¿‡XmlHttpRequestå¯¹è±¡æ¥å‘æœåŠ¡å™¨å‘å¼‚æ­¥è¯·æ±‚ï¼Œä»ŽæœåŠ¡å™¨èŽ·å¾—æ•°æ®ï¼Œç„¶åŽç”¨javascriptæ¥æ“ä½œDOMè€Œæ›´æ–°é¡µé¢ã€‚ æŠŠæœåŠ¡å™¨ç«¯çœ‹æˆä¸€ä¸ªæ•°æ®æŽ¥å£(åªè´Ÿè´£åæ•°æ®)ï¼Œå®ƒè¿”å›žçš„æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æµï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæ–‡æœ¬æµå¯ä»¥æ˜¯XMLæ ¼å¼ï¼Œå¯ä»¥æ˜¯Htmlï¼Œå¯ä»¥æ˜¯Javascriptä»£ç ï¼Œä¹Ÿå¯ä»¥åªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¿™æ—¶å€™ï¼ŒXMLHttpRequestå‘æœåŠ¡å™¨ç«¯è¯·æ±‚è¿™ä¸ªé¡µé¢ï¼ŒæœåŠ¡å™¨ç«¯å°†æ–‡æœ¬çš„ç»“æžœå†™å…¥é¡µé¢ï¼Œè¿™å’Œæ™®é€šçš„webå¼€å‘æµç¨‹æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯ï¼Œå®¢æˆ·ç«¯åœ¨å¼‚æ­¥èŽ·å–è¿™ä¸ªç»“æžœåŽï¼Œä¸æ˜¯ç›´æŽ¥æ˜¾ç¤ºåœ¨é¡µé¢ï¼Œè€Œæ˜¯å…ˆç”±javascriptæ¥å¤„ç†ï¼Œç„¶åŽå†æ˜¾ç¤ºåœ¨é¡µé¢ã€‚ æ ¸å¿ƒAjaxå…¶æ ¸å¿ƒæœ‰JavaScriptã€XMLHTTPRequestã€DOMå¯¹è±¡ç»„æˆï¼ŒXMLHttpRequestæ˜¯ajaxçš„æ ¸å¿ƒæœºåˆ¶ï¼Œæ˜¯JavaScriptçš„ä¸€ä¸ªå†…ç½®å¯¹è±¡ã€‚å®ƒæ˜¯åœ¨IE5ä¸­é¦–å…ˆå¼•å…¥çš„ï¼Œæ˜¯ä¸€ç§æ”¯æŒå¼‚æ­¥è¯·æ±‚çš„æŠ€æœ¯ã€‚ç®€å•çš„è¯´ï¼Œä¹Ÿå°±æ˜¯javascriptå¯ä»¥åŠæ—¶å‘æœåŠ¡å™¨æå‡ºè¯·æ±‚å’Œå¤„ç†å“åº”ï¼Œè€Œä¸é˜»å¡žç”¨æˆ·ã€‚è¾¾åˆ°æ— åˆ·æ–°çš„æ•ˆæžœã€‚ XMLHTTPRequestå¯¹è±¡Ajaxçš„ä¸€ä¸ªæœ€å¤§çš„ç‰¹ç‚¹æ˜¯æ— éœ€åˆ·æ–°é¡µé¢ä¾¿å¯å‘æœåŠ¡å™¨ä¼ è¾“æˆ–è¯»å†™æ•°æ®(åˆç§°æ— åˆ·æ–°æ›´æ–°é¡µé¢),è¿™ä¸€ç‰¹ç‚¹ä¸»è¦å¾—ç›ŠäºŽXMLHTTPç»„ä»¶XMLHTTPRequestå¯¹è±¡ã€‚XMLHttpRequest å¯¹è±¡æ–¹æ³•æè¿°Ajaxå¼•æ“Žï¼Œå®žé™…ä¸Šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„JavaScriptåº”ç”¨ç¨‹åºï¼Œç”¨æ¥å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œè¯»å†™æœåŠ¡å™¨å’Œæ›´æ”¹DOMå†…å®¹ã€‚JavaScriptçš„Ajaxå¼•æ“Žè¯»å–ä¿¡æ¯ï¼Œå¹¶ä¸”äº’åŠ¨åœ°é‡å†™DOMï¼Œè¿™ä½¿ç½‘é¡µèƒ½æ— ç¼åŒ–é‡æž„ï¼Œä¹Ÿå°±æ˜¯åœ¨é¡µé¢å·²ç»ä¸‹è½½å®Œæ¯•åŽæ”¹å˜é¡µé¢å†…å®¹ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸€ç›´åœ¨é€šè¿‡JavaScriptå’ŒDOMåœ¨å¹¿æ³›ä½¿ç”¨çš„æ–¹æ³•ï¼Œä½†è¦ä½¿ç½‘é¡µçœŸæ­£åŠ¨æ€èµ·æ¥ï¼Œä¸ä»…è¦å†…éƒ¨çš„äº’åŠ¨ï¼Œè¿˜éœ€è¦ä»Žå¤–éƒ¨èŽ·å–æ•°æ®ï¼Œåœ¨ä»¥å‰ï¼Œæˆ‘ä»¬æ˜¯è®©ç”¨æˆ·æ¥è¾“å…¥æ•°æ®å¹¶é€šè¿‡DOMæ¥æ”¹å˜ç½‘é¡µå†…å®¹çš„ï¼Œä½†çŽ°åœ¨ï¼ŒXMLHTTPRequestï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸é‡è½½é¡µé¢çš„æƒ…å†µä¸‹è¯»å†™æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼Œä½¿ç”¨æˆ·çš„è¾“å…¥è¾¾åˆ°æœ€å°‘ã€‚ Ajaxä½¿WEBä¸­çš„ç•Œé¢ä¸Žåº”ç”¨åˆ†ç¦»ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯æ•°æ®ä¸Žå‘ˆçŽ°åˆ†ç¦»ï¼‰ï¼Œè€Œåœ¨ä»¥å‰ä¸¤è€…æ˜¯æ²¡æœ‰æ¸…æ™°çš„ç•Œé™çš„ï¼Œæ•°æ®ä¸Žå‘ˆçŽ°åˆ†ç¦»çš„åˆ†ç¦»ï¼Œæœ‰åˆ©äºŽåˆ†å·¥åˆä½œã€å‡å°‘éžæŠ€æœ¯äººå‘˜å¯¹é¡µé¢çš„ä¿®æ”¹é€ æˆçš„WEBåº”ç”¨ç¨‹åºé”™è¯¯ã€æé«˜æ•ˆçŽ‡ã€ä¹Ÿæ›´åŠ é€‚ç”¨äºŽçŽ°åœ¨çš„å‘å¸ƒç³»ç»Ÿã€‚ä¹Ÿå¯ä»¥æŠŠä»¥å‰çš„ä¸€äº›æœåŠ¡å™¨è´Ÿæ‹…çš„å·¥ä½œè½¬å«åˆ°å®¢æˆ·ç«¯ï¼Œåˆ©äºŽå®¢æˆ·ç«¯é—²ç½®çš„å¤„ç†èƒ½åŠ›æ¥å¤„ç†ã€‚ ä¼˜ç‚¹ä¸Žç¼ºç‚¹ä¼˜ç‚¹ æ— éœ€åˆ·æ–°é¡µé¢æ›´æ–°æ•°æ® ç•Œé¢ä¸Žåº”ç”¨åˆ†ç¦»ï¼ˆå‘ˆçŽ°ä¸Žæ•°æ®åˆ†ç¦»ï¼‰ åŸºäºŽè§„èŒƒå¹¿æ³›ä½¿ç”¨ å¼‚æ­¥ä¸ŽæœåŠ¡å™¨é€šä¿¡ å‰åŽç«¯è´Ÿè½½å¹³è¡¡ ç¼ºç‚¹ ç ´åäº†æµè§ˆå™¨çš„backå’ŒhistoryåŠŸèƒ½ æœç´¢å¼•æ“Žçš„æ”¯æŒè¾ƒå¼± ajaxçš„å®‰å…¨é—®é¢˜ï¼ˆè·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ï¼ŒSQLæ³¨å…¥æ”»å‡»ç­‰ç­‰ï¼‰ Ajaxä¸èƒ½å¾ˆå¥½åœ°æ”¯æŒç§»åŠ¨ç«¯ ç ´åç¨‹åºçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ å®¢æˆ·ç«¯è¿‡è‚¥ï¼Œå®¹æ˜“é€ æˆå®¢æˆ·ç«¯çš„å¼€å‘æˆæœ¬ AJAXæ³¨æ„ç‚¹åŠé€‚ç”¨å’Œä¸é€‚ç”¨åœºæ™¯æ³¨æ„ç‚¹Ajaxå¼€å‘æ—¶ï¼Œç½‘ç»œå»¶è¿Ÿâ€”â€”å³ç”¨æˆ·å‘å‡ºè¯·æ±‚åˆ°æœåŠ¡å™¨å‘å‡ºå“åº”ä¹‹é—´çš„é—´éš”â€”â€”éœ€è¦æ…Žé‡è€ƒè™‘ã€‚ä¸ç»™äºˆç”¨æˆ·æ˜Žç¡®çš„å›žåº”ï¼Œæ²¡æœ‰æ°å½“çš„é¢„è¯»æ•°æ®ï¼Œæˆ–è€…å¯¹XMLHttpRequestçš„ä¸æ°å½“å¤„ç†ï¼Œéƒ½ä¼šä½¿ç”¨æˆ·æ„Ÿåˆ°å»¶è¿Ÿï¼Œè¿™æ˜¯ç”¨æˆ·ä¸å¸Œæœ›çœ‹åˆ°çš„ï¼Œä¹Ÿæ˜¯ä»–ä»¬æ— æ³•ç†è§£çš„ã€‚é€šå¸¸çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œä½¿ç”¨ä¸€ä¸ªå¯è§†åŒ–çš„ç»„ä»¶æ¥å‘Šè¯‰ç”¨æˆ·ç³»ç»Ÿæ­£åœ¨è¿›è¡ŒåŽå°æ“ä½œå¹¶ä¸”æ­£åœ¨è¯»å–æ•°æ®å’Œå†…å®¹ã€‚ Ajaxé€‚ç”¨åœºæ™¯ è¡¨å•é©±åŠ¨çš„äº¤äº’ æ·±å±‚æ¬¡çš„æ ‘çš„å¯¼èˆª å¿«é€Ÿçš„ç”¨æˆ·ä¸Žç”¨æˆ·é—´çš„äº¤æµå“åº” ç±»ä¼¼æŠ•ç¥¨ã€yes/noç­‰æ— å…³ç—›ç—’çš„åœºæ™¯ å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤å’Œæ“çºµç›¸å…³æ•°æ®çš„åœºæ™¯ æ™®é€šçš„æ–‡æœ¬è¾“å…¥æç¤ºå’Œè‡ªåŠ¨å®Œæˆçš„åœºæ™¯ Ajaxä¸é€‚ç”¨åœºæ™¯ éƒ¨åˆ†ç®€å•çš„è¡¨å• æœç´¢ åŸºæœ¬çš„å¯¼èˆª æ›¿æ¢å¤§é‡çš„æ–‡æœ¬ å¯¹å‘ˆçŽ°çš„æ“çºµ]]></content>
      <categories>
        <category>åŽŸç†ä¸Žå®žçŽ°</category>
      </categories>
      <tags>
        <tag>Ajax</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Jsonpçš„åŽŸç†ä¸Žå®žçŽ°]]></title>
    <url>%2F2018%2F05%2F03%2F%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0%2FJsonp%E7%9A%84%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿°Jsonpæ˜¯ä¸€ç§è·¨åŸŸé€šä¿¡çš„æ‰‹æ®µï¼Œå®ƒçš„åŽŸç†å®žçŽ°å¾ˆç®€å•ï¼š 1.é¦–å…ˆåˆ©ç”¨scriptæ ‡ç­¾çš„srcå±žæ€§æ¥å®žçŽ°è·¨åŸŸ 2.é€šè¿‡å°†å‰ç«¯æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ ç»™æœåŠ¡å™¨ç«¯ï¼Œç”±æœåŠ¡å™¨ç«¯æ³¨å…¥å‚æ•°ä¹‹åŽå†è¿”å›žï¼Œå®žçŽ°æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯é€šä¿¡ 3.ç”±äºŽä½¿ç”¨scriptçš„srcå±žæ€§ï¼Œæ‰€ä»¥åªæ”¯æŒgetæ–¹æ³• å®žçŽ°æµç¨‹1.è®¾å®šä¸€ä¸ªscriptæ ‡ç­¾ 1&lt;script src="http://jsonp.js?callback=xxx"&gt;&lt;/script&gt; 2.callbackå®šä¹‰äº†ä¸€ä¸ªå‡½æ•°åï¼Œè€Œè¿œç¨‹æœåŠ¡ç«¯é€šè¿‡è°ƒç”¨æŒ‡å®šçš„å‡½æ•°å¹¶ä¼ å…¥å‚æ•°å®žçŽ°å‚æ•°ä¼ é€’ï¼Œå°†fn(response)ä¼ é€’å›žå®¢æˆ·ç«¯ 12$callback = !empty($_GET['callback']) ? $_GET['callback']: 'callback';echo $callback.'(.json_encode($data))'; 3.å®¢æˆ·ç«¯æŽ¥æ”¶åˆ°è¿”å›žçš„jsè„šæœ¬ï¼Œå¼€å§‹è§£æžå’Œæ‰§è¡Œfn(response) jsonpçš„ç®€å•å®žçŽ°ä¸€ä¸ªç®€å•çš„jsonpå®žçŽ°ï¼Œå…¶å®žå°±æ˜¯æ‹¼æŽ¥urlå­—ç¬¦ä¸²ï¼ŒåŠ¨æ€çš„æ·»åŠ åˆ°scriptå…ƒç´ çš„å¤´éƒ¨ 123456function jsonp(req)&#123; var script = document.createElement('script'); var url = req.url + '?callback=' + req.callback.name; script.src = url; document.getElementsByTagName('head')[0].appendChild('script');&#125; å‰ç«¯jsç¤ºä¾‹ 1234567function hello(res)&#123; alert('hello' + res.data);&#125;jsonp(&#123; url:'', callback: hello&#125;) æœåŠ¡å™¨ç«¯ä»£ç  123456789101112131415161718var http = requrie('http');var urllib = require('url');var port = 8080;var data = &#123;'data':'world'&#125;;http.createServer(function(req,res)&#123; var params = urllib.parse(req.url,true); if(params.query.callback)&#123; console.log(params.query.callback); //jsonp var str = params.query.callback + '(' + JSON.stringify(data) + ')'; res.end(str); &#125; else &#123; res.end(); &#125;&#125;).listen(port,function()&#123; console.log('jsonp server is on');&#125;); ç„¶è€Œï¼Œè¿™ä¸ªå®žçŽ°è™½ç„¶ç®€å•ï¼Œä½†æœ‰ä¸€äº›ä¸è¶³çš„åœ°æ–¹ï¼š 1.æˆ‘ä»¬ä¼ é€’çš„å›žè°ƒå¿…é¡»æ˜¯ä¸€ä¸ªå…¨å±€æ–¹æ³•ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“è¦å°½é‡å‡å°‘å…¨å±€çš„æ–¹æ³•ã€‚2.éœ€è¦åŠ å…¥ä¸€äº›å‚æ•°æ ¡éªŒï¼Œç¡®ä¿æŽ¥å£å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚ å¯é çš„jsonpå®žçŽ°jsonpéƒ¨åˆ†æºç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546(function (global) &#123; var id = 0, container = document.getElementsByTagName("head")[0]; function jsonp(options) &#123; if(!options || !options.url) return; var scriptNode = document.createElement("script"), data = options.data || &#123;&#125;, url = options.url, callback = options.callback, fnName = "jsonp" + id++; // æ·»åŠ å›žè°ƒå‡½æ•° data["callback"] = fnName; // æ‹¼æŽ¥url var params = []; for (var key in data) &#123; params.push(encodeURIComponent(key) + "=" + encodeURIComponent(data[key])); &#125; url = url.indexOf("?") &gt; 0 ? (url + "&amp;") : (url + "?"); url += params.join("&amp;"); scriptNode.src = url; // ä¼ é€’çš„æ˜¯ä¸€ä¸ªåŒ¿åçš„å›žè°ƒå‡½æ•°ï¼Œè¦æ‰§è¡Œçš„è¯ï¼Œæš´éœ²ä¸ºä¸€ä¸ªå…¨å±€æ–¹æ³• global[fnName] = function (ret) &#123; callback &amp;&amp; callback(ret); container.removeChild(scriptNode); delete global[fnName]; &#125; // å‡ºé”™å¤„ç† scriptNode.onerror = function () &#123; callback &amp;&amp; callback(&#123;error:"error"&#125;); container.removeChild(scriptNode); global[fnName] &amp;&amp; delete global[fnName]; &#125; scriptNode.type = "text/javascript"; container.appendChild(scriptNode) &#125; global.jsonp = jsonp;&#125;)(this); ä½¿ç”¨ç¤ºä¾‹ 1234567jsonp(&#123; url: 'www.example.com', data: &#123;id :1&#125;, callback: function(ret)&#123; console.log(ret) &#125;&#125;) JSONPçš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ å®ƒä¸åƒXMLHttpRequestå¯¹è±¡å®žçŽ°çš„Ajaxè¯·æ±‚é‚£æ ·å—åˆ°åŒæºç­–ç•¥çš„é™åˆ¶ï¼ŒJSONPå¯ä»¥è·¨è¶ŠåŒæºç­–ç•¥ï¼› å®ƒçš„å…¼å®¹æ€§æ›´å¥½ï¼Œåœ¨æ›´åŠ å¤è€çš„æµè§ˆå™¨ä¸­éƒ½å¯ä»¥è¿è¡Œï¼Œä¸éœ€è¦XMLHttpRequestæˆ–ActiveXçš„æ”¯æŒ åœ¨è¯·æ±‚å®Œæ¯•åŽå¯ä»¥é€šè¿‡è°ƒç”¨callbackçš„æ–¹å¼å›žä¼ ç»“æžœã€‚å°†å›žè°ƒæ–¹æ³•çš„æƒé™ç»™äº†è°ƒç”¨æ–¹ã€‚è¿™ä¸ªå°±ç›¸å½“äºŽå°†controllerå±‚å’Œviewå±‚ç»ˆäºŽåˆ† å¼€äº†ã€‚æˆ‘æä¾›çš„jsonpæœåŠ¡åªæä¾›çº¯æœåŠ¡çš„æ•°æ®ï¼Œè‡³äºŽæä¾›æœåŠ¡ä»¥ åŽçš„é¡µé¢æ¸²æŸ“å’ŒåŽç»­viewæ“ä½œéƒ½ç”±è°ƒç”¨è€…æ¥è‡ªå·±å®šä¹‰å°±å¥½äº†ã€‚å¦‚æžœæœ‰ä¸¤ä¸ªé¡µé¢éœ€è¦æ¸²æŸ“åŒä¸€ä»½æ•°æ®ï¼Œä½ ä»¬åªéœ€è¦æœ‰ä¸åŒçš„æ¸²æŸ“é€»è¾‘å°±å¯ä»¥äº†ï¼Œé€»è¾‘éƒ½å¯ä»¥ä½¿ç”¨åŒ ä¸€ä¸ªjsonpæœåŠ¡ã€‚ ç¼ºç‚¹ å®ƒåªæ”¯æŒGETè¯·æ±‚è€Œä¸æ”¯æŒPOSTç­‰å…¶å®ƒç±»åž‹çš„HTTPè¯·æ±‚ å®ƒåªæ”¯æŒè·¨åŸŸHTTPè¯·æ±‚è¿™ç§æƒ…å†µï¼Œä¸èƒ½è§£å†³ä¸åŒåŸŸçš„ä¸¤ä¸ªé¡µé¢ä¹‹é—´å¦‚ä½•è¿›è¡ŒJavaScriptè°ƒç”¨çš„é—®é¢˜ã€‚ jsonpåœ¨è°ƒç”¨å¤±è´¥çš„æ—¶å€™ä¸ä¼šè¿”å›žå„ç§HTTPçŠ¶æ€ç ã€‚ ç¼ºç‚¹æ˜¯å®‰å…¨æ€§ã€‚ä¸‡ä¸€å‡å¦‚æä¾›jsonpçš„æœåŠ¡å­˜åœ¨é¡µé¢æ³¨å…¥æ¼æ´žï¼Œå³å®ƒè¿”å›žçš„javascriptçš„å†…å®¹è¢«äººæŽ§åˆ¶çš„ã€‚é‚£ä¹ˆç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿæ‰€æœ‰è°ƒç”¨è¿™ä¸ª jsonpçš„ç½‘ç«™éƒ½ä¼šå­˜åœ¨æ¼æ´žã€‚äºŽæ˜¯æ— æ³•æŠŠå±é™©æŽ§åˆ¶åœ¨ä¸€ä¸ªåŸŸåä¸‹â€¦æ‰€ä»¥åœ¨ä½¿ç”¨jsonpçš„æ—¶å€™å¿…é¡»è¦ä¿è¯ä½¿ç”¨çš„jsonpæœåŠ¡å¿…é¡»æ˜¯å®‰å…¨å¯ä¿¡çš„ å®‰å…¨é˜²èŒƒ é˜²æ­¢callbackå‚æ•°æ„å¤–æˆªæ–­jsä»£ç ,ç‰¹æ®Šå­—ç¬¦å•å¼•å·åŒå¼•å·,æ¢è¡Œç¬¦å­˜åœ¨é£Žé™©. é˜²æ­¢callbackå‚æ•°æ¶æ„æ·»åŠ scriptæ ‡ç­¾,é€ æˆxssæ¼æ´ž é˜²æ­¢è·¨åŸŸè¯·æ±‚æ»¥ç”¨,é˜»æ­¢éžæ³•ç«™ç‚¹æ¶æ„è°ƒç”¨]]></content>
      <categories>
        <category>åŽŸç†ä¸Žå®žçŽ°</category>
      </categories>
      <tags>
        <tag>jsonp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹]]></title>
    <url>%2F2018%2F05%2F02%2Fstudy%2F%E4%BB%80%E4%B9%88%E6%98%AF%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[Functional programmingä½ å¯èƒ½å¬è¯´è¿‡å‡½æ•°å¼ç¼–ç¨‹ï¼ˆFunctional programmingï¼‰ï¼Œç”šè‡³å·²ç»ä½¿ç”¨äº†ä¸€æ®µæ—¶é—´ã€‚ ä½†æ˜¯ï¼Œä½ èƒ½è¯´æ¸…æ¥šï¼Œå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆå— ç½‘ä¸Šæœç´¢ä¸€ä¸‹ï¼Œä½ ä¼šè½»æ¾æ‰¾åˆ°å¥½å¤šç­”æ¡ˆã€‚ ä¸Žé¢å‘å¯¹è±¡ç¼–ç¨‹å’Œè¿‡ç¨‹å¼ç¼–ç¨‹å¹¶åˆ—çš„ç¼–ç¨‹èŒƒå¼ä¸»è¦çš„ç‰¹å¾ï¼šå‡½æ•°æ˜¯ç¬¬ä¸€ç­‰å…¬æ°‘å¼ºè°ƒå°†è®¡ç®—è¿‡ç¨‹åˆ†è§£æˆå¯å¤ç”¨çš„å‡½æ•°ï¼Œå…¸åž‹çš„ä¾‹å­å°±æ˜¯mapå‡½æ•°å’Œreduceå‡½æ•°ç»„æˆçš„MapReduceå‡½æ•°åªæœ‰çº¯å‡½æ•°ï¼Œæ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°ï¼Œæ‰è¢«ç§°ä¸ºå‡½æ•° ä¸Šé¢è¿™äº›è¯´æ³•éƒ½å¯¹ï¼Œä½†è¿˜ä¸å¤Ÿï¼Œéƒ½æ²¡æœ‰å›žç­”ä¸‹é¢è¿™ä¸ªæ›´æ·±å±‚çš„é—®é¢˜ã€‚ ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ èŒƒç•´è®ºå‡½æ•°å¼ç¼–ç¨‹çš„èµ·æºï¼Œæ˜¯ä¸€é—¨å«åšèŒƒç•´è®ºï¼ˆCategory Theoryï¼‰çš„æ•°å­¦åˆ†æ”¯ ç†è§£å‡½æ•°å¼ç¼–ç¨‹çš„å…³é”®ï¼Œå°±æ˜¯ç†è§£èŒƒç•´è®ºã€‚å®ƒæ˜¯ä¸€é—¨å¾ˆå¤æ‚çš„æ•°å­¦ï¼Œè®¤ä¸ºä¸–ç•Œä¸Šæ‰€æœ‰çš„æ¦‚å¿µä½“ç³»ï¼Œéƒ½å¯ä»¥æŠ½è±¡æˆä¸€ä¸ªä¸ªçš„â€èŒƒç•´â€ï¼ˆcategoryï¼‰ã€‚ èŒƒç•´çš„æ¦‚å¿µä»€ä¹ˆæ˜¯èŒƒç•´å‘¢ï¼Ÿ ç»´åŸºç™¾ç§‘çš„ä¸€å¥è¯å®šä¹‰å¦‚ä¸‹ã€‚ â€œèŒƒç•´å°±æ˜¯ä½¿ç”¨ç®­å¤´è¿žæŽ¥çš„ç‰©ä½“ã€‚â€ï¼ˆIn mathematics, a category is an algebraic structure that comprises â€œobjectsâ€ that are linked by â€œarrowsâ€. ï¼‰ ä¹Ÿå°±æ˜¯è¯´ï¼Œå½¼æ­¤ä¹‹é—´å­˜åœ¨æŸç§å…³ç³»çš„æ¦‚å¿µã€äº‹ç‰©ã€å¯¹è±¡ç­‰ç­‰ï¼Œéƒ½æž„æˆâ€èŒƒç•´â€ã€‚éšä¾¿ä»€ä¹ˆä¸œè¥¿ï¼Œåªè¦èƒ½æ‰¾å‡ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå°±èƒ½å®šä¹‰ä¸€ä¸ªâ€èŒƒç•´â€ã€‚ ä¸Šå›¾ä¸­ï¼Œå„ä¸ªç‚¹ä¸Žå®ƒä»¬ä¹‹é—´çš„ç®­å¤´ï¼Œå°±æž„æˆä¸€ä¸ªèŒƒç•´ã€‚ ç®­å¤´è¡¨ç¤ºèŒƒç•´æˆå‘˜ä¹‹é—´çš„å…³ç³»ï¼Œæ­£å¼çš„åç§°å«åš&quot;æ€å°„&quot;ï¼ˆmorphismï¼‰ã€‚èŒƒç•´è®ºè®¤ä¸ºï¼ŒåŒä¸€ä¸ªèŒƒç•´çš„æ‰€æœ‰æˆå‘˜ï¼Œå°±æ˜¯ä¸åŒçŠ¶æ€çš„&quot;å˜å½¢&quot;ï¼ˆtransformationï¼‰ã€‚é€šè¿‡&quot;æ€å°„&quot;ï¼Œä¸€ä¸ªæˆå‘˜å¯ä»¥å˜å½¢æˆå¦ä¸€ä¸ªæˆå‘˜ã€‚ æ•°å­¦æ¨¡åž‹æ—¢ç„¶â€èŒƒç•´â€æ˜¯æ»¡è¶³æŸç§å˜å½¢å…³ç³»çš„æ‰€æœ‰å¯¹è±¡ï¼Œå°±å¯ä»¥æ€»ç»“å‡ºå®ƒçš„æ•°å­¦æ¨¡åž‹ã€‚ æ‰€æœ‰æˆå‘˜æ˜¯ä¸€ä¸ªé›†åˆ å˜å½¢å…³ç³»æ˜¯å‡½æ•° ä¹Ÿå°±æ˜¯è¯´ï¼ŒèŒƒç•´è®ºæ˜¯é›†åˆè®ºæ›´ä¸Šå±‚çš„æŠ½è±¡ï¼Œç®€å•çš„ç†è§£å°±æ˜¯â€é›†åˆ + å‡½æ•°â€ã€‚ ç†è®ºä¸Šé€šè¿‡å‡½æ•°ï¼Œå°±å¯ä»¥ä»ŽèŒƒç•´çš„ä¸€ä¸ªæˆå‘˜ï¼Œç®—å‡ºå…¶ä»–æ‰€æœ‰æˆå‘˜ã€‚ èŒƒç•´ä¸Žå®¹å™¨ æˆ‘ä»¬å¯ä»¥æŠŠâ€èŒƒç•´â€æƒ³è±¡æˆæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢åŒ…å«ä¸¤æ ·ä¸œè¥¿ã€‚ å€¼ï¼ˆvalueï¼‰ å€¼çš„å˜å½¢å…³ç³»ï¼Œä¹Ÿå°±æ˜¯å‡½æ•°ã€‚ ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ä»£ç ï¼Œå®šä¹‰ä¸€ä¸ªç®€å•çš„èŒƒç•´ã€‚ 123456789class Category&#123; constructor(val)&#123; this.val = val; &#125; addOne(x)&#123; return x +1; &#125;&#125; ä¸Šé¢ä»£ç ä¸­ï¼ŒCategoryæ˜¯ä¸€ä¸ªç±»ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªå€¼ï¼ˆthis.valï¼‰å’Œä¸€ç§å˜å½¢å…³ç³»ï¼ˆaddOneï¼‰ã€‚ä½ å¯èƒ½å·²ç»çœ‹å‡ºæ¥äº†ï¼Œè¿™é‡Œçš„èŒƒç•´ï¼Œå°±æ˜¯æ‰€æœ‰å½¼æ­¤ä¹‹é—´ç›¸å·®1çš„æ•°å­—ã€‚ æ³¨æ„ï¼Œæœ¬æ–‡åŽé¢çš„éƒ¨åˆ†ï¼Œå‡¡æ˜¯æåˆ°â€å®¹å™¨â€çš„åœ°æ–¹ï¼Œå…¨éƒ¨éƒ½æ˜¯æŒ‡â€èŒƒç•´â€ã€‚ èŒƒç•´è®ºä¸Žå‡½æ•°ç¼–ç¨‹å¼çš„å…³ç³»èŒƒç•´è®ºä½¿ç”¨å‡½æ•°ï¼Œè¡¨è¾¾èŒƒç•´ä¹‹é—´çš„å…³ç³»æœ¬è´¨ä¸Šï¼Œå‡½æ•°å¼ç¼–ç¨‹åªæ˜¯èŒƒç•´è®ºçš„è¿ç®—æ–¹æ³•ï¼Œè·Ÿæ•°ç†é€»è¾‘ã€å¾®ç§¯åˆ†ã€è¡Œåˆ—å¼æ˜¯åŒä¸€ç±»ä¸œè¥¿ï¼Œéƒ½æ˜¯æ•°å­¦æ–¹æ³•ï¼Œåªæ˜¯ç¢°å·§å®ƒèƒ½ç”¨æ¥å†™ç¨‹åºã€‚æ‰€ä»¥ï¼Œä½ æ˜Žç™½äº†å—ï¼Œä¸ºä»€ä¹ˆå‡½æ•°å¼ç¼–ç¨‹è¦æ±‚å‡½æ•°å¿…é¡»æ˜¯çº¯çš„ï¼Œä¸èƒ½æœ‰å‰¯ä½œç”¨ï¼Ÿå› ä¸ºå®ƒæ˜¯ä¸€ç§æ•°å­¦è¿ç®—ï¼ŒåŽŸå§‹ç›®çš„å°±æ˜¯æ±‚å€¼ï¼Œä¸åšå…¶ä»–äº‹æƒ…ï¼Œå¦åˆ™å°±æ— æ³•æ»¡è¶³å‡½æ•°è¿ç®—æ³•åˆ™äº†ï¼Œæ€»ä¹‹ï¼Œåœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œå‡½æ•°å°±æ˜¯ä¸€ä¸ªç®¡é“ï¼ˆpipeï¼‰ã€‚è¿™å¤´è¿›åŽ»ä¸€ä¸ªå€¼ï¼Œé‚£å¤´å°±ä¼šå‡ºæ¥ä¸€ä¸ªæ–°çš„å€¼ï¼Œæ²¡æœ‰å…¶ä»–ä½œç”¨ã€‚ å‡½æ•°çš„åˆæˆä¸ŽæŸ¯é‡ŒåŒ–å‡½æ•°å¼ç¼–ç¨‹æœ‰ä¸¤ä¸ªæœ€åŸºæœ¬çš„è¿ç®—: åˆæˆä¸ŽæŸ¯é‡ŒåŒ– å‡½æ•°çš„åˆæˆå¦‚æžœä¸€ä¸ªå€¼è¦ç»è¿‡å¤šä¸ªå‡½æ•°ï¼Œæ‰èƒ½å˜æˆå¦å¤–ä¸€ä¸ªå€¼ï¼Œå°±å¯ä»¥æŠŠæ‰€æœ‰ä¸­é—´æ­¥éª¤åˆå¹¶æˆä¸€ä¸ªå‡½æ•°ï¼Œè¿™å«åš&quot;å‡½æ•°çš„åˆæˆ&quot;ï¼ˆcomposeï¼‰ã€‚ ä¸Šå›¾ä¸­ï¼ŒXå’ŒYä¹‹é—´çš„å˜å½¢å…³ç³»æ˜¯å‡½æ•°fï¼ŒYå’ŒZä¹‹é—´çš„å˜å½¢å…³ç³»æ˜¯å‡½æ•°gï¼Œé‚£ä¹ˆXå’ŒZä¹‹é—´çš„å…³ç³»ï¼Œå°±æ˜¯gå’Œfçš„åˆæˆå‡½æ•°gÂ·fã€‚ åˆæˆä¸¤ä¸ªå‡½æ•°çš„ç®€å•ä»£ç å¦‚ä¸‹ã€‚ 12345const compose = function(f,g)&#123; return function(x)&#123; return f(g(x)); &#125;&#125; å‡½æ•°çš„åˆæˆè¿˜å¿…é¡»æ»¡è¶³ç»“åˆå¾‹ã€‚ 12345compose(f, compose(g, h))// ç­‰åŒäºŽcompose(compose(f, g), h)// ç­‰åŒäºŽcompose(f, g, h) åˆæˆä¹Ÿæ˜¯å‡½æ•°å¿…é¡»æ˜¯çº¯çš„ä¸€ä¸ªåŽŸå› ã€‚å› ä¸ºä¸€ä¸ªä¸çº¯çš„å‡½æ•°ï¼Œæ€Žä¹ˆè·Ÿå…¶ä»–å‡½æ•°åˆæˆï¼Ÿæ€Žä¹ˆä¿è¯å„ç§åˆæˆä»¥åŽï¼Œå®ƒä¼šè¾¾åˆ°é¢„æœŸçš„è¡Œä¸ºï¼Ÿ å‰é¢è¯´è¿‡ï¼Œå‡½æ•°å°±åƒæ•°æ®çš„ç®¡é“ï¼ˆpipeï¼‰ã€‚é‚£ä¹ˆï¼Œå‡½æ•°åˆæˆå°±æ˜¯å°†è¿™äº›ç®¡é“è¿žäº†èµ·æ¥ï¼Œè®©æ•°æ®ä¸€å£æ°”ä»Žå¤šä¸ªç®¡é“ä¸­ç©¿è¿‡ã€‚ æŸ¯é‡ŒåŒ–f(x)å’Œg(x)åˆæˆä¸ºf(g(x))ï¼Œæœ‰ä¸€ä¸ªéšè—çš„å‰æï¼Œå°±æ˜¯få’Œgéƒ½åªèƒ½æŽ¥å—ä¸€ä¸ªå‚æ•°ã€‚å¦‚æžœå¯ä»¥æŽ¥å—å¤šä¸ªå‚æ•°ï¼Œæ¯”å¦‚f(x, y)å’Œg(a, b, c)ï¼Œå‡½æ•°åˆæˆå°±éžå¸¸éº»çƒ¦ã€‚ è¿™æ—¶å€™å°±éœ€è¦æŸ¯é‡ŒåŒ–ï¼Œæ‰€è°“â€œæŸ¯é‡ŒåŒ–â€å°±æ˜¯æŠŠä¸€ä¸ªå¤šå‚æ•°çš„å‡½æ•°ï¼Œè½¬åŒ–ä¸ºå•å‚æ•°çš„å‡½æ•° 1234567891011121314// æŸ¯é‡ŒåŒ–ä¹‹å‰function(x,y)&#123; return x + y;&#125;add (1,2) // 3// æŸ¯é‡ŒåŒ–ä¹‹åŽfunction(y)&#123; return function(x)&#123; return x + y; &#125;&#125;add(2)(1); // 3 æœ‰äº†æŸ¯é‡ŒåŒ–ä»¥åŽï¼Œæˆ‘ä»¬å°±èƒ½åšåˆ°ï¼Œæ‰€æœ‰å‡½æ•°åªæŽ¥å—ä¸€ä¸ªå‚æ•°ã€‚åŽæ–‡çš„å†…å®¹é™¤éžå¦æœ‰è¯´æ˜Žï¼Œéƒ½é»˜è®¤å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯æ‰€è¦å¤„ç†çš„é‚£ä¸ªå€¼ã€‚ å‡½å­ï¼ˆfunctorï¼‰å‡½æ•°ä¸ä»…å¯ä»¥ç”¨äºŽåŒä¸€ä¸ªèŒƒç•´ä¹‹ä¸­å€¼çš„è½¬æ¢ï¼Œè¿˜å¯ä»¥ç”¨äºŽå°†ä¸€ä¸ªèŒƒç•´è½¬æˆå¦ä¸€ä¸ªèŒƒç•´ã€‚è¿™å°±æ¶‰åŠåˆ°äº†å‡½å­ï¼ˆFunctorï¼‰ã€‚ å‡½å­çš„æ¦‚å¿µå‡½å­æ˜¯å‡½æ•°å¼ç¼–ç¨‹é‡Œé¢æœ€é‡è¦çš„æ•°æ®ç±»åž‹ï¼Œä¹Ÿæ˜¯åŸºæœ¬çš„è¿ç®—å•ä½å’ŒåŠŸèƒ½å•ä½ã€‚ å®ƒé¦–å…ˆæ˜¯ä¸€ç§èŒƒç•´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯ä¸€ä¸ªå®¹å™¨ï¼ŒåŒ…å«äº†å€¼å’Œå˜å½¢å…³ç³»ã€‚æ¯”è¾ƒç‰¹æ®Šçš„æ˜¯ï¼Œå®ƒçš„å˜å½¢å…³ç³»å¯ä»¥ä¾æ¬¡ä½œç”¨äºŽæ¯ä¸€ä¸ªå€¼ï¼Œå°†å½“å‰å®¹å™¨å˜å½¢æˆå¦ä¸€ä¸ªå®¹å™¨ã€‚ ä¸Šå›¾ä¸­ï¼Œå·¦ä¾§çš„åœ†åœˆå°±æ˜¯ä¸€ä¸ªå‡½å­ï¼Œè¡¨ç¤ºäººåçš„èŒƒç•´ã€‚å¤–éƒ¨ä¼ å…¥å‡½æ•°fï¼Œä¼šè½¬æˆå³è¾¹è¡¨ç¤ºæ—©é¤çš„èŒƒç•´ã€‚ ä¸‹é¢æ˜¯ä¸€å¼ æ›´ä¸€èˆ¬çš„å›¾ã€‚ ä¸Šå›¾ä¸­ï¼Œå‡½æ•°få®Œæˆå€¼çš„è½¬æ¢ï¼ˆaåˆ°bï¼‰ï¼Œå°†å®ƒä¼ å…¥å‡½å­ï¼Œå°±å¯ä»¥å®žçŽ°èŒƒç•´çš„è½¬æ¢ï¼ˆFaåˆ°Fbï¼‰ã€‚ å‡½å­çš„ä»£ç å®žçŽ°ä»»ä½•å…·æœ‰mapæ–¹æ³•çš„æ•°æ®ç»“æž„ï¼Œéƒ½å¯ä»¥å½“ä½œå‡½å­çš„å®žçŽ°ã€‚ 123456789class Functor&#123; construcor(val)&#123; this.val = val; &#125; map(f)&#123; return new Functor(f(this.val)); &#125;&#125; ä¸Šé¢ä»£ç ä¸­ï¼ŒFunctoræ˜¯ä¸€ä¸ªå‡½å­ï¼Œå®ƒçš„mapæ–¹æ³•æŽ¥å—å‡½æ•°fä½œä¸ºå‚æ•°ï¼Œç„¶åŽè¿”å›žä¸€ä¸ªæ–°çš„å‡½å­ï¼Œé‡Œé¢åŒ…å«çš„å€¼æ˜¯è¢«få¤„ç†è¿‡çš„ï¼ˆf(this.val)ï¼‰ã€‚ä¸€èˆ¬çº¦å®šï¼Œå‡½å­çš„æ ‡å¿—å°±æ˜¯å®¹å™¨å…·æœ‰mapæ–¹æ³•ã€‚è¯¥æ–¹æ³•å°†å®¹å™¨é‡Œé¢çš„æ¯ä¸€ä¸ªå€¼ï¼Œæ˜ å°„åˆ°å¦ä¸€ä¸ªå®¹å™¨ã€‚ ä¸‹é¢æ˜¯ä¸€äº›ç”¨æ³•çš„ç¤ºä¾‹ã€‚ 1234567891011(new Functot(2)).map(function(two)&#123; return two + 2;&#125;); //Functor(4)(new Functor('flamethrowers')).map(function(s) &#123; return s.toUpperCase();&#125;);// Functor('FLAMETHROWERS')(new Functor('bombs')).map(_.concat(' away')).map(_.prop('length'));// Functor(10) ä¸Šé¢çš„ä¾‹å­è¯´æ˜Žï¼Œå‡½æ•°å¼ç¼–ç¨‹é‡Œé¢çš„è¿ç®—ï¼Œéƒ½æ˜¯é€šè¿‡å‡½å­å®Œæˆï¼Œå³è¿ç®—ä¸ç›´æŽ¥é’ˆå¯¹å€¼ï¼Œè€Œæ˜¯é’ˆå¯¹è¿™ä¸ªå€¼çš„å®¹å™¨â€”-å‡½å­ã€‚å‡½å­æœ¬èº«å…·æœ‰å¯¹å¤–æŽ¥å£ï¼ˆmapæ–¹æ³•ï¼‰ï¼Œå„ç§å‡½æ•°å°±æ˜¯è¿ç®—ç¬¦ï¼Œé€šè¿‡æŽ¥å£æŽ¥å…¥å®¹å™¨ï¼Œå¼•å‘å®¹å™¨é‡Œé¢çš„å€¼çš„å˜å½¢ã€‚ å› æ­¤ï¼Œå­¦ä¹ å‡½æ•°å¼ç¼–ç¨‹ï¼Œå®žé™…ä¸Šå°±æ˜¯å­¦ä¹ å‡½å­çš„å„ç§è¿ç®—ã€‚ç”±äºŽå¯ä»¥æŠŠè¿ç®—æ–¹æ³•å°è£…åœ¨å‡½å­é‡Œé¢ï¼Œæ‰€ä»¥åˆè¡ç”Ÿå‡ºå„ç§ä¸åŒç±»åž‹çš„å‡½å­ï¼Œæœ‰å¤šå°‘ç§è¿ç®—ï¼Œå°±æœ‰å¤šå°‘ç§å‡½å­ã€‚å‡½æ•°å¼ç¼–ç¨‹å°±å˜æˆäº†è¿ç”¨ä¸åŒçš„å‡½å­ï¼Œè§£å†³å®žé™…é—®é¢˜ã€‚ ofæ–¹æ³•ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œä¸Šé¢ç”Ÿæˆæ–°çš„å‡½å­çš„æ—¶å€™ï¼Œç”¨äº†newå‘½ä»¤ã€‚è¿™å®žåœ¨å¤ªä¸åƒå‡½æ•°å¼ç¼–ç¨‹äº†ï¼Œå› ä¸ºnewå‘½ä»¤æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ‡å¿—ã€‚ å‡½æ•°å¼ç¼–ç¨‹ä¸€èˆ¬çº¦å®šï¼Œå‡½å­æœ‰ä¸€ä¸ªofæ–¹æ³•ï¼Œç”¨æ¥ç”Ÿæˆæ–°çš„å®¹å™¨ã€‚ ä¸‹é¢å°±ç”¨ofæ–¹æ³•æ›¿æ¢æŽ‰newã€‚ 123Functor.of = function(val) &#123; return new Functor(val);&#125;; è¿™å°±æ›´åƒå‡½æ•°å¼ç¼–ç¨‹äº†ã€‚ Maybe å‡½å­å‡½å­æŽ¥å—å„ç§å‡½æ•°ï¼Œå¤„ç†å®¹å™¨å†…éƒ¨çš„å€¼ã€‚è¿™é‡Œå°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå®¹å™¨å†…éƒ¨çš„å€¼å¯èƒ½æ˜¯ä¸€ä¸ªç©ºå€¼ï¼ˆæ¯”å¦‚nullï¼‰ï¼Œè€Œå¤–éƒ¨å‡½æ•°æœªå¿…æœ‰å¤„ç†ç©ºå€¼çš„æœºåˆ¶ï¼Œå¦‚æžœä¼ å…¥ç©ºå€¼ï¼Œå¾ˆå¯èƒ½å°±ä¼šå‡ºé”™ã€‚ 1234Functor.of(null).map(function (s) &#123; return s.toUpperCase();&#125;);// TypeError ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½å­é‡Œé¢çš„å€¼æ˜¯nullï¼Œç»“æžœå°å†™å˜æˆå¤§å†™çš„æ—¶å€™å°±å‡ºé”™äº†ã€‚ Maybe å‡½å­å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€ç±»é—®é¢˜è€Œè®¾è®¡çš„ã€‚ç®€å•è¯´ï¼Œå®ƒçš„mapæ–¹æ³•é‡Œé¢è®¾ç½®äº†ç©ºå€¼æ£€æŸ¥ã€‚ 1234class Maybe extends Functor &#123; map(f) &#123; return this.val ? Maybe.of(f(this.val)) : Maybe.of(null); &#125; æœ‰äº† Maybe å‡½å­ï¼Œå¤„ç†ç©ºå€¼å°±ä¸ä¼šå‡ºé”™äº†ã€‚ 1234Maybe.of(null).map(function (s) &#123; return s.toUpperCase();&#125;);// Maybe(null) Eitherå‡½å­æ¡ä»¶è¿ç®—if...elseæ˜¯æœ€å¸¸è§çš„è¿ç®—ä¹‹ä¸€ï¼Œå‡½æ•°å¼ç¼–ç¨‹é‡Œé¢ï¼Œä½¿ç”¨Eitherå‡½å­è¡¨è¾¾ã€‚ Either å‡½å­å†…éƒ¨æœ‰ä¸¤ä¸ªå€¼ï¼šå·¦å€¼ï¼ˆLeftï¼‰å’Œå³å€¼ï¼ˆRightï¼‰ã€‚å³å€¼æ˜¯æ­£å¸¸æƒ…å†µä¸‹ä½¿ç”¨çš„å€¼ï¼Œå·¦å€¼æ˜¯å³å€¼ä¸å­˜åœ¨æ—¶ä½¿ç”¨çš„é»˜è®¤å€¼ã€‚ 123456789101112131415161718192021222324class Either extends Functor&#123; construcor(left,right)&#123; this.left = left; this.right = right; &#125; map(f)&#123; return this.right ? Either.of(this.left,f(this.right)) : Either.of(f(this.left),this.right); &#125;&#125;Either.of = function(left,right)&#123; return new Either(left,right);&#125;// ä¸‹é¢æ˜¯ç”¨æ³•ã€‚var addOne = function (x) &#123; return x + 1;&#125;;Either.of(5, 6).map(addOne);// Either(5, 7);Either.of(1, null).map(addOne);// Either(2, null); ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æžœå³å€¼æœ‰å€¼ï¼Œå°±ä½¿ç”¨å³å€¼ï¼Œå¦åˆ™ä½¿ç”¨å·¦å€¼ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒEither å‡½å­è¡¨è¾¾äº†æ¡ä»¶è¿ç®—ã€‚ Either å‡½å­çš„å¸¸è§ç”¨é€”æ˜¯æä¾›é»˜è®¤å€¼ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ 123Either.of(&#123;address: 'xxx'&#125;, currentUser.address).map(updateField); ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æžœç”¨æˆ·æ²¡æœ‰æä¾›åœ°å€ï¼ŒEither å‡½å­å°±ä¼šä½¿ç”¨å·¦å€¼çš„é»˜è®¤åœ°å€ã€‚ Either å‡½å­çš„å¦ä¸€ä¸ªç”¨é€”æ˜¯ä»£æ›¿try...catchï¼Œä½¿ç”¨å·¦å€¼è¡¨ç¤ºé”™è¯¯ã€‚ 1234567function parseJSON(json) &#123; try &#123; return Either.of(null, JSON.parse(json)); &#125; catch (e: Error) &#123; return Either.of(e, null); &#125;&#125; apå‡½å­å‡½å­é‡Œé¢åŒ…å«çš„å€¼ï¼Œå®Œå…¨å¯èƒ½æ˜¯å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥æƒ³è±¡è¿™æ ·ä¸€ç§æƒ…å†µï¼Œä¸€ä¸ªå‡½å­çš„å€¼æ˜¯æ•°å€¼ï¼Œå¦ä¸€ä¸ªå‡½å­çš„å€¼æ˜¯å‡½æ•°ã€‚ 123456function addTwo(x) &#123; return x + 2;&#125;const A = Functor.of(2);const B = Functor.of(addTwo) ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½å­Aå†…éƒ¨çš„å€¼æ˜¯2ï¼Œå‡½å­Bå†…éƒ¨çš„å€¼æ˜¯å‡½æ•°addTwoã€‚ æœ‰æ—¶ï¼Œæˆ‘ä»¬æƒ³è®©å‡½å­Bå†…éƒ¨çš„å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨å‡½å­Aå†…éƒ¨çš„å€¼è¿›è¡Œè¿ç®—ã€‚è¿™æ—¶å°±éœ€è¦ç”¨åˆ° ap å‡½å­ã€‚ ap æ˜¯ applicativeï¼ˆåº”ç”¨ï¼‰çš„ç¼©å†™ã€‚å‡¡æ˜¯éƒ¨ç½²äº†apæ–¹æ³•çš„å‡½å­ï¼Œå°±æ˜¯ ap å‡½å­ã€‚ 12345class Ap extends Functor&#123; ap(F)&#123; return Ap.of(this.val(F.val)); &#125;&#125; æ³¨æ„ï¼Œapæ–¹æ³•çš„å‚æ•°ä¸æ˜¯å‡½æ•°ï¼Œè€Œæ˜¯å¦ä¸€ä¸ªå‡½å­ã€‚ å› æ­¤ï¼Œå‰é¢ä¾‹å­å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼ã€‚ 1Ap.of(addTwo).ap(Functor.of(2))//Ap(4) ap å‡½å­çš„æ„ä¹‰åœ¨äºŽï¼Œå¯¹äºŽé‚£äº›å¤šå‚æ•°çš„å‡½æ•°ï¼Œå°±å¯ä»¥ä»Žå¤šä¸ªå®¹å™¨ä¹‹ä¸­å–å€¼ï¼Œå®žçŽ°å‡½å­çš„é“¾å¼æ“ä½œã€‚ 1234567function add (y)&#123; return function(y)&#123; return x + y; &#125;&#125;Ap.of(add).ap(Maybe.of(2)).ap(Maybe.of(3)); //Ap(5) ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°addæ˜¯æŸ¯é‡ŒåŒ–ä»¥åŽçš„å½¢å¼ï¼Œä¸€å…±éœ€è¦ä¸¤ä¸ªå‚æ•°ã€‚é€šè¿‡ ap å‡½å­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®žçŽ°ä»Žä¸¤ä¸ªå®¹å™¨ä¹‹ä¸­å–å€¼ã€‚å®ƒè¿˜æœ‰å¦å¤–ä¸€ç§å†™æ³•ã€‚ 1Ap.of(add(2).ap(Maybe.of(3))); Monad å‡½å­å‡½å­æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥åŒ…å«ä»»ä½•å€¼ã€‚å‡½å­ä¹‹ä¸­å†åŒ…å«ä¸€ä¸ªå‡½å­ï¼Œä¹Ÿæ˜¯å®Œå…¨åˆæ³•çš„ã€‚ä½†æ˜¯ï¼Œè¿™æ ·å°±ä¼šå‡ºçŽ°å¤šå±‚åµŒå¥—çš„å‡½å­ã€‚ 12345Maybe.of( Maybe.of( Maybe.of(&#123;name: 'Mulburry', number: 8402&#125;) )) ä¸Šé¢è¿™ä¸ªå‡½å­ï¼Œä¸€å…±æœ‰ä¸‰ä¸ªMaybeåµŒå¥—ã€‚å¦‚æžœè¦å–å‡ºå†…éƒ¨çš„å€¼ï¼Œå°±è¦è¿žç»­å–ä¸‰æ¬¡this.valã€‚è¿™å½“ç„¶å¾ˆä¸æ–¹ä¾¿ï¼Œå› æ­¤å°±å‡ºçŽ°äº† Monad å‡½å­ã€‚ Monad å‡½å­çš„ä½œç”¨æ˜¯ï¼Œæ€»æ˜¯è¿”å›žä¸€ä¸ªå•å±‚çš„å‡½å­ã€‚å®ƒæœ‰ä¸€ä¸ªflatMapæ–¹æ³•ï¼Œä¸Žmapæ–¹æ³•ä½œç”¨ç›¸åŒï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯å¦‚æžœç”Ÿæˆäº†ä¸€ä¸ªåµŒå¥—å‡½å­ï¼Œå®ƒä¼šå–å‡ºåŽè€…å†…éƒ¨çš„å€¼ï¼Œä¿è¯è¿”å›žçš„æ°¸è¿œæ˜¯ä¸€ä¸ªå•å±‚çš„å®¹å™¨ï¼Œä¸ä¼šå‡ºçŽ°åµŒå¥—çš„æƒ…å†µã€‚ 12345678class Monad extends Functor &#123; join() &#123; return this.val; &#125; flatMap(f) &#123; return this.map(f).join(); &#125;&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æžœå‡½æ•°fè¿”å›žçš„æ˜¯ä¸€ä¸ªå‡½å­ï¼Œé‚£ä¹ˆthis.map(f)å°±ä¼šç”Ÿæˆä¸€ä¸ªåµŒå¥—çš„å‡½å­ã€‚æ‰€ä»¥ï¼Œjoinæ–¹æ³•ä¿è¯äº†flatMapæ–¹æ³•æ€»æ˜¯è¿”å›žä¸€ä¸ªå•å±‚çš„å‡½å­ã€‚è¿™æ„å‘³ç€åµŒå¥—çš„å‡½å­ä¼šè¢«é“ºå¹³ï¼ˆflattenï¼‰ã€‚ IO æ“ä½œMonad å‡½å­çš„é‡è¦åº”ç”¨ï¼Œå°±æ˜¯å®žçŽ° I/O ï¼ˆè¾“å…¥è¾“å‡ºï¼‰æ“ä½œã€‚ 1234567891011121314var fs = require('fs');var readFile = function(filename)&#123; return new IO(function()&#123; return fs.readFileSync(filename,'utf-8'); &#125;);&#125;var print = function(x) &#123; return new IO(function() &#123; console.log(x); return x; &#125;);&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œè¯»å–æ–‡ä»¶å’Œæ‰“å°æœ¬èº«éƒ½æ˜¯ä¸çº¯çš„æ“ä½œï¼Œä½†æ˜¯readFileå’Œprintå´æ˜¯çº¯å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬æ€»æ˜¯è¿”å›ž IO å‡½å­ã€‚ å¦‚æžœ IO å‡½å­æ˜¯ä¸€ä¸ªMonadï¼Œå…·æœ‰flatMapæ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åƒä¸‹é¢è¿™æ ·è°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•°ã€‚ 12readFile('./user.txt').flatMap(print) è¿™å°±æ˜¯ç¥žå¥‡çš„åœ°æ–¹ï¼Œä¸Šé¢çš„ä»£ç å®Œæˆäº†ä¸çº¯çš„æ“ä½œï¼Œä½†æ˜¯å› ä¸ºflatMapè¿”å›žçš„è¿˜æ˜¯ä¸€ä¸ª IO å‡½å­ï¼Œæ‰€ä»¥è¿™ä¸ªè¡¨è¾¾å¼æ˜¯çº¯çš„ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªçº¯çš„è¡¨è¾¾å¼ï¼Œå®Œæˆå¸¦æœ‰å‰¯ä½œç”¨çš„æ“ä½œï¼Œè¿™å°±æ˜¯ Monad çš„ä½œç”¨ã€‚ ç”±äºŽè¿”å›žè¿˜æ˜¯ IO å‡½å­ï¼Œæ‰€ä»¥å¯ä»¥å®žçŽ°é“¾å¼æ“ä½œã€‚å› æ­¤ï¼Œåœ¨å¤§å¤šæ•°åº“é‡Œé¢ï¼ŒflatMapæ–¹æ³•è¢«æ”¹åæˆchainã€‚ 1234567891011121314var tail = function(x) &#123; return new IO(function() &#123; return x[x.length - 1]; &#125;);&#125;readFile('./user.txt').flatMap(tail).flatMap(print)// ç­‰åŒäºŽreadFile('./user.txt').chain(tail).chain(print) ä¸Šé¢ä»£ç è¯»å–äº†æ–‡ä»¶user.txtï¼Œç„¶åŽé€‰å–æœ€åŽä¸€è¡Œè¾“å‡ºã€‚ åŽŸæ–‡åœ°å€]]></content>
      <tags>
        <tag>å‡½æ•°å¼ç¼–ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å°è£…å¸¸ç”¨çš„è·¨æµè§ˆå™¨çš„äº‹ä»¶å¯¹è±¡]]></title>
    <url>%2F2018%2F05%2F01%2FJs%2F%E5%B0%81%E8%A3%85%E5%B8%B8%E7%94%A8%E7%9A%84%E8%B7%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1EventUtil%2F</url>
    <content type="text"><![CDATA[å‰è¨€æœ€è¿‘æŠŠã€Šjavascripté«˜çº§ç¨‹åºè®¾è®¡ã€‹çœ‹å®Œäº†ï¼Œå‘çŽ°é‡Œé¢æœ‰å¾ˆå¤šè·¨æµè§ˆå™¨çš„ä»£ç ï¼Œæ€»ç»“ä¸€ä¸‹ï¼Œæ–¹ä¾¿è®°å½•ã€‚ è·¨æµè§ˆå™¨çš„äº‹ä»¶å¯¹è±¡EventUtil(äº‹ä»¶å¤„ç†ç¨‹åº)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586var EventUtil = &#123; addHandler: function(element,type,handler) &#123; //äº‹ä»¶ç›‘å¬ if(element.addEventListener) &#123; element.addEventListener(type,handler,false); &#125;else if(element.attachEvent) &#123; element.attachEvent("on"+type,handler); &#125;else &#123; element["on" +type] = handler; &#125; &#125;, removeHandler: function(element,type,handler)&#123; //ç§»é™¤äº‹ä»¶ç›‘å¬ if(element.removeEventListener) &#123; element.removeEventListener(type,handler,false); &#125;else if(element.detachEvent) &#123; element.detachEvent("on"+type,handler); &#125;else &#123; element["on" +type] = null; &#125; &#125;, getEvent: function(event) &#123;//èŽ·å–eventå¯¹è±¡ï¼Œè¿”å›ževentå¯¹è±¡çš„å¼•ç”¨ return event ? event : window.event; &#125;, getTarget: function(event) &#123;//è¿”å›žäº‹ä»¶ç›®æ ‡ã€‚ return event.target || event.srcElement; &#125;, preventDefault: function(event)&#123;//å–æ¶ˆæˆ–è€…é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸º if(event.preventDefault) &#123; event.preventDefault(); &#125;else &#123; event.returnValue = false; &#125; &#125;, stopPropagation: function(event) &#123;//é˜»æ­¢äº‹ä»¶æµï¼Œé˜»æ­¢äº‹ä»¶å†’æ³¡ if(event.stopPropagation) &#123; event.stopPropagation(); &#125;else &#123; event.cancelBubble = true; &#125; &#125;, getRelatedTarget: function(event)&#123;//è¿”å›žç›¸å…³å…ƒç´ ä¿¡æ¯ï¼ˆä»…å¯¹äºŽmouseoverå’Œmouseoutäº‹ä»¶ï¼‰ if (event.relatedTarget)&#123; return event.relatedTarget; &#125; else if (event.toElement)&#123; return event.toElement; &#125; else if (event.fromElement)&#123; return event.fromElement; &#125; else &#123; return null; &#125; &#125;, getWheelDelta: function(event) &#123;//èŽ·å–é¼ æ ‡æ»šè½®å¢žé‡å€¼ï¼Œæ£€æµ‹æ˜¯å¦åŒ…å«WheelDelta if(event.wheelDelta) &#123; return event.wheelDelta; &#125;else &#123; return -event.detail * 40 &#125; &#125;, getCharCode: function(event) &#123;//èŽ·å–é”®ç›˜æŒ‰é”®é”®ç ã€‚ if(typeof event.charCode == 'number') &#123; return event.charCode; &#125;else &#123; return event.keyCode; &#125; &#125;, getButton:function(event)&#123;//åœ¨mouseupæˆ–è€…mousedownçš„æ—¶å€™ï¼Œeventå­˜åœ¨ä¸€ä¸ªbuttonå±žæ€§ï¼Œç”¨äºŽåˆ¤æ–­æ˜¯æŒ‰äº†é¼ æ ‡å·¦é”®ï¼Œå³é”®ï¼Œè¿˜æ˜¯ä¸­é”®ï¼Œ0é¼ æ ‡ä¸»é”®æŒ‰é’®ï¼Œ1æ˜¯ä¸­é—´ï¼Œ2æ˜¯æ¬¡é”®ï¼ˆå³é”®ï¼‰ if(document.implementation.hasFeature("MouseEvents","2.0"))&#123; return event.button; &#125;else&#123; switch(event.button)&#123; case 0: case 1: case 3: case 5: case 7: return 0; case 2: case 6: return 2; case 4: return 1; &#125; &#125; &#125;&#125;; ä½¿ç”¨æ–¹æ³•ä¾‹å¦‚clickäº‹ä»¶ 1234567var btn1 = document.getElementById("myBtn1");var handler = function()&#123;alert("hello haorooms");&#125;EventUtil.addHandler(btn1, "click", handler);//EventUtil.removeHandler(btn1, "click", handler);]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React V16.3 å³å°†æ›´æ”¹çš„ç”Ÿå‘½å‘¨æœŸ]]></title>
    <url>%2F2018%2F04%2F30%2FReact%2FReact-V16-3-%E5%8D%B3%E5%B0%86%E6%9B%B4%E6%94%B9%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%2F</url>
    <content type="text"><![CDATA[å³å°†æ›´æ”¹çš„ç”Ÿå‘½å‘¨æœŸä¸€å¹´å¤šæ¥ï¼ŒReactå›¢é˜Ÿä¸€ç›´è‡´åŠ›äºŽå®žçŽ°å¼‚æ­¥æ¸²æŸ“ã€‚ä¸Šä¸ªæœˆï¼Œä»–åœ¨JSConfå†°å²›çš„æ¼”è®²ä¸­ï¼Œä¸¹æ­ç¤ºäº†ä¸€äº›ä»¤äººå…´å¥‹çš„æ–°çš„å¼‚æ­¥æ¸²æŸ“å¯èƒ½æ€§ã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸Žæ‚¨åˆ†äº«æˆ‘ä»¬åœ¨å­¦ä¹ è¿™äº›åŠŸèƒ½æ—¶å­¦åˆ°çš„ä¸€äº›ç»éªŒæ•™è®­ï¼Œä»¥åŠä¸€äº›å¸®åŠ©æ‚¨å‡†å¤‡ç»„ä»¶ä»¥åœ¨å¯åŠ¨æ—¶è¿›è¡Œå¼‚æ­¥æ¸²æŸ“çš„æ–¹æ³•ã€‚ æˆ‘ä»¬äº†è§£åˆ°çš„æœ€å¤§é—®é¢˜ä¹‹ä¸€æ˜¯ï¼Œæˆ‘ä»¬çš„ä¸€äº›ä¼ ç»Ÿç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¼šå¯¼è‡´ä¸€äº›ä¸å®‰å…¨çš„ç¼–ç å®žè·µã€‚ä»–ä»¬æ˜¯ï¼š componentWillMount componentWillReceiveProps componentWillUpdate è¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ç»å¸¸è¢«è¯¯è§£å’Œæ»¥ç”¨;æ­¤å¤–ï¼Œæˆ‘ä»¬é¢„è®¡ä»–ä»¬çš„æ½œåœ¨æ»¥ç”¨å¯èƒ½åœ¨å¼‚æ­¥æ¸²æŸ“æ–¹é¢æœ‰æ›´å¤§çš„é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åœ¨å³å°†å‘å¸ƒçš„ç‰ˆæœ¬ä¸­ä¸ºè¿™äº›ç”Ÿå‘½å‘¨æœŸæ·»åŠ ä¸€ä¸ªâ€œUNSAFE_â€å‰ç¼€ã€‚ ï¼ˆè¿™é‡Œï¼Œâ€œä¸å®‰å…¨â€ä¸æ˜¯æŒ‡å®‰å…¨æ€§ï¼Œè€Œæ˜¯è¡¨ç¤ºä½¿ç”¨è¿™äº›ç”Ÿå‘½å‘¨æœŸçš„ä»£ç å°†æ›´æœ‰å¯èƒ½åœ¨æœªæ¥çš„Reactç‰ˆæœ¬ä¸­å­˜åœ¨ç¼ºé™·ï¼Œç‰¹åˆ«æ˜¯ä¸€æ—¦å¯ç”¨äº†å¼‚æ­¥æ¸²æŸ“ï¼‰ã€‚ é€æ­¥è¿ç§»è·¯å¾„Reactéµå¾ªè¯­ä¹‰ç‰ˆæœ¬æŽ§åˆ¶, æ‰€ä»¥è¿™ç§æ”¹å˜å°†æ˜¯æ¸è¿›çš„ã€‚æˆ‘ä»¬ç›®å‰çš„è®¡åˆ’æ˜¯ï¼š 16.3ï¼šä¸ºä¸å®‰å…¨ç”Ÿå‘½å‘¨æœŸå¼•å…¥åˆ«åUNSAFE_componentWillMountï¼ŒUNSAFE_componentWillReceivePropså’ŒUNSAFE_componentWillUpdateã€‚ ï¼ˆæ—§çš„ç”Ÿå‘½å‘¨æœŸåç§°å’Œæ–°çš„åˆ«åéƒ½å¯ä»¥åœ¨æ­¤ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚ï¼‰ æœªæ¥çš„16.xç‰ˆæœ¬ï¼šä¸ºcomponentWillMountï¼ŒcomponentWillReceivePropså’ŒcomponentWillUpdateå¯ç”¨å¼ƒç”¨è­¦å‘Šã€‚ ï¼ˆæ—§çš„ç”Ÿå‘½å‘¨æœŸåç§°å’Œæ–°çš„åˆ«åéƒ½å¯ä»¥åœ¨æ­¤ç‰ˆæœ¬ä¸­ä½¿ç”¨ï¼Œä½†æ—§åç§°ä¼šè®°å½•DEVæ¨¡å¼è­¦å‘Šã€‚ï¼‰ 17.0ï¼šåˆ é™¤componentWillMountï¼ŒcomponentWillReceivePropså’ŒcomponentWillUpdateã€‚ ï¼ˆä»ŽçŽ°åœ¨å¼€å§‹ï¼Œåªæœ‰æ–°çš„â€œUNSAFE_â€ç”Ÿå‘½å‘¨æœŸåç§°å°†èµ·ä½œç”¨ã€‚ï¼‰ è¯·æ³¨æ„ï¼Œå¦‚æžœæ‚¨æ˜¯Reactåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œé‚£ä¹ˆæ‚¨ä¸å¿…å¯¹é—ç•™æ–¹æ³•è¿›è¡Œä»»ä½•æ“ä½œã€‚å³å°†å‘å¸ƒçš„16.3ç‰ˆæœ¬çš„ä¸»è¦ç›®çš„æ˜¯è®©å¼€æºé¡¹ç›®ç»´æŠ¤äººå‘˜åœ¨ä»»ä½•å¼ƒç”¨è­¦å‘Šä¹‹å‰æ›´æ–°å…¶åº“ã€‚è¿™äº›è­¦å‘Šå°†åœ¨æœªæ¥çš„16.xç‰ˆæœ¬å‘å¸ƒä¹‹å‰ä¸ä¼šå¯ç”¨ã€‚ ä»Žä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸè¿ç§»å¦‚æžœæ‚¨æƒ³å¼€å§‹ä½¿ç”¨React 16.3ä¸­å¼•å…¥çš„æ–°ç»„ä»¶APIï¼ˆæˆ–è€…å¦‚æžœæ‚¨æ˜¯ç»´æŠ¤äººå‘˜æå‰æ›´æ–°åº“ï¼‰ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™äº›ç¤ºä¾‹å¯ä»¥å¸®åŠ©æ‚¨å¼€å§‹è€ƒè™‘ç»„ä»¶çš„å˜åŒ–ã€‚éšç€æ—¶é—´çš„æŽ¨ç§»ï¼Œæˆ‘ä»¬è®¡åˆ’åœ¨æ–‡æ¡£ä¸­æ·»åŠ é¢å¤–çš„â€œé…æ–¹â€ï¼Œä»¥å±•ç¤ºå¦‚ä½•ä»¥é¿å…æœ‰é—®é¢˜çš„ç”Ÿå‘½å‘¨æœŸçš„æ–¹å¼æ‰§è¡Œå¸¸è§ä»»åŠ¡ã€‚ åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å°†ç®€è¦æ¦‚è¿°ä¸º16.3ç‰ˆè®¡åˆ’çš„ç”Ÿå‘½å‘¨æœŸæ›´æ”¹ï¼š æˆ‘ä»¬æ­£åœ¨æ·»åŠ ä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸåˆ«åï¼š (1) UNSAFE_componentWillMountï¼Œ (2) UNSAFE_componentWillReceiveProps (3) UNSAFE_componentWillUpdateã€‚ ï¼ˆæ—§çš„ç”Ÿå‘½å‘¨æœŸåç§°å’Œæ–°çš„åˆ«åéƒ½å°†å—æ”¯æŒã€‚ï¼‰ æˆ‘ä»¬ä»‹ç»äº†ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸï¼Œåˆ†åˆ«æ˜¯getDerivedStateFromPropså’ŒgetSnapshotBeforeUpdateã€‚ æ–°çš„ç”Ÿå‘½å‘¨æœŸ: getDerivedStateFromProps 12345678910class Example extends React.Component &#123; static getDerivedStateFromProps(nextProps, prevState) &#123; // ... &#125;&#125; æ–°çš„é™æ€getDerivedStateFromPropsç”Ÿå‘½å‘¨æœŸåœ¨ç»„ä»¶å®žä¾‹åŒ–ä»¥åŠæŽ¥æ”¶æ–°propsåŽè°ƒç”¨ã€‚å®ƒå¯ä»¥è¿”å›žä¸€ä¸ªå¯¹è±¡æ¥æ›´æ–°stateï¼Œæˆ–è€…è¿”å›žnullæ¥è¡¨ç¤ºæ–°çš„propsä¸éœ€è¦ä»»ä½•stateæ›´æ–°ã€‚ ä¸ŽcomponentDidUpdateä¸€èµ·ï¼Œè¿™ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸåº”è¯¥è¦†ç›–ä¼ ç»ŸcomponentWillReceivePropsçš„æ‰€æœ‰ç”¨ä¾‹ã€‚ æ–°çš„ç”Ÿå‘½å‘¨æœŸ: getSnapshotBeforeUpdate123456789class Example extends React.Component &#123; getSnapshotBeforeUpdate(prevProps, prevState) &#123; // ... &#125;&#125; æ–°çš„getSnapshotBeforeUpdateç”Ÿå‘½å‘¨æœŸåœ¨æ›´æ–°ä¹‹å‰è¢«è°ƒç”¨ï¼ˆä¾‹å¦‚ï¼Œåœ¨DOMè¢«æ›´æ–°ä¹‹å‰ï¼‰ã€‚æ­¤ç”Ÿå‘½å‘¨æœŸçš„è¿”å›žå€¼å°†ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™componentDidUpdateã€‚ ï¼ˆè¿™ä¸ªç”Ÿå‘½å‘¨æœŸä¸æ˜¯ç»å¸¸éœ€è¦çš„ï¼Œä½†å¯ä»¥ç”¨äºŽåœ¨æ¢å¤æœŸé—´æ‰‹åŠ¨ä¿å­˜æ»šåŠ¨ä½ç½®çš„æƒ…å†µã€‚ï¼‰ You can find their type signatures in this gist. æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ä½¿ç”¨è¿™ä¸¤ç§ç”Ÿå‘½å‘¨æœŸçš„ï¼Œä¾‹å­å¦‚ä¸‹: ä¾‹å¦‚ Initializing stateï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰Ini Fetching external dataï¼ˆèŽ·å–å¤–éƒ¨æ•°æ®ï¼‰ Adding event listenersï¼ˆæ·»åŠ äº‹ä»¶ç›‘å¬ï¼‰ Updating state based on propsï¼ˆåŸºäºŽpropsæ›´æ–°stateï¼‰ Invoking external callbacks(è°ƒç”¨å¤–éƒ¨çš„callbacks) Side effects on props change Fetching external data when props changeï¼ˆpropsæ”¹å˜æ—¶èŽ·å–å¤–éƒ¨æ•°æ®ï¼‰ Reading DOM properties before an update(åœ¨æ›´æ–°ä¹‹å‰è¯»å–DOMå±žæ€§) æ³¨æ„ä¸ºç®€æ´èµ·è§ï¼Œä¸‹é¢çš„ç¤ºä¾‹æ˜¯ä½¿ç”¨å®žéªŒç±»å±žæ€§è½¬æ¢ç¼–å†™çš„ï¼Œä½†å¦‚æžœæ²¡æœ‰å®ƒï¼Œåˆ™åº”ç”¨ç›¸åŒçš„è¿ç§»ç­–ç•¥ã€‚ åˆå§‹åŒ–çŠ¶æ€ï¼šè¿™ä¸ªä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªè°ƒç”¨componentWillMountä¸­å¸¦æœ‰setStateçš„ç»„ä»¶ï¼š 12345678910111213141516171819// Beforeclass ExampleComponent extends React.Component &#123; state = &#123;&#125;; componentWillMount() &#123; this.setState(&#123; currentColor: this.props.defaultColor, palette: 'rgb', &#125;); &#125;&#125; è¿™ç§ç±»åž‹çš„ç»„ä»¶æœ€ç®€å•çš„é‡æž„æ˜¯å°†çŠ¶æ€åˆå§‹åŒ–ç§»åŠ¨åˆ°æž„é€ å‡½æ•°æˆ–å±žæ€§åˆå§‹å€¼è®¾å®šé¡¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910111213// Afterclass ExampleComponent extends React.Component &#123; state = &#123; currentColor: this.props.defaultColor, palette: 'rgb', &#125;;&#125; èŽ·å–å¤–éƒ¨æ•°æ®ä»¥ä¸‹æ˜¯ä½¿ç”¨componentWillMountèŽ·å–å¤–éƒ¨æ•°æ®çš„ç»„ä»¶ç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455// Beforeclass ExampleComponent extends React.Component &#123; state = &#123; externalData: null, &#125;; componentWillMount() &#123; this._asyncRequest = asyncLoadData().then( externalData =&gt; &#123; this._asyncRequest = null; this.setState(&#123;externalData&#125;); &#125; ); &#125; componentWillUnmount() &#123; if (this._asyncRequest) &#123; this._asyncRequest.cancel(); &#125; &#125; render() &#123; if (this.state.externalData === null) &#123; // Render loading state ... &#125; else &#123; // Render real UI ... &#125; &#125;&#125; å¯¹äºŽå¤§å¤šæ•°ç”¨ä¾‹ï¼Œå»ºè®®çš„å‡çº§è·¯å¾„æ˜¯å°†æ•°æ®æå–ç§»å…¥componentDidMountï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950// Afterclass ExampleComponent extends React.Component &#123; state = &#123; externalData: null, &#125;; componentDidMount() &#123; this._asyncRequest = asyncLoadData().then( externalData =&gt; &#123; this._asyncRequest = null; this.setState(&#123;externalData&#125;); &#125; ); &#125; componentWillUnmount() &#123; if (this._asyncRequest) &#123; this._asyncRequest.cancel(); &#125; &#125; render() &#123; if (this.state.externalData === null) &#123; // Render loading state ... &#125; else &#123; // Render real UI ... &#125; &#125;&#125; æœ‰ä¸€ä¸ªå¸¸è§çš„é”™è¯¯è§‚å¿µè®¤ä¸ºï¼Œåœ¨componentWillMountä¸­æå–å¯ä»¥é¿å…ç¬¬ä¸€ä¸ªç©ºçš„æ¸²æŸ“ã€‚åœ¨å®žè·µä¸­ï¼Œè¿™ä»Žæ¥éƒ½ä¸æ˜¯çœŸçš„ï¼Œå› ä¸ºReactæ€»æ˜¯åœ¨componentWillMountä¹‹åŽç«‹å³æ‰§è¡Œæ¸²æŸ“ã€‚å¦‚æžœæ•°æ®åœ¨componentWillMountè§¦å‘çš„æ—¶é—´å†…ä¸å¯ç”¨ï¼Œåˆ™æ— è®ºä½ åœ¨å“ªé‡Œæå–æ•°æ®ï¼Œç¬¬ä¸€ä¸ªæ¸²æŸ“ä»å°†æ˜¾ç¤ºåŠ è½½çŠ¶æ€ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹å°†æå–ç§»åˆ°componentDidMountæ²¡æœ‰æ˜Žæ˜¾æ•ˆæžœã€‚ æ³¨æ„ï¼šä¸€äº›é«˜çº§ç”¨ä¾‹ï¼ˆä¾‹å¦‚ï¼ŒåƒRelayè¿™æ ·çš„åº“ï¼‰å¯èƒ½æƒ³è¦å°è¯•ä½¿ç”¨çƒ­åˆ‡çš„é¢„å–å¼‚æ­¥æ•°æ®ã€‚åœ¨è¿™é‡Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªè¿™æ ·åšçš„ä¾‹å­ã€‚ å½“æ”¯æŒæœåŠ¡å™¨æ¸²æŸ“æ—¶ï¼Œç›®å‰éœ€è¦åŒæ­¥æä¾›æ•°æ® - componentWillMounté€šå¸¸ç”¨äºŽæ­¤ç›®çš„ï¼Œä½†æž„é€ å‡½æ•°å¯ä»¥ç”¨ä½œæ›¿æ¢ã€‚å³å°†åˆ°æ¥çš„æ‚¬å¿µAPIå°†ä½¿å¾—å¼‚æ­¥æ•°æ®åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‘ˆçŽ°ä¸­éƒ½å¯ä»¥æ¸…æ™°åœ°èŽ·å–ã€‚ æ·»åŠ æ—¶é—´ç›‘å¬ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨å®‰è£…æ—¶ç›‘å¬å¤–éƒ¨äº‹ä»¶è°ƒåº¦ç¨‹åºçš„ç»„ä»¶ç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// Beforeclass ExampleComponent extends React.Component &#123; componentWillMount() &#123; this.setState(&#123; subscribedValue: this.props.dataSource.value, &#125;); // This is not safe; it can leak! this.props.dataSource.subscribe( this.handleSubscriptionChange ); &#125; componentWillUnmount() &#123; this.props.dataSource.unsubscribe( this.handleSubscriptionChange ); &#125; handleSubscriptionChange = dataSource =&gt; &#123; this.setState(&#123; subscribedValue: dataSource.value, &#125;); &#125;;&#125; ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¼šå¯¼è‡´æœåŠ¡å™¨æ¸²æŸ“ï¼ˆcomponentWillUnmountæ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ï¼‰å’Œå¼‚æ­¥æ¸²æŸ“ï¼ˆåœ¨æ¸²æŸ“å®Œæˆä¹‹å‰æ¸²æŸ“å¯èƒ½è¢«ä¸­æ–­ï¼Œå¯¼è‡´componentWillUnmountä¸è¢«è°ƒç”¨ï¼‰çš„å†…å­˜æ³„æ¼ã€‚ äººä»¬ç»å¸¸è®¤ä¸ºcomponentWillMountå’ŒcomponentWillUnmountæ€»æ˜¯é…å¯¹ï¼Œä½†è¿™å¹¶ä¸èƒ½ä¿è¯ã€‚åªæœ‰è°ƒç”¨componentDidMountåŽï¼ŒReactæ‰èƒ½ä¿è¯ç¨åŽè°ƒç”¨componentWillUnmountè¿›è¡Œæ¸…ç†ã€‚ å‡ºäºŽè¿™ä¸ªåŽŸå› ï¼Œæ·»åŠ äº‹ä»¶ç›‘å¬çš„æŽ¨èæ–¹å¼æ˜¯ä½¿ç”¨componentDidMountç”Ÿå‘½å‘¨æœŸï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273// Afterclass ExampleComponent extends React.Component &#123; state = &#123; subscribedValue: this.props.dataSource.value, &#125;; componentDidMount() &#123; // Event listeners are only safe to add after mount, // So they won't leak if mount is interrupted or errors. this.props.dataSource.subscribe( this.handleSubscriptionChange ); // External values could change between render and mount, // In some cases it may be important to handle this case. if ( this.state.subscribedValue !== this.props.dataSource.value ) &#123; this.setState(&#123; subscribedValue: this.props.dataSource.value, &#125;); &#125; &#125; componentWillUnmount() &#123; this.props.dataSource.unsubscribe( this.handleSubscriptionChange ); &#125; handleSubscriptionChange = dataSource =&gt; &#123; this.setState(&#123; subscribedValue: dataSource.value, &#125;); &#125;;&#125; æœ‰æ—¶å€™æ›´æ–°ç›‘å¬ä»¥å“åº”å±žæ€§å˜åŒ–å¾ˆé‡è¦ã€‚å¦‚æžœæ‚¨ä½¿ç”¨çš„æ˜¯åƒReduxæˆ–MobXè¿™æ ·çš„åº“ï¼Œåº“çš„å®¹å™¨ç»„ä»¶ä¼šä¸ºæ‚¨å¤„ç†ã€‚å¯¹äºŽåº”ç”¨ç¨‹åºä½œè€…ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå°åž‹åº“create-subscriptionæ¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¼šå°†å®ƒä¸ŽReact 16.3ä¸€èµ·å‘å¸ƒã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨create-subscriptionæ¥ä¼ é€’ç›‘å¬çš„å€¼ï¼Œè€Œä¸æ˜¯åƒä¸Šä¾‹é‚£æ ·ä¼ é€’ç›‘å¬ çš„dataSource propã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657import &#123;createSubscription&#125; from 'create-subscription';const Subscription = createSubscription(&#123; getCurrentValue(sourceProp) &#123; // Return the current value of the subscription (sourceProp). return sourceProp.value; &#125;, subscribe(sourceProp, callback) &#123; function handleSubscriptionChange() &#123; callback(sourceProp.value); &#125; // Subscribe (e.g. add an event listener) to the subscription (sourceProp). // Call callback(newValue) whenever a subscription changes. sourceProp.subscribe(handleSubscriptionChange); // Return an unsubscribe method. return function unsubscribe() &#123; sourceProp.unsubscribe(handleSubscriptionChange); &#125;; &#125;,&#125;);// Rather than passing the subscribable source to our ExampleComponent,// We could just pass the subscribed value directly:`&lt;Subscription source=&#123;dataSource&#125;&gt;` &#123;value =&gt; `&lt;ExampleComponent subscribedValue=&#123;value&#125; /&gt;`&#125;`&lt;/Subscription&gt;`; æ³¨æ„åƒRelay / Apolloè¿™æ ·çš„åº“åº”è¯¥ä½¿ç”¨ä¸Žåˆ›å»ºè®¢é˜…ç›¸åŒçš„æŠ€æœ¯æ‰‹åŠ¨ç®¡ç†è®¢é˜…ï¼ˆå¦‚æ­¤å¤„æ‰€å¼•ç”¨çš„ï¼‰ï¼Œå¹¶é‡‡ç”¨æœ€é€‚åˆå…¶åº“ä½¿ç”¨çš„ä¼˜åŒ–æ–¹å¼ã€‚ åŸºäºŽpropsæ›´æ–°stateä»¥ä¸‹æ˜¯ä½¿ç”¨æ—§ç‰ˆcomponentWillReceivePropsç”Ÿå‘½å‘¨æœŸåŸºäºŽæ–°çš„é“å…·å€¼æ›´æ–°çŠ¶æ€çš„ç»„ä»¶ç¤ºä¾‹ï¼š 1234567891011121314151617181920212223242526272829// Beforeclass ExampleComponent extends React.Component &#123; state = &#123; isScrollingDown: false, &#125;; componentWillReceiveProps(nextProps) &#123; if (this.props.currentRow !== nextProps.currentRow) &#123; this.setState(&#123; isScrollingDown: nextProps.currentRow &gt; this.props.currentRow, &#125;); &#125; &#125;&#125; å°½ç®¡ä¸Šé¢çš„ä»£ç æœ¬èº«å¹¶æ²¡æœ‰é—®é¢˜ï¼Œä½†componentWillReceivePropsç”Ÿå‘½å‘¨æœŸé€šå¸¸ä¼šè¢«é”™è¯¯åœ°ç”¨äºŽè§£å†³é—®é¢˜ã€‚å› æ­¤ï¼Œè¯¥æ–¹æ³•å°†è¢«å¼ƒç”¨ã€‚ ä»Žç‰ˆæœ¬16.3å¼€å§‹ï¼Œæ›´æ–°stateä»¥å“åº”propsæ›´æ”¹çš„æŽ¨èæ–¹æ³•æ˜¯ä½¿ç”¨æ–°çš„é™æ€getDerivedStateFromPropsç”Ÿå‘½å‘¨æœŸã€‚ ï¼ˆç”Ÿå‘½å‘¨æœŸåœ¨ç»„ä»¶åˆ›å»ºæ—¶ä»¥åŠæ¯æ¬¡æ”¶åˆ°æ–°é“å…·æ—¶è°ƒç”¨ï¼‰ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243// Afterclass ExampleComponent extends React.Component &#123; // Initialize state in constructor, // Or with a property initializer. state = &#123; isScrollingDown: false, lastRow: null, &#125;; static getDerivedStateFromProps(nextProps, prevState) &#123; if (nextProps.currentRow !== prevState.lastRow) &#123; return &#123; isScrollingDown: nextProps.currentRow &gt; prevState.lastRow, lastRow: nextProps.currentRow, &#125;; &#125; // Return null to indicate no change to state. return null; &#125;&#125; ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œprops.currentRowæ˜¯ä¸€ä¸ªé•œåƒçŠ¶æ€ï¼ˆå¦‚state.lastRowï¼‰ã€‚è¿™ä½¿å¾—getDerivedStateFromPropså¯ä»¥åƒåœ¨componentWillReceivePropsä¸­ä¸€æ ·è®¿é—®ä»¥å‰çš„propså€¼ã€‚ æ‚¨å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸åªæ˜¯å°†å…ˆå‰çš„propsä½œä¸ºå‚æ•°ä¼ é€’ç»™getDerivedStateFromPropsã€‚æˆ‘ä»¬åœ¨è®¾è®¡APIæ—¶è€ƒè™‘äº†è¿™ä¸ªé€‰é¡¹ï¼Œä½†æœ€ç»ˆå†³å®šåå¯¹å®ƒï¼ŒåŽŸå› æœ‰ä¸¤ä¸ª åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨getDerivedStateFromPropsï¼ˆå®žä¾‹åŒ–åŽï¼‰æ—¶ï¼ŒprevPropså‚æ•°å°†ä¸ºnullï¼Œéœ€è¦åœ¨è®¿é—®prevPropsæ—¶æ·»åŠ if-not-nullæ£€æŸ¥ã€‚ æ²¡æœ‰å°†ä»¥å‰çš„propsä¼ é€’ç»™è¿™ä¸ªå‡½æ•°ï¼Œåœ¨æœªæ¥ç‰ˆæœ¬çš„Reactä¸­é‡Šæ”¾å†…å­˜çš„ä¸€ä¸ªæ­¥éª¤ã€‚ ï¼ˆå¦‚æžœReactä¸éœ€è¦å°†å…ˆå‰çš„é“å…·ä¼ é€’ç»™ç”Ÿå‘½å‘¨æœŸï¼Œé‚£ä¹ˆå®ƒä¸éœ€è¦å°†å…ˆå‰çš„é“å…·å¯¹è±¡ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚ï¼‰ Noteå¦‚æžœæ‚¨æ­£åœ¨ç¼–å†™å…±äº«ç»„ä»¶ï¼Œé‚£ä¹ˆreact-lifecycles-compat polyfillå¯ä»¥ä½¿æ–°çš„getDerivedStateFromPropsç”Ÿå‘½å‘¨æœŸä¸Žæ—§ç‰ˆæœ¬çš„Reactä¸€èµ·ä½¿ç”¨ã€‚è¯¦ç»†äº†è§£å¦‚ä½•åœ¨ä¸‹é¢ä½¿ç”¨å®ƒã€‚ è°ƒç”¨å¤–éƒ¨å›žè°ƒå‡½æ•°ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨å†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨å¤–éƒ¨å‡½æ•°çš„ç»„ä»¶ç¤ºä¾‹ï¼š 123456789101112131415161718192021// Beforeclass ExampleComponent extends React.Component &#123; componentWillUpdate(nextProps, nextState) &#123; if ( this.state.someStatefulValue !== nextState.someStatefulValue ) &#123; nextProps.onChange(nextState.someStatefulValue); &#125; &#125;&#125; åœ¨å¼‚æ­¥æ¨¡å¼ä¸‹ä½¿ç”¨componentWillUpdateéƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¤–éƒ¨å›žè°ƒå¯èƒ½ä¼šå¤šæ¬¡è°ƒç”¨åªæ›´æ–°ä¸€æ¬¡ã€‚ç›¸åï¼Œåº”è¯¥ä½¿ç”¨componentDidUpdateç”Ÿå‘½å‘¨æœŸï¼Œå› ä¸ºå®ƒä¿è¯æ¯æ¬¡æ›´æ–°åªè°ƒç”¨ä¸€æ¬¡ï¼š 123456789101112131415161718192021// Afterclass ExampleComponent extends React.Component &#123; componentDidUpdate(prevProps, prevState) &#123; if ( this.state.someStatefulValue !== prevState.someStatefulValue ) &#123; this.props.onChange(this.state.someStatefulValue); &#125; &#125;&#125; propsæ”¹å˜çš„å‰¯ä½œç”¨ä¸Žä¸Šè¿° äº‹ä¾‹ç±»ä¼¼ï¼Œæœ‰æ—¶ç»„ä»¶åœ¨é“å…·æ›´æ”¹æ—¶ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚ 123456789101112131415// Beforeclass ExampleComponent extends React.Component &#123; componentWillReceiveProps(nextProps) &#123; if (this.props.isVisible !== nextProps.isVisible) &#123; logVisibleChange(nextProps.isVisible); &#125; &#125;&#125; ä¸ŽcomponentWillUpdateä¸€æ ·ï¼ŒcomponentWillReceivePropså¯èƒ½ä¼šå¤šæ¬¡è°ƒç”¨ä½†æ˜¯åªæ›´æ–°ä¸€æ¬¡ã€‚å‡ºäºŽè¿™ä¸ªåŽŸå› ï¼Œé¿å…åœ¨æ­¤æ–¹æ³•ä¸­å¯¼è‡´çš„å‰¯ä½œç”¨éžå¸¸é‡è¦ã€‚ç›¸åï¼Œåº”è¯¥ä½¿ç”¨componentDidUpdateï¼Œå› ä¸ºå®ƒä¿è¯æ¯æ¬¡æ›´æ–°åªè°ƒç”¨ä¸€æ¬¡ï¼š 123456789101112131415// Afterclass ExampleComponent extends React.Component &#123; componentDidUpdate(prevProps, prevState) &#123; if (this.props.isVisible !== prevProps.isVisible) &#123; logVisibleChange(this.props.isVisible); &#125; &#125;&#125; propsæ”¹å˜æ—¶èŽ·å–å¤–éƒ¨æ•°æ®ä»¥ä¸‹æ˜¯æ ¹æ®propsvaluesæå–å¤–éƒ¨æ•°æ®çš„ç»„ä»¶ç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879// Beforeclass ExampleComponent extends React.Component &#123; state = &#123; externalData: null, &#125;; componentDidMount() &#123; this._loadAsyncData(this.props.id); &#125; componentWillReceiveProps(nextProps) &#123; if (nextProps.id !== this.props.id) &#123; this.setState(&#123;externalData: null&#125;); this._loadAsyncData(nextProps.id); &#125; &#125; componentWillUnmount() &#123; if (this._asyncRequest) &#123; this._asyncRequest.cancel(); &#125; &#125; render() &#123; if (this.state.externalData === null) &#123; // Render loading state ... &#125; else &#123; // Render real UI ... &#125; &#125; _loadAsyncData(id) &#123; this._asyncRequest = asyncLoadData(id).then( externalData =&gt; &#123; this._asyncRequest = null; this.setState(&#123;externalData&#125;); &#125; ); &#125;&#125; æ­¤ç»„ä»¶çš„æŽ¨èå‡çº§è·¯å¾„æ˜¯å°†æ•°æ®æ›´æ–°ç§»åŠ¨åˆ°componentDidUpdateä¸­ã€‚åœ¨æ¸²æŸ“æ–°é“å…·ä¹‹å‰ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨æ–°çš„getDerivedStateFromPropsç”Ÿå‘½å‘¨æœŸæ¸…é™¤é™ˆæ—§çš„æ•°æ®ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105// Afterclass ExampleComponent extends React.Component &#123; state = &#123; externalData: null, &#125;; static getDerivedStateFromProps(nextProps, prevState) &#123; // Store prevId in state so we can compare when props change. // Clear out previously-loaded data (so we don't render stale stuff). if (nextProps.id !== prevState.prevId) &#123; return &#123; externalData: null, prevId: nextProps.id, &#125;; &#125; // No state update necessary return null; &#125; componentDidMount() &#123; this._loadAsyncData(this.props.id); &#125; componentDidUpdate(prevProps, prevState) &#123; if (this.state.externalData === null) &#123; this._loadAsyncData(this.props.id); &#125; &#125; componentWillUnmount() &#123; if (this._asyncRequest) &#123; this._asyncRequest.cancel(); &#125; &#125; render() &#123; if (this.state.externalData === null) &#123; // Render loading state ... &#125; else &#123; // Render real UI ... &#125; &#125; _loadAsyncData(id) &#123; this._asyncRequest = asyncLoadData(id).then( externalData =&gt; &#123; this._asyncRequest = null; this.setState(&#123;externalData&#125;); &#125; ); &#125;&#125; æ³¨æ„å¦‚æžœæ‚¨ä½¿ç”¨æ”¯æŒå–æ¶ˆçš„HTTPåº“ï¼ˆå¦‚axiosï¼‰ï¼Œé‚£ä¹ˆå¸è½½æ—¶å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚å¾ˆç®€å•ã€‚å¯¹äºŽåŽŸç”ŸPromiseï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„æ–¹æ³•ã€‚ åœ¨æ›´æ–°ä¹‹å‰è¯»å–DOMå±žæ€§ä¸‹é¢æ˜¯ä¸€ä¸ªç»„ä»¶çš„ä¾‹å­ï¼Œå®ƒåœ¨æ›´æ–°ä¹‹å‰ä»ŽDOMä¸­è¯»å–å±žæ€§ï¼Œä»¥ä¾¿åœ¨åˆ—è¡¨ä¸­ä¿æŒæ»šåŠ¨ä½ç½®ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061componentWillUpdate(nextProps, nextState) &#123; // Are we adding new items to the list? // Capture the scroll position so we can adjust scroll later. if (this.props.list.length &lt; nextProps.list.length) &#123; this.previousScrollOffset = this.listRef.scrollHeight - this.listRef.scrollTop; &#125; &#125; componentDidUpdate(prevProps, prevState) &#123; // If previousScrollOffset is set, we've just added new items. // Adjust scroll so these new items don't push the old ones out of view. if (this.previousScrollOffset !== null) &#123; this.listRef.scrollTop = this.listRef.scrollHeight - this.previousScrollOffset; this.previousScrollOffset = null; &#125; &#125; render() &#123; return ( `&lt;div&gt;` &#123;/* ...contents... */&#125; `&lt;/div&gt;` ); &#125; setListRef = ref =&gt; &#123; this.listRef = ref; &#125;;&#125; åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒcomponentWillUpdateè¢«ç”¨æ¥è¯»å–DOMå±žæ€§ã€‚ä½†æ˜¯ï¼Œå¯¹äºŽå¼‚æ­¥æ¸²æŸ“ï¼Œâ€œrenderâ€é˜¶æ®µç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚componentWillUpdateå’Œrenderï¼‰ä¸Žâ€œcommitâ€é˜¶æ®µç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚componentDidUpdateï¼‰ä¹‹é—´å¯èƒ½å­˜åœ¨å»¶è¿Ÿã€‚å¦‚æžœç”¨æˆ·åœ¨è¿™æ®µæ—¶é—´å†…åšäº†ç±»ä¼¼è°ƒæ•´çª—å£å¤§å°çš„æ“ä½œï¼Œåˆ™ä»ŽcomponentWillUpdateä¸­è¯»å–çš„scrollHeightå€¼å°†å¤±æ•ˆã€‚ è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ–°çš„â€œcommitâ€é˜¶æ®µç”Ÿå‘½å‘¨æœŸgetSnapshotBeforeUpdateã€‚åœ¨æ•°æ®å‘ç”Ÿå˜åŒ–ä¹‹å‰ç«‹å³è°ƒç”¨è¯¥æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ›´æ–°DOMä¹‹å‰ï¼‰ã€‚å®ƒå¯ä»¥å°†Reactçš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™componentDidUpdateï¼Œåœ¨æ•°æ®å‘ç”Ÿå˜åŒ–åŽç«‹å³è°ƒç”¨å®ƒã€‚ è¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå¯ä»¥åƒè¿™æ ·ä¸€èµ·ä½¿ç”¨ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071class ScrollingList extends React.Component &#123; listRef = null; getSnapshotBeforeUpdate(prevProps, prevState) &#123; // Are we adding new items to the list? // Capture the scroll position so we can adjust scroll later. if (prevProps.list.length &lt; this.props.list.length) &#123; return ( this.listRef.scrollHeight - this.listRef.scrollTop ); &#125; return null; &#125; componentDidUpdate(prevProps, prevState, snapshot) &#123; // If we have a snapshot value, we've just added new items. // Adjust scroll so these new items don't push the old ones out of view. // (snapshot here is the value returned from getSnapshotBeforeUpdate) if (snapshot !== null) &#123; this.listRef.scrollTop = this.listRef.scrollHeight - snapshot; &#125; &#125; render() &#123; return ( `&lt;div&gt;` &#123;/* ...contents... */&#125; `&lt;/div&gt;` ); &#125; setListRef = ref =&gt; &#123; this.listRef = ref; &#125;;&#125; æ³¨æ„å¦‚æžœæ‚¨æ­£åœ¨ç¼–å†™å…±äº«ç»„ä»¶ï¼Œé‚£ä¹ˆreact-lifecycles-compat polyfillå¯ä»¥ä½¿æ–°çš„getSnapshotBeforeUpdateç”Ÿå‘½å‘¨æœŸä¸Žæ—§ç‰ˆæœ¬çš„Reactä¸€èµ·ä½¿ç”¨ã€‚è¯¦ç»†äº†è§£å¦‚ä½•ä½¿ç”¨å®ƒã€‚ å…¶å®ƒæƒ…å†µé™¤äº†ä»¥ä¸Šçš„ä¸€äº›å¸¸è§çš„ä¾‹å­ï¼Œè¿˜å¯èƒ½ä¼šæœ‰åˆ«çš„æƒ…å†µæœ¬ç¯‡æ–‡ç« æ²¡æœ‰æ¶µç›–åˆ°ï¼Œå¦‚æžœæ‚¨ä»¥æœ¬åšæ–‡æœªæ¶‰åŠçš„æ–¹å¼ä½¿ç”¨é™¤äº†ä»¥ä¸Š componentWillMountï¼ŒcomponentWillUpdateæˆ–componentWillReceivePropsï¼Œå¹¶ä¸”ä¸ç¡®å®šå¦‚ä½•è¿ç§»è¿™äº›ä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸï¼Œä½ å¯ä»¥æä¾›æ‚¨çš„ä»£ç ç¤ºä¾‹å’Œæˆ‘ä»¬çš„æ–‡æ¡£ï¼Œå¹¶ä¸”ä¸€èµ·æäº¤ä¸€ä¸ªæ–°é—®é¢˜ã€‚æˆ‘ä»¬å°†åœ¨æ›´æ–°è¿™ä»½æ–‡ä»¶æ—¶æä¾›æ–°çš„æ›¿ä»£æ¨¡å¼ã€‚ å½“React 16.3å‘å¸ƒæ—¶ï¼Œæˆ‘ä»¬è¿˜å°†å‘å¸ƒä¸€ä¸ªæ–°çš„npmåŒ…ï¼Œ react-lifecycles-compatã€‚è¯¥npmåŒ…ä¼šå¡«å……ç»„ä»¶ï¼Œä»¥ä¾¿æ–°çš„getDerivedStateFromPropså’ŒgetSnapshotBeforeUpdateç”Ÿå‘½å‘¨æœŸä¹Ÿå¯ä»¥ä¸Žæ—§ç‰ˆæœ¬çš„Reactï¼ˆ0.14.9+ï¼‰ä¸€èµ·ä½¿ç”¨ã€‚ è¦ä½¿ç”¨è¿™ä¸ªpolyfillï¼Œé¦–å…ˆå°†å®ƒä½œä¸ºä¾èµ–é¡¹æ·»åŠ åˆ°æ‚¨çš„åº“ä¸­ï¼š 1234567# Yarnyarn add react-lifecycles-compat# NPMnpm install react-lifecycles-compat --save æŽ¥ä¸‹æ¥ï¼Œæ›´æ–°æ‚¨çš„ç»„ä»¶ä»¥ä½¿ç”¨æ–°çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ã€‚ æœ€åŽï¼Œä½¿ç”¨polyfillå°†ç»„ä»¶å‘åŽå…¼å®¹æ—§ç‰ˆæœ¬çš„Reactï¼š 123456789101112131415161718192021import React from 'react';import &#123;polyfill&#125; from 'react-lifecycles-compat';class ExampleComponent extends React.Component &#123; static getDerivedStateFromProps(nextProps, prevState) &#123; // Your state update logic here ... &#125;&#125;// Polyfill your component to work with older versions of React:polyfill(ExampleComponent);export default ExampleComponent; åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javascript å¼‚æ­¥ç¼–ç¨‹]]></title>
    <url>%2F2018%2F04%2F29%2FJs%2FJavascript-%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[ä¸ºä»€ä¹ˆJavaScriptçš„å¼‚æ­¥ç¼–ç¨‹ç»å¸¸è¢«äººæèµ·ï¼Œæˆ‘æƒ³åˆ°ä»¥ä¸‹ä¸¤ç‚¹åŽŸå› ã€‚é¦–å…ˆï¼ŒJavaScriptæ˜¯å•çº¿ç¨‹çš„ï¼Œç”¨äº‹ä»¶å¾ªçŽ¯çš„æœºåˆ¶æ¥ä¿è¯ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚å¦‚æžœæœ‰åŒæ­¥çš„ajaxè¯·æ±‚æˆ–è€…å¾ˆå¤æ‚çš„è¿ç®—ï¼ŒJavaScriptè¦ç­‰è¿™äº›æ“ä½œå®Œæˆï¼Œæ‰èƒ½å“åº”å…¶ä»–äº‹ä»¶ï¼Œé¡µé¢ä¼šè¿›å…¥å‡æ­»çŠ¶æ€ã€‚ç„¶è€Œå¯¹äºŽæ—¥æ¸å¤æ‚çš„webåº”ç”¨æ¥è¯´ï¼Œè¿™ä¸ªæ˜¯è‡´å‘½çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆNode.jsé€‚åˆé«˜I/Oæ“ä½œçš„ä¸šåŠ¡ï¼Œè€ŒåƒPHPï¼Œç›´åˆ°çŽ°åœ¨ï¼ŒI/Oæ“ä½œä¹Ÿæ²¡æœ‰æä¾›å¯¹åº”çš„å¼‚æ­¥ç‰ˆæœ¬ï¼Œå¯¹äºŽPHPæ¥è¯´æ¯ä¸ªè¯·æ±‚éƒ½åœ¨php-fpmçš„ä¸€ä¸ªæ–°çº¿ç¨‹é‡Œï¼Œè¿™ä¸ªçº¿ç¨‹é˜»å¡žäº†ä¸å½±å“å…¶ä»–çº¿ç¨‹ï¼Œå¼‚æ­¥ä¹Ÿå°±æ²¡æœ‰é‚£ä¹ˆè¿«åˆ‡ã€‚ å…¶æ¬¡ï¼ŒJavaScriptä½œä¸ºåŠ¨æ€è¯­è¨€ï¼Œå‡½æ•°æ˜¯ä¸€ç­‰ä¸€çš„å…¬æ°‘ï¼Œå¯ä»¥éšæ„å®šä¹‰å‡½æ•°ï¼Œå°†å‡½æ•°ä½œä¸ºå˜é‡ä¼ å€¼ä¼ å‚ï¼Œæžå¤§çš„æ–¹ä¾¿äº†JSerçµæ´»çš„è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹ã€‚åœ¨Cè¯­è¨€é‡Œé¢ï¼Œä¹Ÿæœ‰å¼‚æ­¥ç¼–ç¨‹ï¼Œä¸ç®¡æ˜¯IOCPæ¨¡åž‹è¿˜æ˜¯epoolæ¨¡åž‹ï¼Œä»–ä»¬éƒ½æ˜¯åˆ›å»ºå¤šä¸ªçº¿ç¨‹æ¥ç»Ÿä¸€çš„å¤„ç†å›žè°ƒï¼Œåœ¨æ¯ä¸ªçº¿ç¨‹å‡½æ•°é‡Œç”¨ä¸€ä¸ªæ­»å¾ªçŽ¯ï¼Œåœ¨æ­»å¾ªçŽ¯é‡Œç”¨ä¸€ä¸ªé˜»å¡žçš„çš„æ“ä½œåŽ»ç­‰å¾…å®Œæˆçš„I/Oæ“ä½œã€‚è¿™æ ·çš„è¯ï¼ŒI/Oæ“ä½œå‡½æ•°å’Œå›žè°ƒå‡½æ•°ä¸åœ¨åŒä¸€ä¸ªçº¿ç¨‹é‡Œï¼Œè¿™ä¸ªç»™æµç¨‹æŽ§åˆ¶å¸¦æ¥å¾ˆå¤§çš„ä¸ä¾¿ã€‚Node.jsåº•å±‚è‚¯å®šä¹Ÿæ˜¯ç”¨çš„è¿™ä¸ªæ¥å¤„ç†I/Oçš„ï¼Œä½†è¿™å¯¹äºŽJSeræ¥è¯´æ˜¯é€æ˜Žçš„ï¼Œä¸ç”¨æ“å¿ƒã€‚ å¥½åƒæœ‰ç‚¹è·‘åäº†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹JavaScriptä¸­æœ‰å“ªäº›çµæ´»çš„å¼‚æ­¥ç¼–ç¨‹å§ã€‚ ç¼–ç¨‹ï¼Œå°±æ˜¯ç”±coderå®šå¥½ä»£ç çš„æ‰§è¡Œé¡ºåºï¼Œè®©è®¡ç®—æœºåŽ»è·‘ã€‚é‚£å¯¹äºŽåŒæ­¥æ“ä½œï¼Œè¿™ä¸ªè¿‡ç¨‹å¾ˆç®€å•ã€‚æ¯”å¦‚æ‰§è¡Œæˆ‘ä»¬æœ‰Aå’ŒBæ“ä½œï¼ŒAæ“ä½œå®Œæˆå†æ‰§è¡ŒBï¼Œå¦‚ä¸‹ 12A();B(); è¿™æ ·å°±èƒ½å¾ˆå¥½çš„ä½“çŽ°æµç¨‹ï¼Œä½†æ˜¯å½“Aæ“ä½œæ˜¯ä¸ªå¼‚æ­¥æ“ä½œçš„æ—¶å€™ï¼ŒAæ“ä½œä¸€å¼€å§‹åªæ‰§è¡Œä¸€ä¸ªå‘èµ·çš„æ“ä½œï¼ˆå‘èµ·è¯·æ±‚ï¼Œå‘èµ·ç­‰å¾…ï¼‰ï¼Œè‡³äºŽä»€ä¹ˆæ—¶å€™èƒ½å®Œæˆåªæœ‰AçŸ¥é“ã€‚è¿™æ—¶å€™å¦‚æžœè¿˜æŒ‰å¦‚ä¸Šçš„æ–¹å¼ç»„ç»‡ä»£ç ï¼Œå°±ä¸èƒ½ä¿è¯â€œAæ“ä½œå®Œæˆå†æ‰§è¡ŒBâ€ã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥æŠŠBç›´æŽ¥ç³…åˆè¿›Aã€‚ 1function A()&#123;B()&#125; è¿™æ ·ä»£ç ä¹‹é—´è€¦åˆåº¦å¤ªé«˜ï¼Œå¢žåŠ ä»£ç å¤ç”¨çš„éš¾åº¦ ï¼ŒäºŽæ˜¯æœ‰äº†callbackå½¢å¼ã€‚ callback è¢«å¹¿æ³›åæ§½çš„callbackï¼ŒçœŸæ­£è¯¥è¢«åæ§½çš„åº”è¯¥æ˜¯ä¸åˆæ ¼çš„JSerå§ã€‚ setTimeoutå°±æ˜¯ä¸€ä¸ªå…¸åž‹çš„å¼‚æ­¥æ“ä½œï¼Œå»¶è¿Ÿæ—¶é—´åˆ°äº†æ—¶å€™åªæœ‰setTimeoutè‡ªå·±èƒ½å¾—åˆ°é€šçŸ¥ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä»¥å‡½æ•°çš„å½¢å¼å…ˆå‘Šè¯‰setTimeoutå»¶è¿Ÿæ—¶é—´åˆ°äº†æ—¶å€™æˆ‘ä»¬è¦æ‰§è¡Œä»€ä¹ˆæ“ä½œã€‚ 1234567setTimeout(() =&gt; &#123; console.log(1); console.log(2);&#125;, 1000); æˆ‘ä»¬éƒ½ç”¨setTimeoutæ¥è¡¨ç¤ºå¼‚æ­¥æ“ä½œã€‚ 123456789101112131415161718function A(callback)&#123; console.log('do a start'); setTimeout(() =&gt; &#123; console.log('do a end'); callback(); &#125;, 1000);&#125;function B() &#123; console.log('do b');&#125;A(B); è¿™æ ·ä¿è¯äº†â€œAæ“ä½œå®Œæˆå†æ‰§è¡ŒBâ€ï¼Œä¹Ÿè§£å†³äº†è€¦åˆåº¦é«˜çš„é—®é¢˜ã€‚ ä½†æ˜¯callbackåœ¨æµç¨‹å¤æ‚çš„æƒ…å†µä¸‹ï¼Œéš¾ä»¥è¾¾åˆ°ç†æƒ³ç¼–ç ä½“éªŒï¼›åœ¨æµç¨‹é•¿çš„æƒ…å†µä¸‹ä¼šå½¢æˆå›žè°ƒåœ°ç‹±ï¼Œæµç¨‹éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤ã€‚ Promise callbackçš„é—®é¢˜æ˜¯ä¸‹ä¸€æ­¥çš„æ“ä½œä¸æ˜¯é è¿”å›žå€¼ï¼Œè€Œæ˜¯è¦é callbackæ¥å†³å®šçš„ã€‚è¿™ä¸ªæ˜¯è·ŸåŒæ­¥æ“ä½œæœ€å¤§çš„åŒºåˆ«ï¼Œä¹Ÿæ˜¯å¯¼è‡´callbackçƒ¦æ¼çš„æ ¹æœ¬åŽŸå› ã€‚ Promiseè®©å¼‚æ­¥æ“ä½œçš„çŠ¶æ€è¿”å›žå‡ºæ¥ï¼Œè€Œä¸æ˜¯åœ¨å†…éƒ¨å¤„ç†ï¼Œæ˜¯é“¾å¼è°ƒç”¨çš„åŸºç¡€ï¼Œä¹Ÿç»™ä¹‹åŽåŒæ­¥æ–¹å¼çš„å†™æ³•å¥ å®šåŸºç¡€ã€‚ 12345678910111213function A()&#123; console.log('do a start'); return new Promise((resolve,reject) =&gt; &#123; setTimeout(() =&gt; &#123; console.log('do a end'); resolve(); &#125;,1000) &#125;)&#125;function B()&#123; console.log('do B');&#125;A().then(B) é…åˆdeferï¼ŒPromise.allå’ŒPromise.raceï¼Œä½¿ç”¨Promiseå¯ä»¥å†™å‡ºå¾ˆæ¸…æ™°çš„å¼‚æ­¥æµç¨‹ã€‚ä»Žæœ¬è´¨ä¸Šæ¥è®²ï¼ŒPromiseè¿žæŽ¥äº†å¼‚æ­¥æ“ä½œå’Œæ“ä½œç»“æžœï¼Œåªæ˜¯å°†å›žè°ƒå»¶åŽï¼Œå†é€šè¿‡é“¾å¼è°ƒç”¨è®©æµç¨‹æ›´æ¸…æ™°ã€‚ generator è°ƒç”¨generatorå‡½æ•°ä¸ç«‹å³æ‰§è¡Œï¼Œè°ƒç”¨ä¸€æ¬¡nextæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªyieldï¼Œæ‹¿åˆ°yieldå³è¾¹è¡¨è¾¾å¼çš„å€¼ï¼Œä¸‹æ¬¡è°ƒç”¨nextä¼ çš„å€¼èµ‹å€¼ç»™yieldå·¦è¾¹ã€‚ å¾ˆå°´å°¬å•Šï¼Œå†™å®Œä¸Šé¢ä¸€æ®µè¯ï¼Œè‡ªå·±å†å›žå¤´çœ‹ï¼Œä¹Ÿä¸çŸ¥é“è¯´çš„å•¥ã€‚è¿˜æ˜¯æ¥çœ‹ä»£ç å§ã€‚ 123456789101112131415161718function* generator()&#123; console.log('start'); const res = yield 1 + 3; console.log(res); return res;&#125;const gen = generator();const res1 = gen.next();console.log(res1);const res2 = gen.next(5);console.log(res2); å¯ä»¥çœ‹åˆ°yieldçš„å·¦å€¼ä¸æ˜¯ç­‰äºŽyieldå³è¾¹çš„ç»“æžœï¼Œè€Œæ˜¯ç­‰äºŽä½ ä¸‹ä¸€æ¬¡è°ƒç”¨nextçš„æ—¶å€™ä¼ å…¥çš„å€¼ã€‚è¿™ä¸ªç‰¹æ€§ï¼Œä½¿å¾—generatoré…åˆPromiseï¼Œèƒ½å¾ˆå¥½çš„æŽ§åˆ¶å¼‚æ­¥ã€‚å¦‚æžœyieldå³è¾¹æ˜¯ä¸€ä¸ªPromiseï¼Œåœ¨Promiseçš„çŠ¶æ€å˜æˆresolvedçš„æ—¶å€™è°ƒç”¨ä¸‹ä¸€æ¬¡nextï¼Œä¼ å…¥PromiseValueã€‚ 12345678910111213141516171819202122function sleep(msTime = 1000)&#123; return new Promise((resolve,reject) =&gt; &#123; setTimeout(resolve,msTime); &#125;);&#125;function* generator() &#123; const startTime = Date.now(); yield sleep(1000); console.log(Date.now() - startTime);&#125;const gen = generator();gen.next().value.then((val) =&gt; &#123; gen.next(val);&#125;); è¿™æ ·æ‰€æœ‰çš„æµç¨‹æŽ§åˆ¶çš„å›žè°ƒä»£ç éƒ½è„±ç¦»äº†é€»è¾‘å‡½æ•°æœ¬èº«ï¼Œåœ¨generatoré‡Œï¼ŒåŒæ­¥å’Œå¼‚æ­¥çš„ä»£ç æ··åœ¨ä¸€èµ·äº†ï¼Œä½†æ˜¯æ•´ä¸ªå†™æ³•çœ‹ä¸ŠåŽ»æ˜¯ä¸€ä¸ªåŒæ­¥çš„ï¼Œå¼‚å¸¸çš„æ¸…æ™°ã€‚è€ŒåŽé¢çš„æŽ§åˆ¶ä»£ç ï¼Œå¯ä»¥å†™æˆä¸€ä¸ªé€šç”¨çš„æŽ§åˆ¶å‡½æ•°ï¼Œè®©generatorè‡ªæ‰§è¡Œï¼Œè¿™ä¸ªæ˜¯coæ¨¡å—åšçš„ã€‚ 1234567891011121314import co from 'co';const doSomeThing = co.wrap(function* generator() &#123; const startTime = Date.now(); yield sleep(1000); console.log(Date.now() - startTime);&#125;);doSomeThing(); ä½¿ç”¨coæ¨¡å—yieldå³å€¼å¯ä»¥æ˜¯promiseå’Œtrunkå‡½æ•°ï¼ˆä¸ºä»€ä¹ˆæ˜¯è¿™ä¸¤ä¸ªï¼Ÿå› ä¸ºè¿™ä¸¤ä¸ªéƒ½èƒ½ä»Žå›žæŽ‰é‡Œæ‹¿åˆ°ä¸Šä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„çŠ¶æ€ï¼‰ï¼Œä¸èƒ½æ˜¯åŸºæœ¬ç±»åž‹ï¼Œç¡®å®žä»Žå¼‚æ­¥çš„è§’åº¦è€ƒè™‘yieldå³å€¼æ”¾åŸºæœ¬ç±»åž‹æ²¡æœ‰å•¥æ„ä¹‰ï¼Œä½†æ˜¯å› ä¸ºè¿™ä¸ªæŠ¥é”™æ˜¯æœ‰ç‚¹éš¾ä»¥æŽ¥å—çš„ã€‚è¿˜å€¼å¾—ä¸€æçš„æ˜¯coåšäº†ä¸€äº›å¤„ç†ï¼Œyieldå³å€¼ä¹Ÿå¯ä»¥æ˜¯Arrayå’ŒObjectï¼Œä½†æ˜¯é‡Œé¢çš„å€¼è¿˜æ˜¯å¿…é¡»æ˜¯promiseå’Œtrunkã€‚ async/await async/awaitæ˜¯es2017å‡ºçš„è§„èŒƒï¼Œå¯ä»¥è¯´coå’Œgeneratorçš„è¯­æ³•ç³–ã€‚ä¸ä¸€æ ·çš„æ˜¯awaitçš„å³å€¼å…¼å®¹äº†åŸºæœ¬ç±»åž‹ï¼Œä½†æ˜¯ä¸å†å¤„ç†Arrayå’ŒObjectã€‚ 1234567891011async function doSomeThing() &#123; const startTime = Date.now(); await sleep(1000); console.log(Date.now() - startTime);&#125;doSomeThing(); ä»Žasync/awaitæ¥çœ‹JavaScriptçš„å¼‚æ­¥ç¼–ç¨‹ï¼Œå¯ä»¥è¯´æ˜¯å¾ˆæ¸…æ¥šäº†ï¼ŒåŒæ­¥å’Œå¼‚æ­¥æ— ç¼è¿žæŽ¥ï¼Œå†™èµ·æ¥è¡Œäº‘æµæ°´ï¼Œçœ‹æ¥æ¸…æ™°æ˜Žäº†ã€‚æƒ³å¿…å¤§å®¶éƒ½æƒ³ç”¨async/awaitæ¥æé«˜å·¥ä½œæ•ˆçŽ‡å§ï¼Œé‚£ä¹ˆä½¿ç”¨async/awaitè¦æ³¨æ„ä»€ä¹ˆå‘¢ï¼Ÿ 1.async/awaitç¦»ä¸å¼€Promiseï¼Œä½¿ç”¨Promise.allå’ŒPromise.raceç­‰ä¼˜åŒ–æµç¨‹ã€‚awaitå†™èµ·æ¥å¤ªæ–¹ä¾¿äº†ï¼Œå½“ä¸¤ä¸ªæ“ä½œå¯ä»¥å¹¶è¡Œçš„æ—¶å€™è¿˜è¯·ç”¨Promise.allï¼Œè¿žç»­ä¸¤ä¸ªawaitæ˜¯ä¸²è¡Œçš„æ“ä½œã€‚ 2.asyncå‡½æ•°å§‹ç»ˆè¿”å›žçš„ä¸€ä¸ªPromiseï¼Œå°±ç®—ç®€å•å¦‚ä¸‹å‡½æ•°ã€‚ 12345async function doSomeThing() &#123; return 123;&#125; 3.awaitå³è¾¹å¼‚æ­¥æ“ä½œå˜æˆrejectedçš„æ—¶å€™æŠ›å‡ºé”™è¯¯èƒ½è¢«try/catchæ•æ‰åˆ°ï¼Œè¯·ä¸è¦åå•¬ä½¿ç”¨try/catchã€‚ 4.è¿˜æœ‰ä¸€ç‚¹é‡è¦çš„å¿˜è®°è¯´äº†ï¼Œä¸æ”¯æŒçš„çŽ¯å¢ƒä¸‹è¯·è½¬ç ã€‚ çŽ°åœ¨çš„async/awaitæ¯”è¾ƒå®Œç¾Žäº†ï¼Œçºµè§‚è¿™ä¸ªå˜åŒ–åŽ†ç¨‹ï¼Œå…¶å®žä¹Ÿæ˜¯è›®è¾›é…¸çš„ã€‚åœ¨Callbackçš„è·¯ä¸ŠåšæŒèµ°äº†å¾ˆä¹…ï¼ŒæœŸé—´ä¹Ÿå‡ºäº†wind.jsç­‰åº“ï¼Œæˆ–è€…ä½¿ç”¨trunkå‡½æ•°ï¼Œæˆ–è€…ä½¿ç”¨æµå¼ç¼–ç¨‹çš„rx.jsç­‰ã€‚å¯ä»¥çœ‹åˆ°å…ˆè¾ˆä»¬çš„åŠªåŠ›ï¼Œæ­£æ˜¯ä»–ä»¬çš„åŠªåŠ›å¦‚ä»Šæˆ‘ä»¬å¯ä»¥æ‰å¯ä»¥äº«å—å¦‚æ­¤ç¡•æžœã€‚ trunkå‡½æ•°(é˜®ä¸€å³°è€å¸ˆçš„ä»‹ç»)æ˜¯ä¸ªå¾ˆæœ‰æ„æ€çš„æƒ³æ³•ï¼Œé€šè¿‡æŠŠcallbackå½¢å¼çš„å‡½æ•°æŸ¯é‡ŒåŒ–ï¼Œå¾ˆç®€å•çš„å°±è·Ÿpromiseä¸€æ ·åšåˆ°äº†å»¶è¿Ÿäº†å›žæŽ‰ã€‚é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ç®€å•çš„ç”¨trunkå‡½æ•°æ¥å®žçŽ°é“¾å¼è°ƒç”¨ï¼Œç­”æ¡ˆæ˜¯noã€‚ ä¸æ€•å¤§å®¶ç¬‘è¯ï¼Œå› ä¸ºPromiseçš„thenå¼ºè°ƒçš„è¦è¿”å›žä¸€ä¸ªPromiseï¼Œæ‰€ä»¥ï¼Œåœ¨å†™æœ¬æ–‡ä¹‹å‰æˆ‘è¿˜ä¸€ç›´ä»¥ä¸ºPromiseé“¾å¼è°ƒç”¨æ˜¯ä¾èµ–å›žæŽ‰çš„è¿”å›žå€¼ã€‚å›žæƒ³èµ·æ¥ï¼Œæœ‰ç‚¹å¥½ç¬‘ï¼Œåœ¨ä¸‹ä¸€ä¸ªthenè°ƒç”¨ä¹‹å‰ï¼Œcallbackéƒ½è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œæ€Žä¹ˆå¯èƒ½ä¾èµ–ä»–çš„è¿”å›žå€¼æ¥é“¾å¼è°ƒç”¨å‘¢ã€‚ è¿™è®©æˆ‘ä»¬å›žåˆ°ä¸€ä¸ªç¼–ç¨‹çš„æœ€åŸºæœ¬ï¼Œå°±æ˜¯å®šä¹‰å¥½ä¸€ç³»åˆ—çš„æ“ä½œå’Œæ“ä½œä¹‹å‰çš„å…³ç³»ã€‚ç®€å•çš„æ¥å°†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸€ç³»åˆ—çš„æ“ä½œçœ‹æˆä¸€ä¸ªæ•°ç»„æˆ–è€…è¯´é“¾è¡¨å¯èƒ½æ›´è´´åˆ‡ä¸€ç‚¹ï¼Œæ˜¯ä¸€çŽ¯æ‰£ä¸€çŽ¯çš„ï¼Œç¨‹åºå¼€å§‹æ‰§è¡Œï¼Œæ•°ç»„ç¬¬ä¸€ä¸ªæ“ä½œå®Œæˆï¼Œç„¶åŽæ‰§è¡Œç¬¬äºŒä¸ªæ“ä½œï¼Œä¾æ¬¡ç±»æŽ¨ï¼Œç›´åˆ°æ‰§è¡Œå®Œæ¯•ã€‚ åœ¨å¼‚æ­¥ç¼–ç¨‹é‡Œé¢å¦‚ä½•åº”è¯¥å…³å¿ƒçš„å¤§æ¦‚æœ‰ä¸‰ä¸ªé—®é¢˜ï¼š å¦‚ä½•ç”Ÿæˆè¿™ä¸ªæ•°ç»„ï¼ˆåºåˆ—ï¼‰ å†™æ‰§è¡Œå™¨ï¼Œå¦‚ä½•æœ‰åºçš„æ‰§è¡Œå®Œè¿™ä¸ªæ•°ç»„ï¼Œåœ¨ä¸€ä¸ªæ“ä½œå®Œæˆä¹‹åŽé€šçŸ¥ä¸‹ä¸€ä¸ªæ“ä½œå¼€å§‹æ‰§è¡Œ çœ‹ä¼¼ä¸Šé¢å·²ç»å®Œæˆäº†æ‰€æœ‰é—®é¢˜ï¼Œä½†è¿˜æœ‰ä¸€ä¸ªéšè—é—®é¢˜éœ€è¦è§£å†³ã€‚åœ¨å·²çŸ¥çš„ä»»ä½•äº‹æƒ…ä»Žå®è§‚çš„è§’åº¦æ¥è®²ï¼Œéƒ½æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œä»Žå‰åˆ°åŽçš„æŽ¨ç§»ï¼ŒçŠ¹å¦‚æ—¶é—´çš„æŽ¨ç§»ã€‚ä½†æ˜¯ä»Žå¾®è§‚çš„è§’åº¦ï¼Œå¿…å®šä¼šæœ‰äº‹ä»¶çš„åˆ†æ”¯å’Œåˆæµï¼ˆä¸çŸ¥é“è¿™æ ·è¯´ä¼šä¸ä¼šè¢«æ‰“ï¼‰ã€‚å¦‚ä½•å¤„ç†è¿™ä¸€éƒ¨åˆ†çš„é€»è¾‘ä¹Ÿæ˜¯é‡ä¸­ä¹‹é‡ã€‚ å¯¹ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç›´æŽ¥ç”¨æ•°ç»„ï¼Œå¯ä»¥åˆ—ä¸ºå‡½æ•°çš„å‚æ•°ï¼Œå¯ä»¥åƒPromiseä¸€æ ·é“¾å¼è°ƒç”¨æœ€åŽç»„æˆï¼Œå¥¥è¿˜æœ‰callbackã€‚ åˆ°ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“è”æƒ³åˆ°runSequenceè¿™ç§å‡½æ•°åï¼ŒäºŽæ˜¯é›å½¢å°±æœ‰äº† 1`function runSequence(...seqs) &#123; &#125;` æ‹¿åˆ°seqså°±æ˜¯å¹²ï¼Œä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œå‘—ï¼Œé‡è¦çš„å°±æ˜¯å¦‚ä½•ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œã€‚ä»Žè¿™ä¸€ç‚¹æ¥çœ‹çš„åŒ–ï¼Œæ¯ä¸ªå¼‚æ­¥æ“ä½œéƒ½ä¼šæœ‰callbackï¼Œåªæ˜¯callbackçš„æ—¶æœºå’Œå†™æ³•ä¸ä¸€æ ·ï¼Œæˆ–ä¼˜æˆ–åŠ£ï¼Œä»Žcallbacké‡Œè°ƒç”¨ä¸‹ä¸€æ¬¡æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥æŠŠcallbackæƒ³æˆnextå€Ÿç”¨koaçš„æ€æƒ³æŠŠåºåˆ—æ‰§è¡Œå®Œã€‚è¿™ä¸ªè¦æ±‚æ¯ä¸ªæ“ä½œéƒ½ä¼šè°ƒç”¨å¹¶ä¸”åªè°ƒç”¨ä¸€æ¬¡nextï¼Œä»¥æœ€æ™®é€šcallbackå‡½æ•°ä¸ºä¾‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071function runSequence(...seqs) &#123; let i = 0; const next = (index, ...args) =&gt; &#123; if (i !== index) &#123; console.warn('next call twice'); return; &#125; let arg, callback; if (typeof args[args.length - 1] === 'function') &#123; arg = args.slice(0, args.length - 1); callback = args[args.length - 1]; &#125; else &#123; arg = args; callback = null; &#125; const seq = seqs[i++]; if (!seq) &#123; callback &amp;&amp; callback(null, ...arg); return; &#125; try &#123; seq.call(null, ...arg, ((i, err, ...res) =&gt; &#123; if (err) &#123; callback &amp;&amp; callback(err); &#125; else &#123; next.call(null, i, ...res, callback); &#125; &#125;).bind(null, i)); &#125; catch (err) &#123; callback &amp;&amp; callback(err); &#125; &#125; return (...args) =&gt; &#123; next.call(null, 0, ...args); &#125;&#125; å¤§åŠŸå‘Šæˆï¼Œæˆ‘ä»¬æ¥å†™ä¸€äº›ç®€å•çš„ä¾‹å­æµ‹è¯•ä¸€ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465const res = &#123; a: 'b', b: 'c',&#125;function fetch(key, next) &#123; console.log(`fetch $&#123;key&#125; start`, Date.now() | 0); if (!key) &#123; next('err key'); &#125; setTimeout(() =&gt; &#123; console.log(`fetch $&#123;key&#125; end`, Date.now() | 0); if (!res[key]) &#123; next(`$&#123;key&#125; not found`); &#125; else &#123; next(null, res[key]); &#125; &#125;, 1000);&#125;function runError(next) &#123; throw new Error('erred'); next();&#125;runSequence(fetch, fetch, (data, next) =&gt; &#123; next(null, data + '1'); next(null, data + '2');&#125;, (data, next) =&gt; &#123; console.log(data); next(null, data + '3');&#125;, runError)('a', (err, ...data) =&gt; &#123; console.log(err, ...data, 'finish all');&#125;); logå¦‚ä¸‹ 12345678910111213// fetch a start 5682// fetch a end 6686// fetch b start 6687// fetch b start 6687// c1// Error: erred "finish all"// warn: next call twice çœ‹ä¸ŠåŽ»æ²¡æ¯›ç—…äº†ã€‚æˆ‘ä»¬å¯ä»¥æ¥è§£å†³ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼Œè¿˜æ˜¯æ‹¿æ¥ä¸»ä¹‰ï¼Œå€Ÿé‰´Promise.allå’ŒPromise.raceã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™callbackå†™ä¸€ä¸ªå¯¹åº”çš„allå’Œraceã€‚ç›´æŽ¥è´´ä»£ç  æ€»çš„æ¥è¯´ï¼Œä»»ä½•æ–¹æ¡ˆï¼Œåªè¦æ˜¯æœ‰è§„èŒƒï¼ŒæŒ‰è§„èŒƒèµ°å°±èƒ½å¾ˆå¥½çš„ä¼˜åŒ–è¿™ä¸ªæµç¨‹ã€‚æ¯”å¦‚æœ€åŽä¸€ä¸ªå‡½æ•°æ˜¯callbackï¼Œcallbackæœ€åŽï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯errç­‰ç­‰ã€‚ä½¿ç”¨Promiseä¹Ÿæœ‰ä¸€å®šéµå¾ªçš„ï¼Œå¦‚æžœPromise.resolve(123, 345);ï¼ŒåŽé¢çš„å‚æ•°å°±ä¼šè¢«å¿½ç•¥äº†ï¼Œå¦‚æžœä½¿ç”¨äº†è¿™ä¸€ç‚¹runSequenceä¹Ÿèƒ½ä¼˜åŒ–å¾ˆå¤šã€‚runSequence.allæ•°ç»„é‡Œåªèƒ½ç”¨å‡½æ•°bindçš„å½¢å¼æ¥å†™ï¼Œå°±å¾ˆä¸‘ï¼Œå°±å¯ä»¥ç”¨thunkifyæ¥ä¼˜åŒ–ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªExpressåº”ç”¨]]></title>
    <url>%2F2018%2F04%2F28%2FNode%2F%E6%90%AD%E5%BB%BA%E4%BD%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAExpress%E5%BA%94%E7%94%A8%2F</url>
    <content type="text"><![CDATA[Expressä»‹ç» Express æ˜¯ä¸€ä¸ªç®€æ´è€Œçµæ´»çš„ node.js Webåº”ç”¨æ¡†æž¶, æä¾›ä¸€ç³»åˆ—å¼ºå¤§ç‰¹æ€§å¸®åŠ©ä½ åˆ›å»ºå„ç§Webåº”ç”¨ ä¸°å¯Œçš„HTTPå·¥å…·ä»¥åŠæ¥è‡ªConnectæ¡†æž¶çš„ä¸­é—´ä»¶éšå–éšç”¨ï¼Œåˆ›å»ºå¼ºå¥ã€å‹å¥½çš„APIå˜å¾—å¿«é€Ÿåˆç®€å• Express ä¸å¯¹ node.js å·²æœ‰çš„ç‰¹æ€§è¿›è¡ŒäºŒæ¬¡æŠ½è±¡ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨å®ƒä¹‹ä¸Šæ‰©å±•äº†Webåº”ç”¨æ‰€éœ€çš„åŠŸèƒ½ ä½¿ç”¨ Express å¯ä»¥å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ªå®Œæ•´åŠŸèƒ½çš„ç½‘ç«™ï¼Œå®ƒæœ‰ä¸€å¥—å¥å£®çš„ç‰¹æ€§ï¼Œå¯ç”¨äºŽå¼€å‘å•é¡µã€å¤šé¡µå’Œæ··åˆWebåº”ç”¨ã€‚ å¼€å§‹åœ¨ç¡®è®¤å·²ç»å®‰è£…äº†nodeä¹‹åŽ(ä¸‹è½½), åœ¨ä½ çš„æœºå™¨ä¸Šåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œè®©æˆ‘ä»¬æ¥å¼€å§‹ä½ çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åºå§ 12//æ–°å»ºä¸€ä¸ªç›®å½•æ–‡ä»¶å¤¹,åˆå§‹åŒ–ä¸€ä¸ªpackjson.jsonæ–‡ä»¶ $mkdir express-demo &amp;&amp; cd express-demo &amp;&amp; npm init 12//å®‰è£…Express$ npm install express -g çŽ°åœ¨æˆ‘ä»¬æ¥å†™çœŸæ­£çš„ä»£ç äº†ï¼åˆ›å»ºä¸€ä¸ªåä¸ºapp.js æˆ–è€… server.jsçš„æ–‡ä»¶ï¼Œå«ä»€ä¹ˆçœ‹ä½ ä¸ªäººå–œå¥½äº†ã€‚ è½½å…¥express ç„¶åŽä½¿ç”¨ä»£ç  express()åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨ç¨‹åº: 12var express = require('express');var app = express(); åœ¨è¿™ä¸ªåº”ç”¨ç¨‹åºå®žä¾‹é‡Œï¼Œä½ å¯ä»¥é€šè¿‡ app.VERB()å®šä¹‰è·¯ç”±ï¼Œä¸‹é¢çš„ä¾‹å­æ˜¯â€GET /â€œè¿”å›ž â€œHello Worldâ€ å­—ç¬¦ä¸²ã€‚ req å’Œ res å¯¹è±¡æ˜¯å’ŒnodeåŽŸç”Ÿæä¾›ç»™ä½ çš„ä¸€è‡´çš„ï¼Œä½ ä¹Ÿå¯ä»¥æ‰§è¡Œ res.pipe(), req.on(â€˜dataâ€™, callback) ç­‰ä»»ä½•äº‹æƒ…åœ¨æ²¡æœ‰Expressçš„æƒ…å†µä¸‹å¯ä»¥åšçš„äº‹æƒ…ã€‚ Express ç»™è¿™äº›å¯¹è±¡åŠ äº†ä¸€ä¸ªå°è£…å¥½çš„æ–¹æ³•ï¼Œæ¯”å¦‚ res.send(), å®ƒä¼šå¸®ä½ è®¾ç½®Content-Length: 1234app.get('./',function(req,res)&#123; console.log("GET è¯·æ±‚æˆåŠŸ")ï¼› req.send('Hello Express');&#125;) çŽ°åœ¨æˆ‘ä»¬é€šè¿‡æ‰§è¡Œ app.listen() æ¥ç»‘å®šå¹¶ç›‘å¬è¿žæŽ¥ã€‚ å®ƒæŽ¥å—çš„å‚æ•°å’Œnodenet.Server#listen()çš„æ–¹æ³•ä¸€è‡´: 123app.listen(3000,function()&#123; console.log('Listening on port %d', server.address().port);&#125;) ç„¶åŽåœ¨ç»ˆç«¯æ‰§è¡Œnode app.js æ‰“å¼€3000ç«¯å£çš„é¡µé¢å°±ä¼šçœ‹åˆ°Hello Expressäº† ä½¿ç”¨express-generator å¿«é€Ÿç”Ÿæˆä¸€ä¸ªåº”ç”¨ç¨‹åºå®‰è£…express-generator1$ npm install express-generator -g è¿™ä¸ªå·¥å…·æä¾›äº†ä¸€ä¸ªéžå¸¸ç®€å•çš„ç”Ÿæˆä¸€ä¸ªç¨‹åºéª¨æž¶çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒä¹Ÿæœ‰å±€é™ï¼Œæ¯”å¦‚å®ƒåªæ”¯æŒå¾ˆå°‘çš„å‡ ä¸ªæ¨¡æ¿å¼•æ“Žã€‚ è€Œäº‹å®žä¸ŠExpresså‡ ä¹Žæ”¯æŒæ‰€æœ‰çš„ä¸ºnodeæ‰€å»ºçš„æ¨¡æ¿å¼•æ“Žã€‚ ä½¿ç”¨ â€“helpæŸ¥çœ‹ä¸€ä¸‹å¸®åŠ©: 12345678910Usage: express [options]Options: -h, --help è¾“å‡ºå¸®åŠ©ä¿¡æ¯ -V, --version è¾“å‡ºç‰ˆæœ¬å· -e, --ejs æ·»åŠ  ejs æ¨¡æ¿å¼•æ“Žæ”¯æŒ (é»˜è®¤ä¸ºjade) -H, --hogan æ·»åŠ  hogan.jsæ¨¡æ¿å¼•æ“Žæ”¯æŒ -c, --css æ ·å¼ &lt;å¼•æ“Ž&gt; æ”¯æŒ (less|stylus) (é»˜è®¤ä¸ºcss) -f, --force å¼ºåˆ¶åœ¨éžç©ºç›®å½•æ‰§è¡Œ ä½¿ç”¨1$ express myapp ç”Ÿæˆç›®å½•çš„å¦‚ä¸‹: é»˜è®¤ä¸ºjadeå’Œcssçš„ç»“æž„ å¦‚æžœä½ æƒ³ç”Ÿæˆä¸€ä¸ªæ”¯æŒejs, Stylusçš„åº”ç”¨ç¨‹åºï¼Œåªéœ€è¦ç®€å•çš„æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š åˆ™ç”Ÿæˆçš„ç›®å½•ä¸º app.jsï¼šå¯åŠ¨æ–‡ä»¶ï¼Œæˆ–è€…è¯´å…¥å£æ–‡ä»¶ package.jsonï¼šå­˜å‚¨ç€å·¥ç¨‹çš„ä¿¡æ¯åŠæ¨¡å—ä¾èµ–ï¼Œå½“åœ¨ dependencies ä¸­æ·»åŠ ä¾èµ–çš„æ¨¡å—æ—¶ï¼Œè¿è¡Œnpm installï¼Œnpm ä¼šæ£€æŸ¥å½“å‰ç›®å½•ä¸‹çš„ package.jsonï¼Œå¹¶è‡ªåŠ¨å®‰è£…æ‰€æœ‰æŒ‡å®šçš„æ¨¡å— node_modulesï¼šå­˜æ”¾ package.json ä¸­å®‰è£…çš„æ¨¡å—ï¼Œå½“ä½ åœ¨ package.json æ·»åŠ ä¾èµ–çš„æ¨¡å—å¹¶å®‰è£…åŽï¼Œå­˜æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ publicï¼šå­˜æ”¾ imageã€cssã€js ç­‰æ–‡ä»¶ routesï¼šå­˜æ”¾è·¯ç”±æ–‡ä»¶ viewsï¼šå­˜æ”¾è§†å›¾æ–‡ä»¶æˆ–è€…è¯´æ¨¡ç‰ˆæ–‡ä»¶ binï¼šå­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶ æ‰§è¡Œåº”ç”¨ 123cd myappnpm installDEBUG=myapp:* npm start æ‰“å¼€3000ç«¯å£å°±ä¼šçœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼š è¿™äº›å°±æ˜¯ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºåˆ›å»ºå’Œè¿è¡Œçš„æ‰€æœ‰æ­¥éª¤ã€‚ è®°ä½Expressæ²¡æœ‰é™å®šä»»ä½•çš„ç›®å½•ç»“æž„ï¼Œè¿™åªæ˜¯ä¸€ä¸ªæ–¹ä¾¿ä½ å·¥ä½œçš„åŸºæœ¬ç»“æž„ã€‚ å¦‚æžœä½ æƒ³å¾—åˆ°æ›´å¤šæ€Žä¹ˆç»„ç»‡ç›®å½•ç»“æž„é€‰æ‹©ï¼Œå¯ä»¥æŸ¥çœ‹githubä¸Šçš„ç¤ºä¾‹ã€‚ æŽ¨èæœ€åŽç»™å¤§å®¶æŽ¨èä¸€ä¸ªæ›´è¯¦ç»†çš„ä¾‹å­ï¼šä½¿ç”¨expressæ­å»ºä¸€ä¸ªç®€å•çš„åšå®¢;]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Express</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2017 å¹´å´›èµ·çš„ JS é¡¹ç›®]]></title>
    <url>%2F2018%2F04%2F26%2F%E6%9D%82%E6%96%87%2F2017-%E5%B9%B4%E5%B4%9B%E8%B5%B7%E7%9A%84-JS-%E9%A1%B9%E7%9B%AE%2F</url>
    <content type="text"><![CDATA[æœ€å—æ¬¢è¿Žé¡¹ç›®ä¸‹é¢æ˜¯ä¸åˆ†ç±»åˆ«çš„ 2017 å¹´åº¦æœ€å—æ¬¢è¿Ž Javascript é¡¹ç›®ï¼Œå¦‚æžœä½ æ—¶é—´å¾ˆç´§ï¼Œçœ‹è¿™éƒ¨åˆ†å°±å¤Ÿäº†ã€‚ Vue.js è‰è”å† å†› Vue.js å†æ¬¡å¼ºåŠ¿ç™»é¡¶å¹´åº¦æŽ’è¡Œæ¦œå† å†›ï¼Œä»Šå¹´åœ¨ GitHub ä¸Šæ–°å¢žäº†è¶…è¿‡ 40K çš„ starã€‚ç›¸è¾ƒäºŽ 2016 å¹´çš„ï¼ˆ26K starï¼‰ï¼Œä»Šå¹´ Vue.js é¢†å…ˆæŽ’è¡Œæ¦œç¬¬ 2 åï¼ˆ React ï¼‰çš„ä¼˜åŠ¿æ›´å¤§äº†ã€‚ é‚£ä¹ˆï¼Œæ˜¯ä»€ä¹ˆä»¤ Vue.js å¦‚æ­¤å‡ºä¼—ï¼Ÿ é¦–å…ˆï¼Œå®ƒå­¦ä¹ æ›²çº¿å¹³ç¼“ï¼Œä½¿ç”¨äº†ä¸Ž React ç›¸ä¼¼è¯­æ³•æ›´è®© WEB å¼€å‘è€…ç†Ÿæ‚‰çš„ç»„ä»¶æ–¹æ¡ˆï¼› å‘å±•è‰¯å¥½çš„ç”Ÿæ€åœˆï¼Œç¤¾åŒºä¸­æ¶ŒçŽ°å‡ºäº‹å®žä¸Šçš„å®˜æ–¹æ ‡å‡†åº“ï¼šè·¯ç”±vue-routerï¼ŒçŠ¶æ€ç®¡ç†åº“: Vuexï¼› æŠŠæ¨¡æ¿ã€é€»è¾‘å’Œæ ·å¼æ”¾å…¥å•ä¸ª .vue æ–‡ä»¶ä¸­çš„å•æ–‡ä»¶ç»„ä»¶è®¾è®¡ç†å¿µåœ¨æ¨¡å—åŒ–ä»£è¡Œå…¶é“çš„ä»Šå¤©æ˜¾å¾—éžå¸¸äº²åˆ‡ï¼› è¢«æµè¡Œçš„ PHP æ¡†æž¶ Laravel é€‰ä¸ºé»˜è®¤çš„è§†å›¾å¼•æ“Žï¼ˆView Engineï¼‰ï¼› ä¸º Evan You ä¸ªäººç»´æŠ¤ï¼Œé€šè¿‡ä¼—ç­¹æ–¹å¼æ¥èŽ·å–æ”¯æŒçš„å¼€æºé¡¹ç›®ï¼Œè€Œä¸æ˜¯ç”± Facebook æˆ– Google è¿™æ ·çš„äº’è”ç½‘å·¨å¤´æ¥ä¸»å¯¼ã€‚ ä¹Ÿè®¸æ­£å› ä¸ºä¸Šè¿°æœ€åŽä¸€ç‚¹ï¼ŒVue.js åœ¨ä¸­å›½æ‹¥æœ‰å¤§é‡çš„æ‹¥è¶¸ã€‚ä¸ä»…è¢«ä¸­å›½æœ€å¤§çš„ç”µå•†å¹³å°é˜¿é‡Œå·´å·´ä½¿ç”¨ï¼Œä¹ŸèŽ·å¾—äº† GitLab ä¸Ž Adobe è¿™äº›å…¬å¸é’çã€‚ React å†æ¬¡èŽ·å¾—äºšå†›React å’Œ 2016 ä¸€æ ·ç¨³å ç¬¬äºŒåï¼Œ2017 å¹´å®ƒåœ¨ GitHub ä¸ŠèŽ·å¾—äº†è¶…è¿‡ 27K starï¼ˆå†æ¬¡æ˜Žç¡®ä¸‹ï¼Œæ­¤å¤„æˆ‘ä»¬åˆ†æžçš„æ˜¯ä»Šå¹´æ–°å¢žçš„ star æ•°é‡è€Œéžæ‰€æœ‰çš„ star æ•°é‡ï¼‰ã€‚ Create React Appï¼Œæ˜¯æŽ’è¡Œæ¦œçš„å­£å†›ï¼Œå·²ç»æˆä¸ºæ–°å»º React é¡¹ç›®çš„é¦–é€‰æ–¹å¼ã€‚å®ƒçš„å¤§èŽ·æˆåŠŸè®©ä¸å°‘ React æ ·æ¿é¡¹ç›®ï¼ˆReact Boilerplatesï¼‰æ…¢æ…¢æ·¡å‡ºåŽ†å²èˆžå°ã€‚ Dan Abramovï¼ˆ Redux ä½œè€…ï¼ŒçŽ°å°±èŒäºŽ Facebookï¼‰åˆ›å»º Create React App çš„ç¡®æ˜¯åšäº†ä¸€ä»¶äº†ä¸èµ·çš„å·¥ä½œï¼Œä»–åœ¨åŠŸèƒ½æ€§ä¸Žç®€æ´æ€§ä¹‹é—´å–å¾—äº†å·§å¦™çš„å¹³è¡¡ï¼Œæ¯”å¦‚ï¼Œå®ƒæ²¡æœ‰é›†æˆèŠ±å“¨çš„æ ·å¼è§£å†³æ–¹æ¡ˆï¼ˆåªä½¿ç”¨äº†çº¯ç²¹çš„ CSSï¼‰å’ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œå´å…·æœ‰æ°åˆ°å¥½å¤„çš„å°è£…ï¼Œè¿™äº›é€ å°±äº†è‰¯å¥½çš„å¼€å‘ä½“éªŒã€‚ AxiosAxios åº“æ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„ HTTP å®¢æˆ·ç«¯ã€‚å®ƒèƒ½åŒæ—¶åœ¨ç”¨æˆ·ç«¯ï¼ˆåœ¨ç”¨æˆ·ç«¯å‘èµ· Ajax è¯·æ±‚ï¼‰ä¸ŽæœåŠ¡å™¨ç«¯ï¼ˆåœ¨ Node.js çŽ¯å¢ƒä¸­ï¼‰ä½¿ç”¨ã€‚ Axios çš„æˆåŠŸæˆ–è®¸ä¸Ž Vue.js æœ‰æ¯”è¾ƒå¤§çš„å…³ç³»ï¼Œå› ä¸ºå¤§é‡çš„ Vue.js æ•™ç¨‹éƒ½ä½¿ç”¨å®ƒæ¥å‘èµ· API è¯·æ±‚èŽ·å–æ•°æ®ã€‚ PuppeteerPuppeteer æ˜¯17å¹´çš„å¤§äº‹ä»¶ä¹‹ä¸€ï¼Œæ˜¯ Google Chrome å›¢é˜Ÿå¼€å‘çš„ä¸€ä¸ªæ— ç•Œé¢ Chrome æµè§ˆå™¨ï¼Œå³ä¸€ä¸ªåœ¨åŽå°è¿è¡Œï¼Œä¸”èƒ½è¢«ä»£ç é©±åŠ¨å’ŒæŽ§åˆ¶çš„æµè§ˆå™¨ã€‚ å®ƒå¯ä½œå¦‚ä¸‹ç”¨é€”:åœ¨çœŸå®žæµè§ˆå™¨ä¸­è¿›è¡Œè‡ªåŠ¨åŒ–ç•Œé¢æµ‹è¯•ï¼›ç”¨ç”Ÿæˆé¡µé¢å¿«ç…§çš„æ–¹å¼æ¥å®žçŽ°æœåŠ¡ç«¯æ¸²æŸ“ï¼›åˆ©ç”¨ Google Chrome â€œä¿å­˜ä¸º PDFâ€ çš„åŠŸèƒ½ç”ŸæˆPDFæ–‡ä»¶ï¼› å‰ç«¯æ¡†æž¶å‰ç«¯æ¡†æž¶æ–¹é¢å‘æ¥æ˜¯å…µå®¶å¿…äº‰ä¹‹åœ°ï¼Œä¸è¿‡å¦‚ä»Šå·²å‘ˆä¸‰å®¶é¼Žè¶³åˆ†ç«‹ï¼Œå¤§å±€å°˜åŸƒè½å®šä¹‹åŠ¿ã€‚ Vueã€Reactã€Angular ä¸‰è¶³é¼Žç«‹æ¯«æ— ç–‘é—®ï¼Œç›®å‰å…¬è®¤çš„ 3 å¤§ UI æ¡†æž¶åˆ†åˆ«æ˜¯ Vue.jsï¼ŒReact å’Œ Angular ã€‚ æˆ‘ä»¬ä¹ æƒ¯ç§°ä»–ä»¬ä¸ºæ¡†æž¶ï¼Œä½†å‡†ç¡®åœ°è®²åªæœ‰ Angular æ˜¯æ¡†æž¶ï¼ŒVue.js å’Œ React åº”å½’ç±»ä¸ºåº“ã€‚ å‰æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»åˆ†æžäº† Vue.js çš„æˆåŠŸå› ç´ å’Œå®ƒçš„é›†æˆæ–¹æ¡ˆã€‚ ä¸Ž Vue.js ç›¸å¯¹åº”çš„ï¼ŒReact æ–¹é¢å´ä¾ç„¶å¤„äºŽç¢Žç‰‡åŒ–çš„çŠ¶æ€ï¼Œå¼€å‘è€…éœ€è¦æ ¹æ®è‡ªèº«é¡¹ç›®çš„æƒ…å†µï¼Œè¿›è¡ŒæŠ€æœ¯é€‰åž‹ï¼šé¡µé¢é—´çš„è·¯ç”±åˆ‡æ¢é—®é¢˜ï¼›å¦‚ä½•èŽ·å–æ•°æ®ï¼›å¦‚ä½•æŠŠæ•°æ®ç»‘å®šåˆ°è¡¨å•ï¼›å¦‚ä½•å­˜å‚¨åº”ç”¨çš„çŠ¶æ€ï¼› ç›¸åï¼ŒAngular ç”Ÿæ€åœˆåˆ™æ›´å¯æŽ§ä¹Ÿæ›´ç¨³å®šã€‚æœ‰ä¸€ç§å«Angular å‡†åˆ™ çš„æœ€ä½³å®žè·µç”¨æ¥æŒ‡å¯¼å¼€å‘ã€‚ è¿™å¯èƒ½ç»™äººä¸€ç§ Angular å¯¹äºŽå¤šäººååŒå·¥ä½œæ›´å‹å¥½çš„å°è±¡ã€‚æ­¤å¤–ï¼Œéšç€æ”¯æŒé™æ€ç±»åž‹çš„ TypeScript åŠ å…¥ï¼ŒAngular ä¹ŸåŠ¿å¿…èƒ½å¾—åˆ°æ›´å¤šç†Ÿæ‚‰ C# æˆ– Java çš„åŽç«¯å¼€å‘äººå‘˜äººè§‚æ³¨ä¸Žé’çã€‚ å°‘å³æ˜¯å¤šåœ¨ä¸‰å·¨å¤´ä¹‹åŽï¼Œèƒ½éžå¸¸æœ‰è¶£çš„å‘çŽ°ç¬¬å››å Preactã€‚ Preact æ˜¯ä¸€ä¸ª React çš„å°åž‹æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼šæœ‰ç›¸åŒçš„ APIï¼Œå´åªæœ‰ 3KB çš„å¤§å°ã€‚ ç±»ä¼¼çš„è¿˜æœ‰è®¸å¤šç«žäº‰è€…ï¼Œä¸ºäº†åŒºåˆ«äºŽä¸‰å·¨å¤´ï¼Œå®ƒä»¬åœ¨æµè§ˆå™¨çš„æ€§èƒ½ä¸Šä¸‹åŠŸå¤«ï¼ŒåŠªåŠ›åšå‡ºè‡ªå·±çš„ç‰¹è‰²ã€‚ Node.js æ¡†æž¶JavaScript å·²ä¸ä»…ä»…å±€é™äºŽ Web å‰ç«¯åº”ç”¨ï¼Œä¹Ÿè¢«è¶Šæ¥è¶Šå¤šçš„äººä½¿ç”¨å¼€å‘åŽç«¯åº”ç”¨ã€‚Node.js ç¤¾åŒºé¢‡å…·æœ‰å½±å“åŠ›çš„ Mikeal Rogers åšå‡ºäº† Node.js ä¼šåœ¨ä¸€å¹´å†…è¶…è¶Š Javaçš„é¢„æµ‹ã€‚ å’Œå…¶ä»–è¯­è¨€éƒ½æœ‰äº‹å®žä¸Šçš„æ ‡å‡†æ¡†æž¶ä¸åŒçš„æ˜¯ï¼ˆå¦‚ Ruby æœ‰ Ruby on Railsï¼ŒPython æœ‰ Djangoï¼ŒPHP æœ‰ Laravelï¼‰ï¼Œç›®å‰åŸºäºŽ Node.js å†™æœåŠ¡ç«¯ç¨‹åºè¿˜æ²¡æœ‰ä¸€ä¸ªå¤§å®¶éƒ½è®¤å¯çš„æ ‡å‡†æ¡†æž¶ã€‚ Express å¹¶ä¸æ˜¯ 2017 å¹´åº¦çš„ Node.js æ¡†æž¶åˆ†ç±»æŽ’è¡Œå† å†›ï¼Œæ¯•ç«Ÿè¿™ä¸ªé¡¹ç›®å·²ç»æˆç«‹å¤šå¹´ï¼Œä½†å®ƒå·²è½¬å˜ä¸ºè®¸å¤šæ¡†æž¶å’Œ CMS çš„åŸºç¡€ç»„ä»¶ï¼ŒåŒ…æ‹¬ Feathersã€Keystone å’Œ Nestã€‚ Express çš„æžç®€ä¸»ä¹‰è®¾è®¡ä¼¼ä¹Žå®Œç¾Žåœ°ç¬¦åˆäº†å½“ä»Šå¾®æœåŠ¡ç†å¿µçš„å‘å±•è¶‹åŠ¿ï¼šæŠŠä¸€ä¸ªå¤§åž‹ç¨‹åºè§£è€¦æˆå‡ ä¸ªå°çš„åº”ç”¨ã€‚ ä¸ŽåŽ»å¹´ç›¸æ¯”, ä»Šå¹´æœ‰ 3 ä¸ªæ–°é¢å­”è¿›å…¥äº† node.js æ¡†æž¶åˆ†ç±»æŽ’è¡Œçš„ TOP 10ï¼š Fastify æ˜¯ä¸€ä¸ªå— Hapi å¯å‘è€Œå¼€å‘çš„é€šç”¨ Web æ¡†æž¶ï¼Œä¹Ÿé€‚åˆç”¨ä½œ JSON HTTP API æœåŠ¡å™¨ï¼› Server.js æ³¨é‡äºŽâ€œå¼€ç®±å³ç”¨â€çš„å¼€å‘ä½“éªŒï¼› Nest æ˜¯ä¸€ä¸ªç”¨ TypeScript å†™çš„æ¡†æž¶ï¼Œå…¶æ¨¡å—åŒ–å’ŒæŽ§åˆ¶å™¨ç»„åˆçš„æž¶æž„è®¾è®¡ï¼Œè®© Angular ç”¨æˆ·æ„Ÿåˆ°ååˆ†äº²åˆ‡ã€‚ React ç”Ÿæ€åœˆ React åªä¸“æ³¨äºŽè§†å›¾å±‚ (View Layer)ï¼Œè¿™åœ¨ä¸ºæ•´ä¸ªç”Ÿæ€åœˆç•™ä¸‹æ›´å¤šå‘å±•ç©ºé—´çš„åŒæ—¶ï¼Œä¹Ÿä¸ºè‡ªèº«å¿«é€Ÿå‘å‰å‘å±•åˆ›é€ äº†æœºä¼šã€‚è¿™ä¸ªåˆ†ç±»ä¸‹æˆ‘ä»¬ä¼šç»Ÿè®¡åŸºäºŽ React å’Œ React Native æž„å»ºçš„é¡¹ç›®ã€‚ Create React Appé€šè¿‡é›†æˆä¼˜ç§€çš„é¢„ç½®å’ŒåŒ…ï¼Œè§£å†³äº†æ–°å»º React åº”ç”¨æ—¶è¦è¿›è¡Œç¹çå¤æ‚çš„é…ç½®é—®é¢˜ã€‚ä»Šå¹´ Facebook ä¹Ÿç»§ç»­ä¿æŒäº†é¢‘ç¹æ›´æ–°çš„èŠ‚å¥ï¼Œä½¿ä»–æˆä¸ºç›®å‰ React ç”Ÿæ€ä¸­æœ€æ´»è·ƒçš„é¡¹ç›®ã€‚https://stackblitz.com/ ä½œä¸º Create React App çš„ä¸€ä¸ªæˆåŠŸæ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ StackBlitzï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨çº¿ IDEï¼Œé€šè¿‡ Create React Appï¼Œè®©ä½ åœ¨æ•°ç§’å†…å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­åˆ›å»ºä¸€ä¸ªåº”ç”¨ã€‚ å³ä½¿ Create React App å·²è¢«é»˜è®¤ä¸º React çš„æ–°å»ºå·¥å…·åŒ…ï¼Œå¼€å‘è€…ä»¬ä»ç„¶å¯ä»¥æœ‰å…¶å®ƒé€‰é¡¹ï¼Œä¾‹å¦‚ React boilerplateï¼Œè¿™ä¹Ÿæ˜¯ååˆ†å—äººå…³æ³¨çš„é¡¹ç›®ï¼Œç»§æ‰¿äº†è¯¸å¦‚ GraphQL çš„å¾ˆå¤šæœ‰ç”¨åŠŸèƒ½ã€‚ Ant Designï¼ŒAnt Design Pro å’Œ Material UI æ˜¯ React ç»„ä»¶çš„æ ·å¼å·¥å…·é›†ï¼Œå®ƒä»¬èƒ½å¸®åŠ©ç¨‹åºå‘˜åœ¨æ–°å»ºåº”ç”¨æ—¶è€Œä¸å†æ‹…å¿ƒæ ·å¼é—®é¢˜ã€‚ ç¬¬ 10 å Recompose çš„äººæ°”å€¼ä¹Ÿè¯æ˜Žäº†å¼€å‘è€…ä»¬å–œæ¬¢ React çš„åŽŸå› ï¼šå®ƒçš„â€œå‡½æ•°å¼â€ç‰¹æ€§ï¼Œä¸€åˆ‡çš†å‡½æ•°ã€‚Recompose æä¾›äº†ä¸€å…¨å¥—çš„å‡½æ•°æ¥å¸®åŠ©ä½ èµ°çš„æ›´è¿œã€‚ Vue.js ç”Ÿæ€åœˆ åœ¨ 2017 å¹´ï¼Œä¼´éšç€ Vue.js ç”¨æˆ·çš„å¢žé•¿ï¼Œè®¸å¤š Vue.js ç”Ÿæ€åœˆä¸­çš„é¡¹ç›®ä¹Ÿå¾—åˆ°äº†ä»¤äººæƒŠå–œåœ°å¿«é€Ÿæˆé•¿ã€‚ Element å’Œ iView æ˜¯ä¸¤ä¸ªæœ€å—æ¬¢è¿Žçš„ UI ç»„ä»¶å·¥å…·åŒ…ï¼Œä¸“æ³¨äºŽæ¡Œé¢ç«¯ UI ç•Œé¢çš„å¿«é€Ÿå¼€å‘ã€‚è€Œ Mint UI ä¸Ž vux åˆ™ç›¸åï¼Œæ˜¯ç§»åŠ¨ç«¯æœ€å—æ¬¢è¿Žçš„ UI å·¥å…·åŒ…ã€‚ Vuetify æ˜¯ä¸€æ¬¾åŠŸèƒ½æœ€å®Œå¤‡çš„èƒ½åŒæ—¶é€‚ç”¨äºŽç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯çš„ Material Design ç»„ä»¶æ¡†æž¶å†…ç½®äº†åŒ…æ‹¬æœåŠ¡ç«¯æ¸²æŸ“ã€PWAã€CLI æ¨¡æ¿æ”¯æŒç­‰è¯¸å¤šç‰¹æ€§ã€‚ Nuxt åˆ™æ˜¯ä¸€æ¬¾åŸºäºŽ Vue.js çš„æ›´é«˜çº§çš„æ¡†æž¶ï¼Œå®ƒèƒ½è®©æˆ‘ä»¬æµç•…åœ°å¼€å‘å…·å¤‡æœåŠ¡å™¨ç«¯æ¸²æŸ“èƒ½åŠ›çš„ Vue.js åº”ç”¨ï¼Œè€Œå®ƒçš„é€šç”¨æ€§ä½¿æˆ‘ä»¬èƒ½ç”¨åŒæ ·çš„ä»£ç åº“æ¥æž„å»ºå•é¡µå¼•ç”¨ï¼Œç”šè‡³ç”Ÿæˆé™æ€ç½‘ç«™ã€‚ Weex æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨ Vue.js è¯­æ³•å’Œ API æ¥è¿›è¡ŒåŽŸç”Ÿæ¸²æŸ“çš„ç§»åŠ¨æ¡Œé¢åº”ç”¨å¼€å‘ã€‚å®ƒç”±é˜¿é‡Œå·´å·´å…¬å¸å¼€å‘ï¼Œå¹¶å·²è¿ç”¨äºŽä¸–ç•Œä¸Šä¸€äº›æœ€é«˜é¢‘ä½¿ç”¨çš„ç§»åŠ¨åº”ç”¨ä¸­ï¼Œååˆ†æ³¨é‡æ€§èƒ½é—®é¢˜ä¸Šçš„ä¼˜åŒ–ã€‚ ç§»åŠ¨å¼€å‘ æ— æ‰€ä¸èƒ½çš„ JavaScriptï¼Œè‡ªç„¶å¯å·²ç”¨æ¥ç¼–å†™ç§»åŠ¨åº”ç”¨ï¼Œè¿™æ„ä¸ºç€ä½ å¯ä»¥åœ¨ WEB ç«¯ä¸Ž Native ç«¯å¤ç”¨ä½ çš„ç»„ä»¶ã€‚ åœ¨æœ¬åˆ†ç±»ä¸­ï¼Œæˆ‘ä»¬ä¸º 3 å¤§å‰ç«¯æ¡†æž¶æ‰¾åˆ°äº†å¯¹åº”çš„è§£å†³æ–¹æ¡ˆï¼šReact: React NativeVueï¼šWeex å’Œ QuasarAngularï¼šIonic å’Œ NativeScript ä¸Ž 2016 å¹´ä¸€æ ·ï¼ŒReact Native ä¸¤å¹´è‰è”å¤´åï¼Œå®ƒèƒ½è®©æˆ‘ä»¬ä½¿ç”¨æŠŠ JavaScript ç¼–è¯‘æˆèƒ½å¤Ÿè¿è¡Œåœ¨ iOSã€Android ç”šè‡³æ˜¯ Windows ç³»ç»Ÿçš„åŽŸç”Ÿ APP åº”ç”¨ã€‚ æ­£å¦‚è§†é¢‘ ä½¿ç”¨ React Native æ¥è·¨å¹³å°ç¼–è¯‘APPä¸­æ‰€ç‰¹åˆ«å¼ºè°ƒçš„ï¼šâ€œWrite One, Run Everywhereâ€ çš„æ‰¿è¯ºå·²ç»å˜æˆçŽ°å®žã€‚ ç¼–è¯‘å·¥å…·ï¼šCompilers è¿™é‡Œæˆ‘ä»¬å°†è®¨è®ºé‚£äº›ç¼–è¯‘åˆ°æ ‡å‡† JavaScript ä»£ç çš„è¯­è¨€ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨æ­å»ºè‡ªå·±çš„æž„å»ºå·¥ä½œæµæ—¶éœ€è¦ç¼–è¯‘å™¨å¯èƒ½æœ‰ 2 ä¸ªåŽŸå› ï¼šæƒ³ç«‹å³ä½¿ç”¨æœ€æ–°çš„ JavaScript è¯­è¨€ç‰¹æ€§ï¼Œå¹¶æŠŠå®ƒåº”ç”¨åˆ°å°½å¯èƒ½å¤šçš„æµè§ˆå™¨ä¸­ï¼Œè¿™ç±»éœ€æ±‚è®© Babel èŽ·å¾—äº†æˆåŠŸï¼Œå¾ˆå¤šé¡¹ç›®éƒ½ä¾èµ–äºŽå®ƒï¼›æƒ³ä¸ºè¯­è¨€æ·»åŠ æ–°çš„ç‰¹æ€§ï¼Œæ¯”å¦‚â€œç±»åž‹æ£€æŸ¥â€ï¼›å¯¹ Javascript ç¨‹åºå‘˜è¿›è¡Œåˆ†ç±»æœ‰ä¸ªçƒ­é—¨çš„é—®é¢˜æ˜¯ï¼šä½ æ˜¯ç”¨ç±»åž‹çš„ï¼Œè¿˜æ˜¯ä¸ç”¨ç±»åž‹çš„ï¼Ÿ JavaScript æœ¬èº«å¸¦æœ‰åŸºæœ¬çš„åŠ¨æ€ç±»åž‹ï¼Œä½†ç¼ºä¹é™æ€ç±»åž‹ã€‚è€Œå¾ˆå¤šå¼€å‘è€…å€¾å‘äºŽåœ¨ä»£ç ä¸­ä½¿ç”¨ç±»åž‹ï¼Œå°¤å…¶åœ¨å¤§åž‹é¡¹ç›®ä¸­ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥è®©ä»£ç å˜å¾—æ›´ä¸ºå¥å£®ä¸”æ˜“äºŽé˜…è¯»å’Œç†è§£ã€‚ å¦‚æžœä½ éœ€è¦ç±»åž‹ï¼Œæœ‰ä¸¤ä¸ªä¸»æµå¯é€‰é¡¹ï¼šå¾®è½¯çš„ TypeScript å’Œ Facebook çš„ Flowï¼ˆFacebook åœ¨è‡ªå·±çš„ä¸»è¦é¡¹ç›® Reactï¼ŒReact Nativeï¼ŒJest ä¸­éƒ½æœ‰ä½¿ç”¨) ä½ å¯ä»¥ä»Ž James Kyle çš„æ–‡ç« æ¥æ„Ÿå—ä¸¤è€…çš„åŒºåˆ«: A Comparison Between Adopting Flow or TypeScript æž„å»ºå·¥å…·ï¼šBuild Tools æž„å»ºå·¥å…·åˆ†ç±»ä¸­çš„æŽ’è¡Œå† å†›æ˜¯ Parcelï¼Œè¿™æˆ–è®¸æ˜¯ä»Šå¹´æœ€å¤§çš„æƒŠå–œï¼Œä½œä¸ºä¸€ä¸ª 8 æœˆä»½æ‰åœ¨ GitHub ä¸Šå‘å¸ƒçš„æ–°é¡¹ç›®å´å·²è¾¾åˆ° 14K ä¸ª star çš„å…³æ³¨åº¦ã€‚ Parcel ä¸ä»…æä¾›çŽ°ä»£å‰ç«¯å¼€å‘æ‰€éœ€çš„å„ç§åŠŸèƒ½ï¼Œè¿˜æœ‰ä¸ªç¢¾åŽ‹æ€§çš„ä¼˜åŠ¿ï¼šé›¶é…ç½®ï¼è¿™æ˜¯å®ƒä¸Žä¾é å¤§é‡ â€œloadersâ€ çš„ Webpack æœ€å¤§åŒºåˆ«ã€‚ è¯·åˆ«è¯¯è§£æ•°å­—ï¼ŒWebpack ä¾ç„¶æ˜¯æœ€æµè¡Œçš„æž„å»ºåº”ç”¨ï¼Œå®ƒåœ¨ GitHub ä¸Š æœ‰ 35K çš„ star å’Œè¶… 500 äººçš„è´¡çŒ®è€…ã€‚ç›®å‰æœ‰è®¸å¤šé¡¹ç›®ä½¿ç”¨äº†å®ƒï¼ŒåŒ…æ‹¬ä»Šå¹´æœ€æµè¡Œçš„ä¸¤ä¸ªé¡¹ç›®ï¼šCreate React App å’Œ Gatsbyã€‚ Webpack ä¸æ–­åœ¨è¿­ä»£æ›´æ–°ï¼Œ2.0 ç‰ˆæœ¬å¯ä»¥è®©å¼€å‘è€…é€šè¿‡åŠ¨æ€åŠ è½½çš„æ–¹å¼è½»æ¾å®žçŽ°â€œä»£ç åˆ†å‰²â€çš„åŠŸèƒ½ã€‚ Webpack ä¸Ž Parcel åŒæ—¶å®šä½äºŽæž„å»º WEB åº”ç”¨ï¼Œè€Œ Rollup åˆ™å®šä½äºŽåº“çš„æž„å»ºï¼Œå®ƒä¸“æ³¨äºŽ ES6 æ¨¡å—çš„æ€§èƒ½æå‡ä¸Šã€‚ Rollup å·²è¢«ä¸€äº›ä¸»æµçš„åº“ä½¿ç”¨ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ React å›¢é˜Ÿä¹Ÿåœ¨ 2017 å¹´æŠŠå®ƒä»¬çš„æž„å»ºç³»ç»Ÿä»Ž Browserify åˆ‡æ¢åˆ°äº† Rollupã€‚ åœ¨ React åšå®¢ä¸­æåˆ° Rollup å¯ä»¥é¢„ç¼–è¯‘å¹¶ä¸”é›†æˆåˆ°åº”ç”¨ä¸­ï¼Œèƒ½ä¸Ž React ä¹‹ç±»ç›¸ä¼¼çš„åº“åšåˆ°å®Œç¾Žé…åˆã€‚ Poi ä¸Ž Parcel æœ‰åŒæ ·çš„ç›®æ ‡ï¼šä¸€æ¬¾çŽ°ä»£ç½‘ç»œåº”ç”¨æž„å»ºå·¥å…·ï¼Œå®ƒé»˜è®¤é›¶é…ç½®ä½†ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ preset æ¥æ‰©å±•ã€‚ æµ‹è¯•æ¡†æž¶ Jest æœ€åˆæ˜¯ Facebook å› ä¸º React ç»„ä»¶æµ‹è¯•ç›®çš„è€Œå¼€å‘çš„ï¼Œä½†æœ€è¿‘å‡ ä¸ªæœˆé©å‘½æ€§çš„ç‰ˆæœ¬å˜æ›´ï¼ˆå‘å¸ƒäº† 22 ä¸ªå¤§ç‰ˆæœ¬ï¼‰ä½¿å¾—å®ƒçŽ°åœ¨èƒ½åŒæ—¶ç”¨äºŽæµ‹è¯•å‰ç«¯ã€åŽç«¯ä»£ç ã€‚ Jest æœ‰å‡ ä¸ªå¤§çš„é—ªå…‰ç‚¹ï¼šæ— éœ€é…ç½®ï¼Œé»˜è®¤åœ°è®¾å®šå·²ç»æ»¡è¶³é€šå¸¸éœ€æ±‚ï¼›å¼ºå¤§çš„å¼€å‘è€…ä½“éªŒ (æ™ºèƒ½è§‚å¯Ÿæ¨¡å¼ï¼Œç›´è§‚çš„é”™è¯¯æŠ¥å‘Š)ï¼›è¯­æ³•ä¸Šä¸Ž Mocha å¾ˆæŽ¥è¿‘ï¼Œè®¸å¤šç¨‹åºå‘˜ç†Ÿæ‚‰ describe å’Œ it è¿™æ ·çš„å…³é”®è¯ï¼›ä¸éœ€è¦é¢å¤–çš„åº“æ¥åˆ›å»º assertionsï¼Œå·²å…¨éƒ¨å†…ç½®ï¼›ç‹¬ç‰¹çš„â€å¿«ç…§â€æ¨¡å¼å¯ä»¥ä½œä¸ºé‡æ–°è¿è¡Œæµ‹è¯•æ—¶çš„å¯¹æ¯”åŸºå‡†ï¼› AVAï¼ŒåŽ»å¹´çš„ç¬¬ä¸€åï¼Œä»ç„¶æœ‰è®¸å¤šå¸å¼•äººçš„ç‰¹ç‚¹ã€‚ è¿™ä¸ªé¡¹ç›®ç”± Sindre Sorhus åˆ›å»ºå¹¶åœ¨ä»–æ‰€æœ‰çš„é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œç†Ÿæ‚‰ä»–çš„åŒå­¦è‚¯å®šçŸ¥é“è¿™æ„å‘³ç€ä»€ä¹ˆï¼ ç›¸è¾ƒäºŽ Jestï¼ŒAVA æ›´ä¾§é‡äºŽå¹¶è¡Œæµ‹è¯•ä¸Šçš„é€Ÿåº¦ï¼Œæ›´è½»é‡ï¼Œä¹Ÿæ›´æŽ¥è¿‘æµ‹è¯•æ ‡å‡†ï¼Œè¯­æ³•ä¸Šä¸Žæµ‹è¯•æ¡†æž¶ Tape æŽ¥è¿‘ã€‚ IDE å’Œç¼–è¾‘å™¨ åœ¨è¿™é‡Œæˆ‘ä»¬è®¨è®ºçš„æ˜¯åˆ©ç”¨ WEB æŠ€æœ¯æ¥æž„å»ºçš„å¼€æºçš„ä»£ç ç¼–è¾‘å™¨ï¼ˆ Sublime ç²‰ä¸ä»¬å¯¹ä¸ä½äº†ï¼ï¼‰ã€‚ 2016 å¹´ç”±å¾®è½¯ä¸»å¯¼çš„ VS Code ä¸Ž GitHub ä¸»å¯¼çš„ Atom åœ¨æœ¬ç±»åˆ«ä¸­é½å¤´å¹¶è¿›ã€‚ä»Šå¹´ä»–ä»¬ä¹Ÿä¾ç„¶å¤„äºŽé¢†å…ˆåœ°ä½ï¼Œä¸è¿‡åœ¨äº’ç›¸è¾ƒé‡ä¸­ï¼ŒVS Code å·±é¢†å…ˆå®ƒçš„å¯¹æ‰‹ä¸€å¤§æˆªã€‚ æ¯ä¸ªæœˆ VS Code éƒ½ä¼šå‘å¸ƒæ–°ç‰ˆæœ¬ï¼Œå¸¦æ¥æ›´å¤šå®žç”¨ IDE åŠŸèƒ½åŒæ—¶æ€§èƒ½ä¸Šå´æ²¡æœ‰å¤ªå¤§çš„æŸè€—ã€‚ å³ä½¿ä¸å®‰è£…ä»»ä½•æ’ä»¶ï¼Œä½ ä¹Ÿæœ‰ä¸€å¤§å †å¼€ç®±å³ç”¨çš„åŠŸèƒ½ï¼šGit é›†æˆåŠŸèƒ½ï¼›è‡ªåŠ¨è¡¥å…¨ï¼šJavaScript è¯­æ³•ï¼Œæ–‡ä»¶è·¯å¾„è¿›è¡Œè¡¥å…¨ï¼Œnpm åŒ…åå­—ç­‰ç­‰ï¼›React è¯­æ³•é›†æˆç­‰ï¼› æ­¤å¤–ï¼Œä½ å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­æ·»åŠ  Prettier æ’ä»¶ï¼Œè¿™æ ·æ¯æ¬¡ä¿å­˜æ—¶å®ƒéƒ½ä¼šè‡ªåŠ¨æ ¼å¼åŒ–æ–‡ä»¶ï¼Œåœ¨è¿™æ ·çš„ç¼–ç¨‹çŽ¯å¢ƒä¸‹ç¼–ç çœŸæ˜¯ä¸€ç§äº«å—ã€‚ CSS in JavaScript ç›®å‰ React ç¤¾åŒºä»ç„¶æ²¡æœ‰å°±å¦‚ä½•æœ‰æ•ˆç®¡ç†ç»„ä»¶æ ·å¼è¿™ä¸ªé—®é¢˜è¾¾æˆå…±è¯†ï¼Œå³æ²¡æœ‰æ ‡å‡†çš„è§£å†³æ–¹æ¡ˆã€‚ å¦‚æžœæ— éœ€å¤ªå¤šè‡ªå®šä¹‰çš„æ ‡å‡†æ ·å¼ï¼Œå¯ä»¥ç”¨ Material UI æˆ– Ant Design è¿™æ ·çŽ°æˆçš„ç»„ä»¶å·¥å…·åŒ…ã€‚å¦‚æžœéœ€è¦æ›´é«˜åº¦çµæ´»çš„è‡ªå®šä¹‰ï¼Œä½ ä»ç„¶èƒ½ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼ï¼šç”¨ä¸€ä¸ªåƒ Bootstrap æˆ– Bulma è¿™æ ·çš„å…¨å±€ CSS æ ·å¼ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶çš„ className å±žæ€§æ¥è¾¾åˆ°ç›®çš„ã€‚è¿™æ ·åšç¼ºç‚¹æ˜¯ç»„ä»¶æ— æ³•è¿›è¡Œè‡ªæˆ‘æ ·å¼ç®¡ç†ï¼Œå› ä¸ºæ ·å¼åˆ†å¸ƒåœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚ CSS in JavaScript æ¦‚å¿µçš„å‡ºçŽ°å³æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ã€‚ æ¦‚å¿µæœ¬èº«å¾ˆç®€å•ï¼šæ—¢ç„¶æˆ‘ä»¬åœ¨ React ä¸­å·±èƒ½é€šè¿‡ JavaScript æ¥åŒæ—¶æŽ§åˆ¶é€»è¾‘å’Œæ¨¡æ¿éƒ¨åˆ†ï¼Œä½•ä¸å†è¿›ä¸€æ­¥ï¼Œè¿žæ ·å¼ä¹Ÿä¸€å¹¶ç®¡ç†äº†å‘¢ï¼Ÿ Styled Components æ˜¯ä»Šå¹´æœ¬ç±»åˆ«çš„å† å†›ï¼Œå®ƒåˆ©ç”¨ JavasScript æœ€è¿‘æ–°åŠ å…¥çš„æ¨¡æ¿å­—ç¬¦ä¸²ç‰¹æ€§ï¼Œè®©å¼€å‘è€…åœ¨ React ç»„ä»¶ä¸­ç›´æŽ¥ä½¿ç”¨æ ‡å‡†çš„ CSS è¯­æ³•ç¼–å†™æ ·å¼ã€‚ CSS Modulesï¼Œä½œä¸ºæœ¬ç±»åˆ«çš„äºšå†›ï¼Œåˆ™é‡‡ç”¨äº†æ··åˆçš„è§£å†³æ–¹æ¡ˆã€‚å®ƒè®©å¼€å‘è€…è‡ªå·±æŒ‘é€‰è¯¸å¦‚æ ‡å‡† CSS, SASS, NO slug Less, NO slug Stylusç­‰æ–¹å¼ç¼–å†™æ ·å¼ï¼Œå†ä»¥æ–‡ä»¶çš„æ–¹å¼å¯¼å…¥åˆ°ç»„ä»¶ä¸­ã€‚ Mark Dalgleishï¼ŒCSS Modules çš„ä½œè€…ï¼Œå†™äº†ä¸€ç¯‡æœ‰æ„æ€çš„æ–‡ç« æ¥é˜è¿° CSS-in-JavaScript è§£å†³æ–¹æ¡ˆï¼šA Unified Styling Languageã€‚å¦‚æžœä½ å¯¹ CSS-in-Javascript è§£å†³æ–¹æ¡ˆä»æŒæ€€ç–‘æ€åº¦çš„è¯ï¼Œé‚£æ­¤æ–‡ç»å¯¹ä¸å®¹é”™è¿‡ã€‚ é™æ€ç½‘ç«™ç”Ÿæˆå™¨ é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼ˆSSGï¼ŒStatic Site Generatorï¼‰æ˜¯æŒ‡èƒ½å¤Ÿç”Ÿæˆä¸€å¨ HTMLã€CSSã€JS æ–‡ä»¶ï¼Œæ–¹ä¾¿ä½ å¿«é€Ÿéƒ¨ç½²åˆ° WEB æœåŠ¡å™¨ä¸Šè€Œä¸éœ€è¦å®‰è£…å’Œé…ç½®æ•°æ®åº“çš„å·¥å…·ã€‚ é™æ€ç½‘ç«™å…·æœ‰é€Ÿåº¦å¿«ï¼Œç¨³å®šä¸”æ˜“äºŽç»´æŠ¤çš„ç‰¹ç‚¹ã€‚ä½œä¸º 2016 å¹´çš„äºšå†›ï¼ŒGatsby ä»Šå¹´æˆåŠŸæ‹¨å¾—å¤´ç­¹ã€‚å®ƒæ–°å¢žäº†è®¸å¤šæ–°åŠŸèƒ½æ¥åŠ©ä½ ä¼˜åŒ–é™æ€ç½‘ç«™ï¼š å¿«é€Ÿæµè§ˆå’Œå¯¼å‡ºé€Ÿåº¦ï¼›ä¸»åŠ¨é¢„åŠ è½½æœºèƒ½ï¼›æ™ºèƒ½ä»£ç åˆ†è§£ (æ¨¡æ¿ + ç½‘é¡µæ•°æ®)ï¼›Gatsby ä½¿ç”¨ React æ¥åšè§†å›¾å±‚(View Layer)ï¼Œæž„å»ºæ—¶å€™åˆ™ç”¨ GraphQL æ¥æŸ¥è¯¢å†…å®¹ã€‚å®ƒæœ‰ä¸€ä¸ªå¼ºå¤§çš„ç¤¾åŒºå¹¶ä¸” React å®˜ç½‘ä¹Ÿæ˜¯ç”¨ Gatsby çš„æ¥æ­å»ºçš„. React Static æ˜¯æœ¬ç±»åˆ«çš„æ–°é¢å­”ã€‚å®ƒä»Ž Create React App é¡¹ç›®ä¸­èŽ·å¾—çµæ„Ÿï¼Œå®šä½äºŽåšä¸€ä¸ªè½»é‡çš„ Gatsby æ›¿ä»£æ–¹æ¡ˆï¼Œä¸“æ³¨äºŽæ€§èƒ½å’Œç®€æ´ã€‚ æ­¤å¤–ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ Next.js ä¹Ÿèƒ½å½“é™æ€ç½‘ç«™ç”Ÿæˆå™¨æ¥ç”¨ã€‚ GraphQL åœ¨æœªæ¥å›žé¡¾ GraphQL çš„åŽ†å²æ—¶ï¼Œ2017 å¹´å¾ˆæœ‰å¯èƒ½ä¼šæˆä¸ºä¸€ä¸ªè½¬æŠ˜ç‚¹ã€‚ åƒ the New York Times è¿™æ ·çš„å¤§å…¬å¸å¼€å§‹ä½¿ç”¨ GraphQLï¼ŒRelay å’Œ Apollo (ä¸¤ä¸ªä¸»è¦çš„ GraphQL å®¢æˆ·ç«¯æ¡†æž¶) ä¹Ÿåœ¨ä»Šå¹´å‘å¸ƒäº†ä¸¤ä¸ªé‡è¦çš„ç‰ˆæœ¬æ›´æ–°ã€‚ åœ¨è¿™ä¸¤å¤§åº“çš„èº«åŽï¼Œåƒ Graphcool è¿™æ ·çš„å…¬å¸ä¹Ÿæä¾›äº†å¤§é‡çš„å·¥å…·å’Œåº“ï¼Œè€Œ Vulcan è¿™æ ·çš„å…¨æ ˆæ¡†æž¶ä¹Ÿå¼€å§‹é‡‡ç”¨ GraphQL ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ä»Šå¹´æœ€æœ‰äººæ°”çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ Gatsby ä¹Ÿåœ¨æ•°æ®å¤„ç†ä¸­ä½¿ç”¨äº† GraphQL ã€‚ éšç€è¶Šæ¥è¶Šå¤šçš„äººåŠ å…¥åˆ° GraphQL é˜µè¥æ¥, å¯ä»¥é¢„è§å…¶åœ¨æŠ€æœ¯ä¸Šå¹¿æ³›å–ä»£ REST åªæ˜¯ä¸€ä¸ªæ—¶é—´é—®é¢˜ã€‚ æ€»ç»“å¸Œæœ›æˆ‘ä»¬ä»Šå¹´å¯¹ JavaScript é¢†åŸŸåšå‡ºçš„å›žé¡¾èƒ½å¤Ÿå¯¹ä½ æœ‰æ‰€å¯å‘ã€‚ å¯ä»¥çœ‹åˆ°ï¼ŒVue.js ä¸¤å¹´è‰è”å† å†›å¹¶ä¸”æ²¡æœ‰ä¸æ¯«åœä¸‹æ¥çš„å¾å…†ã€‚ React ç”Ÿæ€åœˆä¹Ÿæœ€ç»ˆè§£å†³äº†è¯ä¹¦é—®é¢˜ï¼Œç»§ç»­ç¹è£å‘å±•çš„åŠ¿å¤´ã€‚ ä½†æ˜¯å¦‚æžœè®©æˆ‘ä»¬è¯„é€‰2017 é¡¹ç›®ä¹‹æ˜Ÿçš„è¯ï¼Œé‚£ç»å¯¹æ˜¯ Prettierã€‚æœ‰äº†å®ƒï¼Œæˆ‘ä»¬å†™ä»£ç æ—¶çš„å†ä¹Ÿä¸ç”¨æ‹…å¿ƒæ ¼å¼é—®é¢˜ï¼ State of JavaScript 2017 survey æ”¶é›†å’Œåˆ†æžäº† 23,000 ä½å¼€å‘è€…çš„è°ƒç ”é—®å·ï¼Œèƒ½å¸®åŠ©ä½ ä»Žå¦ä¸€ä¸ªè§†è§’æ¥è§£è¯»ç¤¾åŒºæ¼”åŒ–çš„æ–¹å‘ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>æ‚æ–‡</category>
      </categories>
      <tags>
        <tag>æ‚æ–‡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[reduxå­¦ä¹ ä¹‹å‡çº§æ°´æžœåº—é¢]]></title>
    <url>%2F2018%2F04%2F25%2FReact%2FRedux%2Fredux%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%8D%87%E7%BA%A7%E6%B0%B4%E6%9E%9C%E5%BA%97%E9%9D%A2%2F</url>
    <content type="text"><![CDATA[ä¼˜é›…çš„å¤„ç† async actioné˜¿å¤§é€šè¿‡è¯·äº†ä¸€ä¸ªé‡‡è´­å‘˜å®Œæˆäº†è€—æ—¶çš„è¿›å£å•†å“çš„å”®å–ã€‚ ä½†æ˜¯ï¼Œé˜¿å¤§åŒæ—¶ä¹Ÿå‘çŽ°äº†ä¸€ä¸ªé—®é¢˜ï¼šé¡¾å®¢è¦ä¹°æ°´æžœç”Ÿé²œçš„è¯éœ€è¦æ‰¾é”€å”®å‘˜ï¼Œè¦ä¹°è¿›å£æ°´æžœç”Ÿé²œçš„è¯è¦æ‰¾é‡‡è´­å‘˜ï¼Œè¿™æ ·çš„è¯ï¼Œé¡¾å®¢éœ€è¦æ‰¾ä¸åŒçš„äººï¼Œå¾ˆéº»çƒ¦ã€‚é˜¿å¤§æƒ³äº†æƒ³ï¼Œèƒ½ä¸èƒ½è®©é¡¾å®¢åªæ‰¾é”€å”®å‘˜ï¼Œç„¶åŽé”€å”®å‘˜å¦‚æžœæœ‰éœ€æ±‚å†æ‰¾é‡‡è´­å‘˜é‡‡è´­å‘¢ã€‚ é˜¿å¤§æƒ³åˆ°äº†åŠžæ³•ï¼Œè®©é”€å”®å‘˜æŠŠæ‰€æœ‰çš„éœ€æ±‚éƒ½å‘Šè¯‰é‡‡è´­å‘˜ï¼Œç„¶åŽé‡‡è´­å‘˜å†ä¼ é€’ç»™æ”¶é“¶å‘˜ï¼Œè¿™æ ·ï¼Œå¦‚æžœæ˜¯éœ€è¦é‡‡è´­çš„æ°´æžœç”Ÿé²œï¼Œå°±å¯ä»¥ç‹¬è‡ªåŽ»å¤„ç†äº†ï¼Œè¿™æ ·å°±éœ€è¦æŠŠé‡‡è´­å‘˜æ”¹æˆè¿™æ ·äº†ï¼š 12345678910111213141516const API = store =&gt; &#123; // å’Œ æ”¶é“¶å‘˜ å¯¹æŽ¥çš„æ–¹å¼ const next = store.dispatch; // æŽ¥ç®¡é”€å”®å‘˜ä¼ æ¥çš„é¡¾å®¢éœ€æ±‚ store.dispatch = action =&gt; &#123; // å¤„ç†å®Œäº†ä¹‹åŽå†å¯¹æŽ¥ æ”¶é“¶å‘˜ switch (action.type) &#123; case 'BUY_IMPORTED_APPLE': fetching(2000, () =&gt; next(action)); break; case 'BUY_IMPORTED_EGG': fetching(3000, () =&gt; next(action)); break; default: next(action); &#125; &#125;&#125;API(store); ç„¶åŽé¡¾å®¢æ¥äº†ä¹‹åŽå°±éƒ½åªç”¨æ‰¾é”€å”®å‘˜äº†ï¼š 12345678910111213141516store.dispatch(buyApple(3));store.dispatch(buyImportedApple(10));store.dispatch(buyEgg(1));store.dispatch(buyImportedEgg(10));store.dispatch(buyApple(4));store.dispatch(buyImportedApple(10));store.dispatch(buyEgg(8));store.dispatch(buyImportedEgg(10));// &#123;"fruit":&#123;"apple":3,"importedApple":0&#125;,"fresh":&#123;"egg":0,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":3,"importedApple":0&#125;,"fresh":&#123;"egg":1,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":0&#125;,"fresh":&#123;"egg":1,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":0&#125;,"fresh":&#123;"egg":9,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":10&#125;,"fresh":&#123;"egg":9,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":20&#125;,"fresh":&#123;"egg":9,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":20&#125;,"fresh":&#123;"egg":9,"importedEgg":10&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":20&#125;,"fresh":&#123;"egg":9,"importedEgg":20&#125;&#125; å›¾è§£ ç¼–å†™å’Œä½¿ç”¨ä¸­é—´ä»¶é˜¿å¤§é€šè¿‡æ”¹å–„æµç¨‹å¯¹æŽ¥å®Œæˆäº†æ°´æžœåº—çš„å‡çº§ã€‚ ä½†æ˜¯é˜¿å¤§åˆæœ‰ä¸€ä¸ªæ–°çš„æƒ³æ³•ï¼Œä»–æƒ³è¯¦ç»†çš„çœ‹çœ‹æ¯ä¸€ä¸ªé¡¾å®¢çš„è´­ä¹°éœ€æ±‚æ¥äº†ä¹‹åŽï¼Œè´¦æœ¬çš„å‰åŽå˜åŒ–ã€‚çœ‹æ¥åˆè¦åŠ ä¸€ä¸ªæ–°è§’è‰²è®°å½•å‘˜äº†ã€‚éš¾é“è¦åƒåŠ é‡‡è´­å‘˜é‚£æ ·æ‰‹åŠ¨çš„ä¸€ä¸ªä¸ªçš„åŠ å—ï¼Ÿé‚£å¯å¤ªéº»çƒ¦äº†ã€‚æ­£å¥½é˜¿å¤§å‘çŽ° redux é‡Œæœ‰ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯ä¸­é—´ä»¶ã€‚ä¸­é—´ä»¶æ˜¯å¹²å˜›çš„å‘¢ï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯æŠŠé¡¾å®¢çš„éœ€æ±‚ä»Žé”€å”®å‘˜åˆ°æ”¶é“¶å‘˜ä¹‹é—´åŠ ä¸Šå„ç§è§’è‰²æ¥å¤„ç†ã€‚æ¯ä¸€ä¸ªè§’è‰²å°±æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ã€‚æŽ¥ä¸‹æ¥é˜¿å¤§å°±å¼€å§‹æ¥å†™ä¸­é—´ä»¶äº†ã€‚ redux ä¸­é—´ä»¶å†™èµ·æ¥å…¶å®žå¾ˆç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªå‡½æ•°è€Œå·²ã€‚æŒ‰ç…§å®ƒçš„è¦æ±‚ã€‚è¿™ä¸ªå‡½æ•°æŽ¥å—ä¸€ä¸ª{ dispatch, getState }å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œç„¶åŽè¿”å›žä¸€ä¸ª action é‚£è¿™æ ·ï¼Œå°±å¯ä»¥æŠŠåŽŸæ¥çš„é‡‡è´­å‘˜ä¹Ÿæ”¹é€ æˆä¸­é—´ä»¶äº†ï¼Œå…¶å®žé‡‡è´­å‘˜å°±æ˜¯æ‹¿åˆ°äº†é¡¾å®¢éœ€æ±‚ä¹‹åŽè®©é¡¾å®¢çš„éœ€æ±‚å»¶è¿Ÿ dispatchï¼Œè¿™ç”¨å»¶è¿Ÿç”¨å‡½æ•°å°±å¯ä»¥åšåˆ°äº†: 123456789101112// next æ˜¯ç”¨ä¸­é—´ä»¶å¢žå¼ºä¹‹åŽçš„ dispatch// dispatch æ˜¯æœ€åŽŸå§‹çš„ store.dispatchconst thunkMiddleware = (&#123; dispatch &#125;) =&gt; next =&gt; action =&gt; &#123; if (typeof action === 'function') &#123; // å‡½æ•°å½¢å¼çš„ action å°±æŠŠ dispatch ç»™è¿™ä¸ª actionï¼Œè®© action å†³å®šä»€ä¹ˆæ—¶å€™ dispatch ï¼ˆæŽ§åˆ¶åè½¬ï¼‰ return action(dispatch); &#125; // æ™®é€šçš„ action å°±ç›´æŽ¥ä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å¤„ç† return next(action);&#125; ç„¶åŽæˆ‘ä»¬å°±éœ€è¦æŠŠåŽŸæ¥çš„é¡¾å®¢éœ€æ±‚æ”¹ä¸€ä¸‹äº†ï¼š 1234567891011121314151617// ä¹°æ°´æžœ - è¿›å£è‹¹æžœfunction buyImportedApple(num) &#123; // è¿”å›žä¸€ä¸ªå‡½æ•°ç±»åž‹çš„ actionï¼Œè¿™ä¸ªå‡½æ•°æŽ¥å— dispatchï¼Œå¯ä»¥å†³å®šä»€ä¹ˆæ—¶å€™ dispatch return dispatch =&gt; API.fetchImportedApple(() =&gt; dispatch(&#123; type: 'BUY_IMPORTED_APPLE', payload: num &#125;));&#125;// ä¹°ç”Ÿé²œ - è¿›å£é¸¡è›‹function buyImportedEgg(num) &#123; return dispatch =&gt; API.fetchImportedEgg(() =&gt; dispatch(&#123; type: 'BUY_IMPORTED_EGG', payload: num &#125;));&#125; ç„¶åŽé‡‡è´­å‘˜å°±å¯ä»¥åªè´Ÿè´£é‡‡è´­äº†ï¼Œæ”¹å›žåŽ»ï¼š 123456789101112131415161718192021222324252627// é‡‡è´­å•†å“ç”Ÿæˆå™¨ï¼Œä¸åŒçš„å•†å“éœ€è¦ä¸åŒçš„æ—¶é—´é‡‡è´­function fetching(time, callback) &#123; // ç”¨å»¶æ—¶æ¨¡æ‹Ÿé‡‡è´­æ—¶é—´ const timer = setTimeout(() =&gt; &#123; clearTimeout(timer); // é‡‡è´­å®Œæˆï¼Œé€šçŸ¥é”€å”®å‘˜ callback(); &#125;, time);&#125;// é‡‡è´­è¿›å£è‹¹æžœéœ€è¦ 2 å¤©ï¼ˆ2sï¼‰function fetchImportedApple(callback) &#123; fetching(2000, callback);&#125;// é‡‡è´­è¿›å£è‹¹æžœéœ€è¦ 3 å¤©ï¼ˆ3sï¼‰function fetchImportedEgg(callback) &#123; fetching(3000, callback);&#125;// é‡‡è´­å‘˜const API = &#123; fetchImportedApple, // é‡‡è´­è¿›å£è‹¹æžœ fetchImportedEgg // é‡‡è´­è¿›å£é¸¡è›‹&#125; ç„¶åŽï¼Œæˆ‘ä»¬åœ¨æ·»åŠ ä¸€ä¸ªè®°å½•å‘˜çš„ä¸­é—´ä»¶ï¼š 12345678const loggerMiddleware = (&#123; getState &#125;) =&gt; next =&gt; action =&gt; &#123; console.log(`state before: $&#123;JSON.stringify(getState())&#125;`); console.log(`action: $&#123;JSON.stringify(action)&#125;`); const result = next(action); console.log(`state after: $&#123;JSON.stringify(getState())&#125;`); console.log('================================================'); return result;&#125; åˆ é™¤æŽ‰åŽŸæ¥çš„ç›‘å¬ï¼š 1//- store.subscribe(() =&gt; console.log(JSON.stringify(store.getState()))); å¥½äº†ï¼ŒæŽ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡ redux çš„ applyMiddleware æ¥ä¸²è”èµ·è¿™äº›ä¸­é—´ä»¶å•¦ã€‚ 1234const &#123; createStore, combineReducers, applyMiddleware &#125; = require('redux');// ä¸­é—´ä»¶çš„è°ƒç”¨é¡ºåºæ˜¯ä»Žå³åˆ°å·¦const store = createStore(reducer, applyMiddleware(thunkMiddleware, loggerMiddleware)); å¥½äº†ï¼Œå¤§åŠŸå‘Šæˆï¼Œå¼€å§‹æœåŠ¡é¡¾å®¢ï¼š 1234567891011store.dispatch(buyApple(3));store.dispatch(buyImportedApple(10));// state before: &#123;"fruit":&#123;"apple":0,"importedApple":0&#125;,"fresh":&#123;"egg":0,"importedEgg":0&#125;&#125;// action: &#123;"type":"BUY_APPLE","payload":3&#125;// state after: &#123;"fruit":&#123;"apple":3,"importedApple":0&#125;,"fresh":&#123;"egg":0,"importedEgg":0&#125;&#125;// ================================================// state before: &#123;"fruit":&#123;"apple":3,"importedApple":0&#125;,"fresh":&#123;"egg":0,"importedEgg":0&#125;&#125;// action: &#123;"type":"BUY_EGG","payload":1&#125;// state after: &#123;"fruit":&#123;"apple":3,"importedApple":0&#125;,"fresh":&#123;"egg":1,"importedEgg":0&#125;&#125;// ================================================ ä¸Šé¢æˆ‘ä»¬å†™çš„ä¸¤ä¸ªä¸­é—´ä»¶å…¶å®žå°±æ˜¯ redux-thunk å’Œ redux-logger çš„ç®€ç‰ˆã€‚åœ¨å®žé™…ä¸­ï¼ŒæŽ¨èä½¿ç”¨å®ƒä»¬ï¼Œä¼šæ›´å¯ä¿¡ã€‚ å›¾è§£ ç¼–å†™ redux ä¸­é—´ä»¶éœ€è¦æŒ‰ç…§è¦æ±‚æ¥ï¼Œè¿”å›žè¿™æ ·çš„å‡½æ•° 123456789// ä¸­é—´ä»¶æŽ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢æœ‰åŽŸå§‹çš„ dispatchï¼Œå’Œ getState æ–¹æ³•ç”¨äºŽèŽ·å– state// ä¸­é—´ä»¶å‡½æ•°è¿”å›žä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æŽ¥å—ä¸€ä¸ª next å‚æ•°ï¼Œè¿™ä¸ª next æ˜¯ä¸‹ä¸€ä¸ªä¸­é—´ä»¶è¦åšçš„äº‹æƒ… action =&gt; &#123; ... &#125;function thunkMiddleware(&#123; dispatch, getState &#125;) &#123; return function(next) &#123; return function(action) &#123; // åšä½ çš„äº‹æƒ… &#125; &#125;&#125; åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Redux</category>
      </categories>
      <tags>
        <tag>Redux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[reduxå­¦ä¹ ä¹‹å¼€åº—å–æ°´æžœ]]></title>
    <url>%2F2018%2F04%2F25%2FReact%2FRedux%2Fredux%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%BC%80%E5%BA%97%E5%8D%96%E6%B0%B4%E6%9E%9C%2F</url>
    <content type="text"><![CDATA[Redux æ˜¯ä»€ä¹ˆæ¯å½“æˆ‘ä»¬è°ˆåŠåˆ° reduxï¼Œå¤§å®¶éƒ½ä¼šè¯´æ˜¯ react çš„çŠ¶æ€ç®¡ç†å·¥å…·ã€‚è¿™ä¹ˆè¯´ç¡®å®žæ²¡é”™ï¼Œæ¯•ç«Ÿ redux é¡¹ç›®ä¹Ÿæ˜¯ React Community ç»„ç»‡ä¸‹çš„ä¸€ä¸ªå­é¡¹ç›®ã€‚è€Œä¸” redux çš„è¯žç”Ÿä¹Ÿæ˜¯å’Œ react è¿™ä¸ª ui åº“æ€¥éœ€ä¸€ä¸ªçŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆæœ‰å¾ˆå¤§çš„è”ç³»ã€‚ä½†æ˜¯ redux å’Œ react å¹¶æ²¡æœ‰ä»»ä½•çš„è€¦åˆã€‚è™½ç„¶å®ƒä»¬ç»å¸¸ä¸€èµ·ç”¨ï¼Œä½†æ˜¯ redux çš„ç”¨é€”å¹¶ä¸å±€é™äºŽ reactï¼Œæˆ–è€…è¯´ï¼Œå’Œ react çš„ç»“åˆåªæ˜¯ redux çš„ä½¿ç”¨æ–¹å¼ä¹‹ä¸€ã€‚ é‚£ä¹ˆæ’‡å¼€ react ä¸è°ˆï¼Œ redux åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ã€‚ åœ¨å®žé™…çš„å¼€å‘å½“ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç¢°åˆ°è¿™æ ·çš„éœ€æ±‚ï¼šç›‘å¬ä¸€ä¸ªäº‹ä»¶ï¼Œå½“äº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸€äº›æƒ³åšçš„äº‹æƒ…ã€‚ reduxåŸºç¡€ç”¨æ³•â€”å–æ°´æžœä¸€å¤©ï¼Œç¨‹åºå‘˜é˜¿å¤§ï¼ˆåŒ–åï¼‰æƒ³è¦åŽ»ä¹°æ°´æžœåƒï¼Œå‘çŽ°å°åŒºå‘¨å›´å±…ç„¶æ²¡æœ‰æ°´æžœåº—ï¼ŒäºŽæ˜¯å°±æ‰“ç®—è‡ªå·±å¼€ä¸€ä¸ªæ°´æžœåº—èµšç‚¹å°é’±ã€‚é˜¿å¤§åˆ†æžäº†ä¸€ä¸‹æ°´æžœåº—çš„è¥ä¸šæ¨¡å¼ã€‚å…¶å®žå°±æ˜¯å¤„ç†æ¯ä¸€ä½é¡¾å®¢çš„éœ€æ±‚ï¼Œç„¶åŽè®°è´¦çœ‹çœ‹æ¯å¤©çš„ç›ˆäºã€‚é‚£ä¹ˆæŠ½è±¡æˆç¨‹åºå°±æ˜¯ç›‘å¬é¡¾å®¢çš„è¡Œä¸ºï¼Œå¹¶æŠŠæ¯ä¸ªè¡Œä¸ºçš„ç»“æžœéƒ½è®°åœ¨è´¦ä¸Šï¼Œè¿™æ­£å¥½æ˜¯ redux æ‰€æ“…é•¿çš„ã€‚é˜¿å¤§èƒ¸æœ‰æˆç«¹ï¼Œè¯´ç€å°±å¼€å§‹å†™äº†èµ·æ¥ï¼š é¦–å…ˆæ¨¡æ‹Ÿé¡¾å®¢çš„è´­ä¹°è¡Œä¸ºï¼š123456const action = &#123; type: 'BUY_APPLE', // ä¹°è‹¹æžœ payload: &#123; count: 2 // ä¹° 2 æ–¤ &#125;&#125; é‚£ä¸åŒçš„é¡¾å®¢è¦çš„æ–¤æ•°å¯èƒ½ä¸åŒï¼ŒäºŽæ˜¯ä»–å†™äº†ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š 123456789101112/** * åªè¦çŸ¥é“æ–¤æ•°å°±å¯ä»¥å¿«é€Ÿç”Ÿæˆé¡¾å®¢çš„å„ç§éœ€æ±‚ * @param &#123;number&#125; num é¡¾å®¢è¦ä¹°çš„æ–¤æ•° */function buyApple(num) &#123; return &#123; type: 'BUY_APPLE', payload: &#123; count: num &#125; &#125;&#125; ç„¶åŽæ˜¯è´¦æœ¬çš„ç»“æž„ï¼Œè®°å½•æ¯å¤©å–äº†å¤šå°‘æ–¤ï¼š 123// è¢«æ‰˜ç®¡çš„æ•°æ® state// è´¦æœ¬ï¼Œä»Šå¤©å·²å–çš„è‹¹æžœï¼š0 æ–¤ï¼›ä¸ºäº†ç®€ä¾¿ï¼Œå°±åªä¸¾ä¸€ä¸ªä¾‹å­ï¼Œäº‹å®žä¸Šè¿˜æœ‰å¾ˆå¤šå…¶ä»–æ°´æžœï¼Œå¤§å®¶è‡ªè¡Œè„‘è¡¥const state = &#123; apple: 0 &#125;; å¥½äº†ï¼ŒçŽ°åœ¨é¡¾å®¢éœ€æ±‚ï¼Œè´¦æœ¬éƒ½æœ‰äº†ï¼Œé‚£è°æ¥è®°è´¦å‘¢ï¼Ÿæ‰€ä»¥é˜¿å¤§è¯·äº†ä¸€ä¸ªæ”¶é“¶å‘˜è´Ÿè´£è®°è´¦ï¼Œå¹¶å‘Šè¯‰ä»–è¿™ä¹ˆè®°è´¦ï¼š 1234567891011121314151617181920/** * ç›‘å¬å‡½æ•° listener * æ”¶é“¶å‘˜åªè¦çŸ¥é“é¡¾å®¢çš„éœ€æ±‚å°±èƒ½æ­£ç¡®çš„æ“ä½œè´¦æœ¬ * @param &#123;object&#125; state è´¦æœ¬ * @param &#123;object&#125; action é¡¾å®¢çš„éœ€æ±‚ */function reducer(state, action) &#123; // æ³¨å†Œ â€˜ä¹°è‹¹æžœâ€™ äº‹ä»¶ // å¦‚æžœæœ‰äººä¹°äº†è‹¹æžœï¼ŒåŠ ä¸Šé¡¾å®¢ä¹°çš„æ–¤æ•°ï¼Œæ›´æ–°è´¦æœ¬ if (action.type === 'BUY_APPLE') &#123; return Object.assign(&#123;&#125;, state, &#123; apple: state.apple + action.payload.count &#125;); &#125; // æ²¡æ³¨å†Œçš„äº‹ä»¶ä¸ä½œå¤„ç† // ä¹°å’±ä»¬åº—é‡Œæ²¡æœ‰çš„ä¸œè¥¿ï¼Œä¸æ›´æ–°è´¦æœ¬ï¼ŒåŽŸæ ·è¿”å›ž return state;&#125; å¥½ï¼Œä¸‡äº‹ä¿±å¤‡ï¼Œå¯ä»¥æ­£å¼çš„ç›‘å¬é¡¾å®¢çš„è´­ä¹°éœ€æ±‚å¹¶æ›´æ–°è´¦æœ¬äº†ï¼š 1234const &#123;createStore&#125; = require('redux');// åˆ›å»ºæ°´æžœåº—éœ€è¦æ”¶é“¶å‘˜ï¼ˆç›‘å¬å‡½æ•° listenerï¼‰å’Œè´¦æœ¬ï¼ˆè¢«æ‰˜ç®¡çš„æ•°æ®ï¼‰const store = createStore(reducer, state); ä¸ä»…å¦‚æ­¤ï¼Œredux è¿˜æä¾›äº†ä¸€ä¸ªåŠŸèƒ½ï¼Œæ¯æœåŠ¡ä¸€ä¸ªé¡¾å®¢ï¼Œéƒ½å¯ä»¥é¢å¤–åšä¸€äº›äº‹æƒ…ï¼ŒäºŽæ˜¯é˜¿å¤§å°±æƒ³çœ‹çœ‹æ¯ç¬”äº¤æ˜“ä¹‹åŽçš„è´¦æœ¬ï¼š 12// store.getState() å¯ä»¥èŽ·å–æœ€æ–°çš„ statestore.subscribe(() =&gt; console.log(JSON.stringify(store.getState()))); å¥½äº†ï¼Œé¡¾å®¢å¼€å§‹æ¥ä¹°æ°´æžœäº†ï¼š 1234// è§¦å‘ç”¨æˆ·è´­ä¹°æ°´æžœçš„äº‹ä»¶// é”€å”®å‘˜å¼€å§‹é”€å”®store.dispatch(buyApple(3)); // &#123;"apple":3&#125;store.dispatch(buyApple(4)); // &#123;"apple":7&#125; åº—é“ºç¨³å®šçš„è¿è¥äº†ä¸‹åŽ»ï¼Œé˜¿å¤§å¿ƒé‡Œç¾Žæ»‹æ»‹~ è®²è§£ä¸è¿‡åœ¨æ­¤ä¹‹å‰è¦å…ˆè¯´ redux ç‰¹åˆ«è®²ç©¶ä¹Ÿæ˜¯ç‰¹åˆ«é‡è¦çš„ 3 ç‚¹ï¼š åªèƒ½æœ‰å”¯ä¸€çš„ store å¯¹è±¡ä¿å­˜æ•´ä¸ªåº”ç”¨çš„ state state æ˜¯åªè¯»çš„ï¼Œåªèƒ½é€šè¿‡ dispatch(action) çš„æ–¹å¼æ¥æ”¹å˜ state reducer å¿…é¡»æ˜¯çº¯å‡½æ•° actionaction æ˜¯è¡Œä¸ºä¿¡æ¯çš„æŠ½è±¡ï¼Œå¯¹è±¡ç±»åž‹ï¼Œå®ƒæè¿°å‘ç”Ÿäº†ä»€ä¹ˆã€‚è¿™ä¸ªå¯¹è±¡å¿…é¡»æœ‰ä¸€ä¸ª type å±žæ€§ï¼Œå¯¹äºŽå¯¹è±¡é‡Œé¢çš„å…¶ä»–å†…å®¹ï¼Œredux ä¸åšé™åˆ¶ã€‚ä½†æ˜¯æŽ¨èç¬¦åˆ Flux Standard Action è§„èŒƒï¼š 1234&#123; type: 'ACTION_TYPE', payload, // action æºå¸¦çš„æ•°æ®&#125; action creatoraction creator é¡¾åæ€ä¹‰å°±æ˜¯ç”¨æ¥åˆ›å»º action çš„ï¼Œaction creator åªç®€å•çš„è¿”å›ž actionã€‚ 123456function createAction(num) &#123; return &#123; type: 'ACTION_TYPE', payload, &#125;&#125; statestate æ˜¯è¢«æ‰˜ç®¡çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡è§¦å‘ç›‘å¬äº‹ä»¶ï¼Œæˆ‘ä»¬è¦æ“ä½œçš„æ•°æ®ã€‚ reducerreducer æ˜¯ç”¨æ¥æŽ§åˆ¶ state æ”¹å˜çš„å‡½æ•°ã€‚action æè¿°äº†å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä½†æ˜¯å¹¶ä¸ä¼šçŸ¥é“ç›¸åº”çš„ state è¯¥æ€Žä¹ˆæ”¹å˜ã€‚å¯¹äºŽä¸åŒçš„ actionï¼Œç›¸åº”çš„ state å˜åŒ–æ˜¯ç”¨ reducer æ¥æè¿°çš„ã€‚ reducer æŽ¥å—ä¸¤ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ stateï¼Œç¬¬äºŒä¸ªæ˜¯ actionï¼Œå¹¶è¿”å›žè®¡ç®—ä¹‹åŽæ–°çš„ stateã€‚reducer å¿…é¡»æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå¯¹äºŽç›¸åŒçš„è¾“å…¥ state å’Œ actionï¼Œä¸€å®šä¼šè¿”å›žç›¸åŒçš„æ–°çš„ stateã€‚ 1nextState = reducer(prevState, action); å› ä¸º reducer æ˜¯çº¯å‡½æ•°ï¼Œæ‰€ä»¥åŽŸæ¥çš„ prevState å¹¶ä¸ä¼šæ”¹å˜ï¼Œæ–°çš„ nextState æ˜¯ä¸€ä¸ªæœ€æ–°çš„å¿«ç…§ã€‚ storestore æ˜¯æŠŠä¸Šé¢ä¸‰ä¸ªå…ƒç´ åˆèµ·æ¥çš„ä¸€ä¸ªå¤§å¯¹è±¡: 12345678&#123; createStore, combineReducers, bindActionCreators, applyMiddleware, compose, __DO_NOT_USE__ActionTypes&#125; å®ƒè´Ÿè´£ï¼š æ‰˜ç®¡åº”ç”¨çš„ state å…è®¸é€šè¿‡ store.getState() æ–¹æ³•è®¿é—®åˆ°æ‰˜ç®¡çš„ state å…è®¸é€šè¿‡ store.dispatch() æ–¹æ³•æ¥è§¦å‘ action æ›´æ–° state å…è®¸é€šè¿‡ store.subscribe() æ³¨å†Œç›‘å¬å‡½æ•°ç›‘å¬æ¯ä¸€æ¬¡çš„ action è§¦å‘ å…è®¸æ³¨é”€é€šè¿‡ store.subscribe() æ–¹æ³•æ³¨å†Œçš„ç›‘å¬å‡½æ•° 12345// æ³¨å†Œconst unsubscribe = store.subscribe(() =&gt; &#123; /** do something */&#125;);// æ³¨é”€unsubscribe(); reduceræ‹†åˆ†è°çŸ¥é“æ°´æžœåº—ç”Ÿæ„è¶Šæ¥è¶Šå¥½ï¼ŒäºŽæ˜¯é˜¿å¤§å¼€å§‹æ‹“å±•ä¸šåŠ¡ï¼Œä¸ä»…å–æ°´æžœï¼Œè¿˜å–èµ·äº†ç”Ÿé²œï¼ŒäºŽæ˜¯æœ‰äº†æ°´æžœéƒ¨å’Œç”Ÿé²œéƒ¨ã€‚ äºŽæ˜¯é˜¿å¤§æƒ³äº†æƒ³æœªæ¥è´­ä¹°ç”Ÿé²œçš„é¡¾å®¢çš„è¡Œä¸ºï¼š 123456789// ä¹°ç”Ÿé²œ - é¸¡è›‹function buyEgg(num) &#123; return &#123; type: 'BUY_EGG', payload: &#123; count: num &#125; &#125;&#125; åˆ†äº†ä¸åŒçš„éƒ¨é—¨ä¹‹åŽï¼Œä¸åŒçš„ä¸šåŠ¡æœ‰ä¸åŒçš„è®°è´¦æ–¹å¼ï¼Œå¾—åˆ†è´¦è®°äº†ï¼Œå¼€æ¥è¦å¢žåŠ ä¸€ä¸ªç”Ÿé²œçš„è®°è´¦æœ¬ï¼š 123const freshState = &#123; egg: 0&#125;; åŽŸæ¥çš„æ°´æžœè´¦æœ¬ä¹Ÿè¦æ”¹ä¸ªåå­—ï¼š 1234//- const state = &#123;+ const fruitsState = &#123; apple: 0 &#125;; ç„¶åŽå¢žåŠ ç”Ÿé²œéƒ¨çš„æ”¶é“¶å‘˜, ç®¡ç†ç”Ÿé²œè´¦æœ¬ freshStateï¼š 123456789// ç”Ÿé²œéƒ¨æ”¶é“¶å‘˜function freshReducer(state = freshState, action) &#123; if (action.type === 'BUY_EGG') &#123; return Object.assign(&#123;&#125;, state, &#123; egg: state.egg + action.payload.count &#125;); &#125; return state;&#125; ç„¶åŽåŽŸæ¥æ°´æžœéƒ¨çš„æ”¶é“¶å‘˜ç®¡ç†æ°´æžœè´¦æœ¬ fruitsState éœ€è¦ä¿®æ”¹ä¸‹ï¼š 12345678910// æ°´æžœéƒ¨æ”¶é“¶å‘˜//- function reducer(state, action) &#123;+ function fruitReducer(state = fruitState, action) &#123; if (action.type === 'BUY_APPLE') &#123; return Object.assign(&#123;&#125;, state, &#123; apple: state.apple + action.payload.count &#125;); &#125; return state; &#125; ä½†æ˜¯é˜¿å¤§å¹¶ä¸æƒ³çœ‹å„ä¸ªéƒ¨é—¨çš„åˆ†è´¦æœ¬ï¼Œä»–åªæƒ³çœ‹ä¸€ä¸ªæ€»è´¦æœ¬å°±å¥½äº†ã€‚åˆšå¥½ redux æä¾›äº† combineReducers åŠŸèƒ½ï¼Œå¯ä»¥æŠŠå„ä¸ªæ”¶é“¶å‘˜ç®¡ç†çš„è´¦æœ¬åˆèµ·æ¥ï¼š 123456789101112131415//- const &#123; createStore &#125; = require('redux');+ const &#123; createStore, combineReducers &#125; = require('redux');// æ€»è´¦æœ¬+ const state = &#123;+ fruits: fruitsReducer,+ fresh: freshReducer+ &#125;;// æ€»æ”¶é“¶å‘˜+ const reducer = combineReducers(state);// åˆ›å»ºæ–°çš„æ°´æžœç”Ÿé²œåº—//- const store = createStore(reducer, state);+ const store = createStore(reducer); è¿™æ ·ï¼Œæ°´æžœç”Ÿé²œåº—å°±å¯ä»¥è¥ä¸šäº†ï¼Œé”€å”®å‘˜åˆå¼€å§‹å¤„ç†é¡¾å®¢çš„è´­ç‰©éœ€æ±‚äº†ï¼š 12345store.dispatch(buyApple(3)); // &#123;"fruit":&#123;"apple":3&#125;,"fresh":&#123;"egg":0&#125;&#125;store.dispatch(buyEgg(1)); // &#123;"fruit":&#123;"apple":3&#125;,"fresh":&#123;"egg":1&#125;&#125;store.dispatch(buyApple(4)); // &#123;"fruit":&#123;"apple":7&#125;,"fresh":&#123;"egg":1&#125;&#125;store.dispatch(buyEgg(8)); // &#123;"fruit":&#123;"apple":7&#125;,"fresh":&#123;"egg":9&#125;&#125;// ... å›¾è§£ï¼š combineReducerså½“ä¸šåŠ¡åœºæ™¯è¶Šæ¥è¶Šå¤æ‚çš„æ—¶å€™ï¼Œstate çš„ç»“æž„ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šå¤æ‚è€Œä¸”åºžå¤§ã€‚å¦‚æžœåªç”¨ä¸€ä¸ª reducer æ¥è®¡ç®— state çš„å˜åŒ–åŠ¿å¿…ä¼šç‰¹åˆ«éº»çƒ¦ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥æŠŠ state é‡Œç‹¬ç«‹çš„æ•°æ®åˆ†ç¦»å‡ºæ¥ï¼Œå•ç‹¬ç”¨ä¸€ä¸ª reducer æ¥è®¡ç®—ï¼Œç„¶åŽå†é€šè¿‡ combineReducers æ–¹æ³•åˆå…¥åˆ° state ä¸­ã€‚combineReducers æŽ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯æœ€ç»ˆçš„ state 1234const reducer = combineReducers(&#123; fruits: fruitsReducer, fresh: freshReducer&#125;); å¤„ç† async actioné˜¿å¤§é€šè¿‡ redux çš„ bindReducers æ–¹æ³•å°†æ°´æžœåº—çš„ä¸šåŠ¡åˆ†æ²»æˆåŠŸï¼Œåº—é“ºä¹Ÿè¶Šåšè¶Šå¤§ã€‚ä»¥è‡³äºŽæœ‰é¡¾å®¢å¼€å§‹æƒ³è¦ä¹°ä¸€äº›è¿›å£çš„æ°´æžœç”Ÿé²œã€‚ é˜¿å¤§è€ƒè™‘äº†ä¸€ä¸‹ï¼Œå†³å®šç»§ç»­æ‹“å±•è¿™ä¸ªåº—é“ºï¼Œä»Žäº‹è¿›å£å•†å“çš„é”€å”®ã€‚é¦–å…ˆæ˜¯é¡¾å®¢çš„éœ€æ±‚è¡Œä¸ºéœ€è¦è´­ä¹°è¿›å£æ°´æžœç”Ÿé²œï¼š 1234567891011121314151617181920// ä¹°æ°´æžœ - è¿›å£è‹¹æžœ+ function buyImportedApple(num) &#123;+ return &#123;+ type: 'BUY_IMPORTED_APPLE',+ payload: &#123;+ num+ &#125;+ &#125;+ &#125;// ä¹°ç”Ÿé²œ - è¿›å£é¸¡è›‹+ function buyImportedEgg(num) &#123;+ return &#123;+ type: 'BUY_IMPORTED_EGG',+ payload: &#123;+ num+ &#125;+ &#125;+ &#125; ç„¶åŽæ°´æžœéƒ¨å’Œç”Ÿé²œéƒ¨çš„è´¦æœ¬ä¹Ÿè¦æ›´æ–°å•¦ï¼š 123456789101112131415// æ°´æžœè´¦æœ¬ const fruitState = &#123; orange: 0, apple: 0, banana: 0,+ importedApple: 0 &#125;; // ç”Ÿé²œè´¦æœ¬ const freshState = &#123; egg: 0, fish: 0, vegetable: 0,+ importedEgg: 0 &#125;; åŒæ ·çš„ï¼Œç›¸åº”éƒ¨é—¨çš„æ”¶é“¶å‘˜ä»¬ä¹Ÿè¦å­¦ä¼šæ€Žä¹ˆå¤„ç†è¿›å£æ°´æžœç”Ÿé²œçš„è®°è´¦ï¼Œä»–ä»¬çš„è®°è´¦æ–¹å¼è¦æ”¹æˆä¸‹é¢è¿™æ ·ï¼š 123456789101112131415161718192021222324252627282930313233// æ°´æžœéƒ¨æ”¶é“¶å‘˜function fruitReducer(state = fruitState, action) &#123; // å¦‚æžœæœ‰äººä¹°äº†ç›¸åº”çš„æ°´æžœï¼Œæ›´æ–°è´¦æœ¬ switch (action.type) &#123; case 'BUY_APPLE': return Object.assign(&#123;&#125;, state, &#123; apple: state.apple + action.payload.count &#125;); case 'BUY_IMPORTED_APPLE': return Object.assign(&#123;&#125;, state, &#123; importedApple: state.importedApple + action.payload.count &#125;); // ä¹°å…¶ä»–çš„ä¸œè¥¿ï¼Œä¸æ›´æ–°è´¦æœ¬ï¼ŒåŽŸæ ·è¿”å›ž default: return state; &#125; ;&#125;// ç”Ÿé²œéƒ¨æ”¶é“¶å‘˜function freshReducer(state = freshState, action) &#123; switch (action.type) &#123; case 'BUY_EGG': return Object.assign(&#123;&#125;, state, &#123; egg: state.egg + action.payload.count &#125;); case 'BUY_IMPORTED_EGG': return Object.assign(&#123;&#125;, state, &#123; importedEgg: state.importedEgg + action.payload.count &#125;); default: return state; &#125; ;&#125; å¯æ˜¯è¿™æ—¶å€™é˜¿å¤§å‘çŽ°ï¼Œè¿›å£æ°´æžœç”Ÿé²œä¸èƒ½å¤§é‡å­˜åœ¨è‡ªå·±ä»“åº“å–ï¼Œå› ä¸ºå®ƒä»¬åˆè´µåˆå®¹æ˜“åï¼Œåªæœ‰å½“é¡¾å®¢éœ€è¦ä¹°çš„æ—¶å€™ï¼Œæ‰èƒ½åŽ»é‡‡è´­è¿™äº›æ°´æžœç”Ÿé²œï¼ŒäºŽæ˜¯é˜¿å¤§åˆé›‡äº†ä¸€ä¸ªé‡‡è´­å‘˜ä¸“é—¨è´Ÿè´£å¤„ç†è¦ä¹°è¿›å£æ°´æžœå’Œç”Ÿé²œçš„é¡¾å®¢ï¼Œç­‰åˆ°è´§äº†å†é€šçŸ¥é”€å”®å‘˜å–è´§ç»™é¡¾å®¢ï¼š 123456789101112131415161718192021222324252627// é‡‡è´­å•†å“ç”Ÿæˆå™¨ï¼Œä¸åŒçš„å•†å“éœ€è¦ä¸åŒçš„æ—¶é—´é‡‡è´­function fetchGoodsGenerator(time, action) &#123; // ç”¨å»¶æ—¶æ¨¡æ‹Ÿé‡‡è´­æ—¶é—´ const timer = setTimeout(() =&gt; &#123; clearTimeout(timer); // é‡‡è´­å®Œæˆï¼Œé€šçŸ¥é”€å”®å‘˜ store.dispatch(action); &#125;, time);&#125;// é‡‡è´­è¿›å£è‹¹æžœéœ€è¦ 2 å¤©ï¼ˆ2sï¼‰function fetchImportedApple(action) &#123; fetchGoodsGenerator(2000, action);&#125;// é‡‡è´­è¿›å£é¸¡è›‹éœ€è¦ 3 å¤©ï¼ˆ3sï¼‰function fetchImportedEgg(action) &#123; fetchGoodsGenerator(3000, action);&#125;// é‡‡è´­å‘˜const API = &#123; fetchImportedApple, // é‡‡è´­è¿›å£è‹¹æžœ fetchImportedEgg // é‡‡è´­è¿›å£é¸¡è›‹&#125; å¥½äº†ï¼Œå¸ƒç½®å®Œäº†ä¹‹åŽï¼Œé¡¾å®¢å¼€å§‹æ¥ä¹°æ°´æžœç”Ÿé²œäº†ï¼š 1234567891011121314151617// é”€å”®å‘˜å¼€å§‹é”€å”®ï¼Œé‡‡è´­å‘˜å¼€å§‹é‡‡è´­store.dispatch(buyApple(3));API.fetchImportedApple(buyImportedApple(10));store.dispatch(buyEgg(1));API.fetchImportedEgg(buyImportedEgg(10));store.dispatch(buyApple(4));API.fetchImportedApple(buyImportedApple(10));store.dispatch(buyEgg(8));API.fetchImportedEgg(buyImportedEgg(10));// &#123;"fruit":&#123;"apple":3,"importedApple":0&#125;,"fresh":&#123;"egg":0,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":3,"importedApple":0&#125;,"fresh":&#123;"egg":1,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":0&#125;,"fresh":&#123;"egg":1,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":0&#125;,"fresh":&#123;"egg":9,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":10&#125;,"fresh":&#123;"egg":9,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":20&#125;,"fresh":&#123;"egg":9,"importedEgg":0&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":20&#125;,"fresh":&#123;"egg":9,"importedEgg":10&#125;&#125;// &#123;"fruit":&#123;"apple":7,"importedApple":20&#125;,"fresh":&#123;"egg":9,"importedEgg":20&#125;&#125; å›¾è§£ åœ¨å®žé™…çš„å¼€å‘å½“ä¸­æˆ‘ä»¬ç»å¸¸ä¼šè°ƒç”¨ä¸€äº› API æŽ¥å£èŽ·å–æ•°æ®æ›´æ–° stateã€‚åˆšå¼€å§‹ä½¿ç”¨ redux çš„ä¸€ä¸ªè¯¯åŒºå°±æ˜¯åœ¨ reducer é‡ŒæŽ¥æ”¶åˆ°å¼‚æ­¥çš„ action ä¹‹åŽï¼Œå°±åœ¨ reducer é‡Œåšå¼‚æ­¥æ“ä½œï¼Œè°ƒç”¨ APIã€‚ä½†æ˜¯è¿™æ ·æ˜¯é”™è¯¯çš„ã€‚reducer åªèƒ½æ˜¯çº¯å‡½æ•°ï¼Œä¸èƒ½æœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚è¿™æ ·æ‰èƒ½ä¿è¯å¯¹äºŽç›¸åŒçš„è¾“å…¥ï¼Œä¸€å®šä¼šæœ‰ç›¸åŒçš„è¾“å‡ºã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Redux</category>
      </categories>
      <tags>
        <tag>Redux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¾ç‰‡æ‡’åŠ è½½è¸©å‘]]></title>
    <url>%2F2018%2F04%2F24%2F%E6%80%A7%E8%83%BD%2F%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD%E8%B8%A9%E5%9D%91%2F</url>
    <content type="text"><![CDATA[åŽŸç†å¯¹ç½‘é¡µåŠ è½½é€Ÿåº¦å½±å“æœ€å¤§çš„å°±æ˜¯å›¾ç‰‡ï¼Œä¸€å¼ æ™®é€šçš„å›¾ç‰‡å¯èƒ½ä¼šæœ‰å¥½å‡  M çš„å¤§å°ï¼Œå½“å›¾ç‰‡å¾ˆå¤šæ—¶ï¼Œç½‘é¡µçš„åŠ è½½é€Ÿåº¦å˜å¾—å¾ˆç¼“æ…¢ã€‚ä¸ºäº†ä¼˜åŒ–ç½‘é¡µæ€§èƒ½ä»¥åŠç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬å¯¹å›¾ç‰‡è¿›è¡Œæ‡’åŠ è½½ã€‚ æ‡’åŠ è½½æ˜¯ä¸€ç§å¯¹ç½‘é¡µæ€§èƒ½ä¼˜åŒ–çš„æ–¹å¼ï¼Œå®ƒçš„åŽŸç†æ˜¯ä¼˜å…ˆåŠ è½½åœ¨å¯è§†åŒºåŸŸå†…çš„å›¾ç‰‡ï¼Œè€Œä¸ä¸€æ¬¡æ€§åŠ è½½æ‰€ä»¥å›¾ç‰‡ã€‚å½“æµè§ˆå™¨æ»šåŠ¨ï¼Œå›¾ç‰‡è¿›å…¥å¯è§†åŒºæ—¶å†åŽ»åŠ è½½å›¾ç‰‡ã€‚é€šè¿‡è®¾ç½®å›¾ç‰‡çš„ src å±žæ€§æ¥è®©æµè§ˆå™¨å‘èµ·å›¾ç‰‡çš„è¯·æ±‚ã€‚å½“è¿™ä¸ªå±žæ€§ä¸ºç©ºæˆ–è€…æ²¡æœ‰æ—¶ï¼Œå°±ä¸ä¼šå‘é€è¯·æ±‚ã€‚ å®žçŽ° æ‡’åŠ è½½çš„å®žçŽ°ä¸»è¦æ˜¯åˆ¤æ–­å½“å‰å›¾ç‰‡æ˜¯å¦åˆ°äº†å¯è§†åŒºåŸŸè¿™ä¸€æ ¸å¿ƒé€»è¾‘ã€‚æˆ‘ä»¬å…ˆæ¥æ•´ç†ä¸€ä¸‹å®žçŽ°æ€è·¯ï¼š1.æ‹¿åˆ°æ‰€æœ‰çš„å›¾ç‰‡ img dom ã€‚2.éåŽ†æ¯ä¸ªå›¾ç‰‡åˆ¤æ–­å½“å‰å›¾ç‰‡æ˜¯å¦åˆ°äº†å¯è§†åŒºèŒƒå›´å†…ã€‚3.å¦‚æžœåˆ°äº†å°±è®¾ç½®å›¾ç‰‡çš„ src å±žæ€§ã€‚4.ç»‘å®š window çš„ scroll äº‹ä»¶ï¼Œå¯¹å…¶è¿›è¡Œäº‹ä»¶ç›‘å¬ã€‚ HTML ç»“æž„1234567891011121314151617181920&lt;div class="container"&gt; &lt;div class="img-area"&gt; &lt;img id="first" data-src="./img/ceng.png" alt=""&gt; &lt;/div&gt; &lt;div class="img-area"&gt; &lt;img data-src="./img/data.png" alt=""&gt; &lt;/div&gt; &lt;div class="img-area"&gt; &lt;img data-src="./img/huaji.png" alt=""&gt; &lt;/div&gt; &lt;div class="img-area"&gt; &lt;img data-src="./img/liqi1.png" alt=""&gt; &lt;/div&gt; &lt;div class="img-area"&gt; &lt;img data-src="./img/liqi2.png" alt=""&gt; &lt;/div&gt; &lt;div class="img-area"&gt; &lt;img data-src="./img/steve-jobs.jpg" alt=""&gt; &lt;/div&gt;&lt;/div&gt; æ­¤æ—¶ img æ ‡ç­¾æ˜¯æ²¡æœ‰ src å±žæ€§çš„ï¼Œæˆ‘ä»¬æŠŠçœŸå®žçš„å›¾ç‰‡åœ°å€æ”¾åœ¨ä¸€ä¸ªå±žæ€§é‡Œï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ HTML5 çš„ data å±žæ€§ï¼Œå°†çœŸå®žåœ°å€æ”¾åœ¨è‡ªå®šä¹‰çš„ data-src ä¸­ã€‚ åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›å…¥äº†å¯è§†åŒºåŸŸæ–¹æ³•ä¸€ç¬¬ä¸€ç§æ–¹æ³•æˆ‘ä»¬é€šè¿‡è®¡ç®—è¯¥å›¾ç‰‡è·ç¦» document é¡¶éƒ¨çš„é«˜åº¦æ˜¯å¦å°äºŽå½“å‰å¯è§†åŒºåŸŸç›¸å¯¹äºŽ document é¡¶éƒ¨é«˜åº¦æ¥åˆ¤æ–­ã€‚ å¯è§†åŒºåŸŸç›¸å¯¹äºŽ document é¡¶éƒ¨é«˜åº¦çš„è®¡ç®—æ–¹æ³•ï¼š 12const clientHeight = document.documentElement.clientHeight; // è§†å£é«˜åº¦ï¼Œä¹Ÿå°±æ˜¯çª—å£çš„é«˜åº¦ã€‚const scrollHeight = document.documentElement.scrollTop + clientHeight; // æ»šåŠ¨æ¡åç§»æ–‡æ¡£é¡¶éƒ¨çš„é«˜åº¦ï¼ˆä¹Ÿå°±æ˜¯æ–‡æ¡£ä»Žé¡¶éƒ¨å¼€å§‹åˆ°å¯è§†åŒºåŸŸè¢«æŠ¹åŽ»çš„é«˜åº¦ï¼‰ + è§†å£é«˜åº¦ ç”»äº†ä¸€å¼ å›¾æ–¹ä¾¿ç†è§£: ç„¶åŽå°±æ˜¯è®¡ç®—è¯¥å›¾ç‰‡è·ç¦»æ–‡æ¡£é¡¶éƒ¨çš„é«˜åº¦ã€‚æœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡å…ƒç´ çš„ offsetTop å±žæ€§æ¥è®¡ç®—ã€‚ä»Žä¸Šå›¾æˆ‘ä»¬äº†è§£åˆ°å…ƒç´ çš„ offsetTop å±žæ€§æ˜¯ç›¸å¯¹äºŽä¸€ä¸ª position ä¸º éž static çš„ç¥–å…ˆå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯ child.offsetParent ã€‚åŒæ—¶éœ€è¦å°†ç¥–å…ˆå…ƒç´ çš„ border è€ƒè™‘åœ¨å†…ï¼Œæˆ‘ä»¬é€šè¿‡child.offsetParent.clientTopå¯ä»¥æ‹¿åˆ°è¾¹æ¡†åŽšåº¦ã€‚ ç”±æ­¤æˆ‘ä»¬å¾—åˆ°å…ƒç´ è·ç¦»æ–‡æ¡£é¡¶éƒ¨çš„é«˜åº¦çš„è®¡ç®—æ–¹æ³•ï¼š 123456789function getTop(el, initVal) &#123; let top = el.offsetTop + initVal; if (el.offsetParent !== null) &#123; top += el.offsetParent.clientTop; return getTop(el.offsetParent, top); &#125; else &#123; return top; &#125;&#125; è¿™é‡Œçš„è¿™ä¸ªæ–¹æ³•ä½¿ç”¨äº† å°¾é€’å½’è°ƒç”¨ ã€‚å¯ä»¥æé«˜é€’å½’æ€§èƒ½ã€‚å½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥ç”¨å¾ªçŽ¯æ¥å®žçŽ°ï¼š 123456789function getTop(el) &#123; let top = el.offsetTop; var parent = el.offsetParent; while(parent !== null) &#123; top += parent.offsetTop + parent.clientTop; parent = parent.offsetParent; &#125; return top;&#125; ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨ element.getBoundingClientRect() API ç›´æŽ¥å¾—åˆ° top å€¼ã€‚ 123var first = document.getElementById('first');getTop(first, 0); // 130console.log(first.getBoundingClientRect().top); // 130 äºŽæ˜¯æˆ‘ä»¬å¾—åˆ°åˆ¤æ–­æ–¹æ³•ï¼š 12345678function inSight(el) &#123; const clientHeight = document.documentElement.clientHeight; const scrollHeight = document.documentElement.scrollTop + clientHeight; // æ–¹æ³•ä¸€ return getTop(el, 0) &lt; scrollHeight; // æ–¹æ³•äºŒ // return el.getBoundingClientRect().top &lt; clientHeight;&#125; æŽ¥ä¸‹æ¥å°±æ˜¯å¯¹æ¯ä¸ªå›¾ç‰‡è¿›è¡Œåˆ¤æ–­å’Œèµ‹å€¼ã€‚ 123456789101112131415function loadImg(el) &#123; if (!el.src) &#123; el.src = el.dataset.src; &#125;&#125;function checkImgs() &#123; const imgs = document.getElementsByTagName('img'); Array.from(imgs).forEach(el =&gt; &#123; if (inSight(el)) &#123; loadImg(el); &#125; &#125;) console.log(count++);&#125; æœ€åŽç»™ window ç»‘å®š onscroll äº‹ä»¶ä»¥åŠ onload äº‹ä»¶ï¼š 12window.addEventListener('scroll', checkImgs, false);window.onload = checkImgs; æˆ‘ä»¬çŸ¥é“ç±»ä¼¼ scroll æˆ– resize è¿™æ ·çš„äº‹ä»¶æµè§ˆå™¨å¯èƒ½åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è§¦å‘å¾ˆå¤šæ¬¡ï¼Œä¸ºäº†æé«˜ç½‘é¡µæ€§èƒ½ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªèŠ‚æµå‡½æ•°æ¥æŽ§åˆ¶å‡½æ•°çš„å¤šæ¬¡è§¦å‘ï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…ï¼ˆå¦‚ 500msï¼‰åªæ‰§è¡Œä¸€æ¬¡å›žè°ƒã€‚ 12345678910111213141516171819202122232425/** * æŒç»­è§¦å‘äº‹ä»¶ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œåªæ‰§è¡Œä¸€æ¬¡äº‹ä»¶ã€‚ * @param fun è¦æ‰§è¡Œçš„å‡½æ•° * @param delay å»¶è¿Ÿæ—¶é—´ * @param time åœ¨ time æ—¶é—´å†…å¿…é¡»æ‰§è¡Œä¸€æ¬¡ */function throttle(fun, delay, time) &#123; var timeout; var previous = +new Date(); return function () &#123; var now = +new Date(); var context = this; var args = arguments; clearTimeout(timeout); if (now - previous &gt;= time) &#123; fun.apply(context, args); previous = now; &#125; else &#123; timeout = setTimeout(function () &#123; fun.apply(context, args); &#125;, delay); &#125; &#125;&#125;window.addEventListener('scroll', throttle(checkImgs, 200, 1000), false); æ–¹æ³•äºŒHTML5 æœ‰ä¸€ä¸ªæ–°çš„ IntersectionObserver APIï¼Œå®ƒå¯ä»¥è‡ªåŠ¨è§‚å¯Ÿå…ƒç´ æ˜¯å¦å¯è§ã€‚ ä¸»è¦ç”¨æ³•ï¼š 12345678910var observer = new IntersectionObserver(callback, option);// å¼€å§‹è§‚å¯Ÿobserver.observe(document.getElementById('first'));// åœæ­¢è§‚å¯Ÿobserver.unobserve(document.getElementById('first'));// å…³é—­è§‚å¯Ÿå™¨observer.disconnect(); ç›®æ ‡çš„å¯è§æ€§å‘ç”Ÿå˜åŒ–æ—¶å°±ä¼šè°ƒç”¨è§‚å¯Ÿå™¨çš„ callbackã€‚ 123456789101112131415161718192021222324function callback(changes: IntersectionObserverEntry[]) &#123; console.log(changes[0])&#125;// IntersectionObserverEntry&#123; time: 29.499999713152647, intersectionRatio: 1, boundingClientRect: DOMRectReadOnly &#123; bottom: 144, height: 4, left: 289, right: 293, top: 140, width: 4, x: 289, y: 140 &#125;, intersectionRect: DOMRectReadOnly, isIntersecting: true, rootBounds: DOMRectReadOnly, target: img#first&#125; è¯¦ç»†é‡Šä¹‰ï¼štimeï¼š å¯è§æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶é—´ï¼Œæ˜¯ä¸€ä¸ªé«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œå•ä½ä¸ºæ¯«ç§’intersectionRatioï¼š ç›®æ ‡å…ƒç´ çš„å¯è§æ¯”ä¾‹ï¼Œå³ intersectionRect å  boundingClientRect çš„æ¯”ä¾‹ï¼Œå®Œå…¨å¯è§æ—¶ä¸º 1 ï¼Œå®Œå…¨ä¸å¯è§æ—¶å°äºŽç­‰äºŽ 0boundingClientRectï¼š ç›®æ ‡å…ƒç´ çš„çŸ©å½¢åŒºåŸŸçš„ä¿¡æ¯intersectionRectï¼š ç›®æ ‡å…ƒç´ ä¸Žè§†å£ï¼ˆæˆ–æ ¹å…ƒç´ ï¼‰çš„äº¤å‰åŒºåŸŸçš„ä¿¡æ¯rootBoundsï¼š æ ¹å…ƒç´ çš„çŸ©å½¢åŒºåŸŸçš„ä¿¡æ¯ï¼ŒgetBoundingClientRect() æ–¹æ³•çš„è¿”å›žå€¼ï¼Œå¦‚æžœæ²¡æœ‰æ ¹å…ƒç´ ï¼ˆå³ç›´æŽ¥ç›¸å¯¹äºŽè§†å£æ»šåŠ¨ï¼‰ï¼Œåˆ™è¿”å›ž nullisIntersectingï¼š æ˜¯å¦è¿›å…¥äº†è§†å£ï¼Œboolean å€¼targetï¼š è¢«è§‚å¯Ÿçš„ç›®æ ‡å…ƒç´ ï¼Œæ˜¯ä¸€ä¸ª DOM èŠ‚ç‚¹å¯¹è±¡ ä½¿ç”¨ IntersectionObserver å®žçŽ°å›¾ç‰‡æ‡’åŠ è½½ï¼š 1234567891011121314151617function query(tag) &#123; return Array.from(document.getElementsByTagName(tag));&#125;var observer = new IntersectionObserver( (changes) =&gt; &#123; changes.forEach((change) =&gt; &#123; if (change.intersectionRatio &gt; 0) &#123; var img = change.target; img.src = img.dataset.src; observer.unobserve(img); &#125; &#125;) &#125;)query('img').forEach((item) =&gt; &#123; observer.observe(item);&#125;) åŽŸæ–‡åœ°å€]]></content>
      <tags>
        <tag>æ€§èƒ½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WEBå‰ç«¯å¼€å‘äººå‘˜é¡»çŸ¥çš„å¸¸è§æµè§ˆå™¨å…¼å®¹é—®é¢˜åŠè§£å†³æŠ€å·§]]></title>
    <url>%2F2018%2F04%2F23%2F%E6%80%A7%E8%83%BD%2FWEB%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E9%A1%BB%E7%9F%A5%E7%9A%84%E5%B8%B8%E8%A7%81%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[ä¸ºä»€ä¹ˆä¼šæœ‰å…¼å®¹é—®é¢˜ï¼Ÿç”±äºŽå¸‚åœºä¸Šæµè§ˆå™¨ç§ç±»ä¼—å¤šï¼Œè€Œä¸åŒæµè§ˆå™¨å…¶å†…æ ¸äº¦ä¸å°½ç›¸åŒï¼Œæ‰€ä»¥å„ä¸ªæµè§ˆå™¨å¯¹ç½‘é¡µçš„è§£æžå°±æœ‰ä¸€å®šå‡ºå…¥ï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´æµè§ˆå™¨å…¼å®¹é—®é¢˜å‡ºçŽ°çš„ä¸»è¦åŽŸå› ï¼Œæˆ‘ä»¬çš„ç½‘é¡µéœ€è¦åœ¨ä¸»æµæµè§ˆå™¨ä¸Šæ­£å¸¸è¿è¡Œï¼Œå°±éœ€è¦åšå¥½æµè§ˆå™¨å…¼å®¹ã€‚ ä½¿ç”¨Tridentå†…æ ¸çš„æµè§ˆå™¨ï¼šIEã€Maxthonã€TTï¼› ä½¿ç”¨Geckoå†…æ ¸çš„æµè§ˆå™¨ï¼šNetcape6åŠä»¥ä¸Šç‰ˆæœ¬ã€FireFoxï¼› ä½¿ç”¨Prestoå†…æ ¸çš„æµè§ˆå™¨ï¼šOpera7åŠä»¥ä¸Šç‰ˆæœ¬ï¼› ä½¿ç”¨Webkitå†…æ ¸çš„æµè§ˆå™¨ï¼šSafariã€Chromeã€‚ è€Œæˆ‘çŽ°åœ¨æ‰€è¯´çš„å…¼å®¹æ€§é—®é¢˜ï¼Œä¸»è¦æ˜¯è¯´IEä¸Žå‡ ä¸ªä¸»æµæµè§ˆå™¨å¦‚firefoxï¼Œgoogleç­‰ã€‚è€Œå¯¹IEæµè§ˆå™¨æ¥è¯´ï¼ŒIE7åˆæ˜¯ä¸ªè·¨åº¦ï¼Œå› ä¸ºä¹‹å‰çš„ç‰ˆæœ¬æ›´æ–°ç”šæ…¢ï¼Œbugç”šå¤šã€‚ä»ŽIE8å¼€å§‹ï¼ŒIEæµè§ˆå™¨æ¸æ¸éµå¾ªæ ‡å‡†ï¼Œåˆ°IE9åŽç”±äºŽå¤§å®¶éƒ½ä¸€è‡´è®¤ä¸ºæ ‡å‡†å¾ˆé‡è¦ï¼Œå¯ä»¥è¯´åœ¨å…¼å®¹æ€§ä¸Šæ¯”è¾ƒå¥½äº†ï¼Œä½†æ˜¯åœ¨ä¸­å›½æ¥è¯´ï¼Œç”±äºŽxpçš„å æœ‰çŽ‡é—®é¢˜ï¼Œä½¿ç”¨IE7ä»¥ä¸‹çš„ç”¨æˆ·ä»ç„¶å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸è€ƒè™‘ä½Žç‰ˆæœ¬æµè§ˆå™¨çš„å…¼å®¹ã€‚ å¯¹æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Œä¸€èˆ¬åˆ†ï¼ŒHTMLï¼ŒJavascriptå…¼å®¹ï¼ŒCSSå…¼å®¹ã€‚ å…¶ä¸­htmlç›¸å…³é—®é¢˜æ¯”è¾ƒå®¹æ˜“å¤„ç†ï¼Œæ— éžæ˜¯é«˜ç‰ˆæœ¬æµè§ˆå™¨ç”¨äº†ä½Žç‰ˆæœ¬æµè§ˆå™¨æ— æ³•è¯†åˆ«çš„å…ƒç´ ï¼Œå¯¼è‡´å…¶ä¸èƒ½è§£æžï¼Œæ‰€ä»¥å¹³æ—¶æ³¨æ„ä¸€ç‚¹å°±æ˜¯ã€‚ç‰¹åˆ«æ˜¯HTML5å¢žåŠ äº†è®¸å¤šæ–°æ ‡ç­¾ï¼Œä½Žç‰ˆæœ¬æµè§ˆå™¨æœ‰ç‚¹å½±å“æ—¶ä»£è¿›æ­¥å•Š é—®é¢˜ä¸€ï¼šä¸åŒæµè§ˆå™¨çš„æ ‡ç­¾é»˜è®¤çš„å¤–è¾¹è·å’Œå†…è¾¹è·ä¸åŒé—®é¢˜ç—‡çŠ¶ï¼šéšä¾¿å†™å‡ ä¸ªæ ‡ç­¾ï¼Œä¸åŠ æ ·å¼æŽ§åˆ¶çš„æƒ…å†µä¸‹ï¼Œå„è‡ªçš„margin å’Œpaddingå·®å¼‚è¾ƒå¤§ã€‚ç¢°åˆ°é¢‘çŽ‡:100%è§£å†³æ–¹æ¡ˆï¼šcssé‡Œ {margin:0;padding:0;}å¤‡æ³¨ï¼šè¿™ä¸ªæ˜¯æœ€å¸¸è§çš„ä¹Ÿæ˜¯æœ€æ˜“è§£å†³çš„ä¸€ä¸ªæµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼Œå‡ ä¹Žæ‰€æœ‰çš„cssæ–‡ä»¶å¼€å¤´éƒ½ä¼šç”¨é€šé…ç¬¦æ¥è®¾ç½®å„ä¸ªæ ‡ç­¾çš„å†…å¤–è¡¥ä¸æ˜¯0ã€‚ é—®é¢˜äºŒï¼šå—å±žæ€§æ ‡ç­¾floatåŽï¼Œåˆæœ‰æ¨ªè¡Œçš„marginæƒ…å†µä¸‹ï¼Œåœ¨ie6æ˜¾ç¤ºmarginæ¯”è®¾ç½®çš„å¤§é—®é¢˜ç—‡çŠ¶:å¸¸è§ç—‡çŠ¶æ˜¯ie6ä¸­åŽé¢çš„ä¸€å—è¢«é¡¶åˆ°ä¸‹ä¸€è¡Œç¢°åˆ°é¢‘çŽ‡ï¼š90%ï¼ˆç¨å¾®å¤æ‚ç‚¹çš„é¡µé¢éƒ½ä¼šç¢°åˆ°ï¼Œfloatå¸ƒå±€æœ€å¸¸è§çš„æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼‰è§£å†³æ–¹æ¡ˆï¼šåœ¨floatçš„æ ‡ç­¾æ ·å¼æŽ§åˆ¶ä¸­åŠ å…¥ display:inline;å°†å…¶è½¬åŒ–ä¸ºè¡Œå†…å±žæ€§å¤‡æ³¨ï¼šæˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯div+csså¸ƒå±€äº†ï¼Œè€Œdivå°±æ˜¯ä¸€ä¸ªå…¸åž‹çš„å—å±žæ€§æ ‡ç­¾ï¼Œæ¨ªå‘å¸ƒå±€çš„æ—¶å€™æˆ‘ä»¬é€šå¸¸éƒ½æ˜¯ç”¨div floatå®žçŽ°çš„ï¼Œæ¨ªå‘çš„é—´è·è®¾ç½®å¦‚æžœç”¨marginå®žçŽ°ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªå¿…ç„¶ä¼šç¢°åˆ°çš„å…¼å®¹æ€§é—®é¢˜ã€‚ é—®é¢˜ä¸‰ï¼šè®¾ç½®è¾ƒå°é«˜åº¦æ ‡ç­¾ï¼ˆä¸€èˆ¬å°äºŽ10pxï¼‰ï¼Œåœ¨ie6ï¼Œie7ï¼Œé¨æ¸¸ä¸­é«˜åº¦è¶…å‡ºè‡ªå·±è®¾ç½®é«˜åº¦é—®é¢˜ç—‡çŠ¶ï¼šie6ã€7å’Œé¨æ¸¸é‡Œè¿™ä¸ªæ ‡ç­¾çš„é«˜åº¦ä¸å—æŽ§åˆ¶ï¼Œè¶…å‡ºè‡ªå·±è®¾ç½®çš„é«˜åº¦ç¢°åˆ°é¢‘çŽ‡ï¼š60%è§£å†³æ–¹æ¡ˆï¼šç»™è¶…å‡ºé«˜åº¦çš„æ ‡ç­¾è®¾ç½®overflow:hidden;æˆ–è€…è®¾ç½®è¡Œé«˜line-height å°äºŽä½ è®¾ç½®çš„é«˜åº¦ã€‚å¤‡æ³¨ï¼šè¿™ç§æƒ…å†µä¸€èˆ¬å‡ºçŽ°åœ¨æˆ‘ä»¬è®¾ç½®å°åœ†è§’èƒŒæ™¯çš„æ ‡ç­¾é‡Œã€‚å‡ºçŽ°è¿™ä¸ªé—®é¢˜çš„åŽŸå› æ˜¯ie8ä¹‹å‰çš„æµè§ˆå™¨éƒ½ä¼šç»™æ ‡ç­¾ä¸€ä¸ªæœ€å°é»˜è®¤çš„è¡Œé«˜çš„é«˜åº¦ã€‚å³ä½¿ä½ çš„æ ‡ç­¾æ˜¯ç©ºçš„ï¼Œè¿™ä¸ªæ ‡ç­¾çš„é«˜åº¦è¿˜æ˜¯ä¼šè¾¾åˆ°é»˜è®¤çš„è¡Œé«˜ã€‚ é—®é¢˜å››ï¼šè¡Œå†…å±žæ€§æ ‡ç­¾ï¼Œè®¾ç½®display:blockåŽé‡‡ç”¨floatå¸ƒå±€ï¼Œåˆæœ‰æ¨ªè¡Œçš„marginçš„æƒ…å†µï¼Œie6é—´è·bugï¼ˆç±»ä¼¼ç¬¬äºŒç§ï¼‰é—®é¢˜ç—‡çŠ¶ï¼šie6é‡Œçš„é—´è·æ¯”è¶…è¿‡è®¾ç½®çš„é—´è·ç¢°åˆ°å‡ çŽ‡ï¼š20%è§£å†³æ–¹æ¡ˆï¼šåœ¨display:block;åŽé¢åŠ å…¥display:inline;display:table;å¤‡æ³¨ï¼šè¡Œå†…å±žæ€§æ ‡ç­¾ï¼Œä¸ºäº†è®¾ç½®å®½é«˜ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®display:block;(é™¤äº†inputæ ‡ç­¾æ¯”è¾ƒç‰¹æ®Š)ã€‚åœ¨ç”¨floatå¸ƒå±€å¹¶æœ‰æ¨ªå‘çš„marginåŽï¼Œåœ¨ie6ä¸‹ï¼Œä»–å°±å…·æœ‰äº†å—å±žæ€§floatåŽçš„æ¨ªå‘marginçš„bugã€‚ä¸è¿‡å› ä¸ºå®ƒæœ¬èº«å°±æ˜¯è¡Œå†…å±žæ€§æ ‡ç­¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å†åŠ ä¸Šdisplay:inlineçš„è¯ï¼Œå®ƒçš„é«˜å®½å°±ä¸å¯è®¾äº†ã€‚è¿™æ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦åœ¨display:inlineåŽé¢åŠ å…¥display:talbeã€‚ å›¾ç‰‡é»˜è®¤æœ‰é—´è·é—®é¢˜ç—‡çŠ¶ï¼šå‡ ä¸ªimgæ ‡ç­¾æ”¾åœ¨ä¸€èµ·çš„æ—¶å€™ï¼Œæœ‰äº›æµè§ˆå™¨ä¼šæœ‰é»˜è®¤çš„é—´è·ï¼ŒåŠ ä¸Šé—®é¢˜ä¸€ä¸­æåˆ°çš„é€šé…ç¬¦ä¹Ÿä¸èµ·ä½œç”¨ã€‚ç¢°åˆ°å‡ çŽ‡ï¼š20%è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨floatå±žæ€§ä¸ºimgå¸ƒå±€å¤‡æ³¨ï¼šå› ä¸ºimgæ ‡ç­¾æ˜¯è¡Œå†…å±žæ€§æ ‡ç­¾ï¼Œæ‰€ä»¥åªè¦ä¸è¶…å‡ºå®¹å™¨å®½åº¦ï¼Œimgæ ‡ç­¾éƒ½ä¼šæŽ’åœ¨ä¸€è¡Œé‡Œï¼Œä½†æ˜¯éƒ¨åˆ†æµè§ˆå™¨çš„imgæ ‡ç­¾ä¹‹é—´ä¼šæœ‰ä¸ªé—´è·ã€‚åŽ»æŽ‰è¿™ä¸ªé—´è·ä½¿ç”¨floatæ˜¯æ­£é“ æ ‡ç­¾æœ€ä½Žé«˜åº¦è®¾ç½®min-heightä¸å…¼å®¹é—®é¢˜ç—‡çŠ¶ï¼šå› ä¸ºmin-heightæœ¬èº«å°±æ˜¯ä¸€ä¸ªä¸å…¼å®¹çš„csså±žæ€§ï¼Œæ‰€ä»¥è®¾ç½®min-heightæ—¶ä¸èƒ½å¾ˆå¥½çš„è¢«å„ä¸ªæµè§ˆå™¨å…¼å®¹ç¢°åˆ°å‡ çŽ‡ï¼š5%è§£å†³æ–¹æ¡ˆï¼šå¦‚æžœæˆ‘ä»¬è¦è®¾ç½®ä¸€ä¸ªæ ‡ç­¾çš„æœ€å°é«˜åº¦200pxï¼Œéœ€è¦è¿›è¡Œçš„è®¾ç½®ä¸ºï¼š{min-height:200px; height:auto !important; height:200px; overflow:visible;}å¤‡æ³¨ï¼šåœ¨B/Sç³»ç»Ÿå‰ç«¯å¼€æ—¶ï¼Œæœ‰å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬æœ‰è¿™ç§éœ€æ±‚ã€‚å½“å†…å®¹å°äºŽä¸€ä¸ªå€¼ï¼ˆå¦‚300pxï¼‰æ—¶ã€‚å®¹å™¨çš„é«˜åº¦ä¸º300pxï¼›å½“å†…å®¹é«˜åº¦å¤§äºŽè¿™ä¸ªå€¼æ—¶ï¼Œå®¹å™¨é«˜åº¦è¢«æ’‘é«˜ï¼Œè€Œä¸æ˜¯å‡ºçŽ°æ»šåŠ¨æ¡ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±ä¼šé¢ä¸´è¿™ä¸ªå…¼å®¹æ€§é—®é¢˜ã€‚ é—®é¢˜ä¸ƒï¼šé€æ˜Žåº¦çš„å…¼å®¹cssè®¾ç½®æ–¹æ³•æ˜¯ï¼šæ¯å†™ä¸€å°æ®µä»£ç ï¼ˆå¸ƒå±€ä¸­çš„ä¸€è¡Œæˆ–è€…ä¸€å—ï¼‰æˆ‘ä»¬éƒ½è¦åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸­çœ‹æ˜¯å¦å…¼å®¹ï¼Œå½“ç„¶ç†Ÿç»ƒåˆ°ä¸€å®šçš„ç¨‹åº¦å°±æ²¡è¿™ä¹ˆéº»çƒ¦äº†ã€‚å»ºè®®ç»å¸¸ä¼šç¢°åˆ°å…¼å®¹æ€§é—®é¢˜çš„æ–°æ‰‹ä½¿ç”¨ã€‚å¾ˆå¤šå…¼å®¹æ€§é—®é¢˜éƒ½æ˜¯å› ä¸ºæµè§ˆå™¨å¯¹æ ‡ç­¾çš„é»˜è®¤å±žæ€§è§£æžä¸åŒé€ æˆçš„ï¼Œåªè¦æˆ‘ä»¬ç¨åŠ è®¾ç½®éƒ½èƒ½è½»æ¾åœ°è§£å†³è¿™äº›å…¼å®¹é—®é¢˜ã€‚å¦‚æžœæˆ‘ä»¬ç†Ÿæ‚‰æ ‡ç­¾çš„é»˜è®¤å±žæ€§çš„è¯ï¼Œå°±èƒ½å¾ˆå¥½çš„ç†è§£ä¸ºä»€ä¹ˆä¼šå‡ºçŽ°å…¼å®¹é—®é¢˜ä»¥åŠæ€Žä¹ˆåŽ»è§£å†³è¿™äº›å…¼å®¹é—®é¢˜ã€‚ æŠ€å·§ä¸€ï¼šcss hackä½¿ç”¨hacker æˆ‘å¯ä»¥æŠŠæµè§ˆå™¨åˆ†ä¸º3ç±»ï¼šie6 ï¼›ie7å’Œé¨æ¸¸ï¼›å…¶ä»–ï¼ˆie8 chrome ff safari operaç­‰ï¼‰ ie6è®¤è¯†çš„hacker æ˜¯ä¸‹åˆ’çº¿_ å’Œæ˜Ÿå· ie7 é¨æ¸¸è®¤è¯†çš„hackeræ˜¯æ˜Ÿå· ï¼ˆåŒ…æ‹¬ä¸Šé¢é—®é¢˜6ä¸­çš„ !importantä¹Ÿç®—æ˜¯hackçš„ä¸€ç§ã€‚ä¸è¿‡å®žç”¨æ€§è¾ƒå°ã€‚ï¼‰ å› ä¸ºä¼˜å…ˆçº§ç›¸åŒä¸”ç›¸å†²çªçš„å±žæ€§è®¾ç½®åŽä¸€ä¸ªä¼šè¦†ç›–æŽ‰å‰ä¸€ä¸ªï¼Œæ‰€ä»¥ä¹¦å†™çš„æ¬¡åºæ˜¯å¾ˆé‡è¦çš„ã€‚ è¶Šå°‘çš„æµ®åŠ¨ï¼Œå°±ä¼šè¶Šå°‘çš„ä»£ç ï¼Œä¼šæœ‰æ›´çµæ´»çš„é¡µé¢ï¼Œä¼šæœ‰æ‰©å±•æ€§æ›´å¼ºçš„é¡µé¢ã€‚è¿™ä¸å¤šè¯´ï¼Œå½’ç»“ä¸ºåˆ°ä¸€å®šæ°´å¹³äº†ï¼Œæµ®åŠ¨ä¼šç”¨çš„è¾ƒå°‘ã€‚å¦å¤–ï¼Œæ‚¨ä¹Ÿä¼šé¿å…ä½¿ç”¨æµ®åŠ¨+marginçš„ç”¨æ³•ã€‚æ‰€ä»¥ï¼Œè¶ŠåŽæ¥è¶Šä¸æ˜“é‡åˆ°è¿™ç§bugã€‚ æŠ€å·§äºŒï¼špaddingï¼Œmarignï¼Œheightï¼Œwidthæ³¨æ„æ˜¯æŠ€å·§ï¼Œä¸æ˜¯æ–¹æ³•ï¼š å†™å¥½æ ‡å‡†å¤´ http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtdâ€&gt; http://www.w3.org/1999/xhtmlâ€&gt; å°½é‡ç”¨paddingï¼Œæ…Žç”¨marginï¼Œheightå°½é‡è¡¥ä¸Š100%ï¼Œçˆ¶çº§heightæœ‰å®šå€¼å­çº§heightä¸ç”¨100%ï¼Œå­çº§å…¨ä¸ºæµ®åŠ¨æ—¶åº•éƒ¨è¡¥ä¸ªç©ºclear:bothçš„divå®½å°½é‡ç”¨marginï¼Œæ…Žç”¨paddingï¼Œwidthç®—å‡†å®žé™…è¦çš„å‡åŽ»padding æŠ€å·§ä¸‰ï¼šæ˜¾ç¤ºç±»ï¼ˆdisplay:block,inlineï¼‰display:block,inlineä¸¤ä¸ªå…ƒç´  display:block; //å¯ä»¥ä¸ºå†…åµŒå…ƒç´ æ¨¡æ‹Ÿä¸ºå—å…ƒç´  display:inline; //å®žçŽ°åŒä¸€è¡ŒæŽ’åˆ—çš„çš„æ•ˆæžœ display:table; //for FF,æ¨¡æ‹Ÿtableçš„æ•ˆæžœ æŠ€å·§å››ï¼šæ€Žæ ·ä½¿ä¸€ä¸ªdivå±‚å±…ä¸­äºŽæµè§ˆå™¨ä¸­ï¼Ÿ12345678910111213&lt;style type="text/css"&gt;div &#123;position:absolute;top:50%;left:50%;margin:-100px 0 0 -100px;width:200px;height:200px;border:1px solid red; &#125;&lt;/style&gt; 2ï¼‰divé‡Œçš„å†…å®¹ï¼ŒIEé»˜è®¤ä¸ºå±…ä¸­ï¼Œè€ŒFFé»˜è®¤ä¸ºå·¦å¯¹é½ï¼Œå¯ä»¥å°è¯•å¢žåŠ ä»£ç margin: 0 auto; æŠ€å·§äº”ï¼šfloatçš„divé—­åˆ;æ¸…é™¤æµ®åŠ¨;è‡ªé€‚åº”é«˜åº¦â‘  ä¾‹å¦‚ï¼šï¼œdiv id=â€floatAâ€&gt;ï¼œdiv id=â€floatBâ€&gt;ï¼œdiv id=â€NOTfloatCâ€&gt; â‘¡ä½œä¸ºå¤–éƒ¨ wrapper çš„ div ä¸è¦å®šæ­»é«˜åº¦,ä¸ºäº†è®©é«˜åº¦èƒ½è‡ªé€‚åº”ï¼Œè¦åœ¨wrapperé‡Œé¢åŠ ä¸Šoverflow:hidden; å½“åŒ…å«floatçš„boxçš„æ—¶å€™ï¼Œé«˜åº¦è‡ªé€‚åº”åœ¨IEä¸‹æ— æ•ˆï¼Œè¿™æ—¶å€™åº”è¯¥è§¦å‘IEçš„layoutç§æœ‰å±žæ€§(ä¸‡æ¶çš„IEå•Šï¼)ç”¨zoom:1;å¯ä»¥åšåˆ°ï¼Œè¿™æ ·å°±è¾¾åˆ°äº†å…¼å®¹ã€‚ â‘¢å¯¹äºŽæŽ’ç‰ˆ,æˆ‘ä»¬ç”¨å¾—æœ€å¤šçš„cssæè¿°å¯èƒ½å°±æ˜¯float:left.æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨næ çš„float divåŽé¢åšä¸€ä¸ªç»Ÿä¸€çš„èƒŒæ™¯, â‘£ä¸‡èƒ½float é—­åˆ(éžå¸¸é‡è¦!) å…³äºŽ clear float çš„åŽŸç†å¯å‚è§ [How To ClearFloats Without Structural Markup],å°†ä»¥ä¸‹ä»£ç åŠ å…¥Global CSS ä¸­,ç»™éœ€è¦é—­åˆçš„divåŠ ä¸Šclass=â€clearfixâ€å³å¯,å±¡è¯•ä¸çˆ½ã€‚ html5shiv.jsè§£å†³ ie9 ä»¥ä¸‹æµè§ˆå™¨å¯¹ html5 æ–°å¢žæ ‡ç­¾ä¸è¯†åˆ«çš„é—®é¢˜ã€‚ 123&lt;!--[if lt IE 9]&gt; &lt;script type="text/javascript" src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"&gt;&lt;/script&gt;&lt;![endif]--&gt; BFC è§£å†³è¾¹è·é‡å é—®é¢˜å½“ç›¸é‚»å…ƒç´ éƒ½è®¾ç½®äº† margin è¾¹è·æ—¶ï¼Œmargin å°†å–æœ€å¤§å€¼ï¼Œèˆå¼ƒå°å€¼ã€‚ä¸ºäº†ä¸è®©è¾¹è·é‡å ï¼Œå¯ä»¥ç»™å­å…ƒç´ åŠ ä¸€ä¸ªçˆ¶å…ƒç´ ï¼Œå¹¶è®¾ç½®è¯¥çˆ¶å…ƒç´ ä¸º BFCï¼šoverflow: hidden; IE6 åŒå€è¾¹è·çš„é—®é¢˜è®¾ç½® ie6 ä¸­è®¾ç½®æµ®åŠ¨ï¼ŒåŒæ—¶åˆè®¾ç½® marginï¼Œä¼šå‡ºçŽ°åŒå€è¾¹è·çš„é—®é¢˜display: inline; è§£å†³ IE9 ä»¥ä¸‹æµè§ˆå™¨ä¸èƒ½ä½¿ç”¨ opacityopacity: 0.5;filter: alpha(opacity = 50);filter: progid:DXImageTransform.Microsoft.Alpha(style = 0, opacity = 50); è§£å†³ IE6 ä¸æ”¯æŒ fixed ç»å¯¹å®šä½ä»¥åŠIE6ä¸‹è¢«ç»å¯¹å®šä½çš„å…ƒç´ åœ¨æ»šåŠ¨çš„æ—¶å€™ä¼šé—ªåŠ¨çš„é—®é¢˜123456789/* IE6 hack */*html, *html body &#123; background-image: url(about:blank); background-attachment: fixed;&#125;*html #menu &#123; position: absolute; top: expression(((e=document.documentElement.scrollTop) ? e : document.body.scrollTop) + 100 + 'px');&#125; IE6 èƒŒæ™¯é—ªçƒçš„é—®é¢˜é—®é¢˜ï¼šé“¾æŽ¥ã€æŒ‰é’®ç”¨ CSSsprites ä½œä¸ºèƒŒæ™¯ï¼Œåœ¨ ie6 ä¸‹ä¼šæœ‰èƒŒæ™¯å›¾é—ªçƒçš„çŽ°è±¡ã€‚åŽŸå› æ˜¯ IE6 æ²¡æœ‰å°†èƒŒæ™¯å›¾ç¼“å­˜ï¼Œæ¯æ¬¡è§¦å‘ hover çš„æ—¶å€™éƒ½ä¼šé‡æ–°åŠ è½½ è§£å†³ï¼šå¯ä»¥ç”¨ JavaScript è®¾ç½® ie6 ç¼“å­˜è¿™äº›å›¾ç‰‡ï¼š 1document.execCommand("BackgroundImageCache", false, true); è§£å†³åœ¨ IE6 ä¸‹ï¼Œåˆ—è¡¨ä¸Žæ—¥æœŸé”™ä½çš„é—®é¢˜æ—¥æœŸspan æ ‡ç­¾æ”¾åœ¨æ ‡é¢˜ a æ ‡ç­¾ä¹‹å‰å³å¯ è§£å†³ IE6 ä¸æ”¯æŒ min-height å±žæ€§çš„é—®é¢˜min-height: 350px;_height: 350px; è®© IE7 IE8 æ”¯æŒ CSS3 background-sizeå±žæ€§12345678910111213html &#123; height: 100%;&#125;body &#123; height: 100%; margin: 0; padding: 0; background-image: url('img/37.png'); background-repeat: no-repeat; background-size: cover; -ms-behavior: url('css/backgroundsize.min.htc'); behavior: url('css/backgroundsize.min.htc');&#125; IE6-7 line-height å¤±æ•ˆçš„é—®é¢˜é—®é¢˜ï¼šåœ¨ie ä¸­ img ä¸Žæ–‡å­—æ”¾ä¸€èµ·æ—¶ï¼Œline-height ä¸èµ·ä½œç”¨ è§£å†³ï¼šéƒ½è®¾ç½®æˆ float td è‡ªåŠ¨æ¢è¡Œçš„é—®é¢˜é—®é¢˜ï¼štable å®½åº¦å›ºå®šï¼Œtd è‡ªåŠ¨æ¢è¡Œ è§£å†³ï¼šè®¾ç½® Table ä¸º table-layout: fixedï¼Œtd ä¸º word-wrap: break-word é”®ç›˜äº‹ä»¶ keyCode å…¼å®¹æ€§å†™æ³•1234567891011var inp = document.getElementById('inp')var result = document.getElementById('result')function getKeyCode(e) &#123; e = e ? e : (window.event ? window.event : "") return e.keyCode ? e.keyCode : e.which&#125;inp.onkeypress = function(e) &#123; result.innerHTML = getKeyCode(e)&#125; æ±‚çª—å£å¤§å°çš„å…¼å®¹å†™æ³•1234567891011121314151617// æµè§ˆå™¨çª—å£å¯è§†åŒºåŸŸå¤§å°ï¼ˆä¸åŒ…æ‹¬å·¥å…·æ å’Œæ»šåŠ¨æ¡ç­‰è¾¹çº¿ï¼‰// 1600 * 525var client_w = document.documentElement.clientWidth || document.body.clientWidth;var client_h = document.documentElement.clientHeight || document.body.clientHeight;// ç½‘é¡µå†…å®¹å®žé™…å®½é«˜ï¼ˆåŒ…æ‹¬å·¥å…·æ å’Œæ»šåŠ¨æ¡ç­‰è¾¹çº¿ï¼‰// 1600 * 8var scroll_w = document.documentElement.scrollWidth || document.body.scrollWidth;var scroll_h = document.documentElement.scrollHeight || document.body.scrollHeight;// ç½‘é¡µå†…å®¹å®žé™…å®½é«˜ (ä¸åŒ…æ‹¬å·¥å…·æ å’Œæ»šåŠ¨æ¡ç­‰è¾¹çº¿ï¼‰// 1600 * 8var offset_w = document.documentElement.offsetWidth || document.body.offsetWidth;var offset_h = document.documentElement.offsetHeight || document.body.offsetHeight;// æ»šåŠ¨çš„é«˜åº¦var scroll_Top = document.documentElement.scrollTop||document.body.scrollTop;]]></content>
      <categories>
        <category>å…¼å®¹æ€§</category>
      </categories>
      <tags>
        <tag>æµè§ˆå™¨å…¼å®¹æ€§</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ¯ä¸ª JavaScript å·¥ç¨‹å¸ˆéƒ½åº”å½“çŸ¥é“çš„ 10 ä¸ªé¢è¯•é¢˜]]></title>
    <url>%2F2018%2F04%2F23%2FInterview%2F%E6%AF%8F%E4%B8%AA-JavaScript-%E5%B7%A5%E7%A8%8B%E5%B8%88%E9%83%BD%E5%BA%94%E5%BD%93%E7%9F%A5%E9%81%93%E7%9A%84-10-%E4%B8%AA%E9%9D%A2%E8%AF%95%E9%A2%98%2F</url>
    <content type="text"><![CDATA[èƒ½è¯´å‡ºæ¥ä¸¤ç§å¯¹äºŽ JavaScript å·¥ç¨‹å¸ˆå¾ˆé‡è¦çš„ç¼–ç¨‹èŒƒå¼ä¹ˆï¼ŸJavaScript æ˜¯ä¸€é—¨å¤šèŒƒå¼ï¼ˆmulti-paradigmï¼‰çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒæ—¢æ”¯æŒå‘½ä»¤å¼ï¼ˆimperativeï¼‰/é¢å‘è¿‡ç¨‹ï¼ˆproceduralï¼‰ç¼–ç¨‹ï¼Œä¹Ÿæ”¯æŒé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼ŒObject-Oriented Programmingï¼‰ï¼Œè¿˜æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼ˆfunctional programmingï¼‰ã€‚JavaScript æ‰€æ”¯æŒçš„é¢å‘å¯¹è±¡ç¼–ç¨‹åŒ…æ‹¬åŽŸåž‹ç»§æ‰¿ï¼ˆprototypal inheritanceï¼‰ã€‚ é¢è¯•åŠ åˆ†é¡¹ åŽŸåž‹ç»§æ‰¿ï¼ˆå³ï¼šåŽŸåž‹ï¼ŒOLOOâ€”â€”é“¾æŽ¥åˆ°å…¶å®ƒå¯¹è±¡çš„å¯¹è±¡ï¼‰ï¼› å‡½æ•°å¼ç¼–ç¨‹ï¼ˆå³ï¼šé—­åŒ…ï¼ˆclosureï¼‰ï¼Œä¸€ç±»å‡½æ•°ï¼ˆfirst class functionsï¼‰ï¼Œlambda å‡½æ•°ï¼šç®­å¤´å‡½æ•°ï¼‰ã€‚ é¢è¯•å‡åˆ†é¡¹ è¿žèŒƒå¼éƒ½ä¸çŸ¥é“ï¼Œæ›´åˆ«æä»€ä¹ˆåŽŸåž‹ OOï¼ˆprototypal ooï¼‰æˆ–è€…å‡½æ•°å¼ç¼–ç¨‹äº†ã€‚ æ·±å…¥äº†è§£The Two Pillars of JavaScript Part 1ï¼šJS ä¸¤å¤§æ”¯æŸ±ä¹‹ä¸€ï¼šåŽŸåž‹ OOThe Two Pillars of JavaScript Part 2ï¼šJS ä¸¤å¤§æ”¯æŸ±ä¹‹äºŒï¼šå‡½æ•°å¼ç¼–ç¨‹ ä»€ä¹ˆæ˜¯å‡½æ•°ç¼–ç¨‹å‡½æ•°å¼ç¼–ç¨‹ï¼Œæ˜¯å°†æ•°å­¦å‡½æ•°ç»„åˆèµ·æ¥ï¼Œå¹¶ä¸”é¿å…äº†çŠ¶æ€å…±äº«ï¼ˆshared stateï¼‰åŠå¯å˜æ•°æ®ï¼ˆmutable dataï¼‰ï¼Œç”±æ­¤è€Œäº§ç”Ÿçš„ç¼–ç¨‹è¯­è¨€ã€‚å‘æ˜ŽäºŽ 1958 å¹´çš„ Lisp å°±æ˜¯é¦–æ‰¹æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹çš„è¯­è¨€ä¹‹ä¸€ï¼Œè€Œ Î» æ¼”ç®—ï¼ˆlambda calculusï¼‰åˆ™å¯ä»¥è¯´æ˜¯å­•è‚²äº†è¿™é—¨è¯­è¨€ã€‚å³ä½¿åœ¨ä»Šå¤©ï¼ŒLisp è¿™ä¸ªå®¶æ—çš„ç¼–ç¨‹è¯­è¨€åº”ç”¨èŒƒå›´ä¾ç„¶å¾ˆå¹¿ã€‚ å‡½æ•°å¼ç¼–ç¨‹å¯æ˜¯ JavaScript è¯­è¨€ä¸­éžå¸¸é‡è¦çš„ä¸€ä¸ªæ¦‚å¿µï¼ˆå®ƒå¯æ˜¯ JavaScript çš„ä¸¤å¤§æ”¯æŸ±ä¹‹ä¸€ï¼‰ã€‚ES5 è§„èŒƒä¸­å°±å¢žåŠ äº†å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°å¼å·¥å…·ã€‚ é¢è¯•åŠ åˆ†é¡¹ çº¯å‡½æ•°ï¼ˆpure functionsï¼‰/å‡½æ•°çš„çº¯ç²¹æ€§ï¼ˆfunction purityï¼‰ çŸ¥é“å¦‚ä½•é¿å…å‰¯ä½œç”¨ï¼ˆside-effectsï¼‰ ç®€å•å‡½æ•°çš„ç»„åˆ å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼šLispï¼ŒMLï¼ŒHaskellï¼ŒErlangï¼ŒClojureï¼ŒElmï¼ŒF#ï¼ŒOCamlï¼Œç­‰ç­‰ æåˆ°äº† JavaScript è¯­è¨€ä¸­æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼ˆFPï¼‰çš„ç‰¹æ€§ï¼šä¸€ç±»å‡½æ•°ï¼Œé«˜é˜¶å‡½æ•°ï¼ˆhigher order functionsï¼‰ï¼Œä½œä¸ºå‚æ•°ï¼ˆargumentsï¼‰/å€¼ï¼ˆvaluesï¼‰çš„å‡½æ•° é¢è¯•å‡åˆ†é¡¹ æ²¡æœ‰æåˆ°çº¯å‡½æ•°ï¼Œä»¥åŠå¦‚ä½•é¿å…å‰¯ä½œç”¨ æ²¡æœ‰æä¾›å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„ä¾‹å­ æ²¡æœ‰è¯´æ˜¯ JavaScript ä¸­çš„å“ªäº›ç‰¹æ€§ä½¿å¾—å‡½æ•°å¼ç¼–ç¨‹å¾—ä»¥å®žçŽ° æ·±å…¥äº†è§£The Two Pillars of JavaScript Part 2ï¼šJS ä¸¤å¤§æ”¯æŸ±ä¹‹äºŒï¼šå‡½æ•°å¼ç¼–ç¨‹ ç±»ç»§æ‰¿å’ŒåŽŸåž‹ç»§æ‰¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿç±»ç»§æ‰¿ï¼ˆClass Inheritanceï¼‰ï¼šå®žä¾‹ï¼ˆinstancesï¼‰ç”±ç±»ç»§æ‰¿è€Œæ¥ï¼ˆç±»å’Œå®žä¾‹çš„å…³ç³»ï¼Œå¯ä»¥ç±»æ¯”ä¸ºå»ºç­‘å›¾çº¸å’Œå®žé™…å»ºç­‘ ðŸ  çš„å…³ç³»ï¼‰ï¼ŒåŒæ—¶è¿˜ä¼šåˆ›å»ºçˆ¶ç±»â€”å­ç±»è¿™æ ·ä¸€ç§å…³ç³»ï¼Œä¹Ÿå«åšç±»çš„åˆ†å±‚åˆ†ç±»ï¼ˆhierarchical class taxonomiesï¼‰ã€‚é€šå¸¸æ˜¯ç”¨ new å…³é”®å­—è°ƒç”¨ç±»çš„æž„é€ å‡½æ•°ï¼ˆconstructor functionsï¼‰æ¥åˆ›å»ºå®žä¾‹çš„ã€‚ä¸è¿‡åœ¨ ES6 ä¸­ï¼Œè¦ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œä¸ç”¨ class å…³é”®å­—ä¹Ÿå¯ä»¥ã€‚ åŽŸåž‹ç»§æ‰¿ï¼ˆPrototypal Inheritanceï¼‰ï¼šå®žä¾‹/å¯¹è±¡ç›´æŽ¥ä»Žå…¶å®ƒå¯¹è±¡ç»§æ‰¿è€Œæ¥ï¼Œåˆ›å»ºå®žä¾‹çš„è¯ï¼Œå¾€å¾€ç”¨å·¥åŽ‚å‡½æ•°ï¼ˆfactory functionsï¼‰æˆ–è€… Object.create() æ–¹æ³•ã€‚å®žä¾‹å¯ä»¥ä»Žå¤šä¸ªä¸åŒçš„å¯¹è±¡ç»„åˆè€Œæ¥ï¼Œè¿™æ ·å°±èƒ½é€‰æ‹©æ€§åœ°ç»§æ‰¿äº†ã€‚ åœ¨ JavaScript ä¸­ï¼ŒåŽŸåž‹ç»§æ‰¿æ¯”ç±»ç»§æ‰¿æ›´ç®€å•ï¼Œä¹Ÿæ›´çµæ´»ã€‚ é¢è¯•åŠ åˆ†é¡¹ ç±»ï¼šä¼šåˆ›å»ºç´§å¯†çš„è€¦åˆï¼Œæˆ–è€…è¯´å±‚çº§ç»“æž„ï¼ˆhierarchiesï¼‰/åˆ†ç±»ï¼ˆtaxonomiesï¼‰ã€‚ åŽŸåž‹ï¼šæåˆ°äº†è¡”æŽ¥ç»§æ‰¿ï¼ˆconcatenative inheritanceï¼‰ã€åŽŸåž‹å§”æ‰˜ï¼ˆ prototype delegationï¼‰ã€å‡½æ•°ç»§æ‰¿ï¼ˆfunctional inheritanceï¼‰ï¼Œä»¥åŠå¯¹è±¡ç»„åˆï¼ˆobject compositionï¼‰ã€‚ é¢è¯•å‡åˆ†é¡¹ åŽŸåž‹ç»§æ‰¿å’Œç»„åˆï¼Œä¸Žç±»ç»§æ‰¿ç›¸æ¯”ï¼Œä¸çŸ¥é“å“ªä¸ªæ›´å¥½ã€‚ å‡½æ•°å¼ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå„æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œä¸è¶³å‘¢ï¼Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¼˜ç‚¹ï¼šå…³äºŽâ€œå¯¹è±¡â€çš„ä¸€äº›åŸºç¡€æ¦‚å¿µç†è§£èµ·æ¥æ¯”è¾ƒå®¹æ˜“ï¼Œæ–¹æ³•è°ƒç”¨çš„å«ä¹‰ä¹Ÿå¥½è§£é‡Šã€‚é¢å‘å¯¹è±¡ç¼–ç¨‹é€šå¸¸ä½¿ç”¨å‘½ä»¤å¼çš„ç¼–ç é£Žæ ¼ï¼Œå£°æ˜Žå¼ï¼ˆdeclarative styleï¼‰çš„ç”¨å¾—æ¯”è¾ƒå°‘ã€‚è¿™æ ·çš„ä»£ç è¯»èµ·æ¥ï¼Œåƒæ˜¯ä¸€ç»„ç›´æŽ¥çš„ã€è®¡ç®—æœºå¾ˆå®¹æ˜“å°±èƒ½éµå¾ªçš„æŒ‡ä»¤ã€‚ é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸è¶³ï¼šé¢å‘å¯¹è±¡ç¼–ç¨‹å¾€å¾€éœ€è¦å…±äº«çŠ¶æ€ã€‚å¯¹è±¡åŠå…¶è¡Œä¸ºå¸¸å¸¸ä¼šæ·»åŠ åˆ°åŒä¸€ä¸ªå®žä½“ä¸Šï¼Œè¿™æ ·ä¸€æ¥ï¼Œå¦‚æžœä¸€å †å‡½æ•°éƒ½è¦è®¿é—®è¿™ä¸ªå®žä½“ï¼Œè€Œä¸”è¿™äº›å‡½æ•°çš„æ‰§è¡Œé¡ºåºä¸ç¡®å®šçš„è¯ï¼Œå¾ˆå¯èƒ½å°±ä¼šå‡ºä¹±å­äº†ï¼Œæ¯”å¦‚ç«žäº‰æ¡ä»¶ï¼ˆrace conditionsï¼‰è¿™ç§çŽ°è±¡ï¼ˆå‡½æ•° A ä¾èµ–äºŽå®žä½“çš„æŸä¸ªå±žæ€§ï¼Œä½†æ˜¯åœ¨ A è®¿é—®å±žæ€§ä¹‹å‰ï¼Œå±žæ€§å·²ç»è¢«å‡½æ•° B ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆå‡½æ•° A åœ¨ä½¿ç”¨å±žæ€§çš„æ—¶å€™ï¼Œå¾ˆå¯èƒ½å°±å¾—ä¸åˆ°é¢„æœŸçš„ç»“æžœï¼‰ã€‚ å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜ç‚¹ï¼šç”¨å‡½æ•°å¼èŒƒå¼æ¥ç¼–ç¨‹ï¼Œå°±ä¸éœ€è¦æ‹…å¿ƒå…±äº«çŠ¶æ€æˆ–è€…å‰¯ä½œç”¨äº†ã€‚è¿™æ ·å°±é¿å…äº†å‡ ä¸ªå‡½æ•°åœ¨è°ƒç”¨åŒä¸€æ‰¹èµ„æºæ—¶å¯èƒ½äº§ç”Ÿçš„ bug äº†ã€‚æ‹¥æœ‰äº†â€œæ— å‚é£Žæ ¼â€ï¼ˆpoint-free styleï¼Œä¹Ÿå«éšå¼ç¼–ç¨‹ï¼‰ä¹‹ç±»çš„ç‰¹æ€§ä¹‹åŽï¼Œå‡½æ•°å¼ç¼–ç¨‹å°±å¤§å¤§ç®€åŒ–äº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„æ–¹å¼æ¥æŠŠä»£ç ç»„åˆæˆå¤ç”¨æ€§æ›´å¼ºçš„ä»£ç äº†ï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹å¯åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚ å‡½æ•°å¼ç¼–ç¨‹æ›´åçˆ±å£°æ˜Žå¼ã€ç¬¦å·å¼ï¼ˆdenotational styleï¼‰çš„ç¼–ç é£Žæ ¼ï¼Œè¿™æ ·çš„ä»£ç ï¼Œå¹¶ä¸æ˜¯é‚£ç§ä¸ºäº†å®žçŽ°æŸç§ç›®çš„è€Œéœ€è¦æŒ‰éƒ¨å°±ç­åœ°æ‰§è¡Œçš„ä¸€å¤§å †æŒ‡ä»¤ï¼Œè€Œæ˜¯å…³æ³¨å®è§‚ä¸Šè¦åšä»€ä¹ˆã€‚è‡³äºŽå…·ä½“åº”è¯¥æ€Žä¹ˆåšï¼Œå°±éƒ½éšè—åœ¨å‡½æ•°å†…éƒ¨äº†ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¦æ˜¯æƒ³é‡æž„ä»£ç ã€ä¼˜åŒ–æ€§èƒ½ï¼Œé‚£å°±å¤§æœ‰å¯ä¸ºäº†ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šä»¥åšä¸€é“èœä¸ºä¾‹ï¼Œå°±æ˜¯ç”± ä¹°èœ -&gt; æ´—èœ -&gt; ç‚’èœ è¿™ä¸‰æ­¥ç»„æˆï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸ç®¡åšä»€ä¹ˆèœï¼Œè¿™ä¸ªæµç¨‹éƒ½æ˜¯ä¸ä¼šå˜çš„ã€‚è€Œæƒ³è¦ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œè‡ªç„¶å°±æ˜¯è¦æ·±å…¥æ¯ä¸€æ­¥ä¹‹ä¸­äº†ã€‚è¿™æ ·ä¸ç®¡å†…éƒ¨å¦‚ä½•é‡æž„ã€ä¼˜åŒ–ï¼Œæ•´ä½“çš„æµç¨‹å¹¶ä¸ä¼šå˜ï¼Œè¿™å°±æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„å¥½å¤„ã€‚ï¼‰ç”šè‡³å¯ä»¥æŠŠä¸€ç§ç®—æ³•æ¢æˆå¦ä¸€ç§æ›´é«˜æ•ˆçš„ç®—æ³•ï¼ŒåŒæ—¶è¿˜åŸºæœ¬ä¸éœ€è¦ä¿®æ”¹ä»£ç ï¼ˆæ¯”å¦‚æŠŠåŠæ—©æ±‚å€¼ç­–ç•¥ï¼ˆeager evaluationï¼‰æ›¿æ¢ä¸ºæƒ°æ€§æ±‚å€¼ç­–ç•¥ï¼ˆlazy evaluationï¼‰ï¼‰ã€‚ åˆ©ç”¨çº¯å‡½æ•°è¿›è¡Œçš„è®¡ç®—ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰©å±•åˆ°å¤šå¤„ç†å™¨çŽ¯å¢ƒä¸‹ï¼Œæˆ–è€…åº”ç”¨åˆ°åˆ†å¸ƒå¼è®¡ç®—é›†ç¾¤ä¸Šï¼ŒåŒæ—¶è¿˜ä¸ç”¨æ‹…å¿ƒçº¿ç¨‹èµ„æºå†²çªã€ç«žäº‰æ¡ä»¶ä¹‹ç±»çš„é—®é¢˜ã€‚ å‡½æ•°å¼ç¼–ç¨‹çš„ä¸è¶³ï¼šä»£ç å¦‚æžœè¿‡åº¦åˆ©ç”¨äº†å‡½æ•°å¼çš„ç¼–ç¨‹ç‰¹æ€§ï¼ˆå¦‚æ— å‚é£Žæ ¼ã€å¤§é‡æ–¹æ³•çš„ç»„åˆï¼‰ï¼Œå°±ä¼šå½±å“å…¶å¯è¯»æ€§ï¼Œä»Žè€Œç®€æ´åº¦æœ‰ä½™ã€æ˜“è¯»æ€§ä¸è¶³ã€‚ å¤§éƒ¨åˆ†å·¥ç¨‹å¸ˆè¿˜æ˜¯æ›´ç†Ÿæ‚‰é¢å‘å¯¹è±¡ç¼–ç¨‹ã€å‘½ä»¤å¼ç¼–ç¨‹ï¼Œå¯¹äºŽåˆšæŽ¥è§¦å‡½æ•°å¼ç¼–ç¨‹çš„äººæ¥è¯´ï¼Œå³ä½¿åªæ˜¯è¿™ä¸ªé¢†åŸŸçš„ä¸€äº›çš„ç®€å•æœ¯è¯­ï¼Œéƒ½å¯èƒ½è®©ä»–æ€€ç–‘äººç”Ÿã€‚ å‡½æ•°å¼ç¼–ç¨‹çš„å­¦ä¹ æ›²çº¿æ›´é™¡å³­ï¼Œå› ä¸ºé¢å‘å¯¹è±¡ç¼–ç¨‹å¤ªæ™®åŠäº†ï¼Œå­¦ä¹ èµ„æ–™å¤ªå¤šäº†ã€‚ç›¸æ¯”è€Œè¨€ï¼Œå‡½æ•°å¼ç¼–ç¨‹åœ¨å­¦æœ¯é¢†åŸŸçš„åº”ç”¨æ›´å¹¿æ³›ä¸€äº›ï¼Œåœ¨å·¥ä¸šç•Œçš„åº”ç”¨ç¨é€Šä¸€ç­¹ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸é‚£ä¹ˆâ€œå¹³æ˜“è¿‘äººâ€äº†ã€‚åœ¨æŽ¢è®¨å‡½æ•°å¼ç¼–ç¨‹æ—¶ï¼Œäººä»¬å¾€å¾€ç”¨ Î» æ¼”ç®—ã€ä»£æ•°ã€èŒƒç•´å­¦ç­‰å­¦ç§‘çš„ä¸“ä¸šæœ¯è¯­å’Œä¸“ä¸šç¬¦å·æ¥æè¿°ç›¸å…³çš„æ¦‚å¿µï¼Œé‚£ä¹ˆå…¶ä»–äººæƒ³è¦å…¥é—¨å‡½æ•°å¼ç¼–ç¨‹çš„è¯ï¼Œå°±å¾—å…ˆæŠŠè¿™äº›é¢†åŸŸçš„åŸºç¡€çŸ¥è¯†æžæ˜Žç™½ï¼Œèƒ½ä¸è®©äººå¤´å¤§ä¹ˆã€‚ é¢è¯•åŠ åˆ†é¡¹ å…±äº«çŠ¶æ€çš„ç¼ºç‚¹ã€èµ„æºç«žäº‰ã€ç­‰ç­‰ï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰ å‡½æ•°å¼ç¼–ç¨‹èƒ½å¤Ÿæžå¤§åœ°ç®€åŒ–åº”ç”¨å¼€å‘ é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹å­¦ä¹ æ›²çº¿çš„ä¸åŒ ä¸¤ç§ç¼–ç¨‹æ–¹å¼å„è‡ªçš„ä¸è¶³ä¹‹å¤„ï¼Œä»¥åŠå¯¹ä»£ç åŽæœŸç»´æŠ¤å¸¦æ¥çš„å½±å“ å‡½æ•°å¼é£Žæ ¼çš„ä»£ç åº“ï¼Œå­¦ä¹ æ›²çº¿ä¼šå¾ˆé™¡å³­ é¢å‘å¯¹è±¡ç¼–ç¨‹é£Žæ ¼çš„ä»£ç åº“ï¼Œä¿®æ”¹èµ·æ¥å¾ˆéš¾ï¼Œå¾ˆå®¹æ˜“å‡ºé—®é¢˜ï¼ˆå’Œæ°´å¹³ç›¸å½“çš„å‡½æ•°å¼é£Žæ ¼çš„ä»£ç ç›¸æ¯”ï¼‰ ä¸å¯å˜æ€§ï¼ˆimmutabilityï¼‰ï¼Œèƒ½å¤Ÿæžå¤§åœ°æå‡ç¨‹åºåŽ†å²çŠ¶æ€ï¼ˆprogram state historyï¼‰çš„å¯è§æ€§ï¼ˆaccessibleï¼‰å’Œæ‰©å±•æ€§ï¼ˆmalleableï¼‰ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæƒ³è¦æ·»åŠ è¯¸å¦‚æ— é™æ’¤é”€/é‡åšã€å€’å¸¦/å›žæ”¾ã€å¯åŽé€€çš„è°ƒè¯•ä¹‹ç±»çš„åŠŸèƒ½çš„è¯ï¼Œå°±ç®€å•å¤šäº†ã€‚ä¸ç®¡æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹è¿˜æ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼Œè¿™ä¸¤ç§èŒƒå¼éƒ½èƒ½å®žçŽ°ä¸å¯å˜æ€§ï¼Œä½†æ˜¯è¦ç”¨é¢å‘å¯¹è±¡æ¥å®žçŽ°çš„è¯ï¼Œå…±äº«çŠ¶æ€å¯¹è±¡çš„æ•°é‡å°±ä¼šå‰§å¢žï¼Œä»£ç ä¹Ÿä¼šå˜å¾—å¤æ‚å¾ˆå¤šã€‚ é¢è¯•å‡åˆ†é¡¹æ²¡æœ‰è®²è¿™ä¸¤ç§ç¼–ç¨‹èŒƒå¼çš„ç¼ºç‚¹â€”â€”å¦‚æžœç†Ÿæ‚‰è‡³å°‘å…¶ä¸­ä¸€ç§èŒƒå¼çš„è¯ï¼Œåº”è¯¥èƒ½å¤Ÿè¯´å‡ºå¾ˆå¤šè¿™ç§èŒƒå¼çš„ç¼ºç‚¹å§ã€‚ ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ç±»ç»§æ‰¿ï¼Ÿåƒä¸‡åˆ«ç”¨ç±»ç»§æ‰¿ï¼æˆ–è€…è¯´å°½é‡åˆ«ç”¨ã€‚å¦‚æžœéžè¦ç”¨ï¼Œå°±åªç”¨å®ƒç»§æ‰¿ä¸€çº§ï¼ˆone levelï¼‰å°±å¥½äº†ï¼Œå¤šçº§çš„ç±»ç»§æ‰¿ç®€ç›´å°±æ˜¯åæ¨¡å¼çš„ã€‚è¿™ä¸ªè¯é¢˜ï¼ˆä¸å¤ªæ˜Žç™½æ˜¯å…³äºŽä»€ä¹ˆçš„â€¦â€¦ï¼‰æˆ‘ä¹Ÿå‚ä¸Žè®¨è®ºè¿‡å¥½äº›å¹´äº†ï¼Œä»…æœ‰çš„ä¸€äº›å›žç­”æœ€ç»ˆä¹Ÿæ²¦ä¸º å¸¸è§çš„è¯¯è§£ ä¹‹ä¸€ã€‚æ›´å¤šçš„æ—¶å€™ï¼Œè¿™ä¸ªè¯é¢˜è®¨è®ºç€è®¨è®ºç€å°±æ²¡åŠ¨é™äº†ã€‚ å¦‚æžœä¸€ä¸ªç‰¹æ€§æœ‰æ—¶å€™å¾ˆæœ‰ç”¨ä½†æœ‰æ—¶å€™åˆå¾ˆå±é™©å¹¶ä¸”è¿˜æœ‰å¦ä¸€ç§æ›´å¥½çš„ç‰¹æ€§å¯ä»¥ç”¨é‚£åŠ¡å¿…è¦ç”¨å¦ä¸€ç§æ›´å¥½çš„ç‰¹æ€§~ Douglas Crockford é¢è¯•åŠ åˆ†é¡¹ å°½é‡åˆ«ç”¨ï¼Œç”šè‡³æ˜¯å½»åº•ä¸ç”¨ç±»ç»§æ‰¿ã€‚ æœ‰æ—¶å€™åªç»§æ‰¿ä¸€çº§çš„è¯ä¹Ÿè¿˜æ˜¯ OK çš„ï¼Œæ¯”å¦‚ä»Žæ¡†æž¶çš„åŸºç±»ç»§æ‰¿ï¼Œä¾‹å¦‚ React.Componentã€‚ ç›¸æ¯”ç±»ç»§æ‰¿ï¼Œå¯¹è±¡ç»„åˆï¼ˆobject compositionï¼‰æ›´å¥½ä¸€äº›ã€‚ ä»€ä¹ˆæ—¶å€™è¯¥ç”¨åŽŸåž‹ç»§æ‰¿ï¼ŸåŽŸåž‹ç»§æ‰¿å¯ä»¥åˆ†ä¸ºä¸‹é¢å‡ ç±»ï¼š å§”æ‰˜ï¼ˆdelegationï¼Œä¹Ÿå°±æ˜¯åŽŸåž‹é“¾ï¼‰ ç»„åˆï¼ˆconcatenativeï¼Œæ¯”å¦‚æ··ç”¨ï¼ˆmixinsï¼‰ã€Object.assign()ï¼‰ å‡½æ•°å¼ï¼ˆfunctionalï¼Œè¿™ä¸ªå‡½æ•°å¼åŽŸåž‹ç»§æ‰¿ä¸æ˜¯å‡½æ•°å¼ç¼–ç¨‹ã€‚è¿™é‡Œçš„å‡½æ•°æ˜¯ç”¨æ¥åˆ›å»ºä¸€ä¸ªé—­åŒ…ï¼Œä»¥å®žçŽ°ç§æœ‰çŠ¶æ€ï¼ˆprivate stateï¼‰æˆ–è€…å°è£…ï¼ˆencapsulationï¼‰ï¼‰ ä¸Šé¢è¿™ä¸‰ç§åŽŸåž‹ç»§æ‰¿éƒ½æœ‰å„è‡ªçš„é€‚ç”¨åœºæ™¯ï¼Œä¸è¿‡å®ƒä»¬éƒ½å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºéƒ½èƒ½å®žçŽ°ç»„åˆç»§æ‰¿ï¼ˆcompositionï¼‰ï¼Œä¹Ÿå°±æ˜¯å»ºç«‹äº† A æ‹¥æœ‰ç‰¹æ€§ Bï¼ˆhas-aï¼‰ã€A ç”¨åˆ°äº†ç‰¹æ€§ Bï¼ˆuses-aï¼‰ æˆ–è€… A å¯ä»¥å®žçŽ°ç‰¹æ€§ Bï¼ˆcan-doï¼‰ çš„è¿™æ ·ä¸€ç§å…³ç³»ã€‚ç›¸æ¯”è€Œè¨€ï¼Œç±»ç»§æ‰¿å»ºç«‹çš„æ˜¯ A å°±æ˜¯ B è¿™æ ·ä¸€ç§å…³ç³»ã€‚ é¢è¯•åŠ åˆ†é¡¹ çŸ¥é“åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¸é€‚åˆç”¨æ¨¡å—åŒ–ï¼ˆmodulesï¼‰æˆ–è€…å‡½æ•°å¼ç¼–ç¨‹ã€‚ çŸ¥é“éœ€è¦ç»„åˆå¤šä¸ªä¸åŒæ¥æºçš„å¯¹è±¡æ—¶ï¼Œåº”è¯¥æ€Žä¹ˆåšã€‚ çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ç»§æ‰¿ã€‚ é¢è¯•å‡åˆ†é¡¹ ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨åŽŸåž‹ã€‚ ä¸çŸ¥é“æ··ç”¨å’Œ Object.assign()ã€‚ ä¸ºä»€ä¹ˆè¯´â€œå¯¹è±¡ç»„åˆæ¯”ç±»ç»§æ‰¿æ›´å¥½â€ï¼Ÿè¿™å¥è¯å¼•ç”¨çš„æ˜¯ã€Šè®¾è®¡èŠ±çº¹ã€‹ï¼ˆDesign Patternsï¼Œè®¾è®¡æ¨¡å¼ï¼‰è¿™æœ¬ä¹¦çš„å†…å®¹ã€‚æ„æ€æ˜¯è¦æƒ³å®žçŽ°ä»£ç é‡ç”¨ï¼Œå°±åº”è¯¥æŠŠä¸€å †å°çš„åŠŸèƒ½å•å…ƒç»„åˆæˆæ»¡è¶³éœ€æ±‚çš„å„ç§å¯¹è±¡ï¼Œè€Œä¸æ˜¯é€šè¿‡ç±»ç»§æ‰¿å¼„å‡ºæ¥ä¸€å±‚ä¸€å±‚çš„å¯¹è±¡ã€‚ æ¢å¥è¯è¯´ï¼Œå°±æ˜¯å°½é‡ç¼–ç¨‹å®žçŽ° can-doã€has-a æˆ–è€… uses-a è¿™ç§å…³ç³»ï¼Œè€Œä¸æ˜¯ is-a è¿™ç§å…³ç³»ã€‚ é¢è¯•åŠ åˆ†é¡¹ é¿å…ä½¿ç”¨ç±»ç»§æ‰¿ã€‚ é¿å…ä½¿ç”¨é—®é¢˜å¤šå¤šçš„åŸºç±»ã€‚ é¿å…ç´§è€¦åˆã€‚ é¿å…æžå…¶ä¸çµæ´»çš„å±‚æ¬¡åˆ†ç±»ï¼ˆtaxonomyï¼‰ï¼ˆç±»ç»§æ‰¿æ‰€äº§ç”Ÿçš„ is-a å…³ç³»å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šè¯¯ç”¨çš„æƒ…å†µï¼‰ é¿å…å¤§çŒ©çŒ©é¦™è•‰é—®é¢˜ï¼ˆâ€œä½ åªæ˜¯æƒ³è¦ä¸€æ ¹é¦™è•‰ï¼Œç»“æžœæœ€åŽå´æ•´å‡ºæ¥ä¸€åªæ‹¿ç€é¦™è•‰çš„å¤§çŒ©çŒ©ï¼Œè¿˜æœ‰æ•´ä¸ªä¸›æž—â€ï¼‰ã€‚ è¦è®©ä»£ç æ›´å…·æ‰©å±•æ€§ã€‚ é¢è¯•å‡åˆ†é¡¹ æ²¡æœ‰æåˆ°ä¸Šé¢ä»»ä½•ä¸€ç§é—®é¢˜ã€‚ æ²¡æœ‰è¡¨è¾¾æ¸…æ¥šå¯¹è±¡ç»„åˆä¸Žç±»ç»§æ‰¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¹Ÿæ²¡æœ‰æåˆ°å¯¹è±¡ç»„åˆçš„ä¼˜ç‚¹ã€‚ åŒå‘æ•°æ®ç»‘å®š/å•å‘æ•°æ®æµçš„å«ä¹‰å’ŒåŒºåˆ«åŒå‘æ•°æ®ç»‘å®šï¼ˆtwo-way data bindingï¼‰ï¼Œæ„å‘³ç€ UI å±‚æ‰€å‘ˆçŽ°çš„å†…å®¹å’Œ Model å±‚çš„æ•°æ®åŠ¨æ€åœ°ç»‘å®šåœ¨ä¸€èµ·äº†ï¼Œå…¶ä¸­ä¸€ä¸ªå‘ç”Ÿäº†å˜åŒ–ï¼Œå°±ä¼šç«‹åˆ»åæ˜ åœ¨å¦ä¸€ä¸ªä¸Šã€‚æ¯”å¦‚ç”¨æˆ·åœ¨å‰ç«¯é¡µé¢çš„è¡¨å•æŽ§ä»¶ä¸­è¾“å…¥äº†ä¸€ä¸ªå€¼ï¼ŒModel å±‚å¯¹åº”è¯¥æŽ§ä»¶çš„å˜é‡å°±ä¼šç«‹åˆ»æ›´æ–°ä¸ºç”¨æˆ·æ‰€è¾“å…¥çš„å€¼ï¼›åä¹‹äº¦ç„¶ï¼Œå¦‚æžœ Modal å±‚çš„æ•°æ®æœ‰å˜åŒ–ï¼Œå˜åŒ–åŽçš„æ•°æ®ä¹Ÿä¼šç«‹åˆ»åæ˜ è‡³ UI å±‚ã€‚ å•å‘æ•°æ®æµï¼ˆone-way data flowï¼‰ï¼Œ æ„å‘³ç€åªæœ‰ Model å±‚æ‰æ˜¯å•ä¸€æ•°æ®æºï¼ˆsingle source of truthï¼‰ã€‚UI å±‚çš„å˜åŒ–ä¼šè§¦å‘å¯¹åº”çš„æ¶ˆæ¯æœºåˆ¶ï¼Œå‘ŠçŸ¥ Model å±‚ç”¨æˆ·çš„ç›®çš„ï¼ˆå¯¹åº” React çš„ storeï¼‰ã€‚åªæœ‰ Model å±‚æ‰æœ‰æ›´æ”¹åº”ç”¨çŠ¶æ€çš„æƒé™ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ•°æ®æ°¸è¿œéƒ½æ˜¯å•å‘æµåŠ¨çš„ï¼Œä¹Ÿå°±æ›´å®¹æ˜“äº†è§£åº”ç”¨çš„çŠ¶æ€æ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚ é‡‡ç”¨å•å‘æ•°æ®æµçš„åº”ç”¨ï¼Œå…¶çŠ¶æ€çš„å˜åŒ–æ˜¯å¾ˆå®¹æ˜“è·Ÿè¸ªçš„ï¼Œé‡‡ç”¨åŒå‘æ•°æ®ç»‘å®šçš„åº”ç”¨ï¼Œå°±å¾ˆéš¾è·Ÿè¸ªå¹¶ç†è§£çŠ¶æ€çš„å˜åŒ–äº†ã€‚ é¢è¯•åŠ åˆ†é¡¹ React æ˜¯å•å‘æ•°æ®æµçš„å…¸åž‹ï¼Œé¢è¯•æ—¶æåˆ°è¿™ä¸ªæ¡†æž¶çš„è¯ä¼šåŠ åˆ†ã€‚Cycle.js åˆ™æ˜¯å¦ä¸€ä¸ªå¾ˆæµè¡Œçš„å•å‘æ•°æ®æµçš„åº“ã€‚ Angular åˆ™æ˜¯åŒå‘æ•°æ®ç»‘å®šçš„å…¸åž‹ã€‚ å•ä½“æž¶æž„å’Œå¾®æœåŠ¡æž¶æž„å„æœ‰ä½•ä¼˜åŠ£ï¼Ÿé‡‡ç”¨å•ä½“æž¶æž„ï¼ˆmonolithic architectureï¼‰çš„åº”ç”¨ï¼Œå„ç»„ä»¶çš„ä»£ç æ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“å­˜åœ¨çš„ï¼Œç»„ä»¶ä¹‹é—´äº’ç›¸åˆä½œï¼Œå…±äº«å†…å­˜å’Œèµ„æºã€‚ è€Œå¾®æœåŠ¡æž¶æž„ï¼ˆmicroservice architectureï¼‰åˆ™æ˜¯ç”±è®¸è®¸å¤šå¤šä¸ªäº’ç›¸ç‹¬ç«‹çš„å°åº”ç”¨ç»„æˆï¼Œæ¯ä¸ªåº”ç”¨éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œåº”ç”¨åœ¨æ‰©å®¹æ—¶ä¹Ÿæ˜¯ç‹¬ç«‹äºŽå…¶å®ƒåº”ç”¨è¿›è¡Œçš„ã€‚ å•ä½“æž¶æž„çš„ä¼˜åŠ¿ï¼šå¤§éƒ¨åˆ†åº”ç”¨éƒ½æœ‰ç›¸å½“æ•°é‡çš„æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆcross-cutting concernsï¼‰ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ï¼Œæµé‡é™åˆ¶ï¼Œè¿˜æœ‰å®¡è®¡è·Ÿè¸ªå’Œ DOS é˜²æŠ¤ç­‰å®‰å…¨æ–¹é¢çš„éœ€æ±‚ï¼Œå•ä½“æž¶æž„åœ¨è¿™æ–¹é¢å°±å¾ˆæœ‰ä¼˜åŠ¿ã€‚ å½“æ‰€æœ‰åŠŸèƒ½éƒ½è¿è¡Œåœ¨ä¸€ä¸ªåº”ç”¨é‡Œçš„æ—¶å€™ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†ç»„ä»¶ä¸Žæ¨ªåˆ‡å…³æ³¨ç‚¹ç›¸å…³è”ã€‚ å•ä½“æž¶æž„ä¹Ÿæœ‰æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ï¼Œæ¯•ç«Ÿè®¿é—®å…±äº«å†…å­˜è¿˜æ˜¯æ¯”è¿›ç¨‹é—´é€šä¿¡ï¼ˆinter-process communicationï¼ŒIPCï¼‰è¦å¿«çš„ã€‚ å•ä½“æž¶æž„çš„åŠ£åŠ¿ï¼šéšç€å•ä½“æž¶æž„åº”ç”¨åŠŸèƒ½çš„ä¸æ–­å¼€å‘ï¼Œå„é¡¹æœåŠ¡ä¹‹é—´çš„è€¦åˆç¨‹åº¦ä¹Ÿä¼šä¸æ–­å¢žåŠ ï¼Œè¿™æ ·ä¸€æ¥å°±å¾ˆéš¾æŠŠå„é¡¹æœåŠ¡åˆ†ç¦»å¼€æ¥äº†ï¼Œè¦åšç‹¬ç«‹æ‰©å®¹æˆ–è€…ä»£ç ç»´æŠ¤ä¹Ÿå°±æ›´ä¸æ–¹ä¾¿äº†ã€‚ å¾®æœåŠ¡çš„ä¼˜åŠ¿ï¼šå¾®æœåŠ¡æž¶æž„ä¸€èˆ¬éƒ½æœ‰æ›´å¥½çš„ç»„ç»‡ç»“æž„ï¼Œå› ä¸ºæ¯é¡¹æœåŠ¡éƒ½æœ‰è‡ªå·±ç‰¹å®šçš„åˆ†å·¥ï¼Œè€Œä¸”ä¹Ÿä¸ä¼šå¹²æ¶‰å…¶å®ƒç»„ä»¶æ‰€è´Ÿè´£çš„éƒ¨åˆ†ã€‚æœåŠ¡è§£è€¦ä¹‹åŽï¼Œæƒ³è¦é‡æ–°ç»„åˆã€é…ç½®æ¥ä¸ºå„ä¸ªä¸åŒçš„åº”ç”¨æä¾›æœåŠ¡çš„è¯ï¼Œä¹Ÿæ›´æ–¹ä¾¿äº†ï¼ˆæ¯”å¦‚åŒæ—¶ä¸º Web å®¢æˆ·ç«¯å’Œå…¬å…± API æä¾›æœåŠ¡ï¼‰ã€‚ å¦‚æžœç”¨åˆç†çš„æž¶æž„æ¥éƒ¨ç½²å¾®æœåŠ¡çš„è¯ï¼Œå®ƒåœ¨æ€§èƒ½ä¸Šä¹Ÿæ˜¯å¾ˆæœ‰ä¼˜åŠ¿çš„ï¼Œå› ä¸ºè¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥å¾ˆè½»æ¾åœ°åˆ†ç¦»çƒ­é—¨æœåŠ¡ï¼Œå¯¹å…¶è¿›è¡Œæ‰©å®¹ï¼ŒåŒæ—¶è¿˜ä¸ä¼šå½±å“åˆ°åº”ç”¨ä¸­çš„å…¶å®ƒéƒ¨åˆ†ã€‚ å¾®æœåŠ¡çš„åŠ£åŠ¿ï¼šåœ¨å®žé™…æž„å»ºä¸€ä¸ªæ–°çš„å¾®æœåŠ¡æž¶æž„çš„æ—¶å€™ï¼Œä¼šé‡åˆ°å¾ˆå¤šåœ¨è®¾è®¡é˜¶æ®µæ²¡æœ‰é¢„æ–™åˆ°çš„æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚å¦‚æžœæ˜¯å•ä½“æž¶æž„åº”ç”¨çš„è¯å°±å¾ˆç®€å•ï¼Œæ–°å»ºä¸€ä¸ªä¸­é—´ä»¶ï¼ˆshared magic helpers ä¸çŸ¥é“æ€Žä¹ˆç¿»è¯‘â€¦â€¦ï¼‰æ¥è§£å†³è¿™æ ·çš„é—®é¢˜å°±è¡Œäº†ï¼Œæ²¡ä»€ä¹ˆéº»çƒ¦çš„ã€‚ ä½†æ˜¯åœ¨å¾®æœåŠ¡æž¶æž„ä¸­å°±ä¸ä¸€æ ·äº†ï¼Œè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¦ä¹ˆä¸ºæ¯ä¸ªæ¨ªåˆ‡å…³æ³¨ç‚¹éƒ½å¼•å…¥ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œè¦ä¹ˆå°±æŠŠæ‰€æœ‰æ¨ªåˆ‡å…³æ³¨ç‚¹çš„è§£å†³æ–¹æ¡ˆå°è£…åˆ°ä¸€ä¸ªæœåŠ¡å±‚ä¸­ï¼Œè®©æ‰€æœ‰æµé‡éƒ½ä»Žè¿™é‡Œèµ°ä¸€éå°±è¡Œäº†ã€‚ ä¸ºäº†è§£å†³æ¨ªåˆ‡å…³æ³¨ç‚¹çš„é—®é¢˜ï¼Œè™½ç„¶å•ä½“æž¶æž„ä¹Ÿè¶‹å‘äºŽæŠŠæ‰€æœ‰çš„è·¯ç”±æµé‡éƒ½ä»Žä¸€ä¸ªå¤–éƒ¨æœåŠ¡å±‚èµ°ä¸€éï¼Œä½†æ˜¯åœ¨è¿™ç§æž¶æž„ä¸­ï¼Œå¯ä»¥ç­‰åˆ°é¡¹ç›®éžå¸¸æˆç†Ÿä¹‹åŽå†è¿›è¡Œè¿™ç§æ”¹é€ ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠè¿˜è¿™ç¬”æŠ€æœ¯å€ºçš„æ—¶é—´å°½é‡å¾€åŽæ‹–ä¸€æ‹–ã€‚ å¾®æœåŠ¡ä¸€èˆ¬éƒ½æ˜¯éƒ¨ç½²åœ¨è™šæ‹Ÿæœºæˆ–å®¹å™¨ä¸Šçš„ï¼Œéšç€åº”ç”¨è§„æ¨¡çš„ä¸æ–­å¢žåŠ ï¼Œè™šæ‹ŸæœºæŠ¢å·¥ä½œï¼ˆVM wrangling workï¼‰çš„æƒ…å†µä¹Ÿä¼šè¿…é€Ÿå¢žåŠ ã€‚ä»»åŠ¡çš„åˆ†é…ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡å®¹å™¨ç¾¤ï¼ˆcontainer fleetï¼‰ç®¡ç†å·¥å…·æ¥è‡ªåŠ¨å®žçŽ°çš„ã€‚ é¢è¯•åŠ åˆ†é¡¹ å¯¹äºŽå¾®æœåŠ¡çš„ç§¯æžæ€åº¦ï¼Œè™½ç„¶åˆå§‹æˆæœ¬ä¼šæ¯”å•ä½“æž¶æž„è¦é«˜ä¸€äº›ã€‚çŸ¥é“å¾®æœåŠ¡çš„æ€§èƒ½å’Œæ‰©å®¹åœ¨é•¿æœŸçœ‹æ¥è¡¨çŽ°æ›´ä½³ã€‚ åœ¨å¾®æœåŠ¡æž¶æž„å’Œå•ä½“æž¶æž„åº”ç”¨ä¸Šéƒ½æœ‰å®žæˆ˜ç»éªŒã€‚èƒ½å¤Ÿä½¿åº”ç”¨ä¸­çš„å„é¡¹æœåŠ¡åœ¨ä»£ç å±‚é¢äº’ç›¸ç‹¬ç«‹ï¼Œä½†æ˜¯åˆå¯ä»¥åœ¨å¼€å‘åˆæœŸè¿…é€Ÿåœ°å°†å„é¡¹æœåŠ¡æ‰“åŒ…æˆä¸€æ•´ä¸ªçš„å•ä½“æž¶æž„åº”ç”¨ã€‚å¾®æœåŠ¡åŒ–çš„æ”¹é€ å¯ä»¥åœ¨åº”ç”¨ç›¸å½“æˆç†Ÿä¹‹åŽï¼Œæ”¹é€ æˆæœ¬åœ¨å¯æ‰¿å—èŒƒå›´å†…çš„æ—¶å€™å†è¿›è¡Œã€‚ é¢è¯•å‡åˆ†é¡¹ ä¸çŸ¥é“å•ä½“æž¶æž„å’Œå¾®æœåŠ¡æž¶æž„çš„åŒºåˆ«ã€‚ ä¸çŸ¥é“å¾®æœåŠ¡æž¶æž„é¢å¤–çš„å¼€é”€ï¼Œæˆ–è€…æ²¡æœ‰å®žé™…ç»éªŒã€‚ ä¸çŸ¥é“å¾®æœåŠ¡æž¶æž„ä¸­ï¼ŒIPC å’Œç½‘ç»œé€šä¿¡æ‰€å¯¼è‡´çš„é¢å¤–çš„æ€§èƒ½å¼€é”€ã€‚ è¿‡åˆ†è´¬ä½Žå¾®æœåŠ¡ã€‚è¯´ä¸æ¸…æ¥šä»€ä¹ˆæ—¶å€™åº”è¯¥æŠŠå•ä½“æž¶æž„åº”ç”¨è§£è€¦æˆå¾®æœåŠ¡ã€‚ ä½Žä¼°äº†å¯ç‹¬ç«‹æ‰©å®¹çš„å¾®æœåŠ¡çš„ä¼˜åŠ¿ã€‚ å¼‚æ­¥ç¼–ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿåˆä¸ºä»€ä¹ˆåœ¨ JavaScript ä¸­è¿™ä¹ˆé‡è¦ï¼Ÿåœ¨åŒæ­¥ç¼–ç¨‹ä¸­ï¼Œä»£ç ä¼šæŒ‰é¡ºåºè‡ªé¡¶å‘ä¸‹ä¾æ¬¡æ‰§è¡Œï¼ˆæ¡ä»¶è¯­å¥å’Œå‡½æ•°è°ƒç”¨é™¤å¤–ï¼‰ï¼Œå¦‚æžœé‡åˆ°ç½‘ç»œè¯·æ±‚æˆ–è€…ç£ç›˜è¯»/å†™ï¼ˆI/Oï¼‰è¿™ç±»è€—æ—¶çš„ä»»åŠ¡ï¼Œå°±ä¼šå µå¡žåœ¨è¿™æ ·çš„åœ°æ–¹ã€‚ åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼ŒJS è¿è¡Œåœ¨äº‹ä»¶å¾ªçŽ¯ï¼ˆevent loopï¼‰ä¸­ã€‚å½“éœ€è¦æ‰§è¡Œä¸€ä¸ªé˜»å¡žæ“ä½œï¼ˆblocking operationï¼‰æ—¶ï¼Œä¸»çº¿ç¨‹å‘èµ·ä¸€ä¸ªï¼ˆå¼‚æ­¥ï¼‰è¯·æ±‚ï¼Œï¼ˆå·¥ä½œçº¿ç¨‹å°±ä¼šåŽ»æ‰§è¡Œè¿™ä¸ªå¼‚æ­¥æ“ä½œï¼Œï¼‰åŒæ—¶ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡ŒåŽé¢çš„ä»£ç ã€‚ï¼ˆå·¥ä½œçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åŽï¼Œï¼‰å°±ä¼šå‘èµ·å“åº”ï¼Œè§¦å‘ä¸­æ–­ï¼ˆinterruptï¼‰ï¼Œæ‰§è¡Œäº‹ä»¶å¤„ç†ç¨‹åºï¼ˆevent handlerï¼‰ï¼Œæ‰§è¡Œå®ŒåŽä¸»çº¿ç¨‹ç»§ç»­å¾€åŽèµ°ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸€ä¸ªç¨‹åºçº¿ç¨‹å°±å¯ä»¥å¤„ç†å¤§é‡çš„å¹¶å‘æ“ä½œäº†ã€‚ ç”¨æˆ·ç•Œé¢ï¼ˆuser interfaceï¼ŒUIï¼‰å¤©ç„¶å°±æ˜¯å¼‚æ­¥çš„ï¼Œå¤§éƒ¨åˆ†æ—¶é—´å®ƒéƒ½åœ¨ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œä»Žè€Œä¸­æ–­äº‹ä»¶å¾ªçŽ¯ï¼Œè§¦å‘äº‹ä»¶å¤„ç†ç¨‹åºã€‚ Node.js é»˜è®¤æ˜¯å¼‚æ­¥çš„ï¼Œé‡‡ç”¨å®ƒæž„å»ºçš„æœåŠ¡ç«¯å’Œç”¨æˆ·ç•Œé¢çš„æ‰§è¡Œæœºåˆ¶å·®ä¸å¤šï¼Œåœ¨äº‹ä»¶å¾ªçŽ¯ä¸­ç­‰å¾…ç½‘ç»œè¯·æ±‚ï¼Œç„¶åŽä¸€ä¸ªæŽ¥ä¸€ä¸ªåœ°å¤„ç†è¿™äº›è¯·æ±‚ã€‚ å¼‚æ­¥åœ¨ JavaScript ä¸­éžå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒæ—¢é€‚åˆç¼–å†™ UIï¼Œåœ¨æœåŠ¡ç«¯ä¹Ÿæœ‰ä¸Šä½³çš„æ€§èƒ½è¡¨çŽ°ã€‚ é¢è¯•åŠ åˆ†é¡¹ ç†è§£é˜»å¡žçš„å«ä¹‰ï¼Œä»¥åŠå¯¹æ€§èƒ½å¸¦æ¥çš„å½±å“ã€‚ ç†è§£äº‹ä»¶å¤„ç†ç¨‹åºï¼Œä»¥åŠå®ƒä¸ºä»€ä¹ˆå¯¹ UI éƒ¨åˆ†çš„ä»£ç å¾ˆé‡è¦ã€‚ é¢è¯•å‡åˆ†é¡¹ä¸ç†Ÿæ‚‰åŒæ­¥ã€å¼‚æ­¥çš„æ¦‚å¿µã€‚è®²ä¸æ¸…æ¥šå¼‚æ­¥ä»£ç å’Œ UI ä»£ç çš„æ€§èƒ½å½±å“ï¼Œä¹Ÿè¯´ä¸æ˜Žç™½å®ƒä¿©ä¹‹é—´çš„å…³ç³»ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Interview</category>
      </categories>
      <tags>
        <tag>Interview</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯å·¥ç¨‹ç²¾ç²¹ï¼ˆä¸€ï¼‰ï¼šé™æ€èµ„æºç‰ˆæœ¬æ›´æ–°ä¸Žç¼“å­˜]]></title>
    <url>%2F2018%2F04%2F22%2F%E6%80%A7%E8%83%BD%2F%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E7%B2%BE%E7%B2%B9%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0%E4%B8%8E%E7%BC%93%E5%AD%98%2F</url>
    <content type="text"><![CDATA[æ¯ä¸ªå‚ä¸Žè¿‡å¼€å‘ä¼ä¸šçº§webåº”ç”¨çš„å‰ç«¯å·¥ç¨‹å¸ˆæˆ–è®¸éƒ½æ›¾æ€è€ƒè¿‡å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ–¹é¢çš„é—®é¢˜ã€‚æˆ‘ä»¬æœ‰é›…è™Ž14æ¡æ€§èƒ½ä¼˜åŒ–åŽŸåˆ™ï¼Œè¿˜æœ‰ä¸¤æœ¬å¾ˆç»å…¸çš„æ€§èƒ½ä¼˜åŒ–æŒ‡å¯¼ä¹¦ï¼šã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾æŒ‡å—ã€‹ã€ã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾è¿›é˜¶æŒ‡å—ã€‹ã€‚ç»éªŒä¸°å¯Œçš„å·¥ç¨‹å¸ˆå¯¹äºŽå‰ç«¯æ€§èƒ½ä¼˜åŒ–æ–¹æ³•è€³æ¿¡ç›®æŸ“ï¼ŒåŸºæœ¬éƒ½èƒ½ä¸€ä¸€åˆ—ä¸¾å‡ºæ¥ã€‚è¿™äº›æ€§èƒ½ä¼˜åŒ–åŽŸåˆ™å¤§æ¦‚æ˜¯åœ¨7å¹´å‰æå‡ºçš„ï¼Œå¯¹äºŽwebæ€§èƒ½ä¼˜åŒ–è‡³ä»Šéƒ½æœ‰éžå¸¸é‡è¦çš„æŒ‡å¯¼æ„ä¹‰ã€‚ ç„¶è€Œï¼Œå¯¹äºŽæž„å»ºå¤§åž‹webåº”ç”¨çš„å›¢é˜Ÿæ¥è¯´ï¼Œè¦åšæŒè´¯å½»è¿™äº›ä¼˜åŒ–åŽŸåˆ™å¹¶ä¸æ˜¯ä¸€ä»¶ååˆ†å®¹æ˜“çš„äº‹ã€‚å› ä¸ºä¼˜åŒ–åŽŸåˆ™ä¸­å¾ˆå¤šè¦æ±‚æ˜¯ä¸Žå·¥ç¨‹ç®¡ç†ç›¸è¿èƒŒçš„ï¼Œæ¯”å¦‚â€œæŠŠcssæ”¾åœ¨å¤´éƒ¨â€å’Œâ€œæŠŠjsæ”¾åœ¨å°¾éƒ¨â€è¿™ä¸¤æ¡åŽŸåˆ™ï¼Œæˆ‘ä»¬ä¸èƒ½è®©å›¢é˜Ÿçš„å·¥ç¨‹å¸ˆåœ¨å†™æ ·å¼å’Œè„šæœ¬å¼•ç”¨çš„æ—¶å€™éƒ½åŽ»ä¿®æ”¹ä¸€ä¸ªç›¸åŒçš„é¡µé¢æ–‡ä»¶ã€‚è¿™æ ·åšä¼šä¸¥é‡å½±å“å›¢é˜Ÿæˆå‘˜é—´å¹¶è¡Œå¼€å‘çš„æ•ˆçŽ‡ï¼Œå°¤å…¶æ˜¯åœ¨å›¢é˜Ÿæœ‰ç‰ˆæœ¬ç®¡ç†çš„æƒ…å†µä¸‹ï¼Œæ¯å¤©è¦èŠ±å¤§é‡çš„æ—¶é—´è¿›è¡Œä»£ç ä¿®æ”¹åˆå¹¶ï¼Œè¿™é¡¹æˆæœ¬æ˜¯éš¾ä»¥æŽ¥å—çš„ã€‚å› æ­¤åœ¨å‰ç«¯å·¥ç¨‹ç•Œï¼Œæ€»ä¼šçœ‹åˆ°å‘¨æœŸæ€§çš„æ€§èƒ½ä¼˜åŒ–å·¥ä½œï¼Œè¾›å‹¤çš„å‰ç«¯å·¥ç¨‹å¸ˆä»¬æ¯åˆ°æœˆåœ†ä¹‹å¤œå°±ä¼šå€¾å·¢å‡ºåŠ¨æ ¹æ®ä¼˜åŒ–åŽŸåˆ™åšä¸€æ¬¡æ€§èƒ½ä¼˜åŒ–ã€‚ æœ¬æ–‡ä»Žä¸€ä¸ªå…¨æ–°çš„è§†è§’æ¥æ€è€ƒwebæ€§èƒ½ä¼˜åŒ–ä¸Žå‰ç«¯å·¥ç¨‹ä¹‹é—´çš„å…³ç³»ï¼Œé€šè¿‡è§£è¯»ç™¾åº¦å‰ç«¯é›†æˆè§£å†³æ–¹æ¡ˆå°ç»„ï¼ˆF.I.Sï¼‰åœ¨æ‰“é€ é«˜æ€§èƒ½å‰ç«¯æž¶æž„å¹¶ç»Ÿä¸€ç™¾åº¦40å¤šæ¡å‰ç«¯äº§å“çº¿çš„è¿‡ç¨‹ä¸­æ‰€ç»åŽ†çš„æŠ€æœ¯å°è¯•ï¼Œæ­ç¤ºå‰ç«¯æ€§èƒ½ä¼˜åŒ–åœ¨å‰ç«¯æž¶æž„åŠå¼€å‘å·¥å…·è®¾è®¡å±‚é¢çš„å®žçŽ°æ€è·¯ã€‚ æ€§èƒ½ä¼˜åŒ–åŽŸåˆ™åŠåˆ†ç±»ç¬”è€…å…ˆå‡è®¾æœ¬æ–‡çš„è¯»è€…æ˜¯æœ‰å‰ç«¯å¼€å‘ç»éªŒçš„å·¥ç¨‹å¸ˆï¼Œå¹¶å¯¹ä¼ä¸šçº§webåº”ç”¨å¼€å‘åŠæ€§èƒ½ä¼˜åŒ–æœ‰ä¸€å®šçš„æ€è€ƒï¼Œå› æ­¤æˆ‘ä¸ä¼šé‡å¤ä»‹ç»é›…è™Ž14æ¡æ€§èƒ½ä¼˜åŒ–åŽŸåˆ™ã€‚å¦‚æžœæ‚¨æ²¡æœ‰è¿™äº›å‰ç»­çŸ¥è¯†ï¼Œè¯·ç§»æ­¥è¿™é‡Œæ¥å­¦ä¹ ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠé›…è™Ž14æ¡ä¼˜åŒ–åŽŸåˆ™ï¼Œã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾æŒ‡å—ã€‹ä»¥åŠã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾è¿›é˜¶æŒ‡å—ã€‹ä¸­æåˆ°çš„ä¼˜åŒ–ç‚¹åšä¸€æ¬¡æ¢³ç†ï¼ŒæŒ‰ç…§ä¼˜åŒ–æ–¹å‘åˆ†ç±»ï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€å¼ è¡¨æ ¼ï¼š ä¼˜åŒ–æ–¹å‘ ä¼˜åŒ–æ‰‹æ®µ è¯·æ±‚æ•°é‡ åˆå¹¶è„šæœ¬å’Œæ ·å¼è¡¨ï¼ŒCSS Spritesï¼Œæ‹†åˆ†åˆå§‹åŒ–è´Ÿè½½ï¼Œåˆ’åˆ†ä¸»åŸŸ è¯·æ±‚å¸¦å®½ å¯GZipï¼Œç²¾ç®€JavaScriptï¼Œç§»é™¤é‡å¤è„šæœ¬ï¼Œå›¾åƒä¼˜åŒ– ç¼“å­˜åˆ©ç”¨ ä½¿ç”¨CDNï¼Œä½¿ç”¨å¤–éƒ¨JavaScriptå’ŒCSSï¼Œæ·»åŠ Expireså¤´ï¼Œå‡å°‘DNSæŸ¥æ‰¾ï¼Œé…ç½®ETagï¼Œä½¿AjaXå¯ç¼“å­˜ é¡µé¢ç»“æž„ å°†æ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨ï¼Œå°†è„šæœ¬æ”¾åœ¨åº•éƒ¨ï¼Œå°½æ—©åˆ·æ–°æ–‡æ¡£çš„è¾“å‡º ä»£ç æ ¡éªŒ é¿å…CSSè¡¨è¾¾å¼ï¼Œé¿å…é‡å®šå‘ è¡¨æ ¼1 æ€§èƒ½ä¼˜åŒ–åŽŸåˆ™åˆ†ç±» ç›®å‰å¤§å¤šæ•°å‰ç«¯å›¢é˜Ÿå¯ä»¥åˆ©ç”¨yui compressoræˆ–è€…google closure compilerç­‰åŽ‹ç¼©å·¥å…·å¾ˆå®¹æ˜“åšåˆ°â€œç²¾ç®€Javascriptâ€è¿™æ¡åŽŸåˆ™ï¼› åŒæ ·çš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å›¾ç‰‡åŽ‹ç¼©å·¥å…·å¯¹å›¾åƒè¿›è¡ŒåŽ‹ç¼©ï¼Œå®žçŽ°â€œå›¾åƒä¼˜åŒ–â€åŽŸåˆ™ã€‚è¿™ä¸¤æ¡åŽŸåˆ™æ˜¯å¯¹å•ä¸ªèµ„æºçš„å¤„ç†ï¼Œå› æ­¤ä¸ä¼šå¼•èµ·ä»»ä½•å·¥ç¨‹æ–¹é¢çš„é—®é¢˜ã€‚ å¾ˆå¤šå›¢é˜Ÿä¹Ÿé€šè¿‡å¼•å…¥ä»£ç æ ¡éªŒæµç¨‹æ¥ç¡®ä¿å®žçŽ°â€œé¿å…cssè¡¨è¾¾å¼â€å’Œâ€œé¿å…é‡å®šå‘â€åŽŸåˆ™ã€‚ ç›®å‰ç»å¤§å¤šæ•°äº’è”ç½‘å…¬å¸ä¹Ÿå·²ç»å¼€å¯äº†æœåŠ¡ç«¯çš„GzipåŽ‹ç¼©ï¼Œå¹¶ä½¿ç”¨CDNå®žçŽ°é™æ€èµ„æºçš„ç¼“å­˜å’Œå¿«é€Ÿè®¿é—®ï¼› ä¸€äº›æŠ€æœ¯å®žåŠ›é›„åŽšçš„å‰ç«¯å›¢é˜Ÿç”šè‡³ç ”å‘å‡ºäº†è‡ªåŠ¨CSS Spriteså·¥å…·ï¼Œè§£å†³äº†CSS Spritesåœ¨å·¥ç¨‹ç»´æŠ¤æ–¹é¢çš„éš¾é¢˜ã€‚ ä½¿ç”¨â€œæŸ¥æ‰¾-æ›¿æ¢â€æ€è·¯ï¼Œæˆ‘ä»¬ä¼¼ä¹Žä¹Ÿå¯ä»¥å¾ˆå¥½çš„å®žçŽ°â€œåˆ’åˆ†ä¸»åŸŸâ€åŽŸåˆ™ã€‚ æˆ‘ä»¬æŠŠä»¥ä¸Šè¿™äº›å·²ç»æˆç†Ÿåº”ç”¨åˆ°å®žé™…ç”Ÿäº§ä¸­çš„ä¼˜åŒ–æ‰‹æ®µåŽ»é™¤æŽ‰ï¼Œç•™ä¸‹é‚£äº›è¿˜æ²¡æœ‰å¾ˆå¥½å®žçŽ°çš„ä¼˜åŒ–åŽŸåˆ™ã€‚å†æ¥å›žé¡¾ä¸€ä¸‹ä¹‹å‰çš„æ€§èƒ½ä¼˜åŒ–åˆ†ç±»ï¼š ä¼˜åŒ–æ–¹å‘ ä¼˜åŒ–æ‰‹æ®µ è¯·æ±‚æ•°é‡ åˆå¹¶è„šæœ¬å’Œæ ·å¼è¡¨ï¼Œæ‹†åˆ†åˆå§‹åŒ–è´Ÿè½½ è¯·æ±‚å¸¦å®½ ç§»é™¤é‡å¤è„šæœ¬ ç¼“å­˜åˆ©ç”¨ æ·»åŠ Expireså¤´ï¼Œé…ç½®ETagï¼Œä½¿Ajaxå¯ç¼“å­˜ é¡µé¢ç»“æž„ å°†æ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨ï¼Œå°†è„šæœ¬æ”¾åœ¨åº•éƒ¨ï¼Œå°½æ—©åˆ·æ–°æ–‡æ¡£çš„è¾“å‡º è¡¨æ ¼2 è¾ƒéš¾å®žçŽ°çš„ä¼˜åŒ–åŽŸåˆ™ çŽ°åœ¨æœ‰å¾ˆå¤šé¡¶å°–çš„å‰ç«¯å›¢é˜Ÿå¯ä»¥å°†ä¸Šè¿°è¿˜å‰©ä¸‹çš„ä¼˜åŒ–åŽŸåˆ™ä¹Ÿéƒ½ä¸€ä¸€è§£å†³ï¼Œä½†ä¸šç•Œå¤§å¤šæ•°å›¢é˜Ÿéƒ½è¿˜æ²¡èƒ½å¾ˆå¥½çš„è§£å†³è¿™äº›é—®é¢˜ã€‚å› æ­¤ï¼Œæœ¬æ–‡å°†å°±è¿™äº›åŽŸåˆ™çš„è§£å†³æ–¹æ¡ˆåšè¿›ä¸€æ­¥çš„åˆ†æžä¸Žè®²è§£ï¼Œä»Žè€Œä¸ºé‚£äº›è¿˜æ²¡æœ‰è¿›å…¥å‰ç«¯å·¥ä¸šåŒ–å¼€å‘çš„å›¢é˜Ÿæä¾›ä¸€äº›åŸºç¡€æŠ€æœ¯å»ºè®¾æ„è§ï¼Œä¹Ÿå€Ÿæ­¤æœºä¼šä¸Žä¸šç•Œé¡¶å°–çš„å‰ç«¯å›¢é˜Ÿåœ¨å·¥ä¸šåŒ–å·¥ç¨‹åŒ–æ–¹å‘ä¸Šäº¤æµä¸€ä¸‹å½¼æ­¤çš„å¿ƒå¾—ã€‚ é™æ€èµ„æºç‰ˆæœ¬æ›´æ–°ä¸Žç¼“å­˜å¦‚è¡¨æ ¼2æ‰€ç¤ºï¼Œâ€œç¼“å­˜åˆ©ç”¨â€åˆ†ç±»ä¸­ä¿ç•™äº†â€œæ·»åŠ Expireså¤´â€å’Œâ€œé…ç½®ETagâ€ä¸¤é¡¹ã€‚æˆ–è®¸æœ‰äº›äººä¼šè´¨ç–‘ï¼Œæ˜Žæ˜Žè¿™ä¸¤é¡¹åªè¦é…ç½®äº†æœåŠ¡å™¨çš„ç›¸å…³é€‰é¡¹å°±å¯ä»¥å®žçŽ°ï¼Œä¸ºä»€ä¹ˆè¯´å®ƒä»¬éš¾ä»¥è§£å†³å‘¢ï¼Ÿç¡®å®žï¼Œå¼€å¯è¿™ä¸¤é¡¹å¾ˆå®¹æ˜“ï¼Œä½†å¼€å¯äº†ç¼“å­˜åŽï¼Œæˆ‘ä»¬çš„é¡¹ç›®å°±å¼€å§‹é¢ä¸´å¦ä¸€ä¸ªæŒ‘æˆ˜ï¼šå¦‚ä½•æ›´æ–°è¿™äº›ç¼“å­˜ã€‚ ç›¸ä¿¡å¤§å¤šæ•°å›¢é˜Ÿä¹Ÿæ‰¾åˆ°äº†ç±»ä¼¼çš„ç­”æ¡ˆï¼Œå®ƒå’Œã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾æŒ‡å—ã€‹å…³äºŽâ€œæ·»åŠ Expireså¤´â€æ‰€è¯´çš„åŽŸåˆ™ä¸€æ ·â€”â€”ä¿®è®¢æ–‡ä»¶åã€‚å³ï¼š æœ€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆæ˜¯ä¿®æ”¹å…¶æ‰€æœ‰é“¾æŽ¥ï¼Œè¿™æ ·ï¼Œå…¨æ–°çš„è¯·æ±‚å°†ä»ŽåŽŸå§‹æœåŠ¡å™¨ä¸‹è½½æœ€æ–°çš„å†…å®¹ã€‚ æ€è·¯æ²¡é”™ï¼Œä½†è¦æ€Žä¹ˆæ”¹å˜é“¾æŽ¥å‘¢ï¼Ÿå˜æˆä»€ä¹ˆæ ·çš„é“¾æŽ¥æ‰èƒ½æœ‰æ•ˆæ›´æ–°ç¼“å­˜ï¼Œåˆèƒ½æœ€å¤§é™åº¦é¿å…é‚£äº›æ²¡æœ‰ä¿®æ”¹è¿‡çš„æ–‡ä»¶ç¼“å­˜ä¸å¤±æ•ˆå‘¢ï¼Ÿ å…ˆæ¥çœ‹çœ‹çŽ°åœ¨ä¸€èˆ¬å‰ç«¯å›¢é˜Ÿçš„åšæ³•ï¼š1&lt;script scr = "a.js?t=202131"&gt;&lt;/script&gt; æˆ–è€…1&lt;script src = "a.js?v=1.0.0"&gt;&lt;/script&gt; å¤§å®¶ä¼šé‡‡ç”¨æ·»åŠ queryçš„å½¢å¼ä¿®æ”¹é“¾æŽ¥ã€‚è¿™æ ·åšæ˜¯æ¯”è¾ƒç›´è§‚çš„è§£å†³æ–¹æ¡ˆï¼Œä½†åœ¨è®¿é—®é‡è¾ƒå¤§çš„ç½‘ç«™ï¼Œè¿™ä¹ˆåšå¯èƒ½å°†é¢ä¸´ä¸€äº›æ–°çš„é—®é¢˜ã€‚ é€šå¸¸ä¸€ä¸ªå¤§åž‹çš„webåº”ç”¨å‡ ä¹Žæ¯å¤©éƒ½ä¼šæœ‰è¿­ä»£å’Œæ›´æ–°ï¼Œå‘å¸ƒæ–°ç‰ˆæœ¬ä¹Ÿå°±æ˜¯å‘å¸ƒæ–°çš„é™æ€èµ„æºå’Œé¡µé¢çš„è¿‡ç¨‹ã€‚ä»¥ä¸Šè¿°ä»£ç ä¸ºä¾‹ï¼Œå‡è®¾çŽ°åœ¨çº¿ä¸Šè¿è¡Œç€index.htmlæ–‡ä»¶ï¼Œå¹¶ä¸”ä½¿ç”¨äº†çº¿ä¸Šçš„a.jsèµ„æºã€‚index.htmlçš„å†…å®¹ä¸ºï¼š 1&lt;script src = "a.js?v=1.0.0"&gt;&lt;/script&gt; è¿™æ¬¡æˆ‘ä»¬æ›´æ–°äº†é¡µé¢ä¸­çš„ä¸€äº›å†…å®¹ï¼Œå¾—åˆ°ä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼Œå¹¶å¼€å‘äº†æ–°çš„ä¸Žä¹‹åŒ¹é…çš„a.jsèµ„æºæ¥å®Œæˆé¡µé¢äº¤äº’ï¼Œæ–°çš„index.htmlæ–‡ä»¶çš„å†…å®¹å› æ­¤è€Œå˜æˆäº†1&lt;script src = "a.js?v=1.0.1"&gt;&lt;/script&gt; å¥½äº†ï¼ŒçŽ°åœ¨è¦å¼€å§‹å°†ä¸¤ä»½æ–°çš„æ–‡ä»¶å‘å¸ƒåˆ°çº¿ä¸ŠåŽ»ã€‚å¯ä»¥çœ‹åˆ°ï¼Œindex.htmlå’Œa.jsçš„èµ„æºå®žé™…ä¸Šæ˜¯è¦è¦†ç›–çº¿ä¸Šçš„åŒåæ–‡ä»¶çš„ã€‚ä¸ç®¡æ€Žæ ·ï¼Œåœ¨å‘å¸ƒçš„è¿‡ç¨‹ä¸­ï¼Œindex.htmlå’Œa.jsæ€»æœ‰ä¸€ä¸ªå…ˆåŽçš„é¡ºåºï¼Œä»Žè€Œä¸­é—´å‡ºçŽ°ä¸€æ®µæˆ–å¤§æˆ–å°çš„æ—¶é—´é—´éš”ã€‚å¯¹äºŽä¸€ä¸ªå¤§åž‹äº’è”ç½‘åº”ç”¨æ¥è¯´å³ä½¿åœ¨ä¸€ä¸ªå¾ˆå°çš„æ—¶é—´é—´éš”å†…ï¼Œéƒ½æœ‰å¯èƒ½å‡ºçŽ°æ–°ç”¨æˆ·è®¿é—®ã€‚åœ¨è¿™ä¸ªæ—¶é—´é—´éš”ä¸­ï¼Œè®¿é—®äº†ç½‘ç«™çš„ç”¨æˆ·ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ 1.å¦‚æžœå…ˆè¦†ç›–index.htmlï¼ŒåŽè¦†ç›–a.jsï¼Œç”¨æˆ·åœ¨è¿™ä¸ªæ—¶é—´é—´éš™è®¿é—®ï¼Œä¼šå¾—åˆ°æ–°çš„index.htmlé…åˆæ—§çš„a.jsçš„æƒ…å†µï¼Œä»Žè€Œå‡ºçŽ°é”™è¯¯çš„é¡µé¢ã€‚2.å¦‚æžœå…ˆè¦†ç›–a.jsï¼ŒåŽè¦†ç›–index.htmlï¼Œç”¨æˆ·åœ¨è¿™ä¸ªé—´éš™è®¿é—®ï¼Œä¼šå¾—åˆ°æ—§çš„index.htmlé…åˆæ–°çš„a.jsçš„æƒ…å†µï¼Œä»Žè€Œä¹Ÿå‡ºçŽ°äº†é”™è¯¯çš„é¡µé¢ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¤§åž‹webåº”ç”¨åœ¨ç‰ˆæœ¬ä¸Šçº¿çš„è¿‡ç¨‹ä¸­ç»å¸¸ä¼šè¾ƒé›†ä¸­çš„å‡ºçŽ°å‰ç«¯æŠ¥é”™æ—¥å¿—çš„åŽŸå› ï¼Œä¹Ÿæ˜¯ä¸€äº›äº’è”ç½‘å…¬å¸é€‰æ‹©åŠ ç­åˆ°åŠå¤œç­‰å¾…è®¿é—®ä½Žå³°æœŸå†ä¸Šçº¿çš„åŽŸå› ä¹‹ä¸€ã€‚æ­¤å¤–ï¼Œç”±äºŽé™æ€èµ„æºæ–‡ä»¶ç‰ˆæœ¬æ›´æ–°æ˜¯â€œè¦†ç›–å¼â€çš„ï¼Œè€Œé¡µé¢éœ€è¦é€šè¿‡ä¿®æ”¹queryæ¥æ›´æ–°ï¼Œå¯¹äºŽä½¿ç”¨CDNç¼“å­˜çš„webäº§å“æ¥è¯´ï¼Œè¿˜å¯èƒ½é¢ä¸´CDNç¼“å­˜æ”»å‡»çš„é—®é¢˜ã€‚æˆ‘ä»¬å†æ¥è§‚å¯Ÿä¸€ä¸‹å‰é¢è¯´çš„ç‰ˆæœ¬æ›´æ–°æ‰‹æ®µï¼š1&lt;script src = "a.js?v=1.0.0"&gt;&lt;/script&gt; æˆ‘ä»¬ä¸éš¾é¢„æµ‹ï¼Œa.jsçš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬æ˜¯â€œ1.0.1â€ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ»æ„æž„é€ ä¸€ä¸²è¿™æ ·çš„è¯·æ±‚â€œa.js?v=1.0.1â€ã€â€œa.js?v=1.0.2â€ã€â€¦â€¦è®©CDNå°†å½“å‰çš„èµ„æºç¼“å­˜ä¸ºâ€œæœªæ¥çš„ç‰ˆæœ¬â€ã€‚è¿™æ ·å½“è¿™ä¸ªé¡µé¢æ‰€ç”¨çš„èµ„æºæœ‰æ›´æ–°æ—¶ï¼Œå³ä½¿æ›´æ”¹äº†é“¾æŽ¥åœ°å€ï¼Œä¹Ÿä¼šå› ä¸ºCDNçš„åŽŸå› è¿”å›žç»™ç”¨æˆ·æ—§ç‰ˆæœ¬çš„é™æ€èµ„æºï¼Œä»Žè€Œé€ æˆé¡µé¢é”™è¯¯ã€‚å³ä¾¿ä¸æ˜¯åˆ»æ„åˆ¶é€ çš„æ”»å‡»ï¼Œåœ¨ä¸Šçº¿é—´éš™å‡ºçŽ°è®¿é—®ä¹Ÿå¯èƒ½å¯¼è‡´åŒºåŸŸæ€§çš„CDNç¼“å­˜é”™è¯¯ã€‚ æ­¤å¤–ï¼Œå½“ç‰ˆæœ¬æœ‰æ›´æ–°æ—¶ï¼Œä¿®æ”¹æ‰€æœ‰å¼•ç”¨é“¾æŽ¥ä¹Ÿæ˜¯ä¸€ä»¶ä¸Žå·¥ç¨‹ç®¡ç†ç›¸æ‚–çš„äº‹ï¼Œè‡³å°‘æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯ä»¥â€œæŸ¥æ‰¾-æ›¿æ¢â€çš„å·¥å…·æ¥è‡ªåŠ¨åŒ–çš„è§£å†³ç‰ˆæœ¬å·ä¿®æ”¹çš„é—®é¢˜ã€‚ å¯¹ä»˜è¿™ä¸ªé—®é¢˜ï¼Œç›®å‰æ¥è¯´æœ€ä¼˜æ–¹æ¡ˆå°±æ˜¯åŸºäºŽæ–‡ä»¶å†…å®¹çš„hashç‰ˆæœ¬å†—ä½™æœºåˆ¶äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›å·¥ç¨‹å¸ˆæºç æ˜¯è¿™ä¹ˆå†™çš„ï¼š1&lt;script src = "a.js?v=1.0.0"&gt;&lt;/script&gt; ä½†æ˜¯çº¿ä¸Šä»£ç æ˜¯è¿™æ ·çš„1&lt;script src = "a_2131e3.js"&gt;&lt;/script&gt; å…¶ä¸­â€_82244e91â€è¿™ä¸²å­—ç¬¦æ˜¯æ ¹æ®a.jsçš„æ–‡ä»¶å†…å®¹è¿›è¡Œhashè¿ç®—å¾—åˆ°çš„ï¼Œåªæœ‰æ–‡ä»¶å†…å®¹å‘ç”Ÿå˜åŒ–äº†æ‰ä¼šæœ‰æ›´æ”¹ã€‚ç”±äºŽç‰ˆæœ¬åºåˆ—æ˜¯ä¸Žæ–‡ä»¶åå†™åœ¨ä¸€èµ·çš„ï¼Œè€Œä¸æ˜¯åŒåæ–‡ä»¶è¦†ç›–ï¼Œå› æ­¤ä¸ä¼šå‡ºçŽ°ä¸Šè¿°è¯´çš„é‚£äº›é—®é¢˜ã€‚åŒæ—¶ï¼Œè¿™ä¹ˆåšè¿˜æœ‰å…¶ä»–çš„å¥½å¤„ï¼š 1.çº¿ä¸Šçš„a.jsä¸æ˜¯åŒåæ–‡ä»¶è¦†ç›–ï¼Œè€Œæ˜¯æ–‡ä»¶å+hashçš„å†—ä½™ï¼Œæ‰€ä»¥å¯ä»¥å…ˆä¸Šçº¿é™æ€èµ„æºï¼Œå†ä¸Šçº¿htmlé¡µé¢ï¼Œä¸å­˜åœ¨é—´éš™é—®é¢˜ï¼›2.é‡åˆ°é—®é¢˜å›žæ»šç‰ˆæœ¬çš„æ—¶å€™ï¼Œæ— éœ€å›žæ»ša.jsï¼Œåªé¡»å›žæ»šé¡µé¢å³å¯ï¼›3.ç”±äºŽé™æ€èµ„æºç‰ˆæœ¬å·æ˜¯æ–‡ä»¶å†…å®¹çš„hashï¼Œå› æ­¤æ‰€æœ‰é™æ€èµ„æºå¯ä»¥å¼€å¯æ°¸ä¹…å¼ºç¼“å­˜ï¼Œåªæœ‰æ›´æ–°äº†å†…å®¹çš„æ–‡ä»¶æ‰ä¼šç¼“å­˜å¤±æ•ˆï¼Œç¼“å­˜åˆ©ç”¨çŽ‡å¤§å¢žï¼›4.ä¿®æ”¹é™æ€èµ„æºåŽä¼šåœ¨çº¿ä¸Šäº§ç”Ÿæ–°çš„æ–‡ä»¶ï¼Œä¸€ä¸ªæ–‡ä»¶å¯¹åº”ä¸€ä¸ªç‰ˆæœ¬ï¼Œå› æ­¤ä¸ä¼šå—åˆ°æž„é€ CDNç¼“å­˜å½¢å¼çš„æ”»å‡» è™½ç„¶è¿™ç§æ–¹æ¡ˆæ˜¯ç›¸æ¯”ä¹‹ä¸‹æœ€å®Œç¾Žçš„è§£å†³æ–¹æ¡ˆï¼Œä½†å®ƒæ— æ³•é€šè¿‡æ‰‹å·¥çš„å½¢å¼æ¥ç»´æŠ¤ï¼Œå› ä¸ºè¦ä¾é æ‰‹å·¥çš„å½¢å¼æ¥è®¡ç®—å’Œæ›¿æ¢hashå€¼ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„æ–‡ä»¶ã€‚è¿™å°†æ˜¯ä¸€é¡¹éžå¸¸ç¹çä¸”å®¹æ˜“å‡ºé”™çš„å·¥ä½œï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å€ŸåŠ©å·¥å…·ã€‚(webpack,gulpç­‰) åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„JSON.parse()å’ŒJSON.stringify()é«˜çº§æŠ€å·§]]></title>
    <url>%2F2018%2F04%2F20%2FJs%2F%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JSON-parse-%E5%92%8CJSON-stringify-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[å‰è¨€JSONå¯¹è±¡çš„ä¸¤ä¸ªæ–¹æ³•ï¼šJSON.parse() å’Œ JSON.stringify() é€šå¸¸ç”¨åšJSONå¯¹è±¡å’Œå­—ç¬¦ä¸²ä¹‹é—´çš„ç›¸äº’è½¬æ¢; JSON.parse()JSON.parse() å¯ä»¥æŽ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒå¯ä»¥åœ¨è¿”å›žä¹‹å‰è½¬æ¢å¯¹è±¡å€¼ã€‚æ¯”å¦‚è¿™ä¾‹å­ä¸­ï¼Œå°†è¿”å›žå¯¹è±¡çš„å±žæ€§å€¼å¤§å†™ï¼š 12345678910111213141516const user = &#123; name: 'John', email: 'john@awesome.com', plan: 'Pro'&#125;;const userStr = JSON.stringify(user);const newUserStr = JSON.parse(userStr, (key, value) =&gt; &#123; if (typeof value === 'string') &#123; return value.toUpperCase(); &#125; return value;&#125;); console.log(newUserStr); //&#123;name: "JOHN", email: "JOHN@AWESOME.COM", plan: "PRO"&#125; æ³¨ï¼šå°¾éšé€—å·åœ¨JSON ä¸­æ— æ•ˆï¼Œæ‰€ä»¥å¦‚æžœä¼ é€’ç»™å®ƒçš„å­—ç¬¦ä¸²æœ‰å°¾éšé€—å·ï¼ŒJSON.parse()å°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚ JSON.stringify()JSON.stringify() å¯ä»¥å¸¦ä¸¤ä¸ªé¢å¤–çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ›¿æ¢å‡½æ•°ï¼Œç¬¬äºŒä¸ªé—´éš”å­—ç¬¦ä¸²ï¼Œç”¨ä½œéš”å¼€è¿”å›žå­—ç¬¦ä¸²ã€‚ å‚æ•°ï¼š value ï¼š å°†è¦è½¬ä¸ºJSONå­—ç¬¦ä¸²çš„javascriptå¯¹è±¡ã€‚ replacer ï¼šè¯¥å‚æ•°å¯ä»¥æ˜¯å¤šç§ç±»åž‹,å¦‚æžœæ˜¯ä¸€ä¸ªå‡½æ•°,åˆ™å®ƒå¯ä»¥æ”¹å˜ä¸€ä¸ªjavascriptå¯¹è±¡åœ¨å­—ç¬¦ä¸²åŒ–è¿‡ç¨‹ä¸­çš„è¡Œä¸º, å¦‚æžœæ˜¯ä¸€ä¸ªåŒ…å« String å’Œ Number å¯¹è±¡çš„æ•°ç»„,åˆ™å®ƒå°†ä½œä¸ºä¸€ä¸ªç™½åå•.åªæœ‰é‚£äº›é”®å­˜åœ¨åŸŸè¯¥ç™½åå•ä¸­çš„é”®å€¼å¯¹æ‰ä¼šè¢«åŒ…å«è¿›æœ€ç»ˆç”Ÿæˆçš„JSONå­—ç¬¦ä¸²ä¸­.å¦‚æžœè¯¥å‚æ•°å€¼ä¸ºnullæˆ–è€…è¢«çœç•¥,åˆ™æ‰€æœ‰çš„é”®å€¼å¯¹éƒ½ä¼šè¢«åŒ…å«è¿›æœ€ç»ˆç”Ÿæˆçš„JSONå­—ç¬¦ä¸²ä¸­ã€‚ space ï¼šè¯¥å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ª String æˆ– Number å¯¹è±¡,ä½œç”¨æ˜¯ä¸ºäº†åœ¨è¾“å‡ºçš„JSONå­—ç¬¦ä¸²ä¸­æ’å…¥ç©ºç™½ç¬¦æ¥å¢žå¼ºå¯è¯»æ€§. å¦‚æžœæ˜¯Numberå¯¹è±¡, åˆ™è¡¨ç¤ºç”¨å¤šå°‘ä¸ªç©ºæ ¼æ¥ä½œä¸ºç©ºç™½ç¬¦; æœ€å¤§å¯ä¸º10,å¤§äºŽ10çš„æ•°å€¼ä¹Ÿå–10.æœ€å°å¯ä¸º1,å°äºŽ1çš„æ•°å€¼æ— æ•ˆ,åˆ™ä¸ä¼šæ˜¾ç¤ºç©ºç™½ç¬¦. å¦‚æžœæ˜¯ä¸ª Stringå¯¹è±¡, åˆ™è¯¥å­—ç¬¦ä¸²æœ¬èº«ä¼šä½œä¸ºç©ºç™½ç¬¦,å­—ç¬¦ä¸²æœ€é•¿å¯ä¸º10ä¸ªå­—ç¬¦.è¶…è¿‡çš„è¯ä¼šæˆªå–å‰åä¸ªå­—ç¬¦. å¦‚æžœè¯¥å‚æ•°è¢«çœç•¥ (æˆ–è€…ä¸ºnull), åˆ™ä¸ä¼šæ˜¾ç¤ºç©ºç™½ç¬¦ æ›¿æ¢å‡½æ•°å¯ä»¥ç”¨æ¥è¿‡æ»¤å€¼ï¼Œå› ä¸ºä»»ä½•è¿”å›ž undefined çš„å€¼å°†ä¸åœ¨è¿”å›žçš„å­—ç¬¦ä¸²ä¸­ï¼š 12345678910111213141516const user = &#123; id: 229, name: 'John', email: 'john@awesome.com'&#125;;function replacer(key, value) &#123; console.log(typeof value); if (key === 'email') &#123; return undefined; &#125; return value;&#125;const userStr = JSON.stringify(user, replacer);// "&#123;"id":229,"name":"John"&#125;" ä¼ å…¥ä¸€ä¸ªé—´éš”å‚æ•°çš„ç¤ºä¾‹ï¼š 123456789101112const user = &#123; name: 'John', email: 'john@awesome.com', plan: 'Pro'&#125;; const userStr = JSON.stringify(user, null, '...');// "&#123;// ..."name": "John",// ..."email": "john@awesome.com",// ..."plan": "Pro"// &#125;" toJSONæ–¹æ³•å¦‚æžœä¸€ä¸ªè¢«åºåˆ—åŒ–çš„å¯¹è±¡æ‹¥æœ‰ toJSON æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥ toJSON æ–¹æ³•å°±ä¼šè¦†ç›–è¯¥å¯¹è±¡é»˜è®¤çš„åºåˆ—åŒ–è¡Œä¸ºï¼šä¸æ˜¯é‚£ä¸ªå¯¹è±¡è¢«åºåˆ—åŒ–ï¼Œè€Œæ˜¯è°ƒç”¨ toJSON æ–¹æ³•åŽçš„è¿”å›žå€¼ä¼šè¢«åºåˆ—åŒ– 12345678var obj = &#123; foo: 'foo', toJSON:function()&#123; return 'bar'; &#125;&#125;JSON.stringify(obj);//'"bar"'JSON.stringify(&#123;x:obj&#125;);//'&#123;"x":"bar"&#125;' åˆ©ç”¨toJSONæ–¹æ³•,æˆ‘ä»¬å¯ä»¥ä¿®æ”¹å¯¹è±¡è½¬æ¢æˆJSONçš„é»˜è®¤è¡Œä¸ºã€‚ ç”¨ JSON.stringify æ¥æ ¼å¼åŒ–å¯¹è±¡åœ¨å®žé™…ä½¿ç”¨ä¸­,æˆ‘ä»¬å¯èƒ½ä¼šæ ¼å¼åŒ–ä¸€äº›å¤æ‚çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡å¾€å¾€å¯¹è±¡å†…åµŒå¥—å¯¹è±¡ã€‚ç›´æŽ¥çœ‹èµ·æ¥å¹¶ä¸é‚£ä¹ˆç›´è§‚,ç»“åˆä¸Šé¢çš„çš„ replacer å’Œ space å‚æ•°,æˆ‘ä»¬å¯ä»¥è¿™æ ·æ ¼å¼åŒ–å¤æ‚å¯¹è±¡ï¼š 12345678var censor = function(key,value)&#123; if(typeof(value) == 'function')&#123; return Function.prototype.toString.call(value) &#125; return value;&#125;var foo = &#123;bar:"1",baz:3,o:&#123;name:'xiaoli',age:21,info:&#123;sex:'ç”·',getSex:function()&#123;return 'sex';&#125;&#125;&#125;&#125;;console.log(JSON.stringify(foo,censor,4)) å®žé™…è¿”å›žçš„å­—ç¬¦ä¸²ï¼Œè®°ä½æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹: 123456789101112&#123; "bar": "1", "baz": 3, "o": &#123; "name": "xiaoli", "age": 21, "info": &#123; "sex": "ç”·", "getSex": "function ()&#123;return 'sex';&#125;" &#125; &#125;&#125;]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯ä»£ç è§„èŒƒ-JSç¯‡]]></title>
    <url>%2F2018%2F04%2F19%2FRecord%2F%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83-JS%E7%AF%87%2F</url>
    <content type="text"><![CDATA[æ›´å¤šå‰ç«¯ä»£ç è§„èŒƒè¯·ç§»æ­¥ å¦‚æžœæ˜¯ä¸ªäººæˆ–è€…å°ä½œåŠå¼€å‘ï¼Œå…¶å®žè¿™äº›æ‰€è°“çš„ç¼–ç è§„èŒƒä¹Ÿæ²¡å•¥æ„æ€ï¼Œå› ä¸ºå¤§å®¶å†™å¥½çš„ä»£ç ç›´æŽ¥å°±ç»™æ‰”åˆ°ç½‘ä¸ŠåŽ»äº†ï¼Œå¾ˆå°‘æœ‰æ‰“åŒ…ã€åŽ‹ç¼©ã€æ ¡æ£€ç­‰è¿‡ç¨‹ï¼Œåˆ«äººæ¥ä¿®æ”¹ä½ ä»£ç çš„æƒ…å†µä¹Ÿæ¯”è¾ƒå°‘ã€‚ä½†æ˜¯ï¼Œå¯¹äºŽä¸€å®šè§„æ¨¡çš„å›¢é˜Ÿæ¥è¯´ï¼Œè¿™äº›ä¸œè¥¿è¿˜æ˜¯æŒºæœ‰å¿…è¦çš„ï¼ä¸€ä¸ªæ˜¯ä¿æŒä»£ç çš„æ•´æ´ç¾Žè§‚ï¼ŒåŒæ—¶è‰¯å¥½çš„ä»£ç ç¼–å†™æ ¼å¼å’Œæ³¨é‡Šæ–¹å¼å¯ä»¥è®©åŽæ¥è€…å¾ˆå¿«åœ°äº†è§£ä½ ä»£ç çš„å¤§æ¦‚æ€è·¯ï¼Œæé«˜å¼€å‘æ•ˆçŽ‡ã€‚ ä¸è§„èŒƒå†™æ³•ä¸¾ä¾‹ å¥å°¾æ²¡æœ‰åˆ†å· 1var isHotel = json.type == "hotel" ? true : false å˜é‡å‘½åå„ç§å„æ · 123var is_hotel;var isHotel;var ishotel; if ç¼©å†™ 1234if (isHotel) console.log(true)else console.log(false) ä½¿ç”¨ eval 1var json = eval(jsonText); å˜é‡æœªå®šä¹‰åˆ°å¤„éƒ½æ˜¯ 123456function() &#123; var isHotel = 'true'; ....... var html = isHotel ? '&lt;p&gt;hotel&lt;/p&gt;' : "";&#125; è¶…é•¿å‡½æ•° 12345function() &#123; var isHotel = 'true'; //....... æ­¤å¤„çœç•¥500è¡Œ return false;&#125; å‰ç«¯è§„èŒƒä¹‹JavaScriptå˜é‡ã€å¸¸é‡ã€ç±»çš„å‘½åæŒ‰ï¼ˆå¿…é¡»ï¼‰ä»¥ä¸‹è§„åˆ™æ‰§è¡Œï¼š 1ï¼‰ å˜é‡ï¼šå¿…é¡»é‡‡ç”¨éª†é©¼å³°çš„å‘½åä¸”é¦–å­—æ¯å°å†™123456789// æ­£ç¡®çš„å‘½å var isHotel, isHotelBeijing, isHotelBeijingHandian; // ä¸æŽ¨èçš„å‘½å var is_Hotel, ishotelbeijing, IsHotelBeiJing; 2ï¼‰ å¸¸é‡ï¼šå¿…é¡»é‡‡ç”¨å…¨å¤§å†™çš„å‘½åï¼Œä¸”å•è¯ä»¥_åˆ†å‰²ï¼Œå¸¸é‡é€šå¸¸ç”¨äºŽajaxè¯·æ±‚urlï¼Œå’Œä¸€äº›ä¸ä¼šæ”¹å˜çš„æ•°æ®123// æ­£ç¡®çš„å‘½å var HOTEL_GET_URL = 'http://map.baidu.com/detail', PLACE_TYPE = 'hotel'; 3ï¼‰ ç±»ï¼šå¿…é¡»é‡‡ç”¨éª†é©¼å³°çš„å‘½åä¸”é¦–å­—æ¯å¤§å†™ï¼Œå¦‚ï¼š1234// æ­£ç¡®çš„å†™æ³• var FooAndToo = function(name) &#123; this.name = name; &#125; ifä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­123456789//æ­£ç¡®çš„å†™æ³• if (isOk) &#123; console.log("ok"); &#125; //ä¸æŽ¨èçš„å†™æ³• if(isOk)&#123; console.log("ok"); &#125; ()ä¸­çš„åˆ¤æ–­æ¡ä»¶å‰åŽéƒ½(å¿…é¡»)åŠ ç©ºæ ¼ ()é‡Œçš„åˆ¤æ–­å‰åŽ(ç¦æ­¢)åŠ ç©ºæ ¼ï¼Œå¦‚ï¼šæ­£ç¡®çš„å†™æ³•: if (isOk)ï¼›ä¸æŽ¨èçš„å†™æ³•: if ( isOk ) 2ï¼‰switchä¸­çš„ç©ºæ ¼, å…ˆä¸Šä¾‹å­12345678910111213//æ­£ç¡®çš„å†™æ³• switch(name) &#123; case "hotel": console.log(name); break; case "moive": console.log(name); break; default: // code &#125; forä¸­çš„ç©ºæ ¼ï¼Œå…ˆä¸Šä¾‹å­1234567891011121314151617181920212223 // æ­£ç¡®çš„å†™æ³• var names = ["hotel", "movie"], i, len; for (i=0, len=names.length; i &lt; len; i++) &#123; // code &#125; ``` * foråŽï¼ˆå¿…é¡»ï¼‰åŠ ç©ºæ ¼* æ¯ä¸ª;åŽï¼ˆå¿…é¡»ï¼‰åŠ ç©ºæ ¼* ()ä¸­ç¦æ­¢ç”¨varå£°æ˜Žå˜é‡; ä¸”å˜é‡çš„èµ‹å€¼ = å‰åŽï¼ˆç¦æ­¢ï¼‰åŠ ç©ºæ ¼## function ä¸­çš„ç©ºæ ¼, å…ˆä¸Šä¾‹å­```javascript // æ­£ç¡®çš„å†™æ³• function call(name) &#123; &#125; var cell = function () &#123; &#125;; å‚æ•°çš„åæ‹¬å·åŽï¼ˆå¿…é¡»ï¼‰åŠ ç©ºæ ¼ function åŽï¼ˆå¿…é¡»ï¼‰åŠ ç©ºæ ¼ var ä¸­ç©ºæ ¼åŠå®šä¹‰ï¼Œå…ˆä¸Šä¾‹å­12345678// ä¸€ä¸ªæŽ¨èçš„varå†™æ³•ç»„ function(res) &#123; var code = 1 + 1, json = JSON.parse(res), type, html; // code &#125; å£°æ˜Žå˜é‡ = å‰åŽï¼ˆå¿…é¡»ï¼‰æ·»åŠ ç©ºæ ¼ æ¯ä¸ªå˜é‡çš„èµ‹å€¼å£°æ˜Žä»¥,ç»“æŸåŽï¼ˆå¿…é¡»ï¼‰æ¢è¡Œè¿›è¡Œä¸‹ä¸€ä¸ªå˜é‡èµ‹å€¼å£°æ˜Žï¼ˆæŽ¨èï¼‰å°†æ‰€æœ‰ä¸éœ€è¦è¿›è¡Œèµ‹å€¼çš„å˜é‡å£°æ˜Žæ”¾ç½®æœ€åŽä¸€è¡Œï¼Œä¸”å˜é‡ä¹‹é—´ä¸éœ€è¦æ¢è¡Œ ï¼ˆæŽ¨èï¼‰å½“ä¸€ç»„å˜é‡å£°æ˜Žå®ŒæˆåŽï¼Œç©ºä¸€è¡ŒåŽç¼–å†™å…¶ä½™ä»£ç  åœ¨åŒä¸€ä¸ªå‡½æ•°å†…éƒ¨ï¼Œå±€éƒ¨å˜é‡çš„å£°æ˜Žå¿…é¡»ç½®äºŽé¡¶ç«¯å› ä¸ºå³ä½¿æ”¾åˆ°ä¸­é—´ï¼Œjsè§£æžå™¨ä¹Ÿä¼šæå‡è‡³é¡¶éƒ¨ï¼ˆhostingï¼‰1234567891011121314151617181920// æ­£ç¡®çš„ä¹¦å†™var clear = function(el) &#123; var id = el.id, name = el.getAttribute("data-name"); ......... return true;&#125;// ä¸æŽ¨èçš„ä¹¦å†™var clear = function(el) &#123; var id = el.id; ...... var name = el.getAttribute("data-name"); ......... return true;&#125; å—å†…å‡½æ•°å¿…é¡»ç”¨å±€éƒ¨å˜é‡å£°æ˜Ž1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253// é”™è¯¯çš„å†™æ³• var call = function(name) &#123; if (name == "hotel") &#123; function foo() &#123; console.log("hotel foo"); &#125; &#125; foo &amp;&amp; foo(); &#125; // æŽ¨èçš„å†™æ³• var call = function(name) &#123; var foo; if (name == "hotel") &#123; foo = function() &#123; console.log("hotel foo"); &#125; &#125; foo &amp;&amp; foo(); &#125;``` å¼•èµ·çš„bugï¼šç¬¬ä¸€ç§å†™æ³•fooçš„å£°æ˜Žè¢«æå‰äº†; è°ƒç”¨callæ—¶ï¼šç¬¬ä¸€ç§å†™æ³•ä¼šè°ƒç”¨fooå‡½æ•°ï¼Œç¬¬äºŒç§å†™æ³•ä¸ä¼šè°ƒç”¨fooå‡½æ•°æ³¨ï¼šä¸åŒæµè§ˆå™¨è§£æžä¸åŒï¼Œå…·ä½“è¯·ç§»æ­¥æ±¤å§†å¤§å”[æ·±å…¥è§£æžJavascriptå‡½æ•°ç¯‡](http://www.cnblogs.com/TomXu/archive/2012/01/30/2326372.html)## ç¦æ­¢ï¼‰ä½¿ç”¨evalï¼Œé‡‡å–$.parseJSON&gt; ä¸‰ä¸ªåŽŸå› ï¼šæœ‰æ³¨å…¥é£Žé™©ï¼Œå°¤å…¶æ˜¯ajaxè¿”å›žæ•°æ®ä¸æ–¹ä¾¿debugæ•ˆçŽ‡ä½Žï¼Œevalæ˜¯ä¸€ä¸ªæ‰§è¡Œæ•ˆçŽ‡å¾ˆä½Žçš„å‡½æ•°å»ºè®®ï¼šä½¿ç”¨new Functionæ¥ä»£æ›¿evalçš„ä½¿ç”¨ï¼Œæœ€å¥½å°±åˆ«ç”¨ã€‚## é™¤äº†ä¸‰ç›®è¿ç®—ï¼Œif,elseç­‰ï¼ˆç¦æ­¢ï¼‰ç®€å†™```javascript // æ­£ç¡®çš„ä¹¦å†™ if (true) &#123; alert(name); &#125; console.log(name); // ä¸æŽ¨èçš„ä¹¦å†™ if (true) alert(name); console.log(name); // ä¸æŽ¨èçš„ä¹¦å†™ if (true) alert(name); console.log(name) ï¼ˆæŽ¨èï¼‰åœ¨éœ€è¦ä»¥{}é—­åˆçš„ä»£ç æ®µå‰å¢žåŠ æ¢è¡Œï¼Œå¦‚ï¼šfor if12345678910111213141516171819202122232425262728293031// æ²¡æœ‰æ¢è¡Œï¼Œå°çš„ä»£ç æ®µæ— æ³•åŒºåˆ†if (wl &amp;&amp; wl.length) &#123; for (i = 0, l = wl.length; i &lt; l; ++i) &#123; p = wl[i]; type = Y.Lang.type(r[p]); if (s.hasOwnProperty(p)) &#123; if (merge &amp;&amp; type == 'object') &#123; Y.mix(r[p], s[p]); &#125; else if (ov || !(p in r)) &#123; r[p] = s[p]; &#125; &#125; &#125;&#125;// æœ‰äº†æ¢è¡Œï¼Œé€»è¾‘æ¸…æ¥šå¤šäº†if (wl &amp;&amp; wl.length) &#123; for (i = 0, l = wl.length; i &lt; l; ++i) &#123; p = wl[i]; type = Y.Lang.type(r[p]); if (s.hasOwnProperty(p)) &#123; // å¤„ç†mergeé€»è¾‘ if (merge &amp;&amp; type == 'object') &#123; Y.mix(r[p], s[p]); &#125; else if (ov || !(p in r)) &#123; r[p] = s[p]; &#125; &#125; &#125;&#125; æ¢è¡Œå¯ä»¥æ˜¯ç©ºè¡Œï¼Œä¹Ÿå¯ä»¥æ˜¯æ³¨é‡Š (æŽ¨èï¼‰ä½¿ç”¨Functionè¿›è¡Œç±»çš„å®šä¹‰ï¼Œ(ä¸æŽ¨è)ç»§æ‰¿ï¼Œå¦‚éœ€ç»§æ‰¿é‡‡ç”¨æˆç†Ÿçš„ç±»åº“å®žçŽ°ç»§æ‰¿123456789101112131415161718// ç±»çš„å®žçŽ° function Person(name) &#123; this.name = name; &#125; Person.prototype.sayName = function() &#123; alert(this.name); &#125;; var me = new Person("Nicholas"); // å°†thisæ”¾åˆ°å±€éƒ¨å˜é‡self function Persion(name, sex) &#123; var self = this; self.name = name; self.sex = sex; &#125; å¹³æ—¶å’±ä»¬å†™ä»£ç ï¼ŒåŸºæœ¬éƒ½æ˜¯å°ç¨‹åºï¼ŒçœŸå¿ƒç”¨ä¸ä¸Šä»€ä¹ˆç»§æ‰¿ï¼Œè€Œä¸”ç»§æ‰¿å¹¶ä¸æ˜¯JSçš„æ“…é•¿çš„è¯­è¨€ç‰¹æ€§ï¼Œå°½é‡å°‘ç”¨ã€‚å¦‚æžœéžè¦ä½¿ç”¨çš„è¯ï¼Œæ³¨æ„ä¸€ç‚¹ï¼š12345678 function A()&#123; //...&#125;function B()&#123; //...&#125;B.prototype = new A();B.prototype.constructor = B; //åŽŸåˆ™ä¸Šï¼Œè®°å¾—æŠŠè¿™å¥è¯åŠ ä¸Š ç»§æ‰¿ä»ŽåŽŸåˆ™ä¸Šæ¥è®²ï¼Œåˆ«æ”¹å˜ä»–çš„æž„é€ å‡½æ•°ï¼Œå¦åˆ™è¿™ä¸ªç»§æ‰¿å°±æ˜¾å¾—å¾ˆåˆ«æ‰­äº†~ (æŽ¨è)ä½¿ç”¨å±€éƒ¨å˜é‡ç¼“å­˜åå¤æŸ¥æ‰¾çš„å¯¹è±¡(åŒ…æ‹¬ä½†ä¸é™äºŽå…¨å±€å˜é‡ã€domæŸ¥è¯¢ç»“æžœã€ä½œç”¨åŸŸé“¾è¾ƒæ·±çš„å¯¹è±¡)1234567891011121314151617181920 // ç¼“å­˜å¯¹è±¡ var getComment = function() &#123; var dom = $("#common-container"), // ç¼“å­˜dom appendTo = $.appendTo, // ç¼“å­˜å…¨å±€å˜é‡ data = this.json.data; // ç¼“å­˜ä½œç”¨åŸŸé“¾è¾ƒæ·±çš„å¯¹è±¡ &#125;``` ## å½“éœ€è¦ç¼“å­˜thisæ—¶å¿…é¡»ä½¿ç”¨selfå˜é‡è¿›è¡Œç¼“å­˜```java// ç¼“å­˜this function Row(name) &#123; var self = this; self.name = name; $(".row").click(function() &#123; self.getName(); &#125;); &#125; selfæ˜¯ä¸€ä¸ªä¿ç•™å­—ï¼Œä¸è¿‡ç”¨å®ƒä¹Ÿæ²¡å…³ç³»ã€‚åœ¨è¿™é‡Œï¼Œçœ‹ä¸ªäººçˆ±å¥½å§ï¼Œå¯ä»¥ç”¨_this, that, meç­‰è¿™äº›è¯ï¼Œéƒ½è¡Œï¼Œä½†æ˜¯å›¢é˜Ÿå¼€å‘çš„æ—¶å€™ç»Ÿä¸€ä¸‹æ¯”è¾ƒå¥½ã€‚ ##ï¼ˆä¸æŽ¨èï¼‰è¶…é•¿å‡½æ•°, å½“å‡½æ•°è¶…è¿‡100è¡Œï¼Œå°±è¦æƒ³æƒ³æ˜¯å¦èƒ½å°†å‡½æ•°æ‹†ä¸ºä¸¤ä¸ªæˆ–å¤šä¸ªå‡½æ•° åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Standard</category>
      </categories>
      <tags>
        <tag>Record</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯ä»£ç è§„èŒƒ-CSSç¯‡]]></title>
    <url>%2F2018%2F04%2F18%2FRecord%2F%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83-CSS%E7%AF%87%2F</url>
    <content type="text"><![CDATA[tabé”®ç”¨ï¼ˆå¿…é¡»ï¼‰å››ä¸ªç©ºæ ¼ä»£æ›¿ å› ä¸ºåœ¨ä¸åŒç³»ç»Ÿçš„ç¼–è¾‘å·¥å…·å¯¹tabè§£æžä¸ä¸€æ ·ï¼Œwindowsä¸‹çš„tabé”®æ˜¯å å››ä¸ªç©ºæ ¼çš„ä½ç½®ï¼Œè€Œåœ¨linuxä¸‹ä¼šå˜æˆå å…«ä¸ªç©ºæ ¼çš„ä½ç½®ï¼ˆé™¤éžä½ è‡ªå·±è®¾å®šäº†tabé”®æ‰€å çš„ä½ç½®é•¿åº¦ï¼‰ã€‚ æ¯ä¸ªæ ·å¼å±žæ€§åŽï¼ˆå¿…é¡»ï¼‰åŠ  â€œ;â€æ–¹ä¾¿åŽ‹ç¼©å·¥å…·&quot;æ–­å¥&quot;ã€‚ Classå‘½åä¸­ï¼ˆç¦æ­¢ï¼‰å‡ºçŽ°å¤§å†™å­—æ¯ï¼Œï¼ˆå¿…é¡»ï¼‰é‡‡ç”¨â€ - â€œå¯¹classä¸­çš„å­—æ¯åˆ†éš”ï¼Œå¦‚ï¼š12345678910111213141516171819 /* æ­£ç¡®çš„å†™æ³• */ .hotel-title &#123; font-weight: bold; &#125; /* ä¸æŽ¨èçš„å†™æ³• */ .hotelTitle &#123; font-weight: bold; &#125;``` * ç”¨"-"éš”å¼€æ¯”ä½¿ç”¨é©¼å³°æ˜¯æ›´åŠ æ¸…æ™°ã€‚* äº§å“çº¿-äº§å“-æ¨¡å—-å­æ¨¡å—ï¼Œå‘½åçš„æ—¶å€™ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ï¼ˆ@Artwlï¼‰## ç©ºæ ¼çš„ä½¿ç”¨ï¼Œä»¥ä¸‹è§„åˆ™ï¼ˆå¿…é¡»ï¼‰æ‰§è¡Œï¼š```css.hotel-content &#123; font-weight: bold; &#125; é€‰æ‹©å™¨ä¸Ž { ä¹‹å‰ï¼ˆå¿…é¡»ï¼‰è¦æœ‰ç©ºæ ¼ å±žæ€§åçš„ : åŽï¼ˆå¿…é¡»ï¼‰è¦æœ‰ç©ºæ ¼ å±žæ€§åçš„ : å‰ï¼ˆç¦æ­¢ï¼‰åŠ ç©ºæ ¼ å¤šé€‰æ‹©å™¨è§„åˆ™ä¹‹é—´ï¼ˆå¿…é¡»ï¼‰æ¢è¡Œå½“æ ·å¼é’ˆå¯¹å¤šä¸ªé€‰æ‹©å™¨æ—¶æ¯ä¸ªé€‰æ‹©å™¨å ä¸€è¡Œ 123456/* æŽ¨èçš„å†™æ³• */a.btn,input.btn,input[type="button"] &#123; ......&#125; ï¼ˆç¦æ­¢ï¼‰å°†æ ·å¼å†™ä¸ºå•è¡Œ, å¦‚1.hotel-content &#123;margin: 10px; background-color: #efefef;&#125; å•è¡Œæ˜¾ç¤ºä¸å¥½æ³¨é‡Šï¼Œä¸å¥½å¤‡æ³¨ï¼Œè¿™åº”è¯¥æ˜¯åŽ‹ç¼©å·¥å…·çš„æ´»å„¿~ ï¼ˆç¦æ­¢ï¼‰å‘ 0 åŽæ·»åŠ å•ä½, å¦‚ï¼š123.obj &#123; left: 0px;&#125; ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨cssåŽŸç”Ÿimportä½¿ç”¨cssåŽŸç”Ÿimportæœ‰å¾ˆå¤šå¼Šç«¯ï¼Œæ¯”å¦‚ä¼šå¢žåŠ è¯·æ±‚æ•°ç­‰â€¦. ï¼ˆæŽ¨èï¼‰å±žæ€§çš„ä¹¦å†™é¡ºåº, ä¸¾ä¸ªä¾‹å­:1234567891011121314.hotel-content &#123; /* å®šä½ */ display: block; position: absolute; left: 0; top: 0; /* ç›’æ¨¡åž‹ */ width: 50px; height: 50px; margin: 10px; border: 1px solid black; / *å…¶ä»–* / color: #efefef; &#125; å®šä½ç›¸å…³, å¸¸è§çš„æœ‰ï¼šdisplay position left top float ç­‰ ç›’æ¨¡åž‹ç›¸å…³, å¸¸è§çš„æœ‰ï¼šwidth height margin padding border ç­‰ å…¶ä»–å±žæ€§ æŒ‰ç…§è¿™æ ·çš„é¡ºåºä¹¦å†™å¯è§æå‡æµè§ˆå™¨æ¸²æŸ“domçš„æ€§èƒ½ ç®€å•ä¸¾ä¸ªä¾‹å­ï¼Œç½‘é¡µä¸­çš„å›¾ç‰‡ï¼Œå¦‚æžœæ²¡æœ‰è®¾ç½®widthå’Œheightï¼Œåœ¨å›¾ç‰‡è½½å…¥ä¹‹å‰ï¼Œä»–æ‰€å çš„ç©ºé—´ä¸º0ï¼Œä½†æ˜¯å½“ä»–åŠ è½½å®Œæ¯•ä¹‹åŽï¼Œé‚£å—ä¸º0çš„ç©ºé—´çªç„¶è¢«æ’‘å¼€äº†ï¼Œè¿™æ ·ä¼šå¯¼è‡´ï¼Œä»–ä¸‹é¢çš„å…ƒç´ é‡æ–°æŽ’åˆ—å’Œæ¸²æŸ“ï¼Œé€ æˆé‡ç»˜ï¼ˆrepaintï¼‰å’Œå›žæµï¼ˆreflowï¼‰ã€‚æˆ‘ä»¬åœ¨å†™cssçš„æ—¶å€™ï¼ŒæŠŠå…ƒç´ çš„å®šä½æ”¾åœ¨å‰å¤´ï¼Œé¦–å…ˆè®©æµè§ˆå™¨çŸ¥é“è¯¥å…ƒç´ æ˜¯åœ¨æ–‡æœ¬æµå†…è¿˜æ˜¯å¤–ï¼Œå…·ä½“åœ¨é¡µé¢çš„å“ªä¸ªéƒ¨ä½ï¼ŒæŽ¥ç€è®©æµè§ˆå™¨çŸ¥é“ä»–ä»¬çš„å®½åº¦å’Œé«˜åº¦ï¼Œborderç­‰è¿™äº›å ç”¨ç©ºé—´çš„å±žæ€§ï¼Œå…¶ä»–çš„å±žæ€§éƒ½æ˜¯åœ¨è¿™ä¸ªå›ºå®šçš„åŒºåŸŸå†…æ¸²æŸ“çš„ï¼Œå·®ä¸å¤šå°±æ˜¯è¿™ä¸ªæ„æ€å§~(@frec) æŽ¨èæ–‡ç« ï¼š https://css-tricks.com/poll-results-how-do-you-order-your-css-properties/ http://www.mozilla.org/css/base/content.css å°å›¾ç‰‡ï¼ˆå¿…é¡»ï¼‰sprite åˆå¹¶æŽ¨èæ–‡ç« ï¼šNodeJsæ™ºèƒ½åˆå¹¶CSSç²¾çµå›¾å·¥å…·iSpriter (æŽ¨èï¼‰å½“ç¼–å†™é’ˆå¯¹ç‰¹å®šhtmlç»“æž„çš„æ ·å¼æ—¶ï¼Œä½¿ç”¨å…ƒç´ å + ç±»å/ æ‰€æœ‰çš„navéƒ½æ˜¯é’ˆå¯¹ulç¼–å†™çš„ /123ul.nav &#123; ......&#125; â€œ.a divâ€å’Œâ€.a div.bâ€ï¼Œä¸ºä»€ä¹ˆåŽè€…å¥½ï¼Ÿå¦‚æžœéœ€æ±‚æœ‰æ‰€å˜åŒ–ï¼Œåœ¨â€.aâ€ä¸‹æœ‰å¤šåŠ äº†ä¸€ä¸ªdivï¼Œè¯•é—®ï¼Œå¼€å§‹çš„æ ·å¼æ˜¯ä¸æ˜¯ä¼šå½±å“åŽæ¥çš„divå•Š~ (æŽ¨èï¼‰IE Hack List123456789/* é’ˆå¯¹ieçš„hack */selector &#123; property: value; /* æ‰€æœ‰æµè§ˆå™¨ */ property: value\9; /* æ‰€æœ‰IEæµè§ˆå™¨ */ property: value\0; /* IE8 */ +property: value; /* IE7 */ _property: value; /* IE6 */ *property: value; /* IE6-7 */&#125; å½“ä½¿ç”¨hackçš„æ—¶å€™æƒ³æƒ³èƒ½ä¸èƒ½ç”¨æ›´å¥½çš„æ ·å¼ä»£æ›¿ ï¼ˆä¸æŽ¨èï¼‰ieä½¿ç”¨filter,ï¼ˆ ç¦æ­¢ï¼‰ä½¿ç”¨expressionè¿™é‡Œä¸»è¦æ˜¯æ•ˆçŽ‡é—®é¢˜ï¼Œåº”è¯¥å½“æ ¼å¤–æ³¨æ„ï¼Œå’±ä»¬è¦å°‘ç”¨çƒ§CPUçš„ä¸œè¥¿~ (ç¦æ­¢ï¼‰ä½¿ç”¨è¡Œå†…ï¼ˆinlineï¼‰æ ·å¼1&lt;p style="font-size: 12px; color: #FFFFFF"&gt;é–é¸£å›&lt;/p&gt; åƒè¿™æ ·çš„è¡Œå†…æ ·å¼ï¼Œæœ€å¥½ç”¨ä¸€ä¸ªclassä»£æ›¿ã€‚åˆå¦‚è¦éšè—æŸä¸ªå…ƒç´ ï¼Œå¯ä»¥ç»™ä»–åŠ ä¸€ä¸ªclass .hide { display: none;}å°½é‡åšåˆ°æ ·å¼å’Œç»“æž„åˆ†ç¦»~ ï¼ˆæŽ¨èï¼‰reset.cssæ ·å¼æŽ¨èç½‘ç«™ï¼šhttp://www.cssreset.com/ ï¼ˆç¦æ­¢ï¼‰ä½¿ç”¨â€*â€æ¥é€‰æ‹©å…ƒç´ 12345/*åˆ«è¿™æ ·å†™*/* &#123; margin: 0; padding: 0;&#125; è¿™æ ·å†™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œä¸€äº›å…ƒç´ åœ¨æµè§ˆå™¨ä¸­é»˜è®¤æœ‰marginæˆ–paddingå€¼ï¼Œä½†æ˜¯åªæ˜¯éƒ¨åˆ†å…ƒç´ ï¼Œæ²¡æœ‰å¿…è¦å°†æ‰€æœ‰å…ƒç´ çš„marginã€paddingå€¼éƒ½ç½®ä¸º0ã€‚ é“¾æŽ¥çš„æ ·å¼ï¼Œï¼ˆåŠ¡å¿…ï¼‰æŒ‰ç…§è¿™ä¸ªé¡ºåºæ¥ä¹¦å†™1a:link -&gt; a:visited -&gt; a:hover -&gt; a:active åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Standard</category>
      </categories>
      <tags>
        <tag>Record</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack3,ä»Žå…¥é—¨åˆ°æ”¾å¼ƒ]]></title>
    <url>%2F2018%2F04%2F17%2FTools%2Fwebpack3-%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83%2F</url>
    <content type="text"><![CDATA[å‰è¨€ é¦–å…ˆï¼Œè¿™ç¯‡æ–‡ç« æ˜¯æ ¹æ® webpack ç‰ˆæœ¬ (å³ v3.4.1) æ’°å†™ï¼Œè¾ƒé•¿ä¸€æ®µæ—¶é—´å†…æ— éœ€æ‹…å¿ƒè¿‡æ—¶çš„é—®é¢˜ã€‚å…¶æ¬¡ï¼Œè¿™åº”è¯¥ä¼šæ˜¯ä¸€ç¯‡æžé•¿çš„æ–‡ç« ï¼Œæ¶µç›–äº†åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•ï¼Œæœ‰æ›´é«˜çº§åŠŸèƒ½çš„éœ€æ±‚å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ç»§ç»­å­¦ä¹ ã€‚å†æ¬¡ï¼Œå³ä½¿æ˜¯åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¹Ÿå†…å®¹ç¹å¤šï¼Œæˆ‘å°½å¯èƒ½åœ°è§£é‡Šé€šä¿—æ˜“æ‡‚ï¼Œå°†æˆ‘å­¦ä¹ è¿‡ç¨‹ä¸­çš„ç–‘æƒ‘å’Œå‘ä¸€ä¸€è§£é‡Šï¼Œå¦‚æœ‰çº°æ¼ï¼Œæ•¬è¯·é›…æ­£ã€‚å†æ¬¡ï¼Œä¸ºäº†æ¸…æ™°æœ‰æ•ˆåœ°è®²è§£ï¼Œæˆ‘ä¼šæ¼”ç¤ºä»Žé›¶ç¼–å†™ demoï¼Œåªè¦ä¸€æ­¥æ­¥è·Ÿç€åšï¼Œå°±ä¼šæ¸…æ™°è®¸å¤šã€‚ æœ¬æ–‡demoåœ°å€ Webpackï¼Œä½•è®¸äººä¹Ÿï¼Ÿå€Ÿç”¨å®˜æ–¹çš„è¯´æ³•: webpack is a module bundler. Its main purpose is to bundle JavaScript files for usage in a browser, yet it is also capable of transforming, bundling, or packaging just about any resource or asset. ç®€è¨€ä¹‹ï¼Œwebpack æ˜¯ä¸€ä¸ªæ¨¡å—æ‰“åŒ…å™¨ (module bundler)ï¼Œèƒ½å¤Ÿå°†ä»»ä½•èµ„æºå¦‚ JavaScript æ–‡ä»¶ã€CSS æ–‡ä»¶ã€å›¾ç‰‡ç­‰æ‰“åŒ…æˆä¸€ä¸ªæˆ–å°‘æ•°æ–‡ä»¶ã€‚ ä¸ºä»€ä¹ˆè¦ç”¨ä»‹ä¸ª Webpack?é¦–å…ˆï¼Œå®šä¹‰å·²ç»è¯´æ˜Žäº† webpack èƒ½å°†å¤šä¸ªèµ„æºæ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å°‘æ•°æ–‡ä»¶ï¼Œè¿™æ„å‘³ç€ä¸Žä»¥å¾€çš„å‘èµ·å¤šä¸ª HTTP è¯·æ±‚æ¥èŽ·å¾—èµ„æºç›¸æ¯”ï¼ŒçŽ°åœ¨åªéœ€è¦å‘èµ·å°‘é‡çš„ HTTP è¯·æ±‚ã€‚ å…¶æ¬¡ï¼Œwebpack èƒ½å°†ä½ çš„èµ„æºè½¬æ¢ä¸ºæœ€é€‚åˆæµè§ˆå™¨çš„â€œæ ¼å¼â€ï¼Œæå‡åº”ç”¨æ€§èƒ½ã€‚æ¯”å¦‚åªå¼•ç”¨è¢«åº”ç”¨ä½¿ç”¨çš„èµ„æº (å‰”é™¤æœªè¢«ä½¿ç”¨çš„ä»£ç )ï¼Œæ‡’åŠ è½½èµ„æº (åªåœ¨éœ€è¦çš„æ—¶å€™æ‰åŠ è½½ç›¸åº”çš„èµ„æº)ã€‚ å†æ¬¡ï¼Œå¯¹äºŽå¼€å‘é˜¶æ®µï¼Œwebpack ä¹Ÿæä¾›äº†å®žæ—¶åŠ è½½å’Œçƒ­åŠ è½½çš„åŠŸèƒ½ï¼Œå¤§å¤§åœ°èŠ‚çœäº†å¼€å‘æ—¶é—´ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰è®¸å¤šä¼˜ç§€ä¹‹å¤„ä¹‹å¤„å€¼å¾—åŽ»æŒ–æŽ˜ã€‚ä¸è¿‡ï¼Œwebpack æœ€æ ¸å¿ƒçš„è¿˜æ˜¯æ‰“åŒ…çš„åŠŸèƒ½ã€‚ webpackï¼Œgulp/gruntï¼Œnpmï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«?webpack æ˜¯æ¨¡å—æ‰“åŒ…å™¨ï¼ˆmodule bundlerï¼‰ï¼ŒæŠŠæ‰€æœ‰çš„æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å°‘é‡æ–‡ä»¶ï¼Œä½¿ä½ åªéœ€åŠ è½½å°‘é‡æ–‡ä»¶å³å¯è¿è¡Œæ•´ä¸ªåº”ç”¨ï¼Œè€Œæ— éœ€åƒä¹‹å‰é‚£æ ·åŠ è½½å¤§é‡çš„å›¾ç‰‡ï¼Œcssæ–‡ä»¶ï¼Œjsæ–‡ä»¶ï¼Œå­—ä½“æ–‡ä»¶ç­‰ç­‰ã€‚ è€Œgulpï¼grunt æ˜¯è‡ªåŠ¨åŒ–æž„å»ºå·¥å…·ï¼Œæˆ–è€…å«ä»»åŠ¡è¿è¡Œå™¨ï¼ˆtask runnerï¼‰ï¼Œæ˜¯æŠŠä½ æ‰€æœ‰é‡å¤çš„æ‰‹åŠ¨æ“ä½œè®©ä»£ç æ¥åšï¼Œä¾‹å¦‚åŽ‹ç¼©JSä»£ç ã€CSSä»£ç ï¼Œä»£ç æ£€æŸ¥ã€ä»£ç ç¼–è¯‘ç­‰ç­‰ï¼Œè‡ªåŠ¨åŒ–æž„å»ºå·¥å…·å¹¶ä¸èƒ½æŠŠæ‰€æœ‰æ¨¡å—æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œä¹Ÿä¸èƒ½æž„å»ºä¸åŒæ¨¡å—ä¹‹é—´çš„ä¾èµ–å›¾ã€‚ ä¸¤è€…æ¥æ¯”è¾ƒçš„è¯ï¼Œgulp/grunt æ— æ³•åšæ¨¡å—æ‰“åŒ…çš„äº‹ï¼Œwebpack è™½ç„¶æœ‰ loader å’Œ pluginå¯ä»¥åšä¸€éƒ¨åˆ† gulpï¼grunt èƒ½åšçš„äº‹ï¼Œä½†æ˜¯ç»ˆç©¶ webpack çš„æ’ä»¶è¿˜æ˜¯ä¸å¦‚ gulpï¼grunt çš„æ’ä»¶ä¸°å¯Œï¼Œèƒ½åšçš„äº‹æ¯”è¾ƒæœ‰é™ã€‚ äºŽæ˜¯æœ‰äººä¸¤è€…ç»“åˆç€ç”¨ï¼Œå°† webpack æ”¾åˆ° gulpï¼grunt ä¸­ç”¨ã€‚ç„¶è€Œï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯ç”¨ npm scripts å–ä»£ gulpï¼gruntï¼Œnpm æ˜¯ node çš„åŒ…ç®¡ç†å™¨ (node package manager)ï¼Œç”¨äºŽç®¡ç† node çš„ç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…ï¼Œnpm å¯¹äºŽä»»åŠ¡å‘½ä»¤çš„è‰¯å¥½æ”¯æŒè®©ä½ æœ€ç»ˆçœå´äº†ç¼–å†™ä»»åŠ¡ä»£ç çš„å¿…è¦ï¼Œå–è€Œä»£ä¹‹çš„ï¼Œæ˜¯è€ç¥–å®—çš„å‡ ä¸ªå‘½ä»¤è¡Œï¼Œä»…é å‡ å¥å‘½ä»¤è¡Œå°±è¶³ä»¥å®Œæˆä½ çš„æ¨¡å—æ‰“åŒ…å’Œè‡ªåŠ¨åŒ–æž„å»ºçš„æ‰€æœ‰éœ€æ±‚ã€‚ å‡†å¤‡å¼€å§‹å…ˆæ¥çœ‹çœ‹ä¸€ä¸ª webpack çš„ä¸€ä¸ªå®Œå¤‡çš„é…ç½®æ–‡ä»¶ï¼Œæ˜¯ ä»‹æ · çš„ï¼Œå½“ç„¶å•¦ï¼Œè¿™é‡Œé¢æœ‰å¾ˆå¤šé…ç½®é¡¹æ˜¯å³ä½¿åˆ°è¿™ä¸ªè½¯ä»¶è¢«åºŸå¼ƒä½ ä¹Ÿç”¨ä¸ä¸Šçš„ï¼šï¼‰ï¼Œæ‰€ä»¥æ— éœ€æ‹…å¿ƒã€‚ åŸºæœ¬é…ç½®å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®å®šä½ å·²ç»å®‰è£…äº†å½“å‰ Node çš„è¾ƒæ–°ç‰ˆæœ¬ã€‚ ç„¶åŽæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä»¥æ–°å»ºæˆ‘ä»¬çš„ demo ç›®å½•ï¼š 123$ mkdir webpack-demo &amp;&amp; cd webpack-demo &amp;&amp; npm init -y$ npm i --save-dev webpack$ mkdir src &amp;&amp; cd src &amp;&amp; touch index.js æˆ‘ä»¬ä½¿ç”¨å·¥å…·å‡½æ•°åº“ lodash æ¥æ¼”ç¤ºæˆ‘ä»¬çš„ demoã€‚å…ˆå®‰è£…ä¹‹ï¼š 1$ npm i --save lodash src/index.js 1234567891011import _ from 'lodash';function component() &#123; const element = document.createElement('div'); element.innerHTML = _.join(['Hello', 'webpack'], ' '); return element;&#125;document.body.appendChild(component()); Tipsimport å’Œ export å·²ç»æ˜¯ ES6 çš„æ ‡å‡†ï¼Œä½†æ˜¯ä»æœªå¾—åˆ°å¤§å¤šæ•°æµè§ˆå™¨çš„æ”¯æŒ (å¯å–œçš„æ˜¯ï¼Œ Chrome 61 å·²ç»å¼€å§‹é»˜è®¤æ”¯æŒäº†ï¼Œè§ ES6 modules)ï¼Œä¸è¿‡ webpack æä¾›äº†å¯¹è¿™ä¸ªç‰¹æ€§çš„æ”¯æŒï¼Œä½†æ˜¯é™¤äº†è¿™ä¸ªç‰¹æ€§ï¼Œå…¶ä»–çš„ ES6 ç‰¹æ€§å¹¶ä¸ä¼šå¾—åˆ° webpack çš„ç‰¹åˆ«æ”¯æŒï¼Œå¦‚æœ‰éœ€è¦ï¼Œé¡»å€ŸåŠ© Babel è¿›è¡Œè½¬è¯‘ (transpile)ã€‚ ç„¶åŽæ–°å»ºå‘å¸ƒç‰ˆæœ¬ç›®å½•ï¼š1$ cd .. &amp;&amp; mkdir dist &amp;&amp; cd dist &amp;&amp; touch index.html dist/index.html123456789&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;webpack demo&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script src="bundle.js"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; çŽ°åœ¨ï¼Œæˆ‘ä»¬è¿è¡Œ webpack æ¥æ‰“åŒ… index.js ä¸º bundle.jsï¼Œæœ¬åœ°å®‰è£…äº† webpack åŽå¯ä»¥é€šè¿‡ node_modules/.bin/webpack æ¥è®¿é—® webpack çš„äºŒè¿›åˆ¶ç‰ˆæœ¬ã€‚ 12$ cd ..$ ./node_modules/.bin/webpack src/index.js dist/bundle.js //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰“åŒ…çš„å…¥å£æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰“åŒ…çš„å‡ºå£æ–‡ä»¶ å’»å’»å’»ï¼Œå¤§è‡´å¦‚ä¸‹è¾“å‡ºä¸€æ³¢ï¼š123456789Hash: de8ed072e2c7b3892179Version: webpack 3.4.1Time: 390ms Asset Size Chunks Chunk Namesbundle.js 544 kB 0 [emitted] [big] main [0] ./src/index.js 225 bytes &#123;0&#125; [built] [2] (webpack)/buildin/global.js 509 bytes &#123;0&#125; [built] [3] (webpack)/buildin/module.js 517 bytes &#123;0&#125; [built] + 1 hidden module çŽ°åœ¨ï¼Œä½ å·²ç»å¾—åˆ°äº†ä½ çš„ç¬¬ä¸€ä¸ªæ‰“åŒ…æ–‡ä»¶ (bundle.js) äº†ã€‚ ä½¿ç”¨é…ç½®æ–‡ä»¶åƒä¸Šé¢è¿™æ ·ä½¿ç”¨ webpack åº”è¯¥æ˜¯æœ€æŒ«çš„å§¿åŠ¿äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨ webpack çš„é…ç½®æ–‡ä»¶æ¥æé«˜æˆ‘ä»¬çš„å§¿åŠ¿æ°´å¹³ã€‚ 1$ touch webpack.config.js webpack.config.js 123456789const path = require('path');module.exports = &#123; entry: './src/index.js', // å…¥å£èµ·ç‚¹ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªå…¥å£èµ·ç‚¹ output: &#123; // è¾“å‡ºï¼Œåªå¯æŒ‡å®šä¸€ä¸ªè¾“å‡ºé…ç½® filename: 'bundle.js', // è¾“å‡ºæ–‡ä»¶å path: path.resolve(__dirname, 'dist') // è¾“å‡ºæ–‡ä»¶æ‰€åœ¨çš„ç›®å½• &#125;&#125;; æ‰§è¡Œï¼š1$ ./node_modules/.bin/webpack --config webpack.config.js //`--config` åˆ¶å®š webpack çš„é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯ `webpack.config.js` æ‰€ä»¥è¿™é‡Œå¯ä»¥çœå´ --config webpack.config.jsã€‚ä½†æ˜¯æ¯æ¬¡éƒ½è¦å†™ ./node_modules/.bin/webpack å®žåœ¨è®©äººä¸çˆ½ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åŠ¨ç”¨ NPM Scriptsã€‚ package.json1234567&#123; ... "scripts": &#123; "build": "webpack" &#125;, ...&#125; æ‰§è¡Œï¼š1$ npm run build ä¸€æ³¢è¾“å‡ºåŽä¾¿å¾—åˆ°äº†æ‰“åŒ…æ–‡ä»¶ã€‚ æ‰“åŒ…å…¶ä»–ç±»åž‹çš„æ–‡ä»¶å› ä¸ºå…¶ä»–æ–‡ä»¶å’Œ JS æ–‡ä»¶ç±»åž‹ä¸åŒï¼Œè¦æŠŠä»–ä»¬åŠ è½½åˆ° JS æ–‡ä»¶ä¸­å°±éœ€è¦ç»è¿‡åŠ è½½å™¨ (loader) çš„å¤„ç† åŠ è½½ CSSæˆ‘ä»¬éœ€è¦å®‰è£…ä¸¤ä¸ª loader æ¥å¤„ç† CSS æ–‡ä»¶ï¼š 1$ npm i --save-dev style-loader css-loader style-loader é€šè¿‡æ’å…¥ style æ ‡ç­¾å°† CSS åŠ å…¥åˆ° DOM ä¸­ï¼Œcss-loader ä¼šåƒè§£é‡Š import/require() ä¸€æ ·è§£é‡Š @import å’Œ url()ã€‚ 1234567891011121314151617181920const path = require('path');module.exports = &#123; entry: './src/index.js', output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;, module: &#123; // å¦‚ä½•å¤„ç†é¡¹ç›®ä¸­ä¸åŒç±»åž‹çš„æ¨¡å— rules: [ // ç”¨äºŽè§„å®šåœ¨ä¸åŒæ¨¡å—è¢«åˆ›å»ºæ—¶å¦‚ä½•å¤„ç†æ¨¡å—çš„è§„åˆ™æ•°ç»„ &#123; test: /\.css$/, // åŒ¹é…ç‰¹å®šæ–‡ä»¶çš„æ­£åˆ™è¡¨è¾¾å¼æˆ–æ­£åˆ™è¡¨è¾¾å¼æ•°ç»„ use: [ // åº”ç”¨äºŽæ¨¡å—çš„ loader ä½¿ç”¨åˆ—è¡¨ 'style-loader', 'css-loader' ] &#125; ] &#125;&#125;; æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª CSS æ–‡ä»¶ï¼š1$ cd src &amp;&amp; touch style.css src/style.css123.hello &#123; color: red;&#125; src/index.js 12345678910111213import _ from 'lodash';import './style.css'; // é€šè¿‡`import`å¼•å…¥ CSS æ–‡ä»¶function component() &#123; const element = document.createElement('div'); element.innerHTML = _.join(['Hello', 'webpack'], ' '); element.classList.add('hello'); // åœ¨ç›¸åº”å…ƒç´ ä¸Šæ·»åŠ ç±»å return element;&#125;document.body.appendChild(component()); æ‰§è¡Œnpm run buildï¼Œç„¶åŽæ‰“å¼€index.htmlï¼Œå°±å¯ä»¥çœ‹åˆ°çº¢è‰²çš„å­—ä½“äº†ã€‚CSS æ–‡ä»¶æ­¤æ—¶å·²ç»è¢«æ‰“åŒ…åˆ° bundle.js ä¸­ã€‚å†æ‰“å¼€æµè§ˆå™¨æŽ§åˆ¶å°ï¼Œå°±å¯ä»¥çœ‹åˆ° webpack åšäº†äº›ä»€ä¹ˆã€‚ åŠ è½½å›¾ç‰‡1$ npm install --save-dev file-loader file-loader æŒ‡ç¤º webpack ä»¥æ–‡ä»¶æ ¼å¼å‘å‡ºæ‰€éœ€å¯¹è±¡å¹¶è¿”å›žæ–‡ä»¶çš„å…¬å…±URLï¼Œå¯ç”¨äºŽä»»ä½•æ–‡ä»¶çš„åŠ è½½ã€‚ webpack.config.js 1234567891011121314151617181920212223242526const path = require('path');module.exports = &#123; entry: './src/index.js', output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;, module: &#123; rules: [ &#123; test: /\.css$/, use: [ 'style-loader', 'css-loader' ] &#125;, &#123; // å¢žåŠ åŠ è½½å›¾ç‰‡çš„è§„åˆ™ test: /\.(png|svg|jpg|gif)$/, use: [ 'file-loader' ] &#125; ] &#125;&#125;; æˆ‘ä»¬åœ¨å½“å‰é¡¹ç›®çš„Srcç›®å½•ä¸­å¦‚ä¸‹å¢žåŠ å›¾ç‰‡ src/index.js 12345678910111213141516171819import _ from 'lodash';import './style.css';import Icon from './icon.jpg'; // Icon æ˜¯å›¾ç‰‡çš„ URLfunction component() &#123; const element = document.createElement('div'); element.innerHTML = _.join(['Hello', 'webpack'], ' '); element.classList.add('hello'); const myIcon = new Image(); myIcon.src = Icon; element.appendChild(myIcon); return element;&#125;document.body.appendChild(component()); src/style.css1234.hello &#123; color: red; background: url(./icon.jpg);&#125; å†npm run buildä¹‹ã€‚çŽ°åœ¨ä½ å¯ä»¥çœ‹åˆ°å•ç‹¬çš„å›¾ç‰‡å’Œä»¥å›¾ç‰‡ä¸ºåŸºç¡€çš„èƒŒæ™¯å›¾äº†ã€‚ åŠ è½½å­—ä½“åŠ è½½å­—ä½“ç”¨çš„ä¹Ÿæ˜¯ file-loaderã€‚ webpack.config.js 1234567891011121314151617181920212223242526272829303132const path = require('path');module.exports = &#123; entry: './src/index.js', output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;, module: &#123; rules: [ &#123; test: /\.css$/, use: [ 'style-loader', 'css-loader' ] &#125;, &#123; test: /\.(png|svg|jpg|gif)$/, use: [ 'file-loader' ] &#125;, &#123; // å¢žåŠ åŠ è½½å­—ä½“çš„è§„åˆ™ test: /\.(woff|woff2|eot|ttf|otf)$/, use: [ 'file-loader' ] &#125; ] &#125;&#125;; åœ¨å½“å‰é¡¹ç›®çš„Srcç›®å½•ä¸­å¦‚ä¸‹å¢žåŠ å­—ä½“ï¼š src/style.css12345678910@font-face &#123; font-family: MyFont; src: url(./my-font.ttf);&#125;.hello &#123; color: red; background: url(./icon.jpg); font-family: MyFont;&#125; è¿è¡Œæ‰“åŒ…å‘½ä»¤ä¹‹åŽä¾¿å¯ä»¥çœ‹åˆ°æ‰“åŒ…å¥½çš„æ–‡ä»¶å’Œå‘ç”Ÿæ”¹å˜çš„é¡µé¢ã€‚ åŠ è½½ JSON æ–‡ä»¶å› ä¸º webpack å¯¹ JSON æ–‡ä»¶çš„æ”¯æŒæ˜¯å†…ç½®çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æŽ¥æ·»åŠ ã€‚ src/data.json12345&#123; "name": "webpack-demo", "version": "1.0.0", "author": "Sam Yang"&#125; src/index.js12345678910111213141516171819202122import _ from 'lodash';import './style.css';import Icon from './icon.jpg';import Data from './data.json'; // Data å˜é‡åŒ…å«å¯ç›´æŽ¥ä½¿ç”¨çš„ JSON è§£æžå¾—åˆ°çš„å¯¹è±¡function component() &#123; const element = document.createElement('div'); element.innerHTML = _.join(['Hello', 'webpack'], ' '); element.classList.add('hello'); const myIcon = new Image(); myIcon.src = Icon; element.appendChild(myIcon); console.log(Data); return element;&#125;document.body.appendChild(component()); å…³äºŽå…¶ä»–æ–‡ä»¶çš„åŠ è½½ï¼Œå¯ä»¥å¯»æ±‚ç›¸åº”çš„ loaderã€‚ è¾“å‡ºç®¡ç†å‰é¢æˆ‘ä»¬åªæœ‰ä¸€ä¸ªè¾“å…¥æ–‡ä»¶ï¼Œä½†çŽ°å®žæ˜¯æˆ‘ä»¬å¾€å¾€æœ‰ä¸æ­¢ä¸€ä¸ªè¾“å…¥æ–‡ä»¶ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦è¾“å…¥å¤šä¸ªå…¥å£æ–‡ä»¶å¹¶ç®¡ç†è¾“å‡ºæ–‡ä»¶ã€‚æˆ‘ä»¬åœ¨ src ç›®å½•ä¸‹å¢žåŠ ä¸€ä¸ª print.js æ–‡ä»¶ã€‚ src/print.js 123export default function printMe() &#123; console.log('I get called from print.js!');&#125; src/index.js 1234567891011121314151617181920212223242526272829import _ from 'lodash';import printMe from './print.js';// import './style.css';// import Icon from './icon.jpg';// import Data from './data.json';function component() &#123; const element = document.createElement('div'); const btn = document.createElement('button'); element.innerHTML = _.join(['Hello', 'webpack'], ' '); // element.classList.add('hello'); // const myIcon = new Image(); // myIcon.src = Icon; // element.appendChild(myIcon); // console.log(Data); btn.innerHTML = 'Click me and check the console!'; btn.onclick = printMe; element.appendChild(btn); return element;&#125;document.body.appendChild(component()); dist/index.html 1234567891011&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;webpack demo&lt;/title&gt; &lt;script src="./print.bundle.js"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;!-- &lt;script src="bundle.js"&gt;&lt;/script&gt; --&gt; &lt;script src="./app.bundle.js"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; webpack.config.js 123456789101112131415const path = require('path');module.exports = &#123; // entry: './src/index.js', entry: &#123; app: './src/index.js', print: './src/print.js' &#125;, output: &#123; // filename: 'bundle.js', filename: '[name].bundle.js', // æ ¹æ®å…¥å£èµ·ç‚¹ååŠ¨æ€ç”Ÿæˆ bundle åï¼Œå¯ä»¥ä½¿ç”¨åƒ "js/[name]/bundle.js" è¿™æ ·çš„æ–‡ä»¶å¤¹ç»“æž„ path: path.resolve(__dirname, 'dist') &#125;, // ...&#125;; Tipsfilename: â€˜[name].bundle.jsâ€™ä¸­çš„[name]ä¼šæ›¿æ¢ä¸ºå¯¹åº”çš„å…¥å£èµ·ç‚¹åï¼Œå…¶ä»–å¯ç”¨çš„æ›¿æ¢è¯·å‚è§ output.filenameã€‚ çŽ°åœ¨å¯ä»¥æ‰“åŒ…æ–‡ä»¶äº†ã€‚ä½†æ˜¯å¦‚æžœæˆ‘ä»¬ä¿®æ”¹äº†å…¥å£æ–‡ä»¶åæˆ–å¢žåŠ äº†å…¥å£æ–‡ä»¶ï¼Œindex.htmlæ˜¯ä¸ä¼šè‡ªåŠ¨å¼•ç”¨æ–°æ–‡ä»¶çš„ï¼Œè€Œæ‰‹åŠ¨ä¿®æ”¹å®žåœ¨å¤ªæŒ«ã€‚æ˜¯æ—¶å€™ä½¿ç”¨æ’ä»¶ (plugin) æ¥å®Œæˆè¿™ä¸€ä»»åŠ¡äº†ã€‚æˆ‘ä»¬ä½¿ç”¨ HtmlWebpackPlugin è‡ªåŠ¨ç”Ÿæˆ html æ–‡ä»¶ã€‚ loader å’Œ pluginï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿloader (åŠ è½½å™¨)ï¼Œé‡åœ¨â€œåŠ è½½â€äºŒå­—ï¼Œæ˜¯ç”¨äºŽé¢„å¤„ç†æ–‡ä»¶çš„ï¼Œåªç”¨äºŽåœ¨åŠ è½½ä¸åŒç±»åž‹çš„æ–‡ä»¶æ—¶å¯¹ä¸åŒç±»åž‹çš„æ–‡ä»¶åšç›¸åº”çš„å¤„ç†ã€‚è€Œ plugin (æ’ä»¶)ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯ç”¨æ¥å¢žåŠ  webpack çš„åŠŸèƒ½çš„ï¼Œä½œç”¨äºŽæ•´ä¸ª webpack çš„æž„å»ºè¿‡ç¨‹ã€‚åœ¨ webpack è¿™ä¸ªå¤§å…¬å¸ä¸­ï¼Œloader æ˜¯ä¿å®‰å¤§å”ï¼Œè´Ÿè´£å¯¹è¿›å…¥å…¬å¸çš„ä¸åŒäººå‘˜çš„å¤„ç†ï¼Œè€Œ plugin åˆ™æ˜¯å…¬å¸é‡Œä¸åŒèŒä½çš„èŒå‘˜ï¼Œè´Ÿè´£å…¬å¸é‡Œçš„å„ç§ä¸åŒä¸šåŠ¡ï¼Œæ¯å¢žåŠ ä¸€ç§æ–°åž‹çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬å°±éœ€è¦å¢žåŠ ä¸€ç§ pluginã€‚ å®‰è£…æ’ä»¶ï¼š1$ npm i --save-dev html-webpack-plugin webpack.config.js 12345678910111213141516171819202122const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');module.exports = &#123; // entry: './src/index.js', entry: &#123; app: './src/index.js', print: './src/print.js' &#125;, output: &#123; // filename: 'bundle.js', filename: '[name].bundle.js', path: path.resolve(__dirname, 'dist') &#125;, plugins: [ // æ’ä»¶å±žæ€§ï¼Œæ˜¯æ’ä»¶çš„å®žä¾‹æ•°ç»„ new HtmlWebpackPlugin(&#123; title: 'webpack demo', // ç”Ÿæˆ HTML æ–‡æ¡£çš„æ ‡é¢˜ filename: 'index.html' // å†™å…¥ HTML æ–‡ä»¶çš„æ–‡ä»¶åï¼Œé»˜è®¤ `index.html` &#125;) ], // ...&#125;; ä½ å¯ä»¥å…ˆæŠŠ dist æ–‡ä»¶å¤¹çš„index.htmlæ–‡ä»¶åˆ é™¤ï¼Œç„¶åŽæ‰§è¡Œæ‰“åŒ…å‘½ä»¤ã€‚å’»å’»å’»ï¼Œæˆ‘ä»¬çœ‹åˆ° dist ç›®å½•ä¸‹å·²ç»è‡ªåŠ¨ç”Ÿæˆäº†ä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼Œä½†å³ä½¿ä¸åˆ é™¤åŽŸå…ˆçš„index.htmlï¼Œè¯¥æ’ä»¶é»˜è®¤ç”Ÿæˆçš„index.htmlä¹Ÿä¼šæ›¿æ¢åŽŸæœ¬çš„index.htmlã€‚ æ­¤åˆ»ï¼Œå½“ä½ ç»†ç»†è§‚å¯Ÿ dist ç›®å½•æ—¶ï¼Œè™½ç„¶çŽ°åœ¨ç”Ÿæˆäº†æ–°çš„æ‰“åŒ…æ–‡ä»¶ï¼Œä½†åŽŸæœ¬çš„æ‰“åŒ…æ–‡ä»¶bundle.jsåŠå…¶ä»–ä¸ç”¨çš„æ–‡ä»¶ä»ç„¶å­˜åœ¨åœ¨ dist ç›®å½•ä¸­ï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡æž„å»ºå‰æˆ‘ä»¬éœ€è¦æ™´ç©º dist ç›®å½•ï¼Œæˆ‘ä»¬ä½¿ç”¨ CleanWebpackPlugin æ’ä»¶ã€‚ 1$ npm i clean-webpack-plugin --save-dev webpack.config.js123456789101112131415161718192021222324const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = &#123; // entry: './src/index.js', entry: &#123; app: './src/index.js', print: './src/print.js' &#125;, output: &#123; // filename: 'bundle.js', filename: '[name].bundle.js', path: path.resolve(__dirname, 'dist') &#125;, plugins: [ new HtmlWebpackPlugin(&#123; title: 'webpack demo', filename: 'index.html' &#125;), new CleanWebpackPlugin(['dist']) // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ¸…ç†çš„ç›®å½•çš„å­—ç¬¦ä¸²æ•°ç»„ ], // ...&#125;; æ‰“åŒ…ä¹‹ï¼ŒçŽ°åœ¨ï¼Œdist ä¸­åªå­˜åœ¨æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶ã€‚ webpack æä¾›äº†å¾ˆå¤šä¾¿äºŽå¼€å‘æ—¶ä½¿ç”¨çš„åŠŸèƒ½ï¼Œæ¥ä¸€ä¸€çœ‹çœ‹å§ã€‚ä½¿ç”¨ä»£ç æ˜ å°„ (source map)å½“ä½ çš„ä»£ç è¢«æ‰“åŒ…åŽï¼Œå¦‚æžœæ‰“åŒ…åŽçš„ä»£ç å‘ç”Ÿäº†é”™è¯¯ï¼Œä½ å¾ˆéš¾è¿½è¸ªåˆ°é”™è¯¯å‘ç”Ÿçš„åŽŸå§‹ä½ç½®ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ä»£ç æ˜ å°„ (source map) è¿™ç§å·¥å…·ï¼Œå®ƒèƒ½å°†ç¼–è¯‘åŽçš„ä»£ç æ˜ å°„å›žåŽŸå§‹çš„æºç ï¼Œä½ çš„é”™è¯¯æ˜¯èµ·æºäºŽæ‰“åŒ…å‰çš„b.jsçš„æŸä¸ªä½ç½®ï¼Œä»£ç æ˜ å°„å°±èƒ½å‘Šè¯‰ä½ é”™è¯¯æ˜¯é‚£ä¸ªæ¨¡å—çš„é‚£ä¸ªä½ç½®ã€‚webpack é»˜è®¤æä¾›äº† 10 ç§é£Žæ ¼çš„ä»£ç æ˜ å°„ï¼Œä½¿ç”¨å®ƒä»¬ä¼šæ˜Žæ˜¾å½±å“åˆ°æž„å»º (build) å’Œé‡æž„å»º (rebuildï¼Œæ¯æ¬¡ä¿®æ”¹åŽéœ€è¦é‡æ–°æž„å»º) çš„é€Ÿåº¦ï¼Œåç§é£Žæ ¼çš„å·®å¼‚å¯ä»¥å‚çœ‹ devtoolã€‚å…³äºŽå¦‚ä½•é€‰æ‹©æ˜ å°„é£Žæ ¼å¯ä»¥å‚çœ‹ Webpack devtool source mapã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä¸ºäº†å‡†ç¡®æ˜¾ç¤ºé”™è¯¯ä½ç½®ï¼Œé€‰æ‹©é€Ÿåº¦è¾ƒæ…¢çš„inline-source-mapã€‚ webpack.config.js 12345678910111213const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = &#123; devtool: 'inline-source-map', // æŽ§åˆ¶æ˜¯å¦ç”Ÿæˆä»¥åŠå¦‚ä½•ç”Ÿæˆ source map // entry: './src/index.js', entry: &#123; app: './src/index.js', print: './src/print.js' &#125;, // ...&#125;; çŽ°åœ¨æ¥æ‰‹åŠ¨åˆ¶é€ ä¸€äº›é”™è¯¯ï¼š src/print.js1234 export default function printMe() &#123;- console.log('I get called from print.js!');+ cosnole.log('I get called from print.js!'); &#125; æ‰“åŒ…ä¹‹åŽæ‰“å¼€index.htmlå†ç‚¹å‡»æŒ‰é’®ï¼Œä½ å°±ä¼šçœ‹åˆ°æŽ§åˆ¶å°æ˜¾ç¤ºå¦‚ä¸‹æŠ¥é”™ï¼š123456789101112 Uncaught ReferenceError: cosnole is not defined at HTMLButtonElement.printMe (print.js:2)``` çŽ°åœ¨ï¼Œæˆ‘ä»¬å¾ˆæ¸…æ¥šå“ªé‡Œå‘ç”Ÿäº†é”™è¯¯ï¼Œç„¶åŽè½»æ¾åœ°æ”¹æ­£ä¹‹ã€‚### webpack-dev-serverä½ ä¸€å®šæœ‰è¿™æ ·çš„ä½“éªŒï¼Œå¼€å‘æ—¶æ¯æ¬¡ä¿®æ”¹ä»£ç ä¿å­˜åŽéƒ½éœ€è¦é‡æ–°æ‰‹åŠ¨æž„å»ºä»£ç å¹¶æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨ä»¥è§‚å¯Ÿä¿®æ”¹æ•ˆæžœï¼Œè¿™æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¦å®žæ—¶åŠ è½½ä»£ç ã€‚å¯å–œçš„æ˜¯ï¼Œwebpack æä¾›äº†å¯¹å®žæ—¶åŠ è½½ä»£ç çš„æ”¯æŒã€‚æˆ‘ä»¬éœ€è¦å®‰è£… webpack-dev-server ä»¥èŽ·å¾—æ”¯æŒã€‚```javascript$ npm i --save-dev webpack-dev-server webpack.config.js 12345678910111213141516const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = &#123; devtool: 'inline-source-map', devServer: &#123; // æ£€æµ‹ä»£ç å˜åŒ–å¹¶è‡ªåŠ¨é‡æ–°ç¼–è¯‘å¹¶è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨ contentBase: path.resolve(__dirname, 'dist') // è®¾ç½®é™æ€èµ„æºçš„æ ¹ç›®å½• &#125;, // entry: './src/index.js', entry: &#123; app: './src/index.js', print: './src/print.js' &#125;, // ...&#125;; package.json12345678&#123; ... "scripts": &#123; "build": "webpack", "start": "webpack-dev-server --open" &#125;, ...&#125; Tipsä½¿ç”¨ webpack-dev-server æ—¶ï¼Œwebpack å¹¶æ²¡æœ‰å°†æ‰€æœ‰ç”Ÿæˆçš„æ–‡ä»¶å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯æ”¾åœ¨å†…å­˜ä¸­ï¼Œæä¾›æ›´å¿«çš„å†…å­˜å†…è®¿é—®ï¼Œä¾¿äºŽå®žæ—¶æ›´æ–°ã€‚ çŽ°åœ¨ï¼Œå¯ä»¥ç›´æŽ¥è¿è¡Œnpm start (startæ˜¯ npm scripts çš„å†…ç½®å±žæ€§ï¼Œå¯ç›´æŽ¥è¿è¡Œ)ï¼Œç„¶åŽæµè§ˆå™¨è‡ªåŠ¨åŠ è½½åº”ç”¨çš„é¡µé¢ï¼Œé»˜è®¤åœ¨localhost:8080æ˜¾ç¤ºã€‚ æ¨¡å—çƒ­æ›¿æ¢ (HMR, Hot Module Replacement)webpack æä¾›äº†å¯¹æ¨¡å—çƒ­æ›¿æ¢ (æˆ–è€…å«çƒ­åŠ è½½) çš„æ”¯æŒã€‚è¿™ä¸€ç‰¹æ€§èƒ½å¤Ÿè®©åº”ç”¨è¿è¡Œçš„æ—¶å€™æ›¿æ¢ã€å¢žåŠ æˆ–åˆ é™¤æ¨¡å—ï¼Œè€Œæ— éœ€è¿›è¡Œå®Œå…¨çš„é‡è½½ã€‚æƒ³è¿›ä¸€æ­¥åœ°äº†è§£å…¶å·¥ä½œæœºç†ï¼Œå¯ä»¥å‚è§ Hot Module Replacementï¼Œä½†è¿™å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œä½ å¯ä»¥é€‰æ‹©è·³è¿‡æœºç†éƒ¨åˆ†ç»§ç»­å¾€ä¸‹é˜…è¯»ã€‚ Tipsæ¨¡å—çƒ­æ›¿æ¢ï¼ˆHMRï¼‰åªæ›´æ–°å‘ç”Ÿå˜æ›´ï¼ˆæ›¿æ¢ã€æ·»åŠ ã€åˆ é™¤ï¼‰çš„æ¨¡å—ï¼Œè€Œæ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ï¼ˆå®žæ—¶åŠ è½½ï¼ŒLiveReloadï¼‰ï¼Œè¿™æ ·å¯ä»¥æ˜¾è‘—åŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œä¸€æ—¦æ‰“å¼€äº† webpack-dev-server çš„ hot æ¨¡å¼ï¼Œåœ¨è¯•å›¾é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ä¹‹å‰ï¼Œçƒ­æ¨¡å¼ä¼šå°è¯•ä½¿ç”¨ HMR æ¥æ›´æ–°ã€‚ webpack.config.js 1234567891011121314151617181920212223242526272829const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');const webpack = require('webpack'); // å¼•å…¥ webpack ä¾¿äºŽè°ƒç”¨å…¶å†…ç½®æ’ä»¶module.exports = &#123; devtool: 'inline-source-map', devServer: &#123; contentBase: path.resolve(__dirname, 'dist'), hot: true, // å‘Šè¯‰ dev-server æˆ‘ä»¬åœ¨ç”¨ HMR hotOnly: true // æŒ‡å®šå¦‚æžœçƒ­åŠ è½½å¤±è´¥äº†ç¦æ­¢åˆ·æ–°é¡µé¢ (è¿™æ˜¯ webpack çš„é»˜è®¤è¡Œä¸º)ï¼Œè¿™æ ·ä¾¿äºŽæˆ‘ä»¬çŸ¥é“å¤±è´¥æ˜¯å› ä¸ºä½•ç§é”™è¯¯ &#125;, // entry: './src/index.js', entry: &#123; app: './src/index.js', // print: './src/print.js' &#125;, // ... plugins: [ new HtmlWebpackPlugin(&#123; title: 'webpack demo', filename: 'index.html' &#125;), new CleanWebpackPlugin(['dist']), new webpack.HotModuleReplacementPlugin(), // å¯ç”¨ HMR new webpack.NamedModulesPlugin() // æ‰“å°æ—¥å¿—ä¿¡æ¯æ—¶ webpack é»˜è®¤ä½¿ç”¨æ¨¡å—çš„æ•°å­— ID æŒ‡ä»£æ¨¡å—ï¼Œä¸ä¾¿äºŽ debugï¼Œè¿™ä¸ªæ’ä»¶å¯ä»¥å°†å…¶æ›¿æ¢ä¸ºæ¨¡å—çš„çœŸå®žè·¯å¾„ ], // ...&#125;; Tipswebpack-dev-server ä¼šä¸ºæ¯ä¸ªå…¥å£æ–‡ä»¶åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬ä¼šç›‘æŽ§è¯¥å…¥å£æ–‡ä»¶çš„ä¾èµ–æ¨¡å—çš„æ›´æ–°ï¼Œå¦‚æžœè¯¥å…¥å£æ–‡ä»¶ç¼–å†™äº† HMR å¤„ç†å‡½æ•°ï¼Œå®ƒå°±èƒ½æŽ¥æ”¶ä¾èµ–æ¨¡å—çš„æ›´æ–°ï¼Œåä¹‹ï¼Œæ›´æ–°ä¼šå‘ä¸Šå†’æ³¡ï¼Œç›´åˆ°å®¢æˆ·ç«¯è„šæœ¬ä»æ²¡æœ‰å¤„ç†å‡½æ•°çš„è¯ï¼Œwebpack-dev-server ä¼šé‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ã€‚å¦‚æžœå…¥å£æ–‡ä»¶æœ¬èº«å‘ç”Ÿäº†æ›´æ–°ï¼Œå› ä¸ºå‘ä¸Šä¼šå†’æ³¡åˆ°å®¢æˆ·ç«¯è„šæœ¬ï¼Œå¹¶ä¸”ä¸å­˜åœ¨ HMR å¤„ç†å‡½æ•°ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´é¡µé¢é‡è½½ã€‚ æˆ‘ä»¬å·²ç»å¼€å¯äº† HMR çš„åŠŸèƒ½ï¼ŒHMR çš„æŽ¥å£å·²ç»æš´éœ²åœ¨module.hotå±žæ€§ä¹‹ä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ HMR API å³å¯å®žçŽ°çƒ­åŠ è½½ã€‚å½“â€œè¢«åŠ è½½æ¨¡å—â€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¾èµ–è¯¥æ¨¡å—çš„æ¨¡å—ä¾¿èƒ½æ£€æµ‹åˆ°æ”¹å˜å¹¶æŽ¥æ”¶æ”¹å˜ä¹‹åŽçš„æ¨¡å—ã€‚ src/index.js 123456789101112131415161718192021222324252627282930313233343536import _ from 'lodash';import printMe from './print.js';// import './style.css';// import Icon from './icon.jpg';// import Data from './data.json';function component() &#123; const element = document.createElement('div'); const btn = document.createElement('button'); element.innerHTML = _.join(['Hello', 'webpack'], ' '); // element.classList.add('hello'); // const myIcon = new Image(); // myIcon.src = Icon; // element.appendChild(myIcon); // console.log(Data); btn.innerHTML = 'Click me and check the console!'; btn.onclick = printMe; element.appendChild(btn); return element;&#125;document.body.appendChild(component());if(module.hot) &#123; // ä¹ æƒ¯ä¸Šæˆ‘ä»¬ä¼šæ£€æŸ¥æ˜¯å¦å¯ä»¥è®¿é—® `module.hot` å±žæ€§ module.hot.accept('./print.js', function() &#123; // æŽ¥å—ç»™å®šä¾èµ–æ¨¡å—çš„æ›´æ–°ï¼Œå¹¶è§¦å‘ä¸€ä¸ªå›žè°ƒå‡½æ•°æ¥å¯¹è¿™äº›æ›´æ–°åšå‡ºå“åº” console.log('Accepting the updated printMe module!'); printMe(); &#125;);&#125; npm startä¹‹ã€‚ä¸ºäº†æ¼”ç¤ºæ•ˆæžœï¼Œæˆ‘ä»¬åšå¦‚ä¸‹ä¿®æ”¹ï¼š src/print.js1234 export default function printMe() &#123;- console.log('I get called from print.js!');+ console.log('Updating print.js...'); &#125; æˆ‘ä»¬ä¼šçœ‹åˆ°æŽ§åˆ¶å°æ‰“å°å‡ºçš„ä¿¡æ¯ä¸­å«æœ‰ä»¥ä¸‹å‡ è¡Œï¼š12345index.js:33 Accepting the updated printMe module!print.js:2 Updating print.js...log.js:23 [HMR] Updated modules:log.js:23 [HMR] - ./src/print.jslog.js:23 [HMR] App is up to date. Tipswebpack-dev-server åœ¨ inline mode (æ­¤ä¸ºé»˜è®¤æ¨¡å¼) æ—¶ï¼Œä¼šä¸ºæ¯ä¸ªå…¥å£èµ·ç‚¹ (entry) åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯è„šæœ¬ï¼Œæ‰€ä»¥ä½ ä¼šåœ¨ä¸Šé¢çš„è¾“å‡ºä¸­çœ‹åˆ°æœ‰äº›ä¿¡æ¯é‡å¤è¾“å‡ºä¸¤æ¬¡ã€‚ ä½†æ˜¯å½“ä½ ç‚¹å‡»é¡µé¢çš„æŒ‰é’®æ—¶ï¼Œä½ ä¼šå‘çŽ°æŽ§åˆ¶å°è¾“å‡ºçš„æ˜¯æ—§çš„printMeå‡½æ•°è¾“å‡ºçš„ä¿¡æ¯ï¼Œå› ä¸ºonclickäº‹ä»¶ç»‘å®šçš„ä»æ˜¯åŽŸå§‹çš„printMeå‡½æ•°ã€‚æˆ‘ä»¬éœ€è¦åœ¨module.hot.accepté‡Œæ›´æ–°ç»‘å®šã€‚ src/index.js 12345678910111213141516171819202122import _ from 'lodash';import printMe from './print.js';// import './style.css';// import Icon from './icon.jpg';// import Data from './data.json';// ...// document.body.appendChild(component());var element = component();document.body.appendChild(element);if(module.hot) &#123; module.hot.accept('./print.js', function() &#123; console.log('Accepting the updated printMe module!'); // printMe(); document.body.removeChild(element); element = component(); document.body.appendChild(element); &#125;);&#125; æ¨¡å—çƒ­æ›¿æ¢ä¹Ÿå¯ä»¥ç”¨äºŽæ ·å¼çš„ä¿®æ”¹ï¼Œæ•ˆæžœè·ŸæŽ§åˆ¶å°ä¿®æ”¹ä¸€æ ·ä¸€æ ·çš„ã€‚ src/index.js 1234567import _ from 'lodash';import printMe from './print.js';import './style.css';// import Icon from './icon.jpg';// import Data from './data.json';// ... npm startä¹‹ï¼Œåšå¦‚ä¸‹ä¿®æ”¹ï¼š12345/* ... */body &#123; background-color: yellow;&#125; å¯ä»¥å‘çŽ°åœ¨ä¸é‡è½½é¡µé¢çš„å‰æä¸‹æˆ‘ä»¬å¯¹æ ·å¼çš„ä¿®æ”¹è¿›è¡Œäº†çƒ­åŠ è½½ï¼Œæ£’ï¼ ç”Ÿäº§çŽ¯å¢ƒè‡ªåŠ¨æ–¹å¼æˆ‘ä»¬åªéœ€è¦è¿è¡Œwebpack -p (ç›¸å½“äºŽ webpack â€“optimize-minimize â€“define process.env.NODE_ENV=â€â€˜productionâ€™â€)è¿™ä¸ªå‘½ä»¤ï¼Œä¾¿å¯ä»¥è‡ªåŠ¨æž„å»ºç”Ÿäº§ç‰ˆæœ¬çš„åº”ç”¨ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šå®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š ä½¿ç”¨ UglifyJsPlugin (webpack.optimize.UglifyJsPlugin) åŽ‹ç¼© JS æ–‡ä»¶ (æ­¤æ’ä»¶å’Œ uglifyjs-webpack-plugin ç›¸åŒ) è¿è¡Œ LoaderOptionsPlugin æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶æ˜¯ç”¨æ¥è¿ç§»çš„ï¼Œè§ document è®¾ç½® NodeJS çš„çŽ¯å¢ƒå˜é‡ï¼Œè§¦å‘æŸäº› package åŒ…ä»¥ä¸åŒæ–¹å¼ç¼–è¯‘ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œwebpack -pè®¾ç½®çš„process.env.NODE_ENVçŽ¯å¢ƒå˜é‡ï¼Œæ˜¯ç”¨äºŽç¼–è¯‘åŽçš„ä»£ç çš„ï¼Œåªæœ‰åœ¨æ‰“åŒ…åŽçš„ä»£ç ä¸­ï¼Œè¿™ä¸€çŽ¯å¢ƒå˜é‡æ‰æ˜¯æœ‰æ•ˆçš„ã€‚å¦‚æžœåœ¨ webpack é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨æ­¤çŽ¯å¢ƒå˜é‡ï¼Œå¾—åˆ°çš„æ˜¯ undefinedï¼Œå¯ä»¥å‚è§ #2537ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶æˆ‘ä»¬ç¡®å®žéœ€è¦åœ¨ webpack é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ process.env.NODE_ENVï¼Œæ€Žä¹ˆåŠžå‘¢ï¼Ÿä¸€ä¸ªæ–¹æ³•æ˜¯è¿è¡ŒNODE_ENV=â€™productionâ€™ webpack -på‘½ä»¤ï¼Œä¸è¿‡è¿™ä¸ªå‘½ä»¤åœ¨Windowsä¸­æ˜¯ä¼šå‡ºé—®é¢˜çš„ã€‚ä¸ºäº†è§£å†³å…¼å®¹é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨ cross-env è§£å†³è·¨å¹³å°çš„é—®é¢˜ã€‚ 1$ npm i --save-dev cross-env package.json12345678&#123; ... "scripts": &#123; "build": "cross-env NODE_ENV=production webpack -p", "start": "webpack-dev-server --open" &#125;, ...&#125; çŽ°åœ¨å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨process.env.NODE_ENVäº†ã€‚ webpack.config.js123456789101112131415161718192021222324const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');const webpack = require('webpack');module.exports = &#123; // ... output: &#123; // filename: 'bundle.js', // filename: '[name].bundle.js', filename: process.env.NODE_ENV === 'production' ? '[name].[chunkhash].js' : '[name].bundle.js', // åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨`process.env.NODE_ENV` path: path.resolve(__dirname, 'dist') &#125;, plugins: [ new HtmlWebpackPlugin(&#123; title: 'webpack demo', filename: 'index.html' &#125;), new CleanWebpackPlugin(['dist']), // new webpack.HotModuleReplacementPlugin(), // å…³é—­ HMR åŠŸèƒ½ new webpack.NamedModulesPlugin() ], // ...&#125;; Tips[chunkhash]ä¸èƒ½å’Œ HMR ä¸€èµ·ä½¿ç”¨ï¼Œæ¢å¥è¯è¯´ï¼Œä¸åº”è¯¥åœ¨å¼€å‘çŽ¯å¢ƒä¸­ä½¿ç”¨ [chunkhash] (æˆ–è€… [hash])ï¼Œè¿™ä¼šå¯¼è‡´è®¸å¤šé—®é¢˜ã€‚ build ä¹‹ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç”Ÿäº§ç‰ˆæœ¬çš„åŽ‹ç¼©å¥½çš„æ‰“åŒ…æ–‡ä»¶ã€‚ å¤šé…ç½®æ–‡ä»¶é…ç½®æœ‰æ—¶æˆ‘ä»¬ä¼šéœ€è¦ä¸ºä¸åŒçš„çŽ¯å¢ƒé…ç½®ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥é€‰æ‹© ç®€æ˜“æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨è¾ƒä¸ºå…ˆè¿›çš„æ–¹æ³•ã€‚å…ˆå‡†å¤‡ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«äº†æ‰€æœ‰çŽ¯å¢ƒéƒ½åŒ…å«çš„é…ç½®ï¼Œç„¶åŽç”¨ webpack-merge å°†å®ƒå’Œç‰¹å®šçŽ¯å¢ƒçš„é…ç½®æ–‡ä»¶åˆå¹¶å¹¶å¯¼å‡ºï¼Œè¿™æ ·å°±å‡å°‘äº†åŸºæœ¬é…ç½®çš„é‡å¤ã€‚ 1$ npm i --save-dev webpack-merge webpack.common.js 12345678910111213141516171819202122232425262728293031323334353637383940414243const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = &#123; entry: &#123; app: './src/index.js', print: './src/print.js' &#125;, output: &#123; path: path.resolve(__dirname, 'dist') &#125;, plugins: [ new HtmlWebpackPlugin(&#123; title: 'webpack demo', filename: 'index.html' &#125;), new CleanWebpackPlugin(['dist']) ], module: &#123; rules: [ &#123; test: /\.css$/, use: [ 'style-loader', 'css-loader' ] &#125;, &#123; test: /\.(png|svg|jpg|gif)$/, use: [ 'file-loader' ] &#125;, &#123; test: /\.(woff|woff2|eot|ttf|otf)$/, use: [ 'file-loader' ] &#125; ] &#125;&#125;; webpack.dev.js 1234567891011121314151617181920212223const path = require('path');const webpack = require('webpack');const Merge = require('webpack-merge');const CommonConfig = require('./webpack.common.js');module.exports = Merge(CommonConfig, &#123; devtool: 'cheap-module-eval-source-map', devServer: &#123; contentBase: path.resolve(__dirname, 'dist'), hot: true, hotOnly: true &#125;, output: &#123; filename: '[name].bundle.js' &#125;, plugins: [ new webpack.DefinePlugin(&#123; 'process.env.NODE_ENV': JSON.stringify('development') // åœ¨ç¼–è¯‘çš„ä»£ç é‡Œè®¾ç½®äº†`process.env.NODE_ENV`å˜é‡ &#125;), new webpack.HotModuleReplacementPlugin(), new webpack.NamedModulesPlugin() ]&#125;); webpack.prod.js 1234567891011121314151617const path = require('path');const webpack = require('webpack');const Merge = require('webpack-merge');const CommonConfig = require('./webpack.common.js');module.exports = Merge(CommonConfig, &#123; devtool: 'cheap-module-source-map', output: &#123; filename: '[name].[chunkhash].js' &#125;, plugins: [ new webpack.DefinePlugin(&#123; 'process.env.NODE_ENV': JSON.stringify('production') &#125;), new webpack.optimize.UglifyJsPlugin() ]&#125;); package.json 12345678910&#123; ... "scripts": &#123; "build": "cross-env NODE_ENV=production webpack -p", "start": "webpack-dev-server --open", "build:dev": "webpack-dev-server --open --config webpack.dev.js", "build:prod": "webpack --progress --config webpack.prod.js" &#125;, ...&#125; çŽ°åœ¨åªéœ€æ‰§è¡Œnpm run build:devæˆ–npm run build:prodä¾¿å¯ä»¥å¾—åˆ°å¼€å‘ç‰ˆæˆ–è€…ç”Ÿäº§ç‰ˆäº†ï¼ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSé«˜çº§ä¹‹é¢è¯•å¿…é¡»çŸ¥é“çš„å‡ ä¸ªç‚¹]]></title>
    <url>%2F2018%2F04%2F16%2FInterview%2FJS%E9%AB%98%E7%BA%A7%E4%B9%8B%E9%9D%A2%E8%AF%95%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E7%9A%84%E5%87%A0%E4%B8%AA%E7%82%B9%2F</url>
    <content type="text"><![CDATA[å‡½æ•°çš„3ç§å®šä¹‰å‡½æ•°å£°æ˜Ž12345//ES5function getSum()&#123;&#125;function ()&#123;&#125;//åŒ¿åå‡½æ•°//ES6()=&gt;&#123;&#125;//å¦‚æžœ&#123;&#125;å†…å®¹åªæœ‰ä¸€è¡Œ&#123;&#125;å’Œreturnå…³é”®å­—å¯çœ, å‡½æ•°è¡¨è¾¾å¼ï¼ˆå­—é¢é‡å½¢å¼ï¼‰1234//ES5var sum=function getSum()&#123;&#125;//ES6let sum=()=&gt;&#123;&#125;//å¦‚æžœ&#123;&#125;å†…å®¹åªæœ‰ä¸€è¡Œ&#123;&#125;å’Œreturnå…³é”®å­—å¯çœ, æž„é€ å‡½æ•°1var sum=new GetSum(num1,num2) ä¸‰ç§æ–¹æ³•çš„å¯¹æ¯”1.å‡½æ•°å£°æ˜Žæœ‰é¢„è§£æž,è€Œä¸”å‡½æ•°å£°æ˜Žçš„ä¼˜å…ˆçº§é«˜äºŽå˜é‡;2.ä½¿ç”¨Functionæž„é€ å‡½æ•°å®šä¹‰å‡½æ•°çš„æ–¹å¼æ˜¯ä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼,è¿™ç§æ–¹å¼ä¼šå¯¼è‡´è§£æžä¸¤æ¬¡ä»£ç ï¼Œå½±å“æ€§èƒ½ã€‚ç¬¬ä¸€æ¬¡è§£æžå¸¸è§„çš„JavaScriptä»£ç ï¼Œç¬¬äºŒæ¬¡è§£æžä¼ å…¥æž„é€ å‡½æ•°çš„å­—ç¬¦ä¸² Es5å‡½æ•°ä¸­çš„4ç§è°ƒç”¨åœ¨ES5ä¸­å‡½æ•°å†…å®¹çš„thisæŒ‡å‘å’Œè°ƒç”¨æ–¹æ³•æœ‰å…³ å‡½æ•°è°ƒç”¨æ¨¡å¼åŒ…æ‹¬å‡½æ•°å()å’ŒåŒ¿åå‡½æ•°è°ƒç”¨,thisæŒ‡å‘window 123456789101112function getSum() &#123; console.log(this) //window&#125;getSum()(function() &#123; console.log(this) //window&#125;)()var getSum=function() &#123; console.log(this) //window&#125; æ–¹æ³•è°ƒç”¨å¯¹è±¡.æ–¹æ³•å(),thisæŒ‡å‘å¯¹è±¡ 1234567var objList = &#123; name: 'methods', getSum: function() &#123; console.log(this) //objListå¯¹è±¡ &#125;&#125;objList.getSum() æž„é€ å™¨è°ƒç”¨new æž„é€ å‡½æ•°å(),thisæŒ‡å‘æž„é€ å‡½æ•° 1234function Person() &#123; console.log(this); //æŒ‡å‘æž„é€ å‡½æ•°Person&#125;var personOne = new Person(); é—´æŽ¥è°ƒç”¨åˆ©ç”¨callå’Œapplyæ¥å®žçŽ°,thiså°±æ˜¯callå’Œapplyå¯¹åº”çš„ç¬¬ä¸€ä¸ªå‚æ•°,å¦‚æžœä¸ä¼ å€¼æˆ–è€…ç¬¬ä¸€ä¸ªå€¼ä¸ºnull,undefinedæ—¶thisæŒ‡å‘window 12345function foo() &#123; console.log(this);&#125;foo.apply('æˆ‘æ˜¯applyæ”¹å˜çš„thiså€¼');//æˆ‘æ˜¯applyæ”¹å˜çš„thiså€¼foo.call('æˆ‘æ˜¯callæ”¹å˜çš„thiså€¼');//æˆ‘æ˜¯callæ”¹å˜çš„thiså€¼ Es6å‡½æ•°çš„è°ƒç”¨ç®­å¤´å‡½æ•°ä¸å¯ä»¥å½“ä½œæž„é€ å‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½ç”¨newå‘½ä»¤å®žä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ç®­å¤´å‡½æ•°çš„thisæ˜¯å’Œå®šä¹‰æ—¶æœ‰å…³å’Œè°ƒç”¨æ— å…³è°ƒç”¨å°±æ˜¯å‡½æ•°è°ƒç”¨æ¨¡å¼ 1234567891011121314151617(() =&gt; &#123; console.log(this)//window&#125;)()let arrowFun = () =&gt; &#123; console.log(this)//window&#125;arrowFun()let arrowObj = &#123; arrFun: function() &#123; (() =&gt; &#123; console.log(this)//arrowObj &#125;)() &#125; &#125; arrowObj.arrFun(); call,applyå’Œbind1.IE5ä¹‹å‰ä¸æ”¯æŒcallå’Œapply,bindæ˜¯ES5å‡ºæ¥çš„;2.callå’Œapplyå¯ä»¥è°ƒç”¨å‡½æ•°,æ”¹å˜this,å®žçŽ°ç»§æ‰¿å’Œå€Ÿç”¨åˆ«çš„å¯¹è±¡çš„æ–¹æ³•; callå’Œapplyå®šä¹‰è°ƒç”¨æ–¹æ³•,ç”¨ä¸€ä¸ªå¯¹è±¡æ›¿æ¢æŽ‰å¦ä¸€ä¸ªå¯¹è±¡(this)å¯¹è±¡.call(æ–°thiså¯¹è±¡,å®žå‚1,å®žå‚2,å®žå‚3â€¦..) å‚æ•°åˆ—è¡¨å¯¹è±¡.apply(æ–°thiså¯¹è±¡,[å®žå‚1,å®žå‚2,å®žå‚3â€¦..]) å‚æ•°æ•°ç»„ callå’Œapplyç”¨æ³•1.é—´æŽ¥è°ƒç”¨å‡½æ•°,æ”¹å˜ä½œç”¨åŸŸçš„thiså€¼2.åŠ«æŒå…¶ä»–å¯¹è±¡çš„æ–¹æ³• 1234567891011var foo = &#123; name:"å¼ ä¸‰", logName:function()&#123; console.log(this.name); &#125;&#125;var bar=&#123; name:"æŽå››"&#125;;foo.logName.call(bar);//æŽå››å®žè´¨æ˜¯callæ”¹å˜äº†fooçš„thisæŒ‡å‘ä¸ºbar,å¹¶è°ƒç”¨è¯¥å‡½æ•° 3.ä¸¤ä¸ªå‡½æ•°å®žçŽ°ç»§æ‰¿ 1234567891011function Animal(name)&#123; this.name = name; this.showName = function()&#123; console.log(this.name); &#125;&#125;function Cat(name)&#123; Animal.call(this, name); &#125; var cat = new Cat("Black Cat");cat.showName(); //Black Cat 4.ä¸ºç±»æ•°ç»„(argumentså’ŒnodeList)æ·»åŠ æ•°ç»„æ–¹æ³•push,pop 1234(function()&#123; Array.prototype.push.call(arguments,'çŽ‹äº”'); console.log(arguments);//['å¼ ä¸‰','æŽå››','çŽ‹äº”']&#125;)('å¼ ä¸‰','æŽå››') 5.åˆå¹¶æ•°ç»„ 123let arr1=[1,2,3]; let arr2=[4,5,6]; Array.prototype.push.apply(arr1,arr2); //å°†arr2åˆå¹¶åˆ°äº†arr1ä¸­ 6.æ±‚æ•°ç»„æœ€å¤§å€¼ 1Math.max.apply(null,arr) 7.åˆ¤æ–­å­—ç¬¦ç±»åž‹ 1Object.prototype.toString.call(&#123;&#125;) bindbindæ˜¯functionçš„ä¸€ä¸ªå‡½æ•°æ‰©å±•æ–¹æ³•ï¼Œbindä»¥åŽä»£ç é‡æ–°ç»‘å®šäº†funcå†…éƒ¨çš„thisæŒ‡å‘,ä¸ä¼šè°ƒç”¨æ–¹æ³•,ä¸å…¼å®¹IE8 1234567891011var name = 'æŽå››' var foo = &#123; name: "å¼ ä¸‰", logName: function(age) &#123; console.log(this.name, age); &#125; &#125; var fooNew = foo.logName; var fooNewBind = foo.logName.bind(foo); fooNew(10)//æŽå››,10 fooNewBind(11)//å¼ ä¸‰,11 å› ä¸ºbindæ”¹å˜äº†fooNewBindé‡Œé¢çš„thisæŒ‡å‘ å¸¸è§çš„å››ç§è®¾è®¡æ¨¡å¼å·¥åŽ‚æ¨¡å¼ç®€å•çš„å·¥åŽ‚æ¨¡å¼å¯ä»¥ç†è§£ä¸ºè§£å†³å¤šä¸ªç›¸ä¼¼çš„é—®é¢˜; 123456789101112131415161718192021function CreatePerson(name,age,sex) &#123; var obj = new Object(); obj.name = name; obj.age = age; obj.sex = sex; obj.sayName = function()&#123; return this.name; &#125; return obj;&#125;var p1 = new CreatePerson("longen",'28','ç”·');var p2 = new CreatePerson("tugenhua",'27','å¥³');console.log(p1.name); // longenconsole.log(p1.age); // 28console.log(p1.sex); // ç”·console.log(p1.sayName()); // longenconsole.log(p2.name); // tugenhuaconsole.log(p2.age); // 27console.log(p2.sex); // å¥³console.log(p2.sayName()); // tugenhua å•ä¾‹æ¨¡å¼åªèƒ½è¢«å®žä¾‹åŒ–(æž„é€ å‡½æ•°ç»™å®žä¾‹æ·»åŠ å±žæ€§ä¸Žæ–¹æ³•)ä¸€æ¬¡ 1234567891011121314151617181920// å•ä½“æ¨¡å¼var Singleton = function(name)&#123; this.name = name;&#125;;Singleton.prototype.getName = function()&#123; return this.name;&#125;// èŽ·å–å®žä¾‹å¯¹è±¡var getInstance = (function() &#123; var instance = null; return function(name) &#123; if(!instance) &#123;//ç›¸å½“äºŽä¸€ä¸ªä¸€æ¬¡æ€§é˜€é—¨,åªèƒ½å®žä¾‹åŒ–ä¸€æ¬¡ instance = new Singleton(name); &#125; return instance; &#125;&#125;)();// æµ‹è¯•å•ä½“æ¨¡å¼çš„å®žä¾‹,æ‰€ä»¥a===bvar a = getInstance("aa");var b = getInstance("bb"); æ²™ç®±æ¨¡å¼å°†ä¸€äº›å‡½æ•°æ”¾åˆ°è‡ªæ‰§è¡Œå‡½æ•°é‡Œé¢,ä½†è¦ç”¨é—­åŒ…æš´éœ²æŽ¥å£,ç”¨å˜é‡æŽ¥æ”¶æš´éœ²çš„æŽ¥å£,å†è°ƒç”¨é‡Œé¢çš„å€¼,å¦åˆ™æ— æ³•ä½¿ç”¨é‡Œé¢çš„å€¼ 12345678let sandboxModel=(function()&#123; function sayName()&#123;&#125;; function sayAge()&#123;&#125;; return&#123; sayName:sayName, sayAge:sayAge &#125;&#125;)() å‘å¸ƒè€…è®¢é˜…æ¨¡å¼å°±ä¾‹å¦‚å¦‚æˆ‘ä»¬å…³æ³¨äº†æŸä¸€ä¸ªå…¬ä¼—å·,ç„¶åŽä»–å¯¹åº”çš„æœ‰æ–°çš„æ¶ˆæ¯å°±ä¼šç»™ä½ æŽ¨é€, 12345678910111213141516171819202122232425262728//å‘å¸ƒè€…ä¸Žè®¢é˜…æ¨¡å¼ var shoeObj = &#123;&#125;; // å®šä¹‰å‘å¸ƒè€… shoeObj.list = []; // ç¼“å­˜åˆ—è¡¨ å­˜æ”¾è®¢é˜…è€…å›žè°ƒå‡½æ•° // å¢žåŠ è®¢é˜…è€… shoeObj.listen = function(fn) &#123; shoeObj.list.push(fn); // è®¢é˜…æ¶ˆæ¯æ·»åŠ åˆ°ç¼“å­˜åˆ—è¡¨ &#125; // å‘å¸ƒæ¶ˆæ¯ shoeObj.trigger = function() &#123; for (var i = 0, fn; fn = this.list[i++];) &#123; fn.apply(this, arguments);//ç¬¬ä¸€ä¸ªå‚æ•°åªæ˜¯æ”¹å˜fnçš„this, &#125; &#125; // å°çº¢è®¢é˜…å¦‚ä¸‹æ¶ˆæ¯ shoeObj.listen(function(color, size) &#123; console.log("é¢œè‰²æ˜¯ï¼š" + color); console.log("å°ºç æ˜¯ï¼š" + size); &#125;); // å°èŠ±è®¢é˜…å¦‚ä¸‹æ¶ˆæ¯ shoeObj.listen(function(color, size) &#123; console.log("å†æ¬¡æ‰“å°é¢œè‰²æ˜¯ï¼š" + color); console.log("å†æ¬¡æ‰“å°å°ºç æ˜¯ï¼š" + size); &#125;); shoeObj.trigger("çº¢è‰²", 40); shoeObj.trigger("é»‘è‰²", 42); ä»£ç å®žçŽ°é€»è¾‘æ˜¯ç”¨æ•°ç»„å­˜è´®è®¢é˜…è€…, å‘å¸ƒè€…å›žè°ƒå‡½æ•°é‡Œé¢é€šçŸ¥çš„æ–¹å¼æ˜¯éåŽ†è®¢é˜…è€…æ•°ç»„,å¹¶å°†å‘å¸ƒè€…å†…å®¹ä¼ å…¥è®¢é˜…è€…æ•°ç»„ æ›´å¤šè®¾è®¡æ¨¡å¼è¯·æˆ³:Javascriptå¸¸ç”¨çš„è®¾è®¡æ¨¡å¼è¯¦è§£ åŽŸåž‹é“¾å®šä¹‰å¯¹è±¡ç»§æ‰¿å±žæ€§çš„ä¸€ä¸ªé“¾æ¡ æž„é€ å‡½æ•°,å®žä¾‹ä¸ŽåŽŸåž‹å¯¹è±¡çš„å…³ç³»æž„é€ å‡½æ•°,å®žä¾‹ä¸ŽåŽŸåž‹å¯¹è±¡çš„å…³ç³» 12var Person = function (name) &#123; this.name = name; &#125;//personæ˜¯æž„é€ å‡½æ•°var o3personTwo = new Person('personTwo')//personTwoæ˜¯å®žä¾‹ æž„é€ å‡½æ•°,å®žä¾‹ä¸ŽåŽŸåž‹å¯¹è±¡çš„å…³ç³»ä¾‹å­ åŽŸåž‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„constructorå±žæ€§æŒ‡å‘æž„é€ å‡½æ•° åˆ›å»ºå®žä¾‹çš„æ–¹æ³•1.å­—é¢é‡ 1let obj=&#123;'name':'å¼ ä¸‰'&#125; 2.Objectæž„é€ å‡½æ•°åˆ›å»º 12let Obj=new Object()Obj.name='å¼ ä¸‰' 3.ä½¿ç”¨å·¥åŽ‚æ¨¡å¼åˆ›å»ºå¯¹è±¡ 1234567function createPerson(name)&#123; var o = new Object(); o.name = name; &#125;; return o;&#125;var person1 = createPerson('å¼ ä¸‰'); 4.ä½¿ç”¨æž„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ 1234function Person(name)&#123; this.name = name;&#125;var person1 = new Person('å¼ ä¸‰'); newè¿ç®—ç¬¦1.åˆ›äº†ä¸€ä¸ªæ–°å¯¹è±¡;2.thisæŒ‡å‘æž„é€ å‡½æ•°;3.æž„é€ å‡½æ•°æœ‰è¿”å›ž,ä¼šæ›¿æ¢newå‡ºæ¥çš„å¯¹è±¡,å¦‚æžœæ²¡æœ‰å°±æ˜¯newå‡ºæ¥çš„å¯¹è±¡4.æ‰‹åŠ¨å°è£…ä¸€ä¸ªnewè¿ç®—ç¬¦ 123456789var new2 = function (func) &#123; var o = Object.create(func.prototype); //åˆ›å»ºå¯¹è±¡ var k = func.call(o); //æ”¹å˜thisæŒ‡å‘ï¼ŒæŠŠç»“æžœä»˜ç»™k if (typeof k === 'object') &#123; //åˆ¤æ–­kçš„ç±»åž‹æ˜¯ä¸æ˜¯å¯¹è±¡ return k; //æ˜¯ï¼Œè¿”å›žk &#125; else &#123; return o; //ä¸æ˜¯è¿”å›žè¿”å›žæž„é€ å‡½æ•°çš„æ‰§è¡Œç»“æžœ &#125;&#125; æ›´å¤šè¯¦æƒ…:è¯¦è°ˆJavaScriptåŽŸåž‹é“¾ å¯¹è±¡çš„åŽŸåž‹é“¾å¯¹è±¡çš„åŽŸåž‹é“¾ ç»§æ‰¿çš„æ–¹å¼JSæ˜¯ä¸€é—¨å¼±ç±»åž‹åŠ¨æ€è¯­è¨€,å°è£…å’Œç»§æ‰¿æ˜¯ä»–çš„ä¸¤å¤§ç‰¹æ€§ åŽŸåž‹é“¾ç»§æ‰¿å°†çˆ¶ç±»çš„å®žä¾‹ä½œä¸ºå­ç±»çš„åŽŸåž‹ä»£ç å®žçŽ° å®šä¹‰çˆ¶ç±»: 12345678910111213// å®šä¹‰ä¸€ä¸ªåŠ¨ç‰©ç±»function Animal (name) &#123; // å±žæ€§ this.name = name || 'Animal'; // å®žä¾‹æ–¹æ³• this.sleep = function()&#123; console.log(this.name + 'æ­£åœ¨ç¡è§‰ï¼'); &#125;&#125;// åŽŸåž‹æ–¹æ³•Animal.prototype.eat = function(food) &#123; console.log(this.name + 'æ­£åœ¨åƒï¼š' + food);&#125;; å­ç±»: 123456789101112function Cat()&#123;&#125;Cat.prototype = new Animal();Cat.prototype.name = 'cat';// Test Codevar cat = new Cat();console.log(cat.name);//catconsole.log(cat.eat('fish'));//catæ­£åœ¨åƒï¼šfish undefinedconsole.log(cat.sleep());//catæ­£åœ¨ç¡è§‰ï¼ undefinedconsole.log(cat instanceof Animal); //trueconsole.log(cat instanceof Cat); //true ä¼˜ç¼ºç‚¹ç®€å•æ˜“äºŽå®žçŽ°,ä½†æ˜¯è¦æƒ³ä¸ºå­ç±»æ–°å¢žå±žæ€§å’Œæ–¹æ³•ï¼Œå¿…é¡»è¦åœ¨new Animal()è¿™æ ·çš„è¯­å¥ä¹‹åŽæ‰§è¡Œ,æ— æ³•å®žçŽ°å¤šç»§æ‰¿ æž„é€ ç»§æ‰¿å®žè´¨æ˜¯åˆ©ç”¨callæ¥æ”¹å˜Catä¸­çš„thisæŒ‡å‘ä»£ç å®žçŽ°å­ç±»: 1234function Cat(name)&#123; Animal.call(this); this.name = name || 'Tom';&#125; ä¼˜ç¼ºç‚¹å¯ä»¥å®žçŽ°å¤šç»§æ‰¿,ä¸èƒ½ç»§æ‰¿åŽŸåž‹å±žæ€§/æ–¹æ³• å®žä¾‹ç»§æ‰¿ä¸ºçˆ¶ç±»å®žä¾‹æ·»åŠ æ–°ç‰¹æ€§ï¼Œä½œä¸ºå­ç±»å®žä¾‹è¿”å›žä»£ç å®žçŽ°å­ç±»12345function Cat(name)&#123; var instance = new Animal(); instance.name = name || 'Tom'; return instance;&#125; ä¼˜ç¼ºç‚¹ä¸é™åˆ¶è°ƒç”¨æ–¹å¼,ä½†ä¸èƒ½å®žçŽ°å¤šç»§æ‰¿ æ‹·è´ç»§æ‰¿å°†çˆ¶ç±»çš„å±žæ€§å’Œæ–¹æ³•æ‹·è´ä¸€ä»½åˆ°å­ç±»ä¸­å­ç±»: 1234567function Cat(name)&#123; var animal = new Animal(); for(var p in animal)&#123; Cat.prototype[p] = animal[p]; &#125; Cat.prototype.name = name || 'Tom';&#125; ä¼˜ç¼ºç‚¹æ”¯æŒå¤šç»§æ‰¿,ä½†æ˜¯æ•ˆçŽ‡ä½Žå ç”¨å†…å­˜ ç»„åˆç»§æ‰¿é€šè¿‡è°ƒç”¨çˆ¶ç±»æž„é€ ï¼Œç»§æ‰¿çˆ¶ç±»çš„å±žæ€§å¹¶ä¿ç•™ä¼ å‚çš„ä¼˜ç‚¹ï¼Œç„¶åŽé€šè¿‡å°†çˆ¶ç±»å®žä¾‹ä½œä¸ºå­ç±»åŽŸåž‹ï¼Œå®žçŽ°å‡½æ•°å¤ç”¨å­ç±»:123456function Cat(name)&#123; Animal.call(this); this.name = name || 'Tom';&#125;Cat.prototype = new Animal();Cat.prototype.constructor = Cat; å¯„ç”Ÿç»„åˆç»§æ‰¿1234567891011function Cat(name)&#123; Animal.call(this); this.name = name || 'Tom';&#125;(function()&#123; // åˆ›å»ºä¸€ä¸ªæ²¡æœ‰å®žä¾‹æ–¹æ³•çš„ç±» var Super = function()&#123;&#125;; Super.prototype = Animal.prototype; //å°†å®žä¾‹ä½œä¸ºå­ç±»çš„åŽŸåž‹ Cat.prototype = new Super();&#125;)(); ES6çš„extendsç»§æ‰¿ES6 çš„ç»§æ‰¿æœºåˆ¶æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®žä¾‹å¯¹è±¡thisï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨superæ–¹æ³•ï¼‰ï¼Œç„¶åŽå†ç”¨å­ç±»çš„æž„é€ å‡½æ•°ä¿®æ”¹this,é“¾æŽ¥æè¿°12345678910class ColorPoint extends Point &#123; constructor(x, y, color) &#123; super(x, y); // è°ƒç”¨çˆ¶ç±»çš„constructor(x, y) this.color = color; &#125; toString() &#123; return this.color + ' ' + super.toString(); // è°ƒç”¨çˆ¶ç±»çš„toString() &#125;&#125; æ›´å¤šè¯¦æƒ…è¯·æˆ³:JSç»§æ‰¿çš„å®žçŽ°æ–¹å¼ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Interview</category>
      </categories>
      <tags>
        <tag>Interview</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React,Redux,React-redux]]></title>
    <url>%2F2018%2F04%2F15%2FReact%2FReact-Redux-React-redux%2F</url>
    <content type="text"><![CDATA[Reactreactä¸€äº›å°åž‹é¡¹ç›®ï¼Œåªä½¿ç”¨ React å®Œå…¨å¤Ÿç”¨äº†ï¼Œæ•°æ®ç®¡ç†ä½¿ç”¨propsã€stateå³å¯ï¼Œé‚£ä»€ä¹ˆæ—¶å€™éœ€è¦å¼•å…¥Reduxå‘¢ï¼Ÿ å½“æ¸²æŸ“ä¸€ä¸ªç»„ä»¶çš„æ•°æ®æ˜¯é€šè¿‡propsä»Žçˆ¶ç»„ä»¶ä¸­èŽ·å–æ—¶ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯A â€“&gt; Bï¼Œä½†éšç€ä¸šåŠ¡å¤æ‚åº¦çš„å¢žåŠ ï¼Œæœ‰å¯èƒ½æ˜¯è¿™æ ·çš„ï¼šA â€“&gt; B â€“&gt; C â€“&gt; D â€“&gt; Eï¼ŒEéœ€è¦çš„æ•°æ®éœ€è¦ä»ŽAé‚£é‡Œé€šè¿‡propsä¼ é€’è¿‡æ¥ï¼Œä»¥åŠå¯¹åº”çš„E â€“&gt; Aé€†å‘ä¼ é€’callbackã€‚ç»„ä»¶BCDæ˜¯ä¸éœ€è¦è¿™äº›æ•°æ®çš„ï¼Œä½†æ˜¯åˆå¿…é¡»ç»ç”±å®ƒä»¬æ¥ä¼ é€’ï¼Œè¿™ç¡®å®žæœ‰ç‚¹ä¸çˆ½ï¼Œè€Œä¸”ä¼ é€’çš„propsä»¥åŠcallbackå¯¹BCDç»„ä»¶çš„å¤ç”¨ä¹Ÿä¼šé€ æˆå½±å“ã€‚æˆ–è€…å…„å¼Ÿç»„ä»¶ä¹‹é—´æƒ³è¦å…±äº«æŸäº›æ•°æ®ï¼Œä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ä¼ é€’ã€èŽ·å–ç­‰ã€‚è¯¸å¦‚æ­¤ç±»çš„æƒ…å†µï¼Œå°±æœ‰å¿…è¦å¼•å…¥Redux`äº†ã€‚ å…¶å®ž A --&gt; B --&gt; C --&gt; D --&gt; E è¿™ç§æƒ…å†µï¼ŒReactä¸ä½¿ç”¨propså±‚å±‚ä¼ é€’ä¹Ÿæ˜¯èƒ½æ‹¿åˆ°æ•°æ®çš„ï¼Œä½¿ç”¨Contextå³å¯ã€‚åŽé¢è¦è®²åˆ°çš„react-reduxå°±æ˜¯é€šè¿‡Contextè®©å„ä¸ªå­ç»„ä»¶æ‹¿åˆ°storeä¸­çš„æ•°æ®çš„ã€‚ ReduxReduxå…¶å®žæˆ‘ä»¬åªæ˜¯æƒ³æ‰¾ä¸ªåœ°æ–¹å­˜æ”¾ä¸€äº›å…±äº«æ•°æ®è€Œå·²ï¼Œå¤§å®¶éƒ½å¯ä»¥èŽ·å–åˆ°ï¼Œä¹Ÿéƒ½å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œä»…æ­¤è€Œå·²ã€‚é‚£æ”¾åœ¨ä¸€ä¸ªå…¨éƒ¨å˜é‡é‡Œé¢è¡Œä¸è¡Œï¼Ÿè¡Œï¼Œå½“ç„¶è¡Œï¼Œä½†æ˜¯å¤ªä¸ä¼˜é›…ï¼Œä¹Ÿä¸å®‰å…¨ï¼Œå› ä¸ºæ˜¯å…¨å±€å˜é‡å˜›ï¼Œè°éƒ½èƒ½è®¿é—®ã€è°éƒ½èƒ½ä¿®æ”¹ï¼Œæœ‰å¯èƒ½ä¸€ä¸å°å¿ƒè¢«å“ªä¸ªå°ä¼™ä¼´è¦†ç›–äº†ä¹Ÿè¯´ä¸å®šã€‚é‚£å…¨å±€å˜é‡ä¸è¡Œå°±ç”¨ç§æœ‰å˜é‡å‘—ï¼Œç§æœ‰å˜é‡ã€ä¸èƒ½è½»æ˜“è¢«ä¿®æ”¹ï¼Œæ˜¯ä¸æ˜¯ç«‹é©¬å°±æƒ³åˆ°é—­åŒ…`äº†â€¦ çŽ°åœ¨è¦å†™è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå…¶æ»¡è¶³ï¼š å­˜æ”¾ä¸€ä¸ªæ•°æ®å¯¹è±¡ å¤–ç•Œèƒ½è®¿é—®åˆ°è¿™ä¸ªæ•°æ® å¤–ç•Œä¹Ÿèƒ½ä¿®æ”¹è¿™ä¸ªæ•°æ® å½“æ•°æ®æœ‰å˜åŒ–çš„æ—¶å€™ï¼Œé€šçŸ¥è®¢é˜…è€… 12345678910111213141516171819202122232425262728293031function createStore(reducer, initialState) &#123; // currentStateå°±æ˜¯é‚£ä¸ªæ•°æ® let currentState = initialState; let listener = () =&gt; &#123;&#125;; function getState() &#123; return currentState; &#125; function dispatch(action) &#123; currentState = reducer(currentState, action); // æ›´æ–°æ•°æ® listener(); // æ‰§è¡Œè®¢é˜…å‡½æ•° return action; &#125; function subscribe(newListener) &#123; listener = newListener; // å–æ¶ˆè®¢é˜…å‡½æ•° return function unsubscribe() &#123; listener = () =&gt; &#123;&#125;; &#125;; &#125; return &#123; getState, dispatch, subscribe &#125;;&#125;const store = createStore(reducer);store.getState(); // èŽ·å–æ•°æ®store.dispatch(&#123;type: 'ADD_TODO'&#125;); // æ›´æ–°æ•°æ®store.subscribe(() =&gt; &#123;/* update UI */&#125;); // æ³¨å†Œè®¢é˜…å‡½æ•° æ›´æ–°æ•°æ®æ‰§è¡Œçš„æ­¥éª¤ï¼š Whatï¼šæƒ³å¹²ä»€ä¹ˆ â€” dispatch(action) Howï¼šæ€Žä¹ˆå¹²ï¼Œå¹²çš„ç»“æžœ â€” reducer(oldState, action) =&gt; newState Then?ï¼šé‡æ–°æ‰§è¡Œè®¢é˜…å‡½æ•°ï¼ˆæ¯”å¦‚é‡æ–°æ¸²æŸ“UIç­‰ï¼‰ è¿™æ ·å°±å®žçŽ°äº†ä¸€ä¸ªstoreï¼Œæä¾›ä¸€ä¸ªæ•°æ®å­˜å‚¨ä¸­å¿ƒï¼Œå¯ä»¥ä¾›å¤–éƒ¨è®¿é—®ã€ä¿®æ”¹ç­‰ï¼Œè¿™å°±æ˜¯Reduxçš„ä¸»è¦æ€æƒ³ã€‚æ‰€ä»¥ï¼ŒReduxç¡®å®žå’ŒReactæ²¡æœ‰ä»€ä¹ˆæœ¬è´¨å…³ç³»ï¼ŒReduxå¯ä»¥ç»“åˆå…¶ä»–åº“æ­£å¸¸ä½¿ç”¨ã€‚åªä¸è¿‡Reduxè¿™ç§æ•°æ®ç®¡ç†æ–¹å¼ï¼Œè·ŸReactçš„æ•°æ®é©±åŠ¨è§†å›¾ç†å¿µå¾ˆåˆæ‹ï¼Œå®ƒä¿©ç»“åˆåœ¨ä¸€èµ·ï¼Œå¼€å‘éžå¸¸ä¾¿åˆ©ã€‚ çŽ°åœ¨æ—¢ç„¶æœ‰äº†ä¸€ä¸ªå®‰å…¨çš„åœ°æ–¹å­˜å–æ•°æ®ï¼Œæ€Žä¹ˆç»“åˆåˆ°Reacté‡Œé¢å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œåˆ›å»ºä¸€ä¸ªwindow.store = createStore(reducer)ï¼Œç„¶åŽåœ¨éœ€è¦çš„åœ°æ–¹é€šè¿‡store.getState()åŽ»èŽ·å–æ•°æ®ï¼Œé€šè¿‡store.dispatchåŽ»æ›´æ–°æ•°æ®ï¼Œé€šè¿‡store.subscribeåŽ»è®¢é˜…æ•°æ®å˜åŒ–ç„¶åŽè¿›è¡ŒsetState...å¦‚æžœå¾ˆå¤šåœ°æ–¹éƒ½è¿™æ ·åšä¸€éï¼Œå®žåœ¨æ˜¯ä¸å ªå…¶é‡ï¼Œè€Œä¸”ï¼Œè¿˜æ˜¯æ²¡æœ‰é¿å…æŽ‰å…¨å±€å˜é‡çš„ä¸ä¼˜é›…ã€‚ React-ReduxReact-Redux ç”±äºŽå…¨å±€å˜é‡æœ‰è¯¸å¤šçš„ç¼ºç‚¹ï¼Œé‚£å°±æ¢ä¸ªæ€è·¯ï¼ŒæŠŠstoreç›´æŽ¥é›†æˆåˆ°Reactåº”ç”¨çš„é¡¶å±‚propsé‡Œé¢ï¼Œåªè¦å„ä¸ªå­ç»„ä»¶èƒ½è®¿é—®åˆ°é¡¶å±‚propså°±è¡Œäº†ï¼Œæ¯”å¦‚è¿™æ ·ï¼š123&lt;TopWrapComponent store=&#123;store&#125;&gt; &lt;App /&gt;&lt;/TopWrapComponent&gt;, Reactæ°å¥½æä¾›äº†è¿™ä¹ˆä¸€ä¸ªé’©å­ï¼ŒContextï¼Œç”¨æ³•å¾ˆç®€å•ï¼Œçœ‹ä¸€ä¸‹å®˜æ–¹demoå°±æ˜Žäº†ã€‚çŽ°åœ¨å„ä¸ªå­ç»„ä»¶å·²ç»èƒ½å¤Ÿè½»æ˜“åœ°è®¿é—®åˆ°storeäº†ï¼ŒæŽ¥ä¸‹æ¥å°±æ˜¯å­ç»„ä»¶æŠŠstoreä¸­ç”¨åˆ°çš„æ•°æ®å–å‡ºæ¥ã€ä¿®æ”¹ã€ä»¥åŠè®¢é˜…æ›´æ–°UIç­‰ã€‚æ¯ä¸ªå­ç»„ä»¶éƒ½éœ€è¦è¿™æ ·åšä¸€éï¼Œæ˜¾ç„¶ï¼Œè‚¯å®šæœ‰æ›´ä¾¿åˆ©çš„æ–¹æ³•ï¼šé«˜é˜¶ç»„ä»¶ã€‚é€šè¿‡é«˜é˜¶ç»„ä»¶æŠŠstore.getState()ã€store.dispatchã€store.subscribeå°è£…èµ·æ¥ï¼Œå­ç»„ä»¶å¯¹storeå°±æ— æ„ŸçŸ¥äº†ï¼Œå­ç»„ä»¶æ­£å¸¸ä½¿ç”¨propsèŽ·å–æ•°æ®ä»¥åŠæ­£å¸¸ä½¿ç”¨callbackè§¦å‘å›žè°ƒï¼Œç›¸å½“äºŽæ²¡æœ‰storeå­˜åœ¨ä¸€æ ·ã€‚ 12345678910111213141516171819202122232425262728293031function connect(mapStateToProps, mapDispatchToProps) &#123; return function(WrappedComponent) &#123; class Connect extends React.Component &#123; componentDidMount() &#123; // ç»„ä»¶åŠ è½½å®ŒæˆåŽè®¢é˜…storeå˜åŒ–ï¼Œå¦‚æžœstoreæœ‰å˜åŒ–åˆ™æ›´æ–°UI this.unsubscribe = this.context.store.subscribe(this.handleStoreChange.bind(this)); &#125; componentWillUnmount() &#123; // ç»„ä»¶é”€æ¯åŽï¼Œå–æ¶ˆè®¢é˜…äº‹ä»¶ this.unsubscribe(); &#125; handleStoreChange() &#123; // æ›´æ–°UI this.forceUpdate(); &#125; render() &#123; return ( &lt;WrappedComponent &#123;...this.props&#125; &#123;...mapStateToProps(this.context.store.getState())&#125; // å‚æ•°æ˜¯storeé‡Œé¢çš„æ•°æ® &#123;...mapDispatchToProps(this.context.store.dispatch)&#125; // å‚æ•°æ˜¯store.dispatch /&gt; ); &#125; &#125; Connect.contextTypes = &#123; store: PropTypes.object &#125;; return Connect; &#125;;&#125; ä½¿ç”¨connectçš„æ—¶å€™ï¼Œæˆ‘ä»¬çŸ¥é“è¦å†™ä¸€äº›æ ·æ¿åŒ–çš„ä»£ç ï¼Œæ¯”å¦‚mapStateToPropsã€mapDispatchToPropsè¿™ä¸¤ä¸ªå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930const mapStateToProps = state =&gt; &#123; return &#123; count: state.count &#125;;&#125;;const mapDispatchToProps = dispatch =&gt; &#123; return &#123; dispatch &#125;;&#125;;export default connect(mapStateToProps, mapDispatchToProps)(Child);// ä¸Šè¿°ä»£ç æ‰§è¡Œä¹‹åŽï¼Œå¯ä»¥çœ‹åˆ°connectå‡½æ•°é‡Œé¢çš„ &lt;WrappedComponent &#123;...this.props&#125; &#123;...mapStateToProps(this.context.store.getState())&#125; &#123;...mapDispatchToProps(this.context.store.dispatch)&#125; /&gt;// å°±å˜æˆäº† &lt;WrappedComponent &#123;...this.props&#125; &#123;count: store.getState().count&#125; &#123;dispatch: store.dispatch&#125; /&gt;// è¿™æ ·ï¼Œå­ç»„ä»¶Childçš„propsé‡Œé¢å°±å¤šäº†countå’Œdispatchä¸¤ä¸ªå±žæ€§// countå¯ä»¥ç”¨æ¥æ¸²æŸ“UIï¼Œdispatchå¯ä»¥ç”¨æ¥è§¦å‘å›žè°ƒ Soï¼Œè¿™æ ·å°±OKäº†ï¼ŸOKäº†ã€‚é€šè¿‡ä¸€ä¸ªé—­åŒ…ç”Ÿæˆä¸€ä¸ªæ•°æ®ä¸­å¿ƒstoreï¼Œç„¶åŽæŠŠè¿™ä¸ªstoreç»‘å®šåˆ°Reactçš„é¡¶å±‚propsé‡Œé¢ï¼Œå­ç»„ä»¶é€šè¿‡HOCå»ºç«‹ä¸Žé¡¶å±‚props.storeçš„è”ç³»ï¼Œè¿›è€ŒèŽ·å–æ•°æ®ã€ä¿®æ”¹æ•°æ®ã€æ›´æ–°UIã€‚è¿™é‡Œä¸»è¦è®²äº†ä¸€ä¸‹ä¸‰è€…æ€Žä¹ˆçªœåœ¨ä¸€èµ·çš„ï¼Œå¦‚æžœæƒ³äº†è§£æ›´é«˜çº§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚reduxä¸­é—´ä»¶ã€reduceræ‹†åˆ†ã€connectçš„å…¶ä»–å‚æ•°ç­‰ï¼Œå¯ä»¥åŽ»çœ‹ä¸€ä¸‹å¯¹åº”çš„æºç ã€‚ åŽŸæ–‡é“¾æŽ¥ï¼š]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœ€å¼ºæ—¥æœŸæ­£åˆ™è¡¨è¾¾å¼]]></title>
    <url>%2F2018%2F04%2F14%2FJs%2F%E6%9C%80%E5%BC%BA%E6%97%A5%E6%9C%9F%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ç®€å•çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY/MM/DDï¼‰ï¼š1^\d&#123;4&#125;(\-|\/|\.)\d&#123;1,2&#125;\1\d&#123;1,2&#125;$ æ¼”åŒ–çš„æ—¥æœŸåˆ¤æ–­ï¼ˆYYYY/MM/DD| YY/MM/DDï¼‰1^(^(\d&#123;4&#125;|\d&#123;2&#125;)(\-|\/|\.)\d&#123;1,2&#125;\3\d&#123;1,2&#125;$)|(^\d&#123;4&#125;å¹´\d&#123;1,2&#125;æœˆ\d&#123;1,2&#125;æ—¥$)$ åŠ å…¥é—°å¹´çš„åˆ¤æ–­çš„ï¼šå®žä¾‹ï¼š 1^((((1[6-9]|[2-9]\d)\d&#123;2&#125;)-(0?[13578]|1[02])-(0?[1-9]|[12]\d|3[01]))|(((1[6-9]|[2-9]\d)\d&#123;2&#125;)-(0?[13456789]|1[012])-(0?[1-9]|[12]\d|30))|(((1[6-9]|[2-9]\d)\d&#123;2&#125;)-0?2-(0?[1-9]|1\d|2[0-8]))|(((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))-0?2-29-))$ åˆ†æžï¼š1ã€ä»€ä¹ˆæ˜¯åˆæ³•çš„æ—¥æœŸèŒƒå›´ï¼Ÿå¯¹äºŽä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œè¿™ä¸ªé—®é¢˜æœ‰ä¸åŒçš„è§£é‡Šã€‚è¿™é‡Œé‡‡çº³MSDNä¸­çš„çº¦å®šï¼šDateTimeå€¼ç±»åž‹è¡¨ç¤ºå€¼èŒƒå›´åœ¨å…¬å…ƒï¼ˆåŸºç£çºªå…ƒï¼‰0001 å¹´ 1 æœˆ 1 æ—¥åˆå¤œ 12:00:00 åˆ°å…¬å…ƒ (C.E.) 9999 å¹´ 12 æœˆ 31 æ—¥æ™šä¸Š 11:59:59 ä¹‹é—´çš„æ—¥æœŸå’Œæ—¶é—´ã€‚ 2ã€å…³äºŽé—°å¹´çš„é˜é‡Šã€‚å…³äºŽå…¬åŽ†é—°å¹´æ˜¯è¿™æ ·è§„å®šçš„ï¼šåœ°çƒç»•å¤ªé˜³å…¬è½¬ä¸€å‘¨å«åšä¸€å›žå½’å¹´ï¼Œä¸€å›žå½’å¹´é•¿365æ—¥5æ—¶48åˆ† 46ç§’ã€‚å› æ­¤ï¼Œå…¬åŽ†è§„å®šæœ‰å¹³å¹´å’Œé—°å¹´ï¼Œå¹³å¹´ä¸€å¹´æœ‰365æ—¥ï¼Œæ¯”å›žå½’å¹´çŸ­0.2422æ—¥ï¼Œå››å¹´å…±çŸ­0.9688æ—¥ï¼Œæ•…æ¯å››å¹´å¢žåŠ ä¸€æ—¥ï¼Œè¿™ä¸€å¹´æœ‰366æ—¥ï¼Œå°±æ˜¯é—°å¹´ã€‚ä½†å››å¹´å¢žåŠ ä¸€æ—¥æ¯”å››ä¸ªå›žå½’å¹´åˆå¤š0.0312æ—¥,400å¹´åŽå°†å¤š3.12æ—¥,æ•…åœ¨400å¹´ä¸­å°‘è®¾3ä¸ªé—°å¹´,ä¹Ÿå°±æ˜¯åœ¨400å¹´ä¸­åªè®¾97ä¸ªé—°å¹´ï¼Œè¿™æ ·å…¬åŽ†å¹´çš„å¹³å‡é•¿åº¦ä¸Žå›žå½’å¹´å°±ç›¸è¿‘ä¼¼äº†ã€‚ç”±æ­¤è§„å®šï¼šå¹´ä»½æ˜¯æ•´ç™¾æ•°çš„å¿…é¡»æ˜¯400çš„å€æ•°æ‰æ˜¯é—°å¹´ï¼Œä¾‹å¦‚1900å¹´ã€2100å¹´å°±ä¸æ˜¯é—°å¹´ã€‚ é¦–å…ˆéœ€è¦éªŒè¯å¹´ä»½ï¼Œæ˜¾ç„¶ï¼Œå¹´ä»½èŒƒå›´ä¸º 0001 - 9999ï¼ŒåŒ¹é…YYYYçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š 1[0-9]&#123;3&#125;[1-9]|[0-9]&#123;2&#125;[1-9][0-9]&#123;1&#125;|[0-9]&#123;1&#125;[1-9][0-9]&#123;2&#125;|[1-9][0-9]&#123;3&#125; å…¶ä¸­ [0-9] ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸º \dï¼Œä½† \d ä¸å¦‚ [0-9] ç›´è§‚ï¼Œå› æ­¤ä¸‹é¢æˆ‘å°†ä¸€ç›´é‡‡ç”¨ [0-9] ç”¨æ­£åˆ™è¡¨è¾¾å¼éªŒè¯æ—¥æœŸçš„éš¾ç‚¹æœ‰äºŒï¼šä¸€æ˜¯å¤§å°æœˆä»½çš„å¤©æ•°ä¸åŒï¼ŒäºŒæ˜¯é—°å¹´çš„è€ƒè™‘ã€‚ å¯¹äºŽç¬¬ä¸€ä¸ªéš¾ç‚¹ï¼Œæˆ‘ä»¬é¦–å…ˆä¸è€ƒè™‘é—°å¹´ï¼Œå‡è®¾2æœˆä»½éƒ½æ˜¯28å¤©ï¼Œè¿™æ ·ï¼Œæœˆä»½å’Œæ—¥æœŸå¯ä»¥åˆ†æˆä¸‰ç§æƒ…å†µï¼š1ã€æœˆä»½ä¸º 1, 3, 5, 7, 8, 10, 12ï¼Œå¤©æ•°èŒƒå›´ä¸º 01 - 31ï¼ŒåŒ¹é…MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š 1(0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]) 2ã€æœˆä»½ä¸º 4, 6, 9, 11ï¼Œå¤©æ•°èŒƒå›´ä¸º 01-30ï¼ŒåŒ¹é…MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š 1(0[469]|11)-(0[1-9]|[12][0-9]|30) 3ã€æœˆä»½ä¸º 2ï¼Œè€ƒè™‘å¹³å¹´æƒ…å†µï¼ŒåŒ¹é…MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š 102-(0[1-9]|[1][0-9]|2[0-8]) æ ¹æ®ä¸Šé¢çš„æˆæžœï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åŒ¹é…å¹³å¹´æ—¥æœŸæ ¼å¼ä¸ºYYYY-MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š 1([0-9]&#123;3&#125;[1-9]|[0-9]&#123;2&#125;[1-9][0-9]&#123;1&#125;|[0-9]&#123;1&#125;[1-9][0-9]&#123;2&#125;|[1-9][0-9]&#123;3&#125;)-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8]))) æŽ¥ç€æˆ‘ä»¬æ¥è§£å†³ç¬¬äºŒä¸ªéš¾ç‚¹ï¼šé—°å¹´çš„è€ƒè™‘ã€‚æ ¹æ®é—°å¹´çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†é—°å¹´åˆ†ä¸ºä¸¤ç±»ï¼š 1ã€èƒ½è¢«4æ•´é™¤ä½†ä¸èƒ½è¢«100æ•´é™¤çš„å¹´ä»½ã€‚å¯»æ‰¾åŽä¸¤ä½çš„å˜åŒ–è§„å¾‹ï¼Œå¯ä»¥å¾ˆå¿«å¾—åˆ°ä¸‹é¢çš„æ­£åˆ™åŒ¹é…ï¼š 1([0-9]&#123;2&#125;)(0[48]|[2468][048]|[13579][26]) 2ã€èƒ½è¢«400æ•´é™¤çš„å¹´ä»½ã€‚èƒ½è¢«400æ•´é™¤çš„æ•°è‚¯å®šèƒ½è¢«100æ•´é™¤ï¼Œå› æ­¤åŽä¸¤ä½è‚¯å®šæ˜¯00ï¼Œæˆ‘ä»¬åªè¦ä¿è¯å‰ä¸¤ä½èƒ½è¢«4æ•´é™¤å³å¯ï¼Œç›¸åº”çš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š 1(0[48]|[2468][048]|[3579][26])00 2.æœ€å¼ºéªŒè¯æ—¥æœŸçš„æ­£åˆ™è¡¨è¾¾å¼,æ·»åŠ äº†é—°å¹´çš„éªŒè¯ è¿™ä¸ªæ—¥æœŸæ­£åˆ™è¡¨è¾¾å¼æ”¯æŒYYYY-MM-DDYYYY/MM/DDYYYY_MM_DDYYYY.MM.DDçš„å½¢å¼ match : 2008-2-29 2008/02/29 not match : 2008-2-30 2007-2-29 å®Œæ•´çš„æ­£åˆ™è¡¨è¾¾å¼å¦‚ä¸‹1((^((1[8-9]\d&#123;2&#125;)|([2-9]\d&#123;3&#125;))([-\/\._])(10|12|0?[13578])([-\/\._])(3[01]|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d&#123;2&#125;)|([2-9]\d&#123;3&#125;))([-\/\._])(11|0?[469])([-\/\._])(30|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d&#123;2&#125;)|([2-9]\d&#123;3&#125;))([-\/\._])(0?2)([-\/\._])(2[0-8]|1[0-9]|0?[1-9])$)|(^([2468][048]00)([-\/\._])(0?2)([-\/\._])(29)$)|(^([3579][26]00)([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][0][48])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][0][48])([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][2468][048])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][2468][048])([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][13579][26])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][13579][26])([-\/\._])(0?2)([-\/\._])(29)$)) é—°å¹´çš„2æœˆä»½æœ‰29å¤©ï¼Œå› æ­¤åŒ¹é…é—°å¹´æ—¥æœŸæ ¼å¼ä¸ºYYYY-MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š 1(([0-9]&#123;2&#125;)(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00))-02-29 æœ€åŽï¼Œå°†å¹³å¹´å’Œé—°å¹´çš„æ—¥æœŸéªŒè¯è¡¨è¾¾å¼åˆå¹¶ï¼Œæˆ‘ä»¬å¾—åˆ°æœ€ç»ˆçš„éªŒè¯æ—¥æœŸæ ¼å¼ä¸ºYYYY-MM-DDçš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š 1([0-9]&#123;3&#125;[1-9]|[0-9]&#123;2&#125;[1-9][0-9]&#123;1&#125;|[0-9]&#123;1&#125;[1-9][0-9]&#123;2&#125;|[1-9][0-9]&#123;3&#125;)-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8]))))|((([0-9]&#123;2&#125;)(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00))-02-29) DD/MM/YYYYæ ¼å¼çš„æ­£åˆ™éªŒè¯è¡¨è¾¾å¼ä¸ºï¼š 1(((0[1-9]|[12][0-9]|3[01])/((0[13578]|1[02]))|((0[1-9]|[12][0-9]|30)/(0[469]|11))|(0[1-9]|[1][0-9]|2[0-8])/(02))/([0-9]&#123;3&#125;[1-9]|[0-9]&#123;2&#125;[1-9][0-9]&#123;1&#125;|[0-9]&#123;1&#125;[1-9][0-9]&#123;2&#125;|[1-9][0-9]&#123;3&#125;))|(29/02/(([0-9]&#123;2&#125;)(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00)))]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>æ­£åˆ™</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQuery ä¸Ž Zeptoçš„åŒºåˆ«]]></title>
    <url>%2F2018%2F04%2F13%2FJs%2FjQuery-%E4%B8%8E-Zepto%E7%9A%84%E5%8C%BA%E5%88%AB%2F</url>
    <content type="text"><![CDATA[jQuery çš„æ„ä¹‰æ˜¯åœ¨äºŽæŠ¹å¹³ DOMã€BOMã€CSSOM çš„å¤šæµè§ˆå™¨å·®å¼‚ï¼Œå¹¶ç»Ÿä¸€æä¾›æŽ¥å£ã€‚å®ƒä¸èƒ½å½“ä½œ Frameworkï¼ˆæ¡†æž¶ï¼‰è¢«ä½¿ç”¨ï¼Œè€Œæ˜¯æ‰®æ¼” Utilityï¼ˆå·¥å…·ï¼‰çš„è§’è‰²ã€‚ è™½ç„¶ Zepto å’Œ jQuery çš„ä¸­çš„å¾ˆå¤š API çš„ç”¨æ³•æ˜¯ç›¸ä¼¼çš„ï¼Œä½†ä»æœ‰ä¸€äº› API åœ¨ç”¨æ³•ä¸Šå·®å¼‚å¾ˆå¤§ã€‚ä¸‹é¢å°±å®žé™…ä½¿ç”¨ä¸­é‡åˆ°çš„åœºæ™¯åšä¸€ä¸‹åˆ—ä¸¾ã€‚ åˆ›å»ºDOMèŠ‚ç‚¹å¹¶èµ‹ä¸Žå±žæ€§ä½¿ç”¨ $ æ“ä½œç¬¦å¯ä»¥è½»æ¾åˆ›å»ºèŠ‚ç‚¹å¹¶èµ‹äºˆå±žæ€§ï¼Œå…·ä½“ä»£ç æ˜¯ $(htmlString, attributes) ï¼Œæ”¯æŒé“¾å¼å†™æ³•ã€‚å–œæ¬¢åˆ¨æ ¹é—®åº•çš„åŒå­¦å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„æ–‡æ¡£ã€‚ jquertæ–‡æ¡£zeptoæ–‡æ¡£ DOMæ“ä½œçš„åŒºåˆ«jqueryæ“ä½œulå…ƒç´ æ—¶å€™ï¼Œæ·»åŠ idä¸ä¼šç”Ÿæ•ˆ 12345678910(function($)&#123; $(function)&#123; var $list = $('&lt;ul&gt;&lt;li&gt;jQuery æ’å…¥&lt;/li&gt;&lt;/ul&gt;', &#123; id: 'insert-by-jquery' &#125;); $list.appendTo($('body')); &#125;&#125;)(window.jQuery)// Result// &lt;ul&gt;&lt;li&gt;jQuery æ’å…¥&lt;/li&gt;&lt;/ul&gt; zeptoæ“ä½œulå…ƒç´ æ—¶å€™ï¼Œæ·»åŠ idä¼šç”Ÿæ•ˆ 123456789zepto(function($)&#123; var $list = $('&lt;ul&gt;&lt;li&gt;jQuery æ’å…¥&lt;/li&gt;&lt;/ul&gt;', &#123; id: 'insert-by-jquery' &#125;); $list.appendTo($('body'));&#125;)// Result// &lt;ul id="insert-by-zepto"&gt;&lt;li&gt;Zepto æ’å…¥&lt;/li&gt;&lt;/ul&gt; äº‹ä»¶è§¦å‘çš„åŒºåˆ«jqueryæ—¶loadäº‹ä»¶çš„å¤„ç†å‡½æ•°ä¸ä¼šæ‰§è¡Œ1234567891011121314(function($) &#123; $(function() &#123; $script = $('&lt;script /&gt;', &#123; src: 'http://cdn.amazeui.org/amazeui/1.0.1/js/amazeui.js', id: 'ui-jquery' &#125;); $script.appendTo($('body')); $script.on('load', function() &#123; console.log('jQ script loaded');//æ²¡æœ‰æ‰“å°å‡º &#125;); &#125;);&#125;)(window.jQuery); ä½¿ç”¨ Zepto æ—¶ load äº‹ä»¶çš„å¤„ç†å‡½æ•°ä¼šæ‰§è¡Œ123456789101112Zepto(function($) &#123; $script = $('&lt;script /&gt;', &#123; src: 'http://cdn.amazeui.org/amazeui/1.0.1/js/amazeui.js', id: 'ui-zepto' &#125;); $script.appendTo($('body')); $script.on('load', function() &#123; console.log('zepto script loaded'); //zepto script loaded &#125;);&#125;); äº‹ä»¶å§”æ‰˜çš„åŒºåˆ«åœ¨ Zepto ä¸­ï¼Œå½“ a è¢«ç‚¹å‡»åŽï¼Œä¾æ¬¡å¼¹å‡ºäº†å†…å®¹ä¸ºâ€aäº‹ä»¶â€œå’Œâ€bäº‹ä»¶â€œçš„å¼¹å‡ºæ¡†ã€‚è¯´æ˜Žè™½ç„¶äº‹ä»¶å§”æ‰˜åœ¨.aä¸Šå¯æ˜¯å´ä¹Ÿè§¦å‘äº†.bä¸Šçš„å§”æ‰˜ã€‚ ä½†æ˜¯åœ¨ jQuery ä¸­åªä¼šè§¦å‘ .a ä¸Šé¢çš„å§”æ‰˜ã€‚12345678910111213var $doc = $(document);// Class 'a' bind event 'a'$doc.on('click', '.a', function () &#123; alert('aäº‹ä»¶'); // Class 'a' change to class 'b' $(this).removeClass('a').addClass('b');&#125;);// Class 'b' bind event 'b'$doc.on('click', '.b', function () &#123; alert('bäº‹ä»¶');&#125;); åŽŸç†åˆ†æž1234567891011// Zepto source code$.fn.on = function(event, selector, data, callback, one) &#123; var autoRemove, delegator, $this = this if (event &amp;&amp; !isString(event)) &#123; // Core code $.each(event, function (type, fn) &#123; $this.on(type, selector, data, fn, one) &#125;) return $this &#125; //...&#125; åœ¨ Zepto ä¸­ä»£ç è§£æžçš„æ—¶å€™ï¼Œdocumentä¸Šæ‰€æœ‰çš„clickå§”æ‰˜äº‹ä»¶éƒ½ä¾æ¬¡æ”¾å…¥åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç‚¹å‡»çš„æ—¶å€™å…ˆçœ‹å½“å‰å…ƒç´ æ˜¯ä¸æ˜¯.aï¼Œç¬¦åˆåˆ™æ‰§è¡Œï¼Œç„¶åŽæŸ¥çœ‹æ˜¯ä¸æ˜¯.bï¼Œç¬¦åˆåˆ™æ‰§è¡Œã€‚ è¿™æ ·çš„è¯ï¼Œå°±å¯¼è‡´å¦‚æžœ.açš„äº‹ä»¶åœ¨å‰é¢ï¼Œä¼šå…ˆæ‰§è¡Œ.aäº‹ä»¶ï¼Œç„¶åŽclassæ›´æ”¹æˆbï¼ŒZeptoå†æŸ¥çœ‹å½“å‰å…ƒç´ æ˜¯ä¸æ˜¯.bï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ åœ¨ jQuery ä¸­ä»£ç è§£æžçš„æ—¶å€™ï¼Œdocumentä¸Šå§”æ‰˜äº†2ä¸ªclickäº‹ä»¶ï¼Œç‚¹å‡»åŽé€šè¿‡é€‰æ‹©ç¬¦è¿›è¡ŒåŒ¹é…ï¼Œæ‰§è¡Œç›¸åº”å…ƒç´ çš„å§”æ‰˜äº‹ä»¶ã€‚ è¿™æ ·å°±å¾ˆå¥½çš„é¿å…äº†åœ¨ Zepto ä¸­çš„å‘ç”Ÿçš„æƒ…å†µã€‚ APIæ–¹é¢çš„åŒºåˆ«winth() å’Œ heightçš„åŒºåˆ« Zepto ç”±ç›’æ¨¡åž‹(box-sizing)å†³å®šï¼› jQuery ä¼šå¿½ç•¥ç›’æ¨¡åž‹ï¼Œå§‹ç»ˆè¿”å›žå†…å®¹åŒºåŸŸçš„å®½/é«˜(ä¸åŒ…å«paddingã€border)ã€‚ è§£å†³æ–¹å¼å°±æ˜¯ä½¿ç”¨ .css(&#39;width&#39;) è€Œä¸æ˜¯.width() ã€‚ä¸‹é¢æˆ‘ä»¬ä¸¾ä¸ªå«åšã€Šè¾¹æ¡†ä¸‰è§’å½¢å®½é«˜çš„èŽ·å–ã€‹çš„æ —å­æ¥è¯´æ˜Žè¿™ä¸ªé—®é¢˜ã€‚ é¦–å…ˆç”¨ä¸‹é¢çš„ HTML å’Œ CSS ç”»äº†ä¸€ä¸ªå°ä¸‰è§’å½¢å§ã€‚1234567891011// html&lt;div class="caret"&gt;&lt;/div&gt;// css.caret&#123; width:0; height:0; border-width: 0 20px 20px; border-color: transparent transparent blue; border-style: none dotted solid;&#125; jQuery ä½¿ç”¨ .width() å’Œ .css(â€˜widthâ€™) éƒ½è¿”å›ž ï¼Œé«˜åº¦ä¹Ÿä¸€æ ·ï¼› Zepto ä½¿ç”¨ .width() è¿”å›ž ï¼Œä½¿ç”¨ .css(â€˜widthâ€™) è¿”å›ž 0px ã€‚æ‰€ä»¥ï¼Œè¿™ç§åœºæ™¯ï¼ŒjQuery ä½¿ç”¨ .outerWidth() / .outerHeight() ï¼›Zepto ä½¿ç”¨ .width() / .height() ã€‚ offSet()çš„åŒºåˆ«1234567// offset() &#123;function&#125;// @desc Zepto// @return top|left|width|height// @desc jQuery// @return width|height èŽ·å–éšè—å…ƒç´ widthå’Œheightçš„åŒºåˆ«Zepto æ— æ³•èŽ·å–éšè—å…ƒç´ å®½é«˜ï¼ŒjQuery å¯ä»¥ã€‚ extend() çš„åŒºåˆ«jQuery åœ¨åŽŸåž‹ä¸Šæ‹“å±•æ–¹æ³•ä½¿ç”¨çš„æ–¹å¼æ˜¯ï¼š 123456789// For example// Extend a function named 'sayHello' to the protorype of jQuery(function($) &#123; $.fn.extend(&#123; sayHello: function() &#123; $(this).html('Hello !'); &#125; &#125;);&#125;)(window.jQuery); Zepto ä¸­å¹¶æ²¡æœ‰ä¸ºåŽŸåž‹å®šä¹‰extendæ–¹æ³•ï¼Œæ‰€ä»¥å¦‚æžœè¦æ˜¯è¦åœ¨ Zepto çš„åŽŸåž‹ä¸Šæ‹“å±•æ–¹æ³•å¯ä»¥ä½¿ç”¨çš„æ–¹å¼æ˜¯ï¼š 1234567// For example// Extend a function named 'sayHello' to the protorype of ZeptoZepto(function($) &#123; sayHello: function() &#123; $(this).html('Hello !'); &#125;&#125;); éšç€ jQuery 2.x çš„å‘å¸ƒä»¥åŠæœªæ¥ 3.0 å¯¹æµè§ˆå™¨æ”¯æŒçš„åˆ’åˆ†ï¼Œä¼¼ä¹Žæ‰¾ä¸åˆ°å†ä½¿ç”¨ Zepto çš„ç†ç”±äº†ã€‚å¦‚æžœä½ çœŸåœ¨ä¹Žæ–‡ä»¶å¤§å°ï¼Œé‚£ä½ å¯ä»¥è‡ªè¡Œæ‰“åŒ… jQuery ä¸­éœ€è¦çš„æ¨¡å—ã€‚è¿™å’Œ Zepto æ˜¯ä¸€æ ·çš„ï¼ŒZepto å®˜æ–¹æä¾›çš„ç‰ˆæœ¬åªæ‰“åŒ…äº†å¾ˆåŸºç¡€çš„æ¨¡å—ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Es6ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹---è¿›é˜¶ç¯‡]]></title>
    <url>%2F2018%2F04%2F12%2FJs%2FEs6%E4%BD%A0%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B-%E8%BF%9B%E9%98%B6%E7%AF%87%2F</url>
    <content type="text"><![CDATA[æ­£æ–‡Moduleæ¨¡å—åŒ–æ˜¯ä¸€ä¸ªè¿›è¡Œå¾ˆä¹…çš„è¯é¢˜ï¼Œå‘å±•åŽ†ç¨‹ä¸­å‡ºçŽ°è¿‡å¾ˆå¤šæ¨¡å¼ï¼Œä¾‹å¦‚AMD,CommonJSç­‰ç­‰ã€‚ Moduleæ˜¯ES6çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œæ˜¯è¯­è¨€å±‚é¢å¯¹æ¨¡å—åŒ–çš„æ”¯æŒã€‚ ä¸Žä¹‹å‰æ¨¡å—åŠ è½½æœºåˆ¶ä¸åŒï¼ŒModuleæ˜¯åŠ¨æ€åŠ è½½ï¼Œå¯¼å…¥çš„å˜é‡çš„åªè¯»å¼•ç”¨ï¼Œè€Œä¸æ˜¯æ‹·è´ã€‚ 123456789101112131415161718192021222324// 1. export default å¯ä»¥åšé»˜è®¤å¯¼å‡º// a.jsexport default 5; // é»˜è®¤å¯¼å‡º// b.jsimport b, &#123;a&#125; from './a.js'; // é»˜è®¤å¯¼å…¥ï¼Œä¸éœ€è¦åŠ èŠ±æ‹¬å·// 2. åŠ¨æ€çš„åŠ è½½æœºåˆ¶// a.jsexport let a = 10;export let b = 10;export function add() &#123; a = 15; b = 20; return a+b;&#125;;// b.jsimport &#123;a, b, add&#125; from './a.js';a+b; // 20add(); // 35a+b; // 35 Symbolsymbolæ˜¯es6çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œä»–æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š 1.symbolæ˜¯â€œæ–°â€çš„åŸºæœ¬æ•°æ®ç±»åž‹ï¼Œä»Žes6å¼€å§‹åŸºæœ¬æ•°æ®ç±»åž‹å˜æˆäº†6ä¸ªï¼Œundefind,null,number,boolean,string,symbol2.symbolå¯ä»¥ç”¨ä½œobjectçš„key3.symbolå­˜åœ¨å…¨å±€ä½œç”¨åŸŸï¼Œåˆ©ç”¨Symbol.for(key)æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»º(å…¨å±€ä½œç”¨åŸŸæ— æŒ‡å®šé”®)æˆ–èŽ·å–å…¨å±€ä½œç”¨åŸŸçš„symbolï¼›åˆ©ç”¨symbol.keyFor(sym)å¯ä»¥èŽ·å–æŒ‡å®šçš„symbolçš„å€¼4.Javascriptå†…éƒ¨ä½¿ç”¨äº†å¾ˆå¤šå†…ç½®symbolå€¼ï¼Œä½œä¸ºç‰¹æ®Šçš„é”®ï¼Œæ¥å®žçŽ°ä¸€äº›å†…éƒ¨åŠŸèƒ½ï¼›ä¾‹å¦‚ï¼šsymbol.iteratorç”¨äºŽæ ‡ç¤ºå¯¹è±¡çš„è¿­ä»£å™¨ â€œæ–°â€ ä»…ä»…æ˜¯é’ˆå¯¹å‰ç«¯å¼€å‘äººå‘˜æ¥è¯´çš„ï¼Œå…¶å®ž Symbol æ¦‚å¿µæœ¬èº«å·²ç»åœ¨ JavaScript è¯­è¨€å†…éƒ¨é•¿æ—¶é—´ä½¿ç”¨äº†12345678910111213141516// 1. "Symbol(desc)" æ–¹æ³•ç”¨äºŽåˆ›å»ºä¸€ä¸ªæ–°çš„ symbolï¼Œå‚æ•° "desc" ä»…ç”¨åš symbol çš„æè¿°ï¼Œå¹¶ä¸ç”¨äºŽå”¯ä¸€æ ‡ç¤º symbolSymbol('abc') === Symbol('abc'); // falseï¼Œ'abc'ä»…ä½œä¸ºä¸¤ä¸ª symbol çš„æè¿°ä¿¡æ¯// 2. "Symbol.for(key)" æ–¹æ³•ï¼Œå‚æ•° "key" æ˜¯ç”¨äºŽåœ¨å…¨å±€ä½œç”¨åŸŸä¸­æ ‡ç¤º symbol çš„å”¯ä¸€é”®ï¼ŒåŒæ—¶ä¹Ÿä½œä¸ºè¯¥ symbol çš„æè¿°ä¿¡æ¯Symbol.for('abc') === Symbol('abc'); //true å·¦ä¾§ä¸ºåˆ›å»ºï¼Œå³ä¾§ä¸ºèŽ·å–Symbol.for('abc') === Symbol('abc'); //false// 3. symbol æ— æ³•è¢« for...in éåŽ†åˆ° (ä¸å¯æžšä¸¾)ï¼Œå¯ä»¥åˆ©ç”¨ Object.getOwnPropertySymbols èŽ·å–const obj = &#123; [Symbol('abc')]:'abc', 'abc':'abc'&#125;;for(let i in obj)&#123; console.log(i);//abc&#125;Object.getOwnPropertySymbols(obj);//[Symbol(abc)] Iterator + for â€¦ofES6 ä¸­é™¤äº†æ–°ç‰¹æ€§å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–°çš„è§„èŒƒï¼Œé‚£å°±æ˜¯å…³äºŽè¿­ä»£çš„è§„èŒƒï¼Œä»–åŒ…æ‹¬ä¸¤éƒ¨åˆ†åˆ†åˆ«æ˜¯ â€œå¯è¿­ä»£è§„èŒƒï¼ˆiterable protocolï¼‰â€ å’Œ â€œè¿­ä»£å™¨è§„èŒƒï¼ˆiterator protocolï¼‰â€ã€‚ä»»ä½•å®žçŽ°äº†å‰è€…çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥è¿›è¡Œ forâ€¦of å¾ªçŽ¯ã€‚ String,Map,Set,Arrayç­‰æ˜¯åŽŸç”Ÿå¯è¿­ä»£å¯¹è±¡ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯åœ¨åŽŸåž‹(prototype)å¯¹è±¡ä¸­å®žçŽ°äº†Symbol.iteratoré”®å¯¹åº”çš„æ–¹æ³•ã€‚ forâ€¦ofæ˜¯å¯¹å¯¹è±¡è¿­ä»£å™¨çš„éåŽ†ï¼ˆé”®å’Œå€¼éƒ½å¯ä»¥éåŽ†ï¼‰ï¼Œè€Œforâ€¦inæ˜¯å¯¹è±¡å¯æžšä¸¾å€¼çš„éåŽ† ä¸‹é¢ç”¨ä»£ç æ¥è§£é‡Šä¸€ä¸‹ä¸¤ä¸ªè§„èŒƒï¼š1234567891011121314151617181920212223242526//1.è¿­ä»£å™¨è§„èŒƒconst iter = &#123; conter:0, next()&#123; // è¿­ä»£å™¨æ˜¯å®žçŽ°äº† "next()" å‡½æ•°çš„å¯¹è±¡ if(++this.conter &lt; 10)&#123; return&#123; // è¿”å›žä¸€ä¸ªå«æœ‰ä¸¤ä¸ªé”®å€¼å¯¹çš„å¯¹è±¡ï¼ŒObject &#123;done =&gt; boolean, value =&gt; any&#125; done:false, value:this.conter &#125; &#125;else&#123; this.conter = 0; return &#123; // done = true æ—¶ï¼Œvalueéžå¿…é¡» done : true; &#125; &#125; &#125;&#125;// 2. å¯è¿­ä»£è§„èŒƒï¼Œå®žçŽ° "Symbol.iterator =&gt; func()" é”®å€¼å¯¹ï¼›è€Œ "func()" è¿”å›žä¸€ä¸ª è¿­ä»£å™¨å¯¹è±¡const iterObj = &#123;&#125;;for(let i of iterObj)&#123;&#125;;iterObj[Symbol.iterator] = function()&#123; return iter;&#125;for(let i of iterObj)&#123; console.log(i);//1,2,3,4,5,6,7,8,9&#125; å…³äºŽé›†åˆåŽŸæ¥æˆ‘ä»¬ä½¿ç”¨é›†åˆï¼Œå¤šæ•°æƒ…å†µä¸‹ä¼šç›´æŽ¥ç”¨ Object ä»£æ›¿ï¼ŒES6æ–°å¢žäº†ä¸¤ä¸ªç‰¹æ€§ï¼ŒMap å’Œ Setï¼Œä»–ä»¬æ˜¯å¯¹ JavaScript å…³äºŽé›†åˆæ¦‚å¿µçš„è¡¥å……ã€‚ Mapä¸ºä»€ä¹ˆè¦æœ‰Mapè¿™ç§æ•°æ®ç»“æž„ï¼Ÿç›´æŽ¥ä½¿ç”¨Objectä¸å¥½å—ï¼Ÿæ˜¯ä¸æ˜¯å®Œå…¨å¯ä»¥ä½¿ç”¨Mapå–ä»£objectç”¨äºŽæ•°æ®å­˜å–ï¼Ÿ Mapå’ŒObjectçš„åŒºåˆ«ï¼Ÿ1.Mapå’ŒObjectéƒ½å¯ä»¥ç”¨ä½œæ•°æ®å­˜å–ï¼ŒMapé€‚ç”¨äºŽå­˜å–éœ€è¦å¸¸éœ€è¦å˜åŒ–(å¢žå‡é”®å€¼å¯¹)æˆ–éåŽ†çš„æ•°å‰§é›†ï¼Œè€ŒObjecté€‚ç”¨äºŽå­˜å–é™æ€ï¼ˆä¾‹å¦‚é…ç½®ä¿¡æ¯ï¼‰çš„æ•°æ®é›†2.Objectçš„keyå¿…é¡»æ˜¯Stringæˆ–è€…symbolç±»åž‹ï¼Œè€ŒMapå´æ— æ­¤é™åˆ¶ï¼Œå¯ä»¥æ˜¯ä»»ä½•å€¼3.Mapå¯ä»¥å¾ˆæ–¹ä¾¿çš„å–åˆ°é”®å¯¹å€¼çš„æ•°é‡ï¼Œè€ŒObjectåˆ™éœ€è¦ç”¨é¢å¤–é€”å¾„ SetSetä½œä¸ºæœ€ç®€å•çš„é›†åˆï¼Œæœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š 1.Setå¯ä»¥å­˜å‚¨ä»»ä½•ç±»åž‹çš„å€¼ï¼ŒéåŽ†é¡ºåºä¸Žæ’å…¥é¡ºåºç›¸åŒ 2.Setå†…æ— é‡å¤å€¼ 12345// 1. Set çš„æž„é€ å‡½æ•°å¯ä»¥ä¼ å…¥ä¸€ä¸ª â€œå¯è¿­ä»£çš„å¯¹è±¡ï¼ˆä¾‹å¦‚æ•°ç»„ï¼‰â€ï¼Œå…¶ä¸­åŒ…å«ä»»æ„å€¼const first = new Set(['a', 1, &#123;'b': 1&#125;, null]); // Set &#123;"a", 1, Object &#123;b: 1&#125;, null&#125;// 2. Set æ— æ³•æ’å…¥é‡å¤çš„å€¼first.add(1); // Set &#123;"a", 1, Object &#123;b: 1&#125;, null&#125; WeakMap + WeakSetWeakMap ä¸Ž WeakSet ä½œä¸ºä¸€ä¸ªæ¯”è¾ƒæ–°é¢–çš„æ¦‚å¿µï¼Œå…¶ä¸»è¦ç‰¹ç‚¹åœ¨äºŽå¼±å¼•ç”¨ã€‚ ç›¸æ¯”äºŽ Map ä¸Ž Set çš„å¼ºå¼•ç”¨ï¼Œå¼±å¼•ç”¨å¯ä»¥ä»¤å¯¹è±¡åœ¨ â€œé€‚å½“â€ æƒ…å†µä¸‹æ­£ç¡®è¢« GC å›žæ”¶ï¼Œå‡å°‘å†…å­˜èµ„æºæµªè´¹ã€‚ ä½†ç”±äºŽä¸æ˜¯å¼ºå¼•ç”¨ï¼Œæ‰€ä»¥æ— æ³•è¿›è¡ŒéåŽ†æˆ–å–å¾—å€¼æ•°é‡ï¼Œåªèƒ½ç”¨äºŽå€¼çš„å­˜å–ï¼ˆWeakMapï¼‰æˆ–æ˜¯å¦å­˜åœ¨å€¼å¾—åˆ¤æ–­ï¼ˆWeakSetï¼‰ åœ¨å¼±å¼•ç”¨çš„æƒ…å†µä¸‹ï¼ŒGC å›žæ”¶æ—¶ï¼Œä¸ä¼šæŠŠå…¶è§†ä½œä¸€ä¸ªå¼•ç”¨ï¼›å¦‚æžœæ²¡æœ‰å…¶ä»–å¼ºå¼•ç”¨å­˜åœ¨ï¼Œé‚£è¿™ä¸ªå¯¹è±¡å°†è¢«å›žæ”¶ 123456789101112// 1. WeakMap é”®å¿…é¡»æ˜¯å¯¹è±¡const err = new WeakMap([['a',1]]); // TypeError: Invalid value used as weak map key// 2. WeakMap/WeakSet çš„å¼±å¼•ç”¨const wm = new WeakMap([[&#123;'a':1&#125;,1]]); // Object &#123;'a': 1&#125; ä¼šæ­£å¸¸è¢« GC å›žæ”¶const ws = new WeakSet(); ws.add(&#123;'a':1&#125;); // Object &#123;'a': 1&#125; ä¼šæ­£å¸¸è¢« GC å›žæ”¶const obj = &#123;'b': 1&#125;;ws.add(obj); // Object &#123;'b': 1&#125; ä¸ä¼šè¢«æ­£å¸¸ GC å›žæ”¶ï¼Œå› ä¸ºå­˜åœ¨ä¸€ä¸ªå¼ºå¼•ç”¨obj = undefined; // Object &#123;'b': 1&#125; ä¼šæ­£å¸¸è¢« GC å›žæ”¶ å¼‚æ­¥ç¼–ç¨‹åœ¨ ES6 ä¹‹å‰ï¼ŒJavaScript çš„å¼‚æ­¥ç¼–ç¨‹éƒ½è·³ä¸å‡ºå›žè°ƒå‡½æ•°è¿™ä¸ªæ–¹å¼ã€‚å›žè°ƒå‡½æ•°æ–¹å¼ä½¿ç”¨éžå¸¸ç®€å•ï¼Œåœ¨ç®€å•å¼‚æ­¥ä»»åŠ¡è°ƒç”¨æ—¶å€™æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†å¦‚æžœå‡ºçŽ°å¤æ‚çš„å¼‚æ­¥ä»»åŠ¡åœºæ™¯æ—¶ï¼Œå°±æ˜¾å¾—åŠ›ä¸ä»Žå¿ƒäº†ï¼Œæœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯å¤šå±‚å›žè°ƒå‡½æ•°çš„åµŒå¥—ä¼šå¯¼è‡´ä»£ç çš„æ¨ªå‘å‘å±•ï¼Œéš¾ä»¥ç»´æŠ¤ï¼›ES6 å¸¦æ¥äº†ä¸¤ä¸ªæ–°ç‰¹æ€§æ¥è§£å†³å¼‚æ­¥ç¼–ç¨‹çš„éš¾é¢˜ã€‚1234567891011121314151617// ä¸€ä¸ªç®€å•çš„å¤šå±‚åµŒå¥—å›žè°ƒå‡½æ•°çš„ä¾‹å­ (Node.js)const git = require('shell').git;const commitMsg = '...';git.add('pattern/for/some/files/*', (err) =&gt; &#123; if(!err)&#123; git.commit(commitMsg, (err) =&gt; &#123; if(!err)&#123; git.push(pushOption); &#125;else&#123; console.log(err); &#125; &#125;); &#125;else&#123; console.log(err); &#125;&#125;); PromisePromiseæ˜¯ES6çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œtaä»–æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š 1.æœ¬è´¨è¿˜æ˜¯å›žè°ƒå‡½æ•°2.åŒºåˆ†æˆåŠŸå’Œå¤±è´¥çš„å›žè°ƒï¼ŒçœåŽ»åµŒå¥—åœ¨å†…å±‚çš„åˆ¤æ–­é€»è¾‘3.å¯ä»¥å¾ˆè½»æ¾çš„å®Œæˆå›žè°ƒå‡½æ•°æ¨¡å¼åˆ°promiseæ¨¡å¼çš„è½¬åŒ–4.ä»£ç ç”±å›žè°ƒå‡½æ•°åµŒå¥—çš„æ¨ªå‘æ‰©å±•ï¼Œå˜ä¸ºé“¾å¼è°ƒç”¨çš„çºµå‘æ‰©å±•ï¼Œä¾¿äºŽç¼–ç¨‹å’Œç»´æŠ¤ promise è™½ç„¶ä¼˜åŠ¿é¢‡å¤šï¼Œä½†æ˜¯ä»£ç ç»“æž„ä»ä¸ŽåŒæ­¥ä»£ç åŒºåˆ«è¾ƒå¤§ 1234567891011// ä¸Šä¾‹ç”¨ Promise å®žçŽ°// å‡å®š git.add, git.commit, git.push å‡åšäº† Promise å°è£…ï¼Œè¿”å›žä¸€ä¸ª Promise å¯¹è±¡const git = require('shell').git;const commitMsg = '...';git.add('pattern/for/some/files/*') .then(() =&gt; git.commit(commitMsg)) .then(git.push) .catch((err) =&gt; &#123; console.log(err); &#125;); generatorGenerator ä½œä¸º ES6 çš„æ–°ç‰¹æ€§ï¼Œæ˜¯ä¸€ä¸ªè¯­è¨€å±‚é¢çš„å‡çº§ã€‚å®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š1.å¯ä»¥ä½¿ç”¨yieldå…³é”®å­—ï¼Œç»ˆæ­¢æ‰§è¡Œè¿”å›žï¼ˆå†…åˆ°å¤–ï¼‰2.å¯ä»¥é€šè¿‡next(val)æ–¹æ³•è°ƒç”¨é‡æ–°å”¤é†’ï¼Œç»§ç»­æ‰§è¡Œï¼ˆå¤–å›žå†…ï¼‰3.è¿è¡Œæ—¶ï¼ˆåŒ…æ‹¬æŒ‚èµ·æ€ï¼‰ï¼Œå…±äº«å±€éƒ¨å˜é‡4.Generator æ‰§è¡Œä¼šè¿”å›žä¸€ä¸ªç»“æžœå¯¹è±¡ï¼Œç»“æžœå¯¹è±¡æœ¬èº«æ—¢æ˜¯è¿­ä»£å™¨ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¯è¿­ä»£å¯¹è±¡ï¼ˆåŒæ—¶æ»¡è¶³ä¸¤ä¸ªè¿­ä»£è§„èŒƒï¼‰ï¼Œæ‰€ä»¥ Generator å¯ä»¥ç›´æŽ¥ç”¨äºŽ è‡ªå®šä¹‰å¯¹è±¡è¿­ä»£å™¨ ç”±äºŽå…·å¤‡ä»¥ä¸Šç‰¹ç‚¹ï¼ˆç¬¬å››ç‚¹é™¤å¤–ï¼‰ï¼ŒGenerator ä¹Ÿæ˜¯ JavaScript å¯¹ åç¨‹ï¼ˆcoroutineï¼‰çš„å®žçŽ°ï¼Œåç¨‹å¯ä»¥ç†è§£ä¸º â€œå¯ç”±å¼€å‘äººå‘˜æŽ§åˆ¶è°ƒåº¦çš„å¤šçº¿ç¨‹â€ åç¨‹æŒ‰ç…§è°ƒåº¦æœºåˆ¶æ¥åŒºåˆ†ï¼Œå¯ä»¥åˆ†ä¸ºå¯¹ç§°å¼å’Œéžå¯¹ç§°å¼ éžå¯¹ç§°å¼ï¼šè¢«è°ƒç”¨è€…ï¼ˆåç¨‹ï¼‰æŒ‚èµ·æ—¶ï¼Œå¿…é¡»å°†æŽ§åˆ¶æƒè¿”è¿˜è°ƒç”¨è€…ï¼ˆåç¨‹ï¼‰ å¯¹ç§°å¼ï¼šè¢«è°ƒç”¨è€…ï¼ˆåç¨‹ï¼‰æŒ‚èµ·æ—¶ï¼Œå¯å°†æŽ§åˆ¶æƒè½¬ç»™ â€œä»»æ„â€ å…¶ä»–åç¨‹ JavaScript å®žçŽ°çš„æ˜¯ éžå¯¹ç§°å¼åç¨‹ï¼ˆsemi-coroutineï¼‰ï¼›éžå¯¹ç§°å¼åç¨‹ç›¸æ¯”äºŽå¯¹ç§°å¼åç¨‹ï¼Œä»£ç é€»è¾‘æ›´æ¸…æ™°ï¼Œæ˜“äºŽç†è§£å’Œç»´æŠ¤ åç¨‹ç»™ JavaScript æä¾›äº†ä¸€ä¸ªæ–°çš„æ–¹å¼åŽ»å®Œæˆå¼‚æ­¥ç¼–ç¨‹ï¼›ç”±äºŽ Generator çš„æ‰§è¡Œä¼šè¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼Œéœ€è¦æ‰‹åŠ¨åŽ»éåŽ†ï¼Œæ‰€ä»¥å¦‚æžœè¦è¾¾åˆ°è‡ªåŠ¨æ‰§è¡Œçš„ç›®çš„ï¼Œé™¤äº†æœ¬èº«è¯­æ³•å¤–ï¼Œè¿˜éœ€è¦å®žçŽ°ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œä¾‹å¦‚ TJ å¤§ç¥žçš„ co æ¡†æž¶ã€‚ 1234567891011121314// ä¸Šä¾‹ç”¨ Generator å®žçŽ°// å‡å®š git.add, git.commit, git.push å‡åšäº† Promise å°è£…ï¼Œè¿”å›žä¸€ä¸ª Promise å¯¹è±¡const co = require('co');const git = require('shell').git;co(function* ()&#123; const commitMsg = '...'; // å…±äº«çš„å±€éƒ¨å˜é‡ yield git.add('pattern/for/some/files/*'); yield git.commit(commitMsg); yield git.push();&#125;).catch((err) =&gt; &#123; console.log(err);&#125;); Generator æ˜¯ä¸€ä¸ª ES6 æœ€ä½³çš„å¼‚æ­¥ç¼–ç¨‹é€‰æ‹©ä¹ˆï¼Ÿæ˜¾ç„¶ä¸æ˜¯ï¼Œå› ä¸ºé™¤äº†åŸºæœ¬è¯­æ³•å¤–ï¼Œæˆ‘ä»¬è¿˜è¦é¢å¤–åŽ»å®žçŽ°æ‰§è¡Œå™¨æ¥è¾¾åˆ°æ‰§è¡Œçš„ç›®çš„ï¼Œä½†æ˜¯å®ƒæ•´ä½“çš„ä»£ç ç»“æž„æ˜¯ä¼˜äºŽå›žè°ƒå‡½æ•°åµŒå¥—å’Œ Promise æ¨¡å¼çš„ã€‚ Async-Awaitè¿™å¹¶ä¸æ˜¯ä¸€ä¸ª ES6 æ–°ç‰¹æ€§ï¼Œè€Œæ˜¯ ES7 çš„è¯­æ³•ï¼Œæ”¾åœ¨è¿™é‡Œæ˜¯å› ä¸ºå®ƒå°†æ˜¯ JavaScript ç›®å‰æ”¯æŒå¼‚æ­¥ç¼–ç¨‹æœ€å¥½çš„æ–¹å¼12345678910111213// ä¸Šä¾‹ç”¨ async-await å®žçŽ°// å‡å®š git.add, git.commit, git.push å‡åšäº† Promise å°è£…ï¼Œè¿”å›žä¸€ä¸ª Promise å¯¹è±¡const git = require('shell').git;(async function()&#123; const commitMsg = ''; //å…±äº«å±€éƒ¨å˜é‡ try()&#123; await git.add('pattern/for/some/files/*'); await git.commit(commitMsg); await git.push(); &#125;catch(err)&#123; console.log(err); &#125;&#125;)() å…ƒç¼–ç¨‹å…ƒç¼–ç¨‹æ˜¯æŒ‡çš„æ˜¯å¼€å‘äººå‘˜å¯¹ â€œè¯­è¨€æœ¬èº«è¿›è¡Œç¼–ç¨‹â€ã€‚ä¸€èˆ¬æ˜¯ç¼–ç¨‹è¯­è¨€æš´éœ²äº†ä¸€äº› APIï¼Œä¾›å¼€å‘äººå‘˜æ¥æ“ä½œè¯­è¨€æœ¬èº«çš„æŸäº›ç‰¹æ€§ã€‚ES6 ä¸¤ä¸ªæ–°ç‰¹æ€§ Proxy å’Œ Reflect æ˜¯ JavaScript å…³äºŽå¯¹è±¡å…ƒç¼–ç¨‹èƒ½åŠ›çš„æ‰©å±•ã€‚ proxyProxy æ˜¯ ES6 åŠ å…¥çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œå®ƒå¯ä»¥ â€œä»£ç†â€ å¯¹è±¡çš„åŽŸç”Ÿè¡Œä¸ºï¼Œæ›¿æ¢ä¸ºæ‰§è¡Œè‡ªå®šä¹‰è¡Œä¸ºã€‚ è¿™æ ·çš„å…ƒç¼–ç¨‹èƒ½åŠ›ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ›´è½»æ¾çš„æ‰©å±•å‡ºä¸€äº›ç‰¹æ®Šå¯¹è±¡ã€‚ ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥è¢«â€œä»£ç†â€ åˆ©ç”¨ Proxy.revocable(target, handler) å¯ä»¥åˆ›å»ºå‡ºä¸€ä¸ªå¯é€†çš„ â€œè¢«ä»£ç†â€ å¯¹è±¡ 1234567891011121314151617181920212223242526// ç®€å• element é€‰æ‹©æŽ§åˆ¶å·¥å…·çš„å®žçŽ°const cacheElement = function(target, prop) &#123; if(target.hasOwnProperty(prop))&#123; return target[prop]; &#125;else&#123; return target[prop] = document.getElementById(prop); &#125;&#125;const elControl = new Proxy(cacheElement, &#123; get: (target, prop) =&gt; &#123; return cacheElement(target, prop); &#125;, set: (target, prop, val) =&gt; &#123; cacheElement(target, prop).textContent = val; &#125;, apply: (target, thisArg, args) =&gt; &#123; return Reflect.ownKeys(target); &#125;&#125;);elControl.first; // div#firstelControl.second; // div#secondelControl.first = 5; // div#first =&gt; 5elControl.second = 10; // div#second =&gt; 10elControl(); // ['first', 'second'] ReflectES6 ä¸­å¼•å…¥çš„ Reflect æ˜¯å¦ä¸€ä¸ªå…ƒç¼–ç¨‹çš„ç‰¹æ€§ï¼Œå®ƒä½¿å¾—æˆ‘ä»¬å¯ä»¥ç›´æŽ¥æ“çºµå¯¹è±¡çš„åŽŸç”Ÿè¡Œä¸ºã€‚Reflect å¯æ“çºµçš„è¡Œä¸ºä¸Ž Proxy å¯ä»£ç†çš„è¡Œä¸ºæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œè¿™ä½¿å¾—å¯ä»¥åœ¨ Proxy çš„è‡ªå®šä¹‰æ–¹æ³•ä¸­æ–¹ä¾¿çš„ä½¿ç”¨ Reflect è°ƒèµ·åŽŸç”Ÿè¡Œä¸º1234567891011121314151617181920212223// 1. Proxy çš„è‡ªå®šä¹‰æ–¹æ³•ä¸­ï¼Œé€šè¿‡ Reflect è°ƒç”¨åŽŸç”Ÿè¡Œä¸ºconst customProxy = new Proxy(&#123; 'custom': 1&#125;, &#123; get: (target, prop) =&gt; &#123; console.log(`get $&#123;prop&#125; !`); return Reflect.get(target, undefined, prop); &#125;&#125;);customProxy.custom; // get custom, 1// 2. ä¸Ž Object å¯¹è±¡ä¸Šå·²ç»å¼€æ”¾çš„æ“ä½œåŽŸç”Ÿè¡Œä¸ºæ–¹æ³•ç›¸æ¯”ï¼Œè¯­æ³•æ›´åŠ æ¸…æ™°æ˜“ç”¨ï¼ˆä¾‹å¦‚ï¼šObject.hasOwnProperty ä¸Ž Reflect.hasï¼‰const symb = Symbol('b');const a = &#123; [symb]: 1, 'b': 2&#125;;if(Reflect.has(a, symb) &amp;&amp; Reflect.has(a, 'b'))&#123; // good console.log('good');&#125;Reflect.ownKeys(a); // ["b", Symbol(b)] è¿›é˜¶é˜…è¯»å¦‚æžœä½ å…³æ³¨å…¼å®¹æ€§ï¼ŒæŽ¨èçœ‹ï¼šhttps://kangax.github.io/compat-table/es6/ï¼Œè¿™é‡Œä»‹ç»äº†ä»Ž ES5 åˆ° ES2016+ çš„æ‰€æœ‰ç‰¹æ€§ï¼ˆåŒ…æ‹¬ä»æœªå®šç¨¿çš„ç‰¹æ€§ï¼‰åŠå…¶åœ¨å„çŽ¯å¢ƒçš„å…¼å®¹æ€§ å¦‚æžœä½ å…³æ³¨æ€§èƒ½ï¼ŒæŽ¨èçœ‹ï¼šhttp://kpdecker.github.io/six-speed/ï¼Œè¿™é‡Œé€šè¿‡æ€§èƒ½æµ‹è¯•ï¼Œå°† ES6 ç‰¹æ€§çš„åŽŸç”Ÿå®žçŽ°ä¸Ž ES5 polyfill ç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”ï¼Œè¦†ç›–äº†å„ä¸»æµçŽ¯å¢ƒï¼›åŒæ—¶ä¹Ÿå¯ä»¥ä¾§é¢å¯¹æ¯”å‡ºå„çŽ¯å¢ƒåœ¨åŽŸç”Ÿå®žçŽ°ä¸Šçš„æ€§èƒ½ä¼˜åŠ£ å¦‚æžœä½ æƒ³å…¨é¢äº†è§£ç‰¹æ€§ï¼ŒæŽ¨èçœ‹ï¼šhttps://developer.mozilla.org/en-US/docs/Web/JavaScriptï¼Œè¦†ç›–ç‰¹æ€§çš„å„æ–¹é¢ï¼ŒåŒ…æ‹¬å…¨é¢çš„ APIï¼ˆåŒ…æ‹¬ä¸æŽ¨èå’ŒåºŸå¼ƒçš„ï¼‰å’ŒåŸºç¡€ç”¨æ³• å¦‚æžœä½ æƒ³çœ‹ç‰¹æ€§æ›´å¤šçš„ä½¿ç”¨ç¤ºä¾‹å’Œå¯¹åº”çš„ polyfill å®žçŽ°ï¼ŒæŽ¨èçœ‹ï¼šhttp://es6-features.org/#Constantsï¼Œè¿™é‡Œå¯¹å„ä¸ªç‰¹æ€§éƒ½ç»™å‡ºäº†ä½¿ç”¨ä¸°å¯Œçš„ä¾‹å­å’Œä¸€ä¸ª polyfill å®žçŽ°ï¼Œç®€å•æ˜Žäº† å¦‚æžœæƒ³äº†è§£ ECMA Script æœ€å¤šæœ€å…¨é¢çš„ç»†èŠ‚ï¼Œè‹±è¯­åˆæ¯”è¾ƒè¿‡ç¡¬ï¼ŒæŽ¨èåœ¨éœ€è¦æ—¶çœ‹ï¼šhttp://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdfï¼Œï¼ˆæˆ–è€…ç›´æŽ¥çœ‹æœ€æ–°çš„ï¼šhttps://tc39.github.io/ecma262/ï¼‰ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Es6ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹---åŸºç¡€ç¯‡]]></title>
    <url>%2F2018%2F04%2F11%2FJs%2FEs6%E4%BD%A0%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B-%E5%9F%BA%E7%A1%80%E7%AF%87%2F</url>
    <content type="text"><![CDATA[ES6ï¼Œæˆ–è®¸åº”è¯¥å« ES2015ï¼ˆ2015 å¹´ 6 æœˆæ­£å¼å‘å¸ƒï¼‰ï¼Œå¯¹äºŽå¤§å¤šæ•°å‰ç«¯åŒå­¦éƒ½ä¸é™Œç”Ÿã€‚ æ­£æ–‡let + constè¿™ä¸ªå¤§æ¦‚æ˜¯å¼€å§‹äº†è§£ ES6 åŽï¼Œæˆ‘ä»¬ç¬¬ä¸€ä¸ªæ„Ÿè§‰è‡ªå·±å®Œå…¨æ˜Žç™½å¹¶å…´è‡´å‹ƒå‹ƒçš„å¼€å§‹ä½¿ç”¨çš„ç‰¹æ€§ã€‚12345678910111213141516// å®šä¹‰å¸¸é‡const REG_GET_INPUT = /^\d&#123;1,3&#125;$/;// å®šä¹‰é…ç½®é¡¹let config = &#123; isDev : false, pubDir: './admin/'&#125;// å¼•å…¥ gulplet gulp = require('gulp');// å¼•å…¥gulpç›¸å…³æ’ä»¶let concat = require('gulp-concat');let uglify = require('gulp-uglify');let cssnano = require('gulp-cssnano'); å¾ˆå¤šäººçœ‹å®Œæ¦‚å¿µä¹‹åŽï¼Œç¬¬ä¸€å°è±¡éƒ½æ˜¯ï¼šâ€œconst æ˜¯è¡¨ç¤ºä¸å¯å˜çš„å€¼ï¼Œè€Œ let åˆ™æ˜¯ç”¨æ¥æ›¿æ¢åŽŸæ¥çš„ var çš„ã€‚â€ æ‰€ä»¥å°±ä¼šå‡ºçŽ°ä¸Šé¢ä»£ç ä¸­çš„æ ·å­ï¼›ä¸€æ®µä»£ç ä¸­å‡ºçŽ°å¤§é‡çš„ letï¼Œåªæœ‰éƒ¨åˆ†å¸¸é‡ç”¨ const åŽ»åšå®šä¹‰ï¼Œè¿™æ ·çš„ä½¿ç”¨æ–¹å¼æ˜¯é”™è¯¯çš„ã€‚ ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹const çš„å®šä¹‰æ˜¯ä¸å¯é‡æ–°èµ‹å€¼çš„å€¼ï¼Œä¸Žä¸å¯å˜çš„å€¼(immutable value)ä¸åŒï¼›const å®šä¹‰çš„ Objectï¼Œåœ¨å®šä¹‰ä¹‹åŽä»å¯ä»¥ä¿®æ”¹å…¶å±žæ€§ã€‚ æ‰€ä»¥å…¶å®žä»–çš„ä½¿ç”¨åœºæ™¯å¾ˆå¹¿ï¼ŒåŒ…æ‹¬å¸¸é‡ã€é…ç½®é¡¹ä»¥åŠå¼•ç”¨çš„ç»„ä»¶ã€å®šä¹‰çš„ â€œå¤§éƒ¨åˆ†â€ ä¸­é—´å˜é‡ç­‰ï¼Œéƒ½åº”è¯¥ä»¥conståšå®šä¹‰ã€‚åä¹‹å°± let è€Œè¨€ï¼Œä»–çš„ä½¿ç”¨åœºæ™¯åº”è¯¥æ˜¯ç›¸å¯¹è¾ƒå°‘çš„ï¼Œæˆ‘ä»¬åªä¼šåœ¨ loop(forï¼Œwhile å¾ªçŽ¯)åŠå°‘é‡å¿…é¡»é‡å®šä¹‰çš„å˜é‡ä¸Šç”¨åˆ°ä»–ã€‚ çŒœæƒ³ï¼šå°±æ‰§è¡Œæ•ˆçŽ‡è€Œè¨€ï¼ŒConstç”±äºŽä¸å¯é‡æ–°èµ‹å€¼ï¼Œæ‰€ä»¥å¯ä»¥åšæ›´å¤šè¯­æ³•é™æ€åˆ†æžæ–¹é¢çš„ä¼˜åŒ–ï¼Œä»Žè€Œæœ‰æ›´é«˜çš„æ‰§è¡Œæ•ˆçŽ‡ æ‰€ä»¥ä¸Šé¢ä»£ç ä¸­ï¼Œæ‰€æœ‰ä½¿ç”¨ let çš„éƒ¨åˆ†ï¼Œå…¶å®žéƒ½åº”è¯¥æ˜¯ç”¨ const çš„ã€‚ Template Stringsï¼ˆå­—ç¬¦ä¸²æ¨¡æ¿ï¼‰å­—ç¬¦ä¸²æ¨¡æ¿æ˜¯æˆ‘åˆšæŽ¥è§¦ES6æ—¶æœ€å–œæ¬¢çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œä»–è¯­æ³•ç®€æ´ï¼Œè¯­ä¹‰æ˜Žç¡®ï¼Œè€Œä¸”å¾ˆå¥½çš„è§£å†³äº†ä¹‹å‰å­—ç¬¦ä¸²æ‹¼æŽ¥éº»çƒ¦çš„é—®é¢˜æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»–çš„ä¸€èˆ¬ä½¿ç”¨åœºæ™¯ï¼š123456789101112const start = 'hi all';const getName = () =&gt; &#123; return 'jelly';&#125;;const conf = &#123; fav: 'Coding'&#125;;// æ¨¡æ¿const msg = `$&#123;start&#125;, my name is $&#123;getName()&#125;, $&#123;conf.fav&#125; is my favourite`; ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹12345678910111213141516// 1. ä¸Žå¼•å·æ··ç”¨const wantToSay = `I'm a "tbfed"`;// 2. æ”¯æŒå¤šè¡Œæ–‡æœ¬const slogan = `I have a dream today!`;// æ¯”è¾ƒé€‚åˆå†™HTMLconst resultTpl = ` &lt;section&gt; &lt;div&gt;...&lt;/div&gt; &lt;/section&gt;`; Enhanced Object Literalsï¼ˆå¢žå¼ºçš„å¯¹è±¡å­—é¢é‡ï¼‰å¢žå¼ºçš„å¯¹è±¡å­—é¢é‡æ˜¯ ES6 ä¸­çš„å‡åŽåŠŸèƒ½ï¼Œä»–è®¾è®¡äº†å¾ˆå¤šç®€å†™ï¼Œè¿™äº›ç®€å†™ä¸ä½†ä¿ç•™äº†æ˜Žç¡®çš„è¯­ä¹‰ï¼Œè¿˜å‡å°‘äº†æˆ‘ä»¬å¤šä½™çš„ä»£ç é‡ã€‚ å½“ä»–çš„ä½¿ç”¨æˆä¸ºä¸€ä¸ªä¹ æƒ¯æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è‡ªå·±ä»£ç å˜å¾—æ›´ä¸ºä¼˜é›…ã€‚ ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹12345678910111213141516171819const _bookNum = 4;const basicConfig = &#123; level: 5&#125;const config = &#123; // ç›´æŽ¥æŒ‡å®šåŽŸåž‹å¯¹è±¡ __proto__: basicConfig, // å±žæ€§ç®€å†™ ç›¸å½“äºŽ_bookNum:_bookNum _bookNum, // æ–¹æ³•ç®€å†™ //ç›¸å½“äºŽ getBookNum:function()&#123;..&#125; getBookNum() &#123; return this.bookNum; &#125;&#125; Arrows and Lexical Thisï¼ˆç®­å¤´å‡½æ•°ï¼‰ç®­å¤´å‡½æ•°æ˜¯ES6ä¸­çš„ä¸€ä¸ªæ–°çš„è¯­æ³•ç‰¹æ€§ï¼Œä»–çš„ç”¨æ³•ç®€å•ï¼Œå½¢æ€ä¼˜é›…ï¼Œå¤‡å—äººä»¬é’çã€‚å¤§å¤šæ•°åŒå­¦åˆè¯†è¿™ä¸ªç‰¹æ€§æ—¶ï¼Œæ›´å¤šçš„ä»…ä»…ç”¨å®ƒä½œä¸ºå‡½æ•°å®šä¹‰çš„ç®€å†™ï¼Œè¿™å…¶å®žå°±æœ‰äº›å±ˆæ‰äº†ã€‚ 12345678910111213141516171819202122232425262728293031// æœªä½¿ç”¨ç®­å¤´å‡½æ•°çš„å†™æ³•&#123; ... addOptions: function (options) &#123; var self = this; options.forEach(function(name, opts)&#123; self[name] = self.addChild(name, opts); &#125;); &#125; &#125;// ä½¿ç”¨ç®­å¤´å‡½æ•°åŽçš„å†™æ³•&#123; ... addOptions: function (options) &#123; options.forEach((name, opts) =&gt; &#123; this[name] = this.addChild(name, opts); &#125;); &#125; &#125; å¯ä»¥æ³¨æ„åˆ°ä¸Šä¸‹ä¸¤æ®µä»£ç çš„åŒºåˆ«ã€‚ åœ¨æœªä½¿ç”¨ç®­å¤´å‡½æ•°å‰ï¼Œæˆ‘ä»¬åœ¨è¿‡ç¨‹å‡½æ•°ä¸­ä½¿ç”¨çˆ¶çº§ thisï¼Œéœ€è¦å°†å…¶æ˜¾å¼ç¼“å­˜åˆ°å¦ä¸€ä¸ªä¸­é—´å˜é‡ä¸­ï¼Œå› ä¸ºè¿‡ç¨‹å‡½æ•°æœ‰ç‹¬ç«‹çš„ this å˜é‡ï¼Œä¼šè¦†ç›–çˆ¶çº§ï¼›ä½¿ç”¨ç®­å¤´å‡½æ•°åŽï¼Œä¸ä½†ç®€å†™äº†ä¸€ä¸ªè¿‡ç¨‹å‡½æ•°ï¼ˆ forEach çš„å‚æ•°ï¼‰ï¼Œè¿˜çœç•¥æŽ‰äº† this çš„ä¸­é—´å˜é‡çš„å®šä¹‰ã€‚ åŽŸå› ï¼šç®­å¤´å‡½æ•°æ²¡æœ‰ç‹¬ç«‹æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆ this ï¼‰ï¼Œæ‰€ä»¥å…¶å†…éƒ¨å¼•ç”¨ this å¯¹è±¡ä¼šç›´æŽ¥è®¿é—®çˆ¶çº§ã€‚ å½“ç„¶ï¼Œä»Žè¿™å—æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œç®­å¤´å‡½æ•°æ˜¯æ— æ³•æ›¿ä»£å…¨éƒ¨ function çš„ä½¿ç”¨åœºæ™¯çš„ï¼Œä¾‹å¦‚æˆ‘ä»¬éœ€è¦æœ‰ç‹¬ç«‹ this çš„å‡½æ•°ã€‚ ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹ ç®­å¤´å‡½æ•°ä¸ä½†æ²¡æœ‰ç‹¬ç«‹çš„thisï¼Œä»–ä¹Ÿæ²¡æœ‰ç‹¬ç«‹çš„argumentsï¼Œæ‰€ä»¥å¦‚æžœéœ€è¦å–ä¸å®šå‚çš„æ—¶å€™ï¼Œè¦ä¹ˆä½¿ç”¨ functionï¼Œè¦ä¹ˆç”¨ ES6 çš„å¦ä¸€ä¸ªæ–°ç‰¹æ€§ restï¼ˆå…·ä½“åœ¨ rest ä¸­ä¼šæœ‰è¯¦è§£ï¼‰ã€‚ ç®­å¤´å‡½æ•°è¯­æ³•å¾ˆçµæ´»ï¼Œåœ¨åªæœ‰ä¸€ä¸ªå‚æ•°æˆ–è€…åªæœ‰ä¸€å¥è¡¨è¾¾å¼åšæ–¹æ³•ä½“æ—¶ï¼Œå¯ä»¥çœç•¥ç›¸åº”æ‹¬å·ã€‚ 123456789101112131415// å®Œæ•´å†™æ³•const getOptions = (name, key) =&gt; &#123; ...&#125;// çœç•¥å‚æ•°æ‹¬å·const getOptions = key =&gt; &#123; ... &#125;// çœç•¥å‚æ•°å’Œæ–¹æ³•ä½“æ‹¬å·const getOptions = key =&gt; console.log(key);// æ— å‚æ•°æˆ–æ–¹æ³•ä½“ï¼Œæ‹¬å·ä¸èƒ½çœç•¥const noop = () =&gt; &#123;&#125;; æœ‰ä¸ªç®€å•å°æ —å­ï¼Œè¿™ä¸€çµæ´»çš„è¯­æ³•åœ¨å†™è¿žç»­çš„Promiseé“¾å¼è°ƒç”¨æ—¶ï¼Œå¯ä»¥ä½¿ä»£ç æ›´åŠ ä¼˜é›… 1234567891011gitPromise .then(() =&gt; git.add()) .then(() =&gt; git.commit()) .then(() =&gt; git.log()) .then((msg) =&gt; &#123; ... &#125;) .then(() =&gt; git.push()) .catch((err) =&gt; &#123; utils.error(err); &#125;); Destructuringï¼ˆè§£æž„ï¼‰è§£æž„è¿™ä¸ªç‰¹æ€§å¯ä»¥ç®€å•è§£è¯»ä¸ºåˆ†åˆ«å®šä¹‰ï¼Œç”¨äºŽä¸€æ¬¡å®šä¹‰å¤šä¸ªå˜é‡ï¼Œå¸¸å¸¸ç”¨äºŽåˆ†è§£æ–¹æ³•è¿”å›žå¯¹è±¡ä¸ºå¤šä¸ªå˜é‡ï¼Œåˆ†åˆ«ä½¿ç”¨ã€‚ä½¿ç”¨è¿‡ES6çš„åŒå­¦åº”è¯¥æˆ–å¤šæˆ–å°‘æŽ¥è§¦è¿‡è¿™ä¸ªç‰¹æ€§ï¼Œä½†æ˜¯ä½ å¯èƒ½ä¸çŸ¥é“å®ƒå¦‚ä¸‹å‡ ä¸ªç”¨æ³•ï¼š ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹12345678910111213const bookSet = ['UED', 'TB fed', 'Not find'];const bookCollection = () =&gt; &#123; return &#123;book1: 'UED', book2: 'TB fed'&#125;;&#125;;// 1. è§£æž„ä¹Ÿå¯ä»¥è®¾ç½®é»˜è®¤å€¼const &#123;book1, book3 = 'Not find'&#125; = bookCollection();// 2. è§£æž„æ•°ç»„æ—¶å€™æ˜¯å¯ä»¥è·³è¿‡å…¶ä¸­æŸå‡ é¡¹çš„const [book1,,book3] = bookSet; // book1 = 'UED', book3 = 'Not find'// 3. è§£æž„å¯ä»¥å–åˆ°æŒ‡å®šå¯¹è±¡çš„ä»»ä½•å±žæ€§ï¼ŒåŒ…æ‹¬å®ƒåŒ…å«çš„æ–¹æ³•const &#123;length: setLength&#125; = bookSet; // setLength = 3 Rest + SpreadRest å’Œ Spread ä¸»è¦æ˜¯åº”ç”¨ ... è¿ç®—ç¬¦ï¼Œå®Œæˆå€¼çš„èšåˆå’Œåˆ†è§£ã€‚ ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹1234567891011121314151617// 1. rest å¾—åˆ°çš„æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„è€Œä¸æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„const getOptions = function(...args)&#123; console.log(args.join); // function&#125;;// 2. rest å¯ä»¥é…åˆç®­å¤´å‡½æ•°ä½¿ç”¨ï¼Œè¾¾åˆ°å–å¾—æ‰€æœ‰å‚æ•°çš„ç›®çš„const getOptions = (...args) =&gt; &#123; console.log(args); // array&#125;;// 3. spread å¯ä»¥ç”¨äºŽè§£æž„æ—¶ï¼Œèšåˆæ‰€å¾—çš„å€¼const [opt1, ...opts] = ['one', 'two', 'three', 'four'];// 4. spread å¯ä»¥ç”¨äºŽæ•°ç»„å®šä¹‰const opts = ['one', 'two', 'three', 'four'];const config = ['other', ...opts]; ClassesES6 ä¸­å®žçŽ°çš„ä¸€ä¸ªè¯­æ³•ç³–ï¼Œç”¨äºŽç®€åŒ–åŸºäºŽåŽŸåž‹é›†æˆå®žçŽ°ç±»å®šä¹‰çš„åœºæ™¯ã€‚è™½ç„¶æœ‰å¾ˆå¤šäººä¸å¤ªå–œæ¬¢è¿™ä¸ªç‰¹æ€§ï¼Œè®¤ä¸ºå®ƒä½œä¸ºä¸€ä¸ªç®€å•å¢žå¼ºæ‰©å±•ï¼Œå¹¶æ²¡æœ‰å…¶ä»–è¯­è¨€ class åº”æœ‰çš„ç‰¹ç‚¹ã€‚ä½†æ˜¯å°±æˆ‘è‡ªå·±è§‚ç‚¹æ¥çœ‹ï¼Œè¿˜æ˜¯æ„Ÿè§‰è¿™æ ·ä¸€ç§å†™æ³•ç¡®å®žæ¯”åŽŸæœ‰çš„åŽŸåž‹ç»§æ‰¿çš„å†™æ³•è¯­ä¹‰æ›´æ¸…æ™°ã€æ˜Žç¡®ï¼Œè€Œä¸”è¯­æ³•æ›´ç®€å•ã€‚ åŒæ ·ï¼Œå¯èƒ½æœ‰äº›ç”¨æ³•æ˜¯ä½ ä¹‹å‰å®¹æ˜“å¿½ç•¥æŽ‰çš„ï¼Œåœ¨æ­¤åšä¸ªè¡¥å……ã€‚ ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹12345678910111213141516171819202122// 1. é™æ€å˜é‡// ES6 çš„ç±»å®šä¹‰å®žçŽ°äº†é™æ€æ–¹æ³•çš„å®šä¹‰ï¼Œä½†é™æ€å˜é‡å‘¢ï¼Ÿ// å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼å®žçŽ°:class TbFedMembers&#123; static get HuaChen()&#123; return 'jelly'; &#125;&#125;TbFedMembers.HuaChen; // "åŒ–è¾°"// 2. ç§æœ‰å±žæ€§ï¼ˆç§æœ‰å±žæ€§æœ‰å¤šç§å®žçŽ°æ–¹å¼ï¼Œåªè°ˆåŠå…¶ä¸­ä¸€ç§ï¼‰// é—­åŒ…const TbFedMembers = (() =&gt; &#123; const HuaChen = 'jelly'; return class&#123; getOneMemberName()&#123; return HuaChen; &#125; &#125;;&#125;)(); PromisesPromise ä¸åªæ˜¯ä¸€ä¸ªå¯¹è±¡ã€ä¸€ä¸ªè¯­æ³•ï¼Œä»–æ›´æ˜¯ä¸€ç§å¼‚æ­¥ç¼–ç¨‹æ–¹å¼çš„å˜åŒ–ç›¸ä¿¡ä½¿ç”¨è¿‡ ES6 çš„åŒå­¦éƒ½å·²ç»å¼€å§‹å°è¯•äº† Promiseï¼Œç”šè‡³åœ¨ä¸æ”¯æŒES6çš„æ—¶å€™ï¼Œå·²ç»å¼€å§‹ä½¿ç”¨ä¸€äº›åŸºäºŽ Promise æ€æƒ³çš„å¼€æºæ¡†æž¶ã€‚ é‚£ä¹ˆæˆ‘ä»¬ä¹‹å‰ç”¨ Promise ç©¶ç«Ÿç”¨çš„å¯¹ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆéœ€è¦æ³¨æ„çš„ç‚¹å‘¢ï¼Ÿ ä½ å¯èƒ½ä¸çŸ¥é“çš„äº‹12345678910111213141516171819202122232425262728293031323334// 1. å¤šä¸ªå¼‚æ­¥ä»»åŠ¡åŒæ—¶æ‰§è¡Œç”¨ Promise.allï¼Œé¡ºåºæ‰§è¡Œä½¿ç”¨é“¾å¼è°ƒç”¨// Promise.allPromise .all([jsBuildPromise, cssBuildPromise]) .then(() =&gt; &#123; ... &#125;);// chainjsBuildPromise .then(() =&gt; cssBuildPromise) .then(() =&gt; &#123; ... &#125;);// 2. Promise çš„é“¾å¼è°ƒç”¨éœ€è¦æ¯ä¸€ä¸ªè¿‡ç¨‹è¿”å›žä¸€ä¸ª Promise å¯¹è±¡æ‰èƒ½ä¿è¯é¡ºåºæ‰§è¡ŒgitPromise .then(() =&gt; git.add()) // æ­£ç¡®ï¼Œç®­å¤´å‡½æ•°ç®€å†™ .then(() =&gt; &#123; git.commit(); // é”™è¯¯ï¼Œå‡½æ•°è¿”å›ž undefinedï¼Œä¼šç«‹å³æ‰§è¡Œä¸‹ä¸€è¿‡ç¨‹ &#125;) .then(() =&gt; &#123; return git.log(); // æ­£ç¡® &#125;);// 3. Promise éœ€è¦è°ƒç”¨ catch æ–¹æ³•æ¥æ•èŽ·é”™è¯¯ï¼Œè€Œä¸”è¿‡ç¨‹å†…çš„é”™è¯¯ä¸ä¼šé˜»å¡žåŽç»­ä»£ç æ‰§è¡Œnew Promise(() =&gt; &#123; f; // not define error !&#125;).catch((err) =&gt; &#123; console.log(err) // show 'f is not define'&#125;);console.log('error test'); // æ­¤è¡Œå¯ä»¥è¢«æ­£å¸¸æ‰§è¡Œ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸå’Œæ‰§è¡Œä¸Šä¸‹æ–‡]]></title>
    <url>%2F2018%2F04%2F09%2FJs%2F%E4%BB%80%E4%B9%88%E6%98%AF%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%2F</url>
    <content type="text"><![CDATA[ä½œç”¨åŸŸé¦–å…ˆæˆ‘ä»¬è¯´ä¸‹ä½œç”¨åŸŸï¼Œç®€å•åœ°æ¥è¯´ä½œç”¨åŸŸæŒ‡çš„æ˜¯ä¸€ä¸ªåŒºåŸŸï¼Œé‡Œé¢åŒ…æ‹¬å˜é‡ï¼Œå‡½æ•°ï¼Œå¸¸é‡ç­‰ç­‰å®šä¹‰ä¿¡æ¯å’Œèµ‹å€¼ä¿¡æ¯ï¼Œä»¥åŠè¿™ä¸ªåŒºåŸŸå†…ä»£ç ä¹¦å†™çš„ç»“æž„ä¿¡æ¯ã€‚ä½œç”¨åŸŸå¯ä»¥åµŒå¥—ï¼Œæˆ‘ä»¬é€šå¸¸çŸ¥é“jså‡½æ•°å†…æ˜¯å¯ä»¥äº§ç”Ÿä½œç”¨åŸŸçš„ã€‚ä¸‹é¢æˆ‘ä»¬ç”¨å…·ä½“ä»£ç æ¥ç¤ºä¾‹ä¸‹ï¼š å…¨å±€ä½œç”¨åŸŸï¼ˆglobal scopeï¼‰é‡Œé¢å®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªå‡½æ•°ã€‚walk å‡½æ•°ç”Ÿæˆçš„ä½œç”¨åŸŸé‡Œé¢å®šä¹‰äº†ä¸€ä¸ªå˜é‡ï¼Œä¸¤ä¸ªå‡½æ•°ã€‚innerFunc å’Œ anotherInnerFunc è¿™ä¸¤ä¸ªå‡½æ•°ç”Ÿæˆçš„ä½œç”¨åŸŸé‡Œé¢åˆ†åˆ«å®šä¹‰äº†ä¸€ä¸ªå˜é‡ã€‚åœ¨è§„èŒƒä¸­ä½œç”¨åŸŸæ›´å®˜æ–¹çš„å«æ³•æ˜¯è¯æ³•çŽ¯å¢ƒï¼ˆLexical Environmentsï¼‰ã€‚ä»€ä¹ˆæ„æ€ï¼Ÿå°±æ˜¯ä½œç”¨åŸŸåŒ…å«å“ªäº›å†…å®¹å–å†³äºŽä½ ä»£ç æ€Žä¹ˆå†™ï¼Œä½ æŠŠå®šä¹‰ go å˜é‡å†™åœ¨äº† walk å‡½æ•°é‡Œé¢ï¼Œé‚£ä¹ˆ go å˜é‡å°±å±žäºŽwalk å‡½æ•°ä½œç”¨åŸŸã€‚ ä½œç”¨åŸŸå…¶å®žç”±ä¸¤éƒ¨åˆ†ç»„æˆ(å…¨å±€ä½œç”¨åŸŸï¼Œå±€éƒ¨ä½œç”¨åŸŸ)1.è®°å½•ä½œç”¨åŸŸå†…å˜é‡ä¿¡æ¯ï¼ˆæˆ‘ä»¬å‡è®¾å˜é‡ï¼Œå¸¸é‡ï¼Œå‡½æ•°ç­‰ç»Ÿç§°ä¸ºå˜é‡ï¼‰å’Œä»£ç ç»“æž„ä¿¡æ¯çš„ä¸œè¥¿ï¼Œç§°ä¹‹ä¸º Environment Recordã€‚2.ä¸€ä¸ªå¼•ç”¨ __outer__ï¼Œè¿™ä¸ªå¼•ç”¨æŒ‡å‘å½“å‰ä½œç”¨åŸŸçš„çˆ¶ä½œç”¨åŸŸã€‚æ‹¿ä¸Šé¢ä»£ç ä¸ºä¾‹ã€‚innerFunc çš„å‡½æ•°ä½œç”¨åŸŸæœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘ walk å‡½æ•°ä½œç”¨åŸŸï¼Œwalk å‡½æ•°ä½œç”¨åŸŸæœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘å…¨å±€ä½œç”¨åŸŸã€‚å…¨å±€ä½œç”¨åŸŸçš„ __outer__ä¸º nullã€‚ ç”Ÿæˆä½œç”¨åŸŸçš„è¯­æ³• 1.å‡½æ•°å£°æ˜Ž123456function f()&#123; var inner = 'inner'; console.log(inner);&#125;f();//innerconsole.log( inner );//Uncaught ReferenceError: inner is not defined 2.catchè¯­å¥12345678910try &#123; throw new Error( 'customized error' );&#125; catch( err ) &#123; var iamnoterror = 'not error'; console.log( iamnoterror ); // not error console.log( err ); // Error: customized error&#125;console.log( iamnoterror ); // not errorconsole.log( err ); // Uncaught ReferenceError: e is not defined catchè¯­å¥ç”Ÿæˆçš„ä½œç”¨åŸŸåªä¼šæ¡†ä½å‚æ•°éƒ¨åˆ†çš„å˜é‡ï¼Œä½¿å…¶ä¸èƒ½åœ¨å¤–éƒ¨è®¿é—®ã€‚å¯¹äºŽ catch è¯­å¥ä½“é‡Œé¢å£°æ˜Žçš„å˜é‡å¹¶ä¸èµ·ä½œç”¨ 3.è¯­å¥å—12345678910111213141516if ( true ) &#123; let bv = 'bv'; const B_C = 'BC'; let blockFunc = function() &#123;&#125; function notBlockFunc() &#123;&#125; console.log( bv ); // bv console.log( B_C ); // BC console.log( notBlockFunc ); // function notBlockFunc() &#123;&#125; console.log( blockFunc ); // function () &#123;&#125; &#125;console.log( bv ); // Uncaught ReferenceError: bv is not definedconsole.log( B_C ); // Uncaught ReferenceError: B_C is not definedconsole.log( notBlockFunc ); // function notBlockFunc() &#123;&#125;console.log( blockFunc ); // ReferenceError: blockFunc is not defined è¯­å¥å— {} ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œä½†æ˜¯è¿™ä¸ªä½œç”¨åŸŸåªç»‘å®šå—çº§å˜é‡ï¼Œå¸¸é‡ç­‰ï¼Œå³ letï¼Œconst å£°æ˜Žçš„å±žäºŽå—çº§ä½œç”¨åŸŸï¼Œè€Œ var å£°æ˜Žçš„è¿˜æ˜¯å±žäºŽå—çº§ä½œç”¨åŸŸçš„çˆ¶ä½œç”¨åŸŸã€‚ æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆexecution contextï¼‰æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ç”¨äºŽè·Ÿè¸ªä»£ç çš„è¿è¡Œæƒ…å†µï¼Œå…¶ç‰¹å¾å¦‚ä¸‹: ä¸€æ®µä»£ç å—å¯¹åº”ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œè¢«å°è£…æˆå‡½æ•°çš„ä»£ç è¢«è§†ä½œä¸€æ®µä»£ç å—ï¼Œæˆ–è€…å…¨å±€ä½œç”¨åŸŸä¹Ÿè¢«è§†ä½œä¸€ä¸ªä»£ç å—ã€‚ å½“ç¨‹åºè¿è¡Œï¼Œè¿›å…¥åˆ°æŸæ®µä»£ç å—æ—¶ï¼Œä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«åˆ›å»ºï¼Œå¹¶è¢«æ”¾å…¥ä¸€ä¸ª stack ä¸­ã€‚å½“ç¨‹åºè¿è¡Œåˆ°è¿™æ®µä»£ç å—ç»“å°¾åŽï¼Œå¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«å¼¹å‡º stack å½“ç¨‹åºåœ¨æŸæ®µä»£ç å—ä¸­è¿è¡Œåˆ°æŸä¸ªç‚¹éœ€è¦è½¬åˆ°äº†å¦ä¸€ä¸ªä»£ç å—æ—¶ï¼ˆè°ƒç”¨äº†å¦ä¸€ä¸ªå‡½æ•°ï¼‰ï¼Œé‚£ä¹ˆå½“å‰çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡çš„çŠ¶æ€ä¼šè¢«ç½®ä¸ºæŒ‚èµ·ï¼Œç„¶åŽç”Ÿæˆä¸€ä¸ªæ–°çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡æ”¾å…¥ stack çš„é¡¶éƒ¨ã€‚ stack æœ€é¡¶éƒ¨çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡è¢«ç§°ä¸º running execution contextã€‚å½“é¡¶éƒ¨çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡è¢«å¼¹å‡ºåŽï¼Œä¸Šä¸€ä¸ªæŒ‚èµ·çš„å¯æ‰§è¡Œä¸Šä¸‹æ–‡ç»§ç»­æ‰§è¡Œã€‚ æˆ‘ä»¬ç”¨ä»£ç æ¥ç¤ºä¾‹ä¸‹ï¼ˆä»Ž outer è°ƒç”¨åˆ° level1 è°ƒç”¨ï¼Œå†é€å±‚è¿”å›žï¼‰ï¼š æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡çš„å†…éƒ¨å±žæ€§ï¼š [[code evaluation]]ï¼šå½“å‰ä»£ç å—æ‰§è¡Œçš„çŠ¶æ€ï¼šprerformï¼Œsuspendï¼Œresumeã€‚ [[Function]]ï¼šå¦‚æžœå½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹åº”çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå±žæ€§å°±ä¿å­˜çš„è¿™ä¸ªå‡½æ•°å¯¹è±¡ã€‚å¦‚æžœå¯¹åº”çš„æ˜¯å…¨å±€çŽ¯å¢ƒï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ª script æˆ–è€… moduleï¼‰ï¼Œå±žæ€§å€¼æ˜¯ nullã€‚ [[Real]]ï¼šç±»ä¼¼ä¸Žæ²™ç®±çš„æ¦‚å¿µï¼Ÿï¼ˆæˆ‘è¿˜æ²¡æœ‰çœ‹æ‡‚ï¼Œä¸è¿‡ä¸å¤ªå½±å“æ­¤ç¯‡çš„å†…å®¹ï¼‰ å¦‚æžœç¨‹åºæ‰§è¡Œåˆ°æŸä¸ªç‚¹æŠ›å‡ºå¼‚å¸¸äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªè®°å½•æ‰§è¡Œä¸Šä¸‹æ–‡çš„ stack æ¥è¿½è¸ªåˆ°åº•å“ªé‡Œå‡ºé”™äº†ï¼Œå¯ä»¥çœ‹åˆ°æ•´ä¸ªè°ƒç”¨æ ˆï¼Œæ­¤æ—¶å†…éƒ¨å±žæ€§ [[Function]] å°±èµ·åˆ°ä½œç”¨äº†ï¼š å¦‚æžœç¨‹åºæ‰§è¡Œåˆ°æŸä¸ªç‚¹æŠ›å‡ºå¼‚å¸¸äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªè®°å½•æ‰§è¡Œä¸Šä¸‹æ–‡çš„ stack æ¥è¿½è¸ªåˆ°åº•å“ªé‡Œå‡ºé”™äº†ï¼Œå¯ä»¥çœ‹åˆ°æ•´ä¸ªè°ƒç”¨æ ˆï¼Œæ­¤æ—¶å†…éƒ¨å±žæ€§ [[Function]] å°±èµ·åˆ°ä½œç”¨äº†ï¼š ä½œç”¨åŸŸä¸Žæ‰§è¡Œä¸Šä¸‹æ–‡çš„å…³ç³»å› ä¸ºåœ¨ä¸€ä¸ªå‡½æ•°è¢«æ‰§è¡Œæ—¶ï¼Œåˆ›å»ºçš„æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡é™¤äº†ä¿å­˜äº†äº›ä»£ç æ‰§è¡Œçš„ä¿¡æ¯ï¼Œè¿˜ä¼šæŠŠå½“å‰çš„ä½œç”¨åŸŸä¿å­˜åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œæ‰€ä»¥ä»–ä»¬çš„å…³ç³»åªæ˜¯å­˜å‚¨å…³ç³»ã€‚ å˜é‡æŸ¥æ‰¾ç»“åˆä½œç”¨åŸŸå’Œæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹å˜é‡æŸ¥æ‰¾çš„è¿‡ç¨‹ã€‚å…¶å®žç¬¬ä¸€æ­¥ä¸æ˜¯åˆ°ä½œç”¨åŸŸé‡Œé¢æ‰¾ Environment Recordï¼Œè€Œæ˜¯å…ˆä»Žå½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ‰¾ä¿å­˜çš„ä½œç”¨åŸŸï¼ˆå¯¹è±¡ï¼‰ï¼Œç„¶åŽå†æ˜¯é€šè¿‡ä½œç”¨åŸŸé“¾å‘ä¸ŠæŸ¥æ‰¾å˜é‡ã€‚è€Œä¸”åŒä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¿å­˜çš„ä½œç”¨åŸŸï¼ˆå¯¹è±¡ï¼‰æ˜¯å¯å˜çš„ï¼Œå½“ä»£ç åœ¨åŒä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œçš„æ—¶å€™ï¼Œå¦‚æžœç¢°åˆ°æœ‰å¿…è¦ç”Ÿæˆä¸€ä¸ªæ–°ä½œç”¨åŸŸçš„æ—¶å€™ï¼Œè¿™ä¸ªæ–°çš„ä½œç”¨åŸŸä¼šè¢«æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„å¤´éƒ¨ï¼Œç„¶åŽæ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¿å­˜çš„ä½œç”¨åŸŸå¯¹è±¡å°±æ›´æ–°æˆè¿™ä¸ªæ–°çš„ä½œç”¨åŸŸã€‚ç­‰è¿™ä¸ªæ–°çš„ä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸå®ŒæˆåŽï¼Œä½œç”¨åŸŸé“¾åˆä¼šæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶å†µï¼Œç„¶åŽæ‰§è¡Œä¸Šä¸‹æ–‡ä¿å­˜çš„ä½œç”¨åŸŸä¹Ÿä¼šæ¢å¤æˆä¹‹å‰çš„ thisç½‘ä¸Šæœ‰æŠŠæ‰§è¡Œä¸Šä¸‹æ–‡ç­‰åŒäºŽ this çš„æ–‡ç« ï¼Œå…¶å®ž this çš„å€¼æ˜¯é€šè¿‡å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ä¿å­˜çš„ä½œç”¨åŸŸï¼ˆå¯¹è±¡ï¼‰æ¥èŽ·å–åˆ°çš„ï¼Œè§„èŒƒå¦‚ä¸‹ã€‚ ResolveThisBinding ( )The abstract operation ResolveThisBinding determines the binding of the keyword this using the LexicalEnvironment of the running execution context. ResolveThisBinding performs the following steps: 1.Let envRec be GetThisEnvironment( ). 2.Return envRec.GetThisBinding(). åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[props å’Œ state çš„åŒºåˆ«]]></title>
    <url>%2F2018%2F04%2F08%2FReact%2Fprops-%E5%92%8C-state-%E7%9A%84%E5%8C%BA%E5%88%AB%2F</url>
    <content type="text"><![CDATA[reactæ˜¯åŸºäºŽçŠ¶æ€å®žçŽ°å¯¹DOMæŽ§åˆ¶å’Œæ¸²æŸ“ã€‚ç»„ä»¶çŠ¶æ€å¯åˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§æ˜¯ç»„ä»¶é—´çš„çŠ¶æ€ä¼ é€’ï¼Œå¦ä¸€ç§æ˜¯ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ã€‚è¿™ä¸¤ç§çŠ¶æ€ä½¿ç”¨propså’Œstateè¡¨ç¤ºã€‚propsç”¨äºŽçˆ¶ç»„ä»¶å‘å­ç»„ä»¶çš„æ•°æ®ä¼ é€’ï¼Œç»„ä»¶å†…éƒ¨ä¹Ÿæœ‰è‡ªå·±çš„çŠ¶æ€ï¼šstateï¼Œè¿™äº›çŠ¶æ€åªèƒ½åœ¨ç»„ä»¶å†…éƒ¨ä¿®æ”¹ã€‚ æ•°æ®æµä¸Žpropsreactçš„æ•°æ®æµæ˜¯å•å‘çš„ï¼Œåªä¼šä»Žçˆ¶ç»„ä»¶ä¼ é€’åˆ°å­ç»„ä»¶ã€‚å±žæ€§propsï¼ˆpropertiesï¼‰æ˜¯çˆ¶å­ç»„ä»¶è¿›è¡Œä¼ é€’çŠ¶æ€çš„æŽ¥å£ã€‚Reactä¼šå‘ä¸‹éåŽ†æ•´ä¸ªç»„ä»¶æ ‘ï¼Œå¹¶é‡æ–°æ¸²æŸ“ä½¿ç”¨è¿™ä¸ªå±žæ€§çš„ç»„ä»¶ã€‚ è®¾ç½®propså¯ä»¥åœ¨ç»„ä»¶æŒ‚è½½æ—¶è®¾ç½®props 12var sites = [&#123;title:'baidu.com'&#125;];&lt;ListSites sites = &#123;sites&#125;/&gt; ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ç»„ä»¶å®žä¾‹çš„SetProps()æ–¹æ³•è®¾ç½®props 12345var sites = [&#123;title:'baidu.com'&#125;];ReactDOM.render( &lt;ListSites/&gt;, document.getElementById('example')) SetProps()æ–¹æ³•åªèƒ½ç”¨äºŽç»„ä»¶å¤–éƒ¨è°ƒç”¨ï¼Œä¸èƒ½åœ¨ç»„ä»¶å†…ä½¿ç”¨this.SetProps()ä¿®æ”¹ç»„ä»¶å±žæ€§ã€‚ç»„ä»¶å†…éƒ¨çš„this.propsæ˜¯åªè¯»çš„ï¼Œåªèƒ½ç”¨äºŽè®¿é—®propså±žæ€§ï¼Œä¸èƒ½ä¿®æ”¹ç»„ä»¶è‡ªèº«çš„å±žæ€§ã€‚ JSXè¯­æ³•ä¸­çš„å±žæ€§è®¾ç½®JSXè¯­æ³•ä¸­ï¼Œpropså¯ä»¥è®¾ç½®ä¸ºå­—ç¬¦ä¸²ï¼š 1&lt;a href="http://itbilu.com"&gt;ITç¬”å½•&lt;/a&gt; æˆ–æ˜¯é€šè¿‡{}è¯­æ³•è®¾ç½®ï¼š 12var obj = &#123;url:'itbilu.com', name:'ITç¬”å½•'&#125;;&lt;a href="http://&#123;obj.url&#125;"&gt;&#123;obj.name&#125;&lt;/a&gt; JSXè¿˜æ”¯æŒå°†propsç›´æŽ¥è®¾ç½®ä¸ºä¸€ä¸ªå¯¹è±¡ï¼š 12345678class Site extends React.Component&#123; render()&#123; var obj = (&#123;url:'baidu.com',name:'ITç¬”å½•'&#125;) return( &lt;Site &#123;...obj&#125;/&gt; ) &#125;&#125; propsè¿˜å¯ä»¥ç”¨æ¥æ·»åŠ äº‹ä»¶å¤„ç†ï¼š 12345678var saveBtn = React.createClass(&#123; render:function()&#123; &lt;a onClick=&#123;this.handleClick&#125;&gt;ä¿å­˜&lt;/a&gt; &#125; handleClick:function()&#123; //... &#125;&#125;) propsçš„ä¼ é€’ç»„ä»¶æŽ¥æ”¶ä¸Šçº§ç»„ä»¶çš„propsï¼Œå¹¶ä¼ é€’åˆ°ä¸‹çº§ç»„ä»¶ï¼Œå¦‚ï¼š 12345678910111213141516var myCheackBox = React.createClass (&#123; render:myCheackBox()&#123; var myClass = this.props.cheacked ? 'MyCheacked':'MyCheackBox'; return( &lt;div className = &#123;myClass&#125; onClick = &#123;this.props.onClick&#125;&gt; &#123;this.props.children&#125; &lt;/div&gt; ) &#125;&#125;)React.render( &lt;MyCheackBox cheacked = &#123;true&#125; onClick = &#123;console.log.bind(console)&#125;&gt; hello world &lt;MyCheackBox/&gt;, document.getElementById('example')) ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸ŽStatepropså¯ä»¥ç†è§£ä¸ºçˆ¶å­ç»„ä»¶çš„çŠ¶æ€ä¼ é€’ï¼Œè€ŒReactæœ‰è‡ªå·±å†…éƒ¨çš„çŠ¶æ€ï¼Œè¿™ä¸ªå†…éƒ¨çŠ¶æ€åˆ™ç”¨Stateè¡¨ç¤ºã€‚ å¦‚ï¼Œç”¨stateå®šä¹‰ä¸€ä¸ªç»„ä»¶çš„çŠ¶æ€ï¼š 1234567891011121314151617181920212223242526var SiteDropdown = React.createClass(&#123; getInitalState: function() &#123; return: &#123; showOptions: false &#125; &#125; render:function()&#123; var opts; if(this.state.showOptions)&#123; &lt;ul&gt; &lt;li&gt;itbilu.com&lt;/li&gt; &lt;li&gt;yijiebuyi.com&lt;/li&gt; &lt;li&gt;niefengjun.cn&lt;/li&gt; &lt;/ul&gt; &#125;; return( &lt;div onClick=&#123;this.handleClick&#125; &gt; &lt;/div&gt; ) &#125;, handleClick:function()&#123; this.SetState (&#123; showOptions: true &#125;) &#125; &#125;&#125;) éšç€stateçš„å˜åŒ–ï¼Œrenderä¹Ÿä¼šè°ƒç”¨ï¼Œreactä¼šå¯¹æ¯”renderè¿”å›žçš„å€¼ï¼Œå¦‚æžœæœ‰å˜åŒ–å°±ä¼šDOMï¼›stateä¸Žpropsç±»ä¼¼ï¼Œåªèƒ½é€šè¿‡setState()æ–¹æ³•ä¿®æ”¹ã€‚ä¸åŒçš„æ˜¯ï¼Œstateåªèƒ½åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨ï¼Œå…¶å®žæ˜¯å¯¹ç»„ä»¶æœ¬èº«çŠ¶æ€çš„ä¸€ä¸ªå¼•ç”¨ propsä¸Žstateçš„æ¯”è¾ƒReactä¼šæ ¹æ®propså’Œstateæ›´æ–°è§†å›¾çŠ¶æ€ï¼Œè™½ç„¶äºŒè€…æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ˜¯ä¸¤è€…çš„åº”ç”¨èŒƒå›´ä¸åŒã€‚å…·ä½“è¡¨çŽ°å¦‚ä¸‹ï¼š propsä¼šåœ¨æ•´ä¸ªç»„ä»¶æ•°ä¸­ä¼ é€’æ•°æ®å’Œé…ç½®ï¼Œpropså¯ä»¥è®¾ç½®ä»»å‘½ç±»åž‹çš„æ•°æ®ï¼Œåº”è¯¥æŠŠå½“ä½œç»„ä»¶çš„æ•°æ®æºã€‚å…¶ä¸ä½†å¯ä»¥ç”¨äºŽä¸Šçº§ç»„ä»¶ä¸Žä¸‹çº§ç»„ä»¶çš„é€šä¿¡ï¼Œä¹Ÿå¯ä»¥ç”¨ä½œäº‹ä»¶å¤„ç†å™¨ stateåªèƒ½ç»„ä»¶å†…éƒ¨ä½¿ç”¨ï¼Œstateåªåº”è¯¥ç”¨äºŽå­˜å‚¨ç®€å•çš„è§†å›¾çŠ¶ï¼ˆå¦‚ï¼šä¸Šé¢ç¤ºä¾‹ç”¨äºŽæŽ§åˆ¶ä¸‹æ‹‰æ¡†çš„å¯è§çŠ¶æ€ï¼‰ propsä¸Žstateéƒ½ä¸èƒ½ç›´æŽ¥ä¿®æ”¹ï¼Œè€Œåº”è¯¥åˆ†åˆ«ä½¿ç”¨SetProps()å’ŒSetProps()ä¿®æ”¹ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Reactï¼šç»„ä»¶ç”Ÿå‘½å‘¨æœŸ]]></title>
    <url>%2F2018%2F04%2F04%2FReact%2FReact%EF%BC%9A%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%2F</url>
    <content type="text"><![CDATA[åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œéšç€è¯¥ç»„ä»¶çš„propsæˆ–è€…stateå‘ç”Ÿæ”¹å˜ï¼Œå…¶DOMè¡¨çŽ°ä¹Ÿä¼šæœ‰ç›¸åº”çš„å˜åŒ–ã€‚ä¸€ä¸ªç»„ä»¶å°±æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå¯¹äºŽç‰¹å®šåœ°è¾“å…¥ï¼Œå®ƒæ€»è¿”å›žä¸€è‡´çš„è¾“å‡ºã€‚ ä¸€ä¸ªReactç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šå®žä¾‹åŒ–ã€å­˜åœ¨æœŸå’Œé”€æ¯æ—¶ã€‚ å®žä¾‹åŒ–å½“ç»„ä»¶åœ¨å®¢æˆ·ç«¯è¢«å®žä¾‹åŒ–ï¼Œç¬¬ä¸€æ¬¡è¢«åˆ›å»ºæ—¶ï¼Œä»¥ä¸‹æ–¹æ³•ä¾æ¬¡è¢«è°ƒç”¨ï¼š 1ã€getDefaultProps2ã€getInitialState 1ã€2æ­¥éª¤ä½¿ç”¨Es6è¯­æ³•åˆ™ä¸º1234constructor(props)&#123; super(props); this.state = &#123;&#125;&#125; 3ã€componentWillMount4ã€render5ã€componentDidMount å½“ç»„ä»¶åœ¨æœåŠ¡ç«¯è¢«å®žä¾‹åŒ–ï¼Œé¦–æ¬¡è¢«åˆ›å»ºæ—¶ï¼Œä»¥ä¸‹æ–¹æ³•ä¾æ¬¡è¢«è°ƒç”¨ï¼š1ã€getDefaultProps2ã€getInitialState3ã€componentWillMount4ã€render componentDidMount ä¸ä¼šåœ¨æœåŠ¡ç«¯è¢«æ¸²æŸ“çš„è¿‡ç¨‹ä¸­è°ƒç”¨ã€‚ getDefaultPropså¯¹äºŽæ¯ä¸ªç»„ä»¶å®žä¾‹æ¥è®²ï¼Œè¿™ä¸ªæ–¹æ³•åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œè¯¥ç»„ä»¶ç±»çš„æ‰€æœ‰åŽç»­åº”ç”¨ï¼ŒgetDefaultPops å°†ä¸ä¼šå†è¢«è°ƒç”¨ï¼Œå…¶è¿”å›žçš„å¯¹è±¡å¯ä»¥ç”¨äºŽè®¾ç½®é»˜è®¤çš„ props(propertiesçš„ç¼©å†™) å€¼ã€‚ 1234567891011121314var Hello = React.createClass(&#123; getDefaultProps:function()&#123; return&#123; name : "tom", git : "dwqs" &#125; &#125;, render : function()&#123; return&#123; &lt;div&gt;Hello,&#123;this.props.name&#125;,git username is &#123;this.props.git&#125;&lt;/div&gt; &#125; &#125;&#125;)ReactDOM.render(&lt;Hello/&gt;,document.body) ä¹Ÿå¯ä»¥åœ¨æŒ‚è½½ç»„ä»¶çš„æ—¶å€™è®¾ç½® propsï¼š12var data = [&#123;title:'Hello'&#125;];&lt;Hello data=&#123;data&#125;/&gt;&gt; æˆ–è€…è°ƒç”¨ setProps ï¼ˆä¸€èˆ¬ä¸éœ€è¦è°ƒç”¨ï¼‰æ¥è®¾ç½®å…¶ props 123var data = [&#123;title:'data'&#125;];var Hello = ReactDOM.render(&lt;/Demo&gt;,document.body);Hello.setProps(&#123;data:data&#125;) ä½†åªèƒ½åœ¨å­ç»„ä»¶æˆ–ç»„ä»¶æ ‘ä¸Šè°ƒç”¨ setPropsã€‚åˆ«è°ƒç”¨ this.setProps æˆ–è€… ç›´æŽ¥ä¿®æ”¹ this.propsã€‚å°†å…¶å½“åšåªè¯»æ•°æ®ã€‚ Reacté€šè¿‡ propTypes æä¾›äº†ä¸€ç§éªŒè¯ props çš„æ–¹å¼ï¼ŒpropTypes æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œç”¨äºŽå®šä¹‰å±žæ€§ç±»åž‹ï¼š 123456789101112var survey = React.createClass(&#123; propTypes:&#123; survey:React.propTypes.shape(&#123; id: React.propType.number.isRequered; &#125;).isRequiered, onClick:React.propTypes.func, name: React.propTypes.string, score: React.propTypes.array //... &#125;, // ...&#125;) ç»„ä»¶åˆå§‹åŒ–æ—¶ï¼Œå¦‚æžœä¼ é€’çš„å±žæ€§å’Œ propTypes ä¸åŒ¹é…ï¼Œåˆ™ä¼šæ‰“å°ä¸€ä¸ª console.warn æ—¥å¿—ã€‚å¦‚æžœæ˜¯å¯é€‰é…ç½®ï¼Œå¯ä»¥åŽ»æŽ‰.isRequiredã€‚propTypes çš„è¯¦è§£å¯æˆ³æ­¤ getInitalStateå¯¹äºŽç»„ä»¶çš„æ¯ä¸ªå®žä¾‹æ¥è¯´ï¼Œè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨getInitalStateæœ‰ä¸”åªæœ‰ä¸€æ¬¡ï¼ŒgetInitalStateç”¨æ¥åˆå§‹åŒ–æ¯ä¸ªå®žä¾‹çš„ stateï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œï¼Œå¯ä»¥è®¿é—®ç»„ä»¶çš„ propsã€‚æ¯ä¸€ä¸ªReactç»„ä»¶éƒ½æœ‰è‡ªå·±çš„ stateï¼Œå…¶ä¸Ž props çš„åŒºåˆ«åœ¨äºŽ stateåªå­˜åœ¨ç»„ä»¶çš„å†…éƒ¨ï¼Œprops åœ¨æ‰€æœ‰å®žä¾‹ä¸­å…±äº«ã€‚ getInitialState å’Œ getDefaultPops çš„è°ƒç”¨æ˜¯æœ‰åŒºåˆ«çš„ï¼ŒgetDefaultPops æ˜¯å¯¹äºŽç»„ä»¶ç±»æ¥è¯´åªè°ƒç”¨ä¸€æ¬¡ï¼ŒåŽç»­è¯¥ç±»çš„åº”ç”¨éƒ½ä¸ä¼šè¢«è°ƒç”¨ï¼Œè€Œ getInitialState æ˜¯å¯¹äºŽæ¯ä¸ªç»„ä»¶å®žä¾‹æ¥è®²éƒ½ä¼šè°ƒç”¨ï¼Œå¹¶ä¸”åªè°ƒä¸€æ¬¡ 1234567891011121314151617181920var LikeButton = React.createClass(&#123; getInitalState:function()&#123; return &#123;liked :false&#125; &#125; handleClick:function(event)&#123; this.setState(&#123;liked : !this.state.liked&#125;) &#125; render:function()&#123; var text = this.state.liked ? 'liked' : 'dont like' return( &lt;p onClick = &#123;this.handleClick&#125;&gt; you &#123;text&#125; this book; &lt;/p&gt; ) &#125;&#125;)ReactDOM.render( &lt;LikeButton /&gt;, document.getElementById('example')); æ¯æ¬¡ä¿®æ”¹ stateï¼Œéƒ½ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Œå®žä¾‹åŒ–åŽé€šè¿‡ state æ›´æ–°ç»„ä»¶ï¼Œä¼šä¾æ¬¡è°ƒç”¨ä¸‹åˆ—æ–¹æ³• 1ã€shouldComponentUpdate2ã€conponentWillUpdate3ã€render4ã€conponentDidUpdate ä½†æ˜¯ä¸è¦ç›´æŽ¥ä¿®æ”¹ this.stateï¼Œè¦é€šè¿‡ this.setState æ–¹æ³•æ¥ä¿®æ”¹ã€‚ componentWillMountåœ¨é¦–æ¬¡æ¸²æŸ“æ‰§è¡Œå‰ç«‹å³è°ƒç”¨ä¸”ä»…è°ƒç”¨ä¸€æ¬¡ã€‚å¦‚æžœåœ¨è¿™ä¸ªæ–¹æ³•å†…éƒ¨è°ƒç”¨ setState å¹¶ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œè¿™ä¹Ÿæ˜¯åœ¨ render æ–¹æ³•è°ƒç”¨ä¹‹å‰ä¿®æ”¹ state çš„æœ€åŽä¸€æ¬¡æœºä¼šã€‚ renderè¯¥æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹ŸDOMï¼Œç”¨æ¥è¡¨ç¤ºç»„ä»¶çš„è¾“å‡ºã€‚å¯¹äºŽä¸€ä¸ªç»„ä»¶æ¥è®²ï¼Œrenderæ–¹æ³•æ˜¯å”¯ä¸€ä¸€ä¸ªå¿…éœ€çš„æ–¹æ³•ã€‚renderæ–¹æ³•éœ€è¦æ»¡è¶³ä¸‹é¢å‡ ç‚¹ï¼š 1.åªèƒ½é€šè¿‡this.stateå’Œthis.propsè®¿é—®æ•°æ®ï¼ˆä¸èƒ½ä¿®æ”¹ï¼‰2.å¯ä»¥è¿”å›žnullå’Œfalse æˆ–è€…ä»»ä½•Reactç»„ä»¶3.åªèƒ½å‡ºçŽ°ä¸€ä¸ªé¡¶çº§ç»„ä»¶ï¼Œä¸èƒ½è¿”å›žä¸€ç»„å…ƒç´ 4.ä¸èƒ½æ”¹å˜ç»„ä»¶çš„çŠ¶æ€5.ä¸èƒ½ä¿®æ”¹Domçš„è¾“å‡º renderæ–¹æ³•è¿”å›žçš„ç»“æžœå¹¶ä¸æ˜¯çœŸæ­£çš„DOMå…ƒç´ ï¼Œè€Œæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„è¡¨çŽ°ï¼Œç±»ä¼¼äºŽä¸€ä¸ªDOM treeçš„ç»“æž„çš„å¯¹è±¡ã€‚reactä¹‹æ‰€ä»¥æ•ˆçŽ‡é«˜ï¼Œå°±æ˜¯è¿™ä¸ªåŽŸå› ã€‚ componentDidMountè¯¥æ–¹æ³•ä¸ä¼šåœ¨æœåŠ¡ç«¯è¢«æ¸²æŸ“çš„è¿‡ç¨‹ä¸­è°ƒç”¨ã€‚è¯¥æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå·²ç»æ¸²æŸ“å‡ºçœŸå®žçš„ DOMï¼Œå¯ä»¥å†è¯¥æ–¹æ³•ä¸­é€šè¿‡ this.getDOMNode() è®¿é—®åˆ°çœŸå®žçš„ DOM(æŽ¨èä½¿ç”¨ ReactDOM.findDOMNode())ã€‚ 1234567891011var data = [..];var comp = React.createClass(&#123; render: function()&#123; return &lt;imput .. /&gt; &#125;, conponentDidMount: function()&#123; $(this.getDOMNode()).autoComplete(&#123; src: data &#125;) &#125;&#125;) ç”±äºŽç»„ä»¶å¹¶ä¸æ˜¯çœŸå®žçš„ DOM èŠ‚ç‚¹ï¼Œè€Œæ˜¯å­˜åœ¨äºŽå†…å­˜ä¹‹ä¸­çš„ä¸€ç§æ•°æ®ç»“æž„ï¼Œå«åšè™šæ‹Ÿ DOM ï¼ˆvirtual DOMï¼‰ã€‚åªæœ‰å½“å®ƒæ’å…¥æ–‡æ¡£ä»¥åŽï¼Œæ‰ä¼šå˜æˆçœŸå®žçš„ DOM ã€‚æœ‰æ—¶éœ€è¦ä»Žç»„ä»¶èŽ·å–çœŸå®ž DOM çš„èŠ‚ç‚¹ï¼Œè¿™æ—¶å°±è¦ç”¨åˆ° ref å±žæ€§ 12345678910111213var Aera = React.createClass (&#123; render:function()&#123; this.getDOMNode();//renderè°ƒç”¨æ—¶ï¼Œè¿™é‡ŒæœªæŒ‚è½½ï¼Œä¼šæŠ¥é”™ return( return &lt;canvas ref='mainCanvas'&gt; ) &#125;ï¼Œ componentDidMount: function()&#123; var canvas = this.refs.mainCanvas.getDOMNode(); //è¿™æ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥è®¿é—®åˆ° Canvas èŠ‚ç‚¹ &#125;&#125;) éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºŽ this.refs.[refName] å±žæ€§èŽ·å–çš„æ˜¯çœŸå®ž DOM ï¼Œæ‰€ä»¥å¿…é¡»ç­‰åˆ°è™šæ‹Ÿ DOM æ’å…¥æ–‡æ¡£ä»¥åŽï¼Œæ‰èƒ½ä½¿ç”¨è¿™ä¸ªå±žæ€§ï¼Œå¦åˆ™ä¼šæŠ¥é”™ å­˜åœ¨æœŸæ­¤æ—¶ç»„ä»¶å·²ç»æ¸²æŸ“å¥½å¹¶ä¸”ç”¨æˆ·å¯ä»¥ä¸Žå®ƒè¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚é¼ æ ‡ç‚¹å‡»ï¼Œæ‰‹æŒ‡ç‚¹æŒ‰ï¼Œæˆ–è€…å…¶å®ƒçš„ä¸€äº›äº‹ä»¶ï¼Œå¯¼è‡´åº”ç”¨çŠ¶æ€çš„æ”¹å˜ï¼Œä½ å°†ä¼šçœ‹åˆ°ä¸‹é¢çš„æ–¹æ³•ä¾æ¬¡è¢«è°ƒç”¨1ã€componentWillReceiveProps2ã€shouldComponentUpdate3ã€componentWillUpdate4ã€render5ã€componentDidUpdate componentWillReceivePropsç»„ä»¶çš„ props å±žæ€§å¯ä»¥é€šè¿‡çˆ¶ç»„ä»¶æ¥æ›´æ”¹ï¼Œè¿™æ—¶ï¼ŒcomponentWillReceiveProps å°†æ¥è¢«è°ƒç”¨ã€‚å¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•é‡Œæ›´æ–° state,ä»¥è§¦å‘ render æ–¹æ³•é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚1234567componentWillReceliveProps:function(nextProps)&#123; if(nextProps.click !== undefined)&#123; this.setState(&#123; checked: nextProps.checked &#125;) &#125;&#125; shouldComponentUpdateå¦‚æžœä½ ç¡®å®šç»„ä»¶çš„ props æˆ–è€… state çš„æ”¹å˜ä¸éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œå¯ä»¥é€šè¿‡åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé€šè¿‡è¿”å›ž false æ¥é˜»æ­¢ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œè¿”å›ž falseåˆ™ä¸ä¼šæ‰§è¡Œ render ä»¥åŠåŽé¢çš„ componentWillUpdateï¼ŒcomponentDidUpdateæ–¹æ³•ã€‚ è¯¥æ–¹æ³•æ˜¯éžå¿…é¡»çš„ï¼Œå¹¶ä¸”å¤§å¤šæ•°æƒ…å†µä¸‹æ²¡æœ‰åœ¨å¼€å‘ä¸­ä½¿ç”¨ã€‚1234shouldComponentUpdate: function(nextProps, nextState)&#123; return this.state.checked === nextState.checked; //return false åˆ™ä¸æ›´æ–°ç»„ä»¶&#125; componentWillUpdateè¿™ä¸ªæ–¹æ³•å’Œ componentWillMount ç±»ä¼¼ï¼Œåœ¨ç»„ä»¶æŽ¥æ”¶åˆ°äº†æ–°çš„ props æˆ–è€… state å³å°†è¿›è¡Œé‡æ–°æ¸²æŸ“å‰ï¼ŒcomponentWillUpdate(object nextProps, object nextState) ä¼šè¢«è°ƒç”¨ï¼Œæ³¨æ„ä¸è¦åœ¨æ­¤æ–¹é¢é‡Œå†åŽ»æ›´æ–° props æˆ–è€… stateã€‚ componentDidUpdateè¿™ä¸ªæ–¹æ³•å’Œ componentDidMount ç±»ä¼¼ï¼Œåœ¨ç»„ä»¶é‡æ–°è¢«æ¸²æŸ“ä¹‹åŽï¼ŒcomponentDidUpdate(object prevProps, object prevState) ä¼šè¢«è°ƒç”¨ã€‚å¯ä»¥åœ¨è¿™é‡Œè®¿é—®å¹¶ä¿®æ”¹ DOMã€‚ é”€æ¯æœŸcomponentWillUnmountæ¯å½“Reactä½¿ç”¨å®Œä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶å¿…é¡»ä»Ž DOM ä¸­å¸è½½åŽè¢«é”€æ¯ï¼Œæ­¤æ—¶ componentWillUnmout ä¼šè¢«æ‰§è¡Œï¼Œå®Œæˆæ‰€æœ‰çš„æ¸…ç†å’Œé”€æ¯å·¥ä½œï¼Œåœ¨ conponentDidMount ä¸­æ·»åŠ çš„ä»»åŠ¡éƒ½éœ€è¦å†è¯¥æ–¹æ³•ä¸­æ’¤é”€ï¼Œå¦‚åˆ›å»ºçš„å®šæ—¶å™¨æˆ–äº‹ä»¶ç›‘å¬å™¨ã€‚ å½“å†æ¬¡è£…è½½ç»„ä»¶æ—¶ï¼Œä»¥ä¸‹æ–¹æ³•ä¼šè¢«ä¾æ¬¡è°ƒç”¨ï¼š1ã€getInitialState2ã€componentWillMount3ã€render4ã€componentDidMount åæ¨¡å¼åœ¨ getInitialState æ–¹æ³•ä¸­ï¼Œå°è¯•é€šè¿‡ this.props æ¥åˆ›å»º state çš„åšæ³•æ˜¯ä¸€ç§åæ¨¡å¼ã€‚ 1234567891011121314//åæ¨¡å¼getDefaultProps: function()&#123; return &#123; data: new Date() &#125;&#125;,getInitialState: function()&#123; return &#123; day: this.props.date - new Date() &#125;&#125;,render: function()&#123; return &lt;div&gt;Day:&#123;this.state.day&#125;&lt;/div&gt;&#125; ç»è¿‡è®¡ç®—åŽçš„å€¼ä¸åº”è¯¥èµ‹ç»™ stateï¼Œæ­£ç¡®çš„æ¨¡å¼åº”è¯¥æ˜¯åœ¨æ¸²æŸ“æ—¶è®¡ç®—è¿™äº›å€¼ã€‚è¿™æ ·ä¿è¯äº†è®¡ç®—åŽçš„å€¼æ°¸è¿œä¸ä¼šä¸Žæ´¾ç”Ÿå‡ºå®ƒçš„ props å€¼ä¸åŒæ­¥ã€‚123456789getDefaultProps: function()&#123; return &#123; data: new Date() &#125;&#125;,render: function()&#123; var day = this.props.date - new Date(); return &lt;div&gt;Day:&#123;day&#125;&lt;/div&gt;&#125; å¦‚æžœåªæ˜¯ç®€å•çš„åˆå§‹åŒ– stateï¼Œé‚£ä¹ˆåº”ç”¨åæ¨¡å¼æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ æ€»ç»“ä¸‹é¢çš„ä¸€å¼ å›¾æ€»ç»“ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼š åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Context APIè¯¦è§£]]></title>
    <url>%2F2018%2F04%2F03%2FReact%2FContext-API%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[Reactåœ¨ç‰ˆæœ¬16.3-alphaé‡Œå¼•å…¥äº†æ–°çš„Context APIï¼Œç¤¾åŒºä¸€ç‰‡æœŸå¾…ä¹‹å£°ã€‚æˆ‘ä»¬å…ˆé€šè¿‡ç®€å•çš„ä¾‹å­ï¼Œçœ‹ä¸‹æ–°çš„Context APIé•¿å•¥æ ·ï¼Œç„¶åŽå†ç®€å•æŽ¢è®¨ä¸‹æ–°çš„APIçš„æ„ä¹‰ã€‚ Demoåœ°å€ çœ‹ä¸‹æ–°çš„Context APIéœ€è¦å®‰è£…16.3-alphaç‰ˆæœ¬çš„reactã€‚ä¸‹é¢ï¼Œç›´æŽ¥æ¥çœ‹ä»£ç ï¼Œå¦‚æžœç”¨è¿‡react-reduxåº”è¯¥ä¼šè§‰å¾—å¾ˆçœ¼ç†Ÿã€‚é¦–å…ˆï¼Œåˆ›å»ºcontextå®žä¾‹ï¼š 12345678import React from 'react';import ReactDOM from 'react-dom';// åˆ›å»ºcontextå®žä¾‹const ThemeContext = React.createContext(&#123; background: 'red', color: 'white'&#125;); ç„¶åŽï¼Œå®šä¹‰Appç»„ä»¶ï¼Œæ³¨æ„è¿™é‡Œç”¨åˆ°äº†Providerç»„ä»¶ï¼Œç±»ä¼¼react-reduxçš„Providerç»„ä»¶ 12345678910class App extends React.Component &#123; render () &#123; return ( &lt;ThemeContext.Provider value=&#123;&#123;background: 'green', color: 'white'&#125;&#125;&gt; &lt;Header /&gt; &lt;/ThemeContext.Provider&gt; ); &#125;&#125; æŽ¥ä¸‹æ¥ï¼Œå®šä¹‰Headerã€Titleç»„ä»¶ã€‚æ³¨æ„ï¼š Titleç»„ä»¶ç”¨åˆ°äº†Consumerç»„ä»¶ï¼Œè¡¨ç¤ºè¦æ¶ˆè´¹Providerä¼ é€’çš„æ•°æ®ã€‚Titleç»„ä»¶æ˜¯Appçš„å­™ç»„ä»¶ï¼Œä½†è·³è¿‡äº†Headeræ¶ˆè´¹æ•°æ®ã€‚ 123456789101112131415161718192021class Header extends React.Component &#123; render () &#123; return ( &lt;Title&gt;Hello React Context API&lt;/Title&gt; ); &#125;&#125;class Title extends React.Component &#123; render () &#123; return ( &lt;ThemeContext.Consumer&gt; &#123;context =&gt; ( &lt;h1 style=&#123;&#123;background: context.background, color: context.color&#125;&#125;&gt; &#123;this.props.children&#125; &lt;/h1&gt; )&#125; &lt;/ThemeContext.Consumer&gt; ); &#125;&#125; æœ€åŽå¸¸è§„æ“ä½œ1234ReactDOM.render( &lt;App /&gt;, document.getElementById('container')); ä¸ºä»€ä¹ˆæœ‰æ–°çš„Context APIè¿‡redux + react-reduxçš„åŒå­¦ï¼Œåº”è¯¥ä¼šè§‰å¾—æ–°çš„Context APIå¾ˆçœ¼ç†Ÿã€‚è€Œæœ‰çœ‹è¿‡react-reduxæºç çš„åŒå­¦å°±çŸ¥é“ï¼Œreact-reduxæœ¬èº«å°±æ˜¯åŸºäºŽæ—§ç‰ˆæœ¬çš„Context APIå®žçŽ°çš„ã€‚ æ—¢ç„¶å·²ç»æœ‰äº†çŽ°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šæœ‰æ–°çš„Context APIå‘¢ï¼Ÿ çŽ°æœ‰Context APIçš„å®žçŽ°å­˜åœ¨ä¸€å®šé—®é¢˜ï¼šæ¯”å¦‚å½“çˆ¶ç»„ä»¶çš„shouldComponentUpdateæ€§èƒ½ä¼˜åŒ–ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¶ˆè´¹äº†contextæ•°æ®çš„å­ç»„ä»¶ä¸æ›´æ–°ã€‚1.é™ä½Žå¤æ‚åº¦ï¼šç±»ä¼¼reduxå…¨å®¶æ¡¶è¿™æ ·çš„è§£å†³æ–¹æ¡ˆï¼Œç»™é¡¹ç›®å¼•å…¥äº†ä¸€å®šçš„å¤æ‚åº¦ï¼Œå°¤å…¶æ˜¯å¯¹æ–¹æ¡ˆäº†è§£ä¸è¶³çš„åŒå­¦ï¼Œé‡åˆ°é—®é¢˜å¯èƒ½ä¸€ç­¹èŽ«å±•ã€‚2.æ–°Context APIçš„å¼•å…¥ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥ä¸å°‘é¡¹ç›®å¯¹reduxå…¨å®¶æ¡¶çš„ä¾èµ–ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react 16.3æ–°ç‰¹æ€§]]></title>
    <url>%2F2018%2F04%2F02%2FReact%2Freact-16-3%E6%96%B0%E7%89%B9%E6%80%A7%2F</url>
    <content type="text"><![CDATA[Context APIContext APIæ€»æ˜¯å¾ˆè®©äººè¿·æƒ‘ã€‚è¿™ä¸ªAPIæ˜¯å®˜æ–¹çš„ï¼Œä½†æ˜¯å®˜æ–¹åˆä¸å¸Œæœ›å¼€å‘è€…ä»¬ä½¿ç”¨è¿™ä¸ªAPIï¼Œè¯´æ˜¯è¿™ä¸ªAPIä¼šåœ¨ä»¥åŽå‘ç”Ÿæ”¹å˜ã€‚çŽ°åœ¨å°±æ˜¯é‚£ä¸ªæ”¹å˜çš„æ—¶åˆ»ã€‚æ–°çš„APIå·²ç»è¢«mergeäº†ã€‚è€Œä¸”å®ƒçœ‹èµ·æ¥æ›´åŠ çš„â€œç”¨æˆ·å‹å¥½â€äº†ã€‚å°¤å…¶æ˜¯ä½ ä¸å¾—ä¸ä½¿ç”¨reduxã€mobxçš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©æ–°çš„Context APIå®žçŽ°æ›´åŠ ç®€å•çš„çŠ¶æ€ç®¡ç†ã€‚ æ–°çš„APIç”¨èµ·æ¥éžå¸¸çš„ç®€å•ï¼šReact.createContext()ï¼Œè¿™æ ·å°±åˆ›å»ºäº†ä¸¤ä¸ªç»„ä»¶ï¼š12345import &#123;context&#125; from 'react';const ThemeContext = createContext(&#123; background: 'yellow', color: 'white'&#125;); è°ƒç”¨createContextæ–¹æ³•ä¼šè¿”å›žä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯Providerï¼Œä¸€ä¸ªæ˜¯Consumerã€‚ é‚£ä¸ªProvideræ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç»„ä»¶ã€‚å®ƒå¯ä»¥ç”¨æ¥ç»™å­æ ‘é‡Œçš„ç»„ä»¶æä¾›æ•°æ®ã€‚ä¸€ä¸ªä¾‹å­ï¼š123456789class Application extends React.Component &#123; render() &#123; &lt;ThemeContext.Provider value=&#123;&#123;background: 'black', color: 'white'&#125;&#125;&gt; &lt;Header /&gt; &lt;Main /&gt; &lt;Footer /&gt; &lt;/ThemeContext.Provider&gt; &#125;&#125; ä¸Šä¾‹å±•ç¤ºäº†å¦‚ä½•ä¼ é€’â€œthemeâ€ contextçš„ã€‚å½“ç„¶è¿™äº›å€¼å¯ä»¥æ˜¯åŠ¨æ€çš„ï¼ˆæ¯”å¦‚ï¼ŒåŸºäºŽthis.stateï¼‰ã€‚ ä¸‹ä¸€æ­¥å°±æ˜¯ä½¿ç”¨Consumerã€‚1234567891011const Header = () =&gt; &#123; &lt;ThemeContext.Consumer&gt; &#123;(context) =&gt; &#123; return ( &lt;p style=&#123;&#123;background: context.background, color: context.color&#125;&#125;&gt; Welcome! &lt;/p&gt; ); &#125;&#125; &lt;/ThemeContext.Consumer&gt;&#125; æŽ¥ä¸‹æ¥ï¼Œå®šä¹‰Headerã€Titleç»„ä»¶ã€‚æ³¨æ„ï¼š Titleç»„ä»¶ç”¨åˆ°äº†Consumerç»„ä»¶ï¼Œè¡¨ç¤ºè¦æ¶ˆè´¹Providerä¼ é€’çš„æ•°æ®ã€‚Titleç»„ä»¶æ˜¯Appçš„å­™ç»„ä»¶ï¼Œä½†è·³è¿‡äº†Headeræ¶ˆè´¹æ•°æ®ã€‚ 123456789101112131415161718192021 class Header extends React.Component &#123; render () &#123; return ( &lt;Title&gt;Hello React Context API&lt;/Title&gt; ); &#125;&#125; class Title extends React.Component &#123; render () &#123; return ( &lt;ThemeContext.Consumer&gt; &#123;context =&gt; ( &lt;h1 style=&#123;&#123;background: context.background, color: context.color&#125;&#125;&gt; &#123;this.props.children&#125; &lt;/h1&gt; )&#125; &lt;/ThemeContext.Consumer&gt; ); &#125;&#125; å¦‚æžœåœ¨render Consumerçš„æ—¶å€™æ²¡æœ‰åµŒå¥—åœ¨ä¸€ä¸ªProvideré‡Œé¢ã€‚é‚£ä¹ˆå°±ä¼šä½¿ç”¨createContextæ–¹æ³•è°ƒç”¨çš„æ—¶å€™è®¾ç½®çš„é»˜è®¤å€¼ã€‚ æ³¨æ„ï¼šConsumerå¿…é¡»å¯ä»¥è®¿é—®åˆ°åŒä¸€ä¸ªContextç»„ä»¶ã€‚å¦‚æžœä½ è¦åˆ›å»ºä¸€ä¸ªæ–°çš„contextï¼Œç”¨çš„æ˜¯åŒæ ·çš„å…¥å‚ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°å»ºçš„contextçš„æ•°æ®æ˜¯ä¸å¯è®¿é—®çš„ã€‚å› æ­¤ï¼Œå¯ä»¥æŠŠContextå½“åšä¸€ä¸ªç»„ä»¶ï¼Œå®ƒå¯ä»¥åˆ›å»ºä¸€æ¬¡ï¼Œç„¶åŽå¯ä»¥exportï¼Œå¯ä»¥importã€‚ è¿™ä¸ªæ–°çš„è¯­æ³•ç”¨äº†function as childæ¨¡å¼ï¼ˆæœ‰æ—¶ä¹Ÿå«åšrender propæ¨¡å¼ï¼‰ã€‚å¦‚æžœä¸æ˜¯å¾ˆç†Ÿæ‚‰è¿™ä¸ªæ¨¡å¼ï¼Œé‚£ä¹ˆæŽ¨èä½ çœ‹ä¸€ä¸‹è¿™äº›æ–‡ç« ã€‚æ–°çš„APIä¸å†è¦æ±‚ä½ å£°æ˜ŽcontextPropsäº†ã€‚Contextä¼ é€’çš„æ•°æ®å’ŒContext.Providerç»„ä»¶çš„valueå±žæ€§æ˜¯ä¸€æ ·çš„ã€‚å¯¹Provideræ•°æ®çš„ä¿®æ”¹ä¼šå¼•èµ·æ‰€æœ‰çš„æ¶ˆè´¹è€…ï¼ˆconsumerï¼‰é‡ç»˜ã€‚ æ–°çš„å£°æ˜Žå‘¨æœŸæ–¹æ³•å‚è€ƒè¿™ä¸ªRFCã€‚æ–°çš„å£°æ˜Žå‘¨æœŸæ–¹æ³•ä¼šè¢«å¼•å…¥ï¼Œè€Œæ—§çš„ä¼šè¢«åºŸå¼ƒã€‚ è¿™ä¸€æ”¹å˜ä¸»è¦æ˜¯ä¸ºäº†å¼ºåˆ¶æŽ¨è¡Œæœ€ä½³å®žè·µã€‚ä½ å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« æ¥äº†è§£ä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¼šå˜å¾—å¾ˆè¯¡å¼‚ã€‚è¿™äº›æœ€ä½³æ¨¡å¼åœ¨React 16çš„å¼‚æ­¥ç»˜åˆ¶æ¨¡å¼(Async Mode)ä¸‹æ˜¾å¾—éžå¸¸é‡è¦ã€‚ è¦è¢«åºŸå¼ƒçš„æ–¹æ³•ï¼šcomponentWillMountâ€“&gt;ä½¿ç”¨componentDidMountä»£æ›¿componentWillUpdateâ€“&gt;ä½¿ç”¨componentDidUpdateä»£æ›¿componentWillReceivePropsâ€“&gt;ä½¿ç”¨ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼šstatic getDerivedStateFromPropsæ¥ä»£æ›¿ã€‚ ä¸è¿‡è¿™äº›å¹¶ä¸ä¼šç«‹åˆ»å‘ç”Ÿï¼Œä»–ä»¬å¯ä»¥ç”¨åˆ°React 16.4ã€‚åœ¨React 17é‡Œå°†è¢«å½»åº•ç§»é™¤ã€‚å¦‚æžœä½ å¼€å¯äº†StrictModeæˆ–è€…AsyncModeï¼Œå¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹å¼æ¥ä½¿ç”¨ï¼Œä½†æ˜¯ä¼šæ”¶åˆ°è­¦å‘Š UNSAFE_componentWillMount UNSAFE_componentWillReceiveProps UNSAFE_componentWillUpdate static getDerivedStateFromPropså½“componentWillReceivePropsæˆ‘ä»¬éœ€è¦å…¶ä»–çš„æ–¹å¼æ ¹æ®propsçš„å˜åŠ¨æ›´æ–°stateã€‚ç¤¾åŒºå†³å®šå¼•å…¥ä¸€ä¸ªæ–°çš„staticæ–¹æ³•æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚ ä»€ä¹ˆæ˜¯é™æ€æ–¹æ³•ï¼Ÿä¸€ä¸ªé™æ€æ–¹æ³•å°±æ˜¯å­˜åœ¨äºŽç±»å†…ï¼Œè€Œä¸æ˜¯ç±»çš„å®žä¾‹å†…çš„æ–¹æ³•ã€‚é™æ€æ–¹æ³•è®¿é—®ä¸åˆ°thisï¼Œå¹¶ä¸”åœ¨å£°æ˜Žçš„æ—¶å€™æœ‰staticå…³é”®å­—åœ¨å‰é¢ä¿®é¥°ã€‚ ä½†æ˜¯ï¼Œé—®é¢˜æ¥äº†ã€‚æ—¢ç„¶è¿™ä¸ªæ–¹æ³•æ²¡æœ‰åŠžæ³•è®¿é—®thisï¼Œé‚£ä¹ˆå¦‚ä½•è°ƒç”¨this.setStateå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ï¼Œä¸è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•ç›´æŽ¥è¿”å›žéœ€è¦æ›´æ–°çš„stateçš„æ•°æ®ï¼Œæˆ–è€…è¿”å›žnullï¼Œå¦‚æžœæ²¡æœ‰ä»€ä¹ˆéœ€è¦æ›´æ–°çš„è¯ã€‚ 1234567891011static getDerivedStateFromProps(nextProps, prevState) &#123; if(nextProps.currentRow === prevState.lastRow) &#123; return null; &#125; return &#123; lastRow: nextProps.currentRow, isCrollingDown: nextProps.curentRow &gt; prevState.lastRow &#125;&#125; è°ƒç”¨è¿™ä¸ªæ–¹æ³•å’Œä¹‹å‰è°ƒç”¨this.setStateçš„æ•ˆæžœæ˜¯ä¸€æ ·çš„ã€‚åªä¼šä¿®æ”¹è¿™äº›è¿”å›žçš„å€¼ï¼Œå¦‚æžœæ˜¯nullçš„è¯åˆ™ä¸ä¿®æ”¹stateã€‚stateçš„å…¶ä»–å€¼éƒ½ä¼šä¿ç•™ã€‚ å€¼å¾—æ³¨æ„æ˜¯ä½ éœ€è¦å®šä¹‰åˆå§‹stateçš„å€¼ã€‚æ— è®ºæ˜¯åœ¨constructoré‡Œï¼Œæˆ–è€…æ˜¯ç±»å±žæ€§ã€‚å¦åˆ™ä¼šæŠ¥è­¦å‘Šã€‚è¿™ä¸ªæ–¹æ³•getDerivedStateFromProps()ä¼šåœ¨ç¬¬ä¸€æ¬¡æŒ‚è½½å’Œé‡ç»˜çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨åˆ°ï¼Œå› æ­¤ä½ åŸºæœ¬ä¸ç”¨åœ¨constructoré‡Œæ ¹æ®ä¼ å…¥çš„propsæ¥setStateã€‚ å¦‚æžœå®šä¹‰äº†getDerivedStateFromPropsåŽï¼Œåˆå®šä¹‰äº†componentWillReceivePropsã€‚é‚£ä¹ˆï¼Œåªæœ‰å‰è€…ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä¸”ä½ ä¼šæ”¶åˆ°ä¸€ä¸ªè­¦å‘Šã€‚ ä¸€èˆ¬ä½ ä¼šä½¿ç”¨ä¸€ä¸ªå›žè°ƒæ¥ä¿è¯æŸäº›ä»£ç å®žåœ¨stateæ›´æ–°ä¹‹åŽæ‰è¢«è°ƒç”¨çš„ã€‚é‚£ä¹ˆï¼Œè¯·æŠŠè¿™äº›ä»£ç éƒ½ç§»åˆ°componentDidUpdateé‡Œã€‚å¦‚æžœä½ ä¸å–œæ¬¢ä½¿ç”¨staticå…³é”®å­—ï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿™æ ·ï¼š123ComponentName.getDerivedStateFromProps = (nextProps, prevState) =&gt; &#123; // Your code here&#125; static modeä¸¥æ ¼æ¨¡å¼æ˜¯ä¸€ä¸ªæ–°çš„æ–¹å¼æ¥ç¡®ä¿ä½ çš„ä»£ç æ˜¯æŒ‰ç…§æœ€ä½³å®žè·µå¼€å‘çš„ã€‚å®ƒå®žé™…æ˜¯ä¸€ä¸ªåœ¨React.StrictModeä¸‹çš„ç»„ä»¶ã€‚å®ƒå¯ä»¥ç”¨åœ¨ä½ çš„ç»„ä»¶æ ‘çš„ä»»ä½•ä¸€éƒ¨åˆ†ä¸Šã€‚ 123456789101112131415import &#123;StrictMode&#125; from 'react' class Application extends React.Component &#123; render() &#123; return ( &lt;StrictMode&gt; &lt;Context.Provider value=&#123;&#123;background: 'black', color: 'white'&#125;&#125;&gt; &lt;Header /&gt; &lt;Main /&gt; &lt;Footer /&gt; &lt;/Context.Provider&gt; &lt;/StrictMode&gt; ); &#125;&#125; å¦‚æžœä¸€ä¸ªåœ¨StricModeå­æ ‘é‡Œçš„ç»„ä»¶ä½¿ç”¨äº†componentWillMountæ–¹æ³•ï¼Œé‚£ä¹ˆä½ ä¼šçœ‹åˆ°ä¸€ä¸ªæŠ¥é”™æ¶ˆæ¯ã€‚ asyncModeå¼‚æ­¥æ¨¡å¼åœ¨React.unsafe_AsyncModeä¸‹ã€‚ä½¿ç”¨AsncModeä¹Ÿä¼šæ‰“å¼€StrictModeæ¨¡å¼ä¸‹çš„è­¦å‘Šã€‚]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç®€è¿°HTTPåè®®]]></title>
    <url>%2F2018%2F04%2F02%2FHTTP%2F%E7%AE%80%E8%BF%B0HTTP%E5%8D%8F%E8%AE%AE%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯HTTPåè®®åè®®æ˜¯æŒ‡è®¡ç®—æœºé€šä¿¡ç½‘ç»œä¸­ä¸¤å°è®¡ç®—æœºä¹‹é—´è¿›è¡Œé€šä¿¡æ‰€å¿…é¡»å…±åŒéµå®ˆçš„è§„å®šæˆ–è§„åˆ™ï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®(HTTP)æ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œå®ƒå…è®¸å°†è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€(HTML)æ–‡æ¡£ä»ŽWebæœåŠ¡å™¨ä¼ é€åˆ°å®¢æˆ·ç«¯çš„æµè§ˆå™¨ 1.è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼ŒHyperText Transfer Protocol)æ˜¯äº’è”ç½‘ä¸Šåº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ç½‘ç»œåè®®ä¹‹ä¸€ï¼Œæ‰€æœ‰çš„WWWæ–‡ä»¶å¿…é¡»éµå¾ªè¿™ä¸ªæ ‡å‡†ã€‚ 2.HTTPæ˜¯å®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ç«¯çš„è¯·æ±‚å’Œåº”ç­”çš„æ ‡å‡†ï¼ˆTCPï¼‰ã€‚å®¢æˆ·ç«¯æ˜¯ç»ˆç«¯ç”¨æˆ·ï¼ŒæœåŠ¡å™¨ç«¯æ˜¯ç½‘ç«™ã€‚é€šè¿‡ä½¿ç”¨Webæµè§ˆå™¨ã€ç½‘ç»œçˆ¬è™«æˆ–è€…å…¶å®ƒçš„å·¥å…·ï¼Œå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªåˆ°æœåŠ¡å™¨ä¸ŠæŒ‡å®šç«¯å£ï¼ˆé»˜è®¤ç«¯å£ä¸º80ï¼‰çš„HTTPè¯·æ±‚ã€‚ï¼ˆæˆ‘ä»¬ç§°è¿™ä¸ªå®¢æˆ·ç«¯ï¼‰å«ç”¨æˆ·ä»£ç†ï¼ˆuser agentï¼‰ã€‚åº”ç­”çš„æœåŠ¡å™¨ä¸Šå­˜å‚¨ç€ï¼ˆä¸€äº›ï¼‰èµ„æºï¼Œæ¯”å¦‚HTMLæ–‡ä»¶å’Œå›¾åƒã€‚ 3.ç”±HTTPå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œå»ºç«‹ä¸€ä¸ªåˆ°æœåŠ¡å™¨æŒ‡å®šç«¯å£ï¼ˆé»˜è®¤æ˜¯80ç«¯å£ï¼‰çš„TCPè¿žæŽ¥ã€‚HTTPæœåŠ¡å™¨åˆ™åœ¨é‚£ä¸ªç«¯å£ç›‘å¬å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ã€‚ä¸€æ—¦æ”¶åˆ°è¯·æ±‚ï¼ŒæœåŠ¡å™¨ï¼ˆå‘å®¢æˆ·ç«¯ï¼‰å‘å›žä¸€ä¸ªçŠ¶æ€è¡Œï¼Œæ¯”å¦‚â€HTTP/1.1 200 OKâ€ï¼Œå’Œï¼ˆå“åº”çš„ï¼‰æ¶ˆæ¯ï¼Œæ¶ˆæ¯çš„æ¶ˆæ¯ä½“å¯èƒ½æ˜¯è¯·æ±‚çš„æ–‡ä»¶ã€é”™è¯¯æ¶ˆæ¯ã€æˆ–è€…å…¶å®ƒä¸€äº›ä¿¡æ¯ã€‚ 4.HTTPä½¿ç”¨TCPè€Œä¸æ˜¯UDPçš„åŽŸå› åœ¨äºŽï¼ˆæ‰“å¼€ï¼‰ä¸€ä¸ªç½‘é¡µå¿…é¡»ä¼ é€å¾ˆå¤šæ•°æ®ï¼Œè€ŒTCPåè®®æä¾›ä¼ è¾“æŽ§åˆ¶ï¼ŒæŒ‰é¡ºåºç»„ç»‡æ•°æ®ï¼Œå’Œé”™è¯¯çº æ­£ã€‚ 5.ä¸€æ¬¡HTTPæ“ä½œç§°ä¸ºä¸€ä¸ªäº‹åŠ¡ï¼Œå…¶å·¥ä½œè¿‡ç¨‹å¯åˆ†ä¸ºå››æ­¥ï¼š 1),é¦–å…ˆå®¢æˆ·æœºä¸ŽæœåŠ¡å™¨éœ€è¦å»ºç«‹è¿žæŽ¥ã€‚åªè¦å•å‡»æŸä¸ªè¶…çº§é“¾æŽ¥ï¼ŒHTTPçš„å·¥ä½œå°±å¼€å§‹äº†ã€‚ 2),å»ºç«‹è¿žæŽ¥åŽï¼Œå®¢æˆ·æœºå‘é€ä¸€ä¸ªè¯·æ±‚ç»™æœåŠ¡å™¨ï¼Œè¯·æ±‚æ–¹å¼çš„æ ¼å¼ä¸ºï¼šç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆURLï¼‰ã€åè®®ç‰ˆæœ¬å·ï¼ŒåŽè¾¹æ˜¯MIMEä¿¡æ¯åŒ…æ‹¬è¯·æ±‚ä¿®é¥°ç¬¦ã€å®¢æˆ·æœºä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚ 3),æœåŠ¡å™¨æŽ¥åˆ°è¯·æ±‚åŽï¼Œç»™äºˆç›¸åº”çš„å“åº”ä¿¡æ¯ï¼Œå…¶æ ¼å¼ä¸ºä¸€ä¸ªçŠ¶æ€è¡Œï¼ŒåŒ…æ‹¬ä¿¡æ¯çš„åè®®ç‰ˆæœ¬å·ã€ä¸€ä¸ªæˆåŠŸæˆ–é”™è¯¯çš„ä»£ç ï¼ŒåŽè¾¹æ˜¯MIMEä¿¡æ¯åŒ…æ‹¬æœåŠ¡å™¨ä¿¡æ¯ã€å®žä½“ä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚ 4),å®¢æˆ·ç«¯æŽ¥æ”¶æœåŠ¡å™¨æ‰€è¿”å›žçš„ä¿¡æ¯é€šè¿‡æµè§ˆå™¨æ˜¾ç¤ºåœ¨ç”¨æˆ·çš„æ˜¾ç¤ºå±ä¸Šï¼Œç„¶åŽå®¢æˆ·æœºä¸ŽæœåŠ¡å™¨æ–­å¼€è¿žæŽ¥ã€‚ å¦‚æžœåœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­çš„æŸä¸€æ­¥å‡ºçŽ°é”™è¯¯ï¼Œé‚£ä¹ˆäº§ç”Ÿé”™è¯¯çš„ä¿¡æ¯å°†è¿”å›žåˆ°å®¢æˆ·ç«¯ï¼Œç”±æ˜¾ç¤ºå±è¾“å‡ºã€‚å¯¹äºŽç”¨æˆ·æ¥è¯´ï¼Œè¿™äº›è¿‡ç¨‹æ˜¯ç”±HTTPè‡ªå·±å®Œæˆçš„ï¼Œç”¨æˆ·åªè¦ç”¨é¼ æ ‡ç‚¹å‡»ï¼Œç­‰å¾…ä¿¡æ¯æ˜¾ç¤ºå°±å¯ä»¥äº†ã€‚ HTTPæŠ¥æ–‡ç”±ä»Žå®¢æˆ·æœºåˆ°æœåŠ¡å™¨çš„è¯·æ±‚å’Œä»ŽæœåŠ¡å™¨åˆ°å®¢æˆ·æœºçš„å“åº”æž„æˆã€‚ è¯·æ±‚æŠ¥æ–‡æ ¼å¼å¦‚ä¸‹ï¼š è¯·æ±‚è¡Œ ï¼ é€šç”¨ä¿¡æ¯å¤´ ï¼ è¯·æ±‚å¤´ ï¼ å®žä½“å¤´ ï¼ æŠ¥æ–‡ä¸»ä½“ è¯·æ±‚è¡Œä»¥æ–¹æ³•å­—æ®µå¼€å§‹ï¼ŒåŽé¢åˆ†åˆ«æ˜¯ URL å­—æ®µå’Œ HTTP åè®®ç‰ˆæœ¬å­—æ®µï¼Œå¹¶ä»¥ CRLF ç»“å°¾ã€‚SP æ˜¯åˆ†éš”ç¬¦ã€‚é™¤äº†åœ¨æœ€åŽçš„ CRLF åºåˆ—ä¸­ CF å’Œ LF æ˜¯å¿…éœ€çš„ä¹‹å¤–ï¼Œå…¶ä»–éƒ½å¯ä»¥ä¸è¦ã€‚æœ‰å…³é€šç”¨ä¿¡æ¯å¤´ï¼Œè¯·æ±‚å¤´å’Œå®žä½“å¤´æ–¹é¢çš„å…·ä½“å†…å®¹å¯ä»¥å‚ç…§ç›¸å…³æ–‡ä»¶ã€‚ åº”ç­”æŠ¥æ–‡æ ¼å¼å¦‚ä¸‹ï¼š çŠ¶æ€è¡Œ ï¼ é€šç”¨ä¿¡æ¯å¤´ ï¼ å“åº”å¤´ ï¼ å®žä½“å¤´ ï¼ æŠ¥æ–‡ä¸»ä½“ çŠ¶æ€ç å…ƒç”±3ä½æ•°å­—ç»„æˆï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦è¢«ç†è§£æˆ–è¢«æ»¡è¶³ã€‚åŽŸå› åˆ†æžæ˜¯å¯¹åŽŸæ–‡çš„çŠ¶æ€ç ä½œç®€çŸ­çš„æè¿°ï¼ŒçŠ¶æ€ç ç”¨æ¥æ”¯æŒè‡ªåŠ¨æ“ä½œï¼Œè€ŒåŽŸå› åˆ†æžç”¨æ¥ä¾›ç”¨æˆ·ä½¿ç”¨ã€‚å®¢æˆ·æœºæ— éœ€ç”¨æ¥æ£€æŸ¥æˆ–æ˜¾ç¤ºè¯­æ³•ã€‚æœ‰å…³é€šç”¨ä¿¡æ¯å¤´ï¼Œå“åº”å¤´å’Œå®žä½“å¤´æ–¹é¢çš„å…·ä½“å†…å®¹å¯ä»¥å‚ç…§ç›¸å…³æ–‡ä»¶ã€‚ 7.é€šç”¨å¤´åŸŸåŒ…å«è¯·æ±‚å’Œå“åº”æ¶ˆæ¯éƒ½æ”¯æŒçš„å¤´åŸŸï¼Œé€šç”¨å¤´åŸŸåŒ…å«Cache-Controlã€Connectionã€Dateã€Pragmaã€Transfer-Encodingã€Upgradeã€Viaã€‚å¯¹é€šç”¨å¤´åŸŸçš„æ‰©å±•è¦æ±‚é€šè®¯åŒæ–¹éƒ½æ”¯æŒæ­¤æ‰©å±•ï¼Œå¦‚æžœå­˜åœ¨ä¸æ”¯æŒçš„é€šç”¨å¤´åŸŸï¼Œä¸€èˆ¬å°†ä¼šä½œä¸ºå®žä½“å¤´åŸŸå¤„ç†ã€‚ è¯·æ±‚æ¶ˆæ¯çš„ç¬¬ä¸€è¡Œä¸ºï¼šMethodSPRequest-URISPHTTP-VersionCRLFMethodè¡¨ç¤ºå¯¹äºŽRequest-URIå®Œæˆçš„æ–¹æ³•ï¼Œè¿™ä¸ªå­—æ®µæ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼ŒåŒ…æ‹¬OPTIONSã€GETã€HEADã€POSTã€PUTã€DELETEã€TRACEã€‚æ–¹æ³•GETå’ŒHEADåº”è¯¥è¢«æ‰€æœ‰çš„é€šç”¨WEBæœåŠ¡å™¨æ”¯æŒï¼Œå…¶ä»–æ‰€æœ‰æ–¹æ³•çš„å®žçŽ°æ˜¯å¯é€‰çš„ã€‚GETæ–¹æ³•å–å›žç”±Request-URIæ ‡è¯†çš„ä¿¡æ¯ã€‚HEADæ–¹æ³•ä¹Ÿæ˜¯å–å›žç”±Request-URIæ ‡è¯†çš„ä¿¡æ¯ï¼Œåªæ˜¯å¯ä»¥åœ¨å“åº”æ—¶ï¼Œä¸è¿”å›žæ¶ˆæ¯ä½“ã€‚POSTæ–¹æ³•å¯ä»¥è¯·æ±‚æœåŠ¡å™¨æŽ¥æ”¶åŒ…å«åœ¨è¯·æ±‚ä¸­çš„å®žä½“ä¿¡æ¯ï¼Œå¯ä»¥ç”¨äºŽæäº¤è¡¨å•ï¼Œå‘æ–°é—»ç»„ã€BBSã€é‚®ä»¶ç¾¤ç»„å’Œæ•°æ®åº“å‘é€æ¶ˆæ¯ã€‚ å“åº”æ¶ˆæ¯çš„ç¬¬ä¸€è¡Œçš„æ ¼å¼ä¸ºï¼šHTTP-VersionSPStatus-CodeSPReason-PhraseCRLFã€‚HTTP-Versionè¡¨ç¤ºæ”¯æŒçš„HTTPç‰ˆæœ¬ï¼Œä¾‹å¦‚ä¸ºHTTP/1.1ã€‚Status-Codeæ˜¯ä¸€ä¸ªä¸‰ä¸ªæ•°å­—çš„ç»“æžœä»£ç ã€‚Reason-Phraseç»™Status-Codeæä¾›ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æè¿°ã€‚Status-Codeä¸»è¦ç”¨äºŽæœºå™¨è‡ªåŠ¨è¯†åˆ«ï¼ŒReason-Phraseä¸»è¦ç”¨äºŽå¸®åŠ©ç”¨æˆ·ç†è§£ã€‚Status-Codeçš„ç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰å“åº”çš„ç±»åˆ«ï¼ŒåŽä¸¤ä¸ªæ•°å­—æ²¡æœ‰åˆ†ç±»çš„ä½œç”¨ã€‚ è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯éƒ½å¯ä»¥åŒ…å«å®žä½“ä¿¡æ¯ï¼Œå®žä½“ä¿¡æ¯ä¸€èˆ¬ç”±å®žä½“å¤´åŸŸå’Œå®žä½“ç»„æˆã€‚å®žä½“å¤´åŸŸåŒ…å«å…³äºŽå®žä½“çš„åŽŸä¿¡æ¯ï¼Œå®žä½“å¤´åŒ…æ‹¬Allowã€Content-Baseã€Content-Encodingã€Content-Languageã€Content-Lengthã€Content-Locationã€Content-MD5ã€Content-Rangeã€Content-Typeã€Etagã€Expiresã€Last-Modifiedã€extension-headerã€‚extension-headerå…è®¸å®¢æˆ·ç«¯å®šä¹‰æ–°çš„å®žä½“å¤´ï¼Œä½†æ˜¯è¿™äº›åŸŸå¯èƒ½æ— æ³•è¢«æŽ¥å—æ–¹è¯†åˆ«ã€‚å®žä½“å¯ä»¥æ˜¯ä¸€ä¸ªç»è¿‡ç¼–ç çš„å­—èŠ‚æµï¼Œå®ƒçš„ç¼–ç æ–¹å¼ç”±Content-Encodingæˆ–Content-Typeå®šä¹‰ï¼Œå®ƒçš„é•¿åº¦ç”±Content-Lengthæˆ–Content-Rangeå®šä¹‰ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>HTTP</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Http åè®®è¯¦è§£]]></title>
    <url>%2F2018%2F04%2F02%2FHTTP%2FHttp-%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[å¼•è¨€HTTPæ˜¯ä¸€ä¸ªå±žäºŽåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œç”±äºŽå…¶ç®€æ·ã€å¿«é€Ÿçš„æ–¹å¼ï¼Œé€‚ç”¨äºŽåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚å®ƒäºŽ1990å¹´æå‡ºï¼Œç»è¿‡å‡ å¹´çš„ä½¿ç”¨ä¸Žå‘å±•ï¼Œå¾—åˆ°ä¸æ–­åœ°å®Œå–„å’Œæ‰©å±•ã€‚ç›®å‰åœ¨WWWä¸­ä½¿ç”¨çš„æ˜¯HTTP/1.0çš„ç¬¬å…­ç‰ˆï¼ŒHTTP/1.1çš„è§„èŒƒåŒ–å·¥ä½œæ­£åœ¨è¿›è¡Œä¹‹ä¸­ï¼Œè€Œä¸”HTTP-NG(Next Generation of HTTP)çš„å»ºè®®å·²ç»æå‡ºã€‚ HTTPåè®®çš„ä¸»è¦ç‰¹ç‚¹å¯æ¦‚æ‹¬å¦‚ä¸‹ï¼š1.æ”¯æŒå®¢æˆ·/æœåŠ¡å™¨æ¨¡å¼ã€‚2.ç®€å•å¿«é€Ÿï¼šå®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰GETã€HEADã€POSTã€‚æ¯ç§æ–¹æ³•è§„å®šäº†å®¢æˆ·ä¸ŽæœåŠ¡å™¨è”ç³»çš„ç±»åž‹ä¸åŒã€‚ç”±äºŽHTTPåè®®ç®€å•ï¼Œä½¿å¾—HTTPæœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œé€šä¿¡é€Ÿåº¦å¾ˆå¿«ã€‚3.çµæ´»ï¼šHTTPå…è®¸ä¼ è¾“ä»»æ„ç±»åž‹çš„æ•°æ®å¯¹è±¡ã€‚æ­£åœ¨ä¼ è¾“çš„ç±»åž‹ç”±Content-TypeåŠ ä»¥æ ‡è®°4.æ— è¿žæŽ¥ï¼šæ— è¿žæŽ¥çš„å«ä¹‰æ˜¯é™åˆ¶æ¯æ¬¡è¿žæŽ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åŽï¼Œå³æ–­å¼€è¿žæŽ¥ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚5.æ— çŠ¶æ€ï¼šHTTPåè®®æ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºŽäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æžœåŽç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿žæŽ¥ä¼ é€çš„æ•°æ®é‡å¢žå¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±è¾ƒå¿«ã€‚ HTTPåè®®è¯¦è§£ä¹‹URLç¯‡http(è¶…æ–‡æœ¬ä¼ è¾“åè®®) æ˜¯ä¸€ä¸ªåŸºäºŽè¯·æ±‚ä¸Žå“åº”æ¨¡å¼çš„ã€æ— çŠ¶æ€çš„ã€åº”ç”¨å±‚çš„åè®®ï¼Œå¸¸åŸºäºŽTCPçš„è¿žæŽ¥æ–¹å¼ï¼ŒHTTP1.1ç‰ˆæœ¬ä¸­ç»™å‡ºä¸€ç§æŒç»­è¿žæŽ¥çš„æœºåˆ¶ï¼Œç»å¤§å¤šæ•°çš„Webå¼€å‘ï¼Œéƒ½æ˜¯æž„å»ºåœ¨HTTPåè®®ä¹‹ä¸Šçš„Webåº”ç”¨ã€‚ HTTP URL (URLæ˜¯ä¸€ç§ç‰¹æ®Šç±»åž‹çš„URIï¼ŒåŒ…å«äº†ç”¨äºŽæŸ¥æ‰¾æŸä¸ªèµ„æºçš„è¶³å¤Ÿçš„ä¿¡æ¯)çš„æ ¼å¼å¦‚ä¸‹ï¼šhttp://host[&quot;:&quot;port][abs_path] httpè¡¨ç¤ºè¦é€šè¿‡HTTPåè®®æ¥å®šä½ç½‘ç»œèµ„æºï¼›hostè¡¨ç¤ºåˆæ³•çš„Internetä¸»æœºåŸŸåæˆ–è€…IPåœ°å€ï¼›portæŒ‡å®šä¸€ä¸ªç«¯å£å·ï¼Œä¸ºç©ºåˆ™ä½¿ç”¨ç¼ºçœç«¯å£80ï¼›abs_pathæŒ‡å®šè¯·æ±‚èµ„æºçš„URIï¼›å¦‚æžœURLä¸­æ²¡æœ‰ç»™å‡ºabs_pathï¼Œé‚£ä¹ˆå½“å®ƒä½œä¸ºè¯·æ±‚URIæ—¶ï¼Œå¿…é¡»ä»¥â€œ/â€çš„å½¢å¼ç»™å‡ºï¼Œé€šå¸¸è¿™ä¸ªå·¥ä½œæµè§ˆå™¨è‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆã€‚ eg:1ã€è¾“å…¥ï¼šwww.guet.edu.cnæµè§ˆå™¨è‡ªåŠ¨è½¬æ¢æˆï¼šhttp://www.guet.edu.cn/2ã€http:192.168.0.116:8080/index.jsp HTTPåè®®è¯¦è§£ä¹‹è¯·æ±‚ç¯‡httpè¯·æ±‚ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šè¯·æ±‚è¡Œã€æ¶ˆæ¯æŠ¥å¤´ã€è¯·æ±‚æ­£æ–‡ 1ã€è¯·æ±‚è¡Œä»¥ä¸€ä¸ªæ–¹æ³•ç¬¦å·å¼€å¤´ï¼Œä»¥ç©ºæ ¼åˆ†å¼€ï¼ŒåŽé¢è·Ÿç€è¯·æ±‚çš„URIå’Œåè®®çš„ç‰ˆæœ¬ï¼Œæ ¼å¼å¦‚ä¸‹ï¼šMethod Request-URI HTTP-Version CRLFå…¶ä¸­ Methodè¡¨ç¤ºè¯·æ±‚æ–¹æ³•ï¼›Request-URIæ˜¯ä¸€ä¸ªç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼›HTTP-Versionè¡¨ç¤ºè¯·æ±‚çš„HTTPåè®®ç‰ˆæœ¬ï¼›CRLFè¡¨ç¤ºå›žè½¦å’Œæ¢è¡Œï¼ˆé™¤äº†ä½œä¸ºç»“å°¾çš„CRLFå¤–ï¼Œä¸å…è®¸å‡ºçŽ°å•ç‹¬çš„CRæˆ–LFå­—ç¬¦ï¼‰ã€‚ è¯·æ±‚æ–¹æ³•ï¼ˆæ‰€æœ‰æ–¹æ³•å…¨ä¸ºå¤§å†™ï¼‰æœ‰å¤šç§ï¼Œå„ä¸ªæ–¹æ³•çš„è§£é‡Šå¦‚ä¸‹ï¼šGET è¯·æ±‚èŽ·å–Request-URIæ‰€æ ‡è¯†çš„èµ„æºPOST åœ¨Request-URIæ‰€æ ‡è¯†çš„èµ„æºåŽé™„åŠ æ–°çš„æ•°æ®HEAD è¯·æ±‚èŽ·å–ç”±Request-URIæ‰€æ ‡è¯†çš„èµ„æºçš„å“åº”æ¶ˆæ¯æŠ¥å¤´PUT è¯·æ±‚æœåŠ¡å™¨å­˜å‚¨ä¸€ä¸ªèµ„æºï¼Œå¹¶ç”¨Request-URIä½œä¸ºå…¶æ ‡è¯†DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤Request-URIæ‰€æ ‡è¯†çš„èµ„æºTRACE è¯·æ±‚æœåŠ¡å™¨å›žé€æ”¶åˆ°çš„è¯·æ±‚ä¿¡æ¯ï¼Œä¸»è¦ç”¨äºŽæµ‹è¯•æˆ–è¯Šæ–­CONNECT ä¿ç•™å°†æ¥ä½¿ç”¨OPTIONS è¯·æ±‚æŸ¥è¯¢æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œæˆ–è€…æŸ¥è¯¢ä¸Žèµ„æºç›¸å…³çš„é€‰é¡¹å’Œéœ€æ±‚ åº”ç”¨ç¤ºä¾‹GETæ–¹æ³•ï¼šåœ¨æµè§ˆå™¨çš„åœ°å€æ ä¸­è¾“å…¥ç½‘å€çš„æ–¹å¼è®¿é—®ç½‘é¡µæ—¶ï¼Œæµè§ˆå™¨é‡‡ç”¨GETæ–¹æ³•å‘æœåŠ¡å™¨èŽ·å–èµ„æºï¼Œeg:GET /form.html HTTP/1.1 (CRLF) POSTæ–¹æ³•è¦æ±‚è¢«è¯·æ±‚æœåŠ¡å™¨æŽ¥å—é™„åœ¨è¯·æ±‚åŽé¢çš„æ•°æ®ï¼Œå¸¸ç”¨äºŽæäº¤è¡¨å•ã€‚egï¼šPOST /reg.jsp HTTP/ (CRLF)Accept:image/gif,image/x-xbit,â€¦ (CRLF)â€¦HOST:www.guet.edu.cn (CRLF)Content-Length:22 (CRLF)Connection:Keep-Alive (CRLF)Cache-Control:no-cache (CRLF)(CRLF) //è¯¥CRLFè¡¨ç¤ºæ¶ˆæ¯æŠ¥å¤´å·²ç»ç»“æŸï¼Œåœ¨æ­¤ä¹‹å‰ä¸ºæ¶ˆæ¯æŠ¥å¤´user=jeffrey&amp;pwd=1234 //æ­¤è¡Œä»¥ä¸‹ä¸ºæäº¤çš„æ•°æ® HEADæ–¹æ³•ä¸ŽGETæ–¹æ³•å‡ ä¹Žæ˜¯ä¸€æ ·çš„ï¼Œå¯¹äºŽHEADè¯·æ±‚çš„å›žåº”éƒ¨åˆ†æ¥è¯´ï¼Œå®ƒçš„HTTPå¤´éƒ¨ä¸­åŒ…å«çš„ä¿¡æ¯ä¸Žé€šè¿‡GETè¯·æ±‚æ‰€å¾—åˆ°çš„ä¿¡æ¯æ˜¯ç›¸åŒçš„ã€‚åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¸å¿…ä¼ è¾“æ•´ä¸ªèµ„æºå†…å®¹ï¼Œå°±å¯ä»¥å¾—åˆ°Request-URIæ‰€æ ‡è¯†çš„èµ„æºçš„ä¿¡æ¯ã€‚è¯¥æ–¹æ³•å¸¸ç”¨äºŽæµ‹è¯•è¶…é“¾æŽ¥çš„æœ‰æ•ˆæ€§ï¼Œæ˜¯å¦å¯ä»¥è®¿é—®ï¼Œä»¥åŠæœ€è¿‘æ˜¯å¦æ›´æ–°ã€‚ 2ã€è¯·æ±‚æŠ¥å¤´åŽè¿°3ã€è¯·æ±‚æ­£æ–‡(ç•¥)HTTPåè®®è¯¦è§£ä¹‹å“åº”ç¯‡åœ¨æŽ¥æ”¶å’Œè§£é‡Šè¯·æ±‚æ¶ˆæ¯åŽï¼ŒæœåŠ¡å™¨è¿”å›žä¸€ä¸ªHTTPå“åº”æ¶ˆæ¯ã€‚HTTPå“åº”ä¹Ÿæ˜¯ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šçŠ¶æ€è¡Œã€æ¶ˆæ¯æŠ¥å¤´ã€å“åº”æ­£æ–‡ 1.çŠ¶æ€è¡Œæ ¼å¼å¦‚ä¸‹ï¼šHTTP-Version Status-Code Reason-Phrase CRLFå…¶ä¸­ï¼ŒHTTP-Versionè¡¨ç¤ºæœåŠ¡å™¨HTTPåè®®çš„ç‰ˆæœ¬ï¼›Status-Codeè¡¨ç¤ºæœåŠ¡å™¨å‘å›žçš„å“åº”çŠ¶æ€ä»£ç ï¼›Reason-Phraseè¡¨ç¤ºçŠ¶æ€ä»£ç çš„æ–‡æœ¬æè¿°ã€‚ çŠ¶æ€ä»£ç æœ‰ä¸‰ä½æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰äº†å“åº”çš„ç±»åˆ«ï¼Œä¸”æœ‰äº”ç§å¯èƒ½å–å€¼ï¼š1xxï¼šæŒ‡ç¤ºä¿¡æ¯â€“è¡¨ç¤ºè¯·æ±‚å·²æŽ¥æ”¶ï¼Œç»§ç»­å¤„ç†2xxï¼šæˆåŠŸâ€“è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæŽ¥æ”¶ã€ç†è§£ã€æŽ¥å—3xxï¼šé‡å®šå‘â€“è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ“ä½œ4xxï¼šå®¢æˆ·ç«¯é”™è¯¯â€“è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®žçŽ°5xxï¼šæœåŠ¡å™¨ç«¯é”™è¯¯â€“æœåŠ¡å™¨æœªèƒ½å®žçŽ°åˆæ³•çš„è¯·æ±‚ å¸¸è§çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°ã€è¯´æ˜Žï¼š200 OK //å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ400 Bad Request //å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£401 Unauthorized //è¯·æ±‚æœªç»æŽˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’ŒWWW-AuthenticateæŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨403 Forbidden //æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡404 Not Found //è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œegï¼šè¾“å…¥äº†é”™è¯¯çš„URL500 Internal Server Error //æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯503 Server Unavailable //æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åŽå¯èƒ½æ¢å¤æ­£å¸¸egï¼šHTTP/1.1 200 OK ï¼ˆCRLFï¼‰ 2.å“åº”æŠ¥å¤´åŽè¿°3.å“åº”æ­£æ–‡å°±æ˜¯æœåŠ¡å™¨è¿”å›žçš„èµ„æºçš„å†…å®¹HTTPåè®®è¯¦è§£ä¹‹æ¶ˆæ¯æŠ¥å¤´ç¯‡ HTTPæ¶ˆæ¯ç”±å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„è¯·æ±‚å’ŒæœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯çš„å“åº”ç»„æˆã€‚è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯éƒ½æ˜¯ç”±å¼€å§‹è¡Œï¼ˆå¯¹äºŽè¯·æ±‚æ¶ˆæ¯ï¼Œå¼€å§‹è¡Œå°±æ˜¯è¯·æ±‚è¡Œï¼Œå¯¹äºŽå“åº”æ¶ˆæ¯ï¼Œå¼€å§‹è¡Œå°±æ˜¯çŠ¶æ€è¡Œï¼‰ï¼Œæ¶ˆæ¯æŠ¥å¤´ï¼ˆå¯é€‰ï¼‰ï¼Œç©ºè¡Œï¼ˆåªæœ‰CRLFçš„è¡Œï¼‰ï¼Œæ¶ˆæ¯æ­£æ–‡ï¼ˆå¯é€‰ï¼‰ç»„æˆã€‚ HTTPæ¶ˆæ¯æŠ¥å¤´åŒ…æ‹¬æ™®é€šæŠ¥å¤´ã€è¯·æ±‚æŠ¥å¤´ã€å“åº”æŠ¥å¤´ã€å®žä½“æŠ¥å¤´ã€‚æ¯ä¸€ä¸ªæŠ¥å¤´åŸŸéƒ½æ˜¯ç”±åå­—+â€œï¼šâ€+ç©ºæ ¼+å€¼ ç»„æˆï¼Œæ¶ˆæ¯æŠ¥å¤´åŸŸçš„åå­—æ˜¯å¤§å°å†™æ— å…³çš„ã€‚ æ™®é€šæŠ¥å¤´åœ¨æ™®é€šæŠ¥å¤´ä¸­ï¼Œæœ‰å°‘æ•°æŠ¥å¤´åŸŸç”¨äºŽæ‰€æœ‰çš„è¯·æ±‚å’Œå“åº”æ¶ˆæ¯ï¼Œä½†å¹¶ä¸ç”¨äºŽè¢«ä¼ è¾“çš„å®žä½“ï¼Œåªç”¨äºŽä¼ è¾“çš„æ¶ˆæ¯ã€‚ egï¼šCache-Control ç”¨äºŽæŒ‡å®šç¼“å­˜æŒ‡ä»¤ï¼Œç¼“å­˜æŒ‡ä»¤æ˜¯å•å‘çš„ï¼ˆå“åº”ä¸­å‡ºçŽ°çš„ç¼“å­˜æŒ‡ä»¤åœ¨è¯·æ±‚ä¸­æœªå¿…ä¼šå‡ºçŽ°ï¼‰ï¼Œä¸”æ˜¯ç‹¬ç«‹çš„ï¼ˆä¸€ä¸ªæ¶ˆæ¯çš„ç¼“å­˜æŒ‡ä»¤ä¸ä¼šå½±å“å¦ä¸€ä¸ªæ¶ˆæ¯å¤„ç†çš„ç¼“å­˜æœºåˆ¶ï¼‰ï¼ŒHTTP1.0ä½¿ç”¨çš„ç±»ä¼¼çš„æŠ¥å¤´åŸŸä¸ºPragmaã€‚è¯·æ±‚æ—¶çš„ç¼“å­˜æŒ‡ä»¤åŒ…æ‹¬ï¼šno-cacheï¼ˆç”¨äºŽæŒ‡ç¤ºè¯·æ±‚æˆ–å“åº”æ¶ˆæ¯ä¸èƒ½ç¼“å­˜ï¼‰ã€no-storeã€max-ageã€max-staleã€min-freshã€only-if-cached; å“åº”æ—¶çš„ç¼“å­˜æŒ‡ä»¤åŒ…æ‹¬ï¼špublicã€privateã€no-cacheã€no-storeã€no-transformã€must-revalidateã€proxy-revalidateã€max-ageã€s-maxage. egï¼šä¸ºäº†æŒ‡ç¤ºIEæµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸è¦ç¼“å­˜é¡µé¢ï¼ŒæœåŠ¡å™¨ç«¯çš„JSPç¨‹åºå¯ä»¥ç¼–å†™å¦‚ä¸‹ï¼šresponse.sehHeader(â€œCache-Controlâ€,â€no-cacheâ€);//response.setHeader(â€œPragmaâ€,â€no-cacheâ€);ä½œç”¨ç›¸å½“äºŽä¸Šè¿°ä»£ç ï¼Œé€šå¸¸ä¸¤è€…//åˆç”¨è¿™å¥ä»£ç å°†åœ¨å‘é€çš„å“åº”æ¶ˆæ¯ä¸­è®¾ç½®æ™®é€šæŠ¥å¤´åŸŸï¼šCache-Control:no-cache Dateæ™®é€šæŠ¥å¤´åŸŸè¡¨ç¤ºæ¶ˆæ¯äº§ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´ Connectionæ™®é€šæŠ¥å¤´åŸŸå…è®¸å‘é€æŒ‡å®šè¿žæŽ¥çš„é€‰é¡¹ã€‚ä¾‹å¦‚æŒ‡å®šè¿žæŽ¥æ˜¯è¿žç»­ï¼Œæˆ–è€…æŒ‡å®šâ€œcloseâ€é€‰é¡¹ï¼Œé€šçŸ¥æœåŠ¡å™¨ï¼Œåœ¨å“åº”å®ŒæˆåŽï¼Œå…³é—­è¿žæŽ¥ è¯·æ±‚æŠ¥å¤´è¯·æ±‚æŠ¥å¤´å…è®¸å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯ä¼ é€’è¯·æ±‚çš„é™„åŠ ä¿¡æ¯ä»¥åŠå®¢æˆ·ç«¯è‡ªèº«çš„ä¿¡æ¯ã€‚ å¸¸ç”¨çš„è¯·æ±‚æŠ¥å¤´1.AcceptAcceptè¯·æ±‚æŠ¥å¤´åŸŸç”¨äºŽæŒ‡å®šå®¢æˆ·ç«¯æŽ¥å—å“ªäº›ç±»åž‹çš„ä¿¡æ¯ã€‚egï¼šAcceptï¼šimage/gifï¼Œè¡¨æ˜Žå®¢æˆ·ç«¯å¸Œæœ›æŽ¥å—GIFå›¾è±¡æ ¼å¼çš„èµ„æºï¼›Acceptï¼štext/htmlï¼Œè¡¨æ˜Žå®¢æˆ·ç«¯å¸Œæœ›æŽ¥å—htmlæ–‡æœ¬ã€‚2.Accept-CharsetAccept-Charsetè¯·æ±‚æŠ¥å¤´åŸŸç”¨äºŽæŒ‡å®šå®¢æˆ·ç«¯æŽ¥å—çš„å­—ç¬¦é›†ã€‚egï¼šAccept-Charset:iso-8859-1,gb2312.å¦‚æžœåœ¨è¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªåŸŸï¼Œç¼ºçœæ˜¯ä»»ä½•å­—ç¬¦é›†éƒ½å¯ä»¥æŽ¥å—ã€‚3.Accept-EncodingAccept-Encodingè¯·æ±‚æŠ¥å¤´åŸŸç±»ä¼¼äºŽAcceptï¼Œä½†æ˜¯å®ƒæ˜¯ç”¨äºŽæŒ‡å®šå¯æŽ¥å—çš„å†…å®¹ç¼–ç ã€‚egï¼šAccept-Encoding:gzip.deflate.å¦‚æžœè¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªåŸŸæœåŠ¡å™¨å‡å®šå®¢æˆ·ç«¯å¯¹å„ç§å†…å®¹ç¼–ç éƒ½å¯ä»¥æŽ¥å—ã€‚4.Accept-LanguageAccept-Languageè¯·æ±‚æŠ¥å¤´åŸŸç±»ä¼¼äºŽAcceptï¼Œä½†æ˜¯å®ƒæ˜¯ç”¨äºŽæŒ‡å®šä¸€ç§è‡ªç„¶è¯­è¨€ã€‚egï¼šAccept-Language:zh-cn.å¦‚æžœè¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªæŠ¥å¤´åŸŸï¼ŒæœåŠ¡å™¨å‡å®šå®¢æˆ·ç«¯å¯¹å„ç§è¯­è¨€éƒ½å¯ä»¥æŽ¥å—ã€‚5.AuthorizationAuthorizationè¯·æ±‚æŠ¥å¤´åŸŸä¸»è¦ç”¨äºŽè¯æ˜Žå®¢æˆ·ç«¯æœ‰æƒæŸ¥çœ‹æŸä¸ªèµ„æºã€‚å½“æµè§ˆå™¨è®¿é—®ä¸€ä¸ªé¡µé¢æ—¶ï¼Œå¦‚æžœæ”¶åˆ°æœåŠ¡å™¨çš„å“åº”ä»£ç ä¸º401ï¼ˆæœªæŽˆæƒï¼‰ï¼Œå¯ä»¥å‘é€ä¸€ä¸ªåŒ…å«Authorizationè¯·æ±‚æŠ¥å¤´åŸŸçš„è¯·æ±‚ï¼Œè¦æ±‚æœåŠ¡å™¨å¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚ Hostï¼ˆå‘é€è¯·æ±‚æ—¶ï¼Œè¯¥æŠ¥å¤´åŸŸæ˜¯å¿…éœ€çš„ï¼‰ Hostè¯·æ±‚æŠ¥å¤´åŸŸä¸»è¦ç”¨äºŽæŒ‡å®šè¢«è¯·æ±‚èµ„æºçš„Internetä¸»æœºå’Œç«¯å£å·ï¼Œå®ƒé€šå¸¸ä»ŽHTTP URLä¸­æå–å‡ºæ¥çš„ï¼Œegï¼š æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼šhttp://www.guet.edu.cn/index.html æµè§ˆå™¨å‘é€çš„è¯·æ±‚æ¶ˆæ¯ä¸­ï¼Œå°±ä¼šåŒ…å«Hostè¯·æ±‚æŠ¥å¤´åŸŸï¼Œå¦‚ä¸‹ï¼š Hostï¼šwww.guet.edu.cn æ­¤å¤„ä½¿ç”¨ç¼ºçœç«¯å£å·80ï¼Œè‹¥æŒ‡å®šäº†ç«¯å£å·ï¼Œåˆ™å˜æˆï¼šHostï¼šwww.guet.edu.cn:æŒ‡å®šç«¯å£å·6.User-Agentæˆ‘ä»¬ä¸Šç½‘ç™»é™†è®ºå›çš„æ—¶å€™ï¼Œå¾€å¾€ä¼šçœ‹åˆ°ä¸€äº›æ¬¢è¿Žä¿¡æ¯ï¼Œå…¶ä¸­åˆ—å‡ºäº†ä½ çš„æ“ä½œç³»ç»Ÿçš„åç§°å’Œç‰ˆæœ¬ï¼Œä½ æ‰€ä½¿ç”¨çš„æµè§ˆå™¨çš„åç§°å’Œç‰ˆæœ¬ï¼Œè¿™å¾€å¾€è®©å¾ˆå¤šäººæ„Ÿåˆ°å¾ˆç¥žå¥‡ï¼Œå®žé™…ä¸Šï¼ŒæœåŠ¡å™¨åº”ç”¨ç¨‹åºå°±æ˜¯ä»ŽUser-Agentè¿™ä¸ªè¯·æ±‚æŠ¥å¤´åŸŸä¸­èŽ·å–åˆ°è¿™äº›ä¿¡æ¯ã€‚User-Agentè¯·æ±‚æŠ¥å¤´åŸŸå…è®¸å®¢æˆ·ç«¯å°†å®ƒçš„æ“ä½œç³»ç»Ÿã€æµè§ˆå™¨å’Œå…¶å®ƒå±žæ€§å‘Šè¯‰æœåŠ¡å™¨ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªæŠ¥å¤´åŸŸä¸æ˜¯å¿…éœ€çš„ï¼Œå¦‚æžœæˆ‘ä»¬è‡ªå·±ç¼–å†™ä¸€ä¸ªæµè§ˆå™¨ï¼Œä¸ä½¿ç”¨User-Agentè¯·æ±‚æŠ¥å¤´åŸŸï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç«¯å°±æ— æ³•å¾—çŸ¥æˆ‘ä»¬çš„ä¿¡æ¯äº†ã€‚ å“åº”æŠ¥å¤´å“åº”æŠ¥å¤´å…è®¸æœåŠ¡å™¨ä¼ é€’ä¸èƒ½æ”¾åœ¨çŠ¶æ€è¡Œä¸­çš„é™„åŠ å“åº”ä¿¡æ¯ï¼Œä»¥åŠå…³äºŽæœåŠ¡å™¨çš„ä¿¡æ¯å’Œå¯¹Request-URIæ‰€æ ‡è¯†çš„èµ„æºè¿›è¡Œä¸‹ä¸€æ­¥è®¿é—®çš„ä¿¡æ¯ã€‚ å¸¸ç”¨çš„å“åº”æŠ¥å¤´LocationLocationå“åº”æŠ¥å¤´åŸŸç”¨äºŽé‡å®šå‘æŽ¥å—è€…åˆ°ä¸€ä¸ªæ–°çš„ä½ç½®ã€‚Locationå“åº”æŠ¥å¤´åŸŸå¸¸ç”¨åœ¨æ›´æ¢åŸŸåçš„æ—¶å€™ã€‚ServerServerå“åº”æŠ¥å¤´åŸŸåŒ…å«äº†æœåŠ¡å™¨ç”¨æ¥å¤„ç†è¯·æ±‚çš„è½¯ä»¶ä¿¡æ¯ã€‚ä¸ŽUser-Agentè¯·æ±‚æŠ¥å¤´åŸŸæ˜¯ç›¸å¯¹åº”çš„ã€‚ä¸‹é¢æ˜¯Serverå“åº”æŠ¥å¤´åŸŸçš„ä¸€ä¸ªä¾‹å­ï¼šServerï¼šApache-Coyote/1.1WWW-AuthenticateWWW-Authenticateå“åº”æŠ¥å¤´åŸŸå¿…é¡»è¢«åŒ…å«åœ¨401ï¼ˆæœªæŽˆæƒçš„ï¼‰å“åº”æ¶ˆæ¯ä¸­ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°401å“åº”æ¶ˆæ¯æ—¶å€™ï¼Œå¹¶å‘é€AuthorizationæŠ¥å¤´åŸŸè¯·æ±‚æœåŠ¡å™¨å¯¹å…¶è¿›è¡ŒéªŒè¯æ—¶ï¼ŒæœåŠ¡ç«¯å“åº”æŠ¥å¤´å°±åŒ…å«è¯¥æŠ¥å¤´åŸŸã€‚egï¼šWWW-Authenticate:Basic realm=â€Basic Auth Test!â€ //å¯ä»¥çœ‹å‡ºæœåŠ¡å™¨å¯¹è¯·æ±‚èµ„æºé‡‡ç”¨çš„æ˜¯åŸºæœ¬éªŒè¯æœºåˆ¶ã€‚ å®žä½“æŠ¥å¤´è¯·æ±‚å’Œå“åº”æ¶ˆæ¯éƒ½å¯ä»¥ä¼ é€ä¸€ä¸ªå®žä½“ã€‚ä¸€ä¸ªå®žä½“ç”±å®žä½“æŠ¥å¤´åŸŸå’Œå®žä½“æ­£æ–‡ç»„æˆï¼Œä½†å¹¶ä¸æ˜¯è¯´å®žä½“æŠ¥å¤´åŸŸå’Œå®žä½“æ­£æ–‡è¦åœ¨ä¸€èµ·å‘é€ï¼Œå¯ä»¥åªå‘é€å®žä½“æŠ¥å¤´åŸŸã€‚å®žä½“æŠ¥å¤´å®šä¹‰äº†å…³äºŽå®žä½“æ­£æ–‡ï¼ˆegï¼šæœ‰æ— å®žä½“æ­£æ–‡ï¼‰å’Œè¯·æ±‚æ‰€æ ‡è¯†çš„èµ„æºçš„å…ƒä¿¡æ¯ã€‚ å¸¸ç”¨çš„å®žä½“æŠ¥å¤´Content-EncodingContent-Encodingå®žä½“æŠ¥å¤´åŸŸè¢«ç”¨ä½œåª’ä½“ç±»åž‹çš„ä¿®é¥°ç¬¦ï¼Œå®ƒçš„å€¼æŒ‡ç¤ºäº†å·²ç»è¢«åº”ç”¨åˆ°å®žä½“æ­£æ–‡çš„é™„åŠ å†…å®¹çš„ç¼–ç ï¼Œå› è€Œè¦èŽ·å¾—Content-TypeæŠ¥å¤´åŸŸä¸­æ‰€å¼•ç”¨çš„åª’ä½“ç±»åž‹ï¼Œå¿…é¡»é‡‡ç”¨ç›¸åº”çš„è§£ç æœºåˆ¶ã€‚Content-Encodingè¿™æ ·ç”¨äºŽè®°å½•æ–‡æ¡£çš„åŽ‹ç¼©æ–¹æ³•ï¼Œegï¼šContent-Encodingï¼šgzipContent-LanguageContent-Languageå®žä½“æŠ¥å¤´åŸŸæè¿°äº†èµ„æºæ‰€ç”¨çš„è‡ªç„¶è¯­è¨€ã€‚æ²¡æœ‰è®¾ç½®è¯¥åŸŸåˆ™è®¤ä¸ºå®žä½“å†…å®¹å°†æä¾›ç»™æ‰€æœ‰çš„è¯­è¨€é˜…è¯»è€…ã€‚egï¼šContent-Language:daContent-LengthContent-Lengthå®žä½“æŠ¥å¤´åŸŸç”¨äºŽæŒ‡æ˜Žå®žä½“æ­£æ–‡çš„é•¿åº¦ï¼Œä»¥å­—èŠ‚æ–¹å¼å­˜å‚¨çš„åè¿›åˆ¶æ•°å­—æ¥è¡¨ç¤ºã€‚Content-TypeContent-Typeå®žä½“æŠ¥å¤´åŸŸç”¨è¯­æŒ‡æ˜Žå‘é€ç»™æŽ¥æ”¶è€…çš„å®žä½“æ­£æ–‡çš„åª’ä½“ç±»åž‹ã€‚egï¼šContent-Type:text/html;charset=ISO-8859-1Content-Type:text/html;charset=GB2312Last-ModifiedLast-Modifiedå®žä½“æŠ¥å¤´åŸŸç”¨äºŽæŒ‡ç¤ºèµ„æºçš„æœ€åŽä¿®æ”¹æ—¥æœŸå’Œæ—¶é—´ã€‚ExpiresExpireså®žä½“æŠ¥å¤´åŸŸç»™å‡ºå“åº”è¿‡æœŸçš„æ—¥æœŸå’Œæ—¶é—´ã€‚ä¸ºäº†è®©ä»£ç†æœåŠ¡å™¨æˆ–æµè§ˆå™¨åœ¨ä¸€æ®µæ—¶é—´ä»¥åŽæ›´æ–°ç¼“å­˜ä¸­(å†æ¬¡è®¿é—®æ›¾è®¿é—®è¿‡çš„é¡µé¢æ—¶ï¼Œç›´æŽ¥ä»Žç¼“å­˜ä¸­åŠ è½½ï¼Œç¼©çŸ­å“åº”æ—¶é—´å’Œé™ä½ŽæœåŠ¡å™¨è´Ÿè½½)çš„é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Expireså®žä½“æŠ¥å¤´åŸŸæŒ‡å®šé¡µé¢è¿‡æœŸçš„æ—¶é—´ã€‚egï¼šExpiresï¼šThuï¼Œ15 Sep 2006 16:23:12 GMTHTTP1.1çš„å®¢æˆ·ç«¯å’Œç¼“å­˜å¿…é¡»å°†å…¶ä»–éžæ³•çš„æ—¥æœŸæ ¼å¼ï¼ˆåŒ…æ‹¬0ï¼‰çœ‹ä½œå·²ç»è¿‡æœŸã€‚egï¼šä¸ºäº†è®©æµè§ˆå™¨ä¸è¦ç¼“å­˜é¡µé¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨Expireså®žä½“æŠ¥å¤´åŸŸï¼Œè®¾ç½®ä¸º0ï¼Œjspä¸­ç¨‹åºå¦‚ä¸‹ï¼šresponse.setDateHeader(â€œExpiresâ€,â€0â€); HTTPåè®®ç›¸å…³æŠ€æœ¯è¡¥å……1ã€åŸºç¡€ï¼šé«˜å±‚åè®®æœ‰ï¼šæ–‡ä»¶ä¼ è¾“åè®®FTPã€ç”µå­é‚®ä»¶ä¼ è¾“åè®®SMTPã€åŸŸåç³»ç»ŸæœåŠ¡DNSã€ç½‘ç»œæ–°é—»ä¼ è¾“åè®®NNTPå’ŒHTTPåè®®ç­‰ ä¸­ä»‹ç”±ä¸‰ç§ï¼šä»£ç†(Proxy)ã€ç½‘å…³(Gateway)å’Œé€šé“(Tunnel)ï¼Œä¸€ä¸ªä»£ç†æ ¹æ®URIçš„ç»å¯¹æ ¼å¼æ¥æŽ¥å—è¯·æ±‚ï¼Œé‡å†™å…¨éƒ¨æˆ–éƒ¨åˆ†æ¶ˆæ¯ï¼Œé€šè¿‡ URIçš„æ ‡è¯†æŠŠå·²æ ¼å¼åŒ–è¿‡çš„è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ã€‚ç½‘å…³æ˜¯ä¸€ä¸ªæŽ¥æ”¶ä»£ç†ï¼Œä½œä¸ºä¸€äº›å…¶å®ƒæœåŠ¡å™¨çš„ä¸Šå±‚ï¼Œå¹¶ä¸”å¦‚æžœå¿…é¡»çš„è¯ï¼Œå¯ä»¥æŠŠè¯·æ±‚ç¿»è¯‘ç»™ä¸‹å±‚çš„æœåŠ¡å™¨åè®®ã€‚ä¸€ ä¸ªé€šé“ä½œä¸ºä¸æ”¹å˜æ¶ˆæ¯çš„ä¸¤ä¸ªè¿žæŽ¥ä¹‹é—´çš„ä¸­ç»§ç‚¹ã€‚å½“é€šè®¯éœ€è¦é€šè¿‡ä¸€ä¸ªä¸­ä»‹(ä¾‹å¦‚ï¼šé˜²ç«å¢™ç­‰)æˆ–è€…æ˜¯ä¸­ä»‹ä¸èƒ½è¯†åˆ«æ¶ˆæ¯çš„å†…å®¹æ—¶ï¼Œé€šé“ç»å¸¸è¢«ä½¿ç”¨ã€‚ ä»£ç†(Proxy)ï¼šä¸€ä¸ªä¸­é—´ç¨‹åºï¼Œå®ƒå¯ä»¥å……å½“ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥å……å½“ä¸€ä¸ªå®¢æˆ·æœºï¼Œä¸ºå…¶å®ƒå®¢æˆ·æœºå»ºç«‹è¯·æ±‚ã€‚è¯·æ±‚æ˜¯é€šè¿‡å¯èƒ½çš„ç¿»è¯‘åœ¨å†…éƒ¨æˆ–ç»è¿‡ä¼ é€’åˆ°å…¶å®ƒçš„ æœåŠ¡å™¨ä¸­ã€‚ä¸€ä¸ªä»£ç†åœ¨å‘é€è¯·æ±‚ä¿¡æ¯ä¹‹å‰ï¼Œå¿…é¡»è§£é‡Šå¹¶ä¸”å¦‚æžœå¯èƒ½é‡å†™å®ƒã€‚ä»£ç†ç»å¸¸ä½œä¸ºé€šè¿‡é˜²ç«å¢™çš„å®¢æˆ·æœºç«¯çš„é—¨æˆ·ï¼Œä»£ç†è¿˜å¯ä»¥ä½œä¸ºä¸€ä¸ªå¸®åŠ©åº”ç”¨æ¥é€šè¿‡åè®®å¤„ ç†æ²¡æœ‰è¢«ç”¨æˆ·ä»£ç†å®Œæˆçš„è¯·æ±‚ã€‚ç½‘å…³(Gateway)ï¼šä¸€ä¸ªä½œä¸ºå…¶å®ƒæœåŠ¡å™¨ä¸­é—´åª’ä»‹çš„æœåŠ¡å™¨ã€‚ä¸Žä»£ç†ä¸åŒçš„æ˜¯ï¼Œç½‘å…³æŽ¥å—è¯·æ±‚å°±å¥½è±¡å¯¹è¢«è¯·æ±‚çš„èµ„æºæ¥è¯´å®ƒå°±æ˜¯æºæœåŠ¡å™¨ï¼›å‘å‡ºè¯·æ±‚çš„å®¢æˆ·æœºå¹¶æ²¡æœ‰æ„è¯†åˆ°å®ƒåœ¨åŒç½‘å…³æ‰“äº¤é“ã€‚ç½‘å…³ç»å¸¸ä½œä¸ºé€šè¿‡é˜²ç«å¢™çš„æœåŠ¡å™¨ç«¯çš„é—¨æˆ·ï¼Œç½‘å…³è¿˜å¯ä»¥ä½œä¸ºä¸€ä¸ªåè®®ç¿»è¯‘å™¨ä»¥ä¾¿å­˜å–é‚£äº›å­˜å‚¨åœ¨éžHTTPç³»ç»Ÿä¸­çš„èµ„æºã€‚ é€šé“(Tunnel)ï¼šæ˜¯ä½œä¸ºä¸¤ä¸ªè¿žæŽ¥ä¸­ç»§çš„ä¸­ä»‹ç¨‹åºã€‚ä¸€æ—¦æ¿€æ´»ï¼Œé€šé“ä¾¿è¢«è®¤ä¸ºä¸å±žäºŽHTTPé€šè®¯ï¼Œå°½ç®¡é€šé“å¯èƒ½æ˜¯è¢«ä¸€ä¸ªHTTPè¯·æ±‚åˆå§‹åŒ–çš„ã€‚å½“è¢«ä¸­ç»§ çš„è¿žæŽ¥ä¸¤ç«¯å…³é—­æ—¶ï¼Œé€šé“ä¾¿æ¶ˆå¤±ã€‚å½“ä¸€ä¸ªé—¨æˆ·(Portal)å¿…é¡»å­˜åœ¨æˆ–ä¸­ä»‹(Intermediary)ä¸èƒ½è§£é‡Šä¸­ç»§çš„é€šè®¯æ—¶é€šé“è¢«ç»å¸¸ä½¿ç”¨ã€‚ 2ã€åè®®åˆ†æžçš„ä¼˜åŠ¿â€”HTTPåˆ†æžå™¨æ£€æµ‹ç½‘ç»œæ”»å‡»ä»¥æ¨¡å—åŒ–çš„æ–¹å¼å¯¹é«˜å±‚åè®®è¿›è¡Œåˆ†æžå¤„ç†ï¼Œå°†æ˜¯æœªæ¥å…¥ä¾µæ£€æµ‹çš„æ–¹å‘ã€‚HTTPåŠå…¶ä»£ç†çš„å¸¸ç”¨ç«¯å£80ã€3128å’Œ8080åœ¨networkéƒ¨åˆ†ç”¨portæ ‡ç­¾è¿›è¡Œäº†è§„å®š 3ã€HTTPåè®®Content Lenthé™åˆ¶æ¼æ´žå¯¼è‡´æ‹’ç»æœåŠ¡æ”»å‡»ä½¿ç”¨POSTæ–¹æ³•æ—¶ï¼Œå¯ä»¥è®¾ç½®ContentLenthæ¥å®šä¹‰éœ€è¦ä¼ é€çš„æ•°æ®é•¿åº¦ï¼Œä¾‹å¦‚ContentLenth:999999999ï¼Œåœ¨ä¼ é€å®Œæˆå‰ï¼Œå†… å­˜ä¸ä¼šé‡Šæ”¾ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªç¼ºé™·ï¼Œè¿žç»­å‘WEBæœåŠ¡å™¨å‘é€åžƒåœ¾æ•°æ®ç›´è‡³WEBæœåŠ¡å™¨å†…å­˜è€—å°½ã€‚è¿™ç§æ”»å‡»æ–¹æ³•åŸºæœ¬ä¸ä¼šç•™ä¸‹ç—•è¿¹ã€‚http://www.cnpaf.net/Class/HTTP/0532918532667330.html 4ã€åˆ©ç”¨HTTPåè®®çš„ç‰¹æ€§è¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»çš„ä¸€äº›æž„æ€æœåŠ¡å™¨ç«¯å¿™äºŽå¤„ç†æ”»å‡»è€…ä¼ªé€ çš„TCPè¿žæŽ¥è¯·æ±‚è€Œæ— æš‡ç†ç¬å®¢æˆ·çš„æ­£å¸¸è¯·æ±‚ï¼ˆæ¯•ç«Ÿå®¢æˆ·ç«¯çš„æ­£å¸¸è¯·æ±‚æ¯”çŽ‡éžå¸¸ä¹‹å°ï¼‰ï¼Œæ­¤æ—¶ä»Žæ­£å¸¸å®¢æˆ·çš„è§’åº¦çœ‹æ¥ï¼ŒæœåŠ¡å™¨å¤±åŽ»å“åº”ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬ç§°ä½œï¼šæœåŠ¡å™¨ç«¯å—åˆ°äº†SYNFloodæ”»å‡»ï¼ˆSYNæ´ªæ°´æ”»å‡»ï¼‰ã€‚è€ŒSmurfã€TearDropç­‰æ˜¯åˆ©ç”¨ICMPæŠ¥æ–‡æ¥Floodå’ŒIPç¢Žç‰‡æ”»å‡»çš„ã€‚æœ¬æ–‡ç”¨â€œæ­£å¸¸è¿žæŽ¥â€çš„æ–¹æ³•æ¥äº§ç”Ÿæ‹’ç»æœåŠ¡æ”»å‡»ã€‚19ç«¯å£åœ¨æ—©æœŸå·²ç»æœ‰äººç”¨æ¥åšChargenæ”»å‡»äº†ï¼Œå³Chargen_Denial_of_Serviceï¼Œä½†æ˜¯ï¼ä»–ä»¬ç”¨çš„æ–¹æ³•æ˜¯åœ¨ä¸¤å°Chargen æœåŠ¡å™¨ä¹‹é—´äº§ç”ŸUDPè¿žæŽ¥ï¼Œè®©æœåŠ¡å™¨å¤„ç†è¿‡å¤šä¿¡æ¯è€ŒDOWNæŽ‰ï¼Œé‚£ä¹ˆï¼Œå¹²æŽ‰ä¸€å°WEBæœåŠ¡å™¨çš„æ¡ä»¶å°±å¿…é¡»æœ‰2ä¸ªï¼š1.æœ‰ChargenæœåŠ¡2.æœ‰HTTP æœåŠ¡æ–¹æ³•ï¼šæ”»å‡»è€…ä¼ªé€ æºIPç»™Nå°Chargenå‘é€è¿žæŽ¥è¯·æ±‚ï¼ˆConnectï¼‰ï¼ŒChargenæŽ¥æ”¶åˆ°è¿žæŽ¥åŽå°±ä¼šè¿”å›žæ¯ç§’72å­—èŠ‚çš„å­—ç¬¦æµï¼ˆå®žé™…ä¸Šæ ¹æ®ç½‘ç»œå®žé™…æƒ…å†µï¼Œè¿™ä¸ªé€Ÿåº¦æ›´å¿«ï¼‰ç»™æœåŠ¡å™¨ã€‚ 5ã€HttpæŒ‡çº¹è¯†åˆ«æŠ€æœ¯ HttpæŒ‡çº¹è¯†åˆ«çš„åŽŸç†å¤§è‡´ä¸Šä¹Ÿæ˜¯ç›¸åŒçš„ï¼šè®°å½•ä¸åŒæœåŠ¡å™¨å¯¹Httpåè®®æ‰§è¡Œä¸­çš„å¾®å°å·®åˆ«è¿›è¡Œè¯†åˆ«.HttpæŒ‡çº¹è¯†åˆ«æ¯”TCP/IPå †æ ˆæŒ‡çº¹è¯†åˆ«å¤æ‚è®¸ å¤š,ç†ç”±æ˜¯å®šåˆ¶HttpæœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ã€å¢žåŠ æ’ä»¶æˆ–ç»„ä»¶ä½¿å¾—æ›´æ”¹Httpçš„å“åº”ä¿¡æ¯å˜çš„å¾ˆå®¹æ˜“,è¿™æ ·ä½¿å¾—è¯†åˆ«å˜çš„å›°éš¾ï¼›ç„¶è€Œå®šåˆ¶TCP/IPå †æ ˆçš„è¡Œä¸º éœ€è¦å¯¹æ ¸å¿ƒå±‚è¿›è¡Œä¿®æ”¹,æ‰€ä»¥å°±å®¹æ˜“è¯†åˆ«. è¦è®©æœåŠ¡å™¨è¿”å›žä¸åŒçš„Bannerä¿¡æ¯çš„è®¾ç½®æ˜¯å¾ˆç®€å•çš„,è±¡Apacheè¿™æ ·çš„å¼€æ”¾æºä»£ç çš„HttpæœåŠ¡å™¨,ç”¨æˆ·å¯ä»¥åœ¨æºä»£ç é‡Œä¿®æ”¹Bannerä¿¡æ¯,ç„¶ åŽé‡èµ·HttpæœåŠ¡å°±ç”Ÿæ•ˆäº†ï¼›å¯¹äºŽæ²¡æœ‰å…¬å¼€æºä»£ç çš„HttpæœåŠ¡å™¨æ¯”å¦‚å¾®è½¯çš„IISæˆ–è€…æ˜¯Netscape,å¯ä»¥åœ¨å­˜æ”¾Bannerä¿¡æ¯çš„Dllæ–‡ä»¶ä¸­ä¿® æ”¹,ç›¸å…³çš„æ–‡ç« æœ‰è®¨è®ºçš„,è¿™é‡Œä¸å†èµ˜è¿°,å½“ç„¶è¿™æ ·çš„ä¿®æ”¹çš„æ•ˆæžœè¿˜æ˜¯ä¸é”™çš„.å¦å¤–ä¸€ç§æ¨¡ç³ŠBannerä¿¡æ¯çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ’ä»¶ã€‚ å¸¸ç”¨æµ‹è¯•è¯·æ±‚ï¼š1ï¼šHEAD/Http/1.0å‘é€åŸºæœ¬çš„Httpè¯·æ±‚2ï¼šDELETE/Http/1.0å‘é€é‚£äº›ä¸è¢«å…è®¸çš„è¯·æ±‚,æ¯”å¦‚Deleteè¯·æ±‚3ï¼šGET/Http/3.0å‘é€ä¸€ä¸ªéžæ³•ç‰ˆæœ¬çš„Httpåè®®è¯·æ±‚4ï¼šGET/JUNK/1.0å‘é€ä¸€ä¸ªä¸æ­£ç¡®è§„æ ¼çš„Httpåè®®è¯·æ±‚HttpæŒ‡çº¹è¯†åˆ«å·¥å…·Httprint,å®ƒé€šè¿‡è¿ç”¨ç»Ÿè®¡å­¦åŽŸç†,ç»„åˆæ¨¡ç³Šçš„é€»è¾‘å­¦æŠ€æœ¯,èƒ½å¾ˆæœ‰æ•ˆçš„ç¡®å®šHttpæœåŠ¡å™¨çš„ç±»åž‹.å®ƒå¯ä»¥è¢«ç”¨æ¥æ”¶é›†å’Œåˆ†æžä¸åŒHttpæœåŠ¡å™¨äº§ç”Ÿçš„ç­¾åã€‚ 6ã€å…¶ä»–ï¼šä¸ºäº†æé«˜ç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨æ—¶çš„æ€§èƒ½ï¼ŒçŽ°ä»£æµè§ˆå™¨è¿˜æ”¯æŒå¹¶å‘çš„è®¿é—®æ–¹å¼ï¼Œæµè§ˆä¸€ä¸ªç½‘é¡µæ—¶åŒæ—¶å»ºç«‹å¤šä¸ªè¿žæŽ¥ï¼Œä»¥è¿…é€ŸèŽ·å¾—ä¸€ä¸ªç½‘é¡µä¸Šçš„å¤šä¸ªå›¾æ ‡ï¼Œè¿™æ ·èƒ½æ›´å¿«é€Ÿå®Œæˆæ•´ä¸ªç½‘é¡µçš„ä¼ è¾“ã€‚HTTP1.1ä¸­æä¾›äº†è¿™ç§æŒç»­è¿žæŽ¥çš„æ–¹å¼ï¼Œè€Œä¸‹ä¸€ä»£HTTPåè®®ï¼šHTTP-NGæ›´å¢žåŠ äº†æœ‰å…³ä¼šè¯æŽ§åˆ¶ã€ä¸°å¯Œçš„å†…å®¹åå•†ç­‰æ–¹å¼çš„æ”¯æŒï¼Œæ¥æä¾›æ›´é«˜æ•ˆçŽ‡çš„è¿žæŽ¥ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>HTTP</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Es6 æ ¸å¿ƒå†…å®¹ ä¸‹]]></title>
    <url>%2F2018%2F03%2F30%2FJs%2FEs6-%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9-%E4%B8%8B%2F</url>
    <content type="text"><![CDATA[import exportè¿™ä¸¤ä¸ªå®¶ä¼™å¯¹åº”çš„å°±æ˜¯es6è‡ªå·±çš„moduleåŠŸèƒ½ã€‚ æˆ‘ä»¬ä¹‹å‰å†™çš„Javascriptä¸€ç›´éƒ½æ²¡æœ‰æ¨¡å—åŒ–çš„ä½“ç³»ï¼Œæ— æ³•å°†ä¸€ä¸ªåºžå¤§çš„jså·¥ç¨‹æ‹†åˆ†æˆä¸€ä¸ªä¸ªåŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹ä½†ç›¸äº’ä¾èµ–çš„å°å·¥ç¨‹ï¼Œå†ç”¨ä¸€ç§ç®€å•çš„æ–¹æ³•æŠŠè¿™äº›å°å·¥ç¨‹è¿žæŽ¥åœ¨ä¸€èµ·ã€‚ è¿™æœ‰å¯èƒ½å¯¼è‡´ä¸¤ä¸ªé—®é¢˜ï¼šä¸€æ–¹é¢jsä»£ç å˜å¾—å¾ˆè‡ƒè‚¿ï¼Œéš¾ä»¥ç»´æŠ¤å¦ä¸€æ–¹é¢æˆ‘ä»¬å¸¸å¸¸å¾—å¾ˆæ³¨æ„æ¯ä¸ªscriptæ ‡ç­¾åœ¨htmlä¸­çš„ä½ç½®ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸æœ‰ä¾èµ–å…³ç³»ï¼Œé¡ºåºé”™äº†å¯èƒ½å°±ä¼šå‡ºbug åœ¨es6ä¹‹å‰ä¸ºè§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¾—åˆ©ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„ä¸€äº›æ–¹æ¡ˆï¼Œä¸»è¦æœ‰ä¸¤ç§CommonJS(æœåŠ¡å™¨ç«¯)å’ŒAMDï¼ˆæµè§ˆå™¨ç«¯ï¼Œå¦‚require.jsï¼‰ã€‚ è€ŒçŽ°åœ¨æˆ‘ä»¬æœ‰äº†es6çš„moduleåŠŸèƒ½ï¼Œå®ƒå®žçŽ°éžå¸¸ç®€å•ï¼Œå¯ä»¥æˆä¸ºæœåŠ¡å™¨å’Œæµè§ˆå™¨é€šç”¨çš„æ¨¡å—è§£å†³æ–¹æ¡ˆã€‚ ES6æ¨¡å—çš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯å°½é‡çš„é™æ€åŒ–ï¼Œä½¿å¾—ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠè¾“å…¥å’Œè¾“å‡ºçš„å˜é‡ã€‚CommonJSå’ŒAMDæ¨¡å—ï¼Œéƒ½åªèƒ½åœ¨è¿è¡Œæ—¶ç¡®å®šè¿™äº›ä¸œè¥¿ã€‚ ä¼ ç»Ÿå†™æ³•é¦–å…ˆæˆ‘ä»¬å›žé¡¾ä¸‹require.jsçš„å†™æ³•ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªjsæ–‡ä»¶: index.jså’Œcontent.js,çŽ°åœ¨æˆ‘ä»¬æƒ³è¦åœ¨index.jsä¸­ä½¿ç”¨content.jsè¿”å›žçš„ç»“æžœï¼Œæˆ‘ä»¬è¦æ€Žä¹ˆåšå‘¢ï¼Ÿé¦–å…ˆå®šä¹‰ï¼š1234//content.jsdefine('content.js', function()&#123; return 'A cat';&#125;) ç„¶åŽrequireï¼š 1234//index.jsrequire(['./content.js'], function(animal)&#123; console.log(animal); //A cat&#125;) é‚£CommonJSæ˜¯æ€Žä¹ˆå†™çš„å‘¢ï¼Ÿ12345//index.jsvar animal = require('./content.js')//content.jsmodule.exports = 'A cat' ES6çš„å†™æ³•12345//index.jsimport animal from './content'//content.jsexport default 'A cat' ES6 moduleçš„å…¶ä»–é«˜çº§ç”¨æ³•1234567//content.jsexport default 'A cat' export function say()&#123; return 'Hello!'&#125; export const type = 'dog' ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œexportå‘½ä»¤é™¤äº†è¾“å‡ºå˜é‡ï¼Œè¿˜å¯ä»¥è¾“å‡ºå‡½æ•°ï¼Œç”šè‡³æ˜¯ç±»ï¼ˆreactçš„æ¨¡å—åŸºæœ¬éƒ½æ˜¯è¾“å‡ºç±»ï¼‰ 12345//index.jsimport &#123; say, type &#125; from './content' let says = say()console.log(`The $&#123;type&#125; says $&#123;says&#125;`) //The dog says Hello è¿™é‡Œè¾“å…¥çš„æ—¶å€™è¦æ³¨æ„ï¼šå¤§æ‹¬å·é‡Œé¢çš„å˜é‡åï¼Œå¿…é¡»ä¸Žè¢«å¯¼å…¥æ¨¡å—ï¼ˆcontent.jsï¼‰å¯¹å¤–æŽ¥å£çš„åç§°ç›¸åŒã€‚ å¦‚æžœè¿˜å¸Œæœ›è¾“å…¥content.jsä¸­è¾“å‡ºçš„é»˜è®¤(default), å¯ä»¥å†™åœ¨å¤§æ‹¬å·å¤–é¢ã€‚ 123456//index.jsimport animal, &#123; say, type &#125; from './content' let says = say()console.log(`The $&#123;type&#125; says $&#123;says&#125; to $&#123;animal&#125;`) //The dog says Hello to A cat ä¿®æ”¹å˜é‡åæ­¤æ—¶æˆ‘ä»¬ä¸å–œæ¬¢typeè¿™ä¸ªå˜é‡åï¼Œå› ä¸ºå®ƒæœ‰å¯èƒ½é‡åï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹å®ƒçš„å˜é‡åã€‚åœ¨es6ä¸­å¯ä»¥ç”¨aså®žçŽ°ä¸€é”®æ¢åã€‚123456//index.jsimport animal, &#123; say, type as animalType &#125; from './content' let says = say()console.log(`The $&#123;animalType&#125; says $&#123;says&#125; to $&#123;animal&#125;`) //The dog says Hello to A cat æ¨¡å—çš„æ•´ä½“åŠ è½½é™¤äº†æŒ‡å®šåŠ è½½æŸä¸ªè¾“å‡ºå€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ•´ä½“åŠ è½½ï¼Œå³ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰æŒ‡å®šä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰è¾“å‡ºå€¼éƒ½åŠ è½½åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢ã€‚123456//index.jsimport animal, * as content from './content' let says = content.say()console.log(`The $&#123;content.type&#125; says $&#123;says&#125; to $&#123;animal&#125;`) //The dog says Hello to A cat é€šå¸¸æ˜Ÿå·*ç»“åˆasä¸€èµ·ä½¿ç”¨æ¯”è¾ƒåˆé€‚ã€‚ ç»ˆæžç§˜ç±è€ƒè™‘ä¸‹é¢çš„åœºæ™¯ï¼šä¸Šé¢çš„content.jsä¸€å…±è¾“å‡ºäº†ä¸‰ä¸ªå˜é‡ï¼ˆdefault, say, typeï¼‰,å‡å¦‚æˆ‘ä»¬çš„å®žé™…é¡¹ç›®å½“ä¸­åªéœ€è¦ç”¨åˆ°typeè¿™ä¸€ä¸ªå˜é‡ï¼Œå…¶ä½™ä¸¤ä¸ªæˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦ã€‚æˆ‘ä»¬å¯ä»¥åªè¾“å…¥ä¸€ä¸ªå˜é‡ï¼š 1import &#123; type &#125; from './content' ç”±äºŽå…¶ä»–ä¸¤ä¸ªå˜é‡æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œæˆ‘ä»¬å¸Œæœ›ä»£ç æ‰“åŒ…çš„æ—¶å€™ä¹Ÿå¿½ç•¥å®ƒä»¬ï¼ŒæŠ›å¼ƒå®ƒä»¬ï¼Œè¿™æ ·åœ¨å¤§é¡¹ç›®ä¸­å¯ä»¥æ˜¾è‘—å‡å°‘æ–‡ä»¶çš„ä½“ç§¯ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Es6 æ ¸å¿ƒå†…å®¹ä¸Š]]></title>
    <url>%2F2018%2F03%2F30%2FJs%2FEs6-%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9-%E4%B8%8A%2F</url>
    <content type="text"><![CDATA[åœ¨æˆ‘ä»¬æ­£å¼è®²è§£ES6è¯­æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£ä¸‹Babelã€‚Babel Babelæ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ES6è½¬ç å™¨ï¼Œå¯ä»¥å°†ES6ä»£ç è½¬ä¸ºES5ä»£ç ï¼Œä»Žè€Œåœ¨çŽ°æœ‰çŽ¯å¢ƒæ‰§è¡Œã€‚å¤§å®¶å¯ä»¥é€‰æ‹©è‡ªå·±ä¹ æƒ¯çš„å·¥å…·æ¥ä½¿ç”¨ä½¿ç”¨Babelï¼Œå…·ä½“è¿‡ç¨‹å¯ç›´æŽ¥åœ¨Babelå®˜ç½‘æŸ¥çœ‹ï¼š æœ€å¸¸ç”¨çš„ES6ç‰¹æ€§let, const, class, extends, super, arrow functions, template string, destructuring, default, restï¼Œarguments è¿™äº›æ˜¯ES6æœ€å¸¸ç”¨çš„å‡ ä¸ªè¯­æ³•ï¼ŒåŸºæœ¬ä¸Šå­¦ä¼šå®ƒä»¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥èµ°éå¤©ä¸‹éƒ½ä¸æ€•å•¦ï¼æˆ‘ä¼šç”¨æœ€é€šä¿—æ˜“æ‡‚çš„è¯­è¨€å’Œä¾‹å­æ¥è®²è§£å®ƒä»¬ï¼Œä¿è¯ä¸€çœ‹å°±æ‡‚ï¼Œä¸€å­¦å°±ä¼šã€‚ let ,constè¿™ä¸¤ä¸ªçš„ç”¨é€”ä¸Žvarç±»ä¼¼ï¼Œéƒ½æ˜¯ç”¨æ¥å£°æ˜Žå˜é‡çš„ï¼Œä½†åœ¨å®žé™…è¿ç”¨ä¸­ä»–ä¿©éƒ½æœ‰å„è‡ªçš„ç‰¹æ®Šç”¨é€”ã€‚é¦–å…ˆæ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š 123456789var name = 'zach'while (true) &#123; var name = 'obama' console.log(name) //obama break&#125;console.log(name) //obama ä½¿ç”¨var ä¸¤æ¬¡è¾“å‡ºéƒ½æ˜¯obamaï¼Œè¿™æ˜¯å› ä¸ºES5åªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œè¿™å¸¦æ¥å¾ˆå¤šä¸åˆç†çš„åœºæ™¯ã€‚ç¬¬ä¸€ç§åœºæ™¯å°±æ˜¯ä½ çŽ°åœ¨çœ‹åˆ°çš„å†…å±‚å˜é‡è¦†ç›–å¤–å±‚å˜é‡ã€‚è€Œletåˆ™å®žé™…ä¸Šä¸ºJavaScriptæ–°å¢žäº†å—çº§ä½œç”¨åŸŸã€‚ç”¨å®ƒæ‰€å£°æ˜Žçš„å˜é‡ï¼Œåªåœ¨letå‘½ä»¤æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆã€‚ 123456789let name = 'zach'while (true) &#123; let name = 'obama' console.log(name) //obama break&#125;console.log(name) //zach å¦å¤–ä¸€ä¸ªvarå¸¦æ¥çš„ä¸åˆç†åœºæ™¯å°±æ˜¯ç”¨æ¥è®¡æ•°çš„å¾ªçŽ¯å˜é‡æ³„éœ²ä¸ºå…¨å±€å˜é‡ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š1234567var a = [];for (var i = 0; i &lt; 10; i++) &#123; a[i] = function () &#123; console.log(i); &#125;;&#125;a[6](); // 10 ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡iæ˜¯varå£°æ˜Žçš„ï¼Œåœ¨å…¨å±€èŒƒå›´å†…éƒ½æœ‰æ•ˆã€‚æ‰€ä»¥æ¯ä¸€æ¬¡å¾ªçŽ¯ï¼Œæ–°çš„iå€¼éƒ½ä¼šè¦†ç›–æ—§å€¼ï¼Œå¯¼è‡´æœ€åŽè¾“å‡ºçš„æ˜¯æœ€åŽä¸€è½®çš„içš„å€¼ã€‚è€Œä½¿ç”¨letåˆ™ä¸ä¼šå‡ºçŽ°è¿™ä¸ªé—®é¢˜ã€‚1234567var a = [];for (let i = 0; i &lt; 10; i++) &#123; a[i] = function () &#123; console.log(i); &#125;;&#125;a[6](); // 6 å†æ¥çœ‹ä¸€ä¸ªæ›´å¸¸è§çš„ä¾‹å­ï¼Œäº†è§£ä¸‹å¦‚æžœä¸ç”¨ES6ï¼Œè€Œç”¨é—­åŒ…å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ 123456var clickBoxs = document.querySelectorAll('.clickBox')for (var i = 0; i &lt; clickBoxs.length; i++)&#123; clickBoxs[i].onclick = function()&#123; console.log(i) &#125;&#125; æˆ‘ä»¬æœ¬æ¥å¸Œæœ›çš„æ˜¯ç‚¹å‡»ä¸åŒçš„clickBoxï¼Œæ˜¾ç¤ºä¸åŒçš„iï¼Œä½†äº‹å®žæ˜¯æ— è®ºæˆ‘ä»¬ç‚¹å‡»å“ªä¸ªclickBoxï¼Œè¾“å‡ºçš„éƒ½æ˜¯5ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹ï¼Œå¦‚ä½•ç”¨é—­åŒ…æžå®šå®ƒã€‚ 12345678910function iteratorFactory(i)&#123; var onclick = function(e)&#123; console.log(i) &#125; return onclick;&#125;var clickBoxs = document.querySelectorAll('.clickBox')for (var i = 0; i &lt; clickBoxs.length; i++)&#123; clickBoxs[i].onclick = iteratorFactory(i)&#125; constä¹Ÿç”¨æ¥å£°æ˜Žå˜é‡ï¼Œä½†æ˜¯å£°æ˜Žçš„æ˜¯å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜Žï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚ 12const PI = Math.PIPI = 23 //Module build failed: SyntaxError: /es6/app.js: "PI" is read-only å½“æˆ‘ä»¬å°è¯•åŽ»æ”¹å˜ç”¨constå£°æ˜Žçš„å¸¸é‡æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šæŠ¥é”™ã€‚ class, extends, superè¿™ä¸‰ä¸ªç‰¹æ€§æ¶‰åŠäº†ES5ä¸­æœ€ä»¤äººå¤´ç–¼çš„çš„å‡ ä¸ªéƒ¨åˆ†ï¼šåŽŸåž‹ã€æž„é€ å‡½æ•°ï¼Œç»§æ‰¿â€¦ä½ è¿˜åœ¨ä¸ºå®ƒä»¬å¤æ‚éš¾æ‡‚çš„è¯­æ³•è€Œçƒ¦æ¼å—ï¼Ÿä½ è¿˜åœ¨ä¸ºæŒ‡é’ˆåˆ°åº•æŒ‡å‘å“ªé‡Œè€Œçº ç»“ä¸‡åˆ†å—ï¼ŸES6æä¾›äº†æ›´æŽ¥è¿‘ä¼ ç»Ÿè¯­è¨€çš„å†™æ³•ï¼Œå¼•å…¥äº†Classï¼ˆç±»ï¼‰è¿™ä¸ªæ¦‚å¿µã€‚æ–°çš„classå†™æ³•è®©å¯¹è±¡åŽŸåž‹çš„å†™æ³•æ›´åŠ æ¸…æ™°ã€æ›´åƒé¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­æ³•ï¼Œä¹Ÿæ›´åŠ é€šä¿—æ˜“æ‡‚ã€‚123456789101112131415161718192021class Animal &#123; constructor()&#123; this.type = 'animal' &#125; says(say)&#123; console.log(this.type + 'says' + say) &#125;&#125;let animal = new Animal()animal.says('hello') //animal says helloclass Cat extends Animal&#123; constructor()&#123; super() this.type = 'cat' &#125;&#125;let cat = new Cat();cat.says('hello') ä¸Šé¢ä»£ç é¦–å…ˆç”¨classå®šä¹‰äº†ä¸€ä¸ªâ€œç±»â€ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ªconstructoræ–¹æ³•ï¼Œè¿™å°±æ˜¯æž„é€ æ–¹æ³•ï¼Œè€Œthiså…³é”®å­—åˆ™ä»£è¡¨å®žä¾‹å¯¹è±¡ã€‚ç®€å•åœ°è¯´ï¼Œconstructorå†…å®šä¹‰çš„æ–¹æ³•å’Œå±žæ€§æ˜¯å®žä¾‹å¯¹è±¡è‡ªå·±çš„ï¼Œè€Œconstructorå¤–å®šä¹‰çš„æ–¹æ³•å’Œå±žæ€§åˆ™æ˜¯æ‰€æœ‰å®žä¾‹å¯¹è±¡å¯ä»¥å…±äº«çš„ã€‚ Classä¹‹é—´å¯ä»¥é€šè¿‡extendså…³é”®å­—å®žçŽ°ç»§æ‰¿ï¼Œè¿™æ¯”ES5çš„é€šè¿‡ä¿®æ”¹åŽŸåž‹é“¾å®žçŽ°ç»§æ‰¿ï¼Œè¦æ¸…æ™°å’Œæ–¹ä¾¿å¾ˆå¤šã€‚ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªCatç±»ï¼Œè¯¥ç±»é€šè¿‡extendså…³é”®å­—ï¼Œç»§æ‰¿äº†Animalç±»çš„æ‰€æœ‰å±žæ€§å’Œæ–¹æ³•ã€‚ superå…³é”®å­—ï¼Œå®ƒæŒ‡ä»£çˆ¶ç±»çš„å®žä¾‹ï¼ˆå³çˆ¶ç±»çš„thiså¯¹è±¡ï¼‰ã€‚å­ç±»å¿…é¡»åœ¨constructoræ–¹æ³•ä¸­è°ƒç”¨superæ–¹æ³•ï¼Œå¦åˆ™æ–°å»ºå®žä¾‹æ—¶ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„thiså¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„thiså¯¹è±¡ï¼Œç„¶åŽå¯¹å…¶è¿›è¡ŒåŠ å·¥ã€‚å¦‚æžœä¸è°ƒç”¨superæ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ°thiså¯¹è±¡ã€‚ ES6çš„ç»§æ‰¿æœºåˆ¶ï¼Œå®žè´¨æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®žä¾‹å¯¹è±¡thisï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨superæ–¹æ³•ï¼‰ï¼Œç„¶åŽå†ç”¨å­ç±»çš„æž„é€ å‡½æ•°ä¿®æ”¹thisã€‚ arrow function(ç®­å¤´å‡½æ•°)è¿™ä¸ªææ€•æ˜¯ES6æœ€æœ€å¸¸ç”¨çš„ä¸€ä¸ªæ–°ç‰¹æ€§äº†ï¼Œç”¨å®ƒæ¥å†™functionæ¯”åŽŸæ¥çš„å†™æ³•è¦ç®€æ´æ¸…æ™°å¾ˆå¤š:12function(i)&#123; return i + 1; &#125; //ES5(i) =&gt; i + 1 //ES6 ç®€ç›´æ˜¯ç®€å•çš„ä¸åƒè¯å¯¹å§â€¦å¦‚æžœæ–¹ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œåˆ™éœ€è¦ç”¨{}æŠŠä»£ç åŒ…èµ·æ¥ï¼š1234567function(x, y) &#123; x++; y--; return x + y;&#125;//es6(x, y) =&gt; &#123;x++; y--; return x+y&#125; é™¤äº†çœ‹ä¸ŠåŽ»æ›´ç®€æ´ä»¥å¤–ï¼Œarrow functionè¿˜æœ‰ä¸€é¡¹è¶…çº§æ— æ•Œçš„åŠŸèƒ½ï¼é•¿æœŸä»¥æ¥ï¼ŒJavaScriptè¯­è¨€çš„thiså¯¹è±¡ä¸€ç›´æ˜¯ä¸€ä¸ªä»¤äººå¤´ç—›çš„é—®é¢˜ï¼Œåœ¨å¯¹è±¡æ–¹æ³•ä¸­ä½¿ç”¨thisï¼Œå¿…é¡»éžå¸¸å°å¿ƒã€‚ä¾‹å¦‚ï¼š 12345678910111213class Animal &#123; constructor()&#123; this.type = 'animal' &#125; says(say)&#123; setTimeout(function()&#123; console.log(this.type + ' says ' + say) &#125;, 1000) &#125;&#125; var animal = new Animal() animal.says('hi') //undefined says hi è¿è¡Œä¸Šé¢çš„ä»£ç ä¼šæŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºsetTimeoutä¸­çš„thisæŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡ã€‚æ‰€ä»¥ä¸ºäº†è®©å®ƒèƒ½å¤Ÿæ­£ç¡®çš„è¿è¡Œï¼Œä¼ ç»Ÿçš„è§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š ç¬¬ä¸€ç§æ˜¯å°†thisä¼ ç»™self,å†ç”¨selfæ¥æŒ‡ä»£this12345says(say)&#123; var self = this; setTimeout(function()&#123; console.log(self.type + ' says ' + say) &#125;, 1000) ç¬¬äºŒç§æ–¹æ³•æ˜¯ç”¨bind(this),å³1234says(say)&#123; setTimeout(function()&#123; console.log(this.type + ' says ' + say) &#125;.bind(this), 1000) ä½†çŽ°åœ¨æˆ‘ä»¬æœ‰äº†ç®­å¤´å‡½æ•°ï¼Œå°±ä¸éœ€è¦è¿™ä¹ˆéº»çƒ¦äº†ï¼š 123456789101112class Animal &#123; constructor()&#123; this.type = 'animal' &#125; says(say)&#123; setTimeout( () =&gt; &#123; console.log(this.type + ' says ' + say) &#125;, 1000) &#125;&#125; var animal = new Animal() animal.says('hi') //animal says hi å½“æˆ‘ä»¬ä½¿ç”¨ç®­å¤´å‡½æ•°æ—¶ï¼Œå‡½æ•°ä½“å†…çš„thiså¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚å¹¶ä¸æ˜¯å› ä¸ºç®­å¤´å‡½æ•°å†…éƒ¨æœ‰ç»‘å®šthisçš„æœºåˆ¶ï¼Œå®žé™…åŽŸå› æ˜¯ç®­å¤´å‡½æ•°æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„thisï¼Œå®ƒçš„thisæ˜¯ç»§æ‰¿å¤–é¢çš„ï¼Œå› æ­¤å†…éƒ¨çš„thiså°±æ˜¯å¤–å±‚ä»£ç å—çš„thisã€‚ template string(å­—ç¬¦ä¸²æ¨¡æ¿)è¿™ä¸ªä¸œè¥¿ä¹Ÿæ˜¯éžå¸¸æœ‰ç”¨ï¼Œå½“æˆ‘ä»¬è¦æ’å…¥å¤§æ®µçš„htmlå†…å®¹åˆ°æ–‡æ¡£ä¸­æ—¶ï¼Œä¼ ç»Ÿçš„å†™æ³•éžå¸¸éº»çƒ¦ï¼Œæ‰€ä»¥ä¹‹å‰æˆ‘ä»¬é€šå¸¸ä¼šå¼•ç”¨ä¸€äº›æ¨¡æ¿å·¥å…·åº“ï¼Œæ¯”å¦‚mustacheç­‰ç­‰ã€‚ 12345678910111213//es5$("#result").append( "There are &lt;b&gt;" + basket.count + "&lt;/b&gt; " + "items in your basket, " + "&lt;em&gt;" + basket.onSale + "&lt;/em&gt; are on sale!");//es6$("#result").append(` There are &lt;b&gt;$&#123;basket.count&#125;&lt;/b&gt; items in your basket, &lt;em&gt;$&#123;basket.onSale&#125;&lt;/em&gt; are on sale!`); ç”¨åå¼•å·ï¼ˆ\ï¼‰æ¥æ ‡è¯†èµ·å§‹ï¼Œç”¨${}`æ¥å¼•ç”¨å˜é‡ï¼Œè€Œä¸”æ‰€æœ‰çš„ç©ºæ ¼å’Œç¼©è¿›éƒ½ä¼šè¢«ä¿ç•™åœ¨è¾“å‡ºä¹‹ä¸­ï¼Œæ˜¯ä¸æ˜¯éžå¸¸çˆ½ï¼Ÿï¼ React Routerä»Žç¬¬1.0.3ç‰ˆå¼€å§‹ä¹Ÿä½¿ç”¨ES6è¯­æ³•äº†ï¼Œæ¯”å¦‚è¿™ä¸ªä¾‹å­ï¼š1&lt;Link to=&#123;`/taco/$&#123;taco.name&#125;`&#125;&gt;&#123;taco.name&#125;&lt;/Link&gt; destructuring(è§£æž„èµ‹å€¼)ES6å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»Žæ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æž„ï¼ˆDestructuringï¼‰ã€‚ 12345678910111213141516// es5let cat = 'ken'let dog = 'lili'let zoo = &#123;cat: cat, dog: dog&#125;console.log(zoo) //Object &#123;cat: "ken", dog: "lili"&#125;// es6let cat = 'ken'let dog = 'lili'let zoo = &#123;cat, dog&#125;console.log(zoo) //Object &#123;cat: "ken", dog: "lili"&#125;//åè¿‡æ¥å¯ä»¥è¿™æ ·å†™let dog = &#123;type: 'animal', many: 2&#125;let &#123; type, many&#125; = dogconsole.log(type, many) //animal 2 default,restdefaultå¾ˆç®€å•ï¼Œæ„æ€å°±æ˜¯é»˜è®¤å€¼ã€‚å¤§å®¶å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œè°ƒç”¨animal()æ–¹æ³•æ—¶å¿˜äº†ä¼ å‚æ•°ï¼Œä¼ ç»Ÿçš„åšæ³•å°±æ˜¯åŠ ä¸Šè¿™ä¸€å¥type = type || &#39;cat&#39; æ¥æŒ‡å®šé»˜è®¤å€¼ã€‚ 1234567891011//es5function animal(type)&#123; type = type || 'cat' console.log(type)&#125;animal()//es6function animal(type = 'cat')&#123; console.log(type)&#125;animal() æœ€åŽä¸€ä¸ªrestè¯­æ³•ä¹Ÿå¾ˆç®€å•ï¼Œç›´æŽ¥çœ‹ä¾‹å­ï¼š1234function animals(...types)&#123; console.log(types)&#125;animals('cat', 'dog', 'fish') //["cat", "dog", "fish"] å¦‚æžœä¸ç”¨es6ä¸­çš„å±žæ€§ï¼Œå¯ä»¥ç”¨ES5ä¸­çš„argumnets åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå…¥é—¨]]></title>
    <url>%2F2018%2F03%2F28%2FNode%2FNode%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯Node.jsæŒ‰ç…§ Node.jså®˜æ–¹ç½‘ç«™ä¸»é¡µ çš„è¯´æ³•: Node.jsÂ® is a JavaScript runtime built on Chromeâ€™s V8 JavaScript engine. Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient. Node.jsâ€™ package ecosystem, npm, is the largest ecosystem of open source libraries in the world.ä»Žä¸Šé¢è¿™æ®µè¯æ¥çœ‹ï¼š1.Node.js ä¸æ˜¯ JavaScript åº”ç”¨ï¼Œä¸æ˜¯è¯­è¨€ï¼ˆJavaScript æ˜¯è¯­è¨€ï¼‰ï¼Œä¸æ˜¯åƒ Rails(Ruby)ã€ Laravel(PHP) æˆ– Django(Python) ä¸€æ ·çš„æ¡†æž¶ï¼Œä¹Ÿä¸æ˜¯åƒ Nginx ä¸€æ ·çš„ Web æœåŠ¡å™¨ã€‚Node.js æ˜¯ JavaScript è¿è¡Œæ—¶çŽ¯å¢ƒ 2.æž„å»ºåœ¨ Chromeâ€™s V8 è¿™ä¸ªè‘—åçš„ JavaScript å¼•æ“Žä¹‹ä¸Šï¼ŒChrome V8 å¼•æ“Žä»¥ C/C++ ä¸ºä¸»ï¼Œç›¸å½“äºŽä½¿ç”¨JavaScript å†™æ³•ï¼Œè½¬æˆ C/C++ è°ƒç”¨ï¼Œå¤§å¤§çš„é™ä½Žäº†å­¦ä¹ æˆæœ¬ 3.äº‹ä»¶é©±åŠ¨ï¼ˆevent-drivenï¼‰ï¼Œéžé˜»å¡ž I/O æ¨¡åž‹ï¼ˆnon-blocking I/O modelï¼‰ï¼Œç®€å•ç‚¹è®²å°±æ˜¯æ¯ä¸ªå‡½æ•°éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œæœ€åŽç”± Libuv è¿™ä¸ª C/C++ ç¼–å†™çš„äº‹ä»¶å¾ªçŽ¯å¤„ç†åº“æ¥å¤„ç†è¿™äº› I/O æ“ä½œï¼Œéšè—äº†éžé˜»å¡ž I/O çš„å…·ä½“ç»†èŠ‚ï¼Œç®€åŒ–å¹¶å‘ç¼–ç¨‹æ¨¡åž‹ï¼Œè®©ä½ å¯ä»¥è½»æ¾çš„ç¼–å†™é«˜æ€§èƒ½çš„Webåº”ç”¨ï¼Œæ‰€ä»¥å®ƒæ˜¯è½»é‡ï¼ˆlightweightï¼‰ä¸”é«˜æ•ˆï¼ˆefficientï¼‰çš„ 4.ä½¿ç”¨ npm ä½œä¸ºåŒ…ç®¡ç†å™¨ï¼Œç›®å‰ npm æ˜¯å¼€æºåº“é‡ŒåŒ…ç®¡ç†æœ€å¤§çš„ç”Ÿæ€ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œæˆªæ­¢åˆ°2017å¹´12æœˆï¼Œæ¨¡å—æ•°é‡è¶…è¿‡ 60 ä¸‡+ å¤§å¤šæ•°äººéƒ½è®¤ä¸º Node.js åªèƒ½å†™ç½‘ç«™åŽå°æˆ–è€…å‰ç«¯å·¥å…·ï¼Œè¿™å…¶å®žæ˜¯ä¸å…¨é¢çš„ï¼ŒNode.jsçš„ç›®æ ‡æ˜¯è®©å¹¶å‘ç¼–ç¨‹æ›´ç®€å•ï¼Œä¸»è¦åº”ç”¨åœ¨ä»¥ç½‘ç»œç¼–ç¨‹ä¸ºä¸»çš„ I/O å¯†é›†åž‹åº”ç”¨ã€‚å®ƒæ˜¯å¼€æºçš„ï¼Œè·¨å¹³å°ï¼Œå¹¶ä¸”é«˜æ•ˆï¼ˆå°¤å…¶æ˜¯I/Oå¤„ç†ï¼‰ï¼ŒåŒ…æ‹¬IBMã€Microsoftã€Yahooã€SAPã€PayPalã€æ²ƒå°”çŽ›åŠGoDaddyéƒ½æ˜¯ Node.js çš„ç”¨æˆ·ã€‚ åŸºæœ¬åŽŸç†ä¸‹é¢æ˜¯ä¸€å¼  Node.js æ—©æœŸçš„æž¶æž„å›¾ï¼Œæ¥è‡ª Node.js ä¹‹çˆ¶ Ryan Dahl çš„æ¼”è®²ç¨¿ï¼Œåœ¨ä»Šå¤©ä¾ç„¶ä¸è¿‡æ—¶ï¼Œå®ƒç®€è¦çš„ä»‹ç»äº† Node.js æ˜¯åŸºäºŽ Chrome V8å¼•æ“Žæž„å»ºçš„ï¼Œç”±äº‹ä»¶å¾ªçŽ¯ï¼ˆEvent Loopï¼‰åˆ†å‘ I/O ä»»åŠ¡ï¼Œæœ€ç»ˆå·¥ä½œçº¿ç¨‹ï¼ˆWork Threadï¼‰å°†ä»»åŠ¡ä¸¢åˆ°çº¿ç¨‹æ± ï¼ˆThread Poolï¼‰é‡ŒåŽ»æ‰§è¡Œï¼Œè€Œäº‹ä»¶å¾ªçŽ¯åªè¦ç­‰å¾…æ‰§è¡Œç»“æžœå°±å¯ä»¥äº†ã€‚ æ ¸å¿ƒæ¦‚å¿µ:1.Chrome V8 æ˜¯ Google å‘å¸ƒçš„å¼€æº JavaScript å¼•æ“Žï¼Œé‡‡ç”¨ C/C++ ç¼–å†™ï¼Œåœ¨ Google çš„ Chrome æµè§ˆå™¨ä¸­è¢«ä½¿ç”¨ã€‚Chrome V8 å¼•æ“Žå¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åµŒå…¥åˆ° C/C++ åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œã€‚2.Event Loop äº‹ä»¶å¾ªçŽ¯ï¼ˆç”± libuv æä¾›ï¼‰3.Thread Pool çº¿ç¨‹æ± ï¼ˆç”± libuv æä¾›ï¼‰ æ¢³ç†åŽå¯ä»¥è¿™æ ·ç†è§£ï¼š1.Chrome V8 æ˜¯ JavaScript å¼•æ“Ž2.Node.js å†…ç½® Chrome V8 å¼•æ“Žï¼Œæ‰€ä»¥å®ƒä½¿ç”¨çš„ JavaScript è¯­æ³•3.JavaScript è¯­è¨€çš„ä¸€å¤§ç‰¹ç‚¹å°±æ˜¯å•çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªæ—¶é—´åªèƒ½åšä¸€ä»¶äº‹4å•çº¿ç¨‹å°±æ„å‘³ç€ï¼Œæ‰€æœ‰ä»»åŠ¡éœ€è¦æŽ’é˜Ÿï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸï¼Œæ‰ä¼šæ‰§è¡ŒåŽä¸€ä¸ªä»»åŠ¡ã€‚å¦‚æžœå‰ä¸€ä¸ªä»»åŠ¡è€—æ—¶å¾ˆé•¿ï¼ŒåŽä¸€ä¸ªä»»åŠ¡å°±ä¸å¾—ä¸ä¸€ç›´ç­‰ç€ã€‚5.å¦‚æžœæŽ’é˜Ÿæ˜¯å› ä¸ºè®¡ç®—é‡å¤§ï¼ŒCPU å¿™ä¸è¿‡æ¥ï¼Œå€’ä¹Ÿç®—äº†ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ CPU æ˜¯é—²ç€çš„ï¼Œå› ä¸º I/O å¾ˆæ…¢ï¼Œä¸å¾—ä¸ç­‰ç€ç»“æžœå‡ºæ¥ï¼Œå†å¾€ä¸‹æ‰§è¡Œ6.CPU å®Œå…¨å¯ä»¥ä¸ç®¡ I/O è®¾å¤‡ï¼ŒæŒ‚èµ·å¤„äºŽç­‰å¾…ä¸­çš„ä»»åŠ¡ï¼Œå…ˆè¿è¡ŒæŽ’åœ¨åŽé¢çš„ä»»åŠ¡7.å°†ç­‰å¾…ä¸­çš„ I/O ä»»åŠ¡æ”¾åˆ° Event Loop é‡Œ8.ç”± Event Loop å°† I/O ä»»åŠ¡æ”¾åˆ°çº¿ç¨‹æ± é‡Œ åªè¦æœ‰èµ„æºï¼Œå°±å°½åŠ›æ‰§è¡Œ å­¦ä¹  Node.js çš„ä¸‰ä¸ªå¢ƒç•Œ1.æ‰“æ—¥å¿— console.log2.æ–­ç‚¹è°ƒè¯•ï¼šæ–­ç‚¹è°ƒè¯•ï¼šnode debugger æˆ–node inspector æˆ–vscode3.æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆtdd | bddï¼‰ å®‰è£…Node.jsçŽ¯å¢ƒ3må®‰è£…æ³• nvmï¼ˆnode version managerï¼‰ã€éœ€è¦ä½¿ç”¨npmå®‰è£…ï¼Œæ›¿ä»£å“æ˜¯yrmï¼ˆæ”¯æŒyarnï¼‰ã€‘nrmï¼ˆnode registry managerï¼‰ã€éœ€è¦ä½¿ç”¨npmå®‰è£…ï¼Œæ›¿ä»£å“æ˜¯yrmï¼ˆæ”¯æŒyarnï¼‰ã€‘npmï¼ˆnode packages managerï¼‰ã€å†…ç½®ï¼Œæ›¿ä»£å“æ˜¯næˆ–nvsï¼ˆå¯¹winä¹Ÿæ”¯æŒï¼‰ã€‘ Node.jsåº”ç”¨åœºæ™¯ã€ŠNode.js in actionã€‹ä¸€ä¹¦é‡Œè¯´ï¼ŒNode.js æ‰€é’ˆå¯¹çš„åº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªä¸“é—¨çš„ç®€ç§°ï¼šDIRTã€‚å®ƒè¡¨ç¤ºæ•°æ®å¯†é›†åž‹å®žæ—¶ï¼ˆdata-intensive real-timeï¼‰ç¨‹åºã€‚å› ä¸º Node.js è‡ªèº«åœ¨ I/O ä¸Šéžå¸¸è½»é‡ï¼Œå®ƒå–„äºŽå°†æ•°æ®ä»Žä¸€ä¸ªç®¡é“æ··æŽ’æˆ–ä»£ç†åˆ°å¦ä¸€ä¸ªç®¡é“ä¸Šï¼Œè¿™èƒ½åœ¨å¤„ç†å¤§é‡è¯·æ±‚æ—¶æŒæœ‰å¾ˆå¤šå¼€æ”¾çš„è¿žæŽ¥ï¼Œå¹¶ä¸”åªå ç”¨ä¸€å°éƒ¨åˆ†å†…å­˜ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯ä¿è¯å“åº”èƒ½åŠ›ï¼Œè·Ÿæµè§ˆå™¨ä¸€æ ·ã€‚ è¿™è¯ä¸å‡ï¼Œä½†åœ¨ä»Šå¤©æ¥çœ‹ï¼ŒDIRT è¿˜æ˜¯èŒƒå›´å°äº†ã€‚å…¶å®ž DIRT æœ¬è´¨ä¸Šè¯´çš„ I/O å¤„ç†çš„éƒ½ç®—ï¼Œä½†éšç€å¤§å‰ç«¯çš„å‘å±•ï¼ŒNode.js å·²ç»ä¸å†åªæ˜¯ I/O å¤„ç†ç›¸å…³ï¼Œè€Œæ˜¯æ›´åŠ çš„â€œNodeâ€ï¼ Node.js ä½¿ç”¨åœºæ™¯ä¸»è¦åˆ†ä¸º4å¤§ç±» 1ï¼‰è·¨å¹³å°ï¼šè¦†ç›–ä½ èƒ½æƒ³åˆ°çš„é¢å‘ç”¨æˆ·çš„æ‰€æœ‰å¹³å°ï¼Œä¼ ç»Ÿçš„PC Webç«¯ï¼Œä»¥åŠPCå®¢æˆ·ç«¯ nw.js/electron ã€ç§»åŠ¨ç«¯ cordovaã€HTML5ã€react-nativeã€weexï¼Œç¡¬ä»¶ ruff.io ç­‰2ï¼‰Webåº”ç”¨å¼€å‘ï¼šç½‘ç«™ã€Apiã€RPCæœåŠ¡ç­‰3ï¼‰å‰ç«¯ï¼šä¸‰å¤§æ¡†æž¶ React \ Vue \ Angular è¾…åŠ©å¼€å‘ï¼Œä»¥åŠå·¥ç¨‹åŒ–æ¼”è¿›è¿‡ç¨‹ï¼ˆä½¿ç”¨Gulp /Webpack æž„å»º Web å¼€å‘å·¥å…·ï¼‰4ï¼‰å·¥å…·ï¼šnpmä¸Šå„ç§å·¥å…·æ¨¡å—ï¼ŒåŒ…æ‹¬å„ç§å‰ç«¯é¢„ç¼–è¯‘ã€æž„å»ºå·¥å…· Grunt / Gulpã€è„šæ‰‹æž¶ï¼Œå‘½ä»¤è¡Œå·¥å…·ï¼Œå„ç§å¥‡æŠ€æ·«å·§ç­‰ åˆ†ç±» æè¿° ç›¸å…³æ¨¡å— ç½‘ç«™ ç±»ä¼¼äºŽ cnodejs.org è¿™æ ·ä¼ ç»Ÿçš„ç½‘ç«™ Express / Koa Api åŒæ—¶æä¾›ç»™ç§»åŠ¨ç«¯ï¼ŒPCï¼ŒH5 ç­‰å‰ç«¯ä½¿ç”¨çš„ HTTP Api æŽ¥å£ Restify / HApi Apiä»£ç† ä¸ºå‰ç«¯æä¾›çš„ï¼Œä¸»è¦å¯¹åŽç«¯ApiæŽ¥å£è¿›è¡Œå†å¤„ç†ï¼Œä»¥ä¾¿æ›´å¤šçš„é€‚åº”å‰ç«¯å¼€å‘ Express / Koa IMå³æ—¶èŠå¤© å®žæ—¶åº”ç”¨ï¼Œå¾ˆå¤šæ˜¯åŸºäºŽ WebSocketåè®®çš„ Socket.io / sockjs åå‘ä»£ç† æä¾›ç±»ä¼¼äºŽ nginx åå‘ä»£ç†åŠŸèƒ½ï¼Œä½†å¯¹å‰ç«¯æ›´å‹å¥½ anyproxy / node-http-proxy / hiproxy å‰ç«¯æž„å»ºå·¥å…· è¾…åŠ©å‰ç«¯å¼€å‘ï¼Œå°¤å…¶æ˜¯å„ç§é¢„ç¼–è¯‘ï¼Œæž„å»ºç›¸å…³çš„å·¥å…·ï¼Œèƒ½å¤Ÿæžå¤§çš„æé«˜å‰ç«¯å¼€å‘æ•ˆçŽ‡ Grunt / Gulp / Bower / Webpack / Fis3 / YKit å‘½ä»¤è¡Œå·¥å…· ä½¿ç”¨å‘½ä»¤è¡Œæ˜¯éžå¸¸é…·çš„æ–¹å¼ï¼Œå‰ç«¯å¼€å‘è‡ªå®šä¹‰äº†å¾ˆå¤šç›¸å…³å·¥å…·ï¼Œæ— è®ºæ˜¯shellå‘½ä»¤ï¼Œnodeè„šæœ¬ï¼Œè¿˜æ˜¯å„ç§è„šæ‰‹æž¶ç­‰ï¼Œå‡ ä¹Žæ¯ä¸ªå…¬å¸\å°ç»„éƒ½ä¼šè‡ªå·±çš„å‘½ä»¤è¡Œå·¥å…·é›† Cordova / Shell.js æ“ä½œç³»ç»Ÿ æœ‰å®žçŽ°ï¼Œä½†ä¼°è®¡ä¸å¤ªä¼šæœ‰äººç”¨ NodeOS è·¨å¹³å°æ‰“åŒ…å·¥å…· ä½¿ç”¨ Web å¼€å‘æŠ€æœ¯å¼€å‘PCå®¢æˆ·ç«¯æ˜¯ç›®å‰æœ€æµè¡Œçš„æ–¹å¼ï¼Œä¼šæœ‰æ›´å¤šå‰ç«¯å¼€å‘å·¥å…·æ˜¯é‡‡ç”¨è¿™ç§æ–¹å¼çš„ PCç«¯çš„electronã€nw.jsï¼Œæ¯”å¦‚é’‰é’‰PCå®¢æˆ·ç«¯ã€å¾®ä¿¡å°ç¨‹åºIDEã€å¾®ä¿¡å®¢æˆ·ç«¯ï¼Œç§»åŠ¨çš„Cordovaï¼Œå³è€çš„Phonegapï¼Œè¿˜æœ‰æ›´åŠ æœ‰åçš„ä¸€ç«™å¼å¼€å‘æ¡†æž¶Ionicframework P2P åŒºå—é“¾å¼€å‘ã€BTå®¢æˆ·ç«¯ webtorrent / ipfs ç¼–è¾‘å™¨ Atom å’Œ VSCode éƒ½æ˜¯åŸºäºŽ electron æ¨¡å—çš„ electron ç‰©è”ç½‘ä¸Žç¡¬ä»¶ ruff.ioå’Œå¾ˆå¤šç¡¬ä»¶éƒ½æ”¯æŒnode sdk ruff Node.js åº”ç”¨åœºæ™¯éžå¸¸ä¸°å¯Œï¼Œæ¯”å¦‚ Node.js å¯ä»¥å¼€å‘æ“ä½œç³»ç»Ÿï¼Œä½†ä¸€èˆ¬æˆ‘éƒ½ä¸è®²çš„ï¼Œå°±ç®—è¯´äº†ä¹Ÿæ²¡å¤šå¤§æ„ä¹‰ï¼Œéš¾é“å¤§å®¶çœŸçš„ä¼šç”¨å—ï¼Ÿä¸€èˆ¬ï¼Œæˆ‘ä¹ æƒ¯å°† Node.js åº”ç”¨åœºæ™¯åˆ†ä¸º7ä¸ªéƒ¨åˆ†ã€‚ 1ï¼‰åˆè¡·ï¼Œserverç«¯ï¼Œä¸æƒ³æˆäº†å‰ç«¯å¼€å‘çš„åŸºç¡€è®¾æ–½2ï¼‰å‘½ä»¤è¡Œè¾…åŠ©å·¥å…·ï¼Œç”šè‡³å¯ä»¥æ˜¯è¿ç»´3ï¼‰ç§»åŠ¨ç«¯ï¼šcordovaï¼Œpcç«¯ï¼šnw.jså’Œelectron4ï¼‰ç»„ä»¶åŒ–ï¼Œæž„å»ºï¼Œä»£ç†5ï¼‰æž¶æž„ï¼Œå‰åŽç«¯åˆ†ç¦»ã€api proxy6ï¼‰æ€§èƒ½ä¼˜åŒ–ã€åçˆ¬è™«ä¸Žçˆ¬è™«7) å…¨æ ˆæœ€ä¾¿æ·ä¹‹è·¯ Nodeæ ¸å¿ƒï¼šå¼‚æ­¥æµç¨‹æŽ§åˆ¶Node.jsæ˜¯ä¸ºå¼‚æ­¥è€Œç”Ÿçš„ï¼Œå®ƒè‡ªå·±æŠŠå¤æ‚çš„äº‹å„¿åšäº†ï¼ˆé«˜å¹¶å‘ï¼Œä½Žå»¶æ—¶ï¼‰ï¼Œäº¤ç»™ç”¨æˆ·çš„åªæ˜¯æœ‰ç‚¹éš¾ç”¨çš„Callbackå†™æ³•ã€‚ä¹Ÿæ­£æ˜¯å¦è¯šçš„å°†å¼‚æ­¥å›žè°ƒæš´éœ²å‡ºæ¥ï¼Œæ‰æœ‰æ›´å¥½çš„æµç¨‹æŽ§åˆ¶æ–¹é¢çš„æ¼”è¿›ã€‚ä¹Ÿæ­£æ˜¯è¿™äº›æ¼”è¿›ï¼Œè®©Node.jsä»ŽDIRTï¼ˆæ•°æ®æ•æ„Ÿå®žæ—¶åº”ç”¨ï¼‰æ‰©å±•åˆ°æ›´å¤šçš„åº”ç”¨åœºæ™¯ï¼Œä»Šå¤©çš„Node.jså·²ç»ä¸åªæ˜¯èƒ½å†™åŽç«¯çš„JavaScriptï¼Œå·²ç»æ¶µç›–äº†æ‰€æœ‰æ¶‰åŠåˆ°å¼€å‘çš„å„ä¸ªæ–¹é¢ï¼Œè€ŒNodeå…¨æ ˆæ›´æ˜¯çƒ­é—¨ç§çš„çƒ­é—¨ã€‚ ç›´é¢é—®é¢˜æ‰èƒ½æœ‰æ›´å¥½çš„è§£å†³æ–¹å¼ï¼ŒNode.jsçš„å¼‚æ­¥æ˜¯æ•´ä¸ªå­¦ä¹ Node.jsè¿‡ç¨‹ä¸­é‡ä¸­ä¹‹é‡ã€‚ 1) å¼‚æ­¥æµç¨‹æŽ§åˆ¶å­¦ä¹ é‡ç‚¹2ï¼‰Apiå†™æ³•ï¼šError-first Callback å’Œ EventEmitter3ï¼‰ä¸­æµç ¥æŸ±ï¼šPromise4ï¼‰ç»ˆæžè§£å†³æ–¹æ¡ˆï¼šAsync/Await å¼‚æ­¥æµç¨‹æŽ§åˆ¶å­¦ä¹ é‡ç‚¹æˆ‘æ•´ç†äº†ä¸€å¼ å›¾ï¼Œæ›´ç›´è§‚ä¸€äº›ã€‚ä»Ž09å¹´åˆ°çŽ°åœ¨ï¼Œ8å¹´å¤šçš„æ—¶é—´é‡Œï¼Œæ•´ä¸ªNode.jsç¤¾åŒºåšäº†å¤§é‡å°è¯•ï¼Œå…¶ä¸­æ›²æŠ˜è¶³è¶³å¤Ÿå†™ä¸€æœ¬ä¹¦çš„äº†ã€‚å¤§å®¶å…ˆç®€å•äº†è§£ä¸€ä¸‹ã€‚ çº¢è‰²ä»£è¡¨Promiseï¼Œæ˜¯ä½¿ç”¨æœ€å¤šçš„ï¼Œæ— è®ºasyncè¿˜æ˜¯generatoréƒ½å¯ç”¨è“è‰²æ˜¯Generatorï¼Œè¿‡åº¦è´§ç»¿è‰²æ˜¯Asyncå‡½æ•°ï¼Œè¶‹åŠ¿ ç»“è®ºï¼šPromiseæ˜¯å¿…é¡»ä¼šçš„ï¼Œé‚£ä½ ä¸ºä»€ä¹ˆä¸é¡ºåŠ¿è€Œä¸ºå‘¢ï¼Ÿ æŽ¨èï¼šä½¿ç”¨Asyncå‡½æ•° + Promiseç»„åˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å…¶å®žï¼Œä¸€èˆ¬ä½¿ç”¨æ˜¯ä¸éœ€è¦æŽŒæ¡ä¸Šå›¾ä¸­çš„æ‰€æœ‰æŠ€æœ¯çš„ã€‚å¯¹äºŽåˆå­¦è€…æ¥è¯´ï¼Œå…ˆå¤Ÿç”¨ï¼Œå†åŽ»æ·±ç©¶ç»†èŠ‚ã€‚æ‰€ä»¥ï¼Œç²¾ç®€ä¸€ä¸‹ï¼Œåªäº†è§£3ä¸ªå°±è¶³å¤Ÿè¶³å¤Ÿç”¨äº†ã€‚ ç»“è®º 1.Node.js SDKé‡Œcallbackå†™æ³•å¿…é¡»ä¼šçš„ã€‚2.Node.jså­¦ä¹ é‡ç‚¹: Asyncå‡½æ•°ä¸ŽPromise 2.1ä¸­æµç ¥æŸ±ï¼šPromise 2.2ç»ˆæžè§£å†³æ–¹æ¡ˆï¼šAsync/Await Apiå†™æ³•ï¼šError-first Callback å’Œ EventEmitterError-first Callback å®šä¹‰é”™è¯¯ä¼˜å…ˆçš„å›žè°ƒå†™æ³•åªéœ€è¦æ³¨æ„2æ¡è§„åˆ™å³å¯ï¼š1.å›žè°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿”å›žçš„errorå¯¹è±¡ï¼Œå¦‚æžœerrorå‘ç”Ÿäº†ï¼Œå®ƒä¼šä½œä¸ºç¬¬ä¸€ä¸ªerrå‚æ•°è¿”å›žï¼Œå¦‚æžœæ²¡æœ‰ï¼Œä¸€èˆ¬åšæ³•æ˜¯è¿”å›žnullã€‚2.å›žè°ƒå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°è¿”å›žçš„æ˜¯ä»»ä½•æˆåŠŸå“åº”çš„ç»“æžœæ•°æ®ã€‚å¦‚æžœç»“æžœæ­£å¸¸ï¼Œæ²¡æœ‰errorå‘ç”Ÿï¼Œerrä¼šè¢«è®¾ç½®ä¸ºnullï¼Œå¹¶åœ¨ç¬¬äºŒä¸ªå‚æ•°å°±å‡ºè¿”å›žæˆåŠŸç»“æžœæ•°æ®ã€‚ ä¸‹é¢è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è°ƒç”¨å‡½æ•°ç¤ºä¾‹ï¼ŒNode.js æ–‡æ¡£é‡Œæœ€å¸¸é‡‡ç”¨ä¸‹é¢è¿™æ ·çš„å›žè°ƒæ–¹å¼ï¼š 123function(error,res)&#123; //process the error and result&#125; è¿™é‡Œçš„ callback æŒ‡çš„æ˜¯å¸¦æœ‰2ä¸ªå‚æ•°çš„å‡½æ•°ï¼šâ€errâ€å’Œ â€œresâ€ã€‚è¯­ä¹‰ä¸Šè®²ï¼Œéžç©ºçš„â€œerrâ€ç›¸å½“äºŽç¨‹åºå¼‚å¸¸ï¼›è€Œç©ºçš„â€œerrâ€ç›¸å½“äºŽå¯ä»¥æ­£å¸¸è¿”å›žç»“æžœâ€œresâ€ï¼Œæ— ä»»ä½•å¼‚å¸¸ã€‚ EventEmitteräº‹ä»¶æ¨¡å—æ˜¯ Node.js å†…ç½®çš„å¯¹è§‚å¯Ÿè€…æ¨¡å¼â€œå‘å¸ƒ/è®¢é˜…â€ï¼ˆpublish/subscribeï¼‰çš„å®žçŽ°ï¼Œé€šè¿‡EventEmitterå±žæ€§ï¼Œæä¾›äº†ä¸€ä¸ªæž„é€ å‡½æ•°ã€‚è¯¥æž„é€ å‡½æ•°çš„å®žä¾‹å…·æœ‰ on æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥ç›‘å¬æŒ‡å®šäº‹ä»¶ï¼Œå¹¶è§¦å‘å›žè°ƒå‡½æ•°ã€‚ä»»æ„å¯¹è±¡éƒ½å¯ä»¥å‘å¸ƒæŒ‡å®šäº‹ä»¶ï¼Œè¢« EventEmitter å®žä¾‹çš„ on æ–¹æ³•ç›‘å¬åˆ°ã€‚ åœ¨node 6ä¹‹åŽï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨require(â€˜eventsâ€™)ç±» 123456789101112131415var Emitter = require('events');var uilt = require('uilt');var myEmitter = function()&#123; util.inherits(MyEmitter, EventEmitter) const myEmitter = new MyEmitter(); myEmitter.on('event', (a, b) =&gt; &#123; console.log(a, b, this); // Prints: a b &#123;&#125; &#125;); myEmitter.emit('event', 'a', 'b');&#125; å’Œjqueryã€vueé‡Œçš„Eventæ˜¯éžå¸¸ç±»ä¼¼çš„ã€‚è€Œä¸”å‰ç«¯è‡ªå·±ä¹Ÿæœ‰EventEmitterã€‚ å¦‚ä½•æ›´å¥½çš„æŸ¥Node.jsæ–‡æ¡£APIæ˜¯åº”ç”¨ç¨‹åºæŽ¥å£Application Programming Interfaceçš„ç®€ç§°ã€‚ä»ŽNode.jså¼‚æ­¥åŽŸç†ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ ¸å¿ƒåœ¨äºŽ Node.js SDK ä¸­APIè°ƒç”¨ï¼Œç„¶åŽäº¤ç”±EventLoopï¼ˆLibuvï¼‰åŽ»æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å®šè¦ç†Ÿæ‚‰Node.jsçš„APIæ“ä½œã€‚ Node.jsçš„APIéƒ½æ˜¯å¼‚æ­¥çš„ï¼ŒåŒæ­¥çš„å‡½æ•°æ˜¯å¥¢æ±‚ï¼Œè¦æŸ¥APIæ–‡æ¡£ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹æ…Žç”¨ã€‚ ç¬”è€…æŽ¨èä½¿ç”¨ Dash æˆ– Zeal æŸ¥çœ‹ç¦»çº¿æ–‡æ¡£ï¼Œç»å¸¸æŸ¥çœ‹ç¦»çº¿æ–‡æ¡£ï¼Œå¯¹Apiç†è§£ä¼šæ·±å…¥å¾ˆå¤šï¼Œæ¯”IDEè¾…åŠ©è¦å¥½ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…ç¦»å¼€IDEå°±ä¸ä¼šå†™ä»£ç çš„çª˜å¢ƒã€‚ ä¸­æµç ¥æŸ±ï¼šPromiseNode.js å› ä¸ºé‡‡ç”¨äº†é”™è¯¯ä¼˜å…ˆçš„å›žè°ƒé£Žæ ¼å†™æ³•ï¼Œå¯¼è‡´sdké‡Œå¯¼å‡ºéƒ½æ˜¯å›žè°ƒå‡½æ•°ã€‚å¦‚æžœç»„åˆè°ƒç”¨çš„è¯ï¼Œå°±ä¼šç‰¹åˆ«ç—›è‹¦ï¼Œç»å¸¸ä¼šå‡ºçŽ°å›žè°ƒé‡ŒåµŒå¥—å›žè°ƒçš„é—®é¢˜ï¼Œå¤§å®¶éƒ½éžå¸¸åŽŒçƒ¦è¿™ç§å†™æ³•ï¼Œç§°ä¹‹ä¸ºCallback Hellï¼Œå³å›žè°ƒåœ°ç‹±ã€‚ä¸€ä¸ªç»å…¸çš„ä¾‹å­æ¥è‡ªè‘—åçš„Promiseæ¨¡å—qæ–‡æ¡£é‡Œã€‚ 123456789step1(function (value1) &#123; step2(value1, function(value2) &#123; step3(value2, function(value3) &#123; step4(value3, function(value4) &#123; // Do something with value4 &#125;); &#125;); &#125;);&#125;); è¿™é‡Œåªæ˜¯åš4æ­¥ï¼ŒåµŒå¥—äº†4å±‚å›žè°ƒï¼Œå¦‚æžœæ›´å¤šæ­¥éª¤å‘¢ï¼Ÿå¾ˆå¤šæ–°æ‰‹æµ…å°è¾„æ­¢ï¼Œåˆ°è¿™å„¿å°±æœ›è€Œå´æ­¥ï¼Œç²‰è½¬é»‘ã€‚è¿™æ˜Žæ˜¾ä¸å¤Ÿæˆç†Ÿï¼Œæœ€èµ·ç ä½ è¦çœ‹çœ‹å®ƒçš„åº”å¯¹è§£å†³æ–¹æ¡ˆå§ï¼ Node.js çº¦å®šæ‰€æœ‰Apiéƒ½é‡‡ç”¨é”™è¯¯ä¼˜å…ˆçš„å›žè°ƒæ–¹å¼ï¼Œè¿™éƒ¨åˆ†åœºæ™¯éƒ½æ˜¯å¤§å®¶ç›´æŽ¥è°ƒç”¨æŽ¥å£ï¼Œæ— å¤ªå¤šå˜åŒ–ã€‚è€ŒPromiseæ˜¯å¯¹å›žè°ƒåœ°ç‹±çš„æ€è€ƒï¼Œæˆ–è€…è¯´æ˜¯æ”¹è‰¯æ–¹æ¡ˆã€‚ç›®å‰ä½¿ç”¨éžå¸¸æ™®éï¼Œå¯ä»¥è¯´æ˜¯åœ¨asyncå‡½æ•°æ™®åŠä¹‹å‰å”¯ä¸€ä¸€ä¸ªé€šç”¨æ€§è§„èŒƒï¼Œç”šè‡³ Node.js ç¤¾åŒºéƒ½åœ¨è€ƒè™‘ Promise åŒ–ï¼Œå¯è§å…¶å½±å“ä¹‹å¤§ã€‚ Promiseæ„å‘³ç€[è®¸æ„¿|æ‰¿è¯º]ä¸€ä¸ªè¿˜æ²¡æœ‰å®Œæˆçš„æ“ä½œï¼Œä½†åœ¨æœªæ¥ä¼šå®Œæˆçš„ã€‚ä¸ŽPromiseæœ€ä¸»è¦çš„äº¤äº’æ–¹æ³•æ˜¯é€šè¿‡å°†å‡½æ•°ä¼ å…¥å®ƒçš„thenæ–¹æ³•ä»Žè€ŒèŽ·å–å¾—Promiseæœ€ç»ˆçš„å€¼æˆ–Promiseæœ€ç»ˆæœ€æ‹’ç»ï¼ˆrejectï¼‰çš„åŽŸå› ã€‚è¦ç‚¹æœ‰ä¸‰ä¸ªï¼š é€’å½’ï¼Œæ¯ä¸ªå¼‚æ­¥æ“ä½œè¿”å›žçš„éƒ½æ˜¯promiseå¯¹è±¡çŠ¶æ€æœºï¼šä¸‰ç§çŠ¶æ€è½¬æ¢ï¼Œåªåœ¨promiseå¯¹è±¡å†…éƒ¨å¯ä»¥æŽ§åˆ¶ï¼Œå¤–éƒ¨ä¸èƒ½æ”¹å˜çŠ¶æ€å…¨å±€å¼‚å¸¸å¤„ç† å®šä¹‰123456789var promise = new promise(function(resolve,reject)&#123; // do a thing, possibly async, thenâ€¦ if (/* everything turned out fine */) &#123; resolve("Stuff worked!"); //æˆåŠŸè¿”å›ž &#125; else &#123; reject(Error("It broke"));//å¤±è´¥è¿”å›ž &#125;&#125;) æ¯ä¸ªPromiseå®šä¹‰éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåœ¨æž„é€ å‡½æ•°é‡Œä¼ å…¥ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå‚æ•°æ˜¯resolveå’Œrejectï¼Œåˆ†åˆ«ä»£è¡¨æˆåŠŸå’Œå¤±è´¥æ—¶å€™çš„å¤„ç†ã€‚ è°ƒç”¨123456promise.then(function(text)&#123; console.log(text)// Stuff worked! return Promise.reject(new Error('æˆ‘æ˜¯æ•…æ„çš„'))&#125;).catch(function(err)&#123; console.log(err)&#125;) å®ƒçš„ä¸»è¦äº¤äº’æ–¹å¼æ˜¯é€šè¿‡thenå‡½æ•°ï¼Œå¦‚æžœPromiseæˆåŠŸæ‰§è¡Œresolveäº†ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå°†resolveçš„å€¼ä¼ ç»™æœ€è¿‘çš„thenå‡½æ•°ï¼Œä½œä¸ºå®ƒçš„thenå‡½æ•°çš„å‚æ•°ã€‚å¦‚æžœå‡ºé”™rejectï¼Œé‚£å°±äº¤ç»™catchæ¥æ•èŽ·å¼‚å¸¸å°±å¥½äº†ã€‚ Promise çš„æœ€å¤§ä¼˜åŠ¿æ˜¯æ ‡å‡†åŒ–ï¼Œå„ç±»å¼‚æ­¥å·¥å…·åº“éƒ½æŒ‰ç…§ç»Ÿä¸€è§„èŒƒå®žçŽ°ï¼Œå³ä½¿æ˜¯asyncå‡½æ•°ä¹Ÿå¯ä»¥æ— ç¼é›†æˆã€‚æ‰€ä»¥ç”¨ Promise å°è£… API é€šç”¨æ€§å¼ºï¼Œç”¨èµ·æ¥ç®€å•ï¼Œå­¦ä¹ æˆæœ¬ä½Žã€‚åœ¨asyncå‡½æ•°æ™®åŠä¹‹å‰ï¼Œç»å¤§éƒ¨åˆ†åº”ç”¨éƒ½æ˜¯é‡‡ç”¨Promiseæ¥åšå¼‚æ­¥æµç¨‹æŽ§åˆ¶çš„ï¼Œæ‰€ä»¥æŽŒæ¡Promiseæ˜¯Node.jså­¦ä¹ è¿‡ç¨‹ä¸­å¿…é¡»è¦æŽŒæ¡çš„é‡ä¸­ä¹‹é‡ã€‚ Bluebirdæ˜¯ Node.js ä¸–ç•Œé‡Œæ€§èƒ½æœ€å¥½çš„Promise/a+è§„èŒƒçš„å®žçŽ°æ¨¡å—ï¼ŒApiéžå¸¸é½å…¨ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œæ˜¯åŽŸç”ŸPromiseå¤–çš„ä¸äºŒé€‰æ‹©ã€‚ å¥½å¤„å¦‚ä¸‹ï¼š1.é¿å…Node.jså†…ç½®Promiseå®žçŽ° é—®é¢˜ï¼Œä½¿ç”¨ä¸Žæ‰€æœ‰ç‰ˆæœ¬å…¼å®¹2.é¿å…Node.js 4æ›¾ç»å‡ºçŽ°çš„å†…å­˜æ³„éœ²é—®é¢˜3.å†…ç½®æ›´å¤šæ‰©å±•ï¼Œtimeoutã€ promisifyAllç­‰ï¼Œå¯¹Promise/A+è§„èŒƒæä¾› æŽ¨èå­¦ä¹ èµ„æ–™ Node.jsæœ€æ–°æŠ€æœ¯æ ˆä¹‹Promiseç¯‡ https://cnodejs.org/topic/560dbc826a1ed28204a1e7deç†è§£ Promise çš„å·¥ä½œåŽŸç† https://cnodejs.org/topic/569c8226adf526da2aeb23fdPromise è¿·ä½ ä¹¦ http://liubin.github.io/promises-book/ ç»ˆæžè§£å†³æ–¹æ¡ˆï¼šAsync/AwaitAsync/Awaitæ˜¯å¼‚æ­¥æ“ä½œçš„ç»ˆæžè§£å†³æ–¹æ¡ˆï¼ŒKoa 2åœ¨node 7.6å‘å¸ƒä¹‹åŽï¼Œç«‹é©¬å‘å¸ƒäº†æ­£å¼ç‰ˆæœ¬ï¼Œå¹¶ä¸”æŽ¨èä½¿ç”¨asyncå‡½æ•°æ¥ç¼–å†™Koaä¸­é—´ä»¶ã€‚ è¿™é‡Œç»™å‡ºä¸€æ®µKoa 2åº”ç”¨é‡Œçš„ä¸€æ®µä»£ç  1234567891011exports.list = async (ctx, next) =&gt; &#123; try &#123; let students = await Student.getAllAsync(); await ctx.render('students/index', &#123; students : students &#125;) &#125; catch (err) &#123; return ctx.api_error(err); &#125;&#125;; å®ƒåšäº†3ä»¶äº‹å„¿ 1.é€šè¿‡await Student.getAllAsync();æ¥èŽ·å–æ‰€æœ‰çš„studentsä¿¡æ¯ã€‚2.é€šè¿‡await ctx.renderæ¸²æŸ“é¡µé¢3.ç”±äºŽæ˜¯åŒæ­¥ä»£ç ï¼Œä½¿ç”¨try/catchåšçš„å¼‚å¸¸å¤„ç† Asyncå‡½æ•°è¦ç‚¹å¦‚ä¸‹ï¼š Asyncå‡½æ•°è¯­ä¹‰ä¸Šéžå¸¸å¥½Asyncä¸éœ€è¦æ‰§è¡Œå™¨ï¼Œå®ƒæœ¬èº«å…·å¤‡æ‰§è¡Œèƒ½åŠ›ï¼Œä¸åƒGeneratoréœ€è¦coæ¨¡å—Asyncå‡½æ•°çš„å¼‚å¸¸å¤„ç†é‡‡ç”¨try/catchå’ŒPromiseçš„é”™è¯¯å¤„ç†ï¼Œéžå¸¸å¼ºå¤§AwaitæŽ¥Promiseï¼ŒPromiseè‡ªèº«å°±è¶³å¤Ÿåº”å¯¹æ‰€æœ‰æµç¨‹äº†ï¼ŒåŒ…æ‹¬asyncå‡½æ•°æ²¡æœ‰çº¯å¹¶è¡Œå¤„ç†æœºåˆ¶ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨Promiseé‡Œçš„allå’Œraceæ¥è¡¥é½Awaité‡Šæ”¾Promiseçš„ç»„åˆèƒ½åŠ›ï¼Œå¤–åŠ coå’ŒPromiseçš„thenï¼Œå‡ ä¹Žæ²¡æœ‰ä¸æ”¯æŒçš„åœºæ™¯ NodeJsæ¡†æž¶åˆ†ç±» æ¡†æž¶åç§° ç‰¹æ€§ ç‚¹è¯„ Express ç®€å•ã€å®žç”¨ï¼Œè·¯ç”±ä¸­é—´ä»¶ç­‰äº”è„ä¿±å…¨ æœ€è‘—åçš„Webæ¡†æž¶ Derby.js &amp;&amp; Meteor åŒæž„ å‰åŽç«¯éƒ½æ”¾åˆ°ä¸€èµ·ï¼Œæ¨¡ç³Šäº†å¼€å‘ä¾¿æ·ï¼Œçœ‹ä¸ŠåŽ»æ›´ç®€å•ï¼Œå®žé™…ä¸Šä¸Šå¯¹å¼€å‘æ¥è¯´è¦æ±‚æ›´é«˜ Sailsã€Total é¢å‘å…¶ä»–è¯­è¨€ï¼ŒRubyã€PHPç­‰ å€Ÿé‰´ä¸šç•Œä¼˜ç§€å®žçŽ°ï¼Œä¹Ÿæ˜¯ Node.js æˆç†Ÿçš„ä¸€ä¸ªæ ‡å¿— MEAN.js é¢å‘æž¶æž„ ç±»ä¼¼äºŽè„šæ‰‹æž¶ï¼ŒåˆæœŸæœ›åŒæž„ï¼Œç»“æžœåªæ˜¯è¹­äº†çƒ­ç‚¹ Hapiå’ŒRestfy é¢å‘Api &amp;&amp; å¾®æœåŠ¡ ç§»åŠ¨äº’è”ç½‘æ—¶ä»£Apiçš„ä½œç”¨è¢«æ”¾å¤§ï¼Œæ•…è€Œç‹¬ç«‹åˆ†ç±»ã€‚å°¤å…¶æ˜¯å¯¹äºŽå¾®æœåŠ¡å¼€å‘æ›´æ˜¯åˆ©å™¨ ThinkJS é¢å‘æ–°ç‰¹æ€§ å€Ÿé‰´ThinkPHPï¼Œå¹¶æ…¢æ…¢èµ°å‡ºè‡ªå·±çš„ä¸€æ¡è·¯ï¼Œå¯¹äºŽAsyncå‡½æ•°ç­‰æ–°ç‰¹æ€§æ”¯æŒï¼Œæ— å‡ºå…¶å³ï¼Œæ–°ç‰ˆv3.0æ˜¯åŸºäºŽKoa v2.0çš„ä½œä¸ºå†…æ ¸çš„ Ko ä¸“æ³¨äºŽå¼‚æ­¥æµç¨‹æ”¹è¿› ä¸‹ä¸€ä»£Webæ¡†æž¶ Egg åŸºäºŽKoaï¼Œåœ¨å¼€å‘ä¸Šæœ‰æžå¤§ä¾¿åˆ© ä¼ä¸šçº§Webå¼€å‘æ¡†æž¶ å¯¹äºŽæ¡†æž¶é€‰åž‹ ä¸šåŠ¡åœºæ™¯ã€ç‰¹ç‚¹ï¼Œä¸å¿…ä¸ºäº†ä»€ä¹ˆè€Œä»€ä¹ˆï¼Œé¿å…æœ¬æœ«å€’ç½®è‡ªèº«å›¢é˜Ÿèƒ½åŠ›ã€å–œå¥½ï¼Œæœ‰æ—¶å€™æŠ€æœ¯é€‰åž‹å†³å®šå›¢é˜Ÿæ°›å›´çš„ï¼Œéœ€è¦å¹³è¡¡æ¿€è¿›ä¸Žç¨³å®šå‡ºçŽ°é—®é¢˜çš„æ—¶å€™ï¼Œæœ‰äººèƒ½å¤Ÿåšåˆ°æºç çº§å®šåˆ¶ã€‚Node.js å·²ç»æœ‰8å¹´åŽ†å²ï¼Œä½†æ¨¡å—å®Œå–„ç¨‹åº¦è‰¯èŽ ä¸é½ï¼Œå¦‚æžœä¸æ…Žè¸©åˆ°ä¸€ä¸ªå‘é‡Œï¼Œéœ€è¦å›¢é˜Ÿåœ¨æ— å¤–åŠ›çš„æƒ…å†µèƒ½å¤Ÿæžå®šï¼Œå¦åˆ™ä¼šå½±å“è¿›åº¦ Webç¼–ç¨‹æ ¸å¿ƒ å¼‚æ­¥æµç¨‹æŽ§åˆ¶ï¼ˆå‰é¢è®²è¿‡äº†ï¼‰åŸºæœ¬æ¡†æž¶ Koaæˆ–Expressï¼Œæ–°æ‰‹æŽ¨èExpressï¼Œæ¯•ç«Ÿèµ„æ–™å¤šï¼Œä¸Šæ‰‹æ›´å®¹æ˜“ã€‚å¦‚æžœæœ‰ä¸€å®šç»éªŒï¼ŒæŽ¨èKoaï¼Œå…¶å®žè¿™äº›éƒ½æ˜¯ä¸ºäº†äº†è§£Webç¼–ç¨‹åŽŸç†ï¼Œå°¤å…¶æ˜¯ä¸­é—´ä»¶æœºåˆ¶ç†è§£ã€‚æ•°æ®åº“ mongodbæˆ–mysqléƒ½è¡Œï¼Œmongooseå’ŒSequelizeã€bookshelfï¼ŒTypeOrmç­‰éƒ½éžå¸¸ä¸é”™ã€‚å¯¹äºŽäº‹åŠ¡ï¼Œä¸æ˜¯Node.jsçš„é”…ï¼Œæ˜¯ä½ é€‰çš„æ•°æ®åº“çš„é—®é¢˜ã€‚å¦å¤–ä¸€äº›åé—¨ï¼Œæƒ³nodeè¿žsqlserverç­‰ä¼°è®¡è¿˜ä¸æˆç†Ÿï¼Œæˆ‘æ˜¯ä¸ä¼šè¿™æ ·ç”¨çš„ã€‚æ¨¡æ¿å¼•æ“Žï¼Œ ejsï¼Œjadeï¼Œnunjucksã€‚ç†è§£åŽŸç†æœ€å¥½ã€‚å°¤å…¶æ˜¯extendï¼Œincludeç­‰é«˜çº§ç”¨æ³•ï¼Œç†è§£å¸ƒå±€ï¼Œå¤ç”¨çš„å¥½å¤„ã€‚å…¶å®žå‰åŽç«¯æ€è·¯éƒ½æ˜¯ä¸€æ ·çš„ ä½œè€…:ç‹¼å”åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React æºç åˆ†æž 6 Reactåˆæˆäº‹ä»¶ç³»ç»Ÿ]]></title>
    <url>%2F2018%2F03%2F27%2FReact%2FReact-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-6-React%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E7%B3%BB%E7%BB%9F%2F</url>
    <content type="text"><![CDATA[Reactåˆæˆäº‹ä»¶ç‰¹ç‚¹Reactè‡ªå·±å®žçŽ°äº†ä¸€å¥—é«˜æ•ˆçš„äº‹ä»¶æ³¨å†Œï¼Œå­˜å‚¨ï¼Œåˆ†å‘å’Œé‡ç”¨é€»è¾‘ï¼Œåœ¨DOMäº‹ä»¶ä½“ç³»åŸºç¡€ä¸Šåšäº†å¾ˆå¤§æ”¹è¿›ï¼Œå‡å°‘äº†å†…å­˜æ¶ˆè€—ï¼Œç®€åŒ–äº†äº‹ä»¶é€»è¾‘ï¼Œå¹¶æœ€å¤§åŒ–çš„è§£å†³äº†IEç­‰æµè§ˆå™¨çš„ä¸å…¼å®¹é—®é¢˜ã€‚ä¸ŽDOMäº‹ä»¶ä½“ç³»ç›¸æ¯”ï¼Œå®ƒæœ‰å¦‚ä¸‹ç‰¹ç‚¹ 1.Reactç»„ä»¶ä¸Šå£°æ˜Žçš„äº‹ä»¶æœ€ç»ˆç»‘å®šåˆ°äº†documentè¿™ä¸ªDOMèŠ‚ç‚¹ä¸Šï¼Œè€Œä¸æ˜¯Reactç»„ä»¶å¯¹åº”çš„DOMèŠ‚ç‚¹ã€‚æ•…åªæœ‰documentè¿™ä¸ªèŠ‚ç‚¹ä¸Šé¢æ‰ç»‘å®šäº†DOMåŽŸç”Ÿäº‹ä»¶ï¼Œå…¶ä»–èŠ‚ç‚¹æ²¡æœ‰ç»‘å®šäº‹ä»¶ã€‚è¿™æ ·ç®€åŒ–äº†DOMåŽŸç”Ÿäº‹ä»¶ï¼Œå‡å°‘äº†å†…å­˜å¼€é”€ 2.Reactä»¥é˜Ÿåˆ—çš„æ–¹å¼ï¼Œä»Žè§¦å‘äº‹ä»¶çš„ç»„ä»¶å‘çˆ¶ç»„ä»¶å›žæº¯ï¼Œè°ƒç”¨å®ƒä»¬åœ¨JSXä¸­å£°æ˜Žçš„callbackã€‚ä¹Ÿå°±æ˜¯Reactè‡ªèº«å®žçŽ°äº†ä¸€å¥—äº‹ä»¶å†’æ³¡æœºåˆ¶ã€‚æˆ‘ä»¬æ²¡åŠžæ³•ç”¨event.stopPropagation()æ¥åœæ­¢äº‹ä»¶ä¼ æ’­ï¼Œåº”è¯¥ä½¿ç”¨event.preventDefault() 3.Reactæœ‰ä¸€å¥—è‡ªå·±çš„åˆæˆäº‹ä»¶SyntheticEventï¼Œä¸åŒç±»åž‹çš„äº‹ä»¶ä¼šæž„é€ ä¸åŒçš„SyntheticEvent 4.Reactä½¿ç”¨å¯¹è±¡æ± æ¥ç®¡ç†åˆæˆäº‹ä»¶å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯ï¼Œè¿™æ ·å‡å°‘äº†åžƒåœ¾çš„ç”Ÿæˆå’Œæ–°å¯¹è±¡å†…å­˜çš„åˆ†é…ï¼Œå¤§å¤§æé«˜äº†æ€§èƒ½ é‚£ä¹ˆè¿™äº›ç‰¹æ€§æ˜¯å¦‚ä½•å®žçŽ°çš„å‘¢ï¼Œä¸‹é¢å’Œå¤§å®¶ä¸€èµ·ä¸€æŽ¢ç©¶ç«Ÿã€‚ Reactäº‹ä»¶ç³»ç»Ÿå…ˆçœ‹Facebookç»™å‡ºçš„Reactäº‹ä»¶ç³»ç»Ÿæ¡†å›¾ æµè§ˆå™¨äº‹ä»¶ï¼ˆå¦‚ç”¨æˆ·ç‚¹å‡»äº†æŸä¸ªbuttonï¼‰è§¦å‘åŽï¼ŒDOMå°†eventä¼ ç»™ReactEventListenerï¼Œå®ƒå°†äº‹ä»¶åˆ†å‘åˆ°å½“å‰ç»„ä»¶åŠä»¥ä¸Šçš„çˆ¶ç»„ä»¶ã€‚ç„¶åŽç”±ReactEventEmitterå¯¹æ¯ä¸ªç»„ä»¶è¿›è¡Œäº‹ä»¶çš„æ‰§è¡Œï¼Œå…ˆæž„é€ Reactåˆæˆäº‹ä»¶ï¼Œç„¶åŽä»¥queueçš„æ–¹å¼è°ƒç”¨JSXä¸­å£°æ˜Žçš„callbackè¿›è¡Œäº‹ä»¶å›žè°ƒã€‚ æ¶‰åŠåˆ°çš„ä¸»è¦ç±»å¦‚ä¸‹ ReactEventListene:è´Ÿè´£äº‹ä»¶æ³¨å†Œå’Œäº‹ä»¶åˆ†å‘ã€‚Reactå°†DOMäº‹ä»¶å…¨éƒ½æ³¨å†Œåˆ°documentè¿™ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨äº‹ä»¶æ³¨å†Œå°èŠ‚è¯¦ç»†è®²ã€‚äº‹ä»¶åˆ†å‘ä¸»è¦è°ƒç”¨dispatchEventè¿›è¡Œï¼Œä»Žäº‹ä»¶è§¦å‘ç»„ä»¶å¼€å§‹ï¼Œå‘çˆ¶å…ƒç´ éåŽ†ã€‚æˆ‘ä»¬åœ¨äº‹ä»¶æ‰§è¡Œå°èŠ‚è¯¦ç»†è®²ã€‚ ReactEventEmitterï¼šè´Ÿè´£æ¯ä¸ªç»„ä»¶ä¸Šäº‹ä»¶çš„æ‰§è¡Œã€‚ EventPluginHubï¼šè´Ÿè´£äº‹ä»¶çš„å­˜å‚¨ï¼Œåˆæˆäº‹ä»¶ä»¥å¯¹è±¡æ± çš„æ–¹å¼å®žçŽ°åˆ›å»ºå’Œé”€æ¯ï¼Œå¤§å¤§æé«˜äº†æ€§èƒ½ã€‚ SimpleEventPluginç­‰pluginï¼šæ ¹æ®ä¸åŒçš„äº‹ä»¶ç±»åž‹ï¼Œæž„é€ ä¸åŒçš„åˆæˆäº‹ä»¶ã€‚å¦‚focuså¯¹åº”çš„Reactåˆæˆäº‹ä»¶ä¸ºSyntheticFocusEvent äº‹ä»¶æ³¨å†ŒJSXä¸­å£°æ˜Žä¸€ä¸ªReactäº‹ä»¶ååˆ†ç®€å•ï¼Œæ¯”å¦‚12345678render() &#123; return ( &lt;div onClick = &#123; (event) =&gt; &#123;console.log(JSON.stringify(event))&#125; &#125; /&gt; );&#125; é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•è¢«æ³¨å†Œåˆ°Reactäº‹ä»¶ç³»ç»Ÿä¸­çš„å‘¢ï¼Ÿ è¿˜æ˜¯å…ˆå¾—ä»Žç»„ä»¶åˆ›å»ºå’Œæ›´æ–°çš„å…¥å£æ–¹æ³•mountComponentå’ŒupdateComponentè¯´èµ·ã€‚åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­ï¼Œéƒ½ä¼šè°ƒç”¨åˆ°_updateDOMPropertiesæ–¹æ³•ï¼Œå¯¹JSXä¸­å£°æ˜Žçš„ç»„ä»¶å±žæ€§è¿›è¡Œå¤„ç†ã€‚æºç å¦‚ä¸‹ 123456789101112131415_updateDOMProperties: function (lastProps, nextProps, transaction) &#123; ... // å‰é¢ä»£ç å¤ªé•¿ï¼Œçœç•¥ä¸€éƒ¨åˆ† else if (registrationNameModules.hasOwnProperty(propKey)) &#123; // å¦‚æžœæ˜¯propsè¿™ä¸ªå¯¹è±¡ç›´æŽ¥å£°æ˜Žçš„å±žæ€§ï¼Œè€Œä¸æ˜¯ä»ŽåŽŸåž‹é“¾ä¸­ç»§æ‰¿è€Œæ¥çš„ï¼Œåˆ™å¤„ç†å®ƒ // nextPropè¡¨ç¤ºè¦åˆ›å»ºæˆ–è€…æ›´æ–°çš„å±žæ€§ï¼Œè€ŒlastPropåˆ™è¡¨ç¤ºä¸Šä¸€æ¬¡çš„å±žæ€§ // å¯¹äºŽmountComponentï¼ŒlastPropä¸ºnullã€‚updateComponentäºŒè€…éƒ½ä¸ä¸ºnullã€‚unmountComponentåˆ™nextPropä¸ºnull if (nextProp) &#123; // mountComponentå’ŒupdateComponentä¸­ï¼ŒenqueuePutListeneræ³¨å†Œäº‹ä»¶ enqueuePutListener(this, propKey, nextProp, transaction); &#125; else if (lastProp) &#123; // unmountComponentä¸­ï¼Œåˆ é™¤æ³¨å†Œçš„listenerï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ deleteListener(this, propKey); &#125; &#125;&#125; ä¸‹é¢æˆ‘ä»¬æ¥çœ‹enqueuePutListenerï¼Œå®ƒè´Ÿè´£æ³¨å†ŒJSXä¸­å£°æ˜Žçš„äº‹ä»¶ã€‚æºç å¦‚ä¸‹ 123456789101112131415161718192021// inst: React Componentå¯¹è±¡// registrationName: Reactåˆæˆäº‹ä»¶åï¼Œå¦‚onClick// listener: Reactäº‹ä»¶å›žè°ƒæ–¹æ³•ï¼Œå¦‚onClick=callbackä¸­çš„callback// transaction: mountComponentæˆ–updateComponentæ‰€å¤„çš„äº‹åŠ¡æµä¸­ï¼ŒReactéƒ½æ˜¯åŸºäºŽäº‹åŠ¡æµçš„function enqueuePutListener(inst, registrationName, listener, transaction) &#123; if (transaction instanceof ReactServerRenderingTransaction) &#123; return; &#125; var containerInfo = inst._hostContainerInfo; var isDocumentFragment = containerInfo._node &amp;&amp; containerInfo._node.nodeType === DOC_FRAGMENT_TYPE; // æ‰¾åˆ°document var doc = isDocumentFragment ? containerInfo._node : containerInfo._ownerDocument; // æ³¨å†Œäº‹ä»¶ï¼Œå°†äº‹ä»¶æ³¨å†Œåˆ°documentä¸Š listenTo(registrationName, doc); // å­˜å‚¨äº‹ä»¶,æ”¾å…¥äº‹åŠ¡é˜Ÿåˆ—ä¸­ transaction.getReactMountReady().enqueue(putListener, &#123; inst: inst, registrationName: registrationName, listener: listener &#125;);&#125; enqueuePutListenerä¸»è¦åšä¸¤ä»¶äº‹ï¼Œä¸€æ–¹é¢å°†äº‹ä»¶æ³¨å†Œåˆ°documentè¿™ä¸ªåŽŸç”ŸDOMä¸Šï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåªæœ‰documentè¿™ä¸ªèŠ‚ç‚¹æœ‰DOMäº‹ä»¶çš„åŽŸå› ï¼‰ï¼Œå¦ä¸€æ–¹é¢é‡‡ç”¨äº‹åŠ¡é˜Ÿåˆ—çš„æ–¹å¼è°ƒç”¨putListenerå°†æ³¨å†Œçš„äº‹ä»¶å­˜å‚¨èµ·æ¥ï¼Œä»¥ä¾›äº‹ä»¶è§¦å‘æ—¶å›žè°ƒã€‚ æ³¨å†Œäº‹ä»¶çš„å…¥å£æ˜¯listenToæ–¹æ³•, å®ƒè§£å†³äº†ä¸åŒæµè§ˆå™¨é—´æ•èŽ·å’Œå†’æ³¡ä¸å…¼å®¹çš„é—®é¢˜ã€‚äº‹ä»¶å›žè°ƒæ–¹æ³•åœ¨bubbleé˜¶æ®µè¢«è§¦å‘ã€‚å¦‚æžœæˆ‘ä»¬æƒ³è®©å®ƒåœ¨captureé˜¶æ®µè§¦å‘ï¼Œåˆ™éœ€è¦åœ¨äº‹ä»¶åä¸ŠåŠ ä¸Šcaptureã€‚æ¯”å¦‚onClickåœ¨bubbleé˜¶æ®µè§¦å‘ï¼Œè€ŒonCaptureClickåœ¨captureé˜¶æ®µè§¦å‘ã€‚listenToä»£ç è™½ç„¶æ¯”è¾ƒé•¿ï¼Œä½†é€»è¾‘å¾ˆç®€å•ï¼Œè°ƒç”¨trapCapturedEventå’ŒtrapBubbledEventæ¥æ³¨å†Œæ•èŽ·å’Œå†’æ³¡äº‹ä»¶ã€‚trapCapturedEventå¤§å®¶å¯ä»¥è‡ªè¡Œåˆ†æžï¼Œæˆ‘ä»¬ä»…åˆ†æžtrapBubbledEventï¼Œå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031trapBubbledEvent: function (topLevelType, handlerBaseName, element) &#123; if (!element) &#123; return null; &#125; return EventListener.listen( element, // ç»‘å®šåˆ°çš„DOMç›®æ ‡,ä¹Ÿå°±æ˜¯document handlerBaseName, // eventType ReactEventListener.dispatchEvent.bind(null, topLevelType)); // callback, documentä¸Šçš„åŽŸç”Ÿäº‹ä»¶è§¦å‘åŽå›žè°ƒ &#125;, listen: function listen(target, eventType, callback) &#123; if (target.addEventListener) &#123; // å°†åŽŸç”Ÿäº‹ä»¶æ·»åŠ åˆ°targetè¿™ä¸ªdomä¸Š,ä¹Ÿå°±æ˜¯documentä¸Šã€‚ // è¿™å°±æ˜¯åªæœ‰documentè¿™ä¸ªDOMèŠ‚ç‚¹ä¸Šæœ‰åŽŸç”Ÿäº‹ä»¶çš„åŽŸå›  target.addEventListener(eventType, callback, false); return &#123; // åˆ é™¤äº‹ä»¶,è¿™ä¸ªç”±Reactè‡ªå·±å›žè°ƒ,ä¸éœ€è¦è°ƒç”¨è€…æ¥é”€æ¯ã€‚ä½†ä»…ä»…å¯¹äºŽReactåˆæˆäº‹ä»¶æ‰è¡Œ remove: function remove() &#123; target.removeEventListener(eventType, callback, false); &#125; &#125;; &#125; else if (target.attachEvent) &#123; // attachå’Œdetachçš„æ–¹å¼ target.attachEvent('on' + eventType, callback); return &#123; remove: function remove() &#123; target.detachEvent('on' + eventType, callback); &#125; &#125;; &#125; &#125;, åœ¨listenæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ç»ˆäºŽå‘çŽ°äº†ç†Ÿæ‚‰çš„addEventListenerè¿™ä¸ªåŽŸç”Ÿäº‹ä»¶æ³¨å†Œæ–¹æ³•ã€‚åªæœ‰documentèŠ‚ç‚¹æ‰ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ•…ä»…ä»…åªæœ‰documentèŠ‚ç‚¹ä¸Šæ‰æœ‰DOMäº‹ä»¶ã€‚è¿™å¤§å¤§ç®€åŒ–äº†DOMäº‹ä»¶é€»è¾‘ï¼Œä¹ŸèŠ‚çº¦äº†å†…å­˜ã€‚ äº‹ä»¶å­˜å‚¨äº‹ä»¶å­˜å‚¨ç”±EventPluginHubæ¥è´Ÿè´£ï¼Œå®ƒçš„å…¥å£åœ¨æˆ‘ä»¬ä¸Šé¢è®²åˆ°çš„enqueuePutListenerä¸­çš„putListeneræ–¹æ³•ï¼Œå¦‚ä¸‹ 123456789101112131415161718192021222324252627 /** * EventPluginHubç”¨æ¥å­˜å‚¨Reactäº‹ä»¶, å°†listenerå­˜å‚¨åˆ°`listenerBank[registrationName][key]` * * @param &#123;object&#125; inst: äº‹ä»¶æº * @param &#123;string&#125; listenerçš„åå­—,æ¯”å¦‚onClick * @param &#123;function&#125; listenerçš„callback */ // putListener: function (inst, registrationName, listener) &#123; // ç”¨æ¥æ ‡è¯†æ³¨å†Œäº†äº‹ä»¶,æ¯”å¦‚onClickçš„Reactå¯¹è±¡ã€‚keyçš„æ ¼å¼ä¸º'.nodeId', åªç”¨çŸ¥é“å®ƒå¯ä»¥æ ‡ç¤ºå“ªä¸ªReactå¯¹è±¡å°±å¯ä»¥äº† var key = getDictionaryKey(inst); var bankForRegistrationName = listenerBank[registrationName] || (listenerBank[registrationName] = &#123;&#125;); // å°†listeneräº‹ä»¶å›žè°ƒæ–¹æ³•å­˜å…¥listenerBank[registrationName][key]ä¸­,æ¯”å¦‚listenerBank['onclick'][nodeId] // æ‰€æœ‰Reactç»„ä»¶å¯¹è±¡å®šä¹‰çš„æ‰€æœ‰Reactäº‹ä»¶éƒ½ä¼šå­˜å‚¨åœ¨listenerBankä¸­ bankForRegistrationName[key] = listener; //onSelectå’ŒonClickæ³¨å†Œäº†ä¸¤ä¸ªäº‹ä»¶å›žè°ƒæ’ä»¶, ç”¨äºŽwalkAroundæŸäº›æµè§ˆå™¨å…¼å®¹bug,ä¸ç”¨care var PluginModule = EventPluginRegistry.registrationNameModules[registrationName]; if (PluginModule &amp;&amp; PluginModule.didPutListener) &#123; PluginModule.didPutListener(inst, registrationName, listener); &#125; &#125;, var getDictionaryKey = function (inst) &#123; return '.' + inst._rootNodeID;&#125;; ç”±ä¸Šå¯è§ï¼Œäº‹ä»¶å­˜å‚¨åœ¨äº†listenerBankå¯¹è±¡ä¸­ï¼Œå®ƒæŒ‰ç…§äº‹ä»¶åå’ŒReactç»„ä»¶å¯¹è±¡è¿›è¡Œäº†äºŒç»´åˆ’åˆ†ï¼Œæ¯”å¦‚nodeIdç»„ä»¶ä¸Šæ³¨å†Œçš„onClickäº‹ä»¶æœ€åŽå­˜å‚¨åœ¨listenerBank.onclick[nodeId]ä¸­ äº‹ä»¶æ‰§è¡Œäº‹ä»¶åˆ†å‘å½“äº‹ä»¶è§¦å‘æ—¶ï¼Œdocumentä¸ŠaddEventListeneræ³¨å†Œçš„callbackä¼šè¢«å›žè°ƒã€‚ä»Žå‰é¢äº‹ä»¶æ³¨å†Œéƒ¨åˆ†å‘çŽ°ï¼Œæ­¤æ—¶å›žè°ƒå‡½æ•°ä¸ºReactEventListener.dispatchEventï¼Œå®ƒæ˜¯äº‹ä»¶åˆ†å‘çš„å…¥å£æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†åˆ†æž 12345678910111213141516// topLevelTypeï¼šå¸¦topçš„äº‹ä»¶åï¼Œå¦‚topClickã€‚ä¸ç”¨çº ç»“ä¸ºä»€ä¹ˆå¸¦ä¸€ä¸ªtopå­—æ®µï¼ŒçŸ¥é“å®ƒæ˜¯äº‹ä»¶åå°±OKäº†// nativeEvent: ç”¨æˆ·è§¦å‘clickç­‰äº‹ä»¶æ—¶ï¼Œæµè§ˆå™¨ä¼ é€’çš„åŽŸç”Ÿäº‹ä»¶dispatchEvent: function (topLevelType, nativeEvent) &#123; // disableäº†åˆ™ç›´æŽ¥ä¸å›žè°ƒç›¸å…³æ–¹æ³• if (!ReactEventListener._enabled) &#123; return; &#125; var bookKeeping = TopLevelCallbackBookKeeping.getPooled(topLevelType, nativeEvent); try &#123; // æ”¾å…¥æ‰¹å¤„ç†é˜Ÿåˆ—ä¸­,Reactäº‹ä»¶æµä¹Ÿæ˜¯ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼ ReactUpdates.batchedUpdates(handleTopLevelImpl, bookKeeping); &#125; finally &#123; TopLevelCallbackBookKeeping.release(bookKeeping); &#125;&#125; å¯è§æˆ‘ä»¬ä»ç„¶ä½¿ç”¨æ‰¹å¤„ç†çš„æ–¹å¼è¿›è¡Œäº‹ä»¶åˆ†å‘ï¼ŒhandleTopLevelImplæ‰æ˜¯äº‹ä»¶åˆ†å‘çš„çœŸæ­£æ‰§è¡Œè€…ï¼Œå®ƒæ˜¯äº‹ä»¶åˆ†å‘çš„æ ¸å¿ƒï¼Œä½“çŽ°äº†Reactäº‹ä»¶åˆ†å‘çš„ç‰¹ç‚¹ï¼Œå¦‚ä¸‹ 123456789101112131415161718192021// documentè¿›è¡Œäº‹ä»¶åˆ†å‘,è¿™æ ·å…·ä½“çš„Reactç»„ä»¶æ‰èƒ½å¾—åˆ°å“åº”ã€‚å› ä¸ºDOMäº‹ä»¶æ˜¯ç»‘å®šåˆ°documentä¸Šçš„function handleTopLevelImpl(bookKeeping) &#123; // æ‰¾åˆ°äº‹ä»¶è§¦å‘çš„DOMå’ŒReact Component var nativeEventTarget = getEventTarget(bookKeeping.nativeEvent); var targetInst = ReactDOMComponentTree.getClosestInstanceFromNode(nativeEventTarget); // æ‰§è¡Œäº‹ä»¶å›žè°ƒå‰,å…ˆç”±å½“å‰ç»„ä»¶å‘ä¸ŠéåŽ†å®ƒçš„æ‰€æœ‰çˆ¶ç»„ä»¶ã€‚å¾—åˆ°ancestorsè¿™ä¸ªæ•°ç»„ã€‚ // å› ä¸ºäº‹ä»¶å›žè°ƒä¸­å¯èƒ½ä¼šæ”¹å˜Virtual DOMç»“æž„,æ‰€ä»¥è¦å…ˆéåŽ†å¥½ç»„ä»¶å±‚çº§ var ancestor = targetInst; do &#123; bookKeeping.ancestors.push(ancestor); ancestor = ancestor &amp;&amp; findParent(ancestor); &#125; while (ancestor); // ä»Žå½“å‰ç»„ä»¶å‘çˆ¶ç»„ä»¶éåŽ†,ä¾æ¬¡æ‰§è¡Œæ³¨å†Œçš„å›žè°ƒæ–¹æ³•. æˆ‘ä»¬éåŽ†æž„é€ ancestorsæ•°ç»„æ—¶,æ˜¯ä»Žå½“å‰ç»„ä»¶å‘çˆ¶ç»„ä»¶å›žæº¯çš„,æ•…æ­¤å¤„äº‹ä»¶å›žè°ƒä¹Ÿæ˜¯è¿™ä¸ªé¡ºåº // è¿™ä¸ªé¡ºåºå°±æ˜¯å†’æ³¡çš„é¡ºåº,å¹¶ä¸”æˆ‘ä»¬å‘çŽ°ä¸èƒ½é€šè¿‡stopPropagationæ¥é˜»æ­¢'å†’æ³¡'ã€‚ for (var i = 0; i &lt; bookKeeping.ancestors.length; i++) &#123; targetInst = bookKeeping.ancestors[i]; ReactEventListener._handleTopLevel(bookKeeping.topLevelType, targetInst, bookKeeping.nativeEvent, getEventTarget(bookKeeping.nativeEvent)); &#125;&#125; ä»Žä¸Šé¢çš„äº‹ä»¶åˆ†å‘ä¸­å¯è§ï¼ŒReactè‡ªèº«å®žçŽ°äº†ä¸€å¥—å†’æ³¡æœºåˆ¶ã€‚ä»Žè§¦å‘äº‹ä»¶çš„å¯¹è±¡å¼€å§‹ï¼Œå‘çˆ¶å…ƒç´ å›žæº¯ï¼Œä¾æ¬¡è°ƒç”¨å®ƒä»¬æ³¨å†Œçš„äº‹ä»¶callback äº‹ä»¶callback è°ƒç”¨äº‹ä»¶å¤„ç†ç”±_handleTopLevelå®Œæˆã€‚å®ƒå…¶å®žæ˜¯è°ƒç”¨ReactBrowserEventEmitter.handleTopLevel() ï¼Œå¦‚ä¸‹ 1234567// Reactäº‹ä»¶è°ƒç”¨çš„å…¥å£ã€‚DOMäº‹ä»¶ç»‘å®šåœ¨äº†documentåŽŸç”Ÿå¯¹è±¡ä¸Š,æ¯æ¬¡äº‹ä»¶è§¦å‘,éƒ½ä¼šè°ƒç”¨åˆ°handleTopLevel handleTopLevel: function (topLevelType, targetInst, nativeEvent, nativeEventTarget) &#123; // é‡‡ç”¨å¯¹è±¡æ± çš„æ–¹å¼æž„é€ å‡ºåˆæˆäº‹ä»¶ã€‚ä¸åŒçš„eventTypeçš„åˆæˆäº‹ä»¶å¯èƒ½ä¸åŒ var events = EventPluginHub.extractEvents(topLevelType, targetInst, nativeEvent, nativeEventTarget); // æ‰¹å¤„ç†é˜Ÿåˆ—ä¸­çš„events runEventQueueInBatch(events); &#125; handleTopLevelæ–¹æ³•æ˜¯äº‹ä»¶callbackè°ƒç”¨çš„æ ¸å¿ƒã€‚å®ƒä¸»è¦åšä¸¤ä»¶äº‹æƒ…ï¼Œä¸€æ–¹é¢åˆ©ç”¨æµè§ˆå™¨å›žä¼ çš„åŽŸç”Ÿäº‹ä»¶æž„é€ å‡ºReactåˆæˆäº‹ä»¶ï¼Œå¦ä¸€æ–¹é¢é‡‡ç”¨é˜Ÿåˆ—çš„æ–¹å¼å¤„ç†eventsã€‚å…ˆçœ‹å¦‚ä½•æž„é€ åˆæˆäº‹ä»¶ã€‚ æž„é€ åˆæˆäº‹ä»¶123456789101112131415161718// æž„é€ åˆæˆäº‹ä»¶ extractEvents: function (topLevelType, targetInst, nativeEvent, nativeEventTarget) &#123; var events; // EventPluginHubå¯ä»¥å­˜å‚¨Reactåˆæˆäº‹ä»¶çš„callback,ä¹Ÿå­˜å‚¨äº†ä¸€äº›plugin,è¿™äº›pluginåœ¨EventPluginHubåˆå§‹åŒ–æ—¶å°±æ³¨å†Œå°±æ¥äº† var plugins = EventPluginRegistry.plugins; for (var i = 0; i &lt; plugins.length; i++) &#123; var possiblePlugin = plugins[i]; if (possiblePlugin) &#123; // æ ¹æ®eventTypeæž„é€ ä¸åŒçš„åˆæˆäº‹ä»¶SyntheticEvent var extractedEvents = possiblePlugin.extractEvents(topLevelType, targetInst, nativeEvent, nativeEventTarget); if (extractedEvents) &#123; // å°†æž„é€ å¥½çš„åˆæˆäº‹ä»¶extractedEventsæ·»åŠ åˆ°eventsæ•°ç»„ä¸­,è¿™æ ·å°±ä¿å­˜äº†æ‰€æœ‰pluginæž„é€ çš„åˆæˆäº‹ä»¶ events = accumulateInto(events, extractedEvents); &#125; &#125; &#125; return events; &#125;, EventPluginRegistry.pluginsé»˜è®¤åŒ…å«äº”ç§pluginï¼Œä»–ä»¬æ˜¯åœ¨EventPluginHubåˆå§‹åŒ–é˜¶æ®µæ³¨å…¥è¿›åŽ»çš„ï¼Œä¸”çœ‹ä»£ç  12345678// å°†eventPluginæ³¨å†Œåˆ°EventPluginHubä¸­ReactInjection.EventPluginHub.injectEventPluginsByName(&#123; SimpleEventPlugin: SimpleEventPlugin, EnterLeaveEventPlugin: EnterLeaveEventPlugin, ChangeEventPlugin: ChangeEventPlugin, SelectEventPlugin: SelectEventPlugin, BeforeInputEventPlugin: BeforeInputEventPlugin&#125;); ä¸åŒçš„pluginé’ˆå¯¹ä¸åŒçš„äº‹ä»¶æœ‰ç‰¹æ®Šçš„å¤„ç†ï¼Œæ­¤å¤„æˆ‘ä»¬ä¸å±•å¼€è®²äº†ï¼Œä¸‹é¢ä»…åˆ†æžSimpleEventPluginä¸­æ–¹æ³•å³å¯ã€‚ æˆ‘ä»¬å…ˆçœ‹SimpleEventPluginå¦‚ä½•æž„é€ å®ƒæ‰€å¯¹åº”çš„Reactåˆæˆäº‹ä»¶ã€‚ 1234567891011121314151617181920212223 // æ ¹æ®ä¸åŒäº‹ä»¶ç±»åž‹,æ¯”å¦‚click,focusæž„é€ ä¸åŒçš„åˆæˆäº‹ä»¶SyntheticEvent, å¦‚SyntheticKeyboardEvent SyntheticFocusEventextractEvents: function (topLevelType, targetInst, nativeEvent, nativeEventTarget) &#123; var dispatchConfig = topLevelEventsToDispatchConfig[topLevelType]; if (!dispatchConfig) &#123; return null; &#125; var EventConstructor; // æ ¹æ®äº‹ä»¶ç±»åž‹ï¼Œé‡‡ç”¨ä¸åŒçš„SyntheticEventæ¥æž„é€ ä¸åŒçš„åˆæˆäº‹ä»¶ switch (topLevelType) &#123; ... // çœç•¥ä¸€äº›äº‹ä»¶ï¼Œæˆ‘ä»¬ä»…ä»¥blurå’Œfocusä¸ºä¾‹ case 'topBlur': case 'topFocus': EventConstructor = SyntheticFocusEvent; break; ... // çœç•¥ä¸€äº›äº‹ä»¶ &#125; // ä»Ževentå¯¹è±¡æ± ä¸­å–å‡ºåˆæˆäº‹ä»¶å¯¹è±¡,åˆ©ç”¨å¯¹è±¡æ± æ€æƒ³,å¯ä»¥å¤§å¤§é™ä½Žå¯¹è±¡åˆ›å»ºå’Œé”€æ¯çš„æ—¶é—´,æé«˜æ€§èƒ½ã€‚è¿™æ˜¯Reactäº‹ä»¶ç³»ç»Ÿçš„ä¸€å¤§äº®ç‚¹ var event = EventConstructor.getPooled(dispatchConfig, targetInst, nativeEvent, nativeEventTarget); EventPropagators.accumulateTwoPhaseDispatches(event); return event;&#125;, è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°äº†eventå¯¹è±¡æ± è¿™ä¸ªé‡å¤§ç‰¹æ€§ï¼Œé‡‡ç”¨åˆæˆäº‹ä»¶å¯¹è±¡æ± çš„æ–¹å¼ï¼Œå¯ä»¥å¤§å¤§é™ä½Žé”€æ¯å’Œåˆ›å»ºåˆæˆäº‹ä»¶å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚ å¯¹è±¡åˆ›å»ºå¥½ä¹‹åŽï¼Œæˆ‘ä»¬è¿˜ä¼šå°†å®ƒæ·»åŠ åˆ°eventsè¿™ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå› ä¸ºäº‹ä»¶å›žè°ƒçš„æ—¶å€™ä¼šç”¨åˆ°è¿™ä¸ªé˜Ÿåˆ—ã€‚æ·»åŠ åˆ°eventsä¸­ä½¿ç”¨çš„æ˜¯accumulateIntoæ–¹æ³•ã€‚å®ƒæ€è·¯æ¯”è¾ƒç®€å•ï¼Œå°†æ–°åˆ›å»ºçš„åˆæˆå¯¹è±¡çš„å¼•ç”¨æ·»åŠ åˆ°ä¹‹å‰åˆ›å»ºå¥½çš„eventsé˜Ÿåˆ—ä¸­å³å¯ï¼Œæºç å¦‚ä¸‹ 123456789101112131415161718192021222324function accumulateInto(current, next) &#123; if (current == null) &#123; return next; &#125; // å°†nextæ·»åŠ åˆ°currentä¸­,è¿”å›žä¸€ä¸ªåŒ…å«ä»–ä»¬ä¸¤ä¸ªçš„æ–°æ•°ç»„ // å¦‚æžœnextæ˜¯æ•°ç»„,currentä¸æ˜¯æ•°ç»„,é‡‡ç”¨pushæ–¹æ³•,å¦åˆ™é‡‡ç”¨concatæ–¹æ³• // å¦‚æžœnextä¸æ˜¯æ•°ç»„,åˆ™è¿”å›žä¸€ä¸ªcurrentå’Œnextæž„æˆçš„æ–°æ•°ç»„ if (Array.isArray(current)) &#123; if (Array.isArray(next)) &#123; current.push.apply(current, next); return current; &#125; current.push(next); return current; &#125; if (Array.isArray(next)) &#123; return [current].concat(next); &#125; return [current, next];&#125; æ‰¹é‡å¤„ç†åˆæˆäº‹ä»¶æˆ‘ä»¬ä¸Šé¢åˆ†æžè¿‡äº†ï¼ŒReactä»¥é˜Ÿåˆ—çš„å½¢å¼å¤„ç†åˆæˆäº‹ä»¶ã€‚æ–¹æ³•å…¥å£ä¸ºrunEventQueueInBatchï¼Œå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637function runEventQueueInBatch(events) &#123; // å…ˆå°†eventsäº‹ä»¶æ”¾å…¥é˜Ÿåˆ—ä¸­ EventPluginHub.enqueueEvents(events); // å†å¤„ç†é˜Ÿåˆ—ä¸­çš„äº‹ä»¶,åŒ…æ‹¬ä¹‹å‰æœªå¤„ç†å®Œçš„ã€‚å…ˆå…¥å…ˆå¤„ç†åŽŸåˆ™ EventPluginHub.processEventQueue(false);&#125;/** * syntheticEventæ”¾å…¥é˜Ÿåˆ—ä¸­,ç­‰åˆ°processEventQueueå†èŽ·å¾—æ‰§è¡Œ */enqueueEvents: function (events) &#123; if (events) &#123; eventQueue = accumulateInto(eventQueue, events); &#125;&#125;, /** * åˆ†å‘æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„Reactåˆæˆäº‹ä»¶ã€‚Reactäº‹ä»¶æ˜¯é‡‡ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ–¹å¼æ‰¹å¤„ç†çš„ * * simulatedï¼šä¸ºtrueè¡¨ç¤ºReactæµ‹è¯•ä»£ç ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯false */processEventQueue: function (simulated) &#123; // å…ˆå°†eventQueueé‡ç½®ä¸ºç©º var processingEventQueue = eventQueue; eventQueue = null; if (simulated) &#123; forEachAccumulated(processingEventQueue, executeDispatchesAndReleaseSimulated); &#125; else &#123; // éåŽ†å¤„ç†é˜Ÿåˆ—ä¸­çš„äº‹ä»¶, // å¦‚æžœåªæœ‰ä¸€ä¸ªå…ƒç´ ,åˆ™ç›´æŽ¥executeDispatchesAndReleaseTopLevel(processingEventQueue) // å¦åˆ™éåŽ†é˜Ÿåˆ—ä¸­äº‹ä»¶,è°ƒç”¨executeDispatchesAndReleaseTopLevelå¤„ç†æ¯ä¸ªå…ƒç´  forEachAccumulated(processingEventQueue, executeDispatchesAndReleaseTopLevel); &#125; // This would be a good time to rethrow if any of the event handlers threw. ReactErrorUtils.rethrowCaughtError();&#125;, åˆæˆäº‹ä»¶å¤„ç†ä¹Ÿåˆ†ä¸ºä¸¤æ­¥ï¼Œå…ˆå°†æˆ‘ä»¬è¦å¤„ç†çš„eventsé˜Ÿåˆ—æ”¾å…¥eventQueueä¸­ï¼Œå› ä¸ºä¹‹å‰å¯èƒ½å°±å­˜åœ¨è¿˜æ²¡å¤„ç†å®Œçš„åˆæˆäº‹ä»¶ã€‚ç„¶åŽå†æ‰§è¡ŒeventQueueä¸­çš„äº‹ä»¶ã€‚å¯è§ï¼Œå¦‚æžœä¹‹å‰æœ‰äº‹ä»¶æœªå¤„ç†å®Œï¼Œè¿™é‡Œå°±åˆæœ‰å¾—åˆ°æ‰§è¡Œçš„æœºä¼šäº†ã€‚ äº‹ä»¶æ‰§è¡Œçš„å…¥å£æ–¹æ³•ä¸ºexecuteDispatchesAndReleaseTopLevelï¼Œå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243var executeDispatchesAndReleaseTopLevel = function (e) &#123; return executeDispatchesAndRelease(e, false);&#125;;var executeDispatchesAndRelease = function (event, simulated) &#123; if (event) &#123; // è¿›è¡Œäº‹ä»¶åˆ†å‘, EventPluginUtils.executeDispatchesInOrder(event, simulated); if (!event.isPersistent()) &#123; // å¤„ç†å®Œ,åˆ™releaseæŽ‰eventå¯¹è±¡,é‡‡ç”¨å¯¹è±¡æ± æ–¹å¼,å‡å°‘GC // Reactå¸®æˆ‘ä»¬å¤„ç†äº†åˆæˆäº‹ä»¶çš„å›žæ”¶æœºåˆ¶ï¼Œä¸éœ€è¦æˆ‘ä»¬å…³å¿ƒã€‚ä½†è¦æ³¨æ„ï¼Œå¦‚æžœä½¿ç”¨äº†DOMåŽŸç”Ÿäº‹ä»¶ï¼Œåˆ™è¦è‡ªå·±å›žæ”¶ event.constructor.release(event); &#125; &#125;&#125;;// äº‹ä»¶å¤„ç†çš„æ ¸å¿ƒfunction executeDispatchesInOrder(event, simulated) &#123; var dispatchListeners = event._dispatchListeners; var dispatchInstances = event._dispatchInstances; if (Array.isArray(dispatchListeners)) &#123; // å¦‚æžœæœ‰å¤šä¸ªlistener,åˆ™éåŽ†æ‰§è¡Œæ•°ç»„ä¸­event for (var i = 0; i &lt; dispatchListeners.length; i++) &#123; // å¦‚æžœisPropagationStoppedè®¾æˆtrueäº†,åˆ™åœæ­¢äº‹ä»¶ä¼ æ’­,é€€å‡ºå¾ªçŽ¯ã€‚ if (event.isPropagationStopped()) &#123; break; &#125; // æ‰§è¡Œeventçš„åˆ†å‘,ä»Žå½“å‰è§¦å‘äº‹ä»¶å…ƒç´ å‘çˆ¶å…ƒç´ éåŽ† // eventä¸ºæµè§ˆå™¨ä¸Šä¼ çš„åŽŸç”Ÿäº‹ä»¶ // dispatchListeners[i]ä¸ºJSXä¸­å£°æ˜Žçš„äº‹ä»¶callback // dispatchInstances[i]ä¸ºå¯¹åº”çš„React Component executeDispatch(event, simulated, dispatchListeners[i], dispatchInstances[i]); &#125; &#125; else if (dispatchListeners) &#123; // å¦‚æžœåªæœ‰ä¸€ä¸ªlistener,åˆ™ç›´æŽ¥æ‰§è¡Œäº‹ä»¶åˆ†å‘ executeDispatch(event, simulated, dispatchListeners, dispatchInstances); &#125; // å¤„ç†å®Œevent,é‡ç½®å˜é‡ã€‚å› ä¸ºä½¿ç”¨çš„å¯¹è±¡æ± ,æ•…å¿…é¡»é‡ç½®,è¿™æ ·æ‰èƒ½è¢«åˆ«äººå¤ç”¨ event._dispatchListeners = null; event._dispatchInstances = null;&#125; executeDispatchesInOrderä¼šå…ˆå¾—åˆ°eventå¯¹åº”çš„listenersé˜Ÿåˆ—ï¼Œç„¶åŽä»Žå½“å‰å…ƒç´ å‘çˆ¶å…ƒç´ éåŽ†æ‰§è¡Œæ³¨å†Œçš„callbackã€‚ä¸”çœ‹executeDispatch 123456789101112131415161718192021222324252627function executeDispatch(event, simulated, listener, inst) &#123; var type = event.type || 'unknown-event'; event.currentTarget = EventPluginUtils.getNodeFromInstance(inst); if (simulated) &#123; // testä»£ç ä½¿ç”¨,æ”¯æŒtry-catch,å…¶ä»–å°±æ²¡å•¥åŒºåˆ«äº† ReactErrorUtils.invokeGuardedCallbackWithCatch(type, listener, event); &#125; else &#123; // äº‹ä»¶åˆ†å‘,listenerä¸ºcallback,eventä¸ºå‚æ•°,ç±»ä¼¼listener(event)è¿™ä¸ªæ–¹æ³•è°ƒç”¨ // è¿™æ ·å°±å›žè°ƒåˆ°äº†æˆ‘ä»¬åœ¨JSXä¸­æ³¨å†Œçš„callbackã€‚æ¯”å¦‚onClick=&#123;(event) =&gt; &#123;console.log(1)&#125;&#125; // è¿™æ ·åº”è¯¥å°±æ˜Žç™½äº†callbackæ€Žä¹ˆè¢«è°ƒç”¨çš„,ä»¥åŠeventå‚æ•°æ€Žä¹ˆä¼ å…¥callbacké‡Œé¢çš„äº† ReactErrorUtils.invokeGuardedCallback(type, listener, event); &#125; event.currentTarget = null;&#125;// é‡‡ç”¨func(a)çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ï¼Œ// æ•…ReactErrorUtils.invokeGuardedCallback(type, listener, event)æœ€ç»ˆè°ƒç”¨çš„æ˜¯listener(event)// eventå¯¹è±¡ä¸ºæµè§ˆå™¨ä¼ é€’çš„DOMåŽŸç”Ÿäº‹ä»¶å¯¹è±¡ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆReactåˆæˆäº‹ä»¶å›žè°ƒä¸­èƒ½æ‹¿åˆ°åŽŸç”Ÿeventçš„åŽŸå› function invokeGuardedCallback(name, func, a) &#123; try &#123; func(a); &#125; catch (x) &#123; if (caughtError === null) &#123; caughtError = x; &#125; &#125;&#125; æ€»ç»“Reactäº‹ä»¶ç³»ç»Ÿè¿˜æ˜¯ç›¸å½“éº»çƒ¦çš„ï¼Œä¸»è¦åˆ†ä¸ºäº‹ä»¶æ³¨å†Œï¼Œäº‹ä»¶å­˜å‚¨å’Œäº‹ä»¶æ‰§è¡Œä¸‰å¤§éƒ¨åˆ†ã€‚äº†è§£äº†Reactäº‹ä»¶ç³»ç»Ÿæºç ï¼Œå°±èƒ½å¤Ÿè½»æ¾å›žç­”æˆ‘ä»¬æ–‡ç« å¼€å¤´æ‰€åˆ—å‡ºçš„Reactäº‹ä»¶å‡ å¤§ç‰¹ç‚¹äº†ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Reactæºç åˆ†æž 5 ç»„ä»¶é€šä¿¡ï¼Œref,key,ReactDOM]]></title>
    <url>%2F2018%2F03%2F27%2FReact%2FReact-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-5-%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%EF%BC%8Cref-key-ReactDOM%2F</url>
    <content type="text"><![CDATA[ç»„ä»¶ä¹‹é—´é€šä¿¡çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡Reactè§„å®šäº†æ˜Žç¡®çš„å•å‘æ•°æ®æµï¼Œåˆ©ç”¨propså°†æ•°æ®ä»Žçˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶ã€‚æ•…æˆ‘ä»¬å¯ä»¥åˆ©ç”¨propsï¼Œè®©çˆ¶ç»„ä»¶ç»™å­ç»„ä»¶é€šä¿¡ã€‚æ•…çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡è¿˜æ˜¯å¾ˆå®¹æ˜“å®žçŽ°çš„ã€‚å¼•ç”³ä¸€ç‚¹ï¼Œçˆ¶ç»„ä»¶æ€Žä¹ˆå‘å­™å­ç»„ä»¶é€šä¿¡å‘¢ï¼Ÿå¯ä»¥åˆ©ç”¨propsè¿›è¡Œå±‚å±‚ä¼ é€’ï¼Œä½¿ç”¨ES6çš„â€¦è¿ç®—ç¬¦å¯ä»¥ç”¨å¾ˆç®€æ´çš„æ–¹å¼æŠŠpropsä¼ é€’ç»™å­™å­ç»„ä»¶ã€‚è¿™é‡Œæˆ‘ä»¬å°±ä¸ä¸¾ä¾‹äº†ã€‚ è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒsetProps,replacePropsä¸¤ä¸ªAPIå·²ç»è¢«åºŸå¼ƒäº†ï¼ŒReactå»ºè®®æˆ‘ä»¬åœ¨é¡¶å±‚ä½¿ç”¨ReactDOM.reader()è¿›è¡Œpropsæ›´æ–°ã€‚ å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡Reactæ•°æ®æµæ˜¯å•å‘çš„ï¼Œåªèƒ½ä»Žçˆ¶ç»„ä»¶ä¼ é€’åˆ°å­ç»„ä»¶ã€‚é‚£ä¹ˆå­ç»„ä»¶æ€Žä¹ˆå‘çˆ¶ç»„ä»¶é€šä¿¡å‘¢ï¼Ÿå…¶å®žä»ç„¶å¯ä»¥åˆ©ç”¨propsã€‚çˆ¶ç»„ä»¶åˆ©ç”¨propsä¼ é€’æ–¹æ³•ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶å›žè°ƒè¿™ä¸ªæ–¹æ³•çš„åŒæ—¶ï¼Œå°†æ•°æ®ä¼ é€’è¿›åŽ»ï¼Œä½¿å¾—çˆ¶ç»„ä»¶çš„ç›¸å…³æ–¹æ³•å¾—åˆ°å›žè°ƒï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æŠŠæ•°æ®ä»Žå­ç»„ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶äº†ã€‚çœ‹ä¸€ä¸ªä¾‹å­ã€‚ 123456789101112131415161718192021222324252627class Parent extends React.Component &#123; handleChildMsg(msg) &#123; // çˆ¶ç»„ä»¶å¤„ç†æ¶ˆæ¯ console.log("parent: " + msg); &#125; render() &#123; return ( &lt;div&gt; &lt;Child transferMsg = &#123;msg =&gt; this.handleChildMsg(msg)&#125; /&gt; &lt;/div&gt; ); &#125;&#125;class Child extends React.Component &#123; componentDidMount() &#123; // å­ç»„ä»¶ä¸­è°ƒç”¨çˆ¶ç»„ä»¶çš„æ–¹æ³•ï¼Œå°†æ•°æ®ä»¥å‚æ•°çš„æ–¹å¼ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼Œè¿™æ ·çˆ¶ç»„ä»¶æ–¹æ³•å°±å¾—åˆ°å›žè°ƒäº†ï¼Œä¹Ÿæ”¶åˆ°æ•°æ®äº† this.props.transferMsg("child has mounted"); &#125; render() &#123; return ( &lt;div&gt;child&lt;/div&gt; ) &#125;&#125; è¿™ä¸ªä¾‹å­åº”è¯¥å¾ˆæ¸…æ¥šäº†ï¼Œé€šè¿‡å›žè°ƒçš„æ–¹å¼ï¼Œå¯ä»¥å°†æ•°æ®ä»Žå­ç»„ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶ã€‚å¼•ç”³ä¸€ä¸‹ï¼Œå­™å­ç»„ä»¶æ€Žä¹ˆæŠŠæ•°æ®ä¼ é€’ç»™çˆ¶ç»„ä»¶å‘¢ï¼ŸåŒæ ·å¯ä»¥åˆ©ç”¨propså±‚å±‚å›žè°ƒã€‚åˆ©ç”¨ES6çš„â€¦è¿ç®—ç¬¦ä¹Ÿå¯ä»¥ç”¨æ¯”è¾ƒç®€æ´çš„æ–¹å¼å®Œæˆpropså±‚å±‚å›žè°ƒã€‚ å…„å¼Ÿç»„ä»¶é€šä¿¡ - å‘å¸ƒ/è®¢é˜…å…„å¼Ÿç»„ä»¶å¯ä»¥åˆ©ç”¨çˆ¶ç»„ä»¶è¿›è¡Œä¸­è½¬ï¼Œå°†æ•°æ®å…ˆç”±child1ä¼ ç»™parentï¼Œç„¶åŽparentä¼ ç»™child2. è¿™ä¸ªæ–¹æ³•æ˜¾ç„¶è€¦åˆæ¯”è¾ƒä¸¥é‡ï¼Œä¼ é€’æ¬¡æ•°è¿‡å¤šï¼Œå®¹æ˜“å¼•å‘çˆ¶ç»„ä»¶ä¸å¿…è¦çš„ç”Ÿå‘½å‘¨æœŸå›žè°ƒï¼Œç”šè‡³å½±å“å…¶ä»–å­ç»„ä»¶ï¼Œæ•…å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨è¿™ä¸ªæ–¹å¼ã€‚ æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è§‚å¯Ÿè€…æ¨¡å¼é‡‡ç”¨å‘å¸ƒ/è®¢é˜…çš„æ–¹æ³•ï¼Œå¯ä»¥å°†æ¶ˆæ¯å‘é€è€…å’ŒæŽ¥æ”¶è€…å®Œç¾Žè§£è€¦ã€‚Reactä¸­å¯ä»¥å¼•å…¥eventProxyæ¨¡å—ï¼Œåˆ©ç”¨eventProxy.trigger()æ–¹æ³•å‘å¸ƒæ¶ˆæ¯ï¼ŒeventProxy.on()æ–¹æ³•ç›‘å¬å¹¶æŽ¥æ”¶æ¶ˆæ¯ã€‚eventProxyæˆ‘ä»¬å°±ä¸å±•å¼€è®²äº†ã€‚ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­ 1234567891011121314151617181920212223242526import eventProxy from '../eventProxy'class Child1 extends React.Component &#123; componentDidMount() &#123; // å‘å¸ƒè€…ï¼Œå‘å‡ºæ¶ˆæ¯ eventProxy.trigger('msg', 'child1 has been mounted'); &#125; render() &#123; return ( &lt;div&gt;child1&lt;/div&gt; ); &#125;&#125;class Child2 extends React.Component &#123; componentDidMount() &#123; // è®¢é˜…è€…ï¼Œç›‘å¬å¹¶æŽ¥æ”¶æ¶ˆæ¯ eventProxy.on('msg', (msg) =&gt; &#123;console.log('msg: ' + msg)&#125;); &#125; render() &#123; return ( &lt;div&gt;child2&lt;/div&gt; ); &#125; &#125; åµŒå¥—å±‚çº§æ·±ç»„ä»¶ - contextç¥–çˆ¶ç»„ä»¶å’Œå­™å­ç»„ä»¶é€šä¿¡æ—¶ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™è¿˜æ˜¯è§‰å¾—é€šè¿‡propsæœ‰ç‚¹ç¹çäº†ã€‚æ­¤æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨contextå…¨å±€å˜é‡ã€‚ ä½¿ç”¨æ–¹æ³•ï¼š1.ç¥–çˆ¶ç»„ä»¶ä¸­å®šä¹‰getChildContext()æ–¹æ³•ï¼Œå°†è¦ä¼ é€’ç»™å­™å­çš„æ•°æ®æ”¾åœ¨å…¶ä¸­2.ç¥–çˆ¶ç»„ä»¶ä¸­childContextTypesç”³æ˜Žè¦ä¼ é€’çš„æ•°æ®ç±»åž‹3.å­™å­ç»„ä»¶ä¸­contextTypesç”³æ˜Žå¯ä»¥æŽ¥æ”¶çš„æ•°æ®ç±»åž‹4.å­™å­ç»„ä»¶é€šè¿‡this.contextè®¿é—®ç¥–çˆ¶ä¼ é€’è¿›æ¥çš„æ•°æ®ã€‚ é‡‡ç”¨å…¨å±€å˜é‡çš„æ–¹å¼ï¼Œå®¹æ˜“å¯¼è‡´æ•°æ®æ··ä¹±ï¼Œåˆ†ä¸æ¸…æ•°æ®æ˜¯ä»Žå“ªå„¿æ¥çš„ï¼Œä¸å®¹æ˜“æŽ§åˆ¶ã€‚å»ºè®®å°‘ç”¨è¿™ç§æ–¹å¼ã€‚ Reduxè¿˜å¯ä»¥åˆ©ç”¨Fluxå’ŒReduxæž¶æž„æ¥è¿›è¡Œç»„ä»¶é€šä¿¡ï¼Œè¿™ä¸ªæˆ‘ä»¬ä»¥åŽå†ä¸“é—¨è¯¦ç»†åˆ†æžã€‚ refsç”¨æ³•æˆ‘ä»¬åœ¨getRender()è¿”å›žçš„JSXä¸­ï¼Œå¯ä»¥åœ¨æ ‡ç­¾ä¸­åŠ å…¥refå±žæ€§ï¼Œç„¶åŽé€šè¿‡refs.refå°±å¯ä»¥è®¿é—®åˆ°æˆ‘ä»¬çš„Componentäº†ï¼Œä¾‹å¦‚ã€‚ 1234567891011121314151617181920class Parent extends React.Component &#123; getRender() &#123; &lt;div&gt; &lt;Child ref = 'child' /&gt; &lt;/div&gt; &#125; componentDidMount() &#123; // é€šè¿‡refså¯ä»¥æ‹¿åˆ°å­å…ƒç´ ,ç„¶åŽå°±å¯ä»¥è®¿é—®åˆ°å­å…ƒç´ çš„æ–¹æ³•äº† let child = this.refs.child; child.test(); &#125;&#125;class Child extends React.Component &#123; test() &#123; console.log("child method called by ref"); &#125;&#125; attachRef å°†å­ç»„ä»¶å¼•ç”¨ä¿å­˜åˆ°çˆ¶ç»„ä»¶refså¯¹è±¡ä¸­refsçš„ç”¨æ³•å¾ˆç®€å•ï¼Œåªéœ€è¦JSXä¸­å®šä¹‰å¥½refå±žæ€§å³å¯ã€‚é‚£ä¹ˆé¦–å…ˆä¸€ä¸ªé—®é¢˜æ¥äº†ï¼Œrefsè¿™ä¸ªå¯¹è±¡åœ¨å“ªå„¿å®šä¹‰çš„å‘¢ï¼Ÿè¿˜è®°å¾—createClassæ–¹æ³•çš„constructorå§ï¼Œå®ƒé‡Œé¢ä¼šå®šä¹‰å¹¶åˆå§‹åŒ–refså¯¹è±¡ã€‚æºç å¦‚ä¸‹ 12345678910111213141516171819202122createClass: function (spec) &#123; // è‡ªå®šä¹‰Reactç±»çš„æž„é€ æ–¹æ³•ï¼Œé€šè¿‡å®ƒåˆ›å»ºä¸€ä¸ªReact.Componentå¯¹è±¡ var Constructor = identity(function (props, context, updater) &#123; // Wire up auto-binding if (this.__reactAutoBindPairs.length) &#123; bindAutoBindMethods(this); &#125; this.props = props; this.context = context; // refsåˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºå¯¹è±¡ this.refs = emptyObject; this.updater = updater || ReactNoopUpdateQueue; // è°ƒç”¨getInitialStateåˆå§‹åŒ–state this.state = null; var initialState = this.getInitialState ? this.getInitialState() : null; this.state = initialState; &#125;); ...&#125; ä»Žä¸Šé¢ä»£ç å¯è§ï¼Œæ¯æ¬¡åˆ›å»ºè‡ªå®šä¹‰ç»„ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆå§‹åŒ–ä¸€ä¸ªä¸ºç©ºçš„refså¯¹è±¡ã€‚é‚£ä¹ˆç¬¬äºŒä¸ªé—®é¢˜æ¥äº†ï¼Œrefå­—ç¬¦ä¸²æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å¼•ç”¨ï¼Œæ˜¯ä»€ä¹ˆæ—¶å€™åŠ å…¥åˆ°refså¯¹è±¡ä¸­çš„å‘¢ï¼Ÿç­”æ¡ˆå°±åœ¨ReactCompositeComponentçš„attachRefæ–¹æ³•ä¸­ï¼Œæºç å¦‚ä¸‹ 12345678attachRef: function(ref, component) &#123; // getPublicInstanceè¿”å›žæˆ‘ä»¬çš„çˆ¶ç»„ä»¶ var inst = this.getPublicInstance(); var publicComponentInstance = component.getPublicInstance(); var refs = inst.refs === emptyObject ? (inst.refs = &#123;&#125;) : inst.refs; // å°†å­å…ƒç´ çš„å¼•ç”¨ï¼Œä»¥refå±žæ€§ä¸ºkey,ä¿å­˜åˆ°çˆ¶å…ƒç´ çš„refså¯¹è±¡ä¸­ refs[ref] = publicComponentInstance;&#125;, attachRefæ–¹æ³•åˆæ˜¯ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨çš„å‘¢ï¼Ÿæˆ‘ä»¬è¿™å„¿å°±ä¸æºç åˆ†æžäº†ã€‚å¤§æ¦‚è¯´ä¸‹ï¼ŒmountComponentä¸­ï¼Œå¦‚æžœelementçš„refå±žæ€§ä¸ä¸ºç©ºï¼Œåˆ™ä¼šä»¥transactionäº‹åŠ¡çš„æ–¹å¼è°ƒç”¨attachRefsæ–¹æ³•ï¼Œè€ŒattachRefsæ–¹æ³•ä¸­åˆ™ä¼šè°ƒç”¨attachRefæ–¹æ³•ï¼Œå°†å­ç»„ä»¶çš„å¼•ç”¨ä¿å­˜åˆ°çˆ¶ç»„ä»¶çš„refså¯¹è±¡ä¸­ã€‚ detachRef ä»Žçˆ¶ç»„ä»¶refså¯¹è±¡ä¸­åˆ é™¤å­ç»„ä»¶å¼•ç”¨å¯¹å†…å­˜ç®¡ç†æœ‰äº›äº†è§£çš„åŒå­¦è‚¯å®šä¼šæœ‰ç–‘æƒ‘ï¼Œæ—¢ç„¶çˆ¶ç»„ä»¶çš„refsä¸­ä¿å­˜äº†å­ç»„ä»¶å¼•ç”¨ï¼Œé‚£ä¹ˆå½“å­ç»„ä»¶è¢«unmountComponentè€Œé”€æ¯æ—¶ï¼Œå­ç»„ä»¶çš„å¼•ç”¨ä»ç„¶ä¿å­˜åœ¨refså¯¹è±¡ä¸­ï¼Œå²‚ä¸æ˜¯ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼ŸReactå½“ç„¶ä¸ä¼šæœ‰è¿™ä¸ªbugäº†ï¼Œç§˜å¯†å°±åœ¨detachRefæ–¹æ³•ä¸­ï¼Œæºç å¦‚ä¸‹ 12345detachRef: function(ref) &#123; var refs = this.getPublicInstance().refs; // ä»Žrefså¯¹è±¡ä¸­åˆ é™¤keyä¸ºrefå­å…ƒç´ ,é˜²æ­¢å†…å­˜æ³„æ¼ delete refs[ref];&#125;, ä»£ç å¾ˆç®€å•ï¼ŒdeleteæŽ‰refå­—ç¬¦ä¸²æŒ‡å‘çš„æˆå‘˜å³å¯ã€‚è‡³äºŽdetachRefçš„è°ƒç”¨é“¾ï¼Œæˆ‘ä»¬è¿˜å¾—ä»ŽunmountComponentæ–¹æ³•è¯´èµ·ã€‚unmountComponentä¼šè°ƒç”¨detachRefsæ–¹æ³•ï¼Œè€ŒdetachRefsä¸­åˆ™ä¼šè°ƒç”¨detachRefï¼Œä»Žè€Œå°†å­å…ƒç´ å¼•ç”¨ä»Žrefsä¸­é‡Šæ”¾æŽ‰ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨unmountComponentæ—¶ï¼ŒReactè‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆäº†å­å…ƒç´ refåˆ é™¤ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ keyå½“æˆ‘ä»¬çš„å­ç»„ä»¶æ˜¯ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œæ¯”å¦‚ç±»ä¼¼äºŽAndroidä¸­çš„ListViewï¼Œä¸€ä¸ªåˆ—è¡¨ä¸­æœ‰å¾ˆå¤šæ ·å¼ä¸€è‡´çš„é¡¹ï¼Œæ­¤æ—¶ç»™æ¯ä¸ªé¡¹åŠ ä¸Škeyè¿™ä¸ªå±žæ€§å°±å¾ˆæœ‰ä½œç”¨äº†ã€‚keyå¯ä»¥æ ‡ç¤ºå½“å‰é¡¹çš„å”¯ä¸€æ€§ã€‚ å¯¹äºŽæ•°ç»„ï¼Œå…¶å†…éƒ¨åŒ…å«é•¿åº¦ä¸ç¡®å®šçš„å­é¡¹ã€‚å½“ç»„ä»¶stateå˜åŒ–æ—¶ï¼Œéœ€è¦é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚é‚£ä¹ˆæœ‰ä¸ªé—®é¢˜æ¥äº†ï¼ŒReactæ˜¯æ›´æ–°ç»„ä»¶ï¼Œè¿˜æ˜¯å…ˆé”€æ¯å†æ–°å»ºç»„ä»¶å‘¢ã€‚keyå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚å¦‚æžœå‰åŽä¸¤æ¬¡keyä¸å˜ï¼Œåˆ™åªéœ€è¦æ›´æ–°ï¼Œå¦åˆ™å…ˆé”€æ¯å†æ›´æ–°ã€‚ å¯¹äºŽå­é¡¹çš„keyï¼Œå¿…é¡»æ˜¯å”¯ä¸€ä¸é‡å¤çš„ã€‚å¹¶ä¸”å°½é‡ä¼ ä¸å˜çš„å±žæ€§ï¼Œåƒä¸‡ä¸è¦ä¼ æ— æ„ä¹‰çš„indexæˆ–è€…éšæœºå€¼ã€‚è¿™æ ·æ‰èƒ½å°½é‡ä»¥æ›´æ–°çš„æ–¹å¼æ¥é‡æ–°æ¸²æŸ“ã€‚Reactæºç ä¸­åˆ¤æ–­æ›´æ–°æ–¹å¼çš„æºç å¦‚ä¸‹ 123456789101112131415161718192021222324function shouldUpdateReactComponent(prevElement, nextElement) &#123; // å‰åŽä¸¤æ¬¡ReactElementä¸­ä»»ä½•ä¸€ä¸ªä¸ºnullï¼Œåˆ™å¿…é¡»å¦ä¸€ä¸ªä¸ºnullæ‰è¿”å›žtrueã€‚è¿™ç§æƒ…å†µä¸€èˆ¬ä¸ä¼šç¢°åˆ° var prevEmpty = prevElement === null || prevElement === false; var nextEmpty = nextElement === null || nextElement === false; if (prevEmpty || nextEmpty) &#123; return prevEmpty === nextEmpty; &#125; var prevType = typeof prevElement; var nextType = typeof nextElement; // React DOM diffç®—æ³• if (prevType === 'string' || prevType === 'number') &#123; // å¦‚æžœå‰åŽä¸¤æ¬¡ä¸ºæ•°å­—æˆ–è€…å­—ç¬¦,åˆ™è®¤ä¸ºåªéœ€è¦update(å¤„ç†æ–‡æœ¬å…ƒç´ )ï¼Œè¿”å›žtrue return (nextType === 'string' || nextType === 'number'); &#125; else &#123; // å¦‚æžœå‰åŽä¸¤æ¬¡ä¸ºDOMå…ƒç´ æˆ–Reactå…ƒç´ ,åˆ™å¿…é¡»typeå’Œkeyä¸å˜(keyç”¨äºŽlistViewç­‰ç»„ä»¶,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰è®¾ç½®keyï¼Œæ•…åªéœ€typeç›¸åŒ)æ‰update,å¦åˆ™å…ˆunmountå†é‡æ–°mountã€‚è¿”å›žfalse return ( nextType === 'object' &amp;&amp; prevElement.type === nextElement.type &amp;&amp; prevElement.key === nextElement.key ); &#125;&#125; çœ‹åˆ°keyè¿™ä¸ªå±žæ€§çš„é‡è¦æ€§äº†å§ã€‚å¯¹äºŽæ•°ç»„ç»„ä»¶ï¼Œæˆ‘ä»¬ä¸€å®šè¦åœ¨æ¯ä¸ªå­é¡¹ä¸Šè®¾ç½®ä¸€ä¸ªkeyï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜DOM diffçš„æ€§èƒ½ã€‚ é‚£ä¸ºä»€ä¹ˆæ•°ç»„ç»„ä»¶ä¹‹å¤–çš„å…¶ä»–ç»„ä»¶ï¼Œä¸ç”¨è®¾ç½®keyå‘¢ï¼Ÿå› ä¸ºä»–ä»¬çš„typeæˆ–è€…åœ¨çˆ¶ç»„ä»¶ä¸­çš„ä½ç½®ä¸åŒï¼Œå®Œå…¨å¯ä»¥åŒºåˆ†å¼€ï¼Œæ‰€ä»¥ä¸éœ€è¦keyå°±å¯ä»¥å®Œå…¨ç¡®å®šæ˜¯å“ªä¸ªç»„ä»¶ æ— çŠ¶æ€ç»„ä»¶æ— çŠ¶æ€ç»„ä»¶å…¶å®žæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼ å…¥propså³å¯ï¼Œæ²¡æœ‰stateï¼Œä¹Ÿæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ç»„ä»¶æœ¬èº«å¯¹åº”çš„å°±æ˜¯renderæ–¹æ³•ã€‚ä¾‹å­å¦‚ä¸‹ 12345678function Title(&#123;color = 'red', text = 'æ ‡é¢˜'&#125;) &#123; let style = &#123; 'color': color &#125; return ( &lt;div style = &#123;style&#125;&gt;&#123;text&#125;&lt;/div&gt; )&#125; æ— çŠ¶æ€ç»„ä»¶ä¸ä¼šåˆ›å»ºå¯¹è±¡ï¼Œæ•…æ¯”è¾ƒçœå†…å­˜ã€‚æ²¡æœ‰å¤æ‚çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è°ƒç”¨ï¼Œæ•…æµç¨‹æ¯”è¾ƒç®€å•ã€‚æ²¡æœ‰stateï¼Œä¹Ÿä¸ä¼šé‡å¤æ¸²æŸ“ã€‚å®ƒæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°è€Œå·²ã€‚ å¯¹äºŽæ²¡æœ‰çŠ¶æ€å˜åŒ–çš„ç»„ä»¶ï¼ŒReactå»ºè®®æˆ‘ä»¬ä½¿ç”¨æ— çŠ¶æ€ç»„ä»¶ã€‚æ€»ä¹‹ï¼Œèƒ½ç”¨æ— çŠ¶æ€ç»„ä»¶çš„åœ°æ–¹ï¼Œå°±ç”¨æ— çŠ¶æ€ç»„ä»¶ã€‚ react DOMReacté€šè¿‡findDOMNode()å¯ä»¥æ‰¾åˆ°ç»„ä»¶å®žä¾‹å¯¹åº”çš„DOMèŠ‚ç‚¹ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åªèƒ½åœ¨render()ä¹‹åŽï¼Œä¹Ÿå°±æ˜¯componentDidMount()å’ŒcomponentDidUpdate()ä¸­è°ƒç”¨ã€‚å› ä¸ºåªæœ‰renderåŽï¼ŒDOMå¯¹è±¡æ‰ç”Ÿæˆäº†ã€‚ 123456class example extends React.Component &#123; componentDidMount() &#123; // åªæœ‰renderåŽæ‰ç”Ÿæˆäº†DOM nodeï¼Œæ‰èƒ½è°ƒç”¨findDOMNode let dom = ReactDOM.findDOMNode(this); &#125;&#125; é‚£ä¸ºä»€ä¹ˆrenderåŽDOMæ‰ç”Ÿæˆå‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ä»Žæºç è§’åº¦æ¥åˆ†æžã€‚Reactæºç åˆ†æž3 â€” Reactç»„ä»¶æ’å…¥DOMæµç¨‹ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“mountComponentè§£æžå¾—åˆ°äº†markupï¼Œä¹Ÿå°±æ˜¯Reactç»„ä»¶å¯¹åº”çš„HTMLï¼Œä¼šç”±_mountImageIntoNodeæ–¹æ³•æ’å…¥åˆ°çœŸå®žDOMä¸­ï¼Œæ•…è¿™ä¸ªäº‹åŠ¡ç»“æŸåŽï¼Œæ‰ç”Ÿæˆäº†çœŸæ­£çš„DOMã€‚æ•…è‚¯å®šåªæœ‰renderä¹‹åŽï¼Œæ‰æœ‰çœŸå®žçš„DOMå¯ä»¥è¢«è®¿é—®ã€‚ é‚£ä¸ºä»€ä¹ˆcomponentDidMount()èƒ½è®¿é—®DOMå‘¢ï¼Ÿå®ƒä¸æ˜¯ä¹Ÿåœ¨mountComponent()æ–¹æ³•æµç¨‹ä¸­å—ï¼Ÿè¿™æ˜¯å› ä¸ºReacté‡‡ç”¨å¼‚æ­¥äº‹åŠ¡çš„æ–¹å¼æ¥è°ƒç”¨componentDidMountçš„ï¼Œå®ƒæŠŠcomponentDidMountæ”¾åˆ°ä¸€ä¸ªäº‹åŠ¡é˜Ÿåˆ—ä¸­ï¼Œåªæœ‰å½“å‰mountComponentè¿™ä¸ªäº‹åŠ¡å¤„ç†å®Œäº†ï¼Œæ‰ä¼šå›žè¿‡å¤´åŽ»å¤„ç†componentDidMountï¼Œæ•…åœ¨componentDidMountä¸­å¯ä»¥æ‹¿åˆ°çœŸå®žçš„DOMã€‚è¿™ä¸ªè®¾è®¡å¾—ç»™Reactç‚¹èµžã€‚è¿™ä¸€ç‚¹å¯ä»¥ä»Žæºç æ¥åˆ†æžã€‚ 1234567891011mountComponent: function (transaction, nativeParent, nativeContainerInfo, context) &#123; // çœç•¥ä¸€æ®µä»£ç  ... if (inst.componentDidMount) &#123; // è°ƒç”¨componentDidMountï¼Œä»¥äº‹åŠ¡çš„å½¢å¼ã€‚æ”¾åˆ°queueä¸­ï¼Œå¼‚æ­¥çš„æ–¹å¼ï¼Œæœ‰é‚£ä¹ˆç‚¹Android MessageQueueçš„æ„Ÿè§‰ transaction.getReactMountReady().enqueue(inst.componentDidMount, inst); &#125; return markup;&#125;, å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒReactä¸å»ºè®®æˆ‘ä»¬ç¢°åº•å±‚çš„DOMï¼Œå› ä¸ºReactæœ‰ä¸€å¥—æ€§èƒ½æ¯”è¾ƒé«˜çš„DOM diffæ–¹å¼æ¥æ›´æ–°çœŸå®žDOMã€‚å¹¶ä¸”å®¹æ˜“å¯¼è‡´DOMå¼•ç”¨å¿˜è®°é‡Šæ”¾ç­‰å†…å­˜æ³„æ¼é—®é¢˜ã€‚ä¸€å¥è¯ï¼Œé™¤éžä¸å¾—å·²ï¼Œä¸è¦ç¢°DOMã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React æºç åˆ†æž 4 setStateæœºåˆ¶]]></title>
    <url>%2F2018%2F03%2F27%2FReact%2FReact-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-4-setState%E6%9C%BA%E5%88%B6%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿°Reactä½œä¸ºä¸€é—¨å‰ç«¯æ¡†æž¶ï¼Œè™½ç„¶åªæ˜¯focusåœ¨MVVMä¸­çš„Viewéƒ¨åˆ†ï¼Œä½†è¿˜æ˜¯å®žçŽ°äº†Viewå’Œmodelçš„ç»‘å®šã€‚ä¿®æ”¹æ•°æ®çš„åŒæ—¶ï¼Œå¯ä»¥å®žçŽ°Viewçš„åˆ·æ–°ã€‚è¿™å¤§å¤§ç®€åŒ–äº†æˆ‘ä»¬çš„é€»è¾‘ï¼Œåªç”¨å…³å¿ƒæ•°æ®æµçš„å˜åŒ–ï¼ŒåŒæ—¶å‡å°‘äº†ä»£ç é‡ï¼Œä½¿å¾—åŽæœŸç»´æŠ¤ä¹Ÿæ›´åŠ æ–¹ä¾¿ã€‚è¿™ä¸ªç‰¹æ€§åˆ™è¦å½’åŠŸäºŽsetState()æ–¹æ³•ã€‚Reactä¸­åˆ©ç”¨é˜Ÿåˆ—æœºåˆ¶æ¥ç®¡ç†stateï¼Œé¿å…äº†å¾ˆå¤šé‡å¤çš„Viewåˆ·æ–°ã€‚ä¸‹é¢æˆ‘ä»¬æ¥ä»Žæºç è§’åº¦æŽ¢å¯»ä¸‹setStateæœºåˆ¶ã€‚ setStateå’ŒreplaceStateæˆ‘ä»¬éƒ½çŸ¥é“setStateæ˜¯ä»¥ä¿®æ”¹å’Œæ–°å¢žçš„æ–¹å¼æ”¹å˜stateçš„ï¼Œä¸ä¼šæ”¹å˜æ²¡æœ‰æ¶‰åŠåˆ°çš„stateã€‚è€ŒreplaceStateåˆ™ç”¨æ–°çš„stateå®Œå…¨æ›¿æ¢æŽ‰è€stateã€‚æ¯”å¦‚ 1234567891011121314this.state = &#123; title: "example", desc: "this is an example for react"&#125;;setState(&#123; title: "new example"&#125;);console.log("setState: " + JSON.stringify(this.state)); // 1 replaceState(&#123; title: "new example"&#125;)console.log("replaceState: " + JSON.stringify(this.state)); // 2 æ‰“å°å¦‚ä¸‹:12setState: &#123;"title":"new example","desc":"this is an example for react"&#125;replaceState: &#123;"title":"new example"&#125; å¯è§ï¼ŒsetStateä¸ä¼šå½±å“æ²¡æœ‰æ¶‰åŠåˆ°çš„stateï¼Œè€ŒreplaceStateåˆ™æ˜¯å®Œå®Œå…¨å…¨çš„æ›¿æ¢ã€‚ä¸‹é¢è®©æˆ‘ä»¬è¿›å…¥æºç æ¥æŽ¢å¯»ç©¶ç«Ÿå§ã€‚ setStatesetStateæ–¹æ³•å…¥å£å¦‚ä¸‹12345678ReactComponent.prototype.setState = function (partialState, callback) &#123; // å°†setStateäº‹åŠ¡æ”¾å…¥é˜Ÿåˆ—ä¸­ this.updater.enqueueSetState(this, partialState); if (callback) &#123; this.updater.enqueueCallback(this, callback, 'setState'); &#125;&#125;; å–åä¸ºpartialStateï¼Œæœ‰éƒ¨åˆ†stateçš„å«ä¹‰ï¼Œå¯è§åªæ˜¯å½±å“æ¶‰åŠåˆ°çš„stateï¼Œä¸ä¼šä¼¤åŠæ— è¾œã€‚enqueueSetStateæ˜¯stateé˜Ÿåˆ—ç®¡ç†çš„å…¥å£æ–¹æ³•ï¼Œæ¯”è¾ƒé‡è¦ï¼Œæˆ‘ä»¬ä¹‹åŽå†æŽ¥ç€åˆ†æžã€‚ replaceState123456replaceState: function (newState, callback) &#123; this.updater.enqueueReplaceState(this, newState); if (callback) &#123; this.updater.enqueueCallback(this, callback, 'replaceState'); &#125;&#125;, replaceStateä¸­å–åä¸ºnewStateï¼Œæœ‰å®Œå…¨æ›¿æ¢çš„å«ä¹‰ã€‚åŒæ ·ä¹Ÿæ˜¯ä»¥é˜Ÿåˆ—çš„å½¢å¼æ¥ç®¡ç†çš„ã€‚ equeueSetState123456789101112131415enqueueSetState: function (publicInstance, partialState) &#123; // å…ˆèŽ·å–ReactComponentç»„ä»¶å¯¹è±¡ var internalInstance = getInternalInstanceReadyForUpdate(publicInstance, 'setState'); if (!internalInstance) &#123; return; &#125; // å¦‚æžœ_pendingStateQueueä¸ºç©º,åˆ™åˆ›å»ºå®ƒã€‚å¯ä»¥å‘çŽ°é˜Ÿåˆ—æ˜¯æ•°ç»„å½¢å¼å®žçŽ°çš„ var queue = internalInstance._pendingStateQueue || (internalInstance._pendingStateQueue = []); queue.push(partialState); // å°†è¦æ›´æ–°çš„ReactComponentæ”¾å…¥æ•°ç»„ä¸­ enqueueUpdate(internalInstance);&#125; å…¶ä¸­getInternalInstanceReadyForUpdateæºç å¦‚ä¸‹ï¼Œè§£é‡Šéƒ½åœ¨ä»£ç æ³¨é‡Šä¸­ 12345678910function getInternalInstanceReadyForUpdate(publicInstance, callerName) &#123; // ä»Žmapå–å‡ºReactComponentç»„ä»¶,è¿˜è®°å¾—mountComponentæ—¶æŠŠReactElementä½œä¸ºkeyï¼Œå°†ReactComponentå­˜å…¥äº†mapä¸­äº†å§ï¼ŒReactComponentæ˜¯Reactç»„ä»¶çš„æ ¸å¿ƒï¼ŒåŒ…å«å„ç§çŠ¶æ€ï¼Œæ•°æ®å’Œæ“ä½œæ–¹æ³•ã€‚è€ŒReactElementåˆ™ä»…ä»…æ˜¯ä¸€ä¸ªæ•°æ®ç±»ã€‚ var internalInstance = ReactInstanceMap.get(publicInstance); if (!internalInstance) &#123; return null; &#125; return internalInstance;&#125; enqueueUpdateæºç å¦‚ä¸‹123456789101112function enqueueUpdate(component) &#123; ensureInjected(); // å¦‚æžœä¸æ˜¯æ­£å¤„äºŽåˆ›å»ºæˆ–æ›´æ–°ç»„ä»¶é˜¶æ®µ,åˆ™å¤„ç†updateäº‹åŠ¡ if (!batchingStrategy.isBatchingUpdates) &#123; batchingStrategy.batchedUpdates(enqueueUpdate, component); return; &#125; // å¦‚æžœæ­£åœ¨åˆ›å»ºæˆ–æ›´æ–°ç»„ä»¶,åˆ™æš‚ä¸”å…ˆä¸å¤„ç†update,åªæ˜¯å°†ç»„ä»¶æ”¾åœ¨dirtyComponentsæ•°ç»„ä¸­ dirtyComponents.push(component);&#125; enqueueUpdateåŒ…å«äº†Reacté¿å…é‡å¤renderçš„é€»è¾‘ã€‚mountComponentå’ŒupdateComponentæ–¹æ³•åœ¨æ‰§è¡Œçš„æœ€å¼€å§‹ï¼Œä¼šè°ƒç”¨åˆ°batchedUpdatesè¿›è¡Œæ‰¹å¤„ç†æ›´æ–°ï¼Œæ­¤æ—¶ä¼šå°†isBatchingUpdatesè®¾ç½®ä¸ºtrueï¼Œä¹Ÿå°±æ˜¯å°†çŠ¶æ€æ ‡è®°ä¸ºçŽ°åœ¨æ­£å¤„äºŽæ›´æ–°é˜¶æ®µäº†ã€‚ä¹‹åŽReactä»¥äº‹åŠ¡çš„æ–¹å¼å¤„ç†ç»„ä»¶updateï¼Œäº‹åŠ¡å¤„ç†å®ŒåŽä¼šè°ƒç”¨wrapper.close(), è€ŒTRANSACTION_WRAPPERSä¸­åŒ…å«äº†RESET_BATCHED_UPDATESè¿™ä¸ªwrapperï¼Œæ•…æœ€ç»ˆä¼šè°ƒç”¨RESET_BATCHED_UPDATES.close(), å®ƒæœ€ç»ˆä¼šå°†isBatchingUpdatesè®¾ç½®ä¸ºfalseã€‚è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒéº»çƒ¦ï¼Œæƒ³æ›´æ¸…æ™°çš„äº†è§£çš„è¯ï¼Œå»ºè®®è‡ªè¡Œåˆ†æžæºç ã€‚ æ•…getInitialStateï¼ŒcomponentWillMountï¼Œ renderï¼ŒcomponentWillUpdate ä¸­setStateéƒ½ä¸ä¼šå¼•èµ·updateComponentã€‚ä½†åœ¨componentDidMountå’ŒcomponentDidUpdateä¸­åˆ™ä¼šã€‚ 12345678910111213141516171819202122batchedUpdates: function (callback, a, b, c, d, e) &#123; var alreadyBatchingUpdates = ReactDefaultBatchingStrategy.isBatchingUpdates; // æ‰¹å¤„ç†æœ€å¼€å§‹æ—¶ï¼Œå°†isBatchingUpdatesè®¾ä¸ºtrueï¼Œè¡¨æ˜Žæ­£åœ¨æ›´æ–° ReactDefaultBatchingStrategy.isBatchingUpdates = true; // The code is written this way to avoid extra allocations if (alreadyBatchingUpdates) &#123; callback(a, b, c, d, e); &#125; else &#123; // ä»¥äº‹åŠ¡çš„æ–¹å¼å¤„ç†updatesï¼ŒåŽé¢è¯¦ç»†åˆ†æžtransaction transaction.perform(callback, null, a, b, c, d, e); &#125;&#125;var RESET_BATCHED_UPDATES = &#123; initialize: emptyFunction, close: function () &#123; // äº‹åŠ¡æ‰¹æ›´æ–°å¤„ç†ç»“æŸæ—¶ï¼Œå°†isBatchingUpdatesè®¾ä¸ºäº†false ReactDefaultBatchingStrategy.isBatchingUpdates = false; &#125;&#125;;var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES]; äº‹åŠ¡transactionäº‹åŠ¡é€šè¿‡wrapperè¿›è¡Œå°è£…ã€‚ä¸€ä¸ªwrapperåŒ…å«ä¸€å¯¹initializeå’Œcloseæ–¹æ³•ã€‚æ¯”å¦‚RESET_BATCHED_UPDATES 12345678var RESET_BATCHED_UPDATES = &#123; // åˆå§‹åŒ–è°ƒç”¨ initialize: emptyFunction, // äº‹åŠ¡æ‰§è¡Œå®Œæˆï¼Œcloseæ—¶è°ƒç”¨ close: function () &#123; ReactDefaultBatchingStrategy.isBatchingUpdates = false; &#125;&#125;; transcationè¢«åŒ…è£…åœ¨wrapperä¸­ï¼Œæ¯”å¦‚ 1var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES]; transactionæ˜¯é€šè¿‡transaction.perform(callback, argsâ€¦)æ–¹æ³•è¿›å…¥çš„ï¼Œå®ƒä¼šå…ˆè°ƒç”¨æ³¨å†Œå¥½çš„wrapperä¸­çš„initializeæ–¹æ³•ï¼Œç„¶åŽæ‰§è¡Œperformæ–¹æ³•ä¸­çš„callbackï¼Œæœ€åŽå†æ‰§è¡Œcloseæ–¹æ³•ã€‚ ä¸‹é¢åˆ†æžtransaction.perform(callback, argsâ€¦) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172perform: function (method, scope, a, b, c, d, e, f) &#123; var errorThrown; var ret; try &#123; this._isInTransaction = true; errorThrown = true; // å…ˆè¿è¡Œæ‰€æœ‰wrapperä¸­çš„initializeæ–¹æ³• this.initializeAll(0); // å†æ‰§è¡Œperformæ–¹æ³•ä¼ å…¥çš„callback ret = method.call(scope, a, b, c, d, e, f); errorThrown = false; &#125; finally &#123; try &#123; if (errorThrown) &#123; // æœ€åŽè¿è¡Œwrapperä¸­çš„closeæ–¹æ³• try &#123; this.closeAll(0); &#125; catch (err) &#123;&#125; &#125; else &#123; // æœ€åŽè¿è¡Œwrapperä¸­çš„closeæ–¹æ³• this.closeAll(0); &#125; &#125; finally &#123; this._isInTransaction = false; &#125; &#125; return ret; &#125;, initializeAll: function (startIndex) &#123; var transactionWrappers = this.transactionWrappers; // éåŽ†æ‰€æœ‰æ³¨å†Œçš„wrapper for (var i = startIndex; i &lt; transactionWrappers.length; i++) &#123; var wrapper = transactionWrappers[i]; try &#123; this.wrapperInitData[i] = Transaction.OBSERVED_ERROR; // è°ƒç”¨wrapperçš„initializeæ–¹æ³• this.wrapperInitData[i] = wrapper.initialize ? wrapper.initialize.call(this) : null; &#125; finally &#123; if (this.wrapperInitData[i] === Transaction.OBSERVED_ERROR) &#123; try &#123; this.initializeAll(i + 1); &#125; catch (err) &#123;&#125; &#125; &#125; &#125; &#125;, closeAll: function (startIndex) &#123; var transactionWrappers = this.transactionWrappers; // éåŽ†æ‰€æœ‰wrapper for (var i = startIndex; i &lt; transactionWrappers.length; i++) &#123; var wrapper = transactionWrappers[i]; var initData = this.wrapperInitData[i]; var errorThrown; try &#123; errorThrown = true; if (initData !== Transaction.OBSERVED_ERROR &amp;&amp; wrapper.close) &#123; // è°ƒç”¨wrapperçš„closeæ–¹æ³•ï¼Œå¦‚æžœæœ‰çš„è¯ wrapper.close.call(this, initData); &#125; errorThrown = false; &#125; finally &#123; if (errorThrown) &#123; try &#123; this.closeAll(i + 1); &#125; catch (e) &#123;&#125; &#125; &#125; &#125; this.wrapperInitData.length = 0; runBatchedUpdatesæ›´æ–°ç»„ä»¶å‰é¢åˆ†æžåˆ°enqueueUpdateä¸­è°ƒç”¨transaction.perform(callback, argsâ€¦)åŽï¼Œå°ä¼™ä¼´ä»¬è‚¯å®šä¼šå‘çŽ°ï¼Œcallbackè¿˜æ˜¯enqueueUpdateæ–¹æ³•å•Šï¼Œé‚£å²‚ä¸æ˜¯æ­»å¾ªçŽ¯äº†ï¼Ÿä¸æ˜¯è¯´å¥½çš„setStateä¼šè°ƒç”¨updateComponentï¼Œä»Žè€Œè‡ªåŠ¨åˆ·æ–°Viewçš„å—ï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦å…ˆä»Žtransactionäº‹åŠ¡è¯´èµ·ã€‚ æˆ‘ä»¬çš„wrapperä¸­æ³¨å†Œäº†ä¸¤ä¸ªwrapperï¼Œå¦‚ä¸‹1var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES]; RESET_BATCHED_UPDATESç”¨æ¥ç®¡ç†isBatchingUpdatesçŠ¶æ€ï¼Œæˆ‘ä»¬å‰é¢åœ¨åˆ†æžsetStateæ˜¯å¦ç«‹å³ç”Ÿæ•ˆæ—¶å·²ç»è®²è§£è¿‡äº†ã€‚é‚£FLUSH_BATCHED_UPDATESç”¨æ¥å¹²å˜›å‘¢ï¼Ÿ 123456789101112131415161718192021222324var FLUSH_BATCHED_UPDATES = &#123; initialize: emptyFunction, close: ReactUpdates.flushBatchedUpdates.bind(ReactUpdates)&#125;;var flushBatchedUpdates = function () &#123; // å¾ªçŽ¯éåŽ†å¤„ç†å®Œæ‰€æœ‰dirtyComponents while (dirtyComponents.length || asapEnqueued) &#123; if (dirtyComponents.length) &#123; var transaction = ReactUpdatesFlushTransaction.getPooled(); // closeå‰æ‰§è¡Œå®ŒrunBatchedUpdatesæ–¹æ³•ï¼Œè¿™æ˜¯å…³é”® transaction.perform(runBatchedUpdates, null, transaction); ReactUpdatesFlushTransaction.release(transaction); &#125; if (asapEnqueued) &#123; asapEnqueued = false; var queue = asapCallbackQueue; asapCallbackQueue = CallbackQueue.getPooled(); queue.notifyAll(); CallbackQueue.release(queue); &#125; &#125;&#125;; FLUSH_BATCHED_UPDATESä¼šåœ¨ä¸€ä¸ªtransactionçš„closeé˜¶æ®µè¿è¡ŒrunBatchedUpdatesï¼Œä»Žè€Œæ‰§è¡Œupdateã€‚ 123456789101112131415161718192021222324252627282930function runBatchedUpdates(transaction) &#123; var len = transaction.dirtyComponentsLength; dirtyComponents.sort(mountOrderComparator); for (var i = 0; i &lt; len; i++) &#123; // dirtyComponentsä¸­å–å‡ºä¸€ä¸ªcomponent var component = dirtyComponents[i]; // å–å‡ºdirtyComponentä¸­çš„æœªæ‰§è¡Œçš„callback,ä¸‹é¢å°±å‡†å¤‡æ‰§è¡Œå®ƒäº† var callbacks = component._pendingCallbacks; component._pendingCallbacks = null; var markerName; if (ReactFeatureFlags.logTopLevelRenders) &#123; var namedComponent = component; if (component._currentElement.props === component._renderedComponent._currentElement) &#123; namedComponent = component._renderedComponent; &#125; &#125; // æ‰§è¡ŒupdateComponent ReactReconciler.performUpdateIfNecessary(component, transaction.reconcileTransaction); // æ‰§è¡ŒdirtyComponentä¸­ä¹‹å‰æœªæ‰§è¡Œçš„callback if (callbacks) &#123; for (var j = 0; j &lt; callbacks.length; j++) &#123; transaction.callbackQueue.enqueue(callbacks[j], component.getPublicInstance()); &#125; &#125; &#125;&#125; runBatchedUpdateså¾ªçŽ¯éåŽ†dirtyComponentsæ•°ç»„ï¼Œä¸»è¦å¹²ä¸¤ä»¶äº‹ã€‚é¦–å…ˆæ‰§è¡ŒperformUpdateIfNecessaryæ¥åˆ·æ–°ç»„ä»¶çš„viewï¼Œç„¶åŽæ‰§è¡Œä¹‹å‰é˜»å¡žçš„callbackã€‚ä¸‹é¢æ¥çœ‹performUpdateIfNecessaryã€‚ 1234567891011performUpdateIfNecessary: function (transaction) &#123; if (this._pendingElement != null) &#123; // receiveComponentä¼šæœ€ç»ˆè°ƒç”¨åˆ°updateComponentï¼Œä»Žè€Œåˆ·æ–°View ReactReconciler.receiveComponent(this, this._pendingElement, transaction, this._context); &#125; if (this._pendingStateQueue !== null || this._pendingForceUpdate) &#123; // æ‰§è¡ŒupdateComponentï¼Œä»Žè€Œåˆ·æ–°Viewã€‚è¿™ä¸ªæµç¨‹åœ¨Reactç”Ÿå‘½å‘¨æœŸä¸­è®²è§£è¿‡ this.updateComponent(transaction, this._currentElement, this._currentElement, this._context, this._context); &#125; &#125;, æœ€åŽæƒŠå–œçš„çœ‹åˆ°äº†receiveComponentå’ŒupdateComponentå§ã€‚receiveComponentæœ€åŽä¼šè°ƒç”¨updateComponentï¼Œè€ŒupdateComponentä¸­ä¼šæ‰§è¡ŒReactç»„ä»¶å­˜åœ¨æœŸçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¦‚componentWillReceivePropsï¼Œ shouldComponentUpdateï¼Œ componentWillUpdateï¼Œrender, componentDidUpdateã€‚ ä»Žè€Œå®Œæˆç»„ä»¶æ›´æ–°çš„æ•´å¥—æµç¨‹ã€‚ æ€»ç»“setStateæµç¨‹è¿˜æ˜¯å¾ˆå¤æ‚çš„ï¼Œè®¾è®¡ä¹Ÿå¾ˆç²¾å·§ï¼Œé¿å…äº†é‡å¤æ— è°“çš„åˆ·æ–°ç»„ä»¶ã€‚å®ƒçš„ä¸»è¦æµç¨‹å¦‚ä¸‹ enqueueSetStateå°†stateæ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œå¹¶è°ƒç”¨enqueueUpdateå¤„ç†è¦æ›´æ–°çš„Component å¦‚æžœç»„ä»¶å½“å‰æ­£å¤„äºŽupdateäº‹åŠ¡ä¸­ï¼Œåˆ™å…ˆå°†Componentå­˜å…¥dirtyComponentä¸­ã€‚å¦åˆ™è°ƒç”¨batchedUpdateså¤„ç†ã€‚ batchedUpdateså‘èµ·ä¸€æ¬¡transaction.perform()äº‹åŠ¡ å¼€å§‹æ‰§è¡Œäº‹åŠ¡åˆå§‹åŒ–ï¼Œè¿è¡Œï¼Œç»“æŸä¸‰ä¸ªé˜¶æ®µ1.åˆå§‹åŒ–ï¼šäº‹åŠ¡åˆå§‹åŒ–é˜¶æ®µæ²¡æœ‰æ³¨å†Œæ–¹æ³•ï¼Œæ•…æ— æ–¹æ³•è¦æ‰§è¡Œ2.è¿è¡Œï¼šæ‰§è¡ŒsetSateæ—¶ä¼ å…¥çš„callbackæ–¹æ³•ï¼Œä¸€èˆ¬ä¸ä¼šä¼ callbackå‚æ•°3.ç»“æŸï¼šæ›´æ–°isBatchingUpdatesä¸ºfalseï¼Œå¹¶æ‰§è¡ŒFLUSH_BATCHED_UPDATESè¿™ä¸ªwrapperä¸­çš„closeæ–¹æ³• FLUSH_BATCHED_UPDATESåœ¨closeé˜¶æ®µï¼Œä¼šå¾ªçŽ¯éåŽ†æ‰€æœ‰çš„dirtyComponentsï¼Œè°ƒç”¨updateComponentåˆ·æ–°ç»„ä»¶ï¼Œå¹¶æ‰§è¡Œå®ƒçš„pendingCallbacks, ä¹Ÿå°±æ˜¯setStateä¸­è®¾ç½®çš„callbackã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React æºç åˆ†æž 3 Reactç”Ÿå‘½å‘¨æœŸè¯¦è§£]]></title>
    <url>%2F2018%2F03%2F26%2FReact%2FReact-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-3-React%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[Reactç”Ÿå‘½å‘¨æœŸæµç¨‹è°ƒç”¨æµç¨‹å¯ä»¥å‚çœ‹ä¸Šå›¾ã€‚åˆ†ä¸ºå®žä¾‹åŒ–ï¼Œå­˜åœ¨æœŸå’Œé”€æ¯ä¸‰ä¸ªä¸åŒé˜¶æ®µã€‚ä»‹ç»ç”Ÿå‘½å‘¨æœŸæµç¨‹çš„æ–‡ç« å¾ˆå¤šï¼Œç›¸ä¿¡å¤§éƒ¨åˆ†åŒå­¦ä¹Ÿæœ‰æ‰€äº†è§£ï¼Œæˆ‘ä»¬å°±ä¸è¯¦ç»†åˆ†æžäº†ã€‚å¾ˆå¤šåŒå­¦è‚¯å®šæœ‰ç–‘é—®ï¼Œè¿™äº›æ–¹æ³•åœ¨Reactå†…éƒ¨æ˜¯åœ¨å“ªäº›æ–¹æ³•ä¸­è¢«è°ƒç”¨çš„å‘¢ï¼Œä»–ä»¬è§¦å‘çš„æ—¶æœºåˆæ˜¯ä»€ä¹ˆæ—¶å€™å‘¢ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†åˆ†æžã€‚ å®žä¾‹åŒ–ç”Ÿå‘½å‘¨æœŸgetDefaultPropsåœ¨React.creatClass()åˆå§‹åŒ–ç»„ä»¶ç±»æ—¶ï¼Œä¼šè°ƒç”¨getDefaultProps()ï¼Œå°†è¿”å›žçš„é»˜è®¤å±žæ€§æŒ‚è½½åˆ°defaultPropså˜é‡ä¸‹ è¿™é‡Œè¦æçš„ä¸€ç‚¹æ˜¯ï¼Œåˆå§‹åŒ–ç»„ä»¶ç±»åªè¿è¡Œä¸€æ¬¡ã€‚å¯ä»¥æŠŠå®ƒç®€å•ç±»æ¯”ä¸ºJavaä¸­çš„Classå¯¹è±¡ã€‚åˆå§‹åŒ–ç»„ä»¶ç±»å°±æ˜¯ClassLoaderåŠ è½½Classå¯¹è±¡çš„è¿‡ç¨‹ã€‚ç±»å¯¹è±¡çš„åˆå§‹åŒ–ä¸è¦é”™è¯¯ç†è§£æˆäº†å®žä¾‹å¯¹è±¡çš„åˆå§‹åŒ–ã€‚ä¸€ä¸ªReactç»„ä»¶ç±»å¯èƒ½ä¼šåœ¨JSXä¸­è¢«å¤šæ¬¡è°ƒç”¨ï¼Œäº§ç”Ÿå¤šä¸ªç»„ä»¶å¯¹è±¡ï¼Œä½†å®ƒåªæœ‰ä¸€ä¸ªç±»å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ç±»åŠ è½½åŽgetDefaultPropså°±ä¸ä¼šå†è°ƒç”¨äº†ã€‚ getlnitialStateè¿™ä¸ªæ–¹æ³•åœ¨åˆ›å»ºç»„ä»¶å®žä¾‹å¯¹è±¡çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œå…·ä½“ä»£ç ä½äºŽReact.creatClass()çš„Constructorå‡½æ•°ä¸­ã€‚ æ¯æ¬¡åˆ›å»ºReactå®žä¾‹å¯¹è±¡æ—¶ï¼Œå®ƒéƒ½ä¼šè¢«è°ƒç”¨ã€‚ mountComponentcomponentWillMountï¼Œrenderï¼ŒcomponentDidMountéƒ½æ˜¯åœ¨mountComponentä¸­è¢«è°ƒç”¨.å®ƒæ˜¯åœ¨æ¸²æŸ“æ–°çš„ReactComponentä¸­è¢«è°ƒç”¨çš„ã€‚è¾“å…¥ReactComponentï¼Œè¿”å›žç»„ä»¶å¯¹åº”çš„HTMLã€‚æŠŠè¿™ä¸ªHTMLæ’å…¥åˆ°DOMä¸­ï¼Œå°±å¯ä»¥ç”Ÿæˆç»„ä»¶å¯¹åº”çš„DOMå¯¹è±¡äº†ã€‚æ‰€ä»¥mountComponentå°¤å…¶å…³é”®ã€‚ å’ŒJavaä¸­çš„å¤šæ€ä¸€æ ·ï¼Œä¸åŒçš„Reactç»„ä»¶çš„mountComponentå®žçŽ°éƒ½æœ‰æ‰€åŒºåˆ«ã€‚ä¸‹é¢æˆ‘ä»¬æ¥é‡ç‚¹åˆ†æžReactè‡ªå®šä¹‰ç»„ä»¶ç±»ï¼Œä¹Ÿå°±æ˜¯ReactCompositeComponentçš„mountComponentã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859mountComponent: function (transaction, nativeParent, nativeContainerInfo, context) &#123; this._context = context; this._mountOrder = nextMountID++; this._nativeParent = nativeParent; this._nativeContainerInfo = nativeContainerInfo; // åšpropTypesæ˜¯å¦åˆæ³•çš„åˆ¤æ–­ï¼Œè¿™ä¸ªåªåœ¨å¼€å‘é˜¶æ®µæœ‰ç”¨ var publicProps = this._processProps(this._currentElement.props); var publicContext = this._processContext(context); var Component = this._currentElement.type; // åˆå§‹åŒ–å…¬å…±ç±» var inst = this._constructComponent(publicProps, publicContext); var renderedElement; // instæˆ–è€…inst.renderä¸ºç©ºå¯¹åº”çš„æ˜¯statelessç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯æ— çŠ¶æ€ç»„ä»¶ // æ— çŠ¶æ€ç»„ä»¶æ²¡æœ‰å®žä¾‹å¯¹è±¡ï¼Œå®ƒæœ¬è´¨ä¸Šåªæ˜¯ä¸€ä¸ªè¿”å›žJSXçš„å‡½æ•°è€Œå·²ã€‚æ˜¯ä¸€ç§è½»é‡çº§çš„Reactç»„ä»¶ if (!shouldConstruct(Component) &amp;&amp; (inst == null || inst.render == null)) &#123; renderedElement = inst; warnIfInvalidElement(Component, renderedElement); inst = new StatelessComponent(Component); &#125; // è®¾ç½®å˜é‡ inst.props = publicProps; inst.context = publicContext; inst.refs = emptyObject; inst.updater = ReactUpdateQueue; this._instance = inst; // å­˜å‚¨å®žä¾‹å¯¹è±¡çš„å¼•ç”¨åˆ°mapä¸­ï¼Œæ–¹ä¾¿ä»¥åŽæŸ¥æ‰¾ ReactInstanceMap.set(inst, this); // åˆå§‹åŒ–stateï¼Œé˜Ÿåˆ—ç­‰ var initialState = inst.state; if (initialState === undefined) &#123; inst.state = initialState = null; &#125; this._pendingStateQueue = null; this._pendingReplaceState = false; this._pendingForceUpdate = false; var markup; if (inst.unstable_handleError) &#123; // æŒ‚è½½æ—¶å‡ºé”™ï¼Œè¿›è¡Œä¸€äº›é”™è¯¯å¤„ç†ï¼Œç„¶åŽperformInitialMountï¼Œåˆå§‹åŒ–æŒ‚è½½ markup = this.performInitialMountWithErrorHandling(renderedElement, nativeParent, nativeContainerInfo, transaction, context); &#125; else &#123; // åˆå§‹åŒ–æŒ‚è½½ markup = this.performInitialMount(renderedElement, nativeParent, nativeContainerInfo, transaction, context); &#125; if (inst.componentDidMount) &#123; // è°ƒç”¨componentDidMountï¼Œä»¥äº‹åŠ¡çš„å½¢å¼ transaction.getReactMountReady().enqueue(inst.componentDidMount, inst); &#125; return markup; &#125;, mountComponentå…ˆåšå®žä¾‹å¯¹è±¡çš„props,stateç­‰åˆå§‹åŒ–ï¼Œç„¶åŽè°ƒç”¨performInitialMountåˆå§‹åŒ–æŒ‚è½½ï¼Œå®ŒæˆåŽè°ƒç”¨componentDidMountã€‚è¿™ä¸ªè°ƒç”¨é“¾è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ã€‚ä¸‹é¢æˆ‘ä»¬é‡ç‚¹æ¥åˆ†æžperformInitialMountWithErrorHandlingå’ŒperformInitialMount 12345678910111213141516171819202122performInitialMountWithErrorHandling: function (renderedElement, nativeParent, nativeContainerInfo, transaction, context) &#123; var markup; var checkpoint = transaction.checkpoint(); try &#123; // æ”¾åˆ°try-catchä¸­ï¼Œå¦‚æžœæ²¡æœ‰å‡ºé”™åˆ™è°ƒç”¨performInitialMountåˆå§‹åŒ–æŒ‚è½½ã€‚å¯è§è¿™é‡Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯åšä¸€äº›é”™è¯¯å¤„ç†è€Œå·² markup = this.performInitialMount(renderedElement, nativeParent, nativeContainerInfo, transaction, context); &#125; catch (e) &#123; // handleErrorï¼Œå¸è½½ç»„ä»¶ï¼Œç„¶åŽé‡æ–°performInitialMountåˆå§‹åŒ–æŒ‚è½½ transaction.rollback(checkpoint); this._instance.unstable_handleError(e); if (this._pendingStateQueue) &#123; this._instance.state = this._processPendingState(this._instance.props, this._instance.context); &#125; checkpoint = transaction.checkpoint(); this._renderedComponent.unmountComponent(true); transaction.rollback(checkpoint); markup = this.performInitialMount(renderedElement, nativeParent, nativeContainerInfo, transaction, context); &#125; return markup; &#125;, å¯è§performInitialMountWithErrorHandlingåªæ˜¯å¤šäº†ä¸€å±‚é”™è¯¯å¤„ç†è€Œå·²ï¼Œå…³é”®è¿˜æ˜¯åœ¨performInitialMountä¸­ã€‚123456789101112131415161718192021222324252627performInitialMount: function (renderedElement, nativeParent, nativeContainerInfo, transaction, context) &#123; var inst = this._instance; if (inst.componentWillMount) &#123; // renderå‰è°ƒç”¨componentWillMount inst.componentWillMount(); // å°†stateæå‰åˆå¹¶ï¼Œæ•…åœ¨componentWillMountä¸­è°ƒç”¨setStateä¸ä¼šè§¦å‘é‡æ–°renderï¼Œè€Œæ˜¯åšä¸€æ¬¡stateåˆå¹¶ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯å‡å°‘ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ if (this._pendingStateQueue) &#123; inst.state = this._processPendingState(inst.props, inst.context); &#125; &#125; // å¦‚æžœä¸æ˜¯statelessï¼Œå³æ— çŠ¶æ€ç»„ä»¶ï¼Œåˆ™è°ƒç”¨renderï¼Œè¿”å›žReactElement if (renderedElement === undefined) &#123; renderedElement = this._renderValidatedComponent(); &#125; // å¾—åˆ°ç»„ä»¶ç±»åž‹ï¼Œå¦‚ç©ºç»„ä»¶ReactNodeTypes.EMPTYï¼Œè‡ªå®šä¹‰Reactç»„ä»¶ReactNodeTypes.COMPOSITEï¼ŒDOMåŽŸç”Ÿç»„ä»¶ReactNodeTypes.NATIVE this._renderedNodeType = ReactNodeTypes.getType(renderedElement); // ç”±ReactElementç”ŸæˆReactComponentï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ä¹‹å‰è®²è§£è¿‡ã€‚æ ¹æ®ä¸åŒtypeåˆ›å»ºä¸åŒComponentå¯¹è±¡ // å‚è€ƒ http://blog.csdn.net/u013510838/article/details/55669769 this._renderedComponent = this._instantiateReactComponent(renderedElement); // é€’å½’æ¸²æŸ“ï¼Œæ¸²æŸ“å­ç»„ä»¶ var markup = ReactReconciler.mountComponent(this._renderedComponent, transaction, nativeParent, nativeContainerInfo, this._processChildContext(context)); return markup; &#125;, performInitialMountä¸­å…ˆè°ƒç”¨componentWillMount()ï¼Œå†å°†setState()äº§ç”Ÿçš„stateæ”¹å˜è¿›è¡Œstateåˆå¹¶ï¼Œç„¶åŽè°ƒç”¨_renderValidatedComponent()è¿”å›žReactElementï¼Œå®ƒä¼šè°ƒç”¨render()æ–¹æ³•ã€‚ç„¶åŽç”±ReactElementåˆ›å»ºReactComponentã€‚æœ€åŽè¿›è¡Œé€’å½’æ¸²æŸ“ã€‚ä¸‹é¢æ¥çœ‹renderValidatedComponent() 123456789101112131415161718_renderValidatedComponent: function () &#123; var renderedComponent; ReactCurrentOwner.current = this; try &#123; renderedComponent = this._renderValidatedComponentWithoutOwnerOrContext(); &#125; finally &#123; ReactCurrentOwner.current = null; &#125; !( return renderedComponent;&#125;, _renderValidatedComponentWithoutOwnerOrContext: function () &#123; var inst = this._instance; // è°ƒç”¨renderæ–¹æ³•ï¼Œå¾—åˆ°ReactElementã€‚JSXç»è¿‡babelè½¬è¯‘åŽå…¶å®žå°±æ˜¯createElement()æ–¹æ³•ã€‚è¿™ä¸€ç‚¹åœ¨å‰é¢ä¹Ÿè®²è§£è¿‡ var renderedComponent = inst.render(); return renderedComponent;&#125;, å­˜åœ¨æœŸç”Ÿå‘½å‘¨æœŸç»„ä»¶å®žä¾‹å¯¹è±¡å·²ç»ç”Ÿæˆæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡setState()æ¥æ›´æ–°ç»„ä»¶ã€‚setStateæœºåˆ¶åŽé¢ä¼šæœ‰å•ç‹¬æ–‡ç« åˆ†æžï¼ŒçŽ°åœ¨åªç”¨çŸ¥é“å®ƒä¼šè°ƒç”¨updateComponent()æ¥å®Œæˆæ›´æ–°å³å¯ã€‚ä¸‹é¢æ¥åˆ†æžupdateComponent 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061updateComponent: function(transaction, prevParentElement, nextParentElement, prevUnmaskedContext, nextUnmaskedContext ) &#123; var inst = this._instance; var willReceive = false; var nextContext; var nextProps; // contextå¯¹è±¡å¦‚æžœæœ‰æ”¹åŠ¨,åˆ™æ£€æŸ¥propTypesç­‰,è¿™åœ¨å¼€å‘é˜¶æ®µå¯ä»¥æŠ¥é”™æé†’ if (this._context === nextUnmaskedContext) &#123; nextContext = inst.context; &#125; else &#123; nextContext = this._processContext(nextUnmaskedContext); willReceive = true; &#125; // å¦‚æžœçˆ¶å…ƒç´ ç±»åž‹ç›¸åŒ,åˆ™è·³è¿‡propTypesç±»åž‹æ£€æŸ¥ if (prevParentElement === nextParentElement) &#123; nextProps = nextParentElement.props; &#125; else &#123; nextProps = this._processProps(nextParentElement.props); willReceive = true; &#125; // è°ƒç”¨componentWillReceiveProps,å¦‚æžœé€šè¿‡setStateè¿›å…¥çš„updateComponentï¼Œåˆ™æ²¡æœ‰è¿™ä¸€æ­¥ if (willReceive &amp;&amp; inst.componentWillReceiveProps) &#123; inst.componentWillReceiveProps(nextProps, nextContext); &#125; // æå‰åˆå¹¶state,componentWillReceivePropsä¸­è°ƒç”¨setStateä¸ä¼šé‡æ–°æ¸²æŸ“,åœ¨æ­¤å¤„åšåˆå¹¶å³å¯,å› ä¸ºåŽé¢ä¹Ÿæ˜¯è¦è°ƒç”¨renderçš„ // è¿™æ ·å¯ä»¥é¿å…æ²¡å¿…è¦çš„æ¸²æŸ“ var nextState = this._processPendingState(nextProps, nextContext); // è°ƒç”¨shouldComponentUpdateç»™shouldUpdateèµ‹å€¼ // å¦‚æžœé€šè¿‡forceUpdateè¿›å…¥çš„updateComponentï¼Œå³_pendingForceUpdateä¸ä¸ºç©ºï¼Œåˆ™ä¸ç”¨åˆ¤æ–­shouldComponentUpdate. var shouldUpdate = true; if (!this._pendingForceUpdate &amp;&amp; inst.shouldComponentUpdate) &#123; shouldUpdate = inst.shouldComponentUpdate(nextProps, nextState, nextContext); &#125; // å¦‚æžœshouldUpdateä¸ºtrue,åˆ™ä¼šæ‰§è¡Œæ¸²æŸ“,å¦åˆ™ä¸ä¼š this._updateBatchNumber = null; if (shouldUpdate) &#123; this._pendingForceUpdate = false; // æ‰§è¡Œæ›´æ–°æ¸²æŸ“,åŽé¢è¯¦ç»†åˆ†æž this._performComponentUpdate( nextParentElement, nextProps, nextState, nextContext, transaction, nextUnmaskedContext ); &#125; else &#123; // shouldUpdateä¸ºfalse,åˆ™ä¸ä¼šæ›´æ–°æ¸²æŸ“ this._currentElement = nextParentElement; this._context = nextUnmaskedContext; inst.props = nextProps; inst.state = nextState; inst.context = nextContext; &#125;&#125;, updateComponentä¸­ï¼Œå…ˆè°ƒç”¨componentWillReceivePropsï¼Œç„¶åŽåˆå¹¶setStateå¯¼è‡´çš„stateå˜åŒ–ã€‚ç„¶åŽè°ƒç”¨shouldComponentUpdateåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°æ¸²æŸ“ã€‚å¦‚æžœéœ€è¦ï¼Œåˆ™è°ƒç”¨_performComponentUpdateæ‰§è¡Œæ¸²æŸ“æ›´æ–°ï¼Œä¸‹é¢æŽ¥ç€åˆ†æžperformComponentUpdateã€‚ 123456789101112131415161718192021222324252627282930313233343536373839_performComponentUpdate: function(nextElement,nextProps,nextState,nextContext,transaction, unmaskedContext ) &#123; var inst = this._instance; // åˆ¤æ–­æ˜¯å¦å·²ç»updateäº† var hasComponentDidUpdate = Boolean(inst.componentDidUpdate); var prevProps; var prevState; var prevContext; if (hasComponentDidUpdate) &#123; prevProps = inst.props; prevState = inst.state; prevContext = inst.context; &#125; // renderå‰è°ƒç”¨componentWillUpdate if (inst.componentWillUpdate) &#123; inst.componentWillUpdate(nextProps, nextState, nextContext); &#125; // state propsç­‰å±žæ€§è®¾ç½®åˆ°å†…éƒ¨å˜é‡instä¸Š this._currentElement = nextElement; this._context = unmaskedContext; inst.props = nextProps; inst.state = nextState; inst.context = nextContext; // å†…éƒ¨ä¼šè°ƒç”¨renderæ–¹æ³•ï¼Œé‡æ–°è§£æžReactElementå¹¶å¾—åˆ°HTML this._updateRenderedComponent(transaction, unmaskedContext); // renderåŽè°ƒç”¨componentDidUpdate if (hasComponentDidUpdate) &#123; transaction.getReactMountReady().enqueue( inst.componentDidUpdate.bind(inst, prevProps, prevState, prevContext), inst ); &#125;&#125;, _performComponentUpdateä¼šè°ƒç”¨componentWillUpdateï¼Œç„¶åŽåœ¨è°ƒç”¨updateRenderedComponentè¿›è¡Œæ›´æ–°æ¸²æŸ“ï¼Œæœ€åŽè°ƒç”¨componentDidUpdateã€‚ä¸‹é¢æ¥çœ‹çœ‹updateRenderedComponentä¸­æ€Žä¹ˆè°ƒç”¨renderæ–¹æ³•çš„ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950_updateRenderedComponent: function(transaction, context) &#123; var prevComponentInstance = this._renderedComponent; var prevRenderedElement = prevComponentInstance._currentElement; // _renderValidatedComponentå†…éƒ¨ä¼šè°ƒç”¨render,å¾—åˆ°ReactElement var nextRenderedElement = this._renderValidatedComponent(); // åˆ¤æ–­æ˜¯å¦åšDOM diffã€‚Reactä¸ºäº†ç®€åŒ–é€’å½’diff,è®¤ä¸ºç»„ä»¶å±‚çº§ä¸å˜,ä¸”typeå’Œkeyä¸å˜(keyç”¨äºŽlistViewç­‰ç»„ä»¶,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰è®¾ç½®type)æ‰update,å¦åˆ™å…ˆunmountå†é‡æ–°mount if (shouldUpdateReactComponent(prevRenderedElement, nextRenderedElement)) &#123; // é€’å½’updateComponent,æ›´æ–°å­ç»„ä»¶çš„Virtual DOM ReactReconciler.receiveComponent(prevComponentInstance, nextRenderedElement, transaction, this._processChildContext(context)); &#125; else &#123; var oldNativeNode = ReactReconciler.getNativeNode(prevComponentInstance); // ä¸åšDOM diff,åˆ™å…ˆå¸è½½æŽ‰,ç„¶åŽå†åŠ è½½ã€‚ä¹Ÿå°±æ˜¯å…ˆunMountComponent,å†mountComponent ReactReconciler.unmountComponent(prevComponentInstance, false); this._renderedNodeType = ReactNodeTypes.getType(nextRenderedElement); // ç”±ReactElementåˆ›å»ºReactComponent this._renderedComponent = this._instantiateReactComponent(nextRenderedElement); // mountComponentæŒ‚è½½ç»„ä»¶,å¾—åˆ°ç»„ä»¶å¯¹åº”HTML var nextMarkup = ReactReconciler.mountComponent(this._renderedComponent, transaction, this._nativeParent, this._nativeContainerInfo, this._processChildContext(context)); // å°†HTMLæ’å…¥DOMä¸­ this._replaceNodeWithMarkup(oldNativeNode, nextMarkup, prevComponentInstance); &#125;&#125;, _renderValidatedComponent: function() &#123; var renderedComponent; ReactCurrentOwner.current = this; try &#123; renderedComponent = this._renderValidatedComponentWithoutOwnerOrContext(); &#125; finally &#123; ReactCurrentOwner.current = null; &#125; return renderedComponent;&#125;,_renderValidatedComponentWithoutOwnerOrContext: function() &#123; var inst = this._instance; // çœ‹åˆ°renderæ–¹æ³•äº†æŠŠï¼Œåº”è¯¥æ”¾å¿ƒäº†æŠŠ~ var renderedComponent = inst.render(); return renderedComponent;&#125;, å’ŒmountComponentä¸­ä¸€æ ·ï¼ŒupdateComponentä¹Ÿæ˜¯ç”¨é€’å½’çš„æ–¹å¼å°†å„å­ç»„ä»¶è¿›è¡Œupdateçš„ã€‚è¿™é‡Œè¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯DOM diffã€‚DOM diffæ˜¯Reactä¸­æ¸²æŸ“åŠ é€Ÿçš„å…³é”®æ‰€åœ¨ï¼Œå®ƒä¼šå¸®æˆ‘ä»¬ç®—å‡ºvirtual DOMä¸­çœŸæ­£å˜åŒ–çš„éƒ¨åˆ†ï¼Œå¹¶å¯¹è¿™éƒ¨åˆ†è¿›è¡ŒåŽŸç”ŸDOMæ“ä½œã€‚ä¸ºäº†é¿å…å¾ªçŽ¯é€’å½’å¯¹æ¯”èŠ‚ç‚¹çš„ä½Žæ•ˆçŽ‡ï¼ŒReactä¸­åšäº†å‡è®¾ï¼Œå³åªå¯¹å±‚çº§ä¸å˜ï¼Œtypeä¸å˜ï¼Œkeyä¸å˜çš„ç»„ä»¶è¿›è¡ŒVirtual DOMæ›´æ–°ã€‚è¿™å…¶ä¸­çš„å…³é”®æ˜¯shouldUpdateReactComponentï¼Œä¸‹é¢åˆ†æž 12345678910111213141516171819202122function shouldUpdateReactComponent(prevElement, nextElement) &#123; var prevEmpty = prevElement === null || prevElement === false; var nextEmpty = nextElement === null || nextElement === false; if (prevEmpty || nextEmpty) &#123; return prevEmpty === nextEmpty; &#125; var prevType = typeof prevElement; var nextType = typeof nextElement; // React DOM diffç®—æ³• // å¦‚æžœå‰åŽä¸¤æ¬¡ä¸ºæ•°å­—æˆ–è€…å­—ç¬¦,åˆ™è®¤ä¸ºåªéœ€è¦update(å¤„ç†æ–‡æœ¬å…ƒç´ ) // å¦‚æžœå‰åŽä¸¤æ¬¡ä¸ºDOMå…ƒç´ æˆ–Reactå…ƒç´ ,åˆ™å¿…é¡»åœ¨åŒä¸€å±‚çº§å†…,ä¸”typeå’Œkeyä¸å˜(keyç”¨äºŽlistViewç­‰ç»„ä»¶,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰è®¾ç½®type)æ‰update,å¦åˆ™å…ˆunmountå†é‡æ–°mount if (prevType === 'string' || prevType === 'number') &#123; return (nextType === 'string' || nextType === 'number'); &#125; else &#123; return ( nextType === 'object' &amp;&amp; prevElement.type === nextElement.type &amp;&amp; prevElement.key === nextElement.key ); &#125;&#125; é”€æ¯å‰é¢æåˆ°è¿‡ï¼Œæ›´æ–°ç»„ä»¶æ—¶ï¼Œå¦‚æžœä¸æ»¡è¶³DOM diffæ¡ä»¶ï¼Œä¼šå…ˆunmountComponent, ç„¶åŽå†mountComponentï¼Œä¸‹é¢æˆ‘ä»¬æ¥åˆ†æžä¸‹unmountComponentæ—¶éƒ½å‘ç”Ÿäº†ä»€ä¹ˆäº‹ã€‚å’ŒmountComponentçš„å¤šæ€ä¸€æ ·ï¼Œä¸åŒtypeçš„ReactComponentä¹Ÿä¼šæœ‰ä¸åŒçš„unmountComponentè¡Œä¸ºã€‚æˆ‘ä»¬æ¥åˆ†æžä¸‹Reactè‡ªå®šä¹‰ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯ReactCompositeComponentä¸­çš„unmountComponentã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041unmountComponent: function(safely) &#123; if (!this._renderedComponent) &#123; return; &#125; var inst = this._instance; // è°ƒç”¨componentWillUnmount if (inst.componentWillUnmount &amp;&amp; !inst._calledComponentWillUnmount) &#123; inst._calledComponentWillUnmount = true; // å®‰å…¨æ¨¡å¼ä¸‹ï¼Œå°†componentWillUnmountåŒ…åœ¨try-catchä¸­ã€‚å¦åˆ™ç›´æŽ¥componentWillUnmount if (safely) &#123; var name = this.getName() + '.componentWillUnmount()'; ReactErrorUtils.invokeGuardedCallback(name, inst.componentWillUnmount.bind(inst)); &#125; else &#123; inst.componentWillUnmount(); &#125; &#125; // é€’å½’è°ƒç”¨unMountComponentæ¥é”€æ¯å­ç»„ä»¶ if (this._renderedComponent) &#123; ReactReconciler.unmountComponent(this._renderedComponent, safely); this._renderedNodeType = null; this._renderedComponent = null; this._instance = null; &#125; // resetç­‰å¾…é˜Ÿåˆ—å’Œå…¶ä»–ç­‰å¾…çŠ¶æ€ this._pendingStateQueue = null; this._pendingReplaceState = false; this._pendingForceUpdate = false; this._pendingCallbacks = null; this._pendingElement = null; // resetå†…éƒ¨å˜é‡,é˜²æ­¢å†…å­˜æ³„æ¼ this._context = null; this._rootNodeID = null; this._topLevelWrapper = null; // å°†ç»„ä»¶ä»Žmapä¸­ç§»é™¤,è¿˜è®°å¾—æˆ‘ä»¬åœ¨mountComponentä¸­å°†å®ƒåŠ å…¥äº†mapä¸­çš„å§ ReactInstanceMap.remove(inst); &#125;, å¯è§ï¼ŒunmountComponentè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå®ƒå°±åšä¸‰ä»¶äº‹1.è°ƒç”¨componentWillUnmount()2.é€’å½’è°ƒç”¨unmountComponent(),é”€æ¯å­ç»„ä»¶3.å°†å†…éƒ¨å˜é‡ç½®ç©ºï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ æ€»ç»“Reactè‡ªå®šä¹‰ç»„ä»¶åˆ›å»ºæœŸï¼Œå­˜åœ¨æœŸï¼Œé”€æ¯æœŸä¸‰ä¸ªé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸè°ƒç”¨ä¸Šé¢éƒ½è®²å®Œäº†ã€‚ä¸‰ä¸ªå…¥å£å‡½æ•°mountComponentï¼ŒupdateComponentï¼ŒunmountComponentå°¤å…¶å…³é”®ã€‚å¤§å®¶å¦‚æžœæœ‰å…´è¶£ï¼Œè¿˜å¯ä»¥è‡ªè¡Œåˆ†æžReactDOMEmptyComponentï¼ŒReactDOMComponentå’ŒReactDOMTextComponentçš„è¿™ä¸‰ä¸ªæ–¹æ³•ã€‚ æ·±å…¥å­¦ä¹ Reactç”Ÿå‘½å‘¨æœŸæºç å¯ä»¥å¸®æˆ‘ä»¬ç†æ¸…å„ä¸ªæ–¹æ³•çš„è°ƒç”¨é¡ºåºï¼Œæ˜Žç™½å®ƒä»¬éƒ½æ˜¯ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨çš„ï¼Œå“ªäº›æ¡ä»¶ä¸‹æ‰ä¼šè¢«è°ƒç”¨ç­‰ç­‰ã€‚é˜…è¯»æºç è™½ç„¶æœ‰ç‚¹æž¯ç‡¥ï¼Œä½†èƒ½å¤Ÿå¤§å¤§åŠ æ·±å¯¹ä¸Šå±‚APIæŽ¥å£çš„ç†è§£ï¼Œå¹¶ä½“ä¼šè®¾è®¡è€…è®¾è®¡è¿™äº›APIçš„è‰¯è‹¦ç”¨å¿ƒã€‚ Reactç»„ä»¶ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯´æ˜Žå®žä¾‹åŒ–é¦–æ¬¡å®žä¾‹åŒ– getDefaultPropsgetInitialStatecomponentWillMountrendercomponentDidMountå®žä¾‹åŒ–å®ŒæˆåŽçš„æ›´æ–° getInitialStatecomponentWillMountrendercomponentDidMountå­˜åœ¨æœŸç»„ä»¶å·²å­˜åœ¨æ—¶çš„çŠ¶æ€æ”¹å˜ componentWillReceivePropsshouldComponentUpdatecomponentWillUpdaterendercomponentDidUpdateé”€æ¯&amp;æ¸…ç†æœŸcomponentWillUnmountè¯´æ˜Žç”Ÿå‘½å‘¨æœŸå…±æä¾›äº†10ä¸ªä¸åŒçš„APIã€‚ 1.getDefaultPropsä½œç”¨äºŽç»„ä»¶ç±»ï¼Œåªè°ƒç”¨ä¸€æ¬¡ï¼Œè¿”å›žå¯¹è±¡ç”¨äºŽè®¾ç½®é»˜è®¤çš„propsï¼Œå¯¹äºŽå¼•ç”¨å€¼ï¼Œä¼šåœ¨å®žä¾‹ä¸­å…±äº«ã€‚ 2.getInitialStateä½œç”¨äºŽç»„ä»¶çš„å®žä¾‹ï¼Œåœ¨å®žä¾‹åˆ›å»ºæ—¶è°ƒç”¨ä¸€æ¬¡ï¼Œç”¨äºŽåˆå§‹åŒ–æ¯ä¸ªå®žä¾‹çš„stateï¼Œæ­¤æ—¶å¯ä»¥è®¿é—®this.propsã€‚ 3.componentWillMountåœ¨å®Œæˆé¦–æ¬¡æ¸²æŸ“ä¹‹å‰è°ƒç”¨ï¼Œæ­¤æ—¶ä»å¯ä»¥ä¿®æ”¹ç»„ä»¶çš„stateã€‚ 4.renderå¿…é€‰çš„æ–¹æ³•ï¼Œåˆ›å»ºè™šæ‹ŸDOMï¼Œè¯¥æ–¹æ³•å…·æœ‰ç‰¹æ®Šçš„è§„åˆ™ï¼š åªèƒ½é€šè¿‡this.propså’Œthis.stateè®¿é—®æ•°æ®å¯ä»¥è¿”å›žnullã€falseæˆ–ä»»ä½•Reactç»„ä»¶åªèƒ½å‡ºçŽ°ä¸€ä¸ªé¡¶çº§ç»„ä»¶ï¼ˆä¸èƒ½è¿”å›žæ•°ç»„ï¼‰ä¸èƒ½æ”¹å˜ç»„ä»¶çš„çŠ¶æ€ä¸èƒ½ä¿®æ”¹DOMçš„è¾“å‡º5.componentDidMountçœŸå®žçš„DOMè¢«æ¸²æŸ“å‡ºæ¥åŽè°ƒç”¨ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­å¯é€šè¿‡this.getDOMNode()è®¿é—®åˆ°çœŸå®žçš„DOMå…ƒç´ ã€‚æ­¤æ—¶å·²å¯ä»¥ä½¿ç”¨å…¶ä»–ç±»åº“æ¥æ“ä½œè¿™ä¸ªDOMã€‚ åœ¨æœåŠ¡ç«¯ä¸­ï¼Œè¯¥æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ã€‚ 6.componentWillReceivePropsç»„ä»¶æŽ¥æ”¶åˆ°æ–°çš„propsæ—¶è°ƒç”¨ï¼Œå¹¶å°†å…¶ä½œä¸ºå‚æ•°nextPropsä½¿ç”¨ï¼Œæ­¤æ—¶å¯ä»¥æ›´æ”¹ç»„ä»¶propsåŠstateã€‚ componentWillReceiveProps: function(nextProps) { if (nextProps.bool) { this.setState({ bool: true }); } } 7.shouldComponentUpdateç»„ä»¶æ˜¯å¦åº”å½“æ¸²æŸ“æ–°çš„propsæˆ–stateï¼Œè¿”å›žfalseè¡¨ç¤ºè·³è¿‡åŽç»­çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œé€šå¸¸ä¸éœ€è¦ä½¿ç”¨ä»¥é¿å…å‡ºçŽ°bugã€‚åœ¨å‡ºçŽ°åº”ç”¨çš„ç“¶é¢ˆæ—¶ï¼Œå¯é€šè¿‡è¯¥æ–¹æ³•è¿›è¡Œé€‚å½“çš„ä¼˜åŒ–ã€‚ åœ¨é¦–æ¬¡æ¸²æŸ“æœŸé—´æˆ–è€…è°ƒç”¨äº†forceUpdateæ–¹æ³•åŽï¼Œè¯¥æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ 8.componentWillUpdateæŽ¥æ”¶åˆ°æ–°çš„propsæˆ–è€…stateåŽï¼Œè¿›è¡Œæ¸²æŸ“ä¹‹å‰è°ƒç”¨ï¼Œæ­¤æ—¶ä¸å…è®¸æ›´æ–°propsæˆ–stateã€‚ 9.componentDidUpdateå®Œæˆæ¸²æŸ“æ–°çš„propsæˆ–è€…stateåŽè°ƒç”¨ï¼Œæ­¤æ—¶å¯ä»¥è®¿é—®åˆ°æ–°çš„DOMå…ƒç´ ã€‚ 10.componentWillUnmountç»„ä»¶è¢«ç§»é™¤ä¹‹å‰è¢«è°ƒç”¨ï¼Œå¯ä»¥ç”¨äºŽåšä¸€äº›æ¸…ç†å·¥ä½œï¼Œåœ¨componentDidMountæ–¹æ³•ä¸­æ·»åŠ çš„æ‰€æœ‰ä»»åŠ¡éƒ½éœ€è¦åœ¨è¯¥æ–¹æ³•ä¸­æ’¤é”€ï¼Œæ¯”å¦‚åˆ›å»ºçš„å®šæ—¶å™¨æˆ–æ·»åŠ çš„äº‹ä»¶ç›‘å¬å™¨ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React æºç åˆ†æž 2 Reactç»„ä»¶æ’å…¥Domæµç¨‹]]></title>
    <url>%2F2018%2F03%2F26%2FReact%2FReact-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-2-React%E6%8F%92%E5%85%A5Dom%E6%B5%81%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[ç®€ä»‹Reactå¹¿å—å¥½è¯„çš„ä¸€ä¸ªé‡è¦åŽŸå› å°±æ˜¯ç»„ä»¶åŒ–å¼€å‘ï¼Œä¸€æ–¹é¢åˆ†æ¨¡å—çš„æ–¹å¼ä¾¿äºŽååŒå¼€å‘ï¼Œé™ä½Žè€¦åˆï¼ŒåŽæœŸç»´æŠ¤ä¹Ÿè½»æ¾ï¼›å¦ä¸€æ–¹é¢ä½¿å¾—ä¸€æ¬¡å¼€å‘ï¼Œå¤šå¤„å¤ç”¨æˆä¸ºçŽ°å®žï¼Œç”šè‡³å¯ä»¥ç›´æŽ¥å¤ç”¨å¼€æºReactç»„ä»¶ã€‚å¼€å‘å®Œä¸€ä¸ªç»„ä»¶åŽï¼Œæˆ‘ä»¬éœ€è¦æ’å…¥DOMä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨å¦‚ä¸‹ä»£ç  1234ReactDOM.render( &lt;h1&gt;Hello, world!&lt;/h1&gt;, document.getElementById('example')); ç»è¿‡babelè½¬ç åŽä¸º 12345678ReactDOM.render( React.createElement( 'h1', // type, DOMåŽŸç”Ÿç»„ä»¶çš„typeä¸ºstringï¼ŒReactè‡ªå®šä¹‰ç»„ä»¶typeä¸ºObject null, // configï¼Œä¼šè®¾ç½®åˆ°refï¼Œkeyï¼Œpropsä¸­ 'Hello, world!' // childrenï¼Œå­ç»„ä»¶.è¿™å„¿ä¸ºæ–‡æœ¬ç»„ä»¶ ), document.getElementById('example')) é‚£ä¹ˆReactåº•å±‚æ˜¯æ€Žä¹ˆå°†ç»„ä»¶æ’å…¥DOMä¸­çš„å‘¢ã€‚æœ¬æ–‡æ¥è¯¦ç»†åˆ†æžå®ƒçš„å‰å› åŽæžœã€‚ ReactMount._renderSubtreeIntoContainer()ReactDOM.render()å®žé™…è°ƒç”¨ReactMount.render(),æŽ¥ç€è°ƒç”¨åˆ°ReactMount._renderSubtreeIntoContainer(). è¿™ä¸ªè°ƒç”¨é“¾æ¯”è¾ƒç®€å•ï¼Œä¸åˆ†æžäº†ã€‚ä¸‹é¢é‡ç‚¹åˆ†æž_renderSubtreeIntoContainer(). æˆ‘ä»¬åŽ»é™¤æŽ‰å¼€å‘è°ƒè¯•é˜¶æ®µçš„æŠ¥é”™ä»£ç ï¼ˆæ¯”å¦‚ â€œdevelopmentâ€ !== â€˜productionâ€™ï¼‰ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556 /** * å°†ReactElementæ’å…¥DOMä¸­ï¼Œå¹¶è¿”å›žReactElementå¯¹åº”çš„ReactComponentã€‚ * ReactElementæ˜¯Reactå…ƒç´ åœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºå½¢å¼ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ•°æ®ç±»ï¼ŒåŒ…å«typeï¼Œkeyï¼Œrefsï¼Œpropsç­‰æˆå‘˜å˜é‡ * ReactComponentæ˜¯Reactå…ƒç´ çš„æ“ä½œç±»ï¼ŒåŒ…å«mountComponent(), updateComponent()ç­‰å¾ˆå¤šæ“ä½œç»„ä»¶çš„æ–¹æ³• * * @param &#123;parentComponent&#125; çˆ¶ç»„ä»¶ï¼Œå¯¹äºŽç¬¬ä¸€æ¬¡æ¸²æŸ“ï¼Œä¸ºnull * @param &#123;nextElement&#125; è¦æ’å…¥åˆ°DOMä¸­çš„ç»„ä»¶ï¼Œå¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„&lt;h1&gt;Hello, world!&lt;/h1&gt;ç»è¿‡babelè½¬è¯‘åŽçš„å…ƒç´  * @param &#123;container&#125; è¦æ’å…¥åˆ°çš„å®¹å™¨ï¼Œå¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„document.getElementById('example')èŽ·å–çš„DOMå¯¹è±¡ * @param &#123;callback&#125; ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸ºnull * * @return &#123;component&#125; è¿”å›žReactComponentï¼Œå¯¹äºŽReactDOM.render()è°ƒç”¨ï¼Œä¸ç”¨ç®¡è¿”å›žå€¼ã€‚ */ _renderSubtreeIntoContainer: function (parentComponent, nextElement, container, callback) &#123; // åˆšå¼€å§‹ä¸€æ®µå¼€å‘é˜¶æ®µçš„æŠ¥é”™ä»£ç ï¼ŒçœåŽ» ... // åŒ…è£…ReactElementï¼Œå°†nextElementæŒ‚è½½åˆ°wrapperçš„propså±žæ€§ä¸‹ï¼Œè¿™æ®µä»£ç ä¸æ˜¯å¾ˆå…³é”® var nextWrappedElement = ReactElement(TopLevelWrapper, null, null, null, null, null, nextElement); // èŽ·å–è¦æ’å…¥åˆ°çš„å®¹å™¨çš„å‰ä¸€æ¬¡çš„ReactComponentï¼Œè¿™æ˜¯ä¸ºäº†åšDOM diff // å¯¹äºŽReactDOM.render()è°ƒç”¨ï¼ŒprevComponentä¸ºnull var prevComponent = getTopLevelWrapperInContainer(container); if (prevComponent) &#123; // ä»ŽprevComponentä¸­èŽ·å–åˆ°prevElementè¿™ä¸ªæ•°æ®å¯¹è±¡ã€‚ä¸€å®šè¦æžæ¸…æ¥šReactElementå’ŒReactComponentçš„ä½œç”¨ï¼Œä»–ä»¬å¾ˆå…³é”® var prevWrappedElement = prevComponent._currentElement; var prevElement = prevWrappedElement.props; // DOM diffç²¾é«“ï¼ŒåŒä¸€å±‚çº§å†…ï¼Œtypeå’Œkeyä¸å˜æ—¶ï¼Œåªç”¨updateå°±è¡Œã€‚å¦åˆ™å…ˆunmountç»„ä»¶å†mountç»„ä»¶ // è¿™æ˜¯Reactä¸ºäº†é¿å…é€’å½’å¤ªæ·±ï¼Œè€Œåšçš„DOM diffå‰æå‡è®¾ã€‚å®ƒåªå¯¹åŒä¸€DOMå±‚çº§ï¼Œtypeç›¸åŒï¼Œkey(å¦‚æžœæœ‰)ç›¸åŒçš„ç»„ä»¶åšDOM diffï¼Œå¦åˆ™ä¸ç”¨æ¯”è¾ƒï¼Œç›´æŽ¥å…ˆunmountå†mountã€‚è¿™ä¸ªå‡è®¾ä½¿å¾—diffç®—æ³•å¤æ‚åº¦ä»ŽO(n^3)é™ä½Žä¸ºO(n). // shouldUpdateReactComponentæºç è¯·çœ‹åŽé¢çš„åˆ†æž if (shouldUpdateReactComponent(prevElement, nextElement)) &#123; var publicInst = prevComponent._renderedComponent.getPublicInstance(); var updatedCallback = callback &amp;&amp; function () &#123; callback.call(publicInst); &#125;; // åªéœ€è¦updateï¼Œè°ƒç”¨_updateRootComponentï¼Œç„¶åŽç›´æŽ¥returnäº† ReactMount._updateRootComponent(prevComponent, nextWrappedElement, container, updatedCallback); return publicInst; &#125; else &#123; // ä¸åšupdateï¼Œç›´æŽ¥å…ˆå¸è½½å†æŒ‚è½½ã€‚å³unmountComponent,å†mountComponentã€‚mountComponentåœ¨åŽé¢ä»£ç ä¸­è¿›è¡Œ ReactMount.unmountComponentAtNode(container); &#125; &#125; var reactRootElement = getReactRootElementInContainer(container); var containerHasReactMarkup = reactRootElement &amp;&amp; !!internalGetID(reactRootElement); var containerHasNonRootReactChild = hasNonRootReactChild(container); var shouldReuseMarkup = containerHasReactMarkup &amp;&amp; !prevComponent &amp;&amp; !containerHasNonRootReactChild; // åˆå§‹åŒ–ï¼Œæ¸²æŸ“ç»„ä»¶ï¼Œç„¶åŽæ’å…¥åˆ°DOMä¸­ã€‚_renderNewRootComponentå¾ˆå…³é”®ï¼ŒåŽé¢è¯¦ç»†åˆ†æž var component = ReactMount._renderNewRootComponent(nextWrappedElement, container, shouldReuseMarkup, parentComponent != null ? parentComponent._reactInternalInstance._processChildContext(parentComponent._reactInternalInstance._context) : emptyObject)._renderedComponent.getPublicInstance(); // renderæ–¹æ³•ä¸­å¸¦å…¥çš„å›žè°ƒï¼ŒReactDOM.render()è°ƒç”¨æ—¶ä¸€èˆ¬ä¸ä¼ å…¥ if (callback) &#123; callback.call(component); &#125; return component; &#125;, shouldUpdateReactComponent()æºç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324function shouldUpdateReactComponent(prevElement, nextElement) &#123; // å‰åŽä¸¤æ¬¡ReactElementä¸­ä»»ä½•ä¸€ä¸ªä¸ºnullï¼Œåˆ™å¿…é¡»å¦ä¸€ä¸ªä¸ºnullæ‰è¿”å›žtrueã€‚è¿™ç§æƒ…å†µä¸€èˆ¬ä¸ä¼šç¢°åˆ° var prevEmpty = prevElement === null || prevElement === false; var nextEmpty = nextElement === null || nextElement === false; if (prevEmpty || nextEmpty) &#123; return prevEmpty === nextEmpty; &#125; var prevType = typeof prevElement; var nextType = typeof nextElement; // React DOM diffç®—æ³• if (prevType === 'string' || prevType === 'number') &#123; // å¦‚æžœå‰åŽä¸¤æ¬¡ä¸ºæ•°å­—æˆ–è€…å­—ç¬¦,åˆ™è®¤ä¸ºåªéœ€è¦update(å¤„ç†æ–‡æœ¬å…ƒç´ )ï¼Œè¿”å›žtrue return (nextType === 'string' || nextType === 'number'); &#125; else &#123; // å¦‚æžœå‰åŽä¸¤æ¬¡ä¸ºDOMå…ƒç´ æˆ–Reactå…ƒç´ ,åˆ™å¿…é¡»typeå’Œkeyä¸å˜(keyç”¨äºŽlistViewç­‰ç»„ä»¶,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰è®¾ç½®keyï¼Œæ•…åªéœ€typeç›¸åŒ)æ‰update,å¦åˆ™å…ˆunmountå†é‡æ–°mountã€‚è¿”å›žfalse return ( nextType === 'object' &amp;&amp; prevElement.type === nextElement.type &amp;&amp; prevElement.key === nextElement.key ); &#125;&#125; ReactMount._renderNewRootComponent1234567891011121314_renderNewRootComponent: function (nextElement, container, shouldReuseMarkup, context) &#123; ReactBrowserEventEmitter.ensureScrollValueMonitoring(); // åˆå§‹åŒ–ReactComponentï¼Œæ ¹æ®ReactElementä¸­ä¸åŒçš„typeå­—æ®µï¼Œåˆ›å»ºä¸åŒç±»åž‹çš„ç»„ä»¶å¯¹è±¡ï¼Œå³ReactComponent // å‰ä¸€ç¯‡æ–‡ç« ä¸­å·²ç»åˆ†æžäº†ã€‚http://blog.csdn.net/u013510838/article/details/55669769 var componentInstance = instantiateReactComponent(nextElement); // å¤„ç†batchedMountComponentIntoNodeæ–¹æ³•è°ƒç”¨ï¼Œå°†ReactComponentæ’å…¥DOMä¸­ï¼ŒåŽé¢è¯¦ç»†åˆ†æž ReactUpdates.batchedUpdates(batchedMountComponentIntoNode, componentInstance, container, shouldReuseMarkup, context); var wrapperID = componentInstance._instance.rootID; instancesByReactRootID[wrapperID] = componentInstance; return componentInstance; &#125;, batchedMountComponentIntoNodeä»¥transactionäº‹åŠ¡çš„å½¢å¼è°ƒç”¨mountComponentIntoNodeï¼Œæºç åˆ†æžå¦‚ä¸‹ã€‚ 123456789101112131415161718192021222324function mountComponentIntoNode(wrapperInstance, container, transaction, shouldReuseMarkup, context) &#123; var markerName; // ä¸€æ®µlogï¼Œå¯ä»¥ä¸ç®¡ if (ReactFeatureFlags.logTopLevelRenders) &#123; var wrappedElement = wrapperInstance._currentElement.props; var type = wrappedElement.type; markerName = 'React mount: ' + (typeof type === 'string' ? type : type.displayName || type.name); console.time(markerName); &#125; // è°ƒç”¨å¯¹åº”ReactComponentä¸­çš„mountComponentæ–¹æ³•æ¥æ¸²æŸ“ç»„ä»¶ï¼Œè¿™ä¸ªæ˜¯Reactç”Ÿå‘½å‘¨æœŸçš„é‡è¦æ–¹æ³•ã€‚åŽé¢è¯¦ç»†åˆ†æžã€‚ // mountComponentè¿”å›žReactç»„ä»¶è§£æžçš„HTMLã€‚ä¸åŒçš„ReactComponentçš„mountComponentç­–ç•¥ä¸åŒï¼Œå¯ä»¥çœ‹åšå¤šæ€ // ä¸Šé¢çš„&lt;h1&gt;Hello, world!&lt;/h1&gt;, å¯¹åº”çš„æ˜¯ReactDOMTextComponentï¼Œæœ€ç»ˆè§£æžæˆçš„HTMLä¸º // &lt;h1 data-reactroot=""&gt;Hello, world!&lt;/h1&gt; var markup = ReactReconciler.mountComponent(wrapperInstance, transaction, null, ReactDOMContainerInfo(wrapperInstance, container), context); if (markerName) &#123; console.timeEnd(markerName); &#125; wrapperInstance._renderedComponent._topLevelWrapper = wrapperInstance; // å°†è§£æžå‡ºæ¥çš„HTMLæ’å…¥DOMä¸­ ReactMount._mountImageIntoNode(markup, container, wrapperInstance, shouldReuseMarkup, transaction);&#125; _mountImageIntoNodeæºç å¦‚ä¸‹ 12345678910111213141516171819_mountImageIntoNode: function (markup, container, instance, shouldReuseMarkup, transaction) &#123; // å¯¹äºŽReactDOM.render()è°ƒç”¨ï¼ŒshouldReuseMarkupä¸ºfalse if (shouldReuseMarkup) &#123; ... &#125; if (transaction.useCreateElement) &#123; // æ¸…ç©ºcontainerçš„å­èŠ‚ç‚¹ï¼Œè¿™ä¸ªåœ°æ–¹ä¸æ˜Žç™½ä¸ºä»€ä¹ˆè¿™ä¹ˆåš while (container.lastChild) &#123; container.removeChild(container.lastChild); &#125; DOMLazyTree.insertTreeBefore(container, markup, null); &#125; else &#123; // å°†markupè¿™ä¸ªHTMLè®¾ç½®åˆ°containerè¿™ä¸ªDOMå…ƒç´ çš„innerHTMLå±žæ€§ä¸Šï¼Œè¿™æ ·å°±æ’å…¥åˆ°äº†DOMä¸­äº† setInnerHTML(container, markup); // å°†instanceè¿™ä¸ªReactComponentæ¸²æŸ“åŽçš„å¯¹è±¡ï¼Œå³Virtual DOMï¼Œä¿å­˜åˆ°containerè¿™ä¸ªDOMå…ƒç´ çš„firstChildè¿™ä¸ªåŽŸç”ŸèŠ‚ç‚¹ä¸Šã€‚ç®€å•ç†è§£å°±æ˜¯å°†Virtual DOMä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜äº¤äº’æ•ˆçŽ‡ ReactDOMComponentTree.precacheNode(instance, container.firstChild); &#125; &#125; æ€»ç»“ReactDOM.render(ï¼‰æ˜¯æ¸²æŸ“Reactç»„ä»¶å¹¶æ’å…¥åˆ°DOMä¸­çš„å…¥å£æ–¹æ³•ï¼Œå®ƒçš„æ‰§è¡Œæµç¨‹å¤§æ¦‚ä¸º 1.React.createElement(),åˆ›å»ºReactElementå¯¹è±¡ã€‚ä»–çš„é‡è¦çš„æˆå‘˜å˜é‡æœ‰type,key,ref,propsã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šè°ƒç”¨getInitialState(), åˆå§‹åŒ–stateï¼Œåªåœ¨æŒ‚è½½çš„æ—¶å€™æ‰è°ƒç”¨ã€‚åŽé¢updateæ—¶ä¸å†è°ƒç”¨äº†ã€‚ 2.instantiateReactComponent()ï¼Œæ ¹æ®ReactElementçš„typeåˆ†åˆ«åˆ›å»ºReactDOMComponentï¼Œ ReactCompositeComponentï¼ŒReactDOMTextComponentç­‰å¯¹è±¡ 3.mountComponent(), è°ƒç”¨Reactç”Ÿå‘½å‘¨æœŸæ–¹æ³•è§£æžç»„ä»¶ï¼Œå¾—åˆ°å®ƒçš„HTMLã€‚ 4._mountImageIntoNode(), å°†HTMLæ’å…¥åˆ°DOMçˆ¶èŠ‚ç‚¹ä¸­ï¼Œé€šè¿‡è®¾ç½®DOMçˆ¶èŠ‚ç‚¹çš„innerHTMLå±žæ€§ã€‚ 5.ç¼“å­˜èŠ‚ç‚¹åœ¨Reactä¸­çš„å¯¹åº”å¯¹è±¡ï¼Œå³Virtual DOMã€‚ !()[] åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React æºç åˆ†æž 1 ç»„ä»¶å’Œå¯¹è±¡çš„åˆ›å»ºï¼ˆcreateClassï¼ŒcreateElement)]]></title>
    <url>%2F2018%2F03%2F25%2FReact%2FReact-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-1-%E7%BB%84%E4%BB%B6%E5%92%8C%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA%EF%BC%88createClass%EF%BC%8CcreateElement%2F</url>
    <content type="text"><![CDATA[Reactå—å¤§å®¶æ¬¢è¿Žçš„ä¸€ä¸ªé‡è¦åŽŸå› å°±æ˜¯å¯ä»¥è‡ªå®šä¹‰ç»„ä»¶ã€‚è¿™æ ·çš„ä¸€æ–¹é¢å¯ä»¥å¤ç”¨å¼€å‘å¥½çš„ç»„ä»¶ï¼Œå®žçŽ°ä¸€å¤„å¼€å‘ï¼Œå¤„å¤„è°ƒç”¨ï¼Œå¦å¤–ä¹Ÿèƒ½ä½¿ç”¨åˆ«äººå¼€å‘å¥½çš„ç»„ä»¶ï¼Œæé«˜å°è£…æ€§ã€‚å¦ä¸€æ–¹é¢ä½¿å¾—ä»£ç ç»“æž„å¾ˆæ¸…æ™°ï¼Œç»„ä»¶é—´è€¦åˆå‡å°‘ï¼Œæ–¹ä¾¿ç»´æŠ¤ã€‚ES5åˆ›å»ºç»„ä»¶æ—¶ï¼Œè°ƒç”¨React.createClass()å³å¯. ES6ä¸­ä½¿ç”¨class myComponent extends React.Component, å…¶å®žå†…éƒ¨è¿˜æ˜¯è°ƒç”¨createClassåˆ›å»ºç»„ä»¶ã€‚ ç»„ä»¶åˆ›å»ºæˆ‘ä»¬å¯ä»¥ç®€å•ç±»æ¯”ä¸ºJavaä¸­ClassLoaderåŠ è½½classã€‚ä¸‹é¢æ¥åˆ†æžä¸‹createClassçš„æºç ï¼Œæˆ‘ä»¬çœåŽ»äº†å¼€å‘é˜¶æ®µé”™è¯¯æç¤ºçš„ç›¸å…³ä»£ç ï¼Œå¦‚propTypeçš„æ£€æŸ¥ã€‚ï¼ˆif (â€œdevelopmentâ€ !== â€˜productionâ€™) {}ä»£ç æ®µéƒ½ä¸è¿›è¡Œåˆ†æžäº†ï¼Œè¿™äº›åªåœ¨å¼€å‘è°ƒè¯•é˜¶æ®µè°ƒç”¨ï¼‰ ç»„ä»¶åˆ›å»º12345678910111213141516171819202122232425262728293031323334353637383940414243createClass: function (spec) &#123; var Constructor = function (props, context, updater) &#123; // è§¦å‘è‡ªåŠ¨ç»‘å®š if (this.__reactAutoBindPairs.length) &#123; bindAutoBindMethods(this); &#125; // åˆå§‹åŒ–å‚æ•° this.props = props; this.context = context; this.refs = emptyObject; // æœ¬ç»„ä»¶å¯¹è±¡çš„å¼•ç”¨ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥è°ƒç”¨ç»„ä»¶çš„æ–¹æ³• this.updater = updater || ReactNoopUpdateQueue; // è°ƒç”¨getInitialState()æ¥åˆå§‹åŒ–stateå˜é‡ this.state = null; var initialState = this.getInitialState ? this.getInitialState() : null; this.state = initialState; &#125;; // ç»§æ‰¿çˆ¶ç±» Constructor.prototype = new ReactClassComponent(); Constructor.prototype.constructor = Constructor; Constructor.prototype.__reactAutoBindPairs = []; injectedMixins.forEach(mixSpecIntoComponent.bind(null, Constructor)); mixSpecIntoComponent(Constructor, spec); // è°ƒç”¨getDefaultPropsï¼Œå¹¶æŒ‚è½½åˆ°ç»„ä»¶ç±»ä¸Šã€‚defaultPropsæ˜¯ç±»å˜é‡ï¼Œä½¿ç”¨ES6å†™æ³•æ—¶æ›´æ¸…æ™° if (Constructor.getDefaultProps) &#123; Constructor.defaultProps = Constructor.getDefaultProps(); &#125; // Reactä¸­æš´éœ²ç»™åº”ç”¨è°ƒç”¨çš„æ–¹æ³•ï¼Œå¦‚render componentWillMountã€‚ // å¦‚æžœåº”ç”¨æœªè®¾ç½®ï¼Œåˆ™å°†ä»–ä»¬è®¾ä¸ºnull for (var methodName in ReactClassInterface) &#123; if (!Constructor.prototype[methodName]) &#123; Constructor.prototype[methodName] = null; &#125; &#125; return Constructor; &#125;, createClassä¸»è¦åšçš„äº‹æƒ…æœ‰1.å®šä¹‰æž„é€ æ–¹æ³•Constructorï¼Œæž„é€ æ–¹æ³•ä¸­è¿›è¡Œpropsï¼Œrefsç­‰çš„åˆå§‹åŒ–ï¼Œå¹¶è°ƒç”¨getInitialStateæ¥åˆå§‹åŒ–state2.è°ƒç”¨getDefaultPropsï¼Œå¹¶æ”¾åœ¨defaultPropsç±»å˜é‡ä¸Šã€‚è¿™ä¸ªå˜é‡ä¸å±žäºŽæŸä¸ªå•ç‹¬çš„å¯¹è±¡ã€‚å¯ç†è§£ä¸ºstatic å˜é‡3.å°†Reactä¸­æš´éœ²ç»™åº”ç”¨ï¼Œä½†åº”ç”¨ä¸­æ²¡æœ‰è®¾ç½®çš„æ–¹æ³•ï¼Œè®¾ç½®ä¸ºnullã€‚ å¯¹è±¡çš„åˆ›å»ºJSXä¸­åˆ›å»ºReactå…ƒç´ æœ€ç»ˆä¼šè¢«babelè½¬è¯‘ä¸ºcreateElement(type, config, children), babelæ ¹æ®JSXä¸­æ ‡ç­¾çš„é¦–å­—æ¯æ¥åˆ¤æ–­æ˜¯åŽŸç”ŸDOMç»„ä»¶ï¼Œè¿˜æ˜¯è‡ªå®šä¹‰Reactç»„ä»¶ã€‚å¦‚æžœé¦–å­—æ¯å¤§å†™ï¼Œåˆ™ä¸ºReactç»„ä»¶ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆES6ä¸­Reactç»„ä»¶ç±»åå¿…é¡»å¤§å†™çš„åŽŸå› ã€‚å¦‚ä¸‹é¢ä»£ç  1234&lt;div className="title" ref="example"&gt; &lt;span&gt;123&lt;/span&gt; // åŽŸç”ŸDOMç»„ä»¶ï¼Œé¦–å­—æ¯å°å†™ &lt;ErrorPage title='123456' desc=&#123;[]&#125;/&gt; // è‡ªå®šä¹‰ç»„ä»¶ï¼Œé¦–å­—æ¯å¤§å†™&lt;/div&gt; è½¬è¯‘å®ŒæˆåŽ1234567891011121314151617React.createElement( 'div', // type,æ ‡ç­¾å,åŽŸç”ŸDOMå¯¹è±¡ä¸ºString &#123; className: 'title', ref: 'example' &#125;, // configï¼Œå±žæ€§ React.createElement('span', null, '123'), // childrenï¼Œå­å…ƒç´  React.createElement( // type,æ ‡ç­¾å,Reactè‡ªå®šä¹‰ç»„ä»¶çš„typeä¸ä¸ºString. // _errorPage2.defaultä¸ºä»Žå…¶ä»–æ–‡ä»¶ä¸­å¼•å…¥çš„Reactç»„ä»¶ _errorPage2.default, &#123; title: '123456', desc: [] &#125; ) // childrenï¼Œå­å…ƒç´ ) ä¸‹é¢æ¥åˆ†æžä¸‹createElementçš„æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354ReactElement.createElement = function (type, config, children) &#123; var propName; // åˆå§‹åŒ–å‚æ•° var props = &#123;&#125;; var key = null; var ref = null; var self = null; var source = null; // ä»Žconfigä¸­æå–å‡ºå†…å®¹ï¼Œå¦‚ref key props if (config != null) &#123; ref = config.ref === undefined ? null : config.ref; key = config.key === undefined ? null : '' + config.key; self = config.__self === undefined ? null : config.__self; source = config.__source === undefined ? null : config.__source; // æå–å‡ºconfigä¸­çš„propï¼Œæ”¾å…¥propså˜é‡ä¸­ for (propName in config) &#123; if (config.hasOwnProperty(propName) &amp;&amp; !RESERVED_PROPS.hasOwnProperty(propName)) &#123; props[propName] = config[propName]; &#125; &#125; &#125; // å¤„ç†childrenï¼ŒæŒ‚åˆ°propsçš„childrenå±žæ€§ä¸‹ // å…¥å‚çš„å‰ä¸¤ä¸ªä¸ºtypeå’Œconfigï¼ŒåŽé¢çš„å°±éƒ½æ˜¯childrenå‚æ•°äº†ã€‚æ•…éœ€è¦å‡2 var childrenLength = arguments.length - 2; if (childrenLength === 1) &#123; // åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œç›´æŽ¥æŒ‚åˆ°childrenå±žæ€§ä¸‹ï¼Œä¸æ˜¯arrayçš„æ–¹å¼ props.children = children; &#125; else if (childrenLength &gt; 1) &#123; // ä¸æ­¢ä¸€ä¸ªæ—¶ï¼Œæ”¾åˆ°arrayä¸­ï¼Œç„¶åŽå°†arrayæŒ‚åˆ°childrenå±žæ€§ä¸‹ var childArray = Array(childrenLength); for (var i = 0; i &lt; childrenLength; i++) &#123; childArray[i] = arguments[i + 2]; &#125; props.children = childArray; &#125; // å–å‡ºç»„ä»¶ç±»ä¸­çš„é™æ€å˜é‡defaultPropsï¼Œå¹¶ç»™æœªåœ¨JSXä¸­è®¾ç½®å€¼çš„å±žæ€§è®¾ç½®é»˜è®¤å€¼ if (type &amp;&amp; type.defaultProps) &#123; var defaultProps = type.defaultProps; for (propName in defaultProps) &#123; if (props[propName] === undefined) &#123; props[propName] = defaultProps[propName]; &#125; &#125; &#125; // è¿”å›žä¸€ä¸ªReactElementå¯¹è±¡ return ReactElement(type, key, ref, self, source, ReactCurrentOwner.current, props);&#125;; ä¸‹é¢æ¥çœ‹ReactElementæºç  12345678910111213141516var ReactElement = function (type, key, ref, self, source, owner, props) &#123; var element = &#123; // This tag allow us to uniquely identify this as a React Element $$typeof: REACT_ELEMENT_TYPE, // ReactElementå¯¹è±¡ä¸Šçš„å››ä¸ªå˜é‡ï¼Œç‰¹åˆ«å…³é”® type: type, key: key, ref: ref, props: props, // Record the component responsible for creating this element. _owner: owner &#125;; return element;&#125; å¯ä»¥çœ‹åˆ°ä»…ä»…æ˜¯ç»™ReactElementå¯¹è±¡å†…çš„æˆå‘˜å˜é‡èµ‹å€¼è€Œå·²ï¼Œä¸åœ¨èµ˜è¿°ã€‚ æµç¨‹å¦‚å¦‚ä¸‹ ç»„ä»¶å¯¹è±¡åˆå§‹åŒ–åœ¨mountComponent()æŒ‚è½½ç»„ä»¶ä¸­ï¼Œä¼šè¿›è¡Œç»„ä»¶æ¸²æŸ“ï¼Œè°ƒç”¨åˆ°instantiateReactComponent()æ–¹æ³•ã€‚è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬åœ¨Reactç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­å†è¯¦ç»†è®²è¿°ï¼Œè¿™é‡Œæœ‰ä¸ªå¤§ä½“äº†è§£å³å¯ã€‚instantiateReactComponent()æ ¹æ®ReactElementä¸­ä¸åŒçš„typeå­—æ®µï¼Œåˆ›å»ºä¸åŒç±»åž‹çš„ç»„ä»¶å¯¹è±¡ã€‚æºç å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637// åˆå§‹åŒ–ç»„ä»¶å¯¹è±¡ï¼Œnodeæ˜¯ä¸€ä¸ªReactElementå¯¹è±¡ï¼Œæ˜¯èŠ‚ç‚¹å…ƒç´ åœ¨Reactä¸­çš„è¡¨ç¤ºfunction instantiateReactComponent(node) &#123; var instance; var isEmpty = node === null || node === false; if (isEmpty) &#123; // ç©ºå¯¹è±¡ instance = ReactEmptyComponent.create(instantiateReactComponent); &#125; else if (typeof node === 'object') &#123; // ç»„ä»¶å¯¹è±¡ï¼ŒåŒ…æ‹¬DOMåŽŸç”Ÿçš„å’ŒReactè‡ªå®šä¹‰ç»„ä»¶ var element = node; // æ ¹æ®ReactElementä¸­çš„typeå­—æ®µåŒºåˆ† if (typeof element.type === 'string') &#123; // typeä¸ºstringåˆ™è¡¨ç¤ºDOMåŽŸç”Ÿå¯¹è±¡ï¼Œæ¯”å¦‚div spanç­‰ã€‚å¯ä»¥å‚çœ‹ä¸Šé¢babelè½¬è¯‘çš„é‚£æ®µä»£ç  instance = ReactNativeComponent.createInternalComponent(element); &#125; else if (isInternalComponentType(element.type)) &#123; // ä¿ç•™ç»™ä»¥åŽç‰ˆæœ¬ä½¿ç”¨ï¼Œæ­¤å¤„æš‚æ—¶ä¸ä¼šæ¶‰åŠåˆ° instance = new element.type(element); &#125; else &#123; // Reactè‡ªå®šä¹‰ç»„ä»¶ instance = new ReactCompositeComponentWrapper(element); &#125; &#125; else if (typeof node === 'string' || typeof node === 'number') &#123; // å…ƒç´ æ˜¯ä¸€ä¸ªstringæ—¶ï¼Œå¯¹åº”çš„æ¯”å¦‚&lt;span&gt;123&lt;/span&gt; ä¸­çš„123 // æœ¬è´¨ä¸Šå®ƒä¸æ˜¯ä¸€ä¸ªReactElementï¼Œä½†ä¸ºäº†ç»Ÿä¸€ï¼Œä¹ŸæŒ‰ç…§åŒæ ·æµç¨‹å¤„ç†ï¼Œç§°ä¸ºReactDOMTextComponent instance = ReactNativeComponent.createInstanceForText(node); &#125; else &#123; // æ— å¤„ç† &#125; // åˆå§‹åŒ–å‚æ•°ï¼Œè¿™ä¸¤ä¸ªå‚æ•°æ˜¯DOM diffæ—¶ç”¨åˆ°çš„ instance._mountIndex = 0; instance._mountImage = null; return instance;&#125; æ•…æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å››ç§åˆ›å»ºç»„ä»¶å…ƒç´ çš„æ–¹å¼ï¼ŒåŒæ—¶å¯¹åº”å››ç§ReactElement1.ReactEmptyComponent.create(), åˆ›å»ºç©ºå¯¹è±¡ReactDOMEmptyComponent2.ReactNativeComponent.createInternalComponent(), åˆ›å»ºDOMåŽŸç”Ÿå¯¹è±¡ ReactDOMComponent3.new ReactCompositeComponentWrapper(), åˆ›å»ºReactè‡ªå®šä¹‰å¯¹è±¡ReactCompositeComponent4.ReactNativeComponent.createInstanceForText(), åˆ›å»ºæ–‡æœ¬å¯¹è±¡ ReactDOMTextComponent ä¸‹é¢åˆ†åˆ«åˆ†æžè¿™å‡ ç§å¯¹è±¡ï¼Œå’Œåˆ›å»ºä»–ä»¬çš„è¿‡ç¨‹ã€‚ ReactDOMEmptyComponentç”±ReactEmptyComponent.create()åˆ›å»ºï¼Œæœ€ç»ˆç”ŸæˆReactDOMEmptyComponentå¯¹è±¡ï¼Œæºç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829var emptyComponentFactory;var ReactEmptyComponentInjection = &#123; injectEmptyComponentFactory: function (factory) &#123; emptyComponentFactory = factory; &#125;&#125;;var ReactEmptyComponent = &#123; create: function (instantiate) &#123; return emptyComponentFactory(instantiate); &#125;&#125;;ReactEmptyComponent.injection = ReactEmptyComponentInjection;ReactInjection.EmptyComponent.injectEmptyComponentFactory(function (instantiate) &#123; // å‰é¢æ¯”è¾ƒç»•ï¼Œå…³é”®å°±æ˜¯è¿™å¥è¯ï¼Œåˆ›å»ºReactDOMEmptyComponentå¯¹è±¡ return new ReactDOMEmptyComponent(instantiate);&#125;);// å„ç§nullï¼Œå°±ä¸åˆ†æžäº†var ReactDOMEmptyComponent = function (instantiate) &#123; this._currentElement = null; this._nativeNode = null; this._nativeParent = null; this._nativeContainerInfo = null; this._domID = null;&#125;; ReactDOMComponentç”±ReactNativeComponent.createInternalComponent()åˆ›å»ºã€‚è¿™é‡Œæ³¨æ„åŽŸç”Ÿç»„ä»¶ä¸ä»£è¡¨æ˜¯DOMç»„ä»¶ï¼Œè€Œæ˜¯Reactå°è£…è¿‡çš„Virtual DOMå¯¹è±¡ã€‚Reactå¹¶ä¸ç›´æŽ¥æ“ä½œåŽŸç”ŸDOMã€‚ å¤§å®¶å¯ä»¥è‡ªå·±çœ‹ReactDOMComponentçš„æºç ã€‚é‡ç‚¹çœ‹ä¸‹ReactDOMComponent.Mixin12345678910111213ReactDOMComponent.Mixin = &#123; mountComponent: function (transaction, nativeParent, nativeContainerInfo, context) &#123;&#125;, _createOpenTagMarkupAndPutListeners: function (transaction, props)&#123;&#125;, _createContentMarkup: function (transaction, props, context) &#123;&#125;, _createInitialChildren: function (transaction, props, context, lazyTree) &#123;&#125; receiveComponent: function (nextElement, transaction, context) &#123;&#125;, updateComponent: function (transaction, prevElement, nextElement, context) &#123;&#125;, _updateDOMProperties: function (lastProps, nextProps, transaction) &#123;&#125;, _updateDOMChildren: function (lastProps, nextProps, transaction, context) &#123;&#125;, getNativeNode: function () &#123;&#125;, unmountComponent: function (safely) &#123;&#125;, getPublicInstance: function () &#123;&#125;&#125; å…¶ä¸­æš´éœ²ç»™å¤–éƒ¨çš„æ¯”è¾ƒå…³é”®çš„æ˜¯mountComponentï¼ŒreceiveComponenï¼Œ updateComponentï¼ŒunmountComponentã€‚ä»–ä»¬ä¼šå¼•å‘Reactç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„è°ƒç”¨ï¼Œä¸‹ä¸€èŠ‚å†è®²ã€‚ ReactCompositeComponentç”±new ReactCompositeComponentWrapper()åˆ›å»ºï¼Œé‡ç‚¹çœ‹ä¸‹ReactCompositeComponentMixin 123456789101112131415var ReactCompositeComponentMixin = &#123; // newå¯¹åº”çš„æ–¹æ³•ï¼Œåˆ›å»ºReactCompositeComponentå¯¹è±¡ construct: function(element) &#123;&#125;, mountComponent, // åˆå§‹æŒ‚è½½ç»„ä»¶æ—¶è¢«è°ƒç”¨ï¼Œä»…ä¸€æ¬¡ performInitialMountWithErrorHandling, // å’ŒperformInitialMountç›¸è¿‘ï¼Œåªæ˜¯å¤šäº†é”™è¯¯å¤„ç† performInitialMount, // æ‰§è¡ŒmountComponentçš„æ¸²æŸ“é˜¶æ®µï¼Œä¼šè°ƒç”¨åˆ°instantiateReactComponentï¼Œä»Žè€Œè¿›å…¥åˆå§‹åŒ–Reactç»„ä»¶çš„å…¥å£ getNativeNode, unmountComponent, // å¸è½½ç»„ä»¶ï¼Œå†…å­˜é‡Šæ”¾ç­‰å·¥ä½œ receiveComponent, performUpdateIfNecessary, updateComponent, // setStateåŽè¢«è°ƒç”¨ï¼Œé‡æ–°æ¸²æŸ“ç»„ä»¶ attachRef, // å°†refæŒ‡å‘ç»„ä»¶å¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å®ƒè°ƒç”¨å¯¹è±¡å†…çš„æ–¹æ³•äº† detachRef, // å°†ç»„ä»¶çš„å¼•ç”¨ä»Žå…¨å±€å¯¹è±¡refsä¸­åˆ æŽ‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸èƒ½åˆ©ç”¨refæ‰¾åˆ°ç»„ä»¶å¯¹è±¡äº† instantiateReactComponentï¼Œ // åˆå§‹åŒ–Reactç»„ä»¶çš„å…¥å£ï¼Œåœ¨mountComponentæ—¶çš„æ¸²æŸ“é˜¶æ®µä¼šè¢«è°ƒç”¨&#125; ReactDOMTextComponent ç”±ReactNativeComponent.createInstanceForText()åˆ›å»ºï¼Œæˆ‘ä»¬ä¹Ÿä¸ç»†ç»†åˆ†æžäº†ï¼Œä¸»è¦å…¥å£ä»£ç å¦‚ä¸‹ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œåˆ†æžã€‚ 1234567891011var ReactDOMTextComponent = function (text) &#123; this._currentElement = text; this._stringText = '' + text;&#125;;_assign(ReactDOMTextComponent.prototype, &#123; mountComponent, receiveComponent, getNativeNode, unmountComponent&#125; åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascriptå®žç”¨æŠ€å·§]]></title>
    <url>%2F2018%2F03%2F23%2FJs%2Fjavascript%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[æ›´çŸ­çš„æ•°ç»„åŽ»é‡å†™æ³•123[...new Set([2,"12",2,12,1,2,1,6,12,13,6])]//[2, "12", 12, 1, 6, 13]//es6çš„æ–°ç‰¹æ€§ å¯¹è±¡æ·±æµ…æ‹·è´1.æ·±æ‹·è´å’Œæµ…æ‹·è´åªé’ˆå¯¹åƒObject, Arrayè¿™æ ·çš„å¼•ç”¨ç±»åž‹æ•°æ®ã€‚ 2.æµ…æ‹·è´æ˜¯å¯¹å¯¹è±¡å¼•ç”¨åœ°å€è¿›è¡Œæ‹·è´ï¼Œå¹¶æ²¡æœ‰å¼€è¾Ÿæ–°çš„æ ˆï¼Œä¹Ÿå°±æ˜¯æ‹·è´åŽçš„ç»“æžœæ˜¯ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨åœ°å€ï¼Œä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„å±žæ€§ï¼Œåˆ™å¦ä¸€ä¸ªå¯¹è±¡çš„å±žæ€§ä¹Ÿä¼šæ”¹å˜ã€‚ 3.æ·±æ‹·è´åˆ™æ˜¯å¼€å¯ä¸€ä¸ªæ–°çš„æ ˆï¼Œä¸¤ä¸ªå¯¹è±¡å¯¹åº”ä¸¤ä¸ªä¸åŒçš„å¼•ç”¨åœ°å€ï¼Œä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„å±žæ€§ï¼Œä¸ä¼šæ”¹å˜å¦ä¸€ä¸ªå¯¹è±¡çš„å±žæ€§ã€‚ æµ…æ‹·è´123456var myInfo=&#123;name:'å®ˆå€™',sex:'ç”·'&#125;;var newInfo=myInfo;newInfo.sex='å¥³';console.log(myInfo) //&#123;name: "å®ˆå€™", sex: "å¥³"&#125; å‡-æ·±æ‹·è´å‡-æ·±æ‹·è´è¿™ä¸ªæ˜¯è‡ªå·±éšæ€§å‘½åçš„ï¼Œå¤§å®¶çœ‹çœ‹å°±å¥½ï¼Œåˆ«å½“çœŸï¼123var myInfo=&#123;name:'å®ˆå€™',sex:'ç”·'&#125;;var newInfo=Object.assign(&#123;&#125;,myInfo)newInfo.sex='å¥³'; çœŸ-æ·±æ‹·è´çœŸ-æ·±æ‹·è´è¿™ä¸ªæ˜¯è‡ªå·±éšæ€§å‘½åçš„ï¼Œå¤§å®¶çœ‹çœ‹å°±å¥½ï¼Œåˆ«å½“çœŸï¼çœ‹ç€æ·±æµ…æ‹·è´ï¼ŒåŒºåˆ«å†™æ³•å¾ˆç®€å•ï¼Œä½†æ˜¯é‚£ä¸ªä¸Šé¢çš„æ·±æ‹·è´å†™æ³•æ˜¯æœ‰é—®é¢˜çš„ã€‚çœ‹ä¸‹é¢æ¡ˆä¾‹12345678910var arr=[&#123;a:1,b:2&#125;,&#123;a:3,b:4&#125;]var newArr=Object.assign([],arr)//æˆªæ–­æ•°ç»„newArr.length=1console.log(newArr)//[&#123;a:1,b:2&#125;]console.log(arr)//[&#123;a:1,b:2&#125;,&#123;a:3,b:4&#125;]//æ“ä½œnewArrï¼Œè¿™é‡Œçœ‹ç€å¯¹arræ²¡å½±å“ï¼Œå®žé™…ä¸Šå·²ç»æŒ–äº†ä¸€ä¸ªå‘ï¼Œä¸‹é¢å°±è·³è¿›åŽ»newArr[0].a=123//ä¿®æ”¹newArr[0]è¿™ä¸ªå¯¹è±¡ï¼Œä¹Ÿæ˜¯å½±å“äº†arr[0]è¿™ä¸ªå¯¹è±¡console.log(arr[0])//&#123;a: 123, b: 2&#125; //åˆ©ç”¨é€’å½’æ¥å®žçŽ°æ·±æ‹·è´ï¼Œå¦‚æžœå¯¹è±¡å±žæ€§çš„å€¼æ˜¯å¼•ç”¨ç±»åž‹ï¼ˆArray,Objectï¼‰ï¼Œé‚£ä¹ˆå¯¹è¯¥å±žæ€§è¿›è¡Œæ·±æ‹·è´ï¼Œç›´åˆ°éåŽ†åˆ°å±žæ€§çš„å€¼æ˜¯åŸºæœ¬ç±»åž‹ä¸ºæ­¢ã€‚ 1234567891011121314151617181920212223function deepClone(obj)&#123; if(!obj&amp;&amp; typeof obj!== 'object')&#123; return; &#125; var newObj= obj.constructor === Array ? [] : &#123;&#125;; for(var key in obj)&#123; if(obj[key])&#123; if(obj[key] &amp;&amp; typeof obj[key] === 'object')&#123; newObj[key] = obj[key].constructor === Array ? [] : &#123;&#125;; //é€’å½’ newObj[key] = deepClone(obj[key]); &#125;else&#123; newObj[key] = obj[key]; &#125; &#125; &#125; return newObj; &#125;var arr=[&#123;a:1,b:2&#125;,&#123;a:3,b:4&#125;]var newArr=deepClone(arr)console.log(arr[0])//&#123;a:1,b:2&#125;newArr[0].a=123console.log(arr[0])//&#123;a:1,b:2&#125; è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ç®€å•ç²—æš´æ³•ï¼Œæˆ‘çŽ°åœ¨åœ¨ç”¨çš„ä¸€ä¸ªæ–¹æ³•ï¼åŽŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯å…ˆæŠŠå¯¹è±¡è½¬æˆå­—ç¬¦ä¸²ï¼Œå†æŠŠå­—ç¬¦ä¸²è½¬æˆå¯¹è±¡ï¼ä¹Ÿèƒ½å®žçŽ°åŒæ ·æ•ˆæžœ12345var newArr2=JSON.parse(JSON.stringify(arr));console.log(arr[0])//&#123;a:1,b:2&#125;newArr2[0].a=123console.log(arr[0])//&#123;a:1,b:2&#125;ä¸Šé¢æ‰€è¯´çš„æµ…æ‹·è´ï¼ŒçœŸå‡æ·±æ‹·è´ï¼ˆè‡ªå·±éšæ€§å‘½åçš„ï¼‰ï¼Œè¿™å‡ ç§æƒ…å†µï¼Œåœ¨å¼€å‘ä¸Šéƒ½æœ‰å¯èƒ½è¦ç”¨åˆ°ï¼Œè‡³äºŽè¦ä½¿ç”¨å“ªä¸€ç§æ–¹å¼ï¼Œè§†æƒ…å†µè€Œå®šï¼ ä½¿ç”¨äº‹ä»¶å§”æ‰˜ä¸€ä¸ªç®€å•çš„éœ€æ±‚ï¼Œæ¯”å¦‚æƒ³ç»™ulä¸‹é¢çš„liåŠ ä¸Šç‚¹å‡»äº‹ä»¶ï¼Œç‚¹å‡»å“ªä¸ªliï¼Œå°±æ˜¾ç¤ºé‚£ä¸ªliçš„innerHTMLã€‚è¿™ä¸ªè²Œä¼¼å¾ˆç®€å•ï¼ä»£ç å¦‚ä¸‹ï¼ 123456789101112131415161718192021222324252627282930&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;ul id="ul-test"&gt; &lt;li&gt;0&lt;/li&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;li&gt;7&lt;/li&gt; &lt;li&gt;8&lt;/li&gt; &lt;li&gt;9&lt;/li&gt; &lt;/ul&gt; &lt;/body&gt; &lt;script type="text/javascript"&gt; var oUl=document.getElementById("ul-test"); var oLi=oUl.getElementsByTagName("li"); for(var i=0,len=oLi.length;i&lt;len;i++)&#123; oLi[i].addEventListener("click",function()&#123; alert(this.innerHTML) &#125;) &#125; &lt;/script&gt;&lt;/html&gt; å¾ˆç®€å•ï¼Œè¿™æ ·å°±å®žçŽ°äº†ï¼Œå®žé™…ä¸Šè¿™é‡Œæœ‰å‘ï¼Œä¹Ÿå¾…ä¼˜åŒ–ï¼1.forå¾ªçŽ¯ï¼Œå¾ªçŽ¯çš„æ˜¯liï¼Œ10ä¸ªliå°±å¾ªçŽ¯10æ¬¡ï¼Œç»‘å®š10æ¬¡äº‹ä»¶ï¼Œ100ä¸ªå°±å¾ªçŽ¯äº†100æ¬¡ï¼Œç»‘å®š100æ¬¡äº‹ä»¶ï¼2.å¦‚æžœliä¸æ˜¯æœ¬æ¥å°±åœ¨é¡µé¢ä¸Šçš„ï¼Œæ˜¯æœªæ¥å…ƒç´ ï¼Œæ˜¯é¡µé¢åŠ è½½äº†ï¼Œå†é€šè¿‡jsåŠ¨æ€åŠ è½½è¿›æ¥äº†ï¼Œä¸Šé¢çš„å†™æ³•æ˜¯æ— æ•ˆçš„ï¼Œç‚¹å‡»liæ˜¯æ²¡æœ‰ååº”çš„ï¼æ‰€ä»¥å°±è€…éœ€è¦ç”¨äº‹ä»¶å§”æ‰˜ï¼ˆå³ä½¿ä¸è€ƒè™‘ä¸Šé¢çš„ç¬¬äºŒç§æƒ…å†µï¼Œä¹Ÿæ˜¯å»ºè®®ä½¿ç”¨äº‹ä»¶å§”æ‰˜ï¼‰ï¼ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;ul id="ul-test"&gt; &lt;li&gt;0&lt;/li&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;li&gt;7&lt;/li&gt; &lt;li&gt;8&lt;/li&gt; &lt;li&gt;9&lt;/li&gt; &lt;/ul&gt; &lt;/body&gt; &lt;script type="text/javascript"&gt; var oUl=document.getElementById("ul-test"); oUl.addEventListener("click",function(ev)&#123; var ev=ev||window.event; var target=ev.target||ev.srcElement; //å¦‚æžœç‚¹å‡»çš„æœ€åº•å±‚æ˜¯liå…ƒç´  if(target.tagName.toLowerCase()==='li')&#123; alert(target.innerHTML) &#125; &#125;) &lt;/script&gt;&lt;/html&gt;è¿™æ ·å†™ï¼Œå³ä½¿æ˜¯åŠ¨æ€æ·»åŠ è¿›æ¥çš„liç‚¹å‡»ä¹Ÿæœ‰ååº”ï¼Œè¿˜æœ‰ä¸€ä¸ªå°±æ˜¯ulåªæœ‰ä¸€ä¸ªï¼Œäº‹ä»¶ç»‘å®šåœ¨ulä¸Šï¼Œæ— è®ºliå¤šå°‘ä¸ªï¼Œéƒ½æ˜¯æ·»åŠ ä¸€æ¬¡äº‹ä»¶ï¼ä½†æ˜¯ä¹Ÿæ˜¯å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼Œå¦‚æžœliä¸‹é¢è¿˜æœ‰å­å…ƒç´ ï¼Œé‚£ä¹ˆç‚¹å‡»çš„æ—¶å€™ï¼Œtargetå¯èƒ½ä¸æ˜¯liï¼Œè€Œæ˜¯é¼ æ ‡ç‚¹å‡»é‚£ä¸ªä½ç½®çš„æœ€åº•å±‚å…ƒç´ ï¼å¦‚ä¸‹å›¾ï¼Œå¦‚æžœé¼ æ ‡ç‚¹å‡»ç™½è‰²åŒºåŸŸï¼Œé‚£ä¸ªtargetå°±æ˜¯bodyå…ƒç´ ,é¼ æ ‡ç‚¹å‡»ç»¿è‰²åŒºåŸŸtargetå°±æ˜¯divå…ƒç´ ï¼Œé¼ æ ‡ç‚¹å‡»è“è‰²åŒºåŸŸtargetå°±æ˜¯ulï¼Œç‚¹å‡»æ©™è‰²å°±æ˜¯liã€‚ ä½¿ç”¨å¯¹è±¡ä½œä¸ºå‡½æ•°å‚æ•°å¤§å®¶è¯•æƒ³ä¸‹è¿™æ ·ä¸€ä¸ªå‡½æ•°â€“å‡½æ•°æŽ¥å—å‡ ä¸ªå‚æ•°ï¼Œä½†æ˜¯è¿™å‡ ä¸ªå‚æ•°éƒ½ä¸æ˜¯å¿…å¡«çš„ï¼Œå‡½æ•°è¯¥æ€Žä¹ˆå¤„ç†ï¼Ÿæ˜¯ä¸æ˜¯ä¸‹é¢è¿™æ · 12345function personInfo(name,phone,card)&#123; ...&#125;//ä»¥ä¸Šå‡½æ•°ï¼Œå¯ä»¥ä»»æ„ä¼ å‚æ•°ã€‚æ¯”å¦‚æˆ‘æƒ³ä¼ cardç­‰äºŽ1472586326ã€‚è¿™ä¸‹æ˜¯ä¸æ˜¯è¿™æ ·å†™personInfo('','','1472586326') æœ‰æ²¡æœ‰è§‰å¾—ä¸Šé¢å†™æ³•å¥‡æ€ªï¼Œä¸å¤ªä¼˜é›…ï¼Ÿä¸‹é¢è¿™é‡Œçœ‹ç€èˆ’æœä¸€ç‚¹ï¼1234function personInfo(opt)&#123; ...&#125;personInfo(&#123;card:'1472586326'&#125;) å†æƒ³ä¸€ä¸‹ï¼Œå¦‚æžœä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°å¾ˆå¤šï¼Œæ€Žä¹ˆå¤„ç†ï¼Ÿ123function test(arg1,arg2,arg3,arg4,arg5,arg6,arg7)&#123; ...&#125; å¯†é›†ææƒ§ç—‡å¤å‘æ²¡æœ‰å¤å‘ï¼Ÿä¸‹é¢è¿™æ ·çœ‹ç€ä¼šèˆ’æœä¸€ç‚¹ï¼123function personInfo(opt)&#123; ...&#125; æœ€åŽå†æƒ³ä¸€ä¸‹ï¼Œå¦‚æžœéœ€æ±‚æ”¹äº†ï¼Œæ“ä½œå‡½æ•°ä¹Ÿè¦æ”¹ï¼å‡½æ•°ä¹Ÿè¦å¢žåŠ ä¸€ä¸ªå‚æ•°ã€‚12345678//åŽŸæ¥å‡½æ•°function personInfo(name,phone,card)&#123; ...&#125;//ä¿®æ”¹åŽfunction personInfo(name,age,phone,card)&#123; ...&#125; è¿™æ ·å°±æ˜¯å‚æ•°ä¿®æ”¹ä¸€æ¬¡ï¼Œå‡½æ•°çš„å‚æ•°å°±è¦ä¿®æ”¹ä¸€æ¬¡ï¼å¦‚æžœæ˜¯ç”¨å¯¹è±¡ï¼Œå°±ä¸ä¼šå‡ºçŽ°è¿™æ ·é—®é¢˜ï¼1234//ä¿®æ”¹å‰åŽéƒ½æ˜¯è¿™æ ·ï¼Œå˜å¾—æ˜¯å‡½æ•°çš„æ“ä½œå†…å®¹å’Œè°ƒç”¨æ—¶å€™çš„ä¼ å‚ï¼function personInfo(opt)&#123; ...&#125; çœ‹äº†ä¸Šé¢çš„å‡ ä¸ªæ —å­ï¼Œæ€»ç»“æ¥è¯´ï¼Œå°±æ˜¯å½“å‡½æ•°çš„å‚æ•°ä¸å›ºå®šçš„æ—¶å€™ï¼Œå‚æ•°å¤š(ä¸‰ä¸ªæˆ–è€…ä¸‰ä¸ªä»¥ä¸Š)çš„æ—¶å€™ï¼Œå»ºè®®ç”¨ä¸€ä¸ªå¯¹è±¡è®°å½•å‚æ•°ï¼Œè¿™æ ·ä¼šæ¯”è¾ƒæ–¹ä¾¿ï¼Œä¹Ÿä¸ºä»¥åŽå¦‚æžœå‚æ•°è¦æ”¹ç•™äº†æ¡åŽè·¯ï¼ ä½¿ç”¨pushå’Œapplyåˆå¹¶æ•°ç»„åˆå¹¶æ•°ç»„è¿™ä¸ªå·²ç»æ˜¯è€ç”Ÿå¸¸è°ˆçš„è¯é¢˜äº†ï¼Œæ–¹æ³•ä¹Ÿæ˜¯å¤šç§å¤šæ ·ï¼ concat123var arr1=[1,2,3,4,5],arr2=[6,7,8,9,10];arr1=arr1.concat(arr2)console.log(arr1)//[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] concatä¼šä¸€ä¸ªå…¨æ–°çš„æ•°ç»„ï¼Œè¡¨ç¤ºarr1å’Œarr2ä¸¤ä¸ªæ•°ç»„çš„ç»„åˆï¼Œå¹¶è®©arr1å’Œarr2ä¸å˜ã€‚ç®€å•å§ï¼Ÿä½†å¦‚æžœarr1å’Œarr2çš„é•¿åº¦éƒ½å¾ˆé•¿ï¼Œé‚£å°±äº§ç”Ÿäº†ä¸€ä¸ªå¾ˆé•¿å¾ˆé•¿çš„æ•°ç»„ï¼Œå†…å­˜åˆè¢«å ç”¨äº†é‚£ä¹ˆå¤šã€‚ä½†æ˜¯æ•°ç»„é•¿åº¦æ²¡é™åˆ¶ï¼ for12345var arr1=[1,2,3,4,5],arr2=[6,7,8,9,10];for(var i=0,len=arr2.length;i&lt;len;i++)&#123; arr1.push(arr2[i])&#125;console.log(arr1)//[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] è¿™é‡Œæ˜¯å¾€arr1å¾ªçŽ¯æ·»åŠ arr2çš„å…ƒç´ ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæƒ…å†µï¼Œarr1çš„é•¿åº¦è¿œå°äºŽarr2çš„é•¿åº¦ï¼Œæ˜¯ä¸æ˜¯å¾ªçŽ¯arr1æ€§èƒ½æ›´å¥½ï¼Œå¾ªçŽ¯æ¬¡æ•°æ›´å°‘ã€‚å¤„ç†è¿™ä¸ªå¾ˆç®€å•ï¼Œä½†æ˜¯ä¸‡ä¸€ä¸çŸ¥é“arr1å’Œarr2åˆ°åº•å“ªä¸ªé•¿åº¦æ›´å°‘å‘¢ï¼Ÿè€Œä¸”ï¼Œforå¾ªçŽ¯ä¸å¤Ÿä¼˜é›…ï¼ï¼ˆå½“ç„¶ï¼Œè¿™ä¸ªå¯ä»¥ç”¨è¿­ä»£æ–¹æ³•æ¥æ›¿ä»£ï¼‰ reduce123456var arr1=[1,2,3,4,5],arr2=[6,7,8,9,10];arr1 = arr2.reduce((fcoll,item) =&gt; &#123; coll.push( item ); return coll; &#125;, arr1 ); console.log(arr1)//[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] é€¼æ ¼é«˜äº†ä¸€ç‚¹ï¼Œè€Œä¸”ç”¨ES6çš„ç®­å¤´å‡½æ•°è¿˜å¯ä»¥å‡å°‘ä¸€äº›ä»£ç é‡ï¼Œä½†å®ƒä»ç„¶éœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå…ƒç´ éƒ½éœ€è¦è°ƒç”¨ä¸€æ¬¡ã€‚ push.apply123var arr1=[1,2,3,4,5],arr2=[6,7,8,9,10];arr1.push.apply(arr1,arr2);console.log(arr1)//[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] é€¼æ ¼çœ‹ç€é«˜ï¼Œä»£ç å°‘ï¼Œä¹Ÿä¸ä¼šäº§ç”Ÿæ–°çš„æ•°ç»„ï¼Œä¹Ÿä¸éš¾ç†è§£ï¼Œå°±æ˜¯è°ƒç”¨arr1.pushè¿™ä¸ªå‡½æ•°å®žä¾‹çš„applyæ–¹æ³•ï¼ŒåŒæ—¶æŠŠarr2å½“ä½œå‚æ•°ä¼ å…¥ï¼Œè¿™æ ·arr1.pushè¿™ä¸ªæ–¹æ³•å°±ä¼šéåŽ†arr2æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ï¼Œè¾¾åˆ°åˆå¹¶çš„æ•ˆæžœã€‚ç›¸å½“äºŽarr1.push.apply(arr1,[6,7,8,9,10]);ï¼Œæœ€åŽç›¸å½“äºŽarr1.push(6,7,8,9,10)ã€‚é—æ†¾çš„å°±æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•å¯¹æ•°ç»„é•¿åº¦æœ‰é™åˆ¶ï¼Œç½‘ä¸Šè¯´æ³•æ˜¯ä¸åŒæµè§ˆå™¨ï¼Œä¸åŒçš„é•¿åº¦é™åˆ¶ï¼Œä¸€èˆ¬ä¸è¶…è¿‡10ä¸‡ï¼ toFixedä¿ç•™æ•´æ•°åœ¨å¼€å‘ä¸Šï¼Œç»å¸¸ä¼šé‡åˆ°æœ€å¤šä¿ç•™å¤šå°‘ä½å°æ•°æˆ–è€…ç±»ä¼¼çš„é—®é¢˜ï¼Œé’ˆå¯¹è¿™ä¸ªï¼Œä½¿ç”¨toFixedå¯ä»¥å¾ˆç®€å•çš„è§£å†³é—®é¢˜ï¼Œä½†æ˜¯å¦‚æžœæ•°æ®æ˜¯è¦å’ŒåŽå°äº¤äº’çš„ï¼Œè€Œä¸”åŽå°å­˜å‚¨çš„æ•°æ®ä¸€èˆ¬æ˜¯ä¿å­˜æ•°å­—ç±»åž‹ï¼Œè€Œä½¿ç”¨toFixedåŽç”Ÿæˆçš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸‹ï¼Œå°±éœ€è¦æŠŠtoFixedç”Ÿæˆçš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æˆæ•°å­—ç±»åž‹ï¼Œè½¬å‘å¾ˆå¤šã€‚ä»Šå¤©æˆ‘è¯´ä¸€ä¸ªæœ€ç®€å•â€“+ã€‚ä»£ç å¦‚ä¸‹ 1234var a=123.36896335.toFixed(2)console.log(a)//'123.37'a=+aconsole.log(a)//123.37 PSï¼ša=a|0å’Œ~~aä¹Ÿå¯ä»¥å®žçŽ°ï¼Œä½†æ˜¯ç”Ÿæˆçš„æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå¦‚ä¸‹ 123456789var a=123.36896335.toFixed(2)console.log(a)//'123.37'a=a|0 console.log(a)//123 //---------------------------------åˆ†å‰²çº¿var a=123.36896335.toFixed(2)console.log(a)//'123.37'a=~~a console.log(a)//123 å…¶å®ƒç±»åž‹æ•°æ®è½¬å¸ƒå°”æ•°æ®ä¸‹é¢çš„è½¬æ¢ï¼Œå¤§å®¶ä¸€çœ‹å°±æ˜Žç™½äº†ï¼Œä¸å¤šè¯´ã€‚123456789101112console.log(!!'123')//true!!12//true!!-1//true!![]//true!!''//false!!null//false ç¼“å­˜å˜é‡123456789var arr=[1,2,3,4,5,6]for(var i=0,i&lt;arr.length;i++)&#123; ...&#125;//------------------------åˆ†å‰²çº¿var arr=[1,2,3,4,5,6]for(var i=0,len=arr.length;i&lt;len;i++)&#123; ...&#125; ç¬¬ä¸€æ®µå°±æ˜¯æ¯ä¸€æ¬¡å¾ªçŽ¯çš„æ—¶å€™ï¼Œéƒ½è¦æŸ¥è¯¢ä¸€æ¬¡arr.lengthã€‚ç¬¬äºŒæ®µä»£ç å°±æ˜¯ç¼“å­˜äº†arr.lengthï¼Œæ¯æ¬¡å¯¹æ¯”lenå°±å¥½ï¼Œç†è®ºä¸Šæ˜¯ç¬¬äºŒæ®µä»£ç çš„å†™æ³•æ¯”è¾ƒå¥½ï¼Œæ€§èƒ½æ¯”è¾ƒé«˜ï¼ä½†æ˜¯éšç€æµè§ˆå™¨çš„å‘å±•ï¼Œè¿™ä¸ªç»†èŠ‚çš„æ€§èƒ½ä¸Šçš„å½±å“è²Œä¼¼è¿œè¿œå°äºŽé¢„æœŸï¼ŒçŽ°åœ¨è¿˜æ˜¯å»ºè®®ç¼“å­˜ï¼æˆ‘å†™äº†ä¸‹é¢çš„æµ‹è¯•ç”¨ä¾‹(è°·æ­Œæµè§ˆå™¨æµ‹è¯•)ï¼ å…ƒç´ äº‹ä»¶è¿™é‡Œæˆ‘ç”¨jqueryæ¥è®²è§£ï¼Œæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼ŒåŽŸç”Ÿjsä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼å¦‚ä¸‹ä»£ç  12345678$('.div1').click(function()&#123; ...&#125;)//--------------------------åˆ†å‰²çº¿ var $div1=$('.div1');$div1.click(function()&#123; ...&#125;) ä¸Šé¢çš„ä»£ç ï¼Œæ”¹å˜çš„ä¹Ÿæ˜¯ç¼“å­˜äº†$(â€˜.div1â€™)ï¼Œä½†æ˜¯è¿™é‡Œå°±å»ºè®®æ˜¯ç¬¬äºŒç§å†™æ³•äº†ï¼Œå› ä¸ºç¬¬ä¸€ç§ç‚¹å‡»ä¸€æ¬¡å°±è¦æŸ¥è¯¢ä¸€æ¬¡.div1ï¼ŒDomçš„æ“ä½œè¿˜æ˜¯èƒ½å‡å°‘å°±å‡å°‘ï¼ ä½¿ç”¨innerHTMLæ·»åŠ å…ƒç´ æ¯”å¦‚æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œå¾€ulé‡Œé¢æ·»åŠ 10ä¸ªliï¼Œä¸¤ç§æ–¹æ³•ï¼Œå¦‚ä¸‹ä»£ç  12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;ul id="ul-test"&gt; &lt;/ul&gt; &lt;/body&gt; &lt;script type="text/javascript"&gt; var oUl=document.getElementById("ul-test"); //createElementæ–¹å¼ console.time(); for(var i=0;i&lt;10;i++)&#123; var oLi=document.createElement('li'); oLi.innerHTML=i; oUl.appendChild(oLi); &#125; console.timeEnd(); //innerHTMLæ–¹å¼ console.time(); var _html=''; for(var i=0;i&lt;10;i++)&#123; _html+='&lt;li&gt;'+i+'&lt;/li&gt;' &#125; oUl.innerHTML=_html; console.timeEnd(); &lt;/script&gt;&lt;/html&gt; å¤§å®¶æŠŠä»£ç ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå‘çŽ°åŸºæœ¬æ˜¯ç¬¬äºŒç§æ–¹å¼æ›´å¿«ï¼Œç¬¬8ç‚¹ä¹Ÿè¯´äº†ï¼ŒDOMæ“ä½œèƒ½å°‘å°±å°‘ï¼ç¬¬ä¸€ç§è¦æ“ä½œ10æ¬¡DOMï¼Œç¬¬äºŒç§åªéœ€è¦æ“ä½œ1æ¬¡DOMã€‚è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯ï¼Œè¿™ä¸ªåªæ˜¯å¾ˆç®€å•çš„li,å¦‚æžœæ˜¯ä¸‹é¢çš„åˆ—è¡¨å‘¢ï¼Ÿç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œå¾—createElementå¤šå°‘æ¬¡ï¼ŒinnerHTMLå¤šå°‘æ¬¡ï¼ŒappendChildå¤šå°‘æ¬¡ï¼Ÿä»£ç å¤šï¼Œå„ä¸ªèŠ‚ç‚¹çš„é€»è¾‘å’ŒåµŒå¥—å…³ç³»ä¹Ÿä¹±ï¼ç”¨ç¬¬äºŒç§æ–¹å¼å°±æ˜¯ä¸€ä¸ªæ‹¼æŽ¥å­—ç¬¦ä¸²çš„æ“ä½œï¼Œæ¯”ç¬¬ä¸€ç§æ–¹å¼å¥½å¤šäº†ï¼Œå¦‚æžœç”¨es6çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå°±æ›´ç®€å•äº†ï¼ å°†å‚æ•°è½¬æˆæ•°ç»„å‡½æ•°é‡Œçš„argumentsï¼Œè™½ç„¶æ‹¥æœ‰lengthå±žæ€§ï¼Œä½†æ˜¯argumentsä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ˜¯ä¸€ä¸ªç±»æ•°ç»„ï¼Œæ²¡æœ‰push,sliceç­‰æ–¹æ³•ã€‚æœ‰äº›æ—¶å€™ï¼Œéœ€è¦æŠŠargumentsè½¬æˆæ•°ç»„ï¼Œè½¬çš„æ–¹æ³•ä¹Ÿä¸æ­¢ä¸€ä¸ªï¼ŒæŽ¨èçš„æ˜¯æ˜¯ä¸‹é¢çš„å†™æ³•ï¼ 1var _arguments=Array.prototype.slice.apply(arguments) å‡½æ•°èŠ‚æµè¿™é‡Œæ‹¿ä¸€ä¸ªæ —å­è¯´ï¼Œæ¯”å¦‚mousemove,onscroll,onresizeè¿™äº›äº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼Œå¯èƒ½å·²ç»è§¦å‘äº†60æ¬¡äº‹ä»¶ï¼Œè¿™æ ·å¾ˆæ¶ˆè€—æ€§èƒ½ï¼Œè€Œä¸”å®žé™…ä¸Šï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™ä¹ˆé¢‘ç¹çš„è§¦å‘ï¼Œåªè¦å¤§çº¦100æ¯«ç§’è§¦å‘ä¸€æ¬¡å°±å¥½ï¼é‚£ä¹ˆè¿™æ ·å°±éœ€è¦å‡½æ•°èŠ‚æµäº†ï¼123456789101112```*æ™®é€šå†™æ³•*```javascriptvar count = 0;function beginCount() &#123; count++; console.log(count);&#125;document.onmousemove = function () &#123; beginCount();&#125;; èŠ‚æµå†™æ³•1234567891011121314var count = 0;function beginCount() &#123; count++; console.log(count);&#125;function delayFn(method, thisArg) &#123; clearTimeout(method.props); method.props = setTimeout(function () &#123; method.call(thisArg) &#125;,100)&#125;document.onmousemove = function () &#123; delayFn(beginCount)&#125;; ç¬¬äºŒç§èŠ‚æµæ–¹æ³•12345678910111213141516171819202122232425262728293031function delayFn2 (fn, delay, mustDelay)&#123; var timer = null; var t_start; return function()&#123; var context = this, args = arguments, t_cur = +new Date(); //å…ˆæ¸…ç†ä¸Šä¸€æ¬¡çš„è°ƒç”¨è§¦å‘ï¼ˆä¸Šä¸€æ¬¡è°ƒç”¨è§¦å‘äº‹ä»¶ä¸æ‰§è¡Œï¼‰ clearTimeout(timer); //å¦‚æžœä¸å­˜è§¦å‘æ—¶é—´ï¼Œé‚£ä¹ˆå½“å‰çš„æ—¶é—´å°±æ˜¯è§¦å‘æ—¶é—´ if(!t_start)&#123; t_start = t_cur; &#125; //å¦‚æžœå½“å‰æ—¶é—´-è§¦å‘æ—¶é—´å¤§äºŽæœ€å¤§çš„é—´éš”æ—¶é—´ï¼ˆmustDelayï¼‰ï¼Œè§¦å‘ä¸€æ¬¡å‡½æ•°è¿è¡Œå‡½æ•° if(t_cur - t_start &gt;= mustDelay)&#123; fn.apply(context, args); t_start = t_cur; &#125; //å¦åˆ™å»¶è¿Ÿæ‰§è¡Œ else &#123; timer = setTimeout(function()&#123; fn.apply(context, args); &#125;, delay); &#125; &#125;;&#125;var count=0;function fn1()&#123; count++; console.log(count)&#125; //100mså†…è¿žç»­è§¦å‘çš„è°ƒç”¨ï¼ŒåŽä¸€ä¸ªè°ƒç”¨ä¼šæŠŠå‰ä¸€ä¸ªè°ƒç”¨çš„ç­‰å¾…å¤„ç†æŽ‰ï¼Œä½†æ¯éš”200msè‡³å°‘æ‰§è¡Œä¸€æ¬¡document.onmousemove=delayFn2(fn1,100,200) åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¿«åº”ç”¨å¿«é€Ÿå…¥é—¨]]></title>
    <url>%2F2018%2F03%2F22%2FQuickApp%2F%E5%BF%AB%E5%BA%94%E7%94%A8%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[QuickAppä½œä¸ºä¸€ä¸ªå‰ç«¯å·¥ç¨‹å¸ˆï¼Œæ¯•ç«Ÿè¦é¡ºæµæŠ€æœ¯çš„å‘å±•ã€‚ 3æœˆ20æ—¥ï¼Œå°ç±³ã€ä¸­å…´ã€åŽä¸ºã€é‡‘ç«‹ã€è”æƒ³ã€é­…æ—ã€åŠªæ¯”äºšã€OPPOã€vivoã€ä¸€åŠ ï¼Œå…±åå®¶æ‰‹æœºåŽ‚å•†åœ¨åŒ—äº¬è”åˆå¬å¼€å¿«åº”ç”¨æ ‡å‡†å¯åŠ¨å‘å¸ƒä¼šï¼Œæ‰‹æœºåŽ‚å•†ä¸Žä¸­å›½ä¿¡æ¯é€šä¿¡ç ”ç©¶é™¢ã€ç”µä¿¡ç»ˆç«¯äº§ä¸šåä¼šã€ä¸­å›½è½¯ä»¶è¡Œä¸šåä¼šåŠæ•°ç™¾å®¶çŸ¥åç§»åŠ¨äº’è”ç½‘åº”ç”¨ä¼ä¸šå…±è¥„ç››ä¸¾ï¼Œå…±åŒè§è¯ç§»åŠ¨åº”ç”¨æ–°ç”Ÿæ€çš„åˆ°æ¥ã€‚ æ—¢ç„¶æ˜¯å›½å†…åŽ‚å•†å‘å¸ƒçš„ï¼Œæ‰€ä»¥åªé’ˆå¯¹å®‰å“ç”¨æˆ·ã€‚ æ€Žä¹ˆæ„Ÿè§‰éƒ½æ˜¯åœ¨å¯¹å¾®ä¿¡å°ç¨‹åºä¸€å®¶ç‹¬å¤§çš„åº”å¯¹ã€‚ åºŸè¯å°‘è¯´å¼€æ’¸å§ã€‚ å¿«åº”ç”¨å¼€å‘è€…æ–‡æ¡£ https://doc.quickapp.cn/ çœ‹äº†è¿™ä¸ªå°±æ˜¯è¡¨ç¤ºå…¥é—¨äº† å¿«åº”ç”¨å¼€å‘è€…è®ºå› http://bbs.quickapp.cn/ æ­å»ºçŽ¯å¢ƒå®‰è£…nodejséœ€å®‰è£…6.0ä»¥ä¸Šç‰ˆæœ¬çš„nodejsï¼Œè¯·ä»ŽNodeJSå®˜ç½‘ä¸‹è½½ï¼ŒæŽ¨èv6.11.3 LTS æ³¨æ„: ä¸è¦ä½¿ç”¨8.0.*ç‰ˆæœ¬ï¼Žè¿™ä¸ªç‰ˆæœ¬å†…éƒ¨ZipStreamå®žçŽ°ä¸Žnode-archiveåŒ…ä¸å…¼å®¹ï¼Œä¼šå¼•èµ·æŠ¥é”™ å®‰è£…hap-toolkit (å¿«åº”ç”¨å‘½ä»¤)1npm install - g hap-toolkit åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œhap -Vä¼šè¾“å‡ºç‰ˆæœ¬ä¿¡æ¯è¡¨ç¤ºhap-toolkitå®‰è£…æˆåŠŸï¼Œå¦‚ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š1hap -V ç›®å‰ç‰ˆæœ¬æ˜¯0.0.26 åˆ›å»ºæ–°çš„é¡¹ç›®1hap init &lt;ProjectName&gt; æˆåŠŸåŽå³æ˜¾ç¤ºé¡¹ç›®ç›®å½•ç»“æž„12345678910111213â”œâ”€â”€ node_modules npm åŒ…â”œâ”€â”€ sign rpkåŒ…ç­¾åæ¨¡å—â”‚ â””â”€â”€ debug è°ƒè¯•çŽ¯å¢ƒâ”‚ â”œâ”€â”€ certificate.pem è¯ä¹¦æ–‡ä»¶â”‚ â””â”€â”€ private.pem ç§é’¥æ–‡ä»¶â”œâ”€â”€ src é¡¹ç›®èµ„æºæ–‡ä»¶å¤¹â”‚ â”œâ”€â”€ Common å…¬ç”¨çš„èµ„æºæ–‡ä»¶å’Œç»„ä»¶æ–‡ä»¶â”‚ â”‚ â””â”€â”€ logo.png manifest.jsonä¸­é…ç½®çš„iconâ”‚ â”œâ”€â”€ Demo é¡µé¢ç›®å½•â”‚ | â””â”€â”€ index.ux é¡µé¢æ–‡ä»¶ï¼Œæ–‡ä»¶åä¸å¿…ä¸Žçˆ¶æ–‡ä»¶å¤¹ç›¸åŒâ”‚ â”œâ”€â”€ app.ux APPæ–‡ä»¶ï¼ˆç”¨äºŽåŒ…æ‹¬å…¬ç”¨èµ„æºï¼‰â”‚ â””â”€â”€ manifest.json é¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆå¦‚ï¼šåº”ç”¨æè¿°ã€æŽ¥å£ç”³æ˜Žã€é¡µé¢è·¯ç”±ç­‰ï¼‰â””â”€â”€ package.json å®šä¹‰é¡¹ç›®éœ€è¦çš„å„ç§æ¨¡å—åŠé…ç½®ä¿¡æ¯ï¼Œnpm installæ ¹æ®è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œè‡ªåŠ¨ä¸‹è½½æ‰€éœ€çš„è¿è¡Œå’Œå¼€å‘çŽ¯å¢ƒ ç¼–è¯‘é¡¹ç›®1.åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…ä¾èµ–åŒ…ï¼ˆwebpackï¼Œbabelç­‰ï¼‰1npm install åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œç¼–è¯‘æ‰“åŒ…ï¼Œç”ŸæˆrpkåŒ…1npm run build ç¼–è¯‘æ‰“åŒ…æˆåŠŸåŽï¼Œé¡¹ç›®æ ¹ç›®å½•ä¸‹ä¼šç”Ÿæˆæ–‡ä»¶å¤¹ï¼šbuildã€dist buildï¼šä¸´æ—¶äº§å‡ºï¼ŒåŒ…å«ç¼–è¯‘åŽçš„é¡µé¢jsï¼Œå›¾ç‰‡ç­‰ distï¼šæœ€ç»ˆäº§å‡ºï¼ŒåŒ…å«rpkæ–‡ä»¶ã€‚å…¶å®žæ˜¯å°†buildç›®å½•ä¸‹çš„èµ„æºæ‰“åŒ…åŽ‹ç¼©ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼ŒåŽç¼€åä¸ºrpkï¼Œè¿™ä¸ªrpkæ–‡ä»¶å°±æ˜¯é¡¹ç›®ç¼–è¯‘åŽçš„æœ€ç»ˆäº§å‡º 3.è‡ªåŠ¨é‡æ–°ç¼–è¯‘1npm run watch æ³¨æ„ï¼šnpm run watchåŽè¿˜éœ€è¦å¦å¤–è¿è¡Œnpm run serveræ¥è¿è¡Œserveræ‰èƒ½å®žçŽ°çƒ­æ›´æ–° æ³¨æ„ï¼šå¦‚æžœæŠ¥é”™é‡åˆ°Cannot find module â€˜â€¦/webpack.config.jsâ€™ï¼Œè¯·é‡æ–°æ‰§è¡Œä¸€æ¬¡hap update â€“forceã€‚è¿™æ˜¯ç”±äºŽé«˜ç‰ˆæœ¬çš„npmåœ¨npm installæ—¶ï¼Œä¼šæ ¡éªŒå¹¶åˆ é™¤äº†node_modulesä¸‹éƒ¨åˆ†æ–‡ä»¶å¤¹ï¼Œå¯¼è‡´æŠ¥é”™ã€‚è€Œhap update â€“forceä¼šé‡æ–°å¤åˆ¶hap-toolkitæ–‡ä»¶å¤¹åˆ°node_modulesä¸­ è°ƒè¯•éœ€è¦å®‰è£…ä¸¤ä¸ªAPPåº”ç”¨ç¨‹åº(å¿…é¡»ï¼éœ€è¦åœ¨çœŸæœºä¸Šè°ƒè¯•é¢„è§ˆ) å¿«åº”ç”¨è°ƒè¯•å™¨å¹³å°é¢„è§ˆç‰ˆ äºŒç»´ç é¢„è§ˆåœ¨ç»ˆç«¯è¾“å…¥,å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨1npm run server è‡ªå®šä¹‰ç«¯å£ï¼ˆå¦‚ï¼š8080ï¼‰1npm run server -- --port 8080 åœ¨è°ƒè¯•å™¨APPé€‰æ‹©æ‰«æäºŒç»´ç ï¼› å¦‚æžœæç¤ºå®‰è£…å¤±è´¥ï¼Œå»ºè®®é‡æ–°èµ·ä¸€énpm run server é‡æ–°æ¥è¿‡ã€‚ æœ¬åœ°å®‰è£…é€‰æ‹©distç›®å½•ä¸‹çš„.rpkæ–‡ä»¶ä¼ è¾“åˆ°æ‰‹æœº åœ¨è°ƒè¯•å™¨ä¸­é€‰æ‹©æ‰‹åŠ¨å®‰è£…æ‰¾åˆ°ä½ çš„.rpkå³å¯å®‰è£…å‡ºçŽ°äº†è¿™ä¸ªï¼Œä»£è¡¨ä½ å®‰è£…æˆåŠŸï¼Œè¿™å°±æ˜¯Demoæ•ˆæžœ åº”ç”¨ä¸Šä¼ æµç¨‹ http://bbs.quickapp.cn/posts/detail?id=249 è´¦å·æ³¨å†Œæµç¨‹ http://bbs.quickapp.cn/posts/detail?id=248]]></content>
      <categories>
        <category>quickApp</category>
      </categories>
      <tags>
        <tag>quickApp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŠ©ä½ ç†è§£Reacté«˜é˜¶ç»„ä»¶]]></title>
    <url>%2F2018%2F03%2F21%2FReact%2F%E5%8A%A9%E4%BD%A0%E7%90%86%E8%A7%A3React%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[é«˜é˜¶ç»„ä»¶é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯reactä¸­å¯¹ç»„ä»¶é€»è¾‘è¿›è¡Œé‡ç”¨çš„é«˜çº§æŠ€æœ¯ã€‚ä½†é«˜é˜¶ç»„ä»¶æœ¬èº«å¹¶ä¸æ˜¯React APIã€‚å®ƒåªæ˜¯ä¸€ç§æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯ç”±reactè‡ªèº«çš„ç»„åˆæ€§è´¨å¿…ç„¶äº§ç”Ÿçš„ã€‚ å…·ä½“è€Œè¨€ï¼Œé«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¯¥å‡½æ•°æŽ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›žä¸€ä¸ªæ–°çš„ç»„ä»¶ é«˜é˜¶ç»„ä»¶åœ¨Reactç¬¬ä¸‰æ–¹åº“ä¸­å¾ˆå¸¸è§ï¼Œæ¯”å¦‚Reduxçš„connectæ–¹æ³•å’ŒRelayçš„createContainer. ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰è§£å†³äº¤å‰é—®é¢˜ä¸è¦æ”¹å˜åŽŸå§‹ç»„ä»¶ï¼Œä½¿ç”¨ç»„åˆçº¦å®šï¼šå°†ä¸ç›¸å…³çš„propså±žæ€§ä¼ é€’ç»™åŒ…è£¹ç»„ä»¶çº¦å®šï¼šæœ€å¤§åŒ–ä½¿ç”¨ç»„åˆçº¦å®šï¼šåŒ…è£…æ˜¾ç¤ºåå­—ä»¥ä¾¿äºŽè°ƒè¯• å‡½æ•°æ¨¡æ‹Ÿé«˜é˜¶ç»„ä»¶æˆ‘ä»¬é€šè¿‡æ™®é€šå‡½æ•°æ¥ç†è§£ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶å“¦~ 1.æœ€æ™®é€šçš„æ–¹æ³•ï¼Œä¸€ä¸ªwelcomeï¼Œä¸€ä¸ªgoodbyeã€‚ä¸¤ä¸ªå‡½æ•°å…ˆä»ŽlocalStorageè¯»å–äº†usernameï¼Œç„¶åŽå¯¹usernameåšäº†ä¸€äº›å¤„ç†ã€‚1234567891011function welcome()&#123; let username = localStorage.getItem('username'); console.log('welcome ' + username);&#125;function goodbey() &#123;let username = localStorage.getItem('username');console.log('goodbey ' + username);&#125;welcome();goodbey(); 2.æˆ‘ä»¬å‘çŽ°ä¸¤ä¸ªå‡½æ•°æœ‰ä¸€å¥ä»£ç æ˜¯ä¸€æ ·çš„ï¼Œè¿™å«å†—ä½™å”‰ã€‚ä¸å¥½ä¸å¥½~ï¼ˆä½ å¯ä»¥æŠŠé‚£ä¸€å¥ä»£ç ç†è§£æˆå¹³æ—¶çš„ä¸€å¤§å †ä»£ç ï¼‰ æˆ‘ä»¬è¦å†™ä¸€ä¸ªä¸­é—´å‡½æ•°ï¼Œè¯»å–username,ä»–æ¥è´Ÿè´£æŠŠusernameä¼ é€’ç»™ä¸¤ä¸ªå‡½æ•°ã€‚123456789101112131415161718192021function welcome(username) &#123; console.log('welcome ' + username);&#125;function goodbey(username) &#123; console.log('goodbey ' + username);&#125;function wrapWithUsername(wrappedFunc) &#123; let newFunc = () =&gt; &#123; let username = localStorage.getItem('username'); wrappedFunc(username); &#125;; return newFunc;&#125;welcome = wrapWithUsername(welcome);goodbey = wrapWithUsername(goodbey);welcome();goodbey(); å¥½äº†ï¼Œæˆ‘ä»¬é‡Œé¢çš„wrapWithUsernameå‡½æ•°å°±æ˜¯ä¸€ä¸ªâ€œé«˜é˜¶å‡½æ•°â€ã€‚ä»–åšäº†ä»€ä¹ˆï¼Ÿä»–å¸®æˆ‘ä»¬å¤„ç†äº†usernameï¼Œä¼ é€’ç»™ç›®æ ‡å‡½æ•°ã€‚æˆ‘ä»¬è°ƒç”¨æœ€ç»ˆçš„å‡½æ•°welcomeçš„æ—¶å€™ï¼Œæ ¹æœ¬ä¸ç”¨å…³å¿ƒusernameæ˜¯æ€Žä¹ˆæ¥çš„ã€‚æˆ‘ä»¬å¢žåŠ ä¸ªç”¨æˆ·studyå‡½æ•°ã€‚ 123456 function study(username)&#123; console.log('study' + username); &#125; study = wrapWithUsername(study);study(); è¿™é‡Œä½ æ˜¯ä¸æ˜¯ç†è§£äº†ä¸ºä»€ä¹ˆè¯´wrapWithUsernameæ˜¯é«˜é˜¶å‡½æ•°ï¼Ÿæˆ‘ä»¬åªéœ€è¦çŸ¥é“ï¼Œç”¨wrapWithUsernameåŒ…è£…æˆ‘ä»¬çš„studyå‡½æ•°åŽï¼Œstudyå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯usernameã€‚ æˆ‘ä»¬å†™å¹³æ—¶å†™ä»£ç çš„æ—¶å€™ï¼Œä¸ç”¨å…³å¿ƒwrapWithUsernameå†…éƒ¨æ˜¯å¦‚ä½•å®žçŽ°çš„ã€‚ é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„çº¯å‡½æ•°ã€‚æˆ‘ä»¬æŠŠä¸Šä¸€èŠ‚çš„å‡½æ•°ç»Ÿç»Ÿæ”¹æˆreactç»„ä»¶ã€‚ æœ€æ™®é€šçš„ç»„ä»¶å“¦ã€‚welcomeå‡½æ•°è½¬ä¸ºreactç»„ä»¶ã€‚12345678910111213141516171819202122232425import React, &#123;Component&#125; from 'react'class Welcome extends Component &#123; constructor(props) &#123; super(props); this.state = &#123; username: '' &#125; &#125; componentWillMount() &#123; let username = localStorage.getItem('username'); this.setState(&#123; username: username &#125;) &#125; render() &#123; return ( &lt;div&gt;welcome &#123;this.state.username&#125;&lt;/div&gt; ) &#125;&#125;export default Welcome; 2.goodbeyå‡½æ•°è½¬ä¸ºreactç»„ä»¶ã€‚12345678910111213141516171819202122232425import React, &#123;Component&#125; from 'react'class Goodbye extends Component &#123; constructor(props) &#123; super(props); this.state = &#123; username: '' &#125; &#125; componentWillMount() &#123; let username = localStorage.getItem('username'); this.setState(&#123; username: username &#125;) &#125; render() &#123; return ( &lt;div&gt;goodbye &#123;this.state.username&#125;&lt;/div&gt; ) &#125;&#125;export default Goodbye; 3.çŽ°åœ¨ä½ æ˜¯ä¸æ˜¯æ›´èƒ½çœ‹åˆ°é—®é¢˜æ‰€åœ¨äº†ï¼Ÿä¸¤ä¸ªç»„ä»¶å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯é‡å¤çš„å”‰ã€‚æŒ‰ç…§ä¸Šä¸€èŠ‚wrapWithUsernameå‡½æ•°çš„æ€è·¯ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸ªé«˜é˜¶ç»„ä»¶(é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¯¥å‡½æ•°æŽ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›žä¸€ä¸ªæ–°çš„ç»„ä»¶)ã€‚12345678910111213141516171819202122232425import React, &#123;Component&#125; from 'react'export default (WrappedComponent) =&gt; &#123; class NewComponent extends Component &#123; constructor() &#123; super(); this.state = &#123; username: '' &#125; &#125; componentWillMount() &#123; let username = localStorage.getItem('username'); this.setState(&#123; username: username &#125;) &#125; render() &#123; return &lt;WrappedComponent username=&#123;this.state.username&#125;/&gt; &#125; &#125; return NewComponent&#125; è¿™æ ·æˆ‘ä»¬å°±èƒ½ç®€åŒ–Welcomeç»„ä»¶å’ŒGoodbyeç»„ä»¶ã€‚123456789101112131415161718192021222324252627282930313233//welcomeimport React, &#123;Component&#125; from 'react';import wrapWithUsername from 'wrapWithUsername';class Welcome extends Component &#123; render() &#123; return ( &lt;div&gt;welcome &#123;this.props.username&#125;&lt;/div&gt; ) &#125;&#125;Welcome = wrapWithUsername(Welcome);export default Welcome;//goodbyeimport React, &#123;Component&#125; from 'react';import wrapWithUsername from 'wrapWithUsername';class Goodbye extends Component &#123; render() &#123; return ( &lt;div&gt;goodbye &#123;this.props.username&#125;&lt;/div&gt; ) &#125;&#125;Goodbye = wrapWithUsername(Goodbye);export default Goodbye; çœ‹åˆ°æ²¡æœ‰ï¼Œé«˜é˜¶ç»„ä»¶å°±æ˜¯æŠŠusernameé€šè¿‡propsä¼ é€’ç»™ç›®æ ‡ç»„ä»¶äº†ã€‚ç›®æ ‡ç»„ä»¶åªç®¡ä»Žpropsé‡Œé¢æ‹¿æ¥ç”¨å°±å¥½äº†ã€‚ åˆ°è¿™é‡Œä½ç½®ï¼Œé«˜é˜¶ç»„ä»¶å°±è®²å®Œäº†ã€‚ä½ å†è¿”å›žåŽ»ç†è§£ä¸‹å®šä¹‰ï¼Œæ˜¯ä¸æ˜¯è±ç„¶å¼€æœ— ä½ çŽ°åœ¨ç†è§£react-reduxçš„connectå‡½æ•°~æŠŠreduxçš„stateå’Œactionåˆ›å»ºå‡½æ•°ï¼Œé€šè¿‡propsæ³¨å…¥ç»™äº†Componentã€‚ä½ åœ¨ç›®æ ‡ç»„ä»¶Componenté‡Œé¢å¯ä»¥ç›´æŽ¥ç”¨this.propsåŽ»è°ƒç”¨redux stateå’Œactionåˆ›å»ºå‡½æ•°äº†ã€‚ 1ConnectedComment = connect(mapStateToProps, mapDispatchToProps)(Component); ç›¸å½“äºŽè¿™æ · 12345// connectæ˜¯ä¸€ä¸ªè¿”å›žå‡½æ•°çš„å‡½æ•°ï¼ˆå°±æ˜¯ä¸ªé«˜é˜¶å‡½æ•°ï¼‰const enhance = connect(mapStateToProps, mapDispatchToProps);// è¿”å›žçš„å‡½æ•°å°±æ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œè¯¥é«˜é˜¶ç»„ä»¶è¿”å›žä¸€ä¸ªä¸ŽRedux store// å…³è”èµ·æ¥çš„æ–°ç»„ä»¶const ConnectedComment = enhance(Component); antdçš„Formä¹Ÿæ˜¯ä¸€æ ·çš„ const WrappedNormalLoginForm = Form.create()(NormalLoginForm); æ³¨æ„äº‹é¡¹ä¸è¦å†renderå‡½æ•°ä¸­ä½¿ç”¨é«˜é˜¶ç»„ä»¶Reactä½¿ç”¨çš„å·®å¼‚ç®—æ³•ï¼ˆç§°ä¸ºåè°ƒï¼‰ä½¿ç”¨ç»„ä»¶æ ‡è¯†ç¡®å®šæ˜¯å¦æ›´æ–°çŽ°æœ‰çš„å­å¯¹è±¡æ ‘æˆ–ä¸¢æŽ‰çŽ°æœ‰çš„å­æ ‘å¹¶é‡æ–°æŒ‚è½½ã€‚å¦‚æžœrenderå‡½æ•°è¿”å›žçš„ç»„ä»¶å’Œä¹‹å‰renderå‡½æ•°è¿”å›žçš„ç»„ä»¶æ˜¯ç›¸åŒçš„ï¼ŒReactå°±é€’å½’çš„æ¯”è¾ƒæ–°å­å¯¹è±¡æ ‘å’Œæ—§å­å¯¹è±¡æ ‘çš„å·®å¼‚ï¼Œå¹¶æ›´æ–°æ—§å­å¯¹è±¡æ ‘ã€‚å¦‚æžœä»–ä»¬ä¸ç›¸ç­‰ï¼Œå°±ä¼šå®Œå…¨å¸è½½æŽ‰æ—§çš„ä¹‹å¯¹è±¡æ ‘ã€‚ å¿…é¡»å°†é™æ€æ–¹æ³•åšæ‹·è´æœ‰æ—¶ï¼Œç»™ç»„ä»¶å®šä¹‰é™æ€æ–¹æ³•æ˜¯ååˆ†æœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼ŒRelayçš„å®¹å™¨å°±å¼€æ”¾äº†ä¸€ä¸ªé™æ€æ–¹æ³• getFragmentä¾¿äºŽç»„åˆGraphQLçš„ä»£ç ç‰‡æ®µã€‚ Refså±žæ€§ä¸èƒ½ä¼ é€’ä¸€èˆ¬æ¥è¯´ï¼Œé«˜é˜¶ç»„ä»¶å¯ä»¥ä¼ é€’æ‰€æœ‰çš„propså±žæ€§ç»™åŒ…è£¹çš„ç»„ä»¶ï¼Œä½†æ˜¯ä¸èƒ½ä¼ é€’refså¼•ç”¨ã€‚å› ä¸ºå¹¶ä¸æ˜¯åƒkeyä¸€æ ·ï¼Œrefsæ˜¯ä¸€ä¸ªä¼ªå±žæ€§ï¼ŒReactå¯¹å®ƒè¿›è¡Œäº†ç‰¹æ®Šå¤„ç†ã€‚å¦‚æžœä½ å‘ä¸€ä¸ªç”±é«˜é˜¶ç»„ä»¶åˆ›å»ºçš„ç»„ä»¶çš„å…ƒç´ æ·»åŠ refåº”ç”¨ï¼Œé‚£ä¹ˆrefæŒ‡å‘çš„æ˜¯æœ€å¤–å±‚å®¹å™¨ç»„ä»¶å®žä¾‹çš„ï¼Œè€Œä¸æ˜¯åŒ…è£¹ç»„ä»¶ã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯æ·±æµ·]]></title>
    <url>%2F2018%2F03%2F20%2FRecord%2F%E5%89%8D%E7%AB%AF%E6%B7%B1%E6%B5%B7%2F</url>
    <content type="text"><![CDATA[å‰ç«¯å·¥ç¨‹å¸ˆæ‰€éœ€çŸ¥è¯†]]></content>
      <tags>
        <tag>Record</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Reactçš„Diffç®—æ³•]]></title>
    <url>%2F2018%2F03%2F20%2FReact%2FReact%E7%9A%84Diff%E7%AE%97%E6%B3%95%2F</url>
    <content type="text"><![CDATA[React æ˜¯ Facebook å¼€å‘çš„æž„å»ºç”¨æˆ·ç•Œé¢çš„ç±»åº“.å®ƒä»Žè®¾è®¡ä¹‹åˆå°±å°†æ€§èƒ½ä½œä¸ºé‡ç‚¹.è¿™ç¯‡æ–‡ç« æˆ‘å±•ç¤º diff ç®—æ³•å’Œæ¸²æŸ“è¿‡ç¨‹æ€Žæ ·å·¥ä½œ, ä½ å¯ä»¥å€Ÿé‰´ä¼˜åŒ–è‡ªå·±çš„åº”ç”¨. Diff ç®—æ³•åœ¨æ·±å…¥å®žçŽ°çš„ç»†èŠ‚ä¹‹å‰, éœ€è¦äº†è§£ä¸€ä¸‹ React æ€Žæ ·å·¥ä½œçš„. 123456789class MyComponent extends React.Component&#123; render() &#123; if (this.props.first) &#123; return &lt;div className="first"&gt;&lt;span&gt;A Span&lt;/span&gt;&lt;/div&gt;; &#125; else &#123; return &lt;div className="second"&gt;&lt;p&gt;A Paragraph&lt;/p&gt;&lt;/div&gt;; &#125; &#125;&#125; ä»»ä½•æ—¶é—´, ä½ æè¿°çš„æ˜¯ä½ çš„ UI çœ‹èµ·æ¥æ˜¯ä»€ä¹ˆæ ·å­.éœ€è¦ç‰¹åˆ«æ³¨æ„, render æ‰§è¡Œçš„ç»“æžœå¾—åˆ°çš„ä¸æ˜¯çœŸæ­£çš„ DOM èŠ‚ç‚¹.ç»“æžœä»…ä»…æ˜¯è½»é‡çº§çš„ JavaScript å¯¹è±¡, æˆ‘ä»¬ç§°ä¹‹ä¸º virtual DOM. React è¦ä»Žè¿™ä¸ªè¡¨çŽ°å½¢å¼å½“ä¸­å°è¯•æ‰¾åˆ°å‰ä¸€ä¸ªæ¸²æŸ“ç»“æžœåˆ°åŽä¸€ä¸ªçš„æœ€å°æ­¥æ•°.æ¯”å¦‚, å½“æˆ‘ä»¬æŒ‚è½½äº† , ç„¶åŽç”¨ æ›¿æ¢, ç„¶åŽåˆå–æ¶ˆæŒ‚è½½,è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹çš„ DOM çš„æŒ‡ä»¤æ˜¯è¿™æ ·çš„: ä»Žæ²¡æœ‰åˆ°ç¬¬ä¸€æ­¥åˆ›å»ºèŠ‚ç‚¹: A Span ç¬¬ä¸€æ­¥åˆ°ç¬¬äºŒæ­¥æ›¿æ¢å±žæ€§: className=â€firstâ€ åˆ° className=â€secondâ€æ›¿æ¢èŠ‚ç‚¹: A Span åˆ° A Paragraph ç¬¬äºŒæ­¥åˆ°æ²¡æœ‰åˆ é™¤èŠ‚ç‚¹: A Paragraph æŒ‰ç…§å±‚çº§æ‰¾åˆ°ä¸¤æ£µä»»æ„çš„æ ‘ä¹‹é—´æœ€å°çš„ä¿®æ”¹æ˜¯ä¸€ä¸ªå¤æ‚åº¦ä¸º O(n^3) çš„é—®é¢˜.ä½ å¯ä»¥æƒ³è±¡, æˆ‘ä»¬çš„ä¾‹å­é‡Œè¿™ä¸æ˜¯å®¹æ˜“å¤„ç†çš„.React ç”¨äº†ä¸€ç§ç®€å•ä½†æ˜¯å¼ºå¤§çš„æŠ€å·§, è¾¾åˆ°äº†æŽ¥è¿‘ O(n) çš„å¤æ‚åº¦. React ä»…ä»…æ˜¯å°è¯•æŠŠæ ‘æŒ‰ç…§å±‚çº§åˆ†è§£. è¿™å½»åº•ç®€åŒ–äº†å¤æ‚åº¦,è€Œä¸”ä¹Ÿä¸ä¼šå¤±åŽ»å¾ˆå¤š, å› ä¸º Web åº”ç”¨å¾ˆå°‘æœ‰ component ç§»åŠ¨åˆ°æ ‘çš„å¦ä¸€ä¸ªå±‚çº§åŽ».å®ƒä»¬å¤§éƒ¨åˆ†åªæ˜¯åœ¨ç›¸é‚»çš„å­èŠ‚ç‚¹ä¹‹é—´ç§»åŠ¨. åˆ—è¡¨å‡è®¾æˆ‘ä»¬æœ‰ä¸ª component, ä¸€ä¸ªå¾ªçŽ¯æ¸²æŸ“äº† 5 ä¸ª component,éšåŽåˆåœ¨åˆ—è¡¨ä¸­é—´æ’å…¥ä¸€ä¸ªæ–°çš„ component.åªçŸ¥é“è¿™äº›ä¿¡æ¯, è¦å¼„æ¸…ä¸¤ä¸ª component çš„åˆ—è¡¨æ€Žä¹ˆå¯¹åº”å¾ˆéš¾. é»˜è®¤æƒ…å†µä¸‹, React ä¼šå°†å‰ä¸€ä¸ªåˆ—è¡¨ç¬¬ä¸€ä¸ª component å’ŒåŽä¸€ä¸ªç¬¬ä¸€ä¸ªå…³è”èµ·æ¥, åŽé¢ä¹Ÿæ˜¯.ä½ å¯ä»¥å†™ä¸€ä¸ª key å±žæ€§å¸®åŠ© React æ¥å¤„ç†å®ƒä»¬ä¹‹é—´çš„å¯¹åº”å…³ç³».å®žé™…ä¸­, åœ¨å­å…ƒç´ ä¸­æ‰¾åˆ°å”¯ä¸€çš„ key é€šå¸¸å¾ˆå®¹æ˜“. ComponentsReact app é€šå¸¸ç”±ç”¨æˆ·å®šä¹‰çš„ component ç»„åˆè€Œæˆ,é€šå¸¸ç»“æžœæ˜¯ä¸€ä¸ªä¸»è¦æ˜¯å¾ˆå¤š div ç»„æˆçš„æ ‘.è¿™ä¸ªä¿¡æ¯ä¹Ÿè¢« React çš„ diff ç®—æ³•è€ƒè™‘è¿›åŽ», React åªä¼šåŒ¹é…ç›¸åŒ class çš„ component. æ¯”å¦‚, å¦‚æžœæœ‰ä¸ª è¢« æ›¿æ¢æŽ‰äº†,React ä¼šåˆ é™¤æŽ‰ header å†åˆ›å»ºä¸€ä¸ª example block.æˆ‘ä»¬ä¸éœ€è¦åŒ–å®è´µçš„æ—¶é—´åŽ»åŒ¹é…ä¸¤ä¸ªä¸å¤§å¯èƒ½æœ‰ç›¸ä¼¼ä¹‹å¤„çš„ component. äº‹ä»¶ä»£ç†å¾€ DOM èŠ‚ç‚¹ä¸Šç»‘äº‹ä»¶æ…¢å¾—äººå¿ƒç¢Žå•Š, è€Œä¸”å¾ˆè´¹å†…å­˜. ä½œä¸ºæ›¿ä»£, React éƒ¨ç½²äº†ç§æµè¡ŒæŠ€æœ¯, å«åšâ€äº‹ä»¶ä»£ç†â€œ.React èµ°å¾—æ›´è¿œ, é‡æ–°å®žçŽ°äº†ä¸€éç¬¦åˆ W3C è§„èŒƒçš„äº‹ä»¶ç³»ç»Ÿ.æ„å‘³ç€ IE8 äº‹ä»¶å¤„ç†çš„ bug æˆä¸ºè¿‡åŽ»äº†, æ‰€æœ‰äº‹ä»¶åç§°è·¨æµè§ˆå™¨ä¿æŒä¸€è‡´. è¿™é‡Œè§£é‡Šä¸€ä¸‹æ€Žä¹ˆå®žçŽ°çš„. äº‹ä»¶ listener è¢«ç»‘å®šåˆ°æ•´ä¸ªæ–‡æ¡£çš„æ ¹èŠ‚ç‚¹ä¸Š.å½“äº‹ä»¶è¢«è§¦å‘, æµè§ˆå™¨ä¼šç»™å‡ºä¸€ä¸ªè§¦å‘çš„ç›®æ ‡çš„ DOM èŠ‚ç‚¹.ä¸ºäº†åœ¨ DOM çš„å±‚çº§ä¼ æ’­äº‹ä»¶, React ä¸ä¼šè¿­ä»£ virtual DOM çš„å±‚çº§.è€Œæ˜¯, æˆ‘ä»¬ä¾é æ¯ä¸ª React component å„è‡ªç‹¬ç«‹çš„ id æ¥ç¼–ç è¿™ä¸ªå±‚çº§.æˆ‘ä»¬èƒ½é€šè¿‡ç®€å•çš„å­—ç¬¦ä¸²æ“ä½œæ¥èŽ·å–æ‰€æœ‰çˆ¶çº§ component çš„çˆ¶çº§å†…å®¹.æŠŠäº‹ä»¶ listener å­˜å‚¨åœ¨ hash map å½“ä¸­, æˆ‘ä»¬å‘çŽ°æ€§èƒ½æ¯”æ”¾åˆ° virtual DOM è¿˜è¦å¥½. è¿™ä¸ªä¾‹å­å±•ç¤ºäº†, å½“ä¸€ä¸ªäº‹ä»¶å¹¿æ’­åˆ°æ•´ä¸ª virtual DOM æ—¶å‘ç”Ÿä»€ä¹ˆ.1234567// dispatchEvent('click', 'a.b.c', event)clickCaptureListeners['a'](event);clickCaptureListeners['a.b'](event);clickCaptureListeners['a.b.c'](event);clickBubbleListeners['a.b.c'](event);clickBubbleListeners['a.b'](event);clickBubbleListeners['a'](event); æµè§ˆå™¨ä¸ºæ¯ä¸ªäº‹ä»¶å’Œæ¯ä¸ª listener åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶å¯¹è±¡.è¿™ä¸ªäº‹ä»¶å¯¹è±¡çš„å±žæ€§å¾ˆä¸é”™, ä½ èƒ½èŽ·å–åˆ°äº‹ä»¶çš„å¼•ç”¨, ç”šè‡³ä¿®æ”¹æŽ‰.ç„¶è€Œè¿™ä¹Ÿæ„å‘³ç€é«˜é¢çš„å†…å­˜åˆ†é….React åœ¨å¯åŠ¨æ—¶å°±ä¸ºé‚£äº›å¯¹è±¡åˆ†é…äº†ä¸€ä¸ªå†…å­˜æ± .ä»»ä½•æ—¶å€™éœ€è¦ç”¨åˆ°äº‹ä»¶å¯¹è±¡, å°±å¯ä»¥ä»Žè¿™ä¸ªå†…å­˜æ± è¿›è¡Œå¤ç”¨.è¿™ä¸€ç‚¹éžå¸¸æ˜¾è‘—åœ°å‡è½»äº†åžƒåœ¾å›žæ”¶çš„è´Ÿæ‹…. æ¸²æŸ“åˆå¹¶æ“ä½œä½ è°ƒç”¨ component çš„ setState æ–¹æ³•çš„æ—¶å€™, React å°†å…¶æ ‡è®°ä¸º dirty.åˆ°æ¯ä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯ç»“æŸ, React æ£€æŸ¥æ‰€æœ‰æ ‡è®° dirty çš„ component é‡æ–°ç»˜åˆ¶. è¿™é‡Œçš„â€åˆå¹¶æ“ä½œâ€æ˜¯è¯´, åœ¨ä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯å½“ä¸­, DOM åªä¼šè¢«æ›´æ–°ä¸€æ¬¡.è¿™ä¸ªç‰¹æ€§æ˜¯æž„å»ºé«˜æ€§èƒ½åº”ç”¨çš„å…³é”®, è€Œä¸”ç”¨é€šå¸¸çš„ JavaScript ä»£ç éš¾ä»¥å®žçŽ°.è€Œåœ¨ React åº”ç”¨é‡Œ, ä½ é»˜è®¤å°±èƒ½å®žçŽ°. å­æ ‘æ¸²æŸ“æ“ä½œè°ƒç”¨ setState æ–¹æ³•æ—¶, component ä¼šé‡æ–°æž„å»ºåŒ…æ‹¬å­èŠ‚ç‚¹çš„ virtual DOM.å¦‚æžœä½ åœ¨æ ¹èŠ‚ç‚¹è°ƒç”¨ setState, æ•´ä¸ª React çš„åº”ç”¨éƒ½ä¼šè¢«é‡æ–°æ¸²æŸ“. æ‰€æœ‰çš„ component, å³ä¾¿æ²¡æœ‰æ›´æ–°, éƒ½ä¼šè°ƒç”¨ä»–ä»¬çš„ render æ–¹æ³•.è¿™ä¸ªå¬èµ·æ¥å¯æ€•, æ€§èƒ½åƒæ˜¯å¾ˆä½Ž, ä½†å®žé™…ä¸Šæˆ‘ä»¬ä¸ä¼šè§¦ç¢°çœŸå®žçš„ DOM, è¿è¡Œèµ·æ¥æ²¡é‚£æ ·çš„é—®é¢˜. é¦–å…ˆ, æˆ‘ä»¬è®¨è®ºçš„æ˜¯å±•ç¤ºç”¨æˆ·ç•Œé¢. å› ä¸ºå±å¹•ç©ºé—´æœ‰é™, é€šå¸¸ä½ éœ€è¦ä¸€æ¬¡æ¸²æŸ“æˆç™¾ä¸Šåƒæ¡æŒ‡ä»¤.JavaScript å¯¹äºŽèƒ½å¤„ç†çš„æ•´ä¸ªç•Œé¢, åœ¨ä¸šåŠ¡é€»è¾‘ä¸Šå·²ç»è¶³å¤Ÿå¿«äº†. å¦ä¸€ç‚¹, åœ¨å†™ React ä»£ç æ—¶, æ¯å½“æœ‰æ•°æ®æ›´æ–°, ä½ ä¸æ˜¯éƒ½è°ƒç”¨æ ¹èŠ‚ç‚¹çš„ setState.ä½ ä¼šåœ¨éœ€è¦æŽ¥æ”¶å¯¹åº”æ›´æ–°çš„ component ä¸Šè°ƒç”¨, æˆ–è€…åœ¨ä¸Šé¢çš„å‡ ä¸ª component.ä½ å¾ˆå°‘è¦ä¸€ç›´åˆ°æ ¹èŠ‚ç‚¹ä¸Š. å°±æ˜¯è¯´ç•Œé¢æ›´æ–°åªå‡ºçŽ°åœ¨ç”¨æˆ·äº§ç”Ÿäº¤äº’çš„å±€éƒ¨. é€‰æ‹©æ€§å­æ ‘æ¸²æŸ“æœ€åŽ, ä½ è¿˜æœ‰å¯èƒ½åŽ»æŽ‰ä¸€äº›å­æ ‘çš„é‡æ–°æ¸²æŸ“.å¦‚æžœä½ åœ¨ component ä¸Šå®žçŽ°ä»¥ä¸‹æ–¹æ³•çš„è¯: 1boolean shouldComponentUpdate(object nextProps, object nextState) æ ¹æ® component çš„å‰ä¸€ä¸ªå’Œä¸‹ä¸€ä¸ª props/state,ä½ å¯ä»¥å‘Šè¯‰ React è¿™ä¸ª component æ²¡æœ‰æ›´æ–°, ä¹Ÿä¸éœ€è¦é‡æ–°ç»˜åˆ¶.å®žçŽ°å¾—å¥½çš„è¯, å¯ä»¥å¸¦æ¥å·¨å¤§çš„æ€§èƒ½æå‡. è¦ç”¨è¿™ä¸ªæ–¹æ³•, ä½ è¦èƒ½å¤Ÿå¯¹ JavaScript Object è¿›è¡Œæ¯”å¯¹.è¿™ä»¶æœ‰å¾ˆå¤šç»†èŠ‚çš„å› ç´ , æ¯”å¦‚å¯¹æ¯”åº”è¯¥æ˜¯æ·±åº¦çš„è¿˜æ˜¯æµ…å±‚çš„,å¦‚æžœè¦æ·±çš„, æˆ‘ä»¬æ˜¯ç”¨ä¸å¯å˜æ•°æ®ç»“æž„, è¿˜æ˜¯è¿›è¡Œæ·±åº¦æ‹·è´â€¦ è€Œä¸”ä½ è¦æ³¨æ„, è¿™ä¸ªå‡½æ•°æ¯æ¬¡éƒ½ä¼šè¢«è°ƒç”¨, æ‰€ä»¥ä½ è¦ç¡®ä¿è¿è¡Œèµ·æ¥èŠ±çš„æ—¶é—´æ›´å°‘,æ¯” React çš„åšæ³•æ—¶é—´å°‘, è¿˜æœ‰æ¯”è®¡ç®— component éœ€è¦çš„æ—¶é—´å°‘,å³ä¾¿é‡æ–°ç»˜åˆ¶å¹¶ä¸æ˜¯å¿…è¦çš„. ç»“è®ºå¸®åŠ© React å˜å¿«çš„æŠ€æœ¯å¹¶ä¸æ–°é¢–. é•¿ä¹…ä»¥æ¥, æˆ‘ä»¬åˆ°çŸ¥é“è§¦ç¢° DOM æ˜¯è´¹æ—¶çš„,ä½ åº”è¯¥åˆå¹¶å¤„ç†è¯»å’Œå†™çš„æ“ä½œ, äº‹ä»¶ä»£ç†ä¼šæ›´å¿«â€¦ äººä»¬è¿˜æ˜¯ä¼šç»å¸¸è®¨è®ºä»–ä»¬, å› ä¸ºåœ¨å®žé™…å½“ä¸­ç”¨ JavaScript è¿›è¡Œå®žçŽ°å¾ˆæ˜¯æŒºéš¾çš„.React çªå‡ºçš„ä¸€ä¸ªåŽŸå› æ˜¯è¿™äº›ä¼˜åŒ–é»˜è®¤å°±å¯åŠ¨äº†.è¿™å°±è®©ä½ é¿å…æŽ‰ä¸å°å¿ƒæŠŠ app å†™å¾—å¾ˆæ…¢. React æ¶ˆè€—æ€§èƒ½çš„æ¨¡åž‹å¾ˆç®€å•, å¾ˆå¥½ç†è§£: æ¯æ¬¡è°ƒç”¨ setState ä¼šé‡æ–°è®¡ç®—æ•´ä¸ªå­æ ‘.å¦‚æžœä½ æƒ³è¦æé«˜æ€§èƒ½, å°½é‡å°‘è°ƒç”¨ setState,è¿˜æœ‰ç”¨ shouldComponentUpdate å‡å°‘å¤§çš„å­æ ‘çš„é‡æ–°è®¡ç®—. reactçš„ä¸€å¤§ç‰¹ç‚¹å°±æ˜¯è™šæ‹ŸDOMçš„diffç®—æ³•ï¼Œä¸‹å›¾ä¸ºdiffå®žçŽ°æµç¨‹å›¾ã€‚ä¼ ç»Ÿç®—æ³•çš„ç†è§£ç”»çš„æµç¨‹å›¾React é€šè¿‡åˆ¶å®šå¤§èƒ†çš„ç­–ç•¥ï¼Œå°† O(n^3) å¤æ‚åº¦çš„é—®é¢˜è½¬æ¢æˆ O(n) å¤æ‚åº¦çš„é—®é¢˜ã€‚ åŽŸæ–‡åœ°å€ æ›´å¤šå…³äºŽReactæºç é“¾æŽ¥reactæºç åˆ†æžreactæºç å‰–æžï¼ˆè¿™ç¯‡æ–‡ç« å¯¹å›¾ä¸­ç§»ä½ç®—æ³•æœ‰è¯¦ç»†è§£é‡Šï¼‰è®ºæ–‡ç®—æ³•è¯¦è§£]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Html5]]></title>
    <url>%2F2018%2F03%2F19%2FHTML5%2FHtml5%2F</url>
    <content type="text"><![CDATA[html5ç‰¹æ€§ç”¨äºŽåª’ä»‹å›žæ”¾çš„ video å’Œ audio å…ƒç´ Videoæ”¯æŒçš„è§†é¢‘æ ¼å¼Ogg = å¸¦æœ‰ Theora è§†é¢‘ç¼–ç å’Œ Vorbis éŸ³é¢‘ç¼–ç çš„ Ogg æ–‡ä»¶ï¼ˆ.oggï¼‰ MPEG4 = å¸¦æœ‰ H.264 è§†é¢‘ç¼–ç å’Œ AAC éŸ³é¢‘ç¼–ç çš„ MPEG 4 æ–‡ä»¶(.mp4) WebM = å¸¦æœ‰ VP8 è§†é¢‘ç¼–ç å’Œ Vorbis éŸ³é¢‘ç¼–ç çš„ WebM æ–‡ä»¶(.mkv) 12&lt;video src="movie.ogg" controls="controls"&gt;&lt;/video&gt; controls å±žæ€§ä¾›æ·»åŠ æ’­æ”¾ã€æš‚åœå’ŒéŸ³é‡æŽ§ä»¶ã€‚ åŒ…å«å®½åº¦å’Œé«˜åº¦å±žæ€§ä¹Ÿæ˜¯ä¸é”™çš„ä¸»æ„ã€‚å¦‚æžœæœ‰ä¸æ”¯æŒvideoçš„æµè§ˆå™¨å™¨åˆ™ä½¿ç”¨ä¸‹é¢ä»£ç 123&lt;video src="movie.ogg" width="320" height="240" controls="controls"&gt;Your browser does not support the video tag.&lt;/video&gt; video å…ƒç´ å…è®¸å¤šä¸ª source å…ƒç´ ã€‚source å…ƒç´ å¯ä»¥é“¾æŽ¥ä¸åŒçš„è§†é¢‘æ–‡ä»¶ã€‚æµè§ˆå™¨å°†ä½¿ç”¨ç¬¬ä¸€ä¸ªå¯è¯†åˆ«çš„æ ¼å¼ï¼š12345&lt;video width="320" height="240" controls="controls"&gt; &lt;source src="movie.ogg" type="video/ogg"&gt; &lt;source src="movie.mp4" type="video/mp4"&gt; Your browser does not support the video tag.&lt;/video&gt; IE8ä¸æ”¯æŒvideoå…ƒç´ ï¼Œåœ¨ IE 9 ä¸­ï¼Œå°†æä¾›å¯¹ä½¿ç”¨ MPEG4 çš„ video å…ƒç´ çš„æ”¯æŒã€‚ videoæ ‡ç­¾å±žæ€§ï¼šautoplay è‡ªåŠ¨æ’­æ”¾controls æ˜¾ç¤ºæŽ§ä»¶width è®¾ç½®æ’­æ”¾å™¨çš„å®½åº¦height è®¾ç½®æ’­æ”¾å™¨é«˜åº¦loop å¦‚æžœè®¾ç½®ä¸ºTrueåˆ™å¾ªçŽ¯æ’­æ”¾preload å¦‚æžœå‡ºçŽ°è¯¥å±žæ€§ï¼Œåˆ™è§†é¢‘åœ¨é¡µé¢åŠ è½½æ—¶è¿›è¡ŒåŠ è½½ï¼Œå¹¶é¢„å¤‡æ’­æ”¾ã€‚å¦‚æžœä½¿ç”¨ â€œautoplayâ€ï¼Œåˆ™å¿½ç•¥è¯¥å±žæ€§ã€‚src è¦æ’­æ”¾çš„è§†é¢‘çš„ URL videoæ–¹æ³•ï¼Œå±žæ€§åŠäº‹ä»¶ï¼špaly() è§†é¢‘æ’­æ”¾pasue() è§†é¢‘æš‚åœload() è§†é¢‘åŠ è½½ audioaudioæ”¯æŒçš„éŸ³é¢‘æ ¼å¼Ogg Vorbis ï¼ˆ.oggï¼‰Mp3 (.mp3)Wav (.wav) audioæ ‡ç­¾çš„å±žæ€§autoplay è‡ªåŠ¨æ’­æ”¾controls éŸ³é¢‘æŽ§ä»¶loop å¾ªçŽ¯æ’­æ”¾preload å¦‚æžœå‡ºçŽ°è¯¥å±žæ€§ï¼Œåˆ™è§†é¢‘åœ¨é¡µé¢åŠ è½½æ—¶è¿›è¡ŒåŠ è½½ï¼Œå¹¶é¢„å¤‡æ’­æ”¾ã€‚å¦‚æžœä½¿ç”¨ â€œautoplayâ€ï¼Œåˆ™å¿½ç•¥è¯¥å±žæ€§ã€‚src è¦æ’­æ”¾çš„éŸ³é¢‘çš„ URL html5æ‹–æ”¾ï¼ˆdragå’Œdrop) æµè§ˆå™¨æ”¯æŒInternet Explorer 9ã€Firefoxã€Opera 12ã€Chrome ä»¥åŠ Safari 5 æ”¯æŒæ‹–æ”¾ã€‚ æ³¨é‡Šï¼šåœ¨ Safari 5.1.2 ä¸­ä¸æ”¯æŒæ‹–æ”¾ã€‚ ä¸€ä¸ªç®€å•åœ°ä¾‹å­12345678910111213141516171819202122232425262728&lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;head&gt;&lt;script type="text/javascript"&gt;function allowDrop(ev)&#123; ev.preventDefault();&#125;function drag(ev)&#123; ev.dataTransfer.setData("Text",ev.target.id);&#125;function drop(ev)&#123; ev.preventDefault(); var data=ev.dataTransfer.getData("Text"); ev.target.appendChild(document.getElementById(data));&#125;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="div1" ondrop="drop(event)"ondragover="allowDrop(event)"&gt;&lt;/div&gt;&lt;img id="drag1" src="img_logo.gif" draggable="true"ondragstart="drag(event)" width="336" height="69" /&gt;&lt;/body&gt;&lt;/html&gt; è®¾ç½®å…ƒç´ ä¸ºå¯æ‹–æ”¾é¦–å…ˆï¼Œä¸ºäº†ä½¿å…ƒç´ å¯æ‹–åŠ¨ï¼ŒæŠŠ draggable å±žæ€§è®¾ç½®ä¸º true ï¼š1&lt;img draggable="true" /&gt; æ‹–åŠ¨ä»€ä¹ˆ - ondragstart å’Œ setData()ç„¶åŽï¼Œè§„å®šå½“å…ƒç´ è¢«æ‹–åŠ¨æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œondragstart å±žæ€§è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œdrag(event)ï¼Œå®ƒè§„å®šäº†è¢«æ‹–åŠ¨çš„æ•°æ®ã€‚dataTransfer.setData() æ–¹æ³•è®¾ç½®è¢«æ‹–æ•°æ®çš„æ•°æ®ç±»åž‹å’Œå€¼ï¼š 123function drag(ev)&#123; ev.dataTransfer.setData("Text",ev.target.id);&#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•°æ®ç±»åž‹æ˜¯ â€œTextâ€ï¼Œå€¼æ˜¯å¯æ‹–åŠ¨å…ƒç´ çš„ id (â€œdrag1â€)ã€‚ æ”¾åˆ°ä½•å¤„ - ondragoverondragover äº‹ä»¶è§„å®šåœ¨ä½•å¤„æ”¾ç½®è¢«æ‹–åŠ¨çš„æ•°æ®ã€‚ é»˜è®¤åœ°ï¼Œæ— æ³•å°†æ•°æ®/å…ƒç´ æ”¾ç½®åˆ°å…¶ä»–å…ƒç´ ä¸­ã€‚å¦‚æžœéœ€è¦è®¾ç½®å…è®¸æ”¾ç½®ï¼Œæˆ‘ä»¬å¿…é¡»é˜»æ­¢å¯¹å…ƒç´ çš„é»˜è®¤å¤„ç†æ–¹å¼ã€‚ è¿™è¦é€šè¿‡è°ƒç”¨ ondragover äº‹ä»¶çš„ event.preventDefault() æ–¹æ³•ï¼š1event.preventDefault() è¿›è¡Œæ”¾ç½® - ondropå½“æ”¾ç½®è¢«æ‹–æ•°æ®æ—¶ï¼Œä¼šå‘ç”Ÿ drop äº‹ä»¶ã€‚ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œondrop å±žæ€§è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œdrop(event)ï¼š function drop(ev){ev.preventDefault();var data=ev.dataTransfer.getData(â€œTextâ€);ev.target.appendChild(document.getElementById(data));} ä»£ç è§£é‡Šï¼š1.è°ƒç”¨ preventDefault() æ¥é¿å…æµè§ˆå™¨å¯¹æ•°æ®çš„é»˜è®¤å¤„ç†ï¼ˆdrop äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºæ˜¯ä»¥é“¾æŽ¥å½¢å¼æ‰“å¼€ï¼‰2.é€šè¿‡ dataTransfer.getData(â€œTextâ€) æ–¹æ³•èŽ·å¾—è¢«æ‹–çš„æ•°æ®ã€‚è¯¥æ–¹æ³•å°†è¿”å›žåœ¨ setData() æ–¹æ³•ä¸­è®¾ç½®ä¸ºç›¸åŒç±»åž‹çš„ä»»ä½•æ•°æ®ã€‚3.è¢«æ‹–æ•°æ®æ˜¯è¢«æ‹–å…ƒç´ çš„ id (â€œdrag1â€)4.æŠŠè¢«æ‹–å…ƒç´ è¿½åŠ åˆ°æ”¾ç½®å…ƒç´ ï¼ˆç›®æ ‡å…ƒç´ ï¼‰ä¸­ Canvas(ç”»å¸ƒ)ä»€ä¹ˆæ˜¯ Canvasï¼ŸHTML5 çš„ canvas å…ƒç´ ä½¿ç”¨ JavaScript åœ¨ç½‘é¡µä¸Šç»˜åˆ¶å›¾åƒã€‚ ç”»å¸ƒæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œæ‚¨å¯ä»¥æŽ§åˆ¶å…¶æ¯ä¸€åƒç´ ã€‚canvas æ‹¥æœ‰å¤šç§ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒçš„æ–¹æ³•ã€‚ åˆ›å»º Canvas å…ƒç´ å‘ HTML5 é¡µé¢æ·»åŠ  canvas å…ƒç´ ã€‚ è§„å®šå…ƒç´ çš„ idã€å®½åº¦å’Œé«˜åº¦ï¼š1&lt;canvas id="myCanvas" width="200" height="100"&gt;&lt;/canvas&gt; é€šè¿‡ JavaScript æ¥ç»˜åˆ¶canvas å…ƒç´ æœ¬èº«æ˜¯æ²¡æœ‰ç»˜å›¾èƒ½åŠ›çš„ã€‚æ‰€æœ‰çš„ç»˜åˆ¶å·¥ä½œå¿…é¡»åœ¨ JavaScript å†…éƒ¨å®Œæˆï¼š123456&lt;script type="text/javascript"&gt;var c=document.getElementById("myCanvas");var cxt=c.getContext("2d");cxt.fillStyle="#FF0000";cxt.fillRect(0,0,150,75);&lt;/script&gt; JavaScript ä½¿ç”¨ id æ¥å¯»æ‰¾ canvas å…ƒç´ ï¼š1var c=document.getElementById("myCanvas"); ç„¶åŽï¼Œåˆ›å»º context å¯¹è±¡ï¼š12var cxt=c.getContext("2d"); getContext("2d") å¯¹è±¡æ˜¯å†…å»ºçš„ HTML5 å¯¹è±¡ï¼Œæ‹¥æœ‰å¤šç§ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒçš„æ–¹æ³•ã€‚ ä¸‹é¢çš„ä¸¤è¡Œä»£ç ç»˜åˆ¶ä¸€ä¸ªçº¢è‰²çš„çŸ©å½¢ï¼š12cxt.fillStyle="#FF0000";cxt.fillRect(0,0,150,75); fillStyle æ–¹æ³•å°†å…¶æŸ“æˆçº¢è‰²ï¼ŒfillRect æ–¹æ³•è§„å®šäº†å½¢çŠ¶ã€ä½ç½®å’Œå°ºå¯¸ã€‚ SVGä»€ä¹ˆæ˜¯SVGï¼ŸSVG æŒ‡å¯ä¼¸ç¼©çŸ¢é‡å›¾å½¢ (Scalable Vector Graphics)SVG ç”¨äºŽå®šä¹‰ç”¨äºŽç½‘ç»œçš„åŸºäºŽçŸ¢é‡çš„å›¾å½¢SVG ä½¿ç”¨ XML æ ¼å¼å®šä¹‰å›¾å½¢SVG å›¾åƒåœ¨æ”¾å¤§æˆ–æ”¹å˜å°ºå¯¸çš„æƒ…å†µä¸‹å…¶å›¾å½¢è´¨é‡ä¸ä¼šæœ‰æŸå¤±SVG æ˜¯ä¸‡ç»´ç½‘è”ç›Ÿçš„æ ‡å‡† SVG çš„ä¼˜åŠ¿ä¸Žå…¶ä»–å›¾åƒæ ¼å¼ç›¸æ¯”ï¼ˆæ¯”å¦‚ JPEG å’Œ GIFï¼‰ï¼Œä½¿ç”¨ SVG çš„ä¼˜åŠ¿åœ¨äºŽï¼š SVG å›¾åƒå¯é€šè¿‡æ–‡æœ¬ç¼–è¾‘å™¨æ¥åˆ›å»ºå’Œä¿®æ”¹SVG å›¾åƒå¯è¢«æœç´¢ã€ç´¢å¼•ã€è„šæœ¬åŒ–æˆ–åŽ‹ç¼©SVG æ˜¯å¯ä¼¸ç¼©çš„SVG å›¾åƒå¯åœ¨ä»»ä½•çš„åˆ†è¾¨çŽ‡ä¸‹è¢«é«˜è´¨é‡åœ°æ‰“å°SVG å¯åœ¨å›¾åƒè´¨é‡ä¸ä¸‹é™çš„æƒ…å†µä¸‹è¢«æ”¾å¤§ ä¾‹å­1234567891011&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="190"&gt; &lt;polygon points="100,10 40,180 190,60 10,60 160,180" style="fill:lime;stroke:purple;stroke-width:5;fill-rule:evenodd;" /&gt;&lt;/svg&gt;&lt;/body&gt;&lt;/html&gt; Canvas ä¸Ž SVG çš„æ¯”è¾ƒä¸‹è¡¨åˆ—å‡ºäº† canvas ä¸Ž SVG ä¹‹é—´çš„ä¸€äº›ä¸åŒä¹‹å¤„ã€‚ Canvas ä¾èµ–åˆ†è¾¨çŽ‡ ä¸æ”¯æŒäº‹ä»¶å¤„ç†å™¨ å¼±çš„æ–‡æœ¬æ¸²æŸ“èƒ½åŠ› èƒ½å¤Ÿä»¥ .png æˆ– .jpg æ ¼å¼ä¿å­˜ç»“æžœå›¾åƒ æœ€é€‚åˆå›¾åƒå¯†é›†åž‹çš„æ¸¸æˆï¼Œå…¶ä¸­çš„è®¸å¤šå¯¹è±¡ä¼šè¢«é¢‘ç¹é‡ç»˜ SVG ä¸ä¾èµ–åˆ†è¾¨çŽ‡ æ”¯æŒäº‹ä»¶å¤„ç†å™¨ æœ€é€‚åˆå¸¦æœ‰å¤§åž‹æ¸²æŸ“åŒºåŸŸçš„åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚è°·æ­Œåœ°å›¾ï¼‰ å¤æ‚åº¦é«˜ä¼šå‡æ…¢æ¸²æŸ“é€Ÿåº¦ï¼ˆä»»ä½•è¿‡åº¦ä½¿ç”¨ DOM çš„åº”ç”¨éƒ½ä¸å¿«ï¼‰ ä¸é€‚åˆæ¸¸æˆåº”ç”¨ Html5åœ°ç†å®šä½HTML5 Geolocation API ç”¨äºŽèŽ·å¾—ç”¨æˆ·çš„åœ°ç†ä½ç½®ã€‚ é‰´äºŽè¯¥ç‰¹æ€§å¯èƒ½ä¾µçŠ¯ç”¨æˆ·çš„éšç§ï¼Œé™¤éžç”¨æˆ·åŒæ„ï¼Œå¦åˆ™ç”¨æˆ·ä½ç½®ä¿¡æ¯æ˜¯ä¸å¯ç”¨çš„ã€‚12345678910111213141516&lt;script&gt;var x=document.getElementById("demo");function getLocation() &#123; if (navigator.geolocation) &#123; navigator.geolocation.getCurrentPosition(showPosition); &#125; else&#123;x.innerHTML="Geolocation is not supported by this browser.";&#125; &#125;function showPosition(position) &#123; x.innerHTML="Latitude: " + position.coords.latitude + "&lt;br /&gt;Longitude: " + position.coords.longitude; &#125;&lt;/script&gt; ä¸Šé¢ä»£ç è§£é‡Šï¼šæ£€æµ‹æ˜¯å¦æ”¯æŒåœ°ç†å®šä½å¦‚æžœæ”¯æŒï¼Œåˆ™è¿è¡Œ getCurrentPosition() æ–¹æ³•ã€‚å¦‚æžœä¸æ”¯æŒï¼Œåˆ™å‘ç”¨æˆ·æ˜¾ç¤ºä¸€æ®µæ¶ˆæ¯ã€‚å¦‚æžœgetCurrentPosition()è¿è¡ŒæˆåŠŸï¼Œåˆ™å‘å‚æ•°showPositionä¸­è§„å®šçš„å‡½æ•°è¿”å›žä¸€ä¸ªcoordinateså¯¹è±¡showPosition() å‡½æ•°èŽ·å¾—å¹¶æ˜¾ç¤ºç»åº¦å’Œçº¬åº¦ å¤„ç†é”™è¯¯ï¼š123456789101112131415161718function showError(error) &#123; switch(error.code) &#123; case error.PERMISSION_DENIED:// ç”¨æˆ·ä¸å…è®¸åœ°ç†å®šä½ x.innerHTML="User denied the request for Geolocation." break; case error.POSITION_UNAVAILABLE://æ— æ³•èŽ·å–å½“å‰ä½ç½® x.innerHTML="Location information is unavailable." break; case error.TIMEOUT:// è¶…æ—¶å¤„ç† x.innerHTML="The request to get user location timed out." break; case error.UNKNOWN_ERROR: // é”™è¯¯å¤„ç† x.innerHTML="An unknown error occurred." break; &#125; &#125; HTML 5 Web å­˜å‚¨HTML5 æä¾›äº†ä¸¤ç§åœ¨å®¢æˆ·ç«¯å­˜å‚¨æ•°æ®çš„æ–°æ–¹æ³•ï¼š localStorage - æ²¡æœ‰æ—¶é—´é™åˆ¶çš„æ•°æ®å­˜å‚¨sessionStorage - é’ˆå¯¹ä¸€ä¸ª session çš„æ•°æ®å­˜å‚¨ localStorage æ–¹æ³•localStorage æ–¹æ³•å­˜å‚¨çš„æ•°æ®æ²¡æœ‰æ—¶é—´é™åˆ¶ã€‚ç¬¬äºŒå¤©ã€ç¬¬äºŒå‘¨æˆ–ä¸‹ä¸€å¹´ä¹‹åŽï¼Œæ•°æ®ä¾ç„¶å¯ç”¨ã€‚ å¦‚ä½•åˆ›å»ºå’Œè®¿é—® localStorageï¼š1234&lt;script type="text/javascript"&gt;localStorage.lastname="Smith";document.write(localStorage.lastname);&lt;/script&gt; sessionStorage æ–¹æ³•sessionStorage æ–¹æ³•é’ˆå¯¹ä¸€ä¸ª session è¿›è¡Œæ•°æ®å­˜å‚¨ã€‚å½“ç”¨æˆ·å…³é—­æµè§ˆå™¨çª—å£åŽï¼Œæ•°æ®ä¼šè¢«åˆ é™¤ã€‚ å¦‚ä½•åˆ›å»ºå¹¶è®¿é—®ä¸€ä¸ª sessionStorageï¼š1234&lt;script type="text/javascript"&gt;sessionStorage.lastname="Smith";document.write(sessionStorage.lastname);&lt;/script&gt; HTML 5 åº”ç”¨ç¨‹åºç¼“å­˜ä»€ä¹ˆæ˜¯åº”ç”¨ç¨‹åºç¼“å­˜ï¼ˆApplication Cacheï¼‰ï¼ŸHTML5 å¼•å…¥äº†åº”ç”¨ç¨‹åºç¼“å­˜ï¼Œè¿™æ„å‘³ç€ web åº”ç”¨å¯è¿›è¡Œç¼“å­˜ï¼Œå¹¶å¯åœ¨æ²¡æœ‰å› ç‰¹ç½‘è¿žæŽ¥æ—¶è¿›è¡Œè®¿é—®ã€‚ åº”ç”¨ç¨‹åºç¼“å­˜ä¸ºåº”ç”¨å¸¦æ¥ä¸‰ä¸ªä¼˜åŠ¿ï¼š ç¦»çº¿æµè§ˆ - ç”¨æˆ·å¯åœ¨åº”ç”¨ç¦»çº¿æ—¶ä½¿ç”¨å®ƒä»¬é€Ÿåº¦ - å·²ç¼“å­˜èµ„æºåŠ è½½å¾—æ›´å¿«å‡å°‘æœåŠ¡å™¨è´Ÿè½½ - æµè§ˆå™¨å°†åªä»ŽæœåŠ¡å™¨ä¸‹è½½æ›´æ–°è¿‡æˆ–æ›´æ”¹è¿‡çš„èµ„æºã€‚ Cache Manifest åŸºç¡€å¦‚éœ€å¯ç”¨åº”ç”¨ç¨‹åºç¼“å­˜ï¼Œè¯·åœ¨æ–‡æ¡£çš„ æ ‡ç­¾ä¸­åŒ…å« manifest å±žæ€§ï¼š1234&lt;!DOCTYPE HTML&gt;&lt;html manifest="demo.appcache"&gt;...&lt;/html&gt; Manifest æ–‡ä»¶manifest æ–‡ä»¶æ˜¯ç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒå‘ŠçŸ¥æµè§ˆå™¨è¢«ç¼“å­˜çš„å†…å®¹ï¼ˆä»¥åŠä¸ç¼“å­˜çš„å†…å®¹ï¼‰ã€‚ manifest æ–‡ä»¶å¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š CACHE MANIFEST - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶å°†åœ¨é¦–æ¬¡ä¸‹è½½åŽè¿›è¡Œç¼“å­˜NETWORK - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶éœ€è¦ä¸ŽæœåŠ¡å™¨çš„è¿žæŽ¥ï¼Œä¸”ä¸ä¼šè¢«ç¼“å­˜FALLBACK - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶è§„å®šå½“é¡µé¢æ— æ³•è®¿é—®æ—¶çš„å›žé€€é¡µé¢ï¼ˆæ¯”å¦‚ 404 é¡µé¢ï¼‰ æ›´æ–°ç¼“å­˜ä¸€æ—¦åº”ç”¨è¢«ç¼“å­˜ï¼Œå®ƒå°±ä¼šä¿æŒç¼“å­˜ç›´åˆ°å‘ç”Ÿä¸‹åˆ—æƒ…å†µï¼š ç”¨æˆ·æ¸…ç©ºæµè§ˆå™¨ç¼“å­˜manifest æ–‡ä»¶è¢«ä¿®æ”¹ï¼ˆå‚é˜…ä¸‹é¢çš„æç¤ºï¼‰ç”±ç¨‹åºæ¥æ›´æ–°åº”ç”¨ç¼“å­˜ å®žä¾‹ - å®Œæ•´çš„ Manifest æ–‡ä»¶CACHE MANIFEST #2012-02-21 v1.0.0/theme.css/logo.gif/main.js NETWORK:login.asp FALLBACK:/html5/ /404.html é‡è¦çš„æç¤ºï¼šä»¥ â€œ#â€ å¼€å¤´çš„æ˜¯æ³¨é‡Šè¡Œï¼Œä½†ä¹Ÿå¯æ»¡è¶³å…¶ä»–ç”¨é€”ã€‚åº”ç”¨çš„ç¼“å­˜ä¼šåœ¨å…¶ manifest æ–‡ä»¶æ›´æ”¹æ—¶è¢«æ›´æ–°ã€‚å¦‚æžœæ‚¨ç¼–è¾‘äº†ä¸€å¹…å›¾ç‰‡ï¼Œæˆ–è€…ä¿®æ”¹äº†ä¸€ä¸ª JavaScript å‡½æ•°ï¼Œè¿™äº›æ”¹å˜éƒ½ä¸ä¼šè¢«é‡æ–°ç¼“å­˜ã€‚æ›´æ–°æ³¨é‡Šè¡Œä¸­çš„æ—¥æœŸå’Œç‰ˆæœ¬å·æ˜¯ä¸€ç§ä½¿æµè§ˆå™¨é‡æ–°ç¼“å­˜æ–‡ä»¶çš„åŠžæ³•ã€‚ æ³¨é‡Šï¼šæµè§ˆå™¨å¯¹ç¼“å­˜æ•°æ®çš„å®¹é‡é™åˆ¶å¯èƒ½ä¸å¤ªä¸€æ ·ï¼ˆæŸäº›æµè§ˆå™¨è®¾ç½®çš„é™åˆ¶æ˜¯æ¯ä¸ªç«™ç‚¹ 5MBï¼‰ã€‚ HTML 5 Web Workersä»€ä¹ˆæ˜¯ Web Workerï¼Ÿå½“åœ¨ HTML é¡µé¢ä¸­æ‰§è¡Œè„šæœ¬æ—¶ï¼Œé¡µé¢çš„çŠ¶æ€æ˜¯ä¸å¯å“åº”çš„ï¼Œç›´åˆ°è„šæœ¬å·²å®Œæˆã€‚ web worker æ˜¯è¿è¡Œåœ¨åŽå°çš„ JavaScriptï¼Œç‹¬ç«‹äºŽå…¶ä»–è„šæœ¬ï¼Œä¸ä¼šå½±å“é¡µé¢çš„æ€§èƒ½ã€‚æ‚¨å¯ä»¥ç»§ç»­åšä»»ä½•æ„¿æ„åšçš„äº‹æƒ…ï¼šç‚¹å‡»ã€é€‰å–å†…å®¹ç­‰ç­‰ï¼Œè€Œæ­¤æ—¶ web worker åœ¨åŽå°è¿è¡Œã€‚ Web Workers å’Œ DOMç”±äºŽ web worker ä½äºŽå¤–éƒ¨æ–‡ä»¶ä¸­ï¼Œå®ƒä»¬æ— æ³•è®¿é—®ä¸‹ä¾‹ JavaScript å¯¹è±¡ï¼šwindow å¯¹è±¡document å¯¹è±¡parent å¯¹è±¡ HTML 5 æœåŠ¡å™¨å‘é€äº‹ä»¶Server-Sent äº‹ä»¶ - å•å‘æ¶ˆæ¯ä¼ é€’Server-Sent äº‹ä»¶æŒ‡çš„æ˜¯ç½‘é¡µè‡ªåŠ¨èŽ·å–æ¥è‡ªæœåŠ¡å™¨çš„æ›´æ–°ã€‚ ä»¥å‰ä¹Ÿå¯èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œå‰ææ˜¯ç½‘é¡µä¸å¾—ä¸è¯¢é—®æ˜¯å¦æœ‰å¯ç”¨çš„æ›´æ–°ã€‚é€šè¿‡æœåŠ¡å™¨å‘é€äº‹ä»¶ï¼Œæ›´æ–°èƒ½å¤Ÿè‡ªåŠ¨åˆ°è¾¾ã€‚ ä¾‹å­ï¼šFacebook/Twitter æ›´æ–°ã€ä¼°ä»·æ›´æ–°ã€æ–°çš„åšæ–‡ã€èµ›äº‹ç»“æžœç­‰12345var source=new EventSource("demo_sse.php");source.onmessage=function(event) &#123; document.getElementById("result").innerHTML+=event.data + "&lt;br /&gt;"; &#125;; EventSource å¯¹è±¡åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ onmessage äº‹ä»¶æ¥èŽ·å–æ¶ˆæ¯ã€‚ä¸è¿‡è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–äº‹ä»¶ï¼š onopen å½“é€šå¾€æœåŠ¡å™¨çš„è¿žæŽ¥è¢«æ‰“å¼€onmessage å½“æŽ¥æ”¶åˆ°æ¶ˆæ¯onerror å½“é”™è¯¯å‘ç”Ÿ html5è¡¨å•HTML5 æ–°çš„ Input ç±»åž‹HTML5 æ‹¥æœ‰å¤šä¸ªæ–°çš„è¡¨å•è¾“å…¥ç±»åž‹ã€‚è¿™äº›æ–°ç‰¹æ€§æä¾›äº†æ›´å¥½çš„è¾“å…¥æŽ§åˆ¶å’ŒéªŒè¯ã€‚ æœ¬ç« å…¨é¢ä»‹ç»è¿™äº›æ–°çš„è¾“å…¥ç±»åž‹ï¼š email åœ¨æäº¤è¡¨å•æ—¶ï¼Œä¼šè‡ªåŠ¨éªŒè¯ email åŸŸçš„å€¼ã€‚url åœ¨æäº¤è¡¨å•æ—¶ï¼Œä¼šè‡ªåŠ¨éªŒè¯ url åŸŸçš„å€¼ã€‚number numberç±»åž‹ç”¨äºŽåº”è¯¥åŒ…å«æ•°å€¼çš„è¾“å…¥åŸŸã€‚range range ç±»åž‹æ˜¾ç¤ºä¸ºæ»‘åŠ¨æ¡ã€‚Date pickers (date, month, week, time, datetime, datetime-local) æ—¥æœŸé€‰æ‹©å™¨search æœç´¢åŸŸï¼Œæ¯”å¦‚ç«™ç‚¹æœç´¢æˆ– Google æœç´¢ã€‚color HTML5 è¡¨å•å…ƒç´  HTML5 çš„æ–°çš„è¡¨å•å…ƒç´ ï¼šdatalist datalist å…ƒç´ è§„å®šè¾“å…¥åŸŸçš„é€‰é¡¹åˆ—è¡¨ã€‚123456Webpage: &lt;input type="url" list="url_list" name="link" /&gt;&lt;datalist id="url_list"&gt;&lt;option label="W3School" value="http://www.W3School.com.cn" /&gt;&lt;option label="Google" value="http://www.google.com" /&gt;&lt;option label="Microsoft" value="http://www.microsoft.com" /&gt;&lt;/datalist&gt; æç¤ºï¼šoption å…ƒç´ æ°¸è¿œéƒ½è¦è®¾ç½® value å±žæ€§ã€‚ keygen keygen å…ƒç´ çš„ä½œç”¨æ˜¯æä¾›ä¸€ç§éªŒè¯ç”¨æˆ·çš„å¯é æ–¹æ³•ã€‚output output å…ƒç´ ç”¨äºŽä¸åŒç±»åž‹çš„è¾“å‡ºï¼Œæ¯”å¦‚è®¡ç®—æˆ–è„šæœ¬è¾“å‡ºï¼š HTML5 è¡¨å•å±žæ€§æ–°çš„ form å±žæ€§ï¼šautocomplete autocomplete å±žæ€§è§„å®š form æˆ– input åŸŸåº”è¯¥æ‹¥æœ‰è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ã€‚novalidate æ–°çš„ input å±žæ€§ï¼šautocompleteautofocus autofocus å±žæ€§è§„å®šåœ¨é¡µé¢åŠ è½½æ—¶ï¼ŒåŸŸè‡ªåŠ¨åœ°èŽ·å¾—ç„¦ç‚¹ã€‚formform overrides (formaction, formenctype, formmethod, formnovalidate, formtarget) å…è®¸æ‚¨é‡å†™ form å…ƒç´ çš„æŸäº›å±žæ€§è®¾å®šheight å’Œ width height å’Œ width å±žæ€§è§„å®šç”¨äºŽ image ç±»åž‹çš„ input æ ‡ç­¾çš„å›¾åƒé«˜åº¦å’Œå®½åº¦ã€‚list list å±žæ€§è§„å®šè¾“å…¥åŸŸçš„ datalistã€‚datalist æ˜¯è¾“å…¥åŸŸçš„é€‰é¡¹åˆ—è¡¨ã€‚min, max å’Œ step step å±žæ€§ä¸ºè¾“å…¥åŸŸè§„å®šåˆæ³•çš„æ•°å­—é—´éš”multiple multiple å±žæ€§é€‚ç”¨äºŽä»¥ä¸‹ç±»åž‹çš„ æ ‡ç­¾ï¼šemail å’Œ fileã€‚pattern (regexp) pattern å±žæ€§è§„å®šç”¨äºŽéªŒè¯ input åŸŸçš„æ¨¡å¼ï¼ˆpatternï¼‰ã€‚placeholder å±žæ€§æä¾›ä¸€ç§æç¤ºï¼ˆhintï¼‰ï¼Œæè¿°è¾“å…¥åŸŸæ‰€æœŸå¾…çš„å€¼ã€‚required å±žæ€§è§„å®šå¿…é¡»åœ¨æäº¤ä¹‹å‰å¡«å†™è¾“å…¥åŸŸï¼ˆä¸èƒ½ä¸ºç©ºï¼‰ã€‚]]></content>
      <categories>
        <category>HTML5</category>
      </categories>
      <tags>
        <tag>HTML5</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[20ä¸ªè¶…çº§å®žç”¨çš„cssä»£ç ]]></title>
    <url>%2F2018%2F03%2F18%2FCSS3%2F20%E4%B8%AA%E8%B6%85%E7%BA%A7%E5%AE%9E%E7%94%A8%E7%9A%84css%E4%BB%A3%E7%A0%81%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ å¤§å®¶éžå¸¸çš„æ¸…æ¥šCSSæ˜¯æˆ‘ä»¬Webåˆ¶ä½œä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚HTMLæä¾›äº†Webåˆ¶ä½œçš„ç»“æž„ï¼Œä½†ä»–ä¸èƒ½è®©æˆ‘ä»¬å®žçŽ°ç¾Žä¸½çš„é¡µé¢åˆ¶ä½œï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦CSSçš„å¸®åŠ©ã€‚CSSè™½ç„¶èƒ½å¸®æˆ‘ä»¬å®Œå–„Webåˆ¶ä½œçš„æ•ˆæžœï¼Œä½†å…¶åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸‹æ˜¯æœ‰ä¸å¯é¢„çŸ¥çš„æ•ˆæžœï¼Œä¸ºäº†è®©ä½ çš„CSSèƒ½è§£å†³è¿™äº›ä¸ä¸€è‡´ä¸‹ï¼Œä»Šå¤©ç»™å¤§å®¶ä»‹ç»25ä¸ªCSSæŠ€å·§ä»£ç ï¼Œæˆ‘ç›¸ä¿¡è¿™äº›å¯¹ä½ è‚¯å®¶æœ‰å¾ˆå¤§çš„ä½œç”¨ã€‚ ä½¿ç”¨text-indentæ¥éšè—æ–‡æœ¬è¿™ä¸ªå¸¸ç”¨åœ¨å›¾ç‰‡æ›¿æ¢æ–‡æœ¬ä¸­ï¼Œæœ€å¸¸è§çš„å°±æ˜¯ä½¿ç”¨ä½¿ç”¨å›¾ç‰‡æ¥æ›¿æ¢Logoï¼Œè¿™ä¸ªæ˜¯éžå¸¸æœ‰ç”¨çš„ï¼Œä½¿ç”¨â€œtext-indentâ€æˆ‘ä»¬å¯ä»¥è¾¾åˆ°å›¾ç‰‡æ›¿æ¢æ–‡æœ¬çš„æ•ˆæžœï¼Œè€Œä¸”æ–¹ä¾¿æœç´¢å¼•æ“Žçš„ä¼˜åŒ–ï¼Œè¿˜èƒ½æ”¯æŒé˜…è¯»å™¨é˜…è¯»ç½‘é¡µå†…å®¹ï¼š h1 { text-indent:-9999px; margin:0 auto; width:400px; height:100px; background:transparent url(&quot;images/logo.jpg&quot;) no-repeat scroll; } æ ¹æ®æ–‡ä»¶æ ¼å¼è®¾ç½®é“¾æŽ¥å›¾æ ‡è¿™ä¸ªæŠ€å·§ä¸»è¦æ˜¯é’ˆå¯¹ç”¨æˆ·ä½“éªŒï¼Œè®©ç”¨æˆ·èƒ½å¾ˆæ¸…æ¥šç‚¹å‡»çš„é“¾æŽ¥æ˜¯æœ‰å…³äºŽä»€ä¹ˆæ–¹é¢çš„å†…å®¹ï¼Œæ¯”å¦‚è¯´ï¼Œç‚¹å‡»æŸä¸ªé“¾æŽ¥ä¼šåˆ°è·³åˆ°ç«™å¤–ã€‚æ¢å¥è¯è¯´ä½¿ç”¨å±žæ€§é€‰æ‹©å™¨å™¨ï¼Œç»™ä¸åŒçš„é“¾æŽ¥è®¾ç½®ä¸åŒçš„å›¾æ ‡ï¼Œè®©ç”¨æˆ·å¾ˆè½»æ¾çš„æ˜Žç™½ç›¸åº”çš„é“¾æŽ¥æ˜¯æœ‰å…³äºŽä»€ä¹ˆæ–¹é¢çš„å†…å®¹ï¼š a[href^=&quot;http:&quot;] { display:inline-block; padding-right:14px; background:transparent url(/Images/ExternalLink.gif) center right no-repeat; } a[href^=&quot;mailto:&quot;] { display:inline-block; padding-left:20px; line-height:18px; background:transparent url(/Images/MailTo.gif) center left no-repeat; } a[href$=&#39;.pdf&#39;] { display:inline-block; padding-left:20px; line-height:18px; background:transparent url(/Images/PDFIcon.gif) center left no-repeat; } a[href$=&#39;.swf&#39;], a[href$=&#39;.fla&#39;], a[href$=&#39;.swd&#39;] { display:inline-block; padding-left:20px; line-height:18px; background:transparent url(/Images/FlashIcon.gif) center left no-repeat; } a[href$=&#39;.xls&#39;], a[href$=&#39;.csv&#39;], a[href$=&#39;.xlt&#39;], a[href$=&#39;.xlw&#39;] { display:inline-block; padding-left:20px; line-height:18px; background:transparent url(/Images/ExcelIcon.gif) center left no-repeat; } a[href$=&#39;.ppt&#39;], a[href$=&#39;.pps&#39;] { display:inline-block; padding-left:20px; line-height:18px; background:transparent url(/Images/PowerPointIcon.gif) center left no-repeat; } a[href$=&#39;.doc&#39;], a[href$=&#39;.rtf&#39;], a[href$=&#39;.txt&#39;], a[href$=&#39;.wps&#39;] { display:inline-block; padding-left:20px; line-height:18px; background:transparent url(/Images/WordDocIcon.gif) center left no-repeat; } a[href$=&#39;.zip&#39;], a[href$=&#39;.gzip&#39;], a[href$=&#39;.rar&#39;] { display:inline-block; padding-left:20px; line-height:18px; background:transparent url(/Images/ZIPIcon.gif) center left no-repeat; } åœ¨IEæµè§ˆå™¨ä¸­åˆ é™¤textareaçš„æ»šåŠ¨æ¡IEæµè§ˆå™¨ä¸­textareaé»˜è®¤å°±æœ‰æ»šåŠ¨æ¡å‡ºçŽ°ï¼Œä¸ºäº†è¾¾åˆ°æ‰€æœ‰æµè§ˆå™¨é»˜è®¤ä¸‹ä¸€è‡´çš„æ•ˆæžœï¼Œå…¶å®žæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç è®©ä»–è¾¾åˆ°ä¸€è‡´çš„æ•ˆæžœï¼š textarea{ overflow:auto; } æ®µè½é¦–å­—ä¸‹æ²‰æœ‰æ‚å¿—æŽ’ç‰ˆä¸­æˆ‘ä»¬å¸¸çœ‹åˆ°ç¬¬ä¸€ä¸ªæ®µè½çš„é¦–å­—ä¸‹æ²‰çš„æ•ˆæžœï¼Œå…¶å®žè¿™ç§æ•ˆæžœå®žçŽ°æ˜¯ç›¸å½“çš„å®¹æ˜“ï¼š p:first-letter{ display:block; margin:5px 0 0 5px; float:left; color:#FF3366; font-size:60px; font-family:Georgia; } æ‰€æœ‰æµè§ˆå™¨ä¸‹çš„CSSé€æ˜Žåº¦ .transparent { zoom: 1; filter: alpha(opacity=50); opacity: 0.5; } ä½†æ˜¯ä½¿ç”¨opacityä¼šå½±å“å…¶åŽä»£å…ƒç´ çš„é€æ˜Žåº¦ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ï¼š .transparent { /* Fallback for web browsers that doesn&#39;t support RGBa */ background: rgb(0, 0, 0); /* RGBa with 0.6 opacity */ background: rgba(0, 0, 0, 0.6); /* For IE 5.5 - 7*/ filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000); /* For IE 8*/ -ms-filter: &quot;progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)&quot;; } Reset Cssbody,ul,ol,dl,dd,dir,h1,h2,h3,h4,h5,h6,p,pre,blockquote,hr,figure{ margin:0; padding:0; font-size: 100%; vertical-align:baseline; } table { border-collapse:collapse; border-spacing:0; } article, aside, dialog, figure, footer, header, hgroup, nav, section { display:block; } /* * Corrects inline-block display not defined in IE6/7/8/9 &amp; FF3 */ audio, canvas, video { display: inline-block; *display: inline; *zoom: 1; } /* * Prevents modern browsers from displaying &#39;audio&#39; without controls */ audio:not([controls]) { display: none; } /* * Addresses styling for &#39;hidden&#39; attribute not present in IE7/8/9, FF3, S4 * Known issue: no IE6 support */ [hidden] { display: none; } å›¾ç‰‡é¢„åŠ è½½#preloader { /* Images you want to preload*/ background-image: url(image1.jpg); background-image: url(image2.jpg); background-image: url(image3.jpg); width: 0px; height: 0px; display: inline; } åŸºæœ¬çš„CSS SpriteæŒ‰é’®a { display: block; background: url(sprite.png) no-repeat; height: 30px; width: 250px; } a:hover { background-position: 0 -30px; } Google Font API&lt;head&gt; Inconsolata:italic|Droid+Sans&quot; &lt;/head&gt; body { font-family: &#39;Tangerine&#39;, &#39;Inconsolata&#39;, &#39;Droid Sans&#39;, serif; font-size: 48px; } æµè§ˆå™¨çš„ä¸“ç”¨hackæµè§ˆå™¨çš„å…¼å®¹é—®é¢˜å‘æ¥éƒ½æ˜¯å¾ˆçƒ¦çš„äº‹æƒ…ï¼Œç‰¹åˆ«æ˜¯åœ¨IEä¸‹çš„å…¼å®¹é—®é¢˜ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬ä¸ºäº†è¾¾åˆ°ä¸€è‡´çš„æ•ˆæžœï¼Œä¸å¾—ä¸ä½¿ç”¨æµè§ˆå™¨çš„å…¼å®¹ï¼š /* IE 6 */ * html .yourclass { } /* IE 7 */ *+html .yourclass{ } /* IE 7 and modern browsers */ html&gt;body .yourclass { } /* Modern browsers (not IE 7) */ html&gt;/**/body .yourclass { } /* Opera 9.27 and below */ html:first-child .yourclass { } /* Safari */ html[xmlns*=&quot;&quot;] body:last-child .yourclass { } /* Safari 3+, Chrome 1+, Opera 9+, Fx 3.5+ */ body:nth-of-type(1) .yourclass { } /* Safari 3+, Chrome 1+, Opera 9+, Fx 3.5+ */ body:first-of-type .yourclass { } /* Safari 3+, Chrome 1+ */ @media screen and (-webkit-min-device-pixel-ratio:0) { .yourclass { } } å›ºå®šé¡µè„šå›ºå®šé¡µè„šåœ¨å±å¹•çš„åº•éƒ¨ï¼Œåœ¨çŽ°ä»£æµè§ˆå™¨æ¥è¯´æ˜¯ä¸€ä»¶éžå¸¸å®¹æ˜“çš„äº‹æƒ…ï¼Œä½†æ˜¯åœ¨IE6ä¸‹è¿˜æ˜¯éœ€è¦ç‰¹æ®Šçš„å¤„ç†ï¼š #footer { position:fixed; left:0px; bottom:0px; height:30px; width:100%; background:#999; } /* IE 6 */ * html #footer { position:absolute; top:expression((0-(footer.offsetHeight)+(document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body.clientHeight)+(ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop))+&#39;px&#39;); } ç¿»è½¬å›¾ç‰‡ç¿»è½¬å›¾åƒéšç€CSS3çš„transformè¶Šæ¥è¶Šå®žç”¨ï¼Œä¸éœ€è¦é‡æ–°åŠ è½½å›¾ç‰‡ï¼Œå°±å¯ä»¥å®žçŽ°ä¸€ä¸ªå›¾ç‰‡çš„æ—‹è½¬ã€‚å¸¸è§çš„æ˜¯ä¸€ä¸ªä¸‰è§’åž‹æ•ˆæžœï¼Œæˆ‘ä»¬æƒ³è®©ä»–åœ¨ä¸åŒçŠ¶æ€å±•ç¤ºä¸åŒçš„é£Žæ ¼ï¼š img.flip { -moz-transform: scaleX(-1); -o-transform: scaleX(-1); -webkit-transform: scaleX(-1); transform: scaleX(-1); filter: FlipH; -ms-filter: &quot;FlipH&quot;; } clearfixclearfixä¸»è¦æ˜¯ä½¿ç”¨ä»–æ¥æ¸…é™¤æµ®åŠ¨ï¼Œåªéœ€è¦æ·»åŠ è¿™ä¸ªç±»åæ— éœ€åŠ ä¸Šä»»ä½•HTMLæ ‡è®°ï¼Œå°±å¯ä»¥è¾¾åˆ°æ¸…é™¤æµ®åŠ¨çš„æ•ˆæžœï¼š .clearfix:before, .clearfix:after { content: &quot; &quot;; display:table; } .clearfix:after { clear:both; overflow:hidden; } .clearfix { zoom: 1; } åœ†è§’éšç€CSS3çš„å±žæ€§çš„å‡ºçŽ°ï¼Œæˆ‘ä»¬åˆ¶ä½œåœ†è§’æ•ˆæžœå°±ä¸éœ€è¦åœ¨åƒä»¥å‰é‚£æ ·çš„è¾›è‹¦äº†ï¼Œå¯ä»¥ä½¿ç”¨CSS3çš„border-radiusæ¥å®žçŽ°ï¼Œåªæ˜¯åœ¨IE-6-8ä¸‹æ— æ³•å®žçŽ°ï¼Œæˆ‘ä»¬æ¥çœ‹çŽ°ä»£æµè§ˆå™¨ä¸‹å¦‚ä½•åˆ¶ä½œåœ†è§’ï¼š .round{ -moz-border-radius: 10px; -webkit-border-radius: 10px; -khtml-border-radius: 10px; /* for old Konqueror browsers */ border-radius: 10px; /* future proofing */ } !important!importantæœ‰æ—¶å¯ä»¥å¸®æˆ‘ä»¬åšå¾ˆå¤šäº‹ï¼Œä»–å¯ä»¥è¦†ç›–ä»»ä½•ç›¸åŒçš„æ ·å¼ï¼Œæ¢å¥è¯è¯´ä»–å¯ä»¥æ”¹ä¸ºæ ·å¼çš„æƒé‡ï¼š p{ font-size:20px !important; } @font-face@font-faceä¹Ÿæ˜¯CSS3çš„å±žæ€§ä¹‹ä¸€ï¼Œä»–èƒ½åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸‹è¿è¡Œã€‚æœ€å¤§çš„ä½œç”¨å°±æ˜¯è®©ç”¨æˆ·æ²¡æœ‰å­—ä½“çš„æµè§ˆä¸‹ä¹Ÿèƒ½æ”¯æŒç½‘é¡µå­—ä½“ï¼Œå…·ä½“ä½¿ç”¨ï¼š @font-face { font-family: &#39;Graublau Web&#39;; src: url(&#39;GraublauWeb.eot&#39;); src: local(&#39;â˜º&#39;), url(&#39;GraublauWeb.woff&#39;) format(&#39;woff&#39;), url(&#39;GraublauWeb.ttf&#39;) format(&#39;truetype&#39;); } h2 { font-family:&#39;Graublau Web&#39;; } é¡µé¢æ°´å¹³å±…ä¸­å¦‚ä½•ä½¿ä¸€ä¸ªç½‘ç«™çš„é¡µé¢æ°´å¹³å±…ä¸­æ˜¾ç¤ºï¼Œæˆ‘æƒ³è¿™ä¸ªä¸ç”¨æˆ‘è¯´å¤§å®¶ä¹ŸçŸ¥é“ï¼Œå› ä¸ºå¤§å®¶è‚¯å®šä½¿ç”¨è¿‡å¤šæ¬¡äº†ã€‚ .wrapper { width:960px; margin:0 auto; } æœ€å°é«˜åº¦min-heightåœ¨IE6æµè§ˆå™¨ä¸‹æ˜¯ä¸æ”¯æŒæœ€å°é«˜åº¦è¿™ä¸ªå±žæ€§çš„ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ ·çš„ä»£ç æ¥å¤„ç†ï¼š .box { min-height:500px; height:auto !important; height:500px; } åž‚ç›´å±…ä¸­æ°´å¹³å±…ä¸­å¤„ç†èµ·æ¥ç›¸å½“çš„ç®€å•çš„ï¼Œä½†æ˜¯åž‚ç›´å±…ä¸­å¤„ç†èµ·æ¥è¿˜æ˜¯ç›¸å½“çš„çƒ¦ï¼Œç‰¹åˆ«æ˜¯è¦å…¼å®¹IEçš„æµè§ˆå™¨æƒ…å†µä¸‹ï¼š div { height: 100px; line-height: 100px; white-space: nowrap; } img { vertical-align: middle; } .for_ie6 { display: inline-block; } .for_ie6 { display: inline; } ::selectionæœ‰å¾ˆå¤šæœ‹å‹è‚¯å®šä¸çŸ¥é“è¿™ä¸ªå±žæ€§çš„ä½œç”¨ã€‚å®ƒå¯ä»¥æ”¹å˜é€‰æ‹©çš„æ–‡æœ¬çš„èƒŒæ™¯è‰²å’Œå‰æ™¯è‰²ï¼Œçªå‡ºä½ çš„æµè§ˆå™¨ä¸­çš„é€‰æ‹©æ–‡æœ¬æ•ˆæžœï¼š ::selection { color: #000000; background-color: #FF0000; } ::-moz-selection { color: #000000; background: #FF0000; }]]></content>
      <categories>
        <category>Css3</category>
      </categories>
      <tags>
        <tag>Css3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯é¢è¯•é¢˜ï¼ˆå«äººäº‹æ–¹é¢ï¼‰]]></title>
    <url>%2F2018%2F03%2F13%2FInterview%2F%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E5%90%AB%E4%BA%BA%E4%BA%8B%E6%96%B9%E9%9D%A2%EF%BC%89%2F</url>
    <content type="text"><![CDATA[å‰ç«¯æ–¹é¢1.éšè—htmlå…ƒç´ çš„ä¸¤ç§æ–¹å¼ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿã€display: noneã€‘ï¼šéšè—å…ƒç´ åŠå…ƒç´ å†…çš„æ‰€æœ‰å†…å®¹ï¼Œå¹¶ä¸”è¯¥å…ƒç´ çš„ä½ç½®ã€å®½é«˜ç­‰å…¶ä»–å±žæ€§å€¼ä¸€å¹¶â€œæ¶ˆå¤±â€ï¼›ã€visibility: hiddenã€‘ï¼šéšè—å…ƒç´ åŠå…ƒç´ å†…çš„æ‰€æœ‰å†…å®¹ï¼Œä½†æ˜¯è¯¥å…ƒç´ çš„ä½ç½®ã€å®½é«˜ç­‰å±žæ€§å€¼ä»ç„¶è¿˜åœ¨ã€‚ 2.$.eachå’Œ$(selector).each()çš„åŒºåˆ«ï¼Ÿ $.eachå’Œ$(selector).each()ä¸åŒï¼ŒåŽè€…ä¸“ç”¨äºŽjQueryå¯¹è±¡çš„éåŽ†ï¼Œå‰è€…å¯ç”¨äºŽéåŽ†ä»»ä½•é›†åˆï¼ˆæ— è®ºæ˜¯æ•°ç»„è¿˜æ˜¯å¯¹è±¡ï¼‰ï¼Œå¦‚æžœæ˜¯æ•°ç»„ï¼Œå›žè°ƒå‡½æ•°æ¯æ¬¡ä¼ å…¥æ•°ç»„çš„ç´¢å¼•å€¼å’Œå¯¹åº”å€¼ï¼ˆå€¼äº¦å¯ä»¥é€šè¿‡thiså…³é”®å­—èŽ·å–ï¼Œä½†JavaScriptæ€»ä¼šåŒ…è£…thiså€¼ä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œæ–¹æ³•ä¼šè¿”å›žè¢«éåŽ†å¯¹è±¡çš„ç¬¬ä¸€å‚æ•°ã€‚ 3.$.ajaxçš„å¿…è¦å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ Successå’Œcompleteé‚£ä¸ªå…ˆæ‰§è¡Œï¼Ÿ Function) success - å½“è¯·æ±‚æˆåŠŸæ—¶è°ƒç”¨çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šå¾—åˆ°ä¸€ä¸ªå‚æ•°ï¼šä»ŽæœåŠ¡å™¨è¿”å›žçš„æ•°æ®ï¼ˆæ ¹æ®â€œdataTypeâ€è¿›è¡Œäº†æ ¼å¼åŒ–ï¼‰ã€‚ Function) complete - å½“è¯·æ±‚å®Œæˆæ—¶è°ƒç”¨çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šå¾—åˆ°ä¸¤ä¸ªå‚æ•°ï¼šXMLHttpRequestå¯¹è±¡å’Œä¸€ä¸ªæè¿°è¯·æ±‚æˆåŠŸçš„ç±»åž‹çš„å­—ç¬¦ä¸²ã€‚ jqueryä¸­å„ä¸ªäº‹ä»¶æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š 1.ajaxStart(å…¨å±€äº‹ä»¶) 2.beforeSend 3.ajaxSend(å…¨å±€äº‹ä»¶) 4.success 5.ajaxSuccess(å…¨å±€äº‹ä»¶) 6.error 7.ajaxError (å…¨å±€äº‹ä»¶) 8.complete 9.ajaxComplete(å…¨å±€äº‹ä»¶) 10.ajaxStop(å…¨å±€äº‹ä»¶) 4.åˆ—ä¸¾æµè§ˆå™¨å¯¹è±¡æ¨¡åž‹BOMé‡Œå¸¸ç”¨çš„4ä¸ªå¯¹è±¡ï¼Œå¹¶åˆ—ä¸¾windowå¯¹è±¡çš„å¸¸ç”¨æ–¹æ³•è‡³å°‘5ä¸ªã€‚Window document location screen history navigator æ–¹æ³•ï¼šAlert() confirm() prompt() open() close() 5.ç®€è¿°åˆ—ä¸¾æ–‡æ¡£å¯¹è±¡æ¨¡åž‹DOMé‡Œdocumentçš„å¸¸ç”¨çš„æŸ¥è¯¢è®¿é—®èŠ‚ç‚¹çš„æ–¹æ³•å¹¶åšç®€å•è¯´æ˜Žã€‚1.é€šè¿‡ID,ä½¿ç”¨ getElementById() èŽ·å¾—æ ‡ç­¾èŠ‚ç‚¹ 2.é€šè¿‡æ ‡ç­¾çš„åç§°,ä½¿ç”¨getElementsByTagName() èŽ·å¾—å…ƒç´ èŠ‚ç‚¹æˆ–æ ‡ç­¾èŠ‚ç‚¹ æ³¨æ„ï¼šä»¥ä¸Šçš„æŸ¥æ‰¾æ–¹å¼éƒ½ä¼šå¿½ç•¥æ–‡æ¡£çš„ç»“æž„ 3.é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹çš„ parentNodeã€firstChild ä»¥åŠ lastChild å±žæ€§ 4.èŠ‚ç‚¹åç§°nodeName a)å¦‚æžœèŠ‚ç‚¹æ˜¯æ ‡ç­¾ï¼ŒnodeNameæ˜¯æ ‡ç­¾åç§° b)å¦‚æžœèŠ‚ç‚¹æ˜¯å±žæ€§ï¼ŒnodeNameæ˜¯å±žæ€§åç§° c)å¦‚æžœèŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼ŒnodeNameæ˜¯#text d)å¦‚æžœèŠ‚ç‚¹æ˜¯æ–‡æ¡£ï¼ŒnodeNameæ˜¯#document 5.èŠ‚ç‚¹å€¼nodeValue6.èŠ‚ç‚¹ç±»åž‹nodeType 6.Ajaxçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼ˆè‡³å°‘å„3ä¸ªï¼‰ï¼ŸåŒæ­¥å¼‚æ­¥çš„åŒºåˆ«ï¼Ÿ ajaxçš„ä¼˜ç‚¹ 1.å¼‚æ­¥çš„ä¸ŽæœåŠ¡å™¨é€šä¿¡2.æ— åˆ·æ–°æ›´æ–°æ•°æ®3.åŸºäºŽæ ‡å‡†å¹¿æ³›æ”¯æŒ4.å‰åŽç«¯è´Ÿè½½å¹³è¡¡5.ç•Œé¢ä¸Žåº”ç”¨åˆ†ç¦» ajaxçš„ç¼ºç‚¹ 1.AJAXå¹²æŽ‰äº†Backå’ŒHistoryåŠŸèƒ½ï¼Œå³å¯¹æµè§ˆå™¨æœºåˆ¶çš„ç ´åã€‚2.AJAXçš„å®‰å…¨é—®é¢˜ã€‚3.å¯¹æœç´¢å¼•æ“Žæ”¯æŒè¾ƒå¼±ã€‚4.ç ´åç¨‹åºçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚5.è¿èƒŒURLå’Œèµ„æºå®šä½çš„åˆè¡·ã€‚6.AJAXä¸èƒ½å¾ˆå¥½æ”¯æŒç§»åŠ¨è®¾å¤‡ã€‚7.å®¢æˆ·ç«¯è¿‡è‚¥ï¼Œå¤ªå¤šå®¢æˆ·ç«¯ä»£ç é€ æˆå¼€å‘ä¸Šçš„æˆæœ¬ã€‚ åŒæ­¥ä¸Žå¼‚æ­¥çš„åŒºåˆ« 1ã€åŒæ­¥å‘é€æ–¹å‘å‡ºæ•°æ®åŽï¼Œç­‰æŽ¥æ”¶æ–¹å‘å›žå“åº”ä»¥åŽæ‰å‘ä¸‹ä¸€ä¸ªæ•°æ®åŒ…çš„é€šè®¯æ–¹å¼ã€‚ ä¾‹å¦‚ï¼šç”¨æˆ·å¡«å†™æ‰€æœ‰ä¿¡æ¯åŽï¼Œæäº¤ç»™æœåŠ¡å™¨ï¼Œç­‰å¾…æœåŠ¡å™¨çš„å›žåº”ï¼ˆæ£€éªŒæ•°æ®ï¼‰ï¼Œæ˜¯ä¸€æ¬¡æ€§çš„ã€‚ä¿¡æ¯é”™è¯¯åˆè¦é‡æ–°å¡«å†™ï¼ 2ã€å¼‚æ­¥æ˜¯æŒ‡ï¼šå‘é€æ–¹å‘å‡ºæ•°æ®åŽï¼Œä¸ç­‰æŽ¥æ”¶æ–¹å‘å›žå“åº”ï¼ŒæŽ¥ç€å‘é€ä¸‹ä¸ªæ•°æ®åŒ…çš„é€šè®¯æ–¹å¼ã€‚ ä¾‹å¦‚ï¼šå½“ç”¨æˆ·å¡«å†™å®Œä¸€æ¡ä¿¡æ¯åŽï¼Œè¯¥ä¿¡æ¯ä¼šè‡ªåŠ¨å‘æœåŠ¡å™¨æäº¤ï¼Œç„¶åŽæœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·ä¾ç„¶åœ¨å¡«å†™è¡¨æ ¼çš„ä¿¡æ¯ï¼Œå³å‘æœåŠ¡å™¨è¯·æ±‚å¤šæ¬¡ï¼ŒèŠ‚çœäº†ç”¨æˆ·çš„æ—¶é—´ï¼Œæé«˜äº†ç”¨æˆ·çš„ä½“éªŒã€‚ 3ã€åŒºåˆ«ï¼š åŒæ­¥è¯·æ±‚æ¯”ç€å¼‚æ­¥è¯·æ±‚å°‘äº†ä¸ªXMLhttpRequestå¯¹è±¡ã€‚åœ¨ç”¨æˆ·ä½“éªŒæ–¹é¢ï¼Œå¼‚æ­¥çš„ç”¨æˆ·ä½“éªŒæ›´å¥½ä¸€äº›ã€‚ 7.å‰ç«¯å¼€å‘çš„ä¼˜åŒ–é—®é¢˜ã€‚ï¼ˆ1ï¼‰ å‡å°‘httpè¯·æ±‚æ¬¡æ•°ï¼šcss spirit,data uriï¼ˆ2ï¼‰ JSï¼ŒCSSæºç åŽ‹ç¼©ï¼ˆ3ï¼‰ å‰ç«¯æ¨¡æ¿ JS+æ•°æ®ï¼Œå‡å°‘ç”±äºŽHTMLæ ‡ç­¾å¯¼è‡´çš„å¸¦å®½æµªè´¹ï¼Œå‰ç«¯ç”¨å˜é‡ä¿å­˜AJAXè¯·æ±‚ç»“æžœï¼Œæ¯æ¬¡æ“ä½œæœ¬åœ°å˜é‡ï¼Œä¸ç”¨è¯·æ±‚ï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•°ï¼ˆ4ï¼‰ ç”¨innerHTMLä»£æ›¿DOMæ“ä½œï¼Œå‡å°‘DOMæ“ä½œæ¬¡æ•°ï¼Œä¼˜åŒ–javascriptæ€§èƒ½ï¼ˆ5ï¼‰ ç”¨setTimeoutæ¥é¿å…é¡µé¢å¤±åŽ»å“åº”ï¼ˆ6ï¼‰ ç”¨hash-tableæ¥ä¼˜åŒ–æŸ¥æ‰¾ï¼ˆ7ï¼‰ å½“éœ€è¦è®¾ç½®çš„æ ·å¼å¾ˆå¤šæ—¶è®¾ç½®classNameè€Œä¸æ˜¯ç›´æŽ¥æ“ä½œstyleï¼ˆ8ï¼‰ å°‘ç”¨å…¨å±€å˜é‡ï¼ˆ9ï¼‰ ç¼“å­˜DOMèŠ‚ç‚¹æŸ¥æ‰¾çš„ç»“æžœï¼ˆ10ï¼‰ é¿å…ä½¿ç”¨CSS Expressionï¼ˆ11ï¼‰ å›¾ç‰‡é¢„è½½ï¼ˆ12ï¼‰ é¿å…åœ¨é¡µé¢çš„ä¸»ä½“å¸ƒå±€ä¸­ä½¿ç”¨tableï¼Œtableè¦ç­‰å…¶ä¸­çš„å†…å®¹å®Œå…¨ä¸‹è½½ä¹‹åŽæ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œæ˜¾ç¤ºæ¯”div+csså¸ƒå±€æ…¢ 8.ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿç®€è¨€ä¹‹ï¼Œé—­åŒ…æ˜¯ç”±å‡½æ•°å¼•ç”¨å…¶å‘¨è¾¹çŠ¶æ€ï¼ˆè¯æ³•çŽ¯å¢ƒï¼‰ç»‘åœ¨ä¸€èµ·å½¢æˆçš„ï¼ˆå°è£…ï¼‰ç»„åˆç»“æž„ã€‚åœ¨ JavaScript ä¸­ï¼Œé—­åŒ…åœ¨æ¯ä¸ªå‡½æ•°è¢«åˆ›å»ºæ—¶å½¢æˆã€‚ è¿™æ˜¯åŸºæœ¬åŽŸç†ï¼Œä½†ä¸ºä»€ä¹ˆæˆ‘ä»¬å…³å¿ƒè¿™äº›ï¼Ÿå®žé™…ä¸Šï¼Œç”±äºŽé—­åŒ…ä¸Žå®ƒçš„è¯æ³•çŽ¯å¢ƒç»‘åœ¨ä¸€èµ·ï¼Œå› æ­¤ é—­åŒ…è®©æˆ‘ä»¬èƒ½å¤Ÿä»Žä¸€ä¸ªå‡½æ•°å†…éƒ¨è®¿é—®å…¶å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸã€‚ è¦ä½¿ç”¨é—­åŒ…ï¼Œåªéœ€è¦ç®€å•åœ°å°†ä¸€ä¸ªå‡½æ•°å®šä¹‰åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨ï¼Œå¹¶å°†å®ƒæš´éœ²å‡ºæ¥ã€‚è¦æš´éœ²ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥å°†å®ƒè¿”å›žæˆ–è€…ä¼ ç»™å…¶ä»–å‡½æ•°ã€‚ å†…éƒ¨å‡½æ•°å°†èƒ½å¤Ÿè®¿é—®åˆ°å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œå³ä½¿å¤–éƒ¨å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚ é—­åŒ…çš„ç”¨é€”ä¹‹ä¸€æ˜¯å®žçŽ°å¯¹è±¡çš„ç§æœ‰æ•°æ®ã€‚ 9.Doctypeä½œç”¨ï¼Ÿæ ‡å‡†æ¨¡å¼å’Œå…¼å®¹æ¨¡å¼å„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸDOCTYPEæ˜¯document type(æ–‡æ¡£ç±»åž‹)çš„ç®€å†™,ç”¨æ¥å‘Šè¯‰æµè§ˆå™¨çš„è§£æžå™¨ä½¿ç”¨å“ªç§HTMLæˆ–XHTMLè§„èŒƒè§£æžé¡µé¢ã€‚DOCTYPEä¸å­˜åœ¨æˆ–æ ¼å¼ä¸æ­£ç¡®ä¼šå¯¼è‡´æ–‡æ¡£ä»¥å…¼å®¹æ¨¡å¼å‘ˆçŽ°ã€‚ ä¸ºä»€ä¹ˆHTML5åªè¦å†™&lt;!DOCTYPE HTML&gt; HTML 4.01 åŸºäºŽ SGMLï¼Œéœ€è¦å¯¹ DTD è¿›è¡Œå¼•ç”¨ï¼Œæ‰èƒ½å‘ŠçŸ¥æµè§ˆå™¨æ–‡æ¡£æ‰€ä½¿ç”¨çš„æ–‡æ¡£ç±»åž‹ ã€‚HTML 5 ä¸åŸºäºŽ SGMLï¼Œå› æ­¤ä¸éœ€è¦å¯¹ DTD è¿›è¡Œå¼•ç”¨ï¼Œä½†æ˜¯éœ€è¦ doctype æ¥è§„èŒƒæµè§ˆå™¨çš„è¡Œä¸ºã€‚SGMLæ˜¯æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€,ç®€å•çš„è¯´ï¼Œå°±æ˜¯æ¯”HTML,XMLæ›´è€çš„æ ‡å‡†ï¼Œè¿™ä¸¤è€…éƒ½æ˜¯ç”±SGMLå‘å±•è€Œæ¥çš„ã€‚ä½†æ˜¯ï¼ŒHTML5ä¸æ˜¯çš„ã€‚ æ ‡å‡†æ¨¡å¼ä¸Žå…¼å®¹æ¨¡å¼ï¼ˆæ€ªå¼‚æ¨¡å¼ï¼‰å„æœ‰ä»€ä¹ˆåŒºåˆ«? Standardsï¼ˆæ ‡å‡†ï¼‰æ¨¡å¼ï¼ˆä¹Ÿå°±æ˜¯ä¸¥æ ¼å‘ˆçŽ°æ¨¡å¼ï¼‰ç”¨äºŽå‘ˆçŽ°éµå¾ªæœ€æ–°æ ‡å‡†çš„ç½‘é¡µï¼Œè€ŒQuirksï¼ˆå…¼å®¹ï¼‰æ¨¡å¼ï¼ˆä¹Ÿå°±æ˜¯æ¾æ•£å‘ˆçŽ°æ¨¡å¼æˆ–è€…æ€ªå¼‚æ¨¡å¼ï¼‰ç”¨äºŽå‘ˆçŽ°ä¸ºä¼ ç»Ÿæµè§ˆå™¨è€Œè®¾è®¡çš„ç½‘é¡µã€‚ æ ‡å‡†æ¨¡å¼çš„æŽ’ç‰ˆ å’ŒJSè¿ä½œæ¨¡å¼éƒ½æ˜¯ä»¥è¯¥æµè§ˆå™¨æ”¯æŒçš„æœ€é«˜æ ‡å‡†è¿è¡Œã€‚å…¼å®¹æ¨¡å¼ä¸­ï¼Œé¡µé¢ä»¥å®½æ¾çš„å‘åŽå…¼å®¹çš„æ–¹å¼æ˜¾ç¤º,æ¨¡æ‹Ÿè€å¼æµè§ˆå™¨çš„è¡Œä¸ºä»¥é˜²æ­¢ç«™ç‚¹æ— æ³•å·¥ä½œã€‚ç®€å•è¯´å°±æ˜¯å°½å¯èƒ½çš„æ˜¾ç¤ºèƒ½æ˜¾ç¤ºçš„ä¸œè¥¿ç»™ç”¨æˆ·çœ‹ã€‚ å…·ä½“åŒºåˆ«ï¼š1.ç›’æ¨¡åž‹ åœ¨ä¸¥æ ¼æ¨¡å¼ä¸­ ï¼šwidthæ˜¯å†…å®¹å®½åº¦ ï¼Œå…ƒç´ çœŸæ­£çš„å®½åº¦ = width; åœ¨å…¼å®¹æ¨¡å¼ä¸­ ï¼šwidthåˆ™æ˜¯=width+padding+border 2.å…¼å®¹æ¨¡å¼ä¸‹å¯è®¾ç½®ç™¾åˆ†æ¯”çš„é«˜åº¦å’Œè¡Œå†…å…ƒç´ çš„é«˜å®½ åœ¨Standardsæ¨¡å¼ä¸‹ï¼Œç»™spanç­‰è¡Œå†…å…ƒç´ è®¾ç½®wdithå’Œheightéƒ½ä¸ä¼šç”Ÿæ•ˆï¼Œè€Œåœ¨å…¼å®¹æ¨¡å¼ä¸‹ï¼Œåˆ™ä¼šç”Ÿæ•ˆã€‚ åœ¨standardsæ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªå…ƒç´ çš„é«˜åº¦æ˜¯ç”±å…¶åŒ…å«çš„å†…å®¹æ¥å†³å®šçš„ï¼Œå¦‚æžœçˆ¶å…ƒç´ æ²¡æœ‰è®¾ç½®é«˜åº¦ï¼Œå­å…ƒç´ è®¾ç½®ä¸€ä¸ªç™¾åˆ†æ¯”çš„é«˜åº¦æ˜¯æ— æ•ˆçš„ã€‚ 3.ç”¨margin:0 autoè®¾ç½®æ°´å¹³å±…ä¸­åœ¨IEä¸‹ä¼šå¤±æ•ˆ ä½¿ç”¨margin:0 autoåœ¨standardsæ¨¡å¼ä¸‹å¯ä»¥ä½¿å…ƒç´ æ°´å¹³å±…ä¸­ï¼Œä½†åœ¨å…¼å®¹æ¨¡å¼ä¸‹å´ä¼šå¤±æ•ˆï¼ˆç”¨text-alignå±žæ€§è§£å†³ï¼‰ body{text-align:center};#content{text-align:left} 4.å…¼å®¹æ¨¡å¼ä¸‹Tableä¸­çš„å­—ä½“å±žæ€§ä¸èƒ½ç»§æ‰¿ä¸Šå±‚çš„è®¾ç½®ï¼Œwhite-space:preä¼šå¤±æ•ˆï¼Œè®¾ç½®å›¾ç‰‡çš„paddingä¼šå¤±æ•ˆ 10.å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æœ‰å“ªäº›ï¼ŸTrident-IEæµè§ˆå™¨å†…æ ¸Gecko-ç«ç‹æµè§ˆå™¨å†…æ ¸MozillaBlink(Webkitçš„åˆ†æ”¯)-è°·æ­Œæµè§ˆå™¨å†…æ ¸Prestoï¼ŒçŽ°ä¸ºBlink-Operaæµè§ˆå™¨å†…æ ¸ 11.HTML5çš„æ–°ç‰¹æ€§ï¼Ÿ1.è¯­æ„ç‰¹æ€§,æ·»åŠ &lt;header&gt;&lt;header/&gt;&lt;nav&gt;&lt;nav&gt;ç­‰æ ‡ç­¾2.å¤šåª’ä½“ï¼Œ ç”¨äºŽåª’ä»‹å›žæ”¾çš„ video å’Œ audio å…ƒç´ 3.å›¾åƒæ•ˆæžœï¼Œç”¨äºŽç»˜ç”»çš„ canvas å…ƒç´ ï¼Œsvgå…ƒç´ ç­‰4.ç¦»çº¿ &amp; å­˜å‚¨,å¯¹æœ¬åœ°ç¦»çº¿å­˜å‚¨çš„æ›´å¥½çš„æ”¯æŒ,local Store,Cookiesç­‰5.è®¾å¤‡å…¼å®¹ç‰¹æ€§ ï¼ŒHTML5æä¾›äº†å‰æ‰€æœªæœ‰çš„æ•°æ®ä¸Žåº”ç”¨æŽ¥å…¥å¼€æ”¾æŽ¥å£ã€‚ä½¿å¤–éƒ¨åº”ç”¨å¯ä»¥ç›´æŽ¥ä¸Žæµè§ˆå™¨å†…éƒ¨çš„æ•°æ®ç›´æŽ¥ç›¸è¿žï¼Œ6.è¿žæŽ¥ç‰¹æ€§ï¼Œæ›´æœ‰æ•ˆçš„è¿žæŽ¥å·¥ä½œæ•ˆçŽ‡ï¼Œä½¿å¾—åŸºäºŽé¡µé¢çš„å®žæ—¶èŠå¤©ï¼Œæ›´å¿«é€Ÿçš„ç½‘é¡µæ¸¸æˆä½“éªŒï¼Œæ›´ä¼˜åŒ–çš„åœ¨çº¿äº¤æµå¾—åˆ°äº†å®žçŽ°ã€‚HTML5æ‹¥æœ‰æ›´æœ‰æ•ˆçš„æœåŠ¡å™¨æŽ¨é€æŠ€æœ¯ï¼ŒServer-Sent Eventå’ŒWebSocketså°±æ˜¯å…¶ä¸­çš„ä¸¤ä¸ªç‰¹æ€§ï¼Œè¿™ä¸¤ä¸ªç‰¹æ€§èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å®žçŽ°æœåŠ¡å™¨å°†æ•°æ®â€œæŽ¨é€â€åˆ°å®¢æˆ·ç«¯çš„åŠŸèƒ½7.æ€§èƒ½ä¸Žé›†æˆç‰¹æ€§ï¼ŒHTML5ä¼šé€šè¿‡XMLHttpRequest2ç­‰æŠ€æœ¯ï¼Œå¸®åŠ©æ‚¨çš„Webåº”ç”¨å’Œç½‘ç«™åœ¨å¤šæ ·åŒ–çš„çŽ¯å¢ƒä¸­æ›´å¿«é€Ÿçš„å·¥ä½œ 12.å¦‚ä½•å¤„ç†HTML5æ–°æ ‡ç­¾çš„æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Ÿdocument.createElementï¼ˆâ€˜æ–°æ ‡ç­¾â€™ï¼‰; / /æ–°å¢žåˆ›å»ºæ–°æ ‡ç­¾å†è€…è¿˜æœ‰ä¸€ç§åŠžæ³•å°±æ˜¯ç”¨æ¡†æž¶çš„æ–¹æ³•ï¼Œç”¨åˆ°æ¡ä»¶æ³¨é‡ŠåŠ JSä»£ç å®žçŽ° 123&lt;!--[if lt IE 9]&gt;&lt;script&gt; src="http://html5shim.googlecode.com/svn/trunk/html5.js"&lt;/script&gt;&lt;![endif]--&gt; ç›´æŽ¥åŠ å…¥è¿™ä¸€å¥ä»£ç å°±å¯å®žçŽ°å…¼å®¹é—®é¢˜ï¼Œå…³äºŽæ¡ä»¶æ³¨æ„ä¸­çš„ 1&lt;!--if lt IE9&gt; 13.å¦‚ä½•åŒºåˆ†HTMLå’ŒHTML5ï¼Ÿ1.åœ¨æ–‡æ¡£ç±»åž‹å£°æ˜Žä¸Š html: 1234&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt; HTML5: 1&lt;!DOCTYPE html&gt; ç”±è¿™ä¸¤è€…å¯¹æ¯”å¯è§ï¼šåœ¨æ–‡æ¡£å£°æ˜Žä¸Šï¼Œhtmlæœ‰å¾ˆé•¿çš„ä¸€æ®µä»£ç ï¼Œå¹¶ä¸”å¾ˆéš¾è®°ä½è¿™æ®µä»£ç ï¼Œæƒ³å¿…å¾ˆå¤šäººéƒ½æ˜¯é å·¥å…·ç›´æŽ¥ç”Ÿæˆçš„å§ï¼Ÿè€Œhtml5å´æ˜¯ä¸åŒï¼Œåªæœ‰ç®€ç®€å•å•çš„å£°æ˜Žï¼Œè¿™ä¹Ÿæ–¹ä¾¿äººä»¬çš„è®°å¿†ï¼Œæ›´åŠ ç²¾ç®€ã€‚ 2.åœ¨ç»“æž„è¯­ä¹‰ä¸Š html4.0ï¼šæ²¡æœ‰ä½“çŽ°ç»“æž„è¯­ä¹‰åŒ–çš„æ ‡ç­¾ï¼Œæˆ‘ä»¬é€šå¸¸éƒ½æ˜¯è¿™æ ·æ¥å‘½åçš„1&lt;divid="header"&gt;&lt;/div&gt; è¿™æ ·è¡¨ç¤ºç½‘ç«™çš„å¤´éƒ¨ã€‚ html5ï¼šåœ¨è¯­ä¹‰ä¸Šå´æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ã€‚æä¾›äº†ä¸€äº›æ–°çš„html5æ ‡ç­¾ï¼Œæ¯”å¦‚:1&lt;header&gt; ã€&lt;nav&gt;ã€&lt;article&gt;ã€&lt;aside&gt;ã€&lt;footer&gt;.. 3.å¼ºå¤§çš„HTML5çš„æ–°åŠŸèƒ½ ï¼ˆ1ï¼‰å¼ºå¤§çš„ç»˜å›¾åŠŸèƒ½ï¼ˆ2ï¼‰æ–°å¢žè§†é¢‘æ ‡ç­¾ 14.æè¿°cookieï¼ŒsessionStorageå’ŒlocalStorageçš„åŒºåˆ«ï¼Ÿä¸‰è€…çš„å¼‚åŒ ç‰¹æ€§ Cookie localStorage sessionStorageæ•°æ®çš„ç”Ÿå‘½æœŸ ä¸€èˆ¬ç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå¯è®¾ç½®å¤±æ•ˆæ—¶é—´ã€‚å¦‚æžœåœ¨æµè§ˆå™¨ç«¯ç”ŸæˆCookieï¼Œé»˜è®¤æ˜¯å…³é—­æµè§ˆå™¨åŽå¤±æ•ˆ é™¤éžè¢«æ¸…é™¤ï¼Œå¦åˆ™æ°¸ä¹…ä¿å­˜ ä»…åœ¨å½“å‰ä¼šè¯ä¸‹æœ‰æ•ˆï¼Œå…³é—­é¡µé¢æˆ–æµè§ˆå™¨åŽè¢«æ¸…é™¤å­˜æ”¾æ•°æ®å¤§å° 4Kå·¦å³ ä¸€èˆ¬ä¸º5MBä¸ŽæœåŠ¡å™¨ç«¯é€šä¿¡ æ¯æ¬¡éƒ½ä¼šæºå¸¦åœ¨HTTPå¤´ä¸­ï¼Œå¦‚æžœä½¿ç”¨cookieä¿å­˜è¿‡å¤šæ•°æ®ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ ä»…åœ¨å®¢æˆ·ç«¯ï¼ˆå³æµè§ˆå™¨ï¼‰ä¸­ä¿å­˜ï¼Œä¸å‚ä¸Žå’ŒæœåŠ¡å™¨çš„é€šä¿¡æ˜“ç”¨æ€§ éœ€è¦ç¨‹åºå‘˜è‡ªå·±å°è£…ï¼Œæºç”Ÿçš„CookieæŽ¥å£ä¸å‹å¥½ æºç”ŸæŽ¥å£å¯ä»¥æŽ¥å—ï¼Œäº¦å¯å†æ¬¡å°è£…æ¥å¯¹Objectå’ŒArrayæœ‰æ›´å¥½çš„æ”¯æŒ 15.å¦‚ä½•å®žçŽ°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡ï¼Ÿæœ¬é¢˜ä¸»è¦è€ƒå¯Ÿæ•°æ®å­˜å‚¨çš„çŸ¥è¯†ï¼Œæ•°æ®å­˜å‚¨æœ‰æœ¬åœ°å’ŒæœåŠ¡å™¨å­˜å‚¨ä¸¤ç§æ–¹å¼ã€‚è¿™é‡Œä¸»è¦è®²è§£ç”¨æœ¬åœ°å­˜å‚¨æ–¹å¼è§£å†³ã€‚å³è°ƒç”¨ localStorageã€Cookieç­‰æœ¬åœ°å­˜å‚¨æ–¹å¼ã€‚ ç¬¬ä¸€ç§â€”â€”è°ƒç”¨localStorageç¬¬äºŒç§â€”â€”è°ƒç”¨cookie+setInterval() 16.Strongå’Œemçš„å¼‚åŒï¼Ÿåœ¨æµè§ˆå™¨ä¸­ï¼Œ&lt;em&gt; é»˜è®¤ç”¨æ–œä½“è¡¨ç¤ºï¼Œ&lt;strong&gt; ç”¨ç²—ä½“è¡¨ç¤ºã€‚ä»Žæ ·å¼è¡¨çŽ°ä¸Šï¼Œ&lt;strong&gt; æ›´åŠ çªå‡ºï¼Œæ›´å®¹æ˜“å¸å¼•çœ¼å…‰ã€‚æ˜¾ç„¶ï¼Œè¿™ç§è§†è§‰ä¸Šçš„å·®å¼‚è®¾è®¡æ˜¯æœ‰ç›®çš„çš„ã€‚ em è¡¨ç¤ºå†…å®¹çš„ç€é‡ç‚¹ï¼ˆstress emphasisï¼‰ï¼Œæ”¾ç½®çš„ä½ç½®ä¼šæ”¹å˜æ‰€åœ¨å¥å­çš„å«ä¹‰ã€‚strong è¡¨ç¤ºå†…å®¹çš„é‡è¦æ€§ï¼ˆstrong importanceï¼‰ï¼Œå¼ºè°ƒå¥å­çš„é‡è¦æ€§è€Œä¸ä¼šæ”¹å˜æ‰€åœ¨å¥å­çš„è¯­æ„ã€‚ 17.ç®€è¿°srcå’Œhrefçš„åŒºåˆ«ï¼Ÿhref æ—¶æŒ‡å‘ç½‘ç»œèµ„æºæ‰€åœ¨ä½ç½®ï¼Œå»ºç«‹å’Œå½“å‰å…ƒç´ ï¼ˆé”šç‚¹ï¼‰æˆ–å½“å‰æ–‡æ¡£ï¼ˆé“¾æŽ¥ï¼‰ä¹‹é—´çš„é“¾æŽ¥ï¼Œç”¨äºŽè¶…é“¾æŽ¥ã€‚src æ—¶æŒ‡å‘å¤–éƒ¨çš„èµ„æºä½ç½®ï¼ŒæŒ‡å‘çš„å†…å®¹å°†ä¼šåµŒå…¥åˆ°æ–‡æ¡£ä¸­å½“å‰æ ‡ç­¾æ‰€åœ¨ä½ç½®ï¼›åœ¨è¯·æ±‚ src èµ„æºæ—¶ä¼šå°†å…¶æŒ‡å‘çš„èµ„æºä¸‹è½½å¹¶åº”ç”¨åˆ°æ–‡æ¡£å†…ï¼Œä¾‹å¦‚ js è„šæœ¬ï¼Œimg å›¾ç‰‡å’Œ frame ç­‰å…ƒç´ ã€‚ å½“æµè§ˆå™¨è§£æžåˆ°è¯¥å…ƒç´ æ—¶ï¼Œä¼šæš‚åœå…¶ä»–èµ„æºçš„ä¸‹è½½å’Œå¤„ç†ï¼Œç›´åˆ°å°†è¯¥èµ„æºåŠ è½½ã€ç¼–è¯‘ã€æ‰§è¡Œå®Œæ¯• ï¼Œå›¾ç‰‡å’Œæ¡†æž¶ç­‰å…ƒç´ ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œç±»ä¼¼äºŽå°†æ‰€æŒ‡å‘èµ„æºåµŒå…¥å½“å‰æ ‡ç­¾å†…ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå°† js è„šæœ¬æ”¾åœ¨åº•éƒ¨è€Œä¸æ˜¯å¤´éƒ¨ã€‚ 18.Cssé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€Žæ ·å®šä¹‰çš„ï¼Ÿå…³äºŽä¼˜å…ˆçº§çš„è§„å®šï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯ç»™ä¸åŒçš„é€‰æ‹©å™¨åˆ†é…æƒå€¼ï¼š idé€‰æ‹©å™¨ä¼˜å…ˆçº§å¾ˆé«˜ï¼Œæƒå€¼ä¸º100 classã€å±žæ€§å’Œä¼ªç±»é€‰æ‹©å™¨çš„æƒå€¼ä¸º10 æ ‡ç­¾é€‰æ‹©å™¨æƒå€¼ä¸º1 åœ¨æ¯”è¾ƒæ ·å¼çš„ä¼˜å…ˆçº§æ—¶ï¼Œåªéœ€ç»Ÿè®¡é€‰æ‹©ç¬¦ä¸­çš„idã€classå’Œæ ‡ç­¾åçš„ä¸ªæ•°ï¼Œç„¶åŽæŠŠç›¸åº”çš„æƒå€¼ç›¸åŠ å³å¯ï¼Œæœ€åŽæ ¹æ®ç»“æžœæŽ’å‡ºä¼˜å…ˆçº§ æƒå€¼è¾ƒå¤§çš„ä¼˜å…ˆçº§è¶Šé«˜ æƒå€¼ç›¸åŒçš„ï¼ŒåŽå®šä¹‰çš„ä¼˜å…ˆçº§è¾ƒé«˜ æ ·å¼å€¼å«æœ‰!importantï¼Œä¼˜å…ˆçº§æœ€é«˜ 19.è¶…é“¾æŽ¥è®¿é—®è¿‡åŽhoveræ ·å¼å°±ä¸å‡ºçŽ°çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿè¢«ç‚¹å‡»è®¿é—®è¿‡çš„è¶…é“¾æŽ¥æ ·å¼ä¸åœ¨å…·æœ‰hoverå’Œactiveäº†è§£å†³æ–¹æ³•æ˜¯æ”¹å˜CSSå±žæ€§çš„æŽ’åˆ—é¡ºåº: L-V-H-Aï¼ˆlink,visited,hover,activeï¼‰ 20.è¡Œå†…æ ·å¼å’Œå—çº§å…ƒç´ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿå—çº§å…ƒç´ ä¼šç‹¬å ä¸€è¡Œ,é»˜è®¤æƒ…å†µä¸‹,å…¶å®½åº¦è‡ªåŠ¨å¡«æ»¡å…¶çˆ¶å…ƒç´ å®½åº¦.è¡Œå†…å…ƒç´ ä¸ä¼šç‹¬å ä¸€è¡Œ,ç›¸é‚»çš„è¡Œå†…å…ƒç´ ä¼šæŽ’åˆ—åœ¨åŒä¸€è¡Œé‡Œ,ç›´åˆ°ä¸€è¡ŒæŽ’ä¸ä¸‹,æ‰ä¼šæ¢è¡Œ,å…¶å®½åº¦éšå…ƒç´ çš„å†…å®¹è€Œå˜åŒ–.å—çº§å…ƒç´ å¯ä»¥è®¾ç½®width,heightå±žæ€§.è¡Œå†…å…ƒç´ è®¾ç½®width,heightå±žæ€§æ— æ•ˆ. 20.è¡Œå†…å…ƒç´ å¯ä»¥çš„paddingå’Œmarginå¯è®¾ç½®ä¹ˆï¼Ÿåªèƒ½è®¾ç½®å·¦å³çš„paddingå’Œmarginã€‚ 21.Cssä¸­å¯ä»¥è®©æ–‡å­—åœ¨åž‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±žæ€§æ˜¯ä»€ä¹ˆï¼Ÿ12text-align: center;vertical-align: middle; 22.Pxå’Œem,remçš„åŒºåˆ«ï¼Ÿpxåƒç´ ï¼ˆPixelï¼‰ã€‚ç›¸å¯¹é•¿åº¦å•ä½ã€‚åƒç´ pxæ˜¯ç›¸å¯¹äºŽæ˜¾ç¤ºå™¨å±å¹•åˆ†è¾¨çŽ‡è€Œè¨€çš„ã€‚(å¼•è‡ªCSS2.0æ‰‹å†Œ) emæ˜¯ç›¸å¯¹é•¿åº¦å•ä½ã€‚ç›¸å¯¹äºŽå½“å‰å¯¹è±¡å†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸ã€‚å¦‚å½“å‰å¯¹è¡Œå†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸æœªè¢«äººä¸ºè®¾ç½®ï¼Œåˆ™ç›¸å¯¹äºŽæµè§ˆå™¨çš„é»˜è®¤å­—ä½“å°ºå¯¸ã€‚(å¼•è‡ªCSS2.0æ‰‹å†Œ) EMç‰¹ç‚¹ emçš„å€¼å¹¶ä¸æ˜¯å›ºå®šçš„ï¼› emä¼šç»§æ‰¿çˆ¶çº§å…ƒç´ çš„å­—ä½“å¤§å°ã€‚ æ‰€ä»¥æˆ‘ä»¬åœ¨å†™CSSçš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š bodyé€‰æ‹©å™¨ä¸­å£°æ˜ŽFont-size=62.5%ï¼› å°†ä½ çš„åŽŸæ¥çš„pxæ•°å€¼é™¤ä»¥10ï¼Œç„¶åŽæ¢ä¸Šemä½œä¸ºå•ä½ï¼› é‡æ–°è®¡ç®—é‚£äº›è¢«æ”¾å¤§çš„å­—ä½“çš„emæ•°å€¼ã€‚é¿å…å­—ä½“å¤§å°çš„é‡å¤å£°æ˜Žã€‚ remæ˜¯CSS3æ–°å¢žçš„ä¸€ä¸ªç›¸å¯¹å•ä½ï¼ˆroot emï¼Œæ ¹emï¼‰ï¼Œè¿™ä¸ªå•ä½å¼•èµ·äº†å¹¿æ³›å…³æ³¨ã€‚è¿™ä¸ªå•ä½ä¸Žemæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ åŒºåˆ«åœ¨äºŽä½¿ç”¨remä¸ºå…ƒç´ è®¾å®šå­—ä½“å¤§å°æ—¶ï¼Œä»ç„¶æ˜¯ç›¸å¯¹å¤§å°ï¼Œä½†ç›¸å¯¹çš„åªæ˜¯HTMLæ ¹å…ƒç´ ã€‚è¿™ä¸ªå•ä½å¯è°“é›†ç›¸å¯¹å¤§å°å’Œç»å¯¹å¤§å°çš„ä¼˜ç‚¹äºŽä¸€èº«ï¼Œé€šè¿‡å®ƒæ—¢å¯ä»¥åšåˆ°åªä¿®æ”¹æ ¹å…ƒç´ å°±æˆæ¯”ä¾‹åœ°è°ƒæ•´æ‰€æœ‰å­—ä½“å¤§å°ï¼Œåˆå¯ä»¥é¿å…å­—ä½“å¤§å°é€å±‚å¤åˆçš„è¿žé”ååº” 23.è¯´å‡ºä½ ç†Ÿæ‚‰çš„ä¸¤ä¸ªcssé¢„å¤„ç†å™¨çš„åŒºåˆ«ï¼ŸSassä¸Žlessä¸‹é¢ä»Žç‰¹æ€§ä¸Šæ¯”è¾ƒä¸‰è€…å¼‚åŒï¼š1.å˜é‡ï¼š Sasså£°æ˜Žå˜é‡å¿…é¡»æ˜¯ã€Ž$ã€å¼€å¤´ï¼ŒåŽé¢ç´§è·Ÿå˜é‡åå’Œå˜é‡å€¼ï¼Œè€Œä¸”å˜é‡åå’Œå˜é‡å€¼éœ€è¦ä½¿ç”¨å†’å·ï¼šåˆ†éš”å¼€ã€‚Less å£°æ˜Žå˜é‡ç”¨ã€Ž@ã€å¼€å¤´ï¼Œå…¶ä½™ç­‰åŒ Sassã€‚Stylus ä¸­å£°æ˜Žå˜é‡æ²¡æœ‰ä»»ä½•é™å®šï¼Œç»“å°¾çš„åˆ†å·å¯æœ‰å¯æ— ï¼Œä½†å˜é‡åå’Œå˜é‡å€¼ä¹‹é—´å¿…é¡»è¦æœ‰ã€Žç­‰å·ã€ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœç”¨â€œ@â€ç¬¦å·æ¥å£°æ˜Žå˜é‡ï¼ŒStylusä¼šè¿›è¡Œç¼–è¯‘ï¼Œä½†ä¸ä¼šèµ‹å€¼ç»™å˜é‡ã€‚å°±æ˜¯è¯´ï¼ŒStylus ä¸è¦ä½¿ç”¨ã€Ž@ã€å£°æ˜Žå˜é‡ã€‚Stylus è°ƒç”¨å˜é‡çš„æ–¹æ³•å’ŒLessã€Sasså®Œå…¨ç›¸åŒã€‚2.ä½œç”¨åŸŸï¼š css é¢„ç¼–è¯‘å™¨æŠŠå˜é‡èµ‹äºˆä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨ç”Ÿå‘½å‘¨æœŸã€‚å°±åƒ js ä¸€æ ·ï¼Œå®ƒä¼šå…ˆä»Žå±€éƒ¨ä½œç”¨åŸŸæŸ¥æ‰¾å˜é‡ï¼Œä¾æ¬¡å‘ä¸Šçº§ä½œç”¨åŸŸæŸ¥æ‰¾ã€‚ Sassï¼šä¸‰è€…æœ€å·®ï¼Œä¸å­˜åœ¨å…¨å±€å˜é‡çš„æ¦‚å¿µã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ Sass ä¸­å®šä¹‰äº†ç›¸åŒåå­—çš„å˜é‡æ—¶ä½ å°±è¦å°å¿ƒè›‹ç–¼äº†ã€‚Lessï¼šæˆ‘è®¤ä¸ºè·Ÿ JS ä¸€æ ·ï¼Œé€çº§æŸ¥æ‰¾ï¼Œå‘ä¸Šå†’æ³¡ã€‚Stylusï¼šå®Œå…¨ç­‰åŒ Lessã€‚Stylus å’Œ Sass åˆ™æ›´å€¾å‘äºŽæŒ‡ä»¤å¼ã€‚ 3.åµŒå¥—ï¼š ååˆ†çœŸè¯šçš„è¯´ï¼Œä¸‰ç§ css é¢„ç¼–è¯‘å™¨çš„ã€Œé€‰æ‹©å™¨åµŒå¥—ã€åœ¨ä½¿ç”¨ä¸Šæ¥è¯´æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘æ²¡å‘çŽ°ï¼‰ã€‚Sass é™¤äº†å¸¸è§„çš„é‡‡ç”¨ã€Ž&amp;ã€æ›¿ä»£çˆ¶çº§é€‰æ‹©å™¨ä¹‹å¤–ï¼Œè¿˜æä¾›äº†ã€Œå¥‡è‘©çš„å±žæ€§åµŒå¥—ã€ï¼š 12345678/*style.sass*/.footer &#123; font: &#123; family: å¾®è½¯é›…é»‘; size: 5rem; weight: bolder; &#125;&#125; 4.ç»§æ‰¿ï¼š css å±žæ€§çš„ç»§æ‰¿æ˜¯ä¸€ä¸ªéžå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œå¥½æ¶ˆæ¯æ˜¯ä¸‰ç§é¢„ç¼–è¯‘å™¨éƒ½å¯¹æ­¤åšå‡ºäº†æ”¹å–„ã€‚ Sasså’ŒStylusçš„ç»§æ‰¿éžå¸¸åƒï¼Œèƒ½æŠŠä¸€ä¸ªé€‰æ‹©å™¨çš„æ‰€æœ‰æ ·å¼ç»§æ‰¿åˆ°å¦ä¸€ä¸ªé€‰æ‹©å™¨ä¸Šã€‚ä½¿ç”¨ã€Ž@extendã€å¼€å§‹ï¼ŒåŽé¢æŽ¥è¢«ç»§æ‰¿çš„é€‰æ‹©å™¨ã€‚ 123456789101112.shit &#123; margin: 10px 5px; padding: 2px;&#125;p &#123; @extend .shit;/*ç»§æ‰¿.block*/ border: 1px solid #aaa;&#125;ul,li &#123; @extend .shit; /*ç»§æ‰¿.block*/ color: #aaa;&#125; å°†è¢«ç¼–è¯‘æˆæ ‡å‡† cssï¼š 12345678910.shit,p,ul,ol &#123; margin: 10px 5px; padding:2px;&#125;p &#123; border: 1px solid #aaa&#125;ul,li &#123; color:#aaa;&#125; Less ç»§æ‰¿ï¼šä¸Žå‰ä¸¤è€…ç»§æ‰¿æ–¹å¼æœ‰æ‰€åŒºåˆ«ï¼Œå®ƒä¸æ˜¯åœ¨é€‰æ‹©å™¨ä¸Šç»§æ‰¿ï¼Œè€Œæ˜¯å°†Mixinsä¸­çš„æ ·å¼åµŒå¥—åˆ°æ¯ä¸ªé€‰æ‹©å™¨é‡Œé¢ã€‚ç„¶è€Œè¿™æ ·ä¼šå¸¦æ¥ä¸€ä¸ªæ˜Žæ˜¾çš„ç¼ºç‚¹ï¼šæ¯ä¸ªé€‰æ‹©å™¨ä¸­ä¼šå‡ºçŽ°é‡å¤çš„æ ·å¼ã€‚ 5.å¯¼å…¥@Importï¼š CSSä¸­ï¼Œä¸å»ºè®®ç”¨@importå¯¼å…¥cssï¼Œå› ä¸ºä¼šå¢žåŠ httpè¯·æ±‚ã€‚ä½† CSS é¢„å¤„ç†å™¨ä¸­çš„å¯¼å…¥å’ŒCSSçš„æœ‰hheå¾ˆå¤§åŒºåˆ«ï¼Œå®ƒæ˜¯å°†ä¸åŒ css æ˜¯åœ¨è¯­ä¹‰ä¸Šå¯¼å…¥ï¼Œæœ€ç»ˆç¼–è¯‘ç»“æžœä¼šç”Ÿæˆä¸€ä¸ªCSSæ–‡ä»¶ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœä¸åŒæ–‡ä»¶ç›¸äº’å¼•å…¥çš„æ—¶å€™ï¼Œå‡ºçŽ°ç›¸åŒå˜é‡åæ—¶å¯èƒ½ä¼šå¼•èµ·é”™è¯¯ã€‚æ‰€ä»¥æˆ‘çš„å»ºè®®æ˜¯å•ç‹¬æœ‰ä¸€ä¸ª var.sass/less/styl æ–‡ä»¶æ¥è®°å½•æ‰€æœ‰ä½ å®šä¹‰çš„å˜é‡ã€‚ Less ä¸º@Import æ‰©å±•äº†è¯­æ³•ï¼Œè€Œ Sass å’Œ Stylus å¹¶æ²¡æœ‰ã€‚å…·ä½“æ‰©å±•çš„ import è¯­æ³•è¯·è§ï¼šLess çš„ Import æ‰©å±• 24.â€œuser strictâ€æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ - æ¶ˆé™¤Javascriptè¯­æ³•çš„ä¸€äº›ä¸åˆç†ã€ä¸ä¸¥è°¨ä¹‹å¤„ï¼Œå‡å°‘ä¸€äº›æ€ªå¼‚è¡Œä¸º; - æ¶ˆé™¤ä»£ç è¿è¡Œçš„ä¸€äº›ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç è¿è¡Œçš„å®‰å…¨ï¼› - æé«˜ç¼–è¯‘å™¨æ•ˆçŽ‡ï¼Œå¢žåŠ è¿è¡Œé€Ÿåº¦ï¼› - ä¸ºæœªæ¥æ–°ç‰ˆæœ¬çš„Javascriptåšå¥½é“ºåž«ã€‚ 25.JavaScriptå¦‚ä½•å®žçŽ°ç»§æ‰¿ï¼Ÿç»§æ‰¿ 26.å¯¹thisæŒ‡é’ˆçš„ç†è§£ï¼Œå¯ä»¥åˆ—ä¸¾å‡ ç§æƒ…å†µï¼ŸthisæŒ‡çš„æ˜¯ï¼šè°ƒç”¨å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ã€‚ a. çº¯ç²¹çš„å‡½æ•°è°ƒç”¨ï¼Œå±žäºŽå…¨å±€æ€§è°ƒç”¨ï¼Œå› æ­¤thiså°±ä»£è¡¨å…¨å±€å¯¹è±¡Globalã€‚ b. ä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ï¼Œè¿™æ—¶thiså°±æŒ‡è¿™ä¸ªä¸Šçº§å¯¹è±¡ã€‚ c. ä½œä¸ºæž„é€ å‡½æ•°è°ƒç”¨ï¼Œå°±æ˜¯é€šè¿‡è¿™ä¸ªå‡½æ•°newä¸€ä¸ªæ–°å¯¹è±¡ï¼ˆobjectï¼‰ã€‚è¿™æ—¶ï¼Œthiså°±æŒ‡è¿™ä¸ªæ–°å¯¹è±¡ã€‚ d. applyä¸Žcallçš„è°ƒç”¨ï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯æ”¹å˜å‡½æ•°çš„è°ƒç”¨å¯¹è±¡ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å°±è¡¨ç¤ºæ”¹å˜åŽçš„è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„å¯¹è±¡ã€‚ 27.Mvvmæ¡†æž¶å’Œmvcæœ‰ä»€ä¹ˆä¸åŒï¼Ÿåœ¨MVCé‡Œï¼ŒViewæ˜¯å¯ä»¥ç›´æŽ¥è®¿é—®Modelçš„ï¼ä»Žè€Œï¼ŒViewé‡Œä¼šåŒ…å«Modelä¿¡æ¯ï¼Œä¸å¯é¿å…çš„è¿˜è¦åŒ…æ‹¬ä¸€äº›ä¸šåŠ¡é€»è¾‘ã€‚ MVCæ¨¡åž‹å…³æ³¨çš„æ˜¯Modelçš„ä¸å˜ï¼Œæ‰€ä»¥ï¼Œåœ¨MVCæ¨¡åž‹é‡Œï¼ŒModelä¸ä¾èµ–äºŽViewï¼Œä½†æ˜¯ Viewæ˜¯ä¾èµ–äºŽModelçš„ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå› ä¸ºæœ‰ä¸€äº›ä¸šåŠ¡é€»è¾‘åœ¨Viewé‡Œå®žçŽ°äº†ï¼Œå¯¼è‡´è¦æ›´æ”¹Viewä¹Ÿæ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œè‡³å°‘é‚£äº›ä¸šåŠ¡é€»è¾‘æ˜¯æ— æ³•é‡ç”¨çš„ã€‚MVVMåœ¨æ¦‚å¿µä¸Šæ˜¯çœŸæ­£å°†é¡µé¢ä¸Žæ•°æ®é€»è¾‘åˆ†ç¦»çš„æ¨¡å¼ï¼Œå®ƒæŠŠæ•°æ®ç»‘å®šå·¥ä½œæ”¾åˆ°ä¸€ä¸ªJSé‡ŒåŽ»å®žçŽ°ï¼Œè€Œè¿™ä¸ªJSæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯å®Œæˆæ•°æ®çš„ç»‘å®šï¼Œå³æŠŠmodelç»‘å®šåˆ°UIçš„å…ƒç´ ä¸Šã€‚æœ‰äººåšè¿‡æµ‹è¯•ï¼šä½¿ç”¨Angularï¼ˆMVVMï¼‰ä»£æ›¿Backboneï¼ˆMVCï¼‰æ¥å¼€å‘ï¼Œä»£ç å¯ä»¥å‡å°‘ä¸€åŠã€‚æ­¤å¤–ï¼ŒMVVMå¦ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼ŒåŒå‘ç»‘å®šã€‚å®ƒæ›´æ–¹ä¾¿ä½ åŒæ—¶ç»´æŠ¤é¡µé¢ä¸Šéƒ½ä¾èµ–äºŽæŸä¸ªå­—æ®µçš„Nä¸ªåŒºåŸŸï¼Œè€Œä¸ç”¨æ‰‹åŠ¨æ›´æ–°å®ƒä»¬ã€‚ 28.å¦‚ä½•èŽ·å–JavaScriptå˜é‡çš„ç±»åž‹ï¼Ÿ1ã€typeoftypeof æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œå…¶å³ä¾§è·Ÿä¸€ä¸ªä¸€å…ƒè¡¨è¾¾å¼ï¼Œå¹¶è¿”å›žè¿™ä¸ªè¡¨è¾¾å¼çš„æ•°æ®ç±»åž‹ã€‚è¿”å›žçš„ç»“æžœç”¨è¯¥ç±»åž‹çš„å­—ç¬¦ä¸²(å…¨å°å†™å­—æ¯)å½¢å¼è¡¨ç¤ºï¼ŒåŒ…æ‹¬ä»¥ä¸‹ 7 ç§ï¼šnumberã€booleanã€symbolã€stringã€objectã€undefinedã€function ç­‰ã€‚ 2ã€instanceofinstanceof æ˜¯ç”¨æ¥åˆ¤æ–­ A æ˜¯å¦ä¸º B çš„å®žä¾‹ï¼Œè¡¨è¾¾å¼ä¸ºï¼šA instanceof Bï¼Œå¦‚æžœ A æ˜¯ B çš„å®žä¾‹ï¼Œåˆ™è¿”å›ž true,å¦åˆ™è¿”å›ž falseã€‚ åœ¨è¿™é‡Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼šinstanceof æ£€æµ‹çš„æ˜¯åŽŸåž‹ï¼Œæˆ‘ä»¬ç”¨ä¸€æ®µä¼ªä»£ç æ¥æ¨¡æ‹Ÿå…¶å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼š 123456789instanceof (A,B) = &#123; var L = A.__proto__; var R = B.prototype; if(L === R) &#123; // Açš„å†…éƒ¨å±žæ€§ __proto__ æŒ‡å‘ B çš„åŽŸåž‹å¯¹è±¡ return true; &#125; return false;&#125; 3ã€constructorå½“ä¸€ä¸ªå‡½æ•° Fè¢«å®šä¹‰æ—¶ï¼ŒJSå¼•æ“Žä¼šä¸ºFæ·»åŠ  prototype åŽŸåž‹ï¼Œç„¶åŽå†åœ¨ prototypeä¸Šæ·»åŠ ä¸€ä¸ª constructor å±žæ€§ï¼Œå¹¶è®©å…¶æŒ‡å‘ F çš„å¼•ç”¨ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š å¯ä»¥çœ‹å‡ºï¼ŒF åˆ©ç”¨åŽŸåž‹å¯¹è±¡ä¸Šçš„ constructor å¼•ç”¨äº†è‡ªèº«ï¼Œå½“ F ä½œä¸ºæž„é€ å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒåŽŸåž‹ä¸Šçš„ constructor å°±è¢«é—ä¼ åˆ°äº†æ–°åˆ›å»ºçš„å¯¹è±¡ä¸Šï¼Œ ä»ŽåŽŸåž‹é“¾è§’åº¦è®²ï¼Œæž„é€ å‡½æ•° F å°±æ˜¯æ–°å¯¹è±¡çš„ç±»åž‹ã€‚è¿™æ ·åšçš„æ„ä¹‰æ˜¯ï¼Œè®©æ–°å¯¹è±¡åœ¨è¯žç”Ÿä»¥åŽï¼Œå°±å…·æœ‰å¯è¿½æº¯çš„æ•°æ®ç±»åž‹ã€‚ null å’Œ undefined æ˜¯æ— æ•ˆçš„å¯¹è±¡ï¼Œå› æ­¤æ˜¯ä¸ä¼šæœ‰ constructor å­˜åœ¨çš„ï¼Œè¿™ä¸¤ç§ç±»åž‹çš„æ•°æ®éœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼æ¥åˆ¤æ–­ã€‚ å‡½æ•°çš„ constructor æ˜¯ä¸ç¨³å®šçš„ï¼Œè¿™ä¸ªä¸»è¦ä½“çŽ°åœ¨è‡ªå®šä¹‰å¯¹è±¡ä¸Šï¼Œå½“å¼€å‘è€…é‡å†™ prototype åŽï¼ŒåŽŸæœ‰çš„ constructor å¼•ç”¨ä¼šä¸¢å¤±ï¼Œconstructor ä¼šé»˜è®¤ä¸º Object 4ã€toStringtoString() æ˜¯ Object çš„åŽŸåž‹æ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ï¼Œé»˜è®¤è¿”å›žå½“å‰å¯¹è±¡çš„ [[Class]] ã€‚è¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å±žæ€§ï¼Œå…¶æ ¼å¼ä¸º [object Xxx] ï¼Œå…¶ä¸­ Xxx å°±æ˜¯å¯¹è±¡çš„ç±»åž‹ã€‚ å¯¹äºŽ Object å¯¹è±¡ï¼Œç›´æŽ¥è°ƒç”¨ toString() å°±èƒ½è¿”å›ž [object Object] ã€‚è€Œå¯¹äºŽå…¶ä»–å¯¹è±¡ï¼Œåˆ™éœ€è¦é€šè¿‡ call / apply æ¥è°ƒç”¨æ‰èƒ½è¿”å›žæ­£ç¡®çš„ç±»åž‹ä¿¡æ¯ã€‚ 29.JavaScriptå¦‚ä½•æ¨¡æ‹Ÿå—çº§ä½œç”¨åŸŸï¼Ÿç”¨åŒ¿åçš„å‡½æ•°è¡¨è¾¾å¼ç«‹å³æ‰§è¡Œ çš„æ–¹å¼æ¥ æ¨¡ä»¿å—çº§ä½œç”¨åŸŸ 123(function() &#123; // è¿™é‡Œæ˜¯å—çº§ä½œç”¨åŸŸ &#125;)(); è¿™æ ·å°±æ˜¯ç§æœ‰ä½œç”¨åŸŸï¼Œåœ¨åŒ¿åå‡½æ•°ä¸­å®šä¹‰çš„ç§æœ‰å˜é‡ï¼Œéƒ½ä¼šåœ¨æ‰§è¡Œç»“æŸæ—¶è¢«é”€æ¯ã€‚åœ¨ä¸€ä¸ªç”±å¾ˆå¤šå¼€å‘äººå‘˜å…±åŒå‚ä¸Žçš„å¤§åž‹åº”ç”¨ç¨‹åºä¸­ï¼Œè¿‡å¤šçš„å…¨å±€å˜é‡å’Œå‡½æ•°å¾ˆå®¹æ˜“å¯¼è‡´å‘½åå†²çªã€‚è€Œé€šè¿‡åˆ›å»ºç§æœ‰ä½œç”¨åŸŸï¼Œæ¯ä¸ªå¼€å‘äººå‘˜æ—¢å¯ä»¥ä½¿ç”¨è‡ªå·±çš„å˜é‡ï¼Œåˆä¸å¿…æ‹…å¿ƒæžä¹±å…¨å±€ä½œç”¨åŸŸã€‚ 30.JavaScriptå¦‚ä½•æ¨¡æ‹Ÿç§æœ‰å˜é‡ï¼ŸåŸºäºŽé—­åŒ…çš„å®žçŽ°æ–¹å¼å¦å¤–ä¸€ç§æ¯”è¾ƒæ™®éçš„æ–¹å¼æ˜¯åˆ©ç”¨JavaScriptçš„é—­åŒ…ç‰¹æ€§ã€‚æž„é€ å‡½æ•°å†…å®šä¹‰å±€éƒ¨å˜é‡å’Œç‰¹æƒå‡½æ•°ï¼Œå…¶å®žä¾‹åªèƒ½é€šè¿‡ç‰¹æƒå‡½æ•°è®¿é—®æ­¤å˜é‡ï¼Œå¦‚ä¸‹ï¼š 123456function Person(name)&#123; var _name = name; this.getName = function()&#123; return _name; &#125;&#125; 1var person = new Person('Joe'); è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å®žçŽ°äº†ç§æœ‰å±žæ€§çš„éšè—ï¼ŒPerson çš„å®žä¾‹å¹¶ä¸èƒ½ç›´æŽ¥è®¿é—®_nameå±žæ€§ï¼Œåªèƒ½é€šè¿‡ç‰¹æƒå‡½æ•°getNameèŽ·å–ï¼š 12alert(person._name); // undefinedalert(person.getName()); //'Joe' ä½¿ç”¨é—­åŒ…å’Œç‰¹æƒå‡½æ•°å®žçŽ°ç§æœ‰å±žæ€§çš„å®šä¹‰å’Œè®¿é—®æ˜¯å¾ˆå¤šå¼€å‘è€…é‡‡ç”¨çš„æ–¹å¼ï¼ŒDouglas Crockfordä¹Ÿæ›¾åœ¨åšå®¢ä¸­æåˆ°è¿‡è¿™ç§æ–¹å¼ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨ä¸€äº›ç¼ºé™·ï¼š ç§æœ‰å˜é‡å’Œç‰¹æƒå‡½æ•°åªèƒ½åœ¨æž„é€ å‡½æ•°ä¸­åˆ›å»ºã€‚é€šå¸¸æ¥è®²ï¼Œæž„é€ å‡½æ•°çš„åŠŸèƒ½åªè´Ÿè´£åˆ›å»ºæ–°å¯¹è±¡ï¼Œæ–¹æ³•åº”è¯¥å…±äº«äºŽprototypeä¸Šã€‚ç‰¹æƒå‡½æ•°æœ¬è´¨ä¸Šæ˜¯å­˜åœ¨äºŽæ¯ä¸ªå®žä¾‹ä¸­çš„ï¼Œè€Œä¸æ˜¯prototypeä¸Šï¼Œå¢žåŠ äº†èµ„æºå ç”¨ã€‚ 31.Callï¼ˆï¼‰å’Œapplyï¼ˆï¼‰çš„åŒºåˆ«ï¼Ÿcall å’Œ apply å°±æ˜¯ä¸ºäº†æ”¹å˜å‡½æ•°ä½“å†…éƒ¨ this çš„æŒ‡å‘ã€‚ åŒºåˆ«æ˜¯ä»Žç¬¬äºŒä¸ªå‚æ•°èµ·ï¼Œcall éœ€è¦æŠŠå‚æ•°æŒ‰é¡ºåºä¼ é€’è¿›åŽ»ï¼Œè€Œ apply åˆ™æ˜¯æŠŠå‚æ•°æ”¾åœ¨æ•°ç»„é‡Œã€‚ å½“å‚æ•°æ˜Žç¡®æ—¶ç”¨callä¸Žapplyéƒ½è¡Œ, å½“å‚æ•°ä¸æ˜Žç¡®æ—¶å¯ç”¨applyç»™åˆarguments 32.getå’Œpostçš„åŒºåˆ«ï¼ŸGETåŽé€€æŒ‰é’®/åˆ·æ–°æ— å®³ï¼ŒPOSTæ•°æ®ä¼šè¢«é‡æ–°æäº¤ï¼ˆæµè§ˆå™¨åº”è¯¥å‘ŠçŸ¥ç”¨æˆ·æ•°æ®ä¼šè¢«é‡æ–°æäº¤ï¼‰ã€‚GETä¹¦ç­¾å¯æ”¶è—ï¼ŒPOSTä¸ºä¹¦ç­¾ä¸å¯æ”¶è—ã€‚GETèƒ½è¢«ç¼“å­˜ï¼ŒPOSTä¸èƒ½ç¼“å­˜ ã€‚GETç¼–ç ç±»åž‹application/x-www-form-urlï¼ŒPOSTç¼–ç ç±»åž‹encodedapplication/x-www-form-urlencoded æˆ– multipart/form-dataã€‚ä¸ºäºŒè¿›åˆ¶æ•°æ®ä½¿ç”¨å¤šé‡ç¼–ç ã€‚GETåŽ†å²å‚æ•°ä¿ç•™åœ¨æµè§ˆå™¨åŽ†å²ä¸­ã€‚POSTå‚æ•°ä¸ä¼šä¿å­˜åœ¨æµè§ˆå™¨åŽ†å²ä¸­ã€‚GETå¯¹æ•°æ®é•¿åº¦æœ‰é™åˆ¶ï¼Œå½“å‘é€æ•°æ®æ—¶ï¼ŒGET æ–¹æ³•å‘ URL æ·»åŠ æ•°æ®ï¼›URL çš„é•¿åº¦æ˜¯å—é™åˆ¶çš„ï¼ˆURL çš„æœ€å¤§é•¿åº¦æ˜¯ 2048 ä¸ªå­—ç¬¦ï¼‰ã€‚POSTæ— é™åˆ¶ã€‚GETåªå…è®¸ ASCII å­—ç¬¦ã€‚POSTæ²¡æœ‰é™åˆ¶ã€‚ä¹Ÿå…è®¸äºŒè¿›åˆ¶æ•°æ®ã€‚ä¸Ž POST ç›¸æ¯”ï¼ŒGET çš„å®‰å…¨æ€§è¾ƒå·®ï¼Œå› ä¸ºæ‰€å‘é€çš„æ•°æ®æ˜¯ URL çš„ä¸€éƒ¨åˆ†ã€‚åœ¨å‘é€å¯†ç æˆ–å…¶ä»–æ•æ„Ÿä¿¡æ¯æ—¶ç»ä¸è¦ä½¿ç”¨ GET ï¼POST æ¯” GET æ›´å®‰å…¨ï¼Œå› ä¸ºå‚æ•°ä¸ä¼šè¢«ä¿å­˜åœ¨æµè§ˆå™¨åŽ†å²æˆ– web æœåŠ¡å™¨æ—¥å¿—ä¸­ã€‚GETçš„æ•°æ®åœ¨ URL ä¸­å¯¹æ‰€æœ‰äººéƒ½æ˜¯å¯è§çš„ã€‚POSTçš„æ•°æ®ä¸ä¼šæ˜¾ç¤ºåœ¨ URL ä¸­ã€‚ 33.æè¿°ä¸‹æ ‡å‡†ç›’æ¨¡åž‹ï¼Ÿ content-boxï¼ˆæ ‡å‡†ç›’æ¨¡åž‹ï¼‰ width = å†…å®¹çš„å®½åº¦ height = å†…å®¹çš„é«˜åº¦ border-boxï¼ˆæ€ªå¼‚ç›’æ¨¡åž‹ï¼‰ width = border + padding + å†…å®¹çš„å®½åº¦ height = border + padding + å†…å®¹çš„é«˜åº¦ 34.Css3æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ CSS3å®žçŽ°åœ†è§’ï¼ˆborder-radiusï¼‰ï¼Œé˜´å½±ï¼ˆbox-shadowï¼‰ï¼Œ å¯¹æ–‡å­—åŠ ç‰¹æ•ˆï¼ˆtext-shadowã€ï¼‰ï¼Œçº¿æ€§æ¸å˜ï¼ˆgradientï¼‰ï¼Œæ—‹è½¬ï¼ˆtransformï¼‰ transform:rotate(9deg) scale(0.85,0.90) translate(0px,-30px) skew(-9deg,0deg);// æ—‹è½¬,ç¼©æ”¾,å®šä½,å€¾æ–œ å¢žåŠ äº†æ›´å¤šçš„CSSé€‰æ‹©å™¨ å¤šèƒŒæ™¯ rgba åœ¨CSS3ä¸­å”¯ä¸€å¼•å…¥çš„ä¼ªå…ƒç´ æ˜¯ ::selection. åª’ä½“æŸ¥è¯¢ï¼Œå¤šæ å¸ƒå±€ border-image 35.æ–‡æ¡£æµå°†çª—ä½“è‡ªä¸Šè€Œä¸‹åˆ†æˆä¸€è¡Œè¡Œ, å¹¶åœ¨æ¯è¡Œä¸­æŒ‰ä»Žå·¦è‡³å³çš„é¡ºåºæŽ’æ”¾å…ƒç´ ,å³ä¸ºæ–‡æ¡£æµ.(è‡ªå·±çš„ç†è§£æ˜¯ä»Žå¤´åˆ°å°¾æŒ‰ç…§æ–‡æ¡£çš„é¡ºåºï¼Œè¯¥åœ¨ä»€ä¹ˆä½ç½®å°±åœ¨ä»€ä¹ˆä½ç½®ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§ä¸Šé¢çš„æ„æ€ç†è§£ï¼Œè‡ªä¸Šè€Œä¸‹ï¼Œè‡ªå·¦åˆ°å³çš„é¡ºåº)ã€‚æ–‡æ¡£æµæ˜¯æ–‡æ¡£ä¸­å¯æ˜¾ç¤ºå¯¹è±¡ åœ¨æŽ’åˆ—æ—¶æ‰€å ç”¨çš„ä½ç½®ã€‚ 36.åœ¨ç§»åŠ¨ç«¯ä¸Žpcç«¯åšé¡¹ç›®æœ‰ä»€ä¹ˆåŒºåˆ«?Onäº‹ä»¶çš„ä¸åŒ ï¼›å…ˆè¯´å¸ƒå±€æ–¹é¢ï¼š jsäº‹ä»¶ä¸åŒï¼šclickäº‹ä»¶åœ¨ç§»åŠ¨ç«¯ååº”æœ‰300mså»¶è¿Ÿï¼Œç‚¹å‡»ååº”æ…¢è¿˜ä¼šå‡ºçŽ°ç‚¹é€çš„bugã€‚åº”å°è¯•ä½¿ç”¨touchäº‹ä»¶ï¼Œæˆ–è€…ä½¿ç”¨fastclick.jsåº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨zeptojsä¸­çš„tapäº‹ä»¶ã€‚ è°ƒè¯•é¡µé¢ï¼šä½¿ç”¨chromeçš„æ¨¡æ‹Ÿç§»åŠ¨ç«¯å·¥å…·ï¼Œæœ‰æ—¶è¿˜è¦ä½¿ç”¨erudaã€weinreçœŸæœºè°ƒè¯•å·¥å…·ã€‚å¾®ä¿¡å¼€å‘æˆ–è€…å°ç¨‹åºè¯·é€‰æ‹©å¾®ä¿¡å¼€å‘è€…å·¥å…·ã€‚ éœ€è¦è®¾ç½®viewportï¼šåœ¨headeré‡Œä½¿ç”¨&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, user-scalable=no&quot;&gt;æ¥æŽ§åˆ¶å±å¹•å…¨å±æ˜¾ç¤ºï¼Œä¸”ä¸èƒ½è¢«ç¼©æ”¾ã€‚ å­—ä½“è§„åˆ™ï¼špcç«¯ä½¿ç”¨çš„pxåœ¨ç§»åŠ¨å±å¹•ä¸Šä¸èƒ½å¾ˆå¥½çš„é€‚åº”å¤šåˆ†è¾¨çŽ‡ï¼Œç§»åŠ¨ç«¯æ”¹ç”¨remå­—ä½“å•ä½ã€‚ä»¤ html{ font-size:62.5%; }ï¼Œåˆ™1rem=10pxã€‚ç„¶åŽä½¿ç”¨css3çš„åª’ä½“æŸ¥è¯¢æŽ§åˆ¶ä¸åŒåˆ†è¾¨çŽ‡ä¸‹htmlæ˜¾ç¤ºçš„å€æ•°ã€‚ æœ€å°ç‚¹å‡»åŒºåŸŸ44pxï¼šç§»åŠ¨ç«¯æ˜¯æœ‰æœ€å°ç‚¹å‡»è¯†åˆ«åŒºçš„ï¼Œå…ƒç´ å¤§å°ä½ŽäºŽè¿™ä¸ªå€¼æ—¶è¢«ç‚¹å‡»æ˜¯ä¸ä¼šè§¦å‘clickäº‹ä»¶çš„ã€‚ å¯ä»¥è°ƒç”¨ç¡¬ä»¶åŠŸèƒ½ï¼šå¯ä»¥é€šè¿‡è®¾ç½®aæ ‡ç­¾hrefç±»åž‹æ¥å®žçŽ°æ‹¨æ‰“ç”µè¯ã€å‘é€çŸ­ä¿¡å’Œé‚®ä»¶ç­‰åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡&lt;input type=&quot;file&quot;&gt;çš„accept å±žæ€§ï¼Œè°ƒç”¨æœ¬åœ°å›¾ç‰‡æˆ–æ‹ç…§ã€‚è¿˜å¯ä»¥ä½¿ç”¨html5çš„è¿åŠ¨ä¼ æ„Ÿå™¨æ•°æ®äº‹ä»¶å®žçŽ°å¾®ä¿¡æ‘‡ä¸€æ‘‡åŠŸèƒ½ã€‚ 37.ä»€ä¹ˆé¢å‘å¯¹è±¡é¢å‘å¯¹è±¡çš„ä¸‰ä¸ªåŸºæœ¬ç‰¹å¾æ˜¯ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€‚ 38.Html5æœ‰å“ªäº›æ ‡ç­¾ï¼šheaderã€footerã€sectionã€navã€audioã€canvas 37.ä¸€ä¸ªé¡µé¢ä»Žè¾“å…¥URLåˆ°é¡µé¢åŠ è½½æ˜¾ç¤ºå®Œæˆï¼Œè¿™ä¸ªè¿‡ç¨‹éƒ½å‘ç”Ÿä»€ä¹ˆ1ã€é¦–å…ˆï¼Œåœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥url2ã€æµè§ˆå™¨å…ˆæŸ¥çœ‹æµè§ˆå™¨ç¼“å­˜-ç³»ç»Ÿç¼“å­˜-è·¯ç”±å™¨ç¼“å­˜ï¼Œå¦‚æžœç¼“å­˜ä¸­æœ‰ï¼Œä¼šç›´æŽ¥åœ¨å±å¹•ä¸­æ˜¾ç¤ºé¡µé¢å†…å®¹ã€‚è‹¥æ²¡æœ‰ï¼Œåˆ™è·³åˆ°ç¬¬ä¸‰æ­¥æ“ä½œã€‚3ã€åœ¨å‘é€httpè¯·æ±‚å‰ï¼Œéœ€è¦åŸŸåè§£æž(DNSè§£æž)ï¼Œè§£æžèŽ·å–ç›¸åº”çš„IPåœ°å€ã€‚4ã€æµè§ˆå™¨å‘æœåŠ¡å™¨å‘èµ·tcpè¿žæŽ¥ï¼Œä¸Žæµè§ˆå™¨å»ºç«‹tcpä¸‰æ¬¡æ¡æ‰‹ã€‚5ã€æ¡æ‰‹æˆåŠŸåŽï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€httpè¯·æ±‚ï¼Œè¯·æ±‚æ•°æ®åŒ…ã€‚6ã€æœåŠ¡å™¨å¤„ç†æ”¶åˆ°çš„è¯·æ±‚ï¼Œå°†æ•°æ®è¿”å›žè‡³æµè§ˆå™¨7ã€æµè§ˆå™¨æ”¶åˆ°HTTPå“åº”8ã€è¯»å–é¡µé¢å†…å®¹ï¼Œæµè§ˆå™¨æ¸²æŸ“ï¼Œè§£æžhtmlæºç 9ã€ç”ŸæˆDomæ ‘ã€è§£æžcssæ ·å¼ã€jsäº¤äº’10ã€å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤äº’11ã€ajaxæŸ¥è¯¢]]></content>
      <categories>
        <category>Interview</category>
      </categories>
      <tags>
        <tag>Interview</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jsé¢è¯•é¢˜æ±‡æ€»]]></title>
    <url>%2F2018%2F03%2F12%2FInterview%2Fjs%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2F</url>
    <content type="text"><![CDATA[é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿé—­åŒ…çš„ç”¨å¤„ã€‚ é—­åŒ…æ˜¯å†…éƒ¨å‡½æ•°å¯¹å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸçš„å¼•ç”¨ã€‚è€Œåœ¨å‡½æ•°å¤–éƒ¨å¼•ç”¨å‡½æ•°å†…éƒ¨å˜é‡ï¼Œå¯ä»¥é€šè¿‡é—­åŒ…å®žçŽ°ã€‚é—­åŒ…çš„ç”¨å¤„å¾€å¾€æ˜¯åœ¨æ¨¡å—å°è£…çš„æ—¶å€™ã€‚å¯ä»¥å°†æ¨¡å—å†…éƒ¨å…¬æœ‰éƒ¨åˆ†æš´éœ²å‡ºæ¥ã€‚(é—­åŒ…æ˜¯åŸºç¡€æ€§çš„é—®é¢˜ï¼Œè¿™é‡Œåªæ˜¯ç®€è¦çš„é˜è¿°äº†ä¸€ä¸‹å®ƒçš„æ¦‚å¿µ) é—­åŒ…è¯¦è§£(é˜®ä¸€å³°) åŽŸåž‹ä»¥åŠåŽŸåž‹é“¾jsä¸Žå¸¸ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¸ä¸€æ ·ï¼Œä»–æ˜¯é åŽŸåž‹ç»§æ‰¿çš„ï¼Œå¹¶ä¸æ˜¯ç±»ã€‚ä½¿ç”¨é€ é›¶ä»¶çš„æ–¹å¼è¿›è¡Œç±»æ¯”ï¼Œé€šè¿‡ç±»ç»§æ‰¿çš„æ–¹å¼å°±æ˜¯é€šè¿‡ä¸€ä¸ªæ¨¡åž‹ç›’é“¸ä»¶ï¼Œè€ŒåŽŸåž‹çš„æ–¹å¼ï¼Œåˆ™æ˜¯ä»Žå¦ä¸€ä¸ªé›¶ä»¶å…‹éš†ä¸€ä»½ï¼Œåœ¨è¿™åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ã€‚è€Œé‚£ä»½è¢«å…‹éš†çš„é›¶ä»¶å°±æ˜¯åŽŸåž‹ åŽŸåž‹åŠåŽŸåž‹é“¾è¯¦è§£ã€‚åŽŸåž‹é“¾å°±æ˜¯å®ƒä»¬ä¹‹é—´äº§ç”Ÿçš„è”ç³»ï¼Œå¾€å¾€å¯ä»¥é€šè¿‡ç”»å›¾æ¥é˜è¿°ï¼š åžƒåœ¾å›žæ”¶æœºåˆ¶å’Œå†…å­˜æ³„æ¼jså¼•æ“Žæœ‰è‡ªå·±çš„ä¸€å¥—åžƒåœ¾å›žæ”¶çš„æœºåˆ¶ï¼Œä¸»è¦çš„å›žæ”¶æœºåˆ¶æœ‰ä¸¤ç§æ ‡è®°æ¸…é™¤å’Œå¾ªçŽ¯å¼•ç”¨ã€‚æ ‡è®°æ¸…é™¤ï¼Œå³æ˜¯åœ¨å±€éƒ¨å˜é‡åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æ‰“ä¸Šæ ‡è®°ï¼Œä¸€æ—¦ç¦»å¼€äº†æ‰§è¡ŒçŽ¯å¢ƒï¼Œæ ‡è®°å°†ä¼šè¢«æ¸…é™¤ï¼Œè¿™æ˜¯åžƒåœ¾å›žæ”¶å™¨å°†ä¼šçŸ¥é“ï¼Œè¯¥å˜é‡å·²ç»ä¸ä½¿ç”¨ï¼Œå¯å›žæ”¶ã€‚è€Œå¾ªçŽ¯å¼•ç”¨æ˜¯åœ¨è¾ƒæ—©ç‰ˆæœ¬çš„IEæµè§ˆå™¨ä¸­è¢«ä½¿ç”¨ï¼Œå³åˆå§‹åŒ–çš„å˜é‡å¼•ç”¨æ•°ä¸º0ï¼Œä¸€æ—¦è¢«èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œå¼•ç”¨å°±åŠ 1ï¼›è€Œå¦ä¸€ä¸ªå˜é‡ä¸€æ—¦è¢«èµ‹äºˆå…¶ä»–å€¼ï¼Œåˆ™è¯¥å€¼çš„å¼•ç”¨æ•°å‡ä¸€ã€‚åžƒåœ¾å›žæ”¶å™¨ä¼šåŽ»åˆ¤æ–­è¯¥å˜é‡çš„å¼•ç”¨æ•°æ˜¯å¦ä¸º0ï¼Œä¸º0ï¼Œåˆ™ä¼šè¢«å›žæ”¶æŽ‰ã€‚è¿™ä¸ªæœºåˆ¶ä¼šå­˜åœ¨å¾ªçŽ¯å¼•ç”¨çš„é—®é¢˜ï¼Œå³ä¸¤ä¸ªå˜é‡ç›¸äº’å¼•ç”¨ã€‚åžƒåœ¾å›žæ”¶ å†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚å¯ä»¥ç½—åˆ—ä¸ºï¼š æ— æ„è¯†çš„å˜é‡ä½¿ç”¨ 123function func()&#123; i = 2;&#125; è¿™ç§æ–¹å¼åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯ä¸ç”Ÿæ•ˆçš„ã€‚ é—­åŒ…å¯¼è‡´çš„é—®é¢˜ å…¶å®žï¼Œé—­åŒ…å¯¼è‡´çš„å†…å­˜æ³„æ¼ä¸»è¦æ˜¯åœ¨IEå¼•ç”¨domå…ƒç´ çš„æ—¶å€™ã€‚IEä¸­çš„éƒ¨åˆ†domå…ƒç´ å¹¶éžåŽŸç”Ÿçš„ï¼Œè€Œæ˜¯COMã€‚è¿™æ—¶ä½¿ç”¨ï¼Œå¾€å¾€ä¼šå¯¼è‡´å¾ªçŽ¯å¼•ç”¨ï¼Œè€Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚è¿˜æœ‰å°±æ˜¯æ— æ„è¯†çš„ä½¿ç”¨é—­åŒ…å¯¼è‡´çš„é—®é¢˜ã€‚1. åœ¨å‡½æ•°å†…éƒ¨æ·»åŠ æ—¶é—´æ—¶ï¼Œä¼šé€ æˆdomå…ƒç´ çš„å¼•ç”¨ï¼Œè€Œå¯¼è‡´å†…å­˜æ³„æ¼ï¼›2. åœ¨åˆ é™¤domæ—¶ï¼Œåœ¨ä¹‹å‰ä¸å°å¿ƒæ·»åŠ äº†äº‹ä»¶ç­‰æƒ…å†µå†…å­˜æ³„æ¼ æŸ¯é‡ŒåŒ–jsçš„æŸ¯é‡ŒåŒ–å°±æ˜¯å°†å‡½æ•°çš„éƒ¨åˆ†å‚æ•°åˆ†æˆå¤šæ¬¡è¿›è¡Œè°ƒç”¨ã€‚ä¾‹å­ï¼šæŸ¯é‡ŒåŒ– å¼‚æ­¥é¢è¯•ä¹‹ä¸­ä¸»è¦ä¼šé—®ä½ ä½•ä¸ºå¼‚æ­¥ï¼Ÿå…¶å®žï¼Œjsæ˜¯ä¸€é—¨å•çº¿ç¨‹çš„è¯­è¨€ï¼Œæ­£å¸¸çš„æ–¹å¼æ˜¯æ•´ä¸ªç¨‹åºæŒ‰ç…§é¡ºåºä¸€æ­¥ä¸€æ­¥çš„æ‰§è¡Œä¸‹åŽ»ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„åŒæ­¥æ¨¡å¼ï¼Œä½†æ˜¯å¾€å¾€jsä¸­ä¼šæœ‰è®¸å¤šçš„ä»»åŠ¡è€—æ—¶æ¯”è¾ƒé•¿(æ¯”å¦‚è¯´ajaxè¯·æ±‚)ç­‰ï¼Œå¦‚æžœæŒ‰ç…§åŒæ­¥çš„æ–¹å¼ï¼Œå¾€å¾€ä¼šå¯¼è‡´æµè§ˆå™¨çš„æ— å“åº”ã€‚è¿™æ—¶ï¼Œå°±éœ€è¦é€šè¿‡å¼‚æ­¥çš„å½¢å¼ã€‚å¼‚æ­¥æ¨¡å¼ï¼šjsçš„ä»»åŠ¡å¾€å¾€å…·å¤‡ä¸€ä¸ªæˆ–å¤šä¸ªå›žè°ƒå‡½æ•°ï¼Œåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒåŽä¸€ä¸ªä»»åŠ¡æ— éœ€å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œè¿”å›žç»“æžœï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œï¼Œä¹‹åŽå‰ä¸€ä¸ªä»»åŠ¡å¯ä»¥è°ƒç”¨å›žè°ƒå‡½æ•°ï¼Œå°†ç»“æžœè¿”å›žå›žæ¥ã€‚å¼‚æ­¥ setTimeoutå’ŒsetIntervalçš„åŒºåˆ«ï¼Œä»¥åŠsetTimeoutçš„åŽŸç†ï¼ŒsetIntervalä¼šé€ æˆä»€ä¹ˆé—®é¢˜é¦–å…ˆï¼Œæˆ‘ä»¬æ¥åº”è¯¥äº†è§£ä¸€ä¸‹setTimeoutçš„åŽŸç†ã€‚æµè§ˆå™¨æ˜¯ä¸€ä¸ªäº‹ä»¶ä¸ºä¸»ä½“çš„äº‹ç‰©ã€‚æ€»æ˜¯æœ‰ä¸€ä¸ªé˜Ÿåˆ—åœ¨ä¸åœçš„å¾ªçŽ¯ã€‚å½“ä½¿ç”¨setTimeoutæ—¶ï¼Œæµè§ˆå™¨ä¼šåˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œç„¶åŽå°†å‡½æ•°ä¸­çš„å›žè°ƒå‡½æ•°æ”¾å…¥handleé˜Ÿåˆ—é‡Œé¢ã€‚ç„¶åŽæµè§ˆå™¨ä¼šä¸åœçš„å¾ªçŽ¯æ•´ä¸ªhandleï¼Œä¸€æ—¦handleä¸­çš„å†…å®¹æ»¡è¶³æ¡ä»¶ï¼Œå°±ä¼šè°ƒç”¨å…¶ä¸­çš„å›žè°ƒå‡½æ•°ã€‚setTimeoutçš„æ»¡è¶³æ¡ä»¶å°±æ˜¯å®ƒåŽé¢çš„è®¾ç½®çš„æ—¶é—´å·®ã€‚ setTimeoutå’ŒsetIntervalä¹‹é—´çš„åŒºåˆ«ä¸»è¦æ˜¯setTimeoutæ˜¯ä¸€ä¸ªå»¶è¿Ÿå‡½æ•°ï¼Œåªæ‰§è¡Œä¸€æ¬¡ï¼Œè€ŒsetIntervalä¼šé—´éš”ä¸€å®šçš„æ—¶é—´åå¤çš„æ‰§è¡Œã€‚setTimeoutå’ŒsetIntervalçš„åŒºåˆ« setIntervalçš„åŽŸç†ï¼Œå…¶å®žä¸Žä¹‹å‰çš„setTimeoutçš„åŽŸç†æœ‰ç‚¹ç±»ä¼¼ã€‚åªæ˜¯åœ¨æ¯ä¸ªEvent Loopä¹‹åŽï¼Œéƒ½ä¼šåŽ»æ£€æµ‹æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå¦‚æžœæ»¡è¶³æ¡ä»¶çš„è¯ï¼Œå°±æ‰§è¡Œå›žè°ƒå‡½æ•°ï¼Œå¦‚æžœä¸æ»¡è¶³ï¼Œæ”¾å…¥ä¸‹ä¸€è½®çš„event loopä¸­ã€‚ä¸»è¦çš„é—®é¢˜å°±æ˜¯ï¼Œå¦‚æžœä¸€ä¸ªsetIntervalä¸­çš„å›žè°ƒå‡½æ•°ä¸èƒ½å¤Ÿè¢«æ‰§è¡Œï¼Œä¼šå¼•èµ·ç³»ç»Ÿé˜»å¡žçš„é—®é¢˜ï¼Œä¹‹åŽçš„æ‰€æœ‰çš„å®šæ—¶å™¨éƒ½ä¼šç§¯ç´¯èµ·æ¥ï¼Œä¹‹åŽå°±ä¼šç›´æŽ¥æ‰§è¡Œï¼Œæ²¡æœ‰æ—¶é—´é—´éš”ã€‚setIntervalæœºåˆ¶ 1234567891011function interval(func, wait)&#123; var interv = function()&#123; func.call(null); setTimeout(interv, wait); &#125;; setTimeout(interv, wait);&#125;interval(() =&gt; &#123; console.log(1);&#125;, 1000); //1 1 1 postmessageå’Œiframeæ€Žä¹ˆç»“åˆä½¿ç”¨postmessageæ˜¯html5æ–°å‡ºçš„ä¸€ä¸ªAPIï¼Œå¯ä»¥è§£å†³å¤šçª—å£ã€é¡µé¢ä¸Žæ–°æ ‡ç­¾ã€çª—å£å’Œiframeä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡çš„è·¨åŸŸé—®é¢˜ã€‚ä½¿ç”¨æ–¹æ³•å°±æ˜¯postmessage(data, origin)ï¼Œå…¶ä¸­dataæŒ‡çš„å°±æ˜¯éœ€è¦ä¼ é€’çš„æ•°æ®ï¼ŒoriginæŒ‡çš„æ˜¯å…·ä½“çš„æ•°æ®æºåœ°å€(åŒ…æ‹¬åè®®+åŸŸå+ç«¯å£)ã€‚ç„¶åŽwindowå¯¹messageäº‹ä»¶è¿›è¡Œç›‘å¬ã€‚postMessageè§£å†³è·¨åŸŸ jsæ¨¡æ¿å¼•æ“Žjsæ¨¡ç‰ˆå¼•æ“Žï¼Œå…¶å®žå°±æ˜¯é¢„å¤„ç†å™¨ï¼Œå°†ä¸€äº›å­—ç¬¦ä¸²åŽ»åŒ¹é…æ•°æ®ï¼Œç„¶åŽå°†æ•°æ®æ’å…¥åˆ°å›ºå®šçš„htmlæ¨¡ç‰ˆä¹‹ä¸­ã€‚jsçš„æ¨¡ç‰ˆå¼•æ“Žä¸»è¦æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŽ»è¿‡æ»¤ä¸€äº›å­—ç¬¦ä¸²ï¼Œç„¶åŽå°†é‡Œé¢çš„æ¯ä¸ªè¯­å¥ç‰‡æ®µéƒ½æ”¾åˆ°å›ºå®šçš„æ•°ç»„ä¹‹ä¸­ï¼Œç„¶åŽåœ¨å¯¹æ•°ç»„è¿›è¡Œè§£æžï¼Œä¹‹åŽæ‹¼æˆä¸€ä¸ªå›ºå®šçš„jsä»£ç ï¼Œå°†å†…å®¹è¿”å›žå‡ºæ¥ã€‚è‘—åçš„æ¨¡ç‰ˆå¼•æ“Žejsã€‚jsæ¨¡ç‰ˆå¼•æ“ŽåŽŸç†è§£æž WebSocketï¼Ÿé•¿è½®è¯¢å’ŒçŸ­è½®è¯¢webSocketæ˜¯ä¸€ç§ç½‘ç»œé€šä¿¡åè®®ï¼ŒåŸºäºŽTCP/IPçš„å¦ä¸€ç§é€šä¿¡åè®®(è¿˜æœ‰ä¸€ç§æ˜¯httpåè®®)ã€‚å®ƒä¸Žhttpçš„ä¸»è¦åŒºåˆ«å°±æ˜¯ï¼Œhttpæ˜¯å•å‘é€šä¿¡çš„ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä½†æ˜¯ï¼ŒæœåŠ¡ç«¯å¦‚æžœæœ‰æ¶ˆæ¯ï¼Œæ— æ³•å‘å®¢æˆ·ç«¯æŽ¨é€ã€‚åœ¨æ²¡æœ‰websockä¹‹å‰ï¼Œéƒ½æ˜¯é€šè¿‡httpå®šæœŸå‘é€è¯·æ±‚çš„æ–¹å¼â€”â€”è½®è¯¢ã€‚è½®è¯¢çš„æ•ˆçŽ‡æ˜¯ç›¸å¯¹è¾ƒä½Žçš„ã€‚websockåè®® ä¹‹åŽçš„é•¿è½®è¯¢å’ŒçŸ­è½®è¯¢å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜è¿˜å¾—æ›´å®žé™…çš„åœºæ™¯ç›¸ç»“åˆèµ·æ¥ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨å†™ç”µå•†ç½‘ç«™çš„æ—¶å€™ï¼Œå•†å“çš„åº“å­˜æ˜¯å®žæ—¶å˜åŒ–çš„ï¼Œè¿™æ—¶ï¼Œä½ è¦å’ŒæœåŠ¡å™¨åŒæ­¥è¿™ä¸ªå˜åŒ–ï¼Œæ‰èƒ½å¤Ÿä½¿å¾—ä¿¡æ¯æ­£ç¡®ã€‚é‚£ä¹ˆï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æˆ‘ä»¬å†™ä¸€ä¸ªajaxè¯·æ±‚ï¼Œä¸æ–­çš„åŽ»ç»™æœåŠ¡å™¨è¯·æ±‚ï¼ŒåŒæ­¥è¿™ä¸ªæ•°æ®ã€‚è€ŒæœåŠ¡å™¨æ¯æ¬¡æŽ¥æ”¶åˆ°è¯·æ±‚å°±è¿”å›žä¸€æ¬¡ä¿¡æ¯ã€‚è¿™å°±æ˜¯æ‰€è°“çš„çŸ­è½®è¯¢ï¼Œè¿™ç§æ–¹å¼å…¶å®žéžå¸¸çš„æ¶ˆè€—æœåŠ¡å™¨çš„èµ„æºï¼Œè¯•æƒ³æœåŠ¡å™¨æ¯æ¬¡æŽ¥æ”¶åˆ°è¯·æ±‚å°±è¦åŽ»æŸ¥è¯¢æ•°æ®åº“ï¼ŒèŽ·å–ä¿¡æ¯ï¼Œè€Œå¾€å¾€åº“å­˜æ˜¯æ²¡æœ‰è¿™ä¹ˆå¿«æ”¹å˜çš„ã€‚é‚£ä¹ˆï¼Œæˆ–è®¸é•¿è½®è¯¢å¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªajaxè¯·æ±‚ï¼ŒåŒæ—¶ç»™è¿™ä¸ªè¯·æ±‚è®¾ç½®è¶…æ—¶æœºåˆ¶ï¼Œä¸€æ—¦è¶…æ—¶ä¹‹åŽï¼Œå†æ¬¡é‡æ–°å‘é€ã€‚è€ŒæœåŠ¡å™¨æ¯æ¬¡æŽ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ï¼Œåªéœ€è¦å°†ä¹‹æŒ‚èµ·ï¼Œç­‰æ£€æµ‹åˆ°åº“å­˜å˜åŒ–æ—¶ï¼Œåœ¨å“åº”è¿™ä¸ªè¯·æ±‚ï¼Œè¿™æ ·å°±æœ‰æ•ˆçš„é™ä½Žäº†è½®è¯¢çš„æ¬¡æ•°ã€‚åŒæ ·çš„é—®é¢˜ï¼ŒæœåŠ¡å™¨çš„èµ„æºè¿˜æ˜¯ä¼šæœ‰æ‰€æŸè€—ï¼Œæ¯•ç«Ÿä¸€ä¸ªè¯·æ±‚ç›¸å½“äºŽä¸€ä¸ªçº¿ç¨‹ã€‚å¯¹äºŽå¤§åž‹çš„ç”µå•†ç½‘ç«™æ¥è¯´ï¼Œè¿™ä¸æ˜¯ä¸€ç§å¥½çš„è§£å†³æ–¹å¼ã€‚é•¿è½®è¯¢ã€çŸ­è½®è¯¢ã€é•¿é“¾æŽ¥ã€çŸ­é“¾æŽ¥ cookieã€LocalStorage å’Œ SessionStorage çš„æ¦‚å¿µä»¥åŠå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«é¦–å…ˆï¼Œcookieæ˜¯æˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„ï¼Œæ˜¯æµè§ˆå™¨ä¸ŽæœåŠ¡å™¨ä¹‹é—´æ•°æ®ä¼ é€’çš„æ–¹å¼ï¼Œä¹‹å‰é€šå¸¸ä¹Ÿä¼šç”¨æ¥åšä¸€äº›æ•°æ®çš„ç¼“å­˜ï¼Œä¾‹å¦‚ï¼šç”¨æˆ·çš„ç”¨æˆ·åç­‰ã€‚ä½†æ˜¯cookieåœ¨åšæ•°æ®ç¼“å­˜çš„æ—¶å€™å¾€å¾€æœ‰ç¼ºç‚¹ï¼š cookieæ•°æ®æœ€å¤šåªèƒ½ç¼“å­˜4kbï¼Œå¤§äºŽ4kbçš„cookieä¼šè¢«æµè§ˆå™¨é»˜è®¤å¼ƒç”¨cookieåœ¨åšæ•°æ®ç¼“å­˜æ—¶ï¼Œå¾€å¾€ä¼šå°†æ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼Œä½†æ˜¯ï¼Œæœ‰çš„æ—¶å€™è¿™äº›æ•°æ®å¹¶ä¸éœ€è¦å‘é€ç»™æœåŠ¡å™¨cookieåœ¨æ¯ä¸ªåŸŸä¸­çš„æ•°é‡æ˜¯æœ‰é™çš„ï¼Œå¾€å¾€è¶…è¿‡ä¸€å®šæ•°é‡ï¼Œé‚£ä¹ˆä¹‹å‰çš„cookieå°†è¢«æŠ›å¼ƒhtml5æ–°ç‰¹æ€§ä¸­å°±å¸¦æ¥äº†ç›¸åº”çš„å®¢æˆ·ç«¯storageï¼Œå°±æ˜¯localStorageå’ŒsessionStorageã€‚localStorageæ˜¯æœ¬åœ°å­˜å‚¨ï¼Œæ•°æ®ä¸ä¼šå‘é€ç»™æœåŠ¡å™¨ï¼ŒåŒæ—¶å®ƒçš„ç¼“å­˜å¤§å°å¤§çº¦åœ¨5Må·¦å³ï¼Œæ•°æ®æ˜¯æ°¸ä¹…å­˜å‚¨çš„ï¼Œé™¤éžæ‰‹åŠ¨åˆ é™¤ã€‚sessionStorageåˆ™æ˜¯ä¼šè¯å­˜å‚¨ï¼Œå¤§éƒ¨åˆ†çš„ç‰¹æ€§å’ŒlocalStorageä¸€æ ·ï¼Œä½†æ˜¯ï¼ŒsessionStorageä¸­çš„å†…å®¹ä¼šåœ¨æµè§ˆå™¨æˆ–è€…é¡µé¢å…³é—­ä¹‹åŽè¢«æ¸…é™¤æŽ‰ã€‚cookieã€LocalStorageå’ŒSessionStorage æµè§ˆå™¨äº‹ä»¶ä»£ç†çš„åŽŸç†å…¶å®žï¼Œäº‹ä»¶ä»£ç†å’Œäº‹ä»¶å§”æ‰˜æ˜¯åŒä¸€ä¸ªæ¦‚å¿µã€‚ä¸¾ä¸ªä¾‹å­è¯´æ˜Žæˆ–è®¸ä¼šæ›´åŠ å½¢è±¡ã€‚åœºæ™¯æ˜¯ï¼šDOMç»“æž„ä¸ºä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œä½ éœ€è¦åœ¨ç‚¹å‡»æ¯ä¸ªliæ ‡ç­¾æ—¶ï¼Œåœ¨æŽ§åˆ¶å°è¾“å‡ºå®ƒçš„å†…å®¹ã€‚è¿™æ—¶ï¼Œä½ æˆ–è®¸ä¼šåœ¨æ¯ä¸ªliä¸Šé¢æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç„¶åŽè¾“å‡ºæ¯ä¸ªliçš„å†…å®¹ã€‚ä½†æ˜¯ï¼Œå¾€å¾€è¿™æ ·å­åšï¼Œä¼šä½¿å¾—æ•´ä¸ªåº”ç”¨çš„æ€§èƒ½é™ä½Žï¼Œè€Œä¸”ä½¿å¾—æ·»åŠ è¿‡ç¨‹ç¹çï¼Œä¸çµæ´»ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨äº‹ä»¶ä»£ç†çš„æ–¹å¼ï¼Œåœ¨æ•´ä¸ªåˆ—è¡¨çš„ulä¸Šé¢åŽ»æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç„¶åŽåœ¨å†…éƒ¨ä½¿ç”¨target(çœŸå®žç‚¹å‡»å…ƒç´ )æ¥ä½¿å…¶è¾“å‡ºå®ƒçš„å†…å®¹ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åªå†™ä¸€ä¸ªäº‹ä»¶ï¼Œè€Œå®Œæˆå¤šä¸ªliä¹‹é—´çš„å†…å®¹è¾“å‡ºã€‚äº‹ä»¶ä»£ç†çš„åŽŸç†æ˜¯ä½¿ç”¨äº†äº‹ä»¶å†’æ³¡çš„ç‰¹æ€§ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æœ‰äº›äº‹ä»¶æ²¡æœ‰å†’æ³¡æœºåˆ¶ï¼Œå¦‚focusï¼Œblursç­‰ï¼Œå°±ä¸èƒ½ä½¿ç”¨äº‹ä»¶ä»£ç†ï¼Œè¿˜æœ‰äº›ç±»ä¼¼äºŽmouseoverç­‰äº‹ä»¶ï¼Œä¼šå¯¼è‡´å®žæ—¶çš„è§¦å‘ï¼Œä¹Ÿä¸å®œä½¿ç”¨äº‹ä»¶ä»£ç†äº‹ä»¶ä»£ç† å‰ç«¯å®‰å…¨ XSSï¼ŒCSRF ï¼Ÿé¿å…æ–¹æ³•ï¼ŸXSSï¼Œè¢«ç§°ä¸ºè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ç§åå°„åž‹ã€å­˜å‚¨åž‹å’ŒDOMåž‹ã€‚åå°„åž‹ä¸»è¦æ˜¯ä¸€äº›æ¶æ„é“¾æŽ¥çš„å‘é€ï¼Œå­˜å‚¨åž‹ä¸»è¦å‡ºçŽ°åœ¨è¯„è®ºç­‰ï¼Œå¯ä»¥æ’å…¥åˆ°æœåŠ¡å™¨æ•°æ®åº“ä¸­ï¼Œè¿™ç§æ”»å‡»æ¯”è¾ƒæŒä¹…ï¼›DOMåž‹éžå¸¸çš„å°‘è§ã€‚XSSä¸»è¦æ˜¯ç›—å–ç”¨æˆ·çš„cookieç­‰æ•°æ®ã€‚CSRFï¼Œè¢«ç§°ä¸ºè·¨ç«™ä¼ªé€ è¯·æ±‚æ”»å‡»ï¼Œä¸»è¦ä¸Žxssç›¸ç»“åˆXSSå’ŒCSRF å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•åŒæºå’Œè·¨åŸŸé¢å‘å¯¹è±¡å’Œç»§æ‰¿object.createçš„å®žçŽ°åŽŸç†objectçš„æ·±æ‹·è´å’Œæµ…æ‹·è´é¢å‘åˆ‡é¢ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹åŽŸæ–‡é“¾æŽ¥]]></content>
      <categories>
        <category>Interview</category>
      </categories>
      <tags>
        <tag>Interview</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯æ€§èƒ½ä¼˜åŒ–]]></title>
    <url>%2F2018%2F03%2F11%2F%E6%80%A7%E8%83%BD%2F%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[å‰ç«¯ä¼˜åŒ–çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ ä»Žç”¨æˆ·è§’åº¦è€Œè¨€ï¼Œä¼˜åŒ–èƒ½å¤Ÿè®©é¡µé¢åŠ è½½å¾—æ›´å¿«ã€å¯¹ç”¨æˆ·çš„æ“ä½œå“åº”å¾—æ›´åŠæ—¶ï¼Œèƒ½å¤Ÿç»™ç”¨æˆ·æä¾›æ›´ä¸ºå‹å¥½çš„ä½“éªŒã€‚ ä»ŽæœåŠ¡å•†è§’åº¦è€Œè¨€ï¼Œä¼˜åŒ–èƒ½å¤Ÿå‡å°‘é¡µé¢è¯·æ±‚æ•°ã€æˆ–è€…å‡å°è¯·æ±‚æ‰€å å¸¦å®½ï¼Œèƒ½å¤ŸèŠ‚çœå¯è§‚çš„èµ„æºã€‚ æ€»ä¹‹ï¼Œæ°å½“çš„ä¼˜åŒ–ä¸ä»…èƒ½å¤Ÿæ”¹å–„ç«™ç‚¹çš„ç”¨æˆ·ä½“éªŒå¹¶ä¸”èƒ½å¤ŸèŠ‚çœç›¸å½“çš„èµ„æºåˆ©ç”¨ã€‚ é¡µé¢çº§ä¼˜åŒ–å‡å°‘httpè¯·æ±‚å‡å°‘httpè¯·æ±‚æ•°çš„ä¸»è¦é€”å¾„åŒ…æ‹¬ï¼š (1). ä»Žè®¾è®¡å®žçŽ°å±‚é¢ç®€åŒ–é¡µé¢ å¦‚æžœä½ çš„é¡µé¢åƒç™¾åº¦é¦–é¡µä¸€æ ·ç®€å•ï¼Œé‚£ä¹ˆæŽ¥ä¸‹æ¥çš„è§„åˆ™åŸºæœ¬ä¸Šéƒ½ç”¨ä¸ç€äº†ã€‚ä¿æŒé¡µé¢ç®€æ´ã€å‡å°‘èµ„æºçš„ä½¿ç”¨æ—¶æœ€ç›´æŽ¥çš„ã€‚å¦‚æžœä¸æ˜¯è¿™æ ·ï¼Œä½ çš„é¡µé¢éœ€è¦åŽä¸½çš„çš®è‚¤ï¼Œåˆ™ç»§ç»­é˜…è¯»ä¸‹é¢çš„å†…å®¹ã€‚ (2). åˆç†è®¾ç½® HTTPç¼“å­˜ ç¼“å­˜çš„åŠ›é‡æ˜¯å¼ºå¤§çš„ï¼Œæ°å½“çš„ç¼“å­˜è®¾ç½®å¯ä»¥å¤§å¤§çš„å‡å°‘ HTTPè¯·æ±‚ã€‚ä»¥æœ‰å•Šé¦–é¡µä¸ºä¾‹ï¼Œå½“æµè§ˆå™¨æ²¡æœ‰ç¼“å­˜çš„æ—¶å€™è®¿é—®ä¸€å…±ä¼šå‘å‡º 78ä¸ªè¯·æ±‚ï¼Œå…± 600å¤š Kæ•°æ® (å¦‚å›¾ 1.1)ï¼Œè€Œå½“ç¬¬äºŒæ¬¡è®¿é—®å³æµè§ˆå™¨å·²ç¼“å­˜ä¹‹åŽè®¿é—®åˆ™ä»…æœ‰ 10ä¸ªè¯·æ±‚ï¼Œå…± 20å¤š Kæ•°æ® (å¦‚å›¾ 1.2)ã€‚ (è¿™é‡Œéœ€è¦è¯´æ˜Žçš„æ˜¯ï¼Œå¦‚æžœç›´æŽ¥ F5åˆ·æ–°é¡µé¢çš„è¯æ•ˆæžœæ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™ç§æƒ…å†µä¸‹è¯·æ±‚æ•°è¿˜æ˜¯ä¸€æ ·ï¼Œä¸è¿‡è¢«ç¼“å­˜èµ„æºçš„è¯·æ±‚æœåŠ¡å™¨æ˜¯ 304å“åº”ï¼Œåªæœ‰ Headeræ²¡æœ‰Body ï¼Œå¯ä»¥èŠ‚çœå¸¦å®½ ) (3). èµ„æºåˆå¹¶ä¸ŽåŽ‹ç¼© å¦‚æžœå¯ä»¥çš„è¯ï¼Œå°½å¯èƒ½çš„å°†å¤–éƒ¨çš„è„šæœ¬ã€æ ·å¼è¿›è¡Œåˆå¹¶ï¼Œå¤šä¸ªåˆä¸ºä¸€ä¸ªã€‚å¦å¤–ï¼Œ CSSã€ Javascriptã€Image éƒ½å¯ä»¥ç”¨ç›¸åº”çš„å·¥å…·è¿›è¡ŒåŽ‹ç¼©ï¼ŒåŽ‹ç¼©åŽå¾€å¾€èƒ½çœä¸‹ä¸å°‘ç©ºé—´ã€‚ (4). CSS Sprites åˆå¹¶ CSSå›¾ç‰‡ï¼Œå‡å°‘è¯·æ±‚æ•°çš„åˆä¸€ä¸ªå¥½åŠžæ³•ã€‚ (5). Inline Images ä½¿ç”¨ data: URL schemeçš„æ–¹å¼å°†å›¾ç‰‡åµŒå…¥åˆ°é¡µé¢æˆ– CSSä¸­ï¼Œå¦‚æžœä¸è€ƒè™‘èµ„æºç®¡ç†ä¸Šçš„é—®é¢˜çš„è¯ï¼Œä¸å¤±ä¸ºä¸€ä¸ªå¥½åŠžæ³•ã€‚å¦‚æžœæ˜¯åµŒå…¥é¡µé¢çš„è¯æ¢æ¥çš„æ˜¯å¢žå¤§äº†é¡µé¢çš„ä½“ç§¯ï¼Œè€Œä¸”æ— æ³•åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ã€‚ä½¿ç”¨åœ¨ CSSä¸­çš„å›¾ç‰‡åˆ™æ›´ä¸ºç†æƒ³ä¸€äº›ã€‚ (6). Lazy Load Imagesï¼ˆè‡ªå·±å¯¹è¿™ä¸€å—çš„å†…å®¹è¿˜æ˜¯ä¸äº†è§£ï¼‰ è¿™æ¡ç­–ç•¥å®žé™…ä¸Šå¹¶ä¸ä¸€å®šèƒ½å‡å°‘ HTTPè¯·æ±‚æ•°ï¼Œä½†æ˜¯å´èƒ½åœ¨æŸäº›æ¡ä»¶ä¸‹æˆ–è€…é¡µé¢åˆšåŠ è½½æ—¶å‡å°‘ HTTPè¯·æ±‚æ•°ã€‚å¯¹äºŽå›¾ç‰‡è€Œè¨€ï¼Œåœ¨é¡µé¢åˆšåŠ è½½çš„æ—¶å€™å¯ä»¥åªåŠ è½½ç¬¬ä¸€å±ï¼Œå½“ç”¨æˆ·ç»§ç»­å¾€åŽæ»šå±çš„æ—¶å€™æ‰åŠ è½½åŽç»­çš„å›¾ç‰‡ã€‚è¿™æ ·ä¸€æ¥ï¼Œå‡å¦‚ç”¨æˆ·åªå¯¹ç¬¬ä¸€å±çš„å†…å®¹æ„Ÿå…´è¶£æ—¶ï¼Œé‚£å‰©ä½™çš„å›¾ç‰‡è¯·æ±‚å°±éƒ½èŠ‚çœäº†ã€‚ æœ‰å•Šé¦–é¡µ æ›¾ç»çš„åšæ³•æ˜¯åœ¨åŠ è½½çš„æ—¶å€™æŠŠç¬¬ä¸€å±ä¹‹åŽçš„å›¾ç‰‡åœ°å€ç¼“å­˜åœ¨ Textareaæ ‡ç­¾ä¸­ï¼Œå¾…ç”¨æˆ·å¾€ä¸‹æ»šå±çš„æ—¶å€™æ‰ â€œæƒ°æ€§â€ åŠ è½½ã€‚ å°†å¤–éƒ¨è„šæœ¬ç½®åº•ï¼ˆå°†è„šæœ¬å†…å®¹åœ¨é¡µé¢ä¿¡æ¯å†…å®¹åŠ è½½åŽå†åŠ è½½ï¼‰å¦‚æžœå°†è„šæœ¬æ”¾åœ¨æ¯”è¾ƒé å‰çš„ä½ç½®ï¼Œåˆ™ä¼šå½±å“æ•´ä¸ªé¡µé¢çš„åŠ è½½é€Ÿåº¦ä»Žè€Œå½±å“ç”¨æˆ·ä½“éªŒã€‚è§£å†³è¿™ä¸€é—®é¢˜çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œåœ¨ è¿™é‡Œæœ‰æ¯”è¾ƒè¯¦ç»†çš„ä»‹ç» (è¿™é‡Œæ˜¯è¯‘æ–‡å’Œ æ›´è¯¦ç»†çš„ä¾‹å­ )ï¼Œè€Œæœ€ç®€å•å¯ä¾èµ–çš„æ–¹æ³•å°±æ˜¯å°†è„šæœ¬å°½å¯èƒ½çš„å¾€åŽæŒªï¼Œå‡å°‘å¯¹å¹¶å‘ä¸‹è½½çš„å½±å“ã€‚ å¼‚æ­¥æ‰§è¡Œ inlineè„šæœ¬(å…¶å®žåŽŸç†å’Œä¸Šé¢æ˜¯ä¸€æ ·ï¼Œä¿è¯è„šæœ¬åœ¨é¡µé¢å†…å®¹åŽé¢åŠ è½½ã€‚)Lazy Load Javascriptï¼ˆåªæœ‰åœ¨éœ€è¦åŠ è½½çš„æ—¶å€™åŠ è½½ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹å¹¶ä¸åŠ è½½ä¿¡æ¯å†…å®¹ã€‚ï¼‰å°† CSSæ”¾åœ¨ HEADä¸­å¦‚æžœå°† CSSæ”¾åœ¨å…¶ä»–åœ°æ–¹æ¯”å¦‚ BODYä¸­ï¼Œåˆ™æµè§ˆå™¨æœ‰å¯èƒ½è¿˜æœªä¸‹è½½å’Œè§£æžåˆ° CSSå°±å·²ç»å¼€å§‹æ¸²æŸ“é¡µé¢äº†ï¼Œè¿™å°±å¯¼è‡´é¡µé¢ç”±æ—  CSSçŠ¶æ€è·³è½¬åˆ° CSSçŠ¶æ€ï¼Œç”¨æˆ·ä½“éªŒæ¯”è¾ƒç³Ÿç³•ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæœ‰äº›æµè§ˆå™¨ä¼šåœ¨ CSSä¸‹è½½å®ŒæˆåŽæ‰å¼€å§‹æ¸²æŸ“é¡µé¢ï¼Œå¦‚æžœ CSSæ”¾åœ¨é ä¸‹çš„ä½ç½®åˆ™ä¼šå¯¼è‡´æµè§ˆå™¨å°†æ¸²æŸ“æ—¶é—´æŽ¨è¿Ÿã€‚ å¼‚æ­¥è¯·æ±‚ Callbackï¼ˆå°±æ˜¯å°†ä¸€äº›è¡Œä¸ºæ ·å¼æå–å‡ºæ¥ï¼Œæ…¢æ…¢çš„åŠ è½½ä¿¡æ¯çš„å†…å®¹ï¼‰å‡å°‘ä¸å¿…è¦çš„ HTTPè·³è½¬å¯¹äºŽä»¥ç›®å½•å½¢å¼è®¿é—®çš„ HTTPé“¾æŽ¥ï¼Œå¾ˆå¤šäººéƒ½ä¼šå¿½ç•¥é“¾æŽ¥æœ€åŽæ˜¯å¦å¸¦ â€™/&apos;ï¼Œå‡å¦‚ä½ çš„æœåŠ¡å™¨å¯¹æ­¤æ˜¯åŒºåˆ«å¯¹å¾…çš„è¯ï¼Œé‚£ä¹ˆä½ ä¹Ÿéœ€è¦æ³¨æ„ï¼Œè¿™å…¶ä¸­å¾ˆå¯èƒ½éšè—äº† 301è·³è½¬ï¼Œå¢žåŠ äº†å¤šä½™è¯·æ±‚ã€‚å…·ä½“å‚è§ä¸‹å›¾ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªé“¾æŽ¥æ˜¯ä»¥æ—  â€™/&apos;ç»“å°¾çš„æ–¹å¼è®¿é—®çš„ï¼ŒäºŽæ˜¯æœåŠ¡å™¨æœ‰äº†ä¸€æ¬¡è·³è½¬ é¿å…é‡å¤çš„èµ„æºè¯·æ±‚è¿™ç§æƒ…å†µä¸»è¦æ˜¯ç”±äºŽç–å¿½æˆ–é¡µé¢ç”±å¤šä¸ªæ¨¡å—æ‹¼æŽ¥è€Œæˆï¼Œç„¶åŽæ¯ä¸ªæ¨¡å—ä¸­è¯·æ±‚äº†åŒæ ·çš„èµ„æºæ—¶ï¼Œä¼šå¯¼è‡´èµ„æºçš„é‡å¤è¯·æ±‚ ä»£ç çº§ä¼˜åŒ–JavascriptDOM DOMæ“ä½œåº”è¯¥æ˜¯è„šæœ¬ä¸­æœ€è€—æ€§èƒ½çš„ä¸€ç±»æ“ä½œï¼Œä¾‹å¦‚å¢žåŠ ã€ä¿®æ”¹ã€åˆ é™¤ DOMå…ƒç´ æˆ–è€…å¯¹ DOMé›†åˆè¿›è¡Œæ“ä½œã€‚å¦‚æžœè„šæœ¬ä¸­åŒ…å«äº†å¤§é‡çš„ DOMæ“ä½œåˆ™éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š HTML Collectionï¼ˆHTMLæ”¶é›†å™¨ï¼Œè¿”å›žçš„æ˜¯ä¸€ä¸ªæ•°ç»„å†…å®¹ä¿¡æ¯ï¼‰ åœ¨è„šæœ¬ä¸­ document.imagesã€document.forms ã€getElementsByTagName()è¿”å›žçš„éƒ½æ˜¯ HTMLCollectionç±»åž‹çš„é›†åˆï¼Œåœ¨å¹³æ—¶ä½¿ç”¨çš„æ—¶å€™å¤§å¤šå°†å®ƒä½œä¸ºæ•°ç»„æ¥ä½¿ç”¨ï¼Œå› ä¸ºå®ƒæœ‰ lengthå±žæ€§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç´¢å¼•è®¿é—®æ¯ä¸€ä¸ªå…ƒç´ ã€‚ä¸è¿‡åœ¨è®¿é—®æ€§èƒ½ä¸Šåˆ™æ¯”æ•°ç»„è¦å·®å¾ˆå¤šï¼ŒåŽŸå› æ˜¯è¿™ä¸ªé›†åˆå¹¶ä¸æ˜¯ä¸€ä¸ªé™æ€çš„ç»“æžœï¼Œå®ƒè¡¨ç¤ºçš„ä»…ä»…æ˜¯ä¸€ä¸ªç‰¹å®šçš„æŸ¥è¯¢ï¼Œæ¯æ¬¡è®¿é—®è¯¥é›†åˆæ—¶éƒ½ä¼šé‡æ–°æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ä»Žè€Œæ›´æ–°æŸ¥è¯¢ç»“æžœã€‚æ‰€è°“çš„ â€œè®¿é—®é›†åˆâ€ åŒ…æ‹¬è¯»å–é›†åˆçš„ lengthå±žæ€§ã€è®¿é—®é›†åˆä¸­çš„å…ƒç´ ã€‚ å› æ­¤ï¼Œå½“ä½ éœ€è¦éåŽ† HTML Collectionçš„æ—¶å€™ï¼Œå°½é‡å°†å®ƒè½¬ä¸ºæ•°ç»„åŽå†è®¿é—®ï¼Œä»¥æé«˜æ€§èƒ½ã€‚å³ä½¿ä¸è½¬æ¢ä¸ºæ•°ç»„ï¼Œä¹Ÿè¯·å°½å¯èƒ½å°‘çš„è®¿é—®å®ƒï¼Œä¾‹å¦‚åœ¨éåŽ†çš„æ—¶å€™å¯ä»¥å°† lengthå±žæ€§ã€æˆå‘˜ä¿å­˜åˆ°å±€éƒ¨å˜é‡åŽå†ä½¿ç”¨å±€éƒ¨å˜é‡ã€‚ reflow(å›žæµ)å’Œ repaint(é‡ç»˜)ç®€è¦ï¼šæ•´ä¸ªåœ¨æµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼ˆé¡µé¢åˆå§‹åŒ–ï¼Œç”¨æˆ·è¡Œä¸ºæ”¹å˜ç•Œé¢æ ·å¼ï¼ŒåŠ¨ç”»æ”¹å˜ç•Œé¢æ ·å¼ç­‰ï¼‰reflow(å›žæµ)å’Œrepaint(é‡ç»˜) ä¼šå¤§å¤§å½±å“webæ€§èƒ½ï¼Œå°¤å…¶æ˜¯æ‰‹æœºé¡µé¢ã€‚å› æ­¤æˆ‘ä»¬åœ¨é¡µé¢è®¾è®¡çš„æ—¶å€™è¦å°½é‡å‡å°‘reflowå’Œrepaintã€‚ ä»€ä¹ˆæ˜¯reflowå’Œrepain reflowï¼šä¾‹å¦‚æŸä¸ªå­å…ƒç´ æ ·å¼å‘ç”Ÿæ”¹å˜ï¼Œç›´æŽ¥å½±å“åˆ°äº†å…¶çˆ¶å…ƒç´ ä»¥åŠå¾€ä¸Šè¿½æº¯å¾ˆå¤šç¥–å…ˆå…ƒç´ ï¼ˆåŒ…æ‹¬å…„å¼Ÿå…ƒç´ ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™æµè§ˆå™¨è¦é‡æ–°åŽ»æ¸²æŸ“è¿™ä¸ªå­å…ƒç´ ç›¸å…³è”çš„æ‰€æœ‰å…ƒç´ çš„è¿‡ç¨‹ç§°ä¸ºå›žæµã€‚ reflowï¼šå‡ ä¹Žæ˜¯æ— æ³•é¿å…çš„ã€‚çŽ°åœ¨ç•Œé¢ä¸Šæµè¡Œçš„ä¸€äº›æ•ˆæžœï¼Œæ¯”å¦‚æ ‘çŠ¶ç›®å½•çš„æŠ˜å ã€å±•å¼€ï¼ˆå®žè´¨ä¸Šæ˜¯å…ƒç´ çš„æ˜¾ ç¤ºä¸Žéšè—ï¼‰ç­‰ï¼Œéƒ½å°†å¼•èµ·æµè§ˆå™¨çš„ reflowã€‚é¼ æ ‡æ»‘è¿‡ã€ç‚¹å‡»â€¦â€¦åªè¦è¿™äº›è¡Œä¸ºå¼•èµ·äº†é¡µé¢ä¸ŠæŸäº›å…ƒç´ çš„å ä½é¢ç§¯ã€å®šä½æ–¹å¼ã€è¾¹è·ç­‰å±žæ€§çš„å˜åŒ–ï¼Œéƒ½ä¼šå¼•èµ·å®ƒå†…éƒ¨ã€å‘¨å›´ç”šè‡³æ•´ä¸ªé¡µé¢çš„é‡æ–°æ¸² æŸ“ã€‚é€šå¸¸æˆ‘ä»¬éƒ½æ— æ³•é¢„ä¼°æµè§ˆå™¨åˆ°åº•ä¼š reflow å“ªä¸€éƒ¨åˆ†çš„ä»£ç ï¼Œå®ƒä»¬éƒ½å½¼æ­¤ç›¸äº’å½±å“ç€ã€‚ repaintï¼šå¦‚æžœåªæ˜¯æ”¹å˜æŸä¸ªå…ƒç´ çš„èƒŒæ™¯è‰²ã€æ–‡ å­—é¢œè‰²ã€è¾¹æ¡†é¢œè‰²ç­‰ç­‰ä¸å½±å“å®ƒå‘¨å›´æˆ–å†…éƒ¨å¸ƒå±€çš„å±žæ€§ï¼Œå°†åªä¼šå¼•èµ·æµè§ˆå™¨ repaintï¼ˆé‡ç»˜ï¼‰ã€‚repaint çš„é€Ÿåº¦æ˜Žæ˜¾å¿«äºŽ reflow ä¸‹é¢æƒ…å†µä¼šå¯¼è‡´reflowå‘ç”Ÿ 1ï¼šæ”¹å˜çª—å£å¤§å° 2ï¼šæ”¹å˜æ–‡å­—å¤§å° 3ï¼šå†…å®¹çš„æ”¹å˜ï¼Œå¦‚ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­æ•²å­— 4ï¼šæ¿€æ´»ä¼ªç±»ï¼Œå¦‚:hover 5ï¼šæ“ä½œclasså±žæ€§ 6ï¼šè„šæœ¬æ“ä½œDOM 7ï¼šè®¡ç®—offsetWidthå’ŒoffsetHeight 8ï¼šè®¾ç½®styleå±žæ€§ é‚£ä¹ˆä¸ºäº†å‡å°‘å›žæµè¦æ³¨æ„å“ªäº›æ–¹å¼å‘¢ï¼Ÿ 1ï¼šä¸è¦é€šè¿‡çˆ¶çº§æ¥æ”¹å˜å­å…ƒç´ æ ·å¼ï¼Œæœ€å¥½ç›´æŽ¥æ”¹å˜å­å…ƒç´ æ ·å¼ï¼Œæ”¹å˜å­å…ƒç´ æ ·å¼å°½å¯èƒ½ä¸è¦å½±å“çˆ¶å…ƒç´ å’Œå…„å¼Ÿå…ƒç´ çš„å¤§å°å’Œå°ºå¯¸ 2ï¼šå°½é‡é€šè¿‡classæ¥è®¾è®¡å…ƒç´ æ ·å¼ï¼Œåˆ‡å¿Œç”¨style 3ï¼šå®žçŽ°å…ƒç´ çš„åŠ¨ç”»ï¼Œå¯¹äºŽç»å¸¸è¦è¿›è¡Œå›žæµçš„ç»„ä»¶ï¼Œè¦æŠ½ç¦»å‡ºæ¥ï¼Œå®ƒçš„positionå±žæ€§åº”å½“è®¾ä¸ºfixedæˆ–absolute 4ï¼šæƒè¡¡é€Ÿåº¦çš„å¹³æ»‘ã€‚æ¯”å¦‚å®žçŽ°ä¸€ä¸ªåŠ¨ç”»ï¼Œä»¥1ä¸ªåƒç´ ä¸ºå•ä½ç§»åŠ¨è¿™æ ·æœ€å¹³æ»‘ï¼Œä½†reflowå°±ä¼šè¿‡äºŽé¢‘ç¹ï¼ŒCPUå¾ˆå¿«å°±ä¼šè¢«å®Œå…¨å ç”¨ã€‚å¦‚æžœä»¥3ä¸ªåƒç´ ä¸ºå•ä½ç§»åŠ¨å°±ä¼šå¥½å¾ˆå¤šã€‚ 5ï¼šä¸è¦ç”¨tableså¸ƒå±€çš„å¦ä¸€ä¸ªåŽŸå› å°±æ˜¯tablesä¸­æŸä¸ªå…ƒç´ ä¸€æ—¦è§¦å‘reflowå°±ä¼šå¯¼è‡´tableé‡Œæ‰€æœ‰çš„å…¶å®ƒå…ƒç´ reflowã€‚åœ¨é€‚åˆç”¨tableçš„åœºåˆï¼Œå¯ä»¥è®¾ç½®table-layoutä¸ºautoæˆ–fixedï¼Œ 6ï¼šè¿™æ ·å¯ä»¥è®©tableä¸€è¡Œä¸€è¡Œçš„æ¸²æŸ“ï¼Œè¿™ç§åšæ³•ä¹Ÿæ˜¯ä¸ºäº†é™åˆ¶reflowçš„å½±å“èŒƒå›´ã€‚ 7ï¼šcssé‡Œä¸è¦æœ‰è¡¨è¾¾å¼expression 8ï¼šå‡å°‘ä¸å¿…è¦çš„ DOM å±‚çº§ï¼ˆDOM depthï¼‰ã€‚æ”¹å˜ DOM æ ‘ä¸­çš„ä¸€çº§ä¼šå¯¼è‡´æ‰€æœ‰å±‚çº§çš„æ”¹å˜ï¼Œä¸Šè‡³æ ¹éƒ¨ï¼Œä¸‹è‡³è¢«æ”¹å˜èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ã€‚è¿™å¯¼è‡´å¤§é‡æ—¶é—´è€—è´¹åœ¨æ‰§è¡Œ reflow ä¸Šé¢ã€‚ 9ï¼šé¿å…ä¸å¿…è¦çš„å¤æ‚çš„ CSS é€‰æ‹©å™¨ï¼Œå°¤å…¶æ˜¯åŽä»£é€‰æ‹©å™¨ï¼ˆdescendant selectorsï¼‰ï¼Œå› ä¸ºä¸ºäº†åŒ¹é…é€‰æ‹©å™¨å°†è€—è´¹æ›´å¤šçš„ CPUã€‚ 10: å°½é‡ä¸è¦è¿‡å¤šçš„é¢‘ç¹çš„åŽ»å¢žåŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤å…ƒç´ ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šé¢‘ç¹çš„å¯¼è‡´é¡µé¢reflowï¼Œå¯ä»¥å…ˆæŠŠè¯¥domèŠ‚ç‚¹æŠ½ç¦»åˆ°å†…å­˜ä¸­è¿›è¡Œå¤æ‚çš„æ“ä½œç„¶åŽå†displayåˆ°é¡µé¢ä¸Šã€‚ 11ï¼šè¯·æ±‚å¦‚ä¸‹å€¼offsetTop, offsetLeft, offsetWidth, offsetHeightï¼ŒscrollTop/Left/Width/Heightï¼ŒclientTop/Left/Width/Heightï¼Œæµè§ˆå™¨ä¼šå‘ç”Ÿreflowï¼Œå»ºè®®å°†ä»–ä»¬åˆå¹¶åˆ°ä¸€èµ·æ“ä½œï¼Œå¯ä»¥å‡å°‘å›žæµçš„æ¬¡æ•°ã€‚ å¦‚æžœæˆ‘ä»¬è¦ç»å¸¸åŽ»èŽ·å–å’Œæ“ä½œè¿™äº›å€¼ï¼Œåˆ™å¯ä»¥å…ˆå°†è¿™äº›å€¼ç¼“å­˜èµ·æ¥ä¾‹å¦‚ï¼š123456789var windowHeight = window.innerHeight;//reflowfor(i=0;i&lt;10;i++)&#123; $body.height(windowHeight++); ä¸€ç³»åˆ—å…³äºŽwindowHeightçš„æ“ä½œ.......&#125; (2). æ…Žç”¨ withwith(obj){ p = 1}; ä»£ç å—çš„è¡Œä¸ºå®žé™…ä¸Šæ˜¯ä¿®æ”¹äº†ä»£ç å—ä¸­çš„ æ‰§è¡ŒçŽ¯å¢ƒ ï¼Œå°†objæ”¾åœ¨äº†å…¶ä½œç”¨åŸŸé“¾çš„æœ€å‰ç«¯ï¼Œåœ¨ withä»£ç å—ä¸­è®¿é—®éžå±€éƒ¨å˜é‡æ˜¯éƒ½æ˜¯å…ˆä»Ž objä¸Šå¼€å§‹æŸ¥æ‰¾ï¼Œå¦‚æžœæ²¡æœ‰å†ä¾æ¬¡æŒ‰ä½œç”¨åŸŸé“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œå› æ­¤ä½¿ç”¨ withç›¸å½“äºŽå¢žåŠ äº†ä½œç”¨åŸŸé“¾é•¿åº¦ã€‚è€Œæ¯æ¬¡æŸ¥æ‰¾ä½œç”¨åŸŸé“¾éƒ½æ˜¯è¦æ¶ˆè€—æ—¶é—´çš„ï¼Œè¿‡é•¿çš„ä½œç”¨åŸŸé“¾ä¼šå¯¼è‡´æŸ¥æ‰¾æ€§èƒ½ä¸‹é™ã€‚ å› æ­¤ï¼Œé™¤éžä½ èƒ½è‚¯å®šåœ¨ withä»£ç ä¸­åªè®¿é—® objä¸­çš„å±žæ€§ï¼Œå¦åˆ™æ…Žç”¨ withï¼Œæ›¿ä»£çš„å¯ä»¥ä½¿ç”¨å±€éƒ¨å˜é‡ç¼“å­˜éœ€è¦è®¿é—®çš„å±žæ€§ã€‚ (3). é¿å…ä½¿ç”¨ evalå’Œ Function æ¯æ¬¡ eval æˆ– Function æž„é€ å‡½æ•°ä½œç”¨äºŽå­—ç¬¦ä¸²è¡¨ç¤ºçš„æºä»£ç æ—¶ï¼Œè„šæœ¬å¼•æ“Žéƒ½éœ€è¦å°†æºä»£ç è½¬æ¢æˆå¯æ‰§è¡Œä»£ç ã€‚è¿™æ˜¯å¾ˆæ¶ˆè€—èµ„æºçš„æ“ä½œ â€”â€” é€šå¸¸æ¯”ç®€å•çš„å‡½æ•°è°ƒç”¨æ…¢ 100å€ä»¥ä¸Šã€‚ eval å‡½æ•°æ•ˆçŽ‡ç‰¹åˆ«ä½Žï¼Œç”±äºŽäº‹å…ˆæ— æ³•çŸ¥æ™“ä¼ ç»™ eval çš„å­—ç¬¦ä¸²ä¸­çš„å†…å®¹ï¼Œevalåœ¨å…¶ä¸Šä¸‹æ–‡ä¸­è§£é‡Šè¦å¤„ç†çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯è¯´ç¼–è¯‘å™¨æ— æ³•ä¼˜åŒ–ä¸Šä¸‹æ–‡ï¼Œå› æ­¤åªèƒ½æœ‰æµè§ˆå™¨åœ¨è¿è¡Œæ—¶è§£é‡Šä»£ç ã€‚è¿™å¯¹æ€§èƒ½å½±å“å¾ˆå¤§ã€‚ Function æž„é€ å‡½æ•°æ¯” evalç•¥å¥½ï¼Œå› ä¸ºä½¿ç”¨æ­¤ä»£ç ä¸ä¼šå½±å“å‘¨å›´ä»£ç  ;ä½†å…¶é€Ÿåº¦ä»å¾ˆæ…¢ã€‚ æ­¤å¤–ï¼Œä½¿ç”¨ evalå’Œ Functionä¹Ÿä¸åˆ©äºŽJavascript åŽ‹ç¼©å·¥å…·æ‰§è¡ŒåŽ‹ç¼©ã€‚ (4). å‡å°‘ä½œç”¨åŸŸé“¾æŸ¥æ‰¾ï¼ˆè¿™æ–¹é¢è®¾è®¡åˆ°ä¸€äº›å†…å®¹çš„ç›¸å…³é—®é¢˜ï¼‰ å‰æ–‡è°ˆåˆ°äº†ä½œç”¨åŸŸé“¾æŸ¥æ‰¾é—®é¢˜ï¼Œè¿™ä¸€ç‚¹åœ¨å¾ªçŽ¯ä¸­æ˜¯å°¤å…¶éœ€è¦æ³¨æ„çš„é—®é¢˜ã€‚å¦‚æžœåœ¨å¾ªçŽ¯ä¸­éœ€è¦è®¿é—®éžæœ¬ä½œç”¨åŸŸä¸‹çš„å˜é‡æ—¶è¯·åœ¨éåŽ†ä¹‹å‰ç”¨å±€éƒ¨å˜é‡ç¼“å­˜è¯¥å˜é‡ï¼Œå¹¶åœ¨éåŽ†ç»“æŸåŽå†é‡å†™é‚£ä¸ªå˜é‡ï¼Œè¿™ä¸€ç‚¹å¯¹å…¨å±€å˜é‡å°¤å…¶é‡è¦ï¼Œå› ä¸ºå…¨å±€å˜é‡å¤„äºŽä½œç”¨åŸŸé“¾çš„æœ€é¡¶ç«¯ï¼Œè®¿é—®æ—¶çš„æŸ¥æ‰¾æ¬¡æ•°æ˜¯æœ€å¤šçš„ã€‚ ä½Žæ•ˆçŽ‡çš„å†™æ³•ï¼š12345// å…¨å±€å˜é‡ var globalVar = 1; function myCallback(info)&#123; for( var i = 100000; i--;)&#123; //æ¯æ¬¡è®¿é—® globalVar éƒ½éœ€è¦æŸ¥æ‰¾åˆ°ä½œç”¨åŸŸé“¾æœ€é¡¶ç«¯ï¼Œæœ¬ä¾‹ä¸­éœ€è¦è®¿é—® 100000 æ¬¡ globalVar += i; &#125; &#125; æ›´é«˜æ•ˆçš„å†™æ³•ï¼š123456789101112// å…¨å±€å˜é‡ var globalVar = 1; function myCallback(info)&#123; //å±€éƒ¨å˜é‡ç¼“å­˜å…¨å±€å˜é‡ var localVar = globalVar; for( var i = 100000; i--;)&#123; //è®¿é—®å±€éƒ¨å˜é‡æ˜¯æœ€å¿«çš„ localVar += i; &#125; //æœ¬ä¾‹ä¸­åªéœ€è¦è®¿é—® 2æ¬¡å…¨å±€å˜é‡åœ¨å‡½æ•°ä¸­åªéœ€è¦å°† globalVarä¸­å†…å®¹çš„å€¼èµ‹ç»™localVar ä¸­åŒº globalVar = localVar; &#125; æ­¤å¤–ï¼Œè¦å‡å°‘ä½œç”¨åŸŸé“¾æŸ¥æ‰¾è¿˜åº”è¯¥å‡å°‘é—­åŒ…çš„ä½¿ç”¨ã€‚ (5). æ•°æ®è®¿é—® Javascriptä¸­çš„æ•°æ®è®¿é—®åŒ…æ‹¬ç›´æŽ¥é‡ (å­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼ )ã€å˜é‡ã€å¯¹è±¡å±žæ€§ä»¥åŠæ•°ç»„ï¼Œå…¶ä¸­å¯¹ç›´æŽ¥é‡å’Œå±€éƒ¨å˜é‡çš„è®¿é—®æ˜¯æœ€å¿«çš„ï¼Œå¯¹å¯¹è±¡å±žæ€§ä»¥åŠæ•°ç»„çš„è®¿é—®éœ€è¦æ›´å¤§çš„å¼€é”€ã€‚å½“å‡ºçŽ°ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œå»ºè®®å°†æ•°æ®æ”¾å…¥å±€éƒ¨å˜é‡ï¼š a. å¯¹ä»»ä½•å¯¹è±¡å±žæ€§çš„è®¿é—®è¶…è¿‡ 1æ¬¡ b. å¯¹ä»»ä½•æ•°ç»„æˆå‘˜çš„è®¿é—®æ¬¡æ•°è¶…è¿‡ 1æ¬¡ å¦å¤–ï¼Œè¿˜åº”å½“å°½å¯èƒ½çš„å‡å°‘å¯¹å¯¹è±¡ä»¥åŠæ•°ç»„æ·±åº¦æŸ¥æ‰¾ã€‚ (6). å­—ç¬¦ä¸²æ‹¼æŽ¥ åœ¨ Javascriptä¸­ä½¿ç”¨â€+â€ å·æ¥æ‹¼æŽ¥å­—ç¬¦ä¸²æ•ˆçŽ‡æ˜¯æ¯”è¾ƒä½Žçš„ï¼Œå› ä¸ºæ¯æ¬¡è¿è¡Œéƒ½ä¼šå¼€è¾Ÿæ–°çš„å†…å­˜å¹¶ç”Ÿæˆæ–°çš„å­—ç¬¦ä¸²å˜é‡ï¼Œç„¶åŽå°†æ‹¼æŽ¥ç»“æžœèµ‹å€¼ç»™æ–°å˜é‡ã€‚ä¸Žä¹‹ç›¸æ¯”æ›´ä¸ºé«˜æ•ˆçš„åšæ³•æ˜¯ä½¿ç”¨æ•°ç»„çš„ joinæ–¹æ³•ï¼Œå³å°†éœ€è¦æ‹¼æŽ¥çš„å­—ç¬¦ä¸²æ”¾åœ¨æ•°ç»„ä¸­æœ€åŽè°ƒç”¨å…¶ joinæ–¹æ³•å¾—åˆ°ç»“æžœã€‚ ä¸è¿‡ç”±äºŽä½¿ç”¨æ•°ç»„ä¹Ÿæœ‰ä¸€å®šçš„å¼€é”€ï¼Œå› æ­¤å½“éœ€è¦æ‹¼æŽ¥çš„å­—ç¬¦ä¸²è¾ƒå¤šçš„æ—¶å€™å¯ä»¥è€ƒè™‘ç”¨æ­¤æ–¹æ³•ã€‚ CSSé€‰æ‹©ç¬¦åœ¨å¤§å¤šæ•°äººçš„è§‚å¿µä¸­ï¼Œéƒ½è§‰å¾—æµè§ˆå™¨å¯¹ CSSé€‰æ‹©ç¬¦çš„è§£æžå¼ä»Žå·¦å¾€å³è¿›è¡Œçš„ï¼Œä¾‹å¦‚#toc A { color: #444; } è¿™æ ·ä¸€ä¸ªé€‰æ‹©ç¬¦ï¼Œå¦‚æžœæ˜¯ä»Žå³å¾€å·¦è§£æžåˆ™æ•ˆçŽ‡ä¼šå¾ˆé«˜ï¼Œå› ä¸ºç¬¬ä¸€ä¸ª IDé€‰æ‹©åŸºæœ¬ä¸Šå°±æŠŠæŸ¥æ‰¾çš„èŒƒå›´é™å®šäº†ï¼Œä½†å®žé™…ä¸Šæµè§ˆå™¨å¯¹é€‰æ‹©ç¬¦çš„è§£æžæ˜¯ä»Žå³å¾€å·¦è¿›è¡Œçš„ã€‚å¦‚ä¸Šé¢çš„é€‰æ‹©ç¬¦ï¼Œæµè§ˆå™¨å¿…é¡»éåŽ†æŸ¥æ‰¾æ¯ä¸€ä¸ª Aæ ‡ç­¾çš„ç¥–å…ˆèŠ‚ç‚¹ï¼Œæ•ˆçŽ‡å¹¶ä¸åƒä¹‹å‰æƒ³è±¡çš„é‚£æ ·é«˜ã€‚æ ¹æ®æµè§ˆå™¨çš„è¿™ä¸€è¡Œä¸ºç‰¹ç‚¹ï¼Œåœ¨å†™é€‰æ‹©ç¬¦çš„æ—¶å€™éœ€è¦æ³¨æ„å¾ˆå¤šäº‹é¡¹ HTMLå¯¹ HTMLæœ¬èº«çš„ä¼˜åŒ–çŽ°å¦‚ä»Šä¹Ÿè¶Šæ¥è¶Šå¤šçš„å—äººå…³æ³¨äº†ï¼Œè¯¦æƒ…å¯ä»¥å‚è§è¿™ç¯‡æ€»ç»“æ€§æ–‡ç«  ImageåŽ‹ç¼©ä¸€ä¸ªéžå¸¸å®žç”¨çš„ImageåŽ‹ç¼©çš„ç½‘ç«™ å›¾ç‰‡åŽ‹ç¼©æ˜¯ä¸ªæŠ€æœ¯æ´»ï¼Œä¸è¿‡çŽ°å¦‚ä»Šè¿™æ–¹é¢çš„å·¥å…·ä¹Ÿéžå¸¸å¤šï¼ŒåŽ‹ç¼©ä¹‹åŽå¾€å¾€èƒ½å¸¦æ¥ä¸é”™çš„æ•ˆæžœï¼Œå…·ä½“çš„åŽ‹ç¼©åŽŸç†ä»¥åŠæ–¹æ³•åœ¨ã€Š Even Faster Web Sitesã€‹ç¬¬10 ç« æœ‰å¾ˆè¯¦ç»†çš„ä»‹ç»ï¼Œæœ‰å…´è¶£çš„å¯ä»¥åŽ»çœ‹çœ‹ã€‚ ã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾æŒ‡å—ã€‹æå‡ºçš„è§„åˆ™ è§„åˆ™1â€”â€”-å‡å°‘HTTPè¯·æ±‚ è§„åˆ™2â€”â€”-ä½¿ç”¨å†…å®¹å‘å¸ƒç½‘ç»œ è§„åˆ™3â€”â€”-æ·»åŠ Expireså¤´æŽ§åˆ¶ç¼“å­˜ è§„åˆ™4â€”â€”-åŽ‹ç¼©ç»„ä»¶ è§„åˆ™5â€”â€”-å°†æ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨ è§„åˆ™6â€”â€”-å°†è„šæ­¥æ”¾åœ¨åº•éƒ¨ è§„åˆ™7â€”â€”-é¿å…cssè¡¨è¾¾å¼ è§„åˆ™8â€”â€”-ä½¿ç”¨å¤–éƒ¨javaScriptå’ŒCSS è§„åˆ™9â€”â€”-å‡å°‘DNSæŸ¥æ‰¾ è§„åˆ™10â€”â€”-ç²¾ç®€javaScript è§„åˆ™11â€”â€”-é¿å…é‡å®šå‘ è§„åˆ™12â€”â€”-åˆ é™¤é‡å¤è„šæ­¥ è§„åˆ™13â€”â€”-é…ç½®ETag è§„åˆ™14â€”â€”-ä½¿Ajaxå¯ç¼“å­˜]]></content>
      <categories>
        <category>æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ajaxå·²æ­»ï¼ŒFetchæ°¸ç”Ÿ]]></title>
    <url>%2F2018%2F03%2F10%2Fstudy%2FAjax%E5%B7%B2%E6%AD%BB%EF%BC%8CFetch%E6%B0%B8%E7%94%9F%2F</url>
    <content type="text"><![CDATA[ç”±äºŽ Fetch API æ˜¯åŸºäºŽ Promise è®¾è®¡ï¼Œæœ‰å¿…è¦å…ˆå­¦ä¹ ä¸€ä¸‹ Promiseï¼ŒæŽ¨èé˜…è¯» MDN Promise æ•™ç¨‹ã€‚æ—§æµè§ˆå™¨ä¸æ”¯æŒ Promiseï¼Œéœ€è¦ä½¿ç”¨ polyfill es6-promise ã€‚ æœ¬æ–‡ä¸æ˜¯ Fetch API ç§‘æ™®è´´ï¼Œå…¶å®žæ˜¯è®²å¼‚æ­¥å¤„ç†å’Œ Promise çš„ã€‚Fetch API å¾ˆç®€å•ï¼Œçœ‹æ–‡æ¡£å¾ˆå¿«å°±å­¦ä¼šäº†ã€‚æŽ¨è MDN Fetch æ•™ç¨‹ å’Œ ä¸‡èƒ½çš„WHATWG Fetch è§„èŒƒ Why FetchXMLHttpRequest æ˜¯ä¸€ä¸ªè®¾è®¡ç²—ç³™çš„ APIï¼Œä¸ç¬¦åˆå…³æ³¨åˆ†ç¦»ï¼ˆSeparation of Concernsï¼‰çš„åŽŸåˆ™ï¼Œé…ç½®å’Œè°ƒç”¨æ–¹å¼éžå¸¸æ··ä¹±ï¼Œè€Œä¸”åŸºäºŽäº‹ä»¶çš„å¼‚æ­¥æ¨¡åž‹å†™èµ·æ¥ä¹Ÿæ²¡æœ‰çŽ°ä»£çš„ Promiseï¼Œgenerator/yieldï¼Œasync/await å‹å¥½ã€‚ Fetch çš„å‡ºçŽ°å°±æ˜¯ä¸ºäº†è§£å†³ XHR çš„é—®é¢˜ï¼Œæ‹¿ä¾‹å­è¯´æ˜Žï¼š ä½¿ç”¨ XHR å‘é€ä¸€ä¸ª json è¯·æ±‚ä¸€èˆ¬æ˜¯è¿™æ ·ï¼š12345678910111213var xhr = new XMLHttpRequest();xhr.open('GET', url);xhr.responseType = 'json';xhr.onload = function() &#123; console.log(xhr.response);&#125;;xhr.onerror = function() &#123; console.log("Oops, error");&#125;;xhr.send(); ä½¿ç”¨ Fetch åŽï¼Œé¡¿æ—¶çœ‹èµ·æ¥å¥½ä¸€ç‚¹ 1234567fetch(url).then(function(response) &#123; return response.json();&#125;).then(function(data) &#123; console.log(data);&#125;).catch(function(e) &#123; console.log("Oops, error");&#125;); ä½¿ç”¨ ES6 çš„ ç®­å¤´å‡½æ•° åŽï¼š 123fetch(url).then(response =&gt; response.json()) .then(data =&gt; console.log(data)) .catch(e =&gt; console.log("Oops, error", e)) çŽ°åœ¨çœ‹èµ·æ¥å¥½å¾ˆå¤šäº†ï¼Œä½†è¿™ç§ Promise çš„å†™æ³•è¿˜æ˜¯æœ‰ Callback çš„å½±å­ï¼Œè€Œä¸” promise ä½¿ç”¨ catch æ–¹æ³•æ¥è¿›è¡Œé”™è¯¯å¤„ç†çš„æ–¹å¼æœ‰ç‚¹å¥‡æ€ªã€‚ä¸ç”¨æ€¥ï¼Œä¸‹é¢ä½¿ç”¨ async/await æ¥åšæœ€ç»ˆä¼˜åŒ– æ³¨ï¼šasync/await æ˜¯éžå¸¸æ–°çš„ APIï¼Œå±žäºŽ ES7ï¼Œç›®å‰å°šåœ¨ Stage 1(æè®®) é˜¶æ®µï¼Œè¿™æ˜¯å®ƒçš„å®Œæ•´è§„èŒƒã€‚ä½¿ç”¨ Babel å¼€å¯ runtime æ¨¡å¼åŽå¯ä»¥æŠŠ async/await æ— ç—›ç¼–è¯‘æˆ ES5 ä»£ç ã€‚ä¹Ÿå¯ä»¥ç›´æŽ¥ä½¿ç”¨ regenerator æ¥ç¼–è¯‘åˆ° ES5ã€‚ 12345678try &#123; let response = await fetch(url); let data = await response.json(); console.log(data);&#125; catch(e) &#123; console.log("Oops, error", e);&#125;// æ³¨ï¼šè¿™æ®µä»£ç å¦‚æžœæƒ³è¿è¡Œï¼Œå¤–é¢éœ€è¦åŒ…ä¸€ä¸ª async function duang~~ çš„ä¸€å£°ï¼Œä½¿ç”¨ await åŽï¼Œå†™å¼‚æ­¥ä»£ç å°±åƒå†™åŒæ­¥ä»£ç ä¸€æ ·çˆ½ã€‚await åŽé¢å¯ä»¥è·Ÿ Promise å¯¹è±¡ï¼Œè¡¨ç¤ºç­‰å¾… Promise resolve() æ‰ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œå¦‚æžœ Promise è¢« reject() æˆ–æŠ›å‡ºå¼‚å¸¸åˆ™ä¼šè¢«å¤–é¢çš„ tryâ€¦catch æ•èŽ·ã€‚ Promiseï¼Œgenerator/yieldï¼Œawait/async éƒ½æ˜¯çŽ°åœ¨å’Œæœªæ¥ JS è§£å†³å¼‚æ­¥çš„æ ‡å‡†åšæ³•ï¼Œå¯ä»¥å®Œç¾Žæ­é…ä½¿ç”¨ã€‚è¿™ä¹Ÿæ˜¯ä½¿ç”¨æ ‡å‡† Promise ä¸€å¤§å¥½å¤„ã€‚æœ€è¿‘ä¹ŸæŠŠé¡¹ç›®ä¸­ä½¿ç”¨ç¬¬ä¸‰æ–¹ Promise åº“çš„ä»£ç å…¨éƒ¨è½¬æˆæ ‡å‡† Promiseï¼Œä¸ºä»¥åŽå…¨é¢ä½¿ç”¨ async/await åšå‡†å¤‡ã€‚ å¦å¤–ï¼ŒFetch ä¹Ÿå¾ˆé€‚åˆåšçŽ°åœ¨æµè¡Œçš„åŒæž„åº”ç”¨ï¼Œæœ‰äººåŸºäºŽ Fetch çš„è¯­æ³•ï¼Œåœ¨ Node ç«¯åŸºäºŽ http åº“å®žçŽ°äº† node-fetchï¼Œåˆæœ‰äººå°è£…äº†ç”¨äºŽåŒæž„åº”ç”¨çš„ isomorphic-fetchã€‚ æ³¨ï¼šåŒæž„(isomorphic/universal)å°±æ˜¯ä½¿å‰åŽç«¯è¿è¡ŒåŒä¸€å¥—ä»£ç çš„æ„æ€ï¼ŒåŽç«¯ä¸€èˆ¬æ˜¯æŒ‡ NodeJS çŽ¯å¢ƒã€‚ æ€»ç»“ä¸€ä¸‹ï¼ŒFetch ä¼˜ç‚¹ä¸»è¦æœ‰ï¼š è¯­æ³•ç®€æ´ï¼Œæ›´åŠ è¯­ä¹‰åŒ– åŸºäºŽæ ‡å‡† Promise å®žçŽ°ï¼Œæ”¯æŒ async/await åŒæž„æ–¹ä¾¿ï¼Œä½¿ç”¨ isomorphic-fetch Fetch å¯ç”¨æ–¹æ³•å…ˆçœ‹ä¸€ä¸‹ Fetch åŽŸç”Ÿæ”¯æŒçŽ‡ï¼š åŽŸç”Ÿæ”¯æŒçŽ‡å¹¶ä¸é«˜ï¼Œå¹¸è¿çš„æ˜¯ï¼Œå¼•å…¥ä¸‹é¢è¿™äº› polyfill åŽå¯ä»¥å®Œç¾Žæ”¯æŒ IE8+ ï¼š ç”±äºŽ IE8 æ˜¯ ES3ï¼Œéœ€è¦å¼•å…¥ ES5 çš„ polyfill: es5-shim,es5-sham å¼•å…¥ Promise çš„ polyfill: es6-promise å¼•å…¥ fetch æŽ¢æµ‹åº“ï¼šfetch-detector å¼•å…¥ fetch çš„ polyfill: fetch-ie8 å¯é€‰ï¼šå¦‚æžœä½ è¿˜ä½¿ç”¨äº† jsonpï¼Œå¼•å…¥ fetch-jsonp å¯é€‰ï¼šå¼€å¯ Babel çš„ runtime æ¨¡å¼ï¼ŒçŽ°åœ¨å°±ä½¿ç”¨ async/await Fetch polyfill çš„åŸºæœ¬åŽŸç†æ˜¯æŽ¢æµ‹æ˜¯å¦å­˜åœ¨ window.fetch æ–¹æ³•ï¼Œå¦‚æžœæ²¡æœ‰åˆ™ç”¨ XHR å®žçŽ°ã€‚è¿™ä¹Ÿæ˜¯ github/fetch çš„åšæ³•ï¼Œä½†æ˜¯æœ‰äº›æµè§ˆå™¨ï¼ˆChrome 45ï¼‰åŽŸç”Ÿæ”¯æŒ Fetchï¼Œä½†å“åº”ä¸­æœ‰ä¸­æ–‡æ—¶ä¼šä¹±ç ï¼Œè€å¤–åˆä¸å¤ªå…³å¿ƒè¿™ç§é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±æ‰å°è£…äº† fetch-detector å’Œ fetch-ie8 åªåœ¨æµè§ˆå™¨ç¨³å®šæ”¯æŒ Fetch æƒ…å†µä¸‹æ‰ä½¿ç”¨åŽŸç”Ÿ Fetchã€‚è¿™äº›åº“çŽ°åœ¨ æ¯å¤©æœ‰å‡ åƒä¸‡ä¸ªè¯·æ±‚éƒ½åœ¨ä½¿ç”¨ï¼Œç»å¯¹é è°±ï¼ ç»ˆäºŽï¼Œå¼•ç”¨äº†è¿™ä¸€å † polyfill åŽï¼Œå¯ä»¥æ„‰å¿«åœ°ä½¿ç”¨ Fetch äº†ã€‚ä½†è¦å°å¿ƒï¼Œä¸‹é¢æœ‰å‘ï¼š Fetch å¸¸è§å‘ Fetch è¯·æ±‚é»˜è®¤æ˜¯ä¸å¸¦ cookie çš„ï¼Œéœ€è¦è®¾ç½® fetch(url, {credentials: â€˜includeâ€™}) æœåŠ¡å™¨è¿”å›ž 400ï¼Œ500 é”™è¯¯ç æ—¶å¹¶ä¸ä¼š rejectï¼Œåªæœ‰ç½‘ç»œé”™è¯¯è¿™äº›å¯¼è‡´è¯·æ±‚ä¸èƒ½å®Œæˆæ—¶ï¼Œfetch æ‰ä¼šè¢« rejectã€‚ ç«Ÿç„¶æ²¡æœ‰æåˆ° IEï¼Œè¿™å®žåœ¨å¤ªä¸ç§‘å­¦äº†ï¼ŒçŽ°åœ¨æ¥è¯¦ç»†è¯´ä¸‹ IE IE ä½¿ç”¨ç­–ç•¥æ‰€æœ‰ç‰ˆæœ¬çš„ IE å‡ä¸æ”¯æŒåŽŸç”Ÿ Fetchï¼Œfetch-ie8 ä¼šè‡ªåŠ¨ä½¿ç”¨ XHR åš polyfillã€‚ä½†åœ¨è·¨åŸŸæ—¶æœ‰ä¸ªé—®é¢˜éœ€è¦å¤„ç†ã€‚ IE8, 9 çš„ XHR ä¸æ”¯æŒ CORS è·¨åŸŸï¼Œè™½ç„¶æä¾› XDomainRequestï¼Œä½†è¿™ä¸ªä¸œè¥¿å°±æ˜¯çŽ©å…·ï¼Œä¸æ”¯æŒä¼  Cookieï¼å¦‚æžœæŽ¥å£éœ€è¦æƒé™éªŒè¯ï¼Œè¿˜æ˜¯ä¹–ä¹–åœ°ä½¿ç”¨ jsonp å§ï¼ŒæŽ¨èä½¿ç”¨ fetch-jsonpã€‚å¦‚æžœæœ‰é—®é¢˜ç›´æŽ¥æ issueï¼Œæˆ‘ä¼šç¬¬ä¸€æ—¶é—´è§£å†³ã€‚ Fetch å’Œæ ‡å‡† Promise çš„ä¸è¶³ç”±äºŽ Fetch æ˜¯å…¸åž‹çš„å¼‚æ­¥åœºæ™¯ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†é‡åˆ°çš„é—®é¢˜ä¸æ˜¯ Fetch çš„ï¼Œå…¶å®žæ˜¯ Promise çš„ã€‚ES6 çš„ Promise æ˜¯åŸºäºŽ Promises/A+ æ ‡å‡† ï¼Œä¸ºäº†ä¿æŒ ç®€å•ç®€æ´ ï¼Œåªæä¾›æžç®€çš„å‡ ä¸ª APIã€‚å¦‚æžœä½ ç”¨è¿‡ä¸€äº›ç‰› X çš„å¼‚æ­¥åº“ï¼Œå¦‚ jQuery(ä¸è¦ç¬‘) ã€Q.js æˆ–è€… RSVP.jsï¼Œå¯èƒ½ä¼šæ„Ÿè§‰ Promise åŠŸèƒ½å¤ªå°‘äº†ã€‚ æ²¡æœ‰ DeferredDeferred å¯ä»¥åœ¨åˆ›å»º Promise æ—¶å¯ä»¥å‡å°‘ä¸€å±‚åµŒå¥—ï¼Œè¿˜æœ‰å°±æ˜¯è·¨æ–¹æ³•ä½¿ç”¨æ—¶å¾ˆæ–¹ä¾¿ã€‚ECMAScript 11 å¹´å°±æœ‰è¿‡ Deferred ææ¡ˆï¼Œä½†åŽæ¥æ²¡è¢«æŽ¥å—ã€‚å…¶å®žç”¨ Promise ä¸åˆ°åè¡Œä»£ç å°±èƒ½å®žçŽ° Deferredï¼šes6-deferredã€‚çŽ°åœ¨æœ‰äº† async/awaitï¼Œgenerator/yield åŽï¼Œdeferred å°±æ²¡æœ‰ä½¿ç”¨ä»·å€¼äº†ã€‚ æ²¡æœ‰èŽ·å–çŠ¶æ€æ–¹æ³•ï¼šisRejectedï¼ŒisResolvedæ ‡å‡† Promise æ²¡æœ‰æä¾›èŽ·å–å½“å‰çŠ¶æ€ rejected æˆ–è€… resolved çš„æ–¹æ³•ã€‚åªå…è®¸å¤–éƒ¨ä¼ å…¥æˆåŠŸæˆ–å¤±è´¥åŽçš„å›žè°ƒã€‚æˆ‘è®¤ä¸ºè¿™å…¶å®žæ˜¯ä¼˜ç‚¹ï¼Œè¿™æ˜¯ä¸€ç§å£°æ˜Žå¼çš„æŽ¥å£ï¼Œæ›´ç®€å•ã€‚ ç¼ºå°‘å…¶å®ƒä¸€äº›æ–¹æ³•ï¼šalwaysï¼Œprogressï¼Œfinallyalways å¯ä»¥é€šè¿‡åœ¨ then å’Œ catch é‡Œé‡å¤è°ƒç”¨æ–¹æ³•å®žçŽ°ã€‚finally ä¹Ÿç±»ä¼¼ã€‚progress è¿™ç§è¿›åº¦é€šçŸ¥çš„åŠŸèƒ½è¿˜æ²¡æœ‰ç”¨è¿‡ï¼Œæš‚ä¸çŸ¥é“å¦‚ä½•æ›¿ä»£ã€‚ ä¸èƒ½ä¸­æ–­ï¼Œæ²¡æœ‰ abortã€terminateã€onTimeout æˆ– cancel æ–¹æ³•Fetch å’Œ Promise ä¸€æ ·ï¼Œä¸€æ—¦å‘èµ·ï¼Œä¸èƒ½ä¸­æ–­ï¼Œä¹Ÿä¸ä¼šè¶…æ—¶ï¼Œåªèƒ½ç­‰å¾…è¢« resolve æˆ– rejectã€‚å¹¸è¿çš„æ˜¯ï¼Œwhatwg ç›®å‰æ­£åœ¨å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ whatwg/fetch#27 ç›¸å…³èµ„æºWHATWG Fetch è§„èŒƒFetch APIé˜®ä¸€å³°async åŽŸæ–‡åœ°å€]]></content>
      <tags>
        <tag>Fetch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitåˆ†å¸ƒå¼ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿä½¿ç”¨]]></title>
    <url>%2F2018%2F03%2F09%2FTools%2FGit%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[#å¿«é€Ÿå¼€å§‹ å®‰è£…windowså®‰è£…åœ¨Windowsä¸Šä½¿ç”¨Gitï¼Œå¯ä»¥ä»ŽGitå®˜ç½‘ç›´æŽ¥ä¸‹è½½å®‰è£…ç¨‹åºï¼Œï¼ˆç½‘é€Ÿæ…¢çš„åŒå­¦è¯·ç§»æ­¥å›½å†…é•œåƒï¼‰ï¼Œç„¶åŽæŒ‰é»˜è®¤é€‰é¡¹å®‰è£…å³å¯ã€‚ å®‰è£…å®ŒæˆåŽï¼Œåœ¨å¼€å§‹èœå•é‡Œæ‰¾åˆ°â€œGitâ€-&gt;â€œGit Bashâ€ï¼Œè¹¦å‡ºä¸€ä¸ªç±»ä¼¼å‘½ä»¤è¡Œçª—å£çš„ä¸œè¥¿ï¼Œå°±è¯´æ˜ŽGitå®‰è£…æˆåŠŸï¼å®‰è£…å®ŒæˆåŽï¼Œè¿˜éœ€è¦æœ€åŽä¸€æ­¥è®¾ç½®ï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥ï¼š 12$ git config --global user.name "Your Name"$ git config --global user.email "email@example.com" macå®‰è£…å¦‚æžœä½ æ­£åœ¨ä½¿ç”¨Macåšå¼€å‘ï¼Œæœ‰ä¸¤ç§å®‰è£…Gitçš„æ–¹æ³•ã€‚ ä¸€æ˜¯å®‰è£…homebrewï¼Œç„¶åŽé€šè¿‡homebrewå®‰è£…Gitï¼Œå…·ä½“æ–¹æ³•è¯·å‚è€ƒhomebrewçš„æ–‡æ¡£ï¼šhttp://brew.sh/ã€‚ ç¬¬äºŒç§æ–¹æ³•æ›´ç®€å•ï¼Œä¹Ÿæ˜¯æŽ¨èçš„æ–¹æ³•ï¼Œå°±æ˜¯ç›´æŽ¥ä»ŽAppStoreå®‰è£…Xcodeï¼ŒXcodeé›†æˆäº†Gitï¼Œä¸è¿‡é»˜è®¤æ²¡æœ‰å®‰è£…ï¼Œä½ éœ€è¦è¿è¡ŒXcodeï¼Œé€‰æ‹©èœå•â€œXcodeâ€-&gt;â€œPreferencesâ€ï¼Œåœ¨å¼¹å‡ºçª—å£ä¸­æ‰¾åˆ°â€œDownloadsâ€ï¼Œé€‰æ‹©â€œCommand Line Toolsâ€ï¼Œç‚¹â€œInstallâ€å°±å¯ä»¥å®Œæˆå®‰è£…äº†ã€‚ æ–°å»ºæœ¬åœ°ä»“åº“ä½¿ç”¨Gitå‰ï¼Œéœ€è¦å…ˆå»ºç«‹ä¸€ä¸ªä»“åº“(repository)ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•ä½œä¸ºGitä»“åº“æˆ–åˆ›å»ºä¸€ä¸ªç©ºç›®å½•ã€‚ ä½¿ç”¨æ‚¨å½“å‰ç›®å½•ä½œä¸ºGitä»“åº“ï¼Œæˆ‘ä»¬åªéœ€ä½¿å®ƒåˆå§‹åŒ–ã€‚ 1git init XXX æ·»åŠ æ–°æ–‡ä»¶æˆ‘ä»¬æœ‰ä¸€ä¸ªä»“åº“ï¼Œä½†ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œå¯ä»¥ä½¿ç”¨addå‘½ä»¤æ·»åŠ æ–‡ä»¶ã€‚ 1git add filename å¯ä»¥ä½¿ç”¨addâ€¦ ç»§ç»­æ·»åŠ ä»»åŠ¡æ–‡ä»¶ã€‚ æäº¤ç‰ˆæœ¬çŽ°åœ¨æˆ‘ä»¬å·²ç»æ·»åŠ äº†è¿™äº›æ–‡ä»¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¬èƒ½å¤ŸçœŸæ­£è¢«ä¿å­˜åœ¨Gitä»“åº“ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å®ƒä»¬æäº¤åˆ°ä»“åº“ã€‚ 1git commit -m "Adding files" å¦‚æžœæ‚¨ä¸ä½¿ç”¨-mï¼Œä¼šå‡ºçŽ°ç¼–è¾‘å™¨æ¥è®©ä½ å†™è‡ªå·±çš„æ³¨é‡Šä¿¡æ¯ã€‚ å½“æˆ‘ä»¬ä¿®æ”¹äº†å¾ˆå¤šæ–‡ä»¶ï¼Œè€Œä¸æƒ³æ¯ä¸€ä¸ªéƒ½addï¼Œæƒ³commitè‡ªåŠ¨æ¥æäº¤æœ¬åœ°ä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨-aæ ‡è¯†ã€‚ 1git commit -a -m "Changed some files" git commit å‘½ä»¤çš„-aé€‰é¡¹å¯å°†æ‰€æœ‰è¢«ä¿®æ”¹æˆ–è€…å·²åˆ é™¤çš„ä¸”å·²ç»è¢«gitç®¡ç†çš„æ–‡æ¡£æäº¤åˆ°ä»“åº“ä¸­ã€‚ åƒä¸‡æ³¨æ„ï¼Œ-aä¸ä¼šé€ æˆæ–°æ–‡ä»¶è¢«æäº¤ï¼Œåªèƒ½ä¿®æ”¹ å‘å¸ƒç‰ˆæœ¬æˆ‘ä»¬å…ˆä»ŽæœåŠ¡å™¨å…‹éš†ä¸€ä¸ªåº“å¹¶ä¸Šä¼ ã€‚ 1git clone ssh://example.com/~/www/project.git çŽ°åœ¨æˆ‘ä»¬ä¿®æ”¹ä¹‹åŽå¯ä»¥è¿›è¡ŒæŽ¨é€åˆ°æœåŠ¡å™¨ã€‚ 1git push ssh://example.com/~/www/project.git å–å›žæ›´æ–°å¦‚æžœæ‚¨å·²ç»æŒ‰ä¸Šé¢çš„è¿›è¡Œpushï¼Œä¸‹é¢å‘½ä»¤è¡¨ç¤ºï¼Œå½“å‰åˆ†æ”¯è‡ªåŠ¨ä¸Žå”¯ä¸€ä¸€ä¸ªè¿½è¸ªåˆ†æ”¯è¿›è¡Œåˆå¹¶ã€‚ 1git pull ä»Žéžé»˜è®¤ä½ç½®æ›´æ–°åˆ°æŒ‡å®šçš„urlã€‚ 1git pull http://git.example.com/project.git åˆ é™¤å¦‚ä½•ä½ æƒ³ä»Žèµ„æºåº“ä¸­åˆ é™¤æ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨rmã€‚ 1git rm file åˆ†å¸ƒä¸Žåˆå¹¶åˆ†æ”¯åœ¨æœ¬åœ°å®Œæˆï¼Œé€Ÿåº¦å¿«ã€‚è¦åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯ï¼Œæˆ‘ä»¬ä½¿ç”¨branchå‘½ä»¤ã€‚ 1git branch test branchå‘½ä»¤ä¸ä¼šå°†æˆ‘ä»¬å¸¦å…¥åˆ†æ”¯ï¼Œåªæ˜¯åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ã€‚æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨checkoutå‘½ä»¤æ¥æ›´æ”¹åˆ†æ”¯ã€‚ 1git checkout test ç¬¬ä¸€ä¸ªåˆ†æ”¯ï¼Œæˆ–ä¸»åˆ†æ”¯ï¼Œè¢«ç§°ä¸ºâ€masterâ€ã€‚ 1git checkout master å¯¹å…¶ä»–åˆ†æ”¯çš„æ›´æ”¹ä¸ä¼šåæ˜ åœ¨ä¸»åˆ†æ”¯ä¸Šã€‚å¦‚æžœæƒ³å°†æ›´æ”¹æäº¤åˆ°ä¸»åˆ†æ”¯ï¼Œåˆ™éœ€åˆ‡æ¢å›žmasteråˆ†æ”¯ï¼Œç„¶åŽä½¿ç”¨åˆå¹¶ã€‚ 12git checkout mastergit merge test å¦‚æžœæ‚¨æƒ³åˆ é™¤åˆ†æ”¯ï¼Œæˆ‘ä»¬ä½¿ç”¨-dæ ‡è¯†ã€‚1git branch -d test]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-routerå­¦ä¹ ]]></title>
    <url>%2F2018%2F03%2F08%2FReact%2FReact-router%2FReact-router%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[React-router APIæŽ¥å£demo åœ°å€ ç»„ä»¶RouterReact Router çš„é‡è¦ç»„ä»¶ã€‚å®ƒèƒ½ä¿æŒ UI å’Œ URL çš„åŒæ­¥ã€‚ Props children(required)ä¸€ä¸ªæˆ–å¤šä¸ªçš„ Route æˆ– PlainRouteã€‚å½“ history æ”¹å˜æ—¶ï¼Œ ä¼šåŒ¹é…å‡º Route çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶ä¸”æ¸²æŸ“è¿™ä¸ªåˆ†æ”¯ä¸­é…ç½®çš„ç»„ä»¶ï¼Œæ¸²æŸ“æ—¶ä¿æŒçˆ¶ route ç»„ä»¶åµŒå¥—å­ route ç»„ä»¶ã€‚ routeschildren çš„åˆ«åã€‚ historyRouter ç›‘å¬çš„ history å¯¹è±¡ï¼Œç”± history åŒ…æä¾›ã€‚å…³äºŽhistoryçš„äº”ä¸ªå‡½æ•° createElement(Component, props) å½“ route å‡†å¤‡æ¸²æŸ“ route ç»„ä»¶çš„ä¸€ä¸ªåˆ†æ”¯æ—¶ï¼Œå°±ä¼šç”¨è¿™ä¸ªå‡½æ•°æ¥åˆ›å»º elementã€‚å½“ä½ ä½¿ç”¨æŸç§å½¢å¼çš„æ•°æ®è¿›è¡ŒæŠ½è±¡æ—¶ï¼Œä½ å¯ä»¥æƒ³è¦èŽ·å–åˆ›å»º element çš„æŽ§åˆ¶æƒï¼Œä¾‹å¦‚åœ¨è¿™é‡Œè®¾ç½®ç»„ä»¶ç›‘å¬ store çš„å˜åŒ–ï¼Œæˆ–è€…ä½¿ç”¨ props ä¸ºæ¯ä¸ªç»„ä»¶ä¼ å…¥ä¸€äº›åº”ç”¨æ¨¡å—ã€‚ stringifyQuery(queryObject) ä¸€ä¸ªç”¨äºŽæŠŠ Link æˆ–è°ƒç”¨ transitionTo å‡½æ•°çš„å¯¹è±¡è½¬åŒ–æˆ URL query å­—ç¬¦ä¸²çš„å‡½æ•°ã€‚ parseQueryString(queryString) ä¸€ä¸ªç”¨äºŽæŠŠ query å­—ç¬¦ä¸²è½¬åŒ–æˆå¯¹è±¡ï¼Œå¹¶ä¼ é€’ç»™ route ç»„ä»¶ props çš„å‡½æ•°ã€‚ onError(error) å½“è·¯ç”±åŒ¹é…åˆ°æ—¶ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ï¼Œæ­¤æ—¶ä½ å°±å¯ä»¥æ•èŽ·å’Œå¤„ç†è¿™äº›é”™è¯¯ã€‚é€šå¸¸ï¼Œå®ƒä»¬ä¼šæ¥è‡ªé‚£äº›å¼‚æ­¥çš„ç‰¹æ€§ï¼Œå¦‚ route.getComponentsï¼Œroute.getIndexRouteï¼Œå’Œ route.getChildRoutesã€‚ onUpdate() å½“ URL æ”¹å˜æ—¶ï¼Œéœ€è¦æ›´æ–°è·¯ç”±çš„ state æ—¶ä¼šè¢«è°ƒç”¨ã€‚ Linkå…è®¸ç”¨æˆ·æµè§ˆåº”ç”¨çš„ä¸»è¦æ–¹å¼ã€‚ ä»¥é€‚å½“çš„ href åŽ»æ¸²æŸ“ä¸€ä¸ªå¯è®¿é—®çš„é”šæ ‡ç­¾ã€‚ å¯ä»¥çŸ¥é“å“ªä¸ª route çš„é“¾æŽ¥æ˜¯æ¿€æ´»çŠ¶æ€çš„ï¼Œå¹¶å¯ä»¥è‡ªåŠ¨ä¸ºè¯¥é“¾æŽ¥æ·»åŠ  activeClassName æˆ– activeStyleã€‚ Propstoè·³è½¬é“¾æŽ¥çš„è·¯å¾„ï¼Œå¦‚ /users/123ã€‚ queryå·²ç»è½¬åŒ–æˆå­—ç¬¦ä¸²çš„é”®å€¼å¯¹çš„å¯¹è±¡ã€‚ hashURL çš„ hash å€¼ï¼Œå¦‚ #a-hashã€‚ æ³¨æ„ï¼šReact Router ç›®å‰è¿˜ä¸èƒ½ç®¡ç†æ»šåŠ¨æ¡çš„ä½ç½®ï¼Œå¹¶ä¸”ä¸ä¼šè‡ªåŠ¨æ»šåŠ¨åˆ° hash å¯¹åº”çš„å…ƒç´ ä¸Šã€‚å¦‚æžœéœ€è¦ç®¡ç†æ»šåŠ¨æ¡ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨ scroll-behavior è¿™ä¸ªåº“ã€‚ stateä¿å­˜åœ¨ location ä¸­çš„ state activeClassNameå½“æŸä¸ª route æ˜¯æ¿€æ´»çŠ¶æ€æ—¶ï¼Œ å¯ä»¥æŽ¥æ”¶ä¼ å…¥çš„ classNameã€‚å¤±æ´»çŠ¶æ€ä¸‹æ˜¯é»˜è®¤çš„ classã€‚ activeStyleå½“æŸä¸ª route æ˜¯æ¿€æ´»çŠ¶æ€æ—¶ï¼Œå¯ä»¥å°†æ ·å¼æ·»åŠ åˆ°é“¾æŽ¥å…ƒç´ ä¸Šã€‚ onClick(e)è‡ªå®šä¹‰ç‚¹å‡»äº‹ä»¶çš„å¤„ç†æ–¹æ³•ã€‚å¦‚å¤„ç† æ ‡ç­¾ä¸€æ · - è°ƒç”¨ e.preventDefault()æ¥é˜²æ­¢è¿‡åº¦çš„ç‚¹å‡»ï¼ŒåŒæ—¶ e.stopPropagation()å¯ä»¥é˜»æ­¢å†’æ³¡çš„äº‹ä»¶ã€‚ å…¶ä»–ä½ ä¹Ÿå¯ä»¥åœ¨ æ ‡ç­¾ä¸Šä¼ å…¥ä¸€äº›ä½ æƒ³è¦çš„ propsï¼Œå¦‚ titleï¼Œidï¼ŒclassName ç­‰ç­‰ã€‚ ç¤ºä¾‹å¦‚ è¿™æ ·çš„ routeï¼š1234567891011&lt;Link to=&#123;`/users/$&#123;user.id&#125;`&#125; activeClassName="active"&gt;&#123;user.name&#125;&lt;/Link&gt;// å˜æˆå®ƒä»¬å…¶ä¸­ä¸€ä¸ªä¾èµ–åœ¨ History ä¸Šï¼Œå½“è¿™ä¸ª route æ˜¯// æ¿€æ´»çŠ¶æ€çš„&lt;a href="/users/123" class="active"&gt;Michael&lt;/a&gt;&lt;a href="#/users/123"&gt;Michael&lt;/a&gt;// ä¿®æ”¹ activeClassName&lt;Link to=&#123;`/users/$&#123;user.id&#125;`&#125; activeClassName="current"&gt;&#123;user.name&#125;&lt;/Link&gt;// å½“é“¾æŽ¥æ¿€æ´»æ—¶ï¼Œä¿®æ”¹å®ƒçš„æ ·å¼&lt;Link to="/users" style=&#123;&#123;color: 'white'&#125;&#125; activeStyle=&#123;&#123;color: 'red'&#125;&#125;&gt;Users&lt;/Link&gt; IndexLinkå¦‚æžœé“¾æŽ¥åˆ°æ ¹è·¯ç”±/ï¼Œä¸è¦ä½¿ç”¨Linkç»„ä»¶ï¼Œè€Œè¦ä½¿ç”¨IndexLinkç»„ä»¶ã€‚ è¿™æ˜¯å› ä¸ºå¯¹äºŽæ ¹è·¯ç”±æ¥è¯´ï¼ŒactiveStyleå’ŒactiveClassNameä¼šå¤±æ•ˆï¼Œæˆ–è€…è¯´æ€»æ˜¯ç”Ÿæ•ˆï¼Œå› ä¸º/ä¼šåŒ¹é…ä»»ä½•å­è·¯ç”±ã€‚è€ŒIndexLinkç»„ä»¶ä¼šä½¿ç”¨è·¯å¾„çš„ç²¾ç¡®åŒ¹é…ã€‚123&lt;IndexLink to="/" activeClassName="active"&gt; Home&lt;/IndexLink&gt; ä¸Šé¢ä»£ç ä¸­ï¼Œæ ¹è·¯ç”±åªä¼šåœ¨ç²¾ç¡®åŒ¹é…æ—¶ï¼Œæ‰å…·æœ‰activeClassNameã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨Linkç»„ä»¶çš„onlyActiveOnIndexå±žæ€§ï¼Œä¹Ÿèƒ½è¾¾åˆ°åŒæ ·æ•ˆæžœã€‚ 123&lt;Link to="/" activeClassName="active" onlyActiveOnIndex=&#123;true&#125;&gt; Home&lt;/Link&gt; RoutingContextåœ¨ context ä¸­ç»™å®šè·¯ç”±çš„ stateã€è®¾ç½® history å¯¹è±¡å’Œå½“å‰çš„ locationï¼Œ å°±ä¼šåŽ»æ¸²æŸ“ç»„ä»¶æ ‘ã€‚ ç»„ä»¶é…ç½®routeRoute æ˜¯ç”¨äºŽå£°æ˜Žè·¯ç”±æ˜ å°„åˆ°åº”ç”¨ç¨‹åºçš„ç»„ä»¶å±‚ã€‚ PropspathURL ä¸­çš„è·¯å¾„ã€‚ å®ƒä¼šç»„åˆçˆ¶ route çš„è·¯å¾„ï¼Œé™¤éžå®ƒæ˜¯ä»Ž / å¼€å§‹çš„ï¼Œ å°†å®ƒå˜æˆä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ æ³¨æ„ï¼šåœ¨åŠ¨æ€è·¯ç”±ä¸­ï¼Œç»å¯¹è·¯å¾„å¯èƒ½ä¸é€‚ç”¨äºŽ route é…ç½®ä¸­ã€‚ å¦‚æžœå®ƒæ˜¯ undefinedï¼Œè·¯ç”±ä¼šåŽ»åŒ¹é…å­ routeã€‚ componentå½“åŒ¹é…åˆ° URL æ—¶ï¼Œå•ä¸ªçš„ç»„ä»¶ä¼šè¢«æ¸²æŸ“ã€‚å®ƒå¯ä»¥ è¢«çˆ¶ route ç»„ä»¶çš„ this.props.children æ¸²æŸ“ã€‚1234567891011121314151617const routes = ( &lt;Route component=&#123;App&#125;&gt; &lt;Route path="groups" component=&#123;Groups&#125;/&gt; &lt;Route path="users" component=&#123;Users&#125;/&gt; &lt;/Route&gt;)class App extends React.Component &#123; render () &#123; return ( &lt;div&gt; &#123;/* è¿™ä¼šæ˜¯ &lt;Users&gt; æˆ– &lt;Groups&gt; */&#125; &#123;this.props.children&#125; &lt;/div&gt; ) &#125;&#125; componentsRoute å¯ä»¥å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªå·²å‘½åçš„ç»„ä»¶ï¼Œå½“è·¯å¾„åŒ¹é…åˆ° URL æ—¶ï¼Œ å®ƒä»¬ä½œä¸º name:component å¯¹çš„ä¸€ä¸ªå¯¹è±¡åŽ»æ¸²æŸ“ã€‚å®ƒä»¬å¯ä»¥è¢« çˆ¶ route ç»„ä»¶çš„ this.props[name] æ¸²æŸ“ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142// æƒ³æƒ³è·¯ç”±å¤–éƒ¨çš„ context â€” å¦‚æžœä½ å¯æ‹”æ’// `render` çš„éƒ¨åˆ†ï¼Œä½ å¯èƒ½éœ€è¦è¿™ä¹ˆåšï¼š// &lt;App main=&#123;&lt;Users /&gt;&#125; sidebar=&#123;&lt;UsersSidebar /&gt;&#125; /&gt;const routes = ( &lt;Route component=&#123;App&#125;&gt; &lt;Route path="groups" components=&#123;&#123;main: Groups, sidebar: GroupsSidebar&#125;&#125;/&gt; &lt;Route path="users" components=&#123;&#123;main: Users, sidebar: UsersSidebar&#125;&#125;&gt; &lt;Route path="users/:userId" component=&#123;Profile&#125;/&gt; &lt;/Route&gt; &lt;/Route&gt;)class App extends React.Component &#123; render () &#123; const &#123; main, sidebar &#125; = this.props return ( &lt;div&gt; &lt;div className="Main"&gt; &#123;main&#125; &lt;/div&gt; &lt;div className="Sidebar"&gt; &#123;sidebar&#125; &lt;/div&gt; &lt;/div&gt; ) &#125;&#125;class Users extends React.Component &#123; render () &#123; return ( &lt;div&gt; &#123;/* å½“è·¯å¾„æ˜¯ "/users/123" æ˜¯ `children` ä¼šæ˜¯ &lt;Profile&gt; */&#125; &#123;/* UsersSidebar ä¹Ÿå¯ä»¥èŽ·å–ä½œä¸º this.props.children çš„ &lt;Profile&gt; ï¼Œ æ‰€ä»¥è¿™æœ‰ç‚¹å¥‡æ€ªï¼Œä½†ä½ å¯ä»¥å†³å®šå“ªä¸€ä¸ªå¯ä»¥ ç»§ç»­è¿™ç§åµŒå¥— */&#125; &#123;this.props.children&#125; &lt;/div&gt; ) &#125;&#125; getComponent(location, callback)ä¸Ž component ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¼‚æ­¥çš„ï¼Œå¯¹äºŽ code-splitting å¾ˆæœ‰ç”¨ã€‚ callback signaturecb(err, component) 1234&lt;Route path="courses/:courseId" getComponent=&#123;(location, cb) =&gt; &#123; // åšä¸€äº›å¼‚æ­¥æ“ä½œåŽ»æŸ¥æ‰¾ç»„ä»¶ cb(null, Course)&#125;&#125;/&gt; getComponents(location, callback)ä¸Ž component ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¼‚æ­¥çš„ï¼Œå¯¹äºŽ code-splitting å¾ˆæœ‰ç”¨ã€‚ callback signaturecb(err, components) 1234&lt;Route path="courses/:courseId" getComponent=&#123;(location, cb) =&gt; &#123; // åšä¸€äº›å¼‚æ­¥æ“ä½œåŽ»æŸ¥æ‰¾ç»„ä»¶ cb(null, &#123;sidebar: CourseSidebar, content: Course&#125;)&#125;&#125;/&gt; childrenRoute å¯ä»¥è¢«åµŒå¥—ï¼Œthis.props.children åŒ…å«äº†ä»Žå­ route ç»„ä»¶åˆ›å»ºçš„å…ƒç´ ã€‚ç”±äºŽè¿™æ˜¯è·¯ç”±è®¾è®¡ä¸­éžå¸¸é‡è¦çš„éƒ¨åˆ†ï¼Œè¯·å‚è€ƒ Route é…ç½®ã€‚ ä¸¤ä¸ªè·¯ç”±é’©å­ï¼š onEnter(nextState, replaceState, callback?) å½“ route å³å°†è¿›å…¥æ—¶è°ƒç”¨ã€‚å®ƒæä¾›äº†ä¸‹ä¸€ä¸ªè·¯ç”±çš„ stateï¼Œä¸€ä¸ªå‡½æ•°é‡å®šå‘åˆ°å¦ä¸€ä¸ªè·¯å¾„ã€‚this ä¼šè§¦å‘é’©å­åŽ»åˆ›å»º route å®žä¾‹ã€‚å½“ callback ä½œä¸ºå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥æ—¶ï¼Œè¿™ä¸ªé’©å­å°†æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå¹¶ä¸”è·³è½¬ä¼šé˜»å¡žç›´åˆ° callback è¢«è°ƒç”¨ã€‚ onLeave()å½“ route å³å°†é€€å‡ºæ—¶è°ƒç”¨ã€‚### PlainRouteroute å®šä¹‰çš„ä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ã€‚ Router æŠŠ JSX çš„ è½¬åŒ–åˆ°è¿™ä¸ªå¯¹è±¡ä¸­ï¼Œå¦‚æžœä½ å–œæ¬¢ï¼Œä½ å¯ä»¥ç›´æŽ¥ä½¿ç”¨å®ƒä»¬ã€‚ æ‰€æœ‰çš„ props éƒ½å’Œ çš„ props ä¸€æ ·ï¼Œé™¤äº†é‚£äº›åˆ—åœ¨è¿™é‡Œçš„ã€‚#### props##### childRouteså­ route çš„ä¸€ä¸ªæ•°ç»„ï¼Œä¸Žåœ¨ JSX route é…ç½®ä¸­çš„ children ä¸€æ ·ã€‚getChildRoutes(location, callback) ä¸Ž childRoutes ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”å¯ä»¥æŽ¥æ”¶ locationã€‚å¯¹äºŽ code-splitting å’ŒåŠ¨æ€è·¯ç”±åŒ¹é…å¾ˆæœ‰ç”¨ï¼ˆç»™å®šä¸€äº› state æˆ– session æ•°æ®ä¼šè¿”å›žä¸åŒçš„å­ routeï¼‰ã€‚ callback signaturecb(err, routesArray) 12345678910111213141516171819202122232425262728293031323334let myRoute = &#123; path: 'course/:courseId', childRoutes: [ announcementsRoute, gradesRoute, assignmentsRoute ]&#125;// å¼‚æ­¥çš„å­ routelet myRoute = &#123; path: 'course/:courseId', getChildRoutes(location, cb) &#123; // åšä¸€äº›å¼‚æ­¥æ“ä½œåŽ»æŸ¥æ‰¾å­ route cb(null, [ announcementsRoute, gradesRoute, assignmentsRoute ]) &#125;&#125;// å¯ä»¥æ ¹æ®ä¸€äº› state// è·³è½¬åˆ°ä¾èµ–çš„å­ route&lt;Link to="/picture/123" state=&#123;&#123; fromDashboard: true &#125;&#125;/&gt;let myRoute = &#123; path: 'picture/:id', getChildRoutes(location, cb) &#123; let &#123; state &#125; = location if (state &amp;&amp; state.fromDashboard) &#123; cb(null, [dashboardPictureRoute]) &#125; else &#123; cb(null, [pictureRoute]) &#125; &#125;&#125; indexRouteindex routeã€‚è¿™ä¸Žåœ¨ä½¿ç”¨ JSX route é…ç½®æ—¶æŒ‡å®šä¸€ä¸ª å­é›†ä¸€æ ·ã€‚ getIndexRoute(location, callback)ä¸Ž indexRoute ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”å¯ä»¥æŽ¥æ”¶ locationã€‚ä¸Ž getChildRoutes ä¸€æ ·ï¼Œå¯¹äºŽ code-splitting å’ŒåŠ¨æ€è·¯ç”±åŒ¹é…å¾ˆæœ‰ç”¨callback signaturecb(err, route)123456789101112131415161718// ä¾‹å¦‚ï¼šlet myIndexRoute = &#123; component: MyIndex&#125;let myRoute = &#123; path: 'courses', indexRoute: myIndexRoute&#125;// å¼‚æ­¥çš„ index routelet myRoute = &#123; path: 'courses', getIndexRoute(location, cb) &#123; // åšä¸€äº›å¼‚æ­¥æ“ä½œ cb(null, myIndexRoute) &#125;&#125;### Redirectåœ¨åº”ç”¨ä¸­ å¯ä»¥è®¾ç½®é‡å®šå‘åˆ°å…¶ä»– route è€Œä¸æ”¹å˜æ—§çš„ URLã€‚#### Props##### fromä½ æƒ³ç”±å“ªä¸ªè·¯å¾„è¿›è¡Œé‡å®šå‘ï¼ŒåŒ…æ‹¬åŠ¨æ€æ®µã€‚##### toä½ æƒ³é‡å®šå‘çš„è·¯å¾„ã€‚##### queryé»˜è®¤æƒ…å†µä¸‹ï¼Œquery çš„å‚æ•°åªä¼šç»è¿‡ï¼Œä½†å¦‚æžœä½ éœ€è¦ä½ å¯ä»¥æŒ‡å®šå®ƒä»¬ã€‚1234567// æˆ‘ä»¬éœ€è¦ä»Ž `/profile/123` æ”¹å˜åˆ° `/about/123`// å¹¶ä¸”ç”± `/get-in-touch` é‡å®šå‘åˆ° `/contact`&lt;Route component=&#123;App&#125;&gt; &lt;Route path="about/:userId" component=&#123;UserProfile&#125;/&gt; &#123;/* /profile/123 -&gt; /about/123 */&#125; &lt;Redirect from="profile/:userId" to="about/:userId" /&gt;&lt;/Route&gt;æ³¨æ„ï¼Œåœ¨ route å±‚ å¯ä»¥è¢«æ”¾åœ¨ä»»ä½•åœ°æ–¹ï¼Œå°½ç®¡æ­£å¸¸çš„ä¼˜å…ˆ è§„åˆ™ä»é€‚ç”¨ã€‚å¦‚æžœä½ å–œæ¬¢å°†ä¸‹ä¸€ä¸ªé‡å®šå‘åˆ°å®ƒå„è‡ªçš„ route ä¸Šï¼Œfrom çš„è·¯å¾„ä¼šåŒ¹é…åˆ°ä¸€ä¸ªä¸Ž path ä¸€æ ·çš„æ­£å¸¸è·¯å¾„ã€‚12345&lt;Route path="course/:courseId"&gt; &lt;Route path="dashboard" /&gt; &#123;/* /course/123/home -&gt; /course/123/dashboard */&#125; &lt;Redirect from="home" to="dashboard" /&gt;&lt;/Route&gt;### IndexRouteå½“ç”¨æˆ·åœ¨çˆ¶ route çš„ URL æ—¶ï¼Œ Index Routes å…è®¸ä½ ä¸ºçˆ¶ route æä¾›ä¸€ä¸ªé»˜è®¤çš„ â€œchildâ€ï¼Œ å¹¶ä¸”ä¸ºä½¿ èƒ½ç”¨æä¾›äº†çº¦å®š####Propsä¸Ž Route çš„ props ä¸€æ ·ï¼Œé™¤äº† pathã€‚### IndexRedirectIndex Redirects å…è®¸ä½ ä»Žä¸€ä¸ªçˆ¶ route çš„ URL é‡å®šå‘åˆ°å…¶ä»– routeã€‚ å®ƒä»¬è¢«ç”¨äºŽå…è®¸å­ route ä½œä¸ºçˆ¶ route çš„é»˜è®¤ routeï¼Œ åŒæ—¶ä¿æŒç€ä¸åŒçš„ URLã€‚#### Propsä¸Ž Redirect çš„ props ä¸€æ ·ï¼Œé™¤äº† fromã€‚## Route Componentså½“ route åŒ¹é…åˆ° URL æ—¶ä¼šæ¸²æŸ“ä¸€ä¸ª route çš„ç»„ä»¶ã€‚è·¯ç”±ä¼šåœ¨æ¸²æŸ“æ—¶å°†ä»¥ä¸‹å±žæ€§æ³¨å…¥ç»„ä»¶ä¸­ï¼š#### historyRouter çš„ history historyã€‚å¯¹äºŽè·³è½¬å¾ˆæœ‰ç”¨çš„ this.props.history.pushState(state, path, query)#### locationå½“å‰çš„ locationã€‚#### paramsURL çš„åŠ¨æ€æ®µã€‚#### routeæ¸²æŸ“ç»„ä»¶çš„ routeã€‚#### routeParamsthis.props.params æ˜¯ç›´æŽ¥åœ¨ç»„ä»¶ä¸­æŒ‡å®š route çš„ä¸€ä¸ªå­é›†ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœ route çš„è·¯å¾„æ˜¯ users/:userId è€Œ URL æ˜¯ /users/123/portfolios/345ï¼Œé‚£ä¹ˆ this.props.routeParams ä¼šæ˜¯ {userId: â€˜123â€™}ï¼Œå¹¶ä¸” this.props.params ä¼šæ˜¯ {userId: â€˜123â€™, portfolioId: 345}ã€‚#### childrenåŒ¹é…åˆ°å­ route çš„å…ƒç´ å°†è¢«æ¸²æŸ“ã€‚å¦‚æžœ route æœ‰å·²å‘½åçš„ç»„ä»¶ï¼Œé‚£ä¹ˆæ­¤å±žæ€§ä¼šæ˜¯ undefinedï¼Œå¹¶ä¸”å¯ç”¨çš„ç»„ä»¶ä¼šè¢«ç›´æŽ¥æ›¿æ¢åˆ° this.props ä¸Šã€‚#### ç¤ºä¾‹12345678910111213141516171819render(( &lt;Router&gt; &lt;Route path="/" component=&#123;App&#125;&gt; &lt;Route path="groups" component=&#123;Groups&#125; /&gt; &lt;Route path="users" component=&#123;Users&#125; /&gt; &lt;/Route&gt; &lt;/Router&gt;), node)class App extends React.Component &#123; render() &#123; return ( &lt;div&gt; &#123;/* è¿™å¯èƒ½æ˜¯ &lt;Users&gt; æˆ– &lt;Groups&gt; */&#125; &#123;this.props.children&#125; &lt;/div&gt; ) &#125;&#125;### å·²å‘½åçš„ç»„ä»¶å½“ä¸€ä¸ª route æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå·²å‘½åçš„ç»„ä»¶æ—¶ï¼Œå…¶å­å…ƒç´ çš„å¯ç”¨æ€§æ˜¯é€šè¿‡ this.props å‘½åçš„ã€‚å› æ­¤ this.props.children å°†ä¼šæ˜¯ undefinedã€‚é‚£ä¹ˆæ‰€æœ‰çš„ route ç»„ä»¶éƒ½å¯ä»¥å‚ä¸ŽåµŒå¥—ã€‚#### ç¤ºä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041render(( &lt;Router&gt; &lt;Route path="/" component=&#123;App&#125;&gt; &lt;Route path="groups" components=&#123;&#123;main: Groups, sidebar: GroupsSidebar&#125;&#125; /&gt; &lt;Route path="users" components=&#123;&#123;main: Users, sidebar: UsersSidebar&#125;&#125;&gt; &lt;Route path="users/:userId" component=&#123;Profile&#125; /&gt; &lt;/Route&gt; &lt;/Route&gt; &lt;/Router&gt;), node)class App extends React.Component &#123; render() &#123; // åœ¨çˆ¶ route ä¸­ï¼Œè¢«åŒ¹é…çš„å­ route å˜æˆ props return ( &lt;div&gt; &lt;div className="Main"&gt; &#123;/* è¿™å¯èƒ½æ˜¯ &lt;Groups&gt; æˆ– &lt;Users&gt; */&#125; &#123;this.props.main&#125; &lt;/div&gt; &lt;div className="Sidebar"&gt; &#123;/* è¿™å¯èƒ½æ˜¯ &lt;GroupsSidebar&gt; æˆ– &lt;UsersSidebar&gt; */&#125; &#123;this.props.sidebar&#125; &lt;/div&gt; &lt;/div&gt; ) &#125;&#125;class Users extends React.Component &#123; render() &#123; return ( &lt;div&gt; &#123;/* å¦‚æžœåœ¨ "/users/123" è·¯å¾„ä¸Šè¿™ä¼šæ˜¯ &lt;Profile&gt; */&#125; &#123;/* UsersSidebar ä¹Ÿä¼šèŽ·å–åˆ°ä½œä¸º this.props.children çš„ &lt;Profile&gt; ã€‚ ä½ å¯ä»¥æŠŠå®ƒæ”¾è¿™æ¸²æŸ“ */&#125; &#123;this.props.children&#125; &lt;/div&gt; ) &#125;&#125;## Mixins### ç”Ÿå‘½å‘¨æœŸåœ¨ç»„ä»¶ä¸­æ·»åŠ ä¸€ä¸ªé’©å­ï¼Œå½“è·¯ç”±è¦ä»Ž route ç»„ä»¶çš„é…ç½®ä¸­è·³è½¬å‡ºæ¥æ—¶è¢«è°ƒç”¨ï¼Œå¹¶ä¸”æœ‰æœºä¼šåŽ»å–æ¶ˆè¿™æ¬¡è·³è½¬ã€‚ä¸»è¦ç”¨äºŽè¡¨å•çš„éƒ¨åˆ†å¡«å†™ã€‚åœ¨å¸¸è§„çš„è·³è½¬ä¸­ï¼Œ routerWillLeave ä¼šæŽ¥æ”¶åˆ°ä¸€ä¸ªå•ä¸€çš„å‚æ•°ï¼šæˆ‘ä»¬æ­£è¦è·³è½¬çš„ locationã€‚åŽ»å–æ¶ˆæ­¤æ¬¡è·³è½¬ï¼Œè¿”å›ž falseã€‚æç¤ºç”¨æˆ·ç¡®è®¤ï¼Œè¿”å›žä¸€ä¸ªæç¤ºä¿¡æ¯ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€‚åœ¨ web æµè§ˆå™¨ beforeunload äº‹ä»¶å‘ç”Ÿæ—¶ï¼ŒrouterWillLeave ä¸ä¼šæŽ¥æ”¶åˆ°ä¸€ä¸ª location çš„å¯¹è±¡ï¼ˆå‡è®¾ä½ æ­£åœ¨ä½¿ç”¨ useBeforeUnload history çš„å¢žå¼ºæ–¹æ³•ï¼‰ã€‚åœ¨æ­¤ä¹‹ä¸Šï¼Œæˆ‘ä»¬æ˜¯ä¸å¯èƒ½çŸ¥é“è¦è·³è½¬çš„ locationï¼Œå› æ­¤ outerWillLeave å¿…é¡»åœ¨ç”¨æˆ·å…³é—­æ ‡ç­¾ä¹‹å‰è¿”å›žä¸€ä¸ªæç¤ºä¿¡æ¯ã€‚#### ç”Ÿå‘½å‘¨æœŸæ–¹æ³•routerWillLeave(nextLocation) å½“è·¯ç”±å°è¯•ä»Žä¸€ä¸ª route è·³è½¬åˆ°å¦ä¸€ä¸ªå¹¶ä¸”æ¸²æŸ“è¿™ä¸ªç»„ä»¶æ—¶è¢«è°ƒç”¨ã€‚ arguments nextLocation - ä¸‹ä¸€ä¸ª location History Mixinsåœ¨ç»„ä»¶ä¸­æ·»åŠ è·¯ç”±çš„ history å¯¹è±¡ã€‚å¸¸ç”¨çš„ history æœ‰ä¸‰ç§å½¢å¼ï¼Œ ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ React Router å®žçŽ°è‡ªå®šä¹‰çš„ historyã€‚ browserHistory(Browser history æ˜¯ä½¿ç”¨ React Router çš„åº”ç”¨æŽ¨èçš„ historyã€‚å®ƒä½¿ç”¨æµè§ˆå™¨ä¸­çš„ History API ç”¨äºŽå¤„ç† URLï¼Œåˆ›å»ºä¸€ä¸ªåƒexample.com/some/pathè¿™æ ·çœŸå®žçš„ URL ã€‚) hashHistory(è·¯ç”±å°†é€šè¿‡URLçš„hashéƒ¨åˆ†ï¼ˆ#ï¼‰åˆ‡æ¢ï¼ŒURLçš„å½¢å¼ç±»ä¼¼example.com/#/some/path) createMemoryHistory(ä¸»è¦ç”¨äºŽæœåŠ¡å™¨æ¸²æŸ“ã€‚å®ƒåˆ›å»ºä¸€ä¸ªå†…å­˜ä¸­çš„historyå¯¹è±¡ï¼Œä¸ä¸Žæµè§ˆå™¨URLäº’åŠ¨ã€‚) ä½ å¯ä»¥ä»Ž React Router ä¸­å¼•å…¥å®ƒä»¬ï¼š12// JavaScript æ¨¡å—å¯¼å…¥ï¼ˆè¯‘è€…æ³¨ï¼šES6 å½¢å¼ï¼‰import &#123; browserHistory &#125; from 'react-router' ç„¶åŽå°†å®ƒä»¬ä¼ é€’ç»™:1234render( &lt;Router history=&#123;browserHistory&#125; routes=&#123;routes&#125; /&gt;, document.getElementById('app')) å®žçŽ°ç¤ºä¾‹12345678910111213141516171819import React from 'react'import &#123; render &#125; from 'react-dom'import &#123; browserHistory, Router, Route, IndexRoute &#125; from 'react-router'import App from '../components/App'import Home from '../components/Home'import About from '../components/About'import Features from '../components/Features'render( &lt;Router history=&#123;browserHistory&#125;&gt; &lt;Route path='/' component=&#123;App&#125;&gt; &lt;IndexRoute component=&#123;Home&#125; /&gt; &lt;Route path='about' component=&#123;About&#125; /&gt; &lt;Route path='features' component=&#123;Features&#125; /&gt; &lt;/Route&gt; &lt;/Router&gt;, document.getElementById('app')) æ³¨æ„ï¼šä½ çš„ route components ä¸éœ€è¦è¿™ä¸ª mixinï¼Œå®ƒåœ¨ this.props.history ä¸­å·²ç»æ˜¯å¯ç”¨çš„äº†ã€‚è¿™æ˜¯ä¸ºäº†ç»„ä»¶æ›´æ·±æ¬¡çš„æ¸²æŸ“æ ‘ä¸­éœ€è¦è®¿é—®è·¯ç”±çš„ history å¯¹è±¡ã€‚ MethodspushState(state, pathname, query)è·³è½¬è‡³ä¸€ä¸ªæ–°çš„ URLã€‚ arguments state - location çš„ stateã€‚ pathname - æ²¡æœ‰ query å®Œæ•´çš„ URLã€‚*query - é€šè¿‡è·¯ç”±å­—ç¬¦ä¸²åŒ–çš„ä¸€ä¸ªå¯¹è±¡ã€‚ replaceState(state, pathname, query)åœ¨ä¸å½±å“ history é•¿åº¦çš„æƒ…å†µä¸‹ï¼ˆå¦‚ä¸€ä¸ªé‡å®šå‘ï¼‰ï¼Œç”¨æ–°çš„ URL æ›¿æ¢å½“å‰è¿™ä¸ªã€‚ å‚æ•° state - location çš„ stateã€‚ pathname - æ²¡æœ‰ query å®Œæ•´çš„ URLã€‚ query - é€šè¿‡è·¯ç”±å­—ç¬¦ä¸²åŒ–çš„ä¸€ä¸ªå¯¹è±¡ã€‚ go(n)åœ¨ history ä¸­åŽé€€ã€‚ goForward()åœ¨ history ä¸­å‰è¿›ã€‚ createPath(pathname, query)ä½¿ç”¨è·¯ç”±é…ç½®ï¼Œå°† query å­—ç¬¦ä¸²åŒ–åŠ åˆ°è·¯å¾„åä¸­ã€‚ createHref(pathname, query)ä½¿ç”¨è·¯ç”±é…ç½®ï¼Œåˆ›å»ºä¸€ä¸ª URLã€‚ä¾‹å¦‚ï¼Œå®ƒä¼šåœ¨ pathname çš„å‰é¢åŠ ä¸Š #/ ç»™ hash historyã€‚ isActive(pathname, query, indexOnly)æ ¹æ®å½“å‰è·¯å¾„æ˜¯å¦æ¿€æ´»è¿”å›ž true æˆ– falseã€‚é€šè¿‡ pathname åŒ¹é…åˆ° route åˆ†æ”¯ä¸‹çš„æ¯ä¸ª route å°†ä¼šæ˜¯ trueï¼ˆå­ route æ˜¯æ¿€æ´»çš„æƒ…å†µä¸‹ï¼Œçˆ¶ route ä¹Ÿæ˜¯æ¿€æ´»çš„ï¼‰ï¼Œé™¤éž indexOnly å·²ç»æŒ‡å®šäº†ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒåªä¼šåŒ¹é…åˆ°å…·ä½“çš„è·¯å¾„ã€‚å‚æ•° pathname - æ²¡æœ‰ query å®Œæ•´çš„ URLã€‚ query - å¦‚æžœæ²¡æœ‰æŒ‡å®šï¼Œé‚£ä¼šæ˜¯ä¸€ä¸ªåŒ…å«é”®å€¼å¯¹çš„å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨å½“å‰çš„ query ä¸­æ˜¯æ¿€æ´»çŠ¶æ€çš„ - åœ¨å½“å‰çš„ query ä¸­æ˜Žç¡®æ˜¯ undefined çš„å€¼ä¼šä¸¢å¤±ç›¸åº”çš„é”®æˆ– undefined*indexOnly - ä¸€ä¸ª booleanï¼ˆé»˜è®¤ï¼šfalseï¼‰ã€‚ ç¤ºä¾‹1234567891011121314import &#123; History &#125; from 'react-router'React.createClass(&#123; mixins: [ History ], render() &#123; return ( &lt;div&gt; &lt;div onClick=&#123;() =&gt; this.history.pushState(null, '/foo')&#125;&gt;Go to foo&lt;/div&gt; &lt;div onClick=&#123;() =&gt; this.history.replaceState(null, 'bar')&#125;&gt;Go to bar without creating a new history entry&lt;/div&gt; &lt;div onClick=&#123;() =&gt; this.history.goBack()&#125;&gt;Go back&lt;/div&gt; &lt;/div&gt; ) &#125;&#125;) åœ¨åº”ç”¨ä¸­å°‘æ•°ç»„ä»¶ç”±äºŽ History mixin çš„ç¼˜æ•…è€Œç”¨å¾—ä¸çˆ½ï¼Œæ­¤æ—¶æœ‰ä»¥ä¸‹å‡ ä¸ªé€‰é¡¹ï¼š è®© this.props.history é€šè¿‡ route ç»„ä»¶åˆ°è¾¾éœ€è¦å®ƒçš„ç»„ä»¶ä¸­ã€‚ ä½¿ç”¨ context 123456789import &#123; PropTypes &#125; from 'react-router'class MyComponent extends React.Component &#123; doStuff() &#123; this.context.history.pushState(null, '/some/path') &#125;&#125;MyComponent.contextTypes = &#123; history: PropTypes.history &#125; ç¡®ä¿ä½ çš„ history æ˜¯ä¸€ä¸ª module åˆ›å»ºä¸€ä¸ªé«˜é˜¶çš„ç»„ä»¶ï¼Œæˆ‘ä»¬å¯èƒ½ç”¨å®ƒæ¥ç»“æŸè·³è½¬å’Œé˜»æ­¢ historyï¼Œåªæ˜¯æ²¡æœ‰æ—¶é—´åŽ»æ€è€ƒæ‰€æœ‰çš„æ–¹æ³•ã€‚ 12345678910111213141516171819function connectHistory(Component) &#123; return React.createClass(&#123; mixins: [ History ], render() &#123; return &lt;Component &#123;...this.props&#125; history=&#123;this.history&#125; /&gt; &#125; &#125;)&#125;// å…¶ä»–æ–‡ä»¶import connectHistory from './connectHistory'class MyComponent extends React.Component &#123; doStuff() &#123; this.props.history.pushState(null, '/some/where') &#125;&#125;export default connectHistory(MyComponent) RouteContext MixinsRouteContext mixin æä¾›äº†ä¸€ä¸ªå°† route ç»„ä»¶è®¾ç½®åˆ° context ä¸­çš„ä¾¿æ·æ–¹æ³•ã€‚è¿™å¯¹äºŽ route æ¸²æŸ“å…ƒç´ å¹¶ä¸”å¸Œæœ›ç”¨ ç”Ÿå‘½å‘¨æœŸ mixin æ¥é˜»æ­¢è·³è½¬æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ ç®€å•åœ°å°† this.context.route æ·»åŠ åˆ°ç»„ä»¶ä¸­ã€‚ è¡¨å•å¤„ç†Linkç»„ä»¶ç”¨äºŽæ­£å¸¸çš„ç”¨æˆ·ç‚¹å‡»è·³è½¬ï¼Œä½†æ˜¯æœ‰æ—¶è¿˜éœ€è¦è¡¨å•è·³è½¬ã€ç‚¹å‡»æŒ‰é’®è·³è½¬ç­‰æ“ä½œã€‚è¿™äº›æƒ…å†µæ€Žä¹ˆè·ŸReact Routerå¯¹æŽ¥å‘¢ï¼Ÿ ä¸‹é¢æ˜¯ä¸€ä¸ªè¡¨å•ã€‚123456&lt;form onSubmit=&#123;this.handleSubmit&#125;&gt; &lt;input type="text" placeholder="userName"/&gt; &lt;input type="text" placeholder="repo"/&gt; &lt;button type="submit"&gt;Go&lt;/button&gt;&lt;/form&gt; ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨browserHistory.push12345678910import &#123; browserHistory &#125; from 'react-router'// ... handleSubmit(event) &#123; event.preventDefault() const userName = event.target.elements[0].value const repo = event.target.elements[1].value const path = `/repos/$&#123;userName&#125;/$&#123;repo&#125;` browserHistory.push(path) &#125;, ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨contextå¯¹è±¡ã€‚123456789101112export default React.createClass(&#123; // ask for `router` from context contextTypes: &#123; router: React.PropTypes.object &#125;, handleSubmit(event) &#123; // ... this.context.router.push(path) &#125;,&#125;) UtilitiesuseRoutes(createHistory)è¿”å›žä¸€ä¸ªæ–°çš„ createHistory å‡½æ•°ï¼Œå®ƒå¯ä»¥ç”¨æ¥åˆ›å»ºè¯»å– route çš„ history å¯¹è±¡ã€‚ listen((error, nextState) =&gt; {}) listenBeforeLeavingRoute(route, (nextLocation) =&gt; {}) (location, (error, redirectLocation, nextState) =&gt; {}) isActive(pathname, query, indexOnly=false) matchmatch(location, cb)è¿™ä¸ªå‡½æ•°è¢«ç”¨äºŽæœåŠ¡ç«¯æ¸²æŸ“ã€‚å®ƒåœ¨æ¸²æŸ“ä¹‹å‰ä¼šåŒ¹é…ä¸€ç»„ route åˆ°ä¸€ä¸ª locationï¼Œå¹¶ä¸”åœ¨å®Œæˆæ—¶è°ƒç”¨ callback(error, redirectLocation, renderProps)ã€‚ ä¼ ç»™å›žè°ƒå‡½æ•°åŽ» match çš„ä¸‰ä¸ªå‚æ•°å¦‚ä¸‹ï¼š errorï¼šå¦‚æžœæŠ¥é”™æ—¶ä¼šå‡ºçŽ°ä¸€ä¸ª Javascript çš„ Error å¯¹è±¡ï¼Œå¦åˆ™æ˜¯ undefinedã€‚ redirectLocationï¼šå¦‚æžœ route é‡å®šå‘æ—¶ä¼šæœ‰ä¸€ä¸ª Location å¯¹è±¡ï¼Œå¦åˆ™æ˜¯ undefinedã€‚ renderPropsï¼šå½“åŒ¹é…åˆ° route æ—¶ props åº”è¯¥é€šè¿‡è·¯ç”±çš„ contextï¼Œå¦åˆ™æ˜¯ undefinedã€‚ å¦‚æžœè¿™ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯ undefinedï¼Œè¿™å°±æ„å‘³ç€åœ¨ç»™å®šçš„ location ä¸­æ²¡æœ‰ route è¢«åŒ¹é…åˆ°ã€‚ æ³¨æ„ï¼šä½ å¯èƒ½ä¸æƒ³åœ¨æµè§ˆå™¨ä¸­ç”¨å®ƒï¼Œé™¤éžä½ åšçš„æ˜¯å¼‚æ­¥ route çš„æœåŠ¡ç«¯æ¸²æŸ“ã€‚ createRoutes(routes)åˆ›å»ºå¹¶è¿”å›žä¸€ä¸ªä»Žç»™å®šå¯¹è±¡ route çš„æ•°ç»„ï¼Œå®ƒå¯èƒ½æ˜¯ JSX çš„ routeï¼Œä¸€ä¸ªæ™®é€šå¯¹è±¡çš„ routeï¼Œæˆ–æ˜¯å…¶ä»–çš„æ•°ç»„ã€‚ paramsroutesä¸€ä¸ªæˆ–å¤šä¸ªçš„ Route æˆ– PlainRouteã€‚ æ›´å¤šèµ„æºreact-routerä¸­æ–‡æ–‡æ¡£é˜®ä¸€å³°React-router]]></content>
      <categories>
        <category>React-router</category>
      </categories>
      <tags>
        <tag>React-router</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ è¿˜åœ¨ç”¨forå¾ªçŽ¯å¤§æ³•å—ï¼Ÿ]]></title>
    <url>%2F2018%2F03%2F07%2FJs%2F%E4%BD%A0%E8%BF%98%E5%9C%A8%E7%94%A8for%E5%BE%AA%E7%8E%AF%E5%A4%A7%E6%B3%95%E5%90%97%EF%BC%9F%2F</url>
    <content type="text"><![CDATA[æ–‡ç« ä¸»è¦ä»‹ç»äº†æ•°ç»„Array.prototypeæ–¹æ³•çš„ä½¿ç”¨ï¼Œéœ€è¦çš„æœ‹å‹å¯ä»¥å‚è€ƒä¸‹ï¼Œå¦‚æžœä½ æ˜¯å¤§ç¥žï¼Œè¯·ç›´æŽ¥æ— è§†ã€‚ åœ¨ES5ä¸­ï¼Œä¸€å…±æœ‰9ä¸ªArrayæ–¹æ³• http://kangax.github.io/compat-table/es5/ Array.prototype.indexOf Array.prototype.lastIndexOf Array.prototype.every Array.prototype.some Array.prototype.forEach Array.prototype.map Array.prototype.filter Array.prototype.reduce Array.prototype.reduceRight åœ¨ES6å³å°†æ™®åŠçš„æ—¶ä»£ï¼Œæˆ‘ç›¸ä¿¡è¿™äº›æ–¹æ³•å¯¹FEå¼€å‘è€…æ˜¯éžå¸¸å®žç”¨çš„å¿…å¤‡æŠ€èƒ½ï¼ŒæŽ¥ä¸‹æ¥æˆ‘å°†é€šè¿‡å®žä¾‹å¸®å¤§å®¶æ›¿æ¢forå¾ªçŽ¯å¤§æ³•ï¼Œæ›´é«˜æ•ˆçš„æ¥æ“ä½œæ•°ç»„ã€‚ indexOfindexOf()æ–¹æ³•è¿”å›žåœ¨è¯¥æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„å…ƒç´ ä½ç½®ï¼Œå¦‚æžœå®ƒä¸å­˜åœ¨åˆ™è¿”å›ž-1ã€‚ ä½¿ç”¨forï¼š12345678ar arr = ['apple','orange','pear'], found = false;for(var i= 0, l = arr.length; i&lt; l; i++)&#123; if(arr[i] === 'orange')&#123; found = true; &#125;&#125;console.log("found:",found); ä½¿ç”¨indexOfï¼š12var arr = ['apple','orange','pear']; console.log("found:", arr.indexOf("orange") != -1); lastindexOfastIndexOf() æ–¹æ³•è¿”å›žåœ¨è¯¥æ•°ç»„ä¸­æœ€åŽä¸€ä¸ªæ‰¾åˆ°çš„å…ƒç´ ä½ç½®ï¼Œå’Œ indexofç›¸åã€‚ every()every()å¯æ˜¯æ£€æµ‹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹æ˜¯å¦ç¬¦åˆæ¡ä»¶ ä½¿ç”¨forï¼š12345678910111213/* * æ˜¯å¦å…¨éƒ¨å¤§äºŽ0*/var ary = [12,23,24,42,1];var result = function()&#123; for (var i = 0; i &lt; ary.length; i++) &#123; if(ary[i] &lt; 0)&#123; return false; &#125; &#125; return true; //éœ€å…¨éƒ¨æ»¡è¶³&#125;console.log(result()) //å…¨éƒ¨æ»¡è¶³,è¿”å›žtrue ä½¿ç”¨everyï¼š12345var ary = [12,23,24,42,1];var result = ary.every(function(item, index)&#123; return item &gt; 0&#125;)console.log(result) some()some()å¯ä»¥æ£€æµ‹æ•°ç»„ä¸­æ˜¯å¦æœ‰æŸä¸€é¡¹ç¬¦åˆæ¡ä»¶ ä½¿ç”¨for12345678910111213/* * æ˜¯å¦å­˜åœ¨å°äºŽ0çš„é¡¹*/var ary = [12,23,-24,42,1];var result = function()&#123; for (var i = 0; i &lt; ary.length; i++) &#123; if(ary[i] &lt; 0)&#123; return true; &#125; &#125; return false; //åªéœ€æ»¡è¶³ä¸€ä¸ª&#125;console.log(result()) //æœ‰ä¸€é¡¹å°äºŽ0ï¼Œè¿”å›žtrue ä½¿ç”¨some12345var ary = [12,23,-24,42,1];var result = ary.some(function(item, index)&#123; return item &lt; 0&#125;)console.log(result) forEach()forEachä¸ºæ¯ä¸ªå…ƒç´ æ‰§è¡Œå¯¹åº”çš„æ–¹æ³• ä½¿ç”¨forï¼š12345var arr = [1,2,3,4,5,6,7,8];for(var i= 0, l = arr.length; i&lt; l; i++)&#123;console.log(arr[i]);&#125; ä½¿ç”¨forEach()ï¼š12345var arr = [1,2,3,4,5,6,7,8];arr.forEach(function(item,index)&#123;console.log(item);&#125;); forEachæ˜¯ç”¨æ¥æ›¿æ¢forå¾ªçŽ¯çš„ map()map()å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œä¸€å®šæ“ä½œï¼ˆæ˜ å°„ï¼‰åŽï¼Œä¼šè¿”å›žä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œ ä½¿ç”¨forï¼š123456789101112var oldArr = [&#123;first_name:"Colin",last_name:"Toh"&#125;,&#123;first_name:"Addy",last_name:"Osmani"&#125;,&#123;first_name:"Yehuda",last_name:"Katz"&#125;];function getNewArr()&#123; var newArr = []; for(var i= 0, l = oldArr.length; i&lt; l; i++)&#123; var item = oldArr[i]; item.full_name = [item.first_name,item.last_name].join(" "); newArr[i] = item; &#125; return newArr;&#125;console.log(getNewArr()); ä½¿ç”¨mapï¼š12345678910var oldArr = [&#123;first_name:"Colin",last_name:"Toh"&#125;,&#123;first_name:"Addy",last_name:"Osmani"&#125;,&#123;first_name:"Yehuda",last_name:"Katz"&#125;];function getNewArr()&#123; return oldArr.map(function(item,index)&#123; item.full_name = [item.first_name,item.last_name].join(" "); return item; &#125;);&#125;console.log(getNewArr()); map()æ˜¯å¤„ç†æœåŠ¡å™¨è¿”å›žæ•°æ®æ—¶æ˜¯ä¸€ä¸ªéžå¸¸å®žç”¨çš„å‡½æ•°ã€‚ forEach ä¸Žmapçš„åŒºåˆ«ï¼š è¯­æ³•ï¼šforEachå’Œmapéƒ½æ”¯æŒ2ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯å›žè°ƒå‡½æ•°ï¼ˆitem,index,listï¼‰å’Œä¸Šä¸‹æ–‡ï¼› forEachï¼šç”¨æ¥éåŽ†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ï¼›è¿™ä¸ªæ–¹æ³•æ‰§è¡Œæ˜¯æ²¡æœ‰è¿”å›žå€¼çš„ï¼Œå¯¹åŽŸæ¥æ•°ç»„ä¹Ÿæ²¡æœ‰å½±å“ï¼›æ•°ç»„ä¸­æœ‰å‡ é¡¹ï¼Œé‚£ä¹ˆä¼ é€’è¿›åŽ»çš„åŒ¿åå›žè°ƒå‡½æ•°å°±éœ€è¦æ‰§è¡Œå‡ æ¬¡ï¼›æ¯ä¸€æ¬¡æ‰§è¡ŒåŒ¿åå‡½æ•°çš„æ—¶å€™ï¼Œè¿˜ç»™å…¶ä¼ é€’äº†ä¸‰ä¸ªå‚æ•°å€¼ï¼šæ•°ç»„ä¸­çš„å½“å‰é¡¹item,å½“å‰é¡¹çš„ç´¢å¼•index,åŽŸå§‹æ•°ç»„listï¼›ç†è®ºä¸Šè¿™ä¸ªæ–¹æ³•æ˜¯æ²¡æœ‰è¿”å›žå€¼çš„ï¼Œä»…ä»…æ˜¯éåŽ†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ï¼Œä¸å¯¹åŽŸæ¥æ•°ç»„è¿›è¡Œä¿®æ”¹ï¼›ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è‡ªå·±é€šè¿‡æ•°ç»„çš„ç´¢å¼•æ¥ä¿®æ”¹åŽŸæ¥çš„æ•°ç»„ï¼› forEachæ–¹æ³•ä¸­çš„thisæ˜¯ary,åŒ¿åå›žè°ƒå‡½æ•°ä¸­çš„thisé»˜è®¤æ˜¯windowï¼› 123456var ary = [12,23,24,42,1];var res = ary.forEach(function (item,index,input) &#123; input[index] = item*10;&#125;)console.log(res);//--&gt;undefined;console.log(ary);//--&gt;ä¼šå¯¹åŽŸæ¥çš„æ•°ç»„äº§ç”Ÿæ”¹å˜ï¼› mapï¼š å’ŒforEachéžå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯ç”¨æ¥éåŽ†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹å€¼çš„ï¼Œç”¨æ¥éåŽ†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ï¼› åŒºåˆ«ï¼šmapçš„å›žè°ƒå‡½æ•°ä¸­æ”¯æŒreturnè¿”å›žå€¼ï¼›returnçš„æ˜¯å•¥ï¼Œç›¸å½“äºŽæŠŠæ•°ç»„ä¸­çš„è¿™ä¸€é¡¹å˜ä¸ºå•¥ï¼ˆå¹¶ä¸å½±å“åŽŸæ¥çš„æ•°ç»„ï¼Œåªæ˜¯ç›¸å½“äºŽæŠŠåŽŸæ•°ç»„å…‹éš†ä¸€ä»½ï¼ŒæŠŠå…‹éš†çš„è¿™ä¸€ä»½çš„æ•°ç»„ä¸­çš„å¯¹åº”é¡¹æ”¹å˜äº†ï¼‰ï¼› ä¸ç®¡æ˜¯forEachè¿˜æ˜¯map éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ„æ€æ˜¯æŠŠåŒ¿åå›žè°ƒå‡½æ•°ä¸­çš„thisè¿›è¡Œä¿®æ”¹ã€‚ 123456var ary = [12,23,24,42,1];var res = ary.map(function (item,index,input) &#123; return item*10;&#125;)console.log(res);//--&gt;[120,230,240,420,10];console.log(ary);//--&gt;[12,23,24,42,1]ï¼› filterè¯¥filter()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ¹é…è¿‡æ»¤æ¡ä»¶çš„æ•°ç»„ã€‚ä½¿ç”¨forï¼š 12345678910111213var arr = [ &#123;"name":"apple", "count": 2&#125;, &#123;"name":"orange", "count": 5&#125;, &#123;"name":"pear", "count": 3&#125;, &#123;"name":"orange", "count": 16&#125;,];var newArr = [];for(var i= 0, l = arr.length; i&lt; l; i++)&#123; if(arr[i].name === "orange" )&#123; newArr.push(arr[i]); &#125;&#125;console.log("Filter results:",newArr); ä½¿ç”¨ filter()ï¼š12345678910var arr = [ &#123;"name":"apple", "count": 2&#125;, &#123;"name":"orange", "count": 5&#125;, &#123;"name":"pear", "count": 3&#125;, &#123;"name":"orange", "count": 16&#125;,];var newArr = arr.filter(function(item)&#123; return item.name === "orange";&#125;);console.log("Filter results:",newArr); reduce()reduce()å¯ä»¥å®žçŽ°ä¸€ä¸ªç´¯åŠ å™¨çš„åŠŸèƒ½ï¼Œå°†æ•°ç»„çš„æ¯ä¸ªå€¼ï¼ˆä»Žå·¦åˆ°å³ï¼‰å°†å…¶é™ä½Žåˆ°ä¸€ä¸ªå€¼ã€‚ è¯´å®žè¯åˆšå¼€å§‹ç†è§£è¿™å¥è¯æœ‰ç‚¹éš¾åº¦ï¼Œå®ƒå¤ªæŠ½è±¡äº†ã€‚ åœºæ™¯ï¼š ç»Ÿè®¡ä¸€ä¸ªæ•°ç»„ä¸­æœ‰å¤šå°‘ä¸ªä¸é‡å¤çš„å•è¯ä½¿ç”¨forï¼š1234567891011var arr = ["apple","orange","apple","orange","pear","orange"];function getWordCnt()&#123; var obj = &#123;&#125;; for(var i= 0, l = arr.length; i&lt; l; i++)&#123; var item = arr[i]; obj[item] = (obj[item] +1 ) || 1; &#125; return obj;&#125;console.log(getWordCnt()); è®©æˆ‘å…ˆè§£é‡Šä¸€ä¸‹æˆ‘è‡ªå·±å¯¹reduceçš„ç†è§£ã€‚reduce(callback, initialValue)ä¼šä¼ å…¥ä¸¤ä¸ªå˜é‡ã€‚å›žè°ƒå‡½æ•°(callback)å’Œåˆå§‹å€¼(initialValue)ã€‚å‡è®¾å‡½æ•°å®ƒæœ‰ä¸ªä¼ å…¥å‚æ•°ï¼Œprevå’Œnext,indexå’Œarrayã€‚prevå’Œnextä½ æ˜¯å¿…é¡»è¦äº†è§£çš„ã€‚ä¸€èˆ¬æ¥è®²prevæ˜¯ä»Žæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹çš„ï¼Œnextæ˜¯ç¬¬äºŒä¸ªå…ƒç´ ã€‚ä½†æ˜¯å½“ä½ ä¼ å…¥åˆå§‹å€¼(initialValue)åŽï¼Œç¬¬ä¸€ä¸ªprevå°†æ˜¯initivalValueï¼Œnextå°†æ˜¯æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ 123456789101112131415161718192021222324/* * äºŒè€…çš„åŒºåˆ«ï¼Œåœ¨consoleä¸­è¿è¡Œä¸€ä¸‹å³å¯çŸ¥æ™“*/var arr = ["apple","orange"];function noPassValue()&#123; return arr.reduce(function(prev,next)&#123; console.log("prev:",prev); console.log("next:",next); return prev + " " +next; &#125;);&#125;function passValue()&#123; return arr.reduce(function(prev,next)&#123; console.log("prev:",prev); console.log("next:",next); prev[next] = 1; return prev; &#125;,&#123;&#125;);&#125;console.log("No Additional parameter:",noPassValue());console.log("----------------");console.log("With &#123;&#125; as an additional parameter:",passValue()); reduceRight() reduceRightçš„è¯­æ³•ä»¥åŠå›žè°ƒå‡½æ•°çš„è§„åˆ™å’Œreduceæ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«å°±æ˜¯åœ¨ä¸Žreduceæ˜¯å‡åºï¼Œå³è§’æ ‡ä»Ž0å¼€å§‹ï¼Œè€ŒreduceRightæ˜¯é™åºï¼Œå³è§’æ ‡ä»Žarr.length-1å¼€å§‹ã€‚ æ–¹æ³•å¯åº”ç”¨äºŽå­—ç¬¦ä¸²ã€‚123456789/* * ä½¿ç”¨æ­¤æ–¹æ³•åè½¬å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦*/var word = "retupmoc";function AppendToArray(previousValue, currentValue) &#123; return previousValue + currentValue;&#125;var result = [].reduceRight.call(word, AppendToArray, "the ");console.log(result); // the computer isArray()isArray()æ˜¯Arrayå¯¹è±¡çš„ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯æ•°ç»„ 123456789101112131415var ary1 = [];var res1 = Array.isArray(ary1); // Output: trueconsole.log(res1)var ary2 = new Array();var res2 = Array.isArray(ary2); // Output: trueconsole.log(res2)var ary3 = [1, 2, 3];var res3 = Array.isArray(ary3); // Output: trueconsole.log(res3)var ary4 = new Date();var res4 = Array.isArray(ary4); // Output: falseconsole.log(res4) åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[flexå’Œgridå¸ƒå±€]]></title>
    <url>%2F2018%2F03%2F06%2FCSS3%2Fflex%E5%92%8Cgrid%E5%B8%83%E5%B1%80%2F</url>
    <content type="text"><![CDATA[ç½‘é¡µå¸ƒå±€ï¼ˆlayoutï¼‰æ˜¯ CSS çš„ä¸€ä¸ªé‡ç‚¹åº”ç”¨ã€‚ å¸ƒå±€çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆï¼ŒåŸºäºŽç›’çŠ¶æ¨¡åž‹ï¼Œä¾èµ– display å±žæ€§ + positionå±žæ€§ + floatå±žæ€§ã€‚å®ƒå¯¹äºŽé‚£äº›ç‰¹æ®Šå¸ƒå±€éžå¸¸ä¸æ–¹ä¾¿ï¼Œæ¯”å¦‚ï¼Œåž‚ç›´å±…ä¸­å°±ä¸å®¹æ˜“å®žçŽ°ã€‚ Flex å¸ƒå±€2009å¹´ï¼ŒW3C æå‡ºäº†ä¸€ç§æ–°çš„æ–¹æ¡ˆâ€”-Flex å¸ƒå±€ï¼Œå¯ä»¥ç®€ä¾¿ã€å®Œæ•´ã€å“åº”å¼åœ°å®žçŽ°å„ç§é¡µé¢å¸ƒå±€ã€‚ç›®å‰ï¼Œå®ƒå·²ç»å¾—åˆ°äº†æ‰€æœ‰æµè§ˆå™¨çš„æ”¯æŒï¼Œè¿™æ„å‘³ç€ï¼ŒçŽ°åœ¨å°±èƒ½å¾ˆå®‰å…¨åœ°ä½¿ç”¨è¿™é¡¹åŠŸèƒ½ã€‚ åŽŸæ–‡åœ°å€Demoåœ°å€ å®¹å™¨å±žæ€§flex-directionå±žæ€§flex-directionå±žæ€§å†³å®šä¸»è½´çš„æ–¹å‘ï¼ˆå³é¡¹ç›®çš„æŽ’åˆ—æ–¹å‘ï¼‰ã€‚ .box{ flex-direction: row | row-reverse | column | column-reverse } rowï¼ˆé»˜è®¤å€¼ï¼‰ï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ã€‚ row-reverseï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯ã€‚ columnï¼šä¸»è½´ä¸ºåž‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ã€‚ column-reverseï¼šä¸»è½´ä¸ºåž‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ã€‚ flex-wrapå±žæ€§é»˜è®¤æƒ…å†µä¸‹ï¼Œé¡¹ç›®éƒ½æŽ’åœ¨ä¸€æ¡çº¿ï¼ˆåˆç§°â€è½´çº¿â€ï¼‰ä¸Šã€‚flex-wrapå±žæ€§å®šä¹‰ï¼Œå¦‚æžœä¸€æ¡è½´çº¿æŽ’ä¸ä¸‹ï¼Œå¦‚ä½•æ¢è¡Œã€‚ .box{ flex-wrap: nowrap | wrap | wrap-reverse; } nowrapï¼ˆé»˜è®¤ï¼‰ï¼šä¸æ¢è¡Œã€‚wrapï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹ã€‚wrap-reverseï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹ã€‚ flex-flowå±žæ€§flex-flowå±žæ€§æ˜¯flex-directionå±žæ€§å’Œflex-wrapå±žæ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸ºrow nowrapã€‚ .box { flex-flow: &lt;flex-direction&gt; || &lt;flex-wrap&gt;; } justify-contentå±žæ€§justify-contentå±žæ€§å®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ã€‚ .box { justify-content: flex-start | flex-end | center | space-between | space-around; } flex-startï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå·¦å¯¹é½flex-endï¼šå³å¯¹é½centerï¼š å±…ä¸­space-betweenï¼šä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰ã€‚space-aroundï¼šæ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸Žè¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚ align-itemså±žæ€§align-itemså±žæ€§å®šä¹‰é¡¹ç›®åœ¨äº¤å‰è½´ä¸Šå¦‚ä½•å¯¹é½ .box { align-items: flex-start | flex-end | center | baseline | stretch; } flex-startï¼šäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚flex-endï¼šäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚centerï¼šäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚baseline: é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå¦‚æžœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚ align-centetå±žæ€§align-contentå±žæ€§å®šä¹‰äº†å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼ã€‚å¦‚æžœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿ï¼Œè¯¥å±žæ€§ä¸èµ·ä½œç”¨ã€‚ .box { align-content: flex-start | flex-end | center | space-between | space-around | stretch; } flex-startï¼šä¸Žäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚flex-endï¼šä¸Žäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚centerï¼šä¸Žäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚space-betweenï¼šä¸Žäº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚space-aroundï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸Žè¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šè½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´ã€‚ é¡¹ç›®å±žæ€§ä»¥ä¸‹è®¾ç½®åœ¨é¡¹ç›®ä¸Šã€‚ orderå±žæ€§orderå±žæ€§å®šä¹‰é¡¹ç›®çš„æŽ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼ŒæŽ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º0ã€‚ .item { order: &lt;integer&gt;; } flex-growå±žæ€§flex-growå±žæ€§å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æžœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ã€‚ .item { flex-grow: &lt;number&gt;; /* default 0 */ } å¦‚æžœæ‰€æœ‰é¡¹ç›®çš„flex-growå±žæ€§éƒ½ä¸º1ï¼Œåˆ™å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æžœæœ‰çš„è¯ï¼‰ã€‚å¦‚æžœä¸€ä¸ªé¡¹ç›®çš„flex-growå±žæ€§ä¸º2ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€ã€‚ flex-shrinkå±žæ€§flex-shrinkå±žæ€§å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æžœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚ .item { flex-shrink: &lt;number&gt;; /* default 1 */ } å¦‚æžœæ‰€æœ‰é¡¹ç›®çš„flex-shrinkå±žæ€§éƒ½ä¸º1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æžœä¸€ä¸ªé¡¹ç›®çš„flex-shrinkå±žæ€§ä¸º0ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚ è´Ÿå€¼å¯¹è¯¥å±žæ€§æ— æ•ˆã€‚ flex-basiså±žæ€§flex-basiså±žæ€§å®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰ï¼Œé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ï¼ˆmain sizeï¼‰ã€‚æµè§ˆå™¨æ ¹æ®è¿™ä¸ªå±žæ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ã€‚å®ƒçš„é»˜è®¤å€¼ä¸ºautoï¼Œå³é¡¹ç›®çš„æœ¬æ¥å¤§å°ã€‚ .item { flex-basis: &lt;length&gt; | auto; /* default auto */ } å®ƒå¯ä»¥è®¾ä¸ºè·Ÿwidthæˆ–heightå±žæ€§ä¸€æ ·çš„å€¼ï¼ˆæ¯”å¦‚350pxï¼‰ï¼Œåˆ™é¡¹ç›®å°†å æ®å›ºå®šç©ºé—´ã€‚ flexå±žæ€§flexå±žæ€§æ˜¯flex-grow, flex-shrink å’Œ flex-basisçš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º0 1 autoã€‚åŽä¸¤ä¸ªå±žæ€§å¯é€‰ã€‚ .item { flex: none | [ &lt;&#39;flex-grow&#39;&gt; &lt;&#39;flex-shrink&#39;&gt;? || &lt;&#39;flex-basis&#39;&gt; ] } è¯¥å±žæ€§æœ‰ä¸¤ä¸ªå¿«æ·å€¼ï¼šauto (1 1 auto) å’Œ none (0 0 auto)ã€‚ å»ºè®®ä¼˜å…ˆä½¿ç”¨è¿™ä¸ªå±žæ€§ï¼Œè€Œä¸æ˜¯å•ç‹¬å†™ä¸‰ä¸ªåˆ†ç¦»çš„å±žæ€§ï¼Œå› ä¸ºæµè§ˆå™¨ä¼šæŽ¨ç®—ç›¸å…³å€¼ã€‚ align-selfå±žæ€§align-selfå±žæ€§å…è®¸å•ä¸ªé¡¹ç›®æœ‰ä¸Žå…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›–align-itemså±žæ€§ã€‚é»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„align-itemså±žæ€§ï¼Œå¦‚æžœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºŽstretch .item { align-self: auto | flex-start | flex-end | center | baseline | stretch; } è¯¥å±žæ€§å¯èƒ½å–6ä¸ªå€¼ï¼Œé™¤äº†autoï¼Œå…¶ä»–éƒ½ä¸Žalign-itemså±žæ€§å®Œå…¨ä¸€è‡´ã€‚ Gridå¸ƒå±€åŽŸæ–‡åœ°å€ Grid å¸ƒå±€æ˜¯ç½‘ç«™è®¾è®¡çš„åŸºç¡€ï¼ŒCSS Grid æ˜¯åˆ›å»ºç½‘æ ¼å¸ƒå±€æœ€å¼ºå¤§å’Œæœ€ç®€å•çš„å·¥å…·ã€‚ CSS Grid ä»Šå¹´ä¹ŸèŽ·å¾—äº†ä¸»æµæµè§ˆå™¨ï¼ˆSafariï¼ŒChromeï¼ŒFirefoxï¼ŒEdgeï¼‰çš„åŽŸç”Ÿæ”¯æŒï¼Œæ‰€ä»¥æˆ‘ç›¸ä¿¡æ‰€æœ‰çš„å‰ç«¯å¼€å‘äººå‘˜éƒ½å¿…é¡»åœ¨ä¸ä¹…çš„å°†æ¥å­¦ä¹ è¿™é¡¹æŠ€æœ¯ã€‚ CSS Grid(ç½‘æ ¼) å¸ƒå±€ï¼ˆåˆç§°ä¸º â€œGrid(ç½‘æ ¼)â€ ï¼‰ï¼Œæ˜¯ä¸€ä¸ªäºŒç»´çš„åŸºäºŽç½‘æ ¼çš„å¸ƒå±€ç³»ç»Ÿå®ƒçš„ç›®æ ‡æ˜¯å®Œå…¨æ”¹å˜æˆ‘ä»¬åŸºäºŽç½‘æ ¼çš„ç”¨æˆ·ç•Œé¢çš„å¸ƒå±€æ–¹å¼ã€‚CSS ä¸€ç›´ç”¨æ¥å¸ƒå±€æˆ‘ä»¬çš„ç½‘é¡µï¼Œä½†ä¸€ç›´ä»¥æ¥éƒ½å­˜åœ¨è¿™æ ·æˆ–é‚£æ ·çš„é—®é¢˜ã€‚ä¸€å¼€å§‹æˆ‘ä»¬ç”¨è¡¨æ ¼ï¼ˆtableï¼‰ï¼Œç„¶åŽæ˜¯æµ®åŠ¨ï¼ˆfloatï¼‰ï¼Œå†æ˜¯å®šä½ï¼ˆpostionï¼‰å’Œå†…åµŒå—ï¼ˆinline-blockï¼‰ï¼Œä½†æ˜¯æ‰€æœ‰è¿™äº›æ–¹æ³•æœ¬è´¨ä¸Šéƒ½æ˜¯åªæ˜¯ hack è€Œå·²ï¼Œå¹¶ä¸”é—æ¼äº†å¾ˆå¤šé‡è¦çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚åž‚ç›´å±…ä¸­ï¼‰ã€‚Flexbox çš„å‡ºçŽ°å¾ˆå¤§ç¨‹åº¦ä¸Šæ”¹å–„äº†æˆ‘ä»¬çš„å¸ƒå±€æ–¹å¼ï¼Œä½†å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†è§£å†³æ›´ç®€å•çš„ä¸€ç»´å¸ƒå±€ï¼Œè€Œä¸æ˜¯å¤æ‚çš„äºŒç»´å¸ƒå±€ï¼ˆå®žé™…ä¸Š Flexbox å’Œ Grid èƒ½ç»“åˆåœ¨ä¸€èµ·å·¥ä½œï¼Œè€Œä¸”é…åˆå¾—éžå¸¸å¥½ï¼‰ã€‚Grid(ç½‘æ ¼) å¸ƒå±€æ˜¯ç¬¬ä¸€ä¸ªä¸“é—¨ä¸ºè§£å†³å¸ƒå±€é—®é¢˜è€Œåˆ›å»ºçš„ CSS æ¨¡å—ï¼Œæˆ‘ä»¬ç»ˆäºŽä¸éœ€è¦æƒ³å°½åŠžæ³•hack é¡µé¢å¸ƒå±€æ ·å¼äº†ã€‚ ç½‘æ ¼å®¹å™¨(Grid Container)åº”ç”¨ display: grid çš„å…ƒç´ ã€‚è¿™æ˜¯æ‰€æœ‰ç½‘æ ¼é¡¹ï¼ˆGrid Itemsï¼‰çš„ç›´æŽ¥çˆ¶çº§å…ƒç´ ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œcontainer å°±æ˜¯ ç½‘æ ¼å®¹å™¨(Grid Container)ã€‚ &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;item item-1&quot;&gt;&lt;/div&gt; &lt;div class=&quot;item item-2&quot;&gt;&lt;/div&gt; &lt;div class=&quot;item item-3&quot;&gt;&lt;/div&gt; &lt;/div&gt; display grid ï¼šç”Ÿæˆä¸€ä¸ªå—çº§ç½‘æ ¼inline-grid ï¼šç”Ÿæˆä¸€ä¸ªå†…è”ç½‘æ ¼subgrid ï¼šå¦‚æžœä½ çš„ç½‘æ ¼å®¹å™¨æœ¬èº«æ˜¯å¦ä¸€ä¸ªç½‘æ ¼çš„ç½‘æ ¼é¡¹ï¼ˆå³åµŒå¥—ç½‘æ ¼ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå±žæ€§æ¥è¡¨ç¤º ä½ å¸Œæœ›å®ƒçš„è¡Œ/åˆ—çš„å¤§å°ç»§æ‰¿è‡ªå®ƒçš„çˆ¶çº§ç½‘æ ¼å®¹å™¨ï¼Œè€Œä¸æ˜¯è‡ªå·±æŒ‡å®šçš„ã€‚ å¦‚æžœä½ æƒ³è¦è®¾ç½®ä¸ºç½‘æ ¼å®¹å™¨å…ƒç´ æœ¬èº«å·²ç»æ˜¯ç½‘æ ¼é¡¹ï¼ˆåµŒå¥—ç½‘æ ¼å¸ƒå±€ï¼‰ï¼Œç”¨è¿™ä¸ªå±žæ€§æŒ‡æ˜Žè¿™ä¸ªå®¹å™¨å†…éƒ¨çš„ç½‘æ ¼é¡¹çš„è¡Œåˆ—å°ºå¯¸ç›´æŽ¥ç»§æ‰¿å…¶çˆ¶çº§çš„ç½‘æ ¼å®¹å™¨å±žæ€§ã€‚ .container { display: grid | inline-grid | subgrid; } æ³¨æ„ï¼šåœ¨ç½‘æ ¼å®¹å™¨(Grid Container) ä¸Šä½¿ç”¨columnï¼Œfloatï¼Œclearï¼Œ vertical-alignä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæžœã€‚ grid-template-columns / grid-template-rowsä½¿ç”¨ç©ºæ ¼åˆ†éš”çš„å€¼åˆ—è¡¨ï¼Œç”¨æ¥å®šä¹‰ç½‘æ ¼çš„åˆ—å’Œè¡Œã€‚è¿™äº›å€¼è¡¨ç¤º ç½‘æ ¼è½¨é“(Grid Track) å¤§å°ï¼Œå®ƒä»¬ä¹‹é—´çš„ç©ºæ ¼è¡¨ç¤ºç½‘æ ¼çº¿ã€‚ å€¼ï¼šâ€“ ï¼š å¯ä»¥æ˜¯é•¿åº¦å€¼ï¼Œç™¾åˆ†æ¯”ï¼Œæˆ–è€…ç­‰ä»½ç½‘æ ¼å®¹å™¨ä¸­å¯ç”¨ç©ºé—´ï¼ˆä½¿ç”¨ fr å•ä½ï¼‰â€“ ï¼šä½ å¯ä»¥é€‰æ‹©çš„ä»»æ„åç§° .container { grid-template-columns: &lt;track-size&gt; ... | &lt;line-name&gt; &lt;track-size&gt; ...; grid-template-rows: &lt;track-size&gt; ... | &lt;line-name&gt; &lt;track-size&gt; ...; } ç¤ºä¾‹ï¼š .container{ grid-template-columns: 40px 50px auto 50px 40px; grid-template-rows: 25% 100px auto; } ä½†æ˜¯ä½ å¯ä»¥æ˜Žç¡®çš„æŒ‡å®šç½‘æ ¼çº¿(Grid Line)åç§°ï¼Œå³ å€¼ã€‚è¯·æ³¨æ„ç½‘æ ¼çº¿åç§°çš„æ‹¬å·è¯­æ³•ï¼š .container { grid-template-columns: [first] 40px [line2] 50px [line3] auto [col4-start] 50px [five] 40px [end]; grid-template-rows: [row1-start] 25% [row1-end] 100px [third-line] auto [last-line]; } è¯·æ³¨æ„ï¼Œä¸€æ¡ç½‘æ ¼çº¿(Grid Line)å¯ä»¥æœ‰å¤šä¸ªåç§°ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œçš„ç¬¬äºŒæ¡ è¡Œç½‘æ ¼çº¿(row grid lines) å°†æœ‰ä¸¤ä¸ªåå­—ï¼šrow1-end å’Œrow2-start ï¼š .container{ grid-template-rows: [row1-start] 25% [row1-end row2-start] 25% [row2-end]; } å¦‚æžœä½ çš„å®šä¹‰åŒ…å«å¤šä¸ªé‡å¤å€¼ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ repeat() è¡¨ç¤ºæ³•æ¥ç®€åŒ–å®šä¹‰ï¼š .container { grid-template-columns: repeat(3, 20px [col-start]) 5%; } //ç­‰ä»·äºŽ .container { grid-template-columns: 20px [col-start] 20px [col-start] 20px [col-start] 5%; } fr å•å…ƒå…è®¸ä½ ç”¨ç­‰åˆ†ç½‘æ ¼å®¹å™¨å‰©ä½™å¯ç”¨ç©ºé—´æ¥è®¾ç½® ç½‘æ ¼è½¨é“(Grid Track) çš„å¤§å° ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç ä¼šå°†æ¯ä¸ªç½‘æ ¼é¡¹è®¾ç½®ä¸ºç½‘æ ¼å®¹å™¨å®½åº¦çš„ä¸‰åˆ†ä¹‹ä¸€ï¼š .container { grid-template-columns: 1fr 1fr 1fr; } å‰©ä½™å¯ç”¨ç©ºé—´æ˜¯é™¤åŽ»æ‰€æœ‰éžçµæ´»ç½‘æ ¼é¡¹ä¹‹åŽè®¡ç®—å¾—åˆ°çš„ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯ç”¨ç©ºé—´æ€»é‡å‡åŽ» 50px åŽï¼Œå†ç»™ fr å•å…ƒçš„å€¼3ç­‰åˆ†ï¼š .container { grid-template-columns: 1fr 50px 1fr 1fr; } grid-template-areasé€šè¿‡å¼•ç”¨ grid-area å±žæ€§æŒ‡å®šçš„ ç½‘æ ¼åŒºåŸŸ(Grid Area) åç§°æ¥å®šä¹‰ç½‘æ ¼æ¨¡æ¿ã€‚é‡å¤ç½‘æ ¼åŒºåŸŸçš„åç§°å¯¼è‡´å†…å®¹è·¨è¶Šè¿™äº›å•å…ƒæ ¼ã€‚ä¸€ä¸ªç‚¹å·ï¼ˆ.ï¼‰ä»£è¡¨ä¸€ä¸ªç©ºçš„ç½‘æ ¼å•å…ƒã€‚è¿™ä¸ªè¯­æ³•æœ¬èº«å¯è§†ä½œç½‘æ ¼çš„å¯è§†åŒ–ç»“æž„ã€‚ ï¼šç”±ç½‘æ ¼é¡¹çš„ grid-area æŒ‡å®šçš„ç½‘æ ¼åŒºåŸŸåç§°.ï¼ˆç‚¹å·ï¼‰ ï¼šä»£è¡¨ä¸€ä¸ªç©ºçš„ç½‘æ ¼å•å…ƒnoneï¼šä¸å®šä¹‰ç½‘æ ¼åŒºåŸŸ .container { grid-template-areas: &quot; | . | none | ...&quot; &quot;...&quot;; } ç¤ºä¾‹ï¼š .item-a { grid-area: header; } .item-b { grid-area: main; } .item-c { grid-area: sidebar; } .item-d { grid-area: footer; } .container { grid-template-columns: 50px 50px 50px 50px; grid-template-rows: auto; grid-template-areas: &quot;header header header header&quot; &quot;main main . sidebar&quot; &quot;footer footer footer footer&quot;; } ä¸Šé¢çš„ä»£ç å°†åˆ›å»ºä¸€ä¸ª 4 åˆ— 3 è¡Œçš„ç½‘æ ¼ã€‚æ•´ä¸ªé¡¶è¡Œå°†ç”± header åŒºåŸŸ ç»„æˆã€‚ä¸­é—´ä¸€æŽ’å°†ç”±ä¸¤ä¸ª main åŒºåŸŸï¼Œä¸€ä¸ªæ˜¯ç©ºå•å…ƒæ ¼ï¼Œä¸€ä¸ª sidebar åŒºåŸŸç»„æˆã€‚æœ€åŽä¸€è¡Œå…¨æ˜¯ footer åŒºåŸŸç»„æˆã€‚ ä½ å¯ä»¥ä½¿ç”¨ä»»æ„æ•°é‡çš„ç›¸é‚»çš„ ç‚¹. æ¥å£°æ˜Žå•ä¸ªç©ºå•å…ƒæ ¼ã€‚ åªè¦è¿™äº›ç‚¹.ä¹‹é—´æ²¡æœ‰ç©ºéš™éš”å¼€ï¼Œä»–ä»¬å°±è¡¨ç¤ºä¸€ä¸ªå•ä¸€çš„å•å…ƒæ ¼ã€‚ grid-templateç”¨äºŽå®šä¹‰ grid-template-rowsï¼Œgrid-template-columns ï¼Œgrid-template-areas ç¼©å†™ (shorthand) å±žæ€§ã€‚ noneï¼šå°†æ‰€æœ‰ä¸‰ä¸ªå±žæ€§è®¾ç½®ä¸ºå…¶åˆå§‹å€¼subgridï¼šå°†grid-template-rowsï¼Œgrid-template-columns çš„å€¼è®¾ä¸º subgridï¼Œgrid-template-areasè®¾ä¸ºåˆå§‹å€¼ / ï¼šå°† grid-template-columns å’Œ grid-template-rows è®¾ç½®ä¸ºç›¸åº”åœ°ç‰¹å®šçš„å€¼ï¼Œå¹¶ä¸”è®¾ç½®grid-template-areasä¸ºnone .container { grid-template: none | subgrid | &lt;grid-template-rows&gt; / &lt;grid-template-columns&gt;; } ç¤ºä¾‹ï¼š .container { grid-template: [row1-start] &quot;header header header&quot; 25px [row1-end] [row2-start] &quot;footer footer footer&quot; 25px [row2-end] / auto 50px auto; } //ç­‰ä»·äºŽ .container { grid-template-rows: [row1-start] 25px [row1-end row2-start] 25px [row2-end]; grid-template-columns: auto 50px auto; grid-template-areas: &quot;header header header&quot; &quot;footer footer footer&quot;; } ç”±äºŽ grid-template ä¸ä¼šé‡ç½® éšå¼ ç½‘æ ¼å±žæ€§ï¼ˆgrid-auto-columnsï¼Œ grid-auto-rowsï¼Œ å’Œ grid-auto-flowï¼‰ï¼Œè¿™å¯èƒ½æ˜¯ä½ æƒ³åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åšçš„ï¼Œå»ºè®®ä½¿ç”¨grid å±žæ€§ è€Œä¸æ˜¯grid-templateã€‚ grid-column-gap / grid-row-gapæŒ‡å®šç½‘æ ¼çº¿(grid lines)çš„å¤§å°ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡ä¸ºè®¾ç½®åˆ—/è¡Œä¹‹é—´é—´è·çš„å®½åº¦ã€‚ ï¼šé•¿åº¦å€¼ .container { grid-column-gap: &lt;line-size&gt;; grid-row-gap: &lt;line-size&gt;; } ç¤ºä¾‹ï¼š .container { grid-template-columns: 100px 50px 100px; grid-template-rows: 80px auto 80px; grid-column-gap: 10px; grid-row-gap: 15px; } åªèƒ½åœ¨ åˆ—/è¡Œ ä¹‹é—´åˆ›å»ºé—´è·ï¼Œç½‘æ ¼å¤–éƒ¨è¾¹ç¼˜ä¸ä¼šæœ‰è¿™ä¸ªé—´è·ã€‚ grid-gapgrid-column-gap å’Œ grid-row-gapçš„ç¼©å†™è¯­æ³• ï¼šé•¿åº¦å€¼ .container { grid-gap: &lt;grid-row-gap&gt; &lt;grid-column-gap&gt;; } ç¤ºä¾‹:å¦‚æžœgrid-row-gapæ²¡æœ‰å®šä¹‰ï¼Œé‚£ä¹ˆå°±ä¼šè¢«è®¾ç½®ä¸ºç­‰åŒäºŽ grid-column-gap çš„å€¼ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç æ˜¯ç­‰ä»·çš„ï¼š .container{ grid-template-columns: 100px 50px 100px; grid-template-rows: 80px auto 80px; grid-gap: 10px 15px; } //ç­‰ä»·äºŽ .container{ /* è®¾ç½® [`grid-column-gap`](http://www.css88.com/archives/8510#prop-grid-column-row-gap) å’Œ [`grid-row-gap`](http://www.css88.com/archives/8510#prop-grid-column-row-gap) */ grid-column-gap: 10px; grid-column-gap: 10px; /* ç­‰ä»·äºŽ */ grid-gap: 10px 10px; /* ç­‰ä»·äºŽ */ grid-gap: 10px; } justify-itemsæ²¿ç€ è¡Œè½´çº¿(row axis) å¯¹é½ ç½‘æ ¼é¡¹(grid items) å†…çš„å†…å®¹ï¼ˆç›¸åçš„å±žæ€§æ˜¯ align-items æ²¿ç€åˆ—è½´çº¿å¯¹é½ï¼‰ã€‚è¯¥å€¼é€‚ç”¨äºŽå®¹å™¨å†…çš„æ‰€æœ‰ç½‘æ ¼é¡¹ã€‚ startï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸ(grid area)çš„å·¦ä¾§endï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„å³ä¾§centerï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„ä¸­é—´ï¼ˆæ°´å¹³å±…ä¸­ï¼‰stretchï¼šå¡«æ»¡ç½‘æ ¼åŒºåŸŸå®½åº¦ï¼ˆé»˜è®¤å€¼ï¼‰ .container { justify-items: start | end | center | stretch; } align-itemsæ²¿ç€ åˆ—è½´çº¿(column axis) å¯¹é½ ç½‘æ ¼é¡¹(grid items) å†…çš„å†…å®¹ï¼ˆç›¸åçš„å±žæ€§æ˜¯ justify-items æ²¿ç€è¡Œè½´çº¿å¯¹é½ï¼‰ã€‚è¯¥å€¼é€‚ç”¨äºŽå®¹å™¨å†…çš„æ‰€æœ‰ç½‘æ ¼é¡¹ã€‚ startï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸ(grid area)çš„é¡¶éƒ¨endï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„åº•éƒ¨centerï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„ä¸­é—´ï¼ˆåž‚ç›´å±…ä¸­ï¼‰stretchï¼šå¡«æ»¡ç½‘æ ¼åŒºåŸŸé«˜åº¦ï¼ˆé»˜è®¤å€¼ï¼‰ .container { align-items: start | end | center | stretch; } justify-contentæœ‰æ—¶ï¼Œä½ çš„ç½‘æ ¼åˆè®¡å¤§å°å¯èƒ½å°äºŽå…¶ ç½‘æ ¼å®¹å™¨(grid container) å¤§å°ã€‚ å¦‚æžœä½ çš„æ‰€æœ‰ ç½‘æ ¼é¡¹(grid items) éƒ½ä½¿ç”¨åƒ px è¿™æ ·çš„éžçµæ´»å•ä½è®¾ç½®å¤§å°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥è®¾ç½®ç½‘æ ¼å®¹å™¨å†…çš„ç½‘æ ¼çš„å¯¹é½æ–¹å¼ã€‚ æ­¤å±žæ€§æ²¿ç€ è¡Œè½´çº¿(row axis) å¯¹é½ç½‘æ ¼ï¼ˆç›¸åçš„å±žæ€§æ˜¯ align-content ï¼Œæ²¿ç€åˆ—è½´çº¿å¯¹é½ç½‘æ ¼ï¼‰ã€‚ startï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨(grid container) çš„å·¦è¾¹endï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨ çš„å³è¾¹centerï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨ çš„ä¸­é—´ï¼ˆæ°´å¹³å±…ä¸­ï¼‰stretchï¼šè°ƒæ•´ ç½‘æ ¼é¡¹(grid items) çš„å®½åº¦ï¼Œå…è®¸è¯¥ç½‘æ ¼å¡«å……æ»¡æ•´ä¸ª ç½‘æ ¼å®¹å™¨ çš„å®½åº¦space-aroundï¼šåœ¨æ¯ä¸ªç½‘æ ¼é¡¹ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œå·¦å³ä¸¤ç«¯æ”¾ç½®ä¸€åŠçš„ç©ºé—´space-betweenï¼šåœ¨æ¯ä¸ªç½‘æ ¼é¡¹ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œå·¦å³ä¸¤ç«¯æ²¡æœ‰ç©ºé—´space-evenlyï¼šåœ¨æ¯ä¸ªæ …æ ¼é¡¹ç›®ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œå·¦å³ä¸¤ç«¯æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ .container { justify-content: start | end | center | stretch | space-around | space-between | space-evenly; } align-contentæœ‰æ—¶ï¼Œä½ çš„ç½‘æ ¼åˆè®¡å¤§å°å¯èƒ½å°äºŽå…¶ ç½‘æ ¼å®¹å™¨(grid container) å¤§å°ã€‚ å¦‚æžœä½ çš„æ‰€æœ‰ ç½‘æ ¼é¡¹(grid items) éƒ½ä½¿ç”¨åƒ px è¿™æ ·çš„éžçµæ´»å•ä½è®¾ç½®å¤§å°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥è®¾ç½®ç½‘æ ¼å®¹å™¨å†…çš„ç½‘æ ¼çš„å¯¹é½æ–¹å¼ã€‚ æ­¤å±žæ€§æ²¿ç€ åˆ—è½´çº¿(column axis) å¯¹é½ç½‘æ ¼ï¼ˆç›¸åçš„å±žæ€§æ˜¯ justify-content ï¼Œæ²¿ç€è¡Œè½´çº¿å¯¹é½ç½‘æ ¼ï¼‰ã€‚ startï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨(grid container) çš„é¡¶éƒ¨endï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨ çš„åº•éƒ¨centerï¼šå°†ç½‘æ ¼å¯¹é½åˆ° ç½‘æ ¼å®¹å™¨ çš„ä¸­é—´ï¼ˆåž‚ç›´å±…ä¸­ï¼‰stretchï¼šè°ƒæ•´ ç½‘æ ¼é¡¹(grid items) çš„é«˜åº¦ï¼Œå…è®¸è¯¥ç½‘æ ¼å¡«å……æ»¡æ•´ä¸ª ç½‘æ ¼å®¹å™¨ çš„é«˜åº¦space-aroundï¼šåœ¨æ¯ä¸ªç½‘æ ¼é¡¹ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œä¸Šä¸‹ä¸¤ç«¯æ”¾ç½®ä¸€åŠçš„ç©ºé—´space-betweenï¼šåœ¨æ¯ä¸ªç½‘æ ¼é¡¹ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œä¸Šä¸‹ä¸¤ç«¯æ²¡æœ‰ç©ºé—´space-evenlyï¼šåœ¨æ¯ä¸ªæ …æ ¼é¡¹ç›®ä¹‹é—´æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ï¼Œä¸Šä¸‹ä¸¤ç«¯æ”¾ç½®ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ .container { align-content: start | end | center | stretch | space-around | space-between | space-evenly; } grid-auto-columns / grid-auto-rowsæŒ‡å®šä»»ä½•è‡ªåŠ¨ç”Ÿæˆçš„ç½‘æ ¼è½¨é“(grid tracks)ï¼ˆåˆåéšå¼ç½‘æ ¼è½¨é“ï¼‰çš„å¤§å°ã€‚åœ¨ä½ æ˜Žç¡®å®šä½çš„è¡Œæˆ–åˆ—ï¼ˆé€šè¿‡ grid-template-rows / grid-template-columnsï¼‰ï¼Œè¶…å‡ºå®šä¹‰çš„ç½‘æ ¼èŒƒå›´æ—¶ï¼Œéšå¼ç½‘æ ¼è½¨é“è¢«åˆ›å»ºäº†ã€‚ ï¼šå¯ä»¥æ˜¯é•¿åº¦å€¼ï¼Œç™¾åˆ†æ¯”ï¼Œæˆ–è€…ç­‰ä»½ç½‘æ ¼å®¹å™¨ä¸­å¯ç”¨ç©ºé—´ï¼ˆä½¿ç”¨ fr å•ä½ï¼‰ .container { grid-auto-columns: &lt;track-size&gt; ...; grid-auto-rows: &lt;track-size&gt; ...; } ä¸ºäº†è¯´æ˜Žå¦‚ä½•åˆ›å»ºéšå¼ç½‘æ ¼è½¨é“ï¼Œè¯·è€ƒè™‘ä¸€ä¸‹ä»¥ä¸‹çš„ä»£ç ï¼š .container { grid-template-columns: 60px 60px; grid-template-rows: 90px 90px } ä½†çŽ°åœ¨æƒ³è±¡ä¸€ä¸‹ï¼Œä½ ä½¿ç”¨ grid-column å’Œ grid-row æ¥å®šä½ä½ çš„ç½‘æ ¼é¡¹ï¼ˆgrid itemsï¼‰ï¼Œåƒè¿™æ ·ï¼š .item-a { grid-column: 1 / 2; grid-row: 2 / 3; } .item-b { grid-column: 5 / 6; grid-row: 2 / 3; } å› ä¸ºæˆ‘ä»¬å¼•ç”¨çš„ç½‘æ ¼çº¿ä¸å­˜åœ¨ï¼Œæ‰€ä»¥åˆ›å»ºå®½åº¦ä¸º 0 çš„éšå¼ç½‘æ ¼è½¨é“ä»¥å¡«è¡¥ç©ºç¼ºã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ grid-auto-columns å’Œ grid-auto-rows æ¥æŒ‡å®šè¿™äº›éšå¼è½¨é“çš„å¤§å°ï¼š .container { grid-auto-columns: 60px; } grid-auto-flowå¦‚æžœä½ æœ‰ä¸€äº›æ²¡æœ‰æ˜Žç¡®æ”¾ç½®åœ¨ç½‘æ ¼ä¸Šçš„ç½‘æ ¼é¡¹(grid items)ï¼Œè‡ªåŠ¨æ”¾ç½®ç®—æ³• ä¼šè‡ªåŠ¨æ”¾ç½®è¿™äº›ç½‘æ ¼é¡¹ã€‚è¯¥å±žæ€§æŽ§åˆ¶è‡ªåŠ¨å¸ƒå±€ç®—æ³•å¦‚ä½•å·¥ä½œã€‚ rowï¼šå‘Šè¯‰è‡ªåŠ¨å¸ƒå±€ç®—æ³•ä¾æ¬¡å¡«å……æ¯è¡Œï¼Œæ ¹æ®éœ€è¦æ·»åŠ æ–°è¡Œcolumnï¼šå‘Šè¯‰è‡ªåŠ¨å¸ƒå±€ç®—æ³•ä¾æ¬¡å¡«å…¥æ¯åˆ—ï¼Œæ ¹æ®éœ€è¦æ·»åŠ æ–°åˆ—denseï¼šå‘Šè¯‰è‡ªåŠ¨å¸ƒå±€ç®—æ³•åœ¨ç¨åŽå‡ºçŽ°è¾ƒå°çš„ç½‘æ ¼é¡¹æ—¶ï¼Œå°è¯•å¡«å……ç½‘æ ¼ä¸­è¾ƒæ—©çš„ç©ºç¼º .container { grid-auto-flow: row | column | row dense | column dense } gridåœ¨ä¸€ä¸ªå£°æ˜Žä¸­è®¾ç½®æ‰€æœ‰ä»¥ä¸‹å±žæ€§çš„ç®€å†™ï¼š grid-template-rows, grid-template-columns, grid-template-areas, grid-auto-rows, grid-auto-columns, å’Œ grid-auto-flow ã€‚å®ƒè¿˜å°†grid-column-gap å’Œ grid-column-gapè®¾ç½®ä¸ºåˆå§‹å€¼ï¼Œå³ä½¿å®ƒä»¬ä¸å¯ä»¥é€šè¿‡gridå±žæ€§æ˜¾å¼åœ°è®¾ç½®ã€‚ noneï¼šå°†æ‰€æœ‰å­å±žæ€§è®¾ç½®ä¸ºå…¶åˆå§‹å€¼ / ï¼šå°† grid-template-rows å’Œ grid-template-columns åˆ†åˆ«è®¾ç½®ä¸ºæŒ‡å®šå€¼ï¼Œå°†æ‰€æœ‰å…¶ä»–å­å±žæ€§è®¾ç½®ä¸ºå…¶åˆå§‹å€¼ [ [ / ] ] ï¼šåˆ†åˆ«æŽ¥å—æ‰€æœ‰ä¸Ž grid-auto-flow ï¼Œgrid-auto-rows å’Œ grid-auto-columns ç›¸åŒçš„å€¼ã€‚å¦‚æžœçœç•¥äº† grid-auto-columns ï¼Œå®ƒè¢«è®¾ç½®ä¸ºç”± grid-auto-rows æŒ‡å®šçš„å€¼ã€‚å¦‚æžœä¸¤è€…éƒ½è¢«çœç•¥ï¼Œä»–ä»¬å°±ä¼šè¢«è®¾ç½®ä¸ºåˆå§‹å€¼ .container { grid: none | &lt;grid-template-rows&gt; / &lt;grid-template-columns&gt; | &lt;grid-auto-flow&gt; [&lt;grid-auto-rows&gt; [/ &lt;grid-auto-columns&gt;]]; } ç¤ºä¾‹ï¼š .container { grid: 200px auto / 1fr auto 1fr; } //ç­‰ä»·äºŽ .container { grid-template-rows: 200px auto; grid-template-columns: 1fr auto 1fr; grid-template-areas: none; } .container { grid: column 1fr / auto; } //ç­‰ä»·äºŽ .container { grid-auto-flow: column; grid-auto-rows: 1fr; grid-auto-columns: auto; } å®ƒä¹ŸæŽ¥å—ä¸€ä¸ªæ›´å¤æ‚ä½†ç›¸å½“æ–¹ä¾¿çš„è¯­æ³•æ¥ä¸€æ¬¡è®¾ç½®æ‰€æœ‰å†…å®¹ã€‚æ‚¨å¯ä»¥ grid-template-areasï¼Œgrid-template-rowså’Œgrid-template-columnsï¼Œå¹¶æ‰€æœ‰å…¶ä»–çš„å­å±žæ€§éƒ½è¢«è®¾ç½®ä¸ºå®ƒä»¬çš„åˆå§‹å€¼ã€‚è¿™ä¹ˆåšå¯ä»¥åœ¨å®ƒä»¬ç½‘æ ¼åŒºåŸŸå†…ç›¸åº”åœ°æŒ‡å®šç½‘æ ¼çº¿åå­—å’Œç½‘æ ¼è½¨é“çš„å¤§å°ã€‚ç”¨æœ€ç®€å•çš„ä¾‹å­æ¥æè¿°ï¼š .container { grid: [row1-start] &quot;header header header&quot; 1fr [row1-end] [row2-start] &quot;footer footer footer&quot; 25px [row2-end] / auto 50px auto; } //ç­‰ä»·äºŽ .container { grid-template-areas: &quot;header header header&quot; &quot;footer footer footer&quot;; grid-template-rows: [row1-start] 1fr [row1-end row2-start] 25px [row2-end]; grid-template-columns: auto 50px auto; } ç½‘æ ¼é¡¹(Grid Item)ç½‘æ ¼å®¹å™¨ï¼ˆGrid Containerï¼‰çš„å­å…ƒç´ ï¼ˆä¾‹å¦‚ç›´æŽ¥å­å…ƒç´ ï¼‰ã€‚è¿™é‡Œ item å…ƒç´ å°±æ˜¯ç½‘æ ¼é¡¹(Grid Item)ï¼Œä½†æ˜¯ sub-item ä¸æ˜¯ã€‚ &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;item&quot;&gt;&lt;/div&gt; &lt;div class=&quot;item&quot;&gt; &lt;p class=&quot;sub-item&quot;&gt;&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;item&quot;&gt;&lt;/div&gt; &lt;/div&gt; grid-column-start / grid-column-end / grid-row-start / grid-row-endé€šè¿‡æŒ‡å®š ç½‘æ ¼çº¿(grid lines) æ¥ç¡®å®šç½‘æ ¼å†… ç½‘æ ¼é¡¹(grid item) çš„ä½ç½®ã€‚ grid-column-start / grid-row-start æ˜¯ç½‘æ ¼é¡¹ç›®å¼€å§‹çš„ç½‘æ ¼çº¿ï¼Œgrid-column-end / grid-row-end æ˜¯ç½‘æ ¼é¡¹ç»“æŸçš„ç½‘æ ¼çº¿ã€‚ ï¼šå¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—å¼•ç”¨ä¸€ä¸ªç¼–å·çš„ç½‘æ ¼çº¿ï¼Œæˆ–è€…ä¸€ä¸ªåå­—æ¥å¼•ç”¨ä¸€ä¸ªå‘½åçš„ç½‘æ ¼çº¿span ï¼šè¯¥ç½‘æ ¼é¡¹å°†è·¨è¶Šæ‰€æä¾›çš„ç½‘æ ¼è½¨é“æ•°é‡span ï¼šè¯¥ç½‘æ ¼é¡¹å°†è·¨è¶Šåˆ°å®ƒä¸Žæä¾›çš„åç§°ä½ç½®auto ï¼šè¡¨ç¤ºè‡ªåŠ¨æ”¾ç½®ï¼Œè‡ªåŠ¨è·¨åº¦ï¼Œé»˜è®¤ä¼šæ‰©å±•ä¸€ä¸ªç½‘æ ¼è½¨é“çš„å®½åº¦æˆ–è€…é«˜åº¦ .item { grid-column-start: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto grid-column-end: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto grid-row-start: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto grid-row-end: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto } ç¤ºä¾‹ï¼š .item-a { grid-column-start: 2; grid-column-end: five; grid-row-start: row1-start grid-row-end: 3 } .item-b { grid-column-start: 1; grid-column-end: span col4-start; grid-row-start: 2 grid-row-end: span 2 } å¦‚æžœæ²¡æœ‰å£°æ˜ŽæŒ‡å®š grid-column-end / grid-row-endï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥ç½‘æ ¼é¡¹å°†å æ®1ä¸ªè½¨é“ã€‚ é¡¹ç›®å¯ä»¥ç›¸äº’é‡å ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ z-index æ¥æŽ§åˆ¶å®ƒä»¬çš„é‡å é¡ºåºã€‚ grid-column / grid-rowåˆ†åˆ«ä¸º grid-column-start + grid-column-end å’Œ grid-row-start + grid-row-end çš„ç¼©å†™å½¢å¼ã€‚ / ï¼šæ¯ä¸ªç½‘æ ¼é¡¹éƒ½æŽ¥å—æ‰€æœ‰ç›¸åŒçš„å€¼ï¼Œä½œä¸ºæ™®é€šä¹¦å†™çš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬è·¨åº¦ .item { grid-column: &lt;start-line&gt; / &lt;end-line&gt; | &lt;start-line&gt; / span &lt;value&gt;; grid-row: &lt;start-line&gt; / &lt;end-line&gt; | &lt;start-line&gt; / span &lt;value&gt;; } ç¤ºä¾‹ï¼š .item-c { grid-column: 3 / span 2; grid-row: third-line / 4; } å¦‚æžœæ²¡æœ‰å£°æ˜Žåˆ†éš”çº¿ç»“æŸä½ç½®ï¼Œåˆ™è¯¥ç½‘æ ¼é¡¹é»˜è®¤å æ® 1 ä¸ªç½‘æ ¼è½¨é“ã€‚ grid-areaä¸ºç½‘æ ¼é¡¹æä¾›ä¸€ä¸ªåç§°ï¼Œä»¥ä¾¿å¯ä»¥ è¢«ä½¿ç”¨ç½‘æ ¼å®¹å™¨ grid-template-areas å±žæ€§åˆ›å»ºçš„æ¨¡æ¿è¿›è¡Œå¼•ç”¨ã€‚ å¦å¤–ï¼Œè¿™ä¸ªå±žæ€§å¯ä»¥ç”¨ä½œgrid-row-start + grid-column-start + grid-row-end + grid-column-end çš„ç¼©å†™ã€‚ ï¼šä½ æ‰€é€‰çš„åç§° / / / ï¼šæ•°å­—æˆ–åˆ†éš”çº¿åç§° .item { grid-area: &lt;name&gt; | &lt;row-start&gt; / &lt;column-start&gt; / &lt;row-end&gt; / &lt;column-end&gt;; } justify-selfæ²¿ç€ è¡Œè½´çº¿(row axis) å¯¹é½ ç½‘æ ¼é¡¹ å†…çš„å†…å®¹ï¼ˆ ç›¸åçš„å±žæ€§æ˜¯ align-self ï¼Œæ²¿ç€åˆ—è½´çº¿(column axis)å¯¹é½ï¼‰ã€‚æ­¤å€¼é€‚ç”¨äºŽå•ä¸ªç½‘æ ¼é¡¹å†…çš„å†…å®¹ã€‚ startï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„å·¦ä¾§endï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„å³ä¾§centerï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„ä¸­é—´ï¼ˆæ°´å¹³å±…ä¸­ï¼‰stretchï¼šå¡«å……æ•´ä¸ªç½‘æ ¼åŒºåŸŸçš„å®½åº¦ï¼ˆè¿™æ˜¯é»˜è®¤å€¼ï¼‰ ç¤ºä¾‹ï¼š .item-a { justify-self: start; } align-selfæ²¿ç€ åˆ—è½´çº¿(column axis) å¯¹é½ ç½‘æ ¼é¡¹ å†…çš„å†…å®¹ï¼ˆ ç›¸åçš„å±žæ€§æ˜¯ justify-self ï¼Œæ²¿ç€ è¡Œè½´çº¿(row axis) å¯¹é½ï¼‰ã€‚æ­¤å€¼é€‚ç”¨äºŽå•ä¸ªç½‘æ ¼é¡¹å†…çš„å†…å®¹ã€‚ startï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„é¡¶éƒ¨endï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„åº•éƒ¨centerï¼šå°†å†…å®¹å¯¹é½åˆ°ç½‘æ ¼åŒºåŸŸçš„ä¸­é—´ï¼ˆåž‚ç›´å±…ä¸­ï¼‰stretchï¼šå¡«å……æ•´ä¸ªç½‘æ ¼åŒºåŸŸçš„é«˜åº¦ï¼ˆè¿™æ˜¯é»˜è®¤å€¼ï¼‰ .item{ align-self: start | end | center | stretch; } è¦ä¸ºç½‘æ ¼ä¸­çš„æ‰€æœ‰ç½‘æ ¼é¡¹è®¾ç½® åˆ—è½´çº¿(column axis) ä¸Šçš„å¯¹é½æ–¹å¼ï¼Œä¹Ÿå¯ä»¥åœ¨ ç½‘æ ¼å®¹å™¨ ä¸Šè®¾ç½® align-items å±žæ€§ã€‚ ç½‘æ ¼çº¿(Grid Line)æž„æˆç½‘æ ¼ç»“æž„çš„åˆ†ç•Œçº¿ã€‚å®ƒä»¬æ—¢å¯ä»¥æ˜¯åž‚ç›´çš„ï¼ˆâ€œåˆ—ç½‘æ ¼çº¿(column grid lines)â€ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯æ°´å¹³çš„ï¼ˆâ€œè¡Œç½‘æ ¼çº¿(row grid lines)â€ï¼‰ï¼Œå¹¶ä½äºŽè¡Œæˆ–åˆ—çš„ä»»ä¸€ä¾§ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œçš„é»„çº¿å°±æ˜¯ä¸€æ¡åˆ—ç½‘æ ¼çº¿ã€‚ ç½‘æ ¼è½¨é“(Grid Track)ä¸¤æ¡ç›¸é‚»ç½‘æ ¼çº¿ä¹‹é—´çš„ç©ºé—´ã€‚ä½ å¯ä»¥æŠŠå®ƒä»¬æƒ³è±¡æˆç½‘æ ¼çš„åˆ—æˆ–è¡Œã€‚ä¸‹å›¾æ˜¯ç¬¬äºŒæ¡å’Œç¬¬ä¸‰æ¡ è¡Œç½‘æ ¼çº¿ ä¹‹é—´çš„ ç½‘æ ¼è½¨é“(Grid Track)ã€‚ ç½‘æ ¼å•å…ƒæ ¼(Grid Cell)ä¸¤ä¸ªç›¸é‚»çš„è¡Œå’Œä¸¤ä¸ªç›¸é‚»çš„åˆ—ç½‘æ ¼çº¿ä¹‹é—´çš„ç©ºé—´ã€‚è¿™æ˜¯ Grid(ç½‘æ ¼) ç³»ç»Ÿçš„ä¸€ä¸ªâ€œå•å…ƒâ€ã€‚ä¸‹å›¾æ˜¯ç¬¬1è‡³ç¬¬2æ¡ è¡Œç½‘æ ¼çº¿ å’Œç¬¬2è‡³ç¬¬3æ¡ åˆ—ç½‘æ ¼çº¿ äº¤æ±‡æž„æˆçš„ ç½‘æ ¼å•å…ƒæ ¼(Grid Cell)ã€‚ ç½‘æ ¼åŒºåŸŸ(Grid Area)4æ¡ç½‘æ ¼çº¿åŒ…å›´çš„æ€»ç©ºé—´ã€‚ä¸€ä¸ª ç½‘æ ¼åŒºåŸŸ(Grid Area) å¯ä»¥ç”±ä»»æ„æ•°é‡çš„ ç½‘æ ¼å•å…ƒæ ¼(Grid Cell) ç»„æˆã€‚ä¸‹å›¾æ˜¯ è¡Œç½‘æ ¼çº¿1å’Œ3ï¼Œä»¥åŠåˆ—ç½‘æ ¼çº¿1å’Œ3 ä¹‹é—´çš„ç½‘æ ¼åŒºåŸŸã€‚ æ›´å¤šå…³äºŽ CSS Grid å¸ƒå±€çš„ä¼˜ç§€æ–‡ç« 5åˆ†é’Ÿå­¦ä¼š CSS Grid å¸ƒå±€CSS Grid å¸ƒå±€å®Œå…¨æŒ‡å—(å›¾è§£ Grid è¯¦ç»†æ•™ç¨‹)å¦‚ä½•ä½¿ç”¨ CSS Grid å¿«é€Ÿè€Œåˆçµæ´»çš„å¸ƒå±€]]></content>
      <categories>
        <category>Css3</category>
      </categories>
      <tags>
        <tag>Css3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çœ‹æ¼«ç”»ï¼Œå­¦ä¹ Redux]]></title>
    <url>%2F2018%2F03%2F05%2FReact%2FRedux%2F%E7%9C%8B%E6%BC%AB%E7%94%BB%EF%BC%8C%E5%AD%A6%E4%B9%A0Redux%2F</url>
    <content type="text"><![CDATA[React åªæ˜¯ DOM çš„ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå¹¶ä¸æ˜¯ Web åº”ç”¨çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå®ƒæ²¡æ¶‰åŠã€‚ ä»£ç ç»“æž„ ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ å¯¹äºŽå¤§åž‹çš„å¤æ‚åº”ç”¨æ¥è¯´ï¼Œè¿™ä¸¤æ–¹é¢æ°æ°æ˜¯æœ€å…³é”®çš„ã€‚å› æ­¤ï¼Œåªç”¨ React æ²¡æ³•å†™å¤§åž‹åº”ç”¨ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ2014å¹´ Facebook æå‡ºäº†Fluxæž¶æž„çš„æ¦‚å¿µï¼Œå¼•å‘äº†å¾ˆå¤šçš„å®žçŽ°ã€‚2015å¹´ï¼ŒRedux å‡ºçŽ°ï¼Œå°† Flux ä¸Žå‡½æ•°å¼ç¼–ç¨‹ç»“åˆä¸€èµ·ï¼Œå¾ˆçŸ­æ—¶é—´å†…å°±æˆä¸ºäº†æœ€çƒ­é—¨çš„å‰ç«¯æž¶æž„ã€‚ Redux çš„è®¾è®¡æ€æƒ³å¾ˆç®€å•ï¼Œå°±ä¸¤å¥è¯ã€‚ ï¼ˆ1ï¼‰Web åº”ç”¨æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œè§†å›¾ä¸ŽçŠ¶æ€æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ ï¼ˆ2ï¼‰æ‰€æœ‰çš„çŠ¶æ€ï¼Œä¿å­˜åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ã€‚ Flux æž¶æž„å·²ç„¶è®©äººè§‰å¾—æœ‰äº›è¿·æƒ‘ï¼Œè€Œæ¯” Flux æ›´è®©äººæ‘¸ä¸ç€å¤´è„‘çš„æ˜¯ Flux ä¸Ž Redux çš„åŒºåˆ«ã€‚Redux æ˜¯ä¸€ä¸ªåŸºäºŽ Flux æ€æƒ³çš„æ–°æž¶æž„æ–¹å¼ï¼Œæœ¬æ–‡å°†æŽ¢è®¨å®ƒä»¬çš„åŒºåˆ«ã€‚ ä¸ºä»€ä¹ˆè¦æ”¹å˜ Fluxï¼ŸRedux è§£å†³çš„é—®é¢˜å’Œ Flux ä¸€æ ·ï¼Œä½† Redux èƒ½åšçš„è¿˜æœ‰æ›´å¤šã€‚å’Œ Flux ä¸€æ ·ï¼ŒRedux è®©åº”ç”¨çš„çŠ¶æ€å˜åŒ–å˜å¾—æ›´åŠ å¯é¢„æµ‹ã€‚å¦‚æžœä½ æƒ³æ”¹å˜åº”ç”¨çš„çŠ¶æ€ï¼Œå°±å¿…é¡» dispatch ä¸€ä¸ª actionã€‚ä½ æ²¡æœ‰åŠžæ³•ç›´æŽ¥æ”¹å˜åº”ç”¨çš„çŠ¶æ€ï¼Œå› ä¸ºä¿å­˜è¿™äº›çŠ¶æ€çš„ä¸œè¥¿ï¼ˆç§°ä¸º storeï¼‰åªæœ‰ getter è€Œæ²¡æœ‰ setterã€‚å¯¹äºŽ Flux å’Œ Redux æ¥è¯´ï¼Œè¿™äº›æ¦‚å¿µéƒ½æ˜¯ç›¸ä¼¼çš„ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆè¦æ–°è®¾è®¡ä¸€ç§æž¶æž„å‘¢ï¼ŸRedux çš„åˆ›é€ è€… Dan Abramov å‘çŽ°äº†æ”¹è¿› Flux æž¶æž„çš„å¯èƒ½ã€‚ä»–æƒ³è¦ä¸€ä¸ªæ›´å¥½çš„å¼€å‘è€…å·¥å…·æ¥è°ƒè¯• Flux åº”ç”¨ã€‚ä»–å‘çŽ°å¦‚æžœç¨å¾®å¯¹ Flux æž¶æž„è¿›è¡Œä¸€äº›è°ƒæ•´ï¼Œå°±å¯ä»¥å¼€å‘å‡ºä¸€æ¬¾æ›´å¥½ç”¨çš„å¼€å‘è€…å·¥å…·ï¼ŒåŒæ—¶ä¾ç„¶èƒ½äº«å— Flux æž¶æž„å¸¦ç»™ä½ çš„å¯é¢„æµ‹æ€§ã€‚ ç¡®åˆ‡çš„è¯´ï¼Œä»–æƒ³è¦çš„å¼€å‘è€…å·¥å…·åŒ…å«äº†ä»£ç çƒ­æ›¿æ¢ï¼ˆhot reloadï¼‰å’Œæ—¶é—´æ—…è¡Œï¼ˆtime travelï¼‰åŠŸèƒ½ã€‚ç„¶è€Œè¦æƒ³åœ¨ Flux æž¶æž„ä¸Šå®žçŽ°è¿™äº›åŠŸèƒ½ï¼Œç¡®å®žæœ‰äº›éº»çƒ¦ã€‚ é—®é¢˜1ï¼šstore çš„ä»£ç æ— æ³•è¢«çƒ­æ›¿æ¢ï¼Œé™¤éžæ¸…ç©ºå½“å‰çš„çŠ¶æ€åœ¨ Flux ä¸­ï¼Œstore åŒ…å«äº†ä¸¤æ ·ä¸œè¥¿ï¼š æ”¹å˜çŠ¶æ€çš„é€»è¾‘ å½“å‰çš„çŠ¶æ€ åœ¨ä¸€ä¸ª store ä¸­åŒæ—¶ä¿å­˜è¿™ä¸¤æ ·ä¸œè¥¿å°†ä¼šå¯¼è‡´ä»£ç çƒ­æ›¿æ¢åŠŸèƒ½å‡ºçŽ°é—®é¢˜ã€‚å½“ä½ çƒ­æ›¿æ¢æŽ‰ store çš„ä»£ç æƒ³è¦çœ‹çœ‹æ–°çš„çŠ¶æ€æ”¹å˜é€»è¾‘æ˜¯å¦ç”Ÿæ•ˆæ—¶ï¼Œä½ å°±ä¸¢å¤±äº† store ä¸­ä¿å­˜çš„å½“å‰çŠ¶æ€ã€‚æ­¤å¤–ï¼Œä½ è¿˜æŠŠ store ä¸Ž Flux æž¶æž„ä¸­å…¶å®ƒç»„ä»¶äº§ç”Ÿå…³ç³»çš„äº‹ä»¶ç³»ç»Ÿæžä¹±äº†ã€‚ è§£å†³æ–¹æ¡ˆ å°†è¿™ä¸¤æ ·ä¸œè¥¿åˆ†å¼€å¤„ç†ã€‚è®©ä¸€ä¸ªå¯¹è±¡æ¥ä¿å­˜çŠ¶æ€ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨çƒ­æ›¿æ¢ä»£ç çš„æ—¶å€™ä¸ä¼šå—åˆ°å½±å“ã€‚è®©å¦ä¸€ä¸ªå¯¹è±¡åŒ…å«æ‰€æœ‰æ”¹å˜çŠ¶æ€çš„é€»è¾‘ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥è¢«çƒ­æ›¿æ¢å› ä¸ºå®ƒä¸ç”¨å…³å¿ƒä»»ä½•ä¿å­˜çŠ¶æ€ç›¸å…³çš„äº‹æƒ…ã€‚ é—®é¢˜2ï¼šæ¯æ¬¡è§¦å‘ action æ—¶çŠ¶æ€å¯¹è±¡éƒ½è¢«ç›´æŽ¥æ”¹å†™äº†æ—¶é—´æ—…è¡Œè°ƒè¯•æ³•çš„ç‰¹æ€§æ˜¯ï¼šä½ èƒ½æŽŒæ¡çŠ¶æ€å¯¹è±¡çš„æ¯ä¸€æ¬¡å˜åŒ–ï¼Œè¿™æ ·çš„è¯ï¼Œä½ å°±èƒ½è½»æ¾çš„è·³å›žåˆ°è¿™ä¸ªå¯¹è±¡ä¹‹å‰çš„æŸä¸ªçŠ¶æ€ï¼ˆæƒ³è±¡ä¸€ä¸ªæ’¤é”€åŠŸèƒ½ï¼‰ã€‚ è¦å®žçŽ°è¿™æ ·çš„åŠŸèƒ½ï¼Œæ¯æ¬¡çŠ¶æ€æ”¹å˜ä¹‹åŽï¼Œä½ éƒ½éœ€è¦æŠŠæ—§çš„çŠ¶æ€ä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ã€‚ä½†æ˜¯ç”±äºŽ JavaScript çš„å¯¹è±¡å¼•ç”¨ç‰¹æ€§ï¼Œç®€å•çš„æŠŠä¸€ä¸ªå¯¹è±¡æ”¾è¿›æ•°ç»„ä¸­å¹¶ä¸èƒ½å®žçŽ°æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½ã€‚è¿™æ ·åšä¸èƒ½åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼ˆsnapshotï¼‰ï¼Œè€Œåªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚ æ‰€ä»¥è¦æƒ³å®žçŽ°æ—¶é—´æ—…è¡Œç‰¹æ€§ï¼Œæ¯ä¸€ä¸ªçŠ¶æ€æ”¹å˜çš„ç‰ˆæœ¬éƒ½éœ€è¦ä¿å­˜åœ¨ä¸åŒçš„ JavaScript å¯¹è±¡ä¸­ï¼Œè¿™æ ·ä½ æ‰ä¸ä¼šä¸å°å¿ƒæ”¹å˜äº†æŸä¸ªåŽ†å²ç‰ˆæœ¬çš„çŠ¶æ€ã€‚ è§£å†³æ–¹æ¡ˆ å½“ä¸€ä¸ª action éœ€è¦ store å“åº”æ—¶ï¼Œä¸è¦ç›´æŽ¥ä¿®æ”¹ store ä¸­çš„çŠ¶æ€ï¼Œè€Œæ˜¯å°†çŠ¶æ€æ‹·è´ä¸€ä»½å¹¶åœ¨è¿™ä»½æ‹·è´çš„çŠ¶æ€ä¸Šåšå‡ºä¿®æ”¹ã€‚ é—®é¢˜3ï¼šæ²¡æœ‰åˆé€‚çš„ä½ç½®å¼•å…¥ç¬¬ä¸‰æ–¹æ’ä»¶å½“ä½ åœ¨å†™ä¸€äº›è°ƒè¯•æ€§å·¥å…·æ—¶ï¼Œä½ å¸Œæœ›å®ƒä»¬èƒ½å¤Ÿæ›´åŠ é€šç”¨ã€‚ä¸€ä¸ªä½¿ç”¨è¯¥å·¥å…·çš„ç”¨æˆ·åº”è¯¥å¯ä»¥ç›´æŽ¥å¼•å…¥è¿™ä¸ªå·¥å…·è€Œä¸éœ€è¦åšé¢å¤–çš„åŒ…è£…æˆ–æ¡¥æŽ¥ã€‚ è¦å®žçŽ°è¿™æ ·çš„ç‰¹æ€§ï¼ŒFlux æž¶æž„éœ€è¦ä¸€ä¸ªæ‰©å±•ç‚¹ã€‚ ä¸€ä¸ªç®€å•çš„ä¾‹å­å°±æ˜¯æ—¥å¿—ã€‚æ¯”å¦‚è¯´ä½ å¸Œæœ› console.log() æ¯ä¸€ä¸ªè§¦å‘çš„ action åŒæ—¶ console.log() è¿™ä¸ª action è¢«å“åº”å®ŒæˆåŽçš„çŠ¶æ€ã€‚åœ¨ Flux ä¸­ï¼Œä½ åªèƒ½è®¢é˜…ï¼ˆsubscribeï¼‰ dispatcher çš„æ›´æ–°å’Œæ¯ä¸€ä¸ª store çš„å˜åŠ¨ã€‚ä½†æ˜¯è¿™æ ·å°±ä¾µå…¥äº†ä¸šåŠ¡ä»£ç ï¼Œè¿™æ ·çš„æ—¥å¿—åŠŸèƒ½ä¸æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ’ä»¶èƒ½å¤Ÿè½»æ˜“å®žçŽ°çš„ã€‚ è§£å†³æ–¹æ¡ˆ å°†è¿™ä¸ªæž¶æž„çš„éƒ¨åˆ†åŠŸèƒ½åŒ…è£…è¿›å…¶ä»–çš„å¯¹è±¡ä¸­å°†ä½¿å¾—æˆ‘ä»¬çš„éœ€æ±‚å˜å¾—æ›´å®¹æ˜“å®žçŽ°ã€‚è¿™äº›ã€Œå…¶ä»–å¯¹è±¡ã€åœ¨æž¶æž„åŽŸæœ‰çš„åŠŸèƒ½åŸºç¡€ä¹‹ä¸Šæ·»åŠ äº†è‡ªå·±çš„åŠŸèƒ½ã€‚ä½ å¯ä»¥æŠŠè¿™ç§æ‰©å±•ç‚¹çœ‹åšæ˜¯ä¸€ä¸ªå¢žå¼ºå™¨ï¼ˆenhancersï¼‰æˆ–è€…é«˜é˜¶å¯¹è±¡ï¼ˆhigher order objectsï¼‰ï¼Œäº¦æˆ–è€…ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰ã€‚ æ­¤å¤–ï¼Œä½¿ç”¨ä¸€ä¸ªæ ‘å½¢ç»“æž„æ¥ç»„ç»‡æ‰€æœ‰æ”¹å˜çŠ¶æ€çš„é€»è¾‘ï¼Œè¿™æ ·å½“çŠ¶æ€å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ store åªä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶æ¥é€šçŸ¥è§†å›¾å±‚ï¼ˆviewï¼‰ï¼Œè€Œè¿™ä¸€ä¸ªäº‹ä»¶ä¼šè¢«æ•´æ£µæ ‘ä¸­çš„æ‰€æœ‰é€»è¾‘å¤„ç†ï¼ˆè¯‘è€…æ³¨ï¼šã€Œå¤„ç†ã€ä¸ä»£è¡¨ä¸€å®šä¼šæ”¹å˜çŠ¶æ€ï¼Œè¿™äº›æ”¹å˜çŠ¶æ€çš„é€»è¾‘æœ¬è´¨ä¸Šæ˜¯å‡½æ•°ï¼Œå‡½æ•°å†…éƒ¨ä¼šæ ¹æ® action çš„ç±»åž‹ç­‰æ¥ç¡®å®šæ˜¯å¦å¯¹çŠ¶æ€è¿›è¡Œæ”¹å˜ï¼‰ã€‚ æ³¨æ„ï¼šå°±ä¸Šè¿°è¿™äº›é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆæ¥è¯´ï¼Œæˆ‘ä¸»è¦åœ¨å…³æ³¨å¼€å‘è€…å·¥å…·è¿™ä¸€ä½¿ç”¨åœºæ™¯ã€‚å®žé™…ä¸Šï¼Œå¯¹ Flux åšå‡ºçš„è¿™äº›æ”¹å˜åœ¨å…¶ä»–åœºæ™¯ä¸­ä¹Ÿéžå¸¸æœ‰å¸®åŠ©ã€‚åœ¨ä¸Šè¿°ä¸‰ç‚¹ä¹‹å¤–ï¼ŒFlux å’Œ Redux è¿˜æœ‰æ›´å¤šçš„ä¸åŒç‚¹ã€‚æ¯”å¦‚ï¼Œç›¸æ¯”äºŽ Fluxï¼ŒRedux ç²¾ç®€äº†æ•´ä¸ªæž¶æž„çš„å†—ä½™ä»£ç ï¼Œå¹¶ä¸”å¤ç”¨ store çš„é€»è¾‘å˜å¾—æ›´åŠ ç®€å•ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª Redux ä¼˜ç‚¹çš„åˆ—è¡¨å¯ä¾›å‚è€ƒã€‚ é‚£ä¹ˆè®©æˆ‘ä»¬æ¥çœ‹çœ‹ Redux æ˜¯æ€Žä¹ˆè®©è¿™äº›ç‰¹æ€§å˜ä¸ºçŽ°å®žçš„ã€‚ æ–°çš„è§’è‰²ä»Ž Flux æ¼”è¿›åˆ° Reduxï¼Œæ•´ä¸ªæž¶æž„ä¸­çš„è§’è‰²å‘ç”Ÿäº†äº›è®¸çš„å˜åŒ–ã€‚ Action creatorsRedux ä¿ç•™äº† Flux ä¸­ action creator çš„æ¦‚å¿µã€‚æ¯å½“ä½ æƒ³è¦æ”¹å˜åº”ç”¨ä¸­çš„çŠ¶æ€æ—¶ï¼Œä½ å°±è¦ dispatch ä¸€ä¸ª actionï¼Œè¿™ä¹Ÿæ˜¯å”¯ä¸€æ”¹å˜çŠ¶æ€çš„æ–¹æ³•ã€‚ å°±åƒæˆ‘åœ¨è¿™ç¯‡å…³äºŽ Flux çš„æ–‡ç« ä¸­æåˆ°çš„ä¸€æ ·ï¼Œæˆ‘æŠŠ action creator çœ‹åšæ˜¯ä¸€ä¸ªæŠ¥åŠ¡å‘˜ï¼ˆè´Ÿè´£å‘ç”µæŠ¥çš„äººï¼Œtelegraph operatorï¼‰ï¼Œä½ æ‰¾åˆ° action creator å‘Šè¯‰ä»–ä½ å¤§è‡´ä¸Šæƒ³è¦ä¼ è¾¾ä»€ä¹ˆä¿¡æ¯ï¼Œaction creator åˆ™ä¼šæŠŠè¿™äº›ä¿¡æ¯æ ¼å¼åŒ–ä¸ºä¸€ç§æ ‡å‡†çš„æ ¼å¼ï¼Œä»¥ä¾¿ç³»ç»Ÿä¸­çš„å…¶ä»–éƒ¨åˆ†èƒ½å¤Ÿç†è§£ã€‚ ä¸Ž Flux ä¸åŒçš„æ˜¯ï¼ŒRedux ä¸­çš„ action creator ä¸ä¼šç›´æŽ¥æŠŠ action å‘é€ç»™ dispatcherï¼Œè€Œæ˜¯è¿”å›žä¸€ä¸ªæ ¼å¼åŒ–å¥½çš„ JavaScript å¯¹è±¡ã€‚ The storeæˆ‘æŠŠ Flux ä¸­çš„ store æè¿°ä¸ºä¸€ç§è¿‡åº¦æŽ§åˆ¶çš„å®˜åƒšæœºåˆ¶ã€‚ä¸èƒ½ç®€å•ç›´æŽ¥çš„ä¿®æ”¹çŠ¶æ€ï¼Œè€Œæ˜¯è¦æ±‚æ‰€æœ‰çš„çŠ¶æ€æ”¹å˜éƒ½å¿…é¡»ç”± store äº²è‡ªäº§ç”Ÿï¼Œè¿˜å¿…é¡»è¦ç»åŽ† action åˆ†å‘é‚£ç§å¥—è·¯ã€‚åœ¨ Redux ä¸­ï¼Œstore ä¾ç„¶æ˜¯è¿™ä¹ˆçš„å……æ»¡æŽ§åˆ¶æ¬²å’Œå®˜åƒšä¸»ä¹‰ï¼Œä½†æ˜¯åˆæœ‰äº›ä¸ä¸€æ ·ã€‚ åœ¨ Flux ä¸­ï¼Œä½ å¯ä»¥æ‹¥æœ‰å¤šä¸ª storeï¼Œæ¯ä¸€ä¸ª store éƒ½æœ‰è‡ªå·±çš„ç»Ÿæ²»æƒã€‚æ¯ä¸ª store éƒ½ä¿å­˜ç€è‡ªå·±å¯¹åº”çš„é‚£éƒ¨åˆ†çŠ¶æ€ï¼Œä»¥åŠæ‰€æœ‰ä¿®æ”¹è¿™äº›çŠ¶æ€çš„é€»è¾‘ã€‚ è€Œ Redux ä¸­çš„ store æ›´å–œæ¬¢å°†æƒåŠ›ä¸‹æ”¾ï¼Œè€Œä¸”ä¸å¾—ä¸è¿™ä¹ˆåšã€‚å› ä¸ºåœ¨ Redux ä¸­ï¼Œä½ åªèƒ½æœ‰ä¸€ä¸ª storeâ€¦â€¦æ‰€ä»¥å¦‚æžœä½ æ‰“ç®—åƒ Flux é‚£æ · store å®Œå…¨ç‹¬ç«‹å¤„ç†è‡ªå·±çš„äº‹æƒ…ï¼Œé‚£ä¹ˆ Redux ä¸­çš„ store å°†å˜å¾—å·¥ä½œé‡å·¨å¤§ã€‚ å› æ­¤ï¼ŒRedux ä¸­çš„ store é¦–å…ˆä¼šä¿å­˜æ•´ä¸ªåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ï¼Œç„¶åŽå°†åˆ¤æ–­å“ªä¸€éƒ¨åˆ†çŠ¶æ€éœ€è¦æ”¹å˜çš„ä»»åŠ¡åˆ†é…ä¸‹åŽ»ã€‚è€Œä»¥æ ¹ reducerï¼ˆroot reducerï¼‰ä¸ºé¦–çš„ reducer ä»¬å°†ä¼šæ‰¿æ‹…è¿™ä¸ªä»»åŠ¡ã€‚ ä½ å¯èƒ½å‘çŽ°è¿™é‡Œå¥½åƒæ²¡æœ‰ dispatcher ä»€ä¹ˆäº‹ï¼Œçœ‹èµ·æ¥æœ‰ç‚¹è¶Šæƒï¼Œä½† store å·²ç»å®Œå…¨æŽ¥ç®¡äº† dispatch ç›¸å…³çš„å·¥ä½œã€‚ The reducerså½“ store éœ€è¦çŸ¥é“ä¸€ä¸ª action è§¦å‘åŽçŠ¶æ€éœ€è¦æ€Žä¹ˆæ”¹å˜æ—¶ï¼Œä»–ä¼šåŽ»è¯¢é—® reducerã€‚æ ¹ reducer ä¼šæ ¹æ®çŠ¶æ€å¯¹è±¡çš„é”®ï¼ˆkeyï¼‰å°†æ•´ä¸ªçŠ¶æ€æ ‘è¿›è¡Œæ‹†åˆ†ï¼Œç„¶åŽå°†æ‹†åˆ†åŽçš„æ¯ä¸€å—å­çŠ¶æ€ä¼ åˆ°çŸ¥é“è¯¥æ€Žä¹ˆå“åº”çš„å­ reducer é‚£é‡Œè¿›è¡Œå¤„ç†ã€‚ æˆ‘æŠŠ reducers çœ‹åšæ˜¯æœ‰ç‚¹æ ¼å¤–çƒ­è¡·å¤å°çš„ç™½é¢†ã€‚ä»–ä»¬ä¸å¸Œæœ›æŠŠä»»ä½•äº‹æžç ¸ï¼Œå› æ­¤ä»–ä»¬ä¸ä¼šä¿®æ”¹ä»»ä½•ä¼ é€’ç»™ä»–ä»¬çš„æ–‡ä»¶ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œä»–ä»¬ä¼šå¯¹è¿™äº›æ–‡ä»¶è¿›è¡Œå¤å°ï¼Œç„¶åŽåœ¨å¤å°ä»¶ä¸Šè¿›è¡Œä¿®æ”¹ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šå½“ç„¶ï¼Œå½“è¿™äº›ä¿®æ”¹åŽçš„å¤å°ä»¶å®šç¨¿åŽï¼Œä»–ä»¬ä¹Ÿä¸ä¼šå†åŽ»ä¿®æ”¹è¿™äº›å¤å°ä»¶ã€‚ï¼‰ è¿™æ˜¯ Redux çš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€ã€‚ä¸ç›´æŽ¥ä¿®æ”¹æ•´ä¸ªåº”ç”¨çš„çŠ¶æ€æ ‘ï¼Œè€Œæ˜¯å°†çŠ¶æ€æ ‘çš„æ¯ä¸€éƒ¨åˆ†è¿›è¡Œæ‹·è´å¹¶ä¿®æ”¹æ‹·è´åŽçš„éƒ¨åˆ†ï¼Œç„¶åŽå°†è¿™äº›éƒ¨åˆ†é‡æ–°ç»„åˆæˆä¸€é¢—æ–°çš„çŠ¶æ€æ ‘ã€‚ å­ reducers ä¼šæŠŠä»–ä»¬åˆ›å»ºçš„å‰¯æœ¬ä¼ å›žç»™æ ¹ reducerï¼Œè€Œæ ¹ reducer ä¼šæŠŠè¿™äº›å‰¯æœ¬ç»„åˆèµ·æ¥å½¢æˆä¸€é¢—æ–°çš„çŠ¶æ€æ ‘ã€‚æœ€åŽæ ¹ reducer å°†æ–°çš„çŠ¶æ€æ ‘ä¼ å›žç»™ storeï¼Œstore å†å°†æ–°çš„çŠ¶æ€æ ‘è®¾ä¸ºæœ€ç»ˆçš„çŠ¶æ€ã€‚ å¦‚æžœä½ æœ‰ä¸€ä¸ªå°åž‹åº”ç”¨ï¼Œä½ å¯èƒ½åªæœ‰ä¸€ä¸ª reducer å¯¹æ•´ä¸ªçŠ¶æ€æ ‘è¿›è¡Œæ‹·è´å¹¶ä½œå‡ºä¿®æ”¹ã€‚åˆæˆ–è€…ä½ æœ‰ä¸€ä¸ªè¶…å¤§çš„åº”ç”¨ï¼Œä½ å¯èƒ½ä¼šæœ‰è‹¥å¹²ä¸ª reducers å¯¹æ•´ä¸ªçŠ¶æ€æ ‘è¿›è¡Œä¿®æ”¹ã€‚è¿™ä¹Ÿæ˜¯ Flux å’Œ Redux çš„å¦ä¸€å¤„åŒºåˆ«ã€‚åœ¨ Flux ä¸­ï¼Œstore å¹¶ä¸éœ€è¦ä¸Žå…¶ä»– store äº§ç”Ÿå…³è”ï¼Œè€Œä¸” store çš„ç»“æž„æ˜¯æ‰å¹³çš„ã€‚è€Œåœ¨ Redux ä¸­ï¼Œreducers æ˜¯æœ‰å±‚çº§ç»“æž„çš„ã€‚è¿™ç§å±‚çº§ç»“æž„å¯ä»¥æœ‰è‹¥å¹²å±‚ï¼Œå°±åƒç»„ä»¶çš„å±‚çº§ç»“æž„é‚£æ ·ã€‚ The views: æ™ºèƒ½ç»„ä»¶ï¼ˆsmart componentsï¼‰å’Œæœ¨å¶ç»„ä»¶(dumb components)Flux æ‹¥æœ‰æŽ§åˆ¶åž‹è§†å›¾ï¼ˆcontroller viewsï¼‰ å’Œå¸¸è§„åž‹è§†å›¾ï¼ˆregular viewsï¼‰ã€‚æŽ§åˆ¶åž‹è§†å›¾å°±åƒæ˜¯ä¸€ä¸ªç»ç†ä¸€æ ·ï¼Œç®¡ç†ç€ store å’Œå­è§†å›¾ï¼ˆchild viewsï¼‰ä¹‹é—´çš„é€šä¿¡ã€‚ åœ¨ Redux ä¸­ï¼Œä¹Ÿæœ‰ä¸€ä¸ªç±»ä¼¼çš„æ¦‚å¿µï¼šæ™ºèƒ½ç»„ä»¶å’Œæœ¨å¶ç»„ä»¶ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šåœ¨æœ€æ–°çš„ Redux æ–‡æ¡£ä¸­ï¼Œå®ƒä»¬åˆ†åˆ«å«åšå®¹å™¨åž‹ç»„ä»¶ Container component å’Œå±•ç¤ºåž‹ç»„ä»¶ Presentational componentï¼‰æ™ºèƒ½ç»„ä»¶çš„èŒè´£å°±åƒç»ç†ä¸€æ ·ï¼Œä½†æ˜¯æ¯”èµ· Flux ä¸­çš„è§’è‰²ï¼ŒRedux å¯¹ç»ç†çš„èŒè´£æœ‰æ›´å¤šçš„å®šä¹‰ï¼š æ™ºèƒ½ç»„ä»¶è´Ÿè´£æ‰€æœ‰çš„ actionã€‚å¦‚æžœæ™ºèƒ½ç»„ä»¶é‡ŒåŒ…å«çš„ä¸€ä¸ªæœ¨å¶ç»„ä»¶éœ€è¦è§¦å‘ä¸€ä¸ª actionï¼Œæ™ºèƒ½ç»„ä»¶ä¼šé€šè¿‡ props ä¼ ç»™ä¸€ä¸ª function ç»™æœ¨å¶ç»„ä»¶ï¼Œè€Œæœ¨å¶ç»„ä»¶å¯ä»¥æŠŠè¿™ä¸ª function å½“åšä¸€ä¸ªå›žè°ƒã€‚æ™ºèƒ½ç»„ä»¶ä¸èƒ½å®šä¹‰ CSS æ ·å¼ã€‚æ™ºèƒ½ç»„ä»¶å‡ ä¹Žä¸ä¼šäº§ç”Ÿè‡ªå·±çš„ DOM èŠ‚ç‚¹ï¼Œä»–çš„å·¥ä½œæ˜¯ç»„ç»‡è‹¥å¹²çš„æœ¨å¶ç»„ä»¶ï¼Œç”±æœ¨å¶ç»„ä»¶æ¥ç”Ÿæˆæœ€ç»ˆçš„ DOM èŠ‚ç‚¹ã€‚æœ¨å¶ç»„ä»¶ä¸ä¼šç›´æŽ¥ä¾èµ– action çš„è§¦å‘ï¼Œå› ä¸ºæ‰€æœ‰çš„ action éƒ½ä¼šå½“åš props ä¼ ä¸‹æ¥ã€‚è¿™æ„å‘³ç€æœ¨å¶ç»„ä»¶å¯ä»¥è¢«ä»»ä½•ä¸€ä¸ªé€»è¾‘ä¸åŒçš„ App æ‹¿åŽ»ä½¿ç”¨ã€‚åŒæ—¶æœ¨å¶ç»„ä»¶ä¹Ÿéœ€è¦æœ‰ä¸€å®šçš„æ ·å¼æ¥è®©è‡ªå·±å˜å¾—å¥½çœ‹ä¸€äº›ï¼ˆå½“ç„¶ä½ å¯ä»¥è®©æœ¨å¶ç»„ä»¶æŽ¥å—æŸäº› props ä½œä¸ºè®¾ç½®æ ·å¼çš„å˜é‡ï¼‰ã€‚ è§†å›¾å±‚ç»‘å®š è¦æŠŠ store ç»‘å®šåˆ°è§†å›¾ä¸Šï¼ŒRedux éœ€è¦ä¸€ç‚¹å¸®åŠ©ã€‚å¦‚æžœä½ åœ¨ä½¿ç”¨ Reactï¼Œé‚£ä¹ˆä½ éœ€è¦ä½¿ç”¨ react-reduxã€‚ è§†å›¾ç»‘å®šå·¥ä½œæœ‰ç‚¹åƒä¸ºç»„ä»¶æ ‘æœåŠ¡çš„ IT éƒ¨é—¨ã€‚IT éƒ¨é—¨ç¡®ä¿æ‰€æœ‰çš„ç»„ä»¶éƒ½æ­£ç¡®çš„ç»‘å®šåˆ° store ä¸Šï¼Œå¹¶å¤„ç†å„ç§æŠ€æœ¯ä¸Šçš„ç»†èŠ‚ï¼Œä»¥ç¡®ä¿ä½™ä¸‹å±‚çº§çš„ç»„ä»¶å¯¹ç»‘å®šç›¸å…³çš„æ“ä½œæ¯«æ— æ„ŸçŸ¥ã€‚ è§†å›¾å±‚ç»‘å®šå¼•å…¥äº†ä¸‰ä¸ªæ¦‚å¿µï¼š ç»„ä»¶ï¼š è¿™ä¸ªç»„ä»¶éœ€è¦åŒ…è£¹åœ¨æ•´ä¸ªç»„ä»¶æ ‘çš„æœ€å¤–å±‚ã€‚è¿™ä¸ªç»„ä»¶è®©æ ¹ç»„ä»¶çš„æ‰€æœ‰å­å­™ç»„ä»¶èƒ½å¤Ÿè½»æ¾çš„ä½¿ç”¨ connect() æ–¹æ³•ç»‘å®š storeã€‚connect()ï¼šè¿™æ˜¯ react-redux æä¾›çš„ä¸€ä¸ªæ–¹æ³•ã€‚å¦‚æžœä¸€ä¸ªç»„ä»¶æƒ³è¦å“åº”çŠ¶æ€çš„å˜åŒ–ï¼Œå°±æŠŠè‡ªå·±ä½œä¸ºå‚æ•°ä¼ ç»™ connect() çš„ç»“æžœï¼ˆè¯‘è€…æ³¨ï¼šconnect() è¿”å›žçš„ä¾ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰ï¼Œconnect() æ–¹æ³•ä¼šå¤„ç†ä¸Ž store ç»‘å®šçš„ç»†èŠ‚ï¼Œå¹¶é€šè¿‡ selector ç¡®å®šè¯¥ç»‘å®š store ä¸­å“ªä¸€éƒ¨åˆ†çš„æ•°æ®ã€‚selectorï¼šè¿™æ˜¯ä½ è‡ªå·±ç¼–å†™çš„ä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å£°æ˜Žäº†ä½ çš„ç»„ä»¶éœ€è¦æ•´ä¸ª store ä¸­çš„å“ªä¸€éƒ¨åˆ†æ•°æ®ä½œä¸ºè‡ªå·±çš„ propsã€‚ æ ¹ç»„ä»¶æ‰€æœ‰çš„ React åº”ç”¨éƒ½å­˜åœ¨ä¸€ä¸ªæ ¹ç»„ä»¶ï¼ˆroot componentï¼‰ã€‚ä»–å…¶å®žå°±æ˜¯æ•´ä¸ªç»„ä»¶æ ‘æœ€å¤–å±‚çš„é‚£ä¸ªç»„ä»¶ï¼Œä½†æ˜¯åœ¨ Redux ä¸­ï¼Œæ ¹ç»„ä»¶è¿˜è¦æ‰¿æ‹…é¢å¤–çš„ä»»åŠ¡ã€‚ æ ¹ç»„ä»¶æ‰¿æ‹…çš„è§’è‰²æœ‰ç‚¹åƒä¼ä¸šä¸­çš„é«˜ç®¡ï¼Œä»–å°†æ•´ä¸ªå›¢é˜Ÿæ•´åˆåˆ°ä¸€èµ·æ¥å®ŒæˆæŸé¡¹ä»»åŠ¡ã€‚ä»–ä¼šåˆ›å»º storeï¼Œå¹¶å‘Šè¯‰ store ä½¿ç”¨å“ªäº› reducersï¼Œå¹¶æœ€ç»ˆå®Œæˆè§†å›¾å±‚çš„ç»‘å®šã€‚ å½“å®Œæˆæ•´ä¸ªåº”ç”¨çš„åˆå§‹åŒ–å·¥ä½œåŽï¼Œæ ¹ç»„ä»¶çš„å°±ä¸å†æ’æ‰‹æ•´ä¸ªåº”ç”¨çš„è¿è¡Œè¿‡ç¨‹äº†ã€‚æ¯ä¸€æ¬¡é‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰éƒ½æ²¡æœ‰æ ¹ç»„ä»¶ä»€ä¹ˆäº‹ï¼Œè¿™äº›æ´»å„¿éƒ½ç”±æ ¹ç»„ä»¶ä¸‹é¢çš„å­ç»„ä»¶å®Œæˆï¼Œå½“ç„¶ä¹Ÿå°‘ä¸äº†è§†å›¾å±‚ç»‘å®šçš„åŠŸåŠ³ã€‚ Redux å®Œæˆçš„è¿è¡Œæµç¨‹è®©æˆ‘ä»¬çœ‹çœ‹ä¸Šè¿°å„ä¸ªéƒ¨åˆ†æ˜¯æ€Žæ ·ç»„åˆæˆä¸€ä¸ªå¯ä»¥è¿è¡Œçš„åº”ç”¨çš„ã€‚ é…ç½®çŽ¯èŠ‚åº”ç”¨ä¸­çš„ä¸åŒéƒ¨åˆ†éœ€è¦åœ¨é…ç½®çŽ¯èŠ‚ä¸­æ•´åˆåˆ°ä¸€èµ·ã€‚ å‡†å¤‡å¥½ store æ ¹ç»„ä»¶ä¼šåˆ›å»º storeï¼Œå¹¶é€šè¿‡ createStore(reducer) æ–¹æ³•å‘Šè¯‰ store è¯¥ä½¿ç”¨å“ªä¸ªæ ¹ reducerã€‚ä¸Žæ­¤åŒæ—¶ï¼Œæ ¹ reducer ä¹Ÿé€šè¿‡ combineReducers() æ–¹æ³•ç»„å»ºäº†ä¸€åªå‘è‡ªå·±æ±‡æŠ¥çš„ reducer å›¢é˜Ÿã€‚ è®¾ç½® store å’Œç»„ä»¶ä¹‹é—´çš„é€šä¿¡ æ ¹ç»„ä»¶å°†å®ƒæ‰€æœ‰çš„å­ç»„ä»¶åŒ…è£¹åœ¨ ç»„ä»¶ä¸­ï¼Œå¹¶å»ºç«‹äº† Provider ä¸Ž store ä¹‹é—´çš„è”ç³»ã€‚ Provider æœ¬è´¨ä¸Šåˆ›å»ºäº†ä¸€ä¸ªç”¨äºŽæ›´æ–°è§†å›¾ç»„ä»¶çš„ç½‘ç»œã€‚é‚£äº›æ™ºèƒ½ç»„ä»¶é€šè¿‡ connect() æ–¹æ³•è¿žå…¥è¿™ä¸ªç½‘ç»œï¼Œä»¥æ­¤ç¡®ä¿ä»–ä»¬èƒ½å¤ŸèŽ·å–åˆ°çŠ¶æ€çš„æ›´æ–°ã€‚ å‡†å¤‡å¥½ action callback ä¸ºäº†è®©æœ¨å¶ç»„ä»¶æ›´å¥½çš„å¤„ç† actionï¼Œæ™ºèƒ½ç»„ä»¶å¯ä»¥ç”¨ bindActionCreators() æ–¹æ³•æ¥åˆ›å»º action callbackã€‚è¿™æ ·åšä¹‹åŽï¼Œæ™ºèƒ½ç»„ä»¶å°±èƒ½ç»™æœ¨å¶ç»„ä»¶ä¼ å…¥ä¸€ä¸ªå›žè°ƒï¼ˆcallbackï¼‰ã€‚å¯¹åº”çš„ action ä¼šåœ¨æœ¨å¶ç»„ä»¶è°ƒç”¨è¿™ä¸ªå›žè°ƒæ—¶è¢«è‡ªåŠ¨ dispatchã€‚ï¼ˆè¯‘è€…æ³¨ï¼šä½¿ç”¨ bindActionCreators() ä½¿å¾—æœ¨å¶ç»„ä»¶æ— éœ€å…³å¿ƒ action çš„ type ç­‰ä¿¡æ¯ï¼Œåªç”¨è°ƒç”¨ props ä¸­çš„æŸä¸ªæ–¹æ³•ä¼ å…¥éœ€è¦çš„å‚æ•°ä½œä¸º action çš„ payload å³å¯ï¼‰ æ•°æ®æµçŽ°åœ¨æˆ‘ä»¬çš„åº”ç”¨å·²ç»é…ç½®å®Œæˆï¼Œç”¨æˆ·å¯ä»¥å¼€å§‹æ“ä½œäº†ã€‚è®©æˆ‘ä»¬è§¦å‘ä¸€ä¸ª actionï¼Œçœ‹çœ‹æ•°æ®æ˜¯æ€Žæ ·æµåŠ¨çš„ã€‚ (1) è§†å›¾å‘å‡ºäº†ä¸€ä¸ª actionï¼Œaction creator å°†è¿™ä¸ª action æ ¼å¼åŒ–å¹¶è¿”å›ž (2) è¿™ä¸ª action è¦ä¹ˆè¢«è‡ªåŠ¨ dispatchï¼ˆå¦‚æžœæˆ‘ä»¬åœ¨é…ç½®é˜¶æ®µä½¿ç”¨äº† bindActionCreators()ï¼‰ï¼Œè¦ä¹ˆç”±è§†å›¾å±‚æ‰‹åŠ¨ dispatchã€‚ (3) store æŽ¥å—åˆ°è¿™ä¸ª action åŽï¼Œå°†å½“å‰çš„çŠ¶æ€æ ‘å’Œè¿™ä¸ª action ä¼ ç»™æ ¹ reducerã€‚ (4) æ ¹ reducer å°†æ•´ä¸ªçŠ¶æ€æ ‘åˆ‡åˆ†æˆä¸€ä¸ªä¸ªå°å—ï¼Œç„¶åŽå°†æŸä¸€ä¸ªå°å—åˆ†å‘ç»™çŸ¥é“æ€Žä¹ˆå¤„ç†è¿™éƒ¨åˆ†å†…å®¹çš„å­ reducerã€‚ (5) å­ reducer å°†ä¼ å…¥çš„ä¸€å°å—çŠ¶æ€æ ‘è¿›è¡Œæ‹·è´ï¼Œç„¶åŽåœ¨å‰¯æœ¬ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œå¹¶æœ€ç»ˆå°†ä¿®æ”¹åŽçš„å‰¯æœ¬è¿”å›žæ ¹ reducerã€‚ (6) å½“æ‰€æœ‰çš„å­ reducer è¿”å›žä»–ä»¬ä¿®æ”¹çš„å‰¯æœ¬ä¹‹åŽï¼Œæ ¹ reducer å°†è¿™äº›éƒ¨åˆ†å†æ¬¡ç»„åˆèµ·æ¥å½¢æˆä¸€é¢—æ–°çš„çŠ¶æ€æ ‘ã€‚ç„¶åŽæ ¹ reducer å°†è¿™ä¸ªæ–°çš„çŠ¶æ€æ ‘äº¤è¿˜ç»™ storeï¼Œstore å†æŠŠè‡ªå·±çš„çŠ¶æ€ç½®ä¸ºè¿™ä¸ªæœ€æ–°çš„çŠ¶æ€æ ‘ã€‚ (7) store å‘Šè¯‰è§†å›¾å±‚ç»‘å®šï¼šã€ŒçŠ¶æ€æ›´æ–°å•¦ã€ (8) è§†å›¾å±‚ç»‘å®šè®© store æŠŠæ›´æ–°çš„çŠ¶æ€ä¼ è¿‡æ¥ (9) è§†å›¾å±‚ç»‘å®šè§¦å‘äº†ä¸€ä¸ªé‡æ–°æ¸²æŸ“çš„æ“ä½œï¼ˆre-renderï¼‰ è¿™å°±æ˜¯æˆ‘æ‰€ç†è§£çš„ Reduxï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚ æ›´å¤šèµ„æºRedux å®˜æ–¹æ–‡æ¡£Redux å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç‰ˆThe Evolution of Flux FrameworksSmart and Dumb ComponentsThe upsides of using ReduxThe downsides of using Reduxå¦‚ä½•è¯„ä»·æ•°æ®æµç®¡ç†æž¶æž„ Redux? åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Redux</category>
      </categories>
      <tags>
        <tag>Redux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react-nativeå­¦ä¹ èµ„æºå¤§æ±‡èš]]></title>
    <url>%2F2018%2F03%2F04%2Freact-native%2Freact-native%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E5%A4%A7%E6%B1%87%E8%81%9A%2F</url>
    <content type="text"><![CDATA[React Native å­¦ä¹ èµ„æº React Nativeç€åŠ›äºŽæé«˜å¤šå¹³å°å¼€å‘çš„å¼€å‘æ•ˆçŽ‡ â€”â€” ä»…éœ€å­¦ä¹ ä¸€æ¬¡ï¼Œç¼–å†™ä»»ä½•å¹³å°ã€‚(Learn once, write anywhere)ã€‚ æœ¬æ–‡æ±‡é›†äº†React-Nativeå„ç±»å­¦ä¹ èµ„æºï¼Œæ–¹ä¾¿å¤§å®¶å­¦ä¹ ï¼ŒåŒæ—¶è¿˜æœ‰ [Awesome React Nativeç³»åˆ—]ï¼Œè¯·æ”¶ä¸‹ï¼( https://github.com/jondot/awesome-react-native)ã€‚ æ•™ç¨‹æž„å»º Facebook F8 2016 App / React Native å¼€å‘æŒ‡å— http://f8-app.liaohuqiu.net/ React-Nativeå…¥é—¨æŒ‡å— https://github.com/vczero/react-native-lesson 30å¤©å­¦ä¹ React Nativeæ•™ç¨‹ https://github.com/fangwei716/30-days-of-react-native React-Nativeè§†é¢‘æ•™ç¨‹(éƒ¨åˆ†å…è´¹) https://egghead.io/technologies/react React Native å¼€å‘åŸ¹è®­è§†é¢‘æ•™ç¨‹ï¼ˆä¸­æ–‡|å…è´¹ï¼‰ https://www.gitbook.com/book/unbug/react-native-training/details react-native å®˜æ–¹apiæ–‡æ¡£ http://facebook.github.io/react-native/docs/getting-started.html react-nativeä¸­æ–‡æ–‡æ¡£(æžå®¢å­¦é™¢) http://wiki.jikexueyuan.com/project/react-native/ react-nativeä¸­æ–‡æ–‡æ¡£(react nativeä¸­æ–‡ç½‘ï¼Œäººå·¥ç¿»è¯‘ï¼Œå®˜ç½‘å®Œå…¨åŒæ­¥) http://react-native.cn/docs/getting-started.html react-nativeç¬¬ä¸€è¯¾ http://html-js.com/article/2783 æ·±å…¥æµ…å‡º React Nativeï¼šä½¿ç”¨ JavaScript æž„å»ºåŽŸç”Ÿåº”ç”¨ http://zhuanlan.zhihu.com/FrontendMagazine/19996445 React Nativeé€šä¿¡æœºåˆ¶è¯¦è§£ http://blog.cnbang.net/tech/2698/ React Nativeå¸ƒå±€ç¯‡ https://segmentfault.com/a/1190000002658374 React Native åŸºç¡€ç»ƒä¹ æŒ‡åŒ—ï¼ˆä¸€ï¼‰ https://segmentfault.com/a/1190000002645929React Native åŸºç¡€ç»ƒä¹ æŒ‡åŒ—ï¼ˆäºŒï¼‰ https://segmentfault.com/a/1190000002647733 Diary of Building an iOS App with React Native http://herman.asia/building-a-flashcard-app-with-react-native React Native For Beginners â€“ The Next Big Thing? https://devdactic.com/react-native-for-beginners/ How To Implement A Tab Bar With React Native https://devdactic.com/react-native-tab-bar/ tcomb-form-nativeä½¿ç”¨è§†é¢‘æ•™ç¨‹(éœ€ç¿»å¢™) https://react.rocks/example/tcomb-form-native React Nativeåˆ†äº«è®°å½• https://segmentfault.com/a/1190000002678782 React Nativeæž„å»ºæœ¬åœ°è§†å›¾ç»„ä»¶ https://www.dobest.me/article/11 react-native-android-lession(å®‰å“ç³»åˆ—æ•™ç¨‹) https://github.com/yipengmu/react-native-android-lession React Nativeæ¨¡å—æ¡¥æŽ¥è¯¦è§£ https://www.dobest.me/article/14 React Native: é…ç½®å’Œèµ·æ­¥ http://www.liaohuqiu.net/cn/posts/react-native-1/ React Native: Android çš„æ‰“åŒ… http://www.liaohuqiu.net/cn/posts/react-native-android-package/ ReactNativeä¹‹åŽŸç”Ÿæ¨¡å—å¼€å‘å¹¶å‘å¸ƒâ€”â€”iOSç¯‡ http://www.liuchungui.com/blog/2016/05/02/reactnativezhi-yuan-sheng-mo-kuai-kai-fa-bing-fa-bu-iospian/ ReactNativeä¹‹åŽŸç”Ÿæ¨¡å—å¼€å‘å¹¶å‘å¸ƒâ€”â€”androidç¯‡ http://www.liuchungui.com/blog/2016/05/08/reactnativezhi-yuan-sheng-mo-kuai-kai-fa-bing-fa-bu-androidpian/ react-nativeçš„ç¬¬ä¸€è¯¾ https://github.com/coderyi/blog/blob/master/articles/2016/0122_react-native_first_lesson.md React-Nativeä¸“é¢˜ç³»åˆ—æ–‡ç«  http://www.lcode.org/react-native/ react native redux FeInn ä»Ž0åˆ°1è®©ä½ å­¦ä¼šæ­å»ºä¸€ä¸ªAPP https://github.com/febobo/react-native-redux-FeInn react.jsreact.jsä¸­æ–‡æ–‡æ¡£ http://reactjs.cn/ react.jså…¥é—¨æ•™ç¨‹(gitbook) https://hulufei.gitbooks.io/react-tutorial/content/introduction.html react.jså¿«é€Ÿå…¥é—¨æ•™ç¨‹ - é˜®ä¸€å³° http://www.ruanyifeng.com/blog/2015/03/react.html react.jsè§†é¢‘æ•™ç¨‹ http://react-china.org/t/reactjs/584 React Nativeä¹‹Reacté€Ÿå­¦æ•™ç¨‹https://github.com/crazycodeboy/RNStudyNotes/tree/master/React%20Native%E4%B9%8BReact%E9%80%9F%E5%AD%A6%E6%95%99%E7%A8%8B ES6æ·±å…¥æµ…å‡ºES6ï¼ˆä¸€ï¼‰ï¼šES6æ˜¯ä»€ä¹ˆ http://www.infoq.com/cn/articles/es6-in-depth-an-introduction æ·±å…¥æµ…å‡ºES6ï¼ˆäºŒï¼‰ï¼šè¿­ä»£å™¨å’Œfor-ofå¾ªçŽ¯ http://www.infoq.com/cn/articles/es6-in-depth-iterators-and-the-for-of-loop æ·±å…¥æµ…å‡ºES6ï¼ˆä¸‰ï¼‰ï¼šç”Ÿæˆå™¨ Generators http://www.infoq.com/cn/articles/es6-in-depth-generators æ·±å…¥æµ…å‡ºES6ï¼ˆå››ï¼‰ï¼šæ¨¡æ¿å­—ç¬¦ä¸² http://www.infoq.com/cn/articles/es6-in-depth-template-string æ·±å…¥æµ…å‡ºES6ï¼ˆäº”ï¼‰ï¼šä¸å®šå‚æ•°å’Œé»˜è®¤å‚æ•° http://www.infoq.com/cn/articles/es6-in-depth-rest-parameters-and-defaults æ·±å…¥æµ…å‡ºES6ï¼ˆå…­ï¼‰ï¼šè§£æž„Destructuring http://www.infoq.com/cn/articles/es6-in-depth-destructuring æ·±å…¥æµ…å‡ºES6ï¼ˆä¸ƒï¼‰ï¼šç®­å¤´å‡½æ•°Arrow Functions http://www.infoq.com/cn/articles/es6-in-depth-arrow-functions æ·±å…¥æµ…å‡ºES6ï¼ˆå…«ï¼‰ï¼šSymbols http://www.infoq.com/cn/articles/es6-in-depth-symbols æ·±å…¥æµ…å‡ºES6ï¼ˆä¹ï¼‰ï¼šå­¦ä¹ Babelå’ŒBroccoliï¼Œé©¬ä¸Šå°±ç”¨ES6 http://www.infoq.com/cn/articles/es6-in-depth-babel-and-broccoli æ·±å…¥æµ…å‡ºES6ï¼ˆåï¼‰ï¼šé›†åˆ http://www.infoq.com/cn/articles/es6-in-depth-collections æ·±å…¥æµ…å‡ºES6ï¼ˆåä¸€ï¼‰ï¼šç”Ÿæˆå™¨Generatorsï¼Œç»­ç¯‡ http://www.infoq.com/cn/articles/es6-in-depth-generators-continued æ·±å…¥æµ…å‡ºES6ï¼ˆåäºŒï¼‰ï¼šä»£ç†Proxies http://www.infoq.com/cn/articles/es6-in-depth-proxies-and-reflect/ æ·±å…¥æµ…å‡ºES6ï¼ˆåä¸‰ï¼‰ï¼šç±»Class http://www.infoq.com/cn/articles/es6-in-depth-classes æ·±å…¥æµ…å‡ºES6ï¼ˆåå››ï¼‰ï¼šletå’Œconst http://www.infoq.com/cn/articles/es6-in-depth-let-and-const æ·±å…¥æµ…å‡ºES6ï¼ˆåäº”ï¼‰ï¼šå­ç±»Subclassing http://www.infoq.com/cn/articles/es6-in-depth-subclassing æ·±å…¥æµ…å‡ºES6ï¼ˆåå…­ï¼‰ï¼šæ¨¡å—Modules http://www.infoq.com/cn/articles/es6-in-depth-modules æ·±å…¥æµ…å‡ºES6ï¼ˆåä¸ƒï¼‰ï¼šå±•æœ›æœªæ¥ http://www.infoq.com/cn/articles/es6-in-depth-the-future ç³»åˆ—æ•™ç¨‹æ·±å…¥æµ…å‡ºReactï¼ˆä¸€ï¼‰ï¼šReactçš„è®¾è®¡å“²å­¦ - ç®€å•ä¹‹ç¾Ž http://www.infoq.com/cn/articles/react-art-of-simplity æ·±å…¥æµ…å‡ºReactï¼ˆäºŒï¼‰ï¼šReactå¼€å‘ç¥žå™¨Webpack http://www.infoq.com/cn/articles/react-and-webpack æ·±å…¥æµ…å‡ºReactï¼ˆä¸‰ï¼‰ï¼šç†è§£JSXå’Œç»„ä»¶ http://www.infoq.com/cn/articles/react-jsx-and-component æ·±å…¥æµ…å‡ºReactï¼ˆå››ï¼‰ï¼šè™šæ‹ŸDOM Diffç®—æ³•è§£æž http://www.infoq.com/cn/articles/react-dom-diff æ·±å…¥æµ…å‡ºReactï¼ˆäº”ï¼‰ï¼šä½¿ç”¨Fluxæ­å»ºReactåº”ç”¨ç¨‹åºæž¶æž„ http://www.infoq.com/cn/articles/react-flux react-webpack-cookbookä¸­æ–‡ç‰ˆ http://fakefish.github.io/react-webpack-cookbook/ Flex å¸ƒå±€è¯­æ³•æ•™ç¨‹ http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html React åˆæŽ¢ http://www.alloyteam.com/2015/04/react-explore/ Reactè™šæ‹ŸDOMæµ…æž http://www.alloyteam.com/2015/10/react-virtual-analysis-of-the-dom/ reactç»„ä»¶é—´é€šä¿¡ http://www.alloyteam.com/2015/07/react-zu-jian-jian-tong-xin/ React æ•°æ®æµç®¡ç†æž¶æž„ä¹‹ Redux ä»‹ç» http://www.alloyteam.com/2015/09/react-redux/ ReactæœåŠ¡å™¨ç«¯æ¸²æŸ“å®žè·µå°ç»“ http://www.alloyteam.com/2015/10/8783/ React Native Android è¸©å‘ä¹‹æ—… http://www.alloyteam.com/2015/10/react-native-android-steps-on-tour/ React Native ä¹‹ JSBridge http://www.alloyteam.com/2015/05/react-native-zhi-jsbridge/ React Native ç ”ç©¶ä¸Žå®žè·µæ•™ç¨‹ https://github.com/crazycodeboy/RNStudyNotes React NativeæŽ¢ç´¢ç³»åˆ—æ•™ç¨‹React NativeæŽ¢ç´¢ï¼ˆä¸€ï¼‰ï¼šèƒŒæ™¯ã€è§„åˆ’å’Œé£Žé™© http://www.infoq.com/cn/articles/react-native-overview React NativeæŽ¢ç´¢ï¼ˆäºŒï¼‰ï¼šå¸ƒå±€ç¯‡ http://www.infoq.com/cn/articles/react-native-layout React NativeæŽ¢ç´¢ï¼ˆä¸‰ï¼‰ï¼šä¸Ž react-web çš„èžåˆ http://www.infoq.com/cn/articles/react-native-web å¼€æºAPPç ”ç©¶æºç ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­¦ä¹ æ–¹å¼ å®˜æ–¹æ¼”ç¤ºApp https://github.com/facebook/react-native/tree/master/Examples Facebook F8 App https://github.com/fbsamples/f8app GitHub Popular(ä¸€ä¸ªç”¨æ¥æŸ¥çœ‹GitHubæœ€å—æ¬¢è¿Žä¸Žæœ€çƒ­é¡¹ç›®çš„App)å·²ä¸Šæž¶https://github.com/crazycodeboy/GitHubPopular å¥‡èˆžå‘¨åˆŠ iOS ç‰ˆï¼ˆä¸Šæž¶åº”ç”¨ï¼‰ https://github.com/fakefish/Weekly75 react-native-dribbble-app https://github.com/catalinmiron/react-native-dribbble-app Gank.ioå®¢æˆ·ç«¯ https://github.com/Bob1993/React-Native-Gank Mdccå®¢æˆ·ç«¯(ä¼˜è´¨) https://github.com/Bob1993/mdcc-client Leanote for iOS(äº‘ç¬”è®°) https://github.com/leanote/leanote-ios-rn ReactNativeRubyChina https://github.com/henter/ReactNativeRubyChina HackerNews-React-Native https://github.com/iSimar/HackerNews-React-Native React-Nativeæ–°é—»å®¢æˆ·ç«¯ https://github.com/tabalt/ReactNativeNews newswatch(æ–°é—»å®¢æˆ·ç«¯) https://github.com/bradoyler/newswatch-react-native buyscreen(è´­ä¹°é¡µé¢) https://github.com/appintheair/react-native-buyscreen V2EXå®¢æˆ·ç«¯ https://github.com/samuel1112/v2er react-native-todo https://github.com/joemaddalone/react-native-todo react-native-beer https://github.com/muratsu/react-native-beer react-native-stars https://github.com/86/react-native-stars æ¨¡ä»¿å¤©çŒ«é¦–é¡µçš„app https://github.com/hugohua/react-native-demo ReactNativeChess https://github.com/csarsam/ReactNativeChess react native ç¼–å†™çš„éŸ³ä¹è½¯ä»¶ https://github.com/Johnqing/miumiu react-native-pokedex https://github.com/ababol/react-native-pokedex CNode-React-Native https://github.com/SFantasy/CNode-React-Native 8tracksç”µå°å®¢æˆ·ç«¯ https://github.com/voronianski/EightTracksReactNative React-Nativeå®žçŽ°çš„è®¡ç®—å™¨ https://github.com/yoxisem544/Calculator-using-React-Native æˆ¿äº§æœç´¢app https://github.com/jawee/react-native-PropertyFinder çŸ¥ä¹Žä¸“æ app https://github.com/LeezQ/react-native-zhihu-app ForeignExchangeApp https://github.com/peralmq/ForeignExchangeApp Segmentfault å®¢æˆ·ç«¯ https://github.com/fakefish/sf-react-native ç³—äº‹ç™¾ç§‘app https://github.com/stormhouse/QiuShiReactNative å­¢å­ç¤¾åŒºapp https://github.com/Hi-Rube/baoz-ReactNative æ·±JS app https://github.com/fraserxu/shenjs Den - æˆ¿å±‹é”€å”®app* https://github.com/asamiller/den Noder-cnodejså®¢æˆ·ç«¯ https://github.com/soliury/noder-react-native çŸ¥ä¹Žæ—¥æŠ¥Androidç‰ˆ https://github.com/race604/ZhiHuDaily-React-Native ziliun-react-native https://github.com/sonnylazuardi/ziliun-react-native react-native-weather-app https://github.com/shevawen/react-native-weather-app React Native Sample App(Navigation,Flux) https://github.com/taskrabbit/ReactNativeSampleApp TesterHomeç¤¾åŒºapp https://github.com/qddegtya/A-ReactNative-TesterHome Finance - è‚¡ç¥¨æŠ¥ä»·app https://github.com/7kfpun/FinanceReactNative shopping - è´­ç‰©app https://github.com/bigsui/shopping-react-native zhuiyuan - è¿½æºcms app https://github.com/kazaff/ZhuiYuanDemo uestc-bbs-react-native - UESTCæ¸…æ°´æ²³ç•”RNå®¢æˆ·ç«¯(with Redux) https://github.com/just4fun/uestc-bbs-react-native react-native-nw-react-calculator(iOS/Androidã€Webã€æ¡Œé¢å¤šç«¯) https://github.com/benoitvallon/react-native-nw-react-calculator react-native-nba-app https://github.com/wwayne/react-native-nba-app å¼€æºä¸­å›½çš„Git@OSCå®¢æˆ·ç«¯ http://git.oschina.net/rplees/react-native-gitosc rn_bycloud å¸®ç€›å¾‹å¸ˆç«¯app https://github.com/liuchungui/rn_bycloud ReactNativeRollingExamples https://github.com/joggerplus/ReactNativeRollingExamples Reading App Write In React-Nativeï¼ˆStudying and Programing https://github.com/attentiveness/reading æ•°ç‹¬ - é‡æ‹¾çº¯ç²¹æ•°ç‹¬çš„ä¹è¶£ https://github.com/nihgwu/react-native-sudoku Shop-React-Native https://github.com/EleTeam/Shop-React-Native æŽ˜é‡‘å®¢æˆ·ç«¯ https://github.com/wangdicoder/JueJinClient cnblogs å®¢æˆ·ç«¯ https://github.com/togayther/react-native-cnblogs å›¾ä¹¦ã€ŠReact Nativeå…¥é—¨ä¸Žå®žæˆ˜ã€‹ http://item.jd.com/11844102.html ã€ŠReact Nativeå¼€å‘æŒ‡å—ã€‹ http://www.ituring.com.cn/book/1846 ã€ŠReact Nativeè·¨å¹³å°ç§»åŠ¨åº”ç”¨å¼€å‘ã€‹ http://item.jd.com/10372998311.html ã€ŠReact Nativeï¼šç”¨JavaScriptå¼€å‘ç§»åŠ¨åº”ç”¨ã€‹ http://item.jd.com/11785195.html ç»„ä»¶React-nativeç»„ä»¶åº“ï¼ˆæ¯”è¾ƒå…¨çš„ç»„ä»¶åº“ï¼‰ https://js.coach/ React Native Modules http://reactnativemodules.com/ æœ€ä½³è½®æ’­ç±»ç»„ä»¶ https://github.com/leecade/react-native-swiper react-native-simple-router https://github.com/react-native-simple-router-community/react-native-simple-router react-native-router-flux https://github.com/aksonov/react-native-router-flux ä¸‹æ‹‰åˆ·æ–°ç»„ä»¶ https://github.com/jsdf/react-native-refreshable-listview æ¨¡æ€æ¡† https://github.com/brentvatne/react-native-modal react-native-navbar https://github.com/react-native-fellowship/react-native-navbar æ»šåŠ¨è½®æ’­ç»„ä»¶ https://github.com/appintheair/react-native-looped-carousel HTMLæ˜¾ç¤ºç»„ä»¶ https://github.com/jsdf/react-native-htmlview Material React Native (MRN) - Material Designç»„ä»¶åº“ https://github.com/binggg/mrn react-native-gitfeed - GitHubå®¢æˆ·ç«¯(iOS/Android) https://github.com/xiekw2010/react-native-gitfeed React-Native-Elements - React Nativeæ ·å¼ç»„ä»¶åº“ https://github.com/react-native-community/React-Native-Elements Shoutem UI - React Nativeæ ·å¼ç»„ä»¶åº“ https://github.com/shoutem/ui å·¥å…·react-native-snippets(ä»£ç æç¤º) https://github.com/Shrugs/react-native-snippets react-native-babel(ä½¿ç”¨ES6+) https://github.com/roman01la/react-native-babel sqlite for react-native https://github.com/almost/react-native-sqlite gulp-react-native-css(å°±åƒå†™cssä¸€æ ·å†™React Style) https://github.com/soliury/gulp-react-native-css rnpm(React Native Package Manager) https://github.com/rnpm/rnpm Pepperoni - React Nativeé¡¹ç›®åˆå§‹åŒ–å¥—ä»¶ https://github.com/futurice/pepperoni-app-kit Deco IDE - React Native IDE https://www.decosoftware.com/ ignite - React Native CLIé¡¹ç›®ç”Ÿæˆå™¨ https://github.com/infinitered/ignite èµ„æºç½‘ç«™React-nativeå®˜ç½‘ http://facebook.github.io/react-native/ React-Chinaç¤¾åŒº http://react-china.org/ React Nativeä¸­æ–‡ç¤¾åŒº http://bbs.react-native.cn/ React-nativeç»„ä»¶åº“ï¼ˆæ¯”è¾ƒå…¨çš„ç»„ä»¶åº“ï¼‰ http://react.parts/ React Native Modules http://reactnativemodules.com/ Use React Native èµ„è®¯ç«™(ä½¿ç”¨æŠ€å·§åŠæ–°é—») http://www.reactnative.com/ 11æ¬¾React Nativeå¼€æºç§»åŠ¨ UI ç»„ä»¶ http://www.oschina.net/news/61214/11-react-native-ui-components ç¨€åœŸæŽ˜é‡‘çš„ React æ ‡ç­¾ http://gold.xitu.io/#/tag/React.js http://gold.xitu.io/#/tag/React%20Native ä¸šç•Œè®¨è®ºè·¨å¹³å°å¼€å‘æ—¶ä»£çš„ (å†æ¬¡) åˆ°æ¥ï¼Ÿï¼ˆ Xamarinï¼ŒNativeScript å’Œ React Native å¯¹æ¯”ï¼‰ http://onevcat.com/2015/03/cross-platform/ è°ˆè°ˆ React Native - å”å·§ http://blog.devtang.com/blog/2015/02/01/talk-about-react-native/ å¦‚ä½•è¯„ä»·React-Native? https://www.zhihu.com/question/27852694/answer/43990708 React Nativeæ¦‚è¿°ï¼šèƒŒæ™¯ã€è§„åˆ’å’Œé£Žé™© http://div.io/topic/938 Nativeä¸ŽWebçš„èžåˆ - Qconä¸­React-Nativeæ¼”è®² http://www.infoq.com/cn/presentations/the-fusion-of-native-and-web ä½¿ç”¨React Nativeä¸€å¹´åŽçš„æ„Ÿå—http://www.dobest.me/blog/2016/06/12/%E4%BD%BF%E7%94%A8React%20Native%E4%B8%80%E5%B9%B4%E5%90%8E%E7%9A%84%E6%84%9F%E5%8F%97/ Weex &amp; ReactNative &amp; JSPatchå¤§å¯¹æ¯” http://awhisper.github.io/2016/07/22/Weex-ReactNative-JSPatch/ weex&amp;ReactNativeå¯¹æ¯” https://zhuanlan.zhihu.com/p/21677103 åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>react-native</category>
      </categories>
      <tags>
        <tag>react-native</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦ä¹ react.jsæ¯”ä½ æƒ³è±¡çš„ç®€å•]]></title>
    <url>%2F2018%2F03%2F03%2FReact%2F%E5%AD%A6%E4%B9%A0react-js%E6%AF%94%E4%BD%A0%E6%83%B3%E8%B1%A1%E7%9A%84%E7%AE%80%E5%8D%95%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ å­¦ä¹  React.js æ¯”ä½ æƒ³è±¡çš„è¦ç®€å• React å…¨éƒ¨éƒ½æ˜¯ç»„ä»¶åŒ–çš„React æ˜¯å›´ç»•å¯é‡ç”¨ç»„ä»¶çš„æ¦‚å¿µè®¾è®¡çš„ã€‚ä½ å®šä¹‰å°ç»„ä»¶å¹¶å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·å½¢æˆæ›´å¤§çš„ç»„ä»¶ã€‚ æ— è®ºå¤§å°ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½æ˜¯å¯é‡ç”¨çš„ï¼Œç”šè‡³åœ¨ä¸åŒçš„é¡¹ç›®ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ React ç»„ä»¶æœ€ç®€å•çš„å½¢å¼ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ JavaScript å‡½æ•°ï¼š123456function Button (props) &#123; // è¿™é‡Œè¿”å›žä¸€ä¸ª DOM å…ƒç´ ï¼Œä¾‹å¦‚ï¼š return &lt;button type="submit"&gt;&#123;props.label&#125;&lt;/button&gt;;&#125;// å°†æŒ‰é’®ç»„ä»¶å‘ˆçŽ°ç»™æµè§ˆå™¨ReactDOM.render(&lt;Button label="Save" /&gt;, mountNode) ä¾‹ 1ï¼šç¼–è¾‘ä¸Šé¢çš„ä»£ç å¹¶æŒ‰ Ctrl+Enter é”®æ‰§è¡Œï¼ˆè¯‘è€…æ³¨ï¼šè¯‘æ–‡æš‚æ—¶æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œè¯·è®¿é—®åŽŸæ–‡ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œä¸‹åŒï¼‰ æ‹¬å·ä¸­çš„ button æ ‡ç­¾å°†ç¨åŽè§£é‡Šã€‚çŽ°åœ¨ä¸è¦æ‹…å¿ƒå®ƒä»¬ã€‚ReactDOM ä¹Ÿå°†ç¨åŽè§£é‡Šï¼Œä½†å¦‚æžœä½ æƒ³æµ‹è¯•è¿™ä¸ªä¾‹å­å’Œæ‰€æœ‰æŽ¥ä¸‹æ¥çš„ä¾‹å­ï¼Œä¸Šè¿° render å‡½æ•°æ˜¯å¿…é¡»çš„ã€‚ï¼ˆReact å°†è¦æŽ¥ç®¡å’ŒæŽ§åˆ¶çš„æ˜¯ ReactDOM.render çš„ç¬¬ 2 ä¸ªå‚æ•°å³ç›®æ ‡ DOM å…ƒç´ ï¼‰ã€‚åœ¨ jsComplete REPL ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„å˜é‡ mountNodeã€‚ ä¾‹ 1 çš„æ³¨æ„äº‹é¡¹ï¼š ç»„ä»¶åç§°é¦–å­—æ¯å¤§å†™ï¼ŒButtonã€‚å¿…é¡»è¦è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ä»¬å°†å¤„ç† HTML å…ƒç´ å’Œ React å…ƒç´ çš„æ··åˆã€‚å°å†™åç§°æ˜¯ä¸º HTML å…ƒç´ ä¿ç•™çš„ã€‚äº‹å®žä¸Šï¼Œå°† React ç»„ä»¶å‘½åä¸º â€œbuttonâ€ ç„¶åŽä½ å°±ä¼šå‘çŽ° ReactDOM ä¼šå¿½ç•¥è¿™ä¸ªå‡½æ•°ï¼Œä»…ä»…æ˜¯å°†å…¶ä½œä¸ºä¸€ä¸ªæ™®é€šçš„ç©º HTML æŒ‰é’®æ¥æ¸²æŸ“ã€‚ æ¯ä¸ªç»„ä»¶éƒ½æŽ¥æ”¶ä¸€ä¸ªå±žæ€§åˆ—è¡¨ï¼Œå°±åƒ HTML å…ƒç´ ä¸€æ ·ã€‚åœ¨ React ä¸­ï¼Œè¿™ä¸ªåˆ—è¡¨è¢«ç§°ä¸ºå±žæ€§ã€‚è™½ç„¶ä½ å¯ä»¥å°†ä¸€ä¸ªå‡½æ•°éšæ„å‘½åã€‚ åœ¨ä¸Šé¢ Button å‡½æ•°ç»„ä»¶çš„è¿”å›žè¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å¥‡æ€ªåœ°å†™äº†æ®µçœ‹ä¸ŠåŽ»åƒ HTML çš„ä»£ç ã€‚è¿™å®žé™…ä¸Šæ—¢ä¸æ˜¯ JavaScript ä¹Ÿä¸æ˜¯ HTMLï¼Œè€å®žè¯´ï¼Œè¿™ç”šè‡³ä¸æ˜¯ React.jsã€‚ç„¶è€Œå®ƒéžå¸¸æµè¡Œï¼Œä»¥è‡³äºŽæˆä¸º React åº”ç”¨ç¨‹åºä¸­çš„é»˜è®¤å€¼ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ JSXï¼Œè¿™æ˜¯ä¸€ä¸ªJavaScript çš„æ‰©å±•ã€‚JSX ä¹Ÿæ˜¯ä¸€ä¸ªæŠ˜ä¸­æ–¹æ¡ˆï¼ç»§ç»­å°è¯•å¹¶åœ¨ä¸Šé¢çš„å‡½æ•°ä¸­è¿”å›žå…¶ä»– HTML å…ƒç´ ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•è¢«æ”¯æŒçš„ï¼ˆä¾‹å¦‚ï¼Œè¿”å›žä¸€ä¸ªæ–‡æœ¬è¾“å…¥å…ƒç´ ï¼‰ã€‚ JSX è¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Ÿä¸Šé¢çš„ä¾‹ 1 å¯ä»¥ç”¨æ²¡æœ‰ JSX çš„çº¯ React.js ç¼–å†™ï¼Œå¦‚ä¸‹ï¼š12345678910111213function Button (props) &#123; return React.createElement( "button", &#123; type: "submit" &#125;, props.label );&#125;// è¦ä½¿ç”¨ Buttonï¼Œä½ å¯ä»¥è¿™ä¹ˆåšReactDOM.render( React.createElement(Button, &#123; label: "Save" &#125;), mountNode); ä¾‹ 2ï¼šä¸ä½¿ç”¨ JSX ç¼–å†™ React ç»„ä»¶ åœ¨ React é¡¶çº§ API ä¸­ï¼ŒcreateElement å‡½æ•°æ˜¯ä¸»å‡½æ•°ã€‚è¿™æ˜¯ä½ éœ€è¦å­¦ä¹ çš„ 7 ä¸ª API ä¸­çš„ 1 ä¸ªã€‚React çš„ API å°±æ˜¯è¿™ä¹ˆå°ã€‚ å°±åƒ DOM è‡ªèº«æœ‰ä¸€ä¸ª document.createElement å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªç”±æ ‡ç­¾åæŒ‡å®šçš„å…ƒç´ ä¸€æ ·ï¼ŒReact çš„ createElement å‡½æ•°æ˜¯ä¸€ä¸ªé«˜çº§å‡½æ•°ï¼Œæœ‰å’Œ document.createElement åŒæ ·çš„åŠŸèƒ½ï¼Œä½†å®ƒä¹Ÿå¯ä»¥ç”¨äºŽåˆ›å»ºä¸€ä¸ªè¡¨ç¤º React ç»„ä»¶çš„å…ƒç´ ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢ä¾‹ 2 ä¸­çš„æŒ‰é’®ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯åŽè€…ã€‚ ä¸åƒ document.createElementï¼ŒReact çš„ createElement åœ¨æŽ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°åŽï¼ŒæŽ¥æ”¶ä¸€ä¸ªåŠ¨æ€å‚æ•°ï¼Œå®ƒè¡¨ç¤ºæ‰€åˆ›å»ºå…ƒç´ çš„å­å…ƒç´ ã€‚æ‰€ä»¥ createElement å®žé™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ ‘ã€‚ è¿™é‡Œå°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªä¾‹å­ï¼š 12345678910111213141516171819const InputForm = React.createElement( "form", &#123; target: "_blank", action: "https://google.com/search" &#125;, React.createElement("div", null, "Enter input and click Search"), React.createElement("input", &#123; className: "big-input" &#125;), React.createElement(Button, &#123; label: "Search" &#125;));// InputForm ä½¿ç”¨ Button ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿™æ ·åšï¼šfunction Button (props) &#123; return React.createElement( "button", &#123; type: "submit" &#125;, props.label );&#125;// ç„¶åŽæˆ‘ä»¬å¯ä»¥é€šè¿‡ .render æ–¹æ³•ç›´æŽ¥ä½¿ç”¨ InputFormReactDOM.render(InputForm, mountNode); ä¾‹ 3ï¼šReact åˆ›å»ºå…ƒç´ çš„ APIä¸Šé¢ä¾‹å­ä¸­çš„ä¸€äº›äº‹æƒ…å€¼å¾—æ³¨æ„ï¼š InputForm ä¸æ˜¯ä¸€ä¸ª React ç»„ä»¶ï¼›å®ƒä»…ä»…æ˜¯ä¸€ä¸ª React å…ƒç´ ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ ReactDOM.render ä¸­ç›´æŽ¥ä½¿ç”¨å®ƒå¹¶ä¸”å¯ä»¥åœ¨è°ƒç”¨æ—¶ä¸ä½¿ç”¨ çš„åŽŸå› ã€‚ React.createElement å‡½æ•°åœ¨å‰ä¸¤ä¸ªå‚æ•°åŽæŽ¥æ”¶äº†å¤šä¸ªå‚æ•°ã€‚ä»Žç¬¬3ä¸ªå‚æ•°å¼€å§‹çš„å‚æ•°åˆ—è¡¨æž„æˆäº†åˆ›å»ºå…ƒç´ çš„å­é¡¹åˆ—è¡¨ã€‚ æˆ‘ä»¬å¯ä»¥åµŒå¥— React.createElement è°ƒç”¨ï¼Œå› ä¸ºå®ƒæ˜¯ JavaScriptã€‚ å½“è¿™ä¸ªå…ƒç´ ä¸éœ€è¦å±žæ€§æ—¶ï¼ŒReact.createElement çš„ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä¸ºç©ºæˆ–è€…æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨ React ç»„ä»¶ä¸­æ··åˆ HTML å…ƒç´ ã€‚ä½ å¯ä»¥å°† HTML å…ƒç´ ä½œä¸ºå†…ç½®çš„ React ç»„ä»¶ã€‚ React çš„ API è¯•å›¾å’Œ DOM API ä¸€æ ·ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨ input å…ƒç´ ä¸­ä½¿ç”¨ className ä»£æ›¿ class çš„åŽŸå› ã€‚æˆ‘ä»¬éƒ½å¸Œæœ›å¦‚æžœ React çš„ API æˆä¸º DOM API æœ¬èº«çš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºï¼Œä½ çŸ¥é“ï¼Œå®ƒè¦å¥½å¾—å¤šã€‚ ä¸Šè¿°çš„ä»£ç æ˜¯å½“ä½ å¼•å…¥ React åº“çš„æ—¶å€™æµè§ˆå™¨æ˜¯æ€Žæ ·ç†è§£çš„ã€‚æµè§ˆå™¨ä¸ä¼šå¤„ç†ä»»ä½• JSX ä¸šåŠ¡ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ›´å–œæ¬¢çœ‹åˆ°å’Œä½¿ç”¨ HTMLï¼Œè€Œä¸æ˜¯é‚£äº› createElement è°ƒç”¨ï¼ˆæƒ³è±¡ä¸€ä¸‹åªä½¿ç”¨ document.createElement æž„å»ºä¸€ä¸ªç½‘ç«™ï¼ï¼‰ã€‚è¿™å°±æ˜¯ JSX å­˜åœ¨çš„åŽŸå› ã€‚å–ä»£ä¸Šè¿°è°ƒç”¨ React.createElement çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªéžå¸¸ç®€å•ç±»ä¼¼äºŽ HTML çš„è¯­æ³•ï¼š 12345678910111213141516const InputForm = &lt;form target="_blank" action="https://google.com/search"&gt; &lt;div&gt;Enter input and click Search&lt;/div&gt; &lt;input className="big-input" name="q" /&gt; &lt;Button label="Search" /&gt; &lt;/form&gt;;// InputForm â€œä»ç„¶â€ä½¿ç”¨ Button ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦è¿™æ ·ã€‚// JXS æˆ–è€…æ™®é€šçš„è¡¨å•éƒ½ä¼šè¿™æ ·åšfunction Button (props) &#123; // è¿™é‡Œè¿”å›žä¸€ä¸ª DOM å…ƒç´ ã€‚ä¾‹å¦‚ï¼š return &lt;button type="submit"&gt;&#123;props.label&#125;&lt;/button&gt;;&#125;// ç„¶åŽæˆ‘ä»¬å¯ä»¥ç›´æŽ¥é€šè¿‡ .render ä½¿ç”¨ InputFormReactDOM.render(InputForm, mountNode); ä¾‹ 4ï¼šä¸ºä»€ä¹ˆåœ¨ React ä¸­ JSX å—æ¬¢è¿Žï¼ˆå’Œä¾‹ 3 ç›¸æ¯”ï¼‰æ³¨æ„ä¸Šé¢çš„å‡ ä»¶äº‹ï¼š è¿™ä¸æ˜¯ HTML ä»£ç ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨ className ä»£æ›¿ classã€‚ æˆ‘ä»¬ä»åœ¨è€ƒè™‘æ€Žæ ·è®©ä¸Šè¿°çš„ JavaScript çœ‹èµ·æ¥åƒæ˜¯ HTMLã€‚çœ‹ä¸€ä¸‹æˆ‘åœ¨æœ€åŽæ˜¯æ€Žæ ·æ·»åŠ çš„ã€‚ æˆ‘ä»¬åœ¨ä¸Šé¢ï¼ˆä¾‹ 4ï¼‰ä¸­å†™çš„å°±æ˜¯ JSXã€‚ç„¶è€Œï¼Œæˆ‘ä»¬è¦å°†ç¼–è¯‘åŽçš„ç‰ˆæœ¬ï¼ˆä¾‹ 3ï¼‰ç»™æµè§ˆå™¨ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªé¢„å¤„ç†å™¨å°† JSX ç‰ˆæœ¬è½¬æ¢ä¸º React.createElement ç‰ˆæœ¬ã€‚è¿™å°±æ˜¯ JSXã€‚è¿™æ˜¯ä¸€ç§æŠ˜ä¸­çš„æ–¹æ¡ˆï¼Œå…è®¸æˆ‘ä»¬ç”¨ç±»ä¼¼ HTML çš„è¯­æ³•æ¥ç¼–å†™æˆ‘ä»¬çš„ React ç»„ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ã€‚ â€œFluxâ€ åœ¨å¤´éƒ¨ä½œä¸ºéŸµè„šæ¥ä½¿ç”¨ï¼Œä½†å®ƒä¹Ÿæ˜¯ä¸€ä¸ªéžå¸¸å—æ¬¢è¿Žçš„ åº”ç”¨æž¶æž„ï¼Œç”± Facebook æŽ¨å¹¿ã€‚æœ€å‡ºåçš„æ˜¯ Reduxï¼ŒFlux å’Œ React éžå¸¸åˆé€‚ã€‚ JSXï¼Œå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¸ä»…ä»…é€‚ç”¨äºŽ Reactã€‚ ä½ å¯ä»¥åœ¨ JavaScript çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ JSXåœ¨ JSX ä¸­ï¼Œä½ å¯ä»¥åœ¨ä¸€å¯¹èŠ±æ‹¬å·å†…ä½¿ç”¨ä»»ä½• JavaScript è¡¨è¾¾å¼ã€‚ 1234567const RandomValue = () =&gt; &lt;div&gt; &#123; Math.floor(Math.random() * 100) &#125; &lt;/div&gt;;// ä½¿ç”¨ï¼šReactDOM.render(&lt;RandomValue /&gt;, mountNode); ä¾‹ 5ï¼šåœ¨ JSX ä¸­ä½¿ç”¨ JavaScript è¡¨è¾¾å¼ ä»»ä½• JavaScript è¡¨è¾¾å¼å¯ä»¥ç›´æŽ¥æ”¾åœ¨èŠ±æ‹¬å·ä¸­ã€‚è¿™ç›¸å½“äºŽåœ¨ JavaScript ä¸­æ’å…¥ ${} æ¨¡æ¿ã€‚ è¿™æ˜¯ JSX å†…å”¯ä¸€çš„çº¦æŸï¼šåªæœ‰è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œä½ ä¸èƒ½ä½¿ç”¨ if è¯­å¥ï¼Œä½†ä¸‰å…ƒè¡¨è¾¾å¼æ˜¯å¯ä»¥çš„ã€‚ JavaScript å˜é‡ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼Œæ‰€ä»¥å½“ç»„ä»¶æŽ¥å—å±žæ€§åˆ—è¡¨æ—¶ï¼ˆä¸åŒ…æ‹¬ RandomValue ç»„ä»¶ï¼Œprops æ˜¯å¯é€‰æ‹©çš„ï¼‰ï¼Œä½ å¯ä»¥åœ¨èŠ±æ‹¬å·é‡Œä½¿ç”¨è¿™äº›å±žæ€§ã€‚æˆ‘ä»¬åœ¨ä¸Šè¿°ï¼ˆä¾‹ 1ï¼‰çš„ Button ç»„ä»¶æ˜¯è¿™æ ·ä½¿ç”¨çš„ã€‚ JavaScript å¯¹è±¡ä¹Ÿæ˜¯è¡¨è¾¾å¼ã€‚æœ‰äº›æ—¶å€™æˆ‘ä»¬åœ¨èŠ±æ‹¬å·ä¸­ä½¿ç”¨ JavaScript å¯¹è±¡ï¼Œè¿™çœ‹èµ·æ¥åƒæ˜¯ä½¿ç”¨äº†ä¸¤ä¸ªèŠ±æ‹¬å·ï¼Œä½†æ˜¯åœ¨èŠ±æ‹¬å·ä¸­ç¡®å®žåªæœ‰ä¸€ä¸ªå¯¹è±¡ã€‚å…¶ä¸­ä¸€ä¸ªç”¨ä¾‹å°±æ˜¯å°† CSS æ ·å¼å¯¹è±¡ä¼ é€’ç»™å“åº”ä¸­çš„ç‰¹æ®Šæ ·å¼å±žæ€§ï¼š 123456789101112const ErrorDisplay = (&#123;message&#125;) =&gt; &lt;div style=&#123; &#123; color: 'red', backgroundColor: 'yellow' &#125; &#125;&gt; &#123;message&#125; &lt;/div&gt;;// ä½¿ç”¨ReactDOM.render( &lt;ErrorDisplay message="These aren't the droids you're looking for" /&gt;, mountNode); ä¾‹ 6ï¼šä¸€ä¸ªå¯¹è±¡ä¼ é€’ç‰¹æ®Šçš„ React æ ·å¼å‚æ•°æ³¨æ„æˆ‘è§£æž„çš„åªæ˜¯åœ¨å±žæ€§å‚æ•°ä¹‹å¤–çš„ä¿¡æ¯ã€‚è¿™åªæ˜¯ JavaScriptã€‚è¿˜è¦æ³¨æ„ä¸Šé¢çš„æ ·å¼å±žæ€§æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å±žæ€§ï¼ˆåŒæ ·ï¼Œå®ƒä¸æ˜¯ HTMLï¼Œå®ƒæ›´æŽ¥è¿‘ DOM APIï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ä½œä¸ºæ ·å¼å±žæ€§çš„å€¼å¹¶ä¸”è¿™ä¸ªå¯¹è±¡å®šä¹‰æ ·å¼å°±åƒæˆ‘ä»¬ä½¿ç”¨ JavaScript ä½ å¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨ React å…ƒç´ ã€‚å› ä¸ºè¿™ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆè®°ä½ï¼Œä¸€ä¸ª React å…ƒç´ åªæ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼‰ï¼š 123456789101112131415161718const MaybeError = (&#123;errorMessage&#125;) =&gt; &lt;div&gt; &#123;errorMessage &amp;&amp; &lt;ErrorDisplay message=&#123;errorMessage&#125; /&gt;&#125; &lt;/div&gt;;// MaybeError ç»„ä»¶ä½¿ç”¨ ErrorDisplay ç»„ä»¶const ErrorDisplay = (&#123;message&#125;) =&gt; &lt;div style=&#123; &#123; color: 'red', backgroundColor: 'yellow' &#125; &#125;&gt; &#123;message&#125; &lt;/div&gt;;// çŽ°åœ¨æˆ‘ä»¬ä½¿ç”¨ MaybeError ç»„ä»¶ï¼šReactDOM.render( &lt;MaybeError errorMessage=&#123;Math.random() &gt; 0.5 ? 'Not good' : ''&#125; /&gt;, mountNode); ä¾‹ 7ï¼šä¸€ä¸ª React å…ƒç´ æ˜¯ä¸€ä¸ªå¯ä»¥é€šè¿‡ {} ä½¿ç”¨çš„è¡¨è¾¾å¼ ä¸Šè¿° MaybeError ç»„ä»¶åªä¼šåœ¨æœ‰ errorMessage ä¼ å…¥æˆ–è€…å¦å¤–æœ‰ä¸€ä¸ªç©ºçš„ div æ‰ä¼šæ˜¾ç¤º ErrorDisplay ç»„ä»¶ã€‚React è®¤ä¸º {true}ã€ {false}{undefined} å’Œ {null} æ˜¯æœ‰æ•ˆå…ƒç´ ï¼Œä¸å‘ˆçŽ°ä»»ä½•å†…å®¹ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨æ‰€æœ‰çš„ JavaScript çš„é›†åˆæ–¹æ³•ï¼ˆmapã€reduce ã€filterã€ concat ç­‰ï¼‰ã€‚å› ä¸ºä»–ä»¬è¿”å›žçš„ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼š 1234567const Doubler = (&#123;value=[1, 2, 3]&#125;) =&gt; &lt;div&gt; &#123;value.map(e =&gt; e * 2)&#125; &lt;/div&gt;;// ä½¿ç”¨ä¸‹é¢å†…å®¹ ReactDOM.render(&lt;Doubler /&gt;, mountNode); ä¾‹ 8ï¼šåœ¨ {} ä¸­ä½¿ç”¨æ•°ç»„ è¯·æ³¨æ„æˆ‘æ˜¯å¦‚ä½•ç»™å‡ºä¸Šè¿° value å±žæ€§çš„é»˜è®¤å€¼çš„ï¼Œå› ä¸ºè¿™å…¨éƒ¨éƒ½åªæ˜¯ JavaScriptã€‚æ³¨æ„æˆ‘åªæ˜¯åœ¨ div ä¸­è¾“å‡ºä¸€ä¸ªæ•°ç»„è¡¨è¾¾å¼ã€‚React æ˜¯å®Œå…¨å¯ä»¥çš„ã€‚å®ƒåªä¼šåœ¨æ–‡æœ¬èŠ‚ç‚¹ä¸­æ”¾ç½®æ¯ä¸€ä¸ªåŠ å€çš„å€¼ã€‚ ä½ å¯ä»¥ä½¿ç”¨ JavaScript ç±»å†™ React ç»„ä»¶ç®€å•çš„å‡½æ•°ç»„ä»¶éžå¸¸é€‚åˆç®€å•çš„éœ€æ±‚ï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦çš„æ›´å¤šã€‚React ä¹Ÿæ”¯æŒé€šè¿‡ä½¿ç”¨ JavaScript ç±»æ¥åˆ›å»ºç»„ä»¶ã€‚è¿™é‡Œ Button ç»„ä»¶ï¼ˆåœ¨ä¾‹ 1 ä¸­ï¼‰å°±æ˜¯ä½¿ç”¨ç±»çš„è¯­æ³•ç¼–å†™çš„ã€‚12345678class Button extends React.Component &#123; render() &#123; return &lt;button&gt;&#123;this.props.label&#125;&lt;/button&gt;; &#125;&#125;// ä½¿ç”¨ï¼ˆç›¸åŒçš„è¯­æ³•ï¼‰ReactDOM.render(&lt;Button label="Save" /&gt;, mountNode); ä¾‹ 9ï¼šä½¿ç”¨ JavaScript ç±»åˆ›å»ºç»„ä»¶ ç±»çš„è¯­æ³•æ˜¯éžå¸¸ç®€å•çš„ï¼šå®šä¹‰ä¸€ä¸ªæ‰©å±•çš„ React.Component ç±»ï¼ˆå¦ä¸€ä¸ªä½ éœ€è¦å­¦ä¹ çš„ React çš„é¡¶çº§ APIï¼‰ã€‚è¯¥ç±»å®šä¹‰äº†ä¸€ä¸ªå•ä¸€çš„å®žä¾‹å‡½æ•° â€”â€” render()ï¼Œå¹¶ä½¿å‡½æ•°è¿”å›žè™šæ‹Ÿ DOM å¯¹è±¡ã€‚æ¯ä¸€æ¬¡æˆ‘ä»¬ä½¿ç”¨åŸºäºŽç±»çš„ Button ç»„ä»¶ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ ï¼‰,React å°†ä»Žè¿™ä¸ªåŸºäºŽç±»çš„ç»„ä»¶ä¸­å®žä¾‹åŒ–å¯¹è±¡ï¼Œå¹¶åœ¨ DOM æ ‘ä¸­ä½¿ç”¨è¯¥å¯¹è±¡ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨ this.props.label æ¸²æŸ“è¾“å‡ºçš„åŽŸå› ï¼Œå› ä¸ºæ¯ä¸€ä¸ªç»„ä»¶éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç§°ä¸º props çš„ å®žä¾‹ å±žæ€§ï¼Œè¿™è®©æ‰€æœ‰çš„å€¼ä¼ é€’ç»™è¯¥ç»„ä»¶æ—¶è¢«å®žä¾‹åŒ–ã€‚ ç”±äºŽæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸Žç»„ä»¶çš„å•ä¸ªä½¿ç”¨ç›¸å…³è”çš„å®žä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è‡ªå·±çš„æ„æ„¿å®šåˆ¶è¯¥å®žä¾‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨å¸¸è§„ JavaScript æž„é€ å‡½æ•°æ¥æž„é€ å®ƒï¼š 123456789101112class Button extends React.Component &#123; constructor(props) &#123; super(props); this.id = Date.now(); &#125; render() &#123; return &lt;button id=&#123;this.id&#125;&gt;&#123;this.props.label&#125;&lt;/button&gt;; &#125;&#125;// ä½¿ç”¨ReactDOM.render(&lt;Button label="Save" /&gt;, mountNode); ä¾‹ 10ï¼šè‡ªå®šä¹‰ç»„ä»¶å®žä¾‹æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ç±»çš„åŽŸåž‹å¹¶ä¸”åœ¨ä»»ä½•æˆ‘ä»¬å¸Œæœ›çš„åœ°æ–¹ä½¿ç”¨ï¼ŒåŒ…æ‹¬åœ¨è¿”å›žçš„ JSX è¾“å‡ºçš„å†…éƒ¨ï¼š 123456789101112131415161718class Button extends React.Component &#123; clickCounter = 0; handleClick = () =&gt; &#123; console.log(`Clicked: $&#123;++this.clickCounter&#125;`); &#125;; render() &#123; return ( &lt;button id=&#123;this.id&#125; onClick=&#123;this.handleClick&#125;&gt; &#123;this.props.label&#125; &lt;/button&gt; ); &#125;&#125;// ä½¿ç”¨ReactDOM.render(&lt;Button label="Save" /&gt;, mountNode); ä¾‹ 11ï¼šä½¿ç”¨ç±»çš„å±žæ€§ï¼ˆé€šè¿‡å•å‡»ä¿å­˜æŒ‰é’®è¿›è¡Œæµ‹è¯•ï¼‰ æ³¨æ„ä¸Šè¿°ä¾‹ 11 ä¸­çš„å‡ ä»¶äº‹æƒ…handleClick å‡½æ•°ä½¿ç”¨ JavaScript æ–°æå‡ºçš„ class-field syntax è¯­æ³•ã€‚è¿™ä»ç„¶æ˜¯ stage-2ï¼Œä½†æ˜¯è¿™æ˜¯è®¿é—®ç»„ä»¶å®‰è£…å®žä¾‹ï¼ˆæ„Ÿè°¢ç®­å¤´å‡½æ•°ï¼‰æœ€å¥½çš„é€‰æ‹©ï¼ˆå› ä¸ºå¾ˆå¤šåŽŸå› ï¼‰ã€‚ç„¶è€Œï¼Œä½ éœ€è¦ä½¿ç”¨ç±»ä¼¼ Babel çš„ç¼–è¯‘å™¨è§£ç ä¸º stage-2ï¼ˆæˆ–è€…ä»…ä»…æ˜¯ç±»å­—æ®µè¯­æ³•ï¼‰æ¥è®©ä¸Šè¿°ä»£ç å·¥ä½œã€‚ jsComplete REPL æœ‰é¢„ç¼–è¯‘åŠŸèƒ½ã€‚ 12345// é”™è¯¯ï¼šonClick=&#123;this.handleClick()&#125;// æ­£ç¡®ï¼šonClick=&#123;this.handleClick&#125; React ä¸­çš„äº‹ä»¶ï¼šä¸¤ä¸ªé‡è¦çš„åŒºåˆ«å½“å¤„ç† React å…ƒç´ ä¸­çš„äº‹ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸Ž DOM API çš„å¤„ç†æ–¹å¼æœ‰ä¸¤ä¸ªéžå¸¸é‡è¦çš„åŒºåˆ«ï¼š æ‰€æœ‰ React å…ƒç´ å±žæ€§ï¼ˆåŒ…æ‹¬äº‹ä»¶ï¼‰éƒ½ä½¿ç”¨ camelCase å‘½åï¼Œè€Œä¸æ˜¯ lowercaseã€‚ä¾‹å¦‚æ˜¯ onClick è€Œä¸æ˜¯ onclickã€‚ æˆ‘ä»¬å°†å®žé™…çš„ JavaScript å‡½æ•°å¼•ç”¨ä¼ é€’ç»™äº‹ä»¶å¤„ç†ç¨‹åºï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚æ˜¯ onClick={handleClick} è€Œä¸æ˜¯ onClick=â€handleClickâ€ã€‚ React ç”¨è‡ªå·±çš„å¯¹è±¡åŒ…è£… DOM å¯¹è±¡äº‹ä»¶ä»¥ä¼˜åŒ–äº‹ä»¶å¤„ç†çš„æ€§èƒ½ï¼Œä½†æ˜¯åœ¨äº‹ä»¶å¤„ç†ç¨‹åºå†…éƒ¨ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥è®¿é—® DOM å¯¹è±¡ä¸Šæ‰€æœ‰å¯ä»¥è®¿é—®çš„æ–¹æ³•ã€‚React å°†ç»è¿‡åŒ…è£…çš„äº‹ä»¶å¯¹è±¡ä¼ é€’ç»™æ¯ä¸ªè°ƒç”¨å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†é˜²æ­¢è¡¨å•æäº¤é»˜è®¤æäº¤æ“ä½œï¼Œä½ å¯ä»¥è¿™æ ·åš1234567891011121314151617class Form extends React.Component &#123; handleSubmit = (event) =&gt; &#123; event.preventDefault(); console.log('Form submitted'); &#125;; render() &#123; return ( &lt;form onSubmit=&#123;this.handleSubmit&#125;&gt; &lt;button type="submit"&gt;Submit&lt;/button&gt; &lt;/form&gt; ); &#125;&#125;// ä½¿ç”¨ReactDOM.render(&lt;Form /&gt;, mountNode); ä¾‹ 12ï¼šä½¿ç”¨åŒ…è£…è¿‡çš„å¯¹è±¡ æ¯ä¸€ä¸ª React ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬ 1 éƒ¨åˆ†ä»¥ä¸‹ä»…é€‚ç”¨äºŽç±»ç»„ä»¶ï¼ˆæ‰©å±• React.Componentï¼‰ã€‚å‡½æ•°ç»„ä»¶æœ‰ä¸€ä¸ªç¨å¾®ä¸åŒçš„æ•…äº‹ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ¨¡æ¿æ¥åˆ›å»ºç»„ä»¶ä¸­çš„å…ƒç´ ã€‚ç„¶åŽï¼Œæˆ‘ä»¬åœ¨æŸå¤„ä½¿ç”¨ Reactã€‚ä¾‹å¦‚ï¼Œåœ¨ render å†…éƒ¨è°ƒç”¨å…¶ä»–çš„ç»„ä»¶ï¼Œæˆ–è€…ç›´æŽ¥ä½¿ç”¨ ReactDOM.renderã€‚ç„¶åŽï¼ŒReact å®žä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ç„¶åŽç»™å®ƒè®¾ç½® props ç„¶åŽæˆ‘ä»¬å¯ä»¥é€šè¿‡ this.props è®¿é—®ã€‚è¿™äº›å±žæ€§éƒ½æ˜¯æˆ‘ä»¬åœ¨ç¬¬ 2 æ­¥ä¼ å…¥çš„ã€‚å› ä¸ºè¿™äº›å…¨éƒ¨éƒ½æ˜¯ JavaScriptï¼Œconstructor æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ï¼ˆå¦‚æžœå®šä¹‰çš„è¯ï¼‰ã€‚è¿™æ˜¯æˆ‘ä»¬ç§°ä¹‹ä¸ºçš„ç¬¬ä¸€ä¸ªï¼šç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚æŽ¥ä¸‹æ¥ React è®¡ç®—æ¸²æŸ“ä¹‹åŽçš„è¾“å‡ºæ–¹æ³•ï¼ˆè™šæ‹Ÿ DOM èŠ‚ç‚¹ï¼‰ã€‚å› ä¸ºè¿™æ˜¯ React ç¬¬ä¸€æ¬¡æ¸²æŸ“å…ƒç´ ï¼ŒReact å°†ä¼šä¸Žæµè§ˆå™¨è¿žé€šï¼ˆä»£è¡¨æˆ‘ä»¬ä½¿ç”¨ DOM APIï¼‰æ¥æ˜¾ç¤ºå…ƒç´ ã€‚è¿™æ•´ä¸ªè¿‡ç¨‹ç§°ä¸º mountingã€‚æŽ¥ä¸‹æ¥ React è°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œç§°ä¸º componentDidMountã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ï¼šåœ¨ DOM ä¸Šåšä¸€äº›æˆ‘ä»¬çŽ°åœ¨çŸ¥é“çš„åœ¨æµè§ˆå™¨ä¸­å­˜åœ¨çš„ä¸œè¥¿ã€‚åœ¨æ­¤ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ DOM éƒ½æ˜¯è™šæ‹Ÿçš„ã€‚ä¸€äº›ç»„ä»¶çš„æ•…äº‹åˆ°æ­¤ç»“æŸï¼Œå…¶ä»–ç»„ä»¶å¾—åˆ°å¸è½½æµè§ˆå™¨ DOM ä¸­çš„å„ç§åŽŸå› ã€‚åœ¨åŽä¸€ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œä¼šè°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼ŒcomponentWillUnmountã€‚ä»»ä½• mounted çš„å…ƒç´ çš„çŠ¶æ€éƒ½å¯èƒ½ä¼šæ”¹å˜ã€‚è¯¥å…ƒç´ çš„çˆ¶çº§å¯èƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œmounted çš„å…ƒç´ éƒ½å¯èƒ½æŽ¥æ”¶åˆ°ä¸åŒçš„å±žæ€§é›†ã€‚React çš„é­”åŠ›å°±æ˜¯è¿™å„¿ï¼Œæˆ‘ä»¬å®žé™…ä¸Šéœ€è¦çš„æ­£æ˜¯ React çš„è¿™ä¸€ç‚¹ï¼åœ¨è¿™ä¸€ç‚¹ä¹‹å‰ï¼Œè¯´å®žè¯ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ Reactã€‚ç»„ä»·çš„æ•…äº‹è¿˜åœ¨ç»§ç»­ï¼Œä½†æ˜¯åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£æˆ‘æ‰€è¯´çš„è¿™ç§çŠ¶æ€ã€‚React ç»„ä»¶å¯ä»¥å…·æœ‰ç§æœ‰çŠ¶æ€ä»¥ä¸‹åªé€‚ç”¨äºŽç±»ç»„ä»¶ã€‚æˆ‘æœ‰æ²¡æœ‰æåˆ°æœ‰äººå«è¡¨è±¡è€Œå·²çš„éƒ¨ä»¶ dumbï¼Ÿ çŠ¶æ€ç±»æ˜¯ä»»ä½• React ç±»ç»„ä»¶ä¸­çš„ä¸€ä¸ªç‰¹æ®Šå­—æ®µã€‚React æ£€æµ‹æ¯ä¸€ä¸ªç»„ä»¶çŠ¶æ€çš„å˜åŒ–ï¼Œä½†æ˜¯ä¸ºäº† React æ›´åŠ æœ‰æ•ˆï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡ React çš„å¦ä¸€ä¸ª API æ”¹å˜çŠ¶æ€å­—æ®µï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦å­¦ä¹ çš„å¦ä¸€ä¸ª API â€”â€” this.setStateï¼š12345678910111213141516171819202122232425262728293031class CounterButton extends React.Component &#123; state = &#123; clickCounter: 0, currentTimestamp: new Date(), &#125;; handleClick = () =&gt; &#123; this.setState((prevState) =&gt; &#123; return &#123; clickCounter: prevState.clickCounter + 1 &#125;; &#125;); &#125;; componentDidMount() &#123; setInterval(() =&gt; &#123; this.setState(&#123; currentTimestamp: new Date() &#125;) &#125;, 1000); &#125; render() &#123; return ( &lt;div&gt; &lt;button onClick=&#123;this.handleClick&#125;&gt;Click&lt;/button&gt; &lt;p&gt;Clicked: &#123;this.state.clickCounter&#125;&lt;/p&gt; &lt;p&gt;Time: &#123;this.state.currentTimestamp.toLocaleString()&#125;&lt;/p&gt; &lt;/div&gt; ); &#125;&#125;// ä½¿ç”¨ReactDOM.render(&lt;CounterButton /&gt;, mountNode); ä¾‹ 13ï¼šsetState çš„ APIè¿™å¯èƒ½æ˜¯æœ€é‡è¦çš„ä¸€ä¸ªä¾‹å­å› ä¸ºè¿™å°†æ˜¯ä½ å®Œå…¨ç†è§£ React åŸºç¡€çŸ¥è¯†çš„æ–¹å¼ã€‚è¿™ä¸ªä¾‹å­ä¹‹åŽï¼Œè¿˜æœ‰ä¸€äº›å°äº‹æƒ…éœ€è¦å­¦ä¹ ï¼Œä½†ä»Žé‚£æ—¶èµ·ä¸»è¦æ˜¯ä½ å’Œä½ çš„ JavaScript æŠ€èƒ½ã€‚ è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¾‹ 13ï¼Œä»Žç±»å¼€å§‹ï¼Œæ€»å…±æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ä¸€ä¸ªåˆå§‹åŒ–çš„æœ‰åˆå§‹å€¼ä¸º 0 çš„ clickCounter å¯¹è±¡å’Œä¸€ä¸ªä»Ž new Date() å¼€å§‹çš„ currentTimestampã€‚ å¦ä¸€ä¸ªç±»æ˜¯ handleClick å‡½æ•°ï¼Œåœ¨æ¸²æŸ“æ–¹æ³•ä¸­æˆ‘ä»¬ç»™æŒ‰é’®å…ƒç´ ä¼ å…¥ onClick äº‹ä»¶ã€‚é€šè¿‡ä½¿ç”¨ setState çš„ handleClick æ–¹æ³•ä¿®æ”¹äº†ç»„ä»¶çš„å®žä¾‹çŠ¶æ€ã€‚è¦æ³¨æ„åˆ°è¿™ä¸€ç‚¹ã€‚ å¦ä¸€ä¸ªæˆ‘ä»¬ä¿®æ”¹çŠ¶æ€çš„åœ°æ–¹æ˜¯åœ¨ä¸€ä¸ªå†…éƒ¨çš„å®šæ—¶å™¨ï¼Œå¼€å§‹åœ¨å†…éƒ¨çš„ componentDidMount ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚å®ƒæ¯ç§’é’Ÿè°ƒç”¨ä¸€æ¬¡å¹¶ä¸”æ‰§è¡Œå¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨ this.setStateã€‚åœ¨æ¸²æŸ“æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å…·æœ‰æ­£å¸¸è¯»è¯­æ³•çš„çŠ¶æ€ä¸Šçš„ä¸¤ä¸ªå±žæ€§ï¼ˆæ²¡æœ‰ä¸“é—¨çš„ APIï¼‰ã€‚çŽ°åœ¨ï¼Œæ³¨æ„æˆ‘ä»¬æ›´æ–°çŠ¶æ€ä½¿ç”¨ä¸¤ç§ä¸åŒçš„æ–¹å¼ï¼š 1.é€šè¿‡ä¼ å…¥ä¸€ä¸ªå‡½æ•°ç„¶åŽè¿”å›žä¸€ä¸ªå¯¹è±¡ã€‚æˆ‘ä»¬åœ¨ handleClick å‡½æ•°å†…éƒ¨è¿™æ ·åšã€‚2.é€šè¿‡ä¼ å…¥ä¸€ä¸ªæ­£åˆ™å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨åœ¨åŒºé—´å›žè°ƒä¸­è¿™æ ·åšã€‚ è¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯å¯ä»¥æŽ¥å—çš„ï¼Œä½†æ˜¯å½“ä½ åŒæ—¶è¯»å†™çŠ¶æ€æ—¶ï¼Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯é¦–é€‰çš„ï¼ˆæˆ‘ä»¬è¿™æ ·åšï¼‰ã€‚åœ¨åŒºé—´å›žè°ƒä¸­ï¼Œæˆ‘ä»¬åªå‘çŠ¶æ€å†™å…¥è€Œä¸è¯»å®ƒã€‚å½“æœ‰é—®é¢˜æ—¶ï¼Œæ€»æ˜¯ä½¿ç”¨ç¬¬ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°è¯­æ³•ã€‚ä¼´éšç€ç«žäº‰æ¡ä»¶è¿™æ›´å®‰å…¨ï¼Œå› ä¸º setstate å®žé™…ä¸Šæ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ã€‚æˆ‘ä»¬åº”è¯¥æ€Žæ ·æ›´æ–°çŠ¶æ€å‘¢ï¼Ÿæˆ‘ä»¬è¿”å›žä¸€ä¸ªæœ‰æˆ‘ä»¬æƒ³è¦æ›´æ–°çš„çš„å€¼çš„å¯¹è±¡ã€‚æ³¨æ„ï¼Œåœ¨è°ƒç”¨ setState æ—¶ï¼Œæˆ‘ä»¬å…¨éƒ¨éƒ½ä»ŽçŠ¶æ€ä¸­ä¼ å…¥ä¸€ä¸ªå±žæ€§æˆ–è€…å…¨éƒ½ä¸ã€‚è¿™å®Œå…¨æ˜¯å¯ä»¥çš„å› ä¸º setState å®žé™…ä¸Š åˆå¹¶ äº†ä½ é€šè¿‡å®ƒï¼ˆè¿”å›žå€¼çš„å‡½æ•°å‚æ•°ï¼‰ä¸ŽçŽ°æœ‰çš„çŠ¶æ€ï¼Œæ‰€ä»¥ï¼Œæ²¡æœ‰æŒ‡å®šä¸€ä¸ªå±žæ€§åœ¨è°ƒç”¨ setState æ—¶æ„å‘³ç€æˆ‘ä»¬ä¸å¸Œæœ›æ”¹å˜å±žæ€§ï¼ˆä½†ä¸åˆ é™¤å®ƒï¼‰ã€‚ React å°†è¦ååº”React çš„åå­—æ˜¯ä»ŽçŠ¶æ€æ”¹å˜çš„ååº”ä¸­å¾—æ¥çš„ï¼ˆè™½ç„¶æ²¡æœ‰ååº”ï¼Œä½†ä¹Ÿæ˜¯åœ¨ä¸€ä¸ªæ—¶é—´è¡¨ä¸­ï¼‰ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç¬‘è¯ï¼ŒReact åº”è¯¥è¢«å‘½åä¸ºScheduleï¼ ç„¶è€Œï¼Œå½“ä»»ä½•ç»„ä»¶çš„çŠ¶æ€è¢«æ›´æ–°æ—¶ï¼Œæˆ‘ä»¬ç”¨è‚‰çœ¼è§‚å¯Ÿåˆ°çš„æ˜¯å¯¹è¯¥æ›´æ–°çš„ååº”ï¼Œå¹¶è‡ªåŠ¨åæ˜ äº†æµè§ˆå™¨ DOM ä¸­çš„æ›´æ–°ï¼ˆå¦‚æžœéœ€è¦çš„è¯ï¼‰ã€‚å°†æ¸²æŸ“å‡½æ•°çš„è¾“å…¥è§†ä¸ºä¸¤ç§ï¼š 1.é€šè¿‡çˆ¶å…ƒç´ ä¼ å…¥çš„å±žæ€§2.ä»¥åŠå¯ä»¥éšæ—¶æ›´æ–°çš„å†…éƒ¨ç§æœ‰çŠ¶æ€ å½“æ¸²æŸ“å‡½æ•°çš„è¾“å…¥æ”¹å˜æ—¶ï¼Œè¾“å‡ºå¯èƒ½ä¹Ÿä¼šæ”¹å˜ã€‚React ä¿å­˜äº†æ¸²æŸ“çš„åŽ†å²è®°å½•ï¼Œå½“å®ƒçœ‹åˆ°ä¸€ä¸ªæ¸²æŸ“ä¸Žå‰ä¸€ä¸ªä¸åŒæ—¶ï¼Œå®ƒå°†è®¡ç®—å®ƒä»¬ä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶å°†å…¶æœ‰æ•ˆåœ°è½¬æ¢ä¸ºåœ¨ DOM ä¸­æ‰§è¡Œçš„å®žé™… DOM æ“ä½œã€‚ React æ˜¯ä½ çš„ä»£ç æ‚¨å¯ä»¥å°† React çœ‹ä½œæ˜¯æˆ‘ä»¬ç”¨æ¥ä¸Žæµè§ˆå™¨é€šä¿¡çš„ä»£ç†ã€‚ä»¥ä¸Šé¢çš„å½“å‰æ—¶é—´æˆ³æ˜¾ç¤ºä¸ºä¾‹ã€‚å–ä»£æ¯ä¸€ç§’æˆ‘ä»¬éƒ½éœ€è¦æ‰‹åŠ¨åŽ»æµè§ˆå™¨è°ƒç”¨ DOM API æ“ä½œæ¥æŸ¥æ‰¾å’Œæ›´æ–° p#timestamp å…ƒç´ ï¼Œæˆ‘ä»¬ä»…ä»…æ”¹å˜ç»„ä»¶çš„çŠ¶æ€å±žæ€§ï¼ŒReact åšçš„å·¥ä½œä»£è¡¨æˆ‘ä»¬ä¸Žæµè§ˆå™¨çš„é€šä¿¡ã€‚æˆ‘ç›¸ä¿¡è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ React è¿™ä¹ˆå—æ¬¢è¿Žçš„çœŸæ­£åŽŸå› ï¼›æˆ‘ä»¬åªæ˜¯ä¸å–œæ¬¢å’Œæµè§ˆå™¨å…ˆç”Ÿè°ˆè¯ï¼ˆä»¥åŠå®ƒæ‰€è¯´çš„ DOM è¯­è¨€çš„å¾ˆå¤šæ–¹è¨€ï¼‰ï¼Œå¹¶ä¸” React è‡ªæ„¿ä¼ é€’ç»™æˆ‘ä»¬ï¼Œå…è´¹çš„ï¼ æ¯ä¸€ä¸ª React ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæ•…äº‹ï¼šç¬¬ 2 éƒ¨åˆ† çŽ°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä¸€ä¸ªç»„ä»¶çš„çŠ¶æ€ï¼Œå½“è¯¥çŠ¶æ€å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹å…³äºŽè¿™ä¸ªè¿‡ç¨‹çš„æœ€åŽå‡ ä¸ªæ¦‚å¿µã€‚ å½“ç»„ä»¶çš„çŠ¶æ€è¢«æ›´æ–°æ—¶ï¼Œæˆ–è€…å®ƒçš„çˆ¶è¿›ç¨‹å†³å®šæ›´æ”¹å®ƒä¼ é€’ç»™ç»„ä»¶çš„å±žæ€§æ—¶ï¼Œç»„ä»¶å¯èƒ½éœ€è¦é‡æ–°æ¸²æŸ“ã€‚ å¦‚æžœåŽè€…å‘ç”Ÿï¼ŒReact ä¼šè°ƒç”¨å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼šcomponentWillReceivePropsã€‚ å¦‚æžœçŠ¶æ€å¯¹è±¡æˆ–ä¼ é€’çš„å±žæ€§æ”¹å˜äº†ï¼ŒReact æœ‰ä¸€ä¸ªé‡è¦çš„å†³å®šè¦åšï¼šç»„ä»¶æ˜¯å¦åº”è¯¥åœ¨ DOM ä¸­æ›´æ–°ï¼Ÿè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒè°ƒç”¨å¦ä¸€ä¸ªé‡è¦çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³• shouldComponentUpdate çš„åŽŸå›  ã€‚æ­¤æ–¹æ³•æ˜¯ä¸€ä¸ªå®žé™…é—®é¢˜ï¼Œå› æ­¤ï¼Œå¦‚æžœéœ€è¦è‡ªè¡Œå®šåˆ¶æˆ–ä¼˜åŒ–æ¸²æŸ“è¿‡ç¨‹ï¼Œåˆ™å¿…é¡»é€šè¿‡è¿”å›ž true æˆ– false æ¥å›žç­”è¿™ä¸ªé—®é¢˜ã€‚ å¦‚æžœæ²¡æœ‰è‡ªå®šä¹‰ shouldComponentUpdateï¼ŒReact çš„é»˜è®¤äº‹ä»¶åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½èƒ½å¤„ç†çš„å¾ˆå¥½ã€‚ é¦–å…ˆï¼Œè¿™ä¸ªæ—¶å€™ä¼šè°ƒç”¨å¦ä¸€ç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼šcomponentWillUpdateã€‚ç„¶åŽï¼ŒReact å°†è®¡ç®—æ–°æ¸²æŸ“è¿‡çš„è¾“å‡ºï¼Œå¹¶å°†å…¶ä¸Žæœ€åŽæ¸²æŸ“çš„è¾“å‡ºè¿›è¡Œå¯¹æ¯”ã€‚ å¦‚æžœæ¸²æŸ“è¿‡çš„è¾“å‡ºå’Œä¹‹å‰çš„ç›¸åŒï¼ŒReact ä¸è¿›è¡Œå¤„ç†ï¼ˆä¸éœ€è¦å’Œæµè§ˆå™¨å…ˆç”Ÿå¯¹è¯ï¼‰ã€‚ å¦‚æžœæœ‰ä¸åŒçš„åœ°æ–¹ï¼ŒReact å°†ä¸åŒä¼ è¾¾ç»™æµè§ˆå™¨ï¼Œåƒæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„é‚£æ ·ã€‚ åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œä¸€æ—¦ä¸€ä¸ªæ›´æ–°ç¨‹åºå‘ç”Ÿäº†ï¼Œæ— è®ºä»¥ä½•ç§æ–¹å¼ï¼ˆå³ä½¿æœ‰ç›¸åŒçš„è¾“å‡ºï¼‰ï¼ŒReact ä¼šè°ƒç”¨æœ€åŽçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼šcomponentDidUpdateã€‚ ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ˜¯é€ƒç”Ÿèˆ±å£ã€‚å¦‚æžœä½ æ²¡æœ‰åšä»€ä¹ˆç‰¹åˆ«çš„äº‹æƒ…ï¼Œä½ å¯ä»¥åœ¨æ²¡æœ‰å®ƒä»¬çš„æƒ…å†µä¸‹åˆ›å»ºå®Œæ•´çš„åº”ç”¨ç¨‹åºã€‚å®ƒä»¬éžå¸¸æ–¹ä¾¿åœ°åˆ†æžåº”ç”¨ç¨‹åºä¸­æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œå¹¶è¿›ä¸€æ­¥ä¼˜åŒ– React æ›´æ–°çš„æ€§èƒ½ã€‚ ä¿¡ä¸ä¿¡ç”±ä½ ï¼Œé€šè¿‡ä¸Šé¢æ‰€å­¦çš„çŸ¥è¯†ï¼ˆæˆ–éƒ¨åˆ†çŸ¥è¯†ï¼‰ï¼Œä½ å¯ä»¥å¼€å§‹åˆ›å»ºä¸€äº›æœ‰è¶£çš„ React åº”ç”¨ç¨‹åºã€‚å¦‚æžœä½ æ¸´æœ›æ›´å¤šï¼Œçœ‹çœ‹æˆ‘çš„ Pluralsight çš„ React.js å…¥é—¨è¯¾ç¨‹ã€‚]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[5åˆ†é’Ÿä¸Šæ‰‹TypeScript]]></title>
    <url>%2F2018%2F03%2F02%2FTs%2F5%E5%88%86%E9%92%9F%E4%B8%8A%E6%89%8BTypeScript%2F</url>
    <content type="text"><![CDATA[è®©æˆ‘ä»¬ä½¿ç”¨TypeScriptæ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„Webåº”ç”¨ã€‚å®‰è£…TypeScriptæœ‰ä¸¤ç§ä¸»è¦çš„æ–¹å¼æ¥èŽ·å–TypeScriptå·¥å…·ï¼š é€šè¿‡npmï¼ˆNode.jsåŒ…ç®¡ç†å™¨ï¼‰ å®‰è£…Visual Studioçš„TypeScriptæ’ä»¶ Visual Studio 2017å’ŒVisual Studio 2015 Update 3é»˜è®¤åŒ…å«äº†TypeScriptã€‚ å¦‚æžœä½ çš„Visual Studioè¿˜æ²¡æœ‰å®‰è£…TypeScriptï¼Œä½ å¯ä»¥ä¸‹è½½å®ƒã€‚ é’ˆå¯¹ä½¿ç”¨npmçš„ç”¨æˆ·ï¼š1npm install -g typescript æž„å»ºä½ çš„ç¬¬ä¸€ä¸ªTypeScriptæ–‡ä»¶åœ¨ç¼–è¾‘å™¨ï¼Œå°†ä¸‹é¢çš„ä»£ç è¾“å…¥åˆ°greeter.tsæ–‡ä»¶é‡Œï¼š 1234567function greeter(person) &#123; return "Hello, " + person;&#125;let user = "Jane User";document.body.innerHTML = greeter(user); ç¼–è¯‘ä»£ç æˆ‘ä»¬ä½¿ç”¨äº†.tsæ‰©å±•åï¼Œä½†æ˜¯è¿™æ®µä»£ç ä»…ä»…æ˜¯JavaScriptè€Œå·²ã€‚ ä½ å¯ä»¥ç›´æŽ¥ä»ŽçŽ°æœ‰çš„JavaScriptåº”ç”¨é‡Œå¤åˆ¶/ç²˜è´´è¿™æ®µä»£ç ã€‚ åœ¨å‘½ä»¤è¡Œä¸Šï¼Œè¿è¡ŒTypeScriptç¼–è¯‘å™¨ï¼š1tsc greeter.ts è¾“å‡ºç»“æžœä¸ºä¸€ä¸ªgreeter.jsæ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†å’Œè¾“å…¥æ–‡ä»¶ä¸­ç›¸åŒçš„JavsScriptä»£ç ã€‚ ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œè¿™ä¸ªä½¿ç”¨TypeScriptå†™çš„JavaScriptåº”ç”¨äº†ï¼æŽ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹TypeScriptå·¥å…·å¸¦æ¥çš„é«˜çº§åŠŸèƒ½ã€‚ ç»™ personå‡½æ•°çš„å‚æ•°æ·»åŠ : stringç±»åž‹æ³¨è§£ï¼Œå¦‚ä¸‹ï¼š 1234567function greeter(person: string) &#123; return "Hello, " + person;&#125;let user = "Jane User";document.body.innerHTML = greeter(user); ç±»åž‹æ³¨è§£TypeScripté‡Œçš„ç±»åž‹æ³¨è§£æ˜¯ä¸€ç§è½»é‡çº§çš„ä¸ºå‡½æ•°æˆ–å˜é‡æ·»åŠ çº¦æŸçš„æ–¹å¼ã€‚ åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å¸Œæœ› greeterå‡½æ•°æŽ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ã€‚ ç„¶åŽå°è¯•æŠŠ greeterçš„è°ƒç”¨æ”¹æˆä¼ å…¥ä¸€ä¸ªæ•°ç»„:1234567function greeter(person: string) &#123; return "Hello, " + person;&#125;let user = [0, 1, 2];document.body.innerHTML = greeter(user); é‡æ–°ç¼–è¯‘ï¼Œä½ ä¼šçœ‹åˆ°äº§ç”Ÿäº†ä¸€ä¸ªé”™è¯¯ã€‚1greeter.ts(7,26): error TS2345: Argument of type 'number[]' is not assignable to parameter of type 'string'. ç±»ä¼¼åœ°ï¼Œå°è¯•åˆ é™¤greeterè°ƒç”¨çš„æ‰€æœ‰å‚æ•°ã€‚ TypeScriptä¼šå‘Šè¯‰ä½ ä½¿ç”¨äº†éžæœŸæœ›ä¸ªæ•°çš„å‚æ•°è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ã€‚ åœ¨è¿™ä¸¤ç§æƒ…å†µä¸­ï¼ŒTypeScriptæä¾›äº†é™æ€çš„ä»£ç åˆ†æžï¼Œå®ƒå¯ä»¥åˆ†æžä»£ç ç»“æž„å’Œæä¾›çš„ç±»åž‹æ³¨è§£ã€‚ è¦æ³¨æ„çš„æ˜¯å°½ç®¡æœ‰é”™è¯¯ï¼Œgreeter.jsæ–‡ä»¶è¿˜æ˜¯è¢«åˆ›å»ºäº†ã€‚ å°±ç®—ä½ çš„ä»£ç é‡Œæœ‰é”™è¯¯ï¼Œä½ ä»ç„¶å¯ä»¥ä½¿ç”¨TypeScriptã€‚ä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTypeScriptä¼šè­¦å‘Šä½ ä»£ç å¯èƒ½ä¸ä¼šæŒ‰é¢„æœŸæ‰§è¡Œ æŽ¥å£è®©æˆ‘ä»¬å¼€å‘è¿™ä¸ªç¤ºä¾‹åº”ç”¨ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æŽ¥å£æ¥æè¿°ä¸€ä¸ªæ‹¥æœ‰firstNameå’ŒlastNameå­—æ®µçš„å¯¹è±¡ã€‚ åœ¨TypeScripté‡Œï¼Œåªåœ¨ä¸¤ä¸ªç±»åž‹å†…éƒ¨çš„ç»“æž„å…¼å®¹é‚£ä¹ˆè¿™ä¸¤ä¸ªç±»åž‹å°±æ˜¯å…¼å®¹çš„ã€‚ è¿™å°±å…è®¸æˆ‘ä»¬åœ¨å®žçŽ°æŽ¥å£æ—¶å€™åªè¦ä¿è¯åŒ…å«äº†æŽ¥å£è¦æ±‚çš„ç»“æž„å°±å¯ä»¥ï¼Œè€Œä¸å¿…æ˜Žç¡®åœ°ä½¿ç”¨ implementsè¯­å¥ã€‚ 123456789101112interface Person &#123; firstName: string; lastName: string;&#125;function greeter(person: Person) &#123; return "Hello, " + person.firstName + " " + person.lastName;&#125;let user = &#123; firstName: "Jane", lastName: "User" &#125;;document.body.innerHTML = greeter(user); ç±»æœ€åŽï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ç±»æ¥æ”¹å†™è¿™ä¸ªä¾‹å­ã€‚ TypeScriptæ”¯æŒJavaScriptçš„æ–°ç‰¹æ€§ï¼Œæ¯”å¦‚æ”¯æŒåŸºäºŽç±»çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚ è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªStudentç±»ï¼Œå®ƒå¸¦æœ‰ä¸€ä¸ªæž„é€ å‡½æ•°å’Œä¸€äº›å…¬å…±å­—æ®µã€‚ æ³¨æ„ç±»å’ŒæŽ¥å£å¯ä»¥ä¸€èµ·å…±ä½œï¼Œç¨‹åºå‘˜å¯ä»¥è‡ªè¡Œå†³å®šæŠ½è±¡çš„çº§åˆ«ã€‚ è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æž„é€ å‡½æ•°çš„å‚æ•°ä¸Šä½¿ç”¨publicç­‰åŒäºŽåˆ›å»ºäº†åŒåçš„æˆå‘˜å˜é‡ã€‚12345678910111213141516171819class Student &#123; fullName: string; constructor(public firstName, public middleInitial, public lastName) &#123; this.fullName = firstName + " " + middleInitial + " " + lastName; &#125;&#125;interface Person &#123; firstName: string; lastName: string;&#125;function greeter(person : Person) &#123; return "Hello, " + person.firstName + " " + person.lastName;&#125;let user = new Student("Jane", "M.", "User");document.body.innerHTML = greeter(user); é‡æ–°è¿è¡Œtsc greeter.tsï¼Œä½ ä¼šçœ‹åˆ°ç”Ÿæˆçš„JavaScriptä»£ç å’ŒåŽŸå…ˆçš„ä¸€æ ·ã€‚ TypeScripté‡Œçš„ç±»åªæ˜¯JavaScripté‡Œå¸¸ç”¨çš„åŸºäºŽåŽŸåž‹é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ç®€å†™ã€‚ è¿è¡ŒTypeScript Webåº”ç”¨åœ¨greeter.htmlé‡Œè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š1234567&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt;&lt;title&gt;TypeScript Greeter&lt;/title&gt;&lt;/head&gt; &lt;body&gt; &lt;script src="greeter.js"&gt;&lt;/script&gt; &lt;/body&gt;&lt;/html&gt; åœ¨æµè§ˆå™¨é‡Œæ‰“å¼€greeter.htmlè¿è¡Œè¿™ä¸ªåº”ç”¨ï¼å¯é€‰åœ°ï¼šåœ¨Visual Studioé‡Œæ‰“å¼€greeter.tsæˆ–è€…æŠŠä»£ç å¤åˆ¶åˆ°TypeScript playgroundã€‚ å°†é¼ æ ‡æ‚¬åœåœ¨æ ‡è¯†ç¬¦ä¸ŠæŸ¥çœ‹å®ƒä»¬çš„ç±»åž‹ã€‚ æ³¨æ„åœ¨æŸäº›æƒ…å†µä¸‹å®ƒä»¬çš„ç±»åž‹å¯ä»¥è¢«è‡ªåŠ¨åœ°æŽ¨æ–­å‡ºæ¥ã€‚ é‡æ–°è¾“å…¥ä¸€ä¸‹æœ€åŽä¸€è¡Œä»£ç ï¼Œçœ‹ä¸€ä¸‹è‡ªåŠ¨è¡¥å…¨åˆ—è¡¨å’Œå‚æ•°åˆ—è¡¨ï¼Œå®ƒä»¬ä¼šæ ¹æ®DOMå…ƒç´ ç±»åž‹è€Œå˜åŒ–ã€‚ å°†å…‰æ ‡æ”¾åœ¨ greeterå‡½æ•°ä¸Šï¼Œç‚¹å‡»F12å¯ä»¥è·Ÿè¸ªåˆ°å®ƒçš„å®šä¹‰ã€‚ è¿˜æœ‰ä¸€ç‚¹ï¼Œä½ å¯ä»¥å³é”®ç‚¹å‡»æ ‡è¯†ï¼Œä½¿ç”¨é‡æž„åŠŸèƒ½æ¥é‡å‘½åã€‚ è¿™äº›ç±»åž‹ä¿¡æ¯ä»¥åŠå·¥å…·å¯ä»¥å¾ˆå¥½çš„å’ŒJavaScriptä¸€èµ·å·¥ä½œã€‚ åŽŸæ–‡åœ°å€]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>TS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react-nativeä½¿ç”¨è¿‡ç¨‹ä¸­çš„æŠ¥é”™ï¼ˆæŒç»­æ›´æ–°ä¸­ï¼‰]]></title>
    <url>%2F2018%2F03%2F01%2Freact-native%2Freact-native%E4%BD%BF%E7%94%A8%E8%BF%87%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%8A%A5%E9%94%99%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ReactNative é‡åˆ°çš„æŠ¥é”™react-native çŸ¢é‡åº“ react-native-vector-iconsçš„æŠ¥é”™è§£å†³è§£å†³æ–¹æ³•ï¼šå°†é¡¹ç›®ç›®å½•ä¸‹ node_modules/react-native/local-cli/core/fixtures/files/package.jsonåˆ é™¤å¦‚æžœè¿˜å‡ºçŽ°è¿™ä¸ªé”™è¯¯ è§£å†³æ–¹æ¡ˆï¼šåˆ é™¤é‡æ–°å®‰è£…react-native-vector-icons å®‰è£…å®ŒæˆåŽæ‰§è¡Œ react-native link ç»§ç»­ä¿®æ”¹é—®é¢˜1çš„é”™è¯¯ unRecognized font family â€˜XXXXXâ€™è§£å†³æ–¹æ¡ˆï¼š react-nativeå¼€å‘è¸©å‘ä¹‹ iosä¸Šreact-native-vector-icons çš„errorï¼šunRecognized font family â€˜FontAwesomeâ€™æŽ¥ä¸‹æ¥è§£é‡Šä¸€ä¸‹ï¼Œé¦–å…ˆçœ‹ç¬¬ä¸€æ­¥ï¼šæŠŠnode_modules/react-native-vector-iconsä¸‹çš„fontsæ–‡ä»¶æ·»åŠ åˆ°å·¥ç¨‹ä¸­ï¼Œè¿™æ—¶å€™å¾€å¾€å¿½ç•¥äº†ä¸€ä¸ªé‡ç‚¹ï¼ŒåŽé¢é‚£ä¸€å¥ 1Make sure your app is checked under â€œAdd to targetsâ€ and that â€œCreate groupsâ€ is checked if you add the whole folder è¿™ä¸€å¥å¾ˆå…³é”®ï¼Œæ„æ€æ˜¯ç¡®è®¤å¿…é¡»è¦ç¡®è®¤æ˜¯Add to targetså’ŒCreate groupsï¼Œä¸€å¼€å§‹æˆ‘æ˜¯ç›´æŽ¥å³é”®æŠŠfontsç›®å½•addåˆ°å·¥ç¨‹çš„ï¼Œæ ¹æœ¬æ²¡çœ‹åˆ°è¿™ä¸¤ä¸ªçŽ©æ„ï¼Œç»“æžœå°±æ˜¯å¤±è´¥ï¼Œæœ‰ç‚¹å¥‡æ€ªï¼ŒåŽæ¥æˆ‘ä»”ç»†çœ‹äº†ä¸€ä¸‹è¿™ä¸ªæ­¥éª¤æè¿°ï¼Œ 1drag the folder Fonts to your project in Xcode ReactNative IosæŠ¥å‡º â€˜React/RCTBundleURLProvider.hâ€™ file not foundé”™è¯¯æˆ‘åœ¨åˆ›å»ºreact-nativeé¡¹ç›®æ—¶ npmäº†ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ ç»“æžœä¸€æ‰“å¼€ xcode ç«Ÿç„¶æŠ¥é”™ React/RCTBundleURLProvider.hâ€™ file not foundï¼› ç„¶åŽ æˆ‘è¯•äº†å„ç§ç½‘ä¸Šçš„æ–¹æ³•è¯•äº†ä¸€éï¼Œ è¿˜æ˜¯ä¸è¡Œ å°±åœ¨æˆ‘è¦æ”¾å¼ƒçš„æ—¶å€™ ï¼Œçªç„¶æƒ³åˆ°æŠŠç½‘ä¸Šçš„æ–¹æ³• ç»“åˆä¸€ä¸‹ è¯•è¯•ï¼Œç»“æžœå¥½äº†ã€‚ ä»¥ä¸‹å°±æ˜¯æˆ‘çš„è§£å†³æ–¹æ³• 1.æ‰“å¼€Macé‡Œé¢çš„ç»ˆç«¯ï¼Œè¿›å…¥é¡¹ç›®æ‰€åœ¨çš„æ–‡ä»¶å¤¹ç›®å½•ï¼›2.æŠŠé¡¹ç›®é‡Œé¢çš„ node_modules æ–‡ä»¶å¤¹åˆ é™¤æŽ‰ï¼Œç„¶åŽæ‰§è¡Œ npm install å‘½ä»¤3.npm installå®‰è£…å®ŒæˆåŽï¼Œ æ‰§è¡Œreact-native upgradeå‘½ä»¤4.npm start5.æ‰“å¼€xcode (å¦‚æžœè¿˜æŠ¥é”™)6.å·¦ä¾§ç‚¹å‡»è·Ÿé¡¹ç›®ç›®å½• -&gt; é€‰æ‹©å³ä¾§ Build Settings -&gt; é€‰æ‹© All &amp; Combined -&gt; æœç´¢æ¡†è¾“å…¥ Always Search User Paths -&gt; å°† Always Search User Paths è®¾ç½®ä¸º Yes -&gt; Clean -&gt; Build RN SectionList é‡åˆ° missing keys for items, make sure to specify a key property on each item çš„ é—®é¢˜è§£å†³å®ƒè­¦å‘Šæˆ‘ä»¬æ¯ä¸ªitem è¦æœ‰ä¸åŒçš„key é»˜è®¤æƒ…å†µä¸‹æ¯è¡Œéƒ½éœ€è¦æä¾›ä¸€ä¸ªä¸é‡å¤çš„keyå±žæ€§ã€‚ä½ ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªkeyExtractorå‡½æ•°æ¥ç”Ÿæˆkeyã€‚æŠŠè¿™ä¸ªå±žæ€§æ·»åŠ åˆ° é‡Œé¢ 1234keyExtractor = &#123;this._extraUniqueKey&#125; _extraUniqueKey(item ,index)&#123; eturn "index"+index+item; &#125; è¿™æ˜¯æ¯ä¸ªitemè¦è®¾ç½®key, åŒæ ·æ¯ä¸ªå­æŽ§ä»¶ä¹Ÿä¸èƒ½æ”¾è¿‡ï¼Œ ä¸€å®šè¦è®¾ç½®å®ƒçš„keyï¼Œ è¦ä¸ç„¶è¿™ä¸ªå±Žé»„è‰²ä¸€ç›´ä¼´ç€ä½  å¤šçƒ¦~~ react-native è¿è¡Œæ—¶ï¼Œå‡ºçŽ°å¦‚ä¸‹æŠ¥é”™ï¼šé¦–å…ˆè¯•è¯•react-native start æˆ– npm start çœ‹çœ‹æ˜¯å¦æŠ¥é”™ï¼Œå¦‚æžœæŠ¥é”™å‡ºçŽ°ERROR:Metro Bundler canâ€™t listen on port 8081 åˆ™æ˜¯8081ç«¯å£å·è¢«å ç”¨ è§£å†³æ–¹æ¡ˆï¼šæ‰§è¡Œsudo lsof -i :8081 kill -9 è¿›ç¨‹å· æ›´å¤šReactNativeé—®é¢˜æ€»ç»“é›†åˆï¼Œè¯·ç§»æ­¥å¤§ä½¬é“¾æŽ¥react-native é—®é¢˜]]></content>
      <categories>
        <category>react-native</category>
      </categories>
      <tags>
        <tag>react-native</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[reactå¼€å‘çŽ¯å¢ƒæ­å»º]]></title>
    <url>%2F2018%2F02%2F28%2FReact%2Freact%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨creat-react-appæ­å»ºåŸºäºŽwebpackçš„reactå¼€å‘çŽ¯å¢ƒ facebookå®˜æ–¹æ–‡æ¡£Quick Start: 1234567891011npm install -g create-react-app //å®‰è£…create-react-appï¼Œyarnå‘½ä»¤(éœ€è¦å®‰è£…yarn) yarn add create-react-appcreate-react-app myapp //ä½¿ç”¨å‘½ä»¤åˆ›å»ºreactåº”ç”¨ myappä¸ºæ–‡ä»¶åç§°cd myapp //è¿›å…¥æ–‡ä»¶ç›®å½•npm start //yarn start å¯åŠ¨åº”ç”¨npm test or yarn test //æµ‹è¯•npm run build or yarn build //æ‰“åŒ…ç¼–è¯‘ ä¸Šè¿°å‘½ä»¤å³å¯å¿«é€Ÿåˆ›å»ºreactå¼€å‘çŽ¯å¢ƒ æ‰“å¼€http://localhost:3000/ æŸ¥çœ‹ çŽ¯å¢ƒé…ç½®ä»‹ç»ï¼šé¡¹ç›®ç»“æž„ï¼šç”Ÿæˆé¡¹ç›®åŽï¼Œè„šæ‰‹æž¶ä¸ºäº†â€œä¼˜é›…â€â€¦ â€¦éšè—äº†æ‰€æœ‰çš„webpackç›¸å…³çš„é…ç½®æ–‡ä»¶ï¼Œæ­¤æ—¶æŸ¥çœ‹myappæ–‡ä»¶å¤¹ç›®å½•ï¼Œä¼šå‘çŽ°æ‰¾ä¸åˆ°ä»»ä½•webpacké…ç½®æ–‡ä»¶ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š1npm run eject å†æŸ¥çœ‹myapp æ–‡ä»¶å¤¹ï¼Œå¯ä»¥çœ‹åˆ°å®Œæ•´çš„é¡¹ç›®ç»“æž„ï¼š12345678910111213141516171819myapp/ node_modules/ package.json .gitignore config/ paths.js polyfills env.js webpack.config.dev.js webpack.config.prod.js public/ index.html / å…¥å£htmlæ–‡ä»¶ / scripts **build.js** **start.js** test.js src/ App.js index.js / ä¸»å…¥å£æ–‡ä»¶ / åŠ ç²—æ–‡ä»¶ä¸ºä¸»è¦é…ç½®æ–‡ä»¶ã€‚ äºŒã€é¡¹ç›®é…ç½®ä»‹ç»æ­¤å¤„éœ€è¦æœ‰npmã€webpackçš„åŸºç¡€çŸ¥è¯†ï¼Œå……ç”µä¼ é€é—¨ï¼šwebpackå­¦ä¹ æ•™ç¨‹ æŸ¥çœ‹package.jsonæ–‡ä»¶çš„scriptsï¼Œ123456789"scripts": &#123; "start": "node scripts/start.js", "build": "node scripts/build.js", "test": "node scripts/test.js --env=jsdom"&#125;, å¯çŸ¥ï¼Œè¿è¡Œæ—¶æ˜¯ç›´æŽ¥æ‰§è¡Œscriptsæ–‡ä»¶ç›®å½•ä¸‹çš„jsæ–‡ä»¶ã€‚å…¶ä¸­start.jsä¸ºå¼€å‘çŽ¯å¢ƒï¼Œbuild.jsä¸ºæ‰“åŒ…è„šæœ¬ã€‚ å¼€å‘çŽ¯å¢ƒï¼Œä»£ç†è¯·æ±‚æŸ¥çœ‹start.js, FacebookåŸºæœ¬ä¸ºæ¯é¡¹é…ç½®éƒ½å†™äº†è¯¦å°½çš„æ³¨é‡Šï¼Œstart.jsè„šæœ¬å¯åŠ¨äº†dev-server, è¿™é‡Œéœ€è¦äº†è§£çš„æ˜¯ 12345function addMiddleware(devServer)&#123; ... ... è¿™ä¸ªå‡½æ•°è°ƒç”¨http-proxy-middlewareæ¨¡å—ï¼Œå°†ä»£ç†è¯·æ±‚ï¼Œä»£ç†åœ°å€åœ¨package.jsonä¸­æ·»åŠ &#125; åœ¨package.jsonä¸­æ·»åŠ å­—æ®µproxyï¼Œå¼€å‘çŽ¯å¢ƒä¸‹dev-serverå°†ä¼šè‡ªåŠ¨è½¬å‘è¯·æ±‚ï¼š1"proxy": "http://aaa.bbb.com" SASSã€LESSç­‰CSSé¢„å¤„ç†å™¨é…ç½®Facebookå®˜æ–¹åœ¨create-react-appå‡çº§åˆ°æŸä¸€ç‰ˆæœ¬ï¼Œçªç„¶ä¸¢æŽ‰äº†é»˜è®¤å¯¹sassã€lessç­‰é¢„å¤„ç†å™¨çš„æ”¯æŒï¼Œå®˜æ–¹æ–‡æ¡£è¯´æ˜Ž äºŽæ˜¯ï¼Œåªèƒ½è‡ªå·±åŠ¨æ‰‹ï¼Œåœ¨configç›®å½•ä¸‹ï¼Œwebpack.config.dev.js å’Œ webpack.config.prod.jsæ–‡ä»¶ï¼Œæ²¡æœ‰æŠ½å‡º loaderã€postcssä¹‹ç±»ä¸€èˆ¬å…±ç”¨çš„é…ç½®ï¼ŒäºŽæ˜¯ï¼Œåœ¨ä¸¤ä¸ªæ–‡ä»¶å¤¹éƒ½è¦ä¸€èµ·é…ç½®ï¼Œä¹Ÿå¯ä»¥æŠ½å‡ºå…±ç”¨éƒ¨åˆ†ï¼Œä»¥ä¾¿ç»´æŠ¤ã€‚ è¿™é‡Œä»¥webpack.config.dev.jsä¸¾ä¾‹ï¼Œwebpack.config.prod.jsä¸€æ ·é…ç½®å³å¯ï¼š SASS-loaderï¼š1ã€å‘½ä»¤è¡Œï¼Œåœ¨å½“å‰ç›®å½•æ‰§è¡Œï¼š1npm install --save node-sass-chokidar //or yarn add node-sass-chokidar ç„¶åŽåœ¨package.jsonä¿®æ”¹ä¸º123456"scripts": &#123; "build-css": "node-sass-chokidar src/ -o src/", "watch-css": "npm run build-css &amp;&amp; node-sass-chokidar src/ -o src/ --watch --recursive", "start": "react-scripts start", "build": "react-scripts build", "test": "react-scripts test --env=jsdom", æŠŠindex.cssæ”¹ä¸ºindex.scss æ‰§è¡Œ1npm run watch-css å°±å¯ä»¥å‘çŽ°sassæ–‡ä»¶è¢«ç¼–è¯‘æˆäº†cssæ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„cssæ–‡ä»¶æ‰€ä»¥å¼•ç”¨çš„éƒ¨åˆ†ä¸ä½œä¿®æ”¹ï¼‰ å¦‚æžœä½ å‘çŽ°åœ¨æ‰§è¡Œwatch-css å‘½ä»¤æ—¶ ä¸èƒ½åŒæ—¶æ‰§è¡Œnpm start,å¯ä»¥é‡‡ç”¨å¦å¤–ä¸€ç§æ–¹å¼ï¼š1npm install --save npm-run-all //yarn add npm-run-allï¼ˆ è¿™æ˜¯watch-csså’Œbuild-cssçš„åˆé›†ï¼‰ åŒæ ·ä¿®æ”¹package.jsonä¸­çš„123456789"scripts": &#123; "build-css": "node-sass-chokidar src/ -o src/", "watch-css": "npm run build-css &amp;&amp; node-sass-chokidar src/ -o src/ --watch --recursive", "start-js": "node scripts/start.js", "start": "npm-run-all -p watch-css start-js", "build-js": "node scripts/build.js", "build": "npm-run-all build-css build-js", "test": "node scripts/test.js --env=jsdom" &#125;, è¿™æ ·å°±å¯ä»¥åªéœ€æ‰§è¡Œnpm start ç¼–è¾‘æŸ¥çœ‹äº† 2ã€æ‰¾åˆ°webpack.config.dev.jsæ–‡ä»¶ä¸­ loadersä¸­çš„ç¬¬ä¸€é¡¹excludeï¼ˆå€¼ä¸ºæ•°ç»„ï¼‰ï¼ŒæŽ’é™¤scssæ–‡ä»¶ï¼Œå¦åˆ™å°†è¢«â€™url-loaderâ€™æ•èŽ·ã€‚12345678910&#123;exclude: [ /\.html$/, /\.(js|jsx)(\?.*)?$/, /\.css$/, /\.json$/, /\.svg$/, /\.scss$/ //....æ–°å¢žé¡¹!] 3ã€loadersæ–°å¢žä¸€é¡¹ï¼š1234&#123; test: /\.scss$/, loader: 'style!css!postcss!sass?outputStyle=expanded'&#125;, è‡³æ­¤ï¼ŒSASSæ–‡ä»¶å°±å¯ä»¥æ­£å¸¸æ‰“åŒ…äº†ï¼ˆæ­¤å¤„é’ˆå¯¹SCSSæ–‡ä»¶ï¼Œå¦‚ç”¨åˆ°SASSï¼Œå¯å°†SCSSçš„æ­£åˆ™ä¿®æ”¹ä¸‹ï¼‰ï¼ŒLESSæ–‡ä»¶ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚ ä½¿ç”¨and-mobile UIå·¥å…· å¯ä»¥å¿«é€Ÿå¼€å‘reactåº”ç”¨and-mobileå…¥å£ antd-mobileçš„å¼•å…¥åŠé…ç½®åœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼š1npm install antd-mobile --save æŒ‰éœ€å¼•å…¥ ä¸ºå‡å°‘æ‰“åŒ…åŽä½“ç§¯ä»¥åŠæ–¹ä¾¿ä¹¦å†™ï¼Œå¯ç”¨babel-plugin-importæ’ä»¶ï¼Œé…ç½®åŽå¼•å…¥æ¨¡å—å¯å¦‚ä¸‹ï¼š1import &#123;Picker&#125; from 'antd-mobile'; è‡ªåŠ¨å¼•å…¥CSSå’ŒJSï¼Œæ— éœ€å†å¼•å…¥æ•´ä¸ªantd-mobileçš„æ•´ä¸ªCSSæ–‡ä»¶ ä½¿ç”¨å¦‚ä¸‹ï¼š1npm install babel-plugin-import --save-dev å®‰è£…å®Œæ¯•åŽï¼Œåœ¨æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶ï¼Œå‘½å: .babelrc.js123456789101112131415&#123; "presets": [ "es2015", "react" ], "plugins": [ [ "import", &#123; "libraryName": "antd-mobile", "style": "css" &#125; ] ]&#125; åœ¨æ–‡ä»¶å†…è¾“å…¥ä»¥ä¸Šå†…å®¹ï¼Œä¸ºbabelçš„é…ç½®ã€‚ ç„¶åŽï¼ï¼ï¼æœ€é‡è¦çš„ä¸€æ­¥ï¼ŒæŠŠpackage.jsonä¸­çš„babelé…ç½®ç»™åˆ æŽ‰ï¼Œå°¤å…¶æ˜¯ï¼šreact-appï¼ï¼ï¼ webpack.config.dev.jså’Œwebpack.config.prod.jsä¸­ï¼Œéƒ½éœ€è¦ä¸ºresolveçš„extensionsæ–°å¢žä¸€é¡¹â€™.web.jsâ€˜ antd-mobileçš„webç‰ˆçš„æ–‡ä»¶åŽç¼€ä¸º.web.js â€¦ åŸºäºŽcreate-react-appçš„æ‰“åŒ…åŽæ–‡ä»¶æ ¹è·¯å¾„ä¿®æ”¹æ‰¾åˆ°react-scriptæ¨¡å—æ–‡ä»¶å¤¹configä¸‹é¢ paths.js æˆ–node_modules\react-scripts\config\ paths.js45è¡Œåˆ° 49è¡Œ123456function getServedPath(appPackageJson) &#123; const publicUrl = getPublicUrl(appPackageJson); const servedUrl = envPublicUrl || (publicUrl ? url.parse(publicUrl).pathname : './'); // é…ç½®æ–‡ä»¶è·Ÿè·¯å¾„'/'å‰é¢åŠ . return ensureSlash(servedUrl, true);&#125; reactæ®µä½æŽ’è¡Œè¦æ±‚çŸ¥ä¹Žå¤§ç¥žæ€»ç»“å€”å¼ºé’é“œåˆå…¥å³¡è°·çš„åˆå§‹æ®µä½ï¼Œé»˜è®¤å¬å”¤å¸ˆå·²ç»æœ‰äº†ES6ï¼Œnodejsçš„åŸºç¡€ä½¿ç”¨create-react-appå»ºç«‹Reactå¼€å‘çŽ¯å¢ƒå­¦ä¹ Reactä¸–ç•Œé‡Œçš„åŸºæœ¬çŽ©æ³•ï¼Œä¾‹å¦‚ç»„ä»¶åŒ–ï¼ŒJSXï¼Œäº‹ä»¶ç›‘å¬ï¼Œå†…éƒ¨stateï¼Œç»„ä»¶çš„propsã€ç”Ÿå‘½å‘¨æœŸå‡½æ•°ç­‰è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»Reacté’é“œå‡ç™½é“¶éœ€è¦çš„åŸºç¡€çŸ¥è¯†ï¼Œçœ‹å®Œä½ å°±ç™½é“¶å•¦ ç§©åºç™½é“¶åˆ°äº†ç™½é“¶æ®µä½ï¼ŒåŸºæœ¬éƒ½æ˜¯æœ‰äº†åŸºæœ¬çš„æ“ä½œï¼Œä¸ä¼šå‡ºçŽ°å‘†èŒçš„ç«™åœ¨åœ°æ–¹å¡”ä¸‹è¢«æ‰“æ­»çš„æƒ…å†µäº†æˆ‘ä»¬éœ€è¦ä¹°ä¸€ä¸ªçš®è‚¤æ¥æå‡é¡µé¢ç¾Žè§‚å¹¶ä¸”å¤šåŠ ç»ƒä¹ å­¦ä¹ ä½¿ç”¨èš‚èšé‡‘æœant-designçš„ä½¿ç”¨ è£è€€é»„é‡‘åˆ°äº†è¿™ä¸ªé˜¶æ®µï¼Œå¬å”¤å¸ˆå¯¹Reactæœ‰äº†åŸºæœ¬çš„è®¤è¯†ï¼Œæƒ³è¿›ä¸€æ­¥çš„æå‡æ®µä½ï¼Œæˆ‘ä»¬éœ€è¦æé«˜è‡ªå·±çš„å¤§å±€è§‚å­¦ä¹ ä½¿ç”¨React-Router4æ¥è®©æˆ‘ä»¬æœ‰å¤šé¢ä½œæˆ˜èƒ½åŠ›å­¦ä¼šä½¿ç”¨BrowserRouterï¼ŒRouterï¼ŒLinkç­‰ç»„ä»¶å­¦ä¼šä½¿ç”¨Reduxå’Œé˜Ÿå‹é…åˆï¼Œä¿®ç‚¼å¤§å±€è§‚äº†è§£å•é¡¹æ•°æ®æµå¼€å‘æ¨¡å¼å’ŒReduxçš„å„ç§æ¦‚å¿µ,å¦‚dispatch,action,reducersä½¿ç”¨react-reduxæ›´å¥½çš„å’ŒReduxé…åˆæœ‰å¤§å±€è§‚æ„è¯†ï¼Œä¸Šé“‚é‡‘ä¹Ÿæ˜¯å¾ˆ easy äº† å°Šè´µé“‚é‡‘å¾ˆå¤šå¬å”¤å¸ˆå¡åœ¨é“‚é‡‘ä¸Šä¸åŽ»ï¼Œå› ä¸ºé“‚é‡‘æƒ³ä¸Šé’»çŸ³ï¼Œéœ€è¦äº†è§£æ›´å¤šçš„ç»†èŠ‚å’ŒåŽŸç†ReactåŽŸç†å‰–æžå¯¹è‡ªå·±æŠ€èƒ½çš„åŽŸç†æœ‰æ·±åˆ»çš„äº†è§£ï¼Œä¸Šé’»çŸ³å¿…å¤‡ æ°¸æ’é’»çŸ³é’»çŸ³æ®µä½å¼€å§‹äº†å¾å…†æ¨¡å¼ï¼Œå¬å”¤å¸ˆçš„æŠ€èƒ½æ± è¦è¶³å¤Ÿæ·±æ‰èƒ½æ›´è¿›ä¸€æ­¥ï¼Œå¯¹è‡ªå·±æ“…é•¿æŠ€èƒ½çš„ç†è§£ä¹Ÿè¦æ›´æ·±åˆ»Reduxä¸­é—´ä»¶æœºåˆ¶ï¼Œå®žçŽ°è‡ªå·±çš„ä¸­é—´ä»¶å¸¸è§çš„React æ€§èƒ½ä¼˜åŒ–æ–¹å¼æœåŠ¡ç«¯æ¸²æŸ“Reduxä¹‹å¤–å…¶ä»–çš„æ•°æ®è§£å†³æ–¹æ¡ˆå¦‚mobxï¼Œdva è‡³å°Šæ˜Ÿè€€è¿™ä¸ªæ®µä½å·²ç»æ˜¯ç‹¬å½“ä¸€é¢çš„å¼ºè€…äº†ï¼Œç›®æ ‡ä»…é™äºŽ React è¿™ä¸ªåº“å¾ˆéš¾æ›´è¿‘ä¸€å±‚ï¼Œéœ€è¦äº†è§£æ›´åº•å±‚çš„åŽŸç†ReduxåŽŸç†å‰–æž+å®žçŽ°è‡ªå·±çš„ReduxReact-Router+å®žçŽ°è‡ªå·±çš„React-RouterWebppackå·¥ä½œæœºåˆ¶å’ŒåŽŸç†å‰–æžBabelå·¥ä½œæœºåˆ¶å’ŒåŽŸç†å‰–æž æœ€å¼ºçŽ‹è€…è¾¾åˆ°æœ€å¼ºçŽ‹è€…å·²ç»æ˜¯é¡¶å°–å¬å”¤å¸ˆï¼Œåœ¨æ•´ä¸ª React å³¡è°·éƒ½æ˜¯é¼Žé¼Žå¤§åçš„å­˜åœ¨ï¼Œå¬è¯´ä¸Šé¢è¿˜æœ‰ä¼ è¯´ä¸­çš„è£è€€çŽ‹è€…çš„æ®µä½ï¼Œæˆ‘è¿™è¾ˆå­æ˜¯è¾¾ä¸åˆ°äº†ï¼Œä¹Ÿæ²¡æ³•æ•™ä½ ä»¬äº†ï¼Œå›§è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘åªæŽ¨èã€Šç¨‹åºå‘˜å¥åº·æŒ‡å—ã€‹ä¸€æœ¬ä¹¦ï¼Œä¿æŒèº«å¿ƒå¥åº·ï¼Œæˆä¸ºè£è€€çŽ‹è€…æ˜¯æ—©æ™šçš„äº‹åŽŸæ–‡é“¾æŽ¥]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptå¥‡æŠ€æ·«å·§44æ‹›]]></title>
    <url>%2F2018%2F02%2F27%2FJs%2FJavaScript%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A745%E6%8B%9B%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ é¦–æ¬¡ä¸ºå˜é‡èµ‹å€¼æ—¶åŠ¡å¿…ä½¿ç”¨varå…³é”®å­—å˜é‡æ²¡æœ‰å£°æ˜Žè€Œç›´æŽ¥èµ‹å€¼å¾—è¯ï¼Œé»˜è®¤ä¼šä½œä¸ºä¸€ä¸ªæ–°çš„å…¨å±€å˜é‡ï¼Œè¦å°½é‡é¿å…ä½¿ç”¨å…¨å±€å˜é‡ã€‚ ä½¿ç”¨===å–ä»£====å’Œ!=æ“ä½œç¬¦ä¼šåœ¨éœ€è¦çš„æƒ…å†µä¸‹è‡ªåŠ¨è½¬æ¢æ•°æ®ç±»åž‹ã€‚ä½†===å’Œ!==ä¸ä¼šï¼Œå®ƒä»¬ä¼šåŒæ—¶æ¯”è¾ƒå€¼å’Œæ•°æ®ç±»åž‹ï¼Œè¿™ä¹Ÿä½¿å¾—å®ƒä»¬è¦æ¯”==å’Œ!=å¿«ã€‚ 12345678[10] === 10 // is false[10] == 10 // is true'10' == 10 // is true'10' === 10 // is false [] == 0 // is true [] === 0 // is false '' == false // is true but true == "a" is false '' === false // is false underfinedã€nullã€0ã€falseã€NaNã€ç©ºå­—ç¬¦ä¸²çš„é€»è¾‘ç»“æžœå‡ä¸ºfalseè¡Œå°¾ä½¿ç”¨åˆ†å·å®žè·µä¸­æœ€å¥½è¿˜æ˜¯ä½¿ç”¨åˆ†å·ï¼Œå¿˜äº†å†™ä¹Ÿæ²¡äº‹ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹JavaScriptè§£é‡Šå™¨éƒ½ä¼šè‡ªåŠ¨æ·»åŠ ã€‚å¯¹äºŽä¸ºä½•è¦ä½¿ç”¨åˆ†å·ï¼Œå¯å‚è€ƒæ–‡ç« JavaScriptä¸­å…³äºŽåˆ†å·çš„çœŸç›¸ ä½¿ç”¨å¯¹è±¡æž„é€ å™¨12345function Person(firstName, lastName)&#123; this.firstName = firstName; this.lastName = lastName;&#125;var Saad = new Person("Saad", "Mousliki"); å°å¿ƒä½¿ç”¨typeofã€instanceofå’Œcontructor typeofï¼šJavaScriptä¸€å…ƒæ“ä½œç¬¦ï¼Œç”¨äºŽä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›žå˜é‡çš„åŽŸå§‹ç±»åž‹ï¼Œæ³¨æ„ï¼Œtypeof nullä¹Ÿä¼šè¿”å›žobjectï¼Œå¤§å¤šæ•°çš„å¯¹è±¡ç±»åž‹ï¼ˆæ•°ç»„Arrayã€æ—¶é—´Dateç­‰ï¼‰ä¹Ÿä¼šè¿”å›žobject contructorï¼šå†…éƒ¨åŽŸåž‹å±žæ€§ï¼Œå¯ä»¥é€šè¿‡ä»£ç é‡å†™ instanceofï¼šJavaScriptæ“ä½œç¬¦ï¼Œä¼šåœ¨åŽŸåž‹é“¾ä¸­çš„æž„é€ å™¨ä¸­æœç´¢ï¼Œæ‰¾åˆ°åˆ™è¿”å›žtrueï¼Œå¦åˆ™è¿”å›žfalse 1234var arr = ["a", "b", "c"];typeof arr; // è¿”å›ž "object" arr instanceof Array // truearr.constructor(); //[] ä½¿ç”¨è‡ªè°ƒç”¨å‡½æ•°å‡½æ•°åœ¨åˆ›å»ºä¹‹åŽç›´æŽ¥è‡ªåŠ¨æ‰§è¡Œï¼Œé€šå¸¸ç§°ä¹‹ä¸ºè‡ªè°ƒç”¨åŒ¿åå‡½æ•°ï¼ˆSelf-Invoked Anonymous Functionï¼‰æˆ–ç›´æŽ¥è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼ˆImmediately Invoked Function Expression ï¼‰ã€‚æ ¼å¼å¦‚ä¸‹ï¼š 12345678(function()&#123; // ç½®äºŽæ­¤å¤„çš„ä»£ç å°†è‡ªåŠ¨æ‰§è¡Œ&#125;)(); (function(a,b)&#123; var result = a+b; return result;&#125;)(10,20) ä»Žæ•°ç»„ä¸­éšæœºèŽ·å–æˆå‘˜123var items = [12, 548 , 'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' , 2145 , 119];var randomItem = items[Math.floor(Math.random() * items.length)];console.log(randomItem); èŽ·å–æŒ‡å®šèŒƒå›´å†…çš„éšæœºæ•°è¿™ä¸ªåŠŸèƒ½åœ¨ç”Ÿæˆæµ‹è¯•ç”¨çš„å‡æ•°æ®æ—¶ç‰¹åˆ«æœ‰æ•°ï¼Œæ¯”å¦‚ä»‹ä¸ŽæŒ‡å®šèŒƒå›´å†…çš„å·¥èµ„æ•°ã€‚1var x = Math.floor(Math.random() * (max - min + 1)) + min; ç”Ÿæˆä»Ž0åˆ°æŒ‡å®šå€¼çš„æ•°å­—æ•°ç»„12var numbersArray = [] , max = 100;for( var i=1; numbersArray.push(i++) &lt; max;); // numbers = [1,2,3 ... 100] ç”Ÿæˆéšæœºçš„å­—æ¯æ•°å­—å­—ç¬¦ä¸²12345function generateRandomAlphaNum(len) &#123; var rdmString = ""; for( ; rdmString.length &lt; len; rdmString += Math.random().toString(36).substr(2)); return rdmString.substr(0, len);&#125; æ‰“ä¹±æ•°å­—æ•°ç»„çš„é¡ºåº123var numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411];numbers = numbers.sort(function()&#123; return Math.random() - 0.5&#125;);/* numbers æ•°ç»„å°†ç±»ä¼¼äºŽ [120, 5, 228, -215, 400, 458, -85411, 122205] */ è¿™é‡Œä½¿ç”¨äº†JavaScriptå†…ç½®çš„æ•°ç»„æŽ’åºå‡½æ•°ï¼Œæ›´å¥½çš„åŠžæ³•æ˜¯ç”¨ä¸“é—¨çš„ä»£ç æ¥å®žçŽ°ï¼ˆå¦‚Fisher-Yatesç®—æ³• å­—ç¬¦ä¸²åŽ»ç©ºæ ¼Javaã€C#å’ŒPHPç­‰è¯­è¨€éƒ½å®žçŽ°äº†ä¸“é—¨çš„å­—ç¬¦ä¸²åŽ»ç©ºæ ¼å‡½æ•°ï¼Œä½†JavaScriptä¸­æ˜¯æ²¡æœ‰çš„ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç æ¥ä¸ºStringå¯¹è±¡å‡½æ•°ä¸€ä¸ªtrimå‡½æ•°ï¼š 1String.prototype.trim = function()&#123;return this.replace(/^\s+|\s+$/g, "");&#125;; æ–°çš„JavaScriptå¼•æ“Žå·²ç»æœ‰äº†trim()çš„åŽŸç”Ÿå®žçŽ° æ•°ç»„ä¹‹é—´è¿½åŠ 1234var array1 = [12 , "foo" , &#123;name "Joe"&#125; , -2458];var array2 = ["Doe" , 555 , 100];Array.prototype.push.apply(array1, array2);/* array1 å€¼ä¸º [12 , "foo" , &#123;name "Joe"&#125; , -2458 , "Doe" , 555 , 100] */ å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„1var argArray = Array.prototype.slice.call(arguments); éªŒè¯æ˜¯å¦æ˜¯æ•°å­—123function isNumber(n)&#123; return !isNaN(parseFloat(n)) &amp;&amp; isFinite(n);&#125; éªŒè¯æ˜¯å¦æ˜¯æ•°ç»„123function isArray(obj)&#123; return Object.prototype.toString.call(obj) === '[object Array]' ;&#125; ä½†å¦‚æžœtoString()æ–¹æ³•è¢«é‡å†™è¿‡å¾—è¯ï¼Œå°±è¡Œä¸é€šäº†ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š1Array.isArray(obj); // its a new Array method å¦‚æžœåœ¨æµè§ˆå™¨ä¸­æ²¡æœ‰ä½¿ç”¨frameï¼Œè¿˜å¯ä»¥ç”¨instanceofï¼Œä½†å¦‚æžœä¸Šä¸‹æ–‡å¤ªå¤æ‚ï¼Œä¹Ÿæœ‰å¯èƒ½å‡ºé”™ã€‚1234567var myFrame = document.createElement('iframe');document.body.appendChild(myFrame);var myArray = window.frames[window.frames.length-1].Array;var arr = new myArray(a,b,10); // [a,b,10] // myArray çš„æž„é€ å™¨å·²ç»ä¸¢å¤±ï¼Œinstanceof çš„ç»“æžœå°†ä¸æ­£å¸¸// æž„é€ å™¨æ˜¯ä¸èƒ½è·¨ frame å…±äº«çš„arr instanceof Array; // false èŽ·å–æ•°ç»„ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼123var numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411]; var maxInNumbers = Math.max.apply(Math, numbers); var minInNumbers = Math.min.apply(Math, numbers); æ¸…ç©ºæ•°ç»„12var myArray = [12 , 222 , 1000 ]; myArray.length = 0; // myArray will be equal to []. ä¸è¦ç›´æŽ¥ä»Žæ•°ç»„ä¸­deleteæˆ–removeå…ƒç´ å¦‚æžœå¯¹æ•°ç»„å…ƒç´ ç›´æŽ¥ä½¿ç”¨deleteï¼Œå…¶å®žå¹¶æ²¡æœ‰åˆ é™¤ï¼Œåªæ˜¯å°†å…ƒç´ ç½®ä¸ºäº†undefinedã€‚æ•°ç»„å…ƒç´ åˆ é™¤åº”ä½¿ç”¨spliceã€‚ åˆ‡å¿Œï¼š12345var items = [12, 548 ,'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' ,2154 , 119 ]; items.length; // return 11 delete items[3]; // return true items.length; // return 11 /* items ç»“æžœä¸º [12, 548, "a", undefined Ã— 1, 5478, "foo", 8852, undefined Ã— 1, "Doe", 2154, 119] */ è€Œåº”ï¼š123456var items = [12, 548 ,'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' ,2154 , 119 ]; items.length; // return 11 items.splice(3,1) ; items.length; // return 10 /* items ç»“æžœä¸º [12, 548, "a", 5478, "foo", 8852, undefined Ã— 1, "Doe", 2154, 119]åˆ é™¤å¯¹è±¡çš„å±žæ€§æ—¶å¯ä»¥ä½¿ç”¨deleteã€‚ ä½¿ç”¨lengthå±žæ€§æˆªæ–­æ•°ç»„å‰é¢çš„ä¾‹å­ä¸­ç”¨lengthå±žæ€§æ¸…ç©ºæ•°ç»„ï¼ŒåŒæ ·è¿˜å¯ç”¨å®ƒæ¥æˆªæ–­æ•°ç»„12var myArray = [12 , 222 , 1000 , 124 , 98 , 10 ]; myArray.length = 4; // myArray will be equal to [12 , 222 , 1000 , 124]. ä¸Žæ­¤åŒæ—¶ï¼Œå¦‚æžœæŠŠlengthå±žæ€§å˜å¤§ï¼Œæ•°ç»„çš„é•¿åº¦å€¼å˜ä¼šå¢žåŠ ï¼Œä¼šä½¿ç”¨undefinedæ¥ä½œä¸ºæ–°çš„å…ƒç´ å¡«å……ã€‚lengthæ˜¯ä¸€ä¸ªå¯å†™çš„å±žæ€§ã€‚12myArray.length = 10; // the new array length is 10 myArray[myArray.length - 1] ; // undefined åœ¨æ¡ä»¶ä¸­ä½¿ç”¨é€»è¾‘ä¸Žæˆ–123var foo = 10; foo == 10 &amp;&amp; doSomething(); // is the same thing as if (foo == 10) doSomething(); foo == 5 || doSomething(); // is the same thing as if (foo != 5) doSomething(); é€»è¾‘æˆ–è¿˜å¯ç”¨æ¥è®¾ç½®é»˜è®¤å€¼ï¼Œæ¯”å¦‚å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚ 123function doSomething(arg1)&#123; arg1 = arg1 || 10; // arg1 will have 10 as a default value if itâ€™s not already set&#125; ä½¿å¾—map()å‡½æ•°æ–¹æ³•å¯¹æ•°æ®å¾ªçŽ¯1234var squares = [1,2,3,4].map(function (val) &#123; return val * val; &#125;); // squares will be equal to [1, 4, 9, 16] ä¿ç•™æŒ‡å®šå°æ•°ä½æ•°12var num =2.443242342;num = num.toFixed(4); // num will be equal to 2.4432 æ³¨æ„ï¼ŒtoFixec()è¿”å›žçš„æ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ˜¯æ•°å­—ã€‚ æµ®ç‚¹è®¡ç®—çš„é—®é¢˜1230.1 + 0.2 === 0.3 // is false 9007199254740992 + 1 // is equal to 90071992547409929007199254740992 + 2 // is equal to 9007199254740994 ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸º0.1+0.2ç­‰äºŽ0.30000000000000004ã€‚JavaScriptçš„æ•°å­—éƒ½éµå¾ªIEEE 754æ ‡å‡†æž„å»ºï¼Œåœ¨å†…éƒ¨éƒ½æ˜¯64ä½æµ®ç‚¹å°æ•°è¡¨ç¤ºï¼Œå…·ä½“å¯ä»¥å‚è§JavaScriptä¸­çš„æ•°å­—æ˜¯å¦‚ä½•ç¼–ç çš„. å¯ä»¥é€šè¿‡ä½¿ç”¨toFixed()å’ŒtoPrecision()æ¥è§£å†³è¿™ä¸ªé—®é¢˜ é€šè¿‡for-inå¾ªçŽ¯æ£€æŸ¥å¯¹è±¡çš„å±žæ€§ä¸‹é¢è¿™æ ·çš„ç”¨æ³•ï¼Œå¯ä»¥é˜²æ­¢è¿­ä»£çš„æ—¶å€™è¿›å…¥åˆ°å¯¹è±¡çš„åŽŸåž‹å±žæ€§ä¸­ã€‚ 12345for (var name in object) &#123; if (object.hasOwnProperty(name)) &#123; // do something with name &#125; &#125; é€—å·æ“ä½œç¬¦1234var a = 0; var b = ( a++, 99 ); console.log(a); // a will be equal to 1 console.log(b); // b is equal to 99 ä¸´æ—¶å­˜å‚¨ç”¨äºŽè®¡ç®—å’ŒæŸ¥è¯¢çš„å˜é‡åœ¨jQueryé€‰æ‹©å™¨ä¸­ï¼Œå¯ä»¥ä¸´æ—¶å­˜å‚¨æ•´ä¸ªDOMå…ƒç´ 1234var navright = document.querySelector('#right'); var navleft = document.querySelector('#left'); var navup = document.querySelector('#up'); var navdown = document.querySelector('#down'); æå‰æ£€æŸ¥ä¼ å…¥ isFinite() çš„å‚æ•°1234567isFinite(0/0) ; // falseisFinite("foo"); // falseisFinite("10"); // trueisFinite(10); // trueisFinite(undefined); // falseisFinite(); // falseisFinite(null); // trueï¼Œè¿™ç‚¹å½“ç‰¹åˆ«æ³¨æ„ é¿å…åœ¨æ•°ç»„ä¸­ä½¿ç”¨è´Ÿæ•°åšç´¢å¼•123var numbersArray = [1,2,3,4,5];var from = numbersArray.indexOf("foo") ; // from is equal to -1numbersArray.splice(from,2); // will return [5] æ³¨æ„ä¼ ç»™spliceçš„ç´¢å¼•å‚æ•°ä¸è¦æ˜¯è´Ÿæ•°ï¼Œå½“æ˜¯è´Ÿæ•°æ—¶ï¼Œä¼šä»Žæ•°ç»„ç»“å°¾å¤„åˆ é™¤å…ƒç´ ã€‚ ç”¨JSONæ¥åºåˆ—åŒ–ä¸Žååºåˆ—åŒ–12345var person = &#123;name :'Saad', age : 26, department : &#123;ID : 15, name : "R&amp;D"&#125; &#125;;var stringFromPerson = JSON.stringify(person);/* stringFromPerson ç»“æžœä¸º "&#123;"name":"Saad","age":26,"department":&#123;"ID":15,"name":"R&amp;D"&#125;&#125;" */var personFromString = JSON.parse(stringFromPerson);/* personFromString çš„å€¼ä¸Ž person å¯¹è±¡ç›¸åŒ */ ä¸è¦ä½¿ç”¨eval()æˆ–è€…å‡½æ•°æž„é€ å™¨eval()å’Œå‡½æ•°æž„é€ å™¨ï¼ˆFunction consturctorï¼‰çš„å¼€é”€è¾ƒå¤§ï¼Œæ¯æ¬¡è°ƒç”¨ï¼ŒJavaScriptå¼•æ“Žéƒ½è¦å°†æºä»£ç è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„ä»£ç ã€‚12var func1 = new Function(functionCode);var func2 = eval(functionCode); é¿å…ä½¿ç”¨with()ä½¿ç”¨with()å¯ä»¥æŠŠå˜é‡åŠ å…¥åˆ°å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå› æ­¤ï¼Œå¦‚æžœæœ‰å…¶å®ƒçš„åŒåå˜é‡ï¼Œä¸€æ¥å®¹æ˜“æ··æ·†ï¼ŒäºŒæ¥å€¼ä¹Ÿä¼šè¢«è¦†ç›– ä¸è¦å¯¹æ•°ç»„ä½¿ç”¨for-iné¿å…ï¼š1234var sum = 0; for (var i in arrayNumbers) &#123; sum += arrayNumbers[i]; &#125; è€Œæ˜¯:1234var sum = 0; for (var i = 0, len = arrayNumbers.length; i &lt; len; i++) &#123; sum += arrayNumbers[i]; &#125; å¦å¤–ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œiå’Œlenä¸¤ä¸ªå˜é‡æ˜¯åœ¨forå¾ªçŽ¯çš„ç¬¬ä¸€ä¸ªå£°æ˜Žä¸­ï¼ŒäºŒè€…åªä¼šåˆå§‹åŒ–ä¸€æ¬¡ï¼Œè¿™è¦æ¯”ä¸‹é¢è¿™ç§å†™æ³•å¿«ï¼š 1for (var i = 0; i &lt; arrayNumbers.length; i++) ä¼ ç»™setInterval()å’ŒsetTimeout()æ—¶ä½¿ç”¨å‡½æ•°è€Œä¸æ˜¯å­—ç¬¦ä¸²å¦‚æžœä¼ ç»™setTimeout()å’ŒsetInterval()ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»–ä»¬å°†ä¼šç”¨ç±»ä¼¼äºŽevalæ–¹å¼è¿›è¡Œè½¬æ¢ï¼Œè¿™è‚¯å®šä¼šè¦æ…¢äº›ï¼Œå› æ­¤ä¸è¦ä½¿ç”¨ï¼š12setInterval('doSomethingPeriodically()', 1000); setTimeout('doSomethingAfterFiveSeconds()', 5000); è€Œæ˜¯ç”¨ï¼š12setInterval(doSomethingPeriodically, 1000); setTimeout(doSomethingAfterFiveSeconds, 5000); ä½¿ç”¨switch/caseä»£æ›¿ä¸€å¤§å çš„if/elseå½“åˆ¤æ–­æœ‰è¶…è¿‡ä¸¤ä¸ªåˆ†æ”¯çš„æ—¶å€™ä½¿ç”¨switch/caseè¦æ›´å¿«ä¸€äº›ï¼Œè€Œä¸”ä¹Ÿæ›´ä¼˜é›…ï¼Œæ›´åˆ©äºŽä»£ç çš„ç»„ç»‡ï¼Œå½“ç„¶ï¼Œå¦‚æžœæœ‰è¶…è¿‡10ä¸ªåˆ†æ”¯ï¼Œå°±ä¸è¦ä½¿ç”¨switch/caseäº†ã€‚ åœ¨switch/caseä¸­ä½¿ç”¨æ•°å­—åŒºé—´å…¶å®žï¼Œswitch/caseä¸­çš„caseæ¡ä»¶ï¼Œè¿˜å¯ä»¥è¿™æ ·å†™ï¼š12345678910111213141516171819function getCategory(age) &#123; var category = ""; switch (true) &#123; case isNaN(age): category = "not an age"; break; case (age &gt;= 50): category = "Old"; break; case (age &lt;= 20): category = "Baby"; break; default: category = "Young"; break; &#125;; return category; &#125; getCategory(5); // å°†è¿”å›ž "Baby" ä½¿ç”¨å¯¹è±¡ä½œä¸ºå¯¹è±¡çš„åŽŸåž‹ä¸‹é¢è¿™æ ·ï¼Œä¾¿å¯ä»¥ç»™å®šå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œæ¥åˆ›å»ºä»¥æ­¤ä¸ºåŽŸåž‹çš„æ–°å¯¹è±¡ï¼š123456function clone(object) &#123; function OneShotConstructor()&#123;&#125;; OneShotConstructor.prototype = object; return new OneShotConstructor(); &#125; clone(Array).prototype ; // [] HTMLå­—æ®µè½¬æ¢å‡½æ•°123456function escapeHTML(text) &#123; var replacements= &#123;"&lt;": "&amp;lt;", "&gt;": "&amp;gt;","&amp;": "&amp;amp;", "\"": "&amp;quot;"&#125;; return text.replace(/[&lt;&gt;&amp;"]/g, function(character) &#123; return replacements[character]; &#125;); &#125; ä¸è¦åœ¨å¾ªçŽ¯å†…éƒ¨ä½¿ç”¨try-catch-finallytry-catch-finallyä¸­catchéƒ¨åˆ†åœ¨æ‰§è¡Œæ—¶ä¼šå°†å¼‚å¸¸èµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªå˜é‡ä¼šè¢«æž„å»ºæˆä¸€ä¸ªè¿è¡Œæ—¶ä½œç”¨åŸŸå†…çš„æ–°çš„å˜é‡ã€‚åˆ‡å¿Œï¼š123456789var object = ['foo', 'bar'], i; for (i = 0, len = object.length; i &lt;len; i++) &#123; try &#123; // do something that throws an exception &#125; catch (e) &#123; // handle exception &#125; &#125; è€Œåº”è¯¥ï¼š123456789var object = ['foo', 'bar'], i; try &#123; for (i = 0, len = object.length; i &lt;len; i++) &#123; // do something that throws an exception &#125; &#125; catch (e) &#123; // handle exception &#125; ä½¿ç”¨XMLHttpRequestsæ—¶æ³¨æ„è®¾ç½®è¶…æ—¶XMLHttpRequestsåœ¨æ‰§è¡Œæ—¶ï¼Œå½“é•¿æ—¶é—´æ²¡æœ‰å“åº”ï¼ˆå¦‚å‡ºçŽ°ç½‘ç»œé—®é¢˜ç­‰ï¼‰æ—¶ï¼Œåº”è¯¥ä¸­æ­¢æŽ‰è¿žæŽ¥ï¼Œå¯ä»¥é€šè¿‡setTimeout()æ¥å®Œæˆè¿™ä¸ªå·¥ä½œï¼š123456789101112var xhr = new XMLHttpRequest (); xhr.onreadystatechange = function () &#123; if (this.readyState == 4) &#123; clearTimeout(timeout); // do something with response data &#125; &#125; var timeout = setTimeout( function () &#123; xhr.abort(); // call error callback &#125;, 60*1000 /* timeout after a minute */ ); xhr.open('GET', url, true); xhr.send(); åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸è¦åŒæ—¶å‘èµ·å¤šä¸ªXMLHttpRequestsè¯·æ±‚ã€‚ å¤„ç†WebSocketçš„è¶…æ—¶é€šå¸¸æƒ…å†µä¸‹ï¼ŒWebSocketè¿žæŽ¥åˆ›å»ºåŽï¼Œå¦‚æžœ30ç§’å†…æ²¡æœ‰ä»»ä½•æ´»åŠ¨ï¼ŒæœåŠ¡å™¨ç«¯ä¼šå¯¹è¿žæŽ¥è¿›è¡Œè¶…æ—¶å¤„ç†ï¼Œé˜²ç«å¢™ä¹Ÿå¯ä»¥å¯¹å•ä½å‘¨æœŸæ²¡æœ‰æ´»åŠ¨çš„è¿žæŽ¥è¿›è¡Œè¶…æ—¶å¤„ç†ã€‚ ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œå¯ä»¥æ¯éš”ä¸€å®šæ—¶é—´ï¼Œå¾€æœåŠ¡å™¨å‘é€ä¸€æ¡ç©ºçš„æ¶ˆæ¯ã€‚å¯ä»¥é€šè¿‡ä¸‹é¢è¿™ä¸¤ä¸ªå‡½æ•°æ¥å®žçŽ°è¿™ä¸ªéœ€æ±‚ï¼Œä¸€ä¸ªç”¨äºŽä½¿è¿žæŽ¥ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œå¦ä¸€ä¸ªä¸“é—¨ç”¨äºŽç»“æŸè¿™ä¸ªçŠ¶æ€ã€‚12345678910111213var timerID = 0; function keepAlive() &#123; var timeout = 15000; if (webSocket.readyState == webSocket.OPEN) &#123; webSocket.send(''); &#125; timerId = setTimeout(keepAlive, timeout); &#125; function cancelKeepAlive() &#123; if (timerId) &#123; cancelTimeout(timerId); &#125; &#125; keepAlive()å‡½æ•°å¯ä»¥æ”¾åœ¨WebSocketè¿žæŽ¥çš„onOpen()æ–¹æ³•çš„æœ€åŽé¢ï¼ŒcancelKeepAlive()æ”¾åœ¨onClose()æ–¹æ³•çš„æœ€æœ«å°¾ æ—¶é—´æ³¨æ„åŽŸå§‹æ“ä½œç¬¦æ¯”å‡½æ•°è°ƒç”¨å¿«ï¼Œä½¿ç”¨VanillaJSæ¯”å¦‚ï¼Œä¸€èˆ¬ä¸è¦è¿™æ ·ï¼š12var min = Math.min(a,b); A.push(v); å¯ä»¥è¿™æ ·æ¥ä»£æ›¿ï¼š12var min = a &lt; b ? a : b; A[A.length] = v; å¼€å‘æ—¶æ³¨æ„ä»£ç ç»“æž„ï¼Œä¸Šçº¿å‰æ£€æŸ¥å¹¶åŽ‹ç¼©JavaScriptä»£ç å¯ä»¥ä½¿ç”¨JSLintæˆ–JSMinç­‰å·¥å…·æ¥æ£€æŸ¥å¹¶åŽ‹ç¼©ä»£ç ã€‚]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[10ä¸ªæœ€ä½³ES6ç‰¹æ€§]]></title>
    <url>%2F2018%2F02%2F26%2FJs%2F10%E4%B8%AA%E6%9C%80%E4%BD%B3ES6%E7%89%B9%E6%80%A7%2F</url>
    <content type="text"><![CDATA[10ä¸ªæœ€ä½³ES6ç‰¹æ€§åŽŸæ–‡åœ°å€ ES6ï¼Œæ­£å¼åç§°æ˜¯ECMAScript2015ï¼Œä½†æ˜¯ES6è¿™ä¸ªåç§°æ›´åŠ ç®€æ´ã€‚ES6å·²ç»ä¸å†æ˜¯JavaScriptæœ€æ–°çš„æ ‡å‡†ï¼Œä½†æ˜¯å®ƒå·²ç»å¹¿æ³›ç”¨äºŽç¼–ç¨‹å®žè·µä¸­ã€‚å¦‚æžœä½ è¿˜æ²¡ç”¨è¿‡ES6ï¼ŒçŽ°åœ¨è¿˜ä¸ç®—å¤ªæ™šâ€¦ å‡½æ•°å‚æ•°é»˜è®¤å€¼ä¸ä½¿ç”¨ES6ä¸ºå‡½æ•°è®¾ç½®é»˜è®¤å€¼ 123456function foo(height, color)&#123; var height = height || 50; var color = color || 'red'; //...&#125; è¿™æ ·å†™ä¸€èˆ¬æ²¡é—®é¢˜ï¼Œä½†æ˜¯ï¼Œå½“å‚æ•°çš„å¸ƒå°”å€¼ä¸ºfalseæ—¶ï¼Œæ˜¯ä¼šå‡ºäº‹æƒ…çš„ï¼æ¯”å¦‚ï¼Œæˆ‘ä»¬è¿™æ ·è°ƒç”¨fooå‡½æ•°ï¼š 1foo(0, "", "") å› ä¸º0çš„å¸ƒå°”å€¼ä¸ºfalseï¼Œè¿™æ ·heightçš„å–å€¼å°†æ˜¯50ã€‚åŒç†colorçš„å–å€¼ä¸ºâ€™redâ€™ã€‚ä½¿ç”¨ES6 1234function foo(height = 50, color = 'red')&#123; // ...&#125; æ¨¡æ¿å­—ç¬¦ä¸²ä¸ä½¿ç”¨ES6ä½¿ç”¨+å·å°†å˜é‡æ‹¼æŽ¥æˆå­—ç¬¦ä¸² 1var name = 'Your name is ' + first + ' ' + last + '.' ä½¿ç”¨ES6å°†å˜é‡æ”¾åˆ°``æ‹¬å·ä¸­ 1var name = `Your name is $&#123;first&#125; $&#123;last&#125;.` ES6çš„å†™æ³•æ›´åŠ ç®€æ´ã€ç›´è§‚ã€‚ å¤šè¡Œå­—ç¬¦ä¸²ä¸ä½¿ç”¨ES6ä½¿ç”¨â€ntâ€å°†å¤šè¡Œå­—ç¬¦ä¸²æ‹¼æŽ¥èµ·æ¥ï¼š 12345var roadPoem = 'Then took the other, as just as fair,\n\t' + 'And having perhaps the better claim\n\t' + 'Because it was grassy and wanted wear,\n\t' + 'Though as for that the passing there\n\t' + 'Had worn them really about the same,\n\t' ä½¿ç”¨ES6å°†å¤šè¡Œå­—ç¬¦ä¸²æ”¾åœ¨åå¼•å·``ä¹‹é—´å°±å¥½äº†ï¼š 12345var roadPoem = `Then took the other, as just as fair, And having perhaps the better claim Because it was grassy and wanted wear, Though as for that the passing there Had worn them really about the same,` è§£æž„èµ‹å€¼ä¸ä½¿ç”¨ES6å½“éœ€è¦èŽ·å–æŸä¸ªå¯¹è±¡çš„å±žæ€§å€¼æ—¶ï¼Œéœ€è¦å•ç‹¬èŽ·å–ï¼š 123var data = $('body').data(); // dataæœ‰houseå’Œmouseå±žæ€§var house = data.house;var mouse = data.mouse; ä½¿ç”¨ES6ä¸€æ¬¡æ€§èŽ·å–å¯¹è±¡çš„å­å±žæ€§ï¼š 1var &#123; house, mouse&#125; = $('body').data() å¯¹äºŽæ•°ç»„ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼š 1var [col1, col2] = $('.column')ï¼› å¯¹è±¡å±žæ€§ç®€å†™ä¸ä½¿ç”¨ES6å¯¹è±¡ä¸­å¿…é¡»åŒ…å«å±žæ€§å’Œå€¼ï¼Œæ˜¾å¾—éžå¸¸å¤šä½™ï¼š 12345678910var bar = 'bar';var foo = function ()&#123; // ...&#125;var baz = &#123; bar: bar, foo: foo&#125;; ä½¿ç”¨ES6å¯¹è±¡ä¸­ç›´æŽ¥å†™å˜é‡ï¼Œéžå¸¸ç®€å•ï¼š 123var bar = 'bar';var foo = function()&#123;// ...&#125;var baz = &#123;bar,foo&#125; ç®­å¤´å‡½æ•°ä¸ä½¿ç”¨ES6æ™®é€šå‡½æ•°ä½“å†…çš„thisï¼ŒæŒ‡å‘è°ƒç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚ 123456789function foo()&#123; console.log(this.id);&#125;var id = 1;foo(); // è¾“å‡º1foo.call(&#123; id: 2 &#125;); // è¾“å‡º2 ä½¿ç”¨ES6ç®­å¤´å‡½æ•°ä½“å†…çš„thisï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯è°ƒç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚ 123456789var foo = () =&gt; &#123; console.log(this.id);&#125;var id = 1;foo(); // è¾“å‡º1foo.call(&#123; id: 2 &#125;); // è¾“å‡º1 promiseä¸ä½¿ç”¨ES6åµŒå¥—ä¸¤ä¸ªsetTimeoutå›žè°ƒå‡½æ•°ï¼š 12345678setTimeout(function()&#123; console.log('Hello'); // 1ç§’åŽè¾“å‡º"Hello" setTimeout(function() &#123; console.log('Fundebug'); // 2ç§’åŽè¾“å‡º"Fundebug" &#125;, 1000);&#125;, 1000); ä½¿ç”¨ES6ä½¿ç”¨ä¸¤ä¸ªthenæ˜¯å¼‚æ­¥ç¼–ç¨‹ä¸²è¡ŒåŒ–ï¼Œé¿å…äº†å›žè°ƒåœ°ç‹±ï¼š 123456789101112131415var wait1000 = new Promise(function(resolve, reject)&#123; setTimeout(resolve, 1000);&#125;);wait1000 .then(function() &#123; console.log("Hello"); // 1ç§’åŽè¾“å‡º"Hello" return wait1000; &#125;) .then(function() &#123; console.log("Fundebug"); // 2ç§’åŽè¾“å‡º"Fundebug" &#125;); letä¸Žconstä½¿ç”¨Varvarå®šä¹‰çš„å˜é‡æœªå‡½æ•°çº§ä½œç”¨åŸŸï¼š 12345&#123; var a = 10;&#125;console.log(a); // è¾“å‡º10 ä½¿ç”¨letä¸Žconstletå®šä¹‰çš„å˜é‡ä¸ºå—çº§ä½œç”¨åŸŸï¼Œå› æ­¤ä¼šæŠ¥é”™ï¼š(å¦‚æžœä½ å¸Œæœ›å®žæ—¶ç›‘æŽ§JavaScriptåº”ç”¨çš„é”™è¯¯ï¼Œæ¬¢è¿Žå…è´¹ä½¿ç”¨Fundebug) 12345&#123; let a = 10;&#125;console.log(a); // æŠ¥é”™â€œReferenceError: a is not definedâ€ constä¸Žletä¸€æ ·ï¼Œä¹Ÿæ˜¯å—çº§ä½œç”¨åŸŸã€‚constæ˜¯ç”¨æ¥å®šä¹‰å¸¸é‡ ç±»ä¸ä½¿ç”¨ES6ä½¿ç”¨æž„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ï¼š 12345678910111213function Point(x, y)&#123; this.x = x; this.y = y; this.add = function() &#123; return this.x + this.y; &#125;;&#125;var p = new Point(1, 2);console.log(p.add()); // è¾“å‡º3 ä½¿ç”¨ES6ä½¿ç”¨Classå®šä¹‰ç±»ï¼Œæ›´åŠ è§„èŒƒï¼Œä¸”ä½ èƒ½å¤Ÿç»§æ‰¿ï¼š 1234567891011121314151617class Point&#123; constructor(x, y) &#123; this.x = x; this.y = y; &#125; add() &#123; return this.x + this.y; &#125;&#125;var p = new Point(1, 2);console.log(p.add()); // è¾“å‡º3 æ¨¡å—åŒ–JavaScriptä¸€ç›´æ²¡æœ‰å®˜æ–¹çš„æ¨¡å—åŒ–è§£å†³æ–¹æ¡ˆï¼Œå¼€å‘è€…åœ¨å®žè·µä¸­ä¸»è¦é‡‡ç”¨CommonJSå’ŒAMDè§„èŒƒã€‚è€ŒES6åˆ¶å®šäº†æ¨¡å—(Module)åŠŸèƒ½ã€‚ ä¸ä½¿ç”¨ES6Node.jsé‡‡ç”¨CommenJSè§„èŒƒå®žçŽ°äº†æ¨¡å—åŒ–ï¼Œè€Œå‰ç«¯ä¹Ÿå¯ä»¥é‡‡ç”¨ï¼Œåªæ˜¯åœ¨éƒ¨ç½²æ—¶éœ€è¦ä½¿ç”¨Browserifyç­‰å·¥å…·æ‰“åŒ…ã€‚è¿™é‡Œä¸å¦¨ä»‹ç»ä¸€ä¸‹CommenJSè§„èŒƒã€‚ module.jsä¸­ä½¿ç”¨module.exportså¯¼å‡ºportå˜é‡å’ŒgetAccountså‡½æ•°ï¼š 12345678910module.exports = &#123; port: 3000, getAccounts: function() &#123; ... &#125;&#125;main.jsä¸­ä½¿ç”¨requireå¯¼å…¥module.jsï¼švar service = require('module.js')console.log(service.port) // è¾“å‡º3000 ä½¿ç”¨ES6ES6ä¸­ä½¿ç”¨exportä¸Žimportå…³é”®è¯å®žçŽ°æ¨¡å—åŒ–ã€‚ module.jsä¸­ä½¿ç”¨exportå¯¼å‡ºportå˜é‡å’ŒgetAccountså‡½æ•°ï¼š 1234export var port = 3000export function getAccounts(url) &#123; ...&#125; main.jsä¸­ä½¿ç”¨importå¯¼å…¥module.jsï¼Œå¯ä»¥æŒ‡å®šéœ€è¦å¯¼å…¥çš„å˜é‡ï¼š 12import &#123;port, getAccounts&#125; from 'module'console.log(port) // è¾“å‡º3000 ä¹Ÿå¯ä»¥å°†å…¨éƒ¨å˜é‡å¯¼å…¥ï¼š 12import * as service from 'module'console.log(service.port) // 3000]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React æŠ€æœ¯æ ˆ]]></title>
    <url>%2F2018%2F02%2F25%2FReact%2FReact-%E6%8A%80%E6%9C%AF%E6%A0%88%2F</url>
    <content type="text"><![CDATA[React æŠ€æœ¯æ ˆç³»åˆ—åŽŸæ–‡åœ°å€ ES6æ•™ç¨‹ Bableæ•™ç¨‹ Reactæ•™ç¨‹ ç¤ºä¾‹ Webpack Flexæ•™ç¨‹ ç¤ºä¾‹ Css Modules ç¤ºä¾‹ React-router ç¤ºä¾‹ [Flux æž¶æž„] ç¤ºä¾‹ ç¤ºä¾‹ Reduxæž¶æž„ æ•™ç¨‹ä¸€ æ•™ç¨‹äºŒ æ•™ç¨‹ä¸‰ Mochaæµ‹è¯•æ¡†æž¶ æ•™ç¨‹ ç¤ºä¾‹ Istanbul è¦†ç›–çŽ‡æ¡†æž¶æ•™ç¨‹ React å•å…ƒæµ‹è¯•æ•™ç¨‹ ç¤ºä¾‹]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gulpé…ç½®åŠä½¿ç”¨]]></title>
    <url>%2F2018%2F02%2F24%2FTools%2Fgulp%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[gulp å…¥é—¨æŒ‡å—1.å…¨å±€å®‰è£… gulpï¼š1$ npm install --global gulp 2.ä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰å®‰è£…ï¼š1$ npm install --save-dev gulp 3. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º gulpfile.js çš„æ–‡ä»¶ï¼š12345var gulp = require('gulp');gulp.task('default', function() &#123; // å°†ä½ çš„é»˜è®¤çš„ä»»åŠ¡ä»£ç æ”¾åœ¨è¿™&#125;); 4. è¿è¡Œ gulpï¼š1$ gulp äº”ä¸ªgulpå‘½ä»¤: gulp.task(name[, deps], fn) å®šä¹‰ä»»åŠ¡ nameï¼šä»»åŠ¡åç§° depsï¼šä¾èµ–ä»»åŠ¡åç§° fnï¼šå›žè°ƒå‡½æ•°gulp.run(tasksâ€¦)ï¼šå°½å¯èƒ½å¤šçš„å¹¶è¡Œè¿è¡Œå¤šä¸ªtaskgulp.watch(glob, fn)ï¼šå½“globå†…å®¹å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰§è¡Œfngulp.src(glob)ï¼šç½®éœ€è¦å¤„ç†çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯ä»¥æ˜¯å¤šä¸ªæ–‡ä»¶ä»¥æ•°ç»„çš„å½¢å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯æ­£åˆ™gulp.dest(path[, options])ï¼šè®¾ç½®ç”Ÿæˆæ–‡ä»¶çš„è·¯å¾„ package.jsonæ–‡ä»¶12345678910111213141516171819202122232425262728293031323334353637&#123; "name": "yunbaodan", "version": "1.0.0", "description": "2.0å‡çº§", "main": "gulpfile.js", "scripts": &#123; "test": "echo \"Error: no test specified\" &amp;&amp; exit 1" &#125;, "author": "zhang", "license": "ISC", "devDependencies": &#123; "del": "^3.0.0", "gulp": "^3.9.1", "gulp-autoprefixer": "^4.0.0", "gulp-cache": "^1.0.1", "gulp-clean": "^0.3.2", "gulp-concat": "^2.6.1", "gulp-gh-pages": "^0.5.4", "gulp-htmlmin": "^3.0.0", "gulp-imagemin": "^4.0.0", "gulp-jshint": "^2.0.4", "gulp-less": "^3.3.2", "gulp-livereload": "^3.8.1", "gulp-minify-css": "^1.2.4", "gulp-notify": "^3.0.0", "gulp-postcss": "^7.0.0", "gulp-rename": "^1.2.2", "gulp-ruby-sass": "^2.1.1", "gulp-file-include": "^2.0.0", "gulp-sass": "^3.1.0", "gulp-uglify": "^3.0.0", "gulp-webserver": "^0.9.1", "jshint": "^2.9.5", "postcss-px-to-viewport": "^0.0.3", "postcss-write-svg": "jonathantneal/postcss-write-svg" &#125;&#125; gulpfile.js é…ç½®123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139/** * Created by mac on 2017/11/9. *///å¯¼å…¥å·¥å…·åŒ… require('node_modulesé‡Œå¯¹åº”æ¨¡å—')var gulp = require('gulp'), postcss = require('gulp-postcss'), pxtoviewport = require('postcss-px-to-viewport'),//å°†pxå•ä½æ¢ä½vwå•ä½ sass = require('gulp-sass'),// CSSé¢„å¤„ç†/Sassç¼–è¯‘ autoprefixer = require('gulp-autoprefixer'),//æ·»åŠ å‰ç¼€ minifycss = require('gulp-minify-css'),//æ·»åŠ cssåŽ‹ç¼©æ–‡ä»¶ jshint = require('gulp-jshint'),//jsä»£ç æ ¡æ­£ uglify = require('gulp-uglify'),//jsä»£ç åŽ‹ç¼© imagemin = require('gulp-imagemin'),//å›¾ç‰‡åŽ‹ç¼© rename = require('gulp-rename'),//é‡å‘½å clean = require('gulp-clean'),//æ¸…é™¤åŽŸæ¥æ–‡ä»¶ concat = require('gulp-concat'),//åˆå¹¶æ–‡ä»¶ notify = require('gulp-notify'),//å¤„ç†æŠ¥é”™ cache = require('gulp-cache'),//æ–‡ä»¶å¯¹æ¯” livereload = require('gulp-livereload'),//ç›‘å¬æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œæµè§ˆå™¨è‡ªåŠ¨åˆ·æ–° webserver = require('gulp-webserver'),//å¼€å¯æœåŠ¡å™¨ ghPages = require('gulp-gh-pages'),//README.mdç¼–è¯‘æˆhtml htmlmin = require('gulp-htmlmin'),//htmlåŽ‹ç¼© fileinclude = require('gulp-file-include');//htmlæ¨¡æ¿å¼•æ“Ž// æ ·å¼gulp.task('styles', function() &#123; var processors = [ pxtoviewport(&#123; viewportWidth: 375, viewportUnit: 'vw' &#125;) ]; return gulp.src('src/styles/*.scss') .pipe(sass(&#123; style: 'expanded', &#125;)) .pipe(autoprefixer('last 2 version', 'safari 5', 'ie 8', 'ie 9', 'opera 12.1', 'ios 6', 'android 4')) .pipe(gulp.dest('dist/styles')) .pipe(rename(&#123; suffix: '.min' &#125;)) .pipe(minifycss()) .pipe(gulp.dest('dist/styles')) .pipe(notify(&#123; message: 'Styles task complete' &#125;)) .pipe(postcss(processors)) .pipe(gulp.dest('dist/styles')) .pipe( postcss([ require('postcss-write-svg')(&#123; /* options */ &#125;) ]) ).pipe( gulp.dest('dist/styles') );&#125;);// jsgulp.task('scripts', function() &#123; return gulp.src('src/scripts/*.js') .pipe(jshint.reporter('default'))//æ£€æµ‹jsä»£ç é”™è¯¯ .on('error', function (err) &#123; console.error('Error!', err.message); // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ &#125;) .pipe(rename(&#123; suffix: '.min' &#125;))// é‡å‘½å .pipe(uglify()) .pipe(gulp.dest('dist/scripts')) .pipe(notify(&#123; message: 'Scripts task complete' &#125;));&#125;);// å›¾ç‰‡gulp.task('images', function() &#123; return gulp.src('src/images/*') .pipe(cache(imagemin(&#123; optimizationLevel: 3, progressive: true, interlaced: true &#125;))) // .pipe(imagemin(&#123; // progressive: true, // æ— æŸåŽ‹ç¼©JPGå›¾ç‰‡ // svgoPlugins: [&#123;removeViewBox: false&#125;], // ä¸è¦ç§»é™¤svgçš„viewboxå±žæ€§ // use: [pngquant()] // æ·±åº¦åŽ‹ç¼©PNG // &#125;)) .pipe(gulp.dest('dist/images')) .pipe(notify(&#123; message: 'Images task complete' &#125;));&#125;);//htmlgulp.task('html',function () &#123; return gulp.src('./*.html') .pipe(gulp.dest('./')) .pipe(notify(&#123; message: 'html task complete' &#125;));&#125;);gulp.task('fileinclude', function() &#123; return gulp.src('./*.html') .pipe(fileinclude(&#123; prefix: '@@', basepath: '@file' &#125;)) .pipe(gulp.dest('dist'));&#125;);// æ¸…ç†gulp.task('clean', function() &#123; return gulp.src(['dist/styles', 'dist/scripts', 'dist/images'], &#123;read: false&#125;) .pipe(clean());&#125;);//è‡ªåŠ¨åˆ·æ–°gulp.task('webserver',['fileinclude'],function () &#123; return gulp.src( 'dist/' ) // æœåŠ¡å™¨ç›®å½•ï¼ˆ./ä»£è¡¨æ ¹ç›®å½•ï¼‰ .pipe(webserver(&#123; // è¿è¡Œgulp-webserver livereload: true, // å¯ç”¨LiveReload open: true // æœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨æ‰“å¼€ç½‘é¡µ &#125;));&#125;);// é¢„è®¾ä»»åŠ¡åŠç›‘å¬gulp.task('default', ['webserver'], function() &#123; gulp.run('styles', 'scripts', 'images'); // çœ‹å®ˆæ‰€æœ‰.scssæ¡£ gulp.watch('src/styles/*.scss', ['styles']); // çœ‹å®ˆæ‰€æœ‰.jsæ¡£ gulp.watch('src/scripts/*.js', ['scripts']); // çœ‹å®ˆæ‰€æœ‰å›¾ç‰‡æ¡£ gulp.watch('src/images/*.*', ['images']); //ç›‘å¬æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰htmlæ–‡ä»¶ gulp.watch( '*.html', ['html']); // ç›‘å¬æ ¹ç›®å½•ä¸‹æ‰€æœ‰.htmlæ–‡ä»¶&#125;);gulp.task('deploy', function() &#123; return gulp.src('./dist/**/*') .pipe(ghPages());&#125;);gulp.task('testhtmlmin',function () &#123; var options = &#123; removeComments:true, collapseWhitespace:true, collapseBooleanAttributes:true, removeEmptyAttributes:true, removeScriptTypeAttributes:true, removeStyleLinkTypeAttributes:true, minifyJs:true, minifyCss:true &#125; gulp.src('lemonhotel/*.html') .pipe(htmlmin(options)) .pipe(gulp.dest('html/build'))&#125;);]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Gulp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åªæœ‰20è¡ŒJavascriptä»£ç ï¼æ‰‹æŠŠæ‰‹æ•™ä½ å†™ä¸€ä¸ªé¡µé¢æ¨¡æ¿å¼•æ“Ž]]></title>
    <url>%2F2018%2F02%2F24%2FJs%2F%E5%8F%AA%E6%9C%8920%E8%A1%8CJavascript%E4%BB%A3%E7%A0%81%EF%BC%81%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%86%99%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ 123456789101112131415var TemplateEngine = function(html, options) &#123; var re = /&lt;%([^%&gt;]+)?%&gt;/g, reExp = /(^( )?(if|for|else|switch|case|break|&#123;|&#125;))(.*)?/g, code = 'var r=[];\n', cursor = 0; //æ­£åˆ™æ•èŽ·æ‰€æœ‰ä»¥&lt;%å¼€å¤´ï¼Œä»¥%&gt;ç»“å°¾çš„ç‰‡æ®µ var add = function(line, js) &#123; js? (code += line.match(reExp) ? line + '\n' : 'r.push(' + line + ');\n') : (code += line != '' ? 'r.push("' + line.replace(/"/g, '\\"') + '");\n' : ''); return add; &#125;//ä½¿ç”¨æ¡ä»¶åˆ¤æ–­å’Œå¾ªçŽ¯,å¤æ‚é€»è¾‘ while(match = re.exec(html)) &#123; add(html.slice(cursor, match.index))(match[1], true); cursor = match.index + match[0].length; &#125; add(html.substr(cursor, html.length - cursor)); code += 'return r.join("");';//æŠŠæ‰€æœ‰çš„å­—ç¬¦ä¸²æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œï¼Œåœ¨ç¨‹åºçš„æœ€åŽæŠŠå®ƒä»¬æ‹¼æŽ¥èµ·æ¥ã€‚ return new Function(code.replace(/[\r\t\n]/g, '')).apply(options);//æŠŠåŽŸæœ¬è¿”å›žæ¨¡æ¿å­—ç¬¦ä¸²çš„è¯­å¥æ›¿æ¢æˆå¦‚ä¸‹çš„å†…å®¹&#125;]]></content>
      <categories>
        <category>Js</category>
      </categories>
      <tags>
        <tag>Js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŽHTML5æ—¶ä»£]]></title>
    <url>%2F2018%2F02%2F23%2FHTML5%2F%E5%90%8EHTML5%E6%97%B6%E4%BB%A3%2F</url>
    <content type="text"><![CDATA[HTML5 Device APIåŽŸæ–‡åœ°å€ è®©éŸ³ä¹éšå¿ƒè€ŒåŠ¨ - éŸ³é¢‘å¤„ç† Web audio APIAudioå¯¹è±¡æä¾›çš„åªæ˜¯éŸ³é¢‘æ–‡ä»¶çš„æ’­æ”¾ï¼Œè€ŒWeb Audioåˆ™æ˜¯ç»™äº†å¼€å‘è€…å¯¹éŸ³é¢‘æ•°æ®è¿›è¡Œåˆ†æžã€å¤„ç†çš„èƒ½åŠ›ï¼Œæ¯”å¦‚æ··éŸ³ã€è¿‡æ»¤ã€‚ ç³»ç»Ÿè¦æ±‚ :ios6+ã€android chromeã€android firefox æ ¸å¿ƒä»£ç  : 12345var context = new webkitAudioContext();var source = context.createBufferSource(); // åˆ›å»ºä¸€ä¸ªå£°éŸ³æºsource.buffer = buffer; // å‘Šè¯‰è¯¥æºæ’­æ”¾ä½•ç‰© createBufferSourcesource.connect(context.destination); // å°†è¯¥æºä¸Žç¡¬ä»¶ç›¸è¿žsource.start(0); //æ’­æ”¾ æŠ€æœ¯åˆ†æž : å½“æˆ‘ä»¬åŠ è½½å®ŒéŸ³é¢‘æ•°æ®åŽï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå…¨å±€çš„AudioContextå¯¹è±¡æ¥å¯¹éŸ³é¢‘è¿›è¡Œå¤„ç†ï¼ŒAudioContextå¯ä»¥åˆ›å»ºå„ç§ä¸åŒåŠŸèƒ½ç±»åž‹çš„éŸ³é¢‘èŠ‚ç‚¹AudioNode 1.æºèŠ‚ç‚¹ï¼ˆsource nodeï¼‰1.audioæ ‡ç­¾123456var sound, audio = new Audio();audio.addEventListener('canplay', function() &#123; sound = context.createMediaElementSource(audio); sound.connect(context.destination);&#125;);audio.src = '/audio.mp3'; 2.XMLHttpRequest12345678910111213var sound, context = createAudioContext();var audioURl = '/audio.mp3'; // éŸ³é¢‘æ–‡ä»¶URLvar xhr = new XMLHttpRequest();xhr.open('GET', audioURL, true);xhr.responseType = 'arraybuffer'; xhr.onload = function() &#123; context.decodeAudioData(request.response, function (buffer) &#123; source = context.createBufferSource(); source.buffer = buffer; source.connect(context.destination); &#125;&#125;xhr.send(); 2.åˆ†æžèŠ‚ç‚¹ï¼ˆanalyser nodeï¼‰1234567891011121314var audioCtx = new (window.AudioContext || window.webkitAudioContext)();var analyser = audioCtx.createAnalyser();analyser.fftSize = 2048;var bufferLength = analyser.frequencyBinCount;var dataArray = new Uint8Array(bufferLength);analyser.getByteTimeDomainData(dataArray);function draw() &#123; drawVisual = requestAnimationFrame(draw); analyser.getByteTimeDomainData(dataArray); // å°†dataArrayæ•°æ®ä»¥canvasæ–¹å¼æ¸²æŸ“å‡ºæ¥&#125;;draw(); 3.å¤„ç†èŠ‚ç‚¹ï¼ˆgain nodeã€panner nodeã€wave shaper nodeã€delay nodeã€convolver nodeç­‰ï¼‰ä¸åŒçš„å¤„ç†èŠ‚ç‚¹æœ‰ä¸åŒçš„ä½œç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨BiquadFilterNodeè°ƒæ•´éŸ³è‰²ï¼ˆå¤§é‡æ»¤æ³¢å™¨ï¼‰ã€ä½¿ç”¨ChannelSplitterNodeåˆ†å‰²å·¦å³å£°é“ã€ä½¿ç”¨GainNodeè°ƒæ•´å¢žç›Šå€¼å®žçŽ°éŸ³ä¹æ·¡å…¥æ·¡å‡ºç­‰ç­‰ã€‚éœ€è¦äº†è§£æ›´å¤šçš„éŸ³é¢‘èŠ‚ç‚¹å¯èƒ½å‚è€ƒï¼šhttps://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API 4.ç›®çš„èŠ‚ç‚¹ï¼ˆdestination nodeï¼‰æ‰€æœ‰è¢«æ¸²æŸ“éŸ³é¢‘æµåˆ°è¾¾çš„æœ€ç»ˆåœ°ç‚¹ æ•æ‰ç”¨æˆ·æ‘„åƒå¤´ - åª’ä½“æµ Media Captureé€šè¿‡getUserMediaæ•æ‰ç”¨æˆ·æ‘„åƒå¤´èŽ·å–è§†é¢‘æµå’Œé€šè¿‡éº¦å…‹é£ŽèŽ·å–ç”¨æˆ·å£°éŸ³ã€‚ ç³»ç»Ÿè¦æ±‚ :android chromeã€android firefox æ ¸å¿ƒä»£ç  : 1ã€æ‘„åƒå¤´æ•æ‰123456navigator.webkitGetUserMedia (&#123;video: true&#125;, function(stream) &#123; video.src = window.URL.createObjectURL(stream); localMediaStream = stream;&#125;, function(e)&#123;&#125;) 2ã€ä»Žè§†é¢‘æµä¸­æ‹ç…§1234567btnCapture.addEventListener('touchend', function()&#123; if (localMediaStream) &#123; canvas.setAttribute('width', video.videoWidth); canvas.setAttribute('height', video.videoHeight); ctx.drawImage(video, 0, 0); &#125;&#125;, false); 3ã€ç”¨æˆ·å£°éŸ³å½•åˆ¶12345678910navigator.getUserMedia(&#123;audio:true&#125;, function(e) &#123; context = new audioContext(); audioInput = context.createMediaStreamSource(e); volume = context.createGain(); recorder = context.createScriptProcessor(2048, 2, 2); recorder.onaudioprocess = function(e)&#123; recordingLength += 2048; recorder.connect (context.destination); &#125; &#125;, function(error)&#123;&#125;); 4ã€ä¿å­˜ç”¨æˆ·å½•åˆ¶çš„å£°éŸ³1234var buffer = new ArrayBuffer(44 + interleaved.length * 2);var view = new DataView(buffer);fileReader.readAsDataURL(blob); // android chrome audioä¸æ”¯æŒblobâ€¦ audio.src = event.target.result; ä½ æ˜¯é€—é€¼ï¼Ÿ - è¯­éŸ³è¯†åˆ« Web Speech APIå°†æ–‡æœ¬è½¬æ¢æˆè¯­éŸ³ï¼›å°†è¯­éŸ³è¯†åˆ«ä¸ºæ–‡æœ¬ã€‚ ç³»ç»Ÿè¦æ±‚ :ios7+ï¼Œandroid chromeï¼Œandroid firefox æ ¸å¿ƒä»£ç  : 1ã€æ–‡æœ¬è½¬æ¢æˆè¯­éŸ³ï¼Œä½¿ç”¨SpeechSynthesisUtteranceå¯¹è±¡.123456var msg = new SpeechSynthesisUtterance();var voices = window.speechSynthesis.getVoices();msg.volume = 1; // 0 to 1msg.text = â€˜è¯†åˆ«çš„æ–‡æœ¬å†…å®¹â€™;msg.lang = 'en-US';speechSynthesis.speak(msg); 2ã€è¯­éŸ³è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œä½¿ç”¨SpeechRecognitionå¯¹è±¡.12345678var newRecognition = new webkitSpeechRecognition();newRecognition.onresult = function(event)&#123; var interim_transcript = ''; for (var i = event.resultIndex; i &lt; event.results.length; ++i) &#123; final_transcript += event.results[i][0].transcript; &#125;&#125;; æµ‹è¯•ç»“è®ºï¼šAndroidæ”¯æŒä¸ç¨³å®šï¼›è¯­éŸ³è¯†åˆ«æµ‹è¯•å¤±è´¥ï¼ˆæš‚ä¸”è®¤ä¸ºæ˜¯æŸäº›å†…ç½®æŽ¥å£è¢«å¢™æ‰€è‡´ï¼‰ã€‚ è®©æˆ‘å°½æƒ…å‘µæŠ¤ä½  - è®¾å¤‡ç”µé‡ Battery APIæŸ¥è¯¢ç”¨æˆ·è®¾å¤‡ç”µé‡åŠæ˜¯å¦æ­£åœ¨å……ç”µã€‚ ç³»ç»Ÿè¦æ±‚ :android firefox æ ¸å¿ƒä»£ç  ï¼š12345678910111213var battery = navigator.battery || navigator.webkitBattery || navigator.mozBattery || navigator.msBattery;var str = '';if (battery) &#123; str += '&lt;p&gt;ä½ çš„æµè§ˆå™¨æ”¯æŒHTML5 Battery API&lt;/p&gt;'; if(battery.charging) &#123; str += '&lt;p&gt;ä½ çš„è®¾å¤‡æ­£åœ¨å……ç”µ&lt;/p&gt;';&#125; else &#123; str += '&lt;p&gt;ä½ çš„è®¾å¤‡æœªå¤„äºŽå……ç”µçŠ¶æ€&lt;/p&gt;';&#125; str += '&lt;p&gt;ä½ çš„è®¾å¤‡å‰©ä½™'+ parseInt(battery.level*100)+'%çš„ç”µé‡&lt;/p&gt;';&#125; else &#123; str += '&lt;p&gt;ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒHTML5 Battery API&lt;/p&gt;';&#125; æµ‹è¯•ç»“è®º ï¼š1ã€QQæµè§ˆå™¨ä¸ŽUCæµè§ˆå™¨æ”¯æŒè¯¥æŽ¥å£ï¼Œä½†æœªæ­£ç¡®æ˜¾ç¤ºè®¾å¤‡ç”µæ± ä¿¡æ¯ï¼›2ã€caniuseæ˜¾ç¤ºandroid chrome42æ”¯æŒè¯¥æŽ¥å£ï¼Œå®žæµ‹ä¸æ”¯æŒã€‚ èŽ·å–ç”¨æˆ·ä½ç½® - åœ°ç†ä½ç½® Geolocation APIGeolocation APIç”¨äºŽå°†ç”¨æˆ·å½“å‰åœ°ç†ä½ç½®ä¿¡æ¯å…±äº«ç»™ä¿¡ä»»çš„ç«™ç‚¹ï¼Œç›®å‰ä¸»æµç§»åŠ¨è®¾å¤‡éƒ½èƒ½å¤Ÿæ”¯æŒã€‚ ç³»ç»Ÿè¦æ±‚ :ios6+ã€android2.3+ æ ¸å¿ƒä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546var domInfo = $("#info");// èŽ·å–ä½ç½®åæ ‡if (navigator.geolocation) &#123; navigator.geolocation.getCurrentPosition(showPosition,showError);&#125;else&#123; domInfo.innerHTML="æŠ±æ­‰ï¼Œä½ çš„æµè§ˆå™¨ä¸æ”¯æŒåœ°ç†å®šä½ï¼";&#125;// ä½¿ç”¨è…¾è®¯åœ°å›¾æ˜¾ç¤ºä½ç½®function showPosition(position) &#123; var lat=position.coords.latitude; var lon=position.coords.longitude; mapholder = $('#mapholder') mapholder.style.height='250px'; mapholder.style.width = document.documentElement.clientWidth + 'px'; var center = new soso.maps.LatLng(lat, lon); var map = new soso.maps.Map(mapholder,&#123; center: center, zoomLevel: 13 &#125;); var geolocation = new soso.maps.Geolocation(); var marker = null; geolocation.position(&#123;&#125;, function(results, status) &#123; console.log(results); var city = $("#info"); if (status == soso.maps.GeolocationStatus.OK) &#123; map.setCenter(results.latLng); domInfo.innerHTML = 'ä½ å½“å‰æ‰€åœ¨åŸŽå¸‚: ' + results.name; if (marker != null) &#123; marker.setMap(null); &#125; // è®¾ç½®æ ‡è®° marker = new soso.maps.Marker(&#123; map: map, position:results.latLng &#125;); &#125; else &#123; alert("æ£€ç´¢æ²¡æœ‰ç»“æžœï¼ŒåŽŸå› : " + status); &#125; &#125;);&#125; æµ‹è¯•ç»“è®ºï¼š 1ã€Geolocation APIçš„ä½ç½®ä¿¡æ¯æ¥æºåŒ…æ‹¬GPSã€IPåœ°å€ã€RFIDã€WIFIå’Œè“ç‰™çš„MACåœ°å€ã€ä»¥åŠGSM/CDMSçš„IDç­‰ç­‰ã€‚è§„èŒƒä¸­æ²¡æœ‰è§„å®šä½¿ç”¨è¿™äº›è®¾å¤‡çš„å…ˆåŽé¡ºåºã€‚2ã€åˆæµ‹3gçŽ¯å¢ƒä¸‹æ¯”wifiçŽ¯å¢ƒç†å®šä½æ›´å‡†ç¡®ï¼›3ã€æµ‹è¯•ä¸‰æ˜Ÿ GT-S6358(android2.3) geolocationå­˜åœ¨ï¼Œä½†æ˜¾ç¤ºä½ç½®ä¿¡æ¯ä¸å¯ç”¨POSITION_UNAVAILABLEã€‚ æŠŠç”¨æˆ·æ§åœ¨æ‰‹å¿ƒ - çŽ¯å¢ƒå…‰ Ambient Light APIAmbient Light APIå®šä¹‰äº†ä¸€äº›äº‹ä»¶ï¼Œè¿™äº›æ—¶é—´å¯ä»¥æä¾›æºäºŽå‘¨å›´å…‰äº®ç¨‹åº¦çš„ä¿¡æ¯ï¼Œè¿™é€šå¸¸æ˜¯ç”±è®¾å¤‡çš„å…‰æ„Ÿåº”å™¨æ¥æµ‹é‡çš„ã€‚è®¾å¤‡çš„å…‰æ„Ÿåº”å™¨ä¼šæå–å‡ºè¾‰åº¦ä¿¡æ¯ã€‚ ç³»ç»Ÿè¦æ±‚ :android firefox æ ¸å¿ƒä»£ç ï¼šè¿™æ®µä»£ç å®žçŽ°æ„Ÿåº”ç”¨å‰å½“å‰çŽ¯å¢ƒå…‰å¼ºåº¦ï¼Œè°ƒæ•´ç½‘é¡µèƒŒæ™¯å’Œæ–‡å­—é¢œè‰²ã€‚ 12345678910111213141516var domInfo = $('#info');if (!('ondevicelight' in window)) &#123; domInfo.innerHTML = 'ä½ çš„è®¾å¤‡ä¸æ”¯æŒçŽ¯å¢ƒå…‰Ambient Light API';&#125; else &#123; var lightValue = document.getElementById('dl-value'); window.addEventListener('devicelight', function(event) &#123; domInfo.innerHTML = 'å½“å‰çŽ¯å¢ƒå…‰çº¿å¼ºåº¦ä¸ºï¼š' + Math.round(event.value) + 'lux'; var backgroundColor = 'rgba(0,0,0,'+(1-event.value/100) +')'; document.body.style.backgroundColor = backgroundColor; if(event.value &lt; 50) &#123; document.body.style.color = '#fff' &#125; else &#123; document.body.style.color = '#000' &#125; &#125;);&#125; é™€èžºä»ª Deviceorientationè£…é€¼è¯´æ³•ï¼šè®¾å¤‡ç§»åŠ¨ä¼ æ„Ÿå™¨ã€‚ é€šä¿—è¯´æ³•ï¼šæ£€æµ‹è®¾å¤‡è¿åŠ¨åŠè¿åŠ¨çŠ¶å†µï¼Œå¯ä»¥é€šè¿‡è¯¥æŽ¥å£èŽ·å–åˆ°è®¾å¤‡è¿åŠ¨çš„æ–¹å‘å’Œé€Ÿåº¦ç­‰ç›¸å…³ä¿¡æ¯ æ ¸å¿ƒä»£ç  :è¿™è´§å…¶å®žå°±æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œç®€å•åœ°é€šè¿‡äº‹ä»¶ç›‘å¬å°±å¯ä»¥èŽ·å–åˆ°ç›¸å…³çš„è®¾å¤‡è¿åŠ¨ä¿¡æ¯1window.addEventListener("devicemotion", function(event) &#123;&#125;, false); æœ€ç®€å•çš„è®¾å¤‡è¿åŠ¨ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥è®¤ä¸ºæ˜¯å‰åŽã€å·¦å³ã€ä¸Šä¸‹è¿™ä¹ˆ6ä¸ªæ–¹å‘ä¸Šçš„ï¼Œè£…æ¢æˆ3DçŽ¯å¢ƒä¸­æ¥è®²çš„è¯ï¼Œå°±æ˜¯åœ¨xã€yå’Œzè½´ä¸Šè¿åŠ¨ï¼Œè¿™ä¸‰ä¸ªè½´ä¸Šçš„ä¿¡æ¯ï¼Œéƒ½åŒ…å«åœ¨äº†eventå¯¹è±¡ä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼èŽ·å¾— 1234567window.addEventListener("devicemotion", function(event) &#123; var eventacceleration = event.acceleration; document.querySelector('#devicemotion').innerHTML = "acceleration:&lt;br&gt;"+ eventacceleration.x+"&lt;br&gt;"+ eventacceleration.y+"&lt;br&gt;"+ eventacceleration.z&#125;, false); ä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆæ‰‹æœºèººåœ¨æ¡Œé¢ä¸Šï¼Œä¸Šé¢çš„æ•°å­—è¿˜åœ¨ä¸åœåœ°æŠ–åŠ¨ï¼Œå’±ä»¬æ–‡åŒ–äººåº”è¯¥éƒ½çŸ¥é“ä»€ä¹ˆå«ç›¸å¯¹é™æ­¢ã€‚ä¸Šé¢çš„ä¸‰ä¸ªä¸æ–­å˜åŒ–çš„æ•°å­—ï¼Œå°±æ˜¯ä½ è®¾å¤‡çš„è¿åŠ¨æ•°æ®äº†ã€‚å¦‚æžœä½ åœ¨æƒŠè®¶ä¸ºä»€ä¹ˆæˆ‘éƒ½å·²ç»ç§»åŠ¨è¿‡æ‰‹æœºï¼Œä¸ºä»€ä¹ˆä¸Šé¢çš„æ•°å­—è²Œä¼¼ä¹Ÿæ²¡ä»€ä¹ˆå¤§çš„å˜åŒ–~é‚£ä¹ˆæˆ‘ä¼šå‘Šè¯‰ä½ è¯´ï¼šæœ‰æœ¬äº‹ä½ çš„çœ¼ç›è·Ÿç€ä½ çš„æ‰‹æœºä¸€æ ·å¿«é€Ÿç§»åŠ¨å•Šï¼Œè¿åŠ¨è¿‡ç¨‹ä¸­ä½ å°±èƒ½å‘çŽ°è¿™ä¸ªå€¼çš„å˜åŒ–äº†ã€‚æ²¡æœ‰è¿™ä¸ªæœ¬äº‹å§ï¼~è‡ªå·±å°è¯•ä¿®æ”¹ä¸‹é‚£ä¸ªdemoã€‚æŠŠè¿åŠ¨ä¸­å€¼çš„å˜åŒ–éƒ½è®°å½•ä¸‹æ¥çœ‹çœ‹ã€‚ã€‚ã€‚ï¼ˆPSï¼šåæ­£æˆ‘ä¸å¼„ã€‚ï¼‰ è¿˜æœ‰ä¸€ç§æ¯”è¾ƒç†æƒ³çš„è®¾å¤‡è¿åŠ¨æ–¹å¼å°±æ˜¯ä¸äº§ç”Ÿä½ç§»ï¼Œåªæ˜¯å¿«é€Ÿçš„æ—‹è½¬æ‰‹æœºã€‚è¿™ä¸ªæ—‹è½¬çš„ä¿¡æ¯åŒæ ·ä¹Ÿè¢«åé¦ˆåœ¨äº†eventå¯¹è±¡ä¸­ 1234567window.addEventListener("devicemotion", function(event) &#123; eventrotationRate = event.rotationRate; document.querySelector('#devicemotion').innerHTML = 'rotationRate:&lt;br&gt;'+ eventrotationRate.alpha+'&lt;br&gt;'+ eventrotationRate.beta+"&lt;br&gt;"+ eventrotationRate.gamma&#125;, false); å¯èƒ½æœ‰çš„ç«¥éž‹ä¼šè§‰å¾—~æœ‰äº†è¿™ä¸ªæ—‹è½¬åº”è¯¥å°±èƒ½å®žçŽ°ä¸€äº›æ‰‹æœºå·¦å³æ—‹è½¬äº§ç”Ÿè§†å·®çš„æ•ˆæžœäº†ï¼Œå…¶å®žæ˜¯ä¸è¡Œçš„~å› ä¸ºè¿™è´§å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œè®¾å¤‡åœæ­¢åŽï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºä»–çš„å€¼å½’0~ã€‚çœŸæ­£æƒ³è¦å®žçŽ°æ‰‹æœºæ—‹è½¬è§†å·®ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„å°±æ˜¯å¦å¤–ä¸€ä¸ªeventçš„å±žæ€§accelerationIncludingGravityã€‚ä»Žå­—é¢ä¸Šç†è§£è¿™ä¸ªå±žæ€§å°±æ˜¯é‡åŠ›åŠ é€Ÿåº¦ã€‚1234567window.addEventListener("devicemotion", function(event) &#123; eventaccelerationIncludingGravity = event.accelerationIncludingGravity; document.querySelector('#devicemotion').innerHTML = "accelerationIncludingGravity:&lt;br&gt;"+ eventaccelerationIncludingGravity.x+"&lt;br&gt;"+ eventaccelerationIncludingGravity.y+"&lt;br&gt;"+ eventaccelerationIncludingGravity.z&#125;, false); å…¶å®žï¼Œdevicemotionè¿˜æœ‰ä¸€ä¸ªå¥½åŸºå‹ï¼Œè¿™é‡Œä¹ŸæŽ¨èç»™å¤§å®¶çœ‹ä¸€çœ¼å§ï¼š deviceorientationè¿™ä¸ªäº‹ä»¶å’Œdevicemotionçš„ä½¿ç”¨æ–¹æ³•åŸºæœ¬ä¸€è‡´123456window.addEventListener("deviceorientation", function(event) &#123; document.querySelector('#deviceorientation').innerHTML = event.alpha+'&lt;br&gt;'+ event.beta+"&lt;br&gt;"+ event.gamma+'&lt;br&gt;';&#125;, false); æœ‰å‰é¢devicemotionå¥½åŸºå‹çš„å¸®å¿™ï¼Œä¼¼ä¹Žèƒ½åšçš„ä¸œè¥¿åˆå¯ä»¥æ›´å¤šä¸€ç‚¹äº†ã€‚å’±ä»¬å‰é¢è²Œä¼¼æåŠè¿‡&ldquo;å–å‰æ‘‡ä¸€æ‘‡&rdquo;ã€‚æ‘‡å®Œä¹‹åŽï¼Œè‡ªç„¶æ˜¯è¦æ‰“å¼€ç“¶ç›–ç—›é¥®ä¸€ç•ªäº†ï¼Œç»“åˆæ—‹è½¬åŠ é€Ÿåº¦ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥å°è¯•äº›ä¸€ä¸ªæ‹§ç“¶ç›–æ¯”èµ›çš„æ¸¸æˆäº†ï¼Ÿæ€•é•¿èƒ–ï¼Ÿè¦ä¸ï¼Œæ‹§ä¸ªèžºä¸é’‰ä¹Ÿè¡Œã€‚ Websocketæµè§ˆå™¨ä¸ŽæœåŠ¡å™¨å…¨åŒå·¥é€šä¿¡(full-duplex)ã€‚ æ ¸å¿ƒä»£ç  ï¼š 12345678910var ws = new WebSocket('ws://127.0.0.1:8808/');//å»ºç«‹æœåŠ¡å™¨è¿žæŽ¥ws.onopen = function()&#123; systemInfo.innerHTML = '&lt;p&gt;å’ŒwebsocketæœåŠ¡å™¨è¿žæŽ¥æˆåŠŸ&lt;/p&gt;';&#125;//æŽ¥æ”¶åˆ°æœåŠ¡å™¨è¿”å›žçš„æ•°æ®ws.onmessage = function(e)&#123; systemInfo.innerHTML += '&lt;p&gt;'+e.data+'&lt;/p&gt;';&#125;//æ–­å¼€æœåŠ¡å™¨è¿žæŽ¥ws.onclose = function()&#123; systemInfo.innerHTML += '&lt;p&gt;WebSocketæœåŠ¡å™¨è¿žæŽ¥å…³é—­&lt;/p&gt;';&#125;//wså‘ç”Ÿé”™è¯¯ws.onerror = function(e)&#123; console.log(e); systemInfo.innerHTML += '&lt;p&gt;WebSocketå‘ç”Ÿé”™è¯¯&lt;/p&gt;';&#125; æˆ‘ä»¬å¯ä»¥é€šè¿‡äº‹ä»¶çš„ç›‘å¬ï¼ŒåŽ»å®žæ—¶èŽ·å–åˆ°ç½‘ç»œçŠ¶æ€çš„å˜åŒ– 12window.addEventListener('offline', function(e) &#123;alert('offline');&#125;)window.addEventListener('online', function(e) &#123;alert('online');&#125;) NFCè¿‘åœºé€šä¿¡/è¿‘è·ç¦»æ— çº¿é€šä¿¡æŠ€æœ¯ã€‚ å…¶å®žè¯´å®žåœ¨çš„ï¼Œè¿™ä¸ªåŠŸèƒ½æˆ‘å¹¶æ²¡æœ‰åœ¨æˆ‘çš„é¡µé¢é‡Œé¢è°ƒè¯•å‡ºæ¥ã€‚ä¸»è¦çš„ä¸€ä¸ªåŽŸå› æ˜¯~è¿™è´§ç›®å‰åªæ˜¯åœ¨firefox osç³»ç»Ÿé‡Œé¢çš„firefoxæµè§ˆå™¨é‡Œé¢å®žçŽ°äº†ï¼Œæ‰‹å¤´ä¸Šæ²¡è¿™è®¾å¤‡ã€‚ä¸è¿‡ä»Žä»–ä»¬å®˜ç½‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘å¤§æ¦‚åœ°å¯ä»¥æ„Ÿå—å¾—åˆ°è¿™è´§çš„å¥½ç”¨ï¼Œæœ‰å…´è¶£çš„åŒå­¦è‡ªè¡Œå‰å¾€å­¦ä¹ ï¼š[https://developer.mozilla.org/en-US/docs/Web/API/NFC_API/Using_the_NFC_API]https://developer.mozilla.org/en-US/docs/Web/API/NFC_API/Using_the_NFC_API. éœ‡åŠ¨ - Vibration APIè®¾å¤‡éœ‡åŠ¨ æ ¸å¿ƒä»£ç  :1234navigator.vibrate = navigator.vibrate || navigator.webkitVibrate || navigator.mozVibrate || navigator.msVibrate;navigator.vibrate(value);navigator.vibrate(0); vibrateçš„å‚æ•°ä¸ºéœ‡åŠ¨çš„æ—¶é—´ï¼Œ å¦‚æžœå€¼ä¸º0ï¼Œè¯´æ˜Žåœæ­¢éœ‡åŠ¨ å€¼ä¸ºä¸€ä¸ªæ•°ç»„çš„è¯ï¼Œå¥‡æ•°é¡¹è¡¨ç¤ºçš„æ˜¯éœ‡åŠ¨æ—¶é—´ï¼Œå¶æ•°é¡¹è¡¨ç¤ºçš„ä¸ºé—´éš”æ—¶é—´ã€‚ æ¯”å¦‚ï¼švibrate(1000,1000,2000) å°±æ˜¯è¡¨ç¤ºéœ‡åŠ¨1ç§’ä¹‹åŽæš‚åœ1ç§’ï¼Œå†éœ‡åŠ¨2ç§’ ç½‘ç»œçŽ¯å¢ƒ Connection API]]></content>
      <categories>
        <category>HTML5</category>
      </categories>
      <tags>
        <tag>HTML5</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react-native UIç»„ä»¶]]></title>
    <url>%2F2018%2F02%2F11%2Freact-native%2Freact-native%20Components%2F</url>
    <content type="text"><![CDATA[React-native Components(è‡ªå·±ç†è§£)react-native å®˜ç½‘react-native ä¸­æ–‡å®˜ç½‘ 1.ActivityIndicator æ˜¾ç¤ºä¸€ä¸ªåœ†å½¢çš„loadingæç¤ºç¬¦å·ã€‚2.Button æŒ‰é’®3.DataPickerIOS iosæ—¥æœŸé€‰æ‹©ç»„ä»¶4.DrawerLayoutAndriod andriodæŠ½å±‰å¯¼èˆª5.FlatList é«˜æ€§èƒ½ç®€å•åˆ—è¡¨ç»„ä»¶6.Image å›¾ç‰‡ç»„ä»¶7.KeybordAvoiding View æ‰‹æœºä¸Šå¼¹å‡ºçš„é”®ç›˜å¸¸å¸¸ä¼šæŒ¡ä½å½“å‰çš„è§†å›¾ã€‚æœ¬ç»„ä»¶å¯ä»¥è‡ªåŠ¨æ ¹æ®é”®ç›˜çš„ä½ç½®ï¼Œè°ƒæ•´è‡ªèº«çš„positionæˆ–åº•éƒ¨çš„paddingï¼Œä»¥é¿å…è¢«é®æŒ¡8.ListView æ­¤ç»„ä»¶å·²è¿‡æœŸ è¯·ç”¨selection æˆ– FlatLIst æ›¿æ¢9.MaskedViewIOS é®ç½©æ¸²æŸ“å­è§†å›¾ï¼ˆæ·»åŠ ç‚«é…·çš„èƒŒæ™¯ï¼‰10.Modal Modalç»„ä»¶å¯ä»¥ç”¨æ¥è¦†ç›–åŒ…å«React Nativeæ ¹è§†å›¾çš„åŽŸç”Ÿè§†å›¾ (å¯ç”¨ä½œå¼¹æ¡†é®ç½©)11.NavigatorIOS IOS å¯¼èˆªè®¾ç½®12.Picker æ¸²æŸ“åŽŸç”Ÿçš„é€‰æ‹©å™¨ï¼ˆç±»ä¼¼æ»šåŠ¨åœ°å€é€‰æ‹©ï¼‰13.PickerIOS IOSé€‰æ‹©å™¨14.ProgressBarAndroid å®‰å“loadingå›¾æ ‡15.ProgressViewIOS IOSè¿›åº¦æ¡16.RefreshControl è¿™ä¸€ç»„ä»¶å¯ä»¥ç”¨åœ¨ScrollViewæˆ–ListViewå†…éƒ¨ï¼Œä¸ºå…¶æ·»åŠ ä¸‹æ‹‰åˆ·æ–°çš„åŠŸèƒ½ã€‚å½“ScrollViewå¤„äºŽç«–ç›´æ–¹å‘çš„èµ·ç‚¹ä½ç½®ï¼ˆscrollY: 0ï¼‰ï¼Œæ­¤æ—¶ä¸‹æ‹‰ä¼šè§¦å‘ä¸€ä¸ªonRefreshäº‹ä»¶ã€‚17.ScrollView æ»šåŠ¨è§†å›¾åˆ—è¡¨18.sectionList åˆ†ç»„åˆ—è¡¨(ä¾‹å¦‚ç”µè¯æœ¬çš„åˆ—è¡¨)19.SegmentedControlIOS IOSåˆ†æ®µé€‰æ‹©å™¨20.Slider ç”¨äºŽé€‰æ‹©ä¸€ä¸ªèŒƒå›´å€¼çš„ç»„ä»¶ã€‚ï¼ˆä¾‹å¦‚é€‰æ‹©éŸ³é‡çš„barï¼‰21.SnapshotViewIOS IOSæˆªå›¾22.StatusBar ç”¨äºŽæŽ§åˆ¶åº”ç”¨çŠ¶æ€æ çš„ç»„ä»¶ã€‚23.Switch å¼€å…³æŒ‰é’®24.TabBarIOS å¸¦IOSæˆ–AndroidåŽç¼€çš„ç»„ä»¶(åº•éƒ¨å¯¼èˆªåŠ)25.TabBarIOS.Item ï¼ˆåº•éƒ¨å¯¼èˆªçš„æ–°æ¶ˆæ¯é€šçŸ¥æ•°é‡ï¼‰26.Text æ–‡æœ¬æ ‡ç­¾27.TextInput æ–‡æœ¬è¾“å…¥æ¡†28.ToolbarAndroid ä¸€ä¸ªToolbarå¯ä»¥æ˜¾ç¤ºä¸€ä¸ªå¾½æ ‡ï¼Œä¸€ä¸ªå¯¼èˆªå›¾æ ‡ï¼ˆè­¬å¦‚æ±‰å ¡å½¢çŠ¶çš„èœå•æŒ‰é’®ï¼‰ï¼Œä¸€ä¸ªæ ‡é¢˜ä¸Žå‰¯æ ‡é¢˜ï¼Œä»¥åŠä¸€ä¸ªåŠŸèƒ½åˆ—è¡¨ã€‚29.TouchableHighlight æœ¬ç»„ä»¶ç”¨äºŽå°è£…è§†å›¾ï¼Œä½¿å…¶å¯ä»¥æ­£ç¡®å“åº”è§¦æ‘¸æ“ä½œã€‚å½“æŒ‰ä¸‹çš„æ—¶å€™ï¼Œå°è£…çš„è§†å›¾çš„ä¸é€æ˜Žåº¦ä¼šé™ä½Žï¼ŒåŒæ—¶ä¼šæœ‰ä¸€ä¸ªåº•å±‚çš„é¢œè‰²é€è¿‡è€Œè¢«ç”¨æˆ·çœ‹åˆ°ï¼Œä½¿å¾—è§†å›¾å˜æš—æˆ–å˜äº®ã€‚30.TouchableWithoutFeedback å“åº”ç”¨æˆ·çš„ç‚¹å‡»äº‹ä»¶ï¼Œå¦‚æžœä½ æƒ³åœ¨å¤„ç†ç‚¹å‡»äº‹ä»¶çš„åŒæ—¶ä¸æ˜¾ç¤ºä»»ä½•è§†è§‰åé¦ˆï¼Œä½¿ç”¨å®ƒæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚31. TouchableOpacity ç›¸æ¯”TouchableHighlightåœ¨æŒ‰ä¸‹åŽ»ä¼šä½¿èƒŒæ™¯å˜æš—çš„æ•ˆæžœï¼ŒTouchableOpacityä¼šåœ¨ç”¨æˆ·æ‰‹æŒ‡æŒ‰ä¸‹æ—¶é™ä½ŽæŒ‰é’®çš„é€æ˜Žåº¦ï¼Œè€Œä¸ä¼šæ”¹å˜èƒŒæ™¯çš„é¢œè‰²32.TouchableNativeFeedback å®ƒä¼šåœ¨ç”¨æˆ·æ‰‹æŒ‡æŒ‰ä¸‹æ—¶å½¢æˆç±»ä¼¼æ°´æ³¢çº¹çš„è§†è§‰æ•ˆæžœã€‚æ³¨æ„ï¼Œæ­¤ç»„ä»¶åªæ”¯æŒAndroidã€‚33.View å‘ˆçŽ°çš„è§†å›¾34.ViewPagerAndroid ä¸€ä¸ªå…è®¸åœ¨å­è§†å›¾ä¹‹é—´å·¦å³ç¿»é¡µçš„å®¹å™¨ã€‚æ¯ä¸€ä¸ªViewPagerAndroidçš„å­å®¹å™¨ä¼šè¢«è§†ä½œä¸€ä¸ªå•ç‹¬çš„é¡µï¼Œå¹¶ä¸”ä¼šè¢«æ‹‰ä¼¸å¡«æ»¡ViewPagerAndroidã€‚ï¼ˆæ³¨æ„æ‰€æœ‰çš„å­è§†å›¾éƒ½å¿…é¡»æ˜¯çº¯Viewï¼‰35.VirtualizedList FlatList and SectionList çš„åº•å±‚å®žçŽ°ã€‚ é€šè¿‡ç»´æŠ¤ä¸€ä¸ªæœ‰é™çš„æ¸²æŸ“çª—å£ï¼ˆå…¶ä¸­åŒ…å«å¯è§çš„å…ƒç´ ï¼‰ï¼Œå¹¶å°†æ¸²æŸ“çª—å£ä¹‹å¤–çš„å…ƒç´ å…¨éƒ¨ç”¨åˆé€‚çš„å®šé•¿ç©ºç™½ç©ºé—´ä»£æ›¿çš„æ–¹å¼ï¼Œæžå¤§çš„æ”¹å–„äº†å†…å­˜æ¶ˆè€—ä»¥åŠåœ¨æœ‰å¤§é‡æ•°æ®æƒ…å†µä¸‹çš„ä½¿ç”¨æ€§èƒ½ã€‚36.WebView ç”¨äºŽåŒ…è£¹htmlçš„æ ‡ç­¾ ï¼ˆ1.ç½‘å€ 2.å¼•ç”¨è·¯å¾„ 3.ç›´æŽ¥å†™htmlï¼‰]]></content>
      <categories>
        <category>react-native</category>
      </categories>
      <tags>
        <tag>react-native</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-native API]]></title>
    <url>%2F2018%2F02%2F11%2Freact-native%2FReact-native-API%2F</url>
    <content type="text"><![CDATA[React-native API(è‡ªå·±ç†è§£)æœ€è¿‘åœ¨å­¦ä¹ react-native,è€Œä¸”é‡æ–°åˆ©ç”¨hexo æž„å»ºäº†è‡ªå·±çš„ä¸»é¡µã€‚ ä¹‹å‰ä¹Ÿåœ¨csdn,ç®€ä¹¦ä¹Ÿå†™è¿‡åšå®¢ï¼Œæ‰“ç®—åˆ©ç”¨ç©ºé—²æ—¶é—´æŠŠåšå®¢è¿ç§»è¿›æ¥ã€‚ è¿›å…¥ä¸»é¢˜å§ã€‚react-native å®˜ç½‘react-native ä¸­æ–‡å®˜ç½‘ 1.AccessibilityInfo æ— éšœç¢åŠŸèƒ½ ç»™æ®‹éšœäººå£«ä½¿ç”¨ 2.ActionSheetIOS IOSåº•éƒ¨å¼¹å‡ºé€‰æ‹©æ¡† ï¼ˆåˆ†äº«ï¼Œé€‰æ‹©ï¼‰ 3.Alert è°ƒç”¨æ‰‹æœºåŽŸç”Ÿå¼¹æ¡† 4.AlertIOS å¯åŠ¨ä¸€ä¸ªæç¤ºå¯¹è¯æ¡†ï¼ŒåŒ…å«å¯¹åº”çš„æ ‡é¢˜å’Œä¿¡æ¯ã€‚ 5.Animated Animatedåº“ä½¿å¾—å¼€å‘è€…å¯ä»¥éžå¸¸å®¹æ˜“åœ°å®žçŽ°å„ç§å„æ ·çš„åŠ¨ç”»å’Œäº¤äº’æ–¹å¼ï¼Œå¹¶ä¸”å…·å¤‡æžé«˜çš„æ€§èƒ½ 6.AppRegistry AppRegistryæ˜¯JSè¿è¡Œæ‰€æœ‰React Nativeåº”ç”¨çš„å…¥å£ã€‚ 7.AppState AppStateèƒ½å‘Šè¯‰ä½ åº”ç”¨å½“å‰æ˜¯åœ¨å‰å°è¿˜æ˜¯åœ¨åŽå°ï¼Œå¹¶ä¸”èƒ½åœ¨çŠ¶æ€å˜åŒ–çš„æ—¶å€™é€šçŸ¥ä½ ã€‚AppStateé€šå¸¸åœ¨å¤„ç†æŽ¨é€é€šçŸ¥çš„æ—¶å€™ç”¨æ¥å†³å®šå†…å®¹å’Œå¯¹åº”çš„è¡Œä¸ºã€‚ 8.AsyncStorage AsyncStorageæ˜¯ä¸€ä¸ªç®€å•çš„ã€å¼‚æ­¥çš„ã€æŒä¹…åŒ–çš„Key-Valueå­˜å‚¨ç³»ç»Ÿï¼Œå®ƒå¯¹äºŽAppæ¥è¯´æ˜¯å…¨å±€æ€§çš„ã€‚å®ƒç”¨æ¥ä»£æ›¿LocalStorageã€‚(react-native-storageæ¨¡å—ï¼Œæä¾›äº†è¾ƒå¤šä¾¿åˆ©åŠŸèƒ½ã€‚) 9.BackHandler ç›‘å¬è®¾å¤‡ä¸Šçš„åŽé€€æŒ‰é’®äº‹ä»¶ã€‚(ä»…é™å®‰å“) 10.CameraRoll CameraRollæ¨¡å—æä¾›äº†è®¿é—®æœ¬åœ°ç›¸å†Œçš„åŠŸèƒ½ 11.Clipboard Clipboardç»„ä»¶å¯ä»¥åœ¨iOSå’ŒAndroidçš„å‰ªè´´æ¿ä¸­è¯»å†™å†…å®¹ã€‚ 12.DatePickerAndroid ä¸€ä¸ªæ ‡å‡†çš„Androidæ—¥æœŸé€‰æ‹©å™¨çš„å¯¹è¯æ¡†ã€‚ 13.Dimensions ç”¨äºŽèŽ·å–è®¾å¤‡å±å¹•çš„å®½é«˜ã€‚ 14.Easing ç”¨äºŽåŠ¨ç”»å¹…åº¦ 15.Geolocation è¯·æ±‚è®¿é—®åœ°ç†ä½ç½®çš„æƒé™ 16.ImageEditor æ ¹æ®æŒ‡å®šçš„URIå‚æ•°å‰ªè£å¯¹åº”çš„å›¾ç‰‡ 17.ImagePickerIOS ä¸€ä¸ªèŽ·å–å›¾ç‰‡çš„ APIï¼ˆé¡»ç™¾åº¦è¯¦æƒ…ï¼‰ 18.ImageStore å›¾ç‰‡ç¼“å­˜åº“ 19.Image Style Props å¯è®¾ç½®å›¾ç‰‡çš„å±žæ€§æ ·å¼ 20.InteractionManager æå‡ç”¨æˆ·ä½“éªŒå’Œäº¤äº’æ•ˆæžœçš„æ¨¡å—InteractionMnager(äº¤äº’ç®¡ç†å™¨) ä½¿ç”¨InteractionManagerå¯ä»¥è®©ä¸€äº›è€—æ—¶çš„ä»»åŠ¡åœ¨äº¤äº’æ“ä½œæˆ–è€…åŠ¨ç”»å®Œæˆä¹‹åŽè¿›è¡Œæ‰§è¡Œï¼Œè¿™æ ·ä½¿ç”¨å¯ä»¥ä¿è¯æˆ‘ä»¬çš„JavaScriptçš„åŠ¨ç”»æ•ˆæžœå¯ä»¥å¹³æ»‘æµç•…çš„æ‰§è¡Œã€‚å¯ä»¥å¤§å¤§æå‡ç”¨æˆ·ä½“éªŒã€‚ï¼ˆç™¾åº¦è¯¦æƒ…ï¼‰ 21.Keyboard Keyboardç»„ä»¶å¯ä»¥ç”¨æ¥æŽ§åˆ¶é”®ç›˜ç›¸å…³çš„äº‹ä»¶ã€‚ 22.LayoutAnimation å½“å¸ƒå±€å˜åŒ–æ—¶ï¼Œè‡ªåŠ¨å°†è§†å›¾è¿åŠ¨åˆ°å®ƒä»¬æ–°çš„ä½ç½®ä¸Šã€‚ 23.Layout Props å¯ä»¥è®¾ç½®çš„åŠ¨ç”»æ ·å¼å‚æ•° 24.Linking ç›´æŽ¥æ‰“å¼€ç½‘å€ï¼Œç”µè¯ï¼ŒçŸ­ä¿¡çš„é“¾æŽ¥ã€‚Linkingæ¨¡å—ç»™æˆ‘ä»¬æä¾›äº†Androidå’ŒiOSåŒå¹³å°é€šç”¨çš„æŽ¥å£è¿›è¡Œå¤„ç†Appè¿›å…¥å’Œä¼ å‡ºçš„é“¾æŽ¥ã€‚(ç™¾åº¦è¯¦æƒ…) 25.ListViewDataSource ä¸ºListViewç»„ä»¶æä¾›é«˜æ€§èƒ½çš„æ•°æ®å¤„ç†å’Œè®¿é—® 26.NativeMethodsMixin NativeMethodsMixinæä¾›äº†ä¸€äº›ç”¨äºŽç›´æŽ¥è®¿é—®åº•å±‚åŽŸç”Ÿç»„ä»¶çš„æ–¹æ³• 27.NetInfo æ¨¡å—å¯ä»¥èŽ·çŸ¥è®¾å¤‡è”ç½‘æˆ–ç¦»çº¿çš„çŠ¶æ€ä¿¡æ¯ã€‚ 28.PanResponder å¯ä»¥å°†å¤šç‚¹è§¦æ‘¸æ“ä½œåè°ƒæˆä¸€ä¸ªæ‰‹åŠ¿ã€‚å®ƒä½¿å¾—ä¸€ä¸ªå•ç‚¹è§¦æ‘¸å¯ä»¥æŽ¥å—æ›´å¤šçš„è§¦æ‘¸æ“ä½œï¼Œä¹Ÿå¯ä»¥ç”¨äºŽè¯†åˆ«ç®€å•çš„å¤šç‚¹è§¦æ‘¸æ‰‹åŠ¿ã€‚(ç™¾åº¦è¯¦æƒ…) 29.PermissionsAndroid Permissionsæƒé™é€‚é… 30.PixelRatio æ ¹æ®åƒç´ å¯†åº¦èŽ·å–æŒ‡å®šå¤§å°çš„å›¾ç‰‡ 31.PushNotificationIOS æœ¬æ¨¡å—å¸®åŠ©ä½ å¤„ç†åº”ç”¨çš„æŽ¨é€é€šçŸ¥ï¼ŒåŒ…æ‹¬æƒé™æŽ§åˆ¶ä»¥åŠåº”ç”¨å›¾æ ‡ä¸Šçš„è§’æ ‡æ•°ï¼ˆæœªè¯»æ¶ˆæ¯æ•°ï¼‰ã€‚ï¼ˆæŸ¥çœ‹ApIæˆ–ç™¾åº¦è¯¦æƒ…ï¼‰ 32.Settings è®¾ç½® ï¼ˆèŽ·å–ï¼Œè®¾ç½®ï¼Œç›‘å¬ï¼Œæ¸…é™¤keyå€¼ï¼‰ 33.Shadow Props è®¾ç½®é˜´å½±æ ·å¼å‚æ•° 34.Share æ‰“å¼€ä¸€ä¸ªå¯¹è¯æ¡†æ¥å…±äº«æ–‡æœ¬å†…å®¹ã€‚ 35.StatusBarIOS ç”¨äºŽæŽ§åˆ¶åº”ç”¨çŠ¶æ€æ çš„ç»„ä»¶ã€‚ 36.StyleSheet è®¾ç½®æ ·å¼çš„å±žæ€§ 37.Systrace å†…å­˜ä¼˜åŒ– 38.Text Style Props æ–‡æœ¬æ ·å¼å‚æ•° 39.TimePickerAndroid å®‰å“æ—¥æœŸé€‰æ‹© 40.ToastAndroid ç”¨äºŽåœ¨Androidè®¾å¤‡ä¸Šæ˜¾ç¤ºä¸€ä¸ªæ‚¬æµ®çš„æç¤ºä¿¡æ¯ 41.Transforms åŠ¨ç”»æ ·å¼å‚æ•° 42.Vibration ç”¨äºŽæŽ§åˆ¶è®¾å¤‡éœ‡åŠ¨ 43.VibrationIOS IOSç‰ˆç”¨äºŽæŽ§åˆ¶è®¾å¤‡éœ‡åŠ¨ 44.View Style Props è®¾ç½®è§†å›¾æ ·å¼å‚æ•°ä»Ž]]></content>
      <categories>
        <category>react-native</category>
      </categories>
      <tags>
        <tag>react-native</tag>
      </tags>
  </entry>
</search>
